function a0_0x1d7d(_0xf7460c,_0x22ded7){const _0x2f1d0d=a0_0x2f1d();return a0_0x1d7d=function(_0x1d7d67,_0x46d4c9){_0x1d7d67=_0x1d7d67-0x100;let _0x117c1b=_0x2f1d0d[_0x1d7d67];return _0x117c1b;},a0_0x1d7d(_0xf7460c,_0x22ded7);}const a0_0xf6598b=a0_0x1d7d;(function(_0xf57102,_0x3af855){const _0x21aede=a0_0x1d7d,_0x570656=_0xf57102();while(!![]){try{const _0x5a2845=parseInt(_0x21aede(0x11e))/0x1+parseInt(_0x21aede(0x10d))/0x2*(parseInt(_0x21aede(0x11a))/0x3)+-parseInt(_0x21aede(0x157))/0x4*(parseInt(_0x21aede(0x162))/0x5)+parseInt(_0x21aede(0x123))/0x6+-parseInt(_0x21aede(0x142))/0x7*(-parseInt(_0x21aede(0x150))/0x8)+parseInt(_0x21aede(0x13d))/0x9*(parseInt(_0x21aede(0x13a))/0xa)+parseInt(_0x21aede(0x144))/0xb*(-parseInt(_0x21aede(0x169))/0xc);if(_0x5a2845===_0x3af855)break;else _0x570656['push'](_0x570656['shift']());}catch(_0x3145bc){_0x570656['push'](_0x570656['shift']());}}}(a0_0x2f1d,0xeb779));function a0_0x2f1d(){const _0x14b9a4=['20604628FTjSHl','slice','master','$supplier_docs.address','name','$name','$product_details.type','../middleware/auth','product_name','return_product','stocks','json','536QRZkOY','$warehouse_name','French','$return_product','findOne','received','Portuguese\x20(BR)','4DQllTm','/purchases_return_finished/view','Finished\x20Goods','$product_details','flash','params','$note','Router','Purchase\x20Return','warehouse_name','$_id','3069995SIWCjM','/view/:id','status','bay','product_stock','primary_code_hide','language','12zUhQDd','getFullYear','Portuguese','product_code_hide','$product_details.product_stock','/view','payment\x20successfull','../models/all_models','save','aggregate','suppliers','$product_details.bay','$date','$product_details.floorlevel','$supplier_docs','$suppliers','$received','errors','$return_product.return_qty','stock_quantity','German','$discount','get','user','$product_details.product_code','secondary_code','find','purchases_return_finished','56DIkCIw','Hindi','Chinese','findById','express','post','return_qty','$return_product.price','to_room','$supplier_docs.email','$product_details.secondary_code','Received\x20For\x20Purchase\x20Return','supplier_docs','146586ysorOT','message','$product_details.rack','invoice','143703ReGhvP','$return_product.product_name','Enabled','level','forEach','269148jxTcfe','Arabic','English\x20(US)','due_amount','redirect','room','$receivable','primary_code','secondary_code_hide','stock_data','body','Spanish','to_warehouse_name','log','English','Arabic\x20(ae)','map','purchase_quantity','$product_details.primary_code','back','email','$return_product.total','/purchases_return/view','153800pJYTNq','$product_details.bin','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','936vUDbnt','success','getDate','render','/receive_payment/:id','30863MchYGW','return_purchase_invoice'];a0_0x2f1d=function(){return _0x14b9a4;};return a0_0x2f1d();}const express=require(a0_0xf6598b(0x111)),app=express(),router=express[a0_0xf6598b(0x15e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,purchases_return_finished}=require(a0_0xf6598b(0x170)),auth=require(a0_0xf6598b(0x14b)),users=require('../public/language/languages.json');router['get'](a0_0xf6598b(0x16e),auth,async(_0x402646,_0x2ad734)=>{const _0x299326=a0_0xf6598b;try{const {username:_0x4ca30c,email:_0x149dc9,role:_0x2e0e15}=_0x402646['user'],_0x3eef0a=_0x402646[_0x299326(0x108)],_0x405657=await profile['findOne']({'email':_0x3eef0a[_0x299326(0x137)]}),_0xfff50=await master_shop[_0x299326(0x10b)]();console[_0x299326(0x130)](_0x299326(0x146),_0xfff50);const _0x322dfb=await purchases_return_finished[_0x299326(0x172)]([{'$lookup':{'from':'suppliers','localField':_0x299326(0x173),'foreignField':_0x299326(0x148),'as':_0x299326(0x119)}},{'$unwind':_0x299326(0x153)},{'$unwind':_0x299326(0x177)},{'$group':{'_id':_0x299326(0x161),'invoice':{'$first':'$invoice'},'date':{'$first':_0x299326(0x175)},'suppliers':{'$first':_0x299326(0x100)},'warehouse_name':{'$first':_0x299326(0x151)},'product_name':{'$first':_0x299326(0x11f)},'return_qty':{'$first':_0x299326(0x103)},'price':{'$first':_0x299326(0x114)},'total':{'$sum':_0x299326(0x138)},'note':{'$first':_0x299326(0x15d)},'total_amount':{'$first':'$total_amount'},'discount':{'$first':_0x299326(0x106)},'receivable':{'$first':_0x299326(0x129)},'received':{'$first':_0x299326(0x101)},'due_amount':{'$first':'$due_amount'},'mobile':{'$first':'$supplier_docs.mobile'},'email':{'$first':_0x299326(0x116)},'address':{'$first':_0x299326(0x147)},'return_sum_qty':{'$sum':'$return_product.return_qty'}}}]);console['log'](_0x322dfb);if(_0xfff50[0x0][_0x299326(0x168)]=='English\x20(US)'){var _0x433078=users[_0x299326(0x131)];console[_0x299326(0x130)](_0x433078);}else{if(_0xfff50[0x0][_0x299326(0x168)]==_0x299326(0x10e))var _0x433078=users['Hindi'];else{if(_0xfff50[0x0][_0x299326(0x168)]==_0x299326(0x105))var _0x433078=users[_0x299326(0x105)];else{if(_0xfff50[0x0][_0x299326(0x168)]==_0x299326(0x12e))var _0x433078=users[_0x299326(0x12e)];else{if(_0xfff50[0x0][_0x299326(0x168)]==_0x299326(0x152))var _0x433078=users[_0x299326(0x152)];else{if(_0xfff50[0x0][_0x299326(0x168)]=='Portuguese\x20(BR)')var _0x433078=users['Portuguese'];else{if(_0xfff50[0x0][_0x299326(0x168)]=='Chinese')var _0x433078=users[_0x299326(0x10f)];else{if(_0xfff50[0x0]['language']==_0x299326(0x132))var _0x433078=users[_0x299326(0x124)];}}}}}}}_0x2ad734[_0x299326(0x140)](_0x299326(0x10c),{'success':_0x402646[_0x299326(0x15b)](_0x299326(0x13e)),'errors':_0x402646[_0x299326(0x15b)](_0x299326(0x102)),'role':_0x3eef0a,'profile':_0x405657,'master_shop':_0xfff50,'user':_0x322dfb,'language':_0x433078});}catch(_0x5a516b){console[_0x299326(0x130)](_0x5a516b);}}),router[a0_0xf6598b(0x107)]('/view/:id',auth,async(_0x366273,_0xab9aaf)=>{const _0x3883b4=a0_0xf6598b;try{const {username:_0x31b7b0,email:_0x296bfc,role:_0x3a87ca}=_0x366273['user'],_0x144e30=_0x366273['user'],_0x179eee=await profile[_0x3883b4(0x154)]({'email':_0x144e30[_0x3883b4(0x137)]}),_0x566917=await product[_0x3883b4(0x10b)]({}),_0x47d63e=await master_shop[_0x3883b4(0x10b)](),_0x4d7e9e=_0x366273[_0x3883b4(0x15c)]['id'],_0x158178=await purchases_return_finished[_0x3883b4(0x110)](_0x4d7e9e),_0x5b9040=await warehouse[_0x3883b4(0x172)]([{'$match':{'name':_0x158178['warehouse_name'],'room':_0x158178['room'],'warehouse_category':_0x3883b4(0x159)}},{'$unwind':_0x3883b4(0x15a)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3883b4(0x16d)},'bay':{'$first':_0x3883b4(0x174)},'bin':{'$first':_0x3883b4(0x13b)},'type':{'$first':_0x3883b4(0x14a)},'floorlevel':{'$first':_0x3883b4(0x176)},'primary_code':{'$first':_0x3883b4(0x135)},'secondary_code':{'$first':_0x3883b4(0x117)},'product_code':{'$first':_0x3883b4(0x109)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3883b4(0x11c)}}}]);warehouse_data=await warehouse[_0x3883b4(0x172)]([{'$match':{'status':_0x3883b4(0x120),'name':'Return\x20Goods','warehouse_category':_0x3883b4(0x159)}},{'$group':{'_id':_0x3883b4(0x149),'name':{'$first':_0x3883b4(0x149)}}},{'$sort':{'name':0x1}}]),console['log'](_0x3883b4(0x12c),_0x5b9040);if(_0x47d63e[0x0][_0x3883b4(0x168)]==_0x3883b4(0x125)){var _0x135a0a=users[_0x3883b4(0x131)];console[_0x3883b4(0x130)](_0x135a0a);}else{if(_0x47d63e[0x0][_0x3883b4(0x168)]==_0x3883b4(0x10e))var _0x135a0a=users[_0x3883b4(0x10e)];else{if(_0x47d63e[0x0][_0x3883b4(0x168)]==_0x3883b4(0x105))var _0x135a0a=users[_0x3883b4(0x105)];else{if(_0x47d63e[0x0][_0x3883b4(0x168)]==_0x3883b4(0x12e))var _0x135a0a=users['Spanish'];else{if(_0x47d63e[0x0][_0x3883b4(0x168)]==_0x3883b4(0x152))var _0x135a0a=users[_0x3883b4(0x152)];else{if(_0x47d63e[0x0][_0x3883b4(0x168)]==_0x3883b4(0x156))var _0x135a0a=users[_0x3883b4(0x16b)];else{if(_0x47d63e[0x0]['language']==_0x3883b4(0x10f))var _0x135a0a=users[_0x3883b4(0x10f)];else{if(_0x47d63e[0x0][_0x3883b4(0x168)]=='Arabic\x20(ae)')var _0x135a0a=users[_0x3883b4(0x124)];}}}}}}}_0xab9aaf[_0x3883b4(0x140)]('return_purchase_edit_finished',{'success':_0x366273['flash'](_0x3883b4(0x13e)),'errors':_0x366273[_0x3883b4(0x15b)](_0x3883b4(0x102)),'role':_0x144e30,'master_shop':_0x47d63e,'profile':_0x179eee,'user':_0x158178,'stock':_0x5b9040,'product':_0x566917,'language':_0x135a0a,'warehouse':warehouse_data});}catch(_0x16ae81){console[_0x3883b4(0x130)](_0x16ae81);}}),router[a0_0xf6598b(0x112)](a0_0xf6598b(0x163),auth,async(_0x2dfae1,_0x227fbf)=>{const _0x58a794=a0_0xf6598b;try{const _0x4262fd=_0x2dfae1[_0x58a794(0x15c)]['id'],_0x4880b0=await purchases_return_finished[_0x58a794(0x154)]({'invoice':_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x11d)]}),_0x30fc6b=await warehouse[_0x58a794(0x154)]({'name':_0x4880b0['to_warehouse_name'],'room':_0x4880b0[_0x58a794(0x115)],'warehouse_category':_0x58a794(0x159)}),{invoice:_0x45ac35,suppliers:_0x4853b9,date:_0x518c3a,warehouse_name:_0x17a6c6,product_name:_0x3f1739,purchase_quantity:_0x984e6,stocks:_0xffc85e,return_qty:_0x44d1de,note:_0x7769a4,Room_name:_0x595c14,level:_0x3649ee,isle:_0x178a50,pallet:_0x1b78b5,to_warehouse_name:_0x427e51,to_Room_name:_0x3dbc05}=_0x2dfae1[_0x58a794(0x12d)];if(typeof _0x3f1739=='string')var _0x519e8e=[_0x2dfae1['body'][_0x58a794(0x14c)]],_0x21d005=[_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x134)]],_0x3f20fe=[_0x2dfae1['body'][_0x58a794(0x14e)]],_0x4a5a13=[_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x113)]],_0x3015b8=[_0x2dfae1['body'][_0x58a794(0x121)]],_0x58a33a=[_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x16c)]],_0x2b64f4=[_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x167)]],_0x31a513=[_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x12b)]];else var _0x519e8e=[..._0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x14c)]],_0x21d005=[..._0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x134)]],_0x3f20fe=[..._0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x14e)]],_0x4a5a13=[..._0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x113)]],_0x3015b8=[..._0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x121)]],_0x58a33a=[..._0x2dfae1[_0x58a794(0x12d)]['product_code_hide']],_0x2b64f4=[..._0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x167)]],_0x31a513=[..._0x2dfae1['body'][_0x58a794(0x12b)]];const _0x30982e=_0x519e8e[_0x58a794(0x133)](_0x46235a=>{return _0x46235a={'product_name':_0x46235a};});_0x21d005[_0x58a794(0x122)]((_0x1fa77a,_0xe908b4)=>{const _0x5a7813=_0x58a794;_0x30982e[_0xe908b4][_0x5a7813(0x134)]=_0x1fa77a;}),_0x3f20fe['forEach']((_0x56db2c,_0x1e5329)=>{const _0x192534=_0x58a794;_0x30982e[_0x1e5329][_0x192534(0x104)]=_0x56db2c;}),_0x4a5a13[_0x58a794(0x122)]((_0x313a59,_0x5b4fd9)=>{const _0x33624f=_0x58a794;_0x30982e[_0x5b4fd9][_0x33624f(0x113)]=_0x313a59;}),_0x3015b8['forEach']((_0x542e33,_0x19c3d8)=>{const _0x232369=_0x58a794;_0x30982e[_0x19c3d8][_0x232369(0x165)]=_0x542e33;}),_0x58a33a[_0x58a794(0x122)]((_0x485be3,_0x214fbc)=>{_0x30982e[_0x214fbc]['product_code']=_0x485be3;}),_0x2b64f4[_0x58a794(0x122)]((_0x4510c1,_0x334f7d)=>{const _0x1bcb41=_0x58a794;_0x30982e[_0x334f7d][_0x1bcb41(0x12a)]=_0x4510c1;}),_0x31a513[_0x58a794(0x122)]((_0xf4b15b,_0xaf0298)=>{const _0x58d12b=_0x58a794;_0x30982e[_0xaf0298][_0x58d12b(0x10a)]=_0xf4b15b;});var _0x48ff02=0x0;_0x30982e[_0x58a794(0x122)](_0x1b112f=>{const _0x320689=_0x58a794;(parseInt(_0x1b112f[_0x320689(0x134)])<parseInt(_0x1b112f[_0x320689(0x113)])||parseInt(_0x1b112f[_0x320689(0x104)])<parseInt(_0x1b112f['return_qty']))&&_0x48ff02++;});if(_0x48ff02!=0x0)return _0x2dfae1['flash'](_0x58a794(0x102),_0x58a794(0x13c)),_0x227fbf['redirect'](_0x58a794(0x136));_0x4880b0[_0x58a794(0x14d)][_0x58a794(0x122)](_0x286c2a=>{const _0x1b08d3=_0x58a794;if(_0x286c2a[_0x1b08d3(0x113)]>0x0){const _0x38954f=_0x30fc6b['product_details'][_0x1b08d3(0x133)](_0xfa7912=>{const _0x3a1563=_0x1b08d3;_0xfa7912['product_name']==_0x286c2a[_0x3a1563(0x14c)]&&_0xfa7912['bay']==_0x286c2a[_0x3a1563(0x165)]&&(_0xfa7912[_0x3a1563(0x166)]=parseInt(_0xfa7912[_0x3a1563(0x166)])+parseInt(_0x286c2a['return_qty']));});}}),await _0x30fc6b[_0x58a794(0x171)](),_0x4880b0[_0x58a794(0x11d)]=_0x45ac35,_0x4880b0[_0x58a794(0x173)]=_0x4853b9,_0x4880b0['date']=_0x518c3a,_0x4880b0[_0x58a794(0x160)]=_0x17a6c6,_0x4880b0['return_product']=_0x30982e,_0x4880b0['note']=_0x7769a4,_0x4880b0[_0x58a794(0x128)]=_0x595c14,_0x4880b0['to_warehouse_name']=_0x427e51,_0x4880b0[_0x58a794(0x115)]=_0x3dbc05;const _0x35ed4d=await _0x4880b0[_0x58a794(0x171)](),_0x1711b6=await purchases_return_finished[_0x58a794(0x154)]({'invoice':_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x11d)]}),_0x511eb2=await warehouse['findOne']({'name':_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x12f)],'room':_0x2dfae1[_0x58a794(0x12d)]['to_Room_name'],'warehouse_category':_0x58a794(0x159)});_0x1711b6['return_product'][_0x58a794(0x122)](_0x2ac143=>{const _0x444302=_0x58a794;_0x511eb2['product_details'][_0x444302(0x133)](_0x140db3=>{const _0x3cc512=_0x444302;_0x140db3[_0x3cc512(0x14c)]==_0x2ac143[_0x3cc512(0x14c)]&&_0x140db3[_0x3cc512(0x165)]==_0x2ac143[_0x3cc512(0x165)]&&(_0x140db3[_0x3cc512(0x166)]=parseInt(_0x140db3[_0x3cc512(0x166)])-parseInt(_0x2ac143[_0x3cc512(0x113)]));});}),await _0x511eb2[_0x58a794(0x171)]();const _0x48cd6b=await s_payment_data[_0x58a794(0x154)]({'invoice':_0x2dfae1[_0x58a794(0x12d)][_0x58a794(0x11d)],'reason':_0x58a794(0x15f)});await _0x48cd6b[_0x58a794(0x171)](),_0x2dfae1[_0x58a794(0x15b)](_0x58a794(0x13e),'purchase\x20return\x20successfully'),_0x227fbf['redirect'](_0x58a794(0x158));}catch(_0x28c076){console['log'](_0x28c076),_0x227fbf[_0x58a794(0x164)](0xc8)[_0x58a794(0x14f)]({'message':_0x28c076[_0x58a794(0x11b)]});}}),router[a0_0xf6598b(0x107)]('/invoice/:id',auth,async(_0x3278e3,_0x4e70d9)=>{const _0x5d73d7=a0_0xf6598b;try{const {username:_0x211ba0,email:_0x1c5db0,role:_0x2d7c84}=_0x3278e3[_0x5d73d7(0x108)],_0x4ecde5=_0x3278e3[_0x5d73d7(0x108)],_0x1ba371=await profile['findOne']({'email':_0x4ecde5[_0x5d73d7(0x137)]}),_0x1f045d=await master_shop[_0x5d73d7(0x10b)]();console[_0x5d73d7(0x130)](_0x5d73d7(0x146),_0x1f045d);const _0xad06f1=_0x3278e3[_0x5d73d7(0x15c)]['id'],_0x193d8c=await purchases_return[_0x5d73d7(0x110)](_0xad06f1);console[_0x5d73d7(0x130)](_0x193d8c);const _0x4efb76=await suppliers[_0x5d73d7(0x154)]({'name':_0x193d8c[_0x5d73d7(0x173)]});console[_0x5d73d7(0x130)](_0x4efb76);if(_0x1f045d[0x0]['language']=='English\x20(US)'){var _0x277c25=users[_0x5d73d7(0x131)];console['log'](_0x277c25);}else{if(_0x1f045d[0x0][_0x5d73d7(0x168)]==_0x5d73d7(0x10e))var _0x277c25=users['Hindi'];else{if(_0x1f045d[0x0][_0x5d73d7(0x168)]==_0x5d73d7(0x105))var _0x277c25=users[_0x5d73d7(0x105)];else{if(_0x1f045d[0x0][_0x5d73d7(0x168)]==_0x5d73d7(0x12e))var _0x277c25=users['Spanish'];else{if(_0x1f045d[0x0][_0x5d73d7(0x168)]==_0x5d73d7(0x152))var _0x277c25=users[_0x5d73d7(0x152)];else{if(_0x1f045d[0x0]['language']==_0x5d73d7(0x156))var _0x277c25=users[_0x5d73d7(0x16b)];else{if(_0x1f045d[0x0][_0x5d73d7(0x168)]==_0x5d73d7(0x10f))var _0x277c25=users[_0x5d73d7(0x10f)];else{if(_0x1f045d[0x0][_0x5d73d7(0x168)]==_0x5d73d7(0x132))var _0x277c25=users[_0x5d73d7(0x124)];}}}}}}}_0x4e70d9[_0x5d73d7(0x140)](_0x5d73d7(0x143),{'success':_0x3278e3[_0x5d73d7(0x15b)](_0x5d73d7(0x13e)),'errors':_0x3278e3['flash']('errors'),'role':_0x4ecde5,'profile':_0x1ba371,'master_shop':_0x1f045d,'supplier':_0x4efb76,'purchase':_0x193d8c,'language':_0x277c25});}catch(_0x187e90){console[_0x5d73d7(0x130)](_0x187e90);}}),router[a0_0xf6598b(0x112)](a0_0xf6598b(0x141),auth,async(_0x1fcc0f,_0x21180d)=>{const _0x43293f=a0_0xf6598b;try{const _0x4e2c2b=_0x1fcc0f['params']['id'],{invoice:_0x4d02dd,suppliers:_0x5b3596,receivable_amount:_0x5a8ac3,received_amount:_0x42b87c}=_0x1fcc0f[_0x43293f(0x12d)],_0x67a15c=await purchases_return[_0x43293f(0x110)](_0x4e2c2b);console[_0x43293f(0x130)](_0x67a15c);var _0x1b1715=_0x5a8ac3-_0x42b87c;console['log'](_0x42b87c),_0x67a15c['received']=parseFloat(_0x42b87c)+parseFloat(_0x67a15c[_0x43293f(0x155)]),_0x67a15c[_0x43293f(0x126)]=_0x1b1715,console[_0x43293f(0x130)](_0x67a15c);const _0x50d106=await _0x67a15c[_0x43293f(0x171)](),_0x5cb73=await s_payment_data[_0x43293f(0x154)]({'invoice':_0x1fcc0f[_0x43293f(0x12d)][_0x43293f(0x11d)],'reason':_0x43293f(0x15f)});_0x5cb73['amount']=_0x1b1715,await _0x5cb73[_0x43293f(0x171)]();let _0x3fcd07=new Date(),_0x10b04e=('0'+_0x3fcd07[_0x43293f(0x13f)]())[_0x43293f(0x145)](-0x2),_0x36aaa2=('0'+(_0x3fcd07['getMonth']()+0x1))['slice'](-0x2),_0x5a4c52=_0x3fcd07[_0x43293f(0x16a)](),_0x36e816=_0x5a4c52+'-'+_0x36aaa2+'-'+_0x10b04e;const _0x2d408d=new suppliers_payment({'invoice':_0x4d02dd,'date':_0x5a4c52+'-'+_0x36aaa2+'-'+_0x10b04e,'suppliers':_0x5b3596,'reason':_0x43293f(0x118),'amount':_0x42b87c}),_0x5983fd=await _0x2d408d[_0x43293f(0x171)]();_0x1fcc0f['flash']('success',_0x43293f(0x16f)),_0x21180d[_0x43293f(0x127)](_0x43293f(0x139));}catch(_0xaf956e){console['log'](_0xaf956e);}}),module['exports']=router;