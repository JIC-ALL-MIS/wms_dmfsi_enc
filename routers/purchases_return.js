var a0_0x24961d=a0_0x5d9b;function a0_0x202a(){var _0x5d30c1=['errors','log','amount','bay','$return_product','Hindi','$suppliers','450euFAet','French','$supplier_docs.email','17919cHdxnY','stock_quantity','$return_product.total','express','German','old_warehouse_data','$return_product.price','final','Portuguese','map','$_id','2553929oJxxWH','bin','product_name','types','to_Room_name','product_code','$product_details._id','$product_details.rack','202gAOYPN','$product_details.storage','/receive_payment/:id','$product_details.bin','purchases_return','Router','../middleware/auth','/view/:id','product_code_hide','133839isyARQ','$warehouse_name','floorlevel','5UNmlSJ','Arabic\x20(ae)','$note','old_data','Received\x20For\x20Purchase\x20Return','date','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','841706WYwemf','render','$product_details.product_name','Portuguese\x20(BR)','invoice','return_purchase_invoice','/view','primary_code_hide','isle','message','Spanish','5918166HoliRw','$received','foreach\x20newproduct','suppliers','$product_details.floorlevel','success','findById','aggregate','secondary_code_hide','exports','email','$return_product.return_qty','$supplier_docs.address','product_details','json','English\x20(US)','secondary_code','/invoice/:id','return_qty','stock_data','$invoice','findOne','$name','find','get','/purchases_return/view','../public/language/languages.json','Arabic','purchase_quantity','redirect','params','to_room','product_stock','note','status','$product_details.product_code','English','$product_details.product_stock','flash','due_amount','master','$supplier_docs','purchase\x20return\x20successfully','$product_details.bay','$product_details.type','Enabled','level','body','warehouse_name','received','user','primary_code','language','post','getDate','room','Chinese','name','return_product','Raw\x20Materials','$return_product.product_name','$product_details.secondary_code','Purchase\x20Return','$product_details','forEach','617224AzsOxU','save','443388wqIfGJ','string','$date','type','to_warehouse_name','$receivable','pallet','stocks','slice'];a0_0x202a=function(){return _0x5d30c1;};return a0_0x202a();}(function(_0x16f8f9,_0x4d09f9){var _0x2514de=a0_0x5d9b,_0x234f2a=_0x16f8f9();while(!![]){try{var _0x1d10f2=-parseInt(_0x2514de(0xdf))/0x1+parseInt(_0x2514de(0xcc))/0x2*(-parseInt(_0x2514de(0xb9))/0x3)+-parseInt(_0x2514de(0x12d))/0x4+parseInt(_0x2514de(0xd8))/0x5*(parseInt(_0x2514de(0xea))/0x6)+parseInt(_0x2514de(0xc4))/0x7+parseInt(_0x2514de(0x12b))/0x8+parseInt(_0x2514de(0xd5))/0x9*(parseInt(_0x2514de(0x13d))/0xa);if(_0x1d10f2===_0x4d09f9)break;else _0x234f2a['push'](_0x234f2a['shift']());}catch(_0xe89109){_0x234f2a['push'](_0x234f2a['shift']());}}}(a0_0x202a,0x84422));const express=require(a0_0x24961d(0xbc)),app=express(),router=express[a0_0x24961d(0xd1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require(a0_0x24961d(0xd2)),users=require(a0_0x24961d(0x104));function a0_0x5d9b(_0x14c3d7,_0x4ebb52){var _0x202a39=a0_0x202a();return a0_0x5d9b=function(_0x5d9b02,_0x24d858){_0x5d9b02=_0x5d9b02-0xb7;var _0x4a54ab=_0x202a39[_0x5d9b02];return _0x4a54ab;},a0_0x5d9b(_0x14c3d7,_0x4ebb52);}router[a0_0x24961d(0x102)](a0_0x24961d(0xe5),auth,async(_0x38d2df,_0x16f1bd)=>{var _0x110ae9=a0_0x24961d;try{const {username:_0x43b8f5,email:_0x24aaa7,role:_0x14f94c}=_0x38d2df[_0x110ae9(0x11c)],_0x30f7cf=_0x38d2df['user'],_0x2083df=await profile[_0x110ae9(0xff)]({'email':_0x30f7cf[_0x110ae9(0xf4)]}),_0x25205d=await master_shop[_0x110ae9(0x101)]();console[_0x110ae9(0x137)](_0x110ae9(0x112),_0x25205d);const _0x48404e=await purchases_return[_0x110ae9(0xf1)]([{'$lookup':{'from':_0x110ae9(0xed),'localField':'suppliers','foreignField':_0x110ae9(0x123),'as':'supplier_docs'}},{'$unwind':_0x110ae9(0x13a)},{'$unwind':_0x110ae9(0x113)},{'$group':{'_id':_0x110ae9(0xc3),'invoice':{'$first':_0x110ae9(0xfe)},'date':{'$first':_0x110ae9(0x12f)},'suppliers':{'$first':_0x110ae9(0x13c)},'warehouse_name':{'$first':_0x110ae9(0xd6)},'product_name':{'$first':_0x110ae9(0x126)},'return_qty':{'$first':_0x110ae9(0xf5)},'price':{'$first':_0x110ae9(0xbf)},'total':{'$sum':_0x110ae9(0xbb)},'note':{'$first':_0x110ae9(0xda)},'total_amount':{'$first':'$total_amount'},'discount':{'$first':'$discount'},'receivable':{'$first':_0x110ae9(0x132)},'received':{'$first':_0x110ae9(0xeb)},'due_amount':{'$first':'$due_amount'},'mobile':{'$first':'$supplier_docs.mobile'},'email':{'$first':_0x110ae9(0xb8)},'address':{'$first':_0x110ae9(0xf6)},'return_sum_qty':{'$sum':_0x110ae9(0xf5)}}}]);console[_0x110ae9(0x137)](_0x48404e);if(_0x25205d[0x0][_0x110ae9(0x11e)]==_0x110ae9(0xf9)){var _0x58b17f=users[_0x110ae9(0x10e)];console[_0x110ae9(0x137)](_0x58b17f);}else{if(_0x25205d[0x0][_0x110ae9(0x11e)]==_0x110ae9(0x13b))var _0x58b17f=users[_0x110ae9(0x13b)];else{if(_0x25205d[0x0][_0x110ae9(0x11e)]==_0x110ae9(0xbd))var _0x58b17f=users[_0x110ae9(0xbd)];else{if(_0x25205d[0x0][_0x110ae9(0x11e)]=='Spanish')var _0x58b17f=users[_0x110ae9(0xe9)];else{if(_0x25205d[0x0]['language']=='French')var _0x58b17f=users[_0x110ae9(0xb7)];else{if(_0x25205d[0x0][_0x110ae9(0x11e)]==_0x110ae9(0xe2))var _0x58b17f=users[_0x110ae9(0xc1)];else{if(_0x25205d[0x0]['language']=='Chinese')var _0x58b17f=users[_0x110ae9(0x122)];else{if(_0x25205d[0x0][_0x110ae9(0x11e)]=='Arabic\x20(ae)')var _0x58b17f=users['Arabic'];}}}}}}}_0x16f1bd[_0x110ae9(0xe0)](_0x110ae9(0xd0),{'success':_0x38d2df[_0x110ae9(0x110)](_0x110ae9(0xef)),'errors':_0x38d2df[_0x110ae9(0x110)](_0x110ae9(0x136)),'role':_0x30f7cf,'profile':_0x2083df,'master_shop':_0x25205d,'user':_0x48404e,'language':_0x58b17f});}catch(_0x1721d4){console[_0x110ae9(0x137)](_0x1721d4);}}),router[a0_0x24961d(0x102)](a0_0x24961d(0xd3),auth,async(_0x5270c3,_0x4de518)=>{var _0x52d085=a0_0x24961d;try{const {username:_0xfeb804,email:_0x3fb3a4,role:_0x3ab468}=_0x5270c3[_0x52d085(0x11c)],_0x52f96c=_0x5270c3[_0x52d085(0x11c)],_0xabfef2=await profile[_0x52d085(0xff)]({'email':_0x52f96c[_0x52d085(0xf4)]}),_0x5ec504=await product['find']({}),_0x492efc=await master_shop[_0x52d085(0x101)]();console[_0x52d085(0x137)](_0x52d085(0x112),_0x492efc),console[_0x52d085(0x137)](_0x5270c3[_0x52d085(0x119)]);const _0xbcace9=_0x5270c3[_0x52d085(0x108)]['id'],_0x45b85d=await purchases_return[_0x52d085(0xf0)](_0xbcace9);console['log'](_0x45b85d);const _0x506113=await warehouse['aggregate']([{'$match':{'name':_0x45b85d[_0x52d085(0x11a)],'room':_0x45b85d[_0x52d085(0x121)]}},{'$unwind':_0x52d085(0x129)},{'$group':{'_id':_0x52d085(0xca),'name':{'$first':_0x52d085(0xe1)},'product_stock':{'$first':_0x52d085(0x10f)},'bay':{'$first':_0x52d085(0x115)},'bin':{'$first':_0x52d085(0xcf)},'type':{'$first':_0x52d085(0x116)},'floorlevel':{'$first':_0x52d085(0xee)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x52d085(0x127)},'product_code':{'$first':_0x52d085(0x10d)},'storage':{'$first':_0x52d085(0xcd)},'rack':{'$first':_0x52d085(0xcb)}}}]);warehouse_data=await warehouse['aggregate']([{'$match':{'status':_0x52d085(0x117),'name':'Return\x20Goods','warehouse_category':_0x52d085(0x125)}},{'$group':{'_id':_0x52d085(0x100),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console['log'](_0x52d085(0xfd),_0x506113);if(_0x492efc[0x0][_0x52d085(0x11e)]==_0x52d085(0xf9)){var _0x36f307=users['English'];console['log'](_0x36f307);}else{if(_0x492efc[0x0][_0x52d085(0x11e)]==_0x52d085(0x13b))var _0x36f307=users[_0x52d085(0x13b)];else{if(_0x492efc[0x0][_0x52d085(0x11e)]==_0x52d085(0xbd))var _0x36f307=users[_0x52d085(0xbd)];else{if(_0x492efc[0x0][_0x52d085(0x11e)]==_0x52d085(0xe9))var _0x36f307=users[_0x52d085(0xe9)];else{if(_0x492efc[0x0][_0x52d085(0x11e)]==_0x52d085(0xb7))var _0x36f307=users[_0x52d085(0xb7)];else{if(_0x492efc[0x0]['language']=='Portuguese\x20(BR)')var _0x36f307=users[_0x52d085(0xc1)];else{if(_0x492efc[0x0]['language']==_0x52d085(0x122))var _0x36f307=users['Chinese'];else{if(_0x492efc[0x0]['language']==_0x52d085(0xd9))var _0x36f307=users[_0x52d085(0x105)];}}}}}}}_0x4de518['render']('return_purchase_edit',{'success':_0x5270c3[_0x52d085(0x110)](_0x52d085(0xef)),'errors':_0x5270c3['flash'](_0x52d085(0x136)),'role':_0x52f96c,'master_shop':_0x492efc,'profile':_0xabfef2,'user':_0x45b85d,'stock':_0x506113,'product':_0x5ec504,'language':_0x36f307,'warehouse':warehouse_data});}catch(_0x2f51bd){console[_0x52d085(0x137)](_0x2f51bd);}}),router['post'](a0_0x24961d(0xd3),auth,async(_0x39103c,_0xd28ec2)=>{var _0x204a7b=a0_0x24961d;try{const _0x5c06d1=_0x39103c[_0x204a7b(0x108)]['id'];console[_0x204a7b(0x137)](_0x5c06d1);const _0x750cb0=await purchases_return['findOne']({'invoice':_0x39103c[_0x204a7b(0x119)][_0x204a7b(0xe3)]});console['log'](_0x204a7b(0xdb),_0x750cb0);const _0x4942cb=await warehouse['findOne']({'name':_0x750cb0[_0x204a7b(0x131)],'room':_0x750cb0[_0x204a7b(0x109)]});console[_0x204a7b(0x137)](_0x204a7b(0xbe),_0x4942cb);const {invoice:_0xa2199d,suppliers:_0x39a1b9,date:_0x1f2f6a,warehouse_name:_0x13e2c5,product_name:_0x5d126e,purchase_quantity:_0x41351e,stocks:_0x66ae46,return_qty:_0x265037,note:_0x2e1e72,Room_name:_0x38f14f,level:_0x652f58,isle:_0x2db245,pallet:_0x39f28c,to_warehouse_name:_0x42b886,to_Room_name:_0x4ed5ef}=_0x39103c[_0x204a7b(0x119)];if(typeof _0x5d126e==_0x204a7b(0x12e))var _0x3c73b3=[_0x39103c['body']['product_name']],_0x143e3a=[_0x39103c[_0x204a7b(0x119)][_0x204a7b(0x106)]],_0x124f1f=[_0x39103c[_0x204a7b(0x119)]['stocks']],_0x5924e1=[_0x39103c['body'][_0x204a7b(0xfc)]],_0x4fea94=[_0x39103c[_0x204a7b(0x119)][_0x204a7b(0x118)]],_0x1d240c=[_0x39103c[_0x204a7b(0x119)][_0x204a7b(0xe7)]],_0x2a22d2=[_0x39103c[_0x204a7b(0x119)][_0x204a7b(0x133)]],_0x52c5e0=[_0x39103c[_0x204a7b(0x119)][_0x204a7b(0xc7)]],_0x21a126=[_0x39103c[_0x204a7b(0x119)][_0x204a7b(0xd4)]],_0x3f6524=[_0x39103c['body'][_0x204a7b(0xe6)]],_0x1e2ec1=[_0x39103c[_0x204a7b(0x119)][_0x204a7b(0xf2)]];else var _0x3c73b3=[..._0x39103c['body'][_0x204a7b(0xc6)]],_0x143e3a=[..._0x39103c[_0x204a7b(0x119)][_0x204a7b(0x106)]],_0x124f1f=[..._0x39103c['body'][_0x204a7b(0x134)]],_0x5924e1=[..._0x39103c[_0x204a7b(0x119)][_0x204a7b(0xfc)]],_0x4fea94=[..._0x39103c[_0x204a7b(0x119)]['level']],_0x1d240c=[..._0x39103c[_0x204a7b(0x119)]['isle']],_0x2a22d2=[..._0x39103c[_0x204a7b(0x119)]['pallet']],_0x21a126=[..._0x39103c['body'][_0x204a7b(0xd4)]],_0x3f6524=[..._0x39103c[_0x204a7b(0x119)][_0x204a7b(0xe6)]],_0x1e2ec1=[..._0x39103c[_0x204a7b(0x119)]['secondary_code_hide']],_0x52c5e0=[..._0x39103c[_0x204a7b(0x119)][_0x204a7b(0xc7)]];const _0x468a77=_0x3c73b3[_0x204a7b(0xc2)](_0x4acde0=>{return _0x4acde0={'product_name':_0x4acde0};});_0x143e3a[_0x204a7b(0x12a)]((_0x3c1a3e,_0x22a9ef)=>{var _0x44bd76=_0x204a7b;_0x468a77[_0x22a9ef][_0x44bd76(0x106)]=_0x3c1a3e;}),_0x124f1f['forEach']((_0xbe7512,_0x2857da)=>{var _0x4e1a41=_0x204a7b;_0x468a77[_0x2857da][_0x4e1a41(0xba)]=_0xbe7512;}),_0x5924e1[_0x204a7b(0x12a)]((_0x823b79,_0x8df28d)=>{_0x468a77[_0x8df28d]['return_qty']=_0x823b79;}),_0x4fea94[_0x204a7b(0x12a)]((_0x4bdc3a,_0x1dbf40)=>{var _0x20e38f=_0x204a7b;_0x468a77[_0x1dbf40][_0x20e38f(0x139)]=_0x4bdc3a;}),_0x1d240c[_0x204a7b(0x12a)]((_0x47ac3c,_0x2932f9)=>{var _0xda323b=_0x204a7b;_0x468a77[_0x2932f9][_0xda323b(0xc5)]=_0x47ac3c;}),_0x2a22d2[_0x204a7b(0x12a)]((_0x47a892,_0x28042b)=>{_0x468a77[_0x28042b]['floorlevel']=_0x47a892;}),_0x21a126['forEach']((_0x5db5c3,_0x31d0e2)=>{var _0x251d4b=_0x204a7b;_0x468a77[_0x31d0e2][_0x251d4b(0xc9)]=_0x5db5c3;}),_0x3f6524['forEach']((_0x453c79,_0xd6d327)=>{var _0x2079b7=_0x204a7b;_0x468a77[_0xd6d327][_0x2079b7(0x11d)]=_0x453c79;}),_0x1e2ec1[_0x204a7b(0x12a)]((_0x23abb1,_0x1214b3)=>{var _0x5d30bf=_0x204a7b;_0x468a77[_0x1214b3][_0x5d30bf(0xfa)]=_0x23abb1;}),_0x52c5e0['forEach']((_0x53e8ce,_0x2f01ce)=>{var _0x52be3f=_0x204a7b;_0x468a77[_0x2f01ce][_0x52be3f(0x130)]=_0x53e8ce;});var _0x235e24=0x0;_0x468a77[_0x204a7b(0x12a)](_0x2cef44=>{var _0x48629a=_0x204a7b;console[_0x48629a(0x137)](_0x48629a(0xec),_0x2cef44),(parseInt(_0x2cef44['purchase_quantity'])<parseInt(_0x2cef44['return_qty'])||parseInt(_0x2cef44['stock_quantity'])<parseInt(_0x2cef44['return_qty'])||parseInt(_0x2cef44[_0x48629a(0xfc)])==0x0)&&_0x235e24++;});if(_0x235e24!=0x0)return _0x39103c[_0x204a7b(0x110)](_0x204a7b(0x136),_0x204a7b(0xde)),_0xd28ec2[_0x204a7b(0x107)]('back');_0x750cb0['return_product'][_0x204a7b(0x12a)](_0x3d82f6=>{var _0x536090=_0x204a7b;const _0x3ff9e0=_0x4942cb[_0x536090(0xf7)][_0x536090(0xc2)](_0x2706eb=>{var _0x378b2d=_0x536090;_0x2706eb[_0x378b2d(0xc6)]==_0x3d82f6[_0x378b2d(0xc6)]&&_0x2706eb[_0x378b2d(0xd7)]==_0x3d82f6[_0x378b2d(0xd7)]&&_0x2706eb[_0x378b2d(0x130)]==_0x3d82f6['type']&&_0x2706eb['bin']==_0x3d82f6[_0x378b2d(0xc5)]&&_0x2706eb['bay']==_0x3d82f6[_0x378b2d(0x139)]&&(_0x2706eb[_0x378b2d(0x10a)]=parseInt(_0x2706eb['product_stock'])+parseInt(_0x3d82f6[_0x378b2d(0xfc)]));});}),console[_0x204a7b(0x137)](_0x204a7b(0xbe),_0x4942cb),await _0x4942cb[_0x204a7b(0x12c)](),_0x750cb0[_0x204a7b(0xe3)]=_0xa2199d,_0x750cb0[_0x204a7b(0xed)]=_0x39a1b9,_0x750cb0[_0x204a7b(0xdd)]=_0x1f2f6a,_0x750cb0[_0x204a7b(0x11a)]=_0x13e2c5,_0x750cb0['return_product']=_0x468a77,_0x750cb0[_0x204a7b(0x10b)]=_0x2e1e72,_0x750cb0[_0x204a7b(0x121)]=_0x38f14f,_0x750cb0[_0x204a7b(0x131)]=_0x42b886,_0x750cb0[_0x204a7b(0x109)]=_0x4ed5ef;const _0x167113=await _0x750cb0[_0x204a7b(0x12c)](),_0x1d5773=await purchases_return[_0x204a7b(0xff)]({'invoice':_0x39103c['body'][_0x204a7b(0xe3)]}),_0x2115de=await warehouse['findOne']({'name':_0x39103c[_0x204a7b(0x119)][_0x204a7b(0x131)],'room':_0x39103c[_0x204a7b(0x119)][_0x204a7b(0xc8)]});_0x1d5773[_0x204a7b(0x124)][_0x204a7b(0x12a)](_0x369ecb=>{var _0x5c2759=_0x204a7b;_0x2115de['product_details'][_0x5c2759(0xc2)](_0x574102=>{var _0x3384c1=_0x5c2759;_0x574102['product_name']==_0x369ecb[_0x3384c1(0xc6)]&&_0x574102[_0x3384c1(0x133)]==_0x369ecb[_0x3384c1(0x133)]&&(_0x574102[_0x3384c1(0x10a)]=parseInt(_0x574102['product_stock'])-parseInt(_0x369ecb['return_qty']),console['log']('product_details.return_qtyproduct_details.return_qty',_0x369ecb[_0x3384c1(0xfc)]));});}),console[_0x204a7b(0x137)](_0x204a7b(0xc0),_0x2115de),await _0x2115de['save']();const _0x1cc5a6=await s_payment_data[_0x204a7b(0xff)]({'invoice':_0x39103c[_0x204a7b(0x119)][_0x204a7b(0xe3)],'reason':_0x204a7b(0x128)});await _0x1cc5a6[_0x204a7b(0x12c)](),_0x39103c['flash'](_0x204a7b(0xef),_0x204a7b(0x114)),_0xd28ec2[_0x204a7b(0x107)](_0x204a7b(0x103));}catch(_0x4162b8){console[_0x204a7b(0x137)](_0x4162b8),_0xd28ec2[_0x204a7b(0x10c)](0xc8)[_0x204a7b(0xf8)]({'message':_0x4162b8[_0x204a7b(0xe8)]});}}),router['get'](a0_0x24961d(0xfb),auth,async(_0x4e7f37,_0x540d7f)=>{var _0x8babb8=a0_0x24961d;try{const {username:_0x2fdff0,email:_0x313d5e,role:_0x5a1a5d}=_0x4e7f37[_0x8babb8(0x11c)],_0x433abe=_0x4e7f37['user'],_0x2751de=await profile[_0x8babb8(0xff)]({'email':_0x433abe[_0x8babb8(0xf4)]}),_0x558447=await master_shop['find']();console['log'](_0x8babb8(0x112),_0x558447);const _0x40e569=_0x4e7f37[_0x8babb8(0x108)]['id'],_0x238dcd=await purchases_return[_0x8babb8(0xf0)](_0x40e569);console['log'](_0x238dcd);const _0x45cad5=await suppliers[_0x8babb8(0xff)]({'name':_0x238dcd[_0x8babb8(0xed)]});console['log'](_0x45cad5);if(_0x558447[0x0][_0x8babb8(0x11e)]==_0x8babb8(0xf9)){var _0x6c450e=users[_0x8babb8(0x10e)];console[_0x8babb8(0x137)](_0x6c450e);}else{if(_0x558447[0x0][_0x8babb8(0x11e)]==_0x8babb8(0x13b))var _0x6c450e=users[_0x8babb8(0x13b)];else{if(_0x558447[0x0][_0x8babb8(0x11e)]==_0x8babb8(0xbd))var _0x6c450e=users[_0x8babb8(0xbd)];else{if(_0x558447[0x0][_0x8babb8(0x11e)]==_0x8babb8(0xe9))var _0x6c450e=users[_0x8babb8(0xe9)];else{if(_0x558447[0x0][_0x8babb8(0x11e)]==_0x8babb8(0xb7))var _0x6c450e=users[_0x8babb8(0xb7)];else{if(_0x558447[0x0][_0x8babb8(0x11e)]==_0x8babb8(0xe2))var _0x6c450e=users[_0x8babb8(0xc1)];else{if(_0x558447[0x0][_0x8babb8(0x11e)]=='Chinese')var _0x6c450e=users[_0x8babb8(0x122)];else{if(_0x558447[0x0][_0x8babb8(0x11e)]==_0x8babb8(0xd9))var _0x6c450e=users[_0x8babb8(0x105)];}}}}}}}_0x540d7f[_0x8babb8(0xe0)](_0x8babb8(0xe4),{'success':_0x4e7f37[_0x8babb8(0x110)](_0x8babb8(0xef)),'errors':_0x4e7f37[_0x8babb8(0x110)]('errors'),'role':_0x433abe,'profile':_0x2751de,'master_shop':_0x558447,'supplier':_0x45cad5,'purchase':_0x238dcd,'language':_0x6c450e});}catch(_0x336786){console[_0x8babb8(0x137)](_0x336786);}}),router[a0_0x24961d(0x11f)](a0_0x24961d(0xce),auth,async(_0x480cba,_0x2245ce)=>{var _0x452ade=a0_0x24961d;try{const _0x91ad98=_0x480cba['params']['id'],{invoice:_0x38906e,suppliers:_0x5084eb,receivable_amount:_0xacd333,received_amount:_0x144c48}=_0x480cba['body'],_0x37ef16=await purchases_return[_0x452ade(0xf0)](_0x91ad98);console[_0x452ade(0x137)](_0x37ef16);var _0x5d1292=_0xacd333-_0x144c48;console['log'](_0x144c48),_0x37ef16[_0x452ade(0x11b)]=parseFloat(_0x144c48)+parseFloat(_0x37ef16['received']),_0x37ef16[_0x452ade(0x111)]=_0x5d1292,console['log'](_0x37ef16);const _0x23ca1a=await _0x37ef16[_0x452ade(0x12c)](),_0x498065=await s_payment_data['findOne']({'invoice':_0x480cba[_0x452ade(0x119)][_0x452ade(0xe3)],'reason':'Purchase\x20Return'});_0x498065[_0x452ade(0x138)]=_0x5d1292,await _0x498065['save']();let _0x483988=new Date(),_0x2c2991=('0'+_0x483988[_0x452ade(0x120)]())[_0x452ade(0x135)](-0x2),_0x5aa7d0=('0'+(_0x483988['getMonth']()+0x1))['slice'](-0x2),_0x3365d1=_0x483988['getFullYear'](),_0x5a5949=_0x3365d1+'-'+_0x5aa7d0+'-'+_0x2c2991;const _0x330bcf=new suppliers_payment({'invoice':_0x38906e,'date':_0x3365d1+'-'+_0x5aa7d0+'-'+_0x2c2991,'suppliers':_0x5084eb,'reason':_0x452ade(0xdc),'amount':_0x144c48}),_0x575424=await _0x330bcf[_0x452ade(0x12c)]();_0x480cba[_0x452ade(0x110)](_0x452ade(0xef),'payment\x20successfull'),_0x2245ce[_0x452ade(0x107)](_0x452ade(0x103));}catch(_0x484ab6){console[_0x452ade(0x137)](_0x484ab6);}}),module[a0_0x24961d(0xf3)]=router;