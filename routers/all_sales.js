function a0_0x28f0(){var _0x5eca26=['$product_details.pallet','customer_data','product_code','catch','$sale_product.bay','room','batch_code','True','$product_details.maxPerUnit','14scmpqg','return_qty','$product_details.product_stock','stock','<table\x20style=\x22width:\x20100%\x20!important;\x22>','customer','$sale_product.bin','currency','/all_sales/preview/','RoomAssigned','</h5>','<html><head><title></title>','<h5\x20style=\x22text-align:\x20left;\x22>','stock_data','post','Enabled','$sale_product.floorlevel','\x20</h2>','Portuguese','padStart','2128806usAvJG','121480QELJee','</tbody>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','\x20Order\x20Date\x20:\x20','params','email','</table>','all_sales','<h5>','redirect','random','Sale\x20Return','secondary_code','<span\x20style=\x22float:\x20right;\x22>','_id','$finalize','</head><body>','$product_details.secondary_unit','maxperunit','<!DOCTYPE\x20html>','gmail','prod_code','$sale_product','status','$product_details.level','<div>','/give_payment/:id','edit_sales_view','amount','OUT-','carton','SCRN','requested_qty','/barcode_scanner','$product_details.bay','/view/add_sales','quantity','warehouse_name','type','Sales\x20Mail','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$isAllowEdit','secondary_unit','sendMail','</body></html>','sales_quantity','French','createTransport','date','all','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','Chinese','quantity_notConverted','/all_sales/view','Hindi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','purchases_data','prod_invoice','all_sales_barcode','sales\x20item\x20return\x20successfull','room_name','../models/all_models','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Arabic','language','push','aggregate','received_amount','/preview/:id','</thead>','<tbody\x20style=\x22text-align:\x20center;\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','note','$product_details.unit','\x20Order\x20Number\x20:\x20','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.isle','max_per_unit','</td>','$product_details.type','customers_docs','RMSEmail','/view/add_sale/product','1888060VrAmyW','$customers_docs','English\x20(US)','invoice','user_id','Logo.png','21958ETlLIT','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','delivery_code','Sales\x20Add\x20successfully','<hr\x20class=\x22my-3\x22>','log','Arabic\x20(ae)','$product_details.product_code','/view/return_sales/:id','staff','$sale_product.quantity','</div>','render','Floor','$product_details.expiry_date','primary_unit','edit_sales','Return\x20Goods','name','currency_placement','delivery_date','22rLUWRB','product_stock','express','4RywWjX','$product_details','</span>','<tr>','unit','barcode\x20Product\x20master','split','sales_invoice','exports','Spanish','German','$product','logo','nodemailer','$product_details.invoice','errors','master','add\x20post','flash','Error\x20Occurs','901704UIgASI','prod_cat','password','$product_details.actual_qty','sale_product','/../public','An\x20error\x20occurred.','length','finalize','slice','getDate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Sales\x20Update\x20successfully','5bbJyRV','role','product_name','payment\x20successfull','rack','expiry_date','141516MaJiMb','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','getMonth','/barcode/:id','$room','../public/language/languages.json','$product_details.floorlevel','$note','<strong>\x20Regards\x20</strong>','add_sales','user','due_amount','forEach','get','then','production_date','../middleware/auth','back','English','Shelves','bin','$product_details.storage','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','find','message','success','floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$return_data','save','<h2>\x20','Ambient','foreach\x20newproduct','An\x20error\x20occurred\x20while\x20saving\x20data.','host','body','/upload/','json','port','findById','customers','product_list','Email\x20sent\x20successfully','638avSBpB','$product_details.primary_code','$product_details.product_name','sale_qty','site_title','types','stocks','Portuguese\x20(BR)','storage','</tr>','$product_details.secondary_code','findOne','Enclosed','$product_details.product_cat','primary_code','product_details','warehouse','/invoice/:id','return_sale','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Raw\x20Materials','$sale_product.type','236682QuWPyf','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','Router','$product_details.bin','False','string','$name','$product_details._id','$product_details.production_date','$product_details.batch_code','image','barcode\x20user_id','isAllowEdit','map','filter','level'];a0_0x28f0=function(){return _0x5eca26;};return a0_0x28f0();}var a0_0x78579f=a0_0x5425;(function(_0x4ec790,_0x54fa8a){var _0x3d6abe=a0_0x5425,_0x130d4f=_0x4ec790();while(!![]){try{var _0x520d63=-parseInt(_0x3d6abe(0x249))/0x1*(parseInt(_0x3d6abe(0x25f))/0x2)+-parseInt(_0x3d6abe(0x1be))/0x3*(parseInt(_0x3d6abe(0x262))/0x4)+-parseInt(_0x3d6abe(0x283))/0x5*(parseInt(_0x3d6abe(0x276))/0x6)+parseInt(_0x3d6abe(0x1d8))/0x7*(-parseInt(_0x3d6abe(0x1ed))/0x8)+-parseInt(_0x3d6abe(0x1ec))/0x9+parseInt(_0x3d6abe(0x243))/0xa+parseInt(_0x3d6abe(0x1a8))/0xb*(parseInt(_0x3d6abe(0x289))/0xc);if(_0x520d63===_0x54fa8a)break;else _0x130d4f['push'](_0x130d4f['shift']());}catch(_0x37c672){_0x130d4f['push'](_0x130d4f['shift']());}}}(a0_0x28f0,0x2100c));const express=require(a0_0x78579f(0x261)),app=express(),router=express[a0_0x78579f(0x1c1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,supervisor_settings}=require(a0_0x78579f(0x22a)),auth=require(a0_0x78579f(0x299)),nodemailer=require(a0_0x78579f(0x26f)),users=require(a0_0x78579f(0x28e));router[a0_0x78579f(0x296)]('/view',auth,async(_0x591f37,_0x3f44f8)=>{var _0x1857f3=a0_0x78579f;try{const {username:_0x43811a,email:_0x5f5615,role:_0x306e04}=_0x591f37[_0x1857f3(0x293)],_0x5e1e28=_0x591f37['user'],_0xa1d1db=await profile[_0x1857f3(0x1b3)]({'email':_0x5e1e28[_0x1857f3(0x1f2)]}),_0x2dc2c9=await master_shop[_0x1857f3(0x2a0)]();let _0x407d01;if(_0x5e1e28[_0x1857f3(0x284)]==_0x1857f3(0x253)){const _0x337486=await staff['findOne']({'email':_0x5e1e28[_0x1857f3(0x1f2)]});_0x407d01=await sales['aggregate']([{'$lookup':{'from':'customers','localField':_0x1857f3(0x1dd),'foreignField':'name','as':_0x1857f3(0x240)}},{'$unwind':_0x1857f3(0x244)},{'$unwind':_0x1857f3(0x203)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x1857f3(0x203)},'note':{'$first':_0x1857f3(0x290)},'return_data':{'$first':_0x1857f3(0x2a6)},'customers_docs':{'$first':_0x1857f3(0x244)},'total_saleproduct_quantity':{'$sum':_0x1857f3(0x254)},'level':{'$addToSet':_0x1857f3(0x1d3)},'isle':{'$addToSet':_0x1857f3(0x1de)},'type':{'$addToSet':_0x1857f3(0x1bd)},'pallet':{'$addToSet':_0x1857f3(0x1e8)},'finalize':{'$first':_0x1857f3(0x1fc)},'isAllowEdit':{'$first':_0x1857f3(0x216)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);}else _0x407d01=await sales[_0x1857f3(0x231)]([{'$lookup':{'from':_0x1857f3(0x1a5),'localField':_0x1857f3(0x1dd),'foreignField':_0x1857f3(0x25c),'as':_0x1857f3(0x240)}},{'$unwind':_0x1857f3(0x244)},{'$unwind':'$sale_product'},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x1857f3(0x290)},'return_data':{'$first':_0x1857f3(0x2a6)},'customers_docs':{'$first':_0x1857f3(0x244)},'total_saleproduct_quantity':{'$sum':_0x1857f3(0x254)},'level':{'$addToSet':_0x1857f3(0x1d3)},'isle':{'$addToSet':_0x1857f3(0x1de)},'type':{'$addToSet':_0x1857f3(0x1bd)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x1857f3(0x1fc)},'isAllowEdit':{'$first':_0x1857f3(0x216)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);console[_0x1857f3(0x24f)]('sales\x20all_data',_0x407d01);if(_0x2dc2c9[0x0]['language']==_0x1857f3(0x245)){var _0x11f370=users['English'];console[_0x1857f3(0x24f)](_0x11f370);}else{if(_0x2dc2c9[0x0][_0x1857f3(0x22f)]=='Hindi')var _0x11f370=users[_0x1857f3(0x223)];else{if(_0x2dc2c9[0x0][_0x1857f3(0x22f)]=='German')var _0x11f370=users[_0x1857f3(0x26c)];else{if(_0x2dc2c9[0x0][_0x1857f3(0x22f)]==_0x1857f3(0x26b))var _0x11f370=users[_0x1857f3(0x26b)];else{if(_0x2dc2c9[0x0][_0x1857f3(0x22f)]==_0x1857f3(0x21b))var _0x11f370=users[_0x1857f3(0x21b)];else{if(_0x2dc2c9[0x0][_0x1857f3(0x22f)]==_0x1857f3(0x1af))var _0x11f370=users[_0x1857f3(0x1ea)];else{if(_0x2dc2c9[0x0][_0x1857f3(0x22f)]=='Chinese')var _0x11f370=users[_0x1857f3(0x220)];else{if(_0x2dc2c9[0x0]['language']==_0x1857f3(0x250))var _0x11f370=users['Arabic'];}}}}}}}_0x3f44f8[_0x1857f3(0x256)](_0x1857f3(0x1f4),{'success':_0x591f37[_0x1857f3(0x274)]('success'),'errors':_0x591f37[_0x1857f3(0x274)](_0x1857f3(0x271)),'sales':_0x407d01,'profile':_0xa1d1db,'role':_0x5e1e28,'master_shop':_0x2dc2c9,'language':_0x11f370});}catch(_0x2616ab){console[_0x1857f3(0x24f)](_0x2616ab);}});function a0_0x5425(_0x5c33a9,_0x2b94ec){var _0x28f0d6=a0_0x28f0();return a0_0x5425=function(_0x54251b,_0x5e8f55){_0x54251b=_0x54251b-0x1a2;var _0x506900=_0x28f0d6[_0x54251b];return _0x506900;},a0_0x5425(_0x5c33a9,_0x2b94ec);}async function getRandom8DigitNumber(){var _0x163486=a0_0x78579f;const _0x5b93cd=0x989680,_0x1fcef0=0x5f5e0ff,_0x5fe198=Math['floor'](Math[_0x163486(0x1f7)]()*(_0x1fcef0-_0x5b93cd+0x1))+_0x5b93cd;var _0x11d2b9;const _0x27a1c6=await sales[_0x163486(0x1b3)]({'invoice':_0x163486(0x20a)+_0x5fe198});return _0x27a1c6&&_0x27a1c6[_0x163486(0x27d)]>0x0?_0x11d2b9=_0x163486(0x20a)+_0x5fe198:_0x11d2b9='OUT-'+_0x5fe198,_0x11d2b9;}router['get'](a0_0x78579f(0x210),auth,async(_0x4a9d72,_0xe85c86)=>{var _0xa65e7f=a0_0x78579f;try{const {username:_0x58fdf0,email:_0x25c240,role:_0x1e01c3}=_0x4a9d72[_0xa65e7f(0x293)],_0x1cbd84=_0x4a9d72[_0xa65e7f(0x293)],_0x25c824=await profile[_0xa65e7f(0x1b3)]({'email':_0x1cbd84[_0xa65e7f(0x1f2)]}),_0x60b9ef=await master_shop[_0xa65e7f(0x2a0)](),_0x5c8784=await customer[_0xa65e7f(0x2a0)]({});let _0x4efaad;if(_0x1cbd84[_0xa65e7f(0x284)]=='staff'){const _0x23b881=await staff[_0xa65e7f(0x1b3)]({'email':_0x1cbd84[_0xa65e7f(0x1f2)]});_0x4efaad=await warehouse[_0xa65e7f(0x231)]([{'$match':{'status':_0xa65e7f(0x1e7),'name':_0x23b881[_0xa65e7f(0x1b8)],'warehouse_category':_0xa65e7f(0x1bc),'name':{'$ne':_0xa65e7f(0x25b)}}},{'$group':{'_id':_0xa65e7f(0x1c5),'name':{'$first':_0xa65e7f(0x1c5)}}},{'$sort':{'name':0x1}}]);}else _0x4efaad=await warehouse[_0xa65e7f(0x231)]([{'$match':{'status':'Enabled','warehouse_category':_0xa65e7f(0x1bc),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0xa65e7f(0x1c5),'name':{'$first':_0xa65e7f(0x1c5)}}},{'$sort':{'name':0x1}}]);const _0x42acdc=await product[_0xa65e7f(0x2a0)]({});var _0x4f7000=[_0xa65e7f(0x2a9),'Enclosed'];const _0x2d50db=await sales['find']({}),_0x228d95=_0x2d50db['length']+0x1,_0x204cfc=_0xa65e7f(0x20a)+_0x228d95['toString']()[_0xa65e7f(0x1eb)](0x5,'0');if(_0x60b9ef[0x0]['language']==_0xa65e7f(0x245)){var _0x2f588c=users[_0xa65e7f(0x29b)];console['log'](_0x2f588c);}else{if(_0x60b9ef[0x0][_0xa65e7f(0x22f)]==_0xa65e7f(0x223))var _0x2f588c=users[_0xa65e7f(0x223)];else{if(_0x60b9ef[0x0][_0xa65e7f(0x22f)]==_0xa65e7f(0x26c))var _0x2f588c=users['German'];else{if(_0x60b9ef[0x0][_0xa65e7f(0x22f)]==_0xa65e7f(0x26b))var _0x2f588c=users['Spanish'];else{if(_0x60b9ef[0x0][_0xa65e7f(0x22f)]==_0xa65e7f(0x21b))var _0x2f588c=users['French'];else{if(_0x60b9ef[0x0][_0xa65e7f(0x22f)]==_0xa65e7f(0x1af))var _0x2f588c=users['Portuguese'];else{if(_0x60b9ef[0x0][_0xa65e7f(0x22f)]==_0xa65e7f(0x220))var _0x2f588c=users['Chinese'];else{if(_0x60b9ef[0x0]['language']=='Arabic\x20(ae)')var _0x2f588c=users['Arabic'];}}}}}}}const _0x4ca5bc=getRandom8DigitNumber();_0x4ca5bc[_0xa65e7f(0x297)](_0x4d9f6a=>{var _0x375aac=_0xa65e7f;_0xe85c86['render'](_0x375aac(0x292),{'success':_0x4a9d72[_0x375aac(0x274)](_0x375aac(0x2a2)),'errors':_0x4a9d72[_0x375aac(0x274)](_0x375aac(0x271)),'role':_0x1cbd84,'profile':_0x25c824,'customer':_0x5c8784,'warehouse':_0x4efaad,'product':_0x42acdc,'invoice':_0x4d9f6a,'master_shop':_0x60b9ef,'language':_0x2f588c,'rooms_data':_0x4f7000});})[_0xa65e7f(0x1d2)](_0x439da6=>{var _0x21c52d=_0xa65e7f;_0x4a9d72[_0x21c52d(0x274)](_0x21c52d(0x271),_0x21c52d(0x215)),_0xe85c86['redirect']('/all_sales/view');});}catch(_0x27a10d){console[_0xa65e7f(0x24f)](_0x27a10d);}}),router['get']('/view/add_sales/:id',auth,async(_0x32cee3,_0x4bd723)=>{var _0x2132a9=a0_0x78579f;try{const _0x3e2ed8=_0x32cee3['params']['id'];console['log'](_0x3e2ed8);const _0x39bf6d=await product[_0x2132a9(0x2a0)](),_0x104fe7=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3e2ed8}},{'$unwind':_0x2132a9(0x26d)},{'$group':{'_id':'$product.product_name'}}]);console[_0x2132a9(0x24f)](_0x2132a9(0x225),_0x104fe7),_0x4bd723[_0x2132a9(0x204)](0xc8)[_0x2132a9(0x1a2)]({'purchases_data':_0x104fe7,'product_data':_0x39bf6d});}catch(_0x237394){console[_0x2132a9(0x24f)](_0x237394);}}),router[a0_0x78579f(0x1e6)](a0_0x78579f(0x242),auth,async(_0x4759b6,_0x5206c8)=>{var _0x4a8b79=a0_0x78579f;try{const {warehouse_data:_0x4c19e7,product_data:_0xe79742}=_0x4759b6['body'];console['log'](_0x4759b6[_0x4a8b79(0x2ad)]['product_data']);;const _0x7785b5=await master_shop[_0x4a8b79(0x2a0)]();console[_0x4a8b79(0x24f)](_0x4a8b79(0x272),_0x7785b5);const _0x3c6d7b=await product[_0x4a8b79(0x1b3)]({'name':_0xe79742});console[_0x4a8b79(0x24f)]('product',_0x3c6d7b);const _0x5ca1eb=await warehouse[_0x4a8b79(0x231)]([{'$match':{'name':_0x4c19e7}},{'$unwind':_0x4a8b79(0x263)},{'$match':{'product_details.product_name':_0xe79742}},{'$group':{'_id':_0x4a8b79(0x1aa),'product_stock':{'$first':_0x4a8b79(0x1da)}}}]);console[_0x4a8b79(0x24f)]('stock_data',_0x5ca1eb),_0x5206c8[_0x4a8b79(0x204)](0xc8)[_0x4a8b79(0x1a2)]({'master':_0x7785b5,'new_product':_0x3c6d7b,'stock_data':_0x5ca1eb});}catch(_0x2ab72a){console[_0x4a8b79(0x24f)](_0x2ab72a);}}),router[a0_0x78579f(0x1e6)](a0_0x78579f(0x210),auth,async(_0x2f47e4,_0x312f7f)=>{var _0x24cbfb=a0_0x78579f;try{const {invoice:_0x3d327f,date:_0x225054,warehouse_name:_0xe1b52f,product_name:_0x4f50a8,stock:_0x231a30,quantity:_0x18af86,note:_0xa74423,room:_0x3e4dbb,primary_code:_0x1eb267,secondary_code:_0x5b4f46,prod_code:_0x250135,level:_0x251cdd,isle:_0x41ce3e,pallet:_0x5351c8,batch_code:_0x5dc13d,SCRN:_0x7e9d71,expiry_date:_0xd7ce2d}=_0x2f47e4['body'];if(typeof _0x4f50a8==_0x24cbfb(0x1c4))var _0x307963=[_0x2f47e4['body']['product_name']],_0x5c5c05=[_0x2f47e4[_0x24cbfb(0x2ad)]['stock']],_0x4e6e03=[_0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x20b)]],_0x2f5c19=[_0x2f47e4['body'][_0x24cbfb(0x1b6)]],_0x25a880=[_0x2f47e4['body'][_0x24cbfb(0x1f9)]],_0x1117c9=[_0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x202)]],_0xd8a409=[_0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x1ce)]],_0x18eeeb=[_0x2f47e4['body'][_0x24cbfb(0x259)]],_0x5bcdc2=[_0x2f47e4['body']['secondary_unit']],_0x76bca9=[_0x2f47e4[_0x24cbfb(0x2ad)]['batch_code']],_0x4c9914=[_0x2f47e4['body']['expiry_date']],_0x376a99=[_0x2f47e4[_0x24cbfb(0x2ad)]['max_per_unit']],_0x2d8058=[_0x2f47e4['body']['production_date']],_0x4a46de=[_0x2f47e4['body'][_0x24cbfb(0x20d)]],_0x3abef0=[_0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x25e)]],_0x3d1f46=[_0x2f47e4[_0x24cbfb(0x2ad)]['delivery_code']],_0x101955=[_0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x277)]],_0x12fd48=[_0x2f47e4['body'][_0x24cbfb(0x211)]],_0x1ed818=[_0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x1e1)]],_0x27363e=[_0x2f47e4['body'][_0x24cbfb(0x226)]];else var _0x307963=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x285)]],_0x5c5c05=[..._0x2f47e4['body']['stock']],_0x4e6e03=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x20b)]],_0x2f5c19=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x1b6)]],_0x25a880=[..._0x2f47e4['body']['secondary_code']],_0x1117c9=[..._0x2f47e4['body'][_0x24cbfb(0x202)]],_0xd8a409=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x1ce)]],_0x18eeeb=[..._0x2f47e4[_0x24cbfb(0x2ad)]['primary_unit']],_0x5bcdc2=[..._0x2f47e4['body']['secondary_unit']],_0x76bca9=[..._0x2f47e4['body'][_0x24cbfb(0x1d5)]],_0x4c9914=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x288)]],_0x376a99=[..._0x2f47e4['body'][_0x24cbfb(0x23d)]],_0x2d8058=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x298)]],_0x4a46de=[..._0x2f47e4[_0x24cbfb(0x2ad)]['requested_qty']],_0x3abef0=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x25e)]],_0x3d1f46=[..._0x2f47e4['body']['delivery_code']],_0x101955=[..._0x2f47e4[_0x24cbfb(0x2ad)]['prod_cat']],_0x12fd48=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x211)]],_0x1ed818=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x1e1)]],_0x27363e=[..._0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x226)]];const _0x394c94=_0x307963[_0x24cbfb(0x1cc)](_0x286184=>{return _0x286184={'product_name':_0x286184};});_0x5c5c05['forEach']((_0x5ae489,_0x575543)=>{var _0x1e3c11=_0x24cbfb;_0x394c94[_0x575543][_0x1e3c11(0x1db)]=_0x5ae489;}),_0x4e6e03[_0x24cbfb(0x295)]((_0x528414,_0x134a40)=>{var _0x174617=_0x24cbfb;_0x394c94[_0x134a40][_0x174617(0x211)]=_0x528414;}),_0x2f5c19[_0x24cbfb(0x295)]((_0x2f21a5,_0x2c5c6a)=>{var _0x59744c=_0x24cbfb;_0x394c94[_0x2c5c6a][_0x59744c(0x1b6)]=_0x2f21a5;}),_0x25a880['forEach']((_0x14487d,_0x57cc57)=>{var _0x40ad70=_0x24cbfb;_0x394c94[_0x57cc57][_0x40ad70(0x1f9)]=_0x14487d;}),_0x1117c9[_0x24cbfb(0x295)]((_0x34b4ca,_0x54e680)=>{var _0x34d34a=_0x24cbfb;_0x394c94[_0x54e680][_0x34d34a(0x1d1)]=_0x34b4ca;}),_0xd8a409[_0x24cbfb(0x295)]((_0x31e338,_0x360feb)=>{_0x1ed818['forEach']((_0x491dce,_0x2c19d0)=>{var _0x4b0cc9=a0_0x5425;if(_0x491dce=='Receiving\x20Area'&&_0x360feb==_0x2c19d0){var _0x5bdb51=_0x31e338[_0x4b0cc9(0x27f)](0x3);_0x394c94[_0x360feb][_0x4b0cc9(0x1b0)]=_0x31e338[0x0],_0x394c94[_0x360feb][_0x4b0cc9(0x287)]=_0x31e338[0x1],_0x394c94[_0x360feb][_0x4b0cc9(0x23a)]=0x0,_0x394c94[_0x360feb]['bin']=0x0,_0x394c94[_0x360feb][_0x4b0cc9(0x213)]=_0x4b0cc9(0x257),_0x394c94[_0x360feb]['floorlevel']=_0x5bdb51;}else{if(_0x491dce==_0x4b0cc9(0x29c)&&_0x360feb==_0x2c19d0){var _0x5bdb51=_0x31e338['slice'](0x3);_0x394c94[_0x360feb][_0x4b0cc9(0x1b0)]=_0x31e338[0x0],_0x394c94[_0x360feb][_0x4b0cc9(0x287)]=_0x31e338[0x1],_0x394c94[_0x360feb][_0x4b0cc9(0x23a)]=0x0,_0x394c94[_0x360feb][_0x4b0cc9(0x29d)]=0x0,_0x394c94[_0x360feb]['type']=_0x4b0cc9(0x257),_0x394c94[_0x360feb][_0x4b0cc9(0x2a3)]=_0x31e338[0x5];}else{if(_0x360feb==_0x2c19d0){var _0xb098df;if(_0x31e338[0x4]=='L')_0xb098df='Level';else _0x31e338[0x4]=='F'&&(_0xb098df=_0x4b0cc9(0x257));_0x394c94[_0x360feb][_0x4b0cc9(0x1b0)]=_0x31e338[0x0],_0x394c94[_0x360feb][_0x4b0cc9(0x287)]=_0x31e338[0x1],_0x394c94[_0x360feb][_0x4b0cc9(0x23a)]=_0x31e338[0x2],_0x394c94[_0x360feb][_0x4b0cc9(0x29d)]=_0x31e338[0x3],_0x394c94[_0x360feb][_0x4b0cc9(0x213)]=_0xb098df,_0x394c94[_0x360feb]['floorlevel']=_0x31e338[0x5];}}}});}),_0x18eeeb[_0x24cbfb(0x295)]((_0x53b2b8,_0x578c3c)=>{_0x394c94[_0x578c3c]['unit']=_0x53b2b8;}),_0x5bcdc2[_0x24cbfb(0x295)]((_0x59fcd5,_0x19c0b5)=>{_0x394c94[_0x19c0b5]['secondary_unit']=_0x59fcd5;}),_0x76bca9[_0x24cbfb(0x295)]((_0x5cc3cf,_0x6c240b)=>{var _0x2c4f18=_0x24cbfb;_0x394c94[_0x6c240b][_0x2c4f18(0x1d5)]=_0x5cc3cf;}),_0x4c9914[_0x24cbfb(0x295)]((_0x8aaeef,_0x2cce7f)=>{_0x394c94[_0x2cce7f]['expiry_date']=_0x8aaeef;}),_0x376a99['forEach']((_0xf46528,_0x4ce8da)=>{var _0xaf290d=_0x24cbfb;_0x394c94[_0x4ce8da][_0xaf290d(0x1ff)]=_0xf46528;}),_0x2d8058[_0x24cbfb(0x295)]((_0x4ff34a,_0x1ab93e)=>{var _0x18773a=_0x24cbfb;_0x394c94[_0x1ab93e][_0x18773a(0x298)]=_0x4ff34a;}),_0x4a46de[_0x24cbfb(0x295)]((_0x4c0f46,_0x523725)=>{var _0x3c3944=_0x24cbfb;_0x394c94[_0x523725][_0x3c3944(0x20d)]=_0x4c0f46;}),_0x3abef0[_0x24cbfb(0x295)]((_0x52eacc,_0x12aea1)=>{var _0x1ea7f1=_0x24cbfb;_0x394c94[_0x12aea1][_0x1ea7f1(0x25e)]=_0x52eacc;}),_0x3d1f46['forEach']((_0x56cb48,_0x3a1526)=>{var _0x3320f5=_0x24cbfb;_0x394c94[_0x3a1526][_0x3320f5(0x24c)]=_0x56cb48;}),_0x101955[_0x24cbfb(0x295)]((_0xd6e2b9,_0x5d3da9)=>{var _0x397f89=_0x24cbfb;_0x394c94[_0x5d3da9][_0x397f89(0x277)]=_0xd6e2b9;}),_0x12fd48[_0x24cbfb(0x295)]((_0x5ae036,_0x448dc0)=>{_0x394c94[_0x448dc0]['quantity_notConverted']=_0x5ae036;}),_0x1ed818[_0x24cbfb(0x295)]((_0x1ef663,_0x135af7)=>{var _0x4a58a7=_0x24cbfb;_0x394c94[_0x135af7][_0x4a58a7(0x229)]=_0x1ef663;}),_0x27363e['forEach']((_0x469f58,_0x5cd4d1)=>{var _0x4a3f0a=_0x24cbfb;_0x394c94[_0x5cd4d1][_0x4a3f0a(0x246)]=_0x469f58;});var _0x52fa71=0x0;_0x394c94[_0x24cbfb(0x295)](_0x437688=>{var _0x4aa0ea=_0x24cbfb;(_0x437688[_0x4aa0ea(0x1db)]<_0x437688['quantity_notConverted']||_0x437688[_0x4aa0ea(0x221)]==0x0)&&(console[_0x4aa0ea(0x24f)](_0x4aa0ea(0x2aa),_0x437688),_0x52fa71++);});const _0x404530=_0x394c94['filter'](_0x269c45=>_0x269c45[_0x24cbfb(0x211)]!=='0'&&_0x269c45['quantity']!==''),_0x330f9f=new sales({'invoice':_0x3d327f,'customer':_0x2f47e4[_0x24cbfb(0x2ad)][_0x24cbfb(0x1dd)],'date':_0x225054,'warehouse_name':_0xe1b52f,'sale_product':_0x404530,'note':_0xa74423,'room':_0x3e4dbb,'primary_code':_0x1eb267,'secondary_code':_0x5b4f46,'prod_code':_0x250135,'SCRN':_0x7e9d71}),_0x1695f4=await _0x330f9f[_0x24cbfb(0x2a7)]();_0x2f47e4['flash'](_0x24cbfb(0x2a2),_0x24cbfb(0x24d)),_0x312f7f[_0x24cbfb(0x1f6)](_0x24cbfb(0x1e0)+_0x1695f4[_0x24cbfb(0x1fb)]);}catch(_0x2f2037){console[_0x24cbfb(0x24f)](_0x2f2037);}}),router[a0_0x78579f(0x296)]('/preview/:id',auth,async(_0x503f4e,_0x11cabe)=>{var _0x62c665=a0_0x78579f;try{const {username:_0x1a9539,email:_0x2b7dfd,role:_0x310956}=_0x503f4e[_0x62c665(0x293)],_0x569fff=_0x503f4e[_0x62c665(0x293)],_0x178fde=await profile['findOne']({'email':_0x569fff[_0x62c665(0x1f2)]}),_0x23b6bb=await master_shop[_0x62c665(0x2a0)](),_0x1f99fc=_0x503f4e[_0x62c665(0x1f1)]['id'],_0x1005aa=await sales[_0x62c665(0x1a4)](_0x1f99fc),_0x5b941e=await warehouse['aggregate']([{'$match':{'name':_0x1005aa[_0x62c665(0x212)]}},{'$unwind':_0x62c665(0x263)},{'$group':{'_id':_0x62c665(0x1c6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x62c665(0x1c2)},'type':{'$first':_0x62c665(0x23f)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x62c665(0x1b2)},'product_code':{'$first':_0x62c665(0x251)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x62c665(0x24a)},'expiry_date':{'$first':_0x62c665(0x258)},'production_date':{'$first':_0x62c665(0x1c7)}}}]),_0xdc0320=await customer[_0x62c665(0x2a0)]({});let _0x4c59cd;if(_0x569fff[_0x62c665(0x284)]==_0x62c665(0x253)){const _0x30f9af=await staff[_0x62c665(0x1b3)]({'email':_0x569fff[_0x62c665(0x1f2)]});_0x4c59cd=await warehouse[_0x62c665(0x231)]([{'$match':{'status':_0x62c665(0x1e7),'name':_0x30f9af[_0x62c665(0x1b8)]}},{'$group':{'_id':'$name','name':{'$first':_0x62c665(0x1c5)}}}]);}else _0x4c59cd=await warehouse[_0x62c665(0x231)]([{'$match':{'status':_0x62c665(0x1e7)}},{'$group':{'_id':_0x62c665(0x1c5),'name':{'$first':_0x62c665(0x1c5)}}}]);const _0xecf90c=await product[_0x62c665(0x2a0)]({}),_0x1541c2=await suppliers[_0x62c665(0x2a0)]({});if(_0x23b6bb[0x0][_0x62c665(0x22f)]==_0x62c665(0x245)){var _0x5b8b65=users['English'];console[_0x62c665(0x24f)](_0x5b8b65);}else{if(_0x23b6bb[0x0][_0x62c665(0x22f)]==_0x62c665(0x223))var _0x5b8b65=users[_0x62c665(0x223)];else{if(_0x23b6bb[0x0][_0x62c665(0x22f)]==_0x62c665(0x26c))var _0x5b8b65=users['German'];else{if(_0x23b6bb[0x0][_0x62c665(0x22f)]==_0x62c665(0x26b))var _0x5b8b65=users['Spanish'];else{if(_0x23b6bb[0x0][_0x62c665(0x22f)]==_0x62c665(0x21b))var _0x5b8b65=users[_0x62c665(0x21b)];else{if(_0x23b6bb[0x0][_0x62c665(0x22f)]==_0x62c665(0x1af))var _0x5b8b65=users[_0x62c665(0x1ea)];else{if(_0x23b6bb[0x0][_0x62c665(0x22f)]=='Chinese')var _0x5b8b65=users['Chinese'];else{if(_0x23b6bb[0x0][_0x62c665(0x22f)]==_0x62c665(0x250))var _0x5b8b65=users[_0x62c665(0x22e)];}}}}}}}_0x11cabe[_0x62c665(0x256)](_0x62c665(0x208),{'success':_0x503f4e[_0x62c665(0x274)](_0x62c665(0x2a2)),'errors':_0x503f4e['flash']('errors'),'role':_0x569fff,'profile':_0x178fde,'customer':_0xdc0320,'warehouse':_0x4c59cd,'product':_0x5b941e,'user':_0x1005aa,'master_shop':_0x23b6bb,'unit':_0xecf90c,'language':_0x5b8b65,'suppliers':_0x1541c2});}catch(_0x25884c){console['log'](_0x25884c);}}),router[a0_0x78579f(0x1e6)](a0_0x78579f(0x233),auth,async(_0x19fe49,_0x4f9d6e)=>{var _0x4a23f1=a0_0x78579f;try{const _0x3df330=_0x19fe49[_0x4a23f1(0x1f1)]['id'],{invoice:_0x4f2307,warehouse_name:_0x534dc1,room:_0x32577a}=_0x19fe49[_0x4a23f1(0x2ad)],_0x2e51af=await sales[_0x4a23f1(0x1b3)]({'invoice':_0x4f2307}),_0x147ccb=_0x2e51af['sale_product']['map'](async _0x1eb997=>{var _0x3b8cfd=_0x4a23f1,_0x8d920d=await warehouse[_0x3b8cfd(0x1b3)]({'name':_0x534dc1,'room':_0x1eb997[_0x3b8cfd(0x229)],'warehouse_category':_0x3b8cfd(0x1bc)});const _0x445e44=_0x8d920d[_0x3b8cfd(0x1b7)][_0x3b8cfd(0x1cc)](_0x18105c=>{var _0x264a55=_0x3b8cfd;_0x18105c[_0x264a55(0x285)]==_0x1eb997[_0x264a55(0x285)]&&_0x18105c['floorlevel']==_0x1eb997[_0x264a55(0x2a3)]&&_0x18105c[_0x264a55(0x213)]==_0x1eb997[_0x264a55(0x213)]&&_0x18105c[_0x264a55(0x29d)]==_0x1eb997[_0x264a55(0x29d)]&&_0x18105c[_0x264a55(0x23a)]==_0x1eb997['bay']&&_0x18105c[_0x264a55(0x287)]==_0x1eb997['rack']&&_0x18105c[_0x264a55(0x1b0)]==_0x1eb997[_0x264a55(0x1b0)]&&_0x18105c[_0x264a55(0x288)]==_0x1eb997[_0x264a55(0x288)]&&_0x18105c['batch_code']==_0x1eb997['batch_code']&&_0x18105c[_0x264a55(0x246)]==_0x1eb997[_0x264a55(0x246)]&&(_0x18105c[_0x264a55(0x260)]=_0x18105c[_0x264a55(0x260)]-_0x1eb997[_0x264a55(0x211)]);});return _0x8d920d;});Promise[_0x4a23f1(0x21e)](_0x147ccb)[_0x4a23f1(0x297)](async _0x491511=>{var _0x31dced=_0x4a23f1;try{for(const _0x2d4e6b of _0x491511){await _0x2d4e6b['save']();}_0x2e51af['finalize']='True';const _0x2e0b2d=await _0x2e51af[_0x31dced(0x2a7)](),_0xcfc7a4=await master_shop[_0x31dced(0x2a0)](),_0x2025da=await email_settings[_0x31dced(0x1b3)](),_0xc0a3ec=await supervisor_settings[_0x31dced(0x2a0)]();var _0x7d091f=_0x2e51af[_0x31dced(0x27a)],_0x4ffc53='',_0x1bf4c6;for(_0x1bf4c6 in _0x7d091f){_0x4ffc53+=_0x31dced(0x265)+_0x31dced(0x236)+_0x7d091f[_0x1bf4c6][_0x31dced(0x285)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x7d091f[_0x1bf4c6][_0x31dced(0x1d1)]+_0x31dced(0x23e)+_0x31dced(0x236)+_0x7d091f[_0x1bf4c6][_0x31dced(0x211)]+_0x31dced(0x23e)+_0x31dced(0x236)+_0x7d091f[_0x1bf4c6]['unit']+_0x31dced(0x23e)+_0x31dced(0x236)+_0x7d091f[_0x1bf4c6][_0x31dced(0x217)]+_0x31dced(0x23e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2e51af['warehouse_name']+_0x31dced(0x23e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x7d091f[_0x1bf4c6][_0x31dced(0x229)]+_0x31dced(0x23e)+_0x31dced(0x236)+_0x7d091f[_0x1bf4c6]['storage']+_0x7d091f[_0x1bf4c6][_0x31dced(0x287)]+_0x7d091f[_0x1bf4c6][_0x31dced(0x23a)]+_0x7d091f[_0x1bf4c6][_0x31dced(0x29d)]+_0x7d091f[_0x1bf4c6]['type'][0x0]+_0x7d091f[_0x1bf4c6][_0x31dced(0x2a3)]+_0x31dced(0x23e),_0x31dced(0x1b1);}let _0x1e8bd3=nodemailer[_0x31dced(0x21c)]({'host':_0x2025da[_0x31dced(0x2ac)],'port':Number(_0x2025da[_0x31dced(0x1a3)]),'secure':![],'auth':{'user':_0x2025da[_0x31dced(0x1f2)],'pass':_0x2025da[_0x31dced(0x278)]}}),_0x2dddad={'from':_0x2025da[_0x31dced(0x1f2)],'to':_0xc0a3ec[0x0][_0x31dced(0x241)],'subject':_0x31dced(0x214),'attachments':[{'filename':_0x31dced(0x248),'path':__dirname+'/../public'+_0x31dced(0x2ae)+_0xcfc7a4[0x0][_0x31dced(0x1c9)],'cid':_0x31dced(0x26e)}],'html':_0x31dced(0x200)+_0x31dced(0x1e3)+_0x31dced(0x1fd)+_0x31dced(0x206)+_0x31dced(0x29f)+_0x31dced(0x206)+_0x31dced(0x2a5)+_0x31dced(0x255)+'<div>'+_0x31dced(0x2a8)+_0xcfc7a4[0x0][_0x31dced(0x1ac)]+_0x31dced(0x1e9)+_0x31dced(0x255)+_0x31dced(0x255)+'<hr\x20class=\x22my-3\x22>'+_0x31dced(0x206)+_0x31dced(0x1e4)+_0x31dced(0x239)+_0x2e51af[_0x31dced(0x246)]+'\x20'+_0x31dced(0x1fa)+_0x31dced(0x1f0)+_0x2e51af['date']+'\x20'+_0x31dced(0x264)+_0x31dced(0x1e2)+_0x31dced(0x255)+_0x31dced(0x1dc)+_0x31dced(0x1ef)+_0x31dced(0x265)+_0x31dced(0x2a4)+_0x31dced(0x281)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x31dced(0x28a)+_0x31dced(0x23b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x31dced(0x22b)+_0x31dced(0x22d)+_0x31dced(0x1b1)+_0x31dced(0x234)+_0x31dced(0x235)+'\x20'+_0x4ffc53+'\x20'+_0x31dced(0x1ee)+_0x31dced(0x1f3)+_0x31dced(0x206)+'<strong>\x20Regards\x20</strong>'+_0x31dced(0x1f5)+_0xcfc7a4[0x0][_0x31dced(0x1ac)]+_0x31dced(0x1e2)+_0x31dced(0x255)+_0x31dced(0x255)+_0x31dced(0x219)};_0x1e8bd3[_0x31dced(0x218)](_0x2dddad,function(_0x442d3e,_0x532bec){var _0xbc1a82=_0x31dced;_0x442d3e?(console[_0xbc1a82(0x24f)](_0x442d3e),console[_0xbc1a82(0x24f)](_0xbc1a82(0x275))):console[_0xbc1a82(0x24f)]('Email\x20sent\x20successfully');}),_0x19fe49[_0x31dced(0x274)](_0x31dced(0x2a2),_0x31dced(0x282)),_0x4f9d6e[_0x31dced(0x1f6)](_0x31dced(0x1e0)+_0x3df330);}catch(_0x20a7cd){console[_0x31dced(0x22c)](_0x20a7cd),_0x4f9d6e[_0x31dced(0x204)](0x1f4)['json']({'error':_0x31dced(0x2ab)});}})[_0x4a23f1(0x1d2)](_0x412629=>{var _0x4bc977=_0x4a23f1;console['error'](_0x412629),_0x4f9d6e[_0x4bc977(0x204)](0x1f4)[_0x4bc977(0x1a2)]({'error':_0x4bc977(0x27c)});});}catch(_0x395f00){console['log'](_0x395f00);}}),router[a0_0x78579f(0x296)]('/view/:id',auth,async(_0x41b745,_0x53e661)=>{var _0x52d2c0=a0_0x78579f;try{const {username:_0x29467c,email:_0x1cba3c,role:_0x4b9210}=_0x41b745['user'],_0x25631b=_0x41b745['user'],_0x5cf883=await profile[_0x52d2c0(0x1b3)]({'email':_0x25631b[_0x52d2c0(0x1f2)]}),_0x4ec373=await master_shop[_0x52d2c0(0x2a0)](),_0x596cc0=_0x41b745[_0x52d2c0(0x1f1)]['id'],_0x8a0016=await sales[_0x52d2c0(0x1a4)](_0x596cc0);var _0x1b41dd=[_0x52d2c0(0x2a9),_0x52d2c0(0x1b4)];const _0x360403=await warehouse[_0x52d2c0(0x231)]([{'$match':{'name':_0x8a0016['warehouse_name'],'warehouse_category':_0x52d2c0(0x1bc)}},{'$unwind':_0x52d2c0(0x263)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x52d2c0(0x20f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x52d2c0(0x23f)},'floorlevel':{'$first':_0x52d2c0(0x28f)},'primary_code':{'$first':_0x52d2c0(0x1a9)},'secondary_code':{'$first':_0x52d2c0(0x1b2)},'product_code':{'$first':_0x52d2c0(0x251)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x52d2c0(0x24a)}}}]),_0x595f70=await customer[_0x52d2c0(0x2a0)]({});let _0x598777;if(_0x25631b['role']==_0x52d2c0(0x253)){const _0x258525=await staff['findOne']({'email':_0x25631b['email']});_0x598777=await warehouse[_0x52d2c0(0x231)]([{'$match':{'status':_0x52d2c0(0x1e7),'name':_0x258525[_0x52d2c0(0x1b8)],'warehouse_category':_0x52d2c0(0x1bc)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x598777=await warehouse[_0x52d2c0(0x231)]([{'$match':{'status':_0x52d2c0(0x1e7),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x52d2c0(0x1c5),'name':{'$first':_0x52d2c0(0x1c5)}}}]);const _0x29ad02=await product[_0x52d2c0(0x2a0)]({});if(_0x4ec373[0x0][_0x52d2c0(0x22f)]==_0x52d2c0(0x245)){var _0x1df39e=users[_0x52d2c0(0x29b)];console[_0x52d2c0(0x24f)](_0x1df39e);}else{if(_0x4ec373[0x0][_0x52d2c0(0x22f)]==_0x52d2c0(0x223))var _0x1df39e=users['Hindi'];else{if(_0x4ec373[0x0][_0x52d2c0(0x22f)]=='German')var _0x1df39e=users['German'];else{if(_0x4ec373[0x0][_0x52d2c0(0x22f)]==_0x52d2c0(0x26b))var _0x1df39e=users[_0x52d2c0(0x26b)];else{if(_0x4ec373[0x0][_0x52d2c0(0x22f)]==_0x52d2c0(0x21b))var _0x1df39e=users['French'];else{if(_0x4ec373[0x0][_0x52d2c0(0x22f)]==_0x52d2c0(0x1af))var _0x1df39e=users['Portuguese'];else{if(_0x4ec373[0x0]['language']==_0x52d2c0(0x220))var _0x1df39e=users['Chinese'];else{if(_0x4ec373[0x0][_0x52d2c0(0x22f)]==_0x52d2c0(0x250))var _0x1df39e=users['Arabic'];}}}}}}}_0x53e661[_0x52d2c0(0x256)](_0x52d2c0(0x25a),{'success':_0x41b745['flash'](_0x52d2c0(0x2a2)),'errors':_0x41b745[_0x52d2c0(0x274)](_0x52d2c0(0x271)),'role':_0x25631b,'profile':_0x5cf883,'customer':_0x595f70,'warehouse':_0x598777,'product':_0x360403,'user':_0x8a0016,'master_shop':_0x4ec373,'unit':_0x29ad02,'language':_0x1df39e});}catch(_0x56a1ee){console[_0x52d2c0(0x24f)](_0x56a1ee);}}),router[a0_0x78579f(0x1e6)]('/view/:id',auth,async(_0x23b3c2,_0x5f4851)=>{var _0x4ea12e=a0_0x78579f;try{const _0x3b0fc8=_0x23b3c2[_0x4ea12e(0x1f1)]['id'],_0x4197b2=await sales[_0x4ea12e(0x1b3)]({'_id':_0x23b3c2['params']['id']}),_0x52e8b9=await warehouse['findOne']({'name':_0x4197b2[_0x4ea12e(0x212)],'room':_0x23b3c2['body'][_0x4ea12e(0x1d4)]}),{invoice:_0x62cd10,date:_0x318859,warehouse_name:_0x1b1696,product_name:_0x80fe0e,stock:_0x1e2848,quantity:_0x4f082e,note:_0x43c7c4,room:_0xcf0046,customer:_0x542a68,SCRN:_0x1a38b5}=_0x23b3c2[_0x4ea12e(0x2ad)];if(typeof _0x80fe0e==_0x4ea12e(0x1c4))var _0x3b5ea2=[_0x23b3c2['body'][_0x4ea12e(0x285)]],_0x298ff3=[_0x23b3c2[_0x4ea12e(0x2ad)]['stock']],_0x312195=[_0x23b3c2['body'][_0x4ea12e(0x20b)]],_0x44a9b7=[_0x23b3c2['body'][_0x4ea12e(0x1b6)]],_0x2831cd=[_0x23b3c2[_0x4ea12e(0x2ad)]['secondary_code']],_0x1396e0=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x202)]],_0x5b40d9=[_0x23b3c2['body'][_0x4ea12e(0x1ce)]],_0x31737d=[_0x23b3c2['body'][_0x4ea12e(0x259)]],_0x1c4612=[_0x23b3c2['body'][_0x4ea12e(0x217)]],_0x48b348=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x1d5)]],_0x22a73f=[_0x23b3c2['body']['expiry_date']],_0x4d67c7=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x23d)]],_0x29dd87=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x298)]],_0x382287=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x20d)]],_0x15038c=[_0x23b3c2[_0x4ea12e(0x2ad)]['delivery_date']],_0x25e87e=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x24c)]],_0x522b1b=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x277)]],_0x3bc8e6=[_0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x211)]],_0x2cf897=[_0x23b3c2[_0x4ea12e(0x2ad)]['RoomAssigned']];else var _0x3b5ea2=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x285)]],_0x298ff3=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x1db)]],_0x312195=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x20b)]],_0x44a9b7=[..._0x23b3c2[_0x4ea12e(0x2ad)]['primary_code']],_0x2831cd=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x1f9)]],_0x1396e0=[..._0x23b3c2['body'][_0x4ea12e(0x202)]],_0x5b40d9=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x1ce)]],_0x31737d=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x259)]],_0x1c4612=[..._0x23b3c2[_0x4ea12e(0x2ad)]['secondary_unit']],_0x48b348=[..._0x23b3c2[_0x4ea12e(0x2ad)]['batch_code']],_0x22a73f=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x288)]],_0x4d67c7=[..._0x23b3c2['body'][_0x4ea12e(0x23d)]],_0x29dd87=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x298)]],_0x382287=[..._0x23b3c2['body'][_0x4ea12e(0x20d)]],_0x15038c=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x25e)]],_0x25e87e=[..._0x23b3c2['body']['delivery_code']],_0x522b1b=[..._0x23b3c2['body'][_0x4ea12e(0x277)]],_0x3bc8e6=[..._0x23b3c2['body'][_0x4ea12e(0x211)]],_0x2cf897=[..._0x23b3c2[_0x4ea12e(0x2ad)][_0x4ea12e(0x1e1)]];const _0x5cf703=_0x3b5ea2['map'](_0x23ca43=>{return _0x23ca43={'product_name':_0x23ca43};});_0x298ff3['forEach']((_0x547a83,_0x91fd2f)=>{var _0x381fa7=_0x4ea12e;_0x5cf703[_0x91fd2f][_0x381fa7(0x1db)]=_0x547a83;}),_0x312195[_0x4ea12e(0x295)]((_0x1c040a,_0x4f401f)=>{var _0x5e7a0b=_0x4ea12e;_0x5cf703[_0x4f401f][_0x5e7a0b(0x211)]=_0x1c040a;}),_0x44a9b7['forEach']((_0x95567a,_0x291bb5)=>{var _0x4833d1=_0x4ea12e;_0x5cf703[_0x291bb5][_0x4833d1(0x1b6)]=_0x95567a;}),_0x2831cd[_0x4ea12e(0x295)]((_0x51d520,_0x113b73)=>{var _0x2f7879=_0x4ea12e;_0x5cf703[_0x113b73][_0x2f7879(0x1f9)]=_0x51d520;}),_0x1396e0[_0x4ea12e(0x295)]((_0x1c684f,_0x3607e7)=>{var _0x1b3bb4=_0x4ea12e;_0x5cf703[_0x3607e7][_0x1b3bb4(0x1d1)]=_0x1c684f;}),_0x5b40d9[_0x4ea12e(0x295)]((_0xa439cd,_0x275109)=>{var _0x5d8f74=_0x4ea12e;_0x2cf897[_0x5d8f74(0x295)]((_0x5ec381,_0xb8ecd9)=>{var _0x3457b5=_0x5d8f74;if(_0x5ec381=='Receiving\x20Area'&&_0x275109==_0xb8ecd9){var _0x104e70=_0xa439cd[_0x3457b5(0x27f)](0x3);_0x5cf703[_0x275109][_0x3457b5(0x1b0)]=_0xa439cd[0x0],_0x5cf703[_0x275109]['rack']=_0xa439cd[0x1],_0x5cf703[_0x275109][_0x3457b5(0x23a)]=0x0,_0x5cf703[_0x275109][_0x3457b5(0x29d)]=0x0,_0x5cf703[_0x275109][_0x3457b5(0x213)]=_0x3457b5(0x257),_0x5cf703[_0x275109]['floorlevel']=_0x104e70;}else{if(_0x5ec381==_0x3457b5(0x29c)&&_0x275109==_0xb8ecd9){var _0x104e70=_0xa439cd[_0x3457b5(0x27f)](0x3);_0x5cf703[_0x275109]['storage']=_0xa439cd[0x0],_0x5cf703[_0x275109][_0x3457b5(0x287)]=_0xa439cd[0x1],_0x5cf703[_0x275109][_0x3457b5(0x23a)]=0x0,_0x5cf703[_0x275109]['bin']=0x0,_0x5cf703[_0x275109][_0x3457b5(0x213)]=_0x3457b5(0x257),_0x5cf703[_0x275109][_0x3457b5(0x2a3)]=_0xa439cd[0x5];}else{if(_0x275109==_0xb8ecd9){var _0x3c1107;if(_0xa439cd[0x4]=='L')_0x3c1107='Level';else _0xa439cd[0x4]=='F'&&(_0x3c1107=_0x3457b5(0x257));_0x5cf703[_0x275109][_0x3457b5(0x1b0)]=_0xa439cd[0x0],_0x5cf703[_0x275109][_0x3457b5(0x287)]=_0xa439cd[0x1],_0x5cf703[_0x275109]['bay']=_0xa439cd[0x2],_0x5cf703[_0x275109]['bin']=_0xa439cd[0x3],_0x5cf703[_0x275109][_0x3457b5(0x213)]=_0x3c1107,_0x5cf703[_0x275109]['floorlevel']=_0xa439cd[0x5];}}}});}),_0x31737d[_0x4ea12e(0x295)]((_0x4c22f4,_0x1b67a3)=>{var _0x4f3079=_0x4ea12e;_0x5cf703[_0x1b67a3][_0x4f3079(0x266)]=_0x4c22f4;}),_0x1c4612[_0x4ea12e(0x295)]((_0x1b2b67,_0x4feb8e)=>{_0x5cf703[_0x4feb8e]['secondary_unit']=_0x1b2b67;}),_0x48b348['forEach']((_0x429675,_0x5e0ddf)=>{_0x5cf703[_0x5e0ddf]['batch_code']=_0x429675;}),_0x22a73f['forEach']((_0x29446e,_0x555633)=>{_0x5cf703[_0x555633]['expiry_date']=_0x29446e;}),_0x4d67c7[_0x4ea12e(0x295)]((_0x14a952,_0x1e3f39)=>{_0x5cf703[_0x1e3f39]['maxperunit']=_0x14a952;}),_0x29dd87['forEach']((_0x3ab2fd,_0x16f737)=>{var _0x4e34b1=_0x4ea12e;_0x5cf703[_0x16f737][_0x4e34b1(0x298)]=_0x3ab2fd;}),_0x382287[_0x4ea12e(0x295)]((_0x3abbc1,_0x3bb31f)=>{var _0x4fbd44=_0x4ea12e;_0x5cf703[_0x3bb31f][_0x4fbd44(0x20d)]=_0x3abbc1;}),_0x15038c[_0x4ea12e(0x295)]((_0x158dd7,_0x527199)=>{var _0x2b01bb=_0x4ea12e;_0x5cf703[_0x527199][_0x2b01bb(0x25e)]=_0x158dd7;}),_0x25e87e[_0x4ea12e(0x295)]((_0x5dc210,_0x310fb5)=>{var _0x117ebb=_0x4ea12e;_0x5cf703[_0x310fb5][_0x117ebb(0x24c)]=_0x5dc210;}),_0x522b1b[_0x4ea12e(0x295)]((_0x1c09cd,_0x126c3d)=>{var _0x323b26=_0x4ea12e;_0x5cf703[_0x126c3d][_0x323b26(0x277)]=_0x1c09cd;}),_0x3bc8e6[_0x4ea12e(0x295)]((_0xebafb9,_0x257eea)=>{_0x5cf703[_0x257eea]['quantity_notConverted']=_0xebafb9;}),_0x2cf897['forEach']((_0x96ab81,_0x4cf8d7)=>{_0x5cf703[_0x4cf8d7]['room_name']=_0x96ab81;});var _0x2993a5=0x0;_0x5cf703['forEach'](_0x127c38=>{var _0x1e432a=_0x4ea12e;console[_0x1e432a(0x24f)]('foreach\x20newproduct',_0x127c38),(parseInt(_0x127c38[_0x1e432a(0x1db)])<parseInt(_0x127c38[_0x1e432a(0x211)])||parseInt(_0x127c38[_0x1e432a(0x211)])==0x0)&&_0x2993a5++;});if(_0x2993a5!=0x0)return _0x23b3c2[_0x4ea12e(0x274)](_0x4ea12e(0x271),_0x4ea12e(0x1bb)),_0x5f4851[_0x4ea12e(0x1f6)](_0x4ea12e(0x29a));const _0x131169=_0x5cf703[_0x4ea12e(0x1cd)](_0x17065d=>_0x17065d[_0x4ea12e(0x211)]!=='0'&&_0x17065d[_0x4ea12e(0x211)]!=='');_0x4197b2[_0x4ea12e(0x246)]=_0x62cd10,_0x4197b2[_0x4ea12e(0x1dd)]=_0x542a68,_0x4197b2[_0x4ea12e(0x21d)]=_0x318859,_0x4197b2[_0x4ea12e(0x212)]=_0x1b1696,_0x4197b2[_0x4ea12e(0x27a)]=_0x131169,_0x4197b2[_0x4ea12e(0x237)]=_0x43c7c4,_0x4197b2[_0x4ea12e(0x20c)]=_0x1a38b5,_0x4197b2[_0x4ea12e(0x27e)]=_0x4ea12e(0x1c3),_0x4197b2[_0x4ea12e(0x1cb)]=_0x4ea12e(0x1c3);const _0x31453d=await _0x4197b2[_0x4ea12e(0x2a7)]();_0x23b3c2['flash']('success','Sales\x20Update\x20successfully'),_0x5f4851[_0x4ea12e(0x1f6)](_0x4ea12e(0x222));}catch(_0x5769f4){console['log'](_0x5769f4);}}),router[a0_0x78579f(0x1e6)](a0_0x78579f(0x207),auth,async(_0x17e495,_0x260479)=>{var _0x54e8e4=a0_0x78579f;try{const _0x3d38ae=_0x17e495[_0x54e8e4(0x1f1)]['id'],{invoice:_0x1c81f1,customer:_0x2a0a99,receivable_amount:_0x2901c5,received_amount:_0x5a8839}=_0x17e495[_0x54e8e4(0x2ad)],_0x8347d7=await sales[_0x54e8e4(0x1a4)](_0x3d38ae);console[_0x54e8e4(0x24f)](_0x8347d7);var _0x55642e=_0x2901c5-_0x5a8839;console[_0x54e8e4(0x24f)](_0x5a8839),_0x8347d7[_0x54e8e4(0x232)]=parseFloat(_0x5a8839)+parseFloat(_0x8347d7[_0x54e8e4(0x232)]),_0x8347d7[_0x54e8e4(0x294)]=_0x55642e,console['log'](_0x8347d7);const _0x24116e=await _0x8347d7[_0x54e8e4(0x2a7)](),_0x4d3306=await c_payment_data['findOne']({'invoice':_0x1c81f1});_0x4d3306[_0x54e8e4(0x209)]=_0x55642e,await _0x4d3306[_0x54e8e4(0x2a7)]();let _0x1ff244=new Date(),_0x567c17=('0'+_0x1ff244[_0x54e8e4(0x280)]())['slice'](-0x2),_0x192729=('0'+(_0x1ff244[_0x54e8e4(0x28b)]()+0x1))[_0x54e8e4(0x27f)](-0x2),_0x477ae0=_0x1ff244['getFullYear'](),_0x347864=_0x477ae0+'-'+_0x192729+'-'+_0x567c17;const _0x25c30f=new customer_payment({'invoice':_0x1c81f1,'date':_0x477ae0+'-'+_0x192729+'-'+_0x567c17,'customer':_0x2a0a99,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x5a8839}),_0x8e0b51=await _0x25c30f[_0x54e8e4(0x2a7)]();_0x17e495['flash'](_0x54e8e4(0x2a2),_0x54e8e4(0x286)),_0x260479[_0x54e8e4(0x1f6)]('/all_sales/view');}catch(_0xdc2405){console[_0x54e8e4(0x24f)](_0xdc2405);}}),router[a0_0x78579f(0x296)](a0_0x78579f(0x1b9),auth,async(_0x39582e,_0x400d51)=>{var _0x3a9c4f=a0_0x78579f;try{const {username:_0x23f92d,email:_0x952961,role:_0x48b9d0}=_0x39582e['user'],_0x418324=_0x39582e[_0x3a9c4f(0x293)],_0x92dbe=await profile[_0x3a9c4f(0x1b3)]({'email':_0x418324[_0x3a9c4f(0x1f2)]}),_0x31a10c=await master_shop['find']();console['log'](_0x3a9c4f(0x272),_0x31a10c);const _0x5204c6=_0x39582e[_0x3a9c4f(0x1f1)]['id'],_0x1d2d6d=await sales[_0x3a9c4f(0x1a4)](_0x5204c6);console[_0x3a9c4f(0x24f)](_0x1d2d6d);const _0x586432=await customer[_0x3a9c4f(0x1b3)]({'name':_0x1d2d6d[_0x3a9c4f(0x1dd)]});console['log'](_0x586432);if(_0x31a10c[0x0][_0x3a9c4f(0x22f)]==_0x3a9c4f(0x245)){var _0x537b38=users['English'];console[_0x3a9c4f(0x24f)](_0x537b38);}else{if(_0x31a10c[0x0][_0x3a9c4f(0x22f)]==_0x3a9c4f(0x223))var _0x537b38=users['Hindi'];else{if(_0x31a10c[0x0][_0x3a9c4f(0x22f)]==_0x3a9c4f(0x26c))var _0x537b38=users[_0x3a9c4f(0x26c)];else{if(_0x31a10c[0x0]['language']==_0x3a9c4f(0x26b))var _0x537b38=users['Spanish'];else{if(_0x31a10c[0x0][_0x3a9c4f(0x22f)]=='French')var _0x537b38=users[_0x3a9c4f(0x21b)];else{if(_0x31a10c[0x0][_0x3a9c4f(0x22f)]==_0x3a9c4f(0x1af))var _0x537b38=users['Portuguese'];else{if(_0x31a10c[0x0][_0x3a9c4f(0x22f)]==_0x3a9c4f(0x220))var _0x537b38=users[_0x3a9c4f(0x220)];else{if(_0x31a10c[0x0][_0x3a9c4f(0x22f)]==_0x3a9c4f(0x250))var _0x537b38=users['Arabic'];}}}}}}}_0x400d51[_0x3a9c4f(0x256)](_0x3a9c4f(0x269),{'success':_0x39582e[_0x3a9c4f(0x274)]('success'),'errors':_0x39582e[_0x3a9c4f(0x274)](_0x3a9c4f(0x271)),'role':_0x418324,'profile':_0x92dbe,'master_shop':_0x31a10c,'customers':_0x586432,'sales':_0x1d2d6d,'language':_0x537b38});}catch(_0xf6367){console['log'](_0xf6367);}}),router[a0_0x78579f(0x296)]('/view/return_sales/:id',auth,async(_0x575154,_0x2c14e6)=>{var _0x58e03a=a0_0x78579f;try{const {username:_0x40ab1e,email:_0x25b262,role:_0x2c3221}=_0x575154['user'],_0x2508f7=_0x575154['user'],_0x1e19ac=await profile['findOne']({'email':_0x2508f7['email']}),_0x8b3ad4=await master_shop[_0x58e03a(0x2a0)]();console[_0x58e03a(0x24f)](_0x58e03a(0x272),_0x8b3ad4);const _0x3c7111=_0x575154['params']['id'];console[_0x58e03a(0x24f)](_0x3c7111);const _0x7d3b9f=await sales[_0x58e03a(0x1a4)](_0x3c7111);console['log'](_0x58e03a(0x247),_0x7d3b9f);const _0x4d6732=await warehouse[_0x58e03a(0x231)]([{'$match':{'name':_0x58e03a(0x25b),'room':_0x58e03a(0x1bf)}},{'$unwind':_0x58e03a(0x263)},{'$group':{'_id':_0x58e03a(0x1c6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x58e03a(0x1da)},'level':{'$first':_0x58e03a(0x205)},'isle':{'$first':_0x58e03a(0x23c)},'pallet':{'$first':_0x58e03a(0x1cf)},'primary_code':{'$first':_0x58e03a(0x1a9)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x58e03a(0x251)}}}]);console[_0x58e03a(0x24f)](_0x58e03a(0x1e5),_0x4d6732);const _0x615b92=await product[_0x58e03a(0x2a0)]({});warehouse_data=await warehouse[_0x58e03a(0x231)]([{'$match':{'status':'Enabled','name':_0x58e03a(0x25b),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x58e03a(0x1c5),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);var _0x1b369e=[_0x58e03a(0x1bf)];if(_0x8b3ad4[0x0][_0x58e03a(0x22f)]==_0x58e03a(0x245)){var _0x3924f1=users[_0x58e03a(0x29b)];console['log'](_0x3924f1);}else{if(_0x8b3ad4[0x0][_0x58e03a(0x22f)]==_0x58e03a(0x223))var _0x3924f1=users['Hindi'];else{if(_0x8b3ad4[0x0][_0x58e03a(0x22f)]==_0x58e03a(0x26c))var _0x3924f1=users[_0x58e03a(0x26c)];else{if(_0x8b3ad4[0x0]['language']=='Spanish')var _0x3924f1=users[_0x58e03a(0x26b)];else{if(_0x8b3ad4[0x0][_0x58e03a(0x22f)]==_0x58e03a(0x21b))var _0x3924f1=users[_0x58e03a(0x21b)];else{if(_0x8b3ad4[0x0][_0x58e03a(0x22f)]=='Portuguese\x20(BR)')var _0x3924f1=users[_0x58e03a(0x1ea)];else{if(_0x8b3ad4[0x0]['language']==_0x58e03a(0x220))var _0x3924f1=users[_0x58e03a(0x220)];else{if(_0x8b3ad4[0x0][_0x58e03a(0x22f)]==_0x58e03a(0x250))var _0x3924f1=users[_0x58e03a(0x22e)];}}}}}}}_0x2c14e6['render'](_0x58e03a(0x1ba),{'success':_0x575154[_0x58e03a(0x274)]('success'),'errors':_0x575154['flash'](_0x58e03a(0x271)),'role':_0x2508f7,'profile':_0x1e19ac,'user':_0x7d3b9f,'stock':_0x4d6732,'master_shop':_0x8b3ad4,'unit':_0x615b92,'language':_0x3924f1,'warehouses':warehouse_data,'rooms':_0x1b369e});}catch(_0x449e06){console[_0x58e03a(0x24f)](_0x449e06),_0x2c14e6[_0x58e03a(0x204)](0xc8)[_0x58e03a(0x1a2)]({'message':_0x449e06[_0x58e03a(0x2a1)]});}}),router[a0_0x78579f(0x1e6)](a0_0x78579f(0x252),auth,async(_0x44b3c8,_0x89bf36)=>{var _0x28939c=a0_0x78579f;try{const {invoice:_0x4d30c4,date:_0x2ee74c,warehouse_name:_0x136ca6,product_name:_0x918412,primary_code:_0x5805c2,secondary_code:_0x25aa43,product_code:_0x4e9e8c,sales_quantity:_0x591b3d,stocks:_0x381bf9,return_qty:_0x1bf317,Room_name:_0x3c32bd,to_warehouse_name:_0x3cab80,to_Roomname:_0x447d36,to_Room_name:_0x497458,note:_0x30cd8f,level:_0x20c472,isle:_0x1c2dc7,pallet:_0x3b41fb}=_0x44b3c8['body'];if(typeof _0x918412=='string')var _0x4ef42b=[_0x44b3c8[_0x28939c(0x2ad)]['product_name']],_0x2f4d51=[_0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x1b6)]],_0x1cf47a=[_0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x1f9)]],_0x56b66e=[_0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x1d1)]],_0x121b19=[_0x44b3c8['body'][_0x28939c(0x21a)]],_0x15db31=[_0x44b3c8[_0x28939c(0x2ad)]['stocks']],_0x5df027=[_0x44b3c8['body'][_0x28939c(0x1d9)]],_0x240133=[_0x44b3c8[_0x28939c(0x2ad)]['bay']],_0x239842=[_0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x29d)]],_0x339859=[_0x44b3c8['body'][_0x28939c(0x1ad)]],_0x3616b1=[_0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x2a3)]];else var _0x4ef42b=[..._0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x285)]],_0x2f4d51=[..._0x44b3c8['body'][_0x28939c(0x1b6)]],_0x1cf47a=[..._0x44b3c8[_0x28939c(0x2ad)]['secondary_code']],_0x56b66e=[..._0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x1d1)]],_0x121b19=[..._0x44b3c8[_0x28939c(0x2ad)]['sales_quantity']],_0x15db31=[..._0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x1ae)]],_0x5df027=[..._0x44b3c8['body'][_0x28939c(0x1d9)]],_0x240133=[..._0x44b3c8['body'][_0x28939c(0x23a)]],_0x239842=[..._0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x29d)]],_0x339859=[..._0x44b3c8[_0x28939c(0x2ad)]['types']],_0x3616b1=[..._0x44b3c8[_0x28939c(0x2ad)]['floorlevel']];const _0x20c991=_0x4ef42b[_0x28939c(0x1cc)](_0x8cf627=>{return _0x8cf627={'product_name':_0x8cf627};});_0x2f4d51[_0x28939c(0x295)]((_0x3bc5f0,_0x46c0df)=>{var _0x5ee2cc=_0x28939c;_0x20c991[_0x46c0df][_0x5ee2cc(0x1b6)]=_0x3bc5f0;}),_0x1cf47a[_0x28939c(0x295)]((_0x188eeb,_0x39ac41)=>{var _0x3fa863=_0x28939c;_0x20c991[_0x39ac41][_0x3fa863(0x1f9)]=_0x188eeb;}),_0x56b66e[_0x28939c(0x295)]((_0x41e4f3,_0x9304ad)=>{var _0x158e62=_0x28939c;_0x20c991[_0x9304ad][_0x158e62(0x1d1)]=_0x41e4f3;}),_0x121b19[_0x28939c(0x295)]((_0x54c4fa,_0x1373ac)=>{var _0x3b5b35=_0x28939c;_0x20c991[_0x1373ac][_0x3b5b35(0x1ab)]=_0x54c4fa;}),_0x15db31[_0x28939c(0x295)]((_0x307eee,_0x5d06ce)=>{var _0x132587=_0x28939c;_0x20c991[_0x5d06ce][_0x132587(0x1db)]=_0x307eee;}),_0x5df027['forEach']((_0x11c810,_0x15f9b9)=>{var _0x221ee9=_0x28939c;_0x20c991[_0x15f9b9][_0x221ee9(0x1d9)]=_0x11c810;}),_0x240133['forEach']((_0x383151,_0x394a94)=>{var _0x445256=_0x28939c;_0x20c991[_0x394a94][_0x445256(0x23a)]=_0x383151;}),_0x239842[_0x28939c(0x295)]((_0x357234,_0xd17694)=>{var _0x415b6a=_0x28939c;_0x20c991[_0xd17694][_0x415b6a(0x29d)]=_0x357234;}),_0x339859[_0x28939c(0x295)]((_0x4be626,_0x1dd334)=>{var _0x5e2148=_0x28939c;_0x20c991[_0x1dd334][_0x5e2148(0x213)]=_0x4be626;}),_0x3616b1[_0x28939c(0x295)]((_0x52bf7d,_0x14ac90)=>{var _0x5052e7=_0x28939c;_0x20c991[_0x14ac90][_0x5052e7(0x2a3)]=_0x52bf7d;});var _0x33cdb7=0x0;_0x20c991['forEach'](_0x1fcc46=>{var _0x1a7178=_0x28939c;console[_0x1a7178(0x24f)](_0x1a7178(0x2aa),_0x1fcc46),(parseInt(_0x1fcc46[_0x1a7178(0x1ab)])<parseInt(_0x1fcc46[_0x1a7178(0x1d9)])||parseInt(_0x1fcc46[_0x1a7178(0x1db)])<parseInt(_0x1fcc46[_0x1a7178(0x1d9)])&&parseInt(_0x1fcc46['sale_qty'])>parseInt(_0x1fcc46[_0x1a7178(0x1d9)])||parseInt(_0x1fcc46[_0x1a7178(0x1d9)])==0x0)&&_0x33cdb7++;});if(_0x33cdb7!=0x0)return _0x44b3c8['flash']('errors',_0x28939c(0x21f)),_0x89bf36[_0x28939c(0x1f6)]('back');const _0x2f4482=await sales[_0x28939c(0x1b3)]({'invoice':_0x4d30c4});console[_0x28939c(0x24f)](_0x2f4482),_0x2f4482['return_data']=_0x28939c(0x1d6);const _0x37e5ae=await _0x2f4482[_0x28939c(0x2a7)](),_0x1e3f0c=new sales_return({'invoice':_0x4d30c4,'customer':_0x44b3c8[_0x28939c(0x2ad)][_0x28939c(0x1dd)],'date':_0x2ee74c,'warehouse_name':_0x136ca6,'room':_0x3c32bd,'ToWarehouse':_0x3cab80,'ToRoom':_0x497458,'return_sale':_0x20c991,'note':_0x30cd8f}),_0xf6c40b=await _0x1e3f0c[_0x28939c(0x2a7)]();console[_0x28939c(0x24f)](_0x1e3f0c);const _0x223874=await sales_return[_0x28939c(0x1b3)]({'invoice':_0x4d30c4}),_0x3505a0=await warehouse[_0x28939c(0x1b3)]({'name':_0x3cab80,'room':_0x497458});_0x223874[_0x28939c(0x1ba)]['forEach'](_0x568440=>{var _0x32153b=_0x28939c,_0x3581bf=0x0;const _0x476d2a=_0x3505a0[_0x32153b(0x1b7)][_0x32153b(0x1cc)](_0x48f464=>{var _0xdc4170=_0x32153b;_0x48f464[_0xdc4170(0x285)]==_0x568440[_0xdc4170(0x285)]&&_0x48f464[_0xdc4170(0x2a3)]==_0x568440[_0xdc4170(0x2a3)]&&_0x48f464['type']==_0x568440[_0xdc4170(0x213)]&&_0x48f464[_0xdc4170(0x29d)]==_0x568440[_0xdc4170(0x29d)]&&_0x48f464[_0xdc4170(0x23a)]==_0x568440[_0xdc4170(0x23a)]&&(_0x48f464['product_stock']=parseInt(_0x48f464[_0xdc4170(0x260)])+parseInt(_0x568440[_0xdc4170(0x1d9)]),_0x3581bf++);});_0x3581bf=='0'&&(_0x3505a0[_0x32153b(0x1b7)]=_0x3505a0[_0x32153b(0x1b7)]['concat']({'product_name':_0x568440['product_name'],'product_stock':_0x568440['return_qty'],'primary_code':_0x568440['primary_code'],'secondary_code':_0x568440[_0x32153b(0x1f9)],'product_code':_0x568440[_0x32153b(0x1d1)],'bay':_0x568440['bay'],'bin':_0x568440['bin'],'type':_0x568440[_0x32153b(0x213)],'floorlevel':_0x568440[_0x32153b(0x2a3)]})),console[_0x32153b(0x24f)]('final',_0x3505a0);}),await _0x3505a0[_0x28939c(0x2a7)](),console[_0x28939c(0x24f)](_0x44b3c8[_0x28939c(0x2ad)]);const _0x5c05e6=new c_payment_data({'invoice':_0x4d30c4,'customer':_0x44b3c8['body'][_0x28939c(0x1dd)],'reason':_0x28939c(0x1f8)});await _0x5c05e6[_0x28939c(0x2a7)]();const _0x514407=await master_shop[_0x28939c(0x2a0)]();console[_0x28939c(0x24f)](_0x28939c(0x273),_0x514407[0x0][_0x28939c(0x1c9)]);const _0x3d941a=await email_settings[_0x28939c(0x1b3)](),_0x65d091=await customer['findOne']({'name':_0x44b3c8['body'][_0x28939c(0x1dd)]});console[_0x28939c(0x24f)](_0x28939c(0x1d0),_0x65d091);_0x514407[0x0][_0x28939c(0x25d)]==0x1?(right_currency=_0x514407[0x0][_0x28939c(0x1df)],left_currency=''):(right_currency='',left_currency=_0x514407[0x0][_0x28939c(0x1df)]);var _0x3614ef=_0x4ef42b,_0x9aa950=_0x5df027,_0x4e30f3='',_0x4b1c0d;for(_0x4b1c0d in _0x3614ef){_0x4e30f3+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3614ef[_0x4b1c0d]+'</td>'+_0x28939c(0x236)+_0x9aa950[_0x4b1c0d]+_0x28939c(0x23e)+_0x28939c(0x1b1);}console[_0x28939c(0x24f)](_0x28939c(0x1a6),_0x4e30f3);let _0x26de6e=nodemailer[_0x28939c(0x21c)]({'service':_0x28939c(0x201),'auth':{'user':_0x3d941a['email'],'pass':_0x3d941a['password']}}),_0x216969={'from':_0x3d941a[_0x28939c(0x1f2)],'to':_0x65d091[_0x28939c(0x1f2)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x28939c(0x27b)+'/upload/'+_0x514407[0x0][_0x28939c(0x1c9)],'cid':_0x28939c(0x26e)}],'html':_0x28939c(0x200)+_0x28939c(0x1e3)+_0x28939c(0x1fd)+_0x28939c(0x206)+_0x28939c(0x29f)+_0x28939c(0x206)+_0x28939c(0x2a5)+'</div>'+_0x28939c(0x206)+'<h2>\x20'+_0x514407[0x0][_0x28939c(0x1ac)]+_0x28939c(0x1e9)+_0x28939c(0x255)+_0x28939c(0x255)+_0x28939c(0x24e)+'<div>'+_0x28939c(0x1e4)+_0x28939c(0x239)+_0x4d30c4+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x28939c(0x1f0)+_0x2ee74c+'\x20'+'</span>'+_0x28939c(0x1e2)+_0x28939c(0x255)+_0x28939c(0x1dc)+_0x28939c(0x1ef)+_0x28939c(0x265)+_0x28939c(0x2a4)+_0x28939c(0x224)+_0x28939c(0x1c0)+_0x28939c(0x24b)+_0x28939c(0x1b1)+_0x28939c(0x234)+_0x28939c(0x235)+'\x20'+_0x4e30f3+'\x20'+'</tbody>'+_0x28939c(0x1f3)+'<div>'+_0x28939c(0x291)+_0x28939c(0x1f5)+_0x514407[0x0][_0x28939c(0x1ac)]+_0x28939c(0x1e2)+_0x28939c(0x255)+_0x28939c(0x255)+'</body></html>'};_0x26de6e[_0x28939c(0x218)](_0x216969,function(_0x90b49b,_0x1f13d9){var _0x1611d2=_0x28939c;_0x90b49b?(console[_0x1611d2(0x24f)](_0x90b49b),console[_0x1611d2(0x24f)]('Error\x20Occurs')):console[_0x1611d2(0x24f)](_0x1611d2(0x1a7));}),_0x44b3c8[_0x28939c(0x274)](_0x28939c(0x2a2),_0x28939c(0x228)),_0x89bf36[_0x28939c(0x1f6)](_0x28939c(0x222));}catch(_0x46b0e0){console['log'](_0x46b0e0),_0x89bf36[_0x28939c(0x204)](0xc8)[_0x28939c(0x1a2)]({'message1':_0x46b0e0[_0x28939c(0x2a1)]});}}),router['get'](a0_0x78579f(0x28c),auth,async(_0x357413,_0x111334)=>{var _0x34d518=a0_0x78579f;try{const {username:_0x42cc61,email:_0xe24038,role:_0x4184df}=_0x357413['user'],_0x448da7=_0x357413[_0x34d518(0x293)],_0x2297b0=await profile[_0x34d518(0x1b3)]({'email':_0x448da7['email']}),_0x22c993=await master_shop[_0x34d518(0x2a0)]();console[_0x34d518(0x24f)](_0x34d518(0x267),_0x22c993);const _0xf1dfce=_0x357413[_0x34d518(0x1f1)]['id'],_0x13b645=await sales[_0x34d518(0x1a4)](_0xf1dfce);console[_0x34d518(0x24f)](_0x34d518(0x1ca),_0x13b645);if(_0x22c993[0x0]['language']==_0x34d518(0x245))var _0x15cd29=users[_0x34d518(0x29b)];else{if(_0x22c993[0x0]['language']==_0x34d518(0x223))var _0x15cd29=users[_0x34d518(0x223)];else{if(_0x22c993[0x0][_0x34d518(0x22f)]=='German')var _0x15cd29=users[_0x34d518(0x26c)];else{if(_0x22c993[0x0][_0x34d518(0x22f)]==_0x34d518(0x26b))var _0x15cd29=users[_0x34d518(0x26b)];else{if(_0x22c993[0x0][_0x34d518(0x22f)]=='French')var _0x15cd29=users[_0x34d518(0x21b)];else{if(_0x22c993[0x0][_0x34d518(0x22f)]==_0x34d518(0x1af))var _0x15cd29=users['Portuguese'];else{if(_0x22c993[0x0][_0x34d518(0x22f)]==_0x34d518(0x220))var _0x15cd29=users['Chinese'];else{if(_0x22c993[0x0][_0x34d518(0x22f)]==_0x34d518(0x250))var _0x15cd29=users[_0x34d518(0x22e)];}}}}}}}_0x111334[_0x34d518(0x256)](_0x34d518(0x227),{'success':_0x357413['flash'](_0x34d518(0x2a2)),'errors':_0x357413['flash'](_0x34d518(0x271)),'role':_0x448da7,'profile':_0x2297b0,'alldata':_0x13b645,'master_shop':_0x22c993,'language':_0x15cd29});}catch(_0x54a348){console['log'](_0x54a348);}}),router[a0_0x78579f(0x1e6)](a0_0x78579f(0x20e),async(_0x58a7b6,_0x5f3d5c)=>{var _0x318e86=a0_0x78579f;const {product_code:_0x3d40da,warehouse_name:_0x2814a2,rooms_data:_0x150990,Roomslist:_0x511de7}=_0x58a7b6[_0x318e86(0x2ad)],_0xf650b9=_0x511de7[_0x318e86(0x268)](','),_0x322859=[];async function _0x1ae6a4(_0x29e01a){var _0x11fa0b=_0x318e86;const _0x584295=await warehouse[_0x11fa0b(0x231)]([{'$match':{'name':_0x2814a2,'room':_0x29e01a}},{'$unwind':_0x11fa0b(0x263)},{'$match':{'product_details.primary_code':_0x3d40da}},{'$group':{'_id':_0x11fa0b(0x1c6),'name':{'$first':_0x11fa0b(0x1aa)},'product_stock':{'$first':_0x11fa0b(0x1da)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x11fa0b(0x1b2)},'product_code':{'$first':_0x11fa0b(0x251)},'level':{'$first':_0x11fa0b(0x20f)},'isle':{'$first':_0x11fa0b(0x1c2)},'type':{'$first':_0x11fa0b(0x23f)},'pallet':{'$first':_0x11fa0b(0x28f)},'unit':{'$first':_0x11fa0b(0x238)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x11fa0b(0x29e)},'rack':{'$first':_0x11fa0b(0x24a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x11fa0b(0x1c7)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x11fa0b(0x1c8)},'product_cat':{'$first':_0x11fa0b(0x1b5)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x11fa0b(0x28d)},'invoice':{'$first':_0x11fa0b(0x270)},'actual_qty':{'$first':_0x11fa0b(0x279)}}}]),_0x5d76dd=await warehouse[_0x11fa0b(0x231)]([{'$match':{'name':_0x2814a2,'room':_0x29e01a}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3d40da}},{'$group':{'_id':_0x11fa0b(0x1c6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x11fa0b(0x1da)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x11fa0b(0x20f)},'isle':{'$first':_0x11fa0b(0x1c2)},'type':{'$first':_0x11fa0b(0x23f)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x11fa0b(0x1fe)},'storage':{'$first':_0x11fa0b(0x29e)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x11fa0b(0x258)},'production_date':{'$first':_0x11fa0b(0x1c7)},'maxPerUnit':{'$first':_0x11fa0b(0x1d7)},'batch_code':{'$first':_0x11fa0b(0x1c8)},'product_cat':{'$first':_0x11fa0b(0x1b5)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x11fa0b(0x28d)},'invoice':{'$first':_0x11fa0b(0x270)}}}]);if(_0x584295[_0x11fa0b(0x27d)]>0x0)_0x322859[_0x11fa0b(0x230)](_0x584295);else _0x5d76dd[_0x11fa0b(0x27d)]>0x0&&_0x322859['push'](_0x5d76dd);}const _0x20abc0=_0xf650b9[_0x318e86(0x1cc)](_0x2ce395=>_0x1ae6a4(_0x2ce395));await Promise[_0x318e86(0x21e)](_0x20abc0),_0x5f3d5c['json'](_0x322859);}),module[a0_0x78579f(0x26a)]=router;