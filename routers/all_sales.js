var a0_0x3a0f71=a0_0x49dd;(function(_0x1ba131,_0x531b4b){var _0x142d96=a0_0x49dd,_0xd4aeb0=_0x1ba131();while(!![]){try{var _0x149bb8=-parseInt(_0x142d96(0xd6))/0x1*(parseInt(_0x142d96(0x114))/0x2)+-parseInt(_0x142d96(0x1c3))/0x3+-parseInt(_0x142d96(0x1bf))/0x4+parseInt(_0x142d96(0x100))/0x5*(parseInt(_0x142d96(0x136))/0x6)+parseInt(_0x142d96(0x19b))/0x7*(parseInt(_0x142d96(0xf8))/0x8)+parseInt(_0x142d96(0x1ab))/0x9*(-parseInt(_0x142d96(0x1d3))/0xa)+parseInt(_0x142d96(0x18d))/0xb*(parseInt(_0x142d96(0x198))/0xc);if(_0x149bb8===_0x531b4b)break;else _0xd4aeb0['push'](_0xd4aeb0['shift']());}catch(_0x1e5f24){_0xd4aeb0['push'](_0xd4aeb0['shift']());}}}(a0_0x265f,0x87f57));function a0_0x49dd(_0x40b1c4,_0x433866){var _0x265f37=a0_0x265f();return a0_0x49dd=function(_0x49ddf5,_0x3dc9b5){_0x49ddf5=_0x49ddf5-0xd5;var _0x26419e=_0x265f37[_0x49ddf5];return _0x26419e;},a0_0x49dd(_0x40b1c4,_0x433866);}const express=require(a0_0x3a0f71(0x138)),app=express(),router=express[a0_0x3a0f71(0x11f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,supervisor_settings}=require(a0_0x3a0f71(0x11b)),auth=require(a0_0x3a0f71(0x168)),nodemailer=require(a0_0x3a0f71(0x1e2)),users=require('../public/language/languages.json');function a0_0x265f(){var _0x43c118=['received_amount','aggregate','isAllowEdit','$invoice','expiry_date','stock','errors','/view/add_sales','$product_details.unit','payment\x20successfull','\x20</h2>','getDate','3362ytfwUs','foreach\x20newproduct','secondary_unit','gmail','$product_details.product_stock','customer','/view/return_sales/:id','../models/all_models','split','Portuguese','storage','Router','\x20Order\x20Date\x20:\x20','primary_unit','$product_details.type','logo','sales\x20item\x20return\x20successfull','$product_details.product_cat','slice','customers_docs','$finalize','concat','delivery_code','$sale_product.quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','room_name','<tbody\x20style=\x22text-align:\x20center;\x22>','<strong>\x20Regards\x20</strong>','save','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','master','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','sales\x20all_data','5538ZTJlsp','note','express','warehouse_name','carton','all','all_sales_barcode','params','exports','$product_details.bin','site_title','$product_details.pallet','$sale_product','product_code','$sale_product.bay','English\x20(US)','<div>','Hindi','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','password','product_stock','Shelves','success','message','currency_placement','level','</tbody>','catch','delivery_date','/barcode_scanner','</tr>','port','</span>','sale_qty','An\x20error\x20occurred\x20while\x20saving\x20data.','name','invoice','Raw\x20Materials','/preview/:id','product_details','Enabled','all_sales','maxperunit','forEach','rack','Arabic\x20(ae)','stocks','requested_qty','<html><head><title></title>','$warehouse_name','../middleware/auth','secondary_code','Sales\x20Add\x20successfully','floorlevel','/view','customers','log','findById','$sale_product.type','$product_details.maxPerUnit','Spanish','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Chinese','prod_cat','padStart','render','staff','error','sales_invoice','edit_sales','stock_data','$product_details.floorlevel','role','/barcode/:id','customer_data','unit','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','True','type','getFullYear','<tr>','$product_details.isle','<span\x20style=\x22float:\x20right;\x22>','return_qty','warehouse','redirect','Error\x20Occurs','295702YCdqKO','map','primary_code','edit_sales_view','Sale\x20Return','add\x20post','/all_sales/preview/','$sale_product.floorlevel','<h2>\x20','<hr\x20class=\x22my-3\x22>','English','672meQBga','$product_details.secondary_unit','max_per_unit','221893HvHkgf','\x20Order\x20Number\x20:\x20','prod_invoice','$product_details.storage','getMonth','sendMail','language','quantity','<h5\x20style=\x22text-align:\x20left;\x22>','types','</td>','/all_sales/view','/give_payment/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','return_sale','host','9ekcjmZ','flash','Sales\x20Update\x20successfully','product','Return\x20Rooms','Logo.png','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','French','add_sales','$product_details.secondary_code','Receiving\x20Area','$product_details.primary_code','email','product_name','bay','Received\x20Payment\x20For\x20Sale','SCRN','$product_details.bay','body','1221008VcwFam','<!DOCTYPE\x20html>','RoomAssigned','$customers_docs','583698oecMNS','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.batch_code','bin','</h5>','$product_details.expiry_date','batch_code','length','$product_details.invoice','sales_quantity','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','_id','$isAllowEdit','push','</table>','product_data','7025480BwvzXO','post','$product_details.product_name','German','Level','$product_details.production_date','Sale\x20Return\x20Mail','$date','<h5>','OUT-','Email\x20sent\x20successfully','Ambient','image','amount','$product_details.rack','nodemailer','/view/:id','An\x20error\x20occurred.','sale_product','quantity_notConverted','return_data','Arabic','final','$_id','$product_details.product_code','467OMmRFE','barcode\x20user_id','purchases_data','False','string','user','get','$product_details._id','createTransport','/../public','$customer','$note','Portuguese\x20(BR)','barcode\x20Product\x20master','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$name','due_amount','$room','Enclosed','</thead>','find','production_date','/invoice/:id','status','floor','random','json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.level','Sales\x20Mail','then','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</head><body>','176NDpNVK','</body></html>','prod_code','/view/add_sale/product','finalize','$product_details','currency','</div>','1850KrjVjR','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Return\x20Goods','user_id','/view/add_sales/:id','/upload/','findOne','filter'];a0_0x265f=function(){return _0x43c118;};return a0_0x265f();}router[a0_0x3a0f71(0xdc)](a0_0x3a0f71(0x16c),auth,async(_0xb6107d,_0x9fe8)=>{var _0x501d49=a0_0x3a0f71;try{const {username:_0x57316a,email:_0x2f7092,role:_0x21e6e3}=_0xb6107d[_0x501d49(0xdb)],_0x1380b0=_0xb6107d[_0x501d49(0xdb)],_0x3fe380=await profile[_0x501d49(0x106)]({'email':_0x1380b0['email']}),_0x2452c9=await master_shop[_0x501d49(0xea)]();let _0x113c51;if(_0x1380b0[_0x501d49(0x17e)]==_0x501d49(0x178)){const _0x1c19f4=await staff[_0x501d49(0x106)]({'email':_0x1380b0[_0x501d49(0x1b8)]});_0x113c51=await sales[_0x501d49(0x109)]([{'$lookup':{'from':_0x501d49(0x16d),'localField':_0x501d49(0x119),'foreignField':_0x501d49(0x159),'as':_0x501d49(0x127)}},{'$unwind':'$customers_docs'},{'$unwind':_0x501d49(0x142)},{'$group':{'_id':_0x501d49(0x1ea),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x501d49(0xe0)},'date':{'$first':_0x501d49(0x1da)},'warehouse_name':{'$first':_0x501d49(0x167)},'sale_product':{'$push':_0x501d49(0x142)},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x501d49(0x1c2)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x501d49(0x144)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x501d49(0x170)},'pallet':{'$addToSet':_0x501d49(0x194)},'finalize':{'$first':_0x501d49(0x128)},'isAllowEdit':{'$first':_0x501d49(0x1cf)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);}else _0x113c51=await sales[_0x501d49(0x109)]([{'$lookup':{'from':_0x501d49(0x16d),'localField':_0x501d49(0x119),'foreignField':_0x501d49(0x159),'as':_0x501d49(0x127)}},{'$unwind':_0x501d49(0x1c2)},{'$unwind':_0x501d49(0x142)},{'$group':{'_id':_0x501d49(0x1ea),'invoice':{'$first':_0x501d49(0x10b)},'customers':{'$first':_0x501d49(0xe0)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x501d49(0x167)},'sale_product':{'$push':_0x501d49(0x142)},'note':{'$first':_0x501d49(0xe1)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x501d49(0x1c2)},'total_saleproduct_quantity':{'$sum':_0x501d49(0x12b)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x501d49(0x170)},'pallet':{'$addToSet':_0x501d49(0x194)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x501d49(0x1cf)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);console['log'](_0x501d49(0x135),_0x113c51);if(_0x2452c9[0x0][_0x501d49(0x1a1)]==_0x501d49(0x145)){var _0x52e4ef=users[_0x501d49(0x197)];console['log'](_0x52e4ef);}else{if(_0x2452c9[0x0]['language']==_0x501d49(0x147))var _0x52e4ef=users[_0x501d49(0x147)];else{if(_0x2452c9[0x0][_0x501d49(0x1a1)]==_0x501d49(0x1d6))var _0x52e4ef=users[_0x501d49(0x1d6)];else{if(_0x2452c9[0x0][_0x501d49(0x1a1)]=='Spanish')var _0x52e4ef=users[_0x501d49(0x172)];else{if(_0x2452c9[0x0]['language']=='French')var _0x52e4ef=users[_0x501d49(0x1b3)];else{if(_0x2452c9[0x0][_0x501d49(0x1a1)]=='Portuguese\x20(BR)')var _0x52e4ef=users[_0x501d49(0x11d)];else{if(_0x2452c9[0x0]['language']==_0x501d49(0x174))var _0x52e4ef=users[_0x501d49(0x174)];else{if(_0x2452c9[0x0][_0x501d49(0x1a1)]=='Arabic\x20(ae)')var _0x52e4ef=users[_0x501d49(0x1e8)];}}}}}}}_0x9fe8[_0x501d49(0x177)](_0x501d49(0x15f),{'success':_0xb6107d[_0x501d49(0x1ac)]('success'),'errors':_0xb6107d[_0x501d49(0x1ac)](_0x501d49(0x10e)),'sales':_0x113c51,'profile':_0x3fe380,'role':_0x1380b0,'master_shop':_0x2452c9,'language':_0x52e4ef});}catch(_0x45194a){console['log'](_0x45194a);}});async function getRandom8DigitNumber(){var _0x140098=a0_0x3a0f71;const _0xfc4993=0x989680,_0x13f367=0x5f5e0ff,_0x42b517=Math[_0x140098(0xee)](Math[_0x140098(0xef)]()*(_0x13f367-_0xfc4993+0x1))+_0xfc4993;var _0x2e0461;const _0x2b8535=await sales[_0x140098(0x106)]({'invoice':_0x140098(0x1dc)+_0x42b517});return _0x2b8535&&_0x2b8535[_0x140098(0x1ca)]>0x0?_0x2e0461='OUT-'+_0x42b517:_0x2e0461='OUT-'+_0x42b517,_0x2e0461;}router['get'](a0_0x3a0f71(0x10f),auth,async(_0x56b82d,_0x3b12df)=>{var _0x3e9ba8=a0_0x3a0f71;try{const {username:_0x128c43,email:_0x43a69b,role:_0x486c6c}=_0x56b82d[_0x3e9ba8(0xdb)],_0x9355de=_0x56b82d[_0x3e9ba8(0xdb)],_0x425e63=await profile[_0x3e9ba8(0x106)]({'email':_0x9355de[_0x3e9ba8(0x1b8)]}),_0xe899e0=await master_shop[_0x3e9ba8(0xea)](),_0x304553=await customer[_0x3e9ba8(0xea)]({});let _0x2bdba3;if(_0x9355de['role']==_0x3e9ba8(0x178)){const _0x55a0ab=await staff[_0x3e9ba8(0x106)]({'email':_0x9355de[_0x3e9ba8(0x1b8)]});_0x2bdba3=await warehouse[_0x3e9ba8(0x109)]([{'$match':{'status':_0x3e9ba8(0x15e),'name':_0x55a0ab['warehouse'],'warehouse_category':_0x3e9ba8(0x15b),'name':{'$ne':_0x3e9ba8(0x102)}}},{'$group':{'_id':_0x3e9ba8(0xe5),'name':{'$first':_0x3e9ba8(0xe5)}}},{'$sort':{'name':0x1}}]);}else _0x2bdba3=await warehouse[_0x3e9ba8(0x109)]([{'$match':{'status':_0x3e9ba8(0x15e),'warehouse_category':_0x3e9ba8(0x15b),'name':{'$ne':_0x3e9ba8(0x102)}}},{'$group':{'_id':_0x3e9ba8(0xe5),'name':{'$first':_0x3e9ba8(0xe5)}}},{'$sort':{'name':0x1}}]);const _0x41a00d=await product['find']({});var _0x1ce1a4=[_0x3e9ba8(0x1de),_0x3e9ba8(0xe8)];const _0x45a33b=await sales[_0x3e9ba8(0xea)]({}),_0x387ab1=_0x45a33b['length']+0x1,_0x9fbabb=_0x3e9ba8(0x1dc)+_0x387ab1['toString']()[_0x3e9ba8(0x176)](0x5,'0');if(_0xe899e0[0x0]['language']==_0x3e9ba8(0x145)){var _0x16035d=users[_0x3e9ba8(0x197)];console[_0x3e9ba8(0x16e)](_0x16035d);}else{if(_0xe899e0[0x0][_0x3e9ba8(0x1a1)]==_0x3e9ba8(0x147))var _0x16035d=users[_0x3e9ba8(0x147)];else{if(_0xe899e0[0x0]['language']==_0x3e9ba8(0x1d6))var _0x16035d=users[_0x3e9ba8(0x1d6)];else{if(_0xe899e0[0x0][_0x3e9ba8(0x1a1)]==_0x3e9ba8(0x172))var _0x16035d=users[_0x3e9ba8(0x172)];else{if(_0xe899e0[0x0][_0x3e9ba8(0x1a1)]==_0x3e9ba8(0x1b3))var _0x16035d=users[_0x3e9ba8(0x1b3)];else{if(_0xe899e0[0x0]['language']==_0x3e9ba8(0xe2))var _0x16035d=users[_0x3e9ba8(0x11d)];else{if(_0xe899e0[0x0]['language']==_0x3e9ba8(0x174))var _0x16035d=users[_0x3e9ba8(0x174)];else{if(_0xe899e0[0x0][_0x3e9ba8(0x1a1)]==_0x3e9ba8(0x163))var _0x16035d=users['Arabic'];}}}}}}}const _0x14e041=getRandom8DigitNumber();_0x14e041['then'](_0x31fec0=>{var _0x138fef=_0x3e9ba8;_0x3b12df['render'](_0x138fef(0x1b4),{'success':_0x56b82d[_0x138fef(0x1ac)](_0x138fef(0x14c)),'errors':_0x56b82d['flash']('errors'),'role':_0x9355de,'profile':_0x425e63,'customer':_0x304553,'warehouse':_0x2bdba3,'product':_0x41a00d,'invoice':_0x31fec0,'master_shop':_0xe899e0,'language':_0x16035d,'rooms_data':_0x1ce1a4});})[_0x3e9ba8(0x151)](_0x308800=>{var _0x111fcd=_0x3e9ba8;_0x56b82d[_0x111fcd(0x1ac)](_0x111fcd(0x10e),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x3b12df[_0x111fcd(0x18b)](_0x111fcd(0x1a6));});}catch(_0x19c3b7){console['log'](_0x19c3b7);}}),router[a0_0x3a0f71(0xdc)](a0_0x3a0f71(0x104),auth,async(_0x9a7ec6,_0x2a81f3)=>{var _0x1abab6=a0_0x3a0f71;try{const _0x2280e9=_0x9a7ec6[_0x1abab6(0x13d)]['id'];console[_0x1abab6(0x16e)](_0x2280e9);const _0x5354cd=await product['find'](),_0x1d7ea6=await purchases[_0x1abab6(0x109)]([{'$match':{'warehouse_name':_0x2280e9}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]);console['log'](_0x1abab6(0xd8),_0x1d7ea6),_0x2a81f3[_0x1abab6(0xed)](0xc8)[_0x1abab6(0xf0)]({'purchases_data':_0x1d7ea6,'product_data':_0x5354cd});}catch(_0x4a8df6){console[_0x1abab6(0x16e)](_0x4a8df6);}}),router[a0_0x3a0f71(0x1d4)](a0_0x3a0f71(0xfb),auth,async(_0x9e7b80,_0x5f03ca)=>{var _0x173902=a0_0x3a0f71;try{const {warehouse_data:_0x44b091,product_data:_0x380af8}=_0x9e7b80[_0x173902(0x1be)];console[_0x173902(0x16e)](_0x9e7b80[_0x173902(0x1be)][_0x173902(0x1d2)]);;const _0xc29027=await master_shop['find']();console[_0x173902(0x16e)](_0x173902(0x132),_0xc29027);const _0x5aaf7e=await product[_0x173902(0x106)]({'name':_0x380af8});console['log'](_0x173902(0x1ae),_0x5aaf7e);const _0x3fd0bf=await warehouse['aggregate']([{'$match':{'name':_0x44b091}},{'$unwind':_0x173902(0xfd)},{'$match':{'product_details.product_name':_0x380af8}},{'$group':{'_id':_0x173902(0x1d5),'product_stock':{'$first':'$product_details.product_stock'}}}]);console[_0x173902(0x16e)](_0x173902(0x17c),_0x3fd0bf),_0x5f03ca[_0x173902(0xed)](0xc8)[_0x173902(0xf0)]({'master':_0xc29027,'new_product':_0x5aaf7e,'stock_data':_0x3fd0bf});}catch(_0x55ddbd){console[_0x173902(0x16e)](_0x55ddbd);}}),router[a0_0x3a0f71(0x1d4)](a0_0x3a0f71(0x10f),auth,async(_0x5ecc20,_0x5d0fa9)=>{var _0x4e071a=a0_0x3a0f71;try{const {invoice:_0x18de55,date:_0x1a0163,warehouse_name:_0x4f12c0,product_name:_0x28c566,stock:_0x422b34,quantity:_0x146485,note:_0xc662f5,room:_0x4125d4,primary_code:_0x19a862,secondary_code:_0x51f35f,prod_code:_0x41722b,level:_0x12bf0e,isle:_0x206257,pallet:_0x2c721c,batch_code:_0x209f13,SCRN:_0x4445b2,expiry_date:_0x4d37df}=_0x5ecc20[_0x4e071a(0x1be)];if(typeof _0x28c566==_0x4e071a(0xda))var _0x38af27=[_0x5ecc20[_0x4e071a(0x1be)]['product_name']],_0x5c517c=[_0x5ecc20[_0x4e071a(0x1be)]['stock']],_0xc079a8=[_0x5ecc20['body'][_0x4e071a(0x13a)]],_0x25ef53=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x18f)]],_0x52ebb0=[_0x5ecc20[_0x4e071a(0x1be)]['secondary_code']],_0x135565=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0xfa)]],_0x51c5c7=[_0x5ecc20[_0x4e071a(0x1be)]['level']],_0x2e5ee1=[_0x5ecc20[_0x4e071a(0x1be)]['primary_unit']],_0x251124=[_0x5ecc20[_0x4e071a(0x1be)]['secondary_unit']],_0x2ed54f=[_0x5ecc20['body'][_0x4e071a(0x1c9)]],_0x2ac863=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x10c)]],_0x4c4bac=[_0x5ecc20['body'][_0x4e071a(0x19a)]],_0x543925=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0xeb)]],_0xec9ef5=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x165)]],_0x395f83=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x152)]],_0x2e90a8=[_0x5ecc20[_0x4e071a(0x1be)]['delivery_code']],_0xaa2a80=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x175)]],_0x325165=[_0x5ecc20[_0x4e071a(0x1be)]['quantity']],_0x316203=[_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x1c1)]],_0x420000=[_0x5ecc20['body'][_0x4e071a(0x19d)]];else var _0x38af27=[..._0x5ecc20[_0x4e071a(0x1be)]['product_name']],_0x5c517c=[..._0x5ecc20['body']['stock']],_0xc079a8=[..._0x5ecc20['body'][_0x4e071a(0x13a)]],_0x25ef53=[..._0x5ecc20[_0x4e071a(0x1be)]['primary_code']],_0x52ebb0=[..._0x5ecc20['body'][_0x4e071a(0x169)]],_0x135565=[..._0x5ecc20['body'][_0x4e071a(0xfa)]],_0x51c5c7=[..._0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x14f)]],_0x2e5ee1=[..._0x5ecc20['body'][_0x4e071a(0x121)]],_0x251124=[..._0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x116)]],_0x2ed54f=[..._0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x1c9)]],_0x2ac863=[..._0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x10c)]],_0x4c4bac=[..._0x5ecc20['body'][_0x4e071a(0x19a)]],_0x543925=[..._0x5ecc20[_0x4e071a(0x1be)]['production_date']],_0xec9ef5=[..._0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x165)]],_0x395f83=[..._0x5ecc20['body']['delivery_date']],_0x2e90a8=[..._0x5ecc20[_0x4e071a(0x1be)]['delivery_code']],_0xaa2a80=[..._0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x175)]],_0x325165=[..._0x5ecc20['body'][_0x4e071a(0x1a2)]],_0x316203=[..._0x5ecc20[_0x4e071a(0x1be)]['RoomAssigned']],_0x420000=[..._0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x19d)]];const _0x54c439=_0x38af27[_0x4e071a(0x18e)](_0x450ffe=>{return _0x450ffe={'product_name':_0x450ffe};});_0x5c517c[_0x4e071a(0x161)]((_0x152b30,_0x20494d)=>{_0x54c439[_0x20494d]['stock']=_0x152b30;}),_0xc079a8[_0x4e071a(0x161)]((_0x408630,_0x3957df)=>{var _0x288e2d=_0x4e071a;_0x54c439[_0x3957df][_0x288e2d(0x1a2)]=_0x408630;}),_0x25ef53[_0x4e071a(0x161)]((_0x62d10f,_0x1c0744)=>{var _0x914df5=_0x4e071a;_0x54c439[_0x1c0744][_0x914df5(0x18f)]=_0x62d10f;}),_0x52ebb0[_0x4e071a(0x161)]((_0x528763,_0x4168ee)=>{var _0x3e884b=_0x4e071a;_0x54c439[_0x4168ee][_0x3e884b(0x169)]=_0x528763;}),_0x135565[_0x4e071a(0x161)]((_0x3992f6,_0x1b7c10)=>{_0x54c439[_0x1b7c10]['product_code']=_0x3992f6;}),_0x51c5c7[_0x4e071a(0x161)]((_0x27a6b6,_0x41e850)=>{var _0x5d092a=_0x4e071a;_0x316203[_0x5d092a(0x161)]((_0x201af3,_0x3cb314)=>{var _0x58c6e7=_0x5d092a;if(_0x201af3==_0x58c6e7(0x1b6)&&_0x41e850==_0x3cb314){var _0x1b3504=_0x27a6b6[_0x58c6e7(0x126)](0x3);_0x54c439[_0x41e850][_0x58c6e7(0x11e)]=_0x27a6b6[0x0],_0x54c439[_0x41e850][_0x58c6e7(0x162)]=_0x27a6b6[0x1],_0x54c439[_0x41e850][_0x58c6e7(0x1ba)]=0x0,_0x54c439[_0x41e850][_0x58c6e7(0x1c6)]=0x0,_0x54c439[_0x41e850][_0x58c6e7(0x184)]=_0x58c6e7(0x1b1),_0x54c439[_0x41e850]['floorlevel']=_0x1b3504;}else{if(_0x201af3==_0x58c6e7(0x14b)&&_0x41e850==_0x3cb314){var _0x1b3504=_0x27a6b6[_0x58c6e7(0x126)](0x3);_0x54c439[_0x41e850][_0x58c6e7(0x11e)]=_0x27a6b6[0x0],_0x54c439[_0x41e850][_0x58c6e7(0x162)]=_0x27a6b6[0x1],_0x54c439[_0x41e850]['bay']=0x0,_0x54c439[_0x41e850][_0x58c6e7(0x1c6)]=0x0,_0x54c439[_0x41e850][_0x58c6e7(0x184)]=_0x58c6e7(0x1b1),_0x54c439[_0x41e850]['floorlevel']=_0x27a6b6[0x5];}else{if(_0x41e850==_0x3cb314){var _0x1c3c2c;if(_0x27a6b6[0x4]=='L')_0x1c3c2c=_0x58c6e7(0x1d7);else _0x27a6b6[0x4]=='F'&&(_0x1c3c2c='Floor');_0x54c439[_0x41e850][_0x58c6e7(0x11e)]=_0x27a6b6[0x0],_0x54c439[_0x41e850][_0x58c6e7(0x162)]=_0x27a6b6[0x1],_0x54c439[_0x41e850][_0x58c6e7(0x1ba)]=_0x27a6b6[0x2],_0x54c439[_0x41e850][_0x58c6e7(0x1c6)]=_0x27a6b6[0x3],_0x54c439[_0x41e850][_0x58c6e7(0x184)]=_0x1c3c2c,_0x54c439[_0x41e850][_0x58c6e7(0x16b)]=_0x27a6b6[0x5];}}}});}),_0x2e5ee1[_0x4e071a(0x161)]((_0x354b6b,_0x1b2cc1)=>{var _0x21ecfa=_0x4e071a;_0x54c439[_0x1b2cc1][_0x21ecfa(0x181)]=_0x354b6b;}),_0x251124[_0x4e071a(0x161)]((_0x15b4f8,_0x55622b)=>{var _0x1ecc4d=_0x4e071a;_0x54c439[_0x55622b][_0x1ecc4d(0x116)]=_0x15b4f8;}),_0x2ed54f[_0x4e071a(0x161)]((_0x308045,_0x10110e)=>{var _0x5ce23e=_0x4e071a;_0x54c439[_0x10110e][_0x5ce23e(0x1c9)]=_0x308045;}),_0x2ac863[_0x4e071a(0x161)]((_0x17f872,_0x19bd4c)=>{var _0x4b501a=_0x4e071a;_0x54c439[_0x19bd4c][_0x4b501a(0x10c)]=_0x17f872;}),_0x4c4bac[_0x4e071a(0x161)]((_0x2515cc,_0x1564e1)=>{var _0x458349=_0x4e071a;_0x54c439[_0x1564e1][_0x458349(0x160)]=_0x2515cc;}),_0x543925[_0x4e071a(0x161)]((_0x27dc78,_0x1ce3a7)=>{var _0x351465=_0x4e071a;_0x54c439[_0x1ce3a7][_0x351465(0xeb)]=_0x27dc78;}),_0xec9ef5[_0x4e071a(0x161)]((_0x1bba98,_0x2e29e3)=>{var _0x2017f0=_0x4e071a;_0x54c439[_0x2e29e3][_0x2017f0(0x165)]=_0x1bba98;}),_0x395f83['forEach']((_0xf832b7,_0x259ade)=>{_0x54c439[_0x259ade]['delivery_date']=_0xf832b7;}),_0x2e90a8['forEach']((_0x5e90e3,_0x22c36f)=>{_0x54c439[_0x22c36f]['delivery_code']=_0x5e90e3;}),_0xaa2a80['forEach']((_0xc1016c,_0x5f5b68)=>{var _0x463561=_0x4e071a;_0x54c439[_0x5f5b68][_0x463561(0x175)]=_0xc1016c;}),_0x325165[_0x4e071a(0x161)]((_0x6a93a2,_0x1ddbd1)=>{var _0x322fc5=_0x4e071a;_0x54c439[_0x1ddbd1][_0x322fc5(0x1e6)]=_0x6a93a2;}),_0x316203['forEach']((_0x4dfd12,_0x5908b7)=>{var _0x3543e6=_0x4e071a;_0x54c439[_0x5908b7][_0x3543e6(0x12d)]=_0x4dfd12;}),_0x420000['forEach']((_0x3d9f21,_0x354b2b)=>{var _0x30a045=_0x4e071a;_0x54c439[_0x354b2b][_0x30a045(0x15a)]=_0x3d9f21;});var _0x533a95=0x0;_0x54c439[_0x4e071a(0x161)](_0x5a8489=>{var _0x387d9d=_0x4e071a;(_0x5a8489[_0x387d9d(0x10d)]<_0x5a8489[_0x387d9d(0x1e6)]||_0x5a8489[_0x387d9d(0x1e6)]==0x0)&&(console[_0x387d9d(0x16e)]('foreach\x20newproduct',_0x5a8489),_0x533a95++);});const _0xcc4b51=_0x54c439[_0x4e071a(0x107)](_0x4da43c=>_0x4da43c[_0x4e071a(0x1a2)]!=='0'&&_0x4da43c[_0x4e071a(0x1a2)]!==''),_0x27b77e=new sales({'invoice':_0x18de55,'customer':_0x5ecc20[_0x4e071a(0x1be)][_0x4e071a(0x119)],'date':_0x1a0163,'warehouse_name':_0x4f12c0,'sale_product':_0xcc4b51,'note':_0xc662f5,'room':_0x4125d4,'primary_code':_0x19a862,'secondary_code':_0x51f35f,'prod_code':_0x41722b,'SCRN':_0x4445b2}),_0x1de0db=await _0x27b77e['save']();_0x5ecc20[_0x4e071a(0x1ac)](_0x4e071a(0x14c),_0x4e071a(0x16a)),_0x5d0fa9[_0x4e071a(0x18b)](_0x4e071a(0x193)+_0x1de0db[_0x4e071a(0x1ce)]);}catch(_0x4fbd17){console[_0x4e071a(0x16e)](_0x4fbd17);}}),router[a0_0x3a0f71(0xdc)](a0_0x3a0f71(0x15c),auth,async(_0x32945d,_0x9a898a)=>{var _0x169474=a0_0x3a0f71;try{const {username:_0x60308c,email:_0x1e76b4,role:_0x29002a}=_0x32945d[_0x169474(0xdb)],_0x6aefa7=_0x32945d['user'],_0x36b578=await profile['findOne']({'email':_0x6aefa7[_0x169474(0x1b8)]}),_0x5b9312=await master_shop[_0x169474(0xea)](),_0x215e63=_0x32945d['params']['id'],_0x384ecb=await sales[_0x169474(0x16f)](_0x215e63),_0x8d9d28=await warehouse[_0x169474(0x109)]([{'$match':{'name':_0x384ecb[_0x169474(0x139)]}},{'$unwind':_0x169474(0xfd)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x169474(0x118)},'bay':{'$first':_0x169474(0x1bd)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x169474(0x122)},'floorlevel':{'$first':_0x169474(0x17d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x169474(0x1b5)},'product_code':{'$first':_0x169474(0xd5)},'storage':{'$first':_0x169474(0x19e)},'rack':{'$first':_0x169474(0x1e1)},'expiry_date':{'$first':_0x169474(0x1c8)},'production_date':{'$first':_0x169474(0x1d8)}}}]),_0x1f2503=await customer[_0x169474(0xea)]({});let _0x36308f;if(_0x6aefa7[_0x169474(0x17e)]=='staff'){const _0x4759fd=await staff[_0x169474(0x106)]({'email':_0x6aefa7[_0x169474(0x1b8)]});_0x36308f=await warehouse[_0x169474(0x109)]([{'$match':{'status':_0x169474(0x15e),'name':_0x4759fd[_0x169474(0x18a)]}},{'$group':{'_id':_0x169474(0xe5),'name':{'$first':_0x169474(0xe5)}}}]);}else _0x36308f=await warehouse[_0x169474(0x109)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x169474(0xe5),'name':{'$first':'$name'}}}]);const _0x5af29f=await product[_0x169474(0xea)]({}),_0x223154=await suppliers[_0x169474(0xea)]({});if(_0x5b9312[0x0]['language']==_0x169474(0x145)){var _0x274f84=users[_0x169474(0x197)];console[_0x169474(0x16e)](_0x274f84);}else{if(_0x5b9312[0x0][_0x169474(0x1a1)]==_0x169474(0x147))var _0x274f84=users[_0x169474(0x147)];else{if(_0x5b9312[0x0]['language']=='German')var _0x274f84=users['German'];else{if(_0x5b9312[0x0][_0x169474(0x1a1)]=='Spanish')var _0x274f84=users['Spanish'];else{if(_0x5b9312[0x0][_0x169474(0x1a1)]==_0x169474(0x1b3))var _0x274f84=users[_0x169474(0x1b3)];else{if(_0x5b9312[0x0]['language']==_0x169474(0xe2))var _0x274f84=users[_0x169474(0x11d)];else{if(_0x5b9312[0x0][_0x169474(0x1a1)]==_0x169474(0x174))var _0x274f84=users[_0x169474(0x174)];else{if(_0x5b9312[0x0][_0x169474(0x1a1)]==_0x169474(0x163))var _0x274f84=users[_0x169474(0x1e8)];}}}}}}}_0x9a898a[_0x169474(0x177)](_0x169474(0x190),{'success':_0x32945d['flash'](_0x169474(0x14c)),'errors':_0x32945d['flash']('errors'),'role':_0x6aefa7,'profile':_0x36b578,'customer':_0x1f2503,'warehouse':_0x36308f,'product':_0x8d9d28,'user':_0x384ecb,'master_shop':_0x5b9312,'unit':_0x5af29f,'language':_0x274f84,'suppliers':_0x223154});}catch(_0x578cdc){console[_0x169474(0x16e)](_0x578cdc);}}),router[a0_0x3a0f71(0x1d4)]('/preview/:id',auth,async(_0x261668,_0x2532f3)=>{var _0x3a2a93=a0_0x3a0f71;try{const _0x1575be=_0x261668[_0x3a2a93(0x13d)]['id'],{invoice:_0x35211f,warehouse_name:_0x57e068,room:_0x4e91ee}=_0x261668[_0x3a2a93(0x1be)],_0x462e93=await sales[_0x3a2a93(0x106)]({'invoice':_0x35211f}),_0x1fd53f=_0x462e93['sale_product'][_0x3a2a93(0x18e)](async _0x3c5ac6=>{var _0x465f40=_0x3a2a93,_0x3a15a0=await warehouse['findOne']({'name':_0x57e068,'room':_0x3c5ac6[_0x465f40(0x12d)],'warehouse_category':_0x465f40(0x15b)});const _0x448e88=_0x3a15a0[_0x465f40(0x15d)][_0x465f40(0x18e)](_0x5e7535=>{var _0x40126f=_0x465f40;_0x5e7535[_0x40126f(0x1b9)]==_0x3c5ac6['product_name']&&_0x5e7535[_0x40126f(0x16b)]==_0x3c5ac6[_0x40126f(0x16b)]&&_0x5e7535[_0x40126f(0x184)]==_0x3c5ac6['type']&&_0x5e7535[_0x40126f(0x1c6)]==_0x3c5ac6[_0x40126f(0x1c6)]&&_0x5e7535['bay']==_0x3c5ac6['bay']&&_0x5e7535[_0x40126f(0x162)]==_0x3c5ac6[_0x40126f(0x162)]&&_0x5e7535[_0x40126f(0x11e)]==_0x3c5ac6['storage']&&_0x5e7535['expiry_date']==_0x3c5ac6['expiry_date']&&_0x5e7535[_0x40126f(0x1c9)]==_0x3c5ac6[_0x40126f(0x1c9)]&&_0x5e7535[_0x40126f(0x15a)]==_0x3c5ac6[_0x40126f(0x15a)]&&(_0x5e7535[_0x40126f(0x14a)]=_0x5e7535[_0x40126f(0x14a)]-_0x3c5ac6[_0x40126f(0x1a2)]);});return _0x3a15a0;});Promise['all'](_0x1fd53f)[_0x3a2a93(0xf4)](async _0x2fe4a3=>{var _0x175fb5=_0x3a2a93;try{for(const _0x23fb46 of _0x2fe4a3){await _0x23fb46['save']();}_0x462e93[_0x175fb5(0xfc)]=_0x175fb5(0x183);const _0x1e379d=await _0x462e93[_0x175fb5(0x130)](),_0x12fd68=await master_shop['find'](),_0xf1b86d=await email_settings['findOne'](),_0x4faac6=await supervisor_settings[_0x175fb5(0xea)]();var _0x25ed4e=_0x462e93[_0x175fb5(0x1e5)],_0x1b2211='',_0x1a2bd4;for(_0x1a2bd4 in _0x25ed4e){_0x1b2211+=_0x175fb5(0x186)+_0x175fb5(0x101)+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x1b9)]+_0x175fb5(0x1a5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25ed4e[_0x1a2bd4]['product_code']+_0x175fb5(0x1a5)+_0x175fb5(0x101)+_0x25ed4e[_0x1a2bd4]['quantity']+_0x175fb5(0x1a5)+_0x175fb5(0x101)+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x181)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x116)]+_0x175fb5(0x1a5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x462e93['warehouse_name']+_0x175fb5(0x1a5)+_0x175fb5(0x101)+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x12d)]+'</td>'+_0x175fb5(0x101)+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x11e)]+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x162)]+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x1ba)]+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x1c6)]+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x184)][0x0]+_0x25ed4e[_0x1a2bd4][_0x175fb5(0x16b)]+'</td>','</tr>';}let _0x1d6e9e=nodemailer[_0x175fb5(0xde)]({'host':_0xf1b86d[_0x175fb5(0x1aa)],'port':Number(_0xf1b86d[_0x175fb5(0x155)]),'secure':![],'auth':{'user':_0xf1b86d[_0x175fb5(0x1b8)],'pass':_0xf1b86d[_0x175fb5(0x149)]}}),_0x74007a={'from':_0xf1b86d[_0x175fb5(0x1b8)],'to':_0x4faac6[0x0]['RMSEmail'],'subject':_0x175fb5(0xf3),'attachments':[{'filename':_0x175fb5(0x1b0),'path':__dirname+_0x175fb5(0xdf)+_0x175fb5(0x105)+_0x12fd68[0x0][_0x175fb5(0x1df)],'cid':'logo'}],'html':_0x175fb5(0x1c0)+_0x175fb5(0x166)+_0x175fb5(0xf7)+_0x175fb5(0x146)+_0x175fb5(0x1cd)+'<div>'+_0x175fb5(0xf6)+_0x175fb5(0xff)+'<div>'+'<h2>\x20'+_0x12fd68[0x0][_0x175fb5(0x140)]+_0x175fb5(0x112)+'</div>'+_0x175fb5(0xff)+_0x175fb5(0x196)+_0x175fb5(0x146)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x462e93[_0x175fb5(0x15a)]+'\x20'+_0x175fb5(0x188)+_0x175fb5(0x120)+_0x462e93['date']+'\x20'+_0x175fb5(0x156)+_0x175fb5(0x1c7)+_0x175fb5(0xff)+_0x175fb5(0x134)+_0x175fb5(0x182)+_0x175fb5(0x186)+_0x175fb5(0x1b2)+_0x175fb5(0xf5)+_0x175fb5(0x173)+_0x175fb5(0x1c4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x175fb5(0x131)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x175fb5(0xf1)+_0x175fb5(0x154)+_0x175fb5(0xe9)+_0x175fb5(0x12e)+'\x20'+_0x1b2211+'\x20'+_0x175fb5(0x150)+_0x175fb5(0x1d1)+'<div>'+_0x175fb5(0x12f)+_0x175fb5(0x1db)+_0x12fd68[0x0][_0x175fb5(0x140)]+_0x175fb5(0x1c7)+_0x175fb5(0xff)+_0x175fb5(0xff)+'</body></html>'};_0x1d6e9e[_0x175fb5(0x1a0)](_0x74007a,function(_0x256374,_0x196129){var _0x2462f0=_0x175fb5;_0x256374?(console[_0x2462f0(0x16e)](_0x256374),console[_0x2462f0(0x16e)](_0x2462f0(0x18c))):console[_0x2462f0(0x16e)](_0x2462f0(0x1dd));}),_0x261668[_0x175fb5(0x1ac)](_0x175fb5(0x14c),_0x175fb5(0x1ad)),_0x2532f3['redirect'](_0x175fb5(0x193)+_0x1575be);}catch(_0x508164){console['error'](_0x508164),_0x2532f3['status'](0x1f4)[_0x175fb5(0xf0)]({'error':_0x175fb5(0x158)});}})[_0x3a2a93(0x151)](_0x2c70d3=>{var _0x5c32b1=_0x3a2a93;console[_0x5c32b1(0x179)](_0x2c70d3),_0x2532f3[_0x5c32b1(0xed)](0x1f4)[_0x5c32b1(0xf0)]({'error':_0x5c32b1(0x1e4)});});}catch(_0x51deea){console[_0x3a2a93(0x16e)](_0x51deea);}}),router[a0_0x3a0f71(0xdc)](a0_0x3a0f71(0x1e3),auth,async(_0x565571,_0x146666)=>{var _0x4e8fad=a0_0x3a0f71;try{const {username:_0x3e784d,email:_0x410f11,role:_0x44535c}=_0x565571[_0x4e8fad(0xdb)],_0x1418ed=_0x565571[_0x4e8fad(0xdb)],_0x5d52fd=await profile[_0x4e8fad(0x106)]({'email':_0x1418ed[_0x4e8fad(0x1b8)]}),_0x269328=await master_shop[_0x4e8fad(0xea)](),_0x1db4a9=_0x565571[_0x4e8fad(0x13d)]['id'],_0x449310=await sales[_0x4e8fad(0x16f)](_0x1db4a9);var _0x5beed8=[_0x4e8fad(0x1de),_0x4e8fad(0xe8)];const _0x5baac6=await warehouse[_0x4e8fad(0x109)]([{'$match':{'name':_0x449310[_0x4e8fad(0x139)],'warehouse_category':_0x4e8fad(0x15b)}},{'$unwind':_0x4e8fad(0xfd)},{'$group':{'_id':_0x4e8fad(0xdd),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4e8fad(0x1bd)},'bin':{'$first':_0x4e8fad(0x13f)},'type':{'$first':_0x4e8fad(0x122)},'floorlevel':{'$first':_0x4e8fad(0x17d)},'primary_code':{'$first':_0x4e8fad(0x1b7)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4e8fad(0x19e)},'rack':{'$first':_0x4e8fad(0x1e1)}}}]),_0x5f0756=await customer[_0x4e8fad(0xea)]({});let _0x11f83e;if(_0x1418ed[_0x4e8fad(0x17e)]==_0x4e8fad(0x178)){const _0x49bb05=await staff[_0x4e8fad(0x106)]({'email':_0x1418ed[_0x4e8fad(0x1b8)]});_0x11f83e=await warehouse[_0x4e8fad(0x109)]([{'$match':{'status':_0x4e8fad(0x15e),'name':_0x49bb05[_0x4e8fad(0x18a)],'warehouse_category':_0x4e8fad(0x15b)}},{'$group':{'_id':'$name','name':{'$first':_0x4e8fad(0xe5)}}}]);}else _0x11f83e=await warehouse[_0x4e8fad(0x109)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x4e8fad(0xe5)}}}]);const _0x294d5f=await product['find']({});if(_0x269328[0x0][_0x4e8fad(0x1a1)]=='English\x20(US)'){var _0x4ba92c=users['English'];console[_0x4e8fad(0x16e)](_0x4ba92c);}else{if(_0x269328[0x0]['language']=='Hindi')var _0x4ba92c=users[_0x4e8fad(0x147)];else{if(_0x269328[0x0][_0x4e8fad(0x1a1)]==_0x4e8fad(0x1d6))var _0x4ba92c=users['German'];else{if(_0x269328[0x0]['language']=='Spanish')var _0x4ba92c=users[_0x4e8fad(0x172)];else{if(_0x269328[0x0]['language']==_0x4e8fad(0x1b3))var _0x4ba92c=users[_0x4e8fad(0x1b3)];else{if(_0x269328[0x0][_0x4e8fad(0x1a1)]==_0x4e8fad(0xe2))var _0x4ba92c=users[_0x4e8fad(0x11d)];else{if(_0x269328[0x0][_0x4e8fad(0x1a1)]=='Chinese')var _0x4ba92c=users['Chinese'];else{if(_0x269328[0x0][_0x4e8fad(0x1a1)]==_0x4e8fad(0x163))var _0x4ba92c=users['Arabic'];}}}}}}}_0x146666[_0x4e8fad(0x177)](_0x4e8fad(0x17b),{'success':_0x565571[_0x4e8fad(0x1ac)](_0x4e8fad(0x14c)),'errors':_0x565571[_0x4e8fad(0x1ac)](_0x4e8fad(0x10e)),'role':_0x1418ed,'profile':_0x5d52fd,'customer':_0x5f0756,'warehouse':_0x11f83e,'product':_0x5baac6,'user':_0x449310,'master_shop':_0x269328,'unit':_0x294d5f,'language':_0x4ba92c});}catch(_0x2a7251){console['log'](_0x2a7251);}}),router['post'](a0_0x3a0f71(0x1e3),auth,async(_0x50edc1,_0x30d003)=>{var _0x3242a0=a0_0x3a0f71;try{const _0x22054f=_0x50edc1[_0x3242a0(0x13d)]['id'],_0x1555fe=await sales[_0x3242a0(0x106)]({'_id':_0x50edc1[_0x3242a0(0x13d)]['id']}),_0x50883d=await warehouse['findOne']({'name':_0x1555fe[_0x3242a0(0x139)],'room':_0x50edc1[_0x3242a0(0x1be)]['room']}),{invoice:_0xe307e0,date:_0xfd6f6f,warehouse_name:_0x9b6c66,product_name:_0x381d43,stock:_0x5083f0,quantity:_0x543dcf,note:_0x178ab0,room:_0x29dbce,customer:_0x3a47c4,SCRN:_0x266748}=_0x50edc1[_0x3242a0(0x1be)];if(typeof _0x381d43==_0x3242a0(0xda))var _0x220f37=[_0x50edc1[_0x3242a0(0x1be)]['product_name']],_0x24c267=[_0x50edc1[_0x3242a0(0x1be)]['stock']],_0x59e54a=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x13a)]],_0x6f9ec5=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x18f)]],_0x53c176=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x169)]],_0x5117b6=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0xfa)]],_0x2c50a9=[_0x50edc1[_0x3242a0(0x1be)]['level']],_0x2cbd07=[_0x50edc1['body']['primary_unit']],_0x5c983a=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x116)]],_0x2c776b=[_0x50edc1['body'][_0x3242a0(0x1c9)]],_0x20c283=[_0x50edc1['body']['expiry_date']],_0x46e22a=[_0x50edc1[_0x3242a0(0x1be)]['max_per_unit']],_0x4f9472=[_0x50edc1['body'][_0x3242a0(0xeb)]],_0x1aa964=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x165)]],_0x5d17ef=[_0x50edc1[_0x3242a0(0x1be)]['delivery_date']],_0x1bccba=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x12a)]],_0x1741ac=[_0x50edc1[_0x3242a0(0x1be)]['prod_cat']],_0x363273=[_0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x1a2)]],_0x2a419a=[_0x50edc1[_0x3242a0(0x1be)]['RoomAssigned']];else var _0x220f37=[..._0x50edc1['body']['product_name']],_0x24c267=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x10d)]],_0x59e54a=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x13a)]],_0x6f9ec5=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x18f)]],_0x53c176=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x169)]],_0x5117b6=[..._0x50edc1[_0x3242a0(0x1be)]['prod_code']],_0x2c50a9=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x14f)]],_0x2cbd07=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x121)]],_0x5c983a=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x116)]],_0x2c776b=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x1c9)]],_0x20c283=[..._0x50edc1[_0x3242a0(0x1be)]['expiry_date']],_0x46e22a=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x19a)]],_0x4f9472=[..._0x50edc1[_0x3242a0(0x1be)]['production_date']],_0x1aa964=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x165)]],_0x5d17ef=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x152)]],_0x1bccba=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x12a)]],_0x1741ac=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x175)]],_0x363273=[..._0x50edc1[_0x3242a0(0x1be)][_0x3242a0(0x1a2)]],_0x2a419a=[..._0x50edc1['body']['RoomAssigned']];const _0x2dfdaa=_0x220f37['map'](_0x1ce835=>{return _0x1ce835={'product_name':_0x1ce835};});_0x24c267['forEach']((_0x49f881,_0x55ba59)=>{var _0x828ac2=_0x3242a0;_0x2dfdaa[_0x55ba59][_0x828ac2(0x10d)]=_0x49f881;}),_0x59e54a[_0x3242a0(0x161)]((_0x6e0050,_0x34c77b)=>{var _0x2347ee=_0x3242a0;_0x2dfdaa[_0x34c77b][_0x2347ee(0x1a2)]=_0x6e0050;}),_0x6f9ec5[_0x3242a0(0x161)]((_0x5575a5,_0x130020)=>{var _0x465d28=_0x3242a0;_0x2dfdaa[_0x130020][_0x465d28(0x18f)]=_0x5575a5;}),_0x53c176[_0x3242a0(0x161)]((_0x4c4b73,_0x32d01f)=>{var _0x9b67f1=_0x3242a0;_0x2dfdaa[_0x32d01f][_0x9b67f1(0x169)]=_0x4c4b73;}),_0x5117b6[_0x3242a0(0x161)]((_0x1a5d6e,_0x409272)=>{var _0x5f0d70=_0x3242a0;_0x2dfdaa[_0x409272][_0x5f0d70(0x143)]=_0x1a5d6e;}),_0x2c50a9[_0x3242a0(0x161)]((_0x1e237c,_0x5dce53)=>{var _0x45ed9a=_0x3242a0;_0x2a419a[_0x45ed9a(0x161)]((_0x2d9270,_0x11ea25)=>{var _0x506b35=_0x45ed9a;if(_0x2d9270=='Receiving\x20Area'&&_0x5dce53==_0x11ea25){var _0xce42c9=_0x1e237c[_0x506b35(0x126)](0x3);_0x2dfdaa[_0x5dce53][_0x506b35(0x11e)]=_0x1e237c[0x0],_0x2dfdaa[_0x5dce53][_0x506b35(0x162)]=_0x1e237c[0x1],_0x2dfdaa[_0x5dce53][_0x506b35(0x1ba)]=0x0,_0x2dfdaa[_0x5dce53][_0x506b35(0x1c6)]=0x0,_0x2dfdaa[_0x5dce53]['type']='Floor',_0x2dfdaa[_0x5dce53][_0x506b35(0x16b)]=_0xce42c9;}else{if(_0x2d9270==_0x506b35(0x14b)&&_0x5dce53==_0x11ea25){var _0xce42c9=_0x1e237c['slice'](0x3);_0x2dfdaa[_0x5dce53][_0x506b35(0x11e)]=_0x1e237c[0x0],_0x2dfdaa[_0x5dce53][_0x506b35(0x162)]=_0x1e237c[0x1],_0x2dfdaa[_0x5dce53][_0x506b35(0x1ba)]=0x0,_0x2dfdaa[_0x5dce53][_0x506b35(0x1c6)]=0x0,_0x2dfdaa[_0x5dce53][_0x506b35(0x184)]=_0x506b35(0x1b1),_0x2dfdaa[_0x5dce53][_0x506b35(0x16b)]=_0x1e237c[0x5];}else{if(_0x5dce53==_0x11ea25){var _0x2e24ea;if(_0x1e237c[0x4]=='L')_0x2e24ea=_0x506b35(0x1d7);else _0x1e237c[0x4]=='F'&&(_0x2e24ea=_0x506b35(0x1b1));_0x2dfdaa[_0x5dce53][_0x506b35(0x11e)]=_0x1e237c[0x0],_0x2dfdaa[_0x5dce53][_0x506b35(0x162)]=_0x1e237c[0x1],_0x2dfdaa[_0x5dce53][_0x506b35(0x1ba)]=_0x1e237c[0x2],_0x2dfdaa[_0x5dce53]['bin']=_0x1e237c[0x3],_0x2dfdaa[_0x5dce53][_0x506b35(0x184)]=_0x2e24ea,_0x2dfdaa[_0x5dce53][_0x506b35(0x16b)]=_0x1e237c[0x5];}}}});}),_0x2cbd07[_0x3242a0(0x161)]((_0x503e1f,_0x56a869)=>{_0x2dfdaa[_0x56a869]['unit']=_0x503e1f;}),_0x5c983a['forEach']((_0x3f7279,_0x7624bc)=>{var _0x4b12b9=_0x3242a0;_0x2dfdaa[_0x7624bc][_0x4b12b9(0x116)]=_0x3f7279;}),_0x2c776b[_0x3242a0(0x161)]((_0x1d9d21,_0x26896e)=>{var _0x101fbc=_0x3242a0;_0x2dfdaa[_0x26896e][_0x101fbc(0x1c9)]=_0x1d9d21;}),_0x20c283[_0x3242a0(0x161)]((_0x1e565d,_0x2e00e9)=>{var _0x313d1c=_0x3242a0;_0x2dfdaa[_0x2e00e9][_0x313d1c(0x10c)]=_0x1e565d;}),_0x46e22a[_0x3242a0(0x161)]((_0xf0614d,_0x434ff2)=>{_0x2dfdaa[_0x434ff2]['maxperunit']=_0xf0614d;}),_0x4f9472[_0x3242a0(0x161)]((_0x2e2342,_0x3c0ca4)=>{_0x2dfdaa[_0x3c0ca4]['production_date']=_0x2e2342;}),_0x1aa964['forEach']((_0x47f249,_0x48f140)=>{var _0x28a5ac=_0x3242a0;_0x2dfdaa[_0x48f140][_0x28a5ac(0x165)]=_0x47f249;}),_0x5d17ef['forEach']((_0x41b4c4,_0x46f351)=>{var _0x108cdd=_0x3242a0;_0x2dfdaa[_0x46f351][_0x108cdd(0x152)]=_0x41b4c4;}),_0x1bccba[_0x3242a0(0x161)]((_0x1bd071,_0x284086)=>{var _0x5edc8d=_0x3242a0;_0x2dfdaa[_0x284086][_0x5edc8d(0x12a)]=_0x1bd071;}),_0x1741ac[_0x3242a0(0x161)]((_0x295888,_0x1f5e33)=>{_0x2dfdaa[_0x1f5e33]['prod_cat']=_0x295888;}),_0x363273[_0x3242a0(0x161)]((_0x2e04c5,_0x8ca64a)=>{var _0x337142=_0x3242a0;_0x2dfdaa[_0x8ca64a][_0x337142(0x1e6)]=_0x2e04c5;}),_0x2a419a['forEach']((_0xbb33c4,_0x10bca4)=>{var _0x2a0ca7=_0x3242a0;_0x2dfdaa[_0x10bca4][_0x2a0ca7(0x12d)]=_0xbb33c4;});var _0x101d82=0x0;_0x2dfdaa['forEach'](_0x5a9bbf=>{var _0x3f07ed=_0x3242a0;console[_0x3f07ed(0x16e)](_0x3f07ed(0x115),_0x5a9bbf),(parseInt(_0x5a9bbf['stock'])<parseInt(_0x5a9bbf[_0x3f07ed(0x1a2)])||parseInt(_0x5a9bbf[_0x3f07ed(0x1a2)])==0x0)&&_0x101d82++;});if(_0x101d82!=0x0)return _0x50edc1[_0x3242a0(0x1ac)](_0x3242a0(0x10e),_0x3242a0(0x148)),_0x30d003[_0x3242a0(0x18b)]('back');const _0x1d9ca5=_0x2dfdaa[_0x3242a0(0x107)](_0x1eddee=>_0x1eddee['quantity']!=='0'&&_0x1eddee[_0x3242a0(0x1a2)]!=='');_0x1555fe[_0x3242a0(0x15a)]=_0xe307e0,_0x1555fe[_0x3242a0(0x119)]=_0x3a47c4,_0x1555fe['date']=_0xfd6f6f,_0x1555fe[_0x3242a0(0x139)]=_0x9b6c66,_0x1555fe['sale_product']=_0x1d9ca5,_0x1555fe[_0x3242a0(0x137)]=_0x178ab0,_0x1555fe[_0x3242a0(0x1bc)]=_0x266748,_0x1555fe['finalize']=_0x3242a0(0xd9),_0x1555fe[_0x3242a0(0x10a)]='False';const _0x5129ba=await _0x1555fe[_0x3242a0(0x130)]();_0x50edc1['flash'](_0x3242a0(0x14c),_0x3242a0(0x1ad)),_0x30d003[_0x3242a0(0x18b)](_0x3242a0(0x1a6));}catch(_0x1e8ff3){console[_0x3242a0(0x16e)](_0x1e8ff3);}}),router[a0_0x3a0f71(0x1d4)](a0_0x3a0f71(0x1a7),auth,async(_0x26886d,_0x3feb70)=>{var _0x367e72=a0_0x3a0f71;try{const _0x1fad93=_0x26886d['params']['id'],{invoice:_0x448009,customer:_0x30e20b,receivable_amount:_0x2bef1b,received_amount:_0x27b3be}=_0x26886d[_0x367e72(0x1be)],_0x357ab3=await sales[_0x367e72(0x16f)](_0x1fad93);console[_0x367e72(0x16e)](_0x357ab3);var _0x50b934=_0x2bef1b-_0x27b3be;console[_0x367e72(0x16e)](_0x27b3be),_0x357ab3[_0x367e72(0x108)]=parseFloat(_0x27b3be)+parseFloat(_0x357ab3[_0x367e72(0x108)]),_0x357ab3[_0x367e72(0xe6)]=_0x50b934,console[_0x367e72(0x16e)](_0x357ab3);const _0x312784=await _0x357ab3[_0x367e72(0x130)](),_0x305c82=await c_payment_data[_0x367e72(0x106)]({'invoice':_0x448009});_0x305c82[_0x367e72(0x1e0)]=_0x50b934,await _0x305c82[_0x367e72(0x130)]();let _0x5b7eee=new Date(),_0x51da2c=('0'+_0x5b7eee[_0x367e72(0x113)]())['slice'](-0x2),_0x16b29b=('0'+(_0x5b7eee[_0x367e72(0x19f)]()+0x1))[_0x367e72(0x126)](-0x2),_0x247bc5=_0x5b7eee[_0x367e72(0x185)](),_0x18b033=_0x247bc5+'-'+_0x16b29b+'-'+_0x51da2c;const _0x382f47=new customer_payment({'invoice':_0x448009,'date':_0x247bc5+'-'+_0x16b29b+'-'+_0x51da2c,'customer':_0x30e20b,'reason':_0x367e72(0x1bb),'amount':_0x27b3be}),_0x2512a3=await _0x382f47['save']();_0x26886d[_0x367e72(0x1ac)](_0x367e72(0x14c),_0x367e72(0x111)),_0x3feb70[_0x367e72(0x18b)](_0x367e72(0x1a6));}catch(_0x23be81){console[_0x367e72(0x16e)](_0x23be81);}}),router['get'](a0_0x3a0f71(0xec),auth,async(_0x1027b5,_0x10ea2f)=>{var _0x58a5b2=a0_0x3a0f71;try{const {username:_0x366165,email:_0x37999e,role:_0x1a877b}=_0x1027b5[_0x58a5b2(0xdb)],_0x3747f5=_0x1027b5[_0x58a5b2(0xdb)],_0x551210=await profile[_0x58a5b2(0x106)]({'email':_0x3747f5[_0x58a5b2(0x1b8)]}),_0x4f0242=await master_shop[_0x58a5b2(0xea)]();console[_0x58a5b2(0x16e)](_0x58a5b2(0x132),_0x4f0242);const _0x4a0b9a=_0x1027b5[_0x58a5b2(0x13d)]['id'],_0x37567c=await sales[_0x58a5b2(0x16f)](_0x4a0b9a);console[_0x58a5b2(0x16e)](_0x37567c);const _0x4e92c6=await customer['findOne']({'name':_0x37567c['customer']});console['log'](_0x4e92c6);if(_0x4f0242[0x0][_0x58a5b2(0x1a1)]=='English\x20(US)'){var _0x2c31b2=users[_0x58a5b2(0x197)];console['log'](_0x2c31b2);}else{if(_0x4f0242[0x0]['language']==_0x58a5b2(0x147))var _0x2c31b2=users['Hindi'];else{if(_0x4f0242[0x0][_0x58a5b2(0x1a1)]==_0x58a5b2(0x1d6))var _0x2c31b2=users[_0x58a5b2(0x1d6)];else{if(_0x4f0242[0x0][_0x58a5b2(0x1a1)]==_0x58a5b2(0x172))var _0x2c31b2=users[_0x58a5b2(0x172)];else{if(_0x4f0242[0x0][_0x58a5b2(0x1a1)]==_0x58a5b2(0x1b3))var _0x2c31b2=users['French'];else{if(_0x4f0242[0x0][_0x58a5b2(0x1a1)]==_0x58a5b2(0xe2))var _0x2c31b2=users[_0x58a5b2(0x11d)];else{if(_0x4f0242[0x0]['language']==_0x58a5b2(0x174))var _0x2c31b2=users[_0x58a5b2(0x174)];else{if(_0x4f0242[0x0]['language']==_0x58a5b2(0x163))var _0x2c31b2=users[_0x58a5b2(0x1e8)];}}}}}}}_0x10ea2f[_0x58a5b2(0x177)](_0x58a5b2(0x17a),{'success':_0x1027b5[_0x58a5b2(0x1ac)](_0x58a5b2(0x14c)),'errors':_0x1027b5['flash']('errors'),'role':_0x3747f5,'profile':_0x551210,'master_shop':_0x4f0242,'customers':_0x4e92c6,'sales':_0x37567c,'language':_0x2c31b2});}catch(_0x44a5bf){console[_0x58a5b2(0x16e)](_0x44a5bf);}}),router[a0_0x3a0f71(0xdc)](a0_0x3a0f71(0x11a),auth,async(_0x2fec03,_0x453100)=>{var _0x5bccfd=a0_0x3a0f71;try{const {username:_0x232811,email:_0x363b3c,role:_0x59a87b}=_0x2fec03[_0x5bccfd(0xdb)],_0x56bf81=_0x2fec03[_0x5bccfd(0xdb)],_0x2ba602=await profile['findOne']({'email':_0x56bf81[_0x5bccfd(0x1b8)]}),_0x3cb6ae=await master_shop['find']();console[_0x5bccfd(0x16e)](_0x5bccfd(0x132),_0x3cb6ae);const _0x27f30d=_0x2fec03[_0x5bccfd(0x13d)]['id'];console[_0x5bccfd(0x16e)](_0x27f30d);const _0x4bae22=await sales[_0x5bccfd(0x16f)](_0x27f30d);console[_0x5bccfd(0x16e)](_0x5bccfd(0x103),_0x4bae22);const _0x51a1eb=await warehouse[_0x5bccfd(0x109)]([{'$match':{'name':_0x5bccfd(0x102),'room':_0x5bccfd(0x1af)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5bccfd(0xdd),'name':{'$first':_0x5bccfd(0x1d5)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x5bccfd(0xf2)},'isle':{'$first':_0x5bccfd(0x187)},'pallet':{'$first':_0x5bccfd(0x141)},'primary_code':{'$first':_0x5bccfd(0x1b7)},'secondary_code':{'$first':_0x5bccfd(0x1b5)},'product_code':{'$first':_0x5bccfd(0xd5)}}}]);console[_0x5bccfd(0x16e)]('stock_data',_0x51a1eb);const _0xb9ccae=await product[_0x5bccfd(0xea)]({});warehouse_data=await warehouse[_0x5bccfd(0x109)]([{'$match':{'status':'Enabled','name':_0x5bccfd(0x102),'warehouse_category':_0x5bccfd(0x15b)}},{'$group':{'_id':_0x5bccfd(0xe5),'name':{'$first':_0x5bccfd(0xe5)}}},{'$sort':{'name':0x1}}]);var _0x43e099=[_0x5bccfd(0x1af)];if(_0x3cb6ae[0x0]['language']==_0x5bccfd(0x145)){var _0x12c4a2=users[_0x5bccfd(0x197)];console[_0x5bccfd(0x16e)](_0x12c4a2);}else{if(_0x3cb6ae[0x0][_0x5bccfd(0x1a1)]==_0x5bccfd(0x147))var _0x12c4a2=users[_0x5bccfd(0x147)];else{if(_0x3cb6ae[0x0]['language']==_0x5bccfd(0x1d6))var _0x12c4a2=users[_0x5bccfd(0x1d6)];else{if(_0x3cb6ae[0x0][_0x5bccfd(0x1a1)]==_0x5bccfd(0x172))var _0x12c4a2=users[_0x5bccfd(0x172)];else{if(_0x3cb6ae[0x0][_0x5bccfd(0x1a1)]==_0x5bccfd(0x1b3))var _0x12c4a2=users[_0x5bccfd(0x1b3)];else{if(_0x3cb6ae[0x0][_0x5bccfd(0x1a1)]==_0x5bccfd(0xe2))var _0x12c4a2=users[_0x5bccfd(0x11d)];else{if(_0x3cb6ae[0x0]['language']=='Chinese')var _0x12c4a2=users[_0x5bccfd(0x174)];else{if(_0x3cb6ae[0x0]['language']==_0x5bccfd(0x163))var _0x12c4a2=users['Arabic'];}}}}}}}_0x453100[_0x5bccfd(0x177)](_0x5bccfd(0x1a9),{'success':_0x2fec03[_0x5bccfd(0x1ac)]('success'),'errors':_0x2fec03['flash'](_0x5bccfd(0x10e)),'role':_0x56bf81,'profile':_0x2ba602,'user':_0x4bae22,'stock':_0x51a1eb,'master_shop':_0x3cb6ae,'unit':_0xb9ccae,'language':_0x12c4a2,'warehouses':warehouse_data,'rooms':_0x43e099});}catch(_0xc5ee07){console[_0x5bccfd(0x16e)](_0xc5ee07),_0x453100['status'](0xc8)[_0x5bccfd(0xf0)]({'message':_0xc5ee07['message']});}}),router['post'](a0_0x3a0f71(0x11a),auth,async(_0x2b2fa3,_0x36864f)=>{var _0x13c4d4=a0_0x3a0f71;try{const {invoice:_0x2c4cad,date:_0x301947,warehouse_name:_0x3e320e,product_name:_0x260222,primary_code:_0x349d75,secondary_code:_0x543a80,product_code:_0x2acc31,sales_quantity:_0x549c8e,stocks:_0x39ca86,return_qty:_0x591a14,Room_name:_0x1b758d,to_warehouse_name:_0x1e29c1,to_Roomname:_0x3b50c6,to_Room_name:_0x4cccc6,note:_0x116a19,level:_0x26f69a,isle:_0x5563e1,pallet:_0x58ff4c}=_0x2b2fa3[_0x13c4d4(0x1be)];if(typeof _0x260222=='string')var _0x4fa4cf=[_0x2b2fa3['body'][_0x13c4d4(0x1b9)]],_0x3a037d=[_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x18f)]],_0x3b92c9=[_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x169)]],_0x480390=[_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x143)]],_0x376601=[_0x2b2fa3['body'][_0x13c4d4(0x1cc)]],_0x27d3c2=[_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x164)]],_0x508dfd=[_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x189)]],_0x55a2ea=[_0x2b2fa3['body'][_0x13c4d4(0x1ba)]],_0x2fe65f=[_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x1c6)]],_0x3b1502=[_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x1a4)]],_0x37ca0e=[_0x2b2fa3['body']['floorlevel']];else var _0x4fa4cf=[..._0x2b2fa3['body']['product_name']],_0x3a037d=[..._0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x18f)]],_0x3b92c9=[..._0x2b2fa3[_0x13c4d4(0x1be)]['secondary_code']],_0x480390=[..._0x2b2fa3['body'][_0x13c4d4(0x143)]],_0x376601=[..._0x2b2fa3['body'][_0x13c4d4(0x1cc)]],_0x27d3c2=[..._0x2b2fa3[_0x13c4d4(0x1be)]['stocks']],_0x508dfd=[..._0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x189)]],_0x55a2ea=[..._0x2b2fa3['body']['bay']],_0x2fe65f=[..._0x2b2fa3['body'][_0x13c4d4(0x1c6)]],_0x3b1502=[..._0x2b2fa3[_0x13c4d4(0x1be)]['types']],_0x37ca0e=[..._0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x16b)]];const _0xe038c=_0x4fa4cf[_0x13c4d4(0x18e)](_0x38e30d=>{return _0x38e30d={'product_name':_0x38e30d};});_0x3a037d[_0x13c4d4(0x161)]((_0x43f821,_0x5c9da5)=>{var _0x14ac15=_0x13c4d4;_0xe038c[_0x5c9da5][_0x14ac15(0x18f)]=_0x43f821;}),_0x3b92c9[_0x13c4d4(0x161)]((_0xd81d79,_0x58c347)=>{var _0xde42e9=_0x13c4d4;_0xe038c[_0x58c347][_0xde42e9(0x169)]=_0xd81d79;}),_0x480390[_0x13c4d4(0x161)]((_0x12a28f,_0x1545b5)=>{var _0x22bd05=_0x13c4d4;_0xe038c[_0x1545b5][_0x22bd05(0x143)]=_0x12a28f;}),_0x376601[_0x13c4d4(0x161)]((_0x3a6517,_0x5a6d4d)=>{var _0x441f0b=_0x13c4d4;_0xe038c[_0x5a6d4d][_0x441f0b(0x157)]=_0x3a6517;}),_0x27d3c2[_0x13c4d4(0x161)]((_0x1bfeb6,_0x2e425e)=>{var _0x529744=_0x13c4d4;_0xe038c[_0x2e425e][_0x529744(0x10d)]=_0x1bfeb6;}),_0x508dfd[_0x13c4d4(0x161)]((_0x40191b,_0x51c9fc)=>{var _0x3209f4=_0x13c4d4;_0xe038c[_0x51c9fc][_0x3209f4(0x189)]=_0x40191b;}),_0x55a2ea[_0x13c4d4(0x161)]((_0x22b7df,_0x1c70c5)=>{var _0x528f25=_0x13c4d4;_0xe038c[_0x1c70c5][_0x528f25(0x1ba)]=_0x22b7df;}),_0x2fe65f[_0x13c4d4(0x161)]((_0x5a1fc2,_0xc98324)=>{var _0x4b96bd=_0x13c4d4;_0xe038c[_0xc98324][_0x4b96bd(0x1c6)]=_0x5a1fc2;}),_0x3b1502[_0x13c4d4(0x161)]((_0x4b5296,_0x364b7d)=>{var _0x40c2a6=_0x13c4d4;_0xe038c[_0x364b7d][_0x40c2a6(0x184)]=_0x4b5296;}),_0x37ca0e[_0x13c4d4(0x161)]((_0x2e4be0,_0x4aa361)=>{var _0x3569f3=_0x13c4d4;_0xe038c[_0x4aa361][_0x3569f3(0x16b)]=_0x2e4be0;});var _0x11029f=0x0;_0xe038c[_0x13c4d4(0x161)](_0x2dcb70=>{var _0x18a04b=_0x13c4d4;console[_0x18a04b(0x16e)]('foreach\x20newproduct',_0x2dcb70),(parseInt(_0x2dcb70['sale_qty'])<parseInt(_0x2dcb70[_0x18a04b(0x189)])||parseInt(_0x2dcb70[_0x18a04b(0x10d)])<parseInt(_0x2dcb70[_0x18a04b(0x189)])&&parseInt(_0x2dcb70['sale_qty'])>parseInt(_0x2dcb70[_0x18a04b(0x189)])||parseInt(_0x2dcb70[_0x18a04b(0x189)])==0x0)&&_0x11029f++;});if(_0x11029f!=0x0)return _0x2b2fa3[_0x13c4d4(0x1ac)]('errors',_0x13c4d4(0xe4)),_0x36864f[_0x13c4d4(0x18b)]('back');const _0x520ffd=await sales[_0x13c4d4(0x106)]({'invoice':_0x2c4cad});console[_0x13c4d4(0x16e)](_0x520ffd),_0x520ffd[_0x13c4d4(0x1e7)]=_0x13c4d4(0x183);const _0x84899b=await _0x520ffd[_0x13c4d4(0x130)](),_0x1ba38d=new sales_return({'invoice':_0x2c4cad,'customer':_0x2b2fa3['body']['customer'],'date':_0x301947,'warehouse_name':_0x3e320e,'room':_0x1b758d,'ToWarehouse':_0x1e29c1,'ToRoom':_0x4cccc6,'return_sale':_0xe038c,'note':_0x116a19}),_0x2a15d4=await _0x1ba38d[_0x13c4d4(0x130)]();console[_0x13c4d4(0x16e)](_0x1ba38d);const _0x5a05df=await sales_return['findOne']({'invoice':_0x2c4cad}),_0x30a071=await warehouse[_0x13c4d4(0x106)]({'name':_0x1e29c1,'room':_0x4cccc6});_0x5a05df['return_sale'][_0x13c4d4(0x161)](_0x4784b8=>{var _0x29911b=_0x13c4d4,_0x49fb41=0x0;const _0x1dcb9e=_0x30a071[_0x29911b(0x15d)][_0x29911b(0x18e)](_0x28943f=>{var _0x258fbc=_0x29911b;_0x28943f[_0x258fbc(0x1b9)]==_0x4784b8[_0x258fbc(0x1b9)]&&_0x28943f[_0x258fbc(0x16b)]==_0x4784b8['floorlevel']&&_0x28943f[_0x258fbc(0x184)]==_0x4784b8[_0x258fbc(0x184)]&&_0x28943f['bin']==_0x4784b8[_0x258fbc(0x1c6)]&&_0x28943f[_0x258fbc(0x1ba)]==_0x4784b8[_0x258fbc(0x1ba)]&&(_0x28943f[_0x258fbc(0x14a)]=parseInt(_0x28943f['product_stock'])+parseInt(_0x4784b8[_0x258fbc(0x189)]),_0x49fb41++);});_0x49fb41=='0'&&(_0x30a071['product_details']=_0x30a071['product_details'][_0x29911b(0x129)]({'product_name':_0x4784b8[_0x29911b(0x1b9)],'product_stock':_0x4784b8[_0x29911b(0x189)],'primary_code':_0x4784b8[_0x29911b(0x18f)],'secondary_code':_0x4784b8['secondary_code'],'product_code':_0x4784b8[_0x29911b(0x143)],'bay':_0x4784b8['bay'],'bin':_0x4784b8[_0x29911b(0x1c6)],'type':_0x4784b8[_0x29911b(0x184)],'floorlevel':_0x4784b8['floorlevel']})),console['log'](_0x29911b(0x1e9),_0x30a071);}),await _0x30a071[_0x13c4d4(0x130)](),console[_0x13c4d4(0x16e)](_0x2b2fa3[_0x13c4d4(0x1be)]);const _0x39049c=new c_payment_data({'invoice':_0x2c4cad,'customer':_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x119)],'reason':_0x13c4d4(0x191)});await _0x39049c[_0x13c4d4(0x130)]();const _0x11a61a=await master_shop[_0x13c4d4(0xea)]();console[_0x13c4d4(0x16e)](_0x13c4d4(0x192),_0x11a61a[0x0][_0x13c4d4(0x1df)]);const _0x5bc1bf=await email_settings[_0x13c4d4(0x106)](),_0x48a28f=await customer[_0x13c4d4(0x106)]({'name':_0x2b2fa3[_0x13c4d4(0x1be)][_0x13c4d4(0x119)]});console[_0x13c4d4(0x16e)](_0x13c4d4(0x180),_0x48a28f);_0x11a61a[0x0][_0x13c4d4(0x14e)]==0x1?(right_currency=_0x11a61a[0x0][_0x13c4d4(0xfe)],left_currency=''):(right_currency='',left_currency=_0x11a61a[0x0][_0x13c4d4(0xfe)]);var _0x47a629=_0x4fa4cf,_0x3663fb=_0x508dfd,_0x8465be='',_0x64d1d1;for(_0x64d1d1 in _0x47a629){_0x8465be+=_0x13c4d4(0x186)+_0x13c4d4(0x101)+_0x47a629[_0x64d1d1]+_0x13c4d4(0x1a5)+_0x13c4d4(0x101)+_0x3663fb[_0x64d1d1]+_0x13c4d4(0x1a5)+'</tr>';}console[_0x13c4d4(0x16e)]('product_list',_0x8465be);let _0x4cd24d=nodemailer[_0x13c4d4(0xde)]({'service':_0x13c4d4(0x117),'auth':{'user':_0x5bc1bf[_0x13c4d4(0x1b8)],'pass':_0x5bc1bf[_0x13c4d4(0x149)]}}),_0x2d237e={'from':_0x5bc1bf[_0x13c4d4(0x1b8)],'to':_0x48a28f[_0x13c4d4(0x1b8)],'subject':_0x13c4d4(0x1d9),'attachments':[{'filename':_0x13c4d4(0x1b0),'path':__dirname+_0x13c4d4(0xdf)+'/upload/'+_0x11a61a[0x0]['image'],'cid':_0x13c4d4(0x123)}],'html':_0x13c4d4(0x1c0)+_0x13c4d4(0x166)+_0x13c4d4(0xf7)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x13c4d4(0x146)+_0x13c4d4(0xf6)+_0x13c4d4(0xff)+_0x13c4d4(0x146)+_0x13c4d4(0x195)+_0x11a61a[0x0]['site_title']+_0x13c4d4(0x112)+'</div>'+_0x13c4d4(0xff)+_0x13c4d4(0x196)+'<div>'+_0x13c4d4(0x1a3)+_0x13c4d4(0x19c)+_0x2c4cad+'\x20'+_0x13c4d4(0x188)+_0x13c4d4(0x120)+_0x301947+'\x20'+_0x13c4d4(0x156)+_0x13c4d4(0x1c7)+_0x13c4d4(0xff)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x13c4d4(0x182)+_0x13c4d4(0x186)+_0x13c4d4(0x1b2)+_0x13c4d4(0x1a8)+_0x13c4d4(0x12c)+_0x13c4d4(0x133)+_0x13c4d4(0x154)+_0x13c4d4(0xe9)+_0x13c4d4(0x12e)+'\x20'+_0x8465be+'\x20'+'</tbody>'+_0x13c4d4(0x1d1)+_0x13c4d4(0x146)+_0x13c4d4(0x12f)+'<h5>'+_0x11a61a[0x0][_0x13c4d4(0x140)]+_0x13c4d4(0x1c7)+'</div>'+_0x13c4d4(0xff)+_0x13c4d4(0xf9)};_0x4cd24d[_0x13c4d4(0x1a0)](_0x2d237e,function(_0x4d89b0,_0x36596e){var _0x1dad7d=_0x13c4d4;_0x4d89b0?(console[_0x1dad7d(0x16e)](_0x4d89b0),console[_0x1dad7d(0x16e)](_0x1dad7d(0x18c))):console[_0x1dad7d(0x16e)]('Email\x20sent\x20successfully');}),_0x2b2fa3[_0x13c4d4(0x1ac)](_0x13c4d4(0x14c),_0x13c4d4(0x124)),_0x36864f[_0x13c4d4(0x18b)]('/all_sales/view');}catch(_0x244034){console[_0x13c4d4(0x16e)](_0x244034),_0x36864f[_0x13c4d4(0xed)](0xc8)[_0x13c4d4(0xf0)]({'message1':_0x244034[_0x13c4d4(0x14d)]});}}),router[a0_0x3a0f71(0xdc)](a0_0x3a0f71(0x17f),auth,async(_0x26f86c,_0x327393)=>{var _0x3e8e6b=a0_0x3a0f71;try{const {username:_0x19bc5d,email:_0x1b1a98,role:_0x21262d}=_0x26f86c[_0x3e8e6b(0xdb)],_0x53589f=_0x26f86c[_0x3e8e6b(0xdb)],_0x22fcfe=await profile[_0x3e8e6b(0x106)]({'email':_0x53589f[_0x3e8e6b(0x1b8)]}),_0x141188=await master_shop['find']();console[_0x3e8e6b(0x16e)](_0x3e8e6b(0xe3),_0x141188);const _0x4a6c32=_0x26f86c[_0x3e8e6b(0x13d)]['id'],_0xbc360d=await sales[_0x3e8e6b(0x16f)](_0x4a6c32);console['log'](_0x3e8e6b(0xd7),_0xbc360d);if(_0x141188[0x0][_0x3e8e6b(0x1a1)]==_0x3e8e6b(0x145))var _0x11bfd8=users[_0x3e8e6b(0x197)];else{if(_0x141188[0x0][_0x3e8e6b(0x1a1)]==_0x3e8e6b(0x147))var _0x11bfd8=users['Hindi'];else{if(_0x141188[0x0][_0x3e8e6b(0x1a1)]=='German')var _0x11bfd8=users[_0x3e8e6b(0x1d6)];else{if(_0x141188[0x0][_0x3e8e6b(0x1a1)]=='Spanish')var _0x11bfd8=users[_0x3e8e6b(0x172)];else{if(_0x141188[0x0]['language']=='French')var _0x11bfd8=users['French'];else{if(_0x141188[0x0][_0x3e8e6b(0x1a1)]=='Portuguese\x20(BR)')var _0x11bfd8=users[_0x3e8e6b(0x11d)];else{if(_0x141188[0x0][_0x3e8e6b(0x1a1)]==_0x3e8e6b(0x174))var _0x11bfd8=users[_0x3e8e6b(0x174)];else{if(_0x141188[0x0][_0x3e8e6b(0x1a1)]==_0x3e8e6b(0x163))var _0x11bfd8=users[_0x3e8e6b(0x1e8)];}}}}}}}_0x327393['render'](_0x3e8e6b(0x13c),{'success':_0x26f86c[_0x3e8e6b(0x1ac)](_0x3e8e6b(0x14c)),'errors':_0x26f86c['flash'](_0x3e8e6b(0x10e)),'role':_0x53589f,'profile':_0x22fcfe,'alldata':_0xbc360d,'master_shop':_0x141188,'language':_0x11bfd8});}catch(_0x3e8d8e){console[_0x3e8e6b(0x16e)](_0x3e8d8e);}}),router[a0_0x3a0f71(0x1d4)](a0_0x3a0f71(0x153),async(_0x526d8d,_0x532012)=>{var _0x5b77e8=a0_0x3a0f71;const {product_code:_0x47caf6,warehouse_name:_0x4bd904,rooms_data:_0x16f312,Roomslist:_0x3f7fd4}=_0x526d8d[_0x5b77e8(0x1be)],_0xe2bb09=_0x3f7fd4[_0x5b77e8(0x11c)](','),_0x14429d=[];async function _0x4b809b(_0x4e9fa4){var _0x6723dc=_0x5b77e8;const _0x5b6e18=await warehouse[_0x6723dc(0x109)]([{'$match':{'name':_0x4bd904,'room':_0x4e9fa4}},{'$unwind':_0x6723dc(0xfd)},{'$match':{'product_details.primary_code':_0x47caf6}},{'$group':{'_id':_0x6723dc(0xdd),'name':{'$first':_0x6723dc(0x1d5)},'product_stock':{'$first':_0x6723dc(0x118)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x6723dc(0x1b5)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x6723dc(0x1bd)},'isle':{'$first':_0x6723dc(0x13f)},'type':{'$first':_0x6723dc(0x122)},'pallet':{'$first':_0x6723dc(0x17d)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x6723dc(0x199)},'storage':{'$first':_0x6723dc(0x19e)},'rack':{'$first':_0x6723dc(0x1e1)},'expiry_date':{'$first':_0x6723dc(0x1c8)},'production_date':{'$first':_0x6723dc(0x1d8)},'maxPerUnit':{'$first':_0x6723dc(0x171)},'batch_code':{'$first':_0x6723dc(0x1c5)},'product_cat':{'$first':_0x6723dc(0x125)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x6723dc(0xe7)},'invoice':{'$first':_0x6723dc(0x1cb)}}}]),_0x3ad549=await warehouse[_0x6723dc(0x109)]([{'$match':{'name':_0x4bd904,'room':_0x4e9fa4}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x47caf6}},{'$group':{'_id':_0x6723dc(0xdd),'name':{'$first':_0x6723dc(0x1d5)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x6723dc(0x1b7)},'secondary_code':{'$first':_0x6723dc(0x1b5)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x6723dc(0x1bd)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x6723dc(0x122)},'pallet':{'$first':_0x6723dc(0x17d)},'unit':{'$first':_0x6723dc(0x110)},'secondary_unit':{'$first':_0x6723dc(0x199)},'storage':{'$first':_0x6723dc(0x19e)},'rack':{'$first':_0x6723dc(0x1e1)},'expiry_date':{'$first':_0x6723dc(0x1c8)},'production_date':{'$first':_0x6723dc(0x1d8)},'maxPerUnit':{'$first':_0x6723dc(0x171)},'batch_code':{'$first':_0x6723dc(0x1c5)},'product_cat':{'$first':_0x6723dc(0x125)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x6723dc(0x1cb)}}}]);if(_0x5b6e18[_0x6723dc(0x1ca)]>0x0)_0x14429d[_0x6723dc(0x1d0)](_0x5b6e18);else _0x3ad549[_0x6723dc(0x1ca)]>0x0&&_0x14429d['push'](_0x3ad549);}const _0x2ed83b=_0xe2bb09[_0x5b77e8(0x18e)](_0x331ef8=>_0x4b809b(_0x331ef8));await Promise[_0x5b77e8(0x13b)](_0x2ed83b),_0x532012[_0x5b77e8(0xf0)](_0x14429d);}),module[a0_0x3a0f71(0x13e)]=router;