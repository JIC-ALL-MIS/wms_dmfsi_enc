var a0_0x53b32f=a0_0x5214;(function(_0x4572ff,_0x1c4ba9){var _0x4dd0a9=a0_0x5214,_0x4984d0=_0x4572ff();while(!![]){try{var _0x56d7d0=-parseInt(_0x4dd0a9(0xfc))/0x1+parseInt(_0x4dd0a9(0xdf))/0x2+parseInt(_0x4dd0a9(0xf9))/0x3*(-parseInt(_0x4dd0a9(0xee))/0x4)+-parseInt(_0x4dd0a9(0xc9))/0x5*(parseInt(_0x4dd0a9(0xd3))/0x6)+parseInt(_0x4dd0a9(0x112))/0x7+-parseInt(_0x4dd0a9(0x114))/0x8+parseInt(_0x4dd0a9(0xf8))/0x9*(parseInt(_0x4dd0a9(0x121))/0xa);if(_0x56d7d0===_0x1c4ba9)break;else _0x4984d0['push'](_0x4984d0['shift']());}catch(_0x2d3b9d){_0x4984d0['push'](_0x4984d0['shift']());}}}(a0_0x38d5,0x41152));const express=require('express'),app=express(),router=express[a0_0x53b32f(0x131)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x53b32f(0x130)),auth=require(a0_0x53b32f(0xc8)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x53b32f(0xf6));router[a0_0x53b32f(0x10f)]('/view',auth,async(_0xa27e7f,_0x1cfbb5)=>{var _0x1de0c6=a0_0x53b32f;try{const {username:_0x58d86e,email:_0x156eec,role:_0x4610a9}=_0xa27e7f[_0x1de0c6(0xcd)],_0x39c0e5=_0xa27e7f[_0x1de0c6(0xcd)],_0x1151ad=await profile[_0x1de0c6(0x10a)]({'email':_0x39c0e5[_0x1de0c6(0x123)]}),_0x117cb5=await master_shop[_0x1de0c6(0xdd)](),_0x769a89=await warehouse['aggregate']([{'$match':{'status':_0x1de0c6(0xd0),'warehouse_category':_0x1de0c6(0xff)}},{'$group':{'_id':_0x1de0c6(0xfa),'name':{'$first':_0x1de0c6(0xfa)}}}]);if(_0x117cb5[0x0]['language']==_0x1de0c6(0x106))var _0x229a5c=users[_0x1de0c6(0xd1)];else{if(_0x117cb5[0x0][_0x1de0c6(0x134)]=='Hindi')var _0x229a5c=users[_0x1de0c6(0x133)];else{if(_0x117cb5[0x0][_0x1de0c6(0x134)]==_0x1de0c6(0x107))var _0x229a5c=users['German'];else{if(_0x117cb5[0x0][_0x1de0c6(0x134)]==_0x1de0c6(0xf5))var _0x229a5c=users[_0x1de0c6(0xf5)];else{if(_0x117cb5[0x0][_0x1de0c6(0x134)]==_0x1de0c6(0x12f))var _0x229a5c=users[_0x1de0c6(0x12f)];else{if(_0x117cb5[0x0][_0x1de0c6(0x134)]==_0x1de0c6(0x117))var _0x229a5c=users[_0x1de0c6(0x11a)];else{if(_0x117cb5[0x0][_0x1de0c6(0x134)]=='Chinese')var _0x229a5c=users['Chinese'];else{if(_0x117cb5[0x0][_0x1de0c6(0x134)]=='Arabic\x20(ae)')var _0x229a5c=users[_0x1de0c6(0xcf)];}}}}}}}_0x1cfbb5[_0x1de0c6(0x11c)](_0x1de0c6(0xdc),{'success':_0xa27e7f['flash'](_0x1de0c6(0x11e)),'errors':_0xa27e7f[_0x1de0c6(0xe7)]('errors'),'role':_0x39c0e5,'profile':_0x1151ad,'master_shop':_0x117cb5,'dataProcess':_0x769a89,'language':_0x229a5c});}catch(_0x15b981){console[_0x1de0c6(0xe2)](_0x15b981);}}),router[a0_0x53b32f(0x10f)](a0_0x53b32f(0x126),async(_0x478897,_0x1c4b5b)=>{var _0x4d1983=a0_0x53b32f;try{var _0x13595e='',_0x151ee5=await purchases_finished[_0x4d1983(0x110)]([{'$match':{'invoice':'INCF-95558079'}},{'$unwind':_0x4d1983(0x111)},{'$group':{'_id':{'item_code':_0x4d1983(0x104),'item_description':_0x4d1983(0xf7),'production_date':_0x4d1983(0xe1),'expiry_date':_0x4d1983(0x109)},'totalQty':{'$sum':'$product.quantity'},'unit':{'$first':_0x4d1983(0x100)},'secondary_unit':{'$first':_0x4d1983(0xcb)}}}]);_0x1c4b5b[_0x4d1983(0x108)](_0x151ee5);}catch(_0x479203){_0x1c4b5b[_0x4d1983(0x108)](_0x479203);}}),router[a0_0x53b32f(0xda)]('/reports',auth,async(_0x5bc315,_0x57ea02)=>{var _0x165a9c=a0_0x53b32f;const {product_category:_0x13847b,transaction_category:_0x52d26d,transaction_date_from:_0x4c210f,transaction_date_to:_0x1e1dc5,warehouse_category:_0x474d16,item_code:_0x43838e}=_0x5bc315[_0x165a9c(0x102)];console[_0x165a9c(0xe2)](_0x474d16);if(_0x13847b=='rm'){if(_0x474d16==_0x165a9c(0xd8)){var _0x233d39=await purchases['aggregate']([{'$match':{'date':{'$gte':_0x4c210f,'$lte':_0x1e1dc5}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x165a9c(0x11f)},'pipeline':[{'$unwind':_0x165a9c(0xfd)},{'$match':{'$expr':{'$eq':[_0x165a9c(0x132),_0x165a9c(0x115)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x165a9c(0xe3),'product_code':_0x165a9c(0xe5),'quantity_available':_0x165a9c(0xc7),'warehouse_name':_0x165a9c(0xfa),'warehouse_room':_0x165a9c(0xde),'invoice':_0x165a9c(0x115),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':_0x165a9c(0xf2)}}]);_0x233d39[_0x165a9c(0x10d)]={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0x175d3c=>{var _0x54f57e=_0x165a9c;_0x233d39[_0x54f57e(0x10d)][_0x175d3c[_0x54f57e(0xea)]]=[],await Promise['all'](_0x175d3c[_0x54f57e(0xf2)]['map'](async _0x2d2fe5=>{var _0x5f21b6=_0x54f57e;const _0x236d39=await sales[_0x5f21b6(0x110)]([{'$unwind':_0x5f21b6(0x125)},{'$match':{'sale_product.id_transaction_from':_0x2d2fe5['_id'][_0x5f21b6(0xc6)](),'sale_product.invoice':_0x2d2fe5[_0x5f21b6(0xea)]}},{'$project':{'_id':_0x5f21b6(0xf1),'product_name':_0x5f21b6(0xf3),'product_code':_0x5f21b6(0xe0),'quantity_available':_0x5f21b6(0xe4),'warehouse_name':_0x5f21b6(0x103),'warehouse_room':_0x5f21b6(0xe6),'product_invoice':_0x5f21b6(0xf4),'invoice':_0x5f21b6(0x11f),'id_transaction_from':_0x5f21b6(0xf0),'date':_0x5f21b6(0xce),'production_date':_0x5f21b6(0x127),'expiry_date':_0x5f21b6(0xd6),'UOM':'$sale_product.unit'}}]);_0x236d39['length']>0x0&&_0x233d39[_0x5f21b6(0x10d)][_0x175d3c['invoice']][_0x5f21b6(0x10c)](..._0x236d39);}));})),_0x233d39['data_sales']=_0x233d39['data_sales'],_0x233d39[_0x165a9c(0xe8)]={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0x5d4af5=>{var _0x1980f4=_0x165a9c;_0x233d39[_0x1980f4(0xe8)][_0x5d4af5[_0x1980f4(0xea)]]=[],await Promise['all'](_0x5d4af5[_0x1980f4(0xf2)][_0x1980f4(0x12c)](async _0x4616b8=>{var _0x55358a=_0x1980f4;const _0x3cf416=await adjustment[_0x55358a(0x110)]([{'$unwind':_0x55358a(0x111)},{'$match':{'product.id_transaction_from':_0x4616b8[_0x55358a(0x113)]['valueOf'](),'product.invoice':_0x4616b8[_0x55358a(0xea)]}},{'$project':{'_id':_0x55358a(0x12a),'product_name':_0x55358a(0xf7),'product_code':_0x55358a(0x104),'quantity_available':_0x55358a(0xd2),'warehouse_name':_0x55358a(0x103),'warehouse_room':_0x55358a(0xcc),'product_invoice':_0x55358a(0xd5),'invoice':'$invoice','id_transaction_from':_0x55358a(0x11b),'date':_0x55358a(0xce),'production_date':_0x55358a(0xe1),'expiry_date':_0x55358a(0x109),'UOM':'$product.unit'}}]);_0x3cf416[_0x55358a(0xef)]>0x0&&_0x233d39[_0x55358a(0xe8)][_0x5d4af5[_0x55358a(0xea)]]['push'](..._0x3cf416);}));})),_0x233d39[_0x165a9c(0x105)]={},await Promise[_0x165a9c(0xd8)](_0x233d39['map'](async _0xeb4197=>{var _0x5b0148=_0x165a9c;_0x233d39[_0x5b0148(0x105)][_0xeb4197[_0x5b0148(0xea)]]=[],await Promise[_0x5b0148(0xd8)](_0xeb4197[_0x5b0148(0xf2)]['map'](async _0x287aec=>{var _0x20a850=_0x5b0148;const _0x340ef2=await transfers['aggregate']([{'$unwind':_0x20a850(0x111)},{'$match':{'product.id_transaction_id':_0x287aec[_0x20a850(0x113)][_0x20a850(0xc6)](),'product.To_invoice':_0x287aec[_0x20a850(0xea)]}},{'$project':{'_id':'$product._id','product_name':_0x20a850(0xf7),'product_code':_0x20a850(0x104),'quantity_available':_0x20a850(0x122),'warehouse_name':_0x20a850(0x101),'warehouse_room':'$product.room_names','product_invoice':_0x20a850(0x12d),'invoice':_0x20a850(0x11f),'id_transaction_from':_0x20a850(0x116),'date':'$date','production_date':_0x20a850(0xe1),'expiry_date':_0x20a850(0x109),'UOM':'$product.unit'}}]);_0x340ef2['length']>0x0&&_0x233d39[_0x20a850(0x105)][_0xeb4197[_0x20a850(0xea)]][_0x20a850(0x10c)](..._0x340ef2);}));})),_0x57ea02['json']({'purchases_warehouse':_0x233d39,'data_sales':_0x233d39[_0x165a9c(0x10d)],'data_adjustment':_0x233d39[_0x165a9c(0xe8)],'data_transfer':_0x233d39[_0x165a9c(0x105)]});}else{var _0x233d39=await purchases[_0x165a9c(0x110)]([{'$match':{'warehouse_name':_0x474d16,'date':{'$gte':_0x4c210f,'$lte':_0x1e1dc5}}},{'$lookup':{'from':_0x165a9c(0x129),'let':{'invoice':_0x165a9c(0x11f)},'pipeline':[{'$unwind':_0x165a9c(0xfd)},{'$match':{'$expr':{'$eq':[_0x165a9c(0x132),_0x165a9c(0x115)]}}},{'$project':{'_id':'$product_details._id','product_name':'$product_details.product_name','product_code':_0x165a9c(0xe5),'quantity_available':_0x165a9c(0xc7),'warehouse_name':_0x165a9c(0xfa),'warehouse_room':_0x165a9c(0xde),'invoice':_0x165a9c(0x115),'production_date':_0x165a9c(0x119),'expiry_date':_0x165a9c(0xca),'UOM':'$product_details.unit'}}],'as':_0x165a9c(0xf2)}}]);_0x233d39['data_sales']={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0xc4fa15=>{var _0x390b61=_0x165a9c;_0x233d39[_0x390b61(0x10d)][_0xc4fa15[_0x390b61(0xea)]]=[],await Promise[_0x390b61(0xd8)](_0xc4fa15[_0x390b61(0xf2)][_0x390b61(0x12c)](async _0x318f68=>{var _0x62049e=_0x390b61;const _0x1d4684=await sales['aggregate']([{'$unwind':_0x62049e(0x125)},{'$match':{'sale_product.id_transaction_from':_0x318f68['_id'][_0x62049e(0xc6)](),'sale_product.invoice':_0x318f68[_0x62049e(0xea)]}},{'$project':{'_id':_0x62049e(0xf1),'product_name':_0x62049e(0xf3),'product_code':'$sale_product.product_code','quantity_available':_0x62049e(0xe4),'warehouse_name':_0x62049e(0x103),'warehouse_room':_0x62049e(0xe6),'product_invoice':_0x62049e(0xf4),'invoice':_0x62049e(0x11f),'id_transaction_from':_0x62049e(0xf0),'date':_0x62049e(0xce),'production_date':_0x62049e(0x127),'expiry_date':_0x62049e(0xd6),'UOM':_0x62049e(0x11d)}}]);_0x1d4684['length']>0x0&&_0x233d39[_0x62049e(0x10d)][_0xc4fa15[_0x62049e(0xea)]]['push'](..._0x1d4684);}));})),_0x233d39['data_sales']=_0x233d39[_0x165a9c(0x10d)],_0x233d39[_0x165a9c(0xe8)]={},await Promise['all'](_0x233d39[_0x165a9c(0x12c)](async _0x2dd514=>{var _0x38fbf1=_0x165a9c;_0x233d39[_0x38fbf1(0xe8)][_0x2dd514[_0x38fbf1(0xea)]]=[],await Promise['all'](_0x2dd514[_0x38fbf1(0xf2)][_0x38fbf1(0x12c)](async _0x14a9cd=>{var _0xfb3b08=_0x38fbf1;const _0x4f70a9=await adjustment[_0xfb3b08(0x110)]([{'$unwind':_0xfb3b08(0x111)},{'$match':{'product.id_transaction_from':_0x14a9cd['_id'][_0xfb3b08(0xc6)](),'product.invoice':_0x14a9cd[_0xfb3b08(0xea)]}},{'$project':{'_id':_0xfb3b08(0x12a),'product_name':_0xfb3b08(0xf7),'product_code':_0xfb3b08(0x104),'quantity_available':_0xfb3b08(0xd2),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':_0xfb3b08(0xd5),'invoice':_0xfb3b08(0x11f),'id_transaction_from':'$product.id_transaction_from','date':_0xfb3b08(0xce),'production_date':_0xfb3b08(0xe1),'expiry_date':'$product.expiry_date','UOM':_0xfb3b08(0x12b)}}]);_0x4f70a9[_0xfb3b08(0xef)]>0x0&&_0x233d39[_0xfb3b08(0xe8)][_0x2dd514[_0xfb3b08(0xea)]][_0xfb3b08(0x10c)](..._0x4f70a9);}));})),_0x233d39[_0x165a9c(0x105)]={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0x5fb67b=>{var _0x395edd=_0x165a9c;_0x233d39['data_transfer'][_0x5fb67b['invoice']]=[],await Promise[_0x395edd(0xd8)](_0x5fb67b[_0x395edd(0xf2)][_0x395edd(0x12c)](async _0x42d4c7=>{var _0x7a7a1a=_0x395edd;const _0x153925=await transfers[_0x7a7a1a(0x110)]([{'$unwind':_0x7a7a1a(0x111)},{'$match':{'product.id_transaction_id':_0x42d4c7[_0x7a7a1a(0x113)][_0x7a7a1a(0xc6)](),'product.To_invoice':_0x42d4c7[_0x7a7a1a(0xea)]}},{'$project':{'_id':_0x7a7a1a(0x12a),'product_name':_0x7a7a1a(0xf7),'product_code':'$product.product_code','quantity_available':_0x7a7a1a(0x122),'warehouse_name':_0x7a7a1a(0x101),'warehouse_room':_0x7a7a1a(0xcc),'product_invoice':_0x7a7a1a(0x12d),'invoice':_0x7a7a1a(0x11f),'id_transaction_from':_0x7a7a1a(0x116),'date':_0x7a7a1a(0xce),'production_date':_0x7a7a1a(0xe1),'expiry_date':_0x7a7a1a(0x109),'UOM':_0x7a7a1a(0x12b)}}]);_0x153925['length']>0x0&&_0x233d39[_0x7a7a1a(0x105)][_0x5fb67b[_0x7a7a1a(0xea)]][_0x7a7a1a(0x10c)](..._0x153925);}));})),_0x57ea02[_0x165a9c(0x108)]({'purchases_warehouse':_0x233d39,'data_sales':_0x233d39[_0x165a9c(0x10d)],'data_adjustment':_0x233d39[_0x165a9c(0xe8)],'data_transfer':_0x233d39[_0x165a9c(0x105)]});}}else{if(_0x474d16==_0x165a9c(0xd8)){var _0x233d39=await purchases_finished[_0x165a9c(0x110)]([{'$match':{'date':{'$gte':_0x4c210f,'$lte':_0x1e1dc5}}},{'$lookup':{'from':_0x165a9c(0x129),'let':{'invoice':_0x165a9c(0x11f)},'pipeline':[{'$unwind':_0x165a9c(0xfd)},{'$match':{'$expr':{'$eq':[_0x165a9c(0x132),'$product_details.invoice']}}},{'$project':{'_id':_0x165a9c(0x128),'product_name':_0x165a9c(0xe3),'product_code':_0x165a9c(0xe5),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':_0x165a9c(0xde),'invoice':_0x165a9c(0x115),'production_date':_0x165a9c(0x119),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':_0x165a9c(0xf2)}}]);_0x233d39[_0x165a9c(0x10d)]={},await Promise['all'](_0x233d39['map'](async _0x303dc2=>{var _0x2c770e=_0x165a9c;_0x233d39['data_sales'][_0x303dc2['invoice']]=[],await Promise[_0x2c770e(0xd8)](_0x303dc2['warehouse_data'][_0x2c770e(0x12c)](async _0x30f835=>{var _0xf544d6=_0x2c770e;const _0x5048e7=await sales_finished['aggregate']([{'$unwind':_0xf544d6(0x125)},{'$match':{'sale_product.id_transaction_from':_0x30f835[_0xf544d6(0x113)][_0xf544d6(0xc6)](),'sale_product.invoice':_0x30f835[_0xf544d6(0xea)]}},{'$project':{'_id':_0xf544d6(0xf1),'product_name':_0xf544d6(0xf3),'product_code':'$sale_product.product_code','quantity_available':_0xf544d6(0xe4),'warehouse_name':'$warehouse_name','warehouse_room':_0xf544d6(0xe6),'product_invoice':_0xf544d6(0xf4),'invoice':_0xf544d6(0x11f),'id_transaction_from':'$sale_product.id_transaction_from','date':_0xf544d6(0xce),'production_date':_0xf544d6(0x127),'expiry_date':_0xf544d6(0xd6),'UOM':_0xf544d6(0x11d)}}]);_0x5048e7[_0xf544d6(0xef)]>0x0&&_0x233d39[_0xf544d6(0x10d)][_0x303dc2['invoice']][_0xf544d6(0x10c)](..._0x5048e7);}));})),_0x233d39[_0x165a9c(0x10d)]=_0x233d39['data_sales'],_0x233d39[_0x165a9c(0xe8)]={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0x2a320c=>{var _0x312517=_0x165a9c;_0x233d39[_0x312517(0xe8)][_0x2a320c[_0x312517(0xea)]]=[],await Promise['all'](_0x2a320c['warehouse_data'][_0x312517(0x12c)](async _0x299045=>{var _0x3f1b36=_0x312517;const _0x134db6=await adjustment_finished[_0x3f1b36(0x110)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x299045[_0x3f1b36(0x113)]['valueOf'](),'product.invoice':_0x299045['invoice']}},{'$project':{'_id':_0x3f1b36(0x12a),'product_name':_0x3f1b36(0xf7),'product_code':_0x3f1b36(0x104),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x3f1b36(0xcc),'product_invoice':_0x3f1b36(0xd5),'invoice':_0x3f1b36(0x11f),'id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':'$product.production_date','expiry_date':_0x3f1b36(0x109),'UOM':'$product.unit'}}]);_0x134db6[_0x3f1b36(0xef)]>0x0&&_0x233d39[_0x3f1b36(0xe8)][_0x2a320c[_0x3f1b36(0xea)]][_0x3f1b36(0x10c)](..._0x134db6);}));})),_0x233d39['data_transfer']={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0x1e46de=>{var _0x24cd0d=_0x165a9c;_0x233d39[_0x24cd0d(0x105)][_0x1e46de[_0x24cd0d(0xea)]]=[],await Promise[_0x24cd0d(0xd8)](_0x1e46de[_0x24cd0d(0xf2)][_0x24cd0d(0x12c)](async _0x60c6d=>{var _0x4670b4=_0x24cd0d;const _0x4de854=await transfers_finished[_0x4670b4(0x110)]([{'$unwind':_0x4670b4(0x111)},{'$match':{'product.id_transaction':_0x60c6d[_0x4670b4(0x113)]['valueOf'](),'product.from_invoice':_0x60c6d[_0x4670b4(0xea)]}},{'$project':{'_id':'$product._id','product_name':_0x4670b4(0xf7),'product_code':_0x4670b4(0x104),'quantity_available':_0x4670b4(0x122),'warehouse_name':_0x4670b4(0x101),'warehouse_room':_0x4670b4(0xcc),'product_invoice':_0x4670b4(0x12d),'invoice':_0x4670b4(0x11f),'id_transaction_from':_0x4670b4(0x12e),'date':_0x4670b4(0xce),'production_date':_0x4670b4(0xe1),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x4de854['length']>0x0&&_0x233d39['data_transfer'][_0x1e46de[_0x4670b4(0xea)]][_0x4670b4(0x10c)](..._0x4de854);}));})),_0x57ea02[_0x165a9c(0x108)]({'purchases_warehouse':_0x233d39,'data_sales':_0x233d39[_0x165a9c(0x10d)],'data_adjustment':_0x233d39[_0x165a9c(0xe8)],'data_transfer':_0x233d39[_0x165a9c(0x105)]});}else{var _0x233d39=await purchases_finished[_0x165a9c(0x110)]([{'$match':{'warehouse_name':_0x474d16,'date':{'$gte':_0x4c210f,'$lte':_0x1e1dc5}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x165a9c(0x11f)},'pipeline':[{'$unwind':_0x165a9c(0xfd)},{'$match':{'$expr':{'$eq':[_0x165a9c(0x132),_0x165a9c(0x115)]}}},{'$project':{'_id':_0x165a9c(0x128),'product_name':_0x165a9c(0xe3),'product_code':_0x165a9c(0xe5),'quantity_available':_0x165a9c(0xc7),'warehouse_name':_0x165a9c(0xfa),'warehouse_room':_0x165a9c(0xde),'invoice':'$product_details.invoice','production_date':_0x165a9c(0x119),'expiry_date':_0x165a9c(0xca),'UOM':_0x165a9c(0xdb)}}],'as':_0x165a9c(0xf2)}}]);_0x233d39[_0x165a9c(0x10d)]={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0x17f360=>{var _0x564416=_0x165a9c;_0x233d39['data_sales'][_0x17f360[_0x564416(0xea)]]=[],await Promise[_0x564416(0xd8)](_0x17f360[_0x564416(0xf2)]['map'](async _0x4ecbe6=>{var _0x2d2b95=_0x564416;const _0xe39042=await sales_finished[_0x2d2b95(0x110)]([{'$unwind':_0x2d2b95(0x125)},{'$match':{'sale_product.id_transaction_from':_0x4ecbe6['_id'][_0x2d2b95(0xc6)](),'sale_product.invoice':_0x4ecbe6[_0x2d2b95(0xea)]}},{'$project':{'_id':_0x2d2b95(0xf1),'product_name':_0x2d2b95(0xf3),'product_code':_0x2d2b95(0xe0),'quantity_available':_0x2d2b95(0xe4),'warehouse_name':_0x2d2b95(0x103),'warehouse_room':_0x2d2b95(0xe6),'product_invoice':_0x2d2b95(0xf4),'invoice':_0x2d2b95(0x11f),'id_transaction_from':_0x2d2b95(0xf0),'date':_0x2d2b95(0xce),'production_date':'$sale_product.production_date','expiry_date':'$sale_product.expiry_date','UOM':'$sale_product.unit'}}]);_0xe39042[_0x2d2b95(0xef)]>0x0&&_0x233d39['data_sales'][_0x17f360['invoice']][_0x2d2b95(0x10c)](..._0xe39042);}));})),_0x233d39[_0x165a9c(0x10d)]=_0x233d39[_0x165a9c(0x10d)],_0x233d39[_0x165a9c(0xe8)]={},await Promise['all'](_0x233d39[_0x165a9c(0x12c)](async _0x93d556=>{var _0x5c3de3=_0x165a9c;_0x233d39[_0x5c3de3(0xe8)][_0x93d556[_0x5c3de3(0xea)]]=[],await Promise['all'](_0x93d556[_0x5c3de3(0xf2)]['map'](async _0x2c6f69=>{var _0x46d66c=_0x5c3de3;const _0x3fa562=await adjustment_finished[_0x46d66c(0x110)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x2c6f69[_0x46d66c(0x113)]['valueOf'](),'product.invoice':_0x2c6f69[_0x46d66c(0xea)]}},{'$project':{'_id':_0x46d66c(0x12a),'product_name':_0x46d66c(0xf7),'product_code':'$product.product_code','quantity_available':_0x46d66c(0xd2),'warehouse_name':_0x46d66c(0x103),'warehouse_room':_0x46d66c(0xcc),'product_invoice':'$product.invoice','invoice':_0x46d66c(0x11f),'id_transaction_from':_0x46d66c(0x11b),'date':_0x46d66c(0xce),'production_date':'$product.production_date','expiry_date':_0x46d66c(0x109),'UOM':_0x46d66c(0x12b)}}]);_0x3fa562[_0x46d66c(0xef)]>0x0&&_0x233d39[_0x46d66c(0xe8)][_0x93d556[_0x46d66c(0xea)]]['push'](..._0x3fa562);}));})),_0x233d39['data_transfer']={},await Promise[_0x165a9c(0xd8)](_0x233d39[_0x165a9c(0x12c)](async _0x4cfec4=>{var _0x434c1=_0x165a9c;_0x233d39[_0x434c1(0x105)][_0x4cfec4[_0x434c1(0xea)]]=[],await Promise[_0x434c1(0xd8)](_0x4cfec4['warehouse_data'][_0x434c1(0x12c)](async _0xc5daf=>{var _0x54c66e=_0x434c1;const _0xeed133=await transfers_finished[_0x54c66e(0x110)]([{'$unwind':_0x54c66e(0x111)},{'$match':{'product.id_transaction':_0xc5daf[_0x54c66e(0x113)]['valueOf'](),'product.from_invoice':_0xc5daf[_0x54c66e(0xea)]}},{'$project':{'_id':_0x54c66e(0x12a),'product_name':'$product.product_name','product_code':_0x54c66e(0x104),'quantity_available':_0x54c66e(0x122),'warehouse_name':_0x54c66e(0x101),'warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x54c66e(0x12e),'date':_0x54c66e(0xce),'production_date':_0x54c66e(0xe1),'expiry_date':_0x54c66e(0x109),'UOM':_0x54c66e(0x12b)}}]);_0xeed133[_0x54c66e(0xef)]>0x0&&_0x233d39[_0x54c66e(0x105)][_0x4cfec4[_0x54c66e(0xea)]][_0x54c66e(0x10c)](..._0xeed133);}));})),_0x57ea02[_0x165a9c(0x108)]({'purchases_warehouse':_0x233d39,'data_sales':_0x233d39[_0x165a9c(0x10d)],'data_adjustment':_0x233d39[_0x165a9c(0xe8)],'data_transfer':_0x233d39[_0x165a9c(0x105)]});}}}),router['get']('/viewdata_inc_fg/:id',auth,async(_0x722f06,_0x475f29)=>{var _0x5694aa=a0_0x53b32f;try{const _0x226dbb=_0x722f06[_0x5694aa(0xfe)]['id'];var _0x569164=await purchases_finished[_0x5694aa(0xfb)](_0x226dbb);const _0x2c0981=await master_shop[_0x5694aa(0xdd)](),_0xbdc5a7=_0x722f06[_0x5694aa(0xcd)],_0x1a3ed6=await profile['findOne']({'email':_0xbdc5a7['email']});if(_0x2c0981[0x0][_0x5694aa(0x134)]=='English\x20(US)')var _0x361a4a=users[_0x5694aa(0xd1)];else{if(_0x2c0981[0x0]['language']==_0x5694aa(0x133))var _0x361a4a=users[_0x5694aa(0x133)];else{if(_0x2c0981[0x0][_0x5694aa(0x134)]=='German')var _0x361a4a=users[_0x5694aa(0x107)];else{if(_0x2c0981[0x0][_0x5694aa(0x134)]==_0x5694aa(0xf5))var _0x361a4a=users['Spanish'];else{if(_0x2c0981[0x0]['language']=='French')var _0x361a4a=users['French'];else{if(_0x2c0981[0x0]['language']=='Portuguese\x20(BR)')var _0x361a4a=users[_0x5694aa(0x11a)];else{if(_0x2c0981[0x0][_0x5694aa(0x134)]=='Chinese')var _0x361a4a=users['Chinese'];else{if(_0x2c0981[0x0][_0x5694aa(0x134)]=='Arabic\x20(ae)')var _0x361a4a=users['Arabic'];}}}}}}}_0x475f29[_0x5694aa(0x11c)](_0x5694aa(0xd7),{'success':_0x722f06[_0x5694aa(0xe7)]('success'),'errors':_0x722f06[_0x5694aa(0xe7)](_0x5694aa(0xe9)),'master_shop':_0x2c0981,'profile':_0x1a3ed6,'role':_0xbdc5a7,'language':_0x361a4a,'data':_0x569164});}catch(_0x4aacd4){_0x475f29[_0x5694aa(0x108)](_0x4aacd4);}}),router['get'](a0_0x53b32f(0xec),auth,async(_0x188856,_0x4b4501)=>{var _0x63c726=a0_0x53b32f;try{const _0x335e72=_0x188856['params']['id'];var _0x4a901d=await sales_finished[_0x63c726(0xfb)](_0x335e72);const _0x2c3728=await master_shop[_0x63c726(0xdd)](),_0x527a6a=_0x188856[_0x63c726(0xcd)],_0x12527c=await profile[_0x63c726(0x10a)]({'email':_0x527a6a[_0x63c726(0x123)]});if(_0x2c3728[0x0][_0x63c726(0x134)]=='English\x20(US)')var _0x64c4b4=users['English'];else{if(_0x2c3728[0x0]['language']==_0x63c726(0x133))var _0x64c4b4=users['Hindi'];else{if(_0x2c3728[0x0][_0x63c726(0x134)]==_0x63c726(0x107))var _0x64c4b4=users[_0x63c726(0x107)];else{if(_0x2c3728[0x0][_0x63c726(0x134)]==_0x63c726(0xf5))var _0x64c4b4=users[_0x63c726(0xf5)];else{if(_0x2c3728[0x0][_0x63c726(0x134)]==_0x63c726(0x12f))var _0x64c4b4=users['French'];else{if(_0x2c3728[0x0][_0x63c726(0x134)]=='Portuguese\x20(BR)')var _0x64c4b4=users[_0x63c726(0x11a)];else{if(_0x2c3728[0x0][_0x63c726(0x134)]==_0x63c726(0x10e))var _0x64c4b4=users['Chinese'];else{if(_0x2c3728[0x0][_0x63c726(0x134)]==_0x63c726(0x10b))var _0x64c4b4=users[_0x63c726(0xcf)];}}}}}}}_0x4b4501[_0x63c726(0x11c)](_0x63c726(0x120),{'success':_0x188856[_0x63c726(0xe7)](_0x63c726(0x11e)),'errors':_0x188856[_0x63c726(0xe7)](_0x63c726(0xe9)),'master_shop':_0x2c3728,'profile':_0x12527c,'role':_0x527a6a,'language':_0x64c4b4,'data':_0x4a901d});}catch(_0x5be6a1){_0x4b4501[_0x63c726(0x108)](_0x5be6a1);}}),router[a0_0x53b32f(0x10f)](a0_0x53b32f(0xd9),auth,async(_0x2c4986,_0x1f1395)=>{var _0x1977e8=a0_0x53b32f;try{const _0x2b658c=_0x2c4986[_0x1977e8(0xfe)]['id'];var _0x26bd65=await transfers_finished[_0x1977e8(0xfb)](_0x2b658c);const _0x8d751a=await master_shop[_0x1977e8(0xdd)](),_0x1556b6=_0x2c4986[_0x1977e8(0xcd)],_0x42549d=await profile[_0x1977e8(0x10a)]({'email':_0x1556b6['email']});if(_0x8d751a[0x0][_0x1977e8(0x134)]==_0x1977e8(0x106))var _0x27aa8e=users['English'];else{if(_0x8d751a[0x0][_0x1977e8(0x134)]==_0x1977e8(0x133))var _0x27aa8e=users[_0x1977e8(0x133)];else{if(_0x8d751a[0x0]['language']==_0x1977e8(0x107))var _0x27aa8e=users['German'];else{if(_0x8d751a[0x0][_0x1977e8(0x134)]=='Spanish')var _0x27aa8e=users[_0x1977e8(0xf5)];else{if(_0x8d751a[0x0]['language']==_0x1977e8(0x12f))var _0x27aa8e=users[_0x1977e8(0x12f)];else{if(_0x8d751a[0x0][_0x1977e8(0x134)]==_0x1977e8(0x117))var _0x27aa8e=users[_0x1977e8(0x11a)];else{if(_0x8d751a[0x0][_0x1977e8(0x134)]==_0x1977e8(0x10e))var _0x27aa8e=users[_0x1977e8(0x10e)];else{if(_0x8d751a[0x0][_0x1977e8(0x134)]==_0x1977e8(0x10b))var _0x27aa8e=users[_0x1977e8(0xcf)];}}}}}}}_0x1f1395[_0x1977e8(0x11c)](_0x1977e8(0xeb),{'success':_0x2c4986['flash'](_0x1977e8(0x11e)),'errors':_0x2c4986[_0x1977e8(0xe7)](_0x1977e8(0xe9)),'master_shop':_0x8d751a,'profile':_0x42549d,'role':_0x1556b6,'language':_0x27aa8e,'data':_0x26bd65});}catch(_0x2d7253){_0x1f1395[_0x1977e8(0x108)](_0x2d7253);}}),router[a0_0x53b32f(0x10f)](a0_0x53b32f(0xd4),auth,async(_0x377df5,_0x14f13b)=>{var _0x67ca11=a0_0x53b32f;try{const {username:_0x488f31,email:_0x14c544,role:_0x5bb5c3}=_0x377df5[_0x67ca11(0xcd)],_0x56d479=_0x377df5[_0x67ca11(0xcd)],_0x4c8901=await profile[_0x67ca11(0x10a)]({'email':_0x56d479[_0x67ca11(0x123)]}),_0x3c9b16=await master_shop[_0x67ca11(0xdd)](),_0x4ebe5c=await warehouse[_0x67ca11(0x110)]([{'$match':{'status':_0x67ca11(0xd0),'warehouse_category':_0x67ca11(0x118)}},{'$group':{'_id':_0x67ca11(0xfa),'name':{'$first':'$name'}}}]);if(_0x3c9b16[0x0]['language']==_0x67ca11(0x106))var _0x221e99=users[_0x67ca11(0xd1)];else{if(_0x3c9b16[0x0]['language']==_0x67ca11(0x133))var _0x221e99=users[_0x67ca11(0x133)];else{if(_0x3c9b16[0x0][_0x67ca11(0x134)]==_0x67ca11(0x107))var _0x221e99=users['German'];else{if(_0x3c9b16[0x0][_0x67ca11(0x134)]==_0x67ca11(0xf5))var _0x221e99=users[_0x67ca11(0xf5)];else{if(_0x3c9b16[0x0][_0x67ca11(0x134)]=='French')var _0x221e99=users[_0x67ca11(0x12f)];else{if(_0x3c9b16[0x0][_0x67ca11(0x134)]=='Portuguese\x20(BR)')var _0x221e99=users[_0x67ca11(0x11a)];else{if(_0x3c9b16[0x0][_0x67ca11(0x134)]=='Chinese')var _0x221e99=users[_0x67ca11(0x10e)];else{if(_0x3c9b16[0x0][_0x67ca11(0x134)]==_0x67ca11(0x10b))var _0x221e99=users[_0x67ca11(0xcf)];}}}}}}}_0x14f13b[_0x67ca11(0x11c)](_0x67ca11(0x124),{'success':_0x377df5[_0x67ca11(0xe7)]('success'),'errors':_0x377df5['flash']('errors'),'role':_0x56d479,'profile':_0x4c8901,'master_shop':_0x3c9b16,'dataProcess':_0x4ebe5c,'language':_0x221e99});}catch(_0x3de12d){console[_0x67ca11(0xe2)](_0x3de12d);}}),module[a0_0x53b32f(0xed)]=router;function a0_0x5214(_0x1c7b66,_0x119a5){var _0x38d5ac=a0_0x38d5();return a0_0x5214=function(_0x521456,_0x4f364b){_0x521456=_0x521456-0xc6;var _0x57e62f=_0x38d5ac[_0x521456];return _0x57e62f;},a0_0x5214(_0x1c7b66,_0x119a5);}function a0_0x38d5(){var _0x487da1=['aggregate','$product','2449006KWafZd','_id','1570592khHdoZ','$product_details.invoice','$product.id_transaction_id','Portuguese\x20(BR)','Raw\x20Materials','$product_details.production_date','Portuguese','$product.id_transaction_from','render','$sale_product.unit','success','$invoice','view_og_table','40HTiAgI','$product.to_quantity','email','transaction_finished_raw','$sale_product','/reports','$sale_product.production_date','$product_details._id','warehouses','$product._id','$product.unit','map','$product.to_room_name','$product.id_transaction','French','../models/all_models','Router','$$invoice','Hindi','language','valueOf','$product_details.product_stock','../middleware/auth','5mgAZqq','$product_details.expiry_date','$product.secondary_unit','$product.room_names','user','$date','Arabic','Enabled','English','$product.new_adjust_qty','1490970WsVsVT','/viewFG','$product.invoice','$sale_product.expiry_date','view_table','all','/viewdata_tf_fg/:id','post','$product_details.unit','transaction_finished','find','$room','828750NncGVJ','$sale_product.product_code','$product.production_date','log','$product_details.product_name','$sale_product.quantity','$product_details.product_code','$sale_product.room_name','flash','data_adjustment','errors','invoice','view_tf_table','/viewdata_og_fg/:id','exports','92zeBgyp','length','$sale_product.id_transaction_from','$sale_product._id','warehouse_data','$sale_product.product_name','$sale_product.invoice','Spanish','nodemailer','$product.product_name','1254465fVlgZi','16581IUByaf','$name','findById','483255beijSW','$product_details','params','Finished\x20Goods','$product.standard_unit','$to_warehouse','body','$warehouse_name','$product.product_code','data_transfer','English\x20(US)','German','json','$product.expiry_date','findOne','Arabic\x20(ae)','push','data_sales','Chinese','get'];a0_0x38d5=function(){return _0x487da1;};return a0_0x38d5();}