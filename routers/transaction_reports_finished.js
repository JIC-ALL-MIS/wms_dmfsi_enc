var a0_0x3ba2ca=a0_0x1368;(function(_0x471087,_0x597a13){var _0x27ab3f=a0_0x1368,_0x2f0c3c=_0x471087();while(!![]){try{var _0x410718=-parseInt(_0x27ab3f(0x13b))/0x1+parseInt(_0x27ab3f(0x108))/0x2+-parseInt(_0x27ab3f(0x168))/0x3+parseInt(_0x27ab3f(0x121))/0x4*(-parseInt(_0x27ab3f(0x11c))/0x5)+parseInt(_0x27ab3f(0x125))/0x6*(-parseInt(_0x27ab3f(0x103))/0x7)+-parseInt(_0x27ab3f(0x165))/0x8*(-parseInt(_0x27ab3f(0x13f))/0x9)+-parseInt(_0x27ab3f(0x111))/0xa*(-parseInt(_0x27ab3f(0x156))/0xb);if(_0x410718===_0x597a13)break;else _0x2f0c3c['push'](_0x2f0c3c['shift']());}catch(_0x3f2577){_0x2f0c3c['push'](_0x2f0c3c['shift']());}}}(a0_0x2b17,0x87a94));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x3ba2ca(0x106)),auth=require(a0_0x3ba2ca(0x154)),users=require(a0_0x3ba2ca(0x10a)),nodemailer=require(a0_0x3ba2ca(0x159));function a0_0x2b17(){var _0x4064ed=['135LqVdVt','get','findById','push','findOne','$product.product_name','French','user','$$invoice','$to_warehouse','$sale_product','view_tf_table','transaction_finished','$sale_product._id','success','log','Spanish','find','$sale_product.product_code','Arabic','warehouse_data','../middleware/auth','/viewdata_og_fg/:id','2035iYePYZ','view_table','data_sales','nodemailer','$product_details.product_stock','json','$sale_product.quantity','$invoice','language','email','$product.id_transaction_id','$product.to_room_name','Finished\x20Goods','$product_details','$name','270768Kaxahf','$sale_product.unit','view_og_table','712659QiRJKI','_id','invoice','$product_details.invoice','render','$product.expiry_date','$product.id_transaction','Hindi','617386lMUzQk','transaction_finished_raw','$product','../models/all_models','Portuguese','390610YmJZgU','Portuguese\x20(BR)','../public/language/languages.json','exports','$sale_product.invoice','$product.product_code','aggregate','$sale_product.expiry_date','/reports','118050KjbNHm','English','$product.production_date','$product.invoice','$product_details.production_date','$product._id','$product_details.product_code','data_transfer','valueOf','length','Arabic\x20(ae)','15cTmWHF','$warehouse_name','$sale_product.production_date','$date','$product_details._id','1065928CsXNcQ','$room','$product.new_adjust_qty','German','42VXECWR','Raw\x20Materials','$product_details.unit','Chinese','$product.to_quantity','data_adjustment','English\x20(US)','$product_details.product_name','warehouses','$product.id_transaction_from','$sale_product.room_name','$sale_product.product_name','post','flash','params','$product.room_names','/viewdata_inc_fg/:id','$product.unit','Enabled','$product_details.expiry_date','$sale_product.id_transaction_from','map','676867jrTpaO','errors','body','all'];a0_0x2b17=function(){return _0x4064ed;};return a0_0x2b17();}function a0_0x1368(_0x3a384f,_0x5c6ce7){var _0x2b1733=a0_0x2b17();return a0_0x1368=function(_0x136873,_0x117ac8){_0x136873=_0x136873-0xff;var _0x53068d=_0x2b1733[_0x136873];return _0x53068d;},a0_0x1368(_0x3a384f,_0x5c6ce7);}router[a0_0x3ba2ca(0x140)]('/view',auth,async(_0x338eed,_0x54d5e7)=>{var _0x14dd60=a0_0x3ba2ca;try{const {username:_0x53f878,email:_0x3bf07e,role:_0x5b1317}=_0x338eed[_0x14dd60(0x146)],_0x6a91e6=_0x338eed['user'],_0x148fa4=await profile[_0x14dd60(0x143)]({'email':_0x6a91e6['email']}),_0xae107b=await master_shop[_0x14dd60(0x150)](),_0x35c4ca=await warehouse[_0x14dd60(0x10e)]([{'$match':{'status':'Enabled','warehouse_category':_0x14dd60(0x162)}},{'$group':{'_id':_0x14dd60(0x164),'name':{'$first':_0x14dd60(0x164)}}}]);if(_0xae107b[0x0][_0x14dd60(0x15e)]==_0x14dd60(0x12b))var _0x43dff4=users[_0x14dd60(0x112)];else{if(_0xae107b[0x0]['language']==_0x14dd60(0x102))var _0x43dff4=users[_0x14dd60(0x102)];else{if(_0xae107b[0x0][_0x14dd60(0x15e)]=='German')var _0x43dff4=users[_0x14dd60(0x124)];else{if(_0xae107b[0x0][_0x14dd60(0x15e)]==_0x14dd60(0x14f))var _0x43dff4=users[_0x14dd60(0x14f)];else{if(_0xae107b[0x0][_0x14dd60(0x15e)]==_0x14dd60(0x145))var _0x43dff4=users[_0x14dd60(0x145)];else{if(_0xae107b[0x0]['language']==_0x14dd60(0x109))var _0x43dff4=users[_0x14dd60(0x107)];else{if(_0xae107b[0x0][_0x14dd60(0x15e)]==_0x14dd60(0x128))var _0x43dff4=users[_0x14dd60(0x128)];else{if(_0xae107b[0x0][_0x14dd60(0x15e)]==_0x14dd60(0x11b))var _0x43dff4=users[_0x14dd60(0x152)];}}}}}}}_0x54d5e7[_0x14dd60(0xff)](_0x14dd60(0x14b),{'success':_0x338eed[_0x14dd60(0x132)]('success'),'errors':_0x338eed[_0x14dd60(0x132)](_0x14dd60(0x13c)),'role':_0x6a91e6,'profile':_0x148fa4,'master_shop':_0xae107b,'dataProcess':_0x35c4ca,'language':_0x43dff4});}catch(_0x13a5ce){console['log'](_0x13a5ce);}}),router[a0_0x3ba2ca(0x131)](a0_0x3ba2ca(0x110),auth,async(_0x95fdf8,_0x49b68c)=>{var _0x51e84b=a0_0x3ba2ca;const {product_category:_0x2161eb,transaction_category:_0x4d5833,transaction_date_from:_0x23c41b,transaction_date_to:_0x141e68,warehouse_category:_0x1d9572,item_code:_0x2a9965}=_0x95fdf8[_0x51e84b(0x13d)];console[_0x51e84b(0x14e)](_0x1d9572);if(_0x2161eb=='rm'){if(_0x1d9572==_0x51e84b(0x13e)){var _0x5707f1=await purchases[_0x51e84b(0x10e)]([{'$match':{'date':{'$gte':_0x23c41b,'$lte':_0x141e68}}},{'$lookup':{'from':_0x51e84b(0x12d),'let':{'invoice':_0x51e84b(0x15d)},'pipeline':[{'$unwind':_0x51e84b(0x163)},{'$match':{'$expr':{'$eq':[_0x51e84b(0x147),'$product_details.invoice']}}},{'$project':{'_id':_0x51e84b(0x120),'product_name':_0x51e84b(0x12c),'product_code':'$product_details.product_code','quantity_available':_0x51e84b(0x15a),'warehouse_name':_0x51e84b(0x164),'warehouse_room':_0x51e84b(0x122),'invoice':_0x51e84b(0x16b),'production_date':_0x51e84b(0x115),'expiry_date':_0x51e84b(0x138),'UOM':_0x51e84b(0x127)}}],'as':_0x51e84b(0x153)}}]);_0x5707f1['data_sales']={},await Promise[_0x51e84b(0x13e)](_0x5707f1[_0x51e84b(0x13a)](async _0x21f0ab=>{var _0x32569f=_0x51e84b;_0x5707f1[_0x32569f(0x158)][_0x21f0ab['invoice']]=[],await Promise[_0x32569f(0x13e)](_0x21f0ab['warehouse_data'][_0x32569f(0x13a)](async _0x3a8541=>{var _0x4be6e2=_0x32569f;const _0x2cf9b4=await sales['aggregate']([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x3a8541['_id'][_0x4be6e2(0x119)](),'sale_product.invoice':_0x3a8541['invoice']}},{'$project':{'_id':_0x4be6e2(0x14c),'product_name':'$sale_product.product_name','product_code':_0x4be6e2(0x151),'quantity_available':_0x4be6e2(0x15c),'warehouse_name':'$warehouse_name','warehouse_room':_0x4be6e2(0x12f),'product_invoice':_0x4be6e2(0x10c),'invoice':_0x4be6e2(0x15d),'id_transaction_from':_0x4be6e2(0x139),'date':_0x4be6e2(0x11f),'production_date':_0x4be6e2(0x11e),'expiry_date':_0x4be6e2(0x10f),'UOM':_0x4be6e2(0x166)}}]);_0x2cf9b4[_0x4be6e2(0x11a)]>0x0&&_0x5707f1[_0x4be6e2(0x158)][_0x21f0ab[_0x4be6e2(0x16a)]][_0x4be6e2(0x142)](..._0x2cf9b4);}));})),_0x5707f1[_0x51e84b(0x158)]=_0x5707f1[_0x51e84b(0x158)],_0x5707f1[_0x51e84b(0x12a)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1['map'](async _0x3e2450=>{var _0x3fbad=_0x51e84b;_0x5707f1[_0x3fbad(0x12a)][_0x3e2450[_0x3fbad(0x16a)]]=[],await Promise['all'](_0x3e2450[_0x3fbad(0x153)][_0x3fbad(0x13a)](async _0x174f9b=>{var _0x14c12e=_0x3fbad;const _0x37df18=await adjustment['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x174f9b[_0x14c12e(0x169)][_0x14c12e(0x119)](),'product.invoice':_0x174f9b['invoice']}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x14c12e(0x10d),'quantity_available':_0x14c12e(0x123),'warehouse_name':_0x14c12e(0x11d),'warehouse_room':_0x14c12e(0x134),'product_invoice':_0x14c12e(0x114),'invoice':_0x14c12e(0x15d),'id_transaction_from':_0x14c12e(0x12e),'date':'$date','production_date':_0x14c12e(0x113),'expiry_date':_0x14c12e(0x100),'UOM':_0x14c12e(0x136)}}]);_0x37df18[_0x14c12e(0x11a)]>0x0&&_0x5707f1[_0x14c12e(0x12a)][_0x3e2450[_0x14c12e(0x16a)]][_0x14c12e(0x142)](..._0x37df18);}));})),_0x5707f1[_0x51e84b(0x118)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1[_0x51e84b(0x13a)](async _0x5d4485=>{var _0x1297f0=_0x51e84b;_0x5707f1[_0x1297f0(0x118)][_0x5d4485[_0x1297f0(0x16a)]]=[],await Promise[_0x1297f0(0x13e)](_0x5d4485[_0x1297f0(0x153)][_0x1297f0(0x13a)](async _0x3e2fbd=>{var _0x48f430=_0x1297f0;const _0x297206=await transfers['aggregate']([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x3e2fbd['_id'][_0x48f430(0x119)](),'product.To_invoice':_0x3e2fbd['invoice']}},{'$project':{'_id':_0x48f430(0x116),'product_name':_0x48f430(0x144),'product_code':_0x48f430(0x10d),'quantity_available':_0x48f430(0x129),'warehouse_name':_0x48f430(0x148),'warehouse_room':_0x48f430(0x134),'product_invoice':_0x48f430(0x161),'invoice':_0x48f430(0x15d),'id_transaction_from':_0x48f430(0x160),'date':_0x48f430(0x11f),'production_date':_0x48f430(0x113),'expiry_date':'$product.expiry_date','UOM':_0x48f430(0x136)}}]);_0x297206[_0x48f430(0x11a)]>0x0&&_0x5707f1['data_transfer'][_0x5d4485['invoice']][_0x48f430(0x142)](..._0x297206);}));})),_0x49b68c[_0x51e84b(0x15b)]({'purchases_warehouse':_0x5707f1,'data_sales':_0x5707f1[_0x51e84b(0x158)],'data_adjustment':_0x5707f1[_0x51e84b(0x12a)],'data_transfer':_0x5707f1[_0x51e84b(0x118)]});}else{var _0x5707f1=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1d9572,'date':{'$gte':_0x23c41b,'$lte':_0x141e68}}},{'$lookup':{'from':_0x51e84b(0x12d),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x51e84b(0x163)},{'$match':{'$expr':{'$eq':[_0x51e84b(0x147),'$product_details.invoice']}}},{'$project':{'_id':'$product_details._id','product_name':'$product_details.product_name','product_code':_0x51e84b(0x117),'quantity_available':_0x51e84b(0x15a),'warehouse_name':'$name','warehouse_room':_0x51e84b(0x122),'invoice':_0x51e84b(0x16b),'production_date':'$product_details.production_date','expiry_date':_0x51e84b(0x138),'UOM':_0x51e84b(0x127)}}],'as':_0x51e84b(0x153)}}]);_0x5707f1[_0x51e84b(0x158)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1[_0x51e84b(0x13a)](async _0x31427f=>{var _0x2c48ea=_0x51e84b;_0x5707f1[_0x2c48ea(0x158)][_0x31427f[_0x2c48ea(0x16a)]]=[],await Promise['all'](_0x31427f[_0x2c48ea(0x153)][_0x2c48ea(0x13a)](async _0x2593a3=>{var _0xeac5d9=_0x2c48ea;const _0x2c0d34=await sales[_0xeac5d9(0x10e)]([{'$unwind':_0xeac5d9(0x149)},{'$match':{'sale_product.id_transaction_from':_0x2593a3['_id'][_0xeac5d9(0x119)](),'sale_product.invoice':_0x2593a3['invoice']}},{'$project':{'_id':_0xeac5d9(0x14c),'product_name':_0xeac5d9(0x130),'product_code':_0xeac5d9(0x151),'quantity_available':_0xeac5d9(0x15c),'warehouse_name':_0xeac5d9(0x11d),'warehouse_room':_0xeac5d9(0x12f),'product_invoice':_0xeac5d9(0x10c),'invoice':'$invoice','id_transaction_from':_0xeac5d9(0x139),'date':_0xeac5d9(0x11f),'production_date':_0xeac5d9(0x11e),'expiry_date':'$sale_product.expiry_date','UOM':_0xeac5d9(0x166)}}]);_0x2c0d34[_0xeac5d9(0x11a)]>0x0&&_0x5707f1[_0xeac5d9(0x158)][_0x31427f[_0xeac5d9(0x16a)]]['push'](..._0x2c0d34);}));})),_0x5707f1[_0x51e84b(0x158)]=_0x5707f1[_0x51e84b(0x158)],_0x5707f1['data_adjustment']={},await Promise['all'](_0x5707f1[_0x51e84b(0x13a)](async _0x388b14=>{var _0x5f1d0c=_0x51e84b;_0x5707f1['data_adjustment'][_0x388b14[_0x5f1d0c(0x16a)]]=[],await Promise[_0x5f1d0c(0x13e)](_0x388b14[_0x5f1d0c(0x153)]['map'](async _0x13e602=>{var _0x6fd682=_0x5f1d0c;const _0xbda5f5=await adjustment[_0x6fd682(0x10e)]([{'$unwind':_0x6fd682(0x105)},{'$match':{'product.id_transaction_from':_0x13e602[_0x6fd682(0x169)][_0x6fd682(0x119)](),'product.invoice':_0x13e602[_0x6fd682(0x16a)]}},{'$project':{'_id':_0x6fd682(0x116),'product_name':_0x6fd682(0x144),'product_code':'$product.product_code','quantity_available':_0x6fd682(0x123),'warehouse_name':'$warehouse_name','warehouse_room':_0x6fd682(0x134),'product_invoice':_0x6fd682(0x114),'invoice':'$invoice','id_transaction_from':_0x6fd682(0x12e),'date':'$date','production_date':'$product.production_date','expiry_date':_0x6fd682(0x100),'UOM':_0x6fd682(0x136)}}]);_0xbda5f5[_0x6fd682(0x11a)]>0x0&&_0x5707f1[_0x6fd682(0x12a)][_0x388b14[_0x6fd682(0x16a)]][_0x6fd682(0x142)](..._0xbda5f5);}));})),_0x5707f1['data_transfer']={},await Promise['all'](_0x5707f1[_0x51e84b(0x13a)](async _0x4a6dfb=>{var _0x2d457a=_0x51e84b;_0x5707f1[_0x2d457a(0x118)][_0x4a6dfb[_0x2d457a(0x16a)]]=[],await Promise[_0x2d457a(0x13e)](_0x4a6dfb['warehouse_data'][_0x2d457a(0x13a)](async _0x304def=>{var _0x526ac1=_0x2d457a;const _0x34bef3=await transfers[_0x526ac1(0x10e)]([{'$unwind':_0x526ac1(0x105)},{'$match':{'product.id_transaction_id':_0x304def[_0x526ac1(0x169)][_0x526ac1(0x119)](),'product.To_invoice':_0x304def[_0x526ac1(0x16a)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x526ac1(0x148),'warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x526ac1(0x160),'date':_0x526ac1(0x11f),'production_date':'$product.production_date','expiry_date':_0x526ac1(0x100),'UOM':_0x526ac1(0x136)}}]);_0x34bef3[_0x526ac1(0x11a)]>0x0&&_0x5707f1['data_transfer'][_0x4a6dfb[_0x526ac1(0x16a)]][_0x526ac1(0x142)](..._0x34bef3);}));})),_0x49b68c['json']({'purchases_warehouse':_0x5707f1,'data_sales':_0x5707f1[_0x51e84b(0x158)],'data_adjustment':_0x5707f1[_0x51e84b(0x12a)],'data_transfer':_0x5707f1['data_transfer']});}}else{if(_0x1d9572==_0x51e84b(0x13e)){var _0x5707f1=await purchases_finished[_0x51e84b(0x10e)]([{'$match':{'date':{'$gte':_0x23c41b,'$lte':_0x141e68}}},{'$lookup':{'from':_0x51e84b(0x12d),'let':{'invoice':_0x51e84b(0x15d)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x51e84b(0x147),_0x51e84b(0x16b)]}}},{'$project':{'_id':_0x51e84b(0x120),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':_0x51e84b(0x15a),'warehouse_name':'$name','warehouse_room':_0x51e84b(0x122),'invoice':_0x51e84b(0x16b),'production_date':_0x51e84b(0x115),'expiry_date':_0x51e84b(0x138),'UOM':_0x51e84b(0x127)}}],'as':_0x51e84b(0x153)}}]);_0x5707f1[_0x51e84b(0x158)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1[_0x51e84b(0x13a)](async _0x3f6aa7=>{var _0x87e57d=_0x51e84b;_0x5707f1[_0x87e57d(0x158)][_0x3f6aa7[_0x87e57d(0x16a)]]=[],await Promise[_0x87e57d(0x13e)](_0x3f6aa7[_0x87e57d(0x153)]['map'](async _0x57fe88=>{var _0x4569cf=_0x87e57d;const _0x588aab=await sales_finished[_0x4569cf(0x10e)]([{'$unwind':_0x4569cf(0x149)},{'$match':{'sale_product.id_transaction_from':_0x57fe88[_0x4569cf(0x169)][_0x4569cf(0x119)](),'sale_product.invoice':_0x57fe88[_0x4569cf(0x16a)]}},{'$project':{'_id':_0x4569cf(0x14c),'product_name':_0x4569cf(0x130),'product_code':_0x4569cf(0x151),'quantity_available':_0x4569cf(0x15c),'warehouse_name':'$warehouse_name','warehouse_room':_0x4569cf(0x12f),'product_invoice':_0x4569cf(0x10c),'invoice':_0x4569cf(0x15d),'id_transaction_from':_0x4569cf(0x139),'date':'$date','production_date':_0x4569cf(0x11e),'expiry_date':_0x4569cf(0x10f),'UOM':'$sale_product.unit'}}]);_0x588aab[_0x4569cf(0x11a)]>0x0&&_0x5707f1['data_sales'][_0x3f6aa7['invoice']][_0x4569cf(0x142)](..._0x588aab);}));})),_0x5707f1[_0x51e84b(0x158)]=_0x5707f1[_0x51e84b(0x158)],_0x5707f1[_0x51e84b(0x12a)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1['map'](async _0x4dc08a=>{var _0x2e81ff=_0x51e84b;_0x5707f1['data_adjustment'][_0x4dc08a[_0x2e81ff(0x16a)]]=[],await Promise[_0x2e81ff(0x13e)](_0x4dc08a['warehouse_data'][_0x2e81ff(0x13a)](async _0xc74f9c=>{var _0x9518f2=_0x2e81ff;const _0x58b30e=await adjustment_finished[_0x9518f2(0x10e)]([{'$unwind':_0x9518f2(0x105)},{'$match':{'product.id_transaction_from':_0xc74f9c[_0x9518f2(0x169)]['valueOf'](),'product.invoice':_0xc74f9c[_0x9518f2(0x16a)]}},{'$project':{'_id':_0x9518f2(0x116),'product_name':_0x9518f2(0x144),'product_code':_0x9518f2(0x10d),'quantity_available':_0x9518f2(0x123),'warehouse_name':_0x9518f2(0x11d),'warehouse_room':_0x9518f2(0x134),'product_invoice':_0x9518f2(0x114),'invoice':_0x9518f2(0x15d),'id_transaction_from':'$product.id_transaction_from','date':_0x9518f2(0x11f),'production_date':_0x9518f2(0x113),'expiry_date':_0x9518f2(0x100),'UOM':'$product.unit'}}]);_0x58b30e['length']>0x0&&_0x5707f1[_0x9518f2(0x12a)][_0x4dc08a[_0x9518f2(0x16a)]][_0x9518f2(0x142)](..._0x58b30e);}));})),_0x5707f1[_0x51e84b(0x118)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1[_0x51e84b(0x13a)](async _0x27e901=>{var _0x3722dc=_0x51e84b;_0x5707f1[_0x3722dc(0x118)][_0x27e901['invoice']]=[],await Promise['all'](_0x27e901[_0x3722dc(0x153)][_0x3722dc(0x13a)](async _0x529dc8=>{var _0x386491=_0x3722dc;const _0x15477b=await transfers_finished[_0x386491(0x10e)]([{'$unwind':_0x386491(0x105)},{'$match':{'product.id_transaction':_0x529dc8[_0x386491(0x169)][_0x386491(0x119)](),'product.from_invoice':_0x529dc8[_0x386491(0x16a)]}},{'$project':{'_id':_0x386491(0x116),'product_name':'$product.product_name','product_code':_0x386491(0x10d),'quantity_available':'$product.to_quantity','warehouse_name':_0x386491(0x148),'warehouse_room':_0x386491(0x134),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x386491(0x101),'date':_0x386491(0x11f),'production_date':_0x386491(0x113),'expiry_date':_0x386491(0x100),'UOM':_0x386491(0x136)}}]);_0x15477b[_0x386491(0x11a)]>0x0&&_0x5707f1[_0x386491(0x118)][_0x27e901[_0x386491(0x16a)]][_0x386491(0x142)](..._0x15477b);}));})),_0x49b68c['json']({'purchases_warehouse':_0x5707f1,'data_sales':_0x5707f1['data_sales'],'data_adjustment':_0x5707f1[_0x51e84b(0x12a)],'data_transfer':_0x5707f1[_0x51e84b(0x118)]});}else{var _0x5707f1=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x1d9572,'date':{'$gte':_0x23c41b,'$lte':_0x141e68}}},{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x51e84b(0x147),_0x51e84b(0x16b)]}}},{'$project':{'_id':_0x51e84b(0x120),'product_name':_0x51e84b(0x12c),'product_code':_0x51e84b(0x117),'quantity_available':'$product_details.product_stock','warehouse_name':_0x51e84b(0x164),'warehouse_room':_0x51e84b(0x122),'invoice':'$product_details.invoice','production_date':_0x51e84b(0x115),'expiry_date':_0x51e84b(0x138),'UOM':_0x51e84b(0x127)}}],'as':_0x51e84b(0x153)}}]);_0x5707f1['data_sales']={},await Promise['all'](_0x5707f1[_0x51e84b(0x13a)](async _0x54a8f3=>{var _0xf73a53=_0x51e84b;_0x5707f1[_0xf73a53(0x158)][_0x54a8f3[_0xf73a53(0x16a)]]=[],await Promise[_0xf73a53(0x13e)](_0x54a8f3['warehouse_data'][_0xf73a53(0x13a)](async _0x4d0f37=>{var _0x5db4f1=_0xf73a53;const _0xe9a4d0=await sales_finished[_0x5db4f1(0x10e)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x4d0f37[_0x5db4f1(0x169)][_0x5db4f1(0x119)](),'sale_product.invoice':_0x4d0f37[_0x5db4f1(0x16a)]}},{'$project':{'_id':_0x5db4f1(0x14c),'product_name':_0x5db4f1(0x130),'product_code':_0x5db4f1(0x151),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x5db4f1(0x12f),'product_invoice':_0x5db4f1(0x10c),'invoice':_0x5db4f1(0x15d),'id_transaction_from':_0x5db4f1(0x139),'date':_0x5db4f1(0x11f),'production_date':_0x5db4f1(0x11e),'expiry_date':_0x5db4f1(0x10f),'UOM':_0x5db4f1(0x166)}}]);_0xe9a4d0[_0x5db4f1(0x11a)]>0x0&&_0x5707f1[_0x5db4f1(0x158)][_0x54a8f3[_0x5db4f1(0x16a)]][_0x5db4f1(0x142)](..._0xe9a4d0);}));})),_0x5707f1['data_sales']=_0x5707f1[_0x51e84b(0x158)],_0x5707f1[_0x51e84b(0x12a)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1['map'](async _0x563e17=>{var _0x910f63=_0x51e84b;_0x5707f1['data_adjustment'][_0x563e17[_0x910f63(0x16a)]]=[],await Promise[_0x910f63(0x13e)](_0x563e17[_0x910f63(0x153)][_0x910f63(0x13a)](async _0x43aa9a=>{var _0x4bd6f4=_0x910f63;const _0x50bfab=await adjustment_finished[_0x4bd6f4(0x10e)]([{'$unwind':_0x4bd6f4(0x105)},{'$match':{'product.id_transaction_from':_0x43aa9a[_0x4bd6f4(0x169)][_0x4bd6f4(0x119)](),'product.invoice':_0x43aa9a['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x4bd6f4(0x144),'product_code':_0x4bd6f4(0x10d),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x4bd6f4(0x11d),'warehouse_room':_0x4bd6f4(0x134),'product_invoice':_0x4bd6f4(0x114),'invoice':_0x4bd6f4(0x15d),'id_transaction_from':_0x4bd6f4(0x12e),'date':_0x4bd6f4(0x11f),'production_date':_0x4bd6f4(0x113),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x50bfab[_0x4bd6f4(0x11a)]>0x0&&_0x5707f1[_0x4bd6f4(0x12a)][_0x563e17[_0x4bd6f4(0x16a)]]['push'](..._0x50bfab);}));})),_0x5707f1[_0x51e84b(0x118)]={},await Promise[_0x51e84b(0x13e)](_0x5707f1[_0x51e84b(0x13a)](async _0x39628e=>{var _0xbd49a4=_0x51e84b;_0x5707f1[_0xbd49a4(0x118)][_0x39628e[_0xbd49a4(0x16a)]]=[],await Promise['all'](_0x39628e[_0xbd49a4(0x153)][_0xbd49a4(0x13a)](async _0x7e8600=>{var _0x524924=_0xbd49a4;const _0x446d77=await transfers_finished[_0x524924(0x10e)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x7e8600[_0x524924(0x169)][_0x524924(0x119)](),'product.from_invoice':_0x7e8600[_0x524924(0x16a)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x524924(0x10d),'quantity_available':_0x524924(0x129),'warehouse_name':'$to_warehouse','warehouse_room':_0x524924(0x134),'product_invoice':_0x524924(0x161),'invoice':_0x524924(0x15d),'id_transaction_from':_0x524924(0x101),'date':_0x524924(0x11f),'production_date':_0x524924(0x113),'expiry_date':_0x524924(0x100),'UOM':_0x524924(0x136)}}]);_0x446d77[_0x524924(0x11a)]>0x0&&_0x5707f1[_0x524924(0x118)][_0x39628e[_0x524924(0x16a)]][_0x524924(0x142)](..._0x446d77);}));})),_0x49b68c[_0x51e84b(0x15b)]({'purchases_warehouse':_0x5707f1,'data_sales':_0x5707f1['data_sales'],'data_adjustment':_0x5707f1[_0x51e84b(0x12a)],'data_transfer':_0x5707f1[_0x51e84b(0x118)]});}}}),router['get'](a0_0x3ba2ca(0x135),auth,async(_0xefca53,_0x4a86ab)=>{var _0x322157=a0_0x3ba2ca;try{const _0x2f5e39=_0xefca53[_0x322157(0x133)]['id'];var _0x2c7474=await purchases_finished[_0x322157(0x141)](_0x2f5e39);const _0x1cfd61=await master_shop[_0x322157(0x150)](),_0x33b0da=_0xefca53[_0x322157(0x146)],_0x71a1d3=await profile[_0x322157(0x143)]({'email':_0x33b0da[_0x322157(0x15f)]});if(_0x1cfd61[0x0][_0x322157(0x15e)]==_0x322157(0x12b))var _0x377739=users[_0x322157(0x112)];else{if(_0x1cfd61[0x0][_0x322157(0x15e)]==_0x322157(0x102))var _0x377739=users[_0x322157(0x102)];else{if(_0x1cfd61[0x0][_0x322157(0x15e)]=='German')var _0x377739=users[_0x322157(0x124)];else{if(_0x1cfd61[0x0][_0x322157(0x15e)]==_0x322157(0x14f))var _0x377739=users[_0x322157(0x14f)];else{if(_0x1cfd61[0x0][_0x322157(0x15e)]=='French')var _0x377739=users[_0x322157(0x145)];else{if(_0x1cfd61[0x0][_0x322157(0x15e)]==_0x322157(0x109))var _0x377739=users[_0x322157(0x107)];else{if(_0x1cfd61[0x0][_0x322157(0x15e)]=='Chinese')var _0x377739=users[_0x322157(0x128)];else{if(_0x1cfd61[0x0][_0x322157(0x15e)]==_0x322157(0x11b))var _0x377739=users[_0x322157(0x152)];}}}}}}}_0x4a86ab['render'](_0x322157(0x157),{'success':_0xefca53[_0x322157(0x132)](_0x322157(0x14d)),'errors':_0xefca53[_0x322157(0x132)](_0x322157(0x13c)),'master_shop':_0x1cfd61,'profile':_0x71a1d3,'role':_0x33b0da,'language':_0x377739,'data':_0x2c7474});}catch(_0x4e8c96){_0x4a86ab[_0x322157(0x15b)](_0x4e8c96);}}),router[a0_0x3ba2ca(0x140)](a0_0x3ba2ca(0x155),auth,async(_0x54b264,_0x3ff226)=>{var _0x160973=a0_0x3ba2ca;try{const _0x58d3dd=_0x54b264[_0x160973(0x133)]['id'];var _0x24cb7f=await sales_finished[_0x160973(0x141)](_0x58d3dd);const _0x154acf=await master_shop[_0x160973(0x150)](),_0x349563=_0x54b264['user'],_0x4a5539=await profile[_0x160973(0x143)]({'email':_0x349563['email']});if(_0x154acf[0x0][_0x160973(0x15e)]==_0x160973(0x12b))var _0x32306b=users[_0x160973(0x112)];else{if(_0x154acf[0x0][_0x160973(0x15e)]==_0x160973(0x102))var _0x32306b=users[_0x160973(0x102)];else{if(_0x154acf[0x0]['language']==_0x160973(0x124))var _0x32306b=users[_0x160973(0x124)];else{if(_0x154acf[0x0]['language']==_0x160973(0x14f))var _0x32306b=users[_0x160973(0x14f)];else{if(_0x154acf[0x0][_0x160973(0x15e)]==_0x160973(0x145))var _0x32306b=users['French'];else{if(_0x154acf[0x0]['language']=='Portuguese\x20(BR)')var _0x32306b=users[_0x160973(0x107)];else{if(_0x154acf[0x0]['language']==_0x160973(0x128))var _0x32306b=users[_0x160973(0x128)];else{if(_0x154acf[0x0][_0x160973(0x15e)]==_0x160973(0x11b))var _0x32306b=users['Arabic'];}}}}}}}_0x3ff226[_0x160973(0xff)](_0x160973(0x167),{'success':_0x54b264[_0x160973(0x132)](_0x160973(0x14d)),'errors':_0x54b264[_0x160973(0x132)](_0x160973(0x13c)),'master_shop':_0x154acf,'profile':_0x4a5539,'role':_0x349563,'language':_0x32306b,'data':_0x24cb7f});}catch(_0x32ad6d){_0x3ff226[_0x160973(0x15b)](_0x32ad6d);}}),router['get']('/viewdata_tf_fg/:id',auth,async(_0x157ac4,_0x524fe6)=>{var _0x325b86=a0_0x3ba2ca;try{const _0x5a5a10=_0x157ac4[_0x325b86(0x133)]['id'];var _0x27ec2d=await transfers_finished[_0x325b86(0x141)](_0x5a5a10);const _0x561f8a=await master_shop[_0x325b86(0x150)](),_0x25b150=_0x157ac4[_0x325b86(0x146)],_0x3e5237=await profile['findOne']({'email':_0x25b150['email']});if(_0x561f8a[0x0][_0x325b86(0x15e)]==_0x325b86(0x12b))var _0x3b222e=users[_0x325b86(0x112)];else{if(_0x561f8a[0x0][_0x325b86(0x15e)]==_0x325b86(0x102))var _0x3b222e=users['Hindi'];else{if(_0x561f8a[0x0][_0x325b86(0x15e)]=='German')var _0x3b222e=users[_0x325b86(0x124)];else{if(_0x561f8a[0x0][_0x325b86(0x15e)]==_0x325b86(0x14f))var _0x3b222e=users[_0x325b86(0x14f)];else{if(_0x561f8a[0x0][_0x325b86(0x15e)]==_0x325b86(0x145))var _0x3b222e=users[_0x325b86(0x145)];else{if(_0x561f8a[0x0][_0x325b86(0x15e)]=='Portuguese\x20(BR)')var _0x3b222e=users[_0x325b86(0x107)];else{if(_0x561f8a[0x0][_0x325b86(0x15e)]=='Chinese')var _0x3b222e=users[_0x325b86(0x128)];else{if(_0x561f8a[0x0][_0x325b86(0x15e)]==_0x325b86(0x11b))var _0x3b222e=users[_0x325b86(0x152)];}}}}}}}_0x524fe6['render'](_0x325b86(0x14a),{'success':_0x157ac4[_0x325b86(0x132)](_0x325b86(0x14d)),'errors':_0x157ac4[_0x325b86(0x132)]('errors'),'master_shop':_0x561f8a,'profile':_0x3e5237,'role':_0x25b150,'language':_0x3b222e,'data':_0x27ec2d});}catch(_0x55098b){_0x524fe6[_0x325b86(0x15b)](_0x55098b);}}),router[a0_0x3ba2ca(0x140)]('/viewFG',auth,async(_0x4b2bd6,_0x6266f7)=>{var _0xa009a3=a0_0x3ba2ca;try{const {username:_0x11405c,email:_0x11dbfd,role:_0x15f5f1}=_0x4b2bd6[_0xa009a3(0x146)],_0xfbe156=_0x4b2bd6[_0xa009a3(0x146)],_0x38fc42=await profile[_0xa009a3(0x143)]({'email':_0xfbe156[_0xa009a3(0x15f)]}),_0xe02c54=await master_shop[_0xa009a3(0x150)](),_0xafe09d=await warehouse[_0xa009a3(0x10e)]([{'$match':{'status':_0xa009a3(0x137),'warehouse_category':_0xa009a3(0x126)}},{'$group':{'_id':_0xa009a3(0x164),'name':{'$first':_0xa009a3(0x164)}}}]);if(_0xe02c54[0x0]['language']==_0xa009a3(0x12b))var _0x35e3af=users[_0xa009a3(0x112)];else{if(_0xe02c54[0x0][_0xa009a3(0x15e)]=='Hindi')var _0x35e3af=users[_0xa009a3(0x102)];else{if(_0xe02c54[0x0][_0xa009a3(0x15e)]==_0xa009a3(0x124))var _0x35e3af=users[_0xa009a3(0x124)];else{if(_0xe02c54[0x0][_0xa009a3(0x15e)]==_0xa009a3(0x14f))var _0x35e3af=users['Spanish'];else{if(_0xe02c54[0x0][_0xa009a3(0x15e)]==_0xa009a3(0x145))var _0x35e3af=users[_0xa009a3(0x145)];else{if(_0xe02c54[0x0]['language']==_0xa009a3(0x109))var _0x35e3af=users['Portuguese'];else{if(_0xe02c54[0x0][_0xa009a3(0x15e)]=='Chinese')var _0x35e3af=users[_0xa009a3(0x128)];else{if(_0xe02c54[0x0][_0xa009a3(0x15e)]=='Arabic\x20(ae)')var _0x35e3af=users[_0xa009a3(0x152)];}}}}}}}_0x6266f7['render'](_0xa009a3(0x104),{'success':_0x4b2bd6['flash'](_0xa009a3(0x14d)),'errors':_0x4b2bd6['flash'](_0xa009a3(0x13c)),'role':_0xfbe156,'profile':_0x38fc42,'master_shop':_0xe02c54,'dataProcess':_0xafe09d,'language':_0x35e3af});}catch(_0x41aa49){console['log'](_0x41aa49);}}),module[a0_0x3ba2ca(0x10b)]=router;