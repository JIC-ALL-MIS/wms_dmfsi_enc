function a0_0x5207(){var _0xe57b18=['$product.unit','$sale_product.production_date','559WlrUSH','$sale_product.room_name','params','$name','$product.product_name','Portuguese','$product_details.product_code','$product_details','/reports','$sale_product.product_code','$product.production_date','view_table','all','$product_details.invoice','German','Spanish','find','210060CZaJkH','$product_details.expiry_date','../public/language/languages.json','Arabic','$product.id_transaction','../middleware/auth','English','390400GqKSpc','$product_details.product_name','length','5257860gDJjGE','data_sales','data_transfer','195965YMsiGx','errors','$sale_product.expiry_date','Chinese','$room','invoice','view_og_table','language','517JBSWOA','8vDDxUZ','$product.product_code','json','$product_details.product_stock','4048776SSSQRX','$invoice','../models/all_models','express','Portuguese\x20(BR)','$product_details.production_date','$date','$product_details._id','Router','valueOf','$product.new_adjust_qty','$product_details.unit','French','Arabic\x20(ae)','success','render','$sale_product.id_transaction_from','$product','$product.invoice','$sale_product._id','Hindi','$sale_product.product_name','get','$sale_product.invoice','$sale_product.unit','Raw\x20Materials','data_adjustment','$$invoice','user','log','$product._id','post','email','$product.expiry_date','push','findOne','findById','4938UufzXn','$sale_product.quantity','body','map','$warehouse_name','$to_warehouse','86tCJPUf','$sale_product','$product.to_quantity','nodemailer','/viewdata_inc_fg/:id','575RGhvFy','English\x20(US)','warehouses','$product.id_transaction_id','flash','Finished\x20Goods','exports','$product.room_names','$product.id_transaction_from','aggregate','_id','$product.to_room_name','warehouse_data'];a0_0x5207=function(){return _0xe57b18;};return a0_0x5207();}var a0_0x365ea1=a0_0x1eee;(function(_0x5e448c,_0x10d9fa){var _0x260f33=a0_0x1eee,_0x2289e0=_0x5e448c();while(!![]){try{var _0x47a12d=-parseInt(_0x260f33(0x1db))/0x1*(parseInt(_0x260f33(0x1c7))/0x2)+parseInt(_0x260f33(0x19c))/0x3+parseInt(_0x260f33(0x1f6))/0x4+-parseInt(_0x260f33(0x1cc))/0x5*(parseInt(_0x260f33(0x1c1))/0x6)+parseInt(_0x260f33(0x18f))/0x7*(parseInt(_0x260f33(0x198))/0x8)+-parseInt(_0x260f33(0x1ec))/0x9+parseInt(_0x260f33(0x1f3))/0xa*(-parseInt(_0x260f33(0x197))/0xb);if(_0x47a12d===_0x10d9fa)break;else _0x2289e0['push'](_0x2289e0['shift']());}catch(_0x4d901b){_0x2289e0['push'](_0x2289e0['shift']());}}}(a0_0x5207,0xae98e));const express=require(a0_0x365ea1(0x19f)),app=express(),router=express[a0_0x365ea1(0x1a4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x365ea1(0x19e)),auth=require(a0_0x365ea1(0x1f1)),users=require(a0_0x365ea1(0x1ee)),nodemailer=require(a0_0x365ea1(0x1ca));function a0_0x1eee(_0x14d916,_0x49c3bc){var _0x520783=a0_0x5207();return a0_0x1eee=function(_0x1eee76,_0x5824bd){_0x1eee76=_0x1eee76-0x18e;var _0x45c3be=_0x520783[_0x1eee76];return _0x45c3be;},a0_0x1eee(_0x14d916,_0x49c3bc);}router[a0_0x365ea1(0x1b2)]('/view',auth,async(_0x29ad06,_0x903b94)=>{var _0x11e9ff=a0_0x365ea1;try{const {username:_0x3103e4,email:_0x255b06,role:_0x5b0c06}=_0x29ad06[_0x11e9ff(0x1b8)],_0x5d48b2=_0x29ad06['user'],_0x2822a7=await profile[_0x11e9ff(0x1bf)]({'email':_0x5d48b2[_0x11e9ff(0x1bc)]}),_0x22fe05=await master_shop[_0x11e9ff(0x1eb)](),_0x396329=await warehouse[_0x11e9ff(0x1d5)]([{'$match':{'status':'Enabled','warehouse_category':_0x11e9ff(0x1d1)}},{'$group':{'_id':_0x11e9ff(0x1de),'name':{'$first':_0x11e9ff(0x1de)}}}]);if(_0x22fe05[0x0]['language']=='English\x20(US)')var _0x325312=users[_0x11e9ff(0x1f2)];else{if(_0x22fe05[0x0]['language']==_0x11e9ff(0x1b0))var _0x325312=users[_0x11e9ff(0x1b0)];else{if(_0x22fe05[0x0][_0x11e9ff(0x196)]==_0x11e9ff(0x1e9))var _0x325312=users[_0x11e9ff(0x1e9)];else{if(_0x22fe05[0x0][_0x11e9ff(0x196)]==_0x11e9ff(0x1ea))var _0x325312=users[_0x11e9ff(0x1ea)];else{if(_0x22fe05[0x0][_0x11e9ff(0x196)]==_0x11e9ff(0x1a8))var _0x325312=users[_0x11e9ff(0x1a8)];else{if(_0x22fe05[0x0][_0x11e9ff(0x196)]==_0x11e9ff(0x1a0))var _0x325312=users['Portuguese'];else{if(_0x22fe05[0x0]['language']==_0x11e9ff(0x192))var _0x325312=users[_0x11e9ff(0x192)];else{if(_0x22fe05[0x0][_0x11e9ff(0x196)]=='Arabic\x20(ae)')var _0x325312=users[_0x11e9ff(0x1ef)];}}}}}}}_0x903b94[_0x11e9ff(0x1ab)]('transaction_finished',{'success':_0x29ad06[_0x11e9ff(0x1d0)](_0x11e9ff(0x1aa)),'errors':_0x29ad06[_0x11e9ff(0x1d0)](_0x11e9ff(0x190)),'role':_0x5d48b2,'profile':_0x2822a7,'master_shop':_0x22fe05,'dataProcess':_0x396329,'language':_0x325312});}catch(_0x56e337){console[_0x11e9ff(0x1b9)](_0x56e337);}}),router[a0_0x365ea1(0x1bb)](a0_0x365ea1(0x1e3),auth,async(_0x3dc2e8,_0x5e5387)=>{var _0xa962b7=a0_0x365ea1;const {product_category:_0x49ecca,transaction_category:_0xfc0b2f,transaction_date_from:_0x54fa49,transaction_date_to:_0x4f91e7,warehouse_category:_0x11e273,item_code:_0x412a6b}=_0x3dc2e8[_0xa962b7(0x1c3)];console[_0xa962b7(0x1b9)](_0x11e273);if(_0x49ecca=='rm'){if(_0x11e273==_0xa962b7(0x1e7)){var _0x1c93f4=await purchases[_0xa962b7(0x1d5)]([{'$match':{'date':{'$gte':_0x54fa49,'$lte':_0x4f91e7}}},{'$lookup':{'from':_0xa962b7(0x1ce),'let':{'invoice':_0xa962b7(0x19d)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0xa962b7(0x1b7),_0xa962b7(0x1e8)]}}},{'$project':{'_id':'$product_details._id','product_name':_0xa962b7(0x1f4),'product_code':'$product_details.product_code','quantity_available':_0xa962b7(0x19b),'warehouse_name':_0xa962b7(0x1de),'warehouse_room':_0xa962b7(0x193),'invoice':_0xa962b7(0x1e8),'production_date':'$product_details.production_date','expiry_date':_0xa962b7(0x1ed),'UOM':_0xa962b7(0x1a7)}}],'as':_0xa962b7(0x1d8)}}]);_0x1c93f4[_0xa962b7(0x1f7)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4[_0xa962b7(0x1c4)](async _0x4ef5be=>{var _0x41c28d=_0xa962b7;_0x1c93f4[_0x41c28d(0x1f7)][_0x4ef5be[_0x41c28d(0x194)]]=[],await Promise[_0x41c28d(0x1e7)](_0x4ef5be[_0x41c28d(0x1d8)][_0x41c28d(0x1c4)](async _0x17b5c1=>{var _0x2e3bde=_0x41c28d;const _0xd00706=await sales[_0x2e3bde(0x1d5)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x17b5c1[_0x2e3bde(0x1d6)][_0x2e3bde(0x1a5)](),'sale_product.invoice':_0x17b5c1[_0x2e3bde(0x194)]}},{'$project':{'_id':_0x2e3bde(0x1af),'product_name':_0x2e3bde(0x1b1),'product_code':_0x2e3bde(0x1e4),'quantity_available':_0x2e3bde(0x1c2),'warehouse_name':_0x2e3bde(0x1c5),'warehouse_room':'$sale_product.room_name','product_invoice':_0x2e3bde(0x1b3),'invoice':'$invoice','id_transaction_from':_0x2e3bde(0x1ac),'date':_0x2e3bde(0x1a2),'production_date':_0x2e3bde(0x1da),'expiry_date':_0x2e3bde(0x191),'UOM':_0x2e3bde(0x1b4)}}]);_0xd00706['length']>0x0&&_0x1c93f4[_0x2e3bde(0x1f7)][_0x4ef5be[_0x2e3bde(0x194)]]['push'](..._0xd00706);}));})),_0x1c93f4[_0xa962b7(0x1f7)]=_0x1c93f4[_0xa962b7(0x1f7)],_0x1c93f4['data_adjustment']={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4[_0xa962b7(0x1c4)](async _0x52cd76=>{var _0x3567e4=_0xa962b7;_0x1c93f4[_0x3567e4(0x1b6)][_0x52cd76[_0x3567e4(0x194)]]=[],await Promise[_0x3567e4(0x1e7)](_0x52cd76[_0x3567e4(0x1d8)][_0x3567e4(0x1c4)](async _0x4ebbb5=>{var _0x462ab7=_0x3567e4;const _0x2b2332=await adjustment[_0x462ab7(0x1d5)]([{'$unwind':_0x462ab7(0x1ad)},{'$match':{'product.id_transaction_from':_0x4ebbb5[_0x462ab7(0x1d6)][_0x462ab7(0x1a5)](),'product.invoice':_0x4ebbb5[_0x462ab7(0x194)]}},{'$project':{'_id':'$product._id','product_name':_0x462ab7(0x1df),'product_code':_0x462ab7(0x199),'quantity_available':_0x462ab7(0x1a6),'warehouse_name':_0x462ab7(0x1c5),'warehouse_room':_0x462ab7(0x1d3),'product_invoice':_0x462ab7(0x1ae),'invoice':_0x462ab7(0x19d),'id_transaction_from':_0x462ab7(0x1d4),'date':_0x462ab7(0x1a2),'production_date':_0x462ab7(0x1e5),'expiry_date':_0x462ab7(0x1bd),'UOM':_0x462ab7(0x1d9)}}]);_0x2b2332[_0x462ab7(0x1f5)]>0x0&&_0x1c93f4[_0x462ab7(0x1b6)][_0x52cd76[_0x462ab7(0x194)]][_0x462ab7(0x1be)](..._0x2b2332);}));})),_0x1c93f4[_0xa962b7(0x18e)]={},await Promise['all'](_0x1c93f4[_0xa962b7(0x1c4)](async _0x118101=>{var _0x133087=_0xa962b7;_0x1c93f4[_0x133087(0x18e)][_0x118101[_0x133087(0x194)]]=[],await Promise[_0x133087(0x1e7)](_0x118101['warehouse_data'][_0x133087(0x1c4)](async _0x3c731=>{var _0x13ce8b=_0x133087;const _0x25563e=await transfers[_0x13ce8b(0x1d5)]([{'$unwind':_0x13ce8b(0x1ad)},{'$match':{'product.id_transaction_id':_0x3c731[_0x13ce8b(0x1d6)][_0x13ce8b(0x1a5)](),'product.To_invoice':_0x3c731[_0x13ce8b(0x194)]}},{'$project':{'_id':_0x13ce8b(0x1ba),'product_name':_0x13ce8b(0x1df),'product_code':'$product.product_code','quantity_available':_0x13ce8b(0x1c9),'warehouse_name':_0x13ce8b(0x1c6),'warehouse_room':_0x13ce8b(0x1d3),'product_invoice':_0x13ce8b(0x1d7),'invoice':_0x13ce8b(0x19d),'id_transaction_from':_0x13ce8b(0x1cf),'date':_0x13ce8b(0x1a2),'production_date':'$product.production_date','expiry_date':_0x13ce8b(0x1bd),'UOM':'$product.unit'}}]);_0x25563e[_0x13ce8b(0x1f5)]>0x0&&_0x1c93f4[_0x13ce8b(0x18e)][_0x118101['invoice']][_0x13ce8b(0x1be)](..._0x25563e);}));})),_0x5e5387[_0xa962b7(0x19a)]({'purchases_warehouse':_0x1c93f4,'data_sales':_0x1c93f4[_0xa962b7(0x1f7)],'data_adjustment':_0x1c93f4[_0xa962b7(0x1b6)],'data_transfer':_0x1c93f4[_0xa962b7(0x18e)]});}else{var _0x1c93f4=await purchases[_0xa962b7(0x1d5)]([{'$match':{'warehouse_name':_0x11e273,'date':{'$gte':_0x54fa49,'$lte':_0x4f91e7}}},{'$lookup':{'from':_0xa962b7(0x1ce),'let':{'invoice':_0xa962b7(0x19d)},'pipeline':[{'$unwind':_0xa962b7(0x1e2)},{'$match':{'$expr':{'$eq':[_0xa962b7(0x1b7),_0xa962b7(0x1e8)]}}},{'$project':{'_id':_0xa962b7(0x1a3),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':_0xa962b7(0x19b),'warehouse_name':'$name','warehouse_room':_0xa962b7(0x193),'invoice':_0xa962b7(0x1e8),'production_date':_0xa962b7(0x1a1),'expiry_date':_0xa962b7(0x1ed),'UOM':_0xa962b7(0x1a7)}}],'as':_0xa962b7(0x1d8)}}]);_0x1c93f4[_0xa962b7(0x1f7)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4['map'](async _0x4ed843=>{var _0x2b1fd3=_0xa962b7;_0x1c93f4[_0x2b1fd3(0x1f7)][_0x4ed843['invoice']]=[],await Promise[_0x2b1fd3(0x1e7)](_0x4ed843['warehouse_data']['map'](async _0x3e7862=>{var _0x40d5ca=_0x2b1fd3;const _0x740a39=await sales[_0x40d5ca(0x1d5)]([{'$unwind':_0x40d5ca(0x1c8)},{'$match':{'sale_product.id_transaction_from':_0x3e7862[_0x40d5ca(0x1d6)][_0x40d5ca(0x1a5)](),'sale_product.invoice':_0x3e7862[_0x40d5ca(0x194)]}},{'$project':{'_id':_0x40d5ca(0x1af),'product_name':'$sale_product.product_name','product_code':_0x40d5ca(0x1e4),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x40d5ca(0x1dc),'product_invoice':_0x40d5ca(0x1b3),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':'$date','production_date':_0x40d5ca(0x1da),'expiry_date':_0x40d5ca(0x191),'UOM':'$sale_product.unit'}}]);_0x740a39[_0x40d5ca(0x1f5)]>0x0&&_0x1c93f4[_0x40d5ca(0x1f7)][_0x4ed843[_0x40d5ca(0x194)]][_0x40d5ca(0x1be)](..._0x740a39);}));})),_0x1c93f4[_0xa962b7(0x1f7)]=_0x1c93f4[_0xa962b7(0x1f7)],_0x1c93f4[_0xa962b7(0x1b6)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4['map'](async _0x35d4c3=>{var _0x278862=_0xa962b7;_0x1c93f4['data_adjustment'][_0x35d4c3[_0x278862(0x194)]]=[],await Promise[_0x278862(0x1e7)](_0x35d4c3[_0x278862(0x1d8)][_0x278862(0x1c4)](async _0x361ba6=>{var _0x27db6b=_0x278862;const _0x5d8c52=await adjustment[_0x27db6b(0x1d5)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x361ba6[_0x27db6b(0x1d6)][_0x27db6b(0x1a5)](),'product.invoice':_0x361ba6['invoice']}},{'$project':{'_id':_0x27db6b(0x1ba),'product_name':_0x27db6b(0x1df),'product_code':_0x27db6b(0x199),'quantity_available':_0x27db6b(0x1a6),'warehouse_name':_0x27db6b(0x1c5),'warehouse_room':_0x27db6b(0x1d3),'product_invoice':'$product.invoice','invoice':_0x27db6b(0x19d),'id_transaction_from':'$product.id_transaction_from','date':_0x27db6b(0x1a2),'production_date':_0x27db6b(0x1e5),'expiry_date':_0x27db6b(0x1bd),'UOM':_0x27db6b(0x1d9)}}]);_0x5d8c52[_0x27db6b(0x1f5)]>0x0&&_0x1c93f4[_0x27db6b(0x1b6)][_0x35d4c3['invoice']][_0x27db6b(0x1be)](..._0x5d8c52);}));})),_0x1c93f4[_0xa962b7(0x18e)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4['map'](async _0x52cf4f=>{var _0x4d929a=_0xa962b7;_0x1c93f4[_0x4d929a(0x18e)][_0x52cf4f[_0x4d929a(0x194)]]=[],await Promise[_0x4d929a(0x1e7)](_0x52cf4f['warehouse_data'][_0x4d929a(0x1c4)](async _0x1c1bbb=>{var _0x4428b1=_0x4d929a;const _0x2ae19a=await transfers[_0x4428b1(0x1d5)]([{'$unwind':_0x4428b1(0x1ad)},{'$match':{'product.id_transaction_id':_0x1c1bbb[_0x4428b1(0x1d6)][_0x4428b1(0x1a5)](),'product.To_invoice':_0x1c1bbb['invoice']}},{'$project':{'_id':_0x4428b1(0x1ba),'product_name':_0x4428b1(0x1df),'product_code':_0x4428b1(0x199),'quantity_available':_0x4428b1(0x1c9),'warehouse_name':_0x4428b1(0x1c6),'warehouse_room':_0x4428b1(0x1d3),'product_invoice':_0x4428b1(0x1d7),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_id','date':_0x4428b1(0x1a2),'production_date':_0x4428b1(0x1e5),'expiry_date':_0x4428b1(0x1bd),'UOM':_0x4428b1(0x1d9)}}]);_0x2ae19a[_0x4428b1(0x1f5)]>0x0&&_0x1c93f4['data_transfer'][_0x52cf4f[_0x4428b1(0x194)]]['push'](..._0x2ae19a);}));})),_0x5e5387[_0xa962b7(0x19a)]({'purchases_warehouse':_0x1c93f4,'data_sales':_0x1c93f4[_0xa962b7(0x1f7)],'data_adjustment':_0x1c93f4['data_adjustment'],'data_transfer':_0x1c93f4[_0xa962b7(0x18e)]});}}else{if(_0x11e273=='all'){var _0x1c93f4=await purchases_finished[_0xa962b7(0x1d5)]([{'$match':{'date':{'$gte':_0x54fa49,'$lte':_0x4f91e7}}},{'$lookup':{'from':_0xa962b7(0x1ce),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0xa962b7(0x1e2)},{'$match':{'$expr':{'$eq':[_0xa962b7(0x1b7),_0xa962b7(0x1e8)]}}},{'$project':{'_id':'$product_details._id','product_name':'$product_details.product_name','product_code':_0xa962b7(0x1e1),'quantity_available':_0xa962b7(0x19b),'warehouse_name':_0xa962b7(0x1de),'warehouse_room':_0xa962b7(0x193),'invoice':_0xa962b7(0x1e8),'production_date':'$product_details.production_date','expiry_date':_0xa962b7(0x1ed),'UOM':'$product_details.unit'}}],'as':_0xa962b7(0x1d8)}}]);_0x1c93f4[_0xa962b7(0x1f7)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4[_0xa962b7(0x1c4)](async _0x2a7e3d=>{var _0x4bc4f8=_0xa962b7;_0x1c93f4[_0x4bc4f8(0x1f7)][_0x2a7e3d[_0x4bc4f8(0x194)]]=[],await Promise[_0x4bc4f8(0x1e7)](_0x2a7e3d['warehouse_data'][_0x4bc4f8(0x1c4)](async _0x1d653c=>{var _0x5623ba=_0x4bc4f8;const _0x2e91d5=await sales_finished[_0x5623ba(0x1d5)]([{'$unwind':_0x5623ba(0x1c8)},{'$match':{'sale_product.id_transaction_from':_0x1d653c[_0x5623ba(0x1d6)][_0x5623ba(0x1a5)](),'sale_product.invoice':_0x1d653c[_0x5623ba(0x194)]}},{'$project':{'_id':_0x5623ba(0x1af),'product_name':'$sale_product.product_name','product_code':_0x5623ba(0x1e4),'quantity_available':_0x5623ba(0x1c2),'warehouse_name':_0x5623ba(0x1c5),'warehouse_room':'$sale_product.room_name','product_invoice':_0x5623ba(0x1b3),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x5623ba(0x1a2),'production_date':'$sale_product.production_date','expiry_date':_0x5623ba(0x191),'UOM':_0x5623ba(0x1b4)}}]);_0x2e91d5[_0x5623ba(0x1f5)]>0x0&&_0x1c93f4['data_sales'][_0x2a7e3d['invoice']][_0x5623ba(0x1be)](..._0x2e91d5);}));})),_0x1c93f4[_0xa962b7(0x1f7)]=_0x1c93f4['data_sales'],_0x1c93f4[_0xa962b7(0x1b6)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4[_0xa962b7(0x1c4)](async _0x5c86bb=>{var _0x18b0dc=_0xa962b7;_0x1c93f4[_0x18b0dc(0x1b6)][_0x5c86bb[_0x18b0dc(0x194)]]=[],await Promise[_0x18b0dc(0x1e7)](_0x5c86bb[_0x18b0dc(0x1d8)][_0x18b0dc(0x1c4)](async _0x538f9d=>{var _0x29ecb1=_0x18b0dc;const _0x361a5d=await adjustment_finished['aggregate']([{'$unwind':_0x29ecb1(0x1ad)},{'$match':{'product.id_transaction_from':_0x538f9d[_0x29ecb1(0x1d6)][_0x29ecb1(0x1a5)](),'product.invoice':_0x538f9d[_0x29ecb1(0x194)]}},{'$project':{'_id':_0x29ecb1(0x1ba),'product_name':'$product.product_name','product_code':_0x29ecb1(0x199),'quantity_available':_0x29ecb1(0x1a6),'warehouse_name':'$warehouse_name','warehouse_room':_0x29ecb1(0x1d3),'product_invoice':_0x29ecb1(0x1ae),'invoice':_0x29ecb1(0x19d),'id_transaction_from':_0x29ecb1(0x1d4),'date':'$date','production_date':_0x29ecb1(0x1e5),'expiry_date':'$product.expiry_date','UOM':_0x29ecb1(0x1d9)}}]);_0x361a5d['length']>0x0&&_0x1c93f4['data_adjustment'][_0x5c86bb[_0x29ecb1(0x194)]][_0x29ecb1(0x1be)](..._0x361a5d);}));})),_0x1c93f4[_0xa962b7(0x18e)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4['map'](async _0x4f62eb=>{var _0x49d35e=_0xa962b7;_0x1c93f4[_0x49d35e(0x18e)][_0x4f62eb[_0x49d35e(0x194)]]=[],await Promise[_0x49d35e(0x1e7)](_0x4f62eb['warehouse_data'][_0x49d35e(0x1c4)](async _0x49a64e=>{var _0x1e9074=_0x49d35e;const _0xba3014=await transfers_finished['aggregate']([{'$unwind':_0x1e9074(0x1ad)},{'$match':{'product.id_transaction':_0x49a64e[_0x1e9074(0x1d6)]['valueOf'](),'product.from_invoice':_0x49a64e[_0x1e9074(0x194)]}},{'$project':{'_id':_0x1e9074(0x1ba),'product_name':_0x1e9074(0x1df),'product_code':_0x1e9074(0x199),'quantity_available':'$product.to_quantity','warehouse_name':_0x1e9074(0x1c6),'warehouse_room':_0x1e9074(0x1d3),'product_invoice':'$product.to_room_name','invoice':_0x1e9074(0x19d),'id_transaction_from':_0x1e9074(0x1f0),'date':_0x1e9074(0x1a2),'production_date':_0x1e9074(0x1e5),'expiry_date':'$product.expiry_date','UOM':_0x1e9074(0x1d9)}}]);_0xba3014[_0x1e9074(0x1f5)]>0x0&&_0x1c93f4['data_transfer'][_0x4f62eb[_0x1e9074(0x194)]][_0x1e9074(0x1be)](..._0xba3014);}));})),_0x5e5387[_0xa962b7(0x19a)]({'purchases_warehouse':_0x1c93f4,'data_sales':_0x1c93f4[_0xa962b7(0x1f7)],'data_adjustment':_0x1c93f4[_0xa962b7(0x1b6)],'data_transfer':_0x1c93f4[_0xa962b7(0x18e)]});}else{var _0x1c93f4=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x11e273,'date':{'$gte':_0x54fa49,'$lte':_0x4f91e7}}},{'$lookup':{'from':_0xa962b7(0x1ce),'let':{'invoice':_0xa962b7(0x19d)},'pipeline':[{'$unwind':_0xa962b7(0x1e2)},{'$match':{'$expr':{'$eq':[_0xa962b7(0x1b7),'$product_details.invoice']}}},{'$project':{'_id':_0xa962b7(0x1a3),'product_name':_0xa962b7(0x1f4),'product_code':_0xa962b7(0x1e1),'quantity_available':_0xa962b7(0x19b),'warehouse_name':'$name','warehouse_room':'$room','invoice':'$product_details.invoice','production_date':_0xa962b7(0x1a1),'expiry_date':'$product_details.expiry_date','UOM':_0xa962b7(0x1a7)}}],'as':_0xa962b7(0x1d8)}}]);_0x1c93f4[_0xa962b7(0x1f7)]={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4[_0xa962b7(0x1c4)](async _0x3a616b=>{var _0x197727=_0xa962b7;_0x1c93f4[_0x197727(0x1f7)][_0x3a616b[_0x197727(0x194)]]=[],await Promise[_0x197727(0x1e7)](_0x3a616b[_0x197727(0x1d8)][_0x197727(0x1c4)](async _0x4c0ed=>{var _0x4b2d1e=_0x197727;const _0xa4a7f9=await sales_finished[_0x4b2d1e(0x1d5)]([{'$unwind':_0x4b2d1e(0x1c8)},{'$match':{'sale_product.id_transaction_from':_0x4c0ed[_0x4b2d1e(0x1d6)]['valueOf'](),'sale_product.invoice':_0x4c0ed[_0x4b2d1e(0x194)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x4b2d1e(0x1b1),'product_code':_0x4b2d1e(0x1e4),'quantity_available':_0x4b2d1e(0x1c2),'warehouse_name':_0x4b2d1e(0x1c5),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0x4b2d1e(0x19d),'id_transaction_from':_0x4b2d1e(0x1ac),'date':_0x4b2d1e(0x1a2),'production_date':_0x4b2d1e(0x1da),'expiry_date':_0x4b2d1e(0x191),'UOM':_0x4b2d1e(0x1b4)}}]);_0xa4a7f9[_0x4b2d1e(0x1f5)]>0x0&&_0x1c93f4[_0x4b2d1e(0x1f7)][_0x3a616b[_0x4b2d1e(0x194)]][_0x4b2d1e(0x1be)](..._0xa4a7f9);}));})),_0x1c93f4['data_sales']=_0x1c93f4[_0xa962b7(0x1f7)],_0x1c93f4['data_adjustment']={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4[_0xa962b7(0x1c4)](async _0x2f657a=>{var _0x1cee38=_0xa962b7;_0x1c93f4[_0x1cee38(0x1b6)][_0x2f657a[_0x1cee38(0x194)]]=[],await Promise[_0x1cee38(0x1e7)](_0x2f657a[_0x1cee38(0x1d8)][_0x1cee38(0x1c4)](async _0x4a0383=>{var _0x94ef40=_0x1cee38;const _0x44b0d0=await adjustment_finished[_0x94ef40(0x1d5)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x4a0383['_id']['valueOf'](),'product.invoice':_0x4a0383[_0x94ef40(0x194)]}},{'$project':{'_id':_0x94ef40(0x1ba),'product_name':_0x94ef40(0x1df),'product_code':'$product.product_code','quantity_available':_0x94ef40(0x1a6),'warehouse_name':'$warehouse_name','warehouse_room':_0x94ef40(0x1d3),'product_invoice':_0x94ef40(0x1ae),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':_0x94ef40(0x1e5),'expiry_date':_0x94ef40(0x1bd),'UOM':_0x94ef40(0x1d9)}}]);_0x44b0d0[_0x94ef40(0x1f5)]>0x0&&_0x1c93f4[_0x94ef40(0x1b6)][_0x2f657a[_0x94ef40(0x194)]]['push'](..._0x44b0d0);}));})),_0x1c93f4['data_transfer']={},await Promise[_0xa962b7(0x1e7)](_0x1c93f4['map'](async _0x57f0e7=>{var _0x4af62f=_0xa962b7;_0x1c93f4[_0x4af62f(0x18e)][_0x57f0e7['invoice']]=[],await Promise[_0x4af62f(0x1e7)](_0x57f0e7[_0x4af62f(0x1d8)][_0x4af62f(0x1c4)](async _0x598d8f=>{var _0x3ddf1e=_0x4af62f;const _0x192a69=await transfers_finished[_0x3ddf1e(0x1d5)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0x598d8f[_0x3ddf1e(0x1d6)][_0x3ddf1e(0x1a5)](),'product.from_invoice':_0x598d8f['invoice']}},{'$project':{'_id':'$product._id','product_name':_0x3ddf1e(0x1df),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':'$to_warehouse','warehouse_room':_0x3ddf1e(0x1d3),'product_invoice':_0x3ddf1e(0x1d7),'invoice':_0x3ddf1e(0x19d),'id_transaction_from':_0x3ddf1e(0x1f0),'date':_0x3ddf1e(0x1a2),'production_date':_0x3ddf1e(0x1e5),'expiry_date':_0x3ddf1e(0x1bd),'UOM':_0x3ddf1e(0x1d9)}}]);_0x192a69[_0x3ddf1e(0x1f5)]>0x0&&_0x1c93f4[_0x3ddf1e(0x18e)][_0x57f0e7[_0x3ddf1e(0x194)]][_0x3ddf1e(0x1be)](..._0x192a69);}));})),_0x5e5387['json']({'purchases_warehouse':_0x1c93f4,'data_sales':_0x1c93f4[_0xa962b7(0x1f7)],'data_adjustment':_0x1c93f4['data_adjustment'],'data_transfer':_0x1c93f4[_0xa962b7(0x18e)]});}}}),router['get'](a0_0x365ea1(0x1cb),auth,async(_0x55d7e6,_0x4e0411)=>{var _0x12dd00=a0_0x365ea1;try{const _0x1c6896=_0x55d7e6[_0x12dd00(0x1dd)]['id'];var _0x2f2b0e=await purchases_finished[_0x12dd00(0x1c0)](_0x1c6896);const _0x343f93=await master_shop[_0x12dd00(0x1eb)](),_0x4e3ed4=_0x55d7e6[_0x12dd00(0x1b8)],_0x33b1f6=await profile['findOne']({'email':_0x4e3ed4['email']});if(_0x343f93[0x0][_0x12dd00(0x196)]=='English\x20(US)')var _0x43583a=users[_0x12dd00(0x1f2)];else{if(_0x343f93[0x0]['language']==_0x12dd00(0x1b0))var _0x43583a=users[_0x12dd00(0x1b0)];else{if(_0x343f93[0x0][_0x12dd00(0x196)]=='German')var _0x43583a=users[_0x12dd00(0x1e9)];else{if(_0x343f93[0x0][_0x12dd00(0x196)]==_0x12dd00(0x1ea))var _0x43583a=users['Spanish'];else{if(_0x343f93[0x0][_0x12dd00(0x196)]==_0x12dd00(0x1a8))var _0x43583a=users[_0x12dd00(0x1a8)];else{if(_0x343f93[0x0]['language']==_0x12dd00(0x1a0))var _0x43583a=users[_0x12dd00(0x1e0)];else{if(_0x343f93[0x0]['language']==_0x12dd00(0x192))var _0x43583a=users[_0x12dd00(0x192)];else{if(_0x343f93[0x0][_0x12dd00(0x196)]=='Arabic\x20(ae)')var _0x43583a=users[_0x12dd00(0x1ef)];}}}}}}}_0x4e0411[_0x12dd00(0x1ab)](_0x12dd00(0x1e6),{'success':_0x55d7e6[_0x12dd00(0x1d0)](_0x12dd00(0x1aa)),'errors':_0x55d7e6[_0x12dd00(0x1d0)](_0x12dd00(0x190)),'master_shop':_0x343f93,'profile':_0x33b1f6,'role':_0x4e3ed4,'language':_0x43583a,'data':_0x2f2b0e});}catch(_0x140401){_0x4e0411[_0x12dd00(0x19a)](_0x140401);}}),router['get']('/viewdata_og_fg/:id',auth,async(_0x570ec4,_0x3d8ae8)=>{var _0x60c779=a0_0x365ea1;try{const _0x227e3b=_0x570ec4[_0x60c779(0x1dd)]['id'];var _0x28cd73=await sales_finished[_0x60c779(0x1c0)](_0x227e3b);const _0x4ebee7=await master_shop[_0x60c779(0x1eb)](),_0x103d38=_0x570ec4[_0x60c779(0x1b8)],_0x24dabb=await profile[_0x60c779(0x1bf)]({'email':_0x103d38[_0x60c779(0x1bc)]});if(_0x4ebee7[0x0][_0x60c779(0x196)]==_0x60c779(0x1cd))var _0x19ea28=users['English'];else{if(_0x4ebee7[0x0][_0x60c779(0x196)]==_0x60c779(0x1b0))var _0x19ea28=users[_0x60c779(0x1b0)];else{if(_0x4ebee7[0x0][_0x60c779(0x196)]==_0x60c779(0x1e9))var _0x19ea28=users[_0x60c779(0x1e9)];else{if(_0x4ebee7[0x0][_0x60c779(0x196)]=='Spanish')var _0x19ea28=users['Spanish'];else{if(_0x4ebee7[0x0]['language']=='French')var _0x19ea28=users[_0x60c779(0x1a8)];else{if(_0x4ebee7[0x0][_0x60c779(0x196)]==_0x60c779(0x1a0))var _0x19ea28=users[_0x60c779(0x1e0)];else{if(_0x4ebee7[0x0][_0x60c779(0x196)]==_0x60c779(0x192))var _0x19ea28=users[_0x60c779(0x192)];else{if(_0x4ebee7[0x0]['language']=='Arabic\x20(ae)')var _0x19ea28=users['Arabic'];}}}}}}}_0x3d8ae8[_0x60c779(0x1ab)](_0x60c779(0x195),{'success':_0x570ec4['flash']('success'),'errors':_0x570ec4[_0x60c779(0x1d0)]('errors'),'master_shop':_0x4ebee7,'profile':_0x24dabb,'role':_0x103d38,'language':_0x19ea28,'data':_0x28cd73});}catch(_0x911056){_0x3d8ae8[_0x60c779(0x19a)](_0x911056);}}),router['get']('/viewdata_tf_fg/:id',auth,async(_0x1fcdc3,_0x4d4f2e)=>{var _0x4af882=a0_0x365ea1;try{const _0x4933f0=_0x1fcdc3[_0x4af882(0x1dd)]['id'];var _0x5a66aa=await transfers_finished['findById'](_0x4933f0);const _0x46e97a=await master_shop[_0x4af882(0x1eb)](),_0xdad240=_0x1fcdc3[_0x4af882(0x1b8)],_0x52bf14=await profile[_0x4af882(0x1bf)]({'email':_0xdad240['email']});if(_0x46e97a[0x0]['language']==_0x4af882(0x1cd))var _0x40de20=users[_0x4af882(0x1f2)];else{if(_0x46e97a[0x0][_0x4af882(0x196)]==_0x4af882(0x1b0))var _0x40de20=users[_0x4af882(0x1b0)];else{if(_0x46e97a[0x0][_0x4af882(0x196)]==_0x4af882(0x1e9))var _0x40de20=users[_0x4af882(0x1e9)];else{if(_0x46e97a[0x0]['language']==_0x4af882(0x1ea))var _0x40de20=users[_0x4af882(0x1ea)];else{if(_0x46e97a[0x0][_0x4af882(0x196)]==_0x4af882(0x1a8))var _0x40de20=users[_0x4af882(0x1a8)];else{if(_0x46e97a[0x0][_0x4af882(0x196)]==_0x4af882(0x1a0))var _0x40de20=users['Portuguese'];else{if(_0x46e97a[0x0][_0x4af882(0x196)]=='Chinese')var _0x40de20=users['Chinese'];else{if(_0x46e97a[0x0][_0x4af882(0x196)]==_0x4af882(0x1a9))var _0x40de20=users[_0x4af882(0x1ef)];}}}}}}}_0x4d4f2e[_0x4af882(0x1ab)]('view_tf_table',{'success':_0x1fcdc3[_0x4af882(0x1d0)](_0x4af882(0x1aa)),'errors':_0x1fcdc3[_0x4af882(0x1d0)]('errors'),'master_shop':_0x46e97a,'profile':_0x52bf14,'role':_0xdad240,'language':_0x40de20,'data':_0x5a66aa});}catch(_0x23d48e){_0x4d4f2e['json'](_0x23d48e);}}),router[a0_0x365ea1(0x1b2)]('/viewFG',auth,async(_0x15b5d8,_0x3a84e1)=>{var _0x1e3ab3=a0_0x365ea1;try{const {username:_0xae631,email:_0x3e9106,role:_0x30310a}=_0x15b5d8[_0x1e3ab3(0x1b8)],_0x5a50aa=_0x15b5d8[_0x1e3ab3(0x1b8)],_0x1860bc=await profile[_0x1e3ab3(0x1bf)]({'email':_0x5a50aa['email']}),_0x24355e=await master_shop[_0x1e3ab3(0x1eb)](),_0x21e200=await warehouse[_0x1e3ab3(0x1d5)]([{'$match':{'status':'Enabled','warehouse_category':_0x1e3ab3(0x1b5)}},{'$group':{'_id':_0x1e3ab3(0x1de),'name':{'$first':_0x1e3ab3(0x1de)}}}]);if(_0x24355e[0x0][_0x1e3ab3(0x196)]=='English\x20(US)')var _0x3b0796=users[_0x1e3ab3(0x1f2)];else{if(_0x24355e[0x0][_0x1e3ab3(0x196)]=='Hindi')var _0x3b0796=users['Hindi'];else{if(_0x24355e[0x0][_0x1e3ab3(0x196)]==_0x1e3ab3(0x1e9))var _0x3b0796=users['German'];else{if(_0x24355e[0x0][_0x1e3ab3(0x196)]==_0x1e3ab3(0x1ea))var _0x3b0796=users[_0x1e3ab3(0x1ea)];else{if(_0x24355e[0x0]['language']==_0x1e3ab3(0x1a8))var _0x3b0796=users[_0x1e3ab3(0x1a8)];else{if(_0x24355e[0x0][_0x1e3ab3(0x196)]==_0x1e3ab3(0x1a0))var _0x3b0796=users[_0x1e3ab3(0x1e0)];else{if(_0x24355e[0x0][_0x1e3ab3(0x196)]=='Chinese')var _0x3b0796=users[_0x1e3ab3(0x192)];else{if(_0x24355e[0x0][_0x1e3ab3(0x196)]=='Arabic\x20(ae)')var _0x3b0796=users[_0x1e3ab3(0x1ef)];}}}}}}}_0x3a84e1[_0x1e3ab3(0x1ab)]('transaction_finished_raw',{'success':_0x15b5d8['flash'](_0x1e3ab3(0x1aa)),'errors':_0x15b5d8[_0x1e3ab3(0x1d0)](_0x1e3ab3(0x190)),'role':_0x5a50aa,'profile':_0x1860bc,'master_shop':_0x24355e,'dataProcess':_0x21e200,'language':_0x3b0796});}catch(_0x4b6c3f){console[_0x1e3ab3(0x1b9)](_0x4b6c3f);}}),module[a0_0x365ea1(0x1d2)]=router;