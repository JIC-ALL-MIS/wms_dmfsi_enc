var a0_0x3af562=a0_0x3b93;function a0_0x102d(){var _0x513b29=['log','6KtMJgV','English','/viewdata_tf_fg/:id','flash','../middleware/auth','invoice','view_og_table','errors','find','nodemailer','warehouse_data','express','$sale_product.unit','$sale_product.room_name','../public/language/languages.json','195078jarGBX','/viewdata_inc_fg/:id','707444apFBYQ','$product.to_room_name','data_adjustment','$product_details.product_name','English\x20(US)','$product_details.production_date','$product.expiry_date','1496133kghHfR','get','$room','$name','push','aggregate','findOne','$product_details.invoice','Chinese','length','user','$sale_product','309639lTAAoE','map','$product.room_names','Spanish','json','$product.to_quantity','$product_details._id','$product.invoice','86705PyOFPH','$product_details.expiry_date','data_transfer','Portuguese','$sale_product.invoice','$invoice','$$invoice','$to_warehouse','$product','$product.product_name','_id','$product._id','params','$product.product_code','Portuguese\x20(BR)','$sale_product.product_code','valueOf','$product_details','/reports','French','Arabic\x20(ae)','render','warehouses','body','16wlbwQL','Finished\x20Goods','$product_details.product_stock','transaction_finished_raw','$product_details.unit','$sale_product.id_transaction_from','/viewdata_og_fg/:id','Enabled','$product_details.product_code','view_tf_table','$sale_product.product_name','$product.id_transaction','174sqzUsJ','findById','864129jHIzjl','email','$sale_product.expiry_date','../models/all_models','German','success','Hindi','$date','70wklNFD','$sale_product._id','Router','/view','$sale_product.quantity','$product.unit','data_sales','transaction_finished','$product.id_transaction_id','language','$product.new_adjust_qty','$product.production_date','view_table','431765uAcSIv','$warehouse_name','$product.id_transaction_from','all','Arabic','$sale_product.production_date'];a0_0x102d=function(){return _0x513b29;};return a0_0x102d();}(function(_0x2c9cc6,_0x387cb9){var _0x5b858e=a0_0x3b93,_0x17960c=_0x2c9cc6();while(!![]){try{var _0x5b7c97=parseInt(_0x5b858e(0xcf))/0x1+-parseInt(_0x5b858e(0xd6))/0x2*(parseInt(_0x5b858e(0xe5))/0x3)+-parseInt(_0x5b858e(0xe7))/0x4+-parseInt(_0x5b858e(0x102))/0x5*(-parseInt(_0x5b858e(0xb8))/0x6)+-parseInt(_0x5b858e(0xba))/0x7+parseInt(_0x5b858e(0xac))/0x8*(-parseInt(_0x5b858e(0xee))/0x9)+parseInt(_0x5b858e(0xc2))/0xa*(parseInt(_0x5b858e(0xfa))/0xb);if(_0x5b7c97===_0x387cb9)break;else _0x17960c['push'](_0x17960c['shift']());}catch(_0x16edfc){_0x17960c['push'](_0x17960c['shift']());}}}(a0_0x102d,0x4a2dd));const express=require(a0_0x3af562(0xe1)),app=express(),router=express[a0_0x3af562(0xc4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x3af562(0xbd)),auth=require(a0_0x3af562(0xda)),users=require(a0_0x3af562(0xe4)),nodemailer=require(a0_0x3af562(0xdf));function a0_0x3b93(_0x3921e1,_0x4f2b61){var _0x102d9b=a0_0x102d();return a0_0x3b93=function(_0x3b9323,_0x195d90){_0x3b9323=_0x3b9323-0xa7;var _0x4b3b79=_0x102d9b[_0x3b9323];return _0x4b3b79;},a0_0x3b93(_0x3921e1,_0x4f2b61);}router[a0_0x3af562(0xef)](a0_0x3af562(0xc5),auth,async(_0x22a30a,_0x3ce75d)=>{var _0x21f434=a0_0x3af562;try{const {username:_0x347a81,email:_0x51e7bb,role:_0x51a8e3}=_0x22a30a[_0x21f434(0xf8)],_0x358b83=_0x22a30a[_0x21f434(0xf8)],_0x32ee62=await profile[_0x21f434(0xf4)]({'email':_0x358b83['email']}),_0x4d4f74=await master_shop[_0x21f434(0xde)](),_0x5f3535=await warehouse[_0x21f434(0xf3)]([{'$match':{'status':_0x21f434(0xb3),'warehouse_category':_0x21f434(0xad)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x4d4f74[0x0][_0x21f434(0xcb)]==_0x21f434(0xeb))var _0x3042dd=users[_0x21f434(0xd7)];else{if(_0x4d4f74[0x0]['language']=='Hindi')var _0x3042dd=users[_0x21f434(0xc0)];else{if(_0x4d4f74[0x0]['language']==_0x21f434(0xbe))var _0x3042dd=users[_0x21f434(0xbe)];else{if(_0x4d4f74[0x0][_0x21f434(0xcb)]=='Spanish')var _0x3042dd=users['Spanish'];else{if(_0x4d4f74[0x0][_0x21f434(0xcb)]==_0x21f434(0xa7))var _0x3042dd=users[_0x21f434(0xa7)];else{if(_0x4d4f74[0x0][_0x21f434(0xcb)]=='Portuguese\x20(BR)')var _0x3042dd=users[_0x21f434(0x105)];else{if(_0x4d4f74[0x0][_0x21f434(0xcb)]=='Chinese')var _0x3042dd=users[_0x21f434(0xf6)];else{if(_0x4d4f74[0x0][_0x21f434(0xcb)]==_0x21f434(0xa8))var _0x3042dd=users[_0x21f434(0xd3)];}}}}}}}_0x3ce75d[_0x21f434(0xa9)](_0x21f434(0xc9),{'success':_0x22a30a[_0x21f434(0xd9)](_0x21f434(0xbf)),'errors':_0x22a30a[_0x21f434(0xd9)](_0x21f434(0xdd)),'role':_0x358b83,'profile':_0x32ee62,'master_shop':_0x4d4f74,'dataProcess':_0x5f3535,'language':_0x3042dd});}catch(_0x4f0ae2){console[_0x21f434(0xd5)](_0x4f0ae2);}}),router['post'](a0_0x3af562(0x114),auth,async(_0x33553c,_0x47ab8a)=>{var _0x37b61d=a0_0x3af562;const {product_category:_0x4d3fdf,transaction_category:_0x4fd994,transaction_date_from:_0x274e00,transaction_date_to:_0x22b62d,warehouse_category:_0x5b4c5d,item_code:_0x1f28fb}=_0x33553c[_0x37b61d(0xab)];console[_0x37b61d(0xd5)](_0x5b4c5d);if(_0x4d3fdf=='rm'){if(_0x5b4c5d==_0x37b61d(0xd2)){var _0x536594=await purchases[_0x37b61d(0xf3)]([{'$match':{'date':{'$gte':_0x274e00,'$lte':_0x22b62d}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x37b61d(0x107)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x37b61d(0x108),_0x37b61d(0xf5)]}}},{'$project':{'_id':_0x37b61d(0x100),'product_name':'$product_details.product_name','product_code':_0x37b61d(0xb4),'quantity_available':'$product_details.product_stock','warehouse_name':_0x37b61d(0xf1),'warehouse_room':'$room','invoice':_0x37b61d(0xf5),'production_date':_0x37b61d(0xec),'expiry_date':_0x37b61d(0x103),'UOM':_0x37b61d(0xb0)}}],'as':'warehouse_data'}}]);_0x536594['data_sales']={},await Promise[_0x37b61d(0xd2)](_0x536594[_0x37b61d(0xfb)](async _0x532365=>{var _0x1116d6=_0x37b61d;_0x536594['data_sales'][_0x532365['invoice']]=[],await Promise[_0x1116d6(0xd2)](_0x532365[_0x1116d6(0xe0)][_0x1116d6(0xfb)](async _0x2a2f4b=>{var _0xa42183=_0x1116d6;const _0x7915b=await sales[_0xa42183(0xf3)]([{'$unwind':_0xa42183(0xf9)},{'$match':{'sale_product.id_transaction_from':_0x2a2f4b[_0xa42183(0x10c)][_0xa42183(0x112)](),'sale_product.invoice':_0x2a2f4b[_0xa42183(0xdb)]}},{'$project':{'_id':_0xa42183(0xc3),'product_name':_0xa42183(0xb6),'product_code':_0xa42183(0x111),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0xa42183(0xe3),'product_invoice':_0xa42183(0x106),'invoice':_0xa42183(0x107),'id_transaction_from':_0xa42183(0xb1),'date':_0xa42183(0xc1),'production_date':'$sale_product.production_date','expiry_date':_0xa42183(0xbc),'UOM':_0xa42183(0xe2)}}]);_0x7915b[_0xa42183(0xf7)]>0x0&&_0x536594[_0xa42183(0xc8)][_0x532365[_0xa42183(0xdb)]][_0xa42183(0xf2)](..._0x7915b);}));})),_0x536594[_0x37b61d(0xc8)]=_0x536594[_0x37b61d(0xc8)],_0x536594[_0x37b61d(0xe9)]={},await Promise[_0x37b61d(0xd2)](_0x536594[_0x37b61d(0xfb)](async _0x5831ba=>{var _0x28c410=_0x37b61d;_0x536594[_0x28c410(0xe9)][_0x5831ba[_0x28c410(0xdb)]]=[],await Promise[_0x28c410(0xd2)](_0x5831ba[_0x28c410(0xe0)][_0x28c410(0xfb)](async _0x697f0f=>{var _0x1f8aa7=_0x28c410;const _0x34e1e7=await adjustment[_0x1f8aa7(0xf3)]([{'$unwind':_0x1f8aa7(0x10a)},{'$match':{'product.id_transaction_from':_0x697f0f[_0x1f8aa7(0x10c)]['valueOf'](),'product.invoice':_0x697f0f['invoice']}},{'$project':{'_id':_0x1f8aa7(0x10d),'product_name':'$product.product_name','product_code':_0x1f8aa7(0x10f),'quantity_available':_0x1f8aa7(0xcc),'warehouse_name':_0x1f8aa7(0xd0),'warehouse_room':_0x1f8aa7(0xfc),'product_invoice':_0x1f8aa7(0x101),'invoice':_0x1f8aa7(0x107),'id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':_0x1f8aa7(0xcd),'expiry_date':_0x1f8aa7(0xed),'UOM':'$product.unit'}}]);_0x34e1e7['length']>0x0&&_0x536594[_0x1f8aa7(0xe9)][_0x5831ba[_0x1f8aa7(0xdb)]][_0x1f8aa7(0xf2)](..._0x34e1e7);}));})),_0x536594[_0x37b61d(0x104)]={},await Promise[_0x37b61d(0xd2)](_0x536594[_0x37b61d(0xfb)](async _0x5aa0d2=>{var _0x43c9e7=_0x37b61d;_0x536594[_0x43c9e7(0x104)][_0x5aa0d2[_0x43c9e7(0xdb)]]=[],await Promise[_0x43c9e7(0xd2)](_0x5aa0d2[_0x43c9e7(0xe0)]['map'](async _0x1e11d2=>{var _0x16047b=_0x43c9e7;const _0x570f64=await transfers[_0x16047b(0xf3)]([{'$unwind':_0x16047b(0x10a)},{'$match':{'product.id_transaction_id':_0x1e11d2[_0x16047b(0x10c)][_0x16047b(0x112)](),'product.To_invoice':_0x1e11d2['invoice']}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x16047b(0x10f),'quantity_available':_0x16047b(0xff),'warehouse_name':_0x16047b(0x109),'warehouse_room':_0x16047b(0xfc),'product_invoice':_0x16047b(0xe8),'invoice':_0x16047b(0x107),'id_transaction_from':'$product.id_transaction_id','date':_0x16047b(0xc1),'production_date':_0x16047b(0xcd),'expiry_date':'$product.expiry_date','UOM':_0x16047b(0xc7)}}]);_0x570f64[_0x16047b(0xf7)]>0x0&&_0x536594['data_transfer'][_0x5aa0d2[_0x16047b(0xdb)]][_0x16047b(0xf2)](..._0x570f64);}));})),_0x47ab8a['json']({'purchases_warehouse':_0x536594,'data_sales':_0x536594[_0x37b61d(0xc8)],'data_adjustment':_0x536594[_0x37b61d(0xe9)],'data_transfer':_0x536594[_0x37b61d(0x104)]});}else{var _0x536594=await purchases[_0x37b61d(0xf3)]([{'$match':{'warehouse_name':_0x5b4c5d,'date':{'$gte':_0x274e00,'$lte':_0x22b62d}}},{'$lookup':{'from':_0x37b61d(0xaa),'let':{'invoice':_0x37b61d(0x107)},'pipeline':[{'$unwind':_0x37b61d(0x113)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x37b61d(0x100),'product_name':_0x37b61d(0xea),'product_code':'$product_details.product_code','quantity_available':_0x37b61d(0xae),'warehouse_name':_0x37b61d(0xf1),'warehouse_room':_0x37b61d(0xf0),'invoice':_0x37b61d(0xf5),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x37b61d(0xb0)}}],'as':_0x37b61d(0xe0)}}]);_0x536594[_0x37b61d(0xc8)]={},await Promise[_0x37b61d(0xd2)](_0x536594[_0x37b61d(0xfb)](async _0x235ae6=>{var _0x508489=_0x37b61d;_0x536594[_0x508489(0xc8)][_0x235ae6[_0x508489(0xdb)]]=[],await Promise[_0x508489(0xd2)](_0x235ae6[_0x508489(0xe0)]['map'](async _0x3e9ff8=>{var _0x48b540=_0x508489;const _0x1e5bc5=await sales[_0x48b540(0xf3)]([{'$unwind':_0x48b540(0xf9)},{'$match':{'sale_product.id_transaction_from':_0x3e9ff8['_id']['valueOf'](),'sale_product.invoice':_0x3e9ff8[_0x48b540(0xdb)]}},{'$project':{'_id':_0x48b540(0xc3),'product_name':_0x48b540(0xb6),'product_code':'$sale_product.product_code','quantity_available':_0x48b540(0xc6),'warehouse_name':_0x48b540(0xd0),'warehouse_room':'$sale_product.room_name','product_invoice':_0x48b540(0x106),'invoice':_0x48b540(0x107),'id_transaction_from':_0x48b540(0xb1),'date':'$date','production_date':'$sale_product.production_date','expiry_date':_0x48b540(0xbc),'UOM':_0x48b540(0xe2)}}]);_0x1e5bc5['length']>0x0&&_0x536594[_0x48b540(0xc8)][_0x235ae6[_0x48b540(0xdb)]][_0x48b540(0xf2)](..._0x1e5bc5);}));})),_0x536594[_0x37b61d(0xc8)]=_0x536594[_0x37b61d(0xc8)],_0x536594[_0x37b61d(0xe9)]={},await Promise['all'](_0x536594[_0x37b61d(0xfb)](async _0x18fd14=>{var _0x6c9dae=_0x37b61d;_0x536594[_0x6c9dae(0xe9)][_0x18fd14[_0x6c9dae(0xdb)]]=[],await Promise['all'](_0x18fd14[_0x6c9dae(0xe0)]['map'](async _0x1b4461=>{var _0x141c59=_0x6c9dae;const _0x339b59=await adjustment[_0x141c59(0xf3)]([{'$unwind':_0x141c59(0x10a)},{'$match':{'product.id_transaction_from':_0x1b4461[_0x141c59(0x10c)][_0x141c59(0x112)](),'product.invoice':_0x1b4461[_0x141c59(0xdb)]}},{'$project':{'_id':_0x141c59(0x10d),'product_name':_0x141c59(0x10b),'product_code':_0x141c59(0x10f),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x141c59(0xd0),'warehouse_room':_0x141c59(0xfc),'product_invoice':_0x141c59(0x101),'invoice':_0x141c59(0x107),'id_transaction_from':'$product.id_transaction_from','date':_0x141c59(0xc1),'production_date':_0x141c59(0xcd),'expiry_date':'$product.expiry_date','UOM':_0x141c59(0xc7)}}]);_0x339b59['length']>0x0&&_0x536594[_0x141c59(0xe9)][_0x18fd14[_0x141c59(0xdb)]]['push'](..._0x339b59);}));})),_0x536594['data_transfer']={},await Promise['all'](_0x536594[_0x37b61d(0xfb)](async _0x33d4be=>{var _0x206372=_0x37b61d;_0x536594[_0x206372(0x104)][_0x33d4be[_0x206372(0xdb)]]=[],await Promise[_0x206372(0xd2)](_0x33d4be[_0x206372(0xe0)][_0x206372(0xfb)](async _0x4f6dc3=>{var _0xab529d=_0x206372;const _0x481b12=await transfers[_0xab529d(0xf3)]([{'$unwind':_0xab529d(0x10a)},{'$match':{'product.id_transaction_id':_0x4f6dc3[_0xab529d(0x10c)][_0xab529d(0x112)](),'product.To_invoice':_0x4f6dc3['invoice']}},{'$project':{'_id':_0xab529d(0x10d),'product_name':_0xab529d(0x10b),'product_code':_0xab529d(0x10f),'quantity_available':_0xab529d(0xff),'warehouse_name':'$to_warehouse','warehouse_room':_0xab529d(0xfc),'product_invoice':_0xab529d(0xe8),'invoice':_0xab529d(0x107),'id_transaction_from':_0xab529d(0xca),'date':_0xab529d(0xc1),'production_date':_0xab529d(0xcd),'expiry_date':_0xab529d(0xed),'UOM':'$product.unit'}}]);_0x481b12['length']>0x0&&_0x536594[_0xab529d(0x104)][_0x33d4be[_0xab529d(0xdb)]]['push'](..._0x481b12);}));})),_0x47ab8a[_0x37b61d(0xfe)]({'purchases_warehouse':_0x536594,'data_sales':_0x536594[_0x37b61d(0xc8)],'data_adjustment':_0x536594['data_adjustment'],'data_transfer':_0x536594['data_transfer']});}}else{if(_0x5b4c5d==_0x37b61d(0xd2)){var _0x536594=await purchases_finished[_0x37b61d(0xf3)]([{'$match':{'date':{'$gte':_0x274e00,'$lte':_0x22b62d}}},{'$lookup':{'from':_0x37b61d(0xaa),'let':{'invoice':_0x37b61d(0x107)},'pipeline':[{'$unwind':_0x37b61d(0x113)},{'$match':{'$expr':{'$eq':[_0x37b61d(0x108),_0x37b61d(0xf5)]}}},{'$project':{'_id':_0x37b61d(0x100),'product_name':_0x37b61d(0xea),'product_code':_0x37b61d(0xb4),'quantity_available':'$product_details.product_stock','warehouse_name':_0x37b61d(0xf1),'warehouse_room':'$room','invoice':_0x37b61d(0xf5),'production_date':_0x37b61d(0xec),'expiry_date':_0x37b61d(0x103),'UOM':_0x37b61d(0xb0)}}],'as':_0x37b61d(0xe0)}}]);_0x536594['data_sales']={},await Promise[_0x37b61d(0xd2)](_0x536594[_0x37b61d(0xfb)](async _0x1efa75=>{var _0x2e93a9=_0x37b61d;_0x536594['data_sales'][_0x1efa75[_0x2e93a9(0xdb)]]=[],await Promise[_0x2e93a9(0xd2)](_0x1efa75[_0x2e93a9(0xe0)][_0x2e93a9(0xfb)](async _0x5bb4b9=>{var _0xe441e9=_0x2e93a9;const _0x4c71b3=await sales_finished['aggregate']([{'$unwind':_0xe441e9(0xf9)},{'$match':{'sale_product.id_transaction_from':_0x5bb4b9['_id']['valueOf'](),'sale_product.invoice':_0x5bb4b9[_0xe441e9(0xdb)]}},{'$project':{'_id':_0xe441e9(0xc3),'product_name':_0xe441e9(0xb6),'product_code':_0xe441e9(0x111),'quantity_available':'$sale_product.quantity','warehouse_name':_0xe441e9(0xd0),'warehouse_room':_0xe441e9(0xe3),'product_invoice':_0xe441e9(0x106),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0xe441e9(0xc1),'production_date':_0xe441e9(0xd4),'expiry_date':_0xe441e9(0xbc),'UOM':_0xe441e9(0xe2)}}]);_0x4c71b3['length']>0x0&&_0x536594['data_sales'][_0x1efa75[_0xe441e9(0xdb)]][_0xe441e9(0xf2)](..._0x4c71b3);}));})),_0x536594['data_sales']=_0x536594[_0x37b61d(0xc8)],_0x536594[_0x37b61d(0xe9)]={},await Promise[_0x37b61d(0xd2)](_0x536594['map'](async _0x2a712c=>{var _0x44f792=_0x37b61d;_0x536594['data_adjustment'][_0x2a712c[_0x44f792(0xdb)]]=[],await Promise[_0x44f792(0xd2)](_0x2a712c[_0x44f792(0xe0)][_0x44f792(0xfb)](async _0x485fee=>{var _0x455f22=_0x44f792;const _0x5051db=await adjustment_finished[_0x455f22(0xf3)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x485fee[_0x455f22(0x10c)][_0x455f22(0x112)](),'product.invoice':_0x485fee[_0x455f22(0xdb)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x455f22(0x10f),'quantity_available':_0x455f22(0xcc),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':'$product.invoice','invoice':_0x455f22(0x107),'id_transaction_from':_0x455f22(0xd1),'date':_0x455f22(0xc1),'production_date':_0x455f22(0xcd),'expiry_date':_0x455f22(0xed),'UOM':_0x455f22(0xc7)}}]);_0x5051db[_0x455f22(0xf7)]>0x0&&_0x536594['data_adjustment'][_0x2a712c['invoice']][_0x455f22(0xf2)](..._0x5051db);}));})),_0x536594['data_transfer']={},await Promise[_0x37b61d(0xd2)](_0x536594['map'](async _0x4b574d=>{var _0x390b06=_0x37b61d;_0x536594[_0x390b06(0x104)][_0x4b574d[_0x390b06(0xdb)]]=[],await Promise[_0x390b06(0xd2)](_0x4b574d[_0x390b06(0xe0)]['map'](async _0x41487d=>{var _0x56cb15=_0x390b06;const _0x870b64=await transfers_finished[_0x56cb15(0xf3)]([{'$unwind':_0x56cb15(0x10a)},{'$match':{'product.id_transaction':_0x41487d[_0x56cb15(0x10c)]['valueOf'](),'product.from_invoice':_0x41487d[_0x56cb15(0xdb)]}},{'$project':{'_id':_0x56cb15(0x10d),'product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x56cb15(0x109),'warehouse_room':_0x56cb15(0xfc),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':'$product.id_transaction','date':_0x56cb15(0xc1),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x56cb15(0xc7)}}]);_0x870b64['length']>0x0&&_0x536594[_0x56cb15(0x104)][_0x4b574d[_0x56cb15(0xdb)]]['push'](..._0x870b64);}));})),_0x47ab8a['json']({'purchases_warehouse':_0x536594,'data_sales':_0x536594['data_sales'],'data_adjustment':_0x536594[_0x37b61d(0xe9)],'data_transfer':_0x536594[_0x37b61d(0x104)]});}else{var _0x536594=await purchases_finished[_0x37b61d(0xf3)]([{'$match':{'warehouse_name':_0x5b4c5d,'date':{'$gte':_0x274e00,'$lte':_0x22b62d}}},{'$lookup':{'from':_0x37b61d(0xaa),'let':{'invoice':_0x37b61d(0x107)},'pipeline':[{'$unwind':_0x37b61d(0x113)},{'$match':{'$expr':{'$eq':[_0x37b61d(0x108),'$product_details.invoice']}}},{'$project':{'_id':_0x37b61d(0x100),'product_name':_0x37b61d(0xea),'product_code':_0x37b61d(0xb4),'quantity_available':_0x37b61d(0xae),'warehouse_name':_0x37b61d(0xf1),'warehouse_room':_0x37b61d(0xf0),'invoice':_0x37b61d(0xf5),'production_date':'$product_details.production_date','expiry_date':_0x37b61d(0x103),'UOM':_0x37b61d(0xb0)}}],'as':_0x37b61d(0xe0)}}]);_0x536594[_0x37b61d(0xc8)]={},await Promise['all'](_0x536594[_0x37b61d(0xfb)](async _0x3afef6=>{var _0x1e0bfb=_0x37b61d;_0x536594[_0x1e0bfb(0xc8)][_0x3afef6[_0x1e0bfb(0xdb)]]=[],await Promise['all'](_0x3afef6[_0x1e0bfb(0xe0)][_0x1e0bfb(0xfb)](async _0x271990=>{var _0x2fcf2e=_0x1e0bfb;const _0x13071e=await sales_finished[_0x2fcf2e(0xf3)]([{'$unwind':_0x2fcf2e(0xf9)},{'$match':{'sale_product.id_transaction_from':_0x271990[_0x2fcf2e(0x10c)]['valueOf'](),'sale_product.invoice':_0x271990[_0x2fcf2e(0xdb)]}},{'$project':{'_id':_0x2fcf2e(0xc3),'product_name':_0x2fcf2e(0xb6),'product_code':_0x2fcf2e(0x111),'quantity_available':_0x2fcf2e(0xc6),'warehouse_name':_0x2fcf2e(0xd0),'warehouse_room':_0x2fcf2e(0xe3),'product_invoice':_0x2fcf2e(0x106),'invoice':_0x2fcf2e(0x107),'id_transaction_from':_0x2fcf2e(0xb1),'date':_0x2fcf2e(0xc1),'production_date':_0x2fcf2e(0xd4),'expiry_date':_0x2fcf2e(0xbc),'UOM':'$sale_product.unit'}}]);_0x13071e[_0x2fcf2e(0xf7)]>0x0&&_0x536594[_0x2fcf2e(0xc8)][_0x3afef6[_0x2fcf2e(0xdb)]][_0x2fcf2e(0xf2)](..._0x13071e);}));})),_0x536594[_0x37b61d(0xc8)]=_0x536594[_0x37b61d(0xc8)],_0x536594['data_adjustment']={},await Promise['all'](_0x536594[_0x37b61d(0xfb)](async _0x126ce7=>{var _0x4123c2=_0x37b61d;_0x536594['data_adjustment'][_0x126ce7[_0x4123c2(0xdb)]]=[],await Promise[_0x4123c2(0xd2)](_0x126ce7['warehouse_data'][_0x4123c2(0xfb)](async _0x3ff4e6=>{var _0x34e5a2=_0x4123c2;const _0x369880=await adjustment_finished[_0x34e5a2(0xf3)]([{'$unwind':_0x34e5a2(0x10a)},{'$match':{'product.id_transaction_from':_0x3ff4e6[_0x34e5a2(0x10c)][_0x34e5a2(0x112)](),'product.invoice':_0x3ff4e6[_0x34e5a2(0xdb)]}},{'$project':{'_id':_0x34e5a2(0x10d),'product_name':_0x34e5a2(0x10b),'product_code':'$product.product_code','quantity_available':_0x34e5a2(0xcc),'warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':_0x34e5a2(0x101),'invoice':_0x34e5a2(0x107),'id_transaction_from':_0x34e5a2(0xd1),'date':_0x34e5a2(0xc1),'production_date':_0x34e5a2(0xcd),'expiry_date':_0x34e5a2(0xed),'UOM':_0x34e5a2(0xc7)}}]);_0x369880['length']>0x0&&_0x536594[_0x34e5a2(0xe9)][_0x126ce7[_0x34e5a2(0xdb)]][_0x34e5a2(0xf2)](..._0x369880);}));})),_0x536594[_0x37b61d(0x104)]={},await Promise[_0x37b61d(0xd2)](_0x536594[_0x37b61d(0xfb)](async _0x45fa8d=>{var _0x323aec=_0x37b61d;_0x536594['data_transfer'][_0x45fa8d[_0x323aec(0xdb)]]=[],await Promise['all'](_0x45fa8d[_0x323aec(0xe0)]['map'](async _0xf635fe=>{var _0x4e2b9b=_0x323aec;const _0x1f2c47=await transfers_finished[_0x4e2b9b(0xf3)]([{'$unwind':'$product'},{'$match':{'product.id_transaction':_0xf635fe['_id'][_0x4e2b9b(0x112)](),'product.from_invoice':_0xf635fe['invoice']}},{'$project':{'_id':_0x4e2b9b(0x10d),'product_name':_0x4e2b9b(0x10b),'product_code':_0x4e2b9b(0x10f),'quantity_available':'$product.to_quantity','warehouse_name':_0x4e2b9b(0x109),'warehouse_room':_0x4e2b9b(0xfc),'product_invoice':'$product.to_room_name','invoice':_0x4e2b9b(0x107),'id_transaction_from':_0x4e2b9b(0xb7),'date':_0x4e2b9b(0xc1),'production_date':_0x4e2b9b(0xcd),'expiry_date':_0x4e2b9b(0xed),'UOM':_0x4e2b9b(0xc7)}}]);_0x1f2c47[_0x4e2b9b(0xf7)]>0x0&&_0x536594[_0x4e2b9b(0x104)][_0x45fa8d[_0x4e2b9b(0xdb)]][_0x4e2b9b(0xf2)](..._0x1f2c47);}));})),_0x47ab8a[_0x37b61d(0xfe)]({'purchases_warehouse':_0x536594,'data_sales':_0x536594[_0x37b61d(0xc8)],'data_adjustment':_0x536594[_0x37b61d(0xe9)],'data_transfer':_0x536594[_0x37b61d(0x104)]});}}}),router[a0_0x3af562(0xef)](a0_0x3af562(0xe6),auth,async(_0x3be4dc,_0xce93f9)=>{var _0x33475e=a0_0x3af562;try{const _0x5376a3=_0x3be4dc[_0x33475e(0x10e)]['id'];var _0x225764=await purchases_finished[_0x33475e(0xb9)](_0x5376a3);const _0x21cfc1=await master_shop[_0x33475e(0xde)](),_0x19d8ae=_0x3be4dc[_0x33475e(0xf8)],_0x48e264=await profile[_0x33475e(0xf4)]({'email':_0x19d8ae[_0x33475e(0xbb)]});if(_0x21cfc1[0x0][_0x33475e(0xcb)]==_0x33475e(0xeb))var _0x26189c=users[_0x33475e(0xd7)];else{if(_0x21cfc1[0x0]['language']==_0x33475e(0xc0))var _0x26189c=users[_0x33475e(0xc0)];else{if(_0x21cfc1[0x0][_0x33475e(0xcb)]=='German')var _0x26189c=users[_0x33475e(0xbe)];else{if(_0x21cfc1[0x0]['language']==_0x33475e(0xfd))var _0x26189c=users[_0x33475e(0xfd)];else{if(_0x21cfc1[0x0][_0x33475e(0xcb)]==_0x33475e(0xa7))var _0x26189c=users['French'];else{if(_0x21cfc1[0x0][_0x33475e(0xcb)]==_0x33475e(0x110))var _0x26189c=users['Portuguese'];else{if(_0x21cfc1[0x0]['language']==_0x33475e(0xf6))var _0x26189c=users['Chinese'];else{if(_0x21cfc1[0x0][_0x33475e(0xcb)]==_0x33475e(0xa8))var _0x26189c=users[_0x33475e(0xd3)];}}}}}}}_0xce93f9[_0x33475e(0xa9)](_0x33475e(0xce),{'success':_0x3be4dc[_0x33475e(0xd9)](_0x33475e(0xbf)),'errors':_0x3be4dc[_0x33475e(0xd9)](_0x33475e(0xdd)),'master_shop':_0x21cfc1,'profile':_0x48e264,'role':_0x19d8ae,'language':_0x26189c,'data':_0x225764});}catch(_0x3d68cb){_0xce93f9[_0x33475e(0xfe)](_0x3d68cb);}}),router[a0_0x3af562(0xef)](a0_0x3af562(0xb2),auth,async(_0xc14da0,_0x3cc330)=>{var _0x43948b=a0_0x3af562;try{const _0x5e1c9f=_0xc14da0[_0x43948b(0x10e)]['id'];var _0xac7eac=await sales_finished['findById'](_0x5e1c9f);const _0x256057=await master_shop[_0x43948b(0xde)](),_0x197374=_0xc14da0[_0x43948b(0xf8)],_0x10feac=await profile[_0x43948b(0xf4)]({'email':_0x197374['email']});if(_0x256057[0x0][_0x43948b(0xcb)]=='English\x20(US)')var _0x333f45=users[_0x43948b(0xd7)];else{if(_0x256057[0x0][_0x43948b(0xcb)]==_0x43948b(0xc0))var _0x333f45=users[_0x43948b(0xc0)];else{if(_0x256057[0x0][_0x43948b(0xcb)]==_0x43948b(0xbe))var _0x333f45=users[_0x43948b(0xbe)];else{if(_0x256057[0x0]['language']=='Spanish')var _0x333f45=users[_0x43948b(0xfd)];else{if(_0x256057[0x0][_0x43948b(0xcb)]=='French')var _0x333f45=users[_0x43948b(0xa7)];else{if(_0x256057[0x0][_0x43948b(0xcb)]=='Portuguese\x20(BR)')var _0x333f45=users[_0x43948b(0x105)];else{if(_0x256057[0x0][_0x43948b(0xcb)]==_0x43948b(0xf6))var _0x333f45=users['Chinese'];else{if(_0x256057[0x0][_0x43948b(0xcb)]==_0x43948b(0xa8))var _0x333f45=users[_0x43948b(0xd3)];}}}}}}}_0x3cc330[_0x43948b(0xa9)](_0x43948b(0xdc),{'success':_0xc14da0[_0x43948b(0xd9)](_0x43948b(0xbf)),'errors':_0xc14da0['flash'](_0x43948b(0xdd)),'master_shop':_0x256057,'profile':_0x10feac,'role':_0x197374,'language':_0x333f45,'data':_0xac7eac});}catch(_0xf7aaad){_0x3cc330[_0x43948b(0xfe)](_0xf7aaad);}}),router[a0_0x3af562(0xef)](a0_0x3af562(0xd8),auth,async(_0x8c87fe,_0x5d24ec)=>{var _0x5deb25=a0_0x3af562;try{const _0x368d59=_0x8c87fe[_0x5deb25(0x10e)]['id'];var _0x29a4a4=await transfers_finished[_0x5deb25(0xb9)](_0x368d59);const _0x5b4e9b=await master_shop[_0x5deb25(0xde)](),_0x3434c5=_0x8c87fe[_0x5deb25(0xf8)],_0x14f86d=await profile[_0x5deb25(0xf4)]({'email':_0x3434c5[_0x5deb25(0xbb)]});if(_0x5b4e9b[0x0]['language']=='English\x20(US)')var _0x155017=users[_0x5deb25(0xd7)];else{if(_0x5b4e9b[0x0][_0x5deb25(0xcb)]==_0x5deb25(0xc0))var _0x155017=users['Hindi'];else{if(_0x5b4e9b[0x0][_0x5deb25(0xcb)]=='German')var _0x155017=users[_0x5deb25(0xbe)];else{if(_0x5b4e9b[0x0][_0x5deb25(0xcb)]==_0x5deb25(0xfd))var _0x155017=users['Spanish'];else{if(_0x5b4e9b[0x0][_0x5deb25(0xcb)]==_0x5deb25(0xa7))var _0x155017=users[_0x5deb25(0xa7)];else{if(_0x5b4e9b[0x0][_0x5deb25(0xcb)]==_0x5deb25(0x110))var _0x155017=users[_0x5deb25(0x105)];else{if(_0x5b4e9b[0x0][_0x5deb25(0xcb)]==_0x5deb25(0xf6))var _0x155017=users[_0x5deb25(0xf6)];else{if(_0x5b4e9b[0x0][_0x5deb25(0xcb)]==_0x5deb25(0xa8))var _0x155017=users[_0x5deb25(0xd3)];}}}}}}}_0x5d24ec[_0x5deb25(0xa9)](_0x5deb25(0xb5),{'success':_0x8c87fe[_0x5deb25(0xd9)](_0x5deb25(0xbf)),'errors':_0x8c87fe[_0x5deb25(0xd9)](_0x5deb25(0xdd)),'master_shop':_0x5b4e9b,'profile':_0x14f86d,'role':_0x3434c5,'language':_0x155017,'data':_0x29a4a4});}catch(_0x2e76af){_0x5d24ec['json'](_0x2e76af);}}),router[a0_0x3af562(0xef)]('/viewFG',auth,async(_0x1a1b98,_0x519ea0)=>{var _0x39a979=a0_0x3af562;try{const {username:_0x1584ce,email:_0x13c03a,role:_0x2cb7a0}=_0x1a1b98[_0x39a979(0xf8)],_0x23b5ed=_0x1a1b98[_0x39a979(0xf8)],_0xbdaefc=await profile[_0x39a979(0xf4)]({'email':_0x23b5ed[_0x39a979(0xbb)]}),_0x5eb248=await master_shop[_0x39a979(0xde)](),_0x5c47dd=await warehouse[_0x39a979(0xf3)]([{'$match':{'status':_0x39a979(0xb3),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x39a979(0xf1),'name':{'$first':_0x39a979(0xf1)}}}]);if(_0x5eb248[0x0][_0x39a979(0xcb)]==_0x39a979(0xeb))var _0x1fb45f=users[_0x39a979(0xd7)];else{if(_0x5eb248[0x0][_0x39a979(0xcb)]==_0x39a979(0xc0))var _0x1fb45f=users[_0x39a979(0xc0)];else{if(_0x5eb248[0x0][_0x39a979(0xcb)]==_0x39a979(0xbe))var _0x1fb45f=users['German'];else{if(_0x5eb248[0x0][_0x39a979(0xcb)]=='Spanish')var _0x1fb45f=users[_0x39a979(0xfd)];else{if(_0x5eb248[0x0]['language']==_0x39a979(0xa7))var _0x1fb45f=users['French'];else{if(_0x5eb248[0x0]['language']=='Portuguese\x20(BR)')var _0x1fb45f=users[_0x39a979(0x105)];else{if(_0x5eb248[0x0]['language']==_0x39a979(0xf6))var _0x1fb45f=users['Chinese'];else{if(_0x5eb248[0x0][_0x39a979(0xcb)]==_0x39a979(0xa8))var _0x1fb45f=users[_0x39a979(0xd3)];}}}}}}}_0x519ea0['render'](_0x39a979(0xaf),{'success':_0x1a1b98['flash'](_0x39a979(0xbf)),'errors':_0x1a1b98[_0x39a979(0xd9)](_0x39a979(0xdd)),'role':_0x23b5ed,'profile':_0xbdaefc,'master_shop':_0x5eb248,'dataProcess':_0x5c47dd,'language':_0x1fb45f});}catch(_0x408af1){console[_0x39a979(0xd5)](_0x408af1);}}),module['exports']=router;