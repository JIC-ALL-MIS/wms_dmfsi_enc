var a0_0x513c4e=a0_0x5f01;(function(_0x3ee77d,_0x3e09e6){var _0x7677a8=a0_0x5f01,_0x1f0541=_0x3ee77d();while(!![]){try{var _0x14fdbe=parseInt(_0x7677a8(0x8d))/0x1*(-parseInt(_0x7677a8(0x8c))/0x2)+parseInt(_0x7677a8(0xb0))/0x3+parseInt(_0x7677a8(0xcb))/0x4+-parseInt(_0x7677a8(0xa2))/0x5*(parseInt(_0x7677a8(0x6f))/0x6)+-parseInt(_0x7677a8(0xc7))/0x7*(parseInt(_0x7677a8(0xac))/0x8)+-parseInt(_0x7677a8(0xca))/0x9*(-parseInt(_0x7677a8(0x7f))/0xa)+parseInt(_0x7677a8(0xab))/0xb;if(_0x14fdbe===_0x3e09e6)break;else _0x1f0541['push'](_0x1f0541['shift']());}catch(_0x1f01fc){_0x1f0541['push'](_0x1f0541['shift']());}}}(a0_0x2e8d,0xe5b18));function a0_0x5f01(_0x4e0dc4,_0x5bb43a){var _0x2e8dcb=a0_0x2e8d();return a0_0x5f01=function(_0x5f010f,_0x3c77d5){_0x5f010f=_0x5f010f-0x6d;var _0x3892ec=_0x2e8dcb[_0x5f010f];return _0x3892ec;},a0_0x5f01(_0x4e0dc4,_0x5bb43a);}const express=require(a0_0x513c4e(0x9e)),app=express(),router=express[a0_0x513c4e(0x85)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x513c4e(0xa3)),auth=require('../middleware/auth'),users=require(a0_0x513c4e(0xb3)),nodemailer=require(a0_0x513c4e(0x86));router[a0_0x513c4e(0x89)]('/view',auth,async(_0x358887,_0x3ab145)=>{var _0x34b4f8=a0_0x513c4e;try{const {username:_0x351cb6,email:_0x31f5d0,role:_0x57cfb3}=_0x358887['user'],_0x5b7c6f=_0x358887[_0x34b4f8(0x82)],_0x325d0a=await profile['findOne']({'email':_0x5b7c6f[_0x34b4f8(0x73)]}),_0x970feb=await master_shop['find'](),_0x4f9e96=await warehouse[_0x34b4f8(0x90)]([{'$match':{'status':_0x34b4f8(0xd4),'warehouse_category':_0x34b4f8(0xc9)}},{'$group':{'_id':_0x34b4f8(0x72),'name':{'$first':_0x34b4f8(0x72)}}}]);if(_0x970feb[0x0][_0x34b4f8(0xa9)]==_0x34b4f8(0x8f))var _0x560226=users[_0x34b4f8(0xc1)];else{if(_0x970feb[0x0]['language']==_0x34b4f8(0xb4))var _0x560226=users[_0x34b4f8(0xb4)];else{if(_0x970feb[0x0][_0x34b4f8(0xa9)]==_0x34b4f8(0x7b))var _0x560226=users[_0x34b4f8(0x7b)];else{if(_0x970feb[0x0][_0x34b4f8(0xa9)]==_0x34b4f8(0x96))var _0x560226=users[_0x34b4f8(0x96)];else{if(_0x970feb[0x0]['language']==_0x34b4f8(0xd5))var _0x560226=users[_0x34b4f8(0xd5)];else{if(_0x970feb[0x0][_0x34b4f8(0xa9)]==_0x34b4f8(0xa5))var _0x560226=users[_0x34b4f8(0x6e)];else{if(_0x970feb[0x0][_0x34b4f8(0xa9)]==_0x34b4f8(0x7a))var _0x560226=users['Chinese'];else{if(_0x970feb[0x0][_0x34b4f8(0xa9)]==_0x34b4f8(0xd0))var _0x560226=users[_0x34b4f8(0x83)];}}}}}}}_0x3ab145[_0x34b4f8(0x81)](_0x34b4f8(0x98),{'success':_0x358887[_0x34b4f8(0xae)](_0x34b4f8(0xad)),'errors':_0x358887[_0x34b4f8(0xae)](_0x34b4f8(0xb7)),'role':_0x5b7c6f,'profile':_0x325d0a,'master_shop':_0x970feb,'dataProcess':_0x4f9e96,'language':_0x560226});}catch(_0x53e8eb){console[_0x34b4f8(0x78)](_0x53e8eb);}}),router[a0_0x513c4e(0x7e)]('/reports',auth,async(_0x328395,_0x16bbe8)=>{var _0x385f7c=a0_0x513c4e;const {product_category:_0x1dfe2f,transaction_category:_0x5fa02,transaction_date_from:_0x50afaa,transaction_date_to:_0x4710aa,warehouse_category:_0x14e2d1,item_code:_0x1bd0b3}=_0x328395[_0x385f7c(0x7d)];console[_0x385f7c(0x78)](_0x14e2d1);if(_0x1dfe2f=='rm'){if(_0x14e2d1=='all'){var _0x352fd5=await purchases[_0x385f7c(0x90)]([{'$match':{'date':{'$gte':_0x50afaa,'$lte':_0x4710aa}}},{'$lookup':{'from':_0x385f7c(0xaa),'let':{'invoice':_0x385f7c(0xc3)},'pipeline':[{'$unwind':_0x385f7c(0xb2)},{'$match':{'$expr':{'$eq':['$$invoice',_0x385f7c(0x99)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x385f7c(0xaf),'product_code':'$product_details.product_code','quantity_available':'$product_details.product_stock','warehouse_name':_0x385f7c(0x72),'warehouse_room':_0x385f7c(0x97),'invoice':'$product_details.invoice','production_date':_0x385f7c(0x91),'expiry_date':'$product_details.expiry_date','UOM':_0x385f7c(0x71)}}],'as':_0x385f7c(0xd6)}}]);_0x352fd5['data_sales']={},await Promise[_0x385f7c(0xa8)](_0x352fd5[_0x385f7c(0xb9)](async _0x46caac=>{var _0x2cc7f3=_0x385f7c;_0x352fd5[_0x2cc7f3(0x84)][_0x46caac[_0x2cc7f3(0x87)]]=[],await Promise['all'](_0x46caac[_0x2cc7f3(0xd6)]['map'](async _0x250fc7=>{var _0x4c344e=_0x2cc7f3;const _0xa26f17=await sales[_0x4c344e(0x90)]([{'$unwind':_0x4c344e(0x9c)},{'$match':{'sale_product.id_transaction_from':_0x250fc7[_0x4c344e(0x9d)][_0x4c344e(0x80)](),'sale_product.invoice':_0x250fc7[_0x4c344e(0x87)]}},{'$project':{'_id':_0x4c344e(0xb8),'product_name':_0x4c344e(0xc2),'product_code':_0x4c344e(0xb6),'quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x4c344e(0xd7),'product_invoice':_0x4c344e(0xc8),'invoice':'$invoice','id_transaction_from':'$sale_product.id_transaction_from','date':_0x4c344e(0xc4),'production_date':_0x4c344e(0x95),'expiry_date':'$sale_product.expiry_date','UOM':_0x4c344e(0x76)}}]);_0xa26f17[_0x4c344e(0x75)]>0x0&&_0x352fd5[_0x4c344e(0x84)][_0x46caac['invoice']][_0x4c344e(0xd1)](..._0xa26f17);}));})),_0x352fd5['data_sales']=_0x352fd5['data_sales'],_0x352fd5['data_adjustment']={},await Promise['all'](_0x352fd5[_0x385f7c(0xb9)](async _0x186673=>{var _0x2bf8ed=_0x385f7c;_0x352fd5[_0x2bf8ed(0x74)][_0x186673[_0x2bf8ed(0x87)]]=[],await Promise[_0x2bf8ed(0xa8)](_0x186673[_0x2bf8ed(0xd6)]['map'](async _0x3104d3=>{var _0x1d28b7=_0x2bf8ed;const _0x5027bc=await adjustment['aggregate']([{'$unwind':_0x1d28b7(0x9f)},{'$match':{'product.id_transaction_from':_0x3104d3[_0x1d28b7(0x9d)][_0x1d28b7(0x80)](),'product.invoice':_0x3104d3[_0x1d28b7(0x87)]}},{'$project':{'_id':_0x1d28b7(0xce),'product_name':_0x1d28b7(0x77),'product_code':'$product.product_code','quantity_available':_0x1d28b7(0x6d),'warehouse_name':_0x1d28b7(0xa4),'warehouse_room':_0x1d28b7(0xb5),'product_invoice':_0x1d28b7(0xbe),'invoice':'$invoice','id_transaction_from':_0x1d28b7(0xa0),'date':_0x1d28b7(0xc4),'production_date':_0x1d28b7(0xb1),'expiry_date':_0x1d28b7(0x79),'UOM':_0x1d28b7(0xc0)}}]);_0x5027bc[_0x1d28b7(0x75)]>0x0&&_0x352fd5['data_adjustment'][_0x186673['invoice']][_0x1d28b7(0xd1)](..._0x5027bc);}));})),_0x352fd5['data_transfer']={},await Promise['all'](_0x352fd5['map'](async _0x4958ad=>{var _0x42085d=_0x385f7c;_0x352fd5[_0x42085d(0xa1)][_0x4958ad[_0x42085d(0x87)]]=[],await Promise['all'](_0x4958ad[_0x42085d(0xd6)][_0x42085d(0xb9)](async _0x5160d0=>{var _0x2635f6=_0x42085d;const _0x538795=await transfers[_0x2635f6(0x90)]([{'$unwind':_0x2635f6(0x9f)},{'$match':{'product.id_transaction_id':_0x5160d0['_id'][_0x2635f6(0x80)](),'product.To_invoice':_0x5160d0[_0x2635f6(0x87)]}},{'$project':{'_id':_0x2635f6(0xce),'product_name':'$product.product_name','product_code':_0x2635f6(0xc5),'quantity_available':_0x2635f6(0x9b),'warehouse_name':_0x2635f6(0xbc),'warehouse_room':_0x2635f6(0xb5),'product_invoice':_0x2635f6(0xc6),'invoice':_0x2635f6(0xc3),'id_transaction_from':_0x2635f6(0x8b),'date':'$date','production_date':_0x2635f6(0xb1),'expiry_date':'$product.expiry_date','UOM':_0x2635f6(0xc0)}}]);_0x538795['length']>0x0&&_0x352fd5[_0x2635f6(0xa1)][_0x4958ad['invoice']]['push'](..._0x538795);}));})),_0x16bbe8[_0x385f7c(0x92)]({'purchases_warehouse':_0x352fd5,'data_sales':_0x352fd5['data_sales'],'data_adjustment':_0x352fd5[_0x385f7c(0x74)],'data_transfer':_0x352fd5[_0x385f7c(0xa1)]});}else{var _0x352fd5=await purchases[_0x385f7c(0x90)]([{'$match':{'warehouse_name':_0x14e2d1,'date':{'$gte':_0x50afaa,'$lte':_0x4710aa}}},{'$lookup':{'from':_0x385f7c(0xaa),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x385f7c(0xb2)},{'$match':{'$expr':{'$eq':['$$invoice',_0x385f7c(0x99)]}}},{'$project':{'_id':_0x385f7c(0xbd),'product_name':_0x385f7c(0xaf),'product_code':_0x385f7c(0x8a),'quantity_available':_0x385f7c(0x8e),'warehouse_name':_0x385f7c(0x72),'warehouse_room':'$room','invoice':_0x385f7c(0x99),'production_date':'$product_details.production_date','expiry_date':_0x385f7c(0xba),'UOM':'$product_details.unit'}}],'as':_0x385f7c(0xd6)}}]);_0x352fd5[_0x385f7c(0x84)]={},await Promise['all'](_0x352fd5['map'](async _0x475ffc=>{var _0x285f2f=_0x385f7c;_0x352fd5[_0x285f2f(0x84)][_0x475ffc[_0x285f2f(0x87)]]=[],await Promise[_0x285f2f(0xa8)](_0x475ffc[_0x285f2f(0xd6)][_0x285f2f(0xb9)](async _0x59b76b=>{var _0x288f4a=_0x285f2f;const _0x5130cb=await sales[_0x288f4a(0x90)]([{'$unwind':_0x288f4a(0x9c)},{'$match':{'sale_product.id_transaction_from':_0x59b76b['_id'][_0x288f4a(0x80)](),'sale_product.invoice':_0x59b76b[_0x288f4a(0x87)]}},{'$project':{'_id':_0x288f4a(0xb8),'product_name':'$sale_product.product_name','product_code':_0x288f4a(0xb6),'quantity_available':_0x288f4a(0xbb),'warehouse_name':'$warehouse_name','warehouse_room':_0x288f4a(0xd7),'product_invoice':_0x288f4a(0xc8),'invoice':_0x288f4a(0xc3),'id_transaction_from':_0x288f4a(0xd2),'date':'$date','production_date':'$sale_product.production_date','expiry_date':_0x288f4a(0x70),'UOM':_0x288f4a(0x76)}}]);_0x5130cb[_0x288f4a(0x75)]>0x0&&_0x352fd5[_0x288f4a(0x84)][_0x475ffc[_0x288f4a(0x87)]][_0x288f4a(0xd1)](..._0x5130cb);}));})),_0x352fd5[_0x385f7c(0x84)]=_0x352fd5[_0x385f7c(0x84)],_0x352fd5[_0x385f7c(0x74)]={},await Promise['all'](_0x352fd5[_0x385f7c(0xb9)](async _0x5cdc57=>{var _0xb8dded=_0x385f7c;_0x352fd5[_0xb8dded(0x74)][_0x5cdc57[_0xb8dded(0x87)]]=[],await Promise[_0xb8dded(0xa8)](_0x5cdc57[_0xb8dded(0xd6)][_0xb8dded(0xb9)](async _0x15bcb0=>{var _0x28338c=_0xb8dded;const _0x54b8ac=await adjustment['aggregate']([{'$unwind':_0x28338c(0x9f)},{'$match':{'product.id_transaction_from':_0x15bcb0[_0x28338c(0x9d)][_0x28338c(0x80)](),'product.invoice':_0x15bcb0[_0x28338c(0x87)]}},{'$project':{'_id':_0x28338c(0xce),'product_name':'$product.product_name','product_code':_0x28338c(0xc5),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x28338c(0xa4),'warehouse_room':_0x28338c(0xb5),'product_invoice':_0x28338c(0xbe),'invoice':_0x28338c(0xc3),'id_transaction_from':_0x28338c(0xa0),'date':'$date','production_date':_0x28338c(0xb1),'expiry_date':'$product.expiry_date','UOM':_0x28338c(0xc0)}}]);_0x54b8ac[_0x28338c(0x75)]>0x0&&_0x352fd5['data_adjustment'][_0x5cdc57[_0x28338c(0x87)]][_0x28338c(0xd1)](..._0x54b8ac);}));})),_0x352fd5[_0x385f7c(0xa1)]={},await Promise[_0x385f7c(0xa8)](_0x352fd5[_0x385f7c(0xb9)](async _0x5bb1f5=>{var _0x1f5374=_0x385f7c;_0x352fd5['data_transfer'][_0x5bb1f5[_0x1f5374(0x87)]]=[],await Promise[_0x1f5374(0xa8)](_0x5bb1f5[_0x1f5374(0xd6)][_0x1f5374(0xb9)](async _0x1e9a3c=>{var _0x2969d7=_0x1f5374;const _0x437140=await transfers[_0x2969d7(0x90)]([{'$unwind':_0x2969d7(0x9f)},{'$match':{'product.id_transaction_id':_0x1e9a3c['_id'][_0x2969d7(0x80)](),'product.To_invoice':_0x1e9a3c[_0x2969d7(0x87)]}},{'$project':{'_id':'$product._id','product_name':_0x2969d7(0x77),'product_code':'$product.product_code','quantity_available':_0x2969d7(0x9b),'warehouse_name':_0x2969d7(0xbc),'warehouse_room':_0x2969d7(0xb5),'product_invoice':_0x2969d7(0xc6),'invoice':'$invoice','id_transaction_from':_0x2969d7(0x8b),'date':_0x2969d7(0xc4),'production_date':_0x2969d7(0xb1),'expiry_date':_0x2969d7(0x79),'UOM':'$product.unit'}}]);_0x437140[_0x2969d7(0x75)]>0x0&&_0x352fd5[_0x2969d7(0xa1)][_0x5bb1f5['invoice']][_0x2969d7(0xd1)](..._0x437140);}));})),_0x16bbe8['json']({'purchases_warehouse':_0x352fd5,'data_sales':_0x352fd5[_0x385f7c(0x84)],'data_adjustment':_0x352fd5['data_adjustment'],'data_transfer':_0x352fd5['data_transfer']});}}else{if(_0x14e2d1==_0x385f7c(0xa8)){var _0x352fd5=await purchases_finished[_0x385f7c(0x90)]([{'$match':{'date':{'$gte':_0x50afaa,'$lte':_0x4710aa}}},{'$lookup':{'from':_0x385f7c(0xaa),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x385f7c(0xb2)},{'$match':{'$expr':{'$eq':[_0x385f7c(0xcf),'$product_details.invoice']}}},{'$project':{'_id':'$product_details._id','product_name':_0x385f7c(0xaf),'product_code':'$product_details.product_code','quantity_available':_0x385f7c(0x8e),'warehouse_name':'$name','warehouse_room':'$room','invoice':_0x385f7c(0x99),'production_date':'$product_details.production_date','expiry_date':'$product_details.expiry_date','UOM':_0x385f7c(0x71)}}],'as':_0x385f7c(0xd6)}}]);_0x352fd5[_0x385f7c(0x84)]={},await Promise[_0x385f7c(0xa8)](_0x352fd5[_0x385f7c(0xb9)](async _0xd00688=>{var _0x1b6ab8=_0x385f7c;_0x352fd5[_0x1b6ab8(0x84)][_0xd00688[_0x1b6ab8(0x87)]]=[],await Promise['all'](_0xd00688[_0x1b6ab8(0xd6)]['map'](async _0x29c11f=>{var _0x33c34e=_0x1b6ab8;const _0x4ae56f=await sales_finished['aggregate']([{'$unwind':_0x33c34e(0x9c)},{'$match':{'sale_product.id_transaction_from':_0x29c11f[_0x33c34e(0x9d)][_0x33c34e(0x80)](),'sale_product.invoice':_0x29c11f[_0x33c34e(0x87)]}},{'$project':{'_id':_0x33c34e(0xb8),'product_name':_0x33c34e(0xc2),'product_code':'$sale_product.product_code','quantity_available':_0x33c34e(0xbb),'warehouse_name':_0x33c34e(0xa4),'warehouse_room':_0x33c34e(0xd7),'product_invoice':_0x33c34e(0xc8),'invoice':_0x33c34e(0xc3),'id_transaction_from':_0x33c34e(0xd2),'date':_0x33c34e(0xc4),'production_date':_0x33c34e(0x95),'expiry_date':_0x33c34e(0x70),'UOM':_0x33c34e(0x76)}}]);_0x4ae56f['length']>0x0&&_0x352fd5[_0x33c34e(0x84)][_0xd00688['invoice']]['push'](..._0x4ae56f);}));})),_0x352fd5[_0x385f7c(0x84)]=_0x352fd5[_0x385f7c(0x84)],_0x352fd5[_0x385f7c(0x74)]={},await Promise['all'](_0x352fd5[_0x385f7c(0xb9)](async _0xc85554=>{var _0x7b34ca=_0x385f7c;_0x352fd5[_0x7b34ca(0x74)][_0xc85554[_0x7b34ca(0x87)]]=[],await Promise[_0x7b34ca(0xa8)](_0xc85554[_0x7b34ca(0xd6)][_0x7b34ca(0xb9)](async _0x41f461=>{var _0xa65ba5=_0x7b34ca;const _0x551c13=await adjustment_finished[_0xa65ba5(0x90)]([{'$unwind':_0xa65ba5(0x9f)},{'$match':{'product.id_transaction_from':_0x41f461[_0xa65ba5(0x9d)][_0xa65ba5(0x80)](),'product.invoice':_0x41f461['invoice']}},{'$project':{'_id':_0xa65ba5(0xce),'product_name':'$product.product_name','product_code':_0xa65ba5(0xc5),'quantity_available':_0xa65ba5(0x6d),'warehouse_name':_0xa65ba5(0xa4),'warehouse_room':_0xa65ba5(0xb5),'product_invoice':_0xa65ba5(0xbe),'invoice':_0xa65ba5(0xc3),'id_transaction_from':'$product.id_transaction_from','date':'$date','production_date':_0xa65ba5(0xb1),'expiry_date':'$product.expiry_date','UOM':_0xa65ba5(0xc0)}}]);_0x551c13[_0xa65ba5(0x75)]>0x0&&_0x352fd5[_0xa65ba5(0x74)][_0xc85554['invoice']][_0xa65ba5(0xd1)](..._0x551c13);}));})),_0x352fd5[_0x385f7c(0xa1)]={},await Promise[_0x385f7c(0xa8)](_0x352fd5[_0x385f7c(0xb9)](async _0x537f47=>{var _0x3330d2=_0x385f7c;_0x352fd5[_0x3330d2(0xa1)][_0x537f47[_0x3330d2(0x87)]]=[],await Promise[_0x3330d2(0xa8)](_0x537f47[_0x3330d2(0xd6)][_0x3330d2(0xb9)](async _0x4f7248=>{var _0x5652e6=_0x3330d2;const _0x3f0211=await transfers_finished[_0x5652e6(0x90)]([{'$unwind':_0x5652e6(0x9f)},{'$match':{'product.id_transaction':_0x4f7248['_id']['valueOf'](),'product.from_invoice':_0x4f7248[_0x5652e6(0x87)]}},{'$project':{'_id':_0x5652e6(0xce),'product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':_0x5652e6(0x9b),'warehouse_name':_0x5652e6(0xbc),'warehouse_room':_0x5652e6(0xb5),'product_invoice':_0x5652e6(0xc6),'invoice':_0x5652e6(0xc3),'id_transaction_from':_0x5652e6(0x9a),'date':_0x5652e6(0xc4),'production_date':_0x5652e6(0xb1),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x3f0211[_0x5652e6(0x75)]>0x0&&_0x352fd5[_0x5652e6(0xa1)][_0x537f47[_0x5652e6(0x87)]][_0x5652e6(0xd1)](..._0x3f0211);}));})),_0x16bbe8[_0x385f7c(0x92)]({'purchases_warehouse':_0x352fd5,'data_sales':_0x352fd5['data_sales'],'data_adjustment':_0x352fd5[_0x385f7c(0x74)],'data_transfer':_0x352fd5[_0x385f7c(0xa1)]});}else{var _0x352fd5=await purchases_finished[_0x385f7c(0x90)]([{'$match':{'warehouse_name':_0x14e2d1,'date':{'$gte':_0x50afaa,'$lte':_0x4710aa}}},{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x385f7c(0xb2)},{'$match':{'$expr':{'$eq':['$$invoice','$product_details.invoice']}}},{'$project':{'_id':_0x385f7c(0xbd),'product_name':_0x385f7c(0xaf),'product_code':_0x385f7c(0x8a),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':'$room','invoice':'$product_details.invoice','production_date':_0x385f7c(0x91),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':'warehouse_data'}}]);_0x352fd5[_0x385f7c(0x84)]={},await Promise[_0x385f7c(0xa8)](_0x352fd5[_0x385f7c(0xb9)](async _0x3850fe=>{var _0x1dc4da=_0x385f7c;_0x352fd5[_0x1dc4da(0x84)][_0x3850fe[_0x1dc4da(0x87)]]=[],await Promise['all'](_0x3850fe[_0x1dc4da(0xd6)][_0x1dc4da(0xb9)](async _0x30f0ec=>{var _0x5e3649=_0x1dc4da;const _0x57f175=await sales_finished[_0x5e3649(0x90)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x30f0ec[_0x5e3649(0x9d)]['valueOf'](),'sale_product.invoice':_0x30f0ec[_0x5e3649(0x87)]}},{'$project':{'_id':_0x5e3649(0xb8),'product_name':_0x5e3649(0xc2),'product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':'$warehouse_name','warehouse_room':_0x5e3649(0xd7),'product_invoice':_0x5e3649(0xc8),'invoice':_0x5e3649(0xc3),'id_transaction_from':_0x5e3649(0xd2),'date':_0x5e3649(0xc4),'production_date':_0x5e3649(0x95),'expiry_date':_0x5e3649(0x70),'UOM':_0x5e3649(0x76)}}]);_0x57f175[_0x5e3649(0x75)]>0x0&&_0x352fd5[_0x5e3649(0x84)][_0x3850fe[_0x5e3649(0x87)]][_0x5e3649(0xd1)](..._0x57f175);}));})),_0x352fd5['data_sales']=_0x352fd5['data_sales'],_0x352fd5[_0x385f7c(0x74)]={},await Promise['all'](_0x352fd5[_0x385f7c(0xb9)](async _0x1c4f9a=>{var _0xbbaa64=_0x385f7c;_0x352fd5[_0xbbaa64(0x74)][_0x1c4f9a[_0xbbaa64(0x87)]]=[],await Promise['all'](_0x1c4f9a[_0xbbaa64(0xd6)][_0xbbaa64(0xb9)](async _0x45f20f=>{var _0x159c05=_0xbbaa64;const _0x42ce83=await adjustment_finished['aggregate']([{'$unwind':_0x159c05(0x9f)},{'$match':{'product.id_transaction_from':_0x45f20f[_0x159c05(0x9d)][_0x159c05(0x80)](),'product.invoice':_0x45f20f[_0x159c05(0x87)]}},{'$project':{'_id':_0x159c05(0xce),'product_name':_0x159c05(0x77),'product_code':'$product.product_code','quantity_available':_0x159c05(0x6d),'warehouse_name':_0x159c05(0xa4),'warehouse_room':_0x159c05(0xb5),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':_0x159c05(0xa0),'date':_0x159c05(0xc4),'production_date':_0x159c05(0xb1),'expiry_date':_0x159c05(0x79),'UOM':_0x159c05(0xc0)}}]);_0x42ce83['length']>0x0&&_0x352fd5[_0x159c05(0x74)][_0x1c4f9a['invoice']][_0x159c05(0xd1)](..._0x42ce83);}));})),_0x352fd5[_0x385f7c(0xa1)]={},await Promise[_0x385f7c(0xa8)](_0x352fd5[_0x385f7c(0xb9)](async _0xa975aa=>{var _0x427685=_0x385f7c;_0x352fd5['data_transfer'][_0xa975aa[_0x427685(0x87)]]=[],await Promise['all'](_0xa975aa[_0x427685(0xd6)]['map'](async _0x1460b3=>{var _0x462b2c=_0x427685;const _0x4a6aa7=await transfers_finished[_0x462b2c(0x90)]([{'$unwind':_0x462b2c(0x9f)},{'$match':{'product.id_transaction':_0x1460b3[_0x462b2c(0x9d)]['valueOf'](),'product.from_invoice':_0x1460b3[_0x462b2c(0x87)]}},{'$project':{'_id':'$product._id','product_name':_0x462b2c(0x77),'product_code':_0x462b2c(0xc5),'quantity_available':'$product.to_quantity','warehouse_name':_0x462b2c(0xbc),'warehouse_room':_0x462b2c(0xb5),'product_invoice':'$product.to_room_name','invoice':_0x462b2c(0xc3),'id_transaction_from':_0x462b2c(0x9a),'date':_0x462b2c(0xc4),'production_date':_0x462b2c(0xb1),'expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x4a6aa7[_0x462b2c(0x75)]>0x0&&_0x352fd5['data_transfer'][_0xa975aa[_0x462b2c(0x87)]]['push'](..._0x4a6aa7);}));})),_0x16bbe8[_0x385f7c(0x92)]({'purchases_warehouse':_0x352fd5,'data_sales':_0x352fd5[_0x385f7c(0x84)],'data_adjustment':_0x352fd5[_0x385f7c(0x74)],'data_transfer':_0x352fd5[_0x385f7c(0xa1)]});}}}),router[a0_0x513c4e(0x89)](a0_0x513c4e(0x93),auth,async(_0x3b00b0,_0x101551)=>{var _0x391feb=a0_0x513c4e;try{const _0x33f864=_0x3b00b0[_0x391feb(0x7c)]['id'];var _0x27b209=await purchases_finished['findById'](_0x33f864);const _0x1f865a=await master_shop[_0x391feb(0xcc)](),_0xd05c0d=_0x3b00b0[_0x391feb(0x82)],_0x3b0cfd=await profile[_0x391feb(0xbf)]({'email':_0xd05c0d['email']});if(_0x1f865a[0x0][_0x391feb(0xa9)]==_0x391feb(0x8f))var _0x42af37=users[_0x391feb(0xc1)];else{if(_0x1f865a[0x0][_0x391feb(0xa9)]==_0x391feb(0xb4))var _0x42af37=users['Hindi'];else{if(_0x1f865a[0x0][_0x391feb(0xa9)]==_0x391feb(0x7b))var _0x42af37=users[_0x391feb(0x7b)];else{if(_0x1f865a[0x0]['language']==_0x391feb(0x96))var _0x42af37=users[_0x391feb(0x96)];else{if(_0x1f865a[0x0]['language']==_0x391feb(0xd5))var _0x42af37=users[_0x391feb(0xd5)];else{if(_0x1f865a[0x0][_0x391feb(0xa9)]==_0x391feb(0xa5))var _0x42af37=users['Portuguese'];else{if(_0x1f865a[0x0]['language']=='Chinese')var _0x42af37=users[_0x391feb(0x7a)];else{if(_0x1f865a[0x0][_0x391feb(0xa9)]==_0x391feb(0xd0))var _0x42af37=users[_0x391feb(0x83)];}}}}}}}_0x101551[_0x391feb(0x81)](_0x391feb(0x88),{'success':_0x3b00b0[_0x391feb(0xae)](_0x391feb(0xad)),'errors':_0x3b00b0[_0x391feb(0xae)](_0x391feb(0xb7)),'master_shop':_0x1f865a,'profile':_0x3b0cfd,'role':_0xd05c0d,'language':_0x42af37,'data':_0x27b209});}catch(_0x3a4e6f){_0x101551[_0x391feb(0x92)](_0x3a4e6f);}}),router['get']('/viewdata_og_fg/:id',auth,async(_0x5389c7,_0x25d8db)=>{var _0x4943ad=a0_0x513c4e;try{const _0x33cab8=_0x5389c7[_0x4943ad(0x7c)]['id'];var _0x3fa61a=await sales_finished[_0x4943ad(0x94)](_0x33cab8);const _0x5287b2=await master_shop[_0x4943ad(0xcc)](),_0x56ef03=_0x5389c7[_0x4943ad(0x82)],_0x93f3c3=await profile['findOne']({'email':_0x56ef03[_0x4943ad(0x73)]});if(_0x5287b2[0x0][_0x4943ad(0xa9)]=='English\x20(US)')var _0x4e95e6=users[_0x4943ad(0xc1)];else{if(_0x5287b2[0x0][_0x4943ad(0xa9)]==_0x4943ad(0xb4))var _0x4e95e6=users[_0x4943ad(0xb4)];else{if(_0x5287b2[0x0][_0x4943ad(0xa9)]==_0x4943ad(0x7b))var _0x4e95e6=users[_0x4943ad(0x7b)];else{if(_0x5287b2[0x0]['language']==_0x4943ad(0x96))var _0x4e95e6=users[_0x4943ad(0x96)];else{if(_0x5287b2[0x0]['language']==_0x4943ad(0xd5))var _0x4e95e6=users['French'];else{if(_0x5287b2[0x0][_0x4943ad(0xa9)]=='Portuguese\x20(BR)')var _0x4e95e6=users[_0x4943ad(0x6e)];else{if(_0x5287b2[0x0]['language']==_0x4943ad(0x7a))var _0x4e95e6=users['Chinese'];else{if(_0x5287b2[0x0][_0x4943ad(0xa9)]=='Arabic\x20(ae)')var _0x4e95e6=users['Arabic'];}}}}}}}_0x25d8db[_0x4943ad(0x81)](_0x4943ad(0xa6),{'success':_0x5389c7[_0x4943ad(0xae)](_0x4943ad(0xad)),'errors':_0x5389c7[_0x4943ad(0xae)](_0x4943ad(0xb7)),'master_shop':_0x5287b2,'profile':_0x93f3c3,'role':_0x56ef03,'language':_0x4e95e6,'data':_0x3fa61a});}catch(_0x3ac272){_0x25d8db[_0x4943ad(0x92)](_0x3ac272);}}),router[a0_0x513c4e(0x89)](a0_0x513c4e(0xcd),auth,async(_0x5f14b1,_0x47a4fe)=>{var _0x1e0fcf=a0_0x513c4e;try{const _0x1b31d7=_0x5f14b1[_0x1e0fcf(0x7c)]['id'];var _0x596c73=await transfers_finished[_0x1e0fcf(0x94)](_0x1b31d7);const _0x83bb38=await master_shop[_0x1e0fcf(0xcc)](),_0x47d076=_0x5f14b1[_0x1e0fcf(0x82)],_0x3fb008=await profile[_0x1e0fcf(0xbf)]({'email':_0x47d076['email']});if(_0x83bb38[0x0][_0x1e0fcf(0xa9)]=='English\x20(US)')var _0x2e834d=users[_0x1e0fcf(0xc1)];else{if(_0x83bb38[0x0]['language']==_0x1e0fcf(0xb4))var _0x2e834d=users['Hindi'];else{if(_0x83bb38[0x0][_0x1e0fcf(0xa9)]==_0x1e0fcf(0x7b))var _0x2e834d=users[_0x1e0fcf(0x7b)];else{if(_0x83bb38[0x0][_0x1e0fcf(0xa9)]==_0x1e0fcf(0x96))var _0x2e834d=users[_0x1e0fcf(0x96)];else{if(_0x83bb38[0x0][_0x1e0fcf(0xa9)]==_0x1e0fcf(0xd5))var _0x2e834d=users[_0x1e0fcf(0xd5)];else{if(_0x83bb38[0x0]['language']==_0x1e0fcf(0xa5))var _0x2e834d=users[_0x1e0fcf(0x6e)];else{if(_0x83bb38[0x0]['language']==_0x1e0fcf(0x7a))var _0x2e834d=users[_0x1e0fcf(0x7a)];else{if(_0x83bb38[0x0][_0x1e0fcf(0xa9)]==_0x1e0fcf(0xd0))var _0x2e834d=users['Arabic'];}}}}}}}_0x47a4fe[_0x1e0fcf(0x81)](_0x1e0fcf(0xa7),{'success':_0x5f14b1[_0x1e0fcf(0xae)](_0x1e0fcf(0xad)),'errors':_0x5f14b1[_0x1e0fcf(0xae)](_0x1e0fcf(0xb7)),'master_shop':_0x83bb38,'profile':_0x3fb008,'role':_0x47d076,'language':_0x2e834d,'data':_0x596c73});}catch(_0x2a07b4){_0x47a4fe[_0x1e0fcf(0x92)](_0x2a07b4);}}),router['get']('/viewFG',auth,async(_0x4a06d7,_0x429e58)=>{var _0xe25373=a0_0x513c4e;try{const {username:_0x532eba,email:_0x394e55,role:_0x3024a9}=_0x4a06d7[_0xe25373(0x82)],_0xce6337=_0x4a06d7[_0xe25373(0x82)],_0x4a731e=await profile['findOne']({'email':_0xce6337[_0xe25373(0x73)]}),_0x594313=await master_shop[_0xe25373(0xcc)](),_0x4c76ba=await warehouse[_0xe25373(0x90)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0xe25373(0x72),'name':{'$first':_0xe25373(0x72)}}}]);if(_0x594313[0x0][_0xe25373(0xa9)]==_0xe25373(0x8f))var _0x346c3c=users[_0xe25373(0xc1)];else{if(_0x594313[0x0][_0xe25373(0xa9)]==_0xe25373(0xb4))var _0x346c3c=users[_0xe25373(0xb4)];else{if(_0x594313[0x0][_0xe25373(0xa9)]=='German')var _0x346c3c=users[_0xe25373(0x7b)];else{if(_0x594313[0x0]['language']==_0xe25373(0x96))var _0x346c3c=users[_0xe25373(0x96)];else{if(_0x594313[0x0][_0xe25373(0xa9)]=='French')var _0x346c3c=users[_0xe25373(0xd5)];else{if(_0x594313[0x0][_0xe25373(0xa9)]=='Portuguese\x20(BR)')var _0x346c3c=users[_0xe25373(0x6e)];else{if(_0x594313[0x0][_0xe25373(0xa9)]==_0xe25373(0x7a))var _0x346c3c=users[_0xe25373(0x7a)];else{if(_0x594313[0x0][_0xe25373(0xa9)]=='Arabic\x20(ae)')var _0x346c3c=users[_0xe25373(0x83)];}}}}}}}_0x429e58[_0xe25373(0x81)](_0xe25373(0xd3),{'success':_0x4a06d7[_0xe25373(0xae)](_0xe25373(0xad)),'errors':_0x4a06d7[_0xe25373(0xae)](_0xe25373(0xb7)),'role':_0xce6337,'profile':_0x4a731e,'master_shop':_0x594313,'dataProcess':_0x4c76ba,'language':_0x346c3c});}catch(_0x3a0163){console['log'](_0x3a0163);}}),module['exports']=router;function a0_0x2e8d(){var _0x61739d=['Hindi','$product.room_names','$sale_product.product_code','errors','$sale_product._id','map','$product_details.expiry_date','$sale_product.quantity','$to_warehouse','$product_details._id','$product.invoice','findOne','$product.unit','English','$sale_product.product_name','$invoice','$date','$product.product_code','$product.to_room_name','329OASUym','$sale_product.invoice','Finished\x20Goods','13788567kBqDYJ','6867836lzZcYj','find','/viewdata_tf_fg/:id','$product._id','$$invoice','Arabic\x20(ae)','push','$sale_product.id_transaction_from','transaction_finished_raw','Enabled','French','warehouse_data','$sale_product.room_name','$product.new_adjust_qty','Portuguese','56202eqxdht','$sale_product.expiry_date','$product_details.unit','$name','email','data_adjustment','length','$sale_product.unit','$product.product_name','log','$product.expiry_date','Chinese','German','params','body','post','10itmkBk','valueOf','render','user','Arabic','data_sales','Router','nodemailer','invoice','view_table','get','$product_details.product_code','$product.id_transaction_id','302zPNnyV','9353IhbmHq','$product_details.product_stock','English\x20(US)','aggregate','$product_details.production_date','json','/viewdata_inc_fg/:id','findById','$sale_product.production_date','Spanish','$room','transaction_finished','$product_details.invoice','$product.id_transaction','$product.to_quantity','$sale_product','_id','express','$product','$product.id_transaction_from','data_transfer','385QnbJas','../models/all_models','$warehouse_name','Portuguese\x20(BR)','view_og_table','view_tf_table','all','language','warehouses','9586687hZjWOu','317336awCsPs','success','flash','$product_details.product_name','2454588gHhrWS','$product.production_date','$product_details','../public/language/languages.json'];a0_0x2e8d=function(){return _0x61739d;};return a0_0x2e8d();}