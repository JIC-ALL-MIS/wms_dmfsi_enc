var a0_0x25749b=a0_0x4a9c;(function(_0x42169d,_0x3b866e){var _0x6c0c87=a0_0x4a9c,_0x2f464e=_0x42169d();while(!![]){try{var _0x52fd21=parseInt(_0x6c0c87(0x1b4))/0x1+parseInt(_0x6c0c87(0x1eb))/0x2+-parseInt(_0x6c0c87(0x1b0))/0x3+parseInt(_0x6c0c87(0x1ba))/0x4+parseInt(_0x6c0c87(0x19d))/0x5+parseInt(_0x6c0c87(0x180))/0x6+parseInt(_0x6c0c87(0x19f))/0x7*(-parseInt(_0x6c0c87(0x197))/0x8);if(_0x52fd21===_0x3b866e)break;else _0x2f464e['push'](_0x2f464e['shift']());}catch(_0x5452bc){_0x2f464e['push'](_0x2f464e['shift']());}}}(a0_0x25d0,0x4c9e7));function a0_0x25d0(){var _0x4fb864=['$sale_product._id','nodemailer','body','English','_id','$product._id','$date','warehouses','data_sales','../models/all_models','view_og_table','$product.expiry_date','$to_warehouse','push','invoice','$product.quantity','/reports','$product.product_name','data_transfer','$name','/viewFG','post','$product_details.product_stock','json','$product.secondary_unit','get','user','$$invoice','findById','$sale_product.quantity','/view','Chinese','English\x20(US)','log','698206KuTvFq','$product.production_date','1859724KdeXLw','all','$product_details.production_date','flash','$warehouse_name','$sale_product.unit','Finished\x20Goods','Enabled','$product.id_transaction_from','French','$sale_product.product_code','INCF-95558079','../public/language/languages.json','/viewdata_inc_fg/:id','$product.invoice','$sale_product.id_transaction_from','German','Arabic','$product_details.unit','$product_details.product_name','transaction_finished_raw','Portuguese','aggregate','12184BzucMf','length','Spanish','$sale_product.product_name','/viewdata_og_fg/:id','$product','574250KuVuFv','$product_details.expiry_date','4151zPvpzb','view_table','$sale_product.expiry_date','$sale_product.invoice','$product.unit','render','Portuguese\x20(BR)','$product.new_adjust_qty','$product_details.invoice','Hindi','$product_details._id','$sale_product','find','Arabic\x20(ae)','findOne','$product.room_names','$room','1549278yvfoTa','$invoice','$sale_product.room_name','warehouse_data','491418LiNzKV','$product.id_transaction_id','$product_details','exports','map','$product_details.product_code','1872284BGouqZ','$sale_product.production_date','success','$product.product_code','view_tf_table','/viewdata_tf_fg/:id','data_adjustment','language','email','$product.to_quantity','../middleware/auth','errors','$product.id_transaction','valueOf','$product.to_room_name'];a0_0x25d0=function(){return _0x4fb864;};return a0_0x25d0();}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x25749b(0x1d2)),auth=require(a0_0x25749b(0x1c4)),users=require(a0_0x25749b(0x18c)),nodemailer=require(a0_0x25749b(0x1ca));function a0_0x4a9c(_0x57b0f6,_0xdd0421){var _0x25d026=a0_0x25d0();return a0_0x4a9c=function(_0x4a9c8a,_0x411348){_0x4a9c8a=_0x4a9c8a-0x17f;var _0x5cecc0=_0x25d026[_0x4a9c8a];return _0x5cecc0;},a0_0x4a9c(_0x57b0f6,_0xdd0421);}router[a0_0x25749b(0x1e2)](a0_0x25749b(0x1e7),auth,async(_0x51b459,_0x26be0)=>{var _0x54495d=a0_0x25749b;try{const {username:_0x12dbd5,email:_0x58f8f8,role:_0x583a6b}=_0x51b459[_0x54495d(0x1e3)],_0x5d969d=_0x51b459[_0x54495d(0x1e3)],_0x545f45=await profile[_0x54495d(0x1ad)]({'email':_0x5d969d[_0x54495d(0x1c2)]}),_0x4d4726=await master_shop[_0x54495d(0x1ab)](),_0x1cea1c=await warehouse[_0x54495d(0x196)]([{'$match':{'status':_0x54495d(0x187),'warehouse_category':_0x54495d(0x186)}},{'$group':{'_id':_0x54495d(0x1dc),'name':{'$first':'$name'}}}]);if(_0x4d4726[0x0]['language']==_0x54495d(0x1e9))var _0x52ee9=users[_0x54495d(0x1cc)];else{if(_0x4d4726[0x0][_0x54495d(0x1c1)]==_0x54495d(0x1a8))var _0x52ee9=users['Hindi'];else{if(_0x4d4726[0x0][_0x54495d(0x1c1)]=='German')var _0x52ee9=users[_0x54495d(0x190)];else{if(_0x4d4726[0x0][_0x54495d(0x1c1)]==_0x54495d(0x199))var _0x52ee9=users[_0x54495d(0x199)];else{if(_0x4d4726[0x0][_0x54495d(0x1c1)]==_0x54495d(0x189))var _0x52ee9=users[_0x54495d(0x189)];else{if(_0x4d4726[0x0][_0x54495d(0x1c1)]==_0x54495d(0x1a5))var _0x52ee9=users['Portuguese'];else{if(_0x4d4726[0x0][_0x54495d(0x1c1)]==_0x54495d(0x1e8))var _0x52ee9=users['Chinese'];else{if(_0x4d4726[0x0][_0x54495d(0x1c1)]==_0x54495d(0x1ac))var _0x52ee9=users['Arabic'];}}}}}}}_0x26be0[_0x54495d(0x1a4)]('transaction_finished',{'success':_0x51b459['flash'](_0x54495d(0x1bc)),'errors':_0x51b459[_0x54495d(0x183)]('errors'),'role':_0x5d969d,'profile':_0x545f45,'master_shop':_0x4d4726,'dataProcess':_0x1cea1c,'language':_0x52ee9});}catch(_0x3dabee){console[_0x54495d(0x1ea)](_0x3dabee);}}),router[a0_0x25749b(0x1e2)](a0_0x25749b(0x1d9),async(_0x3ab618,_0x2b8c0d)=>{var _0xd3c828=a0_0x25749b;try{var _0x6837a9='',_0x3cf411=await purchases_finished[_0xd3c828(0x196)]([{'$match':{'invoice':_0xd3c828(0x18b)}},{'$unwind':_0xd3c828(0x19c)},{'$group':{'_id':{'item_code':_0xd3c828(0x1bd),'item_description':_0xd3c828(0x1da),'production_date':_0xd3c828(0x17f),'expiry_date':_0xd3c828(0x1d4)},'totalQty':{'$sum':_0xd3c828(0x1d8)},'unit':{'$first':'$product.standard_unit'},'secondary_unit':{'$first':_0xd3c828(0x1e1)}}}]);_0x2b8c0d[_0xd3c828(0x1e0)](_0x3cf411);}catch(_0x8fd4dc){_0x2b8c0d[_0xd3c828(0x1e0)](_0x8fd4dc);}}),router[a0_0x25749b(0x1de)](a0_0x25749b(0x1d9),auth,async(_0x3b27c0,_0x52cef2)=>{var _0x25dee6=a0_0x25749b;const {product_category:_0x26e7b8,transaction_category:_0x251ea8,transaction_date_from:_0x2a543a,transaction_date_to:_0x479a08,warehouse_category:_0x461e49,item_code:_0x28e0b7}=_0x3b27c0[_0x25dee6(0x1cb)];console[_0x25dee6(0x1ea)](_0x461e49);if(_0x26e7b8=='rm'){if(_0x461e49==_0x25dee6(0x181)){var _0xdfcccc=await purchases[_0x25dee6(0x196)]([{'$match':{'date':{'$gte':_0x2a543a,'$lte':_0x479a08}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x25dee6(0x1b1)},'pipeline':[{'$unwind':_0x25dee6(0x1b6)},{'$match':{'$expr':{'$eq':['$$invoice',_0x25dee6(0x1a7)]}}},{'$project':{'_id':_0x25dee6(0x1a9),'product_name':_0x25dee6(0x193),'product_code':_0x25dee6(0x1b9),'quantity_available':_0x25dee6(0x1df),'warehouse_name':_0x25dee6(0x1dc),'warehouse_room':_0x25dee6(0x1af),'invoice':_0x25dee6(0x1a7),'production_date':'$product_details.production_date','expiry_date':_0x25dee6(0x19e),'UOM':_0x25dee6(0x192)}}],'as':_0x25dee6(0x1b3)}}]);_0xdfcccc[_0x25dee6(0x1d1)]={},await Promise['all'](_0xdfcccc[_0x25dee6(0x1b8)](async _0x19d15f=>{var _0x498918=_0x25dee6;_0xdfcccc[_0x498918(0x1d1)][_0x19d15f[_0x498918(0x1d7)]]=[],await Promise[_0x498918(0x181)](_0x19d15f[_0x498918(0x1b3)][_0x498918(0x1b8)](async _0x24143a=>{var _0x51a55e=_0x498918;const _0x3accd4=await sales[_0x51a55e(0x196)]([{'$unwind':_0x51a55e(0x1aa)},{'$match':{'sale_product.id_transaction_from':_0x24143a[_0x51a55e(0x1cd)][_0x51a55e(0x1c7)](),'sale_product.invoice':_0x24143a[_0x51a55e(0x1d7)]}},{'$project':{'_id':_0x51a55e(0x1c9),'product_name':_0x51a55e(0x19a),'product_code':'$sale_product.product_code','quantity_available':_0x51a55e(0x1e6),'warehouse_name':_0x51a55e(0x184),'warehouse_room':'$sale_product.room_name','product_invoice':_0x51a55e(0x1a2),'invoice':_0x51a55e(0x1b1),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x51a55e(0x1cf),'production_date':_0x51a55e(0x1bb),'expiry_date':'$sale_product.expiry_date','UOM':_0x51a55e(0x185)}}]);_0x3accd4['length']>0x0&&_0xdfcccc['data_sales'][_0x19d15f['invoice']][_0x51a55e(0x1d6)](..._0x3accd4);}));})),_0xdfcccc[_0x25dee6(0x1d1)]=_0xdfcccc[_0x25dee6(0x1d1)],_0xdfcccc['data_adjustment']={},await Promise[_0x25dee6(0x181)](_0xdfcccc[_0x25dee6(0x1b8)](async _0x205f1b=>{var _0x3809c4=_0x25dee6;_0xdfcccc[_0x3809c4(0x1c0)][_0x205f1b['invoice']]=[],await Promise['all'](_0x205f1b['warehouse_data'][_0x3809c4(0x1b8)](async _0x3c49f0=>{var _0x2bd72a=_0x3809c4;const _0x2b4528=await adjustment[_0x2bd72a(0x196)]([{'$unwind':_0x2bd72a(0x19c)},{'$match':{'product.id_transaction_from':_0x3c49f0[_0x2bd72a(0x1cd)][_0x2bd72a(0x1c7)](),'product.invoice':_0x3c49f0[_0x2bd72a(0x1d7)]}},{'$project':{'_id':_0x2bd72a(0x1ce),'product_name':_0x2bd72a(0x1da),'product_code':_0x2bd72a(0x1bd),'quantity_available':_0x2bd72a(0x1a6),'warehouse_name':_0x2bd72a(0x184),'warehouse_room':_0x2bd72a(0x1ae),'product_invoice':_0x2bd72a(0x18e),'invoice':_0x2bd72a(0x1b1),'id_transaction_from':_0x2bd72a(0x188),'date':_0x2bd72a(0x1cf),'production_date':_0x2bd72a(0x17f),'expiry_date':_0x2bd72a(0x1d4),'UOM':_0x2bd72a(0x1a3)}}]);_0x2b4528['length']>0x0&&_0xdfcccc[_0x2bd72a(0x1c0)][_0x205f1b['invoice']][_0x2bd72a(0x1d6)](..._0x2b4528);}));})),_0xdfcccc[_0x25dee6(0x1db)]={},await Promise[_0x25dee6(0x181)](_0xdfcccc['map'](async _0x42f616=>{var _0x3b5bca=_0x25dee6;_0xdfcccc[_0x3b5bca(0x1db)][_0x42f616[_0x3b5bca(0x1d7)]]=[],await Promise[_0x3b5bca(0x181)](_0x42f616[_0x3b5bca(0x1b3)][_0x3b5bca(0x1b8)](async _0x5de320=>{var _0x55fc16=_0x3b5bca;const _0x4012f6=await transfers[_0x55fc16(0x196)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_id':_0x5de320[_0x55fc16(0x1cd)][_0x55fc16(0x1c7)](),'product.To_invoice':_0x5de320[_0x55fc16(0x1d7)]}},{'$project':{'_id':_0x55fc16(0x1ce),'product_name':_0x55fc16(0x1da),'product_code':'$product.product_code','quantity_available':_0x55fc16(0x1c3),'warehouse_name':'$to_warehouse','warehouse_room':_0x55fc16(0x1ae),'product_invoice':_0x55fc16(0x1c8),'invoice':_0x55fc16(0x1b1),'id_transaction_from':_0x55fc16(0x1b5),'date':_0x55fc16(0x1cf),'production_date':'$product.production_date','expiry_date':_0x55fc16(0x1d4),'UOM':_0x55fc16(0x1a3)}}]);_0x4012f6[_0x55fc16(0x198)]>0x0&&_0xdfcccc[_0x55fc16(0x1db)][_0x42f616[_0x55fc16(0x1d7)]][_0x55fc16(0x1d6)](..._0x4012f6);}));})),_0x52cef2['json']({'purchases_warehouse':_0xdfcccc,'data_sales':_0xdfcccc['data_sales'],'data_adjustment':_0xdfcccc[_0x25dee6(0x1c0)],'data_transfer':_0xdfcccc['data_transfer']});}else{var _0xdfcccc=await purchases[_0x25dee6(0x196)]([{'$match':{'warehouse_name':_0x461e49,'date':{'$gte':_0x2a543a,'$lte':_0x479a08}}},{'$lookup':{'from':_0x25dee6(0x1d0),'let':{'invoice':_0x25dee6(0x1b1)},'pipeline':[{'$unwind':_0x25dee6(0x1b6)},{'$match':{'$expr':{'$eq':[_0x25dee6(0x1e4),_0x25dee6(0x1a7)]}}},{'$project':{'_id':_0x25dee6(0x1a9),'product_name':_0x25dee6(0x193),'product_code':_0x25dee6(0x1b9),'quantity_available':_0x25dee6(0x1df),'warehouse_name':'$name','warehouse_room':'$room','invoice':'$product_details.invoice','production_date':_0x25dee6(0x182),'expiry_date':_0x25dee6(0x19e),'UOM':_0x25dee6(0x192)}}],'as':_0x25dee6(0x1b3)}}]);_0xdfcccc[_0x25dee6(0x1d1)]={},await Promise[_0x25dee6(0x181)](_0xdfcccc[_0x25dee6(0x1b8)](async _0x353ef7=>{var _0x5ac937=_0x25dee6;_0xdfcccc[_0x5ac937(0x1d1)][_0x353ef7[_0x5ac937(0x1d7)]]=[],await Promise[_0x5ac937(0x181)](_0x353ef7[_0x5ac937(0x1b3)][_0x5ac937(0x1b8)](async _0x3a1294=>{var _0x3d0efb=_0x5ac937;const _0x4c7895=await sales['aggregate']([{'$unwind':_0x3d0efb(0x1aa)},{'$match':{'sale_product.id_transaction_from':_0x3a1294[_0x3d0efb(0x1cd)]['valueOf'](),'sale_product.invoice':_0x3a1294[_0x3d0efb(0x1d7)]}},{'$project':{'_id':_0x3d0efb(0x1c9),'product_name':_0x3d0efb(0x19a),'product_code':_0x3d0efb(0x18a),'quantity_available':_0x3d0efb(0x1e6),'warehouse_name':_0x3d0efb(0x184),'warehouse_room':'$sale_product.room_name','product_invoice':'$sale_product.invoice','invoice':_0x3d0efb(0x1b1),'id_transaction_from':_0x3d0efb(0x18f),'date':_0x3d0efb(0x1cf),'production_date':_0x3d0efb(0x1bb),'expiry_date':_0x3d0efb(0x1a1),'UOM':_0x3d0efb(0x185)}}]);_0x4c7895['length']>0x0&&_0xdfcccc[_0x3d0efb(0x1d1)][_0x353ef7[_0x3d0efb(0x1d7)]][_0x3d0efb(0x1d6)](..._0x4c7895);}));})),_0xdfcccc['data_sales']=_0xdfcccc[_0x25dee6(0x1d1)],_0xdfcccc[_0x25dee6(0x1c0)]={},await Promise[_0x25dee6(0x181)](_0xdfcccc['map'](async _0x143e8a=>{var _0x46d891=_0x25dee6;_0xdfcccc[_0x46d891(0x1c0)][_0x143e8a['invoice']]=[],await Promise[_0x46d891(0x181)](_0x143e8a[_0x46d891(0x1b3)][_0x46d891(0x1b8)](async _0x53964c=>{var _0x4ed758=_0x46d891;const _0x5dfdef=await adjustment[_0x4ed758(0x196)]([{'$unwind':_0x4ed758(0x19c)},{'$match':{'product.id_transaction_from':_0x53964c[_0x4ed758(0x1cd)][_0x4ed758(0x1c7)](),'product.invoice':_0x53964c['invoice']}},{'$project':{'_id':_0x4ed758(0x1ce),'product_name':'$product.product_name','product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':'$product.room_names','product_invoice':'$product.invoice','invoice':_0x4ed758(0x1b1),'id_transaction_from':_0x4ed758(0x188),'date':_0x4ed758(0x1cf),'production_date':_0x4ed758(0x17f),'expiry_date':'$product.expiry_date','UOM':_0x4ed758(0x1a3)}}]);_0x5dfdef[_0x4ed758(0x198)]>0x0&&_0xdfcccc['data_adjustment'][_0x143e8a[_0x4ed758(0x1d7)]][_0x4ed758(0x1d6)](..._0x5dfdef);}));})),_0xdfcccc[_0x25dee6(0x1db)]={},await Promise['all'](_0xdfcccc[_0x25dee6(0x1b8)](async _0x1d8034=>{var _0x436b3f=_0x25dee6;_0xdfcccc[_0x436b3f(0x1db)][_0x1d8034[_0x436b3f(0x1d7)]]=[],await Promise[_0x436b3f(0x181)](_0x1d8034[_0x436b3f(0x1b3)][_0x436b3f(0x1b8)](async _0x4cc6a1=>{var _0x3d92e4=_0x436b3f;const _0x1f4e82=await transfers[_0x3d92e4(0x196)]([{'$unwind':_0x3d92e4(0x19c)},{'$match':{'product.id_transaction_id':_0x4cc6a1[_0x3d92e4(0x1cd)][_0x3d92e4(0x1c7)](),'product.To_invoice':_0x4cc6a1[_0x3d92e4(0x1d7)]}},{'$project':{'_id':_0x3d92e4(0x1ce),'product_name':_0x3d92e4(0x1da),'product_code':_0x3d92e4(0x1bd),'quantity_available':'$product.to_quantity','warehouse_name':_0x3d92e4(0x1d5),'warehouse_room':_0x3d92e4(0x1ae),'product_invoice':_0x3d92e4(0x1c8),'invoice':'$invoice','id_transaction_from':_0x3d92e4(0x1b5),'date':_0x3d92e4(0x1cf),'production_date':'$product.production_date','expiry_date':_0x3d92e4(0x1d4),'UOM':_0x3d92e4(0x1a3)}}]);_0x1f4e82['length']>0x0&&_0xdfcccc[_0x3d92e4(0x1db)][_0x1d8034[_0x3d92e4(0x1d7)]][_0x3d92e4(0x1d6)](..._0x1f4e82);}));})),_0x52cef2[_0x25dee6(0x1e0)]({'purchases_warehouse':_0xdfcccc,'data_sales':_0xdfcccc[_0x25dee6(0x1d1)],'data_adjustment':_0xdfcccc[_0x25dee6(0x1c0)],'data_transfer':_0xdfcccc['data_transfer']});}}else{if(_0x461e49==_0x25dee6(0x181)){var _0xdfcccc=await purchases_finished[_0x25dee6(0x196)]([{'$match':{'date':{'$gte':_0x2a543a,'$lte':_0x479a08}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x25dee6(0x1b1)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':['$$invoice',_0x25dee6(0x1a7)]}}},{'$project':{'_id':_0x25dee6(0x1a9),'product_name':_0x25dee6(0x193),'product_code':'$product_details.product_code','quantity_available':_0x25dee6(0x1df),'warehouse_name':_0x25dee6(0x1dc),'warehouse_room':'$room','invoice':_0x25dee6(0x1a7),'production_date':_0x25dee6(0x182),'expiry_date':_0x25dee6(0x19e),'UOM':_0x25dee6(0x192)}}],'as':_0x25dee6(0x1b3)}}]);_0xdfcccc[_0x25dee6(0x1d1)]={},await Promise[_0x25dee6(0x181)](_0xdfcccc[_0x25dee6(0x1b8)](async _0x116930=>{var _0x5ebaa8=_0x25dee6;_0xdfcccc['data_sales'][_0x116930['invoice']]=[],await Promise[_0x5ebaa8(0x181)](_0x116930[_0x5ebaa8(0x1b3)][_0x5ebaa8(0x1b8)](async _0x276410=>{var _0x57bbd8=_0x5ebaa8;const _0x2c0d9c=await sales_finished[_0x57bbd8(0x196)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x276410[_0x57bbd8(0x1cd)]['valueOf'](),'sale_product.invoice':_0x276410[_0x57bbd8(0x1d7)]}},{'$project':{'_id':_0x57bbd8(0x1c9),'product_name':'$sale_product.product_name','product_code':'$sale_product.product_code','quantity_available':'$sale_product.quantity','warehouse_name':_0x57bbd8(0x184),'warehouse_room':_0x57bbd8(0x1b2),'product_invoice':_0x57bbd8(0x1a2),'invoice':_0x57bbd8(0x1b1),'id_transaction_from':_0x57bbd8(0x18f),'date':_0x57bbd8(0x1cf),'production_date':_0x57bbd8(0x1bb),'expiry_date':_0x57bbd8(0x1a1),'UOM':_0x57bbd8(0x185)}}]);_0x2c0d9c[_0x57bbd8(0x198)]>0x0&&_0xdfcccc[_0x57bbd8(0x1d1)][_0x116930[_0x57bbd8(0x1d7)]][_0x57bbd8(0x1d6)](..._0x2c0d9c);}));})),_0xdfcccc[_0x25dee6(0x1d1)]=_0xdfcccc[_0x25dee6(0x1d1)],_0xdfcccc['data_adjustment']={},await Promise[_0x25dee6(0x181)](_0xdfcccc[_0x25dee6(0x1b8)](async _0x4c88cf=>{var _0x4ccb31=_0x25dee6;_0xdfcccc[_0x4ccb31(0x1c0)][_0x4c88cf[_0x4ccb31(0x1d7)]]=[],await Promise[_0x4ccb31(0x181)](_0x4c88cf['warehouse_data'][_0x4ccb31(0x1b8)](async _0x4d0f67=>{var _0x160246=_0x4ccb31;const _0x72119e=await adjustment_finished[_0x160246(0x196)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x4d0f67[_0x160246(0x1cd)]['valueOf'](),'product.invoice':_0x4d0f67[_0x160246(0x1d7)]}},{'$project':{'_id':_0x160246(0x1ce),'product_name':_0x160246(0x1da),'product_code':_0x160246(0x1bd),'quantity_available':_0x160246(0x1a6),'warehouse_name':_0x160246(0x184),'warehouse_room':_0x160246(0x1ae),'product_invoice':'$product.invoice','invoice':'$invoice','id_transaction_from':'$product.id_transaction_from','date':_0x160246(0x1cf),'production_date':_0x160246(0x17f),'expiry_date':'$product.expiry_date','UOM':_0x160246(0x1a3)}}]);_0x72119e['length']>0x0&&_0xdfcccc[_0x160246(0x1c0)][_0x4c88cf['invoice']]['push'](..._0x72119e);}));})),_0xdfcccc[_0x25dee6(0x1db)]={},await Promise[_0x25dee6(0x181)](_0xdfcccc[_0x25dee6(0x1b8)](async _0x321c0a=>{var _0x2b6109=_0x25dee6;_0xdfcccc[_0x2b6109(0x1db)][_0x321c0a[_0x2b6109(0x1d7)]]=[],await Promise[_0x2b6109(0x181)](_0x321c0a[_0x2b6109(0x1b3)][_0x2b6109(0x1b8)](async _0x5548ff=>{var _0xd72d9b=_0x2b6109;const _0x38f972=await transfers_finished[_0xd72d9b(0x196)]([{'$unwind':_0xd72d9b(0x19c)},{'$match':{'product.id_transaction':_0x5548ff[_0xd72d9b(0x1cd)][_0xd72d9b(0x1c7)](),'product.from_invoice':_0x5548ff[_0xd72d9b(0x1d7)]}},{'$project':{'_id':_0xd72d9b(0x1ce),'product_name':_0xd72d9b(0x1da),'product_code':'$product.product_code','quantity_available':_0xd72d9b(0x1c3),'warehouse_name':'$to_warehouse','warehouse_room':_0xd72d9b(0x1ae),'product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0xd72d9b(0x1c6),'date':_0xd72d9b(0x1cf),'production_date':'$product.production_date','expiry_date':_0xd72d9b(0x1d4),'UOM':_0xd72d9b(0x1a3)}}]);_0x38f972[_0xd72d9b(0x198)]>0x0&&_0xdfcccc[_0xd72d9b(0x1db)][_0x321c0a[_0xd72d9b(0x1d7)]][_0xd72d9b(0x1d6)](..._0x38f972);}));})),_0x52cef2[_0x25dee6(0x1e0)]({'purchases_warehouse':_0xdfcccc,'data_sales':_0xdfcccc['data_sales'],'data_adjustment':_0xdfcccc[_0x25dee6(0x1c0)],'data_transfer':_0xdfcccc['data_transfer']});}else{var _0xdfcccc=await purchases_finished['aggregate']([{'$match':{'warehouse_name':_0x461e49,'date':{'$gte':_0x2a543a,'$lte':_0x479a08}}},{'$lookup':{'from':_0x25dee6(0x1d0),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x25dee6(0x1b6)},{'$match':{'$expr':{'$eq':[_0x25dee6(0x1e4),_0x25dee6(0x1a7)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x25dee6(0x193),'product_code':_0x25dee6(0x1b9),'quantity_available':'$product_details.product_stock','warehouse_name':'$name','warehouse_room':_0x25dee6(0x1af),'invoice':_0x25dee6(0x1a7),'production_date':_0x25dee6(0x182),'expiry_date':'$product_details.expiry_date','UOM':_0x25dee6(0x192)}}],'as':_0x25dee6(0x1b3)}}]);_0xdfcccc[_0x25dee6(0x1d1)]={},await Promise['all'](_0xdfcccc['map'](async _0x488c5d=>{var _0x295dd9=_0x25dee6;_0xdfcccc['data_sales'][_0x488c5d['invoice']]=[],await Promise['all'](_0x488c5d['warehouse_data'][_0x295dd9(0x1b8)](async _0x598379=>{var _0x45f091=_0x295dd9;const _0xbdea4=await sales_finished['aggregate']([{'$unwind':_0x45f091(0x1aa)},{'$match':{'sale_product.id_transaction_from':_0x598379[_0x45f091(0x1cd)][_0x45f091(0x1c7)](),'sale_product.invoice':_0x598379[_0x45f091(0x1d7)]}},{'$project':{'_id':_0x45f091(0x1c9),'product_name':_0x45f091(0x19a),'product_code':_0x45f091(0x18a),'quantity_available':_0x45f091(0x1e6),'warehouse_name':_0x45f091(0x184),'warehouse_room':_0x45f091(0x1b2),'product_invoice':_0x45f091(0x1a2),'invoice':_0x45f091(0x1b1),'id_transaction_from':_0x45f091(0x18f),'date':_0x45f091(0x1cf),'production_date':_0x45f091(0x1bb),'expiry_date':_0x45f091(0x1a1),'UOM':'$sale_product.unit'}}]);_0xbdea4[_0x45f091(0x198)]>0x0&&_0xdfcccc[_0x45f091(0x1d1)][_0x488c5d[_0x45f091(0x1d7)]][_0x45f091(0x1d6)](..._0xbdea4);}));})),_0xdfcccc[_0x25dee6(0x1d1)]=_0xdfcccc['data_sales'],_0xdfcccc['data_adjustment']={},await Promise[_0x25dee6(0x181)](_0xdfcccc[_0x25dee6(0x1b8)](async _0x522884=>{var _0x3c7135=_0x25dee6;_0xdfcccc[_0x3c7135(0x1c0)][_0x522884[_0x3c7135(0x1d7)]]=[],await Promise[_0x3c7135(0x181)](_0x522884[_0x3c7135(0x1b3)][_0x3c7135(0x1b8)](async _0x5db036=>{var _0x3892d5=_0x3c7135;const _0x34542e=await adjustment_finished['aggregate']([{'$unwind':_0x3892d5(0x19c)},{'$match':{'product.id_transaction_from':_0x5db036[_0x3892d5(0x1cd)]['valueOf'](),'product.invoice':_0x5db036[_0x3892d5(0x1d7)]}},{'$project':{'_id':_0x3892d5(0x1ce),'product_name':_0x3892d5(0x1da),'product_code':_0x3892d5(0x1bd),'quantity_available':_0x3892d5(0x1a6),'warehouse_name':_0x3892d5(0x184),'warehouse_room':_0x3892d5(0x1ae),'product_invoice':_0x3892d5(0x18e),'invoice':_0x3892d5(0x1b1),'id_transaction_from':_0x3892d5(0x188),'date':_0x3892d5(0x1cf),'production_date':_0x3892d5(0x17f),'expiry_date':_0x3892d5(0x1d4),'UOM':_0x3892d5(0x1a3)}}]);_0x34542e[_0x3892d5(0x198)]>0x0&&_0xdfcccc['data_adjustment'][_0x522884['invoice']]['push'](..._0x34542e);}));})),_0xdfcccc['data_transfer']={},await Promise['all'](_0xdfcccc[_0x25dee6(0x1b8)](async _0x103d31=>{var _0x19d980=_0x25dee6;_0xdfcccc['data_transfer'][_0x103d31['invoice']]=[],await Promise[_0x19d980(0x181)](_0x103d31[_0x19d980(0x1b3)][_0x19d980(0x1b8)](async _0x14c889=>{var _0x48a505=_0x19d980;const _0x581014=await transfers_finished[_0x48a505(0x196)]([{'$unwind':_0x48a505(0x19c)},{'$match':{'product.id_transaction':_0x14c889[_0x48a505(0x1cd)]['valueOf'](),'product.from_invoice':_0x14c889[_0x48a505(0x1d7)]}},{'$project':{'_id':_0x48a505(0x1ce),'product_name':_0x48a505(0x1da),'product_code':'$product.product_code','quantity_available':'$product.to_quantity','warehouse_name':_0x48a505(0x1d5),'warehouse_room':_0x48a505(0x1ae),'product_invoice':_0x48a505(0x1c8),'invoice':_0x48a505(0x1b1),'id_transaction_from':_0x48a505(0x1c6),'date':_0x48a505(0x1cf),'production_date':_0x48a505(0x17f),'expiry_date':_0x48a505(0x1d4),'UOM':_0x48a505(0x1a3)}}]);_0x581014[_0x48a505(0x198)]>0x0&&_0xdfcccc[_0x48a505(0x1db)][_0x103d31[_0x48a505(0x1d7)]][_0x48a505(0x1d6)](..._0x581014);}));})),_0x52cef2[_0x25dee6(0x1e0)]({'purchases_warehouse':_0xdfcccc,'data_sales':_0xdfcccc[_0x25dee6(0x1d1)],'data_adjustment':_0xdfcccc[_0x25dee6(0x1c0)],'data_transfer':_0xdfcccc[_0x25dee6(0x1db)]});}}}),router[a0_0x25749b(0x1e2)](a0_0x25749b(0x18d),auth,async(_0x3547ec,_0x1010fa)=>{var _0x56402b=a0_0x25749b;try{const _0x110011=_0x3547ec['params']['id'];var _0x1218db=await purchases_finished[_0x56402b(0x1e5)](_0x110011);const _0x8dfc38=await master_shop['find'](),_0x3264db=_0x3547ec[_0x56402b(0x1e3)],_0x2d62ae=await profile[_0x56402b(0x1ad)]({'email':_0x3264db[_0x56402b(0x1c2)]});if(_0x8dfc38[0x0]['language']==_0x56402b(0x1e9))var _0x1b5ee8=users['English'];else{if(_0x8dfc38[0x0][_0x56402b(0x1c1)]=='Hindi')var _0x1b5ee8=users[_0x56402b(0x1a8)];else{if(_0x8dfc38[0x0]['language']=='German')var _0x1b5ee8=users[_0x56402b(0x190)];else{if(_0x8dfc38[0x0][_0x56402b(0x1c1)]=='Spanish')var _0x1b5ee8=users['Spanish'];else{if(_0x8dfc38[0x0]['language']==_0x56402b(0x189))var _0x1b5ee8=users[_0x56402b(0x189)];else{if(_0x8dfc38[0x0]['language']==_0x56402b(0x1a5))var _0x1b5ee8=users[_0x56402b(0x195)];else{if(_0x8dfc38[0x0][_0x56402b(0x1c1)]==_0x56402b(0x1e8))var _0x1b5ee8=users[_0x56402b(0x1e8)];else{if(_0x8dfc38[0x0]['language']==_0x56402b(0x1ac))var _0x1b5ee8=users[_0x56402b(0x191)];}}}}}}}_0x1010fa[_0x56402b(0x1a4)](_0x56402b(0x1a0),{'success':_0x3547ec[_0x56402b(0x183)](_0x56402b(0x1bc)),'errors':_0x3547ec[_0x56402b(0x183)]('errors'),'master_shop':_0x8dfc38,'profile':_0x2d62ae,'role':_0x3264db,'language':_0x1b5ee8,'data':_0x1218db});}catch(_0xa63060){_0x1010fa[_0x56402b(0x1e0)](_0xa63060);}}),router['get'](a0_0x25749b(0x19b),auth,async(_0x335398,_0x4f817f)=>{var _0x30ee01=a0_0x25749b;try{const _0x3c1633=_0x335398['params']['id'];var _0x4ad3c3=await sales_finished['findById'](_0x3c1633);const _0x590c62=await master_shop[_0x30ee01(0x1ab)](),_0x3a8c9d=_0x335398[_0x30ee01(0x1e3)],_0x4c9838=await profile[_0x30ee01(0x1ad)]({'email':_0x3a8c9d[_0x30ee01(0x1c2)]});if(_0x590c62[0x0][_0x30ee01(0x1c1)]==_0x30ee01(0x1e9))var _0x36b3f4=users[_0x30ee01(0x1cc)];else{if(_0x590c62[0x0][_0x30ee01(0x1c1)]==_0x30ee01(0x1a8))var _0x36b3f4=users[_0x30ee01(0x1a8)];else{if(_0x590c62[0x0][_0x30ee01(0x1c1)]=='German')var _0x36b3f4=users[_0x30ee01(0x190)];else{if(_0x590c62[0x0]['language']=='Spanish')var _0x36b3f4=users[_0x30ee01(0x199)];else{if(_0x590c62[0x0][_0x30ee01(0x1c1)]==_0x30ee01(0x189))var _0x36b3f4=users['French'];else{if(_0x590c62[0x0][_0x30ee01(0x1c1)]=='Portuguese\x20(BR)')var _0x36b3f4=users['Portuguese'];else{if(_0x590c62[0x0][_0x30ee01(0x1c1)]==_0x30ee01(0x1e8))var _0x36b3f4=users[_0x30ee01(0x1e8)];else{if(_0x590c62[0x0][_0x30ee01(0x1c1)]==_0x30ee01(0x1ac))var _0x36b3f4=users[_0x30ee01(0x191)];}}}}}}}_0x4f817f['render'](_0x30ee01(0x1d3),{'success':_0x335398[_0x30ee01(0x183)](_0x30ee01(0x1bc)),'errors':_0x335398[_0x30ee01(0x183)]('errors'),'master_shop':_0x590c62,'profile':_0x4c9838,'role':_0x3a8c9d,'language':_0x36b3f4,'data':_0x4ad3c3});}catch(_0x194fcb){_0x4f817f[_0x30ee01(0x1e0)](_0x194fcb);}}),router[a0_0x25749b(0x1e2)](a0_0x25749b(0x1bf),auth,async(_0x2dcd95,_0x4d07ad)=>{var _0x4b8913=a0_0x25749b;try{const _0x14aa18=_0x2dcd95['params']['id'];var _0x47fe52=await transfers_finished['findById'](_0x14aa18);const _0x1b5824=await master_shop[_0x4b8913(0x1ab)](),_0xed3c21=_0x2dcd95[_0x4b8913(0x1e3)],_0x329ee1=await profile[_0x4b8913(0x1ad)]({'email':_0xed3c21[_0x4b8913(0x1c2)]});if(_0x1b5824[0x0]['language']==_0x4b8913(0x1e9))var _0x35fe5c=users[_0x4b8913(0x1cc)];else{if(_0x1b5824[0x0][_0x4b8913(0x1c1)]=='Hindi')var _0x35fe5c=users[_0x4b8913(0x1a8)];else{if(_0x1b5824[0x0][_0x4b8913(0x1c1)]==_0x4b8913(0x190))var _0x35fe5c=users['German'];else{if(_0x1b5824[0x0][_0x4b8913(0x1c1)]==_0x4b8913(0x199))var _0x35fe5c=users['Spanish'];else{if(_0x1b5824[0x0]['language']==_0x4b8913(0x189))var _0x35fe5c=users['French'];else{if(_0x1b5824[0x0][_0x4b8913(0x1c1)]==_0x4b8913(0x1a5))var _0x35fe5c=users[_0x4b8913(0x195)];else{if(_0x1b5824[0x0][_0x4b8913(0x1c1)]==_0x4b8913(0x1e8))var _0x35fe5c=users[_0x4b8913(0x1e8)];else{if(_0x1b5824[0x0][_0x4b8913(0x1c1)]==_0x4b8913(0x1ac))var _0x35fe5c=users['Arabic'];}}}}}}}_0x4d07ad['render'](_0x4b8913(0x1be),{'success':_0x2dcd95[_0x4b8913(0x183)](_0x4b8913(0x1bc)),'errors':_0x2dcd95[_0x4b8913(0x183)](_0x4b8913(0x1c5)),'master_shop':_0x1b5824,'profile':_0x329ee1,'role':_0xed3c21,'language':_0x35fe5c,'data':_0x47fe52});}catch(_0x4be3a4){_0x4d07ad[_0x4b8913(0x1e0)](_0x4be3a4);}}),router[a0_0x25749b(0x1e2)](a0_0x25749b(0x1dd),auth,async(_0x148717,_0x1ef2e5)=>{var _0x58b213=a0_0x25749b;try{const {username:_0x5bbddb,email:_0x53e737,role:_0x5ab201}=_0x148717[_0x58b213(0x1e3)],_0x1ff509=_0x148717[_0x58b213(0x1e3)],_0xa7153b=await profile[_0x58b213(0x1ad)]({'email':_0x1ff509[_0x58b213(0x1c2)]}),_0x424eeb=await master_shop[_0x58b213(0x1ab)](),_0x26dac4=await warehouse[_0x58b213(0x196)]([{'$match':{'status':_0x58b213(0x187),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x58b213(0x1dc),'name':{'$first':'$name'}}}]);if(_0x424eeb[0x0]['language']==_0x58b213(0x1e9))var _0x38286b=users[_0x58b213(0x1cc)];else{if(_0x424eeb[0x0][_0x58b213(0x1c1)]==_0x58b213(0x1a8))var _0x38286b=users[_0x58b213(0x1a8)];else{if(_0x424eeb[0x0][_0x58b213(0x1c1)]==_0x58b213(0x190))var _0x38286b=users[_0x58b213(0x190)];else{if(_0x424eeb[0x0][_0x58b213(0x1c1)]=='Spanish')var _0x38286b=users['Spanish'];else{if(_0x424eeb[0x0][_0x58b213(0x1c1)]==_0x58b213(0x189))var _0x38286b=users[_0x58b213(0x189)];else{if(_0x424eeb[0x0][_0x58b213(0x1c1)]=='Portuguese\x20(BR)')var _0x38286b=users[_0x58b213(0x195)];else{if(_0x424eeb[0x0][_0x58b213(0x1c1)]=='Chinese')var _0x38286b=users[_0x58b213(0x1e8)];else{if(_0x424eeb[0x0][_0x58b213(0x1c1)]=='Arabic\x20(ae)')var _0x38286b=users['Arabic'];}}}}}}}_0x1ef2e5[_0x58b213(0x1a4)](_0x58b213(0x194),{'success':_0x148717[_0x58b213(0x183)](_0x58b213(0x1bc)),'errors':_0x148717['flash'](_0x58b213(0x1c5)),'role':_0x1ff509,'profile':_0xa7153b,'master_shop':_0x424eeb,'dataProcess':_0x26dac4,'language':_0x38286b});}catch(_0x492afb){console['log'](_0x492afb);}}),module[a0_0x25749b(0x1b7)]=router;