var a0_0x29cea7=a0_0x34b9;function a0_0x2f81(){var _0x3115fd=['express','Finished\x20Goods','exports','map','$product.product_name','$sale_product.product_code','$sale_product.unit','data_sales','Hindi','$product_details.expiry_date','980nPrPqP','render','data_adjustment','/view','$product.expiry_date','$product.invoice','flash','$sale_product.quantity','Router','$product_details.unit','view_tf_table','errors','Arabic\x20(ae)','$product.id_transaction_id','$product.unit','findById','22215150BgAQXg','post','$$invoice','get','Portuguese\x20(BR)','length','Spanish','3480995WdDJYz','_id','aggregate','$name','transaction_finished_raw','/viewdata_inc_fg/:id','6040755bFtGue','$product.id_transaction_from','invoice','$sale_product','$product_details._id','Portuguese','push','$sale_product.id_transaction_from','body','language','$to_warehouse','/reports','$product.production_date','/viewFG','find','$product_details.product_name','Chinese','5718IjXbky','warehouse_data','warehouses','$product_details.product_stock','$sale_product.room_name','$product.room_names','/viewdata_tf_fg/:id','Enabled','log','$product.product_code','../middleware/auth','all','email','$product.to_quantity','$product.new_adjust_qty','$sale_product.product_name','Arabic','user','$sale_product.production_date','$room','4896064qMyqoH','$product_details.product_code','6oQFjmh','$sale_product.invoice','$product_details','$product_details.production_date','240196vMWQmD','../public/language/languages.json','$product._id','valueOf','transaction_finished','French','$date','findOne','$sale_product.expiry_date','$product.to_room_name','$sale_product._id','722894cfQYHi','$invoice','success','$product.id_transaction','$warehouse_name','params','data_transfer','English','$product_details.invoice','English\x20(US)','German','json','$product','Raw\x20Materials'];a0_0x2f81=function(){return _0x3115fd;};return a0_0x2f81();}(function(_0x2890c7,_0xb6b764){var _0x42f061=a0_0x34b9,_0x4f5683=_0x2890c7();while(!![]){try{var _0xb37267=parseInt(_0x42f061(0xb5))/0x1+parseInt(_0x42f061(0xc0))/0x2+-parseInt(_0x42f061(0x9b))/0x3*(parseInt(_0x42f061(0xd8))/0x4)+-parseInt(_0x42f061(0x84))/0x5*(parseInt(_0x42f061(0xb1))/0x6)+-parseInt(_0x42f061(0x8a))/0x7+-parseInt(_0x42f061(0xaf))/0x8+parseInt(_0x42f061(0x7d))/0x9;if(_0xb37267===_0xb6b764)break;else _0x4f5683['push'](_0x4f5683['shift']());}catch(_0x44c804){_0x4f5683['push'](_0x4f5683['shift']());}}}(a0_0x2f81,0x696eb));function a0_0x34b9(_0x181809,_0x222fc4){var _0x2f811b=a0_0x2f81();return a0_0x34b9=function(_0x34b9c9,_0x8ea72e){_0x34b9c9=_0x34b9c9-0x70;var _0x1de44a=_0x2f811b[_0x34b9c9];return _0x1de44a;},a0_0x34b9(_0x181809,_0x222fc4);}const express=require(a0_0x29cea7(0xce)),app=express(),router=express[a0_0x29cea7(0x75)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require('../models/all_models'),auth=require(a0_0x29cea7(0xa5)),users=require(a0_0x29cea7(0xb6)),nodemailer=require('nodemailer');router[a0_0x29cea7(0x80)](a0_0x29cea7(0x70),auth,async(_0x365dcf,_0x422a5e)=>{var _0x29856a=a0_0x29cea7;try{const {username:_0x4a6b4e,email:_0x30b3ea,role:_0x325623}=_0x365dcf[_0x29856a(0xac)],_0x3e9b06=_0x365dcf[_0x29856a(0xac)],_0x1e20be=await profile['findOne']({'email':_0x3e9b06[_0x29856a(0xa7)]}),_0x1842f6=await master_shop[_0x29856a(0x98)](),_0x519cf6=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x29856a(0xcf)}},{'$group':{'_id':_0x29856a(0x87),'name':{'$first':'$name'}}}]);if(_0x1842f6[0x0][_0x29856a(0x93)]==_0x29856a(0xc9))var _0x15b5e3=users[_0x29856a(0xc7)];else{if(_0x1842f6[0x0][_0x29856a(0x93)]==_0x29856a(0xd6))var _0x15b5e3=users['Hindi'];else{if(_0x1842f6[0x0][_0x29856a(0x93)]==_0x29856a(0xca))var _0x15b5e3=users['German'];else{if(_0x1842f6[0x0]['language']=='Spanish')var _0x15b5e3=users['Spanish'];else{if(_0x1842f6[0x0][_0x29856a(0x93)]==_0x29856a(0xba))var _0x15b5e3=users[_0x29856a(0xba)];else{if(_0x1842f6[0x0]['language']==_0x29856a(0x81))var _0x15b5e3=users[_0x29856a(0x8f)];else{if(_0x1842f6[0x0][_0x29856a(0x93)]==_0x29856a(0x9a))var _0x15b5e3=users[_0x29856a(0x9a)];else{if(_0x1842f6[0x0][_0x29856a(0x93)]==_0x29856a(0x79))var _0x15b5e3=users[_0x29856a(0xab)];}}}}}}}_0x422a5e[_0x29856a(0xd9)](_0x29856a(0xb9),{'success':_0x365dcf[_0x29856a(0x73)](_0x29856a(0xc2)),'errors':_0x365dcf['flash'](_0x29856a(0x78)),'role':_0x3e9b06,'profile':_0x1e20be,'master_shop':_0x1842f6,'dataProcess':_0x519cf6,'language':_0x15b5e3});}catch(_0x27cf7a){console[_0x29856a(0xa3)](_0x27cf7a);}}),router[a0_0x29cea7(0x7e)](a0_0x29cea7(0x95),auth,async(_0x130ffe,_0x195213)=>{var _0x11712e=a0_0x29cea7;const {product_category:_0x1e3888,transaction_category:_0x36cfe7,transaction_date_from:_0x53c096,transaction_date_to:_0x233fc7,warehouse_category:_0x7df9ec,item_code:_0x498d82}=_0x130ffe[_0x11712e(0x92)];console[_0x11712e(0xa3)](_0x7df9ec);if(_0x1e3888=='rm'){if(_0x7df9ec=='all'){var _0x5a1e24=await purchases['aggregate']([{'$match':{'date':{'$gte':_0x53c096,'$lte':_0x233fc7}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x11712e(0xc1)},'pipeline':[{'$unwind':_0x11712e(0xb3)},{'$match':{'$expr':{'$eq':[_0x11712e(0x7f),_0x11712e(0xc8)]}}},{'$project':{'_id':'$product_details._id','product_name':'$product_details.product_name','product_code':_0x11712e(0xb0),'quantity_available':_0x11712e(0x9e),'warehouse_name':'$name','warehouse_room':'$room','invoice':_0x11712e(0xc8),'production_date':'$product_details.production_date','expiry_date':_0x11712e(0xd7),'UOM':_0x11712e(0x76)}}],'as':_0x11712e(0x9c)}}]);_0x5a1e24['data_sales']={},await Promise['all'](_0x5a1e24[_0x11712e(0xd1)](async _0x549573=>{var _0x519c51=_0x11712e;_0x5a1e24['data_sales'][_0x549573[_0x519c51(0x8c)]]=[],await Promise[_0x519c51(0xa6)](_0x549573[_0x519c51(0x9c)][_0x519c51(0xd1)](async _0x3e768c=>{var _0x548d92=_0x519c51;const _0x2f25cd=await sales[_0x548d92(0x86)]([{'$unwind':_0x548d92(0x8d)},{'$match':{'sale_product.id_transaction_from':_0x3e768c[_0x548d92(0x85)]['valueOf'](),'sale_product.invoice':_0x3e768c[_0x548d92(0x8c)]}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':_0x548d92(0xd3),'quantity_available':_0x548d92(0x74),'warehouse_name':'$warehouse_name','warehouse_room':_0x548d92(0x9f),'product_invoice':_0x548d92(0xb2),'invoice':_0x548d92(0xc1),'id_transaction_from':_0x548d92(0x91),'date':_0x548d92(0xbb),'production_date':_0x548d92(0xad),'expiry_date':_0x548d92(0xbd),'UOM':_0x548d92(0xd4)}}]);_0x2f25cd['length']>0x0&&_0x5a1e24[_0x548d92(0xd5)][_0x549573[_0x548d92(0x8c)]][_0x548d92(0x90)](..._0x2f25cd);}));})),_0x5a1e24[_0x11712e(0xd5)]=_0x5a1e24[_0x11712e(0xd5)],_0x5a1e24[_0x11712e(0xda)]={},await Promise['all'](_0x5a1e24[_0x11712e(0xd1)](async _0x1ce36e=>{var _0x550aab=_0x11712e;_0x5a1e24[_0x550aab(0xda)][_0x1ce36e[_0x550aab(0x8c)]]=[],await Promise['all'](_0x1ce36e[_0x550aab(0x9c)][_0x550aab(0xd1)](async _0x39fe7b=>{var _0x39e5a1=_0x550aab;const _0xe70245=await adjustment[_0x39e5a1(0x86)]([{'$unwind':_0x39e5a1(0xcc)},{'$match':{'product.id_transaction_from':_0x39fe7b[_0x39e5a1(0x85)][_0x39e5a1(0xb8)](),'product.invoice':_0x39fe7b[_0x39e5a1(0x8c)]}},{'$project':{'_id':_0x39e5a1(0xb7),'product_name':_0x39e5a1(0xd2),'product_code':'$product.product_code','quantity_available':'$product.new_adjust_qty','warehouse_name':_0x39e5a1(0xc4),'warehouse_room':_0x39e5a1(0xa0),'product_invoice':_0x39e5a1(0x72),'invoice':_0x39e5a1(0xc1),'id_transaction_from':'$product.id_transaction_from','date':_0x39e5a1(0xbb),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x39e5a1(0x7b)}}]);_0xe70245[_0x39e5a1(0x82)]>0x0&&_0x5a1e24[_0x39e5a1(0xda)][_0x1ce36e[_0x39e5a1(0x8c)]][_0x39e5a1(0x90)](..._0xe70245);}));})),_0x5a1e24[_0x11712e(0xc6)]={},await Promise[_0x11712e(0xa6)](_0x5a1e24['map'](async _0x1bc277=>{var _0xd92600=_0x11712e;_0x5a1e24[_0xd92600(0xc6)][_0x1bc277[_0xd92600(0x8c)]]=[],await Promise[_0xd92600(0xa6)](_0x1bc277['warehouse_data']['map'](async _0x3bc8c2=>{var _0x4fc4e4=_0xd92600;const _0xce4c4=await transfers[_0x4fc4e4(0x86)]([{'$unwind':_0x4fc4e4(0xcc)},{'$match':{'product.id_transaction_id':_0x3bc8c2[_0x4fc4e4(0x85)][_0x4fc4e4(0xb8)](),'product.To_invoice':_0x3bc8c2[_0x4fc4e4(0x8c)]}},{'$project':{'_id':'$product._id','product_name':_0x4fc4e4(0xd2),'product_code':_0x4fc4e4(0xa4),'quantity_available':_0x4fc4e4(0xa8),'warehouse_name':_0x4fc4e4(0x94),'warehouse_room':_0x4fc4e4(0xa0),'product_invoice':'$product.to_room_name','invoice':_0x4fc4e4(0xc1),'id_transaction_from':_0x4fc4e4(0x7a),'date':'$date','production_date':'$product.production_date','expiry_date':_0x4fc4e4(0x71),'UOM':_0x4fc4e4(0x7b)}}]);_0xce4c4[_0x4fc4e4(0x82)]>0x0&&_0x5a1e24[_0x4fc4e4(0xc6)][_0x1bc277['invoice']]['push'](..._0xce4c4);}));})),_0x195213[_0x11712e(0xcb)]({'purchases_warehouse':_0x5a1e24,'data_sales':_0x5a1e24['data_sales'],'data_adjustment':_0x5a1e24[_0x11712e(0xda)],'data_transfer':_0x5a1e24[_0x11712e(0xc6)]});}else{var _0x5a1e24=await purchases[_0x11712e(0x86)]([{'$match':{'warehouse_name':_0x7df9ec,'date':{'$gte':_0x53c096,'$lte':_0x233fc7}}},{'$lookup':{'from':_0x11712e(0x9d),'let':{'invoice':_0x11712e(0xc1)},'pipeline':[{'$unwind':'$product_details'},{'$match':{'$expr':{'$eq':[_0x11712e(0x7f),_0x11712e(0xc8)]}}},{'$project':{'_id':_0x11712e(0x8e),'product_name':_0x11712e(0x99),'product_code':_0x11712e(0xb0),'quantity_available':_0x11712e(0x9e),'warehouse_name':_0x11712e(0x87),'warehouse_room':_0x11712e(0xae),'invoice':'$product_details.invoice','production_date':'$product_details.production_date','expiry_date':_0x11712e(0xd7),'UOM':'$product_details.unit'}}],'as':_0x11712e(0x9c)}}]);_0x5a1e24[_0x11712e(0xd5)]={},await Promise[_0x11712e(0xa6)](_0x5a1e24[_0x11712e(0xd1)](async _0x3966f8=>{var _0x1ce7aa=_0x11712e;_0x5a1e24[_0x1ce7aa(0xd5)][_0x3966f8[_0x1ce7aa(0x8c)]]=[],await Promise[_0x1ce7aa(0xa6)](_0x3966f8[_0x1ce7aa(0x9c)][_0x1ce7aa(0xd1)](async _0x32c7ef=>{var _0x2a328a=_0x1ce7aa;const _0x3db334=await sales[_0x2a328a(0x86)]([{'$unwind':_0x2a328a(0x8d)},{'$match':{'sale_product.id_transaction_from':_0x32c7ef[_0x2a328a(0x85)][_0x2a328a(0xb8)](),'sale_product.invoice':_0x32c7ef[_0x2a328a(0x8c)]}},{'$project':{'_id':_0x2a328a(0xbf),'product_name':_0x2a328a(0xaa),'product_code':_0x2a328a(0xd3),'quantity_available':_0x2a328a(0x74),'warehouse_name':_0x2a328a(0xc4),'warehouse_room':'$sale_product.room_name','product_invoice':_0x2a328a(0xb2),'invoice':_0x2a328a(0xc1),'id_transaction_from':'$sale_product.id_transaction_from','date':_0x2a328a(0xbb),'production_date':'$sale_product.production_date','expiry_date':_0x2a328a(0xbd),'UOM':'$sale_product.unit'}}]);_0x3db334['length']>0x0&&_0x5a1e24[_0x2a328a(0xd5)][_0x3966f8[_0x2a328a(0x8c)]]['push'](..._0x3db334);}));})),_0x5a1e24[_0x11712e(0xd5)]=_0x5a1e24['data_sales'],_0x5a1e24[_0x11712e(0xda)]={},await Promise[_0x11712e(0xa6)](_0x5a1e24[_0x11712e(0xd1)](async _0xfaa1cd=>{var _0x2ec8a9=_0x11712e;_0x5a1e24['data_adjustment'][_0xfaa1cd[_0x2ec8a9(0x8c)]]=[],await Promise[_0x2ec8a9(0xa6)](_0xfaa1cd[_0x2ec8a9(0x9c)][_0x2ec8a9(0xd1)](async _0x18c1ad=>{var _0x4749de=_0x2ec8a9;const _0x10afeb=await adjustment[_0x4749de(0x86)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x18c1ad[_0x4749de(0x85)][_0x4749de(0xb8)](),'product.invoice':_0x18c1ad['invoice']}},{'$project':{'_id':_0x4749de(0xb7),'product_name':_0x4749de(0xd2),'product_code':_0x4749de(0xa4),'quantity_available':'$product.new_adjust_qty','warehouse_name':'$warehouse_name','warehouse_room':_0x4749de(0xa0),'product_invoice':_0x4749de(0x72),'invoice':_0x4749de(0xc1),'id_transaction_from':_0x4749de(0x8b),'date':_0x4749de(0xbb),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x4749de(0x7b)}}]);_0x10afeb[_0x4749de(0x82)]>0x0&&_0x5a1e24[_0x4749de(0xda)][_0xfaa1cd[_0x4749de(0x8c)]][_0x4749de(0x90)](..._0x10afeb);}));})),_0x5a1e24[_0x11712e(0xc6)]={},await Promise[_0x11712e(0xa6)](_0x5a1e24[_0x11712e(0xd1)](async _0xd6bf61=>{var _0x13936b=_0x11712e;_0x5a1e24[_0x13936b(0xc6)][_0xd6bf61[_0x13936b(0x8c)]]=[],await Promise[_0x13936b(0xa6)](_0xd6bf61[_0x13936b(0x9c)]['map'](async _0x522ec9=>{var _0x415b93=_0x13936b;const _0x2a9758=await transfers[_0x415b93(0x86)]([{'$unwind':_0x415b93(0xcc)},{'$match':{'product.id_transaction_id':_0x522ec9[_0x415b93(0x85)][_0x415b93(0xb8)](),'product.To_invoice':_0x522ec9['invoice']}},{'$project':{'_id':_0x415b93(0xb7),'product_name':_0x415b93(0xd2),'product_code':_0x415b93(0xa4),'quantity_available':_0x415b93(0xa8),'warehouse_name':_0x415b93(0x94),'warehouse_room':_0x415b93(0xa0),'product_invoice':_0x415b93(0xbe),'invoice':_0x415b93(0xc1),'id_transaction_from':_0x415b93(0x7a),'date':_0x415b93(0xbb),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':'$product.unit'}}]);_0x2a9758[_0x415b93(0x82)]>0x0&&_0x5a1e24[_0x415b93(0xc6)][_0xd6bf61['invoice']][_0x415b93(0x90)](..._0x2a9758);}));})),_0x195213[_0x11712e(0xcb)]({'purchases_warehouse':_0x5a1e24,'data_sales':_0x5a1e24[_0x11712e(0xd5)],'data_adjustment':_0x5a1e24[_0x11712e(0xda)],'data_transfer':_0x5a1e24[_0x11712e(0xc6)]});}}else{if(_0x7df9ec==_0x11712e(0xa6)){var _0x5a1e24=await purchases_finished[_0x11712e(0x86)]([{'$match':{'date':{'$gte':_0x53c096,'$lte':_0x233fc7}}},{'$lookup':{'from':'warehouses','let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x11712e(0xb3)},{'$match':{'$expr':{'$eq':[_0x11712e(0x7f),_0x11712e(0xc8)]}}},{'$project':{'_id':_0x11712e(0x8e),'product_name':_0x11712e(0x99),'product_code':_0x11712e(0xb0),'quantity_available':_0x11712e(0x9e),'warehouse_name':_0x11712e(0x87),'warehouse_room':_0x11712e(0xae),'invoice':_0x11712e(0xc8),'production_date':_0x11712e(0xb4),'expiry_date':_0x11712e(0xd7),'UOM':_0x11712e(0x76)}}],'as':_0x11712e(0x9c)}}]);_0x5a1e24['data_sales']={},await Promise[_0x11712e(0xa6)](_0x5a1e24[_0x11712e(0xd1)](async _0x22cbee=>{var _0x4dc7dd=_0x11712e;_0x5a1e24['data_sales'][_0x22cbee[_0x4dc7dd(0x8c)]]=[],await Promise[_0x4dc7dd(0xa6)](_0x22cbee['warehouse_data'][_0x4dc7dd(0xd1)](async _0x2f9df3=>{var _0x5b09b4=_0x4dc7dd;const _0x15acd8=await sales_finished[_0x5b09b4(0x86)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x2f9df3[_0x5b09b4(0x85)][_0x5b09b4(0xb8)](),'sale_product.invoice':_0x2f9df3['invoice']}},{'$project':{'_id':_0x5b09b4(0xbf),'product_name':'$sale_product.product_name','product_code':_0x5b09b4(0xd3),'quantity_available':'$sale_product.quantity','warehouse_name':_0x5b09b4(0xc4),'warehouse_room':_0x5b09b4(0x9f),'product_invoice':_0x5b09b4(0xb2),'invoice':_0x5b09b4(0xc1),'id_transaction_from':_0x5b09b4(0x91),'date':_0x5b09b4(0xbb),'production_date':_0x5b09b4(0xad),'expiry_date':_0x5b09b4(0xbd),'UOM':_0x5b09b4(0xd4)}}]);_0x15acd8[_0x5b09b4(0x82)]>0x0&&_0x5a1e24[_0x5b09b4(0xd5)][_0x22cbee[_0x5b09b4(0x8c)]][_0x5b09b4(0x90)](..._0x15acd8);}));})),_0x5a1e24[_0x11712e(0xd5)]=_0x5a1e24[_0x11712e(0xd5)],_0x5a1e24[_0x11712e(0xda)]={},await Promise[_0x11712e(0xa6)](_0x5a1e24['map'](async _0x5a3d5c=>{var _0x483d56=_0x11712e;_0x5a1e24[_0x483d56(0xda)][_0x5a3d5c[_0x483d56(0x8c)]]=[],await Promise[_0x483d56(0xa6)](_0x5a3d5c['warehouse_data'][_0x483d56(0xd1)](async _0x5e83bf=>{var _0x30d810=_0x483d56;const _0x10f0af=await adjustment_finished[_0x30d810(0x86)]([{'$unwind':_0x30d810(0xcc)},{'$match':{'product.id_transaction_from':_0x5e83bf['_id'][_0x30d810(0xb8)](),'product.invoice':_0x5e83bf['invoice']}},{'$project':{'_id':_0x30d810(0xb7),'product_name':_0x30d810(0xd2),'product_code':_0x30d810(0xa4),'quantity_available':_0x30d810(0xa9),'warehouse_name':_0x30d810(0xc4),'warehouse_room':'$product.room_names','product_invoice':_0x30d810(0x72),'invoice':_0x30d810(0xc1),'id_transaction_from':_0x30d810(0x8b),'date':'$date','production_date':_0x30d810(0x96),'expiry_date':_0x30d810(0x71),'UOM':_0x30d810(0x7b)}}]);_0x10f0af[_0x30d810(0x82)]>0x0&&_0x5a1e24[_0x30d810(0xda)][_0x5a3d5c[_0x30d810(0x8c)]][_0x30d810(0x90)](..._0x10f0af);}));})),_0x5a1e24[_0x11712e(0xc6)]={},await Promise[_0x11712e(0xa6)](_0x5a1e24['map'](async _0x370888=>{var _0xf9d846=_0x11712e;_0x5a1e24['data_transfer'][_0x370888[_0xf9d846(0x8c)]]=[],await Promise['all'](_0x370888[_0xf9d846(0x9c)][_0xf9d846(0xd1)](async _0x39f6f6=>{var _0x1bf109=_0xf9d846;const _0x1bd3be=await transfers_finished['aggregate']([{'$unwind':_0x1bf109(0xcc)},{'$match':{'product.id_transaction':_0x39f6f6[_0x1bf109(0x85)][_0x1bf109(0xb8)](),'product.from_invoice':_0x39f6f6[_0x1bf109(0x8c)]}},{'$project':{'_id':_0x1bf109(0xb7),'product_name':_0x1bf109(0xd2),'product_code':'$product.product_code','quantity_available':_0x1bf109(0xa8),'warehouse_name':_0x1bf109(0x94),'warehouse_room':'$product.room_names','product_invoice':'$product.to_room_name','invoice':'$invoice','id_transaction_from':_0x1bf109(0xc3),'date':_0x1bf109(0xbb),'production_date':_0x1bf109(0x96),'expiry_date':_0x1bf109(0x71),'UOM':_0x1bf109(0x7b)}}]);_0x1bd3be['length']>0x0&&_0x5a1e24[_0x1bf109(0xc6)][_0x370888['invoice']]['push'](..._0x1bd3be);}));})),_0x195213[_0x11712e(0xcb)]({'purchases_warehouse':_0x5a1e24,'data_sales':_0x5a1e24[_0x11712e(0xd5)],'data_adjustment':_0x5a1e24[_0x11712e(0xda)],'data_transfer':_0x5a1e24['data_transfer']});}else{var _0x5a1e24=await purchases_finished[_0x11712e(0x86)]([{'$match':{'warehouse_name':_0x7df9ec,'date':{'$gte':_0x53c096,'$lte':_0x233fc7}}},{'$lookup':{'from':_0x11712e(0x9d),'let':{'invoice':_0x11712e(0xc1)},'pipeline':[{'$unwind':_0x11712e(0xb3)},{'$match':{'$expr':{'$eq':['$$invoice',_0x11712e(0xc8)]}}},{'$project':{'_id':_0x11712e(0x8e),'product_name':_0x11712e(0x99),'product_code':_0x11712e(0xb0),'quantity_available':'$product_details.product_stock','warehouse_name':_0x11712e(0x87),'warehouse_room':_0x11712e(0xae),'invoice':_0x11712e(0xc8),'production_date':_0x11712e(0xb4),'expiry_date':_0x11712e(0xd7),'UOM':_0x11712e(0x76)}}],'as':'warehouse_data'}}]);_0x5a1e24['data_sales']={},await Promise[_0x11712e(0xa6)](_0x5a1e24['map'](async _0x4dbde7=>{var _0x34b51d=_0x11712e;_0x5a1e24[_0x34b51d(0xd5)][_0x4dbde7['invoice']]=[],await Promise[_0x34b51d(0xa6)](_0x4dbde7['warehouse_data'][_0x34b51d(0xd1)](async _0x2323e1=>{var _0x3682fa=_0x34b51d;const _0xb37cdf=await sales_finished[_0x3682fa(0x86)]([{'$unwind':_0x3682fa(0x8d)},{'$match':{'sale_product.id_transaction_from':_0x2323e1['_id'][_0x3682fa(0xb8)](),'sale_product.invoice':_0x2323e1[_0x3682fa(0x8c)]}},{'$project':{'_id':_0x3682fa(0xbf),'product_name':_0x3682fa(0xaa),'product_code':_0x3682fa(0xd3),'quantity_available':_0x3682fa(0x74),'warehouse_name':'$warehouse_name','warehouse_room':_0x3682fa(0x9f),'product_invoice':_0x3682fa(0xb2),'invoice':_0x3682fa(0xc1),'id_transaction_from':_0x3682fa(0x91),'date':'$date','production_date':_0x3682fa(0xad),'expiry_date':_0x3682fa(0xbd),'UOM':_0x3682fa(0xd4)}}]);_0xb37cdf[_0x3682fa(0x82)]>0x0&&_0x5a1e24[_0x3682fa(0xd5)][_0x4dbde7[_0x3682fa(0x8c)]][_0x3682fa(0x90)](..._0xb37cdf);}));})),_0x5a1e24['data_sales']=_0x5a1e24[_0x11712e(0xd5)],_0x5a1e24[_0x11712e(0xda)]={},await Promise[_0x11712e(0xa6)](_0x5a1e24[_0x11712e(0xd1)](async _0x5bfd12=>{var _0x237334=_0x11712e;_0x5a1e24[_0x237334(0xda)][_0x5bfd12[_0x237334(0x8c)]]=[],await Promise[_0x237334(0xa6)](_0x5bfd12[_0x237334(0x9c)][_0x237334(0xd1)](async _0x3b4f3c=>{var _0x3646e7=_0x237334;const _0x515484=await adjustment_finished[_0x3646e7(0x86)]([{'$unwind':_0x3646e7(0xcc)},{'$match':{'product.id_transaction_from':_0x3b4f3c[_0x3646e7(0x85)][_0x3646e7(0xb8)](),'product.invoice':_0x3b4f3c['invoice']}},{'$project':{'_id':_0x3646e7(0xb7),'product_name':'$product.product_name','product_code':_0x3646e7(0xa4),'quantity_available':_0x3646e7(0xa9),'warehouse_name':_0x3646e7(0xc4),'warehouse_room':_0x3646e7(0xa0),'product_invoice':_0x3646e7(0x72),'invoice':_0x3646e7(0xc1),'id_transaction_from':'$product.id_transaction_from','date':_0x3646e7(0xbb),'production_date':_0x3646e7(0x96),'expiry_date':_0x3646e7(0x71),'UOM':_0x3646e7(0x7b)}}]);_0x515484[_0x3646e7(0x82)]>0x0&&_0x5a1e24[_0x3646e7(0xda)][_0x5bfd12[_0x3646e7(0x8c)]][_0x3646e7(0x90)](..._0x515484);}));})),_0x5a1e24['data_transfer']={},await Promise[_0x11712e(0xa6)](_0x5a1e24['map'](async _0xb703d7=>{var _0x37e765=_0x11712e;_0x5a1e24['data_transfer'][_0xb703d7[_0x37e765(0x8c)]]=[],await Promise[_0x37e765(0xa6)](_0xb703d7[_0x37e765(0x9c)][_0x37e765(0xd1)](async _0x54e41d=>{var _0x61c50c=_0x37e765;const _0x4b9714=await transfers_finished[_0x61c50c(0x86)]([{'$unwind':_0x61c50c(0xcc)},{'$match':{'product.id_transaction':_0x54e41d['_id'][_0x61c50c(0xb8)](),'product.from_invoice':_0x54e41d[_0x61c50c(0x8c)]}},{'$project':{'_id':'$product._id','product_name':_0x61c50c(0xd2),'product_code':_0x61c50c(0xa4),'quantity_available':_0x61c50c(0xa8),'warehouse_name':_0x61c50c(0x94),'warehouse_room':_0x61c50c(0xa0),'product_invoice':_0x61c50c(0xbe),'invoice':_0x61c50c(0xc1),'id_transaction_from':'$product.id_transaction','date':'$date','production_date':_0x61c50c(0x96),'expiry_date':_0x61c50c(0x71),'UOM':_0x61c50c(0x7b)}}]);_0x4b9714[_0x61c50c(0x82)]>0x0&&_0x5a1e24[_0x61c50c(0xc6)][_0xb703d7['invoice']][_0x61c50c(0x90)](..._0x4b9714);}));})),_0x195213[_0x11712e(0xcb)]({'purchases_warehouse':_0x5a1e24,'data_sales':_0x5a1e24[_0x11712e(0xd5)],'data_adjustment':_0x5a1e24[_0x11712e(0xda)],'data_transfer':_0x5a1e24[_0x11712e(0xc6)]});}}}),router[a0_0x29cea7(0x80)](a0_0x29cea7(0x89),auth,async(_0x5b6ee0,_0x45eadb)=>{var _0x7c859e=a0_0x29cea7;try{const _0x370791=_0x5b6ee0[_0x7c859e(0xc5)]['id'];var _0x5c94ec=await purchases_finished[_0x7c859e(0x7c)](_0x370791);const _0x2bce03=await master_shop['find'](),_0x2ea406=_0x5b6ee0['user'],_0x2717b1=await profile[_0x7c859e(0xbc)]({'email':_0x2ea406[_0x7c859e(0xa7)]});if(_0x2bce03[0x0][_0x7c859e(0x93)]==_0x7c859e(0xc9))var _0x5b6314=users[_0x7c859e(0xc7)];else{if(_0x2bce03[0x0][_0x7c859e(0x93)]=='Hindi')var _0x5b6314=users[_0x7c859e(0xd6)];else{if(_0x2bce03[0x0]['language']=='German')var _0x5b6314=users[_0x7c859e(0xca)];else{if(_0x2bce03[0x0][_0x7c859e(0x93)]==_0x7c859e(0x83))var _0x5b6314=users['Spanish'];else{if(_0x2bce03[0x0][_0x7c859e(0x93)]==_0x7c859e(0xba))var _0x5b6314=users[_0x7c859e(0xba)];else{if(_0x2bce03[0x0][_0x7c859e(0x93)]==_0x7c859e(0x81))var _0x5b6314=users[_0x7c859e(0x8f)];else{if(_0x2bce03[0x0][_0x7c859e(0x93)]==_0x7c859e(0x9a))var _0x5b6314=users['Chinese'];else{if(_0x2bce03[0x0][_0x7c859e(0x93)]==_0x7c859e(0x79))var _0x5b6314=users[_0x7c859e(0xab)];}}}}}}}_0x45eadb[_0x7c859e(0xd9)]('view_table',{'success':_0x5b6ee0[_0x7c859e(0x73)](_0x7c859e(0xc2)),'errors':_0x5b6ee0[_0x7c859e(0x73)](_0x7c859e(0x78)),'master_shop':_0x2bce03,'profile':_0x2717b1,'role':_0x2ea406,'language':_0x5b6314,'data':_0x5c94ec});}catch(_0x3885a5){_0x45eadb[_0x7c859e(0xcb)](_0x3885a5);}}),router['get']('/viewdata_og_fg/:id',auth,async(_0x5958d2,_0x3252e2)=>{var _0xce7e34=a0_0x29cea7;try{const _0x14ec99=_0x5958d2[_0xce7e34(0xc5)]['id'];var _0x124cdb=await sales_finished['findById'](_0x14ec99);const _0x4a8a60=await master_shop[_0xce7e34(0x98)](),_0x5e9687=_0x5958d2[_0xce7e34(0xac)],_0x288950=await profile[_0xce7e34(0xbc)]({'email':_0x5e9687['email']});if(_0x4a8a60[0x0][_0xce7e34(0x93)]==_0xce7e34(0xc9))var _0x3cffed=users['English'];else{if(_0x4a8a60[0x0][_0xce7e34(0x93)]==_0xce7e34(0xd6))var _0x3cffed=users['Hindi'];else{if(_0x4a8a60[0x0]['language']==_0xce7e34(0xca))var _0x3cffed=users[_0xce7e34(0xca)];else{if(_0x4a8a60[0x0][_0xce7e34(0x93)]==_0xce7e34(0x83))var _0x3cffed=users['Spanish'];else{if(_0x4a8a60[0x0][_0xce7e34(0x93)]==_0xce7e34(0xba))var _0x3cffed=users[_0xce7e34(0xba)];else{if(_0x4a8a60[0x0][_0xce7e34(0x93)]==_0xce7e34(0x81))var _0x3cffed=users[_0xce7e34(0x8f)];else{if(_0x4a8a60[0x0][_0xce7e34(0x93)]==_0xce7e34(0x9a))var _0x3cffed=users[_0xce7e34(0x9a)];else{if(_0x4a8a60[0x0][_0xce7e34(0x93)]=='Arabic\x20(ae)')var _0x3cffed=users[_0xce7e34(0xab)];}}}}}}}_0x3252e2[_0xce7e34(0xd9)]('view_og_table',{'success':_0x5958d2[_0xce7e34(0x73)]('success'),'errors':_0x5958d2[_0xce7e34(0x73)](_0xce7e34(0x78)),'master_shop':_0x4a8a60,'profile':_0x288950,'role':_0x5e9687,'language':_0x3cffed,'data':_0x124cdb});}catch(_0x253656){_0x3252e2[_0xce7e34(0xcb)](_0x253656);}}),router[a0_0x29cea7(0x80)](a0_0x29cea7(0xa1),auth,async(_0x16e196,_0x4963d2)=>{var _0x351454=a0_0x29cea7;try{const _0x4dd7cc=_0x16e196[_0x351454(0xc5)]['id'];var _0x351082=await transfers_finished[_0x351454(0x7c)](_0x4dd7cc);const _0x1607dd=await master_shop[_0x351454(0x98)](),_0x59ebb8=_0x16e196[_0x351454(0xac)],_0x24432b=await profile[_0x351454(0xbc)]({'email':_0x59ebb8[_0x351454(0xa7)]});if(_0x1607dd[0x0][_0x351454(0x93)]==_0x351454(0xc9))var _0x6492e4=users[_0x351454(0xc7)];else{if(_0x1607dd[0x0][_0x351454(0x93)]==_0x351454(0xd6))var _0x6492e4=users[_0x351454(0xd6)];else{if(_0x1607dd[0x0]['language']=='German')var _0x6492e4=users['German'];else{if(_0x1607dd[0x0][_0x351454(0x93)]=='Spanish')var _0x6492e4=users[_0x351454(0x83)];else{if(_0x1607dd[0x0]['language']==_0x351454(0xba))var _0x6492e4=users[_0x351454(0xba)];else{if(_0x1607dd[0x0][_0x351454(0x93)]=='Portuguese\x20(BR)')var _0x6492e4=users[_0x351454(0x8f)];else{if(_0x1607dd[0x0][_0x351454(0x93)]==_0x351454(0x9a))var _0x6492e4=users[_0x351454(0x9a)];else{if(_0x1607dd[0x0][_0x351454(0x93)]==_0x351454(0x79))var _0x6492e4=users[_0x351454(0xab)];}}}}}}}_0x4963d2[_0x351454(0xd9)](_0x351454(0x77),{'success':_0x16e196['flash'](_0x351454(0xc2)),'errors':_0x16e196[_0x351454(0x73)](_0x351454(0x78)),'master_shop':_0x1607dd,'profile':_0x24432b,'role':_0x59ebb8,'language':_0x6492e4,'data':_0x351082});}catch(_0x577601){_0x4963d2['json'](_0x577601);}}),router[a0_0x29cea7(0x80)](a0_0x29cea7(0x97),auth,async(_0x2bd768,_0x505587)=>{var _0xb151db=a0_0x29cea7;try{const {username:_0x18e48a,email:_0x395605,role:_0x560b34}=_0x2bd768[_0xb151db(0xac)],_0x2a5ce4=_0x2bd768[_0xb151db(0xac)],_0x4a3517=await profile[_0xb151db(0xbc)]({'email':_0x2a5ce4[_0xb151db(0xa7)]}),_0x3b616f=await master_shop[_0xb151db(0x98)](),_0x4680f0=await warehouse[_0xb151db(0x86)]([{'$match':{'status':_0xb151db(0xa2),'warehouse_category':_0xb151db(0xcd)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x3b616f[0x0][_0xb151db(0x93)]==_0xb151db(0xc9))var _0x4ac0e7=users[_0xb151db(0xc7)];else{if(_0x3b616f[0x0][_0xb151db(0x93)]==_0xb151db(0xd6))var _0x4ac0e7=users[_0xb151db(0xd6)];else{if(_0x3b616f[0x0][_0xb151db(0x93)]=='German')var _0x4ac0e7=users[_0xb151db(0xca)];else{if(_0x3b616f[0x0][_0xb151db(0x93)]==_0xb151db(0x83))var _0x4ac0e7=users[_0xb151db(0x83)];else{if(_0x3b616f[0x0][_0xb151db(0x93)]==_0xb151db(0xba))var _0x4ac0e7=users[_0xb151db(0xba)];else{if(_0x3b616f[0x0][_0xb151db(0x93)]==_0xb151db(0x81))var _0x4ac0e7=users[_0xb151db(0x8f)];else{if(_0x3b616f[0x0][_0xb151db(0x93)]==_0xb151db(0x9a))var _0x4ac0e7=users[_0xb151db(0x9a)];else{if(_0x3b616f[0x0][_0xb151db(0x93)]==_0xb151db(0x79))var _0x4ac0e7=users['Arabic'];}}}}}}}_0x505587[_0xb151db(0xd9)](_0xb151db(0x88),{'success':_0x2bd768['flash'](_0xb151db(0xc2)),'errors':_0x2bd768[_0xb151db(0x73)](_0xb151db(0x78)),'role':_0x2a5ce4,'profile':_0x4a3517,'master_shop':_0x3b616f,'dataProcess':_0x4680f0,'language':_0x4ac0e7});}catch(_0x193f90){console[_0xb151db(0xa3)](_0x193f90);}}),module[a0_0x29cea7(0xd0)]=router;