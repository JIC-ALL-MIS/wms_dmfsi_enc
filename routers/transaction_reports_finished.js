var a0_0x4618b=a0_0xf6eb;(function(_0x2f8a32,_0x4bbc61){var _0x33efd5=a0_0xf6eb,_0x10cbd8=_0x2f8a32();while(!![]){try{var _0x14cc39=-parseInt(_0x33efd5(0xbf))/0x1*(parseInt(_0x33efd5(0xdb))/0x2)+-parseInt(_0x33efd5(0x111))/0x3+-parseInt(_0x33efd5(0xdf))/0x4+parseInt(_0x33efd5(0x101))/0x5+parseInt(_0x33efd5(0xcf))/0x6+-parseInt(_0x33efd5(0x10f))/0x7+parseInt(_0x33efd5(0xd3))/0x8;if(_0x14cc39===_0x4bbc61)break;else _0x10cbd8['push'](_0x10cbd8['shift']());}catch(_0x69da6d){_0x10cbd8['push'](_0x10cbd8['shift']());}}}(a0_0x5e5c,0x2c8ec));const express=require(a0_0x4618b(0x107)),app=express(),router=express[a0_0x4618b(0x119)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_finished,sales,sales_finished,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings,adjustment_finished,adjustment}=require(a0_0x4618b(0xf8)),auth=require(a0_0x4618b(0xf1)),users=require(a0_0x4618b(0xc1)),nodemailer=require(a0_0x4618b(0x100));function a0_0xf6eb(_0x69d82e,_0x19507a){var _0x5e5c78=a0_0x5e5c();return a0_0xf6eb=function(_0xf6eb65,_0x432701){_0xf6eb65=_0xf6eb65-0xb6;var _0x3a7171=_0x5e5c78[_0xf6eb65];return _0x3a7171;},a0_0xf6eb(_0x69d82e,_0x19507a);}router[a0_0x4618b(0x115)](a0_0x4618b(0xcc),auth,async(_0x379969,_0x40018d)=>{var _0x49bfe7=a0_0x4618b;try{const {username:_0x4139fc,email:_0x10a54d,role:_0x537bef}=_0x379969[_0x49bfe7(0xba)],_0x1d968f=_0x379969[_0x49bfe7(0xba)],_0x13a8da=await profile[_0x49bfe7(0x10c)]({'email':_0x1d968f['email']}),_0x3f6a78=await master_shop[_0x49bfe7(0x103)](),_0x448a60=await warehouse[_0x49bfe7(0xb7)]([{'$match':{'status':_0x49bfe7(0xd2),'warehouse_category':_0x49bfe7(0x116)}},{'$group':{'_id':_0x49bfe7(0x108),'name':{'$first':_0x49bfe7(0x108)}}}]);if(_0x3f6a78[0x0][_0x49bfe7(0x11e)]=='English\x20(US)')var _0x1dc3b9=users[_0x49bfe7(0xc2)];else{if(_0x3f6a78[0x0][_0x49bfe7(0x11e)]==_0x49bfe7(0xe4))var _0x1dc3b9=users[_0x49bfe7(0xe4)];else{if(_0x3f6a78[0x0]['language']=='German')var _0x1dc3b9=users[_0x49bfe7(0xbe)];else{if(_0x3f6a78[0x0][_0x49bfe7(0x11e)]==_0x49bfe7(0xc4))var _0x1dc3b9=users[_0x49bfe7(0xc4)];else{if(_0x3f6a78[0x0][_0x49bfe7(0x11e)]==_0x49bfe7(0xc8))var _0x1dc3b9=users[_0x49bfe7(0xc8)];else{if(_0x3f6a78[0x0]['language']==_0x49bfe7(0xfd))var _0x1dc3b9=users[_0x49bfe7(0xd8)];else{if(_0x3f6a78[0x0]['language']=='Chinese')var _0x1dc3b9=users['Chinese'];else{if(_0x3f6a78[0x0][_0x49bfe7(0x11e)]==_0x49bfe7(0x10d))var _0x1dc3b9=users[_0x49bfe7(0x11f)];}}}}}}}_0x40018d[_0x49bfe7(0xf3)](_0x49bfe7(0x117),{'success':_0x379969[_0x49bfe7(0xc5)]('success'),'errors':_0x379969['flash'](_0x49bfe7(0xd9)),'role':_0x1d968f,'profile':_0x13a8da,'master_shop':_0x3f6a78,'dataProcess':_0x448a60,'language':_0x1dc3b9});}catch(_0x1ff85e){console['log'](_0x1ff85e);}}),router[a0_0x4618b(0x11b)](a0_0x4618b(0x10a),auth,async(_0x2e25a0,_0x39631d)=>{var _0x7708e4=a0_0x4618b;const {product_category:_0x3b299e,transaction_category:_0x5c571d,transaction_date_from:_0x97ca37,transaction_date_to:_0x5721a5,warehouse_category:_0x2c547a,item_code:_0x2de13f}=_0x2e25a0[_0x7708e4(0x104)];console['log'](_0x2c547a);if(_0x3b299e=='rm'){if(_0x2c547a==_0x7708e4(0x102)){var _0x4b7de2=await purchases[_0x7708e4(0xb7)]([{'$match':{'date':{'$gte':_0x97ca37,'$lte':_0x5721a5}}},{'$lookup':{'from':_0x7708e4(0xca),'let':{'invoice':'$invoice'},'pipeline':[{'$unwind':_0x7708e4(0xe9)},{'$match':{'$expr':{'$eq':[_0x7708e4(0xef),_0x7708e4(0xeb)]}}},{'$project':{'_id':_0x7708e4(0xdd),'product_name':_0x7708e4(0x114),'product_code':_0x7708e4(0xd6),'quantity_available':_0x7708e4(0xb8),'warehouse_name':_0x7708e4(0x108),'warehouse_room':'$room','invoice':_0x7708e4(0xeb),'production_date':_0x7708e4(0x109),'expiry_date':'$product_details.expiry_date','UOM':'$product_details.unit'}}],'as':'warehouse_data'}}]);_0x4b7de2[_0x7708e4(0x112)]={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x4d31ac=>{var _0x52654c=_0x7708e4;_0x4b7de2[_0x52654c(0x112)][_0x4d31ac[_0x52654c(0xd0)]]=[],await Promise['all'](_0x4d31ac[_0x52654c(0xfa)][_0x52654c(0xbc)](async _0x4c5f8b=>{var _0x448826=_0x52654c;const _0x469ded=await sales[_0x448826(0xb7)]([{'$unwind':_0x448826(0x11d)},{'$match':{'sale_product.id_transaction_from':_0x4c5f8b[_0x448826(0xd1)][_0x448826(0xc6)](),'sale_product.invoice':_0x4c5f8b[_0x448826(0xd0)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x448826(0xcb),'product_code':_0x448826(0xfe),'quantity_available':_0x448826(0xf9),'warehouse_name':_0x448826(0xe6),'warehouse_room':_0x448826(0xfc),'product_invoice':'$sale_product.invoice','invoice':_0x448826(0xf6),'id_transaction_from':_0x448826(0xd4),'date':_0x448826(0xe3),'production_date':'$sale_product.production_date','expiry_date':_0x448826(0xcd),'UOM':_0x448826(0xea)}}]);_0x469ded[_0x448826(0xd5)]>0x0&&_0x4b7de2[_0x448826(0x112)][_0x4d31ac[_0x448826(0xd0)]][_0x448826(0xc7)](..._0x469ded);}));})),_0x4b7de2[_0x7708e4(0x112)]=_0x4b7de2[_0x7708e4(0x112)],_0x4b7de2[_0x7708e4(0xb6)]={},await Promise['all'](_0x4b7de2['map'](async _0x35535b=>{var _0x3b8eb2=_0x7708e4;_0x4b7de2[_0x3b8eb2(0xb6)][_0x35535b['invoice']]=[],await Promise[_0x3b8eb2(0x102)](_0x35535b[_0x3b8eb2(0xfa)][_0x3b8eb2(0xbc)](async _0x2747cc=>{var _0x3d3f9a=_0x3b8eb2;const _0x417e3f=await adjustment[_0x3d3f9a(0xb7)]([{'$unwind':_0x3d3f9a(0xb9)},{'$match':{'product.id_transaction_from':_0x2747cc[_0x3d3f9a(0xd1)][_0x3d3f9a(0xc6)](),'product.invoice':_0x2747cc['invoice']}},{'$project':{'_id':_0x3d3f9a(0xf2),'product_name':_0x3d3f9a(0xc3),'product_code':_0x3d3f9a(0xe1),'quantity_available':'$product.new_adjust_qty','warehouse_name':_0x3d3f9a(0xe6),'warehouse_room':_0x3d3f9a(0x11a),'product_invoice':_0x3d3f9a(0x10b),'invoice':'$invoice','id_transaction_from':_0x3d3f9a(0xee),'date':_0x3d3f9a(0xe3),'production_date':_0x3d3f9a(0xe8),'expiry_date':_0x3d3f9a(0xff),'UOM':_0x3d3f9a(0xe5)}}]);_0x417e3f[_0x3d3f9a(0xd5)]>0x0&&_0x4b7de2[_0x3d3f9a(0xb6)][_0x35535b[_0x3d3f9a(0xd0)]][_0x3d3f9a(0xc7)](..._0x417e3f);}));})),_0x4b7de2['data_transfer']={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x3678a0=>{var _0x484c75=_0x7708e4;_0x4b7de2['data_transfer'][_0x3678a0['invoice']]=[],await Promise[_0x484c75(0x102)](_0x3678a0[_0x484c75(0xfa)][_0x484c75(0xbc)](async _0x3f186c=>{var _0x1c28d7=_0x484c75;const _0x3f4540=await transfers[_0x1c28d7(0xb7)]([{'$unwind':_0x1c28d7(0xb9)},{'$match':{'product.id_transaction_id':_0x3f186c['_id']['valueOf'](),'product.To_invoice':_0x3f186c[_0x1c28d7(0xd0)]}},{'$project':{'_id':_0x1c28d7(0xf2),'product_name':'$product.product_name','product_code':_0x1c28d7(0xe1),'quantity_available':_0x1c28d7(0x110),'warehouse_name':'$to_warehouse','warehouse_room':_0x1c28d7(0x11a),'product_invoice':'$product.to_room_name','invoice':_0x1c28d7(0xf6),'id_transaction_from':'$product.id_transaction_id','date':_0x1c28d7(0xe3),'production_date':_0x1c28d7(0xe8),'expiry_date':_0x1c28d7(0xff),'UOM':_0x1c28d7(0xe5)}}]);_0x3f4540[_0x1c28d7(0xd5)]>0x0&&_0x4b7de2[_0x1c28d7(0x118)][_0x3678a0[_0x1c28d7(0xd0)]][_0x1c28d7(0xc7)](..._0x3f4540);}));})),_0x39631d[_0x7708e4(0xce)]({'purchases_warehouse':_0x4b7de2,'data_sales':_0x4b7de2[_0x7708e4(0x112)],'data_adjustment':_0x4b7de2['data_adjustment'],'data_transfer':_0x4b7de2[_0x7708e4(0x118)]});}else{var _0x4b7de2=await purchases[_0x7708e4(0xb7)]([{'$match':{'warehouse_name':_0x2c547a,'date':{'$gte':_0x97ca37,'$lte':_0x5721a5}}},{'$lookup':{'from':_0x7708e4(0xca),'let':{'invoice':_0x7708e4(0xf6)},'pipeline':[{'$unwind':_0x7708e4(0xe9)},{'$match':{'$expr':{'$eq':[_0x7708e4(0xef),_0x7708e4(0xeb)]}}},{'$project':{'_id':'$product_details._id','product_name':_0x7708e4(0x114),'product_code':_0x7708e4(0xd6),'quantity_available':'$product_details.product_stock','warehouse_name':_0x7708e4(0x108),'warehouse_room':'$room','invoice':_0x7708e4(0xeb),'production_date':_0x7708e4(0x109),'expiry_date':_0x7708e4(0xda),'UOM':_0x7708e4(0x113)}}],'as':_0x7708e4(0xfa)}}]);_0x4b7de2[_0x7708e4(0x112)]={},await Promise['all'](_0x4b7de2['map'](async _0x401a52=>{var _0x3821ae=_0x7708e4;_0x4b7de2['data_sales'][_0x401a52[_0x3821ae(0xd0)]]=[],await Promise[_0x3821ae(0x102)](_0x401a52[_0x3821ae(0xfa)]['map'](async _0x5c6c58=>{var _0x475ae1=_0x3821ae;const _0x4c384b=await sales['aggregate']([{'$unwind':_0x475ae1(0x11d)},{'$match':{'sale_product.id_transaction_from':_0x5c6c58[_0x475ae1(0xd1)]['valueOf'](),'sale_product.invoice':_0x5c6c58[_0x475ae1(0xd0)]}},{'$project':{'_id':'$sale_product._id','product_name':'$sale_product.product_name','product_code':'$sale_product.product_code','quantity_available':_0x475ae1(0xf9),'warehouse_name':_0x475ae1(0xe6),'warehouse_room':_0x475ae1(0xfc),'product_invoice':_0x475ae1(0xe0),'invoice':_0x475ae1(0xf6),'id_transaction_from':_0x475ae1(0xd4),'date':'$date','production_date':_0x475ae1(0xfb),'expiry_date':'$sale_product.expiry_date','UOM':_0x475ae1(0xea)}}]);_0x4c384b[_0x475ae1(0xd5)]>0x0&&_0x4b7de2[_0x475ae1(0x112)][_0x401a52['invoice']][_0x475ae1(0xc7)](..._0x4c384b);}));})),_0x4b7de2[_0x7708e4(0x112)]=_0x4b7de2[_0x7708e4(0x112)],_0x4b7de2['data_adjustment']={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x14eeca=>{var _0xe86e34=_0x7708e4;_0x4b7de2[_0xe86e34(0xb6)][_0x14eeca[_0xe86e34(0xd0)]]=[],await Promise[_0xe86e34(0x102)](_0x14eeca[_0xe86e34(0xfa)]['map'](async _0x5555da=>{var _0x5cb768=_0xe86e34;const _0x241a92=await adjustment[_0x5cb768(0xb7)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x5555da['_id'][_0x5cb768(0xc6)](),'product.invoice':_0x5555da[_0x5cb768(0xd0)]}},{'$project':{'_id':_0x5cb768(0xf2),'product_name':_0x5cb768(0xc3),'product_code':_0x5cb768(0xe1),'quantity_available':_0x5cb768(0xc9),'warehouse_name':_0x5cb768(0xe6),'warehouse_room':_0x5cb768(0x11a),'product_invoice':_0x5cb768(0x10b),'invoice':_0x5cb768(0xf6),'id_transaction_from':_0x5cb768(0xee),'date':_0x5cb768(0xe3),'production_date':_0x5cb768(0xe8),'expiry_date':_0x5cb768(0xff),'UOM':'$product.unit'}}]);_0x241a92[_0x5cb768(0xd5)]>0x0&&_0x4b7de2[_0x5cb768(0xb6)][_0x14eeca[_0x5cb768(0xd0)]][_0x5cb768(0xc7)](..._0x241a92);}));})),_0x4b7de2[_0x7708e4(0x118)]={},await Promise['all'](_0x4b7de2['map'](async _0x4eccc6=>{var _0x347249=_0x7708e4;_0x4b7de2[_0x347249(0x118)][_0x4eccc6[_0x347249(0xd0)]]=[],await Promise[_0x347249(0x102)](_0x4eccc6['warehouse_data'][_0x347249(0xbc)](async _0x5bba25=>{var _0xeb06be=_0x347249;const _0x344e34=await transfers[_0xeb06be(0xb7)]([{'$unwind':_0xeb06be(0xb9)},{'$match':{'product.id_transaction_id':_0x5bba25[_0xeb06be(0xd1)][_0xeb06be(0xc6)](),'product.To_invoice':_0x5bba25[_0xeb06be(0xd0)]}},{'$project':{'_id':_0xeb06be(0xf2),'product_name':_0xeb06be(0xc3),'product_code':_0xeb06be(0xe1),'quantity_available':_0xeb06be(0x110),'warehouse_name':_0xeb06be(0xe2),'warehouse_room':_0xeb06be(0x11a),'product_invoice':_0xeb06be(0xec),'invoice':'$invoice','id_transaction_from':'$product.id_transaction_id','date':_0xeb06be(0xe3),'production_date':_0xeb06be(0xe8),'expiry_date':'$product.expiry_date','UOM':_0xeb06be(0xe5)}}]);_0x344e34[_0xeb06be(0xd5)]>0x0&&_0x4b7de2[_0xeb06be(0x118)][_0x4eccc6[_0xeb06be(0xd0)]]['push'](..._0x344e34);}));})),_0x39631d[_0x7708e4(0xce)]({'purchases_warehouse':_0x4b7de2,'data_sales':_0x4b7de2[_0x7708e4(0x112)],'data_adjustment':_0x4b7de2['data_adjustment'],'data_transfer':_0x4b7de2[_0x7708e4(0x118)]});}}else{if(_0x2c547a==_0x7708e4(0x102)){var _0x4b7de2=await purchases_finished[_0x7708e4(0xb7)]([{'$match':{'date':{'$gte':_0x97ca37,'$lte':_0x5721a5}}},{'$lookup':{'from':_0x7708e4(0xca),'let':{'invoice':_0x7708e4(0xf6)},'pipeline':[{'$unwind':_0x7708e4(0xe9)},{'$match':{'$expr':{'$eq':[_0x7708e4(0xef),'$product_details.invoice']}}},{'$project':{'_id':_0x7708e4(0xdd),'product_name':_0x7708e4(0x114),'product_code':_0x7708e4(0xd6),'quantity_available':_0x7708e4(0xb8),'warehouse_name':_0x7708e4(0x108),'warehouse_room':_0x7708e4(0xc0),'invoice':_0x7708e4(0xeb),'production_date':'$product_details.production_date','expiry_date':_0x7708e4(0xda),'UOM':_0x7708e4(0x113)}}],'as':_0x7708e4(0xfa)}}]);_0x4b7de2[_0x7708e4(0x112)]={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x536224=>{var _0x2a8ae4=_0x7708e4;_0x4b7de2[_0x2a8ae4(0x112)][_0x536224[_0x2a8ae4(0xd0)]]=[],await Promise['all'](_0x536224[_0x2a8ae4(0xfa)][_0x2a8ae4(0xbc)](async _0x378e29=>{var _0x12c22f=_0x2a8ae4;const _0x4a861d=await sales_finished[_0x12c22f(0xb7)]([{'$unwind':'$sale_product'},{'$match':{'sale_product.id_transaction_from':_0x378e29[_0x12c22f(0xd1)][_0x12c22f(0xc6)](),'sale_product.invoice':_0x378e29[_0x12c22f(0xd0)]}},{'$project':{'_id':'$sale_product._id','product_name':_0x12c22f(0xcb),'product_code':_0x12c22f(0xfe),'quantity_available':_0x12c22f(0xf9),'warehouse_name':'$warehouse_name','warehouse_room':_0x12c22f(0xfc),'product_invoice':_0x12c22f(0xe0),'invoice':'$invoice','id_transaction_from':_0x12c22f(0xd4),'date':_0x12c22f(0xe3),'production_date':_0x12c22f(0xfb),'expiry_date':_0x12c22f(0xcd),'UOM':_0x12c22f(0xea)}}]);_0x4a861d[_0x12c22f(0xd5)]>0x0&&_0x4b7de2[_0x12c22f(0x112)][_0x536224[_0x12c22f(0xd0)]]['push'](..._0x4a861d);}));})),_0x4b7de2[_0x7708e4(0x112)]=_0x4b7de2['data_sales'],_0x4b7de2['data_adjustment']={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x14a443=>{var _0x552ec6=_0x7708e4;_0x4b7de2[_0x552ec6(0xb6)][_0x14a443[_0x552ec6(0xd0)]]=[],await Promise[_0x552ec6(0x102)](_0x14a443[_0x552ec6(0xfa)][_0x552ec6(0xbc)](async _0x16ec04=>{var _0x5bfef8=_0x552ec6;const _0x1e8c25=await adjustment_finished[_0x5bfef8(0xb7)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x16ec04['_id'][_0x5bfef8(0xc6)](),'product.invoice':_0x16ec04['invoice']}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x5bfef8(0xe1),'quantity_available':_0x5bfef8(0xc9),'warehouse_name':'$warehouse_name','warehouse_room':_0x5bfef8(0x11a),'product_invoice':'$product.invoice','invoice':_0x5bfef8(0xf6),'id_transaction_from':_0x5bfef8(0xee),'date':_0x5bfef8(0xe3),'production_date':_0x5bfef8(0xe8),'expiry_date':'$product.expiry_date','UOM':_0x5bfef8(0xe5)}}]);_0x1e8c25['length']>0x0&&_0x4b7de2[_0x5bfef8(0xb6)][_0x14a443[_0x5bfef8(0xd0)]][_0x5bfef8(0xc7)](..._0x1e8c25);}));})),_0x4b7de2[_0x7708e4(0x118)]={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x15d63d=>{var _0x376055=_0x7708e4;_0x4b7de2[_0x376055(0x118)][_0x15d63d[_0x376055(0xd0)]]=[],await Promise[_0x376055(0x102)](_0x15d63d[_0x376055(0xfa)]['map'](async _0x2a1961=>{var _0x50a7e7=_0x376055;const _0x3e250d=await transfers_finished[_0x50a7e7(0xb7)]([{'$unwind':_0x50a7e7(0xb9)},{'$match':{'product.id_transaction':_0x2a1961[_0x50a7e7(0xd1)][_0x50a7e7(0xc6)](),'product.from_invoice':_0x2a1961[_0x50a7e7(0xd0)]}},{'$project':{'_id':_0x50a7e7(0xf2),'product_name':'$product.product_name','product_code':_0x50a7e7(0xe1),'quantity_available':_0x50a7e7(0x110),'warehouse_name':_0x50a7e7(0xe2),'warehouse_room':_0x50a7e7(0x11a),'product_invoice':_0x50a7e7(0xec),'invoice':_0x50a7e7(0xf6),'id_transaction_from':_0x50a7e7(0xe7),'date':'$date','production_date':_0x50a7e7(0xe8),'expiry_date':'$product.expiry_date','UOM':_0x50a7e7(0xe5)}}]);_0x3e250d[_0x50a7e7(0xd5)]>0x0&&_0x4b7de2[_0x50a7e7(0x118)][_0x15d63d[_0x50a7e7(0xd0)]][_0x50a7e7(0xc7)](..._0x3e250d);}));})),_0x39631d[_0x7708e4(0xce)]({'purchases_warehouse':_0x4b7de2,'data_sales':_0x4b7de2['data_sales'],'data_adjustment':_0x4b7de2[_0x7708e4(0xb6)],'data_transfer':_0x4b7de2[_0x7708e4(0x118)]});}else{var _0x4b7de2=await purchases_finished[_0x7708e4(0xb7)]([{'$match':{'warehouse_name':_0x2c547a,'date':{'$gte':_0x97ca37,'$lte':_0x5721a5}}},{'$lookup':{'from':'warehouses','let':{'invoice':_0x7708e4(0xf6)},'pipeline':[{'$unwind':_0x7708e4(0xe9)},{'$match':{'$expr':{'$eq':[_0x7708e4(0xef),_0x7708e4(0xeb)]}}},{'$project':{'_id':_0x7708e4(0xdd),'product_name':'$product_details.product_name','product_code':'$product_details.product_code','quantity_available':_0x7708e4(0xb8),'warehouse_name':_0x7708e4(0x108),'warehouse_room':_0x7708e4(0xc0),'invoice':'$product_details.invoice','production_date':_0x7708e4(0x109),'expiry_date':_0x7708e4(0xda),'UOM':'$product_details.unit'}}],'as':_0x7708e4(0xfa)}}]);_0x4b7de2[_0x7708e4(0x112)]={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x49fa2f=>{var _0x1264f7=_0x7708e4;_0x4b7de2[_0x1264f7(0x112)][_0x49fa2f[_0x1264f7(0xd0)]]=[],await Promise[_0x1264f7(0x102)](_0x49fa2f[_0x1264f7(0xfa)][_0x1264f7(0xbc)](async _0x2b2783=>{var _0x1b5cd9=_0x1264f7;const _0x4a26ca=await sales_finished[_0x1b5cd9(0xb7)]([{'$unwind':_0x1b5cd9(0x11d)},{'$match':{'sale_product.id_transaction_from':_0x2b2783[_0x1b5cd9(0xd1)][_0x1b5cd9(0xc6)](),'sale_product.invoice':_0x2b2783['invoice']}},{'$project':{'_id':'$sale_product._id','product_name':_0x1b5cd9(0xcb),'product_code':'$sale_product.product_code','quantity_available':_0x1b5cd9(0xf9),'warehouse_name':_0x1b5cd9(0xe6),'warehouse_room':_0x1b5cd9(0xfc),'product_invoice':'$sale_product.invoice','invoice':'$invoice','id_transaction_from':_0x1b5cd9(0xd4),'date':_0x1b5cd9(0xe3),'production_date':_0x1b5cd9(0xfb),'expiry_date':_0x1b5cd9(0xcd),'UOM':_0x1b5cd9(0xea)}}]);_0x4a26ca[_0x1b5cd9(0xd5)]>0x0&&_0x4b7de2[_0x1b5cd9(0x112)][_0x49fa2f['invoice']][_0x1b5cd9(0xc7)](..._0x4a26ca);}));})),_0x4b7de2[_0x7708e4(0x112)]=_0x4b7de2[_0x7708e4(0x112)],_0x4b7de2['data_adjustment']={},await Promise[_0x7708e4(0x102)](_0x4b7de2[_0x7708e4(0xbc)](async _0x5b366a=>{var _0x1a1d16=_0x7708e4;_0x4b7de2[_0x1a1d16(0xb6)][_0x5b366a['invoice']]=[],await Promise[_0x1a1d16(0x102)](_0x5b366a[_0x1a1d16(0xfa)][_0x1a1d16(0xbc)](async _0x5227ac=>{var _0x576e8e=_0x1a1d16;const _0x2f7002=await adjustment_finished[_0x576e8e(0xb7)]([{'$unwind':'$product'},{'$match':{'product.id_transaction_from':_0x5227ac['_id'][_0x576e8e(0xc6)](),'product.invoice':_0x5227ac['invoice']}},{'$project':{'_id':_0x576e8e(0xf2),'product_name':_0x576e8e(0xc3),'product_code':_0x576e8e(0xe1),'quantity_available':_0x576e8e(0xc9),'warehouse_name':_0x576e8e(0xe6),'warehouse_room':_0x576e8e(0x11a),'product_invoice':_0x576e8e(0x10b),'invoice':_0x576e8e(0xf6),'id_transaction_from':'$product.id_transaction_from','date':_0x576e8e(0xe3),'production_date':_0x576e8e(0xe8),'expiry_date':_0x576e8e(0xff),'UOM':'$product.unit'}}]);_0x2f7002[_0x576e8e(0xd5)]>0x0&&_0x4b7de2[_0x576e8e(0xb6)][_0x5b366a['invoice']]['push'](..._0x2f7002);}));})),_0x4b7de2[_0x7708e4(0x118)]={},await Promise[_0x7708e4(0x102)](_0x4b7de2['map'](async _0x4bb3b7=>{var _0x39f121=_0x7708e4;_0x4b7de2[_0x39f121(0x118)][_0x4bb3b7['invoice']]=[],await Promise['all'](_0x4bb3b7[_0x39f121(0xfa)][_0x39f121(0xbc)](async _0x57fb85=>{var _0x50015f=_0x39f121;const _0x6024a2=await transfers_finished['aggregate']([{'$unwind':_0x50015f(0xb9)},{'$match':{'product.id_transaction':_0x57fb85[_0x50015f(0xd1)][_0x50015f(0xc6)](),'product.from_invoice':_0x57fb85[_0x50015f(0xd0)]}},{'$project':{'_id':'$product._id','product_name':'$product.product_name','product_code':_0x50015f(0xe1),'quantity_available':'$product.to_quantity','warehouse_name':_0x50015f(0xe2),'warehouse_room':'$product.room_names','product_invoice':_0x50015f(0xec),'invoice':_0x50015f(0xf6),'id_transaction_from':_0x50015f(0xe7),'date':_0x50015f(0xe3),'production_date':'$product.production_date','expiry_date':'$product.expiry_date','UOM':_0x50015f(0xe5)}}]);_0x6024a2[_0x50015f(0xd5)]>0x0&&_0x4b7de2[_0x50015f(0x118)][_0x4bb3b7['invoice']][_0x50015f(0xc7)](..._0x6024a2);}));})),_0x39631d[_0x7708e4(0xce)]({'purchases_warehouse':_0x4b7de2,'data_sales':_0x4b7de2[_0x7708e4(0x112)],'data_adjustment':_0x4b7de2[_0x7708e4(0xb6)],'data_transfer':_0x4b7de2[_0x7708e4(0x118)]});}}}),router['get'](a0_0x4618b(0xed),auth,async(_0x4dfeed,_0x5b7a57)=>{var _0x35405a=a0_0x4618b;try{const _0x1806ac=_0x4dfeed['params']['id'];var _0x1a1ac4=await purchases_finished[_0x35405a(0xdc)](_0x1806ac);const _0x30f65f=await master_shop[_0x35405a(0x103)](),_0x5ca1e4=_0x4dfeed[_0x35405a(0xba)],_0x5bb820=await profile[_0x35405a(0x10c)]({'email':_0x5ca1e4['email']});if(_0x30f65f[0x0][_0x35405a(0x11e)]=='English\x20(US)')var _0x1cdf66=users['English'];else{if(_0x30f65f[0x0][_0x35405a(0x11e)]==_0x35405a(0xe4))var _0x1cdf66=users[_0x35405a(0xe4)];else{if(_0x30f65f[0x0]['language']==_0x35405a(0xbe))var _0x1cdf66=users[_0x35405a(0xbe)];else{if(_0x30f65f[0x0][_0x35405a(0x11e)]=='Spanish')var _0x1cdf66=users[_0x35405a(0xc4)];else{if(_0x30f65f[0x0]['language']==_0x35405a(0xc8))var _0x1cdf66=users[_0x35405a(0xc8)];else{if(_0x30f65f[0x0][_0x35405a(0x11e)]=='Portuguese\x20(BR)')var _0x1cdf66=users[_0x35405a(0xd8)];else{if(_0x30f65f[0x0][_0x35405a(0x11e)]==_0x35405a(0x11c))var _0x1cdf66=users[_0x35405a(0x11c)];else{if(_0x30f65f[0x0][_0x35405a(0x11e)]==_0x35405a(0x10d))var _0x1cdf66=users[_0x35405a(0x11f)];}}}}}}}_0x5b7a57['render'](_0x35405a(0x106),{'success':_0x4dfeed[_0x35405a(0xc5)](_0x35405a(0xf4)),'errors':_0x4dfeed[_0x35405a(0xc5)]('errors'),'master_shop':_0x30f65f,'profile':_0x5bb820,'role':_0x5ca1e4,'language':_0x1cdf66,'data':_0x1a1ac4});}catch(_0x11fc69){_0x5b7a57['json'](_0x11fc69);}}),router['get'](a0_0x4618b(0xd7),auth,async(_0x1004bd,_0x136599)=>{var _0x23c30b=a0_0x4618b;try{const _0x1f5f7c=_0x1004bd[_0x23c30b(0x10e)]['id'];var _0xa0122=await sales_finished[_0x23c30b(0xdc)](_0x1f5f7c);const _0x7b88c9=await master_shop[_0x23c30b(0x103)](),_0x2e2c7b=_0x1004bd[_0x23c30b(0xba)],_0xecd6c2=await profile['findOne']({'email':_0x2e2c7b[_0x23c30b(0xbd)]});if(_0x7b88c9[0x0][_0x23c30b(0x11e)]==_0x23c30b(0xbb))var _0x506e08=users[_0x23c30b(0xc2)];else{if(_0x7b88c9[0x0][_0x23c30b(0x11e)]=='Hindi')var _0x506e08=users[_0x23c30b(0xe4)];else{if(_0x7b88c9[0x0][_0x23c30b(0x11e)]=='German')var _0x506e08=users[_0x23c30b(0xbe)];else{if(_0x7b88c9[0x0][_0x23c30b(0x11e)]==_0x23c30b(0xc4))var _0x506e08=users['Spanish'];else{if(_0x7b88c9[0x0]['language']==_0x23c30b(0xc8))var _0x506e08=users[_0x23c30b(0xc8)];else{if(_0x7b88c9[0x0][_0x23c30b(0x11e)]==_0x23c30b(0xfd))var _0x506e08=users[_0x23c30b(0xd8)];else{if(_0x7b88c9[0x0][_0x23c30b(0x11e)]==_0x23c30b(0x11c))var _0x506e08=users[_0x23c30b(0x11c)];else{if(_0x7b88c9[0x0][_0x23c30b(0x11e)]==_0x23c30b(0x10d))var _0x506e08=users[_0x23c30b(0x11f)];}}}}}}}_0x136599[_0x23c30b(0xf3)](_0x23c30b(0xf5),{'success':_0x1004bd[_0x23c30b(0xc5)](_0x23c30b(0xf4)),'errors':_0x1004bd[_0x23c30b(0xc5)]('errors'),'master_shop':_0x7b88c9,'profile':_0xecd6c2,'role':_0x2e2c7b,'language':_0x506e08,'data':_0xa0122});}catch(_0x59d8dc){_0x136599[_0x23c30b(0xce)](_0x59d8dc);}}),router[a0_0x4618b(0x115)]('/viewdata_tf_fg/:id',auth,async(_0x57a477,_0x114b31)=>{var _0x3be88d=a0_0x4618b;try{const _0x5c6e72=_0x57a477[_0x3be88d(0x10e)]['id'];var _0x2d2459=await transfers_finished[_0x3be88d(0xdc)](_0x5c6e72);const _0x19f383=await master_shop['find'](),_0x69e4ab=_0x57a477[_0x3be88d(0xba)],_0x37a68c=await profile[_0x3be88d(0x10c)]({'email':_0x69e4ab['email']});if(_0x19f383[0x0][_0x3be88d(0x11e)]==_0x3be88d(0xbb))var _0x2ed865=users[_0x3be88d(0xc2)];else{if(_0x19f383[0x0][_0x3be88d(0x11e)]==_0x3be88d(0xe4))var _0x2ed865=users['Hindi'];else{if(_0x19f383[0x0][_0x3be88d(0x11e)]==_0x3be88d(0xbe))var _0x2ed865=users['German'];else{if(_0x19f383[0x0][_0x3be88d(0x11e)]==_0x3be88d(0xc4))var _0x2ed865=users[_0x3be88d(0xc4)];else{if(_0x19f383[0x0]['language']==_0x3be88d(0xc8))var _0x2ed865=users[_0x3be88d(0xc8)];else{if(_0x19f383[0x0][_0x3be88d(0x11e)]=='Portuguese\x20(BR)')var _0x2ed865=users['Portuguese'];else{if(_0x19f383[0x0][_0x3be88d(0x11e)]==_0x3be88d(0x11c))var _0x2ed865=users[_0x3be88d(0x11c)];else{if(_0x19f383[0x0]['language']==_0x3be88d(0x10d))var _0x2ed865=users[_0x3be88d(0x11f)];}}}}}}}_0x114b31['render'](_0x3be88d(0xf0),{'success':_0x57a477[_0x3be88d(0xc5)](_0x3be88d(0xf4)),'errors':_0x57a477['flash'](_0x3be88d(0xd9)),'master_shop':_0x19f383,'profile':_0x37a68c,'role':_0x69e4ab,'language':_0x2ed865,'data':_0x2d2459});}catch(_0x2c8760){_0x114b31['json'](_0x2c8760);}}),router['get']('/viewFG',auth,async(_0x538cd5,_0x4f834f)=>{var _0x4962de=a0_0x4618b;try{const {username:_0x4831d9,email:_0x1607be,role:_0x4d5acc}=_0x538cd5['user'],_0x241a54=_0x538cd5['user'],_0x4a1d89=await profile[_0x4962de(0x10c)]({'email':_0x241a54[_0x4962de(0xbd)]}),_0x4c002b=await master_shop[_0x4962de(0x103)](),_0x32bcff=await warehouse[_0x4962de(0xb7)]([{'$match':{'status':_0x4962de(0xd2),'warehouse_category':_0x4962de(0xde)}},{'$group':{'_id':_0x4962de(0x108),'name':{'$first':_0x4962de(0x108)}}}]);if(_0x4c002b[0x0]['language']==_0x4962de(0xbb))var _0xb89688=users[_0x4962de(0xc2)];else{if(_0x4c002b[0x0]['language']==_0x4962de(0xe4))var _0xb89688=users[_0x4962de(0xe4)];else{if(_0x4c002b[0x0][_0x4962de(0x11e)]==_0x4962de(0xbe))var _0xb89688=users[_0x4962de(0xbe)];else{if(_0x4c002b[0x0][_0x4962de(0x11e)]==_0x4962de(0xc4))var _0xb89688=users['Spanish'];else{if(_0x4c002b[0x0][_0x4962de(0x11e)]==_0x4962de(0xc8))var _0xb89688=users['French'];else{if(_0x4c002b[0x0][_0x4962de(0x11e)]=='Portuguese\x20(BR)')var _0xb89688=users['Portuguese'];else{if(_0x4c002b[0x0][_0x4962de(0x11e)]==_0x4962de(0x11c))var _0xb89688=users[_0x4962de(0x11c)];else{if(_0x4c002b[0x0]['language']==_0x4962de(0x10d))var _0xb89688=users[_0x4962de(0x11f)];}}}}}}}_0x4f834f[_0x4962de(0xf3)](_0x4962de(0x105),{'success':_0x538cd5[_0x4962de(0xc5)](_0x4962de(0xf4)),'errors':_0x538cd5[_0x4962de(0xc5)]('errors'),'role':_0x241a54,'profile':_0x4a1d89,'master_shop':_0x4c002b,'dataProcess':_0x32bcff,'language':_0xb89688});}catch(_0x4b2147){console[_0x4962de(0xf7)](_0x4b2147);}}),module['exports']=router;function a0_0x5e5c(){var _0x5fa034=['Portuguese\x20(BR)','$sale_product.product_code','$product.expiry_date','nodemailer','1781180YuiuvI','all','find','body','transaction_finished_raw','view_table','express','$name','$product_details.production_date','/reports','$product.invoice','findOne','Arabic\x20(ae)','params','1734166WGtugR','$product.to_quantity','933867cpMnxO','data_sales','$product_details.unit','$product_details.product_name','get','Finished\x20Goods','transaction_finished','data_transfer','Router','$product.room_names','post','Chinese','$sale_product','language','Arabic','data_adjustment','aggregate','$product_details.product_stock','$product','user','English\x20(US)','map','email','German','2kITWzG','$room','../public/language/languages.json','English','$product.product_name','Spanish','flash','valueOf','push','French','$product.new_adjust_qty','warehouses','$sale_product.product_name','/view','$sale_product.expiry_date','json','1339848vyQfNH','invoice','_id','Enabled','3216472tKrkHN','$sale_product.id_transaction_from','length','$product_details.product_code','/viewdata_og_fg/:id','Portuguese','errors','$product_details.expiry_date','185668CCWQox','findById','$product_details._id','Raw\x20Materials','217600QdhtAr','$sale_product.invoice','$product.product_code','$to_warehouse','$date','Hindi','$product.unit','$warehouse_name','$product.id_transaction','$product.production_date','$product_details','$sale_product.unit','$product_details.invoice','$product.to_room_name','/viewdata_inc_fg/:id','$product.id_transaction_from','$$invoice','view_tf_table','../middleware/auth','$product._id','render','success','view_og_table','$invoice','log','../models/all_models','$sale_product.quantity','warehouse_data','$sale_product.production_date','$sale_product.room_name'];a0_0x5e5c=function(){return _0x5fa034;};return a0_0x5e5c();}