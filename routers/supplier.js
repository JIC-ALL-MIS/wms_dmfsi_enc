const a0_0x56363f=a0_0x5b17;(function(_0x2c1bed,_0x56da01){const _0x51bd7a=a0_0x5b17,_0x570846=_0x2c1bed();while(!![]){try{const _0x7c0255=-parseInt(_0x51bd7a(0xaf))/0x1+-parseInt(_0x51bd7a(0xbb))/0x2*(parseInt(_0x51bd7a(0xc9))/0x3)+parseInt(_0x51bd7a(0x74))/0x4+parseInt(_0x51bd7a(0xb7))/0x5*(parseInt(_0x51bd7a(0xa7))/0x6)+parseInt(_0x51bd7a(0x78))/0x7+-parseInt(_0x51bd7a(0x86))/0x8+parseInt(_0x51bd7a(0xd1))/0x9*(parseInt(_0x51bd7a(0x87))/0xa);if(_0x7c0255===_0x56da01)break;else _0x570846['push'](_0x570846['shift']());}catch(_0x32c5c6){_0x570846['push'](_0x570846['shift']());}}}(a0_0x35bd,0xdb630));const express=require(a0_0x56363f(0x85)),app=express(),router=express[a0_0x56363f(0xc3)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x56363f(0x9c)),auth=require('../middleware/auth'),users=require(a0_0x56363f(0x94)),excelJS=require(a0_0x56363f(0xab)),xlsx=require(a0_0x56363f(0x90)),multer=require(a0_0x56363f(0xbc));router[a0_0x56363f(0x6f)](a0_0x56363f(0x70),auth,async(_0x128d5f,_0x4576ca)=>{const _0xfb1b17=a0_0x56363f;try{const {username:_0x367faf,email:_0x58d575,role:_0x3d7696}=_0x128d5f[_0xfb1b17(0xd0)],_0x3faffa=_0x128d5f['user'],_0x145d5b=await profile[_0xfb1b17(0xa5)]({'email':_0x3faffa[_0xfb1b17(0x8f)]}),_0x229634=await master_shop[_0xfb1b17(0x76)]();console[_0xfb1b17(0x8d)]('master',_0x229634);const _0x42fcfd=await suppliers[_0xfb1b17(0x76)]();console[_0xfb1b17(0x8d)](_0x42fcfd);const _0x9496fe=await suppliers['aggregate']([{'$lookup':{'from':_0xfb1b17(0xad),'localField':'name','foreignField':_0xfb1b17(0xd2),'as':_0xfb1b17(0xcf)}}]),_0x199705=_0x9496fe[_0xfb1b17(0x73)](_0x117b09=>{const _0x2a27a8=_0xfb1b17;console[_0x2a27a8(0x8d)](_0x2a27a8(0xc1),_0x117b09);var _0x4366e0=0x0,_0x101ad9=0x0;return _0x117b09[_0x2a27a8(0xcf)]['forEach'](_0x1c9722=>{const _0x47155a=_0x2a27a8;console['log'](_0x47155a(0xdc),_0x1c9722),_0x1c9722[_0x47155a(0x7e)]==_0x47155a(0x7c)?_0x4366e0+=_0x1c9722[_0x47155a(0xd7)]:_0x101ad9+=_0x1c9722[_0x47155a(0xd7)];}),_0x117b09[_0x2a27a8(0xb0)]=_0x4366e0,_0x117b09[_0x2a27a8(0x98)]=_0x101ad9,_0x117b09;});console[_0xfb1b17(0x8d)]('supplier.js\x20payment_data',_0x199705);if(_0x229634[0x0][_0xfb1b17(0xb8)]==_0xfb1b17(0xb5)){var _0x672ffa=users[_0xfb1b17(0xaa)];console[_0xfb1b17(0x8d)](_0x672ffa);}else{if(_0x229634[0x0][_0xfb1b17(0xb8)]==_0xfb1b17(0xb6))var _0x672ffa=users[_0xfb1b17(0xb6)];else{if(_0x229634[0x0]['language']==_0xfb1b17(0xbd))var _0x672ffa=users['German'];else{if(_0x229634[0x0][_0xfb1b17(0xb8)]=='Spanish')var _0x672ffa=users[_0xfb1b17(0x81)];else{if(_0x229634[0x0][_0xfb1b17(0xb8)]=='French')var _0x672ffa=users[_0xfb1b17(0xc2)];else{if(_0x229634[0x0][_0xfb1b17(0xb8)]=='Portuguese\x20(BR)')var _0x672ffa=users[_0xfb1b17(0xba)];else{if(_0x229634[0x0][_0xfb1b17(0xb8)]==_0xfb1b17(0xb2))var _0x672ffa=users[_0xfb1b17(0xb2)];else{if(_0x229634[0x0][_0xfb1b17(0xb8)]=='Arabic\x20(ae)')var _0x672ffa=users[_0xfb1b17(0xb9)];}}}}}}}_0x4576ca[_0xfb1b17(0xda)]('supplier',{'success':_0x128d5f['flash'](_0xfb1b17(0x96)),'errors':_0x128d5f[_0xfb1b17(0x9d)](_0xfb1b17(0xdd)),'user':_0x42fcfd,'profile':_0x145d5b,'master_shop':_0x229634,'role':_0x3faffa,'payment':_0x199705,'language':_0x672ffa});}catch(_0x390af6){console[_0xfb1b17(0x8d)](_0x390af6);}}),router[a0_0x56363f(0xd6)]('/view',auth,async(_0xe6240c,_0x39cf6d)=>{const _0x2e69ca=a0_0x56363f;try{const {name:_0x4a74aa,email:_0x545517,mobile:_0x1bac20,company:_0x3cb4cb,address:_0x4f9174,receivable:_0x2113eb,payable:_0xbf19c8,code:_0x3b2b8a,contactperson:_0x78ec9b,landline:_0x2fbef5}=_0xe6240c[_0x2e69ca(0xca)],_0x449afc=new suppliers({'name':_0x4a74aa,'email':_0x545517,'mobile':_0x1bac20,'company':_0x3cb4cb,'address':_0x4f9174,'receivable':_0x2113eb,'payable':_0xbf19c8,'suppliers_code':_0x3b2b8a,'contactperson':_0x78ec9b,'landline':_0x2fbef5}),_0x2eb8e1=await _0x449afc[_0x2e69ca(0xae)]();_0xe6240c['flash'](_0x2e69ca(0x96),'supplier\x20data\x20add\x20successfully'),_0x39cf6d[_0x2e69ca(0x93)](_0x2e69ca(0xb1));}catch(_0x98b886){console[_0x2e69ca(0x8d)](_0x98b886);}}),router[a0_0x56363f(0x6f)](a0_0x56363f(0xc4),auth,async(_0x5b082b,_0xbfd083)=>{const _0x26f9c9=a0_0x56363f;try{const {username:_0x25b3c6,email:_0x53e798,role:_0x2b09f1}=_0x5b082b[_0x26f9c9(0xd0)],_0x41800b=_0x5b082b[_0x26f9c9(0xd0)],_0x580bf2=await profile[_0x26f9c9(0xa5)]({'email':_0x41800b[_0x26f9c9(0x8f)]}),_0x3a7a41=await master_shop['find']();console['log'](_0x26f9c9(0xc6),_0x3a7a41);const _0x1fb6c6=_0x5b082b['params']['id'],_0x4af4b2=await suppliers[_0x26f9c9(0x95)](_0x1fb6c6);console[_0x26f9c9(0x8d)](_0x4af4b2);if(_0x3a7a41[0x0][_0x26f9c9(0xb8)]=='English\x20(US)'){var _0x511fc2=users[_0x26f9c9(0xaa)];console[_0x26f9c9(0x8d)](_0x511fc2);}else{if(_0x3a7a41[0x0]['language']==_0x26f9c9(0xb6))var _0x511fc2=users[_0x26f9c9(0xb6)];else{if(_0x3a7a41[0x0][_0x26f9c9(0xb8)]==_0x26f9c9(0xbd))var _0x511fc2=users[_0x26f9c9(0xbd)];else{if(_0x3a7a41[0x0][_0x26f9c9(0xb8)]==_0x26f9c9(0x81))var _0x511fc2=users[_0x26f9c9(0x81)];else{if(_0x3a7a41[0x0]['language']==_0x26f9c9(0xc2))var _0x511fc2=users[_0x26f9c9(0xc2)];else{if(_0x3a7a41[0x0]['language']==_0x26f9c9(0x8a))var _0x511fc2=users[_0x26f9c9(0xba)];else{if(_0x3a7a41[0x0][_0x26f9c9(0xb8)]==_0x26f9c9(0xb2))var _0x511fc2=users['Chinese'];else{if(_0x3a7a41[0x0][_0x26f9c9(0xb8)]==_0x26f9c9(0x8b))var _0x511fc2=users[_0x26f9c9(0xb9)];}}}}}}}_0xbfd083[_0x26f9c9(0xda)](_0x26f9c9(0x7a),{'success':_0x5b082b[_0x26f9c9(0x9d)](_0x26f9c9(0x96)),'errors':_0x5b082b['flash'](_0x26f9c9(0xdd)),'role':_0x41800b,'profile':_0x580bf2,'master_shop':_0x3a7a41,'user':_0x4af4b2,'language':_0x511fc2});}catch(_0x2efd17){console[_0x26f9c9(0x8d)](_0x2efd17);}}),router['post'](a0_0x56363f(0xc4),auth,async(_0x36bc79,_0x4e1254)=>{const _0x5a1e30=a0_0x56363f;try{const _0x24adf2=_0x36bc79[_0x5a1e30(0x9f)]['id'],_0x47a899=await suppliers[_0x5a1e30(0x95)](_0x24adf2),{name:_0x54aa3d,email:_0x56108b,mobile:_0xba70fd,company:_0x429049,address:_0x2204fb,receivable:_0x4d1f51,payable:_0x510f73,code:_0x103a4a,contactperson:_0x28af76,landline:_0x4c5493}=_0x36bc79[_0x5a1e30(0xca)];_0x47a899['name']=_0x54aa3d,_0x47a899['email']=_0x56108b,_0x47a899[_0x5a1e30(0x77)]=_0xba70fd,_0x47a899['company']=_0x429049,_0x47a899['address']=_0x2204fb,_0x47a899[_0x5a1e30(0x89)]=_0x4d1f51,_0x47a899[_0x5a1e30(0xa2)]=_0x510f73,_0x47a899[_0x5a1e30(0xa3)]=_0x103a4a,_0x47a899['contactperson']=_0x28af76,_0x47a899[_0x5a1e30(0x80)]=_0x4c5493;const _0x2081b1=await _0x47a899[_0x5a1e30(0xae)]();_0x36bc79[_0x5a1e30(0x9d)]('success',_0x5a1e30(0xd3)),_0x4e1254[_0x5a1e30(0x93)]('/supplier/view');}catch(_0x434e54){console[_0x5a1e30(0x8d)](_0x434e54);}}),router['get'](a0_0x56363f(0x9a),auth,async(_0xb5e279,_0x17a79b)=>{const _0x42cb8a=a0_0x56363f;try{const {username:_0x10ec0f,email:_0x49fa0d,role:_0x16730e}=_0xb5e279[_0x42cb8a(0xd0)],_0x5a14e8=_0xb5e279[_0x42cb8a(0xd0)],_0x448e5f=await profile['findOne']({'email':_0x5a14e8['email']}),_0x5a51cf=await master_shop[_0x42cb8a(0x76)]();console['log'](_0x42cb8a(0xc6),_0x5a51cf),console[_0x42cb8a(0x8d)](_0xb5e279[_0x42cb8a(0x9f)]['id']);const _0x5a75a7=await suppliers[_0x42cb8a(0xa5)]({'_id':_0xb5e279[_0x42cb8a(0x9f)]['id']});console[_0x42cb8a(0x8d)](_0x5a75a7);const _0x10893f=await s_payment_data['find']({'suppliers':_0x5a75a7[_0x42cb8a(0x92)]});console[_0x42cb8a(0x8d)](_0x10893f);const _0x5208c3=await s_payment_data[_0x42cb8a(0xbe)]([{'$match':{'suppliers':_0x5a75a7[_0x42cb8a(0x92)]}},{'$match':{'reason':_0x42cb8a(0x7c)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x42cb8a(0xbf)}}}]);console[_0x42cb8a(0x8d)](_0x42cb8a(0xd5),_0x5208c3);const _0x3338b3=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x5a75a7[_0x42cb8a(0x92)]}},{'$match':{'reason':_0x42cb8a(0xa1)}},{'$group':{'_id':_0x42cb8a(0x75),'sum':{'$sum':_0x42cb8a(0xbf)}}}]);console[_0x42cb8a(0x8d)]('receivable_sum',_0x3338b3);if(_0x5a51cf[0x0][_0x42cb8a(0xb8)]==_0x42cb8a(0xb5)){var _0x4b9963=users[_0x42cb8a(0xaa)];console[_0x42cb8a(0x8d)](_0x4b9963);}else{if(_0x5a51cf[0x0][_0x42cb8a(0xb8)]==_0x42cb8a(0xb6))var _0x4b9963=users[_0x42cb8a(0xb6)];else{if(_0x5a51cf[0x0][_0x42cb8a(0xb8)]==_0x42cb8a(0xbd))var _0x4b9963=users[_0x42cb8a(0xbd)];else{if(_0x5a51cf[0x0]['language']==_0x42cb8a(0x81))var _0x4b9963=users[_0x42cb8a(0x81)];else{if(_0x5a51cf[0x0][_0x42cb8a(0xb8)]==_0x42cb8a(0xc2))var _0x4b9963=users[_0x42cb8a(0xc2)];else{if(_0x5a51cf[0x0][_0x42cb8a(0xb8)]==_0x42cb8a(0x8a))var _0x4b9963=users[_0x42cb8a(0xba)];else{if(_0x5a51cf[0x0][_0x42cb8a(0xb8)]==_0x42cb8a(0xb2))var _0x4b9963=users['Chinese'];else{if(_0x5a51cf[0x0][_0x42cb8a(0xb8)]==_0x42cb8a(0x8b))var _0x4b9963=users[_0x42cb8a(0xb9)];}}}}}}}_0x17a79b[_0x42cb8a(0xda)](_0x42cb8a(0xc5),{'success':_0xb5e279[_0x42cb8a(0x9d)]('success'),'errors':_0xb5e279[_0x42cb8a(0x9d)](_0x42cb8a(0xdd)),'role':_0x5a14e8,'profile':_0x448e5f,'master_shop':_0x5a51cf,'payment':_0x10893f,'payable':_0x5208c3,'receivable':_0x3338b3,'language':_0x4b9963});}catch(_0x26546c){console[_0x42cb8a(0x8d)](_0x26546c);}}),router[a0_0x56363f(0x6f)](a0_0x56363f(0xac),auth,async(_0xd09492,_0x440753)=>{const _0x49709f=a0_0x56363f;try{const _0x5a4968=new excelJS[(_0x49709f(0xa6))](),_0x153a5c=_0x5a4968[_0x49709f(0xcc)](_0x49709f(0xa0));return _0x153a5c[_0x49709f(0xce)]=[{'header':'Name','key':_0x49709f(0xdb),'width':0xa},{'header':_0x49709f(0x84),'key':'PUnits','width':0xa},{'header':_0x49709f(0xa4),'key':'SalesmanName','width':0xa},{'header':'Mobile_number','key':'address','width':0xa},{'header':_0x49709f(0xb4),'key':'mobile','width':0xa},{'header':_0x49709f(0xd8),'key':_0x49709f(0x8f),'width':0xa}],_0x440753[_0x49709f(0xd4)](_0x49709f(0x82),_0x49709f(0xcb)),_0x440753[_0x49709f(0xd4)](_0x49709f(0x71),_0x49709f(0x88)),_0x5a4968[_0x49709f(0x90)]['write'](_0x440753)[_0x49709f(0x7f)](()=>{const _0x59040d=_0x49709f;_0x440753[_0x59040d(0xc0)](0xc8);});}catch(_0xcea8bf){_0x440753['status'](0x190)[_0x49709f(0x97)]({'errors':_0xcea8bf[_0x49709f(0x79)]});}});function a0_0x5b17(_0x2c348f,_0x23c6a8){const _0x35bd4b=a0_0x35bd();return a0_0x5b17=function(_0x5b1729,_0x38a75a){_0x5b1729=_0x5b1729-0x6f;let _0x26aa67=_0x35bd4b[_0x5b1729];return _0x26aa67;},a0_0x5b17(_0x2c348f,_0x23c6a8);}function a0_0x35bd(){const _0x3f57da=['Mobile_number','459273AIKYEG','body','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','addWorksheet','/supplier_import_migrate_file','columns','suppliers_docs','user','13662387FYvcLW','suppliers','supplier\x20data\x20update\x20successfully','setHeader','payable_sum','post','amount','address','sheet_to_json','render','PBrands','doc','errors','get','/view','Content-Disposition','supplier_product_file','map','319240XxabMw','$reason','find','mobile','2777124JXxSMA','message','supplier','Sheets','Purchase','readFile','reason','then','landline','Spanish','Content-Type','utils','Supplier_Code','express','6133848Osxvcd','10nGKYia','attachment;\x20filename=supplier_Migration_File.xlsx','receivable','Portuguese\x20(BR)','Arabic\x20(ae)','now','log','error','email','xlsx','filename','name','redirect','../public/language/languages.json','findById','success','send','purchase_return','\x20Failed','/view/payment/:id','public/Migration/','../models/all_models','flash','\x20added\x20successfully','params','Customers','Purchase\x20Return','payable','suppliers_code','Email','findOne','Workbook','235092kZEzZq','file','json','English','exceljs','/products_export_migrate_file','s_payments','save','959795aRepdQ','purchase','/supplier/view','Chinese','single','Company_Name','English\x20(US)','Hindi','100xgynWP','language','Arabic','Portuguese','2IuYsDc','multer','German','aggregate','$amount','status','data','French','Router','/view/:id','supplier_payment','master','SheetNames'];a0_0x35bd=function(){return _0x3f57da;};return a0_0x35bd();}const storage1=multer['diskStorage']({'destination':(_0x34ae29,_0x475bcd,_0x24bc4c)=>{_0x24bc4c(null,'public/Migration');},'filename':(_0x2b7088,_0x4ae044,_0x26ebb7)=>{const _0x3bbcc5=a0_0x56363f;_0x26ebb7(null,Date[_0x3bbcc5(0x8c)]()+_0x4ae044['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x56363f(0xd6)](a0_0x56363f(0xcd),auth,uploadMigrate[a0_0x56363f(0xb3)](a0_0x56363f(0x72)),async(_0x5d6ba1,_0x24c0e3)=>{const _0x4b2df4=a0_0x56363f,_0x5cf174=_0x5d6ba1[_0x4b2df4(0xa8)][_0x4b2df4(0x91)],_0x293898=await xlsx[_0x4b2df4(0x7d)](_0x4b2df4(0x9b)+_0x5cf174);let _0x2c06e6=_0x293898[_0x4b2df4(0xc7)],_0xbaff33=xlsx[_0x4b2df4(0x83)][_0x4b2df4(0xd9)](_0x293898[_0x4b2df4(0x7b)][_0x2c06e6[0x0]]);for(const _0x301f17 of _0xbaff33){const _0x1311e5=_0x301f17['Name'],_0x990d80=_0x301f17[_0x4b2df4(0x84)],_0x1774fc=_0x301f17[_0x4b2df4(0xd8)],_0x5c5746=_0x301f17[_0x4b2df4(0xc8)],_0x5bcecf=_0x301f17[_0x4b2df4(0xa4)],_0x299fc3=_0x301f17[_0x4b2df4(0xb4)];try{let _0x468580=await suppliers[_0x4b2df4(0xa5)]({'name':_0x1311e5});if(!_0x468580){const _0xc2d72c=new suppliers({'name':_0x1311e5,'suppliers_code':_0x990d80,'address':_0x1774fc,'mobile':_0x5c5746,'email':_0x5bcecf,'company':_0x299fc3});_0x468580=await _0xc2d72c[_0x4b2df4(0xae)](),_0x5d6ba1['flash'](_0x4b2df4(0x96),_0x1311e5+_0x4b2df4(0x9e));}else _0x5d6ba1[_0x4b2df4(0x9d)](_0x4b2df4(0x8e),_0x1311e5+_0x4b2df4(0x99));}catch(_0x4b1e92){_0x24c0e3['status'](0x1f4)[_0x4b2df4(0xa9)]({'proderror':_0x4b1e92['message'],'aproduct':ProductName});}}_0x24c0e3[_0x4b2df4(0x93)](_0x4b2df4(0xb1));}),module['exports']=router;