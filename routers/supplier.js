const a0_0x1f65a6=a0_0x3b32;(function(_0x2c1b28,_0x476017){const _0x197141=a0_0x3b32,_0x5c942b=_0x2c1b28();while(!![]){try{const _0x5e2d7d=parseInt(_0x197141(0x1ff))/0x1+-parseInt(_0x197141(0x213))/0x2*(parseInt(_0x197141(0x203))/0x3)+-parseInt(_0x197141(0x1c0))/0x4*(-parseInt(_0x197141(0x1ed))/0x5)+-parseInt(_0x197141(0x1c4))/0x6*(parseInt(_0x197141(0x1bf))/0x7)+parseInt(_0x197141(0x215))/0x8+parseInt(_0x197141(0x1b8))/0x9*(parseInt(_0x197141(0x216))/0xa)+-parseInt(_0x197141(0x1cf))/0xb*(parseInt(_0x197141(0x1b7))/0xc);if(_0x5e2d7d===_0x476017)break;else _0x5c942b['push'](_0x5c942b['shift']());}catch(_0x40cc06){_0x5c942b['push'](_0x5c942b['shift']());}}}(a0_0x206f,0x36d3a));const express=require(a0_0x1f65a6(0x206)),app=express(),router=express[a0_0x1f65a6(0x1ba)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1f65a6(0x1be)),auth=require(a0_0x1f65a6(0x1fe)),users=require(a0_0x1f65a6(0x20f)),excelJS=require(a0_0x1f65a6(0x1df)),xlsx=require(a0_0x1f65a6(0x1f3)),multer=require(a0_0x1f65a6(0x1cd));router[a0_0x1f65a6(0x1b5)](a0_0x1f65a6(0x1c8),auth,async(_0x3c4d8a,_0x474d6a)=>{const _0x5cb846=a0_0x1f65a6;try{const {username:_0x28cbdd,email:_0x4c5a6b,role:_0x43cfd9}=_0x3c4d8a[_0x5cb846(0x20b)],_0x2d7a42=_0x3c4d8a[_0x5cb846(0x20b)],_0x14e03d=await profile[_0x5cb846(0x20e)]({'email':_0x2d7a42['email']}),_0x30ca31=await master_shop['find']();console[_0x5cb846(0x1d7)](_0x5cb846(0x1af),_0x30ca31);const _0xc315e3=await suppliers[_0x5cb846(0x209)]();console[_0x5cb846(0x1d7)](_0xc315e3);const _0x19ce88=await suppliers['aggregate']([{'$lookup':{'from':'s_payments','localField':_0x5cb846(0x20c),'foreignField':_0x5cb846(0x214),'as':_0x5cb846(0x1ad)}}]),_0x24a07f=_0x19ce88['map'](_0x26db04=>{const _0x5cc2e6=_0x5cb846;console['log']('data',_0x26db04);var _0x2e1073=0x0,_0x27b7e8=0x0;return _0x26db04[_0x5cc2e6(0x1ad)][_0x5cc2e6(0x1e3)](_0x119c3b=>{const _0x43b0a3=_0x5cc2e6;console[_0x43b0a3(0x1d7)](_0x43b0a3(0x1d5),_0x119c3b),_0x119c3b['reason']==_0x43b0a3(0x1cc)?_0x2e1073+=_0x119c3b[_0x43b0a3(0x1e6)]:_0x27b7e8+=_0x119c3b[_0x43b0a3(0x1e6)];}),_0x26db04[_0x5cc2e6(0x1e7)]=_0x2e1073,_0x26db04['purchase_return']=_0x27b7e8,_0x26db04;});console[_0x5cb846(0x1d7)](_0x5cb846(0x202),_0x24a07f);if(_0x30ca31[0x0][_0x5cb846(0x1c5)]==_0x5cb846(0x1bb)){var _0x249174=users[_0x5cb846(0x1bc)];console['log'](_0x249174);}else{if(_0x30ca31[0x0][_0x5cb846(0x1c5)]==_0x5cb846(0x1dc))var _0x249174=users[_0x5cb846(0x1dc)];else{if(_0x30ca31[0x0][_0x5cb846(0x1c5)]==_0x5cb846(0x1c3))var _0x249174=users[_0x5cb846(0x1c3)];else{if(_0x30ca31[0x0]['language']==_0x5cb846(0x1fa))var _0x249174=users[_0x5cb846(0x1fa)];else{if(_0x30ca31[0x0][_0x5cb846(0x1c5)]==_0x5cb846(0x1c9))var _0x249174=users[_0x5cb846(0x1c9)];else{if(_0x30ca31[0x0][_0x5cb846(0x1c5)]==_0x5cb846(0x1dd))var _0x249174=users[_0x5cb846(0x1da)];else{if(_0x30ca31[0x0][_0x5cb846(0x1c5)]==_0x5cb846(0x20d))var _0x249174=users[_0x5cb846(0x20d)];else{if(_0x30ca31[0x0][_0x5cb846(0x1c5)]=='Arabic\x20(ae)')var _0x249174=users[_0x5cb846(0x1d3)];}}}}}}}_0x474d6a[_0x5cb846(0x1b3)](_0x5cb846(0x1e5),{'success':_0x3c4d8a[_0x5cb846(0x1f2)](_0x5cb846(0x207)),'errors':_0x3c4d8a[_0x5cb846(0x1f2)](_0x5cb846(0x1ec)),'user':_0xc315e3,'profile':_0x14e03d,'master_shop':_0x30ca31,'role':_0x2d7a42,'payment':_0x24a07f,'language':_0x249174});}catch(_0x4d1be6){console[_0x5cb846(0x1d7)](_0x4d1be6);}}),router['post']('/view',auth,async(_0x231eed,_0x27cec0)=>{const _0x57ebfd=a0_0x1f65a6;try{const {name:_0x3ec6a7,email:_0x652b34,mobile:_0x22cffb,company:_0x198f59,address:_0x3f2c29,receivable:_0x460363,payable:_0x23de4d,code:_0x299a54,contactperson:_0x5ac646,landline:_0xc8c3c}=_0x231eed[_0x57ebfd(0x210)],_0x2c9ca8=new suppliers({'name':_0x3ec6a7,'email':_0x652b34,'mobile':_0x22cffb,'company':_0x198f59,'address':_0x3f2c29,'receivable':_0x460363,'payable':_0x23de4d,'suppliers_code':_0x299a54,'contactperson':_0x5ac646,'landline':_0xc8c3c}),_0x1aa05c=await _0x2c9ca8[_0x57ebfd(0x1f9)]();_0x231eed[_0x57ebfd(0x1f2)](_0x57ebfd(0x207),_0x57ebfd(0x1de)),_0x27cec0['redirect'](_0x57ebfd(0x200));}catch(_0x75fa55){console['log'](_0x75fa55);}}),router[a0_0x1f65a6(0x1b5)](a0_0x1f65a6(0x1f6),auth,async(_0x36e23d,_0x15f26f)=>{const _0x274765=a0_0x1f65a6;try{const {username:_0x142cce,email:_0x53700b,role:_0x53db05}=_0x36e23d[_0x274765(0x20b)],_0x3cb70c=_0x36e23d[_0x274765(0x20b)],_0x1e4595=await profile['findOne']({'email':_0x3cb70c[_0x274765(0x1e0)]}),_0x3ddd0e=await master_shop[_0x274765(0x209)]();console[_0x274765(0x1d7)](_0x274765(0x1af),_0x3ddd0e);const _0x1911a2=_0x36e23d['params']['id'],_0x1253f3=await suppliers[_0x274765(0x1e4)](_0x1911a2);console[_0x274765(0x1d7)](_0x1253f3);if(_0x3ddd0e[0x0]['language']=='English\x20(US)'){var _0xbb9f2f=users['English'];console[_0x274765(0x1d7)](_0xbb9f2f);}else{if(_0x3ddd0e[0x0][_0x274765(0x1c5)]==_0x274765(0x1dc))var _0xbb9f2f=users[_0x274765(0x1dc)];else{if(_0x3ddd0e[0x0][_0x274765(0x1c5)]==_0x274765(0x1c3))var _0xbb9f2f=users[_0x274765(0x1c3)];else{if(_0x3ddd0e[0x0][_0x274765(0x1c5)]==_0x274765(0x1fa))var _0xbb9f2f=users[_0x274765(0x1fa)];else{if(_0x3ddd0e[0x0][_0x274765(0x1c5)]==_0x274765(0x1c9))var _0xbb9f2f=users['French'];else{if(_0x3ddd0e[0x0][_0x274765(0x1c5)]==_0x274765(0x1dd))var _0xbb9f2f=users[_0x274765(0x1da)];else{if(_0x3ddd0e[0x0][_0x274765(0x1c5)]==_0x274765(0x20d))var _0xbb9f2f=users['Chinese'];else{if(_0x3ddd0e[0x0][_0x274765(0x1c5)]==_0x274765(0x1d9))var _0xbb9f2f=users[_0x274765(0x1d3)];}}}}}}}_0x15f26f[_0x274765(0x1b3)](_0x274765(0x1e5),{'success':_0x36e23d[_0x274765(0x1f2)](_0x274765(0x207)),'errors':_0x36e23d['flash'](_0x274765(0x1ec)),'role':_0x3cb70c,'profile':_0x1e4595,'master_shop':_0x3ddd0e,'user':_0x1253f3,'language':_0xbb9f2f});}catch(_0x1546e3){console[_0x274765(0x1d7)](_0x1546e3);}}),router['post'](a0_0x1f65a6(0x1f6),auth,async(_0x388f8f,_0x5a655f)=>{const _0x22dddd=a0_0x1f65a6;try{const _0x40f6b1=_0x388f8f[_0x22dddd(0x1c2)]['id'],_0x2ef863=await suppliers['findById'](_0x40f6b1),{name:_0x17e31c,email:_0x2749c7,mobile:_0x3d6225,company:_0xee67d8,address:_0x1f9e57,receivable:_0x17b1e3,payable:_0x3deb5a,code:_0x13cd18,contactperson:_0x54447d,landline:_0x3d29bb}=_0x388f8f[_0x22dddd(0x210)];_0x2ef863['name']=_0x17e31c,_0x2ef863['email']=_0x2749c7,_0x2ef863[_0x22dddd(0x1d8)]=_0x3d6225,_0x2ef863[_0x22dddd(0x1eb)]=_0xee67d8,_0x2ef863['address']=_0x1f9e57,_0x2ef863[_0x22dddd(0x1ea)]=_0x17b1e3,_0x2ef863['payable']=_0x3deb5a,_0x2ef863['suppliers_code']=_0x13cd18,_0x2ef863[_0x22dddd(0x1bd)]=_0x54447d,_0x2ef863[_0x22dddd(0x1fc)]=_0x3d29bb;const _0x3d60d1=await _0x2ef863[_0x22dddd(0x1f9)]();_0x388f8f['flash'](_0x22dddd(0x207),_0x22dddd(0x1d1)),_0x5a655f[_0x22dddd(0x218)](_0x22dddd(0x200));}catch(_0x502dd3){console[_0x22dddd(0x1d7)](_0x502dd3);}}),router[a0_0x1f65a6(0x1b5)]('/view/payment/:id',auth,async(_0x1d14fb,_0x4a44f0)=>{const _0x572f43=a0_0x1f65a6;try{const {username:_0x5bee00,email:_0x2fb794,role:_0x48b37e}=_0x1d14fb['user'],_0x4f276d=_0x1d14fb[_0x572f43(0x20b)],_0x338b26=await profile['findOne']({'email':_0x4f276d[_0x572f43(0x1e0)]}),_0x2070b2=await master_shop[_0x572f43(0x209)]();console[_0x572f43(0x1d7)](_0x572f43(0x1af),_0x2070b2),console['log'](_0x1d14fb['params']['id']);const _0x3262c6=await suppliers[_0x572f43(0x20e)]({'_id':_0x1d14fb['params']['id']});console['log'](_0x3262c6);const _0x1d0a57=await s_payment_data['find']({'suppliers':_0x3262c6[_0x572f43(0x20c)]});console[_0x572f43(0x1d7)](_0x1d0a57);const _0x114705=await s_payment_data[_0x572f43(0x1fb)]([{'$match':{'suppliers':_0x3262c6[_0x572f43(0x20c)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x572f43(0x1ee),'sum':{'$sum':'$amount'}}}]);console[_0x572f43(0x1d7)](_0x572f43(0x212),_0x114705);const _0x5157d9=await s_payment_data[_0x572f43(0x1fb)]([{'$match':{'suppliers':_0x3262c6['name']}},{'$match':{'reason':_0x572f43(0x1ce)}},{'$group':{'_id':_0x572f43(0x1ee),'sum':{'$sum':'$amount'}}}]);console[_0x572f43(0x1d7)](_0x572f43(0x1b4),_0x5157d9);if(_0x2070b2[0x0]['language']=='English\x20(US)'){var _0x28d9d6=users[_0x572f43(0x1bc)];console[_0x572f43(0x1d7)](_0x28d9d6);}else{if(_0x2070b2[0x0][_0x572f43(0x1c5)]=='Hindi')var _0x28d9d6=users[_0x572f43(0x1dc)];else{if(_0x2070b2[0x0]['language']==_0x572f43(0x1c3))var _0x28d9d6=users[_0x572f43(0x1c3)];else{if(_0x2070b2[0x0][_0x572f43(0x1c5)]==_0x572f43(0x1fa))var _0x28d9d6=users[_0x572f43(0x1fa)];else{if(_0x2070b2[0x0][_0x572f43(0x1c5)]=='French')var _0x28d9d6=users[_0x572f43(0x1c9)];else{if(_0x2070b2[0x0][_0x572f43(0x1c5)]==_0x572f43(0x1dd))var _0x28d9d6=users[_0x572f43(0x1da)];else{if(_0x2070b2[0x0]['language']==_0x572f43(0x20d))var _0x28d9d6=users[_0x572f43(0x20d)];else{if(_0x2070b2[0x0][_0x572f43(0x1c5)]==_0x572f43(0x1d9))var _0x28d9d6=users[_0x572f43(0x1d3)];}}}}}}}_0x4a44f0['render'](_0x572f43(0x1b6),{'success':_0x1d14fb[_0x572f43(0x1f2)]('success'),'errors':_0x1d14fb[_0x572f43(0x1f2)](_0x572f43(0x1ec)),'role':_0x4f276d,'profile':_0x338b26,'master_shop':_0x2070b2,'payment':_0x1d0a57,'payable':_0x114705,'receivable':_0x5157d9,'language':_0x28d9d6});}catch(_0x345e32){console[_0x572f43(0x1d7)](_0x345e32);}}),router[a0_0x1f65a6(0x1b5)]('/products_export_migrate_file',auth,async(_0x1802c8,_0x550ad6)=>{const _0x52f88d=a0_0x1f65a6;try{const _0x2d5396=new excelJS[(_0x52f88d(0x208))](),_0xe91d63=_0x2d5396[_0x52f88d(0x217)](_0x52f88d(0x1f8));return _0xe91d63['columns']=[{'header':_0x52f88d(0x1e8),'key':_0x52f88d(0x204),'width':0xa},{'header':_0x52f88d(0x1e2),'key':_0x52f88d(0x1f1),'width':0xa},{'header':_0x52f88d(0x1f7),'key':_0x52f88d(0x1e9),'width':0xa},{'header':_0x52f88d(0x1ae),'key':_0x52f88d(0x211),'width':0xa},{'header':_0x52f88d(0x20a),'key':_0x52f88d(0x1d8),'width':0xa},{'header':_0x52f88d(0x211),'key':_0x52f88d(0x1e0),'width':0xa}],_0x550ad6['setHeader'](_0x52f88d(0x1b2),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x550ad6['setHeader'](_0x52f88d(0x1b0),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x2d5396[_0x52f88d(0x1f3)]['write'](_0x550ad6)[_0x52f88d(0x1fd)](()=>{_0x550ad6['status'](0xc8);});}catch(_0x3f552d){_0x550ad6[_0x52f88d(0x1cb)](0x190)[_0x52f88d(0x1f4)]({'errors':_0x3f552d[_0x52f88d(0x1ac)]});}});const storage1=multer[a0_0x1f65a6(0x1ef)]({'destination':(_0x274eb3,_0x5bb69e,_0x36393a)=>{_0x36393a(null,'public/Migration');},'filename':(_0x7a1746,_0x1e735e,_0x697a8b)=>{const _0x451c2b=a0_0x1f65a6;_0x697a8b(null,Date[_0x451c2b(0x1c1)]()+_0x1e735e[_0x451c2b(0x1d4)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x1f65a6(0x1d6)](a0_0x1f65a6(0x1f0),auth,uploadMigrate[a0_0x1f65a6(0x1b9)](a0_0x1f65a6(0x219)),async(_0x5e817d,_0x3d04d1)=>{const _0x380511=a0_0x1f65a6,_0x4026ba=_0x5e817d['file'][_0x380511(0x1c6)],_0x47a731=await xlsx[_0x380511(0x1b1)](_0x380511(0x1c7)+_0x4026ba);let _0x40d232=_0x47a731[_0x380511(0x1e1)],_0x8b712=xlsx[_0x380511(0x1db)][_0x380511(0x1d2)](_0x47a731[_0x380511(0x201)][_0x40d232[0x0]]);for(const _0x4b17c1 of _0x8b712){const _0x5ddf82=_0x4b17c1[_0x380511(0x1e8)],_0x3ff9e8=_0x4b17c1[_0x380511(0x1e2)],_0x1e86b3=_0x4b17c1[_0x380511(0x211)],_0x4befe0=_0x4b17c1[_0x380511(0x1ae)],_0xf7c82=_0x4b17c1[_0x380511(0x1f7)],_0x124de3=_0x4b17c1['Company_Name'];try{let _0x1084dc=await suppliers[_0x380511(0x20e)]({'name':_0x5ddf82});if(!_0x1084dc){const _0xafed23=new suppliers({'name':_0x5ddf82,'suppliers_code':_0x3ff9e8,'address':_0x1e86b3,'mobile':_0x4befe0,'email':_0xf7c82,'company':_0x124de3});_0x1084dc=await _0xafed23['save'](),_0x5e817d['flash']('success',_0x5ddf82+_0x380511(0x1f5));}else _0x5e817d[_0x380511(0x1f2)]('error',_0x5ddf82+_0x380511(0x1ca));}catch(_0x483f98){_0x3d04d1[_0x380511(0x1cb)](0x1f4)[_0x380511(0x1d0)]({'proderror':_0x483f98['message'],'aproduct':ProductName});}}_0x3d04d1['redirect'](_0x380511(0x200));}),module[a0_0x1f65a6(0x205)]=router;function a0_0x3b32(_0x27d958,_0x234560){const _0x206fe5=a0_0x206f();return a0_0x3b32=function(_0x3b3232,_0x1c797f){_0x3b3232=_0x3b3232-0x1ac;let _0x28caa4=_0x206fe5[_0x3b3232];return _0x28caa4;},a0_0x3b32(_0x27d958,_0x234560);}function a0_0x206f(){const _0x5f4451=['3263536pdQUDi','210WGTkvC','addWorksheet','redirect','supplier_product_file','message','suppliers_docs','Mobile_number','master','Content-Disposition','readFile','Content-Type','render','receivable_sum','get','supplier_payment','1822980gQVwOL','35073BzIjpy','single','Router','English\x20(US)','English','contactperson','../models/all_models','7DRyuxL','32Pcnpxl','now','params','German','1577574QIyxOK','language','filename','public/Migration/','/view','French','\x20Failed','status','Purchase','multer','Purchase\x20Return','33EFeIdb','json','supplier\x20data\x20update\x20successfully','sheet_to_json','Arabic','originalname','doc','post','log','mobile','Arabic\x20(ae)','Portuguese','utils','Hindi','Portuguese\x20(BR)','supplier\x20data\x20add\x20successfully','exceljs','email','SheetNames','Supplier_Code','forEach','findById','supplier','amount','purchase','Name','SalesmanName','receivable','company','errors','64385HgCOjq','$reason','diskStorage','/supplier_import_migrate_file','PUnits','flash','xlsx','send','\x20added\x20successfully','/view/:id','Email','Customers','save','Spanish','aggregate','landline','then','../middleware/auth','355504pZaTMg','/supplier/view','Sheets','supplier.js\x20payment_data','15165ZdcqTy','PBrands','exports','express','success','Workbook','find','Company_Name','user','name','Chinese','findOne','../public/language/languages.json','body','address','payable_sum','2jLdKfb','suppliers'];a0_0x206f=function(){return _0x5f4451;};return a0_0x206f();}