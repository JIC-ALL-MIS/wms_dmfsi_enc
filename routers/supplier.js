const a0_0x363446=a0_0x5149;(function(_0x4fe10d,_0x1336f0){const _0x6ec9d2=a0_0x5149,_0x4c5130=_0x4fe10d();while(!![]){try{const _0x234bfb=parseInt(_0x6ec9d2(0x181))/0x1*(-parseInt(_0x6ec9d2(0x143))/0x2)+-parseInt(_0x6ec9d2(0x156))/0x3+-parseInt(_0x6ec9d2(0x182))/0x4+parseInt(_0x6ec9d2(0x12d))/0x5*(-parseInt(_0x6ec9d2(0x149))/0x6)+-parseInt(_0x6ec9d2(0x162))/0x7+-parseInt(_0x6ec9d2(0x140))/0x8*(parseInt(_0x6ec9d2(0x12e))/0x9)+-parseInt(_0x6ec9d2(0x17d))/0xa*(-parseInt(_0x6ec9d2(0x150))/0xb);if(_0x234bfb===_0x1336f0)break;else _0x4c5130['push'](_0x4c5130['shift']());}catch(_0x5e2e0e){_0x4c5130['push'](_0x4c5130['shift']());}}}(a0_0x4aa6,0x445c6));const express=require('express'),app=express(),router=express[a0_0x363446(0x11d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x363446(0x17f)),auth=require(a0_0x363446(0x16a)),users=require('../public/language/languages.json'),excelJS=require(a0_0x363446(0x16f)),xlsx=require(a0_0x363446(0x17b)),multer=require('multer');router[a0_0x363446(0x167)](a0_0x363446(0x11c),auth,async(_0x5b7458,_0x283dbb)=>{const _0x335a76=a0_0x363446;try{const {username:_0x1822b8,email:_0x2f2147,role:_0x288262}=_0x5b7458[_0x335a76(0x131)],_0x480804=_0x5b7458[_0x335a76(0x131)],_0x33f77c=await profile[_0x335a76(0x142)]({'email':_0x480804[_0x335a76(0x152)]}),_0x4b52a8=await master_shop[_0x335a76(0x134)]();console[_0x335a76(0x160)](_0x335a76(0x127),_0x4b52a8);const _0x45abfd=await suppliers[_0x335a76(0x134)]();console['log'](_0x45abfd);const _0x1a108f=await suppliers[_0x335a76(0x12a)]([{'$lookup':{'from':_0x335a76(0x179),'localField':_0x335a76(0x121),'foreignField':_0x335a76(0x158),'as':_0x335a76(0x177)}}]),_0x479654=_0x1a108f[_0x335a76(0x15f)](_0x308e92=>{const _0x256046=_0x335a76;console[_0x256046(0x160)](_0x256046(0x188),_0x308e92);var _0x4bcf67=0x0,_0x52a97a=0x0;return _0x308e92[_0x256046(0x177)][_0x256046(0x126)](_0x43ca09=>{const _0x1791c0=_0x256046;console['log']('doc',_0x43ca09),_0x43ca09[_0x1791c0(0x183)]==_0x1791c0(0x135)?_0x4bcf67+=_0x43ca09[_0x1791c0(0x141)]:_0x52a97a+=_0x43ca09[_0x1791c0(0x141)];}),_0x308e92['purchase']=_0x4bcf67,_0x308e92[_0x256046(0x137)]=_0x52a97a,_0x308e92;});console[_0x335a76(0x160)](_0x335a76(0x166),_0x479654);if(_0x4b52a8[0x0][_0x335a76(0x180)]=='English\x20(US)'){var _0x4b8553=users[_0x335a76(0x154)];console[_0x335a76(0x160)](_0x4b8553);}else{if(_0x4b52a8[0x0][_0x335a76(0x180)]=='Hindi')var _0x4b8553=users[_0x335a76(0x174)];else{if(_0x4b52a8[0x0][_0x335a76(0x180)]==_0x335a76(0x13e))var _0x4b8553=users['German'];else{if(_0x4b52a8[0x0]['language']==_0x335a76(0x155))var _0x4b8553=users['Spanish'];else{if(_0x4b52a8[0x0][_0x335a76(0x180)]=='French')var _0x4b8553=users[_0x335a76(0x185)];else{if(_0x4b52a8[0x0][_0x335a76(0x180)]==_0x335a76(0x14f))var _0x4b8553=users[_0x335a76(0x123)];else{if(_0x4b52a8[0x0][_0x335a76(0x180)]==_0x335a76(0x165))var _0x4b8553=users[_0x335a76(0x165)];else{if(_0x4b52a8[0x0][_0x335a76(0x180)]==_0x335a76(0x136))var _0x4b8553=users[_0x335a76(0x151)];}}}}}}}_0x283dbb[_0x335a76(0x169)](_0x335a76(0x14a),{'success':_0x5b7458[_0x335a76(0x12b)](_0x335a76(0x17a)),'errors':_0x5b7458[_0x335a76(0x12b)](_0x335a76(0x176)),'user':_0x45abfd,'profile':_0x33f77c,'master_shop':_0x4b52a8,'role':_0x480804,'payment':_0x479654,'language':_0x4b8553});}catch(_0x4131da){console[_0x335a76(0x160)](_0x4131da);}}),router['post']('/view',auth,async(_0x317e35,_0x2b0acc)=>{const _0x4aa446=a0_0x363446;try{const {name:_0x1eb640,email:_0x4748f8,mobile:_0x4f35b1,company:_0x41f3d3,address:_0xf84beb,receivable:_0x3b0239,payable:_0x235775,code:_0x2939cd,contactperson:_0x3f0441,landline:_0x3f0116}=_0x317e35['body'],_0x4d8aed=new suppliers({'name':_0x1eb640,'email':_0x4748f8,'mobile':_0x4f35b1,'company':_0x41f3d3,'address':_0xf84beb,'receivable':_0x3b0239,'payable':_0x235775,'suppliers_code':_0x2939cd,'contactperson':_0x3f0441,'landline':_0x3f0116}),_0x1b992d=await _0x4d8aed[_0x4aa446(0x128)]();_0x317e35[_0x4aa446(0x12b)](_0x4aa446(0x17a),'supplier\x20data\x20add\x20successfully'),_0x2b0acc['redirect'](_0x4aa446(0x13b));}catch(_0x50a6c6){console['log'](_0x50a6c6);}}),router[a0_0x363446(0x167)]('/view/:id',auth,async(_0x2fe07d,_0x267a9e)=>{const _0xb3db97=a0_0x363446;try{const {username:_0x107b92,email:_0x5d6e1e,role:_0x419bf2}=_0x2fe07d['user'],_0xb74ef0=_0x2fe07d[_0xb3db97(0x131)],_0x3415ad=await profile[_0xb3db97(0x142)]({'email':_0xb74ef0[_0xb3db97(0x152)]}),_0x5464fc=await master_shop['find']();console[_0xb3db97(0x160)](_0xb3db97(0x127),_0x5464fc);const _0x293f4b=_0x2fe07d[_0xb3db97(0x168)]['id'],_0x3b5cdb=await suppliers[_0xb3db97(0x153)](_0x293f4b);console[_0xb3db97(0x160)](_0x3b5cdb);if(_0x5464fc[0x0][_0xb3db97(0x180)]==_0xb3db97(0x172)){var _0x4df305=users[_0xb3db97(0x154)];console[_0xb3db97(0x160)](_0x4df305);}else{if(_0x5464fc[0x0][_0xb3db97(0x180)]==_0xb3db97(0x174))var _0x4df305=users[_0xb3db97(0x174)];else{if(_0x5464fc[0x0]['language']==_0xb3db97(0x13e))var _0x4df305=users[_0xb3db97(0x13e)];else{if(_0x5464fc[0x0][_0xb3db97(0x180)]==_0xb3db97(0x155))var _0x4df305=users[_0xb3db97(0x155)];else{if(_0x5464fc[0x0][_0xb3db97(0x180)]==_0xb3db97(0x185))var _0x4df305=users[_0xb3db97(0x185)];else{if(_0x5464fc[0x0][_0xb3db97(0x180)]==_0xb3db97(0x14f))var _0x4df305=users[_0xb3db97(0x123)];else{if(_0x5464fc[0x0][_0xb3db97(0x180)]==_0xb3db97(0x165))var _0x4df305=users[_0xb3db97(0x165)];else{if(_0x5464fc[0x0][_0xb3db97(0x180)]==_0xb3db97(0x136))var _0x4df305=users[_0xb3db97(0x151)];}}}}}}}_0x267a9e[_0xb3db97(0x169)](_0xb3db97(0x14a),{'success':_0x2fe07d[_0xb3db97(0x12b)](_0xb3db97(0x17a)),'errors':_0x2fe07d[_0xb3db97(0x12b)](_0xb3db97(0x176)),'role':_0xb74ef0,'profile':_0x3415ad,'master_shop':_0x5464fc,'user':_0x3b5cdb,'language':_0x4df305});}catch(_0x246b20){console['log'](_0x246b20);}}),router[a0_0x363446(0x125)](a0_0x363446(0x16d),auth,async(_0x17e8fa,_0x2fbdf3)=>{const _0x2bce4d=a0_0x363446;try{const _0x5c6d78=_0x17e8fa[_0x2bce4d(0x168)]['id'],_0x49fbbf=await suppliers['findById'](_0x5c6d78),{name:_0x4e0990,email:_0x6cec81,mobile:_0x2b4f5d,company:_0x5864ed,address:_0x23ac38,receivable:_0x4ce7ad,payable:_0x1e1062,code:_0x10f690,contactperson:_0x4645c5,landline:_0x48f1b4}=_0x17e8fa[_0x2bce4d(0x133)];_0x49fbbf[_0x2bce4d(0x121)]=_0x4e0990,_0x49fbbf[_0x2bce4d(0x152)]=_0x6cec81,_0x49fbbf[_0x2bce4d(0x15d)]=_0x2b4f5d,_0x49fbbf[_0x2bce4d(0x164)]=_0x5864ed,_0x49fbbf[_0x2bce4d(0x16e)]=_0x23ac38,_0x49fbbf[_0x2bce4d(0x146)]=_0x4ce7ad,_0x49fbbf[_0x2bce4d(0x130)]=_0x1e1062,_0x49fbbf[_0x2bce4d(0x132)]=_0x10f690,_0x49fbbf[_0x2bce4d(0x178)]=_0x4645c5,_0x49fbbf['landline']=_0x48f1b4;const _0x5d77e2=await _0x49fbbf[_0x2bce4d(0x128)]();_0x17e8fa['flash'](_0x2bce4d(0x17a),_0x2bce4d(0x16b)),_0x2fbdf3['redirect'](_0x2bce4d(0x13b));}catch(_0x546154){console[_0x2bce4d(0x160)](_0x546154);}}),router[a0_0x363446(0x167)](a0_0x363446(0x14d),auth,async(_0x98f9a4,_0x4852ec)=>{const _0x1306bc=a0_0x363446;try{const {username:_0xdbcd62,email:_0x29e8e9,role:_0x372e5a}=_0x98f9a4[_0x1306bc(0x131)],_0x2c8288=_0x98f9a4[_0x1306bc(0x131)],_0x539a15=await profile['findOne']({'email':_0x2c8288[_0x1306bc(0x152)]}),_0x529ad3=await master_shop[_0x1306bc(0x134)]();console[_0x1306bc(0x160)](_0x1306bc(0x127),_0x529ad3),console[_0x1306bc(0x160)](_0x98f9a4[_0x1306bc(0x168)]['id']);const _0x1d70ae=await suppliers[_0x1306bc(0x142)]({'_id':_0x98f9a4[_0x1306bc(0x168)]['id']});console['log'](_0x1d70ae);const _0xb711bc=await s_payment_data[_0x1306bc(0x134)]({'suppliers':_0x1d70ae[_0x1306bc(0x121)]});console[_0x1306bc(0x160)](_0xb711bc);const _0x587c62=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x1d70ae[_0x1306bc(0x121)]}},{'$match':{'reason':_0x1306bc(0x135)}},{'$group':{'_id':_0x1306bc(0x138),'sum':{'$sum':'$amount'}}}]);console[_0x1306bc(0x160)]('payable_sum',_0x587c62);const _0x16d165=await s_payment_data[_0x1306bc(0x12a)]([{'$match':{'suppliers':_0x1d70ae[_0x1306bc(0x121)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x1306bc(0x138),'sum':{'$sum':_0x1306bc(0x14b)}}}]);console[_0x1306bc(0x160)]('receivable_sum',_0x16d165);if(_0x529ad3[0x0]['language']==_0x1306bc(0x172)){var _0x5fd2d9=users['English'];console[_0x1306bc(0x160)](_0x5fd2d9);}else{if(_0x529ad3[0x0][_0x1306bc(0x180)]=='Hindi')var _0x5fd2d9=users[_0x1306bc(0x174)];else{if(_0x529ad3[0x0]['language']==_0x1306bc(0x13e))var _0x5fd2d9=users['German'];else{if(_0x529ad3[0x0][_0x1306bc(0x180)]=='Spanish')var _0x5fd2d9=users[_0x1306bc(0x155)];else{if(_0x529ad3[0x0]['language']=='French')var _0x5fd2d9=users[_0x1306bc(0x185)];else{if(_0x529ad3[0x0][_0x1306bc(0x180)]=='Portuguese\x20(BR)')var _0x5fd2d9=users[_0x1306bc(0x123)];else{if(_0x529ad3[0x0][_0x1306bc(0x180)]==_0x1306bc(0x165))var _0x5fd2d9=users['Chinese'];else{if(_0x529ad3[0x0][_0x1306bc(0x180)]==_0x1306bc(0x136))var _0x5fd2d9=users[_0x1306bc(0x151)];}}}}}}}_0x4852ec[_0x1306bc(0x169)](_0x1306bc(0x184),{'success':_0x98f9a4[_0x1306bc(0x12b)](_0x1306bc(0x17a)),'errors':_0x98f9a4[_0x1306bc(0x12b)](_0x1306bc(0x176)),'role':_0x2c8288,'profile':_0x539a15,'master_shop':_0x529ad3,'payment':_0xb711bc,'payable':_0x587c62,'receivable':_0x16d165,'language':_0x5fd2d9});}catch(_0x5329d3){console[_0x1306bc(0x160)](_0x5329d3);}}),router[a0_0x363446(0x167)](a0_0x363446(0x12c),auth,async(_0x9f9b45,_0x3ac829)=>{const _0x9ff7=a0_0x363446;try{const _0x3cd2eb=new excelJS[(_0x9ff7(0x170))](),_0x5ddb6a=_0x3cd2eb[_0x9ff7(0x187)](_0x9ff7(0x13a));return _0x5ddb6a[_0x9ff7(0x12f)]=[{'header':_0x9ff7(0x11f),'key':_0x9ff7(0x147),'width':0xa},{'header':_0x9ff7(0x15e),'key':_0x9ff7(0x145),'width':0xa},{'header':_0x9ff7(0x122),'key':_0x9ff7(0x129),'width':0xa},{'header':_0x9ff7(0x13c),'key':_0x9ff7(0x16e),'width':0xa},{'header':'Company_Name','key':_0x9ff7(0x15d),'width':0xa},{'header':_0x9ff7(0x16e),'key':'email','width':0xa}],_0x3ac829['setHeader']('Content-Type',_0x9ff7(0x13f)),_0x3ac829[_0x9ff7(0x16c)]('Content-Disposition',_0x9ff7(0x15c)),_0x3cd2eb[_0x9ff7(0x17b)][_0x9ff7(0x144)](_0x3ac829)[_0x9ff7(0x13d)](()=>{const _0x514c6e=_0x9ff7;_0x3ac829[_0x514c6e(0x186)](0xc8);});}catch(_0x2cdb0b){_0x3ac829['status'](0x190)[_0x9ff7(0x161)]({'errors':_0x2cdb0b[_0x9ff7(0x14c)]});}});function a0_0x4aa6(){const _0x28cbda=['Portuguese','Company_Name','post','forEach','master','save','SalesmanName','aggregate','flash','/products_export_migrate_file','2770iDfPOs','126EfUOel','columns','payable','user','suppliers_code','body','find','Purchase','Arabic\x20(ae)','purchase_return','$reason','public/Migration/','Customers','/supplier/view','Mobile_number','then','German','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','219720ZmGuIN','amount','findOne','10232JHbEey','write','PUnits','receivable','PBrands','redirect','1590mVfSJb','supplier','$amount','message','/view/payment/:id','utils','Portuguese\x20(BR)','3846007LRBSuS','Arabic','email','findById','English','Spanish','715059ATVvyJ','supplier_product_file','suppliers','sheet_to_json','filename','SheetNames','attachment;\x20filename=supplier_Migration_File.xlsx','mobile','Supplier_Code','map','log','send','3796191gyzFUO','readFile','company','Chinese','supplier.js\x20payment_data','get','params','render','../middleware/auth','supplier\x20data\x20update\x20successfully','setHeader','/view/:id','address','exceljs','Workbook','diskStorage','English\x20(US)','public/Migration','Hindi','file','errors','suppliers_docs','contactperson','s_payments','success','xlsx','now','70mdkOPR','\x20added\x20successfully','../models/all_models','language','77dOKTGh','1846140ilVkgC','reason','supplier_payment','French','status','addWorksheet','data','/view','Router','json','Name','/supplier_import_migrate_file','name','Email'];a0_0x4aa6=function(){return _0x28cbda;};return a0_0x4aa6();}function a0_0x5149(_0xd94e38,_0x371cc9){const _0x4aa688=a0_0x4aa6();return a0_0x5149=function(_0x51492d,_0x4444b0){_0x51492d=_0x51492d-0x11c;let _0x56b12d=_0x4aa688[_0x51492d];return _0x56b12d;},a0_0x5149(_0xd94e38,_0x371cc9);}const storage1=multer[a0_0x363446(0x171)]({'destination':(_0x30bfa7,_0x2bb1bd,_0x36e164)=>{const _0x23523d=a0_0x363446;_0x36e164(null,_0x23523d(0x173));},'filename':(_0xee23e2,_0xb1c0b2,_0x3359ee)=>{const _0xaea029=a0_0x363446;_0x3359ee(null,Date[_0xaea029(0x17c)]()+_0xb1c0b2['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x363446(0x125)](a0_0x363446(0x120),auth,uploadMigrate['single'](a0_0x363446(0x157)),async(_0x3f4345,_0x5b2b14)=>{const _0x48fcdf=a0_0x363446,_0xff5ce1=_0x3f4345[_0x48fcdf(0x175)][_0x48fcdf(0x15a)],_0x4a574d=await xlsx[_0x48fcdf(0x163)](_0x48fcdf(0x139)+_0xff5ce1);let _0x5db6ad=_0x4a574d[_0x48fcdf(0x15b)],_0x21d57e=xlsx[_0x48fcdf(0x14e)][_0x48fcdf(0x159)](_0x4a574d['Sheets'][_0x5db6ad[0x0]]);for(const _0x38122e of _0x21d57e){const _0x151649=_0x38122e[_0x48fcdf(0x11f)],_0x56ecd9=_0x38122e[_0x48fcdf(0x15e)],_0x2b7de3=_0x38122e[_0x48fcdf(0x16e)],_0x47e314=_0x38122e['Mobile_number'],_0x13ef97=_0x38122e[_0x48fcdf(0x122)],_0x25edcd=_0x38122e[_0x48fcdf(0x124)];try{let _0x471834=await suppliers[_0x48fcdf(0x142)]({'name':_0x151649});if(!_0x471834){const _0x232f36=new suppliers({'name':_0x151649,'suppliers_code':_0x56ecd9,'address':_0x2b7de3,'mobile':_0x47e314,'email':_0x13ef97,'company':_0x25edcd});_0x471834=await _0x232f36[_0x48fcdf(0x128)](),_0x3f4345[_0x48fcdf(0x12b)](_0x48fcdf(0x17a),_0x151649+_0x48fcdf(0x17e));}else _0x3f4345['flash']('error',_0x151649+'\x20Failed');}catch(_0x1cecb7){_0x5b2b14[_0x48fcdf(0x186)](0x1f4)[_0x48fcdf(0x11e)]({'proderror':_0x1cecb7['message'],'aproduct':ProductName});}}_0x5b2b14[_0x48fcdf(0x148)](_0x48fcdf(0x13b));}),module['exports']=router;