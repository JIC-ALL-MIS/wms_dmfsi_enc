const a0_0x55e83a=a0_0x17a6;(function(_0x4c3f90,_0x24f309){const _0x1e99b7=a0_0x17a6,_0x16b1a7=_0x4c3f90();while(!![]){try{const _0x443e24=parseInt(_0x1e99b7(0xa5))/0x1*(-parseInt(_0x1e99b7(0x7f))/0x2)+-parseInt(_0x1e99b7(0xcc))/0x3+-parseInt(_0x1e99b7(0xb2))/0x4+-parseInt(_0x1e99b7(0x9a))/0x5*(parseInt(_0x1e99b7(0xb8))/0x6)+parseInt(_0x1e99b7(0x90))/0x7*(parseInt(_0x1e99b7(0xbe))/0x8)+parseInt(_0x1e99b7(0xd9))/0x9*(-parseInt(_0x1e99b7(0xa2))/0xa)+-parseInt(_0x1e99b7(0x85))/0xb*(-parseInt(_0x1e99b7(0xa9))/0xc);if(_0x443e24===_0x24f309)break;else _0x16b1a7['push'](_0x16b1a7['shift']());}catch(_0x191c81){_0x16b1a7['push'](_0x16b1a7['shift']());}}}(a0_0x416a,0x27fce));const express=require('express'),app=express(),router=express[a0_0x55e83a(0xab)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x55e83a(0x9c)),auth=require(a0_0x55e83a(0xc8)),users=require(a0_0x55e83a(0x9b)),excelJS=require(a0_0x55e83a(0x7e)),xlsx=require('xlsx'),multer=require(a0_0x55e83a(0x92));router[a0_0x55e83a(0xb0)](a0_0x55e83a(0xb3),auth,async(_0x2065a1,_0x4ce159)=>{const _0x348e47=a0_0x55e83a;try{const {username:_0x5cf9b4,email:_0x6b5bb9,role:_0x416ef8}=_0x2065a1['user'],_0x55b0cc=_0x2065a1[_0x348e47(0xad)],_0x2dc332=await profile['findOne']({'email':_0x55b0cc[_0x348e47(0xc6)]}),_0x3096d1=await master_shop[_0x348e47(0xdb)]();console[_0x348e47(0xd1)](_0x348e47(0xd2),_0x3096d1);const _0x4b7bd5=await suppliers[_0x348e47(0xdb)]();console[_0x348e47(0xd1)](_0x4b7bd5);const _0x3b6b97=await suppliers[_0x348e47(0xd7)]([{'$lookup':{'from':_0x348e47(0xae),'localField':_0x348e47(0xce),'foreignField':'suppliers','as':_0x348e47(0x9d)}}]),_0x7c9984=_0x3b6b97['map'](_0x3f9512=>{const _0x2764b2=_0x348e47;console[_0x2764b2(0xd1)](_0x2764b2(0x84),_0x3f9512);var _0x4e1040=0x0,_0x11962e=0x0;return _0x3f9512['suppliers_docs'][_0x2764b2(0x8d)](_0x5750cd=>{const _0x2b0680=_0x2764b2;console[_0x2b0680(0xd1)]('doc',_0x5750cd),_0x5750cd[_0x2b0680(0xcb)]==_0x2b0680(0x76)?_0x4e1040+=_0x5750cd[_0x2b0680(0xa3)]:_0x11962e+=_0x5750cd[_0x2b0680(0xa3)];}),_0x3f9512['purchase']=_0x4e1040,_0x3f9512['purchase_return']=_0x11962e,_0x3f9512;});console[_0x348e47(0xd1)]('supplier.js\x20payment_data',_0x7c9984);if(_0x3096d1[0x0][_0x348e47(0x80)]=='English\x20(US)'){var _0x24dc6d=users[_0x348e47(0xbc)];console[_0x348e47(0xd1)](_0x24dc6d);}else{if(_0x3096d1[0x0]['language']=='Hindi')var _0x24dc6d=users['Hindi'];else{if(_0x3096d1[0x0][_0x348e47(0x80)]=='German')var _0x24dc6d=users[_0x348e47(0x82)];else{if(_0x3096d1[0x0][_0x348e47(0x80)]=='Spanish')var _0x24dc6d=users[_0x348e47(0xb7)];else{if(_0x3096d1[0x0][_0x348e47(0x80)]==_0x348e47(0x98))var _0x24dc6d=users[_0x348e47(0x98)];else{if(_0x3096d1[0x0][_0x348e47(0x80)]==_0x348e47(0x9f))var _0x24dc6d=users['Portuguese'];else{if(_0x3096d1[0x0][_0x348e47(0x80)]==_0x348e47(0x87))var _0x24dc6d=users['Chinese'];else{if(_0x3096d1[0x0][_0x348e47(0x80)]==_0x348e47(0xc2))var _0x24dc6d=users[_0x348e47(0xc1)];}}}}}}}_0x4ce159[_0x348e47(0x75)](_0x348e47(0xb4),{'success':_0x2065a1[_0x348e47(0xa8)](_0x348e47(0xd5)),'errors':_0x2065a1[_0x348e47(0xa8)](_0x348e47(0xdd)),'user':_0x4b7bd5,'profile':_0x2dc332,'master_shop':_0x3096d1,'role':_0x55b0cc,'payment':_0x7c9984,'language':_0x24dc6d});}catch(_0x183905){console[_0x348e47(0xd1)](_0x183905);}}),router['post'](a0_0x55e83a(0xb3),auth,async(_0xcdddde,_0x1b1306)=>{const _0x575030=a0_0x55e83a;try{const {name:_0x56b35c,email:_0x38a165,mobile:_0x4ce403,company:_0x5491a0,address:_0x2dbc9a,receivable:_0x876f14,payable:_0x28575c,code:_0x4735d0,contactperson:_0x592f17,landline:_0x450de9}=_0xcdddde[_0x575030(0x7c)],_0x5563c7=new suppliers({'name':_0x56b35c,'email':_0x38a165,'mobile':_0x4ce403,'company':_0x5491a0,'address':_0x2dbc9a,'receivable':_0x876f14,'payable':_0x28575c,'suppliers_code':_0x4735d0,'contactperson':_0x592f17,'landline':_0x450de9}),_0x33de5d=await _0x5563c7[_0x575030(0x81)]();_0xcdddde[_0x575030(0xa8)](_0x575030(0xd5),_0x575030(0xa4)),_0x1b1306['redirect'](_0x575030(0xa1));}catch(_0x5eefba){console[_0x575030(0xd1)](_0x5eefba);}}),router[a0_0x55e83a(0xb0)]('/view/:id',auth,async(_0x2a6be2,_0x1238fc)=>{const _0x43aa19=a0_0x55e83a;try{const {username:_0x43c43f,email:_0x436256,role:_0x2d0c1c}=_0x2a6be2['user'],_0x34344d=_0x2a6be2['user'],_0xd0e1b8=await profile[_0x43aa19(0xa0)]({'email':_0x34344d[_0x43aa19(0xc6)]}),_0x1d0dcd=await master_shop['find']();console[_0x43aa19(0xd1)](_0x43aa19(0xd2),_0x1d0dcd);const _0x74e091=_0x2a6be2[_0x43aa19(0x91)]['id'],_0x32a3f6=await suppliers[_0x43aa19(0x7b)](_0x74e091);console[_0x43aa19(0xd1)](_0x32a3f6);if(_0x1d0dcd[0x0]['language']==_0x43aa19(0x8a)){var _0x3f6bb6=users[_0x43aa19(0xbc)];console[_0x43aa19(0xd1)](_0x3f6bb6);}else{if(_0x1d0dcd[0x0][_0x43aa19(0x80)]=='Hindi')var _0x3f6bb6=users[_0x43aa19(0x83)];else{if(_0x1d0dcd[0x0][_0x43aa19(0x80)]==_0x43aa19(0x82))var _0x3f6bb6=users['German'];else{if(_0x1d0dcd[0x0][_0x43aa19(0x80)]==_0x43aa19(0xb7))var _0x3f6bb6=users[_0x43aa19(0xb7)];else{if(_0x1d0dcd[0x0][_0x43aa19(0x80)]==_0x43aa19(0x98))var _0x3f6bb6=users[_0x43aa19(0x98)];else{if(_0x1d0dcd[0x0][_0x43aa19(0x80)]==_0x43aa19(0x9f))var _0x3f6bb6=users[_0x43aa19(0xaa)];else{if(_0x1d0dcd[0x0][_0x43aa19(0x80)]==_0x43aa19(0x87))var _0x3f6bb6=users[_0x43aa19(0x87)];else{if(_0x1d0dcd[0x0][_0x43aa19(0x80)]==_0x43aa19(0xc2))var _0x3f6bb6=users[_0x43aa19(0xc1)];}}}}}}}_0x1238fc[_0x43aa19(0x75)](_0x43aa19(0xb4),{'success':_0x2a6be2['flash'](_0x43aa19(0xd5)),'errors':_0x2a6be2[_0x43aa19(0xa8)](_0x43aa19(0xdd)),'role':_0x34344d,'profile':_0xd0e1b8,'master_shop':_0x1d0dcd,'user':_0x32a3f6,'language':_0x3f6bb6});}catch(_0x2a543e){console[_0x43aa19(0xd1)](_0x2a543e);}}),router['post'](a0_0x55e83a(0x94),auth,async(_0x15fe0a,_0x4e43aa)=>{const _0xc98c68=a0_0x55e83a;try{const _0x42a579=_0x15fe0a['params']['id'],_0x56cfb6=await suppliers['findById'](_0x42a579),{name:_0x4b3d21,email:_0x8eee1d,mobile:_0x515960,company:_0x1ff4b3,address:_0x474e6a,receivable:_0x16593e,payable:_0x404ed5,code:_0x2071fd,contactperson:_0x47c489,landline:_0x27abd7}=_0x15fe0a[_0xc98c68(0x7c)];_0x56cfb6[_0xc98c68(0xce)]=_0x4b3d21,_0x56cfb6[_0xc98c68(0xc6)]=_0x8eee1d,_0x56cfb6[_0xc98c68(0xb6)]=_0x515960,_0x56cfb6[_0xc98c68(0x7a)]=_0x1ff4b3,_0x56cfb6[_0xc98c68(0x95)]=_0x474e6a,_0x56cfb6[_0xc98c68(0xc5)]=_0x16593e,_0x56cfb6['payable']=_0x404ed5,_0x56cfb6[_0xc98c68(0x97)]=_0x2071fd,_0x56cfb6[_0xc98c68(0xd0)]=_0x47c489,_0x56cfb6[_0xc98c68(0x86)]=_0x27abd7;const _0x151c5c=await _0x56cfb6[_0xc98c68(0x81)]();_0x15fe0a[_0xc98c68(0xa8)]('success',_0xc98c68(0x8e)),_0x4e43aa[_0xc98c68(0xca)](_0xc98c68(0xa1));}catch(_0x5457ce){console[_0xc98c68(0xd1)](_0x5457ce);}}),router[a0_0x55e83a(0xb0)](a0_0x55e83a(0x99),auth,async(_0x31a4c9,_0x3fdf6f)=>{const _0x25127b=a0_0x55e83a;try{const {username:_0x4ac58e,email:_0x2fc506,role:_0x41870a}=_0x31a4c9[_0x25127b(0xad)],_0x2e99ce=_0x31a4c9[_0x25127b(0xad)],_0x5ca658=await profile['findOne']({'email':_0x2e99ce[_0x25127b(0xc6)]}),_0x32d7c7=await master_shop[_0x25127b(0xdb)]();console[_0x25127b(0xd1)]('master',_0x32d7c7),console[_0x25127b(0xd1)](_0x31a4c9[_0x25127b(0x91)]['id']);const _0x4ed577=await suppliers[_0x25127b(0xa0)]({'_id':_0x31a4c9[_0x25127b(0x91)]['id']});console[_0x25127b(0xd1)](_0x4ed577);const _0x43fe09=await s_payment_data[_0x25127b(0xdb)]({'suppliers':_0x4ed577[_0x25127b(0xce)]});console[_0x25127b(0xd1)](_0x43fe09);const _0x43c1a3=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x4ed577[_0x25127b(0xce)]}},{'$match':{'reason':_0x25127b(0x76)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x25127b(0xd8)}}}]);console[_0x25127b(0xd1)](_0x25127b(0xc4),_0x43c1a3);const _0x335d63=await s_payment_data[_0x25127b(0xd7)]([{'$match':{'suppliers':_0x4ed577[_0x25127b(0xce)]}},{'$match':{'reason':_0x25127b(0xd4)}},{'$group':{'_id':_0x25127b(0xc0),'sum':{'$sum':_0x25127b(0xd8)}}}]);console[_0x25127b(0xd1)](_0x25127b(0xb1),_0x335d63);if(_0x32d7c7[0x0]['language']==_0x25127b(0x8a)){var _0x2fb780=users['English'];console[_0x25127b(0xd1)](_0x2fb780);}else{if(_0x32d7c7[0x0][_0x25127b(0x80)]=='Hindi')var _0x2fb780=users['Hindi'];else{if(_0x32d7c7[0x0][_0x25127b(0x80)]=='German')var _0x2fb780=users[_0x25127b(0x82)];else{if(_0x32d7c7[0x0][_0x25127b(0x80)]==_0x25127b(0xb7))var _0x2fb780=users['Spanish'];else{if(_0x32d7c7[0x0]['language']=='French')var _0x2fb780=users[_0x25127b(0x98)];else{if(_0x32d7c7[0x0][_0x25127b(0x80)]==_0x25127b(0x9f))var _0x2fb780=users[_0x25127b(0xaa)];else{if(_0x32d7c7[0x0][_0x25127b(0x80)]=='Chinese')var _0x2fb780=users['Chinese'];else{if(_0x32d7c7[0x0][_0x25127b(0x80)]==_0x25127b(0xc2))var _0x2fb780=users['Arabic'];}}}}}}}_0x3fdf6f[_0x25127b(0x75)](_0x25127b(0xd6),{'success':_0x31a4c9[_0x25127b(0xa8)](_0x25127b(0xd5)),'errors':_0x31a4c9[_0x25127b(0xa8)](_0x25127b(0xdd)),'role':_0x2e99ce,'profile':_0x5ca658,'master_shop':_0x32d7c7,'payment':_0x43fe09,'payable':_0x43c1a3,'receivable':_0x335d63,'language':_0x2fb780});}catch(_0x103505){console[_0x25127b(0xd1)](_0x103505);}}),router[a0_0x55e83a(0xb0)](a0_0x55e83a(0x8f),auth,async(_0x5ac2ad,_0x9267b6)=>{const _0x10a777=a0_0x55e83a;try{const _0x398cc0=new excelJS[(_0x10a777(0xb5))](),_0x1fd795=_0x398cc0['addWorksheet'](_0x10a777(0x89));return _0x1fd795['columns']=[{'header':_0x10a777(0x96),'key':_0x10a777(0xcd),'width':0xa},{'header':_0x10a777(0xdc),'key':_0x10a777(0xbf),'width':0xa},{'header':_0x10a777(0xc3),'key':'SalesmanName','width':0xa},{'header':_0x10a777(0x88),'key':_0x10a777(0x95),'width':0xa},{'header':_0x10a777(0xbb),'key':_0x10a777(0xb6),'width':0xa},{'header':_0x10a777(0x95),'key':_0x10a777(0xc6),'width':0xa}],_0x9267b6[_0x10a777(0x78)]('Content-Type',_0x10a777(0xbd)),_0x9267b6[_0x10a777(0x78)]('Content-Disposition','attachment;\x20filename=supplier_Migration_File.xlsx'),_0x398cc0[_0x10a777(0x9e)][_0x10a777(0xb9)](_0x9267b6)[_0x10a777(0x77)](()=>{const _0x509491=_0x10a777;_0x9267b6[_0x509491(0xd3)](0xc8);});}catch(_0x3e24ac){_0x9267b6[_0x10a777(0xd3)](0x190)['send']({'errors':_0x3e24ac[_0x10a777(0xc9)]});}});const storage1=multer[a0_0x55e83a(0x79)]({'destination':(_0x2e3ef6,_0x4e220f,_0x3ced63)=>{const _0x396222=a0_0x55e83a;_0x3ced63(null,_0x396222(0xcf));},'filename':(_0x548b36,_0x57fc1b,_0x5efdab)=>{const _0xd35995=a0_0x55e83a;_0x5efdab(null,Date[_0xd35995(0xda)]()+_0x57fc1b[_0xd35995(0xaf)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x55e83a(0xa7),auth,uploadMigrate[a0_0x55e83a(0xba)]('supplier_product_file'),async(_0x1744b9,_0x219636)=>{const _0x2c050a=a0_0x55e83a,_0x1bea3=_0x1744b9[_0x2c050a(0x74)]['filename'],_0xa948a3=await xlsx['readFile'](_0x2c050a(0x8c)+_0x1bea3);let _0x23ac3f=_0xa948a3['SheetNames'],_0x19a96f=xlsx[_0x2c050a(0xa6)][_0x2c050a(0x7d)](_0xa948a3[_0x2c050a(0xc7)][_0x23ac3f[0x0]]);for(const _0x2b28a7 of _0x19a96f){const _0x2ba34e=_0x2b28a7[_0x2c050a(0x96)],_0x4d54e1=_0x2b28a7[_0x2c050a(0xdc)],_0x4981a6=_0x2b28a7[_0x2c050a(0x95)],_0x56aceb=_0x2b28a7['Mobile_number'],_0x1e5cd9=_0x2b28a7['Email'],_0x41cda3=_0x2b28a7[_0x2c050a(0xbb)];try{let _0x678f39=await suppliers[_0x2c050a(0xa0)]({'name':_0x2ba34e});if(!_0x678f39){const _0x40cb35=new suppliers({'name':_0x2ba34e,'suppliers_code':_0x4d54e1,'address':_0x4981a6,'mobile':_0x56aceb,'email':_0x1e5cd9,'company':_0x41cda3});_0x678f39=await _0x40cb35['save'](),_0x1744b9['flash']('success',_0x2ba34e+'\x20added\x20successfully');}else _0x1744b9['flash'](_0x2c050a(0x93),_0x2ba34e+_0x2c050a(0xac));}catch(_0x5e8d98){_0x219636[_0x2c050a(0xd3)](0x1f4)[_0x2c050a(0x8b)]({'proderror':_0x5e8d98[_0x2c050a(0xc9)],'aproduct':ProductName});}}_0x219636[_0x2c050a(0xca)](_0x2c050a(0xa1));}),module['exports']=router;function a0_0x17a6(_0x5696f0,_0x57be45){const _0x416a30=a0_0x416a();return a0_0x17a6=function(_0x17a6f4,_0x2d45f8){_0x17a6f4=_0x17a6f4-0x74;let _0x13fb70=_0x416a30[_0x17a6f4];return _0x13fb70;},a0_0x17a6(_0x5696f0,_0x57be45);}function a0_0x416a(){const _0x2f551f=['message','redirect','reason','167682LEUcVE','PBrands','name','public/Migration','contactperson','log','master','status','Purchase\x20Return','success','supplier_payment','aggregate','$amount','63HrgTth','now','find','Supplier_Code','errors','file','render','Purchase','then','setHeader','diskStorage','company','findById','body','sheet_to_json','exceljs','34NWspDW','language','save','German','Hindi','data','445841PPRhRO','landline','Chinese','Mobile_number','Customers','English\x20(US)','json','public/Migration/','forEach','supplier\x20data\x20update\x20successfully','/products_export_migrate_file','42NPUlBg','params','multer','error','/view/:id','address','Name','suppliers_code','French','/view/payment/:id','405rrtqnV','../public/language/languages.json','../models/all_models','suppliers_docs','xlsx','Portuguese\x20(BR)','findOne','/supplier/view','88930dkwKfI','amount','supplier\x20data\x20add\x20successfully','14303amGaXJ','utils','/supplier_import_migrate_file','flash','156zeobXN','Portuguese','Router','\x20Failed','user','s_payments','originalname','get','receivable_sum','87104lHShBb','/view','supplier','Workbook','mobile','Spanish','6162UpAmmF','write','single','Company_Name','English','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','137528FpTMFs','PUnits','$reason','Arabic','Arabic\x20(ae)','Email','payable_sum','receivable','email','Sheets','../middleware/auth'];a0_0x416a=function(){return _0x2f551f;};return a0_0x416a();}