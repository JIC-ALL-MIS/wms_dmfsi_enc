const a0_0x1daeee=a0_0x37bb;(function(_0x3c5d4e,_0x5db90e){const _0x5b6d79=a0_0x37bb,_0x52c167=_0x3c5d4e();while(!![]){try{const _0x3a129e=parseInt(_0x5b6d79(0x1aa))/0x1+-parseInt(_0x5b6d79(0x17d))/0x2+-parseInt(_0x5b6d79(0x188))/0x3+-parseInt(_0x5b6d79(0x180))/0x4*(parseInt(_0x5b6d79(0x1c2))/0x5)+-parseInt(_0x5b6d79(0x157))/0x6*(-parseInt(_0x5b6d79(0x17c))/0x7)+parseInt(_0x5b6d79(0x184))/0x8+-parseInt(_0x5b6d79(0x1ae))/0x9*(parseInt(_0x5b6d79(0x15d))/0xa);if(_0x3a129e===_0x5db90e)break;else _0x52c167['push'](_0x52c167['shift']());}catch(_0x5f3a06){_0x52c167['push'](_0x52c167['shift']());}}}(a0_0x46fc,0x482fb));const express=require(a0_0x1daeee(0x182)),app=express(),router=express[a0_0x1daeee(0x179)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1daeee(0x1ac)),auth=require(a0_0x1daeee(0x1b4)),users=require(a0_0x1daeee(0x1a7)),excelJS=require('exceljs'),xlsx=require(a0_0x1daeee(0x172)),multer=require(a0_0x1daeee(0x167));router['get']('/view',auth,async(_0x7e0d2,_0x285941)=>{const _0x3f50d0=a0_0x1daeee;try{const {username:_0x368f8e,email:_0x1973cf,role:_0x2e85f0}=_0x7e0d2[_0x3f50d0(0x15f)],_0x44b38f=_0x7e0d2[_0x3f50d0(0x15f)],_0x506597=await profile['findOne']({'email':_0x44b38f[_0x3f50d0(0x175)]}),_0x4da8f2=await master_shop[_0x3f50d0(0x15e)]();console[_0x3f50d0(0x1ad)](_0x3f50d0(0x183),_0x4da8f2);const _0x42a693=await suppliers['find']();console[_0x3f50d0(0x1ad)](_0x42a693);const _0x51b95e=await suppliers[_0x3f50d0(0x163)]([{'$lookup':{'from':'s_payments','localField':_0x3f50d0(0x16a),'foreignField':_0x3f50d0(0x16c),'as':_0x3f50d0(0x169)}}]),_0x3023b1=_0x51b95e[_0x3f50d0(0x177)](_0x4ab5ec=>{const _0x53ca8a=_0x3f50d0;console['log'](_0x53ca8a(0x1b5),_0x4ab5ec);var _0x5e8a13=0x0,_0x1a9daa=0x0;return _0x4ab5ec[_0x53ca8a(0x169)]['forEach'](_0x22a9de=>{const _0x25d38e=_0x53ca8a;console[_0x25d38e(0x1ad)]('doc',_0x22a9de),_0x22a9de[_0x25d38e(0x186)]==_0x25d38e(0x1b1)?_0x5e8a13+=_0x22a9de[_0x25d38e(0x181)]:_0x1a9daa+=_0x22a9de[_0x25d38e(0x181)];}),_0x4ab5ec[_0x53ca8a(0x1b7)]=_0x5e8a13,_0x4ab5ec[_0x53ca8a(0x19a)]=_0x1a9daa,_0x4ab5ec;});console[_0x3f50d0(0x1ad)](_0x3f50d0(0x156),_0x3023b1);if(_0x4da8f2[0x0][_0x3f50d0(0x1a2)]==_0x3f50d0(0x17a)){var _0x5d50f6=users[_0x3f50d0(0x155)];console[_0x3f50d0(0x1ad)](_0x5d50f6);}else{if(_0x4da8f2[0x0]['language']==_0x3f50d0(0x1b0))var _0x5d50f6=users[_0x3f50d0(0x1b0)];else{if(_0x4da8f2[0x0][_0x3f50d0(0x1a2)]=='German')var _0x5d50f6=users[_0x3f50d0(0x1a8)];else{if(_0x4da8f2[0x0][_0x3f50d0(0x1a2)]==_0x3f50d0(0x17e))var _0x5d50f6=users[_0x3f50d0(0x17e)];else{if(_0x4da8f2[0x0][_0x3f50d0(0x1a2)]==_0x3f50d0(0x160))var _0x5d50f6=users['French'];else{if(_0x4da8f2[0x0][_0x3f50d0(0x1a2)]==_0x3f50d0(0x1a1))var _0x5d50f6=users[_0x3f50d0(0x189)];else{if(_0x4da8f2[0x0][_0x3f50d0(0x1a2)]=='Chinese')var _0x5d50f6=users[_0x3f50d0(0x1ba)];else{if(_0x4da8f2[0x0][_0x3f50d0(0x1a2)]==_0x3f50d0(0x198))var _0x5d50f6=users['Arabic'];}}}}}}}_0x285941['render']('supplier',{'success':_0x7e0d2[_0x3f50d0(0x1bf)](_0x3f50d0(0x1c1)),'errors':_0x7e0d2[_0x3f50d0(0x1bf)]('errors'),'user':_0x42a693,'profile':_0x506597,'master_shop':_0x4da8f2,'role':_0x44b38f,'payment':_0x3023b1,'language':_0x5d50f6});}catch(_0x518799){console[_0x3f50d0(0x1ad)](_0x518799);}}),router[a0_0x1daeee(0x1b8)](a0_0x1daeee(0x16b),auth,async(_0x36cd81,_0x8b5b1e)=>{const _0x429a6c=a0_0x1daeee;try{const {name:_0x12a528,email:_0x5565d1,mobile:_0x4e5891,company:_0x2f7302,address:_0x1a529,receivable:_0x39cc9f,payable:_0x23f5d7,code:_0x434743,contactperson:_0x50aa16,landline:_0x42648d}=_0x36cd81[_0x429a6c(0x1b9)],_0x110145=new suppliers({'name':_0x12a528,'email':_0x5565d1,'mobile':_0x4e5891,'company':_0x2f7302,'address':_0x1a529,'receivable':_0x39cc9f,'payable':_0x23f5d7,'suppliers_code':_0x434743,'contactperson':_0x50aa16,'landline':_0x42648d}),_0x119e7e=await _0x110145[_0x429a6c(0x18d)]();_0x36cd81[_0x429a6c(0x1bf)](_0x429a6c(0x1c1),_0x429a6c(0x1ab)),_0x8b5b1e[_0x429a6c(0x1bd)](_0x429a6c(0x16d));}catch(_0x477e07){console[_0x429a6c(0x1ad)](_0x477e07);}}),router[a0_0x1daeee(0x19d)](a0_0x1daeee(0x154),auth,async(_0x5c74b0,_0x3ffcc2)=>{const _0x5383c=a0_0x1daeee;try{const {username:_0x5c729a,email:_0x46465a,role:_0xd03387}=_0x5c74b0['user'],_0x101ae3=_0x5c74b0[_0x5383c(0x15f)],_0x4c8307=await profile[_0x5383c(0x196)]({'email':_0x101ae3[_0x5383c(0x175)]}),_0x2fd9b2=await master_shop['find']();console[_0x5383c(0x1ad)]('master',_0x2fd9b2);const _0x22950b=_0x5c74b0[_0x5383c(0x165)]['id'],_0x221130=await suppliers['findById'](_0x22950b);console[_0x5383c(0x1ad)](_0x221130);if(_0x2fd9b2[0x0][_0x5383c(0x1a2)]==_0x5383c(0x17a)){var _0x190dde=users[_0x5383c(0x155)];console[_0x5383c(0x1ad)](_0x190dde);}else{if(_0x2fd9b2[0x0][_0x5383c(0x1a2)]=='Hindi')var _0x190dde=users[_0x5383c(0x1b0)];else{if(_0x2fd9b2[0x0][_0x5383c(0x1a2)]==_0x5383c(0x1a8))var _0x190dde=users[_0x5383c(0x1a8)];else{if(_0x2fd9b2[0x0][_0x5383c(0x1a2)]==_0x5383c(0x17e))var _0x190dde=users[_0x5383c(0x17e)];else{if(_0x2fd9b2[0x0]['language']=='French')var _0x190dde=users[_0x5383c(0x160)];else{if(_0x2fd9b2[0x0][_0x5383c(0x1a2)]==_0x5383c(0x1a1))var _0x190dde=users[_0x5383c(0x189)];else{if(_0x2fd9b2[0x0][_0x5383c(0x1a2)]==_0x5383c(0x1ba))var _0x190dde=users[_0x5383c(0x1ba)];else{if(_0x2fd9b2[0x0][_0x5383c(0x1a2)]==_0x5383c(0x198))var _0x190dde=users[_0x5383c(0x16e)];}}}}}}}_0x3ffcc2[_0x5383c(0x1a4)](_0x5383c(0x192),{'success':_0x5c74b0['flash'](_0x5383c(0x1c1)),'errors':_0x5c74b0[_0x5383c(0x1bf)](_0x5383c(0x1a0)),'role':_0x101ae3,'profile':_0x4c8307,'master_shop':_0x2fd9b2,'user':_0x221130,'language':_0x190dde});}catch(_0x4d17c9){console[_0x5383c(0x1ad)](_0x4d17c9);}}),router[a0_0x1daeee(0x1b8)](a0_0x1daeee(0x154),auth,async(_0x5bf011,_0xc11c44)=>{const _0x83eef9=a0_0x1daeee;try{const _0x2eef58=_0x5bf011[_0x83eef9(0x165)]['id'],_0x15a1d7=await suppliers[_0x83eef9(0x19e)](_0x2eef58),{name:_0x1edc04,email:_0x3f9d88,mobile:_0xc2808a,company:_0x26ce71,address:_0x4c08c1,receivable:_0xd407e2,payable:_0x5e5270,code:_0x179f55,contactperson:_0x811f8b,landline:_0x27d80e}=_0x5bf011[_0x83eef9(0x1b9)];_0x15a1d7[_0x83eef9(0x16a)]=_0x1edc04,_0x15a1d7[_0x83eef9(0x175)]=_0x3f9d88,_0x15a1d7[_0x83eef9(0x1a6)]=_0xc2808a,_0x15a1d7[_0x83eef9(0x1bb)]=_0x26ce71,_0x15a1d7[_0x83eef9(0x1b2)]=_0x4c08c1,_0x15a1d7[_0x83eef9(0x18e)]=_0xd407e2,_0x15a1d7[_0x83eef9(0x173)]=_0x5e5270,_0x15a1d7['suppliers_code']=_0x179f55,_0x15a1d7[_0x83eef9(0x1af)]=_0x811f8b,_0x15a1d7[_0x83eef9(0x185)]=_0x27d80e;const _0x57e8f5=await _0x15a1d7['save']();_0x5bf011[_0x83eef9(0x1bf)](_0x83eef9(0x1c1),_0x83eef9(0x1c0)),_0xc11c44[_0x83eef9(0x1bd)](_0x83eef9(0x16d));}catch(_0x28578b){console[_0x83eef9(0x1ad)](_0x28578b);}}),router[a0_0x1daeee(0x19d)]('/view/payment/:id',auth,async(_0x248c7a,_0x3ec8d5)=>{const _0x5e85b3=a0_0x1daeee;try{const {username:_0x4e1af0,email:_0x2818f0,role:_0x57a96c}=_0x248c7a['user'],_0x107159=_0x248c7a['user'],_0x136c50=await profile[_0x5e85b3(0x196)]({'email':_0x107159[_0x5e85b3(0x175)]}),_0x53872d=await master_shop[_0x5e85b3(0x15e)]();console[_0x5e85b3(0x1ad)](_0x5e85b3(0x183),_0x53872d),console[_0x5e85b3(0x1ad)](_0x248c7a[_0x5e85b3(0x165)]['id']);const _0x4d43ac=await suppliers['findOne']({'_id':_0x248c7a[_0x5e85b3(0x165)]['id']});console[_0x5e85b3(0x1ad)](_0x4d43ac);const _0x510c1a=await s_payment_data[_0x5e85b3(0x15e)]({'suppliers':_0x4d43ac[_0x5e85b3(0x16a)]});console[_0x5e85b3(0x1ad)](_0x510c1a);const _0x3d3d3d=await s_payment_data[_0x5e85b3(0x163)]([{'$match':{'suppliers':_0x4d43ac['name']}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console['log'](_0x5e85b3(0x1a9),_0x3d3d3d);const _0x26cafa=await s_payment_data[_0x5e85b3(0x163)]([{'$match':{'suppliers':_0x4d43ac[_0x5e85b3(0x16a)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x5e85b3(0x166),'sum':{'$sum':_0x5e85b3(0x19b)}}}]);console[_0x5e85b3(0x1ad)]('receivable_sum',_0x26cafa);if(_0x53872d[0x0][_0x5e85b3(0x1a2)]=='English\x20(US)'){var _0x54a8b7=users[_0x5e85b3(0x155)];console[_0x5e85b3(0x1ad)](_0x54a8b7);}else{if(_0x53872d[0x0][_0x5e85b3(0x1a2)]==_0x5e85b3(0x1b0))var _0x54a8b7=users[_0x5e85b3(0x1b0)];else{if(_0x53872d[0x0][_0x5e85b3(0x1a2)]==_0x5e85b3(0x1a8))var _0x54a8b7=users[_0x5e85b3(0x1a8)];else{if(_0x53872d[0x0][_0x5e85b3(0x1a2)]=='Spanish')var _0x54a8b7=users[_0x5e85b3(0x17e)];else{if(_0x53872d[0x0][_0x5e85b3(0x1a2)]=='French')var _0x54a8b7=users[_0x5e85b3(0x160)];else{if(_0x53872d[0x0][_0x5e85b3(0x1a2)]==_0x5e85b3(0x1a1))var _0x54a8b7=users[_0x5e85b3(0x189)];else{if(_0x53872d[0x0]['language']==_0x5e85b3(0x1ba))var _0x54a8b7=users[_0x5e85b3(0x1ba)];else{if(_0x53872d[0x0][_0x5e85b3(0x1a2)]==_0x5e85b3(0x198))var _0x54a8b7=users[_0x5e85b3(0x16e)];}}}}}}}_0x3ec8d5[_0x5e85b3(0x1a4)](_0x5e85b3(0x1b6),{'success':_0x248c7a[_0x5e85b3(0x1bf)](_0x5e85b3(0x1c1)),'errors':_0x248c7a[_0x5e85b3(0x1bf)](_0x5e85b3(0x1a0)),'role':_0x107159,'profile':_0x136c50,'master_shop':_0x53872d,'payment':_0x510c1a,'payable':_0x3d3d3d,'receivable':_0x26cafa,'language':_0x54a8b7});}catch(_0xf00cb3){console[_0x5e85b3(0x1ad)](_0xf00cb3);}}),router[a0_0x1daeee(0x19d)](a0_0x1daeee(0x174),auth,async(_0x14b755,_0x4f5b9f)=>{const _0x13bc28=a0_0x1daeee;try{const _0x2457d8=new excelJS[(_0x13bc28(0x18f))](),_0x2f12f7=_0x2457d8[_0x13bc28(0x158)](_0x13bc28(0x19c));return _0x2f12f7[_0x13bc28(0x164)]=[{'header':'Name','key':_0x13bc28(0x190),'width':0xa},{'header':_0x13bc28(0x162),'key':_0x13bc28(0x195),'width':0xa},{'header':'Email','key':_0x13bc28(0x15b),'width':0xa},{'header':_0x13bc28(0x191),'key':_0x13bc28(0x1b2),'width':0xa},{'header':_0x13bc28(0x18c),'key':_0x13bc28(0x1a6),'width':0xa},{'header':_0x13bc28(0x1b2),'key':_0x13bc28(0x175),'width':0xa}],_0x4f5b9f[_0x13bc28(0x176)](_0x13bc28(0x161),_0x13bc28(0x171)),_0x4f5b9f[_0x13bc28(0x176)](_0x13bc28(0x19f),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x2457d8[_0x13bc28(0x172)][_0x13bc28(0x17f)](_0x4f5b9f)['then'](()=>{const _0x4ae2c5=_0x13bc28;_0x4f5b9f[_0x4ae2c5(0x168)](0xc8);});}catch(_0x39718a){_0x4f5b9f[_0x13bc28(0x168)](0x190)[_0x13bc28(0x153)]({'errors':_0x39718a[_0x13bc28(0x187)]});}});function a0_0x37bb(_0x34ea7e,_0x1840ec){const _0x46fc6e=a0_0x46fc();return a0_0x37bb=function(_0x37bb0b,_0x7ac5d7){_0x37bb0b=_0x37bb0b-0x153;let _0x935cad=_0x46fc6e[_0x37bb0b];return _0x935cad;},a0_0x37bb(_0x34ea7e,_0x1840ec);}const storage1=multer['diskStorage']({'destination':(_0x12f4a6,_0x1e1125,_0x465125)=>{const _0x28abf1=a0_0x1daeee;_0x465125(null,_0x28abf1(0x197));},'filename':(_0x68b33,_0x491ca5,_0x4f915c)=>{const _0x1d40d2=a0_0x1daeee;_0x4f915c(null,Date[_0x1d40d2(0x194)]()+_0x491ca5['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x1daeee(0x1b8)](a0_0x1daeee(0x15a),auth,uploadMigrate[a0_0x1daeee(0x159)](a0_0x1daeee(0x1c3)),async(_0x28eca1,_0x4c1959)=>{const _0x596159=a0_0x1daeee,_0x2d9b0f=_0x28eca1[_0x596159(0x170)][_0x596159(0x18a)],_0x50b1b3=await xlsx[_0x596159(0x178)](_0x596159(0x1be)+_0x2d9b0f);let _0x301845=_0x50b1b3[_0x596159(0x17b)],_0x307067=xlsx[_0x596159(0x1a5)][_0x596159(0x193)](_0x50b1b3[_0x596159(0x1a3)][_0x301845[0x0]]);for(const _0x4b1b3d of _0x307067){const _0x183833=_0x4b1b3d[_0x596159(0x199)],_0x56c80=_0x4b1b3d['Supplier_Code'],_0x29bc69=_0x4b1b3d[_0x596159(0x1b2)],_0x8f690c=_0x4b1b3d[_0x596159(0x191)],_0x2d3126=_0x4b1b3d[_0x596159(0x16f)],_0x18e632=_0x4b1b3d[_0x596159(0x18c)];try{let _0x3370b9=await suppliers[_0x596159(0x196)]({'name':_0x183833});if(!_0x3370b9){const _0x4be9b6=new suppliers({'name':_0x183833,'suppliers_code':_0x56c80,'address':_0x29bc69,'mobile':_0x8f690c,'email':_0x2d3126,'company':_0x18e632});_0x3370b9=await _0x4be9b6['save'](),_0x28eca1[_0x596159(0x1bf)](_0x596159(0x1c1),_0x183833+_0x596159(0x1b3));}else _0x28eca1[_0x596159(0x1bf)](_0x596159(0x15c),_0x183833+_0x596159(0x1bc));}catch(_0x5dddfa){_0x4c1959[_0x596159(0x168)](0x1f4)[_0x596159(0x1c4)]({'proderror':_0x5dddfa[_0x596159(0x187)],'aproduct':ProductName});}}_0x4c1959['redirect'](_0x596159(0x16d));}),module[a0_0x1daeee(0x18b)]=router;function a0_0x46fc(){const _0x1484d7=['amount','express','master','3251248nCtOWa','landline','reason','message','558327lBrMRP','Portuguese','filename','exports','Company_Name','save','receivable','Workbook','PBrands','Mobile_number','supplier','sheet_to_json','now','PUnits','findOne','public/Migration','Arabic\x20(ae)','Name','purchase_return','$amount','Customers','get','findById','Content-Disposition','errors','Portuguese\x20(BR)','language','Sheets','render','utils','mobile','../public/language/languages.json','German','payable_sum','559080grxKFH','supplier\x20data\x20add\x20successfully','../models/all_models','log','914931DqhaDh','contactperson','Hindi','Purchase','address','\x20added\x20successfully','../middleware/auth','data','supplier_payment','purchase','post','body','Chinese','company','\x20Failed','redirect','public/Migration/','flash','supplier\x20data\x20update\x20successfully','success','235fVvoWU','supplier_product_file','json','send','/view/:id','English','supplier.js\x20payment_data','99894lWjWVy','addWorksheet','single','/supplier_import_migrate_file','SalesmanName','error','30hvzoMa','find','user','French','Content-Type','Supplier_Code','aggregate','columns','params','$reason','multer','status','suppliers_docs','name','/view','suppliers','/supplier/view','Arabic','Email','file','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','xlsx','payable','/products_export_migrate_file','email','setHeader','map','readFile','Router','English\x20(US)','SheetNames','63JrtVvA','45662emELSm','Spanish','write','26020uPpQzi'];a0_0x46fc=function(){return _0x1484d7;};return a0_0x46fc();}