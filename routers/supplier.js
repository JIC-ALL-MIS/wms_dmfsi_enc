const a0_0x437807=a0_0x12c4;function a0_0x5bcf(){const _0x4e8d92=['amount','single','company','\x20added\x20successfully','payable_sum','attachment;\x20filename=supplier_Migration_File.xlsx','English','aggregate','Arabic\x20(ae)','filename','render','Spanish','Email','French','Customers','map','findById','Purchase','../public/language/languages.json','xlsx','reason','Hindi','diskStorage','1657179xypJVB','/supplier/view','Name','forEach','\x20Failed','language','suppliers_code','exceljs','Portuguese','addWorksheet','write','errors','supplier.js\x20payment_data','s_payments','master','find','now','mobile','findOne','contactperson','Portuguese\x20(BR)','file','post','log','body','$reason','message','sheet_to_json','landline','success','save','suppliers','8540cKUnzt','894392COouVl','public/Migration','columns','params','/supplier_import_migrate_file','PBrands','SheetNames','user','1481616IDVohm','address','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','flash','German','then','suppliers_docs','English\x20(US)','Supplier_Code','status','/view/:id','data','Chinese','setHeader','purchase','3934GKqNFA','1220blurBx','supplier_product_file','send','/products_export_migrate_file','supplier\x20data\x20add\x20successfully','exports','receivable','express','public/Migration/','name','purchase_return','Content-Disposition','Company_Name','Sheets','Purchase\x20Return','Arabic','24400sWAteM','5632VYmQjf','Workbook','Mobile_number','supplier\x20data\x20update\x20successfully','1467WmKKFP','/view/payment/:id','get','supplier','Content-Type','$amount','email','355643qjiaBV','receivable_sum','supplier_payment','/view'];a0_0x5bcf=function(){return _0x4e8d92;};return a0_0x5bcf();}(function(_0x15886e,_0xe096bf){const _0x2f89a2=a0_0x12c4,_0x1c9e14=_0x15886e();while(!![]){try{const _0x8c85d=-parseInt(_0x2f89a2(0x1e0))/0x1+parseInt(_0x2f89a2(0x1ac))/0x2+parseInt(_0x2f89a2(0x18b))/0x3+-parseInt(_0x2f89a2(0x1ab))/0x4*(parseInt(_0x2f89a2(0x1c4))/0x5)+parseInt(_0x2f89a2(0x1b4))/0x6+parseInt(_0x2f89a2(0x1c3))/0x7*(parseInt(_0x2f89a2(0x1d5))/0x8)+parseInt(_0x2f89a2(0x1d9))/0x9*(-parseInt(_0x2f89a2(0x1d4))/0xa);if(_0x8c85d===_0xe096bf)break;else _0x1c9e14['push'](_0x1c9e14['shift']());}catch(_0x38a5f9){_0x1c9e14['push'](_0x1c9e14['shift']());}}}(a0_0x5bcf,0x59cfe));function a0_0x12c4(_0x599dfd,_0x1e39bb){const _0x5bcf2a=a0_0x5bcf();return a0_0x12c4=function(_0x12c413,_0x47ea96){_0x12c413=_0x12c413-0x186;let _0x192e05=_0x5bcf2a[_0x12c413];return _0x192e05;},a0_0x12c4(_0x599dfd,_0x1e39bb);}const express=require(a0_0x437807(0x1cb)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x437807(0x186)),excelJS=require(a0_0x437807(0x192)),xlsx=require(a0_0x437807(0x187)),multer=require('multer');router['get'](a0_0x437807(0x1e3),auth,async(_0x29a72a,_0x47a3d3)=>{const _0x207029=a0_0x437807;try{const {username:_0x284ceb,email:_0xc21fc6,role:_0x5072a3}=_0x29a72a['user'],_0x515ac4=_0x29a72a['user'],_0x32ccfe=await profile['findOne']({'email':_0x515ac4['email']}),_0x20eaef=await master_shop[_0x207029(0x19a)]();console[_0x207029(0x1a2)](_0x207029(0x199),_0x20eaef);const _0x2802d0=await suppliers['find']();console['log'](_0x2802d0);const _0x4c5dda=await suppliers['aggregate']([{'$lookup':{'from':_0x207029(0x198),'localField':_0x207029(0x1cd),'foreignField':_0x207029(0x1aa),'as':_0x207029(0x1ba)}}]),_0x39dcf7=_0x4c5dda[_0x207029(0x1f3)](_0x16d9eb=>{const _0x1482cc=_0x207029;console[_0x1482cc(0x1a2)](_0x1482cc(0x1bf),_0x16d9eb);var _0x12ddf6=0x0,_0x4d25cf=0x0;return _0x16d9eb[_0x1482cc(0x1ba)][_0x1482cc(0x18e)](_0x4b9eae=>{const _0x7d607d=_0x1482cc;console[_0x7d607d(0x1a2)]('doc',_0x4b9eae),_0x4b9eae[_0x7d607d(0x188)]==_0x7d607d(0x1f5)?_0x12ddf6+=_0x4b9eae[_0x7d607d(0x1e4)]:_0x4d25cf+=_0x4b9eae[_0x7d607d(0x1e4)];}),_0x16d9eb[_0x1482cc(0x1c2)]=_0x12ddf6,_0x16d9eb[_0x1482cc(0x1ce)]=_0x4d25cf,_0x16d9eb;});console[_0x207029(0x1a2)](_0x207029(0x197),_0x39dcf7);if(_0x20eaef[0x0]['language']==_0x207029(0x1bb)){var _0x5090af=users[_0x207029(0x1ea)];console[_0x207029(0x1a2)](_0x5090af);}else{if(_0x20eaef[0x0][_0x207029(0x190)]==_0x207029(0x189))var _0x5090af=users[_0x207029(0x189)];else{if(_0x20eaef[0x0][_0x207029(0x190)]=='German')var _0x5090af=users[_0x207029(0x1b8)];else{if(_0x20eaef[0x0][_0x207029(0x190)]=='Spanish')var _0x5090af=users['Spanish'];else{if(_0x20eaef[0x0][_0x207029(0x190)]=='French')var _0x5090af=users[_0x207029(0x1f1)];else{if(_0x20eaef[0x0][_0x207029(0x190)]==_0x207029(0x19f))var _0x5090af=users[_0x207029(0x193)];else{if(_0x20eaef[0x0]['language']==_0x207029(0x1c0))var _0x5090af=users[_0x207029(0x1c0)];else{if(_0x20eaef[0x0]['language']=='Arabic\x20(ae)')var _0x5090af=users[_0x207029(0x1d3)];}}}}}}}_0x47a3d3[_0x207029(0x1ee)](_0x207029(0x1dc),{'success':_0x29a72a['flash'](_0x207029(0x1a8)),'errors':_0x29a72a[_0x207029(0x1b7)](_0x207029(0x196)),'user':_0x2802d0,'profile':_0x32ccfe,'master_shop':_0x20eaef,'role':_0x515ac4,'payment':_0x39dcf7,'language':_0x5090af});}catch(_0x5ee83f){console[_0x207029(0x1a2)](_0x5ee83f);}}),router[a0_0x437807(0x1a1)](a0_0x437807(0x1e3),auth,async(_0x4204ee,_0x3cb14f)=>{const _0x65e97d=a0_0x437807;try{const {name:_0x2f5cf6,email:_0x250c81,mobile:_0x8c2720,company:_0x2fb2e9,address:_0x223db7,receivable:_0x43bf22,payable:_0x4636eb,code:_0x3f1eba,contactperson:_0x4c0cdb,landline:_0x19d638}=_0x4204ee[_0x65e97d(0x1a3)],_0x2d5869=new suppliers({'name':_0x2f5cf6,'email':_0x250c81,'mobile':_0x8c2720,'company':_0x2fb2e9,'address':_0x223db7,'receivable':_0x43bf22,'payable':_0x4636eb,'suppliers_code':_0x3f1eba,'contactperson':_0x4c0cdb,'landline':_0x19d638}),_0x3772be=await _0x2d5869[_0x65e97d(0x1a9)]();_0x4204ee[_0x65e97d(0x1b7)](_0x65e97d(0x1a8),_0x65e97d(0x1c8)),_0x3cb14f['redirect'](_0x65e97d(0x18c));}catch(_0xaff18f){console['log'](_0xaff18f);}}),router['get']('/view/:id',auth,async(_0xd9be5b,_0x165936)=>{const _0xb3d9b7=a0_0x437807;try{const {username:_0x357c87,email:_0x3aa8c6,role:_0x40a2e8}=_0xd9be5b[_0xb3d9b7(0x1b3)],_0x4631e4=_0xd9be5b[_0xb3d9b7(0x1b3)],_0x2017e4=await profile[_0xb3d9b7(0x19d)]({'email':_0x4631e4[_0xb3d9b7(0x1df)]}),_0x5f0750=await master_shop['find']();console[_0xb3d9b7(0x1a2)](_0xb3d9b7(0x199),_0x5f0750);const _0x19ca61=_0xd9be5b[_0xb3d9b7(0x1af)]['id'],_0x3441ee=await suppliers['findById'](_0x19ca61);console[_0xb3d9b7(0x1a2)](_0x3441ee);if(_0x5f0750[0x0][_0xb3d9b7(0x190)]==_0xb3d9b7(0x1bb)){var _0x1e05b8=users[_0xb3d9b7(0x1ea)];console['log'](_0x1e05b8);}else{if(_0x5f0750[0x0][_0xb3d9b7(0x190)]==_0xb3d9b7(0x189))var _0x1e05b8=users[_0xb3d9b7(0x189)];else{if(_0x5f0750[0x0]['language']==_0xb3d9b7(0x1b8))var _0x1e05b8=users[_0xb3d9b7(0x1b8)];else{if(_0x5f0750[0x0]['language']==_0xb3d9b7(0x1ef))var _0x1e05b8=users[_0xb3d9b7(0x1ef)];else{if(_0x5f0750[0x0][_0xb3d9b7(0x190)]=='French')var _0x1e05b8=users[_0xb3d9b7(0x1f1)];else{if(_0x5f0750[0x0][_0xb3d9b7(0x190)]==_0xb3d9b7(0x19f))var _0x1e05b8=users[_0xb3d9b7(0x193)];else{if(_0x5f0750[0x0][_0xb3d9b7(0x190)]==_0xb3d9b7(0x1c0))var _0x1e05b8=users['Chinese'];else{if(_0x5f0750[0x0][_0xb3d9b7(0x190)]==_0xb3d9b7(0x1ec))var _0x1e05b8=users[_0xb3d9b7(0x1d3)];}}}}}}}_0x165936[_0xb3d9b7(0x1ee)](_0xb3d9b7(0x1dc),{'success':_0xd9be5b[_0xb3d9b7(0x1b7)](_0xb3d9b7(0x1a8)),'errors':_0xd9be5b[_0xb3d9b7(0x1b7)](_0xb3d9b7(0x196)),'role':_0x4631e4,'profile':_0x2017e4,'master_shop':_0x5f0750,'user':_0x3441ee,'language':_0x1e05b8});}catch(_0x342e6e){console[_0xb3d9b7(0x1a2)](_0x342e6e);}}),router[a0_0x437807(0x1a1)](a0_0x437807(0x1be),auth,async(_0x4d0e23,_0x1d01ec)=>{const _0x3babb9=a0_0x437807;try{const _0x4047ae=_0x4d0e23[_0x3babb9(0x1af)]['id'],_0x1fb581=await suppliers[_0x3babb9(0x1f4)](_0x4047ae),{name:_0x209fdc,email:_0x1ece5d,mobile:_0x4f4039,company:_0x1bee2a,address:_0x1dfbed,receivable:_0x5ec6f6,payable:_0x1c6892,code:_0x14679e,contactperson:_0x199ce9,landline:_0x3096dc}=_0x4d0e23[_0x3babb9(0x1a3)];_0x1fb581[_0x3babb9(0x1cd)]=_0x209fdc,_0x1fb581[_0x3babb9(0x1df)]=_0x1ece5d,_0x1fb581[_0x3babb9(0x19c)]=_0x4f4039,_0x1fb581[_0x3babb9(0x1e6)]=_0x1bee2a,_0x1fb581[_0x3babb9(0x1b5)]=_0x1dfbed,_0x1fb581[_0x3babb9(0x1ca)]=_0x5ec6f6,_0x1fb581['payable']=_0x1c6892,_0x1fb581[_0x3babb9(0x191)]=_0x14679e,_0x1fb581[_0x3babb9(0x19e)]=_0x199ce9,_0x1fb581[_0x3babb9(0x1a7)]=_0x3096dc;const _0x364484=await _0x1fb581[_0x3babb9(0x1a9)]();_0x4d0e23[_0x3babb9(0x1b7)](_0x3babb9(0x1a8),_0x3babb9(0x1d8)),_0x1d01ec['redirect'](_0x3babb9(0x18c));}catch(_0x5c876f){console['log'](_0x5c876f);}}),router[a0_0x437807(0x1db)](a0_0x437807(0x1da),auth,async(_0x2f6ac8,_0x25e886)=>{const _0x399ec1=a0_0x437807;try{const {username:_0x48f70c,email:_0x443bf7,role:_0x5e7660}=_0x2f6ac8[_0x399ec1(0x1b3)],_0x27ff81=_0x2f6ac8[_0x399ec1(0x1b3)],_0x4a24c0=await profile[_0x399ec1(0x19d)]({'email':_0x27ff81[_0x399ec1(0x1df)]}),_0x4c6032=await master_shop[_0x399ec1(0x19a)]();console['log']('master',_0x4c6032),console[_0x399ec1(0x1a2)](_0x2f6ac8[_0x399ec1(0x1af)]['id']);const _0x515894=await suppliers['findOne']({'_id':_0x2f6ac8[_0x399ec1(0x1af)]['id']});console[_0x399ec1(0x1a2)](_0x515894);const _0x5e1f96=await s_payment_data['find']({'suppliers':_0x515894[_0x399ec1(0x1cd)]});console[_0x399ec1(0x1a2)](_0x5e1f96);const _0x820bad=await s_payment_data[_0x399ec1(0x1eb)]([{'$match':{'suppliers':_0x515894['name']}},{'$match':{'reason':_0x399ec1(0x1f5)}},{'$group':{'_id':_0x399ec1(0x1a4),'sum':{'$sum':_0x399ec1(0x1de)}}}]);console[_0x399ec1(0x1a2)](_0x399ec1(0x1e8),_0x820bad);const _0x13627d=await s_payment_data[_0x399ec1(0x1eb)]([{'$match':{'suppliers':_0x515894['name']}},{'$match':{'reason':_0x399ec1(0x1d2)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x399ec1(0x1de)}}}]);console[_0x399ec1(0x1a2)](_0x399ec1(0x1e1),_0x13627d);if(_0x4c6032[0x0]['language']==_0x399ec1(0x1bb)){var _0xfbc5bf=users[_0x399ec1(0x1ea)];console[_0x399ec1(0x1a2)](_0xfbc5bf);}else{if(_0x4c6032[0x0][_0x399ec1(0x190)]==_0x399ec1(0x189))var _0xfbc5bf=users[_0x399ec1(0x189)];else{if(_0x4c6032[0x0][_0x399ec1(0x190)]==_0x399ec1(0x1b8))var _0xfbc5bf=users[_0x399ec1(0x1b8)];else{if(_0x4c6032[0x0][_0x399ec1(0x190)]=='Spanish')var _0xfbc5bf=users['Spanish'];else{if(_0x4c6032[0x0]['language']=='French')var _0xfbc5bf=users[_0x399ec1(0x1f1)];else{if(_0x4c6032[0x0][_0x399ec1(0x190)]==_0x399ec1(0x19f))var _0xfbc5bf=users[_0x399ec1(0x193)];else{if(_0x4c6032[0x0][_0x399ec1(0x190)]==_0x399ec1(0x1c0))var _0xfbc5bf=users[_0x399ec1(0x1c0)];else{if(_0x4c6032[0x0][_0x399ec1(0x190)]==_0x399ec1(0x1ec))var _0xfbc5bf=users[_0x399ec1(0x1d3)];}}}}}}}_0x25e886[_0x399ec1(0x1ee)](_0x399ec1(0x1e2),{'success':_0x2f6ac8[_0x399ec1(0x1b7)](_0x399ec1(0x1a8)),'errors':_0x2f6ac8[_0x399ec1(0x1b7)]('errors'),'role':_0x27ff81,'profile':_0x4a24c0,'master_shop':_0x4c6032,'payment':_0x5e1f96,'payable':_0x820bad,'receivable':_0x13627d,'language':_0xfbc5bf});}catch(_0x30c62e){console[_0x399ec1(0x1a2)](_0x30c62e);}}),router[a0_0x437807(0x1db)](a0_0x437807(0x1c7),auth,async(_0x2bc306,_0x42f7c1)=>{const _0x1db6e7=a0_0x437807;try{const _0x9fdaed=new excelJS[(_0x1db6e7(0x1d6))](),_0x35e021=_0x9fdaed[_0x1db6e7(0x194)](_0x1db6e7(0x1f2));return _0x35e021[_0x1db6e7(0x1ae)]=[{'header':_0x1db6e7(0x18d),'key':_0x1db6e7(0x1b1),'width':0xa},{'header':'Supplier_Code','key':'PUnits','width':0xa},{'header':'Email','key':'SalesmanName','width':0xa},{'header':_0x1db6e7(0x1d7),'key':_0x1db6e7(0x1b5),'width':0xa},{'header':_0x1db6e7(0x1d0),'key':'mobile','width':0xa},{'header':'address','key':'email','width':0xa}],_0x42f7c1[_0x1db6e7(0x1c1)](_0x1db6e7(0x1dd),_0x1db6e7(0x1b6)),_0x42f7c1[_0x1db6e7(0x1c1)](_0x1db6e7(0x1cf),_0x1db6e7(0x1e9)),_0x9fdaed[_0x1db6e7(0x187)][_0x1db6e7(0x195)](_0x42f7c1)[_0x1db6e7(0x1b9)](()=>{const _0x54ba3a=_0x1db6e7;_0x42f7c1[_0x54ba3a(0x1bd)](0xc8);});}catch(_0x434af3){_0x42f7c1['status'](0x190)[_0x1db6e7(0x1c6)]({'errors':_0x434af3['message']});}});const storage1=multer[a0_0x437807(0x18a)]({'destination':(_0x38d2a7,_0x51b58b,_0x571ea6)=>{const _0x318d10=a0_0x437807;_0x571ea6(null,_0x318d10(0x1ad));},'filename':(_0x30cdc1,_0x2cba41,_0x5bbb03)=>{const _0x4d92fc=a0_0x437807;_0x5bbb03(null,Date[_0x4d92fc(0x19b)]()+_0x2cba41['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x437807(0x1a1)](a0_0x437807(0x1b0),auth,uploadMigrate[a0_0x437807(0x1e5)](a0_0x437807(0x1c5)),async(_0x3fb6d4,_0x205b9a)=>{const _0x5031fb=a0_0x437807,_0x28f223=_0x3fb6d4[_0x5031fb(0x1a0)][_0x5031fb(0x1ed)],_0x193360=await xlsx['readFile'](_0x5031fb(0x1cc)+_0x28f223);let _0x256be7=_0x193360[_0x5031fb(0x1b2)],_0x47f42a=xlsx['utils'][_0x5031fb(0x1a6)](_0x193360[_0x5031fb(0x1d1)][_0x256be7[0x0]]);for(const _0x52784a of _0x47f42a){const _0x309dcb=_0x52784a[_0x5031fb(0x18d)],_0x576eb6=_0x52784a[_0x5031fb(0x1bc)],_0x2248cd=_0x52784a[_0x5031fb(0x1b5)],_0x222f85=_0x52784a[_0x5031fb(0x1d7)],_0x24f45a=_0x52784a[_0x5031fb(0x1f0)],_0x5a5a40=_0x52784a[_0x5031fb(0x1d0)];try{let _0x1509ac=await suppliers[_0x5031fb(0x19d)]({'name':_0x309dcb});if(!_0x1509ac){const _0xfc048f=new suppliers({'name':_0x309dcb,'suppliers_code':_0x576eb6,'address':_0x2248cd,'mobile':_0x222f85,'email':_0x24f45a,'company':_0x5a5a40});_0x1509ac=await _0xfc048f[_0x5031fb(0x1a9)](),_0x3fb6d4[_0x5031fb(0x1b7)](_0x5031fb(0x1a8),_0x309dcb+_0x5031fb(0x1e7));}else _0x3fb6d4[_0x5031fb(0x1b7)]('error',_0x309dcb+_0x5031fb(0x18f));}catch(_0x44941e){_0x205b9a[_0x5031fb(0x1bd)](0x1f4)['json']({'proderror':_0x44941e[_0x5031fb(0x1a5)],'aproduct':ProductName});}}_0x205b9a['redirect'](_0x5031fb(0x18c));}),module[a0_0x437807(0x1c9)]=router;