const a0_0x19bb41=a0_0x5481;(function(_0x1a8096,_0x1ea773){const _0x1ead11=a0_0x5481,_0x53ba9f=_0x1a8096();while(!![]){try{const _0x2a84f1=parseInt(_0x1ead11(0x141))/0x1*(parseInt(_0x1ead11(0x167))/0x2)+parseInt(_0x1ead11(0x10c))/0x3*(parseInt(_0x1ead11(0x15c))/0x4)+-parseInt(_0x1ead11(0x15a))/0x5*(-parseInt(_0x1ead11(0x163))/0x6)+-parseInt(_0x1ead11(0x12d))/0x7+parseInt(_0x1ead11(0x12f))/0x8*(parseInt(_0x1ead11(0x136))/0x9)+parseInt(_0x1ead11(0x113))/0xa*(parseInt(_0x1ead11(0x157))/0xb)+-parseInt(_0x1ead11(0x121))/0xc;if(_0x2a84f1===_0x1ea773)break;else _0x53ba9f['push'](_0x53ba9f['shift']());}catch(_0x342a01){_0x53ba9f['push'](_0x53ba9f['shift']());}}}(a0_0x578c,0x2b4d0));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x19bb41(0x14d)),auth=require('../middleware/auth'),users=require(a0_0x19bb41(0x169)),excelJS=require(a0_0x19bb41(0x145)),xlsx=require(a0_0x19bb41(0x159)),multer=require(a0_0x19bb41(0x12a));router['get']('/view',auth,async(_0x48e762,_0x35b712)=>{const _0xc5dfbb=a0_0x19bb41;try{const {username:_0x979a18,email:_0x4bb839,role:_0x503ac}=_0x48e762[_0xc5dfbb(0x134)],_0x357231=_0x48e762[_0xc5dfbb(0x134)],_0x1a6c60=await profile['findOne']({'email':_0x357231['email']}),_0x7da67e=await master_shop[_0xc5dfbb(0x138)]();console[_0xc5dfbb(0x103)](_0xc5dfbb(0x164),_0x7da67e);const _0x4a320b=await suppliers[_0xc5dfbb(0x138)]();console[_0xc5dfbb(0x103)](_0x4a320b);const _0xf8f99a=await suppliers[_0xc5dfbb(0x116)]([{'$lookup':{'from':_0xc5dfbb(0x11b),'localField':_0xc5dfbb(0x114),'foreignField':_0xc5dfbb(0x158),'as':'suppliers_docs'}}]),_0x406ade=_0xf8f99a['map'](_0x310ece=>{const _0x35b36e=_0xc5dfbb;console[_0x35b36e(0x103)](_0x35b36e(0x126),_0x310ece);var _0x2492df=0x0,_0x33a5cb=0x0;return _0x310ece[_0x35b36e(0x146)][_0x35b36e(0x123)](_0x11d6ba=>{const _0x5fe526=_0x35b36e;console[_0x5fe526(0x103)](_0x5fe526(0x129),_0x11d6ba),_0x11d6ba[_0x5fe526(0x148)]=='Purchase'?_0x2492df+=_0x11d6ba['amount']:_0x33a5cb+=_0x11d6ba['amount'];}),_0x310ece[_0x35b36e(0x13c)]=_0x2492df,_0x310ece[_0x35b36e(0x14a)]=_0x33a5cb,_0x310ece;});console[_0xc5dfbb(0x103)](_0xc5dfbb(0x10f),_0x406ade);if(_0x7da67e[0x0][_0xc5dfbb(0x131)]==_0xc5dfbb(0x118)){var _0x468b87=users['English'];console[_0xc5dfbb(0x103)](_0x468b87);}else{if(_0x7da67e[0x0][_0xc5dfbb(0x131)]==_0xc5dfbb(0x13f))var _0x468b87=users[_0xc5dfbb(0x13f)];else{if(_0x7da67e[0x0][_0xc5dfbb(0x131)]==_0xc5dfbb(0x110))var _0x468b87=users[_0xc5dfbb(0x110)];else{if(_0x7da67e[0x0][_0xc5dfbb(0x131)]=='Spanish')var _0x468b87=users[_0xc5dfbb(0x133)];else{if(_0x7da67e[0x0]['language']==_0xc5dfbb(0x142))var _0x468b87=users[_0xc5dfbb(0x142)];else{if(_0x7da67e[0x0]['language']==_0xc5dfbb(0x165))var _0x468b87=users[_0xc5dfbb(0x13a)];else{if(_0x7da67e[0x0][_0xc5dfbb(0x131)]==_0xc5dfbb(0x127))var _0x468b87=users[_0xc5dfbb(0x127)];else{if(_0x7da67e[0x0]['language']==_0xc5dfbb(0x135))var _0x468b87=users[_0xc5dfbb(0x147)];}}}}}}}_0x35b712[_0xc5dfbb(0x128)](_0xc5dfbb(0x14e),{'success':_0x48e762[_0xc5dfbb(0x140)]('success'),'errors':_0x48e762[_0xc5dfbb(0x140)](_0xc5dfbb(0x137)),'user':_0x4a320b,'profile':_0x1a6c60,'master_shop':_0x7da67e,'role':_0x357231,'payment':_0x406ade,'language':_0x468b87});}catch(_0x1f4ec8){console['log'](_0x1f4ec8);}}),router[a0_0x19bb41(0x10b)](a0_0x19bb41(0x12c),auth,async(_0xb1274c,_0x21780e)=>{const _0x5edab5=a0_0x19bb41;try{const {name:_0x3bec5f,email:_0x4e3b3d,mobile:_0x29467a,company:_0x39e62a,address:_0x263a27,receivable:_0xe41e1b,payable:_0x24d600,code:_0x3b2ebf,contactperson:_0x3f1453,landline:_0x10668b}=_0xb1274c[_0x5edab5(0x125)],_0x330f34=new suppliers({'name':_0x3bec5f,'email':_0x4e3b3d,'mobile':_0x29467a,'company':_0x39e62a,'address':_0x263a27,'receivable':_0xe41e1b,'payable':_0x24d600,'suppliers_code':_0x3b2ebf,'contactperson':_0x3f1453,'landline':_0x10668b}),_0x5ecbb5=await _0x330f34['save']();_0xb1274c['flash'](_0x5edab5(0x102),_0x5edab5(0x161)),_0x21780e['redirect'](_0x5edab5(0x162));}catch(_0x2721dd){console[_0x5edab5(0x103)](_0x2721dd);}}),router[a0_0x19bb41(0x15d)](a0_0x19bb41(0x155),auth,async(_0x1bdf77,_0x41af15)=>{const _0x1566e2=a0_0x19bb41;try{const {username:_0x2a63a8,email:_0x3fabc1,role:_0x3af82c}=_0x1bdf77[_0x1566e2(0x134)],_0x5bd73a=_0x1bdf77[_0x1566e2(0x134)],_0xc2c687=await profile[_0x1566e2(0x15b)]({'email':_0x5bd73a[_0x1566e2(0x11c)]}),_0x96856e=await master_shop[_0x1566e2(0x138)]();console[_0x1566e2(0x103)]('master',_0x96856e);const _0x469639=_0x1bdf77[_0x1566e2(0x143)]['id'],_0x50d697=await suppliers[_0x1566e2(0x154)](_0x469639);console[_0x1566e2(0x103)](_0x50d697);if(_0x96856e[0x0][_0x1566e2(0x131)]==_0x1566e2(0x118)){var _0xad47d5=users['English'];console[_0x1566e2(0x103)](_0xad47d5);}else{if(_0x96856e[0x0]['language']==_0x1566e2(0x13f))var _0xad47d5=users[_0x1566e2(0x13f)];else{if(_0x96856e[0x0]['language']=='German')var _0xad47d5=users[_0x1566e2(0x110)];else{if(_0x96856e[0x0][_0x1566e2(0x131)]==_0x1566e2(0x133))var _0xad47d5=users['Spanish'];else{if(_0x96856e[0x0][_0x1566e2(0x131)]==_0x1566e2(0x142))var _0xad47d5=users[_0x1566e2(0x142)];else{if(_0x96856e[0x0][_0x1566e2(0x131)]==_0x1566e2(0x165))var _0xad47d5=users[_0x1566e2(0x13a)];else{if(_0x96856e[0x0][_0x1566e2(0x131)]==_0x1566e2(0x127))var _0xad47d5=users[_0x1566e2(0x127)];else{if(_0x96856e[0x0][_0x1566e2(0x131)]==_0x1566e2(0x135))var _0xad47d5=users[_0x1566e2(0x147)];}}}}}}}_0x41af15['render'](_0x1566e2(0x14e),{'success':_0x1bdf77['flash'](_0x1566e2(0x102)),'errors':_0x1bdf77[_0x1566e2(0x140)]('errors'),'role':_0x5bd73a,'profile':_0xc2c687,'master_shop':_0x96856e,'user':_0x50d697,'language':_0xad47d5});}catch(_0x20af40){console[_0x1566e2(0x103)](_0x20af40);}}),router[a0_0x19bb41(0x10b)](a0_0x19bb41(0x155),auth,async(_0xa8bd72,_0x46bdc1)=>{const _0x45f202=a0_0x19bb41;try{const _0x284143=_0xa8bd72[_0x45f202(0x143)]['id'],_0x5df896=await suppliers[_0x45f202(0x154)](_0x284143),{name:_0xe53632,email:_0x23374d,mobile:_0x424bdf,company:_0x18748c,address:_0x5570e7,receivable:_0x44e235,payable:_0x3174e0,code:_0x4161ab,contactperson:_0x8d7517,landline:_0x21d221}=_0xa8bd72['body'];_0x5df896[_0x45f202(0x114)]=_0xe53632,_0x5df896[_0x45f202(0x11c)]=_0x23374d,_0x5df896[_0x45f202(0x130)]=_0x424bdf,_0x5df896[_0x45f202(0x150)]=_0x18748c,_0x5df896[_0x45f202(0x152)]=_0x5570e7,_0x5df896[_0x45f202(0x144)]=_0x44e235,_0x5df896['payable']=_0x3174e0,_0x5df896['suppliers_code']=_0x4161ab,_0x5df896['contactperson']=_0x8d7517,_0x5df896['landline']=_0x21d221;const _0xabe43e=await _0x5df896[_0x45f202(0x13e)]();_0xa8bd72[_0x45f202(0x140)](_0x45f202(0x102),'supplier\x20data\x20update\x20successfully'),_0x46bdc1[_0x45f202(0x149)](_0x45f202(0x162));}catch(_0x5a8de1){console[_0x45f202(0x103)](_0x5a8de1);}}),router[a0_0x19bb41(0x15d)](a0_0x19bb41(0x115),auth,async(_0x1812fb,_0x4918ba)=>{const _0x515d06=a0_0x19bb41;try{const {username:_0x172639,email:_0x1b3852,role:_0x2e5316}=_0x1812fb[_0x515d06(0x134)],_0x39c59f=_0x1812fb['user'],_0x3a18d0=await profile[_0x515d06(0x15b)]({'email':_0x39c59f['email']}),_0xa837a2=await master_shop['find']();console['log'](_0x515d06(0x164),_0xa837a2),console[_0x515d06(0x103)](_0x1812fb[_0x515d06(0x143)]['id']);const _0x59b806=await suppliers[_0x515d06(0x15b)]({'_id':_0x1812fb[_0x515d06(0x143)]['id']});console['log'](_0x59b806);const _0x1f3ef2=await s_payment_data[_0x515d06(0x138)]({'suppliers':_0x59b806['name']});console[_0x515d06(0x103)](_0x1f3ef2);const _0x23ce83=await s_payment_data[_0x515d06(0x116)]([{'$match':{'suppliers':_0x59b806[_0x515d06(0x114)]}},{'$match':{'reason':_0x515d06(0x13b)}},{'$group':{'_id':_0x515d06(0x106),'sum':{'$sum':_0x515d06(0x119)}}}]);console[_0x515d06(0x103)](_0x515d06(0x109),_0x23ce83);const _0x393f25=await s_payment_data[_0x515d06(0x116)]([{'$match':{'suppliers':_0x59b806[_0x515d06(0x114)]}},{'$match':{'reason':_0x515d06(0x151)}},{'$group':{'_id':_0x515d06(0x106),'sum':{'$sum':_0x515d06(0x119)}}}]);console[_0x515d06(0x103)](_0x515d06(0x15f),_0x393f25);if(_0xa837a2[0x0][_0x515d06(0x131)]==_0x515d06(0x118)){var _0x6b4216=users['English'];console[_0x515d06(0x103)](_0x6b4216);}else{if(_0xa837a2[0x0]['language']==_0x515d06(0x13f))var _0x6b4216=users['Hindi'];else{if(_0xa837a2[0x0][_0x515d06(0x131)]==_0x515d06(0x110))var _0x6b4216=users['German'];else{if(_0xa837a2[0x0][_0x515d06(0x131)]==_0x515d06(0x133))var _0x6b4216=users[_0x515d06(0x133)];else{if(_0xa837a2[0x0][_0x515d06(0x131)]==_0x515d06(0x142))var _0x6b4216=users[_0x515d06(0x142)];else{if(_0xa837a2[0x0][_0x515d06(0x131)]==_0x515d06(0x165))var _0x6b4216=users[_0x515d06(0x13a)];else{if(_0xa837a2[0x0][_0x515d06(0x131)]==_0x515d06(0x127))var _0x6b4216=users[_0x515d06(0x127)];else{if(_0xa837a2[0x0][_0x515d06(0x131)]=='Arabic\x20(ae)')var _0x6b4216=users['Arabic'];}}}}}}}_0x4918ba['render']('supplier_payment',{'success':_0x1812fb[_0x515d06(0x140)](_0x515d06(0x102)),'errors':_0x1812fb[_0x515d06(0x140)](_0x515d06(0x137)),'role':_0x39c59f,'profile':_0x3a18d0,'master_shop':_0xa837a2,'payment':_0x1f3ef2,'payable':_0x23ce83,'receivable':_0x393f25,'language':_0x6b4216});}catch(_0x2b0b23){console['log'](_0x2b0b23);}}),router[a0_0x19bb41(0x15d)](a0_0x19bb41(0x10a),auth,async(_0x4cd8aa,_0x308153)=>{const _0x370565=a0_0x19bb41;try{const _0x19baac=new excelJS[(_0x370565(0x153))](),_0x1ab5b3=_0x19baac[_0x370565(0x166)](_0x370565(0x12e));return _0x1ab5b3['columns']=[{'header':_0x370565(0x160),'key':'PBrands','width':0xa},{'header':_0x370565(0x11e),'key':_0x370565(0x10e),'width':0xa},{'header':_0x370565(0x120),'key':_0x370565(0x124),'width':0xa},{'header':_0x370565(0x156),'key':_0x370565(0x152),'width':0xa},{'header':_0x370565(0x111),'key':_0x370565(0x130),'width':0xa},{'header':'address','key':_0x370565(0x11c),'width':0xa}],_0x308153[_0x370565(0x105)](_0x370565(0x15e),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x308153[_0x370565(0x105)](_0x370565(0x14c),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x19baac['xlsx'][_0x370565(0x104)](_0x308153)[_0x370565(0x14f)](()=>{_0x308153['status'](0xc8);});}catch(_0x3d19eb){_0x308153[_0x370565(0x11a)](0x190)[_0x370565(0x107)]({'errors':_0x3d19eb[_0x370565(0x122)]});}});const storage1=multer['diskStorage']({'destination':(_0x53313e,_0x29902c,_0x3fa2c5)=>{const _0x13fa37=a0_0x19bb41;_0x3fa2c5(null,_0x13fa37(0x168));},'filename':(_0x17377f,_0x3dbc0a,_0x115656)=>{const _0xfae7d6=a0_0x19bb41;_0x115656(null,Date[_0xfae7d6(0x132)]()+_0x3dbc0a[_0xfae7d6(0x11f)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x5481(_0x48ab23,_0x170ec5){const _0x578c6e=a0_0x578c();return a0_0x5481=function(_0x548193,_0x5e42f7){_0x548193=_0x548193-0x101;let _0x379edb=_0x578c6e[_0x548193];return _0x379edb;},a0_0x5481(_0x48ab23,_0x170ec5);}function a0_0x578c(){const _0x30a554=['suppliers','xlsx','40010tdwrGw','findOne','1180384RJCBeJ','get','Content-Type','receivable_sum','Name','supplier\x20data\x20add\x20successfully','/supplier/view','54swzVJw','master','Portuguese\x20(BR)','addWorksheet','6Kmsyqa','public/Migration','../public/language/languages.json','exports','success','log','write','setHeader','$reason','send','\x20Failed','payable_sum','/products_export_migrate_file','post','3UBxVWM','supplier_product_file','PUnits','supplier.js\x20payment_data','German','Company_Name','\x20added\x20successfully','414370FLYRic','name','/view/payment/:id','aggregate','file','English\x20(US)','$amount','status','s_payments','email','single','Supplier_Code','originalname','Email','9369576bHNkPL','message','forEach','SalesmanName','body','data','Chinese','render','doc','multer','utils','/view','1989848pLPssL','Customers','16PlqsKo','mobile','language','now','Spanish','user','Arabic\x20(ae)','1296801fYeVvL','errors','find','public/Migration/','Portuguese','Purchase','purchase','SheetNames','save','Hindi','flash','112836ygWTBh','French','params','receivable','exceljs','suppliers_docs','Arabic','reason','redirect','purchase_return','json','Content-Disposition','../models/all_models','supplier','then','company','Purchase\x20Return','address','Workbook','findById','/view/:id','Mobile_number','66fvMeMw'];a0_0x578c=function(){return _0x30a554;};return a0_0x578c();}router[a0_0x19bb41(0x10b)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x19bb41(0x11d)](a0_0x19bb41(0x10d)),async(_0x472d76,_0x30a632)=>{const _0x3417ab=a0_0x19bb41,_0x38e56c=_0x472d76[_0x3417ab(0x117)]['filename'],_0x3da5e7=await xlsx['readFile'](_0x3417ab(0x139)+_0x38e56c);let _0x7671ec=_0x3da5e7[_0x3417ab(0x13d)],_0xc94edb=xlsx[_0x3417ab(0x12b)]['sheet_to_json'](_0x3da5e7['Sheets'][_0x7671ec[0x0]]);for(const _0x4a40c2 of _0xc94edb){const _0x4c0b3f=_0x4a40c2[_0x3417ab(0x160)],_0x2c6af4=_0x4a40c2[_0x3417ab(0x11e)],_0x423867=_0x4a40c2['address'],_0x316877=_0x4a40c2['Mobile_number'],_0x536a36=_0x4a40c2[_0x3417ab(0x120)],_0x97cef2=_0x4a40c2['Company_Name'];try{let _0x46b268=await suppliers[_0x3417ab(0x15b)]({'name':_0x4c0b3f});if(!_0x46b268){const _0x5b34e3=new suppliers({'name':_0x4c0b3f,'suppliers_code':_0x2c6af4,'address':_0x423867,'mobile':_0x316877,'email':_0x536a36,'company':_0x97cef2});_0x46b268=await _0x5b34e3[_0x3417ab(0x13e)](),_0x472d76['flash']('success',_0x4c0b3f+_0x3417ab(0x112));}else _0x472d76[_0x3417ab(0x140)]('error',_0x4c0b3f+_0x3417ab(0x108));}catch(_0x23c7d9){_0x30a632['status'](0x1f4)[_0x3417ab(0x14b)]({'proderror':_0x23c7d9[_0x3417ab(0x122)],'aproduct':ProductName});}}_0x30a632[_0x3417ab(0x149)](_0x3417ab(0x162));}),module[a0_0x19bb41(0x101)]=router;