const a0_0xfb9c9d=a0_0x2664;function a0_0x534e(){const _0x4af4c6=['findById','xlsx','express','map','French','../middleware/auth','render','log','Company_Name','40bjhaPW','Purchase','1992bgZHek','Content-Disposition','SalesmanName','reason','redirect','Hindi','German','amount','Content-Type','Spanish','PBrands','579759MIMScZ','/view/payment/:id','/view/:id','supplier_product_file','Workbook','receivable_sum','filename','s_payments','then','2KpJxGP','supplier.js\x20payment_data','readFile','16WwCmLF','SheetNames','/view','Portuguese','Purchase\x20Return','send','get','forEach','221419sZaWnb','json','master','file','Arabic','153345aMkmqh','success','user','originalname','data','post','/supplier_import_migrate_file','language','$reason','single','suppliers_code','purchase','Portuguese\x20(BR)','findOne','58689MWbUkR','diskStorage','869664MXkXDe','/products_export_migrate_file','body','params','2363368DNtnYZ','supplier','errors','Router','Customers','contactperson','Chinese','suppliers','find','Email','status','doc','flash','address','payable','Mobile_number','Sheets','supplier_payment','Name','sheet_to_json','English','suppliers_docs','utils','email','aggregate','Supplier_Code','13095ahHxKS','supplier\x20data\x20add\x20successfully','Arabic\x20(ae)','public/Migration','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','error','multer','exports','receivable','\x20added\x20successfully','mobile','payable_sum','company','message','name','/supplier/view','write','English\x20(US)','setHeader','now','../models/all_models'];a0_0x534e=function(){return _0x4af4c6;};return a0_0x534e();}(function(_0x160ba6,_0x57da72){const _0xdd60ee=a0_0x2664,_0x134d77=_0x160ba6();while(!![]){try{const _0x5f58c9=parseInt(_0xdd60ee(0x103))/0x1+parseInt(_0xdd60ee(0xe5))/0x2*(-parseInt(_0xdd60ee(0xdc))/0x3)+parseInt(_0xdd60ee(0xe8))/0x4*(parseInt(_0xdd60ee(0xf5))/0x5)+parseInt(_0xdd60ee(0x105))/0x6+parseInt(_0xdd60ee(0x109))/0x7+-parseInt(_0xdd60ee(0x143))/0x8*(parseInt(_0xdd60ee(0x123))/0x9)+-parseInt(_0xdd60ee(0x141))/0xa*(-parseInt(_0xdd60ee(0xf0))/0xb);if(_0x5f58c9===_0x57da72)break;else _0x134d77['push'](_0x134d77['shift']());}catch(_0x43f27){_0x134d77['push'](_0x134d77['shift']());}}}(a0_0x534e,0x2e1e5));function a0_0x2664(_0x1dbc53,_0x22d910){const _0x534e79=a0_0x534e();return a0_0x2664=function(_0x266484,_0x1aeeca){_0x266484=_0x266484-0xd2;let _0x2a199f=_0x534e79[_0x266484];return _0x2a199f;},a0_0x2664(_0x1dbc53,_0x22d910);}const express=require(a0_0xfb9c9d(0x13a)),app=express(),router=express[a0_0xfb9c9d(0x10c)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0xfb9c9d(0x137)),auth=require(a0_0xfb9c9d(0x13d)),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require(a0_0xfb9c9d(0x139)),multer=require(a0_0xfb9c9d(0x129));router[a0_0xfb9c9d(0xee)](a0_0xfb9c9d(0xea),auth,async(_0x142f8a,_0x265461)=>{const _0x4462d7=a0_0xfb9c9d;try{const {username:_0x1cc0e1,email:_0x1d400d,role:_0x57821d}=_0x142f8a['user'],_0x73ae6f=_0x142f8a[_0x4462d7(0xf7)],_0x540c31=await profile[_0x4462d7(0x102)]({'email':_0x73ae6f[_0x4462d7(0x120)]}),_0x401ce8=await master_shop['find']();console['log'](_0x4462d7(0xf2),_0x401ce8);const _0x131c91=await suppliers[_0x4462d7(0x111)]();console[_0x4462d7(0x13f)](_0x131c91);const _0x3542ff=await suppliers[_0x4462d7(0x121)]([{'$lookup':{'from':_0x4462d7(0xe3),'localField':_0x4462d7(0x131),'foreignField':_0x4462d7(0x110),'as':_0x4462d7(0x11e)}}]),_0x488eed=_0x3542ff[_0x4462d7(0x13b)](_0x11a815=>{const _0x32e561=_0x4462d7;console[_0x32e561(0x13f)](_0x32e561(0xf9),_0x11a815);var _0x2bf1d6=0x0,_0x4b89a5=0x0;return _0x11a815[_0x32e561(0x11e)][_0x32e561(0xef)](_0x1eeb37=>{const _0x270d45=_0x32e561;console['log'](_0x270d45(0x114),_0x1eeb37),_0x1eeb37[_0x270d45(0xd4)]==_0x270d45(0x142)?_0x2bf1d6+=_0x1eeb37[_0x270d45(0xd8)]:_0x4b89a5+=_0x1eeb37[_0x270d45(0xd8)];}),_0x11a815[_0x32e561(0x100)]=_0x2bf1d6,_0x11a815['purchase_return']=_0x4b89a5,_0x11a815;});console[_0x4462d7(0x13f)](_0x4462d7(0xe6),_0x488eed);if(_0x401ce8[0x0][_0x4462d7(0xfc)]==_0x4462d7(0x134)){var _0x20ea7b=users[_0x4462d7(0x11d)];console[_0x4462d7(0x13f)](_0x20ea7b);}else{if(_0x401ce8[0x0]['language']=='Hindi')var _0x20ea7b=users[_0x4462d7(0xd6)];else{if(_0x401ce8[0x0]['language']==_0x4462d7(0xd7))var _0x20ea7b=users[_0x4462d7(0xd7)];else{if(_0x401ce8[0x0][_0x4462d7(0xfc)]==_0x4462d7(0xda))var _0x20ea7b=users['Spanish'];else{if(_0x401ce8[0x0][_0x4462d7(0xfc)]==_0x4462d7(0x13c))var _0x20ea7b=users[_0x4462d7(0x13c)];else{if(_0x401ce8[0x0][_0x4462d7(0xfc)]=='Portuguese\x20(BR)')var _0x20ea7b=users['Portuguese'];else{if(_0x401ce8[0x0]['language']=='Chinese')var _0x20ea7b=users['Chinese'];else{if(_0x401ce8[0x0][_0x4462d7(0xfc)]=='Arabic\x20(ae)')var _0x20ea7b=users[_0x4462d7(0xf4)];}}}}}}}_0x265461['render'](_0x4462d7(0x10a),{'success':_0x142f8a[_0x4462d7(0x115)](_0x4462d7(0xf6)),'errors':_0x142f8a['flash'](_0x4462d7(0x10b)),'user':_0x131c91,'profile':_0x540c31,'master_shop':_0x401ce8,'role':_0x73ae6f,'payment':_0x488eed,'language':_0x20ea7b});}catch(_0x1f1c2a){console[_0x4462d7(0x13f)](_0x1f1c2a);}}),router[a0_0xfb9c9d(0xfa)](a0_0xfb9c9d(0xea),auth,async(_0x415070,_0x47f166)=>{const _0xed2f7c=a0_0xfb9c9d;try{const {name:_0x5f29d6,email:_0x52ac6a,mobile:_0x53bc3b,company:_0x45721a,address:_0x513ea8,receivable:_0x9dbdd2,payable:_0x30f961,code:_0x18a9d5,contactperson:_0x4eb22e,landline:_0x1dc99a}=_0x415070[_0xed2f7c(0x107)],_0x71d05b=new suppliers({'name':_0x5f29d6,'email':_0x52ac6a,'mobile':_0x53bc3b,'company':_0x45721a,'address':_0x513ea8,'receivable':_0x9dbdd2,'payable':_0x30f961,'suppliers_code':_0x18a9d5,'contactperson':_0x4eb22e,'landline':_0x1dc99a}),_0x5660b4=await _0x71d05b['save']();_0x415070['flash'](_0xed2f7c(0xf6),_0xed2f7c(0x124)),_0x47f166[_0xed2f7c(0xd5)](_0xed2f7c(0x132));}catch(_0x29a3da){console['log'](_0x29a3da);}}),router[a0_0xfb9c9d(0xee)](a0_0xfb9c9d(0xde),auth,async(_0x44014b,_0x4b14cc)=>{const _0x17ac3a=a0_0xfb9c9d;try{const {username:_0x52f435,email:_0x851787,role:_0x17b243}=_0x44014b[_0x17ac3a(0xf7)],_0x518ec7=_0x44014b[_0x17ac3a(0xf7)],_0x5e4495=await profile['findOne']({'email':_0x518ec7[_0x17ac3a(0x120)]}),_0x4ec1a9=await master_shop[_0x17ac3a(0x111)]();console['log']('master',_0x4ec1a9);const _0x16552e=_0x44014b['params']['id'],_0x40a585=await suppliers[_0x17ac3a(0x138)](_0x16552e);console[_0x17ac3a(0x13f)](_0x40a585);if(_0x4ec1a9[0x0][_0x17ac3a(0xfc)]=='English\x20(US)'){var _0x1134bf=users[_0x17ac3a(0x11d)];console['log'](_0x1134bf);}else{if(_0x4ec1a9[0x0][_0x17ac3a(0xfc)]==_0x17ac3a(0xd6))var _0x1134bf=users[_0x17ac3a(0xd6)];else{if(_0x4ec1a9[0x0]['language']==_0x17ac3a(0xd7))var _0x1134bf=users[_0x17ac3a(0xd7)];else{if(_0x4ec1a9[0x0][_0x17ac3a(0xfc)]==_0x17ac3a(0xda))var _0x1134bf=users[_0x17ac3a(0xda)];else{if(_0x4ec1a9[0x0]['language']==_0x17ac3a(0x13c))var _0x1134bf=users[_0x17ac3a(0x13c)];else{if(_0x4ec1a9[0x0]['language']=='Portuguese\x20(BR)')var _0x1134bf=users['Portuguese'];else{if(_0x4ec1a9[0x0][_0x17ac3a(0xfc)]==_0x17ac3a(0x10f))var _0x1134bf=users[_0x17ac3a(0x10f)];else{if(_0x4ec1a9[0x0][_0x17ac3a(0xfc)]==_0x17ac3a(0x125))var _0x1134bf=users[_0x17ac3a(0xf4)];}}}}}}}_0x4b14cc[_0x17ac3a(0x13e)]('supplier',{'success':_0x44014b[_0x17ac3a(0x115)](_0x17ac3a(0xf6)),'errors':_0x44014b[_0x17ac3a(0x115)](_0x17ac3a(0x10b)),'role':_0x518ec7,'profile':_0x5e4495,'master_shop':_0x4ec1a9,'user':_0x40a585,'language':_0x1134bf});}catch(_0x5962e4){console[_0x17ac3a(0x13f)](_0x5962e4);}}),router[a0_0xfb9c9d(0xfa)](a0_0xfb9c9d(0xde),auth,async(_0x59725d,_0x2ea100)=>{const _0x2eb254=a0_0xfb9c9d;try{const _0x1c0a92=_0x59725d[_0x2eb254(0x108)]['id'],_0xebf72=await suppliers[_0x2eb254(0x138)](_0x1c0a92),{name:_0x3da80e,email:_0x38a5e9,mobile:_0x2372e1,company:_0x1fdf58,address:_0xb05efd,receivable:_0x4aef92,payable:_0x5ea730,code:_0x59a3ed,contactperson:_0x1ec45a,landline:_0x1cf0f9}=_0x59725d['body'];_0xebf72[_0x2eb254(0x131)]=_0x3da80e,_0xebf72[_0x2eb254(0x120)]=_0x38a5e9,_0xebf72['mobile']=_0x2372e1,_0xebf72[_0x2eb254(0x12f)]=_0x1fdf58,_0xebf72[_0x2eb254(0x116)]=_0xb05efd,_0xebf72[_0x2eb254(0x12b)]=_0x4aef92,_0xebf72[_0x2eb254(0x117)]=_0x5ea730,_0xebf72[_0x2eb254(0xff)]=_0x59a3ed,_0xebf72[_0x2eb254(0x10e)]=_0x1ec45a,_0xebf72['landline']=_0x1cf0f9;const _0x501359=await _0xebf72['save']();_0x59725d[_0x2eb254(0x115)](_0x2eb254(0xf6),'supplier\x20data\x20update\x20successfully'),_0x2ea100[_0x2eb254(0xd5)]('/supplier/view');}catch(_0x44f999){console[_0x2eb254(0x13f)](_0x44f999);}}),router[a0_0xfb9c9d(0xee)](a0_0xfb9c9d(0xdd),auth,async(_0x15ac82,_0x5f3366)=>{const _0x270707=a0_0xfb9c9d;try{const {username:_0x2492b8,email:_0x2e7ed3,role:_0x2ce2fc}=_0x15ac82[_0x270707(0xf7)],_0x532f75=_0x15ac82[_0x270707(0xf7)],_0x5e3bd9=await profile[_0x270707(0x102)]({'email':_0x532f75[_0x270707(0x120)]}),_0x3829a1=await master_shop[_0x270707(0x111)]();console[_0x270707(0x13f)](_0x270707(0xf2),_0x3829a1),console['log'](_0x15ac82[_0x270707(0x108)]['id']);const _0x337285=await suppliers[_0x270707(0x102)]({'_id':_0x15ac82[_0x270707(0x108)]['id']});console[_0x270707(0x13f)](_0x337285);const _0x3f1bf5=await s_payment_data['find']({'suppliers':_0x337285[_0x270707(0x131)]});console[_0x270707(0x13f)](_0x3f1bf5);const _0x4e0195=await s_payment_data[_0x270707(0x121)]([{'$match':{'suppliers':_0x337285[_0x270707(0x131)]}},{'$match':{'reason':_0x270707(0x142)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console['log'](_0x270707(0x12e),_0x4e0195);const _0x545e0b=await s_payment_data[_0x270707(0x121)]([{'$match':{'suppliers':_0x337285[_0x270707(0x131)]}},{'$match':{'reason':_0x270707(0xec)}},{'$group':{'_id':_0x270707(0xfd),'sum':{'$sum':'$amount'}}}]);console['log'](_0x270707(0xe1),_0x545e0b);if(_0x3829a1[0x0][_0x270707(0xfc)]==_0x270707(0x134)){var _0x272a25=users[_0x270707(0x11d)];console[_0x270707(0x13f)](_0x272a25);}else{if(_0x3829a1[0x0][_0x270707(0xfc)]==_0x270707(0xd6))var _0x272a25=users[_0x270707(0xd6)];else{if(_0x3829a1[0x0][_0x270707(0xfc)]==_0x270707(0xd7))var _0x272a25=users[_0x270707(0xd7)];else{if(_0x3829a1[0x0]['language']==_0x270707(0xda))var _0x272a25=users[_0x270707(0xda)];else{if(_0x3829a1[0x0][_0x270707(0xfc)]=='French')var _0x272a25=users[_0x270707(0x13c)];else{if(_0x3829a1[0x0][_0x270707(0xfc)]==_0x270707(0x101))var _0x272a25=users[_0x270707(0xeb)];else{if(_0x3829a1[0x0][_0x270707(0xfc)]==_0x270707(0x10f))var _0x272a25=users['Chinese'];else{if(_0x3829a1[0x0][_0x270707(0xfc)]==_0x270707(0x125))var _0x272a25=users[_0x270707(0xf4)];}}}}}}}_0x5f3366[_0x270707(0x13e)](_0x270707(0x11a),{'success':_0x15ac82['flash']('success'),'errors':_0x15ac82[_0x270707(0x115)](_0x270707(0x10b)),'role':_0x532f75,'profile':_0x5e3bd9,'master_shop':_0x3829a1,'payment':_0x3f1bf5,'payable':_0x4e0195,'receivable':_0x545e0b,'language':_0x272a25});}catch(_0x401161){console['log'](_0x401161);}}),router[a0_0xfb9c9d(0xee)](a0_0xfb9c9d(0x106),auth,async(_0x5c8e61,_0x5be509)=>{const _0x32780c=a0_0xfb9c9d;try{const _0x4eee55=new excelJS[(_0x32780c(0xe0))](),_0x2d75f0=_0x4eee55['addWorksheet'](_0x32780c(0x10d));return _0x2d75f0['columns']=[{'header':'Name','key':_0x32780c(0xdb),'width':0xa},{'header':_0x32780c(0x122),'key':'PUnits','width':0xa},{'header':_0x32780c(0x112),'key':_0x32780c(0xd3),'width':0xa},{'header':'Mobile_number','key':_0x32780c(0x116),'width':0xa},{'header':_0x32780c(0x140),'key':_0x32780c(0x12d),'width':0xa},{'header':'address','key':_0x32780c(0x120),'width':0xa}],_0x5be509['setHeader'](_0x32780c(0xd9),_0x32780c(0x127)),_0x5be509[_0x32780c(0x135)](_0x32780c(0xd2),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x4eee55[_0x32780c(0x139)][_0x32780c(0x133)](_0x5be509)[_0x32780c(0xe4)](()=>{const _0x9c7f89=_0x32780c;_0x5be509[_0x9c7f89(0x113)](0xc8);});}catch(_0x3b550c){_0x5be509['status'](0x190)[_0x32780c(0xed)]({'errors':_0x3b550c['message']});}});const storage1=multer[a0_0xfb9c9d(0x104)]({'destination':(_0x398c75,_0x377da5,_0x10d4da)=>{const _0x277646=a0_0xfb9c9d;_0x10d4da(null,_0x277646(0x126));},'filename':(_0x52a2fa,_0x2b9909,_0x5e6f7c)=>{const _0x7c12ab=a0_0xfb9c9d;_0x5e6f7c(null,Date[_0x7c12ab(0x136)]()+_0x2b9909[_0x7c12ab(0xf8)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0xfb9c9d(0xfa)](a0_0xfb9c9d(0xfb),auth,uploadMigrate[a0_0xfb9c9d(0xfe)](a0_0xfb9c9d(0xdf)),async(_0xf0ff2d,_0x59815e)=>{const _0xe1e6d5=a0_0xfb9c9d,_0x5650cd=_0xf0ff2d[_0xe1e6d5(0xf3)][_0xe1e6d5(0xe2)],_0x33ca6a=await xlsx[_0xe1e6d5(0xe7)]('public/Migration/'+_0x5650cd);let _0x1b1b5e=_0x33ca6a[_0xe1e6d5(0xe9)],_0x55ce7e=xlsx[_0xe1e6d5(0x11f)][_0xe1e6d5(0x11c)](_0x33ca6a[_0xe1e6d5(0x119)][_0x1b1b5e[0x0]]);for(const _0x50a988 of _0x55ce7e){const _0x4fcc6e=_0x50a988[_0xe1e6d5(0x11b)],_0x30f82e=_0x50a988[_0xe1e6d5(0x122)],_0x22ff11=_0x50a988[_0xe1e6d5(0x116)],_0x1f41fe=_0x50a988[_0xe1e6d5(0x118)],_0x300334=_0x50a988['Email'],_0x3eaa00=_0x50a988[_0xe1e6d5(0x140)];try{let _0x59bd40=await suppliers[_0xe1e6d5(0x102)]({'name':_0x4fcc6e});if(!_0x59bd40){const _0x102e4f=new suppliers({'name':_0x4fcc6e,'suppliers_code':_0x30f82e,'address':_0x22ff11,'mobile':_0x1f41fe,'email':_0x300334,'company':_0x3eaa00});_0x59bd40=await _0x102e4f['save'](),_0xf0ff2d[_0xe1e6d5(0x115)](_0xe1e6d5(0xf6),_0x4fcc6e+_0xe1e6d5(0x12c));}else _0xf0ff2d['flash'](_0xe1e6d5(0x128),_0x4fcc6e+'\x20Failed');}catch(_0x590ac3){_0x59815e[_0xe1e6d5(0x113)](0x1f4)[_0xe1e6d5(0xf1)]({'proderror':_0x590ac3[_0xe1e6d5(0x130)],'aproduct':ProductName});}}_0x59815e['redirect']('/supplier/view');}),module[a0_0xfb9c9d(0x12a)]=router;