function a0_0x108b(){const _0x57d5e4=['aggregate','suppliers_docs','Spanish','Portuguese','Portuguese\x20(BR)','Workbook','$amount','single','mobile','success','findOne','company','setHeader','readFile','French','master','/view','Arabic\x20(ae)','express','Purchase','../public/language/languages.json','doc','email','purchase_return','3MjwXcE','data','German','language','477660wFvgaZ','3733160oEnCYQ','14IOcOEQ','name','\x20Failed','diskStorage','486562apqoLY','Mobile_number','send','/supplier_import_migrate_file','Sheets','Content-Disposition','635920wBbENP','filename','reason','SalesmanName','$reason','/supplier/view','address','find','save','Hindi','exceljs','log','get','/products_export_migrate_file','Chinese','/view/:id','Supplier_Code','receivable','Arabic','write','forEach','English\x20(US)','public/Migration','json','post','multer','2859216kliWml','redirect','contactperson','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','xlsx','supplier\x20data\x20add\x20successfully','purchase','\x20added\x20successfully','Purchase\x20Return','Company_Name','SheetNames','/view/payment/:id','supplier.js\x20payment_data','suppliers','findById','../middleware/auth','supplier','5530464jyWYzd','originalname','Name','addWorksheet','user','92nlnTph','file','attachment;\x20filename=supplier_Migration_File.xlsx','PUnits','Content-Type','message','English','204235DNRfUP','Email','status','render','Router','error','public/Migration/','PBrands','errors','map','payable','params','flash','landline','amount','receivable_sum'];a0_0x108b=function(){return _0x57d5e4;};return a0_0x108b();}const a0_0xb4fe95=a0_0x33ab;(function(_0x1720d7,_0x235064){const _0x8f3342=a0_0x33ab,_0x4d80a4=_0x1720d7();while(!![]){try{const _0x10bcee=parseInt(_0x8f3342(0x220))/0x1+-parseInt(_0x8f3342(0x21a))/0x2*(-parseInt(_0x8f3342(0x210))/0x3)+parseInt(_0x8f3342(0x1e1))/0x4*(-parseInt(_0x8f3342(0x1e8))/0x5)+parseInt(_0x8f3342(0x23a))/0x6*(parseInt(_0x8f3342(0x216))/0x7)+parseInt(_0x8f3342(0x215))/0x8+-parseInt(_0x8f3342(0x1dc))/0x9+-parseInt(_0x8f3342(0x214))/0xa;if(_0x10bcee===_0x235064)break;else _0x4d80a4['push'](_0x4d80a4['shift']());}catch(_0x449bbb){_0x4d80a4['push'](_0x4d80a4['shift']());}}}(a0_0x108b,0xaa357));const express=require(a0_0xb4fe95(0x20a)),app=express(),router=express[a0_0xb4fe95(0x1ec)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require(a0_0xb4fe95(0x249)),users=require(a0_0xb4fe95(0x20c)),excelJS=require(a0_0xb4fe95(0x22a)),xlsx=require('xlsx'),multer=require(a0_0xb4fe95(0x239));router[a0_0xb4fe95(0x22c)](a0_0xb4fe95(0x208),auth,async(_0x38c606,_0x509703)=>{const _0x17c191=a0_0xb4fe95;try{const {username:_0x5b9d0f,email:_0xa06b02,role:_0x522146}=_0x38c606[_0x17c191(0x1e0)],_0x1db158=_0x38c606['user'],_0x410808=await profile['findOne']({'email':_0x1db158['email']}),_0x366db8=await master_shop[_0x17c191(0x227)]();console[_0x17c191(0x22b)](_0x17c191(0x207),_0x366db8);const _0x2ceed3=await suppliers[_0x17c191(0x227)]();console[_0x17c191(0x22b)](_0x2ceed3);const _0x16d84e=await suppliers['aggregate']([{'$lookup':{'from':'s_payments','localField':_0x17c191(0x217),'foreignField':_0x17c191(0x247),'as':'suppliers_docs'}}]),_0x46f7ca=_0x16d84e[_0x17c191(0x1f1)](_0x4db3d5=>{const _0x3f5509=_0x17c191;console[_0x3f5509(0x22b)](_0x3f5509(0x211),_0x4db3d5);var _0x140f60=0x0,_0x3fa964=0x0;return _0x4db3d5[_0x3f5509(0x1f9)][_0x3f5509(0x234)](_0x16398=>{const _0x4084f7=_0x3f5509;console[_0x4084f7(0x22b)](_0x4084f7(0x20d),_0x16398),_0x16398[_0x4084f7(0x222)]==_0x4084f7(0x20b)?_0x140f60+=_0x16398[_0x4084f7(0x1f6)]:_0x3fa964+=_0x16398[_0x4084f7(0x1f6)];}),_0x4db3d5[_0x3f5509(0x240)]=_0x140f60,_0x4db3d5[_0x3f5509(0x20f)]=_0x3fa964,_0x4db3d5;});console[_0x17c191(0x22b)](_0x17c191(0x246),_0x46f7ca);if(_0x366db8[0x0][_0x17c191(0x213)]==_0x17c191(0x235)){var _0x1eb918=users[_0x17c191(0x1e7)];console[_0x17c191(0x22b)](_0x1eb918);}else{if(_0x366db8[0x0][_0x17c191(0x213)]=='Hindi')var _0x1eb918=users['Hindi'];else{if(_0x366db8[0x0][_0x17c191(0x213)]==_0x17c191(0x212))var _0x1eb918=users[_0x17c191(0x212)];else{if(_0x366db8[0x0]['language']==_0x17c191(0x1fa))var _0x1eb918=users[_0x17c191(0x1fa)];else{if(_0x366db8[0x0][_0x17c191(0x213)]==_0x17c191(0x206))var _0x1eb918=users['French'];else{if(_0x366db8[0x0][_0x17c191(0x213)]==_0x17c191(0x1fc))var _0x1eb918=users['Portuguese'];else{if(_0x366db8[0x0]['language']==_0x17c191(0x22e))var _0x1eb918=users[_0x17c191(0x22e)];else{if(_0x366db8[0x0]['language']=='Arabic\x20(ae)')var _0x1eb918=users[_0x17c191(0x232)];}}}}}}}_0x509703[_0x17c191(0x1eb)](_0x17c191(0x24a),{'success':_0x38c606['flash']('success'),'errors':_0x38c606[_0x17c191(0x1f4)]('errors'),'user':_0x2ceed3,'profile':_0x410808,'master_shop':_0x366db8,'role':_0x1db158,'payment':_0x46f7ca,'language':_0x1eb918});}catch(_0x4de70f){console[_0x17c191(0x22b)](_0x4de70f);}}),router[a0_0xb4fe95(0x238)](a0_0xb4fe95(0x208),auth,async(_0x24857c,_0x3299f6)=>{const _0x49bac2=a0_0xb4fe95;try{const {name:_0x2de173,email:_0x4ffc84,mobile:_0x459e98,company:_0x562f2a,address:_0x1975f8,receivable:_0x21d201,payable:_0x2459a5,code:_0x508a01,contactperson:_0x53db37,landline:_0x97d2b0}=_0x24857c['body'],_0x470da4=new suppliers({'name':_0x2de173,'email':_0x4ffc84,'mobile':_0x459e98,'company':_0x562f2a,'address':_0x1975f8,'receivable':_0x21d201,'payable':_0x2459a5,'suppliers_code':_0x508a01,'contactperson':_0x53db37,'landline':_0x97d2b0}),_0x14fd1e=await _0x470da4[_0x49bac2(0x228)]();_0x24857c[_0x49bac2(0x1f4)]('success',_0x49bac2(0x23f)),_0x3299f6[_0x49bac2(0x23b)](_0x49bac2(0x225));}catch(_0x40a8c7){console[_0x49bac2(0x22b)](_0x40a8c7);}}),router[a0_0xb4fe95(0x22c)](a0_0xb4fe95(0x22f),auth,async(_0xe7f77e,_0x124107)=>{const _0x2d26c1=a0_0xb4fe95;try{const {username:_0x1a9691,email:_0x3ad9dc,role:_0x51e022}=_0xe7f77e[_0x2d26c1(0x1e0)],_0x16d8f2=_0xe7f77e['user'],_0x3cd084=await profile[_0x2d26c1(0x202)]({'email':_0x16d8f2[_0x2d26c1(0x20e)]}),_0x10db48=await master_shop[_0x2d26c1(0x227)]();console[_0x2d26c1(0x22b)](_0x2d26c1(0x207),_0x10db48);const _0x334867=_0xe7f77e[_0x2d26c1(0x1f3)]['id'],_0x203b48=await suppliers[_0x2d26c1(0x248)](_0x334867);console[_0x2d26c1(0x22b)](_0x203b48);if(_0x10db48[0x0][_0x2d26c1(0x213)]=='English\x20(US)'){var _0x3b9b4d=users[_0x2d26c1(0x1e7)];console[_0x2d26c1(0x22b)](_0x3b9b4d);}else{if(_0x10db48[0x0][_0x2d26c1(0x213)]==_0x2d26c1(0x229))var _0x3b9b4d=users['Hindi'];else{if(_0x10db48[0x0]['language']=='German')var _0x3b9b4d=users['German'];else{if(_0x10db48[0x0][_0x2d26c1(0x213)]=='Spanish')var _0x3b9b4d=users[_0x2d26c1(0x1fa)];else{if(_0x10db48[0x0][_0x2d26c1(0x213)]=='French')var _0x3b9b4d=users[_0x2d26c1(0x206)];else{if(_0x10db48[0x0][_0x2d26c1(0x213)]==_0x2d26c1(0x1fc))var _0x3b9b4d=users[_0x2d26c1(0x1fb)];else{if(_0x10db48[0x0]['language']==_0x2d26c1(0x22e))var _0x3b9b4d=users['Chinese'];else{if(_0x10db48[0x0][_0x2d26c1(0x213)]==_0x2d26c1(0x209))var _0x3b9b4d=users[_0x2d26c1(0x232)];}}}}}}}_0x124107[_0x2d26c1(0x1eb)](_0x2d26c1(0x24a),{'success':_0xe7f77e[_0x2d26c1(0x1f4)](_0x2d26c1(0x201)),'errors':_0xe7f77e[_0x2d26c1(0x1f4)](_0x2d26c1(0x1f0)),'role':_0x16d8f2,'profile':_0x3cd084,'master_shop':_0x10db48,'user':_0x203b48,'language':_0x3b9b4d});}catch(_0x274a22){console['log'](_0x274a22);}}),router[a0_0xb4fe95(0x238)](a0_0xb4fe95(0x22f),auth,async(_0x36518,_0x2cbb0d)=>{const _0x432a6d=a0_0xb4fe95;try{const _0x29e7c2=_0x36518[_0x432a6d(0x1f3)]['id'],_0x3dbc36=await suppliers[_0x432a6d(0x248)](_0x29e7c2),{name:_0x5049ce,email:_0x4ae98c,mobile:_0x13ba03,company:_0x2be79f,address:_0x41821d,receivable:_0x36c437,payable:_0x12dd1b,code:_0xdceb67,contactperson:_0xeb8033,landline:_0x24e663}=_0x36518['body'];_0x3dbc36[_0x432a6d(0x217)]=_0x5049ce,_0x3dbc36[_0x432a6d(0x20e)]=_0x4ae98c,_0x3dbc36[_0x432a6d(0x200)]=_0x13ba03,_0x3dbc36[_0x432a6d(0x203)]=_0x2be79f,_0x3dbc36[_0x432a6d(0x226)]=_0x41821d,_0x3dbc36[_0x432a6d(0x231)]=_0x36c437,_0x3dbc36[_0x432a6d(0x1f2)]=_0x12dd1b,_0x3dbc36['suppliers_code']=_0xdceb67,_0x3dbc36[_0x432a6d(0x23c)]=_0xeb8033,_0x3dbc36[_0x432a6d(0x1f5)]=_0x24e663;const _0x442c35=await _0x3dbc36['save']();_0x36518[_0x432a6d(0x1f4)](_0x432a6d(0x201),'supplier\x20data\x20update\x20successfully'),_0x2cbb0d[_0x432a6d(0x23b)]('/supplier/view');}catch(_0x54041){console[_0x432a6d(0x22b)](_0x54041);}}),router[a0_0xb4fe95(0x22c)](a0_0xb4fe95(0x245),auth,async(_0x5eafc8,_0x5da501)=>{const _0x434b7a=a0_0xb4fe95;try{const {username:_0x25ce34,email:_0x2bb3e2,role:_0x586722}=_0x5eafc8[_0x434b7a(0x1e0)],_0x41f549=_0x5eafc8[_0x434b7a(0x1e0)],_0xb4a27f=await profile[_0x434b7a(0x202)]({'email':_0x41f549[_0x434b7a(0x20e)]}),_0x39e136=await master_shop['find']();console[_0x434b7a(0x22b)](_0x434b7a(0x207),_0x39e136),console['log'](_0x5eafc8['params']['id']);const _0x171f73=await suppliers[_0x434b7a(0x202)]({'_id':_0x5eafc8[_0x434b7a(0x1f3)]['id']});console[_0x434b7a(0x22b)](_0x171f73);const _0x190fb2=await s_payment_data['find']({'suppliers':_0x171f73[_0x434b7a(0x217)]});console[_0x434b7a(0x22b)](_0x190fb2);const _0x50a833=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x171f73[_0x434b7a(0x217)]}},{'$match':{'reason':_0x434b7a(0x20b)}},{'$group':{'_id':_0x434b7a(0x224),'sum':{'$sum':'$amount'}}}]);console[_0x434b7a(0x22b)]('payable_sum',_0x50a833);const _0x233ac0=await s_payment_data[_0x434b7a(0x1f8)]([{'$match':{'suppliers':_0x171f73['name']}},{'$match':{'reason':_0x434b7a(0x242)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x434b7a(0x1fe)}}}]);console[_0x434b7a(0x22b)](_0x434b7a(0x1f7),_0x233ac0);if(_0x39e136[0x0][_0x434b7a(0x213)]==_0x434b7a(0x235)){var _0x298461=users[_0x434b7a(0x1e7)];console[_0x434b7a(0x22b)](_0x298461);}else{if(_0x39e136[0x0]['language']=='Hindi')var _0x298461=users[_0x434b7a(0x229)];else{if(_0x39e136[0x0]['language']==_0x434b7a(0x212))var _0x298461=users[_0x434b7a(0x212)];else{if(_0x39e136[0x0][_0x434b7a(0x213)]==_0x434b7a(0x1fa))var _0x298461=users[_0x434b7a(0x1fa)];else{if(_0x39e136[0x0]['language']==_0x434b7a(0x206))var _0x298461=users[_0x434b7a(0x206)];else{if(_0x39e136[0x0]['language']==_0x434b7a(0x1fc))var _0x298461=users[_0x434b7a(0x1fb)];else{if(_0x39e136[0x0][_0x434b7a(0x213)]=='Chinese')var _0x298461=users['Chinese'];else{if(_0x39e136[0x0]['language']=='Arabic\x20(ae)')var _0x298461=users[_0x434b7a(0x232)];}}}}}}}_0x5da501[_0x434b7a(0x1eb)]('supplier_payment',{'success':_0x5eafc8[_0x434b7a(0x1f4)](_0x434b7a(0x201)),'errors':_0x5eafc8[_0x434b7a(0x1f4)]('errors'),'role':_0x41f549,'profile':_0xb4a27f,'master_shop':_0x39e136,'payment':_0x190fb2,'payable':_0x50a833,'receivable':_0x233ac0,'language':_0x298461});}catch(_0x4e6842){console[_0x434b7a(0x22b)](_0x4e6842);}}),router[a0_0xb4fe95(0x22c)](a0_0xb4fe95(0x22d),auth,async(_0x4c50d9,_0x3f82b5)=>{const _0x475ad1=a0_0xb4fe95;try{const _0x26bb07=new excelJS[(_0x475ad1(0x1fd))](),_0x38f1fb=_0x26bb07[_0x475ad1(0x1df)]('Customers');return _0x38f1fb['columns']=[{'header':_0x475ad1(0x1de),'key':_0x475ad1(0x1ef),'width':0xa},{'header':_0x475ad1(0x230),'key':_0x475ad1(0x1e4),'width':0xa},{'header':'Email','key':_0x475ad1(0x223),'width':0xa},{'header':_0x475ad1(0x21b),'key':_0x475ad1(0x226),'width':0xa},{'header':_0x475ad1(0x243),'key':_0x475ad1(0x200),'width':0xa},{'header':_0x475ad1(0x226),'key':_0x475ad1(0x20e),'width':0xa}],_0x3f82b5['setHeader'](_0x475ad1(0x1e5),_0x475ad1(0x23d)),_0x3f82b5[_0x475ad1(0x204)](_0x475ad1(0x21f),_0x475ad1(0x1e3)),_0x26bb07[_0x475ad1(0x23e)][_0x475ad1(0x233)](_0x3f82b5)['then'](()=>{_0x3f82b5['status'](0xc8);});}catch(_0x5e847b){_0x3f82b5['status'](0x190)[_0x475ad1(0x21c)]({'errors':_0x5e847b[_0x475ad1(0x1e6)]});}});function a0_0x33ab(_0x1d6315,_0x2fe0fb){const _0x108b92=a0_0x108b();return a0_0x33ab=function(_0x33abed,_0x3b6bf9){_0x33abed=_0x33abed-0x1dc;let _0x1983ee=_0x108b92[_0x33abed];return _0x1983ee;},a0_0x33ab(_0x1d6315,_0x2fe0fb);}const storage1=multer[a0_0xb4fe95(0x219)]({'destination':(_0x4a53ba,_0x6f60e2,_0x2e54d4)=>{const _0x34c2fa=a0_0xb4fe95;_0x2e54d4(null,_0x34c2fa(0x236));},'filename':(_0x4bc9c8,_0x3c6f8b,_0x221415)=>{const _0x39d8e4=a0_0xb4fe95;_0x221415(null,Date['now']()+_0x3c6f8b[_0x39d8e4(0x1dd)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0xb4fe95(0x238)](a0_0xb4fe95(0x21d),auth,uploadMigrate[a0_0xb4fe95(0x1ff)]('supplier_product_file'),async(_0x34a57d,_0x26fa75)=>{const _0x821720=a0_0xb4fe95,_0x446392=_0x34a57d[_0x821720(0x1e2)][_0x821720(0x221)],_0x1c3949=await xlsx[_0x821720(0x205)](_0x821720(0x1ee)+_0x446392);let _0x288f5f=_0x1c3949[_0x821720(0x244)],_0x2b19c0=xlsx['utils']['sheet_to_json'](_0x1c3949[_0x821720(0x21e)][_0x288f5f[0x0]]);for(const _0x44467b of _0x2b19c0){const _0x462187=_0x44467b[_0x821720(0x1de)],_0x1d7b42=_0x44467b['Supplier_Code'],_0x947ccc=_0x44467b[_0x821720(0x226)],_0x36284c=_0x44467b[_0x821720(0x21b)],_0xe935c=_0x44467b[_0x821720(0x1e9)],_0x3df1a6=_0x44467b[_0x821720(0x243)];try{let _0x463b0f=await suppliers['findOne']({'name':_0x462187});if(!_0x463b0f){const _0x20d47d=new suppliers({'name':_0x462187,'suppliers_code':_0x1d7b42,'address':_0x947ccc,'mobile':_0x36284c,'email':_0xe935c,'company':_0x3df1a6});_0x463b0f=await _0x20d47d[_0x821720(0x228)](),_0x34a57d[_0x821720(0x1f4)]('success',_0x462187+_0x821720(0x241));}else _0x34a57d[_0x821720(0x1f4)](_0x821720(0x1ed),_0x462187+_0x821720(0x218));}catch(_0x332cf0){_0x26fa75[_0x821720(0x1ea)](0x1f4)[_0x821720(0x237)]({'proderror':_0x332cf0[_0x821720(0x1e6)],'aproduct':ProductName});}}_0x26fa75[_0x821720(0x23b)]('/supplier/view');}),module['exports']=router;