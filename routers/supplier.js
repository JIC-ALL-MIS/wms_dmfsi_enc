const a0_0x7ea6c9=a0_0x3cae;(function(_0x4f7cfa,_0x46a2c5){const _0x525d69=a0_0x3cae,_0xcecf6d=_0x4f7cfa();while(!![]){try{const _0xfa8577=-parseInt(_0x525d69(0xa7))/0x1*(-parseInt(_0x525d69(0xb3))/0x2)+-parseInt(_0x525d69(0xec))/0x3+-parseInt(_0x525d69(0x9e))/0x4*(-parseInt(_0x525d69(0xac))/0x5)+-parseInt(_0x525d69(0x8c))/0x6+-parseInt(_0x525d69(0xa1))/0x7+-parseInt(_0x525d69(0xc6))/0x8+-parseInt(_0x525d69(0xca))/0x9*(-parseInt(_0x525d69(0xa9))/0xa);if(_0xfa8577===_0x46a2c5)break;else _0xcecf6d['push'](_0xcecf6d['shift']());}catch(_0x56cc97){_0xcecf6d['push'](_0xcecf6d['shift']());}}}(a0_0x5e19,0x7ba68));function a0_0x5e19(){const _0x30db18=['body','render','4540OXeuLY','exports','English','Purchase\x20Return','Arabic\x20(ae)','xlsx','Content-Type','130cHNiZD','log','data','French','amount','payable','language','flash','supplier_product_file','multer','receivable','originalname','Arabic','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','findById','Purchase','/supplier_import_migrate_file','email','public/Migration','6130512yKjDAy','redirect','Supplier_Code','name','9jSUMij','errors','SheetNames','utils','columns','Customers','supplier.js\x20payment_data','map','German','$amount','supplier_payment','post','get','readFile','supplier\x20data\x20add\x20successfully','purchase_return','addWorksheet','company','Chinese','findOne','/supplier/view','mobile','landline','find','Content-Disposition','s_payments','suppliers_docs','reason','Email','success','/products_export_migrate_file','params','Hindi','supplier','1136553RFUEvd','user','send','Router','Spanish','receivable_sum','../public/language/languages.json','Mobile_number','Company_Name','address','public/Migration/','express','2273226WEZHTG','aggregate','Name','Portuguese\x20(BR)','../models/all_models','save','error','attachment;\x20filename=supplier_Migration_File.xlsx','/view/:id','SalesmanName','\x20added\x20successfully','English\x20(US)','setHeader','then','master','PUnits','exceljs','status','188PBYKXz','Portuguese','contactperson','504826VaIHqI','suppliers','Sheets','PBrands','message','../middleware/auth','11807RczcQP','/view','12924950xpFlaU'];a0_0x5e19=function(){return _0x30db18;};return a0_0x5e19();}const express=require(a0_0x7ea6c9(0xf7)),app=express(),router=express[a0_0x7ea6c9(0xef)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x7ea6c9(0x90)),auth=require(a0_0x7ea6c9(0xa6)),users=require(a0_0x7ea6c9(0xf2)),excelJS=require(a0_0x7ea6c9(0x9c)),xlsx=require(a0_0x7ea6c9(0xb1)),multer=require(a0_0x7ea6c9(0xbc));router['get'](a0_0x7ea6c9(0xa8),auth,async(_0x447cf1,_0x549222)=>{const _0x4d0d0b=a0_0x7ea6c9;try{const {username:_0x5d557c,email:_0x217402,role:_0x1233a1}=_0x447cf1[_0x4d0d0b(0xed)],_0x2d67c8=_0x447cf1[_0x4d0d0b(0xed)],_0x4435b8=await profile[_0x4d0d0b(0xdd)]({'email':_0x2d67c8[_0x4d0d0b(0xc4)]}),_0x3e257d=await master_shop[_0x4d0d0b(0xe1)]();console[_0x4d0d0b(0xb4)]('master',_0x3e257d);const _0x2b126e=await suppliers[_0x4d0d0b(0xe1)]();console['log'](_0x2b126e);const _0x1fd4e8=await suppliers[_0x4d0d0b(0x8d)]([{'$lookup':{'from':_0x4d0d0b(0xe3),'localField':_0x4d0d0b(0xc9),'foreignField':_0x4d0d0b(0xa2),'as':_0x4d0d0b(0xe4)}}]),_0x1e3bfc=_0x1fd4e8[_0x4d0d0b(0xd1)](_0x78676a=>{const _0x325f43=_0x4d0d0b;console[_0x325f43(0xb4)](_0x325f43(0xb5),_0x78676a);var _0x3aa162=0x0,_0x45838d=0x0;return _0x78676a[_0x325f43(0xe4)]['forEach'](_0x170610=>{const _0x19fba5=_0x325f43;console[_0x19fba5(0xb4)]('doc',_0x170610),_0x170610[_0x19fba5(0xe5)]==_0x19fba5(0xc2)?_0x3aa162+=_0x170610[_0x19fba5(0xb7)]:_0x45838d+=_0x170610['amount'];}),_0x78676a['purchase']=_0x3aa162,_0x78676a[_0x325f43(0xd9)]=_0x45838d,_0x78676a;});console[_0x4d0d0b(0xb4)](_0x4d0d0b(0xd0),_0x1e3bfc);if(_0x3e257d[0x0][_0x4d0d0b(0xb9)]==_0x4d0d0b(0x97)){var _0x36491e=users[_0x4d0d0b(0xae)];console[_0x4d0d0b(0xb4)](_0x36491e);}else{if(_0x3e257d[0x0][_0x4d0d0b(0xb9)]==_0x4d0d0b(0xea))var _0x36491e=users['Hindi'];else{if(_0x3e257d[0x0][_0x4d0d0b(0xb9)]==_0x4d0d0b(0xd2))var _0x36491e=users['German'];else{if(_0x3e257d[0x0]['language']==_0x4d0d0b(0xf0))var _0x36491e=users['Spanish'];else{if(_0x3e257d[0x0][_0x4d0d0b(0xb9)]==_0x4d0d0b(0xb6))var _0x36491e=users[_0x4d0d0b(0xb6)];else{if(_0x3e257d[0x0][_0x4d0d0b(0xb9)]==_0x4d0d0b(0x8f))var _0x36491e=users[_0x4d0d0b(0x9f)];else{if(_0x3e257d[0x0][_0x4d0d0b(0xb9)]==_0x4d0d0b(0xdc))var _0x36491e=users[_0x4d0d0b(0xdc)];else{if(_0x3e257d[0x0][_0x4d0d0b(0xb9)]==_0x4d0d0b(0xb0))var _0x36491e=users[_0x4d0d0b(0xbf)];}}}}}}}_0x549222[_0x4d0d0b(0xab)](_0x4d0d0b(0xeb),{'success':_0x447cf1[_0x4d0d0b(0xba)](_0x4d0d0b(0xe7)),'errors':_0x447cf1[_0x4d0d0b(0xba)]('errors'),'user':_0x2b126e,'profile':_0x4435b8,'master_shop':_0x3e257d,'role':_0x2d67c8,'payment':_0x1e3bfc,'language':_0x36491e});}catch(_0x20e500){console[_0x4d0d0b(0xb4)](_0x20e500);}}),router['post'](a0_0x7ea6c9(0xa8),auth,async(_0x3fb9c0,_0x132b53)=>{const _0x230413=a0_0x7ea6c9;try{const {name:_0x2e0b73,email:_0x1db245,mobile:_0x197824,company:_0x24500d,address:_0x18a268,receivable:_0x5a609c,payable:_0xbce935,code:_0x28fdea,contactperson:_0x272dfe,landline:_0xd045a6}=_0x3fb9c0[_0x230413(0xaa)],_0x4589ab=new suppliers({'name':_0x2e0b73,'email':_0x1db245,'mobile':_0x197824,'company':_0x24500d,'address':_0x18a268,'receivable':_0x5a609c,'payable':_0xbce935,'suppliers_code':_0x28fdea,'contactperson':_0x272dfe,'landline':_0xd045a6}),_0x4d1cfc=await _0x4589ab[_0x230413(0x91)]();_0x3fb9c0[_0x230413(0xba)](_0x230413(0xe7),_0x230413(0xd8)),_0x132b53[_0x230413(0xc7)](_0x230413(0xde));}catch(_0x448849){console['log'](_0x448849);}}),router[a0_0x7ea6c9(0xd6)](a0_0x7ea6c9(0x94),auth,async(_0x323115,_0x55c2ac)=>{const _0x518159=a0_0x7ea6c9;try{const {username:_0x57e939,email:_0x204b33,role:_0x517a76}=_0x323115['user'],_0x47af18=_0x323115[_0x518159(0xed)],_0x3dce0a=await profile[_0x518159(0xdd)]({'email':_0x47af18[_0x518159(0xc4)]}),_0x14cda7=await master_shop['find']();console['log']('master',_0x14cda7);const _0x1dbb70=_0x323115[_0x518159(0xe9)]['id'],_0x5414a5=await suppliers[_0x518159(0xc1)](_0x1dbb70);console[_0x518159(0xb4)](_0x5414a5);if(_0x14cda7[0x0][_0x518159(0xb9)]==_0x518159(0x97)){var _0x41c6dc=users[_0x518159(0xae)];console[_0x518159(0xb4)](_0x41c6dc);}else{if(_0x14cda7[0x0][_0x518159(0xb9)]==_0x518159(0xea))var _0x41c6dc=users['Hindi'];else{if(_0x14cda7[0x0]['language']==_0x518159(0xd2))var _0x41c6dc=users['German'];else{if(_0x14cda7[0x0][_0x518159(0xb9)]=='Spanish')var _0x41c6dc=users[_0x518159(0xf0)];else{if(_0x14cda7[0x0]['language']==_0x518159(0xb6))var _0x41c6dc=users['French'];else{if(_0x14cda7[0x0]['language']==_0x518159(0x8f))var _0x41c6dc=users[_0x518159(0x9f)];else{if(_0x14cda7[0x0][_0x518159(0xb9)]==_0x518159(0xdc))var _0x41c6dc=users[_0x518159(0xdc)];else{if(_0x14cda7[0x0]['language']==_0x518159(0xb0))var _0x41c6dc=users[_0x518159(0xbf)];}}}}}}}_0x55c2ac[_0x518159(0xab)](_0x518159(0xeb),{'success':_0x323115['flash']('success'),'errors':_0x323115[_0x518159(0xba)](_0x518159(0xcb)),'role':_0x47af18,'profile':_0x3dce0a,'master_shop':_0x14cda7,'user':_0x5414a5,'language':_0x41c6dc});}catch(_0x398504){console['log'](_0x398504);}}),router[a0_0x7ea6c9(0xd5)](a0_0x7ea6c9(0x94),auth,async(_0x855a47,_0x558c65)=>{const _0x2cb0d1=a0_0x7ea6c9;try{const _0x51d116=_0x855a47[_0x2cb0d1(0xe9)]['id'],_0x41fbad=await suppliers[_0x2cb0d1(0xc1)](_0x51d116),{name:_0x54e45a,email:_0x4e55b5,mobile:_0x4b2f4f,company:_0xc883ff,address:_0x5ac61f,receivable:_0x85a94b,payable:_0x3c98b1,code:_0x906e03,contactperson:_0x30635a,landline:_0x3c320b}=_0x855a47['body'];_0x41fbad[_0x2cb0d1(0xc9)]=_0x54e45a,_0x41fbad['email']=_0x4e55b5,_0x41fbad[_0x2cb0d1(0xdf)]=_0x4b2f4f,_0x41fbad[_0x2cb0d1(0xdb)]=_0xc883ff,_0x41fbad[_0x2cb0d1(0xf5)]=_0x5ac61f,_0x41fbad[_0x2cb0d1(0xbd)]=_0x85a94b,_0x41fbad[_0x2cb0d1(0xb8)]=_0x3c98b1,_0x41fbad['suppliers_code']=_0x906e03,_0x41fbad[_0x2cb0d1(0xa0)]=_0x30635a,_0x41fbad[_0x2cb0d1(0xe0)]=_0x3c320b;const _0x3a18f2=await _0x41fbad[_0x2cb0d1(0x91)]();_0x855a47[_0x2cb0d1(0xba)]('success','supplier\x20data\x20update\x20successfully'),_0x558c65['redirect']('/supplier/view');}catch(_0x304c5f){console[_0x2cb0d1(0xb4)](_0x304c5f);}}),router['get']('/view/payment/:id',auth,async(_0x151b48,_0x4217f1)=>{const _0x1fb5c9=a0_0x7ea6c9;try{const {username:_0x13b677,email:_0x26b84a,role:_0x555d1e}=_0x151b48[_0x1fb5c9(0xed)],_0x61bc17=_0x151b48['user'],_0x3dbc49=await profile[_0x1fb5c9(0xdd)]({'email':_0x61bc17['email']}),_0x5db528=await master_shop['find']();console[_0x1fb5c9(0xb4)](_0x1fb5c9(0x9a),_0x5db528),console[_0x1fb5c9(0xb4)](_0x151b48[_0x1fb5c9(0xe9)]['id']);const _0x5e75d9=await suppliers[_0x1fb5c9(0xdd)]({'_id':_0x151b48['params']['id']});console['log'](_0x5e75d9);const _0x4050ef=await s_payment_data[_0x1fb5c9(0xe1)]({'suppliers':_0x5e75d9['name']});console[_0x1fb5c9(0xb4)](_0x4050ef);const _0x2bd0bf=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x5e75d9[_0x1fb5c9(0xc9)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x1fb5c9(0xd3)}}}]);console['log']('payable_sum',_0x2bd0bf);const _0x4b0cb9=await s_payment_data[_0x1fb5c9(0x8d)]([{'$match':{'suppliers':_0x5e75d9[_0x1fb5c9(0xc9)]}},{'$match':{'reason':_0x1fb5c9(0xaf)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x1fb5c9(0xd3)}}}]);console['log'](_0x1fb5c9(0xf1),_0x4b0cb9);if(_0x5db528[0x0]['language']=='English\x20(US)'){var _0x2fee6e=users[_0x1fb5c9(0xae)];console[_0x1fb5c9(0xb4)](_0x2fee6e);}else{if(_0x5db528[0x0][_0x1fb5c9(0xb9)]==_0x1fb5c9(0xea))var _0x2fee6e=users[_0x1fb5c9(0xea)];else{if(_0x5db528[0x0][_0x1fb5c9(0xb9)]=='German')var _0x2fee6e=users[_0x1fb5c9(0xd2)];else{if(_0x5db528[0x0][_0x1fb5c9(0xb9)]==_0x1fb5c9(0xf0))var _0x2fee6e=users[_0x1fb5c9(0xf0)];else{if(_0x5db528[0x0]['language']==_0x1fb5c9(0xb6))var _0x2fee6e=users[_0x1fb5c9(0xb6)];else{if(_0x5db528[0x0][_0x1fb5c9(0xb9)]==_0x1fb5c9(0x8f))var _0x2fee6e=users['Portuguese'];else{if(_0x5db528[0x0][_0x1fb5c9(0xb9)]=='Chinese')var _0x2fee6e=users['Chinese'];else{if(_0x5db528[0x0]['language']==_0x1fb5c9(0xb0))var _0x2fee6e=users['Arabic'];}}}}}}}_0x4217f1[_0x1fb5c9(0xab)](_0x1fb5c9(0xd4),{'success':_0x151b48[_0x1fb5c9(0xba)](_0x1fb5c9(0xe7)),'errors':_0x151b48['flash'](_0x1fb5c9(0xcb)),'role':_0x61bc17,'profile':_0x3dbc49,'master_shop':_0x5db528,'payment':_0x4050ef,'payable':_0x2bd0bf,'receivable':_0x4b0cb9,'language':_0x2fee6e});}catch(_0x4f073c){console[_0x1fb5c9(0xb4)](_0x4f073c);}}),router[a0_0x7ea6c9(0xd6)](a0_0x7ea6c9(0xe8),auth,async(_0x6b4897,_0xf41ec9)=>{const _0x2b31be=a0_0x7ea6c9;try{const _0x389654=new excelJS['Workbook'](),_0x2978a2=_0x389654[_0x2b31be(0xda)](_0x2b31be(0xcf));return _0x2978a2[_0x2b31be(0xce)]=[{'header':_0x2b31be(0x8e),'key':_0x2b31be(0xa4),'width':0xa},{'header':_0x2b31be(0xc8),'key':_0x2b31be(0x9b),'width':0xa},{'header':_0x2b31be(0xe6),'key':_0x2b31be(0x95),'width':0xa},{'header':_0x2b31be(0xf3),'key':_0x2b31be(0xf5),'width':0xa},{'header':_0x2b31be(0xf4),'key':_0x2b31be(0xdf),'width':0xa},{'header':_0x2b31be(0xf5),'key':'email','width':0xa}],_0xf41ec9[_0x2b31be(0x98)](_0x2b31be(0xb2),_0x2b31be(0xc0)),_0xf41ec9[_0x2b31be(0x98)](_0x2b31be(0xe2),_0x2b31be(0x93)),_0x389654[_0x2b31be(0xb1)]['write'](_0xf41ec9)[_0x2b31be(0x99)](()=>{const _0x74e7c2=_0x2b31be;_0xf41ec9[_0x74e7c2(0x9d)](0xc8);});}catch(_0x420fc9){_0xf41ec9[_0x2b31be(0x9d)](0x190)[_0x2b31be(0xee)]({'errors':_0x420fc9['message']});}});function a0_0x3cae(_0x132637,_0x35afc3){const _0x5e19dc=a0_0x5e19();return a0_0x3cae=function(_0x3caed4,_0x111dcb){_0x3caed4=_0x3caed4-0x8c;let _0x2f288e=_0x5e19dc[_0x3caed4];return _0x2f288e;},a0_0x3cae(_0x132637,_0x35afc3);}const storage1=multer['diskStorage']({'destination':(_0x31a67b,_0x54f022,_0x149d47)=>{const _0x4f58de=a0_0x7ea6c9;_0x149d47(null,_0x4f58de(0xc5));},'filename':(_0x11edbb,_0x126bfc,_0x563bc9)=>{const _0x38c1bd=a0_0x7ea6c9;_0x563bc9(null,Date['now']()+_0x126bfc[_0x38c1bd(0xbe)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x7ea6c9(0xd5)](a0_0x7ea6c9(0xc3),auth,uploadMigrate['single'](a0_0x7ea6c9(0xbb)),async(_0x45bf6d,_0x1a08cc)=>{const _0x2f2293=a0_0x7ea6c9,_0x194542=_0x45bf6d['file']['filename'],_0x56fbe8=await xlsx[_0x2f2293(0xd7)](_0x2f2293(0xf6)+_0x194542);let _0x503fac=_0x56fbe8[_0x2f2293(0xcc)],_0x209074=xlsx[_0x2f2293(0xcd)]['sheet_to_json'](_0x56fbe8[_0x2f2293(0xa3)][_0x503fac[0x0]]);for(const _0x4c7c4f of _0x209074){const _0x5df85e=_0x4c7c4f['Name'],_0x4d7d0d=_0x4c7c4f[_0x2f2293(0xc8)],_0x2b403b=_0x4c7c4f['address'],_0x1fc80b=_0x4c7c4f[_0x2f2293(0xf3)],_0x52bc90=_0x4c7c4f[_0x2f2293(0xe6)],_0x480420=_0x4c7c4f[_0x2f2293(0xf4)];try{let _0xe00f46=await suppliers[_0x2f2293(0xdd)]({'name':_0x5df85e});if(!_0xe00f46){const _0xef6179=new suppliers({'name':_0x5df85e,'suppliers_code':_0x4d7d0d,'address':_0x2b403b,'mobile':_0x1fc80b,'email':_0x52bc90,'company':_0x480420});_0xe00f46=await _0xef6179['save'](),_0x45bf6d[_0x2f2293(0xba)](_0x2f2293(0xe7),_0x5df85e+_0x2f2293(0x96));}else _0x45bf6d[_0x2f2293(0xba)](_0x2f2293(0x92),_0x5df85e+'\x20Failed');}catch(_0x33b3b3){_0x1a08cc[_0x2f2293(0x9d)](0x1f4)['json']({'proderror':_0x33b3b3[_0x2f2293(0xa5)],'aproduct':ProductName});}}_0x1a08cc[_0x2f2293(0xc7)]('/supplier/view');}),module[a0_0x7ea6c9(0xad)]=router;