const a0_0x1779b4=a0_0x5c69;(function(_0x522d3e,_0x47dddb){const _0x10b759=a0_0x5c69,_0x25696d=_0x522d3e();while(!![]){try{const _0x181da0=-parseInt(_0x10b759(0x127))/0x1+-parseInt(_0x10b759(0x113))/0x2*(-parseInt(_0x10b759(0x155))/0x3)+parseInt(_0x10b759(0x143))/0x4+parseInt(_0x10b759(0x144))/0x5+-parseInt(_0x10b759(0x175))/0x6+-parseInt(_0x10b759(0x14a))/0x7*(parseInt(_0x10b759(0x118))/0x8)+-parseInt(_0x10b759(0x166))/0x9*(parseInt(_0x10b759(0x114))/0xa);if(_0x181da0===_0x47dddb)break;else _0x25696d['push'](_0x25696d['shift']());}catch(_0xcfe177){_0x25696d['push'](_0x25696d['shift']());}}}(a0_0x2248,0x5b336));const express=require(a0_0x1779b4(0x152)),app=express(),router=express[a0_0x1779b4(0x12d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1779b4(0x126)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require(a0_0x1779b4(0x14c)),multer=require(a0_0x1779b4(0x11e));function a0_0x5c69(_0x5c156a,_0x4bdf5b){const _0x224891=a0_0x2248();return a0_0x5c69=function(_0x5c69b5,_0x4ab6d8){_0x5c69b5=_0x5c69b5-0x10b;let _0x5686b5=_0x224891[_0x5c69b5];return _0x5686b5;},a0_0x5c69(_0x5c156a,_0x4bdf5b);}router[a0_0x1779b4(0x171)](a0_0x1779b4(0x10b),auth,async(_0x1d4ae7,_0x20db35)=>{const _0x15084c=a0_0x1779b4;try{const {username:_0x3fc80d,email:_0x4525bc,role:_0x56847b}=_0x1d4ae7['user'],_0x3e3dd2=_0x1d4ae7[_0x15084c(0x13f)],_0x5f5226=await profile[_0x15084c(0x16f)]({'email':_0x3e3dd2[_0x15084c(0x11d)]}),_0x59d586=await master_shop[_0x15084c(0x154)]();console[_0x15084c(0x14f)](_0x15084c(0x176),_0x59d586);const _0x49fc26=await suppliers[_0x15084c(0x154)]();console[_0x15084c(0x14f)](_0x49fc26);const _0x44d34b=await suppliers[_0x15084c(0x110)]([{'$lookup':{'from':_0x15084c(0x16a),'localField':'name','foreignField':'suppliers','as':_0x15084c(0x138)}}]),_0x410430=_0x44d34b[_0x15084c(0x133)](_0x3155df=>{const _0x5916fe=_0x15084c;console[_0x5916fe(0x14f)](_0x5916fe(0x131),_0x3155df);var _0x29fed3=0x0,_0x14780e=0x0;return _0x3155df['suppliers_docs'][_0x5916fe(0x15a)](_0xdca963=>{const _0x5b7ac4=_0x5916fe;console[_0x5b7ac4(0x14f)](_0x5b7ac4(0x10e),_0xdca963),_0xdca963[_0x5b7ac4(0x13e)]==_0x5b7ac4(0x14d)?_0x29fed3+=_0xdca963[_0x5b7ac4(0x163)]:_0x14780e+=_0xdca963[_0x5b7ac4(0x163)];}),_0x3155df[_0x5916fe(0x11a)]=_0x29fed3,_0x3155df['purchase_return']=_0x14780e,_0x3155df;});console[_0x15084c(0x14f)]('supplier.js\x20payment_data',_0x410430);if(_0x59d586[0x0][_0x15084c(0x16c)]==_0x15084c(0x15c)){var _0x2a767f=users[_0x15084c(0x122)];console[_0x15084c(0x14f)](_0x2a767f);}else{if(_0x59d586[0x0][_0x15084c(0x16c)]=='Hindi')var _0x2a767f=users[_0x15084c(0x149)];else{if(_0x59d586[0x0][_0x15084c(0x16c)]==_0x15084c(0x170))var _0x2a767f=users[_0x15084c(0x170)];else{if(_0x59d586[0x0][_0x15084c(0x16c)]==_0x15084c(0x15d))var _0x2a767f=users['Spanish'];else{if(_0x59d586[0x0][_0x15084c(0x16c)]==_0x15084c(0x130))var _0x2a767f=users[_0x15084c(0x130)];else{if(_0x59d586[0x0][_0x15084c(0x16c)]==_0x15084c(0x165))var _0x2a767f=users[_0x15084c(0x147)];else{if(_0x59d586[0x0][_0x15084c(0x16c)]==_0x15084c(0x121))var _0x2a767f=users[_0x15084c(0x121)];else{if(_0x59d586[0x0][_0x15084c(0x16c)]==_0x15084c(0x142))var _0x2a767f=users[_0x15084c(0x15e)];}}}}}}}_0x20db35[_0x15084c(0x139)](_0x15084c(0x153),{'success':_0x1d4ae7[_0x15084c(0x141)](_0x15084c(0x11b)),'errors':_0x1d4ae7[_0x15084c(0x141)](_0x15084c(0x140)),'user':_0x49fc26,'profile':_0x5f5226,'master_shop':_0x59d586,'role':_0x3e3dd2,'payment':_0x410430,'language':_0x2a767f});}catch(_0x58368e){console[_0x15084c(0x14f)](_0x58368e);}}),router['post'](a0_0x1779b4(0x10b),auth,async(_0x5f36b3,_0x5c7710)=>{const _0x2964f7=a0_0x1779b4;try{const {name:_0x2bdd18,email:_0x23d1f6,mobile:_0xd11c76,company:_0x442c9c,address:_0x15170d,receivable:_0x7a09d6,payable:_0x5493ea,code:_0x595960,contactperson:_0x318e1c,landline:_0x53f640}=_0x5f36b3[_0x2964f7(0x10c)],_0x39cb5c=new suppliers({'name':_0x2bdd18,'email':_0x23d1f6,'mobile':_0xd11c76,'company':_0x442c9c,'address':_0x15170d,'receivable':_0x7a09d6,'payable':_0x5493ea,'suppliers_code':_0x595960,'contactperson':_0x318e1c,'landline':_0x53f640}),_0x54fe77=await _0x39cb5c[_0x2964f7(0x151)]();_0x5f36b3[_0x2964f7(0x141)](_0x2964f7(0x11b),_0x2964f7(0x11c)),_0x5c7710[_0x2964f7(0x16e)](_0x2964f7(0x10d));}catch(_0x6f7a48){console[_0x2964f7(0x14f)](_0x6f7a48);}}),router['get'](a0_0x1779b4(0x167),auth,async(_0x4a141c,_0xcb7d35)=>{const _0x382bf1=a0_0x1779b4;try{const {username:_0x12c103,email:_0x7a2e6f,role:_0x49eef9}=_0x4a141c[_0x382bf1(0x13f)],_0x10d869=_0x4a141c['user'],_0x28f612=await profile[_0x382bf1(0x16f)]({'email':_0x10d869[_0x382bf1(0x11d)]}),_0x5f4a5c=await master_shop[_0x382bf1(0x154)]();console[_0x382bf1(0x14f)](_0x382bf1(0x176),_0x5f4a5c);const _0xb3432e=_0x4a141c[_0x382bf1(0x148)]['id'],_0x23db42=await suppliers[_0x382bf1(0x162)](_0xb3432e);console['log'](_0x23db42);if(_0x5f4a5c[0x0][_0x382bf1(0x16c)]==_0x382bf1(0x15c)){var _0x1d5f3c=users['English'];console[_0x382bf1(0x14f)](_0x1d5f3c);}else{if(_0x5f4a5c[0x0]['language']==_0x382bf1(0x149))var _0x1d5f3c=users['Hindi'];else{if(_0x5f4a5c[0x0]['language']=='German')var _0x1d5f3c=users[_0x382bf1(0x170)];else{if(_0x5f4a5c[0x0][_0x382bf1(0x16c)]==_0x382bf1(0x15d))var _0x1d5f3c=users['Spanish'];else{if(_0x5f4a5c[0x0][_0x382bf1(0x16c)]==_0x382bf1(0x130))var _0x1d5f3c=users[_0x382bf1(0x130)];else{if(_0x5f4a5c[0x0]['language']=='Portuguese\x20(BR)')var _0x1d5f3c=users[_0x382bf1(0x147)];else{if(_0x5f4a5c[0x0][_0x382bf1(0x16c)]==_0x382bf1(0x121))var _0x1d5f3c=users[_0x382bf1(0x121)];else{if(_0x5f4a5c[0x0][_0x382bf1(0x16c)]==_0x382bf1(0x142))var _0x1d5f3c=users[_0x382bf1(0x15e)];}}}}}}}_0xcb7d35[_0x382bf1(0x139)](_0x382bf1(0x153),{'success':_0x4a141c[_0x382bf1(0x141)](_0x382bf1(0x11b)),'errors':_0x4a141c[_0x382bf1(0x141)](_0x382bf1(0x140)),'role':_0x10d869,'profile':_0x28f612,'master_shop':_0x5f4a5c,'user':_0x23db42,'language':_0x1d5f3c});}catch(_0x50d904){console[_0x382bf1(0x14f)](_0x50d904);}}),router[a0_0x1779b4(0x12c)](a0_0x1779b4(0x167),auth,async(_0x8e6be0,_0x3a3a51)=>{const _0x312c9c=a0_0x1779b4;try{const _0x4f1112=_0x8e6be0[_0x312c9c(0x148)]['id'],_0x45b4a0=await suppliers['findById'](_0x4f1112),{name:_0x6df176,email:_0x51693c,mobile:_0x3baa9c,company:_0xf21d12,address:_0x37bce7,receivable:_0x32261a,payable:_0x22c18d,code:_0xa43f0d,contactperson:_0xdec8d4,landline:_0x2a5b01}=_0x8e6be0['body'];_0x45b4a0[_0x312c9c(0x158)]=_0x6df176,_0x45b4a0['email']=_0x51693c,_0x45b4a0[_0x312c9c(0x172)]=_0x3baa9c,_0x45b4a0['company']=_0xf21d12,_0x45b4a0[_0x312c9c(0x13d)]=_0x37bce7,_0x45b4a0[_0x312c9c(0x116)]=_0x32261a,_0x45b4a0[_0x312c9c(0x13a)]=_0x22c18d,_0x45b4a0['suppliers_code']=_0xa43f0d,_0x45b4a0[_0x312c9c(0x125)]=_0xdec8d4,_0x45b4a0[_0x312c9c(0x11f)]=_0x2a5b01;const _0x64ff06=await _0x45b4a0['save']();_0x8e6be0[_0x312c9c(0x141)](_0x312c9c(0x11b),_0x312c9c(0x137)),_0x3a3a51['redirect']('/supplier/view');}catch(_0x4f37ce){console[_0x312c9c(0x14f)](_0x4f37ce);}}),router[a0_0x1779b4(0x171)](a0_0x1779b4(0x16d),auth,async(_0x4480f1,_0x3a2a69)=>{const _0x1e28c5=a0_0x1779b4;try{const {username:_0x35c490,email:_0x17f179,role:_0x379a36}=_0x4480f1[_0x1e28c5(0x13f)],_0x5e3f44=_0x4480f1[_0x1e28c5(0x13f)],_0x308e77=await profile[_0x1e28c5(0x16f)]({'email':_0x5e3f44['email']}),_0x552863=await master_shop[_0x1e28c5(0x154)]();console['log'](_0x1e28c5(0x176),_0x552863),console[_0x1e28c5(0x14f)](_0x4480f1[_0x1e28c5(0x148)]['id']);const _0xea480c=await suppliers['findOne']({'_id':_0x4480f1[_0x1e28c5(0x148)]['id']});console[_0x1e28c5(0x14f)](_0xea480c);const _0x5cd834=await s_payment_data['find']({'suppliers':_0xea480c[_0x1e28c5(0x158)]});console[_0x1e28c5(0x14f)](_0x5cd834);const _0x5b94f3=await s_payment_data['aggregate']([{'$match':{'suppliers':_0xea480c[_0x1e28c5(0x158)]}},{'$match':{'reason':_0x1e28c5(0x14d)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x1e28c5(0x14f)](_0x1e28c5(0x157),_0x5b94f3);const _0x71872=await s_payment_data[_0x1e28c5(0x110)]([{'$match':{'suppliers':_0xea480c[_0x1e28c5(0x158)]}},{'$match':{'reason':_0x1e28c5(0x128)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x1e28c5(0x13b)}}}]);console[_0x1e28c5(0x14f)]('receivable_sum',_0x71872);if(_0x552863[0x0][_0x1e28c5(0x16c)]==_0x1e28c5(0x15c)){var _0x1678f7=users[_0x1e28c5(0x122)];console[_0x1e28c5(0x14f)](_0x1678f7);}else{if(_0x552863[0x0]['language']==_0x1e28c5(0x149))var _0x1678f7=users[_0x1e28c5(0x149)];else{if(_0x552863[0x0][_0x1e28c5(0x16c)]==_0x1e28c5(0x170))var _0x1678f7=users[_0x1e28c5(0x170)];else{if(_0x552863[0x0][_0x1e28c5(0x16c)]==_0x1e28c5(0x15d))var _0x1678f7=users['Spanish'];else{if(_0x552863[0x0]['language']==_0x1e28c5(0x130))var _0x1678f7=users[_0x1e28c5(0x130)];else{if(_0x552863[0x0][_0x1e28c5(0x16c)]==_0x1e28c5(0x165))var _0x1678f7=users['Portuguese'];else{if(_0x552863[0x0]['language']==_0x1e28c5(0x121))var _0x1678f7=users[_0x1e28c5(0x121)];else{if(_0x552863[0x0][_0x1e28c5(0x16c)]==_0x1e28c5(0x142))var _0x1678f7=users[_0x1e28c5(0x15e)];}}}}}}}_0x3a2a69[_0x1e28c5(0x139)](_0x1e28c5(0x159),{'success':_0x4480f1[_0x1e28c5(0x141)](_0x1e28c5(0x11b)),'errors':_0x4480f1[_0x1e28c5(0x141)](_0x1e28c5(0x140)),'role':_0x5e3f44,'profile':_0x308e77,'master_shop':_0x552863,'payment':_0x5cd834,'payable':_0x5b94f3,'receivable':_0x71872,'language':_0x1678f7});}catch(_0x16916a){console[_0x1e28c5(0x14f)](_0x16916a);}}),router[a0_0x1779b4(0x171)]('/products_export_migrate_file',auth,async(_0x3992b2,_0x16175c)=>{const _0x23a3f3=a0_0x1779b4;try{const _0x57e668=new excelJS[(_0x23a3f3(0x119))](),_0x15e7e3=_0x57e668['addWorksheet'](_0x23a3f3(0x120));return _0x15e7e3['columns']=[{'header':'Name','key':_0x23a3f3(0x156),'width':0xa},{'header':_0x23a3f3(0x164),'key':_0x23a3f3(0x145),'width':0xa},{'header':_0x23a3f3(0x129),'key':_0x23a3f3(0x136),'width':0xa},{'header':_0x23a3f3(0x12f),'key':_0x23a3f3(0x13d),'width':0xa},{'header':_0x23a3f3(0x124),'key':_0x23a3f3(0x172),'width':0xa},{'header':_0x23a3f3(0x13d),'key':'email','width':0xa}],_0x16175c[_0x23a3f3(0x117)](_0x23a3f3(0x14b),_0x23a3f3(0x123)),_0x16175c[_0x23a3f3(0x117)](_0x23a3f3(0x111),_0x23a3f3(0x112)),_0x57e668[_0x23a3f3(0x14c)][_0x23a3f3(0x135)](_0x16175c)[_0x23a3f3(0x169)](()=>{const _0x2161da=_0x23a3f3;_0x16175c[_0x2161da(0x132)](0xc8);});}catch(_0x712886){_0x16175c[_0x23a3f3(0x132)](0x190)[_0x23a3f3(0x12a)]({'errors':_0x712886[_0x23a3f3(0x168)]});}});function a0_0x2248(){const _0x2c31b4=['/view/payment/:id','redirect','findOne','German','get','mobile','diskStorage','readFile','3715356PTlyiD','master','/view','body','/supplier/view','doc','originalname','aggregate','Content-Disposition','attachment;\x20filename=supplier_Migration_File.xlsx','102qhMIUu','6990KKMfcA','public/Migration','receivable','setHeader','1105040FBujKC','Workbook','purchase','success','supplier\x20data\x20add\x20successfully','email','multer','landline','Customers','Chinese','English','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Company_Name','contactperson','../models/all_models','573572GsYBKH','Purchase\x20Return','Email','send','sheet_to_json','post','Router','filename','Mobile_number','French','data','status','map','utils','write','SalesmanName','supplier\x20data\x20update\x20successfully','suppliers_docs','render','payable','$amount','\x20Failed','address','reason','user','errors','flash','Arabic\x20(ae)','2921952oavMuU','2476920fbAXVH','PUnits','supplier_product_file','Portuguese','params','Hindi','7golmiV','Content-Type','xlsx','Purchase','file','log','SheetNames','save','express','supplier','find','33129SiKEOZ','PBrands','payable_sum','name','supplier_payment','forEach','/supplier_import_migrate_file','English\x20(US)','Spanish','Arabic','Name','single','\x20added\x20successfully','findById','amount','Supplier_Code','Portuguese\x20(BR)','1089bajZaU','/view/:id','message','then','s_payments','now','language'];a0_0x2248=function(){return _0x2c31b4;};return a0_0x2248();}const storage1=multer[a0_0x1779b4(0x173)]({'destination':(_0x2aec96,_0x57113a,_0x3aa354)=>{const _0x22c84a=a0_0x1779b4;_0x3aa354(null,_0x22c84a(0x115));},'filename':(_0x207047,_0x5c0d21,_0x230f3e)=>{const _0x1ad8e9=a0_0x1779b4;_0x230f3e(null,Date[_0x1ad8e9(0x16b)]()+_0x5c0d21[_0x1ad8e9(0x10f)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x1779b4(0x12c)](a0_0x1779b4(0x15b),auth,uploadMigrate[a0_0x1779b4(0x160)](a0_0x1779b4(0x146)),async(_0x38bd7b,_0x363812)=>{const _0x3e18d3=a0_0x1779b4,_0x108186=_0x38bd7b[_0x3e18d3(0x14e)][_0x3e18d3(0x12e)],_0x19e2db=await xlsx[_0x3e18d3(0x174)]('public/Migration/'+_0x108186);let _0x203cf7=_0x19e2db[_0x3e18d3(0x150)],_0x1c4c2c=xlsx[_0x3e18d3(0x134)][_0x3e18d3(0x12b)](_0x19e2db['Sheets'][_0x203cf7[0x0]]);for(const _0x3b8f08 of _0x1c4c2c){const _0x55a0f6=_0x3b8f08[_0x3e18d3(0x15f)],_0x40401c=_0x3b8f08[_0x3e18d3(0x164)],_0x293e52=_0x3b8f08[_0x3e18d3(0x13d)],_0x252adb=_0x3b8f08[_0x3e18d3(0x12f)],_0x5f3d18=_0x3b8f08['Email'],_0x486b59=_0x3b8f08['Company_Name'];try{let _0x3a8a0c=await suppliers[_0x3e18d3(0x16f)]({'name':_0x55a0f6});if(!_0x3a8a0c){const _0x76789e=new suppliers({'name':_0x55a0f6,'suppliers_code':_0x40401c,'address':_0x293e52,'mobile':_0x252adb,'email':_0x5f3d18,'company':_0x486b59});_0x3a8a0c=await _0x76789e[_0x3e18d3(0x151)](),_0x38bd7b[_0x3e18d3(0x141)](_0x3e18d3(0x11b),_0x55a0f6+_0x3e18d3(0x161));}else _0x38bd7b[_0x3e18d3(0x141)]('error',_0x55a0f6+_0x3e18d3(0x13c));}catch(_0x5091d1){_0x363812['status'](0x1f4)['json']({'proderror':_0x5091d1[_0x3e18d3(0x168)],'aproduct':ProductName});}}_0x363812[_0x3e18d3(0x16e)](_0x3e18d3(0x10d));}),module['exports']=router;