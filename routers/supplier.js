const a0_0x399626=a0_0x4460;(function(_0x8c469b,_0x5ee00d){const _0xcafafd=a0_0x4460,_0x22b2bf=_0x8c469b();while(!![]){try{const _0x48fd37=-parseInt(_0xcafafd(0xae))/0x1+-parseInt(_0xcafafd(0x96))/0x2*(parseInt(_0xcafafd(0xa1))/0x3)+parseInt(_0xcafafd(0xb1))/0x4*(parseInt(_0xcafafd(0x99))/0x5)+parseInt(_0xcafafd(0xd1))/0x6*(-parseInt(_0xcafafd(0xd3))/0x7)+parseInt(_0xcafafd(0x68))/0x8+parseInt(_0xcafafd(0x9f))/0x9*(parseInt(_0xcafafd(0x94))/0xa)+parseInt(_0xcafafd(0xa7))/0xb;if(_0x48fd37===_0x5ee00d)break;else _0x22b2bf['push'](_0x22b2bf['shift']());}catch(_0x26ccee){_0x22b2bf['push'](_0x22b2bf['shift']());}}}(a0_0x30ef,0xf2363));function a0_0x30ef(){const _0x3ce84a=['/view','PBrands','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Router','errors','landline','multer','status','setHeader','PUnits','render','name','data','Portuguese','express','log','receivable','s_payments','/view/:id','redirect','/supplier_import_migrate_file','address','exceljs','contactperson','mobile','$reason','originalname','Content-Type','English','params','readFile','Portuguese\x20(BR)','user','French','addWorksheet','utils','20hFLDZt','../middleware/auth','2NBRAPl','map','columns','40xGfqBz','supplier','error','purchase','json','payable_sum','1406340WbBZuk','Company_Name','2417409ZwdXmb','flash','suppliers','findById','language','write','38452975tatxWM','supplier_product_file','supplier_payment','post','Customers','$amount','Chinese','1415415vWNgmy','find','now','290860ABxiiv','sheet_to_json','suppliers_docs','Arabic','public/Migration/','SheetNames','then','Hindi','forEach','German','body','master','aggregate','Purchase','/supplier/view','\x20added\x20successfully','findOne','email','Name','doc','Supplier_Code','save','Content-Disposition','../models/all_models','Arabic\x20(ae)','amount','Spanish','exports','message','SalesmanName','Mobile_number','single','1075944UnORbL','get','70krNNPv','success','4932736Latowi','/view/payment/:id','company','supplier\x20data\x20update\x20successfully','English\x20(US)','xlsx','/products_export_migrate_file','suppliers_code'];a0_0x30ef=function(){return _0x3ce84a;};return a0_0x30ef();}function a0_0x4460(_0x223e9a,_0x24f901){const _0x30efbf=a0_0x30ef();return a0_0x4460=function(_0x44608a,_0x1dc83b){_0x44608a=_0x44608a-0x67;let _0xa0501a=_0x30efbf[_0x44608a];return _0xa0501a;},a0_0x4460(_0x223e9a,_0x24f901);}const express=require(a0_0x399626(0x7e)),app=express(),router=express[a0_0x399626(0x73)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x399626(0xc8)),auth=require(a0_0x399626(0x95)),users=require('../public/language/languages.json'),excelJS=require(a0_0x399626(0x86)),xlsx=require(a0_0x399626(0x6d)),multer=require(a0_0x399626(0x76));router[a0_0x399626(0xd2)](a0_0x399626(0x70),auth,async(_0x4b98fd,_0x3dcd24)=>{const _0x2d6848=a0_0x399626;try{const {username:_0x326291,email:_0x4b0c3f,role:_0x518457}=_0x4b98fd['user'],_0x37ad8e=_0x4b98fd[_0x2d6848(0x90)],_0x19011a=await profile[_0x2d6848(0xc1)]({'email':_0x37ad8e[_0x2d6848(0xc2)]}),_0x149a84=await master_shop['find']();console[_0x2d6848(0x7f)](_0x2d6848(0xbc),_0x149a84);const _0xc29477=await suppliers[_0x2d6848(0xaf)]();console[_0x2d6848(0x7f)](_0xc29477);const _0x44c5a8=await suppliers['aggregate']([{'$lookup':{'from':_0x2d6848(0x81),'localField':_0x2d6848(0x7b),'foreignField':_0x2d6848(0xa3),'as':'suppliers_docs'}}]),_0x28c233=_0x44c5a8[_0x2d6848(0x97)](_0x4e8df3=>{const _0x33cf4a=_0x2d6848;console['log'](_0x33cf4a(0x7c),_0x4e8df3);var _0x4f56c3=0x0,_0x2569f6=0x0;return _0x4e8df3[_0x33cf4a(0xb3)][_0x33cf4a(0xb9)](_0x43f370=>{const _0x41297c=_0x33cf4a;console['log'](_0x41297c(0xc4),_0x43f370),_0x43f370['reason']==_0x41297c(0xbe)?_0x4f56c3+=_0x43f370[_0x41297c(0xca)]:_0x2569f6+=_0x43f370[_0x41297c(0xca)];}),_0x4e8df3[_0x33cf4a(0x9c)]=_0x4f56c3,_0x4e8df3['purchase_return']=_0x2569f6,_0x4e8df3;});console[_0x2d6848(0x7f)]('supplier.js\x20payment_data',_0x28c233);if(_0x149a84[0x0][_0x2d6848(0xa5)]==_0x2d6848(0x6c)){var _0x3488ad=users[_0x2d6848(0x8c)];console[_0x2d6848(0x7f)](_0x3488ad);}else{if(_0x149a84[0x0][_0x2d6848(0xa5)]=='Hindi')var _0x3488ad=users[_0x2d6848(0xb8)];else{if(_0x149a84[0x0][_0x2d6848(0xa5)]==_0x2d6848(0xba))var _0x3488ad=users[_0x2d6848(0xba)];else{if(_0x149a84[0x0]['language']==_0x2d6848(0xcb))var _0x3488ad=users[_0x2d6848(0xcb)];else{if(_0x149a84[0x0][_0x2d6848(0xa5)]==_0x2d6848(0x91))var _0x3488ad=users[_0x2d6848(0x91)];else{if(_0x149a84[0x0][_0x2d6848(0xa5)]==_0x2d6848(0x8f))var _0x3488ad=users[_0x2d6848(0x7d)];else{if(_0x149a84[0x0]['language']=='Chinese')var _0x3488ad=users[_0x2d6848(0xad)];else{if(_0x149a84[0x0][_0x2d6848(0xa5)]=='Arabic\x20(ae)')var _0x3488ad=users['Arabic'];}}}}}}}_0x3dcd24['render']('supplier',{'success':_0x4b98fd[_0x2d6848(0xa2)](_0x2d6848(0x67)),'errors':_0x4b98fd[_0x2d6848(0xa2)](_0x2d6848(0x74)),'user':_0xc29477,'profile':_0x19011a,'master_shop':_0x149a84,'role':_0x37ad8e,'payment':_0x28c233,'language':_0x3488ad});}catch(_0x571b6c){console['log'](_0x571b6c);}}),router[a0_0x399626(0xaa)]('/view',auth,async(_0x3b83f8,_0x1ad643)=>{const _0x4fc2a5=a0_0x399626;try{const {name:_0x9e99bd,email:_0x3f460d,mobile:_0x4e3acc,company:_0x2cfc30,address:_0xa7b3be,receivable:_0x3a6338,payable:_0x42b6ed,code:_0x5ad420,contactperson:_0x5e6b86,landline:_0x17c12f}=_0x3b83f8[_0x4fc2a5(0xbb)],_0x1aab88=new suppliers({'name':_0x9e99bd,'email':_0x3f460d,'mobile':_0x4e3acc,'company':_0x2cfc30,'address':_0xa7b3be,'receivable':_0x3a6338,'payable':_0x42b6ed,'suppliers_code':_0x5ad420,'contactperson':_0x5e6b86,'landline':_0x17c12f}),_0x27130b=await _0x1aab88[_0x4fc2a5(0xc6)]();_0x3b83f8[_0x4fc2a5(0xa2)](_0x4fc2a5(0x67),'supplier\x20data\x20add\x20successfully'),_0x1ad643[_0x4fc2a5(0x83)](_0x4fc2a5(0xbf));}catch(_0xff5573){console[_0x4fc2a5(0x7f)](_0xff5573);}}),router[a0_0x399626(0xd2)](a0_0x399626(0x82),auth,async(_0x40ed2b,_0x4ae37b)=>{const _0x3e1b6a=a0_0x399626;try{const {username:_0x1bff85,email:_0x1e62f3,role:_0x418da7}=_0x40ed2b[_0x3e1b6a(0x90)],_0x32011b=_0x40ed2b[_0x3e1b6a(0x90)],_0x4ff2d6=await profile['findOne']({'email':_0x32011b[_0x3e1b6a(0xc2)]}),_0xfdd18d=await master_shop[_0x3e1b6a(0xaf)]();console[_0x3e1b6a(0x7f)](_0x3e1b6a(0xbc),_0xfdd18d);const _0x23b682=_0x40ed2b[_0x3e1b6a(0x8d)]['id'],_0x443ac1=await suppliers[_0x3e1b6a(0xa4)](_0x23b682);console[_0x3e1b6a(0x7f)](_0x443ac1);if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]==_0x3e1b6a(0x6c)){var _0xde6b73=users['English'];console[_0x3e1b6a(0x7f)](_0xde6b73);}else{if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]==_0x3e1b6a(0xb8))var _0xde6b73=users[_0x3e1b6a(0xb8)];else{if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]==_0x3e1b6a(0xba))var _0xde6b73=users['German'];else{if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]==_0x3e1b6a(0xcb))var _0xde6b73=users[_0x3e1b6a(0xcb)];else{if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]=='French')var _0xde6b73=users[_0x3e1b6a(0x91)];else{if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]==_0x3e1b6a(0x8f))var _0xde6b73=users[_0x3e1b6a(0x7d)];else{if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]=='Chinese')var _0xde6b73=users[_0x3e1b6a(0xad)];else{if(_0xfdd18d[0x0][_0x3e1b6a(0xa5)]==_0x3e1b6a(0xc9))var _0xde6b73=users[_0x3e1b6a(0xb4)];}}}}}}}_0x4ae37b[_0x3e1b6a(0x7a)](_0x3e1b6a(0x9a),{'success':_0x40ed2b[_0x3e1b6a(0xa2)](_0x3e1b6a(0x67)),'errors':_0x40ed2b[_0x3e1b6a(0xa2)](_0x3e1b6a(0x74)),'role':_0x32011b,'profile':_0x4ff2d6,'master_shop':_0xfdd18d,'user':_0x443ac1,'language':_0xde6b73});}catch(_0xb6395){console[_0x3e1b6a(0x7f)](_0xb6395);}}),router[a0_0x399626(0xaa)]('/view/:id',auth,async(_0x3db089,_0x37ba94)=>{const _0x55b2eb=a0_0x399626;try{const _0x106e28=_0x3db089[_0x55b2eb(0x8d)]['id'],_0x5d8e3d=await suppliers['findById'](_0x106e28),{name:_0x2db21d,email:_0x24fe02,mobile:_0x39fedc,company:_0x171a7b,address:_0xe565de,receivable:_0x4e6720,payable:_0x25da52,code:_0x3f1d62,contactperson:_0x5aff7b,landline:_0x19c3b2}=_0x3db089[_0x55b2eb(0xbb)];_0x5d8e3d[_0x55b2eb(0x7b)]=_0x2db21d,_0x5d8e3d['email']=_0x24fe02,_0x5d8e3d[_0x55b2eb(0x88)]=_0x39fedc,_0x5d8e3d[_0x55b2eb(0x6a)]=_0x171a7b,_0x5d8e3d[_0x55b2eb(0x85)]=_0xe565de,_0x5d8e3d[_0x55b2eb(0x80)]=_0x4e6720,_0x5d8e3d['payable']=_0x25da52,_0x5d8e3d[_0x55b2eb(0x6f)]=_0x3f1d62,_0x5d8e3d[_0x55b2eb(0x87)]=_0x5aff7b,_0x5d8e3d[_0x55b2eb(0x75)]=_0x19c3b2;const _0x4750bc=await _0x5d8e3d[_0x55b2eb(0xc6)]();_0x3db089[_0x55b2eb(0xa2)](_0x55b2eb(0x67),_0x55b2eb(0x6b)),_0x37ba94[_0x55b2eb(0x83)](_0x55b2eb(0xbf));}catch(_0x2ade29){console[_0x55b2eb(0x7f)](_0x2ade29);}}),router[a0_0x399626(0xd2)](a0_0x399626(0x69),auth,async(_0x302dad,_0x6e63cf)=>{const _0x571b04=a0_0x399626;try{const {username:_0x307d2b,email:_0x48b79c,role:_0x294fdb}=_0x302dad['user'],_0x3d75fd=_0x302dad[_0x571b04(0x90)],_0x2cc878=await profile[_0x571b04(0xc1)]({'email':_0x3d75fd[_0x571b04(0xc2)]}),_0x5e2bf3=await master_shop[_0x571b04(0xaf)]();console['log'](_0x571b04(0xbc),_0x5e2bf3),console['log'](_0x302dad[_0x571b04(0x8d)]['id']);const _0x1722e8=await suppliers[_0x571b04(0xc1)]({'_id':_0x302dad[_0x571b04(0x8d)]['id']});console[_0x571b04(0x7f)](_0x1722e8);const _0x24c6bf=await s_payment_data[_0x571b04(0xaf)]({'suppliers':_0x1722e8[_0x571b04(0x7b)]});console[_0x571b04(0x7f)](_0x24c6bf);const _0x598bb2=await s_payment_data[_0x571b04(0xbd)]([{'$match':{'suppliers':_0x1722e8[_0x571b04(0x7b)]}},{'$match':{'reason':_0x571b04(0xbe)}},{'$group':{'_id':_0x571b04(0x89),'sum':{'$sum':_0x571b04(0xac)}}}]);console['log'](_0x571b04(0x9e),_0x598bb2);const _0x41fc03=await s_payment_data[_0x571b04(0xbd)]([{'$match':{'suppliers':_0x1722e8[_0x571b04(0x7b)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x571b04(0xac)}}}]);console[_0x571b04(0x7f)]('receivable_sum',_0x41fc03);if(_0x5e2bf3[0x0][_0x571b04(0xa5)]==_0x571b04(0x6c)){var _0x39bc96=users[_0x571b04(0x8c)];console[_0x571b04(0x7f)](_0x39bc96);}else{if(_0x5e2bf3[0x0][_0x571b04(0xa5)]=='Hindi')var _0x39bc96=users[_0x571b04(0xb8)];else{if(_0x5e2bf3[0x0]['language']==_0x571b04(0xba))var _0x39bc96=users[_0x571b04(0xba)];else{if(_0x5e2bf3[0x0]['language']==_0x571b04(0xcb))var _0x39bc96=users[_0x571b04(0xcb)];else{if(_0x5e2bf3[0x0]['language']==_0x571b04(0x91))var _0x39bc96=users[_0x571b04(0x91)];else{if(_0x5e2bf3[0x0][_0x571b04(0xa5)]==_0x571b04(0x8f))var _0x39bc96=users[_0x571b04(0x7d)];else{if(_0x5e2bf3[0x0][_0x571b04(0xa5)]=='Chinese')var _0x39bc96=users[_0x571b04(0xad)];else{if(_0x5e2bf3[0x0]['language']==_0x571b04(0xc9))var _0x39bc96=users[_0x571b04(0xb4)];}}}}}}}_0x6e63cf[_0x571b04(0x7a)](_0x571b04(0xa9),{'success':_0x302dad[_0x571b04(0xa2)](_0x571b04(0x67)),'errors':_0x302dad[_0x571b04(0xa2)](_0x571b04(0x74)),'role':_0x3d75fd,'profile':_0x2cc878,'master_shop':_0x5e2bf3,'payment':_0x24c6bf,'payable':_0x598bb2,'receivable':_0x41fc03,'language':_0x39bc96});}catch(_0x1333b2){console[_0x571b04(0x7f)](_0x1333b2);}}),router['get'](a0_0x399626(0x6e),auth,async(_0x45262c,_0x548435)=>{const _0x230ae9=a0_0x399626;try{const _0x5145c9=new excelJS['Workbook'](),_0x4b4ee7=_0x5145c9[_0x230ae9(0x92)](_0x230ae9(0xab));return _0x4b4ee7[_0x230ae9(0x98)]=[{'header':_0x230ae9(0xc3),'key':_0x230ae9(0x71),'width':0xa},{'header':'Supplier_Code','key':_0x230ae9(0x79),'width':0xa},{'header':'Email','key':_0x230ae9(0xce),'width':0xa},{'header':_0x230ae9(0xcf),'key':_0x230ae9(0x85),'width':0xa},{'header':_0x230ae9(0xa0),'key':_0x230ae9(0x88),'width':0xa},{'header':_0x230ae9(0x85),'key':_0x230ae9(0xc2),'width':0xa}],_0x548435[_0x230ae9(0x78)](_0x230ae9(0x8b),_0x230ae9(0x72)),_0x548435['setHeader'](_0x230ae9(0xc7),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x5145c9[_0x230ae9(0x6d)][_0x230ae9(0xa6)](_0x548435)[_0x230ae9(0xb7)](()=>{const _0x2154df=_0x230ae9;_0x548435[_0x2154df(0x77)](0xc8);});}catch(_0x47b8a0){_0x548435[_0x230ae9(0x77)](0x190)['send']({'errors':_0x47b8a0[_0x230ae9(0xcd)]});}});const storage1=multer['diskStorage']({'destination':(_0x13e1f9,_0x271ddf,_0x42164d)=>{_0x42164d(null,'public/Migration');},'filename':(_0xe2266e,_0x35bd04,_0xb3bdd4)=>{const _0x1535d7=a0_0x399626;_0xb3bdd4(null,Date[_0x1535d7(0xb0)]()+_0x35bd04[_0x1535d7(0x8a)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x399626(0xaa)](a0_0x399626(0x84),auth,uploadMigrate[a0_0x399626(0xd0)](a0_0x399626(0xa8)),async(_0x16ab5d,_0x34e7e4)=>{const _0x978f00=a0_0x399626,_0x4279e6=_0x16ab5d['file']['filename'],_0x1010e5=await xlsx[_0x978f00(0x8e)](_0x978f00(0xb5)+_0x4279e6);let _0x3a1181=_0x1010e5[_0x978f00(0xb6)],_0x21c02a=xlsx[_0x978f00(0x93)][_0x978f00(0xb2)](_0x1010e5['Sheets'][_0x3a1181[0x0]]);for(const _0x59507d of _0x21c02a){const _0x2f868e=_0x59507d[_0x978f00(0xc3)],_0x342f03=_0x59507d[_0x978f00(0xc5)],_0x3a28ed=_0x59507d[_0x978f00(0x85)],_0xed952f=_0x59507d['Mobile_number'],_0x10e9af=_0x59507d['Email'],_0x48ac8d=_0x59507d[_0x978f00(0xa0)];try{let _0x4cea81=await suppliers[_0x978f00(0xc1)]({'name':_0x2f868e});if(!_0x4cea81){const _0x175581=new suppliers({'name':_0x2f868e,'suppliers_code':_0x342f03,'address':_0x3a28ed,'mobile':_0xed952f,'email':_0x10e9af,'company':_0x48ac8d});_0x4cea81=await _0x175581[_0x978f00(0xc6)](),_0x16ab5d['flash']('success',_0x2f868e+_0x978f00(0xc0));}else _0x16ab5d[_0x978f00(0xa2)](_0x978f00(0x9b),_0x2f868e+'\x20Failed');}catch(_0x3c4916){_0x34e7e4['status'](0x1f4)[_0x978f00(0x9d)]({'proderror':_0x3c4916['message'],'aproduct':ProductName});}}_0x34e7e4['redirect'](_0x978f00(0xbf));}),module[a0_0x399626(0xcc)]=router;