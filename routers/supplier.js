const a0_0x3e7391=a0_0x88a5;function a0_0x88a5(_0x4d6467,_0x218ed3){const _0xa47b1d=a0_0xa47b();return a0_0x88a5=function(_0x88a555,_0x3c6f68){_0x88a555=_0x88a555-0xbd;let _0x61f14c=_0xa47b1d[_0x88a555];return _0x61f14c;},a0_0x88a5(_0x4d6467,_0x218ed3);}(function(_0x3c39a7,_0x56a237){const _0x684618=a0_0x88a5,_0xe4ab3c=_0x3c39a7();while(!![]){try{const _0x1a8dc2=parseInt(_0x684618(0x124))/0x1+-parseInt(_0x684618(0xdf))/0x2+-parseInt(_0x684618(0xe8))/0x3+parseInt(_0x684618(0x10e))/0x4*(-parseInt(_0x684618(0x120))/0x5)+-parseInt(_0x684618(0xd1))/0x6+parseInt(_0x684618(0xd6))/0x7+parseInt(_0x684618(0xf7))/0x8;if(_0x1a8dc2===_0x56a237)break;else _0xe4ab3c['push'](_0xe4ab3c['shift']());}catch(_0x1c980f){_0xe4ab3c['push'](_0xe4ab3c['shift']());}}}(a0_0xa47b,0x30de1));const express=require('express'),app=express(),router=express[a0_0x3e7391(0xf4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x3e7391(0x111)),auth=require(a0_0x3e7391(0x101)),users=require(a0_0x3e7391(0xf6)),excelJS=require(a0_0x3e7391(0x108)),xlsx=require(a0_0x3e7391(0xc3)),multer=require('multer');router[a0_0x3e7391(0xc9)](a0_0x3e7391(0xfd),auth,async(_0x3d3da,_0x5d26e0)=>{const _0x3093d1=a0_0x3e7391;try{const {username:_0x166b2e,email:_0x46f03d,role:_0x1bb393}=_0x3d3da[_0x3093d1(0xfa)],_0x314845=_0x3d3da[_0x3093d1(0xfa)],_0x4313ea=await profile['findOne']({'email':_0x314845[_0x3093d1(0xbd)]}),_0x3dd08a=await master_shop[_0x3093d1(0x119)]();console[_0x3093d1(0x117)](_0x3093d1(0xe6),_0x3dd08a);const _0x387b83=await suppliers[_0x3093d1(0x119)]();console[_0x3093d1(0x117)](_0x387b83);const _0x2eb957=await suppliers[_0x3093d1(0xc7)]([{'$lookup':{'from':_0x3093d1(0x10d),'localField':_0x3093d1(0x104),'foreignField':_0x3093d1(0x11d),'as':_0x3093d1(0xc0)}}]),_0x238a20=_0x2eb957[_0x3093d1(0xff)](_0x21da53=>{const _0x4b9c2b=_0x3093d1;console['log'](_0x4b9c2b(0xcb),_0x21da53);var _0x1b667b=0x0,_0x3c0d73=0x0;return _0x21da53[_0x4b9c2b(0xc0)][_0x4b9c2b(0xdd)](_0xa4014c=>{const _0x4169c2=_0x4b9c2b;console[_0x4169c2(0x117)]('doc',_0xa4014c),_0xa4014c[_0x4169c2(0xdc)]=='Purchase'?_0x1b667b+=_0xa4014c['amount']:_0x3c0d73+=_0xa4014c['amount'];}),_0x21da53[_0x4b9c2b(0xe7)]=_0x1b667b,_0x21da53[_0x4b9c2b(0xcc)]=_0x3c0d73,_0x21da53;});console[_0x3093d1(0x117)](_0x3093d1(0x10a),_0x238a20);if(_0x3dd08a[0x0]['language']==_0x3093d1(0xd8)){var _0x20ee3e=users[_0x3093d1(0x105)];console[_0x3093d1(0x117)](_0x20ee3e);}else{if(_0x3dd08a[0x0][_0x3093d1(0xc8)]==_0x3093d1(0xec))var _0x20ee3e=users[_0x3093d1(0xec)];else{if(_0x3dd08a[0x0][_0x3093d1(0xc8)]==_0x3093d1(0xf3))var _0x20ee3e=users[_0x3093d1(0xf3)];else{if(_0x3dd08a[0x0][_0x3093d1(0xc8)]==_0x3093d1(0xe5))var _0x20ee3e=users['Spanish'];else{if(_0x3dd08a[0x0][_0x3093d1(0xc8)]==_0x3093d1(0xed))var _0x20ee3e=users[_0x3093d1(0xed)];else{if(_0x3dd08a[0x0][_0x3093d1(0xc8)]==_0x3093d1(0x106))var _0x20ee3e=users[_0x3093d1(0xf2)];else{if(_0x3dd08a[0x0]['language']==_0x3093d1(0xbe))var _0x20ee3e=users[_0x3093d1(0xbe)];else{if(_0x3dd08a[0x0][_0x3093d1(0xc8)]==_0x3093d1(0xef))var _0x20ee3e=users[_0x3093d1(0xe1)];}}}}}}}_0x5d26e0[_0x3093d1(0xf5)](_0x3093d1(0x116),{'success':_0x3d3da[_0x3093d1(0x126)](_0x3093d1(0x110)),'errors':_0x3d3da['flash'](_0x3093d1(0xc1)),'user':_0x387b83,'profile':_0x4313ea,'master_shop':_0x3dd08a,'role':_0x314845,'payment':_0x238a20,'language':_0x20ee3e});}catch(_0x123878){console['log'](_0x123878);}}),router[a0_0x3e7391(0xf9)](a0_0x3e7391(0xfd),auth,async(_0x2999fb,_0x24eb9d)=>{const _0x557537=a0_0x3e7391;try{const {name:_0x25cbc7,email:_0x43f8bb,mobile:_0x30e23a,company:_0x4d57e1,address:_0x46dfb4,receivable:_0x520b15,payable:_0xb71189,code:_0x440e5d,contactperson:_0x32e513,landline:_0x4d558a}=_0x2999fb[_0x557537(0x114)],_0x1d68c3=new suppliers({'name':_0x25cbc7,'email':_0x43f8bb,'mobile':_0x30e23a,'company':_0x4d57e1,'address':_0x46dfb4,'receivable':_0x520b15,'payable':_0xb71189,'suppliers_code':_0x440e5d,'contactperson':_0x32e513,'landline':_0x4d558a}),_0x15c97e=await _0x1d68c3[_0x557537(0xd4)]();_0x2999fb[_0x557537(0x126)](_0x557537(0x110),_0x557537(0x10c)),_0x24eb9d[_0x557537(0x115)](_0x557537(0xfc));}catch(_0x4a2d39){console[_0x557537(0x117)](_0x4a2d39);}}),router[a0_0x3e7391(0xc9)]('/view/:id',auth,async(_0x223f9d,_0x3b9458)=>{const _0x43c233=a0_0x3e7391;try{const {username:_0x3a5262,email:_0x4b0f4d,role:_0x12b369}=_0x223f9d[_0x43c233(0xfa)],_0x312001=_0x223f9d[_0x43c233(0xfa)],_0x21d8dc=await profile[_0x43c233(0x11e)]({'email':_0x312001[_0x43c233(0xbd)]}),_0x38e6f7=await master_shop[_0x43c233(0x119)]();console['log'](_0x43c233(0xe6),_0x38e6f7);const _0x3530f6=_0x223f9d[_0x43c233(0x122)]['id'],_0x36eac0=await suppliers['findById'](_0x3530f6);console[_0x43c233(0x117)](_0x36eac0);if(_0x38e6f7[0x0][_0x43c233(0xc8)]=='English\x20(US)'){var _0x3f0acc=users['English'];console['log'](_0x3f0acc);}else{if(_0x38e6f7[0x0][_0x43c233(0xc8)]==_0x43c233(0xec))var _0x3f0acc=users[_0x43c233(0xec)];else{if(_0x38e6f7[0x0][_0x43c233(0xc8)]==_0x43c233(0xf3))var _0x3f0acc=users[_0x43c233(0xf3)];else{if(_0x38e6f7[0x0][_0x43c233(0xc8)]==_0x43c233(0xe5))var _0x3f0acc=users[_0x43c233(0xe5)];else{if(_0x38e6f7[0x0][_0x43c233(0xc8)]==_0x43c233(0xed))var _0x3f0acc=users[_0x43c233(0xed)];else{if(_0x38e6f7[0x0]['language']=='Portuguese\x20(BR)')var _0x3f0acc=users[_0x43c233(0xf2)];else{if(_0x38e6f7[0x0][_0x43c233(0xc8)]=='Chinese')var _0x3f0acc=users[_0x43c233(0xbe)];else{if(_0x38e6f7[0x0][_0x43c233(0xc8)]=='Arabic\x20(ae)')var _0x3f0acc=users[_0x43c233(0xe1)];}}}}}}}_0x3b9458[_0x43c233(0xf5)](_0x43c233(0x116),{'success':_0x223f9d[_0x43c233(0x126)](_0x43c233(0x110)),'errors':_0x223f9d[_0x43c233(0x126)](_0x43c233(0xc1)),'role':_0x312001,'profile':_0x21d8dc,'master_shop':_0x38e6f7,'user':_0x36eac0,'language':_0x3f0acc});}catch(_0x4f48ca){console[_0x43c233(0x117)](_0x4f48ca);}}),router[a0_0x3e7391(0xf9)]('/view/:id',auth,async(_0x2bff70,_0x3e1ee6)=>{const _0x8a41dc=a0_0x3e7391;try{const _0x519f4c=_0x2bff70[_0x8a41dc(0x122)]['id'],_0x571342=await suppliers[_0x8a41dc(0x11b)](_0x519f4c),{name:_0x1f2c1d,email:_0x374946,mobile:_0x4a4885,company:_0x145de7,address:_0xcf67b5,receivable:_0x3dd8d6,payable:_0x3be339,code:_0x1f126f,contactperson:_0x4c0a50,landline:_0x51ef01}=_0x2bff70[_0x8a41dc(0x114)];_0x571342[_0x8a41dc(0x104)]=_0x1f2c1d,_0x571342['email']=_0x374946,_0x571342['mobile']=_0x4a4885,_0x571342['company']=_0x145de7,_0x571342[_0x8a41dc(0x127)]=_0xcf67b5,_0x571342[_0x8a41dc(0xcf)]=_0x3dd8d6,_0x571342[_0x8a41dc(0xea)]=_0x3be339,_0x571342[_0x8a41dc(0x125)]=_0x1f126f,_0x571342[_0x8a41dc(0x103)]=_0x4c0a50,_0x571342['landline']=_0x51ef01;const _0x3239d1=await _0x571342[_0x8a41dc(0xd4)]();_0x2bff70[_0x8a41dc(0x126)](_0x8a41dc(0x110),'supplier\x20data\x20update\x20successfully'),_0x3e1ee6[_0x8a41dc(0x115)](_0x8a41dc(0xfc));}catch(_0x64d34b){console[_0x8a41dc(0x117)](_0x64d34b);}}),router[a0_0x3e7391(0xc9)](a0_0x3e7391(0xc5),auth,async(_0x554562,_0x28d30b)=>{const _0x51d1ce=a0_0x3e7391;try{const {username:_0x6470b4,email:_0x5d896b,role:_0x4e914a}=_0x554562[_0x51d1ce(0xfa)],_0x395b4c=_0x554562['user'],_0xdf6552=await profile[_0x51d1ce(0x11e)]({'email':_0x395b4c[_0x51d1ce(0xbd)]}),_0x36eadf=await master_shop[_0x51d1ce(0x119)]();console[_0x51d1ce(0x117)](_0x51d1ce(0xe6),_0x36eadf),console['log'](_0x554562[_0x51d1ce(0x122)]['id']);const _0x48ad10=await suppliers[_0x51d1ce(0x11e)]({'_id':_0x554562[_0x51d1ce(0x122)]['id']});console[_0x51d1ce(0x117)](_0x48ad10);const _0x2b4620=await s_payment_data[_0x51d1ce(0x119)]({'suppliers':_0x48ad10[_0x51d1ce(0x104)]});console['log'](_0x2b4620);const _0x2b8824=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x48ad10[_0x51d1ce(0x104)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x51d1ce(0xda),'sum':{'$sum':_0x51d1ce(0x123)}}}]);console[_0x51d1ce(0x117)](_0x51d1ce(0xca),_0x2b8824);const _0x2c9f1f=await s_payment_data[_0x51d1ce(0xc7)]([{'$match':{'suppliers':_0x48ad10[_0x51d1ce(0x104)]}},{'$match':{'reason':_0x51d1ce(0xfe)}},{'$group':{'_id':_0x51d1ce(0xda),'sum':{'$sum':_0x51d1ce(0x123)}}}]);console['log'](_0x51d1ce(0xd2),_0x2c9f1f);if(_0x36eadf[0x0][_0x51d1ce(0xc8)]==_0x51d1ce(0xd8)){var _0x3dbf56=users[_0x51d1ce(0x105)];console[_0x51d1ce(0x117)](_0x3dbf56);}else{if(_0x36eadf[0x0]['language']=='Hindi')var _0x3dbf56=users['Hindi'];else{if(_0x36eadf[0x0][_0x51d1ce(0xc8)]==_0x51d1ce(0xf3))var _0x3dbf56=users['German'];else{if(_0x36eadf[0x0][_0x51d1ce(0xc8)]=='Spanish')var _0x3dbf56=users[_0x51d1ce(0xe5)];else{if(_0x36eadf[0x0][_0x51d1ce(0xc8)]==_0x51d1ce(0xed))var _0x3dbf56=users['French'];else{if(_0x36eadf[0x0][_0x51d1ce(0xc8)]==_0x51d1ce(0x106))var _0x3dbf56=users['Portuguese'];else{if(_0x36eadf[0x0]['language']==_0x51d1ce(0xbe))var _0x3dbf56=users['Chinese'];else{if(_0x36eadf[0x0]['language']==_0x51d1ce(0xef))var _0x3dbf56=users[_0x51d1ce(0xe1)];}}}}}}}_0x28d30b[_0x51d1ce(0xf5)](_0x51d1ce(0x11a),{'success':_0x554562[_0x51d1ce(0x126)](_0x51d1ce(0x110)),'errors':_0x554562[_0x51d1ce(0x126)]('errors'),'role':_0x395b4c,'profile':_0xdf6552,'master_shop':_0x36eadf,'payment':_0x2b4620,'payable':_0x2b8824,'receivable':_0x2c9f1f,'language':_0x3dbf56});}catch(_0x343cfe){console[_0x51d1ce(0x117)](_0x343cfe);}}),router[a0_0x3e7391(0xc9)](a0_0x3e7391(0x10f),auth,async(_0x4b0aae,_0x3bf1f2)=>{const _0x197932=a0_0x3e7391;try{const _0x4a45b6=new excelJS[(_0x197932(0xee))](),_0x41bd4d=_0x4a45b6[_0x197932(0x118)](_0x197932(0xc6));return _0x41bd4d[_0x197932(0xc2)]=[{'header':_0x197932(0xe2),'key':_0x197932(0x128),'width':0xa},{'header':_0x197932(0xeb),'key':_0x197932(0xcd),'width':0xa},{'header':_0x197932(0x10b),'key':'SalesmanName','width':0xa},{'header':_0x197932(0x113),'key':'address','width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':_0x197932(0x127),'key':_0x197932(0xbd),'width':0xa}],_0x3bf1f2['setHeader'](_0x197932(0xd9),_0x197932(0x11c)),_0x3bf1f2['setHeader'](_0x197932(0x109),_0x197932(0x100)),_0x4a45b6['xlsx'][_0x197932(0xdb)](_0x3bf1f2)[_0x197932(0x107)](()=>{const _0x34ac1d=_0x197932;_0x3bf1f2[_0x34ac1d(0xbf)](0xc8);});}catch(_0x598aff){_0x3bf1f2[_0x197932(0xbf)](0x190)[_0x197932(0xe9)]({'errors':_0x598aff[_0x197932(0xf0)]});}});const storage1=multer[a0_0x3e7391(0x121)]({'destination':(_0x2a249c,_0x335d12,_0x53218b)=>{const _0x5cd9d5=a0_0x3e7391;_0x53218b(null,_0x5cd9d5(0xe0));},'filename':(_0x228623,_0x3ef359,_0x309ad2)=>{const _0x258419=a0_0x3e7391;_0x309ad2(null,Date['now']()+_0x3ef359[_0x258419(0xfb)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0xa47b(){const _0x3f9888=['master','purchase','474924pCmnGZ','send','payable','Supplier_Code','Hindi','French','Workbook','Arabic\x20(ae)','message','json','Portuguese','German','Router','render','../public/language/languages.json','6204528aacspu','exports','post','user','originalname','/supplier/view','/view','Purchase\x20Return','map','attachment;\x20filename=supplier_Migration_File.xlsx','../middleware/auth','readFile','contactperson','name','English','Portuguese\x20(BR)','then','exceljs','Content-Disposition','supplier.js\x20payment_data','Email','supplier\x20data\x20add\x20successfully','s_payments','464uRzrko','/products_export_migrate_file','success','../models/all_models','supplier_product_file','Mobile_number','body','redirect','supplier','log','addWorksheet','find','supplier_payment','findById','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','suppliers','findOne','file','5655QYNqjA','diskStorage','params','$amount','355229xIiicB','suppliers_code','flash','address','PBrands','email','Chinese','status','suppliers_docs','errors','columns','xlsx','sheet_to_json','/view/payment/:id','Customers','aggregate','language','get','payable_sum','data','purchase_return','PUnits','\x20Failed','receivable','/supplier_import_migrate_file','2197140ipoYEI','receivable_sum','error','save','SheetNames','496125bjSImx','utils','English\x20(US)','Content-Type','$reason','write','reason','forEach','\x20added\x20successfully','691630ftecvy','public/Migration','Arabic','Name','single','filename','Spanish'];a0_0xa47b=function(){return _0x3f9888;};return a0_0xa47b();}router[a0_0x3e7391(0xf9)](a0_0x3e7391(0xd0),auth,uploadMigrate[a0_0x3e7391(0xe3)](a0_0x3e7391(0x112)),async(_0x2f0576,_0x4f0749)=>{const _0x55e5b6=a0_0x3e7391,_0x481ecd=_0x2f0576[_0x55e5b6(0x11f)][_0x55e5b6(0xe4)],_0xb214ac=await xlsx[_0x55e5b6(0x102)]('public/Migration/'+_0x481ecd);let _0x50ebdf=_0xb214ac[_0x55e5b6(0xd5)],_0x1164ca=xlsx[_0x55e5b6(0xd7)][_0x55e5b6(0xc4)](_0xb214ac['Sheets'][_0x50ebdf[0x0]]);for(const _0x15492a of _0x1164ca){const _0x24a7fa=_0x15492a[_0x55e5b6(0xe2)],_0x4d0e6c=_0x15492a[_0x55e5b6(0xeb)],_0x258e0e=_0x15492a[_0x55e5b6(0x127)],_0x4069bf=_0x15492a[_0x55e5b6(0x113)],_0x36534b=_0x15492a[_0x55e5b6(0x10b)],_0x32de99=_0x15492a['Company_Name'];try{let _0x384964=await suppliers['findOne']({'name':_0x24a7fa});if(!_0x384964){const _0x15fcbf=new suppliers({'name':_0x24a7fa,'suppliers_code':_0x4d0e6c,'address':_0x258e0e,'mobile':_0x4069bf,'email':_0x36534b,'company':_0x32de99});_0x384964=await _0x15fcbf[_0x55e5b6(0xd4)](),_0x2f0576[_0x55e5b6(0x126)](_0x55e5b6(0x110),_0x24a7fa+_0x55e5b6(0xde));}else _0x2f0576['flash'](_0x55e5b6(0xd3),_0x24a7fa+_0x55e5b6(0xce));}catch(_0x3a05de){_0x4f0749[_0x55e5b6(0xbf)](0x1f4)[_0x55e5b6(0xf1)]({'proderror':_0x3a05de[_0x55e5b6(0xf0)],'aproduct':ProductName});}}_0x4f0749[_0x55e5b6(0x115)](_0x55e5b6(0xfc));}),module[a0_0x3e7391(0xf8)]=router;