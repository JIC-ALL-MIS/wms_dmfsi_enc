const a0_0xe0359b=a0_0x5948;(function(_0x5d658f,_0x3d4923){const _0x364461=a0_0x5948,_0x2944eb=_0x5d658f();while(!![]){try{const _0xef0adb=parseInt(_0x364461(0x1e8))/0x1*(parseInt(_0x364461(0x24a))/0x2)+parseInt(_0x364461(0x252))/0x3*(parseInt(_0x364461(0x204))/0x4)+parseInt(_0x364461(0x1ed))/0x5*(parseInt(_0x364461(0x23c))/0x6)+-parseInt(_0x364461(0x201))/0x7*(-parseInt(_0x364461(0x1f8))/0x8)+parseInt(_0x364461(0x21d))/0x9+parseInt(_0x364461(0x219))/0xa*(parseInt(_0x364461(0x247))/0xb)+-parseInt(_0x364461(0x220))/0xc;if(_0xef0adb===_0x3d4923)break;else _0x2944eb['push'](_0x2944eb['shift']());}catch(_0x2e7476){_0x2944eb['push'](_0x2944eb['shift']());}}}(a0_0x4561,0xaa510));function a0_0x5948(_0x25aee6,_0x4d8750){const _0x456142=a0_0x4561();return a0_0x5948=function(_0x594813,_0x5c4dce){_0x594813=_0x594813-0x1e3;let _0x19b105=_0x456142[_0x594813];return _0x19b105;},a0_0x5948(_0x25aee6,_0x4d8750);}const express=require(a0_0xe0359b(0x1e6)),app=express(),router=express[a0_0xe0359b(0x217)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0xe0359b(0x1fc)),auth=require(a0_0xe0359b(0x21f)),users=require(a0_0xe0359b(0x1ef)),excelJS=require('exceljs'),xlsx=require(a0_0xe0359b(0x1fd)),multer=require('multer');router[a0_0xe0359b(0x20d)](a0_0xe0359b(0x207),auth,async(_0x339ce9,_0x1cd1bc)=>{const _0x7a5242=a0_0xe0359b;try{const {username:_0x144277,email:_0x5cb51f,role:_0x2e893f}=_0x339ce9[_0x7a5242(0x218)],_0x127ff3=_0x339ce9[_0x7a5242(0x218)],_0x17bffb=await profile[_0x7a5242(0x20e)]({'email':_0x127ff3[_0x7a5242(0x1f9)]}),_0x29bbb7=await master_shop[_0x7a5242(0x23d)]();console[_0x7a5242(0x1f4)](_0x7a5242(0x1e7),_0x29bbb7);const _0x2e4afc=await suppliers[_0x7a5242(0x23d)]();console[_0x7a5242(0x1f4)](_0x2e4afc);const _0x1a559a=await suppliers[_0x7a5242(0x209)]([{'$lookup':{'from':'s_payments','localField':_0x7a5242(0x22d),'foreignField':_0x7a5242(0x23b),'as':'suppliers_docs'}}]),_0x40086c=_0x1a559a['map'](_0x3cb77e=>{const _0x21d01a=_0x7a5242;console[_0x21d01a(0x1f4)](_0x21d01a(0x232),_0x3cb77e);var _0x55615f=0x0,_0x3c9e83=0x0;return _0x3cb77e['suppliers_docs'][_0x21d01a(0x230)](_0x51552c=>{const _0xae165d=_0x21d01a;console[_0xae165d(0x1f4)](_0xae165d(0x246),_0x51552c),_0x51552c[_0xae165d(0x222)]==_0xae165d(0x1f5)?_0x55615f+=_0x51552c[_0xae165d(0x244)]:_0x3c9e83+=_0x51552c[_0xae165d(0x244)];}),_0x3cb77e[_0x21d01a(0x202)]=_0x55615f,_0x3cb77e[_0x21d01a(0x21b)]=_0x3c9e83,_0x3cb77e;});console[_0x7a5242(0x1f4)](_0x7a5242(0x21a),_0x40086c);if(_0x29bbb7[0x0][_0x7a5242(0x22f)]=='English\x20(US)'){var _0x2ebad7=users[_0x7a5242(0x226)];console[_0x7a5242(0x1f4)](_0x2ebad7);}else{if(_0x29bbb7[0x0]['language']==_0x7a5242(0x1f1))var _0x2ebad7=users[_0x7a5242(0x1f1)];else{if(_0x29bbb7[0x0][_0x7a5242(0x22f)]==_0x7a5242(0x22b))var _0x2ebad7=users[_0x7a5242(0x22b)];else{if(_0x29bbb7[0x0][_0x7a5242(0x22f)]==_0x7a5242(0x206))var _0x2ebad7=users[_0x7a5242(0x206)];else{if(_0x29bbb7[0x0][_0x7a5242(0x22f)]==_0x7a5242(0x208))var _0x2ebad7=users[_0x7a5242(0x208)];else{if(_0x29bbb7[0x0][_0x7a5242(0x22f)]==_0x7a5242(0x23e))var _0x2ebad7=users['Portuguese'];else{if(_0x29bbb7[0x0]['language']==_0x7a5242(0x248))var _0x2ebad7=users[_0x7a5242(0x248)];else{if(_0x29bbb7[0x0][_0x7a5242(0x22f)]=='Arabic\x20(ae)')var _0x2ebad7=users[_0x7a5242(0x245)];}}}}}}}_0x1cd1bc['render']('supplier',{'success':_0x339ce9[_0x7a5242(0x211)](_0x7a5242(0x20b)),'errors':_0x339ce9[_0x7a5242(0x211)](_0x7a5242(0x249)),'user':_0x2e4afc,'profile':_0x17bffb,'master_shop':_0x29bbb7,'role':_0x127ff3,'payment':_0x40086c,'language':_0x2ebad7});}catch(_0x2c4d09){console['log'](_0x2c4d09);}}),router[a0_0xe0359b(0x237)](a0_0xe0359b(0x207),auth,async(_0x52d27e,_0x412728)=>{const _0x365ace=a0_0xe0359b;try{const {name:_0x4f166c,email:_0x11b4cc,mobile:_0x17e414,company:_0x1ce026,address:_0x425ede,receivable:_0x39df85,payable:_0x5dad6c,code:_0x4e3eab,contactperson:_0x3d91c3,landline:_0x19d543}=_0x52d27e[_0x365ace(0x1e4)],_0x21e515=new suppliers({'name':_0x4f166c,'email':_0x11b4cc,'mobile':_0x17e414,'company':_0x1ce026,'address':_0x425ede,'receivable':_0x39df85,'payable':_0x5dad6c,'suppliers_code':_0x4e3eab,'contactperson':_0x3d91c3,'landline':_0x19d543}),_0x2791ab=await _0x21e515['save']();_0x52d27e[_0x365ace(0x211)](_0x365ace(0x20b),'supplier\x20data\x20add\x20successfully'),_0x412728[_0x365ace(0x231)](_0x365ace(0x24e));}catch(_0x5b1999){console[_0x365ace(0x1f4)](_0x5b1999);}}),router[a0_0xe0359b(0x20d)](a0_0xe0359b(0x229),auth,async(_0xaca3ee,_0x244764)=>{const _0x1af4b0=a0_0xe0359b;try{const {username:_0x874fb0,email:_0x1cae83,role:_0x5e40c9}=_0xaca3ee[_0x1af4b0(0x218)],_0x3b81dd=_0xaca3ee[_0x1af4b0(0x218)],_0x1625e4=await profile[_0x1af4b0(0x20e)]({'email':_0x3b81dd['email']}),_0x3e1636=await master_shop[_0x1af4b0(0x23d)]();console[_0x1af4b0(0x1f4)](_0x1af4b0(0x1e7),_0x3e1636);const _0x189946=_0xaca3ee[_0x1af4b0(0x251)]['id'],_0xec6b5e=await suppliers['findById'](_0x189946);console[_0x1af4b0(0x1f4)](_0xec6b5e);if(_0x3e1636[0x0][_0x1af4b0(0x22f)]=='English\x20(US)'){var _0x50963a=users[_0x1af4b0(0x226)];console[_0x1af4b0(0x1f4)](_0x50963a);}else{if(_0x3e1636[0x0]['language']==_0x1af4b0(0x1f1))var _0x50963a=users['Hindi'];else{if(_0x3e1636[0x0][_0x1af4b0(0x22f)]=='German')var _0x50963a=users['German'];else{if(_0x3e1636[0x0][_0x1af4b0(0x22f)]=='Spanish')var _0x50963a=users['Spanish'];else{if(_0x3e1636[0x0][_0x1af4b0(0x22f)]==_0x1af4b0(0x208))var _0x50963a=users[_0x1af4b0(0x208)];else{if(_0x3e1636[0x0][_0x1af4b0(0x22f)]==_0x1af4b0(0x23e))var _0x50963a=users[_0x1af4b0(0x20c)];else{if(_0x3e1636[0x0][_0x1af4b0(0x22f)]==_0x1af4b0(0x248))var _0x50963a=users[_0x1af4b0(0x248)];else{if(_0x3e1636[0x0][_0x1af4b0(0x22f)]=='Arabic\x20(ae)')var _0x50963a=users[_0x1af4b0(0x245)];}}}}}}}_0x244764[_0x1af4b0(0x238)](_0x1af4b0(0x1ec),{'success':_0xaca3ee[_0x1af4b0(0x211)]('success'),'errors':_0xaca3ee[_0x1af4b0(0x211)](_0x1af4b0(0x249)),'role':_0x3b81dd,'profile':_0x1625e4,'master_shop':_0x3e1636,'user':_0xec6b5e,'language':_0x50963a});}catch(_0x793af4){console['log'](_0x793af4);}}),router[a0_0xe0359b(0x237)](a0_0xe0359b(0x229),auth,async(_0x31abce,_0x269f8d)=>{const _0x21e565=a0_0xe0359b;try{const _0x5cbf31=_0x31abce['params']['id'],_0x1b78a9=await suppliers['findById'](_0x5cbf31),{name:_0x5663b9,email:_0xa7caf1,mobile:_0x58ae4e,company:_0x59eeba,address:_0x5ee222,receivable:_0x138657,payable:_0x362c61,code:_0x4bf330,contactperson:_0x4941ac,landline:_0x3faa47}=_0x31abce[_0x21e565(0x1e4)];_0x1b78a9[_0x21e565(0x22d)]=_0x5663b9,_0x1b78a9[_0x21e565(0x1f9)]=_0xa7caf1,_0x1b78a9[_0x21e565(0x233)]=_0x58ae4e,_0x1b78a9[_0x21e565(0x239)]=_0x59eeba,_0x1b78a9[_0x21e565(0x1e5)]=_0x5ee222,_0x1b78a9[_0x21e565(0x235)]=_0x138657,_0x1b78a9[_0x21e565(0x20f)]=_0x362c61,_0x1b78a9[_0x21e565(0x22e)]=_0x4bf330,_0x1b78a9['contactperson']=_0x4941ac,_0x1b78a9[_0x21e565(0x215)]=_0x3faa47;const _0x4a6484=await _0x1b78a9[_0x21e565(0x22a)]();_0x31abce['flash'](_0x21e565(0x20b),_0x21e565(0x205)),_0x269f8d['redirect'](_0x21e565(0x24e));}catch(_0x1f8ee9){console['log'](_0x1f8ee9);}}),router[a0_0xe0359b(0x20d)](a0_0xe0359b(0x203),auth,async(_0x1a1e49,_0x15a90d)=>{const _0x3074c7=a0_0xe0359b;try{const {username:_0x4b9bff,email:_0x3df65c,role:_0x47f4d4}=_0x1a1e49[_0x3074c7(0x218)],_0x305a17=_0x1a1e49['user'],_0x3b0ea1=await profile['findOne']({'email':_0x305a17['email']}),_0xc1ac87=await master_shop[_0x3074c7(0x23d)]();console[_0x3074c7(0x1f4)](_0x3074c7(0x1e7),_0xc1ac87),console[_0x3074c7(0x1f4)](_0x1a1e49[_0x3074c7(0x251)]['id']);const _0x2be064=await suppliers[_0x3074c7(0x20e)]({'_id':_0x1a1e49[_0x3074c7(0x251)]['id']});console[_0x3074c7(0x1f4)](_0x2be064);const _0x5ac8e7=await s_payment_data['find']({'suppliers':_0x2be064[_0x3074c7(0x22d)]});console[_0x3074c7(0x1f4)](_0x5ac8e7);const _0x4bcefc=await s_payment_data[_0x3074c7(0x209)]([{'$match':{'suppliers':_0x2be064[_0x3074c7(0x22d)]}},{'$match':{'reason':_0x3074c7(0x1f5)}},{'$group':{'_id':_0x3074c7(0x240),'sum':{'$sum':'$amount'}}}]);console['log'](_0x3074c7(0x1ea),_0x4bcefc);const _0x1c0a40=await s_payment_data[_0x3074c7(0x209)]([{'$match':{'suppliers':_0x2be064['name']}},{'$match':{'reason':_0x3074c7(0x1fe)}},{'$group':{'_id':_0x3074c7(0x240),'sum':{'$sum':_0x3074c7(0x227)}}}]);console['log'](_0x3074c7(0x24d),_0x1c0a40);if(_0xc1ac87[0x0]['language']==_0x3074c7(0x1f2)){var _0x5c67d4=users['English'];console['log'](_0x5c67d4);}else{if(_0xc1ac87[0x0][_0x3074c7(0x22f)]=='Hindi')var _0x5c67d4=users[_0x3074c7(0x1f1)];else{if(_0xc1ac87[0x0][_0x3074c7(0x22f)]==_0x3074c7(0x22b))var _0x5c67d4=users['German'];else{if(_0xc1ac87[0x0][_0x3074c7(0x22f)]==_0x3074c7(0x206))var _0x5c67d4=users[_0x3074c7(0x206)];else{if(_0xc1ac87[0x0]['language']==_0x3074c7(0x208))var _0x5c67d4=users[_0x3074c7(0x208)];else{if(_0xc1ac87[0x0][_0x3074c7(0x22f)]=='Portuguese\x20(BR)')var _0x5c67d4=users[_0x3074c7(0x20c)];else{if(_0xc1ac87[0x0][_0x3074c7(0x22f)]==_0x3074c7(0x248))var _0x5c67d4=users[_0x3074c7(0x248)];else{if(_0xc1ac87[0x0][_0x3074c7(0x22f)]==_0x3074c7(0x1e3))var _0x5c67d4=users['Arabic'];}}}}}}}_0x15a90d[_0x3074c7(0x238)]('supplier_payment',{'success':_0x1a1e49[_0x3074c7(0x211)](_0x3074c7(0x20b)),'errors':_0x1a1e49[_0x3074c7(0x211)](_0x3074c7(0x249)),'role':_0x305a17,'profile':_0x3b0ea1,'master_shop':_0xc1ac87,'payment':_0x5ac8e7,'payable':_0x4bcefc,'receivable':_0x1c0a40,'language':_0x5c67d4});}catch(_0x54d7af){console[_0x3074c7(0x1f4)](_0x54d7af);}}),router[a0_0xe0359b(0x20d)](a0_0xe0359b(0x1e9),auth,async(_0x4a32d8,_0x457990)=>{const _0x22d288=a0_0xe0359b;try{const _0x3369a8=new excelJS[(_0x22d288(0x236))](),_0x2209eb=_0x3369a8[_0x22d288(0x216)](_0x22d288(0x234));return _0x2209eb[_0x22d288(0x1ff)]=[{'header':'Name','key':'PBrands','width':0xa},{'header':_0x22d288(0x241),'key':'PUnits','width':0xa},{'header':_0x22d288(0x1fb),'key':_0x22d288(0x210),'width':0xa},{'header':_0x22d288(0x24f),'key':_0x22d288(0x1e5),'width':0xa},{'header':_0x22d288(0x212),'key':_0x22d288(0x233),'width':0xa},{'header':_0x22d288(0x1e5),'key':_0x22d288(0x1f9),'width':0xa}],_0x457990[_0x22d288(0x1f3)](_0x22d288(0x23a),_0x22d288(0x224)),_0x457990[_0x22d288(0x1f3)]('Content-Disposition',_0x22d288(0x1f7)),_0x3369a8[_0x22d288(0x1fd)]['write'](_0x457990)[_0x22d288(0x250)](()=>{const _0x2c62f1=_0x22d288;_0x457990[_0x2c62f1(0x242)](0xc8);});}catch(_0x58b575){_0x457990['status'](0x190)[_0x22d288(0x22c)]({'errors':_0x58b575[_0x22d288(0x1ee)]});}});const storage1=multer[a0_0xe0359b(0x1eb)]({'destination':(_0x41b9a3,_0x34a6ff,_0x1eb7af)=>{const _0x31e458=a0_0xe0359b;_0x1eb7af(null,_0x31e458(0x223));},'filename':(_0x3150ae,_0x634611,_0x6f023a)=>{const _0x640135=a0_0xe0359b;_0x6f023a(null,Date[_0x640135(0x214)]()+_0x634611[_0x640135(0x1fa)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x4561(){const _0x13c1f8=['../middleware/auth','53704872OZUBjj','readFile','reason','public/Migration','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','\x20Failed','English','$amount','utils','/view/:id','save','German','send','name','suppliers_code','language','forEach','redirect','data','mobile','Customers','receivable','Workbook','post','render','company','Content-Type','suppliers','1188qnTZfo','find','Portuguese\x20(BR)','filename','$reason','Supplier_Code','status','Sheets','amount','Arabic','doc','1859726aOtEvi','Chinese','errors','96092eNQZxC','sheet_to_json','\x20added\x20successfully','receivable_sum','/supplier/view','Mobile_number','then','params','3794097INSQzp','Arabic\x20(ae)','body','address','express','master','24IyVVNP','/products_export_migrate_file','payable_sum','diskStorage','supplier','5170nvRcHO','message','../public/language/languages.json','json','Hindi','English\x20(US)','setHeader','log','Purchase','supplier_product_file','attachment;\x20filename=supplier_Migration_File.xlsx','112gizzxT','email','originalname','Email','../models/all_models','xlsx','Purchase\x20Return','columns','single','220619zDeFQp','purchase','/view/payment/:id','4vYAFEq','supplier\x20data\x20update\x20successfully','Spanish','/view','French','aggregate','error','success','Portuguese','get','findOne','payable','SalesmanName','flash','Company_Name','exports','now','landline','addWorksheet','Router','user','60KLZjsV','supplier.js\x20payment_data','purchase_return','public/Migration/','9853677kZPWMV','SheetNames'];a0_0x4561=function(){return _0x13c1f8;};return a0_0x4561();}router[a0_0xe0359b(0x237)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0xe0359b(0x200)](a0_0xe0359b(0x1f6)),async(_0x32b062,_0x388e7c)=>{const _0x562f39=a0_0xe0359b,_0x321367=_0x32b062['file'][_0x562f39(0x23f)],_0x1aeb4f=await xlsx[_0x562f39(0x221)](_0x562f39(0x21c)+_0x321367);let _0x4aeb31=_0x1aeb4f[_0x562f39(0x21e)],_0x43a12c=xlsx[_0x562f39(0x228)][_0x562f39(0x24b)](_0x1aeb4f[_0x562f39(0x243)][_0x4aeb31[0x0]]);for(const _0x481de2 of _0x43a12c){const _0x288a21=_0x481de2['Name'],_0x109019=_0x481de2['Supplier_Code'],_0x728a56=_0x481de2[_0x562f39(0x1e5)],_0x8f28b=_0x481de2['Mobile_number'],_0x44333a=_0x481de2[_0x562f39(0x1fb)],_0x1e06d0=_0x481de2[_0x562f39(0x212)];try{let _0x9cc111=await suppliers[_0x562f39(0x20e)]({'name':_0x288a21});if(!_0x9cc111){const _0x3ab710=new suppliers({'name':_0x288a21,'suppliers_code':_0x109019,'address':_0x728a56,'mobile':_0x8f28b,'email':_0x44333a,'company':_0x1e06d0});_0x9cc111=await _0x3ab710[_0x562f39(0x22a)](),_0x32b062[_0x562f39(0x211)](_0x562f39(0x20b),_0x288a21+_0x562f39(0x24c));}else _0x32b062[_0x562f39(0x211)](_0x562f39(0x20a),_0x288a21+_0x562f39(0x225));}catch(_0x368d93){_0x388e7c[_0x562f39(0x242)](0x1f4)[_0x562f39(0x1f0)]({'proderror':_0x368d93['message'],'aproduct':ProductName});}}_0x388e7c[_0x562f39(0x231)](_0x562f39(0x24e));}),module[a0_0xe0359b(0x213)]=router;