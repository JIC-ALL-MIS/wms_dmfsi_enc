function a0_0x3798(_0xe239b8,_0x3b1caf){const _0x559253=a0_0x5592();return a0_0x3798=function(_0x379800,_0x2fbb80){_0x379800=_0x379800-0x1c8;let _0x202129=_0x559253[_0x379800];return _0x202129;},a0_0x3798(_0xe239b8,_0x3b1caf);}const a0_0x33d635=a0_0x3798;(function(_0x3a925f,_0x1637af){const _0x3fd2b6=a0_0x3798,_0x5966ed=_0x3a925f();while(!![]){try{const _0xb6bb09=parseInt(_0x3fd2b6(0x1d7))/0x1+parseInt(_0x3fd2b6(0x220))/0x2+parseInt(_0x3fd2b6(0x233))/0x3*(-parseInt(_0x3fd2b6(0x227))/0x4)+-parseInt(_0x3fd2b6(0x21a))/0x5*(-parseInt(_0x3fd2b6(0x1e2))/0x6)+parseInt(_0x3fd2b6(0x1fd))/0x7+parseInt(_0x3fd2b6(0x20d))/0x8*(parseInt(_0x3fd2b6(0x1e4))/0x9)+-parseInt(_0x3fd2b6(0x22e))/0xa;if(_0xb6bb09===_0x1637af)break;else _0x5966ed['push'](_0x5966ed['shift']());}catch(_0x47f7e5){_0x5966ed['push'](_0x5966ed['shift']());}}}(a0_0x5592,0xda333));function a0_0x5592(){const _0x355469=['/supplier_import_migrate_file','\x20added\x20successfully','26434400PETwxW','log','Workbook','name','language','4736499EwoFHb','xlsx','Sheets','mobile','addWorksheet','columns','render','multer','/supplier/view','redirect','Hindi','English\x20(US)','Content-Disposition','payable_sum','originalname','Arabic\x20(ae)','receivable_sum','SalesmanName','email','doc','now','sheet_to_json','499344EiJgSC','supplier_product_file','contactperson','German','$reason','message','s_payments','suppliers','body','data','../middleware/auth','6HVJdEU','Arabic','99zAMvWC','filename','params','Name','exceljs','aggregate','French','Spanish','single','Company_Name','$amount','English','supplier\x20data\x20add\x20successfully','success','purchase_return','setHeader','reason','company','save','../models/all_models','get','purchase','status','Supplier_Code','Purchase','8416583XDimYG','findOne','suppliers_docs','PUnits','Mobile_number','public/Migration/','findById','../public/language/languages.json','readFile','master','/view','amount','utils','/view/:id','payable','express','257096ozumIL','suppliers_code','SheetNames','/products_export_migrate_file','json','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','file','Content-Type','find','supplier','map','diskStorage','PBrands','7690245IBZlSK','landline','address','then','send','flash','3045502tBOUQL','Email','receivable','write','Chinese','errors','Customers','4bXYnhn','Portuguese\x20(BR)','Portuguese','user','Purchase\x20Return'];a0_0x5592=function(){return _0x355469;};return a0_0x5592();}const express=require(a0_0x33d635(0x20c)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x33d635(0x1f7)),auth=require(a0_0x33d635(0x1e1)),users=require(a0_0x33d635(0x204)),excelJS=require(a0_0x33d635(0x1e8)),xlsx=require(a0_0x33d635(0x234)),multer=require(a0_0x33d635(0x1c8));router['get'](a0_0x33d635(0x207),auth,async(_0x9784e5,_0x4dbe69)=>{const _0x3c4f1a=a0_0x33d635;try{const {username:_0x21400b,email:_0x11f014,role:_0x5121bc}=_0x9784e5[_0x3c4f1a(0x22a)],_0x4c5fa6=_0x9784e5[_0x3c4f1a(0x22a)],_0x3810d4=await profile['findOne']({'email':_0x4c5fa6['email']}),_0x342bdc=await master_shop[_0x3c4f1a(0x215)]();console[_0x3c4f1a(0x22f)](_0x3c4f1a(0x206),_0x342bdc);const _0x4736ae=await suppliers[_0x3c4f1a(0x215)]();console[_0x3c4f1a(0x22f)](_0x4736ae);const _0x2d602c=await suppliers['aggregate']([{'$lookup':{'from':_0x3c4f1a(0x1dd),'localField':_0x3c4f1a(0x231),'foreignField':_0x3c4f1a(0x1de),'as':_0x3c4f1a(0x1ff)}}]),_0x11a1d8=_0x2d602c[_0x3c4f1a(0x217)](_0x38a177=>{const _0x192b06=_0x3c4f1a;console[_0x192b06(0x22f)](_0x192b06(0x1e0),_0x38a177);var _0x51217f=0x0,_0xc9d097=0x0;return _0x38a177['suppliers_docs']['forEach'](_0x195863=>{const _0x2da919=_0x192b06;console['log'](_0x2da919(0x1d4),_0x195863),_0x195863[_0x2da919(0x1f4)]==_0x2da919(0x1fc)?_0x51217f+=_0x195863['amount']:_0xc9d097+=_0x195863[_0x2da919(0x208)];}),_0x38a177[_0x192b06(0x1f9)]=_0x51217f,_0x38a177[_0x192b06(0x1f2)]=_0xc9d097,_0x38a177;});console[_0x3c4f1a(0x22f)]('supplier.js\x20payment_data',_0x11a1d8);if(_0x342bdc[0x0][_0x3c4f1a(0x232)]=='English\x20(US)'){var _0x5a986a=users[_0x3c4f1a(0x1ef)];console[_0x3c4f1a(0x22f)](_0x5a986a);}else{if(_0x342bdc[0x0]['language']==_0x3c4f1a(0x1cb))var _0x5a986a=users[_0x3c4f1a(0x1cb)];else{if(_0x342bdc[0x0]['language']==_0x3c4f1a(0x1da))var _0x5a986a=users[_0x3c4f1a(0x1da)];else{if(_0x342bdc[0x0]['language']=='Spanish')var _0x5a986a=users['Spanish'];else{if(_0x342bdc[0x0]['language']==_0x3c4f1a(0x1ea))var _0x5a986a=users['French'];else{if(_0x342bdc[0x0][_0x3c4f1a(0x232)]==_0x3c4f1a(0x228))var _0x5a986a=users[_0x3c4f1a(0x229)];else{if(_0x342bdc[0x0][_0x3c4f1a(0x232)]==_0x3c4f1a(0x224))var _0x5a986a=users[_0x3c4f1a(0x224)];else{if(_0x342bdc[0x0][_0x3c4f1a(0x232)]=='Arabic\x20(ae)')var _0x5a986a=users[_0x3c4f1a(0x1e3)];}}}}}}}_0x4dbe69[_0x3c4f1a(0x239)](_0x3c4f1a(0x216),{'success':_0x9784e5[_0x3c4f1a(0x21f)](_0x3c4f1a(0x1f1)),'errors':_0x9784e5[_0x3c4f1a(0x21f)](_0x3c4f1a(0x225)),'user':_0x4736ae,'profile':_0x3810d4,'master_shop':_0x342bdc,'role':_0x4c5fa6,'payment':_0x11a1d8,'language':_0x5a986a});}catch(_0x2c9284){console[_0x3c4f1a(0x22f)](_0x2c9284);}}),router['post'](a0_0x33d635(0x207),auth,async(_0x475ad3,_0x26d6cd)=>{const _0x4b0f59=a0_0x33d635;try{const {name:_0x30c863,email:_0x42f6cf,mobile:_0xa97c66,company:_0x309c89,address:_0x37b2b4,receivable:_0x39a5e3,payable:_0x40bfe2,code:_0x16fd65,contactperson:_0x35ad90,landline:_0x148955}=_0x475ad3['body'],_0x1a3279=new suppliers({'name':_0x30c863,'email':_0x42f6cf,'mobile':_0xa97c66,'company':_0x309c89,'address':_0x37b2b4,'receivable':_0x39a5e3,'payable':_0x40bfe2,'suppliers_code':_0x16fd65,'contactperson':_0x35ad90,'landline':_0x148955}),_0x5b3fe7=await _0x1a3279['save']();_0x475ad3['flash'](_0x4b0f59(0x1f1),_0x4b0f59(0x1f0)),_0x26d6cd[_0x4b0f59(0x1ca)]('/supplier/view');}catch(_0x2a4cd4){console[_0x4b0f59(0x22f)](_0x2a4cd4);}}),router[a0_0x33d635(0x1f8)](a0_0x33d635(0x20a),auth,async(_0x53f66a,_0x149906)=>{const _0x32d2e7=a0_0x33d635;try{const {username:_0x333711,email:_0x325cec,role:_0x2e075d}=_0x53f66a[_0x32d2e7(0x22a)],_0xdcb898=_0x53f66a[_0x32d2e7(0x22a)],_0x55cafa=await profile[_0x32d2e7(0x1fe)]({'email':_0xdcb898['email']}),_0xa4169c=await master_shop['find']();console['log'](_0x32d2e7(0x206),_0xa4169c);const _0x31dc23=_0x53f66a[_0x32d2e7(0x1e6)]['id'],_0x26341b=await suppliers[_0x32d2e7(0x203)](_0x31dc23);console['log'](_0x26341b);if(_0xa4169c[0x0][_0x32d2e7(0x232)]==_0x32d2e7(0x1cc)){var _0x2c36fa=users[_0x32d2e7(0x1ef)];console['log'](_0x2c36fa);}else{if(_0xa4169c[0x0][_0x32d2e7(0x232)]=='Hindi')var _0x2c36fa=users[_0x32d2e7(0x1cb)];else{if(_0xa4169c[0x0][_0x32d2e7(0x232)]==_0x32d2e7(0x1da))var _0x2c36fa=users[_0x32d2e7(0x1da)];else{if(_0xa4169c[0x0][_0x32d2e7(0x232)]==_0x32d2e7(0x1eb))var _0x2c36fa=users[_0x32d2e7(0x1eb)];else{if(_0xa4169c[0x0][_0x32d2e7(0x232)]==_0x32d2e7(0x1ea))var _0x2c36fa=users[_0x32d2e7(0x1ea)];else{if(_0xa4169c[0x0][_0x32d2e7(0x232)]==_0x32d2e7(0x228))var _0x2c36fa=users[_0x32d2e7(0x229)];else{if(_0xa4169c[0x0][_0x32d2e7(0x232)]==_0x32d2e7(0x224))var _0x2c36fa=users[_0x32d2e7(0x224)];else{if(_0xa4169c[0x0]['language']==_0x32d2e7(0x1d0))var _0x2c36fa=users[_0x32d2e7(0x1e3)];}}}}}}}_0x149906['render'](_0x32d2e7(0x216),{'success':_0x53f66a[_0x32d2e7(0x21f)](_0x32d2e7(0x1f1)),'errors':_0x53f66a['flash'](_0x32d2e7(0x225)),'role':_0xdcb898,'profile':_0x55cafa,'master_shop':_0xa4169c,'user':_0x26341b,'language':_0x2c36fa});}catch(_0x231c59){console[_0x32d2e7(0x22f)](_0x231c59);}}),router['post'](a0_0x33d635(0x20a),auth,async(_0x185b1a,_0x89f6cc)=>{const _0x190dd7=a0_0x33d635;try{const _0x1896e4=_0x185b1a[_0x190dd7(0x1e6)]['id'],_0x12204e=await suppliers[_0x190dd7(0x203)](_0x1896e4),{name:_0x28ab10,email:_0x2366b0,mobile:_0xab5296,company:_0x1ce04f,address:_0x2b52b9,receivable:_0x15d9aa,payable:_0x6dfdf2,code:_0x134792,contactperson:_0x544602,landline:_0x570ddf}=_0x185b1a[_0x190dd7(0x1df)];_0x12204e[_0x190dd7(0x231)]=_0x28ab10,_0x12204e['email']=_0x2366b0,_0x12204e[_0x190dd7(0x236)]=_0xab5296,_0x12204e[_0x190dd7(0x1f5)]=_0x1ce04f,_0x12204e[_0x190dd7(0x21c)]=_0x2b52b9,_0x12204e[_0x190dd7(0x222)]=_0x15d9aa,_0x12204e[_0x190dd7(0x20b)]=_0x6dfdf2,_0x12204e[_0x190dd7(0x20e)]=_0x134792,_0x12204e[_0x190dd7(0x1d9)]=_0x544602,_0x12204e[_0x190dd7(0x21b)]=_0x570ddf;const _0x4c7b75=await _0x12204e[_0x190dd7(0x1f6)]();_0x185b1a['flash'](_0x190dd7(0x1f1),'supplier\x20data\x20update\x20successfully'),_0x89f6cc[_0x190dd7(0x1ca)](_0x190dd7(0x1c9));}catch(_0x546e92){console['log'](_0x546e92);}}),router[a0_0x33d635(0x1f8)]('/view/payment/:id',auth,async(_0x30c679,_0xdc7536)=>{const _0x19480c=a0_0x33d635;try{const {username:_0x157b3a,email:_0x31a12e,role:_0x295e6b}=_0x30c679[_0x19480c(0x22a)],_0x1fcc3e=_0x30c679[_0x19480c(0x22a)],_0x52b253=await profile[_0x19480c(0x1fe)]({'email':_0x1fcc3e[_0x19480c(0x1d3)]}),_0x210afe=await master_shop[_0x19480c(0x215)]();console[_0x19480c(0x22f)]('master',_0x210afe),console[_0x19480c(0x22f)](_0x30c679[_0x19480c(0x1e6)]['id']);const _0x4f543e=await suppliers['findOne']({'_id':_0x30c679[_0x19480c(0x1e6)]['id']});console[_0x19480c(0x22f)](_0x4f543e);const _0x1ec87b=await s_payment_data[_0x19480c(0x215)]({'suppliers':_0x4f543e[_0x19480c(0x231)]});console[_0x19480c(0x22f)](_0x1ec87b);const _0x40f155=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x4f543e[_0x19480c(0x231)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x19480c(0x1db),'sum':{'$sum':_0x19480c(0x1ee)}}}]);console['log'](_0x19480c(0x1ce),_0x40f155);const _0x146337=await s_payment_data[_0x19480c(0x1e9)]([{'$match':{'suppliers':_0x4f543e[_0x19480c(0x231)]}},{'$match':{'reason':_0x19480c(0x22b)}},{'$group':{'_id':_0x19480c(0x1db),'sum':{'$sum':_0x19480c(0x1ee)}}}]);console[_0x19480c(0x22f)](_0x19480c(0x1d1),_0x146337);if(_0x210afe[0x0][_0x19480c(0x232)]=='English\x20(US)'){var _0x12886d=users[_0x19480c(0x1ef)];console[_0x19480c(0x22f)](_0x12886d);}else{if(_0x210afe[0x0][_0x19480c(0x232)]=='Hindi')var _0x12886d=users[_0x19480c(0x1cb)];else{if(_0x210afe[0x0]['language']==_0x19480c(0x1da))var _0x12886d=users[_0x19480c(0x1da)];else{if(_0x210afe[0x0][_0x19480c(0x232)]==_0x19480c(0x1eb))var _0x12886d=users['Spanish'];else{if(_0x210afe[0x0][_0x19480c(0x232)]=='French')var _0x12886d=users[_0x19480c(0x1ea)];else{if(_0x210afe[0x0][_0x19480c(0x232)]==_0x19480c(0x228))var _0x12886d=users[_0x19480c(0x229)];else{if(_0x210afe[0x0]['language']==_0x19480c(0x224))var _0x12886d=users[_0x19480c(0x224)];else{if(_0x210afe[0x0][_0x19480c(0x232)]==_0x19480c(0x1d0))var _0x12886d=users['Arabic'];}}}}}}}_0xdc7536['render']('supplier_payment',{'success':_0x30c679[_0x19480c(0x21f)](_0x19480c(0x1f1)),'errors':_0x30c679[_0x19480c(0x21f)]('errors'),'role':_0x1fcc3e,'profile':_0x52b253,'master_shop':_0x210afe,'payment':_0x1ec87b,'payable':_0x40f155,'receivable':_0x146337,'language':_0x12886d});}catch(_0x425475){console[_0x19480c(0x22f)](_0x425475);}}),router['get'](a0_0x33d635(0x210),auth,async(_0x38c553,_0x46a4a2)=>{const _0x5826e7=a0_0x33d635;try{const _0x37dcbc=new excelJS[(_0x5826e7(0x230))](),_0x34f0c6=_0x37dcbc[_0x5826e7(0x237)](_0x5826e7(0x226));return _0x34f0c6[_0x5826e7(0x238)]=[{'header':_0x5826e7(0x1e7),'key':_0x5826e7(0x219),'width':0xa},{'header':_0x5826e7(0x1fb),'key':_0x5826e7(0x200),'width':0xa},{'header':'Email','key':_0x5826e7(0x1d2),'width':0xa},{'header':_0x5826e7(0x201),'key':_0x5826e7(0x21c),'width':0xa},{'header':_0x5826e7(0x1ed),'key':_0x5826e7(0x236),'width':0xa},{'header':_0x5826e7(0x21c),'key':'email','width':0xa}],_0x46a4a2[_0x5826e7(0x1f3)](_0x5826e7(0x214),_0x5826e7(0x212)),_0x46a4a2[_0x5826e7(0x1f3)](_0x5826e7(0x1cd),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x37dcbc[_0x5826e7(0x234)][_0x5826e7(0x223)](_0x46a4a2)[_0x5826e7(0x21d)](()=>{const _0x2dede2=_0x5826e7;_0x46a4a2[_0x2dede2(0x1fa)](0xc8);});}catch(_0x39e9d1){_0x46a4a2[_0x5826e7(0x1fa)](0x190)[_0x5826e7(0x21e)]({'errors':_0x39e9d1[_0x5826e7(0x1dc)]});}});const storage1=multer[a0_0x33d635(0x218)]({'destination':(_0xedeb78,_0x40c031,_0x1c9469)=>{_0x1c9469(null,'public/Migration');},'filename':(_0x343f40,_0x3bbb7e,_0x2d7213)=>{const _0x4c4195=a0_0x33d635;_0x2d7213(null,Date[_0x4c4195(0x1d5)]()+_0x3bbb7e[_0x4c4195(0x1cf)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x33d635(0x22c),auth,uploadMigrate[a0_0x33d635(0x1ec)](a0_0x33d635(0x1d8)),async(_0x2946c2,_0x59124c)=>{const _0x4561da=a0_0x33d635,_0x1c45ec=_0x2946c2[_0x4561da(0x213)][_0x4561da(0x1e5)],_0x72ebb7=await xlsx[_0x4561da(0x205)](_0x4561da(0x202)+_0x1c45ec);let _0xf6fb6a=_0x72ebb7[_0x4561da(0x20f)],_0x337c91=xlsx[_0x4561da(0x209)][_0x4561da(0x1d6)](_0x72ebb7[_0x4561da(0x235)][_0xf6fb6a[0x0]]);for(const _0x1d7e3c of _0x337c91){const _0x58b6f4=_0x1d7e3c[_0x4561da(0x1e7)],_0x4e8d8e=_0x1d7e3c[_0x4561da(0x1fb)],_0x435783=_0x1d7e3c['address'],_0x347ebd=_0x1d7e3c[_0x4561da(0x201)],_0x529379=_0x1d7e3c[_0x4561da(0x221)],_0x1bff8e=_0x1d7e3c[_0x4561da(0x1ed)];try{let _0x23d33b=await suppliers[_0x4561da(0x1fe)]({'name':_0x58b6f4});if(!_0x23d33b){const _0x1bfe31=new suppliers({'name':_0x58b6f4,'suppliers_code':_0x4e8d8e,'address':_0x435783,'mobile':_0x347ebd,'email':_0x529379,'company':_0x1bff8e});_0x23d33b=await _0x1bfe31[_0x4561da(0x1f6)](),_0x2946c2[_0x4561da(0x21f)](_0x4561da(0x1f1),_0x58b6f4+_0x4561da(0x22d));}else _0x2946c2['flash']('error',_0x58b6f4+'\x20Failed');}catch(_0x2aed3d){_0x59124c[_0x4561da(0x1fa)](0x1f4)[_0x4561da(0x211)]({'proderror':_0x2aed3d['message'],'aproduct':ProductName});}}_0x59124c[_0x4561da(0x1ca)]('/supplier/view');}),module['exports']=router;