const a0_0x24049b=a0_0x5539;(function(_0x5ec155,_0x374a11){const _0x542e59=a0_0x5539,_0x15f429=_0x5ec155();while(!![]){try{const _0x59affc=parseInt(_0x542e59(0x1ad))/0x1*(parseInt(_0x542e59(0x1c2))/0x2)+-parseInt(_0x542e59(0x18d))/0x3*(-parseInt(_0x542e59(0x181))/0x4)+parseInt(_0x542e59(0x17e))/0x5*(parseInt(_0x542e59(0x1c9))/0x6)+-parseInt(_0x542e59(0x1cd))/0x7*(-parseInt(_0x542e59(0x1bf))/0x8)+-parseInt(_0x542e59(0x1a7))/0x9+-parseInt(_0x542e59(0x1b9))/0xa+parseInt(_0x542e59(0x180))/0xb*(-parseInt(_0x542e59(0x19b))/0xc);if(_0x59affc===_0x374a11)break;else _0x15f429['push'](_0x15f429['shift']());}catch(_0xcea6ef){_0x15f429['push'](_0x15f429['shift']());}}}(a0_0x49a9,0x1dc7c));function a0_0x5539(_0x43b695,_0x1e20f6){const _0x49a9e4=a0_0x49a9();return a0_0x5539=function(_0x5539b0,_0x4af6ea){_0x5539b0=_0x5539b0-0x177;let _0x222cad=_0x49a9e4[_0x5539b0];return _0x222cad;},a0_0x5539(_0x43b695,_0x1e20f6);}function a0_0x49a9(){const _0xa91025=['/supplier/view','xlsx','English\x20(US)','582421bKOIvS','Purchase','reason','Content-Type','SalesmanName','/view','findOne','aggregate','render','suppliers','find','$reason','Name','express','PBrands','then','findById','address','supplier_payment','Chinese','success','Hindi','errors','Mobile_number','public/Migration/','German','readFile','company','post','../middleware/auth','45TtWzkC','Company_Name','2035ZhIlkV','302308mYrxRS','Arabic\x20(ae)','payable_sum','doc','Portuguese','params','single','message','Arabic','save','Content-Disposition','Email','6mgpbcT','supplier\x20data\x20add\x20successfully','SheetNames','supplier.js\x20payment_data','exceljs','Sheets','data','mobile','English','/view/:id','exports','user','map','public/Migration','20988WMQdvv','../public/language/languages.json','supplier','Workbook','get','Portuguese\x20(BR)','email','Customers','amount','/supplier_import_migrate_file','language','error','82764hpclci','receivable_sum','flash','landline','supplier\x20data\x20update\x20successfully','redirect','40981OzWJcO','diskStorage','French','sheet_to_json','setHeader','PUnits','Spanish','send','json','/products_export_migrate_file','body','\x20added\x20successfully','616880InZwPO','status','name','$amount','forEach','Purchase\x20Return','8gAddAS','write','Supplier_Code','6KGVFqk','master','log','\x20Failed','../models/all_models','supplier_product_file','contactperson','106086okSewh'];a0_0x49a9=function(){return _0xa91025;};return a0_0x49a9();}const express=require(a0_0x24049b(0x1da)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x24049b(0x1c6)),auth=require(a0_0x24049b(0x17d)),users=require(a0_0x24049b(0x19c)),excelJS=require(a0_0x24049b(0x191)),xlsx=require('xlsx'),multer=require('multer');router[a0_0x24049b(0x19f)](a0_0x24049b(0x1d2),auth,async(_0x368999,_0x3ab961)=>{const _0x106db1=a0_0x24049b;try{const {username:_0x5c4a32,email:_0x5dd42e,role:_0x58b1e5}=_0x368999[_0x106db1(0x198)],_0x477b33=_0x368999[_0x106db1(0x198)],_0x585571=await profile[_0x106db1(0x1d3)]({'email':_0x477b33['email']}),_0xe6f1e6=await master_shop['find']();console['log'](_0x106db1(0x1c3),_0xe6f1e6);const _0xf6bf45=await suppliers['find']();console['log'](_0xf6bf45);const _0x2ba8f8=await suppliers[_0x106db1(0x1d4)]([{'$lookup':{'from':'s_payments','localField':_0x106db1(0x1bb),'foreignField':_0x106db1(0x1d6),'as':'suppliers_docs'}}]),_0x28f377=_0x2ba8f8[_0x106db1(0x199)](_0x59a5d6=>{const _0x28eb6b=_0x106db1;console['log'](_0x28eb6b(0x193),_0x59a5d6);var _0x4576a7=0x0,_0x5e1804=0x0;return _0x59a5d6['suppliers_docs'][_0x28eb6b(0x1bd)](_0xaf73b=>{const _0x148bdf=_0x28eb6b;console[_0x148bdf(0x1c4)](_0x148bdf(0x184),_0xaf73b),_0xaf73b[_0x148bdf(0x1cf)]==_0x148bdf(0x1ce)?_0x4576a7+=_0xaf73b[_0x148bdf(0x1a3)]:_0x5e1804+=_0xaf73b[_0x148bdf(0x1a3)];}),_0x59a5d6['purchase']=_0x4576a7,_0x59a5d6['purchase_return']=_0x5e1804,_0x59a5d6;});console[_0x106db1(0x1c4)](_0x106db1(0x190),_0x28f377);if(_0xe6f1e6[0x0][_0x106db1(0x1a5)]==_0x106db1(0x1cc)){var _0x418134=users[_0x106db1(0x195)];console[_0x106db1(0x1c4)](_0x418134);}else{if(_0xe6f1e6[0x0]['language']==_0x106db1(0x1e2))var _0x418134=users[_0x106db1(0x1e2)];else{if(_0xe6f1e6[0x0][_0x106db1(0x1a5)]==_0x106db1(0x179))var _0x418134=users[_0x106db1(0x179)];else{if(_0xe6f1e6[0x0][_0x106db1(0x1a5)]=='Spanish')var _0x418134=users['Spanish'];else{if(_0xe6f1e6[0x0][_0x106db1(0x1a5)]==_0x106db1(0x1af))var _0x418134=users[_0x106db1(0x1af)];else{if(_0xe6f1e6[0x0][_0x106db1(0x1a5)]==_0x106db1(0x1a0))var _0x418134=users['Portuguese'];else{if(_0xe6f1e6[0x0][_0x106db1(0x1a5)]==_0x106db1(0x1e0))var _0x418134=users['Chinese'];else{if(_0xe6f1e6[0x0][_0x106db1(0x1a5)]==_0x106db1(0x182))var _0x418134=users[_0x106db1(0x189)];}}}}}}}_0x3ab961[_0x106db1(0x1d5)]('supplier',{'success':_0x368999[_0x106db1(0x1a9)]('success'),'errors':_0x368999[_0x106db1(0x1a9)](_0x106db1(0x1e3)),'user':_0xf6bf45,'profile':_0x585571,'master_shop':_0xe6f1e6,'role':_0x477b33,'payment':_0x28f377,'language':_0x418134});}catch(_0x219f49){console[_0x106db1(0x1c4)](_0x219f49);}}),router[a0_0x24049b(0x17c)](a0_0x24049b(0x1d2),auth,async(_0x4c1063,_0x2bd523)=>{const _0x59d035=a0_0x24049b;try{const {name:_0xb076b0,email:_0x23d55c,mobile:_0x2e76ac,company:_0x47df6a,address:_0x1dd1a2,receivable:_0x526ea1,payable:_0x410d35,code:_0x5c0873,contactperson:_0x500c64,landline:_0x3dba54}=_0x4c1063[_0x59d035(0x1b7)],_0x38ccb0=new suppliers({'name':_0xb076b0,'email':_0x23d55c,'mobile':_0x2e76ac,'company':_0x47df6a,'address':_0x1dd1a2,'receivable':_0x526ea1,'payable':_0x410d35,'suppliers_code':_0x5c0873,'contactperson':_0x500c64,'landline':_0x3dba54}),_0x5c0055=await _0x38ccb0[_0x59d035(0x18a)]();_0x4c1063[_0x59d035(0x1a9)](_0x59d035(0x1e1),_0x59d035(0x18e)),_0x2bd523['redirect'](_0x59d035(0x1ca));}catch(_0x175048){console['log'](_0x175048);}}),router['get'](a0_0x24049b(0x196),auth,async(_0x35225b,_0x635e11)=>{const _0x10d5dc=a0_0x24049b;try{const {username:_0x503094,email:_0x49de58,role:_0x55e690}=_0x35225b[_0x10d5dc(0x198)],_0x1a2734=_0x35225b[_0x10d5dc(0x198)],_0x5df894=await profile[_0x10d5dc(0x1d3)]({'email':_0x1a2734[_0x10d5dc(0x1a1)]}),_0x23c3e3=await master_shop[_0x10d5dc(0x1d7)]();console[_0x10d5dc(0x1c4)](_0x10d5dc(0x1c3),_0x23c3e3);const _0x2a61da=_0x35225b[_0x10d5dc(0x186)]['id'],_0x3b61b2=await suppliers[_0x10d5dc(0x1dd)](_0x2a61da);console[_0x10d5dc(0x1c4)](_0x3b61b2);if(_0x23c3e3[0x0][_0x10d5dc(0x1a5)]==_0x10d5dc(0x1cc)){var _0x32c4ef=users[_0x10d5dc(0x195)];console[_0x10d5dc(0x1c4)](_0x32c4ef);}else{if(_0x23c3e3[0x0]['language']==_0x10d5dc(0x1e2))var _0x32c4ef=users[_0x10d5dc(0x1e2)];else{if(_0x23c3e3[0x0][_0x10d5dc(0x1a5)]=='German')var _0x32c4ef=users['German'];else{if(_0x23c3e3[0x0][_0x10d5dc(0x1a5)]==_0x10d5dc(0x1b3))var _0x32c4ef=users['Spanish'];else{if(_0x23c3e3[0x0][_0x10d5dc(0x1a5)]==_0x10d5dc(0x1af))var _0x32c4ef=users[_0x10d5dc(0x1af)];else{if(_0x23c3e3[0x0]['language']==_0x10d5dc(0x1a0))var _0x32c4ef=users[_0x10d5dc(0x185)];else{if(_0x23c3e3[0x0][_0x10d5dc(0x1a5)]==_0x10d5dc(0x1e0))var _0x32c4ef=users['Chinese'];else{if(_0x23c3e3[0x0][_0x10d5dc(0x1a5)]==_0x10d5dc(0x182))var _0x32c4ef=users[_0x10d5dc(0x189)];}}}}}}}_0x635e11[_0x10d5dc(0x1d5)](_0x10d5dc(0x19d),{'success':_0x35225b[_0x10d5dc(0x1a9)](_0x10d5dc(0x1e1)),'errors':_0x35225b['flash'](_0x10d5dc(0x1e3)),'role':_0x1a2734,'profile':_0x5df894,'master_shop':_0x23c3e3,'user':_0x3b61b2,'language':_0x32c4ef});}catch(_0x5ed7e2){console[_0x10d5dc(0x1c4)](_0x5ed7e2);}}),router[a0_0x24049b(0x17c)](a0_0x24049b(0x196),auth,async(_0x45f31d,_0x5da528)=>{const _0x3df665=a0_0x24049b;try{const _0x4a6dca=_0x45f31d[_0x3df665(0x186)]['id'],_0x35d8d4=await suppliers[_0x3df665(0x1dd)](_0x4a6dca),{name:_0x333610,email:_0x4792a5,mobile:_0xd8efdc,company:_0x406f5e,address:_0x8a3d3,receivable:_0x32f40f,payable:_0x10e463,code:_0x6a9d27,contactperson:_0x594ed9,landline:_0x135061}=_0x45f31d['body'];_0x35d8d4[_0x3df665(0x1bb)]=_0x333610,_0x35d8d4[_0x3df665(0x1a1)]=_0x4792a5,_0x35d8d4[_0x3df665(0x194)]=_0xd8efdc,_0x35d8d4[_0x3df665(0x17b)]=_0x406f5e,_0x35d8d4[_0x3df665(0x1de)]=_0x8a3d3,_0x35d8d4['receivable']=_0x32f40f,_0x35d8d4['payable']=_0x10e463,_0x35d8d4['suppliers_code']=_0x6a9d27,_0x35d8d4[_0x3df665(0x1c8)]=_0x594ed9,_0x35d8d4[_0x3df665(0x1aa)]=_0x135061;const _0x6575ad=await _0x35d8d4[_0x3df665(0x18a)]();_0x45f31d[_0x3df665(0x1a9)](_0x3df665(0x1e1),_0x3df665(0x1ab)),_0x5da528['redirect']('/supplier/view');}catch(_0x2c88ef){console[_0x3df665(0x1c4)](_0x2c88ef);}}),router[a0_0x24049b(0x19f)]('/view/payment/:id',auth,async(_0x4eb4fa,_0x285d8e)=>{const _0x450218=a0_0x24049b;try{const {username:_0x53197d,email:_0x5124ff,role:_0x40805c}=_0x4eb4fa[_0x450218(0x198)],_0x2e2e2b=_0x4eb4fa[_0x450218(0x198)],_0x18263e=await profile[_0x450218(0x1d3)]({'email':_0x2e2e2b['email']}),_0x136d2a=await master_shop[_0x450218(0x1d7)]();console['log'](_0x450218(0x1c3),_0x136d2a),console['log'](_0x4eb4fa[_0x450218(0x186)]['id']);const _0x55f848=await suppliers[_0x450218(0x1d3)]({'_id':_0x4eb4fa[_0x450218(0x186)]['id']});console['log'](_0x55f848);const _0x81761c=await s_payment_data[_0x450218(0x1d7)]({'suppliers':_0x55f848[_0x450218(0x1bb)]});console[_0x450218(0x1c4)](_0x81761c);const _0x805ffc=await s_payment_data[_0x450218(0x1d4)]([{'$match':{'suppliers':_0x55f848[_0x450218(0x1bb)]}},{'$match':{'reason':_0x450218(0x1ce)}},{'$group':{'_id':_0x450218(0x1d8),'sum':{'$sum':_0x450218(0x1bc)}}}]);console['log'](_0x450218(0x183),_0x805ffc);const _0x10def2=await s_payment_data[_0x450218(0x1d4)]([{'$match':{'suppliers':_0x55f848['name']}},{'$match':{'reason':_0x450218(0x1be)}},{'$group':{'_id':_0x450218(0x1d8),'sum':{'$sum':'$amount'}}}]);console[_0x450218(0x1c4)](_0x450218(0x1a8),_0x10def2);if(_0x136d2a[0x0]['language']==_0x450218(0x1cc)){var _0x9f563b=users[_0x450218(0x195)];console[_0x450218(0x1c4)](_0x9f563b);}else{if(_0x136d2a[0x0][_0x450218(0x1a5)]=='Hindi')var _0x9f563b=users['Hindi'];else{if(_0x136d2a[0x0]['language']==_0x450218(0x179))var _0x9f563b=users['German'];else{if(_0x136d2a[0x0]['language']==_0x450218(0x1b3))var _0x9f563b=users[_0x450218(0x1b3)];else{if(_0x136d2a[0x0][_0x450218(0x1a5)]==_0x450218(0x1af))var _0x9f563b=users['French'];else{if(_0x136d2a[0x0][_0x450218(0x1a5)]==_0x450218(0x1a0))var _0x9f563b=users[_0x450218(0x185)];else{if(_0x136d2a[0x0][_0x450218(0x1a5)]==_0x450218(0x1e0))var _0x9f563b=users['Chinese'];else{if(_0x136d2a[0x0]['language']==_0x450218(0x182))var _0x9f563b=users[_0x450218(0x189)];}}}}}}}_0x285d8e['render'](_0x450218(0x1df),{'success':_0x4eb4fa['flash'](_0x450218(0x1e1)),'errors':_0x4eb4fa[_0x450218(0x1a9)](_0x450218(0x1e3)),'role':_0x2e2e2b,'profile':_0x18263e,'master_shop':_0x136d2a,'payment':_0x81761c,'payable':_0x805ffc,'receivable':_0x10def2,'language':_0x9f563b});}catch(_0x271364){console['log'](_0x271364);}}),router[a0_0x24049b(0x19f)](a0_0x24049b(0x1b6),auth,async(_0x17d34c,_0x58ebce)=>{const _0x3bd3f0=a0_0x24049b;try{const _0x32ebb2=new excelJS[(_0x3bd3f0(0x19e))](),_0x5c3936=_0x32ebb2['addWorksheet'](_0x3bd3f0(0x1a2));return _0x5c3936['columns']=[{'header':_0x3bd3f0(0x1d9),'key':_0x3bd3f0(0x1db),'width':0xa},{'header':_0x3bd3f0(0x1c1),'key':_0x3bd3f0(0x1b2),'width':0xa},{'header':'Email','key':_0x3bd3f0(0x1d1),'width':0xa},{'header':_0x3bd3f0(0x177),'key':_0x3bd3f0(0x1de),'width':0xa},{'header':_0x3bd3f0(0x17f),'key':_0x3bd3f0(0x194),'width':0xa},{'header':_0x3bd3f0(0x1de),'key':_0x3bd3f0(0x1a1),'width':0xa}],_0x58ebce[_0x3bd3f0(0x1b1)](_0x3bd3f0(0x1d0),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x58ebce['setHeader'](_0x3bd3f0(0x18b),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x32ebb2[_0x3bd3f0(0x1cb)][_0x3bd3f0(0x1c0)](_0x58ebce)[_0x3bd3f0(0x1dc)](()=>{_0x58ebce['status'](0xc8);});}catch(_0x16be8f){_0x58ebce[_0x3bd3f0(0x1ba)](0x190)[_0x3bd3f0(0x1b4)]({'errors':_0x16be8f[_0x3bd3f0(0x188)]});}});const storage1=multer[a0_0x24049b(0x1ae)]({'destination':(_0x5a9fd1,_0x1f9791,_0x352841)=>{const _0x409354=a0_0x24049b;_0x352841(null,_0x409354(0x19a));},'filename':(_0x22c4fd,_0x2cb152,_0x542b69)=>{_0x542b69(null,Date['now']()+_0x2cb152['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x24049b(0x17c)](a0_0x24049b(0x1a4),auth,uploadMigrate[a0_0x24049b(0x187)](a0_0x24049b(0x1c7)),async(_0x2ac918,_0x1746e9)=>{const _0x2f9a56=a0_0x24049b,_0x2d3786=_0x2ac918['file']['filename'],_0x15b059=await xlsx[_0x2f9a56(0x17a)](_0x2f9a56(0x178)+_0x2d3786);let _0x56e498=_0x15b059[_0x2f9a56(0x18f)],_0x29cb90=xlsx['utils'][_0x2f9a56(0x1b0)](_0x15b059[_0x2f9a56(0x192)][_0x56e498[0x0]]);for(const _0x62a1b4 of _0x29cb90){const _0x3de1f5=_0x62a1b4[_0x2f9a56(0x1d9)],_0x3b641e=_0x62a1b4[_0x2f9a56(0x1c1)],_0x50f568=_0x62a1b4[_0x2f9a56(0x1de)],_0x4c1833=_0x62a1b4[_0x2f9a56(0x177)],_0x304fc8=_0x62a1b4[_0x2f9a56(0x18c)],_0x2029b9=_0x62a1b4[_0x2f9a56(0x17f)];try{let _0x2fd8ac=await suppliers[_0x2f9a56(0x1d3)]({'name':_0x3de1f5});if(!_0x2fd8ac){const _0x56379b=new suppliers({'name':_0x3de1f5,'suppliers_code':_0x3b641e,'address':_0x50f568,'mobile':_0x4c1833,'email':_0x304fc8,'company':_0x2029b9});_0x2fd8ac=await _0x56379b[_0x2f9a56(0x18a)](),_0x2ac918[_0x2f9a56(0x1a9)](_0x2f9a56(0x1e1),_0x3de1f5+_0x2f9a56(0x1b8));}else _0x2ac918[_0x2f9a56(0x1a9)](_0x2f9a56(0x1a6),_0x3de1f5+_0x2f9a56(0x1c5));}catch(_0x11a7b4){_0x1746e9[_0x2f9a56(0x1ba)](0x1f4)[_0x2f9a56(0x1b5)]({'proderror':_0x11a7b4[_0x2f9a56(0x188)],'aproduct':ProductName});}}_0x1746e9[_0x2f9a56(0x1ac)](_0x2f9a56(0x1ca));}),module[a0_0x24049b(0x197)]=router;