const a0_0x11f019=a0_0x2d78;(function(_0x3de42e,_0x572968){const _0x582a4d=a0_0x2d78,_0x458a7a=_0x3de42e();while(!![]){try{const _0x5ddd9a=-parseInt(_0x582a4d(0xe7))/0x1*(-parseInt(_0x582a4d(0x98))/0x2)+parseInt(_0x582a4d(0xba))/0x3+parseInt(_0x582a4d(0xa9))/0x4*(parseInt(_0x582a4d(0xc1))/0x5)+parseInt(_0x582a4d(0xc4))/0x6*(-parseInt(_0x582a4d(0x97))/0x7)+-parseInt(_0x582a4d(0x9e))/0x8*(-parseInt(_0x582a4d(0xe2))/0x9)+parseInt(_0x582a4d(0xcb))/0xa*(-parseInt(_0x582a4d(0x9c))/0xb)+parseInt(_0x582a4d(0xb6))/0xc*(-parseInt(_0x582a4d(0xd0))/0xd);if(_0x5ddd9a===_0x572968)break;else _0x458a7a['push'](_0x458a7a['shift']());}catch(_0x4c3a1b){_0x458a7a['push'](_0x458a7a['shift']());}}}(a0_0x2da7,0xe8419));function a0_0x2da7(){const _0x114b9c=['s_payments','params','xlsx','Arabic','\x20added\x20successfully','Chinese','map','status','email','errors','findById','utils','48aJBIve','company','receivable_sum','single','4034685RuIZFH','json','Email','Portuguese','body','address','Hindi','770620niqEkW','contactperson','post','6rXzySn','setHeader','redirect','payable','/supplier_import_migrate_file','flash','Sheets','19810jFlPoP','receivable','user','/view','Portuguese\x20(BR)','7044609KPkxqb','/supplier/view','../public/language/languages.json','readFile','aggregate','get','multer','purchase','express','$reason','name','master','supplier\x20data\x20update\x20successfully','English\x20(US)','supplier_product_file','supplier\x20data\x20add\x20successfully','render','Supplier_Code','6114222tYGqZP','\x20Failed','diskStorage','Company_Name','exports','335491CJlxoa','Customers','exceljs','reason','language','public/Migration','then','amount','/view/payment/:id','write','sheet_to_json','supplier_payment','PUnits','error','$amount','English','mobile','data','Router','Spanish','success','Mobile_number','../models/all_models','suppliers_docs','Purchase','message','log','filename','SalesmanName','addWorksheet','German','5278945GeeqZx','4YBAWJA','file','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','attachment;\x20filename=supplier_Migration_File.xlsx','3223FbazbI','/products_export_migrate_file','16QiGLID','find','supplier','save','suppliers_code','French','now','Arabic\x20(ae)','findOne','Name','forEach','28ngEzQA'];a0_0x2da7=function(){return _0x114b9c;};return a0_0x2da7();}const express=require(a0_0x11f019(0xd8)),app=express(),router=express[a0_0x11f019(0xf9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x11f019(0xfd)),auth=require('../middleware/auth'),users=require(a0_0x11f019(0xd2)),excelJS=require(a0_0x11f019(0xe9)),xlsx=require(a0_0x11f019(0xac)),multer=require(a0_0x11f019(0xd6));router[a0_0x11f019(0xd5)](a0_0x11f019(0xce),auth,async(_0x4cfc60,_0x177a9d)=>{const _0x52b6f3=a0_0x11f019;try{const {username:_0x1a5b75,email:_0x13e0ba,role:_0x55985e}=_0x4cfc60[_0x52b6f3(0xcd)],_0x3ea9b4=_0x4cfc60[_0x52b6f3(0xcd)],_0x2279c7=await profile[_0x52b6f3(0xa6)]({'email':_0x3ea9b4[_0x52b6f3(0xb2)]}),_0x47c35e=await master_shop[_0x52b6f3(0x9f)]();console[_0x52b6f3(0x101)](_0x52b6f3(0xdb),_0x47c35e);const _0xbeb1ea=await suppliers['find']();console[_0x52b6f3(0x101)](_0xbeb1ea);const _0x3f4322=await suppliers['aggregate']([{'$lookup':{'from':_0x52b6f3(0xaa),'localField':_0x52b6f3(0xda),'foreignField':'suppliers','as':'suppliers_docs'}}]),_0x3aa9a8=_0x3f4322[_0x52b6f3(0xb0)](_0x3e9156=>{const _0x9c256e=_0x52b6f3;console[_0x9c256e(0x101)](_0x9c256e(0xf8),_0x3e9156);var _0x978c3a=0x0,_0x2f3d66=0x0;return _0x3e9156[_0x9c256e(0xfe)][_0x9c256e(0xa8)](_0x5b2192=>{const _0xe824e0=_0x9c256e;console[_0xe824e0(0x101)]('doc',_0x5b2192),_0x5b2192[_0xe824e0(0xea)]==_0xe824e0(0xff)?_0x978c3a+=_0x5b2192[_0xe824e0(0xee)]:_0x2f3d66+=_0x5b2192[_0xe824e0(0xee)];}),_0x3e9156[_0x9c256e(0xd7)]=_0x978c3a,_0x3e9156['purchase_return']=_0x2f3d66,_0x3e9156;});console[_0x52b6f3(0x101)]('supplier.js\x20payment_data',_0x3aa9a8);if(_0x47c35e[0x0][_0x52b6f3(0xeb)]==_0x52b6f3(0xdd)){var _0x19ffa8=users[_0x52b6f3(0xf6)];console['log'](_0x19ffa8);}else{if(_0x47c35e[0x0][_0x52b6f3(0xeb)]==_0x52b6f3(0xc0))var _0x19ffa8=users[_0x52b6f3(0xc0)];else{if(_0x47c35e[0x0][_0x52b6f3(0xeb)]==_0x52b6f3(0x96))var _0x19ffa8=users[_0x52b6f3(0x96)];else{if(_0x47c35e[0x0][_0x52b6f3(0xeb)]==_0x52b6f3(0xfa))var _0x19ffa8=users[_0x52b6f3(0xfa)];else{if(_0x47c35e[0x0][_0x52b6f3(0xeb)]==_0x52b6f3(0xa3))var _0x19ffa8=users['French'];else{if(_0x47c35e[0x0]['language']=='Portuguese\x20(BR)')var _0x19ffa8=users[_0x52b6f3(0xbd)];else{if(_0x47c35e[0x0][_0x52b6f3(0xeb)]==_0x52b6f3(0xaf))var _0x19ffa8=users['Chinese'];else{if(_0x47c35e[0x0][_0x52b6f3(0xeb)]==_0x52b6f3(0xa5))var _0x19ffa8=users[_0x52b6f3(0xad)];}}}}}}}_0x177a9d[_0x52b6f3(0xe0)](_0x52b6f3(0xa0),{'success':_0x4cfc60[_0x52b6f3(0xc9)]('success'),'errors':_0x4cfc60['flash']('errors'),'user':_0xbeb1ea,'profile':_0x2279c7,'master_shop':_0x47c35e,'role':_0x3ea9b4,'payment':_0x3aa9a8,'language':_0x19ffa8});}catch(_0x2ef673){console[_0x52b6f3(0x101)](_0x2ef673);}}),router[a0_0x11f019(0xc3)](a0_0x11f019(0xce),auth,async(_0x342edb,_0x1e3ba2)=>{const _0x274af6=a0_0x11f019;try{const {name:_0x32c5dc,email:_0x23bf7b,mobile:_0x1c1049,company:_0x5a2033,address:_0x525858,receivable:_0x404e31,payable:_0x2c67f8,code:_0x1b399c,contactperson:_0x563df5,landline:_0x71c912}=_0x342edb[_0x274af6(0xbe)],_0x4e8ca2=new suppliers({'name':_0x32c5dc,'email':_0x23bf7b,'mobile':_0x1c1049,'company':_0x5a2033,'address':_0x525858,'receivable':_0x404e31,'payable':_0x2c67f8,'suppliers_code':_0x1b399c,'contactperson':_0x563df5,'landline':_0x71c912}),_0x5a200c=await _0x4e8ca2[_0x274af6(0xa1)]();_0x342edb[_0x274af6(0xc9)](_0x274af6(0xfb),_0x274af6(0xdf)),_0x1e3ba2[_0x274af6(0xc6)](_0x274af6(0xd1));}catch(_0x285e79){console[_0x274af6(0x101)](_0x285e79);}}),router['get']('/view/:id',auth,async(_0x5e0137,_0xe7ef9)=>{const _0x1bf47d=a0_0x11f019;try{const {username:_0x303855,email:_0x106ba2,role:_0x446e48}=_0x5e0137[_0x1bf47d(0xcd)],_0x59e0dc=_0x5e0137[_0x1bf47d(0xcd)],_0x17695f=await profile[_0x1bf47d(0xa6)]({'email':_0x59e0dc[_0x1bf47d(0xb2)]}),_0x2b47db=await master_shop[_0x1bf47d(0x9f)]();console['log'](_0x1bf47d(0xdb),_0x2b47db);const _0x3af572=_0x5e0137[_0x1bf47d(0xab)]['id'],_0x42adbc=await suppliers[_0x1bf47d(0xb4)](_0x3af572);console[_0x1bf47d(0x101)](_0x42adbc);if(_0x2b47db[0x0][_0x1bf47d(0xeb)]==_0x1bf47d(0xdd)){var _0x1d4c96=users[_0x1bf47d(0xf6)];console[_0x1bf47d(0x101)](_0x1d4c96);}else{if(_0x2b47db[0x0][_0x1bf47d(0xeb)]==_0x1bf47d(0xc0))var _0x1d4c96=users[_0x1bf47d(0xc0)];else{if(_0x2b47db[0x0]['language']=='German')var _0x1d4c96=users['German'];else{if(_0x2b47db[0x0]['language']==_0x1bf47d(0xfa))var _0x1d4c96=users[_0x1bf47d(0xfa)];else{if(_0x2b47db[0x0][_0x1bf47d(0xeb)]==_0x1bf47d(0xa3))var _0x1d4c96=users[_0x1bf47d(0xa3)];else{if(_0x2b47db[0x0][_0x1bf47d(0xeb)]==_0x1bf47d(0xcf))var _0x1d4c96=users['Portuguese'];else{if(_0x2b47db[0x0]['language']==_0x1bf47d(0xaf))var _0x1d4c96=users[_0x1bf47d(0xaf)];else{if(_0x2b47db[0x0][_0x1bf47d(0xeb)]==_0x1bf47d(0xa5))var _0x1d4c96=users[_0x1bf47d(0xad)];}}}}}}}_0xe7ef9[_0x1bf47d(0xe0)](_0x1bf47d(0xa0),{'success':_0x5e0137[_0x1bf47d(0xc9)](_0x1bf47d(0xfb)),'errors':_0x5e0137[_0x1bf47d(0xc9)]('errors'),'role':_0x59e0dc,'profile':_0x17695f,'master_shop':_0x2b47db,'user':_0x42adbc,'language':_0x1d4c96});}catch(_0x3a494e){console[_0x1bf47d(0x101)](_0x3a494e);}}),router['post']('/view/:id',auth,async(_0xc728be,_0x39d33b)=>{const _0x1db9ff=a0_0x11f019;try{const _0x5da73c=_0xc728be[_0x1db9ff(0xab)]['id'],_0x9156c1=await suppliers['findById'](_0x5da73c),{name:_0x17f56a,email:_0x330471,mobile:_0x1b1498,company:_0x5e156d,address:_0x232281,receivable:_0x3c175a,payable:_0x1eb9ed,code:_0x38a146,contactperson:_0x210be1,landline:_0x44e1ca}=_0xc728be[_0x1db9ff(0xbe)];_0x9156c1[_0x1db9ff(0xda)]=_0x17f56a,_0x9156c1['email']=_0x330471,_0x9156c1[_0x1db9ff(0xf7)]=_0x1b1498,_0x9156c1[_0x1db9ff(0xb7)]=_0x5e156d,_0x9156c1[_0x1db9ff(0xbf)]=_0x232281,_0x9156c1[_0x1db9ff(0xcc)]=_0x3c175a,_0x9156c1[_0x1db9ff(0xc7)]=_0x1eb9ed,_0x9156c1[_0x1db9ff(0xa2)]=_0x38a146,_0x9156c1[_0x1db9ff(0xc2)]=_0x210be1,_0x9156c1['landline']=_0x44e1ca;const _0x2f7aed=await _0x9156c1[_0x1db9ff(0xa1)]();_0xc728be[_0x1db9ff(0xc9)]('success',_0x1db9ff(0xdc)),_0x39d33b[_0x1db9ff(0xc6)](_0x1db9ff(0xd1));}catch(_0x19600f){console[_0x1db9ff(0x101)](_0x19600f);}}),router[a0_0x11f019(0xd5)](a0_0x11f019(0xef),auth,async(_0x40abf6,_0x5dacc1)=>{const _0x56803e=a0_0x11f019;try{const {username:_0x1251b4,email:_0x39710d,role:_0x1f3d78}=_0x40abf6[_0x56803e(0xcd)],_0xe66228=_0x40abf6[_0x56803e(0xcd)],_0x3af23e=await profile[_0x56803e(0xa6)]({'email':_0xe66228[_0x56803e(0xb2)]}),_0x4ab4e2=await master_shop[_0x56803e(0x9f)]();console[_0x56803e(0x101)]('master',_0x4ab4e2),console[_0x56803e(0x101)](_0x40abf6[_0x56803e(0xab)]['id']);const _0x3b3b39=await suppliers[_0x56803e(0xa6)]({'_id':_0x40abf6[_0x56803e(0xab)]['id']});console[_0x56803e(0x101)](_0x3b3b39);const _0x59cffc=await s_payment_data['find']({'suppliers':_0x3b3b39['name']});console['log'](_0x59cffc);const _0x1f7fd0=await s_payment_data[_0x56803e(0xd4)]([{'$match':{'suppliers':_0x3b3b39['name']}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x56803e(0xf5)}}}]);console[_0x56803e(0x101)]('payable_sum',_0x1f7fd0);const _0x1a848e=await s_payment_data[_0x56803e(0xd4)]([{'$match':{'suppliers':_0x3b3b39['name']}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x56803e(0xd9),'sum':{'$sum':_0x56803e(0xf5)}}}]);console[_0x56803e(0x101)](_0x56803e(0xb8),_0x1a848e);if(_0x4ab4e2[0x0]['language']==_0x56803e(0xdd)){var _0x22aae5=users[_0x56803e(0xf6)];console[_0x56803e(0x101)](_0x22aae5);}else{if(_0x4ab4e2[0x0][_0x56803e(0xeb)]==_0x56803e(0xc0))var _0x22aae5=users[_0x56803e(0xc0)];else{if(_0x4ab4e2[0x0][_0x56803e(0xeb)]==_0x56803e(0x96))var _0x22aae5=users[_0x56803e(0x96)];else{if(_0x4ab4e2[0x0]['language']==_0x56803e(0xfa))var _0x22aae5=users[_0x56803e(0xfa)];else{if(_0x4ab4e2[0x0]['language']==_0x56803e(0xa3))var _0x22aae5=users[_0x56803e(0xa3)];else{if(_0x4ab4e2[0x0]['language']=='Portuguese\x20(BR)')var _0x22aae5=users[_0x56803e(0xbd)];else{if(_0x4ab4e2[0x0][_0x56803e(0xeb)]=='Chinese')var _0x22aae5=users[_0x56803e(0xaf)];else{if(_0x4ab4e2[0x0]['language']==_0x56803e(0xa5))var _0x22aae5=users[_0x56803e(0xad)];}}}}}}}_0x5dacc1[_0x56803e(0xe0)](_0x56803e(0xf2),{'success':_0x40abf6[_0x56803e(0xc9)](_0x56803e(0xfb)),'errors':_0x40abf6['flash'](_0x56803e(0xb3)),'role':_0xe66228,'profile':_0x3af23e,'master_shop':_0x4ab4e2,'payment':_0x59cffc,'payable':_0x1f7fd0,'receivable':_0x1a848e,'language':_0x22aae5});}catch(_0x3d2f1a){console['log'](_0x3d2f1a);}}),router[a0_0x11f019(0xd5)](a0_0x11f019(0x9d),auth,async(_0x16847b,_0x447ea1)=>{const _0x1f4998=a0_0x11f019;try{const _0x2a3eb3=new excelJS['Workbook'](),_0x34be7c=_0x2a3eb3[_0x1f4998(0x95)](_0x1f4998(0xe8));return _0x34be7c['columns']=[{'header':_0x1f4998(0xa7),'key':'PBrands','width':0xa},{'header':'Supplier_Code','key':_0x1f4998(0xf3),'width':0xa},{'header':_0x1f4998(0xbc),'key':_0x1f4998(0x103),'width':0xa},{'header':'Mobile_number','key':'address','width':0xa},{'header':_0x1f4998(0xe5),'key':_0x1f4998(0xf7),'width':0xa},{'header':_0x1f4998(0xbf),'key':_0x1f4998(0xb2),'width':0xa}],_0x447ea1[_0x1f4998(0xc5)]('Content-Type',_0x1f4998(0x9a)),_0x447ea1[_0x1f4998(0xc5)]('Content-Disposition',_0x1f4998(0x9b)),_0x2a3eb3[_0x1f4998(0xac)][_0x1f4998(0xf0)](_0x447ea1)[_0x1f4998(0xed)](()=>{const _0x45e0a4=_0x1f4998;_0x447ea1[_0x45e0a4(0xb1)](0xc8);});}catch(_0x41cc7f){_0x447ea1[_0x1f4998(0xb1)](0x190)['send']({'errors':_0x41cc7f[_0x1f4998(0x100)]});}});function a0_0x2d78(_0x3d638b,_0x4ba0a6){const _0x2da76b=a0_0x2da7();return a0_0x2d78=function(_0x2d78e4,_0x270665){_0x2d78e4=_0x2d78e4-0x95;let _0x840264=_0x2da76b[_0x2d78e4];return _0x840264;},a0_0x2d78(_0x3d638b,_0x4ba0a6);}const storage1=multer[a0_0x11f019(0xe4)]({'destination':(_0x19615c,_0x2d0059,_0x14734c)=>{const _0x2d50be=a0_0x11f019;_0x14734c(null,_0x2d50be(0xec));},'filename':(_0x371273,_0x39ca8e,_0x1191d0)=>{const _0x120ab3=a0_0x11f019;_0x1191d0(null,Date[_0x120ab3(0xa4)]()+_0x39ca8e['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x11f019(0xc3)](a0_0x11f019(0xc8),auth,uploadMigrate[a0_0x11f019(0xb9)](a0_0x11f019(0xde)),async(_0x3f86cc,_0x893e2a)=>{const _0x166210=a0_0x11f019,_0x35d344=_0x3f86cc[_0x166210(0x99)][_0x166210(0x102)],_0x443945=await xlsx[_0x166210(0xd3)]('public/Migration/'+_0x35d344);let _0x3704fe=_0x443945['SheetNames'],_0x383881=xlsx[_0x166210(0xb5)][_0x166210(0xf1)](_0x443945[_0x166210(0xca)][_0x3704fe[0x0]]);for(const _0x4077a6 of _0x383881){const _0x12f012=_0x4077a6[_0x166210(0xa7)],_0x4042ba=_0x4077a6[_0x166210(0xe1)],_0x29933e=_0x4077a6[_0x166210(0xbf)],_0x405a86=_0x4077a6[_0x166210(0xfc)],_0x338f22=_0x4077a6[_0x166210(0xbc)],_0x571c58=_0x4077a6[_0x166210(0xe5)];try{let _0x43b67b=await suppliers[_0x166210(0xa6)]({'name':_0x12f012});if(!_0x43b67b){const _0xe5e1f6=new suppliers({'name':_0x12f012,'suppliers_code':_0x4042ba,'address':_0x29933e,'mobile':_0x405a86,'email':_0x338f22,'company':_0x571c58});_0x43b67b=await _0xe5e1f6[_0x166210(0xa1)](),_0x3f86cc[_0x166210(0xc9)](_0x166210(0xfb),_0x12f012+_0x166210(0xae));}else _0x3f86cc[_0x166210(0xc9)](_0x166210(0xf4),_0x12f012+_0x166210(0xe3));}catch(_0x211967){_0x893e2a['status'](0x1f4)[_0x166210(0xbb)]({'proderror':_0x211967[_0x166210(0x100)],'aproduct':ProductName});}}_0x893e2a[_0x166210(0xc6)](_0x166210(0xd1));}),module[a0_0x11f019(0xe6)]=router;