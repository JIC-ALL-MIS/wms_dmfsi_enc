const a0_0x35594d=a0_0x268a;(function(_0xd3c6d6,_0x378df4){const _0x161f0b=a0_0x268a,_0x5d2164=_0xd3c6d6();while(!![]){try{const _0x49c585=parseInt(_0x161f0b(0x1fd))/0x1+parseInt(_0x161f0b(0x22e))/0x2*(parseInt(_0x161f0b(0x200))/0x3)+-parseInt(_0x161f0b(0x1de))/0x4+parseInt(_0x161f0b(0x219))/0x5+-parseInt(_0x161f0b(0x227))/0x6*(parseInt(_0x161f0b(0x1dd))/0x7)+parseInt(_0x161f0b(0x20d))/0x8+-parseInt(_0x161f0b(0x1e4))/0x9;if(_0x49c585===_0x378df4)break;else _0x5d2164['push'](_0x5d2164['shift']());}catch(_0x244602){_0x5d2164['push'](_0x5d2164['shift']());}}}(a0_0x1a0e,0x595b2));const express=require(a0_0x35594d(0x207)),app=express(),router=express[a0_0x35594d(0x215)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x35594d(0x226)),auth=require('../middleware/auth'),users=require(a0_0x35594d(0x1d2)),excelJS=require('exceljs'),xlsx=require(a0_0x35594d(0x229)),multer=require(a0_0x35594d(0x22b));function a0_0x1a0e(){const _0x56790f=['landline','Customers','name','s_payments','originalname','5375016zIyCKy','json','Sheets','SalesmanName','Chinese','attachment;\x20filename=supplier_Migration_File.xlsx','German','readFile','Router','write','utils','amount','52345CxWXiC','sheet_to_json','user','/view/:id','then','findById','Mobile_number','receivable_sum','/products_export_migrate_file','Purchase','/view/payment/:id','params','suppliers_code','../models/all_models','8238AdEeBC','Email','xlsx','supplier','multer','columns','Portuguese','2362qiDSfl','$amount','/view','error','exports','Supplier_Code','Arabic','single','$reason','aggregate','/supplier/view','doc','errors','find','../public/language/languages.json','payable_sum','suppliers','PUnits','findOne','render','save','French','Company_Name','flash','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','2135JLtDwT','102060cmyTch','supplier_payment','Purchase\x20Return','public/Migration','redirect','Name','3839940vNiXuK','Hindi','Workbook','success','\x20Failed','email','forEach','English','send','master','get','body','/supplier_import_migrate_file','mobile','receivable','Content-Type','setHeader','address','purchase','English\x20(US)','supplier\x20data\x20add\x20successfully','Portuguese\x20(BR)','filename','language','message','279423YEOoGI','log','reason','699jqFhqU','supplier\x20data\x20update\x20successfully','Spanish','status','file','Arabic\x20(ae)','post','express'];a0_0x1a0e=function(){return _0x56790f;};return a0_0x1a0e();}function a0_0x268a(_0x332a1b,_0x29b393){const _0x1a0e14=a0_0x1a0e();return a0_0x268a=function(_0x268a09,_0x19df33){_0x268a09=_0x268a09-0x1cb;let _0x39c176=_0x1a0e14[_0x268a09];return _0x39c176;},a0_0x268a(_0x332a1b,_0x29b393);}router[a0_0x35594d(0x1ee)](a0_0x35594d(0x230),auth,async(_0x1295e9,_0x2e1d75)=>{const _0x20a500=a0_0x35594d;try{const {username:_0x3ab8df,email:_0x322ce1,role:_0x41f7a7}=_0x1295e9['user'],_0x1c965e=_0x1295e9[_0x20a500(0x21b)],_0x5e4b5e=await profile[_0x20a500(0x1d6)]({'email':_0x1c965e[_0x20a500(0x1e9)]}),_0x363cbc=await master_shop[_0x20a500(0x1d1)]();console[_0x20a500(0x1fe)](_0x20a500(0x1ed),_0x363cbc);const _0x5e6e47=await suppliers[_0x20a500(0x1d1)]();console[_0x20a500(0x1fe)](_0x5e6e47);const _0x1b49f7=await suppliers[_0x20a500(0x1cd)]([{'$lookup':{'from':_0x20a500(0x20b),'localField':_0x20a500(0x20a),'foreignField':_0x20a500(0x1d4),'as':'suppliers_docs'}}]),_0x47f4ed=_0x1b49f7['map'](_0x4c9ee0=>{const _0x5c8981=_0x20a500;console[_0x5c8981(0x1fe)]('data',_0x4c9ee0);var _0x480bad=0x0,_0x11ce6b=0x0;return _0x4c9ee0['suppliers_docs'][_0x5c8981(0x1ea)](_0x2efde5=>{const _0x57fca3=_0x5c8981;console[_0x57fca3(0x1fe)](_0x57fca3(0x1cf),_0x2efde5),_0x2efde5[_0x57fca3(0x1ff)]==_0x57fca3(0x222)?_0x480bad+=_0x2efde5['amount']:_0x11ce6b+=_0x2efde5[_0x57fca3(0x218)];}),_0x4c9ee0[_0x5c8981(0x1f6)]=_0x480bad,_0x4c9ee0['purchase_return']=_0x11ce6b,_0x4c9ee0;});console['log']('supplier.js\x20payment_data',_0x47f4ed);if(_0x363cbc[0x0]['language']==_0x20a500(0x1f7)){var _0x574b31=users[_0x20a500(0x1eb)];console[_0x20a500(0x1fe)](_0x574b31);}else{if(_0x363cbc[0x0][_0x20a500(0x1fb)]==_0x20a500(0x1e5))var _0x574b31=users['Hindi'];else{if(_0x363cbc[0x0]['language']==_0x20a500(0x213))var _0x574b31=users[_0x20a500(0x213)];else{if(_0x363cbc[0x0][_0x20a500(0x1fb)]==_0x20a500(0x202))var _0x574b31=users[_0x20a500(0x202)];else{if(_0x363cbc[0x0][_0x20a500(0x1fb)]==_0x20a500(0x1d9))var _0x574b31=users[_0x20a500(0x1d9)];else{if(_0x363cbc[0x0][_0x20a500(0x1fb)]=='Portuguese\x20(BR)')var _0x574b31=users[_0x20a500(0x22d)];else{if(_0x363cbc[0x0][_0x20a500(0x1fb)]==_0x20a500(0x211))var _0x574b31=users[_0x20a500(0x211)];else{if(_0x363cbc[0x0][_0x20a500(0x1fb)]=='Arabic\x20(ae)')var _0x574b31=users[_0x20a500(0x234)];}}}}}}}_0x2e1d75[_0x20a500(0x1d7)](_0x20a500(0x22a),{'success':_0x1295e9[_0x20a500(0x1db)](_0x20a500(0x1e7)),'errors':_0x1295e9[_0x20a500(0x1db)](_0x20a500(0x1d0)),'user':_0x5e6e47,'profile':_0x5e4b5e,'master_shop':_0x363cbc,'role':_0x1c965e,'payment':_0x47f4ed,'language':_0x574b31});}catch(_0xeb2636){console[_0x20a500(0x1fe)](_0xeb2636);}}),router[a0_0x35594d(0x206)](a0_0x35594d(0x230),auth,async(_0x200e81,_0x2f1adb)=>{const _0xffa422=a0_0x35594d;try{const {name:_0x3fdbe4,email:_0x59da2a,mobile:_0x20ea2c,company:_0x2453ff,address:_0x29fb84,receivable:_0x2602ca,payable:_0x38b27e,code:_0x1b2960,contactperson:_0x2d6602,landline:_0x4b6ef9}=_0x200e81['body'],_0x353233=new suppliers({'name':_0x3fdbe4,'email':_0x59da2a,'mobile':_0x20ea2c,'company':_0x2453ff,'address':_0x29fb84,'receivable':_0x2602ca,'payable':_0x38b27e,'suppliers_code':_0x1b2960,'contactperson':_0x2d6602,'landline':_0x4b6ef9}),_0x3cf02f=await _0x353233[_0xffa422(0x1d8)]();_0x200e81[_0xffa422(0x1db)]('success',_0xffa422(0x1f8)),_0x2f1adb[_0xffa422(0x1e2)](_0xffa422(0x1ce));}catch(_0x3b3fc9){console[_0xffa422(0x1fe)](_0x3b3fc9);}}),router['get'](a0_0x35594d(0x21c),auth,async(_0x1e1f36,_0x3ab7da)=>{const _0x3f016a=a0_0x35594d;try{const {username:_0x5825e3,email:_0x3e59d7,role:_0x43cdd9}=_0x1e1f36[_0x3f016a(0x21b)],_0x50e243=_0x1e1f36['user'],_0x4cdfca=await profile['findOne']({'email':_0x50e243['email']}),_0x4306c8=await master_shop['find']();console[_0x3f016a(0x1fe)](_0x3f016a(0x1ed),_0x4306c8);const _0x2d4cbc=_0x1e1f36['params']['id'],_0x28814b=await suppliers[_0x3f016a(0x21e)](_0x2d4cbc);console['log'](_0x28814b);if(_0x4306c8[0x0][_0x3f016a(0x1fb)]==_0x3f016a(0x1f7)){var _0x14f8da=users[_0x3f016a(0x1eb)];console[_0x3f016a(0x1fe)](_0x14f8da);}else{if(_0x4306c8[0x0]['language']==_0x3f016a(0x1e5))var _0x14f8da=users[_0x3f016a(0x1e5)];else{if(_0x4306c8[0x0]['language']==_0x3f016a(0x213))var _0x14f8da=users['German'];else{if(_0x4306c8[0x0][_0x3f016a(0x1fb)]==_0x3f016a(0x202))var _0x14f8da=users[_0x3f016a(0x202)];else{if(_0x4306c8[0x0][_0x3f016a(0x1fb)]==_0x3f016a(0x1d9))var _0x14f8da=users[_0x3f016a(0x1d9)];else{if(_0x4306c8[0x0][_0x3f016a(0x1fb)]==_0x3f016a(0x1f9))var _0x14f8da=users[_0x3f016a(0x22d)];else{if(_0x4306c8[0x0][_0x3f016a(0x1fb)]==_0x3f016a(0x211))var _0x14f8da=users[_0x3f016a(0x211)];else{if(_0x4306c8[0x0]['language']=='Arabic\x20(ae)')var _0x14f8da=users[_0x3f016a(0x234)];}}}}}}}_0x3ab7da['render'](_0x3f016a(0x22a),{'success':_0x1e1f36[_0x3f016a(0x1db)](_0x3f016a(0x1e7)),'errors':_0x1e1f36['flash']('errors'),'role':_0x50e243,'profile':_0x4cdfca,'master_shop':_0x4306c8,'user':_0x28814b,'language':_0x14f8da});}catch(_0x46118a){console[_0x3f016a(0x1fe)](_0x46118a);}}),router[a0_0x35594d(0x206)](a0_0x35594d(0x21c),auth,async(_0x1af5bc,_0x2e5efa)=>{const _0x37487b=a0_0x35594d;try{const _0x3c5633=_0x1af5bc[_0x37487b(0x224)]['id'],_0x46fcf8=await suppliers[_0x37487b(0x21e)](_0x3c5633),{name:_0x233293,email:_0x5a2773,mobile:_0x19d4a9,company:_0x16d2a2,address:_0x45f34c,receivable:_0x2a2519,payable:_0x4de464,code:_0x21e6ef,contactperson:_0x45bc5d,landline:_0x37e2c5}=_0x1af5bc[_0x37487b(0x1ef)];_0x46fcf8[_0x37487b(0x20a)]=_0x233293,_0x46fcf8[_0x37487b(0x1e9)]=_0x5a2773,_0x46fcf8[_0x37487b(0x1f1)]=_0x19d4a9,_0x46fcf8['company']=_0x16d2a2,_0x46fcf8['address']=_0x45f34c,_0x46fcf8[_0x37487b(0x1f2)]=_0x2a2519,_0x46fcf8['payable']=_0x4de464,_0x46fcf8[_0x37487b(0x225)]=_0x21e6ef,_0x46fcf8['contactperson']=_0x45bc5d,_0x46fcf8[_0x37487b(0x208)]=_0x37e2c5;const _0x18f53d=await _0x46fcf8[_0x37487b(0x1d8)]();_0x1af5bc[_0x37487b(0x1db)](_0x37487b(0x1e7),_0x37487b(0x201)),_0x2e5efa[_0x37487b(0x1e2)](_0x37487b(0x1ce));}catch(_0x30b1a9){console['log'](_0x30b1a9);}}),router['get'](a0_0x35594d(0x223),auth,async(_0x49d225,_0x14cbee)=>{const _0xd128bc=a0_0x35594d;try{const {username:_0x5ee28a,email:_0x1be501,role:_0x591f2c}=_0x49d225[_0xd128bc(0x21b)],_0x5545a5=_0x49d225[_0xd128bc(0x21b)],_0x487c8c=await profile[_0xd128bc(0x1d6)]({'email':_0x5545a5[_0xd128bc(0x1e9)]}),_0x520e02=await master_shop[_0xd128bc(0x1d1)]();console[_0xd128bc(0x1fe)](_0xd128bc(0x1ed),_0x520e02),console[_0xd128bc(0x1fe)](_0x49d225[_0xd128bc(0x224)]['id']);const _0xa2c8d7=await suppliers[_0xd128bc(0x1d6)]({'_id':_0x49d225[_0xd128bc(0x224)]['id']});console['log'](_0xa2c8d7);const _0x119d30=await s_payment_data['find']({'suppliers':_0xa2c8d7['name']});console[_0xd128bc(0x1fe)](_0x119d30);const _0x15ac7e=await s_payment_data[_0xd128bc(0x1cd)]([{'$match':{'suppliers':_0xa2c8d7[_0xd128bc(0x20a)]}},{'$match':{'reason':_0xd128bc(0x222)}},{'$group':{'_id':'$reason','sum':{'$sum':_0xd128bc(0x22f)}}}]);console['log'](_0xd128bc(0x1d3),_0x15ac7e);const _0x1d2eba=await s_payment_data[_0xd128bc(0x1cd)]([{'$match':{'suppliers':_0xa2c8d7[_0xd128bc(0x20a)]}},{'$match':{'reason':_0xd128bc(0x1e0)}},{'$group':{'_id':_0xd128bc(0x1cc),'sum':{'$sum':'$amount'}}}]);console[_0xd128bc(0x1fe)](_0xd128bc(0x220),_0x1d2eba);if(_0x520e02[0x0]['language']==_0xd128bc(0x1f7)){var _0xabd7ff=users['English'];console['log'](_0xabd7ff);}else{if(_0x520e02[0x0][_0xd128bc(0x1fb)]=='Hindi')var _0xabd7ff=users[_0xd128bc(0x1e5)];else{if(_0x520e02[0x0]['language']==_0xd128bc(0x213))var _0xabd7ff=users[_0xd128bc(0x213)];else{if(_0x520e02[0x0]['language']==_0xd128bc(0x202))var _0xabd7ff=users[_0xd128bc(0x202)];else{if(_0x520e02[0x0][_0xd128bc(0x1fb)]=='French')var _0xabd7ff=users[_0xd128bc(0x1d9)];else{if(_0x520e02[0x0]['language']==_0xd128bc(0x1f9))var _0xabd7ff=users[_0xd128bc(0x22d)];else{if(_0x520e02[0x0][_0xd128bc(0x1fb)]==_0xd128bc(0x211))var _0xabd7ff=users['Chinese'];else{if(_0x520e02[0x0][_0xd128bc(0x1fb)]==_0xd128bc(0x205))var _0xabd7ff=users['Arabic'];}}}}}}}_0x14cbee[_0xd128bc(0x1d7)](_0xd128bc(0x1df),{'success':_0x49d225[_0xd128bc(0x1db)](_0xd128bc(0x1e7)),'errors':_0x49d225[_0xd128bc(0x1db)](_0xd128bc(0x1d0)),'role':_0x5545a5,'profile':_0x487c8c,'master_shop':_0x520e02,'payment':_0x119d30,'payable':_0x15ac7e,'receivable':_0x1d2eba,'language':_0xabd7ff});}catch(_0x5d2436){console[_0xd128bc(0x1fe)](_0x5d2436);}}),router[a0_0x35594d(0x1ee)](a0_0x35594d(0x221),auth,async(_0x2ab8c9,_0x3c72ea)=>{const _0x1b7653=a0_0x35594d;try{const _0x356b79=new excelJS[(_0x1b7653(0x1e6))](),_0x4ad443=_0x356b79['addWorksheet'](_0x1b7653(0x209));return _0x4ad443[_0x1b7653(0x22c)]=[{'header':_0x1b7653(0x1e3),'key':'PBrands','width':0xa},{'header':_0x1b7653(0x233),'key':_0x1b7653(0x1d5),'width':0xa},{'header':_0x1b7653(0x228),'key':_0x1b7653(0x210),'width':0xa},{'header':_0x1b7653(0x21f),'key':_0x1b7653(0x1f5),'width':0xa},{'header':_0x1b7653(0x1da),'key':_0x1b7653(0x1f1),'width':0xa},{'header':_0x1b7653(0x1f5),'key':'email','width':0xa}],_0x3c72ea[_0x1b7653(0x1f4)](_0x1b7653(0x1f3),_0x1b7653(0x1dc)),_0x3c72ea['setHeader']('Content-Disposition',_0x1b7653(0x212)),_0x356b79[_0x1b7653(0x229)][_0x1b7653(0x216)](_0x3c72ea)[_0x1b7653(0x21d)](()=>{const _0x7b4f61=_0x1b7653;_0x3c72ea[_0x7b4f61(0x203)](0xc8);});}catch(_0x56d846){_0x3c72ea[_0x1b7653(0x203)](0x190)[_0x1b7653(0x1ec)]({'errors':_0x56d846[_0x1b7653(0x1fc)]});}});const storage1=multer['diskStorage']({'destination':(_0x20283f,_0x1791d1,_0x316393)=>{const _0x4dcd24=a0_0x35594d;_0x316393(null,_0x4dcd24(0x1e1));},'filename':(_0x55841e,_0x3ea97c,_0x1fb382)=>{const _0x53504a=a0_0x35594d;_0x1fb382(null,Date['now']()+_0x3ea97c[_0x53504a(0x20c)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x35594d(0x206)](a0_0x35594d(0x1f0),auth,uploadMigrate[a0_0x35594d(0x1cb)]('supplier_product_file'),async(_0x15f6e5,_0x7fb140)=>{const _0x3d9fee=a0_0x35594d,_0x131564=_0x15f6e5[_0x3d9fee(0x204)][_0x3d9fee(0x1fa)],_0x2906d8=await xlsx[_0x3d9fee(0x214)]('public/Migration/'+_0x131564);let _0x2944d0=_0x2906d8['SheetNames'],_0x3e0e6c=xlsx[_0x3d9fee(0x217)][_0x3d9fee(0x21a)](_0x2906d8[_0x3d9fee(0x20f)][_0x2944d0[0x0]]);for(const _0x3ba78a of _0x3e0e6c){const _0x3ac9fa=_0x3ba78a['Name'],_0x3035d8=_0x3ba78a[_0x3d9fee(0x233)],_0x53d6b7=_0x3ba78a[_0x3d9fee(0x1f5)],_0x2f0707=_0x3ba78a['Mobile_number'],_0x3fac83=_0x3ba78a['Email'],_0x192a7a=_0x3ba78a[_0x3d9fee(0x1da)];try{let _0xd7323e=await suppliers['findOne']({'name':_0x3ac9fa});if(!_0xd7323e){const _0x3ae68c=new suppliers({'name':_0x3ac9fa,'suppliers_code':_0x3035d8,'address':_0x53d6b7,'mobile':_0x2f0707,'email':_0x3fac83,'company':_0x192a7a});_0xd7323e=await _0x3ae68c[_0x3d9fee(0x1d8)](),_0x15f6e5[_0x3d9fee(0x1db)](_0x3d9fee(0x1e7),_0x3ac9fa+'\x20added\x20successfully');}else _0x15f6e5[_0x3d9fee(0x1db)](_0x3d9fee(0x231),_0x3ac9fa+_0x3d9fee(0x1e8));}catch(_0x29405d){_0x7fb140[_0x3d9fee(0x203)](0x1f4)[_0x3d9fee(0x20e)]({'proderror':_0x29405d['message'],'aproduct':ProductName});}}_0x7fb140['redirect'](_0x3d9fee(0x1ce));}),module[a0_0x35594d(0x232)]=router;