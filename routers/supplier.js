const a0_0x790f1c=a0_0xa1d2;(function(_0x5532e6,_0x4e7d01){const _0x47d4c9=a0_0xa1d2,_0x2e2a7d=_0x5532e6();while(!![]){try{const _0x54091b=-parseInt(_0x47d4c9(0xa2))/0x1*(parseInt(_0x47d4c9(0xd0))/0x2)+parseInt(_0x47d4c9(0xd1))/0x3*(-parseInt(_0x47d4c9(0xaf))/0x4)+-parseInt(_0x47d4c9(0xeb))/0x5*(-parseInt(_0x47d4c9(0x9c))/0x6)+-parseInt(_0x47d4c9(0xd7))/0x7+parseInt(_0x47d4c9(0xd8))/0x8+-parseInt(_0x47d4c9(0xf5))/0x9+-parseInt(_0x47d4c9(0xfb))/0xa*(-parseInt(_0x47d4c9(0x101))/0xb);if(_0x54091b===_0x4e7d01)break;else _0x2e2a7d['push'](_0x2e2a7d['shift']());}catch(_0x4ebc4d){_0x2e2a7d['push'](_0x2e2a7d['shift']());}}}(a0_0xf065,0x73a2f));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x790f1c(0xc7)),auth=require(a0_0x790f1c(0xd6)),users=require('../public/language/languages.json'),excelJS=require(a0_0x790f1c(0xfc)),xlsx=require(a0_0x790f1c(0xac)),multer=require(a0_0x790f1c(0xdc));router[a0_0x790f1c(0xe7)](a0_0x790f1c(0xe6),auth,async(_0x40e3b7,_0x523f0a)=>{const _0x1aa127=a0_0x790f1c;try{const {username:_0x5b6096,email:_0x3ff24d,role:_0x3055c6}=_0x40e3b7[_0x1aa127(0xf1)],_0x4aee20=_0x40e3b7[_0x1aa127(0xf1)],_0x50ba8f=await profile['findOne']({'email':_0x4aee20[_0x1aa127(0xed)]}),_0xcd411d=await master_shop[_0x1aa127(0xc6)]();console[_0x1aa127(0xe0)](_0x1aa127(0xae),_0xcd411d);const _0x1d813b=await suppliers[_0x1aa127(0xc6)]();console[_0x1aa127(0xe0)](_0x1d813b);const _0x92bbb0=await suppliers[_0x1aa127(0x9f)]([{'$lookup':{'from':_0x1aa127(0xc1),'localField':_0x1aa127(0x104),'foreignField':_0x1aa127(0xf4),'as':_0x1aa127(0xb4)}}]),_0x2ad938=_0x92bbb0[_0x1aa127(0xdf)](_0x1a43cd=>{const _0x21d615=_0x1aa127;console[_0x21d615(0xe0)](_0x21d615(0xd9),_0x1a43cd);var _0x1538b3=0x0,_0x1a5306=0x0;return _0x1a43cd['suppliers_docs'][_0x21d615(0xc2)](_0x261d0d=>{const _0x18a272=_0x21d615;console[_0x18a272(0xe0)](_0x18a272(0xbf),_0x261d0d),_0x261d0d[_0x18a272(0xbd)]==_0x18a272(0xe1)?_0x1538b3+=_0x261d0d[_0x18a272(0x10a)]:_0x1a5306+=_0x261d0d[_0x18a272(0x10a)];}),_0x1a43cd['purchase']=_0x1538b3,_0x1a43cd['purchase_return']=_0x1a5306,_0x1a43cd;});console[_0x1aa127(0xe0)](_0x1aa127(0x9d),_0x2ad938);if(_0xcd411d[0x0][_0x1aa127(0xa8)]==_0x1aa127(0x109)){var _0x5b4e27=users['English'];console[_0x1aa127(0xe0)](_0x5b4e27);}else{if(_0xcd411d[0x0][_0x1aa127(0xa8)]=='Hindi')var _0x5b4e27=users[_0x1aa127(0xb8)];else{if(_0xcd411d[0x0][_0x1aa127(0xa8)]==_0x1aa127(0x106))var _0x5b4e27=users[_0x1aa127(0x106)];else{if(_0xcd411d[0x0]['language']==_0x1aa127(0xf3))var _0x5b4e27=users[_0x1aa127(0xf3)];else{if(_0xcd411d[0x0][_0x1aa127(0xa8)]==_0x1aa127(0xa3))var _0x5b4e27=users[_0x1aa127(0xa3)];else{if(_0xcd411d[0x0][_0x1aa127(0xa8)]=='Portuguese\x20(BR)')var _0x5b4e27=users[_0x1aa127(0x107)];else{if(_0xcd411d[0x0][_0x1aa127(0xa8)]==_0x1aa127(0xfd))var _0x5b4e27=users[_0x1aa127(0xfd)];else{if(_0xcd411d[0x0]['language']=='Arabic\x20(ae)')var _0x5b4e27=users['Arabic'];}}}}}}}_0x523f0a['render'](_0x1aa127(0xe3),{'success':_0x40e3b7[_0x1aa127(0x10b)](_0x1aa127(0xb3)),'errors':_0x40e3b7[_0x1aa127(0x10b)](_0x1aa127(0xb0)),'user':_0x1d813b,'profile':_0x50ba8f,'master_shop':_0xcd411d,'role':_0x4aee20,'payment':_0x2ad938,'language':_0x5b4e27});}catch(_0x13b3ba){console[_0x1aa127(0xe0)](_0x13b3ba);}}),router[a0_0x790f1c(0xaa)]('/view',auth,async(_0x454c61,_0x1fa84d)=>{const _0xf863aa=a0_0x790f1c;try{const {name:_0x279945,email:_0xaed9d0,mobile:_0x1ca9f4,company:_0x3a559e,address:_0x50ff75,receivable:_0xf2dfb5,payable:_0x28d853,code:_0x83d1a8,contactperson:_0x5231b8,landline:_0x31e25b}=_0x454c61[_0xf863aa(0xad)],_0x5ad14b=new suppliers({'name':_0x279945,'email':_0xaed9d0,'mobile':_0x1ca9f4,'company':_0x3a559e,'address':_0x50ff75,'receivable':_0xf2dfb5,'payable':_0x28d853,'suppliers_code':_0x83d1a8,'contactperson':_0x5231b8,'landline':_0x31e25b}),_0x14ea2b=await _0x5ad14b['save']();_0x454c61[_0xf863aa(0x10b)](_0xf863aa(0xb3),'supplier\x20data\x20add\x20successfully'),_0x1fa84d['redirect'](_0xf863aa(0xcf));}catch(_0xbaa645){console[_0xf863aa(0xe0)](_0xbaa645);}}),router[a0_0x790f1c(0xe7)]('/view/:id',auth,async(_0x24f4a5,_0x2b7a17)=>{const _0x2abc77=a0_0x790f1c;try{const {username:_0x6b8d56,email:_0x1b38fa,role:_0x339f42}=_0x24f4a5['user'],_0x523b8f=_0x24f4a5[_0x2abc77(0xf1)],_0x26e0b5=await profile[_0x2abc77(0xda)]({'email':_0x523b8f['email']}),_0xe66fa7=await master_shop[_0x2abc77(0xc6)]();console[_0x2abc77(0xe0)](_0x2abc77(0xae),_0xe66fa7);const _0xa30482=_0x24f4a5['params']['id'],_0x13d5ef=await suppliers[_0x2abc77(0xb7)](_0xa30482);console[_0x2abc77(0xe0)](_0x13d5ef);if(_0xe66fa7[0x0][_0x2abc77(0xa8)]=='English\x20(US)'){var _0x2c7ccb=users[_0x2abc77(0xb6)];console['log'](_0x2c7ccb);}else{if(_0xe66fa7[0x0][_0x2abc77(0xa8)]==_0x2abc77(0xb8))var _0x2c7ccb=users[_0x2abc77(0xb8)];else{if(_0xe66fa7[0x0][_0x2abc77(0xa8)]==_0x2abc77(0x106))var _0x2c7ccb=users['German'];else{if(_0xe66fa7[0x0][_0x2abc77(0xa8)]==_0x2abc77(0xf3))var _0x2c7ccb=users['Spanish'];else{if(_0xe66fa7[0x0]['language']==_0x2abc77(0xa3))var _0x2c7ccb=users[_0x2abc77(0xa3)];else{if(_0xe66fa7[0x0]['language']==_0x2abc77(0xb9))var _0x2c7ccb=users['Portuguese'];else{if(_0xe66fa7[0x0][_0x2abc77(0xa8)]=='Chinese')var _0x2c7ccb=users['Chinese'];else{if(_0xe66fa7[0x0][_0x2abc77(0xa8)]==_0x2abc77(0xec))var _0x2c7ccb=users['Arabic'];}}}}}}}_0x2b7a17[_0x2abc77(0xe2)]('supplier',{'success':_0x24f4a5[_0x2abc77(0x10b)](_0x2abc77(0xb3)),'errors':_0x24f4a5['flash']('errors'),'role':_0x523b8f,'profile':_0x26e0b5,'master_shop':_0xe66fa7,'user':_0x13d5ef,'language':_0x2c7ccb});}catch(_0x58cdad){console['log'](_0x58cdad);}}),router[a0_0x790f1c(0xaa)]('/view/:id',auth,async(_0x5d0275,_0x3b2c5f)=>{const _0x59ecfc=a0_0x790f1c;try{const _0x41aea0=_0x5d0275['params']['id'],_0x3dd60c=await suppliers[_0x59ecfc(0xb7)](_0x41aea0),{name:_0x171fdd,email:_0x546110,mobile:_0xb1a54f,company:_0x1b4bbe,address:_0xcf6575,receivable:_0x40b568,payable:_0x5eaeb9,code:_0x34efcd,contactperson:_0x5b24a7,landline:_0x319e41}=_0x5d0275['body'];_0x3dd60c['name']=_0x171fdd,_0x3dd60c[_0x59ecfc(0xed)]=_0x546110,_0x3dd60c['mobile']=_0xb1a54f,_0x3dd60c[_0x59ecfc(0xb5)]=_0x1b4bbe,_0x3dd60c[_0x59ecfc(0xe9)]=_0xcf6575,_0x3dd60c[_0x59ecfc(0x100)]=_0x40b568,_0x3dd60c[_0x59ecfc(0xff)]=_0x5eaeb9,_0x3dd60c[_0x59ecfc(0xf8)]=_0x34efcd,_0x3dd60c[_0x59ecfc(0xa6)]=_0x5b24a7,_0x3dd60c[_0x59ecfc(0xbc)]=_0x319e41;const _0x2b9ca5=await _0x3dd60c['save']();_0x5d0275['flash'](_0x59ecfc(0xb3),_0x59ecfc(0xf6)),_0x3b2c5f['redirect'](_0x59ecfc(0xcf));}catch(_0xccb056){console['log'](_0xccb056);}}),router[a0_0x790f1c(0xe7)](a0_0x790f1c(0xd3),auth,async(_0x27dcc0,_0x6b15a6)=>{const _0x69c64e=a0_0x790f1c;try{const {username:_0x5661cc,email:_0x5a31c8,role:_0x102e3d}=_0x27dcc0[_0x69c64e(0xf1)],_0x3d4885=_0x27dcc0[_0x69c64e(0xf1)],_0xa2d502=await profile['findOne']({'email':_0x3d4885[_0x69c64e(0xed)]}),_0x20db85=await master_shop[_0x69c64e(0xc6)]();console[_0x69c64e(0xe0)](_0x69c64e(0xae),_0x20db85),console['log'](_0x27dcc0[_0x69c64e(0xa9)]['id']);const _0x383546=await suppliers[_0x69c64e(0xda)]({'_id':_0x27dcc0[_0x69c64e(0xa9)]['id']});console[_0x69c64e(0xe0)](_0x383546);const _0x3d5523=await s_payment_data[_0x69c64e(0xc6)]({'suppliers':_0x383546[_0x69c64e(0x104)]});console[_0x69c64e(0xe0)](_0x3d5523);const _0x4e0a12=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x383546[_0x69c64e(0x104)]}},{'$match':{'reason':_0x69c64e(0xe1)}},{'$group':{'_id':_0x69c64e(0x103),'sum':{'$sum':_0x69c64e(0xb1)}}}]);console[_0x69c64e(0xe0)](_0x69c64e(0xdb),_0x4e0a12);const _0x38e079=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x383546[_0x69c64e(0x104)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x69c64e(0x103),'sum':{'$sum':_0x69c64e(0xb1)}}}]);console['log'](_0x69c64e(0xa0),_0x38e079);if(_0x20db85[0x0][_0x69c64e(0xa8)]==_0x69c64e(0x109)){var _0x5ad2e4=users[_0x69c64e(0xb6)];console[_0x69c64e(0xe0)](_0x5ad2e4);}else{if(_0x20db85[0x0][_0x69c64e(0xa8)]==_0x69c64e(0xb8))var _0x5ad2e4=users['Hindi'];else{if(_0x20db85[0x0][_0x69c64e(0xa8)]==_0x69c64e(0x106))var _0x5ad2e4=users[_0x69c64e(0x106)];else{if(_0x20db85[0x0][_0x69c64e(0xa8)]==_0x69c64e(0xf3))var _0x5ad2e4=users['Spanish'];else{if(_0x20db85[0x0][_0x69c64e(0xa8)]==_0x69c64e(0xa3))var _0x5ad2e4=users[_0x69c64e(0xa3)];else{if(_0x20db85[0x0][_0x69c64e(0xa8)]=='Portuguese\x20(BR)')var _0x5ad2e4=users['Portuguese'];else{if(_0x20db85[0x0][_0x69c64e(0xa8)]=='Chinese')var _0x5ad2e4=users['Chinese'];else{if(_0x20db85[0x0][_0x69c64e(0xa8)]==_0x69c64e(0xec))var _0x5ad2e4=users['Arabic'];}}}}}}}_0x6b15a6['render'](_0x69c64e(0xe8),{'success':_0x27dcc0[_0x69c64e(0x10b)](_0x69c64e(0xb3)),'errors':_0x27dcc0[_0x69c64e(0x10b)](_0x69c64e(0xb0)),'role':_0x3d4885,'profile':_0xa2d502,'master_shop':_0x20db85,'payment':_0x3d5523,'payable':_0x4e0a12,'receivable':_0x38e079,'language':_0x5ad2e4});}catch(_0xcf85ee){console['log'](_0xcf85ee);}}),router[a0_0x790f1c(0xe7)](a0_0x790f1c(0x10c),auth,async(_0xed0f8d,_0x20d386)=>{const _0x194f82=a0_0x790f1c;try{const _0xd4cdad=new excelJS[(_0x194f82(0xbb))](),_0x3fdbe7=_0xd4cdad[_0x194f82(0xcc)]('Customers');return _0x3fdbe7[_0x194f82(0xfe)]=[{'header':_0x194f82(0xc5),'key':_0x194f82(0xcb),'width':0xa},{'header':_0x194f82(0x108),'key':_0x194f82(0xb2),'width':0xa},{'header':'Email','key':_0x194f82(0xf9),'width':0xa},{'header':'Mobile_number','key':_0x194f82(0xe9),'width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':_0x194f82(0xe9),'key':_0x194f82(0xed),'width':0xa}],_0x20d386[_0x194f82(0xba)](_0x194f82(0xee),_0x194f82(0xcd)),_0x20d386[_0x194f82(0xba)](_0x194f82(0xd4),_0x194f82(0xe5)),_0xd4cdad['xlsx'][_0x194f82(0xdd)](_0x20d386)[_0x194f82(0x105)](()=>{const _0x3d1761=_0x194f82;_0x20d386[_0x3d1761(0x102)](0xc8);});}catch(_0x56d906){_0x20d386[_0x194f82(0x102)](0x190)[_0x194f82(0xd2)]({'errors':_0x56d906[_0x194f82(0xc9)]});}});const storage1=multer[a0_0x790f1c(0xa4)]({'destination':(_0x418129,_0x57f43a,_0x53e852)=>{const _0x4dbe73=a0_0x790f1c;_0x53e852(null,_0x4dbe73(0xd5));},'filename':(_0x2bcf3a,_0x50bc43,_0x428ce4)=>{const _0x2dd585=a0_0x790f1c;_0x428ce4(null,Date[_0x2dd585(0xef)]()+_0x50bc43[_0x2dd585(0xc4)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x790f1c(0xca),auth,uploadMigrate[a0_0x790f1c(0xa7)](a0_0x790f1c(0xc0)),async(_0x3630d9,_0x208d33)=>{const _0x5d3974=a0_0x790f1c,_0x11d200=_0x3630d9[_0x5d3974(0xea)][_0x5d3974(0xf7)],_0x35e13c=await xlsx['readFile'](_0x5d3974(0xab)+_0x11d200);let _0x4905b9=_0x35e13c[_0x5d3974(0xde)],_0x544575=xlsx[_0x5d3974(0xbe)][_0x5d3974(0xa1)](_0x35e13c[_0x5d3974(0xc8)][_0x4905b9[0x0]]);for(const _0x1bc893 of _0x544575){const _0x36cc33=_0x1bc893[_0x5d3974(0xc5)],_0x2f737a=_0x1bc893[_0x5d3974(0x108)],_0x3919f2=_0x1bc893['address'],_0x468f39=_0x1bc893[_0x5d3974(0xe4)],_0x44a367=_0x1bc893[_0x5d3974(0x9e)],_0x542738=_0x1bc893[_0x5d3974(0xce)];try{let _0xdbfccf=await suppliers[_0x5d3974(0xda)]({'name':_0x36cc33});if(!_0xdbfccf){const _0x21c10d=new suppliers({'name':_0x36cc33,'suppliers_code':_0x2f737a,'address':_0x3919f2,'mobile':_0x468f39,'email':_0x44a367,'company':_0x542738});_0xdbfccf=await _0x21c10d['save'](),_0x3630d9[_0x5d3974(0x10b)](_0x5d3974(0xb3),_0x36cc33+_0x5d3974(0xc3));}else _0x3630d9['flash'](_0x5d3974(0xf2),_0x36cc33+_0x5d3974(0xfa));}catch(_0x288f2d){_0x208d33[_0x5d3974(0x102)](0x1f4)[_0x5d3974(0xf0)]({'proderror':_0x288f2d[_0x5d3974(0xc9)],'aproduct':ProductName});}}_0x208d33[_0x5d3974(0xa5)]('/supplier/view');}),module['exports']=router;function a0_0xa1d2(_0x1fb252,_0x20902b){const _0xf065dd=a0_0xf065();return a0_0xa1d2=function(_0xa1d2c4,_0x32d7b3){_0xa1d2c4=_0xa1d2c4-0x9c;let _0x284bf0=_0xf065dd[_0xa1d2c4];return _0x284bf0;},a0_0xa1d2(_0x1fb252,_0x20902b);}function a0_0xf065(){const _0x377ef0=['body','master','824zdjaqa','errors','$amount','PUnits','success','suppliers_docs','company','English','findById','Hindi','Portuguese\x20(BR)','setHeader','Workbook','landline','reason','utils','doc','supplier_product_file','s_payments','forEach','\x20added\x20successfully','originalname','Name','find','../models/all_models','Sheets','message','/supplier_import_migrate_file','PBrands','addWorksheet','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Company_Name','/supplier/view','2ZVkqxT','2553zjlbiW','send','/view/payment/:id','Content-Disposition','public/Migration','../middleware/auth','865669BShznL','1449504xTeMsZ','data','findOne','payable_sum','multer','write','SheetNames','map','log','Purchase','render','supplier','Mobile_number','attachment;\x20filename=supplier_Migration_File.xlsx','/view','get','supplier_payment','address','file','25JXzcWg','Arabic\x20(ae)','email','Content-Type','now','json','user','error','Spanish','suppliers','1151523UoQmiR','supplier\x20data\x20update\x20successfully','filename','suppliers_code','SalesmanName','\x20Failed','81670owLfHS','exceljs','Chinese','columns','payable','receivable','594lGSPro','status','$reason','name','then','German','Portuguese','Supplier_Code','English\x20(US)','amount','flash','/products_export_migrate_file','792942nEsRCw','supplier.js\x20payment_data','Email','aggregate','receivable_sum','sheet_to_json','382424jJXogM','French','diskStorage','redirect','contactperson','single','language','params','post','public/Migration/','xlsx'];a0_0xf065=function(){return _0x377ef0;};return a0_0xf065();}