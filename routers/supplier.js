const a0_0x3b4f72=a0_0x4445;(function(_0xf56d4b,_0x1af13d){const _0x55c5d5=a0_0x4445,_0x1fb231=_0xf56d4b();while(!![]){try{const _0x21a83f=-parseInt(_0x55c5d5(0x216))/0x1+parseInt(_0x55c5d5(0x249))/0x2+parseInt(_0x55c5d5(0x1f7))/0x3+-parseInt(_0x55c5d5(0x239))/0x4*(-parseInt(_0x55c5d5(0x1ed))/0x5)+parseInt(_0x55c5d5(0x1fa))/0x6*(-parseInt(_0x55c5d5(0x232))/0x7)+-parseInt(_0x55c5d5(0x1e4))/0x8+parseInt(_0x55c5d5(0x23e))/0x9*(parseInt(_0x55c5d5(0x236))/0xa);if(_0x21a83f===_0x1af13d)break;else _0x1fb231['push'](_0x1fb231['shift']());}catch(_0x470112){_0x1fb231['push'](_0x1fb231['shift']());}}}(a0_0x4723,0xc2b4e));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x3b4f72(0x1f6)),auth=require(a0_0x3b4f72(0x1e8)),users=require(a0_0x3b4f72(0x23a)),excelJS=require(a0_0x3b4f72(0x22b)),xlsx=require(a0_0x3b4f72(0x1e5)),multer=require(a0_0x3b4f72(0x1f1));function a0_0x4445(_0x25ab42,_0x2051eb){const _0x4723c3=a0_0x4723();return a0_0x4445=function(_0x444562,_0x18fda4){_0x444562=_0x444562-0x1de;let _0x417e05=_0x4723c3[_0x444562];return _0x417e05;},a0_0x4445(_0x25ab42,_0x2051eb);}router[a0_0x3b4f72(0x1f4)](a0_0x3b4f72(0x1e9),auth,async(_0x4369e2,_0x3d4408)=>{const _0x1e31bc=a0_0x3b4f72;try{const {username:_0x1d3bd6,email:_0xe7cc06,role:_0x549e67}=_0x4369e2[_0x1e31bc(0x21d)],_0x207561=_0x4369e2[_0x1e31bc(0x21d)],_0x2cc4d4=await profile[_0x1e31bc(0x231)]({'email':_0x207561[_0x1e31bc(0x209)]}),_0x1889a0=await master_shop[_0x1e31bc(0x22a)]();console[_0x1e31bc(0x238)]('master',_0x1889a0);const _0x3d954b=await suppliers[_0x1e31bc(0x22a)]();console[_0x1e31bc(0x238)](_0x3d954b);const _0x4a5dae=await suppliers[_0x1e31bc(0x1f2)]([{'$lookup':{'from':'s_payments','localField':_0x1e31bc(0x204),'foreignField':_0x1e31bc(0x247),'as':'suppliers_docs'}}]),_0x1cdb29=_0x4a5dae[_0x1e31bc(0x1e6)](_0x56b064=>{const _0xdbd14d=_0x1e31bc;console[_0xdbd14d(0x238)](_0xdbd14d(0x230),_0x56b064);var _0x14a60f=0x0,_0x25e27b=0x0;return _0x56b064[_0xdbd14d(0x1fd)][_0xdbd14d(0x22c)](_0x3bab52=>{const _0x2b9503=_0xdbd14d;console[_0x2b9503(0x238)](_0x2b9503(0x218),_0x3bab52),_0x3bab52['reason']==_0x2b9503(0x207)?_0x14a60f+=_0x3bab52[_0x2b9503(0x1f3)]:_0x25e27b+=_0x3bab52['amount'];}),_0x56b064[_0xdbd14d(0x21a)]=_0x14a60f,_0x56b064[_0xdbd14d(0x20f)]=_0x25e27b,_0x56b064;});console[_0x1e31bc(0x238)]('supplier.js\x20payment_data',_0x1cdb29);if(_0x1889a0[0x0][_0x1e31bc(0x228)]==_0x1e31bc(0x1fb)){var _0x17266a=users[_0x1e31bc(0x20b)];console[_0x1e31bc(0x238)](_0x17266a);}else{if(_0x1889a0[0x0][_0x1e31bc(0x228)]=='Hindi')var _0x17266a=users[_0x1e31bc(0x244)];else{if(_0x1889a0[0x0]['language']==_0x1e31bc(0x229))var _0x17266a=users[_0x1e31bc(0x229)];else{if(_0x1889a0[0x0][_0x1e31bc(0x228)]==_0x1e31bc(0x1df))var _0x17266a=users[_0x1e31bc(0x1df)];else{if(_0x1889a0[0x0]['language']==_0x1e31bc(0x224))var _0x17266a=users[_0x1e31bc(0x224)];else{if(_0x1889a0[0x0][_0x1e31bc(0x228)]==_0x1e31bc(0x20a))var _0x17266a=users['Portuguese'];else{if(_0x1889a0[0x0][_0x1e31bc(0x228)]==_0x1e31bc(0x246))var _0x17266a=users[_0x1e31bc(0x246)];else{if(_0x1889a0[0x0][_0x1e31bc(0x228)]==_0x1e31bc(0x220))var _0x17266a=users[_0x1e31bc(0x24c)];}}}}}}}_0x3d4408[_0x1e31bc(0x211)]('supplier',{'success':_0x4369e2['flash'](_0x1e31bc(0x21e)),'errors':_0x4369e2['flash'](_0x1e31bc(0x234)),'user':_0x3d954b,'profile':_0x2cc4d4,'master_shop':_0x1889a0,'role':_0x207561,'payment':_0x1cdb29,'language':_0x17266a});}catch(_0x11c3bc){console['log'](_0x11c3bc);}}),router[a0_0x3b4f72(0x20e)](a0_0x3b4f72(0x1e9),auth,async(_0x4a27db,_0x213c75)=>{const _0x4a54e4=a0_0x3b4f72;try{const {name:_0x518a29,email:_0x27d57f,mobile:_0x432ba0,company:_0x45e3cf,address:_0x1765c8,receivable:_0x270cba,payable:_0x4d6d4d,code:_0x5d353e,contactperson:_0x2f32bb,landline:_0x29501b}=_0x4a27db[_0x4a54e4(0x227)],_0xeec78=new suppliers({'name':_0x518a29,'email':_0x27d57f,'mobile':_0x432ba0,'company':_0x45e3cf,'address':_0x1765c8,'receivable':_0x270cba,'payable':_0x4d6d4d,'suppliers_code':_0x5d353e,'contactperson':_0x2f32bb,'landline':_0x29501b}),_0x5c3cf0=await _0xeec78[_0x4a54e4(0x21c)]();_0x4a27db[_0x4a54e4(0x22f)](_0x4a54e4(0x21e),_0x4a54e4(0x24d)),_0x213c75['redirect']('/supplier/view');}catch(_0x45485e){console[_0x4a54e4(0x238)](_0x45485e);}}),router['get'](a0_0x3b4f72(0x222),auth,async(_0x46c0ad,_0x3253f7)=>{const _0xa10d74=a0_0x3b4f72;try{const {username:_0x22f7f4,email:_0x15e1da,role:_0x21c5c0}=_0x46c0ad['user'],_0x2cda76=_0x46c0ad[_0xa10d74(0x21d)],_0xbbd853=await profile[_0xa10d74(0x231)]({'email':_0x2cda76[_0xa10d74(0x209)]}),_0x57294d=await master_shop[_0xa10d74(0x22a)]();console[_0xa10d74(0x238)](_0xa10d74(0x245),_0x57294d);const _0xdf16ab=_0x46c0ad[_0xa10d74(0x1ec)]['id'],_0x452098=await suppliers['findById'](_0xdf16ab);console[_0xa10d74(0x238)](_0x452098);if(_0x57294d[0x0][_0xa10d74(0x228)]==_0xa10d74(0x1fb)){var _0x5e02a4=users[_0xa10d74(0x20b)];console['log'](_0x5e02a4);}else{if(_0x57294d[0x0][_0xa10d74(0x228)]=='Hindi')var _0x5e02a4=users[_0xa10d74(0x244)];else{if(_0x57294d[0x0][_0xa10d74(0x228)]=='German')var _0x5e02a4=users[_0xa10d74(0x229)];else{if(_0x57294d[0x0][_0xa10d74(0x228)]=='Spanish')var _0x5e02a4=users[_0xa10d74(0x1df)];else{if(_0x57294d[0x0]['language']=='French')var _0x5e02a4=users[_0xa10d74(0x224)];else{if(_0x57294d[0x0]['language']==_0xa10d74(0x20a))var _0x5e02a4=users['Portuguese'];else{if(_0x57294d[0x0][_0xa10d74(0x228)]=='Chinese')var _0x5e02a4=users[_0xa10d74(0x246)];else{if(_0x57294d[0x0][_0xa10d74(0x228)]==_0xa10d74(0x220))var _0x5e02a4=users[_0xa10d74(0x24c)];}}}}}}}_0x3253f7[_0xa10d74(0x211)](_0xa10d74(0x212),{'success':_0x46c0ad['flash'](_0xa10d74(0x21e)),'errors':_0x46c0ad[_0xa10d74(0x22f)](_0xa10d74(0x234)),'role':_0x2cda76,'profile':_0xbbd853,'master_shop':_0x57294d,'user':_0x452098,'language':_0x5e02a4});}catch(_0x36bb39){console[_0xa10d74(0x238)](_0x36bb39);}}),router[a0_0x3b4f72(0x20e)]('/view/:id',auth,async(_0x5a3d89,_0x397a8b)=>{const _0x467c69=a0_0x3b4f72;try{const _0x109af8=_0x5a3d89[_0x467c69(0x1ec)]['id'],_0x3c76e8=await suppliers[_0x467c69(0x22e)](_0x109af8),{name:_0x363fc8,email:_0x17f219,mobile:_0x57071c,company:_0x241105,address:_0x1e11aa,receivable:_0x45ca34,payable:_0x7c9da9,code:_0x39637b,contactperson:_0x5c8a10,landline:_0x1792a5}=_0x5a3d89['body'];_0x3c76e8[_0x467c69(0x204)]=_0x363fc8,_0x3c76e8[_0x467c69(0x209)]=_0x17f219,_0x3c76e8[_0x467c69(0x1de)]=_0x57071c,_0x3c76e8[_0x467c69(0x205)]=_0x241105,_0x3c76e8['address']=_0x1e11aa,_0x3c76e8[_0x467c69(0x235)]=_0x45ca34,_0x3c76e8[_0x467c69(0x243)]=_0x7c9da9,_0x3c76e8[_0x467c69(0x1ea)]=_0x39637b,_0x3c76e8[_0x467c69(0x23d)]=_0x5c8a10,_0x3c76e8[_0x467c69(0x223)]=_0x1792a5;const _0x3c61d6=await _0x3c76e8[_0x467c69(0x21c)]();_0x5a3d89[_0x467c69(0x22f)](_0x467c69(0x21e),_0x467c69(0x1e0)),_0x397a8b[_0x467c69(0x221)](_0x467c69(0x210));}catch(_0x5b4f52){console[_0x467c69(0x238)](_0x5b4f52);}}),router[a0_0x3b4f72(0x1f4)](a0_0x3b4f72(0x23c),auth,async(_0x44381e,_0x38d1b4)=>{const _0x430666=a0_0x3b4f72;try{const {username:_0x462445,email:_0x89784d,role:_0x28859c}=_0x44381e[_0x430666(0x21d)],_0x1863a1=_0x44381e[_0x430666(0x21d)],_0x12666f=await profile[_0x430666(0x231)]({'email':_0x1863a1[_0x430666(0x209)]}),_0x503ff0=await master_shop['find']();console[_0x430666(0x238)](_0x430666(0x245),_0x503ff0),console[_0x430666(0x238)](_0x44381e['params']['id']);const _0x2d19a8=await suppliers[_0x430666(0x231)]({'_id':_0x44381e[_0x430666(0x1ec)]['id']});console[_0x430666(0x238)](_0x2d19a8);const _0x53cb14=await s_payment_data[_0x430666(0x22a)]({'suppliers':_0x2d19a8['name']});console['log'](_0x53cb14);const _0x237d7c=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x2d19a8[_0x430666(0x204)]}},{'$match':{'reason':_0x430666(0x207)}},{'$group':{'_id':_0x430666(0x208),'sum':{'$sum':'$amount'}}}]);console[_0x430666(0x238)](_0x430666(0x1f8),_0x237d7c);const _0xb73fbc=await s_payment_data[_0x430666(0x1f2)]([{'$match':{'suppliers':_0x2d19a8[_0x430666(0x204)]}},{'$match':{'reason':_0x430666(0x1e2)}},{'$group':{'_id':_0x430666(0x208),'sum':{'$sum':_0x430666(0x1e1)}}}]);console[_0x430666(0x238)](_0x430666(0x23f),_0xb73fbc);if(_0x503ff0[0x0]['language']==_0x430666(0x1fb)){var _0x4fc00f=users['English'];console[_0x430666(0x238)](_0x4fc00f);}else{if(_0x503ff0[0x0]['language']=='Hindi')var _0x4fc00f=users[_0x430666(0x244)];else{if(_0x503ff0[0x0][_0x430666(0x228)]==_0x430666(0x229))var _0x4fc00f=users['German'];else{if(_0x503ff0[0x0][_0x430666(0x228)]==_0x430666(0x1df))var _0x4fc00f=users[_0x430666(0x1df)];else{if(_0x503ff0[0x0][_0x430666(0x228)]==_0x430666(0x224))var _0x4fc00f=users[_0x430666(0x224)];else{if(_0x503ff0[0x0][_0x430666(0x228)]=='Portuguese\x20(BR)')var _0x4fc00f=users[_0x430666(0x202)];else{if(_0x503ff0[0x0][_0x430666(0x228)]==_0x430666(0x246))var _0x4fc00f=users[_0x430666(0x246)];else{if(_0x503ff0[0x0][_0x430666(0x228)]==_0x430666(0x220))var _0x4fc00f=users[_0x430666(0x24c)];}}}}}}}_0x38d1b4[_0x430666(0x211)](_0x430666(0x201),{'success':_0x44381e[_0x430666(0x22f)]('success'),'errors':_0x44381e[_0x430666(0x22f)](_0x430666(0x234)),'role':_0x1863a1,'profile':_0x12666f,'master_shop':_0x503ff0,'payment':_0x53cb14,'payable':_0x237d7c,'receivable':_0xb73fbc,'language':_0x4fc00f});}catch(_0x384eca){console[_0x430666(0x238)](_0x384eca);}}),router[a0_0x3b4f72(0x1f4)]('/products_export_migrate_file',auth,async(_0xa85953,_0x49ef6b)=>{const _0x4c5188=a0_0x3b4f72;try{const _0x4145b0=new excelJS[(_0x4c5188(0x24b))](),_0x4f0c5d=_0x4145b0[_0x4c5188(0x24a)](_0x4c5188(0x237));return _0x4f0c5d[_0x4c5188(0x22d)]=[{'header':_0x4c5188(0x217),'key':_0x4c5188(0x1eb),'width':0xa},{'header':_0x4c5188(0x225),'key':_0x4c5188(0x21b),'width':0xa},{'header':'Email','key':_0x4c5188(0x1fc),'width':0xa},{'header':'Mobile_number','key':_0x4c5188(0x21f),'width':0xa},{'header':_0x4c5188(0x248),'key':_0x4c5188(0x1de),'width':0xa},{'header':_0x4c5188(0x21f),'key':_0x4c5188(0x209),'width':0xa}],_0x49ef6b[_0x4c5188(0x226)](_0x4c5188(0x1f0),_0x4c5188(0x1ef)),_0x49ef6b[_0x4c5188(0x226)](_0x4c5188(0x240),_0x4c5188(0x1f9)),_0x4145b0[_0x4c5188(0x1e5)]['write'](_0x49ef6b)[_0x4c5188(0x200)](()=>{const _0x462fde=_0x4c5188;_0x49ef6b[_0x462fde(0x20d)](0xc8);});}catch(_0x1d7b8e){_0x49ef6b[_0x4c5188(0x20d)](0x190)[_0x4c5188(0x214)]({'errors':_0x1d7b8e['message']});}});const storage1=multer[a0_0x3b4f72(0x20c)]({'destination':(_0x4b5188,_0x3bc73d,_0x4ebe9d)=>{const _0xf95b58=a0_0x3b4f72;_0x4ebe9d(null,_0xf95b58(0x23b));},'filename':(_0x592c88,_0x16f113,_0x15209a)=>{_0x15209a(null,Date['now']()+_0x16f113['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x3b4f72(0x20e)](a0_0x3b4f72(0x213),auth,uploadMigrate[a0_0x3b4f72(0x206)](a0_0x3b4f72(0x215)),async(_0x12a97f,_0x579be0)=>{const _0x1e87f1=a0_0x3b4f72,_0x1027c8=_0x12a97f[_0x1e87f1(0x1e7)][_0x1e87f1(0x1e3)],_0x560794=await xlsx['readFile'](_0x1e87f1(0x233)+_0x1027c8);let _0x6eaf85=_0x560794[_0x1e87f1(0x242)],_0x256d95=xlsx[_0x1e87f1(0x1fe)]['sheet_to_json'](_0x560794[_0x1e87f1(0x1f5)][_0x6eaf85[0x0]]);for(const _0x53800e of _0x256d95){const _0x30d4fe=_0x53800e[_0x1e87f1(0x217)],_0x3fd3c0=_0x53800e['Supplier_Code'],_0x2fd891=_0x53800e[_0x1e87f1(0x21f)],_0x4ac1b0=_0x53800e['Mobile_number'],_0x524e4c=_0x53800e[_0x1e87f1(0x1ee)],_0x57c5db=_0x53800e['Company_Name'];try{let _0x435e6a=await suppliers[_0x1e87f1(0x231)]({'name':_0x30d4fe});if(!_0x435e6a){const _0x409355=new suppliers({'name':_0x30d4fe,'suppliers_code':_0x3fd3c0,'address':_0x2fd891,'mobile':_0x4ac1b0,'email':_0x524e4c,'company':_0x57c5db});_0x435e6a=await _0x409355[_0x1e87f1(0x21c)](),_0x12a97f['flash'](_0x1e87f1(0x21e),_0x30d4fe+'\x20added\x20successfully');}else _0x12a97f['flash']('error',_0x30d4fe+_0x1e87f1(0x203));}catch(_0x188204){_0x579be0[_0x1e87f1(0x20d)](0x1f4)[_0x1e87f1(0x219)]({'proderror':_0x188204[_0x1e87f1(0x1ff)],'aproduct':ProductName});}}_0x579be0[_0x1e87f1(0x221)](_0x1e87f1(0x210));}),module[a0_0x3b4f72(0x241)]=router;function a0_0x4723(){const _0x4089c4=['English','diskStorage','status','post','purchase_return','/supplier/view','render','supplier','/supplier_import_migrate_file','send','supplier_product_file','1049019FNENzn','Name','doc','json','purchase','PUnits','save','user','success','address','Arabic\x20(ae)','redirect','/view/:id','landline','French','Supplier_Code','setHeader','body','language','German','find','exceljs','forEach','columns','findById','flash','data','findOne','5775xJLwQx','public/Migration/','errors','receivable','1880CtKIug','Customers','log','637508zKzIbO','../public/language/languages.json','public/Migration','/view/payment/:id','contactperson','4581sAIcGZ','receivable_sum','Content-Disposition','exports','SheetNames','payable','Hindi','master','Chinese','suppliers','Company_Name','2951882ECEFhM','addWorksheet','Workbook','Arabic','supplier\x20data\x20add\x20successfully','mobile','Spanish','supplier\x20data\x20update\x20successfully','$amount','Purchase\x20Return','filename','8344920ZeFUtR','xlsx','map','file','../middleware/auth','/view','suppliers_code','PBrands','params','40oCOhfM','Email','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Content-Type','multer','aggregate','amount','get','Sheets','../models/all_models','1156134wRcLPK','payable_sum','attachment;\x20filename=supplier_Migration_File.xlsx','2490dZZJoJ','English\x20(US)','SalesmanName','suppliers_docs','utils','message','then','supplier_payment','Portuguese','\x20Failed','name','company','single','Purchase','$reason','email','Portuguese\x20(BR)'];a0_0x4723=function(){return _0x4089c4;};return a0_0x4723();}