const a0_0x4a857d=a0_0x302c;function a0_0x302c(_0x849e56,_0x5d9637){const _0x16ce57=a0_0x16ce();return a0_0x302c=function(_0x302c5b,_0x569708){_0x302c5b=_0x302c5b-0x18d;let _0x19f782=_0x16ce57[_0x302c5b];return _0x19f782;},a0_0x302c(_0x849e56,_0x5d9637);}(function(_0x42e82e,_0x1e9444){const _0x514a88=a0_0x302c,_0x28033f=_0x42e82e();while(!![]){try{const _0x164fe6=parseInt(_0x514a88(0x1df))/0x1*(parseInt(_0x514a88(0x1d7))/0x2)+-parseInt(_0x514a88(0x195))/0x3+parseInt(_0x514a88(0x1d0))/0x4*(-parseInt(_0x514a88(0x19d))/0x5)+parseInt(_0x514a88(0x1d9))/0x6+parseInt(_0x514a88(0x1cc))/0x7+parseInt(_0x514a88(0x1b6))/0x8*(-parseInt(_0x514a88(0x1e6))/0x9)+-parseInt(_0x514a88(0x1b1))/0xa*(-parseInt(_0x514a88(0x1c4))/0xb);if(_0x164fe6===_0x1e9444)break;else _0x28033f['push'](_0x28033f['shift']());}catch(_0x31c7b3){_0x28033f['push'](_0x28033f['shift']());}}}(a0_0x16ce,0x3492e));const express=require(a0_0x4a857d(0x1ad)),app=express(),router=express[a0_0x4a857d(0x1ae)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x4a857d(0x1a3)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x4a857d(0x18e)),xlsx=require(a0_0x4a857d(0x1e9)),multer=require(a0_0x4a857d(0x1e1));router[a0_0x4a857d(0x1f5)]('/view',auth,async(_0x22f9f0,_0x2f0d83)=>{const _0x18dfda=a0_0x4a857d;try{const {username:_0x3583ec,email:_0x1d085e,role:_0x3d8dd8}=_0x22f9f0['user'],_0x20a0ff=_0x22f9f0['user'],_0x32e331=await profile[_0x18dfda(0x1f2)]({'email':_0x20a0ff[_0x18dfda(0x197)]}),_0x31e63e=await master_shop[_0x18dfda(0x1e8)]();console['log'](_0x18dfda(0x1a1),_0x31e63e);const _0x3cceee=await suppliers[_0x18dfda(0x1e8)]();console[_0x18dfda(0x1a9)](_0x3cceee);const _0x33b921=await suppliers['aggregate']([{'$lookup':{'from':_0x18dfda(0x1d3),'localField':'name','foreignField':_0x18dfda(0x1ab),'as':'suppliers_docs'}}]),_0x438c4a=_0x33b921[_0x18dfda(0x1f6)](_0x4b2c5f=>{const _0x42ac6a=_0x18dfda;console[_0x42ac6a(0x1a9)](_0x42ac6a(0x1a7),_0x4b2c5f);var _0x501289=0x0,_0x4af4e5=0x0;return _0x4b2c5f[_0x42ac6a(0x1a2)][_0x42ac6a(0x1af)](_0x24024c=>{const _0x2663df=_0x42ac6a;console['log'](_0x2663df(0x1a0),_0x24024c),_0x24024c[_0x2663df(0x1ac)]=='Purchase'?_0x501289+=_0x24024c[_0x2663df(0x1e2)]:_0x4af4e5+=_0x24024c[_0x2663df(0x1e2)];}),_0x4b2c5f[_0x42ac6a(0x191)]=_0x501289,_0x4b2c5f['purchase_return']=_0x4af4e5,_0x4b2c5f;});console[_0x18dfda(0x1a9)](_0x18dfda(0x199),_0x438c4a);if(_0x31e63e[0x0]['language']==_0x18dfda(0x196)){var _0x272ccf=users[_0x18dfda(0x1c7)];console[_0x18dfda(0x1a9)](_0x272ccf);}else{if(_0x31e63e[0x0]['language']==_0x18dfda(0x1c1))var _0x272ccf=users['Hindi'];else{if(_0x31e63e[0x0][_0x18dfda(0x193)]=='German')var _0x272ccf=users[_0x18dfda(0x1a8)];else{if(_0x31e63e[0x0][_0x18dfda(0x193)]=='Spanish')var _0x272ccf=users['Spanish'];else{if(_0x31e63e[0x0][_0x18dfda(0x193)]==_0x18dfda(0x1c9))var _0x272ccf=users['French'];else{if(_0x31e63e[0x0][_0x18dfda(0x193)]=='Portuguese\x20(BR)')var _0x272ccf=users[_0x18dfda(0x19a)];else{if(_0x31e63e[0x0]['language']==_0x18dfda(0x1b7))var _0x272ccf=users[_0x18dfda(0x1b7)];else{if(_0x31e63e[0x0][_0x18dfda(0x193)]==_0x18dfda(0x1e7))var _0x272ccf=users['Arabic'];}}}}}}}_0x2f0d83[_0x18dfda(0x1ea)](_0x18dfda(0x1f0),{'success':_0x22f9f0['flash'](_0x18dfda(0x1e0)),'errors':_0x22f9f0['flash'](_0x18dfda(0x1b0)),'user':_0x3cceee,'profile':_0x32e331,'master_shop':_0x31e63e,'role':_0x20a0ff,'payment':_0x438c4a,'language':_0x272ccf});}catch(_0x1f9841){console['log'](_0x1f9841);}}),router[a0_0x4a857d(0x1d4)](a0_0x4a857d(0x1b9),auth,async(_0x4020b1,_0x506561)=>{const _0xfeed3e=a0_0x4a857d;try{const {name:_0x4edeaf,email:_0x4ac1de,mobile:_0x3e2ca7,company:_0x5dfdab,address:_0x3c2b8b,receivable:_0x421d63,payable:_0x42e65d,code:_0x4eb586,contactperson:_0x51568a,landline:_0x5330c4}=_0x4020b1[_0xfeed3e(0x1a6)],_0x3805e6=new suppliers({'name':_0x4edeaf,'email':_0x4ac1de,'mobile':_0x3e2ca7,'company':_0x5dfdab,'address':_0x3c2b8b,'receivable':_0x421d63,'payable':_0x42e65d,'suppliers_code':_0x4eb586,'contactperson':_0x51568a,'landline':_0x5330c4}),_0x33957d=await _0x3805e6['save']();_0x4020b1['flash'](_0xfeed3e(0x1e0),_0xfeed3e(0x1c0)),_0x506561['redirect']('/supplier/view');}catch(_0x240b41){console[_0xfeed3e(0x1a9)](_0x240b41);}}),router[a0_0x4a857d(0x1f5)]('/view/:id',auth,async(_0x307c99,_0x293580)=>{const _0x26e793=a0_0x4a857d;try{const {username:_0x399299,email:_0xa4aa14,role:_0x2e7ebc}=_0x307c99[_0x26e793(0x190)],_0x1fa1f4=_0x307c99[_0x26e793(0x190)],_0x59cb35=await profile[_0x26e793(0x1f2)]({'email':_0x1fa1f4[_0x26e793(0x197)]}),_0xd89ffd=await master_shop['find']();console[_0x26e793(0x1a9)](_0x26e793(0x1a1),_0xd89ffd);const _0x3dacbd=_0x307c99[_0x26e793(0x1bc)]['id'],_0x451664=await suppliers[_0x26e793(0x1a4)](_0x3dacbd);console['log'](_0x451664);if(_0xd89ffd[0x0][_0x26e793(0x193)]==_0x26e793(0x196)){var _0x856b9e=users[_0x26e793(0x1c7)];console[_0x26e793(0x1a9)](_0x856b9e);}else{if(_0xd89ffd[0x0][_0x26e793(0x193)]=='Hindi')var _0x856b9e=users[_0x26e793(0x1c1)];else{if(_0xd89ffd[0x0][_0x26e793(0x193)]=='German')var _0x856b9e=users[_0x26e793(0x1a8)];else{if(_0xd89ffd[0x0][_0x26e793(0x193)]=='Spanish')var _0x856b9e=users['Spanish'];else{if(_0xd89ffd[0x0][_0x26e793(0x193)]=='French')var _0x856b9e=users[_0x26e793(0x1c9)];else{if(_0xd89ffd[0x0][_0x26e793(0x193)]==_0x26e793(0x1c6))var _0x856b9e=users['Portuguese'];else{if(_0xd89ffd[0x0]['language']=='Chinese')var _0x856b9e=users[_0x26e793(0x1b7)];else{if(_0xd89ffd[0x0][_0x26e793(0x193)]==_0x26e793(0x1e7))var _0x856b9e=users[_0x26e793(0x1ee)];}}}}}}}_0x293580[_0x26e793(0x1ea)](_0x26e793(0x1f0),{'success':_0x307c99[_0x26e793(0x1b3)](_0x26e793(0x1e0)),'errors':_0x307c99['flash'](_0x26e793(0x1b0)),'role':_0x1fa1f4,'profile':_0x59cb35,'master_shop':_0xd89ffd,'user':_0x451664,'language':_0x856b9e});}catch(_0x59d6a4){console[_0x26e793(0x1a9)](_0x59d6a4);}}),router['post'](a0_0x4a857d(0x1e3),auth,async(_0x5967da,_0x12e381)=>{const _0x4a62cf=a0_0x4a857d;try{const _0x4fbe64=_0x5967da[_0x4a62cf(0x1bc)]['id'],_0x5f1ce1=await suppliers[_0x4a62cf(0x1a4)](_0x4fbe64),{name:_0x1da84b,email:_0x5d11cf,mobile:_0x5aa2d2,company:_0x56e8c4,address:_0xb20f4,receivable:_0x57b071,payable:_0x2a3b84,code:_0x22f5c7,contactperson:_0x7f2403,landline:_0x264d71}=_0x5967da[_0x4a62cf(0x1a6)];_0x5f1ce1[_0x4a62cf(0x1b2)]=_0x1da84b,_0x5f1ce1[_0x4a62cf(0x197)]=_0x5d11cf,_0x5f1ce1[_0x4a62cf(0x1c3)]=_0x5aa2d2,_0x5f1ce1['company']=_0x56e8c4,_0x5f1ce1[_0x4a62cf(0x1f7)]=_0xb20f4,_0x5f1ce1[_0x4a62cf(0x1a5)]=_0x57b071,_0x5f1ce1[_0x4a62cf(0x1de)]=_0x2a3b84,_0x5f1ce1['suppliers_code']=_0x22f5c7,_0x5f1ce1[_0x4a62cf(0x1f4)]=_0x7f2403,_0x5f1ce1['landline']=_0x264d71;const _0xbf086f=await _0x5f1ce1[_0x4a62cf(0x1f8)]();_0x5967da[_0x4a62cf(0x1b3)]('success',_0x4a62cf(0x1c8)),_0x12e381[_0x4a62cf(0x1aa)](_0x4a62cf(0x1cd));}catch(_0xd2e86b){console[_0x4a62cf(0x1a9)](_0xd2e86b);}}),router['get'](a0_0x4a857d(0x1d2),auth,async(_0x4121ac,_0x4b901e)=>{const _0x17cea=a0_0x4a857d;try{const {username:_0x5ec2b8,email:_0x5143f2,role:_0x517561}=_0x4121ac[_0x17cea(0x190)],_0x4ca1a1=_0x4121ac[_0x17cea(0x190)],_0x52b5ec=await profile[_0x17cea(0x1f2)]({'email':_0x4ca1a1[_0x17cea(0x197)]}),_0x5c243e=await master_shop[_0x17cea(0x1e8)]();console['log'](_0x17cea(0x1a1),_0x5c243e),console[_0x17cea(0x1a9)](_0x4121ac[_0x17cea(0x1bc)]['id']);const _0x226baf=await suppliers[_0x17cea(0x1f2)]({'_id':_0x4121ac[_0x17cea(0x1bc)]['id']});console[_0x17cea(0x1a9)](_0x226baf);const _0x4d52ae=await s_payment_data[_0x17cea(0x1e8)]({'suppliers':_0x226baf[_0x17cea(0x1b2)]});console['log'](_0x4d52ae);const _0x57896b=await s_payment_data[_0x17cea(0x1be)]([{'$match':{'suppliers':_0x226baf['name']}},{'$match':{'reason':_0x17cea(0x1e5)}},{'$group':{'_id':_0x17cea(0x1ef),'sum':{'$sum':_0x17cea(0x1ec)}}}]);console[_0x17cea(0x1a9)](_0x17cea(0x1cb),_0x57896b);const _0x267551=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x226baf[_0x17cea(0x1b2)]}},{'$match':{'reason':_0x17cea(0x1e4)}},{'$group':{'_id':_0x17cea(0x1ef),'sum':{'$sum':_0x17cea(0x1ec)}}}]);console[_0x17cea(0x1a9)](_0x17cea(0x1ba),_0x267551);if(_0x5c243e[0x0][_0x17cea(0x193)]=='English\x20(US)'){var _0x2fb99a=users[_0x17cea(0x1c7)];console[_0x17cea(0x1a9)](_0x2fb99a);}else{if(_0x5c243e[0x0][_0x17cea(0x193)]==_0x17cea(0x1c1))var _0x2fb99a=users[_0x17cea(0x1c1)];else{if(_0x5c243e[0x0][_0x17cea(0x193)]==_0x17cea(0x1a8))var _0x2fb99a=users[_0x17cea(0x1a8)];else{if(_0x5c243e[0x0][_0x17cea(0x193)]==_0x17cea(0x198))var _0x2fb99a=users[_0x17cea(0x198)];else{if(_0x5c243e[0x0][_0x17cea(0x193)]=='French')var _0x2fb99a=users['French'];else{if(_0x5c243e[0x0]['language']==_0x17cea(0x1c6))var _0x2fb99a=users['Portuguese'];else{if(_0x5c243e[0x0][_0x17cea(0x193)]==_0x17cea(0x1b7))var _0x2fb99a=users[_0x17cea(0x1b7)];else{if(_0x5c243e[0x0][_0x17cea(0x193)]==_0x17cea(0x1e7))var _0x2fb99a=users[_0x17cea(0x1ee)];}}}}}}}_0x4b901e['render'](_0x17cea(0x1d8),{'success':_0x4121ac[_0x17cea(0x1b3)](_0x17cea(0x1e0)),'errors':_0x4121ac[_0x17cea(0x1b3)](_0x17cea(0x1b0)),'role':_0x4ca1a1,'profile':_0x52b5ec,'master_shop':_0x5c243e,'payment':_0x4d52ae,'payable':_0x57896b,'receivable':_0x267551,'language':_0x2fb99a});}catch(_0x4f36d0){console[_0x17cea(0x1a9)](_0x4f36d0);}}),router[a0_0x4a857d(0x1f5)](a0_0x4a857d(0x1dc),auth,async(_0x57ce28,_0x1520e0)=>{const _0x563887=a0_0x4a857d;try{const _0x2e7168=new excelJS[(_0x563887(0x1c2))](),_0x4c2ee6=_0x2e7168[_0x563887(0x18f)](_0x563887(0x1b5));return _0x4c2ee6['columns']=[{'header':_0x563887(0x194),'key':'PBrands','width':0xa},{'header':'Supplier_Code','key':_0x563887(0x18d),'width':0xa},{'header':_0x563887(0x1ce),'key':_0x563887(0x1eb),'width':0xa},{'header':_0x563887(0x19f),'key':_0x563887(0x1f7),'width':0xa},{'header':'Company_Name','key':_0x563887(0x1c3),'width':0xa},{'header':_0x563887(0x1f7),'key':'email','width':0xa}],_0x1520e0['setHeader'](_0x563887(0x1cf),_0x563887(0x1db)),_0x1520e0[_0x563887(0x1d5)](_0x563887(0x1bb),_0x563887(0x1ed)),_0x2e7168[_0x563887(0x1e9)]['write'](_0x1520e0)[_0x563887(0x1b4)](()=>{const _0x3ceb04=_0x563887;_0x1520e0[_0x3ceb04(0x1f1)](0xc8);});}catch(_0x1c31b7){_0x1520e0[_0x563887(0x1f1)](0x190)[_0x563887(0x1c5)]({'errors':_0x1c31b7[_0x563887(0x1bf)]});}});function a0_0x16ce(){const _0x276a41=['Content-Type','1288kkoOLQ','diskStorage','/view/payment/:id','s_payments','post','setHeader','file','2216iIZPHX','supplier_payment','320946zrEVGU','public/Migration','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','/products_export_migrate_file','exports','payable','246zDBWUF','success','multer','amount','/view/:id','Purchase\x20Return','Purchase','851301uRXxuU','Arabic\x20(ae)','find','xlsx','render','SalesmanName','$amount','attachment;\x20filename=supplier_Migration_File.xlsx','Arabic','$reason','supplier','status','findOne','\x20Failed','contactperson','get','map','address','save','PUnits','exceljs','addWorksheet','user','purchase','filename','language','Name','799236RYzTRO','English\x20(US)','email','Spanish','supplier.js\x20payment_data','Portuguese','readFile','utils','3935LYUSfK','/supplier_import_migrate_file','Mobile_number','doc','master','suppliers_docs','../models/all_models','findById','receivable','body','data','German','log','redirect','suppliers','reason','express','Router','forEach','errors','950DaYyys','name','flash','then','Customers','8IMnQdb','Chinese','single','/view','receivable_sum','Content-Disposition','params','json','aggregate','message','supplier\x20data\x20add\x20successfully','Hindi','Workbook','mobile','9427kFWBsI','send','Portuguese\x20(BR)','English','supplier\x20data\x20update\x20successfully','French','error','payable_sum','2955981JFrIBJ','/supplier/view','Email'];a0_0x16ce=function(){return _0x276a41;};return a0_0x16ce();}const storage1=multer[a0_0x4a857d(0x1d1)]({'destination':(_0x4e005a,_0x24f2ea,_0x5be363)=>{const _0x4c7674=a0_0x4a857d;_0x5be363(null,_0x4c7674(0x1da));},'filename':(_0x5e4949,_0x3e820c,_0x189237)=>{_0x189237(null,Date['now']()+_0x3e820c['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x4a857d(0x1d4)](a0_0x4a857d(0x19e),auth,uploadMigrate[a0_0x4a857d(0x1b8)]('supplier_product_file'),async(_0x43ae2f,_0x50d82d)=>{const _0x54a294=a0_0x4a857d,_0x1dcff5=_0x43ae2f[_0x54a294(0x1d6)][_0x54a294(0x192)],_0xdea1db=await xlsx[_0x54a294(0x19b)]('public/Migration/'+_0x1dcff5);let _0xdf17fc=_0xdea1db['SheetNames'],_0x17b367=xlsx[_0x54a294(0x19c)]['sheet_to_json'](_0xdea1db['Sheets'][_0xdf17fc[0x0]]);for(const _0x54605f of _0x17b367){const _0x4b1368=_0x54605f['Name'],_0x58bc6b=_0x54605f['Supplier_Code'],_0x1d3ee5=_0x54605f['address'],_0x455c4d=_0x54605f[_0x54a294(0x19f)],_0x4347d0=_0x54605f[_0x54a294(0x1ce)],_0x6413fe=_0x54605f['Company_Name'];try{let _0x2d95c3=await suppliers[_0x54a294(0x1f2)]({'name':_0x4b1368});if(!_0x2d95c3){const _0x3cbc40=new suppliers({'name':_0x4b1368,'suppliers_code':_0x58bc6b,'address':_0x1d3ee5,'mobile':_0x455c4d,'email':_0x4347d0,'company':_0x6413fe});_0x2d95c3=await _0x3cbc40[_0x54a294(0x1f8)](),_0x43ae2f[_0x54a294(0x1b3)](_0x54a294(0x1e0),_0x4b1368+'\x20added\x20successfully');}else _0x43ae2f[_0x54a294(0x1b3)](_0x54a294(0x1ca),_0x4b1368+_0x54a294(0x1f3));}catch(_0x1ae015){_0x50d82d[_0x54a294(0x1f1)](0x1f4)[_0x54a294(0x1bd)]({'proderror':_0x1ae015['message'],'aproduct':ProductName});}}_0x50d82d[_0x54a294(0x1aa)]('/supplier/view');}),module[a0_0x4a857d(0x1dd)]=router;