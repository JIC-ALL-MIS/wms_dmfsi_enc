const a0_0x23d9a9=a0_0x4613;(function(_0x1834ec,_0x3a586b){const _0x44ac3c=a0_0x4613,_0x51dcc7=_0x1834ec();while(!![]){try{const _0x3c997a=-parseInt(_0x44ac3c(0x1bf))/0x1*(-parseInt(_0x44ac3c(0x204))/0x2)+parseInt(_0x44ac3c(0x1e3))/0x3*(parseInt(_0x44ac3c(0x1f4))/0x4)+parseInt(_0x44ac3c(0x1ba))/0x5+parseInt(_0x44ac3c(0x1f1))/0x6+parseInt(_0x44ac3c(0x1b5))/0x7*(parseInt(_0x44ac3c(0x1ee))/0x8)+-parseInt(_0x44ac3c(0x1fa))/0x9*(parseInt(_0x44ac3c(0x1f9))/0xa)+parseInt(_0x44ac3c(0x1f7))/0xb*(-parseInt(_0x44ac3c(0x213))/0xc);if(_0x3c997a===_0x3a586b)break;else _0x51dcc7['push'](_0x51dcc7['shift']());}catch(_0x556ea3){_0x51dcc7['push'](_0x51dcc7['shift']());}}}(a0_0x59f8,0x76666));const express=require('express'),app=express(),router=express[a0_0x23d9a9(0x1b2)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x23d9a9(0x1ae)),excelJS=require('exceljs'),xlsx=require(a0_0x23d9a9(0x1e7)),multer=require(a0_0x23d9a9(0x1e6));router[a0_0x23d9a9(0x1dc)]('/view',auth,async(_0x26d6ee,_0x308614)=>{const _0x4e8c06=a0_0x23d9a9;try{const {username:_0xa4ad3f,email:_0x56a67f,role:_0x18fe84}=_0x26d6ee[_0x4e8c06(0x20a)],_0x1cbe08=_0x26d6ee[_0x4e8c06(0x20a)],_0x2cb5da=await profile[_0x4e8c06(0x201)]({'email':_0x1cbe08[_0x4e8c06(0x1d5)]}),_0x5a329=await master_shop[_0x4e8c06(0x210)]();console[_0x4e8c06(0x1d6)](_0x4e8c06(0x1eb),_0x5a329);const _0x8ea2db=await suppliers[_0x4e8c06(0x210)]();console[_0x4e8c06(0x1d6)](_0x8ea2db);const _0x4bdbc7=await suppliers[_0x4e8c06(0x1e0)]([{'$lookup':{'from':_0x4e8c06(0x1ad),'localField':'name','foreignField':_0x4e8c06(0x1f8),'as':_0x4e8c06(0x1ef)}}]),_0x1d53b0=_0x4bdbc7[_0x4e8c06(0x202)](_0x2a4f9f=>{const _0xfe0b81=_0x4e8c06;console[_0xfe0b81(0x1d6)]('data',_0x2a4f9f);var _0xa6f12f=0x0,_0x445e7f=0x0;return _0x2a4f9f['suppliers_docs'][_0xfe0b81(0x1a9)](_0x113cb9=>{const _0x460df8=_0xfe0b81;console[_0x460df8(0x1d6)](_0x460df8(0x1cb),_0x113cb9),_0x113cb9[_0x460df8(0x1ff)]==_0x460df8(0x1b9)?_0xa6f12f+=_0x113cb9['amount']:_0x445e7f+=_0x113cb9[_0x460df8(0x212)];}),_0x2a4f9f[_0xfe0b81(0x1c7)]=_0xa6f12f,_0x2a4f9f[_0xfe0b81(0x1c2)]=_0x445e7f,_0x2a4f9f;});console['log'](_0x4e8c06(0x1ca),_0x1d53b0);if(_0x5a329[0x0][_0x4e8c06(0x1c4)]=='English\x20(US)'){var _0x29c4aa=users[_0x4e8c06(0x1dd)];console[_0x4e8c06(0x1d6)](_0x29c4aa);}else{if(_0x5a329[0x0]['language']==_0x4e8c06(0x209))var _0x29c4aa=users[_0x4e8c06(0x209)];else{if(_0x5a329[0x0]['language']==_0x4e8c06(0x1ac))var _0x29c4aa=users[_0x4e8c06(0x1ac)];else{if(_0x5a329[0x0][_0x4e8c06(0x1c4)]=='Spanish')var _0x29c4aa=users[_0x4e8c06(0x1ec)];else{if(_0x5a329[0x0]['language']=='French')var _0x29c4aa=users[_0x4e8c06(0x1bc)];else{if(_0x5a329[0x0][_0x4e8c06(0x1c4)]==_0x4e8c06(0x20c))var _0x29c4aa=users[_0x4e8c06(0x1d4)];else{if(_0x5a329[0x0][_0x4e8c06(0x1c4)]==_0x4e8c06(0x1aa))var _0x29c4aa=users['Chinese'];else{if(_0x5a329[0x0]['language']==_0x4e8c06(0x216))var _0x29c4aa=users['Arabic'];}}}}}}}_0x308614[_0x4e8c06(0x1fb)]('supplier',{'success':_0x26d6ee['flash'](_0x4e8c06(0x1c6)),'errors':_0x26d6ee['flash'](_0x4e8c06(0x1d3)),'user':_0x8ea2db,'profile':_0x2cb5da,'master_shop':_0x5a329,'role':_0x1cbe08,'payment':_0x1d53b0,'language':_0x29c4aa});}catch(_0x5b65c8){console[_0x4e8c06(0x1d6)](_0x5b65c8);}}),router[a0_0x23d9a9(0x1a8)](a0_0x23d9a9(0x1ed),auth,async(_0x111de1,_0x377522)=>{const _0x40e756=a0_0x23d9a9;try{const {name:_0x3503fe,email:_0x50f3d8,mobile:_0x440196,company:_0x2b7f29,address:_0x393128,receivable:_0x1be6d3,payable:_0xf7d55b,code:_0x2906b7,contactperson:_0x1aca69,landline:_0x3217bd}=_0x111de1[_0x40e756(0x1c3)],_0x16cedb=new suppliers({'name':_0x3503fe,'email':_0x50f3d8,'mobile':_0x440196,'company':_0x2b7f29,'address':_0x393128,'receivable':_0x1be6d3,'payable':_0xf7d55b,'suppliers_code':_0x2906b7,'contactperson':_0x1aca69,'landline':_0x3217bd}),_0x4970c2=await _0x16cedb[_0x40e756(0x1fe)]();_0x111de1[_0x40e756(0x20b)](_0x40e756(0x1c6),_0x40e756(0x1cc)),_0x377522['redirect'](_0x40e756(0x1ea));}catch(_0x4afc4d){console[_0x40e756(0x1d6)](_0x4afc4d);}}),router[a0_0x23d9a9(0x1dc)](a0_0x23d9a9(0x205),auth,async(_0xd3a44d,_0x53085a)=>{const _0x959735=a0_0x23d9a9;try{const {username:_0xc7fc8c,email:_0x14b6d8,role:_0x43c103}=_0xd3a44d[_0x959735(0x20a)],_0x2d7d3e=_0xd3a44d[_0x959735(0x20a)],_0x3c2f09=await profile[_0x959735(0x201)]({'email':_0x2d7d3e[_0x959735(0x1d5)]}),_0x266c68=await master_shop[_0x959735(0x210)]();console[_0x959735(0x1d6)](_0x959735(0x1eb),_0x266c68);const _0x1f7dec=_0xd3a44d[_0x959735(0x1d2)]['id'],_0x2ad3db=await suppliers['findById'](_0x1f7dec);console[_0x959735(0x1d6)](_0x2ad3db);if(_0x266c68[0x0][_0x959735(0x1c4)]==_0x959735(0x1e5)){var _0x1c3254=users['English'];console[_0x959735(0x1d6)](_0x1c3254);}else{if(_0x266c68[0x0][_0x959735(0x1c4)]==_0x959735(0x209))var _0x1c3254=users[_0x959735(0x209)];else{if(_0x266c68[0x0][_0x959735(0x1c4)]==_0x959735(0x1ac))var _0x1c3254=users[_0x959735(0x1ac)];else{if(_0x266c68[0x0][_0x959735(0x1c4)]==_0x959735(0x1ec))var _0x1c3254=users[_0x959735(0x1ec)];else{if(_0x266c68[0x0]['language']==_0x959735(0x1bc))var _0x1c3254=users[_0x959735(0x1bc)];else{if(_0x266c68[0x0]['language']==_0x959735(0x20c))var _0x1c3254=users[_0x959735(0x1d4)];else{if(_0x266c68[0x0][_0x959735(0x1c4)]==_0x959735(0x1aa))var _0x1c3254=users['Chinese'];else{if(_0x266c68[0x0][_0x959735(0x1c4)]==_0x959735(0x216))var _0x1c3254=users[_0x959735(0x215)];}}}}}}}_0x53085a['render']('supplier',{'success':_0xd3a44d[_0x959735(0x20b)](_0x959735(0x1c6)),'errors':_0xd3a44d[_0x959735(0x20b)]('errors'),'role':_0x2d7d3e,'profile':_0x3c2f09,'master_shop':_0x266c68,'user':_0x2ad3db,'language':_0x1c3254});}catch(_0x170268){console['log'](_0x170268);}}),router[a0_0x23d9a9(0x1a8)](a0_0x23d9a9(0x205),auth,async(_0xe28b84,_0x1086e6)=>{const _0x159bf2=a0_0x23d9a9;try{const _0xa74a25=_0xe28b84['params']['id'],_0x55c802=await suppliers[_0x159bf2(0x1c5)](_0xa74a25),{name:_0x386241,email:_0x396a00,mobile:_0x4f4a7b,company:_0x425ac6,address:_0x27dcdd,receivable:_0x28ba19,payable:_0x215956,code:_0x49eb82,contactperson:_0x27c75f,landline:_0x284529}=_0xe28b84[_0x159bf2(0x1c3)];_0x55c802[_0x159bf2(0x1e4)]=_0x386241,_0x55c802[_0x159bf2(0x1d5)]=_0x396a00,_0x55c802[_0x159bf2(0x1d1)]=_0x4f4a7b,_0x55c802[_0x159bf2(0x1bd)]=_0x425ac6,_0x55c802['address']=_0x27dcdd,_0x55c802[_0x159bf2(0x1e8)]=_0x28ba19,_0x55c802[_0x159bf2(0x1cf)]=_0x215956,_0x55c802[_0x159bf2(0x1d0)]=_0x49eb82,_0x55c802[_0x159bf2(0x1d7)]=_0x27c75f,_0x55c802[_0x159bf2(0x1bb)]=_0x284529;const _0x5497ad=await _0x55c802[_0x159bf2(0x1fe)]();_0xe28b84[_0x159bf2(0x20b)](_0x159bf2(0x1c6),_0x159bf2(0x1f2)),_0x1086e6[_0x159bf2(0x1f5)](_0x159bf2(0x1ea));}catch(_0x5b4360){console[_0x159bf2(0x1d6)](_0x5b4360);}}),router[a0_0x23d9a9(0x1dc)](a0_0x23d9a9(0x207),auth,async(_0x3a34e1,_0x43e551)=>{const _0x1bb1b9=a0_0x23d9a9;try{const {username:_0xb8e1b2,email:_0x453aef,role:_0x56ef15}=_0x3a34e1[_0x1bb1b9(0x20a)],_0x24ef0d=_0x3a34e1[_0x1bb1b9(0x20a)],_0x493b2b=await profile[_0x1bb1b9(0x201)]({'email':_0x24ef0d[_0x1bb1b9(0x1d5)]}),_0x4d4ca6=await master_shop[_0x1bb1b9(0x210)]();console['log'](_0x1bb1b9(0x1eb),_0x4d4ca6),console[_0x1bb1b9(0x1d6)](_0x3a34e1[_0x1bb1b9(0x1d2)]['id']);const _0x5f4288=await suppliers[_0x1bb1b9(0x201)]({'_id':_0x3a34e1[_0x1bb1b9(0x1d2)]['id']});console[_0x1bb1b9(0x1d6)](_0x5f4288);const _0x414e45=await s_payment_data[_0x1bb1b9(0x210)]({'suppliers':_0x5f4288[_0x1bb1b9(0x1e4)]});console[_0x1bb1b9(0x1d6)](_0x414e45);const _0x2a3337=await s_payment_data[_0x1bb1b9(0x1e0)]([{'$match':{'suppliers':_0x5f4288[_0x1bb1b9(0x1e4)]}},{'$match':{'reason':_0x1bb1b9(0x1b9)}},{'$group':{'_id':_0x1bb1b9(0x1be),'sum':{'$sum':_0x1bb1b9(0x20f)}}}]);console[_0x1bb1b9(0x1d6)]('payable_sum',_0x2a3337);const _0x1bb7de=await s_payment_data[_0x1bb1b9(0x1e0)]([{'$match':{'suppliers':_0x5f4288['name']}},{'$match':{'reason':_0x1bb1b9(0x1b6)}},{'$group':{'_id':_0x1bb1b9(0x1be),'sum':{'$sum':_0x1bb1b9(0x20f)}}}]);console[_0x1bb1b9(0x1d6)]('receivable_sum',_0x1bb7de);if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x1e5)){var _0x45e065=users[_0x1bb1b9(0x1dd)];console['log'](_0x45e065);}else{if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x209))var _0x45e065=users[_0x1bb1b9(0x209)];else{if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x1ac))var _0x45e065=users['German'];else{if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x1ec))var _0x45e065=users['Spanish'];else{if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x1bc))var _0x45e065=users['French'];else{if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x20c))var _0x45e065=users[_0x1bb1b9(0x1d4)];else{if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x1aa))var _0x45e065=users['Chinese'];else{if(_0x4d4ca6[0x0][_0x1bb1b9(0x1c4)]==_0x1bb1b9(0x216))var _0x45e065=users['Arabic'];}}}}}}}_0x43e551[_0x1bb1b9(0x1fb)](_0x1bb1b9(0x1d8),{'success':_0x3a34e1['flash'](_0x1bb1b9(0x1c6)),'errors':_0x3a34e1[_0x1bb1b9(0x20b)](_0x1bb1b9(0x1d3)),'role':_0x24ef0d,'profile':_0x493b2b,'master_shop':_0x4d4ca6,'payment':_0x414e45,'payable':_0x2a3337,'receivable':_0x1bb7de,'language':_0x45e065});}catch(_0x4aaa69){console['log'](_0x4aaa69);}}),router[a0_0x23d9a9(0x1dc)](a0_0x23d9a9(0x214),auth,async(_0x5eedc1,_0x5b2928)=>{const _0x599f9b=a0_0x23d9a9;try{const _0x4a9437=new excelJS[(_0x599f9b(0x1cd))](),_0x3a9483=_0x4a9437[_0x599f9b(0x20d)](_0x599f9b(0x1b1));return _0x3a9483[_0x599f9b(0x1c8)]=[{'header':'Name','key':'PBrands','width':0xa},{'header':_0x599f9b(0x1b8),'key':'PUnits','width':0xa},{'header':_0x599f9b(0x1df),'key':_0x599f9b(0x1d9),'width':0xa},{'header':_0x599f9b(0x1f3),'key':_0x599f9b(0x1c1),'width':0xa},{'header':_0x599f9b(0x1c0),'key':'mobile','width':0xa},{'header':_0x599f9b(0x1c1),'key':'email','width':0xa}],_0x5b2928[_0x599f9b(0x1b4)]('Content-Type',_0x599f9b(0x1e9)),_0x5b2928['setHeader'](_0x599f9b(0x1f6),_0x599f9b(0x1f0)),_0x4a9437['xlsx'][_0x599f9b(0x200)](_0x5b2928)[_0x599f9b(0x211)](()=>{_0x5b2928['status'](0xc8);});}catch(_0xd392ee){_0x5b2928['status'](0x190)[_0x599f9b(0x1fd)]({'errors':_0xd392ee[_0x599f9b(0x203)]});}});const storage1=multer['diskStorage']({'destination':(_0x42bab2,_0x1d2c26,_0x3f32df)=>{_0x3f32df(null,'public/Migration');},'filename':(_0x167259,_0x1cdb9d,_0x186ce6)=>{const _0x3f7193=a0_0x23d9a9;_0x186ce6(null,Date[_0x3f7193(0x1af)]()+_0x1cdb9d[_0x3f7193(0x1c9)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x4613(_0x535a24,_0xfe401e){const _0x59f88a=a0_0x59f8();return a0_0x4613=function(_0x461335,_0x3a9dba){_0x461335=_0x461335-0x1a8;let _0x477c79=_0x59f88a[_0x461335];return _0x477c79;},a0_0x4613(_0x535a24,_0xfe401e);}router[a0_0x23d9a9(0x1a8)](a0_0x23d9a9(0x1ab),auth,uploadMigrate[a0_0x23d9a9(0x20e)](a0_0x23d9a9(0x1e2)),async(_0x2ed13c,_0x155215)=>{const _0x32cd52=a0_0x23d9a9,_0x2059d9=_0x2ed13c[_0x32cd52(0x206)][_0x32cd52(0x1e1)],_0x4cf9de=await xlsx[_0x32cd52(0x208)]('public/Migration/'+_0x2059d9);let _0x13eb92=_0x4cf9de[_0x32cd52(0x1da)],_0xbd57cf=xlsx[_0x32cd52(0x1b0)][_0x32cd52(0x1ce)](_0x4cf9de[_0x32cd52(0x1de)][_0x13eb92[0x0]]);for(const _0x4ecc69 of _0xbd57cf){const _0x3eea72=_0x4ecc69[_0x32cd52(0x1fc)],_0x3ad91e=_0x4ecc69[_0x32cd52(0x1b8)],_0x541e30=_0x4ecc69[_0x32cd52(0x1c1)],_0xdba673=_0x4ecc69[_0x32cd52(0x1f3)],_0xed1852=_0x4ecc69[_0x32cd52(0x1df)],_0x4d0c49=_0x4ecc69[_0x32cd52(0x1c0)];try{let _0x4c9943=await suppliers[_0x32cd52(0x201)]({'name':_0x3eea72});if(!_0x4c9943){const _0x471cf6=new suppliers({'name':_0x3eea72,'suppliers_code':_0x3ad91e,'address':_0x541e30,'mobile':_0xdba673,'email':_0xed1852,'company':_0x4d0c49});_0x4c9943=await _0x471cf6['save'](),_0x2ed13c[_0x32cd52(0x20b)](_0x32cd52(0x1c6),_0x3eea72+_0x32cd52(0x1db));}else _0x2ed13c[_0x32cd52(0x20b)]('error',_0x3eea72+_0x32cd52(0x1b3));}catch(_0x27b055){_0x155215['status'](0x1f4)['json']({'proderror':_0x27b055[_0x32cd52(0x203)],'aproduct':ProductName});}}_0x155215[_0x32cd52(0x1f5)](_0x32cd52(0x1ea));}),module[a0_0x23d9a9(0x1b7)]=router;function a0_0x59f8(){const _0x53e759=['/supplier_import_migrate_file','German','s_payments','../public/language/languages.json','now','utils','Customers','Router','\x20Failed','setHeader','68033sFftoz','Purchase\x20Return','exports','Supplier_Code','Purchase','3450740SWWEmW','landline','French','company','$reason','17461KzLQoT','Company_Name','address','purchase_return','body','language','findById','success','purchase','columns','originalname','supplier.js\x20payment_data','doc','supplier\x20data\x20add\x20successfully','Workbook','sheet_to_json','payable','suppliers_code','mobile','params','errors','Portuguese','email','log','contactperson','supplier_payment','SalesmanName','SheetNames','\x20added\x20successfully','get','English','Sheets','Email','aggregate','filename','supplier_product_file','15hjGviH','name','English\x20(US)','multer','xlsx','receivable','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','/supplier/view','master','Spanish','/view','424KcxelK','suppliers_docs','attachment;\x20filename=supplier_Migration_File.xlsx','5572476SvGozz','supplier\x20data\x20update\x20successfully','Mobile_number','239388SGeYmR','redirect','Content-Disposition','12923086GGIvBC','suppliers','9305930vvcVZV','9LgOtjv','render','Name','send','save','reason','write','findOne','map','message','18yCfdjC','/view/:id','file','/view/payment/:id','readFile','Hindi','user','flash','Portuguese\x20(BR)','addWorksheet','single','$amount','find','then','amount','12mpGJDt','/products_export_migrate_file','Arabic','Arabic\x20(ae)','post','forEach','Chinese'];a0_0x59f8=function(){return _0x53e759;};return a0_0x59f8();}