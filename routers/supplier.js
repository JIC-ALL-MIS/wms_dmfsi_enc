const a0_0x3b6624=a0_0x5597;(function(_0x1a1f13,_0x3ac2b7){const _0x2e1346=a0_0x5597,_0x4d56bb=_0x1a1f13();while(!![]){try{const _0x427747=parseInt(_0x2e1346(0xb6))/0x1+parseInt(_0x2e1346(0x102))/0x2+-parseInt(_0x2e1346(0x9c))/0x3+-parseInt(_0x2e1346(0xa5))/0x4+-parseInt(_0x2e1346(0xca))/0x5*(-parseInt(_0x2e1346(0xd4))/0x6)+parseInt(_0x2e1346(0xe9))/0x7*(-parseInt(_0x2e1346(0xc7))/0x8)+parseInt(_0x2e1346(0xf8))/0x9;if(_0x427747===_0x3ac2b7)break;else _0x4d56bb['push'](_0x4d56bb['shift']());}catch(_0x104dd2){_0x4d56bb['push'](_0x4d56bb['shift']());}}}(a0_0x30f5,0x78159));const express=require('express'),app=express(),router=express[a0_0x3b6624(0xbf)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x3b6624(0x9e)),excelJS=require(a0_0x3b6624(0x9d)),xlsx=require(a0_0x3b6624(0xdf)),multer=require(a0_0x3b6624(0xc5));router[a0_0x3b6624(0xe2)](a0_0x3b6624(0xd3),auth,async(_0x3a7b3a,_0x4efc8e)=>{const _0x338cec=a0_0x3b6624;try{const {username:_0x2efaef,email:_0x9963d8,role:_0x1f66ea}=_0x3a7b3a[_0x338cec(0xc6)],_0x3bcf96=_0x3a7b3a[_0x338cec(0xc6)],_0x214bf1=await profile[_0x338cec(0xf7)]({'email':_0x3bcf96[_0x338cec(0xe8)]}),_0xd1b278=await master_shop[_0x338cec(0xbc)]();console[_0x338cec(0xb4)]('master',_0xd1b278);const _0x1e8f99=await suppliers[_0x338cec(0xbc)]();console[_0x338cec(0xb4)](_0x1e8f99);const _0x39fb79=await suppliers[_0x338cec(0xcd)]([{'$lookup':{'from':_0x338cec(0xb7),'localField':_0x338cec(0xe0),'foreignField':_0x338cec(0xae),'as':'suppliers_docs'}}]),_0x2be584=_0x39fb79['map'](_0x58baa9=>{const _0x428111=_0x338cec;console[_0x428111(0xb4)]('data',_0x58baa9);var _0x190e7f=0x0,_0x2bc503=0x0;return _0x58baa9[_0x428111(0xba)]['forEach'](_0xe3d4de=>{const _0x59dec3=_0x428111;console[_0x59dec3(0xb4)]('doc',_0xe3d4de),_0xe3d4de[_0x59dec3(0xa9)]==_0x59dec3(0xb2)?_0x190e7f+=_0xe3d4de['amount']:_0x2bc503+=_0xe3d4de[_0x59dec3(0x103)];}),_0x58baa9[_0x428111(0xcb)]=_0x190e7f,_0x58baa9[_0x428111(0xc1)]=_0x2bc503,_0x58baa9;});console['log'](_0x338cec(0xf6),_0x2be584);if(_0xd1b278[0x0][_0x338cec(0xf4)]==_0x338cec(0xd5)){var _0x1bb704=users[_0x338cec(0xe5)];console[_0x338cec(0xb4)](_0x1bb704);}else{if(_0xd1b278[0x0][_0x338cec(0xf4)]==_0x338cec(0xdc))var _0x1bb704=users[_0x338cec(0xdc)];else{if(_0xd1b278[0x0][_0x338cec(0xf4)]==_0x338cec(0xe4))var _0x1bb704=users[_0x338cec(0xe4)];else{if(_0xd1b278[0x0]['language']==_0x338cec(0x97))var _0x1bb704=users[_0x338cec(0x97)];else{if(_0xd1b278[0x0]['language']==_0x338cec(0xc2))var _0x1bb704=users[_0x338cec(0xc2)];else{if(_0xd1b278[0x0]['language']==_0x338cec(0xe6))var _0x1bb704=users[_0x338cec(0xbb)];else{if(_0xd1b278[0x0][_0x338cec(0xf4)]==_0x338cec(0xee))var _0x1bb704=users[_0x338cec(0xee)];else{if(_0xd1b278[0x0]['language']==_0x338cec(0xfd))var _0x1bb704=users[_0x338cec(0xf9)];}}}}}}}_0x4efc8e[_0x338cec(0xe7)](_0x338cec(0xb5),{'success':_0x3a7b3a[_0x338cec(0x104)](_0x338cec(0xb3)),'errors':_0x3a7b3a['flash'](_0x338cec(0xda)),'user':_0x1e8f99,'profile':_0x214bf1,'master_shop':_0xd1b278,'role':_0x3bcf96,'payment':_0x2be584,'language':_0x1bb704});}catch(_0x4fb427){console[_0x338cec(0xb4)](_0x4fb427);}}),router[a0_0x3b6624(0xc3)](a0_0x3b6624(0xd3),auth,async(_0xe19212,_0x4116cb)=>{const _0xb51db1=a0_0x3b6624;try{const {name:_0x5a40e9,email:_0x368d07,mobile:_0x512d0a,company:_0x299da6,address:_0x36619f,receivable:_0x2dc9f1,payable:_0x152157,code:_0x3dbc1e,contactperson:_0x14ce56,landline:_0x4f7f6b}=_0xe19212[_0xb51db1(0xeb)],_0x34bcee=new suppliers({'name':_0x5a40e9,'email':_0x368d07,'mobile':_0x512d0a,'company':_0x299da6,'address':_0x36619f,'receivable':_0x2dc9f1,'payable':_0x152157,'suppliers_code':_0x3dbc1e,'contactperson':_0x14ce56,'landline':_0x4f7f6b}),_0x42f500=await _0x34bcee[_0xb51db1(0xaa)]();_0xe19212[_0xb51db1(0x104)]('success',_0xb51db1(0xbd)),_0x4116cb[_0xb51db1(0xd0)]('/supplier/view');}catch(_0x13856d){console['log'](_0x13856d);}}),router[a0_0x3b6624(0xe2)](a0_0x3b6624(0xf1),auth,async(_0x59384d,_0x4a2387)=>{const _0x26e48f=a0_0x3b6624;try{const {username:_0x54c9fe,email:_0x9ae5ca,role:_0x4b48f4}=_0x59384d[_0x26e48f(0xc6)],_0xbbb024=_0x59384d[_0x26e48f(0xc6)],_0x2bf82e=await profile[_0x26e48f(0xf7)]({'email':_0xbbb024[_0x26e48f(0xe8)]}),_0x2c3417=await master_shop[_0x26e48f(0xbc)]();console[_0x26e48f(0xb4)]('master',_0x2c3417);const _0x3206ac=_0x59384d[_0x26e48f(0xfb)]['id'],_0x5512e8=await suppliers['findById'](_0x3206ac);console['log'](_0x5512e8);if(_0x2c3417[0x0][_0x26e48f(0xf4)]==_0x26e48f(0xd5)){var _0x487e0d=users[_0x26e48f(0xe5)];console[_0x26e48f(0xb4)](_0x487e0d);}else{if(_0x2c3417[0x0][_0x26e48f(0xf4)]==_0x26e48f(0xdc))var _0x487e0d=users['Hindi'];else{if(_0x2c3417[0x0]['language']==_0x26e48f(0xe4))var _0x487e0d=users[_0x26e48f(0xe4)];else{if(_0x2c3417[0x0][_0x26e48f(0xf4)]==_0x26e48f(0x97))var _0x487e0d=users[_0x26e48f(0x97)];else{if(_0x2c3417[0x0]['language']=='French')var _0x487e0d=users['French'];else{if(_0x2c3417[0x0]['language']=='Portuguese\x20(BR)')var _0x487e0d=users[_0x26e48f(0xbb)];else{if(_0x2c3417[0x0]['language']==_0x26e48f(0xee))var _0x487e0d=users[_0x26e48f(0xee)];else{if(_0x2c3417[0x0][_0x26e48f(0xf4)]==_0x26e48f(0xfd))var _0x487e0d=users[_0x26e48f(0xf9)];}}}}}}}_0x4a2387[_0x26e48f(0xe7)]('supplier',{'success':_0x59384d['flash']('success'),'errors':_0x59384d[_0x26e48f(0x104)](_0x26e48f(0xda)),'role':_0xbbb024,'profile':_0x2bf82e,'master_shop':_0x2c3417,'user':_0x5512e8,'language':_0x487e0d});}catch(_0x4c053f){console[_0x26e48f(0xb4)](_0x4c053f);}}),router['post'](a0_0x3b6624(0xf1),auth,async(_0x1d5878,_0x1e87ca)=>{const _0x16180e=a0_0x3b6624;try{const _0x389bc5=_0x1d5878[_0x16180e(0xfb)]['id'],_0x1fa43b=await suppliers[_0x16180e(0xd9)](_0x389bc5),{name:_0x2db43c,email:_0x1aa13f,mobile:_0x3612d1,company:_0x489f89,address:_0x40997d,receivable:_0x32c317,payable:_0x36cbf0,code:_0x44dfd3,contactperson:_0x28cc16,landline:_0xe80efb}=_0x1d5878[_0x16180e(0xeb)];_0x1fa43b[_0x16180e(0xe0)]=_0x2db43c,_0x1fa43b[_0x16180e(0xe8)]=_0x1aa13f,_0x1fa43b[_0x16180e(0xaf)]=_0x3612d1,_0x1fa43b[_0x16180e(0xb9)]=_0x489f89,_0x1fa43b['address']=_0x40997d,_0x1fa43b[_0x16180e(0xbe)]=_0x32c317,_0x1fa43b[_0x16180e(0x100)]=_0x36cbf0,_0x1fa43b[_0x16180e(0xd7)]=_0x44dfd3,_0x1fa43b['contactperson']=_0x28cc16,_0x1fa43b[_0x16180e(0xd2)]=_0xe80efb;const _0x56415a=await _0x1fa43b[_0x16180e(0xaa)]();_0x1d5878[_0x16180e(0x104)]('success',_0x16180e(0xec)),_0x1e87ca[_0x16180e(0xd0)]('/supplier/view');}catch(_0x3ef427){console[_0x16180e(0xb4)](_0x3ef427);}}),router[a0_0x3b6624(0xe2)](a0_0x3b6624(0x101),auth,async(_0x3ecbee,_0x3a3f44)=>{const _0x2fc282=a0_0x3b6624;try{const {username:_0x3593a5,email:_0x40a86c,role:_0x1749ee}=_0x3ecbee['user'],_0x463e82=_0x3ecbee[_0x2fc282(0xc6)],_0x488eef=await profile[_0x2fc282(0xf7)]({'email':_0x463e82[_0x2fc282(0xe8)]}),_0x35200f=await master_shop['find']();console[_0x2fc282(0xb4)](_0x2fc282(0xa4),_0x35200f),console['log'](_0x3ecbee['params']['id']);const _0x1b093e=await suppliers[_0x2fc282(0xf7)]({'_id':_0x3ecbee[_0x2fc282(0xfb)]['id']});console['log'](_0x1b093e);const _0x2dc365=await s_payment_data['find']({'suppliers':_0x1b093e[_0x2fc282(0xe0)]});console[_0x2fc282(0xb4)](_0x2dc365);const _0x23f62d=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x1b093e[_0x2fc282(0xe0)]}},{'$match':{'reason':_0x2fc282(0xb2)}},{'$group':{'_id':_0x2fc282(0x9b),'sum':{'$sum':_0x2fc282(0xb0)}}}]);console[_0x2fc282(0xb4)]('payable_sum',_0x23f62d);const _0x247713=await s_payment_data[_0x2fc282(0xcd)]([{'$match':{'suppliers':_0x1b093e[_0x2fc282(0xe0)]}},{'$match':{'reason':_0x2fc282(0xef)}},{'$group':{'_id':_0x2fc282(0x9b),'sum':{'$sum':'$amount'}}}]);console[_0x2fc282(0xb4)](_0x2fc282(0xa3),_0x247713);if(_0x35200f[0x0]['language']==_0x2fc282(0xd5)){var _0x11368c=users['English'];console[_0x2fc282(0xb4)](_0x11368c);}else{if(_0x35200f[0x0]['language']==_0x2fc282(0xdc))var _0x11368c=users[_0x2fc282(0xdc)];else{if(_0x35200f[0x0][_0x2fc282(0xf4)]==_0x2fc282(0xe4))var _0x11368c=users[_0x2fc282(0xe4)];else{if(_0x35200f[0x0][_0x2fc282(0xf4)]=='Spanish')var _0x11368c=users[_0x2fc282(0x97)];else{if(_0x35200f[0x0]['language']==_0x2fc282(0xc2))var _0x11368c=users[_0x2fc282(0xc2)];else{if(_0x35200f[0x0][_0x2fc282(0xf4)]==_0x2fc282(0xe6))var _0x11368c=users[_0x2fc282(0xbb)];else{if(_0x35200f[0x0][_0x2fc282(0xf4)]==_0x2fc282(0xee))var _0x11368c=users['Chinese'];else{if(_0x35200f[0x0][_0x2fc282(0xf4)]==_0x2fc282(0xfd))var _0x11368c=users['Arabic'];}}}}}}}_0x3a3f44[_0x2fc282(0xe7)](_0x2fc282(0xac),{'success':_0x3ecbee[_0x2fc282(0x104)](_0x2fc282(0xb3)),'errors':_0x3ecbee['flash'](_0x2fc282(0xda)),'role':_0x463e82,'profile':_0x488eef,'master_shop':_0x35200f,'payment':_0x2dc365,'payable':_0x23f62d,'receivable':_0x247713,'language':_0x11368c});}catch(_0x3dcb21){console['log'](_0x3dcb21);}}),router[a0_0x3b6624(0xe2)](a0_0x3b6624(0xb8),auth,async(_0xd279a4,_0x29fcb6)=>{const _0x2ee196=a0_0x3b6624;try{const _0x4793c3=new excelJS[(_0x2ee196(0xce))](),_0x5c0113=_0x4793c3[_0x2ee196(0xab)](_0x2ee196(0xa6));return _0x5c0113[_0x2ee196(0xd1)]=[{'header':'Name','key':_0x2ee196(0xd8),'width':0xa},{'header':_0x2ee196(0xf5),'key':_0x2ee196(0xc0),'width':0xa},{'header':_0x2ee196(0xc8),'key':_0x2ee196(0xa2),'width':0xa},{'header':_0x2ee196(0xed),'key':_0x2ee196(0x9f),'width':0xa},{'header':_0x2ee196(0xfe),'key':_0x2ee196(0xaf),'width':0xa},{'header':_0x2ee196(0x9f),'key':_0x2ee196(0xe8),'width':0xa}],_0x29fcb6[_0x2ee196(0xa0)]('Content-Type',_0x2ee196(0x98)),_0x29fcb6[_0x2ee196(0xa0)](_0x2ee196(0xde),_0x2ee196(0xa1)),_0x4793c3[_0x2ee196(0xdf)][_0x2ee196(0xcc)](_0x29fcb6)['then'](()=>{const _0x23c17d=_0x2ee196;_0x29fcb6[_0x23c17d(0xc9)](0xc8);});}catch(_0x8038e1){_0x29fcb6[_0x2ee196(0xc9)](0x190)[_0x2ee196(0x105)]({'errors':_0x8038e1[_0x2ee196(0xcf)]});}});const storage1=multer[a0_0x3b6624(0xc4)]({'destination':(_0x8cf2de,_0x58cd06,_0x4040e0)=>{const _0x2c94de=a0_0x3b6624;_0x4040e0(null,_0x2c94de(0xa8));},'filename':(_0x400c7c,_0x28ea69,_0xe79b8a)=>{const _0x10156d=a0_0x3b6624;_0xe79b8a(null,Date[_0x10156d(0xf2)]()+_0x28ea69[_0x10156d(0xf0)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x5597(_0x2c0a6d,_0x2a845a){const _0x30f5b2=a0_0x30f5();return a0_0x5597=function(_0x559785,_0x15d11b){_0x559785=_0x559785-0x96;let _0xdb052f=_0x30f5b2[_0x559785];return _0xdb052f;},a0_0x5597(_0x2c0a6d,_0x2a845a);}router[a0_0x3b6624(0xc3)](a0_0x3b6624(0x99),auth,uploadMigrate[a0_0x3b6624(0xd6)]('supplier_product_file'),async(_0x329937,_0x2c0bae)=>{const _0x219a5b=a0_0x3b6624,_0x100602=_0x329937[_0x219a5b(0x9a)][_0x219a5b(0xad)],_0x2751ff=await xlsx['readFile'](_0x219a5b(0xea)+_0x100602);let _0x20c635=_0x2751ff[_0x219a5b(0xdd)],_0x4da82d=xlsx[_0x219a5b(0xfc)][_0x219a5b(0xf3)](_0x2751ff[_0x219a5b(0xe1)][_0x20c635[0x0]]);for(const _0x3721ea of _0x4da82d){const _0x5c2e32=_0x3721ea[_0x219a5b(0xff)],_0x15f9c8=_0x3721ea[_0x219a5b(0xf5)],_0x1a8a39=_0x3721ea[_0x219a5b(0x9f)],_0x120597=_0x3721ea[_0x219a5b(0xed)],_0x29586b=_0x3721ea[_0x219a5b(0xc8)],_0x3ef1dc=_0x3721ea[_0x219a5b(0xfe)];try{let _0x4ef0ab=await suppliers[_0x219a5b(0xf7)]({'name':_0x5c2e32});if(!_0x4ef0ab){const _0x12d5e8=new suppliers({'name':_0x5c2e32,'suppliers_code':_0x15f9c8,'address':_0x1a8a39,'mobile':_0x120597,'email':_0x29586b,'company':_0x3ef1dc});_0x4ef0ab=await _0x12d5e8[_0x219a5b(0xaa)](),_0x329937[_0x219a5b(0x104)](_0x219a5b(0xb3),_0x5c2e32+_0x219a5b(0xe3));}else _0x329937[_0x219a5b(0x104)](_0x219a5b(0x96),_0x5c2e32+_0x219a5b(0xb1));}catch(_0x5ea92b){_0x2c0bae[_0x219a5b(0xc9)](0x1f4)[_0x219a5b(0xfa)]({'proderror':_0x5ea92b[_0x219a5b(0xcf)],'aproduct':ProductName});}}_0x2c0bae['redirect'](_0x219a5b(0xdb));}),module[a0_0x3b6624(0xa7)]=router;function a0_0x30f5(){const _0x28f392=['Arabic','json','params','utils','Arabic\x20(ae)','Company_Name','Name','payable','/view/payment/:id','1481736vrOiih','amount','flash','send','error','Spanish','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','/supplier_import_migrate_file','file','$reason','2834850rKrSsf','exceljs','../public/language/languages.json','address','setHeader','attachment;\x20filename=supplier_Migration_File.xlsx','SalesmanName','receivable_sum','master','3706292ElOnlk','Customers','exports','public/Migration','reason','save','addWorksheet','supplier_payment','filename','suppliers','mobile','$amount','\x20Failed','Purchase','success','log','supplier','469121dkGINL','s_payments','/products_export_migrate_file','company','suppliers_docs','Portuguese','find','supplier\x20data\x20add\x20successfully','receivable','Router','PUnits','purchase_return','French','post','diskStorage','multer','user','4900848xtwfkV','Email','status','50330ZkcKyp','purchase','write','aggregate','Workbook','message','redirect','columns','landline','/view','462twMzhM','English\x20(US)','single','suppliers_code','PBrands','findById','errors','/supplier/view','Hindi','SheetNames','Content-Disposition','xlsx','name','Sheets','get','\x20added\x20successfully','German','English','Portuguese\x20(BR)','render','email','7vBptKq','public/Migration/','body','supplier\x20data\x20update\x20successfully','Mobile_number','Chinese','Purchase\x20Return','originalname','/view/:id','now','sheet_to_json','language','Supplier_Code','supplier.js\x20payment_data','findOne','8918307BdaZPu'];a0_0x30f5=function(){return _0x28f392;};return a0_0x30f5();}