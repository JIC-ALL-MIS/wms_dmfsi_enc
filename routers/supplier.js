const a0_0xe5de39=a0_0x8c52;function a0_0x4b4b(){const _0xa4a1d=['exceljs','company','error','English','redirect','log','columns','Mobile_number','forEach','PUnits','map','suppliers','2298UplJvY','receivable','amount','Portuguese','Workbook','2959754atDTZz','Name','SheetNames','\x20Failed','supplier\x20data\x20update\x20successfully','../middleware/auth','French','success','5pvVNeD','errors','flash','name','Company_Name','diskStorage','1234008WAmGKL','Email','Portuguese\x20(BR)','express','Arabic\x20(ae)','post','multer','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Arabic','language','xlsx','788332uaZrie','originalname','2286672TepHBz','save','setHeader','now','Supplier_Code','receivable_sum','$amount','Purchase','Customers','Hindi','get','attachment;\x20filename=supplier_Migration_File.xlsx','1822hOJtZG','/view/payment/:id','supplier_payment','json','PBrands','exports','suppliers_docs','18913230Yezzlb','message','Spanish','SalesmanName','filename','\x20added\x20successfully','mobile','222820imnZjo','render','s_payments','status','email','supplier','../models/all_models','/view/:id','sheet_to_json','purchase_return','findById','$reason','find','utils','single','address','Chinese','addWorksheet','master','supplier.js\x20payment_data','body','/supplier/view','English\x20(US)','/view','write','aggregate','payable_sum','user','suppliers_code','findOne','file','German','purchase','params','/products_export_migrate_file','reason'];a0_0x4b4b=function(){return _0xa4a1d;};return a0_0x4b4b();}(function(_0x1e9f17,_0x5864f9){const _0x322855=a0_0x8c52,_0x4be82f=_0x1e9f17();while(!![]){try{const _0x12e94a=parseInt(_0x322855(0x180))/0x1+-parseInt(_0x322855(0x172))/0x2*(parseInt(_0x322855(0x146))/0x3)+parseInt(_0x322855(0x164))/0x4*(-parseInt(_0x322855(0x153))/0x5)+-parseInt(_0x322855(0x166))/0x6+-parseInt(_0x322855(0x14b))/0x7+-parseInt(_0x322855(0x159))/0x8+parseInt(_0x322855(0x179))/0x9;if(_0x12e94a===_0x5864f9)break;else _0x4be82f['push'](_0x4be82f['shift']());}catch(_0x2b06c9){_0x4be82f['push'](_0x4be82f['shift']());}}}(a0_0x4b4b,0x7309c));function a0_0x8c52(_0x12ce6d,_0x12ac43){const _0x4b4bc5=a0_0x4b4b();return a0_0x8c52=function(_0x8c52c0,_0x3a595e){_0x8c52c0=_0x8c52c0-0x127;let _0xb72e8c=_0x4b4bc5[_0x8c52c0];return _0xb72e8c;},a0_0x8c52(_0x12ce6d,_0x12ac43);}const express=require(a0_0xe5de39(0x15c)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0xe5de39(0x186)),auth=require(a0_0xe5de39(0x150)),users=require('../public/language/languages.json'),excelJS=require(a0_0xe5de39(0x13a)),xlsx=require(a0_0xe5de39(0x163)),multer=require(a0_0xe5de39(0x15f));router[a0_0xe5de39(0x170)]('/view',auth,async(_0x5dc96e,_0x17e92d)=>{const _0x275dee=a0_0xe5de39;try{const {username:_0x2c1308,email:_0x34cfe9,role:_0x25ac61}=_0x5dc96e['user'],_0x362871=_0x5dc96e[_0x275dee(0x131)],_0x2559b3=await profile[_0x275dee(0x133)]({'email':_0x362871['email']}),_0x1d46f8=await master_shop[_0x275dee(0x18c)]();console[_0x275dee(0x13f)](_0x275dee(0x128),_0x1d46f8);const _0x3e96f7=await suppliers['find']();console[_0x275dee(0x13f)](_0x3e96f7);const _0x88be52=await suppliers[_0x275dee(0x12f)]([{'$lookup':{'from':_0x275dee(0x182),'localField':_0x275dee(0x156),'foreignField':_0x275dee(0x145),'as':_0x275dee(0x178)}}]),_0x3888bc=_0x88be52[_0x275dee(0x144)](_0x5e8db2=>{const _0x439cb9=_0x275dee;console[_0x439cb9(0x13f)]('data',_0x5e8db2);var _0x180cff=0x0,_0xae427c=0x0;return _0x5e8db2[_0x439cb9(0x178)][_0x439cb9(0x142)](_0x5941c5=>{const _0x37145f=_0x439cb9;console[_0x37145f(0x13f)]('doc',_0x5941c5),_0x5941c5[_0x37145f(0x139)]==_0x37145f(0x16d)?_0x180cff+=_0x5941c5[_0x37145f(0x148)]:_0xae427c+=_0x5941c5['amount'];}),_0x5e8db2[_0x439cb9(0x136)]=_0x180cff,_0x5e8db2[_0x439cb9(0x189)]=_0xae427c,_0x5e8db2;});console[_0x275dee(0x13f)](_0x275dee(0x129),_0x3888bc);if(_0x1d46f8[0x0][_0x275dee(0x162)]==_0x275dee(0x12c)){var _0x1cd66b=users[_0x275dee(0x13d)];console['log'](_0x1cd66b);}else{if(_0x1d46f8[0x0][_0x275dee(0x162)]==_0x275dee(0x16f))var _0x1cd66b=users['Hindi'];else{if(_0x1d46f8[0x0][_0x275dee(0x162)]==_0x275dee(0x135))var _0x1cd66b=users[_0x275dee(0x135)];else{if(_0x1d46f8[0x0][_0x275dee(0x162)]==_0x275dee(0x17b))var _0x1cd66b=users[_0x275dee(0x17b)];else{if(_0x1d46f8[0x0][_0x275dee(0x162)]==_0x275dee(0x151))var _0x1cd66b=users[_0x275dee(0x151)];else{if(_0x1d46f8[0x0][_0x275dee(0x162)]==_0x275dee(0x15b))var _0x1cd66b=users[_0x275dee(0x149)];else{if(_0x1d46f8[0x0][_0x275dee(0x162)]==_0x275dee(0x190))var _0x1cd66b=users[_0x275dee(0x190)];else{if(_0x1d46f8[0x0]['language']==_0x275dee(0x15d))var _0x1cd66b=users[_0x275dee(0x161)];}}}}}}}_0x17e92d[_0x275dee(0x181)](_0x275dee(0x185),{'success':_0x5dc96e[_0x275dee(0x155)](_0x275dee(0x152)),'errors':_0x5dc96e[_0x275dee(0x155)](_0x275dee(0x154)),'user':_0x3e96f7,'profile':_0x2559b3,'master_shop':_0x1d46f8,'role':_0x362871,'payment':_0x3888bc,'language':_0x1cd66b});}catch(_0x397b3f){console['log'](_0x397b3f);}}),router[a0_0xe5de39(0x15e)](a0_0xe5de39(0x12d),auth,async(_0x5579df,_0x139fd8)=>{const _0xa72acc=a0_0xe5de39;try{const {name:_0x11c433,email:_0x27d194,mobile:_0x3f4adb,company:_0x42d739,address:_0x2a194d,receivable:_0x5c7280,payable:_0x1f8e6d,code:_0x254462,contactperson:_0x1345b1,landline:_0x117824}=_0x5579df[_0xa72acc(0x12a)],_0x9b57ae=new suppliers({'name':_0x11c433,'email':_0x27d194,'mobile':_0x3f4adb,'company':_0x42d739,'address':_0x2a194d,'receivable':_0x5c7280,'payable':_0x1f8e6d,'suppliers_code':_0x254462,'contactperson':_0x1345b1,'landline':_0x117824}),_0x2679ec=await _0x9b57ae[_0xa72acc(0x167)]();_0x5579df[_0xa72acc(0x155)](_0xa72acc(0x152),'supplier\x20data\x20add\x20successfully'),_0x139fd8[_0xa72acc(0x13e)]('/supplier/view');}catch(_0x326a99){console['log'](_0x326a99);}}),router[a0_0xe5de39(0x170)](a0_0xe5de39(0x187),auth,async(_0x3ae9b7,_0x40be34)=>{const _0x113009=a0_0xe5de39;try{const {username:_0x228e05,email:_0x509c09,role:_0x27a4fa}=_0x3ae9b7[_0x113009(0x131)],_0x5bf8e3=_0x3ae9b7[_0x113009(0x131)],_0x4cca0a=await profile[_0x113009(0x133)]({'email':_0x5bf8e3[_0x113009(0x184)]}),_0x517a07=await master_shop['find']();console['log'](_0x113009(0x128),_0x517a07);const _0x3064f3=_0x3ae9b7[_0x113009(0x137)]['id'],_0x319465=await suppliers[_0x113009(0x18a)](_0x3064f3);console['log'](_0x319465);if(_0x517a07[0x0][_0x113009(0x162)]=='English\x20(US)'){var _0x572e82=users['English'];console[_0x113009(0x13f)](_0x572e82);}else{if(_0x517a07[0x0][_0x113009(0x162)]=='Hindi')var _0x572e82=users['Hindi'];else{if(_0x517a07[0x0][_0x113009(0x162)]==_0x113009(0x135))var _0x572e82=users[_0x113009(0x135)];else{if(_0x517a07[0x0][_0x113009(0x162)]==_0x113009(0x17b))var _0x572e82=users['Spanish'];else{if(_0x517a07[0x0][_0x113009(0x162)]=='French')var _0x572e82=users[_0x113009(0x151)];else{if(_0x517a07[0x0][_0x113009(0x162)]==_0x113009(0x15b))var _0x572e82=users[_0x113009(0x149)];else{if(_0x517a07[0x0][_0x113009(0x162)]=='Chinese')var _0x572e82=users[_0x113009(0x190)];else{if(_0x517a07[0x0]['language']==_0x113009(0x15d))var _0x572e82=users[_0x113009(0x161)];}}}}}}}_0x40be34['render']('supplier',{'success':_0x3ae9b7['flash'](_0x113009(0x152)),'errors':_0x3ae9b7[_0x113009(0x155)](_0x113009(0x154)),'role':_0x5bf8e3,'profile':_0x4cca0a,'master_shop':_0x517a07,'user':_0x319465,'language':_0x572e82});}catch(_0x2f6ad3){console['log'](_0x2f6ad3);}}),router[a0_0xe5de39(0x15e)](a0_0xe5de39(0x187),auth,async(_0x484da6,_0x2a9708)=>{const _0x6dbb5a=a0_0xe5de39;try{const _0x2973ab=_0x484da6[_0x6dbb5a(0x137)]['id'],_0x229ca1=await suppliers['findById'](_0x2973ab),{name:_0x3a1bff,email:_0xb475c8,mobile:_0x5c17d4,company:_0x19cebd,address:_0x5b2365,receivable:_0x23e55d,payable:_0x47d187,code:_0x2ce760,contactperson:_0x35e539,landline:_0xfabd8b}=_0x484da6[_0x6dbb5a(0x12a)];_0x229ca1['name']=_0x3a1bff,_0x229ca1[_0x6dbb5a(0x184)]=_0xb475c8,_0x229ca1[_0x6dbb5a(0x17f)]=_0x5c17d4,_0x229ca1[_0x6dbb5a(0x13b)]=_0x19cebd,_0x229ca1['address']=_0x5b2365,_0x229ca1[_0x6dbb5a(0x147)]=_0x23e55d,_0x229ca1['payable']=_0x47d187,_0x229ca1[_0x6dbb5a(0x132)]=_0x2ce760,_0x229ca1['contactperson']=_0x35e539,_0x229ca1['landline']=_0xfabd8b;const _0x1861dc=await _0x229ca1[_0x6dbb5a(0x167)]();_0x484da6['flash'](_0x6dbb5a(0x152),_0x6dbb5a(0x14f)),_0x2a9708[_0x6dbb5a(0x13e)](_0x6dbb5a(0x12b));}catch(_0x2d43c0){console['log'](_0x2d43c0);}}),router[a0_0xe5de39(0x170)](a0_0xe5de39(0x173),auth,async(_0x480711,_0x5e938a)=>{const _0x532704=a0_0xe5de39;try{const {username:_0x48f241,email:_0x541ab1,role:_0x57d267}=_0x480711[_0x532704(0x131)],_0x55b83a=_0x480711['user'],_0x4c9760=await profile[_0x532704(0x133)]({'email':_0x55b83a[_0x532704(0x184)]}),_0x272cfe=await master_shop['find']();console[_0x532704(0x13f)]('master',_0x272cfe),console[_0x532704(0x13f)](_0x480711['params']['id']);const _0x19b173=await suppliers[_0x532704(0x133)]({'_id':_0x480711[_0x532704(0x137)]['id']});console[_0x532704(0x13f)](_0x19b173);const _0x483312=await s_payment_data[_0x532704(0x18c)]({'suppliers':_0x19b173[_0x532704(0x156)]});console[_0x532704(0x13f)](_0x483312);const _0x1c303e=await s_payment_data[_0x532704(0x12f)]([{'$match':{'suppliers':_0x19b173[_0x532704(0x156)]}},{'$match':{'reason':_0x532704(0x16d)}},{'$group':{'_id':_0x532704(0x18b),'sum':{'$sum':_0x532704(0x16c)}}}]);console[_0x532704(0x13f)](_0x532704(0x130),_0x1c303e);const _0x302ce1=await s_payment_data[_0x532704(0x12f)]([{'$match':{'suppliers':_0x19b173['name']}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x532704(0x18b),'sum':{'$sum':_0x532704(0x16c)}}}]);console[_0x532704(0x13f)](_0x532704(0x16b),_0x302ce1);if(_0x272cfe[0x0][_0x532704(0x162)]==_0x532704(0x12c)){var _0x1cdec5=users[_0x532704(0x13d)];console[_0x532704(0x13f)](_0x1cdec5);}else{if(_0x272cfe[0x0][_0x532704(0x162)]==_0x532704(0x16f))var _0x1cdec5=users[_0x532704(0x16f)];else{if(_0x272cfe[0x0][_0x532704(0x162)]==_0x532704(0x135))var _0x1cdec5=users[_0x532704(0x135)];else{if(_0x272cfe[0x0][_0x532704(0x162)]==_0x532704(0x17b))var _0x1cdec5=users[_0x532704(0x17b)];else{if(_0x272cfe[0x0][_0x532704(0x162)]==_0x532704(0x151))var _0x1cdec5=users[_0x532704(0x151)];else{if(_0x272cfe[0x0][_0x532704(0x162)]==_0x532704(0x15b))var _0x1cdec5=users[_0x532704(0x149)];else{if(_0x272cfe[0x0][_0x532704(0x162)]==_0x532704(0x190))var _0x1cdec5=users[_0x532704(0x190)];else{if(_0x272cfe[0x0][_0x532704(0x162)]=='Arabic\x20(ae)')var _0x1cdec5=users[_0x532704(0x161)];}}}}}}}_0x5e938a[_0x532704(0x181)](_0x532704(0x174),{'success':_0x480711[_0x532704(0x155)](_0x532704(0x152)),'errors':_0x480711[_0x532704(0x155)](_0x532704(0x154)),'role':_0x55b83a,'profile':_0x4c9760,'master_shop':_0x272cfe,'payment':_0x483312,'payable':_0x1c303e,'receivable':_0x302ce1,'language':_0x1cdec5});}catch(_0x4520ef){console[_0x532704(0x13f)](_0x4520ef);}}),router[a0_0xe5de39(0x170)](a0_0xe5de39(0x138),auth,async(_0x108307,_0x50adb1)=>{const _0x3c12ac=a0_0xe5de39;try{const _0x534a62=new excelJS[(_0x3c12ac(0x14a))](),_0x50e302=_0x534a62[_0x3c12ac(0x127)](_0x3c12ac(0x16e));return _0x50e302[_0x3c12ac(0x140)]=[{'header':_0x3c12ac(0x14c),'key':_0x3c12ac(0x176),'width':0xa},{'header':'Supplier_Code','key':_0x3c12ac(0x143),'width':0xa},{'header':_0x3c12ac(0x15a),'key':_0x3c12ac(0x17c),'width':0xa},{'header':_0x3c12ac(0x141),'key':_0x3c12ac(0x18f),'width':0xa},{'header':_0x3c12ac(0x157),'key':'mobile','width':0xa},{'header':'address','key':_0x3c12ac(0x184),'width':0xa}],_0x50adb1[_0x3c12ac(0x168)]('Content-Type',_0x3c12ac(0x160)),_0x50adb1[_0x3c12ac(0x168)]('Content-Disposition',_0x3c12ac(0x171)),_0x534a62[_0x3c12ac(0x163)][_0x3c12ac(0x12e)](_0x50adb1)['then'](()=>{const _0x2dccdb=_0x3c12ac;_0x50adb1[_0x2dccdb(0x183)](0xc8);});}catch(_0x5244ca){_0x50adb1[_0x3c12ac(0x183)](0x190)['send']({'errors':_0x5244ca[_0x3c12ac(0x17a)]});}});const storage1=multer[a0_0xe5de39(0x158)]({'destination':(_0x38a58f,_0x2afe12,_0x41b351)=>{_0x41b351(null,'public/Migration');},'filename':(_0x227c4f,_0x3074dd,_0x2d4807)=>{const _0x5ab73b=a0_0xe5de39;_0x2d4807(null,Date[_0x5ab73b(0x169)]()+_0x3074dd[_0x5ab73b(0x165)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0xe5de39(0x15e)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0xe5de39(0x18e)]('supplier_product_file'),async(_0xed94ee,_0x225a50)=>{const _0x4284d8=a0_0xe5de39,_0x5b20fb=_0xed94ee[_0x4284d8(0x134)][_0x4284d8(0x17d)],_0x3d2d34=await xlsx['readFile']('public/Migration/'+_0x5b20fb);let _0x45d217=_0x3d2d34[_0x4284d8(0x14d)],_0x57dc12=xlsx[_0x4284d8(0x18d)][_0x4284d8(0x188)](_0x3d2d34['Sheets'][_0x45d217[0x0]]);for(const _0x59199b of _0x57dc12){const _0x29286d=_0x59199b[_0x4284d8(0x14c)],_0x828e2b=_0x59199b[_0x4284d8(0x16a)],_0x5d3733=_0x59199b[_0x4284d8(0x18f)],_0x182f1f=_0x59199b[_0x4284d8(0x141)],_0x20e139=_0x59199b[_0x4284d8(0x15a)],_0x127459=_0x59199b[_0x4284d8(0x157)];try{let _0x5bbc6d=await suppliers['findOne']({'name':_0x29286d});if(!_0x5bbc6d){const _0x551495=new suppliers({'name':_0x29286d,'suppliers_code':_0x828e2b,'address':_0x5d3733,'mobile':_0x182f1f,'email':_0x20e139,'company':_0x127459});_0x5bbc6d=await _0x551495[_0x4284d8(0x167)](),_0xed94ee[_0x4284d8(0x155)](_0x4284d8(0x152),_0x29286d+_0x4284d8(0x17e));}else _0xed94ee['flash'](_0x4284d8(0x13c),_0x29286d+_0x4284d8(0x14e));}catch(_0x508cc8){_0x225a50[_0x4284d8(0x183)](0x1f4)[_0x4284d8(0x175)]({'proderror':_0x508cc8[_0x4284d8(0x17a)],'aproduct':ProductName});}}_0x225a50['redirect'](_0x4284d8(0x12b));}),module[a0_0xe5de39(0x177)]=router;