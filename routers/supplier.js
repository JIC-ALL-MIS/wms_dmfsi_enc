const a0_0x5431f2=a0_0xc55e;(function(_0x568b31,_0x3af134){const _0x2d63ff=a0_0xc55e,_0x3ece55=_0x568b31();while(!![]){try{const _0x165c24=parseInt(_0x2d63ff(0x1b4))/0x1*(parseInt(_0x2d63ff(0x1a2))/0x2)+-parseInt(_0x2d63ff(0x1dc))/0x3*(parseInt(_0x2d63ff(0x1e3))/0x4)+parseInt(_0x2d63ff(0x1a1))/0x5*(parseInt(_0x2d63ff(0x1fc))/0x6)+parseInt(_0x2d63ff(0x1c2))/0x7+-parseInt(_0x2d63ff(0x1fa))/0x8*(-parseInt(_0x2d63ff(0x1e4))/0x9)+-parseInt(_0x2d63ff(0x1f7))/0xa+parseInt(_0x2d63ff(0x1cb))/0xb*(-parseInt(_0x2d63ff(0x1bd))/0xc);if(_0x165c24===_0x3af134)break;else _0x3ece55['push'](_0x3ece55['shift']());}catch(_0x4eae31){_0x3ece55['push'](_0x3ece55['shift']());}}}(a0_0x9c21,0x8723d));const express=require('express'),app=express(),router=express[a0_0x5431f2(0x1fb)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x5431f2(0x1ae)),auth=require(a0_0x5431f2(0x1ef)),users=require(a0_0x5431f2(0x195)),excelJS=require('exceljs'),xlsx=require('xlsx'),multer=require(a0_0x5431f2(0x1b5));router[a0_0x5431f2(0x1d7)](a0_0x5431f2(0x1b7),auth,async(_0x235a53,_0x44c397)=>{const _0x135540=a0_0x5431f2;try{const {username:_0xff8cb2,email:_0x4a1aef,role:_0x49deae}=_0x235a53[_0x135540(0x19d)],_0x4477cf=_0x235a53[_0x135540(0x19d)],_0x31e5cb=await profile[_0x135540(0x1c9)]({'email':_0x4477cf[_0x135540(0x1e1)]}),_0x1d0812=await master_shop[_0x135540(0x1a0)]();console['log'](_0x135540(0x1ed),_0x1d0812);const _0x155d53=await suppliers['find']();console['log'](_0x155d53);const _0x5ca005=await suppliers['aggregate']([{'$lookup':{'from':_0x135540(0x1d4),'localField':_0x135540(0x197),'foreignField':'suppliers','as':_0x135540(0x1bf)}}]),_0x4dc8df=_0x5ca005[_0x135540(0x1da)](_0x60697d=>{const _0x51e2fa=_0x135540;console['log']('data',_0x60697d);var _0x1522c8=0x0,_0x363b25=0x0;return _0x60697d[_0x51e2fa(0x1bf)][_0x51e2fa(0x1d9)](_0x20967a=>{const _0x162539=_0x51e2fa;console[_0x162539(0x1e9)]('doc',_0x20967a),_0x20967a[_0x162539(0x1a6)]=='Purchase'?_0x1522c8+=_0x20967a['amount']:_0x363b25+=_0x20967a[_0x162539(0x1dd)];}),_0x60697d[_0x51e2fa(0x1a5)]=_0x1522c8,_0x60697d[_0x51e2fa(0x1f5)]=_0x363b25,_0x60697d;});console[_0x135540(0x1e9)]('supplier.js\x20payment_data',_0x4dc8df);if(_0x1d0812[0x0][_0x135540(0x1e7)]==_0x135540(0x1ec)){var _0x38a1a3=users['English'];console[_0x135540(0x1e9)](_0x38a1a3);}else{if(_0x1d0812[0x0]['language']==_0x135540(0x19f))var _0x38a1a3=users['Hindi'];else{if(_0x1d0812[0x0][_0x135540(0x1e7)]==_0x135540(0x1ce))var _0x38a1a3=users[_0x135540(0x1ce)];else{if(_0x1d0812[0x0][_0x135540(0x1e7)]==_0x135540(0x1a9))var _0x38a1a3=users['Spanish'];else{if(_0x1d0812[0x0][_0x135540(0x1e7)]=='French')var _0x38a1a3=users[_0x135540(0x1b6)];else{if(_0x1d0812[0x0][_0x135540(0x1e7)]==_0x135540(0x194))var _0x38a1a3=users['Portuguese'];else{if(_0x1d0812[0x0][_0x135540(0x1e7)]==_0x135540(0x19a))var _0x38a1a3=users[_0x135540(0x19a)];else{if(_0x1d0812[0x0]['language']==_0x135540(0x1cc))var _0x38a1a3=users[_0x135540(0x1ab)];}}}}}}}_0x44c397[_0x135540(0x1b9)](_0x135540(0x1e8),{'success':_0x235a53[_0x135540(0x1e2)]('success'),'errors':_0x235a53[_0x135540(0x1e2)](_0x135540(0x1df)),'user':_0x155d53,'profile':_0x31e5cb,'master_shop':_0x1d0812,'role':_0x4477cf,'payment':_0x4dc8df,'language':_0x38a1a3});}catch(_0x44ef5b){console[_0x135540(0x1e9)](_0x44ef5b);}}),router['post'](a0_0x5431f2(0x1b7),auth,async(_0x49c36d,_0x3253c6)=>{const _0x5500be=a0_0x5431f2;try{const {name:_0x4e802,email:_0x1b6118,mobile:_0x298bc9,company:_0x2c67eb,address:_0x2eda21,receivable:_0x482ac9,payable:_0x4c85aa,code:_0x50fee5,contactperson:_0x44006b,landline:_0x2f45d0}=_0x49c36d[_0x5500be(0x1b1)],_0x2652c7=new suppliers({'name':_0x4e802,'email':_0x1b6118,'mobile':_0x298bc9,'company':_0x2c67eb,'address':_0x2eda21,'receivable':_0x482ac9,'payable':_0x4c85aa,'suppliers_code':_0x50fee5,'contactperson':_0x44006b,'landline':_0x2f45d0}),_0x3368be=await _0x2652c7[_0x5500be(0x1ad)]();_0x49c36d[_0x5500be(0x1e2)](_0x5500be(0x1e0),'supplier\x20data\x20add\x20successfully'),_0x3253c6[_0x5500be(0x1ee)](_0x5500be(0x1b0));}catch(_0x389c83){console[_0x5500be(0x1e9)](_0x389c83);}}),router[a0_0x5431f2(0x1d7)](a0_0x5431f2(0x1c5),auth,async(_0x3e0890,_0x24313e)=>{const _0x575815=a0_0x5431f2;try{const {username:_0x3fefb1,email:_0x1a517a,role:_0x3dec}=_0x3e0890[_0x575815(0x19d)],_0x5adbe2=_0x3e0890['user'],_0x19aa89=await profile['findOne']({'email':_0x5adbe2[_0x575815(0x1e1)]}),_0x188cfd=await master_shop[_0x575815(0x1a0)]();console[_0x575815(0x1e9)]('master',_0x188cfd);const _0x5c2d13=_0x3e0890[_0x575815(0x1f9)]['id'],_0x132198=await suppliers['findById'](_0x5c2d13);console[_0x575815(0x1e9)](_0x132198);if(_0x188cfd[0x0][_0x575815(0x1e7)]=='English\x20(US)'){var _0x14e674=users[_0x575815(0x1d3)];console[_0x575815(0x1e9)](_0x14e674);}else{if(_0x188cfd[0x0][_0x575815(0x1e7)]==_0x575815(0x19f))var _0x14e674=users[_0x575815(0x19f)];else{if(_0x188cfd[0x0]['language']==_0x575815(0x1ce))var _0x14e674=users['German'];else{if(_0x188cfd[0x0][_0x575815(0x1e7)]==_0x575815(0x1a9))var _0x14e674=users[_0x575815(0x1a9)];else{if(_0x188cfd[0x0][_0x575815(0x1e7)]==_0x575815(0x1b6))var _0x14e674=users['French'];else{if(_0x188cfd[0x0][_0x575815(0x1e7)]==_0x575815(0x194))var _0x14e674=users[_0x575815(0x1c1)];else{if(_0x188cfd[0x0]['language']=='Chinese')var _0x14e674=users[_0x575815(0x19a)];else{if(_0x188cfd[0x0][_0x575815(0x1e7)]==_0x575815(0x1cc))var _0x14e674=users[_0x575815(0x1ab)];}}}}}}}_0x24313e[_0x575815(0x1b9)](_0x575815(0x1e8),{'success':_0x3e0890[_0x575815(0x1e2)]('success'),'errors':_0x3e0890['flash'](_0x575815(0x1df)),'role':_0x5adbe2,'profile':_0x19aa89,'master_shop':_0x188cfd,'user':_0x132198,'language':_0x14e674});}catch(_0x4317ca){console[_0x575815(0x1e9)](_0x4317ca);}}),router[a0_0x5431f2(0x193)](a0_0x5431f2(0x1c5),auth,async(_0x2d76a4,_0x4b0a17)=>{const _0x243abb=a0_0x5431f2;try{const _0x5e6ac2=_0x2d76a4[_0x243abb(0x1f9)]['id'],_0x1d6142=await suppliers[_0x243abb(0x192)](_0x5e6ac2),{name:_0x55be8f,email:_0x295d6c,mobile:_0x15a1c1,company:_0x30f3f8,address:_0x5b5c7c,receivable:_0x2e490a,payable:_0x178fd8,code:_0x2f2817,contactperson:_0xe663f5,landline:_0xa8697a}=_0x2d76a4[_0x243abb(0x1b1)];_0x1d6142['name']=_0x55be8f,_0x1d6142[_0x243abb(0x1e1)]=_0x295d6c,_0x1d6142[_0x243abb(0x1f8)]=_0x15a1c1,_0x1d6142[_0x243abb(0x1c8)]=_0x30f3f8,_0x1d6142[_0x243abb(0x1e5)]=_0x5b5c7c,_0x1d6142[_0x243abb(0x1d2)]=_0x2e490a,_0x1d6142[_0x243abb(0x1af)]=_0x178fd8,_0x1d6142['suppliers_code']=_0x2f2817,_0x1d6142[_0x243abb(0x19b)]=_0xe663f5,_0x1d6142[_0x243abb(0x19c)]=_0xa8697a;const _0x2dcdd9=await _0x1d6142[_0x243abb(0x1ad)]();_0x2d76a4['flash'](_0x243abb(0x1e0),_0x243abb(0x1d8)),_0x4b0a17[_0x243abb(0x1ee)](_0x243abb(0x1b0));}catch(_0x27756f){console['log'](_0x27756f);}}),router[a0_0x5431f2(0x1d7)](a0_0x5431f2(0x191),auth,async(_0x3a9b1d,_0x5961af)=>{const _0xc45934=a0_0x5431f2;try{const {username:_0x303e05,email:_0x51c132,role:_0x2487a9}=_0x3a9b1d[_0xc45934(0x19d)],_0x36b381=_0x3a9b1d[_0xc45934(0x19d)],_0x204d12=await profile[_0xc45934(0x1c9)]({'email':_0x36b381[_0xc45934(0x1e1)]}),_0x511e3c=await master_shop[_0xc45934(0x1a0)]();console[_0xc45934(0x1e9)]('master',_0x511e3c),console['log'](_0x3a9b1d['params']['id']);const _0x422d35=await suppliers[_0xc45934(0x1c9)]({'_id':_0x3a9b1d[_0xc45934(0x1f9)]['id']});console[_0xc45934(0x1e9)](_0x422d35);const _0x3fb189=await s_payment_data['find']({'suppliers':_0x422d35[_0xc45934(0x197)]});console[_0xc45934(0x1e9)](_0x3fb189);const _0x3520fd=await s_payment_data[_0xc45934(0x1a3)]([{'$match':{'suppliers':_0x422d35[_0xc45934(0x197)]}},{'$match':{'reason':_0xc45934(0x1d5)}},{'$group':{'_id':_0xc45934(0x1d0),'sum':{'$sum':_0xc45934(0x1c3)}}}]);console[_0xc45934(0x1e9)]('payable_sum',_0x3520fd);const _0x1de266=await s_payment_data[_0xc45934(0x1a3)]([{'$match':{'suppliers':_0x422d35[_0xc45934(0x197)]}},{'$match':{'reason':_0xc45934(0x1eb)}},{'$group':{'_id':_0xc45934(0x1d0),'sum':{'$sum':_0xc45934(0x1c3)}}}]);console[_0xc45934(0x1e9)](_0xc45934(0x196),_0x1de266);if(_0x511e3c[0x0][_0xc45934(0x1e7)]==_0xc45934(0x1ec)){var _0x310570=users[_0xc45934(0x1d3)];console['log'](_0x310570);}else{if(_0x511e3c[0x0][_0xc45934(0x1e7)]=='Hindi')var _0x310570=users[_0xc45934(0x19f)];else{if(_0x511e3c[0x0][_0xc45934(0x1e7)]=='German')var _0x310570=users[_0xc45934(0x1ce)];else{if(_0x511e3c[0x0][_0xc45934(0x1e7)]=='Spanish')var _0x310570=users[_0xc45934(0x1a9)];else{if(_0x511e3c[0x0]['language']==_0xc45934(0x1b6))var _0x310570=users[_0xc45934(0x1b6)];else{if(_0x511e3c[0x0][_0xc45934(0x1e7)]==_0xc45934(0x194))var _0x310570=users[_0xc45934(0x1c1)];else{if(_0x511e3c[0x0]['language']==_0xc45934(0x19a))var _0x310570=users[_0xc45934(0x19a)];else{if(_0x511e3c[0x0][_0xc45934(0x1e7)]=='Arabic\x20(ae)')var _0x310570=users[_0xc45934(0x1ab)];}}}}}}}_0x5961af['render'](_0xc45934(0x1c7),{'success':_0x3a9b1d[_0xc45934(0x1e2)](_0xc45934(0x1e0)),'errors':_0x3a9b1d['flash']('errors'),'role':_0x36b381,'profile':_0x204d12,'master_shop':_0x511e3c,'payment':_0x3fb189,'payable':_0x3520fd,'receivable':_0x1de266,'language':_0x310570});}catch(_0x56ed70){console[_0xc45934(0x1e9)](_0x56ed70);}}),router[a0_0x5431f2(0x1d7)](a0_0x5431f2(0x1fd),auth,async(_0x334ed9,_0x11ed28)=>{const _0x11c41b=a0_0x5431f2;try{const _0x50269c=new excelJS['Workbook'](),_0x428843=_0x50269c[_0x11c41b(0x1cd)](_0x11c41b(0x1d6));return _0x428843[_0x11c41b(0x1a7)]=[{'header':_0x11c41b(0x1a4),'key':'PBrands','width':0xa},{'header':_0x11c41b(0x19e),'key':_0x11c41b(0x1be),'width':0xa},{'header':_0x11c41b(0x1ac),'key':'SalesmanName','width':0xa},{'header':'Mobile_number','key':'address','width':0xa},{'header':_0x11c41b(0x1f6),'key':_0x11c41b(0x1f8),'width':0xa},{'header':'address','key':_0x11c41b(0x1e1),'width':0xa}],_0x11ed28[_0x11c41b(0x1e6)]('Content-Type',_0x11c41b(0x1f1)),_0x11ed28[_0x11c41b(0x1e6)]('Content-Disposition',_0x11c41b(0x1bc)),_0x50269c[_0x11c41b(0x1b2)][_0x11c41b(0x198)](_0x11ed28)['then'](()=>{_0x11ed28['status'](0xc8);});}catch(_0x4dde6f){_0x11ed28[_0x11c41b(0x1cf)](0x190)[_0x11c41b(0x1ca)]({'errors':_0x4dde6f[_0x11c41b(0x1ea)]});}});const storage1=multer[a0_0x5431f2(0x1f2)]({'destination':(_0x2583a6,_0x18efac,_0x80f266)=>{const _0x23b12d=a0_0x5431f2;_0x80f266(null,_0x23b12d(0x1de));},'filename':(_0x311cdc,_0x286c33,_0x23d79a)=>{const _0x121efc=a0_0x5431f2;_0x23d79a(null,Date[_0x121efc(0x1f3)]()+_0x286c33[_0x121efc(0x1c0)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x9c21(){const _0x14fe64=['single','purchase_return','Company_Name','7658810bMkdUe','mobile','params','160LLHGnh','Router','174gzGAKK','/products_export_migrate_file','/view/payment/:id','findById','post','Portuguese\x20(BR)','../public/language/languages.json','receivable_sum','name','write','filename','Chinese','contactperson','landline','user','Supplier_Code','Hindi','find','57870IRZnTq','56Wlnnfg','aggregate','Name','purchase','reason','columns','utils','Spanish','supplier_product_file','Arabic','Email','save','../models/all_models','payable','/supplier/view','body','xlsx','SheetNames','36007GIbQLQ','multer','French','/view','sheet_to_json','render','public/Migration/','file','attachment;\x20filename=supplier_Migration_File.xlsx','144Rtkjdf','PUnits','suppliers_docs','originalname','Portuguese','7210637jwVcPd','$amount','json','/view/:id','Mobile_number','supplier_payment','company','findOne','send','1117083FUnaEC','Arabic\x20(ae)','addWorksheet','German','status','$reason','\x20added\x20successfully','receivable','English','s_payments','Purchase','Customers','get','supplier\x20data\x20update\x20successfully','forEach','map','error','3hiaxCx','amount','public/Migration','errors','success','email','flash','2991212WjPTvx','410364bQbAZl','address','setHeader','language','supplier','log','message','Purchase\x20Return','English\x20(US)','master','redirect','../middleware/auth','readFile','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','diskStorage','now'];a0_0x9c21=function(){return _0x14fe64;};return a0_0x9c21();}function a0_0xc55e(_0x546ae2,_0x375238){const _0x9c2175=a0_0x9c21();return a0_0xc55e=function(_0xc55e44,_0x1273ec){_0xc55e44=_0xc55e44-0x191;let _0x2c9bf0=_0x9c2175[_0xc55e44];return _0x2c9bf0;},a0_0xc55e(_0x546ae2,_0x375238);}router[a0_0x5431f2(0x193)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x5431f2(0x1f4)](a0_0x5431f2(0x1aa)),async(_0x40dc19,_0x44cbf3)=>{const _0x479bbf=a0_0x5431f2,_0x5dddad=_0x40dc19[_0x479bbf(0x1bb)][_0x479bbf(0x199)],_0x185295=await xlsx[_0x479bbf(0x1f0)](_0x479bbf(0x1ba)+_0x5dddad);let _0x38878f=_0x185295[_0x479bbf(0x1b3)],_0x4cbb09=xlsx[_0x479bbf(0x1a8)][_0x479bbf(0x1b8)](_0x185295['Sheets'][_0x38878f[0x0]]);for(const _0xd50ec8 of _0x4cbb09){const _0x2c5772=_0xd50ec8[_0x479bbf(0x1a4)],_0x36b78f=_0xd50ec8[_0x479bbf(0x19e)],_0x33162b=_0xd50ec8[_0x479bbf(0x1e5)],_0x585d8f=_0xd50ec8[_0x479bbf(0x1c6)],_0x17f255=_0xd50ec8[_0x479bbf(0x1ac)],_0x3e8766=_0xd50ec8[_0x479bbf(0x1f6)];try{let _0x5e8a4a=await suppliers['findOne']({'name':_0x2c5772});if(!_0x5e8a4a){const _0x5cb39b=new suppliers({'name':_0x2c5772,'suppliers_code':_0x36b78f,'address':_0x33162b,'mobile':_0x585d8f,'email':_0x17f255,'company':_0x3e8766});_0x5e8a4a=await _0x5cb39b[_0x479bbf(0x1ad)](),_0x40dc19[_0x479bbf(0x1e2)](_0x479bbf(0x1e0),_0x2c5772+_0x479bbf(0x1d1));}else _0x40dc19[_0x479bbf(0x1e2)](_0x479bbf(0x1db),_0x2c5772+'\x20Failed');}catch(_0x13f8fc){_0x44cbf3[_0x479bbf(0x1cf)](0x1f4)[_0x479bbf(0x1c4)]({'proderror':_0x13f8fc[_0x479bbf(0x1ea)],'aproduct':ProductName});}}_0x44cbf3[_0x479bbf(0x1ee)](_0x479bbf(0x1b0));}),module['exports']=router;