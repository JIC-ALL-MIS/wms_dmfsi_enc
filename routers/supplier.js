const a0_0x1a86d9=a0_0xea04;(function(_0x3e6215,_0x3e9aa4){const _0x46a3b2=a0_0xea04,_0x37808b=_0x3e6215();while(!![]){try{const _0x3e9488=-parseInt(_0x46a3b2(0x20e))/0x1*(parseInt(_0x46a3b2(0x1ab))/0x2)+-parseInt(_0x46a3b2(0x1ca))/0x3*(-parseInt(_0x46a3b2(0x200))/0x4)+-parseInt(_0x46a3b2(0x1cb))/0x5*(parseInt(_0x46a3b2(0x1e9))/0x6)+-parseInt(_0x46a3b2(0x1ee))/0x7*(parseInt(_0x46a3b2(0x209))/0x8)+-parseInt(_0x46a3b2(0x1b2))/0x9+-parseInt(_0x46a3b2(0x1bb))/0xa*(parseInt(_0x46a3b2(0x1f8))/0xb)+-parseInt(_0x46a3b2(0x1ce))/0xc*(-parseInt(_0x46a3b2(0x203))/0xd);if(_0x3e9488===_0x3e9aa4)break;else _0x37808b['push'](_0x37808b['shift']());}catch(_0x5e5184){_0x37808b['push'](_0x37808b['shift']());}}}(a0_0x49c3,0xcc11b));function a0_0xea04(_0x26bb03,_0x98f1c5){const _0x49c3b5=a0_0x49c3();return a0_0xea04=function(_0xea0401,_0x1e35b7){_0xea0401=_0xea0401-0x1a3;let _0x445599=_0x49c3b5[_0xea0401];return _0x445599;},a0_0xea04(_0x26bb03,_0x98f1c5);}const express=require(a0_0x1a86d9(0x1ed)),app=express(),router=express[a0_0x1a86d9(0x1c3)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x1a86d9(0x1dd)),excelJS=require(a0_0x1a86d9(0x1aa)),xlsx=require(a0_0x1a86d9(0x1b8)),multer=require(a0_0x1a86d9(0x1d9));router['get'](a0_0x1a86d9(0x1cc),auth,async(_0x418db6,_0x312fa0)=>{const _0x192bb3=a0_0x1a86d9;try{const {username:_0x157b4b,email:_0x351a28,role:_0x4021fc}=_0x418db6[_0x192bb3(0x1ba)],_0x3dce02=_0x418db6[_0x192bb3(0x1ba)],_0x543dac=await profile[_0x192bb3(0x1f9)]({'email':_0x3dce02[_0x192bb3(0x1e0)]}),_0x58c795=await master_shop[_0x192bb3(0x1b0)]();console[_0x192bb3(0x1fe)](_0x192bb3(0x1fd),_0x58c795);const _0x215f16=await suppliers[_0x192bb3(0x1b0)]();console[_0x192bb3(0x1fe)](_0x215f16);const _0x1b02d9=await suppliers[_0x192bb3(0x1fa)]([{'$lookup':{'from':_0x192bb3(0x1b6),'localField':_0x192bb3(0x1e7),'foreignField':_0x192bb3(0x1d0),'as':_0x192bb3(0x20b)}}]),_0xa8585c=_0x1b02d9['map'](_0x44aeaa=>{const _0x4b4a5c=_0x192bb3;console[_0x4b4a5c(0x1fe)](_0x4b4a5c(0x20f),_0x44aeaa);var _0x142819=0x0,_0x205027=0x0;return _0x44aeaa[_0x4b4a5c(0x20b)][_0x4b4a5c(0x1a9)](_0x1ac048=>{const _0x36546e=_0x4b4a5c;console[_0x36546e(0x1fe)](_0x36546e(0x1fc),_0x1ac048),_0x1ac048[_0x36546e(0x1d3)]==_0x36546e(0x208)?_0x142819+=_0x1ac048[_0x36546e(0x1bf)]:_0x205027+=_0x1ac048[_0x36546e(0x1bf)];}),_0x44aeaa['purchase']=_0x142819,_0x44aeaa[_0x4b4a5c(0x1e4)]=_0x205027,_0x44aeaa;});console['log'](_0x192bb3(0x1a3),_0xa8585c);if(_0x58c795[0x0][_0x192bb3(0x1d8)]=='English\x20(US)'){var _0x2a1ac4=users[_0x192bb3(0x1b5)];console[_0x192bb3(0x1fe)](_0x2a1ac4);}else{if(_0x58c795[0x0][_0x192bb3(0x1d8)]==_0x192bb3(0x1d4))var _0x2a1ac4=users[_0x192bb3(0x1d4)];else{if(_0x58c795[0x0][_0x192bb3(0x1d8)]==_0x192bb3(0x206))var _0x2a1ac4=users['German'];else{if(_0x58c795[0x0]['language']==_0x192bb3(0x1ec))var _0x2a1ac4=users[_0x192bb3(0x1ec)];else{if(_0x58c795[0x0][_0x192bb3(0x1d8)]=='French')var _0x2a1ac4=users[_0x192bb3(0x1b7)];else{if(_0x58c795[0x0][_0x192bb3(0x1d8)]=='Portuguese\x20(BR)')var _0x2a1ac4=users[_0x192bb3(0x204)];else{if(_0x58c795[0x0][_0x192bb3(0x1d8)]==_0x192bb3(0x1f4))var _0x2a1ac4=users[_0x192bb3(0x1f4)];else{if(_0x58c795[0x0][_0x192bb3(0x1d8)]=='Arabic\x20(ae)')var _0x2a1ac4=users[_0x192bb3(0x201)];}}}}}}}_0x312fa0[_0x192bb3(0x1da)]('supplier',{'success':_0x418db6[_0x192bb3(0x1af)](_0x192bb3(0x1be)),'errors':_0x418db6[_0x192bb3(0x1af)](_0x192bb3(0x1ae)),'user':_0x215f16,'profile':_0x543dac,'master_shop':_0x58c795,'role':_0x3dce02,'payment':_0xa8585c,'language':_0x2a1ac4});}catch(_0x273fdd){console[_0x192bb3(0x1fe)](_0x273fdd);}}),router[a0_0x1a86d9(0x1b4)](a0_0x1a86d9(0x1cc),auth,async(_0x3d9557,_0x1abfe3)=>{const _0x4094ba=a0_0x1a86d9;try{const {name:_0x36b1e9,email:_0x1a8dc8,mobile:_0x30d6b1,company:_0x4fdf90,address:_0x3342be,receivable:_0x5f04df,payable:_0x43793f,code:_0x495e2f,contactperson:_0x2e4841,landline:_0x30c575}=_0x3d9557[_0x4094ba(0x1e5)],_0x266578=new suppliers({'name':_0x36b1e9,'email':_0x1a8dc8,'mobile':_0x30d6b1,'company':_0x4fdf90,'address':_0x3342be,'receivable':_0x5f04df,'payable':_0x43793f,'suppliers_code':_0x495e2f,'contactperson':_0x2e4841,'landline':_0x30c575}),_0x60148b=await _0x266578[_0x4094ba(0x1d7)]();_0x3d9557[_0x4094ba(0x1af)](_0x4094ba(0x1be),_0x4094ba(0x1a4)),_0x1abfe3[_0x4094ba(0x1f3)](_0x4094ba(0x1db));}catch(_0x2f0f7d){console[_0x4094ba(0x1fe)](_0x2f0f7d);}}),router[a0_0x1a86d9(0x1f2)]('/view/:id',auth,async(_0x39b3d2,_0x33bb16)=>{const _0x33dc8e=a0_0x1a86d9;try{const {username:_0x2e422c,email:_0x3ac3b5,role:_0x204c12}=_0x39b3d2[_0x33dc8e(0x1ba)],_0xb28101=_0x39b3d2[_0x33dc8e(0x1ba)],_0x31bb58=await profile['findOne']({'email':_0xb28101[_0x33dc8e(0x1e0)]}),_0x12a91d=await master_shop['find']();console[_0x33dc8e(0x1fe)](_0x33dc8e(0x1fd),_0x12a91d);const _0x16cd82=_0x39b3d2[_0x33dc8e(0x1ac)]['id'],_0x1f6725=await suppliers['findById'](_0x16cd82);console[_0x33dc8e(0x1fe)](_0x1f6725);if(_0x12a91d[0x0][_0x33dc8e(0x1d8)]==_0x33dc8e(0x1e1)){var _0x3d917c=users['English'];console['log'](_0x3d917c);}else{if(_0x12a91d[0x0][_0x33dc8e(0x1d8)]=='Hindi')var _0x3d917c=users[_0x33dc8e(0x1d4)];else{if(_0x12a91d[0x0]['language']==_0x33dc8e(0x206))var _0x3d917c=users[_0x33dc8e(0x206)];else{if(_0x12a91d[0x0][_0x33dc8e(0x1d8)]==_0x33dc8e(0x1ec))var _0x3d917c=users[_0x33dc8e(0x1ec)];else{if(_0x12a91d[0x0][_0x33dc8e(0x1d8)]=='French')var _0x3d917c=users[_0x33dc8e(0x1b7)];else{if(_0x12a91d[0x0][_0x33dc8e(0x1d8)]=='Portuguese\x20(BR)')var _0x3d917c=users['Portuguese'];else{if(_0x12a91d[0x0][_0x33dc8e(0x1d8)]==_0x33dc8e(0x1f4))var _0x3d917c=users[_0x33dc8e(0x1f4)];else{if(_0x12a91d[0x0][_0x33dc8e(0x1d8)]==_0x33dc8e(0x1ea))var _0x3d917c=users[_0x33dc8e(0x201)];}}}}}}}_0x33bb16['render'](_0x33dc8e(0x1ef),{'success':_0x39b3d2[_0x33dc8e(0x1af)](_0x33dc8e(0x1be)),'errors':_0x39b3d2['flash'](_0x33dc8e(0x1ae)),'role':_0xb28101,'profile':_0x31bb58,'master_shop':_0x12a91d,'user':_0x1f6725,'language':_0x3d917c});}catch(_0x282007){console[_0x33dc8e(0x1fe)](_0x282007);}}),router[a0_0x1a86d9(0x1b4)](a0_0x1a86d9(0x1c9),auth,async(_0x5e5bbd,_0x1eff23)=>{const _0x467025=a0_0x1a86d9;try{const _0xc26b5f=_0x5e5bbd[_0x467025(0x1ac)]['id'],_0x2686db=await suppliers['findById'](_0xc26b5f),{name:_0x17b066,email:_0x3388d6,mobile:_0x2f59b0,company:_0x176770,address:_0x4bdcc2,receivable:_0x3d9ba8,payable:_0xc1a542,code:_0x126d3c,contactperson:_0x4c87a2,landline:_0x3d6c47}=_0x5e5bbd['body'];_0x2686db['name']=_0x17b066,_0x2686db[_0x467025(0x1e0)]=_0x3388d6,_0x2686db[_0x467025(0x20a)]=_0x2f59b0,_0x2686db[_0x467025(0x1c2)]=_0x176770,_0x2686db['address']=_0x4bdcc2,_0x2686db[_0x467025(0x1b3)]=_0x3d9ba8,_0x2686db[_0x467025(0x1e8)]=_0xc1a542,_0x2686db[_0x467025(0x210)]=_0x126d3c,_0x2686db[_0x467025(0x1f5)]=_0x4c87a2,_0x2686db[_0x467025(0x202)]=_0x3d6c47;const _0xca8a1b=await _0x2686db[_0x467025(0x1d7)]();_0x5e5bbd['flash']('success',_0x467025(0x1cf)),_0x1eff23['redirect'](_0x467025(0x1db));}catch(_0x4a550a){console['log'](_0x4a550a);}}),router[a0_0x1a86d9(0x1f2)](a0_0x1a86d9(0x1d6),auth,async(_0x5cc5e4,_0x3a5ad9)=>{const _0xabe5a2=a0_0x1a86d9;try{const {username:_0x582692,email:_0xf074bc,role:_0x4f659c}=_0x5cc5e4[_0xabe5a2(0x1ba)],_0x31ddc4=_0x5cc5e4['user'],_0x159707=await profile[_0xabe5a2(0x1f9)]({'email':_0x31ddc4[_0xabe5a2(0x1e0)]}),_0x488812=await master_shop[_0xabe5a2(0x1b0)]();console[_0xabe5a2(0x1fe)](_0xabe5a2(0x1fd),_0x488812),console[_0xabe5a2(0x1fe)](_0x5cc5e4[_0xabe5a2(0x1ac)]['id']);const _0x19d887=await suppliers[_0xabe5a2(0x1f9)]({'_id':_0x5cc5e4[_0xabe5a2(0x1ac)]['id']});console[_0xabe5a2(0x1fe)](_0x19d887);const _0x1387ee=await s_payment_data[_0xabe5a2(0x1b0)]({'suppliers':_0x19d887[_0xabe5a2(0x1e7)]});console[_0xabe5a2(0x1fe)](_0x1387ee);const _0x2e5dd7=await s_payment_data[_0xabe5a2(0x1fa)]([{'$match':{'suppliers':_0x19d887[_0xabe5a2(0x1e7)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0xabe5a2(0x1e3),'sum':{'$sum':_0xabe5a2(0x1de)}}}]);console[_0xabe5a2(0x1fe)](_0xabe5a2(0x1a6),_0x2e5dd7);const _0x16e6a2=await s_payment_data[_0xabe5a2(0x1fa)]([{'$match':{'suppliers':_0x19d887[_0xabe5a2(0x1e7)]}},{'$match':{'reason':_0xabe5a2(0x1ad)}},{'$group':{'_id':_0xabe5a2(0x1e3),'sum':{'$sum':_0xabe5a2(0x1de)}}}]);console['log'](_0xabe5a2(0x1b9),_0x16e6a2);if(_0x488812[0x0][_0xabe5a2(0x1d8)]==_0xabe5a2(0x1e1)){var _0x5873d4=users[_0xabe5a2(0x1b5)];console[_0xabe5a2(0x1fe)](_0x5873d4);}else{if(_0x488812[0x0]['language']==_0xabe5a2(0x1d4))var _0x5873d4=users[_0xabe5a2(0x1d4)];else{if(_0x488812[0x0][_0xabe5a2(0x1d8)]==_0xabe5a2(0x206))var _0x5873d4=users[_0xabe5a2(0x206)];else{if(_0x488812[0x0][_0xabe5a2(0x1d8)]=='Spanish')var _0x5873d4=users[_0xabe5a2(0x1ec)];else{if(_0x488812[0x0]['language']==_0xabe5a2(0x1b7))var _0x5873d4=users['French'];else{if(_0x488812[0x0][_0xabe5a2(0x1d8)]==_0xabe5a2(0x1a8))var _0x5873d4=users[_0xabe5a2(0x204)];else{if(_0x488812[0x0][_0xabe5a2(0x1d8)]=='Chinese')var _0x5873d4=users[_0xabe5a2(0x1f4)];else{if(_0x488812[0x0][_0xabe5a2(0x1d8)]==_0xabe5a2(0x1ea))var _0x5873d4=users[_0xabe5a2(0x201)];}}}}}}}_0x3a5ad9[_0xabe5a2(0x1da)](_0xabe5a2(0x1cd),{'success':_0x5cc5e4[_0xabe5a2(0x1af)]('success'),'errors':_0x5cc5e4[_0xabe5a2(0x1af)](_0xabe5a2(0x1ae)),'role':_0x31ddc4,'profile':_0x159707,'master_shop':_0x488812,'payment':_0x1387ee,'payable':_0x2e5dd7,'receivable':_0x16e6a2,'language':_0x5873d4});}catch(_0x4d0dde){console[_0xabe5a2(0x1fe)](_0x4d0dde);}}),router[a0_0x1a86d9(0x1f2)](a0_0x1a86d9(0x205),auth,async(_0x19af28,_0xbdb943)=>{const _0x8c15cf=a0_0x1a86d9;try{const _0x36de27=new excelJS[(_0x8c15cf(0x1d1))](),_0x484d40=_0x36de27['addWorksheet']('Customers');return _0x484d40[_0x8c15cf(0x1c7)]=[{'header':_0x8c15cf(0x1d2),'key':'PBrands','width':0xa},{'header':'Supplier_Code','key':_0x8c15cf(0x1f1),'width':0xa},{'header':'Email','key':_0x8c15cf(0x20c),'width':0xa},{'header':'Mobile_number','key':'address','width':0xa},{'header':_0x8c15cf(0x1b1),'key':_0x8c15cf(0x20a),'width':0xa},{'header':_0x8c15cf(0x1c0),'key':_0x8c15cf(0x1e0),'width':0xa}],_0xbdb943[_0x8c15cf(0x20d)](_0x8c15cf(0x1bd),_0x8c15cf(0x1e6)),_0xbdb943[_0x8c15cf(0x20d)]('Content-Disposition','attachment;\x20filename=supplier_Migration_File.xlsx'),_0x36de27[_0x8c15cf(0x1b8)][_0x8c15cf(0x1c6)](_0xbdb943)[_0x8c15cf(0x1a5)](()=>{_0xbdb943['status'](0xc8);});}catch(_0x281b11){_0xbdb943['status'](0x190)[_0x8c15cf(0x207)]({'errors':_0x281b11[_0x8c15cf(0x1a7)]});}});function a0_0x49c3(){const _0x54f228=['Supplier_Code','../public/language/languages.json','$amount','\x20Failed','email','English\x20(US)','sheet_to_json','$reason','purchase_return','body','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','name','payable','6vIYyED','Arabic\x20(ae)','exports','Spanish','express','28aHOrum','supplier','Mobile_number','PUnits','get','redirect','Chinese','contactperson','public/Migration/','supplier_product_file','11iHTzSy','findOne','aggregate','diskStorage','doc','master','log','filename','724xUnGjc','Arabic','landline','125229bvsrUT','Portuguese','/products_export_migrate_file','German','send','Purchase','1216816KlSFju','mobile','suppliers_docs','SalesmanName','setHeader','163563kRedZm','data','suppliers_code','supplier.js\x20payment_data','supplier\x20data\x20add\x20successfully','then','payable_sum','message','Portuguese\x20(BR)','forEach','exceljs','6GzvwYt','params','Purchase\x20Return','errors','flash','find','Company_Name','10459116GFYByz','receivable','post','English','s_payments','French','xlsx','receivable_sum','user','2316130kWFAej','originalname','Content-Type','success','amount','address','SheetNames','company','Router','Sheets','readFile','write','columns','status','/view/:id','1902ZBtmtK','8060930sxNRii','/view','supplier_payment','6012mqGXBr','supplier\x20data\x20update\x20successfully','suppliers','Workbook','Name','reason','Hindi','single','/view/payment/:id','save','language','multer','render','/supplier/view'];a0_0x49c3=function(){return _0x54f228;};return a0_0x49c3();}const storage1=multer[a0_0x1a86d9(0x1fb)]({'destination':(_0x34e20b,_0x1f0bda,_0x49fb13)=>{_0x49fb13(null,'public/Migration');},'filename':(_0x2b0485,_0x1231db,_0x2d6975)=>{const _0x53cfb2=a0_0x1a86d9;_0x2d6975(null,Date['now']()+_0x1231db[_0x53cfb2(0x1bc)]);}}),uploadMigrate=multer({'storage':storage1});router['post']('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x1a86d9(0x1d5)](a0_0x1a86d9(0x1f7)),async(_0x2c84a4,_0x634681)=>{const _0x134038=a0_0x1a86d9,_0x185913=_0x2c84a4['file'][_0x134038(0x1ff)],_0x551079=await xlsx[_0x134038(0x1c5)](_0x134038(0x1f6)+_0x185913);let _0x5e530d=_0x551079[_0x134038(0x1c1)],_0x3a4b4e=xlsx['utils'][_0x134038(0x1e2)](_0x551079[_0x134038(0x1c4)][_0x5e530d[0x0]]);for(const _0x33f6d4 of _0x3a4b4e){const _0xfd2ac1=_0x33f6d4[_0x134038(0x1d2)],_0x1d88bb=_0x33f6d4[_0x134038(0x1dc)],_0x285e0a=_0x33f6d4[_0x134038(0x1c0)],_0x44656=_0x33f6d4[_0x134038(0x1f0)],_0x1320dc=_0x33f6d4['Email'],_0x1a68d5=_0x33f6d4[_0x134038(0x1b1)];try{let _0x1a519e=await suppliers[_0x134038(0x1f9)]({'name':_0xfd2ac1});if(!_0x1a519e){const _0x13c714=new suppliers({'name':_0xfd2ac1,'suppliers_code':_0x1d88bb,'address':_0x285e0a,'mobile':_0x44656,'email':_0x1320dc,'company':_0x1a68d5});_0x1a519e=await _0x13c714['save'](),_0x2c84a4[_0x134038(0x1af)](_0x134038(0x1be),_0xfd2ac1+'\x20added\x20successfully');}else _0x2c84a4[_0x134038(0x1af)]('error',_0xfd2ac1+_0x134038(0x1df));}catch(_0x1491fd){_0x634681[_0x134038(0x1c8)](0x1f4)['json']({'proderror':_0x1491fd['message'],'aproduct':ProductName});}}_0x634681[_0x134038(0x1f3)](_0x134038(0x1db));}),module[a0_0x1a86d9(0x1eb)]=router;