const a0_0x57b229=a0_0x2d0c;(function(_0x58343a,_0x4bee9b){const _0x23c8e6=a0_0x2d0c,_0x1a1818=_0x58343a();while(!![]){try{const _0x700141=-parseInt(_0x23c8e6(0xa6))/0x1+-parseInt(_0x23c8e6(0xa7))/0x2*(-parseInt(_0x23c8e6(0xb9))/0x3)+-parseInt(_0x23c8e6(0x81))/0x4*(-parseInt(_0x23c8e6(0xac))/0x5)+-parseInt(_0x23c8e6(0xc3))/0x6*(parseInt(_0x23c8e6(0xd0))/0x7)+-parseInt(_0x23c8e6(0xdc))/0x8+-parseInt(_0x23c8e6(0xda))/0x9*(-parseInt(_0x23c8e6(0x97))/0xa)+parseInt(_0x23c8e6(0xab))/0xb*(parseInt(_0x23c8e6(0xc6))/0xc);if(_0x700141===_0x4bee9b)break;else _0x1a1818['push'](_0x1a1818['shift']());}catch(_0x34319d){_0x1a1818['push'](_0x1a1818['shift']());}}}(a0_0x9370,0x75006));function a0_0x2d0c(_0x43f294,_0x138d12){const _0x937057=a0_0x9370();return a0_0x2d0c=function(_0x2d0c9f,_0x44f94f){_0x2d0c9f=_0x2d0c9f-0x70;let _0x532962=_0x937057[_0x2d0c9f];return _0x532962;},a0_0x2d0c(_0x43f294,_0x138d12);}const express=require(a0_0x57b229(0x87)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x57b229(0x8c)),auth=require(a0_0x57b229(0xcf)),users=require(a0_0x57b229(0x7e)),excelJS=require(a0_0x57b229(0xc4)),xlsx=require(a0_0x57b229(0xad)),multer=require(a0_0x57b229(0xc1));function a0_0x9370(){const _0x5d2998=['findOne','Portuguese','filename','diskStorage','s_payments','supplier_payment','save','Purchase\x20Return','Sheets','map','file','../public/language/languages.json','Mobile_number','Customers','328772zbWtZt','address','supplier.js\x20payment_data','English','French','status','express','contactperson','receivable_sum','log','purchase','../models/all_models','then','suppliers_code','Content-Type','amount','/view/:id','language','/supplier_import_migrate_file','payable_sum','params','supplier_product_file','14120WMpPSt','public/Migration/','setHeader','Email','user','Arabic','body','success','get','Arabic\x20(ae)','columns','Company_Name','supplier','Name','Supplier_Code','45703lxSSvG','1907536MCYBdA','flash','email','originalname','33PinEaX','5xqBVSJ','xlsx','redirect','Portuguese\x20(BR)','German','utils','company','SalesmanName','aggregate','Workbook','post','send','/view/payment/:id','3knYlfn','find','errors','name','addWorksheet','Chinese','Hindi','mobile','multer','\x20Failed','31686ckQcdz','exceljs','receivable','497796KKisqv','exports','/products_export_migrate_file','Content-Disposition','data','master','/view','$reason','json','../middleware/auth','175WIsAkm','Purchase','$amount','Spanish','now','findById','English\x20(US)','/supplier/view','render','reason','1818fBgvdp','suppliers_docs','6309344oePOOF','supplier\x20data\x20add\x20successfully','attachment;\x20filename=supplier_Migration_File.xlsx','message','landline'];a0_0x9370=function(){return _0x5d2998;};return a0_0x9370();}router[a0_0x57b229(0x9f)](a0_0x57b229(0xcc),auth,async(_0x29bb7c,_0x2fa443)=>{const _0x5d7374=a0_0x57b229;try{const {username:_0x2da64f,email:_0x2e3b44,role:_0x5ed80b}=_0x29bb7c[_0x5d7374(0x9b)],_0xd415ea=_0x29bb7c[_0x5d7374(0x9b)],_0x28f3af=await profile[_0x5d7374(0x73)]({'email':_0xd415ea[_0x5d7374(0xa9)]}),_0x8964d5=await master_shop['find']();console[_0x5d7374(0x8a)](_0x5d7374(0xcb),_0x8964d5);const _0x1888ad=await suppliers[_0x5d7374(0xba)]();console[_0x5d7374(0x8a)](_0x1888ad);const _0x8c4596=await suppliers[_0x5d7374(0xb4)]([{'$lookup':{'from':_0x5d7374(0x77),'localField':_0x5d7374(0xbc),'foreignField':'suppliers','as':_0x5d7374(0xdb)}}]),_0x2762d5=_0x8c4596[_0x5d7374(0x7c)](_0x1fb50c=>{const _0x26baea=_0x5d7374;console[_0x26baea(0x8a)](_0x26baea(0xca),_0x1fb50c);var _0x396c75=0x0,_0x202c2f=0x0;return _0x1fb50c['suppliers_docs']['forEach'](_0x45e120=>{const _0x3ea027=_0x26baea;console['log']('doc',_0x45e120),_0x45e120[_0x3ea027(0xd9)]=='Purchase'?_0x396c75+=_0x45e120[_0x3ea027(0x90)]:_0x202c2f+=_0x45e120[_0x3ea027(0x90)];}),_0x1fb50c[_0x26baea(0x8b)]=_0x396c75,_0x1fb50c['purchase_return']=_0x202c2f,_0x1fb50c;});console['log'](_0x5d7374(0x83),_0x2762d5);if(_0x8964d5[0x0][_0x5d7374(0x92)]=='English\x20(US)'){var _0x2fb8d1=users[_0x5d7374(0x84)];console['log'](_0x2fb8d1);}else{if(_0x8964d5[0x0]['language']==_0x5d7374(0xbf))var _0x2fb8d1=users[_0x5d7374(0xbf)];else{if(_0x8964d5[0x0]['language']==_0x5d7374(0xb0))var _0x2fb8d1=users['German'];else{if(_0x8964d5[0x0][_0x5d7374(0x92)]=='Spanish')var _0x2fb8d1=users[_0x5d7374(0xd3)];else{if(_0x8964d5[0x0][_0x5d7374(0x92)]==_0x5d7374(0x85))var _0x2fb8d1=users[_0x5d7374(0x85)];else{if(_0x8964d5[0x0][_0x5d7374(0x92)]==_0x5d7374(0xaf))var _0x2fb8d1=users['Portuguese'];else{if(_0x8964d5[0x0]['language']==_0x5d7374(0xbe))var _0x2fb8d1=users['Chinese'];else{if(_0x8964d5[0x0][_0x5d7374(0x92)]=='Arabic\x20(ae)')var _0x2fb8d1=users[_0x5d7374(0x9c)];}}}}}}}_0x2fa443[_0x5d7374(0xd8)](_0x5d7374(0xa3),{'success':_0x29bb7c[_0x5d7374(0xa8)](_0x5d7374(0x9e)),'errors':_0x29bb7c[_0x5d7374(0xa8)]('errors'),'user':_0x1888ad,'profile':_0x28f3af,'master_shop':_0x8964d5,'role':_0xd415ea,'payment':_0x2762d5,'language':_0x2fb8d1});}catch(_0x557f31){console[_0x5d7374(0x8a)](_0x557f31);}}),router['post'](a0_0x57b229(0xcc),auth,async(_0x11a96f,_0x121b68)=>{const _0x392e33=a0_0x57b229;try{const {name:_0x565018,email:_0x262406,mobile:_0x1e3c4f,company:_0x21506f,address:_0x136d50,receivable:_0x1e3228,payable:_0x33753e,code:_0x245d42,contactperson:_0x1c200d,landline:_0x1759d6}=_0x11a96f[_0x392e33(0x9d)],_0x3807c3=new suppliers({'name':_0x565018,'email':_0x262406,'mobile':_0x1e3c4f,'company':_0x21506f,'address':_0x136d50,'receivable':_0x1e3228,'payable':_0x33753e,'suppliers_code':_0x245d42,'contactperson':_0x1c200d,'landline':_0x1759d6}),_0xd925fc=await _0x3807c3['save']();_0x11a96f[_0x392e33(0xa8)](_0x392e33(0x9e),_0x392e33(0xdd)),_0x121b68[_0x392e33(0xae)](_0x392e33(0xd7));}catch(_0x7b5ede){console[_0x392e33(0x8a)](_0x7b5ede);}}),router[a0_0x57b229(0x9f)](a0_0x57b229(0x91),auth,async(_0x261f8c,_0x3b2ce5)=>{const _0xf85ff1=a0_0x57b229;try{const {username:_0x229939,email:_0x454b3c,role:_0x2b4f1a}=_0x261f8c[_0xf85ff1(0x9b)],_0x436a47=_0x261f8c[_0xf85ff1(0x9b)],_0x4e13c6=await profile['findOne']({'email':_0x436a47['email']}),_0xb23226=await master_shop[_0xf85ff1(0xba)]();console[_0xf85ff1(0x8a)](_0xf85ff1(0xcb),_0xb23226);const _0x5dc38f=_0x261f8c[_0xf85ff1(0x95)]['id'],_0x43a7fe=await suppliers[_0xf85ff1(0xd5)](_0x5dc38f);console[_0xf85ff1(0x8a)](_0x43a7fe);if(_0xb23226[0x0]['language']==_0xf85ff1(0xd6)){var _0x573862=users['English'];console[_0xf85ff1(0x8a)](_0x573862);}else{if(_0xb23226[0x0]['language']==_0xf85ff1(0xbf))var _0x573862=users[_0xf85ff1(0xbf)];else{if(_0xb23226[0x0][_0xf85ff1(0x92)]==_0xf85ff1(0xb0))var _0x573862=users['German'];else{if(_0xb23226[0x0][_0xf85ff1(0x92)]==_0xf85ff1(0xd3))var _0x573862=users[_0xf85ff1(0xd3)];else{if(_0xb23226[0x0][_0xf85ff1(0x92)]==_0xf85ff1(0x85))var _0x573862=users[_0xf85ff1(0x85)];else{if(_0xb23226[0x0]['language']==_0xf85ff1(0xaf))var _0x573862=users[_0xf85ff1(0x74)];else{if(_0xb23226[0x0][_0xf85ff1(0x92)]==_0xf85ff1(0xbe))var _0x573862=users[_0xf85ff1(0xbe)];else{if(_0xb23226[0x0][_0xf85ff1(0x92)]==_0xf85ff1(0xa0))var _0x573862=users['Arabic'];}}}}}}}_0x3b2ce5[_0xf85ff1(0xd8)](_0xf85ff1(0xa3),{'success':_0x261f8c[_0xf85ff1(0xa8)](_0xf85ff1(0x9e)),'errors':_0x261f8c[_0xf85ff1(0xa8)](_0xf85ff1(0xbb)),'role':_0x436a47,'profile':_0x4e13c6,'master_shop':_0xb23226,'user':_0x43a7fe,'language':_0x573862});}catch(_0x127074){console[_0xf85ff1(0x8a)](_0x127074);}}),router[a0_0x57b229(0xb6)](a0_0x57b229(0x91),auth,async(_0x296d7e,_0x4f341e)=>{const _0x54b50d=a0_0x57b229;try{const _0xa1ea79=_0x296d7e[_0x54b50d(0x95)]['id'],_0x2955be=await suppliers[_0x54b50d(0xd5)](_0xa1ea79),{name:_0x299cbe,email:_0x570675,mobile:_0x454556,company:_0x270345,address:_0x42734b,receivable:_0x574ec7,payable:_0x1f8756,code:_0x3602ce,contactperson:_0x45032f,landline:_0x3bc350}=_0x296d7e[_0x54b50d(0x9d)];_0x2955be['name']=_0x299cbe,_0x2955be[_0x54b50d(0xa9)]=_0x570675,_0x2955be[_0x54b50d(0xc0)]=_0x454556,_0x2955be[_0x54b50d(0xb2)]=_0x270345,_0x2955be[_0x54b50d(0x82)]=_0x42734b,_0x2955be[_0x54b50d(0xc5)]=_0x574ec7,_0x2955be['payable']=_0x1f8756,_0x2955be[_0x54b50d(0x8e)]=_0x3602ce,_0x2955be[_0x54b50d(0x88)]=_0x45032f,_0x2955be[_0x54b50d(0x72)]=_0x3bc350;const _0x4e8c39=await _0x2955be[_0x54b50d(0x79)]();_0x296d7e[_0x54b50d(0xa8)](_0x54b50d(0x9e),'supplier\x20data\x20update\x20successfully'),_0x4f341e['redirect'](_0x54b50d(0xd7));}catch(_0xd19382){console['log'](_0xd19382);}}),router['get'](a0_0x57b229(0xb8),auth,async(_0x113926,_0x3f4ca5)=>{const _0x2f1682=a0_0x57b229;try{const {username:_0x18b73e,email:_0x4105f9,role:_0x2f589e}=_0x113926['user'],_0x1a3d97=_0x113926[_0x2f1682(0x9b)],_0x14a6a8=await profile[_0x2f1682(0x73)]({'email':_0x1a3d97[_0x2f1682(0xa9)]}),_0x40d017=await master_shop[_0x2f1682(0xba)]();console[_0x2f1682(0x8a)](_0x2f1682(0xcb),_0x40d017),console[_0x2f1682(0x8a)](_0x113926[_0x2f1682(0x95)]['id']);const _0x2eee14=await suppliers[_0x2f1682(0x73)]({'_id':_0x113926[_0x2f1682(0x95)]['id']});console[_0x2f1682(0x8a)](_0x2eee14);const _0x42ed57=await s_payment_data[_0x2f1682(0xba)]({'suppliers':_0x2eee14[_0x2f1682(0xbc)]});console['log'](_0x42ed57);const _0x1403a4=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x2eee14[_0x2f1682(0xbc)]}},{'$match':{'reason':_0x2f1682(0xd1)}},{'$group':{'_id':_0x2f1682(0xcd),'sum':{'$sum':_0x2f1682(0xd2)}}}]);console[_0x2f1682(0x8a)](_0x2f1682(0x94),_0x1403a4);const _0x41ada2=await s_payment_data[_0x2f1682(0xb4)]([{'$match':{'suppliers':_0x2eee14[_0x2f1682(0xbc)]}},{'$match':{'reason':_0x2f1682(0x7a)}},{'$group':{'_id':_0x2f1682(0xcd),'sum':{'$sum':_0x2f1682(0xd2)}}}]);console['log'](_0x2f1682(0x89),_0x41ada2);if(_0x40d017[0x0][_0x2f1682(0x92)]==_0x2f1682(0xd6)){var _0x209a1f=users[_0x2f1682(0x84)];console['log'](_0x209a1f);}else{if(_0x40d017[0x0][_0x2f1682(0x92)]=='Hindi')var _0x209a1f=users[_0x2f1682(0xbf)];else{if(_0x40d017[0x0]['language']==_0x2f1682(0xb0))var _0x209a1f=users[_0x2f1682(0xb0)];else{if(_0x40d017[0x0]['language']==_0x2f1682(0xd3))var _0x209a1f=users[_0x2f1682(0xd3)];else{if(_0x40d017[0x0]['language']==_0x2f1682(0x85))var _0x209a1f=users['French'];else{if(_0x40d017[0x0]['language']==_0x2f1682(0xaf))var _0x209a1f=users['Portuguese'];else{if(_0x40d017[0x0][_0x2f1682(0x92)]==_0x2f1682(0xbe))var _0x209a1f=users[_0x2f1682(0xbe)];else{if(_0x40d017[0x0]['language']==_0x2f1682(0xa0))var _0x209a1f=users[_0x2f1682(0x9c)];}}}}}}}_0x3f4ca5['render'](_0x2f1682(0x78),{'success':_0x113926[_0x2f1682(0xa8)](_0x2f1682(0x9e)),'errors':_0x113926[_0x2f1682(0xa8)](_0x2f1682(0xbb)),'role':_0x1a3d97,'profile':_0x14a6a8,'master_shop':_0x40d017,'payment':_0x42ed57,'payable':_0x1403a4,'receivable':_0x41ada2,'language':_0x209a1f});}catch(_0xef081c){console[_0x2f1682(0x8a)](_0xef081c);}}),router[a0_0x57b229(0x9f)](a0_0x57b229(0xc8),auth,async(_0x1634fb,_0x236989)=>{const _0x41ea23=a0_0x57b229;try{const _0x109c11=new excelJS[(_0x41ea23(0xb5))](),_0x5f5c74=_0x109c11[_0x41ea23(0xbd)](_0x41ea23(0x80));return _0x5f5c74[_0x41ea23(0xa1)]=[{'header':_0x41ea23(0xa4),'key':'PBrands','width':0xa},{'header':_0x41ea23(0xa5),'key':'PUnits','width':0xa},{'header':_0x41ea23(0x9a),'key':_0x41ea23(0xb3),'width':0xa},{'header':'Mobile_number','key':'address','width':0xa},{'header':_0x41ea23(0xa2),'key':'mobile','width':0xa},{'header':_0x41ea23(0x82),'key':_0x41ea23(0xa9),'width':0xa}],_0x236989[_0x41ea23(0x99)](_0x41ea23(0x8f),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x236989[_0x41ea23(0x99)](_0x41ea23(0xc9),_0x41ea23(0x70)),_0x109c11[_0x41ea23(0xad)]['write'](_0x236989)[_0x41ea23(0x8d)](()=>{const _0x3b2585=_0x41ea23;_0x236989[_0x3b2585(0x86)](0xc8);});}catch(_0x3c11a6){_0x236989[_0x41ea23(0x86)](0x190)[_0x41ea23(0xb7)]({'errors':_0x3c11a6[_0x41ea23(0x71)]});}});const storage1=multer[a0_0x57b229(0x76)]({'destination':(_0x244223,_0x188e1a,_0x3deb7a)=>{_0x3deb7a(null,'public/Migration');},'filename':(_0x259356,_0x23d560,_0x9b5fa3)=>{const _0x119be8=a0_0x57b229;_0x9b5fa3(null,Date[_0x119be8(0xd4)]()+_0x23d560[_0x119be8(0xaa)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x57b229(0xb6)](a0_0x57b229(0x93),auth,uploadMigrate['single'](a0_0x57b229(0x96)),async(_0x54def7,_0x35d042)=>{const _0x27b636=a0_0x57b229,_0x95223e=_0x54def7[_0x27b636(0x7d)][_0x27b636(0x75)],_0x2794ad=await xlsx['readFile'](_0x27b636(0x98)+_0x95223e);let _0x429833=_0x2794ad['SheetNames'],_0x85b854=xlsx[_0x27b636(0xb1)]['sheet_to_json'](_0x2794ad[_0x27b636(0x7b)][_0x429833[0x0]]);for(const _0x2c0d0f of _0x85b854){const _0xaf3082=_0x2c0d0f[_0x27b636(0xa4)],_0x15d72f=_0x2c0d0f['Supplier_Code'],_0x442a92=_0x2c0d0f[_0x27b636(0x82)],_0x15354c=_0x2c0d0f[_0x27b636(0x7f)],_0x2f5970=_0x2c0d0f[_0x27b636(0x9a)],_0x352fe0=_0x2c0d0f[_0x27b636(0xa2)];try{let _0x46bc3a=await suppliers[_0x27b636(0x73)]({'name':_0xaf3082});if(!_0x46bc3a){const _0x1f8570=new suppliers({'name':_0xaf3082,'suppliers_code':_0x15d72f,'address':_0x442a92,'mobile':_0x15354c,'email':_0x2f5970,'company':_0x352fe0});_0x46bc3a=await _0x1f8570[_0x27b636(0x79)](),_0x54def7[_0x27b636(0xa8)](_0x27b636(0x9e),_0xaf3082+'\x20added\x20successfully');}else _0x54def7[_0x27b636(0xa8)]('error',_0xaf3082+_0x27b636(0xc2));}catch(_0x3322a4){_0x35d042[_0x27b636(0x86)](0x1f4)[_0x27b636(0xce)]({'proderror':_0x3322a4[_0x27b636(0x71)],'aproduct':ProductName});}}_0x35d042[_0x27b636(0xae)](_0x27b636(0xd7));}),module[a0_0x57b229(0xc7)]=router;