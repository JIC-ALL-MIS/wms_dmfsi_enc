const a0_0x31832f=a0_0x1b11;(function(_0x5961fb,_0xd78040){const _0x5b3977=a0_0x1b11,_0x53e208=_0x5961fb();while(!![]){try{const _0x545956=-parseInt(_0x5b3977(0x14c))/0x1+-parseInt(_0x5b3977(0x178))/0x2*(parseInt(_0x5b3977(0x134))/0x3)+-parseInt(_0x5b3977(0x156))/0x4*(-parseInt(_0x5b3977(0x116))/0x5)+-parseInt(_0x5b3977(0x11c))/0x6+-parseInt(_0x5b3977(0x153))/0x7*(parseInt(_0x5b3977(0x144))/0x8)+parseInt(_0x5b3977(0x13e))/0x9+parseInt(_0x5b3977(0x15f))/0xa;if(_0x545956===_0xd78040)break;else _0x53e208['push'](_0x53e208['shift']());}catch(_0x427a86){_0x53e208['push'](_0x53e208['shift']());}}}(a0_0x2413,0xa1947));function a0_0x1b11(_0x2ebd3c,_0xb59917){const _0x2413f7=a0_0x2413();return a0_0x1b11=function(_0x1b1110,_0x249166){_0x1b1110=_0x1b1110-0x116;let _0x273c84=_0x2413f7[_0x1b1110];return _0x273c84;},a0_0x1b11(_0x2ebd3c,_0xb59917);}const express=require(a0_0x31832f(0x17d)),app=express(),router=express[a0_0x31832f(0x126)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require(a0_0x31832f(0x119)),users=require(a0_0x31832f(0x151)),excelJS=require(a0_0x31832f(0x161)),xlsx=require(a0_0x31832f(0x138)),multer=require(a0_0x31832f(0x146));router[a0_0x31832f(0x169)](a0_0x31832f(0x14e),auth,async(_0x4c236e,_0x4c82ae)=>{const _0x4642c8=a0_0x31832f;try{const {username:_0x73383,email:_0x16e9b5,role:_0x2cdc84}=_0x4c236e[_0x4642c8(0x164)],_0x5d10e2=_0x4c236e['user'],_0x560c4e=await profile[_0x4642c8(0x170)]({'email':_0x5d10e2[_0x4642c8(0x16d)]}),_0x188610=await master_shop[_0x4642c8(0x15a)]();console[_0x4642c8(0x11a)](_0x4642c8(0x171),_0x188610);const _0x487e19=await suppliers[_0x4642c8(0x15a)]();console['log'](_0x487e19);const _0x2d8045=await suppliers[_0x4642c8(0x16a)]([{'$lookup':{'from':'s_payments','localField':_0x4642c8(0x125),'foreignField':'suppliers','as':_0x4642c8(0x17a)}}]),_0x12f75b=_0x2d8045[_0x4642c8(0x162)](_0x3d3fea=>{const _0x2b22b6=_0x4642c8;console[_0x2b22b6(0x11a)](_0x2b22b6(0x135),_0x3d3fea);var _0x5c62a5=0x0,_0x2dfa70=0x0;return _0x3d3fea[_0x2b22b6(0x17a)][_0x2b22b6(0x152)](_0x189b32=>{const _0x6d12cb=_0x2b22b6;console[_0x6d12cb(0x11a)](_0x6d12cb(0x16c),_0x189b32),_0x189b32['reason']==_0x6d12cb(0x131)?_0x5c62a5+=_0x189b32[_0x6d12cb(0x143)]:_0x2dfa70+=_0x189b32['amount'];}),_0x3d3fea[_0x2b22b6(0x181)]=_0x5c62a5,_0x3d3fea[_0x2b22b6(0x176)]=_0x2dfa70,_0x3d3fea;});console[_0x4642c8(0x11a)](_0x4642c8(0x17e),_0x12f75b);if(_0x188610[0x0][_0x4642c8(0x123)]==_0x4642c8(0x15e)){var _0x1ca7b6=users[_0x4642c8(0x136)];console[_0x4642c8(0x11a)](_0x1ca7b6);}else{if(_0x188610[0x0][_0x4642c8(0x123)]=='Hindi')var _0x1ca7b6=users[_0x4642c8(0x132)];else{if(_0x188610[0x0][_0x4642c8(0x123)]==_0x4642c8(0x167))var _0x1ca7b6=users[_0x4642c8(0x167)];else{if(_0x188610[0x0][_0x4642c8(0x123)]==_0x4642c8(0x15d))var _0x1ca7b6=users['Spanish'];else{if(_0x188610[0x0][_0x4642c8(0x123)]==_0x4642c8(0x11b))var _0x1ca7b6=users[_0x4642c8(0x11b)];else{if(_0x188610[0x0]['language']==_0x4642c8(0x13d))var _0x1ca7b6=users['Portuguese'];else{if(_0x188610[0x0]['language']==_0x4642c8(0x145))var _0x1ca7b6=users[_0x4642c8(0x145)];else{if(_0x188610[0x0][_0x4642c8(0x123)]==_0x4642c8(0x173))var _0x1ca7b6=users[_0x4642c8(0x15b)];}}}}}}}_0x4c82ae[_0x4642c8(0x127)](_0x4642c8(0x154),{'success':_0x4c236e[_0x4642c8(0x130)](_0x4642c8(0x139)),'errors':_0x4c236e[_0x4642c8(0x130)](_0x4642c8(0x13c)),'user':_0x487e19,'profile':_0x560c4e,'master_shop':_0x188610,'role':_0x5d10e2,'payment':_0x12f75b,'language':_0x1ca7b6});}catch(_0x3750e9){console[_0x4642c8(0x11a)](_0x3750e9);}}),router[a0_0x31832f(0x12f)](a0_0x31832f(0x14e),auth,async(_0x1e75b2,_0x2e108f)=>{const _0x52fb6e=a0_0x31832f;try{const {name:_0x275f4a,email:_0xa2d97d,mobile:_0x168c47,company:_0x50665e,address:_0x1b2bb8,receivable:_0x120bc4,payable:_0x1eeb8e,code:_0x1108c7,contactperson:_0xeda00f,landline:_0x341c30}=_0x1e75b2[_0x52fb6e(0x140)],_0x114443=new suppliers({'name':_0x275f4a,'email':_0xa2d97d,'mobile':_0x168c47,'company':_0x50665e,'address':_0x1b2bb8,'receivable':_0x120bc4,'payable':_0x1eeb8e,'suppliers_code':_0x1108c7,'contactperson':_0xeda00f,'landline':_0x341c30}),_0x3ffe48=await _0x114443[_0x52fb6e(0x129)]();_0x1e75b2[_0x52fb6e(0x130)](_0x52fb6e(0x139),_0x52fb6e(0x118)),_0x2e108f[_0x52fb6e(0x172)](_0x52fb6e(0x157));}catch(_0x23693d){console[_0x52fb6e(0x11a)](_0x23693d);}}),router['get'](a0_0x31832f(0x14d),auth,async(_0x568cd1,_0x41d4f8)=>{const _0x5543cb=a0_0x31832f;try{const {username:_0x4d3ccd,email:_0x40489f,role:_0x1caa12}=_0x568cd1['user'],_0x504a25=_0x568cd1['user'],_0x504e6f=await profile[_0x5543cb(0x170)]({'email':_0x504a25[_0x5543cb(0x16d)]}),_0x35abda=await master_shop[_0x5543cb(0x15a)]();console[_0x5543cb(0x11a)](_0x5543cb(0x171),_0x35abda);const _0x14ba46=_0x568cd1[_0x5543cb(0x121)]['id'],_0x36669e=await suppliers[_0x5543cb(0x13a)](_0x14ba46);console[_0x5543cb(0x11a)](_0x36669e);if(_0x35abda[0x0][_0x5543cb(0x123)]==_0x5543cb(0x15e)){var _0x5bd89f=users['English'];console['log'](_0x5bd89f);}else{if(_0x35abda[0x0][_0x5543cb(0x123)]=='Hindi')var _0x5bd89f=users[_0x5543cb(0x132)];else{if(_0x35abda[0x0][_0x5543cb(0x123)]==_0x5543cb(0x167))var _0x5bd89f=users[_0x5543cb(0x167)];else{if(_0x35abda[0x0][_0x5543cb(0x123)]==_0x5543cb(0x15d))var _0x5bd89f=users[_0x5543cb(0x15d)];else{if(_0x35abda[0x0][_0x5543cb(0x123)]=='French')var _0x5bd89f=users[_0x5543cb(0x11b)];else{if(_0x35abda[0x0][_0x5543cb(0x123)]==_0x5543cb(0x13d))var _0x5bd89f=users[_0x5543cb(0x160)];else{if(_0x35abda[0x0]['language']==_0x5543cb(0x145))var _0x5bd89f=users[_0x5543cb(0x145)];else{if(_0x35abda[0x0][_0x5543cb(0x123)]==_0x5543cb(0x173))var _0x5bd89f=users[_0x5543cb(0x15b)];}}}}}}}_0x41d4f8[_0x5543cb(0x127)](_0x5543cb(0x154),{'success':_0x568cd1[_0x5543cb(0x130)](_0x5543cb(0x139)),'errors':_0x568cd1[_0x5543cb(0x130)]('errors'),'role':_0x504a25,'profile':_0x504e6f,'master_shop':_0x35abda,'user':_0x36669e,'language':_0x5bd89f});}catch(_0x5a538a){console[_0x5543cb(0x11a)](_0x5a538a);}}),router[a0_0x31832f(0x12f)](a0_0x31832f(0x14d),auth,async(_0x1286aa,_0x2ea21a)=>{const _0x1fadb2=a0_0x31832f;try{const _0x3e3a2f=_0x1286aa[_0x1fadb2(0x121)]['id'],_0x43a71f=await suppliers['findById'](_0x3e3a2f),{name:_0x20ce27,email:_0xba1c57,mobile:_0x4c4cd7,company:_0xf89d8,address:_0x219553,receivable:_0x4696e9,payable:_0x5505c7,code:_0x2981f0,contactperson:_0x2022a2,landline:_0x27d6d4}=_0x1286aa[_0x1fadb2(0x140)];_0x43a71f[_0x1fadb2(0x125)]=_0x20ce27,_0x43a71f[_0x1fadb2(0x16d)]=_0xba1c57,_0x43a71f[_0x1fadb2(0x177)]=_0x4c4cd7,_0x43a71f[_0x1fadb2(0x184)]=_0xf89d8,_0x43a71f[_0x1fadb2(0x165)]=_0x219553,_0x43a71f['receivable']=_0x4696e9,_0x43a71f[_0x1fadb2(0x117)]=_0x5505c7,_0x43a71f[_0x1fadb2(0x120)]=_0x2981f0,_0x43a71f['contactperson']=_0x2022a2,_0x43a71f[_0x1fadb2(0x16e)]=_0x27d6d4;const _0x29e142=await _0x43a71f['save']();_0x1286aa['flash'](_0x1fadb2(0x139),_0x1fadb2(0x124)),_0x2ea21a[_0x1fadb2(0x172)]('/supplier/view');}catch(_0x3346ae){console[_0x1fadb2(0x11a)](_0x3346ae);}}),router['get'](a0_0x31832f(0x14a),auth,async(_0x276a01,_0x582e29)=>{const _0xa45930=a0_0x31832f;try{const {username:_0x22d500,email:_0x731d4f,role:_0x577ff9}=_0x276a01[_0xa45930(0x164)],_0x38301f=_0x276a01[_0xa45930(0x164)],_0x5006d0=await profile[_0xa45930(0x170)]({'email':_0x38301f[_0xa45930(0x16d)]}),_0x27d6bb=await master_shop[_0xa45930(0x15a)]();console[_0xa45930(0x11a)](_0xa45930(0x171),_0x27d6bb),console[_0xa45930(0x11a)](_0x276a01[_0xa45930(0x121)]['id']);const _0x48575f=await suppliers[_0xa45930(0x170)]({'_id':_0x276a01[_0xa45930(0x121)]['id']});console[_0xa45930(0x11a)](_0x48575f);const _0x193293=await s_payment_data[_0xa45930(0x15a)]({'suppliers':_0x48575f[_0xa45930(0x125)]});console['log'](_0x193293);const _0x545356=await s_payment_data[_0xa45930(0x16a)]([{'$match':{'suppliers':_0x48575f['name']}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0xa45930(0x128),'sum':{'$sum':_0xa45930(0x159)}}}]);console[_0xa45930(0x11a)](_0xa45930(0x183),_0x545356);const _0x4de40e=await s_payment_data[_0xa45930(0x16a)]([{'$match':{'suppliers':_0x48575f[_0xa45930(0x125)]}},{'$match':{'reason':_0xa45930(0x17f)}},{'$group':{'_id':_0xa45930(0x128),'sum':{'$sum':_0xa45930(0x159)}}}]);console[_0xa45930(0x11a)](_0xa45930(0x148),_0x4de40e);if(_0x27d6bb[0x0]['language']==_0xa45930(0x15e)){var _0x10957d=users['English'];console[_0xa45930(0x11a)](_0x10957d);}else{if(_0x27d6bb[0x0][_0xa45930(0x123)]=='Hindi')var _0x10957d=users['Hindi'];else{if(_0x27d6bb[0x0][_0xa45930(0x123)]==_0xa45930(0x167))var _0x10957d=users[_0xa45930(0x167)];else{if(_0x27d6bb[0x0][_0xa45930(0x123)]==_0xa45930(0x15d))var _0x10957d=users[_0xa45930(0x15d)];else{if(_0x27d6bb[0x0][_0xa45930(0x123)]==_0xa45930(0x11b))var _0x10957d=users[_0xa45930(0x11b)];else{if(_0x27d6bb[0x0]['language']==_0xa45930(0x13d))var _0x10957d=users['Portuguese'];else{if(_0x27d6bb[0x0][_0xa45930(0x123)]==_0xa45930(0x145))var _0x10957d=users[_0xa45930(0x145)];else{if(_0x27d6bb[0x0][_0xa45930(0x123)]==_0xa45930(0x173))var _0x10957d=users[_0xa45930(0x15b)];}}}}}}}_0x582e29['render']('supplier_payment',{'success':_0x276a01['flash']('success'),'errors':_0x276a01['flash'](_0xa45930(0x13c)),'role':_0x38301f,'profile':_0x5006d0,'master_shop':_0x27d6bb,'payment':_0x193293,'payable':_0x545356,'receivable':_0x4de40e,'language':_0x10957d});}catch(_0x58ba91){console['log'](_0x58ba91);}}),router[a0_0x31832f(0x169)](a0_0x31832f(0x17b),auth,async(_0x531061,_0x107fbd)=>{const _0x95becb=a0_0x31832f;try{const _0x4a5836=new excelJS[(_0x95becb(0x163))](),_0x4f4d89=_0x4a5836[_0x95becb(0x141)]('Customers');return _0x4f4d89[_0x95becb(0x12d)]=[{'header':_0x95becb(0x13f),'key':_0x95becb(0x150),'width':0xa},{'header':'Supplier_Code','key':_0x95becb(0x158),'width':0xa},{'header':_0x95becb(0x15c),'key':'SalesmanName','width':0xa},{'header':_0x95becb(0x16b),'key':_0x95becb(0x165),'width':0xa},{'header':_0x95becb(0x137),'key':'mobile','width':0xa},{'header':_0x95becb(0x165),'key':_0x95becb(0x16d),'width':0xa}],_0x107fbd[_0x95becb(0x142)](_0x95becb(0x17c),_0x95becb(0x166)),_0x107fbd[_0x95becb(0x142)](_0x95becb(0x13b),_0x95becb(0x14f)),_0x4a5836['xlsx'][_0x95becb(0x11d)](_0x107fbd)[_0x95becb(0x168)](()=>{const _0x23e136=_0x95becb;_0x107fbd[_0x23e136(0x133)](0xc8);});}catch(_0x1776ab){_0x107fbd['status'](0x190)[_0x95becb(0x12e)]({'errors':_0x1776ab[_0x95becb(0x122)]});}});const storage1=multer['diskStorage']({'destination':(_0x12eef6,_0xca69ef,_0x241594)=>{_0x241594(null,'public/Migration');},'filename':(_0x4a8f10,_0x175c9b,_0x2d16c9)=>{const _0xdf5046=a0_0x31832f;_0x2d16c9(null,Date[_0xdf5046(0x174)]()+_0x175c9b[_0xdf5046(0x12c)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x2413(){const _0x38503c=['company','error','359735JQPTso','payable','supplier\x20data\x20add\x20successfully','../middleware/auth','log','French','6127938ekFtyO','write','readFile','SheetNames','suppliers_code','params','message','language','supplier\x20data\x20update\x20successfully','name','Router','render','$reason','save','Sheets','\x20added\x20successfully','originalname','columns','send','post','flash','Purchase','Hindi','status','3gPfIYb','data','English','Company_Name','xlsx','success','findById','Content-Disposition','errors','Portuguese\x20(BR)','4722057ipXQjD','Name','body','addWorksheet','setHeader','amount','34064TtyBFJ','Chinese','multer','sheet_to_json','receivable_sum','supplier_product_file','/view/payment/:id','json','171772WesTKO','/view/:id','/view','attachment;\x20filename=supplier_Migration_File.xlsx','PBrands','../public/language/languages.json','forEach','1379edcteR','supplier','exports','8yxsDIH','/supplier/view','PUnits','$amount','find','Arabic','Email','Spanish','English\x20(US)','20505540cRgkxp','Portuguese','exceljs','map','Workbook','user','address','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','German','then','get','aggregate','Mobile_number','doc','email','landline','\x20Failed','findOne','master','redirect','Arabic\x20(ae)','now','file','purchase_return','mobile','50738WOfHIh','single','suppliers_docs','/products_export_migrate_file','Content-Type','express','supplier.js\x20payment_data','Purchase\x20Return','/supplier_import_migrate_file','purchase','public/Migration/','payable_sum'];a0_0x2413=function(){return _0x38503c;};return a0_0x2413();}router['post'](a0_0x31832f(0x180),auth,uploadMigrate[a0_0x31832f(0x179)](a0_0x31832f(0x149)),async(_0x3587b7,_0x1a1050)=>{const _0x4e8b51=a0_0x31832f,_0x4bdec7=_0x3587b7[_0x4e8b51(0x175)]['filename'],_0x16ec0b=await xlsx[_0x4e8b51(0x11e)](_0x4e8b51(0x182)+_0x4bdec7);let _0x5e0415=_0x16ec0b[_0x4e8b51(0x11f)],_0x495856=xlsx['utils'][_0x4e8b51(0x147)](_0x16ec0b[_0x4e8b51(0x12a)][_0x5e0415[0x0]]);for(const _0x358bd6 of _0x495856){const _0x54a3b5=_0x358bd6['Name'],_0x46464d=_0x358bd6['Supplier_Code'],_0x35b645=_0x358bd6[_0x4e8b51(0x165)],_0x417d28=_0x358bd6[_0x4e8b51(0x16b)],_0x51cc90=_0x358bd6[_0x4e8b51(0x15c)],_0x2564b5=_0x358bd6['Company_Name'];try{let _0x5ad708=await suppliers[_0x4e8b51(0x170)]({'name':_0x54a3b5});if(!_0x5ad708){const _0x28bed2=new suppliers({'name':_0x54a3b5,'suppliers_code':_0x46464d,'address':_0x35b645,'mobile':_0x417d28,'email':_0x51cc90,'company':_0x2564b5});_0x5ad708=await _0x28bed2[_0x4e8b51(0x129)](),_0x3587b7[_0x4e8b51(0x130)]('success',_0x54a3b5+_0x4e8b51(0x12b));}else _0x3587b7[_0x4e8b51(0x130)](_0x4e8b51(0x185),_0x54a3b5+_0x4e8b51(0x16f));}catch(_0x307f82){_0x1a1050['status'](0x1f4)[_0x4e8b51(0x14b)]({'proderror':_0x307f82[_0x4e8b51(0x122)],'aproduct':ProductName});}}_0x1a1050[_0x4e8b51(0x172)](_0x4e8b51(0x157));}),module[a0_0x31832f(0x155)]=router;