const a0_0x5c20c4=a0_0x3663;(function(_0x16eed6,_0x136d28){const _0x165fe6=a0_0x3663,_0x36eae5=_0x16eed6();while(!![]){try{const _0x46ef2a=parseInt(_0x165fe6(0x7d))/0x1*(-parseInt(_0x165fe6(0xa5))/0x2)+parseInt(_0x165fe6(0xa3))/0x3*(-parseInt(_0x165fe6(0x6f))/0x4)+parseInt(_0x165fe6(0xbe))/0x5*(-parseInt(_0x165fe6(0xd6))/0x6)+parseInt(_0x165fe6(0x7c))/0x7+-parseInt(_0x165fe6(0xa7))/0x8+-parseInt(_0x165fe6(0x76))/0x9+parseInt(_0x165fe6(0xc6))/0xa*(parseInt(_0x165fe6(0xc1))/0xb);if(_0x46ef2a===_0x136d28)break;else _0x36eae5['push'](_0x36eae5['shift']());}catch(_0x31ea5d){_0x36eae5['push'](_0x36eae5['shift']());}}}(a0_0x56a7,0x75da3));function a0_0x56a7(){const _0x508b59=['payable','file','\x20added\x20successfully','render','../models/all_models','log','success','aggregate','mobile','express','$amount','Customers','setHeader','Arabic\x20(ae)','contactperson','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','English\x20(US)','diskStorage','save','body','payable_sum','supplier.js\x20payment_data','Name','find','columns','reason','findOne','Arabic','sheet_to_json','Router','supplier\x20data\x20add\x20successfully','params','/view/:id','171neURZu','/supplier_import_migrate_file','148756onyIJn','French','2038232WqoKKc','multer','now','attachment;\x20filename=supplier_Migration_File.xlsx','Supplier_Code','name','/view','Mobile_number','post','error','write','company','Content-Disposition','Purchase','status','SheetNames','receivable','$reason','Hindi','SalesmanName','Email','xlsx','Portuguese\x20(BR)','2125JBpVUJ','map','errors','11poQlLS','Company_Name','language','purchase','Content-Type','25002540jfElly','supplier','\x20Failed','redirect','get','suppliers_docs','/supplier/view','PBrands','German','send','address','doc','receivable_sum','user','email','master','12246POdCRs','findById','60820CJaRVP','English','forEach','single','public/Migration','Spanish','message','1460520VXYdFu','Portuguese','public/Migration/','amount','json','s_payments','6141926ztkJNh','10LxicXZ','Chinese','flash','exports','Sheets'];a0_0x56a7=function(){return _0x508b59;};return a0_0x56a7();}const express=require(a0_0x5c20c4(0x8b)),app=express(),router=express[a0_0x5c20c4(0x9f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x5c20c4(0x86)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require(a0_0x5c20c4(0xbc)),multer=require(a0_0x5c20c4(0xa8));function a0_0x3663(_0x19f70e,_0x255018){const _0x56a730=a0_0x56a7();return a0_0x3663=function(_0x3663de,_0x5a1ad1){_0x3663de=_0x3663de-0x6e;let _0x50ef79=_0x56a730[_0x3663de];return _0x50ef79;},a0_0x3663(_0x19f70e,_0x255018);}router['get'](a0_0x5c20c4(0xad),auth,async(_0x360cb4,_0x32e206)=>{const _0x19565e=a0_0x5c20c4;try{const {username:_0x5499e2,email:_0x3cb9ea,role:_0x444828}=_0x360cb4['user'],_0x26ac9a=_0x360cb4[_0x19565e(0xd3)],_0x51d9fc=await profile[_0x19565e(0x9c)]({'email':_0x26ac9a[_0x19565e(0xd4)]}),_0x3c71e5=await master_shop[_0x19565e(0x99)]();console[_0x19565e(0x87)](_0x19565e(0xd5),_0x3c71e5);const _0x3aa20d=await suppliers[_0x19565e(0x99)]();console[_0x19565e(0x87)](_0x3aa20d);const _0x595fa4=await suppliers[_0x19565e(0x89)]([{'$lookup':{'from':_0x19565e(0x7b),'localField':_0x19565e(0xac),'foreignField':'suppliers','as':_0x19565e(0xcb)}}]),_0x721bfe=_0x595fa4[_0x19565e(0xbf)](_0x2c002a=>{const _0x237433=_0x19565e;console['log']('data',_0x2c002a);var _0x5c734c=0x0,_0x389118=0x0;return _0x2c002a['suppliers_docs'][_0x237433(0x71)](_0x5c0009=>{const _0x381cfd=_0x237433;console['log'](_0x381cfd(0xd1),_0x5c0009),_0x5c0009[_0x381cfd(0x9b)]=='Purchase'?_0x5c734c+=_0x5c0009[_0x381cfd(0x79)]:_0x389118+=_0x5c0009['amount'];}),_0x2c002a[_0x237433(0xc4)]=_0x5c734c,_0x2c002a['purchase_return']=_0x389118,_0x2c002a;});console[_0x19565e(0x87)](_0x19565e(0x97),_0x721bfe);if(_0x3c71e5[0x0][_0x19565e(0xc3)]==_0x19565e(0x92)){var _0x3d5bb0=users['English'];console[_0x19565e(0x87)](_0x3d5bb0);}else{if(_0x3c71e5[0x0][_0x19565e(0xc3)]=='Hindi')var _0x3d5bb0=users['Hindi'];else{if(_0x3c71e5[0x0]['language']==_0x19565e(0xce))var _0x3d5bb0=users['German'];else{if(_0x3c71e5[0x0][_0x19565e(0xc3)]==_0x19565e(0x74))var _0x3d5bb0=users[_0x19565e(0x74)];else{if(_0x3c71e5[0x0][_0x19565e(0xc3)]=='French')var _0x3d5bb0=users[_0x19565e(0xa6)];else{if(_0x3c71e5[0x0][_0x19565e(0xc3)]==_0x19565e(0xbd))var _0x3d5bb0=users['Portuguese'];else{if(_0x3c71e5[0x0][_0x19565e(0xc3)]=='Chinese')var _0x3d5bb0=users[_0x19565e(0x7e)];else{if(_0x3c71e5[0x0][_0x19565e(0xc3)]=='Arabic\x20(ae)')var _0x3d5bb0=users['Arabic'];}}}}}}}_0x32e206['render'](_0x19565e(0xc7),{'success':_0x360cb4['flash'](_0x19565e(0x88)),'errors':_0x360cb4[_0x19565e(0x7f)](_0x19565e(0xc0)),'user':_0x3aa20d,'profile':_0x51d9fc,'master_shop':_0x3c71e5,'role':_0x26ac9a,'payment':_0x721bfe,'language':_0x3d5bb0});}catch(_0x5638fb){console['log'](_0x5638fb);}}),router[a0_0x5c20c4(0xaf)](a0_0x5c20c4(0xad),auth,async(_0x55096e,_0x320ac6)=>{const _0x3fd791=a0_0x5c20c4;try{const {name:_0x529114,email:_0x5f596c,mobile:_0x2ae06c,company:_0x25e8aa,address:_0x2743a9,receivable:_0x614949,payable:_0x4b6fbc,code:_0xec2ddc,contactperson:_0x1ea765,landline:_0x23f970}=_0x55096e['body'],_0x1a5c99=new suppliers({'name':_0x529114,'email':_0x5f596c,'mobile':_0x2ae06c,'company':_0x25e8aa,'address':_0x2743a9,'receivable':_0x614949,'payable':_0x4b6fbc,'suppliers_code':_0xec2ddc,'contactperson':_0x1ea765,'landline':_0x23f970}),_0x23c813=await _0x1a5c99[_0x3fd791(0x94)]();_0x55096e[_0x3fd791(0x7f)](_0x3fd791(0x88),_0x3fd791(0xa0)),_0x320ac6['redirect']('/supplier/view');}catch(_0x41d984){console[_0x3fd791(0x87)](_0x41d984);}}),router[a0_0x5c20c4(0xca)]('/view/:id',auth,async(_0x5c091a,_0x21b425)=>{const _0x4a92be=a0_0x5c20c4;try{const {username:_0x12fb51,email:_0x34d261,role:_0x4e37d2}=_0x5c091a[_0x4a92be(0xd3)],_0x527827=_0x5c091a[_0x4a92be(0xd3)],_0x13c86f=await profile[_0x4a92be(0x9c)]({'email':_0x527827[_0x4a92be(0xd4)]}),_0x5f2131=await master_shop['find']();console[_0x4a92be(0x87)](_0x4a92be(0xd5),_0x5f2131);const _0x309339=_0x5c091a[_0x4a92be(0xa1)]['id'],_0x336de5=await suppliers[_0x4a92be(0x6e)](_0x309339);console[_0x4a92be(0x87)](_0x336de5);if(_0x5f2131[0x0][_0x4a92be(0xc3)]==_0x4a92be(0x92)){var _0x51e717=users[_0x4a92be(0x70)];console[_0x4a92be(0x87)](_0x51e717);}else{if(_0x5f2131[0x0]['language']=='Hindi')var _0x51e717=users[_0x4a92be(0xb9)];else{if(_0x5f2131[0x0][_0x4a92be(0xc3)]==_0x4a92be(0xce))var _0x51e717=users['German'];else{if(_0x5f2131[0x0]['language']==_0x4a92be(0x74))var _0x51e717=users[_0x4a92be(0x74)];else{if(_0x5f2131[0x0][_0x4a92be(0xc3)]==_0x4a92be(0xa6))var _0x51e717=users[_0x4a92be(0xa6)];else{if(_0x5f2131[0x0][_0x4a92be(0xc3)]==_0x4a92be(0xbd))var _0x51e717=users[_0x4a92be(0x77)];else{if(_0x5f2131[0x0][_0x4a92be(0xc3)]==_0x4a92be(0x7e))var _0x51e717=users[_0x4a92be(0x7e)];else{if(_0x5f2131[0x0]['language']==_0x4a92be(0x8f))var _0x51e717=users[_0x4a92be(0x9d)];}}}}}}}_0x21b425[_0x4a92be(0x85)](_0x4a92be(0xc7),{'success':_0x5c091a[_0x4a92be(0x7f)](_0x4a92be(0x88)),'errors':_0x5c091a['flash'](_0x4a92be(0xc0)),'role':_0x527827,'profile':_0x13c86f,'master_shop':_0x5f2131,'user':_0x336de5,'language':_0x51e717});}catch(_0x558918){console['log'](_0x558918);}}),router[a0_0x5c20c4(0xaf)](a0_0x5c20c4(0xa2),auth,async(_0x27854,_0xfbcac9)=>{const _0x97d9e6=a0_0x5c20c4;try{const _0x327ad2=_0x27854[_0x97d9e6(0xa1)]['id'],_0x5c9143=await suppliers['findById'](_0x327ad2),{name:_0xb483a8,email:_0x2320b6,mobile:_0x31fa82,company:_0x435b92,address:_0x363b97,receivable:_0x4ce4d6,payable:_0x46fcbc,code:_0x319cb3,contactperson:_0xdb822,landline:_0x423915}=_0x27854[_0x97d9e6(0x95)];_0x5c9143[_0x97d9e6(0xac)]=_0xb483a8,_0x5c9143[_0x97d9e6(0xd4)]=_0x2320b6,_0x5c9143[_0x97d9e6(0x8a)]=_0x31fa82,_0x5c9143[_0x97d9e6(0xb2)]=_0x435b92,_0x5c9143[_0x97d9e6(0xd0)]=_0x363b97,_0x5c9143[_0x97d9e6(0xb7)]=_0x4ce4d6,_0x5c9143[_0x97d9e6(0x82)]=_0x46fcbc,_0x5c9143['suppliers_code']=_0x319cb3,_0x5c9143[_0x97d9e6(0x90)]=_0xdb822,_0x5c9143['landline']=_0x423915;const _0x168db8=await _0x5c9143[_0x97d9e6(0x94)]();_0x27854[_0x97d9e6(0x7f)](_0x97d9e6(0x88),'supplier\x20data\x20update\x20successfully'),_0xfbcac9['redirect']('/supplier/view');}catch(_0x1d821c){console['log'](_0x1d821c);}}),router['get']('/view/payment/:id',auth,async(_0x180a62,_0x7c16a0)=>{const _0x566489=a0_0x5c20c4;try{const {username:_0x1dfd65,email:_0x30a926,role:_0x35e1a8}=_0x180a62['user'],_0x24f593=_0x180a62[_0x566489(0xd3)],_0x39ef96=await profile['findOne']({'email':_0x24f593[_0x566489(0xd4)]}),_0x3cdeb2=await master_shop[_0x566489(0x99)]();console['log'](_0x566489(0xd5),_0x3cdeb2),console['log'](_0x180a62[_0x566489(0xa1)]['id']);const _0x238a94=await suppliers[_0x566489(0x9c)]({'_id':_0x180a62[_0x566489(0xa1)]['id']});console[_0x566489(0x87)](_0x238a94);const _0xc7bf95=await s_payment_data[_0x566489(0x99)]({'suppliers':_0x238a94[_0x566489(0xac)]});console[_0x566489(0x87)](_0xc7bf95);const _0x8c341c=await s_payment_data[_0x566489(0x89)]([{'$match':{'suppliers':_0x238a94[_0x566489(0xac)]}},{'$match':{'reason':_0x566489(0xb4)}},{'$group':{'_id':_0x566489(0xb8),'sum':{'$sum':'$amount'}}}]);console[_0x566489(0x87)](_0x566489(0x96),_0x8c341c);const _0x8b68a=await s_payment_data[_0x566489(0x89)]([{'$match':{'suppliers':_0x238a94[_0x566489(0xac)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x566489(0xb8),'sum':{'$sum':_0x566489(0x8c)}}}]);console[_0x566489(0x87)](_0x566489(0xd2),_0x8b68a);if(_0x3cdeb2[0x0][_0x566489(0xc3)]=='English\x20(US)'){var _0x441639=users[_0x566489(0x70)];console[_0x566489(0x87)](_0x441639);}else{if(_0x3cdeb2[0x0][_0x566489(0xc3)]==_0x566489(0xb9))var _0x441639=users[_0x566489(0xb9)];else{if(_0x3cdeb2[0x0]['language']==_0x566489(0xce))var _0x441639=users['German'];else{if(_0x3cdeb2[0x0][_0x566489(0xc3)]==_0x566489(0x74))var _0x441639=users[_0x566489(0x74)];else{if(_0x3cdeb2[0x0][_0x566489(0xc3)]==_0x566489(0xa6))var _0x441639=users['French'];else{if(_0x3cdeb2[0x0][_0x566489(0xc3)]==_0x566489(0xbd))var _0x441639=users[_0x566489(0x77)];else{if(_0x3cdeb2[0x0][_0x566489(0xc3)]==_0x566489(0x7e))var _0x441639=users[_0x566489(0x7e)];else{if(_0x3cdeb2[0x0][_0x566489(0xc3)]==_0x566489(0x8f))var _0x441639=users['Arabic'];}}}}}}}_0x7c16a0[_0x566489(0x85)]('supplier_payment',{'success':_0x180a62[_0x566489(0x7f)](_0x566489(0x88)),'errors':_0x180a62['flash'](_0x566489(0xc0)),'role':_0x24f593,'profile':_0x39ef96,'master_shop':_0x3cdeb2,'payment':_0xc7bf95,'payable':_0x8c341c,'receivable':_0x8b68a,'language':_0x441639});}catch(_0x55ba1a){console[_0x566489(0x87)](_0x55ba1a);}}),router['get']('/products_export_migrate_file',auth,async(_0xc07808,_0x5a1f02)=>{const _0x273b43=a0_0x5c20c4;try{const _0x4f2c42=new excelJS['Workbook'](),_0x591a78=_0x4f2c42['addWorksheet'](_0x273b43(0x8d));return _0x591a78[_0x273b43(0x9a)]=[{'header':_0x273b43(0x98),'key':_0x273b43(0xcd),'width':0xa},{'header':_0x273b43(0xab),'key':'PUnits','width':0xa},{'header':_0x273b43(0xbb),'key':_0x273b43(0xba),'width':0xa},{'header':_0x273b43(0xae),'key':_0x273b43(0xd0),'width':0xa},{'header':'Company_Name','key':_0x273b43(0x8a),'width':0xa},{'header':'address','key':_0x273b43(0xd4),'width':0xa}],_0x5a1f02[_0x273b43(0x8e)](_0x273b43(0xc5),_0x273b43(0x91)),_0x5a1f02[_0x273b43(0x8e)](_0x273b43(0xb3),_0x273b43(0xaa)),_0x4f2c42[_0x273b43(0xbc)][_0x273b43(0xb1)](_0x5a1f02)['then'](()=>{_0x5a1f02['status'](0xc8);});}catch(_0x21c450){_0x5a1f02[_0x273b43(0xb5)](0x190)[_0x273b43(0xcf)]({'errors':_0x21c450['message']});}});const storage1=multer[a0_0x5c20c4(0x93)]({'destination':(_0x4e6166,_0x4e7912,_0x5c7ab3)=>{const _0x853241=a0_0x5c20c4;_0x5c7ab3(null,_0x853241(0x73));},'filename':(_0x34a52a,_0xeb5169,_0x4b687a)=>{const _0x5c1879=a0_0x5c20c4;_0x4b687a(null,Date[_0x5c1879(0xa9)]()+_0xeb5169['originalname']);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x5c20c4(0xa4),auth,uploadMigrate[a0_0x5c20c4(0x72)]('supplier_product_file'),async(_0x8bf519,_0x1ff83d)=>{const _0x283150=a0_0x5c20c4,_0x3c5589=_0x8bf519[_0x283150(0x83)]['filename'],_0x4971af=await xlsx['readFile'](_0x283150(0x78)+_0x3c5589);let _0x26cdad=_0x4971af[_0x283150(0xb6)],_0x3e6558=xlsx['utils'][_0x283150(0x9e)](_0x4971af[_0x283150(0x81)][_0x26cdad[0x0]]);for(const _0x4c95b9 of _0x3e6558){const _0x407495=_0x4c95b9[_0x283150(0x98)],_0x3bf6dd=_0x4c95b9[_0x283150(0xab)],_0x484a9c=_0x4c95b9['address'],_0x2fde6b=_0x4c95b9[_0x283150(0xae)],_0xb50217=_0x4c95b9['Email'],_0x416c65=_0x4c95b9[_0x283150(0xc2)];try{let _0x5ac509=await suppliers[_0x283150(0x9c)]({'name':_0x407495});if(!_0x5ac509){const _0x1ec5a5=new suppliers({'name':_0x407495,'suppliers_code':_0x3bf6dd,'address':_0x484a9c,'mobile':_0x2fde6b,'email':_0xb50217,'company':_0x416c65});_0x5ac509=await _0x1ec5a5[_0x283150(0x94)](),_0x8bf519[_0x283150(0x7f)](_0x283150(0x88),_0x407495+_0x283150(0x84));}else _0x8bf519[_0x283150(0x7f)](_0x283150(0xb0),_0x407495+_0x283150(0xc8));}catch(_0x5ad1ca){_0x1ff83d[_0x283150(0xb5)](0x1f4)[_0x283150(0x7a)]({'proderror':_0x5ad1ca[_0x283150(0x75)],'aproduct':ProductName});}}_0x1ff83d[_0x283150(0xc9)](_0x283150(0xcc));}),module[a0_0x5c20c4(0x80)]=router;