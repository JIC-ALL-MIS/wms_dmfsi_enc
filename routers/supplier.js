const a0_0xb11415=a0_0x2073;(function(_0x2f6c23,_0x4adff5){const _0x580ad9=a0_0x2073,_0x5cb329=_0x2f6c23();while(!![]){try{const _0x127b3c=-parseInt(_0x580ad9(0xf8))/0x1*(parseInt(_0x580ad9(0xd0))/0x2)+parseInt(_0x580ad9(0x10e))/0x3+parseInt(_0x580ad9(0xfc))/0x4*(parseInt(_0x580ad9(0xc9))/0x5)+parseInt(_0x580ad9(0x10b))/0x6+-parseInt(_0x580ad9(0xe4))/0x7+parseInt(_0x580ad9(0xda))/0x8*(-parseInt(_0x580ad9(0xf7))/0x9)+-parseInt(_0x580ad9(0x109))/0xa*(parseInt(_0x580ad9(0x106))/0xb);if(_0x127b3c===_0x4adff5)break;else _0x5cb329['push'](_0x5cb329['shift']());}catch(_0x107c25){_0x5cb329['push'](_0x5cb329['shift']());}}}(a0_0x5b3e,0xe9dbc));const express=require(a0_0xb11415(0xe2)),app=express(),router=express[a0_0xb11415(0x10f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require(a0_0xb11415(0xc4)),users=require(a0_0xb11415(0x119)),excelJS=require(a0_0xb11415(0xcc)),xlsx=require(a0_0xb11415(0x112)),multer=require(a0_0xb11415(0x10a));function a0_0x2073(_0x39aed7,_0x556e7d){const _0x5b3ee9=a0_0x5b3e();return a0_0x2073=function(_0x2073f8,_0x40e420){_0x2073f8=_0x2073f8-0xba;let _0x323650=_0x5b3ee9[_0x2073f8];return _0x323650;},a0_0x2073(_0x39aed7,_0x556e7d);}function a0_0x5b3e(){const _0x14983b=['Customers','receivable','Mobile_number','payable_sum','name','columns','landline','113828RQVVpI','map','sheet_to_json','1500TaKnVx','multer','9027948VFWvFe','message','Email','664557rOLgKp','Router','German','send','xlsx','error','post','suppliers_docs','company','French','Company_Name','../public/language/languages.json','success','user','supplier','status','setHeader','find','get','filename','Sheets','addWorksheet','readFile','body','flash','address','payable','Supplier_Code','\x20Failed','supplier.js\x20payment_data','/view/payment/:id','json','$reason','s_payments','log','Arabic\x20(ae)','../middleware/auth','mobile','render','aggregate','doc','8805955fWuTpX','Portuguese\x20(BR)','Spanish','exceljs','/supplier/view','public/Migration','Name','8NmqJKu','forEach','PUnits','SheetNames','suppliers','Content-Type','language','findById','master','exports','24xoMvZj','Arabic','public/Migration/','amount','findOne','save','params','Portuguese','express','English','2060891RJUkmJ','data','Hindi','$amount','/view','SalesmanName','English\x20(US)','redirect','purchase_return','supplier\x20data\x20update\x20successfully','Workbook','errors','Chinese','Purchase','file','PBrands','\x20added\x20successfully','reason','utils','1925397uYhpfG','10268WoOmmn','contactperson','email','supplier_payment','4sysPoT','supplier_product_file','/view/:id'];a0_0x5b3e=function(){return _0x14983b;};return a0_0x5b3e();}router[a0_0xb11415(0x120)](a0_0xb11415(0xe8),auth,async(_0xfe71cd,_0x52b737)=>{const _0x46bc7d=a0_0xb11415;try{const {username:_0x348653,email:_0x53492c,role:_0xf00c73}=_0xfe71cd[_0x46bc7d(0x11b)],_0xcea918=_0xfe71cd[_0x46bc7d(0x11b)],_0xdf5f75=await profile['findOne']({'email':_0xcea918[_0x46bc7d(0xfa)]}),_0x553a6f=await master_shop[_0x46bc7d(0x11f)]();console['log'](_0x46bc7d(0xd8),_0x553a6f);const _0x39203e=await suppliers[_0x46bc7d(0x11f)]();console[_0x46bc7d(0xc2)](_0x39203e);const _0x2ae643=await suppliers[_0x46bc7d(0xc7)]([{'$lookup':{'from':_0x46bc7d(0xc1),'localField':_0x46bc7d(0x103),'foreignField':_0x46bc7d(0xd4),'as':_0x46bc7d(0x115)}}]),_0x532649=_0x2ae643[_0x46bc7d(0x107)](_0x108a22=>{const _0xb1e803=_0x46bc7d;console[_0xb1e803(0xc2)](_0xb1e803(0xe5),_0x108a22);var _0x40879c=0x0,_0x497bd4=0x0;return _0x108a22[_0xb1e803(0x115)][_0xb1e803(0xd1)](_0x566b04=>{const _0x4eb6c9=_0xb1e803;console['log'](_0x4eb6c9(0xc8),_0x566b04),_0x566b04[_0x4eb6c9(0xf5)]==_0x4eb6c9(0xf1)?_0x40879c+=_0x566b04[_0x4eb6c9(0xdd)]:_0x497bd4+=_0x566b04[_0x4eb6c9(0xdd)];}),_0x108a22['purchase']=_0x40879c,_0x108a22[_0xb1e803(0xec)]=_0x497bd4,_0x108a22;});console[_0x46bc7d(0xc2)](_0x46bc7d(0xbd),_0x532649);if(_0x553a6f[0x0][_0x46bc7d(0xd6)]==_0x46bc7d(0xea)){var _0x2fdb09=users['English'];console['log'](_0x2fdb09);}else{if(_0x553a6f[0x0]['language']=='Hindi')var _0x2fdb09=users[_0x46bc7d(0xe6)];else{if(_0x553a6f[0x0][_0x46bc7d(0xd6)]==_0x46bc7d(0x110))var _0x2fdb09=users[_0x46bc7d(0x110)];else{if(_0x553a6f[0x0][_0x46bc7d(0xd6)]==_0x46bc7d(0xcb))var _0x2fdb09=users['Spanish'];else{if(_0x553a6f[0x0][_0x46bc7d(0xd6)]==_0x46bc7d(0x117))var _0x2fdb09=users[_0x46bc7d(0x117)];else{if(_0x553a6f[0x0][_0x46bc7d(0xd6)]==_0x46bc7d(0xca))var _0x2fdb09=users[_0x46bc7d(0xe1)];else{if(_0x553a6f[0x0][_0x46bc7d(0xd6)]==_0x46bc7d(0xf0))var _0x2fdb09=users[_0x46bc7d(0xf0)];else{if(_0x553a6f[0x0]['language']==_0x46bc7d(0xc3))var _0x2fdb09=users[_0x46bc7d(0xdb)];}}}}}}}_0x52b737[_0x46bc7d(0xc6)](_0x46bc7d(0x11c),{'success':_0xfe71cd[_0x46bc7d(0x126)](_0x46bc7d(0x11a)),'errors':_0xfe71cd['flash']('errors'),'user':_0x39203e,'profile':_0xdf5f75,'master_shop':_0x553a6f,'role':_0xcea918,'payment':_0x532649,'language':_0x2fdb09});}catch(_0x36d7f1){console['log'](_0x36d7f1);}}),router[a0_0xb11415(0x114)](a0_0xb11415(0xe8),auth,async(_0x1f56aa,_0x7a3336)=>{const _0x3d5d21=a0_0xb11415;try{const {name:_0x49fde4,email:_0x4bd158,mobile:_0x3ee174,company:_0x3e6e27,address:_0x31fd33,receivable:_0x10ac60,payable:_0x326df8,code:_0x38b835,contactperson:_0x2ee614,landline:_0x55c3eb}=_0x1f56aa[_0x3d5d21(0x125)],_0x501069=new suppliers({'name':_0x49fde4,'email':_0x4bd158,'mobile':_0x3ee174,'company':_0x3e6e27,'address':_0x31fd33,'receivable':_0x10ac60,'payable':_0x326df8,'suppliers_code':_0x38b835,'contactperson':_0x2ee614,'landline':_0x55c3eb}),_0x24c767=await _0x501069[_0x3d5d21(0xdf)]();_0x1f56aa[_0x3d5d21(0x126)](_0x3d5d21(0x11a),'supplier\x20data\x20add\x20successfully'),_0x7a3336['redirect'](_0x3d5d21(0xcd));}catch(_0x14dcfe){console['log'](_0x14dcfe);}}),router[a0_0xb11415(0x120)](a0_0xb11415(0xfe),auth,async(_0x441bfa,_0x25f4f5)=>{const _0x8e0260=a0_0xb11415;try{const {username:_0x1bbb9a,email:_0x36431d,role:_0x2e5dbb}=_0x441bfa[_0x8e0260(0x11b)],_0x3d4d07=_0x441bfa[_0x8e0260(0x11b)],_0x3cc1f5=await profile['findOne']({'email':_0x3d4d07[_0x8e0260(0xfa)]}),_0x3d9044=await master_shop[_0x8e0260(0x11f)]();console[_0x8e0260(0xc2)](_0x8e0260(0xd8),_0x3d9044);const _0x2df9d6=_0x441bfa[_0x8e0260(0xe0)]['id'],_0xe24839=await suppliers[_0x8e0260(0xd7)](_0x2df9d6);console['log'](_0xe24839);if(_0x3d9044[0x0][_0x8e0260(0xd6)]==_0x8e0260(0xea)){var _0x195fbb=users[_0x8e0260(0xe3)];console['log'](_0x195fbb);}else{if(_0x3d9044[0x0][_0x8e0260(0xd6)]=='Hindi')var _0x195fbb=users[_0x8e0260(0xe6)];else{if(_0x3d9044[0x0][_0x8e0260(0xd6)]==_0x8e0260(0x110))var _0x195fbb=users[_0x8e0260(0x110)];else{if(_0x3d9044[0x0][_0x8e0260(0xd6)]==_0x8e0260(0xcb))var _0x195fbb=users['Spanish'];else{if(_0x3d9044[0x0][_0x8e0260(0xd6)]==_0x8e0260(0x117))var _0x195fbb=users[_0x8e0260(0x117)];else{if(_0x3d9044[0x0][_0x8e0260(0xd6)]=='Portuguese\x20(BR)')var _0x195fbb=users[_0x8e0260(0xe1)];else{if(_0x3d9044[0x0][_0x8e0260(0xd6)]==_0x8e0260(0xf0))var _0x195fbb=users[_0x8e0260(0xf0)];else{if(_0x3d9044[0x0][_0x8e0260(0xd6)]==_0x8e0260(0xc3))var _0x195fbb=users[_0x8e0260(0xdb)];}}}}}}}_0x25f4f5[_0x8e0260(0xc6)](_0x8e0260(0x11c),{'success':_0x441bfa['flash'](_0x8e0260(0x11a)),'errors':_0x441bfa[_0x8e0260(0x126)](_0x8e0260(0xef)),'role':_0x3d4d07,'profile':_0x3cc1f5,'master_shop':_0x3d9044,'user':_0xe24839,'language':_0x195fbb});}catch(_0xd5b08){console['log'](_0xd5b08);}}),router[a0_0xb11415(0x114)]('/view/:id',auth,async(_0x4d2de6,_0x400cd6)=>{const _0x17751c=a0_0xb11415;try{const _0x5d77a7=_0x4d2de6['params']['id'],_0x1b4c62=await suppliers[_0x17751c(0xd7)](_0x5d77a7),{name:_0x495784,email:_0x36b44e,mobile:_0x4ef94,company:_0x579142,address:_0x23a52e,receivable:_0x4b7801,payable:_0x132e6f,code:_0x3d50b9,contactperson:_0x23c7a9,landline:_0x4f7a3d}=_0x4d2de6[_0x17751c(0x125)];_0x1b4c62[_0x17751c(0x103)]=_0x495784,_0x1b4c62[_0x17751c(0xfa)]=_0x36b44e,_0x1b4c62[_0x17751c(0xc5)]=_0x4ef94,_0x1b4c62[_0x17751c(0x116)]=_0x579142,_0x1b4c62[_0x17751c(0x127)]=_0x23a52e,_0x1b4c62[_0x17751c(0x100)]=_0x4b7801,_0x1b4c62[_0x17751c(0xba)]=_0x132e6f,_0x1b4c62['suppliers_code']=_0x3d50b9,_0x1b4c62[_0x17751c(0xf9)]=_0x23c7a9,_0x1b4c62[_0x17751c(0x105)]=_0x4f7a3d;const _0x505375=await _0x1b4c62[_0x17751c(0xdf)]();_0x4d2de6[_0x17751c(0x126)](_0x17751c(0x11a),_0x17751c(0xed)),_0x400cd6[_0x17751c(0xeb)](_0x17751c(0xcd));}catch(_0x2514c2){console[_0x17751c(0xc2)](_0x2514c2);}}),router[a0_0xb11415(0x120)](a0_0xb11415(0xbe),auth,async(_0x5ed432,_0x1bb0eb)=>{const _0x659d2e=a0_0xb11415;try{const {username:_0x3afecd,email:_0x2f839d,role:_0x48db87}=_0x5ed432[_0x659d2e(0x11b)],_0x5cbbe2=_0x5ed432[_0x659d2e(0x11b)],_0x1a9109=await profile['findOne']({'email':_0x5cbbe2[_0x659d2e(0xfa)]}),_0x17dbb4=await master_shop[_0x659d2e(0x11f)]();console[_0x659d2e(0xc2)]('master',_0x17dbb4),console[_0x659d2e(0xc2)](_0x5ed432['params']['id']);const _0x615873=await suppliers[_0x659d2e(0xde)]({'_id':_0x5ed432[_0x659d2e(0xe0)]['id']});console[_0x659d2e(0xc2)](_0x615873);const _0x338f27=await s_payment_data[_0x659d2e(0x11f)]({'suppliers':_0x615873[_0x659d2e(0x103)]});console['log'](_0x338f27);const _0x18ed60=await s_payment_data[_0x659d2e(0xc7)]([{'$match':{'suppliers':_0x615873[_0x659d2e(0x103)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x659d2e(0xc0),'sum':{'$sum':_0x659d2e(0xe7)}}}]);console['log'](_0x659d2e(0x102),_0x18ed60);const _0x4e77e9=await s_payment_data[_0x659d2e(0xc7)]([{'$match':{'suppliers':_0x615873['name']}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x659d2e(0xc0),'sum':{'$sum':_0x659d2e(0xe7)}}}]);console[_0x659d2e(0xc2)]('receivable_sum',_0x4e77e9);if(_0x17dbb4[0x0][_0x659d2e(0xd6)]==_0x659d2e(0xea)){var _0x404031=users[_0x659d2e(0xe3)];console[_0x659d2e(0xc2)](_0x404031);}else{if(_0x17dbb4[0x0][_0x659d2e(0xd6)]==_0x659d2e(0xe6))var _0x404031=users[_0x659d2e(0xe6)];else{if(_0x17dbb4[0x0][_0x659d2e(0xd6)]=='German')var _0x404031=users['German'];else{if(_0x17dbb4[0x0][_0x659d2e(0xd6)]==_0x659d2e(0xcb))var _0x404031=users[_0x659d2e(0xcb)];else{if(_0x17dbb4[0x0][_0x659d2e(0xd6)]==_0x659d2e(0x117))var _0x404031=users[_0x659d2e(0x117)];else{if(_0x17dbb4[0x0][_0x659d2e(0xd6)]==_0x659d2e(0xca))var _0x404031=users[_0x659d2e(0xe1)];else{if(_0x17dbb4[0x0][_0x659d2e(0xd6)]==_0x659d2e(0xf0))var _0x404031=users[_0x659d2e(0xf0)];else{if(_0x17dbb4[0x0][_0x659d2e(0xd6)]==_0x659d2e(0xc3))var _0x404031=users[_0x659d2e(0xdb)];}}}}}}}_0x1bb0eb[_0x659d2e(0xc6)](_0x659d2e(0xfb),{'success':_0x5ed432[_0x659d2e(0x126)](_0x659d2e(0x11a)),'errors':_0x5ed432[_0x659d2e(0x126)]('errors'),'role':_0x5cbbe2,'profile':_0x1a9109,'master_shop':_0x17dbb4,'payment':_0x338f27,'payable':_0x18ed60,'receivable':_0x4e77e9,'language':_0x404031});}catch(_0x50ce30){console[_0x659d2e(0xc2)](_0x50ce30);}}),router[a0_0xb11415(0x120)]('/products_export_migrate_file',auth,async(_0x221d3f,_0x97577b)=>{const _0x4d82fc=a0_0xb11415;try{const _0x25953a=new excelJS[(_0x4d82fc(0xee))](),_0x26701c=_0x25953a[_0x4d82fc(0x123)](_0x4d82fc(0xff));return _0x26701c[_0x4d82fc(0x104)]=[{'header':_0x4d82fc(0xcf),'key':_0x4d82fc(0xf3),'width':0xa},{'header':_0x4d82fc(0xbb),'key':_0x4d82fc(0xd2),'width':0xa},{'header':'Email','key':_0x4d82fc(0xe9),'width':0xa},{'header':_0x4d82fc(0x101),'key':_0x4d82fc(0x127),'width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':'address','key':'email','width':0xa}],_0x97577b[_0x4d82fc(0x11e)](_0x4d82fc(0xd5),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x97577b['setHeader']('Content-Disposition','attachment;\x20filename=supplier_Migration_File.xlsx'),_0x25953a[_0x4d82fc(0x112)]['write'](_0x97577b)['then'](()=>{_0x97577b['status'](0xc8);});}catch(_0x1cfbc7){_0x97577b[_0x4d82fc(0x11d)](0x190)[_0x4d82fc(0x111)]({'errors':_0x1cfbc7['message']});}});const storage1=multer['diskStorage']({'destination':(_0x5e0134,_0x24007f,_0x1424c6)=>{const _0x10947c=a0_0xb11415;_0x1424c6(null,_0x10947c(0xce));},'filename':(_0x33738e,_0x370f29,_0x126597)=>{_0x126597(null,Date['now']()+_0x370f29['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0xb11415(0x114)]('/supplier_import_migrate_file',auth,uploadMigrate['single'](a0_0xb11415(0xfd)),async(_0x3dd472,_0x5de47b)=>{const _0x39bab5=a0_0xb11415,_0x18a569=_0x3dd472[_0x39bab5(0xf2)][_0x39bab5(0x121)],_0x15cdb2=await xlsx[_0x39bab5(0x124)](_0x39bab5(0xdc)+_0x18a569);let _0x5a2aa5=_0x15cdb2[_0x39bab5(0xd3)],_0x5789e6=xlsx[_0x39bab5(0xf6)][_0x39bab5(0x108)](_0x15cdb2[_0x39bab5(0x122)][_0x5a2aa5[0x0]]);for(const _0x2786c5 of _0x5789e6){const _0x21d623=_0x2786c5[_0x39bab5(0xcf)],_0x1abe9f=_0x2786c5[_0x39bab5(0xbb)],_0x1542ca=_0x2786c5[_0x39bab5(0x127)],_0x106c56=_0x2786c5[_0x39bab5(0x101)],_0x56b77b=_0x2786c5[_0x39bab5(0x10d)],_0x163f67=_0x2786c5[_0x39bab5(0x118)];try{let _0x5f50a7=await suppliers[_0x39bab5(0xde)]({'name':_0x21d623});if(!_0x5f50a7){const _0x332117=new suppliers({'name':_0x21d623,'suppliers_code':_0x1abe9f,'address':_0x1542ca,'mobile':_0x106c56,'email':_0x56b77b,'company':_0x163f67});_0x5f50a7=await _0x332117[_0x39bab5(0xdf)](),_0x3dd472[_0x39bab5(0x126)]('success',_0x21d623+_0x39bab5(0xf4));}else _0x3dd472['flash'](_0x39bab5(0x113),_0x21d623+_0x39bab5(0xbc));}catch(_0x15aafb){_0x5de47b[_0x39bab5(0x11d)](0x1f4)[_0x39bab5(0xbf)]({'proderror':_0x15aafb[_0x39bab5(0x10c)],'aproduct':ProductName});}}_0x5de47b[_0x39bab5(0xeb)]('/supplier/view');}),module[a0_0xb11415(0xd9)]=router;