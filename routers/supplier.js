const a0_0x58d157=a0_0x2b39;(function(_0x2a2b14,_0x1df009){const _0x98d3d3=a0_0x2b39,_0x5e553d=_0x2a2b14();while(!![]){try{const _0x181514=parseInt(_0x98d3d3(0x1bb))/0x1*(parseInt(_0x98d3d3(0x18f))/0x2)+parseInt(_0x98d3d3(0x19c))/0x3*(parseInt(_0x98d3d3(0x1b7))/0x4)+-parseInt(_0x98d3d3(0x1a2))/0x5*(-parseInt(_0x98d3d3(0x195))/0x6)+parseInt(_0x98d3d3(0x1ba))/0x7*(parseInt(_0x98d3d3(0x1aa))/0x8)+-parseInt(_0x98d3d3(0x175))/0x9+-parseInt(_0x98d3d3(0x1a4))/0xa*(-parseInt(_0x98d3d3(0x1b4))/0xb)+-parseInt(_0x98d3d3(0x18d))/0xc;if(_0x181514===_0x1df009)break;else _0x5e553d['push'](_0x5e553d['shift']());}catch(_0x6f0f56){_0x5e553d['push'](_0x5e553d['shift']());}}}(a0_0x5876,0xe4722));const express=require('express'),app=express(),router=express[a0_0x58d157(0x1c7)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x58d157(0x17f)),auth=require(a0_0x58d157(0x1af)),users=require(a0_0x58d157(0x1b8)),excelJS=require(a0_0x58d157(0x1a7)),xlsx=require(a0_0x58d157(0x1ce)),multer=require(a0_0x58d157(0x1b1));function a0_0x2b39(_0x51262b,_0x4217e1){const _0x5876a1=a0_0x5876();return a0_0x2b39=function(_0x2b394a,_0x548ad5){_0x2b394a=_0x2b394a-0x170;let _0x19915e=_0x5876a1[_0x2b394a];return _0x19915e;},a0_0x2b39(_0x51262b,_0x4217e1);}router['get'](a0_0x58d157(0x1c6),auth,async(_0x42f3a1,_0x3ccf44)=>{const _0x5968c9=a0_0x58d157;try{const {username:_0x38b7b9,email:_0x40fee7,role:_0x4b0e55}=_0x42f3a1[_0x5968c9(0x192)],_0x16b983=_0x42f3a1[_0x5968c9(0x192)],_0x4d4fb4=await profile[_0x5968c9(0x1cc)]({'email':_0x16b983['email']}),_0x32d963=await master_shop[_0x5968c9(0x186)]();console[_0x5968c9(0x1b6)](_0x5968c9(0x1ca),_0x32d963);const _0x25cebe=await suppliers[_0x5968c9(0x186)]();console[_0x5968c9(0x1b6)](_0x25cebe);const _0x2134df=await suppliers[_0x5968c9(0x18b)]([{'$lookup':{'from':'s_payments','localField':_0x5968c9(0x1d7),'foreignField':_0x5968c9(0x1a0),'as':'suppliers_docs'}}]),_0x37fab9=_0x2134df['map'](_0x1e11ae=>{const _0x89e8a6=_0x5968c9;console['log'](_0x89e8a6(0x180),_0x1e11ae);var _0x3c0877=0x0,_0x5eecd2=0x0;return _0x1e11ae['suppliers_docs'][_0x89e8a6(0x1a8)](_0x4510c2=>{const _0x4b4283=_0x89e8a6;console['log'](_0x4b4283(0x1be),_0x4510c2),_0x4510c2[_0x4b4283(0x187)]==_0x4b4283(0x184)?_0x3c0877+=_0x4510c2[_0x4b4283(0x17a)]:_0x5eecd2+=_0x4510c2[_0x4b4283(0x17a)];}),_0x1e11ae[_0x89e8a6(0x1d5)]=_0x3c0877,_0x1e11ae[_0x89e8a6(0x179)]=_0x5eecd2,_0x1e11ae;});console['log']('supplier.js\x20payment_data',_0x37fab9);if(_0x32d963[0x0][_0x5968c9(0x1ab)]==_0x5968c9(0x1cd)){var _0x45eb3b=users['English'];console[_0x5968c9(0x1b6)](_0x45eb3b);}else{if(_0x32d963[0x0][_0x5968c9(0x1ab)]==_0x5968c9(0x1ae))var _0x45eb3b=users[_0x5968c9(0x1ae)];else{if(_0x32d963[0x0]['language']==_0x5968c9(0x191))var _0x45eb3b=users[_0x5968c9(0x191)];else{if(_0x32d963[0x0][_0x5968c9(0x1ab)]==_0x5968c9(0x1cf))var _0x45eb3b=users['Spanish'];else{if(_0x32d963[0x0][_0x5968c9(0x1ab)]=='French')var _0x45eb3b=users[_0x5968c9(0x1d0)];else{if(_0x32d963[0x0][_0x5968c9(0x1ab)]=='Portuguese\x20(BR)')var _0x45eb3b=users[_0x5968c9(0x17e)];else{if(_0x32d963[0x0][_0x5968c9(0x1ab)]==_0x5968c9(0x1d1))var _0x45eb3b=users[_0x5968c9(0x1d1)];else{if(_0x32d963[0x0][_0x5968c9(0x1ab)]==_0x5968c9(0x185))var _0x45eb3b=users['Arabic'];}}}}}}}_0x3ccf44[_0x5968c9(0x1bf)](_0x5968c9(0x1b0),{'success':_0x42f3a1[_0x5968c9(0x171)](_0x5968c9(0x1d3)),'errors':_0x42f3a1[_0x5968c9(0x171)](_0x5968c9(0x1c0)),'user':_0x25cebe,'profile':_0x4d4fb4,'master_shop':_0x32d963,'role':_0x16b983,'payment':_0x37fab9,'language':_0x45eb3b});}catch(_0x66cb4f){console[_0x5968c9(0x1b6)](_0x66cb4f);}}),router[a0_0x58d157(0x178)]('/view',auth,async(_0x3f4756,_0x3dc1d0)=>{const _0x35348a=a0_0x58d157;try{const {name:_0x1f2229,email:_0x165d9f,mobile:_0x16c2f9,company:_0x192d7e,address:_0x5a820d,receivable:_0x41f165,payable:_0x3d65c9,code:_0x1c6699,contactperson:_0x5619c9,landline:_0x17a9ed}=_0x3f4756[_0x35348a(0x1a1)],_0x4a216b=new suppliers({'name':_0x1f2229,'email':_0x165d9f,'mobile':_0x16c2f9,'company':_0x192d7e,'address':_0x5a820d,'receivable':_0x41f165,'payable':_0x3d65c9,'suppliers_code':_0x1c6699,'contactperson':_0x5619c9,'landline':_0x17a9ed}),_0x2cb6c6=await _0x4a216b[_0x35348a(0x17c)]();_0x3f4756[_0x35348a(0x171)](_0x35348a(0x1d3),_0x35348a(0x1d9)),_0x3dc1d0['redirect'](_0x35348a(0x183));}catch(_0x995a5b){console[_0x35348a(0x1b6)](_0x995a5b);}}),router['get'](a0_0x58d157(0x18a),auth,async(_0xf42586,_0x246ef4)=>{const _0x1234fc=a0_0x58d157;try{const {username:_0x529094,email:_0x48527e,role:_0xd204fd}=_0xf42586['user'],_0x42c4fc=_0xf42586[_0x1234fc(0x192)],_0xe03756=await profile[_0x1234fc(0x1cc)]({'email':_0x42c4fc[_0x1234fc(0x1a9)]}),_0x2badb1=await master_shop[_0x1234fc(0x186)]();console[_0x1234fc(0x1b6)](_0x1234fc(0x1ca),_0x2badb1);const _0x3a48d5=_0xf42586[_0x1234fc(0x199)]['id'],_0x4e0e82=await suppliers['findById'](_0x3a48d5);console[_0x1234fc(0x1b6)](_0x4e0e82);if(_0x2badb1[0x0][_0x1234fc(0x1ab)]==_0x1234fc(0x1cd)){var _0x1895bf=users['English'];console[_0x1234fc(0x1b6)](_0x1895bf);}else{if(_0x2badb1[0x0]['language']==_0x1234fc(0x1ae))var _0x1895bf=users[_0x1234fc(0x1ae)];else{if(_0x2badb1[0x0][_0x1234fc(0x1ab)]=='German')var _0x1895bf=users[_0x1234fc(0x191)];else{if(_0x2badb1[0x0][_0x1234fc(0x1ab)]=='Spanish')var _0x1895bf=users[_0x1234fc(0x1cf)];else{if(_0x2badb1[0x0][_0x1234fc(0x1ab)]==_0x1234fc(0x1d0))var _0x1895bf=users[_0x1234fc(0x1d0)];else{if(_0x2badb1[0x0][_0x1234fc(0x1ab)]==_0x1234fc(0x1bd))var _0x1895bf=users[_0x1234fc(0x17e)];else{if(_0x2badb1[0x0][_0x1234fc(0x1ab)]==_0x1234fc(0x1d1))var _0x1895bf=users[_0x1234fc(0x1d1)];else{if(_0x2badb1[0x0]['language']==_0x1234fc(0x185))var _0x1895bf=users[_0x1234fc(0x198)];}}}}}}}_0x246ef4[_0x1234fc(0x1bf)]('supplier',{'success':_0xf42586[_0x1234fc(0x171)](_0x1234fc(0x1d3)),'errors':_0xf42586[_0x1234fc(0x171)]('errors'),'role':_0x42c4fc,'profile':_0xe03756,'master_shop':_0x2badb1,'user':_0x4e0e82,'language':_0x1895bf});}catch(_0x2df1e0){console[_0x1234fc(0x1b6)](_0x2df1e0);}}),router[a0_0x58d157(0x178)](a0_0x58d157(0x18a),auth,async(_0x5db473,_0x47689b)=>{const _0x57a411=a0_0x58d157;try{const _0x360164=_0x5db473['params']['id'],_0x28322a=await suppliers[_0x57a411(0x194)](_0x360164),{name:_0x1c38e7,email:_0x148ec2,mobile:_0x20a0d3,company:_0x42dea6,address:_0x16145f,receivable:_0x1e3181,payable:_0x3f92f3,code:_0x2f2e83,contactperson:_0x4ef4ad,landline:_0x5460fa}=_0x5db473['body'];_0x28322a[_0x57a411(0x1d7)]=_0x1c38e7,_0x28322a[_0x57a411(0x1a9)]=_0x148ec2,_0x28322a[_0x57a411(0x181)]=_0x20a0d3,_0x28322a[_0x57a411(0x170)]=_0x42dea6,_0x28322a[_0x57a411(0x177)]=_0x16145f,_0x28322a[_0x57a411(0x182)]=_0x1e3181,_0x28322a[_0x57a411(0x19d)]=_0x3f92f3,_0x28322a['suppliers_code']=_0x2f2e83,_0x28322a[_0x57a411(0x1b2)]=_0x4ef4ad,_0x28322a[_0x57a411(0x1a6)]=_0x5460fa;const _0x303c58=await _0x28322a[_0x57a411(0x17c)]();_0x5db473['flash'](_0x57a411(0x1d3),'supplier\x20data\x20update\x20successfully'),_0x47689b[_0x57a411(0x176)](_0x57a411(0x183));}catch(_0x2cbb6a){console[_0x57a411(0x1b6)](_0x2cbb6a);}}),router[a0_0x58d157(0x190)]('/view/payment/:id',auth,async(_0x4c9314,_0xad13b4)=>{const _0x4663dd=a0_0x58d157;try{const {username:_0x3c9921,email:_0x21a9d6,role:_0x540f30}=_0x4c9314[_0x4663dd(0x192)],_0x2fd696=_0x4c9314[_0x4663dd(0x192)],_0x4f24d4=await profile[_0x4663dd(0x1cc)]({'email':_0x2fd696[_0x4663dd(0x1a9)]}),_0x4955f0=await master_shop[_0x4663dd(0x186)]();console[_0x4663dd(0x1b6)](_0x4663dd(0x1ca),_0x4955f0),console['log'](_0x4c9314[_0x4663dd(0x199)]['id']);const _0xe3a9ee=await suppliers[_0x4663dd(0x1cc)]({'_id':_0x4c9314['params']['id']});console[_0x4663dd(0x1b6)](_0xe3a9ee);const _0x899e28=await s_payment_data[_0x4663dd(0x186)]({'suppliers':_0xe3a9ee[_0x4663dd(0x1d7)]});console[_0x4663dd(0x1b6)](_0x899e28);const _0x2db0b8=await s_payment_data[_0x4663dd(0x18b)]([{'$match':{'suppliers':_0xe3a9ee['name']}},{'$match':{'reason':_0x4663dd(0x184)}},{'$group':{'_id':_0x4663dd(0x193),'sum':{'$sum':'$amount'}}}]);console[_0x4663dd(0x1b6)](_0x4663dd(0x1b3),_0x2db0b8);const _0x203220=await s_payment_data[_0x4663dd(0x18b)]([{'$match':{'suppliers':_0xe3a9ee['name']}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x4663dd(0x193),'sum':{'$sum':_0x4663dd(0x1b5)}}}]);console['log'](_0x4663dd(0x18c),_0x203220);if(_0x4955f0[0x0][_0x4663dd(0x1ab)]==_0x4663dd(0x1cd)){var _0xd2342e=users[_0x4663dd(0x1c3)];console[_0x4663dd(0x1b6)](_0xd2342e);}else{if(_0x4955f0[0x0][_0x4663dd(0x1ab)]=='Hindi')var _0xd2342e=users[_0x4663dd(0x1ae)];else{if(_0x4955f0[0x0]['language']==_0x4663dd(0x191))var _0xd2342e=users[_0x4663dd(0x191)];else{if(_0x4955f0[0x0]['language']=='Spanish')var _0xd2342e=users[_0x4663dd(0x1cf)];else{if(_0x4955f0[0x0][_0x4663dd(0x1ab)]=='French')var _0xd2342e=users[_0x4663dd(0x1d0)];else{if(_0x4955f0[0x0]['language']==_0x4663dd(0x1bd))var _0xd2342e=users['Portuguese'];else{if(_0x4955f0[0x0][_0x4663dd(0x1ab)]==_0x4663dd(0x1d1))var _0xd2342e=users[_0x4663dd(0x1d1)];else{if(_0x4955f0[0x0]['language']=='Arabic\x20(ae)')var _0xd2342e=users[_0x4663dd(0x198)];}}}}}}}_0xad13b4[_0x4663dd(0x1bf)](_0x4663dd(0x1ad),{'success':_0x4c9314[_0x4663dd(0x171)](_0x4663dd(0x1d3)),'errors':_0x4c9314[_0x4663dd(0x171)](_0x4663dd(0x1c0)),'role':_0x2fd696,'profile':_0x4f24d4,'master_shop':_0x4955f0,'payment':_0x899e28,'payable':_0x2db0b8,'receivable':_0x203220,'language':_0xd2342e});}catch(_0x206434){console['log'](_0x206434);}}),router[a0_0x58d157(0x190)](a0_0x58d157(0x1c8),auth,async(_0x54e4b3,_0x533fd7)=>{const _0x397129=a0_0x58d157;try{const _0x3ae08d=new excelJS['Workbook'](),_0xc65685=_0x3ae08d['addWorksheet']('Customers');return _0xc65685[_0x397129(0x174)]=[{'header':'Name','key':_0x397129(0x1c9),'width':0xa},{'header':_0x397129(0x1ac),'key':'PUnits','width':0xa},{'header':'Email','key':_0x397129(0x1d4),'width':0xa},{'header':'Mobile_number','key':_0x397129(0x177),'width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':'address','key':_0x397129(0x1a9),'width':0xa}],_0x533fd7['setHeader']('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x533fd7[_0x397129(0x1d8)]('Content-Disposition',_0x397129(0x19b)),_0x3ae08d['xlsx'][_0x397129(0x19f)](_0x533fd7)[_0x397129(0x1d2)](()=>{const _0x4dc8a0=_0x397129;_0x533fd7[_0x4dc8a0(0x17d)](0xc8);});}catch(_0x2c5c2c){_0x533fd7[_0x397129(0x17d)](0x190)['send']({'errors':_0x2c5c2c[_0x397129(0x1bc)]});}});const storage1=multer['diskStorage']({'destination':(_0x2df0b2,_0x14ad70,_0x544981)=>{const _0x3d9e27=a0_0x58d157;_0x544981(null,_0x3d9e27(0x1c5));},'filename':(_0x253280,_0x2886fa,_0x26d65b)=>{const _0x5021b6=a0_0x58d157;_0x26d65b(null,Date[_0x5021b6(0x1a3)]()+_0x2886fa[_0x5021b6(0x1b9)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x5876(){const _0x1bb7f1=['Portuguese','../models/all_models','data','mobile','receivable','/supplier/view','Purchase','Arabic\x20(ae)','find','reason','file','error','/view/:id','aggregate','receivable_sum','18071424MtJtUJ','sheet_to_json','109754HqdByJ','get','German','user','$reason','findById','1671492SToSHj','\x20added\x20successfully','Name','Arabic','params','public/Migration/','attachment;\x20filename=supplier_Migration_File.xlsx','339voNXdj','payable','readFile','write','suppliers','body','10hJPjYD','now','40yqnzyg','filename','landline','exceljs','forEach','email','2082840fxgYSN','language','Supplier_Code','supplier_payment','Hindi','../middleware/auth','supplier','multer','contactperson','payable_sum','4664341MmPEpL','$amount','log','41844ICdjwk','../public/language/languages.json','originalname','14uthePg','1TcidYk','message','Portuguese\x20(BR)','doc','render','errors','/supplier_import_migrate_file','Email','English','Mobile_number','public/Migration','/view','Router','/products_export_migrate_file','PBrands','master','Company_Name','findOne','English\x20(US)','xlsx','Spanish','French','Chinese','then','success','SalesmanName','purchase','Sheets','name','setHeader','supplier\x20data\x20add\x20successfully','company','flash','\x20Failed','supplier_product_file','columns','14123718DjQyJN','redirect','address','post','purchase_return','amount','exports','save','status'];a0_0x5876=function(){return _0x1bb7f1;};return a0_0x5876();}router[a0_0x58d157(0x178)](a0_0x58d157(0x1c1),auth,uploadMigrate['single'](a0_0x58d157(0x173)),async(_0x4548c6,_0x2820be)=>{const _0x394ece=a0_0x58d157,_0x55ce4f=_0x4548c6[_0x394ece(0x188)][_0x394ece(0x1a5)],_0x881dc3=await xlsx[_0x394ece(0x19e)](_0x394ece(0x19a)+_0x55ce4f);let _0x2b9a50=_0x881dc3['SheetNames'],_0x172164=xlsx['utils'][_0x394ece(0x18e)](_0x881dc3[_0x394ece(0x1d6)][_0x2b9a50[0x0]]);for(const _0x3bb9bc of _0x172164){const _0x28f273=_0x3bb9bc[_0x394ece(0x197)],_0x4a2f43=_0x3bb9bc[_0x394ece(0x1ac)],_0x5435a8=_0x3bb9bc[_0x394ece(0x177)],_0x385e05=_0x3bb9bc[_0x394ece(0x1c4)],_0x4794f3=_0x3bb9bc[_0x394ece(0x1c2)],_0x4d1acb=_0x3bb9bc[_0x394ece(0x1cb)];try{let _0x52d9ac=await suppliers['findOne']({'name':_0x28f273});if(!_0x52d9ac){const _0x272807=new suppliers({'name':_0x28f273,'suppliers_code':_0x4a2f43,'address':_0x5435a8,'mobile':_0x385e05,'email':_0x4794f3,'company':_0x4d1acb});_0x52d9ac=await _0x272807[_0x394ece(0x17c)](),_0x4548c6[_0x394ece(0x171)]('success',_0x28f273+_0x394ece(0x196));}else _0x4548c6[_0x394ece(0x171)](_0x394ece(0x189),_0x28f273+_0x394ece(0x172));}catch(_0x4464c1){_0x2820be['status'](0x1f4)['json']({'proderror':_0x4464c1['message'],'aproduct':ProductName});}}_0x2820be[_0x394ece(0x176)]('/supplier/view');}),module[a0_0x58d157(0x17b)]=router;