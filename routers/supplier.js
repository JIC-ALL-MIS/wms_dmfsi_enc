const a0_0x1c2efc=a0_0x5c47;function a0_0x5c47(_0x415fe6,_0x5432d9){const _0x59e2a5=a0_0x59e2();return a0_0x5c47=function(_0x5c4781,_0x2af413){_0x5c4781=_0x5c4781-0x1e5;let _0xea6c6b=_0x59e2a5[_0x5c4781];return _0xea6c6b;},a0_0x5c47(_0x415fe6,_0x5432d9);}(function(_0x5d7fae,_0x3d933e){const _0x4127f5=a0_0x5c47,_0x237070=_0x5d7fae();while(!![]){try{const _0x48b362=-parseInt(_0x4127f5(0x20e))/0x1+-parseInt(_0x4127f5(0x1e6))/0x2*(-parseInt(_0x4127f5(0x227))/0x3)+-parseInt(_0x4127f5(0x239))/0x4+parseInt(_0x4127f5(0x21f))/0x5*(parseInt(_0x4127f5(0x21d))/0x6)+-parseInt(_0x4127f5(0x215))/0x7+parseInt(_0x4127f5(0x1f6))/0x8*(-parseInt(_0x4127f5(0x224))/0x9)+parseInt(_0x4127f5(0x204))/0xa*(parseInt(_0x4127f5(0x243))/0xb);if(_0x48b362===_0x3d933e)break;else _0x237070['push'](_0x237070['shift']());}catch(_0x5eae6e){_0x237070['push'](_0x237070['shift']());}}}(a0_0x59e2,0x66305));function a0_0x59e2(){const _0x3a4406=['supplier.js\x20payment_data','setHeader','Hindi','859420KqmTIQ','exceljs','redirect','/view','suppliers_docs','doc','file','map','body','get','1001RabFsz','flash','public/Migration','success','$reason','company','Router','master','/view/payment/:id','supplier','PUnits','\x20Failed','Mobile_number','email','2loXbgq','Content-Type','Portuguese\x20(BR)','aggregate','supplier_payment','Portuguese','/supplier/view','Content-Disposition','post','render','language','sheet_to_json','addWorksheet','purchase_return','reason','Supplier_Code','430280UzOKns','../models/all_models','data','../middleware/auth','Email','/products_export_migrate_file','German','amount','suppliers_code','then','name','forEach','Arabic\x20(ae)','log','72690cXbonW','supplier\x20data\x20update\x20successfully','columns','receivable','save','address','Company_Name','SalesmanName','English\x20(US)','SheetNames','140359YKBGGw','Spanish','receivable_sum','readFile','s_payments','mobile','findById','4910913Gqoyoe','user','\x20added\x20successfully','exports','utils','Purchase','status','single','2982dNJJvr','public/Migration/','8390AsgLsK','Name','$amount','/supplier_import_migrate_file','originalname','27BOfCBt','write','error','423744xzPgDv','filename','find','params','errors','purchase','English','payable_sum','French','xlsx','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Arabic','findOne','Chinese','Purchase\x20Return'];a0_0x59e2=function(){return _0x3a4406;};return a0_0x59e2();}const express=require('express'),app=express(),router=express[a0_0x1c2efc(0x249)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1c2efc(0x1f7)),auth=require(a0_0x1c2efc(0x1f9)),users=require('../public/language/languages.json'),excelJS=require(a0_0x1c2efc(0x23a)),xlsx=require(a0_0x1c2efc(0x230)),multer=require('multer');router['get'](a0_0x1c2efc(0x23c),auth,async(_0x1ba317,_0x5b1a59)=>{const _0x14c4ec=a0_0x1c2efc;try{const {username:_0x5a2540,email:_0x8be6d4,role:_0x55ea34}=_0x1ba317[_0x14c4ec(0x216)],_0xda67a1=_0x1ba317[_0x14c4ec(0x216)],_0x503747=await profile[_0x14c4ec(0x233)]({'email':_0xda67a1[_0x14c4ec(0x1e5)]}),_0x470771=await master_shop['find']();console[_0x14c4ec(0x203)](_0x14c4ec(0x24a),_0x470771);const _0x39c86e=await suppliers['find']();console[_0x14c4ec(0x203)](_0x39c86e);const _0xaf81a6=await suppliers[_0x14c4ec(0x1e9)]([{'$lookup':{'from':_0x14c4ec(0x212),'localField':_0x14c4ec(0x200),'foreignField':'suppliers','as':_0x14c4ec(0x23d)}}]),_0x5ac6b3=_0xaf81a6[_0x14c4ec(0x240)](_0x4f5aba=>{const _0x3b1a6b=_0x14c4ec;console[_0x3b1a6b(0x203)](_0x3b1a6b(0x1f8),_0x4f5aba);var _0x1fdc38=0x0,_0x51a482=0x0;return _0x4f5aba['suppliers_docs'][_0x3b1a6b(0x201)](_0x8b574a=>{const _0x29ecf5=_0x3b1a6b;console[_0x29ecf5(0x203)](_0x29ecf5(0x23e),_0x8b574a),_0x8b574a[_0x29ecf5(0x1f4)]==_0x29ecf5(0x21a)?_0x1fdc38+=_0x8b574a[_0x29ecf5(0x1fd)]:_0x51a482+=_0x8b574a[_0x29ecf5(0x1fd)];}),_0x4f5aba[_0x3b1a6b(0x22c)]=_0x1fdc38,_0x4f5aba[_0x3b1a6b(0x1f3)]=_0x51a482,_0x4f5aba;});console[_0x14c4ec(0x203)](_0x14c4ec(0x236),_0x5ac6b3);if(_0x470771[0x0][_0x14c4ec(0x1f0)]==_0x14c4ec(0x20c)){var _0x4acf5a=users[_0x14c4ec(0x22d)];console[_0x14c4ec(0x203)](_0x4acf5a);}else{if(_0x470771[0x0][_0x14c4ec(0x1f0)]==_0x14c4ec(0x238))var _0x4acf5a=users['Hindi'];else{if(_0x470771[0x0][_0x14c4ec(0x1f0)]==_0x14c4ec(0x1fc))var _0x4acf5a=users[_0x14c4ec(0x1fc)];else{if(_0x470771[0x0][_0x14c4ec(0x1f0)]=='Spanish')var _0x4acf5a=users[_0x14c4ec(0x20f)];else{if(_0x470771[0x0][_0x14c4ec(0x1f0)]==_0x14c4ec(0x22f))var _0x4acf5a=users[_0x14c4ec(0x22f)];else{if(_0x470771[0x0][_0x14c4ec(0x1f0)]==_0x14c4ec(0x1e8))var _0x4acf5a=users[_0x14c4ec(0x1eb)];else{if(_0x470771[0x0][_0x14c4ec(0x1f0)]=='Chinese')var _0x4acf5a=users[_0x14c4ec(0x234)];else{if(_0x470771[0x0]['language']==_0x14c4ec(0x202))var _0x4acf5a=users[_0x14c4ec(0x232)];}}}}}}}_0x5b1a59[_0x14c4ec(0x1ef)](_0x14c4ec(0x24c),{'success':_0x1ba317[_0x14c4ec(0x244)]('success'),'errors':_0x1ba317[_0x14c4ec(0x244)](_0x14c4ec(0x22b)),'user':_0x39c86e,'profile':_0x503747,'master_shop':_0x470771,'role':_0xda67a1,'payment':_0x5ac6b3,'language':_0x4acf5a});}catch(_0x26575a){console[_0x14c4ec(0x203)](_0x26575a);}}),router[a0_0x1c2efc(0x1ee)](a0_0x1c2efc(0x23c),auth,async(_0x250ae5,_0x3ac0c7)=>{const _0x1a5723=a0_0x1c2efc;try{const {name:_0x5e33cf,email:_0x185440,mobile:_0x49d157,company:_0x3d6acc,address:_0x47048d,receivable:_0x4dd160,payable:_0xaff88,code:_0x1962b1,contactperson:_0x38c87d,landline:_0x320173}=_0x250ae5[_0x1a5723(0x241)],_0x3031b3=new suppliers({'name':_0x5e33cf,'email':_0x185440,'mobile':_0x49d157,'company':_0x3d6acc,'address':_0x47048d,'receivable':_0x4dd160,'payable':_0xaff88,'suppliers_code':_0x1962b1,'contactperson':_0x38c87d,'landline':_0x320173}),_0x3dba21=await _0x3031b3['save']();_0x250ae5[_0x1a5723(0x244)](_0x1a5723(0x246),'supplier\x20data\x20add\x20successfully'),_0x3ac0c7[_0x1a5723(0x23b)](_0x1a5723(0x1ec));}catch(_0x4d1ebf){console[_0x1a5723(0x203)](_0x4d1ebf);}}),router[a0_0x1c2efc(0x242)]('/view/:id',auth,async(_0x2b000e,_0x1fb2a5)=>{const _0x25402b=a0_0x1c2efc;try{const {username:_0xfcfa51,email:_0x5cd386,role:_0x499389}=_0x2b000e[_0x25402b(0x216)],_0x25fa98=_0x2b000e[_0x25402b(0x216)],_0x5f5c61=await profile[_0x25402b(0x233)]({'email':_0x25fa98['email']}),_0x15acb8=await master_shop['find']();console['log'](_0x25402b(0x24a),_0x15acb8);const _0x15bd4a=_0x2b000e[_0x25402b(0x22a)]['id'],_0x494263=await suppliers[_0x25402b(0x214)](_0x15bd4a);console[_0x25402b(0x203)](_0x494263);if(_0x15acb8[0x0][_0x25402b(0x1f0)]==_0x25402b(0x20c)){var _0x537f93=users[_0x25402b(0x22d)];console[_0x25402b(0x203)](_0x537f93);}else{if(_0x15acb8[0x0][_0x25402b(0x1f0)]==_0x25402b(0x238))var _0x537f93=users['Hindi'];else{if(_0x15acb8[0x0][_0x25402b(0x1f0)]==_0x25402b(0x1fc))var _0x537f93=users[_0x25402b(0x1fc)];else{if(_0x15acb8[0x0][_0x25402b(0x1f0)]=='Spanish')var _0x537f93=users[_0x25402b(0x20f)];else{if(_0x15acb8[0x0][_0x25402b(0x1f0)]==_0x25402b(0x22f))var _0x537f93=users['French'];else{if(_0x15acb8[0x0][_0x25402b(0x1f0)]==_0x25402b(0x1e8))var _0x537f93=users['Portuguese'];else{if(_0x15acb8[0x0][_0x25402b(0x1f0)]==_0x25402b(0x234))var _0x537f93=users[_0x25402b(0x234)];else{if(_0x15acb8[0x0][_0x25402b(0x1f0)]==_0x25402b(0x202))var _0x537f93=users[_0x25402b(0x232)];}}}}}}}_0x1fb2a5[_0x25402b(0x1ef)](_0x25402b(0x24c),{'success':_0x2b000e[_0x25402b(0x244)](_0x25402b(0x246)),'errors':_0x2b000e['flash'](_0x25402b(0x22b)),'role':_0x25fa98,'profile':_0x5f5c61,'master_shop':_0x15acb8,'user':_0x494263,'language':_0x537f93});}catch(_0x458e49){console['log'](_0x458e49);}}),router['post']('/view/:id',auth,async(_0xe14cde,_0x132edd)=>{const _0x2c7d28=a0_0x1c2efc;try{const _0x7f41d3=_0xe14cde[_0x2c7d28(0x22a)]['id'],_0x5bdcca=await suppliers[_0x2c7d28(0x214)](_0x7f41d3),{name:_0x1a2d50,email:_0x2d175e,mobile:_0x3c581f,company:_0x1988d2,address:_0x2e1718,receivable:_0x5ea641,payable:_0xef52b2,code:_0xfbd822,contactperson:_0x18412e,landline:_0x41858e}=_0xe14cde[_0x2c7d28(0x241)];_0x5bdcca[_0x2c7d28(0x200)]=_0x1a2d50,_0x5bdcca[_0x2c7d28(0x1e5)]=_0x2d175e,_0x5bdcca[_0x2c7d28(0x213)]=_0x3c581f,_0x5bdcca[_0x2c7d28(0x248)]=_0x1988d2,_0x5bdcca[_0x2c7d28(0x209)]=_0x2e1718,_0x5bdcca[_0x2c7d28(0x207)]=_0x5ea641,_0x5bdcca['payable']=_0xef52b2,_0x5bdcca[_0x2c7d28(0x1fe)]=_0xfbd822,_0x5bdcca['contactperson']=_0x18412e,_0x5bdcca['landline']=_0x41858e;const _0x3fecbf=await _0x5bdcca['save']();_0xe14cde[_0x2c7d28(0x244)](_0x2c7d28(0x246),_0x2c7d28(0x205)),_0x132edd[_0x2c7d28(0x23b)](_0x2c7d28(0x1ec));}catch(_0x8a6dac){console[_0x2c7d28(0x203)](_0x8a6dac);}}),router['get'](a0_0x1c2efc(0x24b),auth,async(_0x39dc09,_0x202e89)=>{const _0x44ee8e=a0_0x1c2efc;try{const {username:_0x3b3a6e,email:_0x55448a,role:_0x1c4539}=_0x39dc09['user'],_0x2af7f8=_0x39dc09[_0x44ee8e(0x216)],_0x446ff3=await profile[_0x44ee8e(0x233)]({'email':_0x2af7f8[_0x44ee8e(0x1e5)]}),_0xf241dc=await master_shop[_0x44ee8e(0x229)]();console['log'](_0x44ee8e(0x24a),_0xf241dc),console[_0x44ee8e(0x203)](_0x39dc09['params']['id']);const _0x475565=await suppliers[_0x44ee8e(0x233)]({'_id':_0x39dc09[_0x44ee8e(0x22a)]['id']});console['log'](_0x475565);const _0x36ded9=await s_payment_data['find']({'suppliers':_0x475565[_0x44ee8e(0x200)]});console[_0x44ee8e(0x203)](_0x36ded9);const _0x1140d5=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x475565[_0x44ee8e(0x200)]}},{'$match':{'reason':_0x44ee8e(0x21a)}},{'$group':{'_id':_0x44ee8e(0x247),'sum':{'$sum':'$amount'}}}]);console[_0x44ee8e(0x203)](_0x44ee8e(0x22e),_0x1140d5);const _0x7a6cce=await s_payment_data[_0x44ee8e(0x1e9)]([{'$match':{'suppliers':_0x475565['name']}},{'$match':{'reason':_0x44ee8e(0x235)}},{'$group':{'_id':_0x44ee8e(0x247),'sum':{'$sum':_0x44ee8e(0x221)}}}]);console[_0x44ee8e(0x203)](_0x44ee8e(0x210),_0x7a6cce);if(_0xf241dc[0x0]['language']=='English\x20(US)'){var _0x52315f=users['English'];console[_0x44ee8e(0x203)](_0x52315f);}else{if(_0xf241dc[0x0][_0x44ee8e(0x1f0)]==_0x44ee8e(0x238))var _0x52315f=users['Hindi'];else{if(_0xf241dc[0x0][_0x44ee8e(0x1f0)]==_0x44ee8e(0x1fc))var _0x52315f=users['German'];else{if(_0xf241dc[0x0]['language']==_0x44ee8e(0x20f))var _0x52315f=users[_0x44ee8e(0x20f)];else{if(_0xf241dc[0x0][_0x44ee8e(0x1f0)]==_0x44ee8e(0x22f))var _0x52315f=users['French'];else{if(_0xf241dc[0x0][_0x44ee8e(0x1f0)]==_0x44ee8e(0x1e8))var _0x52315f=users[_0x44ee8e(0x1eb)];else{if(_0xf241dc[0x0][_0x44ee8e(0x1f0)]==_0x44ee8e(0x234))var _0x52315f=users[_0x44ee8e(0x234)];else{if(_0xf241dc[0x0]['language']=='Arabic\x20(ae)')var _0x52315f=users[_0x44ee8e(0x232)];}}}}}}}_0x202e89[_0x44ee8e(0x1ef)](_0x44ee8e(0x1ea),{'success':_0x39dc09[_0x44ee8e(0x244)](_0x44ee8e(0x246)),'errors':_0x39dc09[_0x44ee8e(0x244)]('errors'),'role':_0x2af7f8,'profile':_0x446ff3,'master_shop':_0xf241dc,'payment':_0x36ded9,'payable':_0x1140d5,'receivable':_0x7a6cce,'language':_0x52315f});}catch(_0x3530c1){console[_0x44ee8e(0x203)](_0x3530c1);}}),router[a0_0x1c2efc(0x242)](a0_0x1c2efc(0x1fb),auth,async(_0xf30cc1,_0x2aac4e)=>{const _0xec86c7=a0_0x1c2efc;try{const _0x29e4ec=new excelJS['Workbook'](),_0x5b549b=_0x29e4ec[_0xec86c7(0x1f2)]('Customers');return _0x5b549b[_0xec86c7(0x206)]=[{'header':'Name','key':'PBrands','width':0xa},{'header':_0xec86c7(0x1f5),'key':_0xec86c7(0x24d),'width':0xa},{'header':_0xec86c7(0x1fa),'key':_0xec86c7(0x20b),'width':0xa},{'header':_0xec86c7(0x24f),'key':'address','width':0xa},{'header':'Company_Name','key':_0xec86c7(0x213),'width':0xa},{'header':'address','key':_0xec86c7(0x1e5),'width':0xa}],_0x2aac4e[_0xec86c7(0x237)](_0xec86c7(0x1e7),_0xec86c7(0x231)),_0x2aac4e[_0xec86c7(0x237)](_0xec86c7(0x1ed),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x29e4ec[_0xec86c7(0x230)][_0xec86c7(0x225)](_0x2aac4e)[_0xec86c7(0x1ff)](()=>{const _0x140e5e=_0xec86c7;_0x2aac4e[_0x140e5e(0x21b)](0xc8);});}catch(_0x16168a){_0x2aac4e[_0xec86c7(0x21b)](0x190)['send']({'errors':_0x16168a['message']});}});const storage1=multer['diskStorage']({'destination':(_0x2db2a1,_0x457a23,_0x31202a)=>{const _0x3ab937=a0_0x1c2efc;_0x31202a(null,_0x3ab937(0x245));},'filename':(_0x235b79,_0x3b32a7,_0x294e41)=>{const _0x1cb4c7=a0_0x1c2efc;_0x294e41(null,Date['now']()+_0x3b32a7[_0x1cb4c7(0x223)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x1c2efc(0x222),auth,uploadMigrate[a0_0x1c2efc(0x21c)]('supplier_product_file'),async(_0x5e7c80,_0x233177)=>{const _0x2ae5c2=a0_0x1c2efc,_0x5743de=_0x5e7c80[_0x2ae5c2(0x23f)][_0x2ae5c2(0x228)],_0x524300=await xlsx[_0x2ae5c2(0x211)](_0x2ae5c2(0x21e)+_0x5743de);let _0x36b578=_0x524300[_0x2ae5c2(0x20d)],_0x5b5b19=xlsx[_0x2ae5c2(0x219)][_0x2ae5c2(0x1f1)](_0x524300['Sheets'][_0x36b578[0x0]]);for(const _0x510a49 of _0x5b5b19){const _0x1ff8bf=_0x510a49[_0x2ae5c2(0x220)],_0x9ce96d=_0x510a49[_0x2ae5c2(0x1f5)],_0x3fcacf=_0x510a49[_0x2ae5c2(0x209)],_0x33576b=_0x510a49['Mobile_number'],_0x8647fb=_0x510a49[_0x2ae5c2(0x1fa)],_0xf76ce2=_0x510a49[_0x2ae5c2(0x20a)];try{let _0x377d19=await suppliers[_0x2ae5c2(0x233)]({'name':_0x1ff8bf});if(!_0x377d19){const _0x511f33=new suppliers({'name':_0x1ff8bf,'suppliers_code':_0x9ce96d,'address':_0x3fcacf,'mobile':_0x33576b,'email':_0x8647fb,'company':_0xf76ce2});_0x377d19=await _0x511f33[_0x2ae5c2(0x208)](),_0x5e7c80[_0x2ae5c2(0x244)](_0x2ae5c2(0x246),_0x1ff8bf+_0x2ae5c2(0x217));}else _0x5e7c80[_0x2ae5c2(0x244)](_0x2ae5c2(0x226),_0x1ff8bf+_0x2ae5c2(0x24e));}catch(_0x14267b){_0x233177[_0x2ae5c2(0x21b)](0x1f4)['json']({'proderror':_0x14267b['message'],'aproduct':ProductName});}}_0x233177[_0x2ae5c2(0x23b)](_0x2ae5c2(0x1ec));}),module[a0_0x1c2efc(0x218)]=router;