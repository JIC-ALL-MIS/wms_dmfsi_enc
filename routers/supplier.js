const a0_0x223caa=a0_0x18ba;(function(_0x1bc36a,_0x32e331){const _0x282a6a=a0_0x18ba,_0x2415c9=_0x1bc36a();while(!![]){try{const _0x4697df=-parseInt(_0x282a6a(0x1b7))/0x1*(parseInt(_0x282a6a(0x1b4))/0x2)+-parseInt(_0x282a6a(0x1c8))/0x3+parseInt(_0x282a6a(0x164))/0x4+-parseInt(_0x282a6a(0x177))/0x5+parseInt(_0x282a6a(0x184))/0x6+parseInt(_0x282a6a(0x165))/0x7*(parseInt(_0x282a6a(0x1a3))/0x8)+-parseInt(_0x282a6a(0x173))/0x9;if(_0x4697df===_0x32e331)break;else _0x2415c9['push'](_0x2415c9['shift']());}catch(_0x22028a){_0x2415c9['push'](_0x2415c9['shift']());}}}(a0_0x1020,0x63220));function a0_0x18ba(_0x4abcb2,_0x14dc02){const _0x1020f0=a0_0x1020();return a0_0x18ba=function(_0x18bae4,_0x238350){_0x18bae4=_0x18bae4-0x15a;let _0x2f2622=_0x1020f0[_0x18bae4];return _0x2f2622;},a0_0x18ba(_0x4abcb2,_0x14dc02);}function a0_0x1020(){const _0x3d0b0a=['exports','addWorksheet','German','English','receivable','2XCpDBm','Arabic\x20(ae)','purchase_return','474497zKuDlB','Content-Type','flash','data','language','body','redirect','now','address','user','Customers','master','Portuguese','file','mobile','express','utils','247413iusapR','company','diskStorage','suppliers_docs','post','params','columns','send','email','SalesmanName','write','1416908BcRibT','14EgiLeE','../public/language/languages.json','Purchase','supplier\x20data\x20update\x20successfully','suppliers','../models/all_models','Name','\x20added\x20successfully','readFile','PUnits','errors','forEach','/view/payment/:id','/view/:id','850734BDFXgV','supplier_product_file','then','$amount','269160BNNvti','Spanish','aggregate','$reason','suppliers_code','render','../middleware/auth','supplier.js\x20payment_data','/supplier_import_migrate_file','log','SheetNames','success','find','658254UUvmUX','French','supplier_payment','setHeader','single','/supplier/view','amount','xlsx','Mobile_number','public/Migration','English\x20(US)','PBrands','exceljs','attachment;\x20filename=supplier_Migration_File.xlsx','status','findOne','Company_Name','originalname','Router','save','Purchase\x20Return','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','supplier','doc','\x20Failed','sheet_to_json','Arabic','message','Email','name','get','2589752emtXlK','receivable_sum','Chinese','Hindi','/products_export_migrate_file','Portuguese\x20(BR)','findById','reason','Supplier_Code','error','/view','multer'];a0_0x1020=function(){return _0x3d0b0a;};return a0_0x1020();}const express=require(a0_0x223caa(0x1c6)),app=express(),router=express[a0_0x223caa(0x196)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x223caa(0x16a)),auth=require(a0_0x223caa(0x17d)),users=require(a0_0x223caa(0x166)),excelJS=require(a0_0x223caa(0x190)),xlsx=require(a0_0x223caa(0x18b)),multer=require(a0_0x223caa(0x1ae));router['get'](a0_0x223caa(0x1ad),auth,async(_0x303cb9,_0x4228e8)=>{const _0x4d5516=a0_0x223caa;try{const {username:_0x1f4b86,email:_0x263714,role:_0x2a0fe4}=_0x303cb9[_0x4d5516(0x1c0)],_0x424db7=_0x303cb9[_0x4d5516(0x1c0)],_0x103365=await profile[_0x4d5516(0x193)]({'email':_0x424db7[_0x4d5516(0x161)]}),_0x125686=await master_shop[_0x4d5516(0x183)]();console['log'](_0x4d5516(0x1c2),_0x125686);const _0x1e6290=await suppliers[_0x4d5516(0x183)]();console['log'](_0x1e6290);const _0x247fe4=await suppliers['aggregate']([{'$lookup':{'from':'s_payments','localField':'name','foreignField':_0x4d5516(0x169),'as':_0x4d5516(0x15c)}}]),_0x46b08b=_0x247fe4['map'](_0xa9a100=>{const _0x3e4901=_0x4d5516;console['log'](_0x3e4901(0x1ba),_0xa9a100);var _0x125134=0x0,_0x8d7cd=0x0;return _0xa9a100[_0x3e4901(0x15c)][_0x3e4901(0x170)](_0x426c63=>{const _0x48157e=_0x3e4901;console[_0x48157e(0x180)](_0x48157e(0x19b),_0x426c63),_0x426c63[_0x48157e(0x1aa)]==_0x48157e(0x167)?_0x125134+=_0x426c63[_0x48157e(0x18a)]:_0x8d7cd+=_0x426c63[_0x48157e(0x18a)];}),_0xa9a100['purchase']=_0x125134,_0xa9a100[_0x3e4901(0x1b6)]=_0x8d7cd,_0xa9a100;});console[_0x4d5516(0x180)](_0x4d5516(0x17e),_0x46b08b);if(_0x125686[0x0][_0x4d5516(0x1bb)]=='English\x20(US)'){var _0x45ed27=users[_0x4d5516(0x1b2)];console[_0x4d5516(0x180)](_0x45ed27);}else{if(_0x125686[0x0][_0x4d5516(0x1bb)]==_0x4d5516(0x1a6))var _0x45ed27=users['Hindi'];else{if(_0x125686[0x0][_0x4d5516(0x1bb)]==_0x4d5516(0x1b1))var _0x45ed27=users[_0x4d5516(0x1b1)];else{if(_0x125686[0x0][_0x4d5516(0x1bb)]==_0x4d5516(0x178))var _0x45ed27=users[_0x4d5516(0x178)];else{if(_0x125686[0x0][_0x4d5516(0x1bb)]==_0x4d5516(0x185))var _0x45ed27=users[_0x4d5516(0x185)];else{if(_0x125686[0x0][_0x4d5516(0x1bb)]=='Portuguese\x20(BR)')var _0x45ed27=users[_0x4d5516(0x1c3)];else{if(_0x125686[0x0][_0x4d5516(0x1bb)]==_0x4d5516(0x1a5))var _0x45ed27=users[_0x4d5516(0x1a5)];else{if(_0x125686[0x0][_0x4d5516(0x1bb)]==_0x4d5516(0x1b5))var _0x45ed27=users['Arabic'];}}}}}}}_0x4228e8[_0x4d5516(0x17c)](_0x4d5516(0x19a),{'success':_0x303cb9[_0x4d5516(0x1b9)](_0x4d5516(0x182)),'errors':_0x303cb9[_0x4d5516(0x1b9)](_0x4d5516(0x16f)),'user':_0x1e6290,'profile':_0x103365,'master_shop':_0x125686,'role':_0x424db7,'payment':_0x46b08b,'language':_0x45ed27});}catch(_0x2e880d){console[_0x4d5516(0x180)](_0x2e880d);}}),router['post'](a0_0x223caa(0x1ad),auth,async(_0x152c69,_0x7df9a4)=>{const _0x1954d6=a0_0x223caa;try{const {name:_0x18fcdc,email:_0x22e714,mobile:_0x196c8c,company:_0x10d3d9,address:_0x3cbab4,receivable:_0x1253e1,payable:_0x46b082,code:_0x4f70c4,contactperson:_0x475642,landline:_0x483cfc}=_0x152c69[_0x1954d6(0x1bc)],_0x3549fb=new suppliers({'name':_0x18fcdc,'email':_0x22e714,'mobile':_0x196c8c,'company':_0x10d3d9,'address':_0x3cbab4,'receivable':_0x1253e1,'payable':_0x46b082,'suppliers_code':_0x4f70c4,'contactperson':_0x475642,'landline':_0x483cfc}),_0x1e7b48=await _0x3549fb[_0x1954d6(0x197)]();_0x152c69[_0x1954d6(0x1b9)](_0x1954d6(0x182),'supplier\x20data\x20add\x20successfully'),_0x7df9a4[_0x1954d6(0x1bd)](_0x1954d6(0x189));}catch(_0x4f14e5){console[_0x1954d6(0x180)](_0x4f14e5);}}),router[a0_0x223caa(0x1a2)](a0_0x223caa(0x172),auth,async(_0x19fac6,_0x39ae1a)=>{const _0x2075d2=a0_0x223caa;try{const {username:_0x13692a,email:_0x466c42,role:_0x1a347a}=_0x19fac6[_0x2075d2(0x1c0)],_0x2e8ee6=_0x19fac6[_0x2075d2(0x1c0)],_0x137df4=await profile[_0x2075d2(0x193)]({'email':_0x2e8ee6[_0x2075d2(0x161)]}),_0x195f23=await master_shop['find']();console[_0x2075d2(0x180)](_0x2075d2(0x1c2),_0x195f23);const _0x59b4e4=_0x19fac6[_0x2075d2(0x15e)]['id'],_0x4f0550=await suppliers[_0x2075d2(0x1a9)](_0x59b4e4);console[_0x2075d2(0x180)](_0x4f0550);if(_0x195f23[0x0]['language']==_0x2075d2(0x18e)){var _0x231e2a=users['English'];console[_0x2075d2(0x180)](_0x231e2a);}else{if(_0x195f23[0x0][_0x2075d2(0x1bb)]==_0x2075d2(0x1a6))var _0x231e2a=users['Hindi'];else{if(_0x195f23[0x0][_0x2075d2(0x1bb)]=='German')var _0x231e2a=users[_0x2075d2(0x1b1)];else{if(_0x195f23[0x0][_0x2075d2(0x1bb)]==_0x2075d2(0x178))var _0x231e2a=users[_0x2075d2(0x178)];else{if(_0x195f23[0x0][_0x2075d2(0x1bb)]==_0x2075d2(0x185))var _0x231e2a=users[_0x2075d2(0x185)];else{if(_0x195f23[0x0][_0x2075d2(0x1bb)]==_0x2075d2(0x1a8))var _0x231e2a=users['Portuguese'];else{if(_0x195f23[0x0]['language']==_0x2075d2(0x1a5))var _0x231e2a=users[_0x2075d2(0x1a5)];else{if(_0x195f23[0x0][_0x2075d2(0x1bb)]=='Arabic\x20(ae)')var _0x231e2a=users[_0x2075d2(0x19e)];}}}}}}}_0x39ae1a[_0x2075d2(0x17c)]('supplier',{'success':_0x19fac6[_0x2075d2(0x1b9)](_0x2075d2(0x182)),'errors':_0x19fac6[_0x2075d2(0x1b9)](_0x2075d2(0x16f)),'role':_0x2e8ee6,'profile':_0x137df4,'master_shop':_0x195f23,'user':_0x4f0550,'language':_0x231e2a});}catch(_0x1579a0){console[_0x2075d2(0x180)](_0x1579a0);}}),router[a0_0x223caa(0x15d)]('/view/:id',auth,async(_0x58f692,_0x54f858)=>{const _0x214186=a0_0x223caa;try{const _0xa6d997=_0x58f692[_0x214186(0x15e)]['id'],_0x7c7dd=await suppliers[_0x214186(0x1a9)](_0xa6d997),{name:_0x1906e2,email:_0x3c91b6,mobile:_0x4e4927,company:_0x1cf6ae,address:_0x33a57e,receivable:_0x2a54f9,payable:_0x4c74d9,code:_0x4e2376,contactperson:_0x4f7bd1,landline:_0x21981e}=_0x58f692[_0x214186(0x1bc)];_0x7c7dd[_0x214186(0x1a1)]=_0x1906e2,_0x7c7dd[_0x214186(0x161)]=_0x3c91b6,_0x7c7dd['mobile']=_0x4e4927,_0x7c7dd[_0x214186(0x15a)]=_0x1cf6ae,_0x7c7dd['address']=_0x33a57e,_0x7c7dd[_0x214186(0x1b3)]=_0x2a54f9,_0x7c7dd['payable']=_0x4c74d9,_0x7c7dd[_0x214186(0x17b)]=_0x4e2376,_0x7c7dd['contactperson']=_0x4f7bd1,_0x7c7dd['landline']=_0x21981e;const _0x7a6085=await _0x7c7dd[_0x214186(0x197)]();_0x58f692[_0x214186(0x1b9)](_0x214186(0x182),_0x214186(0x168)),_0x54f858[_0x214186(0x1bd)](_0x214186(0x189));}catch(_0x10d3a7){console[_0x214186(0x180)](_0x10d3a7);}}),router[a0_0x223caa(0x1a2)](a0_0x223caa(0x171),auth,async(_0x2c8fc7,_0x101224)=>{const _0x15e6a1=a0_0x223caa;try{const {username:_0x2d9d54,email:_0x38db0b,role:_0x4ab889}=_0x2c8fc7[_0x15e6a1(0x1c0)],_0x349153=_0x2c8fc7[_0x15e6a1(0x1c0)],_0x4ca8ad=await profile[_0x15e6a1(0x193)]({'email':_0x349153[_0x15e6a1(0x161)]}),_0x5ea014=await master_shop[_0x15e6a1(0x183)]();console[_0x15e6a1(0x180)](_0x15e6a1(0x1c2),_0x5ea014),console[_0x15e6a1(0x180)](_0x2c8fc7[_0x15e6a1(0x15e)]['id']);const _0x12531b=await suppliers[_0x15e6a1(0x193)]({'_id':_0x2c8fc7['params']['id']});console[_0x15e6a1(0x180)](_0x12531b);const _0x18fbba=await s_payment_data[_0x15e6a1(0x183)]({'suppliers':_0x12531b[_0x15e6a1(0x1a1)]});console[_0x15e6a1(0x180)](_0x18fbba);const _0x4e5d3b=await s_payment_data[_0x15e6a1(0x179)]([{'$match':{'suppliers':_0x12531b[_0x15e6a1(0x1a1)]}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x15e6a1(0x176)}}}]);console['log']('payable_sum',_0x4e5d3b);const _0x469106=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x12531b[_0x15e6a1(0x1a1)]}},{'$match':{'reason':_0x15e6a1(0x198)}},{'$group':{'_id':_0x15e6a1(0x17a),'sum':{'$sum':_0x15e6a1(0x176)}}}]);console['log'](_0x15e6a1(0x1a4),_0x469106);if(_0x5ea014[0x0]['language']==_0x15e6a1(0x18e)){var _0x3e4d3c=users[_0x15e6a1(0x1b2)];console[_0x15e6a1(0x180)](_0x3e4d3c);}else{if(_0x5ea014[0x0][_0x15e6a1(0x1bb)]==_0x15e6a1(0x1a6))var _0x3e4d3c=users[_0x15e6a1(0x1a6)];else{if(_0x5ea014[0x0][_0x15e6a1(0x1bb)]==_0x15e6a1(0x1b1))var _0x3e4d3c=users['German'];else{if(_0x5ea014[0x0][_0x15e6a1(0x1bb)]==_0x15e6a1(0x178))var _0x3e4d3c=users[_0x15e6a1(0x178)];else{if(_0x5ea014[0x0][_0x15e6a1(0x1bb)]==_0x15e6a1(0x185))var _0x3e4d3c=users['French'];else{if(_0x5ea014[0x0][_0x15e6a1(0x1bb)]=='Portuguese\x20(BR)')var _0x3e4d3c=users[_0x15e6a1(0x1c3)];else{if(_0x5ea014[0x0][_0x15e6a1(0x1bb)]==_0x15e6a1(0x1a5))var _0x3e4d3c=users['Chinese'];else{if(_0x5ea014[0x0]['language']==_0x15e6a1(0x1b5))var _0x3e4d3c=users[_0x15e6a1(0x19e)];}}}}}}}_0x101224[_0x15e6a1(0x17c)](_0x15e6a1(0x186),{'success':_0x2c8fc7[_0x15e6a1(0x1b9)](_0x15e6a1(0x182)),'errors':_0x2c8fc7[_0x15e6a1(0x1b9)](_0x15e6a1(0x16f)),'role':_0x349153,'profile':_0x4ca8ad,'master_shop':_0x5ea014,'payment':_0x18fbba,'payable':_0x4e5d3b,'receivable':_0x469106,'language':_0x3e4d3c});}catch(_0x51d114){console[_0x15e6a1(0x180)](_0x51d114);}}),router[a0_0x223caa(0x1a2)](a0_0x223caa(0x1a7),auth,async(_0x5f0cc8,_0x58978c)=>{const _0xa8d2d0=a0_0x223caa;try{const _0x5bc3e0=new excelJS['Workbook'](),_0x14e82a=_0x5bc3e0[_0xa8d2d0(0x1b0)](_0xa8d2d0(0x1c1));return _0x14e82a[_0xa8d2d0(0x15f)]=[{'header':'Name','key':_0xa8d2d0(0x18f),'width':0xa},{'header':'Supplier_Code','key':_0xa8d2d0(0x16e),'width':0xa},{'header':_0xa8d2d0(0x1a0),'key':_0xa8d2d0(0x162),'width':0xa},{'header':_0xa8d2d0(0x18c),'key':_0xa8d2d0(0x1bf),'width':0xa},{'header':_0xa8d2d0(0x194),'key':_0xa8d2d0(0x1c5),'width':0xa},{'header':'address','key':_0xa8d2d0(0x161),'width':0xa}],_0x58978c[_0xa8d2d0(0x187)](_0xa8d2d0(0x1b8),_0xa8d2d0(0x199)),_0x58978c[_0xa8d2d0(0x187)]('Content-Disposition',_0xa8d2d0(0x191)),_0x5bc3e0[_0xa8d2d0(0x18b)][_0xa8d2d0(0x163)](_0x58978c)[_0xa8d2d0(0x175)](()=>{const _0x41281c=_0xa8d2d0;_0x58978c[_0x41281c(0x192)](0xc8);});}catch(_0x25d9fa){_0x58978c['status'](0x190)[_0xa8d2d0(0x160)]({'errors':_0x25d9fa[_0xa8d2d0(0x19f)]});}});const storage1=multer[a0_0x223caa(0x15b)]({'destination':(_0x24ca12,_0x1ead99,_0x31e4cf)=>{const _0x577503=a0_0x223caa;_0x31e4cf(null,_0x577503(0x18d));},'filename':(_0x2c5aca,_0x574c7e,_0xc5e99b)=>{const _0x5d20e6=a0_0x223caa;_0xc5e99b(null,Date[_0x5d20e6(0x1be)]()+_0x574c7e[_0x5d20e6(0x195)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x223caa(0x17f),auth,uploadMigrate[a0_0x223caa(0x188)](a0_0x223caa(0x174)),async(_0x11f26b,_0x19b038)=>{const _0x216fb0=a0_0x223caa,_0x455cfc=_0x11f26b[_0x216fb0(0x1c4)]['filename'],_0x13ec1e=await xlsx[_0x216fb0(0x16d)]('public/Migration/'+_0x455cfc);let _0x18d1ce=_0x13ec1e[_0x216fb0(0x181)],_0x2129a=xlsx[_0x216fb0(0x1c7)][_0x216fb0(0x19d)](_0x13ec1e['Sheets'][_0x18d1ce[0x0]]);for(const _0x623819 of _0x2129a){const _0x3e216f=_0x623819[_0x216fb0(0x16b)],_0x1b28e3=_0x623819[_0x216fb0(0x1ab)],_0x436915=_0x623819['address'],_0x35d624=_0x623819[_0x216fb0(0x18c)],_0x1797da=_0x623819[_0x216fb0(0x1a0)],_0x3282b0=_0x623819[_0x216fb0(0x194)];try{let _0x4713bd=await suppliers[_0x216fb0(0x193)]({'name':_0x3e216f});if(!_0x4713bd){const _0xeba6e5=new suppliers({'name':_0x3e216f,'suppliers_code':_0x1b28e3,'address':_0x436915,'mobile':_0x35d624,'email':_0x1797da,'company':_0x3282b0});_0x4713bd=await _0xeba6e5[_0x216fb0(0x197)](),_0x11f26b[_0x216fb0(0x1b9)](_0x216fb0(0x182),_0x3e216f+_0x216fb0(0x16c));}else _0x11f26b['flash'](_0x216fb0(0x1ac),_0x3e216f+_0x216fb0(0x19c));}catch(_0x277c5c){_0x19b038[_0x216fb0(0x192)](0x1f4)['json']({'proderror':_0x277c5c[_0x216fb0(0x19f)],'aproduct':ProductName});}}_0x19b038[_0x216fb0(0x1bd)](_0x216fb0(0x189));}),module[a0_0x223caa(0x1af)]=router;