const a0_0x4c8e82=a0_0x27a8;(function(_0x1b402d,_0x13beb4){const _0x4f323f=a0_0x27a8,_0x5ebae2=_0x1b402d();while(!![]){try{const _0x27e580=parseInt(_0x4f323f(0x1f8))/0x1+-parseInt(_0x4f323f(0x1ef))/0x2+parseInt(_0x4f323f(0x1f6))/0x3+-parseInt(_0x4f323f(0x1fb))/0x4+parseInt(_0x4f323f(0x1e9))/0x5+-parseInt(_0x4f323f(0x22e))/0x6*(parseInt(_0x4f323f(0x1d5))/0x7)+parseInt(_0x4f323f(0x220))/0x8;if(_0x27e580===_0x13beb4)break;else _0x5ebae2['push'](_0x5ebae2['shift']());}catch(_0x1f909a){_0x5ebae2['push'](_0x5ebae2['shift']());}}}(a0_0x14f0,0x4ba10));const express=require('express'),app=express(),router=express[a0_0x4c8e82(0x222)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x4c8e82(0x230)),auth=require('../middleware/auth'),users=require(a0_0x4c8e82(0x1e0)),excelJS=require('exceljs'),xlsx=require('xlsx'),multer=require(a0_0x4c8e82(0x21a));function a0_0x14f0(){const _0x4656dc=['/supplier/view','SalesmanName','payable_sum','success','/view/payment/:id','send','Purchase\x20Return','doc','amount','Portuguese\x20(BR)','errors','user','\x20Failed','Company_Name','suppliers_docs','address','message','multer','Name','\x20added\x20successfully','readFile','Portuguese','attachment;\x20filename=supplier_Migration_File.xlsx','4589376KcIDVK','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Router','json','post','flash','German','company','get','payable','supplier','Arabic\x20(ae)','Workbook','English\x20(US)','30IMWJhR','Supplier_Code','../models/all_models','exports','supplier\x20data\x20update\x20successfully','error','Purchase','render','mobile','Mobile_number','Hindi','401527PDXXxu','findOne','English','Content-Disposition','forEach','receivable','supplier_payment','sheet_to_json','params','setHeader','redirect','../public/language/languages.json','contactperson','aggregate','French','Spanish','language','map','write','body','127220IBhBtU','name','$amount','$reason','find','PUnits','1005674jRiUCr','/view','then','Chinese','SheetNames','Sheets','master','1254105TXJPke','Email','472062PvbSur','Arabic','filename','1559180xjjgXm','reason','/view/:id','s_payments','email','save','log','xlsx','purchase_return','status','findById','landline','now','originalname'];a0_0x14f0=function(){return _0x4656dc;};return a0_0x14f0();}function a0_0x27a8(_0x7fc6c2,_0x48343d){const _0x14f059=a0_0x14f0();return a0_0x27a8=function(_0x27a8c9,_0x31800a){_0x27a8c9=_0x27a8c9-0x1ce;let _0x47e7ec=_0x14f059[_0x27a8c9];return _0x47e7ec;},a0_0x27a8(_0x7fc6c2,_0x48343d);}router['get'](a0_0x4c8e82(0x1f0),auth,async(_0x33ec78,_0x38223b)=>{const _0x59bc86=a0_0x4c8e82;try{const {username:_0x28da54,email:_0x52f617,role:_0x25f9be}=_0x33ec78[_0x59bc86(0x214)],_0x590385=_0x33ec78[_0x59bc86(0x214)],_0x26adfc=await profile[_0x59bc86(0x1d6)]({'email':_0x590385[_0x59bc86(0x1ff)]}),_0xabaf2d=await master_shop[_0x59bc86(0x1ed)]();console[_0x59bc86(0x201)](_0x59bc86(0x1f5),_0xabaf2d);const _0x1d59da=await suppliers[_0x59bc86(0x1ed)]();console['log'](_0x1d59da);const _0x241c0b=await suppliers[_0x59bc86(0x1e2)]([{'$lookup':{'from':_0x59bc86(0x1fe),'localField':_0x59bc86(0x1ea),'foreignField':'suppliers','as':_0x59bc86(0x217)}}]),_0x1e8799=_0x241c0b[_0x59bc86(0x1e6)](_0x1e0a0d=>{const _0x48066d=_0x59bc86;console[_0x48066d(0x201)]('data',_0x1e0a0d);var _0x2611f8=0x0,_0x560a3c=0x0;return _0x1e0a0d['suppliers_docs'][_0x48066d(0x1d9)](_0x1760a0=>{const _0x23cfd8=_0x48066d;console[_0x23cfd8(0x201)](_0x23cfd8(0x210),_0x1760a0),_0x1760a0[_0x23cfd8(0x1fc)]==_0x23cfd8(0x1d0)?_0x2611f8+=_0x1760a0[_0x23cfd8(0x211)]:_0x560a3c+=_0x1760a0[_0x23cfd8(0x211)];}),_0x1e0a0d['purchase']=_0x2611f8,_0x1e0a0d[_0x48066d(0x203)]=_0x560a3c,_0x1e0a0d;});console[_0x59bc86(0x201)]('supplier.js\x20payment_data',_0x1e8799);if(_0xabaf2d[0x0]['language']==_0x59bc86(0x22d)){var _0x5509fe=users[_0x59bc86(0x1d7)];console[_0x59bc86(0x201)](_0x5509fe);}else{if(_0xabaf2d[0x0][_0x59bc86(0x1e5)]=='Hindi')var _0x5509fe=users[_0x59bc86(0x1d4)];else{if(_0xabaf2d[0x0]['language']==_0x59bc86(0x226))var _0x5509fe=users[_0x59bc86(0x226)];else{if(_0xabaf2d[0x0][_0x59bc86(0x1e5)]==_0x59bc86(0x1e4))var _0x5509fe=users['Spanish'];else{if(_0xabaf2d[0x0][_0x59bc86(0x1e5)]=='French')var _0x5509fe=users['French'];else{if(_0xabaf2d[0x0][_0x59bc86(0x1e5)]==_0x59bc86(0x212))var _0x5509fe=users['Portuguese'];else{if(_0xabaf2d[0x0][_0x59bc86(0x1e5)]==_0x59bc86(0x1f2))var _0x5509fe=users[_0x59bc86(0x1f2)];else{if(_0xabaf2d[0x0]['language']==_0x59bc86(0x22b))var _0x5509fe=users['Arabic'];}}}}}}}_0x38223b[_0x59bc86(0x1d1)](_0x59bc86(0x22a),{'success':_0x33ec78[_0x59bc86(0x225)](_0x59bc86(0x20c)),'errors':_0x33ec78[_0x59bc86(0x225)](_0x59bc86(0x213)),'user':_0x1d59da,'profile':_0x26adfc,'master_shop':_0xabaf2d,'role':_0x590385,'payment':_0x1e8799,'language':_0x5509fe});}catch(_0xc10c0){console[_0x59bc86(0x201)](_0xc10c0);}}),router[a0_0x4c8e82(0x224)](a0_0x4c8e82(0x1f0),auth,async(_0x2f1cb0,_0x7c2775)=>{const _0x2154f0=a0_0x4c8e82;try{const {name:_0x16ac4b,email:_0x174edb,mobile:_0x567d17,company:_0x1ea7b6,address:_0x4a7b2b,receivable:_0x534e3f,payable:_0x4b8fe4,code:_0x1b1423,contactperson:_0x281841,landline:_0x412169}=_0x2f1cb0[_0x2154f0(0x1e8)],_0x10fd61=new suppliers({'name':_0x16ac4b,'email':_0x174edb,'mobile':_0x567d17,'company':_0x1ea7b6,'address':_0x4a7b2b,'receivable':_0x534e3f,'payable':_0x4b8fe4,'suppliers_code':_0x1b1423,'contactperson':_0x281841,'landline':_0x412169}),_0x13f412=await _0x10fd61['save']();_0x2f1cb0['flash'](_0x2154f0(0x20c),'supplier\x20data\x20add\x20successfully'),_0x7c2775[_0x2154f0(0x1df)]('/supplier/view');}catch(_0x243ed2){console['log'](_0x243ed2);}}),router[a0_0x4c8e82(0x228)]('/view/:id',auth,async(_0x827af7,_0x555ff6)=>{const _0x9ab131=a0_0x4c8e82;try{const {username:_0x29d741,email:_0x286316,role:_0x42e629}=_0x827af7[_0x9ab131(0x214)],_0x1ae686=_0x827af7[_0x9ab131(0x214)],_0x3ed3c5=await profile[_0x9ab131(0x1d6)]({'email':_0x1ae686[_0x9ab131(0x1ff)]}),_0x1e7bfb=await master_shop[_0x9ab131(0x1ed)]();console[_0x9ab131(0x201)](_0x9ab131(0x1f5),_0x1e7bfb);const _0x1db04c=_0x827af7['params']['id'],_0x1dfee8=await suppliers[_0x9ab131(0x205)](_0x1db04c);console['log'](_0x1dfee8);if(_0x1e7bfb[0x0]['language']==_0x9ab131(0x22d)){var _0x6b172=users[_0x9ab131(0x1d7)];console[_0x9ab131(0x201)](_0x6b172);}else{if(_0x1e7bfb[0x0][_0x9ab131(0x1e5)]==_0x9ab131(0x1d4))var _0x6b172=users[_0x9ab131(0x1d4)];else{if(_0x1e7bfb[0x0][_0x9ab131(0x1e5)]==_0x9ab131(0x226))var _0x6b172=users[_0x9ab131(0x226)];else{if(_0x1e7bfb[0x0][_0x9ab131(0x1e5)]==_0x9ab131(0x1e4))var _0x6b172=users[_0x9ab131(0x1e4)];else{if(_0x1e7bfb[0x0][_0x9ab131(0x1e5)]==_0x9ab131(0x1e3))var _0x6b172=users['French'];else{if(_0x1e7bfb[0x0][_0x9ab131(0x1e5)]==_0x9ab131(0x212))var _0x6b172=users[_0x9ab131(0x21e)];else{if(_0x1e7bfb[0x0][_0x9ab131(0x1e5)]==_0x9ab131(0x1f2))var _0x6b172=users[_0x9ab131(0x1f2)];else{if(_0x1e7bfb[0x0]['language']==_0x9ab131(0x22b))var _0x6b172=users[_0x9ab131(0x1f9)];}}}}}}}_0x555ff6[_0x9ab131(0x1d1)](_0x9ab131(0x22a),{'success':_0x827af7['flash']('success'),'errors':_0x827af7[_0x9ab131(0x225)](_0x9ab131(0x213)),'role':_0x1ae686,'profile':_0x3ed3c5,'master_shop':_0x1e7bfb,'user':_0x1dfee8,'language':_0x6b172});}catch(_0x552e1b){console['log'](_0x552e1b);}}),router[a0_0x4c8e82(0x224)](a0_0x4c8e82(0x1fd),auth,async(_0x520e4e,_0x9bf4d9)=>{const _0x413525=a0_0x4c8e82;try{const _0x8fa7fc=_0x520e4e[_0x413525(0x1dd)]['id'],_0x53ded2=await suppliers['findById'](_0x8fa7fc),{name:_0x1e8260,email:_0x503a4e,mobile:_0x417383,company:_0x9d4bb3,address:_0x216cd5,receivable:_0x406d9a,payable:_0x364b23,code:_0x58bb9c,contactperson:_0x13173e,landline:_0x4379f9}=_0x520e4e[_0x413525(0x1e8)];_0x53ded2[_0x413525(0x1ea)]=_0x1e8260,_0x53ded2['email']=_0x503a4e,_0x53ded2[_0x413525(0x1d2)]=_0x417383,_0x53ded2[_0x413525(0x227)]=_0x9d4bb3,_0x53ded2[_0x413525(0x218)]=_0x216cd5,_0x53ded2[_0x413525(0x1da)]=_0x406d9a,_0x53ded2[_0x413525(0x229)]=_0x364b23,_0x53ded2['suppliers_code']=_0x58bb9c,_0x53ded2[_0x413525(0x1e1)]=_0x13173e,_0x53ded2[_0x413525(0x206)]=_0x4379f9;const _0x37a411=await _0x53ded2[_0x413525(0x200)]();_0x520e4e[_0x413525(0x225)](_0x413525(0x20c),_0x413525(0x1ce)),_0x9bf4d9[_0x413525(0x1df)](_0x413525(0x209));}catch(_0x465b03){console[_0x413525(0x201)](_0x465b03);}}),router[a0_0x4c8e82(0x228)](a0_0x4c8e82(0x20d),auth,async(_0xdbc20c,_0x55622e)=>{const _0x2de146=a0_0x4c8e82;try{const {username:_0x3394ac,email:_0x1996d8,role:_0x462ac1}=_0xdbc20c[_0x2de146(0x214)],_0x41b47c=_0xdbc20c[_0x2de146(0x214)],_0x296037=await profile[_0x2de146(0x1d6)]({'email':_0x41b47c['email']}),_0x3d2cf1=await master_shop['find']();console[_0x2de146(0x201)](_0x2de146(0x1f5),_0x3d2cf1),console[_0x2de146(0x201)](_0xdbc20c[_0x2de146(0x1dd)]['id']);const _0x242f6e=await suppliers[_0x2de146(0x1d6)]({'_id':_0xdbc20c['params']['id']});console[_0x2de146(0x201)](_0x242f6e);const _0x3b9881=await s_payment_data['find']({'suppliers':_0x242f6e['name']});console['log'](_0x3b9881);const _0x492da1=await s_payment_data[_0x2de146(0x1e2)]([{'$match':{'suppliers':_0x242f6e['name']}},{'$match':{'reason':_0x2de146(0x1d0)}},{'$group':{'_id':_0x2de146(0x1ec),'sum':{'$sum':_0x2de146(0x1eb)}}}]);console[_0x2de146(0x201)](_0x2de146(0x20b),_0x492da1);const _0x3824cf=await s_payment_data[_0x2de146(0x1e2)]([{'$match':{'suppliers':_0x242f6e[_0x2de146(0x1ea)]}},{'$match':{'reason':_0x2de146(0x20f)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x2de146(0x201)]('receivable_sum',_0x3824cf);if(_0x3d2cf1[0x0][_0x2de146(0x1e5)]==_0x2de146(0x22d)){var _0x54e7f0=users[_0x2de146(0x1d7)];console[_0x2de146(0x201)](_0x54e7f0);}else{if(_0x3d2cf1[0x0][_0x2de146(0x1e5)]==_0x2de146(0x1d4))var _0x54e7f0=users[_0x2de146(0x1d4)];else{if(_0x3d2cf1[0x0]['language']==_0x2de146(0x226))var _0x54e7f0=users[_0x2de146(0x226)];else{if(_0x3d2cf1[0x0][_0x2de146(0x1e5)]=='Spanish')var _0x54e7f0=users['Spanish'];else{if(_0x3d2cf1[0x0][_0x2de146(0x1e5)]=='French')var _0x54e7f0=users[_0x2de146(0x1e3)];else{if(_0x3d2cf1[0x0][_0x2de146(0x1e5)]=='Portuguese\x20(BR)')var _0x54e7f0=users[_0x2de146(0x21e)];else{if(_0x3d2cf1[0x0][_0x2de146(0x1e5)]==_0x2de146(0x1f2))var _0x54e7f0=users[_0x2de146(0x1f2)];else{if(_0x3d2cf1[0x0][_0x2de146(0x1e5)]=='Arabic\x20(ae)')var _0x54e7f0=users[_0x2de146(0x1f9)];}}}}}}}_0x55622e[_0x2de146(0x1d1)](_0x2de146(0x1db),{'success':_0xdbc20c[_0x2de146(0x225)]('success'),'errors':_0xdbc20c[_0x2de146(0x225)](_0x2de146(0x213)),'role':_0x41b47c,'profile':_0x296037,'master_shop':_0x3d2cf1,'payment':_0x3b9881,'payable':_0x492da1,'receivable':_0x3824cf,'language':_0x54e7f0});}catch(_0x22ce6b){console['log'](_0x22ce6b);}}),router[a0_0x4c8e82(0x228)]('/products_export_migrate_file',auth,async(_0x1669b2,_0x346eb3)=>{const _0x11def2=a0_0x4c8e82;try{const _0x394242=new excelJS[(_0x11def2(0x22c))](),_0x294911=_0x394242['addWorksheet']('Customers');return _0x294911['columns']=[{'header':'Name','key':'PBrands','width':0xa},{'header':_0x11def2(0x22f),'key':_0x11def2(0x1ee),'width':0xa},{'header':_0x11def2(0x1f7),'key':_0x11def2(0x20a),'width':0xa},{'header':_0x11def2(0x1d3),'key':_0x11def2(0x218),'width':0xa},{'header':_0x11def2(0x216),'key':_0x11def2(0x1d2),'width':0xa},{'header':_0x11def2(0x218),'key':_0x11def2(0x1ff),'width':0xa}],_0x346eb3[_0x11def2(0x1de)]('Content-Type',_0x11def2(0x221)),_0x346eb3['setHeader'](_0x11def2(0x1d8),_0x11def2(0x21f)),_0x394242[_0x11def2(0x202)][_0x11def2(0x1e7)](_0x346eb3)[_0x11def2(0x1f1)](()=>{const _0x44e369=_0x11def2;_0x346eb3[_0x44e369(0x204)](0xc8);});}catch(_0x1524d4){_0x346eb3['status'](0x190)[_0x11def2(0x20e)]({'errors':_0x1524d4[_0x11def2(0x219)]});}});const storage1=multer['diskStorage']({'destination':(_0x5537c3,_0x27551b,_0x2c0aa6)=>{_0x2c0aa6(null,'public/Migration');},'filename':(_0x2d8cce,_0x48ed19,_0x22c214)=>{const _0x19a1cf=a0_0x4c8e82;_0x22c214(null,Date[_0x19a1cf(0x207)]()+_0x48ed19[_0x19a1cf(0x208)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x4c8e82(0x224)]('/supplier_import_migrate_file',auth,uploadMigrate['single']('supplier_product_file'),async(_0x36efbe,_0x36cc4c)=>{const _0x26c9a5=a0_0x4c8e82,_0x49f3f8=_0x36efbe['file'][_0x26c9a5(0x1fa)],_0x4fea3a=await xlsx[_0x26c9a5(0x21d)]('public/Migration/'+_0x49f3f8);let _0x35ce7c=_0x4fea3a[_0x26c9a5(0x1f3)],_0x5eac17=xlsx['utils'][_0x26c9a5(0x1dc)](_0x4fea3a[_0x26c9a5(0x1f4)][_0x35ce7c[0x0]]);for(const _0x1db44b of _0x5eac17){const _0x13462a=_0x1db44b[_0x26c9a5(0x21b)],_0x2f042b=_0x1db44b[_0x26c9a5(0x22f)],_0x39cd2c=_0x1db44b['address'],_0x1df43d=_0x1db44b[_0x26c9a5(0x1d3)],_0x21ba81=_0x1db44b[_0x26c9a5(0x1f7)],_0x2ea377=_0x1db44b[_0x26c9a5(0x216)];try{let _0x4dc247=await suppliers[_0x26c9a5(0x1d6)]({'name':_0x13462a});if(!_0x4dc247){const _0x345c6f=new suppliers({'name':_0x13462a,'suppliers_code':_0x2f042b,'address':_0x39cd2c,'mobile':_0x1df43d,'email':_0x21ba81,'company':_0x2ea377});_0x4dc247=await _0x345c6f[_0x26c9a5(0x200)](),_0x36efbe[_0x26c9a5(0x225)]('success',_0x13462a+_0x26c9a5(0x21c));}else _0x36efbe['flash'](_0x26c9a5(0x1cf),_0x13462a+_0x26c9a5(0x215));}catch(_0x12d438){_0x36cc4c[_0x26c9a5(0x204)](0x1f4)[_0x26c9a5(0x223)]({'proderror':_0x12d438['message'],'aproduct':ProductName});}}_0x36cc4c[_0x26c9a5(0x1df)]('/supplier/view');}),module[a0_0x4c8e82(0x231)]=router;