const a0_0x46dbd3=a0_0x6203;function a0_0x6203(_0x5e835f,_0x306053){const _0x5a9b66=a0_0x5a9b();return a0_0x6203=function(_0x6203ed,_0x419c9b){_0x6203ed=_0x6203ed-0x18c;let _0x216efd=_0x5a9b66[_0x6203ed];return _0x216efd;},a0_0x6203(_0x5e835f,_0x306053);}(function(_0x58988f,_0x2c44d1){const _0x20adf6=a0_0x6203,_0x5d4d31=_0x58988f();while(!![]){try{const _0xf4d528=parseInt(_0x20adf6(0x1b6))/0x1*(-parseInt(_0x20adf6(0x1c1))/0x2)+parseInt(_0x20adf6(0x1ae))/0x3+-parseInt(_0x20adf6(0x196))/0x4+-parseInt(_0x20adf6(0x1d6))/0x5*(parseInt(_0x20adf6(0x1d9))/0x6)+-parseInt(_0x20adf6(0x1b9))/0x7*(-parseInt(_0x20adf6(0x1b4))/0x8)+-parseInt(_0x20adf6(0x18c))/0x9+parseInt(_0x20adf6(0x1aa))/0xa*(parseInt(_0x20adf6(0x1b0))/0xb);if(_0xf4d528===_0x2c44d1)break;else _0x5d4d31['push'](_0x5d4d31['shift']());}catch(_0x3f550b){_0x5d4d31['push'](_0x5d4d31['shift']());}}}(a0_0x5a9b,0x5d804));const express=require(a0_0x46dbd3(0x19b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x46dbd3(0x1d3)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x46dbd3(0x192)),xlsx=require(a0_0x46dbd3(0x1e9)),multer=require(a0_0x46dbd3(0x1d7));router[a0_0x46dbd3(0x1dd)](a0_0x46dbd3(0x1bd),auth,async(_0x3c8615,_0x540de8)=>{const _0x62fb6=a0_0x46dbd3;try{const {username:_0xbbd58a,email:_0x35e006,role:_0x43a234}=_0x3c8615[_0x62fb6(0x1ca)],_0x58a558=_0x3c8615[_0x62fb6(0x1ca)],_0x16138d=await profile[_0x62fb6(0x1f2)]({'email':_0x58a558[_0x62fb6(0x1b1)]}),_0x49e726=await master_shop[_0x62fb6(0x1db)]();console[_0x62fb6(0x1d4)](_0x62fb6(0x1b2),_0x49e726);const _0x56f94b=await suppliers['find']();console['log'](_0x56f94b);const _0x165e88=await suppliers[_0x62fb6(0x1ba)]([{'$lookup':{'from':'s_payments','localField':'name','foreignField':'suppliers','as':_0x62fb6(0x19f)}}]),_0x22a56d=_0x165e88[_0x62fb6(0x1a4)](_0x4114e0=>{const _0x39ddb0=_0x62fb6;console[_0x39ddb0(0x1d4)](_0x39ddb0(0x1b8),_0x4114e0);var _0x4adef6=0x0,_0x3cbd8e=0x0;return _0x4114e0[_0x39ddb0(0x19f)]['forEach'](_0x2f7e12=>{const _0x5ad57b=_0x39ddb0;console[_0x5ad57b(0x1d4)](_0x5ad57b(0x19a),_0x2f7e12),_0x2f7e12[_0x5ad57b(0x1cb)]==_0x5ad57b(0x1e1)?_0x4adef6+=_0x2f7e12[_0x5ad57b(0x197)]:_0x3cbd8e+=_0x2f7e12['amount'];}),_0x4114e0[_0x39ddb0(0x1d8)]=_0x4adef6,_0x4114e0['purchase_return']=_0x3cbd8e,_0x4114e0;});console[_0x62fb6(0x1d4)](_0x62fb6(0x1e2),_0x22a56d);if(_0x49e726[0x0][_0x62fb6(0x1c0)]==_0x62fb6(0x1ef)){var _0x3e0eba=users[_0x62fb6(0x1ee)];console[_0x62fb6(0x1d4)](_0x3e0eba);}else{if(_0x49e726[0x0][_0x62fb6(0x1c0)]=='Hindi')var _0x3e0eba=users['Hindi'];else{if(_0x49e726[0x0][_0x62fb6(0x1c0)]=='German')var _0x3e0eba=users[_0x62fb6(0x1a6)];else{if(_0x49e726[0x0][_0x62fb6(0x1c0)]=='Spanish')var _0x3e0eba=users[_0x62fb6(0x1ab)];else{if(_0x49e726[0x0]['language']==_0x62fb6(0x1cd))var _0x3e0eba=users[_0x62fb6(0x1cd)];else{if(_0x49e726[0x0][_0x62fb6(0x1c0)]==_0x62fb6(0x1f0))var _0x3e0eba=users[_0x62fb6(0x18e)];else{if(_0x49e726[0x0][_0x62fb6(0x1c0)]==_0x62fb6(0x1bc))var _0x3e0eba=users['Chinese'];else{if(_0x49e726[0x0][_0x62fb6(0x1c0)]==_0x62fb6(0x1a2))var _0x3e0eba=users['Arabic'];}}}}}}}_0x540de8[_0x62fb6(0x1da)](_0x62fb6(0x1e5),{'success':_0x3c8615[_0x62fb6(0x198)](_0x62fb6(0x1a9)),'errors':_0x3c8615[_0x62fb6(0x198)](_0x62fb6(0x1a3)),'user':_0x56f94b,'profile':_0x16138d,'master_shop':_0x49e726,'role':_0x58a558,'payment':_0x22a56d,'language':_0x3e0eba});}catch(_0x40e52b){console[_0x62fb6(0x1d4)](_0x40e52b);}}),router['post'](a0_0x46dbd3(0x1bd),auth,async(_0x94fbea,_0x34c366)=>{const _0x188a0a=a0_0x46dbd3;try{const {name:_0x468abf,email:_0x4708c4,mobile:_0x4ef10e,company:_0x1e402e,address:_0x2ed220,receivable:_0x4827f7,payable:_0x1a122d,code:_0x1dbe41,contactperson:_0x3c58cf,landline:_0x30f54d}=_0x94fbea[_0x188a0a(0x1ac)],_0x46304e=new suppliers({'name':_0x468abf,'email':_0x4708c4,'mobile':_0x4ef10e,'company':_0x1e402e,'address':_0x2ed220,'receivable':_0x4827f7,'payable':_0x1a122d,'suppliers_code':_0x1dbe41,'contactperson':_0x3c58cf,'landline':_0x30f54d}),_0x50abed=await _0x46304e['save']();_0x94fbea[_0x188a0a(0x198)](_0x188a0a(0x1a9),_0x188a0a(0x19d)),_0x34c366[_0x188a0a(0x1ed)](_0x188a0a(0x1e4));}catch(_0x5b8885){console[_0x188a0a(0x1d4)](_0x5b8885);}}),router['get'](a0_0x46dbd3(0x1ad),auth,async(_0x391645,_0x13f88a)=>{const _0x6dc94c=a0_0x46dbd3;try{const {username:_0x28a674,email:_0x2ede1a,role:_0x51caeb}=_0x391645[_0x6dc94c(0x1ca)],_0x2f1f8c=_0x391645[_0x6dc94c(0x1ca)],_0x1247ba=await profile[_0x6dc94c(0x1f2)]({'email':_0x2f1f8c[_0x6dc94c(0x1b1)]}),_0x26a9f0=await master_shop[_0x6dc94c(0x1db)]();console[_0x6dc94c(0x1d4)](_0x6dc94c(0x1b2),_0x26a9f0);const _0x14289f=_0x391645[_0x6dc94c(0x1a7)]['id'],_0x4a1efa=await suppliers[_0x6dc94c(0x1c9)](_0x14289f);console[_0x6dc94c(0x1d4)](_0x4a1efa);if(_0x26a9f0[0x0][_0x6dc94c(0x1c0)]==_0x6dc94c(0x1ef)){var _0x4c8aad=users[_0x6dc94c(0x1ee)];console[_0x6dc94c(0x1d4)](_0x4c8aad);}else{if(_0x26a9f0[0x0][_0x6dc94c(0x1c0)]==_0x6dc94c(0x1b3))var _0x4c8aad=users[_0x6dc94c(0x1b3)];else{if(_0x26a9f0[0x0]['language']==_0x6dc94c(0x1a6))var _0x4c8aad=users[_0x6dc94c(0x1a6)];else{if(_0x26a9f0[0x0]['language']==_0x6dc94c(0x1ab))var _0x4c8aad=users[_0x6dc94c(0x1ab)];else{if(_0x26a9f0[0x0]['language']==_0x6dc94c(0x1cd))var _0x4c8aad=users[_0x6dc94c(0x1cd)];else{if(_0x26a9f0[0x0][_0x6dc94c(0x1c0)]==_0x6dc94c(0x1f0))var _0x4c8aad=users[_0x6dc94c(0x18e)];else{if(_0x26a9f0[0x0][_0x6dc94c(0x1c0)]==_0x6dc94c(0x1bc))var _0x4c8aad=users[_0x6dc94c(0x1bc)];else{if(_0x26a9f0[0x0][_0x6dc94c(0x1c0)]==_0x6dc94c(0x1a2))var _0x4c8aad=users[_0x6dc94c(0x1e7)];}}}}}}}_0x13f88a[_0x6dc94c(0x1da)]('supplier',{'success':_0x391645[_0x6dc94c(0x198)](_0x6dc94c(0x1a9)),'errors':_0x391645[_0x6dc94c(0x198)]('errors'),'role':_0x2f1f8c,'profile':_0x1247ba,'master_shop':_0x26a9f0,'user':_0x4a1efa,'language':_0x4c8aad});}catch(_0x43bf81){console[_0x6dc94c(0x1d4)](_0x43bf81);}}),router[a0_0x46dbd3(0x1bb)](a0_0x46dbd3(0x1ad),auth,async(_0x4888c8,_0x3bff39)=>{const _0xb41b96=a0_0x46dbd3;try{const _0x2fb9ce=_0x4888c8[_0xb41b96(0x1a7)]['id'],_0x3ac159=await suppliers['findById'](_0x2fb9ce),{name:_0x1a501f,email:_0x4897b8,mobile:_0x5d1953,company:_0x5f33df,address:_0x3d2fb7,receivable:_0x1a09b9,payable:_0x403961,code:_0x18a299,contactperson:_0x31582e,landline:_0x41078d}=_0x4888c8[_0xb41b96(0x1ac)];_0x3ac159[_0xb41b96(0x191)]=_0x1a501f,_0x3ac159[_0xb41b96(0x1b1)]=_0x4897b8,_0x3ac159[_0xb41b96(0x18f)]=_0x5d1953,_0x3ac159[_0xb41b96(0x1c4)]=_0x5f33df,_0x3ac159[_0xb41b96(0x195)]=_0x3d2fb7,_0x3ac159[_0xb41b96(0x1e8)]=_0x1a09b9,_0x3ac159[_0xb41b96(0x19e)]=_0x403961,_0x3ac159['suppliers_code']=_0x18a299,_0x3ac159[_0xb41b96(0x19c)]=_0x31582e,_0x3ac159[_0xb41b96(0x1d2)]=_0x41078d;const _0x443e78=await _0x3ac159[_0xb41b96(0x1dc)]();_0x4888c8[_0xb41b96(0x198)](_0xb41b96(0x1a9),_0xb41b96(0x1d1)),_0x3bff39[_0xb41b96(0x1ed)]('/supplier/view');}catch(_0x2a66e5){console[_0xb41b96(0x1d4)](_0x2a66e5);}}),router[a0_0x46dbd3(0x1dd)](a0_0x46dbd3(0x193),auth,async(_0x53a5ee,_0x550b96)=>{const _0x27039a=a0_0x46dbd3;try{const {username:_0x297d91,email:_0x583b16,role:_0x1735cf}=_0x53a5ee[_0x27039a(0x1ca)],_0x183e3d=_0x53a5ee[_0x27039a(0x1ca)],_0x35ed3e=await profile['findOne']({'email':_0x183e3d[_0x27039a(0x1b1)]}),_0x41175a=await master_shop['find']();console[_0x27039a(0x1d4)](_0x27039a(0x1b2),_0x41175a),console[_0x27039a(0x1d4)](_0x53a5ee['params']['id']);const _0x14ea77=await suppliers[_0x27039a(0x1f2)]({'_id':_0x53a5ee[_0x27039a(0x1a7)]['id']});console[_0x27039a(0x1d4)](_0x14ea77);const _0x42acc0=await s_payment_data[_0x27039a(0x1db)]({'suppliers':_0x14ea77[_0x27039a(0x191)]});console[_0x27039a(0x1d4)](_0x42acc0);const _0x3ba12a=await s_payment_data[_0x27039a(0x1ba)]([{'$match':{'suppliers':_0x14ea77[_0x27039a(0x191)]}},{'$match':{'reason':_0x27039a(0x1e1)}},{'$group':{'_id':_0x27039a(0x1a8),'sum':{'$sum':'$amount'}}}]);console['log'](_0x27039a(0x1a1),_0x3ba12a);const _0x7185ca=await s_payment_data[_0x27039a(0x1ba)]([{'$match':{'suppliers':_0x14ea77[_0x27039a(0x191)]}},{'$match':{'reason':_0x27039a(0x1c3)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x27039a(0x1d4)](_0x27039a(0x1c5),_0x7185ca);if(_0x41175a[0x0][_0x27039a(0x1c0)]==_0x27039a(0x1ef)){var _0x469517=users[_0x27039a(0x1ee)];console[_0x27039a(0x1d4)](_0x469517);}else{if(_0x41175a[0x0]['language']==_0x27039a(0x1b3))var _0x469517=users[_0x27039a(0x1b3)];else{if(_0x41175a[0x0][_0x27039a(0x1c0)]=='German')var _0x469517=users[_0x27039a(0x1a6)];else{if(_0x41175a[0x0][_0x27039a(0x1c0)]==_0x27039a(0x1ab))var _0x469517=users['Spanish'];else{if(_0x41175a[0x0][_0x27039a(0x1c0)]==_0x27039a(0x1cd))var _0x469517=users[_0x27039a(0x1cd)];else{if(_0x41175a[0x0][_0x27039a(0x1c0)]=='Portuguese\x20(BR)')var _0x469517=users[_0x27039a(0x18e)];else{if(_0x41175a[0x0][_0x27039a(0x1c0)]==_0x27039a(0x1bc))var _0x469517=users[_0x27039a(0x1bc)];else{if(_0x41175a[0x0][_0x27039a(0x1c0)]==_0x27039a(0x1a2))var _0x469517=users[_0x27039a(0x1e7)];}}}}}}}_0x550b96[_0x27039a(0x1da)]('supplier_payment',{'success':_0x53a5ee[_0x27039a(0x198)](_0x27039a(0x1a9)),'errors':_0x53a5ee['flash'](_0x27039a(0x1a3)),'role':_0x183e3d,'profile':_0x35ed3e,'master_shop':_0x41175a,'payment':_0x42acc0,'payable':_0x3ba12a,'receivable':_0x7185ca,'language':_0x469517});}catch(_0x1a26d4){console[_0x27039a(0x1d4)](_0x1a26d4);}}),router[a0_0x46dbd3(0x1dd)]('/products_export_migrate_file',auth,async(_0x46cc21,_0x31c14e)=>{const _0x528fb8=a0_0x46dbd3;try{const _0x57ba28=new excelJS[(_0x528fb8(0x1c2))](),_0x54d5d2=_0x57ba28['addWorksheet']('Customers');return _0x54d5d2[_0x528fb8(0x18d)]=[{'header':_0x528fb8(0x190),'key':'PBrands','width':0xa},{'header':_0x528fb8(0x1e0),'key':'PUnits','width':0xa},{'header':'Email','key':_0x528fb8(0x1af),'width':0xa},{'header':_0x528fb8(0x1d5),'key':_0x528fb8(0x195),'width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':_0x528fb8(0x195),'key':_0x528fb8(0x1b1),'width':0xa}],_0x31c14e['setHeader'](_0x528fb8(0x1c8),_0x528fb8(0x1eb)),_0x31c14e[_0x528fb8(0x1cf)](_0x528fb8(0x1e3),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x57ba28[_0x528fb8(0x1e9)]['write'](_0x31c14e)[_0x528fb8(0x1ea)](()=>{const _0x3a80d9=_0x528fb8;_0x31c14e[_0x3a80d9(0x1b7)](0xc8);});}catch(_0x3a9147){_0x31c14e[_0x528fb8(0x1b7)](0x190)[_0x528fb8(0x1a5)]({'errors':_0x3a9147['message']});}});const storage1=multer['diskStorage']({'destination':(_0x43f8a5,_0x3fa9ec,_0x49f7f7)=>{const _0x4d2df9=a0_0x46dbd3;_0x49f7f7(null,_0x4d2df9(0x1be));},'filename':(_0x2a31a3,_0x38dc3c,_0x518d00)=>{const _0x3a2f27=a0_0x46dbd3;_0x518d00(null,Date[_0x3a2f27(0x1a0)]()+_0x38dc3c[_0x3a2f27(0x1c7)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x46dbd3(0x1bb)](a0_0x46dbd3(0x1f1),auth,uploadMigrate['single'](a0_0x46dbd3(0x1d0)),async(_0x563d96,_0x5adf34)=>{const _0x75f56b=a0_0x46dbd3,_0x208c1d=_0x563d96[_0x75f56b(0x199)]['filename'],_0x253e5f=await xlsx[_0x75f56b(0x1cc)](_0x75f56b(0x1c6)+_0x208c1d);let _0x53108d=_0x253e5f['SheetNames'],_0x37d054=xlsx[_0x75f56b(0x194)][_0x75f56b(0x1df)](_0x253e5f[_0x75f56b(0x1e6)][_0x53108d[0x0]]);for(const _0x2209b2 of _0x37d054){const _0x2b47c2=_0x2209b2[_0x75f56b(0x190)],_0x5b53e8=_0x2209b2[_0x75f56b(0x1e0)],_0x232cf1=_0x2209b2[_0x75f56b(0x195)],_0x4660f8=_0x2209b2[_0x75f56b(0x1d5)],_0x233ad0=_0x2209b2[_0x75f56b(0x1de)],_0xf5931d=_0x2209b2[_0x75f56b(0x1ec)];try{let _0x2b8ed4=await suppliers['findOne']({'name':_0x2b47c2});if(!_0x2b8ed4){const _0x451996=new suppliers({'name':_0x2b47c2,'suppliers_code':_0x5b53e8,'address':_0x232cf1,'mobile':_0x4660f8,'email':_0x233ad0,'company':_0xf5931d});_0x2b8ed4=await _0x451996[_0x75f56b(0x1dc)](),_0x563d96[_0x75f56b(0x198)](_0x75f56b(0x1a9),_0x2b47c2+_0x75f56b(0x1f3));}else _0x563d96[_0x75f56b(0x198)](_0x75f56b(0x1b5),_0x2b47c2+_0x75f56b(0x1ce));}catch(_0x394206){_0x5adf34['status'](0x1f4)['json']({'proderror':_0x394206['message'],'aproduct':ProductName});}}_0x5adf34[_0x75f56b(0x1ed)]('/supplier/view');}),module[a0_0x46dbd3(0x1bf)]=router;function a0_0x5a9b(){const _0x298c26=['express','contactperson','supplier\x20data\x20add\x20successfully','payable','suppliers_docs','now','payable_sum','Arabic\x20(ae)','errors','map','send','German','params','$reason','success','327070bitNmE','Spanish','body','/view/:id','1498428afpLRV','SalesmanName','374WaKvNt','email','master','Hindi','1295752cgLqXy','error','384555uHURqn','status','data','7NrfKBQ','aggregate','post','Chinese','/view','public/Migration','exports','language','2JmcPAQ','Workbook','Purchase\x20Return','company','receivable_sum','public/Migration/','originalname','Content-Type','findById','user','reason','readFile','French','\x20Failed','setHeader','supplier_product_file','supplier\x20data\x20update\x20successfully','landline','../models/all_models','log','Mobile_number','20lljiRC','multer','purchase','537144EpzSpm','render','find','save','get','Email','sheet_to_json','Supplier_Code','Purchase','supplier.js\x20payment_data','Content-Disposition','/supplier/view','supplier','Sheets','Arabic','receivable','xlsx','then','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Company_Name','redirect','English','English\x20(US)','Portuguese\x20(BR)','/supplier_import_migrate_file','findOne','\x20added\x20successfully','211329MAsuTT','columns','Portuguese','mobile','Name','name','exceljs','/view/payment/:id','utils','address','2497484bgsLxS','amount','flash','file','doc'];a0_0x5a9b=function(){return _0x298c26;};return a0_0x5a9b();}