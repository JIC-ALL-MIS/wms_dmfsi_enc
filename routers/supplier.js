const a0_0x46b754=a0_0x1534;(function(_0x368632,_0x5dd050){const _0x17762f=a0_0x1534,_0x250b44=_0x368632();while(!![]){try{const _0x161f55=parseInt(_0x17762f(0x243))/0x1+parseInt(_0x17762f(0x233))/0x2*(parseInt(_0x17762f(0x232))/0x3)+-parseInt(_0x17762f(0x202))/0x4*(-parseInt(_0x17762f(0x239))/0x5)+-parseInt(_0x17762f(0x23d))/0x6+-parseInt(_0x17762f(0x205))/0x7+-parseInt(_0x17762f(0x204))/0x8*(parseInt(_0x17762f(0x240))/0x9)+parseInt(_0x17762f(0x21f))/0xa;if(_0x161f55===_0x5dd050)break;else _0x250b44['push'](_0x250b44['shift']());}catch(_0x134dd3){_0x250b44['push'](_0x250b44['shift']());}}}(a0_0x4074,0xcf4da));const express=require(a0_0x46b754(0x248)),app=express(),router=express[a0_0x46b754(0x230)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x46b754(0x250)),excelJS=require(a0_0x46b754(0x21b)),xlsx=require(a0_0x46b754(0x216)),multer=require('multer');function a0_0x1534(_0x344153,_0x4888b4){const _0x407428=a0_0x4074();return a0_0x1534=function(_0x1534dc,_0x2333c2){_0x1534dc=_0x1534dc-0x1e6;let _0x53866a=_0x407428[_0x1534dc];return _0x53866a;},a0_0x1534(_0x344153,_0x4888b4);}router[a0_0x46b754(0x22d)]('/view',auth,async(_0x2b1223,_0x54ed19)=>{const _0xb029df=a0_0x46b754;try{const {username:_0x3710fc,email:_0x101589,role:_0x39bbff}=_0x2b1223[_0xb029df(0x210)],_0x2e050e=_0x2b1223[_0xb029df(0x210)],_0x161570=await profile[_0xb029df(0x24f)]({'email':_0x2e050e[_0xb029df(0x1f8)]}),_0x207951=await master_shop[_0xb029df(0x244)]();console[_0xb029df(0x222)]('master',_0x207951);const _0x51b3a6=await suppliers['find']();console[_0xb029df(0x222)](_0x51b3a6);const _0x4ebbe5=await suppliers[_0xb029df(0x238)]([{'$lookup':{'from':_0xb029df(0x1f6),'localField':_0xb029df(0x23c),'foreignField':_0xb029df(0x201),'as':_0xb029df(0x213)}}]),_0x2dc9be=_0x4ebbe5[_0xb029df(0x236)](_0x35a3cf=>{const _0x62842a=_0xb029df;console[_0x62842a(0x222)](_0x62842a(0x224),_0x35a3cf);var _0x2ffe18=0x0,_0x5566ac=0x0;return _0x35a3cf['suppliers_docs'][_0x62842a(0x1e9)](_0x4cd278=>{const _0x4da2c9=_0x62842a;console['log'](_0x4da2c9(0x1e7),_0x4cd278),_0x4cd278['reason']==_0x4da2c9(0x1fe)?_0x2ffe18+=_0x4cd278[_0x4da2c9(0x235)]:_0x5566ac+=_0x4cd278[_0x4da2c9(0x235)];}),_0x35a3cf[_0x62842a(0x20b)]=_0x2ffe18,_0x35a3cf[_0x62842a(0x234)]=_0x5566ac,_0x35a3cf;});console[_0xb029df(0x222)](_0xb029df(0x1ec),_0x2dc9be);if(_0x207951[0x0][_0xb029df(0x22c)]==_0xb029df(0x252)){var _0x4b8260=users[_0xb029df(0x1fb)];console['log'](_0x4b8260);}else{if(_0x207951[0x0][_0xb029df(0x22c)]==_0xb029df(0x1ef))var _0x4b8260=users[_0xb029df(0x1ef)];else{if(_0x207951[0x0][_0xb029df(0x22c)]=='German')var _0x4b8260=users[_0xb029df(0x245)];else{if(_0x207951[0x0][_0xb029df(0x22c)]==_0xb029df(0x21c))var _0x4b8260=users[_0xb029df(0x21c)];else{if(_0x207951[0x0]['language']==_0xb029df(0x241))var _0x4b8260=users[_0xb029df(0x241)];else{if(_0x207951[0x0][_0xb029df(0x22c)]==_0xb029df(0x1f0))var _0x4b8260=users[_0xb029df(0x1f4)];else{if(_0x207951[0x0]['language']=='Chinese')var _0x4b8260=users[_0xb029df(0x251)];else{if(_0x207951[0x0][_0xb029df(0x22c)]==_0xb029df(0x20a))var _0x4b8260=users[_0xb029df(0x223)];}}}}}}}_0x54ed19['render'](_0xb029df(0x24a),{'success':_0x2b1223['flash']('success'),'errors':_0x2b1223[_0xb029df(0x212)](_0xb029df(0x228)),'user':_0x51b3a6,'profile':_0x161570,'master_shop':_0x207951,'role':_0x2e050e,'payment':_0x2dc9be,'language':_0x4b8260});}catch(_0x5d5f40){console[_0xb029df(0x222)](_0x5d5f40);}}),router[a0_0x46b754(0x1ea)](a0_0x46b754(0x249),auth,async(_0x5e295c,_0x35acf1)=>{const _0x21878a=a0_0x46b754;try{const {name:_0x46fa70,email:_0x375a49,mobile:_0xb29563,company:_0x2991db,address:_0x385109,receivable:_0x1e56ab,payable:_0x2d390c,code:_0x51bdfd,contactperson:_0x26a44f,landline:_0x2c4252}=_0x5e295c[_0x21878a(0x227)],_0x102c9b=new suppliers({'name':_0x46fa70,'email':_0x375a49,'mobile':_0xb29563,'company':_0x2991db,'address':_0x385109,'receivable':_0x1e56ab,'payable':_0x2d390c,'suppliers_code':_0x51bdfd,'contactperson':_0x26a44f,'landline':_0x2c4252}),_0x2cc00b=await _0x102c9b[_0x21878a(0x23e)]();_0x5e295c[_0x21878a(0x212)](_0x21878a(0x20d),'supplier\x20data\x20add\x20successfully'),_0x35acf1['redirect']('/supplier/view');}catch(_0x4eebc2){console[_0x21878a(0x222)](_0x4eebc2);}}),router[a0_0x46b754(0x22d)](a0_0x46b754(0x207),auth,async(_0x47e93c,_0x55c2f9)=>{const _0x578fe9=a0_0x46b754;try{const {username:_0xaf0725,email:_0x234304,role:_0x3b810f}=_0x47e93c[_0x578fe9(0x210)],_0x4b350b=_0x47e93c[_0x578fe9(0x210)],_0x3f49cd=await profile['findOne']({'email':_0x4b350b[_0x578fe9(0x1f8)]}),_0x468a35=await master_shop[_0x578fe9(0x244)]();console[_0x578fe9(0x222)](_0x578fe9(0x22a),_0x468a35);const _0x539ef5=_0x47e93c[_0x578fe9(0x208)]['id'],_0x13a0af=await suppliers[_0x578fe9(0x218)](_0x539ef5);console[_0x578fe9(0x222)](_0x13a0af);if(_0x468a35[0x0][_0x578fe9(0x22c)]==_0x578fe9(0x252)){var _0x40cc14=users[_0x578fe9(0x1fb)];console['log'](_0x40cc14);}else{if(_0x468a35[0x0]['language']=='Hindi')var _0x40cc14=users[_0x578fe9(0x1ef)];else{if(_0x468a35[0x0]['language']==_0x578fe9(0x245))var _0x40cc14=users[_0x578fe9(0x245)];else{if(_0x468a35[0x0][_0x578fe9(0x22c)]==_0x578fe9(0x21c))var _0x40cc14=users[_0x578fe9(0x21c)];else{if(_0x468a35[0x0][_0x578fe9(0x22c)]==_0x578fe9(0x241))var _0x40cc14=users['French'];else{if(_0x468a35[0x0][_0x578fe9(0x22c)]=='Portuguese\x20(BR)')var _0x40cc14=users[_0x578fe9(0x1f4)];else{if(_0x468a35[0x0]['language']==_0x578fe9(0x251))var _0x40cc14=users[_0x578fe9(0x251)];else{if(_0x468a35[0x0][_0x578fe9(0x22c)]==_0x578fe9(0x20a))var _0x40cc14=users[_0x578fe9(0x223)];}}}}}}}_0x55c2f9[_0x578fe9(0x203)](_0x578fe9(0x24a),{'success':_0x47e93c[_0x578fe9(0x212)](_0x578fe9(0x20d)),'errors':_0x47e93c[_0x578fe9(0x212)]('errors'),'role':_0x4b350b,'profile':_0x3f49cd,'master_shop':_0x468a35,'user':_0x13a0af,'language':_0x40cc14});}catch(_0x2dbec5){console[_0x578fe9(0x222)](_0x2dbec5);}}),router[a0_0x46b754(0x1ea)](a0_0x46b754(0x207),auth,async(_0x2a47ff,_0x2e866b)=>{const _0x4c8823=a0_0x46b754;try{const _0x1defc1=_0x2a47ff['params']['id'],_0x32b69b=await suppliers[_0x4c8823(0x218)](_0x1defc1),{name:_0x378386,email:_0x416d95,mobile:_0x12d932,company:_0x3952f8,address:_0x40f84e,receivable:_0x1e3428,payable:_0x122de1,code:_0x5ab105,contactperson:_0x48b8ae,landline:_0x325787}=_0x2a47ff[_0x4c8823(0x227)];_0x32b69b['name']=_0x378386,_0x32b69b[_0x4c8823(0x1f8)]=_0x416d95,_0x32b69b[_0x4c8823(0x1fc)]=_0x12d932,_0x32b69b['company']=_0x3952f8,_0x32b69b['address']=_0x40f84e,_0x32b69b['receivable']=_0x1e3428,_0x32b69b[_0x4c8823(0x1fd)]=_0x122de1,_0x32b69b[_0x4c8823(0x20f)]=_0x5ab105,_0x32b69b['contactperson']=_0x48b8ae,_0x32b69b['landline']=_0x325787;const _0x596504=await _0x32b69b[_0x4c8823(0x23e)]();_0x2a47ff[_0x4c8823(0x212)](_0x4c8823(0x20d),_0x4c8823(0x211)),_0x2e866b[_0x4c8823(0x23f)](_0x4c8823(0x221));}catch(_0x37c640){console[_0x4c8823(0x222)](_0x37c640);}}),router[a0_0x46b754(0x22d)](a0_0x46b754(0x1f7),auth,async(_0x392c9d,_0x311988)=>{const _0x135ad7=a0_0x46b754;try{const {username:_0x49936c,email:_0x35bf43,role:_0x48b710}=_0x392c9d['user'],_0x15fdbe=_0x392c9d['user'],_0x244de5=await profile[_0x135ad7(0x24f)]({'email':_0x15fdbe['email']}),_0xb99ed8=await master_shop[_0x135ad7(0x244)]();console[_0x135ad7(0x222)](_0x135ad7(0x22a),_0xb99ed8),console['log'](_0x392c9d['params']['id']);const _0x19d371=await suppliers[_0x135ad7(0x24f)]({'_id':_0x392c9d[_0x135ad7(0x208)]['id']});console[_0x135ad7(0x222)](_0x19d371);const _0x465353=await s_payment_data['find']({'suppliers':_0x19d371[_0x135ad7(0x23c)]});console['log'](_0x465353);const _0x358224=await s_payment_data[_0x135ad7(0x238)]([{'$match':{'suppliers':_0x19d371[_0x135ad7(0x23c)]}},{'$match':{'reason':_0x135ad7(0x1fe)}},{'$group':{'_id':_0x135ad7(0x229),'sum':{'$sum':'$amount'}}}]);console['log'](_0x135ad7(0x1f1),_0x358224);const _0x432f65=await s_payment_data[_0x135ad7(0x238)]([{'$match':{'suppliers':_0x19d371[_0x135ad7(0x23c)]}},{'$match':{'reason':_0x135ad7(0x206)}},{'$group':{'_id':_0x135ad7(0x229),'sum':{'$sum':'$amount'}}}]);console['log'](_0x135ad7(0x1ff),_0x432f65);if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x252)){var _0x50eef4=users[_0x135ad7(0x1fb)];console[_0x135ad7(0x222)](_0x50eef4);}else{if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x1ef))var _0x50eef4=users[_0x135ad7(0x1ef)];else{if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x245))var _0x50eef4=users[_0x135ad7(0x245)];else{if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x21c))var _0x50eef4=users[_0x135ad7(0x21c)];else{if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x241))var _0x50eef4=users[_0x135ad7(0x241)];else{if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x1f0))var _0x50eef4=users['Portuguese'];else{if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x251))var _0x50eef4=users[_0x135ad7(0x251)];else{if(_0xb99ed8[0x0][_0x135ad7(0x22c)]==_0x135ad7(0x20a))var _0x50eef4=users['Arabic'];}}}}}}}_0x311988[_0x135ad7(0x203)]('supplier_payment',{'success':_0x392c9d[_0x135ad7(0x212)](_0x135ad7(0x20d)),'errors':_0x392c9d[_0x135ad7(0x212)](_0x135ad7(0x228)),'role':_0x15fdbe,'profile':_0x244de5,'master_shop':_0xb99ed8,'payment':_0x465353,'payable':_0x358224,'receivable':_0x432f65,'language':_0x50eef4});}catch(_0x2453d9){console[_0x135ad7(0x222)](_0x2453d9);}}),router['get'](a0_0x46b754(0x226),auth,async(_0x33340e,_0x44b2f5)=>{const _0x579e20=a0_0x46b754;try{const _0x3a965c=new excelJS['Workbook'](),_0x4edb47=_0x3a965c[_0x579e20(0x209)](_0x579e20(0x246));return _0x4edb47[_0x579e20(0x24e)]=[{'header':_0x579e20(0x24c),'key':_0x579e20(0x21d),'width':0xa},{'header':_0x579e20(0x214),'key':'PUnits','width':0xa},{'header':'Email','key':'SalesmanName','width':0xa},{'header':_0x579e20(0x23b),'key':_0x579e20(0x1e8),'width':0xa},{'header':'Company_Name','key':_0x579e20(0x1fc),'width':0xa},{'header':_0x579e20(0x1e8),'key':'email','width':0xa}],_0x44b2f5[_0x579e20(0x237)](_0x579e20(0x247),_0x579e20(0x21e)),_0x44b2f5[_0x579e20(0x237)](_0x579e20(0x1fa),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x3a965c[_0x579e20(0x216)][_0x579e20(0x20e)](_0x44b2f5)[_0x579e20(0x225)](()=>{const _0xa61bdf=_0x579e20;_0x44b2f5[_0xa61bdf(0x215)](0xc8);});}catch(_0x4aa399){_0x44b2f5[_0x579e20(0x215)](0x190)[_0x579e20(0x217)]({'errors':_0x4aa399[_0x579e20(0x20c)]});}});const storage1=multer[a0_0x46b754(0x23a)]({'destination':(_0x3b1563,_0x3a0a04,_0x3ec8db)=>{const _0x1766a2=a0_0x46b754;_0x3ec8db(null,_0x1766a2(0x22b));},'filename':(_0x54a3d0,_0x50ccb9,_0x3383c7)=>{const _0x145f7b=a0_0x46b754;_0x3383c7(null,Date[_0x145f7b(0x1ed)]()+_0x50ccb9[_0x145f7b(0x1f9)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x46b754(0x22e),auth,uploadMigrate[a0_0x46b754(0x1f3)](a0_0x46b754(0x22f)),async(_0x12dd11,_0x4f5f56)=>{const _0x199cbd=a0_0x46b754,_0x1aebd4=_0x12dd11[_0x199cbd(0x24b)][_0x199cbd(0x231)],_0x6c65fc=await xlsx[_0x199cbd(0x1f2)]('public/Migration/'+_0x1aebd4);let _0x4843f9=_0x6c65fc[_0x199cbd(0x1f5)],_0x58e1a8=xlsx[_0x199cbd(0x220)][_0x199cbd(0x21a)](_0x6c65fc[_0x199cbd(0x24d)][_0x4843f9[0x0]]);for(const _0x337a8d of _0x58e1a8){const _0x33b695=_0x337a8d['Name'],_0x5a9059=_0x337a8d[_0x199cbd(0x214)],_0x219095=_0x337a8d['address'],_0x401c92=_0x337a8d[_0x199cbd(0x23b)],_0x3dba5e=_0x337a8d['Email'],_0x5cbef4=_0x337a8d[_0x199cbd(0x1eb)];try{let _0x3bf66f=await suppliers['findOne']({'name':_0x33b695});if(!_0x3bf66f){const _0x32cc8f=new suppliers({'name':_0x33b695,'suppliers_code':_0x5a9059,'address':_0x219095,'mobile':_0x401c92,'email':_0x3dba5e,'company':_0x5cbef4});_0x3bf66f=await _0x32cc8f[_0x199cbd(0x23e)](),_0x12dd11[_0x199cbd(0x212)](_0x199cbd(0x20d),_0x33b695+_0x199cbd(0x242));}else _0x12dd11['flash'](_0x199cbd(0x1e6),_0x33b695+_0x199cbd(0x1ee));}catch(_0x16cbe1){_0x4f5f56[_0x199cbd(0x215)](0x1f4)[_0x199cbd(0x219)]({'proderror':_0x16cbe1['message'],'aproduct':ProductName});}}_0x4f5f56['redirect'](_0x199cbd(0x221));}),module[a0_0x46b754(0x200)]=router;function a0_0x4074(){const _0x4166b0=['/products_export_migrate_file','body','errors','$reason','master','public/Migration','language','get','/supplier_import_migrate_file','supplier_product_file','Router','filename','168hMvmhl','14842pthMSs','purchase_return','amount','map','setHeader','aggregate','1910980MHaoNG','diskStorage','Mobile_number','name','9767994QkPSyd','save','redirect','1384227fdtOar','French','\x20added\x20successfully','1211560mvQlTs','find','German','Customers','Content-Type','express','/view','supplier','file','Name','Sheets','columns','findOne','../public/language/languages.json','Chinese','English\x20(US)','error','doc','address','forEach','post','Company_Name','supplier.js\x20payment_data','now','\x20Failed','Hindi','Portuguese\x20(BR)','payable_sum','readFile','single','Portuguese','SheetNames','s_payments','/view/payment/:id','email','originalname','Content-Disposition','English','mobile','payable','Purchase','receivable_sum','exports','suppliers','4xSPDOe','render','16XxDUKj','11453946MSQfOM','Purchase\x20Return','/view/:id','params','addWorksheet','Arabic\x20(ae)','purchase','message','success','write','suppliers_code','user','supplier\x20data\x20update\x20successfully','flash','suppliers_docs','Supplier_Code','status','xlsx','send','findById','json','sheet_to_json','exceljs','Spanish','PBrands','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','24116650uUEahJ','utils','/supplier/view','log','Arabic','data','then'];a0_0x4074=function(){return _0x4166b0;};return a0_0x4074();}