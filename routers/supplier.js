const a0_0x335056=a0_0x1210;(function(_0x105397,_0x1a0e73){const _0x27b50d=a0_0x1210,_0x470130=_0x105397();while(!![]){try{const _0x56ded7=parseInt(_0x27b50d(0x1b4))/0x1+-parseInt(_0x27b50d(0x195))/0x2*(-parseInt(_0x27b50d(0x196))/0x3)+parseInt(_0x27b50d(0x17a))/0x4+parseInt(_0x27b50d(0x174))/0x5*(-parseInt(_0x27b50d(0x167))/0x6)+parseInt(_0x27b50d(0x17f))/0x7+-parseInt(_0x27b50d(0x19c))/0x8+-parseInt(_0x27b50d(0x188))/0x9*(parseInt(_0x27b50d(0x1ac))/0xa);if(_0x56ded7===_0x1a0e73)break;else _0x470130['push'](_0x470130['shift']());}catch(_0x143861){_0x470130['push'](_0x470130['shift']());}}}(a0_0x34f0,0xf38b8));const express=require(a0_0x335056(0x1a8)),app=express(),router=express[a0_0x335056(0x1b1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x335056(0x17c)),auth=require(a0_0x335056(0x164)),users=require(a0_0x335056(0x183)),excelJS=require(a0_0x335056(0x1b3)),xlsx=require(a0_0x335056(0x17b)),multer=require(a0_0x335056(0x169));router['get'](a0_0x335056(0x16e),auth,async(_0x5c3bf0,_0x2d93b3)=>{const _0x19ebb5=a0_0x335056;try{const {username:_0x22d3de,email:_0x16ad16,role:_0x192e8f}=_0x5c3bf0[_0x19ebb5(0x185)],_0x13cc5e=_0x5c3bf0['user'],_0x2dd585=await profile[_0x19ebb5(0x1b0)]({'email':_0x13cc5e[_0x19ebb5(0x16c)]}),_0x489791=await master_shop[_0x19ebb5(0x197)]();console['log'](_0x19ebb5(0x182),_0x489791);const _0x243fc1=await suppliers[_0x19ebb5(0x197)]();console[_0x19ebb5(0x18f)](_0x243fc1);const _0x3d4f10=await suppliers[_0x19ebb5(0x162)]([{'$lookup':{'from':_0x19ebb5(0x187),'localField':_0x19ebb5(0x1a1),'foreignField':_0x19ebb5(0x1a4),'as':_0x19ebb5(0x1b2)}}]),_0x12fecc=_0x3d4f10[_0x19ebb5(0x16a)](_0x11bed4=>{const _0x4685ba=_0x19ebb5;console[_0x4685ba(0x18f)](_0x4685ba(0x1a6),_0x11bed4);var _0x1d12e5=0x0,_0x27bcc6=0x0;return _0x11bed4[_0x4685ba(0x1b2)][_0x4685ba(0x161)](_0x3fb744=>{const _0xef44a8=_0x4685ba;console[_0xef44a8(0x18f)](_0xef44a8(0x1aa),_0x3fb744),_0x3fb744[_0xef44a8(0x14c)]==_0xef44a8(0x180)?_0x1d12e5+=_0x3fb744[_0xef44a8(0x163)]:_0x27bcc6+=_0x3fb744['amount'];}),_0x11bed4['purchase']=_0x1d12e5,_0x11bed4[_0x4685ba(0x1a5)]=_0x27bcc6,_0x11bed4;});console[_0x19ebb5(0x18f)](_0x19ebb5(0x181),_0x12fecc);if(_0x489791[0x0]['language']==_0x19ebb5(0x1a9)){var _0x36bfcb=users[_0x19ebb5(0x1b5)];console['log'](_0x36bfcb);}else{if(_0x489791[0x0][_0x19ebb5(0x1af)]==_0x19ebb5(0x19e))var _0x36bfcb=users[_0x19ebb5(0x19e)];else{if(_0x489791[0x0][_0x19ebb5(0x1af)]==_0x19ebb5(0x179))var _0x36bfcb=users[_0x19ebb5(0x179)];else{if(_0x489791[0x0][_0x19ebb5(0x1af)]=='Spanish')var _0x36bfcb=users[_0x19ebb5(0x152)];else{if(_0x489791[0x0]['language']==_0x19ebb5(0x190))var _0x36bfcb=users[_0x19ebb5(0x190)];else{if(_0x489791[0x0][_0x19ebb5(0x1af)]=='Portuguese\x20(BR)')var _0x36bfcb=users['Portuguese'];else{if(_0x489791[0x0]['language']==_0x19ebb5(0x1ad))var _0x36bfcb=users[_0x19ebb5(0x1ad)];else{if(_0x489791[0x0][_0x19ebb5(0x1af)]==_0x19ebb5(0x198))var _0x36bfcb=users[_0x19ebb5(0x166)];}}}}}}}_0x2d93b3[_0x19ebb5(0x153)](_0x19ebb5(0x1ab),{'success':_0x5c3bf0[_0x19ebb5(0x18d)](_0x19ebb5(0x1a0)),'errors':_0x5c3bf0['flash'](_0x19ebb5(0x19a)),'user':_0x243fc1,'profile':_0x2dd585,'master_shop':_0x489791,'role':_0x13cc5e,'payment':_0x12fecc,'language':_0x36bfcb});}catch(_0x48f828){console[_0x19ebb5(0x18f)](_0x48f828);}}),router['post']('/view',auth,async(_0x3957d1,_0x558040)=>{const _0x5a68af=a0_0x335056;try{const {name:_0xa157c0,email:_0x170567,mobile:_0x42ed8a,company:_0x1fb690,address:_0x2b1b3b,receivable:_0x3c2dca,payable:_0x4332c4,code:_0x19d9a1,contactperson:_0x55257a,landline:_0x1d944d}=_0x3957d1[_0x5a68af(0x14e)],_0x5d0df5=new suppliers({'name':_0xa157c0,'email':_0x170567,'mobile':_0x42ed8a,'company':_0x1fb690,'address':_0x2b1b3b,'receivable':_0x3c2dca,'payable':_0x4332c4,'suppliers_code':_0x19d9a1,'contactperson':_0x55257a,'landline':_0x1d944d}),_0x533176=await _0x5d0df5[_0x5a68af(0x14f)]();_0x3957d1[_0x5a68af(0x18d)](_0x5a68af(0x1a0),_0x5a68af(0x175)),_0x558040[_0x5a68af(0x17e)](_0x5a68af(0x168));}catch(_0x351eb8){console[_0x5a68af(0x18f)](_0x351eb8);}}),router[a0_0x335056(0x1a7)](a0_0x335056(0x194),auth,async(_0x2056bc,_0x2f775e)=>{const _0x3a268f=a0_0x335056;try{const {username:_0xdc1b6,email:_0x36b843,role:_0x39a1fa}=_0x2056bc[_0x3a268f(0x185)],_0x1b5099=_0x2056bc['user'],_0x28e147=await profile[_0x3a268f(0x1b0)]({'email':_0x1b5099[_0x3a268f(0x16c)]}),_0x3cac0d=await master_shop[_0x3a268f(0x197)]();console[_0x3a268f(0x18f)](_0x3a268f(0x182),_0x3cac0d);const _0xc6424f=_0x2056bc[_0x3a268f(0x15a)]['id'],_0x2b4cd4=await suppliers[_0x3a268f(0x160)](_0xc6424f);console[_0x3a268f(0x18f)](_0x2b4cd4);if(_0x3cac0d[0x0]['language']==_0x3a268f(0x1a9)){var _0x4c96db=users[_0x3a268f(0x1b5)];console[_0x3a268f(0x18f)](_0x4c96db);}else{if(_0x3cac0d[0x0][_0x3a268f(0x1af)]==_0x3a268f(0x19e))var _0x4c96db=users[_0x3a268f(0x19e)];else{if(_0x3cac0d[0x0][_0x3a268f(0x1af)]==_0x3a268f(0x179))var _0x4c96db=users['German'];else{if(_0x3cac0d[0x0][_0x3a268f(0x1af)]==_0x3a268f(0x152))var _0x4c96db=users[_0x3a268f(0x152)];else{if(_0x3cac0d[0x0][_0x3a268f(0x1af)]=='French')var _0x4c96db=users[_0x3a268f(0x190)];else{if(_0x3cac0d[0x0][_0x3a268f(0x1af)]==_0x3a268f(0x171))var _0x4c96db=users['Portuguese'];else{if(_0x3cac0d[0x0][_0x3a268f(0x1af)]=='Chinese')var _0x4c96db=users[_0x3a268f(0x1ad)];else{if(_0x3cac0d[0x0][_0x3a268f(0x1af)]=='Arabic\x20(ae)')var _0x4c96db=users['Arabic'];}}}}}}}_0x2f775e[_0x3a268f(0x153)](_0x3a268f(0x1ab),{'success':_0x2056bc[_0x3a268f(0x18d)]('success'),'errors':_0x2056bc[_0x3a268f(0x18d)](_0x3a268f(0x19a)),'role':_0x1b5099,'profile':_0x28e147,'master_shop':_0x3cac0d,'user':_0x2b4cd4,'language':_0x4c96db});}catch(_0x2094e8){console[_0x3a268f(0x18f)](_0x2094e8);}}),router['post'](a0_0x335056(0x194),auth,async(_0x5ee6db,_0x182ef4)=>{const _0x27c4c3=a0_0x335056;try{const _0x4ab15e=_0x5ee6db[_0x27c4c3(0x15a)]['id'],_0x3db7e1=await suppliers[_0x27c4c3(0x160)](_0x4ab15e),{name:_0x3cb316,email:_0x5824c0,mobile:_0xda6b12,company:_0x58bebf,address:_0x3c3afa,receivable:_0x1bd19c,payable:_0x1238ee,code:_0x1f5863,contactperson:_0x2cff97,landline:_0x454e9a}=_0x5ee6db[_0x27c4c3(0x14e)];_0x3db7e1[_0x27c4c3(0x1a1)]=_0x3cb316,_0x3db7e1[_0x27c4c3(0x16c)]=_0x5824c0,_0x3db7e1[_0x27c4c3(0x199)]=_0xda6b12,_0x3db7e1['company']=_0x58bebf,_0x3db7e1['address']=_0x3c3afa,_0x3db7e1['receivable']=_0x1bd19c,_0x3db7e1[_0x27c4c3(0x19b)]=_0x1238ee,_0x3db7e1['suppliers_code']=_0x1f5863,_0x3db7e1[_0x27c4c3(0x15f)]=_0x2cff97,_0x3db7e1[_0x27c4c3(0x184)]=_0x454e9a;const _0x2c8cde=await _0x3db7e1['save']();_0x5ee6db[_0x27c4c3(0x18d)](_0x27c4c3(0x1a0),_0x27c4c3(0x18b)),_0x182ef4[_0x27c4c3(0x17e)](_0x27c4c3(0x168));}catch(_0x4c5360){console[_0x27c4c3(0x18f)](_0x4c5360);}}),router[a0_0x335056(0x1a7)]('/view/payment/:id',auth,async(_0x23283d,_0x42bf83)=>{const _0x2dde3f=a0_0x335056;try{const {username:_0x3bee70,email:_0x2b8ea2,role:_0x3e9547}=_0x23283d[_0x2dde3f(0x185)],_0x55a4a3=_0x23283d['user'],_0x50cfad=await profile[_0x2dde3f(0x1b0)]({'email':_0x55a4a3[_0x2dde3f(0x16c)]}),_0x84f3df=await master_shop[_0x2dde3f(0x197)]();console['log'](_0x2dde3f(0x182),_0x84f3df),console[_0x2dde3f(0x18f)](_0x23283d['params']['id']);const _0x9af8e=await suppliers[_0x2dde3f(0x1b0)]({'_id':_0x23283d[_0x2dde3f(0x15a)]['id']});console[_0x2dde3f(0x18f)](_0x9af8e);const _0x2c0786=await s_payment_data['find']({'suppliers':_0x9af8e[_0x2dde3f(0x1a1)]});console[_0x2dde3f(0x18f)](_0x2c0786);const _0x13ebee=await s_payment_data[_0x2dde3f(0x162)]([{'$match':{'suppliers':_0x9af8e[_0x2dde3f(0x1a1)]}},{'$match':{'reason':_0x2dde3f(0x180)}},{'$group':{'_id':_0x2dde3f(0x165),'sum':{'$sum':_0x2dde3f(0x186)}}}]);console[_0x2dde3f(0x18f)](_0x2dde3f(0x159),_0x13ebee);const _0x157ca7=await s_payment_data[_0x2dde3f(0x162)]([{'$match':{'suppliers':_0x9af8e['name']}},{'$match':{'reason':_0x2dde3f(0x155)}},{'$group':{'_id':_0x2dde3f(0x165),'sum':{'$sum':_0x2dde3f(0x186)}}}]);console['log'](_0x2dde3f(0x189),_0x157ca7);if(_0x84f3df[0x0][_0x2dde3f(0x1af)]==_0x2dde3f(0x1a9)){var _0x20b143=users['English'];console[_0x2dde3f(0x18f)](_0x20b143);}else{if(_0x84f3df[0x0]['language']==_0x2dde3f(0x19e))var _0x20b143=users[_0x2dde3f(0x19e)];else{if(_0x84f3df[0x0]['language']==_0x2dde3f(0x179))var _0x20b143=users[_0x2dde3f(0x179)];else{if(_0x84f3df[0x0][_0x2dde3f(0x1af)]=='Spanish')var _0x20b143=users[_0x2dde3f(0x152)];else{if(_0x84f3df[0x0]['language']==_0x2dde3f(0x190))var _0x20b143=users[_0x2dde3f(0x190)];else{if(_0x84f3df[0x0][_0x2dde3f(0x1af)]==_0x2dde3f(0x171))var _0x20b143=users['Portuguese'];else{if(_0x84f3df[0x0][_0x2dde3f(0x1af)]==_0x2dde3f(0x1ad))var _0x20b143=users[_0x2dde3f(0x1ad)];else{if(_0x84f3df[0x0][_0x2dde3f(0x1af)]==_0x2dde3f(0x198))var _0x20b143=users[_0x2dde3f(0x166)];}}}}}}}_0x42bf83['render'](_0x2dde3f(0x193),{'success':_0x23283d[_0x2dde3f(0x18d)](_0x2dde3f(0x1a0)),'errors':_0x23283d['flash'](_0x2dde3f(0x19a)),'role':_0x55a4a3,'profile':_0x50cfad,'master_shop':_0x84f3df,'payment':_0x2c0786,'payable':_0x13ebee,'receivable':_0x157ca7,'language':_0x20b143});}catch(_0x1f06f5){console['log'](_0x1f06f5);}}),router[a0_0x335056(0x1a7)](a0_0x335056(0x18e),auth,async(_0x55472f,_0xefd55)=>{const _0x3f6508=a0_0x335056;try{const _0x3ad72b=new excelJS[(_0x3f6508(0x16d))](),_0x26a6ee=_0x3ad72b[_0x3f6508(0x158)](_0x3f6508(0x191));return _0x26a6ee[_0x3f6508(0x173)]=[{'header':_0x3f6508(0x172),'key':_0x3f6508(0x1ae),'width':0xa},{'header':_0x3f6508(0x15e),'key':_0x3f6508(0x14a),'width':0xa},{'header':'Email','key':_0x3f6508(0x177),'width':0xa},{'header':_0x3f6508(0x178),'key':_0x3f6508(0x14d),'width':0xa},{'header':'Company_Name','key':_0x3f6508(0x199),'width':0xa},{'header':_0x3f6508(0x14d),'key':_0x3f6508(0x16c),'width':0xa}],_0xefd55[_0x3f6508(0x1a3)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0xefd55[_0x3f6508(0x1a3)](_0x3f6508(0x150),'attachment;\x20filename=supplier_Migration_File.xlsx'),_0x3ad72b[_0x3f6508(0x17b)][_0x3f6508(0x18c)](_0xefd55)['then'](()=>{_0xefd55['status'](0xc8);});}catch(_0x8c4227){_0xefd55[_0x3f6508(0x19d)](0x190)['send']({'errors':_0x8c4227[_0x3f6508(0x156)]});}});function a0_0x1210(_0x4aaafe,_0x5a49ec){const _0x34f04b=a0_0x34f0();return a0_0x1210=function(_0x12104b,_0x5b911d){_0x12104b=_0x12104b-0x14a;let _0x184f00=_0x34f04b[_0x12104b];return _0x184f00;},a0_0x1210(_0x4aaafe,_0x5a49ec);}const storage1=multer[a0_0x335056(0x15d)]({'destination':(_0xa9f5e9,_0x4c918,_0x532117)=>{const _0x22b2d9=a0_0x335056;_0x532117(null,_0x22b2d9(0x151));},'filename':(_0x184425,_0x4b4e5c,_0x7a424a)=>{const _0x566be2=a0_0x335056;_0x7a424a(null,Date[_0x566be2(0x192)]()+_0x4b4e5c[_0x566be2(0x157)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x34f0(){const _0x290d5d=['data','get','express','English\x20(US)','doc','supplier','28210gRPNrm','Chinese','PBrands','language','findOne','Router','suppliers_docs','exceljs','76585GngEyt','English','PUnits','\x20Failed','reason','address','body','save','Content-Disposition','public/Migration','Spanish','render','readFile','Purchase\x20Return','message','originalname','addWorksheet','payable_sum','params','error','exports','diskStorage','Supplier_Code','contactperson','findById','forEach','aggregate','amount','../middleware/auth','$reason','Arabic','42ZVrwZk','/supplier/view','multer','map','filename','email','Workbook','/view','utils','Email','Portuguese\x20(BR)','Name','columns','1025345BKOqOC','supplier\x20data\x20add\x20successfully','\x20added\x20successfully','SalesmanName','Mobile_number','German','4409124CLQMuZ','xlsx','../models/all_models','Company_Name','redirect','2809870DjOPiQ','Purchase','supplier.js\x20payment_data','master','../public/language/languages.json','landline','user','$amount','s_payments','36ZqWswX','receivable_sum','file','supplier\x20data\x20update\x20successfully','write','flash','/products_export_migrate_file','log','French','Customers','now','supplier_payment','/view/:id','251830IvAAhE','42rJhNBz','find','Arabic\x20(ae)','mobile','errors','payable','7190072CmeROz','status','Hindi','post','success','name','single','setHeader','suppliers','purchase_return'];a0_0x34f0=function(){return _0x290d5d;};return a0_0x34f0();}router[a0_0x335056(0x19f)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x335056(0x1a2)]('supplier_product_file'),async(_0x1d748d,_0x43034f)=>{const _0x3b2abe=a0_0x335056,_0xd6fa28=_0x1d748d[_0x3b2abe(0x18a)][_0x3b2abe(0x16b)],_0x3f87b6=await xlsx[_0x3b2abe(0x154)]('public/Migration/'+_0xd6fa28);let _0xf91412=_0x3f87b6['SheetNames'],_0x52205f=xlsx[_0x3b2abe(0x16f)]['sheet_to_json'](_0x3f87b6['Sheets'][_0xf91412[0x0]]);for(const _0xe22c40 of _0x52205f){const _0x107b6c=_0xe22c40[_0x3b2abe(0x172)],_0x4e7d22=_0xe22c40[_0x3b2abe(0x15e)],_0x576d8f=_0xe22c40['address'],_0xdb0dcd=_0xe22c40['Mobile_number'],_0x3bce1f=_0xe22c40[_0x3b2abe(0x170)],_0xbe2f0=_0xe22c40[_0x3b2abe(0x17d)];try{let _0x4f069a=await suppliers['findOne']({'name':_0x107b6c});if(!_0x4f069a){const _0x2435b0=new suppliers({'name':_0x107b6c,'suppliers_code':_0x4e7d22,'address':_0x576d8f,'mobile':_0xdb0dcd,'email':_0x3bce1f,'company':_0xbe2f0});_0x4f069a=await _0x2435b0[_0x3b2abe(0x14f)](),_0x1d748d[_0x3b2abe(0x18d)](_0x3b2abe(0x1a0),_0x107b6c+_0x3b2abe(0x176));}else _0x1d748d[_0x3b2abe(0x18d)](_0x3b2abe(0x15b),_0x107b6c+_0x3b2abe(0x14b));}catch(_0x37b86a){_0x43034f[_0x3b2abe(0x19d)](0x1f4)['json']({'proderror':_0x37b86a[_0x3b2abe(0x156)],'aproduct':ProductName});}}_0x43034f[_0x3b2abe(0x17e)](_0x3b2abe(0x168));}),module[a0_0x335056(0x15c)]=router;