const a0_0x1ac937=a0_0x23b9;(function(_0x2d6c4d,_0x52f558){const _0x45742a=a0_0x23b9,_0x3774e3=_0x2d6c4d();while(!![]){try{const _0x2b6d97=parseInt(_0x45742a(0x100))/0x1+parseInt(_0x45742a(0x119))/0x2+parseInt(_0x45742a(0xed))/0x3+-parseInt(_0x45742a(0xd1))/0x4*(-parseInt(_0x45742a(0xcb))/0x5)+parseInt(_0x45742a(0xc5))/0x6*(parseInt(_0x45742a(0xbf))/0x7)+parseInt(_0x45742a(0xef))/0x8+-parseInt(_0x45742a(0x116))/0x9;if(_0x2b6d97===_0x52f558)break;else _0x3774e3['push'](_0x3774e3['shift']());}catch(_0x86cc00){_0x3774e3['push'](_0x3774e3['shift']());}}}(a0_0x1fd2,0x4c3a2));const express=require(a0_0x1ac937(0xfb)),app=express(),router=express[a0_0x1ac937(0xc9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x1ac937(0xf2)),auth=require(a0_0x1ac937(0xf5)),users=require(a0_0x1ac937(0xd2)),excelJS=require('exceljs'),xlsx=require(a0_0x1ac937(0xf7)),multer=require(a0_0x1ac937(0xe6));router[a0_0x1ac937(0xb8)](a0_0x1ac937(0xd0),auth,async(_0x33646a,_0x486e5e)=>{const _0x29e490=a0_0x1ac937;try{const {username:_0x56f130,email:_0x4f2411,role:_0xa806f3}=_0x33646a['user'],_0x2e8403=_0x33646a[_0x29e490(0x105)],_0x4877e8=await profile[_0x29e490(0x110)]({'email':_0x2e8403['email']}),_0x367721=await master_shop[_0x29e490(0xf0)]();console[_0x29e490(0xeb)](_0x29e490(0xba),_0x367721);const _0xbcf973=await suppliers[_0x29e490(0xf0)]();console[_0x29e490(0xeb)](_0xbcf973);const _0x3d3d5b=await suppliers['aggregate']([{'$lookup':{'from':_0x29e490(0xb5),'localField':_0x29e490(0xc4),'foreignField':'suppliers','as':_0x29e490(0x101)}}]),_0x3e5103=_0x3d3d5b['map'](_0x3b4e17=>{const _0x24a142=_0x29e490;console['log']('data',_0x3b4e17);var _0x44ca8a=0x0,_0x535419=0x0;return _0x3b4e17[_0x24a142(0x101)][_0x24a142(0x102)](_0x58ccda=>{const _0x45b3db=_0x24a142;console[_0x45b3db(0xeb)](_0x45b3db(0xb9),_0x58ccda),_0x58ccda['reason']==_0x45b3db(0xc3)?_0x44ca8a+=_0x58ccda[_0x45b3db(0xe1)]:_0x535419+=_0x58ccda['amount'];}),_0x3b4e17[_0x24a142(0xb6)]=_0x44ca8a,_0x3b4e17['purchase_return']=_0x535419,_0x3b4e17;});console['log'](_0x29e490(0xf6),_0x3e5103);if(_0x367721[0x0]['language']==_0x29e490(0xee)){var _0x9365db=users[_0x29e490(0x10a)];console['log'](_0x9365db);}else{if(_0x367721[0x0]['language']==_0x29e490(0xff))var _0x9365db=users[_0x29e490(0xff)];else{if(_0x367721[0x0][_0x29e490(0xf3)]==_0x29e490(0x109))var _0x9365db=users['German'];else{if(_0x367721[0x0][_0x29e490(0xf3)]==_0x29e490(0xc1))var _0x9365db=users['Spanish'];else{if(_0x367721[0x0][_0x29e490(0xf3)]==_0x29e490(0xc0))var _0x9365db=users[_0x29e490(0xc0)];else{if(_0x367721[0x0][_0x29e490(0xf3)]=='Portuguese\x20(BR)')var _0x9365db=users[_0x29e490(0x106)];else{if(_0x367721[0x0][_0x29e490(0xf3)]==_0x29e490(0xcd))var _0x9365db=users[_0x29e490(0xcd)];else{if(_0x367721[0x0][_0x29e490(0xf3)]==_0x29e490(0x10e))var _0x9365db=users['Arabic'];}}}}}}}_0x486e5e[_0x29e490(0x114)]('supplier',{'success':_0x33646a['flash'](_0x29e490(0xf8)),'errors':_0x33646a[_0x29e490(0xcf)](_0x29e490(0xd7)),'user':_0xbcf973,'profile':_0x4877e8,'master_shop':_0x367721,'role':_0x2e8403,'payment':_0x3e5103,'language':_0x9365db});}catch(_0x26120c){console[_0x29e490(0xeb)](_0x26120c);}}),router[a0_0x1ac937(0xe5)](a0_0x1ac937(0xd0),auth,async(_0x563eeb,_0x581979)=>{const _0x264971=a0_0x1ac937;try{const {name:_0x3f3ddf,email:_0x346b37,mobile:_0x4f633c,company:_0x5b6081,address:_0x2713c3,receivable:_0x630197,payable:_0x33c922,code:_0x3044b9,contactperson:_0xb740fd,landline:_0x57951c}=_0x563eeb[_0x264971(0x113)],_0x19b379=new suppliers({'name':_0x3f3ddf,'email':_0x346b37,'mobile':_0x4f633c,'company':_0x5b6081,'address':_0x2713c3,'receivable':_0x630197,'payable':_0x33c922,'suppliers_code':_0x3044b9,'contactperson':_0xb740fd,'landline':_0x57951c}),_0x225c9f=await _0x19b379['save']();_0x563eeb[_0x264971(0xcf)](_0x264971(0xf8),_0x264971(0xd5)),_0x581979['redirect'](_0x264971(0xce));}catch(_0x560a40){console[_0x264971(0xeb)](_0x560a40);}}),router[a0_0x1ac937(0xb8)](a0_0x1ac937(0xc6),auth,async(_0x3a0a55,_0x35ad9a)=>{const _0x2341b7=a0_0x1ac937;try{const {username:_0x12dc42,email:_0x19f794,role:_0x1c677b}=_0x3a0a55[_0x2341b7(0x105)],_0x537cdd=_0x3a0a55[_0x2341b7(0x105)],_0x20e779=await profile[_0x2341b7(0x110)]({'email':_0x537cdd[_0x2341b7(0xd6)]}),_0x3f0671=await master_shop[_0x2341b7(0xf0)]();console[_0x2341b7(0xeb)](_0x2341b7(0xba),_0x3f0671);const _0x4210cb=_0x3a0a55['params']['id'],_0x4fb72c=await suppliers[_0x2341b7(0xca)](_0x4210cb);console[_0x2341b7(0xeb)](_0x4fb72c);if(_0x3f0671[0x0]['language']==_0x2341b7(0xee)){var _0x170cab=users[_0x2341b7(0x10a)];console[_0x2341b7(0xeb)](_0x170cab);}else{if(_0x3f0671[0x0][_0x2341b7(0xf3)]==_0x2341b7(0xff))var _0x170cab=users[_0x2341b7(0xff)];else{if(_0x3f0671[0x0][_0x2341b7(0xf3)]==_0x2341b7(0x109))var _0x170cab=users[_0x2341b7(0x109)];else{if(_0x3f0671[0x0][_0x2341b7(0xf3)]==_0x2341b7(0xc1))var _0x170cab=users['Spanish'];else{if(_0x3f0671[0x0][_0x2341b7(0xf3)]==_0x2341b7(0xc0))var _0x170cab=users[_0x2341b7(0xc0)];else{if(_0x3f0671[0x0][_0x2341b7(0xf3)]=='Portuguese\x20(BR)')var _0x170cab=users['Portuguese'];else{if(_0x3f0671[0x0][_0x2341b7(0xf3)]=='Chinese')var _0x170cab=users[_0x2341b7(0xcd)];else{if(_0x3f0671[0x0]['language']==_0x2341b7(0x10e))var _0x170cab=users[_0x2341b7(0xde)];}}}}}}}_0x35ad9a[_0x2341b7(0x114)]('supplier',{'success':_0x3a0a55[_0x2341b7(0xcf)](_0x2341b7(0xf8)),'errors':_0x3a0a55['flash'](_0x2341b7(0xd7)),'role':_0x537cdd,'profile':_0x20e779,'master_shop':_0x3f0671,'user':_0x4fb72c,'language':_0x170cab});}catch(_0x1b9289){console[_0x2341b7(0xeb)](_0x1b9289);}}),router['post'](a0_0x1ac937(0xc6),auth,async(_0x55359b,_0x57cbdb)=>{const _0x20b617=a0_0x1ac937;try{const _0x445ff0=_0x55359b['params']['id'],_0x291e=await suppliers[_0x20b617(0xca)](_0x445ff0),{name:_0x5d7073,email:_0x5226e5,mobile:_0x4f649e,company:_0x497ef1,address:_0x5744ec,receivable:_0x390029,payable:_0x114a84,code:_0x33c2c4,contactperson:_0x2e5d56,landline:_0x3d76cf}=_0x55359b[_0x20b617(0x113)];_0x291e[_0x20b617(0xc4)]=_0x5d7073,_0x291e['email']=_0x5226e5,_0x291e[_0x20b617(0xbe)]=_0x4f649e,_0x291e[_0x20b617(0x10d)]=_0x497ef1,_0x291e[_0x20b617(0x107)]=_0x5744ec,_0x291e[_0x20b617(0xe9)]=_0x390029,_0x291e[_0x20b617(0xda)]=_0x114a84,_0x291e[_0x20b617(0xcc)]=_0x33c2c4,_0x291e['contactperson']=_0x2e5d56,_0x291e['landline']=_0x3d76cf;const _0x80496a=await _0x291e['save']();_0x55359b[_0x20b617(0xcf)](_0x20b617(0xf8),'supplier\x20data\x20update\x20successfully'),_0x57cbdb[_0x20b617(0x112)](_0x20b617(0xce));}catch(_0x5ee936){console[_0x20b617(0xeb)](_0x5ee936);}}),router[a0_0x1ac937(0xb8)]('/view/payment/:id',auth,async(_0x33f652,_0x5729ad)=>{const _0x5f01b9=a0_0x1ac937;try{const {username:_0x1b7129,email:_0x2f3916,role:_0x1bd686}=_0x33f652[_0x5f01b9(0x105)],_0x5d898c=_0x33f652[_0x5f01b9(0x105)],_0x3fcb46=await profile['findOne']({'email':_0x5d898c[_0x5f01b9(0xd6)]}),_0x1ff852=await master_shop['find']();console[_0x5f01b9(0xeb)](_0x5f01b9(0xba),_0x1ff852),console[_0x5f01b9(0xeb)](_0x33f652[_0x5f01b9(0xdc)]['id']);const _0x469e35=await suppliers[_0x5f01b9(0x110)]({'_id':_0x33f652[_0x5f01b9(0xdc)]['id']});console[_0x5f01b9(0xeb)](_0x469e35);const _0x57a45c=await s_payment_data[_0x5f01b9(0xf0)]({'suppliers':_0x469e35[_0x5f01b9(0xc4)]});console[_0x5f01b9(0xeb)](_0x57a45c);const _0x42a82c=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x469e35[_0x5f01b9(0xc4)]}},{'$match':{'reason':_0x5f01b9(0xc3)}},{'$group':{'_id':_0x5f01b9(0x103),'sum':{'$sum':'$amount'}}}]);console['log'](_0x5f01b9(0xfe),_0x42a82c);const _0x5b5191=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x469e35[_0x5f01b9(0xc4)]}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':_0x5f01b9(0x103),'sum':{'$sum':'$amount'}}}]);console[_0x5f01b9(0xeb)](_0x5f01b9(0xe4),_0x5b5191);if(_0x1ff852[0x0][_0x5f01b9(0xf3)]=='English\x20(US)'){var _0x3259cc=users[_0x5f01b9(0x10a)];console[_0x5f01b9(0xeb)](_0x3259cc);}else{if(_0x1ff852[0x0][_0x5f01b9(0xf3)]==_0x5f01b9(0xff))var _0x3259cc=users[_0x5f01b9(0xff)];else{if(_0x1ff852[0x0][_0x5f01b9(0xf3)]==_0x5f01b9(0x109))var _0x3259cc=users[_0x5f01b9(0x109)];else{if(_0x1ff852[0x0][_0x5f01b9(0xf3)]=='Spanish')var _0x3259cc=users['Spanish'];else{if(_0x1ff852[0x0][_0x5f01b9(0xf3)]==_0x5f01b9(0xc0))var _0x3259cc=users[_0x5f01b9(0xc0)];else{if(_0x1ff852[0x0]['language']==_0x5f01b9(0xd3))var _0x3259cc=users[_0x5f01b9(0x106)];else{if(_0x1ff852[0x0]['language']==_0x5f01b9(0xcd))var _0x3259cc=users[_0x5f01b9(0xcd)];else{if(_0x1ff852[0x0][_0x5f01b9(0xf3)]==_0x5f01b9(0x10e))var _0x3259cc=users['Arabic'];}}}}}}}_0x5729ad[_0x5f01b9(0x114)](_0x5f01b9(0xd9),{'success':_0x33f652[_0x5f01b9(0xcf)](_0x5f01b9(0xf8)),'errors':_0x33f652[_0x5f01b9(0xcf)]('errors'),'role':_0x5d898c,'profile':_0x3fcb46,'master_shop':_0x1ff852,'payment':_0x57a45c,'payable':_0x42a82c,'receivable':_0x5b5191,'language':_0x3259cc});}catch(_0x19ec88){console['log'](_0x19ec88);}}),router['get'](a0_0x1ac937(0xc8),auth,async(_0x52e9f9,_0x64dd3e)=>{const _0x5dcd0e=a0_0x1ac937;try{const _0x1eceab=new excelJS[(_0x5dcd0e(0x11a))](),_0x11d614=_0x1eceab[_0x5dcd0e(0xbc)](_0x5dcd0e(0xe7));return _0x11d614['columns']=[{'header':_0x5dcd0e(0xf4),'key':_0x5dcd0e(0x108),'width':0xa},{'header':'Supplier_Code','key':_0x5dcd0e(0xe3),'width':0xa},{'header':_0x5dcd0e(0xfc),'key':_0x5dcd0e(0xb7),'width':0xa},{'header':_0x5dcd0e(0x104),'key':'address','width':0xa},{'header':_0x5dcd0e(0xbb),'key':'mobile','width':0xa},{'header':_0x5dcd0e(0x107),'key':_0x5dcd0e(0xd6),'width':0xa}],_0x64dd3e[_0x5dcd0e(0xfa)](_0x5dcd0e(0x115),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x64dd3e['setHeader'](_0x5dcd0e(0x10f),_0x5dcd0e(0xea)),_0x1eceab['xlsx'][_0x5dcd0e(0xbd)](_0x64dd3e)[_0x5dcd0e(0xd4)](()=>{const _0x3a5cb9=_0x5dcd0e;_0x64dd3e[_0x3a5cb9(0x10c)](0xc8);});}catch(_0x1c75de){_0x64dd3e[_0x5dcd0e(0x10c)](0x190)[_0x5dcd0e(0xdb)]({'errors':_0x1c75de[_0x5dcd0e(0xe0)]});}});const storage1=multer[a0_0x1ac937(0xf1)]({'destination':(_0x26acec,_0x1c29c2,_0x21d639)=>{const _0x112fd7=a0_0x1ac937;_0x21d639(null,_0x112fd7(0xe2));},'filename':(_0x250fad,_0x1f8726,_0x1448a3)=>{const _0x5912a9=a0_0x1ac937;_0x1448a3(null,Date[_0x5912a9(0xfd)]()+_0x1f8726['originalname']);}}),uploadMigrate=multer({'storage':storage1});function a0_0x23b9(_0xef5d96,_0xeddb60){const _0x1fd283=a0_0x1fd2();return a0_0x23b9=function(_0x23b93b,_0x5586ff){_0x23b93b=_0x23b93b-0xb4;let _0x18e190=_0x1fd283[_0x23b93b];return _0x18e190;},a0_0x23b9(_0xef5d96,_0xeddb60);}router[a0_0x1ac937(0xe5)]('/supplier_import_migrate_file',auth,uploadMigrate[a0_0x1ac937(0x118)](a0_0x1ac937(0xd8)),async(_0x21cbc7,_0x23111f)=>{const _0x5e4b2b=a0_0x1ac937,_0x4b69dc=_0x21cbc7['file'][_0x5e4b2b(0xdd)],_0x4fdcdc=await xlsx['readFile'](_0x5e4b2b(0xc7)+_0x4b69dc);let _0x2ff6ac=_0x4fdcdc[_0x5e4b2b(0xe8)],_0x342777=xlsx['utils'][_0x5e4b2b(0xc2)](_0x4fdcdc[_0x5e4b2b(0xec)][_0x2ff6ac[0x0]]);for(const _0x1dcb7f of _0x342777){const _0x5148f0=_0x1dcb7f[_0x5e4b2b(0xf4)],_0x967e98=_0x1dcb7f[_0x5e4b2b(0x10b)],_0x2e7a64=_0x1dcb7f[_0x5e4b2b(0x107)],_0x198e9a=_0x1dcb7f[_0x5e4b2b(0x104)],_0x773729=_0x1dcb7f[_0x5e4b2b(0xfc)],_0xedbd7e=_0x1dcb7f[_0x5e4b2b(0xbb)];try{let _0xda60f2=await suppliers[_0x5e4b2b(0x110)]({'name':_0x5148f0});if(!_0xda60f2){const _0x30a882=new suppliers({'name':_0x5148f0,'suppliers_code':_0x967e98,'address':_0x2e7a64,'mobile':_0x198e9a,'email':_0x773729,'company':_0xedbd7e});_0xda60f2=await _0x30a882[_0x5e4b2b(0xf9)](),_0x21cbc7[_0x5e4b2b(0xcf)](_0x5e4b2b(0xf8),_0x5148f0+'\x20added\x20successfully');}else _0x21cbc7[_0x5e4b2b(0xcf)](_0x5e4b2b(0x117),_0x5148f0+_0x5e4b2b(0xb4));}catch(_0x281db8){_0x23111f[_0x5e4b2b(0x10c)](0x1f4)[_0x5e4b2b(0x111)]({'proderror':_0x281db8['message'],'aproduct':ProductName});}}_0x23111f['redirect'](_0x5e4b2b(0xce));}),module[a0_0x1ac937(0xdf)]=router;function a0_0x1fd2(){const _0x478f11=['setHeader','express','Email','now','payable_sum','Hindi','105764HlipBu','suppliers_docs','forEach','$reason','Mobile_number','user','Portuguese','address','PBrands','German','English','Supplier_Code','status','company','Arabic\x20(ae)','Content-Disposition','findOne','json','redirect','body','render','Content-Type','7037136KbKTsz','error','single','680684alOpfC','Workbook','\x20Failed','s_payments','purchase','SalesmanName','get','doc','master','Company_Name','addWorksheet','write','mobile','35biujGK','French','Spanish','sheet_to_json','Purchase','name','2094YLdVhO','/view/:id','public/Migration/','/products_export_migrate_file','Router','findById','115iBebcg','suppliers_code','Chinese','/supplier/view','flash','/view','76220QwLVzd','../public/language/languages.json','Portuguese\x20(BR)','then','supplier\x20data\x20add\x20successfully','email','errors','supplier_product_file','supplier_payment','payable','send','params','filename','Arabic','exports','message','amount','public/Migration','PUnits','receivable_sum','post','multer','Customers','SheetNames','receivable','attachment;\x20filename=supplier_Migration_File.xlsx','log','Sheets','409527ZLWWEC','English\x20(US)','572040kFmvnT','find','diskStorage','../models/all_models','language','Name','../middleware/auth','supplier.js\x20payment_data','xlsx','success','save'];a0_0x1fd2=function(){return _0x478f11;};return a0_0x1fd2();}