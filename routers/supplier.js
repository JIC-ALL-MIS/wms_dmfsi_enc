const a0_0x21b1f6=a0_0x1ffb;(function(_0x3771bb,_0x24aa7c){const _0x1e25c6=a0_0x1ffb,_0x36f8b0=_0x3771bb();while(!![]){try{const _0x1c72d9=parseInt(_0x1e25c6(0x101))/0x1*(-parseInt(_0x1e25c6(0x104))/0x2)+-parseInt(_0x1e25c6(0xf4))/0x3+-parseInt(_0x1e25c6(0x10a))/0x4+parseInt(_0x1e25c6(0x14a))/0x5*(parseInt(_0x1e25c6(0x135))/0x6)+parseInt(_0x1e25c6(0x133))/0x7*(parseInt(_0x1e25c6(0x158))/0x8)+-parseInt(_0x1e25c6(0x10f))/0x9+parseInt(_0x1e25c6(0x105))/0xa;if(_0x1c72d9===_0x24aa7c)break;else _0x36f8b0['push'](_0x36f8b0['shift']());}catch(_0x39fb11){_0x36f8b0['push'](_0x36f8b0['shift']());}}}(a0_0x35a8,0xa4c90));const express=require(a0_0x21b1f6(0x114)),app=express(),router=express[a0_0x21b1f6(0x142)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x21b1f6(0x14f)),auth=require(a0_0x21b1f6(0x121)),users=require('../public/language/languages.json'),excelJS=require('exceljs'),xlsx=require('xlsx'),multer=require('multer');router[a0_0x21b1f6(0x149)](a0_0x21b1f6(0x12a),auth,async(_0x358c2e,_0x24bb7a)=>{const _0x5549aa=a0_0x21b1f6;try{const {username:_0x24dadf,email:_0x4610e4,role:_0x3c1d62}=_0x358c2e['user'],_0x281ce6=_0x358c2e[_0x5549aa(0x116)],_0x11c5bb=await profile[_0x5549aa(0x107)]({'email':_0x281ce6['email']}),_0x437eb3=await master_shop['find']();console[_0x5549aa(0x125)](_0x5549aa(0x13e),_0x437eb3);const _0x3fcde3=await suppliers[_0x5549aa(0x13c)]();console[_0x5549aa(0x125)](_0x3fcde3);const _0x23cc89=await suppliers[_0x5549aa(0x119)]([{'$lookup':{'from':_0x5549aa(0x146),'localField':_0x5549aa(0x145),'foreignField':_0x5549aa(0x102),'as':_0x5549aa(0x151)}}]),_0x2c26b4=_0x23cc89['map'](_0x393886=>{const _0x4aac1c=_0x5549aa;console[_0x4aac1c(0x125)](_0x4aac1c(0x11e),_0x393886);var _0x3a26b6=0x0,_0x293dfa=0x0;return _0x393886[_0x4aac1c(0x151)][_0x4aac1c(0x12c)](_0x5054b0=>{const _0x389da0=_0x4aac1c;console[_0x389da0(0x125)](_0x389da0(0xef),_0x5054b0),_0x5054b0[_0x389da0(0x12d)]==_0x389da0(0x154)?_0x3a26b6+=_0x5054b0[_0x389da0(0x14c)]:_0x293dfa+=_0x5054b0[_0x389da0(0x14c)];}),_0x393886['purchase']=_0x3a26b6,_0x393886[_0x4aac1c(0x11f)]=_0x293dfa,_0x393886;});console[_0x5549aa(0x125)]('supplier.js\x20payment_data',_0x2c26b4);if(_0x437eb3[0x0][_0x5549aa(0x14d)]==_0x5549aa(0xfd)){var _0x3c0710=users[_0x5549aa(0xfe)];console[_0x5549aa(0x125)](_0x3c0710);}else{if(_0x437eb3[0x0][_0x5549aa(0x14d)]=='Hindi')var _0x3c0710=users[_0x5549aa(0x137)];else{if(_0x437eb3[0x0]['language']=='German')var _0x3c0710=users[_0x5549aa(0x152)];else{if(_0x437eb3[0x0][_0x5549aa(0x14d)]=='Spanish')var _0x3c0710=users[_0x5549aa(0x103)];else{if(_0x437eb3[0x0][_0x5549aa(0x14d)]==_0x5549aa(0x15a))var _0x3c0710=users[_0x5549aa(0x15a)];else{if(_0x437eb3[0x0][_0x5549aa(0x14d)]==_0x5549aa(0x115))var _0x3c0710=users['Portuguese'];else{if(_0x437eb3[0x0]['language']==_0x5549aa(0x141))var _0x3c0710=users['Chinese'];else{if(_0x437eb3[0x0][_0x5549aa(0x14d)]==_0x5549aa(0x111))var _0x3c0710=users[_0x5549aa(0x144)];}}}}}}}_0x24bb7a[_0x5549aa(0x136)](_0x5549aa(0x127),{'success':_0x358c2e['flash']('success'),'errors':_0x358c2e['flash']('errors'),'user':_0x3fcde3,'profile':_0x11c5bb,'master_shop':_0x437eb3,'role':_0x281ce6,'payment':_0x2c26b4,'language':_0x3c0710});}catch(_0x46f201){console['log'](_0x46f201);}}),router['post']('/view',auth,async(_0x1a3dcf,_0x9244e1)=>{const _0x1acfda=a0_0x21b1f6;try{const {name:_0x3adffc,email:_0x30979e,mobile:_0x19dda0,company:_0x96662,address:_0x95c302,receivable:_0x6d0013,payable:_0x1d9226,code:_0x40b2a2,contactperson:_0x8c6694,landline:_0x300ef1}=_0x1a3dcf[_0x1acfda(0x129)],_0x3e7674=new suppliers({'name':_0x3adffc,'email':_0x30979e,'mobile':_0x19dda0,'company':_0x96662,'address':_0x95c302,'receivable':_0x6d0013,'payable':_0x1d9226,'suppliers_code':_0x40b2a2,'contactperson':_0x8c6694,'landline':_0x300ef1}),_0x131b6d=await _0x3e7674[_0x1acfda(0x13d)]();_0x1a3dcf[_0x1acfda(0x13a)]('success',_0x1acfda(0x131)),_0x9244e1[_0x1acfda(0xf2)](_0x1acfda(0xf3));}catch(_0x2365a3){console[_0x1acfda(0x125)](_0x2365a3);}}),router['get'](a0_0x21b1f6(0x14b),auth,async(_0x2b70df,_0x5ce670)=>{const _0x2ae40b=a0_0x21b1f6;try{const {username:_0x18a297,email:_0x595f43,role:_0x2ed9bb}=_0x2b70df[_0x2ae40b(0x116)],_0xeebafa=_0x2b70df[_0x2ae40b(0x116)],_0x317b4c=await profile[_0x2ae40b(0x107)]({'email':_0xeebafa[_0x2ae40b(0x100)]}),_0x1da085=await master_shop[_0x2ae40b(0x13c)]();console[_0x2ae40b(0x125)](_0x2ae40b(0x13e),_0x1da085);const _0x323ee0=_0x2b70df[_0x2ae40b(0x11d)]['id'],_0x386ee0=await suppliers[_0x2ae40b(0x118)](_0x323ee0);console[_0x2ae40b(0x125)](_0x386ee0);if(_0x1da085[0x0][_0x2ae40b(0x14d)]=='English\x20(US)'){var _0x571c59=users[_0x2ae40b(0xfe)];console['log'](_0x571c59);}else{if(_0x1da085[0x0][_0x2ae40b(0x14d)]=='Hindi')var _0x571c59=users[_0x2ae40b(0x137)];else{if(_0x1da085[0x0]['language']=='German')var _0x571c59=users[_0x2ae40b(0x152)];else{if(_0x1da085[0x0][_0x2ae40b(0x14d)]=='Spanish')var _0x571c59=users['Spanish'];else{if(_0x1da085[0x0][_0x2ae40b(0x14d)]==_0x2ae40b(0x15a))var _0x571c59=users['French'];else{if(_0x1da085[0x0][_0x2ae40b(0x14d)]==_0x2ae40b(0x115))var _0x571c59=users[_0x2ae40b(0x109)];else{if(_0x1da085[0x0][_0x2ae40b(0x14d)]==_0x2ae40b(0x141))var _0x571c59=users[_0x2ae40b(0x141)];else{if(_0x1da085[0x0]['language']==_0x2ae40b(0x111))var _0x571c59=users[_0x2ae40b(0x144)];}}}}}}}_0x5ce670[_0x2ae40b(0x136)](_0x2ae40b(0x127),{'success':_0x2b70df['flash'](_0x2ae40b(0x138)),'errors':_0x2b70df['flash'](_0x2ae40b(0x110)),'role':_0xeebafa,'profile':_0x317b4c,'master_shop':_0x1da085,'user':_0x386ee0,'language':_0x571c59});}catch(_0x20ebde){console[_0x2ae40b(0x125)](_0x20ebde);}}),router[a0_0x21b1f6(0x10d)](a0_0x21b1f6(0x14b),auth,async(_0x39e0ef,_0x3a625c)=>{const _0x12f540=a0_0x21b1f6;try{const _0x47bc45=_0x39e0ef[_0x12f540(0x11d)]['id'],_0x197177=await suppliers[_0x12f540(0x118)](_0x47bc45),{name:_0xf6aa76,email:_0x43e4ac,mobile:_0x2ae5c0,company:_0x5dcb14,address:_0x1161e9,receivable:_0x1ca0af,payable:_0x279f88,code:_0x1c73de,contactperson:_0x358ae5,landline:_0x39e92b}=_0x39e0ef[_0x12f540(0x129)];_0x197177['name']=_0xf6aa76,_0x197177[_0x12f540(0x100)]=_0x43e4ac,_0x197177[_0x12f540(0x159)]=_0x2ae5c0,_0x197177[_0x12f540(0x13b)]=_0x5dcb14,_0x197177['address']=_0x1161e9,_0x197177['receivable']=_0x1ca0af,_0x197177[_0x12f540(0x126)]=_0x279f88,_0x197177[_0x12f540(0x140)]=_0x1c73de,_0x197177[_0x12f540(0x117)]=_0x358ae5,_0x197177[_0x12f540(0x12f)]=_0x39e92b;const _0x59f6f1=await _0x197177[_0x12f540(0x13d)]();_0x39e0ef[_0x12f540(0x13a)](_0x12f540(0x138),_0x12f540(0xf5)),_0x3a625c['redirect'](_0x12f540(0xf3));}catch(_0x49e39c){console[_0x12f540(0x125)](_0x49e39c);}}),router[a0_0x21b1f6(0x149)](a0_0x21b1f6(0xfa),auth,async(_0xc29e9,_0x19ea82)=>{const _0x11ee3b=a0_0x21b1f6;try{const {username:_0x13f1c0,email:_0x5edbd5,role:_0x45501f}=_0xc29e9[_0x11ee3b(0x116)],_0x508944=_0xc29e9['user'],_0x4fa1ba=await profile['findOne']({'email':_0x508944[_0x11ee3b(0x100)]}),_0x2997db=await master_shop[_0x11ee3b(0x13c)]();console[_0x11ee3b(0x125)]('master',_0x2997db),console[_0x11ee3b(0x125)](_0xc29e9[_0x11ee3b(0x11d)]['id']);const _0x184592=await suppliers[_0x11ee3b(0x107)]({'_id':_0xc29e9[_0x11ee3b(0x11d)]['id']});console[_0x11ee3b(0x125)](_0x184592);const _0x969384=await s_payment_data[_0x11ee3b(0x13c)]({'suppliers':_0x184592['name']});console['log'](_0x969384);const _0x408e7c=await s_payment_data['aggregate']([{'$match':{'suppliers':_0x184592['name']}},{'$match':{'reason':'Purchase'}},{'$group':{'_id':_0x11ee3b(0xf6),'sum':{'$sum':_0x11ee3b(0xf8)}}}]);console[_0x11ee3b(0x125)](_0x11ee3b(0x148),_0x408e7c);const _0xaca959=await s_payment_data[_0x11ee3b(0x119)]([{'$match':{'suppliers':_0x184592['name']}},{'$match':{'reason':_0x11ee3b(0x155)}},{'$group':{'_id':_0x11ee3b(0xf6),'sum':{'$sum':'$amount'}}}]);console['log'](_0x11ee3b(0x108),_0xaca959);if(_0x2997db[0x0]['language']=='English\x20(US)'){var _0x42fbe9=users[_0x11ee3b(0xfe)];console['log'](_0x42fbe9);}else{if(_0x2997db[0x0][_0x11ee3b(0x14d)]=='Hindi')var _0x42fbe9=users[_0x11ee3b(0x137)];else{if(_0x2997db[0x0][_0x11ee3b(0x14d)]=='German')var _0x42fbe9=users[_0x11ee3b(0x152)];else{if(_0x2997db[0x0]['language']==_0x11ee3b(0x103))var _0x42fbe9=users[_0x11ee3b(0x103)];else{if(_0x2997db[0x0]['language']==_0x11ee3b(0x15a))var _0x42fbe9=users[_0x11ee3b(0x15a)];else{if(_0x2997db[0x0][_0x11ee3b(0x14d)]=='Portuguese\x20(BR)')var _0x42fbe9=users[_0x11ee3b(0x109)];else{if(_0x2997db[0x0][_0x11ee3b(0x14d)]==_0x11ee3b(0x141))var _0x42fbe9=users[_0x11ee3b(0x141)];else{if(_0x2997db[0x0][_0x11ee3b(0x14d)]=='Arabic\x20(ae)')var _0x42fbe9=users[_0x11ee3b(0x144)];}}}}}}}_0x19ea82[_0x11ee3b(0x136)](_0x11ee3b(0x120),{'success':_0xc29e9[_0x11ee3b(0x13a)](_0x11ee3b(0x138)),'errors':_0xc29e9[_0x11ee3b(0x13a)](_0x11ee3b(0x110)),'role':_0x508944,'profile':_0x4fa1ba,'master_shop':_0x2997db,'payment':_0x969384,'payable':_0x408e7c,'receivable':_0xaca959,'language':_0x42fbe9});}catch(_0x42fa3a){console[_0x11ee3b(0x125)](_0x42fa3a);}}),router[a0_0x21b1f6(0x149)](a0_0x21b1f6(0xfc),auth,async(_0x8952d8,_0x1a4431)=>{const _0x357d34=a0_0x21b1f6;try{const _0x301c15=new excelJS['Workbook'](),_0xe7589f=_0x301c15[_0x357d34(0x157)](_0x357d34(0x124));return _0xe7589f[_0x357d34(0x106)]=[{'header':_0x357d34(0x12e),'key':'PBrands','width':0xa},{'header':'Supplier_Code','key':_0x357d34(0x15b),'width':0xa},{'header':_0x357d34(0x123),'key':_0x357d34(0xf0),'width':0xa},{'header':_0x357d34(0x13f),'key':_0x357d34(0x122),'width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':_0x357d34(0x122),'key':'email','width':0xa}],_0x1a4431[_0x357d34(0xf1)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x1a4431[_0x357d34(0xf1)]('Content-Disposition',_0x357d34(0xff)),_0x301c15[_0x357d34(0x156)]['write'](_0x1a4431)[_0x357d34(0xfb)](()=>{_0x1a4431['status'](0xc8);});}catch(_0x50ae31){_0x1a4431['status'](0x190)['send']({'errors':_0x50ae31['message']});}});function a0_0x35a8(){const _0x3d4c82=['payable_sum','get','20pFWplo','/view/:id','amount','language','supplier_product_file','../models/all_models','/supplier_import_migrate_file','suppliers_docs','German','utils','Purchase','Purchase\x20Return','xlsx','addWorksheet','1432STsBci','mobile','French','PUnits','doc','SalesmanName','setHeader','redirect','/supplier/view','3133446aAsSkN','supplier\x20data\x20update\x20successfully','$reason','exports','$amount','filename','/view/payment/:id','then','/products_export_migrate_file','English\x20(US)','English','attachment;\x20filename=supplier_Migration_File.xlsx','email','6WJuloh','suppliers','Spanish','77708LOCXcV','19847660oCtffa','columns','findOne','receivable_sum','Portuguese','4204280NPRDmD','\x20added\x20successfully','\x20Failed','post','public/Migration/','7921287XggmFv','errors','Arabic\x20(ae)','now','readFile','express','Portuguese\x20(BR)','user','contactperson','findById','aggregate','status','single','message','params','data','purchase_return','supplier_payment','../middleware/auth','address','Email','Customers','log','payable','supplier','Company_Name','body','/view','public/Migration','forEach','reason','Name','landline','json','supplier\x20data\x20add\x20successfully','error','42525GRLizW','SheetNames','1217382UxqxyF','render','Hindi','success','originalname','flash','company','find','save','master','Mobile_number','suppliers_code','Chinese','Router','sheet_to_json','Arabic','name','s_payments','diskStorage'];a0_0x35a8=function(){return _0x3d4c82;};return a0_0x35a8();}const storage1=multer[a0_0x21b1f6(0x147)]({'destination':(_0x13863c,_0x24a0c2,_0x472afc)=>{const _0x380fcb=a0_0x21b1f6;_0x472afc(null,_0x380fcb(0x12b));},'filename':(_0x19e393,_0x54384f,_0x5a052e)=>{const _0x1ebf45=a0_0x21b1f6;_0x5a052e(null,Date[_0x1ebf45(0x112)]()+_0x54384f[_0x1ebf45(0x139)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x1ffb(_0x3cea98,_0x1f497d){const _0x35a856=a0_0x35a8();return a0_0x1ffb=function(_0x1ffba5,_0xddd755){_0x1ffba5=_0x1ffba5-0xef;let _0x18425d=_0x35a856[_0x1ffba5];return _0x18425d;},a0_0x1ffb(_0x3cea98,_0x1f497d);}router[a0_0x21b1f6(0x10d)](a0_0x21b1f6(0x150),auth,uploadMigrate[a0_0x21b1f6(0x11b)](a0_0x21b1f6(0x14e)),async(_0x1f1ffc,_0x496ffa)=>{const _0x20325e=a0_0x21b1f6,_0x500157=_0x1f1ffc['file'][_0x20325e(0xf9)],_0x5a09b8=await xlsx[_0x20325e(0x113)](_0x20325e(0x10e)+_0x500157);let _0x3b430a=_0x5a09b8[_0x20325e(0x134)],_0xc65071=xlsx[_0x20325e(0x153)][_0x20325e(0x143)](_0x5a09b8['Sheets'][_0x3b430a[0x0]]);for(const _0x3f597e of _0xc65071){const _0x4c56d9=_0x3f597e['Name'],_0x304d6f=_0x3f597e['Supplier_Code'],_0xcdd3d=_0x3f597e[_0x20325e(0x122)],_0x40cf08=_0x3f597e['Mobile_number'],_0x2bd570=_0x3f597e['Email'],_0x3109e1=_0x3f597e[_0x20325e(0x128)];try{let _0x582225=await suppliers[_0x20325e(0x107)]({'name':_0x4c56d9});if(!_0x582225){const _0x2f949e=new suppliers({'name':_0x4c56d9,'suppliers_code':_0x304d6f,'address':_0xcdd3d,'mobile':_0x40cf08,'email':_0x2bd570,'company':_0x3109e1});_0x582225=await _0x2f949e[_0x20325e(0x13d)](),_0x1f1ffc['flash'](_0x20325e(0x138),_0x4c56d9+_0x20325e(0x10b));}else _0x1f1ffc[_0x20325e(0x13a)](_0x20325e(0x132),_0x4c56d9+_0x20325e(0x10c));}catch(_0x429996){_0x496ffa[_0x20325e(0x11a)](0x1f4)[_0x20325e(0x130)]({'proderror':_0x429996[_0x20325e(0x11c)],'aproduct':ProductName});}}_0x496ffa[_0x20325e(0xf2)](_0x20325e(0xf3));}),module[a0_0x21b1f6(0xf7)]=router;