const a0_0x46011e=a0_0xefdb;function a0_0x36a2(){const _0x4b8878=['exports','filename','send','sheet_to_json','1316592ROGSHi','German','name','json','Sheets','mobile','originalname','body','post','redirect','master','file','suppliers_docs','user','payable_sum','render','public/Migration/','log','address','diskStorage','Hindi','flash','supplier_payment','suppliers_code','suppliers','PUnits','status','reason','attachment;\x20filename=supplier_Migration_File.xlsx','Purchase','Purchase\x20Return','/supplier_import_migrate_file','/supplier/view','Customers','language','Spanish','find','receivable','\x20added\x20successfully','amount','supplier\x20data\x20update\x20successfully','express','write','forEach','columns','setHeader','multer','email','save','2dBcodi','/view','Router','12681832WnJBkz','Email','/products_export_migrate_file','Name','utils','s_payments','exceljs','errors','PBrands','1559276mbvXje','purchase_return','get','findById','348933MkPJzA','6455547vXjmHz','aggregate','public/Migration','company','../public/language/languages.json','/view/payment/:id','addWorksheet','Workbook','supplier_product_file','landline','2979855SbCCZG','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','contactperson','1285842sPXMxE','English','params','../models/all_models','/view/:id','English\x20(US)','Portuguese','supplier.js\x20payment_data','purchase','Mobile_number','Supplier_Code','supplier\x20data\x20add\x20successfully','supplier','success','\x20Failed','Arabic\x20(ae)','data','Arabic','$amount','receivable_sum','now','../middleware/auth','$reason','then','SalesmanName','Chinese','findOne','Portuguese\x20(BR)','Company_Name','xlsx','message','readFile','French'];a0_0x36a2=function(){return _0x4b8878;};return a0_0x36a2();}(function(_0x1522c8,_0x2a6cc2){const _0x419d6a=a0_0xefdb,_0x423fb3=_0x1522c8();while(!![]){try{const _0x37233a=-parseInt(_0x419d6a(0x154))/0x1*(-parseInt(_0x419d6a(0x144))/0x2)+-parseInt(_0x419d6a(0x187))/0x3+-parseInt(_0x419d6a(0x150))/0x4+parseInt(_0x419d6a(0x15f))/0x5+-parseInt(_0x419d6a(0x162))/0x6+-parseInt(_0x419d6a(0x155))/0x7+parseInt(_0x419d6a(0x147))/0x8;if(_0x37233a===_0x2a6cc2)break;else _0x423fb3['push'](_0x423fb3['shift']());}catch(_0x4cda38){_0x423fb3['push'](_0x423fb3['shift']());}}}(a0_0x36a2,0x89eba));const express=require(a0_0x46011e(0x13c)),app=express(),router=express[a0_0x46011e(0x146)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x46011e(0x165)),auth=require(a0_0x46011e(0x177)),users=require(a0_0x46011e(0x159)),excelJS=require(a0_0x46011e(0x14d)),xlsx=require('xlsx'),multer=require(a0_0x46011e(0x141));router[a0_0x46011e(0x152)](a0_0x46011e(0x145),auth,async(_0x468627,_0xfbd5eb)=>{const _0x1dd726=a0_0x46011e;try{const {username:_0x136860,email:_0x42835b,role:_0x18cb78}=_0x468627[_0x1dd726(0x120)],_0x5508ff=_0x468627[_0x1dd726(0x120)],_0x3b4653=await profile[_0x1dd726(0x17c)]({'email':_0x5508ff[_0x1dd726(0x142)]}),_0x4b12c7=await master_shop['find']();console[_0x1dd726(0x124)]('master',_0x4b12c7);const _0x1ce2ef=await suppliers[_0x1dd726(0x137)]();console['log'](_0x1ce2ef);const _0x1ace01=await suppliers[_0x1dd726(0x156)]([{'$lookup':{'from':_0x1dd726(0x14c),'localField':_0x1dd726(0x115),'foreignField':_0x1dd726(0x12b),'as':_0x1dd726(0x11f)}}]),_0x253ceb=_0x1ace01['map'](_0x27013b=>{const _0x100c49=_0x1dd726;console[_0x100c49(0x124)](_0x100c49(0x172),_0x27013b);var _0x406ef5=0x0,_0x1a8df3=0x0;return _0x27013b['suppliers_docs'][_0x100c49(0x13e)](_0x4713ac=>{const _0x5d180d=_0x100c49;console['log']('doc',_0x4713ac),_0x4713ac[_0x5d180d(0x12e)]==_0x5d180d(0x130)?_0x406ef5+=_0x4713ac[_0x5d180d(0x13a)]:_0x1a8df3+=_0x4713ac['amount'];}),_0x27013b[_0x100c49(0x16a)]=_0x406ef5,_0x27013b[_0x100c49(0x151)]=_0x1a8df3,_0x27013b;});console[_0x1dd726(0x124)](_0x1dd726(0x169),_0x253ceb);if(_0x4b12c7[0x0]['language']==_0x1dd726(0x167)){var _0x20aa3e=users['English'];console[_0x1dd726(0x124)](_0x20aa3e);}else{if(_0x4b12c7[0x0][_0x1dd726(0x135)]==_0x1dd726(0x127))var _0x20aa3e=users['Hindi'];else{if(_0x4b12c7[0x0]['language']==_0x1dd726(0x188))var _0x20aa3e=users[_0x1dd726(0x188)];else{if(_0x4b12c7[0x0][_0x1dd726(0x135)]==_0x1dd726(0x136))var _0x20aa3e=users[_0x1dd726(0x136)];else{if(_0x4b12c7[0x0][_0x1dd726(0x135)]==_0x1dd726(0x182))var _0x20aa3e=users[_0x1dd726(0x182)];else{if(_0x4b12c7[0x0][_0x1dd726(0x135)]=='Portuguese\x20(BR)')var _0x20aa3e=users[_0x1dd726(0x168)];else{if(_0x4b12c7[0x0][_0x1dd726(0x135)]==_0x1dd726(0x17b))var _0x20aa3e=users[_0x1dd726(0x17b)];else{if(_0x4b12c7[0x0][_0x1dd726(0x135)]=='Arabic\x20(ae)')var _0x20aa3e=users[_0x1dd726(0x173)];}}}}}}}_0xfbd5eb[_0x1dd726(0x122)](_0x1dd726(0x16e),{'success':_0x468627[_0x1dd726(0x128)](_0x1dd726(0x16f)),'errors':_0x468627[_0x1dd726(0x128)](_0x1dd726(0x14e)),'user':_0x1ce2ef,'profile':_0x3b4653,'master_shop':_0x4b12c7,'role':_0x5508ff,'payment':_0x253ceb,'language':_0x20aa3e});}catch(_0x5a0a8e){console[_0x1dd726(0x124)](_0x5a0a8e);}}),router[a0_0x46011e(0x11b)]('/view',auth,async(_0x4d69b6,_0x5861ec)=>{const _0x24b7cc=a0_0x46011e;try{const {name:_0xdccacc,email:_0x18c339,mobile:_0xab6544,company:_0x5aafe2,address:_0x2ec3c1,receivable:_0x223b39,payable:_0x5cf397,code:_0x40ceb2,contactperson:_0x4093ac,landline:_0x5d5f9b}=_0x4d69b6[_0x24b7cc(0x11a)],_0x9e0d48=new suppliers({'name':_0xdccacc,'email':_0x18c339,'mobile':_0xab6544,'company':_0x5aafe2,'address':_0x2ec3c1,'receivable':_0x223b39,'payable':_0x5cf397,'suppliers_code':_0x40ceb2,'contactperson':_0x4093ac,'landline':_0x5d5f9b}),_0x12dbf7=await _0x9e0d48[_0x24b7cc(0x143)]();_0x4d69b6[_0x24b7cc(0x128)](_0x24b7cc(0x16f),_0x24b7cc(0x16d)),_0x5861ec[_0x24b7cc(0x11c)](_0x24b7cc(0x133));}catch(_0x2bfc24){console[_0x24b7cc(0x124)](_0x2bfc24);}}),router[a0_0x46011e(0x152)]('/view/:id',auth,async(_0x21be3c,_0x43e8d9)=>{const _0x34ac08=a0_0x46011e;try{const {username:_0x1bf36f,email:_0x51303e,role:_0x591343}=_0x21be3c['user'],_0x2e5f85=_0x21be3c[_0x34ac08(0x120)],_0x86716f=await profile['findOne']({'email':_0x2e5f85[_0x34ac08(0x142)]}),_0xf76dd3=await master_shop[_0x34ac08(0x137)]();console[_0x34ac08(0x124)](_0x34ac08(0x11d),_0xf76dd3);const _0xae5a16=_0x21be3c['params']['id'],_0xf9ea93=await suppliers[_0x34ac08(0x153)](_0xae5a16);console['log'](_0xf9ea93);if(_0xf76dd3[0x0]['language']==_0x34ac08(0x167)){var _0x376daa=users[_0x34ac08(0x163)];console[_0x34ac08(0x124)](_0x376daa);}else{if(_0xf76dd3[0x0]['language']==_0x34ac08(0x127))var _0x376daa=users[_0x34ac08(0x127)];else{if(_0xf76dd3[0x0][_0x34ac08(0x135)]==_0x34ac08(0x188))var _0x376daa=users['German'];else{if(_0xf76dd3[0x0][_0x34ac08(0x135)]==_0x34ac08(0x136))var _0x376daa=users[_0x34ac08(0x136)];else{if(_0xf76dd3[0x0][_0x34ac08(0x135)]=='French')var _0x376daa=users[_0x34ac08(0x182)];else{if(_0xf76dd3[0x0][_0x34ac08(0x135)]==_0x34ac08(0x17d))var _0x376daa=users[_0x34ac08(0x168)];else{if(_0xf76dd3[0x0][_0x34ac08(0x135)]==_0x34ac08(0x17b))var _0x376daa=users['Chinese'];else{if(_0xf76dd3[0x0][_0x34ac08(0x135)]==_0x34ac08(0x171))var _0x376daa=users[_0x34ac08(0x173)];}}}}}}}_0x43e8d9[_0x34ac08(0x122)]('supplier',{'success':_0x21be3c[_0x34ac08(0x128)](_0x34ac08(0x16f)),'errors':_0x21be3c[_0x34ac08(0x128)](_0x34ac08(0x14e)),'role':_0x2e5f85,'profile':_0x86716f,'master_shop':_0xf76dd3,'user':_0xf9ea93,'language':_0x376daa});}catch(_0x2c73ec){console[_0x34ac08(0x124)](_0x2c73ec);}}),router['post'](a0_0x46011e(0x166),auth,async(_0x2fa1ef,_0x3f0328)=>{const _0x5b1d41=a0_0x46011e;try{const _0x3e26d4=_0x2fa1ef[_0x5b1d41(0x164)]['id'],_0x5b62e9=await suppliers[_0x5b1d41(0x153)](_0x3e26d4),{name:_0x8a4ee0,email:_0x1f2139,mobile:_0x171c0c,company:_0x1f821c,address:_0x1e6589,receivable:_0x330085,payable:_0x472db1,code:_0x11d15b,contactperson:_0x32f417,landline:_0x22659b}=_0x2fa1ef[_0x5b1d41(0x11a)];_0x5b62e9['name']=_0x8a4ee0,_0x5b62e9[_0x5b1d41(0x142)]=_0x1f2139,_0x5b62e9[_0x5b1d41(0x118)]=_0x171c0c,_0x5b62e9[_0x5b1d41(0x158)]=_0x1f821c,_0x5b62e9[_0x5b1d41(0x125)]=_0x1e6589,_0x5b62e9[_0x5b1d41(0x138)]=_0x330085,_0x5b62e9['payable']=_0x472db1,_0x5b62e9[_0x5b1d41(0x12a)]=_0x11d15b,_0x5b62e9[_0x5b1d41(0x161)]=_0x32f417,_0x5b62e9[_0x5b1d41(0x15e)]=_0x22659b;const _0x38c6a4=await _0x5b62e9[_0x5b1d41(0x143)]();_0x2fa1ef[_0x5b1d41(0x128)](_0x5b1d41(0x16f),_0x5b1d41(0x13b)),_0x3f0328[_0x5b1d41(0x11c)](_0x5b1d41(0x133));}catch(_0x5a8c2e){console[_0x5b1d41(0x124)](_0x5a8c2e);}}),router[a0_0x46011e(0x152)](a0_0x46011e(0x15a),auth,async(_0x3976a2,_0x321d5d)=>{const _0x521708=a0_0x46011e;try{const {username:_0x37cd3c,email:_0x2f687c,role:_0x155f24}=_0x3976a2[_0x521708(0x120)],_0x39f350=_0x3976a2['user'],_0x370a0d=await profile[_0x521708(0x17c)]({'email':_0x39f350[_0x521708(0x142)]}),_0x5cfd94=await master_shop[_0x521708(0x137)]();console[_0x521708(0x124)](_0x521708(0x11d),_0x5cfd94),console['log'](_0x3976a2[_0x521708(0x164)]['id']);const _0x463e3a=await suppliers['findOne']({'_id':_0x3976a2[_0x521708(0x164)]['id']});console['log'](_0x463e3a);const _0x9b2c1d=await s_payment_data['find']({'suppliers':_0x463e3a['name']});console[_0x521708(0x124)](_0x9b2c1d);const _0xfd6652=await s_payment_data[_0x521708(0x156)]([{'$match':{'suppliers':_0x463e3a['name']}},{'$match':{'reason':_0x521708(0x130)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x521708(0x174)}}}]);console[_0x521708(0x124)](_0x521708(0x121),_0xfd6652);const _0x2fca40=await s_payment_data[_0x521708(0x156)]([{'$match':{'suppliers':_0x463e3a[_0x521708(0x115)]}},{'$match':{'reason':_0x521708(0x131)}},{'$group':{'_id':_0x521708(0x178),'sum':{'$sum':_0x521708(0x174)}}}]);console['log'](_0x521708(0x175),_0x2fca40);if(_0x5cfd94[0x0][_0x521708(0x135)]=='English\x20(US)'){var _0x48257d=users[_0x521708(0x163)];console[_0x521708(0x124)](_0x48257d);}else{if(_0x5cfd94[0x0]['language']==_0x521708(0x127))var _0x48257d=users[_0x521708(0x127)];else{if(_0x5cfd94[0x0][_0x521708(0x135)]==_0x521708(0x188))var _0x48257d=users[_0x521708(0x188)];else{if(_0x5cfd94[0x0][_0x521708(0x135)]=='Spanish')var _0x48257d=users[_0x521708(0x136)];else{if(_0x5cfd94[0x0][_0x521708(0x135)]==_0x521708(0x182))var _0x48257d=users['French'];else{if(_0x5cfd94[0x0][_0x521708(0x135)]==_0x521708(0x17d))var _0x48257d=users[_0x521708(0x168)];else{if(_0x5cfd94[0x0][_0x521708(0x135)]=='Chinese')var _0x48257d=users[_0x521708(0x17b)];else{if(_0x5cfd94[0x0][_0x521708(0x135)]==_0x521708(0x171))var _0x48257d=users[_0x521708(0x173)];}}}}}}}_0x321d5d['render'](_0x521708(0x129),{'success':_0x3976a2[_0x521708(0x128)](_0x521708(0x16f)),'errors':_0x3976a2[_0x521708(0x128)]('errors'),'role':_0x39f350,'profile':_0x370a0d,'master_shop':_0x5cfd94,'payment':_0x9b2c1d,'payable':_0xfd6652,'receivable':_0x2fca40,'language':_0x48257d});}catch(_0x110f8f){console[_0x521708(0x124)](_0x110f8f);}}),router[a0_0x46011e(0x152)](a0_0x46011e(0x149),auth,async(_0x18606f,_0x5888c5)=>{const _0x156565=a0_0x46011e;try{const _0x1698c5=new excelJS[(_0x156565(0x15c))](),_0x557b7f=_0x1698c5[_0x156565(0x15b)](_0x156565(0x134));return _0x557b7f[_0x156565(0x13f)]=[{'header':_0x156565(0x14a),'key':_0x156565(0x14f),'width':0xa},{'header':_0x156565(0x16c),'key':_0x156565(0x12c),'width':0xa},{'header':_0x156565(0x148),'key':_0x156565(0x17a),'width':0xa},{'header':_0x156565(0x16b),'key':'address','width':0xa},{'header':'Company_Name','key':'mobile','width':0xa},{'header':'address','key':_0x156565(0x142),'width':0xa}],_0x5888c5[_0x156565(0x140)]('Content-Type',_0x156565(0x160)),_0x5888c5[_0x156565(0x140)]('Content-Disposition',_0x156565(0x12f)),_0x1698c5[_0x156565(0x17f)][_0x156565(0x13d)](_0x5888c5)[_0x156565(0x179)](()=>{const _0x382344=_0x156565;_0x5888c5[_0x382344(0x12d)](0xc8);});}catch(_0x42accf){_0x5888c5[_0x156565(0x12d)](0x190)[_0x156565(0x185)]({'errors':_0x42accf[_0x156565(0x180)]});}});function a0_0xefdb(_0x525c68,_0x204cb0){const _0x36a209=a0_0x36a2();return a0_0xefdb=function(_0xefdb91,_0xd3bb34){_0xefdb91=_0xefdb91-0x115;let _0x212bf6=_0x36a209[_0xefdb91];return _0x212bf6;},a0_0xefdb(_0x525c68,_0x204cb0);}const storage1=multer[a0_0x46011e(0x126)]({'destination':(_0x13e50d,_0x1b31db,_0x4a4384)=>{const _0x555fc7=a0_0x46011e;_0x4a4384(null,_0x555fc7(0x157));},'filename':(_0x324fee,_0xb07b8d,_0x10e63e)=>{const _0x59c485=a0_0x46011e;_0x10e63e(null,Date[_0x59c485(0x176)]()+_0xb07b8d[_0x59c485(0x119)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x46011e(0x11b)](a0_0x46011e(0x132),auth,uploadMigrate['single'](a0_0x46011e(0x15d)),async(_0xc6e18a,_0x55d51c)=>{const _0x437405=a0_0x46011e,_0x53e9f8=_0xc6e18a[_0x437405(0x11e)][_0x437405(0x184)],_0x4d28b3=await xlsx[_0x437405(0x181)](_0x437405(0x123)+_0x53e9f8);let _0x406d30=_0x4d28b3['SheetNames'],_0x2e817e=xlsx[_0x437405(0x14b)][_0x437405(0x186)](_0x4d28b3[_0x437405(0x117)][_0x406d30[0x0]]);for(const _0x51ea39 of _0x2e817e){const _0x266220=_0x51ea39[_0x437405(0x14a)],_0x6aa3cd=_0x51ea39[_0x437405(0x16c)],_0x460477=_0x51ea39[_0x437405(0x125)],_0x5dfac7=_0x51ea39[_0x437405(0x16b)],_0x59817f=_0x51ea39[_0x437405(0x148)],_0x34a31c=_0x51ea39[_0x437405(0x17e)];try{let _0x3c58a3=await suppliers['findOne']({'name':_0x266220});if(!_0x3c58a3){const _0x8f08d8=new suppliers({'name':_0x266220,'suppliers_code':_0x6aa3cd,'address':_0x460477,'mobile':_0x5dfac7,'email':_0x59817f,'company':_0x34a31c});_0x3c58a3=await _0x8f08d8[_0x437405(0x143)](),_0xc6e18a[_0x437405(0x128)](_0x437405(0x16f),_0x266220+_0x437405(0x139));}else _0xc6e18a[_0x437405(0x128)]('error',_0x266220+_0x437405(0x170));}catch(_0x5cc642){_0x55d51c[_0x437405(0x12d)](0x1f4)[_0x437405(0x116)]({'proderror':_0x5cc642[_0x437405(0x180)],'aproduct':ProductName});}}_0x55d51c[_0x437405(0x11c)](_0x437405(0x133));}),module[a0_0x46011e(0x183)]=router;