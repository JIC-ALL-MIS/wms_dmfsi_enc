const a0_0x21bd06=a0_0x3a70;function a0_0x3179(){const _0xd0fbcc=['Logo.png','Password\x20Successfuly\x20Reset\x20-\x20','422tIVccW','sendMail','Error\x20Occurs','Email\x20sent\x20successfully','site_title','10WHMqhZ','/login/','hash','email','</h5>','log','logo','redirect','post','find','ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789','/upload/','2114rCiRqX','True','nodemailer','exports','express','body','</b></h1></p>','</head><body>','4211480ylgzyy','/code/','save','port','202671hhIhQv','2808744PzwUNd','flash','host','/view','success','26688moqVBq','False','/forgotPassword/view','<!DOCTYPE\x20html>','/../public','/forgotPassword/code/','<hr\x20class=\x22my-3\x22>','</div>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<h5>','random','password','395OOKdqw','render','email_reset','../middleware/auth','../models/all_models','findOne','<p>Hello,\x20<br>\x20We\x20have\x20sent\x20you\x20this\x20email\x20in\x20response\x20to\x20your\x20request\x20to\x20reset\x20please\x20copy\x20this\x20code\x20<h1><b>','2973FTBzEj','Email\x20Not\x20Found\x20please\x20check\x20your\x20email','Password\x20Reset\x20-\x20','errors','error','2396lqBtSU','6649819TFqYtK','length','<html><head><title></title>','get','/code_password/','floor','name','<div>','</body></html>','json','<strong>\x20Regards\x20</strong>'];a0_0x3179=function(){return _0xd0fbcc;};return a0_0x3179();}(function(_0x415fa4,_0x290964){const _0x1ecdae=a0_0x3a70,_0xf3b22d=_0x415fa4();while(!![]){try{const _0x85b5cc=parseInt(_0x1ecdae(0x1b3))/0x1*(parseInt(_0x1ecdae(0x17b))/0x2)+parseInt(_0x1ecdae(0x1a0))/0x3*(parseInt(_0x1ecdae(0x1a5))/0x4)+parseInt(_0x1ecdae(0x199))/0x5*(-parseInt(_0x1ecdae(0x18d))/0x6)+-parseInt(_0x1ecdae(0x183))/0x7+-parseInt(_0x1ecdae(0x188))/0x8+parseInt(_0x1ecdae(0x187))/0x9*(-parseInt(_0x1ecdae(0x1b8))/0xa)+parseInt(_0x1ecdae(0x1a6))/0xb;if(_0x85b5cc===_0x290964)break;else _0xf3b22d['push'](_0xf3b22d['shift']());}catch(_0x32137c){_0xf3b22d['push'](_0xf3b22d['shift']());}}}(a0_0x3179,0x4d86c));const express=require(a0_0x21bd06(0x17f)),app=express(),router=express['Router'](),bcrypt=require('bcryptjs'),{sing_up,staff,profile,master_shop,email_settings}=require(a0_0x21bd06(0x19d)),auth=require(a0_0x21bd06(0x19c)),nodemailer=require(a0_0x21bd06(0x17d));function a0_0x3a70(_0x1830d8,_0xf04e4){const _0x3179e2=a0_0x3179();return a0_0x3a70=function(_0x3a7036,_0x21a902){_0x3a7036=_0x3a7036-0x172;let _0x263ee3=_0x3179e2[_0x3a7036];return _0x263ee3;},a0_0x3a70(_0x1830d8,_0xf04e4);}router[a0_0x21bd06(0x1a9)](a0_0x21bd06(0x18b),async(_0x236ce9,_0x5eeeb7)=>{const _0x406377=a0_0x21bd06,_0x2958ca=await master_shop['find']();_0x5eeeb7[_0x406377(0x19a)](_0x406377(0x19b),{'success':_0x236ce9[_0x406377(0x189)](_0x406377(0x18c)),'errors':_0x236ce9[_0x406377(0x189)]('errors'),'master_shop':_0x2958ca});});function generateRandomAlphanumericString(_0xf02369=0x6){const _0x178971=a0_0x21bd06,_0x2af03d=_0x178971(0x179);let _0x2336ec='';for(let _0x25acc0=0x0;_0x25acc0<_0xf02369;_0x25acc0++){const _0xce544c=Math[_0x178971(0x1ab)](Math[_0x178971(0x197)]()*_0x2af03d['length']);_0x2336ec+=_0x2af03d[_0xce544c];}return _0x2336ec;}router[a0_0x21bd06(0x177)](a0_0x21bd06(0x18b),async(_0x4e0ee7,_0x4396fb)=>{const _0x173599=a0_0x21bd06,{email:_0x52e2b1}=_0x4e0ee7[_0x173599(0x180)],_0x46c1b2=await sing_up[_0x173599(0x19e)]({'email':_0x52e2b1});var _0x1fbf58=generateRandomAlphanumericString();const _0x4a8602=await bcrypt['hash'](_0x1fbf58,0xa);if(_0x46c1b2){_0x46c1b2['code']=_0x1fbf58,_0x46c1b2['isUsed']='False';const _0x103a83=_0x46c1b2[_0x173599(0x185)](),_0x3d3950=await master_shop[_0x173599(0x178)](),_0x48cb01=await email_settings['findOne']();let _0x410cd5=nodemailer['createTransport']({'host':_0x48cb01[_0x173599(0x18a)],'port':Number(_0x48cb01[_0x173599(0x186)]),'secure':![],'auth':{'user':_0x48cb01[_0x173599(0x172)],'pass':_0x48cb01[_0x173599(0x198)]}}),_0x1b2e63={'from':_0x48cb01['email'],'to':_0x46c1b2[_0x173599(0x172)],'subject':_0x173599(0x1a2)+_0x3d3950[0x0][_0x173599(0x1b7)],'attachments':[{'filename':'Logo.png','path':__dirname+_0x173599(0x191)+_0x173599(0x17a)+_0x3d3950[0x0]['image'],'cid':_0x173599(0x175)}],'html':'<!DOCTYPE\x20html>'+_0x173599(0x1a8)+'</head><body>'+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x173599(0x1ad)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x173599(0x194)+_0x173599(0x194)+_0x173599(0x1ad)+_0x173599(0x19f)+_0x1fbf58+_0x173599(0x181)+_0x173599(0x194)+_0x173599(0x193)+_0x173599(0x1ad)+_0x173599(0x1b0)+_0x173599(0x196)+_0x3d3950[0x0][_0x173599(0x1b7)]+_0x173599(0x173)+_0x173599(0x194)+_0x173599(0x194)+_0x173599(0x1ae)};_0x410cd5['sendMail'](_0x1b2e63,function(_0x5e5a49,_0x5006bf){const _0x5780da=_0x173599;_0x5e5a49?(console[_0x5780da(0x174)](_0x5e5a49),console[_0x5780da(0x174)](_0x5780da(0x1b5))):console[_0x5780da(0x174)]('Email\x20sent\x20successfully');}),_0x4396fb[_0x173599(0x176)](_0x173599(0x192));}else _0x4e0ee7[_0x173599(0x189)](_0x173599(0x1a4),_0x173599(0x1a1)),_0x4396fb['redirect'](_0x173599(0x18f));}),router[a0_0x21bd06(0x1a9)](a0_0x21bd06(0x184),async(_0x59a325,_0x391471)=>{const _0x1c7cd7=a0_0x21bd06,_0x326ee5=await master_shop[_0x1c7cd7(0x178)]();_0x391471[_0x1c7cd7(0x19a)]('email_code',{'success':_0x59a325[_0x1c7cd7(0x189)](_0x1c7cd7(0x18c)),'errors':_0x59a325[_0x1c7cd7(0x189)](_0x1c7cd7(0x1a3)),'master_shop':_0x326ee5});}),router[a0_0x21bd06(0x177)](a0_0x21bd06(0x184),async(_0x22a025,_0x1c0347)=>{const _0x576a75=a0_0x21bd06,{code:_0x20e3bc}=_0x22a025[_0x576a75(0x180)],_0x5e4980=await sing_up[_0x576a75(0x178)]({'code':_0x20e3bc});console[_0x576a75(0x174)](_0x5e4980[_0x576a75(0x1a7)]),_0x1c0347[_0x576a75(0x1af)](_0x5e4980);}),router['post'](a0_0x21bd06(0x1aa),async(_0x360a65,_0x7b4376)=>{const _0x37cd46=a0_0x21bd06,{codex:_0x2c3e38,password:_0x55199e,cpassword:_0x2cec87,email:_0x30f61c}=_0x360a65['body'],_0x191c89=await sing_up['findOne']({'code':_0x2c3e38,'email':_0x30f61c,'isUsed':_0x37cd46(0x18e)}),_0x4017b5=await bcrypt[_0x37cd46(0x1ba)](_0x55199e,0xa);if(_0x191c89){_0x191c89[_0x37cd46(0x198)]=_0x4017b5,_0x191c89['isUsed']=_0x37cd46(0x17c);const _0x823f20=_0x191c89[_0x37cd46(0x185)](),_0x35bed5=await master_shop['find'](),_0x467012=await email_settings[_0x37cd46(0x19e)]();let _0x11f71a=nodemailer['createTransport']({'host':_0x467012['host'],'port':Number(_0x467012[_0x37cd46(0x186)]),'secure':![],'auth':{'user':_0x467012[_0x37cd46(0x172)],'pass':_0x467012[_0x37cd46(0x198)]}}),_0x4414e4={'from':_0x467012[_0x37cd46(0x172)],'to':_0x191c89[_0x37cd46(0x172)],'subject':_0x37cd46(0x1b2)+_0x35bed5[0x0][_0x37cd46(0x1b7)],'attachments':[{'filename':_0x37cd46(0x1b1),'path':__dirname+_0x37cd46(0x191)+_0x37cd46(0x17a)+_0x35bed5[0x0]['image'],'cid':'logo'}],'html':_0x37cd46(0x190)+'<html><head><title></title>'+_0x37cd46(0x182)+_0x37cd46(0x1ad)+_0x37cd46(0x195)+_0x37cd46(0x1ad)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x37cd46(0x194)+_0x37cd46(0x194)+_0x37cd46(0x1ad)+'<p>Hello\x20'+_0x191c89[_0x37cd46(0x1ac)]+',\x20<br>Your\x20password\x20has\x20been\x20successfully\x20reset.\x20You\x20can\x20now\x20log\x20in\x20with\x20your\x20new\x20password.</p>'+_0x37cd46(0x194)+_0x37cd46(0x193)+'<div>'+_0x37cd46(0x1b0)+_0x37cd46(0x196)+_0x35bed5[0x0][_0x37cd46(0x1b7)]+_0x37cd46(0x173)+'</div>'+_0x37cd46(0x194)+_0x37cd46(0x1ae)};_0x11f71a[_0x37cd46(0x1b4)](_0x4414e4,function(_0x2ab699,_0x422fd8){const _0x58aad0=_0x37cd46;_0x2ab699?(console[_0x58aad0(0x174)](_0x2ab699),console['log'](_0x58aad0(0x1b5))):console['log'](_0x58aad0(0x1b6));}),_0x7b4376[_0x37cd46(0x176)](_0x37cd46(0x1b9));}else _0x360a65[_0x37cd46(0x189)](_0x37cd46(0x1a4),_0x37cd46(0x1a1)),_0x7b4376[_0x37cd46(0x176)]('/forgotPassword/code');}),module[a0_0x21bd06(0x17e)]=router;