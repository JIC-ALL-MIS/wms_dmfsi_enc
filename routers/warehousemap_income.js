const a0_0x1c4e3a=a0_0x3d38;function a0_0x3d38(_0x2510d5,_0x1e6fd8){const _0x3a6b65=a0_0x3a6b();return a0_0x3d38=function(_0x3d387a,_0xc44239){_0x3d387a=_0x3d387a-0x11b;let _0x169c07=_0x3a6b65[_0x3d387a];return _0x169c07;},a0_0x3d38(_0x2510d5,_0x1e6fd8);}function a0_0x3a6b(){const _0x5af32a=['1861068vuwcIm','English\x20(US)','$room','550sNyuFs','render','timezone','68664TOIRnJ','../models/all_models','express','$product_details.floorlevel','Spanish','success','post','71037fSgraC','$products','timezones-list','$product_details.type','/view','$product_details.expiry_date','Arabic\x20(ae)','DRY\x20STORAGE','warehouse','find','Raw\x20Materials','Portuguese\x20(BR)','../middleware/auth','$_id.floorlevel','Arabic','toLocaleString','status','$product_code','$product_details.production_date','findOne','650012aWKSaD','message','pack','/MapData2','English','multer','Finished\x20Goods','Hindi','$product_details.product_code','$_id','328vhXscy','4jFjEnn','email','user','$product_details.batch_code','body','$batch_code','exports','German','$_id.product','language','log','$_id.bay','aggregate','$product_details','flash','/Rooms_data2','All','$expiry_date','QA\x20Warehouse','master','17423000TqAwem','$name','Enabled','$_id.type','French','$count','json','/MapData','Return\x20Goods','/Rooms_data3','../public/language/languages.json','$product_details.bay','Chinese','en-US','2441823yoQPbd','5713043fWoMNu'];a0_0x3a6b=function(){return _0x5af32a;};return a0_0x3a6b();}(function(_0x211463,_0x5b7c3d){const _0x5d7217=a0_0x3d38,_0xfb7fb9=_0x211463();while(!![]){try{const _0x2570a8=-parseInt(_0x5d7217(0x120))/0x1*(parseInt(_0x5d7217(0x165))/0x2)+parseInt(_0x5d7217(0x142))/0x3+-parseInt(_0x5d7217(0x144))/0x4+-parseInt(_0x5d7217(0x147))/0x5*(parseInt(_0x5d7217(0x14a))/0x6)+parseInt(_0x5d7217(0x143))/0x7+parseInt(_0x5d7217(0x11f))/0x8*(parseInt(_0x5d7217(0x151))/0x9)+parseInt(_0x5d7217(0x134))/0xa;if(_0x2570a8===_0x5b7c3d)break;else _0xfb7fb9['push'](_0xfb7fb9['shift']());}catch(_0x58c1d3){_0xfb7fb9['push'](_0xfb7fb9['shift']());}}}(a0_0x3a6b,0xa4080));const express=require(a0_0x1c4e3a(0x14c)),app=express(),router=express['Router'](),multer=require(a0_0x1c4e3a(0x16a)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x1c4e3a(0x14b)),auth=require(a0_0x1c4e3a(0x15d));var timezones=require(a0_0x1c4e3a(0x153));const users=require(a0_0x1c4e3a(0x13e));router['get'](a0_0x1c4e3a(0x155),auth,async(_0xf6a6e0,_0x570858)=>{const _0x50148b=a0_0x1c4e3a;try{const {username:_0x1fccc5,email:_0x2d8b41,role:_0x1b059b}=_0xf6a6e0['user'],_0x1dbe9e=_0xf6a6e0[_0x50148b(0x122)],_0x349abe=await profile[_0x50148b(0x164)]({'email':_0x1dbe9e[_0x50148b(0x121)]}),_0x5f10f0=await master_shop[_0x50148b(0x15a)]();console[_0x50148b(0x12a)](_0x50148b(0x133),_0x5f10f0);let _0x913759;if(_0x1dbe9e['role']=='staff'){const _0x240a5f=await staff[_0x50148b(0x164)]({'email':_0x1dbe9e[_0x50148b(0x121)]});_0x913759=await warehouse[_0x50148b(0x12c)]([{'$match':{'status':'Enabled','name':_0x240a5f[_0x50148b(0x159)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x913759=await warehouse[_0x50148b(0x12c)]([{'$match':{'status':_0x50148b(0x136)}},{'$group':{'_id':_0x50148b(0x135),'name':{'$first':_0x50148b(0x135)}}}]);const _0x131723=new Date()[_0x50148b(0x160)](_0x50148b(0x141),{'timeZone':_0x5f10f0[0x0][_0x50148b(0x149)]});console['log'](_0x50148b(0x149),_0x131723);if(_0x5f10f0[0x0][_0x50148b(0x129)]==_0x50148b(0x145)){var _0x1f12d4=users[_0x50148b(0x169)];console[_0x50148b(0x12a)](_0x1f12d4);}else{if(_0x5f10f0[0x0]['language']==_0x50148b(0x11c))var _0x1f12d4=users[_0x50148b(0x11c)];else{if(_0x5f10f0[0x0][_0x50148b(0x129)]==_0x50148b(0x127))var _0x1f12d4=users[_0x50148b(0x127)];else{if(_0x5f10f0[0x0][_0x50148b(0x129)]==_0x50148b(0x14e))var _0x1f12d4=users[_0x50148b(0x14e)];else{if(_0x5f10f0[0x0][_0x50148b(0x129)]==_0x50148b(0x138))var _0x1f12d4=users[_0x50148b(0x138)];else{if(_0x5f10f0[0x0][_0x50148b(0x129)]==_0x50148b(0x15c))var _0x1f12d4=users['Portuguese'];else{if(_0x5f10f0[0x0]['language']==_0x50148b(0x140))var _0x1f12d4=users[_0x50148b(0x140)];else{if(_0x5f10f0[0x0][_0x50148b(0x129)]==_0x50148b(0x157))var _0x1f12d4=users[_0x50148b(0x15f)];}}}}}}}_0x570858[_0x50148b(0x148)]('warehousemap_incoming',{'success':_0xf6a6e0['flash'](_0x50148b(0x14f)),'errors':_0xf6a6e0[_0x50148b(0x12e)]('errors'),'role':_0x1dbe9e,'profile':_0x349abe,'master_shop':_0x5f10f0,'timezones':timezones,'language':_0x1f12d4,'warehouse':_0x913759});}catch(_0x8b31c3){console[_0x50148b(0x12a)](_0x8b31c3),_0x570858[_0x50148b(0x161)](0xc8)[_0x50148b(0x13a)]({'message':_0x8b31c3[_0x50148b(0x166)]});}}),router['post'](a0_0x1c4e3a(0x13b),async(_0x514dcb,_0x3d874e)=>{const _0x5c29d6=a0_0x1c4e3a,{warehouseNew:_0x37080c,rooms:_0x3b43d6,Type:_0x4bbd7d}=_0x514dcb[_0x5c29d6(0x124)],_0x3307c2=await warehouse[_0x5c29d6(0x12c)]([{'$unwind':'$product_details'},{'$match':{'name':_0x37080c,'room':_0x3b43d6,'product_details.type':_0x4bbd7d}},{'$group':{'_id':{'bay':_0x5c29d6(0x13f),'bin':'$product_details.bin','type':_0x5c29d6(0x154),'floorlevel':_0x5c29d6(0x14d)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':'$product_details.product_stock','product_code':_0x5c29d6(0x11d)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':'$_id.bin','type':_0x5c29d6(0x137),'floorlevel':_0x5c29d6(0x15e),'products':{'$filter':{'input':_0x5c29d6(0x152),'as':'product','cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x3d874e[_0x5c29d6(0x13a)](_0x3307c2);}),router['post'](a0_0x1c4e3a(0x168),async(_0x12bd56,_0x56655a)=>{const _0x252461=a0_0x1c4e3a,{warehouseNew:_0x32bcfe,rooms:_0x46f8a5,room_cat:_0x2a4dc4}=_0x12bd56[_0x252461(0x124)];let _0x3d3d64;if(_0x2a4dc4==_0x252461(0x130))_0x3d3d64=await warehouse[_0x252461(0x12c)]([{'$unwind':_0x252461(0x12d)},{'$match':{'name':_0x32bcfe}},{'$group':{'_id':{'bay':_0x252461(0x13f),'product':'$product_details.product_name','expiry':_0x252461(0x156)},'count':{'$sum':'$product_details.product_stock'},'production_date':{'$first':_0x252461(0x163)},'expiry_date':{'$first':_0x252461(0x156)},'batch_code':{'$first':_0x252461(0x123)},'product_code':{'$first':_0x252461(0x11d)}}},{'$group':{'_id':_0x252461(0x12b),'products':{'$push':{'product':_0x252461(0x128),'quantity':'$count','production_date':'$production_date','expiry_date':_0x252461(0x131),'batch_code':_0x252461(0x125),'product_code':_0x252461(0x162)}},'totalQuantity':{'$sum':_0x252461(0x139)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x252461(0x12a)](_0x2a4dc4);else{}_0x56655a['json'](_0x3d3d64);}),router['post']('/Rooms_data',async(_0x218113,_0x2e4fcd)=>{const _0x98cfd5=a0_0x1c4e3a;try{const {warehouse_name:_0x314a59,A:_0x588b44,B:_0x56292b}=_0x218113[_0x98cfd5(0x124)];var _0x10d08a='';_0x588b44=='raw'?_0x56292b=='pack'?_0x10d08a=[{'$match':{'name':_0x314a59,'status':'Enabled','room':'Rack\x20A'}},{'$group':{'_id':'$_id','room_name':{'$first':_0x98cfd5(0x146)}}},{'$sort':{'room_name':0x1}}]:_0x10d08a=[{'$match':{'name':_0x314a59,'status':_0x98cfd5(0x136)}},{'$group':{'_id':_0x98cfd5(0x11e),'room_name':{'$first':_0x98cfd5(0x146)}}},{'$sort':{'room_name':0x1}}]:_0x10d08a=[{'$match':{'name':_0x314a59,'status':_0x98cfd5(0x136)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x98cfd5(0x146)}}},{'$sort':{'room_name':0x1}}];const _0x15b1c7=await warehouse[_0x98cfd5(0x12c)](_0x10d08a);_0x2e4fcd[_0x98cfd5(0x161)](0xc8)[_0x98cfd5(0x13a)](_0x15b1c7);}catch(_0x457aa8){_0x2e4fcd[_0x98cfd5(0x161)](0x190)[_0x98cfd5(0x13a)]({'errorMessage':_0x457aa8['message']});}}),router[a0_0x1c4e3a(0x150)](a0_0x1c4e3a(0x12f),async(_0x552887,_0x184b62)=>{const _0x47f466=a0_0x1c4e3a;try{const {warehouse_name:_0x314539,cat:_0x24ef98,valNew:_0x2b6a27}=_0x552887[_0x47f466(0x124)];var _0x24dc62='',_0x2873a2='';if(_0x24ef98==_0x47f466(0x15b))_0x24dc62=_0x47f466(0x13c),_0x2b6a27==_0x47f466(0x167)?_0x2873a2=[{'$match':{'status':_0x47f466(0x136),'warehouse_category':_0x24ef98,'name':{'$ne':_0x24dc62},'name':_0x47f466(0x158)}},{'$group':{'_id':_0x47f466(0x135),'room_name':{'$first':_0x47f466(0x135)}}},{'$sort':{'room_name':0x1}}]:_0x2873a2=[{'$match':{'status':'Enabled','warehouse_category':_0x24ef98,'name':{'$ne':_0x24dc62}}},{'$group':{'_id':_0x47f466(0x135),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0x24ef98==_0x47f466(0x11b)?(_0x24dc62=_0x47f466(0x132),_0x2873a2=[{'$match':{'status':_0x47f466(0x136),'warehouse_category':_0x24ef98,'name':{'$ne':_0x24dc62}}},{'$group':{'_id':_0x47f466(0x135),'room_name':{'$first':_0x47f466(0x135)}}},{'$sort':{'room_name':0x1}}]):_0x2873a2=[{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x47f466(0x135),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];const _0x4f96b3=await warehouse[_0x47f466(0x12c)](_0x2873a2);_0x184b62[_0x47f466(0x161)](0xc8)[_0x47f466(0x13a)](_0x4f96b3);}catch(_0x25b665){_0x184b62[_0x47f466(0x161)](0x190)[_0x47f466(0x13a)]({'errorMessage':_0x25b665[_0x47f466(0x166)]}),console['log'](_0x25b665);}}),router['post'](a0_0x1c4e3a(0x13d),async(_0x5175bf,_0x24dd02)=>{const _0x75b22b=a0_0x1c4e3a;try{const {warehouse_name:_0x4b5c59,cat:_0x4f2732}=_0x5175bf[_0x75b22b(0x124)],_0x57466e=await warehouse['aggregate']([{'$match':{'status':_0x75b22b(0x136),'warehouse_category':_0x4f2732,'name':_0x4b5c59}},{'$group':{'_id':'$room','room_name':{'$first':_0x75b22b(0x146)}}},{'$sort':{'room_name':0x1}}]);_0x24dd02['status'](0xc8)[_0x75b22b(0x13a)](_0x57466e);}catch(_0x85d858){_0x24dd02[_0x75b22b(0x161)](0x190)[_0x75b22b(0x13a)]({'errorMessage':_0x85d858[_0x75b22b(0x166)]});}}),module[a0_0x1c4e3a(0x126)]=router;