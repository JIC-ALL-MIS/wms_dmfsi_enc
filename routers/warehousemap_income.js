const a0_0x1d0860=a0_0x106f;(function(_0x356654,_0x468c1e){const _0x33bf54=a0_0x106f,_0x3b54ff=_0x356654();while(!![]){try{const _0x11fec4=parseInt(_0x33bf54(0x1af))/0x1*(parseInt(_0x33bf54(0x185))/0x2)+-parseInt(_0x33bf54(0x1c7))/0x3+-parseInt(_0x33bf54(0x1c5))/0x4+-parseInt(_0x33bf54(0x1a6))/0x5*(parseInt(_0x33bf54(0x1a3))/0x6)+parseInt(_0x33bf54(0x1b6))/0x7+parseInt(_0x33bf54(0x1b1))/0x8*(-parseInt(_0x33bf54(0x197))/0x9)+parseInt(_0x33bf54(0x181))/0xa;if(_0x11fec4===_0x468c1e)break;else _0x3b54ff['push'](_0x3b54ff['shift']());}catch(_0x50db29){_0x3b54ff['push'](_0x3b54ff['shift']());}}}(a0_0x1d47,0xaafd5));const express=require('express'),app=express(),router=express[a0_0x1d0860(0x18f)](),multer=require(a0_0x1d0860(0x1c8)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require('../middleware/auth');function a0_0x106f(_0x26ae82,_0x3497fe){const _0x1d473d=a0_0x1d47();return a0_0x106f=function(_0x106f89,_0x2c6821){_0x106f89=_0x106f89-0x17b;let _0x4e71a9=_0x1d473d[_0x106f89];return _0x4e71a9;},a0_0x106f(_0x26ae82,_0x3497fe);}var timezones=require(a0_0x1d0860(0x1a4));function a0_0x1d47(){const _0x1cc601=['153ubjqgq','Hindi','Finished\x20Goods','French','$products','/MapData2','$product_details','log','warehousemap_incoming','timezone','$_id.type','Rack\x20A','7986VASMAi','timezones-list','$name','4760tMEGgy','pack','All','$_id.bay','Chinese','$count','English\x20(US)','/MapData','/Rooms_data2','172181qUQVQD','render','577464itzSmm','/view','Spanish','$product_details.bay','$product_details.floorlevel','7462245FiMcnF','flash','body','$room','$product_details.expiry_date','exports','Enabled','status','staff','$product_details.type','en-US','toLocaleString','$_id','json','$production_date','5042108gYzPRp','language','4022382ZYLKaK','multer','warehouse','raw','$batch_code','$_id.floorlevel','$_id.bin','Arabic\x20(ae)','post','success','$product_details.production_date','../public/language/languages.json','Arabic','36967960pjdqkz','Portuguese\x20(BR)','message','errors','12GJCHTL','email','product','/Rooms_data','find','Return\x20Goods','Portuguese','$_id.product','$product_details.bin','aggregate','Router','QA\x20Warehouse','findOne','$product_details.batch_code','$product_details.product_name','/Rooms_data3','$product_details.product_stock','German'];a0_0x1d47=function(){return _0x1cc601;};return a0_0x1d47();}const users=require(a0_0x1d0860(0x17f));router['get'](a0_0x1d0860(0x1b2),auth,async(_0x135084,_0x45ca04)=>{const _0x3c0c88=a0_0x1d0860;try{const {username:_0x5324e8,email:_0x452d97,role:_0x21ab0b}=_0x135084['user'],_0x2d8bd8=_0x135084['user'],_0x3ff5a1=await profile[_0x3c0c88(0x191)]({'email':_0x2d8bd8[_0x3c0c88(0x186)]}),_0x8dbee1=await master_shop[_0x3c0c88(0x189)]();console[_0x3c0c88(0x19e)]('master',_0x8dbee1);let _0x55b0aa;if(_0x2d8bd8['role']==_0x3c0c88(0x1be)){const _0x2d811f=await staff['findOne']({'email':_0x2d8bd8['email']});_0x55b0aa=await warehouse[_0x3c0c88(0x18e)]([{'$match':{'status':_0x3c0c88(0x1bc),'name':_0x2d811f[_0x3c0c88(0x1c9)]}},{'$group':{'_id':'$name','name':{'$first':_0x3c0c88(0x1a5)}}}]);}else _0x55b0aa=await warehouse[_0x3c0c88(0x18e)]([{'$match':{'status':_0x3c0c88(0x1bc)}},{'$group':{'_id':_0x3c0c88(0x1a5),'name':{'$first':_0x3c0c88(0x1a5)}}}]);const _0x527956=new Date()[_0x3c0c88(0x1c1)](_0x3c0c88(0x1c0),{'timeZone':_0x8dbee1[0x0][_0x3c0c88(0x1a0)]});console[_0x3c0c88(0x19e)](_0x3c0c88(0x1a0),_0x527956);if(_0x8dbee1[0x0]['language']==_0x3c0c88(0x1ac)){var _0x40e5f3=users['English'];console[_0x3c0c88(0x19e)](_0x40e5f3);}else{if(_0x8dbee1[0x0][_0x3c0c88(0x1c6)]==_0x3c0c88(0x198))var _0x40e5f3=users[_0x3c0c88(0x198)];else{if(_0x8dbee1[0x0][_0x3c0c88(0x1c6)]==_0x3c0c88(0x196))var _0x40e5f3=users[_0x3c0c88(0x196)];else{if(_0x8dbee1[0x0][_0x3c0c88(0x1c6)]==_0x3c0c88(0x1b3))var _0x40e5f3=users[_0x3c0c88(0x1b3)];else{if(_0x8dbee1[0x0]['language']==_0x3c0c88(0x19a))var _0x40e5f3=users[_0x3c0c88(0x19a)];else{if(_0x8dbee1[0x0][_0x3c0c88(0x1c6)]==_0x3c0c88(0x182))var _0x40e5f3=users[_0x3c0c88(0x18b)];else{if(_0x8dbee1[0x0][_0x3c0c88(0x1c6)]==_0x3c0c88(0x1aa))var _0x40e5f3=users[_0x3c0c88(0x1aa)];else{if(_0x8dbee1[0x0][_0x3c0c88(0x1c6)]==_0x3c0c88(0x17b))var _0x40e5f3=users[_0x3c0c88(0x180)];}}}}}}}_0x45ca04[_0x3c0c88(0x1b0)](_0x3c0c88(0x19f),{'success':_0x135084[_0x3c0c88(0x1b7)](_0x3c0c88(0x17d)),'errors':_0x135084[_0x3c0c88(0x1b7)](_0x3c0c88(0x184)),'role':_0x2d8bd8,'profile':_0x3ff5a1,'master_shop':_0x8dbee1,'timezones':timezones,'language':_0x40e5f3,'warehouse':_0x55b0aa});}catch(_0x4f11bb){console[_0x3c0c88(0x19e)](_0x4f11bb),_0x45ca04[_0x3c0c88(0x1bd)](0xc8)[_0x3c0c88(0x1c3)]({'message':_0x4f11bb[_0x3c0c88(0x183)]});}}),router['post'](a0_0x1d0860(0x1ad),async(_0x3e1646,_0x17c3cb)=>{const _0x37c843=a0_0x1d0860,{warehouseNew:_0x503ec5,rooms:_0x2e7cc5,Type:_0x289da6}=_0x3e1646['body'],_0x5093ab=await warehouse[_0x37c843(0x18e)]([{'$unwind':_0x37c843(0x19d)},{'$match':{'name':_0x503ec5,'room':_0x2e7cc5,'product_details.type':_0x289da6}},{'$group':{'_id':{'bay':_0x37c843(0x1b4),'bin':_0x37c843(0x18d),'type':_0x37c843(0x1bf),'floorlevel':_0x37c843(0x1b5)},'products':{'$push':{'product_name':_0x37c843(0x193),'product_quantity':_0x37c843(0x195),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x37c843(0x195),0x0]},'then':_0x37c843(0x195),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':_0x37c843(0x1cd),'type':_0x37c843(0x1a1),'floorlevel':_0x37c843(0x1cc),'products':{'$filter':{'input':_0x37c843(0x19b),'as':_0x37c843(0x187),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x17c3cb[_0x37c843(0x1c3)](_0x5093ab);}),router[a0_0x1d0860(0x17c)](a0_0x1d0860(0x19c),async(_0xd1cfa7,_0x146390)=>{const _0xd882c6=a0_0x1d0860,{warehouseNew:_0x12a2a7,rooms:_0x2c37bc,room_cat:_0xdd4787}=_0xd1cfa7['body'];let _0x529b92;if(_0xdd4787==_0xd882c6(0x1a8))_0x529b92=await warehouse['aggregate']([{'$unwind':_0xd882c6(0x19d)},{'$match':{'name':_0x12a2a7}},{'$group':{'_id':{'bay':'$product_details.bay','product':_0xd882c6(0x193),'expiry':_0xd882c6(0x1ba)},'count':{'$sum':_0xd882c6(0x195)},'production_date':{'$first':_0xd882c6(0x17e)},'expiry_date':{'$first':_0xd882c6(0x1ba)},'batch_code':{'$first':_0xd882c6(0x192)},'product_code':{'$first':'$product_details.product_code'}}},{'$group':{'_id':_0xd882c6(0x1a9),'products':{'$push':{'product':_0xd882c6(0x18c),'quantity':_0xd882c6(0x1ab),'production_date':_0xd882c6(0x1c4),'expiry_date':'$expiry_date','batch_code':_0xd882c6(0x1cb),'product_code':'$product_code'}},'totalQuantity':{'$sum':_0xd882c6(0x1ab)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0xd882c6(0x1c2),'products':0x1,'totalQuantity':0x1}}]),console[_0xd882c6(0x19e)](_0xdd4787);else{}_0x146390['json'](_0x529b92);}),router[a0_0x1d0860(0x17c)](a0_0x1d0860(0x188),async(_0x18eca5,_0x321659)=>{const _0x165170=a0_0x1d0860;try{const {warehouse_name:_0x48c91f,A:_0x751afb,B:_0x58a02e}=_0x18eca5[_0x165170(0x1b8)];var _0x81c754='';_0x751afb==_0x165170(0x1ca)?_0x58a02e==_0x165170(0x1a7)?_0x81c754=[{'$match':{'name':_0x48c91f,'status':'Enabled','room':_0x165170(0x1a2)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x165170(0x1b9)}}},{'$sort':{'room_name':0x1}}]:_0x81c754=[{'$match':{'name':_0x48c91f,'status':_0x165170(0x1bc)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x165170(0x1b9)}}},{'$sort':{'room_name':0x1}}]:_0x81c754=[{'$match':{'name':_0x48c91f,'status':_0x165170(0x1bc)}},{'$group':{'_id':_0x165170(0x1c2),'room_name':{'$first':_0x165170(0x1b9)}}},{'$sort':{'room_name':0x1}}];const _0xd056fd=await warehouse['aggregate'](_0x81c754);_0x321659[_0x165170(0x1bd)](0xc8)['json'](_0xd056fd);}catch(_0x55f7ff){_0x321659[_0x165170(0x1bd)](0x190)[_0x165170(0x1c3)]({'errorMessage':_0x55f7ff[_0x165170(0x183)]});}}),router['post'](a0_0x1d0860(0x1ae),async(_0x46e176,_0x118778)=>{const _0x4702c9=a0_0x1d0860;try{const {warehouse_name:_0x5704f8,cat:_0xc4af0f,valNew:_0x22935a}=_0x46e176['body'];var _0x53a8cc='',_0x4c002d='';if(_0xc4af0f=='Raw\x20Materials')_0x53a8cc=_0x4702c9(0x18a),_0x22935a==_0x4702c9(0x1a7)?_0x4c002d=[{'$match':{'status':_0x4702c9(0x1bc),'warehouse_category':_0xc4af0f,'name':{'$ne':_0x53a8cc},'name':'DRY\x20STORAGE'}},{'$group':{'_id':_0x4702c9(0x1a5),'room_name':{'$first':_0x4702c9(0x1a5)}}},{'$sort':{'room_name':0x1}}]:_0x4c002d=[{'$match':{'status':'Enabled','warehouse_category':_0xc4af0f,'name':{'$ne':_0x53a8cc}}},{'$group':{'_id':_0x4702c9(0x1a5),'room_name':{'$first':_0x4702c9(0x1a5)}}},{'$sort':{'room_name':0x1}}];else _0xc4af0f==_0x4702c9(0x199)?(_0x53a8cc=_0x4702c9(0x190),_0x4c002d=[{'$match':{'status':'Enabled','warehouse_category':_0xc4af0f,'name':{'$ne':_0x53a8cc}}},{'$group':{'_id':_0x4702c9(0x1a5),'room_name':{'$first':_0x4702c9(0x1a5)}}},{'$sort':{'room_name':0x1}}]):_0x4c002d=[{'$match':{'status':_0x4702c9(0x1bc)}},{'$group':{'_id':_0x4702c9(0x1a5),'room_name':{'$first':_0x4702c9(0x1a5)}}},{'$sort':{'room_name':0x1}}];const _0x54f7a5=await warehouse[_0x4702c9(0x18e)](_0x4c002d);_0x118778[_0x4702c9(0x1bd)](0xc8)[_0x4702c9(0x1c3)](_0x54f7a5);}catch(_0x1826fe){_0x118778['status'](0x190)[_0x4702c9(0x1c3)]({'errorMessage':_0x1826fe[_0x4702c9(0x183)]}),console['log'](_0x1826fe);}}),router[a0_0x1d0860(0x17c)](a0_0x1d0860(0x194),async(_0x122b16,_0x3407f3)=>{const _0x3cca05=a0_0x1d0860;try{const {warehouse_name:_0x163f6a,cat:_0x21c9db}=_0x122b16['body'],_0x592395=await warehouse['aggregate']([{'$match':{'status':_0x3cca05(0x1bc),'warehouse_category':_0x21c9db,'name':_0x163f6a}},{'$group':{'_id':_0x3cca05(0x1b9),'room_name':{'$first':_0x3cca05(0x1b9)}}},{'$sort':{'room_name':0x1}}]);_0x3407f3['status'](0xc8)['json'](_0x592395);}catch(_0x30754c){_0x3407f3[_0x3cca05(0x1bd)](0x190)['json']({'errorMessage':_0x30754c[_0x3cca05(0x183)]});}}),module[a0_0x1d0860(0x1bb)]=router;