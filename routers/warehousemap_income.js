const a0_0x2de3a7=a0_0x1cba;(function(_0x275f2c,_0x342d1c){const _0x5e2771=a0_0x1cba,_0x57338e=_0x275f2c();while(!![]){try{const _0x5bd7dd=parseInt(_0x5e2771(0x20c))/0x1+parseInt(_0x5e2771(0x200))/0x2+-parseInt(_0x5e2771(0x1f6))/0x3*(parseInt(_0x5e2771(0x22e))/0x4)+-parseInt(_0x5e2771(0x1ff))/0x5*(-parseInt(_0x5e2771(0x1e7))/0x6)+-parseInt(_0x5e2771(0x1f9))/0x7+parseInt(_0x5e2771(0x227))/0x8+-parseInt(_0x5e2771(0x22c))/0x9*(parseInt(_0x5e2771(0x1f3))/0xa);if(_0x5bd7dd===_0x342d1c)break;else _0x57338e['push'](_0x57338e['shift']());}catch(_0x3d6b84){_0x57338e['push'](_0x57338e['shift']());}}}(a0_0x520d,0xe66dd));const express=require(a0_0x2de3a7(0x20d)),app=express(),router=express[a0_0x2de3a7(0x214)](),multer=require(a0_0x2de3a7(0x212)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require(a0_0x2de3a7(0x1e2));var timezones=require(a0_0x2de3a7(0x228));const users=require(a0_0x2de3a7(0x1e6));function a0_0x520d(){const _0x36acac=['$_id','15MhmVip','2821780NLSbIr','warehousemap_incoming','Rack\x20A','Hindi','/MapData','DRY\x20STORAGE','Portuguese\x20(BR)','Enabled','/Rooms_data','$product_details.product_code','timezone','pack','1098033VavdXt','express','$product_details.bin','render','log','findOne','multer','staff','Router','role','aggregate','$product_details.expiry_date','flash','$products','$_id.type','/Rooms_data2','$product_code','$_id.floorlevel','/MapData2','$product_details.bay','$product_details.batch_code','/Rooms_data3','All','Arabic','status','$room','product','4718792BLKjeU','timezones-list','exports','$count','QA\x20Warehouse','9oVwNPU','language','283652aYSqtR','body','French','$name','$product_details.product_name','message','raw','$batch_code','$_id.bin','English\x20(US)','../middleware/auth','/view','Arabic\x20(ae)','$product_details.type','../public/language/languages.json','441624vtArGE','German','$expiry_date','$$product.product_quantity','user','English','errors','post','email','get','Return\x20Goods','toLocaleString','16412650JcNbpf','$product_details.product_stock','success','27cyhccQ','find','$product_details.production_date','673855Jkqqzb','warehouse','$_id.product','en-US','json'];a0_0x520d=function(){return _0x36acac;};return a0_0x520d();}function a0_0x1cba(_0xc72150,_0xbd5cef){const _0x520d49=a0_0x520d();return a0_0x1cba=function(_0x1cbab5,_0x5a7d5c){_0x1cbab5=_0x1cbab5-0x1db;let _0x16007c=_0x520d49[_0x1cbab5];return _0x16007c;},a0_0x1cba(_0xc72150,_0xbd5cef);}router[a0_0x2de3a7(0x1f0)](a0_0x2de3a7(0x1e3),auth,async(_0x5ed670,_0x47dad0)=>{const _0x3bfce8=a0_0x2de3a7;try{const {username:_0x443aee,email:_0x450ded,role:_0x2ba125}=_0x5ed670[_0x3bfce8(0x1eb)],_0x54f8c9=_0x5ed670[_0x3bfce8(0x1eb)],_0x290f32=await profile[_0x3bfce8(0x211)]({'email':_0x54f8c9['email']}),_0xcb0003=await master_shop[_0x3bfce8(0x1f7)]();console[_0x3bfce8(0x210)]('master',_0xcb0003);let _0x1093e4;if(_0x54f8c9[_0x3bfce8(0x215)]==_0x3bfce8(0x213)){const _0xd1e2bf=await staff[_0x3bfce8(0x211)]({'email':_0x54f8c9[_0x3bfce8(0x1ef)]});_0x1093e4=await warehouse['aggregate']([{'$match':{'status':_0x3bfce8(0x207),'name':_0xd1e2bf[_0x3bfce8(0x1fa)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x1093e4=await warehouse[_0x3bfce8(0x216)]([{'$match':{'status':_0x3bfce8(0x207)}},{'$group':{'_id':'$name','name':{'$first':_0x3bfce8(0x1db)}}}]);const _0xd908ec=new Date()[_0x3bfce8(0x1f2)](_0x3bfce8(0x1fc),{'timeZone':_0xcb0003[0x0][_0x3bfce8(0x20a)]});console[_0x3bfce8(0x210)](_0x3bfce8(0x20a),_0xd908ec);if(_0xcb0003[0x0][_0x3bfce8(0x22d)]==_0x3bfce8(0x1e1)){var _0x33cc5a=users[_0x3bfce8(0x1ec)];console[_0x3bfce8(0x210)](_0x33cc5a);}else{if(_0xcb0003[0x0][_0x3bfce8(0x22d)]==_0x3bfce8(0x203))var _0x33cc5a=users[_0x3bfce8(0x203)];else{if(_0xcb0003[0x0][_0x3bfce8(0x22d)]==_0x3bfce8(0x1e8))var _0x33cc5a=users['German'];else{if(_0xcb0003[0x0][_0x3bfce8(0x22d)]=='Spanish')var _0x33cc5a=users['Spanish'];else{if(_0xcb0003[0x0][_0x3bfce8(0x22d)]==_0x3bfce8(0x230))var _0x33cc5a=users['French'];else{if(_0xcb0003[0x0][_0x3bfce8(0x22d)]==_0x3bfce8(0x206))var _0x33cc5a=users['Portuguese'];else{if(_0xcb0003[0x0][_0x3bfce8(0x22d)]=='Chinese')var _0x33cc5a=users['Chinese'];else{if(_0xcb0003[0x0][_0x3bfce8(0x22d)]==_0x3bfce8(0x1e4))var _0x33cc5a=users[_0x3bfce8(0x223)];}}}}}}}_0x47dad0[_0x3bfce8(0x20f)](_0x3bfce8(0x201),{'success':_0x5ed670['flash'](_0x3bfce8(0x1f5)),'errors':_0x5ed670[_0x3bfce8(0x218)](_0x3bfce8(0x1ed)),'role':_0x54f8c9,'profile':_0x290f32,'master_shop':_0xcb0003,'timezones':timezones,'language':_0x33cc5a,'warehouse':_0x1093e4});}catch(_0x2f57e0){console['log'](_0x2f57e0),_0x47dad0[_0x3bfce8(0x224)](0xc8)['json']({'message':_0x2f57e0[_0x3bfce8(0x1dd)]});}}),router[a0_0x2de3a7(0x1ee)](a0_0x2de3a7(0x204),async(_0x328ccc,_0x5978c5)=>{const _0x46270b=a0_0x2de3a7,{warehouseNew:_0x2a83b8,rooms:_0x490761,Type:_0x26448b}=_0x328ccc[_0x46270b(0x22f)],_0x5361cc=await warehouse[_0x46270b(0x216)]([{'$unwind':'$product_details'},{'$match':{'name':_0x2a83b8,'room':_0x490761,'product_details.type':_0x26448b}},{'$group':{'_id':{'bay':_0x46270b(0x21f),'bin':_0x46270b(0x20e),'type':_0x46270b(0x1e5),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x46270b(0x1dc),'product_quantity':_0x46270b(0x1f4),'product_code':_0x46270b(0x209)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x46270b(0x1f4),0x0]},'then':_0x46270b(0x1f4),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':_0x46270b(0x1e0),'type':_0x46270b(0x21a),'floorlevel':_0x46270b(0x21d),'products':{'$filter':{'input':_0x46270b(0x219),'as':_0x46270b(0x226),'cond':{'$gt':[_0x46270b(0x1ea),0x0]}}},'totalQuantity':0x1}}]);_0x5978c5[_0x46270b(0x1fd)](_0x5361cc);}),router['post'](a0_0x2de3a7(0x21e),async(_0x2a0325,_0x47c1ed)=>{const _0x1eeed9=a0_0x2de3a7,{warehouseNew:_0x25af4d,rooms:_0x1f60c0,room_cat:_0x1fe198}=_0x2a0325[_0x1eeed9(0x22f)];let _0x212a8f;if(_0x1fe198==_0x1eeed9(0x222))_0x212a8f=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'name':_0x25af4d}},{'$group':{'_id':{'bay':'$product_details.bay','product':_0x1eeed9(0x1dc),'expiry':'$product_details.expiry_date'},'count':{'$sum':_0x1eeed9(0x1f4)},'production_date':{'$first':_0x1eeed9(0x1f8)},'expiry_date':{'$first':_0x1eeed9(0x217)},'batch_code':{'$first':_0x1eeed9(0x220)},'product_code':{'$first':_0x1eeed9(0x209)}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':_0x1eeed9(0x1fb),'quantity':_0x1eeed9(0x22a),'production_date':'$production_date','expiry_date':_0x1eeed9(0x1e9),'batch_code':_0x1eeed9(0x1df),'product_code':_0x1eeed9(0x21c)}},'totalQuantity':{'$sum':_0x1eeed9(0x22a)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x1eeed9(0x1fe),'products':0x1,'totalQuantity':0x1}}]),console[_0x1eeed9(0x210)](_0x1fe198);else{}_0x47c1ed['json'](_0x212a8f);}),router[a0_0x2de3a7(0x1ee)](a0_0x2de3a7(0x208),async(_0x2dddce,_0x29e1f1)=>{const _0x1797e4=a0_0x2de3a7;try{const {warehouse_name:_0x2535fd,A:_0x21cb05,B:_0x2a110f}=_0x2dddce[_0x1797e4(0x22f)];var _0x43eb9b='';_0x21cb05==_0x1797e4(0x1de)?_0x2a110f=='pack'?_0x43eb9b=[{'$match':{'name':_0x2535fd,'status':'Enabled','room':_0x1797e4(0x202)}},{'$group':{'_id':_0x1797e4(0x1fe),'room_name':{'$first':_0x1797e4(0x225)}}},{'$sort':{'room_name':0x1}}]:_0x43eb9b=[{'$match':{'name':_0x2535fd,'status':_0x1797e4(0x207)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x1797e4(0x225)}}},{'$sort':{'room_name':0x1}}]:_0x43eb9b=[{'$match':{'name':_0x2535fd,'status':_0x1797e4(0x207)}},{'$group':{'_id':_0x1797e4(0x1fe),'room_name':{'$first':_0x1797e4(0x225)}}},{'$sort':{'room_name':0x1}}];const _0x22cf11=await warehouse[_0x1797e4(0x216)](_0x43eb9b);_0x29e1f1[_0x1797e4(0x224)](0xc8)['json'](_0x22cf11);}catch(_0x4defad){_0x29e1f1['status'](0x190)['json']({'errorMessage':_0x4defad[_0x1797e4(0x1dd)]});}}),router[a0_0x2de3a7(0x1ee)](a0_0x2de3a7(0x21b),async(_0x1b81f7,_0x1b35f8)=>{const _0x106196=a0_0x2de3a7;try{const {warehouse_name:_0x5b2b9a,cat:_0x2bb0be,valNew:_0x5b5a8b}=_0x1b81f7[_0x106196(0x22f)];var _0xa95507='',_0x16a89d='';if(_0x2bb0be=='Raw\x20Materials')_0xa95507=_0x106196(0x1f1),_0x5b5a8b==_0x106196(0x20b)?_0x16a89d=[{'$match':{'status':_0x106196(0x207),'warehouse_category':_0x2bb0be,'name':{'$ne':_0xa95507},'name':_0x106196(0x205)}},{'$group':{'_id':'$name','room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0x16a89d=[{'$match':{'status':'Enabled','warehouse_category':_0x2bb0be,'name':{'$ne':_0xa95507}}},{'$group':{'_id':_0x106196(0x1db),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0x2bb0be=='Finished\x20Goods'?(_0xa95507=_0x106196(0x22b),_0x16a89d=[{'$match':{'status':_0x106196(0x207),'warehouse_category':_0x2bb0be,'name':{'$ne':_0xa95507}}},{'$group':{'_id':_0x106196(0x1db),'room_name':{'$first':_0x106196(0x1db)}}},{'$sort':{'room_name':0x1}}]):_0x16a89d=[{'$match':{'status':_0x106196(0x207)}},{'$group':{'_id':_0x106196(0x1db),'room_name':{'$first':_0x106196(0x1db)}}},{'$sort':{'room_name':0x1}}];const _0x2db68f=await warehouse[_0x106196(0x216)](_0x16a89d);_0x1b35f8['status'](0xc8)[_0x106196(0x1fd)](_0x2db68f);}catch(_0x187d28){_0x1b35f8[_0x106196(0x224)](0x190)[_0x106196(0x1fd)]({'errorMessage':_0x187d28[_0x106196(0x1dd)]}),console[_0x106196(0x210)](_0x187d28);}}),router[a0_0x2de3a7(0x1ee)](a0_0x2de3a7(0x221),async(_0x1ca180,_0x10b0dc)=>{const _0x828a09=a0_0x2de3a7;try{const {warehouse_name:_0x5987fb,cat:_0x2b8fd0}=_0x1ca180[_0x828a09(0x22f)],_0xca8e1c=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x2b8fd0,'name':_0x5987fb}},{'$group':{'_id':'$room','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x10b0dc[_0x828a09(0x224)](0xc8)[_0x828a09(0x1fd)](_0xca8e1c);}catch(_0x5e9415){_0x10b0dc['status'](0x190)['json']({'errorMessage':_0x5e9415[_0x828a09(0x1dd)]});}}),module[a0_0x2de3a7(0x229)]=router;