const a0_0x17bfa5=a0_0x545f;(function(_0x55e082,_0xce6ea3){const _0x4820ad=a0_0x545f,_0x2367cd=_0x55e082();while(!![]){try{const _0x3d1afe=-parseInt(_0x4820ad(0x152))/0x1+parseInt(_0x4820ad(0x160))/0x2+-parseInt(_0x4820ad(0x134))/0x3+-parseInt(_0x4820ad(0x133))/0x4+-parseInt(_0x4820ad(0x162))/0x5+parseInt(_0x4820ad(0x12c))/0x6*(parseInt(_0x4820ad(0x144))/0x7)+parseInt(_0x4820ad(0x135))/0x8;if(_0x3d1afe===_0xce6ea3)break;else _0x2367cd['push'](_0x2367cd['shift']());}catch(_0x27c90f){_0x2367cd['push'](_0x2367cd['shift']());}}}(a0_0x23dd,0x4218d));const express=require(a0_0x17bfa5(0x140)),app=express(),router=express['Router'](),multer=require(a0_0x17bfa5(0x138)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require('../middleware/auth');var timezones=require(a0_0x17bfa5(0x158));function a0_0x23dd(){const _0x40b8bd=['/Rooms_data3','$room','Hindi','body','pack','Spanish','$product_details.bin','aggregate','errors','json','timezone','$product_details.bay','$product_details.product_code','en-US','Finished\x20Goods','6XNSdpv','language','Arabic','$count','Portuguese\x20(BR)','log','$product_details','635972Qgpten','15606kAwXIF','3068736bIRkKZ','$name','$product_code','multer','$$product.product_quantity','English','status','Return\x20Goods','Portuguese','master','$_id.bay','express','$batch_code','email','$_id','1073282kkrvmb','French','/view','message','user','$_id.product','exports','$_id.bin','Enabled','$product_details.batch_code','warehouse','German','$product_details.expiry_date','raw','267577vwhBel','/Rooms_data2','Chinese','$product_details.product_stock','post','All','timezones-list','success','findOne','$product_details.production_date','Rack\x20A','DRY\x20STORAGE','/Rooms_data','$products','855290txrTGl','role','1310290woBSJC','flash'];a0_0x23dd=function(){return _0x40b8bd;};return a0_0x23dd();}function a0_0x545f(_0x2619bf,_0x3e7e75){const _0x23ddd4=a0_0x23dd();return a0_0x545f=function(_0x545f16,_0x7e5b3f){_0x545f16=_0x545f16-0x11c;let _0x40ea4a=_0x23ddd4[_0x545f16];return _0x40ea4a;},a0_0x545f(_0x2619bf,_0x3e7e75);}const users=require('../public/language/languages.json');router['get'](a0_0x17bfa5(0x146),auth,async(_0x22f7f3,_0x4ee1c8)=>{const _0x449648=a0_0x17bfa5;try{const {username:_0x1f5036,email:_0x5445e8,role:_0x57ce2e}=_0x22f7f3[_0x449648(0x148)],_0x167b6b=_0x22f7f3[_0x449648(0x148)],_0x5668fa=await profile[_0x449648(0x15a)]({'email':_0x167b6b[_0x449648(0x142)]}),_0x1eb387=await master_shop['find']();console[_0x449648(0x131)](_0x449648(0x13e),_0x1eb387);let _0x550eae;if(_0x167b6b[_0x449648(0x161)]=='staff'){const _0x886108=await staff[_0x449648(0x15a)]({'email':_0x167b6b[_0x449648(0x142)]});_0x550eae=await warehouse['aggregate']([{'$match':{'status':_0x449648(0x14c),'name':_0x886108[_0x449648(0x14e)]}},{'$group':{'_id':_0x449648(0x136),'name':{'$first':_0x449648(0x136)}}}]);}else _0x550eae=await warehouse[_0x449648(0x124)]([{'$match':{'status':_0x449648(0x14c)}},{'$group':{'_id':_0x449648(0x136),'name':{'$first':'$name'}}}]);const _0x2b1a4e=new Date()['toLocaleString'](_0x449648(0x12a),{'timeZone':_0x1eb387[0x0][_0x449648(0x127)]});console[_0x449648(0x131)]('timezone',_0x2b1a4e);if(_0x1eb387[0x0]['language']=='English\x20(US)'){var _0x2c262b=users[_0x449648(0x13a)];console[_0x449648(0x131)](_0x2c262b);}else{if(_0x1eb387[0x0][_0x449648(0x12d)]=='Hindi')var _0x2c262b=users[_0x449648(0x11f)];else{if(_0x1eb387[0x0][_0x449648(0x12d)]==_0x449648(0x14f))var _0x2c262b=users[_0x449648(0x14f)];else{if(_0x1eb387[0x0][_0x449648(0x12d)]==_0x449648(0x122))var _0x2c262b=users[_0x449648(0x122)];else{if(_0x1eb387[0x0][_0x449648(0x12d)]==_0x449648(0x145))var _0x2c262b=users[_0x449648(0x145)];else{if(_0x1eb387[0x0][_0x449648(0x12d)]==_0x449648(0x130))var _0x2c262b=users[_0x449648(0x13d)];else{if(_0x1eb387[0x0][_0x449648(0x12d)]=='Chinese')var _0x2c262b=users[_0x449648(0x154)];else{if(_0x1eb387[0x0][_0x449648(0x12d)]=='Arabic\x20(ae)')var _0x2c262b=users[_0x449648(0x12e)];}}}}}}}_0x4ee1c8['render']('warehousemap_incoming',{'success':_0x22f7f3[_0x449648(0x11c)](_0x449648(0x159)),'errors':_0x22f7f3[_0x449648(0x11c)](_0x449648(0x125)),'role':_0x167b6b,'profile':_0x5668fa,'master_shop':_0x1eb387,'timezones':timezones,'language':_0x2c262b,'warehouse':_0x550eae});}catch(_0x51a98e){console[_0x449648(0x131)](_0x51a98e),_0x4ee1c8[_0x449648(0x13b)](0xc8)[_0x449648(0x126)]({'message':_0x51a98e[_0x449648(0x147)]});}}),router[a0_0x17bfa5(0x156)]('/MapData',async(_0x10eabe,_0x542921)=>{const _0x400722=a0_0x17bfa5,{warehouseNew:_0x1a06c6,rooms:_0x220107,Type:_0x2a6a1c}=_0x10eabe[_0x400722(0x120)],_0x3326ac=await warehouse[_0x400722(0x124)]([{'$unwind':_0x400722(0x132)},{'$match':{'name':_0x1a06c6,'room':_0x220107,'product_details.type':_0x2a6a1c}},{'$group':{'_id':{'bay':_0x400722(0x128),'bin':_0x400722(0x123),'type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x400722(0x155),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x400722(0x155),0x0]},'then':_0x400722(0x155),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x400722(0x13f),'bin':_0x400722(0x14b),'type':'$_id.type','floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x400722(0x15f),'as':'product','cond':{'$gt':[_0x400722(0x139),0x0]}}},'totalQuantity':0x1}}]);_0x542921['json'](_0x3326ac);}),router[a0_0x17bfa5(0x156)]('/MapData2',async(_0xa63a51,_0x4e8216)=>{const _0x28e617=a0_0x17bfa5,{warehouseNew:_0x36e4fb,rooms:_0x117d6e,room_cat:_0x1ea09f}=_0xa63a51[_0x28e617(0x120)];let _0x117c0a;if(_0x1ea09f==_0x28e617(0x157))_0x117c0a=await warehouse[_0x28e617(0x124)]([{'$unwind':'$product_details'},{'$match':{'name':_0x36e4fb}},{'$group':{'_id':{'bay':_0x28e617(0x128),'product':'$product_details.product_name','expiry':_0x28e617(0x150)},'count':{'$sum':_0x28e617(0x155)},'production_date':{'$first':_0x28e617(0x15b)},'expiry_date':{'$first':_0x28e617(0x150)},'batch_code':{'$first':_0x28e617(0x14d)},'product_code':{'$first':_0x28e617(0x129)}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':_0x28e617(0x149),'quantity':'$count','production_date':'$production_date','expiry_date':'$expiry_date','batch_code':_0x28e617(0x141),'product_code':_0x28e617(0x137)}},'totalQuantity':{'$sum':_0x28e617(0x12f)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x28e617(0x131)](_0x1ea09f);else{}_0x4e8216['json'](_0x117c0a);}),router[a0_0x17bfa5(0x156)](a0_0x17bfa5(0x15e),async(_0x98eb5,_0x3ad138)=>{const _0x4351c6=a0_0x17bfa5;try{const {warehouse_name:_0xd1f3ce,A:_0x17c24c,B:_0x7d0ac6}=_0x98eb5['body'];var _0x5add07='';_0x17c24c==_0x4351c6(0x151)?_0x7d0ac6==_0x4351c6(0x121)?_0x5add07=[{'$match':{'name':_0xd1f3ce,'status':'Enabled','room':_0x4351c6(0x15c)}},{'$group':{'_id':_0x4351c6(0x143),'room_name':{'$first':_0x4351c6(0x11e)}}},{'$sort':{'room_name':0x1}}]:_0x5add07=[{'$match':{'name':_0xd1f3ce,'status':_0x4351c6(0x14c)}},{'$group':{'_id':_0x4351c6(0x143),'room_name':{'$first':_0x4351c6(0x11e)}}},{'$sort':{'room_name':0x1}}]:_0x5add07=[{'$match':{'name':_0xd1f3ce,'status':'Enabled'}},{'$group':{'_id':'$_id','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x58eaff=await warehouse[_0x4351c6(0x124)](_0x5add07);_0x3ad138[_0x4351c6(0x13b)](0xc8)[_0x4351c6(0x126)](_0x58eaff);}catch(_0x51f1cb){_0x3ad138[_0x4351c6(0x13b)](0x190)[_0x4351c6(0x126)]({'errorMessage':_0x51f1cb[_0x4351c6(0x147)]});}}),router['post'](a0_0x17bfa5(0x153),async(_0x12279f,_0x5c2e4f)=>{const _0x21c3c0=a0_0x17bfa5;try{const {warehouse_name:_0x418979,cat:_0x25182c,valNew:_0x324ad3}=_0x12279f[_0x21c3c0(0x120)];var _0x3f6ffc='',_0x360ea8='';if(_0x25182c=='Raw\x20Materials')_0x3f6ffc=_0x21c3c0(0x13c),_0x324ad3==_0x21c3c0(0x121)?_0x360ea8=[{'$match':{'status':_0x21c3c0(0x14c),'warehouse_category':_0x25182c,'name':{'$ne':_0x3f6ffc},'name':_0x21c3c0(0x15d)}},{'$group':{'_id':_0x21c3c0(0x136),'room_name':{'$first':_0x21c3c0(0x136)}}},{'$sort':{'room_name':0x1}}]:_0x360ea8=[{'$match':{'status':_0x21c3c0(0x14c),'warehouse_category':_0x25182c,'name':{'$ne':_0x3f6ffc}}},{'$group':{'_id':_0x21c3c0(0x136),'room_name':{'$first':_0x21c3c0(0x136)}}},{'$sort':{'room_name':0x1}}];else _0x25182c==_0x21c3c0(0x12b)?(_0x3f6ffc='QA\x20Warehouse',_0x360ea8=[{'$match':{'status':_0x21c3c0(0x14c),'warehouse_category':_0x25182c,'name':{'$ne':_0x3f6ffc}}},{'$group':{'_id':_0x21c3c0(0x136),'room_name':{'$first':_0x21c3c0(0x136)}}},{'$sort':{'room_name':0x1}}]):_0x360ea8=[{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x21c3c0(0x136),'room_name':{'$first':_0x21c3c0(0x136)}}},{'$sort':{'room_name':0x1}}];const _0x3f26e2=await warehouse[_0x21c3c0(0x124)](_0x360ea8);_0x5c2e4f[_0x21c3c0(0x13b)](0xc8)[_0x21c3c0(0x126)](_0x3f26e2);}catch(_0x3f35e4){_0x5c2e4f[_0x21c3c0(0x13b)](0x190)[_0x21c3c0(0x126)]({'errorMessage':_0x3f35e4[_0x21c3c0(0x147)]}),console[_0x21c3c0(0x131)](_0x3f35e4);}}),router['post'](a0_0x17bfa5(0x11d),async(_0x17e020,_0x530465)=>{const _0x310c33=a0_0x17bfa5;try{const {warehouse_name:_0x596c64,cat:_0x4a05e7}=_0x17e020[_0x310c33(0x120)],_0x4fd648=await warehouse['aggregate']([{'$match':{'status':_0x310c33(0x14c),'warehouse_category':_0x4a05e7,'name':_0x596c64}},{'$group':{'_id':_0x310c33(0x11e),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x530465[_0x310c33(0x13b)](0xc8)[_0x310c33(0x126)](_0x4fd648);}catch(_0xe44a27){_0x530465[_0x310c33(0x13b)](0x190)[_0x310c33(0x126)]({'errorMessage':_0xe44a27[_0x310c33(0x147)]});}}),module[a0_0x17bfa5(0x14a)]=router;