const a0_0x1fc247=a0_0x2309;(function(_0x2fd68c,_0x276a00){const _0x143b27=a0_0x2309,_0x2953b2=_0x2fd68c();while(!![]){try{const _0x4fe25a=parseInt(_0x143b27(0xc1))/0x1*(-parseInt(_0x143b27(0xfa))/0x2)+parseInt(_0x143b27(0xdf))/0x3+parseInt(_0x143b27(0xc5))/0x4+parseInt(_0x143b27(0x109))/0x5*(-parseInt(_0x143b27(0xfc))/0x6)+-parseInt(_0x143b27(0xe5))/0x7+parseInt(_0x143b27(0xf9))/0x8*(-parseInt(_0x143b27(0x104))/0x9)+-parseInt(_0x143b27(0xbe))/0xa*(-parseInt(_0x143b27(0xe6))/0xb);if(_0x4fe25a===_0x276a00)break;else _0x2953b2['push'](_0x2953b2['shift']());}catch(_0x55f87a){_0x2953b2['push'](_0x2953b2['shift']());}}}(a0_0x2e03,0x907db));function a0_0x2309(_0x46ac19,_0x4cd403){const _0x2e0362=a0_0x2e03();return a0_0x2309=function(_0x2309a3,_0x386968){_0x2309a3=_0x2309a3-0xba;let _0x35f5d5=_0x2e0362[_0x2309a3];return _0x35f5d5;},a0_0x2309(_0x46ac19,_0x4cd403);}const express=require('express'),app=express(),router=express[a0_0x1fc247(0xc2)](),multer=require(a0_0x1fc247(0xfe)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x1fc247(0xca)),auth=require('../middleware/auth');function a0_0x2e03(){const _0x32e087=['24yQIVux','413726onhtXk','errors','114uowtzs','$$product.product_quantity','multer','find','$room','timezones-list','/view','aggregate','343899WCPGEG','../public/language/languages.json','$product_details.bin','$product_details.expiry_date','$_id.bay','310075eAUfmJ','Return\x20Goods','$_id.floorlevel','findOne','$count','log','All','email','25550VsysKz','timezone','$product_details.batch_code','1jpUpbC','Router','Finished\x20Goods','product','1705004sLgZgO','message','$_id.bin','status','Chinese','../models/all_models','Enabled','render','$production_date','language','$product_details.product_code','$name','/Rooms_data3','Portuguese\x20(BR)','exports','$_id','master','$product_details','$product_details.product_stock','DRY\x20STORAGE','staff','German','$product_code','Hindi','warehouse','$_id.type','565332Glgkyv','$expiry_date','success','French','en-US','json','1000643bMksVQ','6974vFQgQb','Spanish','Portuguese','body','/Rooms_data2','English','user','post','pack','$product_details.bay','flash','/MapData2','/MapData','$product_details.product_name','raw','Arabic','warehousemap_incoming','$batch_code','$product_details.type'];a0_0x2e03=function(){return _0x32e087;};return a0_0x2e03();}var timezones=require(a0_0x1fc247(0x101));const users=require(a0_0x1fc247(0x105));router['get'](a0_0x1fc247(0x102),auth,async(_0x4659f6,_0x2f1692)=>{const _0x1f2402=a0_0x1fc247;try{const {username:_0x54c747,email:_0x2312bc,role:_0x10ea12}=_0x4659f6[_0x1f2402(0xec)],_0x22e447=_0x4659f6['user'],_0x2ee6fd=await profile[_0x1f2402(0x10c)]({'email':_0x22e447[_0x1f2402(0xbd)]}),_0x57138e=await master_shop[_0x1f2402(0xff)]();console[_0x1f2402(0xbb)](_0x1f2402(0xd5),_0x57138e);let _0x277903;if(_0x22e447['role']==_0x1f2402(0xd9)){const _0x57ad97=await staff['findOne']({'email':_0x22e447['email']});_0x277903=await warehouse[_0x1f2402(0x103)]([{'$match':{'status':_0x1f2402(0xcb),'name':_0x57ad97[_0x1f2402(0xdd)]}},{'$group':{'_id':_0x1f2402(0xd0),'name':{'$first':'$name'}}}]);}else _0x277903=await warehouse['aggregate']([{'$match':{'status':_0x1f2402(0xcb)}},{'$group':{'_id':_0x1f2402(0xd0),'name':{'$first':'$name'}}}]);const _0x24ab95=new Date()['toLocaleString'](_0x1f2402(0xe3),{'timeZone':_0x57138e[0x0][_0x1f2402(0xbf)]});console[_0x1f2402(0xbb)](_0x1f2402(0xbf),_0x24ab95);if(_0x57138e[0x0][_0x1f2402(0xce)]=='English\x20(US)'){var _0x3a7836=users[_0x1f2402(0xeb)];console[_0x1f2402(0xbb)](_0x3a7836);}else{if(_0x57138e[0x0][_0x1f2402(0xce)]=='Hindi')var _0x3a7836=users[_0x1f2402(0xdc)];else{if(_0x57138e[0x0][_0x1f2402(0xce)]==_0x1f2402(0xda))var _0x3a7836=users[_0x1f2402(0xda)];else{if(_0x57138e[0x0][_0x1f2402(0xce)]==_0x1f2402(0xe7))var _0x3a7836=users['Spanish'];else{if(_0x57138e[0x0]['language']==_0x1f2402(0xe2))var _0x3a7836=users[_0x1f2402(0xe2)];else{if(_0x57138e[0x0][_0x1f2402(0xce)]==_0x1f2402(0xd2))var _0x3a7836=users[_0x1f2402(0xe8)];else{if(_0x57138e[0x0][_0x1f2402(0xce)]==_0x1f2402(0xc9))var _0x3a7836=users[_0x1f2402(0xc9)];else{if(_0x57138e[0x0][_0x1f2402(0xce)]=='Arabic\x20(ae)')var _0x3a7836=users[_0x1f2402(0xf5)];}}}}}}}_0x2f1692[_0x1f2402(0xcc)](_0x1f2402(0xf6),{'success':_0x4659f6[_0x1f2402(0xf0)](_0x1f2402(0xe1)),'errors':_0x4659f6[_0x1f2402(0xf0)](_0x1f2402(0xfb)),'role':_0x22e447,'profile':_0x2ee6fd,'master_shop':_0x57138e,'timezones':timezones,'language':_0x3a7836,'warehouse':_0x277903});}catch(_0x37c5df){console['log'](_0x37c5df),_0x2f1692['status'](0xc8)[_0x1f2402(0xe4)]({'message':_0x37c5df['message']});}}),router['post'](a0_0x1fc247(0xf2),async(_0x1a7aed,_0x18b007)=>{const _0x37b0e1=a0_0x1fc247,{warehouseNew:_0x3d656d,rooms:_0x496e42,Type:_0xa92fc2}=_0x1a7aed[_0x37b0e1(0xe9)],_0x47b485=await warehouse[_0x37b0e1(0x103)]([{'$unwind':_0x37b0e1(0xd6)},{'$match':{'name':_0x3d656d,'room':_0x496e42,'product_details.type':_0xa92fc2}},{'$group':{'_id':{'bay':_0x37b0e1(0xef),'bin':_0x37b0e1(0x106),'type':_0x37b0e1(0xf8),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x37b0e1(0xf3),'product_quantity':_0x37b0e1(0xd7),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x37b0e1(0xd7),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x37b0e1(0x108),'bin':_0x37b0e1(0xc7),'type':_0x37b0e1(0xde),'floorlevel':_0x37b0e1(0x10b),'products':{'$filter':{'input':'$products','as':_0x37b0e1(0xc4),'cond':{'$gt':[_0x37b0e1(0xfd),0x0]}}},'totalQuantity':0x1}}]);_0x18b007['json'](_0x47b485);}),router['post'](a0_0x1fc247(0xf1),async(_0x18f739,_0x35fb22)=>{const _0x3dba31=a0_0x1fc247,{warehouseNew:_0x18170f,rooms:_0x39a348,room_cat:_0x52b39a}=_0x18f739[_0x3dba31(0xe9)];let _0x1e7bad;if(_0x52b39a==_0x3dba31(0xbc))_0x1e7bad=await warehouse['aggregate']([{'$unwind':'$product_details'},{'$match':{'name':_0x18170f}},{'$group':{'_id':{'bay':_0x3dba31(0xef),'product':_0x3dba31(0xf3),'expiry':'$product_details.expiry_date'},'count':{'$sum':_0x3dba31(0xd7)},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':_0x3dba31(0x107)},'batch_code':{'$first':_0x3dba31(0xc0)},'product_code':{'$first':_0x3dba31(0xcf)}}},{'$group':{'_id':_0x3dba31(0x108),'products':{'$push':{'product':'$_id.product','quantity':_0x3dba31(0xba),'production_date':_0x3dba31(0xcd),'expiry_date':_0x3dba31(0xe0),'batch_code':_0x3dba31(0xf7),'product_code':_0x3dba31(0xdb)}},'totalQuantity':{'$sum':_0x3dba31(0xba)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x3dba31(0xbb)](_0x52b39a);else{}_0x35fb22['json'](_0x1e7bad);}),router[a0_0x1fc247(0xed)]('/Rooms_data',async(_0xcfcdd0,_0x3b2b55)=>{const _0x1d7fdb=a0_0x1fc247;try{const {warehouse_name:_0x5eb0cc,A:_0x225f62,B:_0x10a2b3}=_0xcfcdd0['body'];var _0x16297c='';_0x225f62==_0x1d7fdb(0xf4)?_0x10a2b3==_0x1d7fdb(0xee)?_0x16297c=[{'$match':{'name':_0x5eb0cc,'status':'Enabled','room':'Rack\x20A'}},{'$group':{'_id':_0x1d7fdb(0xd4),'room_name':{'$first':_0x1d7fdb(0x100)}}},{'$sort':{'room_name':0x1}}]:_0x16297c=[{'$match':{'name':_0x5eb0cc,'status':_0x1d7fdb(0xcb)}},{'$group':{'_id':_0x1d7fdb(0xd4),'room_name':{'$first':_0x1d7fdb(0x100)}}},{'$sort':{'room_name':0x1}}]:_0x16297c=[{'$match':{'name':_0x5eb0cc,'status':_0x1d7fdb(0xcb)}},{'$group':{'_id':_0x1d7fdb(0xd4),'room_name':{'$first':_0x1d7fdb(0x100)}}},{'$sort':{'room_name':0x1}}];const _0x3f4f2a=await warehouse[_0x1d7fdb(0x103)](_0x16297c);_0x3b2b55[_0x1d7fdb(0xc8)](0xc8)[_0x1d7fdb(0xe4)](_0x3f4f2a);}catch(_0x267121){_0x3b2b55[_0x1d7fdb(0xc8)](0x190)[_0x1d7fdb(0xe4)]({'errorMessage':_0x267121['message']});}}),router[a0_0x1fc247(0xed)](a0_0x1fc247(0xea),async(_0x3a6365,_0x145fed)=>{const _0x3b6406=a0_0x1fc247;try{const {warehouse_name:_0x38212a,cat:_0x9ff67d,valNew:_0x305e27}=_0x3a6365['body'];var _0x4c5dac='',_0x5cc7d6='';if(_0x9ff67d=='Raw\x20Materials')_0x4c5dac=_0x3b6406(0x10a),_0x305e27==_0x3b6406(0xee)?_0x5cc7d6=[{'$match':{'status':_0x3b6406(0xcb),'warehouse_category':_0x9ff67d,'name':{'$ne':_0x4c5dac},'name':_0x3b6406(0xd8)}},{'$group':{'_id':'$name','room_name':{'$first':_0x3b6406(0xd0)}}},{'$sort':{'room_name':0x1}}]:_0x5cc7d6=[{'$match':{'status':_0x3b6406(0xcb),'warehouse_category':_0x9ff67d,'name':{'$ne':_0x4c5dac}}},{'$group':{'_id':_0x3b6406(0xd0),'room_name':{'$first':_0x3b6406(0xd0)}}},{'$sort':{'room_name':0x1}}];else _0x9ff67d==_0x3b6406(0xc3)?(_0x4c5dac='QA\x20Warehouse',_0x5cc7d6=[{'$match':{'status':'Enabled','warehouse_category':_0x9ff67d,'name':{'$ne':_0x4c5dac}}},{'$group':{'_id':_0x3b6406(0xd0),'room_name':{'$first':_0x3b6406(0xd0)}}},{'$sort':{'room_name':0x1}}]):_0x5cc7d6=[{'$match':{'status':_0x3b6406(0xcb)}},{'$group':{'_id':'$name','room_name':{'$first':_0x3b6406(0xd0)}}},{'$sort':{'room_name':0x1}}];const _0x1bf55b=await warehouse[_0x3b6406(0x103)](_0x5cc7d6);_0x145fed[_0x3b6406(0xc8)](0xc8)[_0x3b6406(0xe4)](_0x1bf55b);}catch(_0x1a2068){_0x145fed[_0x3b6406(0xc8)](0x190)[_0x3b6406(0xe4)]({'errorMessage':_0x1a2068['message']}),console[_0x3b6406(0xbb)](_0x1a2068);}}),router[a0_0x1fc247(0xed)](a0_0x1fc247(0xd1),async(_0x17a2f4,_0x9c36f2)=>{const _0x57e2b7=a0_0x1fc247;try{const {warehouse_name:_0x29dcaf,cat:_0x39ce1f}=_0x17a2f4[_0x57e2b7(0xe9)],_0x10f85e=await warehouse[_0x57e2b7(0x103)]([{'$match':{'status':_0x57e2b7(0xcb),'warehouse_category':_0x39ce1f,'name':_0x29dcaf}},{'$group':{'_id':_0x57e2b7(0x100),'room_name':{'$first':_0x57e2b7(0x100)}}},{'$sort':{'room_name':0x1}}]);_0x9c36f2[_0x57e2b7(0xc8)](0xc8)[_0x57e2b7(0xe4)](_0x10f85e);}catch(_0x46a1a6){_0x9c36f2[_0x57e2b7(0xc8)](0x190)['json']({'errorMessage':_0x46a1a6[_0x57e2b7(0xc6)]});}}),module[a0_0x1fc247(0xd3)]=router;