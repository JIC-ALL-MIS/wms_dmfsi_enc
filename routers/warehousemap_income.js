const a0_0x452efa=a0_0x5a31;(function(_0x1edfe3,_0x32ae29){const _0x1f7347=a0_0x5a31,_0x440d4d=_0x1edfe3();while(!![]){try{const _0x4d4cac=-parseInt(_0x1f7347(0x193))/0x1+parseInt(_0x1f7347(0x1cb))/0x2+-parseInt(_0x1f7347(0x1ce))/0x3+parseInt(_0x1f7347(0x1aa))/0x4+-parseInt(_0x1f7347(0x1cd))/0x5*(parseInt(_0x1f7347(0x1bd))/0x6)+parseInt(_0x1f7347(0x1d4))/0x7+parseInt(_0x1f7347(0x195))/0x8;if(_0x4d4cac===_0x32ae29)break;else _0x440d4d['push'](_0x440d4d['shift']());}catch(_0x26fd08){_0x440d4d['push'](_0x440d4d['shift']());}}}(a0_0x4c37,0xb1b99));const express=require('express'),app=express(),router=express['Router'](),multer=require(a0_0x452efa(0x192)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x452efa(0x1b3)),auth=require(a0_0x452efa(0x1c4));var timezones=require('timezones-list');function a0_0x5a31(_0x47bd43,_0x28e4e6){const _0x4c377c=a0_0x4c37();return a0_0x5a31=function(_0x5a31a6,_0xf84d3f){_0x5a31a6=_0x5a31a6-0x187;let _0x1f106b=_0x4c377c[_0x5a31a6];return _0x1f106b;},a0_0x5a31(_0x47bd43,_0x28e4e6);}const users=require(a0_0x452efa(0x18b));function a0_0x4c37(){const _0x161176=['$batch_code','$$product.product_quantity','errors','../public/language/languages.json','Arabic','timezone','Hindi','staff','Arabic\x20(ae)','email','multer','1349054epJRra','Rack\x20A','11086640lYIhwu','$_id.bay','$product_details.product_name','get','$production_date','/Rooms_data3','post','json','$product_details.batch_code','Spanish','$room','findOne','DRY\x20STORAGE','product','$product_details','/view','$_id.bin','/MapData','$product_details.bin','English','body','5517724dMzLnE','status','warehousemap_incoming','exports','Portuguese\x20(BR)','$products','language','Enabled','/Rooms_data2','../models/all_models','$expiry_date','Raw\x20Materials','$product_details.expiry_date','$product_details.bay','find','$_id','aggregate','$product_details.floorlevel','success','1554perZdJ','$count','raw','Finished\x20Goods','$product_details.product_stock','user','QA\x20Warehouse','../middleware/auth','toLocaleString','flash','Return\x20Goods','German','pack','message','348912hMYiiJ','warehouse','16045GWlKca','922650LKsTLU','/Rooms_data','log','$name','Chinese','French','1931853sanwQc','$product_code','Portuguese'];a0_0x4c37=function(){return _0x161176;};return a0_0x4c37();}router[a0_0x452efa(0x198)](a0_0x452efa(0x1a4),auth,async(_0x4173ec,_0x10b1ae)=>{const _0x53d596=a0_0x452efa;try{const {username:_0x987533,email:_0x46fd68,role:_0x41b408}=_0x4173ec[_0x53d596(0x1c2)],_0x2d2104=_0x4173ec[_0x53d596(0x1c2)],_0x262b51=await profile[_0x53d596(0x1a0)]({'email':_0x2d2104['email']}),_0x224f90=await master_shop[_0x53d596(0x1b8)]();console[_0x53d596(0x1d0)]('master',_0x224f90);let _0x29642f;if(_0x2d2104['role']==_0x53d596(0x18f)){const _0x4ef22e=await staff['findOne']({'email':_0x2d2104[_0x53d596(0x191)]});_0x29642f=await warehouse['aggregate']([{'$match':{'status':_0x53d596(0x1b1),'name':_0x4ef22e[_0x53d596(0x1cc)]}},{'$group':{'_id':'$name','name':{'$first':_0x53d596(0x1d1)}}}]);}else _0x29642f=await warehouse[_0x53d596(0x1ba)]([{'$match':{'status':_0x53d596(0x1b1)}},{'$group':{'_id':_0x53d596(0x1d1),'name':{'$first':_0x53d596(0x1d1)}}}]);const _0x21b4c9=new Date()[_0x53d596(0x1c5)]('en-US',{'timeZone':_0x224f90[0x0][_0x53d596(0x18d)]});console[_0x53d596(0x1d0)](_0x53d596(0x18d),_0x21b4c9);if(_0x224f90[0x0][_0x53d596(0x1b0)]=='English\x20(US)'){var _0x21bac0=users[_0x53d596(0x1a8)];console[_0x53d596(0x1d0)](_0x21bac0);}else{if(_0x224f90[0x0][_0x53d596(0x1b0)]==_0x53d596(0x18e))var _0x21bac0=users[_0x53d596(0x18e)];else{if(_0x224f90[0x0][_0x53d596(0x1b0)]==_0x53d596(0x1c8))var _0x21bac0=users[_0x53d596(0x1c8)];else{if(_0x224f90[0x0]['language']=='Spanish')var _0x21bac0=users[_0x53d596(0x19e)];else{if(_0x224f90[0x0]['language']==_0x53d596(0x1d3))var _0x21bac0=users[_0x53d596(0x1d3)];else{if(_0x224f90[0x0]['language']==_0x53d596(0x1ae))var _0x21bac0=users[_0x53d596(0x187)];else{if(_0x224f90[0x0]['language']==_0x53d596(0x1d2))var _0x21bac0=users[_0x53d596(0x1d2)];else{if(_0x224f90[0x0]['language']==_0x53d596(0x190))var _0x21bac0=users[_0x53d596(0x18c)];}}}}}}}_0x10b1ae['render'](_0x53d596(0x1ac),{'success':_0x4173ec['flash'](_0x53d596(0x1bc)),'errors':_0x4173ec[_0x53d596(0x1c6)](_0x53d596(0x18a)),'role':_0x2d2104,'profile':_0x262b51,'master_shop':_0x224f90,'timezones':timezones,'language':_0x21bac0,'warehouse':_0x29642f});}catch(_0xceef73){console[_0x53d596(0x1d0)](_0xceef73),_0x10b1ae['status'](0xc8)[_0x53d596(0x19c)]({'message':_0xceef73[_0x53d596(0x1ca)]});}}),router['post'](a0_0x452efa(0x1a6),async(_0x5bf006,_0x486e12)=>{const _0x39f989=a0_0x452efa,{warehouseNew:_0x5f4bc6,rooms:_0x3d4e48,Type:_0x23e1ef}=_0x5bf006['body'],_0xff026=await warehouse[_0x39f989(0x1ba)]([{'$unwind':_0x39f989(0x1a3)},{'$match':{'name':_0x5f4bc6,'room':_0x3d4e48,'product_details.type':_0x23e1ef}},{'$group':{'_id':{'bay':_0x39f989(0x1b7),'bin':_0x39f989(0x1a7),'type':'$product_details.type','floorlevel':_0x39f989(0x1bb)},'products':{'$push':{'product_name':_0x39f989(0x197),'product_quantity':'$product_details.product_stock','product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x39f989(0x1c1),0x0]},'then':_0x39f989(0x1c1),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x39f989(0x196),'bin':_0x39f989(0x1a5),'type':'$_id.type','floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x39f989(0x1af),'as':_0x39f989(0x1a2),'cond':{'$gt':[_0x39f989(0x189),0x0]}}},'totalQuantity':0x1}}]);_0x486e12[_0x39f989(0x19c)](_0xff026);}),router[a0_0x452efa(0x19b)]('/MapData2',async(_0x2751ac,_0x12f9ce)=>{const _0x344eda=a0_0x452efa,{warehouseNew:_0x40cc58,rooms:_0x5b3fd4,room_cat:_0x56ff73}=_0x2751ac[_0x344eda(0x1a9)];let _0x1ca249;if(_0x56ff73=='All')_0x1ca249=await warehouse[_0x344eda(0x1ba)]([{'$unwind':_0x344eda(0x1a3)},{'$match':{'name':_0x40cc58}},{'$group':{'_id':{'bay':'$product_details.bay','product':'$product_details.product_name','expiry':_0x344eda(0x1b6)},'count':{'$sum':_0x344eda(0x1c1)},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':'$product_details.expiry_date'},'batch_code':{'$first':_0x344eda(0x19d)},'product_code':{'$first':'$product_details.product_code'}}},{'$group':{'_id':_0x344eda(0x196),'products':{'$push':{'product':'$_id.product','quantity':_0x344eda(0x1be),'production_date':_0x344eda(0x199),'expiry_date':_0x344eda(0x1b4),'batch_code':_0x344eda(0x188),'product_code':_0x344eda(0x1d5)}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console['log'](_0x56ff73);else{}_0x12f9ce[_0x344eda(0x19c)](_0x1ca249);}),router[a0_0x452efa(0x19b)](a0_0x452efa(0x1cf),async(_0x5b77b6,_0x2cd42f)=>{const _0xd30a5e=a0_0x452efa;try{const {warehouse_name:_0x3de859,A:_0x490515,B:_0x6a5428}=_0x5b77b6[_0xd30a5e(0x1a9)];var _0x1b4ad6='';_0x490515==_0xd30a5e(0x1bf)?_0x6a5428==_0xd30a5e(0x1c9)?_0x1b4ad6=[{'$match':{'name':_0x3de859,'status':_0xd30a5e(0x1b1),'room':_0xd30a5e(0x194)}},{'$group':{'_id':_0xd30a5e(0x1b9),'room_name':{'$first':_0xd30a5e(0x19f)}}},{'$sort':{'room_name':0x1}}]:_0x1b4ad6=[{'$match':{'name':_0x3de859,'status':_0xd30a5e(0x1b1)}},{'$group':{'_id':'$_id','room_name':{'$first':_0xd30a5e(0x19f)}}},{'$sort':{'room_name':0x1}}]:_0x1b4ad6=[{'$match':{'name':_0x3de859,'status':_0xd30a5e(0x1b1)}},{'$group':{'_id':_0xd30a5e(0x1b9),'room_name':{'$first':_0xd30a5e(0x19f)}}},{'$sort':{'room_name':0x1}}];const _0x875308=await warehouse['aggregate'](_0x1b4ad6);_0x2cd42f['status'](0xc8)['json'](_0x875308);}catch(_0x49bcda){_0x2cd42f[_0xd30a5e(0x1ab)](0x190)[_0xd30a5e(0x19c)]({'errorMessage':_0x49bcda[_0xd30a5e(0x1ca)]});}}),router[a0_0x452efa(0x19b)](a0_0x452efa(0x1b2),async(_0x11f837,_0xdef03e)=>{const _0x530000=a0_0x452efa;try{const {warehouse_name:_0x383d92,cat:_0x24c14a,valNew:_0x2ff013}=_0x11f837[_0x530000(0x1a9)];var _0x13e00e='',_0x8d832d='';if(_0x24c14a==_0x530000(0x1b5))_0x13e00e=_0x530000(0x1c7),_0x2ff013==_0x530000(0x1c9)?_0x8d832d=[{'$match':{'status':_0x530000(0x1b1),'warehouse_category':_0x24c14a,'name':{'$ne':_0x13e00e},'name':_0x530000(0x1a1)}},{'$group':{'_id':_0x530000(0x1d1),'room_name':{'$first':_0x530000(0x1d1)}}},{'$sort':{'room_name':0x1}}]:_0x8d832d=[{'$match':{'status':_0x530000(0x1b1),'warehouse_category':_0x24c14a,'name':{'$ne':_0x13e00e}}},{'$group':{'_id':_0x530000(0x1d1),'room_name':{'$first':_0x530000(0x1d1)}}},{'$sort':{'room_name':0x1}}];else _0x24c14a==_0x530000(0x1c0)?(_0x13e00e=_0x530000(0x1c3),_0x8d832d=[{'$match':{'status':_0x530000(0x1b1),'warehouse_category':_0x24c14a,'name':{'$ne':_0x13e00e}}},{'$group':{'_id':_0x530000(0x1d1),'room_name':{'$first':_0x530000(0x1d1)}}},{'$sort':{'room_name':0x1}}]):_0x8d832d=[{'$match':{'status':_0x530000(0x1b1)}},{'$group':{'_id':_0x530000(0x1d1),'room_name':{'$first':_0x530000(0x1d1)}}},{'$sort':{'room_name':0x1}}];const _0x152b02=await warehouse[_0x530000(0x1ba)](_0x8d832d);_0xdef03e['status'](0xc8)[_0x530000(0x19c)](_0x152b02);}catch(_0x7e0a52){_0xdef03e[_0x530000(0x1ab)](0x190)[_0x530000(0x19c)]({'errorMessage':_0x7e0a52[_0x530000(0x1ca)]}),console[_0x530000(0x1d0)](_0x7e0a52);}}),router[a0_0x452efa(0x19b)](a0_0x452efa(0x19a),async(_0x50b3c1,_0x2deb71)=>{const _0x7f2c5f=a0_0x452efa;try{const {warehouse_name:_0x261f17,cat:_0x1de361}=_0x50b3c1['body'],_0x52356e=await warehouse[_0x7f2c5f(0x1ba)]([{'$match':{'status':_0x7f2c5f(0x1b1),'warehouse_category':_0x1de361,'name':_0x261f17}},{'$group':{'_id':_0x7f2c5f(0x19f),'room_name':{'$first':_0x7f2c5f(0x19f)}}},{'$sort':{'room_name':0x1}}]);_0x2deb71[_0x7f2c5f(0x1ab)](0xc8)[_0x7f2c5f(0x19c)](_0x52356e);}catch(_0x5c0083){_0x2deb71[_0x7f2c5f(0x1ab)](0x190)['json']({'errorMessage':_0x5c0083['message']});}}),module[a0_0x452efa(0x1ad)]=router;