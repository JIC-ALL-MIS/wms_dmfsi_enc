const a0_0x2315c4=a0_0x921c;function a0_0x921c(_0x1699d4,_0x10b110){const _0x2d8b9b=a0_0x2d8b();return a0_0x921c=function(_0x921c4f,_0x2a9c3){_0x921c4f=_0x921c4f-0x14c;let _0x489148=_0x2d8b9b[_0x921c4f];return _0x489148;},a0_0x921c(_0x1699d4,_0x10b110);}(function(_0x39a488,_0x5087be){const _0x2f542f=a0_0x921c,_0x226016=_0x39a488();while(!![]){try{const _0x2eca52=parseInt(_0x2f542f(0x166))/0x1+parseInt(_0x2f542f(0x187))/0x2*(parseInt(_0x2f542f(0x196))/0x3)+-parseInt(_0x2f542f(0x161))/0x4+parseInt(_0x2f542f(0x16f))/0x5*(-parseInt(_0x2f542f(0x169))/0x6)+-parseInt(_0x2f542f(0x14f))/0x7*(parseInt(_0x2f542f(0x17f))/0x8)+-parseInt(_0x2f542f(0x17a))/0x9+-parseInt(_0x2f542f(0x15e))/0xa*(-parseInt(_0x2f542f(0x18b))/0xb);if(_0x2eca52===_0x5087be)break;else _0x226016['push'](_0x226016['shift']());}catch(_0x37ef8d){_0x226016['push'](_0x226016['shift']());}}}(a0_0x2d8b,0x59612));const express=require('express'),app=express(),router=express[a0_0x2315c4(0x16a)](),multer=require(a0_0x2315c4(0x18c)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require('../middleware/auth');var timezones=require(a0_0x2315c4(0x189));const users=require(a0_0x2315c4(0x154));function a0_0x2d8b(){const _0x5cb952=['24865GLVXlu','exports','Chinese','email','/view','warehousemap_incoming','$_id.type','aggregate','Portuguese\x20(BR)','$product_details.floorlevel','product','3583278zOZUHm','render','$product_details.bin','status','staff','27432irCLnS','Hindi','/Rooms_data3','master','$_id','findOne','$product_details.product_stock','role','22nDbtIY','/MapData','timezones-list','success','11312862sQvQHF','multer','French','$product_details.product_code','log','$production_date','post','$_id.bay','flash','DRY\x20STORAGE','$product_details.type','2283WGlKLi','$product_details.product_name','Raw\x20Materials','body','QA\x20Warehouse','1358ekwhCB','$expiry_date','English','Spanish','Arabic','../public/language/languages.json','$room','json','find','$name','Enabled','errors','$product_details.expiry_date','$_id.bin','timezone','20XghPHw','$product_details.bay','pack','2853300LvKpDI','$batch_code','message','get','user','460457nRWEDm','English\x20(US)','$product_code','462mvypTy','Router','language','$product_details','/Rooms_data2','$_id.floorlevel'];a0_0x2d8b=function(){return _0x5cb952;};return a0_0x2d8b();}router[a0_0x2315c4(0x164)](a0_0x2315c4(0x173),auth,async(_0x5284eb,_0x18f706)=>{const _0x3e3f94=a0_0x2315c4;try{const {username:_0x451f4f,email:_0x4410ec,role:_0x3fe35f}=_0x5284eb[_0x3e3f94(0x165)],_0xe0ee0a=_0x5284eb['user'],_0x34f5f5=await profile[_0x3e3f94(0x184)]({'email':_0xe0ee0a[_0x3e3f94(0x172)]}),_0x5641fc=await master_shop[_0x3e3f94(0x157)]();console[_0x3e3f94(0x18f)](_0x3e3f94(0x182),_0x5641fc);let _0x38e068;if(_0xe0ee0a[_0x3e3f94(0x186)]==_0x3e3f94(0x17e)){const _0x2b3e41=await staff['findOne']({'email':_0xe0ee0a[_0x3e3f94(0x172)]});_0x38e068=await warehouse[_0x3e3f94(0x176)]([{'$match':{'status':_0x3e3f94(0x159),'name':_0x2b3e41['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x3e3f94(0x158)}}}]);}else _0x38e068=await warehouse[_0x3e3f94(0x176)]([{'$match':{'status':_0x3e3f94(0x159)}},{'$group':{'_id':_0x3e3f94(0x158),'name':{'$first':'$name'}}}]);const _0x4adab9=new Date()['toLocaleString']('en-US',{'timeZone':_0x5641fc[0x0][_0x3e3f94(0x15d)]});console[_0x3e3f94(0x18f)](_0x3e3f94(0x15d),_0x4adab9);if(_0x5641fc[0x0][_0x3e3f94(0x16b)]==_0x3e3f94(0x167)){var _0xa44940=users[_0x3e3f94(0x151)];console[_0x3e3f94(0x18f)](_0xa44940);}else{if(_0x5641fc[0x0][_0x3e3f94(0x16b)]==_0x3e3f94(0x180))var _0xa44940=users[_0x3e3f94(0x180)];else{if(_0x5641fc[0x0][_0x3e3f94(0x16b)]=='German')var _0xa44940=users['German'];else{if(_0x5641fc[0x0]['language']==_0x3e3f94(0x152))var _0xa44940=users['Spanish'];else{if(_0x5641fc[0x0]['language']=='French')var _0xa44940=users[_0x3e3f94(0x18d)];else{if(_0x5641fc[0x0]['language']==_0x3e3f94(0x177))var _0xa44940=users['Portuguese'];else{if(_0x5641fc[0x0][_0x3e3f94(0x16b)]==_0x3e3f94(0x171))var _0xa44940=users[_0x3e3f94(0x171)];else{if(_0x5641fc[0x0][_0x3e3f94(0x16b)]=='Arabic\x20(ae)')var _0xa44940=users[_0x3e3f94(0x153)];}}}}}}}_0x18f706[_0x3e3f94(0x17b)](_0x3e3f94(0x174),{'success':_0x5284eb[_0x3e3f94(0x193)](_0x3e3f94(0x18a)),'errors':_0x5284eb[_0x3e3f94(0x193)](_0x3e3f94(0x15a)),'role':_0xe0ee0a,'profile':_0x34f5f5,'master_shop':_0x5641fc,'timezones':timezones,'language':_0xa44940,'warehouse':_0x38e068});}catch(_0x274901){console['log'](_0x274901),_0x18f706[_0x3e3f94(0x17d)](0xc8)[_0x3e3f94(0x156)]({'message':_0x274901[_0x3e3f94(0x163)]});}}),router[a0_0x2315c4(0x191)](a0_0x2315c4(0x188),async(_0x65f79,_0x2f0107)=>{const _0x9e5117=a0_0x2315c4,{warehouseNew:_0x550a02,rooms:_0x1aeb71,Type:_0x3d51b3}=_0x65f79[_0x9e5117(0x14d)],_0x336264=await warehouse[_0x9e5117(0x176)]([{'$unwind':_0x9e5117(0x16c)},{'$match':{'name':_0x550a02,'room':_0x1aeb71,'product_details.type':_0x3d51b3}},{'$group':{'_id':{'bay':_0x9e5117(0x15f),'bin':_0x9e5117(0x17c),'type':_0x9e5117(0x195),'floorlevel':_0x9e5117(0x178)},'products':{'$push':{'product_name':_0x9e5117(0x197),'product_quantity':_0x9e5117(0x185),'product_code':_0x9e5117(0x18e)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x9e5117(0x185),0x0]},'then':_0x9e5117(0x185),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x9e5117(0x192),'bin':_0x9e5117(0x15c),'type':_0x9e5117(0x175),'floorlevel':_0x9e5117(0x16e),'products':{'$filter':{'input':'$products','as':_0x9e5117(0x179),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x2f0107['json'](_0x336264);}),router['post']('/MapData2',async(_0x355df2,_0x2c8121)=>{const _0x532ffe=a0_0x2315c4,{warehouseNew:_0x405943,rooms:_0x4f3a38,room_cat:_0x638aa4}=_0x355df2[_0x532ffe(0x14d)];let _0x95703;if(_0x638aa4=='All')_0x95703=await warehouse[_0x532ffe(0x176)]([{'$unwind':_0x532ffe(0x16c)},{'$match':{'name':_0x405943}},{'$group':{'_id':{'bay':_0x532ffe(0x15f),'product':_0x532ffe(0x197),'expiry':_0x532ffe(0x15b)},'count':{'$sum':'$product_details.product_stock'},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':_0x532ffe(0x15b)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x532ffe(0x18e)}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':'$_id.product','quantity':'$count','production_date':_0x532ffe(0x190),'expiry_date':_0x532ffe(0x150),'batch_code':_0x532ffe(0x162),'product_code':_0x532ffe(0x168)}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x532ffe(0x183),'products':0x1,'totalQuantity':0x1}}]),console['log'](_0x638aa4);else{}_0x2c8121[_0x532ffe(0x156)](_0x95703);}),router['post']('/Rooms_data',async(_0x4974a9,_0x52a3df)=>{const _0x16adc1=a0_0x2315c4;try{const {warehouse_name:_0x2f3cbc,A:_0x3b3d07,B:_0x35d083}=_0x4974a9['body'];var _0x446bde='';_0x3b3d07=='raw'?_0x35d083==_0x16adc1(0x160)?_0x446bde=[{'$match':{'name':_0x2f3cbc,'status':'Enabled','room':'Rack\x20A'}},{'$group':{'_id':'$_id','room_name':{'$first':_0x16adc1(0x155)}}},{'$sort':{'room_name':0x1}}]:_0x446bde=[{'$match':{'name':_0x2f3cbc,'status':_0x16adc1(0x159)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x16adc1(0x155)}}},{'$sort':{'room_name':0x1}}]:_0x446bde=[{'$match':{'name':_0x2f3cbc,'status':_0x16adc1(0x159)}},{'$group':{'_id':_0x16adc1(0x183),'room_name':{'$first':_0x16adc1(0x155)}}},{'$sort':{'room_name':0x1}}];const _0x47015a=await warehouse[_0x16adc1(0x176)](_0x446bde);_0x52a3df['status'](0xc8)[_0x16adc1(0x156)](_0x47015a);}catch(_0xd9261c){_0x52a3df[_0x16adc1(0x17d)](0x190)[_0x16adc1(0x156)]({'errorMessage':_0xd9261c[_0x16adc1(0x163)]});}}),router[a0_0x2315c4(0x191)](a0_0x2315c4(0x16d),async(_0x3d5251,_0x4f5f43)=>{const _0x59f8be=a0_0x2315c4;try{const {warehouse_name:_0x89944a,cat:_0x4190af,valNew:_0x12088a}=_0x3d5251[_0x59f8be(0x14d)];var _0x5a971b='',_0x4454ce='';if(_0x4190af==_0x59f8be(0x14c))_0x5a971b='Return\x20Goods',_0x12088a=='pack'?_0x4454ce=[{'$match':{'status':'Enabled','warehouse_category':_0x4190af,'name':{'$ne':_0x5a971b},'name':_0x59f8be(0x194)}},{'$group':{'_id':_0x59f8be(0x158),'room_name':{'$first':_0x59f8be(0x158)}}},{'$sort':{'room_name':0x1}}]:_0x4454ce=[{'$match':{'status':_0x59f8be(0x159),'warehouse_category':_0x4190af,'name':{'$ne':_0x5a971b}}},{'$group':{'_id':'$name','room_name':{'$first':_0x59f8be(0x158)}}},{'$sort':{'room_name':0x1}}];else _0x4190af=='Finished\x20Goods'?(_0x5a971b=_0x59f8be(0x14e),_0x4454ce=[{'$match':{'status':'Enabled','warehouse_category':_0x4190af,'name':{'$ne':_0x5a971b}}},{'$group':{'_id':_0x59f8be(0x158),'room_name':{'$first':_0x59f8be(0x158)}}},{'$sort':{'room_name':0x1}}]):_0x4454ce=[{'$match':{'status':_0x59f8be(0x159)}},{'$group':{'_id':'$name','room_name':{'$first':_0x59f8be(0x158)}}},{'$sort':{'room_name':0x1}}];const _0x39e604=await warehouse['aggregate'](_0x4454ce);_0x4f5f43[_0x59f8be(0x17d)](0xc8)[_0x59f8be(0x156)](_0x39e604);}catch(_0x54ff46){_0x4f5f43[_0x59f8be(0x17d)](0x190)[_0x59f8be(0x156)]({'errorMessage':_0x54ff46['message']}),console[_0x59f8be(0x18f)](_0x54ff46);}}),router['post'](a0_0x2315c4(0x181),async(_0x13bb19,_0x2a1764)=>{const _0x2da031=a0_0x2315c4;try{const {warehouse_name:_0xf0e912,cat:_0x2dbf12}=_0x13bb19[_0x2da031(0x14d)],_0x18f1c6=await warehouse[_0x2da031(0x176)]([{'$match':{'status':_0x2da031(0x159),'warehouse_category':_0x2dbf12,'name':_0xf0e912}},{'$group':{'_id':_0x2da031(0x155),'room_name':{'$first':_0x2da031(0x155)}}},{'$sort':{'room_name':0x1}}]);_0x2a1764[_0x2da031(0x17d)](0xc8)[_0x2da031(0x156)](_0x18f1c6);}catch(_0x49c320){_0x2a1764[_0x2da031(0x17d)](0x190)[_0x2da031(0x156)]({'errorMessage':_0x49c320['message']});}}),module[a0_0x2315c4(0x170)]=router;