const a0_0x343695=a0_0x25ef;(function(_0x534562,_0x361a2b){const _0x351174=a0_0x25ef,_0x341f3=_0x534562();while(!![]){try{const _0x2fe319=-parseInt(_0x351174(0xc1))/0x1*(parseInt(_0x351174(0xb2))/0x2)+-parseInt(_0x351174(0xa6))/0x3+parseInt(_0x351174(0xc8))/0x4*(-parseInt(_0x351174(0x7a))/0x5)+-parseInt(_0x351174(0x88))/0x6+parseInt(_0x351174(0xc6))/0x7*(-parseInt(_0x351174(0x7b))/0x8)+-parseInt(_0x351174(0xb1))/0x9+parseInt(_0x351174(0xc9))/0xa;if(_0x2fe319===_0x361a2b)break;else _0x341f3['push'](_0x341f3['shift']());}catch(_0xaf5568){_0x341f3['push'](_0x341f3['shift']());}}}(a0_0x441e,0xf1aa1));const express=require(a0_0x343695(0x8d)),app=express(),router=express[a0_0x343695(0xb3)](),multer=require(a0_0x343695(0xa2)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require(a0_0x343695(0xbd));function a0_0x25ef(_0x46cd29,_0xc73b5a){const _0x441ec=a0_0x441e();return a0_0x25ef=function(_0x25ef24,_0xbdb48c){_0x25ef24=_0x25ef24-0x79;let _0x10dd70=_0x441ec[_0x25ef24];return _0x10dd70;},a0_0x25ef(_0x46cd29,_0xc73b5a);}function a0_0x441e(){const _0x2894b7=['14111432JWndAk','$_id.bay','$production_date','/MapData2','Hindi','raw','status','email','staff','user','Portuguese','$expiry_date','DRY\x20STORAGE','240156XJGAnW','/view','post','$product_details.product_code','$product_details.product_name','express','/Rooms_data3','aggregate','pack','exports','$product_details.bay','English\x20(US)','Return\x20Goods','$product_details.batch_code','flash','en-US','get','render','Arabic','$product_details','timezones-list','$_id','$product_details.floorlevel','Spanish','$_id.bin','/Rooms_data2','multer','Arabic\x20(ae)','$$product.product_quantity','Enabled','4181472BokwwF','$product_details.bin','Chinese','$name','warehouse','QA\x20Warehouse','$product_details.production_date','product','$batch_code','log','findOne','14414742DQiaCB','38ArULwQ','Router','Raw\x20Materials','$product_details.product_stock','toLocaleString','/MapData','find','All','$room','role','body','../middleware/auth','German','../public/language/languages.json','$products','33923OoTOjl','$_id.product','message','$count','$product_details.expiry_date','7URsass','json','1397372rrFVow','67831540WQcxHS','timezone','language','5sSSoEK'];a0_0x441e=function(){return _0x2894b7;};return a0_0x441e();}var timezones=require(a0_0x343695(0x9c));const users=require(a0_0x343695(0xbf));router[a0_0x343695(0x98)](a0_0x343695(0x89),auth,async(_0x2cbf4d,_0x575f70)=>{const _0x3baf3e=a0_0x343695;try{const {username:_0x5c8693,email:_0x345315,role:_0x3de44c}=_0x2cbf4d[_0x3baf3e(0x84)],_0x5665bd=_0x2cbf4d[_0x3baf3e(0x84)],_0x265127=await profile[_0x3baf3e(0xb0)]({'email':_0x5665bd[_0x3baf3e(0x82)]}),_0x82ffe9=await master_shop[_0x3baf3e(0xb8)]();console[_0x3baf3e(0xaf)]('master',_0x82ffe9);let _0x39b959;if(_0x5665bd[_0x3baf3e(0xbb)]==_0x3baf3e(0x83)){const _0xc8263c=await staff[_0x3baf3e(0xb0)]({'email':_0x5665bd[_0x3baf3e(0x82)]});_0x39b959=await warehouse[_0x3baf3e(0x8f)]([{'$match':{'status':_0x3baf3e(0xa5),'name':_0xc8263c[_0x3baf3e(0xaa)]}},{'$group':{'_id':_0x3baf3e(0xa9),'name':{'$first':_0x3baf3e(0xa9)}}}]);}else _0x39b959=await warehouse['aggregate']([{'$match':{'status':_0x3baf3e(0xa5)}},{'$group':{'_id':_0x3baf3e(0xa9),'name':{'$first':_0x3baf3e(0xa9)}}}]);const _0x17c075=new Date()[_0x3baf3e(0xb6)](_0x3baf3e(0x97),{'timeZone':_0x82ffe9[0x0][_0x3baf3e(0xca)]});console[_0x3baf3e(0xaf)](_0x3baf3e(0xca),_0x17c075);if(_0x82ffe9[0x0][_0x3baf3e(0x79)]==_0x3baf3e(0x93)){var _0x53bd97=users['English'];console[_0x3baf3e(0xaf)](_0x53bd97);}else{if(_0x82ffe9[0x0][_0x3baf3e(0x79)]==_0x3baf3e(0x7f))var _0x53bd97=users[_0x3baf3e(0x7f)];else{if(_0x82ffe9[0x0][_0x3baf3e(0x79)]==_0x3baf3e(0xbe))var _0x53bd97=users[_0x3baf3e(0xbe)];else{if(_0x82ffe9[0x0]['language']=='Spanish')var _0x53bd97=users[_0x3baf3e(0x9f)];else{if(_0x82ffe9[0x0][_0x3baf3e(0x79)]=='French')var _0x53bd97=users['French'];else{if(_0x82ffe9[0x0][_0x3baf3e(0x79)]=='Portuguese\x20(BR)')var _0x53bd97=users[_0x3baf3e(0x85)];else{if(_0x82ffe9[0x0]['language']==_0x3baf3e(0xa8))var _0x53bd97=users[_0x3baf3e(0xa8)];else{if(_0x82ffe9[0x0][_0x3baf3e(0x79)]==_0x3baf3e(0xa3))var _0x53bd97=users[_0x3baf3e(0x9a)];}}}}}}}_0x575f70[_0x3baf3e(0x99)]('warehousemap_incoming',{'success':_0x2cbf4d[_0x3baf3e(0x96)]('success'),'errors':_0x2cbf4d[_0x3baf3e(0x96)]('errors'),'role':_0x5665bd,'profile':_0x265127,'master_shop':_0x82ffe9,'timezones':timezones,'language':_0x53bd97,'warehouse':_0x39b959});}catch(_0x2a6fa2){console[_0x3baf3e(0xaf)](_0x2a6fa2),_0x575f70['status'](0xc8)[_0x3baf3e(0xc7)]({'message':_0x2a6fa2[_0x3baf3e(0xc3)]});}}),router[a0_0x343695(0x8a)](a0_0x343695(0xb7),async(_0x5c467d,_0x4f4a83)=>{const _0x5bf9d4=a0_0x343695,{warehouseNew:_0x1e1421,rooms:_0x237e64,Type:_0x599eb2}=_0x5c467d[_0x5bf9d4(0xbc)],_0x301c13=await warehouse[_0x5bf9d4(0x8f)]([{'$unwind':_0x5bf9d4(0x9b)},{'$match':{'name':_0x1e1421,'room':_0x237e64,'product_details.type':_0x599eb2}},{'$group':{'_id':{'bay':_0x5bf9d4(0x92),'bin':_0x5bf9d4(0xa7),'type':'$product_details.type','floorlevel':_0x5bf9d4(0x9e)},'products':{'$push':{'product_name':_0x5bf9d4(0x8c),'product_quantity':_0x5bf9d4(0xb5),'product_code':_0x5bf9d4(0x8b)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x5bf9d4(0xb5),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x5bf9d4(0x7c),'bin':_0x5bf9d4(0xa0),'type':'$_id.type','floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x5bf9d4(0xc0),'as':_0x5bf9d4(0xad),'cond':{'$gt':[_0x5bf9d4(0xa4),0x0]}}},'totalQuantity':0x1}}]);_0x4f4a83[_0x5bf9d4(0xc7)](_0x301c13);}),router[a0_0x343695(0x8a)](a0_0x343695(0x7e),async(_0x2b4f2d,_0xbaf6e4)=>{const _0x7e647b=a0_0x343695,{warehouseNew:_0x34c8f2,rooms:_0x1cca59,room_cat:_0x26de4b}=_0x2b4f2d[_0x7e647b(0xbc)];let _0x220204;if(_0x26de4b==_0x7e647b(0xb9))_0x220204=await warehouse[_0x7e647b(0x8f)]([{'$unwind':_0x7e647b(0x9b)},{'$match':{'name':_0x34c8f2}},{'$group':{'_id':{'bay':_0x7e647b(0x92),'product':_0x7e647b(0x8c),'expiry':_0x7e647b(0xc5)},'count':{'$sum':_0x7e647b(0xb5)},'production_date':{'$first':_0x7e647b(0xac)},'expiry_date':{'$first':_0x7e647b(0xc5)},'batch_code':{'$first':_0x7e647b(0x95)},'product_code':{'$first':_0x7e647b(0x8b)}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':_0x7e647b(0xc2),'quantity':'$count','production_date':_0x7e647b(0x7d),'expiry_date':_0x7e647b(0x86),'batch_code':_0x7e647b(0xae),'product_code':'$product_code'}},'totalQuantity':{'$sum':_0x7e647b(0xc4)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x7e647b(0xaf)](_0x26de4b);else{}_0xbaf6e4[_0x7e647b(0xc7)](_0x220204);}),router[a0_0x343695(0x8a)]('/Rooms_data',async(_0xd38a37,_0x4a7216)=>{const _0x382078=a0_0x343695;try{const {warehouse_name:_0x1a4835,A:_0x46501d,B:_0xbc9959}=_0xd38a37['body'];var _0x15c1c3='';_0x46501d==_0x382078(0x80)?_0xbc9959==_0x382078(0x90)?_0x15c1c3=[{'$match':{'name':_0x1a4835,'status':_0x382078(0xa5),'room':'Rack\x20A'}},{'$group':{'_id':_0x382078(0x9d),'room_name':{'$first':_0x382078(0xba)}}},{'$sort':{'room_name':0x1}}]:_0x15c1c3=[{'$match':{'name':_0x1a4835,'status':_0x382078(0xa5)}},{'$group':{'_id':_0x382078(0x9d),'room_name':{'$first':_0x382078(0xba)}}},{'$sort':{'room_name':0x1}}]:_0x15c1c3=[{'$match':{'name':_0x1a4835,'status':'Enabled'}},{'$group':{'_id':_0x382078(0x9d),'room_name':{'$first':_0x382078(0xba)}}},{'$sort':{'room_name':0x1}}];const _0x5540b6=await warehouse['aggregate'](_0x15c1c3);_0x4a7216[_0x382078(0x81)](0xc8)[_0x382078(0xc7)](_0x5540b6);}catch(_0x59f9dc){_0x4a7216[_0x382078(0x81)](0x190)['json']({'errorMessage':_0x59f9dc['message']});}}),router['post'](a0_0x343695(0xa1),async(_0x9d42d3,_0x10f8cf)=>{const _0x5d66c2=a0_0x343695;try{const {warehouse_name:_0x257130,cat:_0x200a68,valNew:_0x2a3731}=_0x9d42d3[_0x5d66c2(0xbc)];var _0x3f72e8='',_0x225627='';if(_0x200a68==_0x5d66c2(0xb4))_0x3f72e8=_0x5d66c2(0x94),_0x2a3731==_0x5d66c2(0x90)?_0x225627=[{'$match':{'status':_0x5d66c2(0xa5),'warehouse_category':_0x200a68,'name':{'$ne':_0x3f72e8},'name':_0x5d66c2(0x87)}},{'$group':{'_id':_0x5d66c2(0xa9),'room_name':{'$first':_0x5d66c2(0xa9)}}},{'$sort':{'room_name':0x1}}]:_0x225627=[{'$match':{'status':_0x5d66c2(0xa5),'warehouse_category':_0x200a68,'name':{'$ne':_0x3f72e8}}},{'$group':{'_id':_0x5d66c2(0xa9),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0x200a68=='Finished\x20Goods'?(_0x3f72e8=_0x5d66c2(0xab),_0x225627=[{'$match':{'status':_0x5d66c2(0xa5),'warehouse_category':_0x200a68,'name':{'$ne':_0x3f72e8}}},{'$group':{'_id':_0x5d66c2(0xa9),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x225627=[{'$match':{'status':_0x5d66c2(0xa5)}},{'$group':{'_id':_0x5d66c2(0xa9),'room_name':{'$first':_0x5d66c2(0xa9)}}},{'$sort':{'room_name':0x1}}];const _0x2c3d5e=await warehouse[_0x5d66c2(0x8f)](_0x225627);_0x10f8cf[_0x5d66c2(0x81)](0xc8)[_0x5d66c2(0xc7)](_0x2c3d5e);}catch(_0x491860){_0x10f8cf['status'](0x190)[_0x5d66c2(0xc7)]({'errorMessage':_0x491860['message']}),console[_0x5d66c2(0xaf)](_0x491860);}}),router['post'](a0_0x343695(0x8e),async(_0x9984df,_0x14e9cd)=>{const _0x33cd15=a0_0x343695;try{const {warehouse_name:_0x451592,cat:_0x5c9624}=_0x9984df['body'],_0x4c7190=await warehouse[_0x33cd15(0x8f)]([{'$match':{'status':'Enabled','warehouse_category':_0x5c9624,'name':_0x451592}},{'$group':{'_id':_0x33cd15(0xba),'room_name':{'$first':_0x33cd15(0xba)}}},{'$sort':{'room_name':0x1}}]);_0x14e9cd[_0x33cd15(0x81)](0xc8)[_0x33cd15(0xc7)](_0x4c7190);}catch(_0x2590e){_0x14e9cd['status'](0x190)[_0x33cd15(0xc7)]({'errorMessage':_0x2590e[_0x33cd15(0xc3)]});}}),module[a0_0x343695(0x91)]=router;