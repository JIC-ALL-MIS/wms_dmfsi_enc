const a0_0x2c139b=a0_0x5848;function a0_0x10a3(){const _0x546414=['Hindi','$_id.product','$product_details.product_stock','findOne','warehouse','640XTOjkA','$_id.floorlevel','$_id.bay','$product_details.bay','../public/language/languages.json','json','58QBmZRo','pack','$product_details.expiry_date','timezones-list','master','language','QA\x20Warehouse','German','All','88hmmiuA','user','$product_details','1880217adHpPU','email','$product_details.floorlevel','18916hGIfEn','$product_details.product_name','$product_details.bin','Spanish','../middleware/auth','Enabled','$room','$production_date','Chinese','/Rooms_data3','$batch_code','5445856zkDEcY','2980962nAjsNH','../models/all_models','130980GDPFlC','/MapData2','$name','$product_code','408QvwCeY','$_id.bin','$$product.product_quantity','/MapData','raw','body','errors','Router','Arabic','message','status','$_id.type','role','$product_details.product_code','/Rooms_data','/Rooms_data2','$product_details.production_date','post','log','Return\x20Goods','Portuguese','DRY\x20STORAGE','multer','Raw\x20Materials','/view','$products','$count','flash','Rack\x20A','timezone','success','223817HnuuYP','aggregate','English\x20(US)','toLocaleString','74634pGGrnI','French','product','Arabic\x20(ae)','get','$_id','render','find'];a0_0x10a3=function(){return _0x546414;};return a0_0x10a3();}(function(_0x32dba6,_0x1a0f11){const _0xcd40ed=a0_0x5848,_0x213266=_0x32dba6();while(!![]){try{const _0x2ddd4d=-parseInt(_0xcd40ed(0x198))/0x1*(parseInt(_0xcd40ed(0x189))/0x2)+parseInt(_0xcd40ed(0x195))/0x3+-parseInt(_0xcd40ed(0x192))/0x4*(parseInt(_0xcd40ed(0x14f))/0x5)+-parseInt(_0xcd40ed(0x153))/0x6*(parseInt(_0xcd40ed(0x176))/0x7)+parseInt(_0xcd40ed(0x1a3))/0x8+-parseInt(_0xcd40ed(0x1a4))/0x9+-parseInt(_0xcd40ed(0x183))/0xa*(-parseInt(_0xcd40ed(0x172))/0xb);if(_0x2ddd4d===_0x1a0f11)break;else _0x213266['push'](_0x213266['shift']());}catch(_0x2f257d){_0x213266['push'](_0x213266['shift']());}}}(a0_0x10a3,0x68a19));function a0_0x5848(_0x55965b,_0x5b8463){const _0x10a37b=a0_0x10a3();return a0_0x5848=function(_0x584844,_0x4c9476){_0x584844=_0x584844-0x14f;let _0x42ecf8=_0x10a37b[_0x584844];return _0x42ecf8;},a0_0x5848(_0x55965b,_0x5b8463);}const express=require('express'),app=express(),router=express[a0_0x2c139b(0x15a)](),multer=require(a0_0x2c139b(0x169)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x2c139b(0x1a5)),auth=require(a0_0x2c139b(0x19c));var timezones=require(a0_0x2c139b(0x18c));const users=require(a0_0x2c139b(0x187));router[a0_0x2c139b(0x17a)](a0_0x2c139b(0x16b),auth,async(_0x535846,_0x52dc18)=>{const _0x4b8819=a0_0x2c139b;try{const {username:_0x3fe320,email:_0x34caf6,role:_0x431626}=_0x535846[_0x4b8819(0x193)],_0x1e2e59=_0x535846['user'],_0x2e1e8f=await profile[_0x4b8819(0x181)]({'email':_0x1e2e59['email']}),_0x38d69d=await master_shop[_0x4b8819(0x17d)]();console[_0x4b8819(0x165)](_0x4b8819(0x18d),_0x38d69d);let _0xca75e2;if(_0x1e2e59[_0x4b8819(0x15f)]=='staff'){const _0x4b5642=await staff[_0x4b8819(0x181)]({'email':_0x1e2e59[_0x4b8819(0x196)]});_0xca75e2=await warehouse['aggregate']([{'$match':{'status':_0x4b8819(0x19d),'name':_0x4b5642[_0x4b8819(0x182)]}},{'$group':{'_id':_0x4b8819(0x151),'name':{'$first':_0x4b8819(0x151)}}}]);}else _0xca75e2=await warehouse[_0x4b8819(0x173)]([{'$match':{'status':_0x4b8819(0x19d)}},{'$group':{'_id':_0x4b8819(0x151),'name':{'$first':_0x4b8819(0x151)}}}]);const _0x1feae0=new Date()[_0x4b8819(0x175)]('en-US',{'timeZone':_0x38d69d[0x0]['timezone']});console[_0x4b8819(0x165)](_0x4b8819(0x170),_0x1feae0);if(_0x38d69d[0x0][_0x4b8819(0x18e)]==_0x4b8819(0x174)){var _0x301782=users['English'];console[_0x4b8819(0x165)](_0x301782);}else{if(_0x38d69d[0x0][_0x4b8819(0x18e)]==_0x4b8819(0x17e))var _0x301782=users[_0x4b8819(0x17e)];else{if(_0x38d69d[0x0][_0x4b8819(0x18e)]==_0x4b8819(0x190))var _0x301782=users[_0x4b8819(0x190)];else{if(_0x38d69d[0x0][_0x4b8819(0x18e)]==_0x4b8819(0x19b))var _0x301782=users['Spanish'];else{if(_0x38d69d[0x0]['language']==_0x4b8819(0x177))var _0x301782=users['French'];else{if(_0x38d69d[0x0]['language']=='Portuguese\x20(BR)')var _0x301782=users[_0x4b8819(0x167)];else{if(_0x38d69d[0x0][_0x4b8819(0x18e)]==_0x4b8819(0x1a0))var _0x301782=users[_0x4b8819(0x1a0)];else{if(_0x38d69d[0x0][_0x4b8819(0x18e)]==_0x4b8819(0x179))var _0x301782=users[_0x4b8819(0x15b)];}}}}}}}_0x52dc18[_0x4b8819(0x17c)]('warehousemap_incoming',{'success':_0x535846[_0x4b8819(0x16e)](_0x4b8819(0x171)),'errors':_0x535846['flash'](_0x4b8819(0x159)),'role':_0x1e2e59,'profile':_0x2e1e8f,'master_shop':_0x38d69d,'timezones':timezones,'language':_0x301782,'warehouse':_0xca75e2});}catch(_0x1d6525){console[_0x4b8819(0x165)](_0x1d6525),_0x52dc18[_0x4b8819(0x15d)](0xc8)[_0x4b8819(0x188)]({'message':_0x1d6525['message']});}}),router[a0_0x2c139b(0x164)](a0_0x2c139b(0x156),async(_0x40ee52,_0x2875d1)=>{const _0xf697c1=a0_0x2c139b,{warehouseNew:_0x2633f6,rooms:_0x1240b7,Type:_0x2de825}=_0x40ee52[_0xf697c1(0x158)],_0x5b2552=await warehouse[_0xf697c1(0x173)]([{'$unwind':_0xf697c1(0x194)},{'$match':{'name':_0x2633f6,'room':_0x1240b7,'product_details.type':_0x2de825}},{'$group':{'_id':{'bay':'$product_details.bay','bin':_0xf697c1(0x19a),'type':'$product_details.type','floorlevel':_0xf697c1(0x197)},'products':{'$push':{'product_name':_0xf697c1(0x199),'product_quantity':_0xf697c1(0x180),'product_code':_0xf697c1(0x160)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0xf697c1(0x180),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0xf697c1(0x185),'bin':_0xf697c1(0x154),'type':_0xf697c1(0x15e),'floorlevel':_0xf697c1(0x184),'products':{'$filter':{'input':_0xf697c1(0x16c),'as':_0xf697c1(0x178),'cond':{'$gt':[_0xf697c1(0x155),0x0]}}},'totalQuantity':0x1}}]);_0x2875d1[_0xf697c1(0x188)](_0x5b2552);}),router[a0_0x2c139b(0x164)](a0_0x2c139b(0x150),async(_0x616e20,_0x4a204c)=>{const _0x2c8006=a0_0x2c139b,{warehouseNew:_0x203567,rooms:_0x5c96d9,room_cat:_0x532e97}=_0x616e20[_0x2c8006(0x158)];let _0x1a5fc4;if(_0x532e97==_0x2c8006(0x191))_0x1a5fc4=await warehouse[_0x2c8006(0x173)]([{'$unwind':_0x2c8006(0x194)},{'$match':{'name':_0x203567}},{'$group':{'_id':{'bay':_0x2c8006(0x186),'product':_0x2c8006(0x199),'expiry':_0x2c8006(0x18b)},'count':{'$sum':_0x2c8006(0x180)},'production_date':{'$first':_0x2c8006(0x163)},'expiry_date':{'$first':_0x2c8006(0x18b)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x2c8006(0x160)}}},{'$group':{'_id':_0x2c8006(0x185),'products':{'$push':{'product':_0x2c8006(0x17f),'quantity':'$count','production_date':_0x2c8006(0x19f),'expiry_date':'$expiry_date','batch_code':_0x2c8006(0x1a2),'product_code':_0x2c8006(0x152)}},'totalQuantity':{'$sum':_0x2c8006(0x16d)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x2c8006(0x17b),'products':0x1,'totalQuantity':0x1}}]),console['log'](_0x532e97);else{}_0x4a204c[_0x2c8006(0x188)](_0x1a5fc4);}),router['post'](a0_0x2c139b(0x161),async(_0xea7d79,_0x223f9d)=>{const _0x1d30dd=a0_0x2c139b;try{const {warehouse_name:_0x53c0ff,A:_0x56cdcf,B:_0x5b1435}=_0xea7d79[_0x1d30dd(0x158)];var _0x2a9510='';_0x56cdcf==_0x1d30dd(0x157)?_0x5b1435==_0x1d30dd(0x18a)?_0x2a9510=[{'$match':{'name':_0x53c0ff,'status':_0x1d30dd(0x19d),'room':_0x1d30dd(0x16f)}},{'$group':{'_id':_0x1d30dd(0x17b),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]:_0x2a9510=[{'$match':{'name':_0x53c0ff,'status':_0x1d30dd(0x19d)}},{'$group':{'_id':_0x1d30dd(0x17b),'room_name':{'$first':_0x1d30dd(0x19e)}}},{'$sort':{'room_name':0x1}}]:_0x2a9510=[{'$match':{'name':_0x53c0ff,'status':_0x1d30dd(0x19d)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x1d30dd(0x19e)}}},{'$sort':{'room_name':0x1}}];const _0x4cdbeb=await warehouse['aggregate'](_0x2a9510);_0x223f9d[_0x1d30dd(0x15d)](0xc8)['json'](_0x4cdbeb);}catch(_0x5daa2a){_0x223f9d[_0x1d30dd(0x15d)](0x190)[_0x1d30dd(0x188)]({'errorMessage':_0x5daa2a['message']});}}),router['post'](a0_0x2c139b(0x162),async(_0x2d75ec,_0x4f877d)=>{const _0x2703d7=a0_0x2c139b;try{const {warehouse_name:_0x5db8b0,cat:_0x11417b,valNew:_0x16df7e}=_0x2d75ec[_0x2703d7(0x158)];var _0x40f4a0='',_0x1f9c1c='';if(_0x11417b==_0x2703d7(0x16a))_0x40f4a0=_0x2703d7(0x166),_0x16df7e=='pack'?_0x1f9c1c=[{'$match':{'status':_0x2703d7(0x19d),'warehouse_category':_0x11417b,'name':{'$ne':_0x40f4a0},'name':_0x2703d7(0x168)}},{'$group':{'_id':'$name','room_name':{'$first':_0x2703d7(0x151)}}},{'$sort':{'room_name':0x1}}]:_0x1f9c1c=[{'$match':{'status':_0x2703d7(0x19d),'warehouse_category':_0x11417b,'name':{'$ne':_0x40f4a0}}},{'$group':{'_id':_0x2703d7(0x151),'room_name':{'$first':_0x2703d7(0x151)}}},{'$sort':{'room_name':0x1}}];else _0x11417b=='Finished\x20Goods'?(_0x40f4a0=_0x2703d7(0x18f),_0x1f9c1c=[{'$match':{'status':_0x2703d7(0x19d),'warehouse_category':_0x11417b,'name':{'$ne':_0x40f4a0}}},{'$group':{'_id':_0x2703d7(0x151),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x1f9c1c=[{'$match':{'status':_0x2703d7(0x19d)}},{'$group':{'_id':_0x2703d7(0x151),'room_name':{'$first':_0x2703d7(0x151)}}},{'$sort':{'room_name':0x1}}];const _0x3b9174=await warehouse[_0x2703d7(0x173)](_0x1f9c1c);_0x4f877d[_0x2703d7(0x15d)](0xc8)['json'](_0x3b9174);}catch(_0x235933){_0x4f877d[_0x2703d7(0x15d)](0x190)['json']({'errorMessage':_0x235933[_0x2703d7(0x15c)]}),console[_0x2703d7(0x165)](_0x235933);}}),router[a0_0x2c139b(0x164)](a0_0x2c139b(0x1a1),async(_0x1381d2,_0x53f096)=>{const _0x11ee9c=a0_0x2c139b;try{const {warehouse_name:_0x5ea6f3,cat:_0x2f1ef4}=_0x1381d2[_0x11ee9c(0x158)],_0x38fc2a=await warehouse[_0x11ee9c(0x173)]([{'$match':{'status':_0x11ee9c(0x19d),'warehouse_category':_0x2f1ef4,'name':_0x5ea6f3}},{'$group':{'_id':_0x11ee9c(0x19e),'room_name':{'$first':_0x11ee9c(0x19e)}}},{'$sort':{'room_name':0x1}}]);_0x53f096['status'](0xc8)[_0x11ee9c(0x188)](_0x38fc2a);}catch(_0x199f6d){_0x53f096[_0x11ee9c(0x15d)](0x190)[_0x11ee9c(0x188)]({'errorMessage':_0x199f6d[_0x11ee9c(0x15c)]});}}),module['exports']=router;