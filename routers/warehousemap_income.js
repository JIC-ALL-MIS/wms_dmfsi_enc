const a0_0x5ca286=a0_0x45f6;(function(_0xb70370,_0x1a8bd0){const _0x14b9c9=a0_0x45f6,_0x257ab2=_0xb70370();while(!![]){try{const _0x2e8aeb=-parseInt(_0x14b9c9(0xfb))/0x1+parseInt(_0x14b9c9(0xf9))/0x2+-parseInt(_0x14b9c9(0x10c))/0x3+parseInt(_0x14b9c9(0xe4))/0x4*(-parseInt(_0x14b9c9(0xf4))/0x5)+-parseInt(_0x14b9c9(0xfc))/0x6+-parseInt(_0x14b9c9(0xd1))/0x7*(parseInt(_0x14b9c9(0xe5))/0x8)+-parseInt(_0x14b9c9(0xea))/0x9*(-parseInt(_0x14b9c9(0x100))/0xa);if(_0x2e8aeb===_0x1a8bd0)break;else _0x257ab2['push'](_0x257ab2['shift']());}catch(_0x325ac4){_0x257ab2['push'](_0x257ab2['shift']());}}}(a0_0x1313,0x321bd));const express=require('express'),app=express(),router=express[a0_0x5ca286(0x102)](),multer=require(a0_0x5ca286(0xc9)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require('../models/all_models'),auth=require(a0_0x5ca286(0xdc));var timezones=require(a0_0x5ca286(0xf6));function a0_0x1313(){const _0x3a68fc=['Chinese','$_id.type','$product_details.expiry_date','$product_details.bay','status','$product_details','findOne','get','warehousemap_incoming','$product_code','$product_details.product_stock','multer','/MapData2','$product_details.type','$_id.bay','$product_details.production_date','$name','$_id.floorlevel','English','3157Aexrgq','Raw\x20Materials','Portuguese\x20(BR)','warehouse','staff','body','Rack\x20A','$expiry_date','$product_details.bin','French','German','../middleware/auth','email','$count','$room','Enabled','post','message','user','20clRwNF','6296IyJzKR','log','json','find','Portuguese','9DHxJui','$product_details.product_code','All','$products','$product_details.floorlevel','$product_details.product_name','/Rooms_data','flash','Finished\x20Goods','QA\x20Warehouse','73765TyPGJB','language','timezones-list','toLocaleString','timezone','506432HwXexK','$product_details.batch_code','296149JKBOXB','535710WhuXvD','en-US','Hindi','/MapData','11595890lhofRS','/Rooms_data2','Router','aggregate','$_id.product','role','$$product.product_quantity','errors','../public/language/languages.json','Arabic\x20(ae)','product','Spanish','1180272EkTXQd','English\x20(US)','$_id','raw'];a0_0x1313=function(){return _0x3a68fc;};return a0_0x1313();}const users=require(a0_0x5ca286(0x108));function a0_0x45f6(_0x394697,_0x215783){const _0x131330=a0_0x1313();return a0_0x45f6=function(_0x45f6d1,_0x2fbd0b){_0x45f6d1=_0x45f6d1-0xc7;let _0x4ab341=_0x131330[_0x45f6d1];return _0x4ab341;},a0_0x45f6(_0x394697,_0x215783);}router[a0_0x5ca286(0x117)]('/view',auth,async(_0xfa9b14,_0x507fbc)=>{const _0x11d020=a0_0x5ca286;try{const {username:_0x55f0c7,email:_0x1744d9,role:_0x3e739f}=_0xfa9b14['user'],_0x1624cc=_0xfa9b14[_0x11d020(0xe3)],_0x24f24d=await profile['findOne']({'email':_0x1624cc[_0x11d020(0xdd)]}),_0x1a1e76=await master_shop[_0x11d020(0xe8)]();console[_0x11d020(0xe6)]('master',_0x1a1e76);let _0x1b9ca0;if(_0x1624cc[_0x11d020(0x105)]==_0x11d020(0xd5)){const _0x50db9d=await staff[_0x11d020(0x116)]({'email':_0x1624cc[_0x11d020(0xdd)]});_0x1b9ca0=await warehouse[_0x11d020(0x103)]([{'$match':{'status':_0x11d020(0xe0),'name':_0x50db9d[_0x11d020(0xd4)]}},{'$group':{'_id':_0x11d020(0xce),'name':{'$first':_0x11d020(0xce)}}}]);}else _0x1b9ca0=await warehouse[_0x11d020(0x103)]([{'$match':{'status':_0x11d020(0xe0)}},{'$group':{'_id':'$name','name':{'$first':_0x11d020(0xce)}}}]);const _0x5b8af3=new Date()[_0x11d020(0xf7)](_0x11d020(0xfd),{'timeZone':_0x1a1e76[0x0][_0x11d020(0xf8)]});console[_0x11d020(0xe6)](_0x11d020(0xf8),_0x5b8af3);if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0x10d)){var _0x37fa85=users[_0x11d020(0xd0)];console[_0x11d020(0xe6)](_0x37fa85);}else{if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0xfe))var _0x37fa85=users[_0x11d020(0xfe)];else{if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0xdb))var _0x37fa85=users['German'];else{if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0x10b))var _0x37fa85=users[_0x11d020(0x10b)];else{if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0xda))var _0x37fa85=users[_0x11d020(0xda)];else{if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0xd3))var _0x37fa85=users[_0x11d020(0xe9)];else{if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0x110))var _0x37fa85=users[_0x11d020(0x110)];else{if(_0x1a1e76[0x0][_0x11d020(0xf5)]==_0x11d020(0x109))var _0x37fa85=users['Arabic'];}}}}}}}_0x507fbc['render'](_0x11d020(0x118),{'success':_0xfa9b14[_0x11d020(0xf1)]('success'),'errors':_0xfa9b14[_0x11d020(0xf1)](_0x11d020(0x107)),'role':_0x1624cc,'profile':_0x24f24d,'master_shop':_0x1a1e76,'timezones':timezones,'language':_0x37fa85,'warehouse':_0x1b9ca0});}catch(_0x4491be){console[_0x11d020(0xe6)](_0x4491be),_0x507fbc[_0x11d020(0x114)](0xc8)[_0x11d020(0xe7)]({'message':_0x4491be[_0x11d020(0xe2)]});}}),router['post'](a0_0x5ca286(0xff),async(_0x18a06e,_0x392e2b)=>{const _0x35310f=a0_0x5ca286,{warehouseNew:_0x16abca,rooms:_0x20e4da,Type:_0x2f6de1}=_0x18a06e['body'],_0x507fde=await warehouse[_0x35310f(0x103)]([{'$unwind':_0x35310f(0x115)},{'$match':{'name':_0x16abca,'room':_0x20e4da,'product_details.type':_0x2f6de1}},{'$group':{'_id':{'bay':_0x35310f(0x113),'bin':_0x35310f(0xd9),'type':_0x35310f(0xcb),'floorlevel':_0x35310f(0xee)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x35310f(0xc8),'product_code':_0x35310f(0xeb)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x35310f(0xc8),0x0]},'then':_0x35310f(0xc8),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x35310f(0xcc),'bin':'$_id.bin','type':_0x35310f(0x111),'floorlevel':_0x35310f(0xcf),'products':{'$filter':{'input':_0x35310f(0xed),'as':_0x35310f(0x10a),'cond':{'$gt':[_0x35310f(0x106),0x0]}}},'totalQuantity':0x1}}]);_0x392e2b[_0x35310f(0xe7)](_0x507fde);}),router[a0_0x5ca286(0xe1)](a0_0x5ca286(0xca),async(_0x1b81e3,_0x4a26f5)=>{const _0x2b9229=a0_0x5ca286,{warehouseNew:_0x16225b,rooms:_0x29ef6e,room_cat:_0x587194}=_0x1b81e3['body'];let _0x3eae76;if(_0x587194==_0x2b9229(0xec))_0x3eae76=await warehouse[_0x2b9229(0x103)]([{'$unwind':_0x2b9229(0x115)},{'$match':{'name':_0x16225b}},{'$group':{'_id':{'bay':_0x2b9229(0x113),'product':_0x2b9229(0xef),'expiry':_0x2b9229(0x112)},'count':{'$sum':_0x2b9229(0xc8)},'production_date':{'$first':_0x2b9229(0xcd)},'expiry_date':{'$first':_0x2b9229(0x112)},'batch_code':{'$first':_0x2b9229(0xfa)},'product_code':{'$first':_0x2b9229(0xeb)}}},{'$group':{'_id':_0x2b9229(0xcc),'products':{'$push':{'product':_0x2b9229(0x104),'quantity':_0x2b9229(0xde),'production_date':'$production_date','expiry_date':_0x2b9229(0xd8),'batch_code':'$batch_code','product_code':_0x2b9229(0xc7)}},'totalQuantity':{'$sum':_0x2b9229(0xde)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x2b9229(0x10e),'products':0x1,'totalQuantity':0x1}}]),console[_0x2b9229(0xe6)](_0x587194);else{}_0x4a26f5[_0x2b9229(0xe7)](_0x3eae76);}),router[a0_0x5ca286(0xe1)](a0_0x5ca286(0xf0),async(_0x170e79,_0x5ab77e)=>{const _0xc58105=a0_0x5ca286;try{const {warehouse_name:_0x158939,A:_0x4a6fe4,B:_0x47cca2}=_0x170e79[_0xc58105(0xd6)];var _0x20bbce='';_0x4a6fe4==_0xc58105(0x10f)?_0x47cca2=='pack'?_0x20bbce=[{'$match':{'name':_0x158939,'status':_0xc58105(0xe0),'room':_0xc58105(0xd7)}},{'$group':{'_id':_0xc58105(0x10e),'room_name':{'$first':_0xc58105(0xdf)}}},{'$sort':{'room_name':0x1}}]:_0x20bbce=[{'$match':{'name':_0x158939,'status':_0xc58105(0xe0)}},{'$group':{'_id':_0xc58105(0x10e),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]:_0x20bbce=[{'$match':{'name':_0x158939,'status':_0xc58105(0xe0)}},{'$group':{'_id':'$_id','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x4a3b83=await warehouse[_0xc58105(0x103)](_0x20bbce);_0x5ab77e[_0xc58105(0x114)](0xc8)[_0xc58105(0xe7)](_0x4a3b83);}catch(_0x22dc45){_0x5ab77e['status'](0x190)[_0xc58105(0xe7)]({'errorMessage':_0x22dc45[_0xc58105(0xe2)]});}}),router[a0_0x5ca286(0xe1)](a0_0x5ca286(0x101),async(_0x318661,_0x4be8f6)=>{const _0x29248d=a0_0x5ca286;try{const {warehouse_name:_0x1495c2,cat:_0x3be22a,valNew:_0x387ad1}=_0x318661[_0x29248d(0xd6)];var _0x368a69='',_0x4a7500='';if(_0x3be22a==_0x29248d(0xd2))_0x368a69='Return\x20Goods',_0x387ad1=='pack'?_0x4a7500=[{'$match':{'status':_0x29248d(0xe0),'warehouse_category':_0x3be22a,'name':{'$ne':_0x368a69},'name':'DRY\x20STORAGE'}},{'$group':{'_id':'$name','room_name':{'$first':_0x29248d(0xce)}}},{'$sort':{'room_name':0x1}}]:_0x4a7500=[{'$match':{'status':'Enabled','warehouse_category':_0x3be22a,'name':{'$ne':_0x368a69}}},{'$group':{'_id':_0x29248d(0xce),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];else _0x3be22a==_0x29248d(0xf2)?(_0x368a69=_0x29248d(0xf3),_0x4a7500=[{'$match':{'status':_0x29248d(0xe0),'warehouse_category':_0x3be22a,'name':{'$ne':_0x368a69}}},{'$group':{'_id':_0x29248d(0xce),'room_name':{'$first':_0x29248d(0xce)}}},{'$sort':{'room_name':0x1}}]):_0x4a7500=[{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x29248d(0xce),'room_name':{'$first':_0x29248d(0xce)}}},{'$sort':{'room_name':0x1}}];const _0x165d1b=await warehouse[_0x29248d(0x103)](_0x4a7500);_0x4be8f6[_0x29248d(0x114)](0xc8)[_0x29248d(0xe7)](_0x165d1b);}catch(_0x5581c1){_0x4be8f6[_0x29248d(0x114)](0x190)[_0x29248d(0xe7)]({'errorMessage':_0x5581c1['message']}),console['log'](_0x5581c1);}}),router[a0_0x5ca286(0xe1)]('/Rooms_data3',async(_0x54e10c,_0x237ccd)=>{const _0x352131=a0_0x5ca286;try{const {warehouse_name:_0x4e4d83,cat:_0x1efbbc}=_0x54e10c[_0x352131(0xd6)],_0x23420f=await warehouse[_0x352131(0x103)]([{'$match':{'status':_0x352131(0xe0),'warehouse_category':_0x1efbbc,'name':_0x4e4d83}},{'$group':{'_id':_0x352131(0xdf),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]);_0x237ccd['status'](0xc8)[_0x352131(0xe7)](_0x23420f);}catch(_0x15870e){_0x237ccd[_0x352131(0x114)](0x190)['json']({'errorMessage':_0x15870e['message']});}}),module['exports']=router;