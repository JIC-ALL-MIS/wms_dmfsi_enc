const a0_0x1a968b=a0_0x286e;(function(_0x377c35,_0x54c6d7){const _0x32a9c8=a0_0x286e,_0x51200c=_0x377c35();while(!![]){try{const _0x5b659b=parseInt(_0x32a9c8(0x1ec))/0x1*(parseInt(_0x32a9c8(0x20b))/0x2)+-parseInt(_0x32a9c8(0x1e8))/0x3*(-parseInt(_0x32a9c8(0x215))/0x4)+parseInt(_0x32a9c8(0x1ef))/0x5+-parseInt(_0x32a9c8(0x21e))/0x6*(-parseInt(_0x32a9c8(0x22a))/0x7)+parseInt(_0x32a9c8(0x1f0))/0x8*(-parseInt(_0x32a9c8(0x1fc))/0x9)+-parseInt(_0x32a9c8(0x1f7))/0xa+parseInt(_0x32a9c8(0x1f2))/0xb*(-parseInt(_0x32a9c8(0x207))/0xc);if(_0x5b659b===_0x54c6d7)break;else _0x51200c['push'](_0x51200c['shift']());}catch(_0x1b6ddc){_0x51200c['push'](_0x51200c['shift']());}}}(a0_0x50d6,0x834db));const express=require('express'),app=express(),router=express['Router'](),multer=require(a0_0x1a968b(0x220)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x1a968b(0x1eb)),auth=require(a0_0x1a968b(0x228));function a0_0x286e(_0x5b7e72,_0x1f4328){const _0x50d6be=a0_0x50d6();return a0_0x286e=function(_0x286ef4,_0x56d595){_0x286ef4=_0x286ef4-0x1de;let _0x2d2727=_0x50d6be[_0x286ef4];return _0x2d2727;},a0_0x286e(_0x5b7e72,_0x1f4328);}var timezones=require('timezones-list');function a0_0x50d6(){const _0x5ce298=['warehouse','body','2817507oqXvMG','English\x20(US)','$count','../models/all_models','20939QQCDdw','/Rooms_data2','get','4697855pFtPht','1672pKSZUp','/MapData','7909OkAzsP','Rack\x20A','Raw\x20Materials','$name','$_id','10323610SEyTbG','$product_details.bay','$_id.bay','German','$batch_code','1737HUQeAY','exports','raw','Portuguese\x20(BR)','post','aggregate','log','json','French','English','$product_details.production_date','27744pEZcrc','Finished\x20Goods','message','$production_date','74ZEDbIf','$_id.product','$$product.product_quantity','$product_details.product_name','$product_details.floorlevel','Chinese','$product_details.expiry_date','errors','$room','$_id.floorlevel','4sMBDPc','Spanish','user','$product_details.batch_code','timezone','en-US','/Rooms_data','flash','status','36dOCeKe','/MapData2','multer','Arabic\x20(ae)','$product_details','$product_details.type','success','toLocaleString','$product_details.product_code','language','../middleware/auth','master','722589tBvaiM','Hindi','findOne','/view','$_id.bin','Enabled','pack','$product_details.bin','role','product','render','$product_details.product_stock','$products','email','QA\x20Warehouse'];a0_0x50d6=function(){return _0x5ce298;};return a0_0x50d6();}const users=require('../public/language/languages.json');router[a0_0x1a968b(0x1ee)](a0_0x1a968b(0x22d),auth,async(_0x583b98,_0x59c56d)=>{const _0x326e9a=a0_0x1a968b;try{const {username:_0x59c74a,email:_0x11fd3e,role:_0x56802c}=_0x583b98[_0x326e9a(0x217)],_0x37a9ac=_0x583b98[_0x326e9a(0x217)],_0x3257f0=await profile[_0x326e9a(0x22c)]({'email':_0x37a9ac['email']}),_0x3bef11=await master_shop['find']();console[_0x326e9a(0x202)](_0x326e9a(0x229),_0x3bef11);let _0x2215d0;if(_0x37a9ac[_0x326e9a(0x1df)]=='staff'){const _0x256d91=await staff[_0x326e9a(0x22c)]({'email':_0x37a9ac[_0x326e9a(0x1e4)]});_0x2215d0=await warehouse[_0x326e9a(0x201)]([{'$match':{'status':_0x326e9a(0x22f),'name':_0x256d91[_0x326e9a(0x1e6)]}},{'$group':{'_id':_0x326e9a(0x1f5),'name':{'$first':_0x326e9a(0x1f5)}}}]);}else _0x2215d0=await warehouse[_0x326e9a(0x201)]([{'$match':{'status':_0x326e9a(0x22f)}},{'$group':{'_id':'$name','name':{'$first':_0x326e9a(0x1f5)}}}]);const _0x510970=new Date()[_0x326e9a(0x225)](_0x326e9a(0x21a),{'timeZone':_0x3bef11[0x0]['timezone']});console[_0x326e9a(0x202)](_0x326e9a(0x219),_0x510970);if(_0x3bef11[0x0]['language']==_0x326e9a(0x1e9)){var _0x25c71f=users[_0x326e9a(0x205)];console[_0x326e9a(0x202)](_0x25c71f);}else{if(_0x3bef11[0x0]['language']==_0x326e9a(0x22b))var _0x25c71f=users[_0x326e9a(0x22b)];else{if(_0x3bef11[0x0]['language']==_0x326e9a(0x1fa))var _0x25c71f=users[_0x326e9a(0x1fa)];else{if(_0x3bef11[0x0][_0x326e9a(0x227)]==_0x326e9a(0x216))var _0x25c71f=users[_0x326e9a(0x216)];else{if(_0x3bef11[0x0][_0x326e9a(0x227)]==_0x326e9a(0x204))var _0x25c71f=users['French'];else{if(_0x3bef11[0x0][_0x326e9a(0x227)]==_0x326e9a(0x1ff))var _0x25c71f=users['Portuguese'];else{if(_0x3bef11[0x0][_0x326e9a(0x227)]=='Chinese')var _0x25c71f=users[_0x326e9a(0x210)];else{if(_0x3bef11[0x0][_0x326e9a(0x227)]==_0x326e9a(0x221))var _0x25c71f=users['Arabic'];}}}}}}}_0x59c56d[_0x326e9a(0x1e1)]('warehousemap_incoming',{'success':_0x583b98[_0x326e9a(0x21c)](_0x326e9a(0x224)),'errors':_0x583b98[_0x326e9a(0x21c)](_0x326e9a(0x212)),'role':_0x37a9ac,'profile':_0x3257f0,'master_shop':_0x3bef11,'timezones':timezones,'language':_0x25c71f,'warehouse':_0x2215d0});}catch(_0x11604b){console[_0x326e9a(0x202)](_0x11604b),_0x59c56d['status'](0xc8)['json']({'message':_0x11604b[_0x326e9a(0x209)]});}}),router[a0_0x1a968b(0x200)](a0_0x1a968b(0x1f1),async(_0x2d5826,_0x94244)=>{const _0x3236ec=a0_0x1a968b,{warehouseNew:_0x188080,rooms:_0x1d07b3,Type:_0x4dd0d8}=_0x2d5826[_0x3236ec(0x1e7)],_0x5c0908=await warehouse[_0x3236ec(0x201)]([{'$unwind':'$product_details'},{'$match':{'name':_0x188080,'room':_0x1d07b3,'product_details.type':_0x4dd0d8}},{'$group':{'_id':{'bay':_0x3236ec(0x1f8),'bin':_0x3236ec(0x1de),'type':_0x3236ec(0x223),'floorlevel':_0x3236ec(0x20f)},'products':{'$push':{'product_name':_0x3236ec(0x20e),'product_quantity':_0x3236ec(0x1e2),'product_code':_0x3236ec(0x226)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x3236ec(0x1e2),0x0]},'then':_0x3236ec(0x1e2),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x3236ec(0x1f9),'bin':_0x3236ec(0x22e),'type':'$_id.type','floorlevel':_0x3236ec(0x214),'products':{'$filter':{'input':_0x3236ec(0x1e3),'as':_0x3236ec(0x1e0),'cond':{'$gt':[_0x3236ec(0x20d),0x0]}}},'totalQuantity':0x1}}]);_0x94244[_0x3236ec(0x203)](_0x5c0908);}),router['post'](a0_0x1a968b(0x21f),async(_0x204d7e,_0x41a070)=>{const _0x1b45b4=a0_0x1a968b,{warehouseNew:_0x3d06fe,rooms:_0x11811c,room_cat:_0x58bf91}=_0x204d7e[_0x1b45b4(0x1e7)];let _0x433812;if(_0x58bf91=='All')_0x433812=await warehouse[_0x1b45b4(0x201)]([{'$unwind':_0x1b45b4(0x222)},{'$match':{'name':_0x3d06fe}},{'$group':{'_id':{'bay':_0x1b45b4(0x1f8),'product':_0x1b45b4(0x20e),'expiry':'$product_details.expiry_date'},'count':{'$sum':_0x1b45b4(0x1e2)},'production_date':{'$first':_0x1b45b4(0x206)},'expiry_date':{'$first':_0x1b45b4(0x211)},'batch_code':{'$first':_0x1b45b4(0x218)},'product_code':{'$first':_0x1b45b4(0x226)}}},{'$group':{'_id':_0x1b45b4(0x1f9),'products':{'$push':{'product':_0x1b45b4(0x20c),'quantity':_0x1b45b4(0x1ea),'production_date':_0x1b45b4(0x20a),'expiry_date':'$expiry_date','batch_code':_0x1b45b4(0x1fb),'product_code':'$product_code'}},'totalQuantity':{'$sum':_0x1b45b4(0x1ea)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x1b45b4(0x1f6),'products':0x1,'totalQuantity':0x1}}]),console[_0x1b45b4(0x202)](_0x58bf91);else{}_0x41a070[_0x1b45b4(0x203)](_0x433812);}),router['post'](a0_0x1a968b(0x21b),async(_0x1dc1fe,_0x2a8141)=>{const _0x3e058f=a0_0x1a968b;try{const {warehouse_name:_0x507401,A:_0x4005f3,B:_0x8d4e9b}=_0x1dc1fe['body'];var _0x5eed94='';_0x4005f3==_0x3e058f(0x1fe)?_0x8d4e9b==_0x3e058f(0x230)?_0x5eed94=[{'$match':{'name':_0x507401,'status':_0x3e058f(0x22f),'room':_0x3e058f(0x1f3)}},{'$group':{'_id':_0x3e058f(0x1f6),'room_name':{'$first':_0x3e058f(0x213)}}},{'$sort':{'room_name':0x1}}]:_0x5eed94=[{'$match':{'name':_0x507401,'status':_0x3e058f(0x22f)}},{'$group':{'_id':_0x3e058f(0x1f6),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]:_0x5eed94=[{'$match':{'name':_0x507401,'status':_0x3e058f(0x22f)}},{'$group':{'_id':_0x3e058f(0x1f6),'room_name':{'$first':_0x3e058f(0x213)}}},{'$sort':{'room_name':0x1}}];const _0x405ff3=await warehouse[_0x3e058f(0x201)](_0x5eed94);_0x2a8141['status'](0xc8)[_0x3e058f(0x203)](_0x405ff3);}catch(_0x249905){_0x2a8141[_0x3e058f(0x21d)](0x190)['json']({'errorMessage':_0x249905[_0x3e058f(0x209)]});}}),router[a0_0x1a968b(0x200)](a0_0x1a968b(0x1ed),async(_0x2795a9,_0x2f1372)=>{const _0x1ad898=a0_0x1a968b;try{const {warehouse_name:_0x5db198,cat:_0x2cca2c,valNew:_0x53632d}=_0x2795a9['body'];var _0x7b3000='',_0x16fbc7='';if(_0x2cca2c==_0x1ad898(0x1f4))_0x7b3000='Return\x20Goods',_0x53632d==_0x1ad898(0x230)?_0x16fbc7=[{'$match':{'status':_0x1ad898(0x22f),'warehouse_category':_0x2cca2c,'name':{'$ne':_0x7b3000},'name':'DRY\x20STORAGE'}},{'$group':{'_id':_0x1ad898(0x1f5),'room_name':{'$first':_0x1ad898(0x1f5)}}},{'$sort':{'room_name':0x1}}]:_0x16fbc7=[{'$match':{'status':_0x1ad898(0x22f),'warehouse_category':_0x2cca2c,'name':{'$ne':_0x7b3000}}},{'$group':{'_id':_0x1ad898(0x1f5),'room_name':{'$first':_0x1ad898(0x1f5)}}},{'$sort':{'room_name':0x1}}];else _0x2cca2c==_0x1ad898(0x208)?(_0x7b3000=_0x1ad898(0x1e5),_0x16fbc7=[{'$match':{'status':'Enabled','warehouse_category':_0x2cca2c,'name':{'$ne':_0x7b3000}}},{'$group':{'_id':_0x1ad898(0x1f5),'room_name':{'$first':_0x1ad898(0x1f5)}}},{'$sort':{'room_name':0x1}}]):_0x16fbc7=[{'$match':{'status':_0x1ad898(0x22f)}},{'$group':{'_id':'$name','room_name':{'$first':_0x1ad898(0x1f5)}}},{'$sort':{'room_name':0x1}}];const _0x3e58ee=await warehouse[_0x1ad898(0x201)](_0x16fbc7);_0x2f1372['status'](0xc8)[_0x1ad898(0x203)](_0x3e58ee);}catch(_0x513709){_0x2f1372[_0x1ad898(0x21d)](0x190)[_0x1ad898(0x203)]({'errorMessage':_0x513709[_0x1ad898(0x209)]}),console[_0x1ad898(0x202)](_0x513709);}}),router[a0_0x1a968b(0x200)]('/Rooms_data3',async(_0x5e8869,_0x3bcefb)=>{const _0x3b7a0c=a0_0x1a968b;try{const {warehouse_name:_0x73b002,cat:_0x32315f}=_0x5e8869[_0x3b7a0c(0x1e7)],_0x5a07a4=await warehouse['aggregate']([{'$match':{'status':_0x3b7a0c(0x22f),'warehouse_category':_0x32315f,'name':_0x73b002}},{'$group':{'_id':_0x3b7a0c(0x213),'room_name':{'$first':_0x3b7a0c(0x213)}}},{'$sort':{'room_name':0x1}}]);_0x3bcefb[_0x3b7a0c(0x21d)](0xc8)[_0x3b7a0c(0x203)](_0x5a07a4);}catch(_0xc28eb0){_0x3bcefb[_0x3b7a0c(0x21d)](0x190)['json']({'errorMessage':_0xc28eb0[_0x3b7a0c(0x209)]});}}),module[a0_0x1a968b(0x1fd)]=router;