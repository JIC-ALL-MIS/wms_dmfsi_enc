const a0_0x438810=a0_0x5d7f;(function(_0xc0b2de,_0x424d4e){const _0x15c905=a0_0x5d7f,_0x4c31a2=_0xc0b2de();while(!![]){try{const _0x360def=-parseInt(_0x15c905(0x1ff))/0x1+parseInt(_0x15c905(0x1e7))/0x2*(-parseInt(_0x15c905(0x1c4))/0x3)+parseInt(_0x15c905(0x1fc))/0x4+-parseInt(_0x15c905(0x1c7))/0x5+-parseInt(_0x15c905(0x1b8))/0x6+-parseInt(_0x15c905(0x1ec))/0x7*(parseInt(_0x15c905(0x1d1))/0x8)+parseInt(_0x15c905(0x1f6))/0x9;if(_0x360def===_0x424d4e)break;else _0x4c31a2['push'](_0x4c31a2['shift']());}catch(_0x3c5e9e){_0x4c31a2['push'](_0x4c31a2['shift']());}}}(a0_0x4894,0x69270));const express=require('express'),app=express(),router=express[a0_0x438810(0x1d7)](),multer=require(a0_0x438810(0x1f0)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x438810(0x1f8)),auth=require('../middleware/auth');var timezones=require('timezones-list');function a0_0x4894(){const _0x180252=['14166855GKKHoP','toLocaleString','../models/all_models','$production_date','$room','All','1613340kWxcvE','German','$batch_code','272871fNZBPz','../public/language/languages.json','English\x20(US)','warehousemap_incoming','/MapData','$product_details.bay','user','staff','265338CILUgT','$product_details.product_name','/Rooms_data3','aggregate','body','success','status','$_id.bin','Spanish','/Rooms_data','json','log','845574AwDoRM','$_id.bay','flash','2277165FYQFQp','Enabled','$product_details.expiry_date','English','render','get','errors','product','$products','$_id.floorlevel','3938728wBtLQN','Return\x20Goods','Finished\x20Goods','role','/Rooms_data2','exports','Router','en-US','pack','DRY\x20STORAGE','QA\x20Warehouse','French','$_id','$$product.product_quantity','Raw\x20Materials','$product_details.product_code','Arabic\x20(ae)','Arabic','find','timezone','master','Rack\x20A','2duGJVL','post','$count','$product_details.type','$product_details.product_stock','7MljlFe','message','$product_details.production_date','Chinese','multer','$_id.type','language','email','$name','$product_details'];a0_0x4894=function(){return _0x180252;};return a0_0x4894();}const users=require(a0_0x438810(0x1b1));function a0_0x5d7f(_0xcd2070,_0x438bbd){const _0x4894d1=a0_0x4894();return a0_0x5d7f=function(_0x5d7fa0,_0x5471cf){_0x5d7fa0=_0x5d7fa0-0x1b1;let _0x810257=_0x4894d1[_0x5d7fa0];return _0x810257;},a0_0x5d7f(_0xcd2070,_0x438bbd);}router[a0_0x438810(0x1cc)]('/view',auth,async(_0xf30d78,_0xac7d81)=>{const _0x249d18=a0_0x438810;try{const {username:_0x47b1a2,email:_0x5dc205,role:_0x3c79fc}=_0xf30d78[_0x249d18(0x1b6)],_0xc84d4c=_0xf30d78[_0x249d18(0x1b6)],_0x1a9fb4=await profile['findOne']({'email':_0xc84d4c[_0x249d18(0x1f3)]}),_0x5261bf=await master_shop[_0x249d18(0x1e3)]();console[_0x249d18(0x1c3)](_0x249d18(0x1e5),_0x5261bf);let _0x568c4b;if(_0xc84d4c[_0x249d18(0x1d4)]==_0x249d18(0x1b7)){const _0x2f1e05=await staff['findOne']({'email':_0xc84d4c['email']});_0x568c4b=await warehouse[_0x249d18(0x1bb)]([{'$match':{'status':'Enabled','name':_0x2f1e05['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x249d18(0x1f4)}}}]);}else _0x568c4b=await warehouse[_0x249d18(0x1bb)]([{'$match':{'status':_0x249d18(0x1c8)}},{'$group':{'_id':_0x249d18(0x1f4),'name':{'$first':'$name'}}}]);const _0x1ea382=new Date()[_0x249d18(0x1f7)](_0x249d18(0x1d8),{'timeZone':_0x5261bf[0x0][_0x249d18(0x1e4)]});console[_0x249d18(0x1c3)]('timezone',_0x1ea382);if(_0x5261bf[0x0][_0x249d18(0x1f2)]==_0x249d18(0x1b2)){var _0x3d08da=users[_0x249d18(0x1ca)];console[_0x249d18(0x1c3)](_0x3d08da);}else{if(_0x5261bf[0x0][_0x249d18(0x1f2)]=='Hindi')var _0x3d08da=users['Hindi'];else{if(_0x5261bf[0x0][_0x249d18(0x1f2)]==_0x249d18(0x1fd))var _0x3d08da=users[_0x249d18(0x1fd)];else{if(_0x5261bf[0x0][_0x249d18(0x1f2)]=='Spanish')var _0x3d08da=users[_0x249d18(0x1c0)];else{if(_0x5261bf[0x0]['language']==_0x249d18(0x1dc))var _0x3d08da=users[_0x249d18(0x1dc)];else{if(_0x5261bf[0x0][_0x249d18(0x1f2)]=='Portuguese\x20(BR)')var _0x3d08da=users['Portuguese'];else{if(_0x5261bf[0x0][_0x249d18(0x1f2)]==_0x249d18(0x1ef))var _0x3d08da=users[_0x249d18(0x1ef)];else{if(_0x5261bf[0x0][_0x249d18(0x1f2)]==_0x249d18(0x1e1))var _0x3d08da=users[_0x249d18(0x1e2)];}}}}}}}_0xac7d81[_0x249d18(0x1cb)](_0x249d18(0x1b3),{'success':_0xf30d78[_0x249d18(0x1c6)](_0x249d18(0x1bd)),'errors':_0xf30d78[_0x249d18(0x1c6)](_0x249d18(0x1cd)),'role':_0xc84d4c,'profile':_0x1a9fb4,'master_shop':_0x5261bf,'timezones':timezones,'language':_0x3d08da,'warehouse':_0x568c4b});}catch(_0x40f24e){console[_0x249d18(0x1c3)](_0x40f24e),_0xac7d81[_0x249d18(0x1be)](0xc8)['json']({'message':_0x40f24e[_0x249d18(0x1ed)]});}}),router['post'](a0_0x438810(0x1b4),async(_0x5e1ae,_0x35e982)=>{const _0xa6ee24=a0_0x438810,{warehouseNew:_0x7fb294,rooms:_0xa90172,Type:_0x4a7b30}=_0x5e1ae['body'],_0xe1634=await warehouse[_0xa6ee24(0x1bb)]([{'$unwind':_0xa6ee24(0x1f5)},{'$match':{'name':_0x7fb294,'room':_0xa90172,'product_details.type':_0x4a7b30}},{'$group':{'_id':{'bay':_0xa6ee24(0x1b5),'bin':'$product_details.bin','type':_0xa6ee24(0x1ea),'floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0xa6ee24(0x1b9),'product_quantity':_0xa6ee24(0x1eb),'product_code':'$product_details.product_code'}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0xa6ee24(0x1eb),0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':'$_id.bay','bin':_0xa6ee24(0x1bf),'type':_0xa6ee24(0x1f1),'floorlevel':_0xa6ee24(0x1d0),'products':{'$filter':{'input':_0xa6ee24(0x1cf),'as':_0xa6ee24(0x1ce),'cond':{'$gt':[_0xa6ee24(0x1de),0x0]}}},'totalQuantity':0x1}}]);_0x35e982['json'](_0xe1634);}),router[a0_0x438810(0x1e8)]('/MapData2',async(_0x4a843d,_0x579dc6)=>{const _0x3002a1=a0_0x438810,{warehouseNew:_0x391bc8,rooms:_0x5d7290,room_cat:_0x2ffb35}=_0x4a843d[_0x3002a1(0x1bc)];let _0x4508b8;if(_0x2ffb35==_0x3002a1(0x1fb))_0x4508b8=await warehouse[_0x3002a1(0x1bb)]([{'$unwind':'$product_details'},{'$match':{'name':_0x391bc8}},{'$group':{'_id':{'bay':_0x3002a1(0x1b5),'product':'$product_details.product_name','expiry':_0x3002a1(0x1c9)},'count':{'$sum':_0x3002a1(0x1eb)},'production_date':{'$first':_0x3002a1(0x1ee)},'expiry_date':{'$first':_0x3002a1(0x1c9)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':_0x3002a1(0x1e0)}}},{'$group':{'_id':_0x3002a1(0x1c5),'products':{'$push':{'product':'$_id.product','quantity':'$count','production_date':_0x3002a1(0x1f9),'expiry_date':'$expiry_date','batch_code':_0x3002a1(0x1fe),'product_code':'$product_code'}},'totalQuantity':{'$sum':_0x3002a1(0x1e9)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x3002a1(0x1c3)](_0x2ffb35);else{}_0x579dc6[_0x3002a1(0x1c2)](_0x4508b8);}),router[a0_0x438810(0x1e8)](a0_0x438810(0x1c1),async(_0x458230,_0xf565cc)=>{const _0x55da29=a0_0x438810;try{const {warehouse_name:_0x79db3d,A:_0x34353e,B:_0x5c1f0a}=_0x458230[_0x55da29(0x1bc)];var _0x15c399='';_0x34353e=='raw'?_0x5c1f0a==_0x55da29(0x1d9)?_0x15c399=[{'$match':{'name':_0x79db3d,'status':_0x55da29(0x1c8),'room':_0x55da29(0x1e6)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x55da29(0x1fa)}}},{'$sort':{'room_name':0x1}}]:_0x15c399=[{'$match':{'name':_0x79db3d,'status':_0x55da29(0x1c8)}},{'$group':{'_id':_0x55da29(0x1dd),'room_name':{'$first':_0x55da29(0x1fa)}}},{'$sort':{'room_name':0x1}}]:_0x15c399=[{'$match':{'name':_0x79db3d,'status':_0x55da29(0x1c8)}},{'$group':{'_id':_0x55da29(0x1dd),'room_name':{'$first':_0x55da29(0x1fa)}}},{'$sort':{'room_name':0x1}}];const _0x370af7=await warehouse[_0x55da29(0x1bb)](_0x15c399);_0xf565cc[_0x55da29(0x1be)](0xc8)['json'](_0x370af7);}catch(_0x361380){_0xf565cc[_0x55da29(0x1be)](0x190)[_0x55da29(0x1c2)]({'errorMessage':_0x361380[_0x55da29(0x1ed)]});}}),router['post'](a0_0x438810(0x1d5),async(_0x11de5b,_0x3a47f6)=>{const _0x58c531=a0_0x438810;try{const {warehouse_name:_0x3ef86a,cat:_0x58cbef,valNew:_0x2260a0}=_0x11de5b['body'];var _0x2b2b30='',_0x208307='';if(_0x58cbef==_0x58c531(0x1df))_0x2b2b30=_0x58c531(0x1d2),_0x2260a0==_0x58c531(0x1d9)?_0x208307=[{'$match':{'status':'Enabled','warehouse_category':_0x58cbef,'name':{'$ne':_0x2b2b30},'name':_0x58c531(0x1da)}},{'$group':{'_id':_0x58c531(0x1f4),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0x208307=[{'$match':{'status':_0x58c531(0x1c8),'warehouse_category':_0x58cbef,'name':{'$ne':_0x2b2b30}}},{'$group':{'_id':_0x58c531(0x1f4),'room_name':{'$first':_0x58c531(0x1f4)}}},{'$sort':{'room_name':0x1}}];else _0x58cbef==_0x58c531(0x1d3)?(_0x2b2b30=_0x58c531(0x1db),_0x208307=[{'$match':{'status':'Enabled','warehouse_category':_0x58cbef,'name':{'$ne':_0x2b2b30}}},{'$group':{'_id':_0x58c531(0x1f4),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]):_0x208307=[{'$match':{'status':_0x58c531(0x1c8)}},{'$group':{'_id':_0x58c531(0x1f4),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}];const _0x424a45=await warehouse['aggregate'](_0x208307);_0x3a47f6[_0x58c531(0x1be)](0xc8)[_0x58c531(0x1c2)](_0x424a45);}catch(_0x212f7b){_0x3a47f6[_0x58c531(0x1be)](0x190)[_0x58c531(0x1c2)]({'errorMessage':_0x212f7b[_0x58c531(0x1ed)]}),console[_0x58c531(0x1c3)](_0x212f7b);}}),router[a0_0x438810(0x1e8)](a0_0x438810(0x1ba),async(_0x3ab938,_0x401389)=>{const _0x6107e9=a0_0x438810;try{const {warehouse_name:_0x1f3580,cat:_0x57dc77}=_0x3ab938['body'],_0x3a4fa3=await warehouse[_0x6107e9(0x1bb)]([{'$match':{'status':'Enabled','warehouse_category':_0x57dc77,'name':_0x1f3580}},{'$group':{'_id':_0x6107e9(0x1fa),'room_name':{'$first':_0x6107e9(0x1fa)}}},{'$sort':{'room_name':0x1}}]);_0x401389[_0x6107e9(0x1be)](0xc8)['json'](_0x3a4fa3);}catch(_0x2a7aa7){_0x401389[_0x6107e9(0x1be)](0x190)[_0x6107e9(0x1c2)]({'errorMessage':_0x2a7aa7[_0x6107e9(0x1ed)]});}}),module[a0_0x438810(0x1d6)]=router;