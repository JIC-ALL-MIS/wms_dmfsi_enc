const a0_0x2a9f7d=a0_0x3275;function a0_0x2819(){const _0x104eb8=['timezones-list','json','$name','../public/language/languages.json','$product_details_spmx.curing_spmx_qty','$_id.bin','timezone','log','14273Lemjpt','2581056GkEZRb','14OfTOOv','$expiry_date','45FWTyhg','$_id.bay','French','body','$product_details.type','Arabic','$product_details.product_name','status','Portuguese','render','pack','$_id.product','staff','post','get','$product_details.batch_code','Arabic\x20(ae)','$product_details_spmx','$_id','/view','message','$product_details_spmx.curing_spmx','$product_details.product_code','errors','German','product','SPMX','$product_details','English\x20(US)','5fQVLsx','$product_details.product_stock','language','$$product.product_quantity','1151540SMePbx','$product_details.floorlevel','user','$room','$product_details_spmx.brand_spmx','$product_details_spmx.unit_spmx','$product_code','$product_details.bin','1272975gKIZLr','/MapData2','../models/all_models','toLocaleString','$product_details.expiry_date','warehouse','en-US','$count','$_id.type','$product_details_spmx.extenders_spmx','Enabled','warehousemap_incoming','$production_date','raw','role','find','218408bnKOvE','flash','DRY\x20STORAGE','Raw\x20Materials','All','/Rooms_data2','17820638PFaHnG','Rack\x20A','1624912KLiGly','Spanish','/Rooms_data3','success','aggregate','multer','$product_details_spmx.spicemix_spmx','50bzcGrg','Return\x20Goods','findOne','$product_details_spmx.spicemix_spmx_qty','QA\x20Warehouse','$product_details_spmx.extenders_spmx_qty','$product_details.production_date','Hindi','$product_details_spmx.category_spmx'];a0_0x2819=function(){return _0x104eb8;};return a0_0x2819();}(function(_0x137a1b,_0x164021){const _0x5cb4ce=a0_0x3275,_0x440e32=_0x137a1b();while(!![]){try{const _0x430fe7=parseInt(_0x5cb4ce(0x1ba))/0x1*(-parseInt(_0x5cb4ce(0x1a9))/0x2)+-parseInt(_0x5cb4ce(0x18a))/0x3+-parseInt(_0x5cb4ce(0x1a2))/0x4*(-parseInt(_0x5cb4ce(0x1db))/0x5)+-parseInt(_0x5cb4ce(0x1bb))/0x6+-parseInt(_0x5cb4ce(0x1bc))/0x7*(-parseInt(_0x5cb4ce(0x19a))/0x8)+-parseInt(_0x5cb4ce(0x1be))/0x9*(parseInt(_0x5cb4ce(0x182))/0xa)+parseInt(_0x5cb4ce(0x1a0))/0xb;if(_0x430fe7===_0x164021)break;else _0x440e32['push'](_0x440e32['shift']());}catch(_0x255793){_0x440e32['push'](_0x440e32['shift']());}}}(a0_0x2819,0x47ba0));const express=require('express'),app=express(),router=express['Router'](),multer=require(a0_0x2a9f7d(0x1a7)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x2a9f7d(0x18c)),auth=require('../middleware/auth');var timezones=require(a0_0x2a9f7d(0x1b2));function a0_0x3275(_0x2a8bf,_0x27940c){const _0x2819aa=a0_0x2819();return a0_0x3275=function(_0x327584,_0x7832f){_0x327584=_0x327584-0x17f;let _0x1d361b=_0x2819aa[_0x327584];return _0x1d361b;},a0_0x3275(_0x2a8bf,_0x27940c);}const users=require(a0_0x2a9f7d(0x1b5));router[a0_0x2a9f7d(0x1cc)](a0_0x2a9f7d(0x1d1),auth,async(_0x3cf0ac,_0x555650)=>{const _0x233a1a=a0_0x2a9f7d;try{const {username:_0x2007ce,email:_0xc94c3a,role:_0x1614f1}=_0x3cf0ac[_0x233a1a(0x184)],_0x5e7428=_0x3cf0ac[_0x233a1a(0x184)],_0x11bb10=await profile[_0x233a1a(0x1ab)]({'email':_0x5e7428['email']}),_0x19d716=await master_shop[_0x233a1a(0x199)]();let _0x5e396d;if(_0x5e7428[_0x233a1a(0x198)]==_0x233a1a(0x1ca)){const _0x1e3369=await staff['findOne']({'email':_0x5e7428['email']});_0x5e396d=await warehouse[_0x233a1a(0x1a6)]([{'$match':{'status':_0x233a1a(0x194),'name':_0x1e3369[_0x233a1a(0x18f)]}},{'$group':{'_id':_0x233a1a(0x1b4),'name':{'$first':_0x233a1a(0x1b4)}}}]);}else _0x5e396d=await warehouse[_0x233a1a(0x1a6)]([{'$match':{'status':_0x233a1a(0x194)}},{'$group':{'_id':_0x233a1a(0x1b4),'name':{'$first':'$name'}}}]);const _0x31c10f=new Date()[_0x233a1a(0x18d)](_0x233a1a(0x190),{'timeZone':_0x19d716[0x0][_0x233a1a(0x1b8)]});if(_0x19d716[0x0][_0x233a1a(0x180)]==_0x233a1a(0x1da))var _0x528003=users['English'];else{if(_0x19d716[0x0][_0x233a1a(0x180)]==_0x233a1a(0x1b0))var _0x528003=users[_0x233a1a(0x1b0)];else{if(_0x19d716[0x0][_0x233a1a(0x180)]==_0x233a1a(0x1d6))var _0x528003=users[_0x233a1a(0x1d6)];else{if(_0x19d716[0x0][_0x233a1a(0x180)]==_0x233a1a(0x1a3))var _0x528003=users[_0x233a1a(0x1a3)];else{if(_0x19d716[0x0]['language']==_0x233a1a(0x1c0))var _0x528003=users[_0x233a1a(0x1c0)];else{if(_0x19d716[0x0][_0x233a1a(0x180)]=='Portuguese\x20(BR)')var _0x528003=users[_0x233a1a(0x1c6)];else{if(_0x19d716[0x0]['language']=='Chinese')var _0x528003=users['Chinese'];else{if(_0x19d716[0x0][_0x233a1a(0x180)]==_0x233a1a(0x1ce))var _0x528003=users[_0x233a1a(0x1c3)];}}}}}}}_0x555650[_0x233a1a(0x1c7)](_0x233a1a(0x195),{'success':_0x3cf0ac[_0x233a1a(0x19b)](_0x233a1a(0x1a5)),'errors':_0x3cf0ac[_0x233a1a(0x19b)](_0x233a1a(0x1d5)),'role':_0x5e7428,'profile':_0x11bb10,'master_shop':_0x19d716,'timezones':timezones,'language':_0x528003,'warehouse':_0x5e396d});}catch(_0x135ee7){console['log'](_0x135ee7),_0x555650[_0x233a1a(0x1c5)](0xc8)['json']({'message':_0x135ee7[_0x233a1a(0x1d2)]});}}),router['post']('/MapData',async(_0x290e51,_0x10f189)=>{const _0x3b15a1=a0_0x2a9f7d,{warehouseNew:_0x494241,rooms:_0x1b6a15,Type:_0x4996cf}=_0x290e51[_0x3b15a1(0x1c1)],_0x2c4584=await warehouse[_0x3b15a1(0x1a6)]([{'$unwind':_0x3b15a1(0x1d9)},{'$match':{'name':_0x494241,'room':_0x1b6a15,'product_details.type':_0x4996cf}},{'$group':{'_id':{'bay':'$product_details.bay','bin':_0x3b15a1(0x189),'type':_0x3b15a1(0x1c2),'floorlevel':_0x3b15a1(0x183)},'products':{'$push':{'product_name':'$product_details.product_name','product_quantity':_0x3b15a1(0x17f),'product_code':_0x3b15a1(0x1d4)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':['$product_details.product_stock',0x0]},'then':'$product_details.product_stock','else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x3b15a1(0x1bf),'bin':_0x3b15a1(0x1b7),'type':_0x3b15a1(0x192),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':'$products','as':_0x3b15a1(0x1d7),'cond':{'$gt':[_0x3b15a1(0x181),0x0]}}},'totalQuantity':0x1}}]);_0x10f189[_0x3b15a1(0x1b3)](_0x2c4584);}),router[a0_0x2a9f7d(0x1cb)](a0_0x2a9f7d(0x18b),async(_0x3f2047,_0x525a99)=>{const _0x690971=a0_0x2a9f7d,{warehouseNew:_0x5b4bd2,rooms:_0x1cba46,room_cat:_0xd3a243,process_cat:_0x1f755f}=_0x3f2047['body'];let _0x5b5631;if(_0xd3a243==_0x690971(0x19e))_0x1f755f==_0x690971(0x1d8)?_0x5b5631=await warehouse[_0x690971(0x1a6)]([{'$unwind':_0x690971(0x1cf)},{'$match':{'name':_0x5b4bd2}},{'$group':{'_id':'$product_details_spmx.product_code','spicemix_spmx':{'$first':_0x690971(0x1a8)},'extenders_spmx':{'$first':_0x690971(0x193)},'curing_spmx':{'$first':_0x690971(0x1d3)},'spicemix_spmx_qty':{'$sum':_0x690971(0x1ac)},'extenders_spmx_qty':{'$sum':_0x690971(0x1ae)},'curing_spmx_qty':{'$sum':_0x690971(0x1b6)},'unit_spmx':{'$first':_0x690971(0x187)},'brand_spmx':{'$first':_0x690971(0x186)},'category_spmx':{'$first':_0x690971(0x1b1)}}}]):_0x5b5631=await warehouse[_0x690971(0x1a6)]([{'$unwind':_0x690971(0x1d9)},{'$match':{'name':_0x5b4bd2,'product_details.product_stock':{'$gt':0x0}}},{'$group':{'_id':{'bay':'$product_details.bay','product':_0x690971(0x1c4),'expiry':_0x690971(0x18e)},'count':{'$sum':_0x690971(0x17f)},'production_date':{'$first':_0x690971(0x1af)},'expiry_date':{'$first':_0x690971(0x18e)},'batch_code':{'$first':_0x690971(0x1cd)},'product_code':{'$first':_0x690971(0x1d4)}}},{'$group':{'_id':_0x690971(0x1bf),'products':{'$push':{'product':_0x690971(0x1c9),'quantity':_0x690971(0x191),'production_date':_0x690971(0x196),'expiry_date':_0x690971(0x1bd),'batch_code':'$batch_code','product_code':_0x690971(0x188)}},'totalQuantity':{'$sum':_0x690971(0x191)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x690971(0x1d0),'products':0x1,'totalQuantity':0x1}}]),console[_0x690971(0x1b9)](_0xd3a243);else{}console[_0x690971(0x1b9)](_0x5b5631),_0x525a99['json'](_0x5b5631);}),router[a0_0x2a9f7d(0x1cb)]('/Rooms_data',async(_0x456b02,_0x16b264)=>{const _0x9fcd50=a0_0x2a9f7d;try{const {warehouse_name:_0x2059db,A:_0x31339e,B:_0x1282c2}=_0x456b02['body'];var _0x3a982b='';_0x31339e==_0x9fcd50(0x197)?_0x1282c2==_0x9fcd50(0x1c8)?_0x3a982b=[{'$match':{'name':_0x2059db,'status':_0x9fcd50(0x194),'room':_0x9fcd50(0x1a1)}},{'$group':{'_id':_0x9fcd50(0x1d0),'room_name':{'$first':_0x9fcd50(0x185)}}},{'$sort':{'room_name':0x1}}]:_0x3a982b=[{'$match':{'name':_0x2059db,'status':'Enabled'}},{'$group':{'_id':_0x9fcd50(0x1d0),'room_name':{'$first':_0x9fcd50(0x185)}}},{'$sort':{'room_name':0x1}}]:_0x3a982b=[{'$match':{'name':_0x2059db,'status':_0x9fcd50(0x194)}},{'$group':{'_id':_0x9fcd50(0x1d0),'room_name':{'$first':_0x9fcd50(0x185)}}},{'$sort':{'room_name':0x1}}];const _0x259631=await warehouse[_0x9fcd50(0x1a6)](_0x3a982b);_0x16b264[_0x9fcd50(0x1c5)](0xc8)[_0x9fcd50(0x1b3)](_0x259631);}catch(_0x4feb1f){_0x16b264['status'](0x190)[_0x9fcd50(0x1b3)]({'errorMessage':_0x4feb1f['message']});}}),router[a0_0x2a9f7d(0x1cb)](a0_0x2a9f7d(0x19f),async(_0x447d22,_0x7d809a)=>{const _0x1263e2=a0_0x2a9f7d;try{const {warehouse_name:_0x3009ad,cat:_0x18ba8d,valNew:_0x24b4c8}=_0x447d22['body'];console[_0x1263e2(0x1b9)](_0x447d22['body']);var _0x2f56ce='',_0x52b4f2='';if(_0x18ba8d==_0x1263e2(0x19d))_0x2f56ce=_0x1263e2(0x1aa),_0x24b4c8==_0x1263e2(0x1c8)?_0x52b4f2=[{'$match':{'status':_0x1263e2(0x194),'warehouse_category':_0x18ba8d,'name':{'$ne':_0x2f56ce},'name':_0x1263e2(0x19c)}},{'$group':{'_id':_0x1263e2(0x1b4),'room_name':{'$first':'$name'}}},{'$sort':{'room_name':0x1}}]:_0x52b4f2=[{'$match':{'status':_0x1263e2(0x194),'warehouse_category':_0x18ba8d,'name':{'$ne':_0x2f56ce}}},{'$group':{'_id':_0x1263e2(0x1b4),'room_name':{'$first':_0x1263e2(0x1b4)}}},{'$sort':{'room_name':0x1}}];else{if(_0x18ba8d=='Finished\x20Goods')_0x2f56ce=_0x1263e2(0x1ad),_0x52b4f2=[{'$match':{'status':'Enabled','warehouse_category':_0x18ba8d,'name':{'$ne':_0x2f56ce}}},{'$group':{'_id':_0x1263e2(0x1b4),'room_name':{'$first':_0x1263e2(0x1b4)}}},{'$sort':{'room_name':0x1}}];else _0x18ba8d==_0x1263e2(0x1d8)?_0x52b4f2=[{'$match':{'status':'Enabled','warehouse_category':_0x18ba8d,'name':{'$ne':_0x2f56ce}}},{'$group':{'_id':_0x1263e2(0x1b4),'room_name':{'$first':_0x1263e2(0x1b4)}}},{'$sort':{'room_name':0x1}}]:_0x52b4f2=[{'$match':{'status':_0x1263e2(0x194)}},{'$group':{'_id':'$name','room_name':{'$first':_0x1263e2(0x1b4)}}},{'$sort':{'room_name':0x1}}];}const _0x4506ef=await warehouse[_0x1263e2(0x1a6)](_0x52b4f2);_0x7d809a[_0x1263e2(0x1c5)](0xc8)[_0x1263e2(0x1b3)](_0x4506ef);}catch(_0xd9158b){_0x7d809a[_0x1263e2(0x1c5)](0x190)[_0x1263e2(0x1b3)]({'errorMessage':_0xd9158b[_0x1263e2(0x1d2)]}),console[_0x1263e2(0x1b9)](_0xd9158b);}}),router[a0_0x2a9f7d(0x1cb)](a0_0x2a9f7d(0x1a4),async(_0x2a7f2a,_0x4dcdfe)=>{const _0x391516=a0_0x2a9f7d;try{const {warehouse_name:_0x3687e9,cat:_0x5594a1}=_0x2a7f2a[_0x391516(0x1c1)],_0xe5c422=await warehouse[_0x391516(0x1a6)]([{'$match':{'status':_0x391516(0x194),'warehouse_category':_0x5594a1,'name':_0x3687e9}},{'$group':{'_id':_0x391516(0x185),'room_name':{'$first':_0x391516(0x185)}}},{'$sort':{'room_name':0x1}}]);_0x4dcdfe['status'](0xc8)[_0x391516(0x1b3)](_0xe5c422);}catch(_0x117626){_0x4dcdfe[_0x391516(0x1c5)](0x190)[_0x391516(0x1b3)]({'errorMessage':_0x117626[_0x391516(0x1d2)]});}}),module['exports']=router;