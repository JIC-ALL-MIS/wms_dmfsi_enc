const a0_0x454677=a0_0x2f4b;(function(_0x291670,_0x44541d){const _0x31e89f=a0_0x2f4b,_0x111976=_0x291670();while(!![]){try{const _0x3dabbd=parseInt(_0x31e89f(0x1e0))/0x1+parseInt(_0x31e89f(0x1c7))/0x2*(parseInt(_0x31e89f(0x1eb))/0x3)+parseInt(_0x31e89f(0x1fc))/0x4*(parseInt(_0x31e89f(0x1ec))/0x5)+parseInt(_0x31e89f(0x1c1))/0x6*(-parseInt(_0x31e89f(0x1da))/0x7)+parseInt(_0x31e89f(0x1cb))/0x8+-parseInt(_0x31e89f(0x1c8))/0x9+-parseInt(_0x31e89f(0x1c6))/0xa;if(_0x3dabbd===_0x44541d)break;else _0x111976['push'](_0x111976['shift']());}catch(_0x197b9a){_0x111976['push'](_0x111976['shift']());}}}(a0_0x3dc1,0x8824e));function a0_0x2f4b(_0x251862,_0x58e545){const _0x3dc14f=a0_0x3dc1();return a0_0x2f4b=function(_0x2f4b2d,_0xbaa522){_0x2f4b2d=_0x2f4b2d-0x1ba;let _0x3a27a6=_0x3dc14f[_0x2f4b2d];return _0x3a27a6;},a0_0x2f4b(_0x251862,_0x58e545);}const express=require(a0_0x454677(0x1c4)),app=express(),router=express[a0_0x454677(0x1f8)](),multer=require('multer'),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0x454677(0x1d5)),auth=require('../middleware/auth');var timezones=require('timezones-list');const users=require(a0_0x454677(0x1f5));function a0_0x3dc1(){const _0x554120=['$product_details.expiry_date','express','Arabic\x20(ae)','10282440dpUcGh','146cDhxnb','455796wxOPQj','flash','DRY\x20STORAGE','5256784BiFjHX','warehousemap_incoming','$product_details.product_stock','Rack\x20A','product','message','warehouse','$product_details.product_code','Portuguese','errors','../models/all_models','$_id.bay','German','status','aggregate','35aPwXAz','English','find','toLocaleString','Hindi','$_id.product','668971NkVyuY','Return\x20Goods','$product_details','/view','findOne','Portuguese\x20(BR)','success','$_id.bin','$expiry_date','json','/MapData2','1497aNTReT','5hnutGW','Spanish','en-US','$_id.type','$product_details.production_date','Raw\x20Materials','$product_details.product_name','render','log','../public/language/languages.json','$room','staff','Router','All','$name','raw','3186932uXJtgs','language','role','$products','$product_details.bay','pack','master','email','user','Arabic','post','Enabled','body','Chinese','627234XRNFdc','get'];a0_0x3dc1=function(){return _0x554120;};return a0_0x3dc1();}router[a0_0x454677(0x1c2)](a0_0x454677(0x1e3),auth,async(_0x4d275f,_0x51e335)=>{const _0x2cd000=a0_0x454677;try{const {username:_0x8599d9,email:_0x4c6bbb,role:_0x4e63c7}=_0x4d275f[_0x2cd000(0x1bb)],_0x117f47=_0x4d275f[_0x2cd000(0x1bb)],_0xb2398=await profile[_0x2cd000(0x1e4)]({'email':_0x117f47[_0x2cd000(0x1ba)]}),_0x20fc1c=await master_shop[_0x2cd000(0x1dc)]();console['log'](_0x2cd000(0x202),_0x20fc1c);let _0x365d28;if(_0x117f47[_0x2cd000(0x1fe)]==_0x2cd000(0x1f7)){const _0x408e42=await staff['findOne']({'email':_0x117f47[_0x2cd000(0x1ba)]});_0x365d28=await warehouse[_0x2cd000(0x1d9)]([{'$match':{'status':_0x2cd000(0x1be),'name':_0x408e42[_0x2cd000(0x1d1)]}},{'$group':{'_id':_0x2cd000(0x1fa),'name':{'$first':_0x2cd000(0x1fa)}}}]);}else _0x365d28=await warehouse['aggregate']([{'$match':{'status':_0x2cd000(0x1be)}},{'$group':{'_id':_0x2cd000(0x1fa),'name':{'$first':_0x2cd000(0x1fa)}}}]);const _0x19b3f9=new Date()[_0x2cd000(0x1dd)](_0x2cd000(0x1ee),{'timeZone':_0x20fc1c[0x0]['timezone']});console[_0x2cd000(0x1f4)]('timezone',_0x19b3f9);if(_0x20fc1c[0x0]['language']=='English\x20(US)'){var _0x2edab5=users[_0x2cd000(0x1db)];console[_0x2cd000(0x1f4)](_0x2edab5);}else{if(_0x20fc1c[0x0][_0x2cd000(0x1fd)]==_0x2cd000(0x1de))var _0x2edab5=users[_0x2cd000(0x1de)];else{if(_0x20fc1c[0x0]['language']=='German')var _0x2edab5=users[_0x2cd000(0x1d7)];else{if(_0x20fc1c[0x0][_0x2cd000(0x1fd)]==_0x2cd000(0x1ed))var _0x2edab5=users['Spanish'];else{if(_0x20fc1c[0x0][_0x2cd000(0x1fd)]=='French')var _0x2edab5=users['French'];else{if(_0x20fc1c[0x0]['language']==_0x2cd000(0x1e5))var _0x2edab5=users[_0x2cd000(0x1d3)];else{if(_0x20fc1c[0x0][_0x2cd000(0x1fd)]=='Chinese')var _0x2edab5=users[_0x2cd000(0x1c0)];else{if(_0x20fc1c[0x0][_0x2cd000(0x1fd)]==_0x2cd000(0x1c5))var _0x2edab5=users[_0x2cd000(0x1bc)];}}}}}}}_0x51e335[_0x2cd000(0x1f3)](_0x2cd000(0x1cc),{'success':_0x4d275f[_0x2cd000(0x1c9)](_0x2cd000(0x1e6)),'errors':_0x4d275f['flash'](_0x2cd000(0x1d4)),'role':_0x117f47,'profile':_0xb2398,'master_shop':_0x20fc1c,'timezones':timezones,'language':_0x2edab5,'warehouse':_0x365d28});}catch(_0x547af8){console[_0x2cd000(0x1f4)](_0x547af8),_0x51e335[_0x2cd000(0x1d8)](0xc8)[_0x2cd000(0x1e9)]({'message':_0x547af8['message']});}}),router['post']('/MapData',async(_0x5d8bb9,_0x3bb624)=>{const _0x36366d=a0_0x454677,{warehouseNew:_0x2e6f53,rooms:_0xf07c22,Type:_0x411378}=_0x5d8bb9[_0x36366d(0x1bf)],_0x114421=await warehouse[_0x36366d(0x1d9)]([{'$unwind':_0x36366d(0x1e2)},{'$match':{'name':_0x2e6f53,'room':_0xf07c22,'product_details.type':_0x411378}},{'$group':{'_id':{'bay':'$product_details.bay','bin':'$product_details.bin','type':'$product_details.type','floorlevel':'$product_details.floorlevel'},'products':{'$push':{'product_name':_0x36366d(0x1f2),'product_quantity':'$product_details.product_stock','product_code':_0x36366d(0x1d2)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x36366d(0x1cd),0x0]},'then':_0x36366d(0x1cd),'else':0x0}}}}},{'$project':{'_id':0x0,'bay':_0x36366d(0x1d6),'bin':_0x36366d(0x1e7),'type':_0x36366d(0x1ef),'floorlevel':'$_id.floorlevel','products':{'$filter':{'input':_0x36366d(0x1ff),'as':_0x36366d(0x1cf),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x3bb624[_0x36366d(0x1e9)](_0x114421);}),router['post'](a0_0x454677(0x1ea),async(_0xdb731e,_0x1aa966)=>{const _0x187ece=a0_0x454677,{warehouseNew:_0x39dfaf,rooms:_0x4e0a41,room_cat:_0x258e07}=_0xdb731e[_0x187ece(0x1bf)];let _0x3366f7;if(_0x258e07==_0x187ece(0x1f9))_0x3366f7=await warehouse[_0x187ece(0x1d9)]([{'$unwind':_0x187ece(0x1e2)},{'$match':{'name':_0x39dfaf}},{'$group':{'_id':{'bay':_0x187ece(0x200),'product':_0x187ece(0x1f2),'expiry':_0x187ece(0x1c3)},'count':{'$sum':_0x187ece(0x1cd)},'production_date':{'$first':_0x187ece(0x1f0)},'expiry_date':{'$first':_0x187ece(0x1c3)},'batch_code':{'$first':'$product_details.batch_code'},'product_code':{'$first':'$product_details.product_code'}}},{'$group':{'_id':'$_id.bay','products':{'$push':{'product':_0x187ece(0x1df),'quantity':'$count','production_date':'$production_date','expiry_date':_0x187ece(0x1e8),'batch_code':'$batch_code','product_code':'$product_code'}},'totalQuantity':{'$sum':'$count'}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':'$_id','products':0x1,'totalQuantity':0x1}}]),console[_0x187ece(0x1f4)](_0x258e07);else{}_0x1aa966[_0x187ece(0x1e9)](_0x3366f7);}),router[a0_0x454677(0x1bd)]('/Rooms_data',async(_0x2d221e,_0x11acd2)=>{const _0x2a9c59=a0_0x454677;try{const {warehouse_name:_0x17bf58,A:_0x18689a,B:_0x3a53af}=_0x2d221e[_0x2a9c59(0x1bf)];var _0x7f55ab='';_0x18689a==_0x2a9c59(0x1fb)?_0x3a53af==_0x2a9c59(0x201)?_0x7f55ab=[{'$match':{'name':_0x17bf58,'status':_0x2a9c59(0x1be),'room':_0x2a9c59(0x1ce)}},{'$group':{'_id':'$_id','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]:_0x7f55ab=[{'$match':{'name':_0x17bf58,'status':'Enabled'}},{'$group':{'_id':'$_id','room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}]:_0x7f55ab=[{'$match':{'name':_0x17bf58,'status':_0x2a9c59(0x1be)}},{'$group':{'_id':'$_id','room_name':{'$first':_0x2a9c59(0x1f6)}}},{'$sort':{'room_name':0x1}}];const _0x5d1efc=await warehouse[_0x2a9c59(0x1d9)](_0x7f55ab);_0x11acd2[_0x2a9c59(0x1d8)](0xc8)[_0x2a9c59(0x1e9)](_0x5d1efc);}catch(_0x2e966a){_0x11acd2['status'](0x190)[_0x2a9c59(0x1e9)]({'errorMessage':_0x2e966a[_0x2a9c59(0x1d0)]});}}),router[a0_0x454677(0x1bd)]('/Rooms_data2',async(_0x491fc,_0x9382e3)=>{const _0x9db9a=a0_0x454677;try{const {warehouse_name:_0x2aea33,cat:_0x5300c3,valNew:_0x28241c}=_0x491fc[_0x9db9a(0x1bf)];var _0x43a959='',_0x3faa89='';if(_0x5300c3==_0x9db9a(0x1f1))_0x43a959=_0x9db9a(0x1e1),_0x28241c=='pack'?_0x3faa89=[{'$match':{'status':_0x9db9a(0x1be),'warehouse_category':_0x5300c3,'name':{'$ne':_0x43a959},'name':_0x9db9a(0x1ca)}},{'$group':{'_id':'$name','room_name':{'$first':_0x9db9a(0x1fa)}}},{'$sort':{'room_name':0x1}}]:_0x3faa89=[{'$match':{'status':_0x9db9a(0x1be),'warehouse_category':_0x5300c3,'name':{'$ne':_0x43a959}}},{'$group':{'_id':_0x9db9a(0x1fa),'room_name':{'$first':_0x9db9a(0x1fa)}}},{'$sort':{'room_name':0x1}}];else _0x5300c3=='Finished\x20Goods'?(_0x43a959='QA\x20Warehouse',_0x3faa89=[{'$match':{'status':'Enabled','warehouse_category':_0x5300c3,'name':{'$ne':_0x43a959}}},{'$group':{'_id':_0x9db9a(0x1fa),'room_name':{'$first':_0x9db9a(0x1fa)}}},{'$sort':{'room_name':0x1}}]):_0x3faa89=[{'$match':{'status':_0x9db9a(0x1be)}},{'$group':{'_id':'$name','room_name':{'$first':_0x9db9a(0x1fa)}}},{'$sort':{'room_name':0x1}}];const _0x5d364f=await warehouse[_0x9db9a(0x1d9)](_0x3faa89);_0x9382e3[_0x9db9a(0x1d8)](0xc8)[_0x9db9a(0x1e9)](_0x5d364f);}catch(_0x28abb7){_0x9382e3[_0x9db9a(0x1d8)](0x190)[_0x9db9a(0x1e9)]({'errorMessage':_0x28abb7[_0x9db9a(0x1d0)]}),console[_0x9db9a(0x1f4)](_0x28abb7);}}),router[a0_0x454677(0x1bd)]('/Rooms_data3',async(_0x22238b,_0x5275db)=>{const _0x8958db=a0_0x454677;try{const {warehouse_name:_0x3cb917,cat:_0x147786}=_0x22238b[_0x8958db(0x1bf)],_0x577e99=await warehouse[_0x8958db(0x1d9)]([{'$match':{'status':_0x8958db(0x1be),'warehouse_category':_0x147786,'name':_0x3cb917}},{'$group':{'_id':_0x8958db(0x1f6),'room_name':{'$first':_0x8958db(0x1f6)}}},{'$sort':{'room_name':0x1}}]);_0x5275db[_0x8958db(0x1d8)](0xc8)[_0x8958db(0x1e9)](_0x577e99);}catch(_0x562546){_0x5275db[_0x8958db(0x1d8)](0x190)[_0x8958db(0x1e9)]({'errorMessage':_0x562546['message']});}}),module['exports']=router;