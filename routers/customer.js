const a0_0x334b68=a0_0x206b;function a0_0x206b(_0x10b414,_0x1451df){const _0x578284=a0_0x5782();return a0_0x206b=function(_0x206b21,_0x560353){_0x206b21=_0x206b21-0x151;let _0xdb9e64=_0x578284[_0x206b21];return _0xdb9e64;},a0_0x206b(_0x10b414,_0x1451df);}(function(_0xdec2eb,_0x4961d1){const _0x2849e5=a0_0x206b,_0x475b55=_0xdec2eb();while(!![]){try{const _0x1bd17a=-parseInt(_0x2849e5(0x1b2))/0x1*(-parseInt(_0x2849e5(0x182))/0x2)+-parseInt(_0x2849e5(0x1ae))/0x3+-parseInt(_0x2849e5(0x15d))/0x4+-parseInt(_0x2849e5(0x18b))/0x5*(-parseInt(_0x2849e5(0x16a))/0x6)+-parseInt(_0x2849e5(0x18e))/0x7*(-parseInt(_0x2849e5(0x16b))/0x8)+parseInt(_0x2849e5(0x1b8))/0x9*(parseInt(_0x2849e5(0x164))/0xa)+parseInt(_0x2849e5(0x192))/0xb*(-parseInt(_0x2849e5(0x187))/0xc);if(_0x1bd17a===_0x4961d1)break;else _0x475b55['push'](_0x475b55['shift']());}catch(_0x2b4751){_0x475b55['push'](_0x475b55['shift']());}}}(a0_0x5782,0x6fe8c));const express=require('express'),app=express(),router=express[a0_0x334b68(0x178)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x334b68(0x15e)),auth=require(a0_0x334b68(0x153)),users=require(a0_0x334b68(0x160)),excelJS=require(a0_0x334b68(0x175)),xlsx=require(a0_0x334b68(0x171)),multer=require(a0_0x334b68(0x1a8));router['get']('/view',auth,async(_0x42c9ad,_0x3ec37e)=>{const _0x1e59be=a0_0x334b68;try{const {username:_0x24564e,email:_0x86e1a2,role:_0x27bae3}=_0x42c9ad[_0x1e59be(0x157)],_0x46a394=_0x42c9ad[_0x1e59be(0x157)],_0x2365db=await profile[_0x1e59be(0x1a6)]({'email':_0x46a394[_0x1e59be(0x161)]}),_0x1b36a2=await master_shop[_0x1e59be(0x19a)]();console[_0x1e59be(0x184)](_0x1e59be(0x166),_0x1b36a2);const _0x49e824=await customer[_0x1e59be(0x19a)](),_0x4969a0=await customer['aggregate']([{'$lookup':{'from':_0x1e59be(0x17f),'localField':_0x1e59be(0x1b6),'foreignField':'customer','as':_0x1e59be(0x19c)}}]);console[_0x1e59be(0x184)](_0x4969a0);const _0xffa8e8=_0x4969a0[_0x1e59be(0x18d)](_0x1ea5d7=>{const _0x9eaed7=_0x1e59be;console[_0x9eaed7(0x184)](_0x9eaed7(0x163),_0x1ea5d7);var _0x25f8ef=0x0,_0xf62fa4=0x0;return _0x1ea5d7[_0x9eaed7(0x19c)]['forEach'](_0x37fdcf=>{const _0x2ba374=_0x9eaed7;console[_0x2ba374(0x184)](_0x2ba374(0x16c),_0x37fdcf),_0x37fdcf[_0x2ba374(0x169)]=='Sale'?_0x25f8ef+=_0x37fdcf['amount']:_0xf62fa4+=_0x37fdcf[_0x2ba374(0x1aa)];}),_0x1ea5d7['sale']=parseFloat(_0x25f8ef)+0x0,_0x1ea5d7['sale_return']=parseFloat(_0xf62fa4)+0x0,_0x1ea5d7;});console[_0x1e59be(0x184)]('payment_data',_0xffa8e8);if(_0x1b36a2[0x0][_0x1e59be(0x198)]==_0x1e59be(0x158)){var _0x3c2161=users[_0x1e59be(0x1b5)];console['log'](_0x3c2161);}else{if(_0x1b36a2[0x0]['language']==_0x1e59be(0x1a0))var _0x3c2161=users['Hindi'];else{if(_0x1b36a2[0x0][_0x1e59be(0x198)]==_0x1e59be(0x155))var _0x3c2161=users[_0x1e59be(0x155)];else{if(_0x1b36a2[0x0]['language']==_0x1e59be(0x1b9))var _0x3c2161=users[_0x1e59be(0x1b9)];else{if(_0x1b36a2[0x0][_0x1e59be(0x198)]=='French')var _0x3c2161=users[_0x1e59be(0x159)];else{if(_0x1b36a2[0x0][_0x1e59be(0x198)]=='Portuguese\x20(BR)')var _0x3c2161=users['Portuguese'];else{if(_0x1b36a2[0x0]['language']==_0x1e59be(0x1a1))var _0x3c2161=users[_0x1e59be(0x1a1)];else{if(_0x1b36a2[0x0][_0x1e59be(0x198)]==_0x1e59be(0x1a3))var _0x3c2161=users[_0x1e59be(0x194)];}}}}}}}_0x3ec37e[_0x1e59be(0x18f)](_0x1e59be(0x172),{'success':_0x42c9ad[_0x1e59be(0x189)](_0x1e59be(0x16e)),'errors':_0x42c9ad['flash']('errors'),'user':_0x49e824,'role':_0x46a394,'profile':_0x2365db,'payment':_0xffa8e8,'master_shop':_0x1b36a2,'language':_0x3c2161});}catch(_0x4557aa){console['log'](_0x4557aa);}}),router[a0_0x334b68(0x152)](a0_0x334b68(0x19f),auth,async(_0x3b081b,_0x5c84c6)=>{const _0x582248=a0_0x334b68;try{const {name:_0xe336e5,address:_0x4ea442,mobile:_0x4cc7c4,email:_0x3c4456,receivable:_0xbcd94a,payable:_0x2a0c0d,contactperson:_0x3e48aa,landline:_0x3ae12f}=_0x3b081b[_0x582248(0x1b3)],_0x39fd89=new customer({'name':_0xe336e5,'address':_0x4ea442,'mobile':_0x4cc7c4,'email':_0x3c4456,'receivable':_0xbcd94a,'payable':_0x2a0c0d,'contactperson':_0x3e48aa,'landline':_0x3ae12f}),_0x6f5636=await _0x39fd89[_0x582248(0x154)]();_0x3b081b[_0x582248(0x189)]('success',_0x582248(0x1a2)),_0x5c84c6[_0x582248(0x167)](_0x582248(0x195));}catch(_0x440874){console['log'](_0x440874);}}),router['get'](a0_0x334b68(0x19b),auth,async(_0x3245b6,_0x4d4672)=>{const _0x5c039e=a0_0x334b68;try{const {username:_0x296d9,email:_0x469ecc,role:_0x1043eb}=_0x3245b6['user'],_0x869922=_0x3245b6[_0x5c039e(0x157)],_0x2eec7b=await profile[_0x5c039e(0x1a6)]({'email':_0x869922['email']}),_0x2a42a3=await master_shop[_0x5c039e(0x19a)]();console[_0x5c039e(0x184)](_0x5c039e(0x166),_0x2a42a3);const _0x469e6f=_0x3245b6[_0x5c039e(0x177)]['id'],_0x1428b8=await customer['findById'](_0x469e6f);if(_0x2a42a3[0x0]['language']=='English\x20(US)'){var _0x1c04ce=users['English'];console[_0x5c039e(0x184)](_0x1c04ce);}else{if(_0x2a42a3[0x0][_0x5c039e(0x198)]==_0x5c039e(0x1a0))var _0x1c04ce=users[_0x5c039e(0x1a0)];else{if(_0x2a42a3[0x0][_0x5c039e(0x198)]==_0x5c039e(0x155))var _0x1c04ce=users['German'];else{if(_0x2a42a3[0x0]['language']==_0x5c039e(0x1b9))var _0x1c04ce=users[_0x5c039e(0x1b9)];else{if(_0x2a42a3[0x0][_0x5c039e(0x198)]==_0x5c039e(0x159))var _0x1c04ce=users[_0x5c039e(0x159)];else{if(_0x2a42a3[0x0]['language']==_0x5c039e(0x185))var _0x1c04ce=users['Portuguese'];else{if(_0x2a42a3[0x0][_0x5c039e(0x198)]=='Chinese')var _0x1c04ce=users[_0x5c039e(0x1a1)];else{if(_0x2a42a3[0x0]['language']=='Arabic\x20(ae)')var _0x1c04ce=users[_0x5c039e(0x194)];}}}}}}}_0x4d4672['render'](_0x5c039e(0x172),{'success':_0x3245b6[_0x5c039e(0x189)](_0x5c039e(0x16e)),'errors':_0x3245b6[_0x5c039e(0x189)](_0x5c039e(0x170)),'role':_0x869922,'profile':_0x2eec7b,'user':_0x1428b8,'master_shop':_0x2a42a3,'language':_0x1c04ce});}catch(_0x40d261){console[_0x5c039e(0x184)](_0x40d261);}}),router[a0_0x334b68(0x152)](a0_0x334b68(0x19b),auth,async(_0x3a2bb3,_0x307f50)=>{const _0x488458=a0_0x334b68;try{const _0x53eaa3=_0x3a2bb3[_0x488458(0x177)]['id'],_0x390ad9=await customer[_0x488458(0x193)](_0x53eaa3),{name:_0x32157b,address:_0x3a9f95,mobile:_0x496d2a,email:_0x4b03c8,receivable:_0x3c02ea,payable:_0x14536d,contactperson:_0x10c498,landline:_0x4a2081}=_0x3a2bb3[_0x488458(0x1b3)];_0x390ad9[_0x488458(0x1b6)]=_0x32157b,_0x390ad9[_0x488458(0x17c)]=_0x3a9f95,_0x390ad9['mobile']=_0x496d2a,_0x390ad9[_0x488458(0x161)]=_0x4b03c8,_0x390ad9['receivable']=_0x3c02ea,_0x390ad9[_0x488458(0x180)]=_0x14536d,_0x390ad9[_0x488458(0x17b)]=_0x10c498,_0x390ad9[_0x488458(0x17e)]=_0x4a2081;const _0x36c0c6=await _0x390ad9[_0x488458(0x154)]();_0x3a2bb3['flash'](_0x488458(0x16e),_0x488458(0x1ba)),_0x307f50[_0x488458(0x167)]('/customer/view');}catch(_0x17337a){console['log'](_0x17337a);}}),router[a0_0x334b68(0x15a)]('/view/payment/:id',auth,async(_0x4f7458,_0x978c86)=>{const _0x37e41a=a0_0x334b68;try{const {username:_0x26729c,email:_0x21074a,role:_0x28c72d}=_0x4f7458[_0x37e41a(0x157)],_0x10e8a5=_0x4f7458[_0x37e41a(0x157)],_0x337f5e=await profile[_0x37e41a(0x1a6)]({'email':_0x10e8a5[_0x37e41a(0x161)]}),_0x29e594=await master_shop[_0x37e41a(0x19a)]();console[_0x37e41a(0x184)](_0x37e41a(0x166),_0x29e594),console[_0x37e41a(0x184)](_0x4f7458['params']['id']);const _0x34241f=await customer['findOne']({'_id':_0x4f7458['params']['id']});console[_0x37e41a(0x184)]('customer_data',_0x34241f);const _0x2df2c3=await c_payment_data[_0x37e41a(0x19a)]({'customer':_0x34241f[_0x37e41a(0x1b6)]});console[_0x37e41a(0x184)](_0x2df2c3);const _0x2e5769=await c_payment_data[_0x37e41a(0x191)]([{'$match':{'customer':_0x34241f['name']}},{'$match':{'reason':_0x37e41a(0x197)}},{'$group':{'_id':_0x37e41a(0x186),'sum':{'$sum':_0x37e41a(0x1a9)}}}]);console['log'](_0x37e41a(0x16d),_0x2e5769);const _0x352479=await c_payment_data[_0x37e41a(0x191)]([{'$match':{'customer':_0x34241f[_0x37e41a(0x1b6)]}},{'$match':{'reason':_0x37e41a(0x15b)}},{'$group':{'_id':_0x37e41a(0x186),'sum':{'$sum':_0x37e41a(0x1a9)}}}]);console[_0x37e41a(0x184)]('receivable_sum',_0x352479);if(_0x29e594[0x0][_0x37e41a(0x198)]==_0x37e41a(0x158)){var _0x53d091=users['English'];console[_0x37e41a(0x184)](_0x53d091);}else{if(_0x29e594[0x0][_0x37e41a(0x198)]==_0x37e41a(0x1a0))var _0x53d091=users['Hindi'];else{if(_0x29e594[0x0][_0x37e41a(0x198)]=='German')var _0x53d091=users[_0x37e41a(0x155)];else{if(_0x29e594[0x0][_0x37e41a(0x198)]==_0x37e41a(0x1b9))var _0x53d091=users[_0x37e41a(0x1b9)];else{if(_0x29e594[0x0]['language']==_0x37e41a(0x159))var _0x53d091=users[_0x37e41a(0x159)];else{if(_0x29e594[0x0][_0x37e41a(0x198)]==_0x37e41a(0x185))var _0x53d091=users[_0x37e41a(0x181)];else{if(_0x29e594[0x0][_0x37e41a(0x198)]==_0x37e41a(0x1a1))var _0x53d091=users['Chinese'];else{if(_0x29e594[0x0][_0x37e41a(0x198)]==_0x37e41a(0x1a3))var _0x53d091=users[_0x37e41a(0x194)];}}}}}}}_0x978c86['render'](_0x37e41a(0x1b1),{'success':_0x4f7458['flash'](_0x37e41a(0x16e)),'errors':_0x4f7458[_0x37e41a(0x189)](_0x37e41a(0x170)),'role':_0x10e8a5,'profile':_0x337f5e,'payment':_0x2df2c3,'payable':_0x2e5769,'receivable':_0x352479,'master_shop':_0x29e594,'language':_0x53d091});}catch(_0x4b8ed8){console[_0x37e41a(0x184)](_0x4b8ed8);}}),router['get'](a0_0x334b68(0x162),auth,async(_0x4c31a7,_0x29298e)=>{const _0x47dfe7=a0_0x334b68;try{const _0x1b2309=new excelJS[(_0x47dfe7(0x1a4))](),_0x56a815=_0x1b2309[_0x47dfe7(0x17a)]('Customers');return _0x56a815[_0x47dfe7(0x168)]=[{'header':'ID','key':_0x47dfe7(0x173),'width':0xa},{'header':_0x47dfe7(0x174),'key':_0x47dfe7(0x1b0),'width':0xa},{'header':_0x47dfe7(0x199),'key':_0x47dfe7(0x196),'width':0xa},{'header':_0x47dfe7(0x179),'key':_0x47dfe7(0x179),'width':0xa},{'header':_0x47dfe7(0x17c),'key':'address','width':0xa},{'header':'mobile','key':_0x47dfe7(0x1ac),'width':0xa},{'header':_0x47dfe7(0x161),'key':_0x47dfe7(0x161),'width':0xa}],_0x29298e[_0x47dfe7(0x1b7)](_0x47dfe7(0x15f),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x29298e[_0x47dfe7(0x1b7)](_0x47dfe7(0x15c),_0x47dfe7(0x19d)),_0x1b2309[_0x47dfe7(0x171)]['write'](_0x29298e)['then'](()=>{const _0x3b3788=_0x47dfe7;_0x29298e[_0x3b3788(0x1af)](0xc8);});}catch(_0x2bf317){_0x29298e[_0x47dfe7(0x1af)](0x190)[_0x47dfe7(0x16f)]({'errors':_0x2bf317['message']});}});const storage1=multer[a0_0x334b68(0x1b4)]({'destination':(_0x42abf8,_0x4cce85,_0x5cc215)=>{const _0xa7a0a1=a0_0x334b68;_0x5cc215(null,_0xa7a0a1(0x183));},'filename':(_0xdf677d,_0x572819,_0x1dacac)=>{const _0x2c8675=a0_0x334b68;_0x1dacac(null,Date[_0x2c8675(0x1a7)]()+_0x572819[_0x2c8675(0x1ab)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x5782(){const _0x23f56b=['Content-Type','../public/language/languages.json','email','/products_export_migrate_file','data','75940czvWAz','message','master','redirect','columns','reason','228NFhprq','8gwxDqr','element','payable_sum','success','send','errors','xlsx','customer','PName','Name','exceljs','/customer_import_migrate_file','params','Router','SalesmanName','addWorksheet','contactperson','address','customer_product_fule','landline','c_payments','payable','Portuguese','278422sSSFjz','public/Migration','log','Portuguese\x20(BR)','$reason','84NlYPpz','\x20Failed','flash','sheet_to_json','92070MVktyx','single','map','5698889jTqTWs','render','readFile','aggregate','2802712CKkAID','findById','Arabic','/customer/view','PUnits','Sale','language','SalesmanCode','find','/view/:id','customer_docs','attachment;\x20filename=customer_Migration_File.xlsx','filename','/view','Hindi','Chinese','customer\x20add\x20successfully','Arabic\x20(ae)','Workbook','error','findOne','now','multer','$amount','amount','originalname','mobile','\x20added\x20successfully','833628FhpurF','status','PBrands','customer_payment','5QPnJgI','body','diskStorage','English','name','setHeader','477BmcrOz','Spanish','customer\x20update\x20successfully','json','post','../middleware/auth','save','German','exports','user','English\x20(US)','French','get','Sale\x20Return','Content-Disposition','370384rESAgD','../models/all_models'];a0_0x5782=function(){return _0x23f56b;};return a0_0x5782();}router[a0_0x334b68(0x152)](a0_0x334b68(0x176),auth,uploadMigrate[a0_0x334b68(0x18c)](a0_0x334b68(0x17d)),async(_0x8e8d,_0x22bd2f)=>{const _0x1ff664=a0_0x334b68,_0x3e7b8d=_0x8e8d['file'][_0x1ff664(0x19e)],_0x2ba9b0=await xlsx[_0x1ff664(0x190)]('public/Migration/'+_0x3e7b8d);let _0x28f971=_0x2ba9b0['SheetNames'],_0x421c2d=xlsx['utils'][_0x1ff664(0x18a)](_0x2ba9b0['Sheets'][_0x28f971[0x0]]);for(const _0x1457cb of _0x421c2d){const _0x2f58c0=_0x1457cb['ID'],_0x115557=_0x1457cb[_0x1ff664(0x174)],_0x3a9b9f=_0x1457cb[_0x1ff664(0x199)],_0x8e4b19=_0x1457cb['SalesmanName'],_0x41c06c=_0x1457cb[_0x1ff664(0x17c)],_0x563f8d=_0x1457cb[_0x1ff664(0x1ac)],_0x3bdd0f=_0x1457cb[_0x1ff664(0x161)];try{let _0x5ecfa3=await customer['findOne']({'name':_0x115557});if(!_0x5ecfa3){const _0x511eab=new customer({'name':_0x115557,'ID':_0x2f58c0,'SalesmanCode':_0x3a9b9f,'SalesmanName':_0x8e4b19,'address':_0x41c06c,'mobile':_0x563f8d,'email':_0x3bdd0f});_0x5ecfa3=await _0x511eab['save'](),_0x8e8d['flash'](_0x1ff664(0x16e),_0x115557+_0x1ff664(0x1ad));}else _0x8e8d[_0x1ff664(0x189)](_0x1ff664(0x1a5),_0x115557+_0x1ff664(0x188));}catch(_0x19ba4b){_0x22bd2f[_0x1ff664(0x1af)](0x1f4)[_0x1ff664(0x151)]({'proderror':_0x19ba4b[_0x1ff664(0x165)],'aproduct':ProductName});}}_0x22bd2f['redirect'](_0x1ff664(0x195));}),module[a0_0x334b68(0x156)]=router;