const a0_0x4fb3cd=a0_0x53e9;function a0_0x53e9(_0x375262,_0x42b5da){const _0x55b4d1=a0_0x55b4();return a0_0x53e9=function(_0x53e9c6,_0x21a381){_0x53e9c6=_0x53e9c6-0xcf;let _0x3304aa=_0x55b4d1[_0x53e9c6];return _0x3304aa;},a0_0x53e9(_0x375262,_0x42b5da);}(function(_0x2b686a,_0x45b682){const _0x5a39d9=a0_0x53e9,_0x309d96=_0x2b686a();while(!![]){try{const _0x452f23=parseInt(_0x5a39d9(0x118))/0x1*(-parseInt(_0x5a39d9(0xef))/0x2)+parseInt(_0x5a39d9(0x137))/0x3+-parseInt(_0x5a39d9(0xf5))/0x4+-parseInt(_0x5a39d9(0xfe))/0x5*(parseInt(_0x5a39d9(0xe8))/0x6)+parseInt(_0x5a39d9(0xee))/0x7+-parseInt(_0x5a39d9(0x11d))/0x8*(parseInt(_0x5a39d9(0x102))/0x9)+parseInt(_0x5a39d9(0x133))/0xa*(parseInt(_0x5a39d9(0x12a))/0xb);if(_0x452f23===_0x45b682)break;else _0x309d96['push'](_0x309d96['shift']());}catch(_0x14fa2b){_0x309d96['push'](_0x309d96['shift']());}}}(a0_0x55b4,0x94b9d));const express=require(a0_0x4fb3cd(0xcf)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x4fb3cd(0x105)),auth=require(a0_0x4fb3cd(0x12e)),users=require(a0_0x4fb3cd(0x101)),excelJS=require(a0_0x4fb3cd(0xf0)),xlsx=require(a0_0x4fb3cd(0x110)),multer=require(a0_0x4fb3cd(0x127));router[a0_0x4fb3cd(0x10f)](a0_0x4fb3cd(0x10b),auth,async(_0x101073,_0x257deb)=>{const _0x36bf2f=a0_0x4fb3cd;try{const {username:_0x5e481e,email:_0x7db77f,role:_0x405baa}=_0x101073[_0x36bf2f(0xf7)],_0xc35325=_0x101073[_0x36bf2f(0xf7)],_0x4eff9a=await profile[_0x36bf2f(0xe3)]({'email':_0xc35325['email']}),_0x319b85=await master_shop[_0x36bf2f(0xd7)]();console[_0x36bf2f(0xfa)](_0x36bf2f(0x129),_0x319b85);const _0x2cb132=await customer[_0x36bf2f(0xd7)](),_0x14429f=await customer[_0x36bf2f(0x12c)]([{'$lookup':{'from':'c_payments','localField':_0x36bf2f(0xd9),'foreignField':_0x36bf2f(0x121),'as':_0x36bf2f(0x126)}}]);console[_0x36bf2f(0xfa)](_0x14429f);const _0x2e4823=_0x14429f[_0x36bf2f(0xd2)](_0x1e975a=>{const _0x6c00c6=_0x36bf2f;console[_0x6c00c6(0xfa)](_0x6c00c6(0x134),_0x1e975a);var _0x4d6475=0x0,_0x250bbe=0x0;return _0x1e975a[_0x6c00c6(0x126)][_0x6c00c6(0x123)](_0x2b07be=>{const _0x3a8441=_0x6c00c6;console[_0x3a8441(0xfa)]('element',_0x2b07be),_0x2b07be[_0x3a8441(0xf4)]==_0x3a8441(0xeb)?_0x4d6475+=_0x2b07be['amount']:_0x250bbe+=_0x2b07be['amount'];}),_0x1e975a[_0x6c00c6(0x112)]=parseFloat(_0x4d6475)+0x0,_0x1e975a[_0x6c00c6(0x12d)]=parseFloat(_0x250bbe)+0x0,_0x1e975a;});console[_0x36bf2f(0xfa)](_0x36bf2f(0xf9),_0x2e4823);if(_0x319b85[0x0][_0x36bf2f(0xe7)]==_0x36bf2f(0x115)){var _0x4735c6=users[_0x36bf2f(0x12b)];console['log'](_0x4735c6);}else{if(_0x319b85[0x0][_0x36bf2f(0xe7)]==_0x36bf2f(0xe4))var _0x4735c6=users[_0x36bf2f(0xe4)];else{if(_0x319b85[0x0][_0x36bf2f(0xe7)]==_0x36bf2f(0xde))var _0x4735c6=users[_0x36bf2f(0xde)];else{if(_0x319b85[0x0]['language']=='Spanish')var _0x4735c6=users[_0x36bf2f(0xe9)];else{if(_0x319b85[0x0][_0x36bf2f(0xe7)]=='French')var _0x4735c6=users['French'];else{if(_0x319b85[0x0]['language']==_0x36bf2f(0x131))var _0x4735c6=users[_0x36bf2f(0x11a)];else{if(_0x319b85[0x0][_0x36bf2f(0xe7)]=='Chinese')var _0x4735c6=users['Chinese'];else{if(_0x319b85[0x0]['language']==_0x36bf2f(0xd1))var _0x4735c6=users[_0x36bf2f(0xdc)];}}}}}}}_0x257deb[_0x36bf2f(0x103)]('customer',{'success':_0x101073['flash'](_0x36bf2f(0x11c)),'errors':_0x101073[_0x36bf2f(0x119)]('errors'),'user':_0x2cb132,'role':_0xc35325,'profile':_0x4eff9a,'payment':_0x2e4823,'master_shop':_0x319b85,'language':_0x4735c6});}catch(_0x29acaa){console[_0x36bf2f(0xfa)](_0x29acaa);}}),router[a0_0x4fb3cd(0x106)](a0_0x4fb3cd(0x10b),auth,async(_0x4c3062,_0x336d44)=>{const _0x474ffa=a0_0x4fb3cd;try{const {name:_0x39e7a3,address:_0x25046b,mobile:_0x118188,email:_0x27e461,receivable:_0x19bb00,payable:_0x312b65,contactperson:_0x11529f,landline:_0x44c560}=_0x4c3062[_0x474ffa(0x107)],_0x1fdb98=new customer({'name':_0x39e7a3,'address':_0x25046b,'mobile':_0x118188,'email':_0x27e461,'receivable':_0x19bb00,'payable':_0x312b65,'contactperson':_0x11529f,'landline':_0x44c560}),_0x2558d9=await _0x1fdb98[_0x474ffa(0x10e)]();_0x4c3062[_0x474ffa(0x119)]('success','customer\x20add\x20successfully'),_0x336d44[_0x474ffa(0x11e)](_0x474ffa(0x109));}catch(_0x1e756d){console[_0x474ffa(0xfa)](_0x1e756d);}}),router['get'](a0_0x4fb3cd(0x116),auth,async(_0x775d57,_0x8db78e)=>{const _0x26c202=a0_0x4fb3cd;try{const {username:_0xc4307f,email:_0x15281f,role:_0x18d889}=_0x775d57[_0x26c202(0xf7)],_0x3c3600=_0x775d57[_0x26c202(0xf7)],_0x1992d0=await profile[_0x26c202(0xe3)]({'email':_0x3c3600[_0x26c202(0xf2)]}),_0xf1dd83=await master_shop[_0x26c202(0xd7)]();console[_0x26c202(0xfa)](_0x26c202(0x129),_0xf1dd83);const _0x1817c2=_0x775d57['params']['id'],_0x27d571=await customer['findById'](_0x1817c2);if(_0xf1dd83[0x0][_0x26c202(0xe7)]==_0x26c202(0x115)){var _0xc76f82=users[_0x26c202(0x12b)];console[_0x26c202(0xfa)](_0xc76f82);}else{if(_0xf1dd83[0x0][_0x26c202(0xe7)]==_0x26c202(0xe4))var _0xc76f82=users['Hindi'];else{if(_0xf1dd83[0x0][_0x26c202(0xe7)]=='German')var _0xc76f82=users[_0x26c202(0xde)];else{if(_0xf1dd83[0x0][_0x26c202(0xe7)]=='Spanish')var _0xc76f82=users[_0x26c202(0xe9)];else{if(_0xf1dd83[0x0][_0x26c202(0xe7)]==_0x26c202(0xf6))var _0xc76f82=users[_0x26c202(0xf6)];else{if(_0xf1dd83[0x0][_0x26c202(0xe7)]==_0x26c202(0x131))var _0xc76f82=users[_0x26c202(0x11a)];else{if(_0xf1dd83[0x0]['language']=='Chinese')var _0xc76f82=users[_0x26c202(0x10c)];else{if(_0xf1dd83[0x0][_0x26c202(0xe7)]=='Arabic\x20(ae)')var _0xc76f82=users['Arabic'];}}}}}}}_0x8db78e[_0x26c202(0x103)](_0x26c202(0x121),{'success':_0x775d57[_0x26c202(0x119)](_0x26c202(0x11c)),'errors':_0x775d57[_0x26c202(0x119)](_0x26c202(0x124)),'role':_0x3c3600,'profile':_0x1992d0,'user':_0x27d571,'master_shop':_0xf1dd83,'language':_0xc76f82});}catch(_0x4f718b){console[_0x26c202(0xfa)](_0x4f718b);}}),router[a0_0x4fb3cd(0x106)](a0_0x4fb3cd(0x116),auth,async(_0x3fc96b,_0x7293c5)=>{const _0x542c49=a0_0x4fb3cd;try{const _0x2f8d53=_0x3fc96b[_0x542c49(0xd6)]['id'],_0x34b50b=await customer[_0x542c49(0x104)](_0x2f8d53),{name:_0xe8a04a,address:_0x39b07d,mobile:_0x2b8de3,email:_0x3f98f2,receivable:_0x3a4564,payable:_0x2f84dc,contactperson:_0x36103e,landline:_0x2526e3}=_0x3fc96b[_0x542c49(0x107)];_0x34b50b[_0x542c49(0xd9)]=_0xe8a04a,_0x34b50b[_0x542c49(0xed)]=_0x39b07d,_0x34b50b[_0x542c49(0x136)]=_0x2b8de3,_0x34b50b['email']=_0x3f98f2,_0x34b50b[_0x542c49(0xec)]=_0x3a4564,_0x34b50b[_0x542c49(0xe1)]=_0x2f84dc,_0x34b50b['contactperson']=_0x36103e,_0x34b50b[_0x542c49(0xf3)]=_0x2526e3;const _0x39943e=await _0x34b50b[_0x542c49(0x10e)]();_0x3fc96b[_0x542c49(0x119)](_0x542c49(0x11c),'customer\x20update\x20successfully'),_0x7293c5[_0x542c49(0x11e)](_0x542c49(0x109));}catch(_0x36667d){console['log'](_0x36667d);}}),router[a0_0x4fb3cd(0x10f)](a0_0x4fb3cd(0x128),auth,async(_0x225f78,_0x2ad054)=>{const _0x2e4180=a0_0x4fb3cd;try{const {username:_0x82a0c2,email:_0xb6ce3e,role:_0x8fa000}=_0x225f78[_0x2e4180(0xf7)],_0x355768=_0x225f78[_0x2e4180(0xf7)],_0x4f0abe=await profile[_0x2e4180(0xe3)]({'email':_0x355768[_0x2e4180(0xf2)]}),_0x4279e5=await master_shop['find']();console[_0x2e4180(0xfa)]('master',_0x4279e5),console['log'](_0x225f78[_0x2e4180(0xd6)]['id']);const _0x201408=await customer[_0x2e4180(0xe3)]({'_id':_0x225f78[_0x2e4180(0xd6)]['id']});console[_0x2e4180(0xfa)]('customer_data',_0x201408);const _0x2ef0c8=await c_payment_data[_0x2e4180(0xd7)]({'customer':_0x201408[_0x2e4180(0xd9)]});console[_0x2e4180(0xfa)](_0x2ef0c8);const _0x26c250=await c_payment_data['aggregate']([{'$match':{'customer':_0x201408[_0x2e4180(0xd9)]}},{'$match':{'reason':_0x2e4180(0xeb)}},{'$group':{'_id':_0x2e4180(0xf8),'sum':{'$sum':_0x2e4180(0x113)}}}]);console[_0x2e4180(0xfa)](_0x2e4180(0xd4),_0x26c250);const _0x3e8159=await c_payment_data[_0x2e4180(0x12c)]([{'$match':{'customer':_0x201408[_0x2e4180(0xd9)]}},{'$match':{'reason':_0x2e4180(0xe0)}},{'$group':{'_id':_0x2e4180(0xf8),'sum':{'$sum':_0x2e4180(0x113)}}}]);console['log'](_0x2e4180(0x108),_0x3e8159);if(_0x4279e5[0x0][_0x2e4180(0xe7)]==_0x2e4180(0x115)){var _0x1cd245=users[_0x2e4180(0x12b)];console['log'](_0x1cd245);}else{if(_0x4279e5[0x0][_0x2e4180(0xe7)]==_0x2e4180(0xe4))var _0x1cd245=users['Hindi'];else{if(_0x4279e5[0x0]['language']==_0x2e4180(0xde))var _0x1cd245=users[_0x2e4180(0xde)];else{if(_0x4279e5[0x0][_0x2e4180(0xe7)]==_0x2e4180(0xe9))var _0x1cd245=users[_0x2e4180(0xe9)];else{if(_0x4279e5[0x0][_0x2e4180(0xe7)]=='French')var _0x1cd245=users[_0x2e4180(0xf6)];else{if(_0x4279e5[0x0][_0x2e4180(0xe7)]=='Portuguese\x20(BR)')var _0x1cd245=users[_0x2e4180(0x11a)];else{if(_0x4279e5[0x0][_0x2e4180(0xe7)]==_0x2e4180(0x10c))var _0x1cd245=users['Chinese'];else{if(_0x4279e5[0x0]['language']==_0x2e4180(0xd1))var _0x1cd245=users[_0x2e4180(0xdc)];}}}}}}}_0x2ad054['render'](_0x2e4180(0x125),{'success':_0x225f78[_0x2e4180(0x119)](_0x2e4180(0x11c)),'errors':_0x225f78['flash'](_0x2e4180(0x124)),'role':_0x355768,'profile':_0x4f0abe,'payment':_0x2ef0c8,'payable':_0x26c250,'receivable':_0x3e8159,'master_shop':_0x4279e5,'language':_0x1cd245});}catch(_0xa6f5b4){console[_0x2e4180(0xfa)](_0xa6f5b4);}}),router[a0_0x4fb3cd(0x10f)]('/products_export_migrate_file',auth,async(_0x20a647,_0x107e60)=>{const _0x5843b6=a0_0x4fb3cd;try{const _0x31af01=new excelJS[(_0x5843b6(0xfc))](),_0x486542=_0x31af01[_0x5843b6(0x100)](_0x5843b6(0xda));return _0x486542[_0x5843b6(0x132)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x5843b6(0x122),'key':_0x5843b6(0xe5),'width':0xa},{'header':_0x5843b6(0xe2),'key':_0x5843b6(0xdd),'width':0xa},{'header':_0x5843b6(0x130),'key':_0x5843b6(0x130),'width':0xa},{'header':_0x5843b6(0xed),'key':_0x5843b6(0xed),'width':0xa},{'header':_0x5843b6(0x136),'key':'mobile','width':0xa},{'header':'email','key':_0x5843b6(0xf2),'width':0xa}],_0x107e60[_0x5843b6(0x10d)](_0x5843b6(0x111),_0x5843b6(0xd8)),_0x107e60['setHeader'](_0x5843b6(0x120),_0x5843b6(0xea)),_0x31af01[_0x5843b6(0x110)][_0x5843b6(0x11b)](_0x107e60)['then'](()=>{const _0x381b9e=_0x5843b6;_0x107e60[_0x381b9e(0xd5)](0xc8);});}catch(_0x101f6c){_0x107e60[_0x5843b6(0xd5)](0x190)[_0x5843b6(0xd3)]({'errors':_0x101f6c['message']});}});function a0_0x55b4(){const _0x19c7bb=['payable_sum','status','params','find','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','name','Customers','/customer_import_migrate_file','Arabic','PUnits','German','\x20Failed','Sale\x20Return','payable','SalesmanCode','findOne','Hindi','PBrands','public/Migration','language','26286NGezMR','Spanish','attachment;\x20filename=customer_Migration_File.xlsx','Sale','receivable','address','3010105wflFCO','301554tsHvyD','exceljs','public/Migration/','email','landline','reason','4002432mPixGR','French','user','$reason','payment_data','log','sheet_to_json','Workbook','\x20added\x20successfully','1195hVFWjY','utils','addWorksheet','../public/language/languages.json','936ynJqIL','render','findById','../models/all_models','post','body','receivable_sum','/customer/view','json','/view','Chinese','setHeader','save','get','xlsx','Content-Type','sale','$amount','single','English\x20(US)','/view/:id','readFile','1dNzfYR','flash','Portuguese','write','success','91816QeFqOQ','redirect','customer_product_fule','Content-Disposition','customer','Name','forEach','errors','customer_payment','customer_docs','multer','/view/payment/:id','master','3571227RYgPtk','English','aggregate','sale_return','../middleware/auth','error','SalesmanName','Portuguese\x20(BR)','columns','90HnHFba','data','SheetNames','mobile','1947915WEzGNa','express','exports','Arabic\x20(ae)','map','send'];a0_0x55b4=function(){return _0x19c7bb;};return a0_0x55b4();}const storage1=multer['diskStorage']({'destination':(_0x5d2fda,_0x2ef154,_0x40af11)=>{const _0x5d1fd8=a0_0x4fb3cd;_0x40af11(null,_0x5d1fd8(0xe6));},'filename':(_0x5781ca,_0xe6d003,_0x371a79)=>{_0x371a79(null,Date['now']()+_0xe6d003['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x4fb3cd(0x106)](a0_0x4fb3cd(0xdb),auth,uploadMigrate[a0_0x4fb3cd(0x114)](a0_0x4fb3cd(0x11f)),async(_0x5a9cc0,_0xebb0d)=>{const _0x539277=a0_0x4fb3cd,_0x3c046c=_0x5a9cc0['file']['filename'],_0x1ccdba=await xlsx[_0x539277(0x117)](_0x539277(0xf1)+_0x3c046c);let _0x53a64d=_0x1ccdba[_0x539277(0x135)],_0x58dd6e=xlsx[_0x539277(0xff)][_0x539277(0xfb)](_0x1ccdba['Sheets'][_0x53a64d[0x0]]);for(const _0x16f4ec of _0x58dd6e){const _0x5db1df=_0x16f4ec['ID'],_0x267011=_0x16f4ec['Name'],_0x884a62=_0x16f4ec['SalesmanCode'],_0xf3fa0f=_0x16f4ec[_0x539277(0x130)],_0x75e80a=_0x16f4ec[_0x539277(0xed)],_0xa3f16c=_0x16f4ec[_0x539277(0x136)],_0x2e35ab=_0x16f4ec[_0x539277(0xf2)];try{let _0x386fb1=await customer[_0x539277(0xe3)]({'name':_0x267011});if(!_0x386fb1){const _0x820912=new customer({'name':_0x267011,'ID':_0x5db1df,'SalesmanCode':_0x884a62,'SalesmanName':_0xf3fa0f,'address':_0x75e80a,'mobile':_0xa3f16c,'email':_0x2e35ab});_0x386fb1=await _0x820912[_0x539277(0x10e)](),_0x5a9cc0[_0x539277(0x119)](_0x539277(0x11c),_0x267011+_0x539277(0xfd));}else _0x5a9cc0[_0x539277(0x119)](_0x539277(0x12f),_0x267011+_0x539277(0xdf));}catch(_0x321f85){_0xebb0d['status'](0x1f4)[_0x539277(0x10a)]({'proderror':_0x321f85['message'],'aproduct':ProductName});}}_0xebb0d[_0x539277(0x11e)](_0x539277(0x109));}),module[a0_0x4fb3cd(0xd0)]=router;