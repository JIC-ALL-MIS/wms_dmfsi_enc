function a0_0x2c8f(){const _0x35d92f=['body','Arabic\x20(ae)','Hindi','/customer/view','errors','findById','error','success','payable_sum','2171380CVJjck','reason','exports','SalesmanName','../models/all_models','columns','forEach','Sale','exceljs','find','$amount','\x20Failed','Content-Type','7445185jBhazj','originalname','log','customer\x20add\x20successfully','486390zlbfMc','attachment;\x20filename=customer_Migration_File.xlsx','message','mobile','element','German','aggregate','6lgwJwD','English','/view/:id','multer','filename','json','customer_payment','customer_product_fule','18040uhfhHm','Portuguese','/products_export_migrate_file','xlsx','../public/language/languages.json','Arabic','map','Chinese','Spanish','save','post','address','Workbook','get','payment_data','then','now','French','/customer_import_migrate_file','amount','payable','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','utils','language','Name','1107SpJrpX','SheetNames','email','public/Migration/','readFile','diskStorage','/view/payment/:id','PBrands','1437065cSMwSF','flash','master','render','express','receivable','/view','findOne','141WUGYxd','user','9832qBmtiN','name','redirect','customer','English\x20(US)','Router','Sheets','$reason','../middleware/auth','Portuguese\x20(BR)','\x20added\x20successfully','411307OKvKFY','10PdDrbC','PUnits','file','params','receivable_sum','setHeader','sheet_to_json','landline','customer\x20update\x20successfully','customer_docs','addWorksheet','data'];a0_0x2c8f=function(){return _0x35d92f;};return a0_0x2c8f();}const a0_0x544a66=a0_0x5a23;function a0_0x5a23(_0x429b7b,_0x4e9c3c){const _0x2c8f6b=a0_0x2c8f();return a0_0x5a23=function(_0x5a2314,_0x4c7c66){_0x5a2314=_0x5a2314-0xa1;let _0x1b7acc=_0x2c8f6b[_0x5a2314];return _0x1b7acc;},a0_0x5a23(_0x429b7b,_0x4e9c3c);}(function(_0x168e78,_0x10bde3){const _0x28f77d=a0_0x5a23,_0x3e4d8b=_0x168e78();while(!![]){try{const _0xbb3d1e=parseInt(_0x28f77d(0xe4))/0x1+-parseInt(_0x28f77d(0x10b))/0x2+-parseInt(_0x28f77d(0xd7))/0x3*(parseInt(_0x28f77d(0xae))/0x4)+-parseInt(_0x28f77d(0xfa))/0x5*(parseInt(_0x28f77d(0xa6))/0x6)+parseInt(_0x28f77d(0xcf))/0x7+parseInt(_0x28f77d(0xd9))/0x8*(-parseInt(_0x28f77d(0xc7))/0x9)+-parseInt(_0x28f77d(0xe5))/0xa*(-parseInt(_0x28f77d(0x107))/0xb);if(_0xbb3d1e===_0x10bde3)break;else _0x3e4d8b['push'](_0x3e4d8b['shift']());}catch(_0x45757c){_0x3e4d8b['push'](_0x3e4d8b['shift']());}}}(a0_0x2c8f,0x3db9d));const express=require(a0_0x544a66(0xd3)),app=express(),router=express[a0_0x544a66(0xde)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x544a66(0xfe)),auth=require(a0_0x544a66(0xe1)),users=require(a0_0x544a66(0xb2)),excelJS=require(a0_0x544a66(0x102)),xlsx=require(a0_0x544a66(0xb1)),multer=require(a0_0x544a66(0xa9));router['get'](a0_0x544a66(0xd5),auth,async(_0x16e055,_0x2f0e50)=>{const _0x103b64=a0_0x544a66;try{const {username:_0x10e572,email:_0x57fa9c,role:_0xfad11c}=_0x16e055[_0x103b64(0xd8)],_0x296edd=_0x16e055[_0x103b64(0xd8)],_0xe7fcf8=await profile[_0x103b64(0xd6)]({'email':_0x296edd[_0x103b64(0xc9)]}),_0x119e75=await master_shop[_0x103b64(0x103)]();console[_0x103b64(0x109)](_0x103b64(0xd1),_0x119e75);const _0x4a8385=await customer[_0x103b64(0x103)](),_0x4ce8b8=await customer[_0x103b64(0xa5)]([{'$lookup':{'from':'c_payments','localField':'name','foreignField':_0x103b64(0xdc),'as':_0x103b64(0xee)}}]);console[_0x103b64(0x109)](_0x4ce8b8);const _0x3e240b=_0x4ce8b8[_0x103b64(0xb4)](_0x4da4ec=>{const _0x439d8e=_0x103b64;console[_0x439d8e(0x109)](_0x439d8e(0xf0),_0x4da4ec);var _0x1cfe5f=0x0,_0x29e6a4=0x0;return _0x4da4ec[_0x439d8e(0xee)][_0x439d8e(0x100)](_0x1bd8a4=>{const _0x3ce2fd=_0x439d8e;console[_0x3ce2fd(0x109)](_0x3ce2fd(0xa3),_0x1bd8a4),_0x1bd8a4[_0x3ce2fd(0xfb)]==_0x3ce2fd(0x101)?_0x1cfe5f+=_0x1bd8a4[_0x3ce2fd(0xc1)]:_0x29e6a4+=_0x1bd8a4['amount'];}),_0x4da4ec['sale']=parseFloat(_0x1cfe5f)+0x0,_0x4da4ec['sale_return']=parseFloat(_0x29e6a4)+0x0,_0x4da4ec;});console[_0x103b64(0x109)](_0x103b64(0xbc),_0x3e240b);if(_0x119e75[0x0]['language']=='English\x20(US)'){var _0x2bc070=users[_0x103b64(0xa7)];console['log'](_0x2bc070);}else{if(_0x119e75[0x0][_0x103b64(0xc5)]==_0x103b64(0xf3))var _0x2bc070=users['Hindi'];else{if(_0x119e75[0x0]['language']==_0x103b64(0xa4))var _0x2bc070=users[_0x103b64(0xa4)];else{if(_0x119e75[0x0][_0x103b64(0xc5)]==_0x103b64(0xb6))var _0x2bc070=users[_0x103b64(0xb6)];else{if(_0x119e75[0x0][_0x103b64(0xc5)]==_0x103b64(0xbf))var _0x2bc070=users[_0x103b64(0xbf)];else{if(_0x119e75[0x0][_0x103b64(0xc5)]==_0x103b64(0xe2))var _0x2bc070=users[_0x103b64(0xaf)];else{if(_0x119e75[0x0][_0x103b64(0xc5)]==_0x103b64(0xb5))var _0x2bc070=users[_0x103b64(0xb5)];else{if(_0x119e75[0x0][_0x103b64(0xc5)]==_0x103b64(0xf2))var _0x2bc070=users[_0x103b64(0xb3)];}}}}}}}_0x2f0e50[_0x103b64(0xd2)](_0x103b64(0xdc),{'success':_0x16e055['flash'](_0x103b64(0xf8)),'errors':_0x16e055[_0x103b64(0xd0)](_0x103b64(0xf5)),'user':_0x4a8385,'role':_0x296edd,'profile':_0xe7fcf8,'payment':_0x3e240b,'master_shop':_0x119e75,'language':_0x2bc070});}catch(_0x3e0637){console[_0x103b64(0x109)](_0x3e0637);}}),router['post'](a0_0x544a66(0xd5),auth,async(_0x3096b8,_0x21a5c0)=>{const _0x3d0e4c=a0_0x544a66;try{const {name:_0xddd0b9,address:_0x57ffaf,mobile:_0x13a31c,email:_0x52f928,receivable:_0x10c442,payable:_0x5a9285,contactperson:_0x5cd373,landline:_0x14f403}=_0x3096b8[_0x3d0e4c(0xf1)],_0x22171b=new customer({'name':_0xddd0b9,'address':_0x57ffaf,'mobile':_0x13a31c,'email':_0x52f928,'receivable':_0x10c442,'payable':_0x5a9285,'contactperson':_0x5cd373,'landline':_0x14f403}),_0x232959=await _0x22171b[_0x3d0e4c(0xb7)]();_0x3096b8[_0x3d0e4c(0xd0)](_0x3d0e4c(0xf8),_0x3d0e4c(0x10a)),_0x21a5c0[_0x3d0e4c(0xdb)](_0x3d0e4c(0xf4));}catch(_0x287b3c){console[_0x3d0e4c(0x109)](_0x287b3c);}}),router[a0_0x544a66(0xbb)](a0_0x544a66(0xa8),auth,async(_0x3e9efc,_0x2c59fa)=>{const _0x21ad55=a0_0x544a66;try{const {username:_0x1183b7,email:_0x3a7181,role:_0x49609b}=_0x3e9efc[_0x21ad55(0xd8)],_0x109164=_0x3e9efc[_0x21ad55(0xd8)],_0x330705=await profile[_0x21ad55(0xd6)]({'email':_0x109164[_0x21ad55(0xc9)]}),_0x202833=await master_shop['find']();console['log'](_0x21ad55(0xd1),_0x202833);const _0x289144=_0x3e9efc['params']['id'],_0x265a85=await customer[_0x21ad55(0xf6)](_0x289144);if(_0x202833[0x0][_0x21ad55(0xc5)]=='English\x20(US)'){var _0x5afe38=users['English'];console[_0x21ad55(0x109)](_0x5afe38);}else{if(_0x202833[0x0][_0x21ad55(0xc5)]==_0x21ad55(0xf3))var _0x5afe38=users[_0x21ad55(0xf3)];else{if(_0x202833[0x0][_0x21ad55(0xc5)]==_0x21ad55(0xa4))var _0x5afe38=users[_0x21ad55(0xa4)];else{if(_0x202833[0x0][_0x21ad55(0xc5)]=='Spanish')var _0x5afe38=users[_0x21ad55(0xb6)];else{if(_0x202833[0x0][_0x21ad55(0xc5)]==_0x21ad55(0xbf))var _0x5afe38=users[_0x21ad55(0xbf)];else{if(_0x202833[0x0]['language']==_0x21ad55(0xe2))var _0x5afe38=users[_0x21ad55(0xaf)];else{if(_0x202833[0x0][_0x21ad55(0xc5)]==_0x21ad55(0xb5))var _0x5afe38=users[_0x21ad55(0xb5)];else{if(_0x202833[0x0]['language']==_0x21ad55(0xf2))var _0x5afe38=users['Arabic'];}}}}}}}_0x2c59fa[_0x21ad55(0xd2)](_0x21ad55(0xdc),{'success':_0x3e9efc[_0x21ad55(0xd0)](_0x21ad55(0xf8)),'errors':_0x3e9efc[_0x21ad55(0xd0)]('errors'),'role':_0x109164,'profile':_0x330705,'user':_0x265a85,'master_shop':_0x202833,'language':_0x5afe38});}catch(_0x4f0be0){console['log'](_0x4f0be0);}}),router[a0_0x544a66(0xb8)]('/view/:id',auth,async(_0xb2d754,_0x32afa7)=>{const _0x2de9a3=a0_0x544a66;try{const _0xdaff0e=_0xb2d754[_0x2de9a3(0xe8)]['id'],_0xe982f3=await customer[_0x2de9a3(0xf6)](_0xdaff0e),{name:_0x517d19,address:_0x1bcd4e,mobile:_0x1e5b04,email:_0x40ea11,receivable:_0x248645,payable:_0x331384,contactperson:_0x18509c,landline:_0x2d400f}=_0xb2d754['body'];_0xe982f3['name']=_0x517d19,_0xe982f3[_0x2de9a3(0xb9)]=_0x1bcd4e,_0xe982f3['mobile']=_0x1e5b04,_0xe982f3[_0x2de9a3(0xc9)]=_0x40ea11,_0xe982f3[_0x2de9a3(0xd4)]=_0x248645,_0xe982f3[_0x2de9a3(0xc2)]=_0x331384,_0xe982f3['contactperson']=_0x18509c,_0xe982f3[_0x2de9a3(0xec)]=_0x2d400f;const _0x446cf8=await _0xe982f3['save']();_0xb2d754[_0x2de9a3(0xd0)](_0x2de9a3(0xf8),_0x2de9a3(0xed)),_0x32afa7['redirect'](_0x2de9a3(0xf4));}catch(_0x5101cd){console[_0x2de9a3(0x109)](_0x5101cd);}}),router[a0_0x544a66(0xbb)](a0_0x544a66(0xcd),auth,async(_0x398320,_0x4fc9a4)=>{const _0x369b2a=a0_0x544a66;try{const {username:_0x415406,email:_0x31d9d7,role:_0x14e58a}=_0x398320[_0x369b2a(0xd8)],_0x53861e=_0x398320[_0x369b2a(0xd8)],_0x39e03e=await profile[_0x369b2a(0xd6)]({'email':_0x53861e['email']}),_0x526cef=await master_shop[_0x369b2a(0x103)]();console[_0x369b2a(0x109)]('master',_0x526cef),console['log'](_0x398320['params']['id']);const _0x189731=await customer[_0x369b2a(0xd6)]({'_id':_0x398320[_0x369b2a(0xe8)]['id']});console['log']('customer_data',_0x189731);const _0xf42d1d=await c_payment_data[_0x369b2a(0x103)]({'customer':_0x189731[_0x369b2a(0xda)]});console[_0x369b2a(0x109)](_0xf42d1d);const _0x15f726=await c_payment_data[_0x369b2a(0xa5)]([{'$match':{'customer':_0x189731[_0x369b2a(0xda)]}},{'$match':{'reason':_0x369b2a(0x101)}},{'$group':{'_id':_0x369b2a(0xe0),'sum':{'$sum':'$amount'}}}]);console['log'](_0x369b2a(0xf9),_0x15f726);const _0x282dfd=await c_payment_data[_0x369b2a(0xa5)]([{'$match':{'customer':_0x189731[_0x369b2a(0xda)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x369b2a(0x104)}}}]);console[_0x369b2a(0x109)](_0x369b2a(0xe9),_0x282dfd);if(_0x526cef[0x0][_0x369b2a(0xc5)]==_0x369b2a(0xdd)){var _0x58d7f1=users[_0x369b2a(0xa7)];console[_0x369b2a(0x109)](_0x58d7f1);}else{if(_0x526cef[0x0]['language']==_0x369b2a(0xf3))var _0x58d7f1=users[_0x369b2a(0xf3)];else{if(_0x526cef[0x0][_0x369b2a(0xc5)]==_0x369b2a(0xa4))var _0x58d7f1=users[_0x369b2a(0xa4)];else{if(_0x526cef[0x0][_0x369b2a(0xc5)]=='Spanish')var _0x58d7f1=users[_0x369b2a(0xb6)];else{if(_0x526cef[0x0][_0x369b2a(0xc5)]==_0x369b2a(0xbf))var _0x58d7f1=users['French'];else{if(_0x526cef[0x0][_0x369b2a(0xc5)]=='Portuguese\x20(BR)')var _0x58d7f1=users['Portuguese'];else{if(_0x526cef[0x0]['language']==_0x369b2a(0xb5))var _0x58d7f1=users[_0x369b2a(0xb5)];else{if(_0x526cef[0x0][_0x369b2a(0xc5)]==_0x369b2a(0xf2))var _0x58d7f1=users[_0x369b2a(0xb3)];}}}}}}}_0x4fc9a4['render'](_0x369b2a(0xac),{'success':_0x398320[_0x369b2a(0xd0)](_0x369b2a(0xf8)),'errors':_0x398320[_0x369b2a(0xd0)](_0x369b2a(0xf5)),'role':_0x53861e,'profile':_0x39e03e,'payment':_0xf42d1d,'payable':_0x15f726,'receivable':_0x282dfd,'master_shop':_0x526cef,'language':_0x58d7f1});}catch(_0x49de47){console['log'](_0x49de47);}}),router[a0_0x544a66(0xbb)](a0_0x544a66(0xb0),auth,async(_0x2ace01,_0x5854fc)=>{const _0x58b07b=a0_0x544a66;try{const _0x23f693=new excelJS[(_0x58b07b(0xba))](),_0x47d2f0=_0x23f693[_0x58b07b(0xef)]('Customers');return _0x47d2f0[_0x58b07b(0xff)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x58b07b(0xc6),'key':_0x58b07b(0xce),'width':0xa},{'header':'SalesmanCode','key':_0x58b07b(0xe6),'width':0xa},{'header':_0x58b07b(0xfd),'key':_0x58b07b(0xfd),'width':0xa},{'header':'address','key':_0x58b07b(0xb9),'width':0xa},{'header':'mobile','key':_0x58b07b(0xa2),'width':0xa},{'header':_0x58b07b(0xc9),'key':'email','width':0xa}],_0x5854fc[_0x58b07b(0xea)](_0x58b07b(0x106),_0x58b07b(0xc3)),_0x5854fc[_0x58b07b(0xea)]('Content-Disposition',_0x58b07b(0x10c)),_0x23f693[_0x58b07b(0xb1)]['write'](_0x5854fc)[_0x58b07b(0xbd)](()=>{_0x5854fc['status'](0xc8);});}catch(_0x5a75b8){_0x5854fc['status'](0x190)['send']({'errors':_0x5a75b8['message']});}});const storage1=multer[a0_0x544a66(0xcc)]({'destination':(_0x487f12,_0x2955b9,_0xeeecd8)=>{_0xeeecd8(null,'public/Migration');},'filename':(_0x185e48,_0x2f9e15,_0x1b3772)=>{const _0x407086=a0_0x544a66;_0x1b3772(null,Date[_0x407086(0xbe)]()+_0x2f9e15[_0x407086(0x108)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x544a66(0xc0),auth,uploadMigrate['single'](a0_0x544a66(0xad)),async(_0x5ceead,_0x56dfd3)=>{const _0x4be904=a0_0x544a66,_0x25649c=_0x5ceead[_0x4be904(0xe7)][_0x4be904(0xaa)],_0x472a32=await xlsx[_0x4be904(0xcb)](_0x4be904(0xca)+_0x25649c);let _0x26ab15=_0x472a32[_0x4be904(0xc8)],_0x4d515c=xlsx[_0x4be904(0xc4)][_0x4be904(0xeb)](_0x472a32[_0x4be904(0xdf)][_0x26ab15[0x0]]);for(const _0x4c34e7 of _0x4d515c){const _0x5c7e65=_0x4c34e7['ID'],_0x14010a=_0x4c34e7[_0x4be904(0xc6)],_0x189fac=_0x4c34e7['SalesmanCode'],_0x6d7b1c=_0x4c34e7[_0x4be904(0xfd)],_0x2a8fd6=_0x4c34e7[_0x4be904(0xb9)],_0x2bb177=_0x4c34e7[_0x4be904(0xa2)],_0x5bf221=_0x4c34e7['email'];try{let _0x197943=await customer['findOne']({'name':_0x14010a});if(!_0x197943){const _0x5d8f75=new customer({'name':_0x14010a,'ID':_0x5c7e65,'SalesmanCode':_0x189fac,'SalesmanName':_0x6d7b1c,'address':_0x2a8fd6,'mobile':_0x2bb177,'email':_0x5bf221});_0x197943=await _0x5d8f75[_0x4be904(0xb7)](),_0x5ceead[_0x4be904(0xd0)](_0x4be904(0xf8),_0x14010a+_0x4be904(0xe3));}else _0x5ceead[_0x4be904(0xd0)](_0x4be904(0xf7),_0x14010a+_0x4be904(0x105));}catch(_0x1915ae){_0x56dfd3['status'](0x1f4)[_0x4be904(0xab)]({'proderror':_0x1915ae[_0x4be904(0xa1)],'aproduct':ProductName});}}_0x56dfd3[_0x4be904(0xdb)](_0x4be904(0xf4));}),module[a0_0x544a66(0xfc)]=router;