const a0_0x3c0d33=a0_0x3d60;function a0_0x3d60(_0x5af78d,_0x439dab){const _0x229e98=a0_0x229e();return a0_0x3d60=function(_0x3d6032,_0x3cb476){_0x3d6032=_0x3d6032-0x1b7;let _0x36694a=_0x229e98[_0x3d6032];return _0x36694a;},a0_0x3d60(_0x5af78d,_0x439dab);}(function(_0x3fa0e0,_0x2ba109){const _0x4f8bda=a0_0x3d60,_0x50560c=_0x3fa0e0();while(!![]){try{const _0xb0437e=parseInt(_0x4f8bda(0x21d))/0x1*(parseInt(_0x4f8bda(0x1c9))/0x2)+parseInt(_0x4f8bda(0x215))/0x3+-parseInt(_0x4f8bda(0x1c3))/0x4*(-parseInt(_0x4f8bda(0x210))/0x5)+-parseInt(_0x4f8bda(0x1e3))/0x6+parseInt(_0x4f8bda(0x1e5))/0x7+-parseInt(_0x4f8bda(0x213))/0x8*(-parseInt(_0x4f8bda(0x1c4))/0x9)+-parseInt(_0x4f8bda(0x1f4))/0xa;if(_0xb0437e===_0x2ba109)break;else _0x50560c['push'](_0x50560c['shift']());}catch(_0x4c27e5){_0x50560c['push'](_0x50560c['shift']());}}}(a0_0x229e,0xa382a));const express=require(a0_0x3c0d33(0x20f)),app=express(),router=express[a0_0x3c0d33(0x1fc)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x3c0d33(0x21b)),auth=require(a0_0x3c0d33(0x1fb)),users=require(a0_0x3c0d33(0x214)),excelJS=require('exceljs'),xlsx=require(a0_0x3c0d33(0x1d3)),multer=require(a0_0x3c0d33(0x1de));router[a0_0x3c0d33(0x208)](a0_0x3c0d33(0x218),auth,async(_0x3c205c,_0x4a088f)=>{const _0x1b34f1=a0_0x3c0d33;try{const {username:_0x4e77cb,email:_0x541da3,role:_0x2915ec}=_0x3c205c[_0x1b34f1(0x20c)],_0x2f289a=_0x3c205c[_0x1b34f1(0x20c)],_0x4587d1=await profile['findOne']({'email':_0x2f289a[_0x1b34f1(0x1fa)]}),_0x5d8125=await master_shop[_0x1b34f1(0x1c1)]();console[_0x1b34f1(0x1c6)](_0x1b34f1(0x1e4),_0x5d8125);const _0x5ed832=await customer[_0x1b34f1(0x1c1)](),_0x1b7e88=await customer['aggregate']([{'$lookup':{'from':_0x1b34f1(0x216),'localField':_0x1b34f1(0x1d2),'foreignField':_0x1b34f1(0x1d0),'as':_0x1b34f1(0x202)}}]);console[_0x1b34f1(0x1c6)](_0x1b7e88);const _0x6fb42b=_0x1b7e88['map'](_0x5c6169=>{const _0x763a4e=_0x1b34f1;console['log']('data',_0x5c6169);var _0x3cc5f4=0x0,_0x407af5=0x0;return _0x5c6169[_0x763a4e(0x202)][_0x763a4e(0x20e)](_0x5ae8ef=>{const _0x531326=_0x763a4e;console[_0x531326(0x1c6)]('element',_0x5ae8ef),_0x5ae8ef[_0x531326(0x1e0)]==_0x531326(0x1ec)?_0x3cc5f4+=_0x5ae8ef[_0x531326(0x1d5)]:_0x407af5+=_0x5ae8ef[_0x531326(0x1d5)];}),_0x5c6169[_0x763a4e(0x1db)]=parseFloat(_0x3cc5f4)+0x0,_0x5c6169[_0x763a4e(0x1b9)]=parseFloat(_0x407af5)+0x0,_0x5c6169;});console[_0x1b34f1(0x1c6)](_0x1b34f1(0x20b),_0x6fb42b);if(_0x5d8125[0x0]['language']==_0x1b34f1(0x1d8)){var _0x106851=users[_0x1b34f1(0x219)];console[_0x1b34f1(0x1c6)](_0x106851);}else{if(_0x5d8125[0x0][_0x1b34f1(0x1ea)]==_0x1b34f1(0x205))var _0x106851=users[_0x1b34f1(0x205)];else{if(_0x5d8125[0x0][_0x1b34f1(0x1ea)]==_0x1b34f1(0x217))var _0x106851=users['German'];else{if(_0x5d8125[0x0]['language']=='Spanish')var _0x106851=users[_0x1b34f1(0x1ca)];else{if(_0x5d8125[0x0][_0x1b34f1(0x1ea)]==_0x1b34f1(0x1d9))var _0x106851=users[_0x1b34f1(0x1d9)];else{if(_0x5d8125[0x0]['language']=='Portuguese\x20(BR)')var _0x106851=users[_0x1b34f1(0x1e6)];else{if(_0x5d8125[0x0]['language']==_0x1b34f1(0x1f5))var _0x106851=users[_0x1b34f1(0x1f5)];else{if(_0x5d8125[0x0][_0x1b34f1(0x1ea)]==_0x1b34f1(0x201))var _0x106851=users[_0x1b34f1(0x1e9)];}}}}}}}_0x4a088f['render'](_0x1b34f1(0x1d0),{'success':_0x3c205c[_0x1b34f1(0x1d6)](_0x1b34f1(0x1c2)),'errors':_0x3c205c[_0x1b34f1(0x1d6)](_0x1b34f1(0x1cc)),'user':_0x5ed832,'role':_0x2f289a,'profile':_0x4587d1,'payment':_0x6fb42b,'master_shop':_0x5d8125,'language':_0x106851});}catch(_0x35b1ee){console[_0x1b34f1(0x1c6)](_0x35b1ee);}}),router[a0_0x3c0d33(0x212)](a0_0x3c0d33(0x218),auth,async(_0x366b4a,_0x8dbc6e)=>{const _0x25a162=a0_0x3c0d33;try{const {name:_0x5491bf,address:_0x2b5735,mobile:_0x504452,email:_0x4da884,receivable:_0x358d9f,payable:_0x55bdc1,contactperson:_0x2ab34c,landline:_0xc24a62}=_0x366b4a[_0x25a162(0x20d)],_0x16badb=new customer({'name':_0x5491bf,'address':_0x2b5735,'mobile':_0x504452,'email':_0x4da884,'receivable':_0x358d9f,'payable':_0x55bdc1,'contactperson':_0x2ab34c,'landline':_0xc24a62}),_0x5ee932=await _0x16badb['save']();_0x366b4a[_0x25a162(0x1d6)](_0x25a162(0x1c2),_0x25a162(0x1e8)),_0x8dbc6e[_0x25a162(0x1bb)](_0x25a162(0x21a));}catch(_0x52f4df){console[_0x25a162(0x1c6)](_0x52f4df);}}),router[a0_0x3c0d33(0x208)](a0_0x3c0d33(0x1ef),auth,async(_0x14c55b,_0x6f1d94)=>{const _0x46601c=a0_0x3c0d33;try{const {username:_0x52b53f,email:_0x3e28c6,role:_0x4648d9}=_0x14c55b[_0x46601c(0x20c)],_0x135386=_0x14c55b[_0x46601c(0x20c)],_0x5e5b26=await profile[_0x46601c(0x1e7)]({'email':_0x135386[_0x46601c(0x1fa)]}),_0x2c7d9=await master_shop[_0x46601c(0x1c1)]();console['log'](_0x46601c(0x1e4),_0x2c7d9);const _0x5f2462=_0x14c55b[_0x46601c(0x1dc)]['id'],_0x56c8d0=await customer[_0x46601c(0x1fe)](_0x5f2462);if(_0x2c7d9[0x0][_0x46601c(0x1ea)]=='English\x20(US)'){var _0x5d29e6=users['English'];console[_0x46601c(0x1c6)](_0x5d29e6);}else{if(_0x2c7d9[0x0][_0x46601c(0x1ea)]=='Hindi')var _0x5d29e6=users[_0x46601c(0x205)];else{if(_0x2c7d9[0x0]['language']==_0x46601c(0x217))var _0x5d29e6=users[_0x46601c(0x217)];else{if(_0x2c7d9[0x0][_0x46601c(0x1ea)]==_0x46601c(0x1ca))var _0x5d29e6=users[_0x46601c(0x1ca)];else{if(_0x2c7d9[0x0]['language']==_0x46601c(0x1d9))var _0x5d29e6=users[_0x46601c(0x1d9)];else{if(_0x2c7d9[0x0][_0x46601c(0x1ea)]==_0x46601c(0x1be))var _0x5d29e6=users[_0x46601c(0x1e6)];else{if(_0x2c7d9[0x0][_0x46601c(0x1ea)]==_0x46601c(0x1f5))var _0x5d29e6=users[_0x46601c(0x1f5)];else{if(_0x2c7d9[0x0]['language']==_0x46601c(0x201))var _0x5d29e6=users['Arabic'];}}}}}}}_0x6f1d94['render']('customer',{'success':_0x14c55b['flash']('success'),'errors':_0x14c55b['flash']('errors'),'role':_0x135386,'profile':_0x5e5b26,'user':_0x56c8d0,'master_shop':_0x2c7d9,'language':_0x5d29e6});}catch(_0x28279a){console['log'](_0x28279a);}}),router['post']('/view/:id',auth,async(_0xa89270,_0x29722a)=>{const _0x1c6e1b=a0_0x3c0d33;try{const _0x56d321=_0xa89270[_0x1c6e1b(0x1dc)]['id'],_0x29e78e=await customer['findById'](_0x56d321),{name:_0x21abe8,address:_0x2cf1e1,mobile:_0x201db5,email:_0xa13ced,receivable:_0x3d8268,payable:_0x5781b5,contactperson:_0x3d2a71,landline:_0xb09911}=_0xa89270['body'];_0x29e78e[_0x1c6e1b(0x1d2)]=_0x21abe8,_0x29e78e[_0x1c6e1b(0x1f1)]=_0x2cf1e1,_0x29e78e[_0x1c6e1b(0x1d1)]=_0x201db5,_0x29e78e[_0x1c6e1b(0x1fa)]=_0xa13ced,_0x29e78e['receivable']=_0x3d8268,_0x29e78e[_0x1c6e1b(0x1f9)]=_0x5781b5,_0x29e78e[_0x1c6e1b(0x1cf)]=_0x3d2a71,_0x29e78e['landline']=_0xb09911;const _0x2ab13b=await _0x29e78e[_0x1c6e1b(0x206)]();_0xa89270['flash'](_0x1c6e1b(0x1c2),_0x1c6e1b(0x1f6)),_0x29722a['redirect']('/customer/view');}catch(_0x2f6f94){console[_0x1c6e1b(0x1c6)](_0x2f6f94);}}),router[a0_0x3c0d33(0x208)](a0_0x3c0d33(0x1c0),auth,async(_0x110474,_0x330a11)=>{const _0x2d2a8e=a0_0x3c0d33;try{const {username:_0x32aa25,email:_0xe10bfe,role:_0x1d09fe}=_0x110474[_0x2d2a8e(0x20c)],_0x30bdab=_0x110474[_0x2d2a8e(0x20c)],_0x532f43=await profile['findOne']({'email':_0x30bdab[_0x2d2a8e(0x1fa)]}),_0x1cbd9c=await master_shop[_0x2d2a8e(0x1c1)]();console[_0x2d2a8e(0x1c6)]('master',_0x1cbd9c),console[_0x2d2a8e(0x1c6)](_0x110474[_0x2d2a8e(0x1dc)]['id']);const _0x384915=await customer['findOne']({'_id':_0x110474['params']['id']});console[_0x2d2a8e(0x1c6)](_0x2d2a8e(0x203),_0x384915);const _0x5cca19=await c_payment_data['find']({'customer':_0x384915[_0x2d2a8e(0x1d2)]});console[_0x2d2a8e(0x1c6)](_0x5cca19);const _0xdb6854=await c_payment_data[_0x2d2a8e(0x21e)]([{'$match':{'customer':_0x384915[_0x2d2a8e(0x1d2)]}},{'$match':{'reason':_0x2d2a8e(0x1ec)}},{'$group':{'_id':_0x2d2a8e(0x1f3),'sum':{'$sum':_0x2d2a8e(0x1c7)}}}]);console[_0x2d2a8e(0x1c6)](_0x2d2a8e(0x1f7),_0xdb6854);const _0x45957f=await c_payment_data[_0x2d2a8e(0x21e)]([{'$match':{'customer':_0x384915[_0x2d2a8e(0x1d2)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x2d2a8e(0x1c7)}}}]);console[_0x2d2a8e(0x1c6)](_0x2d2a8e(0x1ce),_0x45957f);if(_0x1cbd9c[0x0][_0x2d2a8e(0x1ea)]==_0x2d2a8e(0x1d8)){var _0xaa6378=users[_0x2d2a8e(0x219)];console[_0x2d2a8e(0x1c6)](_0xaa6378);}else{if(_0x1cbd9c[0x0][_0x2d2a8e(0x1ea)]=='Hindi')var _0xaa6378=users[_0x2d2a8e(0x205)];else{if(_0x1cbd9c[0x0]['language']==_0x2d2a8e(0x217))var _0xaa6378=users[_0x2d2a8e(0x217)];else{if(_0x1cbd9c[0x0][_0x2d2a8e(0x1ea)]==_0x2d2a8e(0x1ca))var _0xaa6378=users[_0x2d2a8e(0x1ca)];else{if(_0x1cbd9c[0x0]['language']==_0x2d2a8e(0x1d9))var _0xaa6378=users[_0x2d2a8e(0x1d9)];else{if(_0x1cbd9c[0x0][_0x2d2a8e(0x1ea)]==_0x2d2a8e(0x1be))var _0xaa6378=users[_0x2d2a8e(0x1e6)];else{if(_0x1cbd9c[0x0][_0x2d2a8e(0x1ea)]==_0x2d2a8e(0x1f5))var _0xaa6378=users['Chinese'];else{if(_0x1cbd9c[0x0]['language']==_0x2d2a8e(0x201))var _0xaa6378=users[_0x2d2a8e(0x1e9)];}}}}}}}_0x330a11[_0x2d2a8e(0x1ee)](_0x2d2a8e(0x1c5),{'success':_0x110474[_0x2d2a8e(0x1d6)](_0x2d2a8e(0x1c2)),'errors':_0x110474[_0x2d2a8e(0x1d6)](_0x2d2a8e(0x1cc)),'role':_0x30bdab,'profile':_0x532f43,'payment':_0x5cca19,'payable':_0xdb6854,'receivable':_0x45957f,'master_shop':_0x1cbd9c,'language':_0xaa6378});}catch(_0x41d60b){console['log'](_0x41d60b);}}),router[a0_0x3c0d33(0x208)](a0_0x3c0d33(0x1d7),auth,async(_0x281568,_0xc1b700)=>{const _0x6766db=a0_0x3c0d33;try{const _0x2d69de=new excelJS[(_0x6766db(0x207))](),_0x39c022=_0x2d69de[_0x6766db(0x1cb)](_0x6766db(0x204));return _0x39c022[_0x6766db(0x1f2)]=[{'header':'ID','key':_0x6766db(0x1ba),'width':0xa},{'header':_0x6766db(0x1dd),'key':'PBrands','width':0xa},{'header':_0x6766db(0x1ed),'key':_0x6766db(0x211),'width':0xa},{'header':'SalesmanName','key':_0x6766db(0x1f8),'width':0xa},{'header':_0x6766db(0x1f1),'key':'address','width':0xa},{'header':'mobile','key':'mobile','width':0xa},{'header':_0x6766db(0x1fa),'key':_0x6766db(0x1fa),'width':0xa}],_0xc1b700[_0x6766db(0x1e1)]('Content-Type',_0x6766db(0x1c8)),_0xc1b700[_0x6766db(0x1e1)](_0x6766db(0x1d4),_0x6766db(0x1df)),_0x2d69de[_0x6766db(0x1d3)][_0x6766db(0x200)](_0xc1b700)[_0x6766db(0x1bf)](()=>{_0xc1b700['status'](0xc8);});}catch(_0xfad196){_0xc1b700[_0x6766db(0x1fd)](0x190)[_0x6766db(0x1e2)]({'errors':_0xfad196[_0x6766db(0x1b8)]});}});function a0_0x229e(){const _0x39199b=['send','4176180mIbogU','master','1678334qXoCFe','Portuguese','findOne','customer\x20add\x20successfully','Arabic','language','now','Sale','SalesmanCode','render','/view/:id','json','address','columns','$reason','22705270iBNxCK','Chinese','customer\x20update\x20successfully','payable_sum','SalesmanName','payable','email','../middleware/auth','Router','status','findById','\x20added\x20successfully','write','Arabic\x20(ae)','customer_docs','customer_data','Customers','Hindi','save','Workbook','get','single','exports','payment_data','user','body','forEach','express','7055mHZFvz','PUnits','post','5352OYKEqh','../public/language/languages.json','3393381gTDciq','c_payments','German','/view','English','/customer/view','../models/all_models','originalname','111087VWzdaR','aggregate','utils','Sheets','message','sale_return','PName','redirect','/customer_import_migrate_file','file','Portuguese\x20(BR)','then','/view/payment/:id','find','success','28Uuxmds','15399pggztx','customer_payment','log','$amount','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','20GByGgw','Spanish','addWorksheet','errors','readFile','receivable_sum','contactperson','customer','mobile','name','xlsx','Content-Disposition','amount','flash','/products_export_migrate_file','English\x20(US)','French','public/Migration/','sale','params','Name','multer','attachment;\x20filename=customer_Migration_File.xlsx','reason','setHeader'];a0_0x229e=function(){return _0x39199b;};return a0_0x229e();}const storage1=multer['diskStorage']({'destination':(_0x45e3fa,_0x379fc7,_0x4c1210)=>{_0x4c1210(null,'public/Migration');},'filename':(_0x1e003f,_0x53df44,_0x9109ab)=>{const _0x3f22f6=a0_0x3c0d33;_0x9109ab(null,Date[_0x3f22f6(0x1eb)]()+_0x53df44[_0x3f22f6(0x21c)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x3c0d33(0x1bc),auth,uploadMigrate[a0_0x3c0d33(0x209)]('customer_product_fule'),async(_0x478c05,_0x54eef9)=>{const _0x25359c=a0_0x3c0d33,_0x5cce02=_0x478c05[_0x25359c(0x1bd)]['filename'],_0x4c79d1=await xlsx[_0x25359c(0x1cd)](_0x25359c(0x1da)+_0x5cce02);let _0x459161=_0x4c79d1['SheetNames'],_0x3da7b5=xlsx[_0x25359c(0x21f)]['sheet_to_json'](_0x4c79d1[_0x25359c(0x1b7)][_0x459161[0x0]]);for(const _0x3d37f2 of _0x3da7b5){const _0x4d86bb=_0x3d37f2['ID'],_0xffdf28=_0x3d37f2[_0x25359c(0x1dd)],_0x1b5c1c=_0x3d37f2[_0x25359c(0x1ed)],_0x1b2328=_0x3d37f2[_0x25359c(0x1f8)],_0xb327ce=_0x3d37f2['address'],_0x2a5ac0=_0x3d37f2[_0x25359c(0x1d1)],_0x36cca7=_0x3d37f2[_0x25359c(0x1fa)];try{let _0x9f8505=await customer[_0x25359c(0x1e7)]({'name':_0xffdf28});if(!_0x9f8505){const _0x2b5d1f=new customer({'name':_0xffdf28,'ID':_0x4d86bb,'SalesmanCode':_0x1b5c1c,'SalesmanName':_0x1b2328,'address':_0xb327ce,'mobile':_0x2a5ac0,'email':_0x36cca7});_0x9f8505=await _0x2b5d1f[_0x25359c(0x206)](),_0x478c05[_0x25359c(0x1d6)](_0x25359c(0x1c2),_0xffdf28+_0x25359c(0x1ff));}else _0x478c05[_0x25359c(0x1d6)]('error',_0xffdf28+'\x20Failed');}catch(_0x416a6f){_0x54eef9[_0x25359c(0x1fd)](0x1f4)[_0x25359c(0x1f0)]({'proderror':_0x416a6f[_0x25359c(0x1b8)],'aproduct':ProductName});}}_0x54eef9[_0x25359c(0x1bb)](_0x25359c(0x21a));}),module[a0_0x3c0d33(0x20a)]=router;