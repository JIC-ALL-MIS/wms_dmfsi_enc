const a0_0x595313=a0_0x57ba;(function(_0x14bb7f,_0x41d24b){const _0x580df8=a0_0x57ba,_0x4f4ea4=_0x14bb7f();while(!![]){try{const _0x55267e=-parseInt(_0x580df8(0x160))/0x1*(parseInt(_0x580df8(0x18b))/0x2)+parseInt(_0x580df8(0x195))/0x3+-parseInt(_0x580df8(0x166))/0x4+-parseInt(_0x580df8(0x15d))/0x5+-parseInt(_0x580df8(0x164))/0x6+parseInt(_0x580df8(0x1a6))/0x7+parseInt(_0x580df8(0x15c))/0x8;if(_0x55267e===_0x41d24b)break;else _0x4f4ea4['push'](_0x4f4ea4['shift']());}catch(_0x379070){_0x4f4ea4['push'](_0x4f4ea4['shift']());}}}(a0_0x5b30,0x3409d));function a0_0x57ba(_0x29f509,_0x46fea6){const _0x5b308d=a0_0x5b30();return a0_0x57ba=function(_0x57ba51,_0x845692){_0x57ba51=_0x57ba51-0x145;let _0xaf7b3f=_0x5b308d[_0x57ba51];return _0xaf7b3f;},a0_0x57ba(_0x29f509,_0x46fea6);}const express=require(a0_0x595313(0x18d)),app=express(),router=express[a0_0x595313(0x1a2)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require(a0_0x595313(0x155)),users=require(a0_0x595313(0x157)),excelJS=require('exceljs'),xlsx=require(a0_0x595313(0x14a)),multer=require(a0_0x595313(0x15a));function a0_0x5b30(){const _0x5a0419=['findById','SalesmanName','sheet_to_json','body','attachment;\x20filename=customer_Migration_File.xlsx','../middleware/auth','\x20added\x20successfully','../public/language/languages.json','success','/view/:id','multer','/customer_import_migrate_file','3682416wOPMKk','1072240YQufiz','customer_product_fule','receivable_sum','135024apVliS','Hindi','Customers','amount','1064172UJScPs','/products_export_migrate_file','1355208SEfyDY','message','mobile','findOne','error','Content-Type','English\x20(US)','payable_sum','receivable','Content-Disposition','find','customer','PName','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','contactperson','post','user','customer\x20add\x20successfully','errors','single','reason','file','redirect','customer_docs','data','get','columns','Sale','aggregate','payable','Chinese','public/Migration','log','master','German','/customer/view','exports','4rfHmVj','Name','express','Arabic','now','Sheets','name','email','public/Migration/','then','1094628xQekPY','params','Portuguese','status','\x20Failed','render','Arabic\x20(ae)','French','English','map','json','/view','send','Router','Portuguese\x20(BR)','Spanish','payment_data','2720417mYKtLR','c_payments','SheetNames','element','address','flash','save','setHeader','addWorksheet','PBrands','xlsx','$amount','language','forEach','PUnits','$reason'];a0_0x5b30=function(){return _0x5a0419;};return a0_0x5b30();}router['get'](a0_0x595313(0x1a0),auth,async(_0x2e3bb6,_0x51c732)=>{const _0x3ba579=a0_0x595313;try{const {username:_0x106f94,email:_0x424677,role:_0x435120}=_0x2e3bb6['user'],_0x43d538=_0x2e3bb6[_0x3ba579(0x176)],_0x399410=await profile[_0x3ba579(0x169)]({'email':_0x43d538[_0x3ba579(0x192)]}),_0x146243=await master_shop[_0x3ba579(0x170)]();console[_0x3ba579(0x186)]('master',_0x146243);const _0x26f1ad=await customer[_0x3ba579(0x170)](),_0x164d55=await customer[_0x3ba579(0x182)]([{'$lookup':{'from':_0x3ba579(0x1a7),'localField':_0x3ba579(0x191),'foreignField':_0x3ba579(0x171),'as':_0x3ba579(0x17d)}}]);console[_0x3ba579(0x186)](_0x164d55);const _0xf128ff=_0x164d55[_0x3ba579(0x19e)](_0x22dc1f=>{const _0x17363b=_0x3ba579;console['log'](_0x17363b(0x17e),_0x22dc1f);var _0x4d628d=0x0,_0x5f147f=0x0;return _0x22dc1f[_0x17363b(0x17d)][_0x17363b(0x14d)](_0x39f604=>{const _0x506d16=_0x17363b;console[_0x506d16(0x186)](_0x506d16(0x1a9),_0x39f604),_0x39f604[_0x506d16(0x17a)]==_0x506d16(0x181)?_0x4d628d+=_0x39f604[_0x506d16(0x163)]:_0x5f147f+=_0x39f604[_0x506d16(0x163)];}),_0x22dc1f['sale']=parseFloat(_0x4d628d)+0x0,_0x22dc1f['sale_return']=parseFloat(_0x5f147f)+0x0,_0x22dc1f;});console[_0x3ba579(0x186)](_0x3ba579(0x1a5),_0xf128ff);if(_0x146243[0x0][_0x3ba579(0x14c)]==_0x3ba579(0x16c)){var _0x21fc5e=users[_0x3ba579(0x19d)];console['log'](_0x21fc5e);}else{if(_0x146243[0x0]['language']==_0x3ba579(0x161))var _0x21fc5e=users['Hindi'];else{if(_0x146243[0x0][_0x3ba579(0x14c)]=='German')var _0x21fc5e=users['German'];else{if(_0x146243[0x0]['language']==_0x3ba579(0x1a4))var _0x21fc5e=users[_0x3ba579(0x1a4)];else{if(_0x146243[0x0][_0x3ba579(0x14c)]==_0x3ba579(0x19c))var _0x21fc5e=users[_0x3ba579(0x19c)];else{if(_0x146243[0x0][_0x3ba579(0x14c)]==_0x3ba579(0x1a3))var _0x21fc5e=users[_0x3ba579(0x197)];else{if(_0x146243[0x0][_0x3ba579(0x14c)]==_0x3ba579(0x184))var _0x21fc5e=users[_0x3ba579(0x184)];else{if(_0x146243[0x0]['language']==_0x3ba579(0x19b))var _0x21fc5e=users[_0x3ba579(0x18e)];}}}}}}}_0x51c732['render'](_0x3ba579(0x171),{'success':_0x2e3bb6[_0x3ba579(0x145)](_0x3ba579(0x158)),'errors':_0x2e3bb6[_0x3ba579(0x145)](_0x3ba579(0x178)),'user':_0x26f1ad,'role':_0x43d538,'profile':_0x399410,'payment':_0xf128ff,'master_shop':_0x146243,'language':_0x21fc5e});}catch(_0x5a783f){console[_0x3ba579(0x186)](_0x5a783f);}}),router[a0_0x595313(0x175)](a0_0x595313(0x1a0),auth,async(_0x622a1a,_0x12d58f)=>{const _0x3b6c8b=a0_0x595313;try{const {name:_0x555c0a,address:_0x4f374e,mobile:_0x5f0537,email:_0x48075b,receivable:_0x7677a3,payable:_0x599919,contactperson:_0x55687f,landline:_0x46f417}=_0x622a1a[_0x3b6c8b(0x153)],_0x690d9e=new customer({'name':_0x555c0a,'address':_0x4f374e,'mobile':_0x5f0537,'email':_0x48075b,'receivable':_0x7677a3,'payable':_0x599919,'contactperson':_0x55687f,'landline':_0x46f417}),_0x53d340=await _0x690d9e[_0x3b6c8b(0x146)]();_0x622a1a[_0x3b6c8b(0x145)](_0x3b6c8b(0x158),_0x3b6c8b(0x177)),_0x12d58f['redirect']('/customer/view');}catch(_0xc01795){console[_0x3b6c8b(0x186)](_0xc01795);}}),router[a0_0x595313(0x17f)]('/view/:id',auth,async(_0x321fea,_0x2203ba)=>{const _0x1c7914=a0_0x595313;try{const {username:_0x5521ce,email:_0x4e4312,role:_0x21b6a1}=_0x321fea[_0x1c7914(0x176)],_0xa339e4=_0x321fea['user'],_0x175dfb=await profile[_0x1c7914(0x169)]({'email':_0xa339e4['email']}),_0x380151=await master_shop[_0x1c7914(0x170)]();console['log'](_0x1c7914(0x187),_0x380151);const _0x4a4c10=_0x321fea[_0x1c7914(0x196)]['id'],_0x4932d1=await customer[_0x1c7914(0x150)](_0x4a4c10);if(_0x380151[0x0][_0x1c7914(0x14c)]==_0x1c7914(0x16c)){var _0x1f6463=users[_0x1c7914(0x19d)];console[_0x1c7914(0x186)](_0x1f6463);}else{if(_0x380151[0x0][_0x1c7914(0x14c)]==_0x1c7914(0x161))var _0x1f6463=users[_0x1c7914(0x161)];else{if(_0x380151[0x0]['language']==_0x1c7914(0x188))var _0x1f6463=users[_0x1c7914(0x188)];else{if(_0x380151[0x0][_0x1c7914(0x14c)]==_0x1c7914(0x1a4))var _0x1f6463=users[_0x1c7914(0x1a4)];else{if(_0x380151[0x0][_0x1c7914(0x14c)]=='French')var _0x1f6463=users[_0x1c7914(0x19c)];else{if(_0x380151[0x0][_0x1c7914(0x14c)]==_0x1c7914(0x1a3))var _0x1f6463=users[_0x1c7914(0x197)];else{if(_0x380151[0x0][_0x1c7914(0x14c)]==_0x1c7914(0x184))var _0x1f6463=users[_0x1c7914(0x184)];else{if(_0x380151[0x0][_0x1c7914(0x14c)]==_0x1c7914(0x19b))var _0x1f6463=users[_0x1c7914(0x18e)];}}}}}}}_0x2203ba['render'](_0x1c7914(0x171),{'success':_0x321fea['flash'](_0x1c7914(0x158)),'errors':_0x321fea['flash'](_0x1c7914(0x178)),'role':_0xa339e4,'profile':_0x175dfb,'user':_0x4932d1,'master_shop':_0x380151,'language':_0x1f6463});}catch(_0x3e4cea){console[_0x1c7914(0x186)](_0x3e4cea);}}),router[a0_0x595313(0x175)](a0_0x595313(0x159),auth,async(_0x266935,_0x450cba)=>{const _0x441951=a0_0x595313;try{const _0x24a091=_0x266935['params']['id'],_0xefdd06=await customer[_0x441951(0x150)](_0x24a091),{name:_0x2a5d51,address:_0x117a52,mobile:_0x292ec7,email:_0x5e3d7d,receivable:_0x51a81a,payable:_0x2e1b09,contactperson:_0x445d8f,landline:_0x1dff6f}=_0x266935[_0x441951(0x153)];_0xefdd06['name']=_0x2a5d51,_0xefdd06['address']=_0x117a52,_0xefdd06[_0x441951(0x168)]=_0x292ec7,_0xefdd06['email']=_0x5e3d7d,_0xefdd06[_0x441951(0x16e)]=_0x51a81a,_0xefdd06[_0x441951(0x183)]=_0x2e1b09,_0xefdd06[_0x441951(0x174)]=_0x445d8f,_0xefdd06['landline']=_0x1dff6f;const _0x191f3d=await _0xefdd06[_0x441951(0x146)]();_0x266935[_0x441951(0x145)](_0x441951(0x158),'customer\x20update\x20successfully'),_0x450cba[_0x441951(0x17c)](_0x441951(0x189));}catch(_0x3385e2){console[_0x441951(0x186)](_0x3385e2);}}),router[a0_0x595313(0x17f)]('/view/payment/:id',auth,async(_0x4ab738,_0x400d01)=>{const _0x1aee5d=a0_0x595313;try{const {username:_0x2177a6,email:_0x38a51e,role:_0x4c6e60}=_0x4ab738['user'],_0x259473=_0x4ab738[_0x1aee5d(0x176)],_0x36d4f4=await profile[_0x1aee5d(0x169)]({'email':_0x259473[_0x1aee5d(0x192)]}),_0x544a93=await master_shop['find']();console[_0x1aee5d(0x186)](_0x1aee5d(0x187),_0x544a93),console['log'](_0x4ab738[_0x1aee5d(0x196)]['id']);const _0xb75904=await customer['findOne']({'_id':_0x4ab738[_0x1aee5d(0x196)]['id']});console[_0x1aee5d(0x186)]('customer_data',_0xb75904);const _0x2668ca=await c_payment_data[_0x1aee5d(0x170)]({'customer':_0xb75904[_0x1aee5d(0x191)]});console[_0x1aee5d(0x186)](_0x2668ca);const _0x159e21=await c_payment_data['aggregate']([{'$match':{'customer':_0xb75904['name']}},{'$match':{'reason':_0x1aee5d(0x181)}},{'$group':{'_id':_0x1aee5d(0x14f),'sum':{'$sum':_0x1aee5d(0x14b)}}}]);console[_0x1aee5d(0x186)](_0x1aee5d(0x16d),_0x159e21);const _0x1fc92a=await c_payment_data['aggregate']([{'$match':{'customer':_0xb75904[_0x1aee5d(0x191)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x1aee5d(0x14f),'sum':{'$sum':_0x1aee5d(0x14b)}}}]);console[_0x1aee5d(0x186)](_0x1aee5d(0x15f),_0x1fc92a);if(_0x544a93[0x0]['language']==_0x1aee5d(0x16c)){var _0x4ca1cf=users[_0x1aee5d(0x19d)];console[_0x1aee5d(0x186)](_0x4ca1cf);}else{if(_0x544a93[0x0][_0x1aee5d(0x14c)]==_0x1aee5d(0x161))var _0x4ca1cf=users['Hindi'];else{if(_0x544a93[0x0][_0x1aee5d(0x14c)]==_0x1aee5d(0x188))var _0x4ca1cf=users['German'];else{if(_0x544a93[0x0][_0x1aee5d(0x14c)]==_0x1aee5d(0x1a4))var _0x4ca1cf=users[_0x1aee5d(0x1a4)];else{if(_0x544a93[0x0][_0x1aee5d(0x14c)]=='French')var _0x4ca1cf=users[_0x1aee5d(0x19c)];else{if(_0x544a93[0x0]['language']=='Portuguese\x20(BR)')var _0x4ca1cf=users['Portuguese'];else{if(_0x544a93[0x0]['language']==_0x1aee5d(0x184))var _0x4ca1cf=users[_0x1aee5d(0x184)];else{if(_0x544a93[0x0][_0x1aee5d(0x14c)]==_0x1aee5d(0x19b))var _0x4ca1cf=users[_0x1aee5d(0x18e)];}}}}}}}_0x400d01[_0x1aee5d(0x19a)]('customer_payment',{'success':_0x4ab738[_0x1aee5d(0x145)]('success'),'errors':_0x4ab738['flash']('errors'),'role':_0x259473,'profile':_0x36d4f4,'payment':_0x2668ca,'payable':_0x159e21,'receivable':_0x1fc92a,'master_shop':_0x544a93,'language':_0x4ca1cf});}catch(_0x2012e2){console[_0x1aee5d(0x186)](_0x2012e2);}}),router[a0_0x595313(0x17f)](a0_0x595313(0x165),auth,async(_0xd2b114,_0x1ec1c9)=>{const _0x4260b8=a0_0x595313;try{const _0x40c33d=new excelJS['Workbook'](),_0x546a7=_0x40c33d[_0x4260b8(0x148)](_0x4260b8(0x162));return _0x546a7[_0x4260b8(0x180)]=[{'header':'ID','key':_0x4260b8(0x172),'width':0xa},{'header':_0x4260b8(0x18c),'key':_0x4260b8(0x149),'width':0xa},{'header':'SalesmanCode','key':_0x4260b8(0x14e),'width':0xa},{'header':_0x4260b8(0x151),'key':'SalesmanName','width':0xa},{'header':_0x4260b8(0x1aa),'key':_0x4260b8(0x1aa),'width':0xa},{'header':'mobile','key':'mobile','width':0xa},{'header':_0x4260b8(0x192),'key':'email','width':0xa}],_0x1ec1c9[_0x4260b8(0x147)](_0x4260b8(0x16b),_0x4260b8(0x173)),_0x1ec1c9[_0x4260b8(0x147)](_0x4260b8(0x16f),_0x4260b8(0x154)),_0x40c33d[_0x4260b8(0x14a)]['write'](_0x1ec1c9)[_0x4260b8(0x194)](()=>{const _0x31ae60=_0x4260b8;_0x1ec1c9[_0x31ae60(0x198)](0xc8);});}catch(_0x4fcae0){_0x1ec1c9[_0x4260b8(0x198)](0x190)[_0x4260b8(0x1a1)]({'errors':_0x4fcae0[_0x4260b8(0x167)]});}});const storage1=multer['diskStorage']({'destination':(_0x4c1131,_0x5d6610,_0x52f90a)=>{const _0x226761=a0_0x595313;_0x52f90a(null,_0x226761(0x185));},'filename':(_0x2b64cd,_0x59387b,_0x5cb7db)=>{const _0x20931c=a0_0x595313;_0x5cb7db(null,Date[_0x20931c(0x18f)]()+_0x59387b['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x595313(0x175)](a0_0x595313(0x15b),auth,uploadMigrate[a0_0x595313(0x179)](a0_0x595313(0x15e)),async(_0xcf3db6,_0x8072a7)=>{const _0x5bb224=a0_0x595313,_0x1b553f=_0xcf3db6[_0x5bb224(0x17b)]['filename'],_0x365d2d=await xlsx['readFile'](_0x5bb224(0x193)+_0x1b553f);let _0x1659b4=_0x365d2d[_0x5bb224(0x1a8)],_0x313c09=xlsx['utils'][_0x5bb224(0x152)](_0x365d2d[_0x5bb224(0x190)][_0x1659b4[0x0]]);for(const _0x1440b7 of _0x313c09){const _0x70ade2=_0x1440b7['ID'],_0x26ac78=_0x1440b7[_0x5bb224(0x18c)],_0x5a0a20=_0x1440b7['SalesmanCode'],_0x4dab14=_0x1440b7[_0x5bb224(0x151)],_0x656ac8=_0x1440b7[_0x5bb224(0x1aa)],_0x4280e5=_0x1440b7['mobile'],_0x3e1935=_0x1440b7[_0x5bb224(0x192)];try{let _0x5e2e76=await customer[_0x5bb224(0x169)]({'name':_0x26ac78});if(!_0x5e2e76){const _0x2c10b9=new customer({'name':_0x26ac78,'ID':_0x70ade2,'SalesmanCode':_0x5a0a20,'SalesmanName':_0x4dab14,'address':_0x656ac8,'mobile':_0x4280e5,'email':_0x3e1935});_0x5e2e76=await _0x2c10b9['save'](),_0xcf3db6['flash']('success',_0x26ac78+_0x5bb224(0x156));}else _0xcf3db6['flash'](_0x5bb224(0x16a),_0x26ac78+_0x5bb224(0x199));}catch(_0x1fc05a){_0x8072a7[_0x5bb224(0x198)](0x1f4)[_0x5bb224(0x19f)]({'proderror':_0x1fc05a[_0x5bb224(0x167)],'aproduct':ProductName});}}_0x8072a7[_0x5bb224(0x17c)](_0x5bb224(0x189));}),module[a0_0x595313(0x18a)]=router;