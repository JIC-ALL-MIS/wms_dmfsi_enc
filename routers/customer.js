const a0_0x1db248=a0_0x174f;(function(_0x1fb5fb,_0x34692e){const _0x653670=a0_0x174f,_0x2f5d3d=_0x1fb5fb();while(!![]){try{const _0x2c99bc=parseInt(_0x653670(0x1ca))/0x1+-parseInt(_0x653670(0x1b0))/0x2*(-parseInt(_0x653670(0x1c7))/0x3)+-parseInt(_0x653670(0x19e))/0x4*(parseInt(_0x653670(0x1dd))/0x5)+parseInt(_0x653670(0x1ec))/0x6*(-parseInt(_0x653670(0x1f1))/0x7)+-parseInt(_0x653670(0x1ff))/0x8*(-parseInt(_0x653670(0x1e5))/0x9)+parseInt(_0x653670(0x1b6))/0xa+-parseInt(_0x653670(0x1eb))/0xb;if(_0x2c99bc===_0x34692e)break;else _0x2f5d3d['push'](_0x2f5d3d['shift']());}catch(_0x32132b){_0x2f5d3d['push'](_0x2f5d3d['shift']());}}}(a0_0x56c6,0xd5692));const express=require(a0_0x1db248(0x1ad)),app=express(),router=express[a0_0x1db248(0x1e6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x1db248(0x1f8)),auth=require(a0_0x1db248(0x1c3)),users=require(a0_0x1db248(0x1f3)),excelJS=require('exceljs'),xlsx=require(a0_0x1db248(0x1b7)),multer=require(a0_0x1db248(0x1db));function a0_0x56c6(){const _0x359cc5=['exports','redirect','language','sale','now','user','master','log','post','express','Chinese','forEach','38tpdrUV','receivable','/customer/view','\x20added\x20successfully','PBrands','Spanish','2950460rZJGqr','xlsx','then','payable_sum','params','single','/view/payment/:id','German','find','/view','/view/:id','customer_product_fule','c_payments','../middleware/auth','sale_return','status','public/Migration/','243642rngWfc','public/Migration','Customers','1293306uAhFiM','render','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','SalesmanName','PName','errors','name','Sale','English\x20(US)','Content-Disposition','PUnits','diskStorage','findOne','setHeader','Content-Type','save','originalname','multer','get','172565QagbhC','filename','SheetNames','Name','customer','customer\x20add\x20successfully','sheet_to_json','Sale\x20Return','18oggkUv','Router','map','customer\x20update\x20successfully','SalesmanCode','aggregate','24581865umcDIW','9060HIcAvY','error','$reason','Portuguese','mobile','2212yEIoAI','Sheets','../public/language/languages.json','flash','amount','body','address','../models/all_models','/customer_import_migrate_file','findById','element','addWorksheet','customer_payment','attachment;\x20filename=customer_Migration_File.xlsx','4165232MeTfCf','Arabic','email','Hindi','reason','French','payment_data','landline','customer_docs','\x20Failed','Arabic\x20(ae)','68oebRmm','English','Portuguese\x20(BR)','columns','success','send'];a0_0x56c6=function(){return _0x359cc5;};return a0_0x56c6();}router[a0_0x1db248(0x1dc)](a0_0x1db248(0x1bf),auth,async(_0x63a840,_0x3fd886)=>{const _0x1364fa=a0_0x1db248;try{const {username:_0x4e186d,email:_0x266118,role:_0x121e68}=_0x63a840[_0x1364fa(0x1a9)],_0x2ace6e=_0x63a840[_0x1364fa(0x1a9)],_0x42b900=await profile[_0x1364fa(0x1d6)]({'email':_0x2ace6e[_0x1364fa(0x201)]}),_0x3c2356=await master_shop['find']();console[_0x1364fa(0x1ab)](_0x1364fa(0x1aa),_0x3c2356);const _0x51b246=await customer[_0x1364fa(0x1be)](),_0x51ef7c=await customer[_0x1364fa(0x1ea)]([{'$lookup':{'from':_0x1364fa(0x1c2),'localField':_0x1364fa(0x1d0),'foreignField':_0x1364fa(0x1e1),'as':_0x1364fa(0x19b)}}]);console[_0x1364fa(0x1ab)](_0x51ef7c);const _0x8eb344=_0x51ef7c[_0x1364fa(0x1e7)](_0x42e264=>{const _0x393739=_0x1364fa;console[_0x393739(0x1ab)]('data',_0x42e264);var _0x5dee03=0x0,_0x203a8c=0x0;return _0x42e264[_0x393739(0x19b)][_0x393739(0x1af)](_0x2184f8=>{const _0x583b0b=_0x393739;console[_0x583b0b(0x1ab)](_0x583b0b(0x1fb),_0x2184f8),_0x2184f8[_0x583b0b(0x197)]==_0x583b0b(0x1d1)?_0x5dee03+=_0x2184f8[_0x583b0b(0x1f5)]:_0x203a8c+=_0x2184f8[_0x583b0b(0x1f5)];}),_0x42e264[_0x393739(0x1a7)]=parseFloat(_0x5dee03)+0x0,_0x42e264[_0x393739(0x1c4)]=parseFloat(_0x203a8c)+0x0,_0x42e264;});console['log'](_0x1364fa(0x199),_0x8eb344);if(_0x3c2356[0x0][_0x1364fa(0x1a6)]=='English\x20(US)'){var _0x50819f=users[_0x1364fa(0x19f)];console['log'](_0x50819f);}else{if(_0x3c2356[0x0][_0x1364fa(0x1a6)]==_0x1364fa(0x196))var _0x50819f=users['Hindi'];else{if(_0x3c2356[0x0][_0x1364fa(0x1a6)]==_0x1364fa(0x1bd))var _0x50819f=users['German'];else{if(_0x3c2356[0x0][_0x1364fa(0x1a6)]=='Spanish')var _0x50819f=users['Spanish'];else{if(_0x3c2356[0x0]['language']==_0x1364fa(0x198))var _0x50819f=users[_0x1364fa(0x198)];else{if(_0x3c2356[0x0][_0x1364fa(0x1a6)]=='Portuguese\x20(BR)')var _0x50819f=users[_0x1364fa(0x1ef)];else{if(_0x3c2356[0x0][_0x1364fa(0x1a6)]=='Chinese')var _0x50819f=users[_0x1364fa(0x1ae)];else{if(_0x3c2356[0x0][_0x1364fa(0x1a6)]=='Arabic\x20(ae)')var _0x50819f=users[_0x1364fa(0x200)];}}}}}}}_0x3fd886['render'](_0x1364fa(0x1e1),{'success':_0x63a840[_0x1364fa(0x1f4)]('success'),'errors':_0x63a840['flash']('errors'),'user':_0x51b246,'role':_0x2ace6e,'profile':_0x42b900,'payment':_0x8eb344,'master_shop':_0x3c2356,'language':_0x50819f});}catch(_0x508127){console[_0x1364fa(0x1ab)](_0x508127);}}),router['post'](a0_0x1db248(0x1bf),auth,async(_0x3b4f8a,_0x1a9c08)=>{const _0xfa541e=a0_0x1db248;try{const {name:_0x215473,address:_0x4d1f7a,mobile:_0x2a70a3,email:_0x41f052,receivable:_0x4a7492,payable:_0x42539f,contactperson:_0x371be4,landline:_0x232808}=_0x3b4f8a[_0xfa541e(0x1f6)],_0x54cb2a=new customer({'name':_0x215473,'address':_0x4d1f7a,'mobile':_0x2a70a3,'email':_0x41f052,'receivable':_0x4a7492,'payable':_0x42539f,'contactperson':_0x371be4,'landline':_0x232808}),_0x121e6c=await _0x54cb2a['save']();_0x3b4f8a['flash']('success',_0xfa541e(0x1e2)),_0x1a9c08[_0xfa541e(0x1a5)]('/customer/view');}catch(_0x4e2ee0){console['log'](_0x4e2ee0);}}),router['get'](a0_0x1db248(0x1c0),auth,async(_0x31305d,_0xc2b71)=>{const _0x612170=a0_0x1db248;try{const {username:_0x7dd468,email:_0xafdf7f,role:_0x3da76c}=_0x31305d[_0x612170(0x1a9)],_0x47cbe2=_0x31305d[_0x612170(0x1a9)],_0x67e6c9=await profile[_0x612170(0x1d6)]({'email':_0x47cbe2['email']}),_0x8948d1=await master_shop[_0x612170(0x1be)]();console[_0x612170(0x1ab)](_0x612170(0x1aa),_0x8948d1);const _0xf8a4a0=_0x31305d[_0x612170(0x1ba)]['id'],_0x38cd70=await customer[_0x612170(0x1fa)](_0xf8a4a0);if(_0x8948d1[0x0][_0x612170(0x1a6)]==_0x612170(0x1d2)){var _0x3f71e1=users[_0x612170(0x19f)];console[_0x612170(0x1ab)](_0x3f71e1);}else{if(_0x8948d1[0x0][_0x612170(0x1a6)]==_0x612170(0x196))var _0x3f71e1=users[_0x612170(0x196)];else{if(_0x8948d1[0x0][_0x612170(0x1a6)]=='German')var _0x3f71e1=users[_0x612170(0x1bd)];else{if(_0x8948d1[0x0][_0x612170(0x1a6)]==_0x612170(0x1b5))var _0x3f71e1=users[_0x612170(0x1b5)];else{if(_0x8948d1[0x0][_0x612170(0x1a6)]=='French')var _0x3f71e1=users[_0x612170(0x198)];else{if(_0x8948d1[0x0][_0x612170(0x1a6)]==_0x612170(0x1a0))var _0x3f71e1=users[_0x612170(0x1ef)];else{if(_0x8948d1[0x0][_0x612170(0x1a6)]==_0x612170(0x1ae))var _0x3f71e1=users[_0x612170(0x1ae)];else{if(_0x8948d1[0x0][_0x612170(0x1a6)]==_0x612170(0x19d))var _0x3f71e1=users[_0x612170(0x200)];}}}}}}}_0xc2b71[_0x612170(0x1cb)](_0x612170(0x1e1),{'success':_0x31305d['flash'](_0x612170(0x1a2)),'errors':_0x31305d[_0x612170(0x1f4)](_0x612170(0x1cf)),'role':_0x47cbe2,'profile':_0x67e6c9,'user':_0x38cd70,'master_shop':_0x8948d1,'language':_0x3f71e1});}catch(_0x4dacca){console[_0x612170(0x1ab)](_0x4dacca);}}),router[a0_0x1db248(0x1ac)](a0_0x1db248(0x1c0),auth,async(_0x4a0b3f,_0x5ec88a)=>{const _0x499d43=a0_0x1db248;try{const _0x4cf04e=_0x4a0b3f['params']['id'],_0x150fa8=await customer[_0x499d43(0x1fa)](_0x4cf04e),{name:_0x19d96a,address:_0x32e9a8,mobile:_0x33aca3,email:_0x111280,receivable:_0x368c4a,payable:_0x2096ce,contactperson:_0xade703,landline:_0xd83aff}=_0x4a0b3f[_0x499d43(0x1f6)];_0x150fa8[_0x499d43(0x1d0)]=_0x19d96a,_0x150fa8[_0x499d43(0x1f7)]=_0x32e9a8,_0x150fa8[_0x499d43(0x1f0)]=_0x33aca3,_0x150fa8['email']=_0x111280,_0x150fa8[_0x499d43(0x1b1)]=_0x368c4a,_0x150fa8['payable']=_0x2096ce,_0x150fa8['contactperson']=_0xade703,_0x150fa8[_0x499d43(0x19a)]=_0xd83aff;const _0x8ca6b1=await _0x150fa8[_0x499d43(0x1d9)]();_0x4a0b3f[_0x499d43(0x1f4)](_0x499d43(0x1a2),_0x499d43(0x1e8)),_0x5ec88a['redirect'](_0x499d43(0x1b2));}catch(_0x594f31){console['log'](_0x594f31);}}),router[a0_0x1db248(0x1dc)](a0_0x1db248(0x1bc),auth,async(_0x7fd3c7,_0x3f3a51)=>{const _0x469546=a0_0x1db248;try{const {username:_0x5895fd,email:_0x58e49a,role:_0x22de3f}=_0x7fd3c7['user'],_0xace7b5=_0x7fd3c7[_0x469546(0x1a9)],_0x2655cd=await profile[_0x469546(0x1d6)]({'email':_0xace7b5[_0x469546(0x201)]}),_0x31d119=await master_shop[_0x469546(0x1be)]();console[_0x469546(0x1ab)]('master',_0x31d119),console['log'](_0x7fd3c7[_0x469546(0x1ba)]['id']);const _0x5e53fa=await customer[_0x469546(0x1d6)]({'_id':_0x7fd3c7[_0x469546(0x1ba)]['id']});console[_0x469546(0x1ab)]('customer_data',_0x5e53fa);const _0x29f199=await c_payment_data[_0x469546(0x1be)]({'customer':_0x5e53fa['name']});console['log'](_0x29f199);const _0x27d4df=await c_payment_data['aggregate']([{'$match':{'customer':_0x5e53fa[_0x469546(0x1d0)]}},{'$match':{'reason':_0x469546(0x1d1)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console['log'](_0x469546(0x1b9),_0x27d4df);const _0x4558d2=await c_payment_data[_0x469546(0x1ea)]([{'$match':{'customer':_0x5e53fa[_0x469546(0x1d0)]}},{'$match':{'reason':_0x469546(0x1e4)}},{'$group':{'_id':_0x469546(0x1ee),'sum':{'$sum':'$amount'}}}]);console[_0x469546(0x1ab)]('receivable_sum',_0x4558d2);if(_0x31d119[0x0]['language']==_0x469546(0x1d2)){var _0x125d14=users['English'];console[_0x469546(0x1ab)](_0x125d14);}else{if(_0x31d119[0x0][_0x469546(0x1a6)]==_0x469546(0x196))var _0x125d14=users['Hindi'];else{if(_0x31d119[0x0]['language']==_0x469546(0x1bd))var _0x125d14=users[_0x469546(0x1bd)];else{if(_0x31d119[0x0][_0x469546(0x1a6)]==_0x469546(0x1b5))var _0x125d14=users[_0x469546(0x1b5)];else{if(_0x31d119[0x0][_0x469546(0x1a6)]==_0x469546(0x198))var _0x125d14=users[_0x469546(0x198)];else{if(_0x31d119[0x0]['language']==_0x469546(0x1a0))var _0x125d14=users[_0x469546(0x1ef)];else{if(_0x31d119[0x0]['language']=='Chinese')var _0x125d14=users[_0x469546(0x1ae)];else{if(_0x31d119[0x0][_0x469546(0x1a6)]=='Arabic\x20(ae)')var _0x125d14=users[_0x469546(0x200)];}}}}}}}_0x3f3a51[_0x469546(0x1cb)](_0x469546(0x1fd),{'success':_0x7fd3c7[_0x469546(0x1f4)]('success'),'errors':_0x7fd3c7[_0x469546(0x1f4)](_0x469546(0x1cf)),'role':_0xace7b5,'profile':_0x2655cd,'payment':_0x29f199,'payable':_0x27d4df,'receivable':_0x4558d2,'master_shop':_0x31d119,'language':_0x125d14});}catch(_0x510033){console['log'](_0x510033);}}),router[a0_0x1db248(0x1dc)]('/products_export_migrate_file',auth,async(_0x262022,_0x285421)=>{const _0x1e19af=a0_0x1db248;try{const _0x4eb236=new excelJS['Workbook'](),_0x27d5f5=_0x4eb236[_0x1e19af(0x1fc)](_0x1e19af(0x1c9));return _0x27d5f5[_0x1e19af(0x1a1)]=[{'header':'ID','key':_0x1e19af(0x1ce),'width':0xa},{'header':_0x1e19af(0x1e0),'key':_0x1e19af(0x1b4),'width':0xa},{'header':'SalesmanCode','key':_0x1e19af(0x1d4),'width':0xa},{'header':_0x1e19af(0x1cd),'key':'SalesmanName','width':0xa},{'header':_0x1e19af(0x1f7),'key':_0x1e19af(0x1f7),'width':0xa},{'header':_0x1e19af(0x1f0),'key':_0x1e19af(0x1f0),'width':0xa},{'header':'email','key':_0x1e19af(0x201),'width':0xa}],_0x285421['setHeader'](_0x1e19af(0x1d8),_0x1e19af(0x1cc)),_0x285421[_0x1e19af(0x1d7)](_0x1e19af(0x1d3),_0x1e19af(0x1fe)),_0x4eb236[_0x1e19af(0x1b7)]['write'](_0x285421)[_0x1e19af(0x1b8)](()=>{_0x285421['status'](0xc8);});}catch(_0x53d616){_0x285421[_0x1e19af(0x1c5)](0x190)[_0x1e19af(0x1a3)]({'errors':_0x53d616['message']});}});const storage1=multer[a0_0x1db248(0x1d5)]({'destination':(_0x1c7691,_0x2f9d25,_0x329bd8)=>{const _0x447155=a0_0x1db248;_0x329bd8(null,_0x447155(0x1c8));},'filename':(_0x38f153,_0x2b3ff4,_0x2b7297)=>{const _0x5c6f2a=a0_0x1db248;_0x2b7297(null,Date[_0x5c6f2a(0x1a8)]()+_0x2b3ff4[_0x5c6f2a(0x1da)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x174f(_0x240950,_0x1165ef){const _0x56c6e1=a0_0x56c6();return a0_0x174f=function(_0x174f27,_0x243031){_0x174f27=_0x174f27-0x196;let _0x55c146=_0x56c6e1[_0x174f27];return _0x55c146;},a0_0x174f(_0x240950,_0x1165ef);}router[a0_0x1db248(0x1ac)](a0_0x1db248(0x1f9),auth,uploadMigrate[a0_0x1db248(0x1bb)](a0_0x1db248(0x1c1)),async(_0x33251b,_0x26646d)=>{const _0x5b2a0c=a0_0x1db248,_0x43c127=_0x33251b['file'][_0x5b2a0c(0x1de)],_0x275404=await xlsx['readFile'](_0x5b2a0c(0x1c6)+_0x43c127);let _0x5543dc=_0x275404[_0x5b2a0c(0x1df)],_0xd0d70d=xlsx['utils'][_0x5b2a0c(0x1e3)](_0x275404[_0x5b2a0c(0x1f2)][_0x5543dc[0x0]]);for(const _0x35d333 of _0xd0d70d){const _0x376342=_0x35d333['ID'],_0x1b1c1b=_0x35d333[_0x5b2a0c(0x1e0)],_0x4b0367=_0x35d333[_0x5b2a0c(0x1e9)],_0x57f6fb=_0x35d333[_0x5b2a0c(0x1cd)],_0x5b0ce4=_0x35d333[_0x5b2a0c(0x1f7)],_0x341487=_0x35d333[_0x5b2a0c(0x1f0)],_0x25c0d4=_0x35d333[_0x5b2a0c(0x201)];try{let _0x80cd32=await customer[_0x5b2a0c(0x1d6)]({'name':_0x1b1c1b});if(!_0x80cd32){const _0x169810=new customer({'name':_0x1b1c1b,'ID':_0x376342,'SalesmanCode':_0x4b0367,'SalesmanName':_0x57f6fb,'address':_0x5b0ce4,'mobile':_0x341487,'email':_0x25c0d4});_0x80cd32=await _0x169810['save'](),_0x33251b[_0x5b2a0c(0x1f4)](_0x5b2a0c(0x1a2),_0x1b1c1b+_0x5b2a0c(0x1b3));}else _0x33251b['flash'](_0x5b2a0c(0x1ed),_0x1b1c1b+_0x5b2a0c(0x19c));}catch(_0x2ea371){_0x26646d['status'](0x1f4)['json']({'proderror':_0x2ea371['message'],'aproduct':ProductName});}}_0x26646d[_0x5b2a0c(0x1a5)](_0x5b2a0c(0x1b2));}),module[a0_0x1db248(0x1a4)]=router;