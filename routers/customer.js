function a0_0x2cc8(){const _0x1bc49d=['SheetNames','/view','sale_return','public/Migration/','amount','message','customer\x20update\x20successfully','language','send','Name','Workbook','redirect','errors','Sheets','/view/payment/:id','/customer_import_migrate_file','single','findOne','body','map','SalesmanCode','payment_data','data','success','French','customer','diskStorage','save','exports','../models/all_models','35IxNjMq','/view/:id','addWorksheet','customer_docs','Portuguese','Chinese','PName','German','18pBwMSY','../middleware/auth','sheet_to_json','\x20added\x20successfully','contactperson','Content-Type','then','now','email','post','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','log','find','params','Arabic\x20(ae)','\x20Failed','findById','customer_payment','receivable','$reason','PUnits','5364eAtFlY','setHeader','status','90729adesvm','express','c_payments','English','1100070HzYuSs','customer\x20add\x20successfully','406860ymsSrU','exceljs','customer_product_fule','element','file','columns','readFile','master','Customers','349921ClYaDO','$amount','Sale','Hindi','70510NtoZFQ','flash','mobile','customer_data','public/Migration','write','user','PBrands','SalesmanName','landline','filename','aggregate','Arabic','/products_export_migrate_file','Portuguese\x20(BR)','187xFwPHS','Spanish','name','render','3490640lfCANm','utils','attachment;\x20filename=customer_Migration_File.xlsx','get','sale','8152YjUhmr','address','xlsx','/customer/view','originalname','English\x20(US)','Content-Disposition'];a0_0x2cc8=function(){return _0x1bc49d;};return a0_0x2cc8();}const a0_0x4a109c=a0_0x1180;(function(_0xa8975f,_0x5900de){const _0x565d95=a0_0x1180,_0x245c71=_0xa8975f();while(!![]){try{const _0x7eaa53=parseInt(_0x565d95(0x19f))/0x1+parseInt(_0x565d95(0x178))/0x2*(parseInt(_0x565d95(0x190))/0x3)+parseInt(_0x565d95(0x1b6))/0x4+-parseInt(_0x565d95(0x194))/0x5+-parseInt(_0x565d95(0x196))/0x6*(parseInt(_0x565d95(0x170))/0x7)+parseInt(_0x565d95(0x1bb))/0x8*(-parseInt(_0x565d95(0x18d))/0x9)+-parseInt(_0x565d95(0x1a3))/0xa*(-parseInt(_0x565d95(0x1b2))/0xb);if(_0x7eaa53===_0x5900de)break;else _0x245c71['push'](_0x245c71['shift']());}catch(_0x592854){_0x245c71['push'](_0x245c71['shift']());}}}(a0_0x2cc8,0x6d6f7));const express=require(a0_0x4a109c(0x191)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x4a109c(0x16f)),auth=require(a0_0x4a109c(0x179)),users=require('../public/language/languages.json'),excelJS=require(a0_0x4a109c(0x197)),xlsx=require(a0_0x4a109c(0x1bd)),multer=require('multer');router['get'](a0_0x4a109c(0x1c3),auth,async(_0x282f5d,_0x1ee7f6)=>{const _0xde25c8=a0_0x4a109c;try{const {username:_0x1bc599,email:_0x1f4dc4,role:_0x199830}=_0x282f5d[_0xde25c8(0x1a9)],_0x189417=_0x282f5d[_0xde25c8(0x1a9)],_0x4637fd=await profile[_0xde25c8(0x163)]({'email':_0x189417['email']}),_0x549d81=await master_shop[_0xde25c8(0x184)]();console[_0xde25c8(0x183)](_0xde25c8(0x19d),_0x549d81);const _0x44a211=await customer[_0xde25c8(0x184)](),_0x2e44cc=await customer[_0xde25c8(0x1ae)]([{'$lookup':{'from':_0xde25c8(0x192),'localField':_0xde25c8(0x1b4),'foreignField':_0xde25c8(0x16b),'as':_0xde25c8(0x173)}}]);console[_0xde25c8(0x183)](_0x2e44cc);const _0x42d257=_0x2e44cc[_0xde25c8(0x165)](_0x4bcbbc=>{const _0x897d63=_0xde25c8;console[_0x897d63(0x183)](_0x897d63(0x168),_0x4bcbbc);var _0x371854=0x0,_0x2a9dac=0x0;return _0x4bcbbc[_0x897d63(0x173)]['forEach'](_0x57e3ac=>{const _0x4f4520=_0x897d63;console[_0x4f4520(0x183)](_0x4f4520(0x199),_0x57e3ac),_0x57e3ac['reason']==_0x4f4520(0x1a1)?_0x371854+=_0x57e3ac[_0x4f4520(0x1c6)]:_0x2a9dac+=_0x57e3ac[_0x4f4520(0x1c6)];}),_0x4bcbbc[_0x897d63(0x1ba)]=parseFloat(_0x371854)+0x0,_0x4bcbbc[_0x897d63(0x1c4)]=parseFloat(_0x2a9dac)+0x0,_0x4bcbbc;});console[_0xde25c8(0x183)](_0xde25c8(0x167),_0x42d257);if(_0x549d81[0x0][_0xde25c8(0x1c9)]==_0xde25c8(0x1c0)){var _0x2ccc5e=users[_0xde25c8(0x193)];console[_0xde25c8(0x183)](_0x2ccc5e);}else{if(_0x549d81[0x0][_0xde25c8(0x1c9)]==_0xde25c8(0x1a2))var _0x2ccc5e=users[_0xde25c8(0x1a2)];else{if(_0x549d81[0x0][_0xde25c8(0x1c9)]==_0xde25c8(0x177))var _0x2ccc5e=users[_0xde25c8(0x177)];else{if(_0x549d81[0x0][_0xde25c8(0x1c9)]==_0xde25c8(0x1b3))var _0x2ccc5e=users[_0xde25c8(0x1b3)];else{if(_0x549d81[0x0][_0xde25c8(0x1c9)]==_0xde25c8(0x16a))var _0x2ccc5e=users[_0xde25c8(0x16a)];else{if(_0x549d81[0x0][_0xde25c8(0x1c9)]==_0xde25c8(0x1b1))var _0x2ccc5e=users[_0xde25c8(0x174)];else{if(_0x549d81[0x0]['language']==_0xde25c8(0x175))var _0x2ccc5e=users[_0xde25c8(0x175)];else{if(_0x549d81[0x0][_0xde25c8(0x1c9)]==_0xde25c8(0x186))var _0x2ccc5e=users['Arabic'];}}}}}}}_0x1ee7f6[_0xde25c8(0x1b5)](_0xde25c8(0x16b),{'success':_0x282f5d[_0xde25c8(0x1a4)](_0xde25c8(0x169)),'errors':_0x282f5d['flash'](_0xde25c8(0x1ce)),'user':_0x44a211,'role':_0x189417,'profile':_0x4637fd,'payment':_0x42d257,'master_shop':_0x549d81,'language':_0x2ccc5e});}catch(_0x1757a6){console['log'](_0x1757a6);}}),router[a0_0x4a109c(0x181)](a0_0x4a109c(0x1c3),auth,async(_0x51505b,_0x377eb5)=>{const _0x51407e=a0_0x4a109c;try{const {name:_0x30db5d,address:_0x16e25e,mobile:_0x1463b7,email:_0x2a8a37,receivable:_0x55671b,payable:_0x2f53f9,contactperson:_0x5d6c6d,landline:_0x50ab6f}=_0x51505b['body'],_0x44b217=new customer({'name':_0x30db5d,'address':_0x16e25e,'mobile':_0x1463b7,'email':_0x2a8a37,'receivable':_0x55671b,'payable':_0x2f53f9,'contactperson':_0x5d6c6d,'landline':_0x50ab6f}),_0x3c07df=await _0x44b217[_0x51407e(0x16d)]();_0x51505b[_0x51407e(0x1a4)]('success',_0x51407e(0x195)),_0x377eb5[_0x51407e(0x1cd)](_0x51407e(0x1be));}catch(_0x4ee446){console[_0x51407e(0x183)](_0x4ee446);}}),router[a0_0x4a109c(0x1b9)](a0_0x4a109c(0x171),auth,async(_0x321fc0,_0x77598a)=>{const _0x5ebcb3=a0_0x4a109c;try{const {username:_0x13624c,email:_0x491fa1,role:_0x311d8f}=_0x321fc0[_0x5ebcb3(0x1a9)],_0x370cc3=_0x321fc0['user'],_0x1d63f3=await profile[_0x5ebcb3(0x163)]({'email':_0x370cc3[_0x5ebcb3(0x180)]}),_0x44db2f=await master_shop['find']();console[_0x5ebcb3(0x183)]('master',_0x44db2f);const _0x2352f6=_0x321fc0[_0x5ebcb3(0x185)]['id'],_0x1a6cdb=await customer[_0x5ebcb3(0x188)](_0x2352f6);if(_0x44db2f[0x0][_0x5ebcb3(0x1c9)]==_0x5ebcb3(0x1c0)){var _0x72a596=users[_0x5ebcb3(0x193)];console[_0x5ebcb3(0x183)](_0x72a596);}else{if(_0x44db2f[0x0][_0x5ebcb3(0x1c9)]==_0x5ebcb3(0x1a2))var _0x72a596=users[_0x5ebcb3(0x1a2)];else{if(_0x44db2f[0x0][_0x5ebcb3(0x1c9)]=='German')var _0x72a596=users['German'];else{if(_0x44db2f[0x0][_0x5ebcb3(0x1c9)]==_0x5ebcb3(0x1b3))var _0x72a596=users[_0x5ebcb3(0x1b3)];else{if(_0x44db2f[0x0][_0x5ebcb3(0x1c9)]==_0x5ebcb3(0x16a))var _0x72a596=users[_0x5ebcb3(0x16a)];else{if(_0x44db2f[0x0]['language']==_0x5ebcb3(0x1b1))var _0x72a596=users['Portuguese'];else{if(_0x44db2f[0x0][_0x5ebcb3(0x1c9)]==_0x5ebcb3(0x175))var _0x72a596=users[_0x5ebcb3(0x175)];else{if(_0x44db2f[0x0]['language']==_0x5ebcb3(0x186))var _0x72a596=users[_0x5ebcb3(0x1af)];}}}}}}}_0x77598a['render']('customer',{'success':_0x321fc0[_0x5ebcb3(0x1a4)]('success'),'errors':_0x321fc0['flash']('errors'),'role':_0x370cc3,'profile':_0x1d63f3,'user':_0x1a6cdb,'master_shop':_0x44db2f,'language':_0x72a596});}catch(_0x381366){console[_0x5ebcb3(0x183)](_0x381366);}}),router[a0_0x4a109c(0x181)](a0_0x4a109c(0x171),auth,async(_0x3f46a2,_0x3e8873)=>{const _0x3fe661=a0_0x4a109c;try{const _0x56c418=_0x3f46a2[_0x3fe661(0x185)]['id'],_0x528ec1=await customer[_0x3fe661(0x188)](_0x56c418),{name:_0x2565ec,address:_0x5bc3af,mobile:_0x3249c0,email:_0x316f52,receivable:_0x4fbcf3,payable:_0x34a06a,contactperson:_0x31dc01,landline:_0x108601}=_0x3f46a2[_0x3fe661(0x164)];_0x528ec1['name']=_0x2565ec,_0x528ec1[_0x3fe661(0x1bc)]=_0x5bc3af,_0x528ec1[_0x3fe661(0x1a5)]=_0x3249c0,_0x528ec1['email']=_0x316f52,_0x528ec1[_0x3fe661(0x18a)]=_0x4fbcf3,_0x528ec1['payable']=_0x34a06a,_0x528ec1[_0x3fe661(0x17c)]=_0x31dc01,_0x528ec1[_0x3fe661(0x1ac)]=_0x108601;const _0x337578=await _0x528ec1['save']();_0x3f46a2[_0x3fe661(0x1a4)](_0x3fe661(0x169),_0x3fe661(0x1c8)),_0x3e8873[_0x3fe661(0x1cd)](_0x3fe661(0x1be));}catch(_0x688b07){console[_0x3fe661(0x183)](_0x688b07);}}),router[a0_0x4a109c(0x1b9)](a0_0x4a109c(0x160),auth,async(_0xae3a5a,_0x26e3fb)=>{const _0x224329=a0_0x4a109c;try{const {username:_0x372d90,email:_0x139f3d,role:_0x38fef4}=_0xae3a5a[_0x224329(0x1a9)],_0x97e104=_0xae3a5a['user'],_0x9229de=await profile[_0x224329(0x163)]({'email':_0x97e104[_0x224329(0x180)]}),_0x1c946c=await master_shop[_0x224329(0x184)]();console[_0x224329(0x183)](_0x224329(0x19d),_0x1c946c),console[_0x224329(0x183)](_0xae3a5a['params']['id']);const _0x466fcc=await customer[_0x224329(0x163)]({'_id':_0xae3a5a['params']['id']});console[_0x224329(0x183)](_0x224329(0x1a6),_0x466fcc);const _0x1b0da0=await c_payment_data[_0x224329(0x184)]({'customer':_0x466fcc[_0x224329(0x1b4)]});console[_0x224329(0x183)](_0x1b0da0);const _0x6844b2=await c_payment_data[_0x224329(0x1ae)]([{'$match':{'customer':_0x466fcc[_0x224329(0x1b4)]}},{'$match':{'reason':'Sale'}},{'$group':{'_id':_0x224329(0x18b),'sum':{'$sum':_0x224329(0x1a0)}}}]);console[_0x224329(0x183)]('payable_sum',_0x6844b2);const _0x520cfb=await c_payment_data[_0x224329(0x1ae)]([{'$match':{'customer':_0x466fcc[_0x224329(0x1b4)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x224329(0x18b),'sum':{'$sum':_0x224329(0x1a0)}}}]);console[_0x224329(0x183)]('receivable_sum',_0x520cfb);if(_0x1c946c[0x0][_0x224329(0x1c9)]==_0x224329(0x1c0)){var _0x5cf83d=users[_0x224329(0x193)];console[_0x224329(0x183)](_0x5cf83d);}else{if(_0x1c946c[0x0][_0x224329(0x1c9)]==_0x224329(0x1a2))var _0x5cf83d=users['Hindi'];else{if(_0x1c946c[0x0][_0x224329(0x1c9)]=='German')var _0x5cf83d=users[_0x224329(0x177)];else{if(_0x1c946c[0x0]['language']==_0x224329(0x1b3))var _0x5cf83d=users['Spanish'];else{if(_0x1c946c[0x0][_0x224329(0x1c9)]=='French')var _0x5cf83d=users[_0x224329(0x16a)];else{if(_0x1c946c[0x0][_0x224329(0x1c9)]=='Portuguese\x20(BR)')var _0x5cf83d=users[_0x224329(0x174)];else{if(_0x1c946c[0x0]['language']=='Chinese')var _0x5cf83d=users[_0x224329(0x175)];else{if(_0x1c946c[0x0][_0x224329(0x1c9)]==_0x224329(0x186))var _0x5cf83d=users[_0x224329(0x1af)];}}}}}}}_0x26e3fb['render'](_0x224329(0x189),{'success':_0xae3a5a[_0x224329(0x1a4)](_0x224329(0x169)),'errors':_0xae3a5a['flash'](_0x224329(0x1ce)),'role':_0x97e104,'profile':_0x9229de,'payment':_0x1b0da0,'payable':_0x6844b2,'receivable':_0x520cfb,'master_shop':_0x1c946c,'language':_0x5cf83d});}catch(_0x298689){console[_0x224329(0x183)](_0x298689);}}),router[a0_0x4a109c(0x1b9)](a0_0x4a109c(0x1b0),auth,async(_0x10c0d3,_0x55a6e7)=>{const _0x440ed9=a0_0x4a109c;try{const _0x649ab8=new excelJS[(_0x440ed9(0x1cc))](),_0x5df71a=_0x649ab8[_0x440ed9(0x172)](_0x440ed9(0x19e));return _0x5df71a[_0x440ed9(0x19b)]=[{'header':'ID','key':_0x440ed9(0x176),'width':0xa},{'header':_0x440ed9(0x1cb),'key':_0x440ed9(0x1aa),'width':0xa},{'header':'SalesmanCode','key':_0x440ed9(0x18c),'width':0xa},{'header':_0x440ed9(0x1ab),'key':_0x440ed9(0x1ab),'width':0xa},{'header':_0x440ed9(0x1bc),'key':_0x440ed9(0x1bc),'width':0xa},{'header':_0x440ed9(0x1a5),'key':_0x440ed9(0x1a5),'width':0xa},{'header':_0x440ed9(0x180),'key':_0x440ed9(0x180),'width':0xa}],_0x55a6e7[_0x440ed9(0x18e)](_0x440ed9(0x17d),_0x440ed9(0x182)),_0x55a6e7[_0x440ed9(0x18e)](_0x440ed9(0x1c1),_0x440ed9(0x1b8)),_0x649ab8[_0x440ed9(0x1bd)][_0x440ed9(0x1a8)](_0x55a6e7)[_0x440ed9(0x17e)](()=>{_0x55a6e7['status'](0xc8);});}catch(_0x63f5f0){_0x55a6e7[_0x440ed9(0x18f)](0x190)[_0x440ed9(0x1ca)]({'errors':_0x63f5f0[_0x440ed9(0x1c7)]});}});function a0_0x1180(_0x34a11c,_0x1a99e2){const _0x2cc89d=a0_0x2cc8();return a0_0x1180=function(_0x1180ab,_0x5a1009){_0x1180ab=_0x1180ab-0x160;let _0xd289d7=_0x2cc89d[_0x1180ab];return _0xd289d7;},a0_0x1180(_0x34a11c,_0x1a99e2);}const storage1=multer[a0_0x4a109c(0x16c)]({'destination':(_0x26cd31,_0x5dfe6e,_0x450568)=>{const _0x52fe98=a0_0x4a109c;_0x450568(null,_0x52fe98(0x1a7));},'filename':(_0x184438,_0x1dfb24,_0xff7888)=>{const _0x436b59=a0_0x4a109c;_0xff7888(null,Date[_0x436b59(0x17f)]()+_0x1dfb24[_0x436b59(0x1bf)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x4a109c(0x161),auth,uploadMigrate[a0_0x4a109c(0x162)](a0_0x4a109c(0x198)),async(_0x27738f,_0x57bc1d)=>{const _0x481d5c=a0_0x4a109c,_0x4c31ad=_0x27738f[_0x481d5c(0x19a)][_0x481d5c(0x1ad)],_0x4688c9=await xlsx[_0x481d5c(0x19c)](_0x481d5c(0x1c5)+_0x4c31ad);let _0x298c1e=_0x4688c9[_0x481d5c(0x1c2)],_0x3a2667=xlsx[_0x481d5c(0x1b7)][_0x481d5c(0x17a)](_0x4688c9[_0x481d5c(0x1cf)][_0x298c1e[0x0]]);for(const _0x103b8b of _0x3a2667){const _0x40ce55=_0x103b8b['ID'],_0x39c576=_0x103b8b[_0x481d5c(0x1cb)],_0x2158de=_0x103b8b[_0x481d5c(0x166)],_0x3d7450=_0x103b8b[_0x481d5c(0x1ab)],_0x48d3fc=_0x103b8b[_0x481d5c(0x1bc)],_0xa4fc87=_0x103b8b[_0x481d5c(0x1a5)],_0x1ed974=_0x103b8b[_0x481d5c(0x180)];try{let _0x263f04=await customer[_0x481d5c(0x163)]({'name':_0x39c576});if(!_0x263f04){const _0x24c950=new customer({'name':_0x39c576,'ID':_0x40ce55,'SalesmanCode':_0x2158de,'SalesmanName':_0x3d7450,'address':_0x48d3fc,'mobile':_0xa4fc87,'email':_0x1ed974});_0x263f04=await _0x24c950[_0x481d5c(0x16d)](),_0x27738f[_0x481d5c(0x1a4)](_0x481d5c(0x169),_0x39c576+_0x481d5c(0x17b));}else _0x27738f[_0x481d5c(0x1a4)]('error',_0x39c576+_0x481d5c(0x187));}catch(_0x291eb5){_0x57bc1d[_0x481d5c(0x18f)](0x1f4)['json']({'proderror':_0x291eb5[_0x481d5c(0x1c7)],'aproduct':ProductName});}}_0x57bc1d[_0x481d5c(0x1cd)](_0x481d5c(0x1be));}),module[a0_0x4a109c(0x16e)]=router;