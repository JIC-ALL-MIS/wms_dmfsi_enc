const a0_0x10aae8=a0_0x29a2;(function(_0x35016f,_0x46fe6b){const _0x55837a=a0_0x29a2,_0x1822b2=_0x35016f();while(!![]){try{const _0x5d1ae3=-parseInt(_0x55837a(0xca))/0x1*(parseInt(_0x55837a(0xf1))/0x2)+parseInt(_0x55837a(0x8b))/0x3*(-parseInt(_0x55837a(0xaa))/0x4)+-parseInt(_0x55837a(0x8a))/0x5*(parseInt(_0x55837a(0xcb))/0x6)+parseInt(_0x55837a(0x89))/0x7*(-parseInt(_0x55837a(0xb5))/0x8)+parseInt(_0x55837a(0xdd))/0x9+-parseInt(_0x55837a(0xd1))/0xa*(-parseInt(_0x55837a(0xbf))/0xb)+parseInt(_0x55837a(0xab))/0xc;if(_0x5d1ae3===_0x46fe6b)break;else _0x1822b2['push'](_0x1822b2['shift']());}catch(_0x382abf){_0x1822b2['push'](_0x1822b2['shift']());}}}(a0_0xe325,0xe335a));function a0_0x29a2(_0x40eb4b,_0x54b76e){const _0xe32520=a0_0xe325();return a0_0x29a2=function(_0x29a260,_0x372639){_0x29a260=_0x29a260-0x89;let _0x955e7e=_0xe32520[_0x29a260];return _0x955e7e;},a0_0x29a2(_0x40eb4b,_0x54b76e);}const express=require(a0_0x10aae8(0xcd)),app=express(),router=express[a0_0x10aae8(0x9f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x10aae8(0xa9)),auth=require(a0_0x10aae8(0x99)),users=require(a0_0x10aae8(0xa5)),excelJS=require(a0_0x10aae8(0xbc)),xlsx=require('xlsx'),multer=require(a0_0x10aae8(0xea));router[a0_0x10aae8(0x92)](a0_0x10aae8(0xb8),auth,async(_0x4a0223,_0x431060)=>{const _0x2675a8=a0_0x10aae8;try{const {username:_0x42707c,email:_0x3b0ced,role:_0x313569}=_0x4a0223['user'],_0x348f6d=_0x4a0223[_0x2675a8(0x97)],_0x4f17db=await profile[_0x2675a8(0xba)]({'email':_0x348f6d[_0x2675a8(0xdc)]}),_0x34bf44=await master_shop['find']();console['log'](_0x2675a8(0x9c),_0x34bf44);const _0x49082a=await customer[_0x2675a8(0xe3)](),_0x6c4314=await customer[_0x2675a8(0xe9)]([{'$lookup':{'from':'c_payments','localField':_0x2675a8(0xc2),'foreignField':_0x2675a8(0xe7),'as':_0x2675a8(0x9a)}}]);console['log'](_0x6c4314);const _0x3af72d=_0x6c4314[_0x2675a8(0xa8)](_0x518d1b=>{const _0x605cb3=_0x2675a8;console[_0x605cb3(0xd3)](_0x605cb3(0x94),_0x518d1b);var _0x470ac8=0x0,_0x2e4820=0x0;return _0x518d1b[_0x605cb3(0x9a)][_0x605cb3(0xf3)](_0xc41345=>{const _0x4f371e=_0x605cb3;console[_0x4f371e(0xd3)](_0x4f371e(0xec),_0xc41345),_0xc41345['reason']==_0x4f371e(0x9e)?_0x470ac8+=_0xc41345['amount']:_0x2e4820+=_0xc41345['amount'];}),_0x518d1b[_0x605cb3(0xc8)]=parseFloat(_0x470ac8)+0x0,_0x518d1b[_0x605cb3(0xd9)]=parseFloat(_0x2e4820)+0x0,_0x518d1b;});console[_0x2675a8(0xd3)](_0x2675a8(0xe8),_0x3af72d);if(_0x34bf44[0x0]['language']==_0x2675a8(0xe4)){var _0x5cf49d=users[_0x2675a8(0xc1)];console[_0x2675a8(0xd3)](_0x5cf49d);}else{if(_0x34bf44[0x0]['language']==_0x2675a8(0xb7))var _0x5cf49d=users[_0x2675a8(0xb7)];else{if(_0x34bf44[0x0][_0x2675a8(0xbe)]==_0x2675a8(0xd4))var _0x5cf49d=users[_0x2675a8(0xd4)];else{if(_0x34bf44[0x0][_0x2675a8(0xbe)]==_0x2675a8(0xd6))var _0x5cf49d=users[_0x2675a8(0xd6)];else{if(_0x34bf44[0x0][_0x2675a8(0xbe)]==_0x2675a8(0xde))var _0x5cf49d=users[_0x2675a8(0xde)];else{if(_0x34bf44[0x0][_0x2675a8(0xbe)]==_0x2675a8(0x96))var _0x5cf49d=users[_0x2675a8(0xa7)];else{if(_0x34bf44[0x0]['language']==_0x2675a8(0xb0))var _0x5cf49d=users[_0x2675a8(0xb0)];else{if(_0x34bf44[0x0][_0x2675a8(0xbe)]==_0x2675a8(0xa2))var _0x5cf49d=users[_0x2675a8(0xa1)];}}}}}}}_0x431060[_0x2675a8(0xa6)](_0x2675a8(0xe7),{'success':_0x4a0223[_0x2675a8(0xad)](_0x2675a8(0xee)),'errors':_0x4a0223[_0x2675a8(0xad)](_0x2675a8(0xc7)),'user':_0x49082a,'role':_0x348f6d,'profile':_0x4f17db,'payment':_0x3af72d,'master_shop':_0x34bf44,'language':_0x5cf49d});}catch(_0x4eaed8){console[_0x2675a8(0xd3)](_0x4eaed8);}}),router[a0_0x10aae8(0xc0)](a0_0x10aae8(0xb8),auth,async(_0x5c12fe,_0x4e2cb1)=>{const _0x3a8d56=a0_0x10aae8;try{const {name:_0x2649af,address:_0x4b6c8d,mobile:_0x5b0c81,email:_0x1b1365,receivable:_0x46272a,payable:_0x27851a,contactperson:_0x30f849,landline:_0x45d82a}=_0x5c12fe[_0x3a8d56(0xc9)],_0x53e272=new customer({'name':_0x2649af,'address':_0x4b6c8d,'mobile':_0x5b0c81,'email':_0x1b1365,'receivable':_0x46272a,'payable':_0x27851a,'contactperson':_0x30f849,'landline':_0x45d82a}),_0x291196=await _0x53e272[_0x3a8d56(0xda)]();_0x5c12fe['flash']('success','customer\x20add\x20successfully'),_0x4e2cb1['redirect'](_0x3a8d56(0xb4));}catch(_0x4b112d){console[_0x3a8d56(0xd3)](_0x4b112d);}}),router['get'](a0_0x10aae8(0xae),auth,async(_0x5eb865,_0x1744e8)=>{const _0xdb9dd4=a0_0x10aae8;try{const {username:_0x4a5671,email:_0x4dae51,role:_0x406312}=_0x5eb865[_0xdb9dd4(0x97)],_0x4ee73a=_0x5eb865['user'],_0x124198=await profile['findOne']({'email':_0x4ee73a['email']}),_0x3357be=await master_shop[_0xdb9dd4(0xe3)]();console[_0xdb9dd4(0xd3)](_0xdb9dd4(0x9c),_0x3357be);const _0x47558d=_0x5eb865[_0xdb9dd4(0xd2)]['id'],_0x19e43f=await customer[_0xdb9dd4(0xd7)](_0x47558d);if(_0x3357be[0x0]['language']==_0xdb9dd4(0xe4)){var _0x46f2d9=users['English'];console[_0xdb9dd4(0xd3)](_0x46f2d9);}else{if(_0x3357be[0x0][_0xdb9dd4(0xbe)]=='Hindi')var _0x46f2d9=users['Hindi'];else{if(_0x3357be[0x0][_0xdb9dd4(0xbe)]==_0xdb9dd4(0xd4))var _0x46f2d9=users[_0xdb9dd4(0xd4)];else{if(_0x3357be[0x0]['language']==_0xdb9dd4(0xd6))var _0x46f2d9=users[_0xdb9dd4(0xd6)];else{if(_0x3357be[0x0][_0xdb9dd4(0xbe)]==_0xdb9dd4(0xde))var _0x46f2d9=users[_0xdb9dd4(0xde)];else{if(_0x3357be[0x0][_0xdb9dd4(0xbe)]==_0xdb9dd4(0x96))var _0x46f2d9=users[_0xdb9dd4(0xa7)];else{if(_0x3357be[0x0]['language']==_0xdb9dd4(0xb0))var _0x46f2d9=users[_0xdb9dd4(0xb0)];else{if(_0x3357be[0x0][_0xdb9dd4(0xbe)]==_0xdb9dd4(0xa2))var _0x46f2d9=users[_0xdb9dd4(0xa1)];}}}}}}}_0x1744e8['render'](_0xdb9dd4(0xe7),{'success':_0x5eb865[_0xdb9dd4(0xad)](_0xdb9dd4(0xee)),'errors':_0x5eb865[_0xdb9dd4(0xad)](_0xdb9dd4(0xc7)),'role':_0x4ee73a,'profile':_0x124198,'user':_0x19e43f,'master_shop':_0x3357be,'language':_0x46f2d9});}catch(_0x46ea30){console[_0xdb9dd4(0xd3)](_0x46ea30);}}),router['post'](a0_0x10aae8(0xae),auth,async(_0x36633f,_0x50628f)=>{const _0x40b436=a0_0x10aae8;try{const _0xcabaf2=_0x36633f[_0x40b436(0xd2)]['id'],_0x3db20c=await customer[_0x40b436(0xd7)](_0xcabaf2),{name:_0x1df3c7,address:_0x28d248,mobile:_0x1247fa,email:_0x2cd023,receivable:_0x51f3d2,payable:_0xce55b7,contactperson:_0x2bc918,landline:_0xa52aec}=_0x36633f['body'];_0x3db20c[_0x40b436(0xc2)]=_0x1df3c7,_0x3db20c['address']=_0x28d248,_0x3db20c[_0x40b436(0xbd)]=_0x1247fa,_0x3db20c[_0x40b436(0xdc)]=_0x2cd023,_0x3db20c[_0x40b436(0xe2)]=_0x51f3d2,_0x3db20c['payable']=_0xce55b7,_0x3db20c[_0x40b436(0xd0)]=_0x2bc918,_0x3db20c[_0x40b436(0x8c)]=_0xa52aec;const _0x5cf29c=await _0x3db20c['save']();_0x36633f[_0x40b436(0xad)]('success','customer\x20update\x20successfully'),_0x50628f['redirect'](_0x40b436(0xb4));}catch(_0xbe51d6){console['log'](_0xbe51d6);}}),router[a0_0x10aae8(0x92)]('/view/payment/:id',auth,async(_0x469c90,_0x11dd76)=>{const _0x57b50e=a0_0x10aae8;try{const {username:_0x5549ee,email:_0x573ce3,role:_0x4b3521}=_0x469c90['user'],_0x254ff5=_0x469c90['user'],_0x15d7af=await profile[_0x57b50e(0xba)]({'email':_0x254ff5[_0x57b50e(0xdc)]}),_0x28dd7a=await master_shop['find']();console[_0x57b50e(0xd3)](_0x57b50e(0x9c),_0x28dd7a),console[_0x57b50e(0xd3)](_0x469c90['params']['id']);const _0x332e9c=await customer[_0x57b50e(0xba)]({'_id':_0x469c90['params']['id']});console[_0x57b50e(0xd3)](_0x57b50e(0xc6),_0x332e9c);const _0x37869e=await c_payment_data[_0x57b50e(0xe3)]({'customer':_0x332e9c[_0x57b50e(0xc2)]});console['log'](_0x37869e);const _0xbdbec4=await c_payment_data[_0x57b50e(0xe9)]([{'$match':{'customer':_0x332e9c[_0x57b50e(0xc2)]}},{'$match':{'reason':_0x57b50e(0x9e)}},{'$group':{'_id':_0x57b50e(0x8f),'sum':{'$sum':'$amount'}}}]);console[_0x57b50e(0xd3)](_0x57b50e(0xf4),_0xbdbec4);const _0x5ea852=await c_payment_data['aggregate']([{'$match':{'customer':_0x332e9c[_0x57b50e(0xc2)]}},{'$match':{'reason':_0x57b50e(0xcf)}},{'$group':{'_id':_0x57b50e(0x8f),'sum':{'$sum':_0x57b50e(0xd5)}}}]);console[_0x57b50e(0xd3)](_0x57b50e(0xdf),_0x5ea852);if(_0x28dd7a[0x0]['language']==_0x57b50e(0xe4)){var _0x5bd475=users[_0x57b50e(0xc1)];console['log'](_0x5bd475);}else{if(_0x28dd7a[0x0]['language']=='Hindi')var _0x5bd475=users[_0x57b50e(0xb7)];else{if(_0x28dd7a[0x0]['language']==_0x57b50e(0xd4))var _0x5bd475=users[_0x57b50e(0xd4)];else{if(_0x28dd7a[0x0]['language']=='Spanish')var _0x5bd475=users['Spanish'];else{if(_0x28dd7a[0x0][_0x57b50e(0xbe)]=='French')var _0x5bd475=users[_0x57b50e(0xde)];else{if(_0x28dd7a[0x0][_0x57b50e(0xbe)]==_0x57b50e(0x96))var _0x5bd475=users[_0x57b50e(0xa7)];else{if(_0x28dd7a[0x0][_0x57b50e(0xbe)]==_0x57b50e(0xb0))var _0x5bd475=users['Chinese'];else{if(_0x28dd7a[0x0]['language']==_0x57b50e(0xa2))var _0x5bd475=users[_0x57b50e(0xa1)];}}}}}}}_0x11dd76['render'](_0x57b50e(0x93),{'success':_0x469c90['flash'](_0x57b50e(0xee)),'errors':_0x469c90[_0x57b50e(0xad)]('errors'),'role':_0x254ff5,'profile':_0x15d7af,'payment':_0x37869e,'payable':_0xbdbec4,'receivable':_0x5ea852,'master_shop':_0x28dd7a,'language':_0x5bd475});}catch(_0xcc100a){console[_0x57b50e(0xd3)](_0xcc100a);}}),router['get']('/products_export_migrate_file',auth,async(_0x294795,_0x48e93)=>{const _0x515d3d=a0_0x10aae8;try{const _0x14978c=new excelJS[(_0x515d3d(0x91))](),_0x2dae78=_0x14978c[_0x515d3d(0xa3)](_0x515d3d(0xa0));return _0x2dae78[_0x515d3d(0xb3)]=[{'header':'ID','key':_0x515d3d(0xf0),'width':0xa},{'header':_0x515d3d(0x95),'key':_0x515d3d(0x8e),'width':0xa},{'header':_0x515d3d(0xac),'key':'PUnits','width':0xa},{'header':_0x515d3d(0xc5),'key':'SalesmanName','width':0xa},{'header':_0x515d3d(0xeb),'key':'address','width':0xa},{'header':_0x515d3d(0xbd),'key':_0x515d3d(0xbd),'width':0xa},{'header':_0x515d3d(0xdc),'key':'email','width':0xa}],_0x48e93[_0x515d3d(0xe1)]('Content-Type',_0x515d3d(0xaf)),_0x48e93[_0x515d3d(0xe1)]('Content-Disposition','attachment;\x20filename=customer_Migration_File.xlsx'),_0x14978c[_0x515d3d(0xb1)]['write'](_0x48e93)['then'](()=>{const _0xea7c66=_0x515d3d;_0x48e93[_0xea7c66(0xb2)](0xc8);});}catch(_0x349493){_0x48e93[_0x515d3d(0xb2)](0x190)[_0x515d3d(0xe0)]({'errors':_0x349493[_0x515d3d(0xe5)]});}});const storage1=multer[a0_0x10aae8(0x9d)]({'destination':(_0x304634,_0x4c8f6b,_0x1ae7de)=>{const _0x5eb811=a0_0x10aae8;_0x1ae7de(null,_0x5eb811(0xbb));},'filename':(_0xb015e,_0x24bc0c,_0x2fb71c)=>{const _0xb153f6=a0_0x10aae8;_0x2fb71c(null,Date[_0xb153f6(0xb6)]()+_0x24bc0c[_0xb153f6(0xf2)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x10aae8(0xcc),auth,uploadMigrate[a0_0x10aae8(0xce)](a0_0x10aae8(0xc4)),async(_0x56f5fd,_0x17dc11)=>{const _0x2511bb=a0_0x10aae8,_0x2b41b5=_0x56f5fd[_0x2511bb(0x90)][_0x2511bb(0xa4)],_0x4f8f36=await xlsx[_0x2511bb(0xe6)](_0x2511bb(0x98)+_0x2b41b5);let _0x2e9c6d=_0x4f8f36[_0x2511bb(0x8d)],_0x22c3ea=xlsx['utils']['sheet_to_json'](_0x4f8f36[_0x2511bb(0xed)][_0x2e9c6d[0x0]]);for(const _0xf8e9cc of _0x22c3ea){const _0x2e2344=_0xf8e9cc['ID'],_0x89bae0=_0xf8e9cc[_0x2511bb(0x95)],_0x33f80e=_0xf8e9cc[_0x2511bb(0xac)],_0x4e47d7=_0xf8e9cc[_0x2511bb(0xc5)],_0x4c0d41=_0xf8e9cc['address'],_0xeff470=_0xf8e9cc[_0x2511bb(0xbd)],_0x3ebaca=_0xf8e9cc[_0x2511bb(0xdc)];try{let _0x277881=await customer[_0x2511bb(0xba)]({'name':_0x89bae0});if(!_0x277881){const _0x12a05a=new customer({'name':_0x89bae0,'ID':_0x2e2344,'SalesmanCode':_0x33f80e,'SalesmanName':_0x4e47d7,'address':_0x4c0d41,'mobile':_0xeff470,'email':_0x3ebaca});_0x277881=await _0x12a05a['save'](),_0x56f5fd[_0x2511bb(0xad)]('success',_0x89bae0+_0x2511bb(0xef));}else _0x56f5fd['flash'](_0x2511bb(0x9b),_0x89bae0+_0x2511bb(0xb9));}catch(_0x13ac7e){_0x17dc11[_0x2511bb(0xb2)](0x1f4)[_0x2511bb(0xc3)]({'proderror':_0x13ac7e['message'],'aproduct':ProductName});}}_0x17dc11[_0x2511bb(0xd8)](_0x2511bb(0xb4));}),module[a0_0x10aae8(0xdb)]=router;function a0_0xe325(){const _0x4ff2fa=['payable_sum','116753jmEycL','130rdqFDE','480975GlmpBV','landline','SheetNames','PBrands','$reason','file','Workbook','get','customer_payment','data','Name','Portuguese\x20(BR)','user','public/Migration/','../middleware/auth','customer_docs','error','master','diskStorage','Sale','Router','Customers','Arabic','Arabic\x20(ae)','addWorksheet','filename','../public/language/languages.json','render','Portuguese','map','../models/all_models','44xwvHCO','34974756xpOCdy','SalesmanCode','flash','/view/:id','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Chinese','xlsx','status','columns','/customer/view','248tITyWn','now','Hindi','/view','\x20Failed','findOne','public/Migration','exceljs','mobile','language','88yilLlD','post','English','name','json','customer_product_fule','SalesmanName','customer_data','errors','sale','body','150DuZQli','165834LnhMwV','/customer_import_migrate_file','express','single','Sale\x20Return','contactperson','1939160wnnIgA','params','log','German','$amount','Spanish','findById','redirect','sale_return','save','exports','email','8171073QpQBpB','French','receivable_sum','send','setHeader','receivable','find','English\x20(US)','message','readFile','customer','payment_data','aggregate','multer','address','element','Sheets','success','\x20added\x20successfully','PName','19252SlPaBX','originalname','forEach'];a0_0xe325=function(){return _0x4ff2fa;};return a0_0xe325();}