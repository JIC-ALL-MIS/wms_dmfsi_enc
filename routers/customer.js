const a0_0xf3991c=a0_0x8c6b;(function(_0x433a2f,_0x19a624){const _0x2a474b=a0_0x8c6b,_0x44ea58=_0x433a2f();while(!![]){try{const _0x3c5714=-parseInt(_0x2a474b(0x1d0))/0x1*(-parseInt(_0x2a474b(0x213))/0x2)+-parseInt(_0x2a474b(0x207))/0x3*(parseInt(_0x2a474b(0x1f4))/0x4)+-parseInt(_0x2a474b(0x1ff))/0x5+parseInt(_0x2a474b(0x1f5))/0x6+-parseInt(_0x2a474b(0x20e))/0x7*(parseInt(_0x2a474b(0x204))/0x8)+-parseInt(_0x2a474b(0x1cc))/0x9*(parseInt(_0x2a474b(0x20c))/0xa)+parseInt(_0x2a474b(0x1c6))/0xb;if(_0x3c5714===_0x19a624)break;else _0x44ea58['push'](_0x44ea58['shift']());}catch(_0x2632f5){_0x44ea58['push'](_0x44ea58['shift']());}}}(a0_0x3922,0xeef8e));const express=require(a0_0xf3991c(0x1d8)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0xf3991c(0x1dd)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0xf3991c(0x20f)),xlsx=require('xlsx'),multer=require(a0_0xf3991c(0x1e6));function a0_0x8c6b(_0x6c5807,_0x4d4cf6){const _0x39226d=a0_0x3922();return a0_0x8c6b=function(_0x8c6bf5,_0x48da3c){_0x8c6bf5=_0x8c6bf5-0x1b8;let _0x2f81c7=_0x39226d[_0x8c6bf5];return _0x2f81c7;},a0_0x8c6b(_0x6c5807,_0x4d4cf6);}function a0_0x3922(){const _0x39d544=['customer','message','/view/payment/:id','40534483LyGKdx','Spanish','Customers','customer\x20update\x20successfully','Arabic','contactperson','153UIHoXt','attachment;\x20filename=customer_Migration_File.xlsx','public/Migration/','Portuguese','925834EFwnMX','French','errors','map','Arabic\x20(ae)','Name','language','post','express','findOne','now','English','amount','../models/all_models','German','/customer/view','filename','/view/:id','name','forEach','SalesmanCode','success','multer','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','render','customer_product_fule','/customer_import_migrate_file','Hindi','/products_export_migrate_file','PName','columns','find','sheet_to_json','Sale','customer_docs','SalesmanName','16IAcATb','3302466swGIkH','get','\x20added\x20successfully','log','send','sale_return','save','payment_data','address','single','6762985YzoVqr','params','PUnits','payable','data','72TFPCDm','master','SheetNames','866166VwBcTt','payable_sum','body','error','English\x20(US)','839420megPtR','exports','192787GTsGZz','exceljs','mobile','originalname','landline','2gXkwFg','Portuguese\x20(BR)','reason','status','flash','sale','readFile','customer_data','receivable','addWorksheet','Content-Disposition','aggregate','Chinese','$reason','setHeader','Sheets','diskStorage','$amount','element','public/Migration','json','email','user','xlsx','/view','findById'];a0_0x3922=function(){return _0x39d544;};return a0_0x3922();}router['get'](a0_0xf3991c(0x1c1),auth,async(_0x2a42e7,_0x2cd48f)=>{const _0x39c351=a0_0xf3991c;try{const {username:_0x3e9917,email:_0x1ccb98,role:_0xdba2d}=_0x2a42e7[_0x39c351(0x1bf)],_0x3e87aa=_0x2a42e7['user'],_0x46968d=await profile[_0x39c351(0x1d9)]({'email':_0x3e87aa[_0x39c351(0x1be)]}),_0x1b62af=await master_shop[_0x39c351(0x1ef)]();console[_0x39c351(0x1f8)](_0x39c351(0x205),_0x1b62af);const _0x3dfe54=await customer[_0x39c351(0x1ef)](),_0x4bf366=await customer[_0x39c351(0x21e)]([{'$lookup':{'from':'c_payments','localField':_0x39c351(0x1e2),'foreignField':_0x39c351(0x1c3),'as':_0x39c351(0x1f2)}}]);console[_0x39c351(0x1f8)](_0x4bf366);const _0x22cfc9=_0x4bf366[_0x39c351(0x1d3)](_0x31edfe=>{const _0x539b94=_0x39c351;console[_0x539b94(0x1f8)](_0x539b94(0x203),_0x31edfe);var _0x17c44b=0x0,_0x53a6de=0x0;return _0x31edfe[_0x539b94(0x1f2)][_0x539b94(0x1e3)](_0x4e3c80=>{const _0xf9877a=_0x539b94;console[_0xf9877a(0x1f8)](_0xf9877a(0x1bb),_0x4e3c80),_0x4e3c80[_0xf9877a(0x215)]==_0xf9877a(0x1f1)?_0x17c44b+=_0x4e3c80[_0xf9877a(0x1dc)]:_0x53a6de+=_0x4e3c80['amount'];}),_0x31edfe[_0x539b94(0x218)]=parseFloat(_0x17c44b)+0x0,_0x31edfe[_0x539b94(0x1fa)]=parseFloat(_0x53a6de)+0x0,_0x31edfe;});console['log'](_0x39c351(0x1fc),_0x22cfc9);if(_0x1b62af[0x0][_0x39c351(0x1d6)]==_0x39c351(0x20b)){var _0x17d4db=users[_0x39c351(0x1db)];console['log'](_0x17d4db);}else{if(_0x1b62af[0x0][_0x39c351(0x1d6)]==_0x39c351(0x1eb))var _0x17d4db=users[_0x39c351(0x1eb)];else{if(_0x1b62af[0x0]['language']==_0x39c351(0x1de))var _0x17d4db=users[_0x39c351(0x1de)];else{if(_0x1b62af[0x0][_0x39c351(0x1d6)]==_0x39c351(0x1c7))var _0x17d4db=users[_0x39c351(0x1c7)];else{if(_0x1b62af[0x0][_0x39c351(0x1d6)]==_0x39c351(0x1d1))var _0x17d4db=users[_0x39c351(0x1d1)];else{if(_0x1b62af[0x0][_0x39c351(0x1d6)]=='Portuguese\x20(BR)')var _0x17d4db=users[_0x39c351(0x1cf)];else{if(_0x1b62af[0x0]['language']==_0x39c351(0x21f))var _0x17d4db=users[_0x39c351(0x21f)];else{if(_0x1b62af[0x0][_0x39c351(0x1d6)]==_0x39c351(0x1d4))var _0x17d4db=users[_0x39c351(0x1ca)];}}}}}}}_0x2cd48f[_0x39c351(0x1e8)](_0x39c351(0x1c3),{'success':_0x2a42e7['flash'](_0x39c351(0x1e5)),'errors':_0x2a42e7[_0x39c351(0x217)]('errors'),'user':_0x3dfe54,'role':_0x3e87aa,'profile':_0x46968d,'payment':_0x22cfc9,'master_shop':_0x1b62af,'language':_0x17d4db});}catch(_0x120ccd){console[_0x39c351(0x1f8)](_0x120ccd);}}),router[a0_0xf3991c(0x1d7)](a0_0xf3991c(0x1c1),auth,async(_0x176e53,_0xd3764f)=>{const _0x259021=a0_0xf3991c;try{const {name:_0x2c9e0a,address:_0x1e65f4,mobile:_0x1b5e0a,email:_0xed79b,receivable:_0x562821,payable:_0x58a8a6,contactperson:_0x1a9091,landline:_0x355659}=_0x176e53[_0x259021(0x209)],_0x4ed03f=new customer({'name':_0x2c9e0a,'address':_0x1e65f4,'mobile':_0x1b5e0a,'email':_0xed79b,'receivable':_0x562821,'payable':_0x58a8a6,'contactperson':_0x1a9091,'landline':_0x355659}),_0x31870d=await _0x4ed03f[_0x259021(0x1fb)]();_0x176e53[_0x259021(0x217)]('success','customer\x20add\x20successfully'),_0xd3764f['redirect']('/customer/view');}catch(_0x28ce35){console[_0x259021(0x1f8)](_0x28ce35);}}),router[a0_0xf3991c(0x1f6)](a0_0xf3991c(0x1e1),auth,async(_0x397691,_0x4e08f4)=>{const _0x3e9e19=a0_0xf3991c;try{const {username:_0x125afd,email:_0x1f2904,role:_0x1bb6cb}=_0x397691[_0x3e9e19(0x1bf)],_0x59c151=_0x397691[_0x3e9e19(0x1bf)],_0x219f55=await profile[_0x3e9e19(0x1d9)]({'email':_0x59c151[_0x3e9e19(0x1be)]}),_0x299ded=await master_shop[_0x3e9e19(0x1ef)]();console[_0x3e9e19(0x1f8)](_0x3e9e19(0x205),_0x299ded);const _0x23f320=_0x397691[_0x3e9e19(0x200)]['id'],_0x4d8caa=await customer['findById'](_0x23f320);if(_0x299ded[0x0][_0x3e9e19(0x1d6)]==_0x3e9e19(0x20b)){var _0x34dce2=users['English'];console[_0x3e9e19(0x1f8)](_0x34dce2);}else{if(_0x299ded[0x0][_0x3e9e19(0x1d6)]==_0x3e9e19(0x1eb))var _0x34dce2=users[_0x3e9e19(0x1eb)];else{if(_0x299ded[0x0][_0x3e9e19(0x1d6)]==_0x3e9e19(0x1de))var _0x34dce2=users[_0x3e9e19(0x1de)];else{if(_0x299ded[0x0][_0x3e9e19(0x1d6)]=='Spanish')var _0x34dce2=users[_0x3e9e19(0x1c7)];else{if(_0x299ded[0x0][_0x3e9e19(0x1d6)]==_0x3e9e19(0x1d1))var _0x34dce2=users['French'];else{if(_0x299ded[0x0][_0x3e9e19(0x1d6)]==_0x3e9e19(0x214))var _0x34dce2=users[_0x3e9e19(0x1cf)];else{if(_0x299ded[0x0]['language']==_0x3e9e19(0x21f))var _0x34dce2=users[_0x3e9e19(0x21f)];else{if(_0x299ded[0x0][_0x3e9e19(0x1d6)]=='Arabic\x20(ae)')var _0x34dce2=users[_0x3e9e19(0x1ca)];}}}}}}}_0x4e08f4['render'](_0x3e9e19(0x1c3),{'success':_0x397691[_0x3e9e19(0x217)]('success'),'errors':_0x397691['flash'](_0x3e9e19(0x1d2)),'role':_0x59c151,'profile':_0x219f55,'user':_0x4d8caa,'master_shop':_0x299ded,'language':_0x34dce2});}catch(_0x55b1a3){console[_0x3e9e19(0x1f8)](_0x55b1a3);}}),router[a0_0xf3991c(0x1d7)](a0_0xf3991c(0x1e1),auth,async(_0x497f9b,_0x2d747d)=>{const _0x527117=a0_0xf3991c;try{const _0x271bee=_0x497f9b[_0x527117(0x200)]['id'],_0x2a4c6a=await customer[_0x527117(0x1c2)](_0x271bee),{name:_0x4a27c4,address:_0x1e7f99,mobile:_0x41093a,email:_0x17cc67,receivable:_0x4d6ce1,payable:_0x18700c,contactperson:_0x47aa18,landline:_0x522c3e}=_0x497f9b[_0x527117(0x209)];_0x2a4c6a[_0x527117(0x1e2)]=_0x4a27c4,_0x2a4c6a['address']=_0x1e7f99,_0x2a4c6a[_0x527117(0x210)]=_0x41093a,_0x2a4c6a['email']=_0x17cc67,_0x2a4c6a[_0x527117(0x21b)]=_0x4d6ce1,_0x2a4c6a[_0x527117(0x202)]=_0x18700c,_0x2a4c6a[_0x527117(0x1cb)]=_0x47aa18,_0x2a4c6a[_0x527117(0x212)]=_0x522c3e;const _0x407081=await _0x2a4c6a['save']();_0x497f9b['flash']('success',_0x527117(0x1c9)),_0x2d747d['redirect']('/customer/view');}catch(_0x17327f){console[_0x527117(0x1f8)](_0x17327f);}}),router[a0_0xf3991c(0x1f6)](a0_0xf3991c(0x1c5),auth,async(_0x38243b,_0x4af211)=>{const _0x255bec=a0_0xf3991c;try{const {username:_0x39c9f7,email:_0x392da5,role:_0x1280a9}=_0x38243b[_0x255bec(0x1bf)],_0x454991=_0x38243b[_0x255bec(0x1bf)],_0x1cf76d=await profile[_0x255bec(0x1d9)]({'email':_0x454991[_0x255bec(0x1be)]}),_0x34e09b=await master_shop[_0x255bec(0x1ef)]();console[_0x255bec(0x1f8)](_0x255bec(0x205),_0x34e09b),console['log'](_0x38243b[_0x255bec(0x200)]['id']);const _0x310fa3=await customer['findOne']({'_id':_0x38243b[_0x255bec(0x200)]['id']});console['log'](_0x255bec(0x21a),_0x310fa3);const _0x5067fc=await c_payment_data[_0x255bec(0x1ef)]({'customer':_0x310fa3['name']});console[_0x255bec(0x1f8)](_0x5067fc);const _0x295078=await c_payment_data['aggregate']([{'$match':{'customer':_0x310fa3[_0x255bec(0x1e2)]}},{'$match':{'reason':'Sale'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x255bec(0x1ba)}}}]);console[_0x255bec(0x1f8)](_0x255bec(0x208),_0x295078);const _0x15d9b0=await c_payment_data[_0x255bec(0x21e)]([{'$match':{'customer':_0x310fa3[_0x255bec(0x1e2)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x255bec(0x220),'sum':{'$sum':'$amount'}}}]);console[_0x255bec(0x1f8)]('receivable_sum',_0x15d9b0);if(_0x34e09b[0x0]['language']==_0x255bec(0x20b)){var _0x259369=users['English'];console[_0x255bec(0x1f8)](_0x259369);}else{if(_0x34e09b[0x0][_0x255bec(0x1d6)]=='Hindi')var _0x259369=users[_0x255bec(0x1eb)];else{if(_0x34e09b[0x0]['language']==_0x255bec(0x1de))var _0x259369=users[_0x255bec(0x1de)];else{if(_0x34e09b[0x0]['language']==_0x255bec(0x1c7))var _0x259369=users[_0x255bec(0x1c7)];else{if(_0x34e09b[0x0][_0x255bec(0x1d6)]=='French')var _0x259369=users[_0x255bec(0x1d1)];else{if(_0x34e09b[0x0][_0x255bec(0x1d6)]==_0x255bec(0x214))var _0x259369=users[_0x255bec(0x1cf)];else{if(_0x34e09b[0x0][_0x255bec(0x1d6)]==_0x255bec(0x21f))var _0x259369=users[_0x255bec(0x21f)];else{if(_0x34e09b[0x0][_0x255bec(0x1d6)]==_0x255bec(0x1d4))var _0x259369=users[_0x255bec(0x1ca)];}}}}}}}_0x4af211[_0x255bec(0x1e8)]('customer_payment',{'success':_0x38243b[_0x255bec(0x217)](_0x255bec(0x1e5)),'errors':_0x38243b[_0x255bec(0x217)](_0x255bec(0x1d2)),'role':_0x454991,'profile':_0x1cf76d,'payment':_0x5067fc,'payable':_0x295078,'receivable':_0x15d9b0,'master_shop':_0x34e09b,'language':_0x259369});}catch(_0xdaa8cf){console[_0x255bec(0x1f8)](_0xdaa8cf);}}),router['get'](a0_0xf3991c(0x1ec),auth,async(_0x2cefaf,_0x106994)=>{const _0x625abe=a0_0xf3991c;try{const _0x3d5500=new excelJS['Workbook'](),_0x56144b=_0x3d5500[_0x625abe(0x21c)](_0x625abe(0x1c8));return _0x56144b[_0x625abe(0x1ee)]=[{'header':'ID','key':_0x625abe(0x1ed),'width':0xa},{'header':_0x625abe(0x1d5),'key':'PBrands','width':0xa},{'header':_0x625abe(0x1e4),'key':_0x625abe(0x201),'width':0xa},{'header':_0x625abe(0x1f3),'key':_0x625abe(0x1f3),'width':0xa},{'header':_0x625abe(0x1fd),'key':'address','width':0xa},{'header':_0x625abe(0x210),'key':_0x625abe(0x210),'width':0xa},{'header':_0x625abe(0x1be),'key':'email','width':0xa}],_0x106994[_0x625abe(0x221)]('Content-Type',_0x625abe(0x1e7)),_0x106994['setHeader'](_0x625abe(0x21d),_0x625abe(0x1cd)),_0x3d5500[_0x625abe(0x1c0)]['write'](_0x106994)['then'](()=>{const _0x5432ff=_0x625abe;_0x106994[_0x5432ff(0x216)](0xc8);});}catch(_0x415a3a){_0x106994[_0x625abe(0x216)](0x190)[_0x625abe(0x1f9)]({'errors':_0x415a3a[_0x625abe(0x1c4)]});}});const storage1=multer[a0_0xf3991c(0x1b9)]({'destination':(_0x51359d,_0x601bac,_0x5256bd)=>{const _0x3ab971=a0_0xf3991c;_0x5256bd(null,_0x3ab971(0x1bc));},'filename':(_0x1e716a,_0x1f7182,_0x25ed44)=>{const _0x21401f=a0_0xf3991c;_0x25ed44(null,Date[_0x21401f(0x1da)]()+_0x1f7182[_0x21401f(0x211)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0xf3991c(0x1d7)](a0_0xf3991c(0x1ea),auth,uploadMigrate[a0_0xf3991c(0x1fe)](a0_0xf3991c(0x1e9)),async(_0x31442a,_0x1e2bc9)=>{const _0x143a11=a0_0xf3991c,_0x40ccef=_0x31442a['file'][_0x143a11(0x1e0)],_0x3ef59c=await xlsx[_0x143a11(0x219)](_0x143a11(0x1ce)+_0x40ccef);let _0x887613=_0x3ef59c[_0x143a11(0x206)],_0x38abf3=xlsx['utils'][_0x143a11(0x1f0)](_0x3ef59c[_0x143a11(0x1b8)][_0x887613[0x0]]);for(const _0x678b41 of _0x38abf3){const _0x68ac4e=_0x678b41['ID'],_0x2e65b5=_0x678b41[_0x143a11(0x1d5)],_0x1b0510=_0x678b41[_0x143a11(0x1e4)],_0x22ecdc=_0x678b41[_0x143a11(0x1f3)],_0x52ae9f=_0x678b41[_0x143a11(0x1fd)],_0x365c1e=_0x678b41[_0x143a11(0x210)],_0x3cd4ba=_0x678b41[_0x143a11(0x1be)];try{let _0x19466f=await customer[_0x143a11(0x1d9)]({'name':_0x2e65b5});if(!_0x19466f){const _0x60b803=new customer({'name':_0x2e65b5,'ID':_0x68ac4e,'SalesmanCode':_0x1b0510,'SalesmanName':_0x22ecdc,'address':_0x52ae9f,'mobile':_0x365c1e,'email':_0x3cd4ba});_0x19466f=await _0x60b803[_0x143a11(0x1fb)](),_0x31442a[_0x143a11(0x217)](_0x143a11(0x1e5),_0x2e65b5+_0x143a11(0x1f7));}else _0x31442a[_0x143a11(0x217)](_0x143a11(0x20a),_0x2e65b5+'\x20Failed');}catch(_0xd17826){_0x1e2bc9[_0x143a11(0x216)](0x1f4)[_0x143a11(0x1bd)]({'proderror':_0xd17826['message'],'aproduct':ProductName});}}_0x1e2bc9['redirect'](_0x143a11(0x1df));}),module[a0_0xf3991c(0x20d)]=router;