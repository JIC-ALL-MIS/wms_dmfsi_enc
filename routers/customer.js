function a0_0x3f8c(_0x33c616,_0x8ed7d2){const _0x1c9632=a0_0x1c96();return a0_0x3f8c=function(_0x3f8cb6,_0x1eec9b){_0x3f8cb6=_0x3f8cb6-0x95;let _0x18b85d=_0x1c9632[_0x3f8cb6];return _0x18b85d;},a0_0x3f8c(_0x33c616,_0x8ed7d2);}const a0_0x53a990=a0_0x3f8c;(function(_0x521a0d,_0x24e5d2){const _0x27d376=a0_0x3f8c,_0x15e3cb=_0x521a0d();while(!![]){try{const _0x11751c=parseInt(_0x27d376(0xec))/0x1+-parseInt(_0x27d376(0xe3))/0x2*(-parseInt(_0x27d376(0xd4))/0x3)+-parseInt(_0x27d376(0xb9))/0x4+parseInt(_0x27d376(0xe9))/0x5+parseInt(_0x27d376(0x99))/0x6+parseInt(_0x27d376(0xb8))/0x7+parseInt(_0x27d376(0xb5))/0x8*(-parseInt(_0x27d376(0x9e))/0x9);if(_0x11751c===_0x24e5d2)break;else _0x15e3cb['push'](_0x15e3cb['shift']());}catch(_0x15d89a){_0x15e3cb['push'](_0x15e3cb['shift']());}}}(a0_0x1c96,0x7ecd9));function a0_0x1c96(){const _0x41fe87=['receivable_sum','3741010MEugSx','3888440GRhNUm','Arabic','message','sale','PName','German','user','flash','aggregate','customer\x20update\x20successfully','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','exports','sheet_to_json','address','Sale','/products_export_migrate_file','post','$amount','reason','amount','findById','SalesmanCode','attachment;\x20filename=customer_Migration_File.xlsx','filename','master','Spanish','$reason','688146GnDjsC','../public/language/languages.json','customer_payment','render','columns','/view','Portuguese','French','readFile','Chinese','Sale\x20Return','now','json','English\x20(US)','xlsx','6OScZxg','redirect','Portuguese\x20(BR)','public/Migration','map','/customer/view','999630XPouRg','single','Sheets','456115qwMkby','email','Arabic\x20(ae)','utils','log','body','write','params','express','file','name','success','Customers','Name','3240630NGefXY','exceljs','payment_data','receivable','English','9387RIHfFU','SalesmanName','get','addWorksheet','setHeader','save','mobile','PBrands','multer','payable_sum','customer_data','customer_docs','findOne','find','status','language','payable','customer_product_fule','sale_return','\x20added\x20successfully','forEach','Hindi','then','7112YkmeWo','customer'];a0_0x1c96=function(){return _0x41fe87;};return a0_0x1c96();}const express=require(a0_0x53a990(0xf4)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x53a990(0xd5)),excelJS=require(a0_0x53a990(0x9a)),xlsx=require(a0_0x53a990(0xe2)),multer=require(a0_0x53a990(0xa6));router[a0_0x53a990(0xa0)](a0_0x53a990(0xd9),auth,async(_0x4cce48,_0x18ef7f)=>{const _0x20d0b5=a0_0x53a990;try{const {username:_0x2a3f75,email:_0x37ec57,role:_0x3451a9}=_0x4cce48[_0x20d0b5(0xbf)],_0x2e896c=_0x4cce48[_0x20d0b5(0xbf)],_0x46dfe6=await profile['findOne']({'email':_0x2e896c[_0x20d0b5(0xed)]}),_0x458e56=await master_shop[_0x20d0b5(0xab)]();console['log']('master',_0x458e56);const _0xa118d4=await customer[_0x20d0b5(0xab)](),_0x106b1d=await customer[_0x20d0b5(0xc1)]([{'$lookup':{'from':'c_payments','localField':'name','foreignField':_0x20d0b5(0xb6),'as':_0x20d0b5(0xa9)}}]);console['log'](_0x106b1d);const _0x220019=_0x106b1d[_0x20d0b5(0xe7)](_0x27318d=>{const _0x178339=_0x20d0b5;console[_0x178339(0xf0)]('data',_0x27318d);var _0x18c4c5=0x0,_0x404b09=0x0;return _0x27318d[_0x178339(0xa9)][_0x178339(0xb2)](_0x3d3478=>{const _0x423a3e=_0x178339;console[_0x423a3e(0xf0)]('element',_0x3d3478),_0x3d3478[_0x423a3e(0xcb)]=='Sale'?_0x18c4c5+=_0x3d3478[_0x423a3e(0xcc)]:_0x404b09+=_0x3d3478[_0x423a3e(0xcc)];}),_0x27318d[_0x178339(0xbc)]=parseFloat(_0x18c4c5)+0x0,_0x27318d[_0x178339(0xb0)]=parseFloat(_0x404b09)+0x0,_0x27318d;});console[_0x20d0b5(0xf0)](_0x20d0b5(0x9b),_0x220019);if(_0x458e56[0x0][_0x20d0b5(0xad)]==_0x20d0b5(0xe1)){var _0x9705e=users[_0x20d0b5(0x9d)];console[_0x20d0b5(0xf0)](_0x9705e);}else{if(_0x458e56[0x0][_0x20d0b5(0xad)]==_0x20d0b5(0xb3))var _0x9705e=users['Hindi'];else{if(_0x458e56[0x0][_0x20d0b5(0xad)]==_0x20d0b5(0xbe))var _0x9705e=users[_0x20d0b5(0xbe)];else{if(_0x458e56[0x0][_0x20d0b5(0xad)]==_0x20d0b5(0xd2))var _0x9705e=users['Spanish'];else{if(_0x458e56[0x0]['language']==_0x20d0b5(0xdb))var _0x9705e=users[_0x20d0b5(0xdb)];else{if(_0x458e56[0x0]['language']=='Portuguese\x20(BR)')var _0x9705e=users['Portuguese'];else{if(_0x458e56[0x0][_0x20d0b5(0xad)]==_0x20d0b5(0xdd))var _0x9705e=users[_0x20d0b5(0xdd)];else{if(_0x458e56[0x0][_0x20d0b5(0xad)]==_0x20d0b5(0xee))var _0x9705e=users[_0x20d0b5(0xba)];}}}}}}}_0x18ef7f[_0x20d0b5(0xd7)]('customer',{'success':_0x4cce48[_0x20d0b5(0xc0)](_0x20d0b5(0x96)),'errors':_0x4cce48[_0x20d0b5(0xc0)]('errors'),'user':_0xa118d4,'role':_0x2e896c,'profile':_0x46dfe6,'payment':_0x220019,'master_shop':_0x458e56,'language':_0x9705e});}catch(_0x163a44){console['log'](_0x163a44);}}),router[a0_0x53a990(0xc9)](a0_0x53a990(0xd9),auth,async(_0x544ed5,_0x4953e7)=>{const _0x1e6060=a0_0x53a990;try{const {name:_0x28623d,address:_0x404501,mobile:_0x22992f,email:_0x2c5e5d,receivable:_0x35b119,payable:_0x2f8547,contactperson:_0x111657,landline:_0xa8ee8a}=_0x544ed5[_0x1e6060(0xf1)],_0x14e536=new customer({'name':_0x28623d,'address':_0x404501,'mobile':_0x22992f,'email':_0x2c5e5d,'receivable':_0x35b119,'payable':_0x2f8547,'contactperson':_0x111657,'landline':_0xa8ee8a}),_0x4e9560=await _0x14e536[_0x1e6060(0xa3)]();_0x544ed5[_0x1e6060(0xc0)](_0x1e6060(0x96),'customer\x20add\x20successfully'),_0x4953e7['redirect'](_0x1e6060(0xe8));}catch(_0x307b92){console[_0x1e6060(0xf0)](_0x307b92);}}),router[a0_0x53a990(0xa0)]('/view/:id',auth,async(_0xfb86a8,_0x4d5427)=>{const _0x1781a9=a0_0x53a990;try{const {username:_0x463be0,email:_0x5300ae,role:_0x56fe6e}=_0xfb86a8['user'],_0x5712e1=_0xfb86a8[_0x1781a9(0xbf)],_0x2b0dd1=await profile[_0x1781a9(0xaa)]({'email':_0x5712e1[_0x1781a9(0xed)]}),_0x3dc0b5=await master_shop[_0x1781a9(0xab)]();console[_0x1781a9(0xf0)](_0x1781a9(0xd1),_0x3dc0b5);const _0x3b1354=_0xfb86a8[_0x1781a9(0xf3)]['id'],_0x4f12ad=await customer[_0x1781a9(0xcd)](_0x3b1354);if(_0x3dc0b5[0x0][_0x1781a9(0xad)]=='English\x20(US)'){var _0x1e4853=users[_0x1781a9(0x9d)];console[_0x1781a9(0xf0)](_0x1e4853);}else{if(_0x3dc0b5[0x0]['language']=='Hindi')var _0x1e4853=users['Hindi'];else{if(_0x3dc0b5[0x0][_0x1781a9(0xad)]==_0x1781a9(0xbe))var _0x1e4853=users[_0x1781a9(0xbe)];else{if(_0x3dc0b5[0x0][_0x1781a9(0xad)]==_0x1781a9(0xd2))var _0x1e4853=users['Spanish'];else{if(_0x3dc0b5[0x0][_0x1781a9(0xad)]=='French')var _0x1e4853=users[_0x1781a9(0xdb)];else{if(_0x3dc0b5[0x0]['language']==_0x1781a9(0xe5))var _0x1e4853=users['Portuguese'];else{if(_0x3dc0b5[0x0][_0x1781a9(0xad)]==_0x1781a9(0xdd))var _0x1e4853=users[_0x1781a9(0xdd)];else{if(_0x3dc0b5[0x0][_0x1781a9(0xad)]==_0x1781a9(0xee))var _0x1e4853=users[_0x1781a9(0xba)];}}}}}}}_0x4d5427[_0x1781a9(0xd7)](_0x1781a9(0xb6),{'success':_0xfb86a8['flash'](_0x1781a9(0x96)),'errors':_0xfb86a8['flash']('errors'),'role':_0x5712e1,'profile':_0x2b0dd1,'user':_0x4f12ad,'master_shop':_0x3dc0b5,'language':_0x1e4853});}catch(_0x5b3304){console[_0x1781a9(0xf0)](_0x5b3304);}}),router[a0_0x53a990(0xc9)]('/view/:id',auth,async(_0x1b4925,_0x2dd3e6)=>{const _0x541ce7=a0_0x53a990;try{const _0x133238=_0x1b4925[_0x541ce7(0xf3)]['id'],_0x1583cd=await customer[_0x541ce7(0xcd)](_0x133238),{name:_0xdbd464,address:_0x466bc3,mobile:_0x34ad26,email:_0x48825b,receivable:_0x4acec2,payable:_0x18217b,contactperson:_0x186bc9,landline:_0x1d39a0}=_0x1b4925[_0x541ce7(0xf1)];_0x1583cd[_0x541ce7(0x95)]=_0xdbd464,_0x1583cd[_0x541ce7(0xc6)]=_0x466bc3,_0x1583cd[_0x541ce7(0xa4)]=_0x34ad26,_0x1583cd[_0x541ce7(0xed)]=_0x48825b,_0x1583cd[_0x541ce7(0x9c)]=_0x4acec2,_0x1583cd[_0x541ce7(0xae)]=_0x18217b,_0x1583cd['contactperson']=_0x186bc9,_0x1583cd['landline']=_0x1d39a0;const _0x474310=await _0x1583cd[_0x541ce7(0xa3)]();_0x1b4925['flash'](_0x541ce7(0x96),_0x541ce7(0xc2)),_0x2dd3e6[_0x541ce7(0xe4)](_0x541ce7(0xe8));}catch(_0x2081a6){console[_0x541ce7(0xf0)](_0x2081a6);}}),router[a0_0x53a990(0xa0)]('/view/payment/:id',auth,async(_0x33fcf1,_0x22be51)=>{const _0x4a8ba1=a0_0x53a990;try{const {username:_0xdfdc7b,email:_0x1b6bd5,role:_0x3607eb}=_0x33fcf1[_0x4a8ba1(0xbf)],_0x446c8e=_0x33fcf1[_0x4a8ba1(0xbf)],_0x1eb6c5=await profile[_0x4a8ba1(0xaa)]({'email':_0x446c8e[_0x4a8ba1(0xed)]}),_0x2b1939=await master_shop[_0x4a8ba1(0xab)]();console[_0x4a8ba1(0xf0)](_0x4a8ba1(0xd1),_0x2b1939),console[_0x4a8ba1(0xf0)](_0x33fcf1['params']['id']);const _0x1a85a5=await customer[_0x4a8ba1(0xaa)]({'_id':_0x33fcf1['params']['id']});console[_0x4a8ba1(0xf0)](_0x4a8ba1(0xa8),_0x1a85a5);const _0x479cc0=await c_payment_data['find']({'customer':_0x1a85a5['name']});console[_0x4a8ba1(0xf0)](_0x479cc0);const _0x4d9d67=await c_payment_data['aggregate']([{'$match':{'customer':_0x1a85a5[_0x4a8ba1(0x95)]}},{'$match':{'reason':_0x4a8ba1(0xc7)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x4a8ba1(0xca)}}}]);console[_0x4a8ba1(0xf0)](_0x4a8ba1(0xa7),_0x4d9d67);const _0x36be43=await c_payment_data['aggregate']([{'$match':{'customer':_0x1a85a5[_0x4a8ba1(0x95)]}},{'$match':{'reason':_0x4a8ba1(0xde)}},{'$group':{'_id':_0x4a8ba1(0xd3),'sum':{'$sum':'$amount'}}}]);console['log'](_0x4a8ba1(0xb7),_0x36be43);if(_0x2b1939[0x0]['language']=='English\x20(US)'){var _0x27399c=users['English'];console[_0x4a8ba1(0xf0)](_0x27399c);}else{if(_0x2b1939[0x0][_0x4a8ba1(0xad)]=='Hindi')var _0x27399c=users[_0x4a8ba1(0xb3)];else{if(_0x2b1939[0x0][_0x4a8ba1(0xad)]==_0x4a8ba1(0xbe))var _0x27399c=users[_0x4a8ba1(0xbe)];else{if(_0x2b1939[0x0][_0x4a8ba1(0xad)]==_0x4a8ba1(0xd2))var _0x27399c=users[_0x4a8ba1(0xd2)];else{if(_0x2b1939[0x0][_0x4a8ba1(0xad)]=='French')var _0x27399c=users['French'];else{if(_0x2b1939[0x0][_0x4a8ba1(0xad)]==_0x4a8ba1(0xe5))var _0x27399c=users[_0x4a8ba1(0xda)];else{if(_0x2b1939[0x0][_0x4a8ba1(0xad)]==_0x4a8ba1(0xdd))var _0x27399c=users[_0x4a8ba1(0xdd)];else{if(_0x2b1939[0x0]['language']==_0x4a8ba1(0xee))var _0x27399c=users[_0x4a8ba1(0xba)];}}}}}}}_0x22be51[_0x4a8ba1(0xd7)](_0x4a8ba1(0xd6),{'success':_0x33fcf1['flash'](_0x4a8ba1(0x96)),'errors':_0x33fcf1[_0x4a8ba1(0xc0)]('errors'),'role':_0x446c8e,'profile':_0x1eb6c5,'payment':_0x479cc0,'payable':_0x4d9d67,'receivable':_0x36be43,'master_shop':_0x2b1939,'language':_0x27399c});}catch(_0x487f0d){console['log'](_0x487f0d);}}),router[a0_0x53a990(0xa0)](a0_0x53a990(0xc8),auth,async(_0x5eb1e7,_0x2c0c6d)=>{const _0x415f68=a0_0x53a990;try{const _0x4a727a=new excelJS['Workbook'](),_0x5f4e3d=_0x4a727a[_0x415f68(0xa1)](_0x415f68(0x97));return _0x5f4e3d[_0x415f68(0xd8)]=[{'header':'ID','key':_0x415f68(0xbd),'width':0xa},{'header':_0x415f68(0x98),'key':_0x415f68(0xa5),'width':0xa},{'header':_0x415f68(0xce),'key':'PUnits','width':0xa},{'header':_0x415f68(0x9f),'key':_0x415f68(0x9f),'width':0xa},{'header':_0x415f68(0xc6),'key':_0x415f68(0xc6),'width':0xa},{'header':'mobile','key':_0x415f68(0xa4),'width':0xa},{'header':_0x415f68(0xed),'key':_0x415f68(0xed),'width':0xa}],_0x2c0c6d[_0x415f68(0xa2)]('Content-Type',_0x415f68(0xc3)),_0x2c0c6d[_0x415f68(0xa2)]('Content-Disposition',_0x415f68(0xcf)),_0x4a727a[_0x415f68(0xe2)][_0x415f68(0xf2)](_0x2c0c6d)[_0x415f68(0xb4)](()=>{const _0x35505c=_0x415f68;_0x2c0c6d[_0x35505c(0xac)](0xc8);});}catch(_0x38c073){_0x2c0c6d['status'](0x190)['send']({'errors':_0x38c073[_0x415f68(0xbb)]});}});const storage1=multer['diskStorage']({'destination':(_0x15067b,_0x4bbb74,_0x1bf8f8)=>{const _0x3cf469=a0_0x53a990;_0x1bf8f8(null,_0x3cf469(0xe6));},'filename':(_0x319de7,_0x3a00c5,_0x2cf617)=>{const _0x4c50e8=a0_0x53a990;_0x2cf617(null,Date[_0x4c50e8(0xdf)]()+_0x3a00c5['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x53a990(0xc9)]('/customer_import_migrate_file',auth,uploadMigrate[a0_0x53a990(0xea)](a0_0x53a990(0xaf)),async(_0x428446,_0x1769b6)=>{const _0x2b4e67=a0_0x53a990,_0x2a4846=_0x428446[_0x2b4e67(0xf5)][_0x2b4e67(0xd0)],_0x3ff590=await xlsx[_0x2b4e67(0xdc)]('public/Migration/'+_0x2a4846);let _0x5e621c=_0x3ff590['SheetNames'],_0x3f264b=xlsx[_0x2b4e67(0xef)][_0x2b4e67(0xc5)](_0x3ff590[_0x2b4e67(0xeb)][_0x5e621c[0x0]]);for(const _0x3f08d0 of _0x3f264b){const _0x206cfd=_0x3f08d0['ID'],_0x209338=_0x3f08d0[_0x2b4e67(0x98)],_0x3719cd=_0x3f08d0[_0x2b4e67(0xce)],_0x9acdfd=_0x3f08d0['SalesmanName'],_0xe1a4ce=_0x3f08d0[_0x2b4e67(0xc6)],_0x37dcff=_0x3f08d0[_0x2b4e67(0xa4)],_0x3080b3=_0x3f08d0[_0x2b4e67(0xed)];try{let _0x439369=await customer['findOne']({'name':_0x209338});if(!_0x439369){const _0x2f4624=new customer({'name':_0x209338,'ID':_0x206cfd,'SalesmanCode':_0x3719cd,'SalesmanName':_0x9acdfd,'address':_0xe1a4ce,'mobile':_0x37dcff,'email':_0x3080b3});_0x439369=await _0x2f4624[_0x2b4e67(0xa3)](),_0x428446[_0x2b4e67(0xc0)](_0x2b4e67(0x96),_0x209338+_0x2b4e67(0xb1));}else _0x428446[_0x2b4e67(0xc0)]('error',_0x209338+'\x20Failed');}catch(_0x1b72ed){_0x1769b6['status'](0x1f4)[_0x2b4e67(0xe0)]({'proderror':_0x1b72ed['message'],'aproduct':ProductName});}}_0x1769b6[_0x2b4e67(0xe4)](_0x2b4e67(0xe8));}),module[a0_0x53a990(0xc4)]=router;