function a0_0x38f2(_0xcc0a2f,_0x36858b){const _0x27e44b=a0_0x27e4();return a0_0x38f2=function(_0x38f242,_0xa128c3){_0x38f242=_0x38f242-0x18d;let _0x5b6282=_0x27e44b[_0x38f242];return _0x5b6282;},a0_0x38f2(_0xcc0a2f,_0x36858b);}const a0_0x36162c=a0_0x38f2;(function(_0x5dd3ed,_0x2fb0d1){const _0x348feb=a0_0x38f2,_0x4dc7d6=_0x5dd3ed();while(!![]){try{const _0xe5151e=parseInt(_0x348feb(0x1b2))/0x1+-parseInt(_0x348feb(0x1c8))/0x2*(-parseInt(_0x348feb(0x1c2))/0x3)+-parseInt(_0x348feb(0x1dd))/0x4+parseInt(_0x348feb(0x1ca))/0x5+-parseInt(_0x348feb(0x1d1))/0x6+parseInt(_0x348feb(0x199))/0x7+-parseInt(_0x348feb(0x1ec))/0x8;if(_0xe5151e===_0x2fb0d1)break;else _0x4dc7d6['push'](_0x4dc7d6['shift']());}catch(_0x8d7bc8){_0x4dc7d6['push'](_0x4dc7d6['shift']());}}}(a0_0x27e4,0xee0f0));const express=require(a0_0x36162c(0x193)),app=express(),router=express[a0_0x36162c(0x1d9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x36162c(0x1de)),auth=require(a0_0x36162c(0x1b6)),users=require(a0_0x36162c(0x1c7)),excelJS=require(a0_0x36162c(0x1cc)),xlsx=require('xlsx'),multer=require('multer');router[a0_0x36162c(0x19e)](a0_0x36162c(0x1d0),auth,async(_0x355a83,_0x1e223a)=>{const _0x3bceff=a0_0x36162c;try{const {username:_0x12bb7f,email:_0x5c5486,role:_0x31361b}=_0x355a83['user'],_0x5182a1=_0x355a83[_0x3bceff(0x1e2)],_0x3c9cc9=await profile[_0x3bceff(0x1b5)]({'email':_0x5182a1['email']}),_0x175883=await master_shop['find']();console[_0x3bceff(0x1cf)](_0x3bceff(0x1ce),_0x175883);const _0xfed446=await customer[_0x3bceff(0x1d7)](),_0x5f07f0=await customer[_0x3bceff(0x1b4)]([{'$lookup':{'from':_0x3bceff(0x1d4),'localField':_0x3bceff(0x1db),'foreignField':_0x3bceff(0x19a),'as':_0x3bceff(0x1d6)}}]);console[_0x3bceff(0x1cf)](_0x5f07f0);const _0x2d4653=_0x5f07f0['map'](_0x8e4497=>{const _0x1f2eab=_0x3bceff;console[_0x1f2eab(0x1cf)](_0x1f2eab(0x1e4),_0x8e4497);var _0x10a790=0x0,_0xae4ef4=0x0;return _0x8e4497[_0x1f2eab(0x1d6)][_0x1f2eab(0x19d)](_0x359b23=>{const _0x5753d8=_0x1f2eab;console[_0x5753d8(0x1cf)]('element',_0x359b23),_0x359b23[_0x5753d8(0x1eb)]==_0x5753d8(0x1a3)?_0x10a790+=_0x359b23['amount']:_0xae4ef4+=_0x359b23[_0x5753d8(0x1a9)];}),_0x8e4497[_0x1f2eab(0x1bd)]=parseFloat(_0x10a790)+0x0,_0x8e4497[_0x1f2eab(0x1a4)]=parseFloat(_0xae4ef4)+0x0,_0x8e4497;});console[_0x3bceff(0x1cf)]('payment_data',_0x2d4653);if(_0x175883[0x0][_0x3bceff(0x1cd)]==_0x3bceff(0x1b1)){var _0x2be1c5=users['English'];console['log'](_0x2be1c5);}else{if(_0x175883[0x0]['language']==_0x3bceff(0x1bc))var _0x2be1c5=users[_0x3bceff(0x1bc)];else{if(_0x175883[0x0]['language']==_0x3bceff(0x1c1))var _0x2be1c5=users['German'];else{if(_0x175883[0x0][_0x3bceff(0x1cd)]==_0x3bceff(0x19c))var _0x2be1c5=users[_0x3bceff(0x19c)];else{if(_0x175883[0x0][_0x3bceff(0x1cd)]==_0x3bceff(0x18e))var _0x2be1c5=users['French'];else{if(_0x175883[0x0][_0x3bceff(0x1cd)]==_0x3bceff(0x1b7))var _0x2be1c5=users['Portuguese'];else{if(_0x175883[0x0]['language']==_0x3bceff(0x191))var _0x2be1c5=users[_0x3bceff(0x191)];else{if(_0x175883[0x0]['language']==_0x3bceff(0x1a8))var _0x2be1c5=users[_0x3bceff(0x1c3)];}}}}}}}_0x1e223a[_0x3bceff(0x1c4)]('customer',{'success':_0x355a83['flash'](_0x3bceff(0x18f)),'errors':_0x355a83[_0x3bceff(0x192)](_0x3bceff(0x197)),'user':_0xfed446,'role':_0x5182a1,'profile':_0x3c9cc9,'payment':_0x2d4653,'master_shop':_0x175883,'language':_0x2be1c5});}catch(_0x256a41){console[_0x3bceff(0x1cf)](_0x256a41);}}),router[a0_0x36162c(0x1b3)](a0_0x36162c(0x1d0),auth,async(_0x547611,_0x36c2bc)=>{const _0x597f34=a0_0x36162c;try{const {name:_0x3c68df,address:_0x26c022,mobile:_0x4eb56c,email:_0xb5f1cb,receivable:_0x44b1f7,payable:_0x55ecf3,contactperson:_0x168da0,landline:_0x29bd90}=_0x547611[_0x597f34(0x1cb)],_0x43911f=new customer({'name':_0x3c68df,'address':_0x26c022,'mobile':_0x4eb56c,'email':_0xb5f1cb,'receivable':_0x44b1f7,'payable':_0x55ecf3,'contactperson':_0x168da0,'landline':_0x29bd90}),_0x430927=await _0x43911f[_0x597f34(0x1e0)]();_0x547611['flash']('success',_0x597f34(0x1d3)),_0x36c2bc[_0x597f34(0x194)](_0x597f34(0x1ef));}catch(_0x59a83b){console['log'](_0x59a83b);}}),router[a0_0x36162c(0x19e)](a0_0x36162c(0x1ba),auth,async(_0x4d3b72,_0x57321a)=>{const _0x42cd86=a0_0x36162c;try{const {username:_0x3a1fba,email:_0x4640fb,role:_0x171a10}=_0x4d3b72[_0x42cd86(0x1e2)],_0x1de774=_0x4d3b72[_0x42cd86(0x1e2)],_0x4ebab4=await profile[_0x42cd86(0x1b5)]({'email':_0x1de774[_0x42cd86(0x1b9)]}),_0x17945b=await master_shop[_0x42cd86(0x1d7)]();console[_0x42cd86(0x1cf)](_0x42cd86(0x1ce),_0x17945b);const _0x4aea26=_0x4d3b72[_0x42cd86(0x1e1)]['id'],_0x27570a=await customer[_0x42cd86(0x1b8)](_0x4aea26);if(_0x17945b[0x0][_0x42cd86(0x1cd)]=='English\x20(US)'){var _0x3b8522=users[_0x42cd86(0x1e3)];console[_0x42cd86(0x1cf)](_0x3b8522);}else{if(_0x17945b[0x0][_0x42cd86(0x1cd)]==_0x42cd86(0x1bc))var _0x3b8522=users[_0x42cd86(0x1bc)];else{if(_0x17945b[0x0][_0x42cd86(0x1cd)]=='German')var _0x3b8522=users[_0x42cd86(0x1c1)];else{if(_0x17945b[0x0][_0x42cd86(0x1cd)]=='Spanish')var _0x3b8522=users['Spanish'];else{if(_0x17945b[0x0]['language']==_0x42cd86(0x18e))var _0x3b8522=users[_0x42cd86(0x18e)];else{if(_0x17945b[0x0][_0x42cd86(0x1cd)]==_0x42cd86(0x1b7))var _0x3b8522=users[_0x42cd86(0x1e9)];else{if(_0x17945b[0x0][_0x42cd86(0x1cd)]==_0x42cd86(0x191))var _0x3b8522=users['Chinese'];else{if(_0x17945b[0x0][_0x42cd86(0x1cd)]==_0x42cd86(0x1a8))var _0x3b8522=users[_0x42cd86(0x1c3)];}}}}}}}_0x57321a[_0x42cd86(0x1c4)](_0x42cd86(0x19a),{'success':_0x4d3b72[_0x42cd86(0x192)](_0x42cd86(0x18f)),'errors':_0x4d3b72[_0x42cd86(0x192)]('errors'),'role':_0x1de774,'profile':_0x4ebab4,'user':_0x27570a,'master_shop':_0x17945b,'language':_0x3b8522});}catch(_0x2c593a){console[_0x42cd86(0x1cf)](_0x2c593a);}}),router['post'](a0_0x36162c(0x1ba),auth,async(_0x285a7a,_0x435feb)=>{const _0x3f7d92=a0_0x36162c;try{const _0x5332c5=_0x285a7a[_0x3f7d92(0x1e1)]['id'],_0x23356f=await customer['findById'](_0x5332c5),{name:_0x5d8b9a,address:_0x5d8bea,mobile:_0x21e5fd,email:_0x5e9bc9,receivable:_0x4c70e6,payable:_0xccbd28,contactperson:_0xbcb969,landline:_0x31f956}=_0x285a7a['body'];_0x23356f[_0x3f7d92(0x1db)]=_0x5d8b9a,_0x23356f[_0x3f7d92(0x1a0)]=_0x5d8bea,_0x23356f[_0x3f7d92(0x1d2)]=_0x21e5fd,_0x23356f[_0x3f7d92(0x1b9)]=_0x5e9bc9,_0x23356f['receivable']=_0x4c70e6,_0x23356f['payable']=_0xccbd28,_0x23356f['contactperson']=_0xbcb969,_0x23356f[_0x3f7d92(0x195)]=_0x31f956;const _0x3fe80c=await _0x23356f[_0x3f7d92(0x1e0)]();_0x285a7a[_0x3f7d92(0x192)]('success',_0x3f7d92(0x1dc)),_0x435feb[_0x3f7d92(0x194)]('/customer/view');}catch(_0x3436f1){console[_0x3f7d92(0x1cf)](_0x3436f1);}}),router['get'](a0_0x36162c(0x196),auth,async(_0x259477,_0x1fa5a9)=>{const _0x535fdd=a0_0x36162c;try{const {username:_0x4888ec,email:_0x2ca2bd,role:_0x47b4cb}=_0x259477[_0x535fdd(0x1e2)],_0x4ecc0b=_0x259477[_0x535fdd(0x1e2)],_0x33b8c9=await profile[_0x535fdd(0x1b5)]({'email':_0x4ecc0b[_0x535fdd(0x1b9)]}),_0x53c828=await master_shop['find']();console['log']('master',_0x53c828),console[_0x535fdd(0x1cf)](_0x259477[_0x535fdd(0x1e1)]['id']);const _0xf53737=await customer[_0x535fdd(0x1b5)]({'_id':_0x259477[_0x535fdd(0x1e1)]['id']});console[_0x535fdd(0x1cf)](_0x535fdd(0x1a1),_0xf53737);const _0x1c8f65=await c_payment_data[_0x535fdd(0x1d7)]({'customer':_0xf53737[_0x535fdd(0x1db)]});console['log'](_0x1c8f65);const _0x4ec344=await c_payment_data['aggregate']([{'$match':{'customer':_0xf53737[_0x535fdd(0x1db)]}},{'$match':{'reason':_0x535fdd(0x1a3)}},{'$group':{'_id':_0x535fdd(0x1a5),'sum':{'$sum':_0x535fdd(0x1e5)}}}]);console[_0x535fdd(0x1cf)]('payable_sum',_0x4ec344);const _0x2b99ab=await c_payment_data[_0x535fdd(0x1b4)]([{'$match':{'customer':_0xf53737[_0x535fdd(0x1db)]}},{'$match':{'reason':_0x535fdd(0x1a2)}},{'$group':{'_id':_0x535fdd(0x1a5),'sum':{'$sum':_0x535fdd(0x1e5)}}}]);console[_0x535fdd(0x1cf)](_0x535fdd(0x1af),_0x2b99ab);if(_0x53c828[0x0][_0x535fdd(0x1cd)]==_0x535fdd(0x1b1)){var _0x500265=users['English'];console[_0x535fdd(0x1cf)](_0x500265);}else{if(_0x53c828[0x0]['language']==_0x535fdd(0x1bc))var _0x500265=users[_0x535fdd(0x1bc)];else{if(_0x53c828[0x0][_0x535fdd(0x1cd)]=='German')var _0x500265=users['German'];else{if(_0x53c828[0x0][_0x535fdd(0x1cd)]==_0x535fdd(0x19c))var _0x500265=users[_0x535fdd(0x19c)];else{if(_0x53c828[0x0]['language']==_0x535fdd(0x18e))var _0x500265=users[_0x535fdd(0x18e)];else{if(_0x53c828[0x0]['language']==_0x535fdd(0x1b7))var _0x500265=users[_0x535fdd(0x1e9)];else{if(_0x53c828[0x0][_0x535fdd(0x1cd)]=='Chinese')var _0x500265=users[_0x535fdd(0x191)];else{if(_0x53c828[0x0][_0x535fdd(0x1cd)]=='Arabic\x20(ae)')var _0x500265=users[_0x535fdd(0x1c3)];}}}}}}}_0x1fa5a9[_0x535fdd(0x1c4)](_0x535fdd(0x1be),{'success':_0x259477[_0x535fdd(0x192)](_0x535fdd(0x18f)),'errors':_0x259477[_0x535fdd(0x192)]('errors'),'role':_0x4ecc0b,'profile':_0x33b8c9,'payment':_0x1c8f65,'payable':_0x4ec344,'receivable':_0x2b99ab,'master_shop':_0x53c828,'language':_0x500265});}catch(_0x2eaa75){console['log'](_0x2eaa75);}}),router[a0_0x36162c(0x19e)](a0_0x36162c(0x1d8),auth,async(_0x2666be,_0x1b3fa9)=>{const _0x295665=a0_0x36162c;try{const _0x26c9a5=new excelJS[(_0x295665(0x1a6))](),_0x5c1986=_0x26c9a5['addWorksheet'](_0x295665(0x1ea));return _0x5c1986[_0x295665(0x1b0)]=[{'header':'ID','key':_0x295665(0x1a7),'width':0xa},{'header':_0x295665(0x1ad),'key':'PBrands','width':0xa},{'header':'SalesmanCode','key':_0x295665(0x1c0),'width':0xa},{'header':_0x295665(0x1da),'key':_0x295665(0x1da),'width':0xa},{'header':_0x295665(0x1a0),'key':_0x295665(0x1a0),'width':0xa},{'header':_0x295665(0x1d2),'key':_0x295665(0x1d2),'width':0xa},{'header':_0x295665(0x1b9),'key':_0x295665(0x1b9),'width':0xa}],_0x1b3fa9['setHeader'](_0x295665(0x18d),_0x295665(0x1ed)),_0x1b3fa9['setHeader'](_0x295665(0x1c5),'attachment;\x20filename=customer_Migration_File.xlsx'),_0x26c9a5[_0x295665(0x198)][_0x295665(0x1bb)](_0x1b3fa9)['then'](()=>{const _0x42d0aa=_0x295665;_0x1b3fa9[_0x42d0aa(0x190)](0xc8);});}catch(_0x5612c2){_0x1b3fa9['status'](0x190)[_0x295665(0x1e8)]({'errors':_0x5612c2['message']});}});function a0_0x27e4(){const _0x4b42de=['Sale\x20Return','Sale','sale_return','$reason','Workbook','PName','Arabic\x20(ae)','amount','filename','SalesmanCode','readFile','Name','\x20added\x20successfully','receivable_sum','columns','English\x20(US)','1037913UEGByw','post','aggregate','findOne','../middleware/auth','Portuguese\x20(BR)','findById','email','/view/:id','write','Hindi','sale','customer_payment','file','PUnits','German','315TUyTXL','Arabic','render','Content-Disposition','exports','../public/language/languages.json','27766LRZLxe','\x20Failed','7691715MtFWwh','body','exceljs','language','master','log','/view','9907950SUYxPh','mobile','customer\x20add\x20successfully','c_payments','public/Migration','customer_docs','find','/products_export_migrate_file','Router','SalesmanName','name','customer\x20update\x20successfully','6064480qDyzEG','../models/all_models','json','save','params','user','English','data','$amount','customer_product_fule','/customer_import_migrate_file','send','Portuguese','Customers','reason','10448776xJtdsM','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','public/Migration/','/customer/view','Content-Type','French','success','status','Chinese','flash','express','redirect','landline','/view/payment/:id','errors','xlsx','9902613ZOIosX','customer','error','Spanish','forEach','get','diskStorage','address','customer_data'];a0_0x27e4=function(){return _0x4b42de;};return a0_0x27e4();}const storage1=multer[a0_0x36162c(0x19f)]({'destination':(_0x1a21d0,_0x6f1470,_0x11391c)=>{const _0x4c4846=a0_0x36162c;_0x11391c(null,_0x4c4846(0x1d5));},'filename':(_0x54645b,_0x5cb607,_0x362801)=>{_0x362801(null,Date['now']()+_0x5cb607['originalname']);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x36162c(0x1e7),auth,uploadMigrate['single'](a0_0x36162c(0x1e6)),async(_0x2837b1,_0x30a9c7)=>{const _0x21b5ff=a0_0x36162c,_0x4fac50=_0x2837b1[_0x21b5ff(0x1bf)][_0x21b5ff(0x1aa)],_0x51a107=await xlsx[_0x21b5ff(0x1ac)](_0x21b5ff(0x1ee)+_0x4fac50);let _0x3acbdc=_0x51a107['SheetNames'],_0x2aa59d=xlsx['utils']['sheet_to_json'](_0x51a107['Sheets'][_0x3acbdc[0x0]]);for(const _0x28e06e of _0x2aa59d){const _0x595868=_0x28e06e['ID'],_0x863fb5=_0x28e06e[_0x21b5ff(0x1ad)],_0x18b796=_0x28e06e[_0x21b5ff(0x1ab)],_0x206729=_0x28e06e['SalesmanName'],_0x413e3e=_0x28e06e[_0x21b5ff(0x1a0)],_0x381ee6=_0x28e06e[_0x21b5ff(0x1d2)],_0x520538=_0x28e06e[_0x21b5ff(0x1b9)];try{let _0xfa18c=await customer[_0x21b5ff(0x1b5)]({'name':_0x863fb5});if(!_0xfa18c){const _0x98cf58=new customer({'name':_0x863fb5,'ID':_0x595868,'SalesmanCode':_0x18b796,'SalesmanName':_0x206729,'address':_0x413e3e,'mobile':_0x381ee6,'email':_0x520538});_0xfa18c=await _0x98cf58[_0x21b5ff(0x1e0)](),_0x2837b1[_0x21b5ff(0x192)](_0x21b5ff(0x18f),_0x863fb5+_0x21b5ff(0x1ae));}else _0x2837b1['flash'](_0x21b5ff(0x19b),_0x863fb5+_0x21b5ff(0x1c9));}catch(_0x5d3e55){_0x30a9c7['status'](0x1f4)[_0x21b5ff(0x1df)]({'proderror':_0x5d3e55['message'],'aproduct':ProductName});}}_0x30a9c7[_0x21b5ff(0x194)](_0x21b5ff(0x1ef));}),module[a0_0x36162c(0x1c6)]=router;