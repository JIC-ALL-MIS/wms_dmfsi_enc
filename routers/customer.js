const a0_0x199d67=a0_0x235e;(function(_0x19670d,_0x1f7a42){const _0x5a528e=a0_0x235e,_0x3afd0c=_0x19670d();while(!![]){try{const _0x5bb743=-parseInt(_0x5a528e(0x1f6))/0x1*(-parseInt(_0x5a528e(0x200))/0x2)+parseInt(_0x5a528e(0x24d))/0x3*(-parseInt(_0x5a528e(0x1f3))/0x4)+-parseInt(_0x5a528e(0x218))/0x5*(parseInt(_0x5a528e(0x212))/0x6)+parseInt(_0x5a528e(0x243))/0x7*(-parseInt(_0x5a528e(0x23f))/0x8)+parseInt(_0x5a528e(0x23a))/0x9+-parseInt(_0x5a528e(0x240))/0xa+parseInt(_0x5a528e(0x216))/0xb;if(_0x5bb743===_0x1f7a42)break;else _0x3afd0c['push'](_0x3afd0c['shift']());}catch(_0x41cbf8){_0x3afd0c['push'](_0x3afd0c['shift']());}}}(a0_0x1852,0x94e83));function a0_0x235e(_0x2d7f15,_0x30c372){const _0x1852a8=a0_0x1852();return a0_0x235e=function(_0x235eb6,_0x485ff2){_0x235eb6=_0x235eb6-0x1f1;let _0x579fb4=_0x1852a8[_0x235eb6];return _0x579fb4;},a0_0x235e(_0x2d7f15,_0x30c372);}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x199d67(0x1fb)),auth=require(a0_0x199d67(0x247)),users=require('../public/language/languages.json'),excelJS=require(a0_0x199d67(0x23b)),xlsx=require(a0_0x199d67(0x1f7)),multer=require(a0_0x199d67(0x24a));router[a0_0x199d67(0x21a)](a0_0x199d67(0x23e),auth,async(_0xce069d,_0x311d0c)=>{const _0x158c97=a0_0x199d67;try{const {username:_0x36e38c,email:_0x32f780,role:_0x4f4451}=_0xce069d[_0x158c97(0x22e)],_0x207d0f=_0xce069d[_0x158c97(0x22e)],_0x29d2ca=await profile[_0x158c97(0x21c)]({'email':_0x207d0f[_0x158c97(0x1f1)]}),_0x48fa04=await master_shop[_0x158c97(0x228)]();console['log'](_0x158c97(0x231),_0x48fa04);const _0xfc8c0c=await customer[_0x158c97(0x228)](),_0x5c5508=await customer[_0x158c97(0x232)]([{'$lookup':{'from':_0x158c97(0x221),'localField':_0x158c97(0x210),'foreignField':_0x158c97(0x23d),'as':_0x158c97(0x1f4)}}]);console[_0x158c97(0x1fc)](_0x5c5508);const _0x5d9616=_0x5c5508[_0x158c97(0x252)](_0x385611=>{const _0x4bb691=_0x158c97;console[_0x4bb691(0x1fc)]('data',_0x385611);var _0x650ea9=0x0,_0x577834=0x0;return _0x385611['customer_docs'][_0x4bb691(0x215)](_0x35f75d=>{const _0x469f1b=_0x4bb691;console[_0x469f1b(0x1fc)](_0x469f1b(0x1f9),_0x35f75d),_0x35f75d[_0x469f1b(0x238)]=='Sale'?_0x650ea9+=_0x35f75d['amount']:_0x577834+=_0x35f75d[_0x469f1b(0x1f2)];}),_0x385611[_0x4bb691(0x20d)]=parseFloat(_0x650ea9)+0x0,_0x385611['sale_return']=parseFloat(_0x577834)+0x0,_0x385611;});console[_0x158c97(0x1fc)](_0x158c97(0x20e),_0x5d9616);if(_0x48fa04[0x0][_0x158c97(0x236)]==_0x158c97(0x207)){var _0x41a84b=users['English'];console[_0x158c97(0x1fc)](_0x41a84b);}else{if(_0x48fa04[0x0][_0x158c97(0x236)]==_0x158c97(0x1f8))var _0x41a84b=users[_0x158c97(0x1f8)];else{if(_0x48fa04[0x0]['language']==_0x158c97(0x242))var _0x41a84b=users[_0x158c97(0x242)];else{if(_0x48fa04[0x0]['language']=='Spanish')var _0x41a84b=users[_0x158c97(0x230)];else{if(_0x48fa04[0x0][_0x158c97(0x236)]==_0x158c97(0x20b))var _0x41a84b=users['French'];else{if(_0x48fa04[0x0][_0x158c97(0x236)]=='Portuguese\x20(BR)')var _0x41a84b=users[_0x158c97(0x25a)];else{if(_0x48fa04[0x0][_0x158c97(0x236)]==_0x158c97(0x235))var _0x41a84b=users[_0x158c97(0x235)];else{if(_0x48fa04[0x0]['language']==_0x158c97(0x229))var _0x41a84b=users[_0x158c97(0x226)];}}}}}}}_0x311d0c[_0x158c97(0x213)](_0x158c97(0x23d),{'success':_0xce069d[_0x158c97(0x217)](_0x158c97(0x259)),'errors':_0xce069d[_0x158c97(0x217)]('errors'),'user':_0xfc8c0c,'role':_0x207d0f,'profile':_0x29d2ca,'payment':_0x5d9616,'master_shop':_0x48fa04,'language':_0x41a84b});}catch(_0x13fbf5){console['log'](_0x13fbf5);}}),router[a0_0x199d67(0x251)](a0_0x199d67(0x23e),auth,async(_0x190dff,_0x51b0f7)=>{const _0x22c10e=a0_0x199d67;try{const {name:_0x19dc6f,address:_0x4555a2,mobile:_0x182631,email:_0x50718d,receivable:_0x4d8247,payable:_0x31c28d,contactperson:_0x4f6330,landline:_0x383e87}=_0x190dff[_0x22c10e(0x201)],_0x456cfc=new customer({'name':_0x19dc6f,'address':_0x4555a2,'mobile':_0x182631,'email':_0x50718d,'receivable':_0x4d8247,'payable':_0x31c28d,'contactperson':_0x4f6330,'landline':_0x383e87}),_0x26e0c=await _0x456cfc['save']();_0x190dff['flash'](_0x22c10e(0x259),_0x22c10e(0x255)),_0x51b0f7[_0x22c10e(0x245)](_0x22c10e(0x24e));}catch(_0x4bc21d){console['log'](_0x4bc21d);}}),router[a0_0x199d67(0x21a)](a0_0x199d67(0x214),auth,async(_0x29716a,_0x3324d5)=>{const _0x158e6b=a0_0x199d67;try{const {username:_0x43615e,email:_0x65c0b1,role:_0x3d8a79}=_0x29716a[_0x158e6b(0x22e)],_0x390bb5=_0x29716a[_0x158e6b(0x22e)],_0x1c569f=await profile[_0x158e6b(0x21c)]({'email':_0x390bb5[_0x158e6b(0x1f1)]}),_0x320171=await master_shop[_0x158e6b(0x228)]();console['log'](_0x158e6b(0x231),_0x320171);const _0x15c988=_0x29716a[_0x158e6b(0x233)]['id'],_0x5ac3f0=await customer['findById'](_0x15c988);if(_0x320171[0x0]['language']==_0x158e6b(0x207)){var _0xb30816=users[_0x158e6b(0x220)];console['log'](_0xb30816);}else{if(_0x320171[0x0][_0x158e6b(0x236)]==_0x158e6b(0x1f8))var _0xb30816=users[_0x158e6b(0x1f8)];else{if(_0x320171[0x0]['language']==_0x158e6b(0x242))var _0xb30816=users[_0x158e6b(0x242)];else{if(_0x320171[0x0][_0x158e6b(0x236)]=='Spanish')var _0xb30816=users[_0x158e6b(0x230)];else{if(_0x320171[0x0][_0x158e6b(0x236)]==_0x158e6b(0x20b))var _0xb30816=users['French'];else{if(_0x320171[0x0]['language']==_0x158e6b(0x248))var _0xb30816=users['Portuguese'];else{if(_0x320171[0x0][_0x158e6b(0x236)]==_0x158e6b(0x235))var _0xb30816=users[_0x158e6b(0x235)];else{if(_0x320171[0x0][_0x158e6b(0x236)]==_0x158e6b(0x229))var _0xb30816=users[_0x158e6b(0x226)];}}}}}}}_0x3324d5['render'](_0x158e6b(0x23d),{'success':_0x29716a[_0x158e6b(0x217)](_0x158e6b(0x259)),'errors':_0x29716a[_0x158e6b(0x217)](_0x158e6b(0x22a)),'role':_0x390bb5,'profile':_0x1c569f,'user':_0x5ac3f0,'master_shop':_0x320171,'language':_0xb30816});}catch(_0x47f2a5){console[_0x158e6b(0x1fc)](_0x47f2a5);}}),router[a0_0x199d67(0x251)](a0_0x199d67(0x214),auth,async(_0x2c9858,_0x309318)=>{const _0x4ea8dd=a0_0x199d67;try{const _0x5bb760=_0x2c9858[_0x4ea8dd(0x233)]['id'],_0x5c4580=await customer['findById'](_0x5bb760),{name:_0x4cc857,address:_0x4aaede,mobile:_0x1b1337,email:_0x29f0d3,receivable:_0x1138da,payable:_0x268d6c,contactperson:_0x4079d1,landline:_0xc001a8}=_0x2c9858[_0x4ea8dd(0x201)];_0x5c4580[_0x4ea8dd(0x210)]=_0x4cc857,_0x5c4580[_0x4ea8dd(0x22f)]=_0x4aaede,_0x5c4580[_0x4ea8dd(0x237)]=_0x1b1337,_0x5c4580[_0x4ea8dd(0x1f1)]=_0x29f0d3,_0x5c4580['receivable']=_0x1138da,_0x5c4580[_0x4ea8dd(0x250)]=_0x268d6c,_0x5c4580[_0x4ea8dd(0x224)]=_0x4079d1,_0x5c4580['landline']=_0xc001a8;const _0x479b25=await _0x5c4580['save']();_0x2c9858[_0x4ea8dd(0x217)](_0x4ea8dd(0x259),_0x4ea8dd(0x20c)),_0x309318[_0x4ea8dd(0x245)]('/customer/view');}catch(_0x55a071){console[_0x4ea8dd(0x1fc)](_0x55a071);}}),router[a0_0x199d67(0x21a)](a0_0x199d67(0x24f),auth,async(_0x31bdba,_0x208972)=>{const _0x2065cc=a0_0x199d67;try{const {username:_0x31e340,email:_0x280812,role:_0x913be3}=_0x31bdba['user'],_0x297eb0=_0x31bdba[_0x2065cc(0x22e)],_0x4246b1=await profile[_0x2065cc(0x21c)]({'email':_0x297eb0[_0x2065cc(0x1f1)]}),_0x2a7f70=await master_shop['find']();console[_0x2065cc(0x1fc)](_0x2065cc(0x231),_0x2a7f70),console['log'](_0x31bdba[_0x2065cc(0x233)]['id']);const _0x43cd9e=await customer['findOne']({'_id':_0x31bdba[_0x2065cc(0x233)]['id']});console[_0x2065cc(0x1fc)](_0x2065cc(0x1f5),_0x43cd9e);const _0x2b46ca=await c_payment_data[_0x2065cc(0x228)]({'customer':_0x43cd9e['name']});console[_0x2065cc(0x1fc)](_0x2b46ca);const _0x2959ae=await c_payment_data[_0x2065cc(0x232)]([{'$match':{'customer':_0x43cd9e['name']}},{'$match':{'reason':_0x2065cc(0x1fa)}},{'$group':{'_id':_0x2065cc(0x246),'sum':{'$sum':_0x2065cc(0x1ff)}}}]);console[_0x2065cc(0x1fc)](_0x2065cc(0x22d),_0x2959ae);const _0x46f775=await c_payment_data[_0x2065cc(0x232)]([{'$match':{'customer':_0x43cd9e['name']}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x2065cc(0x246),'sum':{'$sum':_0x2065cc(0x1ff)}}}]);console['log'](_0x2065cc(0x22b),_0x46f775);if(_0x2a7f70[0x0]['language']=='English\x20(US)'){var _0xd63145=users[_0x2065cc(0x220)];console['log'](_0xd63145);}else{if(_0x2a7f70[0x0][_0x2065cc(0x236)]==_0x2065cc(0x1f8))var _0xd63145=users[_0x2065cc(0x1f8)];else{if(_0x2a7f70[0x0][_0x2065cc(0x236)]==_0x2065cc(0x242))var _0xd63145=users[_0x2065cc(0x242)];else{if(_0x2a7f70[0x0]['language']==_0x2065cc(0x230))var _0xd63145=users[_0x2065cc(0x230)];else{if(_0x2a7f70[0x0][_0x2065cc(0x236)]==_0x2065cc(0x20b))var _0xd63145=users['French'];else{if(_0x2a7f70[0x0][_0x2065cc(0x236)]==_0x2065cc(0x248))var _0xd63145=users[_0x2065cc(0x25a)];else{if(_0x2a7f70[0x0][_0x2065cc(0x236)]==_0x2065cc(0x235))var _0xd63145=users['Chinese'];else{if(_0x2a7f70[0x0]['language']==_0x2065cc(0x229))var _0xd63145=users['Arabic'];}}}}}}}_0x208972[_0x2065cc(0x213)](_0x2065cc(0x20a),{'success':_0x31bdba[_0x2065cc(0x217)](_0x2065cc(0x259)),'errors':_0x31bdba[_0x2065cc(0x217)](_0x2065cc(0x22a)),'role':_0x297eb0,'profile':_0x4246b1,'payment':_0x2b46ca,'payable':_0x2959ae,'receivable':_0x46f775,'master_shop':_0x2a7f70,'language':_0xd63145});}catch(_0x3f7ad7){console[_0x2065cc(0x1fc)](_0x3f7ad7);}}),router['get'](a0_0x199d67(0x239),auth,async(_0x13bdbf,_0x250a44)=>{const _0x3acc54=a0_0x199d67;try{const _0x34bf7c=new excelJS[(_0x3acc54(0x21e))](),_0x29b6a8=_0x34bf7c[_0x3acc54(0x1fd)](_0x3acc54(0x22c));return _0x29b6a8[_0x3acc54(0x1fe)]=[{'header':'ID','key':_0x3acc54(0x202),'width':0xa},{'header':'Name','key':'PBrands','width':0xa},{'header':'SalesmanCode','key':_0x3acc54(0x222),'width':0xa},{'header':'SalesmanName','key':_0x3acc54(0x20f),'width':0xa},{'header':_0x3acc54(0x22f),'key':'address','width':0xa},{'header':_0x3acc54(0x237),'key':_0x3acc54(0x237),'width':0xa},{'header':_0x3acc54(0x1f1),'key':_0x3acc54(0x1f1),'width':0xa}],_0x250a44[_0x3acc54(0x256)](_0x3acc54(0x21d),_0x3acc54(0x204)),_0x250a44[_0x3acc54(0x256)]('Content-Disposition',_0x3acc54(0x241)),_0x34bf7c[_0x3acc54(0x1f7)]['write'](_0x250a44)['then'](()=>{const _0x587cfc=_0x3acc54;_0x250a44[_0x587cfc(0x257)](0xc8);});}catch(_0x1bd1f4){_0x250a44[_0x3acc54(0x257)](0x190)[_0x3acc54(0x225)]({'errors':_0x1bd1f4['message']});}});const storage1=multer[a0_0x199d67(0x23c)]({'destination':(_0x95308e,_0x424c6e,_0x8f75a1)=>{const _0x573330=a0_0x199d67;_0x8f75a1(null,_0x573330(0x209));},'filename':(_0x49a160,_0x506051,_0x5c73c5)=>{const _0x5c9a49=a0_0x199d67;_0x5c73c5(null,Date[_0x5c9a49(0x24b)]()+_0x506051[_0x5c9a49(0x258)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x1852(){const _0x4a842a=['Spanish','master','aggregate','params','utils','Chinese','language','mobile','reason','/products_export_migrate_file','2200959mIpjDy','exceljs','diskStorage','customer','/view','1176DpZHxr','4295320gNrTSH','attachment;\x20filename=customer_Migration_File.xlsx','German','17990iFpCdG','sheet_to_json','redirect','$reason','../middleware/auth','Portuguese\x20(BR)','json','multer','now','public/Migration/','15CzDeQo','/customer/view','/view/payment/:id','payable','post','map','filename','error','customer\x20add\x20successfully','setHeader','status','originalname','success','Portuguese','email','amount','321016rLUPgp','customer_docs','customer_data','4ozLSQo','xlsx','Hindi','element','Sale','../models/all_models','log','addWorksheet','columns','$amount','526202NOPqGc','body','PName','message','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','\x20added\x20successfully','Sheets','English\x20(US)','Name','public/Migration','customer_payment','French','customer\x20update\x20successfully','sale','payment_data','SalesmanName','name','readFile','5178MIoCEq','render','/view/:id','forEach','13435983wDKaLO','flash','4055FMaxzL','single','get','SheetNames','findOne','Content-Type','Workbook','SalesmanCode','English','c_payments','PUnits','/customer_import_migrate_file','contactperson','send','Arabic','customer_product_fule','find','Arabic\x20(ae)','errors','receivable_sum','Customers','payable_sum','user','address'];a0_0x1852=function(){return _0x4a842a;};return a0_0x1852();}router['post'](a0_0x199d67(0x223),auth,uploadMigrate[a0_0x199d67(0x219)](a0_0x199d67(0x227)),async(_0x405a3a,_0x4eb095)=>{const _0x4c9827=a0_0x199d67,_0x30644b=_0x405a3a['file'][_0x4c9827(0x253)],_0x352e4b=await xlsx[_0x4c9827(0x211)](_0x4c9827(0x24c)+_0x30644b);let _0x134ac5=_0x352e4b[_0x4c9827(0x21b)],_0x4cfe0c=xlsx[_0x4c9827(0x234)][_0x4c9827(0x244)](_0x352e4b[_0x4c9827(0x206)][_0x134ac5[0x0]]);for(const _0x747f0f of _0x4cfe0c){const _0xe882b6=_0x747f0f['ID'],_0x97a134=_0x747f0f[_0x4c9827(0x208)],_0x5d8f08=_0x747f0f[_0x4c9827(0x21f)],_0x2c4e91=_0x747f0f[_0x4c9827(0x20f)],_0x5cd32b=_0x747f0f['address'],_0x5c1301=_0x747f0f['mobile'],_0x93c04f=_0x747f0f[_0x4c9827(0x1f1)];try{let _0x185ab1=await customer[_0x4c9827(0x21c)]({'name':_0x97a134});if(!_0x185ab1){const _0x3398fc=new customer({'name':_0x97a134,'ID':_0xe882b6,'SalesmanCode':_0x5d8f08,'SalesmanName':_0x2c4e91,'address':_0x5cd32b,'mobile':_0x5c1301,'email':_0x93c04f});_0x185ab1=await _0x3398fc['save'](),_0x405a3a['flash']('success',_0x97a134+_0x4c9827(0x205));}else _0x405a3a[_0x4c9827(0x217)](_0x4c9827(0x254),_0x97a134+'\x20Failed');}catch(_0x58b90d){_0x4eb095[_0x4c9827(0x257)](0x1f4)[_0x4c9827(0x249)]({'proderror':_0x58b90d[_0x4c9827(0x203)],'aproduct':ProductName});}}_0x4eb095['redirect'](_0x4c9827(0x24e));}),module['exports']=router;