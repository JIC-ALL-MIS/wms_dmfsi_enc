const a0_0x113246=a0_0x2285;(function(_0x1c92c7,_0x346cb2){const _0x193906=a0_0x2285,_0x3f2bf9=_0x1c92c7();while(!![]){try{const _0x1b2cae=parseInt(_0x193906(0x1bd))/0x1*(-parseInt(_0x193906(0x185))/0x2)+parseInt(_0x193906(0x17a))/0x3+parseInt(_0x193906(0x1cb))/0x4+-parseInt(_0x193906(0x1c7))/0x5*(parseInt(_0x193906(0x1b7))/0x6)+parseInt(_0x193906(0x16b))/0x7+parseInt(_0x193906(0x1b5))/0x8+-parseInt(_0x193906(0x182))/0x9*(parseInt(_0x193906(0x173))/0xa);if(_0x1b2cae===_0x346cb2)break;else _0x3f2bf9['push'](_0x3f2bf9['shift']());}catch(_0x2c9348){_0x3f2bf9['push'](_0x3f2bf9['shift']());}}}(a0_0x18d6,0x45896));function a0_0x18d6(){const _0x5715b3=['customer_product_fule','send','then','2479PqIwIu','English\x20(US)','status','German','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','language','../middleware/auth','address','PUnits','/view','5YvBjEW','filename','setHeader','/view/:id','1005968EthcFg','findOne','sheet_to_json','/customer/view','Content-Disposition','single','French','Hindi','render','/products_export_migrate_file','xlsx','1728727aCEiMu','payable','file','forEach','Sale','c_payments','/view/payment/:id','customer_payment','120QEhrfW','payable_sum','SalesmanCode','diskStorage','SheetNames','data','payment_data','1550841qmWvAc','amount','mobile','public/Migration/','Spanish','element','error','attachment;\x20filename=customer_Migration_File.xlsx','264393fGAZuL','exports','log','314hSnknT','addWorksheet','multer','find','customer','customer_docs','Sale\x20Return','English','user','success','receivable','express','Chinese','Arabic','flash','findById','landline','exceljs','Workbook','aggregate','Portuguese','params','name','customer\x20update\x20successfully','Name','sale','Arabic\x20(ae)','sale_return','$reason','SalesmanName','contactperson','Sheets','Portuguese\x20(BR)','errors','PName','$amount','json','Router','master','post','Customers','utils','receivable_sum','map','body','public/Migration','email','redirect','3511288QpHNgz','readFile','2566572AhVVUe','save','get'];a0_0x18d6=function(){return _0x5715b3;};return a0_0x18d6();}const express=require(a0_0x113246(0x190)),app=express(),router=express[a0_0x113246(0x1aa)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require(a0_0x113246(0x1c3)),users=require('../public/language/languages.json'),excelJS=require(a0_0x113246(0x196)),xlsx=require(a0_0x113246(0x16a)),multer=require(a0_0x113246(0x187));function a0_0x2285(_0x2eca46,_0x2dfc74){const _0x18d664=a0_0x18d6();return a0_0x2285=function(_0x2285aa,_0x557b00){_0x2285aa=_0x2285aa-0x162;let _0x2fa558=_0x18d664[_0x2285aa];return _0x2fa558;},a0_0x2285(_0x2eca46,_0x2dfc74);}router[a0_0x113246(0x1b9)](a0_0x113246(0x1c6),auth,async(_0x4e209b,_0x37e501)=>{const _0x53edf7=a0_0x113246;try{const {username:_0x4de102,email:_0x122a1,role:_0x3787c5}=_0x4e209b[_0x53edf7(0x18d)],_0x3e30db=_0x4e209b[_0x53edf7(0x18d)],_0x2f04ff=await profile[_0x53edf7(0x1cc)]({'email':_0x3e30db['email']}),_0x403adf=await master_shop[_0x53edf7(0x188)]();console[_0x53edf7(0x184)](_0x53edf7(0x1ab),_0x403adf);const _0x2b8894=await customer[_0x53edf7(0x188)](),_0x30c9ce=await customer[_0x53edf7(0x198)]([{'$lookup':{'from':_0x53edf7(0x170),'localField':_0x53edf7(0x19b),'foreignField':_0x53edf7(0x189),'as':_0x53edf7(0x18a)}}]);console[_0x53edf7(0x184)](_0x30c9ce);const _0x5eb8e2=_0x30c9ce[_0x53edf7(0x1b0)](_0xe2fa36=>{const _0x31b2dc=_0x53edf7;console[_0x31b2dc(0x184)](_0x31b2dc(0x178),_0xe2fa36);var _0x44e9c1=0x0,_0x1b02c0=0x0;return _0xe2fa36[_0x31b2dc(0x18a)][_0x31b2dc(0x16e)](_0x5c1d8a=>{const _0x46b3a6=_0x31b2dc;console['log'](_0x46b3a6(0x17f),_0x5c1d8a),_0x5c1d8a['reason']==_0x46b3a6(0x16f)?_0x44e9c1+=_0x5c1d8a[_0x46b3a6(0x17b)]:_0x1b02c0+=_0x5c1d8a[_0x46b3a6(0x17b)];}),_0xe2fa36[_0x31b2dc(0x19e)]=parseFloat(_0x44e9c1)+0x0,_0xe2fa36[_0x31b2dc(0x1a0)]=parseFloat(_0x1b02c0)+0x0,_0xe2fa36;});console['log'](_0x53edf7(0x179),_0x5eb8e2);if(_0x403adf[0x0][_0x53edf7(0x1c2)]==_0x53edf7(0x1be)){var _0x4ff822=users[_0x53edf7(0x18c)];console[_0x53edf7(0x184)](_0x4ff822);}else{if(_0x403adf[0x0][_0x53edf7(0x1c2)]==_0x53edf7(0x167))var _0x4ff822=users[_0x53edf7(0x167)];else{if(_0x403adf[0x0][_0x53edf7(0x1c2)]==_0x53edf7(0x1c0))var _0x4ff822=users[_0x53edf7(0x1c0)];else{if(_0x403adf[0x0]['language']=='Spanish')var _0x4ff822=users[_0x53edf7(0x17e)];else{if(_0x403adf[0x0][_0x53edf7(0x1c2)]==_0x53edf7(0x166))var _0x4ff822=users[_0x53edf7(0x166)];else{if(_0x403adf[0x0]['language']==_0x53edf7(0x1a5))var _0x4ff822=users[_0x53edf7(0x199)];else{if(_0x403adf[0x0][_0x53edf7(0x1c2)]=='Chinese')var _0x4ff822=users[_0x53edf7(0x191)];else{if(_0x403adf[0x0][_0x53edf7(0x1c2)]==_0x53edf7(0x19f))var _0x4ff822=users[_0x53edf7(0x192)];}}}}}}}_0x37e501[_0x53edf7(0x168)]('customer',{'success':_0x4e209b[_0x53edf7(0x193)](_0x53edf7(0x18e)),'errors':_0x4e209b[_0x53edf7(0x193)](_0x53edf7(0x1a6)),'user':_0x2b8894,'role':_0x3e30db,'profile':_0x2f04ff,'payment':_0x5eb8e2,'master_shop':_0x403adf,'language':_0x4ff822});}catch(_0x8ac8a6){console[_0x53edf7(0x184)](_0x8ac8a6);}}),router[a0_0x113246(0x1ac)](a0_0x113246(0x1c6),auth,async(_0x22c97f,_0x575c74)=>{const _0x172153=a0_0x113246;try{const {name:_0x435631,address:_0x4b5eac,mobile:_0x5234cb,email:_0x4ea0c5,receivable:_0x2e63eb,payable:_0x21feb2,contactperson:_0x51048e,landline:_0x12e60c}=_0x22c97f['body'],_0x5e03a4=new customer({'name':_0x435631,'address':_0x4b5eac,'mobile':_0x5234cb,'email':_0x4ea0c5,'receivable':_0x2e63eb,'payable':_0x21feb2,'contactperson':_0x51048e,'landline':_0x12e60c}),_0x10437e=await _0x5e03a4[_0x172153(0x1b8)]();_0x22c97f[_0x172153(0x193)](_0x172153(0x18e),'customer\x20add\x20successfully'),_0x575c74[_0x172153(0x1b4)](_0x172153(0x163));}catch(_0x17c51){console[_0x172153(0x184)](_0x17c51);}}),router['get'](a0_0x113246(0x1ca),auth,async(_0x51fab6,_0x5907bf)=>{const _0x3e6f3e=a0_0x113246;try{const {username:_0x61a403,email:_0x2b4a36,role:_0x3393fe}=_0x51fab6[_0x3e6f3e(0x18d)],_0x146431=_0x51fab6['user'],_0x4248c0=await profile[_0x3e6f3e(0x1cc)]({'email':_0x146431['email']}),_0x37bdb6=await master_shop[_0x3e6f3e(0x188)]();console[_0x3e6f3e(0x184)](_0x3e6f3e(0x1ab),_0x37bdb6);const _0x5a8add=_0x51fab6[_0x3e6f3e(0x19a)]['id'],_0x5e8b65=await customer[_0x3e6f3e(0x194)](_0x5a8add);if(_0x37bdb6[0x0][_0x3e6f3e(0x1c2)]==_0x3e6f3e(0x1be)){var _0x1041e2=users[_0x3e6f3e(0x18c)];console[_0x3e6f3e(0x184)](_0x1041e2);}else{if(_0x37bdb6[0x0]['language']=='Hindi')var _0x1041e2=users[_0x3e6f3e(0x167)];else{if(_0x37bdb6[0x0][_0x3e6f3e(0x1c2)]=='German')var _0x1041e2=users[_0x3e6f3e(0x1c0)];else{if(_0x37bdb6[0x0][_0x3e6f3e(0x1c2)]==_0x3e6f3e(0x17e))var _0x1041e2=users[_0x3e6f3e(0x17e)];else{if(_0x37bdb6[0x0]['language']==_0x3e6f3e(0x166))var _0x1041e2=users[_0x3e6f3e(0x166)];else{if(_0x37bdb6[0x0][_0x3e6f3e(0x1c2)]==_0x3e6f3e(0x1a5))var _0x1041e2=users[_0x3e6f3e(0x199)];else{if(_0x37bdb6[0x0]['language']==_0x3e6f3e(0x191))var _0x1041e2=users['Chinese'];else{if(_0x37bdb6[0x0][_0x3e6f3e(0x1c2)]=='Arabic\x20(ae)')var _0x1041e2=users[_0x3e6f3e(0x192)];}}}}}}}_0x5907bf['render']('customer',{'success':_0x51fab6['flash'](_0x3e6f3e(0x18e)),'errors':_0x51fab6[_0x3e6f3e(0x193)]('errors'),'role':_0x146431,'profile':_0x4248c0,'user':_0x5e8b65,'master_shop':_0x37bdb6,'language':_0x1041e2});}catch(_0x33f3c4){console[_0x3e6f3e(0x184)](_0x33f3c4);}}),router['post'](a0_0x113246(0x1ca),auth,async(_0x3606ba,_0x42eee6)=>{const _0x3c316d=a0_0x113246;try{const _0x12c561=_0x3606ba['params']['id'],_0x15b5c0=await customer[_0x3c316d(0x194)](_0x12c561),{name:_0x256b63,address:_0x39a4f4,mobile:_0xe66e84,email:_0x19998b,receivable:_0x411b5b,payable:_0x4ce316,contactperson:_0x577e2c,landline:_0x1cc088}=_0x3606ba[_0x3c316d(0x1b1)];_0x15b5c0['name']=_0x256b63,_0x15b5c0['address']=_0x39a4f4,_0x15b5c0[_0x3c316d(0x17c)]=_0xe66e84,_0x15b5c0[_0x3c316d(0x1b3)]=_0x19998b,_0x15b5c0[_0x3c316d(0x18f)]=_0x411b5b,_0x15b5c0[_0x3c316d(0x16c)]=_0x4ce316,_0x15b5c0[_0x3c316d(0x1a3)]=_0x577e2c,_0x15b5c0[_0x3c316d(0x195)]=_0x1cc088;const _0x347321=await _0x15b5c0[_0x3c316d(0x1b8)]();_0x3606ba[_0x3c316d(0x193)]('success',_0x3c316d(0x19c)),_0x42eee6['redirect'](_0x3c316d(0x163));}catch(_0x1e7990){console['log'](_0x1e7990);}}),router[a0_0x113246(0x1b9)](a0_0x113246(0x171),auth,async(_0x476c4f,_0x3a3773)=>{const _0x45911b=a0_0x113246;try{const {username:_0x41a8af,email:_0x7f5824,role:_0x452025}=_0x476c4f['user'],_0x1aa9cf=_0x476c4f[_0x45911b(0x18d)],_0x20df28=await profile[_0x45911b(0x1cc)]({'email':_0x1aa9cf[_0x45911b(0x1b3)]}),_0x34661c=await master_shop[_0x45911b(0x188)]();console[_0x45911b(0x184)](_0x45911b(0x1ab),_0x34661c),console[_0x45911b(0x184)](_0x476c4f['params']['id']);const _0x30be73=await customer[_0x45911b(0x1cc)]({'_id':_0x476c4f[_0x45911b(0x19a)]['id']});console[_0x45911b(0x184)]('customer_data',_0x30be73);const _0x1766c2=await c_payment_data['find']({'customer':_0x30be73[_0x45911b(0x19b)]});console[_0x45911b(0x184)](_0x1766c2);const _0x17b56d=await c_payment_data[_0x45911b(0x198)]([{'$match':{'customer':_0x30be73[_0x45911b(0x19b)]}},{'$match':{'reason':_0x45911b(0x16f)}},{'$group':{'_id':_0x45911b(0x1a1),'sum':{'$sum':_0x45911b(0x1a8)}}}]);console['log'](_0x45911b(0x174),_0x17b56d);const _0x1a0f2e=await c_payment_data['aggregate']([{'$match':{'customer':_0x30be73['name']}},{'$match':{'reason':_0x45911b(0x18b)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x45911b(0x1a8)}}}]);console['log'](_0x45911b(0x1af),_0x1a0f2e);if(_0x34661c[0x0][_0x45911b(0x1c2)]==_0x45911b(0x1be)){var _0x53fbd0=users['English'];console[_0x45911b(0x184)](_0x53fbd0);}else{if(_0x34661c[0x0][_0x45911b(0x1c2)]==_0x45911b(0x167))var _0x53fbd0=users[_0x45911b(0x167)];else{if(_0x34661c[0x0][_0x45911b(0x1c2)]==_0x45911b(0x1c0))var _0x53fbd0=users[_0x45911b(0x1c0)];else{if(_0x34661c[0x0][_0x45911b(0x1c2)]==_0x45911b(0x17e))var _0x53fbd0=users[_0x45911b(0x17e)];else{if(_0x34661c[0x0]['language']=='French')var _0x53fbd0=users['French'];else{if(_0x34661c[0x0]['language']=='Portuguese\x20(BR)')var _0x53fbd0=users[_0x45911b(0x199)];else{if(_0x34661c[0x0]['language']==_0x45911b(0x191))var _0x53fbd0=users['Chinese'];else{if(_0x34661c[0x0][_0x45911b(0x1c2)]==_0x45911b(0x19f))var _0x53fbd0=users[_0x45911b(0x192)];}}}}}}}_0x3a3773[_0x45911b(0x168)](_0x45911b(0x172),{'success':_0x476c4f[_0x45911b(0x193)](_0x45911b(0x18e)),'errors':_0x476c4f[_0x45911b(0x193)](_0x45911b(0x1a6)),'role':_0x1aa9cf,'profile':_0x20df28,'payment':_0x1766c2,'payable':_0x17b56d,'receivable':_0x1a0f2e,'master_shop':_0x34661c,'language':_0x53fbd0});}catch(_0x5e2bd9){console[_0x45911b(0x184)](_0x5e2bd9);}}),router['get'](a0_0x113246(0x169),auth,async(_0x18e1f3,_0xbe6fa9)=>{const _0x125dd6=a0_0x113246;try{const _0x5d96af=new excelJS[(_0x125dd6(0x197))](),_0x309f5f=_0x5d96af[_0x125dd6(0x186)](_0x125dd6(0x1ad));return _0x309f5f['columns']=[{'header':'ID','key':_0x125dd6(0x1a7),'width':0xa},{'header':_0x125dd6(0x19d),'key':'PBrands','width':0xa},{'header':_0x125dd6(0x175),'key':_0x125dd6(0x1c5),'width':0xa},{'header':_0x125dd6(0x1a2),'key':_0x125dd6(0x1a2),'width':0xa},{'header':_0x125dd6(0x1c4),'key':_0x125dd6(0x1c4),'width':0xa},{'header':_0x125dd6(0x17c),'key':_0x125dd6(0x17c),'width':0xa},{'header':_0x125dd6(0x1b3),'key':_0x125dd6(0x1b3),'width':0xa}],_0xbe6fa9[_0x125dd6(0x1c9)]('Content-Type',_0x125dd6(0x1c1)),_0xbe6fa9[_0x125dd6(0x1c9)](_0x125dd6(0x164),_0x125dd6(0x181)),_0x5d96af[_0x125dd6(0x16a)]['write'](_0xbe6fa9)[_0x125dd6(0x1bc)](()=>{const _0x2a7aac=_0x125dd6;_0xbe6fa9[_0x2a7aac(0x1bf)](0xc8);});}catch(_0xc438b6){_0xbe6fa9[_0x125dd6(0x1bf)](0x190)[_0x125dd6(0x1bb)]({'errors':_0xc438b6['message']});}});const storage1=multer[a0_0x113246(0x176)]({'destination':(_0x303012,_0x26c7c5,_0x48e892)=>{const _0x58386f=a0_0x113246;_0x48e892(null,_0x58386f(0x1b2));},'filename':(_0x46e471,_0x3d7308,_0x251091)=>{_0x251091(null,Date['now']()+_0x3d7308['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x113246(0x1ac)]('/customer_import_migrate_file',auth,uploadMigrate[a0_0x113246(0x165)](a0_0x113246(0x1ba)),async(_0x392be0,_0x51f2e1)=>{const _0x2bb5f1=a0_0x113246,_0x2b5ca4=_0x392be0[_0x2bb5f1(0x16d)][_0x2bb5f1(0x1c8)],_0x3bae37=await xlsx[_0x2bb5f1(0x1b6)](_0x2bb5f1(0x17d)+_0x2b5ca4);let _0x55ab98=_0x3bae37[_0x2bb5f1(0x177)],_0x27860d=xlsx[_0x2bb5f1(0x1ae)][_0x2bb5f1(0x162)](_0x3bae37[_0x2bb5f1(0x1a4)][_0x55ab98[0x0]]);for(const _0x16424c of _0x27860d){const _0x19c10d=_0x16424c['ID'],_0x1dc7ef=_0x16424c[_0x2bb5f1(0x19d)],_0x440c77=_0x16424c[_0x2bb5f1(0x175)],_0x51b2fc=_0x16424c[_0x2bb5f1(0x1a2)],_0x48b13b=_0x16424c['address'],_0x375d15=_0x16424c['mobile'],_0x317294=_0x16424c['email'];try{let _0x41a24c=await customer[_0x2bb5f1(0x1cc)]({'name':_0x1dc7ef});if(!_0x41a24c){const _0x3eb13f=new customer({'name':_0x1dc7ef,'ID':_0x19c10d,'SalesmanCode':_0x440c77,'SalesmanName':_0x51b2fc,'address':_0x48b13b,'mobile':_0x375d15,'email':_0x317294});_0x41a24c=await _0x3eb13f[_0x2bb5f1(0x1b8)](),_0x392be0[_0x2bb5f1(0x193)](_0x2bb5f1(0x18e),_0x1dc7ef+'\x20added\x20successfully');}else _0x392be0['flash'](_0x2bb5f1(0x180),_0x1dc7ef+'\x20Failed');}catch(_0x33b109){_0x51f2e1[_0x2bb5f1(0x1bf)](0x1f4)[_0x2bb5f1(0x1a9)]({'proderror':_0x33b109['message'],'aproduct':ProductName});}}_0x51f2e1[_0x2bb5f1(0x1b4)](_0x2bb5f1(0x163));}),module[a0_0x113246(0x183)]=router;