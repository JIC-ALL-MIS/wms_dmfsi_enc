const a0_0x5ab555=a0_0x3b62;function a0_0x3b62(_0x155e8d,_0x1834e3){const _0x3e10f9=a0_0x3e10();return a0_0x3b62=function(_0x3b6215,_0x2450d0){_0x3b6215=_0x3b6215-0x1c1;let _0x299fea=_0x3e10f9[_0x3b6215];return _0x299fea;},a0_0x3b62(_0x155e8d,_0x1834e3);}(function(_0x33b4e1,_0x142d77){const _0x272079=a0_0x3b62,_0x178bad=_0x33b4e1();while(!![]){try{const _0x1308c9=parseInt(_0x272079(0x216))/0x1+-parseInt(_0x272079(0x1dd))/0x2*(-parseInt(_0x272079(0x20f))/0x3)+parseInt(_0x272079(0x208))/0x4*(-parseInt(_0x272079(0x21e))/0x5)+-parseInt(_0x272079(0x1f1))/0x6*(parseInt(_0x272079(0x1c1))/0x7)+parseInt(_0x272079(0x210))/0x8*(parseInt(_0x272079(0x224))/0x9)+-parseInt(_0x272079(0x212))/0xa*(-parseInt(_0x272079(0x1f6))/0xb)+parseInt(_0x272079(0x218))/0xc;if(_0x1308c9===_0x142d77)break;else _0x178bad['push'](_0x178bad['shift']());}catch(_0x4c62f1){_0x178bad['push'](_0x178bad['shift']());}}}(a0_0x3e10,0x73ae6));function a0_0x3e10(){const _0x3fabf1=['express','6rJwvbG','post','Customers','setHeader','receivable_sum','55zHhErU','single','Name','payment_data','error','file','PBrands','mobile','Sale','amount','element','readFile','../public/language/languages.json','contactperson','multer','Sheets','json','Sale\x20Return','3304888sSKgAk','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','diskStorage','Portuguese','findOne','../models/all_models','customer_docs','16011kDbBCV','42736cegsHI','aggregate','356250HDVmoJ','language','Router','landline','180215kVNamG','forEach','5010516WjBBPV','email','Chinese','customer','public/Migration/','xlsx','5cSjJBg','customer_data','master','payable','customer\x20add\x20successfully','sale_return','1197QwTwng','attachment;\x20filename=customer_Migration_File.xlsx','data','sale','log','German','customer\x20update\x20successfully','receivable','4666529kxgIdF','params','redirect','Arabic','SalesmanCode','now','Portuguese\x20(BR)','\x20added\x20successfully','render','write','get','status','customer_payment','columns','PName','$reason','/view','flash','address','/customer/view','English\x20(US)','user','exceljs','$amount','reason','find','customer_product_fule','Hindi','180VoCGnO','message','Arabic\x20(ae)','c_payments','body','errors','save','/customer_import_migrate_file','French','/view/:id','findById','PUnits','../middleware/auth','/products_export_migrate_file','Spanish','name','success','English','SalesmanName'];a0_0x3e10=function(){return _0x3fabf1;};return a0_0x3e10();}const express=require(a0_0x5ab555(0x1f0)),app=express(),router=express[a0_0x5ab555(0x214)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x5ab555(0x20d)),auth=require(a0_0x5ab555(0x1e9)),users=require(a0_0x5ab555(0x202)),excelJS=require(a0_0x5ab555(0x1d7)),xlsx=require(a0_0x5ab555(0x21d)),multer=require(a0_0x5ab555(0x204));router[a0_0x5ab555(0x1cb)](a0_0x5ab555(0x1d1),auth,async(_0x56b61a,_0x556f04)=>{const _0x3a4408=a0_0x5ab555;try{const {username:_0x40b33f,email:_0x5df854,role:_0x703fee}=_0x56b61a[_0x3a4408(0x1d6)],_0x2f3b70=_0x56b61a[_0x3a4408(0x1d6)],_0xd1fc73=await profile[_0x3a4408(0x20c)]({'email':_0x2f3b70[_0x3a4408(0x219)]}),_0x2a417a=await master_shop[_0x3a4408(0x1da)]();console['log']('master',_0x2a417a);const _0x24a5f7=await customer[_0x3a4408(0x1da)](),_0x343c20=await customer[_0x3a4408(0x211)]([{'$lookup':{'from':_0x3a4408(0x1e0),'localField':'name','foreignField':_0x3a4408(0x21b),'as':_0x3a4408(0x20e)}}]);console['log'](_0x343c20);const _0x45bb5b=_0x343c20['map'](_0x36233e=>{const _0x8b1b16=_0x3a4408;console[_0x8b1b16(0x228)](_0x8b1b16(0x226),_0x36233e);var _0x15bd8a=0x0,_0x5c3ce0=0x0;return _0x36233e['customer_docs'][_0x8b1b16(0x217)](_0x2309aa=>{const _0x4b66bf=_0x8b1b16;console['log'](_0x4b66bf(0x200),_0x2309aa),_0x2309aa[_0x4b66bf(0x1d9)]==_0x4b66bf(0x1fe)?_0x15bd8a+=_0x2309aa[_0x4b66bf(0x1ff)]:_0x5c3ce0+=_0x2309aa[_0x4b66bf(0x1ff)];}),_0x36233e[_0x8b1b16(0x227)]=parseFloat(_0x15bd8a)+0x0,_0x36233e[_0x8b1b16(0x223)]=parseFloat(_0x5c3ce0)+0x0,_0x36233e;});console['log'](_0x3a4408(0x1f9),_0x45bb5b);if(_0x2a417a[0x0][_0x3a4408(0x213)]==_0x3a4408(0x1d5)){var _0x5df17d=users['English'];console[_0x3a4408(0x228)](_0x5df17d);}else{if(_0x2a417a[0x0][_0x3a4408(0x213)]=='Hindi')var _0x5df17d=users[_0x3a4408(0x1dc)];else{if(_0x2a417a[0x0]['language']==_0x3a4408(0x229))var _0x5df17d=users[_0x3a4408(0x229)];else{if(_0x2a417a[0x0][_0x3a4408(0x213)]==_0x3a4408(0x1eb))var _0x5df17d=users[_0x3a4408(0x1eb)];else{if(_0x2a417a[0x0]['language']==_0x3a4408(0x1e5))var _0x5df17d=users['French'];else{if(_0x2a417a[0x0][_0x3a4408(0x213)]=='Portuguese\x20(BR)')var _0x5df17d=users[_0x3a4408(0x20b)];else{if(_0x2a417a[0x0][_0x3a4408(0x213)]==_0x3a4408(0x21a))var _0x5df17d=users[_0x3a4408(0x21a)];else{if(_0x2a417a[0x0][_0x3a4408(0x213)]=='Arabic\x20(ae)')var _0x5df17d=users[_0x3a4408(0x1c4)];}}}}}}}_0x556f04['render'](_0x3a4408(0x21b),{'success':_0x56b61a[_0x3a4408(0x1d2)](_0x3a4408(0x1ed)),'errors':_0x56b61a[_0x3a4408(0x1d2)]('errors'),'user':_0x24a5f7,'role':_0x2f3b70,'profile':_0xd1fc73,'payment':_0x45bb5b,'master_shop':_0x2a417a,'language':_0x5df17d});}catch(_0x42d147){console['log'](_0x42d147);}}),router[a0_0x5ab555(0x1f2)](a0_0x5ab555(0x1d1),auth,async(_0x40b41e,_0x4f383c)=>{const _0x2290dc=a0_0x5ab555;try{const {name:_0x11369b,address:_0x1e0453,mobile:_0xc59151,email:_0x6f8c1d,receivable:_0xd7ab1e,payable:_0x117d87,contactperson:_0x42299e,landline:_0x34fdc5}=_0x40b41e[_0x2290dc(0x1e1)],_0x503cb0=new customer({'name':_0x11369b,'address':_0x1e0453,'mobile':_0xc59151,'email':_0x6f8c1d,'receivable':_0xd7ab1e,'payable':_0x117d87,'contactperson':_0x42299e,'landline':_0x34fdc5}),_0x2b9e88=await _0x503cb0[_0x2290dc(0x1e3)]();_0x40b41e[_0x2290dc(0x1d2)](_0x2290dc(0x1ed),_0x2290dc(0x222)),_0x4f383c[_0x2290dc(0x1c3)](_0x2290dc(0x1d4));}catch(_0x3ed6ce){console[_0x2290dc(0x228)](_0x3ed6ce);}}),router[a0_0x5ab555(0x1cb)](a0_0x5ab555(0x1e6),auth,async(_0x43fb93,_0x1b91d9)=>{const _0x5b39d6=a0_0x5ab555;try{const {username:_0x16e583,email:_0x40c128,role:_0x22ea3f}=_0x43fb93['user'],_0x513a8c=_0x43fb93['user'],_0x48475c=await profile[_0x5b39d6(0x20c)]({'email':_0x513a8c['email']}),_0x1fcdfd=await master_shop[_0x5b39d6(0x1da)]();console[_0x5b39d6(0x228)](_0x5b39d6(0x220),_0x1fcdfd);const _0x4fe372=_0x43fb93[_0x5b39d6(0x1c2)]['id'],_0x448936=await customer['findById'](_0x4fe372);if(_0x1fcdfd[0x0][_0x5b39d6(0x213)]=='English\x20(US)'){var _0x7fa1a3=users[_0x5b39d6(0x1ee)];console[_0x5b39d6(0x228)](_0x7fa1a3);}else{if(_0x1fcdfd[0x0][_0x5b39d6(0x213)]=='Hindi')var _0x7fa1a3=users['Hindi'];else{if(_0x1fcdfd[0x0]['language']==_0x5b39d6(0x229))var _0x7fa1a3=users[_0x5b39d6(0x229)];else{if(_0x1fcdfd[0x0][_0x5b39d6(0x213)]==_0x5b39d6(0x1eb))var _0x7fa1a3=users[_0x5b39d6(0x1eb)];else{if(_0x1fcdfd[0x0][_0x5b39d6(0x213)]=='French')var _0x7fa1a3=users['French'];else{if(_0x1fcdfd[0x0][_0x5b39d6(0x213)]=='Portuguese\x20(BR)')var _0x7fa1a3=users[_0x5b39d6(0x20b)];else{if(_0x1fcdfd[0x0][_0x5b39d6(0x213)]=='Chinese')var _0x7fa1a3=users[_0x5b39d6(0x21a)];else{if(_0x1fcdfd[0x0][_0x5b39d6(0x213)]==_0x5b39d6(0x1df))var _0x7fa1a3=users[_0x5b39d6(0x1c4)];}}}}}}}_0x1b91d9['render']('customer',{'success':_0x43fb93[_0x5b39d6(0x1d2)](_0x5b39d6(0x1ed)),'errors':_0x43fb93[_0x5b39d6(0x1d2)](_0x5b39d6(0x1e2)),'role':_0x513a8c,'profile':_0x48475c,'user':_0x448936,'master_shop':_0x1fcdfd,'language':_0x7fa1a3});}catch(_0x31eb7d){console[_0x5b39d6(0x228)](_0x31eb7d);}}),router[a0_0x5ab555(0x1f2)](a0_0x5ab555(0x1e6),auth,async(_0x44f863,_0x33303a)=>{const _0x29a396=a0_0x5ab555;try{const _0x59e2d6=_0x44f863[_0x29a396(0x1c2)]['id'],_0x598438=await customer[_0x29a396(0x1e7)](_0x59e2d6),{name:_0x5acd32,address:_0x4baeeb,mobile:_0x546024,email:_0x1795b2,receivable:_0x459c34,payable:_0x49b73c,contactperson:_0x5583be,landline:_0x1be21b}=_0x44f863['body'];_0x598438[_0x29a396(0x1ec)]=_0x5acd32,_0x598438[_0x29a396(0x1d3)]=_0x4baeeb,_0x598438[_0x29a396(0x1fd)]=_0x546024,_0x598438[_0x29a396(0x219)]=_0x1795b2,_0x598438[_0x29a396(0x22b)]=_0x459c34,_0x598438[_0x29a396(0x221)]=_0x49b73c,_0x598438[_0x29a396(0x203)]=_0x5583be,_0x598438[_0x29a396(0x215)]=_0x1be21b;const _0x3bafc2=await _0x598438[_0x29a396(0x1e3)]();_0x44f863[_0x29a396(0x1d2)](_0x29a396(0x1ed),_0x29a396(0x22a)),_0x33303a[_0x29a396(0x1c3)](_0x29a396(0x1d4));}catch(_0x435d90){console['log'](_0x435d90);}}),router[a0_0x5ab555(0x1cb)]('/view/payment/:id',auth,async(_0x5b7ed7,_0x2dec4e)=>{const _0x39637c=a0_0x5ab555;try{const {username:_0x406cd8,email:_0x2e1d69,role:_0x2c3823}=_0x5b7ed7[_0x39637c(0x1d6)],_0x34c3f2=_0x5b7ed7[_0x39637c(0x1d6)],_0x46bb6c=await profile['findOne']({'email':_0x34c3f2['email']}),_0x41911c=await master_shop['find']();console[_0x39637c(0x228)](_0x39637c(0x220),_0x41911c),console[_0x39637c(0x228)](_0x5b7ed7[_0x39637c(0x1c2)]['id']);const _0xc52dff=await customer[_0x39637c(0x20c)]({'_id':_0x5b7ed7['params']['id']});console[_0x39637c(0x228)](_0x39637c(0x21f),_0xc52dff);const _0x1df09f=await c_payment_data[_0x39637c(0x1da)]({'customer':_0xc52dff['name']});console[_0x39637c(0x228)](_0x1df09f);const _0x1bc39c=await c_payment_data[_0x39637c(0x211)]([{'$match':{'customer':_0xc52dff['name']}},{'$match':{'reason':_0x39637c(0x1fe)}},{'$group':{'_id':_0x39637c(0x1d0),'sum':{'$sum':_0x39637c(0x1d8)}}}]);console[_0x39637c(0x228)]('payable_sum',_0x1bc39c);const _0x26225f=await c_payment_data['aggregate']([{'$match':{'customer':_0xc52dff[_0x39637c(0x1ec)]}},{'$match':{'reason':_0x39637c(0x207)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x39637c(0x1d8)}}}]);console[_0x39637c(0x228)](_0x39637c(0x1f5),_0x26225f);if(_0x41911c[0x0][_0x39637c(0x213)]==_0x39637c(0x1d5)){var _0x4197f5=users[_0x39637c(0x1ee)];console['log'](_0x4197f5);}else{if(_0x41911c[0x0][_0x39637c(0x213)]==_0x39637c(0x1dc))var _0x4197f5=users[_0x39637c(0x1dc)];else{if(_0x41911c[0x0][_0x39637c(0x213)]==_0x39637c(0x229))var _0x4197f5=users[_0x39637c(0x229)];else{if(_0x41911c[0x0][_0x39637c(0x213)]=='Spanish')var _0x4197f5=users[_0x39637c(0x1eb)];else{if(_0x41911c[0x0][_0x39637c(0x213)]==_0x39637c(0x1e5))var _0x4197f5=users[_0x39637c(0x1e5)];else{if(_0x41911c[0x0][_0x39637c(0x213)]==_0x39637c(0x1c7))var _0x4197f5=users[_0x39637c(0x20b)];else{if(_0x41911c[0x0][_0x39637c(0x213)]=='Chinese')var _0x4197f5=users['Chinese'];else{if(_0x41911c[0x0][_0x39637c(0x213)]==_0x39637c(0x1df))var _0x4197f5=users[_0x39637c(0x1c4)];}}}}}}}_0x2dec4e[_0x39637c(0x1c9)](_0x39637c(0x1cd),{'success':_0x5b7ed7[_0x39637c(0x1d2)](_0x39637c(0x1ed)),'errors':_0x5b7ed7[_0x39637c(0x1d2)](_0x39637c(0x1e2)),'role':_0x34c3f2,'profile':_0x46bb6c,'payment':_0x1df09f,'payable':_0x1bc39c,'receivable':_0x26225f,'master_shop':_0x41911c,'language':_0x4197f5});}catch(_0xb3e784){console[_0x39637c(0x228)](_0xb3e784);}}),router[a0_0x5ab555(0x1cb)](a0_0x5ab555(0x1ea),auth,async(_0x319f56,_0x19132a)=>{const _0x4ce101=a0_0x5ab555;try{const _0x3d9fa2=new excelJS['Workbook'](),_0x5329fd=_0x3d9fa2['addWorksheet'](_0x4ce101(0x1f3));return _0x5329fd[_0x4ce101(0x1ce)]=[{'header':'ID','key':_0x4ce101(0x1cf),'width':0xa},{'header':_0x4ce101(0x1f8),'key':_0x4ce101(0x1fc),'width':0xa},{'header':'SalesmanCode','key':_0x4ce101(0x1e8),'width':0xa},{'header':'SalesmanName','key':_0x4ce101(0x1ef),'width':0xa},{'header':_0x4ce101(0x1d3),'key':_0x4ce101(0x1d3),'width':0xa},{'header':'mobile','key':_0x4ce101(0x1fd),'width':0xa},{'header':'email','key':'email','width':0xa}],_0x19132a['setHeader']('Content-Type',_0x4ce101(0x209)),_0x19132a[_0x4ce101(0x1f4)]('Content-Disposition',_0x4ce101(0x225)),_0x3d9fa2[_0x4ce101(0x21d)][_0x4ce101(0x1ca)](_0x19132a)['then'](()=>{const _0x115c86=_0x4ce101;_0x19132a[_0x115c86(0x1cc)](0xc8);});}catch(_0x592e6f){_0x19132a['status'](0x190)['send']({'errors':_0x592e6f[_0x4ce101(0x1de)]});}});const storage1=multer[a0_0x5ab555(0x20a)]({'destination':(_0x4a6cb7,_0x9ad7fa,_0x3ce8e3)=>{_0x3ce8e3(null,'public/Migration');},'filename':(_0xab888e,_0x556262,_0x4b6797)=>{const _0x5b5b5f=a0_0x5ab555;_0x4b6797(null,Date[_0x5b5b5f(0x1c6)]()+_0x556262['originalname']);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x5ab555(0x1e4),auth,uploadMigrate[a0_0x5ab555(0x1f7)](a0_0x5ab555(0x1db)),async(_0x4b2fd5,_0x2607bd)=>{const _0x377cb0=a0_0x5ab555,_0x26c07e=_0x4b2fd5[_0x377cb0(0x1fb)]['filename'],_0x3359f8=await xlsx[_0x377cb0(0x201)](_0x377cb0(0x21c)+_0x26c07e);let _0x8f0f46=_0x3359f8['SheetNames'],_0x42a95e=xlsx['utils']['sheet_to_json'](_0x3359f8[_0x377cb0(0x205)][_0x8f0f46[0x0]]);for(const _0x1c3da6 of _0x42a95e){const _0x2f2ee8=_0x1c3da6['ID'],_0x37b3c5=_0x1c3da6[_0x377cb0(0x1f8)],_0x21eae3=_0x1c3da6[_0x377cb0(0x1c5)],_0x49d289=_0x1c3da6[_0x377cb0(0x1ef)],_0x390aab=_0x1c3da6[_0x377cb0(0x1d3)],_0x19333e=_0x1c3da6[_0x377cb0(0x1fd)],_0x5b0a5e=_0x1c3da6['email'];try{let _0x1ddf49=await customer['findOne']({'name':_0x37b3c5});if(!_0x1ddf49){const _0x46e142=new customer({'name':_0x37b3c5,'ID':_0x2f2ee8,'SalesmanCode':_0x21eae3,'SalesmanName':_0x49d289,'address':_0x390aab,'mobile':_0x19333e,'email':_0x5b0a5e});_0x1ddf49=await _0x46e142[_0x377cb0(0x1e3)](),_0x4b2fd5[_0x377cb0(0x1d2)](_0x377cb0(0x1ed),_0x37b3c5+_0x377cb0(0x1c8));}else _0x4b2fd5[_0x377cb0(0x1d2)](_0x377cb0(0x1fa),_0x37b3c5+'\x20Failed');}catch(_0x1fd78b){_0x2607bd[_0x377cb0(0x1cc)](0x1f4)[_0x377cb0(0x206)]({'proderror':_0x1fd78b[_0x377cb0(0x1de)],'aproduct':ProductName});}}_0x2607bd[_0x377cb0(0x1c3)](_0x377cb0(0x1d4));}),module['exports']=router;