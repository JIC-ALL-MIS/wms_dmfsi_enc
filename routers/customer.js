function a0_0x802a(_0x5ece49,_0xea8598){const _0x3d7602=a0_0x3d76();return a0_0x802a=function(_0x802a86,_0x46a75f){_0x802a86=_0x802a86-0x18a;let _0x1f1b86=_0x3d7602[_0x802a86];return _0x1f1b86;},a0_0x802a(_0x5ece49,_0xea8598);}const a0_0x2f18cc=a0_0x802a;function a0_0x3d76(){const _0x2465e0=['email','single','9UIdrmp','public/Migration','aggregate','English\x20(US)','mobile','German','user','get','../public/language/languages.json','SalesmanCode','master','json','forEach','setHeader','element','receivable','French','attachment;\x20filename=customer_Migration_File.xlsx','sheet_to_json','body','Router','2825634xlvlIj','flash','Workbook','exports','columns','write','address','findOne','language','multer','$amount','customer\x20add\x20successfully','status','Hindi','contactperson','13760520XukqIe','save','/view','redirect','exceljs','967400KIuaQa','customer_data','now','948CjwPvW','sale','filename','/view/payment/:id','/customer/view','render','map','public/Migration/','/view/:id','../middleware/auth','SalesmanName','Sale\x20Return','/products_export_migrate_file','amount','file','Chinese','findById','Name','success','Portuguese\x20(BR)','express','$reason','\x20Failed','xlsx','Arabic','Portuguese','Arabic\x20(ae)','post','error','customer_product_fule','customer_docs','369248wdAGTB','SheetNames','c_payments','\x20added\x20successfully','name','Content-Disposition','find','English','sale_return','utils','then','../models/all_models','1816516lFozgp','message','diskStorage','PName','/customer_import_migrate_file','params','365vqKTHI','data','Spanish','readFile','log','customer\x20update\x20successfully','415057shvpen','customer','Sale','errors'];a0_0x3d76=function(){return _0x2465e0;};return a0_0x3d76();}(function(_0x5d6cad,_0x4c047c){const _0x126be0=a0_0x802a,_0x40a75c=_0x5d6cad();while(!![]){try{const _0x204caf=-parseInt(_0x126be0(0x190))/0x1+-parseInt(_0x126be0(0x1e1))/0x2+-parseInt(_0x126be0(0x1ab))/0x3+parseInt(_0x126be0(0x1ed))/0x4+-parseInt(_0x126be0(0x18a))/0x5*(-parseInt(_0x126be0(0x1c2))/0x6)+-parseInt(_0x126be0(0x1bf))/0x7+-parseInt(_0x126be0(0x1ba))/0x8*(-parseInt(_0x126be0(0x196))/0x9);if(_0x204caf===_0x4c047c)break;else _0x40a75c['push'](_0x40a75c['shift']());}catch(_0x550ab7){_0x40a75c['push'](_0x40a75c['shift']());}}}(a0_0x3d76,0x7b871));const express=require(a0_0x2f18cc(0x1d6)),app=express(),router=express[a0_0x2f18cc(0x1aa)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x2f18cc(0x1ec)),auth=require(a0_0x2f18cc(0x1cb)),users=require(a0_0x2f18cc(0x19e)),excelJS=require(a0_0x2f18cc(0x1be)),xlsx=require(a0_0x2f18cc(0x1d9)),multer=require(a0_0x2f18cc(0x1b4));router['get'](a0_0x2f18cc(0x1bc),auth,async(_0x593d2c,_0x1b9bfc)=>{const _0x3424ff=a0_0x2f18cc;try{const {username:_0x29d2ba,email:_0x231291,role:_0xc55889}=_0x593d2c['user'],_0xc04c79=_0x593d2c['user'],_0x2e4172=await profile[_0x3424ff(0x1b2)]({'email':_0xc04c79[_0x3424ff(0x194)]}),_0x155e5c=await master_shop[_0x3424ff(0x1e7)]();console[_0x3424ff(0x18e)](_0x3424ff(0x1a0),_0x155e5c);const _0x1867a3=await customer['find'](),_0x198a45=await customer['aggregate']([{'$lookup':{'from':_0x3424ff(0x1e3),'localField':'name','foreignField':_0x3424ff(0x191),'as':_0x3424ff(0x1e0)}}]);console[_0x3424ff(0x18e)](_0x198a45);const _0x4e2e0a=_0x198a45[_0x3424ff(0x1c8)](_0x380298=>{const _0x50c396=_0x3424ff;console[_0x50c396(0x18e)](_0x50c396(0x18b),_0x380298);var _0x4ec63f=0x0,_0x1908a4=0x0;return _0x380298['customer_docs'][_0x50c396(0x1a2)](_0x36035b=>{const _0xbbc642=_0x50c396;console[_0xbbc642(0x18e)](_0xbbc642(0x1a4),_0x36035b),_0x36035b['reason']==_0xbbc642(0x192)?_0x4ec63f+=_0x36035b[_0xbbc642(0x1cf)]:_0x1908a4+=_0x36035b[_0xbbc642(0x1cf)];}),_0x380298[_0x50c396(0x1c3)]=parseFloat(_0x4ec63f)+0x0,_0x380298[_0x50c396(0x1e9)]=parseFloat(_0x1908a4)+0x0,_0x380298;});console[_0x3424ff(0x18e)]('payment_data',_0x4e2e0a);if(_0x155e5c[0x0][_0x3424ff(0x1b3)]==_0x3424ff(0x199)){var _0xc04b6=users[_0x3424ff(0x1e8)];console[_0x3424ff(0x18e)](_0xc04b6);}else{if(_0x155e5c[0x0][_0x3424ff(0x1b3)]==_0x3424ff(0x1b8))var _0xc04b6=users[_0x3424ff(0x1b8)];else{if(_0x155e5c[0x0][_0x3424ff(0x1b3)]==_0x3424ff(0x19b))var _0xc04b6=users[_0x3424ff(0x19b)];else{if(_0x155e5c[0x0][_0x3424ff(0x1b3)]==_0x3424ff(0x18c))var _0xc04b6=users[_0x3424ff(0x18c)];else{if(_0x155e5c[0x0]['language']==_0x3424ff(0x1a6))var _0xc04b6=users[_0x3424ff(0x1a6)];else{if(_0x155e5c[0x0][_0x3424ff(0x1b3)]==_0x3424ff(0x1d5))var _0xc04b6=users[_0x3424ff(0x1db)];else{if(_0x155e5c[0x0][_0x3424ff(0x1b3)]=='Chinese')var _0xc04b6=users[_0x3424ff(0x1d1)];else{if(_0x155e5c[0x0]['language']==_0x3424ff(0x1dc))var _0xc04b6=users[_0x3424ff(0x1da)];}}}}}}}_0x1b9bfc[_0x3424ff(0x1c7)](_0x3424ff(0x191),{'success':_0x593d2c[_0x3424ff(0x1ac)](_0x3424ff(0x1d4)),'errors':_0x593d2c['flash'](_0x3424ff(0x193)),'user':_0x1867a3,'role':_0xc04c79,'profile':_0x2e4172,'payment':_0x4e2e0a,'master_shop':_0x155e5c,'language':_0xc04b6});}catch(_0x481ba){console[_0x3424ff(0x18e)](_0x481ba);}}),router['post'](a0_0x2f18cc(0x1bc),auth,async(_0x3759e5,_0x205e43)=>{const _0x2695ed=a0_0x2f18cc;try{const {name:_0x353f86,address:_0x30367d,mobile:_0x3cb12d,email:_0x396160,receivable:_0x49d8a6,payable:_0x53838d,contactperson:_0x2ef4b4,landline:_0x4eefa1}=_0x3759e5['body'],_0x611bbc=new customer({'name':_0x353f86,'address':_0x30367d,'mobile':_0x3cb12d,'email':_0x396160,'receivable':_0x49d8a6,'payable':_0x53838d,'contactperson':_0x2ef4b4,'landline':_0x4eefa1}),_0x13d0c7=await _0x611bbc['save']();_0x3759e5[_0x2695ed(0x1ac)](_0x2695ed(0x1d4),_0x2695ed(0x1b6)),_0x205e43[_0x2695ed(0x1bd)](_0x2695ed(0x1c6));}catch(_0xb84417){console[_0x2695ed(0x18e)](_0xb84417);}}),router[a0_0x2f18cc(0x19d)](a0_0x2f18cc(0x1ca),auth,async(_0x119d0b,_0xab3634)=>{const _0x5dd5fa=a0_0x2f18cc;try{const {username:_0x451085,email:_0x5787d0,role:_0x310f5f}=_0x119d0b[_0x5dd5fa(0x19c)],_0x3b06cf=_0x119d0b[_0x5dd5fa(0x19c)],_0x4008ee=await profile[_0x5dd5fa(0x1b2)]({'email':_0x3b06cf['email']}),_0x584028=await master_shop['find']();console[_0x5dd5fa(0x18e)](_0x5dd5fa(0x1a0),_0x584028);const _0x439f8d=_0x119d0b[_0x5dd5fa(0x1f2)]['id'],_0x10d445=await customer['findById'](_0x439f8d);if(_0x584028[0x0]['language']=='English\x20(US)'){var _0x5180de=users['English'];console[_0x5dd5fa(0x18e)](_0x5180de);}else{if(_0x584028[0x0][_0x5dd5fa(0x1b3)]=='Hindi')var _0x5180de=users[_0x5dd5fa(0x1b8)];else{if(_0x584028[0x0][_0x5dd5fa(0x1b3)]=='German')var _0x5180de=users[_0x5dd5fa(0x19b)];else{if(_0x584028[0x0][_0x5dd5fa(0x1b3)]==_0x5dd5fa(0x18c))var _0x5180de=users['Spanish'];else{if(_0x584028[0x0]['language']==_0x5dd5fa(0x1a6))var _0x5180de=users['French'];else{if(_0x584028[0x0][_0x5dd5fa(0x1b3)]==_0x5dd5fa(0x1d5))var _0x5180de=users['Portuguese'];else{if(_0x584028[0x0][_0x5dd5fa(0x1b3)]==_0x5dd5fa(0x1d1))var _0x5180de=users['Chinese'];else{if(_0x584028[0x0][_0x5dd5fa(0x1b3)]==_0x5dd5fa(0x1dc))var _0x5180de=users[_0x5dd5fa(0x1da)];}}}}}}}_0xab3634['render'](_0x5dd5fa(0x191),{'success':_0x119d0b['flash']('success'),'errors':_0x119d0b['flash'](_0x5dd5fa(0x193)),'role':_0x3b06cf,'profile':_0x4008ee,'user':_0x10d445,'master_shop':_0x584028,'language':_0x5180de});}catch(_0x231ea9){console[_0x5dd5fa(0x18e)](_0x231ea9);}}),router['post']('/view/:id',auth,async(_0x24a548,_0x2535f0)=>{const _0x5e6c99=a0_0x2f18cc;try{const _0x19d1c0=_0x24a548['params']['id'],_0x3fbf4a=await customer[_0x5e6c99(0x1d2)](_0x19d1c0),{name:_0x1ab39c,address:_0x34b2a0,mobile:_0x419889,email:_0x4ec656,receivable:_0x57dfbc,payable:_0x46a295,contactperson:_0x2f029b,landline:_0x2a15f9}=_0x24a548[_0x5e6c99(0x1a9)];_0x3fbf4a['name']=_0x1ab39c,_0x3fbf4a[_0x5e6c99(0x1b1)]=_0x34b2a0,_0x3fbf4a[_0x5e6c99(0x19a)]=_0x419889,_0x3fbf4a['email']=_0x4ec656,_0x3fbf4a[_0x5e6c99(0x1a5)]=_0x57dfbc,_0x3fbf4a['payable']=_0x46a295,_0x3fbf4a[_0x5e6c99(0x1b9)]=_0x2f029b,_0x3fbf4a['landline']=_0x2a15f9;const _0x1b9529=await _0x3fbf4a[_0x5e6c99(0x1bb)]();_0x24a548[_0x5e6c99(0x1ac)]('success',_0x5e6c99(0x18f)),_0x2535f0[_0x5e6c99(0x1bd)](_0x5e6c99(0x1c6));}catch(_0x5f3a7d){console[_0x5e6c99(0x18e)](_0x5f3a7d);}}),router[a0_0x2f18cc(0x19d)](a0_0x2f18cc(0x1c5),auth,async(_0x5235f7,_0x71e3a8)=>{const _0x290457=a0_0x2f18cc;try{const {username:_0x3b39a1,email:_0x33dd26,role:_0x47adeb}=_0x5235f7[_0x290457(0x19c)],_0x2fa5cb=_0x5235f7[_0x290457(0x19c)],_0x1f33ca=await profile[_0x290457(0x1b2)]({'email':_0x2fa5cb[_0x290457(0x194)]}),_0x1c03de=await master_shop[_0x290457(0x1e7)]();console[_0x290457(0x18e)]('master',_0x1c03de),console[_0x290457(0x18e)](_0x5235f7['params']['id']);const _0x2031c3=await customer['findOne']({'_id':_0x5235f7[_0x290457(0x1f2)]['id']});console['log'](_0x290457(0x1c0),_0x2031c3);const _0x1e21f9=await c_payment_data['find']({'customer':_0x2031c3['name']});console[_0x290457(0x18e)](_0x1e21f9);const _0x4a3685=await c_payment_data[_0x290457(0x198)]([{'$match':{'customer':_0x2031c3[_0x290457(0x1e5)]}},{'$match':{'reason':_0x290457(0x192)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console['log']('payable_sum',_0x4a3685);const _0x185d6a=await c_payment_data[_0x290457(0x198)]([{'$match':{'customer':_0x2031c3[_0x290457(0x1e5)]}},{'$match':{'reason':_0x290457(0x1cd)}},{'$group':{'_id':_0x290457(0x1d7),'sum':{'$sum':_0x290457(0x1b5)}}}]);console[_0x290457(0x18e)]('receivable_sum',_0x185d6a);if(_0x1c03de[0x0][_0x290457(0x1b3)]==_0x290457(0x199)){var _0xd8a96=users['English'];console[_0x290457(0x18e)](_0xd8a96);}else{if(_0x1c03de[0x0][_0x290457(0x1b3)]=='Hindi')var _0xd8a96=users[_0x290457(0x1b8)];else{if(_0x1c03de[0x0][_0x290457(0x1b3)]=='German')var _0xd8a96=users[_0x290457(0x19b)];else{if(_0x1c03de[0x0]['language']==_0x290457(0x18c))var _0xd8a96=users[_0x290457(0x18c)];else{if(_0x1c03de[0x0][_0x290457(0x1b3)]==_0x290457(0x1a6))var _0xd8a96=users[_0x290457(0x1a6)];else{if(_0x1c03de[0x0]['language']==_0x290457(0x1d5))var _0xd8a96=users['Portuguese'];else{if(_0x1c03de[0x0][_0x290457(0x1b3)]=='Chinese')var _0xd8a96=users['Chinese'];else{if(_0x1c03de[0x0][_0x290457(0x1b3)]=='Arabic\x20(ae)')var _0xd8a96=users[_0x290457(0x1da)];}}}}}}}_0x71e3a8['render']('customer_payment',{'success':_0x5235f7[_0x290457(0x1ac)](_0x290457(0x1d4)),'errors':_0x5235f7[_0x290457(0x1ac)](_0x290457(0x193)),'role':_0x2fa5cb,'profile':_0x1f33ca,'payment':_0x1e21f9,'payable':_0x4a3685,'receivable':_0x185d6a,'master_shop':_0x1c03de,'language':_0xd8a96});}catch(_0x35f315){console['log'](_0x35f315);}}),router[a0_0x2f18cc(0x19d)](a0_0x2f18cc(0x1ce),auth,async(_0x2f3144,_0x1dc357)=>{const _0x11498=a0_0x2f18cc;try{const _0x380a3a=new excelJS[(_0x11498(0x1ad))](),_0x1fad9d=_0x380a3a['addWorksheet']('Customers');return _0x1fad9d[_0x11498(0x1af)]=[{'header':'ID','key':_0x11498(0x1f0),'width':0xa},{'header':_0x11498(0x1d3),'key':'PBrands','width':0xa},{'header':_0x11498(0x19f),'key':'PUnits','width':0xa},{'header':_0x11498(0x1cc),'key':'SalesmanName','width':0xa},{'header':_0x11498(0x1b1),'key':_0x11498(0x1b1),'width':0xa},{'header':_0x11498(0x19a),'key':_0x11498(0x19a),'width':0xa},{'header':_0x11498(0x194),'key':_0x11498(0x194),'width':0xa}],_0x1dc357[_0x11498(0x1a3)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x1dc357[_0x11498(0x1a3)](_0x11498(0x1e6),_0x11498(0x1a7)),_0x380a3a[_0x11498(0x1d9)][_0x11498(0x1b0)](_0x1dc357)[_0x11498(0x1eb)](()=>{const _0x3e1342=_0x11498;_0x1dc357[_0x3e1342(0x1b7)](0xc8);});}catch(_0x3ee43a){_0x1dc357[_0x11498(0x1b7)](0x190)['send']({'errors':_0x3ee43a[_0x11498(0x1ee)]});}});const storage1=multer[a0_0x2f18cc(0x1ef)]({'destination':(_0x3ce748,_0x47a199,_0x5acbdb)=>{const _0x599a1a=a0_0x2f18cc;_0x5acbdb(null,_0x599a1a(0x197));},'filename':(_0x110856,_0x1fae70,_0x17069c)=>{const _0x15d29d=a0_0x2f18cc;_0x17069c(null,Date[_0x15d29d(0x1c1)]()+_0x1fae70['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x2f18cc(0x1dd)](a0_0x2f18cc(0x1f1),auth,uploadMigrate[a0_0x2f18cc(0x195)](a0_0x2f18cc(0x1df)),async(_0x25e2f1,_0x1ecc51)=>{const _0x5275ec=a0_0x2f18cc,_0x42e7b1=_0x25e2f1[_0x5275ec(0x1d0)][_0x5275ec(0x1c4)],_0x4bb6ae=await xlsx[_0x5275ec(0x18d)](_0x5275ec(0x1c9)+_0x42e7b1);let _0x47f2b4=_0x4bb6ae[_0x5275ec(0x1e2)],_0x150dfc=xlsx[_0x5275ec(0x1ea)][_0x5275ec(0x1a8)](_0x4bb6ae['Sheets'][_0x47f2b4[0x0]]);for(const _0x2b02d6 of _0x150dfc){const _0x437a7e=_0x2b02d6['ID'],_0x5d6550=_0x2b02d6[_0x5275ec(0x1d3)],_0x1546ec=_0x2b02d6['SalesmanCode'],_0x164d7d=_0x2b02d6['SalesmanName'],_0x49512b=_0x2b02d6[_0x5275ec(0x1b1)],_0x48e55b=_0x2b02d6[_0x5275ec(0x19a)],_0x14b0e5=_0x2b02d6[_0x5275ec(0x194)];try{let _0x145dc8=await customer[_0x5275ec(0x1b2)]({'name':_0x5d6550});if(!_0x145dc8){const _0x387db0=new customer({'name':_0x5d6550,'ID':_0x437a7e,'SalesmanCode':_0x1546ec,'SalesmanName':_0x164d7d,'address':_0x49512b,'mobile':_0x48e55b,'email':_0x14b0e5});_0x145dc8=await _0x387db0[_0x5275ec(0x1bb)](),_0x25e2f1[_0x5275ec(0x1ac)](_0x5275ec(0x1d4),_0x5d6550+_0x5275ec(0x1e4));}else _0x25e2f1[_0x5275ec(0x1ac)](_0x5275ec(0x1de),_0x5d6550+_0x5275ec(0x1d8));}catch(_0x4627bc){_0x1ecc51[_0x5275ec(0x1b7)](0x1f4)[_0x5275ec(0x1a1)]({'proderror':_0x4627bc[_0x5275ec(0x1ee)],'aproduct':ProductName});}}_0x1ecc51[_0x5275ec(0x1bd)](_0x5275ec(0x1c6));}),module[a0_0x2f18cc(0x1ae)]=router;