function a0_0x9b4d(_0x37797c,_0x4b4565){const _0x398fc3=a0_0x398f();return a0_0x9b4d=function(_0x9b4d6e,_0x3ae0a3){_0x9b4d6e=_0x9b4d6e-0xcd;let _0x407e58=_0x398fc3[_0x9b4d6e];return _0x407e58;},a0_0x9b4d(_0x37797c,_0x4b4565);}const a0_0x1f6dfc=a0_0x9b4d;(function(_0x514ab6,_0x12843e){const _0x40673d=a0_0x9b4d,_0x134307=_0x514ab6();while(!![]){try{const _0x1377c7=-parseInt(_0x40673d(0xde))/0x1+parseInt(_0x40673d(0x102))/0x2*(-parseInt(_0x40673d(0x11c))/0x3)+-parseInt(_0x40673d(0x124))/0x4*(parseInt(_0x40673d(0x109))/0x5)+-parseInt(_0x40673d(0x10c))/0x6*(parseInt(_0x40673d(0xfb))/0x7)+-parseInt(_0x40673d(0x11f))/0x8+-parseInt(_0x40673d(0x10a))/0x9+-parseInt(_0x40673d(0x104))/0xa*(-parseInt(_0x40673d(0x123))/0xb);if(_0x1377c7===_0x12843e)break;else _0x134307['push'](_0x134307['shift']());}catch(_0x133210){_0x134307['push'](_0x134307['shift']());}}}(a0_0x398f,0x19295));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x1f6dfc(0x126)),auth=require('../middleware/auth'),users=require(a0_0x1f6dfc(0xe3)),excelJS=require(a0_0x1f6dfc(0xdb)),xlsx=require(a0_0x1f6dfc(0xf8)),multer=require(a0_0x1f6dfc(0xe4));router[a0_0x1f6dfc(0x133)]('/view',auth,async(_0x3f23c1,_0x4aa44d)=>{const _0x2abc86=a0_0x1f6dfc;try{const {username:_0x114e97,email:_0x11224,role:_0x9b5fc7}=_0x3f23c1[_0x2abc86(0xce)],_0xf2238a=_0x3f23c1['user'],_0x2defcf=await profile[_0x2abc86(0x10d)]({'email':_0xf2238a['email']}),_0x5d376d=await master_shop['find']();console['log'](_0x2abc86(0x129),_0x5d376d);const _0x23441d=await customer[_0x2abc86(0xdc)](),_0x529be3=await customer[_0x2abc86(0xd0)]([{'$lookup':{'from':_0x2abc86(0xda),'localField':_0x2abc86(0xeb),'foreignField':_0x2abc86(0x12c),'as':'customer_docs'}}]);console[_0x2abc86(0xf7)](_0x529be3);const _0x2ba768=_0x529be3['map'](_0x3cc92a=>{const _0x4423f7=_0x2abc86;console[_0x4423f7(0xf7)]('data',_0x3cc92a);var _0x27faa2=0x0,_0x359845=0x0;return _0x3cc92a[_0x4423f7(0x125)][_0x4423f7(0xe7)](_0x34ea20=>{const _0x199b80=_0x4423f7;console[_0x199b80(0xf7)](_0x199b80(0xcf),_0x34ea20),_0x34ea20[_0x199b80(0x131)]==_0x199b80(0xe6)?_0x27faa2+=_0x34ea20[_0x199b80(0x107)]:_0x359845+=_0x34ea20[_0x199b80(0x107)];}),_0x3cc92a[_0x4423f7(0xec)]=parseFloat(_0x27faa2)+0x0,_0x3cc92a[_0x4423f7(0x12f)]=parseFloat(_0x359845)+0x0,_0x3cc92a;});console['log'](_0x2abc86(0xfe),_0x2ba768);if(_0x5d376d[0x0][_0x2abc86(0x127)]==_0x2abc86(0xd3)){var _0x49a836=users['English'];console[_0x2abc86(0xf7)](_0x49a836);}else{if(_0x5d376d[0x0][_0x2abc86(0x127)]==_0x2abc86(0x118))var _0x49a836=users[_0x2abc86(0x118)];else{if(_0x5d376d[0x0][_0x2abc86(0x127)]==_0x2abc86(0x110))var _0x49a836=users[_0x2abc86(0x110)];else{if(_0x5d376d[0x0]['language']==_0x2abc86(0x10e))var _0x49a836=users[_0x2abc86(0x10e)];else{if(_0x5d376d[0x0][_0x2abc86(0x127)]=='French')var _0x49a836=users[_0x2abc86(0x132)];else{if(_0x5d376d[0x0][_0x2abc86(0x127)]==_0x2abc86(0x11e))var _0x49a836=users[_0x2abc86(0xf6)];else{if(_0x5d376d[0x0]['language']==_0x2abc86(0xf3))var _0x49a836=users[_0x2abc86(0xf3)];else{if(_0x5d376d[0x0][_0x2abc86(0x127)]=='Arabic\x20(ae)')var _0x49a836=users[_0x2abc86(0xff)];}}}}}}}_0x4aa44d['render'](_0x2abc86(0x12c),{'success':_0x3f23c1[_0x2abc86(0xd2)](_0x2abc86(0xfd)),'errors':_0x3f23c1[_0x2abc86(0xd2)]('errors'),'user':_0x23441d,'role':_0xf2238a,'profile':_0x2defcf,'payment':_0x2ba768,'master_shop':_0x5d376d,'language':_0x49a836});}catch(_0x262781){console['log'](_0x262781);}}),router[a0_0x1f6dfc(0xd1)]('/view',auth,async(_0x37194c,_0x5b7ede)=>{const _0x3b47ee=a0_0x1f6dfc;try{const {name:_0x1ff948,address:_0x35b59e,mobile:_0x55a1ad,email:_0x57319b,receivable:_0x219002,payable:_0x26c89d,contactperson:_0x4f594b,landline:_0x2646a9}=_0x37194c[_0x3b47ee(0xd6)],_0x558916=new customer({'name':_0x1ff948,'address':_0x35b59e,'mobile':_0x55a1ad,'email':_0x57319b,'receivable':_0x219002,'payable':_0x26c89d,'contactperson':_0x4f594b,'landline':_0x2646a9}),_0x39fe75=await _0x558916[_0x3b47ee(0xe8)]();_0x37194c[_0x3b47ee(0xd2)](_0x3b47ee(0xfd),'customer\x20add\x20successfully'),_0x5b7ede[_0x3b47ee(0x101)](_0x3b47ee(0xe0));}catch(_0x49af54){console['log'](_0x49af54);}}),router[a0_0x1f6dfc(0x133)](a0_0x1f6dfc(0xe9),auth,async(_0x389b3c,_0x5bd5cc)=>{const _0x479d11=a0_0x1f6dfc;try{const {username:_0x3df1ad,email:_0x43c079,role:_0xfa76b5}=_0x389b3c[_0x479d11(0xce)],_0x38f343=_0x389b3c[_0x479d11(0xce)],_0xd8add8=await profile[_0x479d11(0x10d)]({'email':_0x38f343[_0x479d11(0x10b)]}),_0x563767=await master_shop['find']();console[_0x479d11(0xf7)](_0x479d11(0x129),_0x563767);const _0x1c2b86=_0x389b3c[_0x479d11(0xcd)]['id'],_0x1ff742=await customer[_0x479d11(0xf1)](_0x1c2b86);if(_0x563767[0x0][_0x479d11(0x127)]==_0x479d11(0xd3)){var _0x2beaf7=users[_0x479d11(0x114)];console[_0x479d11(0xf7)](_0x2beaf7);}else{if(_0x563767[0x0]['language']==_0x479d11(0x118))var _0x2beaf7=users[_0x479d11(0x118)];else{if(_0x563767[0x0][_0x479d11(0x127)]==_0x479d11(0x110))var _0x2beaf7=users[_0x479d11(0x110)];else{if(_0x563767[0x0][_0x479d11(0x127)]==_0x479d11(0x10e))var _0x2beaf7=users[_0x479d11(0x10e)];else{if(_0x563767[0x0][_0x479d11(0x127)]==_0x479d11(0x132))var _0x2beaf7=users[_0x479d11(0x132)];else{if(_0x563767[0x0]['language']=='Portuguese\x20(BR)')var _0x2beaf7=users[_0x479d11(0xf6)];else{if(_0x563767[0x0][_0x479d11(0x127)]=='Chinese')var _0x2beaf7=users[_0x479d11(0xf3)];else{if(_0x563767[0x0][_0x479d11(0x127)]==_0x479d11(0x128))var _0x2beaf7=users[_0x479d11(0xff)];}}}}}}}_0x5bd5cc[_0x479d11(0x135)](_0x479d11(0x12c),{'success':_0x389b3c[_0x479d11(0xd2)](_0x479d11(0xfd)),'errors':_0x389b3c[_0x479d11(0xd2)](_0x479d11(0x12a)),'role':_0x38f343,'profile':_0xd8add8,'user':_0x1ff742,'master_shop':_0x563767,'language':_0x2beaf7});}catch(_0x338ff6){console[_0x479d11(0xf7)](_0x338ff6);}}),router[a0_0x1f6dfc(0xd1)]('/view/:id',auth,async(_0x2541e9,_0x489ecb)=>{const _0x8ec552=a0_0x1f6dfc;try{const _0x70a497=_0x2541e9['params']['id'],_0x5395e2=await customer[_0x8ec552(0xf1)](_0x70a497),{name:_0x3a35fb,address:_0xcbf45c,mobile:_0xd888d3,email:_0x5750f9,receivable:_0x5d23cd,payable:_0x3bb6b2,contactperson:_0x159716,landline:_0x52276d}=_0x2541e9[_0x8ec552(0xd6)];_0x5395e2[_0x8ec552(0xeb)]=_0x3a35fb,_0x5395e2['address']=_0xcbf45c,_0x5395e2[_0x8ec552(0x11a)]=_0xd888d3,_0x5395e2[_0x8ec552(0x10b)]=_0x5750f9,_0x5395e2['receivable']=_0x5d23cd,_0x5395e2[_0x8ec552(0x115)]=_0x3bb6b2,_0x5395e2['contactperson']=_0x159716,_0x5395e2[_0x8ec552(0xd4)]=_0x52276d;const _0x305086=await _0x5395e2[_0x8ec552(0xe8)]();_0x2541e9[_0x8ec552(0xd2)](_0x8ec552(0xfd),_0x8ec552(0xdf)),_0x489ecb[_0x8ec552(0x101)]('/customer/view');}catch(_0x1a58a2){console[_0x8ec552(0xf7)](_0x1a58a2);}}),router['get'](a0_0x1f6dfc(0x12d),auth,async(_0xd1a42e,_0xa63231)=>{const _0x586bb5=a0_0x1f6dfc;try{const {username:_0x127148,email:_0x4b8f97,role:_0x161cbe}=_0xd1a42e['user'],_0x34d719=_0xd1a42e['user'],_0x4b114a=await profile[_0x586bb5(0x10d)]({'email':_0x34d719[_0x586bb5(0x10b)]}),_0x37a46b=await master_shop[_0x586bb5(0xdc)]();console[_0x586bb5(0xf7)](_0x586bb5(0x129),_0x37a46b),console[_0x586bb5(0xf7)](_0xd1a42e[_0x586bb5(0xcd)]['id']);const _0x483aff=await customer[_0x586bb5(0x10d)]({'_id':_0xd1a42e[_0x586bb5(0xcd)]['id']});console[_0x586bb5(0xf7)](_0x586bb5(0x111),_0x483aff);const _0x2ec587=await c_payment_data['find']({'customer':_0x483aff[_0x586bb5(0xeb)]});console[_0x586bb5(0xf7)](_0x2ec587);const _0x3406b7=await c_payment_data[_0x586bb5(0xd0)]([{'$match':{'customer':_0x483aff['name']}},{'$match':{'reason':_0x586bb5(0xe6)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x586bb5(0xf7)]('payable_sum',_0x3406b7);const _0x4c5db0=await c_payment_data[_0x586bb5(0xd0)]([{'$match':{'customer':_0x483aff['name']}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x586bb5(0x103),'sum':{'$sum':_0x586bb5(0xd9)}}}]);console[_0x586bb5(0xf7)]('receivable_sum',_0x4c5db0);if(_0x37a46b[0x0][_0x586bb5(0x127)]=='English\x20(US)'){var _0x2707f3=users[_0x586bb5(0x114)];console[_0x586bb5(0xf7)](_0x2707f3);}else{if(_0x37a46b[0x0][_0x586bb5(0x127)]==_0x586bb5(0x118))var _0x2707f3=users[_0x586bb5(0x118)];else{if(_0x37a46b[0x0][_0x586bb5(0x127)]==_0x586bb5(0x110))var _0x2707f3=users[_0x586bb5(0x110)];else{if(_0x37a46b[0x0][_0x586bb5(0x127)]=='Spanish')var _0x2707f3=users[_0x586bb5(0x10e)];else{if(_0x37a46b[0x0][_0x586bb5(0x127)]==_0x586bb5(0x132))var _0x2707f3=users[_0x586bb5(0x132)];else{if(_0x37a46b[0x0]['language']=='Portuguese\x20(BR)')var _0x2707f3=users[_0x586bb5(0xf6)];else{if(_0x37a46b[0x0][_0x586bb5(0x127)]==_0x586bb5(0xf3))var _0x2707f3=users[_0x586bb5(0xf3)];else{if(_0x37a46b[0x0][_0x586bb5(0x127)]==_0x586bb5(0x128))var _0x2707f3=users[_0x586bb5(0xff)];}}}}}}}_0xa63231[_0x586bb5(0x135)]('customer_payment',{'success':_0xd1a42e[_0x586bb5(0xd2)](_0x586bb5(0xfd)),'errors':_0xd1a42e[_0x586bb5(0xd2)](_0x586bb5(0x12a)),'role':_0x34d719,'profile':_0x4b114a,'payment':_0x2ec587,'payable':_0x3406b7,'receivable':_0x4c5db0,'master_shop':_0x37a46b,'language':_0x2707f3});}catch(_0x54b9c4){console[_0x586bb5(0xf7)](_0x54b9c4);}}),router[a0_0x1f6dfc(0x133)](a0_0x1f6dfc(0x113),auth,async(_0x53ee98,_0xa24d64)=>{const _0x254d4f=a0_0x1f6dfc;try{const _0x1aab5f=new excelJS[(_0x254d4f(0x120))](),_0x1ffa60=_0x1aab5f[_0x254d4f(0xe5)](_0x254d4f(0x130));return _0x1ffa60[_0x254d4f(0xd5)]=[{'header':'ID','key':_0x254d4f(0xfa),'width':0xa},{'header':_0x254d4f(0x100),'key':_0x254d4f(0xe2),'width':0xa},{'header':_0x254d4f(0x105),'key':'PUnits','width':0xa},{'header':_0x254d4f(0x12e),'key':_0x254d4f(0x12e),'width':0xa},{'header':_0x254d4f(0xe1),'key':_0x254d4f(0xe1),'width':0xa},{'header':_0x254d4f(0x11a),'key':_0x254d4f(0x11a),'width':0xa},{'header':_0x254d4f(0x10b),'key':'email','width':0xa}],_0xa24d64[_0x254d4f(0xd8)](_0x254d4f(0x121),_0x254d4f(0x12b)),_0xa24d64[_0x254d4f(0xd8)](_0x254d4f(0x122),_0x254d4f(0x119)),_0x1aab5f[_0x254d4f(0xf8)][_0x254d4f(0x134)](_0xa24d64)[_0x254d4f(0xf2)](()=>{const _0x5a1214=_0x254d4f;_0xa24d64[_0x5a1214(0xf5)](0xc8);});}catch(_0x40d2cf){_0xa24d64[_0x254d4f(0xf5)](0x190)[_0x254d4f(0xea)]({'errors':_0x40d2cf[_0x254d4f(0xf0)]});}});const storage1=multer['diskStorage']({'destination':(_0x2599b8,_0x31c856,_0x17b7a4)=>{const _0x11dba7=a0_0x1f6dfc;_0x17b7a4(null,_0x11dba7(0xfc));},'filename':(_0x5235f0,_0x47adaa,_0x53ec1f)=>{const _0x3eefc5=a0_0x1f6dfc;_0x53ec1f(null,Date[_0x3eefc5(0x112)]()+_0x47adaa[_0x3eefc5(0x11b)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x1f6dfc(0xd1)](a0_0x1f6dfc(0x106),auth,uploadMigrate['single'](a0_0x1f6dfc(0xdd)),async(_0x4becde,_0x4dcfad)=>{const _0x5cdb6d=a0_0x1f6dfc,_0x534a88=_0x4becde[_0x5cdb6d(0xee)][_0x5cdb6d(0x117)],_0x306f35=await xlsx[_0x5cdb6d(0xef)]('public/Migration/'+_0x534a88);let _0x3be7dd=_0x306f35[_0x5cdb6d(0xd7)],_0x8e1453=xlsx['utils'][_0x5cdb6d(0xf4)](_0x306f35[_0x5cdb6d(0xed)][_0x3be7dd[0x0]]);for(const _0x548979 of _0x8e1453){const _0x32f749=_0x548979['ID'],_0x35e6f6=_0x548979[_0x5cdb6d(0x100)],_0x1847e2=_0x548979['SalesmanCode'],_0x2512e9=_0x548979[_0x5cdb6d(0x12e)],_0x395cd2=_0x548979['address'],_0x558ab1=_0x548979[_0x5cdb6d(0x11a)],_0x247358=_0x548979[_0x5cdb6d(0x10b)];try{let _0x257c49=await customer[_0x5cdb6d(0x10d)]({'name':_0x35e6f6});if(!_0x257c49){const _0x4c31f5=new customer({'name':_0x35e6f6,'ID':_0x32f749,'SalesmanCode':_0x1847e2,'SalesmanName':_0x2512e9,'address':_0x395cd2,'mobile':_0x558ab1,'email':_0x247358});_0x257c49=await _0x4c31f5['save'](),_0x4becde[_0x5cdb6d(0xd2)]('success',_0x35e6f6+_0x5cdb6d(0x11d));}else _0x4becde[_0x5cdb6d(0xd2)](_0x5cdb6d(0x108),_0x35e6f6+_0x5cdb6d(0x10f));}catch(_0x792301){_0x4dcfad[_0x5cdb6d(0xf5)](0x1f4)[_0x5cdb6d(0x116)]({'proderror':_0x792301[_0x5cdb6d(0xf0)],'aproduct':ProductName});}}_0x4dcfad['redirect'](_0x5cdb6d(0xe0));}),module[a0_0x1f6dfc(0xf9)]=router;function a0_0x398f(){const _0x1cd2ee=['7OFFhJZ','public/Migration','success','payment_data','Arabic','Name','redirect','5024CIZugu','$reason','15530WARwzF','SalesmanCode','/customer_import_migrate_file','amount','error','4175FSleeb','1837260NUuTDi','email','584862EgzVOf','findOne','Spanish','\x20Failed','German','customer_data','now','/products_export_migrate_file','English','payable','json','filename','Hindi','attachment;\x20filename=customer_Migration_File.xlsx','mobile','originalname','174gHiKOb','\x20added\x20successfully','Portuguese\x20(BR)','881080qWByYx','Workbook','Content-Type','Content-Disposition','5335pdCtNX','76VBnaWc','customer_docs','../models/all_models','language','Arabic\x20(ae)','master','errors','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','customer','/view/payment/:id','SalesmanName','sale_return','Customers','reason','French','get','write','render','params','user','element','aggregate','post','flash','English\x20(US)','landline','columns','body','SheetNames','setHeader','$amount','c_payments','exceljs','find','customer_product_fule','76831QKZJVc','customer\x20update\x20successfully','/customer/view','address','PBrands','../public/language/languages.json','multer','addWorksheet','Sale','forEach','save','/view/:id','send','name','sale','Sheets','file','readFile','message','findById','then','Chinese','sheet_to_json','status','Portuguese','log','xlsx','exports','PName'];a0_0x398f=function(){return _0x1cd2ee;};return a0_0x398f();}