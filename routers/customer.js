function a0_0x52f4(){const _0x1c063c=['3072532vyGxfK','SheetNames','columns','express','c_payments','Hindi','customer_docs','Arabic\x20(ae)','single','public/Migration/','filename','attachment;\x20filename=customer_Migration_File.xlsx','$reason','language','status','Chinese','post','xlsx','1644678JZILzx','redirect','public/Migration','success','/products_export_migrate_file','706896JrbRqF','name','549500eDJADW','data','find','utils','48NpWSWp','file','setHeader','/view/:id','customer','render','readFile','Content-Type','../public/language/languages.json','Name','/customer_import_migrate_file','Portuguese\x20(BR)','write','Sheets','English\x20(US)','PUnits','1298IXbBMT','SalesmanCode','SalesmanName','Portuguese','5fqLrpe','customer_product_fule','customer\x20add\x20successfully','88850iWaIxT','receivable','/view/payment/:id','map','amount','/view','aggregate','save','contactperson','/customer/view','2307582eaaSbJ','master','1806eEKyKl','French','address','forEach','flash','../models/all_models','addWorksheet','mobile','element','Content-Disposition','PBrands','params','exceljs','findOne','reason','English','log','Sale\x20Return','message','Router','sale','user','receivable_sum','\x20added\x20successfully','German','Customers','findById','payment_data','errors','Spanish','payable_sum','get','multer','originalname','Arabic','email','Workbook','customer\x20update\x20successfully','17486GtJCMu','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','send'];a0_0x52f4=function(){return _0x1c063c;};return a0_0x52f4();}const a0_0xcf5c57=a0_0x3ebc;(function(_0x3ee4,_0x4ad966){const _0x98ce9=a0_0x3ebc,_0x588646=_0x3ee4();while(!![]){try{const _0x39e985=-parseInt(_0x98ce9(0x15e))/0x1+parseInt(_0x98ce9(0x157))/0x2+parseInt(_0x98ce9(0x183))/0x3+-parseInt(_0x98ce9(0x145))/0x4*(parseInt(_0x98ce9(0x176))/0x5)+-parseInt(_0x98ce9(0x185))/0x6*(-parseInt(_0x98ce9(0x142))/0x7)+-parseInt(_0x98ce9(0x162))/0x8*(-parseInt(_0x98ce9(0x15c))/0x9)+-parseInt(_0x98ce9(0x179))/0xa*(parseInt(_0x98ce9(0x172))/0xb);if(_0x39e985===_0x4ad966)break;else _0x588646['push'](_0x588646['shift']());}catch(_0x285b40){_0x588646['push'](_0x588646['shift']());}}}(a0_0x52f4,0x6d878));const express=require(a0_0xcf5c57(0x148)),app=express(),router=express[a0_0xcf5c57(0x198)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0xcf5c57(0x18a)),auth=require('../middleware/auth'),users=require(a0_0xcf5c57(0x16a)),excelJS=require(a0_0xcf5c57(0x191)),xlsx=require(a0_0xcf5c57(0x156)),multer=require(a0_0xcf5c57(0x13c));router['get'](a0_0xcf5c57(0x17e),auth,async(_0x29bb36,_0x50e92b)=>{const _0x3033c5=a0_0xcf5c57;try{const {username:_0x4cbb9b,email:_0x29e16c,role:_0x3562ec}=_0x29bb36['user'],_0x4868ee=_0x29bb36[_0x3033c5(0x19a)],_0x1d0fa7=await profile[_0x3033c5(0x192)]({'email':_0x4868ee[_0x3033c5(0x13f)]}),_0xa2b82e=await master_shop[_0x3033c5(0x160)]();console[_0x3033c5(0x195)](_0x3033c5(0x184),_0xa2b82e);const _0x40eb30=await customer[_0x3033c5(0x160)](),_0x1aa10e=await customer[_0x3033c5(0x17f)]([{'$lookup':{'from':_0x3033c5(0x149),'localField':_0x3033c5(0x15d),'foreignField':_0x3033c5(0x166),'as':_0x3033c5(0x14b)}}]);console['log'](_0x1aa10e);const _0x5372aa=_0x1aa10e[_0x3033c5(0x17c)](_0x21c3ee=>{const _0x6ba357=_0x3033c5;console[_0x6ba357(0x195)](_0x6ba357(0x15f),_0x21c3ee);var _0x13d7d8=0x0,_0x27ccce=0x0;return _0x21c3ee[_0x6ba357(0x14b)][_0x6ba357(0x188)](_0x3fcfb8=>{const _0x10ce8c=_0x6ba357;console[_0x10ce8c(0x195)](_0x10ce8c(0x18d),_0x3fcfb8),_0x3fcfb8[_0x10ce8c(0x193)]=='Sale'?_0x13d7d8+=_0x3fcfb8['amount']:_0x27ccce+=_0x3fcfb8[_0x10ce8c(0x17d)];}),_0x21c3ee[_0x6ba357(0x199)]=parseFloat(_0x13d7d8)+0x0,_0x21c3ee['sale_return']=parseFloat(_0x27ccce)+0x0,_0x21c3ee;});console[_0x3033c5(0x195)](_0x3033c5(0x1a0),_0x5372aa);if(_0xa2b82e[0x0][_0x3033c5(0x152)]==_0x3033c5(0x170)){var _0x226886=users[_0x3033c5(0x194)];console[_0x3033c5(0x195)](_0x226886);}else{if(_0xa2b82e[0x0]['language']==_0x3033c5(0x14a))var _0x226886=users[_0x3033c5(0x14a)];else{if(_0xa2b82e[0x0][_0x3033c5(0x152)]==_0x3033c5(0x19d))var _0x226886=users[_0x3033c5(0x19d)];else{if(_0xa2b82e[0x0]['language']=='Spanish')var _0x226886=users[_0x3033c5(0x139)];else{if(_0xa2b82e[0x0]['language']==_0x3033c5(0x186))var _0x226886=users[_0x3033c5(0x186)];else{if(_0xa2b82e[0x0][_0x3033c5(0x152)]=='Portuguese\x20(BR)')var _0x226886=users[_0x3033c5(0x175)];else{if(_0xa2b82e[0x0]['language']==_0x3033c5(0x154))var _0x226886=users[_0x3033c5(0x154)];else{if(_0xa2b82e[0x0]['language']==_0x3033c5(0x14c))var _0x226886=users[_0x3033c5(0x13e)];}}}}}}}_0x50e92b[_0x3033c5(0x167)](_0x3033c5(0x166),{'success':_0x29bb36['flash']('success'),'errors':_0x29bb36[_0x3033c5(0x189)](_0x3033c5(0x1a1)),'user':_0x40eb30,'role':_0x4868ee,'profile':_0x1d0fa7,'payment':_0x5372aa,'master_shop':_0xa2b82e,'language':_0x226886});}catch(_0x3f98ba){console[_0x3033c5(0x195)](_0x3f98ba);}}),router[a0_0xcf5c57(0x155)](a0_0xcf5c57(0x17e),auth,async(_0x1137f6,_0x5c5db1)=>{const _0x79ab8d=a0_0xcf5c57;try{const {name:_0x385653,address:_0x14848a,mobile:_0x534283,email:_0x13840a,receivable:_0xe0e942,payable:_0x169cd6,contactperson:_0x40d10d,landline:_0x2b20e6}=_0x1137f6['body'],_0x47e6e1=new customer({'name':_0x385653,'address':_0x14848a,'mobile':_0x534283,'email':_0x13840a,'receivable':_0xe0e942,'payable':_0x169cd6,'contactperson':_0x40d10d,'landline':_0x2b20e6}),_0x16afc5=await _0x47e6e1[_0x79ab8d(0x180)]();_0x1137f6[_0x79ab8d(0x189)](_0x79ab8d(0x15a),_0x79ab8d(0x178)),_0x5c5db1[_0x79ab8d(0x158)](_0x79ab8d(0x182));}catch(_0x1f7a78){console[_0x79ab8d(0x195)](_0x1f7a78);}}),router[a0_0xcf5c57(0x13b)](a0_0xcf5c57(0x165),auth,async(_0x42ca92,_0x5c4f7b)=>{const _0x488b7a=a0_0xcf5c57;try{const {username:_0x1c9640,email:_0x37a696,role:_0x5e7815}=_0x42ca92['user'],_0x4ea091=_0x42ca92[_0x488b7a(0x19a)],_0x457140=await profile[_0x488b7a(0x192)]({'email':_0x4ea091[_0x488b7a(0x13f)]}),_0x58d35d=await master_shop[_0x488b7a(0x160)]();console[_0x488b7a(0x195)]('master',_0x58d35d);const _0x30fe69=_0x42ca92[_0x488b7a(0x190)]['id'],_0x2cfe12=await customer[_0x488b7a(0x19f)](_0x30fe69);if(_0x58d35d[0x0][_0x488b7a(0x152)]==_0x488b7a(0x170)){var _0xfddfc7=users[_0x488b7a(0x194)];console[_0x488b7a(0x195)](_0xfddfc7);}else{if(_0x58d35d[0x0][_0x488b7a(0x152)]==_0x488b7a(0x14a))var _0xfddfc7=users[_0x488b7a(0x14a)];else{if(_0x58d35d[0x0]['language']=='German')var _0xfddfc7=users['German'];else{if(_0x58d35d[0x0][_0x488b7a(0x152)]=='Spanish')var _0xfddfc7=users[_0x488b7a(0x139)];else{if(_0x58d35d[0x0]['language']==_0x488b7a(0x186))var _0xfddfc7=users[_0x488b7a(0x186)];else{if(_0x58d35d[0x0]['language']==_0x488b7a(0x16d))var _0xfddfc7=users[_0x488b7a(0x175)];else{if(_0x58d35d[0x0][_0x488b7a(0x152)]==_0x488b7a(0x154))var _0xfddfc7=users['Chinese'];else{if(_0x58d35d[0x0]['language']=='Arabic\x20(ae)')var _0xfddfc7=users[_0x488b7a(0x13e)];}}}}}}}_0x5c4f7b[_0x488b7a(0x167)](_0x488b7a(0x166),{'success':_0x42ca92['flash']('success'),'errors':_0x42ca92[_0x488b7a(0x189)](_0x488b7a(0x1a1)),'role':_0x4ea091,'profile':_0x457140,'user':_0x2cfe12,'master_shop':_0x58d35d,'language':_0xfddfc7});}catch(_0x1a1e3d){console['log'](_0x1a1e3d);}}),router['post'](a0_0xcf5c57(0x165),auth,async(_0x3a605f,_0x51863a)=>{const _0x3d83fd=a0_0xcf5c57;try{const _0x19d9ad=_0x3a605f['params']['id'],_0x28bcbf=await customer['findById'](_0x19d9ad),{name:_0x3d2393,address:_0x51e9f5,mobile:_0x533676,email:_0x24d450,receivable:_0xfb6b09,payable:_0x290e12,contactperson:_0x498011,landline:_0x372f66}=_0x3a605f['body'];_0x28bcbf[_0x3d83fd(0x15d)]=_0x3d2393,_0x28bcbf[_0x3d83fd(0x187)]=_0x51e9f5,_0x28bcbf[_0x3d83fd(0x18c)]=_0x533676,_0x28bcbf[_0x3d83fd(0x13f)]=_0x24d450,_0x28bcbf[_0x3d83fd(0x17a)]=_0xfb6b09,_0x28bcbf['payable']=_0x290e12,_0x28bcbf[_0x3d83fd(0x181)]=_0x498011,_0x28bcbf['landline']=_0x372f66;const _0x5d7ced=await _0x28bcbf[_0x3d83fd(0x180)]();_0x3a605f[_0x3d83fd(0x189)](_0x3d83fd(0x15a),_0x3d83fd(0x141)),_0x51863a[_0x3d83fd(0x158)]('/customer/view');}catch(_0x4fe7fa){console[_0x3d83fd(0x195)](_0x4fe7fa);}}),router[a0_0xcf5c57(0x13b)](a0_0xcf5c57(0x17b),auth,async(_0x5d9563,_0x12afa1)=>{const _0x3ac289=a0_0xcf5c57;try{const {username:_0x228536,email:_0x20ff77,role:_0x500418}=_0x5d9563['user'],_0x2b7ccc=_0x5d9563['user'],_0x3e9c28=await profile['findOne']({'email':_0x2b7ccc[_0x3ac289(0x13f)]}),_0x28e2d0=await master_shop['find']();console[_0x3ac289(0x195)](_0x3ac289(0x184),_0x28e2d0),console[_0x3ac289(0x195)](_0x5d9563[_0x3ac289(0x190)]['id']);const _0x18a408=await customer['findOne']({'_id':_0x5d9563[_0x3ac289(0x190)]['id']});console[_0x3ac289(0x195)]('customer_data',_0x18a408);const _0x1ed079=await c_payment_data[_0x3ac289(0x160)]({'customer':_0x18a408[_0x3ac289(0x15d)]});console[_0x3ac289(0x195)](_0x1ed079);const _0xe829f2=await c_payment_data['aggregate']([{'$match':{'customer':_0x18a408[_0x3ac289(0x15d)]}},{'$match':{'reason':'Sale'}},{'$group':{'_id':_0x3ac289(0x151),'sum':{'$sum':'$amount'}}}]);console['log'](_0x3ac289(0x13a),_0xe829f2);const _0x2036ce=await c_payment_data[_0x3ac289(0x17f)]([{'$match':{'customer':_0x18a408[_0x3ac289(0x15d)]}},{'$match':{'reason':_0x3ac289(0x196)}},{'$group':{'_id':_0x3ac289(0x151),'sum':{'$sum':'$amount'}}}]);console[_0x3ac289(0x195)](_0x3ac289(0x19b),_0x2036ce);if(_0x28e2d0[0x0]['language']==_0x3ac289(0x170)){var _0x3a72ff=users[_0x3ac289(0x194)];console[_0x3ac289(0x195)](_0x3a72ff);}else{if(_0x28e2d0[0x0][_0x3ac289(0x152)]==_0x3ac289(0x14a))var _0x3a72ff=users['Hindi'];else{if(_0x28e2d0[0x0][_0x3ac289(0x152)]==_0x3ac289(0x19d))var _0x3a72ff=users[_0x3ac289(0x19d)];else{if(_0x28e2d0[0x0][_0x3ac289(0x152)]==_0x3ac289(0x139))var _0x3a72ff=users[_0x3ac289(0x139)];else{if(_0x28e2d0[0x0][_0x3ac289(0x152)]==_0x3ac289(0x186))var _0x3a72ff=users['French'];else{if(_0x28e2d0[0x0][_0x3ac289(0x152)]==_0x3ac289(0x16d))var _0x3a72ff=users[_0x3ac289(0x175)];else{if(_0x28e2d0[0x0]['language']==_0x3ac289(0x154))var _0x3a72ff=users['Chinese'];else{if(_0x28e2d0[0x0]['language']==_0x3ac289(0x14c))var _0x3a72ff=users['Arabic'];}}}}}}}_0x12afa1[_0x3ac289(0x167)]('customer_payment',{'success':_0x5d9563['flash']('success'),'errors':_0x5d9563[_0x3ac289(0x189)](_0x3ac289(0x1a1)),'role':_0x2b7ccc,'profile':_0x3e9c28,'payment':_0x1ed079,'payable':_0xe829f2,'receivable':_0x2036ce,'master_shop':_0x28e2d0,'language':_0x3a72ff});}catch(_0x3f8474){console[_0x3ac289(0x195)](_0x3f8474);}}),router[a0_0xcf5c57(0x13b)](a0_0xcf5c57(0x15b),auth,async(_0x33ed20,_0x2b38b8)=>{const _0xbcb1ba=a0_0xcf5c57;try{const _0x579cd3=new excelJS[(_0xbcb1ba(0x140))](),_0x3999a9=_0x579cd3[_0xbcb1ba(0x18b)](_0xbcb1ba(0x19e));return _0x3999a9[_0xbcb1ba(0x147)]=[{'header':'ID','key':'PName','width':0xa},{'header':'Name','key':_0xbcb1ba(0x18f),'width':0xa},{'header':'SalesmanCode','key':_0xbcb1ba(0x171),'width':0xa},{'header':'SalesmanName','key':_0xbcb1ba(0x174),'width':0xa},{'header':'address','key':'address','width':0xa},{'header':_0xbcb1ba(0x18c),'key':_0xbcb1ba(0x18c),'width':0xa},{'header':_0xbcb1ba(0x13f),'key':'email','width':0xa}],_0x2b38b8[_0xbcb1ba(0x164)](_0xbcb1ba(0x169),_0xbcb1ba(0x143)),_0x2b38b8[_0xbcb1ba(0x164)](_0xbcb1ba(0x18e),_0xbcb1ba(0x150)),_0x579cd3[_0xbcb1ba(0x156)][_0xbcb1ba(0x16e)](_0x2b38b8)['then'](()=>{_0x2b38b8['status'](0xc8);});}catch(_0x8325d0){_0x2b38b8['status'](0x190)[_0xbcb1ba(0x144)]({'errors':_0x8325d0[_0xbcb1ba(0x197)]});}});function a0_0x3ebc(_0x14fddf,_0x495e90){const _0x52f499=a0_0x52f4();return a0_0x3ebc=function(_0x3ebcdb,_0x26d620){_0x3ebcdb=_0x3ebcdb-0x139;let _0x50b6d8=_0x52f499[_0x3ebcdb];return _0x50b6d8;},a0_0x3ebc(_0x14fddf,_0x495e90);}const storage1=multer['diskStorage']({'destination':(_0x44e7f9,_0x376c18,_0x5cf43b)=>{const _0x24d35c=a0_0xcf5c57;_0x5cf43b(null,_0x24d35c(0x159));},'filename':(_0x468b25,_0x2823de,_0x4c47ec)=>{const _0x580709=a0_0xcf5c57;_0x4c47ec(null,Date['now']()+_0x2823de[_0x580709(0x13d)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0xcf5c57(0x155)](a0_0xcf5c57(0x16c),auth,uploadMigrate[a0_0xcf5c57(0x14d)](a0_0xcf5c57(0x177)),async(_0x26107c,_0x21d556)=>{const _0x588340=a0_0xcf5c57,_0x44d944=_0x26107c[_0x588340(0x163)][_0x588340(0x14f)],_0x502212=await xlsx[_0x588340(0x168)](_0x588340(0x14e)+_0x44d944);let _0x14c0b0=_0x502212[_0x588340(0x146)],_0x387ee5=xlsx[_0x588340(0x161)]['sheet_to_json'](_0x502212[_0x588340(0x16f)][_0x14c0b0[0x0]]);for(const _0x1eee45 of _0x387ee5){const _0x1ced20=_0x1eee45['ID'],_0x3d66a9=_0x1eee45[_0x588340(0x16b)],_0x58038d=_0x1eee45[_0x588340(0x173)],_0x508818=_0x1eee45[_0x588340(0x174)],_0x335d31=_0x1eee45[_0x588340(0x187)],_0x4c80b6=_0x1eee45[_0x588340(0x18c)],_0x5ac6a4=_0x1eee45['email'];try{let _0x10d757=await customer['findOne']({'name':_0x3d66a9});if(!_0x10d757){const _0x43b204=new customer({'name':_0x3d66a9,'ID':_0x1ced20,'SalesmanCode':_0x58038d,'SalesmanName':_0x508818,'address':_0x335d31,'mobile':_0x4c80b6,'email':_0x5ac6a4});_0x10d757=await _0x43b204['save'](),_0x26107c['flash'](_0x588340(0x15a),_0x3d66a9+_0x588340(0x19c));}else _0x26107c[_0x588340(0x189)]('error',_0x3d66a9+'\x20Failed');}catch(_0x539b7d){_0x21d556[_0x588340(0x153)](0x1f4)['json']({'proderror':_0x539b7d[_0x588340(0x197)],'aproduct':ProductName});}}_0x21d556['redirect'](_0x588340(0x182));}),module['exports']=router;