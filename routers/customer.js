function a0_0x3f78(_0x3502bb,_0x3f5138){const _0x4705da=a0_0x4705();return a0_0x3f78=function(_0x3f7811,_0x559ba9){_0x3f7811=_0x3f7811-0x6d;let _0x555aa8=_0x4705da[_0x3f7811];return _0x555aa8;},a0_0x3f78(_0x3502bb,_0x3f5138);}const a0_0x542862=a0_0x3f78;(function(_0x423083,_0xdb33b7){const _0x286167=a0_0x3f78,_0x522013=_0x423083();while(!![]){try{const _0x5bf56b=-parseInt(_0x286167(0xa1))/0x1*(-parseInt(_0x286167(0x83))/0x2)+-parseInt(_0x286167(0xd3))/0x3+parseInt(_0x286167(0xb2))/0x4*(-parseInt(_0x286167(0xc8))/0x5)+parseInt(_0x286167(0xc5))/0x6*(parseInt(_0x286167(0x94))/0x7)+-parseInt(_0x286167(0x98))/0x8*(parseInt(_0x286167(0xbe))/0x9)+-parseInt(_0x286167(0x90))/0xa+parseInt(_0x286167(0xd7))/0xb;if(_0x5bf56b===_0xdb33b7)break;else _0x522013['push'](_0x522013['shift']());}catch(_0x40ea04){_0x522013['push'](_0x522013['shift']());}}}(a0_0x4705,0x2a8e2));const express=require(a0_0x542862(0xa4)),app=express(),router=express[a0_0x542862(0xa9)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x542862(0xbb)),auth=require(a0_0x542862(0xa7)),users=require(a0_0x542862(0x87)),excelJS=require(a0_0x542862(0xd4)),xlsx=require(a0_0x542862(0x9e)),multer=require(a0_0x542862(0x7f));function a0_0x4705(){const _0x110c95=['errors','addWorksheet','user','21642GTPock','exceljs','name','get','863214CyqZGz','/customer_import_migrate_file','message','setHeader','/view/:id','log','now','PName','Arabic','English','SalesmanCode','master','customer','c_payments','reason','findOne','mobile','aggregate','PBrands','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','flash','Name','multer','then','receivable_sum','attachment;\x20filename=customer_Migration_File.xlsx','2gOmMpa','Sale\x20Return','SalesmanName','forEach','../public/language/languages.json','redirect','PUnits','customer_data','/customer/view','error','body','success','write','631690YyjrBv','/view','German','Chinese','1143100AjMMAl','email','Hindi','render','4024aFqdUW','language','Customers','readFile','contactperson','/view/payment/:id','xlsx','/products_export_migrate_file','Workbook','250027fAStJY','amount','element','express','exports','English\x20(US)','../middleware/auth','Sale','Router','public/Migration/','\x20Failed','findById','sale','customer\x20add\x20successfully','Sheets','address','params','1233212qMJCCO','status','French','Arabic\x20(ae)','customer_product_fule','customer\x20update\x20successfully','utils','columns','Spanish','../models/all_models','json','public/Migration','1827KBUXvi','find','data','$reason','map','sale_return','originalname','12qoBnnW','payable_sum','single','5AaXlDd','Portuguese\x20(BR)','customer_docs','Content-Type','post','filename','Portuguese','diskStorage'];a0_0x4705=function(){return _0x110c95;};return a0_0x4705();}router['get'](a0_0x542862(0x91),auth,async(_0x1e0ddc,_0x5e911b)=>{const _0x38388b=a0_0x542862;try{const {username:_0x2bf1ce,email:_0x2112e8,role:_0x183b7e}=_0x1e0ddc[_0x38388b(0xd2)],_0x2eff69=_0x1e0ddc[_0x38388b(0xd2)],_0x12fe8c=await profile['findOne']({'email':_0x2eff69[_0x38388b(0x95)]}),_0x5e8038=await master_shop['find']();console['log']('master',_0x5e8038);const _0x25ba83=await customer[_0x38388b(0xbf)](),_0x2183af=await customer[_0x38388b(0x7a)]([{'$lookup':{'from':_0x38388b(0x76),'localField':'name','foreignField':'customer','as':'customer_docs'}}]);console['log'](_0x2183af);const _0x55f450=_0x2183af[_0x38388b(0xc2)](_0x1fbbd0=>{const _0x64247d=_0x38388b;console[_0x64247d(0x6e)](_0x64247d(0xc0),_0x1fbbd0);var _0x5dd9cb=0x0,_0x3bc2be=0x0;return _0x1fbbd0[_0x64247d(0xca)][_0x64247d(0x86)](_0x2cb2d8=>{const _0x342628=_0x64247d;console[_0x342628(0x6e)](_0x342628(0xa3),_0x2cb2d8),_0x2cb2d8[_0x342628(0x77)]==_0x342628(0xa8)?_0x5dd9cb+=_0x2cb2d8[_0x342628(0xa2)]:_0x3bc2be+=_0x2cb2d8[_0x342628(0xa2)];}),_0x1fbbd0[_0x64247d(0xad)]=parseFloat(_0x5dd9cb)+0x0,_0x1fbbd0[_0x64247d(0xc3)]=parseFloat(_0x3bc2be)+0x0,_0x1fbbd0;});console['log']('payment_data',_0x55f450);if(_0x5e8038[0x0][_0x38388b(0x99)]==_0x38388b(0xa6)){var _0x278647=users[_0x38388b(0x72)];console[_0x38388b(0x6e)](_0x278647);}else{if(_0x5e8038[0x0]['language']==_0x38388b(0x96))var _0x278647=users[_0x38388b(0x96)];else{if(_0x5e8038[0x0][_0x38388b(0x99)]==_0x38388b(0x92))var _0x278647=users[_0x38388b(0x92)];else{if(_0x5e8038[0x0][_0x38388b(0x99)]=='Spanish')var _0x278647=users[_0x38388b(0xba)];else{if(_0x5e8038[0x0][_0x38388b(0x99)]==_0x38388b(0xb4))var _0x278647=users['French'];else{if(_0x5e8038[0x0][_0x38388b(0x99)]=='Portuguese\x20(BR)')var _0x278647=users[_0x38388b(0xce)];else{if(_0x5e8038[0x0]['language']==_0x38388b(0x93))var _0x278647=users[_0x38388b(0x93)];else{if(_0x5e8038[0x0][_0x38388b(0x99)]==_0x38388b(0xb5))var _0x278647=users[_0x38388b(0x71)];}}}}}}}_0x5e911b[_0x38388b(0x97)](_0x38388b(0x75),{'success':_0x1e0ddc[_0x38388b(0x7d)](_0x38388b(0x8e)),'errors':_0x1e0ddc[_0x38388b(0x7d)]('errors'),'user':_0x25ba83,'role':_0x2eff69,'profile':_0x12fe8c,'payment':_0x55f450,'master_shop':_0x5e8038,'language':_0x278647});}catch(_0x3f7e80){console[_0x38388b(0x6e)](_0x3f7e80);}}),router[a0_0x542862(0xcc)](a0_0x542862(0x91),auth,async(_0xaf135b,_0x391a9c)=>{const _0x573801=a0_0x542862;try{const {name:_0x1b07bd,address:_0x1491dc,mobile:_0x220c82,email:_0x370a4f,receivable:_0x158ca0,payable:_0x4bf633,contactperson:_0xe86977,landline:_0x3b5cc5}=_0xaf135b[_0x573801(0x8d)],_0x498c23=new customer({'name':_0x1b07bd,'address':_0x1491dc,'mobile':_0x220c82,'email':_0x370a4f,'receivable':_0x158ca0,'payable':_0x4bf633,'contactperson':_0xe86977,'landline':_0x3b5cc5}),_0x3607f3=await _0x498c23['save']();_0xaf135b['flash'](_0x573801(0x8e),_0x573801(0xae)),_0x391a9c[_0x573801(0x88)](_0x573801(0x8b));}catch(_0x4e4619){console[_0x573801(0x6e)](_0x4e4619);}}),router[a0_0x542862(0xd6)]('/view/:id',auth,async(_0x40356a,_0x4a2588)=>{const _0x3aab00=a0_0x542862;try{const {username:_0x5c441b,email:_0xd1e2d7,role:_0x3906ec}=_0x40356a[_0x3aab00(0xd2)],_0x5e0729=_0x40356a[_0x3aab00(0xd2)],_0x5dd868=await profile[_0x3aab00(0x78)]({'email':_0x5e0729[_0x3aab00(0x95)]}),_0x32f130=await master_shop[_0x3aab00(0xbf)]();console[_0x3aab00(0x6e)](_0x3aab00(0x74),_0x32f130);const _0x47b70f=_0x40356a[_0x3aab00(0xb1)]['id'],_0x3329c8=await customer[_0x3aab00(0xac)](_0x47b70f);if(_0x32f130[0x0][_0x3aab00(0x99)]=='English\x20(US)'){var _0x4cb05c=users[_0x3aab00(0x72)];console[_0x3aab00(0x6e)](_0x4cb05c);}else{if(_0x32f130[0x0][_0x3aab00(0x99)]==_0x3aab00(0x96))var _0x4cb05c=users[_0x3aab00(0x96)];else{if(_0x32f130[0x0][_0x3aab00(0x99)]==_0x3aab00(0x92))var _0x4cb05c=users[_0x3aab00(0x92)];else{if(_0x32f130[0x0][_0x3aab00(0x99)]==_0x3aab00(0xba))var _0x4cb05c=users['Spanish'];else{if(_0x32f130[0x0][_0x3aab00(0x99)]==_0x3aab00(0xb4))var _0x4cb05c=users[_0x3aab00(0xb4)];else{if(_0x32f130[0x0][_0x3aab00(0x99)]=='Portuguese\x20(BR)')var _0x4cb05c=users[_0x3aab00(0xce)];else{if(_0x32f130[0x0][_0x3aab00(0x99)]=='Chinese')var _0x4cb05c=users[_0x3aab00(0x93)];else{if(_0x32f130[0x0][_0x3aab00(0x99)]==_0x3aab00(0xb5))var _0x4cb05c=users[_0x3aab00(0x71)];}}}}}}}_0x4a2588[_0x3aab00(0x97)]('customer',{'success':_0x40356a[_0x3aab00(0x7d)](_0x3aab00(0x8e)),'errors':_0x40356a[_0x3aab00(0x7d)](_0x3aab00(0xd0)),'role':_0x5e0729,'profile':_0x5dd868,'user':_0x3329c8,'master_shop':_0x32f130,'language':_0x4cb05c});}catch(_0x3c5b25){console[_0x3aab00(0x6e)](_0x3c5b25);}}),router[a0_0x542862(0xcc)](a0_0x542862(0x6d),auth,async(_0x3125ed,_0xfb9ea3)=>{const _0x13f946=a0_0x542862;try{const _0x28001b=_0x3125ed['params']['id'],_0x1a7b0e=await customer[_0x13f946(0xac)](_0x28001b),{name:_0x4f80da,address:_0x54d9d9,mobile:_0x58945b,email:_0x114efa,receivable:_0x3d37e4,payable:_0x1d2d60,contactperson:_0x3091b4,landline:_0x461619}=_0x3125ed[_0x13f946(0x8d)];_0x1a7b0e['name']=_0x4f80da,_0x1a7b0e[_0x13f946(0xb0)]=_0x54d9d9,_0x1a7b0e[_0x13f946(0x79)]=_0x58945b,_0x1a7b0e[_0x13f946(0x95)]=_0x114efa,_0x1a7b0e['receivable']=_0x3d37e4,_0x1a7b0e['payable']=_0x1d2d60,_0x1a7b0e[_0x13f946(0x9c)]=_0x3091b4,_0x1a7b0e['landline']=_0x461619;const _0x2a02e6=await _0x1a7b0e['save']();_0x3125ed[_0x13f946(0x7d)](_0x13f946(0x8e),_0x13f946(0xb7)),_0xfb9ea3['redirect'](_0x13f946(0x8b));}catch(_0x14b921){console[_0x13f946(0x6e)](_0x14b921);}}),router['get'](a0_0x542862(0x9d),auth,async(_0x3e01c9,_0x4fbb36)=>{const _0x323c13=a0_0x542862;try{const {username:_0x333179,email:_0xfab189,role:_0x4f5a3d}=_0x3e01c9[_0x323c13(0xd2)],_0x351a17=_0x3e01c9[_0x323c13(0xd2)],_0x3b5af9=await profile[_0x323c13(0x78)]({'email':_0x351a17[_0x323c13(0x95)]}),_0x4bc444=await master_shop[_0x323c13(0xbf)]();console[_0x323c13(0x6e)]('master',_0x4bc444),console[_0x323c13(0x6e)](_0x3e01c9[_0x323c13(0xb1)]['id']);const _0xd74f7c=await customer[_0x323c13(0x78)]({'_id':_0x3e01c9['params']['id']});console[_0x323c13(0x6e)](_0x323c13(0x8a),_0xd74f7c);const _0x32e244=await c_payment_data[_0x323c13(0xbf)]({'customer':_0xd74f7c[_0x323c13(0xd5)]});console[_0x323c13(0x6e)](_0x32e244);const _0x26d33d=await c_payment_data[_0x323c13(0x7a)]([{'$match':{'customer':_0xd74f7c[_0x323c13(0xd5)]}},{'$match':{'reason':_0x323c13(0xa8)}},{'$group':{'_id':_0x323c13(0xc1),'sum':{'$sum':'$amount'}}}]);console[_0x323c13(0x6e)](_0x323c13(0xc6),_0x26d33d);const _0xdafb6c=await c_payment_data['aggregate']([{'$match':{'customer':_0xd74f7c[_0x323c13(0xd5)]}},{'$match':{'reason':_0x323c13(0x84)}},{'$group':{'_id':_0x323c13(0xc1),'sum':{'$sum':'$amount'}}}]);console[_0x323c13(0x6e)](_0x323c13(0x81),_0xdafb6c);if(_0x4bc444[0x0][_0x323c13(0x99)]==_0x323c13(0xa6)){var _0x3b57a6=users['English'];console[_0x323c13(0x6e)](_0x3b57a6);}else{if(_0x4bc444[0x0]['language']==_0x323c13(0x96))var _0x3b57a6=users['Hindi'];else{if(_0x4bc444[0x0]['language']==_0x323c13(0x92))var _0x3b57a6=users[_0x323c13(0x92)];else{if(_0x4bc444[0x0]['language']==_0x323c13(0xba))var _0x3b57a6=users[_0x323c13(0xba)];else{if(_0x4bc444[0x0][_0x323c13(0x99)]==_0x323c13(0xb4))var _0x3b57a6=users[_0x323c13(0xb4)];else{if(_0x4bc444[0x0]['language']==_0x323c13(0xc9))var _0x3b57a6=users['Portuguese'];else{if(_0x4bc444[0x0][_0x323c13(0x99)]==_0x323c13(0x93))var _0x3b57a6=users[_0x323c13(0x93)];else{if(_0x4bc444[0x0][_0x323c13(0x99)]==_0x323c13(0xb5))var _0x3b57a6=users[_0x323c13(0x71)];}}}}}}}_0x4fbb36[_0x323c13(0x97)]('customer_payment',{'success':_0x3e01c9['flash'](_0x323c13(0x8e)),'errors':_0x3e01c9[_0x323c13(0x7d)](_0x323c13(0xd0)),'role':_0x351a17,'profile':_0x3b5af9,'payment':_0x32e244,'payable':_0x26d33d,'receivable':_0xdafb6c,'master_shop':_0x4bc444,'language':_0x3b57a6});}catch(_0x1e76cd){console[_0x323c13(0x6e)](_0x1e76cd);}}),router[a0_0x542862(0xd6)](a0_0x542862(0x9f),auth,async(_0x4c0cd3,_0x4d7c1b)=>{const _0x27dcdf=a0_0x542862;try{const _0x171cdc=new excelJS[(_0x27dcdf(0xa0))](),_0x16c66d=_0x171cdc[_0x27dcdf(0xd1)](_0x27dcdf(0x9a));return _0x16c66d[_0x27dcdf(0xb9)]=[{'header':'ID','key':_0x27dcdf(0x70),'width':0xa},{'header':_0x27dcdf(0x7e),'key':_0x27dcdf(0x7b),'width':0xa},{'header':_0x27dcdf(0x73),'key':_0x27dcdf(0x89),'width':0xa},{'header':_0x27dcdf(0x85),'key':_0x27dcdf(0x85),'width':0xa},{'header':'address','key':_0x27dcdf(0xb0),'width':0xa},{'header':_0x27dcdf(0x79),'key':_0x27dcdf(0x79),'width':0xa},{'header':'email','key':_0x27dcdf(0x95),'width':0xa}],_0x4d7c1b[_0x27dcdf(0xda)](_0x27dcdf(0xcb),_0x27dcdf(0x7c)),_0x4d7c1b['setHeader']('Content-Disposition',_0x27dcdf(0x82)),_0x171cdc[_0x27dcdf(0x9e)][_0x27dcdf(0x8f)](_0x4d7c1b)[_0x27dcdf(0x80)](()=>{const _0x1c50c4=_0x27dcdf;_0x4d7c1b[_0x1c50c4(0xb3)](0xc8);});}catch(_0xd3884){_0x4d7c1b['status'](0x190)['send']({'errors':_0xd3884[_0x27dcdf(0xd9)]});}});const storage1=multer[a0_0x542862(0xcf)]({'destination':(_0xf2bef3,_0x508de9,_0x3067a2)=>{const _0x570e06=a0_0x542862;_0x3067a2(null,_0x570e06(0xbd));},'filename':(_0x4e0895,_0x2898ac,_0x392d2a)=>{const _0xcf0747=a0_0x542862;_0x392d2a(null,Date[_0xcf0747(0x6f)]()+_0x2898ac[_0xcf0747(0xc4)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x542862(0xcc)](a0_0x542862(0xd8),auth,uploadMigrate[a0_0x542862(0xc7)](a0_0x542862(0xb6)),async(_0x4a7b13,_0x25ee89)=>{const _0x3835be=a0_0x542862,_0x54c439=_0x4a7b13['file'][_0x3835be(0xcd)],_0x56c2c6=await xlsx[_0x3835be(0x9b)](_0x3835be(0xaa)+_0x54c439);let _0x75c8d0=_0x56c2c6['SheetNames'],_0x1a3637=xlsx[_0x3835be(0xb8)]['sheet_to_json'](_0x56c2c6[_0x3835be(0xaf)][_0x75c8d0[0x0]]);for(const _0x2abd67 of _0x1a3637){const _0x4712d9=_0x2abd67['ID'],_0x566faf=_0x2abd67[_0x3835be(0x7e)],_0x369a46=_0x2abd67[_0x3835be(0x73)],_0x11215e=_0x2abd67['SalesmanName'],_0xa858ba=_0x2abd67[_0x3835be(0xb0)],_0x948cc8=_0x2abd67[_0x3835be(0x79)],_0x35f990=_0x2abd67[_0x3835be(0x95)];try{let _0x22042b=await customer['findOne']({'name':_0x566faf});if(!_0x22042b){const _0xa5ed7a=new customer({'name':_0x566faf,'ID':_0x4712d9,'SalesmanCode':_0x369a46,'SalesmanName':_0x11215e,'address':_0xa858ba,'mobile':_0x948cc8,'email':_0x35f990});_0x22042b=await _0xa5ed7a['save'](),_0x4a7b13[_0x3835be(0x7d)](_0x3835be(0x8e),_0x566faf+'\x20added\x20successfully');}else _0x4a7b13[_0x3835be(0x7d)](_0x3835be(0x8c),_0x566faf+_0x3835be(0xab));}catch(_0x3314c4){_0x25ee89[_0x3835be(0xb3)](0x1f4)[_0x3835be(0xbc)]({'proderror':_0x3314c4[_0x3835be(0xd9)],'aproduct':ProductName});}}_0x25ee89[_0x3835be(0x88)](_0x3835be(0x8b));}),module[a0_0x542862(0xa5)]=router;