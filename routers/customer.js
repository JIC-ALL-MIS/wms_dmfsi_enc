function a0_0x5b3d(){const _0x33e569=['customer_data','84vxBXsE','get','master','save','write','Portuguese\x20(BR)','Name','receivable_sum','PName','errors','3400000yJEIyh','/view','Customers','payable_sum','xlsx','Sale','json','diskStorage','English\x20(US)','mobile','addWorksheet','Content-Disposition','customer_payment','status','data','sheet_to_json','columns','forEach','customer\x20add\x20successfully','log','898296tdRyca','findById','readFile','setHeader','customer','findOne','send','6477360fYJAZE','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','2jzNrBe','public/Migration/','Sheets','SalesmanCode','aggregate','$amount','payable','params','Spanish','Portuguese','attachment;\x20filename=customer_Migration_File.xlsx','/view/payment/:id','reason','\x20Failed','landline','element','$reason','success','SalesmanName','payment_data','amount','name','message','738494NgVPkH','../public/language/languages.json','/products_export_migrate_file','body','Router','Chinese','address','360585aBUgVi','Arabic\x20(ae)','email','render','c_payments','exports','multer','user','sale_return','/customer/view','flash','customer_product_fule','../models/all_models','\x20added\x20successfully','redirect','customer\x20update\x20successfully','express','receivable','German','Arabic','post','6595617pRTfyl','map','find','now','../middleware/auth','language','exceljs','Hindi','/view/:id','single','French','25047405SgObZS','customer_docs'];a0_0x5b3d=function(){return _0x33e569;};return a0_0x5b3d();}const a0_0x108981=a0_0x3825;(function(_0x849ebd,_0x1301dc){const _0xe51bb8=a0_0x3825,_0x30ddd6=_0x849ebd();while(!![]){try{const _0x2d3a99=parseInt(_0xe51bb8(0x174))/0x1*(parseInt(_0xe51bb8(0x15d))/0x2)+-parseInt(_0xe51bb8(0x154))/0x3+-parseInt(_0xe51bb8(0x136))/0x4*(-parseInt(_0xe51bb8(0x17b))/0x5)+parseInt(_0xe51bb8(0x15b))/0x6+parseInt(_0xe51bb8(0x128))/0x7+-parseInt(_0xe51bb8(0x140))/0x8+-parseInt(_0xe51bb8(0x133))/0x9;if(_0x2d3a99===_0x1301dc)break;else _0x30ddd6['push'](_0x30ddd6['shift']());}catch(_0x324523){_0x30ddd6['push'](_0x30ddd6['shift']());}}}(a0_0x5b3d,0xbb521));const express=require(a0_0x108981(0x123)),app=express(),router=express[a0_0x108981(0x178)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x108981(0x11f)),auth=require(a0_0x108981(0x12c)),users=require(a0_0x108981(0x175)),excelJS=require(a0_0x108981(0x12e)),xlsx=require(a0_0x108981(0x144)),multer=require(a0_0x108981(0x181));router[a0_0x108981(0x137)](a0_0x108981(0x141),auth,async(_0x4edd18,_0x5b603c)=>{const _0x4b44e7=a0_0x108981;try{const {username:_0x534cf5,email:_0x30dd6f,role:_0x40767b}=_0x4edd18[_0x4b44e7(0x182)],_0x32db9b=_0x4edd18[_0x4b44e7(0x182)],_0x3e9454=await profile[_0x4b44e7(0x159)]({'email':_0x32db9b['email']}),_0x1d994d=await master_shop[_0x4b44e7(0x12a)]();console[_0x4b44e7(0x153)]('master',_0x1d994d);const _0x216486=await customer[_0x4b44e7(0x12a)](),_0x294fc2=await customer[_0x4b44e7(0x161)]([{'$lookup':{'from':_0x4b44e7(0x17f),'localField':_0x4b44e7(0x172),'foreignField':'customer','as':'customer_docs'}}]);console[_0x4b44e7(0x153)](_0x294fc2);const _0x1e5996=_0x294fc2[_0x4b44e7(0x129)](_0x2b038b=>{const _0x22ed00=_0x4b44e7;console[_0x22ed00(0x153)](_0x22ed00(0x14e),_0x2b038b);var _0x47ff53=0x0,_0x142930=0x0;return _0x2b038b[_0x22ed00(0x134)][_0x22ed00(0x151)](_0x31076f=>{const _0x35ae24=_0x22ed00;console[_0x35ae24(0x153)](_0x35ae24(0x16c),_0x31076f),_0x31076f[_0x35ae24(0x169)]==_0x35ae24(0x145)?_0x47ff53+=_0x31076f[_0x35ae24(0x171)]:_0x142930+=_0x31076f['amount'];}),_0x2b038b['sale']=parseFloat(_0x47ff53)+0x0,_0x2b038b[_0x22ed00(0x183)]=parseFloat(_0x142930)+0x0,_0x2b038b;});console[_0x4b44e7(0x153)](_0x4b44e7(0x170),_0x1e5996);if(_0x1d994d[0x0][_0x4b44e7(0x12d)]==_0x4b44e7(0x148)){var _0x13be12=users['English'];console[_0x4b44e7(0x153)](_0x13be12);}else{if(_0x1d994d[0x0]['language']=='Hindi')var _0x13be12=users[_0x4b44e7(0x12f)];else{if(_0x1d994d[0x0][_0x4b44e7(0x12d)]=='German')var _0x13be12=users[_0x4b44e7(0x125)];else{if(_0x1d994d[0x0][_0x4b44e7(0x12d)]==_0x4b44e7(0x165))var _0x13be12=users[_0x4b44e7(0x165)];else{if(_0x1d994d[0x0][_0x4b44e7(0x12d)]=='French')var _0x13be12=users['French'];else{if(_0x1d994d[0x0][_0x4b44e7(0x12d)]==_0x4b44e7(0x13b))var _0x13be12=users['Portuguese'];else{if(_0x1d994d[0x0][_0x4b44e7(0x12d)]=='Chinese')var _0x13be12=users[_0x4b44e7(0x179)];else{if(_0x1d994d[0x0][_0x4b44e7(0x12d)]==_0x4b44e7(0x17c))var _0x13be12=users[_0x4b44e7(0x126)];}}}}}}}_0x5b603c['render'](_0x4b44e7(0x158),{'success':_0x4edd18[_0x4b44e7(0x185)](_0x4b44e7(0x16e)),'errors':_0x4edd18['flash'](_0x4b44e7(0x13f)),'user':_0x216486,'role':_0x32db9b,'profile':_0x3e9454,'payment':_0x1e5996,'master_shop':_0x1d994d,'language':_0x13be12});}catch(_0x35174a){console[_0x4b44e7(0x153)](_0x35174a);}}),router[a0_0x108981(0x127)](a0_0x108981(0x141),auth,async(_0x5c0cd2,_0x5ab3c7)=>{const _0x1b3d2e=a0_0x108981;try{const {name:_0x54d85c,address:_0x209fad,mobile:_0x108750,email:_0x218f46,receivable:_0x2969ed,payable:_0x45206b,contactperson:_0x51e724,landline:_0x131147}=_0x5c0cd2[_0x1b3d2e(0x177)],_0x3cfd3c=new customer({'name':_0x54d85c,'address':_0x209fad,'mobile':_0x108750,'email':_0x218f46,'receivable':_0x2969ed,'payable':_0x45206b,'contactperson':_0x51e724,'landline':_0x131147}),_0x2a92da=await _0x3cfd3c[_0x1b3d2e(0x139)]();_0x5c0cd2[_0x1b3d2e(0x185)](_0x1b3d2e(0x16e),_0x1b3d2e(0x152)),_0x5ab3c7['redirect'](_0x1b3d2e(0x184));}catch(_0x48b027){console[_0x1b3d2e(0x153)](_0x48b027);}}),router[a0_0x108981(0x137)](a0_0x108981(0x130),auth,async(_0x1d9a0b,_0x33d2b0)=>{const _0x225334=a0_0x108981;try{const {username:_0x2bcd5b,email:_0x4d8548,role:_0x2488ae}=_0x1d9a0b[_0x225334(0x182)],_0x265ca8=_0x1d9a0b[_0x225334(0x182)],_0x4e4f71=await profile[_0x225334(0x159)]({'email':_0x265ca8[_0x225334(0x17d)]}),_0x3ff271=await master_shop[_0x225334(0x12a)]();console[_0x225334(0x153)](_0x225334(0x138),_0x3ff271);const _0x25b22c=_0x1d9a0b[_0x225334(0x164)]['id'],_0x209d25=await customer[_0x225334(0x155)](_0x25b22c);if(_0x3ff271[0x0][_0x225334(0x12d)]=='English\x20(US)'){var _0x44ba09=users['English'];console['log'](_0x44ba09);}else{if(_0x3ff271[0x0][_0x225334(0x12d)]==_0x225334(0x12f))var _0x44ba09=users[_0x225334(0x12f)];else{if(_0x3ff271[0x0][_0x225334(0x12d)]=='German')var _0x44ba09=users['German'];else{if(_0x3ff271[0x0][_0x225334(0x12d)]==_0x225334(0x165))var _0x44ba09=users[_0x225334(0x165)];else{if(_0x3ff271[0x0]['language']==_0x225334(0x132))var _0x44ba09=users[_0x225334(0x132)];else{if(_0x3ff271[0x0][_0x225334(0x12d)]==_0x225334(0x13b))var _0x44ba09=users[_0x225334(0x166)];else{if(_0x3ff271[0x0][_0x225334(0x12d)]==_0x225334(0x179))var _0x44ba09=users['Chinese'];else{if(_0x3ff271[0x0][_0x225334(0x12d)]==_0x225334(0x17c))var _0x44ba09=users['Arabic'];}}}}}}}_0x33d2b0[_0x225334(0x17e)](_0x225334(0x158),{'success':_0x1d9a0b['flash'](_0x225334(0x16e)),'errors':_0x1d9a0b[_0x225334(0x185)](_0x225334(0x13f)),'role':_0x265ca8,'profile':_0x4e4f71,'user':_0x209d25,'master_shop':_0x3ff271,'language':_0x44ba09});}catch(_0x56cc38){console[_0x225334(0x153)](_0x56cc38);}}),router[a0_0x108981(0x127)]('/view/:id',auth,async(_0x463e40,_0x3aeb56)=>{const _0x147214=a0_0x108981;try{const _0x23d5e0=_0x463e40[_0x147214(0x164)]['id'],_0x3845da=await customer['findById'](_0x23d5e0),{name:_0x8f4647,address:_0x10e33f,mobile:_0x1ba5de,email:_0x18e24b,receivable:_0x562075,payable:_0x3414cb,contactperson:_0x1d8ec4,landline:_0xae5c4c}=_0x463e40[_0x147214(0x177)];_0x3845da[_0x147214(0x172)]=_0x8f4647,_0x3845da[_0x147214(0x17a)]=_0x10e33f,_0x3845da['mobile']=_0x1ba5de,_0x3845da[_0x147214(0x17d)]=_0x18e24b,_0x3845da[_0x147214(0x124)]=_0x562075,_0x3845da[_0x147214(0x163)]=_0x3414cb,_0x3845da['contactperson']=_0x1d8ec4,_0x3845da[_0x147214(0x16b)]=_0xae5c4c;const _0x3c732e=await _0x3845da[_0x147214(0x139)]();_0x463e40[_0x147214(0x185)](_0x147214(0x16e),_0x147214(0x122)),_0x3aeb56[_0x147214(0x121)](_0x147214(0x184));}catch(_0x3da548){console[_0x147214(0x153)](_0x3da548);}}),router[a0_0x108981(0x137)](a0_0x108981(0x168),auth,async(_0x2c6218,_0x7fced1)=>{const _0xfbf456=a0_0x108981;try{const {username:_0x26c286,email:_0x427ec2,role:_0x10fd97}=_0x2c6218[_0xfbf456(0x182)],_0x100b0a=_0x2c6218[_0xfbf456(0x182)],_0x595d4d=await profile[_0xfbf456(0x159)]({'email':_0x100b0a['email']}),_0x2cf6a7=await master_shop[_0xfbf456(0x12a)]();console[_0xfbf456(0x153)](_0xfbf456(0x138),_0x2cf6a7),console['log'](_0x2c6218[_0xfbf456(0x164)]['id']);const _0xe4db3d=await customer[_0xfbf456(0x159)]({'_id':_0x2c6218[_0xfbf456(0x164)]['id']});console[_0xfbf456(0x153)](_0xfbf456(0x135),_0xe4db3d);const _0x35aecd=await c_payment_data[_0xfbf456(0x12a)]({'customer':_0xe4db3d[_0xfbf456(0x172)]});console[_0xfbf456(0x153)](_0x35aecd);const _0x5b1ed7=await c_payment_data['aggregate']([{'$match':{'customer':_0xe4db3d[_0xfbf456(0x172)]}},{'$match':{'reason':_0xfbf456(0x145)}},{'$group':{'_id':'$reason','sum':{'$sum':_0xfbf456(0x162)}}}]);console[_0xfbf456(0x153)](_0xfbf456(0x143),_0x5b1ed7);const _0x2d5420=await c_payment_data[_0xfbf456(0x161)]([{'$match':{'customer':_0xe4db3d[_0xfbf456(0x172)]}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0xfbf456(0x16d),'sum':{'$sum':'$amount'}}}]);console[_0xfbf456(0x153)](_0xfbf456(0x13d),_0x2d5420);if(_0x2cf6a7[0x0][_0xfbf456(0x12d)]=='English\x20(US)'){var _0x4c04e0=users['English'];console[_0xfbf456(0x153)](_0x4c04e0);}else{if(_0x2cf6a7[0x0][_0xfbf456(0x12d)]==_0xfbf456(0x12f))var _0x4c04e0=users[_0xfbf456(0x12f)];else{if(_0x2cf6a7[0x0][_0xfbf456(0x12d)]==_0xfbf456(0x125))var _0x4c04e0=users[_0xfbf456(0x125)];else{if(_0x2cf6a7[0x0][_0xfbf456(0x12d)]==_0xfbf456(0x165))var _0x4c04e0=users[_0xfbf456(0x165)];else{if(_0x2cf6a7[0x0]['language']=='French')var _0x4c04e0=users[_0xfbf456(0x132)];else{if(_0x2cf6a7[0x0][_0xfbf456(0x12d)]==_0xfbf456(0x13b))var _0x4c04e0=users[_0xfbf456(0x166)];else{if(_0x2cf6a7[0x0][_0xfbf456(0x12d)]==_0xfbf456(0x179))var _0x4c04e0=users[_0xfbf456(0x179)];else{if(_0x2cf6a7[0x0][_0xfbf456(0x12d)]==_0xfbf456(0x17c))var _0x4c04e0=users['Arabic'];}}}}}}}_0x7fced1[_0xfbf456(0x17e)](_0xfbf456(0x14c),{'success':_0x2c6218['flash'](_0xfbf456(0x16e)),'errors':_0x2c6218[_0xfbf456(0x185)]('errors'),'role':_0x100b0a,'profile':_0x595d4d,'payment':_0x35aecd,'payable':_0x5b1ed7,'receivable':_0x2d5420,'master_shop':_0x2cf6a7,'language':_0x4c04e0});}catch(_0x370383){console['log'](_0x370383);}}),router[a0_0x108981(0x137)](a0_0x108981(0x176),auth,async(_0x3c206f,_0x475505)=>{const _0xca42d1=a0_0x108981;try{const _0x1c8016=new excelJS['Workbook'](),_0x2d31c3=_0x1c8016[_0xca42d1(0x14a)](_0xca42d1(0x142));return _0x2d31c3[_0xca42d1(0x150)]=[{'header':'ID','key':_0xca42d1(0x13e),'width':0xa},{'header':_0xca42d1(0x13c),'key':'PBrands','width':0xa},{'header':_0xca42d1(0x160),'key':'PUnits','width':0xa},{'header':_0xca42d1(0x16f),'key':_0xca42d1(0x16f),'width':0xa},{'header':'address','key':_0xca42d1(0x17a),'width':0xa},{'header':'mobile','key':'mobile','width':0xa},{'header':'email','key':_0xca42d1(0x17d),'width':0xa}],_0x475505[_0xca42d1(0x157)]('Content-Type',_0xca42d1(0x15c)),_0x475505[_0xca42d1(0x157)](_0xca42d1(0x14b),_0xca42d1(0x167)),_0x1c8016[_0xca42d1(0x144)][_0xca42d1(0x13a)](_0x475505)['then'](()=>{const _0x4109fd=_0xca42d1;_0x475505[_0x4109fd(0x14d)](0xc8);});}catch(_0x51b33d){_0x475505['status'](0x190)[_0xca42d1(0x15a)]({'errors':_0x51b33d[_0xca42d1(0x173)]});}});function a0_0x3825(_0x466dc9,_0x218381){const _0x5b3d6b=a0_0x5b3d();return a0_0x3825=function(_0x38254e,_0x5de962){_0x38254e=_0x38254e-0x11e;let _0x167042=_0x5b3d6b[_0x38254e];return _0x167042;},a0_0x3825(_0x466dc9,_0x218381);}const storage1=multer[a0_0x108981(0x147)]({'destination':(_0x152891,_0x17b806,_0x68d8f2)=>{_0x68d8f2(null,'public/Migration');},'filename':(_0x182889,_0x2a584e,_0x305ee3)=>{const _0x40c5ca=a0_0x108981;_0x305ee3(null,Date[_0x40c5ca(0x12b)]()+_0x2a584e['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x108981(0x127)]('/customer_import_migrate_file',auth,uploadMigrate[a0_0x108981(0x131)](a0_0x108981(0x11e)),async(_0x4e5f01,_0x2dd0da)=>{const _0x20ec1e=a0_0x108981,_0x38aa2c=_0x4e5f01['file']['filename'],_0xc1b764=await xlsx[_0x20ec1e(0x156)](_0x20ec1e(0x15e)+_0x38aa2c);let _0x398197=_0xc1b764['SheetNames'],_0x9e9954=xlsx['utils'][_0x20ec1e(0x14f)](_0xc1b764[_0x20ec1e(0x15f)][_0x398197[0x0]]);for(const _0x1662b5 of _0x9e9954){const _0x281256=_0x1662b5['ID'],_0x5a6808=_0x1662b5[_0x20ec1e(0x13c)],_0x5d912d=_0x1662b5[_0x20ec1e(0x160)],_0x2b95c9=_0x1662b5[_0x20ec1e(0x16f)],_0x3d52f1=_0x1662b5[_0x20ec1e(0x17a)],_0x4f98df=_0x1662b5[_0x20ec1e(0x149)],_0x571581=_0x1662b5[_0x20ec1e(0x17d)];try{let _0x233a3=await customer['findOne']({'name':_0x5a6808});if(!_0x233a3){const _0x34c4d4=new customer({'name':_0x5a6808,'ID':_0x281256,'SalesmanCode':_0x5d912d,'SalesmanName':_0x2b95c9,'address':_0x3d52f1,'mobile':_0x4f98df,'email':_0x571581});_0x233a3=await _0x34c4d4[_0x20ec1e(0x139)](),_0x4e5f01[_0x20ec1e(0x185)](_0x20ec1e(0x16e),_0x5a6808+_0x20ec1e(0x120));}else _0x4e5f01[_0x20ec1e(0x185)]('error',_0x5a6808+_0x20ec1e(0x16a));}catch(_0x39d52c){_0x2dd0da[_0x20ec1e(0x14d)](0x1f4)[_0x20ec1e(0x146)]({'proderror':_0x39d52c['message'],'aproduct':ProductName});}}_0x2dd0da[_0x20ec1e(0x121)](_0x20ec1e(0x184));}),module[a0_0x108981(0x180)]=router;