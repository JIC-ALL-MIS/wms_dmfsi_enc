const a0_0x335b5e=a0_0x3d80;(function(_0x59301f,_0x5b40b8){const _0x13ade6=a0_0x3d80,_0x55b81f=_0x59301f();while(!![]){try{const _0x5b87e8=parseInt(_0x13ade6(0x203))/0x1+parseInt(_0x13ade6(0x1df))/0x2*(-parseInt(_0x13ade6(0x1ee))/0x3)+parseInt(_0x13ade6(0x1f6))/0x4*(-parseInt(_0x13ade6(0x1c3))/0x5)+parseInt(_0x13ade6(0x1d3))/0x6*(-parseInt(_0x13ade6(0x1f9))/0x7)+parseInt(_0x13ade6(0x1c8))/0x8*(-parseInt(_0x13ade6(0x1b6))/0x9)+parseInt(_0x13ade6(0x1be))/0xa*(parseInt(_0x13ade6(0x1cd))/0xb)+parseInt(_0x13ade6(0x1f0))/0xc;if(_0x5b87e8===_0x5b40b8)break;else _0x55b81f['push'](_0x55b81f['shift']());}catch(_0x50919e){_0x55b81f['push'](_0x55b81f['shift']());}}}(a0_0x3595,0x6ce1d));const express=require(a0_0x335b5e(0x1c0)),app=express(),router=express[a0_0x335b5e(0x1ef)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x335b5e(0x1b0)),auth=require(a0_0x335b5e(0x1ca)),users=require(a0_0x335b5e(0x204)),excelJS=require('exceljs'),xlsx=require(a0_0x335b5e(0x1dd)),multer=require('multer');router['get'](a0_0x335b5e(0x1ec),auth,async(_0x5980aa,_0x3ddad3)=>{const _0x315624=a0_0x335b5e;try{const {username:_0x2b3f8c,email:_0x3b3582,role:_0x2a24da}=_0x5980aa[_0x315624(0x1c6)],_0xb7254c=_0x5980aa['user'],_0x18e7fb=await profile[_0x315624(0x1ed)]({'email':_0xb7254c[_0x315624(0x1ea)]}),_0x4ddecd=await master_shop[_0x315624(0x1d8)]();console[_0x315624(0x1f3)](_0x315624(0x1e8),_0x4ddecd);const _0x25ab06=await customer[_0x315624(0x1d8)](),_0x56f5e4=await customer['aggregate']([{'$lookup':{'from':_0x315624(0x211),'localField':'name','foreignField':'customer','as':_0x315624(0x213)}}]);console[_0x315624(0x1f3)](_0x56f5e4);const _0x3525d3=_0x56f5e4['map'](_0x4250c0=>{const _0x3c7537=_0x315624;console[_0x3c7537(0x1f3)](_0x3c7537(0x1fb),_0x4250c0);var _0x4c7352=0x0,_0x36c9e1=0x0;return _0x4250c0[_0x3c7537(0x213)]['forEach'](_0x5acff6=>{const _0x36155c=_0x3c7537;console[_0x36155c(0x1f3)]('element',_0x5acff6),_0x5acff6['reason']==_0x36155c(0x1ff)?_0x4c7352+=_0x5acff6['amount']:_0x36c9e1+=_0x5acff6[_0x36155c(0x1fc)];}),_0x4250c0[_0x3c7537(0x1c4)]=parseFloat(_0x4c7352)+0x0,_0x4250c0[_0x3c7537(0x202)]=parseFloat(_0x36c9e1)+0x0,_0x4250c0;});console[_0x315624(0x1f3)]('payment_data',_0x3525d3);if(_0x4ddecd[0x0][_0x315624(0x20b)]==_0x315624(0x200)){var _0x4a0ade=users[_0x315624(0x1dc)];console[_0x315624(0x1f3)](_0x4a0ade);}else{if(_0x4ddecd[0x0][_0x315624(0x20b)]==_0x315624(0x208))var _0x4a0ade=users[_0x315624(0x208)];else{if(_0x4ddecd[0x0]['language']==_0x315624(0x1cc))var _0x4a0ade=users[_0x315624(0x1cc)];else{if(_0x4ddecd[0x0]['language']==_0x315624(0x1bf))var _0x4a0ade=users[_0x315624(0x1bf)];else{if(_0x4ddecd[0x0][_0x315624(0x20b)]==_0x315624(0x1de))var _0x4a0ade=users[_0x315624(0x1de)];else{if(_0x4ddecd[0x0][_0x315624(0x20b)]=='Portuguese\x20(BR)')var _0x4a0ade=users['Portuguese'];else{if(_0x4ddecd[0x0][_0x315624(0x20b)]==_0x315624(0x1d5))var _0x4a0ade=users[_0x315624(0x1d5)];else{if(_0x4ddecd[0x0]['language']==_0x315624(0x1f5))var _0x4a0ade=users[_0x315624(0x1ba)];}}}}}}}_0x3ddad3['render'](_0x315624(0x207),{'success':_0x5980aa[_0x315624(0x1b7)](_0x315624(0x1f1)),'errors':_0x5980aa['flash'](_0x315624(0x1d7)),'user':_0x25ab06,'role':_0xb7254c,'profile':_0x18e7fb,'payment':_0x3525d3,'master_shop':_0x4ddecd,'language':_0x4a0ade});}catch(_0x155d24){console[_0x315624(0x1f3)](_0x155d24);}}),router[a0_0x335b5e(0x1af)]('/view',auth,async(_0x306895,_0xb465ab)=>{const _0x1d579d=a0_0x335b5e;try{const {name:_0x222d79,address:_0x22d607,mobile:_0x4ffa0f,email:_0x3905c9,receivable:_0x3bd97f,payable:_0xff28fe,contactperson:_0x5a9228,landline:_0x1ce6bb}=_0x306895[_0x1d579d(0x1b5)],_0xd4571c=new customer({'name':_0x222d79,'address':_0x22d607,'mobile':_0x4ffa0f,'email':_0x3905c9,'receivable':_0x3bd97f,'payable':_0xff28fe,'contactperson':_0x5a9228,'landline':_0x1ce6bb}),_0x3272aa=await _0xd4571c['save']();_0x306895[_0x1d579d(0x1b7)](_0x1d579d(0x1f1),_0x1d579d(0x201)),_0xb465ab[_0x1d579d(0x205)](_0x1d579d(0x1fa));}catch(_0x50baac){console['log'](_0x50baac);}}),router['get'](a0_0x335b5e(0x1c7),auth,async(_0x106c0f,_0x447a35)=>{const _0x56ad86=a0_0x335b5e;try{const {username:_0xeeed1e,email:_0x3607ac,role:_0x256f79}=_0x106c0f['user'],_0x357ae9=_0x106c0f[_0x56ad86(0x1c6)],_0x294c54=await profile[_0x56ad86(0x1ed)]({'email':_0x357ae9[_0x56ad86(0x1ea)]}),_0x3dd511=await master_shop[_0x56ad86(0x1d8)]();console[_0x56ad86(0x1f3)](_0x56ad86(0x1e8),_0x3dd511);const _0x4f4611=_0x106c0f['params']['id'],_0x32dc58=await customer[_0x56ad86(0x1b2)](_0x4f4611);if(_0x3dd511[0x0][_0x56ad86(0x20b)]==_0x56ad86(0x200)){var _0xba5a12=users[_0x56ad86(0x1dc)];console[_0x56ad86(0x1f3)](_0xba5a12);}else{if(_0x3dd511[0x0][_0x56ad86(0x20b)]==_0x56ad86(0x208))var _0xba5a12=users[_0x56ad86(0x208)];else{if(_0x3dd511[0x0][_0x56ad86(0x20b)]=='German')var _0xba5a12=users[_0x56ad86(0x1cc)];else{if(_0x3dd511[0x0][_0x56ad86(0x20b)]==_0x56ad86(0x1bf))var _0xba5a12=users[_0x56ad86(0x1bf)];else{if(_0x3dd511[0x0][_0x56ad86(0x20b)]==_0x56ad86(0x1de))var _0xba5a12=users[_0x56ad86(0x1de)];else{if(_0x3dd511[0x0][_0x56ad86(0x20b)]==_0x56ad86(0x1cf))var _0xba5a12=users[_0x56ad86(0x1e2)];else{if(_0x3dd511[0x0][_0x56ad86(0x20b)]==_0x56ad86(0x1d5))var _0xba5a12=users[_0x56ad86(0x1d5)];else{if(_0x3dd511[0x0]['language']==_0x56ad86(0x1f5))var _0xba5a12=users[_0x56ad86(0x1ba)];}}}}}}}_0x447a35[_0x56ad86(0x1c9)](_0x56ad86(0x207),{'success':_0x106c0f[_0x56ad86(0x1b7)]('success'),'errors':_0x106c0f[_0x56ad86(0x1b7)](_0x56ad86(0x1d7)),'role':_0x357ae9,'profile':_0x294c54,'user':_0x32dc58,'master_shop':_0x3dd511,'language':_0xba5a12});}catch(_0x1191cb){console[_0x56ad86(0x1f3)](_0x1191cb);}}),router[a0_0x335b5e(0x1af)]('/view/:id',auth,async(_0x144102,_0x52c6ee)=>{const _0x1a5ef7=a0_0x335b5e;try{const _0x15fd8a=_0x144102[_0x1a5ef7(0x20f)]['id'],_0x54e8c0=await customer[_0x1a5ef7(0x1b2)](_0x15fd8a),{name:_0x1b9f41,address:_0x2b553c,mobile:_0x3bbece,email:_0x121d56,receivable:_0xaf5f20,payable:_0x564ed9,contactperson:_0x1a957e,landline:_0x1204ac}=_0x144102[_0x1a5ef7(0x1b5)];_0x54e8c0['name']=_0x1b9f41,_0x54e8c0[_0x1a5ef7(0x1b1)]=_0x2b553c,_0x54e8c0['mobile']=_0x3bbece,_0x54e8c0[_0x1a5ef7(0x1ea)]=_0x121d56,_0x54e8c0[_0x1a5ef7(0x1d6)]=_0xaf5f20,_0x54e8c0['payable']=_0x564ed9,_0x54e8c0['contactperson']=_0x1a957e,_0x54e8c0['landline']=_0x1204ac;const _0x527833=await _0x54e8c0[_0x1a5ef7(0x1c2)]();_0x144102['flash'](_0x1a5ef7(0x1f1),'customer\x20update\x20successfully'),_0x52c6ee[_0x1a5ef7(0x205)](_0x1a5ef7(0x1fa));}catch(_0x4541c6){console[_0x1a5ef7(0x1f3)](_0x4541c6);}}),router[a0_0x335b5e(0x206)]('/view/payment/:id',auth,async(_0x2a5eae,_0x140d49)=>{const _0x14c4f4=a0_0x335b5e;try{const {username:_0x4893ee,email:_0x492422,role:_0xd730a4}=_0x2a5eae['user'],_0x3bff52=_0x2a5eae['user'],_0x4055f9=await profile[_0x14c4f4(0x1ed)]({'email':_0x3bff52[_0x14c4f4(0x1ea)]}),_0x699d1b=await master_shop[_0x14c4f4(0x1d8)]();console['log']('master',_0x699d1b),console[_0x14c4f4(0x1f3)](_0x2a5eae[_0x14c4f4(0x20f)]['id']);const _0x36a8bb=await customer[_0x14c4f4(0x1ed)]({'_id':_0x2a5eae[_0x14c4f4(0x20f)]['id']});console[_0x14c4f4(0x1f3)](_0x14c4f4(0x1f2),_0x36a8bb);const _0x2ae05c=await c_payment_data[_0x14c4f4(0x1d8)]({'customer':_0x36a8bb['name']});console[_0x14c4f4(0x1f3)](_0x2ae05c);const _0x7f172b=await c_payment_data['aggregate']([{'$match':{'customer':_0x36a8bb['name']}},{'$match':{'reason':_0x14c4f4(0x1ff)}},{'$group':{'_id':_0x14c4f4(0x1d1),'sum':{'$sum':_0x14c4f4(0x1e6)}}}]);console[_0x14c4f4(0x1f3)]('payable_sum',_0x7f172b);const _0x4eeb74=await c_payment_data[_0x14c4f4(0x1e3)]([{'$match':{'customer':_0x36a8bb[_0x14c4f4(0x1b4)]}},{'$match':{'reason':_0x14c4f4(0x1bc)}},{'$group':{'_id':_0x14c4f4(0x1d1),'sum':{'$sum':_0x14c4f4(0x1e6)}}}]);console['log'](_0x14c4f4(0x20a),_0x4eeb74);if(_0x699d1b[0x0]['language']==_0x14c4f4(0x200)){var _0x27b354=users['English'];console[_0x14c4f4(0x1f3)](_0x27b354);}else{if(_0x699d1b[0x0]['language']==_0x14c4f4(0x208))var _0x27b354=users[_0x14c4f4(0x208)];else{if(_0x699d1b[0x0][_0x14c4f4(0x20b)]==_0x14c4f4(0x1cc))var _0x27b354=users['German'];else{if(_0x699d1b[0x0][_0x14c4f4(0x20b)]=='Spanish')var _0x27b354=users[_0x14c4f4(0x1bf)];else{if(_0x699d1b[0x0][_0x14c4f4(0x20b)]==_0x14c4f4(0x1de))var _0x27b354=users[_0x14c4f4(0x1de)];else{if(_0x699d1b[0x0][_0x14c4f4(0x20b)]==_0x14c4f4(0x1cf))var _0x27b354=users[_0x14c4f4(0x1e2)];else{if(_0x699d1b[0x0][_0x14c4f4(0x20b)]=='Chinese')var _0x27b354=users[_0x14c4f4(0x1d5)];else{if(_0x699d1b[0x0]['language']==_0x14c4f4(0x1f5))var _0x27b354=users[_0x14c4f4(0x1ba)];}}}}}}}_0x140d49['render'](_0x14c4f4(0x1cb),{'success':_0x2a5eae[_0x14c4f4(0x1b7)](_0x14c4f4(0x1f1)),'errors':_0x2a5eae['flash'](_0x14c4f4(0x1d7)),'role':_0x3bff52,'profile':_0x4055f9,'payment':_0x2ae05c,'payable':_0x7f172b,'receivable':_0x4eeb74,'master_shop':_0x699d1b,'language':_0x27b354});}catch(_0x2623b1){console[_0x14c4f4(0x1f3)](_0x2623b1);}}),router[a0_0x335b5e(0x206)]('/products_export_migrate_file',auth,async(_0x48de27,_0x5ef6ca)=>{const _0x48db93=a0_0x335b5e;try{const _0x29916b=new excelJS['Workbook'](),_0x2846ce=_0x29916b[_0x48db93(0x1e5)](_0x48db93(0x20c));return _0x2846ce['columns']=[{'header':'ID','key':_0x48db93(0x1c1),'width':0xa},{'header':_0x48db93(0x1f8),'key':_0x48db93(0x1f7),'width':0xa},{'header':_0x48db93(0x1e7),'key':_0x48db93(0x1da),'width':0xa},{'header':_0x48db93(0x1d4),'key':_0x48db93(0x1d4),'width':0xa},{'header':_0x48db93(0x1b1),'key':_0x48db93(0x1b1),'width':0xa},{'header':_0x48db93(0x210),'key':'mobile','width':0xa},{'header':'email','key':_0x48db93(0x1ea),'width':0xa}],_0x5ef6ca[_0x48db93(0x1bb)]('Content-Type',_0x48db93(0x1b3)),_0x5ef6ca['setHeader'](_0x48db93(0x1d2),_0x48db93(0x20d)),_0x29916b['xlsx']['write'](_0x5ef6ca)['then'](()=>{const _0x1dda77=_0x48db93;_0x5ef6ca[_0x1dda77(0x1e4)](0xc8);});}catch(_0x5cd503){_0x5ef6ca['status'](0x190)[_0x48db93(0x1bd)]({'errors':_0x5cd503[_0x48db93(0x20e)]});}});function a0_0x3d80(_0xf46b61,_0x169b46){const _0x35954b=a0_0x3595();return a0_0x3d80=function(_0x3d80f8,_0x12c370){_0x3d80f8=_0x3d80f8-0x1af;let _0x3e7cab=_0x35954b[_0x3d80f8];return _0x3e7cab;},a0_0x3d80(_0xf46b61,_0x169b46);}const storage1=multer[a0_0x335b5e(0x1b8)]({'destination':(_0x3318b5,_0x1d1b4b,_0x41dc2c)=>{const _0x5052e2=a0_0x335b5e;_0x41dc2c(null,_0x5052e2(0x1f4));},'filename':(_0x2bdc2d,_0x38f5d4,_0x18ee81)=>{const _0x19c91c=a0_0x335b5e;_0x18ee81(null,Date[_0x19c91c(0x1e0)]()+_0x38f5d4[_0x19c91c(0x1db)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x3595(){const _0x37a4a4=['Spanish','express','PName','save','6115oLMPNm','sale','utils','user','/view/:id','8xbWlGv','render','../middleware/auth','customer_payment','German','22RGZJcg','error','Portuguese\x20(BR)','filename','$reason','Content-Disposition','27822ZDSskG','SalesmanName','Chinese','receivable','errors','find','file','PUnits','originalname','English','xlsx','French','61340guGZxZ','now','sheet_to_json','Portuguese','aggregate','status','addWorksheet','$amount','SalesmanCode','master','\x20Failed','email','customer_product_fule','/view','findOne','75TixNNG','Router','5718792PJcRQA','success','customer_data','log','public/Migration','Arabic\x20(ae)','692DdsHEW','PBrands','Name','119qmCZyx','/customer/view','data','amount','public/Migration/','SheetNames','Sale','English\x20(US)','customer\x20add\x20successfully','sale_return','382744xgoPUu','../public/language/languages.json','redirect','get','customer','Hindi','json','receivable_sum','language','Customers','attachment;\x20filename=customer_Migration_File.xlsx','message','params','mobile','c_payments','Sheets','customer_docs','post','../models/all_models','address','findById','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','name','body','741807UuVesx','flash','diskStorage','exports','Arabic','setHeader','Sale\x20Return','send','3631260RRysdL'];a0_0x3595=function(){return _0x37a4a4;};return a0_0x3595();}router[a0_0x335b5e(0x1af)]('/customer_import_migrate_file',auth,uploadMigrate['single'](a0_0x335b5e(0x1eb)),async(_0xe43c0a,_0x4a8773)=>{const _0x3b56de=a0_0x335b5e,_0x91ccd4=_0xe43c0a[_0x3b56de(0x1d9)][_0x3b56de(0x1d0)],_0x31ded7=await xlsx['readFile'](_0x3b56de(0x1fd)+_0x91ccd4);let _0x14b30a=_0x31ded7[_0x3b56de(0x1fe)],_0x44eb39=xlsx[_0x3b56de(0x1c5)][_0x3b56de(0x1e1)](_0x31ded7[_0x3b56de(0x212)][_0x14b30a[0x0]]);for(const _0x41e021 of _0x44eb39){const _0x3953d8=_0x41e021['ID'],_0x3f201c=_0x41e021[_0x3b56de(0x1f8)],_0x198338=_0x41e021[_0x3b56de(0x1e7)],_0x2d1b82=_0x41e021[_0x3b56de(0x1d4)],_0x549ce6=_0x41e021[_0x3b56de(0x1b1)],_0x17335a=_0x41e021[_0x3b56de(0x210)],_0x102ec3=_0x41e021[_0x3b56de(0x1ea)];try{let _0xc17486=await customer[_0x3b56de(0x1ed)]({'name':_0x3f201c});if(!_0xc17486){const _0x23df41=new customer({'name':_0x3f201c,'ID':_0x3953d8,'SalesmanCode':_0x198338,'SalesmanName':_0x2d1b82,'address':_0x549ce6,'mobile':_0x17335a,'email':_0x102ec3});_0xc17486=await _0x23df41['save'](),_0xe43c0a[_0x3b56de(0x1b7)](_0x3b56de(0x1f1),_0x3f201c+'\x20added\x20successfully');}else _0xe43c0a[_0x3b56de(0x1b7)](_0x3b56de(0x1ce),_0x3f201c+_0x3b56de(0x1e9));}catch(_0x3f6d84){_0x4a8773[_0x3b56de(0x1e4)](0x1f4)[_0x3b56de(0x209)]({'proderror':_0x3f6d84[_0x3b56de(0x20e)],'aproduct':ProductName});}}_0x4a8773[_0x3b56de(0x205)](_0x3b56de(0x1fa));}),module[a0_0x335b5e(0x1b9)]=router;