const a0_0x418295=a0_0x38e6;(function(_0x577f3a,_0x4b5571){const _0x5eb74f=a0_0x38e6,_0x163b3f=_0x577f3a();while(!![]){try{const _0x2b87fe=-parseInt(_0x5eb74f(0x1a2))/0x1+-parseInt(_0x5eb74f(0x1d5))/0x2*(-parseInt(_0x5eb74f(0x1e5))/0x3)+-parseInt(_0x5eb74f(0x1dc))/0x4*(-parseInt(_0x5eb74f(0x1ae))/0x5)+-parseInt(_0x5eb74f(0x1c6))/0x6+parseInt(_0x5eb74f(0x1ed))/0x7*(parseInt(_0x5eb74f(0x1da))/0x8)+parseInt(_0x5eb74f(0x1ab))/0x9+parseInt(_0x5eb74f(0x1e0))/0xa;if(_0x2b87fe===_0x4b5571)break;else _0x163b3f['push'](_0x163b3f['shift']());}catch(_0x208e5e){_0x163b3f['push'](_0x163b3f['shift']());}}}(a0_0x2aa2,0x8a680));function a0_0x38e6(_0x300b06,_0x27f4c4){const _0x2aa28c=a0_0x2aa2();return a0_0x38e6=function(_0x38e641,_0x3fdd23){_0x38e641=_0x38e641-0x1a1;let _0x483e1f=_0x2aa28c[_0x38e641];return _0x483e1f;},a0_0x38e6(_0x300b06,_0x27f4c4);}const express=require(a0_0x418295(0x1fc)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x418295(0x1cc)),auth=require(a0_0x418295(0x1fa)),users=require('../public/language/languages.json'),excelJS=require(a0_0x418295(0x209)),xlsx=require(a0_0x418295(0x1f8)),multer=require(a0_0x418295(0x1b5));router['get'](a0_0x418295(0x203),auth,async(_0x545e0c,_0x8ba387)=>{const _0x40f676=a0_0x418295;try{const {username:_0x2ea1b2,email:_0x7f2af3,role:_0x364b34}=_0x545e0c[_0x40f676(0x1d8)],_0x48bdc3=_0x545e0c['user'],_0x2ca657=await profile[_0x40f676(0x1bc)]({'email':_0x48bdc3['email']}),_0x5a66f5=await master_shop[_0x40f676(0x1fd)]();console[_0x40f676(0x1f2)](_0x40f676(0x1ce),_0x5a66f5);const _0x5c3aba=await customer[_0x40f676(0x1fd)](),_0x3dc1d3=await customer[_0x40f676(0x1ef)]([{'$lookup':{'from':_0x40f676(0x1ec),'localField':_0x40f676(0x201),'foreignField':_0x40f676(0x1f6),'as':_0x40f676(0x202)}}]);console['log'](_0x3dc1d3);const _0x29bcb2=_0x3dc1d3[_0x40f676(0x1b6)](_0x2b6b33=>{const _0xc3dded=_0x40f676;console[_0xc3dded(0x1f2)]('data',_0x2b6b33);var _0x3cc2b9=0x0,_0x502a3b=0x0;return _0x2b6b33['customer_docs'][_0xc3dded(0x1a6)](_0x564d6e=>{const _0x43008a=_0xc3dded;console[_0x43008a(0x1f2)]('element',_0x564d6e),_0x564d6e[_0x43008a(0x1db)]==_0x43008a(0x1f4)?_0x3cc2b9+=_0x564d6e[_0x43008a(0x1af)]:_0x502a3b+=_0x564d6e[_0x43008a(0x1af)];}),_0x2b6b33[_0xc3dded(0x1c3)]=parseFloat(_0x3cc2b9)+0x0,_0x2b6b33['sale_return']=parseFloat(_0x502a3b)+0x0,_0x2b6b33;});console['log'](_0x40f676(0x1b8),_0x29bcb2);if(_0x5a66f5[0x0][_0x40f676(0x1a3)]==_0x40f676(0x1fb)){var _0x5afb36=users[_0x40f676(0x1d9)];console[_0x40f676(0x1f2)](_0x5afb36);}else{if(_0x5a66f5[0x0]['language']==_0x40f676(0x1e3))var _0x5afb36=users[_0x40f676(0x1e3)];else{if(_0x5a66f5[0x0][_0x40f676(0x1a3)]=='German')var _0x5afb36=users[_0x40f676(0x1de)];else{if(_0x5a66f5[0x0][_0x40f676(0x1a3)]==_0x40f676(0x1e7))var _0x5afb36=users[_0x40f676(0x1e7)];else{if(_0x5a66f5[0x0]['language']=='French')var _0x5afb36=users['French'];else{if(_0x5a66f5[0x0][_0x40f676(0x1a3)]==_0x40f676(0x1b3))var _0x5afb36=users['Portuguese'];else{if(_0x5a66f5[0x0][_0x40f676(0x1a3)]==_0x40f676(0x1a7))var _0x5afb36=users['Chinese'];else{if(_0x5a66f5[0x0][_0x40f676(0x1a3)]==_0x40f676(0x1e9))var _0x5afb36=users[_0x40f676(0x1ba)];}}}}}}}_0x8ba387[_0x40f676(0x1be)]('customer',{'success':_0x545e0c[_0x40f676(0x1bf)](_0x40f676(0x1c8)),'errors':_0x545e0c[_0x40f676(0x1bf)](_0x40f676(0x1b0)),'user':_0x5c3aba,'role':_0x48bdc3,'profile':_0x2ca657,'payment':_0x29bcb2,'master_shop':_0x5a66f5,'language':_0x5afb36});}catch(_0x255b85){console[_0x40f676(0x1f2)](_0x255b85);}}),router[a0_0x418295(0x1d6)](a0_0x418295(0x203),auth,async(_0x5615e5,_0x5c2b82)=>{const _0x11d909=a0_0x418295;try{const {name:_0x3d9601,address:_0x2058a8,mobile:_0x5631d2,email:_0x2211a7,receivable:_0x3441b7,payable:_0x360049,contactperson:_0x3f0589,landline:_0x151f39}=_0x5615e5['body'],_0x410bf6=new customer({'name':_0x3d9601,'address':_0x2058a8,'mobile':_0x5631d2,'email':_0x2211a7,'receivable':_0x3441b7,'payable':_0x360049,'contactperson':_0x3f0589,'landline':_0x151f39}),_0x3d0d24=await _0x410bf6[_0x11d909(0x1b7)]();_0x5615e5['flash'](_0x11d909(0x1c8),_0x11d909(0x1ea)),_0x5c2b82[_0x11d909(0x1aa)]('/customer/view');}catch(_0x431011){console['log'](_0x431011);}}),router[a0_0x418295(0x1cf)](a0_0x418295(0x1c1),auth,async(_0x4538fb,_0x2e068d)=>{const _0x5dcd3a=a0_0x418295;try{const {username:_0x1a19c7,email:_0x4b5dec,role:_0x3825f0}=_0x4538fb[_0x5dcd3a(0x1d8)],_0x3e2b6c=_0x4538fb[_0x5dcd3a(0x1d8)],_0x1ca1e0=await profile[_0x5dcd3a(0x1bc)]({'email':_0x3e2b6c[_0x5dcd3a(0x1e8)]}),_0x11200b=await master_shop[_0x5dcd3a(0x1fd)]();console[_0x5dcd3a(0x1f2)](_0x5dcd3a(0x1ce),_0x11200b);const _0x182f74=_0x4538fb['params']['id'],_0xbef845=await customer[_0x5dcd3a(0x1f3)](_0x182f74);if(_0x11200b[0x0][_0x5dcd3a(0x1a3)]==_0x5dcd3a(0x1fb)){var _0xcc3eaf=users[_0x5dcd3a(0x1d9)];console[_0x5dcd3a(0x1f2)](_0xcc3eaf);}else{if(_0x11200b[0x0][_0x5dcd3a(0x1a3)]==_0x5dcd3a(0x1e3))var _0xcc3eaf=users[_0x5dcd3a(0x1e3)];else{if(_0x11200b[0x0][_0x5dcd3a(0x1a3)]==_0x5dcd3a(0x1de))var _0xcc3eaf=users[_0x5dcd3a(0x1de)];else{if(_0x11200b[0x0][_0x5dcd3a(0x1a3)]=='Spanish')var _0xcc3eaf=users['Spanish'];else{if(_0x11200b[0x0][_0x5dcd3a(0x1a3)]==_0x5dcd3a(0x1f0))var _0xcc3eaf=users[_0x5dcd3a(0x1f0)];else{if(_0x11200b[0x0]['language']==_0x5dcd3a(0x1b3))var _0xcc3eaf=users[_0x5dcd3a(0x204)];else{if(_0x11200b[0x0][_0x5dcd3a(0x1a3)]=='Chinese')var _0xcc3eaf=users[_0x5dcd3a(0x1a7)];else{if(_0x11200b[0x0][_0x5dcd3a(0x1a3)]==_0x5dcd3a(0x1e9))var _0xcc3eaf=users[_0x5dcd3a(0x1ba)];}}}}}}}_0x2e068d[_0x5dcd3a(0x1be)]('customer',{'success':_0x4538fb[_0x5dcd3a(0x1bf)](_0x5dcd3a(0x1c8)),'errors':_0x4538fb[_0x5dcd3a(0x1bf)](_0x5dcd3a(0x1b0)),'role':_0x3e2b6c,'profile':_0x1ca1e0,'user':_0xbef845,'master_shop':_0x11200b,'language':_0xcc3eaf});}catch(_0x1301cc){console[_0x5dcd3a(0x1f2)](_0x1301cc);}}),router[a0_0x418295(0x1d6)]('/view/:id',auth,async(_0x4d95c5,_0x2a49ad)=>{const _0x4c33fb=a0_0x418295;try{const _0x1458f9=_0x4d95c5[_0x4c33fb(0x1cb)]['id'],_0x2538d5=await customer[_0x4c33fb(0x1f3)](_0x1458f9),{name:_0x4e1026,address:_0x1a52cf,mobile:_0x1f0041,email:_0x2bfc91,receivable:_0x3f6dcf,payable:_0x310ead,contactperson:_0x3c0a64,landline:_0x331af1}=_0x4d95c5[_0x4c33fb(0x1ca)];_0x2538d5[_0x4c33fb(0x201)]=_0x4e1026,_0x2538d5[_0x4c33fb(0x1a8)]=_0x1a52cf,_0x2538d5[_0x4c33fb(0x1a1)]=_0x1f0041,_0x2538d5['email']=_0x2bfc91,_0x2538d5['receivable']=_0x3f6dcf,_0x2538d5[_0x4c33fb(0x1df)]=_0x310ead,_0x2538d5['contactperson']=_0x3c0a64,_0x2538d5[_0x4c33fb(0x1b2)]=_0x331af1;const _0xf6d8b7=await _0x2538d5[_0x4c33fb(0x1b7)]();_0x4d95c5[_0x4c33fb(0x1bf)]('success',_0x4c33fb(0x1b4)),_0x2a49ad[_0x4c33fb(0x1aa)](_0x4c33fb(0x1d0));}catch(_0xbf5218){console[_0x4c33fb(0x1f2)](_0xbf5218);}}),router[a0_0x418295(0x1cf)](a0_0x418295(0x20a),auth,async(_0x3f9535,_0x1336f0)=>{const _0x5b3d56=a0_0x418295;try{const {username:_0x2e4c97,email:_0x3ed251,role:_0x23dad9}=_0x3f9535['user'],_0x5219c=_0x3f9535[_0x5b3d56(0x1d8)],_0x344075=await profile[_0x5b3d56(0x1bc)]({'email':_0x5219c[_0x5b3d56(0x1e8)]}),_0x1aa368=await master_shop[_0x5b3d56(0x1fd)]();console[_0x5b3d56(0x1f2)](_0x5b3d56(0x1ce),_0x1aa368),console['log'](_0x3f9535[_0x5b3d56(0x1cb)]['id']);const _0x3feabe=await customer['findOne']({'_id':_0x3f9535[_0x5b3d56(0x1cb)]['id']});console[_0x5b3d56(0x1f2)](_0x5b3d56(0x1bb),_0x3feabe);const _0x362740=await c_payment_data['find']({'customer':_0x3feabe[_0x5b3d56(0x201)]});console[_0x5b3d56(0x1f2)](_0x362740);const _0x239bd3=await c_payment_data[_0x5b3d56(0x1ef)]([{'$match':{'customer':_0x3feabe['name']}},{'$match':{'reason':'Sale'}},{'$group':{'_id':_0x5b3d56(0x1c9),'sum':{'$sum':_0x5b3d56(0x1e4)}}}]);console[_0x5b3d56(0x1f2)](_0x5b3d56(0x1ee),_0x239bd3);const _0x17019d=await c_payment_data[_0x5b3d56(0x1ef)]([{'$match':{'customer':_0x3feabe['name']}},{'$match':{'reason':_0x5b3d56(0x1ac)}},{'$group':{'_id':_0x5b3d56(0x1c9),'sum':{'$sum':_0x5b3d56(0x1e4)}}}]);console[_0x5b3d56(0x1f2)](_0x5b3d56(0x1a4),_0x17019d);if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]==_0x5b3d56(0x1fb)){var _0x370460=users[_0x5b3d56(0x1d9)];console[_0x5b3d56(0x1f2)](_0x370460);}else{if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]==_0x5b3d56(0x1e3))var _0x370460=users[_0x5b3d56(0x1e3)];else{if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]==_0x5b3d56(0x1de))var _0x370460=users[_0x5b3d56(0x1de)];else{if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]=='Spanish')var _0x370460=users[_0x5b3d56(0x1e7)];else{if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]==_0x5b3d56(0x1f0))var _0x370460=users[_0x5b3d56(0x1f0)];else{if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]=='Portuguese\x20(BR)')var _0x370460=users[_0x5b3d56(0x204)];else{if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]=='Chinese')var _0x370460=users['Chinese'];else{if(_0x1aa368[0x0][_0x5b3d56(0x1a3)]=='Arabic\x20(ae)')var _0x370460=users['Arabic'];}}}}}}}_0x1336f0[_0x5b3d56(0x1be)](_0x5b3d56(0x1cd),{'success':_0x3f9535[_0x5b3d56(0x1bf)](_0x5b3d56(0x1c8)),'errors':_0x3f9535[_0x5b3d56(0x1bf)](_0x5b3d56(0x1b0)),'role':_0x5219c,'profile':_0x344075,'payment':_0x362740,'payable':_0x239bd3,'receivable':_0x17019d,'master_shop':_0x1aa368,'language':_0x370460});}catch(_0x4ad660){console[_0x5b3d56(0x1f2)](_0x4ad660);}}),router[a0_0x418295(0x1cf)](a0_0x418295(0x208),auth,async(_0x47f9ec,_0x127794)=>{const _0x2a97c9=a0_0x418295;try{const _0x5e4298=new excelJS[(_0x2a97c9(0x200))](),_0x53ec37=_0x5e4298[_0x2a97c9(0x1d2)](_0x2a97c9(0x206));return _0x53ec37[_0x2a97c9(0x1d7)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x2a97c9(0x1f5),'key':'PBrands','width':0xa},{'header':'SalesmanCode','key':'PUnits','width':0xa},{'header':_0x2a97c9(0x1c4),'key':_0x2a97c9(0x1c4),'width':0xa},{'header':'address','key':_0x2a97c9(0x1a8),'width':0xa},{'header':_0x2a97c9(0x1a1),'key':_0x2a97c9(0x1a1),'width':0xa},{'header':'email','key':_0x2a97c9(0x1e8),'width':0xa}],_0x127794[_0x2a97c9(0x1ff)](_0x2a97c9(0x1c0),_0x2a97c9(0x1b1)),_0x127794[_0x2a97c9(0x1ff)](_0x2a97c9(0x1fe),_0x2a97c9(0x1d3)),_0x5e4298[_0x2a97c9(0x1f8)]['write'](_0x127794)[_0x2a97c9(0x1f9)](()=>{const _0xcf28f0=_0x2a97c9;_0x127794[_0xcf28f0(0x1bd)](0xc8);});}catch(_0x41aaa8){_0x127794[_0x2a97c9(0x1bd)](0x190)[_0x2a97c9(0x1d1)]({'errors':_0x41aaa8['message']});}});function a0_0x2aa2(){const _0x2cacaf=['email','Arabic\x20(ae)','customer\x20add\x20successfully','error','c_payments','1351ggOIct','payable_sum','aggregate','French','sheet_to_json','log','findById','Sale','Name','customer','SheetNames','xlsx','then','../middleware/auth','English\x20(US)','express','find','Content-Disposition','setHeader','Workbook','name','customer_docs','/view','Portuguese','exports','Customers','public/Migration/','/products_export_migrate_file','exceljs','/view/payment/:id','mobile','585468kShzgF','language','receivable_sum','single','forEach','Chinese','address','file','redirect','4615416gjzgfK','Sale\x20Return','/customer_import_migrate_file','425WXjGYY','amount','errors','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','landline','Portuguese\x20(BR)','customer\x20update\x20successfully','multer','map','save','payment_data','filename','Arabic','customer_data','findOne','status','render','flash','Content-Type','/view/:id','\x20added\x20successfully','sale','SalesmanName','utils','5511594hZgILS','SalesmanCode','success','$reason','body','params','../models/all_models','customer_payment','master','get','/customer/view','send','addWorksheet','attachment;\x20filename=customer_Migration_File.xlsx','now','6850gnejYd','post','columns','user','English','968euPXly','reason','47608YezQXO','diskStorage','German','payable','4683320etjSIE','originalname','json','Hindi','$amount','48qzZgZw','public/Migration','Spanish'];a0_0x2aa2=function(){return _0x2cacaf;};return a0_0x2aa2();}const storage1=multer[a0_0x418295(0x1dd)]({'destination':(_0x5e8321,_0x295c78,_0x43e631)=>{const _0x4efbdc=a0_0x418295;_0x43e631(null,_0x4efbdc(0x1e6));},'filename':(_0x555349,_0x34ec7e,_0x572c64)=>{const _0x5c7ef9=a0_0x418295;_0x572c64(null,Date[_0x5c7ef9(0x1d4)]()+_0x34ec7e[_0x5c7ef9(0x1e1)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x418295(0x1ad),auth,uploadMigrate[a0_0x418295(0x1a5)]('customer_product_fule'),async(_0x4b162b,_0x4d4abc)=>{const _0x36e93c=a0_0x418295,_0x5184f6=_0x4b162b[_0x36e93c(0x1a9)][_0x36e93c(0x1b9)],_0x3baeaf=await xlsx['readFile'](_0x36e93c(0x207)+_0x5184f6);let _0x3be4e7=_0x3baeaf[_0x36e93c(0x1f7)],_0x3a5dc2=xlsx[_0x36e93c(0x1c5)][_0x36e93c(0x1f1)](_0x3baeaf['Sheets'][_0x3be4e7[0x0]]);for(const _0x5c4146 of _0x3a5dc2){const _0x3c022f=_0x5c4146['ID'],_0x54a6c5=_0x5c4146[_0x36e93c(0x1f5)],_0x44446c=_0x5c4146[_0x36e93c(0x1c7)],_0x1ccea6=_0x5c4146[_0x36e93c(0x1c4)],_0x404b40=_0x5c4146['address'],_0x33b69d=_0x5c4146[_0x36e93c(0x1a1)],_0x149a56=_0x5c4146[_0x36e93c(0x1e8)];try{let _0x537e6b=await customer[_0x36e93c(0x1bc)]({'name':_0x54a6c5});if(!_0x537e6b){const _0x52ae4d=new customer({'name':_0x54a6c5,'ID':_0x3c022f,'SalesmanCode':_0x44446c,'SalesmanName':_0x1ccea6,'address':_0x404b40,'mobile':_0x33b69d,'email':_0x149a56});_0x537e6b=await _0x52ae4d[_0x36e93c(0x1b7)](),_0x4b162b[_0x36e93c(0x1bf)](_0x36e93c(0x1c8),_0x54a6c5+_0x36e93c(0x1c2));}else _0x4b162b[_0x36e93c(0x1bf)](_0x36e93c(0x1eb),_0x54a6c5+'\x20Failed');}catch(_0x43e0fa){_0x4d4abc[_0x36e93c(0x1bd)](0x1f4)[_0x36e93c(0x1e2)]({'proderror':_0x43e0fa['message'],'aproduct':ProductName});}}_0x4d4abc[_0x36e93c(0x1aa)](_0x36e93c(0x1d0));}),module[a0_0x418295(0x205)]=router;