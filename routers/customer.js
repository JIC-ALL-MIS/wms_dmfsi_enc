function a0_0x4ea1(_0x5d9aec,_0x2d0618){const _0x487d4d=a0_0x487d();return a0_0x4ea1=function(_0x4ea1b2,_0x1c6906){_0x4ea1b2=_0x4ea1b2-0x123;let _0xb873e7=_0x487d4d[_0x4ea1b2];return _0xb873e7;},a0_0x4ea1(_0x5d9aec,_0x2d0618);}const a0_0x41adad=a0_0x4ea1;(function(_0x8f95d7,_0x3e8355){const _0x1b0abe=a0_0x4ea1,_0x41911b=_0x8f95d7();while(!![]){try{const _0x4dfef4=-parseInt(_0x1b0abe(0x17d))/0x1*(-parseInt(_0x1b0abe(0x12a))/0x2)+-parseInt(_0x1b0abe(0x13a))/0x3*(-parseInt(_0x1b0abe(0x173))/0x4)+-parseInt(_0x1b0abe(0x14e))/0x5+-parseInt(_0x1b0abe(0x125))/0x6+parseInt(_0x1b0abe(0x163))/0x7*(-parseInt(_0x1b0abe(0x169))/0x8)+parseInt(_0x1b0abe(0x144))/0x9*(-parseInt(_0x1b0abe(0x187))/0xa)+parseInt(_0x1b0abe(0x16f))/0xb;if(_0x4dfef4===_0x3e8355)break;else _0x41911b['push'](_0x41911b['shift']());}catch(_0x444c1a){_0x41911b['push'](_0x41911b['shift']());}}}(a0_0x487d,0x7fe5b));const express=require(a0_0x41adad(0x14d)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),excelJS=require(a0_0x41adad(0x140)),xlsx=require(a0_0x41adad(0x166)),multer=require(a0_0x41adad(0x12f));router[a0_0x41adad(0x154)](a0_0x41adad(0x17c),auth,async(_0x43c7f6,_0x1448eb)=>{const _0x27e35e=a0_0x41adad;try{const {username:_0x1de37d,email:_0x587083,role:_0x4555a8}=_0x43c7f6[_0x27e35e(0x155)],_0x32bd6b=_0x43c7f6[_0x27e35e(0x155)],_0xcb7cbb=await profile[_0x27e35e(0x177)]({'email':_0x32bd6b[_0x27e35e(0x13e)]}),_0x56c672=await master_shop[_0x27e35e(0x13c)]();console[_0x27e35e(0x145)](_0x27e35e(0x134),_0x56c672);const _0x36db27=await customer[_0x27e35e(0x13c)](),_0x15c0d8=await customer[_0x27e35e(0x14c)]([{'$lookup':{'from':_0x27e35e(0x147),'localField':_0x27e35e(0x13d),'foreignField':_0x27e35e(0x167),'as':_0x27e35e(0x175)}}]);console[_0x27e35e(0x145)](_0x15c0d8);const _0x6f519a=_0x15c0d8[_0x27e35e(0x178)](_0x2d7576=>{const _0x19bd9d=_0x27e35e;console[_0x19bd9d(0x145)]('data',_0x2d7576);var _0x255122=0x0,_0x2773e5=0x0;return _0x2d7576[_0x19bd9d(0x175)][_0x19bd9d(0x12e)](_0x11a191=>{const _0x16408d=_0x19bd9d;console['log'](_0x16408d(0x131),_0x11a191),_0x11a191[_0x16408d(0x170)]==_0x16408d(0x168)?_0x255122+=_0x11a191[_0x16408d(0x183)]:_0x2773e5+=_0x11a191[_0x16408d(0x183)];}),_0x2d7576['sale']=parseFloat(_0x255122)+0x0,_0x2d7576[_0x19bd9d(0x15e)]=parseFloat(_0x2773e5)+0x0,_0x2d7576;});console[_0x27e35e(0x145)](_0x27e35e(0x143),_0x6f519a);if(_0x56c672[0x0]['language']==_0x27e35e(0x128)){var _0x3af017=users[_0x27e35e(0x17b)];console['log'](_0x3af017);}else{if(_0x56c672[0x0][_0x27e35e(0x186)]=='Hindi')var _0x3af017=users['Hindi'];else{if(_0x56c672[0x0][_0x27e35e(0x186)]==_0x27e35e(0x158))var _0x3af017=users[_0x27e35e(0x158)];else{if(_0x56c672[0x0]['language']==_0x27e35e(0x15d))var _0x3af017=users['Spanish'];else{if(_0x56c672[0x0]['language']=='French')var _0x3af017=users['French'];else{if(_0x56c672[0x0][_0x27e35e(0x186)]==_0x27e35e(0x164))var _0x3af017=users[_0x27e35e(0x14f)];else{if(_0x56c672[0x0][_0x27e35e(0x186)]==_0x27e35e(0x150))var _0x3af017=users[_0x27e35e(0x150)];else{if(_0x56c672[0x0][_0x27e35e(0x186)]==_0x27e35e(0x148))var _0x3af017=users[_0x27e35e(0x176)];}}}}}}}_0x1448eb[_0x27e35e(0x17a)](_0x27e35e(0x167),{'success':_0x43c7f6[_0x27e35e(0x16d)](_0x27e35e(0x146)),'errors':_0x43c7f6[_0x27e35e(0x16d)]('errors'),'user':_0x36db27,'role':_0x32bd6b,'profile':_0xcb7cbb,'payment':_0x6f519a,'master_shop':_0x56c672,'language':_0x3af017});}catch(_0x3d887a){console[_0x27e35e(0x145)](_0x3d887a);}}),router[a0_0x41adad(0x16b)](a0_0x41adad(0x17c),auth,async(_0x3e2dab,_0x3326bd)=>{const _0x523f23=a0_0x41adad;try{const {name:_0x390200,address:_0x374d62,mobile:_0x3b4b90,email:_0x359f28,receivable:_0x3a2676,payable:_0xc832fb,contactperson:_0x5c16c8,landline:_0x11217a}=_0x3e2dab[_0x523f23(0x136)],_0x471b82=new customer({'name':_0x390200,'address':_0x374d62,'mobile':_0x3b4b90,'email':_0x359f28,'receivable':_0x3a2676,'payable':_0xc832fb,'contactperson':_0x5c16c8,'landline':_0x11217a}),_0x599f3d=await _0x471b82['save']();_0x3e2dab['flash'](_0x523f23(0x146),_0x523f23(0x181)),_0x3326bd[_0x523f23(0x185)]('/customer/view');}catch(_0x1b5f23){console[_0x523f23(0x145)](_0x1b5f23);}}),router[a0_0x41adad(0x154)](a0_0x41adad(0x16e),auth,async(_0x238e82,_0x3a24ab)=>{const _0x11c65c=a0_0x41adad;try{const {username:_0x30644c,email:_0x5ac88a,role:_0xfa004a}=_0x238e82['user'],_0x55763e=_0x238e82[_0x11c65c(0x155)],_0x50c515=await profile['findOne']({'email':_0x55763e['email']}),_0x2e3faf=await master_shop[_0x11c65c(0x13c)]();console[_0x11c65c(0x145)](_0x11c65c(0x134),_0x2e3faf);const _0x1fc402=_0x238e82['params']['id'],_0x5100e8=await customer[_0x11c65c(0x161)](_0x1fc402);if(_0x2e3faf[0x0][_0x11c65c(0x186)]==_0x11c65c(0x128)){var _0xff80c0=users[_0x11c65c(0x17b)];console[_0x11c65c(0x145)](_0xff80c0);}else{if(_0x2e3faf[0x0][_0x11c65c(0x186)]==_0x11c65c(0x152))var _0xff80c0=users[_0x11c65c(0x152)];else{if(_0x2e3faf[0x0]['language']==_0x11c65c(0x158))var _0xff80c0=users[_0x11c65c(0x158)];else{if(_0x2e3faf[0x0][_0x11c65c(0x186)]==_0x11c65c(0x15d))var _0xff80c0=users['Spanish'];else{if(_0x2e3faf[0x0][_0x11c65c(0x186)]=='French')var _0xff80c0=users[_0x11c65c(0x12c)];else{if(_0x2e3faf[0x0]['language']==_0x11c65c(0x164))var _0xff80c0=users[_0x11c65c(0x14f)];else{if(_0x2e3faf[0x0][_0x11c65c(0x186)]=='Chinese')var _0xff80c0=users[_0x11c65c(0x150)];else{if(_0x2e3faf[0x0][_0x11c65c(0x186)]==_0x11c65c(0x148))var _0xff80c0=users[_0x11c65c(0x176)];}}}}}}}_0x3a24ab[_0x11c65c(0x17a)](_0x11c65c(0x167),{'success':_0x238e82[_0x11c65c(0x16d)]('success'),'errors':_0x238e82[_0x11c65c(0x16d)]('errors'),'role':_0x55763e,'profile':_0x50c515,'user':_0x5100e8,'master_shop':_0x2e3faf,'language':_0xff80c0});}catch(_0x257d71){console['log'](_0x257d71);}}),router['post'](a0_0x41adad(0x16e),auth,async(_0x98d1ce,_0x594a31)=>{const _0x1e8677=a0_0x41adad;try{const _0x5791f5=_0x98d1ce['params']['id'],_0x1e464e=await customer['findById'](_0x5791f5),{name:_0x43cb07,address:_0x343153,mobile:_0x43eb2c,email:_0x25052f,receivable:_0x3881fd,payable:_0x1e0d9e,contactperson:_0xeaa791,landline:_0x30457d}=_0x98d1ce['body'];_0x1e464e['name']=_0x43cb07,_0x1e464e[_0x1e8677(0x171)]=_0x343153,_0x1e464e[_0x1e8677(0x180)]=_0x43eb2c,_0x1e464e['email']=_0x25052f,_0x1e464e['receivable']=_0x3881fd,_0x1e464e['payable']=_0x1e0d9e,_0x1e464e[_0x1e8677(0x12d)]=_0xeaa791,_0x1e464e['landline']=_0x30457d;const _0x254e82=await _0x1e464e[_0x1e8677(0x156)]();_0x98d1ce['flash'](_0x1e8677(0x146),_0x1e8677(0x15c)),_0x594a31[_0x1e8677(0x185)]('/customer/view');}catch(_0x9969ed){console['log'](_0x9969ed);}}),router['get'](a0_0x41adad(0x153),auth,async(_0x274e7c,_0x4c5558)=>{const _0x374d0e=a0_0x41adad;try{const {username:_0x1548f6,email:_0x12d791,role:_0xad8d7}=_0x274e7c[_0x374d0e(0x155)],_0x231f0e=_0x274e7c['user'],_0x56eaa3=await profile[_0x374d0e(0x177)]({'email':_0x231f0e['email']}),_0x43ee1e=await master_shop[_0x374d0e(0x13c)]();console[_0x374d0e(0x145)](_0x374d0e(0x134),_0x43ee1e),console['log'](_0x274e7c[_0x374d0e(0x133)]['id']);const _0x2a70bc=await customer[_0x374d0e(0x177)]({'_id':_0x274e7c['params']['id']});console[_0x374d0e(0x145)](_0x374d0e(0x132),_0x2a70bc);const _0x7e1000=await c_payment_data['find']({'customer':_0x2a70bc[_0x374d0e(0x13d)]});console['log'](_0x7e1000);const _0x910df6=await c_payment_data[_0x374d0e(0x14c)]([{'$match':{'customer':_0x2a70bc[_0x374d0e(0x13d)]}},{'$match':{'reason':_0x374d0e(0x168)}},{'$group':{'_id':_0x374d0e(0x135),'sum':{'$sum':_0x374d0e(0x17f)}}}]);console[_0x374d0e(0x145)](_0x374d0e(0x15a),_0x910df6);const _0x1c833a=await c_payment_data[_0x374d0e(0x14c)]([{'$match':{'customer':_0x2a70bc['name']}},{'$match':{'reason':_0x374d0e(0x15f)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x374d0e(0x17f)}}}]);console[_0x374d0e(0x145)](_0x374d0e(0x184),_0x1c833a);if(_0x43ee1e[0x0][_0x374d0e(0x186)]==_0x374d0e(0x128)){var _0x4f5eeb=users[_0x374d0e(0x17b)];console[_0x374d0e(0x145)](_0x4f5eeb);}else{if(_0x43ee1e[0x0]['language']==_0x374d0e(0x152))var _0x4f5eeb=users['Hindi'];else{if(_0x43ee1e[0x0]['language']==_0x374d0e(0x158))var _0x4f5eeb=users[_0x374d0e(0x158)];else{if(_0x43ee1e[0x0][_0x374d0e(0x186)]==_0x374d0e(0x15d))var _0x4f5eeb=users[_0x374d0e(0x15d)];else{if(_0x43ee1e[0x0][_0x374d0e(0x186)]==_0x374d0e(0x12c))var _0x4f5eeb=users[_0x374d0e(0x12c)];else{if(_0x43ee1e[0x0][_0x374d0e(0x186)]==_0x374d0e(0x164))var _0x4f5eeb=users[_0x374d0e(0x14f)];else{if(_0x43ee1e[0x0][_0x374d0e(0x186)]=='Chinese')var _0x4f5eeb=users['Chinese'];else{if(_0x43ee1e[0x0]['language']=='Arabic\x20(ae)')var _0x4f5eeb=users[_0x374d0e(0x176)];}}}}}}}_0x4c5558['render']('customer_payment',{'success':_0x274e7c['flash'](_0x374d0e(0x146)),'errors':_0x274e7c['flash']('errors'),'role':_0x231f0e,'profile':_0x56eaa3,'payment':_0x7e1000,'payable':_0x910df6,'receivable':_0x1c833a,'master_shop':_0x43ee1e,'language':_0x4f5eeb});}catch(_0x214e43){console[_0x374d0e(0x145)](_0x214e43);}}),router['get'](a0_0x41adad(0x179),auth,async(_0x3a914e,_0x1c7e65)=>{const _0x1ceeb2=a0_0x41adad;try{const _0x283425=new excelJS[(_0x1ceeb2(0x16c))](),_0x4f8a97=_0x283425[_0x1ceeb2(0x149)](_0x1ceeb2(0x14a));return _0x4f8a97[_0x1ceeb2(0x151)]=[{'header':'ID','key':_0x1ceeb2(0x141),'width':0xa},{'header':_0x1ceeb2(0x124),'key':'PBrands','width':0xa},{'header':_0x1ceeb2(0x14b),'key':_0x1ceeb2(0x126),'width':0xa},{'header':_0x1ceeb2(0x13f),'key':_0x1ceeb2(0x13f),'width':0xa},{'header':_0x1ceeb2(0x171),'key':_0x1ceeb2(0x171),'width':0xa},{'header':_0x1ceeb2(0x180),'key':'mobile','width':0xa},{'header':_0x1ceeb2(0x13e),'key':_0x1ceeb2(0x13e),'width':0xa}],_0x1c7e65[_0x1ceeb2(0x159)]('Content-Type',_0x1ceeb2(0x123)),_0x1c7e65[_0x1ceeb2(0x159)](_0x1ceeb2(0x139),_0x1ceeb2(0x17e)),_0x283425[_0x1ceeb2(0x166)][_0x1ceeb2(0x13b)](_0x1c7e65)[_0x1ceeb2(0x137)](()=>{_0x1c7e65['status'](0xc8);});}catch(_0x4faef8){_0x1c7e65[_0x1ceeb2(0x157)](0x190)[_0x1ceeb2(0x172)]({'errors':_0x4faef8['message']});}});const storage1=multer[a0_0x41adad(0x162)]({'destination':(_0x14df07,_0x13a722,_0x2c8c3e)=>{_0x2c8c3e(null,'public/Migration');},'filename':(_0x3c98de,_0x18903f,_0x208ce2)=>{const _0x24a668=a0_0x41adad;_0x208ce2(null,Date[_0x24a668(0x129)]()+_0x18903f[_0x24a668(0x16a)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x487d(){const _0x44fd20=['Spanish','sale_return','Sale\x20Return','single','findById','diskStorage','5664554ibxxFi','Portuguese\x20(BR)','readFile','xlsx','customer','Sale','8Znsfmi','originalname','post','Workbook','flash','/view/:id','10267675cGcGsR','reason','address','send','1316qYMekW','\x20Failed','customer_docs','Arabic','findOne','map','/products_export_migrate_file','render','English','/view','47342EPaAfV','attachment;\x20filename=customer_Migration_File.xlsx','$amount','mobile','customer\x20add\x20successfully','exports','amount','receivable_sum','redirect','language','10Ucplpq','json','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Name','2872872NabdXa','PUnits','message','English\x20(US)','now','40uuyDhb','utils','French','contactperson','forEach','multer','error','element','customer_data','params','master','$reason','body','then','file','Content-Disposition','3465ySCzol','write','find','name','email','SalesmanName','exceljs','PName','/customer_import_migrate_file','payment_data','2023713ENOjEf','log','success','c_payments','Arabic\x20(ae)','addWorksheet','Customers','SalesmanCode','aggregate','express','1117510KvYzqj','Portuguese','Chinese','columns','Hindi','/view/payment/:id','get','user','save','status','German','setHeader','payable_sum','customer_product_fule','customer\x20update\x20successfully'];a0_0x487d=function(){return _0x44fd20;};return a0_0x487d();}router['post'](a0_0x41adad(0x142),auth,uploadMigrate[a0_0x41adad(0x160)](a0_0x41adad(0x15b)),async(_0x3a460d,_0x50a418)=>{const _0x1ed1d1=a0_0x41adad,_0x4b0a0c=_0x3a460d[_0x1ed1d1(0x138)]['filename'],_0x432730=await xlsx[_0x1ed1d1(0x165)]('public/Migration/'+_0x4b0a0c);let _0x588237=_0x432730['SheetNames'],_0xaeedc6=xlsx[_0x1ed1d1(0x12b)]['sheet_to_json'](_0x432730['Sheets'][_0x588237[0x0]]);for(const _0x305faa of _0xaeedc6){const _0x491792=_0x305faa['ID'],_0x16d946=_0x305faa[_0x1ed1d1(0x124)],_0x1a1d4b=_0x305faa['SalesmanCode'],_0x3dbe37=_0x305faa[_0x1ed1d1(0x13f)],_0x168d03=_0x305faa['address'],_0x421823=_0x305faa[_0x1ed1d1(0x180)],_0x525c22=_0x305faa[_0x1ed1d1(0x13e)];try{let _0x1e5c18=await customer[_0x1ed1d1(0x177)]({'name':_0x16d946});if(!_0x1e5c18){const _0x540a5c=new customer({'name':_0x16d946,'ID':_0x491792,'SalesmanCode':_0x1a1d4b,'SalesmanName':_0x3dbe37,'address':_0x168d03,'mobile':_0x421823,'email':_0x525c22});_0x1e5c18=await _0x540a5c[_0x1ed1d1(0x156)](),_0x3a460d['flash']('success',_0x16d946+'\x20added\x20successfully');}else _0x3a460d[_0x1ed1d1(0x16d)](_0x1ed1d1(0x130),_0x16d946+_0x1ed1d1(0x174));}catch(_0x105e0a){_0x50a418[_0x1ed1d1(0x157)](0x1f4)[_0x1ed1d1(0x188)]({'proderror':_0x105e0a[_0x1ed1d1(0x127)],'aproduct':ProductName});}}_0x50a418['redirect']('/customer/view');}),module[a0_0x41adad(0x182)]=router;