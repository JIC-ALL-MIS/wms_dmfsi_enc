const a0_0x344c60=a0_0x874d;(function(_0x13bd3a,_0x563d7c){const _0x160a55=a0_0x874d,_0x5ea90d=_0x13bd3a();while(!![]){try{const _0x957a44=-parseInt(_0x160a55(0xf9))/0x1+-parseInt(_0x160a55(0xef))/0x2*(parseInt(_0x160a55(0xfd))/0x3)+-parseInt(_0x160a55(0xd9))/0x4*(parseInt(_0x160a55(0x12b))/0x5)+-parseInt(_0x160a55(0x11f))/0x6+-parseInt(_0x160a55(0x11b))/0x7*(-parseInt(_0x160a55(0xd2))/0x8)+parseInt(_0x160a55(0x111))/0x9*(-parseInt(_0x160a55(0xdf))/0xa)+parseInt(_0x160a55(0x124))/0xb*(parseInt(_0x160a55(0x125))/0xc);if(_0x957a44===_0x563d7c)break;else _0x5ea90d['push'](_0x5ea90d['shift']());}catch(_0x2240f3){_0x5ea90d['push'](_0x5ea90d['shift']());}}}(a0_0x47fd,0x9cc81));const express=require(a0_0x344c60(0x122)),app=express(),router=express[a0_0x344c60(0xed)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x344c60(0x136)),auth=require(a0_0x344c60(0xd0)),users=require(a0_0x344c60(0x116)),excelJS=require(a0_0x344c60(0x117)),xlsx=require(a0_0x344c60(0x103)),multer=require(a0_0x344c60(0xe9));router[a0_0x344c60(0x100)](a0_0x344c60(0xf5),auth,async(_0x5b01c4,_0x24749c)=>{const _0x2e9c2e=a0_0x344c60;try{const {username:_0xaee12d,email:_0x3e8d94,role:_0x2af00e}=_0x5b01c4[_0x2e9c2e(0xdb)],_0x20c272=_0x5b01c4[_0x2e9c2e(0xdb)],_0x34b106=await profile[_0x2e9c2e(0x119)]({'email':_0x20c272[_0x2e9c2e(0xdd)]}),_0x3c4016=await master_shop[_0x2e9c2e(0x108)]();console['log'](_0x2e9c2e(0x10b),_0x3c4016);const _0x18aba9=await customer['find'](),_0x3580be=await customer[_0x2e9c2e(0x11e)]([{'$lookup':{'from':'c_payments','localField':'name','foreignField':_0x2e9c2e(0x115),'as':_0x2e9c2e(0x130)}}]);console[_0x2e9c2e(0x114)](_0x3580be);const _0x321783=_0x3580be[_0x2e9c2e(0xfb)](_0xd9aa24=>{const _0x431703=_0x2e9c2e;console[_0x431703(0x114)]('data',_0xd9aa24);var _0xcc6eda=0x0,_0x994d52=0x0;return _0xd9aa24[_0x431703(0x130)]['forEach'](_0x56a0a8=>{const _0x46c074=_0x431703;console[_0x46c074(0x114)](_0x46c074(0x109),_0x56a0a8),_0x56a0a8[_0x46c074(0x135)]==_0x46c074(0x12c)?_0xcc6eda+=_0x56a0a8[_0x46c074(0x10f)]:_0x994d52+=_0x56a0a8[_0x46c074(0x10f)];}),_0xd9aa24[_0x431703(0x13c)]=parseFloat(_0xcc6eda)+0x0,_0xd9aa24[_0x431703(0xe3)]=parseFloat(_0x994d52)+0x0,_0xd9aa24;});console[_0x2e9c2e(0x114)](_0x2e9c2e(0xd6),_0x321783);if(_0x3c4016[0x0]['language']==_0x2e9c2e(0xea)){var _0x1646dc=users['English'];console[_0x2e9c2e(0x114)](_0x1646dc);}else{if(_0x3c4016[0x0][_0x2e9c2e(0xec)]==_0x2e9c2e(0x106))var _0x1646dc=users[_0x2e9c2e(0x106)];else{if(_0x3c4016[0x0][_0x2e9c2e(0xec)]==_0x2e9c2e(0xe7))var _0x1646dc=users[_0x2e9c2e(0xe7)];else{if(_0x3c4016[0x0][_0x2e9c2e(0xec)]==_0x2e9c2e(0x101))var _0x1646dc=users[_0x2e9c2e(0x101)];else{if(_0x3c4016[0x0][_0x2e9c2e(0xec)]==_0x2e9c2e(0xf4))var _0x1646dc=users[_0x2e9c2e(0xf4)];else{if(_0x3c4016[0x0][_0x2e9c2e(0xec)]==_0x2e9c2e(0x128))var _0x1646dc=users[_0x2e9c2e(0xf6)];else{if(_0x3c4016[0x0]['language']==_0x2e9c2e(0x123))var _0x1646dc=users['Chinese'];else{if(_0x3c4016[0x0][_0x2e9c2e(0xec)]==_0x2e9c2e(0x11c))var _0x1646dc=users['Arabic'];}}}}}}}_0x24749c[_0x2e9c2e(0xe8)](_0x2e9c2e(0x115),{'success':_0x5b01c4[_0x2e9c2e(0xf7)](_0x2e9c2e(0xd8)),'errors':_0x5b01c4[_0x2e9c2e(0xf7)](_0x2e9c2e(0xf3)),'user':_0x18aba9,'role':_0x20c272,'profile':_0x34b106,'payment':_0x321783,'master_shop':_0x3c4016,'language':_0x1646dc});}catch(_0x2e2fa8){console[_0x2e9c2e(0x114)](_0x2e2fa8);}}),router[a0_0x344c60(0xde)](a0_0x344c60(0xf5),auth,async(_0x2fcd18,_0x27c43e)=>{const _0x4742f8=a0_0x344c60;try{const {name:_0x3bb444,address:_0x243a78,mobile:_0x3384e7,email:_0x13d345,receivable:_0x400c1f,payable:_0x56fb00,contactperson:_0x28feba,landline:_0x26152a}=_0x2fcd18['body'],_0x440b89=new customer({'name':_0x3bb444,'address':_0x243a78,'mobile':_0x3384e7,'email':_0x13d345,'receivable':_0x400c1f,'payable':_0x56fb00,'contactperson':_0x28feba,'landline':_0x26152a}),_0x4e2b24=await _0x440b89[_0x4742f8(0x137)]();_0x2fcd18[_0x4742f8(0xf7)](_0x4742f8(0xd8),_0x4742f8(0xff)),_0x27c43e['redirect'](_0x4742f8(0xe1));}catch(_0x1bb782){console[_0x4742f8(0x114)](_0x1bb782);}}),router[a0_0x344c60(0x100)]('/view/:id',auth,async(_0x50ecdd,_0xda361)=>{const _0xd467cf=a0_0x344c60;try{const {username:_0x324f16,email:_0x37c858,role:_0x21e572}=_0x50ecdd[_0xd467cf(0xdb)],_0x4e4bb0=_0x50ecdd[_0xd467cf(0xdb)],_0x42bcdf=await profile[_0xd467cf(0x119)]({'email':_0x4e4bb0[_0xd467cf(0xdd)]}),_0x203ec1=await master_shop[_0xd467cf(0x108)]();console[_0xd467cf(0x114)](_0xd467cf(0x10b),_0x203ec1);const _0x1106ee=_0x50ecdd[_0xd467cf(0x11a)]['id'],_0x5df0a8=await customer[_0xd467cf(0xfe)](_0x1106ee);if(_0x203ec1[0x0][_0xd467cf(0xec)]==_0xd467cf(0xea)){var _0x70e156=users['English'];console[_0xd467cf(0x114)](_0x70e156);}else{if(_0x203ec1[0x0][_0xd467cf(0xec)]=='Hindi')var _0x70e156=users[_0xd467cf(0x106)];else{if(_0x203ec1[0x0]['language']==_0xd467cf(0xe7))var _0x70e156=users[_0xd467cf(0xe7)];else{if(_0x203ec1[0x0][_0xd467cf(0xec)]==_0xd467cf(0x101))var _0x70e156=users[_0xd467cf(0x101)];else{if(_0x203ec1[0x0]['language']==_0xd467cf(0xf4))var _0x70e156=users[_0xd467cf(0xf4)];else{if(_0x203ec1[0x0][_0xd467cf(0xec)]=='Portuguese\x20(BR)')var _0x70e156=users[_0xd467cf(0xf6)];else{if(_0x203ec1[0x0][_0xd467cf(0xec)]=='Chinese')var _0x70e156=users[_0xd467cf(0x123)];else{if(_0x203ec1[0x0][_0xd467cf(0xec)]==_0xd467cf(0x11c))var _0x70e156=users[_0xd467cf(0xe6)];}}}}}}}_0xda361['render'](_0xd467cf(0x115),{'success':_0x50ecdd['flash'](_0xd467cf(0xd8)),'errors':_0x50ecdd[_0xd467cf(0xf7)](_0xd467cf(0xf3)),'role':_0x4e4bb0,'profile':_0x42bcdf,'user':_0x5df0a8,'master_shop':_0x203ec1,'language':_0x70e156});}catch(_0x40858c){console[_0xd467cf(0x114)](_0x40858c);}}),router[a0_0x344c60(0xde)](a0_0x344c60(0x102),auth,async(_0x245481,_0xe2aa86)=>{const _0x6141dd=a0_0x344c60;try{const _0x48fb75=_0x245481[_0x6141dd(0x11a)]['id'],_0x252212=await customer['findById'](_0x48fb75),{name:_0x3411ba,address:_0x354190,mobile:_0x2e84b9,email:_0x3724c2,receivable:_0x4bf078,payable:_0x35fbfc,contactperson:_0x4bf290,landline:_0x15a4a9}=_0x245481[_0x6141dd(0xf1)];_0x252212[_0x6141dd(0x107)]=_0x3411ba,_0x252212[_0x6141dd(0x12f)]=_0x354190,_0x252212[_0x6141dd(0xe0)]=_0x2e84b9,_0x252212[_0x6141dd(0xdd)]=_0x3724c2,_0x252212[_0x6141dd(0x133)]=_0x4bf078,_0x252212['payable']=_0x35fbfc,_0x252212[_0x6141dd(0x138)]=_0x4bf290,_0x252212[_0x6141dd(0xcf)]=_0x15a4a9;const _0x4a9db4=await _0x252212[_0x6141dd(0x137)]();_0x245481[_0x6141dd(0xf7)](_0x6141dd(0xd8),_0x6141dd(0xfa)),_0xe2aa86['redirect'](_0x6141dd(0xe1));}catch(_0x3c7934){console[_0x6141dd(0x114)](_0x3c7934);}}),router[a0_0x344c60(0x100)](a0_0x344c60(0xda),auth,async(_0x265df9,_0x2fd4e8)=>{const _0x2618fb=a0_0x344c60;try{const {username:_0xdf37e6,email:_0x5bcd7a,role:_0x55de26}=_0x265df9[_0x2618fb(0xdb)],_0x4516f6=_0x265df9[_0x2618fb(0xdb)],_0x429531=await profile['findOne']({'email':_0x4516f6['email']}),_0x5a5120=await master_shop['find']();console['log']('master',_0x5a5120),console[_0x2618fb(0x114)](_0x265df9['params']['id']);const _0x2f2f9a=await customer[_0x2618fb(0x119)]({'_id':_0x265df9[_0x2618fb(0x11a)]['id']});console['log'](_0x2618fb(0x126),_0x2f2f9a);const _0x5a7080=await c_payment_data['find']({'customer':_0x2f2f9a[_0x2618fb(0x107)]});console[_0x2618fb(0x114)](_0x5a7080);const _0x3e1536=await c_payment_data['aggregate']([{'$match':{'customer':_0x2f2f9a[_0x2618fb(0x107)]}},{'$match':{'reason':_0x2618fb(0x12c)}},{'$group':{'_id':_0x2618fb(0x112),'sum':{'$sum':'$amount'}}}]);console[_0x2618fb(0x114)](_0x2618fb(0xf2),_0x3e1536);const _0x46ca29=await c_payment_data[_0x2618fb(0x11e)]([{'$match':{'customer':_0x2f2f9a['name']}},{'$match':{'reason':_0x2618fb(0x12d)}},{'$group':{'_id':_0x2618fb(0x112),'sum':{'$sum':_0x2618fb(0xfc)}}}]);console[_0x2618fb(0x114)](_0x2618fb(0x127),_0x46ca29);if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0xea)){var _0x3b0564=users['English'];console[_0x2618fb(0x114)](_0x3b0564);}else{if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0x106))var _0x3b0564=users[_0x2618fb(0x106)];else{if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0xe7))var _0x3b0564=users['German'];else{if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0x101))var _0x3b0564=users[_0x2618fb(0x101)];else{if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0xf4))var _0x3b0564=users['French'];else{if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0x128))var _0x3b0564=users['Portuguese'];else{if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0x123))var _0x3b0564=users[_0x2618fb(0x123)];else{if(_0x5a5120[0x0][_0x2618fb(0xec)]==_0x2618fb(0x11c))var _0x3b0564=users['Arabic'];}}}}}}}_0x2fd4e8[_0x2618fb(0xe8)](_0x2618fb(0xd7),{'success':_0x265df9['flash']('success'),'errors':_0x265df9[_0x2618fb(0xf7)](_0x2618fb(0xf3)),'role':_0x4516f6,'profile':_0x429531,'payment':_0x5a7080,'payable':_0x3e1536,'receivable':_0x46ca29,'master_shop':_0x5a5120,'language':_0x3b0564});}catch(_0x2d6a59){console[_0x2618fb(0x114)](_0x2d6a59);}}),router[a0_0x344c60(0x100)](a0_0x344c60(0x118),auth,async(_0x35ff33,_0xc21650)=>{const _0x390abf=a0_0x344c60;try{const _0x5ecfda=new excelJS[(_0x390abf(0xd1))](),_0x237b03=_0x5ecfda[_0x390abf(0x139)](_0x390abf(0x12a));return _0x237b03[_0x390abf(0xd3)]=[{'header':'ID','key':_0x390abf(0x131),'width':0xa},{'header':_0x390abf(0x105),'key':_0x390abf(0xee),'width':0xa},{'header':_0x390abf(0x10c),'key':'PUnits','width':0xa},{'header':_0x390abf(0xf0),'key':_0x390abf(0xf0),'width':0xa},{'header':_0x390abf(0x12f),'key':'address','width':0xa},{'header':_0x390abf(0xe0),'key':_0x390abf(0xe0),'width':0xa},{'header':_0x390abf(0xdd),'key':_0x390abf(0xdd),'width':0xa}],_0xc21650[_0x390abf(0x104)](_0x390abf(0x10a),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0xc21650[_0x390abf(0x104)]('Content-Disposition','attachment;\x20filename=customer_Migration_File.xlsx'),_0x5ecfda['xlsx'][_0x390abf(0x121)](_0xc21650)[_0x390abf(0xdc)](()=>{const _0x44a977=_0x390abf;_0xc21650[_0x44a977(0x113)](0xc8);});}catch(_0x24c019){_0xc21650[_0x390abf(0x113)](0x190)[_0x390abf(0x132)]({'errors':_0x24c019[_0x390abf(0x10e)]});}});function a0_0x47fd(){const _0x57b44f=['log','customer','../public/language/languages.json','exceljs','/products_export_migrate_file','findOne','params','2437946udfPHv','Arabic\x20(ae)','/customer_import_migrate_file','aggregate','1872762PIcphU','\x20added\x20successfully','write','express','Chinese','451ujsjFw','752460osGjPE','customer_data','receivable_sum','Portuguese\x20(BR)','readFile','Customers','13645ojIMQE','Sale','Sale\x20Return','json','address','customer_docs','PName','send','receivable','customer_product_fule','reason','../models/all_models','save','contactperson','addWorksheet','error','Sheets','sale','landline','../middleware/auth','Workbook','16CRkHSk','columns','redirect','utils','payment_data','customer_payment','success','604RRTuPc','/view/payment/:id','user','then','email','post','14870rrVRJW','mobile','/customer/view','single','sale_return','filename','public/Migration/','Arabic','German','render','multer','English\x20(US)','SheetNames','language','Router','PBrands','773770QEaaKb','SalesmanName','body','payable_sum','errors','French','/view','Portuguese','flash','public/Migration','407600WVLyNb','customer\x20update\x20successfully','map','$amount','6pibkbR','findById','customer\x20add\x20successfully','get','Spanish','/view/:id','xlsx','setHeader','Name','Hindi','name','find','element','Content-Type','master','SalesmanCode','sheet_to_json','message','amount','now','4356xUUbKy','$reason','status'];a0_0x47fd=function(){return _0x57b44f;};return a0_0x47fd();}const storage1=multer['diskStorage']({'destination':(_0x2a1879,_0x2fa812,_0x3be606)=>{const _0x1e1568=a0_0x344c60;_0x3be606(null,_0x1e1568(0xf8));},'filename':(_0x5169ae,_0x2cfe9d,_0x4fd234)=>{const _0x1b8bd5=a0_0x344c60;_0x4fd234(null,Date[_0x1b8bd5(0x110)]()+_0x2cfe9d['originalname']);}}),uploadMigrate=multer({'storage':storage1});function a0_0x874d(_0x1b3d3c,_0x13b360){const _0x47fd5b=a0_0x47fd();return a0_0x874d=function(_0x874dde,_0xee9c76){_0x874dde=_0x874dde-0xcf;let _0x25092f=_0x47fd5b[_0x874dde];return _0x25092f;},a0_0x874d(_0x1b3d3c,_0x13b360);}router[a0_0x344c60(0xde)](a0_0x344c60(0x11d),auth,uploadMigrate[a0_0x344c60(0xe2)](a0_0x344c60(0x134)),async(_0x422f06,_0x2f2228)=>{const _0x1d17f9=a0_0x344c60,_0x32ef22=_0x422f06['file'][_0x1d17f9(0xe4)],_0x34cb15=await xlsx[_0x1d17f9(0x129)](_0x1d17f9(0xe5)+_0x32ef22);let _0x1292a0=_0x34cb15[_0x1d17f9(0xeb)],_0x145a94=xlsx[_0x1d17f9(0xd5)][_0x1d17f9(0x10d)](_0x34cb15[_0x1d17f9(0x13b)][_0x1292a0[0x0]]);for(const _0x311230 of _0x145a94){const _0x22a952=_0x311230['ID'],_0x5b1850=_0x311230[_0x1d17f9(0x105)],_0x3bba7c=_0x311230[_0x1d17f9(0x10c)],_0x3a0ac1=_0x311230['SalesmanName'],_0x26004f=_0x311230[_0x1d17f9(0x12f)],_0x173fb7=_0x311230[_0x1d17f9(0xe0)],_0xc87a7c=_0x311230[_0x1d17f9(0xdd)];try{let _0x2a2087=await customer[_0x1d17f9(0x119)]({'name':_0x5b1850});if(!_0x2a2087){const _0x1be430=new customer({'name':_0x5b1850,'ID':_0x22a952,'SalesmanCode':_0x3bba7c,'SalesmanName':_0x3a0ac1,'address':_0x26004f,'mobile':_0x173fb7,'email':_0xc87a7c});_0x2a2087=await _0x1be430[_0x1d17f9(0x137)](),_0x422f06['flash'](_0x1d17f9(0xd8),_0x5b1850+_0x1d17f9(0x120));}else _0x422f06[_0x1d17f9(0xf7)](_0x1d17f9(0x13a),_0x5b1850+'\x20Failed');}catch(_0x47f4ca){_0x2f2228[_0x1d17f9(0x113)](0x1f4)[_0x1d17f9(0x12e)]({'proderror':_0x47f4ca[_0x1d17f9(0x10e)],'aproduct':ProductName});}}_0x2f2228[_0x1d17f9(0xd4)](_0x1d17f9(0xe1));}),module['exports']=router;