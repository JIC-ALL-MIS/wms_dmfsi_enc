const a0_0x522b62=a0_0x2c6d;function a0_0x2c6d(_0x1eb6b0,_0x3df602){const _0x41a6db=a0_0x41a6();return a0_0x2c6d=function(_0x2c6dac,_0x3378fb){_0x2c6dac=_0x2c6dac-0x1b1;let _0x40c58e=_0x41a6db[_0x2c6dac];return _0x40c58e;},a0_0x2c6d(_0x1eb6b0,_0x3df602);}(function(_0x45c063,_0x24fb59){const _0x4cdb95=a0_0x2c6d,_0x1762cd=_0x45c063();while(!![]){try{const _0x21e7a0=-parseInt(_0x4cdb95(0x20d))/0x1+-parseInt(_0x4cdb95(0x1fc))/0x2+parseInt(_0x4cdb95(0x1bb))/0x3+parseInt(_0x4cdb95(0x1ba))/0x4*(-parseInt(_0x4cdb95(0x1c7))/0x5)+parseInt(_0x4cdb95(0x214))/0x6*(-parseInt(_0x4cdb95(0x1e8))/0x7)+parseInt(_0x4cdb95(0x1c6))/0x8*(parseInt(_0x4cdb95(0x1c0))/0x9)+parseInt(_0x4cdb95(0x215))/0xa;if(_0x21e7a0===_0x24fb59)break;else _0x1762cd['push'](_0x1762cd['shift']());}catch(_0x331262){_0x1762cd['push'](_0x1762cd['shift']());}}}(a0_0x41a6,0x89cf8));const express=require(a0_0x522b62(0x1e6)),app=express(),router=express[a0_0x522b62(0x212)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require(a0_0x522b62(0x203)),users=require(a0_0x522b62(0x1d6)),excelJS=require('exceljs'),xlsx=require(a0_0x522b62(0x1b4)),multer=require(a0_0x522b62(0x20c));function a0_0x41a6(){const _0x1c983b=['\x20added\x20successfully','landline','Customers','write','single','Workbook','save','../public/language/languages.json','customer_docs','file','sheet_to_json','status','mobile','send','public/Migration/','German','PUnits','language','findById','columns','flash','Name','Chinese','express','customer\x20add\x20successfully','128296MfBHVf','attachment;\x20filename=customer_Migration_File.xlsx','find','email','customer','/customer/view','payment_data','log','params','customer_payment','message','Portuguese\x20(BR)','user','payable_sum','English','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','Hindi','redirect','json','payable','688392esBxsY','$amount','filename','data','SalesmanCode','Arabic\x20(ae)','body','../middleware/auth','name','reason','Portuguese','Content-Disposition','Sale','findOne','render','Sale\x20Return','multer','824225LDASlO','public/Migration','post','customer_product_fule','/view/:id','Router','element','264zVExKN','14472530YKsIoM','c_payments','setHeader','amount','customer_data','receivable','Content-Type','receivable_sum','Arabic','errors','sale','utils','customer\x20update\x20successfully','xlsx','SalesmanName','English\x20(US)','master','sale_return','/view','3938164CgnZGw','3297168yTsZCE','map','then','aggregate','success','24507OcGzWs','exports','Spanish','get','SheetNames','diskStorage','2872GNuDwg','5zPGYuo','forEach','Sheets','French','readFile','/products_export_migrate_file','address','addWorksheet'];a0_0x41a6=function(){return _0x1c983b;};return a0_0x41a6();}router[a0_0x522b62(0x1c3)](a0_0x522b62(0x1b9),auth,async(_0x6bf115,_0x55b184)=>{const _0x4b59b7=a0_0x522b62;try{const {username:_0x3476a6,email:_0x286710,role:_0x4047ea}=_0x6bf115['user'],_0xff1893=_0x6bf115[_0x4b59b7(0x1f4)],_0x5336aa=await profile[_0x4b59b7(0x209)]({'email':_0xff1893[_0x4b59b7(0x1eb)]}),_0x1931c3=await master_shop['find']();console['log'](_0x4b59b7(0x1b7),_0x1931c3);const _0x99f486=await customer[_0x4b59b7(0x1ea)](),_0x55dc0b=await customer[_0x4b59b7(0x1be)]([{'$lookup':{'from':_0x4b59b7(0x216),'localField':_0x4b59b7(0x204),'foreignField':'customer','as':_0x4b59b7(0x1d7)}}]);console[_0x4b59b7(0x1ef)](_0x55dc0b);const _0x5e8942=_0x55dc0b[_0x4b59b7(0x1bc)](_0x1e432e=>{const _0xf3bb82=_0x4b59b7;console[_0xf3bb82(0x1ef)](_0xf3bb82(0x1ff),_0x1e432e);var _0x408f55=0x0,_0x58af7b=0x0;return _0x1e432e['customer_docs'][_0xf3bb82(0x1c8)](_0x4aea70=>{const _0x16509b=_0xf3bb82;console['log'](_0x16509b(0x213),_0x4aea70),_0x4aea70[_0x16509b(0x205)]=='Sale'?_0x408f55+=_0x4aea70['amount']:_0x58af7b+=_0x4aea70[_0x16509b(0x218)];}),_0x1e432e[_0xf3bb82(0x1b1)]=parseFloat(_0x408f55)+0x0,_0x1e432e[_0xf3bb82(0x1b8)]=parseFloat(_0x58af7b)+0x0,_0x1e432e;});console[_0x4b59b7(0x1ef)](_0x4b59b7(0x1ee),_0x5e8942);if(_0x1931c3[0x0][_0x4b59b7(0x1e0)]==_0x4b59b7(0x1b6)){var _0x5e1a21=users[_0x4b59b7(0x1f6)];console[_0x4b59b7(0x1ef)](_0x5e1a21);}else{if(_0x1931c3[0x0][_0x4b59b7(0x1e0)]=='Hindi')var _0x5e1a21=users[_0x4b59b7(0x1f8)];else{if(_0x1931c3[0x0][_0x4b59b7(0x1e0)]=='German')var _0x5e1a21=users[_0x4b59b7(0x1de)];else{if(_0x1931c3[0x0][_0x4b59b7(0x1e0)]==_0x4b59b7(0x1c2))var _0x5e1a21=users[_0x4b59b7(0x1c2)];else{if(_0x1931c3[0x0][_0x4b59b7(0x1e0)]==_0x4b59b7(0x1ca))var _0x5e1a21=users['French'];else{if(_0x1931c3[0x0][_0x4b59b7(0x1e0)]==_0x4b59b7(0x1f3))var _0x5e1a21=users[_0x4b59b7(0x206)];else{if(_0x1931c3[0x0]['language']==_0x4b59b7(0x1e5))var _0x5e1a21=users[_0x4b59b7(0x1e5)];else{if(_0x1931c3[0x0][_0x4b59b7(0x1e0)]=='Arabic\x20(ae)')var _0x5e1a21=users[_0x4b59b7(0x21d)];}}}}}}}_0x55b184['render']('customer',{'success':_0x6bf115[_0x4b59b7(0x1e3)](_0x4b59b7(0x1bf)),'errors':_0x6bf115[_0x4b59b7(0x1e3)](_0x4b59b7(0x21e)),'user':_0x99f486,'role':_0xff1893,'profile':_0x5336aa,'payment':_0x5e8942,'master_shop':_0x1931c3,'language':_0x5e1a21});}catch(_0x59b788){console[_0x4b59b7(0x1ef)](_0x59b788);}}),router['post'](a0_0x522b62(0x1b9),auth,async(_0x1c2357,_0xa0b0e2)=>{const _0x256e1b=a0_0x522b62;try{const {name:_0x5ce090,address:_0x3e8f53,mobile:_0x23eb2a,email:_0x59c792,receivable:_0x1f4479,payable:_0x487825,contactperson:_0x1d8224,landline:_0x54d19b}=_0x1c2357[_0x256e1b(0x202)],_0x43aee3=new customer({'name':_0x5ce090,'address':_0x3e8f53,'mobile':_0x23eb2a,'email':_0x59c792,'receivable':_0x1f4479,'payable':_0x487825,'contactperson':_0x1d8224,'landline':_0x54d19b}),_0x57a386=await _0x43aee3['save']();_0x1c2357[_0x256e1b(0x1e3)](_0x256e1b(0x1bf),_0x256e1b(0x1e7)),_0xa0b0e2[_0x256e1b(0x1f9)]('/customer/view');}catch(_0x3b11fe){console['log'](_0x3b11fe);}}),router[a0_0x522b62(0x1c3)](a0_0x522b62(0x211),auth,async(_0x42c61f,_0x32b331)=>{const _0x5ef54f=a0_0x522b62;try{const {username:_0x26a024,email:_0x1675e4,role:_0x2666c8}=_0x42c61f[_0x5ef54f(0x1f4)],_0x36a16f=_0x42c61f[_0x5ef54f(0x1f4)],_0x110f49=await profile[_0x5ef54f(0x209)]({'email':_0x36a16f[_0x5ef54f(0x1eb)]}),_0x13c98c=await master_shop[_0x5ef54f(0x1ea)]();console['log'](_0x5ef54f(0x1b7),_0x13c98c);const _0x14d667=_0x42c61f[_0x5ef54f(0x1f0)]['id'],_0x3a17cd=await customer['findById'](_0x14d667);if(_0x13c98c[0x0][_0x5ef54f(0x1e0)]==_0x5ef54f(0x1b6)){var _0x58017b=users[_0x5ef54f(0x1f6)];console['log'](_0x58017b);}else{if(_0x13c98c[0x0][_0x5ef54f(0x1e0)]==_0x5ef54f(0x1f8))var _0x58017b=users[_0x5ef54f(0x1f8)];else{if(_0x13c98c[0x0]['language']==_0x5ef54f(0x1de))var _0x58017b=users[_0x5ef54f(0x1de)];else{if(_0x13c98c[0x0][_0x5ef54f(0x1e0)]==_0x5ef54f(0x1c2))var _0x58017b=users[_0x5ef54f(0x1c2)];else{if(_0x13c98c[0x0][_0x5ef54f(0x1e0)]==_0x5ef54f(0x1ca))var _0x58017b=users[_0x5ef54f(0x1ca)];else{if(_0x13c98c[0x0]['language']=='Portuguese\x20(BR)')var _0x58017b=users[_0x5ef54f(0x206)];else{if(_0x13c98c[0x0][_0x5ef54f(0x1e0)]=='Chinese')var _0x58017b=users[_0x5ef54f(0x1e5)];else{if(_0x13c98c[0x0][_0x5ef54f(0x1e0)]==_0x5ef54f(0x201))var _0x58017b=users[_0x5ef54f(0x21d)];}}}}}}}_0x32b331[_0x5ef54f(0x20a)](_0x5ef54f(0x1ec),{'success':_0x42c61f[_0x5ef54f(0x1e3)](_0x5ef54f(0x1bf)),'errors':_0x42c61f[_0x5ef54f(0x1e3)]('errors'),'role':_0x36a16f,'profile':_0x110f49,'user':_0x3a17cd,'master_shop':_0x13c98c,'language':_0x58017b});}catch(_0x2cbd04){console[_0x5ef54f(0x1ef)](_0x2cbd04);}}),router[a0_0x522b62(0x20f)]('/view/:id',auth,async(_0x36609b,_0x4146c3)=>{const _0x19970e=a0_0x522b62;try{const _0x570cdd=_0x36609b[_0x19970e(0x1f0)]['id'],_0x244146=await customer[_0x19970e(0x1e1)](_0x570cdd),{name:_0x46a798,address:_0x26d5e9,mobile:_0x18b4ac,email:_0x13b881,receivable:_0x2a98c1,payable:_0x364998,contactperson:_0x51547a,landline:_0x5322ac}=_0x36609b[_0x19970e(0x202)];_0x244146[_0x19970e(0x204)]=_0x46a798,_0x244146[_0x19970e(0x1cd)]=_0x26d5e9,_0x244146[_0x19970e(0x1db)]=_0x18b4ac,_0x244146[_0x19970e(0x1eb)]=_0x13b881,_0x244146[_0x19970e(0x21a)]=_0x2a98c1,_0x244146[_0x19970e(0x1fb)]=_0x364998,_0x244146['contactperson']=_0x51547a,_0x244146[_0x19970e(0x1d0)]=_0x5322ac;const _0x219cca=await _0x244146[_0x19970e(0x1d5)]();_0x36609b[_0x19970e(0x1e3)](_0x19970e(0x1bf),_0x19970e(0x1b3)),_0x4146c3[_0x19970e(0x1f9)](_0x19970e(0x1ed));}catch(_0x4d6c5d){console['log'](_0x4d6c5d);}}),router[a0_0x522b62(0x1c3)]('/view/payment/:id',auth,async(_0x1bd874,_0x354067)=>{const _0x30d034=a0_0x522b62;try{const {username:_0x51f731,email:_0x4ae31e,role:_0x34fe69}=_0x1bd874[_0x30d034(0x1f4)],_0x4a2e34=_0x1bd874[_0x30d034(0x1f4)],_0x357108=await profile[_0x30d034(0x209)]({'email':_0x4a2e34[_0x30d034(0x1eb)]}),_0x35f72f=await master_shop[_0x30d034(0x1ea)]();console[_0x30d034(0x1ef)](_0x30d034(0x1b7),_0x35f72f),console[_0x30d034(0x1ef)](_0x1bd874[_0x30d034(0x1f0)]['id']);const _0x2f8942=await customer[_0x30d034(0x209)]({'_id':_0x1bd874['params']['id']});console['log'](_0x30d034(0x219),_0x2f8942);const _0x19ad2d=await c_payment_data[_0x30d034(0x1ea)]({'customer':_0x2f8942['name']});console[_0x30d034(0x1ef)](_0x19ad2d);const _0x423a9d=await c_payment_data[_0x30d034(0x1be)]([{'$match':{'customer':_0x2f8942[_0x30d034(0x204)]}},{'$match':{'reason':_0x30d034(0x208)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x30d034(0x1fd)}}}]);console[_0x30d034(0x1ef)](_0x30d034(0x1f5),_0x423a9d);const _0x46b554=await c_payment_data[_0x30d034(0x1be)]([{'$match':{'customer':_0x2f8942['name']}},{'$match':{'reason':_0x30d034(0x20b)}},{'$group':{'_id':'$reason','sum':{'$sum':'$amount'}}}]);console[_0x30d034(0x1ef)](_0x30d034(0x21c),_0x46b554);if(_0x35f72f[0x0][_0x30d034(0x1e0)]==_0x30d034(0x1b6)){var _0x1b775d=users[_0x30d034(0x1f6)];console[_0x30d034(0x1ef)](_0x1b775d);}else{if(_0x35f72f[0x0][_0x30d034(0x1e0)]==_0x30d034(0x1f8))var _0x1b775d=users[_0x30d034(0x1f8)];else{if(_0x35f72f[0x0]['language']==_0x30d034(0x1de))var _0x1b775d=users[_0x30d034(0x1de)];else{if(_0x35f72f[0x0]['language']==_0x30d034(0x1c2))var _0x1b775d=users[_0x30d034(0x1c2)];else{if(_0x35f72f[0x0]['language']=='French')var _0x1b775d=users['French'];else{if(_0x35f72f[0x0][_0x30d034(0x1e0)]==_0x30d034(0x1f3))var _0x1b775d=users[_0x30d034(0x206)];else{if(_0x35f72f[0x0][_0x30d034(0x1e0)]=='Chinese')var _0x1b775d=users[_0x30d034(0x1e5)];else{if(_0x35f72f[0x0][_0x30d034(0x1e0)]=='Arabic\x20(ae)')var _0x1b775d=users['Arabic'];}}}}}}}_0x354067['render'](_0x30d034(0x1f1),{'success':_0x1bd874[_0x30d034(0x1e3)]('success'),'errors':_0x1bd874[_0x30d034(0x1e3)]('errors'),'role':_0x4a2e34,'profile':_0x357108,'payment':_0x19ad2d,'payable':_0x423a9d,'receivable':_0x46b554,'master_shop':_0x35f72f,'language':_0x1b775d});}catch(_0x9fa6d6){console[_0x30d034(0x1ef)](_0x9fa6d6);}}),router['get'](a0_0x522b62(0x1cc),auth,async(_0x236c5e,_0x191336)=>{const _0x2c300c=a0_0x522b62;try{const _0x410816=new excelJS[(_0x2c300c(0x1d4))](),_0x59deee=_0x410816[_0x2c300c(0x1ce)](_0x2c300c(0x1d1));return _0x59deee[_0x2c300c(0x1e2)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x2c300c(0x1e4),'key':'PBrands','width':0xa},{'header':_0x2c300c(0x200),'key':_0x2c300c(0x1df),'width':0xa},{'header':_0x2c300c(0x1b5),'key':_0x2c300c(0x1b5),'width':0xa},{'header':_0x2c300c(0x1cd),'key':_0x2c300c(0x1cd),'width':0xa},{'header':_0x2c300c(0x1db),'key':_0x2c300c(0x1db),'width':0xa},{'header':_0x2c300c(0x1eb),'key':_0x2c300c(0x1eb),'width':0xa}],_0x191336['setHeader'](_0x2c300c(0x21b),_0x2c300c(0x1f7)),_0x191336[_0x2c300c(0x217)](_0x2c300c(0x207),_0x2c300c(0x1e9)),_0x410816[_0x2c300c(0x1b4)][_0x2c300c(0x1d2)](_0x191336)[_0x2c300c(0x1bd)](()=>{const _0x24f0d8=_0x2c300c;_0x191336[_0x24f0d8(0x1da)](0xc8);});}catch(_0x2dd7bc){_0x191336['status'](0x190)[_0x2c300c(0x1dc)]({'errors':_0x2dd7bc[_0x2c300c(0x1f2)]});}});const storage1=multer[a0_0x522b62(0x1c5)]({'destination':(_0x4656a4,_0x39a955,_0x2217cd)=>{const _0x30ac1c=a0_0x522b62;_0x2217cd(null,_0x30ac1c(0x20e));},'filename':(_0xf6852f,_0x4d2273,_0x7d8148)=>{_0x7d8148(null,Date['now']()+_0x4d2273['originalname']);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x522b62(0x20f)]('/customer_import_migrate_file',auth,uploadMigrate[a0_0x522b62(0x1d3)](a0_0x522b62(0x210)),async(_0x1e4813,_0x4272e7)=>{const _0x17a058=a0_0x522b62,_0x30cb4f=_0x1e4813[_0x17a058(0x1d8)][_0x17a058(0x1fe)],_0x1073e0=await xlsx[_0x17a058(0x1cb)](_0x17a058(0x1dd)+_0x30cb4f);let _0x45ab84=_0x1073e0[_0x17a058(0x1c4)],_0x19de7b=xlsx[_0x17a058(0x1b2)][_0x17a058(0x1d9)](_0x1073e0[_0x17a058(0x1c9)][_0x45ab84[0x0]]);for(const _0x1daff7 of _0x19de7b){const _0x4242f7=_0x1daff7['ID'],_0x3e4f74=_0x1daff7[_0x17a058(0x1e4)],_0x5360e9=_0x1daff7[_0x17a058(0x200)],_0x43ace6=_0x1daff7[_0x17a058(0x1b5)],_0x114c7e=_0x1daff7['address'],_0x485ac7=_0x1daff7[_0x17a058(0x1db)],_0x4494d2=_0x1daff7[_0x17a058(0x1eb)];try{let _0x1fcf33=await customer[_0x17a058(0x209)]({'name':_0x3e4f74});if(!_0x1fcf33){const _0x2d7076=new customer({'name':_0x3e4f74,'ID':_0x4242f7,'SalesmanCode':_0x5360e9,'SalesmanName':_0x43ace6,'address':_0x114c7e,'mobile':_0x485ac7,'email':_0x4494d2});_0x1fcf33=await _0x2d7076['save'](),_0x1e4813[_0x17a058(0x1e3)](_0x17a058(0x1bf),_0x3e4f74+_0x17a058(0x1cf));}else _0x1e4813[_0x17a058(0x1e3)]('error',_0x3e4f74+'\x20Failed');}catch(_0x5c0211){_0x4272e7[_0x17a058(0x1da)](0x1f4)[_0x17a058(0x1fa)]({'proderror':_0x5c0211[_0x17a058(0x1f2)],'aproduct':ProductName});}}_0x4272e7[_0x17a058(0x1f9)]('/customer/view');}),module[a0_0x522b62(0x1c1)]=router;