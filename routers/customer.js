function a0_0x13b9(_0x5d837c,_0x46af76){const _0x252fb0=a0_0x252f();return a0_0x13b9=function(_0x13b918,_0x205293){_0x13b918=_0x13b918-0x126;let _0x3f11c7=_0x252fb0[_0x13b918];return _0x3f11c7;},a0_0x13b9(_0x5d837c,_0x46af76);}const a0_0x3c3352=a0_0x13b9;(function(_0x663cf2,_0x153616){const _0x3c9783=a0_0x13b9,_0x46c9a0=_0x663cf2();while(!![]){try{const _0x38a099=-parseInt(_0x3c9783(0x140))/0x1*(parseInt(_0x3c9783(0x18b))/0x2)+parseInt(_0x3c9783(0x130))/0x3+-parseInt(_0x3c9783(0x18a))/0x4*(parseInt(_0x3c9783(0x151))/0x5)+-parseInt(_0x3c9783(0x12d))/0x6+-parseInt(_0x3c9783(0x186))/0x7+-parseInt(_0x3c9783(0x18c))/0x8*(parseInt(_0x3c9783(0x190))/0x9)+-parseInt(_0x3c9783(0x170))/0xa*(-parseInt(_0x3c9783(0x16d))/0xb);if(_0x38a099===_0x153616)break;else _0x46c9a0['push'](_0x46c9a0['shift']());}catch(_0x17e70d){_0x46c9a0['push'](_0x46c9a0['shift']());}}}(a0_0x252f,0x8ac59));function a0_0x252f(){const _0x43a531=['payable','1858545JTTttG','customer','Customers','../middleware/auth','exceljs','/view/:id','findById','Chinese','name','params','SheetNames','payable_sum','filename','data','SalesmanName','json','22905HkUiyB','message','reason','customer_data','../models/all_models','render','attachment;\x20filename=customer_Migration_File.xlsx','Portuguese','English\x20(US)','originalname','post','Portuguese\x20(BR)','master','error','public/Migration/','success','PBrands','44935xMVGgt','payment_data','address','\x20Failed','flash','Sheets','save','body','contactperson','/view','file','xlsx','Content-Type','express','\x20added\x20successfully','Content-Disposition','/customer_import_migrate_file','customer\x20update\x20successfully','language','English','map','PUnits','write','customer\x20add\x20successfully','find','send','/view/payment/:id','user','11VZSaib','Arabic','redirect','20585860aGTqVW','Workbook','then','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','sale_return','Arabic\x20(ae)','Spanish','$reason','$amount','log','receivable_sum','public/Migration','columns','sheet_to_json','German','findOne','customer_docs','multer','aggregate','customer_product_fule','French','Hindi','108913RhBVxp','SalesmanCode','amount','exports','204RwHoxf','40IINxpZ','8EUiPma','Router','get','Sale\x20Return','9336204aiWJTU','c_payments','errors','email','customer_payment','forEach','Name','mobile','/customer/view','842040WHMjRa','Sale'];a0_0x252f=function(){return _0x43a531;};return a0_0x252f();}const express=require(a0_0x3c3352(0x15e)),app=express(),router=express[a0_0x3c3352(0x18d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x3c3352(0x144)),auth=require(a0_0x3c3352(0x133)),users=require('../public/language/languages.json'),excelJS=require(a0_0x3c3352(0x134)),xlsx=require(a0_0x3c3352(0x15c)),multer=require(a0_0x3c3352(0x181));router[a0_0x3c3352(0x18e)](a0_0x3c3352(0x15a),auth,async(_0x531652,_0x4f6231)=>{const _0x4a4d4f=a0_0x3c3352;try{const {username:_0x82f27,email:_0x1c0324,role:_0x5d895b}=_0x531652[_0x4a4d4f(0x16c)],_0xa1edda=_0x531652[_0x4a4d4f(0x16c)],_0x380759=await profile[_0x4a4d4f(0x17f)]({'email':_0xa1edda[_0x4a4d4f(0x127)]}),_0x215806=await master_shop[_0x4a4d4f(0x169)]();console[_0x4a4d4f(0x179)]('master',_0x215806);const _0x1d9f5c=await customer[_0x4a4d4f(0x169)](),_0x4ff1ea=await customer[_0x4a4d4f(0x182)]([{'$lookup':{'from':_0x4a4d4f(0x191),'localField':_0x4a4d4f(0x138),'foreignField':_0x4a4d4f(0x131),'as':_0x4a4d4f(0x180)}}]);console[_0x4a4d4f(0x179)](_0x4ff1ea);const _0x36b02b=_0x4ff1ea[_0x4a4d4f(0x165)](_0xccb4bc=>{const _0x4dbc46=_0x4a4d4f;console[_0x4dbc46(0x179)](_0x4dbc46(0x13d),_0xccb4bc);var _0x2a6a1a=0x0,_0x4f6434=0x0;return _0xccb4bc['customer_docs'][_0x4dbc46(0x129)](_0x2feff5=>{const _0x2cd34f=_0x4dbc46;console[_0x2cd34f(0x179)]('element',_0x2feff5),_0x2feff5[_0x2cd34f(0x142)]=='Sale'?_0x2a6a1a+=_0x2feff5[_0x2cd34f(0x188)]:_0x4f6434+=_0x2feff5[_0x2cd34f(0x188)];}),_0xccb4bc['sale']=parseFloat(_0x2a6a1a)+0x0,_0xccb4bc[_0x4dbc46(0x174)]=parseFloat(_0x4f6434)+0x0,_0xccb4bc;});console[_0x4a4d4f(0x179)](_0x4a4d4f(0x152),_0x36b02b);if(_0x215806[0x0][_0x4a4d4f(0x163)]==_0x4a4d4f(0x148)){var _0x57d4a0=users[_0x4a4d4f(0x164)];console['log'](_0x57d4a0);}else{if(_0x215806[0x0][_0x4a4d4f(0x163)]=='Hindi')var _0x57d4a0=users[_0x4a4d4f(0x185)];else{if(_0x215806[0x0][_0x4a4d4f(0x163)]==_0x4a4d4f(0x17e))var _0x57d4a0=users[_0x4a4d4f(0x17e)];else{if(_0x215806[0x0]['language']==_0x4a4d4f(0x176))var _0x57d4a0=users[_0x4a4d4f(0x176)];else{if(_0x215806[0x0][_0x4a4d4f(0x163)]=='French')var _0x57d4a0=users['French'];else{if(_0x215806[0x0]['language']==_0x4a4d4f(0x14b))var _0x57d4a0=users[_0x4a4d4f(0x147)];else{if(_0x215806[0x0][_0x4a4d4f(0x163)]==_0x4a4d4f(0x137))var _0x57d4a0=users['Chinese'];else{if(_0x215806[0x0][_0x4a4d4f(0x163)]==_0x4a4d4f(0x175))var _0x57d4a0=users[_0x4a4d4f(0x16e)];}}}}}}}_0x4f6231[_0x4a4d4f(0x145)]('customer',{'success':_0x531652['flash'](_0x4a4d4f(0x14f)),'errors':_0x531652['flash'](_0x4a4d4f(0x126)),'user':_0x1d9f5c,'role':_0xa1edda,'profile':_0x380759,'payment':_0x36b02b,'master_shop':_0x215806,'language':_0x57d4a0});}catch(_0x31fce7){console['log'](_0x31fce7);}}),router['post'](a0_0x3c3352(0x15a),auth,async(_0x288218,_0x34b5c1)=>{const _0x3b9112=a0_0x3c3352;try{const {name:_0x181db6,address:_0x4ac942,mobile:_0x217c30,email:_0x15fbb6,receivable:_0x426abf,payable:_0x5ebd6f,contactperson:_0x58961f,landline:_0x4bf284}=_0x288218[_0x3b9112(0x158)],_0x58dbd4=new customer({'name':_0x181db6,'address':_0x4ac942,'mobile':_0x217c30,'email':_0x15fbb6,'receivable':_0x426abf,'payable':_0x5ebd6f,'contactperson':_0x58961f,'landline':_0x4bf284}),_0x56e92f=await _0x58dbd4[_0x3b9112(0x157)]();_0x288218[_0x3b9112(0x155)](_0x3b9112(0x14f),_0x3b9112(0x168)),_0x34b5c1[_0x3b9112(0x16f)](_0x3b9112(0x12c));}catch(_0x1d8989){console['log'](_0x1d8989);}}),router[a0_0x3c3352(0x18e)](a0_0x3c3352(0x135),auth,async(_0x5a9835,_0x487df8)=>{const _0x2c97ed=a0_0x3c3352;try{const {username:_0x3edf63,email:_0x290179,role:_0x15aa90}=_0x5a9835[_0x2c97ed(0x16c)],_0x2f89d3=_0x5a9835[_0x2c97ed(0x16c)],_0x39863e=await profile['findOne']({'email':_0x2f89d3['email']}),_0x5f50bd=await master_shop[_0x2c97ed(0x169)]();console['log']('master',_0x5f50bd);const _0x3801a7=_0x5a9835[_0x2c97ed(0x139)]['id'],_0x39494c=await customer[_0x2c97ed(0x136)](_0x3801a7);if(_0x5f50bd[0x0][_0x2c97ed(0x163)]==_0x2c97ed(0x148)){var _0x1d0652=users[_0x2c97ed(0x164)];console['log'](_0x1d0652);}else{if(_0x5f50bd[0x0]['language']==_0x2c97ed(0x185))var _0x1d0652=users[_0x2c97ed(0x185)];else{if(_0x5f50bd[0x0]['language']==_0x2c97ed(0x17e))var _0x1d0652=users[_0x2c97ed(0x17e)];else{if(_0x5f50bd[0x0][_0x2c97ed(0x163)]==_0x2c97ed(0x176))var _0x1d0652=users[_0x2c97ed(0x176)];else{if(_0x5f50bd[0x0]['language']==_0x2c97ed(0x184))var _0x1d0652=users[_0x2c97ed(0x184)];else{if(_0x5f50bd[0x0][_0x2c97ed(0x163)]==_0x2c97ed(0x14b))var _0x1d0652=users[_0x2c97ed(0x147)];else{if(_0x5f50bd[0x0][_0x2c97ed(0x163)]==_0x2c97ed(0x137))var _0x1d0652=users['Chinese'];else{if(_0x5f50bd[0x0][_0x2c97ed(0x163)]==_0x2c97ed(0x175))var _0x1d0652=users[_0x2c97ed(0x16e)];}}}}}}}_0x487df8['render'](_0x2c97ed(0x131),{'success':_0x5a9835[_0x2c97ed(0x155)]('success'),'errors':_0x5a9835[_0x2c97ed(0x155)](_0x2c97ed(0x126)),'role':_0x2f89d3,'profile':_0x39863e,'user':_0x39494c,'master_shop':_0x5f50bd,'language':_0x1d0652});}catch(_0x1a4984){console['log'](_0x1a4984);}}),router[a0_0x3c3352(0x14a)]('/view/:id',auth,async(_0x690d3c,_0x31b41f)=>{const _0x4b9f92=a0_0x3c3352;try{const _0x26ac1e=_0x690d3c[_0x4b9f92(0x139)]['id'],_0x133a92=await customer[_0x4b9f92(0x136)](_0x26ac1e),{name:_0x5ad0be,address:_0x40a0ac,mobile:_0x5ab311,email:_0x560942,receivable:_0x471a2e,payable:_0x51d608,contactperson:_0xa3e025,landline:_0x361f0f}=_0x690d3c['body'];_0x133a92[_0x4b9f92(0x138)]=_0x5ad0be,_0x133a92[_0x4b9f92(0x153)]=_0x40a0ac,_0x133a92[_0x4b9f92(0x12b)]=_0x5ab311,_0x133a92[_0x4b9f92(0x127)]=_0x560942,_0x133a92['receivable']=_0x471a2e,_0x133a92[_0x4b9f92(0x12f)]=_0x51d608,_0x133a92[_0x4b9f92(0x159)]=_0xa3e025,_0x133a92['landline']=_0x361f0f;const _0x179853=await _0x133a92[_0x4b9f92(0x157)]();_0x690d3c['flash']('success',_0x4b9f92(0x162)),_0x31b41f['redirect'](_0x4b9f92(0x12c));}catch(_0x18326a){console[_0x4b9f92(0x179)](_0x18326a);}}),router[a0_0x3c3352(0x18e)](a0_0x3c3352(0x16b),auth,async(_0x352bb2,_0x3a1cbf)=>{const _0x243cba=a0_0x3c3352;try{const {username:_0x3e6199,email:_0x2e53f1,role:_0x2bd073}=_0x352bb2[_0x243cba(0x16c)],_0x3293f8=_0x352bb2[_0x243cba(0x16c)],_0x2c5582=await profile[_0x243cba(0x17f)]({'email':_0x3293f8['email']}),_0x2626dc=await master_shop[_0x243cba(0x169)]();console['log'](_0x243cba(0x14c),_0x2626dc),console[_0x243cba(0x179)](_0x352bb2[_0x243cba(0x139)]['id']);const _0x59cd1e=await customer[_0x243cba(0x17f)]({'_id':_0x352bb2[_0x243cba(0x139)]['id']});console[_0x243cba(0x179)](_0x243cba(0x143),_0x59cd1e);const _0x3e3b56=await c_payment_data[_0x243cba(0x169)]({'customer':_0x59cd1e[_0x243cba(0x138)]});console['log'](_0x3e3b56);const _0xb94cb7=await c_payment_data['aggregate']([{'$match':{'customer':_0x59cd1e[_0x243cba(0x138)]}},{'$match':{'reason':_0x243cba(0x12e)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x243cba(0x178)}}}]);console[_0x243cba(0x179)](_0x243cba(0x13b),_0xb94cb7);const _0x186ba7=await c_payment_data[_0x243cba(0x182)]([{'$match':{'customer':_0x59cd1e['name']}},{'$match':{'reason':_0x243cba(0x18f)}},{'$group':{'_id':_0x243cba(0x177),'sum':{'$sum':'$amount'}}}]);console['log'](_0x243cba(0x17a),_0x186ba7);if(_0x2626dc[0x0]['language']==_0x243cba(0x148)){var _0x52fde2=users[_0x243cba(0x164)];console['log'](_0x52fde2);}else{if(_0x2626dc[0x0][_0x243cba(0x163)]==_0x243cba(0x185))var _0x52fde2=users[_0x243cba(0x185)];else{if(_0x2626dc[0x0]['language']==_0x243cba(0x17e))var _0x52fde2=users[_0x243cba(0x17e)];else{if(_0x2626dc[0x0][_0x243cba(0x163)]==_0x243cba(0x176))var _0x52fde2=users['Spanish'];else{if(_0x2626dc[0x0][_0x243cba(0x163)]==_0x243cba(0x184))var _0x52fde2=users['French'];else{if(_0x2626dc[0x0][_0x243cba(0x163)]==_0x243cba(0x14b))var _0x52fde2=users[_0x243cba(0x147)];else{if(_0x2626dc[0x0][_0x243cba(0x163)]==_0x243cba(0x137))var _0x52fde2=users[_0x243cba(0x137)];else{if(_0x2626dc[0x0]['language']==_0x243cba(0x175))var _0x52fde2=users['Arabic'];}}}}}}}_0x3a1cbf['render'](_0x243cba(0x128),{'success':_0x352bb2[_0x243cba(0x155)](_0x243cba(0x14f)),'errors':_0x352bb2[_0x243cba(0x155)]('errors'),'role':_0x3293f8,'profile':_0x2c5582,'payment':_0x3e3b56,'payable':_0xb94cb7,'receivable':_0x186ba7,'master_shop':_0x2626dc,'language':_0x52fde2});}catch(_0x12ed8d){console[_0x243cba(0x179)](_0x12ed8d);}}),router[a0_0x3c3352(0x18e)]('/products_export_migrate_file',auth,async(_0x354d86,_0x1481ff)=>{const _0x48699e=a0_0x3c3352;try{const _0x4cd2ac=new excelJS[(_0x48699e(0x171))](),_0x5e9eaa=_0x4cd2ac['addWorksheet'](_0x48699e(0x132));return _0x5e9eaa[_0x48699e(0x17c)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x48699e(0x12a),'key':_0x48699e(0x150),'width':0xa},{'header':_0x48699e(0x187),'key':_0x48699e(0x166),'width':0xa},{'header':_0x48699e(0x13e),'key':'SalesmanName','width':0xa},{'header':_0x48699e(0x153),'key':_0x48699e(0x153),'width':0xa},{'header':'mobile','key':_0x48699e(0x12b),'width':0xa},{'header':_0x48699e(0x127),'key':_0x48699e(0x127),'width':0xa}],_0x1481ff['setHeader'](_0x48699e(0x15d),_0x48699e(0x173)),_0x1481ff['setHeader'](_0x48699e(0x160),_0x48699e(0x146)),_0x4cd2ac[_0x48699e(0x15c)][_0x48699e(0x167)](_0x1481ff)[_0x48699e(0x172)](()=>{_0x1481ff['status'](0xc8);});}catch(_0x2beb9e){_0x1481ff['status'](0x190)[_0x48699e(0x16a)]({'errors':_0x2beb9e[_0x48699e(0x141)]});}});const storage1=multer['diskStorage']({'destination':(_0x5655a5,_0x5f2c52,_0x142d43)=>{const _0x155eb5=a0_0x3c3352;_0x142d43(null,_0x155eb5(0x17b));},'filename':(_0x3ebc1b,_0x588ce4,_0x275a4e)=>{const _0x172e62=a0_0x3c3352;_0x275a4e(null,Date['now']()+_0x588ce4[_0x172e62(0x149)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x3c3352(0x14a)](a0_0x3c3352(0x161),auth,uploadMigrate['single'](a0_0x3c3352(0x183)),async(_0x2be238,_0x53bb21)=>{const _0x47cad0=a0_0x3c3352,_0x23b9a6=_0x2be238[_0x47cad0(0x15b)][_0x47cad0(0x13c)],_0x5574ad=await xlsx['readFile'](_0x47cad0(0x14e)+_0x23b9a6);let _0x5b2514=_0x5574ad[_0x47cad0(0x13a)],_0x1f93f6=xlsx['utils'][_0x47cad0(0x17d)](_0x5574ad[_0x47cad0(0x156)][_0x5b2514[0x0]]);for(const _0x38507 of _0x1f93f6){const _0x45b599=_0x38507['ID'],_0x2c6c08=_0x38507['Name'],_0x251713=_0x38507['SalesmanCode'],_0x17414f=_0x38507[_0x47cad0(0x13e)],_0xf81284=_0x38507[_0x47cad0(0x153)],_0x192d7f=_0x38507[_0x47cad0(0x12b)],_0x325778=_0x38507[_0x47cad0(0x127)];try{let _0x23a4c7=await customer['findOne']({'name':_0x2c6c08});if(!_0x23a4c7){const _0x1aa0ef=new customer({'name':_0x2c6c08,'ID':_0x45b599,'SalesmanCode':_0x251713,'SalesmanName':_0x17414f,'address':_0xf81284,'mobile':_0x192d7f,'email':_0x325778});_0x23a4c7=await _0x1aa0ef[_0x47cad0(0x157)](),_0x2be238[_0x47cad0(0x155)](_0x47cad0(0x14f),_0x2c6c08+_0x47cad0(0x15f));}else _0x2be238['flash'](_0x47cad0(0x14d),_0x2c6c08+_0x47cad0(0x154));}catch(_0x935d11){_0x53bb21['status'](0x1f4)[_0x47cad0(0x13f)]({'proderror':_0x935d11[_0x47cad0(0x141)],'aproduct':ProductName});}}_0x53bb21['redirect'](_0x47cad0(0x12c));}),module[a0_0x3c3352(0x189)]=router;