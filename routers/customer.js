const a0_0x40c49b=a0_0x2f91;(function(_0x426f9c,_0x1c777d){const _0x317754=a0_0x2f91,_0x583746=_0x426f9c();while(!![]){try{const _0x5db0c6=parseInt(_0x317754(0x18f))/0x1*(parseInt(_0x317754(0x1de))/0x2)+-parseInt(_0x317754(0x1d4))/0x3+-parseInt(_0x317754(0x1be))/0x4*(-parseInt(_0x317754(0x1a5))/0x5)+-parseInt(_0x317754(0x1ae))/0x6+-parseInt(_0x317754(0x1d5))/0x7*(-parseInt(_0x317754(0x189))/0x8)+-parseInt(_0x317754(0x1cd))/0x9+parseInt(_0x317754(0x1a9))/0xa*(-parseInt(_0x317754(0x183))/0xb);if(_0x5db0c6===_0x1c777d)break;else _0x583746['push'](_0x583746['shift']());}catch(_0x12851c){_0x583746['push'](_0x583746['shift']());}}}(a0_0x1ed7,0x21608));const express=require(a0_0x40c49b(0x1c7)),app=express(),router=express[a0_0x40c49b(0x185)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x40c49b(0x1ad)),auth=require(a0_0x40c49b(0x1dd)),users=require(a0_0x40c49b(0x18c)),excelJS=require(a0_0x40c49b(0x1a1)),xlsx=require(a0_0x40c49b(0x188)),multer=require(a0_0x40c49b(0x18a));router['get'](a0_0x40c49b(0x1b0),auth,async(_0x6091fc,_0x52a9b1)=>{const _0xd1333f=a0_0x40c49b;try{const {username:_0x48b20e,email:_0x3dbf84,role:_0x538f89}=_0x6091fc[_0xd1333f(0x186)],_0x6a1a05=_0x6091fc['user'],_0x371d58=await profile[_0xd1333f(0x1a8)]({'email':_0x6a1a05[_0xd1333f(0x1b4)]}),_0x4f473c=await master_shop[_0xd1333f(0x1b3)]();console[_0xd1333f(0x1c6)](_0xd1333f(0x1bf),_0x4f473c);const _0x1350b0=await customer[_0xd1333f(0x1b3)](),_0xf67bf2=await customer[_0xd1333f(0x1c4)]([{'$lookup':{'from':_0xd1333f(0x19b),'localField':_0xd1333f(0x1dc),'foreignField':_0xd1333f(0x1a2),'as':_0xd1333f(0x17e)}}]);console[_0xd1333f(0x1c6)](_0xf67bf2);const _0x3f789d=_0xf67bf2[_0xd1333f(0x1b2)](_0x4e7111=>{const _0x1050f9=_0xd1333f;console['log'](_0x1050f9(0x1b7),_0x4e7111);var _0x42402b=0x0,_0x413b3a=0x0;return _0x4e7111[_0x1050f9(0x17e)][_0x1050f9(0x1db)](_0x1e641f=>{const _0x48352e=_0x1050f9;console[_0x48352e(0x1c6)]('element',_0x1e641f),_0x1e641f[_0x48352e(0x19f)]=='Sale'?_0x42402b+=_0x1e641f[_0x48352e(0x1ba)]:_0x413b3a+=_0x1e641f[_0x48352e(0x1ba)];}),_0x4e7111[_0x1050f9(0x1cc)]=parseFloat(_0x42402b)+0x0,_0x4e7111[_0x1050f9(0x190)]=parseFloat(_0x413b3a)+0x0,_0x4e7111;});console[_0xd1333f(0x1c6)](_0xd1333f(0x192),_0x3f789d);if(_0x4f473c[0x0][_0xd1333f(0x1d7)]=='English\x20(US)'){var _0x95274c=users[_0xd1333f(0x1da)];console['log'](_0x95274c);}else{if(_0x4f473c[0x0]['language']==_0xd1333f(0x1c0))var _0x95274c=users['Hindi'];else{if(_0x4f473c[0x0][_0xd1333f(0x1d7)]==_0xd1333f(0x1cf))var _0x95274c=users[_0xd1333f(0x1cf)];else{if(_0x4f473c[0x0][_0xd1333f(0x1d7)]==_0xd1333f(0x1d1))var _0x95274c=users[_0xd1333f(0x1d1)];else{if(_0x4f473c[0x0]['language']=='French')var _0x95274c=users[_0xd1333f(0x19d)];else{if(_0x4f473c[0x0][_0xd1333f(0x1d7)]=='Portuguese\x20(BR)')var _0x95274c=users[_0xd1333f(0x182)];else{if(_0x4f473c[0x0][_0xd1333f(0x1d7)]==_0xd1333f(0x1a0))var _0x95274c=users[_0xd1333f(0x1a0)];else{if(_0x4f473c[0x0][_0xd1333f(0x1d7)]=='Arabic\x20(ae)')var _0x95274c=users['Arabic'];}}}}}}}_0x52a9b1[_0xd1333f(0x187)](_0xd1333f(0x1a2),{'success':_0x6091fc[_0xd1333f(0x1c9)](_0xd1333f(0x19e)),'errors':_0x6091fc[_0xd1333f(0x1c9)]('errors'),'user':_0x1350b0,'role':_0x6a1a05,'profile':_0x371d58,'payment':_0x3f789d,'master_shop':_0x4f473c,'language':_0x95274c});}catch(_0x43c2d5){console['log'](_0x43c2d5);}}),router['post'](a0_0x40c49b(0x1b0),auth,async(_0x5b481c,_0x17cb9f)=>{const _0x9eb599=a0_0x40c49b;try{const {name:_0xd5daa,address:_0x4de063,mobile:_0x569b5a,email:_0x36dab3,receivable:_0x463dc0,payable:_0x1dddc1,contactperson:_0x31121f,landline:_0x19cc93}=_0x5b481c[_0x9eb599(0x1d9)],_0x8b313f=new customer({'name':_0xd5daa,'address':_0x4de063,'mobile':_0x569b5a,'email':_0x36dab3,'receivable':_0x463dc0,'payable':_0x1dddc1,'contactperson':_0x31121f,'landline':_0x19cc93}),_0x23bb20=await _0x8b313f[_0x9eb599(0x1a4)]();_0x5b481c[_0x9eb599(0x1c9)](_0x9eb599(0x19e),_0x9eb599(0x1af)),_0x17cb9f[_0x9eb599(0x1c3)](_0x9eb599(0x196));}catch(_0x50103a){console[_0x9eb599(0x1c6)](_0x50103a);}}),router[a0_0x40c49b(0x1cb)]('/view/:id',auth,async(_0x168add,_0xd8796a)=>{const _0xc2c97c=a0_0x40c49b;try{const {username:_0x55f413,email:_0x4424b9,role:_0x53ea07}=_0x168add[_0xc2c97c(0x186)],_0x3ee008=_0x168add['user'],_0x4c9bdf=await profile[_0xc2c97c(0x1a8)]({'email':_0x3ee008[_0xc2c97c(0x1b4)]}),_0x11480d=await master_shop[_0xc2c97c(0x1b3)]();console[_0xc2c97c(0x1c6)]('master',_0x11480d);const _0x4a4939=_0x168add[_0xc2c97c(0x1a3)]['id'],_0x58cdfc=await customer[_0xc2c97c(0x181)](_0x4a4939);if(_0x11480d[0x0][_0xc2c97c(0x1d7)]==_0xc2c97c(0x191)){var _0x50c002=users['English'];console[_0xc2c97c(0x1c6)](_0x50c002);}else{if(_0x11480d[0x0][_0xc2c97c(0x1d7)]==_0xc2c97c(0x1c0))var _0x50c002=users[_0xc2c97c(0x1c0)];else{if(_0x11480d[0x0]['language']==_0xc2c97c(0x1cf))var _0x50c002=users[_0xc2c97c(0x1cf)];else{if(_0x11480d[0x0]['language']=='Spanish')var _0x50c002=users['Spanish'];else{if(_0x11480d[0x0][_0xc2c97c(0x1d7)]=='French')var _0x50c002=users[_0xc2c97c(0x19d)];else{if(_0x11480d[0x0][_0xc2c97c(0x1d7)]==_0xc2c97c(0x1b9))var _0x50c002=users[_0xc2c97c(0x182)];else{if(_0x11480d[0x0][_0xc2c97c(0x1d7)]==_0xc2c97c(0x1a0))var _0x50c002=users[_0xc2c97c(0x1a0)];else{if(_0x11480d[0x0][_0xc2c97c(0x1d7)]==_0xc2c97c(0x1c1))var _0x50c002=users[_0xc2c97c(0x1aa)];}}}}}}}_0xd8796a[_0xc2c97c(0x187)](_0xc2c97c(0x1a2),{'success':_0x168add[_0xc2c97c(0x1c9)](_0xc2c97c(0x19e)),'errors':_0x168add[_0xc2c97c(0x1c9)]('errors'),'role':_0x3ee008,'profile':_0x4c9bdf,'user':_0x58cdfc,'master_shop':_0x11480d,'language':_0x50c002});}catch(_0x5e4054){console['log'](_0x5e4054);}}),router[a0_0x40c49b(0x1c2)](a0_0x40c49b(0x1ce),auth,async(_0x5a212b,_0x4b1b22)=>{const _0x430444=a0_0x40c49b;try{const _0x83ba74=_0x5a212b[_0x430444(0x1a3)]['id'],_0x3732cb=await customer[_0x430444(0x181)](_0x83ba74),{name:_0x599666,address:_0x546c94,mobile:_0x28f949,email:_0x5e036d,receivable:_0x519ffd,payable:_0x3f1974,contactperson:_0x40d22b,landline:_0x23abc8}=_0x5a212b['body'];_0x3732cb[_0x430444(0x1dc)]=_0x599666,_0x3732cb[_0x430444(0x1b5)]=_0x546c94,_0x3732cb[_0x430444(0x1ac)]=_0x28f949,_0x3732cb[_0x430444(0x1b4)]=_0x5e036d,_0x3732cb[_0x430444(0x1b6)]=_0x519ffd,_0x3732cb[_0x430444(0x184)]=_0x3f1974,_0x3732cb[_0x430444(0x1d3)]=_0x40d22b,_0x3732cb[_0x430444(0x1bd)]=_0x23abc8;const _0x227f94=await _0x3732cb['save']();_0x5a212b[_0x430444(0x1c9)]('success',_0x430444(0x1e3)),_0x4b1b22[_0x430444(0x1c3)](_0x430444(0x196));}catch(_0x28241d){console[_0x430444(0x1c6)](_0x28241d);}}),router[a0_0x40c49b(0x1cb)](a0_0x40c49b(0x180),auth,async(_0x4f7ab4,_0x527beb)=>{const _0x405c78=a0_0x40c49b;try{const {username:_0x3d52fc,email:_0x20cc9a,role:_0x388fcb}=_0x4f7ab4[_0x405c78(0x186)],_0x36eb9d=_0x4f7ab4[_0x405c78(0x186)],_0x19f4d0=await profile[_0x405c78(0x1a8)]({'email':_0x36eb9d[_0x405c78(0x1b4)]}),_0x4062bc=await master_shop[_0x405c78(0x1b3)]();console[_0x405c78(0x1c6)](_0x405c78(0x1bf),_0x4062bc),console['log'](_0x4f7ab4['params']['id']);const _0x17340e=await customer['findOne']({'_id':_0x4f7ab4[_0x405c78(0x1a3)]['id']});console['log'](_0x405c78(0x1b1),_0x17340e);const _0x3f3c9d=await c_payment_data[_0x405c78(0x1b3)]({'customer':_0x17340e[_0x405c78(0x1dc)]});console[_0x405c78(0x1c6)](_0x3f3c9d);const _0x223d5a=await c_payment_data[_0x405c78(0x1c4)]([{'$match':{'customer':_0x17340e['name']}},{'$match':{'reason':_0x405c78(0x1df)}},{'$group':{'_id':_0x405c78(0x194),'sum':{'$sum':_0x405c78(0x19c)}}}]);console['log'](_0x405c78(0x197),_0x223d5a);const _0x1896f5=await c_payment_data['aggregate']([{'$match':{'customer':_0x17340e['name']}},{'$match':{'reason':'Sale\x20Return'}},{'$group':{'_id':_0x405c78(0x194),'sum':{'$sum':'$amount'}}}]);console[_0x405c78(0x1c6)](_0x405c78(0x17f),_0x1896f5);if(_0x4062bc[0x0][_0x405c78(0x1d7)]==_0x405c78(0x191)){var _0x5ae89e=users[_0x405c78(0x1da)];console['log'](_0x5ae89e);}else{if(_0x4062bc[0x0][_0x405c78(0x1d7)]==_0x405c78(0x1c0))var _0x5ae89e=users[_0x405c78(0x1c0)];else{if(_0x4062bc[0x0][_0x405c78(0x1d7)]==_0x405c78(0x1cf))var _0x5ae89e=users[_0x405c78(0x1cf)];else{if(_0x4062bc[0x0]['language']==_0x405c78(0x1d1))var _0x5ae89e=users[_0x405c78(0x1d1)];else{if(_0x4062bc[0x0][_0x405c78(0x1d7)]==_0x405c78(0x19d))var _0x5ae89e=users[_0x405c78(0x19d)];else{if(_0x4062bc[0x0]['language']==_0x405c78(0x1b9))var _0x5ae89e=users[_0x405c78(0x182)];else{if(_0x4062bc[0x0][_0x405c78(0x1d7)]==_0x405c78(0x1a0))var _0x5ae89e=users['Chinese'];else{if(_0x4062bc[0x0][_0x405c78(0x1d7)]=='Arabic\x20(ae)')var _0x5ae89e=users[_0x405c78(0x1aa)];}}}}}}}_0x527beb[_0x405c78(0x187)](_0x405c78(0x1ab),{'success':_0x4f7ab4['flash'](_0x405c78(0x19e)),'errors':_0x4f7ab4[_0x405c78(0x1c9)](_0x405c78(0x199)),'role':_0x36eb9d,'profile':_0x19f4d0,'payment':_0x3f3c9d,'payable':_0x223d5a,'receivable':_0x1896f5,'master_shop':_0x4062bc,'language':_0x5ae89e});}catch(_0x56ef08){console['log'](_0x56ef08);}}),router['get'](a0_0x40c49b(0x1d0),auth,async(_0x58368b,_0x5493a7)=>{const _0x37f8e6=a0_0x40c49b;try{const _0x5a8988=new excelJS['Workbook'](),_0x53a435=_0x5a8988[_0x37f8e6(0x1d6)](_0x37f8e6(0x1e1));return _0x53a435[_0x37f8e6(0x1d2)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x37f8e6(0x1e4),'key':'PBrands','width':0xa},{'header':_0x37f8e6(0x198),'key':'PUnits','width':0xa},{'header':_0x37f8e6(0x1ca),'key':'SalesmanName','width':0xa},{'header':_0x37f8e6(0x1b5),'key':'address','width':0xa},{'header':_0x37f8e6(0x1ac),'key':_0x37f8e6(0x1ac),'width':0xa},{'header':'email','key':_0x37f8e6(0x1b4),'width':0xa}],_0x5493a7[_0x37f8e6(0x1bc)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x5493a7[_0x37f8e6(0x1bc)]('Content-Disposition','attachment;\x20filename=customer_Migration_File.xlsx'),_0x5a8988[_0x37f8e6(0x188)][_0x37f8e6(0x18b)](_0x5493a7)[_0x37f8e6(0x18e)](()=>{_0x5493a7['status'](0xc8);});}catch(_0xe6c7ab){_0x5493a7[_0x37f8e6(0x1b8)](0x190)[_0x37f8e6(0x1e2)]({'errors':_0xe6c7ab[_0x37f8e6(0x1c5)]});}});const storage1=multer[a0_0x40c49b(0x1c8)]({'destination':(_0x20b450,_0x1e2fb8,_0x5e6618)=>{const _0x435d9b=a0_0x40c49b;_0x5e6618(null,_0x435d9b(0x193));},'filename':(_0x399c72,_0x3ad6dd,_0xe9c358)=>{const _0x102033=a0_0x40c49b;_0xe9c358(null,Date[_0x102033(0x1e0)]()+_0x3ad6dd['originalname']);}}),uploadMigrate=multer({'storage':storage1});function a0_0x2f91(_0x599a1f,_0xfcae68){const _0x1ed76d=a0_0x1ed7();return a0_0x2f91=function(_0x2f9135,_0x57aad6){_0x2f9135=_0x2f9135-0x17e;let _0x423a2c=_0x1ed76d[_0x2f9135];return _0x423a2c;},a0_0x2f91(_0x599a1f,_0xfcae68);}router[a0_0x40c49b(0x1c2)]('/customer_import_migrate_file',auth,uploadMigrate[a0_0x40c49b(0x1a7)]('customer_product_fule'),async(_0x51b919,_0x4bebd0)=>{const _0x2254a5=a0_0x40c49b,_0xdfa8db=_0x51b919[_0x2254a5(0x18d)][_0x2254a5(0x1d8)],_0x57c688=await xlsx[_0x2254a5(0x195)](_0x2254a5(0x1a6)+_0xdfa8db);let _0x2c57d5=_0x57c688[_0x2254a5(0x1bb)],_0xc15032=xlsx['utils']['sheet_to_json'](_0x57c688['Sheets'][_0x2c57d5[0x0]]);for(const _0x3a7356 of _0xc15032){const _0x442864=_0x3a7356['ID'],_0x4f1dd3=_0x3a7356[_0x2254a5(0x1e4)],_0x2f773e=_0x3a7356['SalesmanCode'],_0x47606a=_0x3a7356[_0x2254a5(0x1ca)],_0x46df78=_0x3a7356[_0x2254a5(0x1b5)],_0x101186=_0x3a7356[_0x2254a5(0x1ac)],_0x2cea71=_0x3a7356[_0x2254a5(0x1b4)];try{let _0x3ba04c=await customer[_0x2254a5(0x1a8)]({'name':_0x4f1dd3});if(!_0x3ba04c){const _0x5cd6e8=new customer({'name':_0x4f1dd3,'ID':_0x442864,'SalesmanCode':_0x2f773e,'SalesmanName':_0x47606a,'address':_0x46df78,'mobile':_0x101186,'email':_0x2cea71});_0x3ba04c=await _0x5cd6e8[_0x2254a5(0x1a4)](),_0x51b919[_0x2254a5(0x1c9)](_0x2254a5(0x19e),_0x4f1dd3+'\x20added\x20successfully');}else _0x51b919[_0x2254a5(0x1c9)]('error',_0x4f1dd3+_0x2254a5(0x19a));}catch(_0x8b860b){_0x4bebd0[_0x2254a5(0x1b8)](0x1f4)[_0x2254a5(0x1e5)]({'proderror':_0x8b860b[_0x2254a5(0x1c5)],'aproduct':ProductName});}}_0x4bebd0[_0x2254a5(0x1c3)](_0x2254a5(0x196));}),module['exports']=router;function a0_0x1ed7(){const _0x141be1=['/view/:id','German','/products_export_migrate_file','Spanish','columns','contactperson','272439EJEaxp','35StuJyZ','addWorksheet','language','filename','body','English','forEach','name','../middleware/auth','194LFGZnW','Sale','now','Customers','send','customer\x20update\x20successfully','Name','json','customer_docs','receivable_sum','/view/payment/:id','findById','Portuguese','6908lzSxxF','payable','Router','user','render','xlsx','154904PYWkZW','multer','write','../public/language/languages.json','file','then','2726iwKTwY','sale_return','English\x20(US)','payment_data','public/Migration','$reason','readFile','/customer/view','payable_sum','SalesmanCode','errors','\x20Failed','c_payments','$amount','French','success','reason','Chinese','exceljs','customer','params','save','22780dYlQmV','public/Migration/','single','findOne','1280jWKCLz','Arabic','customer_payment','mobile','../models/all_models','732QCeEhv','customer\x20add\x20successfully','/view','customer_data','map','find','email','address','receivable','data','status','Portuguese\x20(BR)','amount','SheetNames','setHeader','landline','4hgTKPe','master','Hindi','Arabic\x20(ae)','post','redirect','aggregate','message','log','express','diskStorage','flash','SalesmanName','get','sale','519858KAfJYG'];a0_0x1ed7=function(){return _0x141be1;};return a0_0x1ed7();}