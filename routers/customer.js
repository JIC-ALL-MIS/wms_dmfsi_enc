const a0_0x1b1778=a0_0x2409;(function(_0x361d17,_0x51efd8){const _0x1c11f3=a0_0x2409,_0x443a88=_0x361d17();while(!![]){try{const _0x38763f=parseInt(_0x1c11f3(0x18a))/0x1*(parseInt(_0x1c11f3(0x13c))/0x2)+-parseInt(_0x1c11f3(0x169))/0x3*(parseInt(_0x1c11f3(0x139))/0x4)+parseInt(_0x1c11f3(0x15d))/0x5+-parseInt(_0x1c11f3(0x12e))/0x6+parseInt(_0x1c11f3(0x159))/0x7*(parseInt(_0x1c11f3(0x16b))/0x8)+parseInt(_0x1c11f3(0x17e))/0x9+parseInt(_0x1c11f3(0x185))/0xa;if(_0x38763f===_0x51efd8)break;else _0x443a88['push'](_0x443a88['shift']());}catch(_0x49a48f){_0x443a88['push'](_0x443a88['shift']());}}}(a0_0x2e63,0x1ac4c));const express=require(a0_0x1b1778(0x13d)),app=express(),router=express[a0_0x1b1778(0x180)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x1b1778(0x194)),auth=require('../middleware/auth'),users=require(a0_0x1b1778(0x15c)),excelJS=require(a0_0x1b1778(0x130)),xlsx=require(a0_0x1b1778(0x157)),multer=require(a0_0x1b1778(0x17c));router[a0_0x1b1778(0x17b)]('/view',auth,async(_0x29f503,_0x54e40b)=>{const _0x29ebd3=a0_0x1b1778;try{const {username:_0x3bf423,email:_0x37183f,role:_0x608c60}=_0x29f503[_0x29ebd3(0x168)],_0x5d8d77=_0x29f503[_0x29ebd3(0x168)],_0x299b2a=await profile[_0x29ebd3(0x149)]({'email':_0x5d8d77[_0x29ebd3(0x144)]}),_0x132e40=await master_shop[_0x29ebd3(0x165)]();console['log']('master',_0x132e40);const _0x4b49d9=await customer[_0x29ebd3(0x165)](),_0x53d9c0=await customer[_0x29ebd3(0x132)]([{'$lookup':{'from':_0x29ebd3(0x163),'localField':_0x29ebd3(0x14d),'foreignField':_0x29ebd3(0x138),'as':_0x29ebd3(0x142)}}]);console[_0x29ebd3(0x14b)](_0x53d9c0);const _0x3e866a=_0x53d9c0['map'](_0x59d44a=>{const _0x428947=_0x29ebd3;console[_0x428947(0x14b)](_0x428947(0x191),_0x59d44a);var _0x1b55bd=0x0,_0x2cb4e9=0x0;return _0x59d44a['customer_docs'][_0x428947(0x15f)](_0x2c7de7=>{const _0x2e1358=_0x428947;console['log'](_0x2e1358(0x18e),_0x2c7de7),_0x2c7de7['reason']==_0x2e1358(0x147)?_0x1b55bd+=_0x2c7de7[_0x2e1358(0x14a)]:_0x2cb4e9+=_0x2c7de7[_0x2e1358(0x14a)];}),_0x59d44a[_0x428947(0x174)]=parseFloat(_0x1b55bd)+0x0,_0x59d44a[_0x428947(0x16e)]=parseFloat(_0x2cb4e9)+0x0,_0x59d44a;});console[_0x29ebd3(0x14b)]('payment_data',_0x3e866a);if(_0x132e40[0x0][_0x29ebd3(0x190)]==_0x29ebd3(0x143)){var _0x3fe418=users['English'];console[_0x29ebd3(0x14b)](_0x3fe418);}else{if(_0x132e40[0x0]['language']=='Hindi')var _0x3fe418=users[_0x29ebd3(0x15a)];else{if(_0x132e40[0x0]['language']=='German')var _0x3fe418=users[_0x29ebd3(0x187)];else{if(_0x132e40[0x0][_0x29ebd3(0x190)]==_0x29ebd3(0x18d))var _0x3fe418=users[_0x29ebd3(0x18d)];else{if(_0x132e40[0x0][_0x29ebd3(0x190)]=='French')var _0x3fe418=users[_0x29ebd3(0x13e)];else{if(_0x132e40[0x0][_0x29ebd3(0x190)]==_0x29ebd3(0x176))var _0x3fe418=users[_0x29ebd3(0x156)];else{if(_0x132e40[0x0][_0x29ebd3(0x190)]=='Chinese')var _0x3fe418=users[_0x29ebd3(0x161)];else{if(_0x132e40[0x0][_0x29ebd3(0x190)]==_0x29ebd3(0x146))var _0x3fe418=users['Arabic'];}}}}}}}_0x54e40b[_0x29ebd3(0x17d)](_0x29ebd3(0x138),{'success':_0x29f503[_0x29ebd3(0x13b)](_0x29ebd3(0x12c)),'errors':_0x29f503[_0x29ebd3(0x13b)](_0x29ebd3(0x13f)),'user':_0x4b49d9,'role':_0x5d8d77,'profile':_0x299b2a,'payment':_0x3e866a,'master_shop':_0x132e40,'language':_0x3fe418});}catch(_0x2a3374){console['log'](_0x2a3374);}}),router['post'](a0_0x1b1778(0x181),auth,async(_0x2b524a,_0x589fa3)=>{const _0x43b5dd=a0_0x1b1778;try{const {name:_0x4772bf,address:_0x5d6c56,mobile:_0x520e57,email:_0x38aaf4,receivable:_0x4535b4,payable:_0x19ec94,contactperson:_0x176682,landline:_0x5dde96}=_0x2b524a[_0x43b5dd(0x164)],_0xda9c6d=new customer({'name':_0x4772bf,'address':_0x5d6c56,'mobile':_0x520e57,'email':_0x38aaf4,'receivable':_0x4535b4,'payable':_0x19ec94,'contactperson':_0x176682,'landline':_0x5dde96}),_0x621561=await _0xda9c6d['save']();_0x2b524a[_0x43b5dd(0x13b)](_0x43b5dd(0x12c),_0x43b5dd(0x171)),_0x589fa3[_0x43b5dd(0x136)](_0x43b5dd(0x15e));}catch(_0x5452b8){console[_0x43b5dd(0x14b)](_0x5452b8);}}),router[a0_0x1b1778(0x17b)](a0_0x1b1778(0x17a),auth,async(_0x30ab40,_0x4e4b27)=>{const _0x18c500=a0_0x1b1778;try{const {username:_0x380009,email:_0x104b22,role:_0x2d7c51}=_0x30ab40[_0x18c500(0x168)],_0x35dc28=_0x30ab40[_0x18c500(0x168)],_0x3c7b01=await profile[_0x18c500(0x149)]({'email':_0x35dc28[_0x18c500(0x144)]}),_0x3f3802=await master_shop['find']();console[_0x18c500(0x14b)](_0x18c500(0x134),_0x3f3802);const _0x532fdf=_0x30ab40['params']['id'],_0x261ff1=await customer[_0x18c500(0x16a)](_0x532fdf);if(_0x3f3802[0x0][_0x18c500(0x190)]==_0x18c500(0x143)){var _0x55f032=users[_0x18c500(0x184)];console['log'](_0x55f032);}else{if(_0x3f3802[0x0]['language']==_0x18c500(0x15a))var _0x55f032=users[_0x18c500(0x15a)];else{if(_0x3f3802[0x0]['language']=='German')var _0x55f032=users[_0x18c500(0x187)];else{if(_0x3f3802[0x0][_0x18c500(0x190)]==_0x18c500(0x18d))var _0x55f032=users[_0x18c500(0x18d)];else{if(_0x3f3802[0x0]['language']==_0x18c500(0x13e))var _0x55f032=users[_0x18c500(0x13e)];else{if(_0x3f3802[0x0][_0x18c500(0x190)]==_0x18c500(0x176))var _0x55f032=users[_0x18c500(0x156)];else{if(_0x3f3802[0x0][_0x18c500(0x190)]==_0x18c500(0x161))var _0x55f032=users[_0x18c500(0x161)];else{if(_0x3f3802[0x0][_0x18c500(0x190)]=='Arabic\x20(ae)')var _0x55f032=users[_0x18c500(0x145)];}}}}}}}_0x4e4b27[_0x18c500(0x17d)](_0x18c500(0x138),{'success':_0x30ab40[_0x18c500(0x13b)](_0x18c500(0x12c)),'errors':_0x30ab40['flash']('errors'),'role':_0x35dc28,'profile':_0x3c7b01,'user':_0x261ff1,'master_shop':_0x3f3802,'language':_0x55f032});}catch(_0xd20009){console['log'](_0xd20009);}}),router[a0_0x1b1778(0x158)](a0_0x1b1778(0x17a),auth,async(_0x265de8,_0x26cc36)=>{const _0x4dd1e5=a0_0x1b1778;try{const _0x55ea85=_0x265de8['params']['id'],_0xf61c4c=await customer['findById'](_0x55ea85),{name:_0x5135e5,address:_0x5d4a83,mobile:_0x493fc6,email:_0x4e7695,receivable:_0x37d4b6,payable:_0xca624d,contactperson:_0x215753,landline:_0x163c6d}=_0x265de8['body'];_0xf61c4c[_0x4dd1e5(0x14d)]=_0x5135e5,_0xf61c4c[_0x4dd1e5(0x12d)]=_0x5d4a83,_0xf61c4c[_0x4dd1e5(0x12a)]=_0x493fc6,_0xf61c4c[_0x4dd1e5(0x144)]=_0x4e7695,_0xf61c4c[_0x4dd1e5(0x173)]=_0x37d4b6,_0xf61c4c['payable']=_0xca624d,_0xf61c4c[_0x4dd1e5(0x188)]=_0x215753,_0xf61c4c[_0x4dd1e5(0x137)]=_0x163c6d;const _0x5e85f0=await _0xf61c4c[_0x4dd1e5(0x153)]();_0x265de8[_0x4dd1e5(0x13b)](_0x4dd1e5(0x12c),_0x4dd1e5(0x151)),_0x26cc36[_0x4dd1e5(0x136)]('/customer/view');}catch(_0x438a88){console['log'](_0x438a88);}}),router[a0_0x1b1778(0x17b)]('/view/payment/:id',auth,async(_0x545242,_0xc5a296)=>{const _0x4f212b=a0_0x1b1778;try{const {username:_0x59e541,email:_0x1ed103,role:_0x59e9c5}=_0x545242['user'],_0x450447=_0x545242[_0x4f212b(0x168)],_0x348942=await profile['findOne']({'email':_0x450447[_0x4f212b(0x144)]}),_0x1c06d7=await master_shop['find']();console[_0x4f212b(0x14b)](_0x4f212b(0x134),_0x1c06d7),console[_0x4f212b(0x14b)](_0x545242['params']['id']);const _0x59cc1b=await customer[_0x4f212b(0x149)]({'_id':_0x545242[_0x4f212b(0x14f)]['id']});console[_0x4f212b(0x14b)](_0x4f212b(0x150),_0x59cc1b);const _0x685027=await c_payment_data[_0x4f212b(0x165)]({'customer':_0x59cc1b[_0x4f212b(0x14d)]});console[_0x4f212b(0x14b)](_0x685027);const _0x3c72ae=await c_payment_data[_0x4f212b(0x132)]([{'$match':{'customer':_0x59cc1b[_0x4f212b(0x14d)]}},{'$match':{'reason':_0x4f212b(0x147)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x4f212b(0x14e)}}}]);console[_0x4f212b(0x14b)]('payable_sum',_0x3c72ae);const _0x4c9e77=await c_payment_data['aggregate']([{'$match':{'customer':_0x59cc1b[_0x4f212b(0x14d)]}},{'$match':{'reason':_0x4f212b(0x170)}},{'$group':{'_id':_0x4f212b(0x13a),'sum':{'$sum':_0x4f212b(0x14e)}}}]);console[_0x4f212b(0x14b)](_0x4f212b(0x15b),_0x4c9e77);if(_0x1c06d7[0x0][_0x4f212b(0x190)]==_0x4f212b(0x143)){var _0xacc61=users[_0x4f212b(0x184)];console[_0x4f212b(0x14b)](_0xacc61);}else{if(_0x1c06d7[0x0][_0x4f212b(0x190)]==_0x4f212b(0x15a))var _0xacc61=users[_0x4f212b(0x15a)];else{if(_0x1c06d7[0x0][_0x4f212b(0x190)]==_0x4f212b(0x187))var _0xacc61=users['German'];else{if(_0x1c06d7[0x0]['language']==_0x4f212b(0x18d))var _0xacc61=users[_0x4f212b(0x18d)];else{if(_0x1c06d7[0x0][_0x4f212b(0x190)]==_0x4f212b(0x13e))var _0xacc61=users[_0x4f212b(0x13e)];else{if(_0x1c06d7[0x0][_0x4f212b(0x190)]==_0x4f212b(0x176))var _0xacc61=users[_0x4f212b(0x156)];else{if(_0x1c06d7[0x0][_0x4f212b(0x190)]==_0x4f212b(0x161))var _0xacc61=users[_0x4f212b(0x161)];else{if(_0x1c06d7[0x0][_0x4f212b(0x190)]==_0x4f212b(0x146))var _0xacc61=users[_0x4f212b(0x145)];}}}}}}}_0xc5a296['render'](_0x4f212b(0x141),{'success':_0x545242[_0x4f212b(0x13b)](_0x4f212b(0x12c)),'errors':_0x545242[_0x4f212b(0x13b)](_0x4f212b(0x13f)),'role':_0x450447,'profile':_0x348942,'payment':_0x685027,'payable':_0x3c72ae,'receivable':_0x4c9e77,'master_shop':_0x1c06d7,'language':_0xacc61});}catch(_0xfe1f7c){console[_0x4f212b(0x14b)](_0xfe1f7c);}}),router[a0_0x1b1778(0x17b)](a0_0x1b1778(0x154),auth,async(_0x4097aa,_0x44650e)=>{const _0x546b40=a0_0x1b1778;try{const _0x50d55e=new excelJS[(_0x546b40(0x182))](),_0x1b6ab9=_0x50d55e[_0x546b40(0x178)](_0x546b40(0x18f));return _0x1b6ab9[_0x546b40(0x18c)]=[{'header':'ID','key':'PName','width':0xa},{'header':_0x546b40(0x16d),'key':_0x546b40(0x17f),'width':0xa},{'header':_0x546b40(0x152),'key':_0x546b40(0x155),'width':0xa},{'header':_0x546b40(0x179),'key':_0x546b40(0x179),'width':0xa},{'header':_0x546b40(0x12d),'key':'address','width':0xa},{'header':_0x546b40(0x12a),'key':_0x546b40(0x12a),'width':0xa},{'header':_0x546b40(0x144),'key':_0x546b40(0x144),'width':0xa}],_0x44650e[_0x546b40(0x166)](_0x546b40(0x162),_0x546b40(0x14c)),_0x44650e[_0x546b40(0x166)](_0x546b40(0x12f),_0x546b40(0x16c)),_0x50d55e['xlsx'][_0x546b40(0x131)](_0x44650e)[_0x546b40(0x128)](()=>{_0x44650e['status'](0xc8);});}catch(_0x3e29db){_0x44650e[_0x546b40(0x135)](0x190)[_0x546b40(0x192)]({'errors':_0x3e29db[_0x546b40(0x16f)]});}});function a0_0x2409(_0x28e093,_0x53800e){const _0x2e630a=a0_0x2e63();return a0_0x2409=function(_0x2409b9,_0x8d674a){_0x2409b9=_0x2409b9-0x128;let _0x391ce1=_0x2e630a[_0x2409b9];return _0x391ce1;},a0_0x2409(_0x28e093,_0x53800e);}const storage1=multer[a0_0x1b1778(0x186)]({'destination':(_0x107569,_0x5fc042,_0x19d60a)=>{const _0x2f80c2=a0_0x1b1778;_0x19d60a(null,_0x2f80c2(0x18b));},'filename':(_0x14cbd2,_0x2141e5,_0x24facf)=>{const _0x206745=a0_0x1b1778;_0x24facf(null,Date['now']()+_0x2141e5[_0x206745(0x129)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x1b1778(0x158)](a0_0x1b1778(0x177),auth,uploadMigrate[a0_0x1b1778(0x133)](a0_0x1b1778(0x140)),async(_0x4fb2c7,_0x499f82)=>{const _0x106c05=a0_0x1b1778,_0x228b05=_0x4fb2c7[_0x106c05(0x189)][_0x106c05(0x183)],_0x7cecec=await xlsx[_0x106c05(0x193)]('public/Migration/'+_0x228b05);let _0x5954cb=_0x7cecec['SheetNames'],_0x583263=xlsx['utils'][_0x106c05(0x148)](_0x7cecec[_0x106c05(0x167)][_0x5954cb[0x0]]);for(const _0x3a3252 of _0x583263){const _0x1baea4=_0x3a3252['ID'],_0x2208bd=_0x3a3252[_0x106c05(0x16d)],_0x119cd3=_0x3a3252[_0x106c05(0x152)],_0x375ee0=_0x3a3252['SalesmanName'],_0x3d775d=_0x3a3252[_0x106c05(0x12d)],_0x3cd986=_0x3a3252[_0x106c05(0x12a)],_0x47b883=_0x3a3252[_0x106c05(0x144)];try{let _0x453e35=await customer['findOne']({'name':_0x2208bd});if(!_0x453e35){const _0x7fa4a7=new customer({'name':_0x2208bd,'ID':_0x1baea4,'SalesmanCode':_0x119cd3,'SalesmanName':_0x375ee0,'address':_0x3d775d,'mobile':_0x3cd986,'email':_0x47b883});_0x453e35=await _0x7fa4a7[_0x106c05(0x153)](),_0x4fb2c7[_0x106c05(0x13b)](_0x106c05(0x12c),_0x2208bd+_0x106c05(0x160));}else _0x4fb2c7[_0x106c05(0x13b)](_0x106c05(0x172),_0x2208bd+_0x106c05(0x12b));}catch(_0x22f7c0){_0x499f82[_0x106c05(0x135)](0x1f4)['json']({'proderror':_0x22f7c0[_0x106c05(0x16f)],'aproduct':ProductName});}}_0x499f82[_0x106c05(0x136)](_0x106c05(0x15e));}),module[a0_0x1b1778(0x175)]=router;function a0_0x2e63(){const _0x395d09=['xlsx','post','104657UgOWJz','Hindi','receivable_sum','../public/language/languages.json','305220gPmKiy','/customer/view','forEach','\x20added\x20successfully','Chinese','Content-Type','c_payments','body','find','setHeader','Sheets','user','3XMimHR','findById','56DJBxXq','attachment;\x20filename=customer_Migration_File.xlsx','Name','sale_return','message','Sale\x20Return','customer\x20add\x20successfully','error','receivable','sale','exports','Portuguese\x20(BR)','/customer_import_migrate_file','addWorksheet','SalesmanName','/view/:id','get','multer','render','1106802KRVKjz','PBrands','Router','/view','Workbook','filename','English','1605750xeTDWh','diskStorage','German','contactperson','file','251zJqKzB','public/Migration','columns','Spanish','element','Customers','language','data','send','readFile','../models/all_models','then','originalname','mobile','\x20Failed','success','address','814380vougkj','Content-Disposition','exceljs','write','aggregate','single','master','status','redirect','landline','customer','872748CKspDW','$reason','flash','114pumiyH','express','French','errors','customer_product_fule','customer_payment','customer_docs','English\x20(US)','email','Arabic','Arabic\x20(ae)','Sale','sheet_to_json','findOne','amount','log','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','name','$amount','params','customer_data','customer\x20update\x20successfully','SalesmanCode','save','/products_export_migrate_file','PUnits','Portuguese'];a0_0x2e63=function(){return _0x395d09;};return a0_0x2e63();}