function a0_0x3340(){const _0xfc1c0f=['body','multer','render','payment_data','Arabic\x20(ae)','payable','406490AIrElg','forEach','errors','exceljs','Name','aggregate','Sale\x20Return','amount','mobile','log','reason','params','3060129ZWZvNm','SalesmanCode','find','$amount','payable_sum','/customer/view','json','customer_product_fule','../middleware/auth','4fouepe','attachment;\x20filename=customer_Migration_File.xlsx','data','redirect','9457wFnXkz','PBrands','Chinese','findOne','save','public/Migration','sheet_to_json','send','Spanish','language','email','error','customer_payment','success','file','2645405jEQVHQ','then','status','English','express','single','originalname','261395RddykT','utils','customer_docs','4613792QQFjLP','Content-Type','customer_data','public/Migration/','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet','customer','setHeader','readFile','map','master','name','PName','get','Arabic','English\x20(US)','/view','Workbook','exports','write','xlsx','diskStorage','receivable','90ndPPML','../public/language/languages.json','SalesmanName','153UqnOUp','Hindi','Customers','message','$reason','addWorksheet','user','sale_return','filename','flash','findById','\x20Failed','post','Router','French','Portuguese\x20(BR)','address','316090rAVFYK','/customer_import_migrate_file','German','/view/:id','sale','Portuguese'];a0_0x3340=function(){return _0xfc1c0f;};return a0_0x3340();}function a0_0x1c85(_0x28571c,_0x4e2b8e){const _0x3340ba=a0_0x3340();return a0_0x1c85=function(_0x1c855c,_0x18b642){_0x1c855c=_0x1c855c-0x13f;let _0x531f=_0x3340ba[_0x1c855c];return _0x531f;},a0_0x1c85(_0x28571c,_0x4e2b8e);}const a0_0x524b7a=a0_0x1c85;(function(_0xd3f08,_0x18c96e){const _0x1ef93e=a0_0x1c85,_0x56c5cf=_0xd3f08();while(!![]){try{const _0x592daf=parseInt(_0x1ef93e(0x14f))/0x1+parseInt(_0x1ef93e(0x19e))/0x2+-parseInt(_0x1ef93e(0x142))/0x3*(-parseInt(_0x1ef93e(0x14b))/0x4)+-parseInt(_0x1ef93e(0x165))/0x5*(-parseInt(_0x1ef93e(0x17e))/0x6)+-parseInt(_0x1ef93e(0x15e))/0x7+-parseInt(_0x1ef93e(0x168))/0x8+parseInt(_0x1ef93e(0x181))/0x9*(-parseInt(_0x1ef93e(0x192))/0xa);if(_0x592daf===_0x18c96e)break;else _0x56c5cf['push'](_0x56c5cf['shift']());}catch(_0x573117){_0x56c5cf['push'](_0x56c5cf['shift']());}}}(a0_0x3340,0x8028a));const express=require(a0_0x524b7a(0x162)),app=express(),router=express[a0_0x524b7a(0x18e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require('../models/all_models'),auth=require(a0_0x524b7a(0x14a)),users=require(a0_0x524b7a(0x17f)),excelJS=require(a0_0x524b7a(0x1a1)),xlsx=require(a0_0x524b7a(0x17b)),multer=require(a0_0x524b7a(0x199));router[a0_0x524b7a(0x174)](a0_0x524b7a(0x177),auth,async(_0xb2fc5,_0x46e4d4)=>{const _0xadcacc=a0_0x524b7a;try{const {username:_0x10fd66,email:_0x446ff6,role:_0x5d1095}=_0xb2fc5[_0xadcacc(0x187)],_0x1bbd03=_0xb2fc5['user'],_0x56d919=await profile[_0xadcacc(0x152)]({'email':_0x1bbd03[_0xadcacc(0x159)]}),_0x847d7a=await master_shop[_0xadcacc(0x144)]();console[_0xadcacc(0x13f)]('master',_0x847d7a);const _0x210521=await customer['find'](),_0x28b63e=await customer['aggregate']([{'$lookup':{'from':'c_payments','localField':_0xadcacc(0x172),'foreignField':_0xadcacc(0x16d),'as':_0xadcacc(0x167)}}]);console['log'](_0x28b63e);const _0x3bab87=_0x28b63e[_0xadcacc(0x170)](_0x1bdefd=>{const _0x215ae7=_0xadcacc;console[_0x215ae7(0x13f)](_0x215ae7(0x14d),_0x1bdefd);var _0x21d832=0x0,_0x296892=0x0;return _0x1bdefd[_0x215ae7(0x167)][_0x215ae7(0x19f)](_0x4e6f47=>{const _0x2a4ff4=_0x215ae7;console['log']('element',_0x4e6f47),_0x4e6f47[_0x2a4ff4(0x140)]=='Sale'?_0x21d832+=_0x4e6f47[_0x2a4ff4(0x1a5)]:_0x296892+=_0x4e6f47[_0x2a4ff4(0x1a5)];}),_0x1bdefd[_0x215ae7(0x196)]=parseFloat(_0x21d832)+0x0,_0x1bdefd[_0x215ae7(0x188)]=parseFloat(_0x296892)+0x0,_0x1bdefd;});console[_0xadcacc(0x13f)](_0xadcacc(0x19b),_0x3bab87);if(_0x847d7a[0x0][_0xadcacc(0x158)]==_0xadcacc(0x176)){var _0x3adc88=users[_0xadcacc(0x161)];console[_0xadcacc(0x13f)](_0x3adc88);}else{if(_0x847d7a[0x0][_0xadcacc(0x158)]=='Hindi')var _0x3adc88=users[_0xadcacc(0x182)];else{if(_0x847d7a[0x0]['language']==_0xadcacc(0x194))var _0x3adc88=users['German'];else{if(_0x847d7a[0x0][_0xadcacc(0x158)]==_0xadcacc(0x157))var _0x3adc88=users[_0xadcacc(0x157)];else{if(_0x847d7a[0x0][_0xadcacc(0x158)]==_0xadcacc(0x18f))var _0x3adc88=users[_0xadcacc(0x18f)];else{if(_0x847d7a[0x0]['language']==_0xadcacc(0x190))var _0x3adc88=users[_0xadcacc(0x197)];else{if(_0x847d7a[0x0]['language']=='Chinese')var _0x3adc88=users[_0xadcacc(0x151)];else{if(_0x847d7a[0x0][_0xadcacc(0x158)]==_0xadcacc(0x19c))var _0x3adc88=users['Arabic'];}}}}}}}_0x46e4d4[_0xadcacc(0x19a)]('customer',{'success':_0xb2fc5[_0xadcacc(0x18a)](_0xadcacc(0x15c)),'errors':_0xb2fc5['flash']('errors'),'user':_0x210521,'role':_0x1bbd03,'profile':_0x56d919,'payment':_0x3bab87,'master_shop':_0x847d7a,'language':_0x3adc88});}catch(_0x1a444e){console['log'](_0x1a444e);}}),router[a0_0x524b7a(0x18d)]('/view',auth,async(_0x5cd111,_0x30183e)=>{const _0x379d14=a0_0x524b7a;try{const {name:_0x57d148,address:_0x16ae55,mobile:_0x1b3d8e,email:_0x18229f,receivable:_0x19acfe,payable:_0x109c70,contactperson:_0x453ad3,landline:_0x18bc6e}=_0x5cd111[_0x379d14(0x198)],_0x54127c=new customer({'name':_0x57d148,'address':_0x16ae55,'mobile':_0x1b3d8e,'email':_0x18229f,'receivable':_0x19acfe,'payable':_0x109c70,'contactperson':_0x453ad3,'landline':_0x18bc6e}),_0x3c7107=await _0x54127c[_0x379d14(0x153)]();_0x5cd111[_0x379d14(0x18a)]('success','customer\x20add\x20successfully'),_0x30183e[_0x379d14(0x14e)]('/customer/view');}catch(_0x37d22f){console['log'](_0x37d22f);}}),router['get'](a0_0x524b7a(0x195),auth,async(_0x46c0e1,_0x47ec9f)=>{const _0x430f70=a0_0x524b7a;try{const {username:_0x2faba7,email:_0xcd0351,role:_0x2b6ff8}=_0x46c0e1['user'],_0xb40b5b=_0x46c0e1[_0x430f70(0x187)],_0xf6856e=await profile[_0x430f70(0x152)]({'email':_0xb40b5b[_0x430f70(0x159)]}),_0x2dd67b=await master_shop[_0x430f70(0x144)]();console[_0x430f70(0x13f)](_0x430f70(0x171),_0x2dd67b);const _0x22f516=_0x46c0e1[_0x430f70(0x141)]['id'],_0x8db995=await customer[_0x430f70(0x18b)](_0x22f516);if(_0x2dd67b[0x0][_0x430f70(0x158)]==_0x430f70(0x176)){var _0x126f3d=users[_0x430f70(0x161)];console['log'](_0x126f3d);}else{if(_0x2dd67b[0x0][_0x430f70(0x158)]==_0x430f70(0x182))var _0x126f3d=users[_0x430f70(0x182)];else{if(_0x2dd67b[0x0]['language']==_0x430f70(0x194))var _0x126f3d=users[_0x430f70(0x194)];else{if(_0x2dd67b[0x0]['language']==_0x430f70(0x157))var _0x126f3d=users[_0x430f70(0x157)];else{if(_0x2dd67b[0x0][_0x430f70(0x158)]=='French')var _0x126f3d=users[_0x430f70(0x18f)];else{if(_0x2dd67b[0x0][_0x430f70(0x158)]==_0x430f70(0x190))var _0x126f3d=users[_0x430f70(0x197)];else{if(_0x2dd67b[0x0][_0x430f70(0x158)]==_0x430f70(0x151))var _0x126f3d=users[_0x430f70(0x151)];else{if(_0x2dd67b[0x0][_0x430f70(0x158)]==_0x430f70(0x19c))var _0x126f3d=users[_0x430f70(0x175)];}}}}}}}_0x47ec9f['render'](_0x430f70(0x16d),{'success':_0x46c0e1[_0x430f70(0x18a)](_0x430f70(0x15c)),'errors':_0x46c0e1[_0x430f70(0x18a)](_0x430f70(0x1a0)),'role':_0xb40b5b,'profile':_0xf6856e,'user':_0x8db995,'master_shop':_0x2dd67b,'language':_0x126f3d});}catch(_0x3f6775){console['log'](_0x3f6775);}}),router['post']('/view/:id',auth,async(_0xdbea92,_0x26f37d)=>{const _0x2195b0=a0_0x524b7a;try{const _0x5dc212=_0xdbea92[_0x2195b0(0x141)]['id'],_0x12b420=await customer[_0x2195b0(0x18b)](_0x5dc212),{name:_0x2e8a5b,address:_0x4da026,mobile:_0x42394b,email:_0xccfc71,receivable:_0x525e6d,payable:_0x3edf08,contactperson:_0x560b8b,landline:_0x5b3a12}=_0xdbea92['body'];_0x12b420['name']=_0x2e8a5b,_0x12b420[_0x2195b0(0x191)]=_0x4da026,_0x12b420[_0x2195b0(0x1a6)]=_0x42394b,_0x12b420[_0x2195b0(0x159)]=_0xccfc71,_0x12b420[_0x2195b0(0x17d)]=_0x525e6d,_0x12b420[_0x2195b0(0x19d)]=_0x3edf08,_0x12b420['contactperson']=_0x560b8b,_0x12b420['landline']=_0x5b3a12;const _0x4f9514=await _0x12b420[_0x2195b0(0x153)]();_0xdbea92['flash'](_0x2195b0(0x15c),'customer\x20update\x20successfully'),_0x26f37d['redirect'](_0x2195b0(0x147));}catch(_0x18ff30){console[_0x2195b0(0x13f)](_0x18ff30);}}),router[a0_0x524b7a(0x174)]('/view/payment/:id',auth,async(_0x37e96b,_0x1cb3c6)=>{const _0x2ec19c=a0_0x524b7a;try{const {username:_0xbef878,email:_0x29d2c9,role:_0x3f1fb5}=_0x37e96b[_0x2ec19c(0x187)],_0x18128b=_0x37e96b[_0x2ec19c(0x187)],_0x5131c2=await profile[_0x2ec19c(0x152)]({'email':_0x18128b[_0x2ec19c(0x159)]}),_0x30bf5b=await master_shop[_0x2ec19c(0x144)]();console[_0x2ec19c(0x13f)](_0x2ec19c(0x171),_0x30bf5b),console[_0x2ec19c(0x13f)](_0x37e96b[_0x2ec19c(0x141)]['id']);const _0x27ced9=await customer[_0x2ec19c(0x152)]({'_id':_0x37e96b[_0x2ec19c(0x141)]['id']});console['log'](_0x2ec19c(0x16a),_0x27ced9);const _0x2aba70=await c_payment_data[_0x2ec19c(0x144)]({'customer':_0x27ced9[_0x2ec19c(0x172)]});console[_0x2ec19c(0x13f)](_0x2aba70);const _0x112baa=await c_payment_data[_0x2ec19c(0x1a3)]([{'$match':{'customer':_0x27ced9[_0x2ec19c(0x172)]}},{'$match':{'reason':'Sale'}},{'$group':{'_id':_0x2ec19c(0x185),'sum':{'$sum':'$amount'}}}]);console[_0x2ec19c(0x13f)](_0x2ec19c(0x146),_0x112baa);const _0x5ba723=await c_payment_data[_0x2ec19c(0x1a3)]([{'$match':{'customer':_0x27ced9['name']}},{'$match':{'reason':_0x2ec19c(0x1a4)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x2ec19c(0x145)}}}]);console[_0x2ec19c(0x13f)]('receivable_sum',_0x5ba723);if(_0x30bf5b[0x0]['language']==_0x2ec19c(0x176)){var _0x1268aa=users[_0x2ec19c(0x161)];console[_0x2ec19c(0x13f)](_0x1268aa);}else{if(_0x30bf5b[0x0][_0x2ec19c(0x158)]==_0x2ec19c(0x182))var _0x1268aa=users[_0x2ec19c(0x182)];else{if(_0x30bf5b[0x0]['language']==_0x2ec19c(0x194))var _0x1268aa=users[_0x2ec19c(0x194)];else{if(_0x30bf5b[0x0]['language']==_0x2ec19c(0x157))var _0x1268aa=users[_0x2ec19c(0x157)];else{if(_0x30bf5b[0x0][_0x2ec19c(0x158)]==_0x2ec19c(0x18f))var _0x1268aa=users['French'];else{if(_0x30bf5b[0x0][_0x2ec19c(0x158)]=='Portuguese\x20(BR)')var _0x1268aa=users[_0x2ec19c(0x197)];else{if(_0x30bf5b[0x0]['language']==_0x2ec19c(0x151))var _0x1268aa=users[_0x2ec19c(0x151)];else{if(_0x30bf5b[0x0]['language']==_0x2ec19c(0x19c))var _0x1268aa=users['Arabic'];}}}}}}}_0x1cb3c6[_0x2ec19c(0x19a)](_0x2ec19c(0x15b),{'success':_0x37e96b[_0x2ec19c(0x18a)]('success'),'errors':_0x37e96b[_0x2ec19c(0x18a)](_0x2ec19c(0x1a0)),'role':_0x18128b,'profile':_0x5131c2,'payment':_0x2aba70,'payable':_0x112baa,'receivable':_0x5ba723,'master_shop':_0x30bf5b,'language':_0x1268aa});}catch(_0x1b2e8d){console[_0x2ec19c(0x13f)](_0x1b2e8d);}}),router[a0_0x524b7a(0x174)]('/products_export_migrate_file',auth,async(_0x370f01,_0x507a45)=>{const _0x33bf36=a0_0x524b7a;try{const _0x533b22=new excelJS[(_0x33bf36(0x178))](),_0x135086=_0x533b22[_0x33bf36(0x186)](_0x33bf36(0x183));return _0x135086['columns']=[{'header':'ID','key':_0x33bf36(0x173),'width':0xa},{'header':_0x33bf36(0x1a2),'key':_0x33bf36(0x150),'width':0xa},{'header':_0x33bf36(0x143),'key':'PUnits','width':0xa},{'header':'SalesmanName','key':'SalesmanName','width':0xa},{'header':_0x33bf36(0x191),'key':_0x33bf36(0x191),'width':0xa},{'header':_0x33bf36(0x1a6),'key':_0x33bf36(0x1a6),'width':0xa},{'header':_0x33bf36(0x159),'key':_0x33bf36(0x159),'width':0xa}],_0x507a45[_0x33bf36(0x16e)](_0x33bf36(0x169),_0x33bf36(0x16c)),_0x507a45[_0x33bf36(0x16e)]('Content-Disposition',_0x33bf36(0x14c)),_0x533b22[_0x33bf36(0x17b)][_0x33bf36(0x17a)](_0x507a45)[_0x33bf36(0x15f)](()=>{const _0x454f42=_0x33bf36;_0x507a45[_0x454f42(0x160)](0xc8);});}catch(_0x3c4d97){_0x507a45[_0x33bf36(0x160)](0x190)[_0x33bf36(0x156)]({'errors':_0x3c4d97[_0x33bf36(0x184)]});}});const storage1=multer[a0_0x524b7a(0x17c)]({'destination':(_0x566da3,_0xf60722,_0x3a2a57)=>{const _0x3349fc=a0_0x524b7a;_0x3a2a57(null,_0x3349fc(0x154));},'filename':(_0x5e14f3,_0x28709a,_0x3c8791)=>{const _0xea1983=a0_0x524b7a;_0x3c8791(null,Date['now']()+_0x28709a[_0xea1983(0x164)]);}}),uploadMigrate=multer({'storage':storage1});router[a0_0x524b7a(0x18d)](a0_0x524b7a(0x193),auth,uploadMigrate[a0_0x524b7a(0x163)](a0_0x524b7a(0x149)),async(_0x95515b,_0x1e8751)=>{const _0x20f0e0=a0_0x524b7a,_0x664af9=_0x95515b[_0x20f0e0(0x15d)][_0x20f0e0(0x189)],_0x23fec1=await xlsx[_0x20f0e0(0x16f)](_0x20f0e0(0x16b)+_0x664af9);let _0x26486a=_0x23fec1['SheetNames'],_0x535950=xlsx[_0x20f0e0(0x166)][_0x20f0e0(0x155)](_0x23fec1['Sheets'][_0x26486a[0x0]]);for(const _0x2bf366 of _0x535950){const _0x369603=_0x2bf366['ID'],_0x177eb1=_0x2bf366['Name'],_0x49092a=_0x2bf366[_0x20f0e0(0x143)],_0x22637e=_0x2bf366[_0x20f0e0(0x180)],_0x195a22=_0x2bf366[_0x20f0e0(0x191)],_0x448a78=_0x2bf366[_0x20f0e0(0x1a6)],_0x37d59f=_0x2bf366['email'];try{let _0x25fff5=await customer['findOne']({'name':_0x177eb1});if(!_0x25fff5){const _0x183b0d=new customer({'name':_0x177eb1,'ID':_0x369603,'SalesmanCode':_0x49092a,'SalesmanName':_0x22637e,'address':_0x195a22,'mobile':_0x448a78,'email':_0x37d59f});_0x25fff5=await _0x183b0d[_0x20f0e0(0x153)](),_0x95515b[_0x20f0e0(0x18a)](_0x20f0e0(0x15c),_0x177eb1+'\x20added\x20successfully');}else _0x95515b[_0x20f0e0(0x18a)](_0x20f0e0(0x15a),_0x177eb1+_0x20f0e0(0x18c));}catch(_0x3ffb28){_0x1e8751[_0x20f0e0(0x160)](0x1f4)[_0x20f0e0(0x148)]({'proderror':_0x3ffb28['message'],'aproduct':ProductName});}}_0x1e8751[_0x20f0e0(0x14e)](_0x20f0e0(0x147));}),module[a0_0x524b7a(0x179)]=router;