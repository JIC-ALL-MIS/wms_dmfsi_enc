function a0_0x11f4(){const _0x3c6de1=['now','findById','SheetNames','express','find','PUnits','../models/all_models','amount','sale','sale_return','PName','send','German','/customer_import_migrate_file','receivable','log','write','148kqpXxS','errors','Portuguese','English\x20(US)','email','payment_data','2474964PWhfeN','public/Migration','Portuguese\x20(BR)','\x20added\x20successfully','save','aggregate','filename','reason','landline','33KWQJIw','customer\x20update\x20successfully','\x20Failed','/view','address','master','readFile','post','c_payments','xlsx','../public/language/languages.json','SalesmanName','multer','Chinese','2uCtMOf','flash','Customers','language','then','24IAvLWa','customer_data','params','render','mobile','columns','originalname','diskStorage','name','/view/payment/:id','findOne','English','/view/:id','json','body','PBrands','599206qveero','data','$reason','1251820VkbwNX','exports','/customer/view','18655MUEPfw','contactperson','Workbook','../middleware/auth','setHeader','success','customer','public/Migration/','$amount','Arabic\x20(ae)','file','message','single','error','French','Spanish','Hindi','4667845gUdkFA','customer_payment','attachment;\x20filename=customer_Migration_File.xlsx','get','redirect','payable_sum','user','Arabic','status','/products_export_migrate_file','SalesmanCode','Sale\x20Return','1713423gXAdWp','Sale','4776654atYSaY'];a0_0x11f4=function(){return _0x3c6de1;};return a0_0x11f4();}const a0_0x30d95b=a0_0x42e8;function a0_0x42e8(_0x44bd73,_0xbd428b){const _0x11f48c=a0_0x11f4();return a0_0x42e8=function(_0x42e8f8,_0x491874){_0x42e8f8=_0x42e8f8-0x6e;let _0x2c2114=_0x11f48c[_0x42e8f8];return _0x2c2114;},a0_0x42e8(_0x44bd73,_0xbd428b);}(function(_0x557e31,_0x1d51f5){const _0x1ede2d=a0_0x42e8,_0x2707fd=_0x557e31();while(!![]){try{const _0x1e8d20=parseInt(_0x1ede2d(0x7f))/0x1*(-parseInt(_0x1ede2d(0x94))/0x2)+parseInt(_0x1ede2d(0xb7))/0x3+parseInt(_0x1ede2d(0xcb))/0x4*(-parseInt(_0x1ede2d(0x9a))/0x5)+parseInt(_0x1ede2d(0xb9))/0x6+-parseInt(_0x1ede2d(0xab))/0x7+parseInt(_0x1ede2d(0x84))/0x8*(parseInt(_0x1ede2d(0xd1))/0x9)+-parseInt(_0x1ede2d(0x97))/0xa*(parseInt(_0x1ede2d(0x71))/0xb);if(_0x1e8d20===_0x1d51f5)break;else _0x2707fd['push'](_0x2707fd['shift']());}catch(_0x1005ab){_0x2707fd['push'](_0x2707fd['shift']());}}}(a0_0x11f4,0x64bbc));const express=require(a0_0x30d95b(0xbd)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,customer_payment,c_payment_data,sing_up}=require(a0_0x30d95b(0xc0)),auth=require(a0_0x30d95b(0x9d)),users=require(a0_0x30d95b(0x7b)),excelJS=require('exceljs'),xlsx=require(a0_0x30d95b(0x7a)),multer=require(a0_0x30d95b(0x7d));router[a0_0x30d95b(0xae)]('/view',auth,async(_0x345804,_0x28a73b)=>{const _0x11840e=a0_0x30d95b;try{const {username:_0x39fb78,email:_0x502f61,role:_0x2f59f3}=_0x345804[_0x11840e(0xb1)],_0x32848b=_0x345804['user'],_0x4a9046=await profile[_0x11840e(0x8e)]({'email':_0x32848b['email']}),_0x3014d8=await master_shop[_0x11840e(0xbe)]();console['log'](_0x11840e(0x76),_0x3014d8);const _0x3cd0de=await customer[_0x11840e(0xbe)](),_0x48efdb=await customer[_0x11840e(0xd6)]([{'$lookup':{'from':_0x11840e(0x79),'localField':_0x11840e(0x8c),'foreignField':_0x11840e(0xa0),'as':'customer_docs'}}]);console[_0x11840e(0xc9)](_0x48efdb);const _0x868808=_0x48efdb['map'](_0x2bc363=>{const _0x44d845=_0x11840e;console[_0x44d845(0xc9)](_0x44d845(0x95),_0x2bc363);var _0x87d8d9=0x0,_0x5ee7b6=0x0;return _0x2bc363['customer_docs']['forEach'](_0x7dc44e=>{const _0x8b944e=_0x44d845;console[_0x8b944e(0xc9)]('element',_0x7dc44e),_0x7dc44e[_0x8b944e(0x6f)]==_0x8b944e(0xb8)?_0x87d8d9+=_0x7dc44e[_0x8b944e(0xc1)]:_0x5ee7b6+=_0x7dc44e[_0x8b944e(0xc1)];}),_0x2bc363[_0x44d845(0xc2)]=parseFloat(_0x87d8d9)+0x0,_0x2bc363[_0x44d845(0xc3)]=parseFloat(_0x5ee7b6)+0x0,_0x2bc363;});console[_0x11840e(0xc9)](_0x11840e(0xd0),_0x868808);if(_0x3014d8[0x0][_0x11840e(0x82)]==_0x11840e(0xce)){var _0x38c241=users['English'];console[_0x11840e(0xc9)](_0x38c241);}else{if(_0x3014d8[0x0][_0x11840e(0x82)]==_0x11840e(0xaa))var _0x38c241=users['Hindi'];else{if(_0x3014d8[0x0][_0x11840e(0x82)]==_0x11840e(0xc6))var _0x38c241=users[_0x11840e(0xc6)];else{if(_0x3014d8[0x0]['language']==_0x11840e(0xa9))var _0x38c241=users[_0x11840e(0xa9)];else{if(_0x3014d8[0x0]['language']==_0x11840e(0xa8))var _0x38c241=users['French'];else{if(_0x3014d8[0x0][_0x11840e(0x82)]==_0x11840e(0xd3))var _0x38c241=users[_0x11840e(0xcd)];else{if(_0x3014d8[0x0]['language']==_0x11840e(0x7e))var _0x38c241=users[_0x11840e(0x7e)];else{if(_0x3014d8[0x0][_0x11840e(0x82)]=='Arabic\x20(ae)')var _0x38c241=users[_0x11840e(0xb2)];}}}}}}}_0x28a73b[_0x11840e(0x87)](_0x11840e(0xa0),{'success':_0x345804[_0x11840e(0x80)](_0x11840e(0x9f)),'errors':_0x345804[_0x11840e(0x80)](_0x11840e(0xcc)),'user':_0x3cd0de,'role':_0x32848b,'profile':_0x4a9046,'payment':_0x868808,'master_shop':_0x3014d8,'language':_0x38c241});}catch(_0x544be1){console['log'](_0x544be1);}}),router[a0_0x30d95b(0x78)](a0_0x30d95b(0x74),auth,async(_0x3c78d5,_0x1a8b8f)=>{const _0x380612=a0_0x30d95b;try{const {name:_0x3f29d7,address:_0x4d4e31,mobile:_0x43786,email:_0x35456c,receivable:_0x274722,payable:_0x325e05,contactperson:_0x52b116,landline:_0x12185d}=_0x3c78d5['body'],_0x7d15e7=new customer({'name':_0x3f29d7,'address':_0x4d4e31,'mobile':_0x43786,'email':_0x35456c,'receivable':_0x274722,'payable':_0x325e05,'contactperson':_0x52b116,'landline':_0x12185d}),_0x3c7661=await _0x7d15e7[_0x380612(0xd5)]();_0x3c78d5[_0x380612(0x80)](_0x380612(0x9f),'customer\x20add\x20successfully'),_0x1a8b8f[_0x380612(0xaf)](_0x380612(0x99));}catch(_0x4a40ce){console[_0x380612(0xc9)](_0x4a40ce);}}),router[a0_0x30d95b(0xae)](a0_0x30d95b(0x90),auth,async(_0x19690c,_0xdbdd5f)=>{const _0x2a9391=a0_0x30d95b;try{const {username:_0x380357,email:_0x52216f,role:_0x13a891}=_0x19690c['user'],_0x432cec=_0x19690c['user'],_0x5e763c=await profile[_0x2a9391(0x8e)]({'email':_0x432cec[_0x2a9391(0xcf)]}),_0x4025ed=await master_shop['find']();console[_0x2a9391(0xc9)](_0x2a9391(0x76),_0x4025ed);const _0x376cf5=_0x19690c['params']['id'],_0x1671ba=await customer[_0x2a9391(0xbb)](_0x376cf5);if(_0x4025ed[0x0][_0x2a9391(0x82)]=='English\x20(US)'){var _0x2ba898=users[_0x2a9391(0x8f)];console[_0x2a9391(0xc9)](_0x2ba898);}else{if(_0x4025ed[0x0]['language']==_0x2a9391(0xaa))var _0x2ba898=users[_0x2a9391(0xaa)];else{if(_0x4025ed[0x0][_0x2a9391(0x82)]=='German')var _0x2ba898=users[_0x2a9391(0xc6)];else{if(_0x4025ed[0x0][_0x2a9391(0x82)]=='Spanish')var _0x2ba898=users[_0x2a9391(0xa9)];else{if(_0x4025ed[0x0][_0x2a9391(0x82)]=='French')var _0x2ba898=users[_0x2a9391(0xa8)];else{if(_0x4025ed[0x0][_0x2a9391(0x82)]==_0x2a9391(0xd3))var _0x2ba898=users[_0x2a9391(0xcd)];else{if(_0x4025ed[0x0]['language']==_0x2a9391(0x7e))var _0x2ba898=users[_0x2a9391(0x7e)];else{if(_0x4025ed[0x0][_0x2a9391(0x82)]=='Arabic\x20(ae)')var _0x2ba898=users['Arabic'];}}}}}}}_0xdbdd5f[_0x2a9391(0x87)](_0x2a9391(0xa0),{'success':_0x19690c['flash']('success'),'errors':_0x19690c[_0x2a9391(0x80)](_0x2a9391(0xcc)),'role':_0x432cec,'profile':_0x5e763c,'user':_0x1671ba,'master_shop':_0x4025ed,'language':_0x2ba898});}catch(_0x118e13){console['log'](_0x118e13);}}),router[a0_0x30d95b(0x78)](a0_0x30d95b(0x90),auth,async(_0x3aff90,_0x587388)=>{const _0x5d971c=a0_0x30d95b;try{const _0x2c9dfa=_0x3aff90['params']['id'],_0x37482d=await customer[_0x5d971c(0xbb)](_0x2c9dfa),{name:_0x26e05f,address:_0x1bc336,mobile:_0x5beef1,email:_0x483941,receivable:_0x31eabf,payable:_0x2b62b7,contactperson:_0x1cdfd3,landline:_0x57a3de}=_0x3aff90[_0x5d971c(0x92)];_0x37482d[_0x5d971c(0x8c)]=_0x26e05f,_0x37482d[_0x5d971c(0x75)]=_0x1bc336,_0x37482d['mobile']=_0x5beef1,_0x37482d[_0x5d971c(0xcf)]=_0x483941,_0x37482d[_0x5d971c(0xc8)]=_0x31eabf,_0x37482d['payable']=_0x2b62b7,_0x37482d[_0x5d971c(0x9b)]=_0x1cdfd3,_0x37482d[_0x5d971c(0x70)]=_0x57a3de;const _0x564f1d=await _0x37482d['save']();_0x3aff90[_0x5d971c(0x80)](_0x5d971c(0x9f),_0x5d971c(0x72)),_0x587388[_0x5d971c(0xaf)](_0x5d971c(0x99));}catch(_0x3f77d2){console[_0x5d971c(0xc9)](_0x3f77d2);}}),router[a0_0x30d95b(0xae)](a0_0x30d95b(0x8d),auth,async(_0x4117ee,_0x52c477)=>{const _0x266cde=a0_0x30d95b;try{const {username:_0x46fb29,email:_0x16eb84,role:_0x289727}=_0x4117ee[_0x266cde(0xb1)],_0x5b6707=_0x4117ee['user'],_0xa9936f=await profile['findOne']({'email':_0x5b6707['email']}),_0x329e6d=await master_shop[_0x266cde(0xbe)]();console[_0x266cde(0xc9)](_0x266cde(0x76),_0x329e6d),console[_0x266cde(0xc9)](_0x4117ee[_0x266cde(0x86)]['id']);const _0x229c5a=await customer['findOne']({'_id':_0x4117ee[_0x266cde(0x86)]['id']});console[_0x266cde(0xc9)](_0x266cde(0x85),_0x229c5a);const _0x1a9ee2=await c_payment_data[_0x266cde(0xbe)]({'customer':_0x229c5a[_0x266cde(0x8c)]});console['log'](_0x1a9ee2);const _0x48756f=await c_payment_data[_0x266cde(0xd6)]([{'$match':{'customer':_0x229c5a['name']}},{'$match':{'reason':_0x266cde(0xb8)}},{'$group':{'_id':_0x266cde(0x96),'sum':{'$sum':_0x266cde(0xa2)}}}]);console['log'](_0x266cde(0xb0),_0x48756f);const _0x1d956f=await c_payment_data[_0x266cde(0xd6)]([{'$match':{'customer':_0x229c5a[_0x266cde(0x8c)]}},{'$match':{'reason':_0x266cde(0xb6)}},{'$group':{'_id':'$reason','sum':{'$sum':_0x266cde(0xa2)}}}]);console['log']('receivable_sum',_0x1d956f);if(_0x329e6d[0x0][_0x266cde(0x82)]==_0x266cde(0xce)){var _0x3d3b91=users[_0x266cde(0x8f)];console[_0x266cde(0xc9)](_0x3d3b91);}else{if(_0x329e6d[0x0]['language']==_0x266cde(0xaa))var _0x3d3b91=users['Hindi'];else{if(_0x329e6d[0x0][_0x266cde(0x82)]=='German')var _0x3d3b91=users[_0x266cde(0xc6)];else{if(_0x329e6d[0x0][_0x266cde(0x82)]==_0x266cde(0xa9))var _0x3d3b91=users[_0x266cde(0xa9)];else{if(_0x329e6d[0x0]['language']==_0x266cde(0xa8))var _0x3d3b91=users[_0x266cde(0xa8)];else{if(_0x329e6d[0x0]['language']==_0x266cde(0xd3))var _0x3d3b91=users[_0x266cde(0xcd)];else{if(_0x329e6d[0x0][_0x266cde(0x82)]==_0x266cde(0x7e))var _0x3d3b91=users['Chinese'];else{if(_0x329e6d[0x0][_0x266cde(0x82)]==_0x266cde(0xa3))var _0x3d3b91=users[_0x266cde(0xb2)];}}}}}}}_0x52c477[_0x266cde(0x87)](_0x266cde(0xac),{'success':_0x4117ee[_0x266cde(0x80)](_0x266cde(0x9f)),'errors':_0x4117ee['flash'](_0x266cde(0xcc)),'role':_0x5b6707,'profile':_0xa9936f,'payment':_0x1a9ee2,'payable':_0x48756f,'receivable':_0x1d956f,'master_shop':_0x329e6d,'language':_0x3d3b91});}catch(_0x162ff6){console[_0x266cde(0xc9)](_0x162ff6);}}),router[a0_0x30d95b(0xae)](a0_0x30d95b(0xb4),auth,async(_0x17beea,_0x2a8614)=>{const _0x17a492=a0_0x30d95b;try{const _0x5119fb=new excelJS[(_0x17a492(0x9c))](),_0x428043=_0x5119fb['addWorksheet'](_0x17a492(0x81));return _0x428043[_0x17a492(0x89)]=[{'header':'ID','key':_0x17a492(0xc4),'width':0xa},{'header':'Name','key':_0x17a492(0x93),'width':0xa},{'header':_0x17a492(0xb5),'key':_0x17a492(0xbf),'width':0xa},{'header':'SalesmanName','key':_0x17a492(0x7c),'width':0xa},{'header':_0x17a492(0x75),'key':'address','width':0xa},{'header':_0x17a492(0x88),'key':_0x17a492(0x88),'width':0xa},{'header':_0x17a492(0xcf),'key':_0x17a492(0xcf),'width':0xa}],_0x2a8614[_0x17a492(0x9e)]('Content-Type','application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x2a8614[_0x17a492(0x9e)]('Content-Disposition',_0x17a492(0xad)),_0x5119fb[_0x17a492(0x7a)][_0x17a492(0xca)](_0x2a8614)[_0x17a492(0x83)](()=>{const _0x5a2678=_0x17a492;_0x2a8614[_0x5a2678(0xb3)](0xc8);});}catch(_0x33210d){_0x2a8614[_0x17a492(0xb3)](0x190)[_0x17a492(0xc5)]({'errors':_0x33210d[_0x17a492(0xa5)]});}});const storage1=multer[a0_0x30d95b(0x8b)]({'destination':(_0x40b86f,_0x3af248,_0x5026cc)=>{const _0x406b10=a0_0x30d95b;_0x5026cc(null,_0x406b10(0xd2));},'filename':(_0x2181be,_0x1fb1b2,_0x5e60bf)=>{const _0x4d048b=a0_0x30d95b;_0x5e60bf(null,Date[_0x4d048b(0xba)]()+_0x1fb1b2[_0x4d048b(0x8a)]);}}),uploadMigrate=multer({'storage':storage1});router['post'](a0_0x30d95b(0xc7),auth,uploadMigrate[a0_0x30d95b(0xa6)]('customer_product_fule'),async(_0x4d235b,_0x52c501)=>{const _0x3efefe=a0_0x30d95b,_0x3f22d0=_0x4d235b[_0x3efefe(0xa4)][_0x3efefe(0x6e)],_0x3d4b04=await xlsx[_0x3efefe(0x77)](_0x3efefe(0xa1)+_0x3f22d0);let _0xbbfbf3=_0x3d4b04[_0x3efefe(0xbc)],_0x51f23c=xlsx['utils']['sheet_to_json'](_0x3d4b04['Sheets'][_0xbbfbf3[0x0]]);for(const _0x17b193 of _0x51f23c){const _0x3d1d04=_0x17b193['ID'],_0x53b763=_0x17b193['Name'],_0x21761c=_0x17b193[_0x3efefe(0xb5)],_0x4d5535=_0x17b193[_0x3efefe(0x7c)],_0x377e53=_0x17b193[_0x3efefe(0x75)],_0x5e692d=_0x17b193[_0x3efefe(0x88)],_0x55b39f=_0x17b193['email'];try{let _0x24c7fc=await customer['findOne']({'name':_0x53b763});if(!_0x24c7fc){const _0x4fae66=new customer({'name':_0x53b763,'ID':_0x3d1d04,'SalesmanCode':_0x21761c,'SalesmanName':_0x4d5535,'address':_0x377e53,'mobile':_0x5e692d,'email':_0x55b39f});_0x24c7fc=await _0x4fae66[_0x3efefe(0xd5)](),_0x4d235b['flash'](_0x3efefe(0x9f),_0x53b763+_0x3efefe(0xd4));}else _0x4d235b[_0x3efefe(0x80)](_0x3efefe(0xa7),_0x53b763+_0x3efefe(0x73));}catch(_0x24a3ad){_0x52c501[_0x3efefe(0xb3)](0x1f4)[_0x3efefe(0x91)]({'proderror':_0x24a3ad[_0x3efefe(0xa5)],'aproduct':ProductName});}}_0x52c501[_0x3efefe(0xaf)](_0x3efefe(0x99));}),module[a0_0x30d95b(0x98)]=router;