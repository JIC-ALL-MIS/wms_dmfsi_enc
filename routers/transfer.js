var a0_0x11b028=a0_0x1cd1;(function(_0x9afb2f,_0x4bdd19){var _0xfa8523=a0_0x1cd1,_0x32551a=_0x9afb2f();while(!![]){try{var _0x5d4d37=-parseInt(_0xfa8523(0x2a8))/0x1+-parseInt(_0xfa8523(0x250))/0x2*(-parseInt(_0xfa8523(0x1fd))/0x3)+-parseInt(_0xfa8523(0x21e))/0x4+-parseInt(_0xfa8523(0x240))/0x5*(parseInt(_0xfa8523(0x1db))/0x6)+-parseInt(_0xfa8523(0x1e2))/0x7*(parseInt(_0xfa8523(0x24a))/0x8)+-parseInt(_0xfa8523(0x29e))/0x9+parseInt(_0xfa8523(0x297))/0xa;if(_0x5d4d37===_0x4bdd19)break;else _0x32551a['push'](_0x32551a['shift']());}catch(_0x5f5c60){_0x32551a['push'](_0x32551a['shift']());}}}(a0_0x1487,0x3d3d6));const express=require(a0_0x11b028(0x2c2)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x11b028(0x2a5)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x11b028(0x2ad));function a0_0x1487(){var _0x3a1c9c=['/barcode_scanner3','logo','prod_name','MaxStocks_data2','<tr>','json','language','<h2>\x20','from_prod_isle','from_storage','<div>','exports','user','get','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Product\x20Transfer\x20successfully','to_types','invoice','Receiving\x20Area','Shelves','sendMail','Chinese','An\x20error\x20occurred\x20while\x20saving\x20data.','/view','createTransport','6661080gHyXHu','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.secondary_code','add_transfer','Rack\x20F','flash','417177mGLTcA','from_room_name','TRF-','</td>','all','\x20Order\x20Number\x20:\x20','$from_warehouse','../middleware/auth','max_per_unit','here','123666EacVbm','$product_details.maxPerUnit','<strong>\x20Regards\x20</strong>','from_invoice','from_types','nodemailer','primary_code','To_invoice','$product_details.unit','<!DOCTYPE\x20html>','from_warehouse','staff','message','<h5\x20style=\x22text-align:\x20left;\x22>','log','Enclosed','warehouse','$product_details.maxProducts','COLD\x20STORAGE','getMonth','to_invoice','/barcode_scanner2','push','success','date','back','express','secondary_code','from_bin','from_rack','New_Qty_Converted','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','random','<h5>','rak','filter','$product_details.expiry_date','Enabled','Hindi','primary_unit','toString','note','Transfer\x20Finalize\x20Successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','_id','product_code3','639774WIPYVF','master','Arabic','image','bay','findById','</tr>','607075NqaPlg','id_transaction','$date','$product','product','rack','$product_details.storage','finalize','floorlevel','French','RMSEmail','catch','Portuguese\x20(BR)','RoomAssigned','$invoice','</thead>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','expiry_date','$_id','Rack\x20D','/picking_list/PDF_transfer_rm/','</table>','</span>','Logo.png','Error\x20Occurs','then','to_prod_pallet','141xljZtp','Spanish','$room','<span\x20style=\x22float:\x20right;\x22>','$product_details.bay','/view/add_transfer','to_floorlevel','<hr\x20class=\x22my-3\x22>','$product_details.product_code','maxperunit','string','German','to_prod_isle','</body></html>','host','type','redirect','product_details','Transfer\x20Mail','maxProducts','Rack\x20A','transfer','to_warehouse','Portuguese','unit','$product_details.floorlevel','product_code','findOne','to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Floor','from_rak','$product_details.pallet','917812BTWeoi','to_prod_qty','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</div>','params','from_bay','id_transaction_id','forEach','/barcode_scanner','/../public','to_bay','$product_details.product_stock','email','status','/CheckingWarehouse','$product_details.invoice','DRY\x20STORAGE','password','Arabic\x20(ae)','getDate','$product_details','$product_details.product_name','slice','<table\x20style=\x22width:\x20100%\x20!important;\x22>','ToRoomAssigned','$product_details.batch_code','prod_cat','</h5>','bin','from_prod_qty','/preview/:id','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.production_date','5eYjQBd','from_quantity','</tbody>','/transfer/view','</head><body>','padStart','$product_details.rack','error','errors','find','16iiZXgz','role','length','An\x20error\x20occurred.','to_bin','$isAllowEdit','11246ZXEQIh','map','Return\x20Rooms','split','$product_details.primary_code','product_stock','$product_details.type','$product_details.level','batch_code','\x20Order\x20Date\x20:\x20','\x20<>\x20','save','body','English','to_room','$product.from_room_name','from_prod_level','$finalize','to_quantity','site_title','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Level','secondary_unit','Rack\x20B','English\x20(US)','$product_details.bin','$name','$product_details.secondary_unit','post','edit_transfer','from_floorlevel','production_date','storage','Raw\x20Materials','render','$to_warehouse','concat','True','to_prod_level','updateOne','Ambient','$product_details.isle','<html><head><title></title>','/view/:id','\x20</h2>','$product_details._id'];a0_0x1487=function(){return _0x3a1c9c;};return a0_0x1487();}function a0_0x1cd1(_0x1b50c4,_0x407ef6){var _0x1487ce=a0_0x1487();return a0_0x1cd1=function(_0x1cd19c,_0x944afe){_0x1cd19c=_0x1cd19c-0x1cc;var _0x3bdadc=_0x1487ce[_0x1cd19c];return _0x3bdadc;},a0_0x1cd1(_0x1b50c4,_0x407ef6);}router[a0_0x11b028(0x28b)](a0_0x11b028(0x295),auth,async(_0x2b56f9,_0xadb3aa)=>{var _0xba6993=a0_0x11b028;try{const {username:_0x433741,email:_0x23b027,role:_0x25d166}=_0x2b56f9[_0xba6993(0x28a)],_0x5d4921=_0x2b56f9[_0xba6993(0x28a)],_0x4e3710=await profile[_0xba6993(0x218)]({'email':_0x5d4921[_0xba6993(0x22b)]}),_0x48ec1d=await master_shop[_0xba6993(0x249)]();console['log'](_0xba6993(0x1dc),_0x48ec1d);let _0x3d3316;if(_0x5d4921[_0xba6993(0x24b)]==_0xba6993(0x2b3)){const _0x22098f=await staff[_0xba6993(0x218)]({'email':_0x5d4921[_0xba6993(0x22b)]});_0x3d3316=await transfers[_0xba6993(0x249)]({'from_warehouse':_0x22098f['warehouse']});}else _0x3d3316=await transfers[_0xba6993(0x298)]([{'$unwind':_0xba6993(0x1e5)},{'$group':{'_id':_0xba6993(0x1f4),'invoice':{'$first':_0xba6993(0x1f0)},'date':{'$first':_0xba6993(0x1e4)},'from_warehouse':{'$first':_0xba6993(0x2a4)},'to_warehouse':{'$first':_0xba6993(0x273)},'from_room_name':{'$addToSet':_0xba6993(0x25f)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0xba6993(0x261)},'isAllowEdit':{'$first':_0xba6993(0x24f)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x48ec1d[0x0][_0xba6993(0x284)]=='English\x20(US)'){var _0x21f566=users[_0xba6993(0x25d)];console['log'](_0x21f566);}else{if(_0x48ec1d[0x0][_0xba6993(0x284)]==_0xba6993(0x1d3))var _0x21f566=users['Hindi'];else{if(_0x48ec1d[0x0]['language']=='German')var _0x21f566=users[_0xba6993(0x208)];else{if(_0x48ec1d[0x0][_0xba6993(0x284)]==_0xba6993(0x1fe))var _0x21f566=users[_0xba6993(0x1fe)];else{if(_0x48ec1d[0x0][_0xba6993(0x284)]==_0xba6993(0x1eb))var _0x21f566=users[_0xba6993(0x1eb)];else{if(_0x48ec1d[0x0][_0xba6993(0x284)]==_0xba6993(0x1ee))var _0x21f566=users[_0xba6993(0x214)];else{if(_0x48ec1d[0x0]['language']==_0xba6993(0x293))var _0x21f566=users[_0xba6993(0x293)];else{if(_0x48ec1d[0x0][_0xba6993(0x284)]==_0xba6993(0x231))var _0x21f566=users[_0xba6993(0x1dd)];}}}}}}}_0xadb3aa[_0xba6993(0x272)](_0xba6993(0x212),{'success':_0x2b56f9[_0xba6993(0x29d)](_0xba6993(0x2bf)),'errors':_0x2b56f9[_0xba6993(0x29d)]('errors'),'role':_0x5d4921,'profile':_0x4e3710,'master_shop':_0x48ec1d,'transfer':_0x3d3316,'language':_0x21f566});}catch(_0x5dc197){console[_0xba6993(0x2b6)](_0x5dc197);}});async function getRandom8DigitNumber(){var _0x2428f2=a0_0x11b028;const _0x5a4037=0x989680,_0x5bc406=0x5f5e0ff,_0x55915c=Math['floor'](Math[_0x2428f2(0x1cd)]()*(_0x5bc406-_0x5a4037+0x1))+_0x5a4037;var _0x585890;const _0xcb4eae=await transfers[_0x2428f2(0x218)]({'invoice':_0x2428f2(0x2a0)+_0x55915c});return _0xcb4eae&&_0xcb4eae[_0x2428f2(0x24c)]>0x0?_0x585890=_0x2428f2(0x2a0)+_0x55915c:_0x585890=_0x2428f2(0x2a0)+_0x55915c,_0x585890;}router[a0_0x11b028(0x28b)](a0_0x11b028(0x202),auth,async(_0x91da4e,_0x1ff0b8)=>{var _0x532ff7=a0_0x11b028;try{const {username:_0x1f7929,email:_0x48a6ec,role:_0x41fbe8}=_0x91da4e[_0x532ff7(0x28a)],_0x565d3b=_0x91da4e['user'],_0x2c43f7=await profile[_0x532ff7(0x218)]({'email':_0x565d3b[_0x532ff7(0x22b)]}),_0x5a352d=await master_shop[_0x532ff7(0x249)]();console[_0x532ff7(0x2b6)](_0x532ff7(0x1dc),_0x5a352d);let _0x888de1;if(_0x565d3b[_0x532ff7(0x24b)]==_0x532ff7(0x2b3)){const _0x164289=await staff[_0x532ff7(0x218)]({'email':_0x565d3b['email']});_0x888de1=await warehouse[_0x532ff7(0x298)]([{'$match':{'status':'Enabled','name':_0x164289['warehouse'],'warehouse_category':_0x532ff7(0x271)}},{'$group':{'_id':_0x532ff7(0x26a),'name':{'$first':_0x532ff7(0x26a)}}}]);}else _0x888de1=await warehouse[_0x532ff7(0x298)]([{'$match':{'status':_0x532ff7(0x1d2),'warehouse_category':_0x532ff7(0x271)}},{'$group':{'_id':_0x532ff7(0x26a),'name':{'$first':_0x532ff7(0x26a)}}}]);var _0x29cf81=[_0x532ff7(0x278),_0x532ff7(0x2b7),_0x532ff7(0x252)];const _0x616ab3=await transfers[_0x532ff7(0x249)]({}),_0x3dd492=_0x616ab3[_0x532ff7(0x24c)]+0x1,_0x54b682=_0x532ff7(0x2a0)+_0x3dd492[_0x532ff7(0x1d5)]()[_0x532ff7(0x245)](0x5,'0');if(_0x5a352d[0x0]['language']==_0x532ff7(0x268)){var _0xd7a7c7=users[_0x532ff7(0x25d)];console[_0x532ff7(0x2b6)](_0xd7a7c7);}else{if(_0x5a352d[0x0][_0x532ff7(0x284)]==_0x532ff7(0x1d3))var _0xd7a7c7=users['Hindi'];else{if(_0x5a352d[0x0]['language']=='German')var _0xd7a7c7=users[_0x532ff7(0x208)];else{if(_0x5a352d[0x0][_0x532ff7(0x284)]==_0x532ff7(0x1fe))var _0xd7a7c7=users['Spanish'];else{if(_0x5a352d[0x0][_0x532ff7(0x284)]==_0x532ff7(0x1eb))var _0xd7a7c7=users[_0x532ff7(0x1eb)];else{if(_0x5a352d[0x0][_0x532ff7(0x284)]==_0x532ff7(0x1ee))var _0xd7a7c7=users[_0x532ff7(0x214)];else{if(_0x5a352d[0x0][_0x532ff7(0x284)]==_0x532ff7(0x293))var _0xd7a7c7=users[_0x532ff7(0x293)];else{if(_0x5a352d[0x0][_0x532ff7(0x284)]==_0x532ff7(0x231))var _0xd7a7c7=users[_0x532ff7(0x1dd)];}}}}}}}const _0x7922f9=getRandom8DigitNumber();_0x7922f9[_0x532ff7(0x1fb)](_0x5d2245=>{var _0x20d36c=_0x532ff7;_0x1ff0b8[_0x20d36c(0x272)](_0x20d36c(0x29b),{'success':_0x91da4e[_0x20d36c(0x29d)](_0x20d36c(0x2bf)),'errors':_0x91da4e[_0x20d36c(0x29d)](_0x20d36c(0x248)),'role':_0x565d3b,'profile':_0x2c43f7,'master_shop':_0x5a352d,'warehouse':_0x888de1,'language':_0xd7a7c7,'rooms_data':_0x29cf81,'invoice':_0x5d2245});})[_0x532ff7(0x1ed)](_0xcd2c1f=>{var _0x1ec491=_0x532ff7;_0x91da4e['flash'](_0x1ec491(0x248),_0x1ec491(0x264)),_0x1ff0b8['redirect'](_0x1ec491(0x243));});}catch(_0x5c449e){console['log'](_0x5c449e);}}),router['post'](a0_0x11b028(0x202),auth,async(_0x3cca5e,_0x3da3ed)=>{var _0x44761e=a0_0x11b028;try{console[_0x44761e(0x2b6)](_0x3cca5e[_0x44761e(0x25c)]);const {date:_0x5d7c8d,from_warehouse:_0x53e763,FromRoom_name:_0x44f5c8,to_warehouse:_0x402ec7,ToRoom_name:_0x59c646,prod_name:_0x307fbe,from_prod_qty:_0x5cf67e,from_prod_level:_0x53d316,from_prod_isle:_0xc0a023,from_prod_pallet:_0x5f196f,to_prod_qty:_0x388317,to_prod_level:_0x2ece04,to_prod_isle:_0x3242a6,to_prod_pallet:_0x1655be,primary_code:_0x28e0c6,secondary_code:_0x540f73,product_code3:_0x47485d,note:_0x3cdc84,MaxStocks_data2:_0x287ddc,invoice:_0x1c1003,expiry_date:_0x5c25d2}=_0x3cca5e[_0x44761e(0x25c)];if(typeof _0x307fbe==_0x44761e(0x207))var _0x2d3d65=[_0x3cca5e['body']['prod_name']],_0x23c976=[_0x3cca5e['body'][_0x44761e(0x23c)]],_0x5577bd=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x260)]],_0x166773=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2c6)]],_0x47bbd8=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x276)]],_0x2c3fbd=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2ae)]],_0x11e65d=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2c3)]],_0x602f0b=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x1da)]],_0x34c3a5=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x281)]],_0x1427db=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x1d4)]],_0x5677cf=[_0x3cca5e['body']['secondary_unit']],_0x1a53ba=[_0x3cca5e[_0x44761e(0x25c)]['batch_code']],_0x85506b=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x1f3)]],_0x188586=[_0x3cca5e[_0x44761e(0x25c)]['max_per_unit']],_0x54e9a1=[_0x3cca5e[_0x44761e(0x25c)]['production_date']],_0xf56c67=[_0x3cca5e['body'][_0x44761e(0x239)]],_0x24391d=[_0x3cca5e['body'][_0x44761e(0x1ef)]],_0x309cb5=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x237)]],_0x8677a2=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2ab)]],_0x1c4eec=[_0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2bc)]],_0x15ab76=[_0x3cca5e['body'][_0x44761e(0x1e3)]];else var _0x2d3d65=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x280)]],_0x23c976=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x23c)]],_0x5577bd=[..._0x3cca5e[_0x44761e(0x25c)]['from_prod_level']],_0x166773=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2c6)]],_0x47bbd8=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x276)]],_0x2c3fbd=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2ae)]],_0x11e65d=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2c3)]],_0x602f0b=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x1da)]],_0x34c3a5=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x281)]],_0x1427db=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x1d4)]],_0x5677cf=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x266)]],_0x1a53ba=[..._0x3cca5e['body'][_0x44761e(0x258)]],_0x85506b=[..._0x3cca5e['body'][_0x44761e(0x1f3)]],_0x188586=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2a6)]],_0x54e9a1=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x26f)]],_0xf56c67=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x239)]],_0x24391d=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x1ef)]],_0x309cb5=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x237)]],_0x8677a2=[..._0x3cca5e[_0x44761e(0x25c)]['from_invoice']],_0x1c4eec=[..._0x3cca5e[_0x44761e(0x25c)][_0x44761e(0x2bc)]],_0x15ab76=[..._0x3cca5e[_0x44761e(0x25c)]['id_transaction']];const _0x5a93ff=_0x2d3d65[_0x44761e(0x251)](_0x1ddab7=>{return _0x1ddab7={'product_name':_0x1ddab7};});_0x23c976['forEach']((_0x38c83d,_0x5157b4)=>{var _0x7a193a=_0x44761e;_0x5a93ff[_0x5157b4][_0x7a193a(0x241)]=_0x38c83d;}),_0x8677a2['forEach']((_0x44f5c1,_0x2ba2ea)=>{_0x5a93ff[_0x2ba2ea]['from_invoice']=_0x44f5c1;}),_0x1c4eec[_0x44761e(0x226)]((_0x1d4c7e,_0x194fcf)=>{var _0xd78e58=_0x44761e;_0x5a93ff[_0x194fcf][_0xd78e58(0x2af)]=_0x1d4c7e;}),_0x15ab76[_0x44761e(0x226)]((_0x56b575,_0x3a8c00)=>{var _0x1341ef=_0x44761e;_0x5a93ff[_0x3a8c00][_0x1341ef(0x225)]=_0x56b575;}),_0x5577bd[_0x44761e(0x226)]((_0xf44189,_0x2671ad)=>{var _0x379817=_0x44761e;_0x24391d[_0x379817(0x226)]((_0x455b21,_0x2372e1)=>{var _0x581eba=_0x379817;if(_0x455b21==_0x581eba(0x290)&&_0x2671ad==_0x2372e1){var _0xf94af=_0xf44189['slice'](0x3);_0x5a93ff[_0x2671ad]['from_storage']=_0xf44189[0x0],_0x5a93ff[_0x2671ad][_0x581eba(0x2c5)]=_0xf44189[0x1],_0x5a93ff[_0x2671ad]['from_bay']=0x0,_0x5a93ff[_0x2671ad][_0x581eba(0x2c4)]=0x0,_0x5a93ff[_0x2671ad][_0x581eba(0x2ac)]=_0x581eba(0x21b),_0x5a93ff[_0x2671ad]['from_floorlevel']=_0xf94af;}else{if(_0x455b21=='Shelves'&&_0x2671ad==_0x2372e1){var _0xf94af=_0xf44189[_0x581eba(0x235)](0x3);_0x5a93ff[_0x2671ad]['from_storage']=_0xf44189[0x0],_0x5a93ff[_0x2671ad][_0x581eba(0x2c5)]=_0xf44189[0x1],_0x5a93ff[_0x2671ad]['from_bay']=0x0,_0x5a93ff[_0x2671ad][_0x581eba(0x2c4)]=0x0,_0x5a93ff[_0x2671ad][_0x581eba(0x2ac)]=_0x581eba(0x21b),_0x5a93ff[_0x2671ad][_0x581eba(0x26e)]=_0xf44189[0x5];}else{if(_0x2671ad==_0x2372e1){if(_0xf44189[0x0]=='A'&&_0xf44189[0x1]=='L'&&_0xf44189[0x2]=='L')console[_0x581eba(0x2b6)](_0x455b21+_0x581eba(0x25a)+_0x2671ad+_0x581eba(0x25a)+_0x2372e1+_0x581eba(0x25a)+_0xf44189+_0x581eba(0x2a7)),_0x5a93ff[_0x2671ad]['from_storage']=_0xf44189[0x0],_0x5a93ff[_0x2671ad][_0x581eba(0x2c5)]=_0xf44189[0x1],_0x5a93ff[_0x2671ad][_0x581eba(0x224)]=0x0,_0x5a93ff[_0x2671ad]['from_bin']=0x0,_0x5a93ff[_0x2671ad][_0x581eba(0x2ac)]=_0x581eba(0x21b),_0x5a93ff[_0x2671ad][_0x581eba(0x26e)]=_0xf44189[0x3];else{var _0x4282cd;if(_0xf44189[0x4]=='L')_0x4282cd=_0x581eba(0x265);else _0xf44189[0x4]=='F'&&(_0x4282cd='Floor');_0x5a93ff[_0x2671ad]['from_storage']=_0xf44189[0x0],_0x5a93ff[_0x2671ad][_0x581eba(0x2c5)]=_0xf44189[0x1],_0x5a93ff[_0x2671ad][_0x581eba(0x224)]=_0xf44189[0x2],_0x5a93ff[_0x2671ad][_0x581eba(0x2c4)]=_0xf44189[0x3],_0x5a93ff[_0x2671ad]['from_types']=_0x4282cd,_0x5a93ff[_0x2671ad][_0x581eba(0x26e)]=_0xf44189[0x5];}}}}});}),_0x166773[_0x44761e(0x226)]((_0x7649b1,_0x49bf23)=>{var _0x2efd13=_0x44761e;_0x5a93ff[_0x49bf23][_0x2efd13(0x262)]=_0x7649b1;}),_0x47bbd8[_0x44761e(0x226)]((_0x473fc0,_0x1b4d19)=>{var _0x217b39=_0x44761e;_0x309cb5[_0x217b39(0x226)]((_0xe53368,_0x45c313)=>{var _0x7f6f38=_0x217b39;if(_0xe53368==_0x7f6f38(0x290)&&_0x1b4d19==_0x45c313){var _0x4f46af=_0x473fc0[_0x7f6f38(0x235)](0x3);_0x5a93ff[_0x1b4d19][_0x7f6f38(0x270)]=_0x473fc0[0x0],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x1e7)]=_0x473fc0[0x1],_0x5a93ff[_0x1b4d19]['to_bay']=0x0,_0x5a93ff[_0x1b4d19][_0x7f6f38(0x24e)]=0x0,_0x5a93ff[_0x1b4d19][_0x7f6f38(0x28e)]=_0x7f6f38(0x21b),_0x5a93ff[_0x1b4d19][_0x7f6f38(0x203)]=_0x4f46af;}else{if(_0xe53368==_0x7f6f38(0x291)&&_0x1b4d19==_0x45c313){var _0x4f46af=_0x473fc0[_0x7f6f38(0x235)](0x3);_0x5a93ff[_0x1b4d19][_0x7f6f38(0x270)]=_0x473fc0[0x0],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x1e7)]=_0x473fc0[0x1],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x229)]=0x0,_0x5a93ff[_0x1b4d19][_0x7f6f38(0x24e)]=0x0,_0x5a93ff[_0x1b4d19][_0x7f6f38(0x28e)]=_0x7f6f38(0x21b),_0x5a93ff[_0x1b4d19][_0x7f6f38(0x203)]=_0x473fc0[0x5];}else{if(_0x1b4d19==_0x45c313){if(_0x473fc0[0x0]=='A'&&_0x473fc0[0x1]=='L'&&_0x473fc0[0x2]=='L')console[_0x7f6f38(0x2b6)](_0xe53368+'\x20<>\x20'+_0x1b4d19+'\x20<>\x20'+_0x45c313+'\x20<>\x20'+_0x473fc0+_0x7f6f38(0x2a7)),_0x5a93ff[_0x1b4d19][_0x7f6f38(0x270)]=_0x473fc0[0x0],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x1e7)]=_0x473fc0[0x1],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x229)]=0x0,_0x5a93ff[_0x1b4d19][_0x7f6f38(0x24e)]=0x0,_0x5a93ff[_0x1b4d19][_0x7f6f38(0x28e)]=_0x7f6f38(0x21b),_0x5a93ff[_0x1b4d19][_0x7f6f38(0x203)]=_0x473fc0[0x3];else{var _0x2fb55b;if(_0x473fc0[0x4]=='L')_0x2fb55b=_0x7f6f38(0x265);else _0x473fc0[0x4]=='F'&&(_0x2fb55b=_0x7f6f38(0x21b));_0x5a93ff[_0x1b4d19][_0x7f6f38(0x270)]=_0x473fc0[0x0],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x1e7)]=_0x473fc0[0x1],_0x5a93ff[_0x1b4d19]['to_bay']=_0x473fc0[0x2],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x24e)]=_0x473fc0[0x3],_0x5a93ff[_0x1b4d19][_0x7f6f38(0x28e)]=_0x2fb55b,_0x5a93ff[_0x1b4d19][_0x7f6f38(0x203)]=_0x473fc0[0x5];}}}}});}),_0x2c3fbd[_0x44761e(0x226)]((_0x446513,_0x4010b7)=>{var _0x17418e=_0x44761e;_0x5a93ff[_0x4010b7][_0x17418e(0x2ae)]=_0x446513;}),_0x11e65d[_0x44761e(0x226)]((_0x456eb0,_0xdda93b)=>{var _0x1a737a=_0x44761e;_0x5a93ff[_0xdda93b][_0x1a737a(0x2c3)]=_0x456eb0;}),_0x602f0b['forEach']((_0x1997da,_0x5e04f9)=>{var _0x32495b=_0x44761e;_0x5a93ff[_0x5e04f9][_0x32495b(0x217)]=_0x1997da;}),_0x34c3a5[_0x44761e(0x226)]((_0x158617,_0x16e145)=>{var _0x3dc329=_0x44761e;_0x5a93ff[_0x16e145][_0x3dc329(0x210)]=_0x158617;}),_0x1427db[_0x44761e(0x226)]((_0x31c1c2,_0x204add)=>{var _0x1f76bc=_0x44761e;_0x5a93ff[_0x204add][_0x1f76bc(0x215)]=_0x31c1c2;}),_0x5677cf['forEach']((_0x456d9b,_0x385b36)=>{_0x5a93ff[_0x385b36]['secondary_unit']=_0x456d9b;}),_0x1a53ba[_0x44761e(0x226)]((_0x11296e,_0x3bfd89)=>{var _0x30649c=_0x44761e;_0x5a93ff[_0x3bfd89][_0x30649c(0x258)]=_0x11296e;}),_0x85506b[_0x44761e(0x226)]((_0xbeb955,_0x541fd2)=>{var _0x585abb=_0x44761e;_0x5a93ff[_0x541fd2][_0x585abb(0x1f3)]=_0xbeb955;}),_0x188586['forEach']((_0x2040ae,_0x188b13)=>{var _0x1a1fbd=_0x44761e;_0x5a93ff[_0x188b13][_0x1a1fbd(0x206)]=_0x2040ae;}),_0x54e9a1[_0x44761e(0x226)]((_0x20a123,_0x4e2dc5)=>{var _0x2328e3=_0x44761e;_0x5a93ff[_0x4e2dc5][_0x2328e3(0x26f)]=_0x20a123;}),_0xf56c67[_0x44761e(0x226)]((_0x3af9ba,_0x34fc22)=>{var _0x393054=_0x44761e;_0x5a93ff[_0x34fc22][_0x393054(0x239)]=_0x3af9ba;}),_0x24391d['forEach']((_0x58ef6a,_0x34a6fb)=>{var _0x21e9ca=_0x44761e;_0x5a93ff[_0x34a6fb][_0x21e9ca(0x29f)]=_0x58ef6a;}),_0x309cb5[_0x44761e(0x226)]((_0x2c331c,_0x560ac0)=>{_0x5a93ff[_0x560ac0]['to_room_name']=_0x2c331c;});const _0x371da8=_0x5a93ff['filter'](_0x43eadb=>_0x43eadb[_0x44761e(0x262)]!=='0'&&_0x43eadb[_0x44761e(0x262)]!==''||_0x43eadb['to_floorlevel']!=='0'&&_0x43eadb[_0x44761e(0x203)]!==''),_0x794e73=new transfers({'date':_0x5d7c8d,'from_warehouse':_0x53e763,'to_warehouse':_0x402ec7,'product':_0x371da8,'note':_0x3cdc84,'invoice':_0x1c1003}),_0x2ea396=await _0x794e73[_0x44761e(0x25b)]();_0x3cca5e[_0x44761e(0x29d)](_0x44761e(0x2bf),_0x44761e(0x28d)),_0x3da3ed[_0x44761e(0x20d)]('/transfer/preview/'+_0x2ea396[_0x44761e(0x1d9)]);}catch(_0x17c31a){console['log'](_0x17c31a),_0x3da3ed[_0x44761e(0x22c)](0xc8)[_0x44761e(0x283)]({'errorMessage':_0x17c31a[_0x44761e(0x2b4)]});}}),router[a0_0x11b028(0x28b)](a0_0x11b028(0x23d),auth,async(_0x4d76e3,_0x296743)=>{var _0x1a4975=a0_0x11b028;try{const {username:_0xf59a0,email:_0x253dcc,role:_0x37256a}=_0x4d76e3['user'],_0x160ad5=_0x4d76e3[_0x1a4975(0x28a)],_0x2d8a68=await profile['findOne']({'email':_0x160ad5[_0x1a4975(0x22b)]}),_0x47523f=await master_shop[_0x1a4975(0x249)]();console[_0x1a4975(0x2b6)]('master',_0x47523f);const _0x8b73f6=await transfers[_0x1a4975(0x1e0)](_0x4d76e3[_0x1a4975(0x223)]['id']);let _0x3eb729=new Date(_0x8b73f6['expiry_date']),_0x27c37a=('0'+_0x3eb729[_0x1a4975(0x232)]())[_0x1a4975(0x235)](-0x2),_0x23701d=('0'+(_0x3eb729[_0x1a4975(0x2bb)]()+0x1))[_0x1a4975(0x235)](-0x2),_0x4524fc=_0x3eb729['getFullYear'](),_0x33a185=_0x4524fc+'-'+_0x23701d+'-'+_0x27c37a,_0x644e91;if(_0x160ad5[_0x1a4975(0x24b)]=='staff'){const _0x34c4f9=await staff[_0x1a4975(0x218)]({'email':_0x160ad5[_0x1a4975(0x22b)]});_0x644e91=await warehouse['find']({'status':'Enabled','name':_0x34c4f9[_0x1a4975(0x2b8)],'warehouse_category':_0x1a4975(0x271)});}else _0x644e91=await warehouse[_0x1a4975(0x249)]({'status':_0x1a4975(0x1d2),'warehouse_category':'Raw\x20Materials'});const _0x4a0dcd=await warehouse[_0x1a4975(0x298)]([{'$match':{'name':_0x8b73f6['from_warehouse']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1a4975(0x234)},'product_stock':{'$first':_0x1a4975(0x22a)},'bay':{'$first':_0x1a4975(0x201)},'bin':{'$first':_0x1a4975(0x269)},'type':{'$first':_0x1a4975(0x256)},'floorlevel':{'$first':_0x1a4975(0x216)},'primary_code':{'$first':_0x1a4975(0x254)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1a4975(0x205)},'storage':{'$first':_0x1a4975(0x1e8)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1a4975(0x1d1)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x1a4975(0x1ff)}}}]);if(_0x47523f[0x0][_0x1a4975(0x284)]==_0x1a4975(0x268)){var _0x4fcd18=users[_0x1a4975(0x25d)];console['log'](_0x4fcd18);}else{if(_0x47523f[0x0][_0x1a4975(0x284)]=='Hindi')var _0x4fcd18=users[_0x1a4975(0x1d3)];else{if(_0x47523f[0x0]['language']==_0x1a4975(0x208))var _0x4fcd18=users[_0x1a4975(0x208)];else{if(_0x47523f[0x0]['language']=='Spanish')var _0x4fcd18=users[_0x1a4975(0x1fe)];else{if(_0x47523f[0x0][_0x1a4975(0x284)]==_0x1a4975(0x1eb))var _0x4fcd18=users[_0x1a4975(0x1eb)];else{if(_0x47523f[0x0][_0x1a4975(0x284)]==_0x1a4975(0x1ee))var _0x4fcd18=users['Portuguese'];else{if(_0x47523f[0x0][_0x1a4975(0x284)]==_0x1a4975(0x293))var _0x4fcd18=users[_0x1a4975(0x293)];else{if(_0x47523f[0x0][_0x1a4975(0x284)]=='Arabic\x20(ae)')var _0x4fcd18=users[_0x1a4975(0x1dd)];}}}}}}}_0x296743['render']('edit_transfer_view',{'success':_0x4d76e3['flash'](_0x1a4975(0x2bf)),'errors':_0x4d76e3[_0x1a4975(0x29d)](_0x1a4975(0x248)),'role':_0x160ad5,'profile':_0x2d8a68,'master_shop':_0x47523f,'warehouse':_0x644e91,'transfer':_0x8b73f6,'stock':_0x4a0dcd,'language':_0x4fcd18});}catch(_0x35c5f2){console[_0x1a4975(0x2b6)](_0x35c5f2);}}),router['post']('/preview/:id',auth,async(_0x2b8685,_0x301259)=>{var _0x42b495=a0_0x11b028;try{const _0xae1927=_0x2b8685[_0x42b495(0x223)]['id'],{from_warehouse:_0x41828d,FromRoom_name:_0x5353a3,to_warehouse:_0x85ba7b,ToRoom_name:_0x54a894}=_0x2b8685[_0x42b495(0x25c)],_0x515931=await transfers['findById']({'_id':_0xae1927}),_0x27f260=_0x515931['product'][_0x42b495(0x251)](async _0x126bd1=>{var _0x196829=_0x42b495;if(_0x126bd1[_0x196829(0x262)]>0x0){var _0x439407=await warehouse['findOne']({'name':_0x515931[_0x196829(0x2b2)],'room':_0x126bd1[_0x196829(0x29f)],'warehouse_category':'Raw\x20Materials'});const _0x93d9d9=_0x439407[_0x196829(0x20e)][_0x196829(0x251)](_0x2aa7de=>{var _0x3487fb=_0x196829;_0x2aa7de['product_name']==_0x126bd1[_0x3487fb(0x220)]&&_0x2aa7de['floorlevel']==_0x126bd1['from_floorlevel']&&_0x2aa7de[_0x3487fb(0x20c)]==_0x126bd1[_0x3487fb(0x2ac)]&&_0x2aa7de['bin']==_0x126bd1[_0x3487fb(0x2c4)]&&_0x2aa7de['bay']==_0x126bd1[_0x3487fb(0x224)]&&_0x2aa7de['rack']==_0x126bd1[_0x3487fb(0x2c5)]&&_0x2aa7de[_0x3487fb(0x270)]==_0x126bd1[_0x3487fb(0x287)]&&_0x2aa7de[_0x3487fb(0x1f3)]==_0x126bd1[_0x3487fb(0x1f3)]&&_0x2aa7de['batch_code']==_0x126bd1[_0x3487fb(0x258)]&&_0x2aa7de[_0x3487fb(0x26f)]==_0x126bd1[_0x3487fb(0x26f)]&&_0x2aa7de[_0x3487fb(0x28f)]==_0x126bd1[_0x3487fb(0x2ab)]&&_0x2aa7de[_0x3487fb(0x1d9)]==_0x126bd1[_0x3487fb(0x225)]&&(_0x2aa7de[_0x3487fb(0x255)]=_0x2aa7de[_0x3487fb(0x255)]-_0x126bd1[_0x3487fb(0x262)]);});}return _0x439407;});Promise['all'](_0x27f260)[_0x42b495(0x1fb)](async _0x253633=>{var _0x5bbe38=_0x42b495;try{for(const _0x52c01c of _0x253633){await _0x52c01c[_0x5bbe38(0x25b)]();}try{const _0x129162=_0x515931[_0x5bbe38(0x1e6)][_0x5bbe38(0x251)](async _0x488f94=>{var _0x22a3f2=_0x5bbe38;if(_0x488f94[_0x22a3f2(0x262)]>0x0){var _0x420f44=await warehouse[_0x22a3f2(0x218)]({'name':_0x515931[_0x22a3f2(0x213)],'room':_0x488f94[_0x22a3f2(0x219)],'warehouse_category':'Raw\x20Materials'}),_0x43bb8e=0x0;const _0x27b2cc=_0x420f44[_0x22a3f2(0x20e)]['map'](_0x18791d=>{var _0x33731b=_0x22a3f2;_0x18791d[_0x33731b(0x220)]==_0x488f94[_0x33731b(0x220)]&&_0x18791d[_0x33731b(0x1ea)]==_0x488f94[_0x33731b(0x203)]&&_0x18791d[_0x33731b(0x20c)]==_0x488f94[_0x33731b(0x28e)]&&_0x18791d[_0x33731b(0x23b)]==_0x488f94[_0x33731b(0x24e)]&&_0x18791d[_0x33731b(0x1df)]==_0x488f94[_0x33731b(0x229)]&&_0x18791d[_0x33731b(0x1e7)]==_0x488f94[_0x33731b(0x1e7)]&&_0x18791d[_0x33731b(0x270)]==_0x488f94[_0x33731b(0x270)]&&_0x18791d['expiry_date']==_0x488f94['expiry_date']&&_0x18791d[_0x33731b(0x258)]==_0x488f94['batch_code']&&_0x18791d[_0x33731b(0x26f)]==_0x488f94['production_date']&&_0x18791d['invoice']==_0x488f94[_0x33731b(0x2af)]&&(_0x18791d[_0x33731b(0x255)]=_0x18791d['product_stock']+_0x488f94[_0x33731b(0x262)],_0x43bb8e++);});_0x43bb8e=='0'&&(_0x420f44['product_details']=_0x420f44[_0x22a3f2(0x20e)]['concat']({'product_name':_0x488f94[_0x22a3f2(0x220)],'product_stock':_0x488f94[_0x22a3f2(0x262)],'bay':_0x488f94['to_bay'],'bin':_0x488f94[_0x22a3f2(0x24e)],'type':_0x488f94[_0x22a3f2(0x28e)],'floorlevel':_0x488f94[_0x22a3f2(0x203)],'storage':_0x488f94[_0x22a3f2(0x270)],'rack':_0x488f94[_0x22a3f2(0x1e7)],'product_code':_0x488f94[_0x22a3f2(0x217)],'primary_code':_0x488f94[_0x22a3f2(0x2ae)],'secondary_code':_0x488f94[_0x22a3f2(0x2c3)],'maxProducts':_0x488f94['maxProducts'],'storage':_0x488f94['storage'],'rack':_0x488f94[_0x22a3f2(0x1e7)],'expiry_date':_0x488f94[_0x22a3f2(0x1f3)],'maxPerUnit':_0x488f94['maxperunit'],'batch_code':_0x488f94[_0x22a3f2(0x258)],'production_date':_0x488f94[_0x22a3f2(0x26f)]}));}return _0x420f44;});Promise[_0x5bbe38(0x2a2)](_0x129162)[_0x5bbe38(0x1fb)](async _0x369800=>{var _0x3f0736=_0x5bbe38;try{for(const _0x47f666 of _0x369800){await warehouse[_0x3f0736(0x277)]({'_id':_0x47f666[_0x3f0736(0x1d9)]},{'$addToSet':{'product_details':{'$each':_0x47f666['product_details']}}});}_0x515931[_0x3f0736(0x1e9)]=_0x3f0736(0x275);const _0x428277=await _0x515931[_0x3f0736(0x25b)](),_0xe0b1eb=await master_shop[_0x3f0736(0x249)](),_0x1cd1b7=await email_settings[_0x3f0736(0x218)](),_0x49e05f=await supervisor_settings[_0x3f0736(0x249)]();var _0x3519b7=_0x515931[_0x3f0736(0x1e6)],_0x29396a='',_0x6ec900;for(_0x6ec900 in _0x3519b7){_0x29396a+=_0x3f0736(0x282)+_0x3f0736(0x1cc)+_0x3519b7[_0x6ec900][_0x3f0736(0x220)]+_0x3f0736(0x2a1)+_0x3f0736(0x1cc)+_0x3519b7[_0x6ec900][_0x3f0736(0x217)]+_0x3f0736(0x2a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3519b7[_0x6ec900][_0x3f0736(0x262)]+'</td>'+_0x3f0736(0x1cc)+_0x3519b7[_0x6ec900][_0x3f0736(0x215)]+_0x3f0736(0x2a1)+_0x3f0736(0x1cc)+_0x3519b7[_0x6ec900]['secondary_unit']+_0x3f0736(0x2a1)+_0x3f0736(0x1cc)+_0x515931[_0x3f0736(0x213)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3519b7[_0x6ec900][_0x3f0736(0x219)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3519b7[_0x6ec900][_0x3f0736(0x270)]+_0x3519b7[_0x6ec900][_0x3f0736(0x1e7)]+_0x3519b7[_0x6ec900][_0x3f0736(0x229)]+_0x3519b7[_0x6ec900][_0x3f0736(0x24e)]+_0x3519b7[_0x6ec900][_0x3f0736(0x28e)][0x0]+_0x3519b7[_0x6ec900][_0x3f0736(0x203)]+_0x3f0736(0x2a1),_0x3f0736(0x1e1);}let _0x2b90f8=nodemailer[_0x3f0736(0x296)]({'host':_0x1cd1b7[_0x3f0736(0x20b)],'port':Number(_0x1cd1b7['port']),'secure':![],'auth':{'user':_0x1cd1b7[_0x3f0736(0x22b)],'pass':_0x1cd1b7[_0x3f0736(0x230)]}}),_0x677673={'from':_0x1cd1b7[_0x3f0736(0x22b)],'to':_0x49e05f[0x0][_0x3f0736(0x1ec)],'subject':_0x3f0736(0x20f),'attachments':[{'filename':_0x3f0736(0x1f9),'path':__dirname+_0x3f0736(0x228)+'/upload/'+_0xe0b1eb[0x0][_0x3f0736(0x1de)],'cid':_0x3f0736(0x27f)}],'html':_0x3f0736(0x2b1)+_0x3f0736(0x27a)+_0x3f0736(0x244)+_0x3f0736(0x288)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x3f0736(0x288)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x3f0736(0x222)+_0x3f0736(0x288)+_0x3f0736(0x285)+_0xe0b1eb[0x0][_0x3f0736(0x263)]+_0x3f0736(0x27c)+_0x3f0736(0x222)+_0x3f0736(0x222)+_0x3f0736(0x204)+_0x3f0736(0x288)+_0x3f0736(0x2b5)+_0x3f0736(0x2a3)+_0x515931[_0x3f0736(0x28f)]+'\x20'+_0x3f0736(0x200)+_0x3f0736(0x259)+_0x515931[_0x3f0736(0x2c0)]+'\x20'+_0x3f0736(0x1f8)+'</h5>'+_0x3f0736(0x222)+_0x3f0736(0x236)+_0x3f0736(0x1f2)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x3f0736(0x299)+_0x3f0736(0x28c)+_0x3f0736(0x221)+_0x3f0736(0x1d8)+_0x3f0736(0x21a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x3f0736(0x1e1)+_0x3f0736(0x1f1)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x29396a+'\x20'+_0x3f0736(0x242)+_0x3f0736(0x1f7)+_0x3f0736(0x288)+_0x3f0736(0x2aa)+_0x3f0736(0x1ce)+_0xe0b1eb[0x0][_0x3f0736(0x263)]+_0x3f0736(0x23a)+_0x3f0736(0x222)+_0x3f0736(0x222)+_0x3f0736(0x20a)};_0x2b90f8[_0x3f0736(0x292)](_0x677673,function(_0x523450,_0x5248af){var _0x18f333=_0x3f0736;_0x523450?(console[_0x18f333(0x2b6)](_0x523450),console[_0x18f333(0x2b6)](_0x18f333(0x1fa))):console[_0x18f333(0x2b6)]('Email\x20sent\x20successfully');}),_0x2b8685['flash'](_0x3f0736(0x2bf),_0x3f0736(0x1d7)),_0x301259[_0x3f0736(0x20d)](_0x3f0736(0x1f6)+_0x428277[_0x3f0736(0x1d9)]);}catch(_0xb1cc6f){console[_0x3f0736(0x247)](_0xb1cc6f),_0x301259[_0x3f0736(0x22c)](0x1f4)[_0x3f0736(0x283)]({'Perror':_0x3f0736(0x294),'message':_0xb1cc6f[_0x3f0736(0x2b4)]});}})[_0x5bbe38(0x1ed)](_0x5642f4=>{var _0x3c4844=_0x5bbe38;console[_0x3c4844(0x247)](_0x5642f4),_0x301259[_0x3c4844(0x22c)](0x1f4)[_0x3c4844(0x283)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x3c49f9){_0x301259[_0x5bbe38(0x283)](_0x3c49f9);}}catch(_0x25fc95){console[_0x5bbe38(0x247)](_0x25fc95),_0x301259[_0x5bbe38(0x22c)](0x1f4)['json']({'Merror':_0x5bbe38(0x294),'Message':_0x25fc95[_0x5bbe38(0x2b4)]});}})[_0x42b495(0x1ed)](_0x218dd7=>{var _0x2f734a=_0x42b495;console[_0x2f734a(0x247)](_0x218dd7),_0x301259[_0x2f734a(0x22c)](0x1f4)[_0x2f734a(0x283)]({'Merror':_0x2f734a(0x24d)});});}catch(_0x161f02){console['log'](_0x161f02);}});function BayBinSelected(_0x1325bf,_0x10f895){var _0x3c7425=a0_0x11b028,_0x26dd3d=[],_0x2e3da8=[],_0x20529b=[],_0x705cae=[],_0x2825e1=[],_0x48643c=[];let _0x57d8bf=[];if(_0x1325bf==_0x3c7425(0x22f))switch(_0x10f895){case _0x3c7425(0x211):_0x26dd3d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2e3da8=[0x1,0x2],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=[_0x3c7425(0x265),'Floor'],_0x2825e1=['D'],_0x48643c=['A'];break;case _0x3c7425(0x267):_0x26dd3d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2e3da8=[0x1,0x2],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=[_0x3c7425(0x265),'Floor'],_0x2825e1=['D'],_0x48643c=['B'];break;case'Shelves':_0x26dd3d=[0x0],_0x2e3da8=[0x0],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=[_0x3c7425(0x21b)],_0x2825e1=['D'],_0x48643c=['S'];break;case _0x3c7425(0x290):_0x26dd3d=[0x0],_0x2e3da8=[0x0],_0x705cae=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x20529b=[_0x3c7425(0x21b)],_0x2825e1=['D'],_0x48643c=['R'];break;}else{if(_0x1325bf==_0x3c7425(0x2ba))switch(_0x10f895){case _0x3c7425(0x211):_0x26dd3d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2e3da8=['B','F'],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=['Level',_0x3c7425(0x21b)],_0x2825e1=['C'],_0x48643c=['A'];break;case _0x3c7425(0x267):_0x26dd3d=[0x5,0x4,0x3,0x2,0x1],_0x2e3da8=['F','B','S'],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=[_0x3c7425(0x265),_0x3c7425(0x21b)],_0x2825e1=['C'],_0x48643c=['B'];break;case'Rack\x20C':_0x26dd3d=[0x1,0x2,0x3,0x4,0x5],_0x2e3da8=['B','F','S'],_0x705cae=[0x5,0x4,0x3,0x2,0x1],_0x20529b=['Level',_0x3c7425(0x21b)],_0x2825e1=['C'],_0x48643c=['C'];break;case _0x3c7425(0x1f5):_0x26dd3d=[0x5,0x4,0x3,0x2,0x1],_0x2e3da8=['F','B','S'],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=[_0x3c7425(0x265),_0x3c7425(0x21b)],_0x2825e1=['C'],_0x48643c=['D'];break;case'Rack\x20E':_0x26dd3d=[0x4,0x3,0x2,0x1],_0x2e3da8=[0x1,0x2],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=[_0x3c7425(0x265),'Floor'],_0x2825e1=['C'],_0x48643c=['E'];break;case _0x3c7425(0x29c):_0x26dd3d=[0x1,0x2,0x3],_0x2e3da8=[0x1,0x2],_0x705cae=[0x1,0x2,0x3,0x4,0x5],_0x20529b=['Level'],_0x2825e1=['C'],_0x48643c=['F'];break;}}return{'levels':_0x26dd3d,'Isle':_0x2e3da8,'rack':_0x705cae,'type':_0x20529b,'storage':_0x2825e1,'rak':_0x48643c};}router['get'](a0_0x11b028(0x27b),auth,async(_0x362efd,_0x959185)=>{var _0x205117=a0_0x11b028;try{const {username:_0x162953,email:_0x1ed87a,role:_0x5caae7}=_0x362efd[_0x205117(0x28a)],_0x52c357=_0x362efd[_0x205117(0x28a)],_0x1a2fdb=await profile['findOne']({'email':_0x52c357[_0x205117(0x22b)]}),_0x418df=await master_shop[_0x205117(0x249)](),_0xd48be9=await transfers[_0x205117(0x1e0)](_0x362efd[_0x205117(0x223)]['id']);let _0x439fff;if(_0x52c357['role']==_0x205117(0x2b3)){const _0x82cc8=await staff['findOne']({'email':_0x52c357[_0x205117(0x22b)]});_0x439fff=await warehouse[_0x205117(0x298)]([{'$match':{'status':_0x205117(0x1d2),'name':_0x82cc8[_0x205117(0x2b8)],'warehouse_category':_0x205117(0x271)}},{'$group':{'_id':_0x205117(0x26a),'name':{'$first':_0x205117(0x26a)}}}]);}else _0x439fff=await warehouse[_0x205117(0x298)]([{'$match':{'status':_0x205117(0x1d2),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x3be7a1=await warehouse['aggregate']([{'$match':{'name':_0xd48be9['from_warehouse'],'warehouse_category':_0x205117(0x271)}},{'$unwind':_0x205117(0x233)},{'$group':{'_id':_0x205117(0x27d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x205117(0x22a)},'bay':{'$first':_0x205117(0x201)},'bin':{'$first':_0x205117(0x269)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x205117(0x254)},'secondary_code':{'$first':_0x205117(0x29a)},'product_code':{'$first':_0x205117(0x205)},'storage':{'$first':_0x205117(0x1e8)},'rack':{'$first':_0x205117(0x246)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x205117(0x23f)},'room':{'$first':'$room'}}}]),_0x5a1801=await product[_0x205117(0x249)]({}),_0x33ca25=BayBinSelected(_0xd48be9['to_warehouse'],_0xd48be9[_0x205117(0x25e)]);if(_0x418df[0x0]['language']=='English\x20(US)'){var _0x1457cc=users['English'];console[_0x205117(0x2b6)](_0x1457cc);}else{if(_0x418df[0x0][_0x205117(0x284)]=='Hindi')var _0x1457cc=users['Hindi'];else{if(_0x418df[0x0][_0x205117(0x284)]=='German')var _0x1457cc=users['German'];else{if(_0x418df[0x0][_0x205117(0x284)]=='Spanish')var _0x1457cc=users[_0x205117(0x1fe)];else{if(_0x418df[0x0][_0x205117(0x284)]==_0x205117(0x1eb))var _0x1457cc=users[_0x205117(0x1eb)];else{if(_0x418df[0x0][_0x205117(0x284)]=='Portuguese\x20(BR)')var _0x1457cc=users[_0x205117(0x214)];else{if(_0x418df[0x0][_0x205117(0x284)]==_0x205117(0x293))var _0x1457cc=users[_0x205117(0x293)];else{if(_0x418df[0x0][_0x205117(0x284)]==_0x205117(0x231))var _0x1457cc=users['Arabic'];}}}}}}}_0x959185[_0x205117(0x272)](_0x205117(0x26d),{'success':_0x362efd[_0x205117(0x29d)](_0x205117(0x2bf)),'errors':_0x362efd[_0x205117(0x29d)](_0x205117(0x248)),'role':_0x52c357,'profile':_0x1a2fdb,'master_shop':_0x418df,'warehouse':_0x439fff,'transfer':_0xd48be9,'stock':_0x3be7a1,'unit':_0x5a1801,'language':_0x1457cc});}catch(_0x4347e1){console[_0x205117(0x2b6)](_0x4347e1);}}),router[a0_0x11b028(0x26c)]('/view/:id',auth,async(_0x109f45,_0x57529d)=>{var _0x1e693e=a0_0x11b028;try{const _0x30435c=_0x109f45['params']['id'],_0x33ed89=await transfers[_0x1e693e(0x1e0)](_0x30435c);_0x57529d['json'](_0x109f45['body']);return;const {date:_0x592b9a,from_warehouse:_0x3dfd2e,FromRoom_name:_0x11180e,to_warehouse:_0x1c7c31,ToRoom_name:_0x429351,prod_name:_0x27194b,from_prod_qty:_0x5d36f0,from_prod_level:_0x35a0f1,from_prod_isle:_0x3283c0,from_prod_pallet:_0x3c0796,to_prod_qty:_0x883c74,to_prod_level:_0x1ddc92,to_prod_isle:_0x5eeca1,to_prod_pallet:_0x23c8ff,primary_code:_0xddf69e,secondary_code:_0xc705a7,product_code3:_0x29c536,note:_0xc47f27,invoice:_0x171555,expiry_date:_0x51bf72}=_0x109f45[_0x1e693e(0x25c)];if(typeof _0x27194b=='string')var _0x9dad6e=[_0x109f45['body'][_0x1e693e(0x280)]],_0x2eab5b=[_0x109f45['body'][_0x1e693e(0x23c)]],_0xc80600=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x260)]],_0x1aaf1d=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x286)]],_0x4b8a16=[_0x109f45[_0x1e693e(0x25c)]['from_prod_pallet']],_0x5d9fa4=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x2ac)]],_0x1ebf30=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x21f)]],_0x4c3b0a=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x276)]],_0x5396ed=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x209)]],_0x45649f=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x1fc)]],_0x24132c=[_0x109f45['body']['to_types']],_0x28f21f=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x270)]],_0x18c147=[_0x109f45[_0x1e693e(0x25c)]['rak']],_0x4ce236=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x2ae)]],_0xda3df6=[_0x109f45[_0x1e693e(0x25c)]['secondary_code']],_0x327a96=[_0x109f45['body'][_0x1e693e(0x1da)]],_0x3f4ebe=[_0x109f45[_0x1e693e(0x25c)]['MaxStocks_data2']],_0x45f932=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x215)]],_0x5add6f=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x266)]],_0x53745d=[_0x109f45['body']['batch_code']],_0x415e22=[_0x109f45[_0x1e693e(0x25c)]['expiry_date']],_0x348875=[_0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x287)]],_0x1a3fb8=[_0x109f45[_0x1e693e(0x25c)]['from_rak']];else var _0x9dad6e=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x280)]],_0x28f21f=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x270)]],_0x18c147=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x1cf)]],_0x5d9fa4=[..._0x109f45['body'][_0x1e693e(0x2ac)]],_0x24132c=[..._0x109f45[_0x1e693e(0x25c)]['to_types']],_0x2eab5b=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x23c)]],_0xc80600=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x260)]],_0x1aaf1d=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x286)]],_0x4b8a16=[..._0x109f45[_0x1e693e(0x25c)]['from_prod_pallet']],_0x1ebf30=[..._0x109f45[_0x1e693e(0x25c)]['to_prod_qty']],_0x4c3b0a=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x276)]],_0x5396ed=[..._0x109f45['body'][_0x1e693e(0x209)]],_0x45649f=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x1fc)]],_0x4ce236=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x2ae)]],_0xda3df6=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x2c3)]],_0x327a96=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x1da)]],_0x3f4ebe=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x281)]],_0x45f932=[..._0x109f45['body'][_0x1e693e(0x215)]],_0x5add6f=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x266)]],_0x53745d=[..._0x109f45['body'][_0x1e693e(0x258)]],_0x415e22=[..._0x109f45[_0x1e693e(0x25c)]['expiry_date']],_0x348875=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x287)]],_0x1a3fb8=[..._0x109f45[_0x1e693e(0x25c)][_0x1e693e(0x21c)]];const _0x5f4519=_0x9dad6e[_0x1e693e(0x251)](_0x34b7e1=>{return _0x34b7e1={'product_name':_0x34b7e1};});_0x2eab5b['forEach']((_0x4b8b3f,_0x490cde)=>{var _0x4617ed=_0x1e693e;_0x5f4519[_0x490cde][_0x4617ed(0x241)]=_0x4b8b3f;}),_0xc80600[_0x1e693e(0x226)]((_0x4dd771,_0x431247)=>{var _0x2dd77d=_0x1e693e;_0x5f4519[_0x431247][_0x2dd77d(0x224)]=_0x4dd771;}),_0x1aaf1d['forEach']((_0x1d9d3e,_0x17b4b5)=>{var _0x1c76fa=_0x1e693e;_0x5f4519[_0x17b4b5][_0x1c76fa(0x2c4)]=_0x1d9d3e;}),_0x4b8a16[_0x1e693e(0x226)]((_0x1f730b,_0x2af7bd)=>{var _0x5d5d76=_0x1e693e;_0x5f4519[_0x2af7bd][_0x5d5d76(0x26e)]=_0x1f730b;}),_0x1ebf30[_0x1e693e(0x226)]((_0x3f2411,_0x45016f)=>{_0x5f4519[_0x45016f]['to_quantity']=_0x3f2411;}),_0x4c3b0a[_0x1e693e(0x226)]((_0x2665b6,_0x56ae17)=>{var _0x422b70=_0x1e693e;_0x5f4519[_0x56ae17][_0x422b70(0x229)]=_0x2665b6;}),_0x5396ed[_0x1e693e(0x226)]((_0x39ca5a,_0x223172)=>{var _0x2ab8be=_0x1e693e;_0x5f4519[_0x223172][_0x2ab8be(0x24e)]=_0x39ca5a;}),_0x45649f[_0x1e693e(0x226)]((_0xa27178,_0x561a4b)=>{var _0x992eab=_0x1e693e;_0x5f4519[_0x561a4b][_0x992eab(0x203)]=_0xa27178;}),_0x4ce236[_0x1e693e(0x226)]((_0x586f10,_0x596ae7)=>{_0x5f4519[_0x596ae7]['primary_code']=_0x586f10;}),_0xda3df6[_0x1e693e(0x226)]((_0x22a42b,_0x24a622)=>{var _0x2a1f96=_0x1e693e;_0x5f4519[_0x24a622][_0x2a1f96(0x2c3)]=_0x22a42b;}),_0x327a96[_0x1e693e(0x226)]((_0x2d3743,_0x12e748)=>{var _0x28268e=_0x1e693e;_0x5f4519[_0x12e748][_0x28268e(0x217)]=_0x2d3743;}),_0x3f4ebe[_0x1e693e(0x226)]((_0x78e642,_0x2b5a5f)=>{var _0x1a0247=_0x1e693e;_0x5f4519[_0x2b5a5f][_0x1a0247(0x210)]=_0x78e642;}),_0x45f932[_0x1e693e(0x226)]((_0x24da9b,_0x4e95e3)=>{var _0x5458e7=_0x1e693e;_0x5f4519[_0x4e95e3][_0x5458e7(0x215)]=_0x24da9b;}),_0x5add6f[_0x1e693e(0x226)]((_0x4f7459,_0x49d251)=>{var _0x578c6a=_0x1e693e;_0x5f4519[_0x49d251][_0x578c6a(0x266)]=_0x4f7459;}),_0x53745d[_0x1e693e(0x226)]((_0x20ee14,_0x108e93)=>{var _0x53992f=_0x1e693e;_0x5f4519[_0x108e93][_0x53992f(0x258)]=_0x20ee14;}),_0x415e22[_0x1e693e(0x226)]((_0x22b3d8,_0x265c8b)=>{var _0x29a8db=_0x1e693e;_0x5f4519[_0x265c8b][_0x29a8db(0x1f3)]=_0x22b3d8;}),_0x28f21f['forEach']((_0x4c42c0,_0x447dc8)=>{var _0x4d1287=_0x1e693e;_0x5f4519[_0x447dc8][_0x4d1287(0x270)]=_0x4c42c0;}),_0x18c147[_0x1e693e(0x226)]((_0x1cd855,_0x17c312)=>{var _0x1d80cd=_0x1e693e;_0x5f4519[_0x17c312][_0x1d80cd(0x1e7)]=_0x1cd855;}),_0x5d9fa4[_0x1e693e(0x226)]((_0x15a7a9,_0x2104da)=>{var _0x1e01a2=_0x1e693e;_0x5f4519[_0x2104da][_0x1e01a2(0x2ac)]=_0x15a7a9;}),_0x24132c['forEach']((_0x35ed6f,_0xcc3f47)=>{_0x5f4519[_0xcc3f47]['to_types']=_0x35ed6f;}),_0x348875[_0x1e693e(0x226)]((_0x2504c5,_0x517249)=>{var _0x61263b=_0x1e693e;_0x5f4519[_0x517249][_0x61263b(0x287)]=_0x2504c5;}),_0x1a3fb8[_0x1e693e(0x226)]((_0x14f072,_0x1743df)=>{var _0x20baf9=_0x1e693e;_0x5f4519[_0x1743df][_0x20baf9(0x2c5)]=_0x14f072;});const _0x35e6f8=_0x5f4519[_0x1e693e(0x1d0)](_0x314b5c=>_0x314b5c['to_quantity']!=='0'&&_0x314b5c[_0x1e693e(0x262)]!==''||_0x314b5c[_0x1e693e(0x203)]!=='0'&&_0x314b5c[_0x1e693e(0x203)]!=='');var _0x429422=0x0;_0x35e6f8['forEach'](_0x7765cf=>{var _0x4a4b85=_0x1e693e;parseInt(_0x7765cf[_0x4a4b85(0x241)])<parseInt(_0x7765cf[_0x4a4b85(0x262)])&&_0x429422++;});if(_0x429422!=0x0)return _0x109f45[_0x1e693e(0x29d)](_0x1e693e(0x248),_0x1e693e(0x23e)),_0x57529d['redirect'](_0x1e693e(0x2c1));const _0x50bbd4=await warehouse[_0x1e693e(0x218)]({'name':_0x33ed89[_0x1e693e(0x2b2)],'room':_0x33ed89['from_room']});_0x33ed89[_0x1e693e(0x1e6)]['forEach'](_0x3a9b91=>{var _0x4ffde5=_0x1e693e;if(_0x3a9b91['to_quantity']>0x0){const _0x1bc97a=_0x50bbd4[_0x4ffde5(0x20e)][_0x4ffde5(0x251)](_0x4ed5f1=>{var _0x3aa63c=_0x4ffde5;_0x4ed5f1[_0x3aa63c(0x220)]==_0x3a9b91[_0x3aa63c(0x220)]&&_0x4ed5f1[_0x3aa63c(0x1ea)]==_0x3a9b91[_0x3aa63c(0x26e)]&&_0x4ed5f1[_0x3aa63c(0x20c)]==_0x3a9b91[_0x3aa63c(0x2ac)]&&_0x4ed5f1[_0x3aa63c(0x23b)]==_0x3a9b91[_0x3aa63c(0x2c4)]&&_0x4ed5f1[_0x3aa63c(0x1df)]==_0x3a9b91[_0x3aa63c(0x224)]&&_0x4ed5f1[_0x3aa63c(0x1e7)]==_0x3a9b91['from_rack']&&_0x4ed5f1[_0x3aa63c(0x270)]==_0x3a9b91[_0x3aa63c(0x287)]&&(_0x4ed5f1[_0x3aa63c(0x255)]=parseInt(_0x4ed5f1['product_stock'])+parseInt(_0x3a9b91[_0x3aa63c(0x262)]));});}}),await _0x50bbd4['save']();const _0x2e31c0=await warehouse['findOne']({'name':_0x33ed89[_0x1e693e(0x213)],'room':_0x33ed89[_0x1e693e(0x25e)]});_0x33ed89[_0x1e693e(0x1e6)]['forEach'](_0x5b5666=>{var _0x1ac540=_0x1e693e;if(_0x5b5666[_0x1ac540(0x262)]>0x0){const _0x218a95=_0x2e31c0[_0x1ac540(0x20e)][_0x1ac540(0x251)](_0x1ca8dc=>{var _0x4ad1f0=_0x1ac540;_0x1ca8dc['product_name']==_0x5b5666[_0x4ad1f0(0x220)]&&_0x1ca8dc[_0x4ad1f0(0x1ea)]==_0x5b5666[_0x4ad1f0(0x203)]&&_0x1ca8dc[_0x4ad1f0(0x20c)]==_0x5b5666['to_types']&&_0x1ca8dc[_0x4ad1f0(0x23b)]==_0x5b5666[_0x4ad1f0(0x24e)]&&_0x1ca8dc[_0x4ad1f0(0x1df)]==_0x5b5666[_0x4ad1f0(0x229)]&&_0x1ca8dc['rack']==_0x5b5666[_0x4ad1f0(0x1e7)]&&_0x1ca8dc[_0x4ad1f0(0x270)]==_0x5b5666['storage']&&(_0x1ca8dc[_0x4ad1f0(0x255)]=parseInt(_0x1ca8dc['product_stock'])-parseInt(_0x5b5666[_0x4ad1f0(0x262)]));});}}),await _0x2e31c0[_0x1e693e(0x25b)](),_0x33ed89['date']=_0x592b9a,_0x33ed89[_0x1e693e(0x2b2)]=_0x3dfd2e,_0x33ed89[_0x1e693e(0x213)]=_0x1c7c31,_0x33ed89[_0x1e693e(0x1e6)]=_0x35e6f8,_0x33ed89[_0x1e693e(0x1d6)]=_0xc47f27,_0x33ed89[_0x1e693e(0x28f)]=_0x171555;const _0x1c85b8=await _0x33ed89[_0x1e693e(0x25b)]();console[_0x1e693e(0x2b6)](_0x1c85b8);const _0x55a745=await warehouse[_0x1e693e(0x218)]({'name':_0x3dfd2e,'room':_0x11180e});_0x1c85b8[_0x1e693e(0x1e6)]['forEach'](_0x2a9e87=>{var _0xe3535d=_0x1e693e;if(_0x2a9e87[_0xe3535d(0x262)]>0x0){const _0x3ca1b4=_0x55a745[_0xe3535d(0x20e)][_0xe3535d(0x251)](_0x2fe78d=>{var _0x5ed360=_0xe3535d;_0x2fe78d[_0x5ed360(0x220)]==_0x2a9e87[_0x5ed360(0x220)]&&_0x2fe78d[_0x5ed360(0x1ea)]==_0x2a9e87[_0x5ed360(0x26e)]&&_0x2fe78d[_0x5ed360(0x20c)]==_0x2a9e87[_0x5ed360(0x2ac)]&&_0x2fe78d[_0x5ed360(0x23b)]==_0x2a9e87[_0x5ed360(0x2c4)]&&_0x2fe78d[_0x5ed360(0x1df)]==_0x2a9e87[_0x5ed360(0x224)]&&_0x2fe78d[_0x5ed360(0x1e7)]==_0x2a9e87[_0x5ed360(0x2c5)]&&_0x2fe78d[_0x5ed360(0x270)]==_0x2a9e87[_0x5ed360(0x287)]&&(_0x2fe78d[_0x5ed360(0x255)]=parseInt(_0x2fe78d[_0x5ed360(0x255)])-parseInt(_0x2a9e87[_0x5ed360(0x262)]));});}}),await _0x55a745[_0x1e693e(0x25b)]();const _0x55d6d8=await warehouse[_0x1e693e(0x218)]({'name':_0x1c7c31,'room':_0x429351});_0x1c85b8[_0x1e693e(0x1e6)][_0x1e693e(0x226)](_0x10f18d=>{var _0x36793d=_0x1e693e;if(_0x10f18d[_0x36793d(0x262)]>0x0){var _0x13fe0d=0x0;const _0xc11aee=_0x55d6d8[_0x36793d(0x20e)][_0x36793d(0x251)](_0x346a22=>{var _0x426456=_0x36793d;_0x346a22[_0x426456(0x220)]==_0x10f18d[_0x426456(0x220)]&&_0x346a22['floorlevel']==_0x10f18d[_0x426456(0x203)]&&_0x346a22[_0x426456(0x20c)]==_0x10f18d[_0x426456(0x28e)]&&_0x346a22[_0x426456(0x23b)]==_0x10f18d[_0x426456(0x24e)]&&_0x346a22[_0x426456(0x1df)]==_0x10f18d[_0x426456(0x229)]&&_0x346a22['rack']==_0x10f18d[_0x426456(0x1e7)]&&_0x346a22[_0x426456(0x270)]==_0x10f18d[_0x426456(0x270)]&&(_0x346a22[_0x426456(0x255)]=parseInt(_0x346a22['product_stock'])+parseInt(_0x10f18d['to_quantity']),_0x13fe0d++);});_0x13fe0d=='0'&&(_0x55d6d8['product_details']=_0x55d6d8[_0x36793d(0x20e)][_0x36793d(0x274)]({'product_name':_0x10f18d[_0x36793d(0x220)],'product_stock':_0x10f18d[_0x36793d(0x262)],'bay':_0x10f18d[_0x36793d(0x229)],'bin':_0x10f18d['to_bin'],'type':_0x10f18d[_0x36793d(0x28e)],'floorlevel':_0x10f18d[_0x36793d(0x203)],'storage':_0x10f18d[_0x36793d(0x270)],'rack':_0x10f18d['rack'],'product_code':_0x10f18d['product_code'],'primary_code':_0x10f18d['primary_code'],'secondary_code':_0x10f18d[_0x36793d(0x2c3)],'maxProducts':_0x10f18d['maxProducts'],'storage':_0x10f18d[_0x36793d(0x270)],'rack':_0x10f18d['rack']}));}}),await _0x55d6d8[_0x1e693e(0x25b)](),_0x109f45['flash'](_0x1e693e(0x2bf),'Transfer\x20Edit\x20Successfully'),_0x57529d[_0x1e693e(0x20d)]('/transfer/view');}catch(_0x5536c7){console[_0x1e693e(0x2b6)](_0x5536c7);}}),router[a0_0x11b028(0x26c)](a0_0x11b028(0x227),async(_0x1626a0,_0x4174c9)=>{var _0x316e43=a0_0x11b028;const {FromWareHouse:_0x104bd5,FromRoom:_0x2e9055,ToWarehouse:_0xacf2da,ToRoom:_0x3cf23d,primary_code:_0x4ab2c2,Roomslist:_0x1430ed}=_0x1626a0['body'],_0x1c9bd8=_0x1430ed[_0x316e43(0x253)](','),_0x3bc584=[];async function _0x255ec6(_0x373548){var _0xbe19cb=_0x316e43;const _0x22fa0a=await warehouse[_0xbe19cb(0x298)]([{'$match':{'name':_0x104bd5,'room':_0x373548}},{'$unwind':_0xbe19cb(0x233)},{'$match':{'product_details.primary_code':_0x4ab2c2}},{'$group':{'_id':_0xbe19cb(0x27d),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0xbe19cb(0x22a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xbe19cb(0x256)},'pallet':{'$first':_0xbe19cb(0x216)},'unit':{'$first':_0xbe19cb(0x2b0)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xbe19cb(0x1e8)},'rack':{'$first':_0xbe19cb(0x246)},'expiry_date':{'$first':_0xbe19cb(0x1d1)},'production_date':{'$first':_0xbe19cb(0x23f)},'batch_code':{'$first':_0xbe19cb(0x238)},'maxPerUnit':{'$first':_0xbe19cb(0x2a9)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0xbe19cb(0x2b9)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x45dfcc=await warehouse[_0xbe19cb(0x298)]([{'$match':{'name':_0x104bd5,'room':_0x373548}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4ab2c2}},{'$group':{'_id':_0xbe19cb(0x27d),'name':{'$first':_0xbe19cb(0x234)},'instock':{'$first':_0xbe19cb(0x22a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xbe19cb(0x29a)},'product_code':{'$first':_0xbe19cb(0x205)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xbe19cb(0x256)},'pallet':{'$first':_0xbe19cb(0x216)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xbe19cb(0x26b)},'storage':{'$first':_0xbe19cb(0x1e8)},'rack':{'$first':_0xbe19cb(0x246)},'expiry_date':{'$first':_0xbe19cb(0x1d1)},'production_date':{'$first':_0xbe19cb(0x23f)},'batch_code':{'$first':_0xbe19cb(0x238)},'maxPerUnit':{'$first':_0xbe19cb(0x2a9)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0xbe19cb(0x1ff)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0xbe19cb(0x22e)}}}]);if(_0x22fa0a[_0xbe19cb(0x24c)]>0x0)_0x3bc584[_0xbe19cb(0x2be)](_0x22fa0a);else _0x45dfcc[_0xbe19cb(0x24c)]>0x0&&_0x3bc584[_0xbe19cb(0x2be)](_0x45dfcc);}const _0x2aa336=_0x1c9bd8[_0x316e43(0x251)](_0x24aa20=>_0x255ec6(_0x24aa20));await Promise['all'](_0x2aa336),_0x4174c9['json'](_0x3bc584);}),router[a0_0x11b028(0x26c)](a0_0x11b028(0x2bd),async(_0x30b79b,_0x328dd4)=>{var _0x49dbf6=a0_0x11b028;try{const {FromWareHouse:_0xeabcc2,FromRoom:_0x66ab6b,ToWarehouse:_0x153399,ToRoom:_0x9a378b,secondary_code:_0x53683e}=_0x30b79b[_0x49dbf6(0x25c)],_0xdbd1b0=await warehouse[_0x49dbf6(0x298)]([{'$match':{'name':_0xeabcc2}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x53683e}},{'$group':{'_id':_0x49dbf6(0x27d),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x49dbf6(0x254)},'secondary_code':{'$first':_0x49dbf6(0x29a)},'product_code':{'$first':_0x49dbf6(0x205)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x49dbf6(0x26a)},'level':{'$first':_0x49dbf6(0x257)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x49dbf6(0x2b0)}}}]);_0x328dd4[_0x49dbf6(0x22c)](0xc8)[_0x49dbf6(0x283)](_0xdbd1b0);}catch(_0x2489da){_0x328dd4[_0x49dbf6(0x22c)](0x194)[_0x49dbf6(0x283)]({'message':_0x2489da[_0x49dbf6(0x2b4)]});}}),router[a0_0x11b028(0x26c)](a0_0x11b028(0x27e),async(_0x1956e9,_0x4db2df)=>{var _0x789e38=a0_0x11b028;try{const {FromWareHouse:_0x4db46e,FromRoom:_0x1cf94e,ToWarehouse:_0x1e5246,ToRoom:_0x42df66,product_code:_0x1c2f1d}=_0x1956e9[_0x789e38(0x25c)],_0x13f34c=await warehouse[_0x789e38(0x298)]([{'$match':{'name':_0x4db46e}},{'$unwind':_0x789e38(0x233)},{'$match':{'product_details.product_code':_0x1c2f1d}},{'$group':{'_id':_0x789e38(0x27d),'name':{'$first':_0x789e38(0x234)},'primary_code':{'$first':_0x789e38(0x254)},'secondary_code':{'$first':_0x789e38(0x29a)},'product_code':{'$first':_0x789e38(0x205)},'instock':{'$first':_0x789e38(0x22a)},'warehouse':{'$first':'$name'},'level':{'$first':_0x789e38(0x257)},'isle':{'$first':_0x789e38(0x279)},'pallet':{'$first':_0x789e38(0x21d)},'maxProducts':{'$first':_0x789e38(0x2b9)},'unit':{'$first':_0x789e38(0x2b0)}}}]);_0x4db2df['status'](0xc8)[_0x789e38(0x283)](_0x13f34c);}catch(_0x45741c){_0x4db2df[_0x789e38(0x22c)](0x194)[_0x789e38(0x283)]({'message':_0x45741c['message']});}}),router['post'](a0_0x11b028(0x22d),async(_0x65dd11,_0x425ffb)=>{var _0x4b2d38=a0_0x11b028;const {level:_0x59f0c7,isle:_0x132f20,pallet:_0x278ab4,warehouses:_0x37510a,room:_0xd5c57a}=_0x65dd11[_0x4b2d38(0x25c)];try{const _0x532f25=await warehouse[_0x4b2d38(0x298)]([{'$match':{'name':_0x37510a,'room':_0xd5c57a}},{'$unwind':_0x4b2d38(0x233)},{'$match':{'product_details.level':parseInt(_0x59f0c7),'product_details.isle':_0x132f20,'product_details.pallet':parseInt(_0x278ab4)}},{'$group':{'_id':_0x4b2d38(0x27d),'name':{'$first':_0x4b2d38(0x234)},'product_stock':{'$first':_0x4b2d38(0x22a)},'level':{'$first':_0x4b2d38(0x257)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4b2d38(0x2b9)}}}]);_0x425ffb[_0x4b2d38(0x22c)](0xc8)[_0x4b2d38(0x283)](_0x532f25);}catch(_0x2286ba){_0x425ffb[_0x4b2d38(0x22c)](0x194)['json']({'message':_0x2286ba['message']});}}),module[a0_0x11b028(0x289)]=router;