var a0_0x2c3b62=a0_0x5f45;(function(_0x3c570b,_0x1f10ee){var _0x239a16=a0_0x5f45,_0x40b6a=_0x3c570b();while(!![]){try{var _0x105228=-parseInt(_0x239a16(0xc2))/0x1+parseInt(_0x239a16(0x184))/0x2*(parseInt(_0x239a16(0x11a))/0x3)+-parseInt(_0x239a16(0x171))/0x4+parseInt(_0x239a16(0xeb))/0x5+parseInt(_0x239a16(0x11d))/0x6+-parseInt(_0x239a16(0x1a9))/0x7+parseInt(_0x239a16(0x14c))/0x8*(-parseInt(_0x239a16(0xcd))/0x9);if(_0x105228===_0x1f10ee)break;else _0x40b6a['push'](_0x40b6a['shift']());}catch(_0xf815cc){_0x40b6a['push'](_0x40b6a['shift']());}}}(a0_0x4396,0x2f907));const express=require(a0_0x2c3b62(0x18b)),app=express(),router=express[a0_0x2c3b62(0x145)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x2c3b62(0xdb)),auth=require(a0_0x2c3b62(0x1ae)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x2c3b62(0xde));router[a0_0x2c3b62(0xd7)](a0_0x2c3b62(0x161),auth,async(_0x96111d,_0x1fb65b)=>{var _0x2c95e0=a0_0x2c3b62;try{const {username:_0x1cd5ef,email:_0x4241ee,role:_0x3f8300}=_0x96111d[_0x2c95e0(0x1a0)],_0x3d20f7=_0x96111d[_0x2c95e0(0x1a0)],_0x522aa=await profile[_0x2c95e0(0x18d)]({'email':_0x3d20f7[_0x2c95e0(0x147)]}),_0x1e4970=await master_shop[_0x2c95e0(0x16b)]();console['log']('master',_0x1e4970);let _0x25c265;if(_0x3d20f7[_0x2c95e0(0xe2)]=='staff'){const _0x32c0c3=await staff[_0x2c95e0(0x18d)]({'email':_0x3d20f7[_0x2c95e0(0x147)]});_0x25c265=await transfers[_0x2c95e0(0x16b)]({'from_warehouse':_0x32c0c3[_0x2c95e0(0x151)]});}else _0x25c265=await transfers[_0x2c95e0(0xf8)]([{'$unwind':_0x2c95e0(0xcc)},{'$group':{'_id':_0x2c95e0(0xd9),'invoice':{'$first':_0x2c95e0(0x19d)},'date':{'$first':_0x2c95e0(0xfe)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x2c95e0(0xe0)},'to_room_name':{'$addToSet':_0x2c95e0(0xee)},'finalize':{'$first':_0x2c95e0(0xcf)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1e4970[0x0][_0x2c95e0(0x190)]==_0x2c95e0(0x12d)){var _0x5e8d86=users[_0x2c95e0(0x139)];console['log'](_0x5e8d86);}else{if(_0x1e4970[0x0][_0x2c95e0(0x190)]==_0x2c95e0(0x136))var _0x5e8d86=users[_0x2c95e0(0x136)];else{if(_0x1e4970[0x0]['language']==_0x2c95e0(0xdc))var _0x5e8d86=users['German'];else{if(_0x1e4970[0x0][_0x2c95e0(0x190)]==_0x2c95e0(0x144))var _0x5e8d86=users['Spanish'];else{if(_0x1e4970[0x0]['language']==_0x2c95e0(0xfa))var _0x5e8d86=users[_0x2c95e0(0xfa)];else{if(_0x1e4970[0x0][_0x2c95e0(0x190)]==_0x2c95e0(0x195))var _0x5e8d86=users[_0x2c95e0(0xf2)];else{if(_0x1e4970[0x0][_0x2c95e0(0x190)]=='Chinese')var _0x5e8d86=users[_0x2c95e0(0x15e)];else{if(_0x1e4970[0x0]['language']=='Arabic\x20(ae)')var _0x5e8d86=users[_0x2c95e0(0x131)];}}}}}}}_0x1fb65b[_0x2c95e0(0x14b)]('transfer',{'success':_0x96111d['flash'](_0x2c95e0(0x14a)),'errors':_0x96111d[_0x2c95e0(0x163)]('errors'),'role':_0x3d20f7,'profile':_0x522aa,'master_shop':_0x1e4970,'transfer':_0x25c265,'language':_0x5e8d86});}catch(_0x1887ee){console[_0x2c95e0(0x118)](_0x1887ee);}});function a0_0x5f45(_0x1f6435,_0x3b1c67){var _0x4396c6=a0_0x4396();return a0_0x5f45=function(_0x5f45b7,_0x3b65e6){_0x5f45b7=_0x5f45b7-0xc1;var _0x52626e=_0x4396c6[_0x5f45b7];return _0x52626e;},a0_0x5f45(_0x1f6435,_0x3b1c67);}function a0_0x4396(){var _0x5a5465=['$product_details.bay','role','rack','product','image','master','message','prod_cat','from_bay','Receiving\x20Area','513625ubiWDd','</body></html>','string','$product.to_room_name','json','Product\x20Transfer\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Portuguese','$product_details._id','ToRoomAssigned','Level','host','createTransport','aggregate','TRF-','French','<strong>\x20Regards\x20</strong>','$product_details.unit','from_warehouse','$date','secondary_code','Logo.png','to_warehouse','to_prod_qty','bin','errors','Shelves','updateOne','from_storage','from_prod_level','$product_details.level','staff','<span\x20style=\x22float:\x20right;\x22>','$product_details.product_code','$name','to_prod_level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Rack\x20B','to_prod_isle','Error\x20Occurs','$product_details.expiry_date','<div>','/view/:id','sendMail','/../public','log','error','40479LziYpu','product_code3','_id','1136340bSMAcY','storage','port','batch_code','/view/add_transfer','from_quantity','$product_details.product_stock','</h5>','all','<hr\x20class=\x22my-3\x22>','push','</span>','from_prod_pallet','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','bay','from_room_name','English\x20(US)','slice','post','$product_details.maxProducts','Arabic','Rack\x20D','$product_details.bin','toString','$product_details.secondary_unit','Hindi','padStart','primary_code','English','DRY\x20STORAGE','forEach','body','$product_details.type','$product_details.production_date','to_invoice','/barcode_scanner3','site_title','here','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Spanish','Router','to_room_name','email','Raw\x20Materials','/upload/','success','render','16olfThV','</tr>','<h2>\x20','Floor','Rack\x20C','warehouse','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','map','primary_unit','from_room','RoomAssigned','getDate','prod_name','finalize','random','</head><body>','<tr>','Chinese','findById','Transfer\x20Finalize\x20Successfully','/view','<h5>','flash','from_prod_qty','product_details','/preview/:id','Return\x20Rooms','type','from_floorlevel','secondary_unit','find','Enabled','redirect','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_stock','filter','123696kfioOU','</div>','$product_details.secondary_code','floorlevel','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','To_invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','</td>','to_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','maxperunit','New_Qty_Converted','An\x20error\x20occurred\x20while\x20saving\x20data.','<!DOCTYPE\x20html>','edit_transfer_view','to_bin','from_rack','id_transaction','18PGZWWb','id_transaction_id','catch','Transfer\x20Edit\x20Successfully','/transfer/view','/barcode_scanner','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','express','params','findOne','COLD\x20STORAGE','$product_details.pallet','language','to_types','to_prod_pallet','$product_details.rack','from_types','Portuguese\x20(BR)','$product_details.storage','expiry_date','<h5\x20style=\x22text-align:\x20left;\x22>','add_transfer','from_bin','product_code','/barcode_scanner2','$invoice','from_prod_isle','split','user','length','$product_details.maxPerUnit','$product_details','product_name','RMSEmail','$product_details.floorlevel','rak','maxProducts','889812qSNMKN','to_quantity','\x20Order\x20Number\x20:\x20','MaxStocks_data2','concat','../middleware/auth','$product_details.isle','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_invoice','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</thead>','50185TqVvyD','$product_details.batch_code','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.invoice','then','getMonth','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','invoice','exports','floor','$product','47268JGAwmy','production_date','$finalize','to_floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','save','edit_transfer','$product_details.product_name','unit','\x20<>\x20','get','\x20</h2>','$_id','max_per_unit','../models/all_models','German','Arabic\x20(ae)','nodemailer','$product_details.primary_code','$product.from_room_name'];a0_0x4396=function(){return _0x5a5465;};return a0_0x4396();}async function getRandom8DigitNumber(){var _0x4fb39a=a0_0x2c3b62;const _0x276d32=0x989680,_0x189bd5=0x5f5e0ff,_0x480c09=Math[_0x4fb39a(0xcb)](Math[_0x4fb39a(0x15b)]()*(_0x189bd5-_0x276d32+0x1))+_0x276d32;var _0x38d392;const _0xef0e7=await transfers[_0x4fb39a(0x18d)]({'invoice':_0x4fb39a(0xf9)+_0x480c09});return _0xef0e7&&_0xef0e7[_0x4fb39a(0x1a1)]>0x0?_0x38d392=_0x4fb39a(0xf9)+_0x480c09:_0x38d392=_0x4fb39a(0xf9)+_0x480c09,_0x38d392;}router[a0_0x2c3b62(0xd7)](a0_0x2c3b62(0x121),auth,async(_0xab20f7,_0x3f747d)=>{var _0x3654b7=a0_0x2c3b62;try{const {username:_0x5aef4b,email:_0x3473c5,role:_0x21aec5}=_0xab20f7['user'],_0x6276f8=_0xab20f7[_0x3654b7(0x1a0)],_0xc0625c=await profile[_0x3654b7(0x18d)]({'email':_0x6276f8['email']}),_0x48cce6=await master_shop[_0x3654b7(0x16b)]();console[_0x3654b7(0x118)]('master',_0x48cce6);let _0x244013;if(_0x6276f8[_0x3654b7(0xe2)]==_0x3654b7(0x10a)){const _0x2fd453=await staff['findOne']({'email':_0x6276f8[_0x3654b7(0x147)]});_0x244013=await warehouse[_0x3654b7(0xf8)]([{'$match':{'status':_0x3654b7(0x16c),'name':_0x2fd453[_0x3654b7(0x151)],'warehouse_category':_0x3654b7(0x148)}},{'$group':{'_id':_0x3654b7(0x10d),'name':{'$first':_0x3654b7(0x10d)}}}]);}else _0x244013=await warehouse[_0x3654b7(0xf8)]([{'$match':{'status':_0x3654b7(0x16c),'warehouse_category':_0x3654b7(0x148)}},{'$group':{'_id':_0x3654b7(0x10d),'name':{'$first':_0x3654b7(0x10d)}}}]);var _0x3b41f9=['Ambient','Enclosed',_0x3654b7(0x167)];const _0x166014=await transfers[_0x3654b7(0x16b)]({}),_0x2c6b64=_0x166014[_0x3654b7(0x1a1)]+0x1,_0x4c6236=_0x3654b7(0xf9)+_0x2c6b64[_0x3654b7(0x134)]()[_0x3654b7(0x137)](0x5,'0');if(_0x48cce6[0x0][_0x3654b7(0x190)]==_0x3654b7(0x12d)){var _0x397ed8=users[_0x3654b7(0x139)];console[_0x3654b7(0x118)](_0x397ed8);}else{if(_0x48cce6[0x0][_0x3654b7(0x190)]==_0x3654b7(0x136))var _0x397ed8=users[_0x3654b7(0x136)];else{if(_0x48cce6[0x0][_0x3654b7(0x190)]=='German')var _0x397ed8=users[_0x3654b7(0xdc)];else{if(_0x48cce6[0x0][_0x3654b7(0x190)]==_0x3654b7(0x144))var _0x397ed8=users[_0x3654b7(0x144)];else{if(_0x48cce6[0x0][_0x3654b7(0x190)]==_0x3654b7(0xfa))var _0x397ed8=users[_0x3654b7(0xfa)];else{if(_0x48cce6[0x0][_0x3654b7(0x190)]==_0x3654b7(0x195))var _0x397ed8=users[_0x3654b7(0xf2)];else{if(_0x48cce6[0x0][_0x3654b7(0x190)]=='Chinese')var _0x397ed8=users[_0x3654b7(0x15e)];else{if(_0x48cce6[0x0][_0x3654b7(0x190)]==_0x3654b7(0xdd))var _0x397ed8=users[_0x3654b7(0x131)];}}}}}}}const _0x4ad05e=getRandom8DigitNumber();_0x4ad05e[_0x3654b7(0xc6)](_0x20aa4b=>{var _0x138e52=_0x3654b7;_0x3f747d[_0x138e52(0x14b)](_0x138e52(0x199),{'success':_0xab20f7[_0x138e52(0x163)](_0x138e52(0x14a)),'errors':_0xab20f7[_0x138e52(0x163)]('errors'),'role':_0x6276f8,'profile':_0xc0625c,'master_shop':_0x48cce6,'warehouse':_0x244013,'language':_0x397ed8,'rooms_data':_0x3b41f9,'invoice':_0x20aa4b});})['catch'](_0x7cdf79=>{var _0x5ac0d0=_0x3654b7;_0xab20f7[_0x5ac0d0(0x163)]('errors',_0x5ac0d0(0x178)),_0x3f747d[_0x5ac0d0(0x16d)](_0x5ac0d0(0x188));});}catch(_0x1ccf50){console[_0x3654b7(0x118)](_0x1ccf50);}}),router[a0_0x2c3b62(0x12f)](a0_0x2c3b62(0x121),auth,async(_0x5c90d9,_0x1ae123)=>{var _0xf565d4=a0_0x2c3b62;try{console[_0xf565d4(0x118)](_0x5c90d9[_0xf565d4(0x13c)]);const {date:_0x14f54f,from_warehouse:_0x2dd74b,FromRoom_name:_0x832609,to_warehouse:_0x10441c,ToRoom_name:_0x41c7ec,prod_name:_0x40a14a,from_prod_qty:_0x59be66,from_prod_level:_0x51766c,from_prod_isle:_0x5c2154,from_prod_pallet:_0x58d00f,to_prod_qty:_0x401fc3,to_prod_level:_0x562e06,to_prod_isle:_0x26b237,to_prod_pallet:_0x52cc9e,primary_code:_0x33f548,secondary_code:_0x18e11b,product_code3:_0x2a105c,note:_0x2c84ce,MaxStocks_data2:_0x5ad132,invoice:_0x4f5465,expiry_date:_0x1acd08}=_0x5c90d9[_0xf565d4(0x13c)];if(typeof _0x40a14a==_0xf565d4(0xed))var _0x42a3e4=[_0x5c90d9['body'][_0xf565d4(0x159)]],_0x3ccf34=[_0x5c90d9['body'][_0xf565d4(0x164)]],_0x1f131f=[_0x5c90d9[_0xf565d4(0x13c)]['from_prod_level']],_0x3d82b7=[_0x5c90d9['body']['New_Qty_Converted']],_0x2dd73f=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x10e)]],_0x2d6718=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x138)]],_0x559834=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0xff)]],_0x5d95d=[_0x5c90d9['body'][_0xf565d4(0x11b)]],_0x1a03a5=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x1ac)]],_0x3f933f=[_0x5c90d9[_0xf565d4(0x13c)]['primary_unit']],_0x3c0036=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x16a)]],_0xc8ebf2=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x120)]],_0x3c4062=[_0x5c90d9['body'][_0xf565d4(0x197)]],_0x3ab0b9=[_0x5c90d9['body']['max_per_unit']],_0x5851ba=[_0x5c90d9['body'][_0xf565d4(0xce)]],_0x5b9588=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0xe8)]],_0x16b858=[_0x5c90d9[_0xf565d4(0x13c)]['RoomAssigned']],_0x471fab=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0xf4)]],_0x5c4a7b=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x1b2)]],_0x39c4d6=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x13f)]],_0x48afe6=[_0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x183)]];else var _0x42a3e4=[..._0x5c90d9[_0xf565d4(0x13c)]['prod_name']],_0x3ccf34=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x164)]],_0x1f131f=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x108)]],_0x3d82b7=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x17d)]],_0x2dd73f=[..._0x5c90d9['body']['to_prod_level']],_0x2d6718=[..._0x5c90d9['body']['primary_code']],_0x559834=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0xff)]],_0x5d95d=[..._0x5c90d9['body'][_0xf565d4(0x11b)]],_0x1a03a5=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x1ac)]],_0x3f933f=[..._0x5c90d9['body'][_0xf565d4(0x155)]],_0x3c0036=[..._0x5c90d9['body'][_0xf565d4(0x16a)]],_0xc8ebf2=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x120)]],_0x3c4062=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x197)]],_0x3ab0b9=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0xda)]],_0x5851ba=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0xce)]],_0x5b9588=[..._0x5c90d9['body'][_0xf565d4(0xe8)]],_0x16b858=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x157)]],_0x471fab=[..._0x5c90d9[_0xf565d4(0x13c)]['ToRoomAssigned']],_0x5c4a7b=[..._0x5c90d9['body'][_0xf565d4(0x1b2)]],_0x39c4d6=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x13f)]],_0x48afe6=[..._0x5c90d9[_0xf565d4(0x13c)][_0xf565d4(0x183)]];const _0x4f9f9d=_0x42a3e4[_0xf565d4(0x154)](_0x44bec8=>{return _0x44bec8={'product_name':_0x44bec8};});_0x3ccf34[_0xf565d4(0x13b)]((_0x46bc79,_0x590376)=>{var _0x55168b=_0xf565d4;_0x4f9f9d[_0x590376][_0x55168b(0x122)]=_0x46bc79;}),_0x5c4a7b[_0xf565d4(0x13b)]((_0x4f9d21,_0x403c5a)=>{_0x4f9f9d[_0x403c5a]['from_invoice']=_0x4f9d21;}),_0x39c4d6['forEach']((_0x4928ca,_0x4123f5)=>{var _0x4ff675=_0xf565d4;_0x4f9f9d[_0x4123f5][_0x4ff675(0x177)]=_0x4928ca;}),_0x48afe6[_0xf565d4(0x13b)]((_0xdf1220,_0x5a25f0)=>{var _0x22fe72=_0xf565d4;_0x4f9f9d[_0x5a25f0][_0x22fe72(0x185)]=_0xdf1220;}),_0x1f131f[_0xf565d4(0x13b)]((_0x3dfe9b,_0x4cf9ba)=>{var _0x770695=_0xf565d4;_0x16b858[_0x770695(0x13b)]((_0x2651b6,_0xd42e16)=>{var _0x1f523b=_0x770695;if(_0x2651b6==_0x1f523b(0xea)&&_0x4cf9ba==_0xd42e16){var _0x25e97d=_0x3dfe9b[_0x1f523b(0x12e)](0x3);_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x107)]=_0x3dfe9b[0x0],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x182)]=_0x3dfe9b[0x1],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0xe9)]=0x0,_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x19a)]=0x0,_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x194)]=_0x1f523b(0x14f),_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x169)]=_0x25e97d;}else{if(_0x2651b6==_0x1f523b(0x105)&&_0x4cf9ba==_0xd42e16){var _0x25e97d=_0x3dfe9b['slice'](0x3);_0x4f9f9d[_0x4cf9ba]['from_storage']=_0x3dfe9b[0x0],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x182)]=_0x3dfe9b[0x1],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0xe9)]=0x0,_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x19a)]=0x0,_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x194)]=_0x1f523b(0x14f),_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x169)]=_0x3dfe9b[0x5];}else{if(_0x4cf9ba==_0xd42e16){if(_0x3dfe9b[0x0]=='A'&&_0x3dfe9b[0x1]=='L'&&_0x3dfe9b[0x2]=='L')console['log'](_0x2651b6+'\x20<>\x20'+_0x4cf9ba+'\x20<>\x20'+_0xd42e16+_0x1f523b(0xd6)+_0x3dfe9b+_0x1f523b(0x142)),_0x4f9f9d[_0x4cf9ba]['from_storage']=_0x3dfe9b[0x0],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x182)]=_0x3dfe9b[0x1],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0xe9)]=0x0,_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x19a)]=0x0,_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x194)]=_0x1f523b(0x14f),_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x169)]=_0x3dfe9b[0x3];else{var _0x3ee545;if(_0x3dfe9b[0x4]=='L')_0x3ee545=_0x1f523b(0xf5);else _0x3dfe9b[0x4]=='F'&&(_0x3ee545=_0x1f523b(0x14f));_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x107)]=_0x3dfe9b[0x0],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x182)]=_0x3dfe9b[0x1],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0xe9)]=_0x3dfe9b[0x2],_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x19a)]=_0x3dfe9b[0x3],_0x4f9f9d[_0x4cf9ba]['from_types']=_0x3ee545,_0x4f9f9d[_0x4cf9ba][_0x1f523b(0x169)]=_0x3dfe9b[0x5];}}}}});}),_0x3d82b7[_0xf565d4(0x13b)]((_0x5f0b69,_0x5b7174)=>{_0x4f9f9d[_0x5b7174]['to_quantity']=_0x5f0b69;}),_0x2dd73f[_0xf565d4(0x13b)]((_0x13ec21,_0x4fe613)=>{var _0x306b69=_0xf565d4;_0x471fab[_0x306b69(0x13b)]((_0x781482,_0x1c6673)=>{var _0x56067b=_0x306b69;if(_0x781482==_0x56067b(0xea)&&_0x4fe613==_0x1c6673){var _0x46a389=_0x13ec21[_0x56067b(0x12e)](0x3);_0x4f9f9d[_0x4fe613]['storage']=_0x13ec21[0x0],_0x4f9f9d[_0x4fe613][_0x56067b(0xe3)]=_0x13ec21[0x1],_0x4f9f9d[_0x4fe613]['to_bay']=0x0,_0x4f9f9d[_0x4fe613][_0x56067b(0x181)]=0x0,_0x4f9f9d[_0x4fe613][_0x56067b(0x191)]='Floor',_0x4f9f9d[_0x4fe613][_0x56067b(0xd0)]=_0x46a389;}else{if(_0x781482=='Shelves'&&_0x4fe613==_0x1c6673){var _0x46a389=_0x13ec21[_0x56067b(0x12e)](0x3);_0x4f9f9d[_0x4fe613][_0x56067b(0x11e)]=_0x13ec21[0x0],_0x4f9f9d[_0x4fe613][_0x56067b(0xe3)]=_0x13ec21[0x1],_0x4f9f9d[_0x4fe613][_0x56067b(0x17a)]=0x0,_0x4f9f9d[_0x4fe613]['to_bin']=0x0,_0x4f9f9d[_0x4fe613][_0x56067b(0x191)]=_0x56067b(0x14f),_0x4f9f9d[_0x4fe613][_0x56067b(0xd0)]=_0x13ec21[0x5];}else{if(_0x4fe613==_0x1c6673){if(_0x13ec21[0x0]=='A'&&_0x13ec21[0x1]=='L'&&_0x13ec21[0x2]=='L')console[_0x56067b(0x118)](_0x781482+_0x56067b(0xd6)+_0x4fe613+_0x56067b(0xd6)+_0x1c6673+_0x56067b(0xd6)+_0x13ec21+_0x56067b(0x142)),_0x4f9f9d[_0x4fe613]['storage']=_0x13ec21[0x0],_0x4f9f9d[_0x4fe613][_0x56067b(0xe3)]=_0x13ec21[0x1],_0x4f9f9d[_0x4fe613][_0x56067b(0x17a)]=0x0,_0x4f9f9d[_0x4fe613][_0x56067b(0x181)]=0x0,_0x4f9f9d[_0x4fe613]['to_types']=_0x56067b(0x14f),_0x4f9f9d[_0x4fe613][_0x56067b(0xd0)]=_0x13ec21[0x3];else{var _0x42eb35;if(_0x13ec21[0x4]=='L')_0x42eb35='Level';else _0x13ec21[0x4]=='F'&&(_0x42eb35=_0x56067b(0x14f));_0x4f9f9d[_0x4fe613][_0x56067b(0x11e)]=_0x13ec21[0x0],_0x4f9f9d[_0x4fe613]['rack']=_0x13ec21[0x1],_0x4f9f9d[_0x4fe613][_0x56067b(0x17a)]=_0x13ec21[0x2],_0x4f9f9d[_0x4fe613]['to_bin']=_0x13ec21[0x3],_0x4f9f9d[_0x4fe613][_0x56067b(0x191)]=_0x42eb35,_0x4f9f9d[_0x4fe613]['to_floorlevel']=_0x13ec21[0x5];}}}}});}),_0x2d6718['forEach']((_0x17d5b9,_0x8856dc)=>{var _0x2dae54=_0xf565d4;_0x4f9f9d[_0x8856dc][_0x2dae54(0x138)]=_0x17d5b9;}),_0x559834[_0xf565d4(0x13b)]((_0x453215,_0x578008)=>{var _0x169f24=_0xf565d4;_0x4f9f9d[_0x578008][_0x169f24(0xff)]=_0x453215;}),_0x5d95d[_0xf565d4(0x13b)]((_0x3f0a03,_0x58d9f7)=>{var _0x1c3146=_0xf565d4;_0x4f9f9d[_0x58d9f7][_0x1c3146(0x19b)]=_0x3f0a03;}),_0x1a03a5['forEach']((_0x4bfcb9,_0x34ba1e)=>{_0x4f9f9d[_0x34ba1e]['maxProducts']=_0x4bfcb9;}),_0x3f933f[_0xf565d4(0x13b)]((_0x165474,_0x5a5966)=>{_0x4f9f9d[_0x5a5966]['unit']=_0x165474;}),_0x3c0036[_0xf565d4(0x13b)]((_0x464005,_0x163f74)=>{var _0x107fda=_0xf565d4;_0x4f9f9d[_0x163f74][_0x107fda(0x16a)]=_0x464005;}),_0xc8ebf2[_0xf565d4(0x13b)]((_0x41eac9,_0x2beb04)=>{var _0x58ef7d=_0xf565d4;_0x4f9f9d[_0x2beb04][_0x58ef7d(0x120)]=_0x41eac9;}),_0x3c4062[_0xf565d4(0x13b)]((_0x1bc584,_0x3fbb91)=>{_0x4f9f9d[_0x3fbb91]['expiry_date']=_0x1bc584;}),_0x3ab0b9[_0xf565d4(0x13b)]((_0x905a5c,_0x447d0b)=>{var _0x49e1a3=_0xf565d4;_0x4f9f9d[_0x447d0b][_0x49e1a3(0x17c)]=_0x905a5c;}),_0x5851ba[_0xf565d4(0x13b)]((_0x2a2310,_0x8a738e)=>{var _0x196d51=_0xf565d4;_0x4f9f9d[_0x8a738e][_0x196d51(0xce)]=_0x2a2310;}),_0x5b9588[_0xf565d4(0x13b)]((_0x2dd571,_0x39f6fd)=>{var _0x5c70c3=_0xf565d4;_0x4f9f9d[_0x39f6fd][_0x5c70c3(0xe8)]=_0x2dd571;}),_0x16b858[_0xf565d4(0x13b)]((_0x1bc79a,_0x31670c)=>{var _0x422785=_0xf565d4;_0x4f9f9d[_0x31670c][_0x422785(0x12c)]=_0x1bc79a;}),_0x471fab[_0xf565d4(0x13b)]((_0x4f8e1b,_0x228045)=>{_0x4f9f9d[_0x228045]['to_room_name']=_0x4f8e1b;});const _0x57ac8b=_0x4f9f9d[_0xf565d4(0x170)](_0x331a59=>_0x331a59[_0xf565d4(0x1aa)]!=='0'&&_0x331a59[_0xf565d4(0x1aa)]!==''||_0x331a59['to_floorlevel']!=='0'&&_0x331a59[_0xf565d4(0xd0)]!==''),_0x1e0166=new transfers({'date':_0x14f54f,'from_warehouse':_0x2dd74b,'to_warehouse':_0x10441c,'product':_0x57ac8b,'note':_0x2c84ce,'invoice':_0x4f5465}),_0x3c64d7=await _0x1e0166[_0xf565d4(0xd2)]();_0x5c90d9[_0xf565d4(0x163)]('success',_0xf565d4(0xf0)),_0x1ae123[_0xf565d4(0x16d)]('/transfer/preview/'+_0x3c64d7[_0xf565d4(0x11c)]);}catch(_0x4a9133){console['log'](_0x4a9133),_0x1ae123[_0xf565d4(0x175)](0xc8)[_0xf565d4(0xef)]({'errorMessage':_0x4a9133[_0xf565d4(0xe7)]});}}),router[a0_0x2c3b62(0xd7)](a0_0x2c3b62(0x166),auth,async(_0x56f4e8,_0x492a83)=>{var _0xefa60b=a0_0x2c3b62;try{const {username:_0x3d488e,email:_0x195481,role:_0x1d0d6a}=_0x56f4e8[_0xefa60b(0x1a0)],_0x436728=_0x56f4e8[_0xefa60b(0x1a0)],_0xd3276d=await profile['findOne']({'email':_0x436728[_0xefa60b(0x147)]}),_0x4886b6=await master_shop[_0xefa60b(0x16b)]();console[_0xefa60b(0x118)](_0xefa60b(0xe6),_0x4886b6);const _0x284783=await transfers[_0xefa60b(0x15f)](_0x56f4e8['params']['id']);let _0x4f2766=new Date(_0x284783[_0xefa60b(0x197)]),_0x31ff89=('0'+_0x4f2766[_0xefa60b(0x158)]())[_0xefa60b(0x12e)](-0x2),_0x49be2c=('0'+(_0x4f2766[_0xefa60b(0xc7)]()+0x1))[_0xefa60b(0x12e)](-0x2),_0x198b16=_0x4f2766['getFullYear'](),_0x481b63=_0x198b16+'-'+_0x49be2c+'-'+_0x31ff89,_0x540084;if(_0x436728[_0xefa60b(0xe2)]==_0xefa60b(0x10a)){const _0x212bcf=await staff[_0xefa60b(0x18d)]({'email':_0x436728['email']});_0x540084=await warehouse[_0xefa60b(0x16b)]({'status':_0xefa60b(0x16c),'name':_0x212bcf[_0xefa60b(0x151)],'warehouse_category':_0xefa60b(0x148)});}else _0x540084=await warehouse[_0xefa60b(0x16b)]({'status':_0xefa60b(0x16c),'warehouse_category':_0xefa60b(0x148)});const _0x7dc96d=await warehouse[_0xefa60b(0xf8)]([{'$match':{'name':_0x284783[_0xefa60b(0xfd)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xefa60b(0x123)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0xefa60b(0x133)},'type':{'$first':_0xefa60b(0x13d)},'floorlevel':{'$first':_0xefa60b(0x1a6)},'primary_code':{'$first':_0xefa60b(0xdf)},'secondary_code':{'$first':_0xefa60b(0x173)},'product_code':{'$first':_0xefa60b(0x10c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xefa60b(0x193)},'expiry_date':{'$first':_0xefa60b(0x113)},'production_date':{'$first':_0xefa60b(0x13e)},'room':{'$first':_0xefa60b(0x1b0)}}}]);if(_0x4886b6[0x0][_0xefa60b(0x190)]==_0xefa60b(0x12d)){var _0x464512=users[_0xefa60b(0x139)];console[_0xefa60b(0x118)](_0x464512);}else{if(_0x4886b6[0x0][_0xefa60b(0x190)]==_0xefa60b(0x136))var _0x464512=users['Hindi'];else{if(_0x4886b6[0x0][_0xefa60b(0x190)]==_0xefa60b(0xdc))var _0x464512=users[_0xefa60b(0xdc)];else{if(_0x4886b6[0x0][_0xefa60b(0x190)]==_0xefa60b(0x144))var _0x464512=users[_0xefa60b(0x144)];else{if(_0x4886b6[0x0][_0xefa60b(0x190)]=='French')var _0x464512=users[_0xefa60b(0xfa)];else{if(_0x4886b6[0x0][_0xefa60b(0x190)]==_0xefa60b(0x195))var _0x464512=users[_0xefa60b(0xf2)];else{if(_0x4886b6[0x0][_0xefa60b(0x190)]==_0xefa60b(0x15e))var _0x464512=users[_0xefa60b(0x15e)];else{if(_0x4886b6[0x0][_0xefa60b(0x190)]==_0xefa60b(0xdd))var _0x464512=users[_0xefa60b(0x131)];}}}}}}}_0x492a83[_0xefa60b(0x14b)](_0xefa60b(0x180),{'success':_0x56f4e8[_0xefa60b(0x163)](_0xefa60b(0x14a)),'errors':_0x56f4e8[_0xefa60b(0x163)](_0xefa60b(0x104)),'role':_0x436728,'profile':_0xd3276d,'master_shop':_0x4886b6,'warehouse':_0x540084,'transfer':_0x284783,'stock':_0x7dc96d,'language':_0x464512});}catch(_0x568819){console[_0xefa60b(0x118)](_0x568819);}}),router[a0_0x2c3b62(0x12f)](a0_0x2c3b62(0x166),auth,async(_0x2e08ef,_0x399f4b)=>{var _0x2507ed=a0_0x2c3b62;try{const _0x28a138=_0x2e08ef['params']['id'],{from_warehouse:_0x5652ca,FromRoom_name:_0x5c858c,to_warehouse:_0x2a4a8b,ToRoom_name:_0x39015e}=_0x2e08ef[_0x2507ed(0x13c)],_0x5ee7ea=await transfers[_0x2507ed(0x15f)]({'_id':_0x28a138}),_0x856931=_0x5ee7ea[_0x2507ed(0xe4)][_0x2507ed(0x154)](async _0xd06ada=>{var _0x348120=_0x2507ed;if(_0xd06ada[_0x348120(0x1aa)]>0x0){var _0x491023=await warehouse[_0x348120(0x18d)]({'name':_0x5ee7ea[_0x348120(0xfd)],'room':_0xd06ada['from_room_name'],'warehouse_category':_0x348120(0x148)});const _0x5d5eb3=_0x491023[_0x348120(0x165)]['map'](_0x3dec6b=>{var _0x165d76=_0x348120;_0x3dec6b['product_name']==_0xd06ada[_0x165d76(0x1a4)]&&_0x3dec6b[_0x165d76(0x174)]==_0xd06ada['from_floorlevel']&&_0x3dec6b[_0x165d76(0x168)]==_0xd06ada[_0x165d76(0x194)]&&_0x3dec6b[_0x165d76(0x103)]==_0xd06ada[_0x165d76(0x19a)]&&_0x3dec6b[_0x165d76(0x12b)]==_0xd06ada[_0x165d76(0xe9)]&&_0x3dec6b[_0x165d76(0xe3)]==_0xd06ada['from_rack']&&_0x3dec6b[_0x165d76(0x11e)]==_0xd06ada[_0x165d76(0x107)]&&_0x3dec6b[_0x165d76(0x197)]==_0xd06ada[_0x165d76(0x197)]&&_0x3dec6b[_0x165d76(0x120)]==_0xd06ada['batch_code']&&_0x3dec6b[_0x165d76(0xce)]==_0xd06ada['production_date']&&_0x3dec6b['invoice']==_0xd06ada['from_invoice']&&_0x3dec6b[_0x165d76(0x11c)]==_0xd06ada[_0x165d76(0x185)]&&(_0x3dec6b['product_stock']=_0x3dec6b[_0x165d76(0x16f)]-_0xd06ada['to_quantity']);});}return _0x491023;});Promise[_0x2507ed(0x125)](_0x856931)['then'](async _0x53a571=>{var _0x46c928=_0x2507ed;try{for(const _0x3c39ad of _0x53a571){await _0x3c39ad['save']();}try{const _0x269553=_0x5ee7ea[_0x46c928(0xe4)][_0x46c928(0x154)](async _0x58573e=>{var _0x1948be=_0x46c928;if(_0x58573e[_0x1948be(0x1aa)]>0x0){var _0x564594=await warehouse[_0x1948be(0x18d)]({'name':_0x5ee7ea[_0x1948be(0x101)],'room':_0x58573e['to_room_name'],'warehouse_category':'Raw\x20Materials'}),_0x18f84e=0x0;const _0x4e67e5=_0x564594['product_details'][_0x1948be(0x154)](_0xb0a027=>{var _0x581a20=_0x1948be;_0xb0a027['product_name']==_0x58573e['product_name']&&_0xb0a027[_0x581a20(0x174)]==_0x58573e[_0x581a20(0xd0)]&&_0xb0a027['type']==_0x58573e[_0x581a20(0x191)]&&_0xb0a027[_0x581a20(0x103)]==_0x58573e['to_bin']&&_0xb0a027[_0x581a20(0x12b)]==_0x58573e[_0x581a20(0x17a)]&&_0xb0a027[_0x581a20(0xe3)]==_0x58573e[_0x581a20(0xe3)]&&_0xb0a027[_0x581a20(0x11e)]==_0x58573e[_0x581a20(0x11e)]&&_0xb0a027['expiry_date']==_0x58573e['expiry_date']&&_0xb0a027[_0x581a20(0x120)]==_0x58573e['batch_code']&&_0xb0a027[_0x581a20(0xce)]==_0x58573e[_0x581a20(0xce)]&&_0xb0a027[_0x581a20(0xc9)]==_0x58573e['To_invoice']&&(_0xb0a027[_0x581a20(0x16f)]=_0xb0a027[_0x581a20(0x16f)]+_0x58573e[_0x581a20(0x1aa)],_0x18f84e++);});_0x18f84e=='0'&&(_0x564594[_0x1948be(0x165)]=_0x564594['product_details'][_0x1948be(0x1ad)]({'product_name':_0x58573e[_0x1948be(0x1a4)],'product_stock':_0x58573e[_0x1948be(0x1aa)],'bay':_0x58573e['to_bay'],'bin':_0x58573e['to_bin'],'type':_0x58573e[_0x1948be(0x191)],'floorlevel':_0x58573e[_0x1948be(0xd0)],'storage':_0x58573e[_0x1948be(0x11e)],'rack':_0x58573e[_0x1948be(0xe3)],'product_code':_0x58573e[_0x1948be(0x19b)],'primary_code':_0x58573e[_0x1948be(0x138)],'secondary_code':_0x58573e[_0x1948be(0xff)],'maxProducts':_0x58573e[_0x1948be(0x1a8)],'storage':_0x58573e[_0x1948be(0x11e)],'rack':_0x58573e[_0x1948be(0xe3)],'expiry_date':_0x58573e['expiry_date'],'maxPerUnit':_0x58573e['maxperunit'],'batch_code':_0x58573e[_0x1948be(0x120)],'production_date':_0x58573e[_0x1948be(0xce)]}));}return _0x564594;});Promise[_0x46c928(0x125)](_0x269553)['then'](async _0x3ff166=>{var _0x5dd591=_0x46c928;try{for(const _0x8cd798 of _0x3ff166){await warehouse[_0x5dd591(0x106)]({'_id':_0x8cd798[_0x5dd591(0x11c)]},{'$addToSet':{'product_details':{'$each':_0x8cd798[_0x5dd591(0x165)]}}});}_0x5ee7ea[_0x5dd591(0x15a)]='True';const _0x19263b=await _0x5ee7ea[_0x5dd591(0xd2)](),_0x174cc4=await master_shop['find'](),_0x58b1b6=await email_settings[_0x5dd591(0x18d)](),_0x400027=await supervisor_settings[_0x5dd591(0x16b)]();var _0x41a8ed=_0x5ee7ea[_0x5dd591(0xe4)],_0x2a4353='',_0x51a70f;for(_0x51a70f in _0x41a8ed){_0x2a4353+=_0x5dd591(0x15d)+_0x5dd591(0x16e)+_0x41a8ed[_0x51a70f][_0x5dd591(0x1a4)]+_0x5dd591(0x179)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x41a8ed[_0x51a70f]['product_code']+'</td>'+_0x5dd591(0x16e)+_0x41a8ed[_0x51a70f][_0x5dd591(0x1aa)]+_0x5dd591(0x179)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x41a8ed[_0x51a70f][_0x5dd591(0xd5)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x41a8ed[_0x51a70f]['secondary_unit']+_0x5dd591(0x179)+_0x5dd591(0x16e)+_0x5ee7ea[_0x5dd591(0x101)]+_0x5dd591(0x179)+_0x5dd591(0x16e)+_0x41a8ed[_0x51a70f][_0x5dd591(0x146)]+_0x5dd591(0x179)+_0x5dd591(0x16e)+_0x41a8ed[_0x51a70f]['storage']+_0x41a8ed[_0x51a70f]['rack']+_0x41a8ed[_0x51a70f][_0x5dd591(0x17a)]+_0x41a8ed[_0x51a70f]['to_bin']+_0x41a8ed[_0x51a70f]['to_types'][0x0]+_0x41a8ed[_0x51a70f]['to_floorlevel']+_0x5dd591(0x179),_0x5dd591(0x14d);}let _0x4b12f8=nodemailer[_0x5dd591(0xf7)]({'host':_0x58b1b6[_0x5dd591(0xf6)],'port':Number(_0x58b1b6[_0x5dd591(0x11f)]),'secure':![],'auth':{'user':_0x58b1b6[_0x5dd591(0x147)],'pass':_0x58b1b6['password']}}),_0x3403c2={'from':_0x58b1b6['email'],'to':_0x400027[0x0][_0x5dd591(0x1a5)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x5dd591(0x100),'path':__dirname+_0x5dd591(0x117)+_0x5dd591(0x149)+_0x174cc4[0x0][_0x5dd591(0xe5)],'cid':'logo'}],'html':_0x5dd591(0x17f)+'<html><head><title></title>'+_0x5dd591(0x15c)+_0x5dd591(0x114)+_0x5dd591(0x1b3)+_0x5dd591(0x114)+_0x5dd591(0xc8)+_0x5dd591(0x172)+_0x5dd591(0x114)+_0x5dd591(0x14e)+_0x174cc4[0x0]['site_title']+_0x5dd591(0xd8)+'</div>'+'</div>'+_0x5dd591(0x126)+_0x5dd591(0x114)+_0x5dd591(0x198)+_0x5dd591(0x1ab)+_0x5ee7ea['invoice']+'\x20'+_0x5dd591(0x10b)+'\x20Order\x20Date\x20:\x20'+_0x5ee7ea['date']+'\x20'+_0x5dd591(0x128)+_0x5dd591(0x124)+_0x5dd591(0x172)+_0x5dd591(0x143)+_0x5dd591(0x12a)+_0x5dd591(0x15d)+_0x5dd591(0x1b1)+_0x5dd591(0x18a)+_0x5dd591(0x17b)+_0x5dd591(0xf1)+_0x5dd591(0x153)+_0x5dd591(0x176)+_0x5dd591(0x10f)+_0x5dd591(0xd1)+_0x5dd591(0x14d)+_0x5dd591(0xc1)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x2a4353+'\x20'+'</tbody>'+'</table>'+_0x5dd591(0x114)+_0x5dd591(0xfb)+_0x5dd591(0x162)+_0x174cc4[0x0][_0x5dd591(0x141)]+_0x5dd591(0x124)+_0x5dd591(0x172)+'</div>'+_0x5dd591(0xec)};_0x4b12f8[_0x5dd591(0x116)](_0x3403c2,function(_0x5c9818,_0x82841){var _0x4c983c=_0x5dd591;_0x5c9818?(console['log'](_0x5c9818),console['log'](_0x4c983c(0x112))):console['log']('Email\x20sent\x20successfully');}),_0x2e08ef[_0x5dd591(0x163)](_0x5dd591(0x14a),_0x5dd591(0x160)),_0x399f4b['redirect']('/picking_list/PDF_transfer_rm/'+_0x19263b[_0x5dd591(0x11c)]);}catch(_0x169417){console[_0x5dd591(0x119)](_0x169417),_0x399f4b['status'](0x1f4)[_0x5dd591(0xef)]({'Perror':_0x5dd591(0x17e),'message':_0x169417[_0x5dd591(0xe7)]});}})[_0x46c928(0x186)](_0x3b18d4=>{var _0x5d3cd5=_0x46c928;console[_0x5d3cd5(0x119)](_0x3b18d4),_0x399f4b[_0x5d3cd5(0x175)](0x1f4)[_0x5d3cd5(0xef)]({'Perror':_0x5d3cd5(0x152)});});}catch(_0x623d12){_0x399f4b[_0x46c928(0xef)](_0x623d12);}}catch(_0x59673c){console[_0x46c928(0x119)](_0x59673c),_0x399f4b['status'](0x1f4)[_0x46c928(0xef)]({'Merror':_0x46c928(0x17e),'Message':_0x59673c['message']});}})[_0x2507ed(0x186)](_0x254e96=>{var _0x105f2a=_0x2507ed;console['error'](_0x254e96),_0x399f4b['status'](0x1f4)[_0x105f2a(0xef)]({'Merror':_0x105f2a(0x152)});});}catch(_0x5fdd8a){console[_0x2507ed(0x118)](_0x5fdd8a);}});function BayBinSelected(_0x33a356,_0x5c3bfc){var _0x1182a=a0_0x2c3b62,_0x542570=[],_0x40d5dc=[],_0x244d00=[],_0x3e961b=[],_0x715a33=[],_0x2e9ddd=[];let _0x337bc4=[];if(_0x33a356==_0x1182a(0x13a))switch(_0x5c3bfc){case'Rack\x20A':_0x542570=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x40d5dc=[0x1,0x2],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=['Level',_0x1182a(0x14f)],_0x715a33=['D'],_0x2e9ddd=['A'];break;case _0x1182a(0x110):_0x542570=[0x6,0x5,0x4,0x3,0x2,0x1],_0x40d5dc=[0x1,0x2],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=[_0x1182a(0xf5),_0x1182a(0x14f)],_0x715a33=['D'],_0x2e9ddd=['B'];break;case _0x1182a(0x105):_0x542570=[0x0],_0x40d5dc=[0x0],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=[_0x1182a(0x14f)],_0x715a33=['D'],_0x2e9ddd=['S'];break;case'Receiving\x20Area':_0x542570=[0x0],_0x40d5dc=[0x0],_0x3e961b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x244d00=[_0x1182a(0x14f)],_0x715a33=['D'],_0x2e9ddd=['R'];break;}else{if(_0x33a356==_0x1182a(0x18e))switch(_0x5c3bfc){case'Rack\x20A':_0x542570=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x40d5dc=['B','F'],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=[_0x1182a(0xf5),_0x1182a(0x14f)],_0x715a33=['C'],_0x2e9ddd=['A'];break;case'Rack\x20B':_0x542570=[0x5,0x4,0x3,0x2,0x1],_0x40d5dc=['F','B','S'],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=['Level','Floor'],_0x715a33=['C'],_0x2e9ddd=['B'];break;case _0x1182a(0x150):_0x542570=[0x1,0x2,0x3,0x4,0x5],_0x40d5dc=['B','F','S'],_0x3e961b=[0x5,0x4,0x3,0x2,0x1],_0x244d00=[_0x1182a(0xf5),_0x1182a(0x14f)],_0x715a33=['C'],_0x2e9ddd=['C'];break;case _0x1182a(0x132):_0x542570=[0x5,0x4,0x3,0x2,0x1],_0x40d5dc=['F','B','S'],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=[_0x1182a(0xf5),_0x1182a(0x14f)],_0x715a33=['C'],_0x2e9ddd=['D'];break;case'Rack\x20E':_0x542570=[0x4,0x3,0x2,0x1],_0x40d5dc=[0x1,0x2],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=[_0x1182a(0xf5),_0x1182a(0x14f)],_0x715a33=['C'],_0x2e9ddd=['E'];break;case'Rack\x20F':_0x542570=[0x1,0x2,0x3],_0x40d5dc=[0x1,0x2],_0x3e961b=[0x1,0x2,0x3,0x4,0x5],_0x244d00=[_0x1182a(0xf5)],_0x715a33=['C'],_0x2e9ddd=['F'];break;}}return{'levels':_0x542570,'Isle':_0x40d5dc,'rack':_0x3e961b,'type':_0x244d00,'storage':_0x715a33,'rak':_0x2e9ddd};}router['get']('/view/:id',auth,async(_0x617bde,_0x19633b)=>{var _0x109b9a=a0_0x2c3b62;try{const {username:_0x5a4bda,email:_0x564bb5,role:_0x40b7f3}=_0x617bde['user'],_0x1c8be1=_0x617bde[_0x109b9a(0x1a0)],_0x50daba=await profile[_0x109b9a(0x18d)]({'email':_0x1c8be1[_0x109b9a(0x147)]}),_0x22863a=await master_shop[_0x109b9a(0x16b)](),_0x4e81b2=await transfers['findById'](_0x617bde[_0x109b9a(0x18c)]['id']);let _0x2ecf39;if(_0x1c8be1[_0x109b9a(0xe2)]==_0x109b9a(0x10a)){const _0x404753=await staff[_0x109b9a(0x18d)]({'email':_0x1c8be1[_0x109b9a(0x147)]});_0x2ecf39=await warehouse[_0x109b9a(0xf8)]([{'$match':{'status':_0x109b9a(0x16c),'name':_0x404753['warehouse'],'warehouse_category':_0x109b9a(0x148)}},{'$group':{'_id':_0x109b9a(0x10d),'name':{'$first':_0x109b9a(0x10d)}}}]);}else _0x2ecf39=await warehouse['aggregate']([{'$match':{'status':_0x109b9a(0x16c),'warehouse_category':_0x109b9a(0x148)}},{'$group':{'_id':'$name','name':{'$first':_0x109b9a(0x10d)}}}]);const _0x17e0bc=await warehouse[_0x109b9a(0xf8)]([{'$match':{'name':_0x4e81b2[_0x109b9a(0xfd)],'warehouse_category':_0x109b9a(0x148)}},{'$unwind':_0x109b9a(0x1a3)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x109b9a(0xd4)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x109b9a(0x133)},'type':{'$first':_0x109b9a(0x13d)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x109b9a(0xdf)},'secondary_code':{'$first':_0x109b9a(0x173)},'product_code':{'$first':_0x109b9a(0x10c)},'storage':{'$first':_0x109b9a(0x196)},'rack':{'$first':_0x109b9a(0x193)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x109b9a(0x13e)},'room':{'$first':_0x109b9a(0x1b0)}}}]),_0x4e8101=await product[_0x109b9a(0x16b)]({}),_0x443e74=BayBinSelected(_0x4e81b2[_0x109b9a(0x101)],_0x4e81b2['to_room']);if(_0x22863a[0x0][_0x109b9a(0x190)]=='English\x20(US)'){var _0x154873=users[_0x109b9a(0x139)];console[_0x109b9a(0x118)](_0x154873);}else{if(_0x22863a[0x0][_0x109b9a(0x190)]==_0x109b9a(0x136))var _0x154873=users[_0x109b9a(0x136)];else{if(_0x22863a[0x0]['language']=='German')var _0x154873=users[_0x109b9a(0xdc)];else{if(_0x22863a[0x0][_0x109b9a(0x190)]=='Spanish')var _0x154873=users['Spanish'];else{if(_0x22863a[0x0]['language']=='French')var _0x154873=users[_0x109b9a(0xfa)];else{if(_0x22863a[0x0][_0x109b9a(0x190)]==_0x109b9a(0x195))var _0x154873=users[_0x109b9a(0xf2)];else{if(_0x22863a[0x0][_0x109b9a(0x190)]=='Chinese')var _0x154873=users[_0x109b9a(0x15e)];else{if(_0x22863a[0x0][_0x109b9a(0x190)]==_0x109b9a(0xdd))var _0x154873=users[_0x109b9a(0x131)];}}}}}}}_0x19633b[_0x109b9a(0x14b)](_0x109b9a(0xd3),{'success':_0x617bde[_0x109b9a(0x163)]('success'),'errors':_0x617bde[_0x109b9a(0x163)](_0x109b9a(0x104)),'role':_0x1c8be1,'profile':_0x50daba,'master_shop':_0x22863a,'warehouse':_0x2ecf39,'transfer':_0x4e81b2,'stock':_0x17e0bc,'unit':_0x4e8101,'language':_0x154873});}catch(_0x165b65){console[_0x109b9a(0x118)](_0x165b65);}}),router[a0_0x2c3b62(0x12f)](a0_0x2c3b62(0x115),auth,async(_0x556ec1,_0x52c6bc)=>{var _0x19b1db=a0_0x2c3b62;try{const _0x17b77d=_0x556ec1[_0x19b1db(0x18c)]['id'],_0x37d950=await transfers['findById'](_0x17b77d);_0x52c6bc[_0x19b1db(0xef)](_0x556ec1[_0x19b1db(0x13c)]);return;const {date:_0x3edce5,from_warehouse:_0x29d46d,FromRoom_name:_0xfcdb11,to_warehouse:_0x4623fc,ToRoom_name:_0x2ae562,prod_name:_0x311f67,from_prod_qty:_0x650cc7,from_prod_level:_0x561d38,from_prod_isle:_0x27e5c3,from_prod_pallet:_0x43acc5,to_prod_qty:_0x2c33f5,to_prod_level:_0x148337,to_prod_isle:_0x5adff8,to_prod_pallet:_0x34dd30,primary_code:_0x5512e3,secondary_code:_0x1beead,product_code3:_0x400843,note:_0x462f0f,invoice:_0x189cb0,expiry_date:_0x4bec71}=_0x556ec1[_0x19b1db(0x13c)];if(typeof _0x311f67=='string')var _0x56236e=[_0x556ec1[_0x19b1db(0x13c)]['prod_name']],_0x430cb8=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x164)]],_0x32e30b=[_0x556ec1[_0x19b1db(0x13c)]['from_prod_level']],_0x27db9a=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x19e)]],_0x33c0b4=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x129)]],_0x138ea1=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x194)]],_0x2f3632=[_0x556ec1['body'][_0x19b1db(0x102)]],_0x101ae4=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x10e)]],_0x3fb087=[_0x556ec1['body'][_0x19b1db(0x111)]],_0x26df01=[_0x556ec1['body'][_0x19b1db(0x192)]],_0x2445b2=[_0x556ec1['body']['to_types']],_0x14618c=[_0x556ec1['body'][_0x19b1db(0x11e)]],_0x2c954d=[_0x556ec1['body'][_0x19b1db(0x1a7)]],_0x31719e=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x138)]],_0x37c9b6=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0xff)]],_0x13a12f=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x11b)]],_0x464408=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x1ac)]],_0x34534c=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0xd5)]],_0x5f3674=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x16a)]],_0x514bd8=[_0x556ec1['body'][_0x19b1db(0x120)]],_0x20b938=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x197)]],_0x530e64=[_0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x107)]],_0x1c60a6=[_0x556ec1[_0x19b1db(0x13c)]['from_rak']];else var _0x56236e=[..._0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x159)]],_0x14618c=[..._0x556ec1[_0x19b1db(0x13c)]['storage']],_0x2c954d=[..._0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x1a7)]],_0x138ea1=[..._0x556ec1['body']['from_types']],_0x2445b2=[..._0x556ec1[_0x19b1db(0x13c)]['to_types']],_0x430cb8=[..._0x556ec1['body']['from_prod_qty']],_0x32e30b=[..._0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x108)]],_0x27db9a=[..._0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x19e)]],_0x33c0b4=[..._0x556ec1[_0x19b1db(0x13c)]['from_prod_pallet']],_0x2f3632=[..._0x556ec1['body'][_0x19b1db(0x102)]],_0x101ae4=[..._0x556ec1[_0x19b1db(0x13c)]['to_prod_level']],_0x3fb087=[..._0x556ec1['body'][_0x19b1db(0x111)]],_0x26df01=[..._0x556ec1['body']['to_prod_pallet']],_0x31719e=[..._0x556ec1['body'][_0x19b1db(0x138)]],_0x37c9b6=[..._0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0xff)]],_0x13a12f=[..._0x556ec1[_0x19b1db(0x13c)]['product_code3']],_0x464408=[..._0x556ec1[_0x19b1db(0x13c)]['MaxStocks_data2']],_0x34534c=[..._0x556ec1[_0x19b1db(0x13c)]['unit']],_0x5f3674=[..._0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x16a)]],_0x514bd8=[..._0x556ec1['body'][_0x19b1db(0x120)]],_0x20b938=[..._0x556ec1['body'][_0x19b1db(0x197)]],_0x530e64=[..._0x556ec1[_0x19b1db(0x13c)][_0x19b1db(0x107)]],_0x1c60a6=[..._0x556ec1[_0x19b1db(0x13c)]['from_rak']];const _0x442880=_0x56236e[_0x19b1db(0x154)](_0x26e0b6=>{return _0x26e0b6={'product_name':_0x26e0b6};});_0x430cb8[_0x19b1db(0x13b)]((_0x472cfa,_0x20ff22)=>{_0x442880[_0x20ff22]['from_quantity']=_0x472cfa;}),_0x32e30b[_0x19b1db(0x13b)]((_0x46f4a3,_0x4c1d4f)=>{_0x442880[_0x4c1d4f]['from_bay']=_0x46f4a3;}),_0x27db9a[_0x19b1db(0x13b)]((_0x31412c,_0x266b0a)=>{var _0x1b3990=_0x19b1db;_0x442880[_0x266b0a][_0x1b3990(0x19a)]=_0x31412c;}),_0x33c0b4[_0x19b1db(0x13b)]((_0xc05cad,_0x180b19)=>{var _0x193cb9=_0x19b1db;_0x442880[_0x180b19][_0x193cb9(0x169)]=_0xc05cad;}),_0x2f3632[_0x19b1db(0x13b)]((_0x466f43,_0x5e306a)=>{_0x442880[_0x5e306a]['to_quantity']=_0x466f43;}),_0x101ae4['forEach']((_0x55adb8,_0x1818ee)=>{var _0x2a3a37=_0x19b1db;_0x442880[_0x1818ee][_0x2a3a37(0x17a)]=_0x55adb8;}),_0x3fb087[_0x19b1db(0x13b)]((_0x3c8d13,_0x4957b9)=>{var _0x18ae95=_0x19b1db;_0x442880[_0x4957b9][_0x18ae95(0x181)]=_0x3c8d13;}),_0x26df01['forEach']((_0x4d7ecc,_0x59211a)=>{var _0x2a6920=_0x19b1db;_0x442880[_0x59211a][_0x2a6920(0xd0)]=_0x4d7ecc;}),_0x31719e[_0x19b1db(0x13b)]((_0x491a72,_0x2aedc1)=>{_0x442880[_0x2aedc1]['primary_code']=_0x491a72;}),_0x37c9b6[_0x19b1db(0x13b)]((_0x3cc88b,_0xc7f9b2)=>{_0x442880[_0xc7f9b2]['secondary_code']=_0x3cc88b;}),_0x13a12f['forEach']((_0xaa3187,_0x5834e8)=>{_0x442880[_0x5834e8]['product_code']=_0xaa3187;}),_0x464408[_0x19b1db(0x13b)]((_0x25908d,_0x496b81)=>{var _0x7d29b7=_0x19b1db;_0x442880[_0x496b81][_0x7d29b7(0x1a8)]=_0x25908d;}),_0x34534c[_0x19b1db(0x13b)]((_0x2b45d9,_0x225ab1)=>{var _0x11b75b=_0x19b1db;_0x442880[_0x225ab1][_0x11b75b(0xd5)]=_0x2b45d9;}),_0x5f3674[_0x19b1db(0x13b)]((_0x3353b8,_0x1ca865)=>{_0x442880[_0x1ca865]['secondary_unit']=_0x3353b8;}),_0x514bd8[_0x19b1db(0x13b)]((_0x5ca731,_0x2e48fa)=>{var _0x2af9ea=_0x19b1db;_0x442880[_0x2e48fa][_0x2af9ea(0x120)]=_0x5ca731;}),_0x20b938[_0x19b1db(0x13b)]((_0x288023,_0x3a939a)=>{_0x442880[_0x3a939a]['expiry_date']=_0x288023;}),_0x14618c[_0x19b1db(0x13b)]((_0x5504a3,_0x25faaf)=>{var _0xe7f3ac=_0x19b1db;_0x442880[_0x25faaf][_0xe7f3ac(0x11e)]=_0x5504a3;}),_0x2c954d[_0x19b1db(0x13b)]((_0x1c6a85,_0x4c2330)=>{var _0x48ec52=_0x19b1db;_0x442880[_0x4c2330][_0x48ec52(0xe3)]=_0x1c6a85;}),_0x138ea1['forEach']((_0x59a9ae,_0x54e768)=>{var _0x5c66c6=_0x19b1db;_0x442880[_0x54e768][_0x5c66c6(0x194)]=_0x59a9ae;}),_0x2445b2[_0x19b1db(0x13b)]((_0x4bbd51,_0x497f30)=>{var _0x5f4358=_0x19b1db;_0x442880[_0x497f30][_0x5f4358(0x191)]=_0x4bbd51;}),_0x530e64[_0x19b1db(0x13b)]((_0x1491cb,_0x308bb6)=>{var _0x349a79=_0x19b1db;_0x442880[_0x308bb6][_0x349a79(0x107)]=_0x1491cb;}),_0x1c60a6['forEach']((_0x3d2ef3,_0x482994)=>{_0x442880[_0x482994]['from_rack']=_0x3d2ef3;});const _0x591b45=_0x442880[_0x19b1db(0x170)](_0x536fc9=>_0x536fc9['to_quantity']!=='0'&&_0x536fc9[_0x19b1db(0x1aa)]!==''||_0x536fc9[_0x19b1db(0xd0)]!=='0'&&_0x536fc9[_0x19b1db(0xd0)]!=='');var _0x1039c9=0x0;_0x591b45[_0x19b1db(0x13b)](_0x1e0051=>{var _0x535452=_0x19b1db;parseInt(_0x1e0051[_0x535452(0x122)])<parseInt(_0x1e0051['to_quantity'])&&_0x1039c9++;});if(_0x1039c9!=0x0)return _0x556ec1[_0x19b1db(0x163)](_0x19b1db(0x104),_0x19b1db(0xc4)),_0x52c6bc[_0x19b1db(0x16d)]('back');const _0x41729c=await warehouse[_0x19b1db(0x18d)]({'name':_0x37d950[_0x19b1db(0xfd)],'room':_0x37d950[_0x19b1db(0x156)]});_0x37d950[_0x19b1db(0xe4)][_0x19b1db(0x13b)](_0x2e9119=>{var _0x3e8620=_0x19b1db;if(_0x2e9119[_0x3e8620(0x1aa)]>0x0){const _0x230a6c=_0x41729c[_0x3e8620(0x165)][_0x3e8620(0x154)](_0xe23da0=>{var _0x133627=_0x3e8620;_0xe23da0[_0x133627(0x1a4)]==_0x2e9119[_0x133627(0x1a4)]&&_0xe23da0['floorlevel']==_0x2e9119['from_floorlevel']&&_0xe23da0[_0x133627(0x168)]==_0x2e9119['from_types']&&_0xe23da0[_0x133627(0x103)]==_0x2e9119[_0x133627(0x19a)]&&_0xe23da0[_0x133627(0x12b)]==_0x2e9119[_0x133627(0xe9)]&&_0xe23da0[_0x133627(0xe3)]==_0x2e9119['from_rack']&&_0xe23da0[_0x133627(0x11e)]==_0x2e9119['from_storage']&&(_0xe23da0[_0x133627(0x16f)]=parseInt(_0xe23da0[_0x133627(0x16f)])+parseInt(_0x2e9119['to_quantity']));});}}),await _0x41729c['save']();const _0x48296e=await warehouse[_0x19b1db(0x18d)]({'name':_0x37d950['to_warehouse'],'room':_0x37d950['to_room']});_0x37d950[_0x19b1db(0xe4)]['forEach'](_0x4f89b7=>{var _0x2baf08=_0x19b1db;if(_0x4f89b7[_0x2baf08(0x1aa)]>0x0){const _0x48fae1=_0x48296e[_0x2baf08(0x165)][_0x2baf08(0x154)](_0x35994b=>{var _0x430dd1=_0x2baf08;_0x35994b[_0x430dd1(0x1a4)]==_0x4f89b7[_0x430dd1(0x1a4)]&&_0x35994b[_0x430dd1(0x174)]==_0x4f89b7[_0x430dd1(0xd0)]&&_0x35994b[_0x430dd1(0x168)]==_0x4f89b7[_0x430dd1(0x191)]&&_0x35994b[_0x430dd1(0x103)]==_0x4f89b7[_0x430dd1(0x181)]&&_0x35994b['bay']==_0x4f89b7[_0x430dd1(0x17a)]&&_0x35994b[_0x430dd1(0xe3)]==_0x4f89b7[_0x430dd1(0xe3)]&&_0x35994b[_0x430dd1(0x11e)]==_0x4f89b7[_0x430dd1(0x11e)]&&(_0x35994b[_0x430dd1(0x16f)]=parseInt(_0x35994b[_0x430dd1(0x16f)])-parseInt(_0x4f89b7[_0x430dd1(0x1aa)]));});}}),await _0x48296e[_0x19b1db(0xd2)](),_0x37d950['date']=_0x3edce5,_0x37d950[_0x19b1db(0xfd)]=_0x29d46d,_0x37d950[_0x19b1db(0x101)]=_0x4623fc,_0x37d950['product']=_0x591b45,_0x37d950['note']=_0x462f0f,_0x37d950[_0x19b1db(0xc9)]=_0x189cb0;const _0x6b8d24=await _0x37d950[_0x19b1db(0xd2)]();console[_0x19b1db(0x118)](_0x6b8d24);const _0x58c4ce=await warehouse[_0x19b1db(0x18d)]({'name':_0x29d46d,'room':_0xfcdb11});_0x6b8d24[_0x19b1db(0xe4)][_0x19b1db(0x13b)](_0x27f5f9=>{var _0x171568=_0x19b1db;if(_0x27f5f9[_0x171568(0x1aa)]>0x0){const _0xb578dd=_0x58c4ce[_0x171568(0x165)][_0x171568(0x154)](_0x4b2e03=>{var _0x9f9678=_0x171568;_0x4b2e03['product_name']==_0x27f5f9[_0x9f9678(0x1a4)]&&_0x4b2e03[_0x9f9678(0x174)]==_0x27f5f9[_0x9f9678(0x169)]&&_0x4b2e03['type']==_0x27f5f9[_0x9f9678(0x194)]&&_0x4b2e03[_0x9f9678(0x103)]==_0x27f5f9['from_bin']&&_0x4b2e03[_0x9f9678(0x12b)]==_0x27f5f9[_0x9f9678(0xe9)]&&_0x4b2e03[_0x9f9678(0xe3)]==_0x27f5f9['from_rack']&&_0x4b2e03[_0x9f9678(0x11e)]==_0x27f5f9['from_storage']&&(_0x4b2e03[_0x9f9678(0x16f)]=parseInt(_0x4b2e03[_0x9f9678(0x16f)])-parseInt(_0x27f5f9[_0x9f9678(0x1aa)]));});}}),await _0x58c4ce['save']();const _0xad75bf=await warehouse[_0x19b1db(0x18d)]({'name':_0x4623fc,'room':_0x2ae562});_0x6b8d24[_0x19b1db(0xe4)][_0x19b1db(0x13b)](_0x898639=>{var _0x6497e0=_0x19b1db;if(_0x898639[_0x6497e0(0x1aa)]>0x0){var _0x5bc43a=0x0;const _0x26383c=_0xad75bf['product_details'][_0x6497e0(0x154)](_0x245faf=>{var _0xacc060=_0x6497e0;_0x245faf['product_name']==_0x898639[_0xacc060(0x1a4)]&&_0x245faf[_0xacc060(0x174)]==_0x898639[_0xacc060(0xd0)]&&_0x245faf[_0xacc060(0x168)]==_0x898639['to_types']&&_0x245faf[_0xacc060(0x103)]==_0x898639['to_bin']&&_0x245faf['bay']==_0x898639['to_bay']&&_0x245faf[_0xacc060(0xe3)]==_0x898639[_0xacc060(0xe3)]&&_0x245faf[_0xacc060(0x11e)]==_0x898639['storage']&&(_0x245faf[_0xacc060(0x16f)]=parseInt(_0x245faf['product_stock'])+parseInt(_0x898639[_0xacc060(0x1aa)]),_0x5bc43a++);});_0x5bc43a=='0'&&(_0xad75bf[_0x6497e0(0x165)]=_0xad75bf[_0x6497e0(0x165)]['concat']({'product_name':_0x898639[_0x6497e0(0x1a4)],'product_stock':_0x898639['to_quantity'],'bay':_0x898639[_0x6497e0(0x17a)],'bin':_0x898639[_0x6497e0(0x181)],'type':_0x898639[_0x6497e0(0x191)],'floorlevel':_0x898639[_0x6497e0(0xd0)],'storage':_0x898639[_0x6497e0(0x11e)],'rack':_0x898639[_0x6497e0(0xe3)],'product_code':_0x898639[_0x6497e0(0x19b)],'primary_code':_0x898639['primary_code'],'secondary_code':_0x898639[_0x6497e0(0xff)],'maxProducts':_0x898639['maxProducts'],'storage':_0x898639[_0x6497e0(0x11e)],'rack':_0x898639[_0x6497e0(0xe3)]}));}}),await _0xad75bf[_0x19b1db(0xd2)](),_0x556ec1['flash']('success',_0x19b1db(0x187)),_0x52c6bc[_0x19b1db(0x16d)]('/transfer/view');}catch(_0x2b339f){console[_0x19b1db(0x118)](_0x2b339f);}}),router[a0_0x2c3b62(0x12f)](a0_0x2c3b62(0x189),async(_0x25439d,_0xdc1ebb)=>{var _0x3541cd=a0_0x2c3b62;const {FromWareHouse:_0x55de6e,FromRoom:_0x5a7899,ToWarehouse:_0x4c5a16,ToRoom:_0x5c1f79,primary_code:_0x17519b,Roomslist:_0x3156bd}=_0x25439d['body'],_0x43a4ad=_0x3156bd[_0x3541cd(0x19f)](','),_0x544531=[];async function _0x55183e(_0xaf5537){var _0x37bd5a=_0x3541cd;const _0x2de164=await warehouse[_0x37bd5a(0xf8)]([{'$match':{'name':_0x55de6e,'room':_0xaf5537}},{'$unwind':_0x37bd5a(0x1a3)},{'$match':{'product_details.primary_code':_0x17519b}},{'$group':{'_id':_0x37bd5a(0xf3),'name':{'$first':_0x37bd5a(0xd4)},'instock':{'$first':_0x37bd5a(0x123)},'primary_code':{'$first':_0x37bd5a(0xdf)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x37bd5a(0xe1)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x37bd5a(0x1a6)},'unit':{'$first':_0x37bd5a(0xfc)},'secondary_unit':{'$first':_0x37bd5a(0x135)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x37bd5a(0x193)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x37bd5a(0x13e)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x37bd5a(0x1a2)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x37bd5a(0x1b0)},'maxProducts':{'$first':_0x37bd5a(0x130)},'invoice_product':{'$first':_0x37bd5a(0xc5)}}}]),_0x1f670e=await warehouse[_0x37bd5a(0xf8)]([{'$match':{'name':_0x55de6e,'room':_0xaf5537}},{'$unwind':_0x37bd5a(0x1a3)},{'$match':{'product_details.secondary_code':_0x17519b}},{'$group':{'_id':_0x37bd5a(0xf3),'name':{'$first':_0x37bd5a(0xd4)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x37bd5a(0x173)},'product_code':{'$first':_0x37bd5a(0x10c)},'level':{'$first':_0x37bd5a(0xe1)},'isle':{'$first':_0x37bd5a(0x133)},'type':{'$first':_0x37bd5a(0x13d)},'pallet':{'$first':_0x37bd5a(0x1a6)},'unit':{'$first':_0x37bd5a(0xfc)},'secondary_unit':{'$first':_0x37bd5a(0x135)},'storage':{'$first':_0x37bd5a(0x196)},'rack':{'$first':_0x37bd5a(0x193)},'expiry_date':{'$first':_0x37bd5a(0x113)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x37bd5a(0xc3)},'maxPerUnit':{'$first':_0x37bd5a(0x1a2)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x37bd5a(0x1b0)},'maxProducts':{'$first':_0x37bd5a(0x130)},'invoice_product':{'$first':_0x37bd5a(0xc5)}}}]);if(_0x2de164[_0x37bd5a(0x1a1)]>0x0)_0x544531[_0x37bd5a(0x127)](_0x2de164);else _0x1f670e[_0x37bd5a(0x1a1)]>0x0&&_0x544531[_0x37bd5a(0x127)](_0x1f670e);}const _0x9b69b0=_0x43a4ad[_0x3541cd(0x154)](_0xf394c6=>_0x55183e(_0xf394c6));await Promise[_0x3541cd(0x125)](_0x9b69b0),_0xdc1ebb['json'](_0x544531);}),router[a0_0x2c3b62(0x12f)](a0_0x2c3b62(0x19c),async(_0x37f8e2,_0x4bb5dc)=>{var _0x26f6e7=a0_0x2c3b62;try{const {FromWareHouse:_0x55011c,FromRoom:_0x140a3e,ToWarehouse:_0x522896,ToRoom:_0x393111,secondary_code:_0x302938}=_0x37f8e2[_0x26f6e7(0x13c)],_0xa78236=await warehouse[_0x26f6e7(0xf8)]([{'$match':{'name':_0x55011c}},{'$unwind':_0x26f6e7(0x1a3)},{'$match':{'product_details.secondary_code':_0x302938}},{'$group':{'_id':_0x26f6e7(0xf3),'name':{'$first':_0x26f6e7(0xd4)},'primary_code':{'$first':_0x26f6e7(0xdf)},'secondary_code':{'$first':_0x26f6e7(0x173)},'product_code':{'$first':_0x26f6e7(0x10c)},'instock':{'$first':_0x26f6e7(0x123)},'warehouse':{'$first':_0x26f6e7(0x10d)},'level':{'$first':_0x26f6e7(0x109)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x26f6e7(0x18f)},'maxProducts':{'$first':_0x26f6e7(0x130)},'unit':{'$first':_0x26f6e7(0xfc)}}}]);_0x4bb5dc[_0x26f6e7(0x175)](0xc8)[_0x26f6e7(0xef)](_0xa78236);}catch(_0x104245){_0x4bb5dc[_0x26f6e7(0x175)](0x194)['json']({'message':_0x104245[_0x26f6e7(0xe7)]});}}),router[a0_0x2c3b62(0x12f)](a0_0x2c3b62(0x140),async(_0x17f9b7,_0x550dea)=>{var _0x34a032=a0_0x2c3b62;try{const {FromWareHouse:_0x5e2c23,FromRoom:_0x34b8be,ToWarehouse:_0x4fb74d,ToRoom:_0x33b68a,product_code:_0x107555}=_0x17f9b7[_0x34a032(0x13c)],_0x2da43f=await warehouse[_0x34a032(0xf8)]([{'$match':{'name':_0x5e2c23}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x107555}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x34a032(0xd4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x34a032(0x173)},'product_code':{'$first':_0x34a032(0x10c)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x34a032(0x10d)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x34a032(0x1af)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x34a032(0x130)},'unit':{'$first':_0x34a032(0xfc)}}}]);_0x550dea[_0x34a032(0x175)](0xc8)['json'](_0x2da43f);}catch(_0xf2c585){_0x550dea['status'](0x194)[_0x34a032(0xef)]({'message':_0xf2c585['message']});}}),router[a0_0x2c3b62(0x12f)]('/CheckingWarehouse',async(_0x4db86d,_0x313b8e)=>{var _0x7a392d=a0_0x2c3b62;const {level:_0x4851fd,isle:_0x5235fb,pallet:_0x212658,warehouses:_0x4a7e1a,room:_0x3c5226}=_0x4db86d[_0x7a392d(0x13c)];try{const _0x259746=await warehouse[_0x7a392d(0xf8)]([{'$match':{'name':_0x4a7e1a,'room':_0x3c5226}},{'$unwind':_0x7a392d(0x1a3)},{'$match':{'product_details.level':parseInt(_0x4851fd),'product_details.isle':_0x5235fb,'product_details.pallet':parseInt(_0x212658)}},{'$group':{'_id':_0x7a392d(0xf3),'name':{'$first':_0x7a392d(0xd4)},'product_stock':{'$first':_0x7a392d(0x123)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x7a392d(0x1af)},'pallet':{'$first':_0x7a392d(0x18f)},'maxProducts':{'$first':_0x7a392d(0x130)}}}]);_0x313b8e[_0x7a392d(0x175)](0xc8)[_0x7a392d(0xef)](_0x259746);}catch(_0x4bba7f){_0x313b8e['status'](0x194)[_0x7a392d(0xef)]({'message':_0x4bba7f['message']});}}),module[a0_0x2c3b62(0xca)]=router;