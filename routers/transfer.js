var a0_0x4fdf90=a0_0x5c1d;(function(_0x4eb374,_0x4194a6){var _0x8cdd68=a0_0x5c1d,_0x30c59c=_0x4eb374();while(!![]){try{var _0x360cb8=-parseInt(_0x8cdd68(0x1a8))/0x1+parseInt(_0x8cdd68(0x1a3))/0x2+-parseInt(_0x8cdd68(0x233))/0x3+-parseInt(_0x8cdd68(0x1d2))/0x4*(-parseInt(_0x8cdd68(0x227))/0x5)+-parseInt(_0x8cdd68(0x1dc))/0x6+-parseInt(_0x8cdd68(0x1cf))/0x7*(parseInt(_0x8cdd68(0x244))/0x8)+parseInt(_0x8cdd68(0x225))/0x9;if(_0x360cb8===_0x4194a6)break;else _0x30c59c['push'](_0x30c59c['shift']());}catch(_0x300ad6){_0x30c59c['push'](_0x30c59c['shift']());}}}(a0_0x2171,0x81ea9));const express=require(a0_0x4fdf90(0x176)),app=express(),router=express[a0_0x4fdf90(0x239)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x4fdf90(0x1b3)),auth=require('../middleware/auth'),users=require(a0_0x4fdf90(0x15e)),nodemailer=require(a0_0x4fdf90(0x1a9));router['get'](a0_0x4fdf90(0x1e9),auth,async(_0x326d50,_0x1d02a1)=>{var _0x35e91f=a0_0x4fdf90;try{const {username:_0x251f23,email:_0x16b109,role:_0x4bbe49}=_0x326d50['user'],_0x5d20fe=_0x326d50['user'],_0x10a553=await profile[_0x35e91f(0x1b1)]({'email':_0x5d20fe['email']}),_0x61c206=await master_shop[_0x35e91f(0x1e7)]();console[_0x35e91f(0x243)]('master',_0x61c206);let _0x25bf52;if(_0x5d20fe[_0x35e91f(0x245)]==_0x35e91f(0x160)){const _0x3e541c=await staff[_0x35e91f(0x1b1)]({'email':_0x5d20fe[_0x35e91f(0x190)]});_0x25bf52=await transfers[_0x35e91f(0x1e7)]({'from_warehouse':_0x3e541c[_0x35e91f(0x240)]});}else _0x25bf52=await transfers[_0x35e91f(0x18b)]([{'$unwind':_0x35e91f(0x19e)},{'$group':{'_id':_0x35e91f(0x19d),'invoice':{'$first':_0x35e91f(0x209)},'date':{'$first':_0x35e91f(0x1ac)},'from_warehouse':{'$first':_0x35e91f(0x20c)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x35e91f(0x212)},'to_room_name':{'$addToSet':_0x35e91f(0x235)},'finalize':{'$first':_0x35e91f(0x229)},'isAllowEdit':{'$first':_0x35e91f(0x20d)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x61c206[0x0][_0x35e91f(0x1b6)]==_0x35e91f(0x17f)){var _0x31c9d8=users['English'];console['log'](_0x31c9d8);}else{if(_0x61c206[0x0][_0x35e91f(0x1b6)]=='Hindi')var _0x31c9d8=users[_0x35e91f(0x1be)];else{if(_0x61c206[0x0][_0x35e91f(0x1b6)]=='German')var _0x31c9d8=users['German'];else{if(_0x61c206[0x0][_0x35e91f(0x1b6)]=='Spanish')var _0x31c9d8=users[_0x35e91f(0x1ca)];else{if(_0x61c206[0x0]['language']==_0x35e91f(0x187))var _0x31c9d8=users['French'];else{if(_0x61c206[0x0][_0x35e91f(0x1b6)]==_0x35e91f(0x1eb))var _0x31c9d8=users[_0x35e91f(0x241)];else{if(_0x61c206[0x0][_0x35e91f(0x1b6)]==_0x35e91f(0x1d1))var _0x31c9d8=users[_0x35e91f(0x1d1)];else{if(_0x61c206[0x0][_0x35e91f(0x1b6)]=='Arabic\x20(ae)')var _0x31c9d8=users[_0x35e91f(0x15b)];}}}}}}}_0x1d02a1[_0x35e91f(0x1d5)]('transfer',{'success':_0x326d50[_0x35e91f(0x22b)]('success'),'errors':_0x326d50[_0x35e91f(0x22b)](_0x35e91f(0x195)),'role':_0x5d20fe,'profile':_0x10a553,'master_shop':_0x61c206,'transfer':_0x25bf52,'language':_0x31c9d8});}catch(_0xb1d506){console[_0x35e91f(0x243)](_0xb1d506);}});async function getRandom8DigitNumber(){var _0x2b6d8f=a0_0x4fdf90;const _0x310fc5=0x989680,_0x190c5b=0x5f5e0ff,_0x6bbb26=Math['floor'](Math[_0x2b6d8f(0x22c)]()*(_0x190c5b-_0x310fc5+0x1))+_0x310fc5;var _0x18f5f5;const _0x29d6dd=await transfers[_0x2b6d8f(0x1b1)]({'invoice':_0x2b6d8f(0x199)+_0x6bbb26});return _0x29d6dd&&_0x29d6dd[_0x2b6d8f(0x167)]>0x0?_0x18f5f5=_0x2b6d8f(0x199)+_0x6bbb26:_0x18f5f5=_0x2b6d8f(0x199)+_0x6bbb26,_0x18f5f5;}router[a0_0x4fdf90(0x164)]('/view/add_transfer',auth,async(_0x5c9f45,_0x576062)=>{var _0x1c68e0=a0_0x4fdf90;try{const {username:_0x421c04,email:_0xefcd5,role:_0x446f14}=_0x5c9f45[_0x1c68e0(0x1f0)],_0xaabc46=_0x5c9f45[_0x1c68e0(0x1f0)],_0x2ef0de=await profile['findOne']({'email':_0xaabc46[_0x1c68e0(0x190)]}),_0x26a370=await master_shop[_0x1c68e0(0x1e7)]();console[_0x1c68e0(0x243)](_0x1c68e0(0x178),_0x26a370);let _0x1b7b05;if(_0xaabc46[_0x1c68e0(0x245)]=='staff'){const _0x19c533=await staff[_0x1c68e0(0x1b1)]({'email':_0xaabc46['email']});_0x1b7b05=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x19c533[_0x1c68e0(0x240)],'warehouse_category':_0x1c68e0(0x1bf)}},{'$group':{'_id':_0x1c68e0(0x189),'name':{'$first':_0x1c68e0(0x189)}}}]);}else _0x1b7b05=await warehouse[_0x1c68e0(0x18b)]([{'$match':{'status':_0x1c68e0(0x18d),'warehouse_category':_0x1c68e0(0x1bf)}},{'$group':{'_id':_0x1c68e0(0x189),'name':{'$first':_0x1c68e0(0x189)}}}]);var _0x2bb4d6=[_0x1c68e0(0x1c4),_0x1c68e0(0x1e1),_0x1c68e0(0x237)];const _0x146c26=await transfers[_0x1c68e0(0x1e7)]({}),_0x12f8ca=_0x146c26[_0x1c68e0(0x167)]+0x1,_0x24d958='TRF-'+_0x12f8ca[_0x1c68e0(0x16f)]()['padStart'](0x5,'0');if(_0x26a370[0x0][_0x1c68e0(0x1b6)]==_0x1c68e0(0x17f)){var _0x50131f=users[_0x1c68e0(0x1aa)];console[_0x1c68e0(0x243)](_0x50131f);}else{if(_0x26a370[0x0][_0x1c68e0(0x1b6)]==_0x1c68e0(0x1be))var _0x50131f=users[_0x1c68e0(0x1be)];else{if(_0x26a370[0x0][_0x1c68e0(0x1b6)]=='German')var _0x50131f=users['German'];else{if(_0x26a370[0x0][_0x1c68e0(0x1b6)]=='Spanish')var _0x50131f=users[_0x1c68e0(0x1ca)];else{if(_0x26a370[0x0][_0x1c68e0(0x1b6)]==_0x1c68e0(0x187))var _0x50131f=users[_0x1c68e0(0x187)];else{if(_0x26a370[0x0][_0x1c68e0(0x1b6)]=='Portuguese\x20(BR)')var _0x50131f=users[_0x1c68e0(0x241)];else{if(_0x26a370[0x0][_0x1c68e0(0x1b6)]==_0x1c68e0(0x1d1))var _0x50131f=users[_0x1c68e0(0x1d1)];else{if(_0x26a370[0x0][_0x1c68e0(0x1b6)]=='Arabic\x20(ae)')var _0x50131f=users[_0x1c68e0(0x15b)];}}}}}}}const _0x30b715=getRandom8DigitNumber();_0x30b715['then'](_0x301948=>{var _0x59d915=_0x1c68e0;_0x576062[_0x59d915(0x1d5)]('add_transfer',{'success':_0x5c9f45[_0x59d915(0x22b)](_0x59d915(0x215)),'errors':_0x5c9f45[_0x59d915(0x22b)](_0x59d915(0x195)),'role':_0xaabc46,'profile':_0x2ef0de,'master_shop':_0x26a370,'warehouse':_0x1b7b05,'language':_0x50131f,'rooms_data':_0x2bb4d6,'invoice':_0x301948});})[_0x1c68e0(0x159)](_0x36b95b=>{var _0x3f1330=_0x1c68e0;_0x5c9f45[_0x3f1330(0x22b)](_0x3f1330(0x195),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x576062[_0x3f1330(0x202)]('/transfer/view');});}catch(_0x43995e){console[_0x1c68e0(0x243)](_0x43995e);}}),router[a0_0x4fdf90(0x1d4)](a0_0x4fdf90(0x18e),auth,async(_0x59ea8f,_0x3d9700)=>{var _0x19cfbf=a0_0x4fdf90;try{console[_0x19cfbf(0x243)](_0x59ea8f[_0x19cfbf(0x1cb)]);const {date:_0x204b4b,from_warehouse:_0x4bb2a7,FromRoom_name:_0x1325a6,to_warehouse:_0x5b6f3d,ToRoom_name:_0x41da62,prod_name:_0xe6bcd,from_prod_qty:_0x213cc9,from_prod_level:_0x549f99,from_prod_isle:_0x8bdd9a,from_prod_pallet:_0x185798,to_prod_qty:_0x16530b,to_prod_level:_0x468ed9,to_prod_isle:_0x3bfac1,to_prod_pallet:_0x56c2ee,primary_code:_0x5708a0,secondary_code:_0x44d090,product_code3:_0x5bf532,note:_0xdb27ff,MaxStocks_data2:_0x11c33d,invoice:_0x568dd2,expiry_date:_0x151f37}=_0x59ea8f[_0x19cfbf(0x1cb)];if(typeof _0xe6bcd==_0x19cfbf(0x21a))var _0x42a386=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x180)]],_0x30c50=[_0x59ea8f[_0x19cfbf(0x1cb)]['from_prod_qty']],_0x447f4f=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1c6)]],_0x4265f1=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x23d)]],_0x162cdb=[_0x59ea8f[_0x19cfbf(0x1cb)]['to_prod_level']],_0x1bbe68=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1fb)]],_0x5b86bb=[_0x59ea8f[_0x19cfbf(0x1cb)]['secondary_code']],_0x2793b5=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x185)]],_0x174044=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x196)]],_0xd105e5=[_0x59ea8f['body']['primary_unit']],_0x3589b7=[_0x59ea8f[_0x19cfbf(0x1cb)]['secondary_unit']],_0x1e1cf6=[_0x59ea8f['body']['batch_code']],_0x17d015=[_0x59ea8f['body']['expiry_date']],_0x662c2c=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1b0)]],_0x910ebc=[_0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x16e)]],_0x170984=[_0x59ea8f[_0x19cfbf(0x1cb)]['prod_cat']],_0x45bd84=[_0x59ea8f['body']['RoomAssigned']],_0x566135=[_0x59ea8f[_0x19cfbf(0x1cb)]['ToRoomAssigned']],_0x4a08b2=[_0x59ea8f['body'][_0x19cfbf(0x230)]],_0x18e4e0=[_0x59ea8f[_0x19cfbf(0x1cb)]['to_invoice']];else var _0x42a386=[..._0x59ea8f[_0x19cfbf(0x1cb)]['prod_name']],_0x30c50=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x191)]],_0x447f4f=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1c6)]],_0x4265f1=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x23d)]],_0x162cdb=[..._0x59ea8f[_0x19cfbf(0x1cb)]['to_prod_level']],_0x1bbe68=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1fb)]],_0x5b86bb=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1c9)]],_0x2793b5=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x185)]],_0x174044=[..._0x59ea8f['body']['MaxStocks_data2']],_0xd105e5=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1a7)]],_0x3589b7=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1ce)]],_0x1e1cf6=[..._0x59ea8f[_0x19cfbf(0x1cb)]['batch_code']],_0x17d015=[..._0x59ea8f['body']['expiry_date']],_0x662c2c=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x1b0)]],_0x910ebc=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x16e)]],_0x170984=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x19f)]],_0x45bd84=[..._0x59ea8f['body'][_0x19cfbf(0x15f)]],_0x566135=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x17e)]],_0x4a08b2=[..._0x59ea8f[_0x19cfbf(0x1cb)][_0x19cfbf(0x230)]],_0x18e4e0=[..._0x59ea8f[_0x19cfbf(0x1cb)]['to_invoice']];const _0x4e7eb6=_0x42a386['map'](_0x5c5bcc=>{return _0x5c5bcc={'product_name':_0x5c5bcc};});_0x30c50[_0x19cfbf(0x20e)]((_0x2b6338,_0x5b6ecc)=>{_0x4e7eb6[_0x5b6ecc]['from_quantity']=_0x2b6338;}),_0x4a08b2[_0x19cfbf(0x20e)]((_0x5812ec,_0x3c7981)=>{var _0x178885=_0x19cfbf;_0x4e7eb6[_0x3c7981][_0x178885(0x230)]=_0x5812ec;}),_0x18e4e0['forEach']((_0x25d7f5,_0x507af9)=>{var _0xabf8ce=_0x19cfbf;_0x4e7eb6[_0x507af9][_0xabf8ce(0x188)]=_0x25d7f5;}),_0x447f4f[_0x19cfbf(0x20e)]((_0x30d505,_0x209deb)=>{var _0x4fb100=_0x19cfbf;_0x45bd84[_0x4fb100(0x20e)]((_0x564c2f,_0x3b6564)=>{var _0x1dcedd=_0x4fb100;if(_0x564c2f==_0x1dcedd(0x193)&&_0x209deb==_0x3b6564){var _0x3b30f7=_0x30d505[_0x1dcedd(0x1d7)](0x3);_0x4e7eb6[_0x209deb][_0x1dcedd(0x1d0)]=_0x30d505[0x0],_0x4e7eb6[_0x209deb][_0x1dcedd(0x1f1)]=_0x30d505[0x1],_0x4e7eb6[_0x209deb][_0x1dcedd(0x23f)]=0x0,_0x4e7eb6[_0x209deb][_0x1dcedd(0x205)]=0x0,_0x4e7eb6[_0x209deb]['from_types']=_0x1dcedd(0x172),_0x4e7eb6[_0x209deb][_0x1dcedd(0x174)]=_0x3b30f7;}else{if(_0x564c2f==_0x1dcedd(0x1b2)&&_0x209deb==_0x3b6564){var _0x3b30f7=_0x30d505[_0x1dcedd(0x1d7)](0x3);_0x4e7eb6[_0x209deb][_0x1dcedd(0x1d0)]=_0x30d505[0x0],_0x4e7eb6[_0x209deb]['from_rack']=_0x30d505[0x1],_0x4e7eb6[_0x209deb][_0x1dcedd(0x23f)]=0x0,_0x4e7eb6[_0x209deb][_0x1dcedd(0x205)]=0x0,_0x4e7eb6[_0x209deb]['from_types']='Floor',_0x4e7eb6[_0x209deb][_0x1dcedd(0x174)]=_0x30d505[0x5];}else{if(_0x209deb==_0x3b6564){var _0x5363be;if(_0x30d505[0x4]=='L')_0x5363be='Level';else _0x30d505[0x4]=='F'&&(_0x5363be=_0x1dcedd(0x172));_0x4e7eb6[_0x209deb][_0x1dcedd(0x1d0)]=_0x30d505[0x0],_0x4e7eb6[_0x209deb]['from_rack']=_0x30d505[0x1],_0x4e7eb6[_0x209deb][_0x1dcedd(0x23f)]=_0x30d505[0x2],_0x4e7eb6[_0x209deb]['from_bin']=_0x30d505[0x3],_0x4e7eb6[_0x209deb][_0x1dcedd(0x217)]=_0x5363be,_0x4e7eb6[_0x209deb][_0x1dcedd(0x174)]=_0x30d505[0x5];}}}});}),_0x4265f1[_0x19cfbf(0x20e)]((_0x353309,_0x22b7f5)=>{var _0x2bc3b3=_0x19cfbf;_0x4e7eb6[_0x22b7f5][_0x2bc3b3(0x15a)]=_0x353309;}),_0x162cdb[_0x19cfbf(0x20e)]((_0x553dc3,_0x14a571)=>{var _0x2cca65=_0x19cfbf;_0x566135[_0x2cca65(0x20e)]((_0x2aa292,_0x513a9f)=>{var _0x140cd8=_0x2cca65;if(_0x2aa292==_0x140cd8(0x193)&&_0x14a571==_0x513a9f){var _0x2e33ff=_0x553dc3[_0x140cd8(0x1d7)](0x3);_0x4e7eb6[_0x14a571]['storage']=_0x553dc3[0x0],_0x4e7eb6[_0x14a571][_0x140cd8(0x19b)]=_0x553dc3[0x1],_0x4e7eb6[_0x14a571]['to_bay']=0x0,_0x4e7eb6[_0x14a571][_0x140cd8(0x1ab)]=0x0,_0x4e7eb6[_0x14a571][_0x140cd8(0x18c)]=_0x140cd8(0x172),_0x4e7eb6[_0x14a571][_0x140cd8(0x194)]=_0x2e33ff;}else{if(_0x2aa292==_0x140cd8(0x1b2)&&_0x14a571==_0x513a9f){var _0x2e33ff=_0x553dc3[_0x140cd8(0x1d7)](0x3);_0x4e7eb6[_0x14a571][_0x140cd8(0x1d8)]=_0x553dc3[0x0],_0x4e7eb6[_0x14a571]['rack']=_0x553dc3[0x1],_0x4e7eb6[_0x14a571][_0x140cd8(0x23b)]=0x0,_0x4e7eb6[_0x14a571][_0x140cd8(0x1ab)]=0x0,_0x4e7eb6[_0x14a571][_0x140cd8(0x18c)]=_0x140cd8(0x172),_0x4e7eb6[_0x14a571][_0x140cd8(0x194)]=_0x553dc3[0x5];}else{if(_0x14a571==_0x513a9f){var _0x18b936;if(_0x553dc3[0x4]=='L')_0x18b936=_0x140cd8(0x238);else _0x553dc3[0x4]=='F'&&(_0x18b936=_0x140cd8(0x172));_0x4e7eb6[_0x14a571][_0x140cd8(0x1d8)]=_0x553dc3[0x0],_0x4e7eb6[_0x14a571][_0x140cd8(0x19b)]=_0x553dc3[0x1],_0x4e7eb6[_0x14a571][_0x140cd8(0x23b)]=_0x553dc3[0x2],_0x4e7eb6[_0x14a571]['to_bin']=_0x553dc3[0x3],_0x4e7eb6[_0x14a571]['to_types']=_0x18b936,_0x4e7eb6[_0x14a571][_0x140cd8(0x194)]=_0x553dc3[0x5];}}}});}),_0x1bbe68[_0x19cfbf(0x20e)]((_0x470e72,_0x27e3a9)=>{_0x4e7eb6[_0x27e3a9]['primary_code']=_0x470e72;}),_0x5b86bb[_0x19cfbf(0x20e)]((_0x42b859,_0x36b7af)=>{_0x4e7eb6[_0x36b7af]['secondary_code']=_0x42b859;}),_0x2793b5[_0x19cfbf(0x20e)]((_0x17c926,_0x3329a5)=>{var _0x4711ac=_0x19cfbf;_0x4e7eb6[_0x3329a5][_0x4711ac(0x218)]=_0x17c926;}),_0x174044[_0x19cfbf(0x20e)]((_0xdf0c72,_0x2dbee1)=>{_0x4e7eb6[_0x2dbee1]['maxProducts']=_0xdf0c72;}),_0xd105e5[_0x19cfbf(0x20e)]((_0x1d7c1c,_0x30b3c6)=>{var _0x2d349d=_0x19cfbf;_0x4e7eb6[_0x30b3c6][_0x2d349d(0x1da)]=_0x1d7c1c;}),_0x3589b7[_0x19cfbf(0x20e)]((_0x469a89,_0x324c81)=>{var _0x1c0fd8=_0x19cfbf;_0x4e7eb6[_0x324c81][_0x1c0fd8(0x1ce)]=_0x469a89;}),_0x1e1cf6[_0x19cfbf(0x20e)]((_0x213566,_0x2b933e)=>{var _0x2a14d6=_0x19cfbf;_0x4e7eb6[_0x2b933e][_0x2a14d6(0x1cc)]=_0x213566;}),_0x17d015['forEach']((_0x564fd7,_0x51437a)=>{var _0x1c4e75=_0x19cfbf;_0x4e7eb6[_0x51437a][_0x1c4e75(0x246)]=_0x564fd7;}),_0x662c2c[_0x19cfbf(0x20e)]((_0x4a73a3,_0x4ec544)=>{var _0x410bec=_0x19cfbf;_0x4e7eb6[_0x4ec544][_0x410bec(0x184)]=_0x4a73a3;}),_0x910ebc[_0x19cfbf(0x20e)]((_0x4cdcc1,_0x454c84)=>{var _0x16c1ca=_0x19cfbf;_0x4e7eb6[_0x454c84][_0x16c1ca(0x16e)]=_0x4cdcc1;}),_0x170984[_0x19cfbf(0x20e)]((_0x3fa21f,_0x5dcbf6)=>{var _0x1b9a5c=_0x19cfbf;_0x4e7eb6[_0x5dcbf6][_0x1b9a5c(0x19f)]=_0x3fa21f;}),_0x45bd84[_0x19cfbf(0x20e)]((_0x30f05d,_0x1001e9)=>{var _0x2990f1=_0x19cfbf;_0x4e7eb6[_0x1001e9][_0x2990f1(0x16a)]=_0x30f05d;}),_0x566135[_0x19cfbf(0x20e)]((_0x267043,_0x130ad4)=>{var _0x2ab0b3=_0x19cfbf;_0x4e7eb6[_0x130ad4][_0x2ab0b3(0x169)]=_0x267043;});const _0x1a05b4=_0x4e7eb6['filter'](_0x2a26d4=>_0x2a26d4[_0x19cfbf(0x15a)]!=='0'&&_0x2a26d4[_0x19cfbf(0x15a)]!==''||_0x2a26d4[_0x19cfbf(0x194)]!=='0'&&_0x2a26d4[_0x19cfbf(0x194)]!==''),_0x1e8917=new transfers({'date':_0x204b4b,'from_warehouse':_0x4bb2a7,'to_warehouse':_0x5b6f3d,'product':_0x1a05b4,'note':_0xdb27ff,'invoice':_0x568dd2}),_0x1f6868=await _0x1e8917[_0x19cfbf(0x1ea)]();_0x59ea8f['flash'](_0x19cfbf(0x215),_0x19cfbf(0x1d3)),_0x3d9700[_0x19cfbf(0x202)]('/transfer/preview/'+_0x1f6868[_0x19cfbf(0x182)]);}catch(_0x3773b6){console[_0x19cfbf(0x243)](_0x3773b6),_0x3d9700[_0x19cfbf(0x231)](0xc8)[_0x19cfbf(0x1f3)]({'errorMessage':_0x3773b6[_0x19cfbf(0x1fa)]});}}),router[a0_0x4fdf90(0x164)](a0_0x4fdf90(0x213),auth,async(_0x1ab48a,_0xe3974c)=>{var _0x2b266e=a0_0x4fdf90;try{const {username:_0x531f56,email:_0x54d2f7,role:_0x33df50}=_0x1ab48a[_0x2b266e(0x1f0)],_0x1f18af=_0x1ab48a['user'],_0x170a0c=await profile[_0x2b266e(0x1b1)]({'email':_0x1f18af['email']}),_0x1c745b=await master_shop['find']();console[_0x2b266e(0x243)]('master',_0x1c745b);const _0x3eaee8=await transfers[_0x2b266e(0x1e6)](_0x1ab48a['params']['id']);let _0x1ddacf=new Date(_0x3eaee8[_0x2b266e(0x246)]),_0x4eb355=('0'+_0x1ddacf[_0x2b266e(0x1c2)]())['slice'](-0x2),_0x2da04e=('0'+(_0x1ddacf[_0x2b266e(0x1e0)]()+0x1))[_0x2b266e(0x1d7)](-0x2),_0x3e9a51=_0x1ddacf[_0x2b266e(0x21c)](),_0x154fe9=_0x3e9a51+'-'+_0x2da04e+'-'+_0x4eb355,_0x531727;if(_0x1f18af[_0x2b266e(0x245)]==_0x2b266e(0x160)){const _0x351053=await staff[_0x2b266e(0x1b1)]({'email':_0x1f18af[_0x2b266e(0x190)]});_0x531727=await warehouse[_0x2b266e(0x1e7)]({'status':_0x2b266e(0x18d),'name':_0x351053[_0x2b266e(0x240)],'warehouse_category':_0x2b266e(0x1bf)});}else _0x531727=await warehouse[_0x2b266e(0x1e7)]({'status':_0x2b266e(0x18d),'warehouse_category':_0x2b266e(0x1bf)});const _0x3ee1b8=await warehouse[_0x2b266e(0x18b)]([{'$match':{'name':_0x3eaee8[_0x2b266e(0x21e)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2b266e(0x22f),'name':{'$first':_0x2b266e(0x1ad)},'product_stock':{'$first':_0x2b266e(0x1df)},'bay':{'$first':_0x2b266e(0x1a2)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2b266e(0x234)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2b266e(0x210)},'product_code':{'$first':_0x2b266e(0x214)},'storage':{'$first':_0x2b266e(0x1ed)},'rack':{'$first':_0x2b266e(0x17b)},'expiry_date':{'$first':_0x2b266e(0x1b9)},'production_date':{'$first':_0x2b266e(0x173)},'room':{'$first':_0x2b266e(0x168)}}}]);if(_0x1c745b[0x0][_0x2b266e(0x1b6)]==_0x2b266e(0x17f)){var _0x3619fd=users[_0x2b266e(0x1aa)];console[_0x2b266e(0x243)](_0x3619fd);}else{if(_0x1c745b[0x0][_0x2b266e(0x1b6)]==_0x2b266e(0x1be))var _0x3619fd=users[_0x2b266e(0x1be)];else{if(_0x1c745b[0x0][_0x2b266e(0x1b6)]==_0x2b266e(0x186))var _0x3619fd=users['German'];else{if(_0x1c745b[0x0][_0x2b266e(0x1b6)]==_0x2b266e(0x1ca))var _0x3619fd=users[_0x2b266e(0x1ca)];else{if(_0x1c745b[0x0][_0x2b266e(0x1b6)]==_0x2b266e(0x187))var _0x3619fd=users['French'];else{if(_0x1c745b[0x0]['language']==_0x2b266e(0x1eb))var _0x3619fd=users[_0x2b266e(0x241)];else{if(_0x1c745b[0x0]['language']==_0x2b266e(0x1d1))var _0x3619fd=users[_0x2b266e(0x1d1)];else{if(_0x1c745b[0x0][_0x2b266e(0x1b6)]==_0x2b266e(0x1b4))var _0x3619fd=users[_0x2b266e(0x15b)];}}}}}}}_0xe3974c[_0x2b266e(0x1d5)](_0x2b266e(0x1ee),{'success':_0x1ab48a[_0x2b266e(0x22b)]('success'),'errors':_0x1ab48a['flash'](_0x2b266e(0x195)),'role':_0x1f18af,'profile':_0x170a0c,'master_shop':_0x1c745b,'warehouse':_0x531727,'transfer':_0x3eaee8,'stock':_0x3ee1b8,'language':_0x3619fd});}catch(_0xeea829){console[_0x2b266e(0x243)](_0xeea829);}}),router['post'](a0_0x4fdf90(0x213),auth,async(_0x330735,_0x75f227)=>{var _0x37feff=a0_0x4fdf90;try{const _0x229875=_0x330735[_0x37feff(0x1de)]['id'],{from_warehouse:_0x244e1a,FromRoom_name:_0xe5cb75,to_warehouse:_0x431505,ToRoom_name:_0x3375a0}=_0x330735[_0x37feff(0x1cb)],_0x259c9c=await transfers[_0x37feff(0x1e6)]({'_id':_0x229875}),_0x1acb56=_0x259c9c[_0x37feff(0x248)][_0x37feff(0x170)](async _0x459af7=>{var _0x5cb8f5=_0x37feff;if(_0x459af7[_0x5cb8f5(0x15a)]>0x0){var _0x1b0d15=await warehouse[_0x5cb8f5(0x1b1)]({'name':_0x259c9c[_0x5cb8f5(0x21e)],'room':_0x459af7[_0x5cb8f5(0x16a)],'warehouse_category':_0x5cb8f5(0x1bf)});const _0x61a927=_0x1b0d15[_0x5cb8f5(0x1cd)][_0x5cb8f5(0x170)](_0x107815=>{var _0x3b97ef=_0x5cb8f5;_0x107815['product_name']==_0x459af7['product_name']&&_0x107815[_0x3b97ef(0x16c)]==_0x459af7['from_floorlevel']&&_0x107815['type']==_0x459af7[_0x3b97ef(0x217)]&&_0x107815[_0x3b97ef(0x179)]==_0x459af7[_0x3b97ef(0x205)]&&_0x107815[_0x3b97ef(0x198)]==_0x459af7[_0x3b97ef(0x23f)]&&_0x107815[_0x3b97ef(0x19b)]==_0x459af7[_0x3b97ef(0x1f1)]&&_0x107815['storage']==_0x459af7[_0x3b97ef(0x1d0)]&&_0x107815[_0x3b97ef(0x246)]==_0x459af7[_0x3b97ef(0x246)]&&_0x107815[_0x3b97ef(0x1cc)]==_0x459af7['batch_code']&&_0x107815[_0x3b97ef(0x16e)]==_0x459af7[_0x3b97ef(0x16e)]&&_0x107815['invoice']==_0x459af7['from_invoice']&&(_0x107815[_0x3b97ef(0x23a)]=_0x107815[_0x3b97ef(0x23a)]-_0x459af7[_0x3b97ef(0x15a)]);});}return _0x1b0d15;});Promise[_0x37feff(0x19c)](_0x1acb56)['then'](async _0xc1f1ac=>{var _0x18884e=_0x37feff;try{for(const _0x445a47 of _0xc1f1ac){await _0x445a47['save']();}try{const _0x28a315=_0x259c9c['product'][_0x18884e(0x170)](async _0x373f03=>{var _0x5de21d=_0x18884e;if(_0x373f03[_0x5de21d(0x15a)]>0x0){var _0x45234a=await warehouse[_0x5de21d(0x1b1)]({'name':_0x259c9c[_0x5de21d(0x1db)],'room':_0x373f03['to_room_name'],'warehouse_category':_0x5de21d(0x1bf)}),_0x727260=0x0;const _0x3ff64c=_0x45234a[_0x5de21d(0x1cd)][_0x5de21d(0x170)](_0xa8b080=>{var _0x5156e5=_0x5de21d;_0xa8b080['product_name']==_0x373f03['product_name']&&_0xa8b080['floorlevel']==_0x373f03['to_floorlevel']&&_0xa8b080['type']==_0x373f03[_0x5156e5(0x18c)]&&_0xa8b080[_0x5156e5(0x179)]==_0x373f03['to_bin']&&_0xa8b080[_0x5156e5(0x198)]==_0x373f03[_0x5156e5(0x23b)]&&_0xa8b080[_0x5156e5(0x19b)]==_0x373f03[_0x5156e5(0x19b)]&&_0xa8b080[_0x5156e5(0x1d8)]==_0x373f03['storage']&&_0xa8b080[_0x5156e5(0x246)]==_0x373f03['expiry_date']&&_0xa8b080[_0x5156e5(0x1cc)]==_0x373f03[_0x5156e5(0x1cc)]&&_0xa8b080['production_date']==_0x373f03[_0x5156e5(0x16e)]&&_0xa8b080['invoice']==_0x373f03['To_invoice']&&(_0xa8b080[_0x5156e5(0x23a)]=_0xa8b080[_0x5156e5(0x23a)]+_0x373f03[_0x5156e5(0x15a)],_0x727260++);});_0x727260=='0'&&(_0x45234a[_0x5de21d(0x1cd)]=_0x45234a['product_details']['concat']({'product_name':_0x373f03[_0x5de21d(0x1ec)],'product_stock':_0x373f03[_0x5de21d(0x15a)],'bay':_0x373f03[_0x5de21d(0x23b)],'bin':_0x373f03[_0x5de21d(0x1ab)],'type':_0x373f03['to_types'],'floorlevel':_0x373f03[_0x5de21d(0x194)],'storage':_0x373f03[_0x5de21d(0x1d8)],'rack':_0x373f03[_0x5de21d(0x19b)],'product_code':_0x373f03[_0x5de21d(0x218)],'primary_code':_0x373f03[_0x5de21d(0x1fb)],'secondary_code':_0x373f03[_0x5de21d(0x1c9)],'maxProducts':_0x373f03[_0x5de21d(0x166)],'storage':_0x373f03[_0x5de21d(0x1d8)],'rack':_0x373f03[_0x5de21d(0x19b)],'expiry_date':_0x373f03[_0x5de21d(0x246)],'maxPerUnit':_0x373f03[_0x5de21d(0x184)],'batch_code':_0x373f03[_0x5de21d(0x1cc)],'production_date':_0x373f03['production_date']}));}return _0x45234a;});Promise['all'](_0x28a315)[_0x18884e(0x181)](async _0x5b0fe5=>{var _0x2fa11e=_0x18884e;try{for(const _0xd847a0 of _0x5b0fe5){await warehouse[_0x2fa11e(0x223)]({'_id':_0xd847a0[_0x2fa11e(0x182)]},{'$addToSet':{'product_details':{'$each':_0xd847a0[_0x2fa11e(0x1cd)]}}});}_0x259c9c[_0x2fa11e(0x16b)]=_0x2fa11e(0x19a);const _0x5df4f5=await _0x259c9c[_0x2fa11e(0x1ea)](),_0x6ec87a=await master_shop[_0x2fa11e(0x1e7)](),_0x23e2c0=await email_settings['findOne'](),_0x35a5fb=await supervisor_settings[_0x2fa11e(0x1e7)]();var _0x4e263f=_0x259c9c['product'],_0x403401='',_0x31e8dc;for(_0x31e8dc in _0x4e263f){_0x403401+=_0x2fa11e(0x17a)+_0x2fa11e(0x1e5)+_0x4e263f[_0x31e8dc]['product_name']+'</td>'+_0x2fa11e(0x1e5)+_0x4e263f[_0x31e8dc][_0x2fa11e(0x218)]+'</td>'+_0x2fa11e(0x1e5)+_0x4e263f[_0x31e8dc][_0x2fa11e(0x15a)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4e263f[_0x31e8dc][_0x2fa11e(0x1da)]+'</td>'+_0x2fa11e(0x1e5)+_0x4e263f[_0x31e8dc][_0x2fa11e(0x1ce)]+_0x2fa11e(0x1a0)+_0x2fa11e(0x1e5)+_0x259c9c[_0x2fa11e(0x1db)]+_0x2fa11e(0x1a0)+_0x2fa11e(0x1e5)+_0x4e263f[_0x31e8dc][_0x2fa11e(0x169)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4e263f[_0x31e8dc][_0x2fa11e(0x1d8)]+_0x4e263f[_0x31e8dc][_0x2fa11e(0x19b)]+_0x4e263f[_0x31e8dc][_0x2fa11e(0x23b)]+_0x4e263f[_0x31e8dc][_0x2fa11e(0x1ab)]+_0x4e263f[_0x31e8dc][_0x2fa11e(0x18c)][0x0]+_0x4e263f[_0x31e8dc]['to_floorlevel']+_0x2fa11e(0x1a0),'</tr>';}let _0x14303a=nodemailer[_0x2fa11e(0x1af)]({'host':_0x23e2c0['host'],'port':Number(_0x23e2c0[_0x2fa11e(0x17c)]),'secure':![],'auth':{'user':_0x23e2c0[_0x2fa11e(0x190)],'pass':_0x23e2c0[_0x2fa11e(0x1d9)]}}),_0x345a98={'from':_0x23e2c0[_0x2fa11e(0x190)],'to':_0x35a5fb[0x0]['RMSEmail'],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x2fa11e(0x24a),'path':__dirname+_0x2fa11e(0x242)+_0x2fa11e(0x21d)+_0x6ec87a[0x0][_0x2fa11e(0x1fc)],'cid':_0x2fa11e(0x206)}],'html':_0x2fa11e(0x16d)+_0x2fa11e(0x203)+_0x2fa11e(0x20b)+_0x2fa11e(0x1b7)+_0x2fa11e(0x22d)+_0x2fa11e(0x1b7)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2fa11e(0x1c3)+_0x2fa11e(0x1b7)+_0x2fa11e(0x192)+_0x6ec87a[0x0]['site_title']+_0x2fa11e(0x228)+_0x2fa11e(0x1c3)+_0x2fa11e(0x1c3)+_0x2fa11e(0x1a1)+'<div>'+_0x2fa11e(0x1fd)+_0x2fa11e(0x226)+_0x259c9c['invoice']+'\x20'+_0x2fa11e(0x1e2)+'\x20Order\x20Date\x20:\x20'+_0x259c9c['date']+'\x20'+_0x2fa11e(0x1b5)+_0x2fa11e(0x165)+_0x2fa11e(0x1c3)+_0x2fa11e(0x1a4)+_0x2fa11e(0x1bc)+'<tr>'+_0x2fa11e(0x1fe)+_0x2fa11e(0x1c5)+_0x2fa11e(0x211)+_0x2fa11e(0x1e4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x2fa11e(0x208)+_0x2fa11e(0x247)+'</tr>'+_0x2fa11e(0x1a5)+_0x2fa11e(0x1c1)+'\x20'+_0x403401+'\x20'+_0x2fa11e(0x220)+_0x2fa11e(0x162)+_0x2fa11e(0x1b7)+_0x2fa11e(0x20f)+'<h5>'+_0x6ec87a[0x0][_0x2fa11e(0x224)]+'</h5>'+_0x2fa11e(0x1c3)+_0x2fa11e(0x1c3)+_0x2fa11e(0x1f2)};_0x14303a['sendMail'](_0x345a98,function(_0x5b88fc,_0x40bb90){var _0x3b37ca=_0x2fa11e;_0x5b88fc?(console[_0x3b37ca(0x243)](_0x5b88fc),console[_0x3b37ca(0x243)](_0x3b37ca(0x207))):console[_0x3b37ca(0x243)](_0x3b37ca(0x197));}),_0x330735[_0x2fa11e(0x22b)]('success',_0x2fa11e(0x15d)),_0x75f227['redirect'](_0x2fa11e(0x1f6)+_0x5df4f5[_0x2fa11e(0x182)]);}catch(_0x11380c){console[_0x2fa11e(0x1c7)](_0x11380c),_0x75f227[_0x2fa11e(0x231)](0x1f4)['json']({'Perror':_0x2fa11e(0x1ef),'message':_0x11380c[_0x2fa11e(0x1fa)]});}})[_0x18884e(0x159)](_0x201810=>{var _0x45d77c=_0x18884e;console[_0x45d77c(0x1c7)](_0x201810),_0x75f227['status'](0x1f4)[_0x45d77c(0x1f3)]({'Perror':_0x45d77c(0x161)});});}catch(_0x12cf1f){_0x75f227['json'](_0x12cf1f);}}catch(_0x33133f){console['error'](_0x33133f),_0x75f227[_0x18884e(0x231)](0x1f4)[_0x18884e(0x1f3)]({'Merror':_0x18884e(0x1ef),'Message':_0x33133f['message']});}})[_0x37feff(0x159)](_0xa5aa77=>{var _0x49fa1d=_0x37feff;console[_0x49fa1d(0x1c7)](_0xa5aa77),_0x75f227['status'](0x1f4)[_0x49fa1d(0x1f3)]({'Merror':_0x49fa1d(0x161)});});}catch(_0x1b25ff){console['log'](_0x1b25ff);}});function BayBinSelected(_0xe1d397,_0x571e87){var _0x22cf05=a0_0x4fdf90,_0x48506b=[],_0x2fda56=[],_0x59957f=[],_0x58a4f9=[],_0x1536ae=[],_0x2cc69b=[];let _0x377196=[];if(_0xe1d397==_0x22cf05(0x1ae))switch(_0x571e87){case _0x22cf05(0x1bd):_0x48506b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2fda56=[0x1,0x2],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=[_0x22cf05(0x238),_0x22cf05(0x172)],_0x1536ae=['D'],_0x2cc69b=['A'];break;case'Rack\x20B':_0x48506b=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2fda56=[0x1,0x2],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=[_0x22cf05(0x238),_0x22cf05(0x172)],_0x1536ae=['D'],_0x2cc69b=['B'];break;case _0x22cf05(0x1b2):_0x48506b=[0x0],_0x2fda56=[0x0],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=['Floor'],_0x1536ae=['D'],_0x2cc69b=['S'];break;case _0x22cf05(0x193):_0x48506b=[0x0],_0x2fda56=[0x0],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x59957f=[_0x22cf05(0x172)],_0x1536ae=['D'],_0x2cc69b=['R'];break;}else{if(_0xe1d397==_0x22cf05(0x201))switch(_0x571e87){case _0x22cf05(0x1bd):_0x48506b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2fda56=['B','F'],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=[_0x22cf05(0x238),_0x22cf05(0x172)],_0x1536ae=['C'],_0x2cc69b=['A'];break;case _0x22cf05(0x1a6):_0x48506b=[0x5,0x4,0x3,0x2,0x1],_0x2fda56=['F','B','S'],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=[_0x22cf05(0x238),_0x22cf05(0x172)],_0x1536ae=['C'],_0x2cc69b=['B'];break;case _0x22cf05(0x20a):_0x48506b=[0x1,0x2,0x3,0x4,0x5],_0x2fda56=['B','F','S'],_0x58a4f9=[0x5,0x4,0x3,0x2,0x1],_0x59957f=['Level','Floor'],_0x1536ae=['C'],_0x2cc69b=['C'];break;case'Rack\x20D':_0x48506b=[0x5,0x4,0x3,0x2,0x1],_0x2fda56=['F','B','S'],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=[_0x22cf05(0x238),'Floor'],_0x1536ae=['C'],_0x2cc69b=['D'];break;case'Rack\x20E':_0x48506b=[0x4,0x3,0x2,0x1],_0x2fda56=[0x1,0x2],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=[_0x22cf05(0x238),'Floor'],_0x1536ae=['C'],_0x2cc69b=['E'];break;case _0x22cf05(0x219):_0x48506b=[0x1,0x2,0x3],_0x2fda56=[0x1,0x2],_0x58a4f9=[0x1,0x2,0x3,0x4,0x5],_0x59957f=['Level'],_0x1536ae=['C'],_0x2cc69b=['F'];break;}}return{'levels':_0x48506b,'Isle':_0x2fda56,'rack':_0x58a4f9,'type':_0x59957f,'storage':_0x1536ae,'rak':_0x2cc69b};}function a0_0x2171(){var _0x29d6e5=['to_prod_level','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Rack\x20A','Hindi','Raw\x20Materials','filter','<tbody\x20style=\x22text-align:\x20center;\x22>','getDate','</div>','Ambient','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','from_prod_level','error','$product_details.unit','secondary_code','Spanish','body','batch_code','product_details','secondary_unit','198499zEUBDy','from_storage','Chinese','4hAhnXU','Product\x20Transfer\x20successfully','post','render','$product_details.secondary_unit','slice','storage','password','unit','to_warehouse','4105968SPJEyx','$product_details.primary_code','params','$product_details.product_stock','getMonth','Enclosed','<span\x20style=\x22float:\x20right;\x22>','to_room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','findById','find','/CheckingWarehouse','/view','save','Portuguese\x20(BR)','product_name','$product_details.storage','edit_transfer_view','An\x20error\x20occurred\x20while\x20saving\x20data.','user','from_rack','</body></html>','json','date','/barcode_scanner','/picking_list/PDF_transfer_rm/','/barcode_scanner3','to_prod_qty','back','message','primary_code','image','<h5\x20style=\x22text-align:\x20left;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.pallet','to_prod_pallet','COLD\x20STORAGE','redirect','<html><head><title></title>','$product_details.level','from_bin','logo','Error\x20Occurs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$invoice','Rack\x20C','</head><body>','$from_warehouse','$isAllowEdit','forEach','<strong>\x20Regards\x20</strong>','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product.from_room_name','/preview/:id','$product_details.product_code','success','/view/:id','from_types','product_code','Rack\x20F','string','type','getFullYear','/upload/','from_warehouse','$product_details.bin','</tbody>','Transfer\x20Edit\x20Successfully','from_prod_isle','updateOne','site_title','7023942xhZlgY','\x20Order\x20Number\x20:\x20','3567965jnachk','\x20</h2>','$finalize','note','flash','random','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.maxPerUnit','$product_details._id','from_invoice','status','invoice','1143714yhTrmx','$product_details.type','$product.to_room_name','split','Return\x20Rooms','Level','Router','product_stock','to_bay','push','New_Qty_Converted','$product_details.maxProducts','from_bay','warehouse','Portuguese','/../public','log','16rooNYo','role','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','product','$product_details.floorlevel','Logo.png','catch','to_quantity','Arabic','exports','Transfer\x20Finalize\x20Successfully','../public/language/languages.json','RoomAssigned','staff','An\x20error\x20occurred.','</table>','$product_details.batch_code','get','</h5>','maxProducts','length','$room','to_room_name','from_room_name','finalize','floorlevel','<!DOCTYPE\x20html>','production_date','toString','map','to_prod_isle','Floor','$product_details.production_date','from_floorlevel','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','express','/transfer/view','master','bin','<tr>','$product_details.rack','port','$product_details','ToRoomAssigned','English\x20(US)','prod_name','then','_id','$product_details.isle','maxperunit','product_code3','German','French','To_invoice','$name','from_prod_pallet','aggregate','to_types','Enabled','/view/add_transfer','from_rak','email','from_prod_qty','<h2>\x20','Receiving\x20Area','to_floorlevel','errors','MaxStocks_data2','Email\x20sent\x20successfully','bay','TRF-','True','rack','all','$_id','$product','prod_cat','</td>','<hr\x20class=\x22my-3\x22>','$product_details.bay','770586UJkoPg','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</thead>','Rack\x20B','primary_unit','224907kHsMHY','nodemailer','English','to_bin','$date','$product_details.product_name','DRY\x20STORAGE','createTransport','max_per_unit','findOne','Shelves','../models/all_models','Arabic\x20(ae)','</span>','language','<div>','/barcode_scanner2','$product_details.expiry_date','from_quantity'];a0_0x2171=function(){return _0x29d6e5;};return a0_0x2171();}function a0_0x5c1d(_0x15cb96,_0x41036f){var _0x21712b=a0_0x2171();return a0_0x5c1d=function(_0x5c1d46,_0x3d7996){_0x5c1d46=_0x5c1d46-0x159;var _0x2c5e39=_0x21712b[_0x5c1d46];return _0x2c5e39;},a0_0x5c1d(_0x15cb96,_0x41036f);}router[a0_0x4fdf90(0x164)](a0_0x4fdf90(0x216),auth,async(_0x367778,_0x5bc18f)=>{var _0x3ea845=a0_0x4fdf90;try{const {username:_0x14056b,email:_0x5478ce,role:_0x3d606f}=_0x367778[_0x3ea845(0x1f0)],_0x574499=_0x367778[_0x3ea845(0x1f0)],_0xe011ae=await profile[_0x3ea845(0x1b1)]({'email':_0x574499[_0x3ea845(0x190)]}),_0x349f0a=await master_shop[_0x3ea845(0x1e7)](),_0x5b4254=await transfers['findById'](_0x367778[_0x3ea845(0x1de)]['id']);let _0x3c0d24;if(_0x574499[_0x3ea845(0x245)]==_0x3ea845(0x160)){const _0x2e8e1f=await staff['findOne']({'email':_0x574499[_0x3ea845(0x190)]});_0x3c0d24=await warehouse[_0x3ea845(0x18b)]([{'$match':{'status':_0x3ea845(0x18d),'name':_0x2e8e1f[_0x3ea845(0x240)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3ea845(0x189),'name':{'$first':_0x3ea845(0x189)}}}]);}else _0x3c0d24=await warehouse[_0x3ea845(0x18b)]([{'$match':{'status':_0x3ea845(0x18d),'warehouse_category':_0x3ea845(0x1bf)}},{'$group':{'_id':_0x3ea845(0x189),'name':{'$first':'$name'}}}]);const _0x323bd6=await warehouse[_0x3ea845(0x18b)]([{'$match':{'name':_0x5b4254['from_warehouse'],'warehouse_category':_0x3ea845(0x1bf)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3ea845(0x22f),'name':{'$first':_0x3ea845(0x1ad)},'product_stock':{'$first':_0x3ea845(0x1df)},'bay':{'$first':_0x3ea845(0x1a2)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x3ea845(0x1dd)},'secondary_code':{'$first':_0x3ea845(0x210)},'product_code':{'$first':_0x3ea845(0x214)},'storage':{'$first':_0x3ea845(0x1ed)},'rack':{'$first':_0x3ea845(0x17b)},'expiry_date':{'$first':_0x3ea845(0x1b9)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0x5c9ebf=await product[_0x3ea845(0x1e7)]({}),_0x3837b4=BayBinSelected(_0x5b4254[_0x3ea845(0x1db)],_0x5b4254[_0x3ea845(0x1e3)]);if(_0x349f0a[0x0][_0x3ea845(0x1b6)]==_0x3ea845(0x17f)){var _0x227cca=users[_0x3ea845(0x1aa)];console[_0x3ea845(0x243)](_0x227cca);}else{if(_0x349f0a[0x0][_0x3ea845(0x1b6)]==_0x3ea845(0x1be))var _0x227cca=users[_0x3ea845(0x1be)];else{if(_0x349f0a[0x0][_0x3ea845(0x1b6)]=='German')var _0x227cca=users[_0x3ea845(0x186)];else{if(_0x349f0a[0x0][_0x3ea845(0x1b6)]==_0x3ea845(0x1ca))var _0x227cca=users[_0x3ea845(0x1ca)];else{if(_0x349f0a[0x0][_0x3ea845(0x1b6)]==_0x3ea845(0x187))var _0x227cca=users['French'];else{if(_0x349f0a[0x0]['language']==_0x3ea845(0x1eb))var _0x227cca=users['Portuguese'];else{if(_0x349f0a[0x0][_0x3ea845(0x1b6)]==_0x3ea845(0x1d1))var _0x227cca=users[_0x3ea845(0x1d1)];else{if(_0x349f0a[0x0][_0x3ea845(0x1b6)]==_0x3ea845(0x1b4))var _0x227cca=users['Arabic'];}}}}}}}_0x5bc18f[_0x3ea845(0x1d5)]('edit_transfer',{'success':_0x367778[_0x3ea845(0x22b)]('success'),'errors':_0x367778[_0x3ea845(0x22b)](_0x3ea845(0x195)),'role':_0x574499,'profile':_0xe011ae,'master_shop':_0x349f0a,'warehouse':_0x3c0d24,'transfer':_0x5b4254,'stock':_0x323bd6,'unit':_0x5c9ebf,'language':_0x227cca});}catch(_0x343db0){console[_0x3ea845(0x243)](_0x343db0);}}),router[a0_0x4fdf90(0x1d4)](a0_0x4fdf90(0x216),auth,async(_0x5b35bf,_0x235fc3)=>{var _0x3cce71=a0_0x4fdf90;try{const _0x3f6d84=_0x5b35bf[_0x3cce71(0x1de)]['id'],_0x4a080e=await transfers['findById'](_0x3f6d84);_0x235fc3[_0x3cce71(0x1f3)](_0x5b35bf[_0x3cce71(0x1cb)]);return;const {date:_0x36992e,from_warehouse:_0x5ee6fa,FromRoom_name:_0x435764,to_warehouse:_0x120ef4,ToRoom_name:_0x3d0f79,prod_name:_0x5c0a88,from_prod_qty:_0xd5a7e,from_prod_level:_0x24d7a0,from_prod_isle:_0x59f320,from_prod_pallet:_0x6ab55f,to_prod_qty:_0x55644b,to_prod_level:_0x3af2cd,to_prod_isle:_0x21fce1,to_prod_pallet:_0x4a4542,primary_code:_0x203a33,secondary_code:_0x23f435,product_code3:_0x4a44ff,note:_0x2e4d41,invoice:_0x10e767,expiry_date:_0xbeeb8d}=_0x5b35bf[_0x3cce71(0x1cb)];if(typeof _0x5c0a88=='string')var _0xef3a60=[_0x5b35bf['body'][_0x3cce71(0x180)]],_0x19d912=[_0x5b35bf['body']['from_prod_qty']],_0x1d8d5f=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1c6)]],_0x3e3ac6=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x222)]],_0x553dda=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x18a)]],_0x2f688d=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x217)]],_0x3d748b=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1f8)]],_0x36c06f=[_0x5b35bf[_0x3cce71(0x1cb)]['to_prod_level']],_0x1dedf2=[_0x5b35bf['body'][_0x3cce71(0x171)]],_0x3afb7c=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x200)]],_0x306655=[_0x5b35bf['body']['to_types']],_0x3703a6=[_0x5b35bf[_0x3cce71(0x1cb)]['storage']],_0x59225c=[_0x5b35bf[_0x3cce71(0x1cb)]['rak']],_0x307e02=[_0x5b35bf[_0x3cce71(0x1cb)]['primary_code']],_0x4c3082=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1c9)]],_0x40670b=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x185)]],_0x34b88c=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x196)]],_0xf69d57=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1da)]],_0x3db76c=[_0x5b35bf['body'][_0x3cce71(0x1ce)]],_0x1473e0=[_0x5b35bf['body'][_0x3cce71(0x1cc)]],_0x1591f4=[_0x5b35bf['body'][_0x3cce71(0x246)]],_0xb7232c=[_0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1d0)]],_0x23df35=[_0x5b35bf['body'][_0x3cce71(0x18f)]];else var _0xef3a60=[..._0x5b35bf[_0x3cce71(0x1cb)]['prod_name']],_0x3703a6=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1d8)]],_0x59225c=[..._0x5b35bf[_0x3cce71(0x1cb)]['rak']],_0x2f688d=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x217)]],_0x306655=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x18c)]],_0x19d912=[..._0x5b35bf[_0x3cce71(0x1cb)]['from_prod_qty']],_0x1d8d5f=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1c6)]],_0x3e3ac6=[..._0x5b35bf['body']['from_prod_isle']],_0x553dda=[..._0x5b35bf[_0x3cce71(0x1cb)]['from_prod_pallet']],_0x3d748b=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1f8)]],_0x36c06f=[..._0x5b35bf['body'][_0x3cce71(0x1bb)]],_0x1dedf2=[..._0x5b35bf['body'][_0x3cce71(0x171)]],_0x3afb7c=[..._0x5b35bf[_0x3cce71(0x1cb)]['to_prod_pallet']],_0x307e02=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1fb)]],_0x4c3082=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1c9)]],_0x40670b=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x185)]],_0x34b88c=[..._0x5b35bf['body'][_0x3cce71(0x196)]],_0xf69d57=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1da)]],_0x3db76c=[..._0x5b35bf[_0x3cce71(0x1cb)]['secondary_unit']],_0x1473e0=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1cc)]],_0x1591f4=[..._0x5b35bf['body'][_0x3cce71(0x246)]],_0xb7232c=[..._0x5b35bf[_0x3cce71(0x1cb)][_0x3cce71(0x1d0)]],_0x23df35=[..._0x5b35bf['body'][_0x3cce71(0x18f)]];const _0x500d7f=_0xef3a60[_0x3cce71(0x170)](_0x307c79=>{return _0x307c79={'product_name':_0x307c79};});_0x19d912[_0x3cce71(0x20e)]((_0x5dccfd,_0x8bec59)=>{var _0x5913d5=_0x3cce71;_0x500d7f[_0x8bec59][_0x5913d5(0x1ba)]=_0x5dccfd;}),_0x1d8d5f[_0x3cce71(0x20e)]((_0x4d9e26,_0x24c145)=>{var _0x2f90e1=_0x3cce71;_0x500d7f[_0x24c145][_0x2f90e1(0x23f)]=_0x4d9e26;}),_0x3e3ac6[_0x3cce71(0x20e)]((_0x387b56,_0x2962f9)=>{_0x500d7f[_0x2962f9]['from_bin']=_0x387b56;}),_0x553dda['forEach']((_0x5754bd,_0x57a369)=>{var _0x32ae0a=_0x3cce71;_0x500d7f[_0x57a369][_0x32ae0a(0x174)]=_0x5754bd;}),_0x3d748b[_0x3cce71(0x20e)]((_0x34ec20,_0x231715)=>{var _0x3e6cf5=_0x3cce71;_0x500d7f[_0x231715][_0x3e6cf5(0x15a)]=_0x34ec20;}),_0x36c06f[_0x3cce71(0x20e)]((_0x18e45d,_0x5935f4)=>{var _0x159c7f=_0x3cce71;_0x500d7f[_0x5935f4][_0x159c7f(0x23b)]=_0x18e45d;}),_0x1dedf2[_0x3cce71(0x20e)]((_0x3dbfb5,_0x74c8c4)=>{var _0x26804c=_0x3cce71;_0x500d7f[_0x74c8c4][_0x26804c(0x1ab)]=_0x3dbfb5;}),_0x3afb7c[_0x3cce71(0x20e)]((_0x1dcda1,_0x191fd1)=>{var _0x2b11b9=_0x3cce71;_0x500d7f[_0x191fd1][_0x2b11b9(0x194)]=_0x1dcda1;}),_0x307e02['forEach']((_0x52a2cd,_0x4573fb)=>{var _0x2ba659=_0x3cce71;_0x500d7f[_0x4573fb][_0x2ba659(0x1fb)]=_0x52a2cd;}),_0x4c3082['forEach']((_0xad849a,_0x4eb6f0)=>{var _0x2b0277=_0x3cce71;_0x500d7f[_0x4eb6f0][_0x2b0277(0x1c9)]=_0xad849a;}),_0x40670b[_0x3cce71(0x20e)]((_0x58bf83,_0x375190)=>{var _0x5e75cd=_0x3cce71;_0x500d7f[_0x375190][_0x5e75cd(0x218)]=_0x58bf83;}),_0x34b88c[_0x3cce71(0x20e)]((_0x568e82,_0x3f893a)=>{var _0x22e615=_0x3cce71;_0x500d7f[_0x3f893a][_0x22e615(0x166)]=_0x568e82;}),_0xf69d57[_0x3cce71(0x20e)]((_0x1e8c53,_0x5b3cdb)=>{var _0x2ca27b=_0x3cce71;_0x500d7f[_0x5b3cdb][_0x2ca27b(0x1da)]=_0x1e8c53;}),_0x3db76c[_0x3cce71(0x20e)]((_0x5dff8d,_0x1ddcbf)=>{var _0x4f8d6e=_0x3cce71;_0x500d7f[_0x1ddcbf][_0x4f8d6e(0x1ce)]=_0x5dff8d;}),_0x1473e0[_0x3cce71(0x20e)]((_0x4f9435,_0x50b7f9)=>{_0x500d7f[_0x50b7f9]['batch_code']=_0x4f9435;}),_0x1591f4['forEach']((_0x167639,_0x3e3f14)=>{var _0xe895a=_0x3cce71;_0x500d7f[_0x3e3f14][_0xe895a(0x246)]=_0x167639;}),_0x3703a6[_0x3cce71(0x20e)]((_0x18ca9c,_0x163389)=>{var _0x254900=_0x3cce71;_0x500d7f[_0x163389][_0x254900(0x1d8)]=_0x18ca9c;}),_0x59225c['forEach']((_0x332955,_0x3ef59e)=>{var _0x5d7608=_0x3cce71;_0x500d7f[_0x3ef59e][_0x5d7608(0x19b)]=_0x332955;}),_0x2f688d[_0x3cce71(0x20e)]((_0x4be6c3,_0x1d0094)=>{var _0x4a57b3=_0x3cce71;_0x500d7f[_0x1d0094][_0x4a57b3(0x217)]=_0x4be6c3;}),_0x306655[_0x3cce71(0x20e)]((_0x3316f9,_0x16d0da)=>{var _0xa1e754=_0x3cce71;_0x500d7f[_0x16d0da][_0xa1e754(0x18c)]=_0x3316f9;}),_0xb7232c[_0x3cce71(0x20e)]((_0x3c2989,_0x42c89f)=>{var _0x3be818=_0x3cce71;_0x500d7f[_0x42c89f][_0x3be818(0x1d0)]=_0x3c2989;}),_0x23df35['forEach']((_0x3f07ab,_0x467073)=>{var _0x515a13=_0x3cce71;_0x500d7f[_0x467073][_0x515a13(0x1f1)]=_0x3f07ab;});const _0x5b1a1b=_0x500d7f[_0x3cce71(0x1c0)](_0x6034b=>_0x6034b[_0x3cce71(0x15a)]!=='0'&&_0x6034b['to_quantity']!==''||_0x6034b[_0x3cce71(0x194)]!=='0'&&_0x6034b[_0x3cce71(0x194)]!=='');var _0x5a0161=0x0;_0x5b1a1b['forEach'](_0x2281a4=>{var _0x551add=_0x3cce71;parseInt(_0x2281a4[_0x551add(0x1ba)])<parseInt(_0x2281a4[_0x551add(0x15a)])&&_0x5a0161++;});if(_0x5a0161!=0x0)return _0x5b35bf[_0x3cce71(0x22b)](_0x3cce71(0x195),_0x3cce71(0x175)),_0x235fc3['redirect'](_0x3cce71(0x1f9));const _0x2f8260=await warehouse[_0x3cce71(0x1b1)]({'name':_0x4a080e[_0x3cce71(0x21e)],'room':_0x4a080e['from_room']});_0x4a080e[_0x3cce71(0x248)][_0x3cce71(0x20e)](_0x33c18e=>{var _0x674d95=_0x3cce71;if(_0x33c18e[_0x674d95(0x15a)]>0x0){const _0x24f9f4=_0x2f8260[_0x674d95(0x1cd)][_0x674d95(0x170)](_0x2ae22f=>{var _0x29c902=_0x674d95;_0x2ae22f['product_name']==_0x33c18e[_0x29c902(0x1ec)]&&_0x2ae22f[_0x29c902(0x16c)]==_0x33c18e[_0x29c902(0x174)]&&_0x2ae22f[_0x29c902(0x21b)]==_0x33c18e[_0x29c902(0x217)]&&_0x2ae22f[_0x29c902(0x179)]==_0x33c18e['from_bin']&&_0x2ae22f[_0x29c902(0x198)]==_0x33c18e[_0x29c902(0x23f)]&&_0x2ae22f[_0x29c902(0x19b)]==_0x33c18e[_0x29c902(0x1f1)]&&_0x2ae22f[_0x29c902(0x1d8)]==_0x33c18e[_0x29c902(0x1d0)]&&(_0x2ae22f[_0x29c902(0x23a)]=parseInt(_0x2ae22f[_0x29c902(0x23a)])+parseInt(_0x33c18e[_0x29c902(0x15a)]));});}}),await _0x2f8260[_0x3cce71(0x1ea)]();const _0x2dbbe8=await warehouse['findOne']({'name':_0x4a080e[_0x3cce71(0x1db)],'room':_0x4a080e[_0x3cce71(0x1e3)]});_0x4a080e['product']['forEach'](_0x27a16d=>{var _0x371021=_0x3cce71;if(_0x27a16d[_0x371021(0x15a)]>0x0){const _0x2f0234=_0x2dbbe8['product_details'][_0x371021(0x170)](_0x822275=>{var _0x4cd058=_0x371021;_0x822275[_0x4cd058(0x1ec)]==_0x27a16d[_0x4cd058(0x1ec)]&&_0x822275[_0x4cd058(0x16c)]==_0x27a16d[_0x4cd058(0x194)]&&_0x822275['type']==_0x27a16d[_0x4cd058(0x18c)]&&_0x822275[_0x4cd058(0x179)]==_0x27a16d[_0x4cd058(0x1ab)]&&_0x822275['bay']==_0x27a16d[_0x4cd058(0x23b)]&&_0x822275[_0x4cd058(0x19b)]==_0x27a16d[_0x4cd058(0x19b)]&&_0x822275[_0x4cd058(0x1d8)]==_0x27a16d[_0x4cd058(0x1d8)]&&(_0x822275[_0x4cd058(0x23a)]=parseInt(_0x822275[_0x4cd058(0x23a)])-parseInt(_0x27a16d['to_quantity']));});}}),await _0x2dbbe8[_0x3cce71(0x1ea)](),_0x4a080e[_0x3cce71(0x1f4)]=_0x36992e,_0x4a080e[_0x3cce71(0x21e)]=_0x5ee6fa,_0x4a080e[_0x3cce71(0x1db)]=_0x120ef4,_0x4a080e[_0x3cce71(0x248)]=_0x5b1a1b,_0x4a080e[_0x3cce71(0x22a)]=_0x2e4d41,_0x4a080e[_0x3cce71(0x232)]=_0x10e767;const _0x41e70f=await _0x4a080e[_0x3cce71(0x1ea)]();console[_0x3cce71(0x243)](_0x41e70f);const _0x6948fc=await warehouse[_0x3cce71(0x1b1)]({'name':_0x5ee6fa,'room':_0x435764});_0x41e70f['product'][_0x3cce71(0x20e)](_0x5d8073=>{var _0xd20921=_0x3cce71;if(_0x5d8073[_0xd20921(0x15a)]>0x0){const _0x189f69=_0x6948fc[_0xd20921(0x1cd)][_0xd20921(0x170)](_0x5f531c=>{var _0x5b3e21=_0xd20921;_0x5f531c[_0x5b3e21(0x1ec)]==_0x5d8073[_0x5b3e21(0x1ec)]&&_0x5f531c[_0x5b3e21(0x16c)]==_0x5d8073[_0x5b3e21(0x174)]&&_0x5f531c['type']==_0x5d8073[_0x5b3e21(0x217)]&&_0x5f531c[_0x5b3e21(0x179)]==_0x5d8073[_0x5b3e21(0x205)]&&_0x5f531c[_0x5b3e21(0x198)]==_0x5d8073[_0x5b3e21(0x23f)]&&_0x5f531c[_0x5b3e21(0x19b)]==_0x5d8073['from_rack']&&_0x5f531c[_0x5b3e21(0x1d8)]==_0x5d8073['from_storage']&&(_0x5f531c[_0x5b3e21(0x23a)]=parseInt(_0x5f531c['product_stock'])-parseInt(_0x5d8073[_0x5b3e21(0x15a)]));});}}),await _0x6948fc[_0x3cce71(0x1ea)]();const _0x20d018=await warehouse[_0x3cce71(0x1b1)]({'name':_0x120ef4,'room':_0x3d0f79});_0x41e70f[_0x3cce71(0x248)]['forEach'](_0x5de632=>{var _0x4ac1dc=_0x3cce71;if(_0x5de632[_0x4ac1dc(0x15a)]>0x0){var _0x198b12=0x0;const _0x3f84ce=_0x20d018[_0x4ac1dc(0x1cd)][_0x4ac1dc(0x170)](_0x1c3f91=>{var _0x4f45bc=_0x4ac1dc;_0x1c3f91['product_name']==_0x5de632[_0x4f45bc(0x1ec)]&&_0x1c3f91[_0x4f45bc(0x16c)]==_0x5de632[_0x4f45bc(0x194)]&&_0x1c3f91[_0x4f45bc(0x21b)]==_0x5de632[_0x4f45bc(0x18c)]&&_0x1c3f91[_0x4f45bc(0x179)]==_0x5de632[_0x4f45bc(0x1ab)]&&_0x1c3f91['bay']==_0x5de632['to_bay']&&_0x1c3f91['rack']==_0x5de632[_0x4f45bc(0x19b)]&&_0x1c3f91['storage']==_0x5de632['storage']&&(_0x1c3f91[_0x4f45bc(0x23a)]=parseInt(_0x1c3f91[_0x4f45bc(0x23a)])+parseInt(_0x5de632[_0x4f45bc(0x15a)]),_0x198b12++);});_0x198b12=='0'&&(_0x20d018[_0x4ac1dc(0x1cd)]=_0x20d018[_0x4ac1dc(0x1cd)]['concat']({'product_name':_0x5de632[_0x4ac1dc(0x1ec)],'product_stock':_0x5de632[_0x4ac1dc(0x15a)],'bay':_0x5de632[_0x4ac1dc(0x23b)],'bin':_0x5de632['to_bin'],'type':_0x5de632[_0x4ac1dc(0x18c)],'floorlevel':_0x5de632[_0x4ac1dc(0x194)],'storage':_0x5de632[_0x4ac1dc(0x1d8)],'rack':_0x5de632[_0x4ac1dc(0x19b)],'product_code':_0x5de632[_0x4ac1dc(0x218)],'primary_code':_0x5de632[_0x4ac1dc(0x1fb)],'secondary_code':_0x5de632[_0x4ac1dc(0x1c9)],'maxProducts':_0x5de632[_0x4ac1dc(0x166)],'storage':_0x5de632[_0x4ac1dc(0x1d8)],'rack':_0x5de632['rack']}));}}),await _0x20d018[_0x3cce71(0x1ea)](),_0x5b35bf[_0x3cce71(0x22b)](_0x3cce71(0x215),_0x3cce71(0x221)),_0x235fc3[_0x3cce71(0x202)](_0x3cce71(0x177));}catch(_0x138fb4){console['log'](_0x138fb4);}}),router[a0_0x4fdf90(0x1d4)](a0_0x4fdf90(0x1f5),async(_0x4953ad,_0xbdad2b)=>{var _0x2b6fa7=a0_0x4fdf90;const {FromWareHouse:_0x2645c1,FromRoom:_0x3e4323,ToWarehouse:_0x7dd997,ToRoom:_0x524b37,primary_code:_0x3e3cfe,Roomslist:_0x4403fb}=_0x4953ad[_0x2b6fa7(0x1cb)],_0x52dd1f=_0x4403fb[_0x2b6fa7(0x236)](','),_0x48ad31=[];async function _0x2d7d58(_0x199067){var _0x5c3a6f=_0x2b6fa7;const _0x3e79e5=await warehouse[_0x5c3a6f(0x18b)]([{'$match':{'name':_0x2645c1,'room':_0x199067}},{'$unwind':_0x5c3a6f(0x17d)},{'$match':{'product_details.primary_code':_0x3e3cfe}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5c3a6f(0x1ad)},'instock':{'$first':_0x5c3a6f(0x1df)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5c3a6f(0x1a2)},'isle':{'$first':_0x5c3a6f(0x21f)},'type':{'$first':_0x5c3a6f(0x234)},'pallet':{'$first':_0x5c3a6f(0x249)},'unit':{'$first':_0x5c3a6f(0x1c8)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5c3a6f(0x17b)},'expiry_date':{'$first':_0x5c3a6f(0x1b9)},'production_date':{'$first':_0x5c3a6f(0x173)},'batch_code':{'$first':_0x5c3a6f(0x163)},'maxPerUnit':{'$first':_0x5c3a6f(0x22e)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x5c3a6f(0x168)},'maxProducts':{'$first':_0x5c3a6f(0x23e)}}}]),_0x37a6cb=await warehouse['aggregate']([{'$match':{'name':_0x2645c1,'room':_0x199067}},{'$unwind':_0x5c3a6f(0x17d)},{'$match':{'product_details.secondary_code':_0x3e3cfe}},{'$group':{'_id':_0x5c3a6f(0x22f),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x5c3a6f(0x1df)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5c3a6f(0x210)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5c3a6f(0x21f)},'type':{'$first':_0x5c3a6f(0x234)},'pallet':{'$first':_0x5c3a6f(0x249)},'unit':{'$first':_0x5c3a6f(0x1c8)},'secondary_unit':{'$first':_0x5c3a6f(0x1d6)},'storage':{'$first':_0x5c3a6f(0x1ed)},'rack':{'$first':_0x5c3a6f(0x17b)},'expiry_date':{'$first':_0x5c3a6f(0x1b9)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5c3a6f(0x163)},'maxPerUnit':{'$first':_0x5c3a6f(0x22e)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5c3a6f(0x168)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);if(_0x3e79e5[_0x5c3a6f(0x167)]>0x0)_0x48ad31[_0x5c3a6f(0x23c)](_0x3e79e5);else _0x37a6cb[_0x5c3a6f(0x167)]>0x0&&_0x48ad31[_0x5c3a6f(0x23c)](_0x37a6cb);}const _0x52437a=_0x52dd1f[_0x2b6fa7(0x170)](_0x57219d=>_0x2d7d58(_0x57219d));await Promise[_0x2b6fa7(0x19c)](_0x52437a),_0xbdad2b[_0x2b6fa7(0x1f3)](_0x48ad31);}),router[a0_0x4fdf90(0x1d4)](a0_0x4fdf90(0x1b8),async(_0x348dd9,_0x1f3eeb)=>{var _0x39c76a=a0_0x4fdf90;try{const {FromWareHouse:_0x12a566,FromRoom:_0x38ee22,ToWarehouse:_0x5dbe79,ToRoom:_0x1252ae,secondary_code:_0x514e75}=_0x348dd9[_0x39c76a(0x1cb)],_0x3ebc6c=await warehouse['aggregate']([{'$match':{'name':_0x12a566}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x514e75}},{'$group':{'_id':_0x39c76a(0x22f),'name':{'$first':_0x39c76a(0x1ad)},'primary_code':{'$first':_0x39c76a(0x1dd)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x39c76a(0x1df)},'warehouse':{'$first':_0x39c76a(0x189)},'level':{'$first':_0x39c76a(0x204)},'isle':{'$first':_0x39c76a(0x183)},'pallet':{'$first':_0x39c76a(0x1ff)},'maxProducts':{'$first':_0x39c76a(0x23e)},'unit':{'$first':_0x39c76a(0x1c8)}}}]);_0x1f3eeb[_0x39c76a(0x231)](0xc8)[_0x39c76a(0x1f3)](_0x3ebc6c);}catch(_0x365580){_0x1f3eeb['status'](0x194)[_0x39c76a(0x1f3)]({'message':_0x365580['message']});}}),router[a0_0x4fdf90(0x1d4)](a0_0x4fdf90(0x1f7),async(_0x253efd,_0x989579)=>{var _0x45a299=a0_0x4fdf90;try{const {FromWareHouse:_0x5bb3a4,FromRoom:_0x3e8560,ToWarehouse:_0xe0e811,ToRoom:_0x1c80a7,product_code:_0x4a5232}=_0x253efd[_0x45a299(0x1cb)],_0x5c2fac=await warehouse[_0x45a299(0x18b)]([{'$match':{'name':_0x5bb3a4}},{'$unwind':_0x45a299(0x17d)},{'$match':{'product_details.product_code':_0x4a5232}},{'$group':{'_id':_0x45a299(0x22f),'name':{'$first':_0x45a299(0x1ad)},'primary_code':{'$first':_0x45a299(0x1dd)},'secondary_code':{'$first':_0x45a299(0x210)},'product_code':{'$first':_0x45a299(0x214)},'instock':{'$first':_0x45a299(0x1df)},'warehouse':{'$first':_0x45a299(0x189)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x45a299(0x183)},'pallet':{'$first':_0x45a299(0x1ff)},'maxProducts':{'$first':_0x45a299(0x23e)},'unit':{'$first':_0x45a299(0x1c8)}}}]);_0x989579['status'](0xc8)[_0x45a299(0x1f3)](_0x5c2fac);}catch(_0x1b46fb){_0x989579[_0x45a299(0x231)](0x194)['json']({'message':_0x1b46fb[_0x45a299(0x1fa)]});}}),router[a0_0x4fdf90(0x1d4)](a0_0x4fdf90(0x1e8),async(_0x1ba46a,_0x17b682)=>{var _0x11bf65=a0_0x4fdf90;const {level:_0x2e4d67,isle:_0x10a752,pallet:_0x1dfb35,warehouses:_0x294d11,room:_0x3fcc5b}=_0x1ba46a['body'];try{const _0x3e4519=await warehouse[_0x11bf65(0x18b)]([{'$match':{'name':_0x294d11,'room':_0x3fcc5b}},{'$unwind':_0x11bf65(0x17d)},{'$match':{'product_details.level':parseInt(_0x2e4d67),'product_details.isle':_0x10a752,'product_details.pallet':parseInt(_0x1dfb35)}},{'$group':{'_id':_0x11bf65(0x22f),'name':{'$first':_0x11bf65(0x1ad)},'product_stock':{'$first':_0x11bf65(0x1df)},'level':{'$first':_0x11bf65(0x204)},'isle':{'$first':_0x11bf65(0x183)},'pallet':{'$first':_0x11bf65(0x1ff)},'maxProducts':{'$first':_0x11bf65(0x23e)}}}]);_0x17b682[_0x11bf65(0x231)](0xc8)[_0x11bf65(0x1f3)](_0x3e4519);}catch(_0x24fd79){_0x17b682[_0x11bf65(0x231)](0x194)[_0x11bf65(0x1f3)]({'message':_0x24fd79[_0x11bf65(0x1fa)]});}}),module[a0_0x4fdf90(0x15c)]=router;