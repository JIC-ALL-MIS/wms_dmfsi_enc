var a0_0x353bcd=a0_0xb185;(function(_0x99b253,_0xef8a26){var _0x2e38f3=a0_0xb185,_0x2c2a77=_0x99b253();while(!![]){try{var _0x5b084c=-parseInt(_0x2e38f3(0x216))/0x1*(-parseInt(_0x2e38f3(0x22b))/0x2)+-parseInt(_0x2e38f3(0x1aa))/0x3*(-parseInt(_0x2e38f3(0x1e5))/0x4)+parseInt(_0x2e38f3(0x19f))/0x5+-parseInt(_0x2e38f3(0x215))/0x6+-parseInt(_0x2e38f3(0x1c6))/0x7+parseInt(_0x2e38f3(0x1a1))/0x8+-parseInt(_0x2e38f3(0x1fa))/0x9;if(_0x5b084c===_0xef8a26)break;else _0x2c2a77['push'](_0x2c2a77['shift']());}catch(_0x28a57b){_0x2c2a77['push'](_0x2c2a77['shift']());}}}(a0_0x3fcc,0xc9925));function a0_0x3fcc(){var _0x3fd204=['<!DOCTYPE\x20html>','here','$product_details.bin','role','to_room','storage','/picking_list/PDF_transfer_rm/','COLD\x20STORAGE','Raw\x20Materials','8929452yYGvtJ','$product_details.floorlevel','random','rack','Rack\x20B','push','from_prod_isle','sendMail','from_bay','$product_details.unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','from_storage','findOne','to_quantity','$date','Rack\x20D','$invoice','<h2>\x20','$product_details.maxProducts','render','Error\x20Occurs','staff','invoice','$product_details._id','json','\x20Order\x20Date\x20:\x20','id_transaction','Portuguese\x20(BR)','finalize','log','from_warehouse','428RVSPTo','id_transaction_id','\x20</h2>','Ambient','map','to_prod_isle','<span\x20style=\x22float:\x20right;\x22>','type','success','$name','expiry_date','Receiving\x20Area','filter','$product_details.secondary_unit','Arabic','An\x20error\x20occurred.','$product_details.isle','max_per_unit','to_floorlevel','prod_cat','email','8928864OZgaTN','/upload/','to_prod_qty','$room','from_prod_qty','<html><head><title></title>','/transfer/view','$finalize','New_Qty_Converted','image','\x20Order\x20Number\x20:\x20','to_bin','Rack\x20A','/view','from_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','master','to_bay','redirect','batch_code','password','product_details','host','Email\x20sent\x20successfully','<strong>\x20Regards\x20</strong>','Enabled','An\x20error\x20occurred\x20while\x20saving\x20data.','4113096cDvCfJ','1033FqqyeO','add_transfer','</h5>','</tbody>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/barcode_scanner','product_code3','English\x20(US)','$product_details.type','$product_details.product_stock','Portuguese','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.bay','<tr>','primary_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','To_invoice','padStart','/CheckingWarehouse','$product','back','2876AjPRur','Spanish','Transfer\x20Mail','from_types','then','</td>','Logo.png','product_name','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','to_types','Level','aggregate','French','DRY\x20STORAGE','/barcode_scanner3','product_code','to_invoice','English','$product_details.secondary_code','getFullYear','express','site_title','$product_details.production_date','createTransport','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','../middleware/auth','$product_details.batch_code','$product_details.primary_code','</div>','product','to_prod_level','Enclosed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','date','secondary_unit','maxProducts','flash','product_stock','forEach','Arabic\x20(ae)','Hindi','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.rack','$product_details.level','logo','from_room_name','secondary_code','to_warehouse','unit','$product_details.product_name','from_floorlevel','Product\x20Transfer\x20successfully','/barcode_scanner2','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$isAllowEdit','MaxStocks_data2','string','to_room_name','/view/add_transfer','prod_name','from_rak','Floor','production_date','from_prod_pallet','</tr>','ToRoomAssigned','message','\x20<>\x20','post','RoomAssigned','German','edit_transfer','<div>','body','Shelves','status','$from_warehouse','edit_transfer_view','language','from_quantity','port','$product_details.pallet','</head><body>','nodemailer','$product_details.expiry_date','bin','find','_id','$product_details.storage','from_room','length','get','params','slice','$product_details.product_code','errors','user','to_prod_pallet','toString','warehouse','error','$product_details','note','Rack\x20F','updateOne','exports','Chinese','bay','3583500COaIVG','Router','9235216fhmjuM','floor','$product_details.maxPerUnit','Rack\x20E','True','from_rack','$_id','save','concat','11841tStKPk','/preview/:id','TRF-','../models/all_models','/view/:id','from_bin','floorlevel','all','/../public','</table>','getDate','Transfer\x20Edit\x20Successfully','catch','findById','primary_unit','</body></html>','Rack\x20C','from_prod_level','<h5\x20style=\x22text-align:\x20left;\x22>'];a0_0x3fcc=function(){return _0x3fd204;};return a0_0x3fcc();}const express=require(a0_0x353bcd(0x240)),app=express(),router=express[a0_0x353bcd(0x1a0)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x353bcd(0x1ad)),auth=require(a0_0x353bcd(0x246)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x353bcd(0x186));router['get'](a0_0x353bcd(0x207),auth,async(_0x338bee,_0x1c3da1)=>{var _0x402f04=a0_0x353bcd;try{const {username:_0x21bc46,email:_0x270c29,role:_0x36629f}=_0x338bee['user'],_0x257a00=_0x338bee[_0x402f04(0x193)],_0x43e48e=await profile['findOne']({'email':_0x257a00[_0x402f04(0x1f9)]}),_0x42faa3=await master_shop['find']();console[_0x402f04(0x1e3)](_0x402f04(0x20a),_0x42faa3);let _0x2a5866;if(_0x257a00[_0x402f04(0x1c0)]==_0x402f04(0x1db)){const _0x4ad590=await staff[_0x402f04(0x1d2)]({'email':_0x257a00['email']});_0x2a5866=await transfers['find']({'from_warehouse':_0x4ad590[_0x402f04(0x196)]});}else _0x2a5866=await transfers[_0x402f04(0x237)]([{'$unwind':_0x402f04(0x229)},{'$group':{'_id':_0x402f04(0x1a7),'invoice':{'$first':_0x402f04(0x1d6)},'date':{'$first':_0x402f04(0x1d4)},'from_warehouse':{'$first':_0x402f04(0x17f)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x402f04(0x201)},'isAllowEdit':{'$first':_0x402f04(0x263)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x42faa3[0x0][_0x402f04(0x181)]=='English\x20(US)'){var _0x2ea781=users[_0x402f04(0x23d)];console[_0x402f04(0x1e3)](_0x2ea781);}else{if(_0x42faa3[0x0][_0x402f04(0x181)]==_0x402f04(0x255))var _0x2ea781=users[_0x402f04(0x255)];else{if(_0x42faa3[0x0][_0x402f04(0x181)]==_0x402f04(0x179))var _0x2ea781=users[_0x402f04(0x179)];else{if(_0x42faa3[0x0]['language']==_0x402f04(0x22c))var _0x2ea781=users[_0x402f04(0x22c)];else{if(_0x42faa3[0x0][_0x402f04(0x181)]==_0x402f04(0x238))var _0x2ea781=users[_0x402f04(0x238)];else{if(_0x42faa3[0x0][_0x402f04(0x181)]=='Portuguese\x20(BR)')var _0x2ea781=users[_0x402f04(0x220)];else{if(_0x42faa3[0x0][_0x402f04(0x181)]=='Chinese')var _0x2ea781=users[_0x402f04(0x19d)];else{if(_0x42faa3[0x0][_0x402f04(0x181)]==_0x402f04(0x254))var _0x2ea781=users[_0x402f04(0x1f3)];}}}}}}}_0x1c3da1[_0x402f04(0x1d9)]('transfer',{'success':_0x338bee[_0x402f04(0x251)](_0x402f04(0x1ed)),'errors':_0x338bee['flash'](_0x402f04(0x192)),'role':_0x257a00,'profile':_0x43e48e,'master_shop':_0x42faa3,'transfer':_0x2a5866,'language':_0x2ea781});}catch(_0x1ee5a0){console[_0x402f04(0x1e3)](_0x1ee5a0);}});async function getRandom8DigitNumber(){var _0x18b028=a0_0x353bcd;const _0x44b1e8=0x989680,_0x4398fb=0x5f5e0ff,_0x73eb1f=Math[_0x18b028(0x1a2)](Math[_0x18b028(0x1c8)]()*(_0x4398fb-_0x44b1e8+0x1))+_0x44b1e8;var _0x8ed2bf;const _0x486fbb=await transfers[_0x18b028(0x1d2)]({'invoice':_0x18b028(0x1ac)+_0x73eb1f});return _0x486fbb&&_0x486fbb[_0x18b028(0x18d)]>0x0?_0x8ed2bf=_0x18b028(0x1ac)+_0x73eb1f:_0x8ed2bf=_0x18b028(0x1ac)+_0x73eb1f,_0x8ed2bf;}router[a0_0x353bcd(0x18e)](a0_0x353bcd(0x16d),auth,async(_0x38f002,_0x1f9518)=>{var _0x3a0548=a0_0x353bcd;try{const {username:_0x299bff,email:_0x48a5e3,role:_0x5ac37f}=_0x38f002[_0x3a0548(0x193)],_0x3790e3=_0x38f002[_0x3a0548(0x193)],_0x52e5b1=await profile[_0x3a0548(0x1d2)]({'email':_0x3790e3[_0x3a0548(0x1f9)]}),_0x27456b=await master_shop[_0x3a0548(0x189)]();console[_0x3a0548(0x1e3)]('master',_0x27456b);let _0x579a3c;if(_0x3790e3[_0x3a0548(0x1c0)]==_0x3a0548(0x1db)){const _0x3e189a=await staff['findOne']({'email':_0x3790e3[_0x3a0548(0x1f9)]});_0x579a3c=await warehouse[_0x3a0548(0x237)]([{'$match':{'status':_0x3a0548(0x213),'name':_0x3e189a[_0x3a0548(0x196)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3a0548(0x1ee),'name':{'$first':_0x3a0548(0x1ee)}}}]);}else _0x579a3c=await warehouse[_0x3a0548(0x237)]([{'$match':{'status':'Enabled','warehouse_category':_0x3a0548(0x1c5)}},{'$group':{'_id':_0x3a0548(0x1ee),'name':{'$first':_0x3a0548(0x1ee)}}}]);var _0xa402f9=[_0x3a0548(0x1e8),_0x3a0548(0x24c),_0x3a0548(0x233)];const _0x2aa21b=await transfers[_0x3a0548(0x189)]({}),_0x3ce96d=_0x2aa21b[_0x3a0548(0x18d)]+0x1,_0x52ccaf=_0x3a0548(0x1ac)+_0x3ce96d[_0x3a0548(0x195)]()[_0x3a0548(0x227)](0x5,'0');if(_0x27456b[0x0][_0x3a0548(0x181)]==_0x3a0548(0x21d)){var _0x3c738a=users['English'];console[_0x3a0548(0x1e3)](_0x3c738a);}else{if(_0x27456b[0x0]['language']=='Hindi')var _0x3c738a=users[_0x3a0548(0x255)];else{if(_0x27456b[0x0][_0x3a0548(0x181)]==_0x3a0548(0x179))var _0x3c738a=users['German'];else{if(_0x27456b[0x0]['language']==_0x3a0548(0x22c))var _0x3c738a=users['Spanish'];else{if(_0x27456b[0x0][_0x3a0548(0x181)]==_0x3a0548(0x238))var _0x3c738a=users['French'];else{if(_0x27456b[0x0]['language']==_0x3a0548(0x1e1))var _0x3c738a=users[_0x3a0548(0x220)];else{if(_0x27456b[0x0][_0x3a0548(0x181)]==_0x3a0548(0x19d))var _0x3c738a=users[_0x3a0548(0x19d)];else{if(_0x27456b[0x0][_0x3a0548(0x181)]==_0x3a0548(0x254))var _0x3c738a=users[_0x3a0548(0x1f3)];}}}}}}}const _0x8fb1b5=getRandom8DigitNumber();_0x8fb1b5[_0x3a0548(0x22f)](_0x1c9cdf=>{var _0x55cbe5=_0x3a0548;_0x1f9518[_0x55cbe5(0x1d9)](_0x55cbe5(0x217),{'success':_0x38f002[_0x55cbe5(0x251)](_0x55cbe5(0x1ed)),'errors':_0x38f002['flash']('errors'),'role':_0x3790e3,'profile':_0x52e5b1,'master_shop':_0x27456b,'warehouse':_0x579a3c,'language':_0x3c738a,'rooms_data':_0xa402f9,'invoice':_0x1c9cdf});})[_0x3a0548(0x1b6)](_0x5ab128=>{var _0x130010=_0x3a0548;_0x38f002[_0x130010(0x251)]('errors',_0x130010(0x262)),_0x1f9518[_0x130010(0x20c)](_0x130010(0x200));});}catch(_0x55e04a){console['log'](_0x55e04a);}}),router['post']('/view/add_transfer',auth,async(_0x43d004,_0x38db08)=>{var _0x4cae38=a0_0x353bcd;try{console['log'](_0x43d004[_0x4cae38(0x17c)]);const {date:_0x3d6cab,from_warehouse:_0x3d122b,FromRoom_name:_0x2034c5,to_warehouse:_0x827077,ToRoom_name:_0x1bcce6,prod_name:_0x4edcbd,from_prod_qty:_0x18a679,from_prod_level:_0x5d0518,from_prod_isle:_0x57a5da,from_prod_pallet:_0x59bdb4,to_prod_qty:_0x328782,to_prod_level:_0x42b54b,to_prod_isle:_0x188d84,to_prod_pallet:_0x2fbc34,primary_code:_0x13d6be,secondary_code:_0xec6460,product_code3:_0x2830cc,note:_0x405527,MaxStocks_data2:_0x4577a5,invoice:_0x36d408,expiry_date:_0x4e148c}=_0x43d004[_0x4cae38(0x17c)];if(typeof _0x4edcbd==_0x4cae38(0x16b))var _0x5e3f5=[_0x43d004[_0x4cae38(0x17c)]['prod_name']],_0x3612cb=[_0x43d004['body'][_0x4cae38(0x1fe)]],_0x4c1724=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1bb)]],_0x1133fa=[_0x43d004['body']['New_Qty_Converted']],_0x76786b=[_0x43d004[_0x4cae38(0x17c)]['to_prod_level']],_0x537e16=[_0x43d004[_0x4cae38(0x17c)]['primary_code']],_0x3387ff=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x25b)]],_0x2fcff2=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x21c)]],_0x27adf3=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x264)]],_0x365e1d=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1b8)]],_0xd2ecf5=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x24f)]],_0x53eb5d=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x20d)]],_0x5cadba=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1ef)]],_0xc82a5f=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1f6)]],_0x3bb5d6=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x171)]],_0x17e0d2=[_0x43d004[_0x4cae38(0x17c)]['prod_cat']],_0x3465fa=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x178)]],_0x1a1a47=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x174)]],_0x50dff4=[_0x43d004[_0x4cae38(0x17c)]['from_invoice']],_0x4d0c87=[_0x43d004[_0x4cae38(0x17c)]['to_invoice']],_0x412ff2=[_0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1e0)]];else var _0x5e3f5=[..._0x43d004['body']['prod_name']],_0x3612cb=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1fe)]],_0x4c1724=[..._0x43d004['body'][_0x4cae38(0x1bb)]],_0x1133fa=[..._0x43d004['body'][_0x4cae38(0x202)]],_0x76786b=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x24b)]],_0x537e16=[..._0x43d004['body'][_0x4cae38(0x224)]],_0x3387ff=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x25b)]],_0x2fcff2=[..._0x43d004['body'][_0x4cae38(0x21c)]],_0x27adf3=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x264)]],_0x365e1d=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1b8)]],_0xd2ecf5=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x24f)]],_0x53eb5d=[..._0x43d004['body'][_0x4cae38(0x20d)]],_0x5cadba=[..._0x43d004['body']['expiry_date']],_0xc82a5f=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1f6)]],_0x3bb5d6=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x171)]],_0x17e0d2=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1f8)]],_0x3465fa=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x178)]],_0x1a1a47=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x174)]],_0x50dff4=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x208)]],_0x4d0c87=[..._0x43d004['body'][_0x4cae38(0x23c)]],_0x412ff2=[..._0x43d004[_0x4cae38(0x17c)][_0x4cae38(0x1e0)]];const _0x3bdb1c=_0x5e3f5[_0x4cae38(0x1e9)](_0x5dfb0a=>{return _0x5dfb0a={'product_name':_0x5dfb0a};});_0x3612cb[_0x4cae38(0x253)]((_0x3bf428,_0x5423f8)=>{var _0x17b957=_0x4cae38;_0x3bdb1c[_0x5423f8][_0x17b957(0x182)]=_0x3bf428;}),_0x50dff4[_0x4cae38(0x253)]((_0x2b362d,_0x2843da)=>{var _0x2cfc08=_0x4cae38;_0x3bdb1c[_0x2843da][_0x2cfc08(0x208)]=_0x2b362d;}),_0x4d0c87[_0x4cae38(0x253)]((_0x3350f5,_0x5ca091)=>{var _0x4fe769=_0x4cae38;_0x3bdb1c[_0x5ca091][_0x4fe769(0x226)]=_0x3350f5;}),_0x412ff2[_0x4cae38(0x253)]((_0x1efc52,_0x2acddb)=>{_0x3bdb1c[_0x2acddb]['id_transaction_id']=_0x1efc52;}),_0x4c1724[_0x4cae38(0x253)]((_0x2b6071,_0x27a474)=>{var _0x34a21d=_0x4cae38;_0x3465fa[_0x34a21d(0x253)]((_0x342cd6,_0x213a2f)=>{var _0x59e56c=_0x34a21d;if(_0x342cd6==_0x59e56c(0x1f0)&&_0x27a474==_0x213a2f){var _0x1f0a46=_0x2b6071['slice'](0x3);_0x3bdb1c[_0x27a474][_0x59e56c(0x1d1)]=_0x2b6071[0x0],_0x3bdb1c[_0x27a474][_0x59e56c(0x1a6)]=_0x2b6071[0x1],_0x3bdb1c[_0x27a474][_0x59e56c(0x1ce)]=0x0,_0x3bdb1c[_0x27a474]['from_bin']=0x0,_0x3bdb1c[_0x27a474]['from_types']=_0x59e56c(0x170),_0x3bdb1c[_0x27a474][_0x59e56c(0x25f)]=_0x1f0a46;}else{if(_0x342cd6==_0x59e56c(0x17d)&&_0x27a474==_0x213a2f){var _0x1f0a46=_0x2b6071[_0x59e56c(0x190)](0x3);_0x3bdb1c[_0x27a474]['from_storage']=_0x2b6071[0x0],_0x3bdb1c[_0x27a474][_0x59e56c(0x1a6)]=_0x2b6071[0x1],_0x3bdb1c[_0x27a474][_0x59e56c(0x1ce)]=0x0,_0x3bdb1c[_0x27a474][_0x59e56c(0x1af)]=0x0,_0x3bdb1c[_0x27a474][_0x59e56c(0x22e)]='Floor',_0x3bdb1c[_0x27a474]['from_floorlevel']=_0x2b6071[0x5];}else{if(_0x27a474==_0x213a2f){if(_0x2b6071[0x0]=='A'&&_0x2b6071[0x1]=='L'&&_0x2b6071[0x2]=='L')console[_0x59e56c(0x1e3)](_0x342cd6+_0x59e56c(0x176)+_0x27a474+_0x59e56c(0x176)+_0x213a2f+_0x59e56c(0x176)+_0x2b6071+_0x59e56c(0x1be)),_0x3bdb1c[_0x27a474][_0x59e56c(0x1d1)]=_0x2b6071[0x0],_0x3bdb1c[_0x27a474][_0x59e56c(0x1a6)]=_0x2b6071[0x1],_0x3bdb1c[_0x27a474][_0x59e56c(0x1ce)]=0x0,_0x3bdb1c[_0x27a474][_0x59e56c(0x1af)]=0x0,_0x3bdb1c[_0x27a474][_0x59e56c(0x22e)]=_0x59e56c(0x170),_0x3bdb1c[_0x27a474]['from_floorlevel']=_0x2b6071[0x3];else{var _0x1dd323;if(_0x2b6071[0x4]=='L')_0x1dd323=_0x59e56c(0x236);else _0x2b6071[0x4]=='F'&&(_0x1dd323=_0x59e56c(0x170));_0x3bdb1c[_0x27a474][_0x59e56c(0x1d1)]=_0x2b6071[0x0],_0x3bdb1c[_0x27a474]['from_rack']=_0x2b6071[0x1],_0x3bdb1c[_0x27a474]['from_bay']=_0x2b6071[0x2],_0x3bdb1c[_0x27a474]['from_bin']=_0x2b6071[0x3],_0x3bdb1c[_0x27a474][_0x59e56c(0x22e)]=_0x1dd323,_0x3bdb1c[_0x27a474]['from_floorlevel']=_0x2b6071[0x5];}}}}});}),_0x1133fa[_0x4cae38(0x253)]((_0x4f69df,_0x200d8f)=>{_0x3bdb1c[_0x200d8f]['to_quantity']=_0x4f69df;}),_0x76786b[_0x4cae38(0x253)]((_0x170480,_0x2f08bd)=>{var _0x51e2ca=_0x4cae38;_0x1a1a47[_0x51e2ca(0x253)]((_0x4f4d1d,_0x5a08da)=>{var _0x1ccd75=_0x51e2ca;if(_0x4f4d1d==_0x1ccd75(0x1f0)&&_0x2f08bd==_0x5a08da){var _0x26880a=_0x170480[_0x1ccd75(0x190)](0x3);_0x3bdb1c[_0x2f08bd]['storage']=_0x170480[0x0],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1c9)]=_0x170480[0x1],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x20b)]=0x0,_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x205)]=0x0,_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x235)]=_0x1ccd75(0x170),_0x3bdb1c[_0x2f08bd]['to_floorlevel']=_0x26880a;}else{if(_0x4f4d1d==_0x1ccd75(0x17d)&&_0x2f08bd==_0x5a08da){var _0x26880a=_0x170480[_0x1ccd75(0x190)](0x3);_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1c2)]=_0x170480[0x0],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1c9)]=_0x170480[0x1],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x20b)]=0x0,_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x205)]=0x0,_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x235)]=_0x1ccd75(0x170),_0x3bdb1c[_0x2f08bd]['to_floorlevel']=_0x170480[0x5];}else{if(_0x2f08bd==_0x5a08da){if(_0x170480[0x0]=='A'&&_0x170480[0x1]=='L'&&_0x170480[0x2]=='L')console[_0x1ccd75(0x1e3)](_0x4f4d1d+'\x20<>\x20'+_0x2f08bd+_0x1ccd75(0x176)+_0x5a08da+'\x20<>\x20'+_0x170480+_0x1ccd75(0x1be)),_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1c2)]=_0x170480[0x0],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1c9)]=_0x170480[0x1],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x20b)]=0x0,_0x3bdb1c[_0x2f08bd]['to_bin']=0x0,_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x235)]=_0x1ccd75(0x170),_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1f7)]=_0x170480[0x3];else{var _0x1fe6b2;if(_0x170480[0x4]=='L')_0x1fe6b2=_0x1ccd75(0x236);else _0x170480[0x4]=='F'&&(_0x1fe6b2=_0x1ccd75(0x170));_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1c2)]=_0x170480[0x0],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1c9)]=_0x170480[0x1],_0x3bdb1c[_0x2f08bd]['to_bay']=_0x170480[0x2],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x205)]=_0x170480[0x3],_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x235)]=_0x1fe6b2,_0x3bdb1c[_0x2f08bd][_0x1ccd75(0x1f7)]=_0x170480[0x5];}}}}});}),_0x537e16['forEach']((_0x309395,_0x1fcc50)=>{var _0x4afc90=_0x4cae38;_0x3bdb1c[_0x1fcc50][_0x4afc90(0x224)]=_0x309395;}),_0x3387ff[_0x4cae38(0x253)]((_0x4f8308,_0x47ee89)=>{var _0x48234a=_0x4cae38;_0x3bdb1c[_0x47ee89][_0x48234a(0x25b)]=_0x4f8308;}),_0x2fcff2['forEach']((_0x5e7637,_0x74f755)=>{var _0x3d0885=_0x4cae38;_0x3bdb1c[_0x74f755][_0x3d0885(0x23b)]=_0x5e7637;}),_0x27adf3['forEach']((_0x118ac9,_0x28b4f9)=>{var _0x4725e3=_0x4cae38;_0x3bdb1c[_0x28b4f9][_0x4725e3(0x250)]=_0x118ac9;}),_0x365e1d[_0x4cae38(0x253)]((_0x446cba,_0x2cbad6)=>{var _0xb6f09b=_0x4cae38;_0x3bdb1c[_0x2cbad6][_0xb6f09b(0x25d)]=_0x446cba;}),_0xd2ecf5[_0x4cae38(0x253)]((_0x4fa786,_0x28c5bb)=>{var _0x20c10e=_0x4cae38;_0x3bdb1c[_0x28c5bb][_0x20c10e(0x24f)]=_0x4fa786;}),_0x53eb5d['forEach']((_0x38b7d9,_0x38f403)=>{_0x3bdb1c[_0x38f403]['batch_code']=_0x38b7d9;}),_0x5cadba[_0x4cae38(0x253)]((_0x56fd73,_0x1b13b2)=>{var _0x12fa0f=_0x4cae38;_0x3bdb1c[_0x1b13b2][_0x12fa0f(0x1ef)]=_0x56fd73;}),_0xc82a5f['forEach']((_0x35eb16,_0x1f49fc)=>{_0x3bdb1c[_0x1f49fc]['maxperunit']=_0x35eb16;}),_0x3bb5d6[_0x4cae38(0x253)]((_0x106516,_0x56deee)=>{var _0x39b3d6=_0x4cae38;_0x3bdb1c[_0x56deee][_0x39b3d6(0x171)]=_0x106516;}),_0x17e0d2[_0x4cae38(0x253)]((_0x46f701,_0x1f26b2)=>{_0x3bdb1c[_0x1f26b2]['prod_cat']=_0x46f701;}),_0x3465fa[_0x4cae38(0x253)]((_0x4df1ba,_0x2f727e)=>{var _0x14c00b=_0x4cae38;_0x3bdb1c[_0x2f727e][_0x14c00b(0x25a)]=_0x4df1ba;}),_0x1a1a47[_0x4cae38(0x253)]((_0x1510f4,_0x25c90d)=>{var _0x550911=_0x4cae38;_0x3bdb1c[_0x25c90d][_0x550911(0x16c)]=_0x1510f4;});const _0x7da9fb=_0x3bdb1c[_0x4cae38(0x1f1)](_0x14d982=>_0x14d982[_0x4cae38(0x1d3)]!=='0'&&_0x14d982[_0x4cae38(0x1d3)]!==''||_0x14d982[_0x4cae38(0x1f7)]!=='0'&&_0x14d982[_0x4cae38(0x1f7)]!==''),_0x1908ef=new transfers({'date':_0x3d6cab,'from_warehouse':_0x3d122b,'to_warehouse':_0x827077,'product':_0x7da9fb,'note':_0x405527,'invoice':_0x36d408}),_0x58e171=await _0x1908ef[_0x4cae38(0x1a8)]();_0x43d004[_0x4cae38(0x251)](_0x4cae38(0x1ed),_0x4cae38(0x260)),_0x38db08['redirect']('/transfer/preview/'+_0x58e171[_0x4cae38(0x18a)]);}catch(_0x388bfb){console[_0x4cae38(0x1e3)](_0x388bfb),_0x38db08[_0x4cae38(0x17e)](0xc8)[_0x4cae38(0x1de)]({'errorMessage':_0x388bfb[_0x4cae38(0x175)]});}}),router['get'](a0_0x353bcd(0x1ab),auth,async(_0x4fe0c4,_0x137701)=>{var _0x37053b=a0_0x353bcd;try{const {username:_0x33de3f,email:_0x4e1925,role:_0x68c343}=_0x4fe0c4[_0x37053b(0x193)],_0x13facf=_0x4fe0c4[_0x37053b(0x193)],_0x1f4cb9=await profile['findOne']({'email':_0x13facf[_0x37053b(0x1f9)]}),_0x2d5ea6=await master_shop[_0x37053b(0x189)]();console[_0x37053b(0x1e3)]('master',_0x2d5ea6);const _0x370827=await transfers['findById'](_0x4fe0c4['params']['id']);let _0x41166d=new Date(_0x370827[_0x37053b(0x1ef)]),_0x25b413=('0'+_0x41166d[_0x37053b(0x1b4)]())[_0x37053b(0x190)](-0x2),_0x3901d3=('0'+(_0x41166d['getMonth']()+0x1))[_0x37053b(0x190)](-0x2),_0x1a0f07=_0x41166d[_0x37053b(0x23f)](),_0x2a9bbd=_0x1a0f07+'-'+_0x3901d3+'-'+_0x25b413,_0xcf15d2;if(_0x13facf[_0x37053b(0x1c0)]==_0x37053b(0x1db)){const _0x3d487d=await staff[_0x37053b(0x1d2)]({'email':_0x13facf['email']});_0xcf15d2=await warehouse[_0x37053b(0x189)]({'status':_0x37053b(0x213),'name':_0x3d487d[_0x37053b(0x196)],'warehouse_category':'Raw\x20Materials'});}else _0xcf15d2=await warehouse[_0x37053b(0x189)]({'status':_0x37053b(0x213),'warehouse_category':_0x37053b(0x1c5)});const _0x4be0fe=await warehouse['aggregate']([{'$match':{'name':_0x370827[_0x37053b(0x1e4)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x37053b(0x25e)},'product_stock':{'$first':_0x37053b(0x21f)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x37053b(0x1bf)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x37053b(0x248)},'secondary_code':{'$first':_0x37053b(0x23e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x37053b(0x18b)},'rack':{'$first':_0x37053b(0x257)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x37053b(0x242)},'room':{'$first':_0x37053b(0x1fd)}}}]);if(_0x2d5ea6[0x0][_0x37053b(0x181)]==_0x37053b(0x21d)){var _0x2c0a1f=users[_0x37053b(0x23d)];console[_0x37053b(0x1e3)](_0x2c0a1f);}else{if(_0x2d5ea6[0x0][_0x37053b(0x181)]=='Hindi')var _0x2c0a1f=users[_0x37053b(0x255)];else{if(_0x2d5ea6[0x0][_0x37053b(0x181)]=='German')var _0x2c0a1f=users['German'];else{if(_0x2d5ea6[0x0][_0x37053b(0x181)]=='Spanish')var _0x2c0a1f=users[_0x37053b(0x22c)];else{if(_0x2d5ea6[0x0][_0x37053b(0x181)]==_0x37053b(0x238))var _0x2c0a1f=users[_0x37053b(0x238)];else{if(_0x2d5ea6[0x0][_0x37053b(0x181)]==_0x37053b(0x1e1))var _0x2c0a1f=users[_0x37053b(0x220)];else{if(_0x2d5ea6[0x0][_0x37053b(0x181)]==_0x37053b(0x19d))var _0x2c0a1f=users[_0x37053b(0x19d)];else{if(_0x2d5ea6[0x0][_0x37053b(0x181)]==_0x37053b(0x254))var _0x2c0a1f=users['Arabic'];}}}}}}}_0x137701['render'](_0x37053b(0x180),{'success':_0x4fe0c4['flash']('success'),'errors':_0x4fe0c4[_0x37053b(0x251)](_0x37053b(0x192)),'role':_0x13facf,'profile':_0x1f4cb9,'master_shop':_0x2d5ea6,'warehouse':_0xcf15d2,'transfer':_0x370827,'stock':_0x4be0fe,'language':_0x2c0a1f});}catch(_0xa42733){console[_0x37053b(0x1e3)](_0xa42733);}}),router[a0_0x353bcd(0x177)](a0_0x353bcd(0x1ab),auth,async(_0x1b235a,_0x4616c8)=>{var _0x4a0a57=a0_0x353bcd;try{const _0x378c49=_0x1b235a[_0x4a0a57(0x18f)]['id'],{from_warehouse:_0x3cc3e6,FromRoom_name:_0x2fbfba,to_warehouse:_0x53064b,ToRoom_name:_0x7cd203}=_0x1b235a['body'],_0x32712e=await transfers[_0x4a0a57(0x1b7)]({'_id':_0x378c49}),_0x307099=_0x32712e[_0x4a0a57(0x24a)]['map'](async _0x3e671e=>{var _0x4c6a51=_0x4a0a57;if(_0x3e671e[_0x4c6a51(0x1d3)]>0x0){var _0x6ac3bc=await warehouse[_0x4c6a51(0x1d2)]({'name':_0x32712e['from_warehouse'],'room':_0x3e671e[_0x4c6a51(0x25a)],'warehouse_category':_0x4c6a51(0x1c5)});const _0xb952d=_0x6ac3bc['product_details'][_0x4c6a51(0x1e9)](_0x405e76=>{var _0x293406=_0x4c6a51;_0x405e76[_0x293406(0x232)]==_0x3e671e[_0x293406(0x232)]&&_0x405e76[_0x293406(0x1b0)]==_0x3e671e[_0x293406(0x25f)]&&_0x405e76[_0x293406(0x1ec)]==_0x3e671e['from_types']&&_0x405e76[_0x293406(0x188)]==_0x3e671e['from_bin']&&_0x405e76[_0x293406(0x19e)]==_0x3e671e[_0x293406(0x1ce)]&&_0x405e76[_0x293406(0x1c9)]==_0x3e671e[_0x293406(0x1a6)]&&_0x405e76[_0x293406(0x1c2)]==_0x3e671e[_0x293406(0x1d1)]&&_0x405e76[_0x293406(0x1ef)]==_0x3e671e['expiry_date']&&_0x405e76[_0x293406(0x20d)]==_0x3e671e[_0x293406(0x20d)]&&_0x405e76[_0x293406(0x171)]==_0x3e671e['production_date']&&_0x405e76[_0x293406(0x1dc)]==_0x3e671e['from_invoice']&&_0x405e76[_0x293406(0x18a)]==_0x3e671e[_0x293406(0x1e6)]&&(_0x405e76[_0x293406(0x252)]=_0x405e76[_0x293406(0x252)]-_0x3e671e[_0x293406(0x1d3)]);});}return _0x6ac3bc;});Promise[_0x4a0a57(0x1b1)](_0x307099)[_0x4a0a57(0x22f)](async _0x2cb793=>{var _0x416dbc=_0x4a0a57;try{for(const _0x295e5e of _0x2cb793){await _0x295e5e[_0x416dbc(0x1a8)]();}try{const _0x33a494=_0x32712e[_0x416dbc(0x24a)][_0x416dbc(0x1e9)](async _0x5c8c4d=>{var _0x52ba0a=_0x416dbc;if(_0x5c8c4d[_0x52ba0a(0x1d3)]>0x0){var _0x2b3071=await warehouse[_0x52ba0a(0x1d2)]({'name':_0x32712e['to_warehouse'],'room':_0x5c8c4d['to_room_name'],'warehouse_category':_0x52ba0a(0x1c5)}),_0x4ec6db=0x0;const _0x1e773b=_0x2b3071[_0x52ba0a(0x20f)][_0x52ba0a(0x1e9)](_0x17d64=>{var _0x576f1a=_0x52ba0a;_0x17d64[_0x576f1a(0x232)]==_0x5c8c4d[_0x576f1a(0x232)]&&_0x17d64['floorlevel']==_0x5c8c4d[_0x576f1a(0x1f7)]&&_0x17d64['type']==_0x5c8c4d['to_types']&&_0x17d64[_0x576f1a(0x188)]==_0x5c8c4d['to_bin']&&_0x17d64[_0x576f1a(0x19e)]==_0x5c8c4d[_0x576f1a(0x20b)]&&_0x17d64[_0x576f1a(0x1c9)]==_0x5c8c4d[_0x576f1a(0x1c9)]&&_0x17d64[_0x576f1a(0x1c2)]==_0x5c8c4d[_0x576f1a(0x1c2)]&&_0x17d64[_0x576f1a(0x1ef)]==_0x5c8c4d[_0x576f1a(0x1ef)]&&_0x17d64[_0x576f1a(0x20d)]==_0x5c8c4d['batch_code']&&_0x17d64[_0x576f1a(0x171)]==_0x5c8c4d['production_date']&&_0x17d64['invoice']==_0x5c8c4d['To_invoice']&&(_0x17d64['product_stock']=_0x17d64[_0x576f1a(0x252)]+_0x5c8c4d['to_quantity'],_0x4ec6db++);});_0x4ec6db=='0'&&(_0x2b3071[_0x52ba0a(0x20f)]=_0x2b3071[_0x52ba0a(0x20f)]['concat']({'product_name':_0x5c8c4d[_0x52ba0a(0x232)],'product_stock':_0x5c8c4d[_0x52ba0a(0x1d3)],'bay':_0x5c8c4d[_0x52ba0a(0x20b)],'bin':_0x5c8c4d[_0x52ba0a(0x205)],'type':_0x5c8c4d[_0x52ba0a(0x235)],'floorlevel':_0x5c8c4d[_0x52ba0a(0x1f7)],'storage':_0x5c8c4d[_0x52ba0a(0x1c2)],'rack':_0x5c8c4d[_0x52ba0a(0x1c9)],'product_code':_0x5c8c4d[_0x52ba0a(0x23b)],'primary_code':_0x5c8c4d[_0x52ba0a(0x224)],'secondary_code':_0x5c8c4d[_0x52ba0a(0x25b)],'maxProducts':_0x5c8c4d[_0x52ba0a(0x250)],'storage':_0x5c8c4d[_0x52ba0a(0x1c2)],'rack':_0x5c8c4d[_0x52ba0a(0x1c9)],'expiry_date':_0x5c8c4d[_0x52ba0a(0x1ef)],'maxPerUnit':_0x5c8c4d['maxperunit'],'batch_code':_0x5c8c4d['batch_code'],'production_date':_0x5c8c4d[_0x52ba0a(0x171)]}));}return _0x2b3071;});Promise[_0x416dbc(0x1b1)](_0x33a494)['then'](async _0x50da94=>{var _0x76a307=_0x416dbc;try{for(const _0x253528 of _0x50da94){await warehouse[_0x76a307(0x19b)]({'_id':_0x253528[_0x76a307(0x18a)]},{'$addToSet':{'product_details':{'$each':_0x253528['product_details']}}});}_0x32712e[_0x76a307(0x1e2)]=_0x76a307(0x1a5);const _0x4d4eda=await _0x32712e[_0x76a307(0x1a8)](),_0xe6e263=await master_shop[_0x76a307(0x189)](),_0x2653b5=await email_settings[_0x76a307(0x1d2)](),_0x582ee0=await supervisor_settings['find']();var _0x5ef262=_0x32712e[_0x76a307(0x24a)],_0x3910dd='',_0x2b91b8;for(_0x2b91b8 in _0x5ef262){_0x3910dd+=_0x76a307(0x223)+_0x76a307(0x221)+_0x5ef262[_0x2b91b8][_0x76a307(0x232)]+_0x76a307(0x230)+_0x76a307(0x221)+_0x5ef262[_0x2b91b8]['product_code']+_0x76a307(0x230)+_0x76a307(0x221)+_0x5ef262[_0x2b91b8][_0x76a307(0x1d3)]+_0x76a307(0x230)+_0x76a307(0x221)+_0x5ef262[_0x2b91b8][_0x76a307(0x25d)]+'</td>'+_0x76a307(0x221)+_0x5ef262[_0x2b91b8][_0x76a307(0x24f)]+_0x76a307(0x230)+_0x76a307(0x221)+_0x32712e[_0x76a307(0x25c)]+'</td>'+_0x76a307(0x221)+_0x5ef262[_0x2b91b8][_0x76a307(0x16c)]+_0x76a307(0x230)+_0x76a307(0x221)+_0x5ef262[_0x2b91b8][_0x76a307(0x1c2)]+_0x5ef262[_0x2b91b8]['rack']+_0x5ef262[_0x2b91b8][_0x76a307(0x20b)]+_0x5ef262[_0x2b91b8][_0x76a307(0x205)]+_0x5ef262[_0x2b91b8][_0x76a307(0x235)][0x0]+_0x5ef262[_0x2b91b8][_0x76a307(0x1f7)]+_0x76a307(0x230),_0x76a307(0x173);}let _0x32dd80=nodemailer[_0x76a307(0x243)]({'host':_0x2653b5[_0x76a307(0x210)],'port':Number(_0x2653b5[_0x76a307(0x183)]),'secure':![],'auth':{'user':_0x2653b5[_0x76a307(0x1f9)],'pass':_0x2653b5[_0x76a307(0x20e)]}}),_0x2fe072={'from':_0x2653b5['email'],'to':_0x582ee0[0x0]['RMSEmail'],'subject':_0x76a307(0x22d),'attachments':[{'filename':_0x76a307(0x231),'path':__dirname+_0x76a307(0x1b2)+_0x76a307(0x1fb)+_0xe6e263[0x0][_0x76a307(0x203)],'cid':_0x76a307(0x259)}],'html':_0x76a307(0x1bd)+_0x76a307(0x1ff)+_0x76a307(0x185)+_0x76a307(0x17b)+_0x76a307(0x225)+_0x76a307(0x17b)+_0x76a307(0x256)+_0x76a307(0x249)+_0x76a307(0x17b)+_0x76a307(0x1d7)+_0xe6e263[0x0][_0x76a307(0x241)]+_0x76a307(0x1e7)+_0x76a307(0x249)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x76a307(0x17b)+_0x76a307(0x1bc)+_0x76a307(0x204)+_0x32712e[_0x76a307(0x1dc)]+'\x20'+_0x76a307(0x1eb)+_0x76a307(0x1df)+_0x32712e[_0x76a307(0x24e)]+'\x20'+'</span>'+_0x76a307(0x218)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x76a307(0x223)+_0x76a307(0x21a)+_0x76a307(0x24d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x76a307(0x209)+_0x76a307(0x234)+_0x76a307(0x1d0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x76a307(0x245)+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3910dd+'\x20'+_0x76a307(0x219)+_0x76a307(0x1b3)+_0x76a307(0x17b)+_0x76a307(0x212)+'<h5>'+_0xe6e263[0x0]['site_title']+'</h5>'+'</div>'+_0x76a307(0x249)+_0x76a307(0x1b9)};_0x32dd80[_0x76a307(0x1cd)](_0x2fe072,function(_0x4dbea4,_0x4d35ae){var _0x50abc7=_0x76a307;_0x4dbea4?(console['log'](_0x4dbea4),console[_0x50abc7(0x1e3)](_0x50abc7(0x1da))):console[_0x50abc7(0x1e3)](_0x50abc7(0x211));}),_0x1b235a['flash']('success','Transfer\x20Finalize\x20Successfully'),_0x4616c8[_0x76a307(0x20c)](_0x76a307(0x1c3)+_0x4d4eda[_0x76a307(0x18a)]);}catch(_0x31e885){console[_0x76a307(0x197)](_0x31e885),_0x4616c8[_0x76a307(0x17e)](0x1f4)['json']({'Perror':_0x76a307(0x214),'message':_0x31e885[_0x76a307(0x175)]});}})[_0x416dbc(0x1b6)](_0x39d7c1=>{var _0x16ca57=_0x416dbc;console['error'](_0x39d7c1),_0x4616c8[_0x16ca57(0x17e)](0x1f4)[_0x16ca57(0x1de)]({'Perror':_0x16ca57(0x1f4)});});}catch(_0x9c099f){_0x4616c8[_0x416dbc(0x1de)](_0x9c099f);}}catch(_0x1936ff){console['error'](_0x1936ff),_0x4616c8['status'](0x1f4)[_0x416dbc(0x1de)]({'Merror':_0x416dbc(0x214),'Message':_0x1936ff['message']});}})['catch'](_0x1040a3=>{var _0x3ec58a=_0x4a0a57;console['error'](_0x1040a3),_0x4616c8[_0x3ec58a(0x17e)](0x1f4)[_0x3ec58a(0x1de)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x1d270d){console[_0x4a0a57(0x1e3)](_0x1d270d);}});function BayBinSelected(_0x21b9ee,_0x7d07a6){var _0x4b79b5=a0_0x353bcd,_0x49b789=[],_0x4f8c6a=[],_0x379ed2=[],_0x212195=[],_0x21b1d2=[],_0x3d9692=[];let _0x100e97=[];if(_0x21b9ee==_0x4b79b5(0x239))switch(_0x7d07a6){case _0x4b79b5(0x206):_0x49b789=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4f8c6a=[0x1,0x2],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=[_0x4b79b5(0x236),_0x4b79b5(0x170)],_0x21b1d2=['D'],_0x3d9692=['A'];break;case'Rack\x20B':_0x49b789=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4f8c6a=[0x1,0x2],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=[_0x4b79b5(0x236),_0x4b79b5(0x170)],_0x21b1d2=['D'],_0x3d9692=['B'];break;case _0x4b79b5(0x17d):_0x49b789=[0x0],_0x4f8c6a=[0x0],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=['Floor'],_0x21b1d2=['D'],_0x3d9692=['S'];break;case _0x4b79b5(0x1f0):_0x49b789=[0x0],_0x4f8c6a=[0x0],_0x212195=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x379ed2=[_0x4b79b5(0x170)],_0x21b1d2=['D'],_0x3d9692=['R'];break;}else{if(_0x21b9ee==_0x4b79b5(0x1c4))switch(_0x7d07a6){case'Rack\x20A':_0x49b789=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4f8c6a=['B','F'],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=['Level','Floor'],_0x21b1d2=['C'],_0x3d9692=['A'];break;case _0x4b79b5(0x1ca):_0x49b789=[0x5,0x4,0x3,0x2,0x1],_0x4f8c6a=['F','B','S'],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=[_0x4b79b5(0x236),_0x4b79b5(0x170)],_0x21b1d2=['C'],_0x3d9692=['B'];break;case _0x4b79b5(0x1ba):_0x49b789=[0x1,0x2,0x3,0x4,0x5],_0x4f8c6a=['B','F','S'],_0x212195=[0x5,0x4,0x3,0x2,0x1],_0x379ed2=[_0x4b79b5(0x236),_0x4b79b5(0x170)],_0x21b1d2=['C'],_0x3d9692=['C'];break;case _0x4b79b5(0x1d5):_0x49b789=[0x5,0x4,0x3,0x2,0x1],_0x4f8c6a=['F','B','S'],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=['Level',_0x4b79b5(0x170)],_0x21b1d2=['C'],_0x3d9692=['D'];break;case _0x4b79b5(0x1a4):_0x49b789=[0x4,0x3,0x2,0x1],_0x4f8c6a=[0x1,0x2],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=['Level','Floor'],_0x21b1d2=['C'],_0x3d9692=['E'];break;case _0x4b79b5(0x19a):_0x49b789=[0x1,0x2,0x3],_0x4f8c6a=[0x1,0x2],_0x212195=[0x1,0x2,0x3,0x4,0x5],_0x379ed2=[_0x4b79b5(0x236)],_0x21b1d2=['C'],_0x3d9692=['F'];break;}}return{'levels':_0x49b789,'Isle':_0x4f8c6a,'rack':_0x212195,'type':_0x379ed2,'storage':_0x21b1d2,'rak':_0x3d9692};}function a0_0xb185(_0x15233d,_0x570bdb){var _0x3fcc5a=a0_0x3fcc();return a0_0xb185=function(_0xb185d4,_0x23a407){_0xb185d4=_0xb185d4-0x16b;var _0x233087=_0x3fcc5a[_0xb185d4];return _0x233087;},a0_0xb185(_0x15233d,_0x570bdb);}router['get'](a0_0x353bcd(0x1ae),auth,async(_0xe97a30,_0x487344)=>{var _0xa2ebc8=a0_0x353bcd;try{const {username:_0x5934a9,email:_0xe08739,role:_0x3c62be}=_0xe97a30[_0xa2ebc8(0x193)],_0x387c97=_0xe97a30[_0xa2ebc8(0x193)],_0x172c18=await profile[_0xa2ebc8(0x1d2)]({'email':_0x387c97[_0xa2ebc8(0x1f9)]}),_0x284692=await master_shop['find'](),_0x51dabd=await transfers[_0xa2ebc8(0x1b7)](_0xe97a30[_0xa2ebc8(0x18f)]['id']);let _0x43f039;if(_0x387c97[_0xa2ebc8(0x1c0)]==_0xa2ebc8(0x1db)){const _0x4546fc=await staff[_0xa2ebc8(0x1d2)]({'email':_0x387c97['email']});_0x43f039=await warehouse['aggregate']([{'$match':{'status':_0xa2ebc8(0x213),'name':_0x4546fc[_0xa2ebc8(0x196)],'warehouse_category':_0xa2ebc8(0x1c5)}},{'$group':{'_id':_0xa2ebc8(0x1ee),'name':{'$first':'$name'}}}]);}else _0x43f039=await warehouse[_0xa2ebc8(0x237)]([{'$match':{'status':_0xa2ebc8(0x213),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0xa2ebc8(0x1ee)}}}]);const _0x4dc868=await warehouse[_0xa2ebc8(0x237)]([{'$match':{'name':_0x51dabd['from_warehouse'],'warehouse_category':_0xa2ebc8(0x1c5)}},{'$unwind':_0xa2ebc8(0x198)},{'$group':{'_id':_0xa2ebc8(0x1dd),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xa2ebc8(0x21f)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xa2ebc8(0x21e)},'floorlevel':{'$first':_0xa2ebc8(0x1c7)},'primary_code':{'$first':_0xa2ebc8(0x248)},'secondary_code':{'$first':_0xa2ebc8(0x23e)},'product_code':{'$first':_0xa2ebc8(0x191)},'storage':{'$first':_0xa2ebc8(0x18b)},'rack':{'$first':_0xa2ebc8(0x257)},'expiry_date':{'$first':_0xa2ebc8(0x187)},'production_date':{'$first':_0xa2ebc8(0x242)},'room':{'$first':_0xa2ebc8(0x1fd)}}}]),_0x339f6f=await product[_0xa2ebc8(0x189)]({}),_0x5c65cc=BayBinSelected(_0x51dabd[_0xa2ebc8(0x25c)],_0x51dabd['to_room']);if(_0x284692[0x0][_0xa2ebc8(0x181)]==_0xa2ebc8(0x21d)){var _0x3cbeb1=users['English'];console[_0xa2ebc8(0x1e3)](_0x3cbeb1);}else{if(_0x284692[0x0][_0xa2ebc8(0x181)]==_0xa2ebc8(0x255))var _0x3cbeb1=users['Hindi'];else{if(_0x284692[0x0][_0xa2ebc8(0x181)]==_0xa2ebc8(0x179))var _0x3cbeb1=users[_0xa2ebc8(0x179)];else{if(_0x284692[0x0][_0xa2ebc8(0x181)]==_0xa2ebc8(0x22c))var _0x3cbeb1=users['Spanish'];else{if(_0x284692[0x0]['language']=='French')var _0x3cbeb1=users[_0xa2ebc8(0x238)];else{if(_0x284692[0x0][_0xa2ebc8(0x181)]=='Portuguese\x20(BR)')var _0x3cbeb1=users[_0xa2ebc8(0x220)];else{if(_0x284692[0x0]['language']==_0xa2ebc8(0x19d))var _0x3cbeb1=users[_0xa2ebc8(0x19d)];else{if(_0x284692[0x0][_0xa2ebc8(0x181)]==_0xa2ebc8(0x254))var _0x3cbeb1=users[_0xa2ebc8(0x1f3)];}}}}}}}_0x487344['render'](_0xa2ebc8(0x17a),{'success':_0xe97a30[_0xa2ebc8(0x251)](_0xa2ebc8(0x1ed)),'errors':_0xe97a30[_0xa2ebc8(0x251)](_0xa2ebc8(0x192)),'role':_0x387c97,'profile':_0x172c18,'master_shop':_0x284692,'warehouse':_0x43f039,'transfer':_0x51dabd,'stock':_0x4dc868,'unit':_0x339f6f,'language':_0x3cbeb1});}catch(_0x2523f6){console[_0xa2ebc8(0x1e3)](_0x2523f6);}}),router['post'](a0_0x353bcd(0x1ae),auth,async(_0x293d64,_0x1c1121)=>{var _0x1b8afc=a0_0x353bcd;try{const _0x1d2cbe=_0x293d64['params']['id'],_0x342458=await transfers[_0x1b8afc(0x1b7)](_0x1d2cbe);_0x1c1121[_0x1b8afc(0x1de)](_0x293d64['body']);return;const {date:_0x440c58,from_warehouse:_0x8f111,FromRoom_name:_0x41215c,to_warehouse:_0xc463f2,ToRoom_name:_0x1250eb,prod_name:_0x2c2682,from_prod_qty:_0x5b74e9,from_prod_level:_0x1ff4c7,from_prod_isle:_0x4ed4f8,from_prod_pallet:_0x532a8f,to_prod_qty:_0x4f067d,to_prod_level:_0x595a70,to_prod_isle:_0xdc31d2,to_prod_pallet:_0x1bf1ce,primary_code:_0x35cf8f,secondary_code:_0x290942,product_code3:_0x2d3fbd,note:_0x50e983,invoice:_0x38ba19,expiry_date:_0x87f461}=_0x293d64[_0x1b8afc(0x17c)];if(typeof _0x2c2682=='string')var _0x3f3f8e=[_0x293d64[_0x1b8afc(0x17c)]['prod_name']],_0xa6496=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1fe)]],_0x407a5d=[_0x293d64[_0x1b8afc(0x17c)]['from_prod_level']],_0x19c001=[_0x293d64['body'][_0x1b8afc(0x1cc)]],_0xf69dc2=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x172)]],_0xb67712=[_0x293d64[_0x1b8afc(0x17c)]['from_types']],_0x4f41ce=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1fc)]],_0x40f3e5=[_0x293d64[_0x1b8afc(0x17c)]['to_prod_level']],_0x4e19ec=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1ea)]],_0x28548c=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x194)]],_0x18175c=[_0x293d64[_0x1b8afc(0x17c)]['to_types']],_0x304e3a=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1c2)]],_0xe1c055=[_0x293d64[_0x1b8afc(0x17c)]['rak']],_0x325471=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x224)]],_0x1e88d6=[_0x293d64['body']['secondary_code']],_0x1da5ee=[_0x293d64['body'][_0x1b8afc(0x21c)]],_0x2806c7=[_0x293d64['body'][_0x1b8afc(0x264)]],_0x301671=[_0x293d64['body'][_0x1b8afc(0x25d)]],_0x3f697d=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x24f)]],_0x55e7a8=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x20d)]],_0x3bbf5a=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1ef)]],_0x3f25ea=[_0x293d64['body'][_0x1b8afc(0x1d1)]],_0x2dbcce=[_0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x16f)]];else var _0x3f3f8e=[..._0x293d64['body'][_0x1b8afc(0x16e)]],_0x304e3a=[..._0x293d64['body'][_0x1b8afc(0x1c2)]],_0xe1c055=[..._0x293d64[_0x1b8afc(0x17c)]['rak']],_0xb67712=[..._0x293d64[_0x1b8afc(0x17c)]['from_types']],_0x18175c=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x235)]],_0xa6496=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1fe)]],_0x407a5d=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1bb)]],_0x19c001=[..._0x293d64['body'][_0x1b8afc(0x1cc)]],_0xf69dc2=[..._0x293d64[_0x1b8afc(0x17c)]['from_prod_pallet']],_0x4f41ce=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1fc)]],_0x40f3e5=[..._0x293d64[_0x1b8afc(0x17c)]['to_prod_level']],_0x4e19ec=[..._0x293d64['body'][_0x1b8afc(0x1ea)]],_0x28548c=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x194)]],_0x325471=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x224)]],_0x1e88d6=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x25b)]],_0x1da5ee=[..._0x293d64['body'][_0x1b8afc(0x21c)]],_0x2806c7=[..._0x293d64['body']['MaxStocks_data2']],_0x301671=[..._0x293d64['body']['unit']],_0x3f697d=[..._0x293d64['body'][_0x1b8afc(0x24f)]],_0x55e7a8=[..._0x293d64[_0x1b8afc(0x17c)]['batch_code']],_0x3bbf5a=[..._0x293d64[_0x1b8afc(0x17c)]['expiry_date']],_0x3f25ea=[..._0x293d64[_0x1b8afc(0x17c)][_0x1b8afc(0x1d1)]],_0x2dbcce=[..._0x293d64[_0x1b8afc(0x17c)]['from_rak']];const _0x51be08=_0x3f3f8e[_0x1b8afc(0x1e9)](_0x482393=>{return _0x482393={'product_name':_0x482393};});_0xa6496[_0x1b8afc(0x253)]((_0x2f3ae2,_0x3aafb8)=>{var _0x5c4616=_0x1b8afc;_0x51be08[_0x3aafb8][_0x5c4616(0x182)]=_0x2f3ae2;}),_0x407a5d[_0x1b8afc(0x253)]((_0x4a07aa,_0x3c9e1a)=>{var _0x4e9869=_0x1b8afc;_0x51be08[_0x3c9e1a][_0x4e9869(0x1ce)]=_0x4a07aa;}),_0x19c001[_0x1b8afc(0x253)]((_0x5f2502,_0x347ae3)=>{var _0x5760f6=_0x1b8afc;_0x51be08[_0x347ae3][_0x5760f6(0x1af)]=_0x5f2502;}),_0xf69dc2['forEach']((_0x57ba8a,_0x45de97)=>{var _0x8c9cd=_0x1b8afc;_0x51be08[_0x45de97][_0x8c9cd(0x25f)]=_0x57ba8a;}),_0x4f41ce[_0x1b8afc(0x253)]((_0x538e23,_0x1ba029)=>{var _0x2e77e0=_0x1b8afc;_0x51be08[_0x1ba029][_0x2e77e0(0x1d3)]=_0x538e23;}),_0x40f3e5[_0x1b8afc(0x253)]((_0x3b8fab,_0x545315)=>{_0x51be08[_0x545315]['to_bay']=_0x3b8fab;}),_0x4e19ec[_0x1b8afc(0x253)]((_0x422f68,_0x52980c)=>{var _0x26396b=_0x1b8afc;_0x51be08[_0x52980c][_0x26396b(0x205)]=_0x422f68;}),_0x28548c[_0x1b8afc(0x253)]((_0x580c31,_0xd809ac)=>{var _0x154a54=_0x1b8afc;_0x51be08[_0xd809ac][_0x154a54(0x1f7)]=_0x580c31;}),_0x325471[_0x1b8afc(0x253)]((_0x3eede5,_0xa33405)=>{var _0x379132=_0x1b8afc;_0x51be08[_0xa33405][_0x379132(0x224)]=_0x3eede5;}),_0x1e88d6[_0x1b8afc(0x253)]((_0x354648,_0x444922)=>{var _0x256421=_0x1b8afc;_0x51be08[_0x444922][_0x256421(0x25b)]=_0x354648;}),_0x1da5ee[_0x1b8afc(0x253)]((_0x28d78a,_0x486133)=>{var _0x112506=_0x1b8afc;_0x51be08[_0x486133][_0x112506(0x23b)]=_0x28d78a;}),_0x2806c7[_0x1b8afc(0x253)]((_0x2d2f09,_0x420b98)=>{var _0x237f5c=_0x1b8afc;_0x51be08[_0x420b98][_0x237f5c(0x250)]=_0x2d2f09;}),_0x301671[_0x1b8afc(0x253)]((_0x35409e,_0x1c9c6f)=>{var _0x40e9df=_0x1b8afc;_0x51be08[_0x1c9c6f][_0x40e9df(0x25d)]=_0x35409e;}),_0x3f697d[_0x1b8afc(0x253)]((_0x1b138f,_0x31fbb7)=>{var _0x234397=_0x1b8afc;_0x51be08[_0x31fbb7][_0x234397(0x24f)]=_0x1b138f;}),_0x55e7a8[_0x1b8afc(0x253)]((_0x256e63,_0x45e0f1)=>{var _0x1a3dbf=_0x1b8afc;_0x51be08[_0x45e0f1][_0x1a3dbf(0x20d)]=_0x256e63;}),_0x3bbf5a['forEach']((_0x418f05,_0x185ebb)=>{var _0x27a65c=_0x1b8afc;_0x51be08[_0x185ebb][_0x27a65c(0x1ef)]=_0x418f05;}),_0x304e3a[_0x1b8afc(0x253)]((_0x2ebab6,_0x22c6b1)=>{var _0x559c8=_0x1b8afc;_0x51be08[_0x22c6b1][_0x559c8(0x1c2)]=_0x2ebab6;}),_0xe1c055['forEach']((_0x26b0ea,_0x41c627)=>{var _0x5c375b=_0x1b8afc;_0x51be08[_0x41c627][_0x5c375b(0x1c9)]=_0x26b0ea;}),_0xb67712['forEach']((_0x3d1471,_0x59cb78)=>{var _0x397af1=_0x1b8afc;_0x51be08[_0x59cb78][_0x397af1(0x22e)]=_0x3d1471;}),_0x18175c[_0x1b8afc(0x253)]((_0x50db5a,_0x3037af)=>{var _0x5a1417=_0x1b8afc;_0x51be08[_0x3037af][_0x5a1417(0x235)]=_0x50db5a;}),_0x3f25ea[_0x1b8afc(0x253)]((_0x4c4686,_0x28ff11)=>{var _0x1c0cbb=_0x1b8afc;_0x51be08[_0x28ff11][_0x1c0cbb(0x1d1)]=_0x4c4686;}),_0x2dbcce['forEach']((_0x54965a,_0x2c7658)=>{_0x51be08[_0x2c7658]['from_rack']=_0x54965a;});const _0x1cf8e5=_0x51be08[_0x1b8afc(0x1f1)](_0x29d8e6=>_0x29d8e6[_0x1b8afc(0x1d3)]!=='0'&&_0x29d8e6[_0x1b8afc(0x1d3)]!==''||_0x29d8e6[_0x1b8afc(0x1f7)]!=='0'&&_0x29d8e6[_0x1b8afc(0x1f7)]!=='');var _0x1f8b43=0x0;_0x1cf8e5[_0x1b8afc(0x253)](_0x126c0c=>{var _0x382b7c=_0x1b8afc;parseInt(_0x126c0c[_0x382b7c(0x182)])<parseInt(_0x126c0c['to_quantity'])&&_0x1f8b43++;});if(_0x1f8b43!=0x0)return _0x293d64[_0x1b8afc(0x251)](_0x1b8afc(0x192),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x1c1121[_0x1b8afc(0x20c)](_0x1b8afc(0x22a));const _0x64f899=await warehouse[_0x1b8afc(0x1d2)]({'name':_0x342458['from_warehouse'],'room':_0x342458[_0x1b8afc(0x18c)]});_0x342458[_0x1b8afc(0x24a)][_0x1b8afc(0x253)](_0x1e69a2=>{var _0x37af7a=_0x1b8afc;if(_0x1e69a2[_0x37af7a(0x1d3)]>0x0){const _0x211b86=_0x64f899[_0x37af7a(0x20f)][_0x37af7a(0x1e9)](_0x523f01=>{var _0x44ce4a=_0x37af7a;_0x523f01[_0x44ce4a(0x232)]==_0x1e69a2[_0x44ce4a(0x232)]&&_0x523f01[_0x44ce4a(0x1b0)]==_0x1e69a2[_0x44ce4a(0x25f)]&&_0x523f01[_0x44ce4a(0x1ec)]==_0x1e69a2[_0x44ce4a(0x22e)]&&_0x523f01['bin']==_0x1e69a2[_0x44ce4a(0x1af)]&&_0x523f01[_0x44ce4a(0x19e)]==_0x1e69a2[_0x44ce4a(0x1ce)]&&_0x523f01[_0x44ce4a(0x1c9)]==_0x1e69a2[_0x44ce4a(0x1a6)]&&_0x523f01[_0x44ce4a(0x1c2)]==_0x1e69a2[_0x44ce4a(0x1d1)]&&(_0x523f01[_0x44ce4a(0x252)]=parseInt(_0x523f01[_0x44ce4a(0x252)])+parseInt(_0x1e69a2[_0x44ce4a(0x1d3)]));});}}),await _0x64f899[_0x1b8afc(0x1a8)]();const _0x584797=await warehouse['findOne']({'name':_0x342458['to_warehouse'],'room':_0x342458[_0x1b8afc(0x1c1)]});_0x342458[_0x1b8afc(0x24a)][_0x1b8afc(0x253)](_0x467511=>{var _0x34a596=_0x1b8afc;if(_0x467511[_0x34a596(0x1d3)]>0x0){const _0x575d30=_0x584797['product_details'][_0x34a596(0x1e9)](_0x5bd3f4=>{var _0x16680f=_0x34a596;_0x5bd3f4[_0x16680f(0x232)]==_0x467511['product_name']&&_0x5bd3f4[_0x16680f(0x1b0)]==_0x467511[_0x16680f(0x1f7)]&&_0x5bd3f4[_0x16680f(0x1ec)]==_0x467511[_0x16680f(0x235)]&&_0x5bd3f4[_0x16680f(0x188)]==_0x467511['to_bin']&&_0x5bd3f4['bay']==_0x467511['to_bay']&&_0x5bd3f4['rack']==_0x467511[_0x16680f(0x1c9)]&&_0x5bd3f4['storage']==_0x467511[_0x16680f(0x1c2)]&&(_0x5bd3f4[_0x16680f(0x252)]=parseInt(_0x5bd3f4['product_stock'])-parseInt(_0x467511[_0x16680f(0x1d3)]));});}}),await _0x584797[_0x1b8afc(0x1a8)](),_0x342458[_0x1b8afc(0x24e)]=_0x440c58,_0x342458['from_warehouse']=_0x8f111,_0x342458[_0x1b8afc(0x25c)]=_0xc463f2,_0x342458[_0x1b8afc(0x24a)]=_0x1cf8e5,_0x342458[_0x1b8afc(0x199)]=_0x50e983,_0x342458[_0x1b8afc(0x1dc)]=_0x38ba19;const _0x597590=await _0x342458[_0x1b8afc(0x1a8)]();console['log'](_0x597590);const _0x1ced2f=await warehouse[_0x1b8afc(0x1d2)]({'name':_0x8f111,'room':_0x41215c});_0x597590[_0x1b8afc(0x24a)][_0x1b8afc(0x253)](_0x594aa4=>{var _0x5a0b6d=_0x1b8afc;if(_0x594aa4[_0x5a0b6d(0x1d3)]>0x0){const _0x2582f4=_0x1ced2f['product_details'][_0x5a0b6d(0x1e9)](_0x2dad17=>{var _0x7f4582=_0x5a0b6d;_0x2dad17['product_name']==_0x594aa4[_0x7f4582(0x232)]&&_0x2dad17[_0x7f4582(0x1b0)]==_0x594aa4['from_floorlevel']&&_0x2dad17[_0x7f4582(0x1ec)]==_0x594aa4[_0x7f4582(0x22e)]&&_0x2dad17[_0x7f4582(0x188)]==_0x594aa4[_0x7f4582(0x1af)]&&_0x2dad17[_0x7f4582(0x19e)]==_0x594aa4[_0x7f4582(0x1ce)]&&_0x2dad17[_0x7f4582(0x1c9)]==_0x594aa4[_0x7f4582(0x1a6)]&&_0x2dad17[_0x7f4582(0x1c2)]==_0x594aa4['from_storage']&&(_0x2dad17[_0x7f4582(0x252)]=parseInt(_0x2dad17[_0x7f4582(0x252)])-parseInt(_0x594aa4[_0x7f4582(0x1d3)]));});}}),await _0x1ced2f[_0x1b8afc(0x1a8)]();const _0x806610=await warehouse[_0x1b8afc(0x1d2)]({'name':_0xc463f2,'room':_0x1250eb});_0x597590[_0x1b8afc(0x24a)][_0x1b8afc(0x253)](_0x1f431b=>{var _0x2f9c3b=_0x1b8afc;if(_0x1f431b[_0x2f9c3b(0x1d3)]>0x0){var _0x123fc9=0x0;const _0x1d8397=_0x806610['product_details'][_0x2f9c3b(0x1e9)](_0x39f19b=>{var _0x4c958b=_0x2f9c3b;_0x39f19b[_0x4c958b(0x232)]==_0x1f431b[_0x4c958b(0x232)]&&_0x39f19b[_0x4c958b(0x1b0)]==_0x1f431b[_0x4c958b(0x1f7)]&&_0x39f19b[_0x4c958b(0x1ec)]==_0x1f431b[_0x4c958b(0x235)]&&_0x39f19b[_0x4c958b(0x188)]==_0x1f431b['to_bin']&&_0x39f19b[_0x4c958b(0x19e)]==_0x1f431b[_0x4c958b(0x20b)]&&_0x39f19b[_0x4c958b(0x1c9)]==_0x1f431b[_0x4c958b(0x1c9)]&&_0x39f19b[_0x4c958b(0x1c2)]==_0x1f431b[_0x4c958b(0x1c2)]&&(_0x39f19b[_0x4c958b(0x252)]=parseInt(_0x39f19b[_0x4c958b(0x252)])+parseInt(_0x1f431b[_0x4c958b(0x1d3)]),_0x123fc9++);});_0x123fc9=='0'&&(_0x806610['product_details']=_0x806610[_0x2f9c3b(0x20f)][_0x2f9c3b(0x1a9)]({'product_name':_0x1f431b[_0x2f9c3b(0x232)],'product_stock':_0x1f431b[_0x2f9c3b(0x1d3)],'bay':_0x1f431b[_0x2f9c3b(0x20b)],'bin':_0x1f431b[_0x2f9c3b(0x205)],'type':_0x1f431b['to_types'],'floorlevel':_0x1f431b[_0x2f9c3b(0x1f7)],'storage':_0x1f431b[_0x2f9c3b(0x1c2)],'rack':_0x1f431b['rack'],'product_code':_0x1f431b[_0x2f9c3b(0x23b)],'primary_code':_0x1f431b[_0x2f9c3b(0x224)],'secondary_code':_0x1f431b[_0x2f9c3b(0x25b)],'maxProducts':_0x1f431b[_0x2f9c3b(0x250)],'storage':_0x1f431b[_0x2f9c3b(0x1c2)],'rack':_0x1f431b[_0x2f9c3b(0x1c9)]}));}}),await _0x806610[_0x1b8afc(0x1a8)](),_0x293d64[_0x1b8afc(0x251)](_0x1b8afc(0x1ed),_0x1b8afc(0x1b5)),_0x1c1121[_0x1b8afc(0x20c)]('/transfer/view');}catch(_0xcffdf5){console[_0x1b8afc(0x1e3)](_0xcffdf5);}}),router[a0_0x353bcd(0x177)](a0_0x353bcd(0x21b),async(_0x45d74a,_0x5b908d)=>{var _0xf3d974=a0_0x353bcd;const {FromWareHouse:_0x342111,FromRoom:_0xbe6d2a,ToWarehouse:_0x624e5c,ToRoom:_0xe8ce78,primary_code:_0x56fd7d,Roomslist:_0x2b20dc}=_0x45d74a['body'],_0x1d6484=_0x2b20dc['split'](','),_0x4b97b7=[];async function _0x5071c5(_0x566d77){var _0x119fb0=a0_0xb185;const _0x129f4e=await warehouse['aggregate']([{'$match':{'name':_0x342111,'room':_0x566d77}},{'$unwind':_0x119fb0(0x198)},{'$match':{'product_details.primary_code':_0x56fd7d}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x119fb0(0x21f)},'primary_code':{'$first':_0x119fb0(0x248)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x119fb0(0x191)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x119fb0(0x1bf)},'type':{'$first':_0x119fb0(0x21e)},'pallet':{'$first':_0x119fb0(0x1c7)},'unit':{'$first':_0x119fb0(0x1cf)},'secondary_unit':{'$first':_0x119fb0(0x1f2)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x119fb0(0x257)},'expiry_date':{'$first':_0x119fb0(0x187)},'production_date':{'$first':_0x119fb0(0x242)},'batch_code':{'$first':_0x119fb0(0x247)},'maxPerUnit':{'$first':_0x119fb0(0x1a3)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x119fb0(0x244)}}}]),_0x353227=await warehouse['aggregate']([{'$match':{'name':_0x342111,'room':_0x566d77}},{'$unwind':_0x119fb0(0x198)},{'$match':{'product_details.secondary_code':_0x56fd7d}},{'$group':{'_id':_0x119fb0(0x1dd),'name':{'$first':_0x119fb0(0x25e)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x119fb0(0x248)},'secondary_code':{'$first':_0x119fb0(0x23e)},'product_code':{'$first':_0x119fb0(0x191)},'level':{'$first':_0x119fb0(0x222)},'isle':{'$first':_0x119fb0(0x1bf)},'type':{'$first':_0x119fb0(0x21e)},'pallet':{'$first':_0x119fb0(0x1c7)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x119fb0(0x1f2)},'storage':{'$first':_0x119fb0(0x18b)},'rack':{'$first':_0x119fb0(0x257)},'expiry_date':{'$first':_0x119fb0(0x187)},'production_date':{'$first':_0x119fb0(0x242)},'batch_code':{'$first':_0x119fb0(0x247)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x119fb0(0x1fd)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x119fb0(0x244)}}}]);if(_0x129f4e[_0x119fb0(0x18d)]>0x0)_0x4b97b7[_0x119fb0(0x1cb)](_0x129f4e);else _0x353227[_0x119fb0(0x18d)]>0x0&&_0x4b97b7[_0x119fb0(0x1cb)](_0x353227);}const _0x4aa36b=_0x1d6484[_0xf3d974(0x1e9)](_0x2c6679=>_0x5071c5(_0x2c6679));await Promise[_0xf3d974(0x1b1)](_0x4aa36b),_0x5b908d[_0xf3d974(0x1de)](_0x4b97b7);}),router[a0_0x353bcd(0x177)](a0_0x353bcd(0x261),async(_0x1328ae,_0x560d0f)=>{var _0x564e51=a0_0x353bcd;try{const {FromWareHouse:_0x473365,FromRoom:_0x4365ab,ToWarehouse:_0x499763,ToRoom:_0x4f220a,secondary_code:_0x24a06a}=_0x1328ae[_0x564e51(0x17c)],_0x765191=await warehouse['aggregate']([{'$match':{'name':_0x473365}},{'$unwind':_0x564e51(0x198)},{'$match':{'product_details.secondary_code':_0x24a06a}},{'$group':{'_id':_0x564e51(0x1dd),'name':{'$first':_0x564e51(0x25e)},'primary_code':{'$first':_0x564e51(0x248)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x564e51(0x191)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x564e51(0x1ee)},'level':{'$first':_0x564e51(0x258)},'isle':{'$first':_0x564e51(0x1f5)},'pallet':{'$first':_0x564e51(0x184)},'maxProducts':{'$first':_0x564e51(0x1d8)},'unit':{'$first':_0x564e51(0x1cf)}}}]);_0x560d0f[_0x564e51(0x17e)](0xc8)[_0x564e51(0x1de)](_0x765191);}catch(_0x9118ca){_0x560d0f['status'](0x194)['json']({'message':_0x9118ca[_0x564e51(0x175)]});}}),router[a0_0x353bcd(0x177)](a0_0x353bcd(0x23a),async(_0x1a7ff4,_0x30ce54)=>{var _0x23abc8=a0_0x353bcd;try{const {FromWareHouse:_0x59af40,FromRoom:_0x3583eb,ToWarehouse:_0x507439,ToRoom:_0x20478c,product_code:_0x4ffff2}=_0x1a7ff4[_0x23abc8(0x17c)],_0x14e464=await warehouse[_0x23abc8(0x237)]([{'$match':{'name':_0x59af40}},{'$unwind':_0x23abc8(0x198)},{'$match':{'product_details.product_code':_0x4ffff2}},{'$group':{'_id':_0x23abc8(0x1dd),'name':{'$first':_0x23abc8(0x25e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x23abc8(0x191)},'instock':{'$first':_0x23abc8(0x21f)},'warehouse':{'$first':_0x23abc8(0x1ee)},'level':{'$first':_0x23abc8(0x258)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x23abc8(0x184)},'maxProducts':{'$first':_0x23abc8(0x1d8)},'unit':{'$first':'$product_details.unit'}}}]);_0x30ce54['status'](0xc8)[_0x23abc8(0x1de)](_0x14e464);}catch(_0x20d3e5){_0x30ce54['status'](0x194)[_0x23abc8(0x1de)]({'message':_0x20d3e5[_0x23abc8(0x175)]});}}),router[a0_0x353bcd(0x177)](a0_0x353bcd(0x228),async(_0x14d0f0,_0x450956)=>{var _0x8c9c30=a0_0x353bcd;const {level:_0x511a6b,isle:_0x4725ca,pallet:_0xf1290a,warehouses:_0x66b8b,room:_0x359bcb}=_0x14d0f0[_0x8c9c30(0x17c)];try{const _0x392e9c=await warehouse[_0x8c9c30(0x237)]([{'$match':{'name':_0x66b8b,'room':_0x359bcb}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x511a6b),'product_details.isle':_0x4725ca,'product_details.pallet':parseInt(_0xf1290a)}},{'$group':{'_id':_0x8c9c30(0x1dd),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x8c9c30(0x21f)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x8c9c30(0x1f5)},'pallet':{'$first':_0x8c9c30(0x184)},'maxProducts':{'$first':_0x8c9c30(0x1d8)}}}]);_0x450956[_0x8c9c30(0x17e)](0xc8)[_0x8c9c30(0x1de)](_0x392e9c);}catch(_0x3d5788){_0x450956[_0x8c9c30(0x17e)](0x194)[_0x8c9c30(0x1de)]({'message':_0x3d5788[_0x8c9c30(0x175)]});}}),module[a0_0x353bcd(0x19c)]=router;