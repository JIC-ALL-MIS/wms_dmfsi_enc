var a0_0x45dab0=a0_0x19d6;(function(_0x5e91c5,_0xe52cc9){var _0x33f0d2=a0_0x19d6,_0x3df6d3=_0x5e91c5();while(!![]){try{var _0x45c622=parseInt(_0x33f0d2(0x210))/0x1*(parseInt(_0x33f0d2(0x223))/0x2)+parseInt(_0x33f0d2(0x1cc))/0x3*(parseInt(_0x33f0d2(0x240))/0x4)+-parseInt(_0x33f0d2(0x1c3))/0x5*(-parseInt(_0x33f0d2(0x1ac))/0x6)+-parseInt(_0x33f0d2(0x231))/0x7+-parseInt(_0x33f0d2(0x24b))/0x8+-parseInt(_0x33f0d2(0x179))/0x9+-parseInt(_0x33f0d2(0x19b))/0xa*(-parseInt(_0x33f0d2(0x1d9))/0xb);if(_0x45c622===_0xe52cc9)break;else _0x3df6d3['push'](_0x3df6d3['shift']());}catch(_0x8e2226){_0x3df6d3['push'](_0x3df6d3['shift']());}}}(a0_0x1bbb,0xa7517));function a0_0x1bbb(){var _0xf3f48c=['</table>','$room','Enabled','to_prod_isle','user','password','production_date','to_invoice','Rack\x20B','$product_details.isle','</div>','TRF-','$product_details.level','\x20Order\x20Number\x20:\x20','</h5>','floorlevel','$product.from_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','from_invoice','$product_details.secondary_unit','catch','express','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','to_floorlevel','$product_details.bay','$product_details.batch_code','/picking_list/PDF_transfer_rm/','English','4aolhrj','port','/preview/:id','all','to_types','get','An\x20error\x20occurred.','COLD\x20STORAGE','Portuguese','error','createTransport','add_transfer','log','from_prod_isle','from_bay','/upload/','Rack\x20E','RMSEmail','primary_code','202454phcUmz','product_name','forEach','</span>','Rack\x20C','/barcode_scanner','Transfer\x20Edit\x20Successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_room','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','rak','from_prod_pallet','role','$product_details.type','2782395hqilIS','date','site_title','master','slice','floor','transfer','flash','to_warehouse','$product_details.floorlevel','Transfer\x20Mail','Product\x20Transfer\x20successfully','<html><head><title></title>','Shelves','RoomAssigned','4SeETzT','<strong>\x20Regards\x20</strong>','$product_details.maxProducts','maxProducts','$product_details.secondary_code','Rack\x20F','To_invoice','from_room_name','../middleware/auth','language','getMonth','1047904kScDKI','$product_details.rack','product_code','Receiving\x20Area','primary_unit','batch_code','$from_warehouse','storage','updateOne','params','post','/view/:id','product_code3','from_bin','Error\x20Occurs','success','Ambient','here','aggregate','$isAllowEdit','/CheckingWarehouse','to_bin','id_transaction','image','ToRoomAssigned','Arabic','$_id','bay','Rack\x20A','secondary_unit','/barcode_scanner2','$date','exports','from_storage','$product_details.primary_code','toString','$product_details.expiry_date','7937874sEwTBA','split','then','findById','padStart','\x20</h2>','<h2>\x20','Raw\x20Materials','<tbody\x20style=\x22text-align:\x20center;\x22>','/../public','finalize','from_prod_level','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</thead>','from_prod_qty','to_prod_pallet','maxperunit','Hindi','type','to_bay','Spanish','staff','host','$product_details.bin','<!DOCTYPE\x20html>','redirect','Chinese','from_warehouse','$product_details.invoice','findOne','status','invoice','MaxStocks_data2','English\x20(US)','10880iRwltg','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','from_rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','French','secondary_code','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','warehouse','from_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.product_stock','<tr>','$product_details.unit','</td>','string','to_prod_qty','334476mJeEKu','$product_details.production_date','$product_details.storage','../public/language/languages.json','filter','map','from_floorlevel','product_stock','<div>','nodemailer','Level','prod_name','email','getFullYear','$name','max_per_unit','product_details','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/view/add_transfer','_id','<h5>','expiry_date','id_transaction_id','115qXqgiC','/transfer/view','$product','Router','edit_transfer_view','to_room','</tbody>','message','rack','1105416rJynRT','$product_details.product_name','to_quantity','length','$invoice','Logo.png','Floor','German','An\x20error\x20occurred\x20while\x20saving\x20data.','errors','from_rak','find','to_room_name','407KyEffL','$product_details','to_prod_level','body','from_types','New_Qty_Converted','concat','bin','push','product','Arabic\x20(ae)','Rack\x20D','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','render','$product_details.pallet','prod_cat','$product_details.product_code','\x20<>\x20','json','save','There\x27s\x20a\x20error\x20in\x20this\x20transaction','random','Portuguese\x20(BR)','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product.to_room_name','note','$product_details.maxPerUnit'];a0_0x1bbb=function(){return _0xf3f48c;};return a0_0x1bbb();}const express=require(a0_0x45dab0(0x209)),app=express(),router=express[a0_0x45dab0(0x1c6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x45dab0(0x248)),users=require(a0_0x45dab0(0x1af)),nodemailer=require(a0_0x45dab0(0x1b5));router[a0_0x45dab0(0x215)]('/view',auth,async(_0xfb396b,_0x5bf324)=>{var _0x2b32ae=a0_0x45dab0;try{const {username:_0x8a64a3,email:_0x1dd214,role:_0x350483}=_0xfb396b[_0x2b32ae(0x1f8)],_0x3eb7f2=_0xfb396b['user'],_0x863399=await profile[_0x2b32ae(0x196)]({'email':_0x3eb7f2[_0x2b32ae(0x1b8)]}),_0x2878ab=await master_shop[_0x2b32ae(0x1d7)]();console[_0x2b32ae(0x21c)](_0x2b32ae(0x234),_0x2878ab);let _0xad5310;if(_0x3eb7f2[_0x2b32ae(0x22f)]==_0x2b32ae(0x18e)){const _0x1938b3=await staff['findOne']({'email':_0x3eb7f2[_0x2b32ae(0x1b8)]});_0xad5310=await transfers['find']({'from_warehouse':_0x1938b3[_0x2b32ae(0x1a3)]});}else _0xad5310=await transfers[_0x2b32ae(0x166)]([{'$unwind':_0x2b32ae(0x1c5)},{'$group':{'_id':_0x2b32ae(0x16e),'invoice':{'$first':_0x2b32ae(0x1d0)},'date':{'$first':_0x2b32ae(0x173)},'from_warehouse':{'$first':_0x2b32ae(0x251)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x2b32ae(0x204)},'to_room_name':{'$addToSet':_0x2b32ae(0x1f1)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x2b32ae(0x167)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2878ab[0x0][_0x2b32ae(0x249)]=='English\x20(US)'){var _0x2e2035=users[_0x2b32ae(0x20f)];console['log'](_0x2e2035);}else{if(_0x2878ab[0x0]['language']==_0x2b32ae(0x18a))var _0x2e2035=users['Hindi'];else{if(_0x2878ab[0x0][_0x2b32ae(0x249)]==_0x2b32ae(0x1d3))var _0x2e2035=users[_0x2b32ae(0x1d3)];else{if(_0x2878ab[0x0][_0x2b32ae(0x249)]==_0x2b32ae(0x18d))var _0x2e2035=users[_0x2b32ae(0x18d)];else{if(_0x2878ab[0x0][_0x2b32ae(0x249)]=='French')var _0x2e2035=users[_0x2b32ae(0x19f)];else{if(_0x2878ab[0x0][_0x2b32ae(0x249)]==_0x2b32ae(0x1ef))var _0x2e2035=users['Portuguese'];else{if(_0x2878ab[0x0][_0x2b32ae(0x249)]==_0x2b32ae(0x193))var _0x2e2035=users['Chinese'];else{if(_0x2878ab[0x0][_0x2b32ae(0x249)]==_0x2b32ae(0x1e3))var _0x2e2035=users[_0x2b32ae(0x16d)];}}}}}}}_0x5bf324[_0x2b32ae(0x1e6)](_0x2b32ae(0x237),{'success':_0xfb396b['flash'](_0x2b32ae(0x163)),'errors':_0xfb396b[_0x2b32ae(0x238)]('errors'),'role':_0x3eb7f2,'profile':_0x863399,'master_shop':_0x2878ab,'transfer':_0xad5310,'language':_0x2e2035});}catch(_0xc307a6){console[_0x2b32ae(0x21c)](_0xc307a6);}});function a0_0x19d6(_0x86e6c9,_0x13ebee){var _0x1bbbd4=a0_0x1bbb();return a0_0x19d6=function(_0x19d6ac,_0x22c6cc){_0x19d6ac=_0x19d6ac-0x163;var _0x444d2d=_0x1bbbd4[_0x19d6ac];return _0x444d2d;},a0_0x19d6(_0x86e6c9,_0x13ebee);}async function getRandom8DigitNumber(){var _0xba0138=a0_0x45dab0;const _0x4ae4a1=0x989680,_0x35250f=0x5f5e0ff,_0x39c5c3=Math[_0xba0138(0x236)](Math[_0xba0138(0x1ee)]()*(_0x35250f-_0x4ae4a1+0x1))+_0x4ae4a1;var _0x42d00b;const _0x3c6e2e=await transfers[_0xba0138(0x196)]({'invoice':'TRF-'+_0x39c5c3});return _0x3c6e2e&&_0x3c6e2e['length']>0x0?_0x42d00b='TRF-'+_0x39c5c3:_0x42d00b=_0xba0138(0x1ff)+_0x39c5c3,_0x42d00b;}router['get']('/view/add_transfer',auth,async(_0xfc10ea,_0x379961)=>{var _0x23efeb=a0_0x45dab0;try{const {username:_0x27eb1d,email:_0x336a21,role:_0x12f89b}=_0xfc10ea[_0x23efeb(0x1f8)],_0x2fde84=_0xfc10ea[_0x23efeb(0x1f8)],_0x2a921c=await profile[_0x23efeb(0x196)]({'email':_0x2fde84[_0x23efeb(0x1b8)]}),_0x53a1f5=await master_shop[_0x23efeb(0x1d7)]();console[_0x23efeb(0x21c)](_0x23efeb(0x234),_0x53a1f5);let _0x46f119;if(_0x2fde84[_0x23efeb(0x22f)]==_0x23efeb(0x18e)){const _0x239588=await staff[_0x23efeb(0x196)]({'email':_0x2fde84[_0x23efeb(0x1b8)]});_0x46f119=await warehouse['aggregate']([{'$match':{'status':_0x23efeb(0x1f6),'name':_0x239588[_0x23efeb(0x1a3)],'warehouse_category':_0x23efeb(0x180)}},{'$group':{'_id':_0x23efeb(0x1ba),'name':{'$first':_0x23efeb(0x1ba)}}}]);}else _0x46f119=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);var _0x52c31b=[_0x23efeb(0x164),'Enclosed','Return\x20Rooms'];const _0x544b8d=await transfers[_0x23efeb(0x1d7)]({}),_0x383629=_0x544b8d[_0x23efeb(0x1cf)]+0x1,_0x22fac5=_0x23efeb(0x1ff)+_0x383629[_0x23efeb(0x177)]()[_0x23efeb(0x17d)](0x5,'0');if(_0x53a1f5[0x0]['language']=='English\x20(US)'){var _0xccc583=users[_0x23efeb(0x20f)];console['log'](_0xccc583);}else{if(_0x53a1f5[0x0][_0x23efeb(0x249)]==_0x23efeb(0x18a))var _0xccc583=users[_0x23efeb(0x18a)];else{if(_0x53a1f5[0x0][_0x23efeb(0x249)]=='German')var _0xccc583=users['German'];else{if(_0x53a1f5[0x0][_0x23efeb(0x249)]==_0x23efeb(0x18d))var _0xccc583=users[_0x23efeb(0x18d)];else{if(_0x53a1f5[0x0][_0x23efeb(0x249)]==_0x23efeb(0x19f))var _0xccc583=users['French'];else{if(_0x53a1f5[0x0][_0x23efeb(0x249)]==_0x23efeb(0x1ef))var _0xccc583=users['Portuguese'];else{if(_0x53a1f5[0x0][_0x23efeb(0x249)]=='Chinese')var _0xccc583=users[_0x23efeb(0x193)];else{if(_0x53a1f5[0x0][_0x23efeb(0x249)]=='Arabic\x20(ae)')var _0xccc583=users[_0x23efeb(0x16d)];}}}}}}}const _0xb3823=getRandom8DigitNumber();_0xb3823['then'](_0x4b7554=>{var _0x516b84=_0x23efeb;_0x379961['render'](_0x516b84(0x21b),{'success':_0xfc10ea[_0x516b84(0x238)]('success'),'errors':_0xfc10ea[_0x516b84(0x238)](_0x516b84(0x1d5)),'role':_0x2fde84,'profile':_0x2a921c,'master_shop':_0x53a1f5,'warehouse':_0x46f119,'language':_0xccc583,'rooms_data':_0x52c31b,'invoice':_0x4b7554});})[_0x23efeb(0x208)](_0x2fe987=>{var _0x223ced=_0x23efeb;_0xfc10ea[_0x223ced(0x238)]('errors',_0x223ced(0x1ed)),_0x379961['redirect'](_0x223ced(0x1c4));});}catch(_0x48bb91){console['log'](_0x48bb91);}}),router[a0_0x45dab0(0x255)](a0_0x45dab0(0x1be),auth,async(_0x1574e9,_0x5d263e)=>{var _0x1e7aa2=a0_0x45dab0;try{console['log'](_0x1574e9[_0x1e7aa2(0x1dc)]);const {date:_0x2527ea,from_warehouse:_0x409183,FromRoom_name:_0x18e525,to_warehouse:_0x1db847,ToRoom_name:_0x2fa5c8,prod_name:_0x30b401,from_prod_qty:_0x1ee466,from_prod_level:_0x446a71,from_prod_isle:_0x38b7de,from_prod_pallet:_0x2987bd,to_prod_qty:_0x5a4eef,to_prod_level:_0x4b44b2,to_prod_isle:_0x48cb87,to_prod_pallet:_0xdba429,primary_code:_0x44c2c6,secondary_code:_0xe5cc1a,product_code3:_0x12d796,note:_0x4d69af,MaxStocks_data2:_0x283e78,invoice:_0x1a19ba,expiry_date:_0x2405eb}=_0x1574e9[_0x1e7aa2(0x1dc)];if(typeof _0x30b401=='string')var _0x2e38af=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1b7)]],_0x54ab4e=[_0x1574e9['body'][_0x1e7aa2(0x187)]],_0x2325c5=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x184)]],_0x3803bd=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1de)]],_0x275a93=[_0x1574e9[_0x1e7aa2(0x1dc)]['to_prod_level']],_0x589616=[_0x1574e9['body'][_0x1e7aa2(0x222)]],_0x115484=[_0x1574e9['body'][_0x1e7aa2(0x1a0)]],_0xd1f4f9=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x257)]],_0x5de82e=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x199)]],_0x43a2cd=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x24f)]],_0x16c44c=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x171)]],_0x2c5908=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x250)]],_0x2fcd04=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1c1)]],_0x447b1c=[_0x1574e9['body'][_0x1e7aa2(0x1bb)]],_0x14c581=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1fa)]],_0x4a9b69=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1e8)]],_0x2427ea=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x23f)]],_0x4129ae=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x16c)]],_0x881235=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x206)]],_0x106a35=[_0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1fb)]],_0x190eee=[_0x1574e9[_0x1e7aa2(0x1dc)]['id_transaction']];else var _0x2e38af=[..._0x1574e9['body'][_0x1e7aa2(0x1b7)]],_0x54ab4e=[..._0x1574e9['body'][_0x1e7aa2(0x187)]],_0x2325c5=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x184)]],_0x3803bd=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1de)]],_0x275a93=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1db)]],_0x589616=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x222)]],_0x115484=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1a0)]],_0xd1f4f9=[..._0x1574e9['body'][_0x1e7aa2(0x257)]],_0x5de82e=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x199)]],_0x43a2cd=[..._0x1574e9[_0x1e7aa2(0x1dc)]['primary_unit']],_0x16c44c=[..._0x1574e9['body']['secondary_unit']],_0x2c5908=[..._0x1574e9[_0x1e7aa2(0x1dc)]['batch_code']],_0x2fcd04=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1c1)]],_0x447b1c=[..._0x1574e9['body']['max_per_unit']],_0x14c581=[..._0x1574e9[_0x1e7aa2(0x1dc)]['production_date']],_0x4a9b69=[..._0x1574e9['body']['prod_cat']],_0x2427ea=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x23f)]],_0x4129ae=[..._0x1574e9[_0x1e7aa2(0x1dc)]['ToRoomAssigned']],_0x881235=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x206)]],_0x106a35=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x1fb)]],_0x190eee=[..._0x1574e9[_0x1e7aa2(0x1dc)][_0x1e7aa2(0x16a)]];const _0x4d2e51=_0x2e38af[_0x1e7aa2(0x1b1)](_0x4bca9e=>{return _0x4bca9e={'product_name':_0x4bca9e};});_0x54ab4e[_0x1e7aa2(0x225)]((_0x40374f,_0x298c74)=>{var _0x56583c=_0x1e7aa2;_0x4d2e51[_0x298c74][_0x56583c(0x1a4)]=_0x40374f;}),_0x881235[_0x1e7aa2(0x225)]((_0x33ac48,_0x4fd9ac)=>{var _0x3638ff=_0x1e7aa2;_0x4d2e51[_0x4fd9ac][_0x3638ff(0x206)]=_0x33ac48;}),_0x106a35[_0x1e7aa2(0x225)]((_0x514fab,_0x172d92)=>{_0x4d2e51[_0x172d92]['To_invoice']=_0x514fab;}),_0x190eee[_0x1e7aa2(0x225)]((_0x4e3c4c,_0x4015e3)=>{var _0x421e21=_0x1e7aa2;_0x4d2e51[_0x4015e3][_0x421e21(0x1c2)]=_0x4e3c4c;}),_0x2325c5['forEach']((_0x5b6afb,_0x3a825a)=>{_0x2427ea['forEach']((_0x51cda1,_0x1ea655)=>{var _0x595d4f=a0_0x19d6;if(_0x51cda1==_0x595d4f(0x24e)&&_0x3a825a==_0x1ea655){var _0x5bb6fd=_0x5b6afb[_0x595d4f(0x235)](0x3);_0x4d2e51[_0x3a825a][_0x595d4f(0x175)]=_0x5b6afb[0x0],_0x4d2e51[_0x3a825a][_0x595d4f(0x19d)]=_0x5b6afb[0x1],_0x4d2e51[_0x3a825a]['from_bay']=0x0,_0x4d2e51[_0x3a825a][_0x595d4f(0x258)]=0x0,_0x4d2e51[_0x3a825a][_0x595d4f(0x1dd)]=_0x595d4f(0x1d2),_0x4d2e51[_0x3a825a][_0x595d4f(0x1b2)]=_0x5bb6fd;}else{if(_0x51cda1==_0x595d4f(0x23e)&&_0x3a825a==_0x1ea655){var _0x5bb6fd=_0x5b6afb[_0x595d4f(0x235)](0x3);_0x4d2e51[_0x3a825a][_0x595d4f(0x175)]=_0x5b6afb[0x0],_0x4d2e51[_0x3a825a]['from_rack']=_0x5b6afb[0x1],_0x4d2e51[_0x3a825a][_0x595d4f(0x21e)]=0x0,_0x4d2e51[_0x3a825a][_0x595d4f(0x258)]=0x0,_0x4d2e51[_0x3a825a][_0x595d4f(0x1dd)]=_0x595d4f(0x1d2),_0x4d2e51[_0x3a825a][_0x595d4f(0x1b2)]=_0x5b6afb[0x5];}else{if(_0x3a825a==_0x1ea655){if(_0x5b6afb[0x0]=='A'&&_0x5b6afb[0x1]=='L'&&_0x5b6afb[0x2]=='L')console[_0x595d4f(0x21c)](_0x51cda1+_0x595d4f(0x1ea)+_0x3a825a+_0x595d4f(0x1ea)+_0x1ea655+'\x20<>\x20'+_0x5b6afb+_0x595d4f(0x165)),_0x4d2e51[_0x3a825a][_0x595d4f(0x175)]=_0x5b6afb[0x0],_0x4d2e51[_0x3a825a][_0x595d4f(0x19d)]=_0x5b6afb[0x1],_0x4d2e51[_0x3a825a]['from_bay']=0x0,_0x4d2e51[_0x3a825a]['from_bin']=0x0,_0x4d2e51[_0x3a825a][_0x595d4f(0x1dd)]='Floor',_0x4d2e51[_0x3a825a][_0x595d4f(0x1b2)]=_0x5b6afb[0x3];else{var _0x2c6338;if(_0x5b6afb[0x4]=='L')_0x2c6338=_0x595d4f(0x1b6);else _0x5b6afb[0x4]=='F'&&(_0x2c6338='Floor');_0x4d2e51[_0x3a825a][_0x595d4f(0x175)]=_0x5b6afb[0x0],_0x4d2e51[_0x3a825a][_0x595d4f(0x19d)]=_0x5b6afb[0x1],_0x4d2e51[_0x3a825a][_0x595d4f(0x21e)]=_0x5b6afb[0x2],_0x4d2e51[_0x3a825a]['from_bin']=_0x5b6afb[0x3],_0x4d2e51[_0x3a825a][_0x595d4f(0x1dd)]=_0x2c6338,_0x4d2e51[_0x3a825a][_0x595d4f(0x1b2)]=_0x5b6afb[0x5];}}}}});}),_0x3803bd[_0x1e7aa2(0x225)]((_0x202cd3,_0x895daa)=>{var _0x21d077=_0x1e7aa2;_0x4d2e51[_0x895daa][_0x21d077(0x1ce)]=_0x202cd3;}),_0x275a93[_0x1e7aa2(0x225)]((_0x31f66b,_0x20523d)=>{_0x4129ae['forEach']((_0x17ea77,_0x1ceead)=>{var _0x1083a9=a0_0x19d6;if(_0x17ea77==_0x1083a9(0x24e)&&_0x20523d==_0x1ceead){var _0x36e3f6=_0x31f66b[_0x1083a9(0x235)](0x3);_0x4d2e51[_0x20523d][_0x1083a9(0x252)]=_0x31f66b[0x0],_0x4d2e51[_0x20523d][_0x1083a9(0x1cb)]=_0x31f66b[0x1],_0x4d2e51[_0x20523d][_0x1083a9(0x18c)]=0x0,_0x4d2e51[_0x20523d][_0x1083a9(0x169)]=0x0,_0x4d2e51[_0x20523d][_0x1083a9(0x214)]=_0x1083a9(0x1d2),_0x4d2e51[_0x20523d][_0x1083a9(0x20b)]=_0x36e3f6;}else{if(_0x17ea77==_0x1083a9(0x23e)&&_0x20523d==_0x1ceead){var _0x36e3f6=_0x31f66b['slice'](0x3);_0x4d2e51[_0x20523d][_0x1083a9(0x252)]=_0x31f66b[0x0],_0x4d2e51[_0x20523d]['rack']=_0x31f66b[0x1],_0x4d2e51[_0x20523d][_0x1083a9(0x18c)]=0x0,_0x4d2e51[_0x20523d][_0x1083a9(0x169)]=0x0,_0x4d2e51[_0x20523d]['to_types']=_0x1083a9(0x1d2),_0x4d2e51[_0x20523d]['to_floorlevel']=_0x31f66b[0x5];}else{if(_0x20523d==_0x1ceead){if(_0x31f66b[0x0]=='A'&&_0x31f66b[0x1]=='L'&&_0x31f66b[0x2]=='L')console[_0x1083a9(0x21c)](_0x17ea77+_0x1083a9(0x1ea)+_0x20523d+_0x1083a9(0x1ea)+_0x1ceead+_0x1083a9(0x1ea)+_0x31f66b+_0x1083a9(0x165)),_0x4d2e51[_0x20523d][_0x1083a9(0x252)]=_0x31f66b[0x0],_0x4d2e51[_0x20523d][_0x1083a9(0x1cb)]=_0x31f66b[0x1],_0x4d2e51[_0x20523d]['to_bay']=0x0,_0x4d2e51[_0x20523d][_0x1083a9(0x169)]=0x0,_0x4d2e51[_0x20523d]['to_types']='Floor',_0x4d2e51[_0x20523d][_0x1083a9(0x20b)]=_0x31f66b[0x3];else{var _0x19e9a6;if(_0x31f66b[0x4]=='L')_0x19e9a6=_0x1083a9(0x1b6);else _0x31f66b[0x4]=='F'&&(_0x19e9a6='Floor');_0x4d2e51[_0x20523d][_0x1083a9(0x252)]=_0x31f66b[0x0],_0x4d2e51[_0x20523d]['rack']=_0x31f66b[0x1],_0x4d2e51[_0x20523d][_0x1083a9(0x18c)]=_0x31f66b[0x2],_0x4d2e51[_0x20523d][_0x1083a9(0x169)]=_0x31f66b[0x3],_0x4d2e51[_0x20523d][_0x1083a9(0x214)]=_0x19e9a6,_0x4d2e51[_0x20523d][_0x1083a9(0x20b)]=_0x31f66b[0x5];}}}}});}),_0x589616[_0x1e7aa2(0x225)]((_0x37aae1,_0xee7092)=>{var _0x594fd6=_0x1e7aa2;_0x4d2e51[_0xee7092][_0x594fd6(0x222)]=_0x37aae1;}),_0x115484[_0x1e7aa2(0x225)]((_0x1cb492,_0xbd64e2)=>{var _0x16ed5c=_0x1e7aa2;_0x4d2e51[_0xbd64e2][_0x16ed5c(0x1a0)]=_0x1cb492;}),_0xd1f4f9['forEach']((_0x17259d,_0x290c83)=>{var _0x26dd7f=_0x1e7aa2;_0x4d2e51[_0x290c83][_0x26dd7f(0x24d)]=_0x17259d;}),_0x5de82e['forEach']((_0x67a617,_0xd04251)=>{var _0x1aa556=_0x1e7aa2;_0x4d2e51[_0xd04251][_0x1aa556(0x243)]=_0x67a617;}),_0x43a2cd['forEach']((_0x2a4259,_0x1bf553)=>{_0x4d2e51[_0x1bf553]['unit']=_0x2a4259;}),_0x16c44c['forEach']((_0x4553ad,_0x3fe7e7)=>{var _0x4c577=_0x1e7aa2;_0x4d2e51[_0x3fe7e7][_0x4c577(0x171)]=_0x4553ad;}),_0x2c5908[_0x1e7aa2(0x225)]((_0x562efa,_0x105da2)=>{_0x4d2e51[_0x105da2]['batch_code']=_0x562efa;}),_0x2fcd04[_0x1e7aa2(0x225)]((_0x3f270a,_0xc763a6)=>{var _0x23a267=_0x1e7aa2;_0x4d2e51[_0xc763a6][_0x23a267(0x1c1)]=_0x3f270a;}),_0x447b1c['forEach']((_0x4e7600,_0x231a4e)=>{_0x4d2e51[_0x231a4e]['maxperunit']=_0x4e7600;}),_0x14c581[_0x1e7aa2(0x225)]((_0x1af068,_0x2a6193)=>{var _0x1b2053=_0x1e7aa2;_0x4d2e51[_0x2a6193][_0x1b2053(0x1fa)]=_0x1af068;}),_0x4a9b69[_0x1e7aa2(0x225)]((_0x7ae66b,_0x2b07f9)=>{var _0x37a338=_0x1e7aa2;_0x4d2e51[_0x2b07f9][_0x37a338(0x1e8)]=_0x7ae66b;}),_0x2427ea[_0x1e7aa2(0x225)]((_0x34a1e6,_0x3dc06e)=>{var _0x3f5860=_0x1e7aa2;_0x4d2e51[_0x3dc06e][_0x3f5860(0x247)]=_0x34a1e6;}),_0x4129ae['forEach']((_0x3b6aee,_0x4fd8ca)=>{_0x4d2e51[_0x4fd8ca]['to_room_name']=_0x3b6aee;});const _0x365ca0=_0x4d2e51['filter'](_0x2e8293=>_0x2e8293[_0x1e7aa2(0x1ce)]!=='0'&&_0x2e8293[_0x1e7aa2(0x1ce)]!==''||_0x2e8293[_0x1e7aa2(0x20b)]!=='0'&&_0x2e8293[_0x1e7aa2(0x20b)]!==''),_0x11403e=new transfers({'date':_0x2527ea,'from_warehouse':_0x409183,'to_warehouse':_0x1db847,'product':_0x365ca0,'note':_0x4d69af,'invoice':_0x1a19ba}),_0x591117=await _0x11403e[_0x1e7aa2(0x1ec)]();_0x1574e9[_0x1e7aa2(0x238)]('success',_0x1e7aa2(0x23c)),_0x5d263e[_0x1e7aa2(0x192)]('/transfer/preview/'+_0x591117[_0x1e7aa2(0x1bf)]);}catch(_0x2712b8){console[_0x1e7aa2(0x21c)](_0x2712b8),_0x5d263e[_0x1e7aa2(0x197)](0xc8)[_0x1e7aa2(0x1eb)]({'errorMessage':_0x2712b8[_0x1e7aa2(0x1ca)]});}}),router[a0_0x45dab0(0x215)]('/preview/:id',auth,async(_0x4da8ae,_0x1531e9)=>{var _0x16f02e=a0_0x45dab0;try{const {username:_0x52a8fc,email:_0x2308c9,role:_0xa0f6bc}=_0x4da8ae['user'],_0x95b851=_0x4da8ae['user'],_0x395da7=await profile[_0x16f02e(0x196)]({'email':_0x95b851[_0x16f02e(0x1b8)]}),_0x31efff=await master_shop[_0x16f02e(0x1d7)]();console[_0x16f02e(0x21c)](_0x16f02e(0x234),_0x31efff);const _0x42a90c=await transfers['findById'](_0x4da8ae['params']['id']);let _0x3aeb9e=new Date(_0x42a90c['expiry_date']),_0x3a35fd=('0'+_0x3aeb9e['getDate']())['slice'](-0x2),_0x154154=('0'+(_0x3aeb9e[_0x16f02e(0x24a)]()+0x1))[_0x16f02e(0x235)](-0x2),_0x55b09f=_0x3aeb9e[_0x16f02e(0x1b9)](),_0x446492=_0x55b09f+'-'+_0x154154+'-'+_0x3a35fd,_0x56d2e3;if(_0x95b851[_0x16f02e(0x22f)]==_0x16f02e(0x18e)){const _0x5bccf4=await staff[_0x16f02e(0x196)]({'email':_0x95b851[_0x16f02e(0x1b8)]});_0x56d2e3=await warehouse[_0x16f02e(0x1d7)]({'status':_0x16f02e(0x1f6),'name':_0x5bccf4[_0x16f02e(0x1a3)],'warehouse_category':_0x16f02e(0x180)});}else _0x56d2e3=await warehouse[_0x16f02e(0x1d7)]({'status':_0x16f02e(0x1f6),'warehouse_category':'Raw\x20Materials'});const _0x29289f=await warehouse[_0x16f02e(0x166)]([{'$match':{'name':_0x42a90c[_0x16f02e(0x194)]}},{'$unwind':_0x16f02e(0x1da)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x16f02e(0x1cd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x16f02e(0x20c)},'bin':{'$first':_0x16f02e(0x190)},'type':{'$first':_0x16f02e(0x230)},'floorlevel':{'$first':_0x16f02e(0x23a)},'primary_code':{'$first':_0x16f02e(0x176)},'secondary_code':{'$first':_0x16f02e(0x244)},'product_code':{'$first':_0x16f02e(0x1e9)},'storage':{'$first':_0x16f02e(0x1ae)},'rack':{'$first':_0x16f02e(0x24c)},'expiry_date':{'$first':_0x16f02e(0x178)},'production_date':{'$first':_0x16f02e(0x1ad)},'room':{'$first':_0x16f02e(0x1f5)}}}]);if(_0x31efff[0x0][_0x16f02e(0x249)]==_0x16f02e(0x19a)){var _0x35f80f=users[_0x16f02e(0x20f)];console['log'](_0x35f80f);}else{if(_0x31efff[0x0][_0x16f02e(0x249)]==_0x16f02e(0x18a))var _0x35f80f=users[_0x16f02e(0x18a)];else{if(_0x31efff[0x0][_0x16f02e(0x249)]==_0x16f02e(0x1d3))var _0x35f80f=users[_0x16f02e(0x1d3)];else{if(_0x31efff[0x0][_0x16f02e(0x249)]=='Spanish')var _0x35f80f=users[_0x16f02e(0x18d)];else{if(_0x31efff[0x0][_0x16f02e(0x249)]==_0x16f02e(0x19f))var _0x35f80f=users[_0x16f02e(0x19f)];else{if(_0x31efff[0x0]['language']==_0x16f02e(0x1ef))var _0x35f80f=users[_0x16f02e(0x218)];else{if(_0x31efff[0x0][_0x16f02e(0x249)]==_0x16f02e(0x193))var _0x35f80f=users['Chinese'];else{if(_0x31efff[0x0]['language']==_0x16f02e(0x1e3))var _0x35f80f=users[_0x16f02e(0x16d)];}}}}}}}_0x1531e9[_0x16f02e(0x1e6)](_0x16f02e(0x1c7),{'success':_0x4da8ae[_0x16f02e(0x238)](_0x16f02e(0x163)),'errors':_0x4da8ae['flash'](_0x16f02e(0x1d5)),'role':_0x95b851,'profile':_0x395da7,'master_shop':_0x31efff,'warehouse':_0x56d2e3,'transfer':_0x42a90c,'stock':_0x29289f,'language':_0x35f80f});}catch(_0x475da9){console[_0x16f02e(0x21c)](_0x475da9);}}),router[a0_0x45dab0(0x255)](a0_0x45dab0(0x212),auth,async(_0x1b2ce1,_0x36abd2)=>{var _0x1ec513=a0_0x45dab0;try{const _0x259445=_0x1b2ce1[_0x1ec513(0x254)]['id'],{from_warehouse:_0x322394,FromRoom_name:_0x5193cb,to_warehouse:_0x357995,ToRoom_name:_0x4fb6df}=_0x1b2ce1['body'],_0x5e2841=await transfers[_0x1ec513(0x17c)]({'_id':_0x259445}),_0x2ccb64=_0x5e2841['product'][_0x1ec513(0x1b1)](async _0x55d156=>{var _0x31127e=_0x1ec513;if(_0x55d156['to_quantity']>0x0){var _0x19e802=await warehouse[_0x31127e(0x196)]({'name':_0x5e2841[_0x31127e(0x194)],'room':_0x55d156['from_room_name'],'warehouse_category':_0x31127e(0x180)});const _0x288013=_0x19e802[_0x31127e(0x1bc)]['map'](_0x2dcf90=>{var _0x564301=_0x31127e;_0x2dcf90[_0x564301(0x224)]==_0x55d156[_0x564301(0x224)]&&_0x2dcf90[_0x564301(0x203)]==_0x55d156[_0x564301(0x1b2)]&&_0x2dcf90[_0x564301(0x18b)]==_0x55d156[_0x564301(0x1dd)]&&_0x2dcf90['bin']==_0x55d156[_0x564301(0x258)]&&_0x2dcf90[_0x564301(0x16f)]==_0x55d156[_0x564301(0x21e)]&&_0x2dcf90[_0x564301(0x1cb)]==_0x55d156[_0x564301(0x19d)]&&_0x2dcf90['storage']==_0x55d156['from_storage']&&_0x2dcf90[_0x564301(0x1c1)]==_0x55d156['expiry_date']&&_0x2dcf90[_0x564301(0x250)]==_0x55d156[_0x564301(0x250)]&&_0x2dcf90[_0x564301(0x1fa)]==_0x55d156[_0x564301(0x1fa)]&&_0x2dcf90[_0x564301(0x198)]==_0x55d156[_0x564301(0x206)]&&_0x2dcf90[_0x564301(0x1bf)]==_0x55d156[_0x564301(0x1c2)]&&(_0x2dcf90[_0x564301(0x1b3)]=_0x2dcf90[_0x564301(0x1b3)]-_0x55d156[_0x564301(0x1ce)]);});}return _0x19e802;});Promise[_0x1ec513(0x213)](_0x2ccb64)[_0x1ec513(0x17b)](async _0x23343c=>{var _0x15573b=_0x1ec513;try{for(const _0x2bcc84 of _0x23343c){await _0x2bcc84[_0x15573b(0x1ec)]();}try{const _0x4104fa=_0x5e2841[_0x15573b(0x1e2)]['map'](async _0x349fe8=>{var _0x45f2eb=_0x15573b;if(_0x349fe8[_0x45f2eb(0x1ce)]>0x0){var _0x404734=await warehouse[_0x45f2eb(0x196)]({'name':_0x5e2841[_0x45f2eb(0x239)],'room':_0x349fe8[_0x45f2eb(0x1d8)],'warehouse_category':'Raw\x20Materials'}),_0x53fa5e=0x0;const _0x189f5f=_0x404734['product_details'][_0x45f2eb(0x1b1)](_0x386cf5=>{var _0x5c64ee=_0x45f2eb;_0x386cf5[_0x5c64ee(0x224)]==_0x349fe8[_0x5c64ee(0x224)]&&_0x386cf5[_0x5c64ee(0x203)]==_0x349fe8['to_floorlevel']&&_0x386cf5[_0x5c64ee(0x18b)]==_0x349fe8['to_types']&&_0x386cf5[_0x5c64ee(0x1e0)]==_0x349fe8['to_bin']&&_0x386cf5[_0x5c64ee(0x16f)]==_0x349fe8[_0x5c64ee(0x18c)]&&_0x386cf5['rack']==_0x349fe8['rack']&&_0x386cf5[_0x5c64ee(0x252)]==_0x349fe8[_0x5c64ee(0x252)]&&_0x386cf5[_0x5c64ee(0x1c1)]==_0x349fe8['expiry_date']&&_0x386cf5[_0x5c64ee(0x250)]==_0x349fe8[_0x5c64ee(0x250)]&&_0x386cf5[_0x5c64ee(0x1fa)]==_0x349fe8[_0x5c64ee(0x1fa)]&&_0x386cf5[_0x5c64ee(0x198)]==_0x349fe8[_0x5c64ee(0x246)]&&(_0x386cf5[_0x5c64ee(0x1b3)]=_0x386cf5[_0x5c64ee(0x1b3)]+_0x349fe8['to_quantity'],_0x53fa5e++);});_0x53fa5e=='0'&&(_0x404734[_0x45f2eb(0x1bc)]=_0x404734[_0x45f2eb(0x1bc)][_0x45f2eb(0x1df)]({'product_name':_0x349fe8[_0x45f2eb(0x224)],'product_stock':_0x349fe8[_0x45f2eb(0x1ce)],'bay':_0x349fe8[_0x45f2eb(0x18c)],'bin':_0x349fe8[_0x45f2eb(0x169)],'type':_0x349fe8['to_types'],'floorlevel':_0x349fe8[_0x45f2eb(0x20b)],'storage':_0x349fe8[_0x45f2eb(0x252)],'rack':_0x349fe8['rack'],'product_code':_0x349fe8[_0x45f2eb(0x24d)],'primary_code':_0x349fe8[_0x45f2eb(0x222)],'secondary_code':_0x349fe8['secondary_code'],'maxProducts':_0x349fe8[_0x45f2eb(0x243)],'storage':_0x349fe8[_0x45f2eb(0x252)],'rack':_0x349fe8[_0x45f2eb(0x1cb)],'expiry_date':_0x349fe8[_0x45f2eb(0x1c1)],'maxPerUnit':_0x349fe8[_0x45f2eb(0x189)],'batch_code':_0x349fe8[_0x45f2eb(0x250)],'production_date':_0x349fe8['production_date']}));}return _0x404734;});Promise[_0x15573b(0x213)](_0x4104fa)[_0x15573b(0x17b)](async _0x45ab57=>{var _0x3e8068=_0x15573b;try{for(const _0x3f7b32 of _0x45ab57){await warehouse[_0x3e8068(0x253)]({'_id':_0x3f7b32[_0x3e8068(0x1bf)]},{'$addToSet':{'product_details':{'$each':_0x3f7b32[_0x3e8068(0x1bc)]}}});}_0x5e2841[_0x3e8068(0x183)]='True';const _0xdaec7b=await _0x5e2841[_0x3e8068(0x1ec)](),_0x2959c1=await master_shop[_0x3e8068(0x1d7)](),_0x40dfdc=await email_settings[_0x3e8068(0x196)](),_0x25fcef=await supervisor_settings[_0x3e8068(0x1d7)]();var _0xfc48a8=_0x5e2841['product'],_0x41518a='',_0x5a3f9f;for(_0x5a3f9f in _0xfc48a8){_0x41518a+='<tr>'+_0x3e8068(0x185)+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x224)]+_0x3e8068(0x1a9)+_0x3e8068(0x185)+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x24d)]+_0x3e8068(0x1a9)+_0x3e8068(0x185)+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x1ce)]+'</td>'+_0x3e8068(0x185)+_0xfc48a8[_0x5a3f9f]['unit']+_0x3e8068(0x1a9)+_0x3e8068(0x185)+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x171)]+_0x3e8068(0x1a9)+_0x3e8068(0x185)+_0x5e2841['to_warehouse']+_0x3e8068(0x1a9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x1d8)]+_0x3e8068(0x1a9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x252)]+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x1cb)]+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x18c)]+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x169)]+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x214)][0x0]+_0xfc48a8[_0x5a3f9f][_0x3e8068(0x20b)]+_0x3e8068(0x1a9),'</tr>';}let _0x8ea26c=nodemailer[_0x3e8068(0x21a)]({'host':_0x40dfdc[_0x3e8068(0x18f)],'port':Number(_0x40dfdc[_0x3e8068(0x211)]),'secure':![],'auth':{'user':_0x40dfdc[_0x3e8068(0x1b8)],'pass':_0x40dfdc[_0x3e8068(0x1f9)]}}),_0x7b6b0f={'from':_0x40dfdc[_0x3e8068(0x1b8)],'to':_0x25fcef[0x0][_0x3e8068(0x221)],'subject':_0x3e8068(0x23b),'attachments':[{'filename':_0x3e8068(0x1d1),'path':__dirname+_0x3e8068(0x182)+_0x3e8068(0x21f)+_0x2959c1[0x0][_0x3e8068(0x16b)],'cid':'logo'}],'html':_0x3e8068(0x191)+_0x3e8068(0x23d)+'</head><body>'+_0x3e8068(0x1b4)+_0x3e8068(0x1f0)+_0x3e8068(0x1b4)+_0x3e8068(0x20a)+_0x3e8068(0x1fe)+_0x3e8068(0x1b4)+_0x3e8068(0x17f)+_0x2959c1[0x0][_0x3e8068(0x233)]+_0x3e8068(0x17e)+_0x3e8068(0x1fe)+_0x3e8068(0x1fe)+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3e8068(0x201)+_0x5e2841['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x5e2841[_0x3e8068(0x232)]+'\x20'+_0x3e8068(0x226)+_0x3e8068(0x202)+_0x3e8068(0x1fe)+_0x3e8068(0x1bd)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3e8068(0x1a7)+_0x3e8068(0x22a)+_0x3e8068(0x205)+_0x3e8068(0x19e)+_0x3e8068(0x1e5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3e8068(0x1a2)+_0x3e8068(0x19c)+_0x3e8068(0x1a5)+'</tr>'+_0x3e8068(0x186)+_0x3e8068(0x181)+'\x20'+_0x41518a+'\x20'+_0x3e8068(0x1c9)+_0x3e8068(0x1f4)+_0x3e8068(0x1b4)+_0x3e8068(0x241)+_0x3e8068(0x1c0)+_0x2959c1[0x0]['site_title']+_0x3e8068(0x202)+_0x3e8068(0x1fe)+_0x3e8068(0x1fe)+'</body></html>'};_0x8ea26c['sendMail'](_0x7b6b0f,function(_0xf78af7,_0x14ab1d){var _0x2e1823=_0x3e8068;_0xf78af7?(console[_0x2e1823(0x21c)](_0xf78af7),console[_0x2e1823(0x21c)](_0x2e1823(0x259))):console[_0x2e1823(0x21c)]('Email\x20sent\x20successfully');}),_0x1b2ce1['flash'](_0x3e8068(0x163),'Transfer\x20Finalize\x20Successfully'),_0x36abd2[_0x3e8068(0x192)](_0x3e8068(0x20e)+_0xdaec7b[_0x3e8068(0x1bf)]);}catch(_0x16d67c){console[_0x3e8068(0x219)](_0x16d67c),_0x36abd2[_0x3e8068(0x197)](0x1f4)[_0x3e8068(0x1eb)]({'Perror':_0x3e8068(0x1d4),'message':_0x16d67c[_0x3e8068(0x1ca)]});}})[_0x15573b(0x208)](_0x5294ec=>{var _0x2a8a6a=_0x15573b;console[_0x2a8a6a(0x219)](_0x5294ec),_0x36abd2[_0x2a8a6a(0x197)](0x1f4)['json']({'Perror':_0x2a8a6a(0x216)});});}catch(_0x4ada2c){_0x36abd2['json'](_0x4ada2c);}}catch(_0x2a71ae){console[_0x15573b(0x219)](_0x2a71ae),_0x36abd2[_0x15573b(0x197)](0x1f4)[_0x15573b(0x1eb)]({'Merror':_0x15573b(0x1d4),'Message':_0x2a71ae[_0x15573b(0x1ca)]});}})[_0x1ec513(0x208)](_0x5800bc=>{var _0x2643bd=_0x1ec513;console['error'](_0x5800bc),_0x36abd2[_0x2643bd(0x197)](0x1f4)[_0x2643bd(0x1eb)]({'Merror':_0x2643bd(0x216)});});}catch(_0xe2125c){console['log'](_0xe2125c);}});function BayBinSelected(_0x5dd364,_0x174a87){var _0x4445c7=a0_0x45dab0,_0x3ca76a=[],_0x472d6d=[],_0x1717c9=[],_0x4aafd5=[],_0x2f4186=[],_0x57562f=[];let _0x267790=[];if(_0x5dd364=='DRY\x20STORAGE')switch(_0x174a87){case _0x4445c7(0x170):_0x3ca76a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x472d6d=[0x1,0x2],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=[_0x4445c7(0x1b6),_0x4445c7(0x1d2)],_0x2f4186=['D'],_0x57562f=['A'];break;case _0x4445c7(0x1fc):_0x3ca76a=[0x6,0x5,0x4,0x3,0x2,0x1],_0x472d6d=[0x1,0x2],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=[_0x4445c7(0x1b6),_0x4445c7(0x1d2)],_0x2f4186=['D'],_0x57562f=['B'];break;case _0x4445c7(0x23e):_0x3ca76a=[0x0],_0x472d6d=[0x0],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=[_0x4445c7(0x1d2)],_0x2f4186=['D'],_0x57562f=['S'];break;case'Receiving\x20Area':_0x3ca76a=[0x0],_0x472d6d=[0x0],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1717c9=[_0x4445c7(0x1d2)],_0x2f4186=['D'],_0x57562f=['R'];break;}else{if(_0x5dd364==_0x4445c7(0x217))switch(_0x174a87){case'Rack\x20A':_0x3ca76a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x472d6d=['B','F'],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=[_0x4445c7(0x1b6),_0x4445c7(0x1d2)],_0x2f4186=['C'],_0x57562f=['A'];break;case _0x4445c7(0x1fc):_0x3ca76a=[0x5,0x4,0x3,0x2,0x1],_0x472d6d=['F','B','S'],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=[_0x4445c7(0x1b6),_0x4445c7(0x1d2)],_0x2f4186=['C'],_0x57562f=['B'];break;case _0x4445c7(0x227):_0x3ca76a=[0x1,0x2,0x3,0x4,0x5],_0x472d6d=['B','F','S'],_0x4aafd5=[0x5,0x4,0x3,0x2,0x1],_0x1717c9=[_0x4445c7(0x1b6),'Floor'],_0x2f4186=['C'],_0x57562f=['C'];break;case _0x4445c7(0x1e4):_0x3ca76a=[0x5,0x4,0x3,0x2,0x1],_0x472d6d=['F','B','S'],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=[_0x4445c7(0x1b6),_0x4445c7(0x1d2)],_0x2f4186=['C'],_0x57562f=['D'];break;case _0x4445c7(0x220):_0x3ca76a=[0x4,0x3,0x2,0x1],_0x472d6d=[0x1,0x2],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=[_0x4445c7(0x1b6),_0x4445c7(0x1d2)],_0x2f4186=['C'],_0x57562f=['E'];break;case _0x4445c7(0x245):_0x3ca76a=[0x1,0x2,0x3],_0x472d6d=[0x1,0x2],_0x4aafd5=[0x1,0x2,0x3,0x4,0x5],_0x1717c9=['Level'],_0x2f4186=['C'],_0x57562f=['F'];break;}}return{'levels':_0x3ca76a,'Isle':_0x472d6d,'rack':_0x4aafd5,'type':_0x1717c9,'storage':_0x2f4186,'rak':_0x57562f};}router[a0_0x45dab0(0x215)](a0_0x45dab0(0x256),auth,async(_0x3c7c13,_0x357c25)=>{var _0x40e393=a0_0x45dab0;try{const {username:_0x560727,email:_0x2df9f6,role:_0x139b34}=_0x3c7c13[_0x40e393(0x1f8)],_0x3e434b=_0x3c7c13[_0x40e393(0x1f8)],_0x1588e4=await profile['findOne']({'email':_0x3e434b[_0x40e393(0x1b8)]}),_0x54849d=await master_shop['find'](),_0x3c0463=await transfers[_0x40e393(0x17c)](_0x3c7c13[_0x40e393(0x254)]['id']);let _0x56b37e;if(_0x3e434b[_0x40e393(0x22f)]==_0x40e393(0x18e)){const _0x1e0a3c=await staff[_0x40e393(0x196)]({'email':_0x3e434b[_0x40e393(0x1b8)]});_0x56b37e=await warehouse[_0x40e393(0x166)]([{'$match':{'status':_0x40e393(0x1f6),'name':_0x1e0a3c[_0x40e393(0x1a3)],'warehouse_category':_0x40e393(0x180)}},{'$group':{'_id':_0x40e393(0x1ba),'name':{'$first':'$name'}}}]);}else _0x56b37e=await warehouse['aggregate']([{'$match':{'status':_0x40e393(0x1f6),'warehouse_category':_0x40e393(0x180)}},{'$group':{'_id':_0x40e393(0x1ba),'name':{'$first':_0x40e393(0x1ba)}}}]);const _0x17ebc9=await warehouse[_0x40e393(0x166)]([{'$match':{'name':_0x3c0463['from_warehouse'],'warehouse_category':_0x40e393(0x180)}},{'$unwind':_0x40e393(0x1da)},{'$group':{'_id':_0x40e393(0x1a1),'name':{'$first':_0x40e393(0x1cd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x40e393(0x20c)},'bin':{'$first':_0x40e393(0x190)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x40e393(0x176)},'secondary_code':{'$first':_0x40e393(0x244)},'product_code':{'$first':_0x40e393(0x1e9)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x40e393(0x24c)},'expiry_date':{'$first':_0x40e393(0x178)},'production_date':{'$first':_0x40e393(0x1ad)},'room':{'$first':'$room'}}}]),_0x43a8f5=await product[_0x40e393(0x1d7)]({}),_0x3b9950=BayBinSelected(_0x3c0463[_0x40e393(0x239)],_0x3c0463[_0x40e393(0x1c8)]);if(_0x54849d[0x0][_0x40e393(0x249)]==_0x40e393(0x19a)){var _0x359322=users[_0x40e393(0x20f)];console[_0x40e393(0x21c)](_0x359322);}else{if(_0x54849d[0x0]['language']==_0x40e393(0x18a))var _0x359322=users['Hindi'];else{if(_0x54849d[0x0][_0x40e393(0x249)]==_0x40e393(0x1d3))var _0x359322=users[_0x40e393(0x1d3)];else{if(_0x54849d[0x0]['language']==_0x40e393(0x18d))var _0x359322=users['Spanish'];else{if(_0x54849d[0x0][_0x40e393(0x249)]=='French')var _0x359322=users[_0x40e393(0x19f)];else{if(_0x54849d[0x0][_0x40e393(0x249)]==_0x40e393(0x1ef))var _0x359322=users['Portuguese'];else{if(_0x54849d[0x0][_0x40e393(0x249)]==_0x40e393(0x193))var _0x359322=users[_0x40e393(0x193)];else{if(_0x54849d[0x0][_0x40e393(0x249)]==_0x40e393(0x1e3))var _0x359322=users['Arabic'];}}}}}}}_0x357c25[_0x40e393(0x1e6)]('edit_transfer',{'success':_0x3c7c13['flash'](_0x40e393(0x163)),'errors':_0x3c7c13[_0x40e393(0x238)](_0x40e393(0x1d5)),'role':_0x3e434b,'profile':_0x1588e4,'master_shop':_0x54849d,'warehouse':_0x56b37e,'transfer':_0x3c0463,'stock':_0x17ebc9,'unit':_0x43a8f5,'language':_0x359322});}catch(_0x40371e){console['log'](_0x40371e);}}),router[a0_0x45dab0(0x255)](a0_0x45dab0(0x256),auth,async(_0x57b10a,_0x211967)=>{var _0x232bc5=a0_0x45dab0;try{const _0x232649=_0x57b10a[_0x232bc5(0x254)]['id'],_0x273966=await transfers[_0x232bc5(0x17c)](_0x232649);_0x211967[_0x232bc5(0x1eb)](_0x57b10a[_0x232bc5(0x1dc)]);return;const {date:_0x267d4a,from_warehouse:_0x512219,FromRoom_name:_0x3ca176,to_warehouse:_0x10fade,ToRoom_name:_0x4c86ad,prod_name:_0xee986,from_prod_qty:_0x17e507,from_prod_level:_0x4d65a2,from_prod_isle:_0x4e978a,from_prod_pallet:_0x4db82f,to_prod_qty:_0x4b1232,to_prod_level:_0x4c66a6,to_prod_isle:_0x12e2c5,to_prod_pallet:_0x1b97f1,primary_code:_0xb9ae28,secondary_code:_0x487157,product_code3:_0x1a56fa,note:_0x5350a9,invoice:_0x3c5715,expiry_date:_0x24ffb6}=_0x57b10a[_0x232bc5(0x1dc)];if(typeof _0xee986==_0x232bc5(0x1aa))var _0x131d85=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1b7)]],_0x114505=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x187)]],_0x4d6588=[_0x57b10a[_0x232bc5(0x1dc)]['from_prod_level']],_0xb8883f=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x21d)]],_0x36f2db=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x22e)]],_0x3a8ffc=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1dd)]],_0x525a4b=[_0x57b10a[_0x232bc5(0x1dc)]['to_prod_qty']],_0x3665c7=[_0x57b10a[_0x232bc5(0x1dc)]['to_prod_level']],_0x553b83=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1f7)]],_0x31cd51=[_0x57b10a['body'][_0x232bc5(0x188)]],_0x280a29=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x214)]],_0x90f5eb=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x252)]],_0x37c00f=[_0x57b10a['body'][_0x232bc5(0x22d)]],_0x314319=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x222)]],_0x5972ab=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1a0)]],_0x58a2fd=[_0x57b10a['body']['product_code3']],_0x5e485f=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x199)]],_0xdfa7f4=[_0x57b10a[_0x232bc5(0x1dc)]['unit']],_0x2aed10=[_0x57b10a[_0x232bc5(0x1dc)]['secondary_unit']],_0x59166b=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x250)]],_0x28e2fb=[_0x57b10a[_0x232bc5(0x1dc)]['expiry_date']],_0x59364b=[_0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x175)]],_0x418372=[_0x57b10a[_0x232bc5(0x1dc)]['from_rak']];else var _0x131d85=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1b7)]],_0x90f5eb=[..._0x57b10a[_0x232bc5(0x1dc)]['storage']],_0x37c00f=[..._0x57b10a['body'][_0x232bc5(0x22d)]],_0x3a8ffc=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1dd)]],_0x280a29=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x214)]],_0x114505=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x187)]],_0x4d6588=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x184)]],_0xb8883f=[..._0x57b10a['body']['from_prod_isle']],_0x36f2db=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x22e)]],_0x525a4b=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1ab)]],_0x3665c7=[..._0x57b10a[_0x232bc5(0x1dc)]['to_prod_level']],_0x553b83=[..._0x57b10a['body'][_0x232bc5(0x1f7)]],_0x31cd51=[..._0x57b10a['body'][_0x232bc5(0x188)]],_0x314319=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x222)]],_0x5972ab=[..._0x57b10a['body'][_0x232bc5(0x1a0)]],_0x58a2fd=[..._0x57b10a['body'][_0x232bc5(0x257)]],_0x5e485f=[..._0x57b10a[_0x232bc5(0x1dc)]['MaxStocks_data2']],_0xdfa7f4=[..._0x57b10a[_0x232bc5(0x1dc)]['unit']],_0x2aed10=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x171)]],_0x59166b=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x250)]],_0x28e2fb=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1c1)]],_0x59364b=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x175)]],_0x418372=[..._0x57b10a[_0x232bc5(0x1dc)][_0x232bc5(0x1d6)]];const _0x8da325=_0x131d85[_0x232bc5(0x1b1)](_0x3c601f=>{return _0x3c601f={'product_name':_0x3c601f};});_0x114505[_0x232bc5(0x225)]((_0x1ff1f9,_0x3d351c)=>{var _0x4f8c65=_0x232bc5;_0x8da325[_0x3d351c][_0x4f8c65(0x1a4)]=_0x1ff1f9;}),_0x4d6588[_0x232bc5(0x225)]((_0xfec687,_0x398824)=>{var _0x45ca28=_0x232bc5;_0x8da325[_0x398824][_0x45ca28(0x21e)]=_0xfec687;}),_0xb8883f[_0x232bc5(0x225)]((_0x3c2968,_0x1e62cf)=>{_0x8da325[_0x1e62cf]['from_bin']=_0x3c2968;}),_0x36f2db[_0x232bc5(0x225)]((_0x28f716,_0x187754)=>{_0x8da325[_0x187754]['from_floorlevel']=_0x28f716;}),_0x525a4b['forEach']((_0x3bcdc4,_0x2975a2)=>{var _0x3af17e=_0x232bc5;_0x8da325[_0x2975a2][_0x3af17e(0x1ce)]=_0x3bcdc4;}),_0x3665c7[_0x232bc5(0x225)]((_0x3affef,_0x52e1a7)=>{var _0x482786=_0x232bc5;_0x8da325[_0x52e1a7][_0x482786(0x18c)]=_0x3affef;}),_0x553b83[_0x232bc5(0x225)]((_0x125f53,_0x4308f2)=>{var _0x5ba3b2=_0x232bc5;_0x8da325[_0x4308f2][_0x5ba3b2(0x169)]=_0x125f53;}),_0x31cd51['forEach']((_0xcfc8e5,_0x2e0bcc)=>{var _0x5622a5=_0x232bc5;_0x8da325[_0x2e0bcc][_0x5622a5(0x20b)]=_0xcfc8e5;}),_0x314319['forEach']((_0x22e9ba,_0x3589c9)=>{var _0x8c5555=_0x232bc5;_0x8da325[_0x3589c9][_0x8c5555(0x222)]=_0x22e9ba;}),_0x5972ab[_0x232bc5(0x225)]((_0x521413,_0x4fb4b6)=>{var _0x1c9397=_0x232bc5;_0x8da325[_0x4fb4b6][_0x1c9397(0x1a0)]=_0x521413;}),_0x58a2fd['forEach']((_0x45629f,_0xf87628)=>{var _0x5f24d2=_0x232bc5;_0x8da325[_0xf87628][_0x5f24d2(0x24d)]=_0x45629f;}),_0x5e485f[_0x232bc5(0x225)]((_0x48a352,_0x144e30)=>{var _0xdb341e=_0x232bc5;_0x8da325[_0x144e30][_0xdb341e(0x243)]=_0x48a352;}),_0xdfa7f4['forEach']((_0x182da2,_0x4010ad)=>{_0x8da325[_0x4010ad]['unit']=_0x182da2;}),_0x2aed10['forEach']((_0x4bf16c,_0x310a2b)=>{var _0x25e522=_0x232bc5;_0x8da325[_0x310a2b][_0x25e522(0x171)]=_0x4bf16c;}),_0x59166b[_0x232bc5(0x225)]((_0x4e4cf7,_0x47fc99)=>{_0x8da325[_0x47fc99]['batch_code']=_0x4e4cf7;}),_0x28e2fb['forEach']((_0x5c97b7,_0x25d056)=>{var _0x1e4ae0=_0x232bc5;_0x8da325[_0x25d056][_0x1e4ae0(0x1c1)]=_0x5c97b7;}),_0x90f5eb[_0x232bc5(0x225)]((_0x5c1ee0,_0x244f8e)=>{var _0xe2bdcc=_0x232bc5;_0x8da325[_0x244f8e][_0xe2bdcc(0x252)]=_0x5c1ee0;}),_0x37c00f[_0x232bc5(0x225)]((_0xae24a1,_0x3bb2ef)=>{var _0x30576e=_0x232bc5;_0x8da325[_0x3bb2ef][_0x30576e(0x1cb)]=_0xae24a1;}),_0x3a8ffc[_0x232bc5(0x225)]((_0x288020,_0x4c099d)=>{var _0x25f46c=_0x232bc5;_0x8da325[_0x4c099d][_0x25f46c(0x1dd)]=_0x288020;}),_0x280a29[_0x232bc5(0x225)]((_0x21a1bc,_0x48de49)=>{var _0x1610ee=_0x232bc5;_0x8da325[_0x48de49][_0x1610ee(0x214)]=_0x21a1bc;}),_0x59364b[_0x232bc5(0x225)]((_0x21a107,_0x13382e)=>{var _0x3e8173=_0x232bc5;_0x8da325[_0x13382e][_0x3e8173(0x175)]=_0x21a107;}),_0x418372[_0x232bc5(0x225)]((_0x20c3ba,_0x475cb8)=>{var _0x43b0f4=_0x232bc5;_0x8da325[_0x475cb8][_0x43b0f4(0x19d)]=_0x20c3ba;});const _0x2b8dd5=_0x8da325[_0x232bc5(0x1b0)](_0x20e828=>_0x20e828[_0x232bc5(0x1ce)]!=='0'&&_0x20e828[_0x232bc5(0x1ce)]!==''||_0x20e828['to_floorlevel']!=='0'&&_0x20e828[_0x232bc5(0x20b)]!=='');var _0x3dd6f6=0x0;_0x2b8dd5[_0x232bc5(0x225)](_0x3c8ed2=>{var _0x360257=_0x232bc5;parseInt(_0x3c8ed2[_0x360257(0x1a4)])<parseInt(_0x3c8ed2[_0x360257(0x1ce)])&&_0x3dd6f6++;});if(_0x3dd6f6!=0x0)return _0x57b10a[_0x232bc5(0x238)]('errors',_0x232bc5(0x22c)),_0x211967['redirect']('back');const _0xc15e3d=await warehouse['findOne']({'name':_0x273966[_0x232bc5(0x194)],'room':_0x273966[_0x232bc5(0x22b)]});_0x273966[_0x232bc5(0x1e2)]['forEach'](_0x5388bc=>{var _0x1884a8=_0x232bc5;if(_0x5388bc['to_quantity']>0x0){const _0x289c30=_0xc15e3d['product_details'][_0x1884a8(0x1b1)](_0x576bb4=>{var _0x4947b4=_0x1884a8;_0x576bb4[_0x4947b4(0x224)]==_0x5388bc[_0x4947b4(0x224)]&&_0x576bb4[_0x4947b4(0x203)]==_0x5388bc[_0x4947b4(0x1b2)]&&_0x576bb4[_0x4947b4(0x18b)]==_0x5388bc[_0x4947b4(0x1dd)]&&_0x576bb4[_0x4947b4(0x1e0)]==_0x5388bc['from_bin']&&_0x576bb4[_0x4947b4(0x16f)]==_0x5388bc[_0x4947b4(0x21e)]&&_0x576bb4[_0x4947b4(0x1cb)]==_0x5388bc['from_rack']&&_0x576bb4['storage']==_0x5388bc['from_storage']&&(_0x576bb4['product_stock']=parseInt(_0x576bb4[_0x4947b4(0x1b3)])+parseInt(_0x5388bc[_0x4947b4(0x1ce)]));});}}),await _0xc15e3d[_0x232bc5(0x1ec)]();const _0x13ffd8=await warehouse[_0x232bc5(0x196)]({'name':_0x273966[_0x232bc5(0x239)],'room':_0x273966[_0x232bc5(0x1c8)]});_0x273966[_0x232bc5(0x1e2)][_0x232bc5(0x225)](_0x2ca3f5=>{var _0x5d6bea=_0x232bc5;if(_0x2ca3f5[_0x5d6bea(0x1ce)]>0x0){const _0x38613c=_0x13ffd8[_0x5d6bea(0x1bc)]['map'](_0x42ea62=>{var _0x2e1c2a=_0x5d6bea;_0x42ea62[_0x2e1c2a(0x224)]==_0x2ca3f5[_0x2e1c2a(0x224)]&&_0x42ea62[_0x2e1c2a(0x203)]==_0x2ca3f5[_0x2e1c2a(0x20b)]&&_0x42ea62[_0x2e1c2a(0x18b)]==_0x2ca3f5[_0x2e1c2a(0x214)]&&_0x42ea62['bin']==_0x2ca3f5['to_bin']&&_0x42ea62[_0x2e1c2a(0x16f)]==_0x2ca3f5['to_bay']&&_0x42ea62[_0x2e1c2a(0x1cb)]==_0x2ca3f5['rack']&&_0x42ea62[_0x2e1c2a(0x252)]==_0x2ca3f5[_0x2e1c2a(0x252)]&&(_0x42ea62[_0x2e1c2a(0x1b3)]=parseInt(_0x42ea62[_0x2e1c2a(0x1b3)])-parseInt(_0x2ca3f5['to_quantity']));});}}),await _0x13ffd8['save'](),_0x273966[_0x232bc5(0x232)]=_0x267d4a,_0x273966['from_warehouse']=_0x512219,_0x273966[_0x232bc5(0x239)]=_0x10fade,_0x273966[_0x232bc5(0x1e2)]=_0x2b8dd5,_0x273966[_0x232bc5(0x1f2)]=_0x5350a9,_0x273966[_0x232bc5(0x198)]=_0x3c5715;const _0x6ec9ae=await _0x273966[_0x232bc5(0x1ec)]();console[_0x232bc5(0x21c)](_0x6ec9ae);const _0x152d9f=await warehouse[_0x232bc5(0x196)]({'name':_0x512219,'room':_0x3ca176});_0x6ec9ae[_0x232bc5(0x1e2)]['forEach'](_0x32d5af=>{var _0x381513=_0x232bc5;if(_0x32d5af[_0x381513(0x1ce)]>0x0){const _0x39a436=_0x152d9f[_0x381513(0x1bc)]['map'](_0x370001=>{var _0x38647e=_0x381513;_0x370001[_0x38647e(0x224)]==_0x32d5af[_0x38647e(0x224)]&&_0x370001[_0x38647e(0x203)]==_0x32d5af[_0x38647e(0x1b2)]&&_0x370001['type']==_0x32d5af[_0x38647e(0x1dd)]&&_0x370001['bin']==_0x32d5af['from_bin']&&_0x370001[_0x38647e(0x16f)]==_0x32d5af['from_bay']&&_0x370001[_0x38647e(0x1cb)]==_0x32d5af[_0x38647e(0x19d)]&&_0x370001['storage']==_0x32d5af[_0x38647e(0x175)]&&(_0x370001['product_stock']=parseInt(_0x370001['product_stock'])-parseInt(_0x32d5af[_0x38647e(0x1ce)]));});}}),await _0x152d9f[_0x232bc5(0x1ec)]();const _0xd836fa=await warehouse[_0x232bc5(0x196)]({'name':_0x10fade,'room':_0x4c86ad});_0x6ec9ae[_0x232bc5(0x1e2)][_0x232bc5(0x225)](_0x2abfe4=>{var _0x367762=_0x232bc5;if(_0x2abfe4[_0x367762(0x1ce)]>0x0){var _0x34ff47=0x0;const _0x53271e=_0xd836fa[_0x367762(0x1bc)][_0x367762(0x1b1)](_0x5b6e6c=>{var _0x38aa12=_0x367762;_0x5b6e6c[_0x38aa12(0x224)]==_0x2abfe4[_0x38aa12(0x224)]&&_0x5b6e6c[_0x38aa12(0x203)]==_0x2abfe4['to_floorlevel']&&_0x5b6e6c[_0x38aa12(0x18b)]==_0x2abfe4[_0x38aa12(0x214)]&&_0x5b6e6c['bin']==_0x2abfe4[_0x38aa12(0x169)]&&_0x5b6e6c['bay']==_0x2abfe4[_0x38aa12(0x18c)]&&_0x5b6e6c['rack']==_0x2abfe4['rack']&&_0x5b6e6c[_0x38aa12(0x252)]==_0x2abfe4[_0x38aa12(0x252)]&&(_0x5b6e6c[_0x38aa12(0x1b3)]=parseInt(_0x5b6e6c[_0x38aa12(0x1b3)])+parseInt(_0x2abfe4['to_quantity']),_0x34ff47++);});_0x34ff47=='0'&&(_0xd836fa[_0x367762(0x1bc)]=_0xd836fa[_0x367762(0x1bc)][_0x367762(0x1df)]({'product_name':_0x2abfe4[_0x367762(0x224)],'product_stock':_0x2abfe4[_0x367762(0x1ce)],'bay':_0x2abfe4[_0x367762(0x18c)],'bin':_0x2abfe4[_0x367762(0x169)],'type':_0x2abfe4['to_types'],'floorlevel':_0x2abfe4[_0x367762(0x20b)],'storage':_0x2abfe4[_0x367762(0x252)],'rack':_0x2abfe4[_0x367762(0x1cb)],'product_code':_0x2abfe4['product_code'],'primary_code':_0x2abfe4[_0x367762(0x222)],'secondary_code':_0x2abfe4[_0x367762(0x1a0)],'maxProducts':_0x2abfe4[_0x367762(0x243)],'storage':_0x2abfe4['storage'],'rack':_0x2abfe4['rack']}));}}),await _0xd836fa['save'](),_0x57b10a['flash']('success',_0x232bc5(0x229)),_0x211967['redirect'](_0x232bc5(0x1c4));}catch(_0x225cbb){console[_0x232bc5(0x21c)](_0x225cbb);}}),router['post'](a0_0x45dab0(0x228),async(_0x36db47,_0x4832de)=>{var _0x1bd8de=a0_0x45dab0;const {FromWareHouse:_0x2fa8dc,FromRoom:_0x3b2719,ToWarehouse:_0x52e5ab,ToRoom:_0x37605f,primary_code:_0x5ea36b,Roomslist:_0x2e6797}=_0x36db47['body'],_0x1cb635=_0x2e6797[_0x1bd8de(0x17a)](','),_0x9abccf=[];async function _0x434e4d(_0xbd73db){var _0x2bf7af=_0x1bd8de;const _0x2a5d5b=await warehouse[_0x2bf7af(0x166)]([{'$match':{'name':_0x2fa8dc,'room':_0xbd73db}},{'$unwind':_0x2bf7af(0x1da)},{'$match':{'product_details.primary_code':_0x5ea36b}},{'$group':{'_id':_0x2bf7af(0x1a1),'name':{'$first':_0x2bf7af(0x1cd)},'instock':{'$first':_0x2bf7af(0x1a6)},'primary_code':{'$first':_0x2bf7af(0x176)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2bf7af(0x1e9)},'level':{'$first':_0x2bf7af(0x20c)},'isle':{'$first':_0x2bf7af(0x190)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2bf7af(0x23a)},'unit':{'$first':_0x2bf7af(0x1a8)},'secondary_unit':{'$first':_0x2bf7af(0x207)},'storage':{'$first':_0x2bf7af(0x1ae)},'rack':{'$first':_0x2bf7af(0x24c)},'expiry_date':{'$first':_0x2bf7af(0x178)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2bf7af(0x20d)},'maxPerUnit':{'$first':_0x2bf7af(0x1f3)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x2bf7af(0x242)},'invoice_product':{'$first':_0x2bf7af(0x195)}}}]),_0x15c08d=await warehouse[_0x2bf7af(0x166)]([{'$match':{'name':_0x2fa8dc,'room':_0xbd73db}},{'$unwind':_0x2bf7af(0x1da)},{'$match':{'product_details.secondary_code':_0x5ea36b}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2bf7af(0x176)},'secondary_code':{'$first':_0x2bf7af(0x244)},'product_code':{'$first':_0x2bf7af(0x1e9)},'level':{'$first':_0x2bf7af(0x20c)},'isle':{'$first':_0x2bf7af(0x190)},'type':{'$first':_0x2bf7af(0x230)},'pallet':{'$first':_0x2bf7af(0x23a)},'unit':{'$first':_0x2bf7af(0x1a8)},'secondary_unit':{'$first':_0x2bf7af(0x207)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2bf7af(0x24c)},'expiry_date':{'$first':_0x2bf7af(0x178)},'production_date':{'$first':_0x2bf7af(0x1ad)},'batch_code':{'$first':_0x2bf7af(0x20d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x2a5d5b['length']>0x0)_0x9abccf[_0x2bf7af(0x1e1)](_0x2a5d5b);else _0x15c08d[_0x2bf7af(0x1cf)]>0x0&&_0x9abccf[_0x2bf7af(0x1e1)](_0x15c08d);}const _0x2fca39=_0x1cb635[_0x1bd8de(0x1b1)](_0x3e5d72=>_0x434e4d(_0x3e5d72));await Promise[_0x1bd8de(0x213)](_0x2fca39),_0x4832de[_0x1bd8de(0x1eb)](_0x9abccf);}),router['post'](a0_0x45dab0(0x172),async(_0x48287a,_0xd7af12)=>{var _0x167be4=a0_0x45dab0;try{const {FromWareHouse:_0xd156c4,FromRoom:_0x55b300,ToWarehouse:_0x5a5f19,ToRoom:_0x1343d3,secondary_code:_0x16f21f}=_0x48287a[_0x167be4(0x1dc)],_0x24b8c0=await warehouse[_0x167be4(0x166)]([{'$match':{'name':_0xd156c4}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x16f21f}},{'$group':{'_id':_0x167be4(0x1a1),'name':{'$first':_0x167be4(0x1cd)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x167be4(0x244)},'product_code':{'$first':_0x167be4(0x1e9)},'instock':{'$first':_0x167be4(0x1a6)},'warehouse':{'$first':_0x167be4(0x1ba)},'level':{'$first':_0x167be4(0x200)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x167be4(0x1e7)},'maxProducts':{'$first':_0x167be4(0x242)},'unit':{'$first':_0x167be4(0x1a8)}}}]);_0xd7af12[_0x167be4(0x197)](0xc8)[_0x167be4(0x1eb)](_0x24b8c0);}catch(_0x3ea15c){_0xd7af12['status'](0x194)[_0x167be4(0x1eb)]({'message':_0x3ea15c[_0x167be4(0x1ca)]});}}),router[a0_0x45dab0(0x255)]('/barcode_scanner3',async(_0x7c4c7e,_0xcf6ba0)=>{var _0x3c8c25=a0_0x45dab0;try{const {FromWareHouse:_0x2267ee,FromRoom:_0x1762c2,ToWarehouse:_0x1d6227,ToRoom:_0x33423a,product_code:_0x434263}=_0x7c4c7e[_0x3c8c25(0x1dc)],_0x3e2bd4=await warehouse[_0x3c8c25(0x166)]([{'$match':{'name':_0x2267ee}},{'$unwind':_0x3c8c25(0x1da)},{'$match':{'product_details.product_code':_0x434263}},{'$group':{'_id':_0x3c8c25(0x1a1),'name':{'$first':_0x3c8c25(0x1cd)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3c8c25(0x244)},'product_code':{'$first':_0x3c8c25(0x1e9)},'instock':{'$first':_0x3c8c25(0x1a6)},'warehouse':{'$first':'$name'},'level':{'$first':_0x3c8c25(0x200)},'isle':{'$first':_0x3c8c25(0x1fd)},'pallet':{'$first':_0x3c8c25(0x1e7)},'maxProducts':{'$first':_0x3c8c25(0x242)},'unit':{'$first':'$product_details.unit'}}}]);_0xcf6ba0[_0x3c8c25(0x197)](0xc8)[_0x3c8c25(0x1eb)](_0x3e2bd4);}catch(_0x3f3848){_0xcf6ba0[_0x3c8c25(0x197)](0x194)[_0x3c8c25(0x1eb)]({'message':_0x3f3848[_0x3c8c25(0x1ca)]});}}),router['post'](a0_0x45dab0(0x168),async(_0x1242ce,_0xdc90d3)=>{var _0x52ecc8=a0_0x45dab0;const {level:_0x13e6e5,isle:_0x1d436d,pallet:_0x50eda4,warehouses:_0x472660,room:_0x229e08}=_0x1242ce[_0x52ecc8(0x1dc)];try{const _0x3b3dd7=await warehouse[_0x52ecc8(0x166)]([{'$match':{'name':_0x472660,'room':_0x229e08}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x13e6e5),'product_details.isle':_0x1d436d,'product_details.pallet':parseInt(_0x50eda4)}},{'$group':{'_id':_0x52ecc8(0x1a1),'name':{'$first':_0x52ecc8(0x1cd)},'product_stock':{'$first':_0x52ecc8(0x1a6)},'level':{'$first':_0x52ecc8(0x200)},'isle':{'$first':_0x52ecc8(0x1fd)},'pallet':{'$first':_0x52ecc8(0x1e7)},'maxProducts':{'$first':_0x52ecc8(0x242)}}}]);_0xdc90d3[_0x52ecc8(0x197)](0xc8)['json'](_0x3b3dd7);}catch(_0x303c3e){_0xdc90d3[_0x52ecc8(0x197)](0x194)['json']({'message':_0x303c3e[_0x52ecc8(0x1ca)]});}}),module[a0_0x45dab0(0x174)]=router;