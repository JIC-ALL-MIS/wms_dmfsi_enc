var a0_0x2f7cdc=a0_0x5992;(function(_0x321bf4,_0x2d6a40){var _0x35fa8e=a0_0x5992,_0x76e80e=_0x321bf4();while(!![]){try{var _0xcf20ef=parseInt(_0x35fa8e(0xd5))/0x1+-parseInt(_0x35fa8e(0x7c))/0x2+-parseInt(_0x35fa8e(0x7b))/0x3*(-parseInt(_0x35fa8e(0xd0))/0x4)+-parseInt(_0x35fa8e(0xcb))/0x5+parseInt(_0x35fa8e(0xea))/0x6*(parseInt(_0x35fa8e(0xdb))/0x7)+-parseInt(_0x35fa8e(0x15a))/0x8+parseInt(_0x35fa8e(0xba))/0x9;if(_0xcf20ef===_0x2d6a40)break;else _0x76e80e['push'](_0x76e80e['shift']());}catch(_0x584b47){_0x76e80e['push'](_0x76e80e['shift']());}}}(a0_0x58d7,0x4e3cd));const express=require(a0_0x2f7cdc(0x86)),app=express(),router=express[a0_0x2f7cdc(0x83)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x2f7cdc(0x9f)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');function a0_0x58d7(){var _0x451786=['forEach','Enabled','ToRoomAssigned','Return\x20Rooms','</span>','$product_details.level','Product\x20Transfer\x20successfully','$product_details.unit','length','Portuguese\x20(BR)','/upload/','json','primary_unit','exports','</table>','from_prod_qty','<table\x20style=\x22width:\x20100%\x20!important;\x22>','from_bay','Arabic\x20(ae)','$from_warehouse','from_prod_pallet','1452447vcemzZ','from_types','params','to_prod_qty','log','</body></html>','language','post','Rack\x20B','batch_code','$product.to_room_name','English\x20(US)','render','invoice','updateOne','findOne','</tbody>','1700155FQyJQn','Spanish','$product.from_room_name','to_bay','$date','1356vAztLL','Transfer\x20Finalize\x20Successfully','add_transfer','Portuguese','edit_transfer','419917TuyDwV','from_storage','$product_details.bin','</thead>','bay','$product_details.maxProducts','7TlwyfO','/barcode_scanner2','True','/picking_list/PDF_transfer_rm/','transfer','image','$_id','$product_details','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','sendMail','$product_details.maxPerUnit','Receiving\x20Area','primary_code','to_room_name','slice','2336850mVXSAb','to_warehouse','$product_details.rack','$product_details.primary_code','$product_details.storage','id_transaction_id','/barcode_scanner','all','secondary_code','<h5>','Arabic','storage','<div>','maxperunit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','secondary_unit','MaxStocks_data2','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','date','split','German','$product_details.isle','production_date','body','password','to_room','string','</h5>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','DRY\x20STORAGE','redirect','random','<tr>','Ambient','from_rak','$product','max_per_unit','Transfer\x20Edit\x20Successfully','bin','id_transaction','to_prod_level','filter','/transfer/view','</head><body>','from_prod_level','$product_details.product_code','site_title','to_prod_isle','$to_warehouse','$product_details.bay','rak','$product_details.secondary_unit','from_room','</div>','floor','success','$product_details.floorlevel','get','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','_id','An\x20error\x20occurred\x20while\x20saving\x20data.','product_code3','here','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<tbody\x20style=\x22text-align:\x20center;\x22>','then','$product_details._id','Rack\x20E','$product_details.invoice','$product_details.type','flash','prod_cat','</tr>','padStart','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','message','user','Rack\x20F','findById','English','from_bin','Enclosed','Email\x20sent\x20successfully','TRF-','/CheckingWarehouse','\x20Order\x20Date\x20:\x20','edit_transfer_view','type','from_invoice','<h5\x20style=\x22text-align:\x20left;\x22>','errors','status','$finalize','expiry_date','product_details','to_prod_pallet','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','maxProducts','from_floorlevel','Hindi','$product_details.product_stock','<span\x20style=\x22float:\x20right;\x22>','error','prod_name','/preview/:id','warehouse','product_stock','<html><head><title></title>','master','$isAllowEdit','RMSEmail','/../public','3943048ajcfJY','map','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','product','Rack\x20A','Floor','</td>','from_warehouse','French','staff','$product_details.product_name','Rack\x20D','find','email','$product_details.batch_code','RoomAssigned','New_Qty_Converted','rack','$product_details.secondary_code','3048txoTwv','323652TaXEAv','product_name','Logo.png','back','concat','$name','from_room_name','Router','\x20Order\x20Number\x20:\x20','from_prod_isle','express','An\x20error\x20occurred.','from_rack','\x20<>\x20','$product_details.pallet','to_floorlevel','to_types','catch','$invoice','$room','Shelves','Chinese','note','floorlevel','To_invoice','Rack\x20C','Raw\x20Materials','role','aggregate','$product_details.production_date','Level','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.expiry_date','push','../middleware/auth','unit','save','to_quantity','from_quantity','to_bin'];a0_0x58d7=function(){return _0x451786;};return a0_0x58d7();}router[a0_0x2f7cdc(0x123)]('/view',auth,async(_0x2632ff,_0x47e446)=>{var _0x5ed1b3=a0_0x2f7cdc;try{const {username:_0x377e62,email:_0x3d0e0e,role:_0x30864d}=_0x2632ff[_0x5ed1b3(0x136)],_0x31e8a3=_0x2632ff[_0x5ed1b3(0x136)],_0x48e2a5=await profile['findOne']({'email':_0x31e8a3[_0x5ed1b3(0x75)]}),_0x1d9db8=await master_shop[_0x5ed1b3(0x74)]();console['log']('master',_0x1d9db8);let _0x3df638;if(_0x31e8a3[_0x5ed1b3(0x97)]==_0x5ed1b3(0x71)){const _0x2772ef=await staff[_0x5ed1b3(0xc9)]({'email':_0x31e8a3[_0x5ed1b3(0x75)]});_0x3df638=await transfers[_0x5ed1b3(0x74)]({'from_warehouse':_0x2772ef['warehouse']});}else _0x3df638=await transfers[_0x5ed1b3(0x98)]([{'$unwind':_0x5ed1b3(0x10d)},{'$group':{'_id':_0x5ed1b3(0xe1),'invoice':{'$first':_0x5ed1b3(0x8e)},'date':{'$first':_0x5ed1b3(0xcf)},'from_warehouse':{'$first':_0x5ed1b3(0xb8)},'to_warehouse':{'$first':_0x5ed1b3(0x11a)},'from_room_name':{'$addToSet':_0x5ed1b3(0xcd)},'to_room_name':{'$addToSet':_0x5ed1b3(0xc4)},'finalize':{'$first':_0x5ed1b3(0x146)},'isAllowEdit':{'$first':_0x5ed1b3(0x157)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1d9db8[0x0]['language']==_0x5ed1b3(0xc5)){var _0x479c27=users[_0x5ed1b3(0x139)];console[_0x5ed1b3(0xbe)](_0x479c27);}else{if(_0x1d9db8[0x0]['language']==_0x5ed1b3(0x14d))var _0x479c27=users[_0x5ed1b3(0x14d)];else{if(_0x1d9db8[0x0]['language']=='German')var _0x479c27=users[_0x5ed1b3(0xfe)];else{if(_0x1d9db8[0x0]['language']==_0x5ed1b3(0xcc))var _0x479c27=users[_0x5ed1b3(0xcc)];else{if(_0x1d9db8[0x0]['language']==_0x5ed1b3(0x70))var _0x479c27=users['French'];else{if(_0x1d9db8[0x0][_0x5ed1b3(0xc0)]==_0x5ed1b3(0xae))var _0x479c27=users['Portuguese'];else{if(_0x1d9db8[0x0][_0x5ed1b3(0xc0)]==_0x5ed1b3(0x91))var _0x479c27=users[_0x5ed1b3(0x91)];else{if(_0x1d9db8[0x0][_0x5ed1b3(0xc0)]==_0x5ed1b3(0xb7))var _0x479c27=users[_0x5ed1b3(0xf4)];}}}}}}}_0x47e446[_0x5ed1b3(0xc6)](_0x5ed1b3(0xdf),{'success':_0x2632ff['flash'](_0x5ed1b3(0x121)),'errors':_0x2632ff[_0x5ed1b3(0x130)](_0x5ed1b3(0x144)),'role':_0x31e8a3,'profile':_0x48e2a5,'master_shop':_0x1d9db8,'transfer':_0x3df638,'language':_0x479c27});}catch(_0x5053ed){console[_0x5ed1b3(0xbe)](_0x5053ed);}});async function getRandom8DigitNumber(){var _0x48ac6a=a0_0x2f7cdc;const _0x17cd81=0x989680,_0x4586b9=0x5f5e0ff,_0x5ded8c=Math[_0x48ac6a(0x120)](Math[_0x48ac6a(0x109)]()*(_0x4586b9-_0x17cd81+0x1))+_0x17cd81;var _0xb3f963;const _0x3a214b=await transfers[_0x48ac6a(0xc9)]({'invoice':_0x48ac6a(0x13d)+_0x5ded8c});return _0x3a214b&&_0x3a214b[_0x48ac6a(0xad)]>0x0?_0xb3f963=_0x48ac6a(0x13d)+_0x5ded8c:_0xb3f963=_0x48ac6a(0x13d)+_0x5ded8c,_0xb3f963;}router[a0_0x2f7cdc(0x123)]('/view/add_transfer',auth,async(_0x12cbcf,_0x422669)=>{var _0x43e6d9=a0_0x2f7cdc;try{const {username:_0x31eda2,email:_0x447fd3,role:_0x3c467f}=_0x12cbcf['user'],_0x44d918=_0x12cbcf[_0x43e6d9(0x136)],_0x2448fc=await profile['findOne']({'email':_0x44d918['email']}),_0x4c1524=await master_shop['find']();console[_0x43e6d9(0xbe)]('master',_0x4c1524);let _0x27c20e;if(_0x44d918[_0x43e6d9(0x97)]==_0x43e6d9(0x71)){const _0x1dce07=await staff[_0x43e6d9(0xc9)]({'email':_0x44d918[_0x43e6d9(0x75)]});_0x27c20e=await warehouse[_0x43e6d9(0x98)]([{'$match':{'status':'Enabled','name':_0x1dce07[_0x43e6d9(0x153)],'warehouse_category':_0x43e6d9(0x96)}},{'$group':{'_id':_0x43e6d9(0x81),'name':{'$first':_0x43e6d9(0x81)}}}]);}else _0x27c20e=await warehouse[_0x43e6d9(0x98)]([{'$match':{'status':'Enabled','warehouse_category':_0x43e6d9(0x96)}},{'$group':{'_id':_0x43e6d9(0x81),'name':{'$first':_0x43e6d9(0x81)}}}]);var _0x317184=[_0x43e6d9(0x10b),_0x43e6d9(0x13b),_0x43e6d9(0xa8)];const _0x32ac38=await transfers[_0x43e6d9(0x74)]({}),_0x4e4760=_0x32ac38['length']+0x1,_0x4c151a=_0x43e6d9(0x13d)+_0x4e4760['toString']()[_0x43e6d9(0x133)](0x5,'0');if(_0x4c1524[0x0][_0x43e6d9(0xc0)]==_0x43e6d9(0xc5)){var _0x39af95=users[_0x43e6d9(0x139)];console[_0x43e6d9(0xbe)](_0x39af95);}else{if(_0x4c1524[0x0][_0x43e6d9(0xc0)]==_0x43e6d9(0x14d))var _0x39af95=users['Hindi'];else{if(_0x4c1524[0x0][_0x43e6d9(0xc0)]=='German')var _0x39af95=users[_0x43e6d9(0xfe)];else{if(_0x4c1524[0x0][_0x43e6d9(0xc0)]==_0x43e6d9(0xcc))var _0x39af95=users['Spanish'];else{if(_0x4c1524[0x0][_0x43e6d9(0xc0)]==_0x43e6d9(0x70))var _0x39af95=users['French'];else{if(_0x4c1524[0x0][_0x43e6d9(0xc0)]==_0x43e6d9(0xae))var _0x39af95=users[_0x43e6d9(0xd3)];else{if(_0x4c1524[0x0][_0x43e6d9(0xc0)]==_0x43e6d9(0x91))var _0x39af95=users[_0x43e6d9(0x91)];else{if(_0x4c1524[0x0][_0x43e6d9(0xc0)]==_0x43e6d9(0xb7))var _0x39af95=users[_0x43e6d9(0xf4)];}}}}}}}const _0x384162=getRandom8DigitNumber();_0x384162['then'](_0x2c12d8=>{var _0x20d7f0=_0x43e6d9;_0x422669[_0x20d7f0(0xc6)](_0x20d7f0(0xd2),{'success':_0x12cbcf['flash']('success'),'errors':_0x12cbcf['flash'](_0x20d7f0(0x144)),'role':_0x44d918,'profile':_0x2448fc,'master_shop':_0x4c1524,'warehouse':_0x27c20e,'language':_0x39af95,'rooms_data':_0x317184,'invoice':_0x2c12d8});})[_0x43e6d9(0x8d)](_0x4ff5c2=>{var _0x94c4af=_0x43e6d9;_0x12cbcf[_0x94c4af(0x130)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x422669[_0x94c4af(0x108)](_0x94c4af(0x114));});}catch(_0x1e626d){console[_0x43e6d9(0xbe)](_0x1e626d);}}),router['post']('/view/add_transfer',auth,async(_0x3463ee,_0x52b150)=>{var _0x5dc481=a0_0x2f7cdc;try{console[_0x5dc481(0xbe)](_0x3463ee[_0x5dc481(0x101)]);const {date:_0x1878ef,from_warehouse:_0x2bc0d9,FromRoom_name:_0x4e04a0,to_warehouse:_0x315a70,ToRoom_name:_0x51c36e,prod_name:_0x3e47f0,from_prod_qty:_0x24c3b9,from_prod_level:_0x8d61ae,from_prod_isle:_0x12e01c,from_prod_pallet:_0x59cf60,to_prod_qty:_0x5c9972,to_prod_level:_0x38168c,to_prod_isle:_0x2bb0d9,to_prod_pallet:_0x405487,primary_code:_0x339d81,secondary_code:_0x3d39ac,product_code3:_0x4a0b65,note:_0x202ae2,MaxStocks_data2:_0x4353d8,invoice:_0xc3d974,expiry_date:_0x17c5c0}=_0x3463ee[_0x5dc481(0x101)];if(typeof _0x3e47f0==_0x5dc481(0x104))var _0x2f7285=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x151)]],_0x2b8a57=[_0x3463ee['body'][_0x5dc481(0xb4)]],_0x3d01a2=[_0x3463ee['body'][_0x5dc481(0x116)]],_0xe79614=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x78)]],_0x4bc513=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x112)]],_0x2eafe3=[_0x3463ee[_0x5dc481(0x101)]['primary_code']],_0x5d9466=[_0x3463ee[_0x5dc481(0x101)]['secondary_code']],_0x2e96f8=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x127)]],_0x1d897b=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xfa)]],_0x4074e3=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xb1)]],_0x57689f=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xf9)]],_0x1955e3=[_0x3463ee[_0x5dc481(0x101)]['batch_code']],_0x4c9d46=[_0x3463ee['body']['expiry_date']],_0x134196=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x10e)]],_0x2c7138=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x100)]],_0x21cb6c=[_0x3463ee[_0x5dc481(0x101)]['prod_cat']],_0x48d7da=[_0x3463ee['body'][_0x5dc481(0x77)]],_0x1d05eb=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xa7)]],_0x21e18a=[_0x3463ee['body'][_0x5dc481(0x142)]],_0x4bc9f7=[_0x3463ee[_0x5dc481(0x101)]['to_invoice']],_0x23cc42=[_0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x111)]];else var _0x2f7285=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x151)]],_0x2b8a57=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xb4)]],_0x3d01a2=[..._0x3463ee['body'][_0x5dc481(0x116)]],_0xe79614=[..._0x3463ee[_0x5dc481(0x101)]['New_Qty_Converted']],_0x4bc513=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x112)]],_0x2eafe3=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xe7)]],_0x5d9466=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xf2)]],_0x2e96f8=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x127)]],_0x1d897b=[..._0x3463ee['body']['MaxStocks_data2']],_0x4074e3=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xb1)]],_0x57689f=[..._0x3463ee['body'][_0x5dc481(0xf9)]],_0x1955e3=[..._0x3463ee[_0x5dc481(0x101)]['batch_code']],_0x4c9d46=[..._0x3463ee[_0x5dc481(0x101)]['expiry_date']],_0x134196=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x10e)]],_0x2c7138=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x100)]],_0x21cb6c=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x131)]],_0x48d7da=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x77)]],_0x1d05eb=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0xa7)]],_0x21e18a=[..._0x3463ee[_0x5dc481(0x101)][_0x5dc481(0x142)]],_0x4bc9f7=[..._0x3463ee['body']['to_invoice']],_0x23cc42=[..._0x3463ee['body'][_0x5dc481(0x111)]];const _0x300472=_0x2f7285[_0x5dc481(0x15b)](_0xbb3766=>{return _0xbb3766={'product_name':_0xbb3766};});_0x2b8a57[_0x5dc481(0xa5)]((_0x42773e,_0x4ef508)=>{var _0x3cf718=_0x5dc481;_0x300472[_0x4ef508][_0x3cf718(0xa3)]=_0x42773e;}),_0x21e18a['forEach']((_0x27d48b,_0x397dd7)=>{var _0x4d079d=_0x5dc481;_0x300472[_0x397dd7][_0x4d079d(0x142)]=_0x27d48b;}),_0x4bc9f7[_0x5dc481(0xa5)]((_0x2767c3,_0x16b4ce)=>{var _0x4f1bf9=_0x5dc481;_0x300472[_0x16b4ce][_0x4f1bf9(0x94)]=_0x2767c3;}),_0x23cc42[_0x5dc481(0xa5)]((_0x11397d,_0x5845f7)=>{var _0x1d5f4b=_0x5dc481;_0x300472[_0x5845f7][_0x1d5f4b(0xef)]=_0x11397d;}),_0x3d01a2[_0x5dc481(0xa5)]((_0x2773b7,_0x322742)=>{var _0x7e0c71=_0x5dc481;_0x48d7da[_0x7e0c71(0xa5)]((_0x59c193,_0x4d2d6e)=>{var _0x168fbd=_0x7e0c71;if(_0x59c193==_0x168fbd(0xe6)&&_0x322742==_0x4d2d6e){var _0x19de34=_0x2773b7[_0x168fbd(0xe9)](0x3);_0x300472[_0x322742][_0x168fbd(0xd6)]=_0x2773b7[0x0],_0x300472[_0x322742]['from_rack']=_0x2773b7[0x1],_0x300472[_0x322742][_0x168fbd(0xb6)]=0x0,_0x300472[_0x322742][_0x168fbd(0x13a)]=0x0,_0x300472[_0x322742]['from_types']='Floor',_0x300472[_0x322742][_0x168fbd(0x14c)]=_0x19de34;}else{if(_0x59c193==_0x168fbd(0x90)&&_0x322742==_0x4d2d6e){var _0x19de34=_0x2773b7[_0x168fbd(0xe9)](0x3);_0x300472[_0x322742][_0x168fbd(0xd6)]=_0x2773b7[0x0],_0x300472[_0x322742][_0x168fbd(0x88)]=_0x2773b7[0x1],_0x300472[_0x322742][_0x168fbd(0xb6)]=0x0,_0x300472[_0x322742]['from_bin']=0x0,_0x300472[_0x322742]['from_types']=_0x168fbd(0x15f),_0x300472[_0x322742][_0x168fbd(0x14c)]=_0x2773b7[0x5];}else{if(_0x322742==_0x4d2d6e){if(_0x2773b7[0x0]=='A'&&_0x2773b7[0x1]=='L'&&_0x2773b7[0x2]=='L')console[_0x168fbd(0xbe)](_0x59c193+_0x168fbd(0x89)+_0x322742+_0x168fbd(0x89)+_0x4d2d6e+'\x20<>\x20'+_0x2773b7+'here'),_0x300472[_0x322742]['from_storage']=_0x2773b7[0x0],_0x300472[_0x322742]['from_rack']=_0x2773b7[0x1],_0x300472[_0x322742]['from_bay']=0x0,_0x300472[_0x322742][_0x168fbd(0x13a)]=0x0,_0x300472[_0x322742][_0x168fbd(0xbb)]=_0x168fbd(0x15f),_0x300472[_0x322742][_0x168fbd(0x14c)]=_0x2773b7[0x3];else{var _0x595291;if(_0x2773b7[0x4]=='L')_0x595291='Level';else _0x2773b7[0x4]=='F'&&(_0x595291=_0x168fbd(0x15f));_0x300472[_0x322742][_0x168fbd(0xd6)]=_0x2773b7[0x0],_0x300472[_0x322742][_0x168fbd(0x88)]=_0x2773b7[0x1],_0x300472[_0x322742][_0x168fbd(0xb6)]=_0x2773b7[0x2],_0x300472[_0x322742][_0x168fbd(0x13a)]=_0x2773b7[0x3],_0x300472[_0x322742][_0x168fbd(0xbb)]=_0x595291,_0x300472[_0x322742][_0x168fbd(0x14c)]=_0x2773b7[0x5];}}}}});}),_0xe79614[_0x5dc481(0xa5)]((_0x3b791f,_0x345d97)=>{_0x300472[_0x345d97]['to_quantity']=_0x3b791f;}),_0x4bc513['forEach']((_0x1d6778,_0x138a08)=>{var _0x3c7feb=_0x5dc481;_0x1d05eb[_0x3c7feb(0xa5)]((_0x28a709,_0x10c3f6)=>{var _0xa55e86=_0x3c7feb;if(_0x28a709==_0xa55e86(0xe6)&&_0x138a08==_0x10c3f6){var _0x256199=_0x1d6778[_0xa55e86(0xe9)](0x3);_0x300472[_0x138a08][_0xa55e86(0xf5)]=_0x1d6778[0x0],_0x300472[_0x138a08][_0xa55e86(0x79)]=_0x1d6778[0x1],_0x300472[_0x138a08][_0xa55e86(0xce)]=0x0,_0x300472[_0x138a08][_0xa55e86(0xa4)]=0x0,_0x300472[_0x138a08][_0xa55e86(0x8c)]='Floor',_0x300472[_0x138a08][_0xa55e86(0x8b)]=_0x256199;}else{if(_0x28a709==_0xa55e86(0x90)&&_0x138a08==_0x10c3f6){var _0x256199=_0x1d6778[_0xa55e86(0xe9)](0x3);_0x300472[_0x138a08]['storage']=_0x1d6778[0x0],_0x300472[_0x138a08][_0xa55e86(0x79)]=_0x1d6778[0x1],_0x300472[_0x138a08][_0xa55e86(0xce)]=0x0,_0x300472[_0x138a08][_0xa55e86(0xa4)]=0x0,_0x300472[_0x138a08][_0xa55e86(0x8c)]=_0xa55e86(0x15f),_0x300472[_0x138a08]['to_floorlevel']=_0x1d6778[0x5];}else{if(_0x138a08==_0x10c3f6){if(_0x1d6778[0x0]=='A'&&_0x1d6778[0x1]=='L'&&_0x1d6778[0x2]=='L')console[_0xa55e86(0xbe)](_0x28a709+_0xa55e86(0x89)+_0x138a08+_0xa55e86(0x89)+_0x10c3f6+'\x20<>\x20'+_0x1d6778+_0xa55e86(0x128)),_0x300472[_0x138a08][_0xa55e86(0xf5)]=_0x1d6778[0x0],_0x300472[_0x138a08]['rack']=_0x1d6778[0x1],_0x300472[_0x138a08]['to_bay']=0x0,_0x300472[_0x138a08][_0xa55e86(0xa4)]=0x0,_0x300472[_0x138a08][_0xa55e86(0x8c)]='Floor',_0x300472[_0x138a08]['to_floorlevel']=_0x1d6778[0x3];else{var _0x312b27;if(_0x1d6778[0x4]=='L')_0x312b27='Level';else _0x1d6778[0x4]=='F'&&(_0x312b27=_0xa55e86(0x15f));_0x300472[_0x138a08]['storage']=_0x1d6778[0x0],_0x300472[_0x138a08][_0xa55e86(0x79)]=_0x1d6778[0x1],_0x300472[_0x138a08][_0xa55e86(0xce)]=_0x1d6778[0x2],_0x300472[_0x138a08][_0xa55e86(0xa4)]=_0x1d6778[0x3],_0x300472[_0x138a08][_0xa55e86(0x8c)]=_0x312b27,_0x300472[_0x138a08]['to_floorlevel']=_0x1d6778[0x5];}}}}});}),_0x2eafe3[_0x5dc481(0xa5)]((_0xaee697,_0x495eae)=>{var _0x3a5946=_0x5dc481;_0x300472[_0x495eae][_0x3a5946(0xe7)]=_0xaee697;}),_0x5d9466[_0x5dc481(0xa5)]((_0x4b11c7,_0xd0b517)=>{_0x300472[_0xd0b517]['secondary_code']=_0x4b11c7;}),_0x2e96f8[_0x5dc481(0xa5)]((_0x496b47,_0x1e06fb)=>{var _0x2d92db=_0x5dc481;_0x300472[_0x1e06fb][_0x2d92db(0x9b)]=_0x496b47;}),_0x1d897b[_0x5dc481(0xa5)]((_0x3070a0,_0x3dfe5e)=>{var _0x46ce4b=_0x5dc481;_0x300472[_0x3dfe5e][_0x46ce4b(0x14b)]=_0x3070a0;}),_0x4074e3[_0x5dc481(0xa5)]((_0x67475d,_0xa4d87b)=>{var _0x4fca5c=_0x5dc481;_0x300472[_0xa4d87b][_0x4fca5c(0xa0)]=_0x67475d;}),_0x57689f['forEach']((_0x35966b,_0x253a27)=>{var _0x2b4abc=_0x5dc481;_0x300472[_0x253a27][_0x2b4abc(0xf9)]=_0x35966b;}),_0x1955e3['forEach']((_0xc5618f,_0x247ee5)=>{var _0x95ccfc=_0x5dc481;_0x300472[_0x247ee5][_0x95ccfc(0xc3)]=_0xc5618f;}),_0x4c9d46['forEach']((_0x4865e3,_0x1de601)=>{var _0xebf53b=_0x5dc481;_0x300472[_0x1de601][_0xebf53b(0x147)]=_0x4865e3;}),_0x134196['forEach']((_0x4fb4b3,_0x90e150)=>{var _0x445209=_0x5dc481;_0x300472[_0x90e150][_0x445209(0xf7)]=_0x4fb4b3;}),_0x2c7138[_0x5dc481(0xa5)]((_0x5f3d83,_0x58f296)=>{_0x300472[_0x58f296]['production_date']=_0x5f3d83;}),_0x21cb6c[_0x5dc481(0xa5)]((_0x3cf60b,_0x4cb460)=>{_0x300472[_0x4cb460]['prod_cat']=_0x3cf60b;}),_0x48d7da[_0x5dc481(0xa5)]((_0x351f19,_0x302d0f)=>{var _0x281354=_0x5dc481;_0x300472[_0x302d0f][_0x281354(0x82)]=_0x351f19;}),_0x1d05eb[_0x5dc481(0xa5)]((_0x5a8b07,_0x505759)=>{_0x300472[_0x505759]['to_room_name']=_0x5a8b07;});const _0x24c540=_0x300472[_0x5dc481(0x113)](_0x4aa0fd=>_0x4aa0fd[_0x5dc481(0xa2)]!=='0'&&_0x4aa0fd[_0x5dc481(0xa2)]!==''||_0x4aa0fd['to_floorlevel']!=='0'&&_0x4aa0fd[_0x5dc481(0x8b)]!==''),_0x4bfaf6=new transfers({'date':_0x1878ef,'from_warehouse':_0x2bc0d9,'to_warehouse':_0x315a70,'product':_0x24c540,'note':_0x202ae2,'invoice':_0xc3d974}),_0x1a38a0=await _0x4bfaf6[_0x5dc481(0xa1)]();_0x3463ee[_0x5dc481(0x130)]('success',_0x5dc481(0xab)),_0x52b150['redirect']('/transfer/preview/'+_0x1a38a0['_id']);}catch(_0x233eee){console['log'](_0x233eee),_0x52b150[_0x5dc481(0x145)](0xc8)[_0x5dc481(0xb0)]({'errorMessage':_0x233eee[_0x5dc481(0x135)]});}}),router[a0_0x2f7cdc(0x123)](a0_0x2f7cdc(0x152),auth,async(_0x206862,_0x205e55)=>{var _0x302e75=a0_0x2f7cdc;try{const {username:_0x1ec452,email:_0x261b0e,role:_0x10006d}=_0x206862['user'],_0x50bd04=_0x206862[_0x302e75(0x136)],_0x43ee69=await profile['findOne']({'email':_0x50bd04[_0x302e75(0x75)]}),_0x32ba1e=await master_shop[_0x302e75(0x74)]();console[_0x302e75(0xbe)](_0x302e75(0x156),_0x32ba1e);const _0x5c8281=await transfers[_0x302e75(0x138)](_0x206862[_0x302e75(0xbc)]['id']);let _0x103a52=new Date(_0x5c8281[_0x302e75(0x147)]),_0x41307=('0'+_0x103a52['getDate']())['slice'](-0x2),_0x28c9fa=('0'+(_0x103a52['getMonth']()+0x1))[_0x302e75(0xe9)](-0x2),_0x19d724=_0x103a52['getFullYear'](),_0x2959df=_0x19d724+'-'+_0x28c9fa+'-'+_0x41307,_0x14930a;if(_0x50bd04[_0x302e75(0x97)]==_0x302e75(0x71)){const _0x3cbda5=await staff['findOne']({'email':_0x50bd04[_0x302e75(0x75)]});_0x14930a=await warehouse[_0x302e75(0x74)]({'status':'Enabled','name':_0x3cbda5['warehouse'],'warehouse_category':_0x302e75(0x96)});}else _0x14930a=await warehouse[_0x302e75(0x74)]({'status':'Enabled','warehouse_category':_0x302e75(0x96)});const _0x1da159=await warehouse[_0x302e75(0x98)]([{'$match':{'name':_0x5c8281[_0x302e75(0x6f)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x302e75(0x12c),'name':{'$first':_0x302e75(0x72)},'product_stock':{'$first':_0x302e75(0x14e)},'bay':{'$first':_0x302e75(0x11b)},'bin':{'$first':_0x302e75(0xd7)},'type':{'$first':_0x302e75(0x12f)},'floorlevel':{'$first':_0x302e75(0x122)},'primary_code':{'$first':_0x302e75(0xed)},'secondary_code':{'$first':_0x302e75(0x7a)},'product_code':{'$first':_0x302e75(0x117)},'storage':{'$first':_0x302e75(0xee)},'rack':{'$first':_0x302e75(0xec)},'expiry_date':{'$first':_0x302e75(0x9d)},'production_date':{'$first':_0x302e75(0x99)},'room':{'$first':'$room'}}}]);if(_0x32ba1e[0x0][_0x302e75(0xc0)]=='English\x20(US)'){var _0x4f6fa2=users[_0x302e75(0x139)];console[_0x302e75(0xbe)](_0x4f6fa2);}else{if(_0x32ba1e[0x0][_0x302e75(0xc0)]==_0x302e75(0x14d))var _0x4f6fa2=users[_0x302e75(0x14d)];else{if(_0x32ba1e[0x0][_0x302e75(0xc0)]==_0x302e75(0xfe))var _0x4f6fa2=users[_0x302e75(0xfe)];else{if(_0x32ba1e[0x0][_0x302e75(0xc0)]==_0x302e75(0xcc))var _0x4f6fa2=users[_0x302e75(0xcc)];else{if(_0x32ba1e[0x0][_0x302e75(0xc0)]==_0x302e75(0x70))var _0x4f6fa2=users[_0x302e75(0x70)];else{if(_0x32ba1e[0x0][_0x302e75(0xc0)]==_0x302e75(0xae))var _0x4f6fa2=users[_0x302e75(0xd3)];else{if(_0x32ba1e[0x0][_0x302e75(0xc0)]==_0x302e75(0x91))var _0x4f6fa2=users[_0x302e75(0x91)];else{if(_0x32ba1e[0x0][_0x302e75(0xc0)]==_0x302e75(0xb7))var _0x4f6fa2=users[_0x302e75(0xf4)];}}}}}}}_0x205e55[_0x302e75(0xc6)](_0x302e75(0x140),{'success':_0x206862[_0x302e75(0x130)]('success'),'errors':_0x206862['flash'](_0x302e75(0x144)),'role':_0x50bd04,'profile':_0x43ee69,'master_shop':_0x32ba1e,'warehouse':_0x14930a,'transfer':_0x5c8281,'stock':_0x1da159,'language':_0x4f6fa2});}catch(_0x133441){console[_0x302e75(0xbe)](_0x133441);}}),router['post'](a0_0x2f7cdc(0x152),auth,async(_0x563fcf,_0x317cc1)=>{var _0x12988e=a0_0x2f7cdc;try{const _0x434b0e=_0x563fcf[_0x12988e(0xbc)]['id'],{from_warehouse:_0x134acd,FromRoom_name:_0x194925,to_warehouse:_0x4baee3,ToRoom_name:_0x1143a9}=_0x563fcf['body'],_0x56abf5=await transfers[_0x12988e(0x138)]({'_id':_0x434b0e}),_0x522d84=_0x56abf5[_0x12988e(0x15d)][_0x12988e(0x15b)](async _0x50d812=>{var _0x251070=_0x12988e;if(_0x50d812[_0x251070(0xa2)]>0x0){var _0x2a9d49=await warehouse[_0x251070(0xc9)]({'name':_0x56abf5[_0x251070(0x6f)],'room':_0x50d812[_0x251070(0x82)],'warehouse_category':'Raw\x20Materials'});const _0xa43620=_0x2a9d49[_0x251070(0x148)][_0x251070(0x15b)](_0x3b99a0=>{var _0x10d418=_0x251070;_0x3b99a0[_0x10d418(0x7d)]==_0x50d812['product_name']&&_0x3b99a0[_0x10d418(0x93)]==_0x50d812[_0x10d418(0x14c)]&&_0x3b99a0[_0x10d418(0x141)]==_0x50d812[_0x10d418(0xbb)]&&_0x3b99a0['bin']==_0x50d812[_0x10d418(0x13a)]&&_0x3b99a0[_0x10d418(0xd9)]==_0x50d812[_0x10d418(0xb6)]&&_0x3b99a0['rack']==_0x50d812['from_rack']&&_0x3b99a0[_0x10d418(0xf5)]==_0x50d812['from_storage']&&_0x3b99a0[_0x10d418(0x147)]==_0x50d812[_0x10d418(0x147)]&&_0x3b99a0[_0x10d418(0xc3)]==_0x50d812[_0x10d418(0xc3)]&&_0x3b99a0[_0x10d418(0x100)]==_0x50d812[_0x10d418(0x100)]&&_0x3b99a0[_0x10d418(0xc7)]==_0x50d812[_0x10d418(0x142)]&&_0x3b99a0[_0x10d418(0x125)]==_0x50d812['id_transaction_id']&&(_0x3b99a0[_0x10d418(0x154)]=_0x3b99a0['product_stock']-_0x50d812[_0x10d418(0xa2)]);});}return _0x2a9d49;});Promise[_0x12988e(0xf1)](_0x522d84)['then'](async _0x2c5ab5=>{var _0x57c17c=_0x12988e;try{for(const _0x6837bc of _0x2c5ab5){await _0x6837bc['save']();}try{const _0x56c733=_0x56abf5['product']['map'](async _0x2e60f5=>{var _0x4339f=a0_0x5992;if(_0x2e60f5[_0x4339f(0xa2)]>0x0){var _0x5683fe=await warehouse[_0x4339f(0xc9)]({'name':_0x56abf5[_0x4339f(0xeb)],'room':_0x2e60f5[_0x4339f(0xe8)],'warehouse_category':_0x4339f(0x96)}),_0x7302c0=0x0;const _0x2e0412=_0x5683fe[_0x4339f(0x148)][_0x4339f(0x15b)](_0x27668d=>{var _0x39f39a=_0x4339f;_0x27668d[_0x39f39a(0x7d)]==_0x2e60f5[_0x39f39a(0x7d)]&&_0x27668d[_0x39f39a(0x93)]==_0x2e60f5['to_floorlevel']&&_0x27668d[_0x39f39a(0x141)]==_0x2e60f5[_0x39f39a(0x8c)]&&_0x27668d['bin']==_0x2e60f5[_0x39f39a(0xa4)]&&_0x27668d[_0x39f39a(0xd9)]==_0x2e60f5[_0x39f39a(0xce)]&&_0x27668d[_0x39f39a(0x79)]==_0x2e60f5['rack']&&_0x27668d['storage']==_0x2e60f5[_0x39f39a(0xf5)]&&_0x27668d['expiry_date']==_0x2e60f5[_0x39f39a(0x147)]&&_0x27668d[_0x39f39a(0xc3)]==_0x2e60f5[_0x39f39a(0xc3)]&&_0x27668d[_0x39f39a(0x100)]==_0x2e60f5['production_date']&&_0x27668d['invoice']==_0x2e60f5['To_invoice']&&(_0x27668d['product_stock']=_0x27668d['product_stock']+_0x2e60f5[_0x39f39a(0xa2)],_0x7302c0++);});_0x7302c0=='0'&&(_0x5683fe[_0x4339f(0x148)]=_0x5683fe[_0x4339f(0x148)]['concat']({'product_name':_0x2e60f5['product_name'],'product_stock':_0x2e60f5[_0x4339f(0xa2)],'bay':_0x2e60f5['to_bay'],'bin':_0x2e60f5[_0x4339f(0xa4)],'type':_0x2e60f5['to_types'],'floorlevel':_0x2e60f5[_0x4339f(0x8b)],'storage':_0x2e60f5[_0x4339f(0xf5)],'rack':_0x2e60f5['rack'],'product_code':_0x2e60f5[_0x4339f(0x9b)],'primary_code':_0x2e60f5[_0x4339f(0xe7)],'secondary_code':_0x2e60f5[_0x4339f(0xf2)],'maxProducts':_0x2e60f5[_0x4339f(0x14b)],'storage':_0x2e60f5['storage'],'rack':_0x2e60f5[_0x4339f(0x79)],'expiry_date':_0x2e60f5[_0x4339f(0x147)],'maxPerUnit':_0x2e60f5[_0x4339f(0xf7)],'batch_code':_0x2e60f5[_0x4339f(0xc3)],'production_date':_0x2e60f5[_0x4339f(0x100)]}));}return _0x5683fe;});Promise[_0x57c17c(0xf1)](_0x56c733)[_0x57c17c(0x12b)](async _0x4bc3b6=>{var _0x552ece=_0x57c17c;try{for(const _0x2d3dc9 of _0x4bc3b6){await warehouse[_0x552ece(0xc8)]({'_id':_0x2d3dc9[_0x552ece(0x125)]},{'$addToSet':{'product_details':{'$each':_0x2d3dc9[_0x552ece(0x148)]}}});}_0x56abf5['finalize']=_0x552ece(0xdd);const _0x2cea27=await _0x56abf5[_0x552ece(0xa1)](),_0x46f127=await master_shop[_0x552ece(0x74)](),_0x101dab=await email_settings[_0x552ece(0xc9)](),_0x2cceca=await supervisor_settings['find']();var _0x7039c2=_0x56abf5[_0x552ece(0x15d)],_0x28bced='',_0x35c4ac;for(_0x35c4ac in _0x7039c2){_0x28bced+='<tr>'+_0x552ece(0x124)+_0x7039c2[_0x35c4ac][_0x552ece(0x7d)]+_0x552ece(0x6e)+_0x552ece(0x124)+_0x7039c2[_0x35c4ac]['product_code']+_0x552ece(0x6e)+_0x552ece(0x124)+_0x7039c2[_0x35c4ac]['to_quantity']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x7039c2[_0x35c4ac][_0x552ece(0xa0)]+_0x552ece(0x6e)+_0x552ece(0x124)+_0x7039c2[_0x35c4ac][_0x552ece(0xf9)]+_0x552ece(0x6e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x56abf5[_0x552ece(0xeb)]+'</td>'+_0x552ece(0x124)+_0x7039c2[_0x35c4ac][_0x552ece(0xe8)]+_0x552ece(0x6e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x7039c2[_0x35c4ac]['storage']+_0x7039c2[_0x35c4ac][_0x552ece(0x79)]+_0x7039c2[_0x35c4ac][_0x552ece(0xce)]+_0x7039c2[_0x35c4ac][_0x552ece(0xa4)]+_0x7039c2[_0x35c4ac][_0x552ece(0x8c)][0x0]+_0x7039c2[_0x35c4ac][_0x552ece(0x8b)]+_0x552ece(0x6e),_0x552ece(0x132);}let _0x464a9e=nodemailer['createTransport']({'host':_0x101dab['host'],'port':Number(_0x101dab['port']),'secure':![],'auth':{'user':_0x101dab[_0x552ece(0x75)],'pass':_0x101dab[_0x552ece(0x102)]}}),_0x59d9e7={'from':_0x101dab[_0x552ece(0x75)],'to':_0x2cceca[0x0][_0x552ece(0x158)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x552ece(0x7e),'path':__dirname+_0x552ece(0x159)+_0x552ece(0xaf)+_0x46f127[0x0][_0x552ece(0xe0)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x552ece(0x155)+_0x552ece(0x115)+_0x552ece(0xf6)+_0x552ece(0x106)+_0x552ece(0xf6)+_0x552ece(0x14a)+_0x552ece(0x11f)+_0x552ece(0xf6)+'<h2>\x20'+_0x46f127[0x0][_0x552ece(0x118)]+'\x20</h2>'+_0x552ece(0x11f)+_0x552ece(0x11f)+'<hr\x20class=\x22my-3\x22>'+_0x552ece(0xf6)+_0x552ece(0x143)+_0x552ece(0x84)+_0x56abf5[_0x552ece(0xc7)]+'\x20'+_0x552ece(0x14f)+_0x552ece(0x13f)+_0x56abf5[_0x552ece(0xfc)]+'\x20'+_0x552ece(0xa9)+_0x552ece(0x105)+'</div>'+_0x552ece(0xb5)+_0x552ece(0xe3)+_0x552ece(0x10a)+_0x552ece(0xfb)+_0x552ece(0xf8)+_0x552ece(0x134)+_0x552ece(0x9c)+_0x552ece(0x129)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x552ece(0x15c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x552ece(0x132)+_0x552ece(0xd8)+_0x552ece(0x12a)+'\x20'+_0x28bced+'\x20'+_0x552ece(0xca)+_0x552ece(0xb3)+_0x552ece(0xf6)+'<strong>\x20Regards\x20</strong>'+_0x552ece(0xf3)+_0x46f127[0x0]['site_title']+'</h5>'+_0x552ece(0x11f)+_0x552ece(0x11f)+_0x552ece(0xbf)};_0x464a9e[_0x552ece(0xe4)](_0x59d9e7,function(_0x25ee84,_0x5ada4a){var _0x515553=_0x552ece;_0x25ee84?(console['log'](_0x25ee84),console[_0x515553(0xbe)]('Error\x20Occurs')):console['log'](_0x515553(0x13c));}),_0x563fcf[_0x552ece(0x130)]('success',_0x552ece(0xd1)),_0x317cc1['redirect'](_0x552ece(0xde)+_0x2cea27[_0x552ece(0x125)]);}catch(_0x25b747){console['error'](_0x25b747),_0x317cc1[_0x552ece(0x145)](0x1f4)[_0x552ece(0xb0)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x25b747[_0x552ece(0x135)]});}})[_0x57c17c(0x8d)](_0x182b8b=>{var _0x2fb8e0=_0x57c17c;console['error'](_0x182b8b),_0x317cc1[_0x2fb8e0(0x145)](0x1f4)['json']({'Perror':_0x2fb8e0(0x87)});});}catch(_0x2321b7){_0x317cc1[_0x57c17c(0xb0)](_0x2321b7);}}catch(_0x53a7e1){console[_0x57c17c(0x150)](_0x53a7e1),_0x317cc1['status'](0x1f4)['json']({'Merror':_0x57c17c(0x126),'Message':_0x53a7e1['message']});}})[_0x12988e(0x8d)](_0x47e119=>{var _0x3acd00=_0x12988e;console[_0x3acd00(0x150)](_0x47e119),_0x317cc1[_0x3acd00(0x145)](0x1f4)['json']({'Merror':_0x3acd00(0x87)});});}catch(_0x42be93){console[_0x12988e(0xbe)](_0x42be93);}});function a0_0x5992(_0x1ecd65,_0xba3fff){var _0x58d7c9=a0_0x58d7();return a0_0x5992=function(_0x59921e,_0x25860a){_0x59921e=_0x59921e-0x6e;var _0x19a322=_0x58d7c9[_0x59921e];return _0x19a322;},a0_0x5992(_0x1ecd65,_0xba3fff);}function BayBinSelected(_0x1e12e,_0x767253){var _0x547fbd=a0_0x2f7cdc,_0x34b5ad=[],_0x4bf6fa=[],_0x342c49=[],_0x1175a9=[],_0x35384a=[],_0x31794c=[];let _0x4ca866=[];if(_0x1e12e==_0x547fbd(0x107))switch(_0x767253){case _0x547fbd(0x15e):_0x34b5ad=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4bf6fa=[0x1,0x2],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=[_0x547fbd(0x9a),_0x547fbd(0x15f)],_0x35384a=['D'],_0x31794c=['A'];break;case _0x547fbd(0xc2):_0x34b5ad=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4bf6fa=[0x1,0x2],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=[_0x547fbd(0x9a),'Floor'],_0x35384a=['D'],_0x31794c=['B'];break;case _0x547fbd(0x90):_0x34b5ad=[0x0],_0x4bf6fa=[0x0],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=[_0x547fbd(0x15f)],_0x35384a=['D'],_0x31794c=['S'];break;case _0x547fbd(0xe6):_0x34b5ad=[0x0],_0x4bf6fa=[0x0],_0x1175a9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x342c49=['Floor'],_0x35384a=['D'],_0x31794c=['R'];break;}else{if(_0x1e12e=='COLD\x20STORAGE')switch(_0x767253){case _0x547fbd(0x15e):_0x34b5ad=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4bf6fa=['B','F'],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=['Level',_0x547fbd(0x15f)],_0x35384a=['C'],_0x31794c=['A'];break;case _0x547fbd(0xc2):_0x34b5ad=[0x5,0x4,0x3,0x2,0x1],_0x4bf6fa=['F','B','S'],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=[_0x547fbd(0x9a),_0x547fbd(0x15f)],_0x35384a=['C'],_0x31794c=['B'];break;case _0x547fbd(0x95):_0x34b5ad=[0x1,0x2,0x3,0x4,0x5],_0x4bf6fa=['B','F','S'],_0x1175a9=[0x5,0x4,0x3,0x2,0x1],_0x342c49=[_0x547fbd(0x9a),'Floor'],_0x35384a=['C'],_0x31794c=['C'];break;case _0x547fbd(0x73):_0x34b5ad=[0x5,0x4,0x3,0x2,0x1],_0x4bf6fa=['F','B','S'],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=[_0x547fbd(0x9a),_0x547fbd(0x15f)],_0x35384a=['C'],_0x31794c=['D'];break;case _0x547fbd(0x12d):_0x34b5ad=[0x4,0x3,0x2,0x1],_0x4bf6fa=[0x1,0x2],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=[_0x547fbd(0x9a),_0x547fbd(0x15f)],_0x35384a=['C'],_0x31794c=['E'];break;case _0x547fbd(0x137):_0x34b5ad=[0x1,0x2,0x3],_0x4bf6fa=[0x1,0x2],_0x1175a9=[0x1,0x2,0x3,0x4,0x5],_0x342c49=['Level'],_0x35384a=['C'],_0x31794c=['F'];break;}}return{'levels':_0x34b5ad,'Isle':_0x4bf6fa,'rack':_0x1175a9,'type':_0x342c49,'storage':_0x35384a,'rak':_0x31794c};}router[a0_0x2f7cdc(0x123)]('/view/:id',auth,async(_0x11ccc7,_0x1cdedf)=>{var _0x497492=a0_0x2f7cdc;try{const {username:_0x5e52f8,email:_0x30f79a,role:_0x384841}=_0x11ccc7[_0x497492(0x136)],_0x29eb11=_0x11ccc7[_0x497492(0x136)],_0x159cd4=await profile[_0x497492(0xc9)]({'email':_0x29eb11[_0x497492(0x75)]}),_0x27236d=await master_shop[_0x497492(0x74)](),_0x37b811=await transfers[_0x497492(0x138)](_0x11ccc7[_0x497492(0xbc)]['id']);let _0x354d83;if(_0x29eb11[_0x497492(0x97)]==_0x497492(0x71)){const _0x24863a=await staff[_0x497492(0xc9)]({'email':_0x29eb11['email']});_0x354d83=await warehouse[_0x497492(0x98)]([{'$match':{'status':_0x497492(0xa6),'name':_0x24863a['warehouse'],'warehouse_category':_0x497492(0x96)}},{'$group':{'_id':_0x497492(0x81),'name':{'$first':_0x497492(0x81)}}}]);}else _0x354d83=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x497492(0x81)}}}]);const _0x156220=await warehouse[_0x497492(0x98)]([{'$match':{'name':_0x37b811['from_warehouse'],'warehouse_category':_0x497492(0x96)}},{'$unwind':_0x497492(0xe2)},{'$group':{'_id':_0x497492(0x12c),'name':{'$first':_0x497492(0x72)},'product_stock':{'$first':_0x497492(0x14e)},'bay':{'$first':_0x497492(0x11b)},'bin':{'$first':_0x497492(0xd7)},'type':{'$first':_0x497492(0x12f)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x497492(0xed)},'secondary_code':{'$first':_0x497492(0x7a)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x497492(0xee)},'rack':{'$first':_0x497492(0xec)},'expiry_date':{'$first':_0x497492(0x9d)},'production_date':{'$first':_0x497492(0x99)},'room':{'$first':_0x497492(0x8f)}}}]),_0x4c2f2c=await product[_0x497492(0x74)]({}),_0x3731f7=BayBinSelected(_0x37b811[_0x497492(0xeb)],_0x37b811[_0x497492(0x103)]);if(_0x27236d[0x0]['language']==_0x497492(0xc5)){var _0x20e56b=users['English'];console[_0x497492(0xbe)](_0x20e56b);}else{if(_0x27236d[0x0]['language']==_0x497492(0x14d))var _0x20e56b=users[_0x497492(0x14d)];else{if(_0x27236d[0x0][_0x497492(0xc0)]==_0x497492(0xfe))var _0x20e56b=users['German'];else{if(_0x27236d[0x0][_0x497492(0xc0)]==_0x497492(0xcc))var _0x20e56b=users[_0x497492(0xcc)];else{if(_0x27236d[0x0][_0x497492(0xc0)]==_0x497492(0x70))var _0x20e56b=users[_0x497492(0x70)];else{if(_0x27236d[0x0][_0x497492(0xc0)]==_0x497492(0xae))var _0x20e56b=users['Portuguese'];else{if(_0x27236d[0x0][_0x497492(0xc0)]==_0x497492(0x91))var _0x20e56b=users['Chinese'];else{if(_0x27236d[0x0][_0x497492(0xc0)]=='Arabic\x20(ae)')var _0x20e56b=users[_0x497492(0xf4)];}}}}}}}_0x1cdedf[_0x497492(0xc6)](_0x497492(0xd4),{'success':_0x11ccc7[_0x497492(0x130)](_0x497492(0x121)),'errors':_0x11ccc7[_0x497492(0x130)](_0x497492(0x144)),'role':_0x29eb11,'profile':_0x159cd4,'master_shop':_0x27236d,'warehouse':_0x354d83,'transfer':_0x37b811,'stock':_0x156220,'unit':_0x4c2f2c,'language':_0x20e56b});}catch(_0x2617ac){console['log'](_0x2617ac);}}),router[a0_0x2f7cdc(0xc1)]('/view/:id',auth,async(_0x4913f6,_0x42dfeb)=>{var _0x255824=a0_0x2f7cdc;try{const _0x4b7810=_0x4913f6[_0x255824(0xbc)]['id'],_0x262399=await transfers[_0x255824(0x138)](_0x4b7810);_0x42dfeb[_0x255824(0xb0)](_0x4913f6[_0x255824(0x101)]);return;const {date:_0xf6a2f9,from_warehouse:_0x3e7dd2,FromRoom_name:_0x6b13,to_warehouse:_0x2c1b01,ToRoom_name:_0x2a7161,prod_name:_0x3933d9,from_prod_qty:_0x4281ee,from_prod_level:_0x333c6c,from_prod_isle:_0x4315e2,from_prod_pallet:_0x5a6ef9,to_prod_qty:_0x4e1b93,to_prod_level:_0x3dfaed,to_prod_isle:_0x8419a8,to_prod_pallet:_0x3a48cb,primary_code:_0xa97ebd,secondary_code:_0x1eadde,product_code3:_0x4f2343,note:_0x42186a,invoice:_0x5672e0,expiry_date:_0x526eb2}=_0x4913f6[_0x255824(0x101)];if(typeof _0x3933d9==_0x255824(0x104))var _0x448d28=[_0x4913f6['body'][_0x255824(0x151)]],_0x39418a=[_0x4913f6[_0x255824(0x101)][_0x255824(0xb4)]],_0x409c7c=[_0x4913f6[_0x255824(0x101)][_0x255824(0x116)]],_0x15cda2=[_0x4913f6['body'][_0x255824(0x85)]],_0xebc77b=[_0x4913f6[_0x255824(0x101)][_0x255824(0xb9)]],_0x5d7d5c=[_0x4913f6[_0x255824(0x101)][_0x255824(0xbb)]],_0x4649ae=[_0x4913f6['body'][_0x255824(0xbd)]],_0x53f9a2=[_0x4913f6[_0x255824(0x101)]['to_prod_level']],_0x45845=[_0x4913f6[_0x255824(0x101)][_0x255824(0x119)]],_0x40419c=[_0x4913f6[_0x255824(0x101)][_0x255824(0x149)]],_0x39b9ad=[_0x4913f6['body'][_0x255824(0x8c)]],_0x2e0ac3=[_0x4913f6['body']['storage']],_0x43e051=[_0x4913f6[_0x255824(0x101)][_0x255824(0x11c)]],_0x446832=[_0x4913f6[_0x255824(0x101)]['primary_code']],_0x550f28=[_0x4913f6[_0x255824(0x101)][_0x255824(0xf2)]],_0x3ff514=[_0x4913f6[_0x255824(0x101)][_0x255824(0x127)]],_0x35bde3=[_0x4913f6[_0x255824(0x101)][_0x255824(0xfa)]],_0x2f5dad=[_0x4913f6['body'][_0x255824(0xa0)]],_0x2cfbdd=[_0x4913f6[_0x255824(0x101)][_0x255824(0xf9)]],_0x42aa2d=[_0x4913f6[_0x255824(0x101)][_0x255824(0xc3)]],_0x4dcd1a=[_0x4913f6[_0x255824(0x101)][_0x255824(0x147)]],_0x3e74d7=[_0x4913f6[_0x255824(0x101)][_0x255824(0xd6)]],_0xee8c06=[_0x4913f6[_0x255824(0x101)][_0x255824(0x10c)]];else var _0x448d28=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x151)]],_0x2e0ac3=[..._0x4913f6[_0x255824(0x101)][_0x255824(0xf5)]],_0x43e051=[..._0x4913f6[_0x255824(0x101)]['rak']],_0x5d7d5c=[..._0x4913f6[_0x255824(0x101)][_0x255824(0xbb)]],_0x39b9ad=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x8c)]],_0x39418a=[..._0x4913f6[_0x255824(0x101)][_0x255824(0xb4)]],_0x409c7c=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x116)]],_0x15cda2=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x85)]],_0xebc77b=[..._0x4913f6['body'][_0x255824(0xb9)]],_0x4649ae=[..._0x4913f6[_0x255824(0x101)]['to_prod_qty']],_0x53f9a2=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x112)]],_0x45845=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x119)]],_0x40419c=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x149)]],_0x446832=[..._0x4913f6[_0x255824(0x101)][_0x255824(0xe7)]],_0x550f28=[..._0x4913f6[_0x255824(0x101)][_0x255824(0xf2)]],_0x3ff514=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x127)]],_0x35bde3=[..._0x4913f6['body'][_0x255824(0xfa)]],_0x2f5dad=[..._0x4913f6[_0x255824(0x101)]['unit']],_0x2cfbdd=[..._0x4913f6[_0x255824(0x101)]['secondary_unit']],_0x42aa2d=[..._0x4913f6['body'][_0x255824(0xc3)]],_0x4dcd1a=[..._0x4913f6['body']['expiry_date']],_0x3e74d7=[..._0x4913f6[_0x255824(0x101)][_0x255824(0xd6)]],_0xee8c06=[..._0x4913f6[_0x255824(0x101)][_0x255824(0x10c)]];const _0x28a6f2=_0x448d28[_0x255824(0x15b)](_0x5af758=>{return _0x5af758={'product_name':_0x5af758};});_0x39418a['forEach']((_0x506d66,_0x5aa3f3)=>{_0x28a6f2[_0x5aa3f3]['from_quantity']=_0x506d66;}),_0x409c7c[_0x255824(0xa5)]((_0x27f8af,_0x504491)=>{var _0x5f3263=_0x255824;_0x28a6f2[_0x504491][_0x5f3263(0xb6)]=_0x27f8af;}),_0x15cda2['forEach']((_0x596b1,_0x832482)=>{var _0x2a7f98=_0x255824;_0x28a6f2[_0x832482][_0x2a7f98(0x13a)]=_0x596b1;}),_0xebc77b[_0x255824(0xa5)]((_0x3c6970,_0x3dd218)=>{_0x28a6f2[_0x3dd218]['from_floorlevel']=_0x3c6970;}),_0x4649ae['forEach']((_0x4a47d1,_0x19bcce)=>{_0x28a6f2[_0x19bcce]['to_quantity']=_0x4a47d1;}),_0x53f9a2['forEach']((_0x500278,_0x4bbeb2)=>{var _0x2841c4=_0x255824;_0x28a6f2[_0x4bbeb2][_0x2841c4(0xce)]=_0x500278;}),_0x45845[_0x255824(0xa5)]((_0x24028a,_0x1d5fbe)=>{var _0x32d7da=_0x255824;_0x28a6f2[_0x1d5fbe][_0x32d7da(0xa4)]=_0x24028a;}),_0x40419c[_0x255824(0xa5)]((_0x5802f5,_0xd0aec4)=>{var _0x5dfd52=_0x255824;_0x28a6f2[_0xd0aec4][_0x5dfd52(0x8b)]=_0x5802f5;}),_0x446832['forEach']((_0x48acc8,_0xdabb78)=>{_0x28a6f2[_0xdabb78]['primary_code']=_0x48acc8;}),_0x550f28[_0x255824(0xa5)]((_0x1b3c1e,_0x444a08)=>{_0x28a6f2[_0x444a08]['secondary_code']=_0x1b3c1e;}),_0x3ff514[_0x255824(0xa5)]((_0x47888a,_0x4f54d5)=>{var _0x2751f7=_0x255824;_0x28a6f2[_0x4f54d5][_0x2751f7(0x9b)]=_0x47888a;}),_0x35bde3[_0x255824(0xa5)]((_0x12dde3,_0x258669)=>{var _0x4d2db4=_0x255824;_0x28a6f2[_0x258669][_0x4d2db4(0x14b)]=_0x12dde3;}),_0x2f5dad[_0x255824(0xa5)]((_0x1f69d0,_0x37eb79)=>{var _0x7df8f=_0x255824;_0x28a6f2[_0x37eb79][_0x7df8f(0xa0)]=_0x1f69d0;}),_0x2cfbdd[_0x255824(0xa5)]((_0x4c1996,_0xbe1db)=>{var _0x4ef04d=_0x255824;_0x28a6f2[_0xbe1db][_0x4ef04d(0xf9)]=_0x4c1996;}),_0x42aa2d[_0x255824(0xa5)]((_0x5e34ba,_0x526c28)=>{_0x28a6f2[_0x526c28]['batch_code']=_0x5e34ba;}),_0x4dcd1a[_0x255824(0xa5)]((_0x19162b,_0x38f5ea)=>{var _0x5d30fa=_0x255824;_0x28a6f2[_0x38f5ea][_0x5d30fa(0x147)]=_0x19162b;}),_0x2e0ac3[_0x255824(0xa5)]((_0x1c2281,_0x26517d)=>{_0x28a6f2[_0x26517d]['storage']=_0x1c2281;}),_0x43e051['forEach']((_0x1ecec2,_0x3e2ffe)=>{var _0x434280=_0x255824;_0x28a6f2[_0x3e2ffe][_0x434280(0x79)]=_0x1ecec2;}),_0x5d7d5c[_0x255824(0xa5)]((_0x7f6097,_0x5e4eff)=>{var _0x241c54=_0x255824;_0x28a6f2[_0x5e4eff][_0x241c54(0xbb)]=_0x7f6097;}),_0x39b9ad['forEach']((_0x5ab52b,_0xfbb3cf)=>{_0x28a6f2[_0xfbb3cf]['to_types']=_0x5ab52b;}),_0x3e74d7[_0x255824(0xa5)]((_0x53078e,_0xa42187)=>{var _0x287e57=_0x255824;_0x28a6f2[_0xa42187][_0x287e57(0xd6)]=_0x53078e;}),_0xee8c06[_0x255824(0xa5)]((_0x132636,_0x6f372b)=>{var _0x103e9b=_0x255824;_0x28a6f2[_0x6f372b][_0x103e9b(0x88)]=_0x132636;});const _0x8954ae=_0x28a6f2[_0x255824(0x113)](_0xa447a5=>_0xa447a5['to_quantity']!=='0'&&_0xa447a5['to_quantity']!==''||_0xa447a5['to_floorlevel']!=='0'&&_0xa447a5[_0x255824(0x8b)]!=='');var _0x53c698=0x0;_0x8954ae[_0x255824(0xa5)](_0x28361c=>{var _0x276602=_0x255824;parseInt(_0x28361c['from_quantity'])<parseInt(_0x28361c[_0x276602(0xa2)])&&_0x53c698++;});if(_0x53c698!=0x0)return _0x4913f6['flash']('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x42dfeb[_0x255824(0x108)](_0x255824(0x7f));const _0x8484a4=await warehouse[_0x255824(0xc9)]({'name':_0x262399['from_warehouse'],'room':_0x262399[_0x255824(0x11e)]});_0x262399[_0x255824(0x15d)]['forEach'](_0x5b7ca0=>{var _0x2f5c26=_0x255824;if(_0x5b7ca0[_0x2f5c26(0xa2)]>0x0){const _0x4c39df=_0x8484a4['product_details'][_0x2f5c26(0x15b)](_0x18f899=>{var _0x3e5240=_0x2f5c26;_0x18f899[_0x3e5240(0x7d)]==_0x5b7ca0['product_name']&&_0x18f899['floorlevel']==_0x5b7ca0[_0x3e5240(0x14c)]&&_0x18f899[_0x3e5240(0x141)]==_0x5b7ca0[_0x3e5240(0xbb)]&&_0x18f899[_0x3e5240(0x110)]==_0x5b7ca0[_0x3e5240(0x13a)]&&_0x18f899['bay']==_0x5b7ca0['from_bay']&&_0x18f899[_0x3e5240(0x79)]==_0x5b7ca0[_0x3e5240(0x88)]&&_0x18f899[_0x3e5240(0xf5)]==_0x5b7ca0[_0x3e5240(0xd6)]&&(_0x18f899[_0x3e5240(0x154)]=parseInt(_0x18f899[_0x3e5240(0x154)])+parseInt(_0x5b7ca0[_0x3e5240(0xa2)]));});}}),await _0x8484a4[_0x255824(0xa1)]();const _0x52cfee=await warehouse[_0x255824(0xc9)]({'name':_0x262399[_0x255824(0xeb)],'room':_0x262399[_0x255824(0x103)]});_0x262399['product'][_0x255824(0xa5)](_0x12cf06=>{var _0x3fc3ff=_0x255824;if(_0x12cf06['to_quantity']>0x0){const _0x2eb8a6=_0x52cfee['product_details'][_0x3fc3ff(0x15b)](_0x420a37=>{var _0x25530d=_0x3fc3ff;_0x420a37[_0x25530d(0x7d)]==_0x12cf06[_0x25530d(0x7d)]&&_0x420a37[_0x25530d(0x93)]==_0x12cf06[_0x25530d(0x8b)]&&_0x420a37[_0x25530d(0x141)]==_0x12cf06[_0x25530d(0x8c)]&&_0x420a37[_0x25530d(0x110)]==_0x12cf06[_0x25530d(0xa4)]&&_0x420a37[_0x25530d(0xd9)]==_0x12cf06[_0x25530d(0xce)]&&_0x420a37[_0x25530d(0x79)]==_0x12cf06['rack']&&_0x420a37[_0x25530d(0xf5)]==_0x12cf06[_0x25530d(0xf5)]&&(_0x420a37[_0x25530d(0x154)]=parseInt(_0x420a37[_0x25530d(0x154)])-parseInt(_0x12cf06[_0x25530d(0xa2)]));});}}),await _0x52cfee['save'](),_0x262399[_0x255824(0xfc)]=_0xf6a2f9,_0x262399[_0x255824(0x6f)]=_0x3e7dd2,_0x262399[_0x255824(0xeb)]=_0x2c1b01,_0x262399[_0x255824(0x15d)]=_0x8954ae,_0x262399[_0x255824(0x92)]=_0x42186a,_0x262399[_0x255824(0xc7)]=_0x5672e0;const _0xec7012=await _0x262399[_0x255824(0xa1)]();console[_0x255824(0xbe)](_0xec7012);const _0x7fbaaa=await warehouse[_0x255824(0xc9)]({'name':_0x3e7dd2,'room':_0x6b13});_0xec7012[_0x255824(0x15d)][_0x255824(0xa5)](_0x135c40=>{var _0x31bebd=_0x255824;if(_0x135c40[_0x31bebd(0xa2)]>0x0){const _0x3adf3a=_0x7fbaaa[_0x31bebd(0x148)][_0x31bebd(0x15b)](_0x12493b=>{var _0x3855f0=_0x31bebd;_0x12493b[_0x3855f0(0x7d)]==_0x135c40[_0x3855f0(0x7d)]&&_0x12493b[_0x3855f0(0x93)]==_0x135c40[_0x3855f0(0x14c)]&&_0x12493b[_0x3855f0(0x141)]==_0x135c40['from_types']&&_0x12493b[_0x3855f0(0x110)]==_0x135c40[_0x3855f0(0x13a)]&&_0x12493b[_0x3855f0(0xd9)]==_0x135c40[_0x3855f0(0xb6)]&&_0x12493b[_0x3855f0(0x79)]==_0x135c40[_0x3855f0(0x88)]&&_0x12493b[_0x3855f0(0xf5)]==_0x135c40[_0x3855f0(0xd6)]&&(_0x12493b[_0x3855f0(0x154)]=parseInt(_0x12493b[_0x3855f0(0x154)])-parseInt(_0x135c40[_0x3855f0(0xa2)]));});}}),await _0x7fbaaa[_0x255824(0xa1)]();const _0x30b21b=await warehouse[_0x255824(0xc9)]({'name':_0x2c1b01,'room':_0x2a7161});_0xec7012['product'][_0x255824(0xa5)](_0x2e25ed=>{var _0x5db362=_0x255824;if(_0x2e25ed[_0x5db362(0xa2)]>0x0){var _0x568db5=0x0;const _0x2f954e=_0x30b21b['product_details'][_0x5db362(0x15b)](_0x476289=>{var _0x17da14=_0x5db362;_0x476289[_0x17da14(0x7d)]==_0x2e25ed[_0x17da14(0x7d)]&&_0x476289[_0x17da14(0x93)]==_0x2e25ed[_0x17da14(0x8b)]&&_0x476289[_0x17da14(0x141)]==_0x2e25ed[_0x17da14(0x8c)]&&_0x476289[_0x17da14(0x110)]==_0x2e25ed[_0x17da14(0xa4)]&&_0x476289['bay']==_0x2e25ed[_0x17da14(0xce)]&&_0x476289[_0x17da14(0x79)]==_0x2e25ed[_0x17da14(0x79)]&&_0x476289[_0x17da14(0xf5)]==_0x2e25ed[_0x17da14(0xf5)]&&(_0x476289[_0x17da14(0x154)]=parseInt(_0x476289[_0x17da14(0x154)])+parseInt(_0x2e25ed[_0x17da14(0xa2)]),_0x568db5++);});_0x568db5=='0'&&(_0x30b21b[_0x5db362(0x148)]=_0x30b21b[_0x5db362(0x148)][_0x5db362(0x80)]({'product_name':_0x2e25ed['product_name'],'product_stock':_0x2e25ed[_0x5db362(0xa2)],'bay':_0x2e25ed[_0x5db362(0xce)],'bin':_0x2e25ed[_0x5db362(0xa4)],'type':_0x2e25ed[_0x5db362(0x8c)],'floorlevel':_0x2e25ed[_0x5db362(0x8b)],'storage':_0x2e25ed[_0x5db362(0xf5)],'rack':_0x2e25ed['rack'],'product_code':_0x2e25ed[_0x5db362(0x9b)],'primary_code':_0x2e25ed[_0x5db362(0xe7)],'secondary_code':_0x2e25ed[_0x5db362(0xf2)],'maxProducts':_0x2e25ed[_0x5db362(0x14b)],'storage':_0x2e25ed[_0x5db362(0xf5)],'rack':_0x2e25ed[_0x5db362(0x79)]}));}}),await _0x30b21b[_0x255824(0xa1)](),_0x4913f6[_0x255824(0x130)](_0x255824(0x121),_0x255824(0x10f)),_0x42dfeb['redirect'](_0x255824(0x114));}catch(_0x21dc23){console[_0x255824(0xbe)](_0x21dc23);}}),router[a0_0x2f7cdc(0xc1)](a0_0x2f7cdc(0xf0),async(_0x34bb3b,_0x317ba5)=>{var _0x7fc0f0=a0_0x2f7cdc;const {FromWareHouse:_0x3231f4,FromRoom:_0x362711,ToWarehouse:_0x2adbb0,ToRoom:_0x5031e2,primary_code:_0x50f3fa,Roomslist:_0x314692}=_0x34bb3b[_0x7fc0f0(0x101)],_0x3e0698=_0x314692[_0x7fc0f0(0xfd)](','),_0xe55871=[];async function _0x109107(_0x421925){var _0x5468fc=_0x7fc0f0;const _0x38afbe=await warehouse[_0x5468fc(0x98)]([{'$match':{'name':_0x3231f4,'room':_0x421925}},{'$unwind':_0x5468fc(0xe2)},{'$match':{'product_details.primary_code':_0x50f3fa}},{'$group':{'_id':_0x5468fc(0x12c),'name':{'$first':_0x5468fc(0x72)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5468fc(0xed)},'secondary_code':{'$first':_0x5468fc(0x7a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5468fc(0x11b)},'isle':{'$first':_0x5468fc(0xd7)},'type':{'$first':_0x5468fc(0x12f)},'pallet':{'$first':_0x5468fc(0x122)},'unit':{'$first':_0x5468fc(0xac)},'secondary_unit':{'$first':_0x5468fc(0x11d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5468fc(0xec)},'expiry_date':{'$first':_0x5468fc(0x9d)},'production_date':{'$first':_0x5468fc(0x99)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x5468fc(0xe5)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x5468fc(0x8f)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0xd04164=await warehouse['aggregate']([{'$match':{'name':_0x3231f4,'room':_0x421925}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x50f3fa}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5468fc(0x72)},'instock':{'$first':_0x5468fc(0x14e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5468fc(0x7a)},'product_code':{'$first':_0x5468fc(0x117)},'level':{'$first':_0x5468fc(0x11b)},'isle':{'$first':_0x5468fc(0xd7)},'type':{'$first':_0x5468fc(0x12f)},'pallet':{'$first':_0x5468fc(0x122)},'unit':{'$first':_0x5468fc(0xac)},'secondary_unit':{'$first':_0x5468fc(0x11d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5468fc(0xec)},'expiry_date':{'$first':_0x5468fc(0x9d)},'production_date':{'$first':_0x5468fc(0x99)},'batch_code':{'$first':_0x5468fc(0x76)},'maxPerUnit':{'$first':_0x5468fc(0xe5)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5468fc(0x8f)},'maxProducts':{'$first':_0x5468fc(0xda)},'invoice_product':{'$first':_0x5468fc(0x12e)}}}]);if(_0x38afbe[_0x5468fc(0xad)]>0x0)_0xe55871[_0x5468fc(0x9e)](_0x38afbe);else _0xd04164['length']>0x0&&_0xe55871[_0x5468fc(0x9e)](_0xd04164);}const _0x40ccf2=_0x3e0698[_0x7fc0f0(0x15b)](_0x2d68ad=>_0x109107(_0x2d68ad));await Promise[_0x7fc0f0(0xf1)](_0x40ccf2),_0x317ba5[_0x7fc0f0(0xb0)](_0xe55871);}),router[a0_0x2f7cdc(0xc1)](a0_0x2f7cdc(0xdc),async(_0x11b982,_0x254ddf)=>{var _0x1f1b21=a0_0x2f7cdc;try{const {FromWareHouse:_0x106eca,FromRoom:_0x3cf112,ToWarehouse:_0x203559,ToRoom:_0x28ef2e,secondary_code:_0x549449}=_0x11b982['body'],_0x3099f7=await warehouse[_0x1f1b21(0x98)]([{'$match':{'name':_0x106eca}},{'$unwind':_0x1f1b21(0xe2)},{'$match':{'product_details.secondary_code':_0x549449}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1f1b21(0x117)},'instock':{'$first':_0x1f1b21(0x14e)},'warehouse':{'$first':_0x1f1b21(0x81)},'level':{'$first':_0x1f1b21(0xaa)},'isle':{'$first':_0x1f1b21(0xff)},'pallet':{'$first':_0x1f1b21(0x8a)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x1f1b21(0xac)}}}]);_0x254ddf[_0x1f1b21(0x145)](0xc8)[_0x1f1b21(0xb0)](_0x3099f7);}catch(_0x307adc){_0x254ddf[_0x1f1b21(0x145)](0x194)['json']({'message':_0x307adc[_0x1f1b21(0x135)]});}}),router['post']('/barcode_scanner3',async(_0x2f68cc,_0x48d2cc)=>{var _0x87ca67=a0_0x2f7cdc;try{const {FromWareHouse:_0x3125c4,FromRoom:_0x270344,ToWarehouse:_0x370fe4,ToRoom:_0x52cb14,product_code:_0x527d37}=_0x2f68cc['body'],_0xef2a57=await warehouse[_0x87ca67(0x98)]([{'$match':{'name':_0x3125c4}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x527d37}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x87ca67(0x72)},'primary_code':{'$first':_0x87ca67(0xed)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x87ca67(0x117)},'instock':{'$first':_0x87ca67(0x14e)},'warehouse':{'$first':_0x87ca67(0x81)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x87ca67(0xff)},'pallet':{'$first':_0x87ca67(0x8a)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x87ca67(0xac)}}}]);_0x48d2cc['status'](0xc8)[_0x87ca67(0xb0)](_0xef2a57);}catch(_0x1d9980){_0x48d2cc[_0x87ca67(0x145)](0x194)[_0x87ca67(0xb0)]({'message':_0x1d9980[_0x87ca67(0x135)]});}}),router[a0_0x2f7cdc(0xc1)](a0_0x2f7cdc(0x13e),async(_0x561b5a,_0x4ff42f)=>{var _0x17f74b=a0_0x2f7cdc;const {level:_0x833b7a,isle:_0x4b8fce,pallet:_0x2ff832,warehouses:_0x215948,room:_0x301d3b}=_0x561b5a[_0x17f74b(0x101)];try{const _0x30f50f=await warehouse['aggregate']([{'$match':{'name':_0x215948,'room':_0x301d3b}},{'$unwind':_0x17f74b(0xe2)},{'$match':{'product_details.level':parseInt(_0x833b7a),'product_details.isle':_0x4b8fce,'product_details.pallet':parseInt(_0x2ff832)}},{'$group':{'_id':_0x17f74b(0x12c),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x17f74b(0xaa)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x17f74b(0x8a)},'maxProducts':{'$first':_0x17f74b(0xda)}}}]);_0x4ff42f[_0x17f74b(0x145)](0xc8)['json'](_0x30f50f);}catch(_0x2208c1){_0x4ff42f[_0x17f74b(0x145)](0x194)[_0x17f74b(0xb0)]({'message':_0x2208c1[_0x17f74b(0x135)]});}}),module[a0_0x2f7cdc(0xb2)]=router;