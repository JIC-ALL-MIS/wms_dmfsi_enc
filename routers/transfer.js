var a0_0x391d7e=a0_0x54b4;(function(_0x2aaa66,_0x30bb05){var _0x4055d7=a0_0x54b4,_0x26b848=_0x2aaa66();while(!![]){try{var _0x5d260a=-parseInt(_0x4055d7(0x194))/0x1+parseInt(_0x4055d7(0x17a))/0x2+-parseInt(_0x4055d7(0x117))/0x3*(parseInt(_0x4055d7(0x126))/0x4)+-parseInt(_0x4055d7(0x16f))/0x5+-parseInt(_0x4055d7(0x151))/0x6+-parseInt(_0x4055d7(0x1b6))/0x7+-parseInt(_0x4055d7(0x103))/0x8*(-parseInt(_0x4055d7(0x18d))/0x9);if(_0x5d260a===_0x30bb05)break;else _0x26b848['push'](_0x26b848['shift']());}catch(_0x130ab5){_0x26b848['push'](_0x26b848['shift']());}}}(a0_0x22d8,0xb99e8));const express=require(a0_0x391d7e(0x1a5)),app=express(),router=express[a0_0x391d7e(0x16b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x391d7e(0x125)),nodemailer=require(a0_0x391d7e(0xe0));router[a0_0x391d7e(0x119)]('/view',auth,async(_0x194e77,_0x13e5ff)=>{var _0x11b2c7=a0_0x391d7e;try{const {username:_0xc07ce7,email:_0x43910e,role:_0x2d499a}=_0x194e77[_0x11b2c7(0x10e)],_0x20c7b1=_0x194e77[_0x11b2c7(0x10e)],_0x11f01c=await profile[_0x11b2c7(0xee)]({'email':_0x20c7b1[_0x11b2c7(0x155)]}),_0x39caa3=await master_shop[_0x11b2c7(0x17f)]();console[_0x11b2c7(0x146)](_0x11b2c7(0x144),_0x39caa3);let _0x339e4f;if(_0x20c7b1[_0x11b2c7(0x140)]==_0x11b2c7(0x14c)){const _0x1d785a=await staff[_0x11b2c7(0xee)]({'email':_0x20c7b1[_0x11b2c7(0x155)]});_0x339e4f=await transfers[_0x11b2c7(0x17f)]({'from_warehouse':_0x1d785a[_0x11b2c7(0x169)]});}else _0x339e4f=await transfers['aggregate']([{'$unwind':_0x11b2c7(0xe1)},{'$group':{'_id':_0x11b2c7(0x11e),'invoice':{'$first':_0x11b2c7(0x11d)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x11b2c7(0x15a)},'to_warehouse':{'$first':_0x11b2c7(0x135)},'from_room_name':{'$addToSet':_0x11b2c7(0x102)},'to_room_name':{'$addToSet':_0x11b2c7(0x1a1)},'finalize':{'$first':_0x11b2c7(0x13f)},'isAllowEdit':{'$first':_0x11b2c7(0x156)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x39caa3[0x0][_0x11b2c7(0x141)]==_0x11b2c7(0x199)){var _0x6e6dae=users[_0x11b2c7(0x12c)];console[_0x11b2c7(0x146)](_0x6e6dae);}else{if(_0x39caa3[0x0]['language']==_0x11b2c7(0x1af))var _0x6e6dae=users['Hindi'];else{if(_0x39caa3[0x0][_0x11b2c7(0x141)]==_0x11b2c7(0x108))var _0x6e6dae=users['German'];else{if(_0x39caa3[0x0][_0x11b2c7(0x141)]=='Spanish')var _0x6e6dae=users[_0x11b2c7(0xf8)];else{if(_0x39caa3[0x0]['language']==_0x11b2c7(0x17e))var _0x6e6dae=users['French'];else{if(_0x39caa3[0x0][_0x11b2c7(0x141)]=='Portuguese\x20(BR)')var _0x6e6dae=users[_0x11b2c7(0x14d)];else{if(_0x39caa3[0x0][_0x11b2c7(0x141)]==_0x11b2c7(0x10c))var _0x6e6dae=users['Chinese'];else{if(_0x39caa3[0x0][_0x11b2c7(0x141)]==_0x11b2c7(0x17c))var _0x6e6dae=users[_0x11b2c7(0x11c)];}}}}}}}_0x13e5ff[_0x11b2c7(0xea)](_0x11b2c7(0xfe),{'success':_0x194e77['flash']('success'),'errors':_0x194e77[_0x11b2c7(0x1ad)](_0x11b2c7(0x15e)),'role':_0x20c7b1,'profile':_0x11f01c,'master_shop':_0x39caa3,'transfer':_0x339e4f,'language':_0x6e6dae});}catch(_0x39d04a){console[_0x11b2c7(0x146)](_0x39d04a);}});async function getRandom8DigitNumber(){var _0x304c44=a0_0x391d7e;const _0x3abcf1=0x989680,_0x5b32b0=0x5f5e0ff,_0x6b9f5b=Math['floor'](Math[_0x304c44(0x1a0)]()*(_0x5b32b0-_0x3abcf1+0x1))+_0x3abcf1;var _0x49c278;const _0x4de582=await transfers['findOne']({'invoice':_0x304c44(0x14a)+_0x6b9f5b});return _0x4de582&&_0x4de582['length']>0x0?_0x49c278=_0x304c44(0x14a)+_0x6b9f5b:_0x49c278=_0x304c44(0x14a)+_0x6b9f5b,_0x49c278;}router[a0_0x391d7e(0x119)](a0_0x391d7e(0x110),auth,async(_0x34c9f5,_0xd79dbd)=>{var _0x2ea43d=a0_0x391d7e;try{const {username:_0x1a5ba0,email:_0xaad7df,role:_0x4c1c11}=_0x34c9f5[_0x2ea43d(0x10e)],_0x41b9b5=_0x34c9f5[_0x2ea43d(0x10e)],_0x575410=await profile[_0x2ea43d(0xee)]({'email':_0x41b9b5['email']}),_0x16b262=await master_shop[_0x2ea43d(0x17f)]();console[_0x2ea43d(0x146)](_0x2ea43d(0x144),_0x16b262);let _0x2bfdb2;if(_0x41b9b5[_0x2ea43d(0x140)]==_0x2ea43d(0x14c)){const _0x23f37d=await staff[_0x2ea43d(0xee)]({'email':_0x41b9b5[_0x2ea43d(0x155)]});_0x2bfdb2=await warehouse[_0x2ea43d(0x164)]([{'$match':{'status':_0x2ea43d(0x19b),'name':_0x23f37d[_0x2ea43d(0x169)],'warehouse_category':_0x2ea43d(0x120)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x2bfdb2=await warehouse[_0x2ea43d(0x164)]([{'$match':{'status':'Enabled','warehouse_category':_0x2ea43d(0x120)}},{'$group':{'_id':_0x2ea43d(0x106),'name':{'$first':_0x2ea43d(0x106)}}}]);var _0x2bfbab=[_0x2ea43d(0x1a2),_0x2ea43d(0x111),'Return\x20Rooms'];const _0x41b2f0=await transfers['find']({}),_0x5edfc6=_0x41b2f0[_0x2ea43d(0x145)]+0x1,_0x5ca542=_0x2ea43d(0x14a)+_0x5edfc6['toString']()[_0x2ea43d(0x138)](0x5,'0');if(_0x16b262[0x0]['language']==_0x2ea43d(0x199)){var _0x5d81b9=users[_0x2ea43d(0x12c)];console[_0x2ea43d(0x146)](_0x5d81b9);}else{if(_0x16b262[0x0][_0x2ea43d(0x141)]=='Hindi')var _0x5d81b9=users['Hindi'];else{if(_0x16b262[0x0]['language']=='German')var _0x5d81b9=users[_0x2ea43d(0x108)];else{if(_0x16b262[0x0]['language']=='Spanish')var _0x5d81b9=users[_0x2ea43d(0xf8)];else{if(_0x16b262[0x0][_0x2ea43d(0x141)]=='French')var _0x5d81b9=users['French'];else{if(_0x16b262[0x0][_0x2ea43d(0x141)]==_0x2ea43d(0x1b0))var _0x5d81b9=users[_0x2ea43d(0x14d)];else{if(_0x16b262[0x0][_0x2ea43d(0x141)]==_0x2ea43d(0x10c))var _0x5d81b9=users[_0x2ea43d(0x10c)];else{if(_0x16b262[0x0][_0x2ea43d(0x141)]==_0x2ea43d(0x17c))var _0x5d81b9=users['Arabic'];}}}}}}}const _0x637179=getRandom8DigitNumber();_0x637179['then'](_0x187037=>{var _0x8db3a8=_0x2ea43d;_0xd79dbd[_0x8db3a8(0xea)](_0x8db3a8(0x18a),{'success':_0x34c9f5[_0x8db3a8(0x1ad)](_0x8db3a8(0x162)),'errors':_0x34c9f5['flash'](_0x8db3a8(0x15e)),'role':_0x41b9b5,'profile':_0x575410,'master_shop':_0x16b262,'warehouse':_0x2bfdb2,'language':_0x5d81b9,'rooms_data':_0x2bfbab,'invoice':_0x187037});})[_0x2ea43d(0x127)](_0x24e25b=>{var _0x4619e2=_0x2ea43d;_0x34c9f5[_0x4619e2(0x1ad)](_0x4619e2(0x15e),_0x4619e2(0x1ae)),_0xd79dbd[_0x4619e2(0xf1)](_0x4619e2(0x157));});}catch(_0x1e53d4){console['log'](_0x1e53d4);}}),router[a0_0x391d7e(0x13a)]('/view/add_transfer',auth,async(_0x135b86,_0x36ab4d)=>{var _0x2468c8=a0_0x391d7e;try{console['log'](_0x135b86[_0x2468c8(0x137)]);const {date:_0x43dcec,from_warehouse:_0x4cea4e,FromRoom_name:_0x19ff7a,to_warehouse:_0x49a560,ToRoom_name:_0x3beeeb,prod_name:_0x5e5acd,from_prod_qty:_0x34211c,from_prod_level:_0x218b7f,from_prod_isle:_0x52875c,from_prod_pallet:_0x2f4c74,to_prod_qty:_0x2edd62,to_prod_level:_0x3f20cd,to_prod_isle:_0x8f9a23,to_prod_pallet:_0x2faf21,primary_code:_0x54b167,secondary_code:_0xe71613,product_code3:_0x38ef84,note:_0x389916,MaxStocks_data2:_0x220905,invoice:_0x504268,expiry_date:_0x1e3198}=_0x135b86[_0x2468c8(0x137)];if(typeof _0x5e5acd==_0x2468c8(0x115))var _0x54a43f=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x149)]],_0x15746b=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x19f)]],_0x2a4952=[_0x135b86['body'][_0x2468c8(0x12a)]],_0xbe532d=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x168)]],_0x20c52c=[_0x135b86[_0x2468c8(0x137)]['to_prod_level']],_0x5d2001=[_0x135b86[_0x2468c8(0x137)]['primary_code']],_0x520967=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0xf3)]],_0x1f5ba0=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x148)]],_0x1f87e6=[_0x135b86[_0x2468c8(0x137)]['MaxStocks_data2']],_0x676918=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x10d)]],_0x192954=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x172)]],_0x247559=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x136)]],_0x5c9765=[_0x135b86['body'][_0x2468c8(0xeb)]],_0x3077f3=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0xfa)]],_0x2b78bf=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x178)]],_0x1b60a4=[_0x135b86['body']['prod_cat']],_0x59cf46=[_0x135b86[_0x2468c8(0x137)]['RoomAssigned']],_0x2f8366=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x175)]],_0x234ce3=[_0x135b86['body']['from_invoice']],_0x3cbe39=[_0x135b86[_0x2468c8(0x137)][_0x2468c8(0x188)]];else var _0x54a43f=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x149)]],_0x15746b=[..._0x135b86['body'][_0x2468c8(0x19f)]],_0x2a4952=[..._0x135b86['body'][_0x2468c8(0x12a)]],_0xbe532d=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x168)]],_0x20c52c=[..._0x135b86['body']['to_prod_level']],_0x5d2001=[..._0x135b86[_0x2468c8(0x137)]['primary_code']],_0x520967=[..._0x135b86[_0x2468c8(0x137)]['secondary_code']],_0x1f5ba0=[..._0x135b86[_0x2468c8(0x137)]['product_code3']],_0x1f87e6=[..._0x135b86['body']['MaxStocks_data2']],_0x676918=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x10d)]],_0x192954=[..._0x135b86[_0x2468c8(0x137)]['secondary_unit']],_0x247559=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x136)]],_0x5c9765=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0xeb)]],_0x3077f3=[..._0x135b86[_0x2468c8(0x137)]['max_per_unit']],_0x2b78bf=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x178)]],_0x1b60a4=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x16a)]],_0x59cf46=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x129)]],_0x2f8366=[..._0x135b86[_0x2468c8(0x137)]['ToRoomAssigned']],_0x234ce3=[..._0x135b86[_0x2468c8(0x137)]['from_invoice']],_0x3cbe39=[..._0x135b86[_0x2468c8(0x137)][_0x2468c8(0x188)]];const _0x1c1f7b=_0x54a43f[_0x2468c8(0x184)](_0x100b87=>{return _0x100b87={'product_name':_0x100b87};});_0x15746b[_0x2468c8(0x139)]((_0x403725,_0x4d62df)=>{var _0x49209d=_0x2468c8;_0x1c1f7b[_0x4d62df][_0x49209d(0x159)]=_0x403725;}),_0x234ce3[_0x2468c8(0x139)]((_0x1723e0,_0x23bab5)=>{var _0x41c15e=_0x2468c8;_0x1c1f7b[_0x23bab5][_0x41c15e(0x182)]=_0x1723e0;}),_0x3cbe39[_0x2468c8(0x139)]((_0x207a23,_0x4f1a9a)=>{var _0x344345=_0x2468c8;_0x1c1f7b[_0x4f1a9a][_0x344345(0x107)]=_0x207a23;}),_0x2a4952['forEach']((_0x4d1d7a,_0xdb2d59)=>{var _0x5483c3=_0x2468c8;_0x59cf46[_0x5483c3(0x139)]((_0x1f6484,_0x29ca6f)=>{var _0x58eee9=_0x5483c3;if(_0x1f6484=='Receiving\x20Area'&&_0xdb2d59==_0x29ca6f){var _0x516b34=_0x4d1d7a[_0x58eee9(0x15d)](0x3);_0x1c1f7b[_0xdb2d59][_0x58eee9(0x15c)]=_0x4d1d7a[0x0],_0x1c1f7b[_0xdb2d59][_0x58eee9(0x16d)]=_0x4d1d7a[0x1],_0x1c1f7b[_0xdb2d59][_0x58eee9(0x174)]=0x0,_0x1c1f7b[_0xdb2d59][_0x58eee9(0x147)]=0x0,_0x1c1f7b[_0xdb2d59][_0x58eee9(0x177)]='Floor',_0x1c1f7b[_0xdb2d59][_0x58eee9(0x195)]=_0x516b34;}else{if(_0x1f6484==_0x58eee9(0x12d)&&_0xdb2d59==_0x29ca6f){var _0x516b34=_0x4d1d7a[_0x58eee9(0x15d)](0x3);_0x1c1f7b[_0xdb2d59][_0x58eee9(0x15c)]=_0x4d1d7a[0x0],_0x1c1f7b[_0xdb2d59][_0x58eee9(0x16d)]=_0x4d1d7a[0x1],_0x1c1f7b[_0xdb2d59][_0x58eee9(0x174)]=0x0,_0x1c1f7b[_0xdb2d59]['from_bin']=0x0,_0x1c1f7b[_0xdb2d59]['from_types']=_0x58eee9(0x12f),_0x1c1f7b[_0xdb2d59][_0x58eee9(0x195)]=_0x4d1d7a[0x5];}else{if(_0xdb2d59==_0x29ca6f){var _0x1cb9d1;if(_0x4d1d7a[0x4]=='L')_0x1cb9d1=_0x58eee9(0x143);else _0x4d1d7a[0x4]=='F'&&(_0x1cb9d1='Floor');_0x1c1f7b[_0xdb2d59][_0x58eee9(0x15c)]=_0x4d1d7a[0x0],_0x1c1f7b[_0xdb2d59]['from_rack']=_0x4d1d7a[0x1],_0x1c1f7b[_0xdb2d59][_0x58eee9(0x174)]=_0x4d1d7a[0x2],_0x1c1f7b[_0xdb2d59][_0x58eee9(0x147)]=_0x4d1d7a[0x3],_0x1c1f7b[_0xdb2d59][_0x58eee9(0x177)]=_0x1cb9d1,_0x1c1f7b[_0xdb2d59][_0x58eee9(0x195)]=_0x4d1d7a[0x5];}}}});}),_0xbe532d[_0x2468c8(0x139)]((_0x24851f,_0x136c12)=>{var _0x242cbe=_0x2468c8;_0x1c1f7b[_0x136c12][_0x242cbe(0xe8)]=_0x24851f;}),_0x20c52c[_0x2468c8(0x139)]((_0x5758ed,_0x1b05a3)=>{var _0x19d29b=_0x2468c8;_0x2f8366[_0x19d29b(0x139)]((_0x2de942,_0x35733b)=>{var _0x5f1183=_0x19d29b;if(_0x2de942==_0x5f1183(0x167)&&_0x1b05a3==_0x35733b){var _0x434157=_0x5758ed[_0x5f1183(0x15d)](0x3);_0x1c1f7b[_0x1b05a3][_0x5f1183(0x1b7)]=_0x5758ed[0x0],_0x1c1f7b[_0x1b05a3][_0x5f1183(0x11b)]=_0x5758ed[0x1],_0x1c1f7b[_0x1b05a3]['to_bay']=0x0,_0x1c1f7b[_0x1b05a3][_0x5f1183(0x150)]=0x0,_0x1c1f7b[_0x1b05a3]['to_types']=_0x5f1183(0x12f),_0x1c1f7b[_0x1b05a3]['to_floorlevel']=_0x434157;}else{if(_0x2de942==_0x5f1183(0x12d)&&_0x1b05a3==_0x35733b){var _0x434157=_0x5758ed[_0x5f1183(0x15d)](0x3);_0x1c1f7b[_0x1b05a3][_0x5f1183(0x1b7)]=_0x5758ed[0x0],_0x1c1f7b[_0x1b05a3][_0x5f1183(0x11b)]=_0x5758ed[0x1],_0x1c1f7b[_0x1b05a3]['to_bay']=0x0,_0x1c1f7b[_0x1b05a3][_0x5f1183(0x150)]=0x0,_0x1c1f7b[_0x1b05a3]['to_types']=_0x5f1183(0x12f),_0x1c1f7b[_0x1b05a3][_0x5f1183(0x1ab)]=_0x5758ed[0x5];}else{if(_0x1b05a3==_0x35733b){var _0x3c0cf5;if(_0x5758ed[0x4]=='L')_0x3c0cf5=_0x5f1183(0x143);else _0x5758ed[0x4]=='F'&&(_0x3c0cf5=_0x5f1183(0x12f));_0x1c1f7b[_0x1b05a3][_0x5f1183(0x1b7)]=_0x5758ed[0x0],_0x1c1f7b[_0x1b05a3][_0x5f1183(0x11b)]=_0x5758ed[0x1],_0x1c1f7b[_0x1b05a3][_0x5f1183(0x100)]=_0x5758ed[0x2],_0x1c1f7b[_0x1b05a3][_0x5f1183(0x150)]=_0x5758ed[0x3],_0x1c1f7b[_0x1b05a3][_0x5f1183(0x186)]=_0x3c0cf5,_0x1c1f7b[_0x1b05a3][_0x5f1183(0x1ab)]=_0x5758ed[0x5];}}}});}),_0x5d2001[_0x2468c8(0x139)]((_0x4b1931,_0x4662fc)=>{var _0x4ab4e=_0x2468c8;_0x1c1f7b[_0x4662fc][_0x4ab4e(0x12e)]=_0x4b1931;}),_0x520967[_0x2468c8(0x139)]((_0x55aa30,_0x5371ec)=>{_0x1c1f7b[_0x5371ec]['secondary_code']=_0x55aa30;}),_0x1f5ba0['forEach']((_0x2d4d4,_0x1ea0ba)=>{var _0x411142=_0x2468c8;_0x1c1f7b[_0x1ea0ba][_0x411142(0x189)]=_0x2d4d4;}),_0x1f87e6[_0x2468c8(0x139)]((_0x5cee61,_0x25e238)=>{_0x1c1f7b[_0x25e238]['maxProducts']=_0x5cee61;}),_0x676918[_0x2468c8(0x139)]((_0x1c6406,_0x241d57)=>{var _0x289003=_0x2468c8;_0x1c1f7b[_0x241d57][_0x289003(0x109)]=_0x1c6406;}),_0x192954[_0x2468c8(0x139)]((_0x58c17c,_0x2d1643)=>{var _0x84abe9=_0x2468c8;_0x1c1f7b[_0x2d1643][_0x84abe9(0x172)]=_0x58c17c;}),_0x247559[_0x2468c8(0x139)]((_0x2418d0,_0x32eb6e)=>{var _0x19b3c5=_0x2468c8;_0x1c1f7b[_0x32eb6e][_0x19b3c5(0x136)]=_0x2418d0;}),_0x5c9765[_0x2468c8(0x139)]((_0x504ab3,_0x5deeec)=>{_0x1c1f7b[_0x5deeec]['expiry_date']=_0x504ab3;}),_0x3077f3[_0x2468c8(0x139)]((_0x4e3cce,_0x558c35)=>{var _0x18081b=_0x2468c8;_0x1c1f7b[_0x558c35][_0x18081b(0x14e)]=_0x4e3cce;}),_0x2b78bf['forEach']((_0x1ad192,_0x36986f)=>{_0x1c1f7b[_0x36986f]['production_date']=_0x1ad192;}),_0x1b60a4['forEach']((_0x4949c6,_0x1062e2)=>{_0x1c1f7b[_0x1062e2]['prod_cat']=_0x4949c6;}),_0x59cf46['forEach']((_0x5f0e49,_0x1e5244)=>{_0x1c1f7b[_0x1e5244]['from_room_name']=_0x5f0e49;}),_0x2f8366[_0x2468c8(0x139)]((_0x36d25c,_0x20f583)=>{var _0x579148=_0x2468c8;_0x1c1f7b[_0x20f583][_0x579148(0x17d)]=_0x36d25c;});const _0x422929=_0x1c1f7b[_0x2468c8(0x13b)](_0x391d4c=>_0x391d4c[_0x2468c8(0xe8)]!=='0'&&_0x391d4c[_0x2468c8(0xe8)]!==''||_0x391d4c[_0x2468c8(0x1ab)]!=='0'&&_0x391d4c[_0x2468c8(0x1ab)]!==''),_0x72fe41=new transfers({'date':_0x43dcec,'from_warehouse':_0x4cea4e,'to_warehouse':_0x49a560,'product':_0x422929,'note':_0x389916,'invoice':_0x504268}),_0x6de81c=await _0x72fe41[_0x2468c8(0x19e)]();_0x135b86[_0x2468c8(0x1ad)]('success','Product\x20Transfer\x20successfully'),_0x36ab4d[_0x2468c8(0xf1)](_0x2468c8(0xfd)+_0x6de81c[_0x2468c8(0xf5)]);}catch(_0x1be114){console['log'](_0x1be114),_0x36ab4d['status'](0xc8)[_0x2468c8(0x160)]({'errorMessage':_0x1be114['message']});}}),router[a0_0x391d7e(0x119)](a0_0x391d7e(0x132),auth,async(_0x25346f,_0x30c857)=>{var _0x3be5ec=a0_0x391d7e;try{const {username:_0x2e5999,email:_0x3de182,role:_0x114cfb}=_0x25346f['user'],_0xf85f0e=_0x25346f[_0x3be5ec(0x10e)],_0x5b167c=await profile[_0x3be5ec(0xee)]({'email':_0xf85f0e['email']}),_0x3df226=await master_shop[_0x3be5ec(0x17f)]();console[_0x3be5ec(0x146)](_0x3be5ec(0x144),_0x3df226);const _0x41ba36=await transfers[_0x3be5ec(0x185)](_0x25346f[_0x3be5ec(0x166)]['id']);let _0x544562=new Date(_0x41ba36[_0x3be5ec(0xeb)]),_0x2ae32f=('0'+_0x544562['getDate']())[_0x3be5ec(0x15d)](-0x2),_0x21649f=('0'+(_0x544562['getMonth']()+0x1))[_0x3be5ec(0x15d)](-0x2),_0x5d1f0e=_0x544562[_0x3be5ec(0x1b1)](),_0x379d97=_0x5d1f0e+'-'+_0x21649f+'-'+_0x2ae32f,_0x414730;if(_0xf85f0e[_0x3be5ec(0x140)]==_0x3be5ec(0x14c)){const _0x44d528=await staff[_0x3be5ec(0xee)]({'email':_0xf85f0e[_0x3be5ec(0x155)]});_0x414730=await warehouse[_0x3be5ec(0x17f)]({'status':_0x3be5ec(0x19b),'name':_0x44d528[_0x3be5ec(0x169)],'warehouse_category':'Raw\x20Materials'});}else _0x414730=await warehouse['find']({'status':_0x3be5ec(0x19b),'warehouse_category':'Raw\x20Materials'});const _0x4c273f=await warehouse['aggregate']([{'$match':{'name':_0x41ba36['from_warehouse']}},{'$unwind':_0x3be5ec(0x104)},{'$group':{'_id':_0x3be5ec(0x196),'name':{'$first':_0x3be5ec(0x192)},'product_stock':{'$first':_0x3be5ec(0x18f)},'bay':{'$first':_0x3be5ec(0x14f)},'bin':{'$first':_0x3be5ec(0x16e)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3be5ec(0x187)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3be5ec(0x198)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3be5ec(0xf4)},'rack':{'$first':_0x3be5ec(0x15b)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3be5ec(0x133)},'room':{'$first':_0x3be5ec(0x1b5)}}}]);if(_0x3df226[0x0]['language']==_0x3be5ec(0x199)){var _0x3ab0d9=users[_0x3be5ec(0x12c)];console[_0x3be5ec(0x146)](_0x3ab0d9);}else{if(_0x3df226[0x0][_0x3be5ec(0x141)]==_0x3be5ec(0x1af))var _0x3ab0d9=users[_0x3be5ec(0x1af)];else{if(_0x3df226[0x0][_0x3be5ec(0x141)]=='German')var _0x3ab0d9=users[_0x3be5ec(0x108)];else{if(_0x3df226[0x0][_0x3be5ec(0x141)]==_0x3be5ec(0xf8))var _0x3ab0d9=users[_0x3be5ec(0xf8)];else{if(_0x3df226[0x0][_0x3be5ec(0x141)]==_0x3be5ec(0x17e))var _0x3ab0d9=users[_0x3be5ec(0x17e)];else{if(_0x3df226[0x0]['language']==_0x3be5ec(0x1b0))var _0x3ab0d9=users[_0x3be5ec(0x14d)];else{if(_0x3df226[0x0][_0x3be5ec(0x141)]==_0x3be5ec(0x10c))var _0x3ab0d9=users[_0x3be5ec(0x10c)];else{if(_0x3df226[0x0][_0x3be5ec(0x141)]==_0x3be5ec(0x17c))var _0x3ab0d9=users[_0x3be5ec(0x11c)];}}}}}}}_0x30c857[_0x3be5ec(0xea)]('edit_transfer_view',{'success':_0x25346f[_0x3be5ec(0x1ad)](_0x3be5ec(0x162)),'errors':_0x25346f[_0x3be5ec(0x1ad)](_0x3be5ec(0x15e)),'role':_0xf85f0e,'profile':_0x5b167c,'master_shop':_0x3df226,'warehouse':_0x414730,'transfer':_0x41ba36,'stock':_0x4c273f,'language':_0x3ab0d9});}catch(_0x2c73cb){console[_0x3be5ec(0x146)](_0x2c73cb);}}),router[a0_0x391d7e(0x13a)](a0_0x391d7e(0x132),auth,async(_0x49cc64,_0x4af856)=>{var _0x17f3e1=a0_0x391d7e;try{const _0x119566=_0x49cc64['params']['id'],{from_warehouse:_0x117c7d,FromRoom_name:_0x51c071,to_warehouse:_0x37e081,ToRoom_name:_0x59c360}=_0x49cc64[_0x17f3e1(0x137)],_0x51e7fa=await transfers[_0x17f3e1(0x185)]({'_id':_0x119566}),_0x3edb27=_0x51e7fa['product'][_0x17f3e1(0x184)](async _0x29d931=>{var _0x380194=_0x17f3e1;if(_0x29d931[_0x380194(0xe8)]>0x0){var _0x2dcd38=await warehouse[_0x380194(0xee)]({'name':_0x51e7fa['from_warehouse'],'room':_0x29d931[_0x380194(0x1a3)],'warehouse_category':_0x380194(0x120)});const _0x585f77=_0x2dcd38[_0x380194(0x165)][_0x380194(0x184)](_0x51caf0=>{var _0x2a429a=_0x380194;_0x51caf0[_0x2a429a(0x154)]==_0x29d931[_0x2a429a(0x154)]&&_0x51caf0[_0x2a429a(0x118)]==_0x29d931[_0x2a429a(0x195)]&&_0x51caf0[_0x2a429a(0x114)]==_0x29d931[_0x2a429a(0x177)]&&_0x51caf0['bin']==_0x29d931[_0x2a429a(0x147)]&&_0x51caf0[_0x2a429a(0x18b)]==_0x29d931['from_bay']&&_0x51caf0[_0x2a429a(0x11b)]==_0x29d931['from_rack']&&_0x51caf0['storage']==_0x29d931[_0x2a429a(0x15c)]&&_0x51caf0[_0x2a429a(0xeb)]==_0x29d931[_0x2a429a(0xeb)]&&_0x51caf0[_0x2a429a(0x136)]==_0x29d931['batch_code']&&_0x51caf0[_0x2a429a(0x178)]==_0x29d931['production_date']&&_0x51caf0[_0x2a429a(0x181)]==_0x29d931['from_invoice']&&(_0x51caf0[_0x2a429a(0xfc)]=_0x51caf0[_0x2a429a(0xfc)]-_0x29d931[_0x2a429a(0xe8)]);});}return _0x2dcd38;});Promise[_0x17f3e1(0x1b4)](_0x3edb27)[_0x17f3e1(0x171)](async _0x220e9f=>{var _0x133b76=_0x17f3e1;try{for(const _0x4dd278 of _0x220e9f){await _0x4dd278[_0x133b76(0x19e)]();}try{const _0x590414=_0x51e7fa['product'][_0x133b76(0x184)](async _0x4dd4b5=>{var _0xd328c9=_0x133b76;if(_0x4dd4b5['to_quantity']>0x0){var _0x3912ed=await warehouse['findOne']({'name':_0x51e7fa[_0xd328c9(0x1a4)],'room':_0x4dd4b5[_0xd328c9(0x17d)],'warehouse_category':_0xd328c9(0x120)}),_0x4ba5fd=0x0;const _0xccb5aa=_0x3912ed[_0xd328c9(0x165)]['map'](_0x670140=>{var _0x3251ee=_0xd328c9;_0x670140['product_name']==_0x4dd4b5[_0x3251ee(0x154)]&&_0x670140[_0x3251ee(0x118)]==_0x4dd4b5['to_floorlevel']&&_0x670140['type']==_0x4dd4b5['to_types']&&_0x670140[_0x3251ee(0x13e)]==_0x4dd4b5[_0x3251ee(0x150)]&&_0x670140[_0x3251ee(0x18b)]==_0x4dd4b5[_0x3251ee(0x100)]&&_0x670140[_0x3251ee(0x11b)]==_0x4dd4b5[_0x3251ee(0x11b)]&&_0x670140[_0x3251ee(0x1b7)]==_0x4dd4b5[_0x3251ee(0x1b7)]&&_0x670140[_0x3251ee(0xeb)]==_0x4dd4b5[_0x3251ee(0xeb)]&&_0x670140[_0x3251ee(0x136)]==_0x4dd4b5['batch_code']&&_0x670140[_0x3251ee(0x178)]==_0x4dd4b5['production_date']&&_0x670140[_0x3251ee(0x181)]==_0x4dd4b5[_0x3251ee(0x107)]&&(_0x670140['product_stock']=_0x670140[_0x3251ee(0xfc)]+_0x4dd4b5[_0x3251ee(0xe8)],_0x4ba5fd++);});_0x4ba5fd=='0'&&(_0x3912ed[_0xd328c9(0x165)]=_0x3912ed[_0xd328c9(0x165)][_0xd328c9(0x1a9)]({'product_name':_0x4dd4b5[_0xd328c9(0x154)],'product_stock':_0x4dd4b5[_0xd328c9(0xe8)],'bay':_0x4dd4b5[_0xd328c9(0x100)],'bin':_0x4dd4b5[_0xd328c9(0x150)],'type':_0x4dd4b5[_0xd328c9(0x186)],'floorlevel':_0x4dd4b5['to_floorlevel'],'storage':_0x4dd4b5[_0xd328c9(0x1b7)],'rack':_0x4dd4b5[_0xd328c9(0x11b)],'product_code':_0x4dd4b5[_0xd328c9(0x189)],'primary_code':_0x4dd4b5[_0xd328c9(0x12e)],'secondary_code':_0x4dd4b5[_0xd328c9(0xf3)],'maxProducts':_0x4dd4b5[_0xd328c9(0x18c)],'storage':_0x4dd4b5[_0xd328c9(0x1b7)],'rack':_0x4dd4b5[_0xd328c9(0x11b)],'expiry_date':_0x4dd4b5[_0xd328c9(0xeb)],'maxPerUnit':_0x4dd4b5[_0xd328c9(0x14e)],'batch_code':_0x4dd4b5[_0xd328c9(0x136)],'production_date':_0x4dd4b5['production_date']}));}return _0x3912ed;});Promise[_0x133b76(0x1b4)](_0x590414)[_0x133b76(0x171)](async _0x4e08cf=>{var _0x15a581=_0x133b76;try{for(const _0x1ffb12 of _0x4e08cf){await warehouse[_0x15a581(0x10f)]({'_id':_0x1ffb12[_0x15a581(0xf5)]},{'$addToSet':{'product_details':{'$each':_0x1ffb12[_0x15a581(0x165)]}}});}_0x51e7fa['finalize']=_0x15a581(0x152);const _0x2c4ea6=await _0x51e7fa['save'](),_0x1d07d3=await master_shop[_0x15a581(0x17f)](),_0x30039d=await email_settings[_0x15a581(0xee)](),_0x533d90=await supervisor_settings[_0x15a581(0x17f)]();var _0x495eaf=_0x51e7fa[_0x15a581(0x197)],_0x191ef1='',_0x416b4c;for(_0x416b4c in _0x495eaf){_0x191ef1+=_0x15a581(0xe4)+_0x15a581(0x17b)+_0x495eaf[_0x416b4c]['product_name']+_0x15a581(0x15f)+_0x15a581(0x17b)+_0x495eaf[_0x416b4c][_0x15a581(0x189)]+'</td>'+_0x15a581(0x17b)+_0x495eaf[_0x416b4c]['to_quantity']+_0x15a581(0x15f)+_0x15a581(0x17b)+_0x495eaf[_0x416b4c][_0x15a581(0x109)]+_0x15a581(0x15f)+_0x15a581(0x17b)+_0x495eaf[_0x416b4c][_0x15a581(0x172)]+'</td>'+_0x15a581(0x17b)+_0x51e7fa[_0x15a581(0x1a4)]+_0x15a581(0x15f)+_0x15a581(0x17b)+_0x495eaf[_0x416b4c][_0x15a581(0x17d)]+'</td>'+_0x15a581(0x17b)+_0x495eaf[_0x416b4c][_0x15a581(0x1b7)]+_0x495eaf[_0x416b4c][_0x15a581(0x11b)]+_0x495eaf[_0x416b4c][_0x15a581(0x100)]+_0x495eaf[_0x416b4c]['to_bin']+_0x495eaf[_0x416b4c][_0x15a581(0x186)][0x0]+_0x495eaf[_0x416b4c]['to_floorlevel']+_0x15a581(0x15f),_0x15a581(0x1b3);}let _0x41cec5=nodemailer[_0x15a581(0x113)]({'host':_0x30039d[_0x15a581(0x10a)],'port':Number(_0x30039d[_0x15a581(0x190)]),'secure':![],'auth':{'user':_0x30039d[_0x15a581(0x155)],'pass':_0x30039d['password']}}),_0x11d08a={'from':_0x30039d[_0x15a581(0x155)],'to':_0x533d90[0x0][_0x15a581(0x180)],'subject':_0x15a581(0xed),'attachments':[{'filename':_0x15a581(0x123),'path':__dirname+_0x15a581(0x11f)+_0x15a581(0x1bb)+_0x1d07d3[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x15a581(0x170)+_0x15a581(0x158)+_0x15a581(0x124)+_0x15a581(0x1bc)+_0x15a581(0x124)+_0x15a581(0xe6)+_0x15a581(0x1b9)+_0x15a581(0x124)+_0x15a581(0x11a)+_0x1d07d3[0x0][_0x15a581(0xf7)]+'\x20</h2>'+_0x15a581(0x1b9)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x15a581(0x124)+_0x15a581(0x19d)+'\x20Order\x20Number\x20:\x20'+_0x51e7fa[_0x15a581(0x181)]+'\x20'+_0x15a581(0x19a)+_0x15a581(0xfb)+_0x51e7fa['date']+'\x20'+'</span>'+_0x15a581(0xe7)+_0x15a581(0x1b9)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x15a581(0x1aa)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x15a581(0x161)+_0x15a581(0x14b)+_0x15a581(0x142)+_0x15a581(0x1b3)+_0x15a581(0x116)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x191ef1+'\x20'+_0x15a581(0x122)+_0x15a581(0xf0)+_0x15a581(0x124)+_0x15a581(0xec)+_0x15a581(0xe9)+_0x1d07d3[0x0][_0x15a581(0xf7)]+_0x15a581(0xe7)+_0x15a581(0x1b9)+_0x15a581(0x1b9)+'</body></html>'};_0x41cec5['sendMail'](_0x11d08a,function(_0x387593,_0x5cff95){var _0x19dc57=_0x15a581;_0x387593?(console['log'](_0x387593),console[_0x19dc57(0x146)]('Error\x20Occurs')):console[_0x19dc57(0x146)](_0x19dc57(0x1a6));}),_0x49cc64[_0x15a581(0x1ad)](_0x15a581(0x162),_0x15a581(0x1b2)),_0x4af856[_0x15a581(0xf1)](_0x15a581(0xe3)+_0x2c4ea6[_0x15a581(0xf5)]);}catch(_0x34fa53){console[_0x15a581(0x176)](_0x34fa53),_0x4af856[_0x15a581(0x13d)](0x1f4)['json']({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x34fa53['message']});}})[_0x133b76(0x127)](_0x2e6cbd=>{var _0x5279c5=_0x133b76;console[_0x5279c5(0x176)](_0x2e6cbd),_0x4af856['status'](0x1f4)['json']({'Perror':_0x5279c5(0x1a7)});});}catch(_0x26090b){_0x4af856[_0x133b76(0x160)](_0x26090b);}}catch(_0x131674){console[_0x133b76(0x176)](_0x131674),_0x4af856[_0x133b76(0x13d)](0x1f4)[_0x133b76(0x160)]({'Merror':_0x133b76(0x1ba),'Message':_0x131674[_0x133b76(0x183)]});}})['catch'](_0xca55ac=>{var _0x46c3b4=_0x17f3e1;console['error'](_0xca55ac),_0x4af856[_0x46c3b4(0x13d)](0x1f4)[_0x46c3b4(0x160)]({'Merror':_0x46c3b4(0x1a7)});});}catch(_0x15d447){console['log'](_0x15d447);}});function a0_0x54b4(_0x1a2705,_0x468f20){var _0x22d87f=a0_0x22d8();return a0_0x54b4=function(_0x54b48e,_0x2c2cbf){_0x54b48e=_0x54b48e-0xe0;var _0x13e992=_0x22d87f[_0x54b48e];return _0x13e992;},a0_0x54b4(_0x1a2705,_0x468f20);}function BayBinSelected(_0x3371d2,_0x37ad50){var _0x293a49=a0_0x391d7e,_0x53d55d=[],_0x4853bd=[],_0x507c76=[],_0x5d9a01=[],_0x545b2d=[],_0x4d6623=[];let _0x2765c3=[];if(_0x3371d2=='DRY\x20STORAGE')switch(_0x37ad50){case _0x293a49(0x16c):_0x53d55d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4853bd=[0x1,0x2],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=[_0x293a49(0x143),'Floor'],_0x545b2d=['D'],_0x4d6623=['A'];break;case'Rack\x20B':_0x53d55d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4853bd=[0x1,0x2],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=[_0x293a49(0x143),_0x293a49(0x12f)],_0x545b2d=['D'],_0x4d6623=['B'];break;case _0x293a49(0x12d):_0x53d55d=[0x0],_0x4853bd=[0x0],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=[_0x293a49(0x12f)],_0x545b2d=['D'],_0x4d6623=['S'];break;case _0x293a49(0x167):_0x53d55d=[0x0],_0x4853bd=[0x0],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x507c76=[_0x293a49(0x12f)],_0x545b2d=['D'],_0x4d6623=['R'];break;}else{if(_0x3371d2=='COLD\x20STORAGE')switch(_0x37ad50){case _0x293a49(0x16c):_0x53d55d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4853bd=['B','F'],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=[_0x293a49(0x143),'Floor'],_0x545b2d=['C'],_0x4d6623=['A'];break;case'Rack\x20B':_0x53d55d=[0x5,0x4,0x3,0x2,0x1],_0x4853bd=['F','B','S'],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=[_0x293a49(0x143),_0x293a49(0x12f)],_0x545b2d=['C'],_0x4d6623=['B'];break;case _0x293a49(0x12b):_0x53d55d=[0x1,0x2,0x3,0x4,0x5],_0x4853bd=['B','F','S'],_0x5d9a01=[0x5,0x4,0x3,0x2,0x1],_0x507c76=[_0x293a49(0x143),'Floor'],_0x545b2d=['C'],_0x4d6623=['C'];break;case _0x293a49(0xe2):_0x53d55d=[0x5,0x4,0x3,0x2,0x1],_0x4853bd=['F','B','S'],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=[_0x293a49(0x143),_0x293a49(0x12f)],_0x545b2d=['C'],_0x4d6623=['D'];break;case'Rack\x20E':_0x53d55d=[0x4,0x3,0x2,0x1],_0x4853bd=[0x1,0x2],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=['Level',_0x293a49(0x12f)],_0x545b2d=['C'],_0x4d6623=['E'];break;case'Rack\x20F':_0x53d55d=[0x1,0x2,0x3],_0x4853bd=[0x1,0x2],_0x5d9a01=[0x1,0x2,0x3,0x4,0x5],_0x507c76=['Level'],_0x545b2d=['C'],_0x4d6623=['F'];break;}}return{'levels':_0x53d55d,'Isle':_0x4853bd,'rack':_0x5d9a01,'type':_0x507c76,'storage':_0x545b2d,'rak':_0x4d6623};}router[a0_0x391d7e(0x119)](a0_0x391d7e(0x193),auth,async(_0x16616e,_0x3dce8a)=>{var _0x2c0ac7=a0_0x391d7e;try{const {username:_0x5d23e9,email:_0x397986,role:_0x431e00}=_0x16616e['user'],_0x122639=_0x16616e[_0x2c0ac7(0x10e)],_0x2c9a6a=await profile[_0x2c0ac7(0xee)]({'email':_0x122639[_0x2c0ac7(0x155)]}),_0x2b31f2=await master_shop[_0x2c0ac7(0x17f)](),_0x44cf63=await transfers['findById'](_0x16616e[_0x2c0ac7(0x166)]['id']);let _0x22daf3;if(_0x122639[_0x2c0ac7(0x140)]==_0x2c0ac7(0x14c)){const _0x2282e6=await staff['findOne']({'email':_0x122639['email']});_0x22daf3=await warehouse[_0x2c0ac7(0x164)]([{'$match':{'status':_0x2c0ac7(0x19b),'name':_0x2282e6['warehouse'],'warehouse_category':_0x2c0ac7(0x120)}},{'$group':{'_id':_0x2c0ac7(0x106),'name':{'$first':_0x2c0ac7(0x106)}}}]);}else _0x22daf3=await warehouse['aggregate']([{'$match':{'status':_0x2c0ac7(0x19b),'warehouse_category':_0x2c0ac7(0x120)}},{'$group':{'_id':_0x2c0ac7(0x106),'name':{'$first':_0x2c0ac7(0x106)}}}]);const _0x8ed752=await warehouse[_0x2c0ac7(0x164)]([{'$match':{'name':_0x44cf63[_0x2c0ac7(0x173)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x2c0ac7(0x104)},{'$group':{'_id':_0x2c0ac7(0x196),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2c0ac7(0x18f)},'bay':{'$first':_0x2c0ac7(0x14f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x2c0ac7(0x187)},'primary_code':{'$first':_0x2c0ac7(0xf2)},'secondary_code':{'$first':_0x2c0ac7(0x198)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2c0ac7(0xf4)},'rack':{'$first':_0x2c0ac7(0x15b)},'expiry_date':{'$first':_0x2c0ac7(0x163)},'production_date':{'$first':_0x2c0ac7(0x133)},'room':{'$first':_0x2c0ac7(0x1b5)}}}]),_0x54d230=await product[_0x2c0ac7(0x17f)]({}),_0x22efb4=BayBinSelected(_0x44cf63[_0x2c0ac7(0x1a4)],_0x44cf63['to_room']);if(_0x2b31f2[0x0][_0x2c0ac7(0x141)]==_0x2c0ac7(0x199)){var _0x49e61d=users[_0x2c0ac7(0x12c)];console[_0x2c0ac7(0x146)](_0x49e61d);}else{if(_0x2b31f2[0x0]['language']==_0x2c0ac7(0x1af))var _0x49e61d=users[_0x2c0ac7(0x1af)];else{if(_0x2b31f2[0x0]['language']==_0x2c0ac7(0x108))var _0x49e61d=users[_0x2c0ac7(0x108)];else{if(_0x2b31f2[0x0]['language']=='Spanish')var _0x49e61d=users[_0x2c0ac7(0xf8)];else{if(_0x2b31f2[0x0]['language']=='French')var _0x49e61d=users[_0x2c0ac7(0x17e)];else{if(_0x2b31f2[0x0][_0x2c0ac7(0x141)]==_0x2c0ac7(0x1b0))var _0x49e61d=users['Portuguese'];else{if(_0x2b31f2[0x0][_0x2c0ac7(0x141)]==_0x2c0ac7(0x10c))var _0x49e61d=users['Chinese'];else{if(_0x2b31f2[0x0]['language']==_0x2c0ac7(0x17c))var _0x49e61d=users[_0x2c0ac7(0x11c)];}}}}}}}_0x3dce8a[_0x2c0ac7(0xea)](_0x2c0ac7(0x10b),{'success':_0x16616e[_0x2c0ac7(0x1ad)](_0x2c0ac7(0x162)),'errors':_0x16616e[_0x2c0ac7(0x1ad)](_0x2c0ac7(0x15e)),'role':_0x122639,'profile':_0x2c9a6a,'master_shop':_0x2b31f2,'warehouse':_0x22daf3,'transfer':_0x44cf63,'stock':_0x8ed752,'unit':_0x54d230,'language':_0x49e61d});}catch(_0x84baa7){console[_0x2c0ac7(0x146)](_0x84baa7);}}),router[a0_0x391d7e(0x13a)]('/view/:id',auth,async(_0x370417,_0x4fffd9)=>{var _0x360f74=a0_0x391d7e;try{const _0x49ebcc=_0x370417[_0x360f74(0x166)]['id'],_0x3a342f=await transfers['findById'](_0x49ebcc);_0x4fffd9[_0x360f74(0x160)](_0x370417[_0x360f74(0x137)]);return;const {date:_0x43bdd3,from_warehouse:_0x119c67,FromRoom_name:_0x5abf5c,to_warehouse:_0x6f6141,ToRoom_name:_0x560848,prod_name:_0x1b08b7,from_prod_qty:_0x2ad910,from_prod_level:_0x8061a8,from_prod_isle:_0x10368d,from_prod_pallet:_0x322a44,to_prod_qty:_0x4f688a,to_prod_level:_0x1b6d18,to_prod_isle:_0x2f2136,to_prod_pallet:_0x1f60d5,primary_code:_0x453f26,secondary_code:_0x2c0817,product_code3:_0x1644f4,note:_0x473e29,invoice:_0x5b9db5,expiry_date:_0x1e829c}=_0x370417[_0x360f74(0x137)];if(typeof _0x1b08b7=='string')var _0x2f3669=[_0x370417[_0x360f74(0x137)][_0x360f74(0x149)]],_0x705f87=[_0x370417['body'][_0x360f74(0x19f)]],_0x43e076=[_0x370417[_0x360f74(0x137)][_0x360f74(0x12a)]],_0x2b9f64=[_0x370417[_0x360f74(0x137)]['from_prod_isle']],_0x2cce9b=[_0x370417[_0x360f74(0x137)][_0x360f74(0xe5)]],_0x522905=[_0x370417['body'][_0x360f74(0x177)]],_0xef3c6d=[_0x370417[_0x360f74(0x137)][_0x360f74(0xff)]],_0x3d3dfc=[_0x370417[_0x360f74(0x137)][_0x360f74(0x1ac)]],_0x1b9713=[_0x370417['body'][_0x360f74(0xf9)]],_0x53af7b=[_0x370417['body'][_0x360f74(0x13c)]],_0x4cbd8b=[_0x370417['body']['to_types']],_0x3e5994=[_0x370417[_0x360f74(0x137)]['storage']],_0x4cf4e5=[_0x370417[_0x360f74(0x137)]['rak']],_0x5642b9=[_0x370417[_0x360f74(0x137)][_0x360f74(0x12e)]],_0x423ed1=[_0x370417[_0x360f74(0x137)][_0x360f74(0xf3)]],_0x5d1a20=[_0x370417[_0x360f74(0x137)][_0x360f74(0x148)]],_0x2f7d35=[_0x370417[_0x360f74(0x137)]['MaxStocks_data2']],_0x23e142=[_0x370417[_0x360f74(0x137)][_0x360f74(0x109)]],_0x35323d=[_0x370417[_0x360f74(0x137)][_0x360f74(0x172)]],_0x98f853=[_0x370417[_0x360f74(0x137)][_0x360f74(0x136)]],_0x2ddd3b=[_0x370417[_0x360f74(0x137)][_0x360f74(0xeb)]],_0x53a011=[_0x370417['body']['from_storage']],_0xcf1af9=[_0x370417[_0x360f74(0x137)][_0x360f74(0x19c)]];else var _0x2f3669=[..._0x370417[_0x360f74(0x137)][_0x360f74(0x149)]],_0x3e5994=[..._0x370417[_0x360f74(0x137)][_0x360f74(0x1b7)]],_0x4cf4e5=[..._0x370417[_0x360f74(0x137)][_0x360f74(0x112)]],_0x522905=[..._0x370417[_0x360f74(0x137)][_0x360f74(0x177)]],_0x4cbd8b=[..._0x370417[_0x360f74(0x137)]['to_types']],_0x705f87=[..._0x370417[_0x360f74(0x137)]['from_prod_qty']],_0x43e076=[..._0x370417['body'][_0x360f74(0x12a)]],_0x2b9f64=[..._0x370417['body'][_0x360f74(0x18e)]],_0x2cce9b=[..._0x370417['body'][_0x360f74(0xe5)]],_0xef3c6d=[..._0x370417[_0x360f74(0x137)][_0x360f74(0xff)]],_0x3d3dfc=[..._0x370417['body'][_0x360f74(0x1ac)]],_0x1b9713=[..._0x370417[_0x360f74(0x137)][_0x360f74(0xf9)]],_0x53af7b=[..._0x370417['body'][_0x360f74(0x13c)]],_0x5642b9=[..._0x370417[_0x360f74(0x137)][_0x360f74(0x12e)]],_0x423ed1=[..._0x370417[_0x360f74(0x137)][_0x360f74(0xf3)]],_0x5d1a20=[..._0x370417[_0x360f74(0x137)]['product_code3']],_0x2f7d35=[..._0x370417['body']['MaxStocks_data2']],_0x23e142=[..._0x370417[_0x360f74(0x137)]['unit']],_0x35323d=[..._0x370417[_0x360f74(0x137)][_0x360f74(0x172)]],_0x98f853=[..._0x370417['body'][_0x360f74(0x136)]],_0x2ddd3b=[..._0x370417['body'][_0x360f74(0xeb)]],_0x53a011=[..._0x370417[_0x360f74(0x137)][_0x360f74(0x15c)]],_0xcf1af9=[..._0x370417[_0x360f74(0x137)]['from_rak']];const _0x32da36=_0x2f3669[_0x360f74(0x184)](_0x38e3e6=>{return _0x38e3e6={'product_name':_0x38e3e6};});_0x705f87['forEach']((_0x2bab68,_0x2d3f87)=>{var _0xac096a=_0x360f74;_0x32da36[_0x2d3f87][_0xac096a(0x159)]=_0x2bab68;}),_0x43e076[_0x360f74(0x139)]((_0x58378c,_0x1550e0)=>{var _0x2acfad=_0x360f74;_0x32da36[_0x1550e0][_0x2acfad(0x174)]=_0x58378c;}),_0x2b9f64[_0x360f74(0x139)]((_0xb8d776,_0x1c3ca8)=>{var _0x4b0d19=_0x360f74;_0x32da36[_0x1c3ca8][_0x4b0d19(0x147)]=_0xb8d776;}),_0x2cce9b[_0x360f74(0x139)]((_0x294af9,_0x1c0eed)=>{_0x32da36[_0x1c0eed]['from_floorlevel']=_0x294af9;}),_0xef3c6d[_0x360f74(0x139)]((_0x3ceb56,_0x434ce5)=>{_0x32da36[_0x434ce5]['to_quantity']=_0x3ceb56;}),_0x3d3dfc[_0x360f74(0x139)]((_0x190a58,_0x323c92)=>{_0x32da36[_0x323c92]['to_bay']=_0x190a58;}),_0x1b9713[_0x360f74(0x139)]((_0x38ddff,_0x2abb37)=>{var _0x215055=_0x360f74;_0x32da36[_0x2abb37][_0x215055(0x150)]=_0x38ddff;}),_0x53af7b[_0x360f74(0x139)]((_0x1713dc,_0x950366)=>{var _0x2958f9=_0x360f74;_0x32da36[_0x950366][_0x2958f9(0x1ab)]=_0x1713dc;}),_0x5642b9[_0x360f74(0x139)]((_0x584db5,_0x34c8a2)=>{var _0xdd0314=_0x360f74;_0x32da36[_0x34c8a2][_0xdd0314(0x12e)]=_0x584db5;}),_0x423ed1[_0x360f74(0x139)]((_0x4f2b96,_0x3bf7de)=>{_0x32da36[_0x3bf7de]['secondary_code']=_0x4f2b96;}),_0x5d1a20[_0x360f74(0x139)]((_0x3d612c,_0x453066)=>{var _0x473701=_0x360f74;_0x32da36[_0x453066][_0x473701(0x189)]=_0x3d612c;}),_0x2f7d35[_0x360f74(0x139)]((_0x190094,_0x5abb36)=>{_0x32da36[_0x5abb36]['maxProducts']=_0x190094;}),_0x23e142[_0x360f74(0x139)]((_0x288b2c,_0x5c6bbc)=>{_0x32da36[_0x5c6bbc]['unit']=_0x288b2c;}),_0x35323d[_0x360f74(0x139)]((_0x41c3ae,_0xe13b1c)=>{var _0xe0cd73=_0x360f74;_0x32da36[_0xe13b1c][_0xe0cd73(0x172)]=_0x41c3ae;}),_0x98f853['forEach']((_0x4852d5,_0x26a6a2)=>{var _0x4e8687=_0x360f74;_0x32da36[_0x26a6a2][_0x4e8687(0x136)]=_0x4852d5;}),_0x2ddd3b[_0x360f74(0x139)]((_0xfb5bd6,_0xcb6ce3)=>{var _0x2e9a11=_0x360f74;_0x32da36[_0xcb6ce3][_0x2e9a11(0xeb)]=_0xfb5bd6;}),_0x3e5994['forEach']((_0x2ba7fe,_0x3f3b81)=>{var _0x2f80fe=_0x360f74;_0x32da36[_0x3f3b81][_0x2f80fe(0x1b7)]=_0x2ba7fe;}),_0x4cf4e5['forEach']((_0x28f8d3,_0x3d88a0)=>{var _0x319aa3=_0x360f74;_0x32da36[_0x3d88a0][_0x319aa3(0x11b)]=_0x28f8d3;}),_0x522905[_0x360f74(0x139)]((_0x559767,_0x4c4630)=>{var _0x4e3ef4=_0x360f74;_0x32da36[_0x4c4630][_0x4e3ef4(0x177)]=_0x559767;}),_0x4cbd8b[_0x360f74(0x139)]((_0x4486f9,_0x3d7753)=>{var _0x19b4f5=_0x360f74;_0x32da36[_0x3d7753][_0x19b4f5(0x186)]=_0x4486f9;}),_0x53a011['forEach']((_0x3edbd5,_0x274a70)=>{_0x32da36[_0x274a70]['from_storage']=_0x3edbd5;}),_0xcf1af9[_0x360f74(0x139)]((_0x1ceab6,_0x2934cb)=>{var _0x30cbb9=_0x360f74;_0x32da36[_0x2934cb][_0x30cbb9(0x16d)]=_0x1ceab6;});const _0x3b0958=_0x32da36[_0x360f74(0x13b)](_0x2a8a58=>_0x2a8a58[_0x360f74(0xe8)]!=='0'&&_0x2a8a58[_0x360f74(0xe8)]!==''||_0x2a8a58[_0x360f74(0x1ab)]!=='0'&&_0x2a8a58['to_floorlevel']!=='');var _0xd5d19d=0x0;_0x3b0958[_0x360f74(0x139)](_0x1a0b7d=>{var _0x450111=_0x360f74;parseInt(_0x1a0b7d[_0x450111(0x159)])<parseInt(_0x1a0b7d[_0x450111(0xe8)])&&_0xd5d19d++;});if(_0xd5d19d!=0x0)return _0x370417[_0x360f74(0x1ad)](_0x360f74(0x15e),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x4fffd9['redirect']('back');const _0x16706a=await warehouse[_0x360f74(0xee)]({'name':_0x3a342f[_0x360f74(0x173)],'room':_0x3a342f['from_room']});_0x3a342f[_0x360f74(0x197)][_0x360f74(0x139)](_0x1786d8=>{if(_0x1786d8['to_quantity']>0x0){const _0x15e6df=_0x16706a['product_details']['map'](_0x8b7b9b=>{var _0x386f60=a0_0x54b4;_0x8b7b9b[_0x386f60(0x154)]==_0x1786d8[_0x386f60(0x154)]&&_0x8b7b9b[_0x386f60(0x118)]==_0x1786d8[_0x386f60(0x195)]&&_0x8b7b9b[_0x386f60(0x114)]==_0x1786d8[_0x386f60(0x177)]&&_0x8b7b9b[_0x386f60(0x13e)]==_0x1786d8[_0x386f60(0x147)]&&_0x8b7b9b[_0x386f60(0x18b)]==_0x1786d8[_0x386f60(0x174)]&&_0x8b7b9b[_0x386f60(0x11b)]==_0x1786d8['from_rack']&&_0x8b7b9b[_0x386f60(0x1b7)]==_0x1786d8[_0x386f60(0x15c)]&&(_0x8b7b9b[_0x386f60(0xfc)]=parseInt(_0x8b7b9b['product_stock'])+parseInt(_0x1786d8[_0x386f60(0xe8)]));});}}),await _0x16706a[_0x360f74(0x19e)]();const _0x49c4ae=await warehouse['findOne']({'name':_0x3a342f['to_warehouse'],'room':_0x3a342f['to_room']});_0x3a342f[_0x360f74(0x197)]['forEach'](_0x2763a4=>{var _0x10c140=_0x360f74;if(_0x2763a4[_0x10c140(0xe8)]>0x0){const _0x3a3257=_0x49c4ae[_0x10c140(0x165)][_0x10c140(0x184)](_0xc7c03e=>{var _0x24147e=_0x10c140;_0xc7c03e[_0x24147e(0x154)]==_0x2763a4[_0x24147e(0x154)]&&_0xc7c03e[_0x24147e(0x118)]==_0x2763a4[_0x24147e(0x1ab)]&&_0xc7c03e[_0x24147e(0x114)]==_0x2763a4[_0x24147e(0x186)]&&_0xc7c03e['bin']==_0x2763a4[_0x24147e(0x150)]&&_0xc7c03e['bay']==_0x2763a4[_0x24147e(0x100)]&&_0xc7c03e['rack']==_0x2763a4[_0x24147e(0x11b)]&&_0xc7c03e[_0x24147e(0x1b7)]==_0x2763a4[_0x24147e(0x1b7)]&&(_0xc7c03e[_0x24147e(0xfc)]=parseInt(_0xc7c03e[_0x24147e(0xfc)])-parseInt(_0x2763a4[_0x24147e(0xe8)]));});}}),await _0x49c4ae[_0x360f74(0x19e)](),_0x3a342f[_0x360f74(0x121)]=_0x43bdd3,_0x3a342f[_0x360f74(0x173)]=_0x119c67,_0x3a342f[_0x360f74(0x1a4)]=_0x6f6141,_0x3a342f[_0x360f74(0x197)]=_0x3b0958,_0x3a342f['note']=_0x473e29,_0x3a342f[_0x360f74(0x181)]=_0x5b9db5;const _0x2d6bfd=await _0x3a342f['save']();console[_0x360f74(0x146)](_0x2d6bfd);const _0x26d933=await warehouse[_0x360f74(0xee)]({'name':_0x119c67,'room':_0x5abf5c});_0x2d6bfd[_0x360f74(0x197)][_0x360f74(0x139)](_0xeed6ce=>{var _0x33611b=_0x360f74;if(_0xeed6ce[_0x33611b(0xe8)]>0x0){const _0x2d5e2b=_0x26d933[_0x33611b(0x165)][_0x33611b(0x184)](_0x2a3dee=>{var _0x3e47b4=_0x33611b;_0x2a3dee['product_name']==_0xeed6ce[_0x3e47b4(0x154)]&&_0x2a3dee[_0x3e47b4(0x118)]==_0xeed6ce[_0x3e47b4(0x195)]&&_0x2a3dee[_0x3e47b4(0x114)]==_0xeed6ce[_0x3e47b4(0x177)]&&_0x2a3dee['bin']==_0xeed6ce[_0x3e47b4(0x147)]&&_0x2a3dee['bay']==_0xeed6ce[_0x3e47b4(0x174)]&&_0x2a3dee[_0x3e47b4(0x11b)]==_0xeed6ce[_0x3e47b4(0x16d)]&&_0x2a3dee['storage']==_0xeed6ce[_0x3e47b4(0x15c)]&&(_0x2a3dee[_0x3e47b4(0xfc)]=parseInt(_0x2a3dee[_0x3e47b4(0xfc)])-parseInt(_0xeed6ce[_0x3e47b4(0xe8)]));});}}),await _0x26d933[_0x360f74(0x19e)]();const _0x42a900=await warehouse[_0x360f74(0xee)]({'name':_0x6f6141,'room':_0x560848});_0x2d6bfd[_0x360f74(0x197)]['forEach'](_0x1cf9a0=>{var _0x33e6a7=_0x360f74;if(_0x1cf9a0[_0x33e6a7(0xe8)]>0x0){var _0x8b9914=0x0;const _0x4357cd=_0x42a900['product_details'][_0x33e6a7(0x184)](_0x23755a=>{var _0x427ed6=_0x33e6a7;_0x23755a[_0x427ed6(0x154)]==_0x1cf9a0[_0x427ed6(0x154)]&&_0x23755a[_0x427ed6(0x118)]==_0x1cf9a0[_0x427ed6(0x1ab)]&&_0x23755a[_0x427ed6(0x114)]==_0x1cf9a0[_0x427ed6(0x186)]&&_0x23755a[_0x427ed6(0x13e)]==_0x1cf9a0[_0x427ed6(0x150)]&&_0x23755a[_0x427ed6(0x18b)]==_0x1cf9a0[_0x427ed6(0x100)]&&_0x23755a[_0x427ed6(0x11b)]==_0x1cf9a0[_0x427ed6(0x11b)]&&_0x23755a['storage']==_0x1cf9a0['storage']&&(_0x23755a[_0x427ed6(0xfc)]=parseInt(_0x23755a[_0x427ed6(0xfc)])+parseInt(_0x1cf9a0[_0x427ed6(0xe8)]),_0x8b9914++);});_0x8b9914=='0'&&(_0x42a900[_0x33e6a7(0x165)]=_0x42a900['product_details'][_0x33e6a7(0x1a9)]({'product_name':_0x1cf9a0[_0x33e6a7(0x154)],'product_stock':_0x1cf9a0[_0x33e6a7(0xe8)],'bay':_0x1cf9a0['to_bay'],'bin':_0x1cf9a0[_0x33e6a7(0x150)],'type':_0x1cf9a0['to_types'],'floorlevel':_0x1cf9a0['to_floorlevel'],'storage':_0x1cf9a0[_0x33e6a7(0x1b7)],'rack':_0x1cf9a0[_0x33e6a7(0x11b)],'product_code':_0x1cf9a0[_0x33e6a7(0x189)],'primary_code':_0x1cf9a0['primary_code'],'secondary_code':_0x1cf9a0[_0x33e6a7(0xf3)],'maxProducts':_0x1cf9a0[_0x33e6a7(0x18c)],'storage':_0x1cf9a0[_0x33e6a7(0x1b7)],'rack':_0x1cf9a0[_0x33e6a7(0x11b)]}));}}),await _0x42a900[_0x360f74(0x19e)](),_0x370417[_0x360f74(0x1ad)](_0x360f74(0x162),'Transfer\x20Edit\x20Successfully'),_0x4fffd9[_0x360f74(0xf1)](_0x360f74(0x157));}catch(_0x1d16df){console[_0x360f74(0x146)](_0x1d16df);}}),router['post']('/barcode_scanner',async(_0x2b12fc,_0x3f2527)=>{var _0x477852=a0_0x391d7e;const {FromWareHouse:_0x5a187a,FromRoom:_0x2b96e5,ToWarehouse:_0x2d6e89,ToRoom:_0x10d571,primary_code:_0x539d61,Roomslist:_0x9f3de}=_0x2b12fc['body'],_0x4eafee=_0x9f3de['split'](','),_0x25b1a2=[];async function _0x122b3d(_0x36b162){var _0xd30a19=a0_0x54b4;const _0x3a5c37=await warehouse['aggregate']([{'$match':{'name':_0x5a187a,'room':_0x36b162}},{'$unwind':_0xd30a19(0x104)},{'$match':{'product_details.primary_code':_0x539d61}},{'$group':{'_id':_0xd30a19(0x196),'name':{'$first':_0xd30a19(0x192)},'instock':{'$first':_0xd30a19(0x18f)},'primary_code':{'$first':_0xd30a19(0xf2)},'secondary_code':{'$first':_0xd30a19(0x198)},'product_code':{'$first':_0xd30a19(0xf6)},'level':{'$first':_0xd30a19(0x14f)},'isle':{'$first':_0xd30a19(0x16e)},'type':{'$first':_0xd30a19(0x179)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0xd30a19(0x105)},'secondary_unit':{'$first':_0xd30a19(0x153)},'storage':{'$first':_0xd30a19(0xf4)},'rack':{'$first':_0xd30a19(0x15b)},'expiry_date':{'$first':_0xd30a19(0x163)},'production_date':{'$first':_0xd30a19(0x133)},'batch_code':{'$first':_0xd30a19(0x128)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0xd30a19(0x1b5)},'maxProducts':{'$first':_0xd30a19(0x131)}}}]),_0x2ae2eb=await warehouse['aggregate']([{'$match':{'name':_0x5a187a,'room':_0x36b162}},{'$unwind':_0xd30a19(0x104)},{'$match':{'product_details.secondary_code':_0x539d61}},{'$group':{'_id':_0xd30a19(0x196),'name':{'$first':_0xd30a19(0x192)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xd30a19(0xf2)},'secondary_code':{'$first':_0xd30a19(0x198)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0xd30a19(0x14f)},'isle':{'$first':_0xd30a19(0x16e)},'type':{'$first':_0xd30a19(0x179)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0xd30a19(0x105)},'secondary_unit':{'$first':_0xd30a19(0x153)},'storage':{'$first':_0xd30a19(0xf4)},'rack':{'$first':_0xd30a19(0x15b)},'expiry_date':{'$first':_0xd30a19(0x163)},'production_date':{'$first':_0xd30a19(0x133)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0xd30a19(0x1b5)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);if(_0x3a5c37[_0xd30a19(0x145)]>0x0)_0x25b1a2[_0xd30a19(0x134)](_0x3a5c37);else _0x2ae2eb[_0xd30a19(0x145)]>0x0&&_0x25b1a2[_0xd30a19(0x134)](_0x2ae2eb);}const _0x50623a=_0x4eafee[_0x477852(0x184)](_0x5aa9b2=>_0x122b3d(_0x5aa9b2));await Promise[_0x477852(0x1b4)](_0x50623a),_0x3f2527['json'](_0x25b1a2);}),router[a0_0x391d7e(0x13a)](a0_0x391d7e(0xef),async(_0x483ef8,_0x3ed993)=>{var _0x1bcb6a=a0_0x391d7e;try{const {FromWareHouse:_0x2729d5,FromRoom:_0x3b7408,ToWarehouse:_0x2a3d46,ToRoom:_0x412822,secondary_code:_0x4379b1}=_0x483ef8[_0x1bcb6a(0x137)],_0x15b25f=await warehouse[_0x1bcb6a(0x164)]([{'$match':{'name':_0x2729d5}},{'$unwind':_0x1bcb6a(0x104)},{'$match':{'product_details.secondary_code':_0x4379b1}},{'$group':{'_id':_0x1bcb6a(0x196),'name':{'$first':_0x1bcb6a(0x192)},'primary_code':{'$first':_0x1bcb6a(0xf2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1bcb6a(0xf6)},'instock':{'$first':_0x1bcb6a(0x18f)},'warehouse':{'$first':'$name'},'level':{'$first':_0x1bcb6a(0x1b8)},'isle':{'$first':_0x1bcb6a(0x1a8)},'pallet':{'$first':_0x1bcb6a(0x101)},'maxProducts':{'$first':_0x1bcb6a(0x131)},'unit':{'$first':_0x1bcb6a(0x105)}}}]);_0x3ed993[_0x1bcb6a(0x13d)](0xc8)[_0x1bcb6a(0x160)](_0x15b25f);}catch(_0x4c4ab5){_0x3ed993[_0x1bcb6a(0x13d)](0x194)['json']({'message':_0x4c4ab5[_0x1bcb6a(0x183)]});}}),router[a0_0x391d7e(0x13a)](a0_0x391d7e(0x191),async(_0x5639e0,_0x2db308)=>{var _0x58b79f=a0_0x391d7e;try{const {FromWareHouse:_0x4fb14d,FromRoom:_0x4d229f,ToWarehouse:_0x1b5799,ToRoom:_0x1bb323,product_code:_0x1b25ae}=_0x5639e0[_0x58b79f(0x137)],_0x18f561=await warehouse['aggregate']([{'$match':{'name':_0x4fb14d}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x1b25ae}},{'$group':{'_id':_0x58b79f(0x196),'name':{'$first':_0x58b79f(0x192)},'primary_code':{'$first':_0x58b79f(0xf2)},'secondary_code':{'$first':_0x58b79f(0x198)},'product_code':{'$first':_0x58b79f(0xf6)},'instock':{'$first':_0x58b79f(0x18f)},'warehouse':{'$first':_0x58b79f(0x106)},'level':{'$first':_0x58b79f(0x1b8)},'isle':{'$first':_0x58b79f(0x1a8)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x58b79f(0x105)}}}]);_0x2db308['status'](0xc8)[_0x58b79f(0x160)](_0x18f561);}catch(_0x1e5503){_0x2db308[_0x58b79f(0x13d)](0x194)[_0x58b79f(0x160)]({'message':_0x1e5503[_0x58b79f(0x183)]});}}),router[a0_0x391d7e(0x13a)]('/CheckingWarehouse',async(_0x382db5,_0x58f8a9)=>{var _0x3707c4=a0_0x391d7e;const {level:_0x2e2294,isle:_0x222dff,pallet:_0x331457,warehouses:_0x3f3b9d,room:_0x42787}=_0x382db5[_0x3707c4(0x137)];try{const _0x5b01d0=await warehouse[_0x3707c4(0x164)]([{'$match':{'name':_0x3f3b9d,'room':_0x42787}},{'$unwind':_0x3707c4(0x104)},{'$match':{'product_details.level':parseInt(_0x2e2294),'product_details.isle':_0x222dff,'product_details.pallet':parseInt(_0x331457)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3707c4(0x18f)},'level':{'$first':_0x3707c4(0x1b8)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x3707c4(0x101)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x58f8a9[_0x3707c4(0x13d)](0xc8)[_0x3707c4(0x160)](_0x5b01d0);}catch(_0x58014f){_0x58f8a9[_0x3707c4(0x13d)](0x194)[_0x3707c4(0x160)]({'message':_0x58014f[_0x3707c4(0x183)]});}}),module[a0_0x391d7e(0x130)]=router;function a0_0x22d8(){var _0x1eeda1=['product_name','email','$isAllowEdit','/transfer/view','</head><body>','from_quantity','$from_warehouse','$product_details.rack','from_storage','slice','errors','</td>','json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','success','$product_details.expiry_date','aggregate','product_details','params','Receiving\x20Area','New_Qty_Converted','warehouse','prod_cat','Router','Rack\x20A','from_rack','$product_details.bin','3603325LKKRfU','<html><head><title></title>','then','secondary_unit','from_warehouse','from_bay','ToRoomAssigned','error','from_types','production_date','$product_details.type','1696542BPAsIB','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Arabic\x20(ae)','to_room_name','French','find','RMSEmail','invoice','from_invoice','message','map','findById','to_types','$product_details.floorlevel','to_invoice','product_code','add_transfer','bay','maxProducts','234XoGDbV','from_prod_isle','$product_details.product_stock','port','/barcode_scanner3','$product_details.product_name','/view/:id','896620kYFHKk','from_floorlevel','$product_details._id','product','$product_details.secondary_code','English\x20(US)','<span\x20style=\x22float:\x20right;\x22>','Enabled','from_rak','<h5\x20style=\x22text-align:\x20left;\x22>','save','from_prod_qty','random','$product.to_room_name','Ambient','from_room_name','to_warehouse','express','Email\x20sent\x20successfully','An\x20error\x20occurred.','$product_details.isle','concat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_floorlevel','to_prod_level','flash','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Hindi','Portuguese\x20(BR)','getFullYear','Transfer\x20Finalize\x20Successfully','</tr>','all','$room','7382606gzOiNM','storage','$product_details.level','</div>','An\x20error\x20occurred\x20while\x20saving\x20data.','/upload/','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','nodemailer','$product','Rack\x20D','/picking_list/PDF_transfer_rm/','<tr>','from_prod_pallet','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</h5>','to_quantity','<h5>','render','expiry_date','<strong>\x20Regards\x20</strong>','Transfer\x20Mail','findOne','/barcode_scanner2','</table>','redirect','$product_details.primary_code','secondary_code','$product_details.storage','_id','$product_details.product_code','site_title','Spanish','to_prod_isle','max_per_unit','\x20Order\x20Date\x20:\x20','product_stock','/transfer/preview/','transfer','to_prod_qty','to_bay','$product_details.pallet','$product.from_room_name','1512952NZihxr','$product_details','$product_details.unit','$name','To_invoice','German','unit','host','edit_transfer','Chinese','primary_unit','user','updateOne','/view/add_transfer','Enclosed','rak','createTransport','type','string','</thead>','1252917ksGttD','floorlevel','get','<h2>\x20','rack','Arabic','$invoice','$_id','/../public','Raw\x20Materials','date','</tbody>','Logo.png','<div>','../public/language/languages.json','8UxXtIt','catch','$product_details.batch_code','RoomAssigned','from_prod_level','Rack\x20C','English','Shelves','primary_code','Floor','exports','$product_details.maxProducts','/preview/:id','$product_details.production_date','push','$to_warehouse','batch_code','body','padStart','forEach','post','filter','to_prod_pallet','status','bin','$finalize','role','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Level','master','length','log','from_bin','product_code3','prod_name','TRF-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','staff','Portuguese','maxperunit','$product_details.bay','to_bin','8987088EuqFeQ','True','$product_details.secondary_unit'];a0_0x22d8=function(){return _0x1eeda1;};return a0_0x22d8();}