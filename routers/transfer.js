var a0_0x201bb0=a0_0x1662;(function(_0x2839cc,_0x550a35){var _0x508f52=a0_0x1662,_0x412481=_0x2839cc();while(!![]){try{var _0x9262a=-parseInt(_0x508f52(0xe1))/0x1+parseInt(_0x508f52(0x160))/0x2*(parseInt(_0x508f52(0xb7))/0x3)+parseInt(_0x508f52(0x166))/0x4*(parseInt(_0x508f52(0xfc))/0x5)+-parseInt(_0x508f52(0xe6))/0x6*(parseInt(_0x508f52(0x132))/0x7)+-parseInt(_0x508f52(0xec))/0x8*(-parseInt(_0x508f52(0xb6))/0x9)+parseInt(_0x508f52(0xe8))/0xa+-parseInt(_0x508f52(0x181))/0xb;if(_0x9262a===_0x550a35)break;else _0x412481['push'](_0x412481['shift']());}catch(_0x27408a){_0x412481['push'](_0x412481['shift']());}}}(a0_0x46f4,0xc92de));function a0_0x1662(_0x49cdda,_0x2cdd82){var _0x46f404=a0_0x46f4();return a0_0x1662=function(_0x166236,_0x268c0b){_0x166236=_0x166236-0x90;var _0x295136=_0x46f404[_0x166236];return _0x295136;},a0_0x1662(_0x49cdda,_0x2cdd82);}const express=require(a0_0x201bb0(0x140)),app=express(),router=express[a0_0x201bb0(0x15e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x201bb0(0x159)),auth=require(a0_0x201bb0(0xe3)),users=require(a0_0x201bb0(0x9a)),nodemailer=require('nodemailer');router[a0_0x201bb0(0x15c)](a0_0x201bb0(0x119),auth,async(_0x35890a,_0x562ef6)=>{var _0x362719=a0_0x201bb0;try{const {username:_0x217e6b,email:_0x97fd17,role:_0x3d7dd4}=_0x35890a[_0x362719(0x185)],_0x4cf178=_0x35890a[_0x362719(0x185)],_0x484f0e=await profile[_0x362719(0xab)]({'email':_0x4cf178['email']}),_0x2cb881=await master_shop[_0x362719(0xd6)]();console[_0x362719(0x14d)](_0x362719(0x163),_0x2cb881);let _0xea58e4;if(_0x4cf178[_0x362719(0xa6)]==_0x362719(0x125)){const _0x255334=await staff['findOne']({'email':_0x4cf178['email']});_0xea58e4=await transfers['find']({'from_warehouse':_0x255334['warehouse']});}else _0xea58e4=await transfers[_0x362719(0xbc)]([{'$unwind':_0x362719(0x182)},{'$group':{'_id':_0x362719(0xda),'invoice':{'$first':'$invoice'},'date':{'$first':_0x362719(0xbe)},'from_warehouse':{'$first':_0x362719(0xd5)},'to_warehouse':{'$first':_0x362719(0xb9)},'from_room_name':{'$addToSet':_0x362719(0x162)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2cb881[0x0]['language']==_0x362719(0x150)){var _0xf08a3f=users[_0x362719(0x155)];console['log'](_0xf08a3f);}else{if(_0x2cb881[0x0][_0x362719(0x92)]==_0x362719(0xea))var _0xf08a3f=users[_0x362719(0xea)];else{if(_0x2cb881[0x0]['language']=='German')var _0xf08a3f=users['German'];else{if(_0x2cb881[0x0]['language']==_0x362719(0x15f))var _0xf08a3f=users[_0x362719(0x15f)];else{if(_0x2cb881[0x0]['language']==_0x362719(0x9d))var _0xf08a3f=users['French'];else{if(_0x2cb881[0x0][_0x362719(0x92)]=='Portuguese\x20(BR)')var _0xf08a3f=users[_0x362719(0x97)];else{if(_0x2cb881[0x0][_0x362719(0x92)]==_0x362719(0x16b))var _0xf08a3f=users[_0x362719(0x16b)];else{if(_0x2cb881[0x0][_0x362719(0x92)]=='Arabic\x20(ae)')var _0xf08a3f=users[_0x362719(0x106)];}}}}}}}_0x562ef6['render'](_0x362719(0x177),{'success':_0x35890a['flash']('success'),'errors':_0x35890a['flash'](_0x362719(0xc9)),'role':_0x4cf178,'profile':_0x484f0e,'master_shop':_0x2cb881,'transfer':_0xea58e4,'language':_0xf08a3f});}catch(_0xaf1566){console['log'](_0xaf1566);}});async function getRandom8DigitNumber(){var _0x2b9037=a0_0x201bb0;const _0x124356=0x989680,_0x5542d6=0x5f5e0ff,_0xc51aa6=Math['floor'](Math[_0x2b9037(0x146)]()*(_0x5542d6-_0x124356+0x1))+_0x124356;var _0x21098a;const _0x400ee4=await transfers['findOne']({'invoice':'TRF-'+_0xc51aa6});return _0x400ee4&&_0x400ee4['length']>0x0?_0x21098a='TRF-'+_0xc51aa6:_0x21098a='TRF-'+_0xc51aa6,_0x21098a;}function a0_0x46f4(){var _0x5501ec=['primary_code','$product_details.pallet','catch','</tr>','edit_transfer_view','</div>','/preview/:id','$product_details.bay','An\x20error\x20occurred\x20while\x20saving\x20data.','product_code3','Rack\x20D','save','filter','finalize','DRY\x20STORAGE','30upSuGK','unit','$product_details.batch_code','batch_code','Rack\x20E','storage','createTransport','note','\x20</h2>','/CheckingWarehouse','Arabic','forEach','/picking_list/PDF_transfer_rm/','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Arabic\x20(ae)','$product_details.primary_code','</thead>','</td>','render','$product_details.expiry_date','to_invoice','Receiving\x20Area','</tbody>','string','/view/:id','getMonth','secondary_unit','prod_name','</h5>','/view','<h5\x20style=\x22text-align:\x20left;\x22>','invoice','New_Qty_Converted','bay','rack','$product_details.rack','Shelves','push','from_prod_pallet','all','edit_transfer','staff','body','RMSEmail','$product_details.floorlevel','padStart','Return\x20Rooms','$product_details.product_code','error','$product_details.maxProducts','json','Error\x20Occurs','TRF-','Transfer\x20Edit\x20Successfully','364497MOeGVC','warehouse','<h5>','An\x20error\x20occurred.','/view/add_transfer','sendMail','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','message','params','/upload/','production_date','from_quantity','$product_details._id','floorlevel','express','length','\x20Order\x20Number\x20:\x20','Enabled','concat','$product_details.storage','random','$product_details.level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/transfer/preview/','<h2>\x20','from_prod_qty','from_bin','log','German','$product_details.unit','English\x20(US)','rak','to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','toString','English','findById','to_room','image','../models/all_models','product_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','get','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Router','Spanish','90QyEHlu','slice','$product.from_room_name','master','max_per_unit','from_rack','744148hXXoHM','to_prod_qty','Floor','Transfer\x20Finalize\x20Successfully','<span\x20style=\x22float:\x20right;\x22>','Chinese','$product_details.secondary_code','$room','/barcode_scanner','product_details','product_name','status','host','maxperunit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','maxProducts','from_room_name','transfer','type','bin','MaxStocks_data2','Rack\x20C','email','Email\x20sent\x20successfully','$product_details.production_date','$product_details.maxPerUnit','to_quantity','13817639KFiMOo','$product','to_prod_pallet','Ambient','user','from_warehouse','to_types','to_prod_isle','language','product_stock','to_floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Portuguese','prod_cat','map','../public/language/languages.json','post','redirect','French','to_bay','Transfer\x20Mail','from_types','back','<div>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Portuguese\x20(BR)','$product_details.product_name','role','/transfer/view','$name','RoomAssigned','port','findOne','$product_details.product_stock','</span>','from_bay','from_storage','$product_details.isle','ToRoomAssigned','success','<tbody\x20style=\x22text-align:\x20center;\x22>','<!DOCTYPE\x20html>','Rack\x20A','297JYeAvN','11193mVoUeI','Enclosed','$to_warehouse','Level','Rack\x20F','aggregate','then','$date','from_rak','$product_details.type','<html><head><title></title>','/barcode_scanner3','/barcode_scanner2','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','flash','</body></html>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Product\x20Transfer\x20successfully','errors','primary_unit','$product_details.secondary_unit','$product_details.bin','$product_details','from_floorlevel','site_title','Raw\x20Materials','_id','from_prod_isle','password','Logo.png','$from_warehouse','find','updateOne','to_warehouse','secondary_code','$_id','Rack\x20B','split','</table>','to_bin','date','to_prod_level','93586AIPmtj','<tr>','../middleware/auth','getDate','product','12PaIUYp','expiry_date','9727030siHiUr','from_prod_level','Hindi','from_invoice','5112TdgeVq'];a0_0x46f4=function(){return _0x5501ec;};return a0_0x46f4();}router[a0_0x201bb0(0x15c)](a0_0x201bb0(0x136),auth,async(_0x358b25,_0x258c30)=>{var _0x50e40a=a0_0x201bb0;try{const {username:_0x1849f4,email:_0x113a6a,role:_0x21520c}=_0x358b25['user'],_0x5b841e=_0x358b25[_0x50e40a(0x185)],_0x369728=await profile[_0x50e40a(0xab)]({'email':_0x5b841e['email']}),_0x2839de=await master_shop[_0x50e40a(0xd6)]();console[_0x50e40a(0x14d)](_0x50e40a(0x163),_0x2839de);let _0x573bad;if(_0x5b841e['role']==_0x50e40a(0x125)){const _0x3b57d4=await staff['findOne']({'email':_0x5b841e[_0x50e40a(0x17c)]});_0x573bad=await warehouse[_0x50e40a(0xbc)]([{'$match':{'status':_0x50e40a(0x143),'name':_0x3b57d4[_0x50e40a(0x133)],'warehouse_category':_0x50e40a(0xd0)}},{'$group':{'_id':'$name','name':{'$first':_0x50e40a(0xa8)}}}]);}else _0x573bad=await warehouse[_0x50e40a(0xbc)]([{'$match':{'status':_0x50e40a(0x143),'warehouse_category':_0x50e40a(0xd0)}},{'$group':{'_id':_0x50e40a(0xa8),'name':{'$first':_0x50e40a(0xa8)}}}]);var _0x378eee=[_0x50e40a(0x184),_0x50e40a(0xb8),_0x50e40a(0x12a)];const _0xa0e0a5=await transfers[_0x50e40a(0xd6)]({}),_0x1d3fb1=_0xa0e0a5['length']+0x1,_0x340318=_0x50e40a(0x130)+_0x1d3fb1[_0x50e40a(0x154)]()[_0x50e40a(0x129)](0x5,'0');if(_0x2839de[0x0][_0x50e40a(0x92)]==_0x50e40a(0x150)){var _0x1a5e05=users[_0x50e40a(0x155)];console[_0x50e40a(0x14d)](_0x1a5e05);}else{if(_0x2839de[0x0][_0x50e40a(0x92)]==_0x50e40a(0xea))var _0x1a5e05=users[_0x50e40a(0xea)];else{if(_0x2839de[0x0][_0x50e40a(0x92)]==_0x50e40a(0x14e))var _0x1a5e05=users[_0x50e40a(0x14e)];else{if(_0x2839de[0x0]['language']==_0x50e40a(0x15f))var _0x1a5e05=users[_0x50e40a(0x15f)];else{if(_0x2839de[0x0]['language']=='French')var _0x1a5e05=users['French'];else{if(_0x2839de[0x0][_0x50e40a(0x92)]==_0x50e40a(0xa4))var _0x1a5e05=users[_0x50e40a(0x97)];else{if(_0x2839de[0x0][_0x50e40a(0x92)]==_0x50e40a(0x16b))var _0x1a5e05=users[_0x50e40a(0x16b)];else{if(_0x2839de[0x0][_0x50e40a(0x92)]==_0x50e40a(0x10a))var _0x1a5e05=users[_0x50e40a(0x106)];}}}}}}}const _0x5d4ab2=getRandom8DigitNumber();_0x5d4ab2[_0x50e40a(0xbd)](_0x1ea21f=>{var _0x336bd8=_0x50e40a;_0x258c30[_0x336bd8(0x10e)]('add_transfer',{'success':_0x358b25[_0x336bd8(0xc5)](_0x336bd8(0xb2)),'errors':_0x358b25[_0x336bd8(0xc5)](_0x336bd8(0xc9)),'role':_0x5b841e,'profile':_0x369728,'master_shop':_0x2839de,'warehouse':_0x573bad,'language':_0x1a5e05,'rooms_data':_0x378eee,'invoice':_0x1ea21f});})[_0x50e40a(0xef)](_0x4362cd=>{var _0x48998d=_0x50e40a;_0x358b25[_0x48998d(0xc5)](_0x48998d(0xc9),_0x48998d(0xa3)),_0x258c30[_0x48998d(0x9c)]('/transfer/view');});}catch(_0x2cbe25){console[_0x50e40a(0x14d)](_0x2cbe25);}}),router[a0_0x201bb0(0x9b)]('/view/add_transfer',auth,async(_0x39be9b,_0x1520d7)=>{var _0x1bfe29=a0_0x201bb0;try{console['log'](_0x39be9b[_0x1bfe29(0x126)]);const {date:_0x1b15a5,from_warehouse:_0x56e180,FromRoom_name:_0x27728e,to_warehouse:_0x7ab583,ToRoom_name:_0xc05860,prod_name:_0x394caa,from_prod_qty:_0x2b1dfd,from_prod_level:_0x316772,from_prod_isle:_0xe3696f,from_prod_pallet:_0x3db2a2,to_prod_qty:_0x287780,to_prod_level:_0x26cf31,to_prod_isle:_0x12b7bb,to_prod_pallet:_0x4fccbd,primary_code:_0xb49c6c,secondary_code:_0x1872e8,product_code3:_0x34512d,note:_0x20927f,MaxStocks_data2:_0x587297,invoice:_0x1b78c7,expiry_date:_0x39a193}=_0x39be9b['body'];if(typeof _0x394caa==_0x1bfe29(0x113))var _0x391af1=[_0x39be9b['body'][_0x1bfe29(0x117)]],_0x40a433=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0x14b)]],_0x1c9aec=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xe9)]],_0x2c95f3=[_0x39be9b[_0x1bfe29(0x126)]['New_Qty_Converted']],_0x7a3c63=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xe0)]],_0x25a8b1=[_0x39be9b['body'][_0x1bfe29(0xed)]],_0x1762b6=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xd9)]],_0xbd91e9=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xf6)]],_0xd0d3db=[_0x39be9b['body'][_0x1bfe29(0x17a)]],_0x43a1e6=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xca)]],_0x1bfb12=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0x116)]],_0x49ba6f=[_0x39be9b['body'][_0x1bfe29(0xff)]],_0x2b25be=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xe7)]],_0x39c26b=[_0x39be9b['body']['max_per_unit']],_0x4127f9=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0x13c)]],_0x1e04b2=[_0x39be9b[_0x1bfe29(0x126)]['prod_cat']],_0x106991=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xa9)]],_0x24450a=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xb1)]],_0x290385=[_0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xeb)]],_0x166110=[_0x39be9b['body']['to_invoice']];else var _0x391af1=[..._0x39be9b[_0x1bfe29(0x126)]['prod_name']],_0x40a433=[..._0x39be9b[_0x1bfe29(0x126)]['from_prod_qty']],_0x1c9aec=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xe9)]],_0x2c95f3=[..._0x39be9b['body'][_0x1bfe29(0x11c)]],_0x7a3c63=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xe0)]],_0x25a8b1=[..._0x39be9b[_0x1bfe29(0x126)]['primary_code']],_0x1762b6=[..._0x39be9b['body'][_0x1bfe29(0xd9)]],_0xbd91e9=[..._0x39be9b['body'][_0x1bfe29(0xf6)]],_0xd0d3db=[..._0x39be9b['body']['MaxStocks_data2']],_0x43a1e6=[..._0x39be9b['body'][_0x1bfe29(0xca)]],_0x1bfb12=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0x116)]],_0x49ba6f=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xff)]],_0x2b25be=[..._0x39be9b['body']['expiry_date']],_0x39c26b=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0x164)]],_0x4127f9=[..._0x39be9b['body'][_0x1bfe29(0x13c)]],_0x1e04b2=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0x98)]],_0x106991=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xa9)]],_0x24450a=[..._0x39be9b[_0x1bfe29(0x126)][_0x1bfe29(0xb1)]],_0x290385=[..._0x39be9b['body'][_0x1bfe29(0xeb)]],_0x166110=[..._0x39be9b['body'][_0x1bfe29(0x110)]];const _0x2a00a7=_0x391af1['map'](_0x29393b=>{return _0x29393b={'product_name':_0x29393b};});_0x40a433[_0x1bfe29(0x107)]((_0x13243b,_0x515146)=>{var _0x1af00e=_0x1bfe29;_0x2a00a7[_0x515146][_0x1af00e(0x13d)]=_0x13243b;}),_0x290385[_0x1bfe29(0x107)]((_0x176989,_0x44a5f2)=>{var _0x472758=_0x1bfe29;_0x2a00a7[_0x44a5f2][_0x472758(0xeb)]=_0x176989;}),_0x166110[_0x1bfe29(0x107)]((_0x2a8681,_0x2318f0)=>{_0x2a00a7[_0x2318f0]['To_invoice']=_0x2a8681;}),_0x1c9aec[_0x1bfe29(0x107)]((_0x145418,_0x4e582b)=>{var _0x11e274=_0x1bfe29;_0x106991[_0x11e274(0x107)]((_0x3359d4,_0x32d70e)=>{var _0x38f6d6=_0x11e274;if(_0x3359d4==_0x38f6d6(0x111)&&_0x4e582b==_0x32d70e){var _0x20c2e1=_0x145418['slice'](0x3);_0x2a00a7[_0x4e582b][_0x38f6d6(0xaf)]=_0x145418[0x0],_0x2a00a7[_0x4e582b]['from_rack']=_0x145418[0x1],_0x2a00a7[_0x4e582b][_0x38f6d6(0xae)]=0x0,_0x2a00a7[_0x4e582b]['from_bin']=0x0,_0x2a00a7[_0x4e582b][_0x38f6d6(0xa0)]=_0x38f6d6(0x168),_0x2a00a7[_0x4e582b][_0x38f6d6(0xce)]=_0x20c2e1;}else{if(_0x3359d4==_0x38f6d6(0x120)&&_0x4e582b==_0x32d70e){var _0x20c2e1=_0x145418['slice'](0x3);_0x2a00a7[_0x4e582b][_0x38f6d6(0xaf)]=_0x145418[0x0],_0x2a00a7[_0x4e582b][_0x38f6d6(0x165)]=_0x145418[0x1],_0x2a00a7[_0x4e582b]['from_bay']=0x0,_0x2a00a7[_0x4e582b][_0x38f6d6(0x14c)]=0x0,_0x2a00a7[_0x4e582b]['from_types']=_0x38f6d6(0x168),_0x2a00a7[_0x4e582b][_0x38f6d6(0xce)]=_0x145418[0x5];}else{if(_0x4e582b==_0x32d70e){var _0x34ba0f;if(_0x145418[0x4]=='L')_0x34ba0f='Level';else _0x145418[0x4]=='F'&&(_0x34ba0f=_0x38f6d6(0x168));_0x2a00a7[_0x4e582b][_0x38f6d6(0xaf)]=_0x145418[0x0],_0x2a00a7[_0x4e582b][_0x38f6d6(0x165)]=_0x145418[0x1],_0x2a00a7[_0x4e582b][_0x38f6d6(0xae)]=_0x145418[0x2],_0x2a00a7[_0x4e582b]['from_bin']=_0x145418[0x3],_0x2a00a7[_0x4e582b][_0x38f6d6(0xa0)]=_0x34ba0f,_0x2a00a7[_0x4e582b][_0x38f6d6(0xce)]=_0x145418[0x5];}}}});}),_0x2c95f3[_0x1bfe29(0x107)]((_0x3a93fa,_0x2dd365)=>{var _0x14261e=_0x1bfe29;_0x2a00a7[_0x2dd365][_0x14261e(0x180)]=_0x3a93fa;}),_0x7a3c63[_0x1bfe29(0x107)]((_0x2d4edd,_0x5d4cd3)=>{var _0x2fc54e=_0x1bfe29;_0x24450a[_0x2fc54e(0x107)]((_0xcb647d,_0x2d4fab)=>{var _0x15dbc4=_0x2fc54e;if(_0xcb647d==_0x15dbc4(0x111)&&_0x5d4cd3==_0x2d4fab){var _0x26a475=_0x2d4edd[_0x15dbc4(0x161)](0x3);_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x101)]=_0x2d4edd[0x0],_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x11e)]=_0x2d4edd[0x1],_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x9e)]=0x0,_0x2a00a7[_0x5d4cd3][_0x15dbc4(0xde)]=0x0,_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x90)]=_0x15dbc4(0x168),_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x94)]=_0x26a475;}else{if(_0xcb647d=='Shelves'&&_0x5d4cd3==_0x2d4fab){var _0x26a475=_0x2d4edd[_0x15dbc4(0x161)](0x3);_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x101)]=_0x2d4edd[0x0],_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x11e)]=_0x2d4edd[0x1],_0x2a00a7[_0x5d4cd3]['to_bay']=0x0,_0x2a00a7[_0x5d4cd3][_0x15dbc4(0xde)]=0x0,_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x90)]=_0x15dbc4(0x168),_0x2a00a7[_0x5d4cd3]['to_floorlevel']=_0x2d4edd[0x5];}else{if(_0x5d4cd3==_0x2d4fab){var _0x397fbf;if(_0x2d4edd[0x4]=='L')_0x397fbf=_0x15dbc4(0xba);else _0x2d4edd[0x4]=='F'&&(_0x397fbf=_0x15dbc4(0x168));_0x2a00a7[_0x5d4cd3]['storage']=_0x2d4edd[0x0],_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x11e)]=_0x2d4edd[0x1],_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x9e)]=_0x2d4edd[0x2],_0x2a00a7[_0x5d4cd3]['to_bin']=_0x2d4edd[0x3],_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x90)]=_0x397fbf,_0x2a00a7[_0x5d4cd3][_0x15dbc4(0x94)]=_0x2d4edd[0x5];}}}});}),_0x25a8b1[_0x1bfe29(0x107)]((_0x4c8cc6,_0x3c6058)=>{var _0x4d9283=_0x1bfe29;_0x2a00a7[_0x3c6058][_0x4d9283(0xed)]=_0x4c8cc6;}),_0x1762b6[_0x1bfe29(0x107)]((_0x4651b1,_0x105089)=>{var _0x312a57=_0x1bfe29;_0x2a00a7[_0x105089][_0x312a57(0xd9)]=_0x4651b1;}),_0xbd91e9[_0x1bfe29(0x107)]((_0x1deca9,_0x4c0fc4)=>{_0x2a00a7[_0x4c0fc4]['product_code']=_0x1deca9;}),_0xd0d3db[_0x1bfe29(0x107)]((_0x3d0d18,_0x331c45)=>{var _0xea1d20=_0x1bfe29;_0x2a00a7[_0x331c45][_0xea1d20(0x175)]=_0x3d0d18;}),_0x43a1e6[_0x1bfe29(0x107)]((_0x4fd744,_0x2e7f77)=>{var _0x281f85=_0x1bfe29;_0x2a00a7[_0x2e7f77][_0x281f85(0xfd)]=_0x4fd744;}),_0x1bfb12[_0x1bfe29(0x107)]((_0x4e8802,_0x23bca3)=>{var _0x72cb58=_0x1bfe29;_0x2a00a7[_0x23bca3][_0x72cb58(0x116)]=_0x4e8802;}),_0x49ba6f[_0x1bfe29(0x107)]((_0x21f700,_0x474b95)=>{var _0x151539=_0x1bfe29;_0x2a00a7[_0x474b95][_0x151539(0xff)]=_0x21f700;}),_0x2b25be[_0x1bfe29(0x107)]((_0xea0760,_0x4a023c)=>{_0x2a00a7[_0x4a023c]['expiry_date']=_0xea0760;}),_0x39c26b['forEach']((_0x1b1f12,_0xa17e)=>{var _0x32a9db=_0x1bfe29;_0x2a00a7[_0xa17e][_0x32a9db(0x173)]=_0x1b1f12;}),_0x4127f9['forEach']((_0x338e1b,_0x4e4c57)=>{var _0x2abe2a=_0x1bfe29;_0x2a00a7[_0x4e4c57][_0x2abe2a(0x13c)]=_0x338e1b;}),_0x1e04b2[_0x1bfe29(0x107)]((_0x5ec662,_0x4dc8ed)=>{_0x2a00a7[_0x4dc8ed]['prod_cat']=_0x5ec662;}),_0x106991['forEach']((_0x4922fe,_0x2ea5f3)=>{var _0x15d724=_0x1bfe29;_0x2a00a7[_0x2ea5f3][_0x15d724(0x176)]=_0x4922fe;}),_0x24450a[_0x1bfe29(0x107)]((_0x4666d6,_0x1d80e9)=>{var _0x4bcbe0=_0x1bfe29;_0x2a00a7[_0x1d80e9][_0x4bcbe0(0x152)]=_0x4666d6;});const _0x3a36ff=_0x2a00a7[_0x1bfe29(0xf9)](_0x9c5310=>_0x9c5310[_0x1bfe29(0x180)]!=='0'&&_0x9c5310[_0x1bfe29(0x180)]!==''||_0x9c5310[_0x1bfe29(0x94)]!=='0'&&_0x9c5310['to_floorlevel']!==''),_0x3b22b7=new transfers({'date':_0x1b15a5,'from_warehouse':_0x56e180,'to_warehouse':_0x7ab583,'product':_0x3a36ff,'note':_0x20927f,'invoice':_0x1b78c7}),_0x1aac74=await _0x3b22b7['save']();_0x39be9b[_0x1bfe29(0xc5)](_0x1bfe29(0xb2),_0x1bfe29(0xc8)),_0x1520d7['redirect'](_0x1bfe29(0x149)+_0x1aac74['_id']);}catch(_0x5100fb){console[_0x1bfe29(0x14d)](_0x5100fb),_0x1520d7[_0x1bfe29(0x171)](0xc8)[_0x1bfe29(0x12e)]({'errorMessage':_0x5100fb[_0x1bfe29(0x139)]});}}),router['get'](a0_0x201bb0(0xf3),auth,async(_0x3947b4,_0x2ffb88)=>{var _0x58f5f7=a0_0x201bb0;try{const {username:_0x3b0c05,email:_0xa36552,role:_0x435f27}=_0x3947b4['user'],_0x136119=_0x3947b4['user'],_0x381505=await profile[_0x58f5f7(0xab)]({'email':_0x136119[_0x58f5f7(0x17c)]}),_0x1701e5=await master_shop[_0x58f5f7(0xd6)]();console['log'](_0x58f5f7(0x163),_0x1701e5);const _0xfac595=await transfers[_0x58f5f7(0x156)](_0x3947b4[_0x58f5f7(0x13a)]['id']);let _0x243969=new Date(_0xfac595[_0x58f5f7(0xe7)]),_0x52000d=('0'+_0x243969[_0x58f5f7(0xe4)]())[_0x58f5f7(0x161)](-0x2),_0x2c241c=('0'+(_0x243969[_0x58f5f7(0x115)]()+0x1))['slice'](-0x2),_0x2b4382=_0x243969['getFullYear'](),_0x3de8d7=_0x2b4382+'-'+_0x2c241c+'-'+_0x52000d,_0x3e4ab3;if(_0x136119[_0x58f5f7(0xa6)]==_0x58f5f7(0x125)){const _0x11cb3d=await staff[_0x58f5f7(0xab)]({'email':_0x136119['email']});_0x3e4ab3=await warehouse[_0x58f5f7(0xd6)]({'status':_0x58f5f7(0x143),'name':_0x11cb3d['warehouse'],'warehouse_category':_0x58f5f7(0xd0)});}else _0x3e4ab3=await warehouse['find']({'status':_0x58f5f7(0x143),'warehouse_category':'Raw\x20Materials'});const _0x3ff6c8=await warehouse[_0x58f5f7(0xbc)]([{'$match':{'name':_0xfac595[_0x58f5f7(0x186)]}},{'$unwind':_0x58f5f7(0xcd)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x58f5f7(0xa5)},'product_stock':{'$first':_0x58f5f7(0xac)},'bay':{'$first':_0x58f5f7(0xf4)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x58f5f7(0xc0)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x58f5f7(0x10b)},'secondary_code':{'$first':_0x58f5f7(0x16c)},'product_code':{'$first':_0x58f5f7(0x12b)},'storage':{'$first':_0x58f5f7(0x145)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x58f5f7(0x10f)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x58f5f7(0x16d)}}}]);if(_0x1701e5[0x0][_0x58f5f7(0x92)]==_0x58f5f7(0x150)){var _0x135163=users['English'];console[_0x58f5f7(0x14d)](_0x135163);}else{if(_0x1701e5[0x0][_0x58f5f7(0x92)]==_0x58f5f7(0xea))var _0x135163=users['Hindi'];else{if(_0x1701e5[0x0][_0x58f5f7(0x92)]==_0x58f5f7(0x14e))var _0x135163=users[_0x58f5f7(0x14e)];else{if(_0x1701e5[0x0][_0x58f5f7(0x92)]==_0x58f5f7(0x15f))var _0x135163=users[_0x58f5f7(0x15f)];else{if(_0x1701e5[0x0][_0x58f5f7(0x92)]==_0x58f5f7(0x9d))var _0x135163=users[_0x58f5f7(0x9d)];else{if(_0x1701e5[0x0][_0x58f5f7(0x92)]=='Portuguese\x20(BR)')var _0x135163=users[_0x58f5f7(0x97)];else{if(_0x1701e5[0x0][_0x58f5f7(0x92)]==_0x58f5f7(0x16b))var _0x135163=users['Chinese'];else{if(_0x1701e5[0x0][_0x58f5f7(0x92)]=='Arabic\x20(ae)')var _0x135163=users['Arabic'];}}}}}}}_0x2ffb88[_0x58f5f7(0x10e)](_0x58f5f7(0xf1),{'success':_0x3947b4[_0x58f5f7(0xc5)]('success'),'errors':_0x3947b4[_0x58f5f7(0xc5)](_0x58f5f7(0xc9)),'role':_0x136119,'profile':_0x381505,'master_shop':_0x1701e5,'warehouse':_0x3e4ab3,'transfer':_0xfac595,'stock':_0x3ff6c8,'language':_0x135163});}catch(_0x39d9bf){console[_0x58f5f7(0x14d)](_0x39d9bf);}}),router[a0_0x201bb0(0x9b)](a0_0x201bb0(0xf3),auth,async(_0x3c17b8,_0x120b2c)=>{var _0x48ae33=a0_0x201bb0;try{const _0x2e53be=_0x3c17b8[_0x48ae33(0x13a)]['id'],{from_warehouse:_0x1d8bf3,FromRoom_name:_0x3a240e,to_warehouse:_0x2fe772,ToRoom_name:_0x5b8e43}=_0x3c17b8[_0x48ae33(0x126)],_0x46cc01=await transfers[_0x48ae33(0x156)]({'_id':_0x2e53be}),_0x19e0ee=_0x46cc01[_0x48ae33(0xe5)][_0x48ae33(0x99)](async _0x10d41d=>{var _0x780935=_0x48ae33;if(_0x10d41d[_0x780935(0x180)]>0x0){var _0x2ce91a=await warehouse[_0x780935(0xab)]({'name':_0x46cc01[_0x780935(0x186)],'room':_0x10d41d['from_room_name'],'warehouse_category':_0x780935(0xd0)});const _0x4bd24c=_0x2ce91a[_0x780935(0x16f)][_0x780935(0x99)](_0x5c0e4e=>{var _0x242f98=_0x780935;_0x5c0e4e['product_name']==_0x10d41d['product_name']&&_0x5c0e4e[_0x242f98(0x13f)]==_0x10d41d[_0x242f98(0xce)]&&_0x5c0e4e[_0x242f98(0x178)]==_0x10d41d[_0x242f98(0xa0)]&&_0x5c0e4e[_0x242f98(0x179)]==_0x10d41d['from_bin']&&_0x5c0e4e['bay']==_0x10d41d[_0x242f98(0xae)]&&_0x5c0e4e['rack']==_0x10d41d[_0x242f98(0x165)]&&_0x5c0e4e['storage']==_0x10d41d[_0x242f98(0xaf)]&&_0x5c0e4e['expiry_date']==_0x10d41d[_0x242f98(0xe7)]&&_0x5c0e4e[_0x242f98(0xff)]==_0x10d41d['batch_code']&&_0x5c0e4e[_0x242f98(0x13c)]==_0x10d41d[_0x242f98(0x13c)]&&_0x5c0e4e[_0x242f98(0x11b)]==_0x10d41d['from_invoice']&&(_0x5c0e4e['product_stock']=_0x5c0e4e[_0x242f98(0x93)]-_0x10d41d[_0x242f98(0x180)]);});}return _0x2ce91a;});Promise[_0x48ae33(0x123)](_0x19e0ee)['then'](async _0x329a6b=>{var _0x53f1cb=_0x48ae33;try{for(const _0x1370ec of _0x329a6b){await _0x1370ec['save']();}try{const _0x1b659a=_0x46cc01[_0x53f1cb(0xe5)]['map'](async _0xe798d3=>{var _0x146633=_0x53f1cb;if(_0xe798d3[_0x146633(0x180)]>0x0){var _0x243e0f=await warehouse[_0x146633(0xab)]({'name':_0x46cc01[_0x146633(0xd8)],'room':_0xe798d3[_0x146633(0x152)],'warehouse_category':_0x146633(0xd0)}),_0x4e9f2f=0x0;const _0x33ca40=_0x243e0f[_0x146633(0x16f)]['map'](_0x59beac=>{var _0x4a0fcf=_0x146633;_0x59beac['product_name']==_0xe798d3[_0x4a0fcf(0x170)]&&_0x59beac[_0x4a0fcf(0x13f)]==_0xe798d3[_0x4a0fcf(0x94)]&&_0x59beac[_0x4a0fcf(0x178)]==_0xe798d3[_0x4a0fcf(0x90)]&&_0x59beac[_0x4a0fcf(0x179)]==_0xe798d3[_0x4a0fcf(0xde)]&&_0x59beac['bay']==_0xe798d3['to_bay']&&_0x59beac[_0x4a0fcf(0x11e)]==_0xe798d3[_0x4a0fcf(0x11e)]&&_0x59beac['storage']==_0xe798d3['storage']&&_0x59beac['expiry_date']==_0xe798d3[_0x4a0fcf(0xe7)]&&_0x59beac[_0x4a0fcf(0xff)]==_0xe798d3[_0x4a0fcf(0xff)]&&_0x59beac['production_date']==_0xe798d3[_0x4a0fcf(0x13c)]&&_0x59beac[_0x4a0fcf(0x11b)]==_0xe798d3['To_invoice']&&(_0x59beac[_0x4a0fcf(0x93)]=_0x59beac[_0x4a0fcf(0x93)]+_0xe798d3[_0x4a0fcf(0x180)],_0x4e9f2f++);});_0x4e9f2f=='0'&&(_0x243e0f['product_details']=_0x243e0f['product_details'][_0x146633(0x144)]({'product_name':_0xe798d3[_0x146633(0x170)],'product_stock':_0xe798d3['to_quantity'],'bay':_0xe798d3['to_bay'],'bin':_0xe798d3[_0x146633(0xde)],'type':_0xe798d3[_0x146633(0x90)],'floorlevel':_0xe798d3[_0x146633(0x94)],'storage':_0xe798d3[_0x146633(0x101)],'rack':_0xe798d3[_0x146633(0x11e)],'product_code':_0xe798d3[_0x146633(0x15a)],'primary_code':_0xe798d3[_0x146633(0xed)],'secondary_code':_0xe798d3[_0x146633(0xd9)],'maxProducts':_0xe798d3['maxProducts'],'storage':_0xe798d3[_0x146633(0x101)],'rack':_0xe798d3[_0x146633(0x11e)],'expiry_date':_0xe798d3[_0x146633(0xe7)],'maxPerUnit':_0xe798d3['maxperunit'],'batch_code':_0xe798d3[_0x146633(0xff)],'production_date':_0xe798d3[_0x146633(0x13c)]}));}return _0x243e0f;});Promise['all'](_0x1b659a)[_0x53f1cb(0xbd)](async _0x345c8e=>{var _0xe076af=_0x53f1cb;try{for(const _0x43a8e3 of _0x345c8e){await warehouse[_0xe076af(0xd7)]({'_id':_0x43a8e3[_0xe076af(0xd1)]},{'$addToSet':{'product_details':{'$each':_0x43a8e3[_0xe076af(0x16f)]}}});}_0x46cc01[_0xe076af(0xfa)]='True';const _0x5e7f73=await _0x46cc01['save'](),_0x52786d=await master_shop[_0xe076af(0xd6)](),_0x4f9423=await email_settings[_0xe076af(0xab)](),_0x25cb35=await supervisor_settings[_0xe076af(0xd6)]();var _0x2743ce=_0x46cc01['product'],_0x577a43='',_0x4969da;for(_0x4969da in _0x2743ce){_0x577a43+=_0xe076af(0xe2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2743ce[_0x4969da][_0xe076af(0x170)]+_0xe076af(0x10d)+_0xe076af(0x96)+_0x2743ce[_0x4969da][_0xe076af(0x15a)]+_0xe076af(0x10d)+_0xe076af(0x96)+_0x2743ce[_0x4969da]['to_quantity']+_0xe076af(0x10d)+_0xe076af(0x96)+_0x2743ce[_0x4969da]['unit']+'</td>'+_0xe076af(0x96)+_0x2743ce[_0x4969da][_0xe076af(0x116)]+_0xe076af(0x10d)+_0xe076af(0x96)+_0x46cc01[_0xe076af(0xd8)]+_0xe076af(0x10d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2743ce[_0x4969da]['to_room_name']+_0xe076af(0x10d)+_0xe076af(0x96)+_0x2743ce[_0x4969da][_0xe076af(0x101)]+_0x2743ce[_0x4969da][_0xe076af(0x11e)]+_0x2743ce[_0x4969da]['to_bay']+_0x2743ce[_0x4969da][_0xe076af(0xde)]+_0x2743ce[_0x4969da][_0xe076af(0x90)][0x0]+_0x2743ce[_0x4969da][_0xe076af(0x94)]+_0xe076af(0x10d),_0xe076af(0xf0);}let _0x3c421c=nodemailer[_0xe076af(0x102)]({'host':_0x4f9423[_0xe076af(0x172)],'port':Number(_0x4f9423[_0xe076af(0xaa)]),'secure':![],'auth':{'user':_0x4f9423[_0xe076af(0x17c)],'pass':_0x4f9423[_0xe076af(0xd3)]}}),_0x584255={'from':_0x4f9423['email'],'to':_0x25cb35[0x0][_0xe076af(0x127)],'subject':_0xe076af(0x9f),'attachments':[{'filename':_0xe076af(0xd4),'path':__dirname+'/../public'+_0xe076af(0x13b)+_0x52786d[0x0][_0xe076af(0x158)],'cid':'logo'}],'html':_0xe076af(0xb4)+_0xe076af(0xc1)+'</head><body>'+_0xe076af(0xa2)+_0xe076af(0x138)+'<div>'+_0xe076af(0x15b)+_0xe076af(0xf2)+'<div>'+_0xe076af(0x14a)+_0x52786d[0x0]['site_title']+_0xe076af(0x104)+'</div>'+_0xe076af(0xf2)+'<hr\x20class=\x22my-3\x22>'+_0xe076af(0xa2)+_0xe076af(0x11a)+_0xe076af(0x142)+_0x46cc01[_0xe076af(0x11b)]+'\x20'+_0xe076af(0x16a)+'\x20Order\x20Date\x20:\x20'+_0x46cc01['date']+'\x20'+_0xe076af(0xad)+_0xe076af(0x118)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xe076af(0xc7)+'<tr>'+_0xe076af(0x174)+_0xe076af(0x153)+_0xe076af(0x95)+_0xe076af(0xc4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0xe076af(0x148)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0xe076af(0x15d)+_0xe076af(0xf0)+_0xe076af(0x10c)+_0xe076af(0xb3)+'\x20'+_0x577a43+'\x20'+_0xe076af(0x112)+_0xe076af(0xdd)+_0xe076af(0xa2)+'<strong>\x20Regards\x20</strong>'+_0xe076af(0x134)+_0x52786d[0x0][_0xe076af(0xcf)]+_0xe076af(0x118)+_0xe076af(0xf2)+'</div>'+_0xe076af(0xc6)};_0x3c421c[_0xe076af(0x137)](_0x584255,function(_0x270dae,_0x1d67b5){var _0x4ed043=_0xe076af;_0x270dae?(console[_0x4ed043(0x14d)](_0x270dae),console[_0x4ed043(0x14d)](_0x4ed043(0x12f))):console[_0x4ed043(0x14d)](_0x4ed043(0x17d));}),_0x3c17b8[_0xe076af(0xc5)](_0xe076af(0xb2),_0xe076af(0x169)),_0x120b2c['redirect'](_0xe076af(0x108)+_0x5e7f73['_id']);}catch(_0x3a32b4){console[_0xe076af(0x12c)](_0x3a32b4),_0x120b2c[_0xe076af(0x171)](0x1f4)[_0xe076af(0x12e)]({'Perror':_0xe076af(0xf5),'message':_0x3a32b4[_0xe076af(0x139)]});}})[_0x53f1cb(0xef)](_0x218304=>{var _0x28cb7c=_0x53f1cb;console['error'](_0x218304),_0x120b2c[_0x28cb7c(0x171)](0x1f4)[_0x28cb7c(0x12e)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x4533fb){_0x120b2c[_0x53f1cb(0x12e)](_0x4533fb);}}catch(_0x333c5d){console['error'](_0x333c5d),_0x120b2c[_0x53f1cb(0x171)](0x1f4)['json']({'Merror':_0x53f1cb(0xf5),'Message':_0x333c5d[_0x53f1cb(0x139)]});}})['catch'](_0xb17a44=>{var _0x1f9aeb=_0x48ae33;console[_0x1f9aeb(0x12c)](_0xb17a44),_0x120b2c[_0x1f9aeb(0x171)](0x1f4)['json']({'Merror':_0x1f9aeb(0x135)});});}catch(_0x2adf54){console[_0x48ae33(0x14d)](_0x2adf54);}});function BayBinSelected(_0x20600b,_0x4dfa2c){var _0x4335a0=a0_0x201bb0,_0x136a2e=[],_0x10138f=[],_0x538b3a=[],_0x276876=[],_0x575773=[],_0x2f9c6b=[];let _0x4c15d0=[];if(_0x20600b==_0x4335a0(0xfb))switch(_0x4dfa2c){case'Rack\x20A':_0x136a2e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x10138f=[0x1,0x2],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=[_0x4335a0(0xba),_0x4335a0(0x168)],_0x575773=['D'],_0x2f9c6b=['A'];break;case _0x4335a0(0xdb):_0x136a2e=[0x6,0x5,0x4,0x3,0x2,0x1],_0x10138f=[0x1,0x2],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=[_0x4335a0(0xba),_0x4335a0(0x168)],_0x575773=['D'],_0x2f9c6b=['B'];break;case'Shelves':_0x136a2e=[0x0],_0x10138f=[0x0],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=['Floor'],_0x575773=['D'],_0x2f9c6b=['S'];break;case _0x4335a0(0x111):_0x136a2e=[0x0],_0x10138f=[0x0],_0x276876=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x538b3a=[_0x4335a0(0x168)],_0x575773=['D'],_0x2f9c6b=['R'];break;}else{if(_0x20600b=='COLD\x20STORAGE')switch(_0x4dfa2c){case _0x4335a0(0xb5):_0x136a2e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x10138f=['B','F'],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=[_0x4335a0(0xba),_0x4335a0(0x168)],_0x575773=['C'],_0x2f9c6b=['A'];break;case _0x4335a0(0xdb):_0x136a2e=[0x5,0x4,0x3,0x2,0x1],_0x10138f=['F','B','S'],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=[_0x4335a0(0xba),_0x4335a0(0x168)],_0x575773=['C'],_0x2f9c6b=['B'];break;case _0x4335a0(0x17b):_0x136a2e=[0x1,0x2,0x3,0x4,0x5],_0x10138f=['B','F','S'],_0x276876=[0x5,0x4,0x3,0x2,0x1],_0x538b3a=[_0x4335a0(0xba),_0x4335a0(0x168)],_0x575773=['C'],_0x2f9c6b=['C'];break;case _0x4335a0(0xf7):_0x136a2e=[0x5,0x4,0x3,0x2,0x1],_0x10138f=['F','B','S'],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=[_0x4335a0(0xba),_0x4335a0(0x168)],_0x575773=['C'],_0x2f9c6b=['D'];break;case _0x4335a0(0x100):_0x136a2e=[0x4,0x3,0x2,0x1],_0x10138f=[0x1,0x2],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=[_0x4335a0(0xba),'Floor'],_0x575773=['C'],_0x2f9c6b=['E'];break;case _0x4335a0(0xbb):_0x136a2e=[0x1,0x2,0x3],_0x10138f=[0x1,0x2],_0x276876=[0x1,0x2,0x3,0x4,0x5],_0x538b3a=['Level'],_0x575773=['C'],_0x2f9c6b=['F'];break;}}return{'levels':_0x136a2e,'Isle':_0x10138f,'rack':_0x276876,'type':_0x538b3a,'storage':_0x575773,'rak':_0x2f9c6b};}router[a0_0x201bb0(0x15c)]('/view/:id',auth,async(_0x11756e,_0x2a42b9)=>{var _0x2efc8b=a0_0x201bb0;try{const {username:_0x490489,email:_0x2d94f9,role:_0x32d80f}=_0x11756e['user'],_0x395c07=_0x11756e[_0x2efc8b(0x185)],_0x556c93=await profile[_0x2efc8b(0xab)]({'email':_0x395c07[_0x2efc8b(0x17c)]}),_0x31d0a5=await master_shop[_0x2efc8b(0xd6)](),_0x37ce76=await transfers[_0x2efc8b(0x156)](_0x11756e['params']['id']);let _0x4f74e4;if(_0x395c07['role']==_0x2efc8b(0x125)){const _0x193247=await staff[_0x2efc8b(0xab)]({'email':_0x395c07[_0x2efc8b(0x17c)]});_0x4f74e4=await warehouse[_0x2efc8b(0xbc)]([{'$match':{'status':'Enabled','name':_0x193247[_0x2efc8b(0x133)],'warehouse_category':_0x2efc8b(0xd0)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x4f74e4=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x2efc8b(0xd0)}},{'$group':{'_id':_0x2efc8b(0xa8),'name':{'$first':_0x2efc8b(0xa8)}}}]);const _0x4589f1=await warehouse[_0x2efc8b(0xbc)]([{'$match':{'name':_0x37ce76[_0x2efc8b(0x186)],'warehouse_category':_0x2efc8b(0xd0)}},{'$unwind':_0x2efc8b(0xcd)},{'$group':{'_id':_0x2efc8b(0x13e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2efc8b(0xf4)},'bin':{'$first':_0x2efc8b(0xcc)},'type':{'$first':_0x2efc8b(0xc0)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2efc8b(0x16c)},'product_code':{'$first':_0x2efc8b(0x12b)},'storage':{'$first':_0x2efc8b(0x145)},'rack':{'$first':_0x2efc8b(0x11f)},'expiry_date':{'$first':_0x2efc8b(0x10f)},'production_date':{'$first':_0x2efc8b(0x17e)},'room':{'$first':_0x2efc8b(0x16d)}}}]),_0x3d5043=await product['find']({}),_0x31130d=BayBinSelected(_0x37ce76[_0x2efc8b(0xd8)],_0x37ce76[_0x2efc8b(0x157)]);if(_0x31d0a5[0x0][_0x2efc8b(0x92)]=='English\x20(US)'){var _0x4f4a9c=users['English'];console[_0x2efc8b(0x14d)](_0x4f4a9c);}else{if(_0x31d0a5[0x0]['language']==_0x2efc8b(0xea))var _0x4f4a9c=users[_0x2efc8b(0xea)];else{if(_0x31d0a5[0x0][_0x2efc8b(0x92)]==_0x2efc8b(0x14e))var _0x4f4a9c=users['German'];else{if(_0x31d0a5[0x0][_0x2efc8b(0x92)]==_0x2efc8b(0x15f))var _0x4f4a9c=users[_0x2efc8b(0x15f)];else{if(_0x31d0a5[0x0][_0x2efc8b(0x92)]==_0x2efc8b(0x9d))var _0x4f4a9c=users['French'];else{if(_0x31d0a5[0x0][_0x2efc8b(0x92)]==_0x2efc8b(0xa4))var _0x4f4a9c=users[_0x2efc8b(0x97)];else{if(_0x31d0a5[0x0][_0x2efc8b(0x92)]=='Chinese')var _0x4f4a9c=users[_0x2efc8b(0x16b)];else{if(_0x31d0a5[0x0]['language']=='Arabic\x20(ae)')var _0x4f4a9c=users['Arabic'];}}}}}}}_0x2a42b9[_0x2efc8b(0x10e)](_0x2efc8b(0x124),{'success':_0x11756e[_0x2efc8b(0xc5)](_0x2efc8b(0xb2)),'errors':_0x11756e[_0x2efc8b(0xc5)](_0x2efc8b(0xc9)),'role':_0x395c07,'profile':_0x556c93,'master_shop':_0x31d0a5,'warehouse':_0x4f74e4,'transfer':_0x37ce76,'stock':_0x4589f1,'unit':_0x3d5043,'language':_0x4f4a9c});}catch(_0x5b17c2){console['log'](_0x5b17c2);}}),router[a0_0x201bb0(0x9b)](a0_0x201bb0(0x114),auth,async(_0x5df847,_0x5a414a)=>{var _0x58db0d=a0_0x201bb0;try{const _0x40a9d7=_0x5df847[_0x58db0d(0x13a)]['id'],_0x4dbe9d=await transfers[_0x58db0d(0x156)](_0x40a9d7);_0x5a414a['json'](_0x5df847[_0x58db0d(0x126)]);return;const {date:_0x56672e,from_warehouse:_0x1a09c,FromRoom_name:_0x3624e8,to_warehouse:_0x3480a5,ToRoom_name:_0x2a3571,prod_name:_0x224dad,from_prod_qty:_0x4f182c,from_prod_level:_0x1ed33c,from_prod_isle:_0x171b8c,from_prod_pallet:_0x55f5f5,to_prod_qty:_0x571a1a,to_prod_level:_0x34572e,to_prod_isle:_0x3012d2,to_prod_pallet:_0x53dc52,primary_code:_0x3e8796,secondary_code:_0x29afa8,product_code3:_0x9d946a,note:_0x4b725c,invoice:_0x1e1301,expiry_date:_0x405601}=_0x5df847[_0x58db0d(0x126)];if(typeof _0x224dad==_0x58db0d(0x113))var _0x4f4e12=[_0x5df847[_0x58db0d(0x126)]['prod_name']],_0x1821f2=[_0x5df847[_0x58db0d(0x126)]['from_prod_qty']],_0x26e841=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0xe9)]],_0x465c00=[_0x5df847['body'][_0x58db0d(0xd2)]],_0x347ab0=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0x122)]],_0x4563e2=[_0x5df847[_0x58db0d(0x126)]['from_types']],_0x3b97b6=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0x167)]],_0x354753=[_0x5df847['body'][_0x58db0d(0xe0)]],_0x409d6c=[_0x5df847[_0x58db0d(0x126)]['to_prod_isle']],_0x2de4e8=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0x183)]],_0x1716f7=[_0x5df847[_0x58db0d(0x126)]['to_types']],_0x257f4e=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0x101)]],_0x5564a9=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0x151)]],_0x5413cf=[_0x5df847['body'][_0x58db0d(0xed)]],_0x419279=[_0x5df847[_0x58db0d(0x126)]['secondary_code']],_0x3a4665=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0xf6)]],_0x32896f=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0x17a)]],_0x213cd2=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0xfd)]],_0x27ebbb=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0x116)]],_0x32f801=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0xff)]],_0x75a6f5=[_0x5df847['body']['expiry_date']],_0x77698e=[_0x5df847[_0x58db0d(0x126)]['from_storage']],_0x1af274=[_0x5df847[_0x58db0d(0x126)][_0x58db0d(0xbf)]];else var _0x4f4e12=[..._0x5df847['body'][_0x58db0d(0x117)]],_0x257f4e=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0x101)]],_0x5564a9=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0x151)]],_0x4563e2=[..._0x5df847[_0x58db0d(0x126)]['from_types']],_0x1716f7=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0x90)]],_0x1821f2=[..._0x5df847[_0x58db0d(0x126)]['from_prod_qty']],_0x26e841=[..._0x5df847['body'][_0x58db0d(0xe9)]],_0x465c00=[..._0x5df847[_0x58db0d(0x126)]['from_prod_isle']],_0x347ab0=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0x122)]],_0x3b97b6=[..._0x5df847[_0x58db0d(0x126)]['to_prod_qty']],_0x354753=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0xe0)]],_0x409d6c=[..._0x5df847['body'][_0x58db0d(0x91)]],_0x2de4e8=[..._0x5df847['body'][_0x58db0d(0x183)]],_0x5413cf=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0xed)]],_0x419279=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0xd9)]],_0x3a4665=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0xf6)]],_0x32896f=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0x17a)]],_0x213cd2=[..._0x5df847[_0x58db0d(0x126)]['unit']],_0x27ebbb=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0x116)]],_0x32f801=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0xff)]],_0x75a6f5=[..._0x5df847[_0x58db0d(0x126)]['expiry_date']],_0x77698e=[..._0x5df847['body'][_0x58db0d(0xaf)]],_0x1af274=[..._0x5df847[_0x58db0d(0x126)][_0x58db0d(0xbf)]];const _0x4e31af=_0x4f4e12[_0x58db0d(0x99)](_0x52187e=>{return _0x52187e={'product_name':_0x52187e};});_0x1821f2['forEach']((_0x3e6cc1,_0x53e35c)=>{var _0x35ad69=_0x58db0d;_0x4e31af[_0x53e35c][_0x35ad69(0x13d)]=_0x3e6cc1;}),_0x26e841[_0x58db0d(0x107)]((_0x3bb9fe,_0x40a4bb)=>{var _0x4a09bf=_0x58db0d;_0x4e31af[_0x40a4bb][_0x4a09bf(0xae)]=_0x3bb9fe;}),_0x465c00[_0x58db0d(0x107)]((_0x9ace4d,_0x20c02e)=>{var _0x18432b=_0x58db0d;_0x4e31af[_0x20c02e][_0x18432b(0x14c)]=_0x9ace4d;}),_0x347ab0['forEach']((_0x19c9bf,_0x55532f)=>{var _0x44a24b=_0x58db0d;_0x4e31af[_0x55532f][_0x44a24b(0xce)]=_0x19c9bf;}),_0x3b97b6[_0x58db0d(0x107)]((_0x3c0ab3,_0x1ed70e)=>{var _0x32203d=_0x58db0d;_0x4e31af[_0x1ed70e][_0x32203d(0x180)]=_0x3c0ab3;}),_0x354753[_0x58db0d(0x107)]((_0x1db8e1,_0x34501e)=>{var _0x56e40a=_0x58db0d;_0x4e31af[_0x34501e][_0x56e40a(0x9e)]=_0x1db8e1;}),_0x409d6c[_0x58db0d(0x107)]((_0x1b9b12,_0xba4ca0)=>{var _0x2326c6=_0x58db0d;_0x4e31af[_0xba4ca0][_0x2326c6(0xde)]=_0x1b9b12;}),_0x2de4e8['forEach']((_0x294a86,_0x4f06da)=>{var _0x3c4f1b=_0x58db0d;_0x4e31af[_0x4f06da][_0x3c4f1b(0x94)]=_0x294a86;}),_0x5413cf['forEach']((_0x545669,_0x512e76)=>{var _0x343c19=_0x58db0d;_0x4e31af[_0x512e76][_0x343c19(0xed)]=_0x545669;}),_0x419279['forEach']((_0x1c4c36,_0x2c2cfd)=>{_0x4e31af[_0x2c2cfd]['secondary_code']=_0x1c4c36;}),_0x3a4665[_0x58db0d(0x107)]((_0x458b48,_0x1c0a02)=>{_0x4e31af[_0x1c0a02]['product_code']=_0x458b48;}),_0x32896f[_0x58db0d(0x107)]((_0x504712,_0x113216)=>{var _0x14e180=_0x58db0d;_0x4e31af[_0x113216][_0x14e180(0x175)]=_0x504712;}),_0x213cd2[_0x58db0d(0x107)]((_0x2ecdb7,_0x286a4b)=>{_0x4e31af[_0x286a4b]['unit']=_0x2ecdb7;}),_0x27ebbb[_0x58db0d(0x107)]((_0x21f25d,_0x8f5846)=>{var _0x228cc6=_0x58db0d;_0x4e31af[_0x8f5846][_0x228cc6(0x116)]=_0x21f25d;}),_0x32f801['forEach']((_0x36ff8e,_0x2de07b)=>{var _0x4bbb60=_0x58db0d;_0x4e31af[_0x2de07b][_0x4bbb60(0xff)]=_0x36ff8e;}),_0x75a6f5['forEach']((_0x400a7b,_0x1fa680)=>{var _0x1823f5=_0x58db0d;_0x4e31af[_0x1fa680][_0x1823f5(0xe7)]=_0x400a7b;}),_0x257f4e['forEach']((_0x33ed0b,_0x122f4b)=>{var _0x1836bc=_0x58db0d;_0x4e31af[_0x122f4b][_0x1836bc(0x101)]=_0x33ed0b;}),_0x5564a9[_0x58db0d(0x107)]((_0x1968b9,_0x2ddd32)=>{var _0x29471a=_0x58db0d;_0x4e31af[_0x2ddd32][_0x29471a(0x11e)]=_0x1968b9;}),_0x4563e2[_0x58db0d(0x107)]((_0x564ca1,_0x34b766)=>{var _0x55b98d=_0x58db0d;_0x4e31af[_0x34b766][_0x55b98d(0xa0)]=_0x564ca1;}),_0x1716f7['forEach']((_0x4dd557,_0x49d2ad)=>{_0x4e31af[_0x49d2ad]['to_types']=_0x4dd557;}),_0x77698e[_0x58db0d(0x107)]((_0x49c01a,_0x55ade9)=>{var _0x30c999=_0x58db0d;_0x4e31af[_0x55ade9][_0x30c999(0xaf)]=_0x49c01a;}),_0x1af274[_0x58db0d(0x107)]((_0x105839,_0x154ce5)=>{var _0x389355=_0x58db0d;_0x4e31af[_0x154ce5][_0x389355(0x165)]=_0x105839;});const _0x51dd94=_0x4e31af[_0x58db0d(0xf9)](_0x4d1f72=>_0x4d1f72[_0x58db0d(0x180)]!=='0'&&_0x4d1f72[_0x58db0d(0x180)]!==''||_0x4d1f72['to_floorlevel']!=='0'&&_0x4d1f72['to_floorlevel']!=='');var _0x41e7a0=0x0;_0x51dd94[_0x58db0d(0x107)](_0x5998b1=>{var _0x50aaf8=_0x58db0d;parseInt(_0x5998b1[_0x50aaf8(0x13d)])<parseInt(_0x5998b1[_0x50aaf8(0x180)])&&_0x41e7a0++;});if(_0x41e7a0!=0x0)return _0x5df847[_0x58db0d(0xc5)](_0x58db0d(0xc9),_0x58db0d(0x109)),_0x5a414a[_0x58db0d(0x9c)](_0x58db0d(0xa1));const _0x21d2a8=await warehouse['findOne']({'name':_0x4dbe9d[_0x58db0d(0x186)],'room':_0x4dbe9d['from_room']});_0x4dbe9d[_0x58db0d(0xe5)][_0x58db0d(0x107)](_0x4b50cb=>{var _0x5e8edd=_0x58db0d;if(_0x4b50cb[_0x5e8edd(0x180)]>0x0){const _0x3d4109=_0x21d2a8['product_details'][_0x5e8edd(0x99)](_0x2c0a01=>{var _0x13a545=_0x5e8edd;_0x2c0a01[_0x13a545(0x170)]==_0x4b50cb[_0x13a545(0x170)]&&_0x2c0a01[_0x13a545(0x13f)]==_0x4b50cb[_0x13a545(0xce)]&&_0x2c0a01['type']==_0x4b50cb[_0x13a545(0xa0)]&&_0x2c0a01[_0x13a545(0x179)]==_0x4b50cb[_0x13a545(0x14c)]&&_0x2c0a01[_0x13a545(0x11d)]==_0x4b50cb['from_bay']&&_0x2c0a01[_0x13a545(0x11e)]==_0x4b50cb[_0x13a545(0x165)]&&_0x2c0a01[_0x13a545(0x101)]==_0x4b50cb[_0x13a545(0xaf)]&&(_0x2c0a01['product_stock']=parseInt(_0x2c0a01[_0x13a545(0x93)])+parseInt(_0x4b50cb['to_quantity']));});}}),await _0x21d2a8[_0x58db0d(0xf8)]();const _0x344967=await warehouse[_0x58db0d(0xab)]({'name':_0x4dbe9d[_0x58db0d(0xd8)],'room':_0x4dbe9d[_0x58db0d(0x157)]});_0x4dbe9d[_0x58db0d(0xe5)][_0x58db0d(0x107)](_0x4cd7fa=>{var _0x70601a=_0x58db0d;if(_0x4cd7fa[_0x70601a(0x180)]>0x0){const _0x58b683=_0x344967['product_details'][_0x70601a(0x99)](_0x5a7d56=>{var _0x18f0a3=_0x70601a;_0x5a7d56[_0x18f0a3(0x170)]==_0x4cd7fa[_0x18f0a3(0x170)]&&_0x5a7d56[_0x18f0a3(0x13f)]==_0x4cd7fa[_0x18f0a3(0x94)]&&_0x5a7d56[_0x18f0a3(0x178)]==_0x4cd7fa[_0x18f0a3(0x90)]&&_0x5a7d56[_0x18f0a3(0x179)]==_0x4cd7fa['to_bin']&&_0x5a7d56[_0x18f0a3(0x11d)]==_0x4cd7fa['to_bay']&&_0x5a7d56[_0x18f0a3(0x11e)]==_0x4cd7fa[_0x18f0a3(0x11e)]&&_0x5a7d56['storage']==_0x4cd7fa[_0x18f0a3(0x101)]&&(_0x5a7d56[_0x18f0a3(0x93)]=parseInt(_0x5a7d56['product_stock'])-parseInt(_0x4cd7fa['to_quantity']));});}}),await _0x344967[_0x58db0d(0xf8)](),_0x4dbe9d[_0x58db0d(0xdf)]=_0x56672e,_0x4dbe9d[_0x58db0d(0x186)]=_0x1a09c,_0x4dbe9d['to_warehouse']=_0x3480a5,_0x4dbe9d[_0x58db0d(0xe5)]=_0x51dd94,_0x4dbe9d[_0x58db0d(0x103)]=_0x4b725c,_0x4dbe9d[_0x58db0d(0x11b)]=_0x1e1301;const _0xa5da04=await _0x4dbe9d[_0x58db0d(0xf8)]();console[_0x58db0d(0x14d)](_0xa5da04);const _0x134365=await warehouse[_0x58db0d(0xab)]({'name':_0x1a09c,'room':_0x3624e8});_0xa5da04['product'][_0x58db0d(0x107)](_0x135a70=>{var _0x3cab32=_0x58db0d;if(_0x135a70[_0x3cab32(0x180)]>0x0){const _0x16a012=_0x134365[_0x3cab32(0x16f)][_0x3cab32(0x99)](_0x461c92=>{var _0x30040=_0x3cab32;_0x461c92['product_name']==_0x135a70[_0x30040(0x170)]&&_0x461c92[_0x30040(0x13f)]==_0x135a70[_0x30040(0xce)]&&_0x461c92[_0x30040(0x178)]==_0x135a70[_0x30040(0xa0)]&&_0x461c92[_0x30040(0x179)]==_0x135a70[_0x30040(0x14c)]&&_0x461c92[_0x30040(0x11d)]==_0x135a70[_0x30040(0xae)]&&_0x461c92[_0x30040(0x11e)]==_0x135a70[_0x30040(0x165)]&&_0x461c92[_0x30040(0x101)]==_0x135a70[_0x30040(0xaf)]&&(_0x461c92['product_stock']=parseInt(_0x461c92[_0x30040(0x93)])-parseInt(_0x135a70[_0x30040(0x180)]));});}}),await _0x134365['save']();const _0x573dfe=await warehouse[_0x58db0d(0xab)]({'name':_0x3480a5,'room':_0x2a3571});_0xa5da04[_0x58db0d(0xe5)]['forEach'](_0x223694=>{var _0x1c29ed=_0x58db0d;if(_0x223694['to_quantity']>0x0){var _0x16c5c0=0x0;const _0x154b04=_0x573dfe[_0x1c29ed(0x16f)][_0x1c29ed(0x99)](_0x1f74cc=>{var _0x3004f8=_0x1c29ed;_0x1f74cc['product_name']==_0x223694[_0x3004f8(0x170)]&&_0x1f74cc['floorlevel']==_0x223694[_0x3004f8(0x94)]&&_0x1f74cc[_0x3004f8(0x178)]==_0x223694['to_types']&&_0x1f74cc['bin']==_0x223694[_0x3004f8(0xde)]&&_0x1f74cc[_0x3004f8(0x11d)]==_0x223694[_0x3004f8(0x9e)]&&_0x1f74cc[_0x3004f8(0x11e)]==_0x223694[_0x3004f8(0x11e)]&&_0x1f74cc['storage']==_0x223694[_0x3004f8(0x101)]&&(_0x1f74cc[_0x3004f8(0x93)]=parseInt(_0x1f74cc['product_stock'])+parseInt(_0x223694['to_quantity']),_0x16c5c0++);});_0x16c5c0=='0'&&(_0x573dfe[_0x1c29ed(0x16f)]=_0x573dfe['product_details'][_0x1c29ed(0x144)]({'product_name':_0x223694['product_name'],'product_stock':_0x223694['to_quantity'],'bay':_0x223694[_0x1c29ed(0x9e)],'bin':_0x223694[_0x1c29ed(0xde)],'type':_0x223694[_0x1c29ed(0x90)],'floorlevel':_0x223694[_0x1c29ed(0x94)],'storage':_0x223694[_0x1c29ed(0x101)],'rack':_0x223694[_0x1c29ed(0x11e)],'product_code':_0x223694[_0x1c29ed(0x15a)],'primary_code':_0x223694[_0x1c29ed(0xed)],'secondary_code':_0x223694[_0x1c29ed(0xd9)],'maxProducts':_0x223694[_0x1c29ed(0x175)],'storage':_0x223694[_0x1c29ed(0x101)],'rack':_0x223694['rack']}));}}),await _0x573dfe[_0x58db0d(0xf8)](),_0x5df847[_0x58db0d(0xc5)]('success',_0x58db0d(0x131)),_0x5a414a[_0x58db0d(0x9c)](_0x58db0d(0xa7));}catch(_0x4986d3){console[_0x58db0d(0x14d)](_0x4986d3);}}),router['post'](a0_0x201bb0(0x16e),async(_0x163758,_0x23039a)=>{var _0x5b82c1=a0_0x201bb0;const {FromWareHouse:_0x5e347a,FromRoom:_0x9a93e6,ToWarehouse:_0x37cf54,ToRoom:_0x1070dc,primary_code:_0xd421ed,Roomslist:_0x2da21b}=_0x163758[_0x5b82c1(0x126)],_0xfe2056=_0x2da21b[_0x5b82c1(0xdc)](','),_0x39d2b7=[];async function _0x4e60bb(_0x487cbb){var _0x5a8e78=_0x5b82c1;const _0x1761e2=await warehouse[_0x5a8e78(0xbc)]([{'$match':{'name':_0x5e347a,'room':_0x487cbb}},{'$unwind':_0x5a8e78(0xcd)},{'$match':{'product_details.primary_code':_0xd421ed}},{'$group':{'_id':_0x5a8e78(0x13e),'name':{'$first':_0x5a8e78(0xa5)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5a8e78(0x10b)},'secondary_code':{'$first':_0x5a8e78(0x16c)},'product_code':{'$first':_0x5a8e78(0x12b)},'level':{'$first':_0x5a8e78(0xf4)},'isle':{'$first':_0x5a8e78(0xcc)},'type':{'$first':_0x5a8e78(0xc0)},'pallet':{'$first':_0x5a8e78(0x128)},'unit':{'$first':_0x5a8e78(0x14f)},'secondary_unit':{'$first':_0x5a8e78(0xcb)},'storage':{'$first':_0x5a8e78(0x145)},'rack':{'$first':_0x5a8e78(0x11f)},'expiry_date':{'$first':_0x5a8e78(0x10f)},'production_date':{'$first':_0x5a8e78(0x17e)},'batch_code':{'$first':_0x5a8e78(0xfe)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x5a8e78(0x12d)}}}]),_0x4ce9ab=await warehouse['aggregate']([{'$match':{'name':_0x5e347a,'room':_0x487cbb}},{'$unwind':_0x5a8e78(0xcd)},{'$match':{'product_details.secondary_code':_0xd421ed}},{'$group':{'_id':_0x5a8e78(0x13e),'name':{'$first':_0x5a8e78(0xa5)},'instock':{'$first':_0x5a8e78(0xac)},'primary_code':{'$first':_0x5a8e78(0x10b)},'secondary_code':{'$first':_0x5a8e78(0x16c)},'product_code':{'$first':_0x5a8e78(0x12b)},'level':{'$first':_0x5a8e78(0xf4)},'isle':{'$first':_0x5a8e78(0xcc)},'type':{'$first':_0x5a8e78(0xc0)},'pallet':{'$first':_0x5a8e78(0x128)},'unit':{'$first':_0x5a8e78(0x14f)},'secondary_unit':{'$first':_0x5a8e78(0xcb)},'storage':{'$first':_0x5a8e78(0x145)},'rack':{'$first':_0x5a8e78(0x11f)},'expiry_date':{'$first':_0x5a8e78(0x10f)},'production_date':{'$first':_0x5a8e78(0x17e)},'batch_code':{'$first':_0x5a8e78(0xfe)},'maxPerUnit':{'$first':_0x5a8e78(0x17f)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5a8e78(0x16d)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);if(_0x1761e2['length']>0x0)_0x39d2b7[_0x5a8e78(0x121)](_0x1761e2);else _0x4ce9ab[_0x5a8e78(0x141)]>0x0&&_0x39d2b7[_0x5a8e78(0x121)](_0x4ce9ab);}const _0x4061f9=_0xfe2056[_0x5b82c1(0x99)](_0x1b7474=>_0x4e60bb(_0x1b7474));await Promise[_0x5b82c1(0x123)](_0x4061f9),_0x23039a[_0x5b82c1(0x12e)](_0x39d2b7);}),router[a0_0x201bb0(0x9b)](a0_0x201bb0(0xc3),async(_0x4a26cd,_0x155891)=>{var _0x266beb=a0_0x201bb0;try{const {FromWareHouse:_0x54dd76,FromRoom:_0x4ed213,ToWarehouse:_0x3598d9,ToRoom:_0x4bdd08,secondary_code:_0x4d2c59}=_0x4a26cd[_0x266beb(0x126)],_0xa2b071=await warehouse[_0x266beb(0xbc)]([{'$match':{'name':_0x54dd76}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4d2c59}},{'$group':{'_id':_0x266beb(0x13e),'name':{'$first':_0x266beb(0xa5)},'primary_code':{'$first':_0x266beb(0x10b)},'secondary_code':{'$first':_0x266beb(0x16c)},'product_code':{'$first':_0x266beb(0x12b)},'instock':{'$first':_0x266beb(0xac)},'warehouse':{'$first':_0x266beb(0xa8)},'level':{'$first':_0x266beb(0x147)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x266beb(0x12d)},'unit':{'$first':_0x266beb(0x14f)}}}]);_0x155891['status'](0xc8)['json'](_0xa2b071);}catch(_0x10c9ef){_0x155891['status'](0x194)[_0x266beb(0x12e)]({'message':_0x10c9ef['message']});}}),router['post'](a0_0x201bb0(0xc2),async(_0x20da95,_0x57dd6f)=>{var _0xbb9ece=a0_0x201bb0;try{const {FromWareHouse:_0x2dff8e,FromRoom:_0x16d75e,ToWarehouse:_0x1e3235,ToRoom:_0x440661,product_code:_0x532d0c}=_0x20da95['body'],_0x3b480d=await warehouse[_0xbb9ece(0xbc)]([{'$match':{'name':_0x2dff8e}},{'$unwind':_0xbb9ece(0xcd)},{'$match':{'product_details.product_code':_0x532d0c}},{'$group':{'_id':_0xbb9ece(0x13e),'name':{'$first':_0xbb9ece(0xa5)},'primary_code':{'$first':_0xbb9ece(0x10b)},'secondary_code':{'$first':_0xbb9ece(0x16c)},'product_code':{'$first':_0xbb9ece(0x12b)},'instock':{'$first':_0xbb9ece(0xac)},'warehouse':{'$first':_0xbb9ece(0xa8)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0xbb9ece(0xb0)},'pallet':{'$first':_0xbb9ece(0xee)},'maxProducts':{'$first':_0xbb9ece(0x12d)},'unit':{'$first':'$product_details.unit'}}}]);_0x57dd6f[_0xbb9ece(0x171)](0xc8)[_0xbb9ece(0x12e)](_0x3b480d);}catch(_0x5b7044){_0x57dd6f['status'](0x194)['json']({'message':_0x5b7044[_0xbb9ece(0x139)]});}}),router[a0_0x201bb0(0x9b)](a0_0x201bb0(0x105),async(_0x3ba273,_0x2ca1db)=>{var _0xfef726=a0_0x201bb0;const {level:_0x5e5508,isle:_0x3d40b3,pallet:_0xdc8edf,warehouses:_0x4e4ccc,room:_0x2741cb}=_0x3ba273['body'];try{const _0x4fe7b4=await warehouse['aggregate']([{'$match':{'name':_0x4e4ccc,'room':_0x2741cb}},{'$unwind':_0xfef726(0xcd)},{'$match':{'product_details.level':parseInt(_0x5e5508),'product_details.isle':_0x3d40b3,'product_details.pallet':parseInt(_0xdc8edf)}},{'$group':{'_id':_0xfef726(0x13e),'name':{'$first':_0xfef726(0xa5)},'product_stock':{'$first':_0xfef726(0xac)},'level':{'$first':_0xfef726(0x147)},'isle':{'$first':_0xfef726(0xb0)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2ca1db[_0xfef726(0x171)](0xc8)[_0xfef726(0x12e)](_0x4fe7b4);}catch(_0x341786){_0x2ca1db[_0xfef726(0x171)](0x194)[_0xfef726(0x12e)]({'message':_0x341786[_0xfef726(0x139)]});}}),module['exports']=router;