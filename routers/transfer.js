var a0_0x26779e=a0_0x88fe;(function(_0x2e07f5,_0x47549f){var _0xcf9b5f=a0_0x88fe,_0x3cc18b=_0x2e07f5();while(!![]){try{var _0x97c70=-parseInt(_0xcf9b5f(0x172))/0x1+parseInt(_0xcf9b5f(0x1ef))/0x2*(parseInt(_0xcf9b5f(0x12a))/0x3)+-parseInt(_0xcf9b5f(0x170))/0x4+-parseInt(_0xcf9b5f(0x161))/0x5+parseInt(_0xcf9b5f(0x162))/0x6+-parseInt(_0xcf9b5f(0x19e))/0x7*(parseInt(_0xcf9b5f(0x1f4))/0x8)+parseInt(_0xcf9b5f(0x16f))/0x9*(parseInt(_0xcf9b5f(0x19b))/0xa);if(_0x97c70===_0x47549f)break;else _0x3cc18b['push'](_0x3cc18b['shift']());}catch(_0x161be2){_0x3cc18b['push'](_0x3cc18b['shift']());}}}(a0_0x36de,0x32171));function a0_0x88fe(_0x18653c,_0x3097f3){var _0x36de99=a0_0x36de();return a0_0x88fe=function(_0x88fe67,_0xe71fd6){_0x88fe67=_0x88fe67-0x112;var _0x3419d9=_0x36de99[_0x88fe67];return _0x3419d9;},a0_0x88fe(_0x18653c,_0x3097f3);}const express=require(a0_0x26779e(0x112)),app=express(),router=express[a0_0x26779e(0x133)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x26779e(0x127)),auth=require(a0_0x26779e(0x1ad)),users=require(a0_0x26779e(0x191)),nodemailer=require(a0_0x26779e(0x1e3));router['get']('/view',auth,async(_0x10c41b,_0x289535)=>{var _0x2491ac=a0_0x26779e;try{const {username:_0x463be7,email:_0x5120e4,role:_0x55c0cf}=_0x10c41b[_0x2491ac(0x13c)],_0x2d74ae=_0x10c41b[_0x2491ac(0x13c)],_0x146b66=await profile[_0x2491ac(0x1d1)]({'email':_0x2d74ae[_0x2491ac(0x125)]}),_0x152b33=await master_shop[_0x2491ac(0x19d)]();console[_0x2491ac(0x1af)](_0x2491ac(0x154),_0x152b33);let _0x24005b;if(_0x2d74ae[_0x2491ac(0x19f)]==_0x2491ac(0x19a)){const _0x34531a=await staff[_0x2491ac(0x1d1)]({'email':_0x2d74ae['email']});_0x24005b=await transfers[_0x2491ac(0x19d)]({'from_warehouse':_0x34531a['warehouse']});}else _0x24005b=await transfers[_0x2491ac(0x1f2)]([{'$unwind':_0x2491ac(0x175)},{'$group':{'_id':_0x2491ac(0x1c2),'invoice':{'$first':_0x2491ac(0x144)},'date':{'$first':_0x2491ac(0x1b7)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x2491ac(0x145)},'from_room_name':{'$addToSet':_0x2491ac(0x176)},'to_room_name':{'$addToSet':_0x2491ac(0x1ab)},'finalize':{'$first':_0x2491ac(0x1ea)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x152b33[0x0][_0x2491ac(0x1cc)]==_0x2491ac(0x199)){var _0x2c9072=users['English'];console['log'](_0x2c9072);}else{if(_0x152b33[0x0][_0x2491ac(0x1cc)]=='Hindi')var _0x2c9072=users['Hindi'];else{if(_0x152b33[0x0][_0x2491ac(0x1cc)]==_0x2491ac(0x152))var _0x2c9072=users[_0x2491ac(0x152)];else{if(_0x152b33[0x0][_0x2491ac(0x1cc)]==_0x2491ac(0x1b8))var _0x2c9072=users[_0x2491ac(0x1b8)];else{if(_0x152b33[0x0]['language']=='French')var _0x2c9072=users[_0x2491ac(0x174)];else{if(_0x152b33[0x0]['language']=='Portuguese\x20(BR)')var _0x2c9072=users['Portuguese'];else{if(_0x152b33[0x0][_0x2491ac(0x1cc)]==_0x2491ac(0x1a0))var _0x2c9072=users[_0x2491ac(0x1a0)];else{if(_0x152b33[0x0][_0x2491ac(0x1cc)]==_0x2491ac(0x15e))var _0x2c9072=users[_0x2491ac(0x115)];}}}}}}}_0x289535[_0x2491ac(0x1f3)](_0x2491ac(0x1c3),{'success':_0x10c41b[_0x2491ac(0x179)](_0x2491ac(0x17c)),'errors':_0x10c41b[_0x2491ac(0x179)](_0x2491ac(0x1cb)),'role':_0x2d74ae,'profile':_0x146b66,'master_shop':_0x152b33,'transfer':_0x24005b,'language':_0x2c9072});}catch(_0x2bfddc){console[_0x2491ac(0x1af)](_0x2bfddc);}});async function getRandom8DigitNumber(){var _0xe76e00=a0_0x26779e;const _0x8892ae=0x989680,_0x45b934=0x5f5e0ff,_0x56c795=Math[_0xe76e00(0x1bd)](Math[_0xe76e00(0x177)]()*(_0x45b934-_0x8892ae+0x1))+_0x8892ae;var _0x285cd7;const _0x22c745=await transfers[_0xe76e00(0x1d1)]({'invoice':_0xe76e00(0x1b6)+_0x56c795});return _0x22c745&&_0x22c745[_0xe76e00(0x163)]>0x0?_0x285cd7=_0xe76e00(0x1b6)+_0x56c795:_0x285cd7='TRF-'+_0x56c795,_0x285cd7;}function a0_0x36de(){var _0x44346a=['\x20Order\x20Date\x20:\x20','\x20Order\x20Number\x20:\x20','add_transfer','params','<span\x20style=\x22float:\x20right;\x22>','Product\x20Transfer\x20successfully','warehouse','English','<h2>\x20','</div>','../public/language/languages.json','/preview/:id','</head><body>','batch_code','To_invoice','forEach','secondary_code','edit_transfer','English\x20(US)','staff','130kosBJI','concat','find','14PdYENd','role','Chinese','product_code3','prod_name','to_prod_level','from_room_name','to_types','<h5>','updateOne','Ambient','slice','Rack\x20A','$product.to_room_name','maxProducts','../middleware/auth','_id','log','Floor','</body></html>','$product_details.bay','from_prod_level','/barcode_scanner','status','TRF-','$date','Spanish','<hr\x20class=\x22my-3\x22>','/transfer/view','body','product_stock','floor','max_per_unit','from_room','$product_details.unit','to_bay','$_id','transfer','$product_details.product_name','to_prod_isle','from_bay','message','RMSEmail','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','errors','language','image','\x20</h2>','toString','/barcode_scanner3','findOne','Raw\x20Materials','secondary_unit','$product_details.bin','catch','/barcode_scanner2','Rack\x20F','primary_unit','</table>','$product_details._id','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','push','$product_details.maxPerUnit','/upload/','to_prod_qty','$name','/picking_list/PDF_transfer_rm/','Enclosed','nodemailer','$room','from_rak','Transfer\x20Mail','password','$product_details.production_date','findById','$finalize','from_warehouse','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Enabled','336RcrCNX','type','$product_details.secondary_unit','aggregate','render','254816VFTuoq','from_prod_qty','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view/add_transfer','prod_cat','$product_details.pallet','$product_details.isle','site_title','bin','json','</h5>','express','to_bin','edit_transfer_view','Arabic','to_room_name','$product_details.type','to_floorlevel','Receiving\x20Area','then','primary_code','rack','to_warehouse','$product_details','host','An\x20error\x20occurred.','<tr>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','map','Logo.png','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','../models/all_models','Level','save','2418hGpMEz','maxperunit','</tr>','Transfer\x20Finalize\x20Successfully','<h5\x20style=\x22text-align:\x20left;\x22>','Rack\x20C','COLD\x20STORAGE','rak','unit','Router','<div>','to_invoice','$product_details.floorlevel','Email\x20sent\x20successfully','date','</td>','padStart','$product_details.expiry_date','user','$product_details.primary_code','from_rack','$product_details.level','post','storage','back','product','$invoice','$to_warehouse','product_name','Shelves','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.maxProducts','bay','from_prod_isle','ToRoomAssigned','Portuguese','product_code','exports','Rack\x20E','/../public','German','production_date','master','An\x20error\x20occurred\x20while\x20saving\x20data.','floorlevel','getFullYear','</span>','MaxStocks_data2','$product_details.product_code','to_quantity','split','product_details','Arabic\x20(ae)','from_invoice','note','1626470hPAYQl','1028778AQzEfU','length','Hindi','invoice','$product_details.rack','get','$product_details.batch_code','RoomAssigned','from_quantity','expiry_date','$product_details.storage','from_types','from_storage','501273hlyDtk','1399788FoMdgi','from_floorlevel','86818lbrcXk','to_room','French','$product','$product.from_room_name','random','from_bin','flash','all','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','success','$product_details.product_stock','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','True','string','error','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Transfer\x20Edit\x20Successfully','to_prod_pallet','createTransport','redirect'];a0_0x36de=function(){return _0x44346a;};return a0_0x36de();}router[a0_0x26779e(0x167)](a0_0x26779e(0x1f8),auth,async(_0xd9b811,_0x4d60f2)=>{var _0xcc7d76=a0_0x26779e;try{const {username:_0x458cd0,email:_0x5456d2,role:_0x35d9b0}=_0xd9b811[_0xcc7d76(0x13c)],_0x3f50a7=_0xd9b811[_0xcc7d76(0x13c)],_0x336907=await profile[_0xcc7d76(0x1d1)]({'email':_0x3f50a7[_0xcc7d76(0x125)]}),_0x3293a9=await master_shop['find']();console[_0xcc7d76(0x1af)]('master',_0x3293a9);let _0x77da96;if(_0x3f50a7['role']==_0xcc7d76(0x19a)){const _0xe9632=await staff['findOne']({'email':_0x3f50a7['email']});_0x77da96=await warehouse['aggregate']([{'$match':{'status':_0xcc7d76(0x1ee),'name':_0xe9632[_0xcc7d76(0x18d)],'warehouse_category':_0xcc7d76(0x1d2)}},{'$group':{'_id':_0xcc7d76(0x1e0),'name':{'$first':_0xcc7d76(0x1e0)}}}]);}else _0x77da96=await warehouse[_0xcc7d76(0x1f2)]([{'$match':{'status':_0xcc7d76(0x1ee),'warehouse_category':_0xcc7d76(0x1d2)}},{'$group':{'_id':_0xcc7d76(0x1e0),'name':{'$first':_0xcc7d76(0x1e0)}}}]);var _0x36a7aa=[_0xcc7d76(0x1a8),_0xcc7d76(0x1e2),'Return\x20Rooms'];const _0x3597bd=await transfers[_0xcc7d76(0x19d)]({}),_0xa9a9b6=_0x3597bd['length']+0x1,_0x2646df='TRF-'+_0xa9a9b6[_0xcc7d76(0x1cf)]()[_0xcc7d76(0x13a)](0x5,'0');if(_0x3293a9[0x0][_0xcc7d76(0x1cc)]==_0xcc7d76(0x199)){var _0x472a80=users[_0xcc7d76(0x18e)];console[_0xcc7d76(0x1af)](_0x472a80);}else{if(_0x3293a9[0x0][_0xcc7d76(0x1cc)]==_0xcc7d76(0x164))var _0x472a80=users[_0xcc7d76(0x164)];else{if(_0x3293a9[0x0][_0xcc7d76(0x1cc)]==_0xcc7d76(0x152))var _0x472a80=users['German'];else{if(_0x3293a9[0x0][_0xcc7d76(0x1cc)]==_0xcc7d76(0x1b8))var _0x472a80=users[_0xcc7d76(0x1b8)];else{if(_0x3293a9[0x0]['language']=='French')var _0x472a80=users[_0xcc7d76(0x174)];else{if(_0x3293a9[0x0][_0xcc7d76(0x1cc)]=='Portuguese\x20(BR)')var _0x472a80=users[_0xcc7d76(0x14d)];else{if(_0x3293a9[0x0][_0xcc7d76(0x1cc)]==_0xcc7d76(0x1a0))var _0x472a80=users['Chinese'];else{if(_0x3293a9[0x0]['language']=='Arabic\x20(ae)')var _0x472a80=users[_0xcc7d76(0x115)];}}}}}}}const _0x111313=getRandom8DigitNumber();_0x111313[_0xcc7d76(0x11a)](_0x1d0925=>{var _0x7b18b9=_0xcc7d76;_0x4d60f2[_0x7b18b9(0x1f3)](_0x7b18b9(0x189),{'success':_0xd9b811['flash'](_0x7b18b9(0x17c)),'errors':_0xd9b811['flash']('errors'),'role':_0x3f50a7,'profile':_0x336907,'master_shop':_0x3293a9,'warehouse':_0x77da96,'language':_0x472a80,'rooms_data':_0x36a7aa,'invoice':_0x1d0925});})[_0xcc7d76(0x1d5)](_0xafe5b2=>{var _0x4e97b4=_0xcc7d76;_0xd9b811['flash'](_0x4e97b4(0x1cb),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4d60f2['redirect'](_0x4e97b4(0x1ba));});}catch(_0x5ead00){console['log'](_0x5ead00);}}),router[a0_0x26779e(0x140)](a0_0x26779e(0x1f8),auth,async(_0x34af06,_0x16a70a)=>{var _0x447ed5=a0_0x26779e;try{console['log'](_0x34af06['body']);const {date:_0x478327,from_warehouse:_0xb63673,FromRoom_name:_0x152734,to_warehouse:_0x6d1f11,ToRoom_name:_0x2e5fc4,prod_name:_0x355a35,from_prod_qty:_0x12bde6,from_prod_level:_0x18e882,from_prod_isle:_0x45f0c9,from_prod_pallet:_0x47bd91,to_prod_qty:_0x555c00,to_prod_level:_0x20b1ae,to_prod_isle:_0x4b4e60,to_prod_pallet:_0x4b4504,primary_code:_0x336c4b,secondary_code:_0x369a4c,product_code3:_0x55b8cd,note:_0x293928,MaxStocks_data2:_0x3450ed,invoice:_0x2d3b34,expiry_date:_0x40f9b3}=_0x34af06['body'];if(typeof _0x355a35==_0x447ed5(0x180))var _0x4d3bae=[_0x34af06[_0x447ed5(0x1bb)]['prod_name']],_0x3ea0e9=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1f5)]],_0x133e93=[_0x34af06['body'][_0x447ed5(0x1b3)]],_0xa2b182=[_0x34af06['body']['New_Qty_Converted']],_0x1835c2=[_0x34af06['body']['to_prod_level']],_0x58b921=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x11b)]],_0x138b1f=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x197)]],_0x3b9cda=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1a1)]],_0x1b71d9=[_0x34af06['body']['MaxStocks_data2']],_0x436ec5=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1d8)]],_0x1bfeab=[_0x34af06[_0x447ed5(0x1bb)]['secondary_unit']],_0x33b0dd=[_0x34af06['body'][_0x447ed5(0x194)]],_0x2d4d32=[_0x34af06['body'][_0x447ed5(0x16b)]],_0x374442=[_0x34af06['body']['max_per_unit']],_0x5ebf11=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x153)]],_0x446171=[_0x34af06['body'][_0x447ed5(0x1f9)]],_0x518492=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x169)]],_0x22a617=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x14c)]],_0x3ed21b=[_0x34af06['body'][_0x447ed5(0x15f)]],_0x388dce=[_0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x135)]];else var _0x4d3bae=[..._0x34af06['body']['prod_name']],_0x3ea0e9=[..._0x34af06[_0x447ed5(0x1bb)]['from_prod_qty']],_0x133e93=[..._0x34af06['body'][_0x447ed5(0x1b3)]],_0xa2b182=[..._0x34af06[_0x447ed5(0x1bb)]['New_Qty_Converted']],_0x1835c2=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1a3)]],_0x58b921=[..._0x34af06['body'][_0x447ed5(0x11b)]],_0x138b1f=[..._0x34af06['body'][_0x447ed5(0x197)]],_0x3b9cda=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1a1)]],_0x1b71d9=[..._0x34af06['body']['MaxStocks_data2']],_0x436ec5=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1d8)]],_0x1bfeab=[..._0x34af06[_0x447ed5(0x1bb)]['secondary_unit']],_0x33b0dd=[..._0x34af06[_0x447ed5(0x1bb)]['batch_code']],_0x2d4d32=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x16b)]],_0x374442=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1be)]],_0x5ebf11=[..._0x34af06[_0x447ed5(0x1bb)]['production_date']],_0x446171=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x1f9)]],_0x518492=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x169)]],_0x22a617=[..._0x34af06['body'][_0x447ed5(0x14c)]],_0x3ed21b=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x15f)]],_0x388dce=[..._0x34af06[_0x447ed5(0x1bb)][_0x447ed5(0x135)]];const _0x492ca7=_0x4d3bae[_0x447ed5(0x123)](_0x2a52ce=>{return _0x2a52ce={'product_name':_0x2a52ce};});_0x3ea0e9[_0x447ed5(0x196)]((_0x2c6abd,_0x3f4378)=>{var _0x37aa74=_0x447ed5;_0x492ca7[_0x3f4378][_0x37aa74(0x16a)]=_0x2c6abd;}),_0x3ed21b[_0x447ed5(0x196)]((_0x37f045,_0x553dc0)=>{_0x492ca7[_0x553dc0]['from_invoice']=_0x37f045;}),_0x388dce[_0x447ed5(0x196)]((_0x56b04b,_0x5e44fa)=>{var _0x2f9672=_0x447ed5;_0x492ca7[_0x5e44fa][_0x2f9672(0x195)]=_0x56b04b;}),_0x133e93['forEach']((_0x55f9d3,_0x367005)=>{var _0x86732a=_0x447ed5;_0x518492[_0x86732a(0x196)]((_0x380ca1,_0x298783)=>{var _0x5e3992=_0x86732a;if(_0x380ca1==_0x5e3992(0x119)&&_0x367005==_0x298783){var _0x41998f=_0x55f9d3[_0x5e3992(0x1a9)](0x3);_0x492ca7[_0x367005][_0x5e3992(0x16e)]=_0x55f9d3[0x0],_0x492ca7[_0x367005]['from_rack']=_0x55f9d3[0x1],_0x492ca7[_0x367005][_0x5e3992(0x1c6)]=0x0,_0x492ca7[_0x367005][_0x5e3992(0x178)]=0x0,_0x492ca7[_0x367005][_0x5e3992(0x16d)]=_0x5e3992(0x1b0),_0x492ca7[_0x367005][_0x5e3992(0x171)]=_0x41998f;}else{if(_0x380ca1=='Shelves'&&_0x367005==_0x298783){var _0x41998f=_0x55f9d3[_0x5e3992(0x1a9)](0x3);_0x492ca7[_0x367005][_0x5e3992(0x16e)]=_0x55f9d3[0x0],_0x492ca7[_0x367005][_0x5e3992(0x13e)]=_0x55f9d3[0x1],_0x492ca7[_0x367005][_0x5e3992(0x1c6)]=0x0,_0x492ca7[_0x367005]['from_bin']=0x0,_0x492ca7[_0x367005][_0x5e3992(0x16d)]='Floor',_0x492ca7[_0x367005][_0x5e3992(0x171)]=_0x55f9d3[0x5];}else{if(_0x367005==_0x298783){var _0x31bbf5;if(_0x55f9d3[0x4]=='L')_0x31bbf5=_0x5e3992(0x128);else _0x55f9d3[0x4]=='F'&&(_0x31bbf5='Floor');_0x492ca7[_0x367005][_0x5e3992(0x16e)]=_0x55f9d3[0x0],_0x492ca7[_0x367005][_0x5e3992(0x13e)]=_0x55f9d3[0x1],_0x492ca7[_0x367005]['from_bay']=_0x55f9d3[0x2],_0x492ca7[_0x367005][_0x5e3992(0x178)]=_0x55f9d3[0x3],_0x492ca7[_0x367005][_0x5e3992(0x16d)]=_0x31bbf5,_0x492ca7[_0x367005][_0x5e3992(0x171)]=_0x55f9d3[0x5];}}}});}),_0xa2b182['forEach']((_0x1edc39,_0x4c4d3)=>{var _0x281aa1=_0x447ed5;_0x492ca7[_0x4c4d3][_0x281aa1(0x15b)]=_0x1edc39;}),_0x1835c2[_0x447ed5(0x196)]((_0x31767f,_0x4adecb)=>{var _0x49fc02=_0x447ed5;_0x22a617[_0x49fc02(0x196)]((_0x58586f,_0x3e6272)=>{var _0x4220fc=_0x49fc02;if(_0x58586f==_0x4220fc(0x119)&&_0x4adecb==_0x3e6272){var _0x4047b5=_0x31767f[_0x4220fc(0x1a9)](0x3);_0x492ca7[_0x4adecb][_0x4220fc(0x141)]=_0x31767f[0x0],_0x492ca7[_0x4adecb][_0x4220fc(0x11c)]=_0x31767f[0x1],_0x492ca7[_0x4adecb]['to_bay']=0x0,_0x492ca7[_0x4adecb]['to_bin']=0x0,_0x492ca7[_0x4adecb][_0x4220fc(0x1a5)]='Floor',_0x492ca7[_0x4adecb][_0x4220fc(0x118)]=_0x4047b5;}else{if(_0x58586f==_0x4220fc(0x147)&&_0x4adecb==_0x3e6272){var _0x4047b5=_0x31767f[_0x4220fc(0x1a9)](0x3);_0x492ca7[_0x4adecb][_0x4220fc(0x141)]=_0x31767f[0x0],_0x492ca7[_0x4adecb]['rack']=_0x31767f[0x1],_0x492ca7[_0x4adecb][_0x4220fc(0x1c1)]=0x0,_0x492ca7[_0x4adecb]['to_bin']=0x0,_0x492ca7[_0x4adecb]['to_types']=_0x4220fc(0x1b0),_0x492ca7[_0x4adecb][_0x4220fc(0x118)]=_0x31767f[0x5];}else{if(_0x4adecb==_0x3e6272){var _0x17c873;if(_0x31767f[0x4]=='L')_0x17c873=_0x4220fc(0x128);else _0x31767f[0x4]=='F'&&(_0x17c873='Floor');_0x492ca7[_0x4adecb][_0x4220fc(0x141)]=_0x31767f[0x0],_0x492ca7[_0x4adecb][_0x4220fc(0x11c)]=_0x31767f[0x1],_0x492ca7[_0x4adecb]['to_bay']=_0x31767f[0x2],_0x492ca7[_0x4adecb][_0x4220fc(0x113)]=_0x31767f[0x3],_0x492ca7[_0x4adecb]['to_types']=_0x17c873,_0x492ca7[_0x4adecb][_0x4220fc(0x118)]=_0x31767f[0x5];}}}});}),_0x58b921[_0x447ed5(0x196)]((_0x53e915,_0x3c77ab)=>{_0x492ca7[_0x3c77ab]['primary_code']=_0x53e915;}),_0x138b1f[_0x447ed5(0x196)]((_0x1223e0,_0x331a91)=>{var _0x5a928d=_0x447ed5;_0x492ca7[_0x331a91][_0x5a928d(0x197)]=_0x1223e0;}),_0x3b9cda[_0x447ed5(0x196)]((_0x2d0167,_0x7b1c00)=>{var _0x42922b=_0x447ed5;_0x492ca7[_0x7b1c00][_0x42922b(0x14e)]=_0x2d0167;}),_0x1b71d9[_0x447ed5(0x196)]((_0x1f2964,_0x413a56)=>{var _0x175405=_0x447ed5;_0x492ca7[_0x413a56][_0x175405(0x1ac)]=_0x1f2964;}),_0x436ec5[_0x447ed5(0x196)]((_0x3f8b7b,_0x10b973)=>{_0x492ca7[_0x10b973]['unit']=_0x3f8b7b;}),_0x1bfeab[_0x447ed5(0x196)]((_0x291d9e,_0x56502f)=>{var _0x4d1da3=_0x447ed5;_0x492ca7[_0x56502f][_0x4d1da3(0x1d3)]=_0x291d9e;}),_0x33b0dd[_0x447ed5(0x196)]((_0x501d1c,_0x1589a2)=>{var _0x41f233=_0x447ed5;_0x492ca7[_0x1589a2][_0x41f233(0x194)]=_0x501d1c;}),_0x2d4d32[_0x447ed5(0x196)]((_0x5397d4,_0x4183dc)=>{var _0x14616b=_0x447ed5;_0x492ca7[_0x4183dc][_0x14616b(0x16b)]=_0x5397d4;}),_0x374442['forEach']((_0x442d37,_0x2a7228)=>{var _0x17b91b=_0x447ed5;_0x492ca7[_0x2a7228][_0x17b91b(0x12b)]=_0x442d37;}),_0x5ebf11[_0x447ed5(0x196)]((_0x24f786,_0x78525)=>{var _0x204f41=_0x447ed5;_0x492ca7[_0x78525][_0x204f41(0x153)]=_0x24f786;}),_0x446171[_0x447ed5(0x196)]((_0x5f2a46,_0xc6074)=>{var _0x13e916=_0x447ed5;_0x492ca7[_0xc6074][_0x13e916(0x1f9)]=_0x5f2a46;}),_0x518492[_0x447ed5(0x196)]((_0x9955dc,_0x2bc896)=>{var _0x14d3d8=_0x447ed5;_0x492ca7[_0x2bc896][_0x14d3d8(0x1a4)]=_0x9955dc;}),_0x22a617[_0x447ed5(0x196)]((_0x191d46,_0x18fdab)=>{_0x492ca7[_0x18fdab]['to_room_name']=_0x191d46;});const _0x481b80=_0x492ca7['filter'](_0x168123=>_0x168123['to_quantity']!=='0'&&_0x168123[_0x447ed5(0x15b)]!==''||_0x168123['to_floorlevel']!=='0'&&_0x168123[_0x447ed5(0x118)]!==''),_0x233b7d=new transfers({'date':_0x478327,'from_warehouse':_0xb63673,'to_warehouse':_0x6d1f11,'product':_0x481b80,'note':_0x293928,'invoice':_0x2d3b34}),_0x2bb074=await _0x233b7d[_0x447ed5(0x129)]();_0x34af06[_0x447ed5(0x179)](_0x447ed5(0x17c),_0x447ed5(0x18c)),_0x16a70a[_0x447ed5(0x186)]('/transfer/preview/'+_0x2bb074[_0x447ed5(0x1ae)]);}catch(_0x58e790){console[_0x447ed5(0x1af)](_0x58e790),_0x16a70a[_0x447ed5(0x1b5)](0xc8)[_0x447ed5(0x1fe)]({'errorMessage':_0x58e790[_0x447ed5(0x1c7)]});}}),router['get']('/preview/:id',auth,async(_0x4f0c0c,_0x10b0ef)=>{var _0x8f0f5f=a0_0x26779e;try{const {username:_0x2ffe6c,email:_0x2dc7e9,role:_0x19a440}=_0x4f0c0c[_0x8f0f5f(0x13c)],_0x352228=_0x4f0c0c[_0x8f0f5f(0x13c)],_0x5d8f78=await profile[_0x8f0f5f(0x1d1)]({'email':_0x352228[_0x8f0f5f(0x125)]}),_0x18dd28=await master_shop['find']();console['log']('master',_0x18dd28);const _0x5ca14b=await transfers[_0x8f0f5f(0x1e9)](_0x4f0c0c['params']['id']);let _0x2d5a8a=new Date(_0x5ca14b[_0x8f0f5f(0x16b)]),_0x54f1d5=('0'+_0x2d5a8a['getDate']())['slice'](-0x2),_0x43a51e=('0'+(_0x2d5a8a['getMonth']()+0x1))[_0x8f0f5f(0x1a9)](-0x2),_0x228a64=_0x2d5a8a[_0x8f0f5f(0x157)](),_0x244e34=_0x228a64+'-'+_0x43a51e+'-'+_0x54f1d5,_0x3e8de3;if(_0x352228[_0x8f0f5f(0x19f)]==_0x8f0f5f(0x19a)){const _0x229e7f=await staff['findOne']({'email':_0x352228[_0x8f0f5f(0x125)]});_0x3e8de3=await warehouse[_0x8f0f5f(0x19d)]({'status':_0x8f0f5f(0x1ee),'name':_0x229e7f['warehouse'],'warehouse_category':'Raw\x20Materials'});}else _0x3e8de3=await warehouse['find']({'status':'Enabled','warehouse_category':_0x8f0f5f(0x1d2)});const _0xdf53ff=await warehouse[_0x8f0f5f(0x1f2)]([{'$match':{'name':_0x5ca14b[_0x8f0f5f(0x1eb)]}},{'$unwind':_0x8f0f5f(0x11e)},{'$group':{'_id':_0x8f0f5f(0x1da),'name':{'$first':_0x8f0f5f(0x1c4)},'product_stock':{'$first':_0x8f0f5f(0x17d)},'bay':{'$first':_0x8f0f5f(0x1b2)},'bin':{'$first':_0x8f0f5f(0x1d4)},'type':{'$first':_0x8f0f5f(0x117)},'floorlevel':{'$first':_0x8f0f5f(0x136)},'primary_code':{'$first':_0x8f0f5f(0x13d)},'secondary_code':{'$first':_0x8f0f5f(0x1ec)},'product_code':{'$first':_0x8f0f5f(0x15a)},'storage':{'$first':_0x8f0f5f(0x16c)},'rack':{'$first':_0x8f0f5f(0x166)},'expiry_date':{'$first':_0x8f0f5f(0x13b)},'production_date':{'$first':_0x8f0f5f(0x1e8)},'room':{'$first':'$room'}}}]);if(_0x18dd28[0x0][_0x8f0f5f(0x1cc)]=='English\x20(US)'){var _0x3f83b6=users['English'];console[_0x8f0f5f(0x1af)](_0x3f83b6);}else{if(_0x18dd28[0x0][_0x8f0f5f(0x1cc)]==_0x8f0f5f(0x164))var _0x3f83b6=users['Hindi'];else{if(_0x18dd28[0x0][_0x8f0f5f(0x1cc)]==_0x8f0f5f(0x152))var _0x3f83b6=users['German'];else{if(_0x18dd28[0x0][_0x8f0f5f(0x1cc)]=='Spanish')var _0x3f83b6=users[_0x8f0f5f(0x1b8)];else{if(_0x18dd28[0x0]['language']==_0x8f0f5f(0x174))var _0x3f83b6=users[_0x8f0f5f(0x174)];else{if(_0x18dd28[0x0]['language']==_0x8f0f5f(0x1f6))var _0x3f83b6=users[_0x8f0f5f(0x14d)];else{if(_0x18dd28[0x0]['language']==_0x8f0f5f(0x1a0))var _0x3f83b6=users[_0x8f0f5f(0x1a0)];else{if(_0x18dd28[0x0]['language']==_0x8f0f5f(0x15e))var _0x3f83b6=users[_0x8f0f5f(0x115)];}}}}}}}_0x10b0ef[_0x8f0f5f(0x1f3)](_0x8f0f5f(0x114),{'success':_0x4f0c0c[_0x8f0f5f(0x179)](_0x8f0f5f(0x17c)),'errors':_0x4f0c0c[_0x8f0f5f(0x179)](_0x8f0f5f(0x1cb)),'role':_0x352228,'profile':_0x5d8f78,'master_shop':_0x18dd28,'warehouse':_0x3e8de3,'transfer':_0x5ca14b,'stock':_0xdf53ff,'language':_0x3f83b6});}catch(_0x5f014c){console['log'](_0x5f014c);}}),router[a0_0x26779e(0x140)](a0_0x26779e(0x192),auth,async(_0x48d869,_0xed84ee)=>{var _0x385be6=a0_0x26779e;try{const _0x415556=_0x48d869[_0x385be6(0x18a)]['id'],{from_warehouse:_0x447407,FromRoom_name:_0x1ec889,to_warehouse:_0x588247,ToRoom_name:_0x3aed9b}=_0x48d869[_0x385be6(0x1bb)],_0x1e86c8=await transfers[_0x385be6(0x1e9)]({'_id':_0x415556}),_0x5758a6=_0x1e86c8[_0x385be6(0x143)][_0x385be6(0x123)](async _0x4d29e6=>{var _0x1fade5=_0x385be6;if(_0x4d29e6[_0x1fade5(0x15b)]>0x0){var _0x27ac50=await warehouse[_0x1fade5(0x1d1)]({'name':_0x1e86c8[_0x1fade5(0x1eb)],'room':_0x4d29e6[_0x1fade5(0x1a4)],'warehouse_category':_0x1fade5(0x1d2)});const _0x4d6fe9=_0x27ac50[_0x1fade5(0x15d)][_0x1fade5(0x123)](_0x36c456=>{var _0x3154cf=_0x1fade5;_0x36c456[_0x3154cf(0x146)]==_0x4d29e6[_0x3154cf(0x146)]&&_0x36c456[_0x3154cf(0x156)]==_0x4d29e6[_0x3154cf(0x171)]&&_0x36c456[_0x3154cf(0x1f0)]==_0x4d29e6[_0x3154cf(0x16d)]&&_0x36c456['bin']==_0x4d29e6[_0x3154cf(0x178)]&&_0x36c456[_0x3154cf(0x14a)]==_0x4d29e6[_0x3154cf(0x1c6)]&&_0x36c456['rack']==_0x4d29e6[_0x3154cf(0x13e)]&&_0x36c456[_0x3154cf(0x141)]==_0x4d29e6[_0x3154cf(0x16e)]&&_0x36c456[_0x3154cf(0x16b)]==_0x4d29e6[_0x3154cf(0x16b)]&&_0x36c456[_0x3154cf(0x194)]==_0x4d29e6[_0x3154cf(0x194)]&&_0x36c456[_0x3154cf(0x153)]==_0x4d29e6['production_date']&&_0x36c456['invoice']==_0x4d29e6[_0x3154cf(0x15f)]&&(_0x36c456[_0x3154cf(0x1bc)]=_0x36c456[_0x3154cf(0x1bc)]-_0x4d29e6[_0x3154cf(0x15b)]);});}return _0x27ac50;});Promise['all'](_0x5758a6)['then'](async _0x1ee44d=>{var _0x85af5a=_0x385be6;try{for(const _0x47f862 of _0x1ee44d){await _0x47f862[_0x85af5a(0x129)]();}try{const _0x9b3865=_0x1e86c8[_0x85af5a(0x143)][_0x85af5a(0x123)](async _0x490218=>{var _0x22e0f2=_0x85af5a;if(_0x490218[_0x22e0f2(0x15b)]>0x0){var _0x245205=await warehouse[_0x22e0f2(0x1d1)]({'name':_0x1e86c8[_0x22e0f2(0x11d)],'room':_0x490218[_0x22e0f2(0x116)],'warehouse_category':_0x22e0f2(0x1d2)}),_0x137930=0x0;const _0x200d4e=_0x245205[_0x22e0f2(0x15d)][_0x22e0f2(0x123)](_0x2cb8b1=>{var _0x41680c=_0x22e0f2;_0x2cb8b1['product_name']==_0x490218[_0x41680c(0x146)]&&_0x2cb8b1[_0x41680c(0x156)]==_0x490218[_0x41680c(0x118)]&&_0x2cb8b1[_0x41680c(0x1f0)]==_0x490218['to_types']&&_0x2cb8b1['bin']==_0x490218[_0x41680c(0x113)]&&_0x2cb8b1['bay']==_0x490218[_0x41680c(0x1c1)]&&_0x2cb8b1[_0x41680c(0x11c)]==_0x490218[_0x41680c(0x11c)]&&_0x2cb8b1[_0x41680c(0x141)]==_0x490218[_0x41680c(0x141)]&&_0x2cb8b1[_0x41680c(0x16b)]==_0x490218['expiry_date']&&_0x2cb8b1[_0x41680c(0x194)]==_0x490218[_0x41680c(0x194)]&&_0x2cb8b1[_0x41680c(0x153)]==_0x490218[_0x41680c(0x153)]&&_0x2cb8b1['invoice']==_0x490218[_0x41680c(0x195)]&&(_0x2cb8b1[_0x41680c(0x1bc)]=_0x2cb8b1[_0x41680c(0x1bc)]+_0x490218[_0x41680c(0x15b)],_0x137930++);});_0x137930=='0'&&(_0x245205['product_details']=_0x245205[_0x22e0f2(0x15d)][_0x22e0f2(0x19c)]({'product_name':_0x490218['product_name'],'product_stock':_0x490218[_0x22e0f2(0x15b)],'bay':_0x490218[_0x22e0f2(0x1c1)],'bin':_0x490218['to_bin'],'type':_0x490218[_0x22e0f2(0x1a5)],'floorlevel':_0x490218['to_floorlevel'],'storage':_0x490218[_0x22e0f2(0x141)],'rack':_0x490218[_0x22e0f2(0x11c)],'product_code':_0x490218[_0x22e0f2(0x14e)],'primary_code':_0x490218['primary_code'],'secondary_code':_0x490218['secondary_code'],'maxProducts':_0x490218[_0x22e0f2(0x1ac)],'storage':_0x490218[_0x22e0f2(0x141)],'rack':_0x490218[_0x22e0f2(0x11c)],'expiry_date':_0x490218[_0x22e0f2(0x16b)],'maxPerUnit':_0x490218[_0x22e0f2(0x12b)],'batch_code':_0x490218[_0x22e0f2(0x194)],'production_date':_0x490218[_0x22e0f2(0x153)]}));}return _0x245205;});Promise['all'](_0x9b3865)[_0x85af5a(0x11a)](async _0x2b08c7=>{var _0x29d698=_0x85af5a;try{for(const _0x46aa7b of _0x2b08c7){await warehouse[_0x29d698(0x1a7)]({'_id':_0x46aa7b[_0x29d698(0x1ae)]},{'$addToSet':{'product_details':{'$each':_0x46aa7b[_0x29d698(0x15d)]}}});}_0x1e86c8['finalize']=_0x29d698(0x17f);const _0x4bcd1d=await _0x1e86c8[_0x29d698(0x129)](),_0x3c3e88=await master_shop[_0x29d698(0x19d)](),_0x4f0ed9=await email_settings[_0x29d698(0x1d1)](),_0x5e33e0=await supervisor_settings[_0x29d698(0x19d)]();var _0x3dc551=_0x1e86c8[_0x29d698(0x143)],_0x23ac15='',_0x514209;for(_0x514209 in _0x3dc551){_0x23ac15+=_0x29d698(0x121)+_0x29d698(0x17e)+_0x3dc551[_0x514209][_0x29d698(0x146)]+'</td>'+_0x29d698(0x17e)+_0x3dc551[_0x514209][_0x29d698(0x14e)]+'</td>'+_0x29d698(0x17e)+_0x3dc551[_0x514209]['to_quantity']+_0x29d698(0x139)+_0x29d698(0x17e)+_0x3dc551[_0x514209][_0x29d698(0x132)]+_0x29d698(0x139)+_0x29d698(0x17e)+_0x3dc551[_0x514209]['secondary_unit']+_0x29d698(0x139)+_0x29d698(0x17e)+_0x1e86c8['to_warehouse']+_0x29d698(0x139)+_0x29d698(0x17e)+_0x3dc551[_0x514209][_0x29d698(0x116)]+_0x29d698(0x139)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3dc551[_0x514209][_0x29d698(0x141)]+_0x3dc551[_0x514209][_0x29d698(0x11c)]+_0x3dc551[_0x514209][_0x29d698(0x1c1)]+_0x3dc551[_0x514209]['to_bin']+_0x3dc551[_0x514209][_0x29d698(0x1a5)][0x0]+_0x3dc551[_0x514209][_0x29d698(0x118)]+_0x29d698(0x139),_0x29d698(0x12c);}let _0x3f4923=nodemailer[_0x29d698(0x185)]({'host':_0x4f0ed9[_0x29d698(0x11f)],'port':Number(_0x4f0ed9['port']),'secure':![],'auth':{'user':_0x4f0ed9[_0x29d698(0x125)],'pass':_0x4f0ed9[_0x29d698(0x1e7)]}}),_0x1b4e96={'from':_0x4f0ed9[_0x29d698(0x125)],'to':_0x5e33e0[0x0][_0x29d698(0x1c8)],'subject':_0x29d698(0x1e6),'attachments':[{'filename':_0x29d698(0x124),'path':__dirname+_0x29d698(0x151)+_0x29d698(0x1de)+_0x3c3e88[0x0][_0x29d698(0x1cd)],'cid':'logo'}],'html':_0x29d698(0x1c9)+'<html><head><title></title>'+_0x29d698(0x193)+_0x29d698(0x134)+_0x29d698(0x17b)+_0x29d698(0x134)+_0x29d698(0x122)+'</div>'+_0x29d698(0x134)+_0x29d698(0x18f)+_0x3c3e88[0x0]['site_title']+_0x29d698(0x1ce)+_0x29d698(0x190)+'</div>'+_0x29d698(0x1b9)+'<div>'+_0x29d698(0x12e)+_0x29d698(0x188)+_0x1e86c8[_0x29d698(0x165)]+'\x20'+_0x29d698(0x18b)+_0x29d698(0x187)+_0x1e86c8[_0x29d698(0x138)]+'\x20'+_0x29d698(0x158)+_0x29d698(0x1ff)+_0x29d698(0x190)+_0x29d698(0x182)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x29d698(0x1f7)+_0x29d698(0x1ca)+_0x29d698(0x1ed)+_0x29d698(0x126)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x29d698(0x12c)+'</thead>'+_0x29d698(0x148)+'\x20'+_0x23ac15+'\x20'+'</tbody>'+_0x29d698(0x1d9)+_0x29d698(0x134)+'<strong>\x20Regards\x20</strong>'+_0x29d698(0x1a6)+_0x3c3e88[0x0][_0x29d698(0x1fc)]+_0x29d698(0x1ff)+_0x29d698(0x190)+_0x29d698(0x190)+_0x29d698(0x1b1)};_0x3f4923['sendMail'](_0x1b4e96,function(_0x260588,_0x383755){var _0x2139ff=_0x29d698;_0x260588?(console['log'](_0x260588),console[_0x2139ff(0x1af)]('Error\x20Occurs')):console[_0x2139ff(0x1af)](_0x2139ff(0x137));}),_0x48d869[_0x29d698(0x179)](_0x29d698(0x17c),_0x29d698(0x12d)),_0xed84ee[_0x29d698(0x186)](_0x29d698(0x1e1)+_0x4bcd1d[_0x29d698(0x1ae)]);}catch(_0x5e10db){console[_0x29d698(0x181)](_0x5e10db),_0xed84ee[_0x29d698(0x1b5)](0x1f4)['json']({'Perror':_0x29d698(0x155),'message':_0x5e10db[_0x29d698(0x1c7)]});}})['catch'](_0x5e4d97=>{var _0x361192=_0x85af5a;console[_0x361192(0x181)](_0x5e4d97),_0xed84ee[_0x361192(0x1b5)](0x1f4)[_0x361192(0x1fe)]({'Perror':_0x361192(0x120)});});}catch(_0xae6508){_0xed84ee[_0x85af5a(0x1fe)](_0xae6508);}}catch(_0x5049cc){console['error'](_0x5049cc),_0xed84ee[_0x85af5a(0x1b5)](0x1f4)[_0x85af5a(0x1fe)]({'Merror':_0x85af5a(0x155),'Message':_0x5049cc[_0x85af5a(0x1c7)]});}})['catch'](_0x2cd26a=>{var _0x4bb979=_0x385be6;console[_0x4bb979(0x181)](_0x2cd26a),_0xed84ee[_0x4bb979(0x1b5)](0x1f4)[_0x4bb979(0x1fe)]({'Merror':_0x4bb979(0x120)});});}catch(_0x15703e){console[_0x385be6(0x1af)](_0x15703e);}});function BayBinSelected(_0x40c391,_0x55e332){var _0x436a9a=a0_0x26779e,_0x418047=[],_0x366e76=[],_0x38c56c=[],_0x4da19e=[],_0x13cd0c=[],_0x27fbf3=[];let _0xa460a5=[];if(_0x40c391=='DRY\x20STORAGE')switch(_0x55e332){case'Rack\x20A':_0x418047=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x366e76=[0x1,0x2],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=[_0x436a9a(0x128),'Floor'],_0x13cd0c=['D'],_0x27fbf3=['A'];break;case'Rack\x20B':_0x418047=[0x6,0x5,0x4,0x3,0x2,0x1],_0x366e76=[0x1,0x2],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=[_0x436a9a(0x128),_0x436a9a(0x1b0)],_0x13cd0c=['D'],_0x27fbf3=['B'];break;case _0x436a9a(0x147):_0x418047=[0x0],_0x366e76=[0x0],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=[_0x436a9a(0x1b0)],_0x13cd0c=['D'],_0x27fbf3=['S'];break;case _0x436a9a(0x119):_0x418047=[0x0],_0x366e76=[0x0],_0x4da19e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x38c56c=[_0x436a9a(0x1b0)],_0x13cd0c=['D'],_0x27fbf3=['R'];break;}else{if(_0x40c391==_0x436a9a(0x130))switch(_0x55e332){case _0x436a9a(0x1aa):_0x418047=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x366e76=['B','F'],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=[_0x436a9a(0x128),_0x436a9a(0x1b0)],_0x13cd0c=['C'],_0x27fbf3=['A'];break;case'Rack\x20B':_0x418047=[0x5,0x4,0x3,0x2,0x1],_0x366e76=['F','B','S'],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=[_0x436a9a(0x128),'Floor'],_0x13cd0c=['C'],_0x27fbf3=['B'];break;case _0x436a9a(0x12f):_0x418047=[0x1,0x2,0x3,0x4,0x5],_0x366e76=['B','F','S'],_0x4da19e=[0x5,0x4,0x3,0x2,0x1],_0x38c56c=[_0x436a9a(0x128),_0x436a9a(0x1b0)],_0x13cd0c=['C'],_0x27fbf3=['C'];break;case'Rack\x20D':_0x418047=[0x5,0x4,0x3,0x2,0x1],_0x366e76=['F','B','S'],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=['Level',_0x436a9a(0x1b0)],_0x13cd0c=['C'],_0x27fbf3=['D'];break;case _0x436a9a(0x150):_0x418047=[0x4,0x3,0x2,0x1],_0x366e76=[0x1,0x2],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=[_0x436a9a(0x128),_0x436a9a(0x1b0)],_0x13cd0c=['C'],_0x27fbf3=['E'];break;case _0x436a9a(0x1d7):_0x418047=[0x1,0x2,0x3],_0x366e76=[0x1,0x2],_0x4da19e=[0x1,0x2,0x3,0x4,0x5],_0x38c56c=[_0x436a9a(0x128)],_0x13cd0c=['C'],_0x27fbf3=['F'];break;}}return{'levels':_0x418047,'Isle':_0x366e76,'rack':_0x4da19e,'type':_0x38c56c,'storage':_0x13cd0c,'rak':_0x27fbf3};}router[a0_0x26779e(0x167)]('/view/:id',auth,async(_0x23480d,_0x1349e9)=>{var _0xe7dff4=a0_0x26779e;try{const {username:_0x499511,email:_0x552a13,role:_0x41abc8}=_0x23480d['user'],_0xb9fb7e=_0x23480d[_0xe7dff4(0x13c)],_0x12eb2f=await profile['findOne']({'email':_0xb9fb7e[_0xe7dff4(0x125)]}),_0x3a9f08=await master_shop[_0xe7dff4(0x19d)](),_0x1801a9=await transfers['findById'](_0x23480d[_0xe7dff4(0x18a)]['id']);let _0x1d94db;if(_0xb9fb7e[_0xe7dff4(0x19f)]=='staff'){const _0x2467f8=await staff[_0xe7dff4(0x1d1)]({'email':_0xb9fb7e[_0xe7dff4(0x125)]});_0x1d94db=await warehouse['aggregate']([{'$match':{'status':_0xe7dff4(0x1ee),'name':_0x2467f8[_0xe7dff4(0x18d)],'warehouse_category':_0xe7dff4(0x1d2)}},{'$group':{'_id':_0xe7dff4(0x1e0),'name':{'$first':_0xe7dff4(0x1e0)}}}]);}else _0x1d94db=await warehouse['aggregate']([{'$match':{'status':_0xe7dff4(0x1ee),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0xe7dff4(0x1e0),'name':{'$first':_0xe7dff4(0x1e0)}}}]);const _0x33be04=await warehouse[_0xe7dff4(0x1f2)]([{'$match':{'name':_0x1801a9[_0xe7dff4(0x1eb)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0xe7dff4(0x11e)},{'$group':{'_id':_0xe7dff4(0x1da),'name':{'$first':_0xe7dff4(0x1c4)},'product_stock':{'$first':_0xe7dff4(0x17d)},'bay':{'$first':_0xe7dff4(0x1b2)},'bin':{'$first':_0xe7dff4(0x1d4)},'type':{'$first':_0xe7dff4(0x117)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xe7dff4(0x13d)},'secondary_code':{'$first':_0xe7dff4(0x1ec)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xe7dff4(0x16c)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xe7dff4(0x13b)},'production_date':{'$first':_0xe7dff4(0x1e8)},'room':{'$first':_0xe7dff4(0x1e4)}}}]),_0x3e88bd=await product[_0xe7dff4(0x19d)]({}),_0x11485e=BayBinSelected(_0x1801a9[_0xe7dff4(0x11d)],_0x1801a9[_0xe7dff4(0x173)]);if(_0x3a9f08[0x0][_0xe7dff4(0x1cc)]==_0xe7dff4(0x199)){var _0x5c788e=users[_0xe7dff4(0x18e)];console[_0xe7dff4(0x1af)](_0x5c788e);}else{if(_0x3a9f08[0x0][_0xe7dff4(0x1cc)]==_0xe7dff4(0x164))var _0x5c788e=users[_0xe7dff4(0x164)];else{if(_0x3a9f08[0x0]['language']=='German')var _0x5c788e=users['German'];else{if(_0x3a9f08[0x0][_0xe7dff4(0x1cc)]=='Spanish')var _0x5c788e=users[_0xe7dff4(0x1b8)];else{if(_0x3a9f08[0x0][_0xe7dff4(0x1cc)]==_0xe7dff4(0x174))var _0x5c788e=users[_0xe7dff4(0x174)];else{if(_0x3a9f08[0x0][_0xe7dff4(0x1cc)]==_0xe7dff4(0x1f6))var _0x5c788e=users[_0xe7dff4(0x14d)];else{if(_0x3a9f08[0x0][_0xe7dff4(0x1cc)]==_0xe7dff4(0x1a0))var _0x5c788e=users[_0xe7dff4(0x1a0)];else{if(_0x3a9f08[0x0][_0xe7dff4(0x1cc)]==_0xe7dff4(0x15e))var _0x5c788e=users['Arabic'];}}}}}}}_0x1349e9[_0xe7dff4(0x1f3)](_0xe7dff4(0x198),{'success':_0x23480d['flash'](_0xe7dff4(0x17c)),'errors':_0x23480d[_0xe7dff4(0x179)](_0xe7dff4(0x1cb)),'role':_0xb9fb7e,'profile':_0x12eb2f,'master_shop':_0x3a9f08,'warehouse':_0x1d94db,'transfer':_0x1801a9,'stock':_0x33be04,'unit':_0x3e88bd,'language':_0x5c788e});}catch(_0x2588ce){console[_0xe7dff4(0x1af)](_0x2588ce);}}),router[a0_0x26779e(0x140)]('/view/:id',auth,async(_0x505d36,_0xc4af9c)=>{var _0x353110=a0_0x26779e;try{const _0x3717a2=_0x505d36[_0x353110(0x18a)]['id'],_0x518b65=await transfers[_0x353110(0x1e9)](_0x3717a2);_0xc4af9c[_0x353110(0x1fe)](_0x505d36['body']);return;const {date:_0x2e2f16,from_warehouse:_0x3dd6ef,FromRoom_name:_0x220ebc,to_warehouse:_0x202311,ToRoom_name:_0x3e9d13,prod_name:_0x3d4e5a,from_prod_qty:_0x5b6ae4,from_prod_level:_0x4d0267,from_prod_isle:_0x3301cc,from_prod_pallet:_0x20616e,to_prod_qty:_0x3bd080,to_prod_level:_0x364104,to_prod_isle:_0x155a64,to_prod_pallet:_0x37511f,primary_code:_0x12b2cf,secondary_code:_0x48cf88,product_code3:_0x394333,note:_0x18761c,invoice:_0x2b9bf9,expiry_date:_0x32457a}=_0x505d36[_0x353110(0x1bb)];if(typeof _0x3d4e5a==_0x353110(0x180))var _0x34506f=[_0x505d36[_0x353110(0x1bb)]['prod_name']],_0x38320e=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x1f5)]],_0x3c6986=[_0x505d36[_0x353110(0x1bb)]['from_prod_level']],_0x12ed22=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x14b)]],_0x27f050=[_0x505d36['body']['from_prod_pallet']],_0x4e1ab7=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x16d)]],_0x225cd9=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x1df)]],_0x21665a=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x1a3)]],_0x294eb7=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x1c5)]],_0x2b8eab=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x184)]],_0x46b16d=[_0x505d36['body'][_0x353110(0x1a5)]],_0x5844b6=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x141)]],_0x176e2e=[_0x505d36[_0x353110(0x1bb)]['rak']],_0x583653=[_0x505d36[_0x353110(0x1bb)]['primary_code']],_0x4cc89d=[_0x505d36['body']['secondary_code']],_0x243191=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x1a1)]],_0xc338fc=[_0x505d36['body'][_0x353110(0x159)]],_0x2b4792=[_0x505d36[_0x353110(0x1bb)][_0x353110(0x132)]],_0x63bae2=[_0x505d36['body'][_0x353110(0x1d3)]],_0x61ea96=[_0x505d36['body']['batch_code']],_0x35d74b=[_0x505d36[_0x353110(0x1bb)]['expiry_date']],_0x3d2dbc=[_0x505d36[_0x353110(0x1bb)]['from_storage']],_0x4ba1d3=[_0x505d36['body'][_0x353110(0x1e5)]];else var _0x34506f=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x1a2)]],_0x5844b6=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x141)]],_0x176e2e=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x131)]],_0x4e1ab7=[..._0x505d36[_0x353110(0x1bb)]['from_types']],_0x46b16d=[..._0x505d36['body']['to_types']],_0x38320e=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x1f5)]],_0x3c6986=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x1b3)]],_0x12ed22=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x14b)]],_0x27f050=[..._0x505d36[_0x353110(0x1bb)]['from_prod_pallet']],_0x225cd9=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x1df)]],_0x21665a=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x1a3)]],_0x294eb7=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x1c5)]],_0x2b8eab=[..._0x505d36[_0x353110(0x1bb)]['to_prod_pallet']],_0x583653=[..._0x505d36[_0x353110(0x1bb)]['primary_code']],_0x4cc89d=[..._0x505d36[_0x353110(0x1bb)]['secondary_code']],_0x243191=[..._0x505d36['body'][_0x353110(0x1a1)]],_0xc338fc=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x159)]],_0x2b4792=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x132)]],_0x63bae2=[..._0x505d36['body'][_0x353110(0x1d3)]],_0x61ea96=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x194)]],_0x35d74b=[..._0x505d36['body'][_0x353110(0x16b)]],_0x3d2dbc=[..._0x505d36[_0x353110(0x1bb)]['from_storage']],_0x4ba1d3=[..._0x505d36[_0x353110(0x1bb)][_0x353110(0x1e5)]];const _0x2d4f06=_0x34506f[_0x353110(0x123)](_0x195771=>{return _0x195771={'product_name':_0x195771};});_0x38320e[_0x353110(0x196)]((_0x2a6d59,_0x2d2e27)=>{var _0x3e6a61=_0x353110;_0x2d4f06[_0x2d2e27][_0x3e6a61(0x16a)]=_0x2a6d59;}),_0x3c6986[_0x353110(0x196)]((_0x9188b2,_0x1896c8)=>{var _0x16c946=_0x353110;_0x2d4f06[_0x1896c8][_0x16c946(0x1c6)]=_0x9188b2;}),_0x12ed22[_0x353110(0x196)]((_0x2a5b59,_0x310121)=>{_0x2d4f06[_0x310121]['from_bin']=_0x2a5b59;}),_0x27f050[_0x353110(0x196)]((_0xf412c,_0x492285)=>{_0x2d4f06[_0x492285]['from_floorlevel']=_0xf412c;}),_0x225cd9[_0x353110(0x196)]((_0x46e5ec,_0x3fe30f)=>{var _0x3fe4ca=_0x353110;_0x2d4f06[_0x3fe30f][_0x3fe4ca(0x15b)]=_0x46e5ec;}),_0x21665a[_0x353110(0x196)]((_0x34085e,_0x26ec63)=>{var _0x2f124c=_0x353110;_0x2d4f06[_0x26ec63][_0x2f124c(0x1c1)]=_0x34085e;}),_0x294eb7[_0x353110(0x196)]((_0x1785a1,_0x53cd5f)=>{var _0x2ea307=_0x353110;_0x2d4f06[_0x53cd5f][_0x2ea307(0x113)]=_0x1785a1;}),_0x2b8eab[_0x353110(0x196)]((_0x20d47c,_0x2c6fca)=>{var _0x452395=_0x353110;_0x2d4f06[_0x2c6fca][_0x452395(0x118)]=_0x20d47c;}),_0x583653[_0x353110(0x196)]((_0x855dec,_0x346ba4)=>{_0x2d4f06[_0x346ba4]['primary_code']=_0x855dec;}),_0x4cc89d['forEach']((_0xc2d24e,_0x5bf451)=>{var _0x74cbdd=_0x353110;_0x2d4f06[_0x5bf451][_0x74cbdd(0x197)]=_0xc2d24e;}),_0x243191[_0x353110(0x196)]((_0x3ec176,_0x397990)=>{var _0x319b23=_0x353110;_0x2d4f06[_0x397990][_0x319b23(0x14e)]=_0x3ec176;}),_0xc338fc['forEach']((_0x517afd,_0x51f1c2)=>{var _0x41ddbf=_0x353110;_0x2d4f06[_0x51f1c2][_0x41ddbf(0x1ac)]=_0x517afd;}),_0x2b4792[_0x353110(0x196)]((_0x29ecfd,_0x16860b)=>{_0x2d4f06[_0x16860b]['unit']=_0x29ecfd;}),_0x63bae2[_0x353110(0x196)]((_0x65fe12,_0x5a5aa5)=>{_0x2d4f06[_0x5a5aa5]['secondary_unit']=_0x65fe12;}),_0x61ea96[_0x353110(0x196)]((_0x46a7b2,_0xaeb273)=>{_0x2d4f06[_0xaeb273]['batch_code']=_0x46a7b2;}),_0x35d74b['forEach']((_0x190bf6,_0x9f785e)=>{var _0x2d4fef=_0x353110;_0x2d4f06[_0x9f785e][_0x2d4fef(0x16b)]=_0x190bf6;}),_0x5844b6['forEach']((_0x36acf3,_0x33386b)=>{var _0x26b174=_0x353110;_0x2d4f06[_0x33386b][_0x26b174(0x141)]=_0x36acf3;}),_0x176e2e['forEach']((_0x3c058b,_0x5ac6d4)=>{var _0x4d8964=_0x353110;_0x2d4f06[_0x5ac6d4][_0x4d8964(0x11c)]=_0x3c058b;}),_0x4e1ab7[_0x353110(0x196)]((_0x52ec31,_0x5f0bf9)=>{var _0x3c824b=_0x353110;_0x2d4f06[_0x5f0bf9][_0x3c824b(0x16d)]=_0x52ec31;}),_0x46b16d[_0x353110(0x196)]((_0x16bec6,_0x25d963)=>{_0x2d4f06[_0x25d963]['to_types']=_0x16bec6;}),_0x3d2dbc[_0x353110(0x196)]((_0x9dfd59,_0x931f75)=>{var _0x3b33a7=_0x353110;_0x2d4f06[_0x931f75][_0x3b33a7(0x16e)]=_0x9dfd59;}),_0x4ba1d3[_0x353110(0x196)]((_0x107680,_0x344a46)=>{var _0x472135=_0x353110;_0x2d4f06[_0x344a46][_0x472135(0x13e)]=_0x107680;});const _0x56d98a=_0x2d4f06['filter'](_0x2f0c29=>_0x2f0c29[_0x353110(0x15b)]!=='0'&&_0x2f0c29[_0x353110(0x15b)]!==''||_0x2f0c29[_0x353110(0x118)]!=='0'&&_0x2f0c29[_0x353110(0x118)]!=='');var _0x2d4313=0x0;_0x56d98a['forEach'](_0x37d140=>{var _0x1cdab6=_0x353110;parseInt(_0x37d140['from_quantity'])<parseInt(_0x37d140[_0x1cdab6(0x15b)])&&_0x2d4313++;});if(_0x2d4313!=0x0)return _0x505d36[_0x353110(0x179)]('errors',_0x353110(0x1db)),_0xc4af9c[_0x353110(0x186)](_0x353110(0x142));const _0x82b709=await warehouse['findOne']({'name':_0x518b65[_0x353110(0x1eb)],'room':_0x518b65[_0x353110(0x1bf)]});_0x518b65[_0x353110(0x143)]['forEach'](_0x442706=>{var _0x4527d9=_0x353110;if(_0x442706[_0x4527d9(0x15b)]>0x0){const _0x5484e0=_0x82b709[_0x4527d9(0x15d)][_0x4527d9(0x123)](_0x281501=>{var _0x1defd3=_0x4527d9;_0x281501['product_name']==_0x442706['product_name']&&_0x281501[_0x1defd3(0x156)]==_0x442706[_0x1defd3(0x171)]&&_0x281501['type']==_0x442706['from_types']&&_0x281501[_0x1defd3(0x1fd)]==_0x442706[_0x1defd3(0x178)]&&_0x281501[_0x1defd3(0x14a)]==_0x442706[_0x1defd3(0x1c6)]&&_0x281501[_0x1defd3(0x11c)]==_0x442706[_0x1defd3(0x13e)]&&_0x281501[_0x1defd3(0x141)]==_0x442706[_0x1defd3(0x16e)]&&(_0x281501[_0x1defd3(0x1bc)]=parseInt(_0x281501[_0x1defd3(0x1bc)])+parseInt(_0x442706[_0x1defd3(0x15b)]));});}}),await _0x82b709[_0x353110(0x129)]();const _0xa4235b=await warehouse[_0x353110(0x1d1)]({'name':_0x518b65[_0x353110(0x11d)],'room':_0x518b65[_0x353110(0x173)]});_0x518b65[_0x353110(0x143)][_0x353110(0x196)](_0x1675dd=>{var _0x364e02=_0x353110;if(_0x1675dd[_0x364e02(0x15b)]>0x0){const _0x541f0e=_0xa4235b[_0x364e02(0x15d)][_0x364e02(0x123)](_0x1859bb=>{var _0x42aae1=_0x364e02;_0x1859bb[_0x42aae1(0x146)]==_0x1675dd[_0x42aae1(0x146)]&&_0x1859bb[_0x42aae1(0x156)]==_0x1675dd['to_floorlevel']&&_0x1859bb[_0x42aae1(0x1f0)]==_0x1675dd[_0x42aae1(0x1a5)]&&_0x1859bb[_0x42aae1(0x1fd)]==_0x1675dd[_0x42aae1(0x113)]&&_0x1859bb[_0x42aae1(0x14a)]==_0x1675dd[_0x42aae1(0x1c1)]&&_0x1859bb['rack']==_0x1675dd[_0x42aae1(0x11c)]&&_0x1859bb[_0x42aae1(0x141)]==_0x1675dd[_0x42aae1(0x141)]&&(_0x1859bb[_0x42aae1(0x1bc)]=parseInt(_0x1859bb['product_stock'])-parseInt(_0x1675dd[_0x42aae1(0x15b)]));});}}),await _0xa4235b['save'](),_0x518b65[_0x353110(0x138)]=_0x2e2f16,_0x518b65['from_warehouse']=_0x3dd6ef,_0x518b65['to_warehouse']=_0x202311,_0x518b65['product']=_0x56d98a,_0x518b65[_0x353110(0x160)]=_0x18761c,_0x518b65[_0x353110(0x165)]=_0x2b9bf9;const _0x1d97b0=await _0x518b65[_0x353110(0x129)]();console[_0x353110(0x1af)](_0x1d97b0);const _0x134ea3=await warehouse['findOne']({'name':_0x3dd6ef,'room':_0x220ebc});_0x1d97b0[_0x353110(0x143)][_0x353110(0x196)](_0x3f0ddd=>{var _0xf89ad6=_0x353110;if(_0x3f0ddd[_0xf89ad6(0x15b)]>0x0){const _0x5057bf=_0x134ea3[_0xf89ad6(0x15d)][_0xf89ad6(0x123)](_0x376b61=>{var _0xcb23c=_0xf89ad6;_0x376b61['product_name']==_0x3f0ddd[_0xcb23c(0x146)]&&_0x376b61[_0xcb23c(0x156)]==_0x3f0ddd[_0xcb23c(0x171)]&&_0x376b61[_0xcb23c(0x1f0)]==_0x3f0ddd[_0xcb23c(0x16d)]&&_0x376b61[_0xcb23c(0x1fd)]==_0x3f0ddd[_0xcb23c(0x178)]&&_0x376b61[_0xcb23c(0x14a)]==_0x3f0ddd[_0xcb23c(0x1c6)]&&_0x376b61[_0xcb23c(0x11c)]==_0x3f0ddd[_0xcb23c(0x13e)]&&_0x376b61['storage']==_0x3f0ddd['from_storage']&&(_0x376b61[_0xcb23c(0x1bc)]=parseInt(_0x376b61[_0xcb23c(0x1bc)])-parseInt(_0x3f0ddd[_0xcb23c(0x15b)]));});}}),await _0x134ea3[_0x353110(0x129)]();const _0x167ec5=await warehouse[_0x353110(0x1d1)]({'name':_0x202311,'room':_0x3e9d13});_0x1d97b0[_0x353110(0x143)][_0x353110(0x196)](_0x58cb94=>{var _0x6ce9d7=_0x353110;if(_0x58cb94[_0x6ce9d7(0x15b)]>0x0){var _0x1eabcf=0x0;const _0x370b71=_0x167ec5[_0x6ce9d7(0x15d)][_0x6ce9d7(0x123)](_0x26ab95=>{var _0x14ae02=_0x6ce9d7;_0x26ab95[_0x14ae02(0x146)]==_0x58cb94[_0x14ae02(0x146)]&&_0x26ab95[_0x14ae02(0x156)]==_0x58cb94[_0x14ae02(0x118)]&&_0x26ab95[_0x14ae02(0x1f0)]==_0x58cb94['to_types']&&_0x26ab95[_0x14ae02(0x1fd)]==_0x58cb94[_0x14ae02(0x113)]&&_0x26ab95[_0x14ae02(0x14a)]==_0x58cb94['to_bay']&&_0x26ab95['rack']==_0x58cb94[_0x14ae02(0x11c)]&&_0x26ab95[_0x14ae02(0x141)]==_0x58cb94[_0x14ae02(0x141)]&&(_0x26ab95[_0x14ae02(0x1bc)]=parseInt(_0x26ab95['product_stock'])+parseInt(_0x58cb94['to_quantity']),_0x1eabcf++);});_0x1eabcf=='0'&&(_0x167ec5['product_details']=_0x167ec5[_0x6ce9d7(0x15d)]['concat']({'product_name':_0x58cb94[_0x6ce9d7(0x146)],'product_stock':_0x58cb94[_0x6ce9d7(0x15b)],'bay':_0x58cb94[_0x6ce9d7(0x1c1)],'bin':_0x58cb94[_0x6ce9d7(0x113)],'type':_0x58cb94[_0x6ce9d7(0x1a5)],'floorlevel':_0x58cb94['to_floorlevel'],'storage':_0x58cb94[_0x6ce9d7(0x141)],'rack':_0x58cb94['rack'],'product_code':_0x58cb94[_0x6ce9d7(0x14e)],'primary_code':_0x58cb94['primary_code'],'secondary_code':_0x58cb94[_0x6ce9d7(0x197)],'maxProducts':_0x58cb94[_0x6ce9d7(0x1ac)],'storage':_0x58cb94[_0x6ce9d7(0x141)],'rack':_0x58cb94['rack']}));}}),await _0x167ec5['save'](),_0x505d36[_0x353110(0x179)]('success',_0x353110(0x183)),_0xc4af9c[_0x353110(0x186)](_0x353110(0x1ba));}catch(_0x23091e){console[_0x353110(0x1af)](_0x23091e);}}),router[a0_0x26779e(0x140)](a0_0x26779e(0x1b4),async(_0x10b0f4,_0x1337d1)=>{var _0x342f41=a0_0x26779e;const {FromWareHouse:_0x5e4312,FromRoom:_0x347b6f,ToWarehouse:_0x5093e8,ToRoom:_0x1234b3,primary_code:_0x56f18e,Roomslist:_0x39efad}=_0x10b0f4['body'],_0x12889a=_0x39efad[_0x342f41(0x15c)](','),_0x216e2e=[];async function _0x3b1032(_0x39dfb3){var _0x2138f7=_0x342f41;const _0x2a812d=await warehouse['aggregate']([{'$match':{'name':_0x5e4312,'room':_0x39dfb3}},{'$unwind':_0x2138f7(0x11e)},{'$match':{'product_details.primary_code':_0x56f18e}},{'$group':{'_id':_0x2138f7(0x1da),'name':{'$first':_0x2138f7(0x1c4)},'instock':{'$first':_0x2138f7(0x17d)},'primary_code':{'$first':_0x2138f7(0x13d)},'secondary_code':{'$first':_0x2138f7(0x1ec)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2138f7(0x1b2)},'isle':{'$first':_0x2138f7(0x1d4)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2138f7(0x1c0)},'secondary_unit':{'$first':_0x2138f7(0x1f1)},'storage':{'$first':_0x2138f7(0x16c)},'rack':{'$first':_0x2138f7(0x166)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2138f7(0x1e8)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x2138f7(0x1dd)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x2138f7(0x1e4)},'maxProducts':{'$first':_0x2138f7(0x149)}}}]),_0x48cb99=await warehouse[_0x2138f7(0x1f2)]([{'$match':{'name':_0x5e4312,'room':_0x39dfb3}},{'$unwind':_0x2138f7(0x11e)},{'$match':{'product_details.secondary_code':_0x56f18e}},{'$group':{'_id':_0x2138f7(0x1da),'name':{'$first':_0x2138f7(0x1c4)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2138f7(0x13d)},'secondary_code':{'$first':_0x2138f7(0x1ec)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2138f7(0x1b2)},'isle':{'$first':_0x2138f7(0x1d4)},'type':{'$first':_0x2138f7(0x117)},'pallet':{'$first':_0x2138f7(0x136)},'unit':{'$first':_0x2138f7(0x1c0)},'secondary_unit':{'$first':_0x2138f7(0x1f1)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2138f7(0x166)},'expiry_date':{'$first':_0x2138f7(0x13b)},'production_date':{'$first':_0x2138f7(0x1e8)},'batch_code':{'$first':_0x2138f7(0x168)},'maxPerUnit':{'$first':_0x2138f7(0x1dd)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x2138f7(0x149)}}}]);if(_0x2a812d[_0x2138f7(0x163)]>0x0)_0x216e2e['push'](_0x2a812d);else _0x48cb99[_0x2138f7(0x163)]>0x0&&_0x216e2e[_0x2138f7(0x1dc)](_0x48cb99);}const _0x3d66ff=_0x12889a[_0x342f41(0x123)](_0x3883d1=>_0x3b1032(_0x3883d1));await Promise[_0x342f41(0x17a)](_0x3d66ff),_0x1337d1[_0x342f41(0x1fe)](_0x216e2e);}),router[a0_0x26779e(0x140)](a0_0x26779e(0x1d6),async(_0x369396,_0x37dcd0)=>{var _0x57c29a=a0_0x26779e;try{const {FromWareHouse:_0x52806b,FromRoom:_0x244d78,ToWarehouse:_0x4734b9,ToRoom:_0x3a79ba,secondary_code:_0x80b1d7}=_0x369396['body'],_0xffa088=await warehouse[_0x57c29a(0x1f2)]([{'$match':{'name':_0x52806b}},{'$unwind':_0x57c29a(0x11e)},{'$match':{'product_details.secondary_code':_0x80b1d7}},{'$group':{'_id':_0x57c29a(0x1da),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x57c29a(0x1ec)},'product_code':{'$first':_0x57c29a(0x15a)},'instock':{'$first':_0x57c29a(0x17d)},'warehouse':{'$first':'$name'},'level':{'$first':_0x57c29a(0x13f)},'isle':{'$first':_0x57c29a(0x1fb)},'pallet':{'$first':_0x57c29a(0x1fa)},'maxProducts':{'$first':_0x57c29a(0x149)},'unit':{'$first':_0x57c29a(0x1c0)}}}]);_0x37dcd0['status'](0xc8)[_0x57c29a(0x1fe)](_0xffa088);}catch(_0x3d16ca){_0x37dcd0[_0x57c29a(0x1b5)](0x194)['json']({'message':_0x3d16ca[_0x57c29a(0x1c7)]});}}),router[a0_0x26779e(0x140)](a0_0x26779e(0x1d0),async(_0xc564b,_0x43bc69)=>{var _0x15eb14=a0_0x26779e;try{const {FromWareHouse:_0x1e95a9,FromRoom:_0x15007d,ToWarehouse:_0x2e168a,ToRoom:_0x2add3c,product_code:_0x7b5ccb}=_0xc564b[_0x15eb14(0x1bb)],_0xc5b0a2=await warehouse[_0x15eb14(0x1f2)]([{'$match':{'name':_0x1e95a9}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x7b5ccb}},{'$group':{'_id':_0x15eb14(0x1da),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x15eb14(0x13d)},'secondary_code':{'$first':_0x15eb14(0x1ec)},'product_code':{'$first':_0x15eb14(0x15a)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x15eb14(0x1e0)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x15eb14(0x149)},'unit':{'$first':_0x15eb14(0x1c0)}}}]);_0x43bc69[_0x15eb14(0x1b5)](0xc8)['json'](_0xc5b0a2);}catch(_0x1430e2){_0x43bc69[_0x15eb14(0x1b5)](0x194)[_0x15eb14(0x1fe)]({'message':_0x1430e2[_0x15eb14(0x1c7)]});}}),router[a0_0x26779e(0x140)]('/CheckingWarehouse',async(_0x51fd09,_0x3db4ca)=>{var _0x270a26=a0_0x26779e;const {level:_0x10c663,isle:_0x167afb,pallet:_0x2715e6,warehouses:_0x8fecb7,room:_0x4c576c}=_0x51fd09[_0x270a26(0x1bb)];try{const _0x3ac56d=await warehouse[_0x270a26(0x1f2)]([{'$match':{'name':_0x8fecb7,'room':_0x4c576c}},{'$unwind':_0x270a26(0x11e)},{'$match':{'product_details.level':parseInt(_0x10c663),'product_details.isle':_0x167afb,'product_details.pallet':parseInt(_0x2715e6)}},{'$group':{'_id':_0x270a26(0x1da),'name':{'$first':_0x270a26(0x1c4)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x270a26(0x13f)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x270a26(0x1fa)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x3db4ca['status'](0xc8)[_0x270a26(0x1fe)](_0x3ac56d);}catch(_0x1c6081){_0x3db4ca['status'](0x194)[_0x270a26(0x1fe)]({'message':_0x1c6081[_0x270a26(0x1c7)]});}}),module[a0_0x26779e(0x14f)]=router;