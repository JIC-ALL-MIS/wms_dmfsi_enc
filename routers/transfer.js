var a0_0x170297=a0_0x1214;(function(_0x4c90e6,_0x4d8826){var _0x2a8396=a0_0x1214,_0xf77bf=_0x4c90e6();while(!![]){try{var _0x117357=parseInt(_0x2a8396(0x1de))/0x1*(-parseInt(_0x2a8396(0x248))/0x2)+-parseInt(_0x2a8396(0x1ee))/0x3*(parseInt(_0x2a8396(0x236))/0x4)+parseInt(_0x2a8396(0x23b))/0x5+-parseInt(_0x2a8396(0x1c4))/0x6*(parseInt(_0x2a8396(0x1b8))/0x7)+-parseInt(_0x2a8396(0x1eb))/0x8*(-parseInt(_0x2a8396(0x25f))/0x9)+parseInt(_0x2a8396(0x279))/0xa+parseInt(_0x2a8396(0x224))/0xb;if(_0x117357===_0x4d8826)break;else _0xf77bf['push'](_0xf77bf['shift']());}catch(_0x1030c3){_0xf77bf['push'](_0xf77bf['shift']());}}}(a0_0x4e19,0x3946a));function a0_0x1214(_0x3ec950,_0x4b522f){var _0x4e19ff=a0_0x4e19();return a0_0x1214=function(_0x121465,_0x1b9519){_0x121465=_0x121465-0x184;var _0x3994e1=_0x4e19ff[_0x121465];return _0x3994e1;},a0_0x1214(_0x3ec950,_0x4b522f);}const express=require(a0_0x170297(0x1b0)),app=express(),router=express[a0_0x170297(0x1e0)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x170297(0x1ab)),auth=require(a0_0x170297(0x1a8)),users=require(a0_0x170297(0x258)),nodemailer=require(a0_0x170297(0x187));router['get']('/view',auth,async(_0xe5d549,_0xa7fae5)=>{var _0x358b54=a0_0x170297;try{const {username:_0x57e69d,email:_0x546437,role:_0x189f50}=_0xe5d549[_0x358b54(0x21c)],_0x3a43b3=_0xe5d549[_0x358b54(0x21c)],_0x12be28=await profile['findOne']({'email':_0x3a43b3[_0x358b54(0x185)]}),_0x435f01=await master_shop[_0x358b54(0x19c)]();console[_0x358b54(0x24e)](_0x358b54(0x22a),_0x435f01);let _0x214ae5;if(_0x3a43b3[_0x358b54(0x277)]=='staff'){const _0x4fe038=await staff[_0x358b54(0x263)]({'email':_0x3a43b3[_0x358b54(0x185)]});_0x214ae5=await transfers[_0x358b54(0x19c)]({'from_warehouse':_0x4fe038[_0x358b54(0x273)]});}else _0x214ae5=await transfers[_0x358b54(0x220)]([{'$unwind':_0x358b54(0x1c3)},{'$group':{'_id':_0x358b54(0x201),'invoice':{'$first':'$invoice'},'date':{'$first':_0x358b54(0x18b)},'from_warehouse':{'$first':_0x358b54(0x271)},'to_warehouse':{'$first':_0x358b54(0x1ac)},'from_room_name':{'$addToSet':_0x358b54(0x1f4)},'to_room_name':{'$addToSet':_0x358b54(0x1be)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x358b54(0x1a3)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x435f01[0x0]['language']==_0x358b54(0x1fb)){var _0x3e2ddb=users[_0x358b54(0x1cd)];console[_0x358b54(0x24e)](_0x3e2ddb);}else{if(_0x435f01[0x0][_0x358b54(0x276)]==_0x358b54(0x261))var _0x3e2ddb=users['Hindi'];else{if(_0x435f01[0x0][_0x358b54(0x276)]==_0x358b54(0x1a5))var _0x3e2ddb=users['German'];else{if(_0x435f01[0x0][_0x358b54(0x276)]==_0x358b54(0x239))var _0x3e2ddb=users[_0x358b54(0x239)];else{if(_0x435f01[0x0]['language']==_0x358b54(0x242))var _0x3e2ddb=users[_0x358b54(0x242)];else{if(_0x435f01[0x0][_0x358b54(0x276)]==_0x358b54(0x254))var _0x3e2ddb=users[_0x358b54(0x1ae)];else{if(_0x435f01[0x0][_0x358b54(0x276)]==_0x358b54(0x246))var _0x3e2ddb=users['Chinese'];else{if(_0x435f01[0x0][_0x358b54(0x276)]=='Arabic\x20(ae)')var _0x3e2ddb=users[_0x358b54(0x1f2)];}}}}}}}_0xa7fae5['render']('transfer',{'success':_0xe5d549[_0x358b54(0x1cf)](_0x358b54(0x1f1)),'errors':_0xe5d549[_0x358b54(0x1cf)](_0x358b54(0x1df)),'role':_0x3a43b3,'profile':_0x12be28,'master_shop':_0x435f01,'transfer':_0x214ae5,'language':_0x3e2ddb});}catch(_0x4b3fc9){console[_0x358b54(0x24e)](_0x4b3fc9);}});function a0_0x4e19(){var _0x398ba2=['$product.to_room_name','Logo.png','<span\x20style=\x22float:\x20right;\x22>','$product_details.unit','bin','$product','2802GQdCUb','product_stock','to_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Enabled','to_prod_pallet','map','from_prod_pallet','/barcode_scanner3','English','product_details','flash','maxperunit','forEach','rak','from_rak','error','MaxStocks_data2','$product_details.maxProducts','$product_details.product_code','updateOne','body','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','staff','prod_name','$product_details.batch_code','126670iRDAhC','errors','Router','Enclosed','$name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','An\x20error\x20occurred.','/view/add_transfer','all','$product_details.rack','add_transfer','Shelves','To_invoice','232nGVPwt','logo','catch','6PFHVTe','here','floorlevel','success','Arabic','to_floorlevel','$product.from_room_name','product_code3','Rack\x20F','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.production_date','Rack\x20A','$product_details.expiry_date','English\x20(US)','from_rack','to_room','Product\x20Transfer\x20successfully','from_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$_id','to_invoice','<h5>','to_prod_level','date','from_storage','</head><body>','host','push','</span>','back','toString','note','findById','$product_details.pallet','post','invoice','</thead>','Rack\x20E','to_bay','\x20</h2>','status','from_room_name','site_title','to_room_name','$product_details.product_stock','Arabic\x20(ae)','user','primary_code','$product_details.secondary_unit','New_Qty_Converted','aggregate','port','<div>','image','9079400KTMZNB','prod_cat','from_types','$product_details.maxPerUnit','length','Floor','master','Transfer\x20Edit\x20Successfully','redirect','product_name','rack','$product_details.secondary_code','createTransport','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','then','getDate','bay','</h5>','615260ncLahZ','message','/transfer/preview/','Spanish','slice','1005410uTgQIp','_id','/../public','/preview/:id','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.storage','production_date','French','to_types','from_floorlevel','to_prod_isle','Chinese','Ambient','4KPVFZu','$product_details.floorlevel','<h2>\x20','batch_code','edit_transfer_view','RMSEmail','log','DRY\x20STORAGE','/barcode_scanner2','<!DOCTYPE\x20html>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details._id','Portuguese\x20(BR)','/picking_list/PDF_transfer_rm/','</td>','getMonth','../public/language/languages.json','An\x20error\x20occurred\x20while\x20saving\x20data.','from_quantity','/barcode_scanner','Error\x20Occurs','$product_details','<strong>\x20Regards\x20</strong>','36891swKgCX','get','Hindi','Rack\x20B','findOne','concat','getFullYear','finalize','Level','</table>','$product_details.bay','split','Transfer\x20Mail','/view/:id','string','</tr>','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$from_warehouse','TRF-','warehouse','from_invoice','secondary_code','language','role','from_prod_level','401640puYdUt','render','email','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','nodemailer','padStart','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$date','product','$product_details.bin','to_warehouse','from_prod_qty','unit','primary_unit','filter','Raw\x20Materials','$product_details.type','$product_details.level','to_bin','id_transaction_id','$room','expiry_date','</tbody>','maxProducts','find','id_transaction','</div>','from_bin','<hr\x20class=\x22my-3\x22>','random','/CheckingWarehouse','$isAllowEdit','storage','German','exports','product_code','../middleware/auth','$product_details.primary_code','\x20<>\x20','../models/all_models','$to_warehouse','from_warehouse','Portuguese','type','express','from_prod_isle','<html><head><title></title>','Receiving\x20Area','RoomAssigned','save','params','/transfer/view','5845ewNGuk','to_prod_qty','json','secondary_unit','\x20Order\x20Number\x20:\x20','$product_details.product_name'];a0_0x4e19=function(){return _0x398ba2;};return a0_0x4e19();}async function getRandom8DigitNumber(){var _0x2a4453=a0_0x170297;const _0x459871=0x989680,_0x4b0681=0x5f5e0ff,_0x41f00e=Math['floor'](Math[_0x2a4453(0x1a1)]()*(_0x4b0681-_0x459871+0x1))+_0x459871;var _0x223716;const _0x494f87=await transfers['findOne']({'invoice':_0x2a4453(0x272)+_0x41f00e});return _0x494f87&&_0x494f87[_0x2a4453(0x228)]>0x0?_0x223716=_0x2a4453(0x272)+_0x41f00e:_0x223716=_0x2a4453(0x272)+_0x41f00e,_0x223716;}router[a0_0x170297(0x260)]('/view/add_transfer',auth,async(_0x1359fe,_0x4d2367)=>{var _0x59f52a=a0_0x170297;try{const {username:_0x5d4c00,email:_0x5c1689,role:_0x4bbc5e}=_0x1359fe[_0x59f52a(0x21c)],_0x1e1085=_0x1359fe[_0x59f52a(0x21c)],_0x2fd312=await profile[_0x59f52a(0x263)]({'email':_0x1e1085[_0x59f52a(0x185)]}),_0x2c7593=await master_shop[_0x59f52a(0x19c)]();console[_0x59f52a(0x24e)]('master',_0x2c7593);let _0x26a244;if(_0x1e1085[_0x59f52a(0x277)]==_0x59f52a(0x1db)){const _0x7509a=await staff['findOne']({'email':_0x1e1085[_0x59f52a(0x185)]});_0x26a244=await warehouse['aggregate']([{'$match':{'status':_0x59f52a(0x1c8),'name':_0x7509a[_0x59f52a(0x273)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x59f52a(0x1e2),'name':{'$first':_0x59f52a(0x1e2)}}}]);}else _0x26a244=await warehouse[_0x59f52a(0x220)]([{'$match':{'status':_0x59f52a(0x1c8),'warehouse_category':_0x59f52a(0x193)}},{'$group':{'_id':'$name','name':{'$first':_0x59f52a(0x1e2)}}}]);var _0x3e4ac9=[_0x59f52a(0x247),_0x59f52a(0x1e1),'Return\x20Rooms'];const _0x38fc22=await transfers[_0x59f52a(0x19c)]({}),_0x2b05b9=_0x38fc22[_0x59f52a(0x228)]+0x1,_0x252574=_0x59f52a(0x272)+_0x2b05b9[_0x59f52a(0x20c)]()[_0x59f52a(0x188)](0x5,'0');if(_0x2c7593[0x0]['language']==_0x59f52a(0x1fb)){var _0xdbfac4=users['English'];console[_0x59f52a(0x24e)](_0xdbfac4);}else{if(_0x2c7593[0x0][_0x59f52a(0x276)]=='Hindi')var _0xdbfac4=users[_0x59f52a(0x261)];else{if(_0x2c7593[0x0][_0x59f52a(0x276)]==_0x59f52a(0x1a5))var _0xdbfac4=users['German'];else{if(_0x2c7593[0x0]['language']==_0x59f52a(0x239))var _0xdbfac4=users[_0x59f52a(0x239)];else{if(_0x2c7593[0x0][_0x59f52a(0x276)]==_0x59f52a(0x242))var _0xdbfac4=users[_0x59f52a(0x242)];else{if(_0x2c7593[0x0][_0x59f52a(0x276)]==_0x59f52a(0x254))var _0xdbfac4=users[_0x59f52a(0x1ae)];else{if(_0x2c7593[0x0]['language']==_0x59f52a(0x246))var _0xdbfac4=users[_0x59f52a(0x246)];else{if(_0x2c7593[0x0][_0x59f52a(0x276)]=='Arabic\x20(ae)')var _0xdbfac4=users[_0x59f52a(0x1f2)];}}}}}}}const _0x289f20=getRandom8DigitNumber();_0x289f20[_0x59f52a(0x232)](_0x5b731a=>{var _0x31484a=_0x59f52a;_0x4d2367[_0x31484a(0x184)](_0x31484a(0x1e8),{'success':_0x1359fe['flash'](_0x31484a(0x1f1)),'errors':_0x1359fe[_0x31484a(0x1cf)](_0x31484a(0x1df)),'role':_0x1e1085,'profile':_0x2fd312,'master_shop':_0x2c7593,'warehouse':_0x26a244,'language':_0xdbfac4,'rooms_data':_0x3e4ac9,'invoice':_0x5b731a});})['catch'](_0x26b28a=>{var _0x1edf4b=_0x59f52a;_0x1359fe[_0x1edf4b(0x1cf)](_0x1edf4b(0x1df),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4d2367[_0x1edf4b(0x22c)](_0x1edf4b(0x1b7));});}catch(_0x380d05){console[_0x59f52a(0x24e)](_0x380d05);}}),router[a0_0x170297(0x210)](a0_0x170297(0x1e5),auth,async(_0x776933,_0x5e63ec)=>{var _0x2fdbbe=a0_0x170297;try{console[_0x2fdbbe(0x24e)](_0x776933[_0x2fdbbe(0x1d9)]);const {date:_0x5caab8,from_warehouse:_0x11ab04,FromRoom_name:_0x182b09,to_warehouse:_0x34118e,ToRoom_name:_0x213911,prod_name:_0x54be6f,from_prod_qty:_0x400f9,from_prod_level:_0x5d41e7,from_prod_isle:_0xfcf6a,from_prod_pallet:_0x23d70d,to_prod_qty:_0x5f1ea6,to_prod_level:_0x21a86b,to_prod_isle:_0x4a4f8e,to_prod_pallet:_0x1bd342,primary_code:_0x3a86ce,secondary_code:_0x1b9783,product_code3:_0x2a30da,note:_0x2202a2,MaxStocks_data2:_0x499938,invoice:_0x43cb5e,expiry_date:_0x5364f9}=_0x776933[_0x2fdbbe(0x1d9)];if(typeof _0x54be6f==_0x2fdbbe(0x26d))var _0x1c2566=[_0x776933[_0x2fdbbe(0x1d9)]['prod_name']],_0x3cc53d=[_0x776933[_0x2fdbbe(0x1d9)]['from_prod_qty']],_0x229d4c=[_0x776933['body']['from_prod_level']],_0x5c0dea=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x21f)]],_0x167000=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x204)]],_0x12a8d1=[_0x776933['body'][_0x2fdbbe(0x21d)]],_0x17aa0d=[_0x776933['body'][_0x2fdbbe(0x275)]],_0x5efeae=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1f5)]],_0x5b344d=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1d5)]],_0x37b41e=[_0x776933['body'][_0x2fdbbe(0x191)]],_0x298f31=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1bb)]],_0x375f3a=[_0x776933['body']['batch_code']],_0x3c00ae=[_0x776933['body'][_0x2fdbbe(0x199)]],_0x1adaef=[_0x776933[_0x2fdbbe(0x1d9)]['max_per_unit']],_0x11fc92=[_0x776933[_0x2fdbbe(0x1d9)]['production_date']],_0x1edf2a=[_0x776933['body'][_0x2fdbbe(0x225)]],_0xe40342=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1b4)]],_0x56c711=[_0x776933[_0x2fdbbe(0x1d9)]['ToRoomAssigned']],_0x838519=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x274)]],_0x5d09d6=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x202)]],_0xa4b3c0=[_0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x19d)]];else var _0x1c2566=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1dc)]],_0x3cc53d=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x18f)]],_0x229d4c=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x278)]],_0x5c0dea=[..._0x776933[_0x2fdbbe(0x1d9)]['New_Qty_Converted']],_0x167000=[..._0x776933[_0x2fdbbe(0x1d9)]['to_prod_level']],_0x12a8d1=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x21d)]],_0x17aa0d=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x275)]],_0x5efeae=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1f5)]],_0x5b344d=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1d5)]],_0x37b41e=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x191)]],_0x298f31=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1bb)]],_0x375f3a=[..._0x776933[_0x2fdbbe(0x1d9)]['batch_code']],_0x3c00ae=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x199)]],_0x1adaef=[..._0x776933['body']['max_per_unit']],_0x11fc92=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x241)]],_0x1edf2a=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x225)]],_0xe40342=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x1b4)]],_0x56c711=[..._0x776933[_0x2fdbbe(0x1d9)]['ToRoomAssigned']],_0x838519=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x274)]],_0x5d09d6=[..._0x776933[_0x2fdbbe(0x1d9)][_0x2fdbbe(0x202)]],_0xa4b3c0=[..._0x776933['body'][_0x2fdbbe(0x19d)]];const _0x26b60d=_0x1c2566[_0x2fdbbe(0x1ca)](_0x5cc60c=>{return _0x5cc60c={'product_name':_0x5cc60c};});_0x3cc53d[_0x2fdbbe(0x1d1)]((_0x2e8489,_0x336ecc)=>{var _0x2b0949=_0x2fdbbe;_0x26b60d[_0x336ecc][_0x2b0949(0x25a)]=_0x2e8489;}),_0x838519[_0x2fdbbe(0x1d1)]((_0x3be639,_0x1539a3)=>{var _0x4adec9=_0x2fdbbe;_0x26b60d[_0x1539a3][_0x4adec9(0x274)]=_0x3be639;}),_0x5d09d6[_0x2fdbbe(0x1d1)]((_0xb3d069,_0xbf1ecc)=>{var _0x4affed=_0x2fdbbe;_0x26b60d[_0xbf1ecc][_0x4affed(0x1ea)]=_0xb3d069;}),_0xa4b3c0[_0x2fdbbe(0x1d1)]((_0x4e9403,_0x306bf4)=>{var _0xfea83b=_0x2fdbbe;_0x26b60d[_0x306bf4][_0xfea83b(0x197)]=_0x4e9403;}),_0x229d4c['forEach']((_0x157e03,_0x4b3c4d)=>{_0xe40342['forEach']((_0x2622bc,_0x2ffc6c)=>{var _0xbfd08e=a0_0x1214;if(_0x2622bc==_0xbfd08e(0x1b3)&&_0x4b3c4d==_0x2ffc6c){var _0x2f1fa7=_0x157e03[_0xbfd08e(0x23a)](0x3);_0x26b60d[_0x4b3c4d][_0xbfd08e(0x206)]=_0x157e03[0x0],_0x26b60d[_0x4b3c4d]['from_rack']=_0x157e03[0x1],_0x26b60d[_0x4b3c4d][_0xbfd08e(0x1ff)]=0x0,_0x26b60d[_0x4b3c4d][_0xbfd08e(0x19f)]=0x0,_0x26b60d[_0x4b3c4d][_0xbfd08e(0x226)]='Floor',_0x26b60d[_0x4b3c4d][_0xbfd08e(0x244)]=_0x2f1fa7;}else{if(_0x2622bc==_0xbfd08e(0x1e9)&&_0x4b3c4d==_0x2ffc6c){var _0x2f1fa7=_0x157e03['slice'](0x3);_0x26b60d[_0x4b3c4d][_0xbfd08e(0x206)]=_0x157e03[0x0],_0x26b60d[_0x4b3c4d]['from_rack']=_0x157e03[0x1],_0x26b60d[_0x4b3c4d][_0xbfd08e(0x1ff)]=0x0,_0x26b60d[_0x4b3c4d]['from_bin']=0x0,_0x26b60d[_0x4b3c4d][_0xbfd08e(0x226)]=_0xbfd08e(0x229),_0x26b60d[_0x4b3c4d][_0xbfd08e(0x244)]=_0x157e03[0x5];}else{if(_0x4b3c4d==_0x2ffc6c){if(_0x157e03[0x0]=='A'&&_0x157e03[0x1]=='L'&&_0x157e03[0x2]=='L')console['log'](_0x2622bc+_0xbfd08e(0x1aa)+_0x4b3c4d+_0xbfd08e(0x1aa)+_0x2ffc6c+_0xbfd08e(0x1aa)+_0x157e03+_0xbfd08e(0x1ef)),_0x26b60d[_0x4b3c4d][_0xbfd08e(0x206)]=_0x157e03[0x0],_0x26b60d[_0x4b3c4d][_0xbfd08e(0x1fc)]=_0x157e03[0x1],_0x26b60d[_0x4b3c4d][_0xbfd08e(0x1ff)]=0x0,_0x26b60d[_0x4b3c4d][_0xbfd08e(0x19f)]=0x0,_0x26b60d[_0x4b3c4d][_0xbfd08e(0x226)]=_0xbfd08e(0x229),_0x26b60d[_0x4b3c4d][_0xbfd08e(0x244)]=_0x157e03[0x3];else{var _0x28fc28;if(_0x157e03[0x4]=='L')_0x28fc28=_0xbfd08e(0x267);else _0x157e03[0x4]=='F'&&(_0x28fc28=_0xbfd08e(0x229));_0x26b60d[_0x4b3c4d][_0xbfd08e(0x206)]=_0x157e03[0x0],_0x26b60d[_0x4b3c4d]['from_rack']=_0x157e03[0x1],_0x26b60d[_0x4b3c4d][_0xbfd08e(0x1ff)]=_0x157e03[0x2],_0x26b60d[_0x4b3c4d][_0xbfd08e(0x19f)]=_0x157e03[0x3],_0x26b60d[_0x4b3c4d]['from_types']=_0x28fc28,_0x26b60d[_0x4b3c4d]['from_floorlevel']=_0x157e03[0x5];}}}}});}),_0x5c0dea[_0x2fdbbe(0x1d1)]((_0x3988bc,_0x433897)=>{var _0xd38d97=_0x2fdbbe;_0x26b60d[_0x433897][_0xd38d97(0x1c6)]=_0x3988bc;}),_0x167000['forEach']((_0x5d65bc,_0x223d05)=>{_0x56c711['forEach']((_0x42e35c,_0x3ebf09)=>{var _0x467aed=a0_0x1214;if(_0x42e35c==_0x467aed(0x1b3)&&_0x223d05==_0x3ebf09){var _0x1016d7=_0x5d65bc[_0x467aed(0x23a)](0x3);_0x26b60d[_0x223d05][_0x467aed(0x1a4)]=_0x5d65bc[0x0],_0x26b60d[_0x223d05][_0x467aed(0x22e)]=_0x5d65bc[0x1],_0x26b60d[_0x223d05]['to_bay']=0x0,_0x26b60d[_0x223d05][_0x467aed(0x196)]=0x0,_0x26b60d[_0x223d05]['to_types']='Floor',_0x26b60d[_0x223d05][_0x467aed(0x1f3)]=_0x1016d7;}else{if(_0x42e35c=='Shelves'&&_0x223d05==_0x3ebf09){var _0x1016d7=_0x5d65bc[_0x467aed(0x23a)](0x3);_0x26b60d[_0x223d05]['storage']=_0x5d65bc[0x0],_0x26b60d[_0x223d05]['rack']=_0x5d65bc[0x1],_0x26b60d[_0x223d05][_0x467aed(0x214)]=0x0,_0x26b60d[_0x223d05][_0x467aed(0x196)]=0x0,_0x26b60d[_0x223d05][_0x467aed(0x243)]='Floor',_0x26b60d[_0x223d05][_0x467aed(0x1f3)]=_0x5d65bc[0x5];}else{if(_0x223d05==_0x3ebf09){if(_0x5d65bc[0x0]=='A'&&_0x5d65bc[0x1]=='L'&&_0x5d65bc[0x2]=='L')console[_0x467aed(0x24e)](_0x42e35c+'\x20<>\x20'+_0x223d05+_0x467aed(0x1aa)+_0x3ebf09+_0x467aed(0x1aa)+_0x5d65bc+_0x467aed(0x1ef)),_0x26b60d[_0x223d05][_0x467aed(0x1a4)]=_0x5d65bc[0x0],_0x26b60d[_0x223d05]['rack']=_0x5d65bc[0x1],_0x26b60d[_0x223d05][_0x467aed(0x214)]=0x0,_0x26b60d[_0x223d05][_0x467aed(0x196)]=0x0,_0x26b60d[_0x223d05][_0x467aed(0x243)]=_0x467aed(0x229),_0x26b60d[_0x223d05][_0x467aed(0x1f3)]=_0x5d65bc[0x3];else{var _0x3afc96;if(_0x5d65bc[0x4]=='L')_0x3afc96='Level';else _0x5d65bc[0x4]=='F'&&(_0x3afc96='Floor');_0x26b60d[_0x223d05][_0x467aed(0x1a4)]=_0x5d65bc[0x0],_0x26b60d[_0x223d05][_0x467aed(0x22e)]=_0x5d65bc[0x1],_0x26b60d[_0x223d05]['to_bay']=_0x5d65bc[0x2],_0x26b60d[_0x223d05]['to_bin']=_0x5d65bc[0x3],_0x26b60d[_0x223d05][_0x467aed(0x243)]=_0x3afc96,_0x26b60d[_0x223d05][_0x467aed(0x1f3)]=_0x5d65bc[0x5];}}}}});}),_0x12a8d1['forEach']((_0x50fb10,_0x19f280)=>{var _0x45acce=_0x2fdbbe;_0x26b60d[_0x19f280][_0x45acce(0x21d)]=_0x50fb10;}),_0x17aa0d[_0x2fdbbe(0x1d1)]((_0x2bb226,_0x49ca9b)=>{var _0x5d67a3=_0x2fdbbe;_0x26b60d[_0x49ca9b][_0x5d67a3(0x275)]=_0x2bb226;}),_0x5efeae[_0x2fdbbe(0x1d1)]((_0x1bdbcf,_0x24e14a)=>{_0x26b60d[_0x24e14a]['product_code']=_0x1bdbcf;}),_0x5b344d[_0x2fdbbe(0x1d1)]((_0x14acba,_0x56f414)=>{var _0x4d9130=_0x2fdbbe;_0x26b60d[_0x56f414][_0x4d9130(0x19b)]=_0x14acba;}),_0x37b41e[_0x2fdbbe(0x1d1)]((_0x391037,_0x9ee7a4)=>{var _0xc9eda2=_0x2fdbbe;_0x26b60d[_0x9ee7a4][_0xc9eda2(0x190)]=_0x391037;}),_0x298f31[_0x2fdbbe(0x1d1)]((_0x4f28df,_0x3016bb)=>{_0x26b60d[_0x3016bb]['secondary_unit']=_0x4f28df;}),_0x375f3a[_0x2fdbbe(0x1d1)]((_0x541269,_0xa5aa4f)=>{_0x26b60d[_0xa5aa4f]['batch_code']=_0x541269;}),_0x3c00ae[_0x2fdbbe(0x1d1)]((_0x2d1bb0,_0x464897)=>{var _0x2454cc=_0x2fdbbe;_0x26b60d[_0x464897][_0x2454cc(0x199)]=_0x2d1bb0;}),_0x1adaef['forEach']((_0x5583eb,_0x2df93c)=>{var _0x447936=_0x2fdbbe;_0x26b60d[_0x2df93c][_0x447936(0x1d0)]=_0x5583eb;}),_0x11fc92[_0x2fdbbe(0x1d1)]((_0x2fff32,_0xa648a8)=>{_0x26b60d[_0xa648a8]['production_date']=_0x2fff32;}),_0x1edf2a[_0x2fdbbe(0x1d1)]((_0x41543e,_0x3d62ed)=>{var _0x1b12c1=_0x2fdbbe;_0x26b60d[_0x3d62ed][_0x1b12c1(0x225)]=_0x41543e;}),_0xe40342[_0x2fdbbe(0x1d1)]((_0x37f159,_0x308447)=>{var _0x1c4460=_0x2fdbbe;_0x26b60d[_0x308447][_0x1c4460(0x217)]=_0x37f159;}),_0x56c711[_0x2fdbbe(0x1d1)]((_0x3744a0,_0x17c20a)=>{_0x26b60d[_0x17c20a]['to_room_name']=_0x3744a0;});const _0x1b1bd9=_0x26b60d[_0x2fdbbe(0x192)](_0x1e1762=>_0x1e1762['to_quantity']!=='0'&&_0x1e1762[_0x2fdbbe(0x1c6)]!==''||_0x1e1762['to_floorlevel']!=='0'&&_0x1e1762[_0x2fdbbe(0x1f3)]!==''),_0x13c6c8=new transfers({'date':_0x5caab8,'from_warehouse':_0x11ab04,'to_warehouse':_0x34118e,'product':_0x1b1bd9,'note':_0x2202a2,'invoice':_0x43cb5e}),_0x5ed089=await _0x13c6c8[_0x2fdbbe(0x1b5)]();_0x776933[_0x2fdbbe(0x1cf)]('success',_0x2fdbbe(0x1fe)),_0x5e63ec['redirect'](_0x2fdbbe(0x238)+_0x5ed089['_id']);}catch(_0x50b19b){console['log'](_0x50b19b),_0x5e63ec[_0x2fdbbe(0x216)](0xc8)['json']({'errorMessage':_0x50b19b[_0x2fdbbe(0x237)]});}}),router[a0_0x170297(0x260)]('/preview/:id',auth,async(_0xc9eb9d,_0xbde2bf)=>{var _0x18a1a3=a0_0x170297;try{const {username:_0xcd710f,email:_0x292da6,role:_0x59e177}=_0xc9eb9d[_0x18a1a3(0x21c)],_0x286694=_0xc9eb9d[_0x18a1a3(0x21c)],_0x20dbce=await profile[_0x18a1a3(0x263)]({'email':_0x286694[_0x18a1a3(0x185)]}),_0x2273a8=await master_shop[_0x18a1a3(0x19c)]();console[_0x18a1a3(0x24e)](_0x18a1a3(0x22a),_0x2273a8);const _0x1e28c3=await transfers[_0x18a1a3(0x20e)](_0xc9eb9d[_0x18a1a3(0x1b6)]['id']);let _0x5f27b1=new Date(_0x1e28c3[_0x18a1a3(0x199)]),_0x5b6074=('0'+_0x5f27b1[_0x18a1a3(0x233)]())[_0x18a1a3(0x23a)](-0x2),_0x397d0c=('0'+(_0x5f27b1[_0x18a1a3(0x257)]()+0x1))[_0x18a1a3(0x23a)](-0x2),_0x430178=_0x5f27b1[_0x18a1a3(0x265)](),_0x2c46e9=_0x430178+'-'+_0x397d0c+'-'+_0x5b6074,_0x4acacb;if(_0x286694[_0x18a1a3(0x277)]==_0x18a1a3(0x1db)){const _0x306f7a=await staff[_0x18a1a3(0x263)]({'email':_0x286694[_0x18a1a3(0x185)]});_0x4acacb=await warehouse[_0x18a1a3(0x19c)]({'status':_0x18a1a3(0x1c8),'name':_0x306f7a[_0x18a1a3(0x273)],'warehouse_category':_0x18a1a3(0x193)});}else _0x4acacb=await warehouse[_0x18a1a3(0x19c)]({'status':_0x18a1a3(0x1c8),'warehouse_category':_0x18a1a3(0x193)});const _0x45509b=await warehouse[_0x18a1a3(0x220)]([{'$match':{'name':_0x1e28c3[_0x18a1a3(0x1ad)]}},{'$unwind':_0x18a1a3(0x25d)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x18a1a3(0x21a)},'bay':{'$first':_0x18a1a3(0x269)},'bin':{'$first':_0x18a1a3(0x18d)},'type':{'$first':_0x18a1a3(0x194)},'floorlevel':{'$first':_0x18a1a3(0x249)},'primary_code':{'$first':_0x18a1a3(0x1a9)},'secondary_code':{'$first':_0x18a1a3(0x22f)},'product_code':{'$first':_0x18a1a3(0x1d7)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x18a1a3(0x1e7)},'expiry_date':{'$first':_0x18a1a3(0x1fa)},'production_date':{'$first':_0x18a1a3(0x1f8)},'room':{'$first':_0x18a1a3(0x198)}}}]);if(_0x2273a8[0x0][_0x18a1a3(0x276)]==_0x18a1a3(0x1fb)){var _0x166c4b=users[_0x18a1a3(0x1cd)];console['log'](_0x166c4b);}else{if(_0x2273a8[0x0][_0x18a1a3(0x276)]==_0x18a1a3(0x261))var _0x166c4b=users['Hindi'];else{if(_0x2273a8[0x0]['language']==_0x18a1a3(0x1a5))var _0x166c4b=users[_0x18a1a3(0x1a5)];else{if(_0x2273a8[0x0][_0x18a1a3(0x276)]=='Spanish')var _0x166c4b=users[_0x18a1a3(0x239)];else{if(_0x2273a8[0x0][_0x18a1a3(0x276)]==_0x18a1a3(0x242))var _0x166c4b=users[_0x18a1a3(0x242)];else{if(_0x2273a8[0x0][_0x18a1a3(0x276)]=='Portuguese\x20(BR)')var _0x166c4b=users[_0x18a1a3(0x1ae)];else{if(_0x2273a8[0x0][_0x18a1a3(0x276)]==_0x18a1a3(0x246))var _0x166c4b=users['Chinese'];else{if(_0x2273a8[0x0][_0x18a1a3(0x276)]==_0x18a1a3(0x21b))var _0x166c4b=users[_0x18a1a3(0x1f2)];}}}}}}}_0xbde2bf['render'](_0x18a1a3(0x24c),{'success':_0xc9eb9d['flash'](_0x18a1a3(0x1f1)),'errors':_0xc9eb9d[_0x18a1a3(0x1cf)](_0x18a1a3(0x1df)),'role':_0x286694,'profile':_0x20dbce,'master_shop':_0x2273a8,'warehouse':_0x4acacb,'transfer':_0x1e28c3,'stock':_0x45509b,'language':_0x166c4b});}catch(_0x100f98){console[_0x18a1a3(0x24e)](_0x100f98);}}),router['post'](a0_0x170297(0x23e),auth,async(_0x240fc2,_0x3f90e4)=>{var _0x55bf4d=a0_0x170297;try{const _0x493b96=_0x240fc2[_0x55bf4d(0x1b6)]['id'],{from_warehouse:_0x91d85d,FromRoom_name:_0x49b444,to_warehouse:_0x35e781,ToRoom_name:_0x3c7578}=_0x240fc2[_0x55bf4d(0x1d9)],_0x158103=await transfers[_0x55bf4d(0x20e)]({'_id':_0x493b96}),_0x335fc2=_0x158103[_0x55bf4d(0x18c)][_0x55bf4d(0x1ca)](async _0x16b297=>{var _0x261663=_0x55bf4d;if(_0x16b297['to_quantity']>0x0){var _0x47a9eb=await warehouse['findOne']({'name':_0x158103[_0x261663(0x1ad)],'room':_0x16b297[_0x261663(0x217)],'warehouse_category':_0x261663(0x193)});const _0x3f8c12=_0x47a9eb[_0x261663(0x1ce)][_0x261663(0x1ca)](_0xd253f7=>{var _0x33aa61=_0x261663;_0xd253f7['product_name']==_0x16b297[_0x33aa61(0x22d)]&&_0xd253f7[_0x33aa61(0x1f0)]==_0x16b297[_0x33aa61(0x244)]&&_0xd253f7[_0x33aa61(0x1af)]==_0x16b297[_0x33aa61(0x226)]&&_0xd253f7[_0x33aa61(0x1c2)]==_0x16b297[_0x33aa61(0x19f)]&&_0xd253f7[_0x33aa61(0x234)]==_0x16b297[_0x33aa61(0x1ff)]&&_0xd253f7['rack']==_0x16b297[_0x33aa61(0x1fc)]&&_0xd253f7[_0x33aa61(0x1a4)]==_0x16b297['from_storage']&&_0xd253f7[_0x33aa61(0x199)]==_0x16b297[_0x33aa61(0x199)]&&_0xd253f7[_0x33aa61(0x24b)]==_0x16b297[_0x33aa61(0x24b)]&&_0xd253f7[_0x33aa61(0x241)]==_0x16b297[_0x33aa61(0x241)]&&_0xd253f7[_0x33aa61(0x211)]==_0x16b297[_0x33aa61(0x274)]&&_0xd253f7[_0x33aa61(0x23c)]==_0x16b297[_0x33aa61(0x197)]&&(_0xd253f7[_0x33aa61(0x1c5)]=_0xd253f7[_0x33aa61(0x1c5)]-_0x16b297[_0x33aa61(0x1c6)]);});}return _0x47a9eb;});Promise['all'](_0x335fc2)['then'](async _0x2d55da=>{var _0x4e9a14=_0x55bf4d;try{for(const _0x397f92 of _0x2d55da){await _0x397f92[_0x4e9a14(0x1b5)]();}try{const _0x1ad4c6=_0x158103[_0x4e9a14(0x18c)][_0x4e9a14(0x1ca)](async _0x4076d8=>{var _0x4a8071=_0x4e9a14;if(_0x4076d8['to_quantity']>0x0){var _0x2d395e=await warehouse[_0x4a8071(0x263)]({'name':_0x158103[_0x4a8071(0x18e)],'room':_0x4076d8[_0x4a8071(0x219)],'warehouse_category':_0x4a8071(0x193)}),_0x3adc7b=0x0;const _0x414900=_0x2d395e[_0x4a8071(0x1ce)]['map'](_0x94138b=>{var _0x53ee72=_0x4a8071;_0x94138b[_0x53ee72(0x22d)]==_0x4076d8['product_name']&&_0x94138b[_0x53ee72(0x1f0)]==_0x4076d8[_0x53ee72(0x1f3)]&&_0x94138b[_0x53ee72(0x1af)]==_0x4076d8['to_types']&&_0x94138b[_0x53ee72(0x1c2)]==_0x4076d8[_0x53ee72(0x196)]&&_0x94138b['bay']==_0x4076d8[_0x53ee72(0x214)]&&_0x94138b[_0x53ee72(0x22e)]==_0x4076d8[_0x53ee72(0x22e)]&&_0x94138b[_0x53ee72(0x1a4)]==_0x4076d8['storage']&&_0x94138b[_0x53ee72(0x199)]==_0x4076d8[_0x53ee72(0x199)]&&_0x94138b[_0x53ee72(0x24b)]==_0x4076d8[_0x53ee72(0x24b)]&&_0x94138b[_0x53ee72(0x241)]==_0x4076d8[_0x53ee72(0x241)]&&_0x94138b[_0x53ee72(0x211)]==_0x4076d8[_0x53ee72(0x1ea)]&&(_0x94138b[_0x53ee72(0x1c5)]=_0x94138b[_0x53ee72(0x1c5)]+_0x4076d8[_0x53ee72(0x1c6)],_0x3adc7b++);});_0x3adc7b=='0'&&(_0x2d395e[_0x4a8071(0x1ce)]=_0x2d395e[_0x4a8071(0x1ce)][_0x4a8071(0x264)]({'product_name':_0x4076d8[_0x4a8071(0x22d)],'product_stock':_0x4076d8['to_quantity'],'bay':_0x4076d8[_0x4a8071(0x214)],'bin':_0x4076d8[_0x4a8071(0x196)],'type':_0x4076d8[_0x4a8071(0x243)],'floorlevel':_0x4076d8[_0x4a8071(0x1f3)],'storage':_0x4076d8[_0x4a8071(0x1a4)],'rack':_0x4076d8[_0x4a8071(0x22e)],'product_code':_0x4076d8[_0x4a8071(0x1a7)],'primary_code':_0x4076d8[_0x4a8071(0x21d)],'secondary_code':_0x4076d8['secondary_code'],'maxProducts':_0x4076d8[_0x4a8071(0x19b)],'storage':_0x4076d8[_0x4a8071(0x1a4)],'rack':_0x4076d8[_0x4a8071(0x22e)],'expiry_date':_0x4076d8['expiry_date'],'maxPerUnit':_0x4076d8[_0x4a8071(0x1d0)],'batch_code':_0x4076d8[_0x4a8071(0x24b)],'production_date':_0x4076d8[_0x4a8071(0x241)]}));}return _0x2d395e;});Promise['all'](_0x1ad4c6)[_0x4e9a14(0x232)](async _0x48f305=>{var _0x5663c2=_0x4e9a14;try{for(const _0x36b85d of _0x48f305){await warehouse[_0x5663c2(0x1d8)]({'_id':_0x36b85d[_0x5663c2(0x23c)]},{'$addToSet':{'product_details':{'$each':_0x36b85d[_0x5663c2(0x1ce)]}}});}_0x158103[_0x5663c2(0x266)]='True';const _0x5db6cb=await _0x158103[_0x5663c2(0x1b5)](),_0x40ac23=await master_shop[_0x5663c2(0x19c)](),_0x1ec71d=await email_settings[_0x5663c2(0x263)](),_0x1c7127=await supervisor_settings[_0x5663c2(0x19c)]();var _0xa1c972=_0x158103[_0x5663c2(0x18c)],_0x54d8f7='',_0x49145f;for(_0x49145f in _0xa1c972){_0x54d8f7+='<tr>'+_0x5663c2(0x1e3)+_0xa1c972[_0x49145f][_0x5663c2(0x22d)]+_0x5663c2(0x256)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xa1c972[_0x49145f][_0x5663c2(0x1a7)]+_0x5663c2(0x256)+_0x5663c2(0x1e3)+_0xa1c972[_0x49145f]['to_quantity']+_0x5663c2(0x256)+_0x5663c2(0x1e3)+_0xa1c972[_0x49145f][_0x5663c2(0x190)]+_0x5663c2(0x256)+_0x5663c2(0x1e3)+_0xa1c972[_0x49145f]['secondary_unit']+_0x5663c2(0x256)+_0x5663c2(0x1e3)+_0x158103[_0x5663c2(0x18e)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xa1c972[_0x49145f][_0x5663c2(0x219)]+_0x5663c2(0x256)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xa1c972[_0x49145f]['storage']+_0xa1c972[_0x49145f][_0x5663c2(0x22e)]+_0xa1c972[_0x49145f][_0x5663c2(0x214)]+_0xa1c972[_0x49145f][_0x5663c2(0x196)]+_0xa1c972[_0x49145f][_0x5663c2(0x243)][0x0]+_0xa1c972[_0x49145f][_0x5663c2(0x1f3)]+_0x5663c2(0x256),_0x5663c2(0x26e);}let _0x47efe5=nodemailer[_0x5663c2(0x230)]({'host':_0x1ec71d[_0x5663c2(0x208)],'port':Number(_0x1ec71d[_0x5663c2(0x221)]),'secure':![],'auth':{'user':_0x1ec71d[_0x5663c2(0x185)],'pass':_0x1ec71d['password']}}),_0x4d122e={'from':_0x1ec71d[_0x5663c2(0x185)],'to':_0x1c7127[0x0][_0x5663c2(0x24d)],'subject':_0x5663c2(0x26b),'attachments':[{'filename':_0x5663c2(0x1bf),'path':__dirname+_0x5663c2(0x23d)+'/upload/'+_0x40ac23[0x0][_0x5663c2(0x223)],'cid':_0x5663c2(0x1ec)}],'html':_0x5663c2(0x251)+_0x5663c2(0x1b2)+_0x5663c2(0x207)+'<div>'+_0x5663c2(0x252)+_0x5663c2(0x222)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x5663c2(0x222)+_0x5663c2(0x24a)+_0x40ac23[0x0][_0x5663c2(0x218)]+_0x5663c2(0x215)+_0x5663c2(0x19e)+_0x5663c2(0x19e)+_0x5663c2(0x1a0)+'<div>'+_0x5663c2(0x23f)+_0x5663c2(0x1bc)+_0x158103[_0x5663c2(0x211)]+'\x20'+_0x5663c2(0x1c0)+'\x20Order\x20Date\x20:\x20'+_0x158103[_0x5663c2(0x205)]+'\x20'+_0x5663c2(0x20a)+'</h5>'+'</div>'+_0x5663c2(0x189)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x5663c2(0x1f7)+_0x5663c2(0x1c7)+_0x5663c2(0x200)+_0x5663c2(0x231)+_0x5663c2(0x18a)+_0x5663c2(0x1da)+_0x5663c2(0x270)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x5663c2(0x26e)+_0x5663c2(0x212)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x54d8f7+'\x20'+_0x5663c2(0x19a)+_0x5663c2(0x268)+'<div>'+_0x5663c2(0x25e)+_0x5663c2(0x203)+_0x40ac23[0x0]['site_title']+_0x5663c2(0x235)+'</div>'+_0x5663c2(0x19e)+'</body></html>'};_0x47efe5['sendMail'](_0x4d122e,function(_0x4c4514,_0x38c8d1){var _0x1636ed=_0x5663c2;_0x4c4514?(console[_0x1636ed(0x24e)](_0x4c4514),console['log'](_0x1636ed(0x25c))):console[_0x1636ed(0x24e)]('Email\x20sent\x20successfully');}),_0x240fc2['flash'](_0x5663c2(0x1f1),'Transfer\x20Finalize\x20Successfully'),_0x3f90e4[_0x5663c2(0x22c)](_0x5663c2(0x255)+_0x5db6cb['_id']);}catch(_0x272b36){console[_0x5663c2(0x1d4)](_0x272b36),_0x3f90e4[_0x5663c2(0x216)](0x1f4)['json']({'Perror':_0x5663c2(0x259),'message':_0x272b36[_0x5663c2(0x237)]});}})[_0x4e9a14(0x1ed)](_0x494c0e=>{var _0x590566=_0x4e9a14;console[_0x590566(0x1d4)](_0x494c0e),_0x3f90e4[_0x590566(0x216)](0x1f4)[_0x590566(0x1ba)]({'Perror':_0x590566(0x1e4)});});}catch(_0x4c311d){_0x3f90e4['json'](_0x4c311d);}}catch(_0x141815){console[_0x4e9a14(0x1d4)](_0x141815),_0x3f90e4[_0x4e9a14(0x216)](0x1f4)[_0x4e9a14(0x1ba)]({'Merror':_0x4e9a14(0x259),'Message':_0x141815['message']});}})['catch'](_0xe9a03a=>{var _0x51c739=_0x55bf4d;console[_0x51c739(0x1d4)](_0xe9a03a),_0x3f90e4[_0x51c739(0x216)](0x1f4)[_0x51c739(0x1ba)]({'Merror':_0x51c739(0x1e4)});});}catch(_0xc28f5c){console[_0x55bf4d(0x24e)](_0xc28f5c);}});function BayBinSelected(_0x1fe742,_0x18dc10){var _0x51113e=a0_0x170297,_0x5f447=[],_0x14b5ce=[],_0x39185a=[],_0x5c36a8=[],_0x54bafa=[],_0x5b75db=[];let _0x17d66d=[];if(_0x1fe742==_0x51113e(0x24f))switch(_0x18dc10){case _0x51113e(0x1f9):_0x5f447=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x14b5ce=[0x1,0x2],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=[_0x51113e(0x267),_0x51113e(0x229)],_0x54bafa=['D'],_0x5b75db=['A'];break;case'Rack\x20B':_0x5f447=[0x6,0x5,0x4,0x3,0x2,0x1],_0x14b5ce=[0x1,0x2],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=['Level',_0x51113e(0x229)],_0x54bafa=['D'],_0x5b75db=['B'];break;case _0x51113e(0x1e9):_0x5f447=[0x0],_0x14b5ce=[0x0],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=[_0x51113e(0x229)],_0x54bafa=['D'],_0x5b75db=['S'];break;case _0x51113e(0x1b3):_0x5f447=[0x0],_0x14b5ce=[0x0],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x39185a=[_0x51113e(0x229)],_0x54bafa=['D'],_0x5b75db=['R'];break;}else{if(_0x1fe742=='COLD\x20STORAGE')switch(_0x18dc10){case _0x51113e(0x1f9):_0x5f447=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x14b5ce=['B','F'],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=[_0x51113e(0x267),_0x51113e(0x229)],_0x54bafa=['C'],_0x5b75db=['A'];break;case _0x51113e(0x262):_0x5f447=[0x5,0x4,0x3,0x2,0x1],_0x14b5ce=['F','B','S'],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=[_0x51113e(0x267),_0x51113e(0x229)],_0x54bafa=['C'],_0x5b75db=['B'];break;case'Rack\x20C':_0x5f447=[0x1,0x2,0x3,0x4,0x5],_0x14b5ce=['B','F','S'],_0x5c36a8=[0x5,0x4,0x3,0x2,0x1],_0x39185a=[_0x51113e(0x267),_0x51113e(0x229)],_0x54bafa=['C'],_0x5b75db=['C'];break;case'Rack\x20D':_0x5f447=[0x5,0x4,0x3,0x2,0x1],_0x14b5ce=['F','B','S'],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=[_0x51113e(0x267),_0x51113e(0x229)],_0x54bafa=['C'],_0x5b75db=['D'];break;case _0x51113e(0x213):_0x5f447=[0x4,0x3,0x2,0x1],_0x14b5ce=[0x1,0x2],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=[_0x51113e(0x267),_0x51113e(0x229)],_0x54bafa=['C'],_0x5b75db=['E'];break;case _0x51113e(0x1f6):_0x5f447=[0x1,0x2,0x3],_0x14b5ce=[0x1,0x2],_0x5c36a8=[0x1,0x2,0x3,0x4,0x5],_0x39185a=[_0x51113e(0x267)],_0x54bafa=['C'],_0x5b75db=['F'];break;}}return{'levels':_0x5f447,'Isle':_0x14b5ce,'rack':_0x5c36a8,'type':_0x39185a,'storage':_0x54bafa,'rak':_0x5b75db};}router['get'](a0_0x170297(0x26c),auth,async(_0x5850b0,_0x31fd25)=>{var _0x3e646e=a0_0x170297;try{const {username:_0x19b852,email:_0x302e32,role:_0x66a0a4}=_0x5850b0['user'],_0x497216=_0x5850b0[_0x3e646e(0x21c)],_0x58c0ab=await profile[_0x3e646e(0x263)]({'email':_0x497216[_0x3e646e(0x185)]}),_0x5a5b14=await master_shop[_0x3e646e(0x19c)](),_0x1d95be=await transfers[_0x3e646e(0x20e)](_0x5850b0['params']['id']);let _0x3b9c9a;if(_0x497216[_0x3e646e(0x277)]==_0x3e646e(0x1db)){const _0x1bedeb=await staff[_0x3e646e(0x263)]({'email':_0x497216['email']});_0x3b9c9a=await warehouse[_0x3e646e(0x220)]([{'$match':{'status':_0x3e646e(0x1c8),'name':_0x1bedeb[_0x3e646e(0x273)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x3b9c9a=await warehouse[_0x3e646e(0x220)]([{'$match':{'status':'Enabled','warehouse_category':_0x3e646e(0x193)}},{'$group':{'_id':_0x3e646e(0x1e2),'name':{'$first':_0x3e646e(0x1e2)}}}]);const _0x263c78=await warehouse[_0x3e646e(0x220)]([{'$match':{'name':_0x1d95be[_0x3e646e(0x1ad)],'warehouse_category':_0x3e646e(0x193)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3e646e(0x253),'name':{'$first':_0x3e646e(0x1bd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3e646e(0x269)},'bin':{'$first':_0x3e646e(0x18d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3e646e(0x249)},'primary_code':{'$first':_0x3e646e(0x1a9)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3e646e(0x1d7)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3e646e(0x1e7)},'expiry_date':{'$first':_0x3e646e(0x1fa)},'production_date':{'$first':_0x3e646e(0x1f8)},'room':{'$first':_0x3e646e(0x198)}}}]),_0x16f99b=await product[_0x3e646e(0x19c)]({}),_0x54c522=BayBinSelected(_0x1d95be[_0x3e646e(0x18e)],_0x1d95be[_0x3e646e(0x1fd)]);if(_0x5a5b14[0x0][_0x3e646e(0x276)]=='English\x20(US)'){var _0x101959=users[_0x3e646e(0x1cd)];console[_0x3e646e(0x24e)](_0x101959);}else{if(_0x5a5b14[0x0][_0x3e646e(0x276)]==_0x3e646e(0x261))var _0x101959=users['Hindi'];else{if(_0x5a5b14[0x0]['language']==_0x3e646e(0x1a5))var _0x101959=users[_0x3e646e(0x1a5)];else{if(_0x5a5b14[0x0][_0x3e646e(0x276)]==_0x3e646e(0x239))var _0x101959=users['Spanish'];else{if(_0x5a5b14[0x0][_0x3e646e(0x276)]==_0x3e646e(0x242))var _0x101959=users[_0x3e646e(0x242)];else{if(_0x5a5b14[0x0][_0x3e646e(0x276)]==_0x3e646e(0x254))var _0x101959=users[_0x3e646e(0x1ae)];else{if(_0x5a5b14[0x0]['language']==_0x3e646e(0x246))var _0x101959=users[_0x3e646e(0x246)];else{if(_0x5a5b14[0x0][_0x3e646e(0x276)]==_0x3e646e(0x21b))var _0x101959=users[_0x3e646e(0x1f2)];}}}}}}}_0x31fd25[_0x3e646e(0x184)]('edit_transfer',{'success':_0x5850b0[_0x3e646e(0x1cf)](_0x3e646e(0x1f1)),'errors':_0x5850b0['flash']('errors'),'role':_0x497216,'profile':_0x58c0ab,'master_shop':_0x5a5b14,'warehouse':_0x3b9c9a,'transfer':_0x1d95be,'stock':_0x263c78,'unit':_0x16f99b,'language':_0x101959});}catch(_0x1d082b){console['log'](_0x1d082b);}}),router[a0_0x170297(0x210)]('/view/:id',auth,async(_0x73b670,_0x427e17)=>{var _0x17177f=a0_0x170297;try{const _0x179903=_0x73b670[_0x17177f(0x1b6)]['id'],_0x5a7c8d=await transfers[_0x17177f(0x20e)](_0x179903);_0x427e17['json'](_0x73b670['body']);return;const {date:_0x5a7046,from_warehouse:_0xf36a92,FromRoom_name:_0x224d16,to_warehouse:_0x5a3aad,ToRoom_name:_0x210014,prod_name:_0x5343a5,from_prod_qty:_0x4e748b,from_prod_level:_0x2bc7d7,from_prod_isle:_0x4efbde,from_prod_pallet:_0x6c0cd3,to_prod_qty:_0x57ab58,to_prod_level:_0x32db27,to_prod_isle:_0x55fcac,to_prod_pallet:_0x191deb,primary_code:_0x52f3d8,secondary_code:_0x2a0072,product_code3:_0x26ef04,note:_0x15b9d0,invoice:_0x5a307f,expiry_date:_0x4357be}=_0x73b670[_0x17177f(0x1d9)];if(typeof _0x5343a5==_0x17177f(0x26d))var _0x214c87=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1dc)]],_0x3901d0=[_0x73b670['body'][_0x17177f(0x18f)]],_0xcf6752=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x278)]],_0x3e9f1b=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1b1)]],_0x2a4a2a=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1cb)]],_0x59a1fe=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x226)]],_0xd56cdb=[_0x73b670[_0x17177f(0x1d9)]['to_prod_qty']],_0x595854=[_0x73b670[_0x17177f(0x1d9)]['to_prod_level']],_0x19c26d=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x245)]],_0x3f5996=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1c9)]],_0x1977e6=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x243)]],_0x5452a6=[_0x73b670[_0x17177f(0x1d9)]['storage']],_0x5a4d5e=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1d2)]],_0x15f742=[_0x73b670['body'][_0x17177f(0x21d)]],_0x4cb3ed=[_0x73b670[_0x17177f(0x1d9)]['secondary_code']],_0x2c7939=[_0x73b670['body'][_0x17177f(0x1f5)]],_0x3d188c=[_0x73b670['body'][_0x17177f(0x1d5)]],_0x250858=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x190)]],_0x1ca344=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1bb)]],_0x33a02d=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x24b)]],_0x3f8a42=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x199)]],_0x2efc9b=[_0x73b670['body'][_0x17177f(0x206)]],_0x3655a7=[_0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1d3)]];else var _0x214c87=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1dc)]],_0x5452a6=[..._0x73b670[_0x17177f(0x1d9)]['storage']],_0x5a4d5e=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1d2)]],_0x59a1fe=[..._0x73b670['body'][_0x17177f(0x226)]],_0x1977e6=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x243)]],_0x3901d0=[..._0x73b670['body'][_0x17177f(0x18f)]],_0xcf6752=[..._0x73b670[_0x17177f(0x1d9)]['from_prod_level']],_0x3e9f1b=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1b1)]],_0x2a4a2a=[..._0x73b670[_0x17177f(0x1d9)]['from_prod_pallet']],_0xd56cdb=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1b9)]],_0x595854=[..._0x73b670['body'][_0x17177f(0x204)]],_0x19c26d=[..._0x73b670['body']['to_prod_isle']],_0x3f5996=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1c9)]],_0x15f742=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x21d)]],_0x4cb3ed=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x275)]],_0x2c7939=[..._0x73b670['body'][_0x17177f(0x1f5)]],_0x3d188c=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1d5)]],_0x250858=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x190)]],_0x1ca344=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1bb)]],_0x33a02d=[..._0x73b670[_0x17177f(0x1d9)]['batch_code']],_0x3f8a42=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x199)]],_0x2efc9b=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x206)]],_0x3655a7=[..._0x73b670[_0x17177f(0x1d9)][_0x17177f(0x1d3)]];const _0x169c90=_0x214c87['map'](_0x520e35=>{return _0x520e35={'product_name':_0x520e35};});_0x3901d0[_0x17177f(0x1d1)]((_0x5855b4,_0x2a753a)=>{var _0x5ad133=_0x17177f;_0x169c90[_0x2a753a][_0x5ad133(0x25a)]=_0x5855b4;}),_0xcf6752[_0x17177f(0x1d1)]((_0x492386,_0x23181c)=>{var _0x555c70=_0x17177f;_0x169c90[_0x23181c][_0x555c70(0x1ff)]=_0x492386;}),_0x3e9f1b[_0x17177f(0x1d1)]((_0x5e5d1a,_0x141474)=>{_0x169c90[_0x141474]['from_bin']=_0x5e5d1a;}),_0x2a4a2a[_0x17177f(0x1d1)]((_0x792d0f,_0x467857)=>{var _0x202c20=_0x17177f;_0x169c90[_0x467857][_0x202c20(0x244)]=_0x792d0f;}),_0xd56cdb[_0x17177f(0x1d1)]((_0x3b1385,_0x3dc04a)=>{var _0x1aaa7b=_0x17177f;_0x169c90[_0x3dc04a][_0x1aaa7b(0x1c6)]=_0x3b1385;}),_0x595854[_0x17177f(0x1d1)]((_0x18844e,_0x55ffaa)=>{var _0x467017=_0x17177f;_0x169c90[_0x55ffaa][_0x467017(0x214)]=_0x18844e;}),_0x19c26d['forEach']((_0x322ac4,_0x4d9d22)=>{var _0x563796=_0x17177f;_0x169c90[_0x4d9d22][_0x563796(0x196)]=_0x322ac4;}),_0x3f5996[_0x17177f(0x1d1)]((_0x45f183,_0x1cc7a5)=>{var _0x11a5fa=_0x17177f;_0x169c90[_0x1cc7a5][_0x11a5fa(0x1f3)]=_0x45f183;}),_0x15f742[_0x17177f(0x1d1)]((_0x5bb381,_0x1790cb)=>{_0x169c90[_0x1790cb]['primary_code']=_0x5bb381;}),_0x4cb3ed[_0x17177f(0x1d1)]((_0x392863,_0x123d73)=>{_0x169c90[_0x123d73]['secondary_code']=_0x392863;}),_0x2c7939['forEach']((_0x10a290,_0x21eee5)=>{_0x169c90[_0x21eee5]['product_code']=_0x10a290;}),_0x3d188c['forEach']((_0x48a4a8,_0x255b57)=>{var _0x229621=_0x17177f;_0x169c90[_0x255b57][_0x229621(0x19b)]=_0x48a4a8;}),_0x250858[_0x17177f(0x1d1)]((_0x258f6f,_0x44fedb)=>{var _0x819e3d=_0x17177f;_0x169c90[_0x44fedb][_0x819e3d(0x190)]=_0x258f6f;}),_0x1ca344[_0x17177f(0x1d1)]((_0x30e243,_0x4daaff)=>{var _0x398a3d=_0x17177f;_0x169c90[_0x4daaff][_0x398a3d(0x1bb)]=_0x30e243;}),_0x33a02d[_0x17177f(0x1d1)]((_0x1a91df,_0x2ec164)=>{var _0x2d44ee=_0x17177f;_0x169c90[_0x2ec164][_0x2d44ee(0x24b)]=_0x1a91df;}),_0x3f8a42[_0x17177f(0x1d1)]((_0x35ab3a,_0x10afc5)=>{_0x169c90[_0x10afc5]['expiry_date']=_0x35ab3a;}),_0x5452a6[_0x17177f(0x1d1)]((_0x1c3831,_0x105c3e)=>{var _0x5d1b5c=_0x17177f;_0x169c90[_0x105c3e][_0x5d1b5c(0x1a4)]=_0x1c3831;}),_0x5a4d5e[_0x17177f(0x1d1)]((_0x1a6ce2,_0x193369)=>{var _0x2ec9b0=_0x17177f;_0x169c90[_0x193369][_0x2ec9b0(0x22e)]=_0x1a6ce2;}),_0x59a1fe[_0x17177f(0x1d1)]((_0x26e98b,_0x2a3af2)=>{var _0x254874=_0x17177f;_0x169c90[_0x2a3af2][_0x254874(0x226)]=_0x26e98b;}),_0x1977e6[_0x17177f(0x1d1)]((_0x4e611f,_0x413c93)=>{var _0x196840=_0x17177f;_0x169c90[_0x413c93][_0x196840(0x243)]=_0x4e611f;}),_0x2efc9b['forEach']((_0x2b9906,_0x3d7587)=>{var _0x52a3c2=_0x17177f;_0x169c90[_0x3d7587][_0x52a3c2(0x206)]=_0x2b9906;}),_0x3655a7[_0x17177f(0x1d1)]((_0x41f486,_0x4a3b0c)=>{var _0x559f6f=_0x17177f;_0x169c90[_0x4a3b0c][_0x559f6f(0x1fc)]=_0x41f486;});const _0x5088b6=_0x169c90[_0x17177f(0x192)](_0x4de247=>_0x4de247['to_quantity']!=='0'&&_0x4de247[_0x17177f(0x1c6)]!==''||_0x4de247[_0x17177f(0x1f3)]!=='0'&&_0x4de247[_0x17177f(0x1f3)]!=='');var _0xcc2e31=0x0;_0x5088b6[_0x17177f(0x1d1)](_0x2a6e1b=>{var _0x2e233d=_0x17177f;parseInt(_0x2a6e1b[_0x2e233d(0x25a)])<parseInt(_0x2a6e1b[_0x2e233d(0x1c6)])&&_0xcc2e31++;});if(_0xcc2e31!=0x0)return _0x73b670['flash'](_0x17177f(0x1df),_0x17177f(0x186)),_0x427e17[_0x17177f(0x22c)](_0x17177f(0x20b));const _0x13bb06=await warehouse[_0x17177f(0x263)]({'name':_0x5a7c8d[_0x17177f(0x1ad)],'room':_0x5a7c8d['from_room']});_0x5a7c8d[_0x17177f(0x18c)]['forEach'](_0x3c1f9=>{var _0x131105=_0x17177f;if(_0x3c1f9[_0x131105(0x1c6)]>0x0){const _0x4a1102=_0x13bb06['product_details']['map'](_0x155b7b=>{var _0x296d30=_0x131105;_0x155b7b[_0x296d30(0x22d)]==_0x3c1f9['product_name']&&_0x155b7b['floorlevel']==_0x3c1f9[_0x296d30(0x244)]&&_0x155b7b[_0x296d30(0x1af)]==_0x3c1f9[_0x296d30(0x226)]&&_0x155b7b['bin']==_0x3c1f9[_0x296d30(0x19f)]&&_0x155b7b[_0x296d30(0x234)]==_0x3c1f9['from_bay']&&_0x155b7b[_0x296d30(0x22e)]==_0x3c1f9['from_rack']&&_0x155b7b['storage']==_0x3c1f9[_0x296d30(0x206)]&&(_0x155b7b[_0x296d30(0x1c5)]=parseInt(_0x155b7b[_0x296d30(0x1c5)])+parseInt(_0x3c1f9['to_quantity']));});}}),await _0x13bb06[_0x17177f(0x1b5)]();const _0x8a5252=await warehouse[_0x17177f(0x263)]({'name':_0x5a7c8d['to_warehouse'],'room':_0x5a7c8d[_0x17177f(0x1fd)]});_0x5a7c8d['product'][_0x17177f(0x1d1)](_0x44228a=>{var _0x93d123=_0x17177f;if(_0x44228a[_0x93d123(0x1c6)]>0x0){const _0x5eb1b3=_0x8a5252['product_details'][_0x93d123(0x1ca)](_0x49093d=>{var _0x163e93=_0x93d123;_0x49093d[_0x163e93(0x22d)]==_0x44228a[_0x163e93(0x22d)]&&_0x49093d[_0x163e93(0x1f0)]==_0x44228a[_0x163e93(0x1f3)]&&_0x49093d[_0x163e93(0x1af)]==_0x44228a[_0x163e93(0x243)]&&_0x49093d[_0x163e93(0x1c2)]==_0x44228a[_0x163e93(0x196)]&&_0x49093d[_0x163e93(0x234)]==_0x44228a[_0x163e93(0x214)]&&_0x49093d['rack']==_0x44228a[_0x163e93(0x22e)]&&_0x49093d[_0x163e93(0x1a4)]==_0x44228a[_0x163e93(0x1a4)]&&(_0x49093d[_0x163e93(0x1c5)]=parseInt(_0x49093d[_0x163e93(0x1c5)])-parseInt(_0x44228a[_0x163e93(0x1c6)]));});}}),await _0x8a5252[_0x17177f(0x1b5)](),_0x5a7c8d[_0x17177f(0x205)]=_0x5a7046,_0x5a7c8d['from_warehouse']=_0xf36a92,_0x5a7c8d[_0x17177f(0x18e)]=_0x5a3aad,_0x5a7c8d['product']=_0x5088b6,_0x5a7c8d[_0x17177f(0x20d)]=_0x15b9d0,_0x5a7c8d['invoice']=_0x5a307f;const _0x2fdc35=await _0x5a7c8d[_0x17177f(0x1b5)]();console[_0x17177f(0x24e)](_0x2fdc35);const _0x334d56=await warehouse['findOne']({'name':_0xf36a92,'room':_0x224d16});_0x2fdc35['product'][_0x17177f(0x1d1)](_0x191beb=>{var _0x561ef8=_0x17177f;if(_0x191beb['to_quantity']>0x0){const _0x11f6d8=_0x334d56[_0x561ef8(0x1ce)][_0x561ef8(0x1ca)](_0x51acc1=>{var _0xc5942b=_0x561ef8;_0x51acc1[_0xc5942b(0x22d)]==_0x191beb[_0xc5942b(0x22d)]&&_0x51acc1[_0xc5942b(0x1f0)]==_0x191beb[_0xc5942b(0x244)]&&_0x51acc1[_0xc5942b(0x1af)]==_0x191beb['from_types']&&_0x51acc1['bin']==_0x191beb[_0xc5942b(0x19f)]&&_0x51acc1[_0xc5942b(0x234)]==_0x191beb['from_bay']&&_0x51acc1['rack']==_0x191beb['from_rack']&&_0x51acc1[_0xc5942b(0x1a4)]==_0x191beb[_0xc5942b(0x206)]&&(_0x51acc1[_0xc5942b(0x1c5)]=parseInt(_0x51acc1[_0xc5942b(0x1c5)])-parseInt(_0x191beb[_0xc5942b(0x1c6)]));});}}),await _0x334d56[_0x17177f(0x1b5)]();const _0x7785c3=await warehouse[_0x17177f(0x263)]({'name':_0x5a3aad,'room':_0x210014});_0x2fdc35[_0x17177f(0x18c)][_0x17177f(0x1d1)](_0x142ad9=>{var _0x33e351=_0x17177f;if(_0x142ad9[_0x33e351(0x1c6)]>0x0){var _0x1a0d8d=0x0;const _0xc10de=_0x7785c3['product_details'][_0x33e351(0x1ca)](_0x701761=>{var _0x5f45e0=_0x33e351;_0x701761[_0x5f45e0(0x22d)]==_0x142ad9[_0x5f45e0(0x22d)]&&_0x701761['floorlevel']==_0x142ad9[_0x5f45e0(0x1f3)]&&_0x701761[_0x5f45e0(0x1af)]==_0x142ad9[_0x5f45e0(0x243)]&&_0x701761[_0x5f45e0(0x1c2)]==_0x142ad9['to_bin']&&_0x701761[_0x5f45e0(0x234)]==_0x142ad9[_0x5f45e0(0x214)]&&_0x701761['rack']==_0x142ad9[_0x5f45e0(0x22e)]&&_0x701761[_0x5f45e0(0x1a4)]==_0x142ad9[_0x5f45e0(0x1a4)]&&(_0x701761['product_stock']=parseInt(_0x701761[_0x5f45e0(0x1c5)])+parseInt(_0x142ad9[_0x5f45e0(0x1c6)]),_0x1a0d8d++);});_0x1a0d8d=='0'&&(_0x7785c3[_0x33e351(0x1ce)]=_0x7785c3['product_details'][_0x33e351(0x264)]({'product_name':_0x142ad9[_0x33e351(0x22d)],'product_stock':_0x142ad9[_0x33e351(0x1c6)],'bay':_0x142ad9[_0x33e351(0x214)],'bin':_0x142ad9[_0x33e351(0x196)],'type':_0x142ad9[_0x33e351(0x243)],'floorlevel':_0x142ad9[_0x33e351(0x1f3)],'storage':_0x142ad9[_0x33e351(0x1a4)],'rack':_0x142ad9[_0x33e351(0x22e)],'product_code':_0x142ad9[_0x33e351(0x1a7)],'primary_code':_0x142ad9[_0x33e351(0x21d)],'secondary_code':_0x142ad9[_0x33e351(0x275)],'maxProducts':_0x142ad9[_0x33e351(0x19b)],'storage':_0x142ad9[_0x33e351(0x1a4)],'rack':_0x142ad9[_0x33e351(0x22e)]}));}}),await _0x7785c3['save'](),_0x73b670['flash']('success',_0x17177f(0x22b)),_0x427e17[_0x17177f(0x22c)](_0x17177f(0x1b7));}catch(_0x2b07a3){console[_0x17177f(0x24e)](_0x2b07a3);}}),router[a0_0x170297(0x210)](a0_0x170297(0x25b),async(_0x3027a3,_0x331e17)=>{var _0x1a7c32=a0_0x170297;const {FromWareHouse:_0x5f0fee,FromRoom:_0x20b648,ToWarehouse:_0x3e1010,ToRoom:_0x435675,primary_code:_0x998bf4,Roomslist:_0x18a9dc}=_0x3027a3[_0x1a7c32(0x1d9)],_0x5533b0=_0x18a9dc[_0x1a7c32(0x26a)](','),_0x4e5f86=[];async function _0x10590b(_0x1b4840){var _0x21222c=_0x1a7c32;const _0x3ddd01=await warehouse[_0x21222c(0x220)]([{'$match':{'name':_0x5f0fee,'room':_0x1b4840}},{'$unwind':_0x21222c(0x25d)},{'$match':{'product_details.primary_code':_0x998bf4}},{'$group':{'_id':_0x21222c(0x253),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x21222c(0x21a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x21222c(0x22f)},'product_code':{'$first':_0x21222c(0x1d7)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x21222c(0x249)},'unit':{'$first':_0x21222c(0x1c1)},'secondary_unit':{'$first':_0x21222c(0x21e)},'storage':{'$first':_0x21222c(0x240)},'rack':{'$first':_0x21222c(0x1e7)},'expiry_date':{'$first':_0x21222c(0x1fa)},'production_date':{'$first':_0x21222c(0x1f8)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x21222c(0x227)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x21222c(0x198)},'maxProducts':{'$first':_0x21222c(0x1d6)}}}]),_0x343801=await warehouse[_0x21222c(0x220)]([{'$match':{'name':_0x5f0fee,'room':_0x1b4840}},{'$unwind':_0x21222c(0x25d)},{'$match':{'product_details.secondary_code':_0x998bf4}},{'$group':{'_id':_0x21222c(0x253),'name':{'$first':_0x21222c(0x1bd)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x21222c(0x1a9)},'secondary_code':{'$first':_0x21222c(0x22f)},'product_code':{'$first':_0x21222c(0x1d7)},'level':{'$first':_0x21222c(0x269)},'isle':{'$first':_0x21222c(0x18d)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x21222c(0x249)},'unit':{'$first':_0x21222c(0x1c1)},'secondary_unit':{'$first':_0x21222c(0x21e)},'storage':{'$first':_0x21222c(0x240)},'rack':{'$first':_0x21222c(0x1e7)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x21222c(0x1f8)},'batch_code':{'$first':_0x21222c(0x1dd)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x21222c(0x198)},'maxProducts':{'$first':_0x21222c(0x1d6)}}}]);if(_0x3ddd01[_0x21222c(0x228)]>0x0)_0x4e5f86[_0x21222c(0x209)](_0x3ddd01);else _0x343801[_0x21222c(0x228)]>0x0&&_0x4e5f86[_0x21222c(0x209)](_0x343801);}const _0x3c2fd3=_0x5533b0[_0x1a7c32(0x1ca)](_0x1f00e8=>_0x10590b(_0x1f00e8));await Promise[_0x1a7c32(0x1e6)](_0x3c2fd3),_0x331e17['json'](_0x4e5f86);}),router['post'](a0_0x170297(0x250),async(_0x35255c,_0x476159)=>{var _0x2ed8f6=a0_0x170297;try{const {FromWareHouse:_0x10b317,FromRoom:_0x1fc75d,ToWarehouse:_0x5699df,ToRoom:_0xa65c8c,secondary_code:_0x12e8a5}=_0x35255c[_0x2ed8f6(0x1d9)],_0x1d6b23=await warehouse['aggregate']([{'$match':{'name':_0x10b317}},{'$unwind':_0x2ed8f6(0x25d)},{'$match':{'product_details.secondary_code':_0x12e8a5}},{'$group':{'_id':_0x2ed8f6(0x253),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x2ed8f6(0x1a9)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2ed8f6(0x1d7)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x2ed8f6(0x1e2)},'level':{'$first':_0x2ed8f6(0x195)},'isle':{'$first':_0x2ed8f6(0x26f)},'pallet':{'$first':_0x2ed8f6(0x20f)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x2ed8f6(0x1c1)}}}]);_0x476159['status'](0xc8)['json'](_0x1d6b23);}catch(_0x241b18){_0x476159['status'](0x194)[_0x2ed8f6(0x1ba)]({'message':_0x241b18[_0x2ed8f6(0x237)]});}}),router[a0_0x170297(0x210)](a0_0x170297(0x1cc),async(_0x16597a,_0x5bbf81)=>{var _0x1b2930=a0_0x170297;try{const {FromWareHouse:_0x5c725e,FromRoom:_0x5d2cb3,ToWarehouse:_0x10840d,ToRoom:_0x3403e8,product_code:_0xdbdaf5}=_0x16597a[_0x1b2930(0x1d9)],_0x4a304b=await warehouse[_0x1b2930(0x220)]([{'$match':{'name':_0x5c725e}},{'$unwind':_0x1b2930(0x25d)},{'$match':{'product_details.product_code':_0xdbdaf5}},{'$group':{'_id':_0x1b2930(0x253),'name':{'$first':_0x1b2930(0x1bd)},'primary_code':{'$first':_0x1b2930(0x1a9)},'secondary_code':{'$first':_0x1b2930(0x22f)},'product_code':{'$first':_0x1b2930(0x1d7)},'instock':{'$first':_0x1b2930(0x21a)},'warehouse':{'$first':_0x1b2930(0x1e2)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x1b2930(0x26f)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x1b2930(0x1d6)},'unit':{'$first':_0x1b2930(0x1c1)}}}]);_0x5bbf81[_0x1b2930(0x216)](0xc8)['json'](_0x4a304b);}catch(_0x39e8c3){_0x5bbf81[_0x1b2930(0x216)](0x194)['json']({'message':_0x39e8c3[_0x1b2930(0x237)]});}}),router[a0_0x170297(0x210)](a0_0x170297(0x1a2),async(_0x27498c,_0x401dbe)=>{var _0x346efe=a0_0x170297;const {level:_0x513df1,isle:_0x409d8b,pallet:_0x1673f1,warehouses:_0x40371b,room:_0x3380ea}=_0x27498c[_0x346efe(0x1d9)];try{const _0x405788=await warehouse[_0x346efe(0x220)]([{'$match':{'name':_0x40371b,'room':_0x3380ea}},{'$unwind':_0x346efe(0x25d)},{'$match':{'product_details.level':parseInt(_0x513df1),'product_details.isle':_0x409d8b,'product_details.pallet':parseInt(_0x1673f1)}},{'$group':{'_id':_0x346efe(0x253),'name':{'$first':_0x346efe(0x1bd)},'product_stock':{'$first':_0x346efe(0x21a)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x346efe(0x26f)},'pallet':{'$first':_0x346efe(0x20f)},'maxProducts':{'$first':_0x346efe(0x1d6)}}}]);_0x401dbe[_0x346efe(0x216)](0xc8)['json'](_0x405788);}catch(_0x2fe935){_0x401dbe['status'](0x194)[_0x346efe(0x1ba)]({'message':_0x2fe935['message']});}}),module[a0_0x170297(0x1a6)]=router;