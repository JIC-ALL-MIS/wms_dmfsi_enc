var a0_0x3c2cb7=a0_0x3260;function a0_0x3260(_0x740913,_0x4ffc04){var _0x56bbf8=a0_0x56bb();return a0_0x3260=function(_0x3260cc,_0x3fca6d){_0x3260cc=_0x3260cc-0x8e;var _0x5038de=_0x56bbf8[_0x3260cc];return _0x5038de;},a0_0x3260(_0x740913,_0x4ffc04);}function a0_0x56bb(){var _0x41ede8=['to_quantity','type','/preview/:id','primary_code','language','secondary_unit','90GcTsJo','$product_details.level','2JdhKye','</h5>','<html><head><title></title>','Spanish','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Hindi','</td>','TRF-','params','Email\x20sent\x20successfully','Rack\x20A','filter','English\x20(US)','/transfer/preview/','$product_details','<div>','\x20Order\x20Number\x20:\x20','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','back','find','note','catch','../middleware/auth','$product_details.maxProducts','4611000Imuvyz','/view/:id','image','16104440hVtgtR','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','storage','to_prod_level','from_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','max_per_unit','save','Error\x20Occurs','createTransport','from_bay','to_warehouse','from_storage','success','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','../models/all_models','Level','maxperunit','bin','$product_details.bay','product_details','invoice','from_room','<tbody\x20style=\x22text-align:\x20center;\x22>','/barcode_scanner','host','/transfer/view','$product.from_room_name','/barcode_scanner3','getDate','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','to_floorlevel','secondary_code','flash','slice','warehouse','prod_name','updateOne','product_name','</head><body>','<tr>','json','$product_details.unit','to_bin','post','from_prod_isle','from_rak','</tbody>','/barcode_scanner2','forEach','$product_details.rack','$product_details.floorlevel','prod_cat','from_room_name','random','$product_details.expiry_date','$product_details.isle','toString','<h5>','to_prod_qty','from_prod_pallet','message','<!DOCTYPE\x20html>','redirect','English','</thead>','/view','$product_details.secondary_code','COLD\x20STORAGE','Receiving\x20Area','from_prod_level','floorlevel','An\x20error\x20occurred\x20while\x20saving\x20data.','role','product','$product_details.pallet','Rack\x20B','An\x20error\x20occurred.','bay','findOne','from_types','Floor','then','True','$name','finalize','$product_details.primary_code','</tr>','New_Qty_Converted','Shelves','Enclosed','_id','from_floorlevel','batch_code','findById','French','$product_details.bin','rak','padStart','Transfer\x20Finalize\x20Successfully','$invoice','Rack\x20E','<h2>\x20','$finalize','21CYATQU','to_types','Arabic','ToRoomAssigned','../public/language/languages.json','$product_details.product_stock','MaxStocks_data2','aggregate','get','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/upload/','add_transfer','staff','$room','getMonth','1778100qnOqHB','RoomAssigned','error','render','$product_details._id','sendMail','$product_details.maxPerUnit','Raw\x20Materials','to_room','</div>','logo','master','<table\x20style=\x22width:\x20100%\x20!important;\x22>','6837066KRaFiA','primary_unit','<strong>\x20Regards\x20</strong>','site_title','body','rack','Portuguese','</body></html>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Portuguese\x20(BR)','length','maxProducts','87676wKTWzr','Arabic\x20(ae)','email','product_stock','$isAllowEdit','from_prod_qty','edit_transfer','/picking_list/PDF_transfer_rm/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','German','date','Enabled','Logo.png','from_bin','from_rack','$date','$product_details.production_date','$product_details.product_name','Return\x20Rooms','push','log','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','product_code3','$from_warehouse','1424061IbbwvY','To_invoice','to_prod_isle','errors','edit_transfer_view','to_bay','all','to_prod_pallet','$to_warehouse','Product\x20Transfer\x20successfully','production_date','/view/add_transfer','from_quantity','$product_details.storage','$product_details.product_code','transfer','express','Transfer\x20Mail','$product_details.batch_code','getFullYear','to_invoice','status','from_warehouse','Rack\x20F','\x20</h2>','split','1164413VMODdP','concat','string','user','unit','product_code','Chinese','map','exports'];a0_0x56bb=function(){return _0x41ede8;};return a0_0x56bb();}(function(_0x194805,_0xe4e965){var _0x5cc72a=a0_0x3260,_0x453b60=_0x194805();while(!![]){try{var _0x1d36d5=parseInt(_0x5cc72a(0xbb))/0x1*(parseInt(_0x5cc72a(0xcc))/0x2)+parseInt(_0x5cc72a(0xa1))/0x3+-parseInt(_0x5cc72a(0x179))/0x4*(parseInt(_0x5cc72a(0xca))/0x5)+-parseInt(_0x5cc72a(0x160))/0x6*(-parseInt(_0x5cc72a(0x151))/0x7)+-parseInt(_0x5cc72a(0xe5))/0x8+parseInt(_0x5cc72a(0x16d))/0x9+-parseInt(_0x5cc72a(0xe8))/0xa;if(_0x1d36d5===_0xe4e965)break;else _0x453b60['push'](_0x453b60['shift']());}catch(_0x43f910){_0x453b60['push'](_0x453b60['shift']());}}}(a0_0x56bb,0xac79f));const express=require(a0_0x3c2cb7(0xb1)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x3c2cb7(0xf8)),auth=require(a0_0x3c2cb7(0xe3)),users=require(a0_0x3c2cb7(0x155)),nodemailer=require('nodemailer');router[a0_0x3c2cb7(0x159)](a0_0x3c2cb7(0x12b),auth,async(_0x52befe,_0x1db886)=>{var _0x1f2b15=a0_0x3c2cb7;try{const {username:_0x5216ca,email:_0x21f083,role:_0x25563d}=_0x52befe[_0x1f2b15(0xbe)],_0x41da0d=_0x52befe[_0x1f2b15(0xbe)],_0x45fa20=await profile[_0x1f2b15(0x138)]({'email':_0x41da0d['email']}),_0x3ab9fe=await master_shop[_0x1f2b15(0xe0)]();console[_0x1f2b15(0x9c)](_0x1f2b15(0x16b),_0x3ab9fe);let _0x406de4;if(_0x41da0d['role']==_0x1f2b15(0x15d)){const _0xa81479=await staff[_0x1f2b15(0x138)]({'email':_0x41da0d[_0x1f2b15(0x17b)]});_0x406de4=await transfers[_0x1f2b15(0xe0)]({'from_warehouse':_0xa81479[_0x1f2b15(0x10c)]});}else _0x406de4=await transfers[_0x1f2b15(0x158)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x1f2b15(0x14d)},'date':{'$first':_0x1f2b15(0x97)},'from_warehouse':{'$first':_0x1f2b15(0xa0)},'to_warehouse':{'$first':_0x1f2b15(0xa9)},'from_room_name':{'$addToSet':_0x1f2b15(0x104)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x1f2b15(0x150)},'isAllowEdit':{'$first':_0x1f2b15(0x17d)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3ab9fe[0x0]['language']==_0x1f2b15(0xd8)){var _0x19bb9c=users[_0x1f2b15(0x129)];console[_0x1f2b15(0x9c)](_0x19bb9c);}else{if(_0x3ab9fe[0x0][_0x1f2b15(0xc8)]==_0x1f2b15(0xd1))var _0x19bb9c=users['Hindi'];else{if(_0x3ab9fe[0x0][_0x1f2b15(0xc8)]==_0x1f2b15(0x91))var _0x19bb9c=users[_0x1f2b15(0x91)];else{if(_0x3ab9fe[0x0][_0x1f2b15(0xc8)]==_0x1f2b15(0xcf))var _0x19bb9c=users['Spanish'];else{if(_0x3ab9fe[0x0][_0x1f2b15(0xc8)]==_0x1f2b15(0x148))var _0x19bb9c=users[_0x1f2b15(0x148)];else{if(_0x3ab9fe[0x0][_0x1f2b15(0xc8)]==_0x1f2b15(0x176))var _0x19bb9c=users[_0x1f2b15(0x173)];else{if(_0x3ab9fe[0x0]['language']==_0x1f2b15(0xc1))var _0x19bb9c=users[_0x1f2b15(0xc1)];else{if(_0x3ab9fe[0x0]['language']==_0x1f2b15(0x17a))var _0x19bb9c=users[_0x1f2b15(0x153)];}}}}}}}_0x1db886['render'](_0x1f2b15(0xb0),{'success':_0x52befe['flash']('success'),'errors':_0x52befe[_0x1f2b15(0x10a)](_0x1f2b15(0xa4)),'role':_0x41da0d,'profile':_0x45fa20,'master_shop':_0x3ab9fe,'transfer':_0x406de4,'language':_0x19bb9c});}catch(_0x538384){console[_0x1f2b15(0x9c)](_0x538384);}});async function getRandom8DigitNumber(){var _0x4da31a=a0_0x3c2cb7;const _0xffe091=0x989680,_0x503ee3=0x5f5e0ff,_0x4bc28f=Math['floor'](Math[_0x4da31a(0x11f)]()*(_0x503ee3-_0xffe091+0x1))+_0xffe091;var _0x424707;const _0x116735=await transfers[_0x4da31a(0x138)]({'invoice':_0x4da31a(0xd3)+_0x4bc28f});return _0x116735&&_0x116735['length']>0x0?_0x424707=_0x4da31a(0xd3)+_0x4bc28f:_0x424707=_0x4da31a(0xd3)+_0x4bc28f,_0x424707;}router[a0_0x3c2cb7(0x159)](a0_0x3c2cb7(0xac),auth,async(_0xd8a5ee,_0x2e3053)=>{var _0x2e0c91=a0_0x3c2cb7;try{const {username:_0x50c397,email:_0x5ddddc,role:_0x1d14cf}=_0xd8a5ee[_0x2e0c91(0xbe)],_0x13f7f2=_0xd8a5ee['user'],_0x1491d6=await profile[_0x2e0c91(0x138)]({'email':_0x13f7f2[_0x2e0c91(0x17b)]}),_0xbf2be6=await master_shop[_0x2e0c91(0xe0)]();console[_0x2e0c91(0x9c)](_0x2e0c91(0x16b),_0xbf2be6);let _0x260d48;if(_0x13f7f2[_0x2e0c91(0x132)]==_0x2e0c91(0x15d)){const _0x13744d=await staff[_0x2e0c91(0x138)]({'email':_0x13f7f2['email']});_0x260d48=await warehouse['aggregate']([{'$match':{'status':_0x2e0c91(0x93),'name':_0x13744d[_0x2e0c91(0x10c)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x2e0c91(0x13d),'name':{'$first':_0x2e0c91(0x13d)}}}]);}else _0x260d48=await warehouse[_0x2e0c91(0x158)]([{'$match':{'status':_0x2e0c91(0x93),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x2e0c91(0x13d),'name':{'$first':_0x2e0c91(0x13d)}}}]);var _0xae9aaf=['Ambient',_0x2e0c91(0x143),_0x2e0c91(0x9a)];const _0x3bd94b=await transfers[_0x2e0c91(0xe0)]({}),_0x3ef92c=_0x3bd94b[_0x2e0c91(0x177)]+0x1,_0x4d4ad8=_0x2e0c91(0xd3)+_0x3ef92c[_0x2e0c91(0x122)]()[_0x2e0c91(0x14b)](0x5,'0');if(_0xbf2be6[0x0][_0x2e0c91(0xc8)]==_0x2e0c91(0xd8)){var _0x1d7f70=users['English'];console[_0x2e0c91(0x9c)](_0x1d7f70);}else{if(_0xbf2be6[0x0][_0x2e0c91(0xc8)]=='Hindi')var _0x1d7f70=users[_0x2e0c91(0xd1)];else{if(_0xbf2be6[0x0][_0x2e0c91(0xc8)]==_0x2e0c91(0x91))var _0x1d7f70=users['German'];else{if(_0xbf2be6[0x0][_0x2e0c91(0xc8)]=='Spanish')var _0x1d7f70=users[_0x2e0c91(0xcf)];else{if(_0xbf2be6[0x0][_0x2e0c91(0xc8)]==_0x2e0c91(0x148))var _0x1d7f70=users[_0x2e0c91(0x148)];else{if(_0xbf2be6[0x0][_0x2e0c91(0xc8)]==_0x2e0c91(0x176))var _0x1d7f70=users[_0x2e0c91(0x173)];else{if(_0xbf2be6[0x0]['language']==_0x2e0c91(0xc1))var _0x1d7f70=users[_0x2e0c91(0xc1)];else{if(_0xbf2be6[0x0][_0x2e0c91(0xc8)]==_0x2e0c91(0x17a))var _0x1d7f70=users[_0x2e0c91(0x153)];}}}}}}}const _0x512862=getRandom8DigitNumber();_0x512862[_0x2e0c91(0x13b)](_0x2cb353=>{var _0x3139c8=_0x2e0c91;_0x2e3053[_0x3139c8(0x163)](_0x3139c8(0x15c),{'success':_0xd8a5ee[_0x3139c8(0x10a)](_0x3139c8(0xf6)),'errors':_0xd8a5ee[_0x3139c8(0x10a)](_0x3139c8(0xa4)),'role':_0x13f7f2,'profile':_0x1491d6,'master_shop':_0xbf2be6,'warehouse':_0x260d48,'language':_0x1d7f70,'rooms_data':_0xae9aaf,'invoice':_0x2cb353});})['catch'](_0xc108d5=>{var _0x18d790=_0x2e0c91;_0xd8a5ee['flash'](_0x18d790(0xa4),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2e3053[_0x18d790(0x128)]('/transfer/view');});}catch(_0x540add){console[_0x2e0c91(0x9c)](_0x540add);}}),router[a0_0x3c2cb7(0x115)](a0_0x3c2cb7(0xac),auth,async(_0x5f4b89,_0x4defa4)=>{var _0x2d7403=a0_0x3c2cb7;try{console[_0x2d7403(0x9c)](_0x5f4b89[_0x2d7403(0x171)]);const {date:_0x1ee237,from_warehouse:_0x32daa1,FromRoom_name:_0x1c77cc,to_warehouse:_0x334fc6,ToRoom_name:_0x311299,prod_name:_0x2de8ff,from_prod_qty:_0x5bc4f,from_prod_level:_0x13dd51,from_prod_isle:_0x48787f,from_prod_pallet:_0x2893d6,to_prod_qty:_0x5286b7,to_prod_level:_0x4ba9c9,to_prod_isle:_0x33baa7,to_prod_pallet:_0x42ab1d,primary_code:_0x2a647b,secondary_code:_0x14571c,product_code3:_0x232f68,note:_0x439633,MaxStocks_data2:_0x2b00cd,invoice:_0x590536,expiry_date:_0x57dbc0}=_0x5f4b89[_0x2d7403(0x171)];if(typeof _0x2de8ff=='string')var _0x25fc53=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x10d)]],_0x1601f3=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x17e)]],_0x557743=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x12f)]],_0x4ed598=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x141)]],_0x5549ce=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xec)]],_0x5d274b=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xc7)]],_0x11147d=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x109)]],_0x5e6dbd=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x9f)]],_0x250e6f=[_0x5f4b89['body'][_0x2d7403(0x157)]],_0xfe1fdd=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x16e)]],_0x188db8=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xc9)]],_0x214b8a=[_0x5f4b89['body']['batch_code']],_0x561e0c=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xe9)]],_0x5d1666=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xef)]],_0x3ba730=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xab)]],_0x366412=[_0x5f4b89['body'][_0x2d7403(0x11d)]],_0x35bebf=[_0x5f4b89['body'][_0x2d7403(0x161)]],_0x28e591=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x154)]],_0x53d390=[_0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xed)]],_0x1e97e4=[_0x5f4b89['body'][_0x2d7403(0xb5)]];else var _0x25fc53=[..._0x5f4b89[_0x2d7403(0x171)]['prod_name']],_0x1601f3=[..._0x5f4b89['body'][_0x2d7403(0x17e)]],_0x557743=[..._0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x12f)]],_0x4ed598=[..._0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x141)]],_0x5549ce=[..._0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xec)]],_0x5d274b=[..._0x5f4b89[_0x2d7403(0x171)]['primary_code']],_0x11147d=[..._0x5f4b89['body'][_0x2d7403(0x109)]],_0x5e6dbd=[..._0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x9f)]],_0x250e6f=[..._0x5f4b89[_0x2d7403(0x171)]['MaxStocks_data2']],_0xfe1fdd=[..._0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x16e)]],_0x188db8=[..._0x5f4b89['body'][_0x2d7403(0xc9)]],_0x214b8a=[..._0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0x146)]],_0x561e0c=[..._0x5f4b89['body']['expiry_date']],_0x5d1666=[..._0x5f4b89['body'][_0x2d7403(0xef)]],_0x3ba730=[..._0x5f4b89['body'][_0x2d7403(0xab)]],_0x366412=[..._0x5f4b89['body'][_0x2d7403(0x11d)]],_0x35bebf=[..._0x5f4b89['body'][_0x2d7403(0x161)]],_0x28e591=[..._0x5f4b89['body'][_0x2d7403(0x154)]],_0x53d390=[..._0x5f4b89[_0x2d7403(0x171)][_0x2d7403(0xed)]],_0x1e97e4=[..._0x5f4b89['body'][_0x2d7403(0xb5)]];const _0x480ae2=_0x25fc53['map'](_0x295df2=>{return _0x295df2={'product_name':_0x295df2};});_0x1601f3[_0x2d7403(0x11a)]((_0x3306c5,_0x507250)=>{var _0x5452a1=_0x2d7403;_0x480ae2[_0x507250][_0x5452a1(0xad)]=_0x3306c5;}),_0x53d390['forEach']((_0x227338,_0x1a2295)=>{_0x480ae2[_0x1a2295]['from_invoice']=_0x227338;}),_0x1e97e4[_0x2d7403(0x11a)]((_0x23cdcf,_0x133f6b)=>{var _0x1813a5=_0x2d7403;_0x480ae2[_0x133f6b][_0x1813a5(0xa2)]=_0x23cdcf;}),_0x557743[_0x2d7403(0x11a)]((_0x3e2a58,_0x5f25b3)=>{var _0x2a0fb3=_0x2d7403;_0x35bebf[_0x2a0fb3(0x11a)]((_0x5d6c96,_0x45f2dc)=>{var _0x9e9ec6=_0x2a0fb3;if(_0x5d6c96==_0x9e9ec6(0x12e)&&_0x5f25b3==_0x45f2dc){var _0x501dc9=_0x3e2a58['slice'](0x3);_0x480ae2[_0x5f25b3][_0x9e9ec6(0xf5)]=_0x3e2a58[0x0],_0x480ae2[_0x5f25b3][_0x9e9ec6(0x96)]=_0x3e2a58[0x1],_0x480ae2[_0x5f25b3][_0x9e9ec6(0xf3)]=0x0,_0x480ae2[_0x5f25b3][_0x9e9ec6(0x95)]=0x0,_0x480ae2[_0x5f25b3][_0x9e9ec6(0x139)]=_0x9e9ec6(0x13a),_0x480ae2[_0x5f25b3][_0x9e9ec6(0x145)]=_0x501dc9;}else{if(_0x5d6c96==_0x9e9ec6(0x142)&&_0x5f25b3==_0x45f2dc){var _0x501dc9=_0x3e2a58[_0x9e9ec6(0x10b)](0x3);_0x480ae2[_0x5f25b3][_0x9e9ec6(0xf5)]=_0x3e2a58[0x0],_0x480ae2[_0x5f25b3][_0x9e9ec6(0x96)]=_0x3e2a58[0x1],_0x480ae2[_0x5f25b3][_0x9e9ec6(0xf3)]=0x0,_0x480ae2[_0x5f25b3][_0x9e9ec6(0x95)]=0x0,_0x480ae2[_0x5f25b3][_0x9e9ec6(0x139)]=_0x9e9ec6(0x13a),_0x480ae2[_0x5f25b3][_0x9e9ec6(0x145)]=_0x3e2a58[0x5];}else{if(_0x5f25b3==_0x45f2dc){var _0x50ab77;if(_0x3e2a58[0x4]=='L')_0x50ab77=_0x9e9ec6(0xf9);else _0x3e2a58[0x4]=='F'&&(_0x50ab77=_0x9e9ec6(0x13a));_0x480ae2[_0x5f25b3][_0x9e9ec6(0xf5)]=_0x3e2a58[0x0],_0x480ae2[_0x5f25b3][_0x9e9ec6(0x96)]=_0x3e2a58[0x1],_0x480ae2[_0x5f25b3][_0x9e9ec6(0xf3)]=_0x3e2a58[0x2],_0x480ae2[_0x5f25b3][_0x9e9ec6(0x95)]=_0x3e2a58[0x3],_0x480ae2[_0x5f25b3][_0x9e9ec6(0x139)]=_0x50ab77,_0x480ae2[_0x5f25b3][_0x9e9ec6(0x145)]=_0x3e2a58[0x5];}}}});}),_0x4ed598[_0x2d7403(0x11a)]((_0x21b3cd,_0x346e9b)=>{var _0x314222=_0x2d7403;_0x480ae2[_0x346e9b][_0x314222(0xc4)]=_0x21b3cd;}),_0x5549ce[_0x2d7403(0x11a)]((_0x111962,_0x1f63cb)=>{_0x28e591['forEach']((_0x17feb3,_0x56e62f)=>{var _0x3dc32b=a0_0x3260;if(_0x17feb3==_0x3dc32b(0x12e)&&_0x1f63cb==_0x56e62f){var _0x6b3641=_0x111962[_0x3dc32b(0x10b)](0x3);_0x480ae2[_0x1f63cb]['storage']=_0x111962[0x0],_0x480ae2[_0x1f63cb]['rack']=_0x111962[0x1],_0x480ae2[_0x1f63cb][_0x3dc32b(0xa6)]=0x0,_0x480ae2[_0x1f63cb]['to_bin']=0x0,_0x480ae2[_0x1f63cb][_0x3dc32b(0x152)]=_0x3dc32b(0x13a),_0x480ae2[_0x1f63cb][_0x3dc32b(0x108)]=_0x6b3641;}else{if(_0x17feb3=='Shelves'&&_0x1f63cb==_0x56e62f){var _0x6b3641=_0x111962['slice'](0x3);_0x480ae2[_0x1f63cb][_0x3dc32b(0xeb)]=_0x111962[0x0],_0x480ae2[_0x1f63cb]['rack']=_0x111962[0x1],_0x480ae2[_0x1f63cb][_0x3dc32b(0xa6)]=0x0,_0x480ae2[_0x1f63cb]['to_bin']=0x0,_0x480ae2[_0x1f63cb][_0x3dc32b(0x152)]=_0x3dc32b(0x13a),_0x480ae2[_0x1f63cb][_0x3dc32b(0x108)]=_0x111962[0x5];}else{if(_0x1f63cb==_0x56e62f){var _0x48b5a3;if(_0x111962[0x4]=='L')_0x48b5a3=_0x3dc32b(0xf9);else _0x111962[0x4]=='F'&&(_0x48b5a3=_0x3dc32b(0x13a));_0x480ae2[_0x1f63cb][_0x3dc32b(0xeb)]=_0x111962[0x0],_0x480ae2[_0x1f63cb][_0x3dc32b(0x172)]=_0x111962[0x1],_0x480ae2[_0x1f63cb][_0x3dc32b(0xa6)]=_0x111962[0x2],_0x480ae2[_0x1f63cb][_0x3dc32b(0x114)]=_0x111962[0x3],_0x480ae2[_0x1f63cb][_0x3dc32b(0x152)]=_0x48b5a3,_0x480ae2[_0x1f63cb][_0x3dc32b(0x108)]=_0x111962[0x5];}}}});}),_0x5d274b[_0x2d7403(0x11a)]((_0x1e34fb,_0x5685bb)=>{var _0xa76ecd=_0x2d7403;_0x480ae2[_0x5685bb][_0xa76ecd(0xc7)]=_0x1e34fb;}),_0x11147d[_0x2d7403(0x11a)]((_0x4bd862,_0x2ee4a3)=>{var _0x19f566=_0x2d7403;_0x480ae2[_0x2ee4a3][_0x19f566(0x109)]=_0x4bd862;}),_0x5e6dbd[_0x2d7403(0x11a)]((_0x1a6bcf,_0x129cf9)=>{var _0xcc2977=_0x2d7403;_0x480ae2[_0x129cf9][_0xcc2977(0xc0)]=_0x1a6bcf;}),_0x250e6f[_0x2d7403(0x11a)]((_0xe3b772,_0x3e1b2f)=>{var _0x2c4551=_0x2d7403;_0x480ae2[_0x3e1b2f][_0x2c4551(0x178)]=_0xe3b772;}),_0xfe1fdd[_0x2d7403(0x11a)]((_0xa1d5c3,_0x340353)=>{_0x480ae2[_0x340353]['unit']=_0xa1d5c3;}),_0x188db8[_0x2d7403(0x11a)]((_0x3bab14,_0x43c472)=>{_0x480ae2[_0x43c472]['secondary_unit']=_0x3bab14;}),_0x214b8a[_0x2d7403(0x11a)]((_0x1114ae,_0x2f7963)=>{var _0x246e19=_0x2d7403;_0x480ae2[_0x2f7963][_0x246e19(0x146)]=_0x1114ae;}),_0x561e0c[_0x2d7403(0x11a)]((_0x527d78,_0x16c26d)=>{var _0x565ea0=_0x2d7403;_0x480ae2[_0x16c26d][_0x565ea0(0xe9)]=_0x527d78;}),_0x5d1666[_0x2d7403(0x11a)]((_0x4f806e,_0x2f9ed3)=>{var _0x110198=_0x2d7403;_0x480ae2[_0x2f9ed3][_0x110198(0xfa)]=_0x4f806e;}),_0x3ba730[_0x2d7403(0x11a)]((_0x142569,_0x336504)=>{var _0x56dbda=_0x2d7403;_0x480ae2[_0x336504][_0x56dbda(0xab)]=_0x142569;}),_0x366412[_0x2d7403(0x11a)]((_0xa9bf97,_0x2464eb)=>{var _0xd095fa=_0x2d7403;_0x480ae2[_0x2464eb][_0xd095fa(0x11d)]=_0xa9bf97;}),_0x35bebf[_0x2d7403(0x11a)]((_0x470932,_0x446b22)=>{var _0x4a0526=_0x2d7403;_0x480ae2[_0x446b22][_0x4a0526(0x11e)]=_0x470932;}),_0x28e591[_0x2d7403(0x11a)]((_0x242692,_0x5f2a03)=>{_0x480ae2[_0x5f2a03]['to_room_name']=_0x242692;});const _0x558187=_0x480ae2[_0x2d7403(0xd7)](_0x1f54c9=>_0x1f54c9['to_quantity']!=='0'&&_0x1f54c9[_0x2d7403(0xc4)]!==''||_0x1f54c9['to_floorlevel']!=='0'&&_0x1f54c9[_0x2d7403(0x108)]!==''),_0x3521cd=new transfers({'date':_0x1ee237,'from_warehouse':_0x32daa1,'to_warehouse':_0x334fc6,'product':_0x558187,'note':_0x439633,'invoice':_0x590536}),_0x5b97df=await _0x3521cd['save']();_0x5f4b89[_0x2d7403(0x10a)]('success',_0x2d7403(0xaa)),_0x4defa4[_0x2d7403(0x128)](_0x2d7403(0xd9)+_0x5b97df[_0x2d7403(0x144)]);}catch(_0x2ff058){console[_0x2d7403(0x9c)](_0x2ff058),_0x4defa4[_0x2d7403(0xb6)](0xc8)[_0x2d7403(0x112)]({'errorMessage':_0x2ff058[_0x2d7403(0x126)]});}}),router[a0_0x3c2cb7(0x159)](a0_0x3c2cb7(0xc6),auth,async(_0x383ffe,_0x512d32)=>{var _0x4eb474=a0_0x3c2cb7;try{const {username:_0x2068fb,email:_0x2328b7,role:_0xb98141}=_0x383ffe['user'],_0x194dd3=_0x383ffe['user'],_0xcacec5=await profile[_0x4eb474(0x138)]({'email':_0x194dd3[_0x4eb474(0x17b)]}),_0x2574c2=await master_shop[_0x4eb474(0xe0)]();console[_0x4eb474(0x9c)](_0x4eb474(0x16b),_0x2574c2);const _0x3dcd1b=await transfers['findById'](_0x383ffe['params']['id']);let _0x1afa6a=new Date(_0x3dcd1b[_0x4eb474(0xe9)]),_0x1cd7eb=('0'+_0x1afa6a[_0x4eb474(0x106)]())['slice'](-0x2),_0x462b31=('0'+(_0x1afa6a[_0x4eb474(0x15f)]()+0x1))[_0x4eb474(0x10b)](-0x2),_0x100f25=_0x1afa6a[_0x4eb474(0xb4)](),_0x8d2684=_0x100f25+'-'+_0x462b31+'-'+_0x1cd7eb,_0x192cfa;if(_0x194dd3[_0x4eb474(0x132)]==_0x4eb474(0x15d)){const _0x4716d8=await staff['findOne']({'email':_0x194dd3[_0x4eb474(0x17b)]});_0x192cfa=await warehouse[_0x4eb474(0xe0)]({'status':_0x4eb474(0x93),'name':_0x4716d8[_0x4eb474(0x10c)],'warehouse_category':_0x4eb474(0x167)});}else _0x192cfa=await warehouse['find']({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0xe8a737=await warehouse[_0x4eb474(0x158)]([{'$match':{'name':_0x3dcd1b[_0x4eb474(0xb7)]}},{'$unwind':_0x4eb474(0xda)},{'$group':{'_id':_0x4eb474(0x164),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4eb474(0x156)},'bay':{'$first':_0x4eb474(0xfc)},'bin':{'$first':_0x4eb474(0x149)},'type':{'$first':_0x4eb474(0x9d)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4eb474(0x13f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4eb474(0xaf)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4eb474(0x11b)},'expiry_date':{'$first':_0x4eb474(0x120)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]);if(_0x2574c2[0x0][_0x4eb474(0xc8)]==_0x4eb474(0xd8)){var _0x328ebe=users[_0x4eb474(0x129)];console[_0x4eb474(0x9c)](_0x328ebe);}else{if(_0x2574c2[0x0][_0x4eb474(0xc8)]=='Hindi')var _0x328ebe=users[_0x4eb474(0xd1)];else{if(_0x2574c2[0x0][_0x4eb474(0xc8)]==_0x4eb474(0x91))var _0x328ebe=users[_0x4eb474(0x91)];else{if(_0x2574c2[0x0][_0x4eb474(0xc8)]==_0x4eb474(0xcf))var _0x328ebe=users[_0x4eb474(0xcf)];else{if(_0x2574c2[0x0]['language']=='French')var _0x328ebe=users['French'];else{if(_0x2574c2[0x0][_0x4eb474(0xc8)]=='Portuguese\x20(BR)')var _0x328ebe=users[_0x4eb474(0x173)];else{if(_0x2574c2[0x0]['language']==_0x4eb474(0xc1))var _0x328ebe=users['Chinese'];else{if(_0x2574c2[0x0][_0x4eb474(0xc8)]==_0x4eb474(0x17a))var _0x328ebe=users[_0x4eb474(0x153)];}}}}}}}_0x512d32[_0x4eb474(0x163)](_0x4eb474(0xa5),{'success':_0x383ffe[_0x4eb474(0x10a)](_0x4eb474(0xf6)),'errors':_0x383ffe[_0x4eb474(0x10a)](_0x4eb474(0xa4)),'role':_0x194dd3,'profile':_0xcacec5,'master_shop':_0x2574c2,'warehouse':_0x192cfa,'transfer':_0x3dcd1b,'stock':_0xe8a737,'language':_0x328ebe});}catch(_0x5b2797){console['log'](_0x5b2797);}}),router[a0_0x3c2cb7(0x115)](a0_0x3c2cb7(0xc6),auth,async(_0xf7391e,_0x447162)=>{var _0x2ee661=a0_0x3c2cb7;try{const _0x3c0cdd=_0xf7391e[_0x2ee661(0xd4)]['id'],{from_warehouse:_0x44793a,FromRoom_name:_0x9bd8be,to_warehouse:_0x2a16c5,ToRoom_name:_0x31c629}=_0xf7391e[_0x2ee661(0x171)],_0x28626f=await transfers[_0x2ee661(0x147)]({'_id':_0x3c0cdd}),_0x1f6960=_0x28626f['product'][_0x2ee661(0xc2)](async _0x124852=>{var _0xc3cd56=_0x2ee661;if(_0x124852[_0xc3cd56(0xc4)]>0x0){var _0x3002c7=await warehouse[_0xc3cd56(0x138)]({'name':_0x28626f[_0xc3cd56(0xb7)],'room':_0x124852[_0xc3cd56(0x11e)],'warehouse_category':_0xc3cd56(0x167)});const _0x58403c=_0x3002c7['product_details'][_0xc3cd56(0xc2)](_0x278437=>{var _0x1dc753=_0xc3cd56;_0x278437['product_name']==_0x124852[_0x1dc753(0x10f)]&&_0x278437[_0x1dc753(0x130)]==_0x124852[_0x1dc753(0x145)]&&_0x278437[_0x1dc753(0xc5)]==_0x124852['from_types']&&_0x278437[_0x1dc753(0xfb)]==_0x124852[_0x1dc753(0x95)]&&_0x278437[_0x1dc753(0x137)]==_0x124852[_0x1dc753(0xf3)]&&_0x278437['rack']==_0x124852[_0x1dc753(0x96)]&&_0x278437[_0x1dc753(0xeb)]==_0x124852[_0x1dc753(0xf5)]&&_0x278437[_0x1dc753(0xe9)]==_0x124852[_0x1dc753(0xe9)]&&_0x278437[_0x1dc753(0x146)]==_0x124852['batch_code']&&_0x278437[_0x1dc753(0xab)]==_0x124852[_0x1dc753(0xab)]&&_0x278437[_0x1dc753(0xfe)]==_0x124852[_0x1dc753(0xed)]&&(_0x278437[_0x1dc753(0x17c)]=_0x278437['product_stock']-_0x124852[_0x1dc753(0xc4)]);});}return _0x3002c7;});Promise[_0x2ee661(0xa7)](_0x1f6960)['then'](async _0x473828=>{var _0x28fa8e=_0x2ee661;try{for(const _0x1b1dbc of _0x473828){await _0x1b1dbc[_0x28fa8e(0xf0)]();}try{const _0x2e3fcf=_0x28626f[_0x28fa8e(0x133)][_0x28fa8e(0xc2)](async _0x5505aa=>{var _0x4919eb=_0x28fa8e;if(_0x5505aa[_0x4919eb(0xc4)]>0x0){var _0x1ed26f=await warehouse[_0x4919eb(0x138)]({'name':_0x28626f[_0x4919eb(0xf4)],'room':_0x5505aa['to_room_name'],'warehouse_category':_0x4919eb(0x167)}),_0x5f48a5=0x0;const _0x119b06=_0x1ed26f['product_details']['map'](_0xb765a5=>{var _0x102296=_0x4919eb;_0xb765a5[_0x102296(0x10f)]==_0x5505aa[_0x102296(0x10f)]&&_0xb765a5['floorlevel']==_0x5505aa['to_floorlevel']&&_0xb765a5['type']==_0x5505aa[_0x102296(0x152)]&&_0xb765a5['bin']==_0x5505aa[_0x102296(0x114)]&&_0xb765a5['bay']==_0x5505aa[_0x102296(0xa6)]&&_0xb765a5[_0x102296(0x172)]==_0x5505aa[_0x102296(0x172)]&&_0xb765a5[_0x102296(0xeb)]==_0x5505aa[_0x102296(0xeb)]&&_0xb765a5[_0x102296(0xe9)]==_0x5505aa[_0x102296(0xe9)]&&_0xb765a5[_0x102296(0x146)]==_0x5505aa[_0x102296(0x146)]&&_0xb765a5[_0x102296(0xab)]==_0x5505aa[_0x102296(0xab)]&&_0xb765a5[_0x102296(0xfe)]==_0x5505aa[_0x102296(0xa2)]&&(_0xb765a5[_0x102296(0x17c)]=_0xb765a5[_0x102296(0x17c)]+_0x5505aa['to_quantity'],_0x5f48a5++);});_0x5f48a5=='0'&&(_0x1ed26f[_0x4919eb(0xfd)]=_0x1ed26f['product_details'][_0x4919eb(0xbc)]({'product_name':_0x5505aa[_0x4919eb(0x10f)],'product_stock':_0x5505aa[_0x4919eb(0xc4)],'bay':_0x5505aa[_0x4919eb(0xa6)],'bin':_0x5505aa[_0x4919eb(0x114)],'type':_0x5505aa['to_types'],'floorlevel':_0x5505aa[_0x4919eb(0x108)],'storage':_0x5505aa['storage'],'rack':_0x5505aa[_0x4919eb(0x172)],'product_code':_0x5505aa[_0x4919eb(0xc0)],'primary_code':_0x5505aa[_0x4919eb(0xc7)],'secondary_code':_0x5505aa[_0x4919eb(0x109)],'maxProducts':_0x5505aa[_0x4919eb(0x178)],'storage':_0x5505aa[_0x4919eb(0xeb)],'rack':_0x5505aa[_0x4919eb(0x172)],'expiry_date':_0x5505aa['expiry_date'],'maxPerUnit':_0x5505aa[_0x4919eb(0xfa)],'batch_code':_0x5505aa[_0x4919eb(0x146)],'production_date':_0x5505aa['production_date']}));}return _0x1ed26f;});Promise['all'](_0x2e3fcf)[_0x28fa8e(0x13b)](async _0x189aa6=>{var _0x4e7bfe=_0x28fa8e;try{for(const _0x99454e of _0x189aa6){await warehouse[_0x4e7bfe(0x10e)]({'_id':_0x99454e[_0x4e7bfe(0x144)]},{'$addToSet':{'product_details':{'$each':_0x99454e[_0x4e7bfe(0xfd)]}}});}_0x28626f[_0x4e7bfe(0x13e)]=_0x4e7bfe(0x13c);const _0x1f07ef=await _0x28626f[_0x4e7bfe(0xf0)](),_0x25e179=await master_shop[_0x4e7bfe(0xe0)](),_0x5de837=await email_settings[_0x4e7bfe(0x138)](),_0x2bd4df=await supervisor_settings['find']();var _0x21fb29=_0x28626f['product'],_0xdd2a18='',_0x1c998c;for(_0x1c998c in _0x21fb29){_0xdd2a18+=_0x4e7bfe(0x111)+_0x4e7bfe(0xdd)+_0x21fb29[_0x1c998c][_0x4e7bfe(0x10f)]+_0x4e7bfe(0xd2)+_0x4e7bfe(0xdd)+_0x21fb29[_0x1c998c][_0x4e7bfe(0xc0)]+'</td>'+_0x4e7bfe(0xdd)+_0x21fb29[_0x1c998c]['to_quantity']+_0x4e7bfe(0xd2)+_0x4e7bfe(0xdd)+_0x21fb29[_0x1c998c]['unit']+_0x4e7bfe(0xd2)+_0x4e7bfe(0xdd)+_0x21fb29[_0x1c998c][_0x4e7bfe(0xc9)]+'</td>'+_0x4e7bfe(0xdd)+_0x28626f[_0x4e7bfe(0xf4)]+'</td>'+_0x4e7bfe(0xdd)+_0x21fb29[_0x1c998c]['to_room_name']+_0x4e7bfe(0xd2)+_0x4e7bfe(0xdd)+_0x21fb29[_0x1c998c]['storage']+_0x21fb29[_0x1c998c][_0x4e7bfe(0x172)]+_0x21fb29[_0x1c998c][_0x4e7bfe(0xa6)]+_0x21fb29[_0x1c998c][_0x4e7bfe(0x114)]+_0x21fb29[_0x1c998c][_0x4e7bfe(0x152)][0x0]+_0x21fb29[_0x1c998c][_0x4e7bfe(0x108)]+'</td>',_0x4e7bfe(0x140);}let _0x3e917b=nodemailer[_0x4e7bfe(0xf2)]({'host':_0x5de837[_0x4e7bfe(0x102)],'port':Number(_0x5de837['port']),'secure':![],'auth':{'user':_0x5de837[_0x4e7bfe(0x17b)],'pass':_0x5de837['password']}}),_0xbf5d={'from':_0x5de837[_0x4e7bfe(0x17b)],'to':_0x2bd4df[0x0]['RMSEmail'],'subject':_0x4e7bfe(0xb2),'attachments':[{'filename':_0x4e7bfe(0x94),'path':__dirname+'/../public'+_0x4e7bfe(0x15b)+_0x25e179[0x0][_0x4e7bfe(0xe7)],'cid':_0x4e7bfe(0x16a)}],'html':_0x4e7bfe(0x127)+_0x4e7bfe(0xce)+_0x4e7bfe(0x110)+_0x4e7bfe(0xdb)+_0x4e7bfe(0x107)+_0x4e7bfe(0xdb)+_0x4e7bfe(0xf7)+_0x4e7bfe(0x169)+_0x4e7bfe(0xdb)+_0x4e7bfe(0x14f)+_0x25e179[0x0][_0x4e7bfe(0x170)]+_0x4e7bfe(0xb9)+_0x4e7bfe(0x169)+_0x4e7bfe(0x169)+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x4e7bfe(0xdc)+_0x28626f[_0x4e7bfe(0xfe)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x28626f[_0x4e7bfe(0x92)]+'\x20'+'</span>'+_0x4e7bfe(0xcd)+_0x4e7bfe(0x169)+_0x4e7bfe(0x16c)+_0x4e7bfe(0xd0)+_0x4e7bfe(0x111)+_0x4e7bfe(0xee)+_0x4e7bfe(0x9e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x4e7bfe(0xea)+_0x4e7bfe(0x90)+_0x4e7bfe(0xde)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x4e7bfe(0x15a)+_0x4e7bfe(0x140)+_0x4e7bfe(0x12a)+_0x4e7bfe(0x100)+'\x20'+_0xdd2a18+'\x20'+_0x4e7bfe(0x118)+'</table>'+'<div>'+_0x4e7bfe(0x16f)+_0x4e7bfe(0x123)+_0x25e179[0x0]['site_title']+'</h5>'+_0x4e7bfe(0x169)+_0x4e7bfe(0x169)+_0x4e7bfe(0x174)};_0x3e917b[_0x4e7bfe(0x165)](_0xbf5d,function(_0x43a6db,_0x4b9525){var _0x381495=_0x4e7bfe;_0x43a6db?(console[_0x381495(0x9c)](_0x43a6db),console[_0x381495(0x9c)](_0x381495(0xf1))):console[_0x381495(0x9c)](_0x381495(0xd5));}),_0xf7391e['flash'](_0x4e7bfe(0xf6),_0x4e7bfe(0x14c)),_0x447162[_0x4e7bfe(0x128)](_0x4e7bfe(0x8f)+_0x1f07ef[_0x4e7bfe(0x144)]);}catch(_0x3c74a1){console[_0x4e7bfe(0x162)](_0x3c74a1),_0x447162[_0x4e7bfe(0xb6)](0x1f4)[_0x4e7bfe(0x112)]({'Perror':_0x4e7bfe(0x131),'message':_0x3c74a1['message']});}})[_0x28fa8e(0xe2)](_0x1a8e10=>{var _0x2a7348=_0x28fa8e;console[_0x2a7348(0x162)](_0x1a8e10),_0x447162[_0x2a7348(0xb6)](0x1f4)['json']({'Perror':_0x2a7348(0x136)});});}catch(_0x4ce4d9){_0x447162[_0x28fa8e(0x112)](_0x4ce4d9);}}catch(_0x511b36){console[_0x28fa8e(0x162)](_0x511b36),_0x447162['status'](0x1f4)[_0x28fa8e(0x112)]({'Merror':_0x28fa8e(0x131),'Message':_0x511b36[_0x28fa8e(0x126)]});}})[_0x2ee661(0xe2)](_0x3f3739=>{var _0x5a6f0c=_0x2ee661;console[_0x5a6f0c(0x162)](_0x3f3739),_0x447162[_0x5a6f0c(0xb6)](0x1f4)[_0x5a6f0c(0x112)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x149b20){console[_0x2ee661(0x9c)](_0x149b20);}});function BayBinSelected(_0x21026a,_0xe2d37f){var _0x131975=a0_0x3c2cb7,_0x39fc29=[],_0x4c25c3=[],_0x45ff66=[],_0x2b0707=[],_0x56f96c=[],_0x20aea2=[];let _0x362c7e=[];if(_0x21026a=='DRY\x20STORAGE')switch(_0xe2d37f){case'Rack\x20A':_0x39fc29=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4c25c3=[0x1,0x2],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=[_0x131975(0xf9),_0x131975(0x13a)],_0x56f96c=['D'],_0x20aea2=['A'];break;case _0x131975(0x135):_0x39fc29=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4c25c3=[0x1,0x2],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=[_0x131975(0xf9),_0x131975(0x13a)],_0x56f96c=['D'],_0x20aea2=['B'];break;case _0x131975(0x142):_0x39fc29=[0x0],_0x4c25c3=[0x0],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=['Floor'],_0x56f96c=['D'],_0x20aea2=['S'];break;case _0x131975(0x12e):_0x39fc29=[0x0],_0x4c25c3=[0x0],_0x2b0707=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x45ff66=[_0x131975(0x13a)],_0x56f96c=['D'],_0x20aea2=['R'];break;}else{if(_0x21026a==_0x131975(0x12d))switch(_0xe2d37f){case _0x131975(0xd6):_0x39fc29=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4c25c3=['B','F'],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=[_0x131975(0xf9),_0x131975(0x13a)],_0x56f96c=['C'],_0x20aea2=['A'];break;case _0x131975(0x135):_0x39fc29=[0x5,0x4,0x3,0x2,0x1],_0x4c25c3=['F','B','S'],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=[_0x131975(0xf9),_0x131975(0x13a)],_0x56f96c=['C'],_0x20aea2=['B'];break;case'Rack\x20C':_0x39fc29=[0x1,0x2,0x3,0x4,0x5],_0x4c25c3=['B','F','S'],_0x2b0707=[0x5,0x4,0x3,0x2,0x1],_0x45ff66=['Level',_0x131975(0x13a)],_0x56f96c=['C'],_0x20aea2=['C'];break;case'Rack\x20D':_0x39fc29=[0x5,0x4,0x3,0x2,0x1],_0x4c25c3=['F','B','S'],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=['Level',_0x131975(0x13a)],_0x56f96c=['C'],_0x20aea2=['D'];break;case _0x131975(0x14e):_0x39fc29=[0x4,0x3,0x2,0x1],_0x4c25c3=[0x1,0x2],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=[_0x131975(0xf9),_0x131975(0x13a)],_0x56f96c=['C'],_0x20aea2=['E'];break;case _0x131975(0xb8):_0x39fc29=[0x1,0x2,0x3],_0x4c25c3=[0x1,0x2],_0x2b0707=[0x1,0x2,0x3,0x4,0x5],_0x45ff66=['Level'],_0x56f96c=['C'],_0x20aea2=['F'];break;}}return{'levels':_0x39fc29,'Isle':_0x4c25c3,'rack':_0x2b0707,'type':_0x45ff66,'storage':_0x56f96c,'rak':_0x20aea2};}router['get'](a0_0x3c2cb7(0xe6),auth,async(_0x1795f,_0x563caf)=>{var _0x1d0c6b=a0_0x3c2cb7;try{const {username:_0x4175a8,email:_0x797225,role:_0x4880d7}=_0x1795f[_0x1d0c6b(0xbe)],_0xcea69b=_0x1795f[_0x1d0c6b(0xbe)],_0x5e1cd3=await profile[_0x1d0c6b(0x138)]({'email':_0xcea69b['email']}),_0x52c3dd=await master_shop[_0x1d0c6b(0xe0)](),_0x5009a0=await transfers[_0x1d0c6b(0x147)](_0x1795f['params']['id']);let _0x1f6ac9;if(_0xcea69b[_0x1d0c6b(0x132)]==_0x1d0c6b(0x15d)){const _0x435a24=await staff[_0x1d0c6b(0x138)]({'email':_0xcea69b[_0x1d0c6b(0x17b)]});_0x1f6ac9=await warehouse['aggregate']([{'$match':{'status':_0x1d0c6b(0x93),'name':_0x435a24['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x1d0c6b(0x13d)}}}]);}else _0x1f6ac9=await warehouse[_0x1d0c6b(0x158)]([{'$match':{'status':_0x1d0c6b(0x93),'warehouse_category':_0x1d0c6b(0x167)}},{'$group':{'_id':_0x1d0c6b(0x13d),'name':{'$first':'$name'}}}]);const _0x1d8571=await warehouse[_0x1d0c6b(0x158)]([{'$match':{'name':_0x5009a0['from_warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x1d0c6b(0xda)},{'$group':{'_id':_0x1d0c6b(0x164),'name':{'$first':_0x1d0c6b(0x99)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1d0c6b(0xfc)},'bin':{'$first':_0x1d0c6b(0x149)},'type':{'$first':_0x1d0c6b(0x9d)},'floorlevel':{'$first':_0x1d0c6b(0x11c)},'primary_code':{'$first':_0x1d0c6b(0x13f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1d0c6b(0xae)},'rack':{'$first':_0x1d0c6b(0x11b)},'expiry_date':{'$first':_0x1d0c6b(0x120)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x1d0c6b(0x15e)}}}]),_0x1af8e0=await product['find']({}),_0x40154f=BayBinSelected(_0x5009a0[_0x1d0c6b(0xf4)],_0x5009a0[_0x1d0c6b(0x168)]);if(_0x52c3dd[0x0][_0x1d0c6b(0xc8)]==_0x1d0c6b(0xd8)){var _0x553564=users['English'];console[_0x1d0c6b(0x9c)](_0x553564);}else{if(_0x52c3dd[0x0]['language']==_0x1d0c6b(0xd1))var _0x553564=users[_0x1d0c6b(0xd1)];else{if(_0x52c3dd[0x0][_0x1d0c6b(0xc8)]==_0x1d0c6b(0x91))var _0x553564=users[_0x1d0c6b(0x91)];else{if(_0x52c3dd[0x0][_0x1d0c6b(0xc8)]==_0x1d0c6b(0xcf))var _0x553564=users['Spanish'];else{if(_0x52c3dd[0x0]['language']==_0x1d0c6b(0x148))var _0x553564=users['French'];else{if(_0x52c3dd[0x0][_0x1d0c6b(0xc8)]==_0x1d0c6b(0x176))var _0x553564=users['Portuguese'];else{if(_0x52c3dd[0x0][_0x1d0c6b(0xc8)]==_0x1d0c6b(0xc1))var _0x553564=users[_0x1d0c6b(0xc1)];else{if(_0x52c3dd[0x0][_0x1d0c6b(0xc8)]==_0x1d0c6b(0x17a))var _0x553564=users[_0x1d0c6b(0x153)];}}}}}}}_0x563caf[_0x1d0c6b(0x163)](_0x1d0c6b(0x8e),{'success':_0x1795f[_0x1d0c6b(0x10a)](_0x1d0c6b(0xf6)),'errors':_0x1795f[_0x1d0c6b(0x10a)](_0x1d0c6b(0xa4)),'role':_0xcea69b,'profile':_0x5e1cd3,'master_shop':_0x52c3dd,'warehouse':_0x1f6ac9,'transfer':_0x5009a0,'stock':_0x1d8571,'unit':_0x1af8e0,'language':_0x553564});}catch(_0x1a56a2){console[_0x1d0c6b(0x9c)](_0x1a56a2);}}),router['post']('/view/:id',auth,async(_0x52d3ec,_0x5abccc)=>{var _0x161a0a=a0_0x3c2cb7;try{const _0x7eea46=_0x52d3ec['params']['id'],_0x1435b6=await transfers[_0x161a0a(0x147)](_0x7eea46);_0x5abccc[_0x161a0a(0x112)](_0x52d3ec[_0x161a0a(0x171)]);return;const {date:_0xf88dd8,from_warehouse:_0x2ce0e2,FromRoom_name:_0x52ea1d,to_warehouse:_0x53209d,ToRoom_name:_0x4dc4f2,prod_name:_0x44c5d7,from_prod_qty:_0x2fe2c7,from_prod_level:_0x570a43,from_prod_isle:_0x464ad0,from_prod_pallet:_0x44cf74,to_prod_qty:_0xeb4588,to_prod_level:_0x543547,to_prod_isle:_0x3e59ac,to_prod_pallet:_0x474b8f,primary_code:_0x4c92e5,secondary_code:_0xd555b6,product_code3:_0x2b9d87,note:_0x5f51d0,invoice:_0x2964e3,expiry_date:_0x1535c0}=_0x52d3ec[_0x161a0a(0x171)];if(typeof _0x44c5d7==_0x161a0a(0xbd))var _0x452eeb=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x10d)]],_0x16c54b=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x17e)]],_0x4fe1bf=[_0x52d3ec['body'][_0x161a0a(0x12f)]],_0x48de73=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x116)]],_0x54b8c6=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x125)]],_0x4ff11c=[_0x52d3ec[_0x161a0a(0x171)]['from_types']],_0x462162=[_0x52d3ec['body'][_0x161a0a(0x124)]],_0x3b5247=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xec)]],_0x142fbf=[_0x52d3ec['body'][_0x161a0a(0xa3)]],_0x2b0743=[_0x52d3ec[_0x161a0a(0x171)]['to_prod_pallet']],_0x37c0d2=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x152)]],_0x1b98bb=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xeb)]],_0x3080dc=[_0x52d3ec['body'][_0x161a0a(0x14a)]],_0x1b3a0e=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xc7)]],_0x2cafd2=[_0x52d3ec['body']['secondary_code']],_0x5a369c=[_0x52d3ec[_0x161a0a(0x171)]['product_code3']],_0x4140f9=[_0x52d3ec[_0x161a0a(0x171)]['MaxStocks_data2']],_0x1fe8f0=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xbf)]],_0x24db88=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xc9)]],_0x47b994=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x146)]],_0x426490=[_0x52d3ec[_0x161a0a(0x171)]['expiry_date']],_0x57eccd=[_0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xf5)]],_0x1aee97=[_0x52d3ec[_0x161a0a(0x171)]['from_rak']];else var _0x452eeb=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x10d)]],_0x1b98bb=[..._0x52d3ec[_0x161a0a(0x171)]['storage']],_0x3080dc=[..._0x52d3ec[_0x161a0a(0x171)]['rak']],_0x4ff11c=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x139)]],_0x37c0d2=[..._0x52d3ec['body'][_0x161a0a(0x152)]],_0x16c54b=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x17e)]],_0x4fe1bf=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x12f)]],_0x48de73=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x116)]],_0x54b8c6=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x125)]],_0x462162=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x124)]],_0x3b5247=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xec)]],_0x142fbf=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xa3)]],_0x2b0743=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xa8)]],_0x1b3a0e=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xc7)]],_0x2cafd2=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x109)]],_0x5a369c=[..._0x52d3ec['body'][_0x161a0a(0x9f)]],_0x4140f9=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x157)]],_0x1fe8f0=[..._0x52d3ec[_0x161a0a(0x171)]['unit']],_0x24db88=[..._0x52d3ec['body'][_0x161a0a(0xc9)]],_0x47b994=[..._0x52d3ec['body'][_0x161a0a(0x146)]],_0x426490=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xe9)]],_0x57eccd=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0xf5)]],_0x1aee97=[..._0x52d3ec[_0x161a0a(0x171)][_0x161a0a(0x117)]];const _0x3e03df=_0x452eeb[_0x161a0a(0xc2)](_0x5c5ac2=>{return _0x5c5ac2={'product_name':_0x5c5ac2};});_0x16c54b[_0x161a0a(0x11a)]((_0x5ec32e,_0x4e664d)=>{var _0x2a42f5=_0x161a0a;_0x3e03df[_0x4e664d][_0x2a42f5(0xad)]=_0x5ec32e;}),_0x4fe1bf[_0x161a0a(0x11a)]((_0x28b37d,_0xae0c42)=>{var _0x38cc21=_0x161a0a;_0x3e03df[_0xae0c42][_0x38cc21(0xf3)]=_0x28b37d;}),_0x48de73[_0x161a0a(0x11a)]((_0x2297f2,_0xd3bfbf)=>{_0x3e03df[_0xd3bfbf]['from_bin']=_0x2297f2;}),_0x54b8c6[_0x161a0a(0x11a)]((_0x5eb525,_0x453f4f)=>{_0x3e03df[_0x453f4f]['from_floorlevel']=_0x5eb525;}),_0x462162['forEach']((_0x194ddf,_0x2f2b48)=>{_0x3e03df[_0x2f2b48]['to_quantity']=_0x194ddf;}),_0x3b5247[_0x161a0a(0x11a)]((_0x50a793,_0x24ac50)=>{var _0x489532=_0x161a0a;_0x3e03df[_0x24ac50][_0x489532(0xa6)]=_0x50a793;}),_0x142fbf[_0x161a0a(0x11a)]((_0xe0fdbc,_0x4e9062)=>{var _0x191b11=_0x161a0a;_0x3e03df[_0x4e9062][_0x191b11(0x114)]=_0xe0fdbc;}),_0x2b0743[_0x161a0a(0x11a)]((_0x435f3d,_0x588445)=>{_0x3e03df[_0x588445]['to_floorlevel']=_0x435f3d;}),_0x1b3a0e['forEach']((_0x498b0a,_0x319e37)=>{var _0xeb8152=_0x161a0a;_0x3e03df[_0x319e37][_0xeb8152(0xc7)]=_0x498b0a;}),_0x2cafd2['forEach']((_0x444fc5,_0x54eeea)=>{var _0x36cc12=_0x161a0a;_0x3e03df[_0x54eeea][_0x36cc12(0x109)]=_0x444fc5;}),_0x5a369c['forEach']((_0x416d0c,_0x2e3190)=>{var _0xd606d5=_0x161a0a;_0x3e03df[_0x2e3190][_0xd606d5(0xc0)]=_0x416d0c;}),_0x4140f9[_0x161a0a(0x11a)]((_0x4727fe,_0x373f15)=>{var _0x4915a3=_0x161a0a;_0x3e03df[_0x373f15][_0x4915a3(0x178)]=_0x4727fe;}),_0x1fe8f0[_0x161a0a(0x11a)]((_0x261968,_0x5ecbab)=>{var _0x200a92=_0x161a0a;_0x3e03df[_0x5ecbab][_0x200a92(0xbf)]=_0x261968;}),_0x24db88[_0x161a0a(0x11a)]((_0x2351b2,_0xe8f1d2)=>{var _0x5702f6=_0x161a0a;_0x3e03df[_0xe8f1d2][_0x5702f6(0xc9)]=_0x2351b2;}),_0x47b994['forEach']((_0x410893,_0xc1285d)=>{_0x3e03df[_0xc1285d]['batch_code']=_0x410893;}),_0x426490['forEach']((_0x42d628,_0x23056a)=>{_0x3e03df[_0x23056a]['expiry_date']=_0x42d628;}),_0x1b98bb['forEach']((_0x518eeb,_0x46bd0b)=>{var _0x4ee515=_0x161a0a;_0x3e03df[_0x46bd0b][_0x4ee515(0xeb)]=_0x518eeb;}),_0x3080dc[_0x161a0a(0x11a)]((_0x142ac0,_0x281801)=>{_0x3e03df[_0x281801]['rack']=_0x142ac0;}),_0x4ff11c['forEach']((_0x3f2b12,_0xe3505)=>{var _0x49ce0b=_0x161a0a;_0x3e03df[_0xe3505][_0x49ce0b(0x139)]=_0x3f2b12;}),_0x37c0d2[_0x161a0a(0x11a)]((_0x37a0f4,_0x5b9b90)=>{var _0x2e0207=_0x161a0a;_0x3e03df[_0x5b9b90][_0x2e0207(0x152)]=_0x37a0f4;}),_0x57eccd[_0x161a0a(0x11a)]((_0x169bc7,_0x56925b)=>{var _0x8dd324=_0x161a0a;_0x3e03df[_0x56925b][_0x8dd324(0xf5)]=_0x169bc7;}),_0x1aee97[_0x161a0a(0x11a)]((_0x29b8a1,_0x4f73d0)=>{var _0x4ad6f0=_0x161a0a;_0x3e03df[_0x4f73d0][_0x4ad6f0(0x96)]=_0x29b8a1;});const _0x2b0857=_0x3e03df['filter'](_0x42f3d3=>_0x42f3d3['to_quantity']!=='0'&&_0x42f3d3[_0x161a0a(0xc4)]!==''||_0x42f3d3[_0x161a0a(0x108)]!=='0'&&_0x42f3d3[_0x161a0a(0x108)]!=='');var _0x4c84a5=0x0;_0x2b0857['forEach'](_0x1fa64b=>{var _0x129dd8=_0x161a0a;parseInt(_0x1fa64b['from_quantity'])<parseInt(_0x1fa64b[_0x129dd8(0xc4)])&&_0x4c84a5++;});if(_0x4c84a5!=0x0)return _0x52d3ec[_0x161a0a(0x10a)](_0x161a0a(0xa4),_0x161a0a(0x175)),_0x5abccc[_0x161a0a(0x128)](_0x161a0a(0xdf));const _0x41cb7b=await warehouse[_0x161a0a(0x138)]({'name':_0x1435b6[_0x161a0a(0xb7)],'room':_0x1435b6[_0x161a0a(0xff)]});_0x1435b6[_0x161a0a(0x133)][_0x161a0a(0x11a)](_0xf438d5=>{var _0x107e8a=_0x161a0a;if(_0xf438d5[_0x107e8a(0xc4)]>0x0){const _0x22586b=_0x41cb7b['product_details']['map'](_0x6761dc=>{var _0x50b6e4=_0x107e8a;_0x6761dc[_0x50b6e4(0x10f)]==_0xf438d5['product_name']&&_0x6761dc[_0x50b6e4(0x130)]==_0xf438d5[_0x50b6e4(0x145)]&&_0x6761dc['type']==_0xf438d5[_0x50b6e4(0x139)]&&_0x6761dc[_0x50b6e4(0xfb)]==_0xf438d5[_0x50b6e4(0x95)]&&_0x6761dc['bay']==_0xf438d5[_0x50b6e4(0xf3)]&&_0x6761dc[_0x50b6e4(0x172)]==_0xf438d5[_0x50b6e4(0x96)]&&_0x6761dc[_0x50b6e4(0xeb)]==_0xf438d5[_0x50b6e4(0xf5)]&&(_0x6761dc['product_stock']=parseInt(_0x6761dc[_0x50b6e4(0x17c)])+parseInt(_0xf438d5['to_quantity']));});}}),await _0x41cb7b[_0x161a0a(0xf0)]();const _0x4572a4=await warehouse[_0x161a0a(0x138)]({'name':_0x1435b6[_0x161a0a(0xf4)],'room':_0x1435b6['to_room']});_0x1435b6[_0x161a0a(0x133)][_0x161a0a(0x11a)](_0x58a37b=>{var _0x2a7436=_0x161a0a;if(_0x58a37b[_0x2a7436(0xc4)]>0x0){const _0x43f8ee=_0x4572a4[_0x2a7436(0xfd)]['map'](_0x56bf14=>{var _0xca51fa=_0x2a7436;_0x56bf14[_0xca51fa(0x10f)]==_0x58a37b[_0xca51fa(0x10f)]&&_0x56bf14['floorlevel']==_0x58a37b['to_floorlevel']&&_0x56bf14[_0xca51fa(0xc5)]==_0x58a37b['to_types']&&_0x56bf14[_0xca51fa(0xfb)]==_0x58a37b['to_bin']&&_0x56bf14[_0xca51fa(0x137)]==_0x58a37b[_0xca51fa(0xa6)]&&_0x56bf14['rack']==_0x58a37b[_0xca51fa(0x172)]&&_0x56bf14['storage']==_0x58a37b[_0xca51fa(0xeb)]&&(_0x56bf14[_0xca51fa(0x17c)]=parseInt(_0x56bf14['product_stock'])-parseInt(_0x58a37b[_0xca51fa(0xc4)]));});}}),await _0x4572a4['save'](),_0x1435b6['date']=_0xf88dd8,_0x1435b6[_0x161a0a(0xb7)]=_0x2ce0e2,_0x1435b6[_0x161a0a(0xf4)]=_0x53209d,_0x1435b6[_0x161a0a(0x133)]=_0x2b0857,_0x1435b6[_0x161a0a(0xe1)]=_0x5f51d0,_0x1435b6[_0x161a0a(0xfe)]=_0x2964e3;const _0x155d59=await _0x1435b6['save']();console[_0x161a0a(0x9c)](_0x155d59);const _0x2ef860=await warehouse['findOne']({'name':_0x2ce0e2,'room':_0x52ea1d});_0x155d59[_0x161a0a(0x133)]['forEach'](_0x2cdfb3=>{var _0x478d18=_0x161a0a;if(_0x2cdfb3[_0x478d18(0xc4)]>0x0){const _0x2a039a=_0x2ef860[_0x478d18(0xfd)][_0x478d18(0xc2)](_0x37e853=>{var _0x5701a7=_0x478d18;_0x37e853[_0x5701a7(0x10f)]==_0x2cdfb3[_0x5701a7(0x10f)]&&_0x37e853[_0x5701a7(0x130)]==_0x2cdfb3[_0x5701a7(0x145)]&&_0x37e853['type']==_0x2cdfb3[_0x5701a7(0x139)]&&_0x37e853[_0x5701a7(0xfb)]==_0x2cdfb3[_0x5701a7(0x95)]&&_0x37e853[_0x5701a7(0x137)]==_0x2cdfb3[_0x5701a7(0xf3)]&&_0x37e853['rack']==_0x2cdfb3[_0x5701a7(0x96)]&&_0x37e853[_0x5701a7(0xeb)]==_0x2cdfb3[_0x5701a7(0xf5)]&&(_0x37e853[_0x5701a7(0x17c)]=parseInt(_0x37e853['product_stock'])-parseInt(_0x2cdfb3[_0x5701a7(0xc4)]));});}}),await _0x2ef860['save']();const _0x4f0d26=await warehouse[_0x161a0a(0x138)]({'name':_0x53209d,'room':_0x4dc4f2});_0x155d59[_0x161a0a(0x133)][_0x161a0a(0x11a)](_0x370613=>{var _0x44e557=_0x161a0a;if(_0x370613['to_quantity']>0x0){var _0x1582c5=0x0;const _0x4e8474=_0x4f0d26[_0x44e557(0xfd)]['map'](_0x274975=>{var _0xc536cb=_0x44e557;_0x274975[_0xc536cb(0x10f)]==_0x370613['product_name']&&_0x274975[_0xc536cb(0x130)]==_0x370613['to_floorlevel']&&_0x274975[_0xc536cb(0xc5)]==_0x370613[_0xc536cb(0x152)]&&_0x274975[_0xc536cb(0xfb)]==_0x370613['to_bin']&&_0x274975[_0xc536cb(0x137)]==_0x370613[_0xc536cb(0xa6)]&&_0x274975[_0xc536cb(0x172)]==_0x370613[_0xc536cb(0x172)]&&_0x274975[_0xc536cb(0xeb)]==_0x370613[_0xc536cb(0xeb)]&&(_0x274975[_0xc536cb(0x17c)]=parseInt(_0x274975[_0xc536cb(0x17c)])+parseInt(_0x370613['to_quantity']),_0x1582c5++);});_0x1582c5=='0'&&(_0x4f0d26['product_details']=_0x4f0d26[_0x44e557(0xfd)][_0x44e557(0xbc)]({'product_name':_0x370613[_0x44e557(0x10f)],'product_stock':_0x370613[_0x44e557(0xc4)],'bay':_0x370613[_0x44e557(0xa6)],'bin':_0x370613[_0x44e557(0x114)],'type':_0x370613[_0x44e557(0x152)],'floorlevel':_0x370613[_0x44e557(0x108)],'storage':_0x370613['storage'],'rack':_0x370613[_0x44e557(0x172)],'product_code':_0x370613[_0x44e557(0xc0)],'primary_code':_0x370613['primary_code'],'secondary_code':_0x370613['secondary_code'],'maxProducts':_0x370613[_0x44e557(0x178)],'storage':_0x370613[_0x44e557(0xeb)],'rack':_0x370613[_0x44e557(0x172)]}));}}),await _0x4f0d26[_0x161a0a(0xf0)](),_0x52d3ec[_0x161a0a(0x10a)](_0x161a0a(0xf6),'Transfer\x20Edit\x20Successfully'),_0x5abccc['redirect'](_0x161a0a(0x103));}catch(_0x2ef18e){console[_0x161a0a(0x9c)](_0x2ef18e);}}),router[a0_0x3c2cb7(0x115)](a0_0x3c2cb7(0x101),async(_0x4a0f07,_0x13e8e3)=>{var _0x1bcfe9=a0_0x3c2cb7;const {FromWareHouse:_0xf7f19c,FromRoom:_0x582e1f,ToWarehouse:_0x4e1016,ToRoom:_0x1a13e8,primary_code:_0x12ad7d,Roomslist:_0x5dc122}=_0x4a0f07[_0x1bcfe9(0x171)],_0x5cf33a=_0x5dc122[_0x1bcfe9(0xba)](','),_0x50639c=[];async function _0x25ec91(_0x936e68){var _0x3933d4=_0x1bcfe9;const _0x4cab46=await warehouse[_0x3933d4(0x158)]([{'$match':{'name':_0xf7f19c,'room':_0x936e68}},{'$unwind':_0x3933d4(0xda)},{'$match':{'product_details.primary_code':_0x12ad7d}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3933d4(0x99)},'instock':{'$first':_0x3933d4(0x156)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3933d4(0x12c)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3933d4(0x149)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3933d4(0xae)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3933d4(0x120)},'production_date':{'$first':_0x3933d4(0x98)},'batch_code':{'$first':_0x3933d4(0xb3)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]),_0x108053=await warehouse[_0x3933d4(0x158)]([{'$match':{'name':_0xf7f19c,'room':_0x936e68}},{'$unwind':_0x3933d4(0xda)},{'$match':{'product_details.secondary_code':_0x12ad7d}},{'$group':{'_id':_0x3933d4(0x164),'name':{'$first':_0x3933d4(0x99)},'instock':{'$first':_0x3933d4(0x156)},'primary_code':{'$first':_0x3933d4(0x13f)},'secondary_code':{'$first':_0x3933d4(0x12c)},'product_code':{'$first':_0x3933d4(0xaf)},'level':{'$first':_0x3933d4(0xfc)},'isle':{'$first':_0x3933d4(0x149)},'type':{'$first':_0x3933d4(0x9d)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3933d4(0x113)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3933d4(0xae)},'rack':{'$first':_0x3933d4(0x11b)},'expiry_date':{'$first':_0x3933d4(0x120)},'production_date':{'$first':_0x3933d4(0x98)},'batch_code':{'$first':_0x3933d4(0xb3)},'maxPerUnit':{'$first':_0x3933d4(0x166)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x3933d4(0x15e)},'maxProducts':{'$first':_0x3933d4(0xe4)}}}]);if(_0x4cab46[_0x3933d4(0x177)]>0x0)_0x50639c[_0x3933d4(0x9b)](_0x4cab46);else _0x108053[_0x3933d4(0x177)]>0x0&&_0x50639c[_0x3933d4(0x9b)](_0x108053);}const _0x744b40=_0x5cf33a[_0x1bcfe9(0xc2)](_0x5d5ec6=>_0x25ec91(_0x5d5ec6));await Promise[_0x1bcfe9(0xa7)](_0x744b40),_0x13e8e3[_0x1bcfe9(0x112)](_0x50639c);}),router[a0_0x3c2cb7(0x115)](a0_0x3c2cb7(0x119),async(_0x288e4a,_0x475767)=>{var _0x2f56de=a0_0x3c2cb7;try{const {FromWareHouse:_0x1cd6dc,FromRoom:_0x3dfc7d,ToWarehouse:_0x1c6e65,ToRoom:_0x3ad915,secondary_code:_0x59e8bb}=_0x288e4a['body'],_0x4b4ed7=await warehouse[_0x2f56de(0x158)]([{'$match':{'name':_0x1cd6dc}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x59e8bb}},{'$group':{'_id':_0x2f56de(0x164),'name':{'$first':_0x2f56de(0x99)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2f56de(0x12c)},'product_code':{'$first':_0x2f56de(0xaf)},'instock':{'$first':_0x2f56de(0x156)},'warehouse':{'$first':_0x2f56de(0x13d)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x2f56de(0x121)},'pallet':{'$first':_0x2f56de(0x134)},'maxProducts':{'$first':_0x2f56de(0xe4)},'unit':{'$first':'$product_details.unit'}}}]);_0x475767[_0x2f56de(0xb6)](0xc8)[_0x2f56de(0x112)](_0x4b4ed7);}catch(_0x151256){_0x475767[_0x2f56de(0xb6)](0x194)[_0x2f56de(0x112)]({'message':_0x151256[_0x2f56de(0x126)]});}}),router[a0_0x3c2cb7(0x115)](a0_0x3c2cb7(0x105),async(_0x1af064,_0x49fee9)=>{var _0x5b4f71=a0_0x3c2cb7;try{const {FromWareHouse:_0x487ed5,FromRoom:_0x14296c,ToWarehouse:_0x5123ed,ToRoom:_0x462e4d,product_code:_0x1cf701}=_0x1af064[_0x5b4f71(0x171)],_0x207c99=await warehouse[_0x5b4f71(0x158)]([{'$match':{'name':_0x487ed5}},{'$unwind':_0x5b4f71(0xda)},{'$match':{'product_details.product_code':_0x1cf701}},{'$group':{'_id':_0x5b4f71(0x164),'name':{'$first':_0x5b4f71(0x99)},'primary_code':{'$first':_0x5b4f71(0x13f)},'secondary_code':{'$first':_0x5b4f71(0x12c)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x5b4f71(0x13d)},'level':{'$first':_0x5b4f71(0xcb)},'isle':{'$first':_0x5b4f71(0x121)},'pallet':{'$first':_0x5b4f71(0x134)},'maxProducts':{'$first':_0x5b4f71(0xe4)},'unit':{'$first':_0x5b4f71(0x113)}}}]);_0x49fee9[_0x5b4f71(0xb6)](0xc8)['json'](_0x207c99);}catch(_0x3bcfd1){_0x49fee9[_0x5b4f71(0xb6)](0x194)[_0x5b4f71(0x112)]({'message':_0x3bcfd1[_0x5b4f71(0x126)]});}}),router[a0_0x3c2cb7(0x115)]('/CheckingWarehouse',async(_0x4b64ab,_0x365305)=>{var _0x506bd6=a0_0x3c2cb7;const {level:_0xc60642,isle:_0x3efb72,pallet:_0x305381,warehouses:_0x4c5b13,room:_0x4eca97}=_0x4b64ab[_0x506bd6(0x171)];try{const _0x2fa542=await warehouse['aggregate']([{'$match':{'name':_0x4c5b13,'room':_0x4eca97}},{'$unwind':_0x506bd6(0xda)},{'$match':{'product_details.level':parseInt(_0xc60642),'product_details.isle':_0x3efb72,'product_details.pallet':parseInt(_0x305381)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x506bd6(0x99)},'product_stock':{'$first':_0x506bd6(0x156)},'level':{'$first':_0x506bd6(0xcb)},'isle':{'$first':_0x506bd6(0x121)},'pallet':{'$first':_0x506bd6(0x134)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x365305[_0x506bd6(0xb6)](0xc8)[_0x506bd6(0x112)](_0x2fa542);}catch(_0x441193){_0x365305[_0x506bd6(0xb6)](0x194)[_0x506bd6(0x112)]({'message':_0x441193[_0x506bd6(0x126)]});}}),module[a0_0x3c2cb7(0xc3)]=router;