var a0_0x5ead96=a0_0x53dd;function a0_0x53dd(_0x531a49,_0xae3ffa){var _0x43cef7=a0_0x43ce();return a0_0x53dd=function(_0x53ddf2,_0x2703a9){_0x53ddf2=_0x53ddf2-0x1c1;var _0x4fed00=_0x43cef7[_0x53ddf2];return _0x4fed00;},a0_0x53dd(_0x531a49,_0xae3ffa);}(function(_0x52ff73,_0x2ee587){var _0x50fa7c=a0_0x53dd,_0x52efbe=_0x52ff73();while(!![]){try{var _0x1c868b=parseInt(_0x50fa7c(0x21d))/0x1+parseInt(_0x50fa7c(0x29b))/0x2*(-parseInt(_0x50fa7c(0x28f))/0x3)+parseInt(_0x50fa7c(0x266))/0x4*(parseInt(_0x50fa7c(0x2be))/0x5)+parseInt(_0x50fa7c(0x1f6))/0x6*(-parseInt(_0x50fa7c(0x1d2))/0x7)+-parseInt(_0x50fa7c(0x256))/0x8+-parseInt(_0x50fa7c(0x27f))/0x9*(-parseInt(_0x50fa7c(0x238))/0xa)+parseInt(_0x50fa7c(0x251))/0xb*(parseInt(_0x50fa7c(0x261))/0xc);if(_0x1c868b===_0x2ee587)break;else _0x52efbe['push'](_0x52efbe['shift']());}catch(_0x476bf0){_0x52efbe['push'](_0x52efbe['shift']());}}}(a0_0x43ce,0xdfa7e),require(a0_0x5ead96(0x2a6))[a0_0x5ead96(0x2a4)]());const express=require(a0_0x5ead96(0x28b)),app=express(),router=express[a0_0x5ead96(0x28c)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x5ead96(0x22d)),auth=require(a0_0x5ead96(0x290)),users=require(a0_0x5ead96(0x209)),nodemailer=require('nodemailer'),mongoose=require(a0_0x5ead96(0x1df));router[a0_0x5ead96(0x236)](a0_0x5ead96(0x2ae),auth,async(_0x735097,_0x34a5d5)=>{var _0x59b277=a0_0x5ead96;try{const {username:_0x45b5cd,email:_0x330a5e,role:_0x5808d1}=_0x735097[_0x59b277(0x24d)],_0x260571=_0x735097[_0x59b277(0x24d)],_0x5810b8=await profile[_0x59b277(0x2b9)]({'email':_0x260571[_0x59b277(0x1e1)]}),_0x3047f3=await master_shop[_0x59b277(0x1c2)]();console[_0x59b277(0x1d0)](_0x59b277(0x21c),_0x3047f3);let _0x115018;if(_0x260571[_0x59b277(0x1ed)]==_0x59b277(0x210)){const _0x213209=await staff[_0x59b277(0x2b9)]({'email':_0x260571[_0x59b277(0x1e1)]});_0x115018=await transfers[_0x59b277(0x1c2)]({'from_warehouse':_0x213209['warehouse']});}else _0x115018=await transfers[_0x59b277(0x22f)]([{'$unwind':'$product'},{'$group':{'_id':_0x59b277(0x1c1),'invoice':{'$first':_0x59b277(0x244)},'date':{'$first':_0x59b277(0x20b)},'from_warehouse':{'$first':_0x59b277(0x2a3)},'to_warehouse':{'$first':_0x59b277(0x279)},'from_room_name':{'$addToSet':_0x59b277(0x1ea)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x59b277(0x234)},'isAllowEdit':{'$first':_0x59b277(0x270)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3047f3[0x0][_0x59b277(0x1c6)]==_0x59b277(0x2a7)){var _0x5062d0=users['English'];console[_0x59b277(0x1d0)](_0x5062d0);}else{if(_0x3047f3[0x0][_0x59b277(0x1c6)]==_0x59b277(0x20f))var _0x5062d0=users[_0x59b277(0x20f)];else{if(_0x3047f3[0x0][_0x59b277(0x1c6)]==_0x59b277(0x22e))var _0x5062d0=users[_0x59b277(0x22e)];else{if(_0x3047f3[0x0]['language']==_0x59b277(0x237))var _0x5062d0=users['Spanish'];else{if(_0x3047f3[0x0]['language']==_0x59b277(0x284))var _0x5062d0=users[_0x59b277(0x284)];else{if(_0x3047f3[0x0]['language']==_0x59b277(0x21e))var _0x5062d0=users['Portuguese'];else{if(_0x3047f3[0x0][_0x59b277(0x1c6)]==_0x59b277(0x26b))var _0x5062d0=users[_0x59b277(0x26b)];else{if(_0x3047f3[0x0][_0x59b277(0x1c6)]==_0x59b277(0x1f2))var _0x5062d0=users['Arabic'];}}}}}}}_0x34a5d5[_0x59b277(0x1e0)]('transfer',{'success':_0x735097[_0x59b277(0x27b)](_0x59b277(0x233)),'errors':_0x735097[_0x59b277(0x27b)]('errors'),'role':_0x260571,'profile':_0x5810b8,'master_shop':_0x3047f3,'transfer':_0x115018,'language':_0x5062d0});}catch(_0xa6d454){console[_0x59b277(0x1d0)](_0xa6d454);}});async function getRandom8DigitNumber(){var _0x1759d7=a0_0x5ead96;const _0x14ea6a=0x989680,_0x38bdeb=0x5f5e0ff,_0xa3b0b8=Math[_0x1759d7(0x25e)](Math[_0x1759d7(0x2c0)]()*(_0x38bdeb-_0x14ea6a+0x1))+_0x14ea6a;var _0x2dbc85;const _0x25a6a6=await transfers['findOne']({'invoice':_0x1759d7(0x28e)+_0xa3b0b8});return _0x25a6a6&&_0x25a6a6['length']>0x0?_0x2dbc85=_0x1759d7(0x28e)+_0xa3b0b8:_0x2dbc85=_0x1759d7(0x28e)+_0xa3b0b8,_0x2dbc85;}router[a0_0x5ead96(0x236)](a0_0x5ead96(0x214),auth,async(_0xea0afe,_0x2df509)=>{var _0x136f9c=a0_0x5ead96;try{const {username:_0x3e119a,email:_0x80135f,role:_0x27ce07}=_0xea0afe['user'],_0x94eeae=_0xea0afe['user'],_0x16a861=await profile[_0x136f9c(0x2b9)]({'email':_0x94eeae[_0x136f9c(0x1e1)]}),_0x2b0d24=await master_shop[_0x136f9c(0x1c2)]();console[_0x136f9c(0x1d0)](_0x136f9c(0x21c),_0x2b0d24);let _0x5bb9dd;if(_0x94eeae[_0x136f9c(0x1ed)]==_0x136f9c(0x210)){const _0x1c3c79=await staff[_0x136f9c(0x2b9)]({'email':_0x94eeae[_0x136f9c(0x1e1)]});_0x5bb9dd=await warehouse[_0x136f9c(0x22f)]([{'$match':{'status':_0x136f9c(0x29e),'name':_0x1c3c79['warehouse'],'warehouse_category':_0x136f9c(0x2b3)}},{'$group':{'_id':'$name','name':{'$first':_0x136f9c(0x1d7)}}}]);}else _0x5bb9dd=await warehouse['aggregate']([{'$match':{'status':_0x136f9c(0x29e),'warehouse_category':_0x136f9c(0x2b3)}},{'$group':{'_id':'$name','name':{'$first':_0x136f9c(0x1d7)}}}]);var _0x13d737=[_0x136f9c(0x29c),_0x136f9c(0x1ca),_0x136f9c(0x1c7)];const _0x3ec476=await transfers[_0x136f9c(0x1c2)]({}),_0x493ede=_0x3ec476['length']+0x1,_0xd81a36=_0x136f9c(0x28e)+_0x493ede[_0x136f9c(0x1d6)]()[_0x136f9c(0x227)](0x5,'0');if(_0x2b0d24[0x0][_0x136f9c(0x1c6)]==_0x136f9c(0x2a7)){var _0x3f828f=users[_0x136f9c(0x2b0)];console[_0x136f9c(0x1d0)](_0x3f828f);}else{if(_0x2b0d24[0x0]['language']==_0x136f9c(0x20f))var _0x3f828f=users[_0x136f9c(0x20f)];else{if(_0x2b0d24[0x0][_0x136f9c(0x1c6)]=='German')var _0x3f828f=users['German'];else{if(_0x2b0d24[0x0]['language']=='Spanish')var _0x3f828f=users[_0x136f9c(0x237)];else{if(_0x2b0d24[0x0][_0x136f9c(0x1c6)]==_0x136f9c(0x284))var _0x3f828f=users[_0x136f9c(0x284)];else{if(_0x2b0d24[0x0][_0x136f9c(0x1c6)]==_0x136f9c(0x21e))var _0x3f828f=users[_0x136f9c(0x297)];else{if(_0x2b0d24[0x0]['language']==_0x136f9c(0x26b))var _0x3f828f=users[_0x136f9c(0x26b)];else{if(_0x2b0d24[0x0][_0x136f9c(0x1c6)]=='Arabic\x20(ae)')var _0x3f828f=users['Arabic'];}}}}}}}const _0x1368fe=getRandom8DigitNumber();_0x1368fe[_0x136f9c(0x1fc)](_0xa9aa5c=>{var _0x5eac5d=_0x136f9c;_0x2df509[_0x5eac5d(0x1e0)](_0x5eac5d(0x262),{'success':_0xea0afe[_0x5eac5d(0x27b)](_0x5eac5d(0x233)),'errors':_0xea0afe[_0x5eac5d(0x27b)]('errors'),'role':_0x94eeae,'profile':_0x16a861,'master_shop':_0x2b0d24,'warehouse':_0x5bb9dd,'language':_0x3f828f,'rooms_data':_0x13d737,'invoice':_0xa9aa5c});})[_0x136f9c(0x1cd)](_0x182b8e=>{var _0x433b64=_0x136f9c;_0xea0afe[_0x433b64(0x27b)](_0x433b64(0x2c1),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2df509[_0x433b64(0x268)](_0x433b64(0x208));});}catch(_0x3e9e89){console[_0x136f9c(0x1d0)](_0x3e9e89);}}),router[a0_0x5ead96(0x299)](a0_0x5ead96(0x214),auth,async(_0x2f8ed0,_0x393395)=>{var _0x87a03e=a0_0x5ead96;try{console[_0x87a03e(0x1d0)](_0x2f8ed0[_0x87a03e(0x232)]);const {date:_0x36ccbc,from_warehouse:_0x29282b,FromRoom_name:_0xec3d75,to_warehouse:_0x573d59,ToRoom_name:_0x28ee84,prod_name:_0x33e9ae,from_prod_qty:_0x4dc11d,from_prod_level:_0x3bc506,from_prod_isle:_0x3f2a00,from_prod_pallet:_0x3bfd91,to_prod_qty:_0x472ec2,to_prod_level:_0x170f61,to_prod_isle:_0x454835,to_prod_pallet:_0x24deb1,primary_code:_0x3946c0,secondary_code:_0x509ee6,product_code3:_0x94e592,note:_0x3dd470,MaxStocks_data2:_0x361c46,invoice:_0x532f8e,expiry_date:_0x25d140}=_0x2f8ed0['body'];if(typeof _0x33e9ae==_0x87a03e(0x26f))var _0x13786e=[_0x2f8ed0['body'][_0x87a03e(0x226)]],_0x2bc208=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x1f1)]],_0x1b3243=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x23b)]],_0x431afe=[_0x2f8ed0[_0x87a03e(0x232)]['New_Qty_Converted']],_0x26f591=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x206)]],_0x4a13d7=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2bf)]],_0x260871=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x269)]],_0x1e3c24=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2a1)]],_0x4593fe=[_0x2f8ed0['body']['MaxStocks_data2']],_0x1d94db=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x25a)]],_0x2c9e14=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2a2)]],_0x1e8ed2=[_0x2f8ed0[_0x87a03e(0x232)]['batch_code']],_0x374fbe=[_0x2f8ed0['body'][_0x87a03e(0x263)]],_0x1a8923=[_0x2f8ed0[_0x87a03e(0x232)]['max_per_unit']],_0x8eb430=[_0x2f8ed0[_0x87a03e(0x232)]['production_date']],_0x39742d=[_0x2f8ed0['body'][_0x87a03e(0x293)]],_0x1f06c6=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x287)]],_0x35a679=[_0x2f8ed0[_0x87a03e(0x232)]['ToRoomAssigned']],_0xbfddd1=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2a0)]],_0x7e3b44=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x221)]],_0x599f71=[_0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x264)]];else var _0x13786e=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x226)]],_0x2bc208=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x1f1)]],_0x1b3243=[..._0x2f8ed0['body'][_0x87a03e(0x23b)]],_0x431afe=[..._0x2f8ed0['body'][_0x87a03e(0x272)]],_0x26f591=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x206)]],_0x4a13d7=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2bf)]],_0x260871=[..._0x2f8ed0['body']['secondary_code']],_0x1e3c24=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2a1)]],_0x4593fe=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x298)]],_0x1d94db=[..._0x2f8ed0[_0x87a03e(0x232)]['primary_unit']],_0x2c9e14=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2a2)]],_0x1e8ed2=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x294)]],_0x374fbe=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x263)]],_0x1a8923=[..._0x2f8ed0[_0x87a03e(0x232)]['max_per_unit']],_0x8eb430=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x1d1)]],_0x39742d=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x293)]],_0x1f06c6=[..._0x2f8ed0['body'][_0x87a03e(0x287)]],_0x35a679=[..._0x2f8ed0[_0x87a03e(0x232)]['ToRoomAssigned']],_0xbfddd1=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x2a0)]],_0x7e3b44=[..._0x2f8ed0[_0x87a03e(0x232)][_0x87a03e(0x221)]],_0x599f71=[..._0x2f8ed0[_0x87a03e(0x232)]['id_transaction']];const _0x736d77=_0x13786e['map'](_0x5c8d73=>{return _0x5c8d73={'product_name':_0x5c8d73};});_0x2bc208['forEach']((_0x54d38d,_0x4d2224)=>{var _0x2f04c4=_0x87a03e;_0x736d77[_0x4d2224][_0x2f04c4(0x246)]=_0x54d38d;}),_0xbfddd1[_0x87a03e(0x205)]((_0x516788,_0x19cecf)=>{var _0x40e076=_0x87a03e;_0x736d77[_0x19cecf][_0x40e076(0x2a0)]=_0x516788;}),_0x7e3b44[_0x87a03e(0x205)]((_0x57b4db,_0x2cb701)=>{var _0x56a81c=_0x87a03e;_0x736d77[_0x2cb701][_0x56a81c(0x288)]=_0x57b4db;}),_0x599f71['forEach']((_0x3367f0,_0x16be76)=>{var _0x58c459=_0x87a03e;_0x736d77[_0x16be76][_0x58c459(0x25d)]=_0x3367f0;}),_0x1b3243[_0x87a03e(0x205)]((_0x453bc6,_0x4a84d8)=>{var _0x498743=_0x87a03e;_0x1f06c6[_0x498743(0x205)]((_0x254171,_0x5396e2)=>{var _0x5943b0=_0x498743;if(_0x254171==_0x5943b0(0x281)&&_0x4a84d8==_0x5396e2){var _0x25ca1f=_0x453bc6[_0x5943b0(0x280)](0x3);_0x736d77[_0x4a84d8][_0x5943b0(0x2ac)]=_0x453bc6[0x0],_0x736d77[_0x4a84d8]['from_rack']=_0x453bc6[0x1],_0x736d77[_0x4a84d8][_0x5943b0(0x2a8)]=0x0,_0x736d77[_0x4a84d8][_0x5943b0(0x1ec)]=0x0,_0x736d77[_0x4a84d8][_0x5943b0(0x1e8)]=_0x5943b0(0x243),_0x736d77[_0x4a84d8]['from_floorlevel']=_0x25ca1f;}else{if(_0x254171=='Shelves'&&_0x4a84d8==_0x5396e2){var _0x25ca1f=_0x453bc6[_0x5943b0(0x280)](0x3);_0x736d77[_0x4a84d8][_0x5943b0(0x2ac)]=_0x453bc6[0x0],_0x736d77[_0x4a84d8][_0x5943b0(0x240)]=_0x453bc6[0x1],_0x736d77[_0x4a84d8]['from_bay']=0x0,_0x736d77[_0x4a84d8][_0x5943b0(0x1ec)]=0x0,_0x736d77[_0x4a84d8][_0x5943b0(0x1e8)]=_0x5943b0(0x243),_0x736d77[_0x4a84d8][_0x5943b0(0x228)]=_0x453bc6[0x5];}else{if(_0x4a84d8==_0x5396e2){if(_0x453bc6[0x0]=='A'&&_0x453bc6[0x1]=='L'&&_0x453bc6[0x2]=='L')console['log'](_0x254171+_0x5943b0(0x242)+_0x4a84d8+_0x5943b0(0x242)+_0x5396e2+_0x5943b0(0x242)+_0x453bc6+_0x5943b0(0x231)),_0x736d77[_0x4a84d8][_0x5943b0(0x2ac)]=_0x453bc6[0x0],_0x736d77[_0x4a84d8][_0x5943b0(0x240)]=_0x453bc6[0x1],_0x736d77[_0x4a84d8][_0x5943b0(0x2a8)]=0x0,_0x736d77[_0x4a84d8][_0x5943b0(0x1ec)]=0x0,_0x736d77[_0x4a84d8][_0x5943b0(0x1e8)]=_0x5943b0(0x243),_0x736d77[_0x4a84d8][_0x5943b0(0x228)]=_0x453bc6[0x3];else{var _0x5cd28e;if(_0x453bc6[0x4]=='L')_0x5cd28e=_0x5943b0(0x26d);else _0x453bc6[0x4]=='F'&&(_0x5cd28e=_0x5943b0(0x243));_0x736d77[_0x4a84d8]['from_storage']=_0x453bc6[0x0],_0x736d77[_0x4a84d8][_0x5943b0(0x240)]=_0x453bc6[0x1],_0x736d77[_0x4a84d8][_0x5943b0(0x2a8)]=_0x453bc6[0x2],_0x736d77[_0x4a84d8][_0x5943b0(0x1ec)]=_0x453bc6[0x3],_0x736d77[_0x4a84d8][_0x5943b0(0x1e8)]=_0x5cd28e,_0x736d77[_0x4a84d8]['from_floorlevel']=_0x453bc6[0x5];}}}}});}),_0x431afe[_0x87a03e(0x205)]((_0x482e2c,_0x33644c)=>{var _0x1f4d41=_0x87a03e;_0x736d77[_0x33644c][_0x1f4d41(0x2ab)]=_0x482e2c;}),_0x26f591[_0x87a03e(0x205)]((_0x4a0f2d,_0x5c3936)=>{var _0x5301ba=_0x87a03e;_0x35a679[_0x5301ba(0x205)]((_0x2ae9d9,_0x4f2882)=>{var _0x55e00e=_0x5301ba;if(_0x2ae9d9==_0x55e00e(0x281)&&_0x5c3936==_0x4f2882){var _0x2aa1e0=_0x4a0f2d[_0x55e00e(0x280)](0x3);_0x736d77[_0x5c3936]['storage']=_0x4a0f2d[0x0],_0x736d77[_0x5c3936][_0x55e00e(0x2bc)]=_0x4a0f2d[0x1],_0x736d77[_0x5c3936][_0x55e00e(0x29a)]=0x0,_0x736d77[_0x5c3936][_0x55e00e(0x20d)]=0x0,_0x736d77[_0x5c3936]['to_types']=_0x55e00e(0x243),_0x736d77[_0x5c3936][_0x55e00e(0x255)]=_0x2aa1e0;}else{if(_0x2ae9d9=='Shelves'&&_0x5c3936==_0x4f2882){var _0x2aa1e0=_0x4a0f2d[_0x55e00e(0x280)](0x3);_0x736d77[_0x5c3936][_0x55e00e(0x285)]=_0x4a0f2d[0x0],_0x736d77[_0x5c3936][_0x55e00e(0x2bc)]=_0x4a0f2d[0x1],_0x736d77[_0x5c3936]['to_bay']=0x0,_0x736d77[_0x5c3936][_0x55e00e(0x20d)]=0x0,_0x736d77[_0x5c3936][_0x55e00e(0x1cf)]=_0x55e00e(0x243),_0x736d77[_0x5c3936]['to_floorlevel']=_0x4a0f2d[0x5];}else{if(_0x5c3936==_0x4f2882){if(_0x4a0f2d[0x0]=='A'&&_0x4a0f2d[0x1]=='L'&&_0x4a0f2d[0x2]=='L')console['log'](_0x2ae9d9+_0x55e00e(0x242)+_0x5c3936+_0x55e00e(0x242)+_0x4f2882+_0x55e00e(0x242)+_0x4a0f2d+_0x55e00e(0x231)),_0x736d77[_0x5c3936][_0x55e00e(0x285)]=_0x4a0f2d[0x0],_0x736d77[_0x5c3936][_0x55e00e(0x2bc)]=_0x4a0f2d[0x1],_0x736d77[_0x5c3936][_0x55e00e(0x29a)]=0x0,_0x736d77[_0x5c3936][_0x55e00e(0x20d)]=0x0,_0x736d77[_0x5c3936][_0x55e00e(0x1cf)]=_0x55e00e(0x243),_0x736d77[_0x5c3936]['to_floorlevel']=_0x4a0f2d[0x3];else{var _0x522066;if(_0x4a0f2d[0x4]=='L')_0x522066=_0x55e00e(0x26d);else _0x4a0f2d[0x4]=='F'&&(_0x522066=_0x55e00e(0x243));_0x736d77[_0x5c3936][_0x55e00e(0x285)]=_0x4a0f2d[0x0],_0x736d77[_0x5c3936][_0x55e00e(0x2bc)]=_0x4a0f2d[0x1],_0x736d77[_0x5c3936][_0x55e00e(0x29a)]=_0x4a0f2d[0x2],_0x736d77[_0x5c3936]['to_bin']=_0x4a0f2d[0x3],_0x736d77[_0x5c3936][_0x55e00e(0x1cf)]=_0x522066,_0x736d77[_0x5c3936][_0x55e00e(0x255)]=_0x4a0f2d[0x5];}}}}});}),_0x4a13d7[_0x87a03e(0x205)]((_0x19c2c6,_0x20e92c)=>{_0x736d77[_0x20e92c]['primary_code']=_0x19c2c6;}),_0x260871[_0x87a03e(0x205)]((_0x2e7c86,_0x1ff0c0)=>{var _0x4819c4=_0x87a03e;_0x736d77[_0x1ff0c0][_0x4819c4(0x269)]=_0x2e7c86;}),_0x1e3c24[_0x87a03e(0x205)]((_0x16d8e5,_0x135299)=>{var _0x22fd68=_0x87a03e;_0x736d77[_0x135299][_0x22fd68(0x283)]=_0x16d8e5;}),_0x4593fe[_0x87a03e(0x205)]((_0x2641b8,_0xd2bd5b)=>{var _0x363e6b=_0x87a03e;_0x736d77[_0xd2bd5b][_0x363e6b(0x23e)]=_0x2641b8;}),_0x1d94db[_0x87a03e(0x205)]((_0x35175e,_0x116f0c)=>{var _0x3d26d9=_0x87a03e;_0x736d77[_0x116f0c][_0x3d26d9(0x248)]=_0x35175e;}),_0x2c9e14[_0x87a03e(0x205)]((_0x52c47c,_0x34f2c3)=>{var _0x41230e=_0x87a03e;_0x736d77[_0x34f2c3][_0x41230e(0x2a2)]=_0x52c47c;}),_0x1e8ed2[_0x87a03e(0x205)]((_0x1e529f,_0x250bae)=>{var _0x3414cb=_0x87a03e;_0x736d77[_0x250bae][_0x3414cb(0x294)]=_0x1e529f;}),_0x374fbe[_0x87a03e(0x205)]((_0x102ebb,_0x43bd04)=>{_0x736d77[_0x43bd04]['expiry_date']=_0x102ebb;}),_0x1a8923[_0x87a03e(0x205)]((_0x3e1d6b,_0x3ba666)=>{var _0x232aa6=_0x87a03e;_0x736d77[_0x3ba666][_0x232aa6(0x2aa)]=_0x3e1d6b;}),_0x8eb430[_0x87a03e(0x205)]((_0x38224a,_0x42b220)=>{var _0x5c44a9=_0x87a03e;_0x736d77[_0x42b220][_0x5c44a9(0x1d1)]=_0x38224a;}),_0x39742d['forEach']((_0x215997,_0x4e2076)=>{var _0x160fb3=_0x87a03e;_0x736d77[_0x4e2076][_0x160fb3(0x293)]=_0x215997;}),_0x1f06c6[_0x87a03e(0x205)]((_0x42dee2,_0x45c931)=>{_0x736d77[_0x45c931]['from_room_name']=_0x42dee2;}),_0x35a679[_0x87a03e(0x205)]((_0x252316,_0x4b2d67)=>{var _0x423cc5=_0x87a03e;_0x736d77[_0x4b2d67][_0x423cc5(0x1d8)]=_0x252316;});const _0x875618=_0x736d77['filter'](_0x10f99b=>_0x10f99b['to_quantity']!=='0'&&_0x10f99b[_0x87a03e(0x2ab)]!==''||_0x10f99b[_0x87a03e(0x255)]!=='0'&&_0x10f99b[_0x87a03e(0x255)]!==''),_0x3a0f72=new transfers({'date':_0x36ccbc,'from_warehouse':_0x29282b,'to_warehouse':_0x573d59,'product':_0x875618,'note':_0x3dd470,'invoice':_0x532f8e}),_0x2b278b=await _0x3a0f72[_0x87a03e(0x2ad)]();_0x2f8ed0[_0x87a03e(0x27b)](_0x87a03e(0x233),'Product\x20Transfer\x20successfully'),_0x393395[_0x87a03e(0x268)]('/transfer/preview/'+_0x2b278b['_id']);}catch(_0x3db1c7){console[_0x87a03e(0x1d0)](_0x3db1c7),_0x393395[_0x87a03e(0x245)](0xc8)[_0x87a03e(0x250)]({'errorMessage':_0x3db1c7['message']});}}),router[a0_0x5ead96(0x236)](a0_0x5ead96(0x1d5),auth,async(_0x58c4eb,_0x5d2904)=>{var _0x4dfd89=a0_0x5ead96;try{const {username:_0x1d172b,email:_0x3e2ee9,role:_0x2f883d}=_0x58c4eb['user'],_0x42b9b8=_0x58c4eb[_0x4dfd89(0x24d)],_0x423a70=await profile[_0x4dfd89(0x2b9)]({'email':_0x42b9b8[_0x4dfd89(0x1e1)]}),_0x1de83a=await master_shop['find']();console['log']('master',_0x1de83a);const _0x18ef53=await transfers[_0x4dfd89(0x1fb)](_0x58c4eb[_0x4dfd89(0x249)]['id']);let _0xc90027=new Date(_0x18ef53['expiry_date']),_0x38ed15=('0'+_0xc90027['getDate']())[_0x4dfd89(0x280)](-0x2),_0x16534a=('0'+(_0xc90027['getMonth']()+0x1))[_0x4dfd89(0x280)](-0x2),_0x585138=_0xc90027[_0x4dfd89(0x267)](),_0x3cd404=_0x585138+'-'+_0x16534a+'-'+_0x38ed15,_0x420846;if(_0x42b9b8[_0x4dfd89(0x1ed)]=='staff'){const _0x497e82=await staff[_0x4dfd89(0x2b9)]({'email':_0x42b9b8[_0x4dfd89(0x1e1)]});_0x420846=await warehouse[_0x4dfd89(0x1c2)]({'status':'Enabled','name':_0x497e82[_0x4dfd89(0x1ef)],'warehouse_category':_0x4dfd89(0x2b3)});}else _0x420846=await warehouse[_0x4dfd89(0x1c2)]({'status':_0x4dfd89(0x29e),'warehouse_category':_0x4dfd89(0x2b3)});const _0xf55e59=await warehouse[_0x4dfd89(0x22f)]([{'$match':{'name':_0x18ef53[_0x4dfd89(0x215)]}},{'$unwind':_0x4dfd89(0x20a)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4dfd89(0x274)},'product_stock':{'$first':_0x4dfd89(0x1e5)},'bay':{'$first':_0x4dfd89(0x1e7)},'bin':{'$first':_0x4dfd89(0x27c)},'type':{'$first':_0x4dfd89(0x1cc)},'floorlevel':{'$first':_0x4dfd89(0x201)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4dfd89(0x241)},'product_code':{'$first':_0x4dfd89(0x1d9)},'storage':{'$first':_0x4dfd89(0x1db)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4dfd89(0x207)},'room':{'$first':_0x4dfd89(0x1dc)}}}]);if(_0x1de83a[0x0][_0x4dfd89(0x1c6)]=='English\x20(US)'){var _0x419f88=users[_0x4dfd89(0x2b0)];console['log'](_0x419f88);}else{if(_0x1de83a[0x0][_0x4dfd89(0x1c6)]==_0x4dfd89(0x20f))var _0x419f88=users[_0x4dfd89(0x20f)];else{if(_0x1de83a[0x0][_0x4dfd89(0x1c6)]==_0x4dfd89(0x22e))var _0x419f88=users[_0x4dfd89(0x22e)];else{if(_0x1de83a[0x0][_0x4dfd89(0x1c6)]==_0x4dfd89(0x237))var _0x419f88=users[_0x4dfd89(0x237)];else{if(_0x1de83a[0x0][_0x4dfd89(0x1c6)]=='French')var _0x419f88=users[_0x4dfd89(0x284)];else{if(_0x1de83a[0x0]['language']==_0x4dfd89(0x21e))var _0x419f88=users['Portuguese'];else{if(_0x1de83a[0x0][_0x4dfd89(0x1c6)]==_0x4dfd89(0x26b))var _0x419f88=users['Chinese'];else{if(_0x1de83a[0x0][_0x4dfd89(0x1c6)]==_0x4dfd89(0x1f2))var _0x419f88=users[_0x4dfd89(0x291)];}}}}}}}_0x5d2904[_0x4dfd89(0x1e0)]('edit_transfer_view',{'success':_0x58c4eb[_0x4dfd89(0x27b)](_0x4dfd89(0x233)),'errors':_0x58c4eb[_0x4dfd89(0x27b)](_0x4dfd89(0x2c1)),'role':_0x42b9b8,'profile':_0x423a70,'master_shop':_0x1de83a,'warehouse':_0x420846,'transfer':_0x18ef53,'stock':_0xf55e59,'language':_0x419f88});}catch(_0x34a6a5){console['log'](_0x34a6a5);}});async function updateProduct_detl(_0x104fad){var _0x112833=a0_0x5ead96;const _0x166d7f=await mongoose[_0x112833(0x29d)]();try{console[_0x112833(0x1d0)]('..............connected.....................');const _0x46b690=mongoose['Types'][_0x112833(0x2b4)];return await _0x166d7f[_0x112833(0x204)](async()=>{var _0x186c77=_0x112833;for(const _0x4e2354 of _0x104fad[_0x186c77(0x24c)]){console[_0x186c77(0x1d0)](new _0x46b690());const _0x2e2ef0=await warehouse[_0x186c77(0x22f)]([{'$match':{'name':_0x104fad[_0x186c77(0x215)],'room':_0x4e2354['from_room_name']}},{'$unwind':_0x186c77(0x20a)},{'$match':{'product_details._id':_0x46b690(_0x4e2354[_0x186c77(0x25d)])}}])[_0x186c77(0x21a)](_0x166d7f);if(_0x2e2ef0['length']===0x0)throw new Error(_0x186c77(0x2b2)+_0x4e2354[_0x186c77(0x296)]);for(const _0x4d78e2 of _0x2e2ef0){console[_0x186c77(0x1d0)](parseFloat(_0x4d78e2['product_details'][_0x186c77(0x258)][_0x186c77(0x220)](0x2))>=parseFloat(_0x4e2354[_0x186c77(0x2ab)][_0x186c77(0x220)](0x2)));if(parseFloat(_0x4d78e2[_0x186c77(0x1f7)][_0x186c77(0x258)][_0x186c77(0x220)](0x2))>=parseFloat(_0x4e2354[_0x186c77(0x2ab)][_0x186c77(0x220)](0x2))){let _0x205127=(parseFloat(_0x4d78e2[_0x186c77(0x1f7)][_0x186c77(0x258)][_0x186c77(0x220)](0x2))-parseFloat(_0x4e2354[_0x186c77(0x2ab)]))[_0x186c77(0x220)](0x2);console['log'](_0x186c77(0x276),_0x205127),console[_0x186c77(0x1d0)](_0x186c77(0x1f5)),await warehouse[_0x186c77(0x25b)]({'_id':_0x46b690(_0x4d78e2['_id']),'product_details._id':_0x46b690(_0x4d78e2[_0x186c77(0x1f7)][_0x186c77(0x28a)])},{'$set':{'product_details.$.product_stock':_0x205127,'product_details.$.trf_invoice':_0x104fad[_0x186c77(0x224)]}},{'session':_0x166d7f});const _0x2b26cf=await warehouse[_0x186c77(0x22f)]([{'$match':{'name':_0x104fad['to_warehouse'],'room':_0x4e2354[_0x186c77(0x1d8)]}}])[_0x186c77(0x21a)](_0x166d7f);console[_0x186c77(0x1d0)](_0x186c77(0x2bb)),await warehouse[_0x186c77(0x25b)]({'name':_0x104fad['to_warehouse'],'room':_0x4e2354[_0x186c77(0x1d8)]},{'$push':{'product_details':{'product_name':_0x4e2354[_0x186c77(0x1fa)],'product_stock':_0x4e2354['to_quantity'],'primary_code':_0x4e2354[_0x186c77(0x2bf)],'secondary_code':_0x4e2354[_0x186c77(0x269)],'product_code':_0x4e2354[_0x186c77(0x283)],'storage':_0x4e2354['storage'],'rack':_0x4e2354[_0x186c77(0x2bc)],'bay':_0x4e2354[_0x186c77(0x29a)],'bin':_0x4e2354[_0x186c77(0x20d)],'type':_0x4e2354[_0x186c77(0x1cf)],'floorlevel':_0x4e2354[_0x186c77(0x255)],'maxProducts':_0x4e2354[_0x186c77(0x23e)],'expiry_date':_0x4e2354['expiry_date'],'production_date':_0x4e2354[_0x186c77(0x1d1)],'maxPerUnit':_0x4e2354[_0x186c77(0x2aa)],'batch_code':_0x4e2354[_0x186c77(0x294)],'unit':_0x4e2354['unit'],'secondary_unit':_0x4e2354[_0x186c77(0x2a2)],'alertQTY':_0x4d78e2[_0x186c77(0x1f7)][_0x186c77(0x265)],'delivery_date':_0x4d78e2['product_details'][_0x186c77(0x1e3)],'delivery_code':_0x4d78e2[_0x186c77(0x1f7)][_0x186c77(0x1e6)],'product_cat':_0x4d78e2['product_details'][_0x186c77(0x1fd)],'invoice':_0x4e2354['from_invoice'],'trf_invoice':_0x104fad[_0x186c77(0x224)],'date_data':_0x104fad[_0x186c77(0x1cb)],'_id':new _0x46b690()}}},{'session':_0x166d7f});}else{console[_0x186c77(0x1d0)]('not\x20meet\x20the\x20need\x20stock',QTYTotal);throw new Error(_0x186c77(0x1de)+_0x4d78e2[_0x186c77(0x28a)]+_0x186c77(0x27a)+QTYTotal);}}}}),{'success':!![],'message':_0x112833(0x2b6)};}catch(_0x50cc11){return console[_0x112833(0x1d0)](_0x50cc11),await _0x166d7f[_0x112833(0x219)](),console[_0x112833(0x1d0)](_0x112833(0x2b7)),{'success':![],'message':_0x50cc11[_0x112833(0x252)]};}finally{_0x166d7f[_0x112833(0x2a9)](),console[_0x112833(0x1d0)](_0x112833(0x1c8));}}router[a0_0x5ead96(0x299)]('/preview/:id',auth,async(_0x45826f,_0x316401)=>{var _0x24cc81=a0_0x5ead96;try{const _0x125add=_0x45826f[_0x24cc81(0x249)]['id'],{from_warehouse:_0x4af3bc,FromRoom_name:_0x54527f,to_warehouse:_0xbd9548,ToRoom_name:_0x861b35}=_0x45826f[_0x24cc81(0x232)],_0x316e24=await transfers['findById']({'_id':_0x125add});await updateProduct_detl(_0x316e24),_0x316e24['finalize']=_0x24cc81(0x213);const _0x506b6e=await _0x316e24['save'](),_0x5647c1=await master_shop[_0x24cc81(0x1c2)](),_0x1c06e5=await email_settings[_0x24cc81(0x2b9)](),_0x5175ce=await supervisor_settings[_0x24cc81(0x1c2)]();var _0x20d6e5=_0x316e24[_0x24cc81(0x24c)],_0x30848d='',_0x375a49;for(_0x375a49 in _0x20d6e5){_0x30848d+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x20d6e5[_0x375a49][_0x24cc81(0x1fa)]+'</td>'+_0x24cc81(0x200)+_0x20d6e5[_0x375a49][_0x24cc81(0x283)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x20d6e5[_0x375a49][_0x24cc81(0x2ab)]+'</td>'+_0x24cc81(0x200)+_0x20d6e5[_0x375a49][_0x24cc81(0x248)]+_0x24cc81(0x225)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x20d6e5[_0x375a49][_0x24cc81(0x2a2)]+_0x24cc81(0x225)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x316e24[_0x24cc81(0x22c)]+_0x24cc81(0x225)+_0x24cc81(0x200)+_0x20d6e5[_0x375a49][_0x24cc81(0x1d8)]+_0x24cc81(0x225)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x20d6e5[_0x375a49]['storage']+_0x20d6e5[_0x375a49][_0x24cc81(0x2bc)]+_0x20d6e5[_0x375a49]['to_bay']+_0x20d6e5[_0x375a49]['to_bin']+_0x20d6e5[_0x375a49]['to_types'][0x0]+_0x20d6e5[_0x375a49][_0x24cc81(0x255)]+_0x24cc81(0x225),_0x24cc81(0x22a);}let _0x2a20f6=nodemailer['createTransport']({'host':_0x1c06e5[_0x24cc81(0x217)],'port':Number(_0x1c06e5[_0x24cc81(0x203)]),'secure':![],'auth':{'user':_0x1c06e5[_0x24cc81(0x1e1)],'pass':_0x1c06e5[_0x24cc81(0x212)]}}),_0xa9c268={'from':_0x1c06e5['email'],'to':_0x5175ce[0x0][_0x24cc81(0x260)],'subject':_0x24cc81(0x24a),'attachments':[{'filename':_0x24cc81(0x1f9),'path':__dirname+_0x24cc81(0x286)+_0x24cc81(0x271)+_0x5647c1[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x24cc81(0x222)+'</head><body>'+_0x24cc81(0x2a5)+_0x24cc81(0x1d4)+_0x24cc81(0x2a5)+_0x24cc81(0x1f0)+_0x24cc81(0x2af)+_0x24cc81(0x2a5)+_0x24cc81(0x218)+_0x5647c1[0x0][_0x24cc81(0x24b)]+'\x20</h2>'+_0x24cc81(0x2af)+_0x24cc81(0x2af)+_0x24cc81(0x1fe)+_0x24cc81(0x2a5)+_0x24cc81(0x1ff)+_0x24cc81(0x1ce)+_0x316e24[_0x24cc81(0x224)]+'\x20'+_0x24cc81(0x1eb)+'\x20Order\x20Date\x20:\x20'+_0x316e24[_0x24cc81(0x1cb)]+'\x20'+_0x24cc81(0x23f)+'</h5>'+_0x24cc81(0x2af)+_0x24cc81(0x27d)+_0x24cc81(0x2bd)+'<tr>'+_0x24cc81(0x1dd)+_0x24cc81(0x257)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x24cc81(0x1d3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x24cc81(0x22a)+_0x24cc81(0x1c4)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x30848d+'\x20'+_0x24cc81(0x20c)+_0x24cc81(0x1f8)+_0x24cc81(0x2a5)+_0x24cc81(0x23c)+'<h5>'+_0x5647c1[0x0]['site_title']+'</h5>'+_0x24cc81(0x2af)+'</div>'+_0x24cc81(0x1da)};_0x2a20f6[_0x24cc81(0x25c)](_0xa9c268,function(_0x422692,_0x179684){var _0x2b0feb=_0x24cc81;_0x422692?(console[_0x2b0feb(0x1d0)](_0x422692),console[_0x2b0feb(0x1d0)]('Error\x20Occurs')):console[_0x2b0feb(0x1d0)](_0x2b0feb(0x235));}),_0x45826f[_0x24cc81(0x27b)](_0x24cc81(0x233),'Transfer\x20Finalize\x20Successfully'),_0x316401[_0x24cc81(0x268)](_0x24cc81(0x254)+_0x506b6e[_0x24cc81(0x28a)]);}catch(_0x31878f){console[_0x24cc81(0x1d0)](_0x31878f);}});function BayBinSelected(_0xe5c97d,_0x21b821){var _0x482c0d=a0_0x5ead96,_0x24f054=[],_0x2c95f0=[],_0x3a0221=[],_0xf65376=[],_0x47f13a=[],_0x375a8c=[];let _0x3fb3c3=[];if(_0xe5c97d==_0x482c0d(0x1c3))switch(_0x21b821){case _0x482c0d(0x24e):_0x24f054=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2c95f0=[0x1,0x2],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=[_0x482c0d(0x26d),'Floor'],_0x47f13a=['D'],_0x375a8c=['A'];break;case _0x482c0d(0x253):_0x24f054=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2c95f0=[0x1,0x2],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=['Level',_0x482c0d(0x243)],_0x47f13a=['D'],_0x375a8c=['B'];break;case _0x482c0d(0x239):_0x24f054=[0x0],_0x2c95f0=[0x0],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=[_0x482c0d(0x243)],_0x47f13a=['D'],_0x375a8c=['S'];break;case _0x482c0d(0x281):_0x24f054=[0x0],_0x2c95f0=[0x0],_0xf65376=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3a0221=[_0x482c0d(0x243)],_0x47f13a=['D'],_0x375a8c=['R'];break;}else{if(_0xe5c97d==_0x482c0d(0x24f))switch(_0x21b821){case'Rack\x20A':_0x24f054=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2c95f0=['B','F'],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=[_0x482c0d(0x26d),_0x482c0d(0x243)],_0x47f13a=['C'],_0x375a8c=['A'];break;case'Rack\x20B':_0x24f054=[0x5,0x4,0x3,0x2,0x1],_0x2c95f0=['F','B','S'],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=['Level','Floor'],_0x47f13a=['C'],_0x375a8c=['B'];break;case'Rack\x20C':_0x24f054=[0x1,0x2,0x3,0x4,0x5],_0x2c95f0=['B','F','S'],_0xf65376=[0x5,0x4,0x3,0x2,0x1],_0x3a0221=[_0x482c0d(0x26d),'Floor'],_0x47f13a=['C'],_0x375a8c=['C'];break;case _0x482c0d(0x2b1):_0x24f054=[0x5,0x4,0x3,0x2,0x1],_0x2c95f0=['F','B','S'],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=[_0x482c0d(0x26d),_0x482c0d(0x243)],_0x47f13a=['C'],_0x375a8c=['D'];break;case'Rack\x20E':_0x24f054=[0x4,0x3,0x2,0x1],_0x2c95f0=[0x1,0x2],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=[_0x482c0d(0x26d),'Floor'],_0x47f13a=['C'],_0x375a8c=['E'];break;case _0x482c0d(0x1e4):_0x24f054=[0x1,0x2,0x3],_0x2c95f0=[0x1,0x2],_0xf65376=[0x1,0x2,0x3,0x4,0x5],_0x3a0221=['Level'],_0x47f13a=['C'],_0x375a8c=['F'];break;}}return{'levels':_0x24f054,'Isle':_0x2c95f0,'rack':_0xf65376,'type':_0x3a0221,'storage':_0x47f13a,'rak':_0x375a8c};}router['get'](a0_0x5ead96(0x216),auth,async(_0x1f6987,_0x10984d)=>{var _0xf467ce=a0_0x5ead96;try{const {username:_0x1475d5,email:_0x160c81,role:_0x512e0f}=_0x1f6987[_0xf467ce(0x24d)],_0x4e794b=_0x1f6987[_0xf467ce(0x24d)],_0x122b9c=await profile[_0xf467ce(0x2b9)]({'email':_0x4e794b[_0xf467ce(0x1e1)]}),_0x137471=await master_shop[_0xf467ce(0x1c2)](),_0x25dc57=await transfers[_0xf467ce(0x1fb)](_0x1f6987[_0xf467ce(0x249)]['id']);let _0x4b2fbd;if(_0x4e794b['role']==_0xf467ce(0x210)){const _0x5a56de=await staff['findOne']({'email':_0x4e794b[_0xf467ce(0x1e1)]});_0x4b2fbd=await warehouse[_0xf467ce(0x22f)]([{'$match':{'status':'Enabled','name':_0x5a56de['warehouse'],'warehouse_category':_0xf467ce(0x2b3)}},{'$group':{'_id':'$name','name':{'$first':_0xf467ce(0x1d7)}}}]);}else _0x4b2fbd=await warehouse[_0xf467ce(0x22f)]([{'$match':{'status':_0xf467ce(0x29e),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0xf467ce(0x1d7),'name':{'$first':_0xf467ce(0x1d7)}}}]);const _0x4e2c4a=await warehouse[_0xf467ce(0x22f)]([{'$match':{'name':_0x25dc57[_0xf467ce(0x215)],'warehouse_category':_0xf467ce(0x2b3)}},{'$unwind':'$product_details'},{'$group':{'_id':_0xf467ce(0x292),'name':{'$first':_0xf467ce(0x274)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xf467ce(0x1e7)},'bin':{'$first':_0xf467ce(0x27c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xf467ce(0x201)},'primary_code':{'$first':_0xf467ce(0x278)},'secondary_code':{'$first':_0xf467ce(0x241)},'product_code':{'$first':_0xf467ce(0x1d9)},'storage':{'$first':_0xf467ce(0x1db)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0x2c3577=await product[_0xf467ce(0x1c2)]({}),_0x189c5a=BayBinSelected(_0x25dc57[_0xf467ce(0x22c)],_0x25dc57[_0xf467ce(0x2ba)]);if(_0x137471[0x0]['language']=='English\x20(US)'){var _0x18fcc6=users[_0xf467ce(0x2b0)];console[_0xf467ce(0x1d0)](_0x18fcc6);}else{if(_0x137471[0x0][_0xf467ce(0x1c6)]==_0xf467ce(0x20f))var _0x18fcc6=users[_0xf467ce(0x20f)];else{if(_0x137471[0x0][_0xf467ce(0x1c6)]==_0xf467ce(0x22e))var _0x18fcc6=users[_0xf467ce(0x22e)];else{if(_0x137471[0x0]['language']=='Spanish')var _0x18fcc6=users[_0xf467ce(0x237)];else{if(_0x137471[0x0][_0xf467ce(0x1c6)]==_0xf467ce(0x284))var _0x18fcc6=users[_0xf467ce(0x284)];else{if(_0x137471[0x0]['language']==_0xf467ce(0x21e))var _0x18fcc6=users[_0xf467ce(0x297)];else{if(_0x137471[0x0][_0xf467ce(0x1c6)]=='Chinese')var _0x18fcc6=users[_0xf467ce(0x26b)];else{if(_0x137471[0x0][_0xf467ce(0x1c6)]==_0xf467ce(0x1f2))var _0x18fcc6=users[_0xf467ce(0x291)];}}}}}}}_0x10984d[_0xf467ce(0x1e0)](_0xf467ce(0x202),{'success':_0x1f6987['flash'](_0xf467ce(0x233)),'errors':_0x1f6987['flash']('errors'),'role':_0x4e794b,'profile':_0x122b9c,'master_shop':_0x137471,'warehouse':_0x4b2fbd,'transfer':_0x25dc57,'stock':_0x4e2c4a,'unit':_0x2c3577,'language':_0x18fcc6});}catch(_0x278173){console[_0xf467ce(0x1d0)](_0x278173);}}),router[a0_0x5ead96(0x299)](a0_0x5ead96(0x216),auth,async(_0x35dc8a,_0x2a24db)=>{var _0x39ba16=a0_0x5ead96;try{const _0x20947b=_0x35dc8a[_0x39ba16(0x249)]['id'],_0x57302b=await transfers['findById'](_0x20947b);_0x2a24db[_0x39ba16(0x250)](_0x35dc8a[_0x39ba16(0x232)]);return;const {date:_0x5ef5cd,from_warehouse:_0x4244cd,FromRoom_name:_0x27053a,to_warehouse:_0x36537d,ToRoom_name:_0x28951f,prod_name:_0x2206df,from_prod_qty:_0x30181d,from_prod_level:_0x42d776,from_prod_isle:_0x81f1c6,from_prod_pallet:_0x2ce5f2,to_prod_qty:_0x3ae06e,to_prod_level:_0x152fc8,to_prod_isle:_0x2223a9,to_prod_pallet:_0x42ad87,primary_code:_0x1f11f1,secondary_code:_0x41e53d,product_code3:_0x27eb31,note:_0x5cf90c,invoice:_0x1d5880,expiry_date:_0x1f38ab}=_0x35dc8a['body'];if(typeof _0x2206df==_0x39ba16(0x26f))var _0x5eebf8=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x226)]],_0x2e265b=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x1f1)]],_0x3a3c4f=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x23b)]],_0x5712ac=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x26a)]],_0x4c28ae=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x29f)]],_0x357e22=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x1e8)]],_0x1288b6=[_0x35dc8a['body'][_0x39ba16(0x1c5)]],_0x382d1b=[_0x35dc8a['body'][_0x39ba16(0x206)]],_0x58b0fe=[_0x35dc8a[_0x39ba16(0x232)]['to_prod_isle']],_0x47d0fa=[_0x35dc8a['body'][_0x39ba16(0x277)]],_0x3c9f7f=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x1cf)]],_0x2ac520=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x285)]],_0x551687=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x295)]],_0x2c3fd7=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x2bf)]],_0x1011c9=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x269)]],_0x3cb222=[_0x35dc8a['body'][_0x39ba16(0x2a1)]],_0x2d9c21=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x298)]],_0x58ce78=[_0x35dc8a[_0x39ba16(0x232)]['unit']],_0x5eec1b=[_0x35dc8a['body']['secondary_unit']],_0x39d453=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x294)]],_0x3595b2=[_0x35dc8a['body'][_0x39ba16(0x263)]],_0x291a77=[_0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x2ac)]],_0x4fe143=[_0x35dc8a[_0x39ba16(0x232)]['from_rak']];else var _0x5eebf8=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x226)]],_0x2ac520=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x285)]],_0x551687=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x295)]],_0x357e22=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x1e8)]],_0x3c9f7f=[..._0x35dc8a[_0x39ba16(0x232)]['to_types']],_0x2e265b=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x1f1)]],_0x3a3c4f=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x23b)]],_0x5712ac=[..._0x35dc8a['body']['from_prod_isle']],_0x4c28ae=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x29f)]],_0x1288b6=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x1c5)]],_0x382d1b=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x206)]],_0x58b0fe=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x282)]],_0x47d0fa=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x277)]],_0x2c3fd7=[..._0x35dc8a['body'][_0x39ba16(0x2bf)]],_0x1011c9=[..._0x35dc8a[_0x39ba16(0x232)]['secondary_code']],_0x3cb222=[..._0x35dc8a['body'][_0x39ba16(0x2a1)]],_0x2d9c21=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x298)]],_0x58ce78=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x248)]],_0x5eec1b=[..._0x35dc8a['body'][_0x39ba16(0x2a2)]],_0x39d453=[..._0x35dc8a['body'][_0x39ba16(0x294)]],_0x3595b2=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x263)]],_0x291a77=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x2ac)]],_0x4fe143=[..._0x35dc8a[_0x39ba16(0x232)][_0x39ba16(0x1ee)]];const _0x1fe194=_0x5eebf8[_0x39ba16(0x26c)](_0xbd4f74=>{return _0xbd4f74={'product_name':_0xbd4f74};});_0x2e265b['forEach']((_0x142b0c,_0x1e72ed)=>{var _0x31d33c=_0x39ba16;_0x1fe194[_0x1e72ed][_0x31d33c(0x246)]=_0x142b0c;}),_0x3a3c4f[_0x39ba16(0x205)]((_0x54dbaa,_0x549b77)=>{var _0x501a27=_0x39ba16;_0x1fe194[_0x549b77][_0x501a27(0x2a8)]=_0x54dbaa;}),_0x5712ac[_0x39ba16(0x205)]((_0x2705ef,_0x124818)=>{_0x1fe194[_0x124818]['from_bin']=_0x2705ef;}),_0x4c28ae[_0x39ba16(0x205)]((_0x52241f,_0x341e4b)=>{_0x1fe194[_0x341e4b]['from_floorlevel']=_0x52241f;}),_0x1288b6[_0x39ba16(0x205)]((_0x4c2498,_0x2c3664)=>{_0x1fe194[_0x2c3664]['to_quantity']=_0x4c2498;}),_0x382d1b[_0x39ba16(0x205)]((_0x2b4f49,_0x13a6e0)=>{var _0x1eb808=_0x39ba16;_0x1fe194[_0x13a6e0][_0x1eb808(0x29a)]=_0x2b4f49;}),_0x58b0fe[_0x39ba16(0x205)]((_0x199863,_0x3ce222)=>{var _0x5519bf=_0x39ba16;_0x1fe194[_0x3ce222][_0x5519bf(0x20d)]=_0x199863;}),_0x47d0fa[_0x39ba16(0x205)]((_0x2451ef,_0x641341)=>{_0x1fe194[_0x641341]['to_floorlevel']=_0x2451ef;}),_0x2c3fd7[_0x39ba16(0x205)]((_0x582bb9,_0x2d8c50)=>{var _0x5d8f96=_0x39ba16;_0x1fe194[_0x2d8c50][_0x5d8f96(0x2bf)]=_0x582bb9;}),_0x1011c9['forEach']((_0x9c4e68,_0x3240aa)=>{_0x1fe194[_0x3240aa]['secondary_code']=_0x9c4e68;}),_0x3cb222[_0x39ba16(0x205)]((_0x5ce8ac,_0x24a215)=>{var _0x4aa81b=_0x39ba16;_0x1fe194[_0x24a215][_0x4aa81b(0x283)]=_0x5ce8ac;}),_0x2d9c21[_0x39ba16(0x205)]((_0x136734,_0x263820)=>{var _0x3e9730=_0x39ba16;_0x1fe194[_0x263820][_0x3e9730(0x23e)]=_0x136734;}),_0x58ce78[_0x39ba16(0x205)]((_0x5ddf08,_0x50ea08)=>{var _0x61bccc=_0x39ba16;_0x1fe194[_0x50ea08][_0x61bccc(0x248)]=_0x5ddf08;}),_0x5eec1b[_0x39ba16(0x205)]((_0x561aa4,_0x175378)=>{_0x1fe194[_0x175378]['secondary_unit']=_0x561aa4;}),_0x39d453['forEach']((_0x1c5da4,_0x24ead1)=>{_0x1fe194[_0x24ead1]['batch_code']=_0x1c5da4;}),_0x3595b2['forEach']((_0x7e52da,_0x250a65)=>{_0x1fe194[_0x250a65]['expiry_date']=_0x7e52da;}),_0x2ac520['forEach']((_0x292d63,_0x2f54fb)=>{var _0x503cf9=_0x39ba16;_0x1fe194[_0x2f54fb][_0x503cf9(0x285)]=_0x292d63;}),_0x551687[_0x39ba16(0x205)]((_0x7d2872,_0x30f182)=>{var _0x59b3cd=_0x39ba16;_0x1fe194[_0x30f182][_0x59b3cd(0x2bc)]=_0x7d2872;}),_0x357e22[_0x39ba16(0x205)]((_0x49b8d0,_0x13c0af)=>{_0x1fe194[_0x13c0af]['from_types']=_0x49b8d0;}),_0x3c9f7f['forEach']((_0x3e1412,_0x45b7fd)=>{var _0x5769d7=_0x39ba16;_0x1fe194[_0x45b7fd][_0x5769d7(0x1cf)]=_0x3e1412;}),_0x291a77[_0x39ba16(0x205)]((_0x2d39c3,_0x59f64a)=>{var _0xed7564=_0x39ba16;_0x1fe194[_0x59f64a][_0xed7564(0x2ac)]=_0x2d39c3;}),_0x4fe143[_0x39ba16(0x205)]((_0x357992,_0x3807ad)=>{var _0x14226d=_0x39ba16;_0x1fe194[_0x3807ad][_0x14226d(0x240)]=_0x357992;});const _0x4cc79b=_0x1fe194[_0x39ba16(0x1e2)](_0x40b7ff=>_0x40b7ff[_0x39ba16(0x2ab)]!=='0'&&_0x40b7ff[_0x39ba16(0x2ab)]!==''||_0x40b7ff[_0x39ba16(0x255)]!=='0'&&_0x40b7ff['to_floorlevel']!=='');var _0x3bde01=0x0;_0x4cc79b[_0x39ba16(0x205)](_0x1fa115=>{var _0x30b77a=_0x39ba16;parseInt(_0x1fa115[_0x30b77a(0x246)])<parseInt(_0x1fa115['to_quantity'])&&_0x3bde01++;});if(_0x3bde01!=0x0)return _0x35dc8a[_0x39ba16(0x27b)](_0x39ba16(0x2c1),_0x39ba16(0x1f4)),_0x2a24db[_0x39ba16(0x268)](_0x39ba16(0x20e));const _0x209777=await warehouse[_0x39ba16(0x2b9)]({'name':_0x57302b[_0x39ba16(0x215)],'room':_0x57302b['from_room']});_0x57302b[_0x39ba16(0x24c)]['forEach'](_0x530190=>{var _0x2020a1=_0x39ba16;if(_0x530190[_0x2020a1(0x2ab)]>0x0){const _0x395df1=_0x209777['product_details']['map'](_0x36d7c6=>{var _0x152581=_0x2020a1;_0x36d7c6[_0x152581(0x1fa)]==_0x530190['product_name']&&_0x36d7c6['floorlevel']==_0x530190[_0x152581(0x228)]&&_0x36d7c6['type']==_0x530190[_0x152581(0x1e8)]&&_0x36d7c6[_0x152581(0x1e9)]==_0x530190[_0x152581(0x1ec)]&&_0x36d7c6[_0x152581(0x23d)]==_0x530190[_0x152581(0x2a8)]&&_0x36d7c6[_0x152581(0x2bc)]==_0x530190[_0x152581(0x240)]&&_0x36d7c6[_0x152581(0x285)]==_0x530190[_0x152581(0x2ac)]&&(_0x36d7c6[_0x152581(0x258)]=parseInt(_0x36d7c6[_0x152581(0x258)])+parseInt(_0x530190['to_quantity']));});}}),await _0x209777[_0x39ba16(0x2ad)]();const _0x176c15=await warehouse['findOne']({'name':_0x57302b[_0x39ba16(0x22c)],'room':_0x57302b['to_room']});_0x57302b[_0x39ba16(0x24c)][_0x39ba16(0x205)](_0xb94a88=>{var _0x4c3a3d=_0x39ba16;if(_0xb94a88[_0x4c3a3d(0x2ab)]>0x0){const _0x235d56=_0x176c15[_0x4c3a3d(0x1f7)]['map'](_0x501507=>{var _0x58a558=_0x4c3a3d;_0x501507[_0x58a558(0x1fa)]==_0xb94a88['product_name']&&_0x501507[_0x58a558(0x273)]==_0xb94a88['to_floorlevel']&&_0x501507[_0x58a558(0x28d)]==_0xb94a88[_0x58a558(0x1cf)]&&_0x501507[_0x58a558(0x1e9)]==_0xb94a88[_0x58a558(0x20d)]&&_0x501507[_0x58a558(0x23d)]==_0xb94a88['to_bay']&&_0x501507[_0x58a558(0x2bc)]==_0xb94a88[_0x58a558(0x2bc)]&&_0x501507[_0x58a558(0x285)]==_0xb94a88[_0x58a558(0x285)]&&(_0x501507[_0x58a558(0x258)]=parseInt(_0x501507[_0x58a558(0x258)])-parseInt(_0xb94a88[_0x58a558(0x2ab)]));});}}),await _0x176c15['save'](),_0x57302b[_0x39ba16(0x1cb)]=_0x5ef5cd,_0x57302b[_0x39ba16(0x215)]=_0x4244cd,_0x57302b[_0x39ba16(0x22c)]=_0x36537d,_0x57302b['product']=_0x4cc79b,_0x57302b[_0x39ba16(0x22b)]=_0x5cf90c,_0x57302b[_0x39ba16(0x224)]=_0x1d5880;const _0x325656=await _0x57302b[_0x39ba16(0x2ad)]();console[_0x39ba16(0x1d0)](_0x325656);const _0x503dc8=await warehouse['findOne']({'name':_0x4244cd,'room':_0x27053a});_0x325656[_0x39ba16(0x24c)][_0x39ba16(0x205)](_0x91222c=>{var _0x3db96a=_0x39ba16;if(_0x91222c[_0x3db96a(0x2ab)]>0x0){const _0x1c3079=_0x503dc8[_0x3db96a(0x1f7)][_0x3db96a(0x26c)](_0x54f01e=>{var _0x2d0dca=_0x3db96a;_0x54f01e[_0x2d0dca(0x1fa)]==_0x91222c[_0x2d0dca(0x1fa)]&&_0x54f01e[_0x2d0dca(0x273)]==_0x91222c[_0x2d0dca(0x228)]&&_0x54f01e[_0x2d0dca(0x28d)]==_0x91222c['from_types']&&_0x54f01e[_0x2d0dca(0x1e9)]==_0x91222c[_0x2d0dca(0x1ec)]&&_0x54f01e[_0x2d0dca(0x23d)]==_0x91222c[_0x2d0dca(0x2a8)]&&_0x54f01e['rack']==_0x91222c['from_rack']&&_0x54f01e[_0x2d0dca(0x285)]==_0x91222c[_0x2d0dca(0x2ac)]&&(_0x54f01e[_0x2d0dca(0x258)]=parseInt(_0x54f01e['product_stock'])-parseInt(_0x91222c[_0x2d0dca(0x2ab)]));});}}),await _0x503dc8[_0x39ba16(0x2ad)]();const _0x1099a1=await warehouse[_0x39ba16(0x2b9)]({'name':_0x36537d,'room':_0x28951f});_0x325656[_0x39ba16(0x24c)][_0x39ba16(0x205)](_0x555952=>{var _0x22d5ea=_0x39ba16;if(_0x555952[_0x22d5ea(0x2ab)]>0x0){var _0x276bc0=0x0;const _0x4bb3ef=_0x1099a1[_0x22d5ea(0x1f7)][_0x22d5ea(0x26c)](_0x10b45d=>{var _0x3b2219=_0x22d5ea;_0x10b45d[_0x3b2219(0x1fa)]==_0x555952[_0x3b2219(0x1fa)]&&_0x10b45d[_0x3b2219(0x273)]==_0x555952['to_floorlevel']&&_0x10b45d['type']==_0x555952[_0x3b2219(0x1cf)]&&_0x10b45d[_0x3b2219(0x1e9)]==_0x555952[_0x3b2219(0x20d)]&&_0x10b45d[_0x3b2219(0x23d)]==_0x555952[_0x3b2219(0x29a)]&&_0x10b45d['rack']==_0x555952[_0x3b2219(0x2bc)]&&_0x10b45d[_0x3b2219(0x285)]==_0x555952['storage']&&(_0x10b45d[_0x3b2219(0x258)]=parseInt(_0x10b45d[_0x3b2219(0x258)])+parseInt(_0x555952[_0x3b2219(0x2ab)]),_0x276bc0++);});_0x276bc0=='0'&&(_0x1099a1[_0x22d5ea(0x1f7)]=_0x1099a1[_0x22d5ea(0x1f7)]['concat']({'product_name':_0x555952[_0x22d5ea(0x1fa)],'product_stock':_0x555952[_0x22d5ea(0x2ab)],'bay':_0x555952[_0x22d5ea(0x29a)],'bin':_0x555952[_0x22d5ea(0x20d)],'type':_0x555952['to_types'],'floorlevel':_0x555952[_0x22d5ea(0x255)],'storage':_0x555952[_0x22d5ea(0x285)],'rack':_0x555952['rack'],'product_code':_0x555952[_0x22d5ea(0x283)],'primary_code':_0x555952[_0x22d5ea(0x2bf)],'secondary_code':_0x555952[_0x22d5ea(0x269)],'maxProducts':_0x555952['maxProducts'],'storage':_0x555952[_0x22d5ea(0x285)],'rack':_0x555952[_0x22d5ea(0x2bc)]}));}}),await _0x1099a1[_0x39ba16(0x2ad)](),_0x35dc8a[_0x39ba16(0x27b)](_0x39ba16(0x233),_0x39ba16(0x289)),_0x2a24db[_0x39ba16(0x268)](_0x39ba16(0x208));}catch(_0x15b516){console[_0x39ba16(0x1d0)](_0x15b516);}}),router[a0_0x5ead96(0x299)]('/barcode_scanner',async(_0x188dd9,_0x4fad26)=>{var _0x19f6f9=a0_0x5ead96;const {FromWareHouse:_0x15e104,FromRoom:_0x14408d,ToWarehouse:_0x57ca16,ToRoom:_0x15bb43,primary_code:_0x5239e6,Roomslist:_0x101086}=_0x188dd9[_0x19f6f9(0x232)],_0x3c1b4e=_0x101086['split'](','),_0x597978=[];async function _0x4f8349(_0x15d73b){var _0x155fef=_0x19f6f9;const _0x4af070=await warehouse[_0x155fef(0x22f)]([{'$match':{'name':_0x15e104,'room':_0x15d73b}},{'$unwind':_0x155fef(0x20a)},{'$match':{'product_details.primary_code':_0x5239e6}},{'$group':{'_id':_0x155fef(0x292),'name':{'$first':_0x155fef(0x274)},'instock':{'$first':_0x155fef(0x1e5)},'primary_code':{'$first':_0x155fef(0x278)},'secondary_code':{'$first':_0x155fef(0x241)},'product_code':{'$first':_0x155fef(0x1d9)},'level':{'$first':_0x155fef(0x1e7)},'isle':{'$first':_0x155fef(0x27c)},'type':{'$first':_0x155fef(0x1cc)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x155fef(0x2b5)},'secondary_unit':{'$first':_0x155fef(0x1c9)},'storage':{'$first':_0x155fef(0x1db)},'rack':{'$first':_0x155fef(0x275)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x155fef(0x207)},'batch_code':{'$first':_0x155fef(0x223)},'maxPerUnit':{'$first':_0x155fef(0x211)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x155fef(0x1dc)},'maxProducts':{'$first':_0x155fef(0x230)},'invoice_product':{'$first':_0x155fef(0x25f)}}}]),_0x2a72e1=await warehouse[_0x155fef(0x22f)]([{'$match':{'name':_0x15e104,'room':_0x15d73b}},{'$unwind':_0x155fef(0x20a)},{'$match':{'product_details.secondary_code':_0x5239e6}},{'$group':{'_id':_0x155fef(0x292),'name':{'$first':_0x155fef(0x274)},'instock':{'$first':_0x155fef(0x1e5)},'primary_code':{'$first':_0x155fef(0x278)},'secondary_code':{'$first':_0x155fef(0x241)},'product_code':{'$first':_0x155fef(0x1d9)},'level':{'$first':_0x155fef(0x1e7)},'isle':{'$first':_0x155fef(0x27c)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x155fef(0x201)},'unit':{'$first':_0x155fef(0x2b5)},'secondary_unit':{'$first':_0x155fef(0x1c9)},'storage':{'$first':_0x155fef(0x1db)},'rack':{'$first':_0x155fef(0x275)},'expiry_date':{'$first':_0x155fef(0x21f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x155fef(0x223)},'maxPerUnit':{'$first':_0x155fef(0x211)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x155fef(0x1dc)},'maxProducts':{'$first':_0x155fef(0x230)},'invoice_product':{'$first':_0x155fef(0x25f)}}}]);if(_0x4af070[_0x155fef(0x2b8)]>0x0)_0x597978[_0x155fef(0x26e)](_0x4af070);else _0x2a72e1['length']>0x0&&_0x597978[_0x155fef(0x26e)](_0x2a72e1);}const _0x374108=_0x3c1b4e[_0x19f6f9(0x26c)](_0x5ee751=>_0x4f8349(_0x5ee751));await Promise[_0x19f6f9(0x259)](_0x374108),_0x4fad26['json'](_0x597978);}),router[a0_0x5ead96(0x299)](a0_0x5ead96(0x27e),async(_0x1d0de1,_0x4fe1b2)=>{var _0x4bc5c1=a0_0x5ead96;try{const {FromWareHouse:_0x1d26fe,FromRoom:_0x35a4cc,ToWarehouse:_0x5429cb,ToRoom:_0x255556,secondary_code:_0x19457e}=_0x1d0de1[_0x4bc5c1(0x232)],_0x246b25=await warehouse[_0x4bc5c1(0x22f)]([{'$match':{'name':_0x1d26fe}},{'$unwind':_0x4bc5c1(0x20a)},{'$match':{'product_details.secondary_code':_0x19457e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4bc5c1(0x274)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4bc5c1(0x241)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x4bc5c1(0x1e5)},'warehouse':{'$first':_0x4bc5c1(0x1d7)},'level':{'$first':_0x4bc5c1(0x23a)},'isle':{'$first':_0x4bc5c1(0x1f3)},'pallet':{'$first':_0x4bc5c1(0x229)},'maxProducts':{'$first':_0x4bc5c1(0x230)},'unit':{'$first':_0x4bc5c1(0x2b5)}}}]);_0x4fe1b2[_0x4bc5c1(0x245)](0xc8)[_0x4bc5c1(0x250)](_0x246b25);}catch(_0x21b328){_0x4fe1b2[_0x4bc5c1(0x245)](0x194)['json']({'message':_0x21b328['message']});}}),router['post']('/barcode_scanner3',async(_0x5ea0ec,_0x583577)=>{var _0x46086f=a0_0x5ead96;try{const {FromWareHouse:_0x362ea7,FromRoom:_0x4b94ff,ToWarehouse:_0x27e895,ToRoom:_0x41fc7b,product_code:_0x544f79}=_0x5ea0ec[_0x46086f(0x232)],_0x2b8901=await warehouse['aggregate']([{'$match':{'name':_0x362ea7}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x544f79}},{'$group':{'_id':_0x46086f(0x292),'name':{'$first':_0x46086f(0x274)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x46086f(0x241)},'product_code':{'$first':_0x46086f(0x1d9)},'instock':{'$first':_0x46086f(0x1e5)},'warehouse':{'$first':_0x46086f(0x1d7)},'level':{'$first':_0x46086f(0x23a)},'isle':{'$first':_0x46086f(0x1f3)},'pallet':{'$first':_0x46086f(0x229)},'maxProducts':{'$first':_0x46086f(0x230)},'unit':{'$first':_0x46086f(0x2b5)}}}]);_0x583577[_0x46086f(0x245)](0xc8)['json'](_0x2b8901);}catch(_0x56ec43){_0x583577[_0x46086f(0x245)](0x194)['json']({'message':_0x56ec43['message']});}}),router['post'](a0_0x5ead96(0x247),async(_0x598942,_0x2fe1bd)=>{var _0x3b1620=a0_0x5ead96;const {level:_0x358b42,isle:_0xe80f9f,pallet:_0x1b5b8a,warehouses:_0x5ba267,room:_0x53be6d}=_0x598942[_0x3b1620(0x232)];try{const _0x1a0783=await warehouse[_0x3b1620(0x22f)]([{'$match':{'name':_0x5ba267,'room':_0x53be6d}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x358b42),'product_details.isle':_0xe80f9f,'product_details.pallet':parseInt(_0x1b5b8a)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3b1620(0x1e5)},'level':{'$first':_0x3b1620(0x23a)},'isle':{'$first':_0x3b1620(0x1f3)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2fe1bd['status'](0xc8)[_0x3b1620(0x250)](_0x1a0783);}catch(_0x4a1bf6){_0x2fe1bd[_0x3b1620(0x245)](0x194)[_0x3b1620(0x250)]({'message':_0x4a1bf6['message']});}}),module[a0_0x5ead96(0x21b)]=router;function a0_0x43ce(){var _0x39afa4=['floorlevel','$product_details.product_name','$product_details.rack','meet\x20the\x20need\x20stock','to_prod_pallet','$product_details.primary_code','$to_warehouse','\x20and\x20QTY\x20:\x20','flash','$product_details.bin','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/barcode_scanner2','1884231pQBzUK','slice','Receiving\x20Area','to_prod_isle','product_code','French','storage','/../public','RoomAssigned','To_invoice','Transfer\x20Edit\x20Successfully','_id','express','Router','type','TRF-','6Qmibbz','../middleware/auth','Arabic','$product_details._id','prod_cat','batch_code','rak','from_room_name','Portuguese','MaxStocks_data2','post','to_bay','581068gHpzjP','Ambient','startSession','Enabled','from_prod_pallet','from_invoice','product_code3','secondary_unit','$from_warehouse','config','<div>','dotenv','English\x20(US)','from_bay','endSession','maxperunit','to_quantity','from_storage','save','/view','</div>','English','Rack\x20D','No\x20warehouse\x20data\x20found\x20for\x20room:\x20','Raw\x20Materials','ObjectId','$product_details.unit','Products\x20updated\x20successfully.','Transaction\x20aborted.','length','findOne','to_room','..............to\x20deducted.....................','rack','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','855825anvKwg','primary_code','random','errors','$_id','find','DRY\x20STORAGE','</thead>','to_prod_qty','language','Return\x20Rooms','..............disconnected.....................','$product_details.secondary_unit','Enclosed','date','$product_details.type','catch','\x20Order\x20Number\x20:\x20','to_types','log','production_date','3773upaydS','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/preview/:id','toString','$name','to_room_name','$product_details.product_code','</body></html>','$product_details.storage','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','No\x20matching\x20document\x20found\x20for\x20product\x20ID\x20','mongoose','render','email','filter','delivery_date','Rack\x20F','$product_details.product_stock','delivery_code','$product_details.bay','from_types','bin','$product.from_room_name','<span\x20style=\x22float:\x20right;\x22>','from_bin','role','from_rak','warehouse','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','from_prod_qty','Arabic\x20(ae)','$product_details.isle','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','..............from\x20deducted.....................','9402HvRFsI','product_details','</table>','Logo.png','product_name','findById','then','product_cat','<hr\x20class=\x22my-3\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.floorlevel','edit_transfer','port','withTransaction','forEach','to_prod_level','$product_details.production_date','/transfer/view','../public/language/languages.json','$product_details','$date','</tbody>','to_bin','back','Hindi','staff','$product_details.maxPerUnit','password','True','/view/add_transfer','from_warehouse','/view/:id','host','<h2>\x20','abortTransaction','session','exports','master','380201MMeWin','Portuguese\x20(BR)','$product_details.expiry_date','toFixed','to_invoice','<html><head><title></title>','$product_details.batch_code','invoice','</td>','prod_name','padStart','from_floorlevel','$product_details.pallet','</tr>','note','to_warehouse','../models/all_models','German','aggregate','$product_details.maxProducts','here','body','success','$finalize','Email\x20sent\x20successfully','get','Spanish','70mfLkFe','Shelves','$product_details.level','from_prod_level','<strong>\x20Regards\x20</strong>','bay','maxProducts','</span>','from_rack','$product_details.secondary_code','\x20<>\x20','Floor','$invoice','status','from_quantity','/CheckingWarehouse','unit','params','Transfer\x20Mail','site_title','product','user','Rack\x20A','COLD\x20STORAGE','json','485122VumUmM','message','Rack\x20B','/picking_list/PDF_transfer_rm/','to_floorlevel','12194424nJPVUF','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','product_stock','all','primary_unit','updateOne','sendMail','id_transaction_id','floor','$product_details.invoice','RMSEmail','84vffGTV','add_transfer','expiry_date','id_transaction','alertQTY','40LCoLjk','getFullYear','redirect','secondary_code','from_prod_isle','Chinese','map','Level','push','string','$isAllowEdit','/upload/','New_Qty_Converted'];a0_0x43ce=function(){return _0x39afa4;};return a0_0x43ce();}