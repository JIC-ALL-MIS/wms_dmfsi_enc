var a0_0x182a8c=a0_0x3716;function a0_0x3716(_0x43c048,_0x5d9855){var _0x2bf371=a0_0x2bf3();return a0_0x3716=function(_0x3716dc,_0x525502){_0x3716dc=_0x3716dc-0x8f;var _0x1ed8d0=_0x2bf371[_0x3716dc];return _0x1ed8d0;},a0_0x3716(_0x43c048,_0x5d9855);}(function(_0x3ac783,_0x39362a){var _0xe83716=a0_0x3716,_0xcada5a=_0x3ac783();while(!![]){try{var _0x379974=parseInt(_0xe83716(0xaa))/0x1+-parseInt(_0xe83716(0x120))/0x2+-parseInt(_0xe83716(0x196))/0x3+-parseInt(_0xe83716(0x12d))/0x4*(parseInt(_0xe83716(0x93))/0x5)+parseInt(_0xe83716(0x95))/0x6*(parseInt(_0xe83716(0xaf))/0x7)+parseInt(_0xe83716(0x194))/0x8*(parseInt(_0xe83716(0xd2))/0x9)+parseInt(_0xe83716(0xe7))/0xa;if(_0x379974===_0x39362a)break;else _0xcada5a['push'](_0xcada5a['shift']());}catch(_0x5407f1){_0xcada5a['push'](_0xcada5a['shift']());}}}(a0_0x2bf3,0x3d7aa),require(a0_0x182a8c(0xd1))[a0_0x182a8c(0x176)]());const express=require(a0_0x182a8c(0x117)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x182a8c(0xec)),auth=require(a0_0x182a8c(0x172)),users=require(a0_0x182a8c(0xe6)),nodemailer=require(a0_0x182a8c(0x10b)),mongoose=require(a0_0x182a8c(0xd8));router[a0_0x182a8c(0x125)](a0_0x182a8c(0xa8),auth,async(_0x208955,_0x395f1e)=>{var _0x55c8d5=a0_0x182a8c;try{const {username:_0x2f9653,email:_0x5a46b1,role:_0x22bfe3}=_0x208955[_0x55c8d5(0x153)],_0x2fadbc=_0x208955[_0x55c8d5(0x153)],_0xb4b56a=await profile[_0x55c8d5(0x152)]({'email':_0x2fadbc[_0x55c8d5(0xac)]}),_0x4eb52a=await master_shop[_0x55c8d5(0xa4)]();console[_0x55c8d5(0x119)](_0x55c8d5(0x182),_0x4eb52a);let _0x2e4408;if(_0x2fadbc[_0x55c8d5(0xe9)]=='staff'){const _0x3585f9=await staff['findOne']({'email':_0x2fadbc[_0x55c8d5(0xac)]});_0x2e4408=await transfers[_0x55c8d5(0xa4)]({'from_warehouse':_0x3585f9[_0x55c8d5(0x13c)]});}else _0x2e4408=await transfers[_0x55c8d5(0xf4)]([{'$unwind':_0x55c8d5(0x12a)},{'$group':{'_id':_0x55c8d5(0x155),'invoice':{'$first':'$invoice'},'date':{'$first':_0x55c8d5(0x170)},'from_warehouse':{'$first':_0x55c8d5(0x179)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x55c8d5(0x102)},'to_room_name':{'$addToSet':_0x55c8d5(0xce)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x55c8d5(0xea)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4eb52a[0x0][_0x55c8d5(0xfb)]==_0x55c8d5(0xc1)){var _0x1dfb65=users[_0x55c8d5(0xdc)];console[_0x55c8d5(0x119)](_0x1dfb65);}else{if(_0x4eb52a[0x0][_0x55c8d5(0xfb)]==_0x55c8d5(0x133))var _0x1dfb65=users[_0x55c8d5(0x133)];else{if(_0x4eb52a[0x0]['language']==_0x55c8d5(0xcc))var _0x1dfb65=users['German'];else{if(_0x4eb52a[0x0]['language']==_0x55c8d5(0x186))var _0x1dfb65=users['Spanish'];else{if(_0x4eb52a[0x0][_0x55c8d5(0xfb)]=='French')var _0x1dfb65=users[_0x55c8d5(0xd4)];else{if(_0x4eb52a[0x0][_0x55c8d5(0xfb)]==_0x55c8d5(0xe3))var _0x1dfb65=users[_0x55c8d5(0xb8)];else{if(_0x4eb52a[0x0]['language']==_0x55c8d5(0x181))var _0x1dfb65=users[_0x55c8d5(0x181)];else{if(_0x4eb52a[0x0][_0x55c8d5(0xfb)]=='Arabic\x20(ae)')var _0x1dfb65=users[_0x55c8d5(0x8f)];}}}}}}}_0x395f1e['render'](_0x55c8d5(0xf5),{'success':_0x208955[_0x55c8d5(0x10d)](_0x55c8d5(0x124)),'errors':_0x208955[_0x55c8d5(0x10d)](_0x55c8d5(0x175)),'role':_0x2fadbc,'profile':_0xb4b56a,'master_shop':_0x4eb52a,'transfer':_0x2e4408,'language':_0x1dfb65});}catch(_0x4039dc){console[_0x55c8d5(0x119)](_0x4039dc);}});async function getRandom8DigitNumber(){var _0x989fd3=a0_0x182a8c;const _0x20bb87=0x989680,_0x3a578d=0x5f5e0ff,_0x18e37a=Math[_0x989fd3(0x104)](Math['random']()*(_0x3a578d-_0x20bb87+0x1))+_0x20bb87;var _0x419655;const _0x1c5771=await transfers[_0x989fd3(0x152)]({'invoice':_0x989fd3(0x184)+_0x18e37a});return _0x1c5771&&_0x1c5771[_0x989fd3(0x14c)]>0x0?_0x419655=_0x989fd3(0x184)+_0x18e37a:_0x419655='TRF-'+_0x18e37a,_0x419655;}router['get'](a0_0x182a8c(0x191),auth,async(_0x1f19f5,_0x5955dc)=>{var _0x142a73=a0_0x182a8c;try{const {username:_0x2886d4,email:_0x28ccca,role:_0x1ee035}=_0x1f19f5[_0x142a73(0x153)],_0x3a8096=_0x1f19f5[_0x142a73(0x153)],_0x38dccf=await profile['findOne']({'email':_0x3a8096[_0x142a73(0xac)]}),_0x274435=await master_shop[_0x142a73(0xa4)]();console[_0x142a73(0x119)](_0x142a73(0x182),_0x274435);let _0x21bff9;if(_0x3a8096['role']==_0x142a73(0xf7)){const _0x3f774f=await staff[_0x142a73(0x152)]({'email':_0x3a8096[_0x142a73(0xac)]});_0x21bff9=await warehouse['aggregate']([{'$match':{'status':_0x142a73(0x17b),'name':_0x3f774f['warehouse'],'warehouse_category':_0x142a73(0x140)}},{'$group':{'_id':_0x142a73(0x105),'name':{'$first':_0x142a73(0x105)}}}]);}else _0x21bff9=await warehouse['aggregate']([{'$match':{'status':_0x142a73(0x17b),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x142a73(0x105)}}}]);var _0x1797a6=['Ambient',_0x142a73(0xcb),_0x142a73(0x100)];const _0x41ae34=await transfers[_0x142a73(0xa4)]({}),_0x48475e=_0x41ae34['length']+0x1,_0x539c5c=_0x142a73(0x184)+_0x48475e[_0x142a73(0x138)]()[_0x142a73(0x15b)](0x5,'0');if(_0x274435[0x0]['language']==_0x142a73(0xc1)){var _0x1c39ae=users[_0x142a73(0xdc)];console[_0x142a73(0x119)](_0x1c39ae);}else{if(_0x274435[0x0][_0x142a73(0xfb)]==_0x142a73(0x133))var _0x1c39ae=users[_0x142a73(0x133)];else{if(_0x274435[0x0][_0x142a73(0xfb)]==_0x142a73(0xcc))var _0x1c39ae=users[_0x142a73(0xcc)];else{if(_0x274435[0x0][_0x142a73(0xfb)]==_0x142a73(0x186))var _0x1c39ae=users['Spanish'];else{if(_0x274435[0x0]['language']=='French')var _0x1c39ae=users[_0x142a73(0xd4)];else{if(_0x274435[0x0]['language']=='Portuguese\x20(BR)')var _0x1c39ae=users[_0x142a73(0xb8)];else{if(_0x274435[0x0][_0x142a73(0xfb)]=='Chinese')var _0x1c39ae=users[_0x142a73(0x181)];else{if(_0x274435[0x0][_0x142a73(0xfb)]==_0x142a73(0xf1))var _0x1c39ae=users['Arabic'];}}}}}}}const _0x571c67=getRandom8DigitNumber();_0x571c67['then'](_0x419826=>{var _0x4afed0=_0x142a73;_0x5955dc['render'](_0x4afed0(0x135),{'success':_0x1f19f5[_0x4afed0(0x10d)](_0x4afed0(0x124)),'errors':_0x1f19f5['flash'](_0x4afed0(0x175)),'role':_0x3a8096,'profile':_0x38dccf,'master_shop':_0x274435,'warehouse':_0x21bff9,'language':_0x1c39ae,'rooms_data':_0x1797a6,'invoice':_0x419826});})['catch'](_0x5e024a=>{var _0x53c783=_0x142a73;_0x1f19f5['flash'](_0x53c783(0x175),_0x53c783(0xc4)),_0x5955dc['redirect'](_0x53c783(0x10f));});}catch(_0x4e5009){console['log'](_0x4e5009);}}),router[a0_0x182a8c(0x148)](a0_0x182a8c(0x191),auth,async(_0xfe58df,_0x15e397)=>{var _0x3a63e6=a0_0x182a8c;try{console['log'](_0xfe58df[_0x3a63e6(0x108)]);const {date:_0xf7f131,from_warehouse:_0x4249bd,FromRoom_name:_0x2aa1aa,to_warehouse:_0x102788,ToRoom_name:_0x368fe5,prod_name:_0x47b2be,from_prod_qty:_0x6a2b8b,from_prod_level:_0x5382cc,from_prod_isle:_0x5e775b,from_prod_pallet:_0x5c565a,to_prod_qty:_0x2adeea,to_prod_level:_0x41ef74,to_prod_isle:_0x951c5b,to_prod_pallet:_0x5007e8,primary_code:_0x4f2189,secondary_code:_0x4e2793,product_code3:_0xac8d51,note:_0x35856f,MaxStocks_data2:_0x3c2006,invoice:_0x3e8368,expiry_date:_0x13c46c}=_0xfe58df[_0x3a63e6(0x108)];if(typeof _0x47b2be==_0x3a63e6(0x15c))var _0x46c404=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x132)]],_0x2629f6=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xa6)]],_0x5bf6fe=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x14e)]],_0x55ee60=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xba)]],_0xc1d0e4=[_0xfe58df['body']['to_prod_level']],_0x27b2d1=[_0xfe58df['body']['primary_code']],_0x2b67c1=[_0xfe58df['body'][_0x3a63e6(0x113)]],_0x2c2bcc=[_0xfe58df[_0x3a63e6(0x108)]['product_code3']],_0x1c3ec8=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x115)]],_0x2c4650=[_0xfe58df['body'][_0x3a63e6(0x107)]],_0x269519=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xbe)]],_0x458c10=[_0xfe58df['body'][_0x3a63e6(0x16f)]],_0x5a9303=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x173)]],_0x3da2be=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xb6)]],_0x40bee9=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x149)]],_0x2367f7=[_0xfe58df['body'][_0x3a63e6(0xd9)]],_0x4d3175=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x13e)]],_0x23e3d4=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xe8)]],_0x3b55e3=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x17f)]],_0x213aee=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x183)]],_0x53f899=[_0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x106)]];else var _0x46c404=[..._0xfe58df['body'][_0x3a63e6(0x132)]],_0x2629f6=[..._0xfe58df[_0x3a63e6(0x108)]['from_prod_qty']],_0x5bf6fe=[..._0xfe58df[_0x3a63e6(0x108)]['from_prod_level']],_0x55ee60=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xba)]],_0xc1d0e4=[..._0xfe58df['body']['to_prod_level']],_0x27b2d1=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x178)]],_0x2b67c1=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x113)]],_0x2c2bcc=[..._0xfe58df[_0x3a63e6(0x108)]['product_code3']],_0x1c3ec8=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x115)]],_0x2c4650=[..._0xfe58df[_0x3a63e6(0x108)]['primary_unit']],_0x269519=[..._0xfe58df['body'][_0x3a63e6(0xbe)]],_0x458c10=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x16f)]],_0x5a9303=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x173)]],_0x3da2be=[..._0xfe58df['body'][_0x3a63e6(0xb6)]],_0x40bee9=[..._0xfe58df['body'][_0x3a63e6(0x149)]],_0x2367f7=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xd9)]],_0x4d3175=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x13e)]],_0x23e3d4=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0xe8)]],_0x3b55e3=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x17f)]],_0x213aee=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x183)]],_0x53f899=[..._0xfe58df[_0x3a63e6(0x108)][_0x3a63e6(0x106)]];const _0x53e2f0=_0x46c404[_0x3a63e6(0x17a)](_0x4fa5ae=>{return _0x4fa5ae={'product_name':_0x4fa5ae};});_0x2629f6['forEach']((_0x5d3a8b,_0x40a6ec)=>{var _0x482ae4=_0x3a63e6;_0x53e2f0[_0x40a6ec][_0x482ae4(0x129)]=_0x5d3a8b;}),_0x3b55e3[_0x3a63e6(0x12f)]((_0x53931a,_0x4d0bc3)=>{var _0x3f3a47=_0x3a63e6;_0x53e2f0[_0x4d0bc3][_0x3f3a47(0x17f)]=_0x53931a;}),_0x213aee[_0x3a63e6(0x12f)]((_0x3f7c33,_0x1a9149)=>{_0x53e2f0[_0x1a9149]['To_invoice']=_0x3f7c33;}),_0x53f899[_0x3a63e6(0x12f)]((_0x458fbb,_0x3058d1)=>{_0x53e2f0[_0x3058d1]['id_transaction_id']=_0x458fbb;}),_0x5bf6fe[_0x3a63e6(0x12f)]((_0x2e9ee4,_0x329c51)=>{var _0x3b4324=_0x3a63e6;_0x4d3175[_0x3b4324(0x12f)]((_0x140af5,_0x322444)=>{var _0x15bbcd=_0x3b4324;if(_0x140af5=='Receiving\x20Area'&&_0x329c51==_0x322444){var _0x1f31c7=_0x2e9ee4[_0x15bbcd(0x9f)](0x3);_0x53e2f0[_0x329c51][_0x15bbcd(0x18c)]=_0x2e9ee4[0x0],_0x53e2f0[_0x329c51][_0x15bbcd(0x162)]=_0x2e9ee4[0x1],_0x53e2f0[_0x329c51][_0x15bbcd(0xfe)]=0x0,_0x53e2f0[_0x329c51][_0x15bbcd(0x137)]=0x0,_0x53e2f0[_0x329c51]['from_types']=_0x15bbcd(0xae),_0x53e2f0[_0x329c51]['from_floorlevel']=_0x1f31c7;}else{if(_0x140af5==_0x15bbcd(0xde)&&_0x329c51==_0x322444){var _0x1f31c7=_0x2e9ee4[_0x15bbcd(0x9f)](0x3);_0x53e2f0[_0x329c51][_0x15bbcd(0x18c)]=_0x2e9ee4[0x0],_0x53e2f0[_0x329c51][_0x15bbcd(0x162)]=_0x2e9ee4[0x1],_0x53e2f0[_0x329c51][_0x15bbcd(0xfe)]=0x0,_0x53e2f0[_0x329c51]['from_bin']=0x0,_0x53e2f0[_0x329c51][_0x15bbcd(0xe4)]=_0x15bbcd(0xae),_0x53e2f0[_0x329c51][_0x15bbcd(0xc8)]=_0x2e9ee4[0x5];}else{if(_0x329c51==_0x322444){if(_0x2e9ee4[0x0]=='A'&&_0x2e9ee4[0x1]=='L'&&_0x2e9ee4[0x2]=='L')console['log'](_0x140af5+_0x15bbcd(0xdd)+_0x329c51+_0x15bbcd(0xdd)+_0x322444+_0x15bbcd(0xdd)+_0x2e9ee4+_0x15bbcd(0xbf)),_0x53e2f0[_0x329c51][_0x15bbcd(0x18c)]=_0x2e9ee4[0x0],_0x53e2f0[_0x329c51][_0x15bbcd(0x162)]=_0x2e9ee4[0x1],_0x53e2f0[_0x329c51][_0x15bbcd(0xfe)]=0x0,_0x53e2f0[_0x329c51][_0x15bbcd(0x137)]=0x0,_0x53e2f0[_0x329c51][_0x15bbcd(0xe4)]=_0x15bbcd(0xae),_0x53e2f0[_0x329c51][_0x15bbcd(0xc8)]=_0x2e9ee4[0x3];else{var _0x5d830f;if(_0x2e9ee4[0x4]=='L')_0x5d830f=_0x15bbcd(0xc2);else _0x2e9ee4[0x4]=='F'&&(_0x5d830f='Floor');_0x53e2f0[_0x329c51][_0x15bbcd(0x18c)]=_0x2e9ee4[0x0],_0x53e2f0[_0x329c51]['from_rack']=_0x2e9ee4[0x1],_0x53e2f0[_0x329c51][_0x15bbcd(0xfe)]=_0x2e9ee4[0x2],_0x53e2f0[_0x329c51][_0x15bbcd(0x137)]=_0x2e9ee4[0x3],_0x53e2f0[_0x329c51]['from_types']=_0x5d830f,_0x53e2f0[_0x329c51][_0x15bbcd(0xc8)]=_0x2e9ee4[0x5];}}}}});}),_0x55ee60[_0x3a63e6(0x12f)]((_0x27adec,_0x17aefe)=>{_0x53e2f0[_0x17aefe]['to_quantity']=_0x27adec;}),_0xc1d0e4[_0x3a63e6(0x12f)]((_0x121235,_0x24155d)=>{var _0x5714a4=_0x3a63e6;_0x23e3d4[_0x5714a4(0x12f)]((_0x196bd5,_0x326126)=>{var _0x17a988=_0x5714a4;if(_0x196bd5==_0x17a988(0x144)&&_0x24155d==_0x326126){var _0x1fbfd8=_0x121235[_0x17a988(0x9f)](0x3);_0x53e2f0[_0x24155d][_0x17a988(0xc9)]=_0x121235[0x0],_0x53e2f0[_0x24155d]['rack']=_0x121235[0x1],_0x53e2f0[_0x24155d][_0x17a988(0x18d)]=0x0,_0x53e2f0[_0x24155d][_0x17a988(0xfa)]=0x0,_0x53e2f0[_0x24155d][_0x17a988(0xe1)]=_0x17a988(0xae),_0x53e2f0[_0x24155d][_0x17a988(0x18a)]=_0x1fbfd8;}else{if(_0x196bd5==_0x17a988(0xde)&&_0x24155d==_0x326126){var _0x1fbfd8=_0x121235[_0x17a988(0x9f)](0x3);_0x53e2f0[_0x24155d][_0x17a988(0xc9)]=_0x121235[0x0],_0x53e2f0[_0x24155d][_0x17a988(0xc0)]=_0x121235[0x1],_0x53e2f0[_0x24155d]['to_bay']=0x0,_0x53e2f0[_0x24155d][_0x17a988(0xfa)]=0x0,_0x53e2f0[_0x24155d][_0x17a988(0xe1)]=_0x17a988(0xae),_0x53e2f0[_0x24155d][_0x17a988(0x18a)]=_0x121235[0x5];}else{if(_0x24155d==_0x326126){if(_0x121235[0x0]=='A'&&_0x121235[0x1]=='L'&&_0x121235[0x2]=='L')console[_0x17a988(0x119)](_0x196bd5+'\x20<>\x20'+_0x24155d+_0x17a988(0xdd)+_0x326126+_0x17a988(0xdd)+_0x121235+_0x17a988(0xbf)),_0x53e2f0[_0x24155d][_0x17a988(0xc9)]=_0x121235[0x0],_0x53e2f0[_0x24155d][_0x17a988(0xc0)]=_0x121235[0x1],_0x53e2f0[_0x24155d]['to_bay']=0x0,_0x53e2f0[_0x24155d][_0x17a988(0xfa)]=0x0,_0x53e2f0[_0x24155d][_0x17a988(0xe1)]=_0x17a988(0xae),_0x53e2f0[_0x24155d][_0x17a988(0x18a)]=_0x121235[0x3];else{var _0x1b2282;if(_0x121235[0x4]=='L')_0x1b2282='Level';else _0x121235[0x4]=='F'&&(_0x1b2282=_0x17a988(0xae));_0x53e2f0[_0x24155d][_0x17a988(0xc9)]=_0x121235[0x0],_0x53e2f0[_0x24155d][_0x17a988(0xc0)]=_0x121235[0x1],_0x53e2f0[_0x24155d][_0x17a988(0x18d)]=_0x121235[0x2],_0x53e2f0[_0x24155d][_0x17a988(0xfa)]=_0x121235[0x3],_0x53e2f0[_0x24155d][_0x17a988(0xe1)]=_0x1b2282,_0x53e2f0[_0x24155d][_0x17a988(0x18a)]=_0x121235[0x5];}}}}});}),_0x27b2d1['forEach']((_0x411d8b,_0x399a3f)=>{var _0x4bdcf8=_0x3a63e6;_0x53e2f0[_0x399a3f][_0x4bdcf8(0x178)]=_0x411d8b;}),_0x2b67c1[_0x3a63e6(0x12f)]((_0x45408b,_0x5e84a4)=>{var _0x183434=_0x3a63e6;_0x53e2f0[_0x5e84a4][_0x183434(0x113)]=_0x45408b;}),_0x2c2bcc[_0x3a63e6(0x12f)]((_0x42024b,_0x3b125f)=>{var _0x2a55da=_0x3a63e6;_0x53e2f0[_0x3b125f][_0x2a55da(0x99)]=_0x42024b;}),_0x1c3ec8[_0x3a63e6(0x12f)]((_0x36c283,_0x748a27)=>{var _0x4e7e6f=_0x3a63e6;_0x53e2f0[_0x748a27][_0x4e7e6f(0x159)]=_0x36c283;}),_0x2c4650[_0x3a63e6(0x12f)]((_0x1ea677,_0x543e0a)=>{var _0x3b2549=_0x3a63e6;_0x53e2f0[_0x543e0a][_0x3b2549(0xf6)]=_0x1ea677;}),_0x269519[_0x3a63e6(0x12f)]((_0x31342d,_0x19b55f)=>{var _0x3665d8=_0x3a63e6;_0x53e2f0[_0x19b55f][_0x3665d8(0xbe)]=_0x31342d;}),_0x458c10[_0x3a63e6(0x12f)]((_0x3fd626,_0x820b85)=>{var _0x125779=_0x3a63e6;_0x53e2f0[_0x820b85][_0x125779(0x16f)]=_0x3fd626;}),_0x5a9303['forEach']((_0x10e65c,_0x267b26)=>{_0x53e2f0[_0x267b26]['expiry_date']=_0x10e65c;}),_0x3da2be[_0x3a63e6(0x12f)]((_0x472b07,_0x2ec2ba)=>{_0x53e2f0[_0x2ec2ba]['maxperunit']=_0x472b07;}),_0x40bee9[_0x3a63e6(0x12f)]((_0x46c6eb,_0x1fcac2)=>{var _0x2c78a6=_0x3a63e6;_0x53e2f0[_0x1fcac2][_0x2c78a6(0x149)]=_0x46c6eb;}),_0x2367f7[_0x3a63e6(0x12f)]((_0x4cb337,_0xd3c544)=>{var _0x538793=_0x3a63e6;_0x53e2f0[_0xd3c544][_0x538793(0xd9)]=_0x4cb337;}),_0x4d3175['forEach']((_0xc4e6d8,_0x4579ed)=>{var _0x4c239b=_0x3a63e6;_0x53e2f0[_0x4579ed][_0x4c239b(0x123)]=_0xc4e6d8;}),_0x23e3d4['forEach']((_0x21f3ba,_0x29ec09)=>{var _0x16029a=_0x3a63e6;_0x53e2f0[_0x29ec09][_0x16029a(0x151)]=_0x21f3ba;});const _0x137dc7=_0x53e2f0[_0x3a63e6(0x157)](_0x104ab0=>_0x104ab0['to_quantity']!=='0'&&_0x104ab0[_0x3a63e6(0xc7)]!==''||_0x104ab0['to_floorlevel']!=='0'&&_0x104ab0[_0x3a63e6(0x18a)]!==''),_0x3de318=new transfers({'date':_0xf7f131,'from_warehouse':_0x4249bd,'to_warehouse':_0x102788,'product':_0x137dc7,'note':_0x35856f,'invoice':_0x3e8368}),_0xee2d5=await _0x3de318['save']();_0xfe58df['flash'](_0x3a63e6(0x124),_0x3a63e6(0x98)),_0x15e397['redirect'](_0x3a63e6(0xef)+_0xee2d5['_id']);}catch(_0x38eef5){console[_0x3a63e6(0x119)](_0x38eef5),_0x15e397[_0x3a63e6(0x92)](0xc8)[_0x3a63e6(0x14f)]({'errorMessage':_0x38eef5[_0x3a63e6(0x121)]});}}),router['get'](a0_0x182a8c(0xdf),auth,async(_0x4a1c8f,_0x48b8a5)=>{var _0x5c3ecf=a0_0x182a8c;try{const {username:_0x13370f,email:_0x2a5f25,role:_0x325efb}=_0x4a1c8f[_0x5c3ecf(0x153)],_0x202b3a=_0x4a1c8f[_0x5c3ecf(0x153)],_0x41c99d=await profile[_0x5c3ecf(0x152)]({'email':_0x202b3a[_0x5c3ecf(0xac)]}),_0x12ee22=await master_shop[_0x5c3ecf(0xa4)]();console[_0x5c3ecf(0x119)](_0x5c3ecf(0x182),_0x12ee22);const _0x58c7f3=await transfers[_0x5c3ecf(0x171)](_0x4a1c8f[_0x5c3ecf(0xbb)]['id']);let _0x2167e4=new Date(_0x58c7f3[_0x5c3ecf(0x173)]),_0x473132=('0'+_0x2167e4[_0x5c3ecf(0x17d)]())[_0x5c3ecf(0x9f)](-0x2),_0x1ca3e=('0'+(_0x2167e4[_0x5c3ecf(0x9b)]()+0x1))[_0x5c3ecf(0x9f)](-0x2),_0x45fa03=_0x2167e4[_0x5c3ecf(0xb4)](),_0x3264bf=_0x45fa03+'-'+_0x1ca3e+'-'+_0x473132,_0x1aa267;if(_0x202b3a[_0x5c3ecf(0xe9)]==_0x5c3ecf(0xf7)){const _0x453286=await staff[_0x5c3ecf(0x152)]({'email':_0x202b3a[_0x5c3ecf(0xac)]});_0x1aa267=await warehouse['find']({'status':'Enabled','name':_0x453286[_0x5c3ecf(0x13c)],'warehouse_category':_0x5c3ecf(0x140)});}else _0x1aa267=await warehouse[_0x5c3ecf(0xa4)]({'status':_0x5c3ecf(0x17b),'warehouse_category':'Raw\x20Materials'});const _0x82e58a=await warehouse[_0x5c3ecf(0xf4)]([{'$match':{'name':_0x58c7f3['from_warehouse']}},{'$unwind':_0x5c3ecf(0x13b)},{'$group':{'_id':_0x5c3ecf(0xed),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5c3ecf(0x11d)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5c3ecf(0xd6)},'floorlevel':{'$first':_0x5c3ecf(0xa2)},'primary_code':{'$first':_0x5c3ecf(0xb3)},'secondary_code':{'$first':_0x5c3ecf(0x9e)},'product_code':{'$first':_0x5c3ecf(0x131)},'storage':{'$first':_0x5c3ecf(0xa5)},'rack':{'$first':_0x5c3ecf(0x190)},'expiry_date':{'$first':_0x5c3ecf(0xbd)},'production_date':{'$first':_0x5c3ecf(0x145)},'room':{'$first':_0x5c3ecf(0x147)}}}]);if(_0x12ee22[0x0][_0x5c3ecf(0xfb)]==_0x5c3ecf(0xc1)){var _0x58e7a4=users['English'];console[_0x5c3ecf(0x119)](_0x58e7a4);}else{if(_0x12ee22[0x0][_0x5c3ecf(0xfb)]=='Hindi')var _0x58e7a4=users['Hindi'];else{if(_0x12ee22[0x0]['language']==_0x5c3ecf(0xcc))var _0x58e7a4=users[_0x5c3ecf(0xcc)];else{if(_0x12ee22[0x0][_0x5c3ecf(0xfb)]==_0x5c3ecf(0x186))var _0x58e7a4=users['Spanish'];else{if(_0x12ee22[0x0]['language']==_0x5c3ecf(0xd4))var _0x58e7a4=users['French'];else{if(_0x12ee22[0x0][_0x5c3ecf(0xfb)]==_0x5c3ecf(0xe3))var _0x58e7a4=users[_0x5c3ecf(0xb8)];else{if(_0x12ee22[0x0][_0x5c3ecf(0xfb)]=='Chinese')var _0x58e7a4=users[_0x5c3ecf(0x181)];else{if(_0x12ee22[0x0][_0x5c3ecf(0xfb)]=='Arabic\x20(ae)')var _0x58e7a4=users[_0x5c3ecf(0x8f)];}}}}}}}_0x48b8a5[_0x5c3ecf(0x94)](_0x5c3ecf(0xe5),{'success':_0x4a1c8f['flash'](_0x5c3ecf(0x124)),'errors':_0x4a1c8f[_0x5c3ecf(0x10d)](_0x5c3ecf(0x175)),'role':_0x202b3a,'profile':_0x41c99d,'master_shop':_0x12ee22,'warehouse':_0x1aa267,'transfer':_0x58c7f3,'stock':_0x82e58a,'language':_0x58e7a4});}catch(_0x354656){console['log'](_0x354656);}});function a0_0x2bf3(){var _0x544e54=['$product_details.level','Portuguese','<!DOCTYPE\x20html>','New_Qty_Converted','params','/view/:id','$product_details.expiry_date','secondary_unit','here','rack','English\x20(US)','Level','Products\x20updated\x20successfully.','There\x27s\x20a\x20error\x20in\x20this\x20transaction','bay','delivery_date','to_quantity','from_floorlevel','storage','invoice','Enclosed','German','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product.to_room_name','to_prod_level','from_warehouse','dotenv','113301vMJyHY','/barcode_scanner3','French','note','$product_details.type','port','mongoose','prod_cat','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','from_prod_isle','English','\x20<>\x20','Shelves','/preview/:id','bin','to_types','$product_details.unit','Portuguese\x20(BR)','from_types','edit_transfer_view','../public/language/languages.json','1606210hJKhIQ','ToRoomAssigned','role','$isAllowEdit','push','../models/all_models','$product_details._id','Rack\x20E','/transfer/preview/','$product_details.bay','Arabic\x20(ae)','Error\x20Occurs','Transfer\x20Finalize\x20Successfully','aggregate','transfer','unit','staff','image','endSession','to_bin','language','maxperunit','<h2>\x20','from_bay','product_details','Return\x20Rooms','site_title','$product.from_room_name','</div>','floor','$name','id_transaction','primary_unit','body','<tr>','..............from\x20deducted.....................','nodemailer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','flash','$product_details.batch_code','/transfer/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','concat','sendMail','secondary_code','from_prod_pallet','MaxStocks_data2','finalize','express','COLD\x20STORAGE','log','date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','\x20and\x20QTY\x20:\x20','$product_details.product_stock','</body></html>','/picking_list/PDF_transfer_rm/','331222BjUkRB','message','rak','from_room_name','success','get','True','to_prod_isle','$product_details.product_name','from_quantity','$product','No\x20warehouse\x20data\x20found\x20for\x20room:\x20','..............to\x20deducted.....................','147892nHplji','session','forEach','/CheckingWarehouse','$product_details.product_code','prod_name','Hindi','floorlevel','add_transfer','Email\x20sent\x20successfully','from_bin','toString','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','</head><body>','$product_details','warehouse','$product_details.isle','RoomAssigned','back','Raw\x20Materials','from_rak','password','<h5\x20style=\x22text-align:\x20left;\x22>','Receiving\x20Area','$product_details.production_date','delivery_code','$room','post','production_date','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','withTransaction','length','to_prod_pallet','from_prod_level','json','Rack\x20D','to_room_name','findOne','user','Rack\x20B','$_id','type','filter','updateOne','maxProducts','<h5>','padStart','string','\x20</h2>','alertQTY','exports','redirect','</table>','from_rack','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.bin','product_stock','toFixed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','to_warehouse','startSession','to_prod_qty','$product_details.invoice','product_code3','</tbody>','</td>','batch_code','$date','findById','../middleware/auth','expiry_date','$product_details.secondary_unit','errors','config','$product_details.maxPerUnit','primary_code','$from_warehouse','map','Enabled','..............connected.....................','getDate','Types','from_invoice','not\x20meet\x20the\x20need\x20stock','Chinese','master','to_invoice','TRF-','$product_details.pallet','Spanish','meet\x20the\x20need\x20stock','<span\x20style=\x22float:\x20right;\x22>','edit_transfer','to_floorlevel','\x20Order\x20Number\x20:\x20','from_storage','to_bay','<div>','logo','$product_details.rack','/view/add_transfer','</tr>','product_name','184aXpBmt','/barcode_scanner','870945bKlUGI','Arabic','ObjectId','<strong>\x20Regards\x20</strong>','status','5UdVVsd','render','42najOmH','split','..............disconnected.....................','Product\x20Transfer\x20successfully','product_code','save','getMonth','Logo.png','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.secondary_code','slice','</h5>','Transfer\x20Mail','$product_details.floorlevel','createTransport','find','$product_details.storage','from_prod_qty','$product_details.maxProducts','/view','from_room','169319CpJSbp','abortTransaction','email','RMSEmail','Floor','125230ajXNMu','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Transfer\x20Edit\x20Successfully','_id','$product_details.primary_code','getFullYear','product','max_per_unit'];a0_0x2bf3=function(){return _0x544e54;};return a0_0x2bf3();}async function updateProduct_detl(_0x4de987){var _0x59c3df=a0_0x182a8c;const _0x150272=await mongoose[_0x59c3df(0x169)]();try{console[_0x59c3df(0x119)](_0x59c3df(0x17c));const _0x582e34=mongoose[_0x59c3df(0x17e)][_0x59c3df(0x90)];return await _0x150272[_0x59c3df(0x14b)](async()=>{var _0x54ac54=_0x59c3df;for(const _0x6ef5ae of _0x4de987[_0x54ac54(0xb5)]){console['log'](new _0x582e34());const _0x497462=await warehouse[_0x54ac54(0xf4)]([{'$match':{'name':_0x4de987['from_warehouse'],'room':_0x6ef5ae[_0x54ac54(0x123)]}},{'$unwind':_0x54ac54(0x13b)},{'$match':{'product_details._id':_0x582e34(_0x6ef5ae['id_transaction_id'])}}])[_0x54ac54(0x12e)](_0x150272);if(_0x497462[_0x54ac54(0x14c)]===0x0)throw new Error(_0x54ac54(0x12b)+_0x6ef5ae['from_room_name']);for(const _0x2b0f32 of _0x497462){console['log'](parseFloat(_0x2b0f32[_0x54ac54(0xff)][_0x54ac54(0x165)][_0x54ac54(0x166)](0x2))>=parseFloat(_0x6ef5ae[_0x54ac54(0xc7)][_0x54ac54(0x166)](0x2)));if(parseFloat(_0x2b0f32[_0x54ac54(0xff)][_0x54ac54(0x165)][_0x54ac54(0x166)](0x2))>=parseFloat(_0x6ef5ae[_0x54ac54(0xc7)]['toFixed'](0x2))){let _0x3a6272=(parseFloat(_0x2b0f32['product_details'][_0x54ac54(0x165)]['toFixed'](0x2))-parseFloat(_0x6ef5ae['to_quantity']))[_0x54ac54(0x166)](0x2);console[_0x54ac54(0x119)](_0x54ac54(0x187),_0x3a6272),console[_0x54ac54(0x119)](_0x54ac54(0x10a)),await warehouse[_0x54ac54(0x158)]({'_id':_0x582e34(_0x2b0f32[_0x54ac54(0xb2)]),'product_details._id':_0x582e34(_0x2b0f32['product_details'][_0x54ac54(0xb2)])},{'$set':{'product_details.$.product_stock':_0x3a6272,'product_details.$.trf_invoice':_0x4de987[_0x54ac54(0xca)]}},{'session':_0x150272});const _0x1ecf16=await warehouse[_0x54ac54(0xf4)]([{'$match':{'name':_0x4de987[_0x54ac54(0x168)],'room':_0x6ef5ae[_0x54ac54(0x151)]}}])[_0x54ac54(0x12e)](_0x150272);console[_0x54ac54(0x119)](_0x54ac54(0x12c)),await warehouse[_0x54ac54(0x158)]({'name':_0x4de987[_0x54ac54(0x168)],'room':_0x6ef5ae[_0x54ac54(0x151)]},{'$push':{'product_details':{'product_name':_0x6ef5ae[_0x54ac54(0x193)],'product_stock':_0x6ef5ae['to_quantity'],'primary_code':_0x6ef5ae[_0x54ac54(0x178)],'secondary_code':_0x6ef5ae['secondary_code'],'product_code':_0x6ef5ae[_0x54ac54(0x99)],'storage':_0x6ef5ae[_0x54ac54(0xc9)],'rack':_0x6ef5ae[_0x54ac54(0xc0)],'bay':_0x6ef5ae[_0x54ac54(0x18d)],'bin':_0x6ef5ae['to_bin'],'type':_0x6ef5ae[_0x54ac54(0xe1)],'floorlevel':_0x6ef5ae[_0x54ac54(0x18a)],'maxProducts':_0x6ef5ae['maxProducts'],'expiry_date':_0x6ef5ae[_0x54ac54(0x173)],'production_date':_0x6ef5ae[_0x54ac54(0x149)],'maxPerUnit':_0x6ef5ae[_0x54ac54(0xfc)],'batch_code':_0x6ef5ae[_0x54ac54(0x16f)],'unit':_0x6ef5ae[_0x54ac54(0xf6)],'secondary_unit':_0x6ef5ae[_0x54ac54(0xbe)],'alertQTY':_0x2b0f32[_0x54ac54(0xff)][_0x54ac54(0x15e)],'delivery_date':_0x2b0f32[_0x54ac54(0xff)][_0x54ac54(0xc6)],'delivery_code':_0x2b0f32[_0x54ac54(0xff)][_0x54ac54(0x146)],'product_cat':_0x2b0f32[_0x54ac54(0xff)]['product_cat'],'invoice':_0x6ef5ae[_0x54ac54(0x17f)],'trf_invoice':_0x4de987[_0x54ac54(0xca)],'date_data':_0x4de987[_0x54ac54(0x11a)],'_id':new _0x582e34()}}},{'session':_0x150272});}else{console[_0x54ac54(0x119)](_0x54ac54(0x180),QTYTotal);throw new Error('No\x20matching\x20document\x20found\x20for\x20product\x20ID\x20'+_0x2b0f32['_id']+_0x54ac54(0x11c)+QTYTotal);}}}}),{'success':!![],'message':_0x59c3df(0xc3)};}catch(_0x1cfb65){return console[_0x59c3df(0x119)](_0x1cfb65),await _0x150272[_0x59c3df(0xab)](),console['log']('Transaction\x20aborted.'),{'success':![],'message':_0x1cfb65['message']};}finally{_0x150272[_0x59c3df(0xf9)](),console['log'](_0x59c3df(0x97));}}router[a0_0x182a8c(0x148)](a0_0x182a8c(0xdf),auth,async(_0x5345b9,_0x3b8998)=>{var _0x1ecfa0=a0_0x182a8c;try{const _0x1c40b4=_0x5345b9[_0x1ecfa0(0xbb)]['id'],{from_warehouse:_0x3e4ec5,FromRoom_name:_0x16aebb,to_warehouse:_0x537afa,ToRoom_name:_0x3f066c}=_0x5345b9[_0x1ecfa0(0x108)],_0x181088=await transfers[_0x1ecfa0(0x171)]({'_id':_0x1c40b4});await updateProduct_detl(_0x181088),_0x181088[_0x1ecfa0(0x116)]=_0x1ecfa0(0x126);const _0x3aec64=await _0x181088['save'](),_0x5eaf59=await master_shop[_0x1ecfa0(0xa4)](),_0x57a28f=await email_settings['findOne'](),_0x381f62=await supervisor_settings[_0x1ecfa0(0xa4)]();var _0x129807=_0x181088[_0x1ecfa0(0xb5)],_0x4d706b='',_0x8df561;for(_0x8df561 in _0x129807){_0x4d706b+=_0x1ecfa0(0x109)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x129807[_0x8df561][_0x1ecfa0(0x193)]+_0x1ecfa0(0x16e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x129807[_0x8df561][_0x1ecfa0(0x99)]+_0x1ecfa0(0x16e)+_0x1ecfa0(0xb0)+_0x129807[_0x8df561][_0x1ecfa0(0xc7)]+_0x1ecfa0(0x16e)+_0x1ecfa0(0xb0)+_0x129807[_0x8df561]['unit']+_0x1ecfa0(0x16e)+_0x1ecfa0(0xb0)+_0x129807[_0x8df561][_0x1ecfa0(0xbe)]+_0x1ecfa0(0x16e)+_0x1ecfa0(0xb0)+_0x181088[_0x1ecfa0(0x168)]+'</td>'+_0x1ecfa0(0xb0)+_0x129807[_0x8df561][_0x1ecfa0(0x151)]+'</td>'+_0x1ecfa0(0xb0)+_0x129807[_0x8df561][_0x1ecfa0(0xc9)]+_0x129807[_0x8df561]['rack']+_0x129807[_0x8df561][_0x1ecfa0(0x18d)]+_0x129807[_0x8df561][_0x1ecfa0(0xfa)]+_0x129807[_0x8df561][_0x1ecfa0(0xe1)][0x0]+_0x129807[_0x8df561]['to_floorlevel']+_0x1ecfa0(0x16e),_0x1ecfa0(0x192);}let _0x771ad1=nodemailer[_0x1ecfa0(0xa3)]({'host':_0x57a28f['host'],'port':Number(_0x57a28f[_0x1ecfa0(0xd7)]),'secure':![],'auth':{'user':_0x57a28f[_0x1ecfa0(0xac)],'pass':_0x57a28f[_0x1ecfa0(0x142)]}}),_0x156308={'from':_0x57a28f[_0x1ecfa0(0xac)],'to':_0x381f62[0x0][_0x1ecfa0(0xad)],'subject':_0x1ecfa0(0xa1),'attachments':[{'filename':_0x1ecfa0(0x9c),'path':__dirname+'/../public'+'/upload/'+_0x5eaf59[0x0][_0x1ecfa0(0xf8)],'cid':_0x1ecfa0(0x18f)}],'html':_0x1ecfa0(0xb9)+'<html><head><title></title>'+_0x1ecfa0(0x13a)+_0x1ecfa0(0x18e)+_0x1ecfa0(0x14a)+_0x1ecfa0(0x18e)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1ecfa0(0x103)+_0x1ecfa0(0x18e)+_0x1ecfa0(0xfd)+_0x5eaf59[0x0]['site_title']+_0x1ecfa0(0x15d)+_0x1ecfa0(0x103)+_0x1ecfa0(0x103)+'<hr\x20class=\x22my-3\x22>'+_0x1ecfa0(0x18e)+_0x1ecfa0(0x143)+_0x1ecfa0(0x18b)+_0x181088[_0x1ecfa0(0xca)]+'\x20'+_0x1ecfa0(0x188)+'\x20Order\x20Date\x20:\x20'+_0x181088[_0x1ecfa0(0x11a)]+'\x20'+'</span>'+_0x1ecfa0(0xa0)+_0x1ecfa0(0x103)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1ecfa0(0xda)+_0x1ecfa0(0x109)+_0x1ecfa0(0x9d)+_0x1ecfa0(0xcd)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x1ecfa0(0x11b)+_0x1ecfa0(0x167)+_0x1ecfa0(0x10c)+_0x1ecfa0(0x139)+_0x1ecfa0(0x110)+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4d706b+'\x20'+_0x1ecfa0(0x16d)+_0x1ecfa0(0x161)+_0x1ecfa0(0x18e)+_0x1ecfa0(0x91)+_0x1ecfa0(0x15a)+_0x5eaf59[0x0][_0x1ecfa0(0x101)]+_0x1ecfa0(0xa0)+'</div>'+_0x1ecfa0(0x103)+_0x1ecfa0(0x11e)};_0x771ad1[_0x1ecfa0(0x112)](_0x156308,function(_0xbcced7,_0x12c42b){var _0x45b7ad=_0x1ecfa0;_0xbcced7?(console[_0x45b7ad(0x119)](_0xbcced7),console['log'](_0x45b7ad(0xf2))):console['log'](_0x45b7ad(0x136));}),_0x5345b9[_0x1ecfa0(0x10d)](_0x1ecfa0(0x124),_0x1ecfa0(0xf3)),_0x3b8998[_0x1ecfa0(0x160)](_0x1ecfa0(0x11f)+_0x3aec64['_id']);}catch(_0x92a773){console[_0x1ecfa0(0x119)](_0x92a773);}});function BayBinSelected(_0x472466,_0x90430f){var _0x38dee1=a0_0x182a8c,_0xe5f578=[],_0xfbc322=[],_0x2ca693=[],_0x1409df=[],_0x399606=[],_0x3e36c1=[];let _0x35db2d=[];if(_0x472466=='DRY\x20STORAGE')switch(_0x90430f){case'Rack\x20A':_0xe5f578=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0xfbc322=[0x1,0x2],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=[_0x38dee1(0xc2),_0x38dee1(0xae)],_0x399606=['D'],_0x3e36c1=['A'];break;case _0x38dee1(0x154):_0xe5f578=[0x6,0x5,0x4,0x3,0x2,0x1],_0xfbc322=[0x1,0x2],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=[_0x38dee1(0xc2),_0x38dee1(0xae)],_0x399606=['D'],_0x3e36c1=['B'];break;case _0x38dee1(0xde):_0xe5f578=[0x0],_0xfbc322=[0x0],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=[_0x38dee1(0xae)],_0x399606=['D'],_0x3e36c1=['S'];break;case _0x38dee1(0x144):_0xe5f578=[0x0],_0xfbc322=[0x0],_0x1409df=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x2ca693=[_0x38dee1(0xae)],_0x399606=['D'],_0x3e36c1=['R'];break;}else{if(_0x472466==_0x38dee1(0x118))switch(_0x90430f){case'Rack\x20A':_0xe5f578=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0xfbc322=['B','F'],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=[_0x38dee1(0xc2),_0x38dee1(0xae)],_0x399606=['C'],_0x3e36c1=['A'];break;case _0x38dee1(0x154):_0xe5f578=[0x5,0x4,0x3,0x2,0x1],_0xfbc322=['F','B','S'],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=[_0x38dee1(0xc2),_0x38dee1(0xae)],_0x399606=['C'],_0x3e36c1=['B'];break;case'Rack\x20C':_0xe5f578=[0x1,0x2,0x3,0x4,0x5],_0xfbc322=['B','F','S'],_0x1409df=[0x5,0x4,0x3,0x2,0x1],_0x2ca693=[_0x38dee1(0xc2),_0x38dee1(0xae)],_0x399606=['C'],_0x3e36c1=['C'];break;case _0x38dee1(0x150):_0xe5f578=[0x5,0x4,0x3,0x2,0x1],_0xfbc322=['F','B','S'],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=[_0x38dee1(0xc2),_0x38dee1(0xae)],_0x399606=['C'],_0x3e36c1=['D'];break;case _0x38dee1(0xee):_0xe5f578=[0x4,0x3,0x2,0x1],_0xfbc322=[0x1,0x2],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=['Level',_0x38dee1(0xae)],_0x399606=['C'],_0x3e36c1=['E'];break;case'Rack\x20F':_0xe5f578=[0x1,0x2,0x3],_0xfbc322=[0x1,0x2],_0x1409df=[0x1,0x2,0x3,0x4,0x5],_0x2ca693=[_0x38dee1(0xc2)],_0x399606=['C'],_0x3e36c1=['F'];break;}}return{'levels':_0xe5f578,'Isle':_0xfbc322,'rack':_0x1409df,'type':_0x2ca693,'storage':_0x399606,'rak':_0x3e36c1};}router[a0_0x182a8c(0x125)](a0_0x182a8c(0xbc),auth,async(_0x346478,_0x34d886)=>{var _0x5d30ff=a0_0x182a8c;try{const {username:_0x5eff01,email:_0x14855a,role:_0x566399}=_0x346478[_0x5d30ff(0x153)],_0x2061f6=_0x346478['user'],_0x564b53=await profile[_0x5d30ff(0x152)]({'email':_0x2061f6[_0x5d30ff(0xac)]}),_0x24bbff=await master_shop[_0x5d30ff(0xa4)](),_0x113a59=await transfers['findById'](_0x346478['params']['id']);let _0x1a4fbd;if(_0x2061f6[_0x5d30ff(0xe9)]=='staff'){const _0x3df1ef=await staff['findOne']({'email':_0x2061f6[_0x5d30ff(0xac)]});_0x1a4fbd=await warehouse[_0x5d30ff(0xf4)]([{'$match':{'status':_0x5d30ff(0x17b),'name':_0x3df1ef['warehouse'],'warehouse_category':_0x5d30ff(0x140)}},{'$group':{'_id':_0x5d30ff(0x105),'name':{'$first':_0x5d30ff(0x105)}}}]);}else _0x1a4fbd=await warehouse[_0x5d30ff(0xf4)]([{'$match':{'status':_0x5d30ff(0x17b),'warehouse_category':_0x5d30ff(0x140)}},{'$group':{'_id':'$name','name':{'$first':_0x5d30ff(0x105)}}}]);const _0x1cf924=await warehouse[_0x5d30ff(0xf4)]([{'$match':{'name':_0x113a59['from_warehouse'],'warehouse_category':_0x5d30ff(0x140)}},{'$unwind':_0x5d30ff(0x13b)},{'$group':{'_id':_0x5d30ff(0xed),'name':{'$first':_0x5d30ff(0x128)},'product_stock':{'$first':_0x5d30ff(0x11d)},'bay':{'$first':_0x5d30ff(0xf0)},'bin':{'$first':_0x5d30ff(0x164)},'type':{'$first':_0x5d30ff(0xd6)},'floorlevel':{'$first':_0x5d30ff(0xa2)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5d30ff(0x9e)},'product_code':{'$first':_0x5d30ff(0x131)},'storage':{'$first':_0x5d30ff(0xa5)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5d30ff(0xbd)},'production_date':{'$first':_0x5d30ff(0x145)},'room':{'$first':_0x5d30ff(0x147)}}}]),_0x12705a=await product['find']({}),_0xba2c83=BayBinSelected(_0x113a59[_0x5d30ff(0x168)],_0x113a59['to_room']);if(_0x24bbff[0x0]['language']==_0x5d30ff(0xc1)){var _0x19a3bd=users[_0x5d30ff(0xdc)];console['log'](_0x19a3bd);}else{if(_0x24bbff[0x0][_0x5d30ff(0xfb)]==_0x5d30ff(0x133))var _0x19a3bd=users[_0x5d30ff(0x133)];else{if(_0x24bbff[0x0][_0x5d30ff(0xfb)]==_0x5d30ff(0xcc))var _0x19a3bd=users[_0x5d30ff(0xcc)];else{if(_0x24bbff[0x0][_0x5d30ff(0xfb)]=='Spanish')var _0x19a3bd=users[_0x5d30ff(0x186)];else{if(_0x24bbff[0x0][_0x5d30ff(0xfb)]==_0x5d30ff(0xd4))var _0x19a3bd=users[_0x5d30ff(0xd4)];else{if(_0x24bbff[0x0]['language']==_0x5d30ff(0xe3))var _0x19a3bd=users[_0x5d30ff(0xb8)];else{if(_0x24bbff[0x0][_0x5d30ff(0xfb)]==_0x5d30ff(0x181))var _0x19a3bd=users[_0x5d30ff(0x181)];else{if(_0x24bbff[0x0][_0x5d30ff(0xfb)]==_0x5d30ff(0xf1))var _0x19a3bd=users[_0x5d30ff(0x8f)];}}}}}}}_0x34d886['render'](_0x5d30ff(0x189),{'success':_0x346478['flash']('success'),'errors':_0x346478[_0x5d30ff(0x10d)]('errors'),'role':_0x2061f6,'profile':_0x564b53,'master_shop':_0x24bbff,'warehouse':_0x1a4fbd,'transfer':_0x113a59,'stock':_0x1cf924,'unit':_0x12705a,'language':_0x19a3bd});}catch(_0x52a81a){console['log'](_0x52a81a);}}),router[a0_0x182a8c(0x148)](a0_0x182a8c(0xbc),auth,async(_0x902a24,_0xe3dbf5)=>{var _0xa7ca12=a0_0x182a8c;try{const _0x114d98=_0x902a24[_0xa7ca12(0xbb)]['id'],_0x3e4cea=await transfers['findById'](_0x114d98);_0xe3dbf5[_0xa7ca12(0x14f)](_0x902a24['body']);return;const {date:_0x16fe3e,from_warehouse:_0x2a02f5,FromRoom_name:_0x298eb7,to_warehouse:_0x58f64a,ToRoom_name:_0x16d3bd,prod_name:_0x54227d,from_prod_qty:_0x4f9773,from_prod_level:_0x3a2374,from_prod_isle:_0x41f582,from_prod_pallet:_0x374299,to_prod_qty:_0x64f2ff,to_prod_level:_0x2dcc37,to_prod_isle:_0x2779c2,to_prod_pallet:_0xce3fd2,primary_code:_0x2caa72,secondary_code:_0x19a095,product_code3:_0x4035ca,note:_0x54858c,invoice:_0x1008c8,expiry_date:_0x19f1e5}=_0x902a24[_0xa7ca12(0x108)];if(typeof _0x54227d=='string')var _0x35e782=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x132)]],_0x64468=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xa6)]],_0x4435e2=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x14e)]],_0xcc3583=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xdb)]],_0x4b9903=[_0x902a24['body'][_0xa7ca12(0x114)]],_0x415d92=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xe4)]],_0x2f2d0c=[_0x902a24['body'][_0xa7ca12(0x16a)]],_0xc7786c=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xcf)]],_0x2cc988=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x127)]],_0x31ac09=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x14d)]],_0x14bf8c=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xe1)]],_0x55ed63=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xc9)]],_0xd1822b=[_0x902a24['body'][_0xa7ca12(0x122)]],_0x31d730=[_0x902a24[_0xa7ca12(0x108)]['primary_code']],_0x3ca9ea=[_0x902a24['body'][_0xa7ca12(0x113)]],_0x32f365=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x16c)]],_0x10bd49=[_0x902a24['body'][_0xa7ca12(0x115)]],_0x59fa61=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xf6)]],_0x5e0497=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xbe)]],_0x550539=[_0x902a24[_0xa7ca12(0x108)]['batch_code']],_0x351657=[_0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x173)]],_0x3096f8=[_0x902a24['body']['from_storage']],_0x23317b=[_0x902a24['body'][_0xa7ca12(0x141)]];else var _0x35e782=[..._0x902a24[_0xa7ca12(0x108)]['prod_name']],_0x55ed63=[..._0x902a24['body']['storage']],_0xd1822b=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x122)]],_0x415d92=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xe4)]],_0x14bf8c=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xe1)]],_0x64468=[..._0x902a24['body'][_0xa7ca12(0xa6)]],_0x4435e2=[..._0x902a24[_0xa7ca12(0x108)]['from_prod_level']],_0xcc3583=[..._0x902a24['body'][_0xa7ca12(0xdb)]],_0x4b9903=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x114)]],_0x2f2d0c=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x16a)]],_0xc7786c=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xcf)]],_0x2cc988=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x127)]],_0x31ac09=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x14d)]],_0x31d730=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x178)]],_0x3ca9ea=[..._0x902a24[_0xa7ca12(0x108)]['secondary_code']],_0x32f365=[..._0x902a24[_0xa7ca12(0x108)]['product_code3']],_0x10bd49=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x115)]],_0x59fa61=[..._0x902a24['body'][_0xa7ca12(0xf6)]],_0x5e0497=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0xbe)]],_0x550539=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x16f)]],_0x351657=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x173)]],_0x3096f8=[..._0x902a24[_0xa7ca12(0x108)]['from_storage']],_0x23317b=[..._0x902a24[_0xa7ca12(0x108)][_0xa7ca12(0x141)]];const _0x39d843=_0x35e782[_0xa7ca12(0x17a)](_0x7b1956=>{return _0x7b1956={'product_name':_0x7b1956};});_0x64468[_0xa7ca12(0x12f)]((_0x3532be,_0x503664)=>{var _0x581a39=_0xa7ca12;_0x39d843[_0x503664][_0x581a39(0x129)]=_0x3532be;}),_0x4435e2[_0xa7ca12(0x12f)]((_0x5daf01,_0x11a1ff)=>{var _0x46febe=_0xa7ca12;_0x39d843[_0x11a1ff][_0x46febe(0xfe)]=_0x5daf01;}),_0xcc3583[_0xa7ca12(0x12f)]((_0x18488e,_0x5e6a1a)=>{_0x39d843[_0x5e6a1a]['from_bin']=_0x18488e;}),_0x4b9903[_0xa7ca12(0x12f)]((_0x1df5d5,_0x583f8c)=>{var _0x223111=_0xa7ca12;_0x39d843[_0x583f8c][_0x223111(0xc8)]=_0x1df5d5;}),_0x2f2d0c[_0xa7ca12(0x12f)]((_0xa8dc22,_0x3fdb30)=>{var _0x3dbaef=_0xa7ca12;_0x39d843[_0x3fdb30][_0x3dbaef(0xc7)]=_0xa8dc22;}),_0xc7786c[_0xa7ca12(0x12f)]((_0x9d768c,_0x304442)=>{var _0x35d8f5=_0xa7ca12;_0x39d843[_0x304442][_0x35d8f5(0x18d)]=_0x9d768c;}),_0x2cc988[_0xa7ca12(0x12f)]((_0x4cb9c2,_0x39aa3a)=>{_0x39d843[_0x39aa3a]['to_bin']=_0x4cb9c2;}),_0x31ac09[_0xa7ca12(0x12f)]((_0x5046cb,_0x53ca8b)=>{var _0x25cd2c=_0xa7ca12;_0x39d843[_0x53ca8b][_0x25cd2c(0x18a)]=_0x5046cb;}),_0x31d730[_0xa7ca12(0x12f)]((_0x2e1ce7,_0x10322f)=>{var _0x168d95=_0xa7ca12;_0x39d843[_0x10322f][_0x168d95(0x178)]=_0x2e1ce7;}),_0x3ca9ea[_0xa7ca12(0x12f)]((_0x5c0d78,_0x5d25aa)=>{var _0x54d93b=_0xa7ca12;_0x39d843[_0x5d25aa][_0x54d93b(0x113)]=_0x5c0d78;}),_0x32f365[_0xa7ca12(0x12f)]((_0x2a16b4,_0x534cdc)=>{var _0xa836d9=_0xa7ca12;_0x39d843[_0x534cdc][_0xa836d9(0x99)]=_0x2a16b4;}),_0x10bd49[_0xa7ca12(0x12f)]((_0xf2bac8,_0x2a9945)=>{var _0x17bfc2=_0xa7ca12;_0x39d843[_0x2a9945][_0x17bfc2(0x159)]=_0xf2bac8;}),_0x59fa61[_0xa7ca12(0x12f)]((_0x7690dc,_0x207c70)=>{var _0x4081b6=_0xa7ca12;_0x39d843[_0x207c70][_0x4081b6(0xf6)]=_0x7690dc;}),_0x5e0497['forEach']((_0x85a779,_0x53b223)=>{var _0x50976e=_0xa7ca12;_0x39d843[_0x53b223][_0x50976e(0xbe)]=_0x85a779;}),_0x550539[_0xa7ca12(0x12f)]((_0xfa749d,_0x34c3b6)=>{var _0x401cb6=_0xa7ca12;_0x39d843[_0x34c3b6][_0x401cb6(0x16f)]=_0xfa749d;}),_0x351657[_0xa7ca12(0x12f)]((_0x15f73b,_0x3881b2)=>{var _0x26d9ee=_0xa7ca12;_0x39d843[_0x3881b2][_0x26d9ee(0x173)]=_0x15f73b;}),_0x55ed63[_0xa7ca12(0x12f)]((_0x2a6e2b,_0x1181f3)=>{var _0x1ccd5d=_0xa7ca12;_0x39d843[_0x1181f3][_0x1ccd5d(0xc9)]=_0x2a6e2b;}),_0xd1822b[_0xa7ca12(0x12f)]((_0x584ff7,_0x427b68)=>{var _0x5cce1e=_0xa7ca12;_0x39d843[_0x427b68][_0x5cce1e(0xc0)]=_0x584ff7;}),_0x415d92['forEach']((_0x1695c2,_0x2748fd)=>{var _0x5aaf86=_0xa7ca12;_0x39d843[_0x2748fd][_0x5aaf86(0xe4)]=_0x1695c2;}),_0x14bf8c[_0xa7ca12(0x12f)]((_0x26598a,_0x4c3ad4)=>{var _0x2bf25d=_0xa7ca12;_0x39d843[_0x4c3ad4][_0x2bf25d(0xe1)]=_0x26598a;}),_0x3096f8[_0xa7ca12(0x12f)]((_0xe36db6,_0x4209f5)=>{var _0x5601b3=_0xa7ca12;_0x39d843[_0x4209f5][_0x5601b3(0x18c)]=_0xe36db6;}),_0x23317b['forEach']((_0x587ee8,_0x41265e)=>{var _0x42f83a=_0xa7ca12;_0x39d843[_0x41265e][_0x42f83a(0x162)]=_0x587ee8;});const _0x1b3e96=_0x39d843['filter'](_0x8af092=>_0x8af092['to_quantity']!=='0'&&_0x8af092['to_quantity']!==''||_0x8af092[_0xa7ca12(0x18a)]!=='0'&&_0x8af092[_0xa7ca12(0x18a)]!=='');var _0x47a671=0x0;_0x1b3e96[_0xa7ca12(0x12f)](_0xd6c80a=>{var _0x3cd01d=_0xa7ca12;parseInt(_0xd6c80a[_0x3cd01d(0x129)])<parseInt(_0xd6c80a['to_quantity'])&&_0x47a671++;});if(_0x47a671!=0x0)return _0x902a24[_0xa7ca12(0x10d)]('errors',_0xa7ca12(0x163)),_0xe3dbf5['redirect'](_0xa7ca12(0x13f));const _0x19100b=await warehouse['findOne']({'name':_0x3e4cea[_0xa7ca12(0xd0)],'room':_0x3e4cea[_0xa7ca12(0xa9)]});_0x3e4cea[_0xa7ca12(0xb5)][_0xa7ca12(0x12f)](_0x2c4c16=>{var _0x1bed1e=_0xa7ca12;if(_0x2c4c16[_0x1bed1e(0xc7)]>0x0){const _0xc0a3d=_0x19100b[_0x1bed1e(0xff)][_0x1bed1e(0x17a)](_0x571e5e=>{var _0x4b8bfd=_0x1bed1e;_0x571e5e[_0x4b8bfd(0x193)]==_0x2c4c16['product_name']&&_0x571e5e[_0x4b8bfd(0x134)]==_0x2c4c16['from_floorlevel']&&_0x571e5e[_0x4b8bfd(0x156)]==_0x2c4c16[_0x4b8bfd(0xe4)]&&_0x571e5e[_0x4b8bfd(0xe0)]==_0x2c4c16[_0x4b8bfd(0x137)]&&_0x571e5e['bay']==_0x2c4c16[_0x4b8bfd(0xfe)]&&_0x571e5e[_0x4b8bfd(0xc0)]==_0x2c4c16['from_rack']&&_0x571e5e['storage']==_0x2c4c16['from_storage']&&(_0x571e5e['product_stock']=parseInt(_0x571e5e[_0x4b8bfd(0x165)])+parseInt(_0x2c4c16[_0x4b8bfd(0xc7)]));});}}),await _0x19100b[_0xa7ca12(0x9a)]();const _0x3eaa27=await warehouse[_0xa7ca12(0x152)]({'name':_0x3e4cea[_0xa7ca12(0x168)],'room':_0x3e4cea['to_room']});_0x3e4cea[_0xa7ca12(0xb5)]['forEach'](_0x441dc4=>{var _0x31460e=_0xa7ca12;if(_0x441dc4[_0x31460e(0xc7)]>0x0){const _0x5a800a=_0x3eaa27['product_details'][_0x31460e(0x17a)](_0x408d5e=>{var _0x42ffde=_0x31460e;_0x408d5e[_0x42ffde(0x193)]==_0x441dc4['product_name']&&_0x408d5e[_0x42ffde(0x134)]==_0x441dc4[_0x42ffde(0x18a)]&&_0x408d5e[_0x42ffde(0x156)]==_0x441dc4[_0x42ffde(0xe1)]&&_0x408d5e[_0x42ffde(0xe0)]==_0x441dc4[_0x42ffde(0xfa)]&&_0x408d5e[_0x42ffde(0xc5)]==_0x441dc4[_0x42ffde(0x18d)]&&_0x408d5e[_0x42ffde(0xc0)]==_0x441dc4[_0x42ffde(0xc0)]&&_0x408d5e[_0x42ffde(0xc9)]==_0x441dc4[_0x42ffde(0xc9)]&&(_0x408d5e['product_stock']=parseInt(_0x408d5e[_0x42ffde(0x165)])-parseInt(_0x441dc4[_0x42ffde(0xc7)]));});}}),await _0x3eaa27['save'](),_0x3e4cea[_0xa7ca12(0x11a)]=_0x16fe3e,_0x3e4cea[_0xa7ca12(0xd0)]=_0x2a02f5,_0x3e4cea['to_warehouse']=_0x58f64a,_0x3e4cea[_0xa7ca12(0xb5)]=_0x1b3e96,_0x3e4cea[_0xa7ca12(0xd5)]=_0x54858c,_0x3e4cea[_0xa7ca12(0xca)]=_0x1008c8;const _0x393950=await _0x3e4cea[_0xa7ca12(0x9a)]();console[_0xa7ca12(0x119)](_0x393950);const _0x3adffa=await warehouse['findOne']({'name':_0x2a02f5,'room':_0x298eb7});_0x393950[_0xa7ca12(0xb5)][_0xa7ca12(0x12f)](_0x1dbe3e=>{var _0x31637c=_0xa7ca12;if(_0x1dbe3e[_0x31637c(0xc7)]>0x0){const _0x53d454=_0x3adffa[_0x31637c(0xff)][_0x31637c(0x17a)](_0x3f55f6=>{var _0x59d694=_0x31637c;_0x3f55f6['product_name']==_0x1dbe3e['product_name']&&_0x3f55f6['floorlevel']==_0x1dbe3e['from_floorlevel']&&_0x3f55f6['type']==_0x1dbe3e[_0x59d694(0xe4)]&&_0x3f55f6[_0x59d694(0xe0)]==_0x1dbe3e['from_bin']&&_0x3f55f6[_0x59d694(0xc5)]==_0x1dbe3e[_0x59d694(0xfe)]&&_0x3f55f6[_0x59d694(0xc0)]==_0x1dbe3e['from_rack']&&_0x3f55f6['storage']==_0x1dbe3e[_0x59d694(0x18c)]&&(_0x3f55f6['product_stock']=parseInt(_0x3f55f6[_0x59d694(0x165)])-parseInt(_0x1dbe3e['to_quantity']));});}}),await _0x3adffa[_0xa7ca12(0x9a)]();const _0x4a7e28=await warehouse[_0xa7ca12(0x152)]({'name':_0x58f64a,'room':_0x16d3bd});_0x393950['product']['forEach'](_0x52ced2=>{var _0x54c389=_0xa7ca12;if(_0x52ced2['to_quantity']>0x0){var _0x53a8e0=0x0;const _0x35aa6a=_0x4a7e28[_0x54c389(0xff)][_0x54c389(0x17a)](_0x145b59=>{var _0x12f0af=_0x54c389;_0x145b59[_0x12f0af(0x193)]==_0x52ced2[_0x12f0af(0x193)]&&_0x145b59['floorlevel']==_0x52ced2[_0x12f0af(0x18a)]&&_0x145b59[_0x12f0af(0x156)]==_0x52ced2['to_types']&&_0x145b59[_0x12f0af(0xe0)]==_0x52ced2['to_bin']&&_0x145b59[_0x12f0af(0xc5)]==_0x52ced2[_0x12f0af(0x18d)]&&_0x145b59[_0x12f0af(0xc0)]==_0x52ced2[_0x12f0af(0xc0)]&&_0x145b59[_0x12f0af(0xc9)]==_0x52ced2[_0x12f0af(0xc9)]&&(_0x145b59[_0x12f0af(0x165)]=parseInt(_0x145b59['product_stock'])+parseInt(_0x52ced2['to_quantity']),_0x53a8e0++);});_0x53a8e0=='0'&&(_0x4a7e28[_0x54c389(0xff)]=_0x4a7e28[_0x54c389(0xff)][_0x54c389(0x111)]({'product_name':_0x52ced2[_0x54c389(0x193)],'product_stock':_0x52ced2[_0x54c389(0xc7)],'bay':_0x52ced2[_0x54c389(0x18d)],'bin':_0x52ced2[_0x54c389(0xfa)],'type':_0x52ced2['to_types'],'floorlevel':_0x52ced2[_0x54c389(0x18a)],'storage':_0x52ced2[_0x54c389(0xc9)],'rack':_0x52ced2[_0x54c389(0xc0)],'product_code':_0x52ced2[_0x54c389(0x99)],'primary_code':_0x52ced2[_0x54c389(0x178)],'secondary_code':_0x52ced2[_0x54c389(0x113)],'maxProducts':_0x52ced2[_0x54c389(0x159)],'storage':_0x52ced2['storage'],'rack':_0x52ced2['rack']}));}}),await _0x4a7e28[_0xa7ca12(0x9a)](),_0x902a24[_0xa7ca12(0x10d)](_0xa7ca12(0x124),_0xa7ca12(0xb1)),_0xe3dbf5['redirect'](_0xa7ca12(0x10f));}catch(_0x519b2e){console[_0xa7ca12(0x119)](_0x519b2e);}}),router[a0_0x182a8c(0x148)](a0_0x182a8c(0x195),async(_0x9e89d6,_0x2be012)=>{var _0x53da04=a0_0x182a8c;const {FromWareHouse:_0x3cd921,FromRoom:_0xba00ce,ToWarehouse:_0x5d06b9,ToRoom:_0x418644,primary_code:_0x57dc4f,Roomslist:_0x25f276}=_0x9e89d6[_0x53da04(0x108)],_0x14ff2a=_0x25f276[_0x53da04(0x96)](','),_0x4774a8=[];async function _0x5d2cf7(_0x299434){var _0x275273=_0x53da04;const _0x16ae40=await warehouse[_0x275273(0xf4)]([{'$match':{'name':_0x3cd921,'room':_0x299434}},{'$unwind':_0x275273(0x13b)},{'$match':{'product_details.primary_code':_0x57dc4f}},{'$group':{'_id':_0x275273(0xed),'name':{'$first':_0x275273(0x128)},'instock':{'$first':_0x275273(0x11d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x275273(0x131)},'level':{'$first':_0x275273(0xf0)},'isle':{'$first':_0x275273(0x164)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x275273(0xa2)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x275273(0x174)},'storage':{'$first':_0x275273(0xa5)},'rack':{'$first':_0x275273(0x190)},'expiry_date':{'$first':_0x275273(0xbd)},'production_date':{'$first':_0x275273(0x145)},'batch_code':{'$first':_0x275273(0x10e)},'maxPerUnit':{'$first':_0x275273(0x177)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x275273(0x147)},'maxProducts':{'$first':_0x275273(0xa7)},'invoice_product':{'$first':_0x275273(0x16b)}}}]),_0x41ca2f=await warehouse[_0x275273(0xf4)]([{'$match':{'name':_0x3cd921,'room':_0x299434}},{'$unwind':_0x275273(0x13b)},{'$match':{'product_details.secondary_code':_0x57dc4f}},{'$group':{'_id':_0x275273(0xed),'name':{'$first':_0x275273(0x128)},'instock':{'$first':_0x275273(0x11d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x275273(0x9e)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x275273(0xf0)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x275273(0xd6)},'pallet':{'$first':_0x275273(0xa2)},'unit':{'$first':_0x275273(0xe2)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x275273(0xa5)},'rack':{'$first':_0x275273(0x190)},'expiry_date':{'$first':_0x275273(0xbd)},'production_date':{'$first':_0x275273(0x145)},'batch_code':{'$first':_0x275273(0x10e)},'maxPerUnit':{'$first':_0x275273(0x177)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x275273(0x147)},'maxProducts':{'$first':_0x275273(0xa7)},'invoice_product':{'$first':_0x275273(0x16b)}}}]);if(_0x16ae40[_0x275273(0x14c)]>0x0)_0x4774a8[_0x275273(0xeb)](_0x16ae40);else _0x41ca2f[_0x275273(0x14c)]>0x0&&_0x4774a8[_0x275273(0xeb)](_0x41ca2f);}const _0x1e7023=_0x14ff2a['map'](_0x2983aa=>_0x5d2cf7(_0x2983aa));await Promise['all'](_0x1e7023),_0x2be012['json'](_0x4774a8);}),router['post']('/barcode_scanner2',async(_0x331074,_0x2a9c96)=>{var _0x31db2b=a0_0x182a8c;try{const {FromWareHouse:_0x244a8e,FromRoom:_0x323fb5,ToWarehouse:_0x350c92,ToRoom:_0x260726,secondary_code:_0x27f4ef}=_0x331074[_0x31db2b(0x108)],_0x473535=await warehouse[_0x31db2b(0xf4)]([{'$match':{'name':_0x244a8e}},{'$unwind':_0x31db2b(0x13b)},{'$match':{'product_details.secondary_code':_0x27f4ef}},{'$group':{'_id':_0x31db2b(0xed),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x31db2b(0xb3)},'secondary_code':{'$first':_0x31db2b(0x9e)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x31db2b(0x11d)},'warehouse':{'$first':'$name'},'level':{'$first':_0x31db2b(0xb7)},'isle':{'$first':_0x31db2b(0x13d)},'pallet':{'$first':_0x31db2b(0x185)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x31db2b(0xe2)}}}]);_0x2a9c96[_0x31db2b(0x92)](0xc8)['json'](_0x473535);}catch(_0x10d2b9){_0x2a9c96[_0x31db2b(0x92)](0x194)[_0x31db2b(0x14f)]({'message':_0x10d2b9[_0x31db2b(0x121)]});}}),router[a0_0x182a8c(0x148)](a0_0x182a8c(0xd3),async(_0x4e4280,_0xb2afef)=>{var _0x495abc=a0_0x182a8c;try{const {FromWareHouse:_0x155be5,FromRoom:_0xac64d2,ToWarehouse:_0x82ecd4,ToRoom:_0x3c932e,product_code:_0x3654be}=_0x4e4280[_0x495abc(0x108)],_0x3b85c5=await warehouse[_0x495abc(0xf4)]([{'$match':{'name':_0x155be5}},{'$unwind':_0x495abc(0x13b)},{'$match':{'product_details.product_code':_0x3654be}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x495abc(0x128)},'primary_code':{'$first':_0x495abc(0xb3)},'secondary_code':{'$first':_0x495abc(0x9e)},'product_code':{'$first':_0x495abc(0x131)},'instock':{'$first':_0x495abc(0x11d)},'warehouse':{'$first':_0x495abc(0x105)},'level':{'$first':_0x495abc(0xb7)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x495abc(0x185)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0xb2afef[_0x495abc(0x92)](0xc8)['json'](_0x3b85c5);}catch(_0x123873){_0xb2afef[_0x495abc(0x92)](0x194)[_0x495abc(0x14f)]({'message':_0x123873[_0x495abc(0x121)]});}}),router['post'](a0_0x182a8c(0x130),async(_0x1d58b6,_0x18547e)=>{var _0x1ff64f=a0_0x182a8c;const {level:_0x2c2b8f,isle:_0x124101,pallet:_0x444d91,warehouses:_0x59669b,room:_0x2c6eeb}=_0x1d58b6[_0x1ff64f(0x108)];try{const _0xf8057d=await warehouse[_0x1ff64f(0xf4)]([{'$match':{'name':_0x59669b,'room':_0x2c6eeb}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x2c2b8f),'product_details.isle':_0x124101,'product_details.pallet':parseInt(_0x444d91)}},{'$group':{'_id':_0x1ff64f(0xed),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1ff64f(0x11d)},'level':{'$first':_0x1ff64f(0xb7)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x1ff64f(0x185)},'maxProducts':{'$first':_0x1ff64f(0xa7)}}}]);_0x18547e[_0x1ff64f(0x92)](0xc8)['json'](_0xf8057d);}catch(_0x5b7f1b){_0x18547e[_0x1ff64f(0x92)](0x194)[_0x1ff64f(0x14f)]({'message':_0x5b7f1b[_0x1ff64f(0x121)]});}}),module[a0_0x182a8c(0x15f)]=router;