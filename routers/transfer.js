var a0_0x46fbe4=a0_0xfeaa;function a0_0xfeaa(_0xfe133b,_0x143752){var _0x910b95=a0_0x910b();return a0_0xfeaa=function(_0xfeaa03,_0xe45368){_0xfeaa03=_0xfeaa03-0x18d;var _0x4150d8=_0x910b95[_0xfeaa03];return _0x4150d8;},a0_0xfeaa(_0xfe133b,_0x143752);}(function(_0x445d7f,_0x1bc3c3){var _0x3254d3=a0_0xfeaa,_0x407ffc=_0x445d7f();while(!![]){try{var _0x4a22a7=-parseInt(_0x3254d3(0x18e))/0x1+-parseInt(_0x3254d3(0x21b))/0x2*(-parseInt(_0x3254d3(0x1b4))/0x3)+parseInt(_0x3254d3(0x26b))/0x4*(parseInt(_0x3254d3(0x19b))/0x5)+parseInt(_0x3254d3(0x1b8))/0x6+-parseInt(_0x3254d3(0x1e6))/0x7*(parseInt(_0x3254d3(0x1f1))/0x8)+-parseInt(_0x3254d3(0x1d4))/0x9*(parseInt(_0x3254d3(0x1be))/0xa)+parseInt(_0x3254d3(0x1cd))/0xb*(parseInt(_0x3254d3(0x1aa))/0xc);if(_0x4a22a7===_0x1bc3c3)break;else _0x407ffc['push'](_0x407ffc['shift']());}catch(_0x5e33bc){_0x407ffc['push'](_0x407ffc['shift']());}}}(a0_0x910b,0x88f69));const express=require('express'),app=express(),router=express[a0_0x46fbe4(0x220)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x46fbe4(0x23b)),users=require(a0_0x46fbe4(0x1e4)),nodemailer=require('nodemailer');router['get'](a0_0x46fbe4(0x24d),auth,async(_0x36c884,_0x2a7bed)=>{var _0x332343=a0_0x46fbe4;try{const {username:_0xd4e089,email:_0x3d3292,role:_0x1ec576}=_0x36c884[_0x332343(0x240)],_0x10da69=_0x36c884['user'],_0xedae32=await profile['findOne']({'email':_0x10da69[_0x332343(0x204)]}),_0x5de21f=await master_shop[_0x332343(0x1a0)]();console['log']('master',_0x5de21f);let _0x50e4c1;if(_0x10da69[_0x332343(0x1af)]==_0x332343(0x246)){const _0x3e34c1=await staff[_0x332343(0x208)]({'email':_0x10da69[_0x332343(0x204)]});_0x50e4c1=await transfers['find']({'from_warehouse':_0x3e34c1[_0x332343(0x193)]});}else _0x50e4c1=await transfers[_0x332343(0x1c5)]([{'$unwind':_0x332343(0x1df)},{'$group':{'_id':_0x332343(0x229),'invoice':{'$first':'$invoice'},'date':{'$first':_0x332343(0x1fb)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x332343(0x228)},'from_room_name':{'$addToSet':_0x332343(0x224)},'to_room_name':{'$addToSet':_0x332343(0x259)},'finalize':{'$first':_0x332343(0x273)},'isAllowEdit':{'$first':_0x332343(0x22d)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x5de21f[0x0][_0x332343(0x26a)]==_0x332343(0x202)){var _0x6510ee=users['English'];console[_0x332343(0x256)](_0x6510ee);}else{if(_0x5de21f[0x0][_0x332343(0x26a)]==_0x332343(0x261))var _0x6510ee=users[_0x332343(0x261)];else{if(_0x5de21f[0x0][_0x332343(0x26a)]=='German')var _0x6510ee=users[_0x332343(0x1ad)];else{if(_0x5de21f[0x0]['language']==_0x332343(0x227))var _0x6510ee=users[_0x332343(0x227)];else{if(_0x5de21f[0x0][_0x332343(0x26a)]==_0x332343(0x216))var _0x6510ee=users['French'];else{if(_0x5de21f[0x0][_0x332343(0x26a)]==_0x332343(0x206))var _0x6510ee=users['Portuguese'];else{if(_0x5de21f[0x0]['language']=='Chinese')var _0x6510ee=users[_0x332343(0x21d)];else{if(_0x5de21f[0x0][_0x332343(0x26a)]==_0x332343(0x23d))var _0x6510ee=users[_0x332343(0x210)];}}}}}}}_0x2a7bed[_0x332343(0x1f6)]('transfer',{'success':_0x36c884[_0x332343(0x1d2)](_0x332343(0x195)),'errors':_0x36c884[_0x332343(0x1d2)]('errors'),'role':_0x10da69,'profile':_0xedae32,'master_shop':_0x5de21f,'transfer':_0x50e4c1,'language':_0x6510ee});}catch(_0x24766e){console[_0x332343(0x256)](_0x24766e);}});async function getRandom8DigitNumber(){var _0xdc9998=a0_0x46fbe4;const _0x59ade7=0x989680,_0x3dcb42=0x5f5e0ff,_0x54edf0=Math[_0xdc9998(0x1a8)](Math[_0xdc9998(0x19f)]()*(_0x3dcb42-_0x59ade7+0x1))+_0x59ade7;var _0x3a4db1;const _0x27db19=await transfers['findOne']({'invoice':'TRF-'+_0x54edf0});return _0x27db19&&_0x27db19[_0xdc9998(0x1ba)]>0x0?_0x3a4db1=_0xdc9998(0x249)+_0x54edf0:_0x3a4db1=_0xdc9998(0x249)+_0x54edf0,_0x3a4db1;}router[a0_0x46fbe4(0x23e)]('/view/add_transfer',auth,async(_0x305da8,_0x5d2a4a)=>{var _0x1ac738=a0_0x46fbe4;try{const {username:_0x318849,email:_0x33d6b3,role:_0x91ebe4}=_0x305da8[_0x1ac738(0x240)],_0x3282b0=_0x305da8['user'],_0x1d352c=await profile['findOne']({'email':_0x3282b0[_0x1ac738(0x204)]}),_0xaa4e55=await master_shop[_0x1ac738(0x1a0)]();console[_0x1ac738(0x256)](_0x1ac738(0x251),_0xaa4e55);let _0x53cc45;if(_0x3282b0['role']==_0x1ac738(0x246)){const _0x566549=await staff[_0x1ac738(0x208)]({'email':_0x3282b0[_0x1ac738(0x204)]});_0x53cc45=await warehouse['aggregate']([{'$match':{'status':_0x1ac738(0x277),'name':_0x566549[_0x1ac738(0x193)],'warehouse_category':_0x1ac738(0x27a)}},{'$group':{'_id':_0x1ac738(0x1a2),'name':{'$first':_0x1ac738(0x1a2)}}}]);}else _0x53cc45=await warehouse['aggregate']([{'$match':{'status':_0x1ac738(0x277),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1ac738(0x1a2),'name':{'$first':_0x1ac738(0x1a2)}}}]);var _0x34ce34=[_0x1ac738(0x1d9),'Enclosed',_0x1ac738(0x257)];const _0x24f0d1=await transfers[_0x1ac738(0x1a0)]({}),_0x418142=_0x24f0d1['length']+0x1,_0x42a978=_0x1ac738(0x249)+_0x418142[_0x1ac738(0x244)]()['padStart'](0x5,'0');if(_0xaa4e55[0x0][_0x1ac738(0x26a)]==_0x1ac738(0x202)){var _0x337141=users[_0x1ac738(0x191)];console[_0x1ac738(0x256)](_0x337141);}else{if(_0xaa4e55[0x0][_0x1ac738(0x26a)]=='Hindi')var _0x337141=users[_0x1ac738(0x261)];else{if(_0xaa4e55[0x0]['language']=='German')var _0x337141=users[_0x1ac738(0x1ad)];else{if(_0xaa4e55[0x0][_0x1ac738(0x26a)]==_0x1ac738(0x227))var _0x337141=users[_0x1ac738(0x227)];else{if(_0xaa4e55[0x0][_0x1ac738(0x26a)]==_0x1ac738(0x216))var _0x337141=users[_0x1ac738(0x216)];else{if(_0xaa4e55[0x0][_0x1ac738(0x26a)]==_0x1ac738(0x206))var _0x337141=users[_0x1ac738(0x236)];else{if(_0xaa4e55[0x0]['language']==_0x1ac738(0x21d))var _0x337141=users['Chinese'];else{if(_0xaa4e55[0x0][_0x1ac738(0x26a)]==_0x1ac738(0x23d))var _0x337141=users[_0x1ac738(0x210)];}}}}}}}const _0x3cd982=getRandom8DigitNumber();_0x3cd982[_0x1ac738(0x1b7)](_0x4676cb=>{var _0x2fc430=_0x1ac738;_0x5d2a4a[_0x2fc430(0x1f6)](_0x2fc430(0x1fd),{'success':_0x305da8[_0x2fc430(0x1d2)](_0x2fc430(0x195)),'errors':_0x305da8[_0x2fc430(0x1d2)](_0x2fc430(0x194)),'role':_0x3282b0,'profile':_0x1d352c,'master_shop':_0xaa4e55,'warehouse':_0x53cc45,'language':_0x337141,'rooms_data':_0x34ce34,'invoice':_0x4676cb});})[_0x1ac738(0x1bb)](_0x30773f=>{var _0x3cbe47=_0x1ac738;_0x305da8['flash']('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x5d2a4a[_0x3cbe47(0x22f)](_0x3cbe47(0x1f5));});}catch(_0x486a23){console['log'](_0x486a23);}}),router['post'](a0_0x46fbe4(0x230),auth,async(_0x179167,_0x5eeb32)=>{var _0x26717d=a0_0x46fbe4;try{console[_0x26717d(0x256)](_0x179167[_0x26717d(0x1e5)]);const {date:_0x2fcb5c,from_warehouse:_0x3e9dab,FromRoom_name:_0xc4576e,to_warehouse:_0x1b56b5,ToRoom_name:_0x388e35,prod_name:_0x5d84b0,from_prod_qty:_0x49f197,from_prod_level:_0x149771,from_prod_isle:_0x5dbc15,from_prod_pallet:_0x5c77ca,to_prod_qty:_0x113ba9,to_prod_level:_0x5267ce,to_prod_isle:_0x11b006,to_prod_pallet:_0x1566b0,primary_code:_0x5630b6,secondary_code:_0x5a55f5,product_code3:_0x164f30,note:_0x2f0f11,MaxStocks_data2:_0x355b79,invoice:_0x211df2,expiry_date:_0x66d789}=_0x179167[_0x26717d(0x1e5)];if(typeof _0x5d84b0==_0x26717d(0x20c))var _0x34a426=[_0x179167[_0x26717d(0x1e5)]['prod_name']],_0x3d6212=[_0x179167[_0x26717d(0x1e5)]['from_prod_qty']],_0x13b00b=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x260)]],_0x5f072a=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x1a6)]],_0x7c83c0=[_0x179167['body'][_0x26717d(0x192)]],_0x20ffdd=[_0x179167['body'][_0x26717d(0x1dc)]],_0x3856d1=[_0x179167['body']['secondary_code']],_0x1341d5=[_0x179167[_0x26717d(0x1e5)]['product_code3']],_0x1a6ed6=[_0x179167['body'][_0x26717d(0x21e)]],_0x2f2a49=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x1c0)]],_0x5da6f0=[_0x179167[_0x26717d(0x1e5)]['secondary_unit']],_0x264dab=[_0x179167['body'][_0x26717d(0x207)]],_0x167d7e=[_0x179167['body'][_0x26717d(0x1a5)]],_0x1869b9=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x214)]],_0x4cacc6=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x1c8)]],_0x18e723=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x1e8)]],_0x289ceb=[_0x179167['body'][_0x26717d(0x268)]],_0x1a740a=[_0x179167['body'][_0x26717d(0x26f)]],_0x12b3d3=[_0x179167[_0x26717d(0x1e5)]['from_invoice']],_0x5c6e5f=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x196)]],_0x280b85=[_0x179167[_0x26717d(0x1e5)][_0x26717d(0x267)]];else var _0x34a426=[..._0x179167[_0x26717d(0x1e5)]['prod_name']],_0x3d6212=[..._0x179167['body'][_0x26717d(0x231)]],_0x13b00b=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x260)]],_0x5f072a=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x1a6)]],_0x7c83c0=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x192)]],_0x20ffdd=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x1dc)]],_0x3856d1=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x226)]],_0x1341d5=[..._0x179167[_0x26717d(0x1e5)]['product_code3']],_0x1a6ed6=[..._0x179167['body'][_0x26717d(0x21e)]],_0x2f2a49=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x1c0)]],_0x5da6f0=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x212)]],_0x264dab=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x207)]],_0x167d7e=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x1a5)]],_0x1869b9=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x214)]],_0x4cacc6=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x1c8)]],_0x18e723=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x1e8)]],_0x289ceb=[..._0x179167['body'][_0x26717d(0x268)]],_0x1a740a=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x26f)]],_0x12b3d3=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x239)]],_0x5c6e5f=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x196)]],_0x280b85=[..._0x179167[_0x26717d(0x1e5)][_0x26717d(0x267)]];const _0x255412=_0x34a426[_0x26717d(0x266)](_0x4f6b10=>{return _0x4f6b10={'product_name':_0x4f6b10};});_0x3d6212[_0x26717d(0x25a)]((_0x289ab8,_0x450dc0)=>{var _0x50e791=_0x26717d;_0x255412[_0x450dc0][_0x50e791(0x23c)]=_0x289ab8;}),_0x12b3d3[_0x26717d(0x25a)]((_0x5de586,_0x2221aa)=>{var _0x10687e=_0x26717d;_0x255412[_0x2221aa][_0x10687e(0x239)]=_0x5de586;}),_0x5c6e5f[_0x26717d(0x25a)]((_0x1fc0bf,_0x1ab4d8)=>{var _0x32593d=_0x26717d;_0x255412[_0x1ab4d8][_0x32593d(0x1c2)]=_0x1fc0bf;}),_0x280b85[_0x26717d(0x25a)]((_0xc28c50,_0x5e54d8)=>{var _0x2824c7=_0x26717d;_0x255412[_0x5e54d8][_0x2824c7(0x1ac)]=_0xc28c50;}),_0x13b00b[_0x26717d(0x25a)]((_0x34f57b,_0x212feb)=>{var _0x36c481=_0x26717d;_0x289ceb[_0x36c481(0x25a)]((_0x143c69,_0x218779)=>{var _0x396f2a=_0x36c481;if(_0x143c69==_0x396f2a(0x1c1)&&_0x212feb==_0x218779){var _0x400cc5=_0x34f57b[_0x396f2a(0x20a)](0x3);_0x255412[_0x212feb][_0x396f2a(0x1c6)]=_0x34f57b[0x0],_0x255412[_0x212feb]['from_rack']=_0x34f57b[0x1],_0x255412[_0x212feb][_0x396f2a(0x1d5)]=0x0,_0x255412[_0x212feb][_0x396f2a(0x1dd)]=0x0,_0x255412[_0x212feb]['from_types']='Floor',_0x255412[_0x212feb][_0x396f2a(0x200)]=_0x400cc5;}else{if(_0x143c69==_0x396f2a(0x217)&&_0x212feb==_0x218779){var _0x400cc5=_0x34f57b[_0x396f2a(0x20a)](0x3);_0x255412[_0x212feb][_0x396f2a(0x1c6)]=_0x34f57b[0x0],_0x255412[_0x212feb][_0x396f2a(0x1c4)]=_0x34f57b[0x1],_0x255412[_0x212feb][_0x396f2a(0x1d5)]=0x0,_0x255412[_0x212feb]['from_bin']=0x0,_0x255412[_0x212feb][_0x396f2a(0x1a1)]=_0x396f2a(0x24c),_0x255412[_0x212feb][_0x396f2a(0x200)]=_0x34f57b[0x5];}else{if(_0x212feb==_0x218779){if(_0x34f57b[0x0]=='A'&&_0x34f57b[0x1]=='L'&&_0x34f57b[0x2]=='L')console[_0x396f2a(0x256)](_0x143c69+_0x396f2a(0x24a)+_0x212feb+_0x396f2a(0x24a)+_0x218779+_0x396f2a(0x24a)+_0x34f57b+_0x396f2a(0x250)),_0x255412[_0x212feb][_0x396f2a(0x1c6)]=_0x34f57b[0x0],_0x255412[_0x212feb][_0x396f2a(0x1c4)]=_0x34f57b[0x1],_0x255412[_0x212feb][_0x396f2a(0x1d5)]=0x0,_0x255412[_0x212feb][_0x396f2a(0x1dd)]=0x0,_0x255412[_0x212feb][_0x396f2a(0x1a1)]='Floor',_0x255412[_0x212feb]['from_floorlevel']=_0x34f57b[0x3];else{var _0x5e4356;if(_0x34f57b[0x4]=='L')_0x5e4356=_0x396f2a(0x1db);else _0x34f57b[0x4]=='F'&&(_0x5e4356=_0x396f2a(0x24c));_0x255412[_0x212feb][_0x396f2a(0x1c6)]=_0x34f57b[0x0],_0x255412[_0x212feb][_0x396f2a(0x1c4)]=_0x34f57b[0x1],_0x255412[_0x212feb]['from_bay']=_0x34f57b[0x2],_0x255412[_0x212feb][_0x396f2a(0x1dd)]=_0x34f57b[0x3],_0x255412[_0x212feb]['from_types']=_0x5e4356,_0x255412[_0x212feb]['from_floorlevel']=_0x34f57b[0x5];}}}}});}),_0x5f072a[_0x26717d(0x25a)]((_0xcaa409,_0x486711)=>{var _0x4e0f1c=_0x26717d;_0x255412[_0x486711][_0x4e0f1c(0x25b)]=_0xcaa409;}),_0x7c83c0[_0x26717d(0x25a)]((_0x3e27ac,_0xdf9eef)=>{var _0x271d4d=_0x26717d;_0x1a740a[_0x271d4d(0x25a)]((_0x157eed,_0x2a0429)=>{var _0x5c31f4=_0x271d4d;if(_0x157eed==_0x5c31f4(0x1c1)&&_0xdf9eef==_0x2a0429){var _0x5ebeb1=_0x3e27ac[_0x5c31f4(0x20a)](0x3);_0x255412[_0xdf9eef][_0x5c31f4(0x219)]=_0x3e27ac[0x0],_0x255412[_0xdf9eef][_0x5c31f4(0x270)]=_0x3e27ac[0x1],_0x255412[_0xdf9eef]['to_bay']=0x0,_0x255412[_0xdf9eef][_0x5c31f4(0x190)]=0x0,_0x255412[_0xdf9eef][_0x5c31f4(0x22a)]=_0x5c31f4(0x24c),_0x255412[_0xdf9eef][_0x5c31f4(0x218)]=_0x5ebeb1;}else{if(_0x157eed==_0x5c31f4(0x217)&&_0xdf9eef==_0x2a0429){var _0x5ebeb1=_0x3e27ac['slice'](0x3);_0x255412[_0xdf9eef][_0x5c31f4(0x219)]=_0x3e27ac[0x0],_0x255412[_0xdf9eef][_0x5c31f4(0x270)]=_0x3e27ac[0x1],_0x255412[_0xdf9eef][_0x5c31f4(0x26d)]=0x0,_0x255412[_0xdf9eef][_0x5c31f4(0x190)]=0x0,_0x255412[_0xdf9eef][_0x5c31f4(0x22a)]=_0x5c31f4(0x24c),_0x255412[_0xdf9eef][_0x5c31f4(0x218)]=_0x3e27ac[0x5];}else{if(_0xdf9eef==_0x2a0429){if(_0x3e27ac[0x0]=='A'&&_0x3e27ac[0x1]=='L'&&_0x3e27ac[0x2]=='L')console[_0x5c31f4(0x256)](_0x157eed+_0x5c31f4(0x24a)+_0xdf9eef+'\x20<>\x20'+_0x2a0429+'\x20<>\x20'+_0x3e27ac+_0x5c31f4(0x250)),_0x255412[_0xdf9eef]['storage']=_0x3e27ac[0x0],_0x255412[_0xdf9eef]['rack']=_0x3e27ac[0x1],_0x255412[_0xdf9eef]['to_bay']=0x0,_0x255412[_0xdf9eef][_0x5c31f4(0x190)]=0x0,_0x255412[_0xdf9eef][_0x5c31f4(0x22a)]=_0x5c31f4(0x24c),_0x255412[_0xdf9eef][_0x5c31f4(0x218)]=_0x3e27ac[0x3];else{var _0x57e407;if(_0x3e27ac[0x4]=='L')_0x57e407=_0x5c31f4(0x1db);else _0x3e27ac[0x4]=='F'&&(_0x57e407='Floor');_0x255412[_0xdf9eef]['storage']=_0x3e27ac[0x0],_0x255412[_0xdf9eef]['rack']=_0x3e27ac[0x1],_0x255412[_0xdf9eef][_0x5c31f4(0x26d)]=_0x3e27ac[0x2],_0x255412[_0xdf9eef][_0x5c31f4(0x190)]=_0x3e27ac[0x3],_0x255412[_0xdf9eef][_0x5c31f4(0x22a)]=_0x57e407,_0x255412[_0xdf9eef][_0x5c31f4(0x218)]=_0x3e27ac[0x5];}}}}});}),_0x20ffdd[_0x26717d(0x25a)]((_0x5a4dc5,_0x22ddbb)=>{var _0x19b24f=_0x26717d;_0x255412[_0x22ddbb][_0x19b24f(0x1dc)]=_0x5a4dc5;}),_0x3856d1['forEach']((_0x870008,_0x14d84d)=>{var _0x1dd491=_0x26717d;_0x255412[_0x14d84d][_0x1dd491(0x226)]=_0x870008;}),_0x1341d5[_0x26717d(0x25a)]((_0x448db2,_0x230cbd)=>{var _0x4e4e63=_0x26717d;_0x255412[_0x230cbd][_0x4e4e63(0x242)]=_0x448db2;}),_0x1a6ed6[_0x26717d(0x25a)]((_0xfa8496,_0x5a0113)=>{var _0x527bc9=_0x26717d;_0x255412[_0x5a0113][_0x527bc9(0x1e0)]=_0xfa8496;}),_0x2f2a49['forEach']((_0x23cd11,_0x1334c5)=>{var _0x4e0eb3=_0x26717d;_0x255412[_0x1334c5][_0x4e0eb3(0x1ce)]=_0x23cd11;}),_0x5da6f0[_0x26717d(0x25a)]((_0x372aab,_0x176b56)=>{var _0x1a3252=_0x26717d;_0x255412[_0x176b56][_0x1a3252(0x212)]=_0x372aab;}),_0x264dab[_0x26717d(0x25a)]((_0x25486e,_0x562d67)=>{_0x255412[_0x562d67]['batch_code']=_0x25486e;}),_0x167d7e[_0x26717d(0x25a)]((_0x317296,_0x439545)=>{var _0x521ec2=_0x26717d;_0x255412[_0x439545][_0x521ec2(0x1a5)]=_0x317296;}),_0x1869b9[_0x26717d(0x25a)]((_0xcba702,_0x5dfa7e)=>{var _0x4682d9=_0x26717d;_0x255412[_0x5dfa7e][_0x4682d9(0x20e)]=_0xcba702;}),_0x4cacc6['forEach']((_0x42bd8c,_0x1194a4)=>{var _0xcccf1f=_0x26717d;_0x255412[_0x1194a4][_0xcccf1f(0x1c8)]=_0x42bd8c;}),_0x18e723['forEach']((_0x4133c8,_0x21501a)=>{_0x255412[_0x21501a]['prod_cat']=_0x4133c8;}),_0x289ceb['forEach']((_0x29076d,_0xb67f36)=>{var _0x1462da=_0x26717d;_0x255412[_0xb67f36][_0x1462da(0x1f7)]=_0x29076d;}),_0x1a740a[_0x26717d(0x25a)]((_0x2a5c6d,_0x5efa26)=>{var _0x205311=_0x26717d;_0x255412[_0x5efa26][_0x205311(0x203)]=_0x2a5c6d;});const _0x4f5f22=_0x255412[_0x26717d(0x279)](_0xa954ea=>_0xa954ea[_0x26717d(0x25b)]!=='0'&&_0xa954ea[_0x26717d(0x25b)]!==''||_0xa954ea['to_floorlevel']!=='0'&&_0xa954ea[_0x26717d(0x218)]!==''),_0xe23cf5=new transfers({'date':_0x2fcb5c,'from_warehouse':_0x3e9dab,'to_warehouse':_0x1b56b5,'product':_0x4f5f22,'note':_0x2f0f11,'invoice':_0x211df2}),_0xbd0a73=await _0xe23cf5[_0x26717d(0x278)]();_0x179167[_0x26717d(0x1d2)](_0x26717d(0x195),'Product\x20Transfer\x20successfully'),_0x5eeb32[_0x26717d(0x22f)](_0x26717d(0x1fe)+_0xbd0a73[_0x26717d(0x263)]);}catch(_0x30b298){console[_0x26717d(0x256)](_0x30b298),_0x5eeb32['status'](0xc8)[_0x26717d(0x1d8)]({'errorMessage':_0x30b298['message']});}}),router[a0_0x46fbe4(0x23e)](a0_0x46fbe4(0x1b6),auth,async(_0x2969cf,_0x21caee)=>{var _0x19b789=a0_0x46fbe4;try{const {username:_0x242f9a,email:_0x1fe92c,role:_0x27a689}=_0x2969cf[_0x19b789(0x240)],_0x458b87=_0x2969cf[_0x19b789(0x240)],_0xea730f=await profile[_0x19b789(0x208)]({'email':_0x458b87[_0x19b789(0x204)]}),_0x534c8e=await master_shop[_0x19b789(0x1a0)]();console[_0x19b789(0x256)](_0x19b789(0x251),_0x534c8e);const _0x33708c=await transfers[_0x19b789(0x21c)](_0x2969cf['params']['id']);let _0x234515=new Date(_0x33708c[_0x19b789(0x1a5)]),_0x3b0c8c=('0'+_0x234515[_0x19b789(0x1f2)]())[_0x19b789(0x20a)](-0x2),_0x305cda=('0'+(_0x234515['getMonth']()+0x1))[_0x19b789(0x20a)](-0x2),_0x50017d=_0x234515[_0x19b789(0x1c3)](),_0x9ef94=_0x50017d+'-'+_0x305cda+'-'+_0x3b0c8c,_0x4bd843;if(_0x458b87[_0x19b789(0x1af)]==_0x19b789(0x246)){const _0x583420=await staff[_0x19b789(0x208)]({'email':_0x458b87['email']});_0x4bd843=await warehouse[_0x19b789(0x1a0)]({'status':_0x19b789(0x277),'name':_0x583420[_0x19b789(0x193)],'warehouse_category':_0x19b789(0x27a)});}else _0x4bd843=await warehouse[_0x19b789(0x1a0)]({'status':_0x19b789(0x277),'warehouse_category':_0x19b789(0x27a)});const _0x3548a2=await warehouse[_0x19b789(0x1c5)]([{'$match':{'name':_0x33708c['from_warehouse']}},{'$unwind':_0x19b789(0x20f)},{'$group':{'_id':_0x19b789(0x245),'name':{'$first':_0x19b789(0x241)},'product_stock':{'$first':_0x19b789(0x1d6)},'bay':{'$first':_0x19b789(0x1ef)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x19b789(0x19e)},'floorlevel':{'$first':_0x19b789(0x272)},'primary_code':{'$first':_0x19b789(0x19c)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x19b789(0x25e)},'storage':{'$first':_0x19b789(0x223)},'rack':{'$first':_0x19b789(0x20d)},'expiry_date':{'$first':_0x19b789(0x1eb)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x19b789(0x1a4)}}}]);if(_0x534c8e[0x0][_0x19b789(0x26a)]==_0x19b789(0x202)){var _0x434ade=users['English'];console[_0x19b789(0x256)](_0x434ade);}else{if(_0x534c8e[0x0][_0x19b789(0x26a)]=='Hindi')var _0x434ade=users['Hindi'];else{if(_0x534c8e[0x0][_0x19b789(0x26a)]=='German')var _0x434ade=users[_0x19b789(0x1ad)];else{if(_0x534c8e[0x0][_0x19b789(0x26a)]==_0x19b789(0x227))var _0x434ade=users[_0x19b789(0x227)];else{if(_0x534c8e[0x0][_0x19b789(0x26a)]==_0x19b789(0x216))var _0x434ade=users[_0x19b789(0x216)];else{if(_0x534c8e[0x0][_0x19b789(0x26a)]=='Portuguese\x20(BR)')var _0x434ade=users[_0x19b789(0x236)];else{if(_0x534c8e[0x0][_0x19b789(0x26a)]=='Chinese')var _0x434ade=users[_0x19b789(0x21d)];else{if(_0x534c8e[0x0][_0x19b789(0x26a)]==_0x19b789(0x23d))var _0x434ade=users['Arabic'];}}}}}}}_0x21caee['render'](_0x19b789(0x222),{'success':_0x2969cf[_0x19b789(0x1d2)](_0x19b789(0x195)),'errors':_0x2969cf[_0x19b789(0x1d2)](_0x19b789(0x194)),'role':_0x458b87,'profile':_0xea730f,'master_shop':_0x534c8e,'warehouse':_0x4bd843,'transfer':_0x33708c,'stock':_0x3548a2,'language':_0x434ade});}catch(_0x5e8a57){console[_0x19b789(0x256)](_0x5e8a57);}}),router[a0_0x46fbe4(0x209)](a0_0x46fbe4(0x1b6),auth,async(_0x507db7,_0x43e5fc)=>{var _0x2ea998=a0_0x46fbe4;try{const _0x5a4a56=_0x507db7[_0x2ea998(0x248)]['id'],{from_warehouse:_0x386e8e,FromRoom_name:_0x3bbadf,to_warehouse:_0x4f1fe1,ToRoom_name:_0x3e1f65}=_0x507db7[_0x2ea998(0x1e5)],_0x169a66=await transfers['findById']({'_id':_0x5a4a56}),_0x143d12=_0x169a66[_0x2ea998(0x262)][_0x2ea998(0x266)](async _0x5bcca5=>{var _0x476aad=_0x2ea998;if(_0x5bcca5[_0x476aad(0x25b)]>0x0){var _0x4bd8b6=await warehouse['findOne']({'name':_0x169a66[_0x476aad(0x243)],'room':_0x5bcca5[_0x476aad(0x1f7)],'warehouse_category':_0x476aad(0x27a)});const _0x1d3388=_0x4bd8b6[_0x476aad(0x1f0)]['map'](_0xde4202=>{var _0x122f43=_0x476aad;_0xde4202[_0x122f43(0x235)]==_0x5bcca5['product_name']&&_0xde4202[_0x122f43(0x1b9)]==_0x5bcca5[_0x122f43(0x200)]&&_0xde4202[_0x122f43(0x26c)]==_0x5bcca5['from_types']&&_0xde4202['bin']==_0x5bcca5[_0x122f43(0x1dd)]&&_0xde4202[_0x122f43(0x24b)]==_0x5bcca5['from_bay']&&_0xde4202[_0x122f43(0x270)]==_0x5bcca5['from_rack']&&_0xde4202[_0x122f43(0x219)]==_0x5bcca5[_0x122f43(0x1c6)]&&_0xde4202['expiry_date']==_0x5bcca5['expiry_date']&&_0xde4202[_0x122f43(0x207)]==_0x5bcca5['batch_code']&&_0xde4202[_0x122f43(0x1c8)]==_0x5bcca5[_0x122f43(0x1c8)]&&_0xde4202['invoice']==_0x5bcca5['from_invoice']&&_0xde4202[_0x122f43(0x263)]==_0x5bcca5['id_transaction_id']&&(_0xde4202[_0x122f43(0x234)]=_0xde4202[_0x122f43(0x234)]-_0x5bcca5[_0x122f43(0x25b)]);});}return _0x4bd8b6;});Promise['all'](_0x143d12)[_0x2ea998(0x1b7)](async _0xcbb41c=>{var _0x3bc3e4=_0x2ea998;try{for(const _0x1e0f7c of _0xcbb41c){await _0x1e0f7c[_0x3bc3e4(0x278)]();}try{const _0x2e0cde=_0x169a66[_0x3bc3e4(0x262)][_0x3bc3e4(0x266)](async _0x598107=>{var _0x3d0a13=_0x3bc3e4;if(_0x598107[_0x3d0a13(0x25b)]>0x0){var _0x2d1c70=await warehouse[_0x3d0a13(0x208)]({'name':_0x169a66[_0x3d0a13(0x21f)],'room':_0x598107[_0x3d0a13(0x203)],'warehouse_category':'Raw\x20Materials'}),_0x511c26=0x0;const _0x2fd868=_0x2d1c70[_0x3d0a13(0x1f0)][_0x3d0a13(0x266)](_0x444146=>{var _0x47acac=_0x3d0a13;_0x444146['product_name']==_0x598107[_0x47acac(0x235)]&&_0x444146['floorlevel']==_0x598107[_0x47acac(0x218)]&&_0x444146[_0x47acac(0x26c)]==_0x598107[_0x47acac(0x22a)]&&_0x444146[_0x47acac(0x1cb)]==_0x598107[_0x47acac(0x190)]&&_0x444146[_0x47acac(0x24b)]==_0x598107[_0x47acac(0x26d)]&&_0x444146[_0x47acac(0x270)]==_0x598107[_0x47acac(0x270)]&&_0x444146['storage']==_0x598107[_0x47acac(0x219)]&&_0x444146[_0x47acac(0x1a5)]==_0x598107[_0x47acac(0x1a5)]&&_0x444146[_0x47acac(0x207)]==_0x598107['batch_code']&&_0x444146['production_date']==_0x598107[_0x47acac(0x1c8)]&&_0x444146[_0x47acac(0x254)]==_0x598107[_0x47acac(0x1c2)]&&(_0x444146[_0x47acac(0x234)]=_0x444146[_0x47acac(0x234)]+_0x598107['to_quantity'],_0x511c26++);});_0x511c26=='0'&&(_0x2d1c70[_0x3d0a13(0x1f0)]=_0x2d1c70[_0x3d0a13(0x1f0)][_0x3d0a13(0x1f3)]({'product_name':_0x598107[_0x3d0a13(0x235)],'product_stock':_0x598107[_0x3d0a13(0x25b)],'bay':_0x598107[_0x3d0a13(0x26d)],'bin':_0x598107['to_bin'],'type':_0x598107['to_types'],'floorlevel':_0x598107[_0x3d0a13(0x218)],'storage':_0x598107['storage'],'rack':_0x598107['rack'],'product_code':_0x598107[_0x3d0a13(0x242)],'primary_code':_0x598107[_0x3d0a13(0x1dc)],'secondary_code':_0x598107['secondary_code'],'maxProducts':_0x598107[_0x3d0a13(0x1e0)],'storage':_0x598107[_0x3d0a13(0x219)],'rack':_0x598107[_0x3d0a13(0x270)],'expiry_date':_0x598107[_0x3d0a13(0x1a5)],'maxPerUnit':_0x598107[_0x3d0a13(0x20e)],'batch_code':_0x598107['batch_code'],'production_date':_0x598107[_0x3d0a13(0x1c8)]}));}return _0x2d1c70;});Promise['all'](_0x2e0cde)[_0x3bc3e4(0x1b7)](async _0x42f2a8=>{var _0x59f79c=_0x3bc3e4;try{for(const _0x40bdc8 of _0x42f2a8){await warehouse[_0x59f79c(0x22e)]({'_id':_0x40bdc8[_0x59f79c(0x263)]},{'$addToSet':{'product_details':{'$each':_0x40bdc8[_0x59f79c(0x1f0)]}}});}_0x169a66['finalize']=_0x59f79c(0x1c7);const _0x494490=await _0x169a66[_0x59f79c(0x278)](),_0xe21728=await master_shop['find'](),_0x23145c=await email_settings[_0x59f79c(0x208)](),_0x506a2c=await supervisor_settings[_0x59f79c(0x1a0)]();var _0x51f6da=_0x169a66[_0x59f79c(0x262)],_0x22b0d5='',_0x5b436f;for(_0x5b436f in _0x51f6da){_0x22b0d5+=_0x59f79c(0x237)+_0x59f79c(0x1a7)+_0x51f6da[_0x5b436f][_0x59f79c(0x235)]+_0x59f79c(0x274)+_0x59f79c(0x1a7)+_0x51f6da[_0x5b436f][_0x59f79c(0x242)]+_0x59f79c(0x274)+_0x59f79c(0x1a7)+_0x51f6da[_0x5b436f][_0x59f79c(0x25b)]+'</td>'+_0x59f79c(0x1a7)+_0x51f6da[_0x5b436f]['unit']+_0x59f79c(0x274)+_0x59f79c(0x1a7)+_0x51f6da[_0x5b436f][_0x59f79c(0x212)]+_0x59f79c(0x274)+_0x59f79c(0x1a7)+_0x169a66['to_warehouse']+_0x59f79c(0x274)+_0x59f79c(0x1a7)+_0x51f6da[_0x5b436f][_0x59f79c(0x203)]+_0x59f79c(0x274)+_0x59f79c(0x1a7)+_0x51f6da[_0x5b436f][_0x59f79c(0x219)]+_0x51f6da[_0x5b436f][_0x59f79c(0x270)]+_0x51f6da[_0x5b436f][_0x59f79c(0x26d)]+_0x51f6da[_0x5b436f][_0x59f79c(0x190)]+_0x51f6da[_0x5b436f]['to_types'][0x0]+_0x51f6da[_0x5b436f][_0x59f79c(0x218)]+'</td>','</tr>';}let _0x3594cf=nodemailer['createTransport']({'host':_0x23145c['host'],'port':Number(_0x23145c[_0x59f79c(0x264)]),'secure':![],'auth':{'user':_0x23145c[_0x59f79c(0x204)],'pass':_0x23145c[_0x59f79c(0x238)]}}),_0x5d9225={'from':_0x23145c[_0x59f79c(0x204)],'to':_0x506a2c[0x0][_0x59f79c(0x247)],'subject':_0x59f79c(0x1cc),'attachments':[{'filename':_0x59f79c(0x1ab),'path':__dirname+_0x59f79c(0x18d)+_0x59f79c(0x25f)+_0xe21728[0x0][_0x59f79c(0x1b0)],'cid':_0x59f79c(0x23a)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x59f79c(0x1da)+_0x59f79c(0x25d)+_0x59f79c(0x225)+_0x59f79c(0x25d)+_0x59f79c(0x26e)+_0x59f79c(0x233)+'<div>'+'<h2>\x20'+_0xe21728[0x0]['site_title']+_0x59f79c(0x19d)+_0x59f79c(0x233)+'</div>'+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x59f79c(0x265)+_0x169a66[_0x59f79c(0x254)]+'\x20'+_0x59f79c(0x1fc)+'\x20Order\x20Date\x20:\x20'+_0x169a66[_0x59f79c(0x201)]+'\x20'+'</span>'+_0x59f79c(0x1b2)+_0x59f79c(0x233)+_0x59f79c(0x269)+_0x59f79c(0x22b)+'<tr>'+_0x59f79c(0x1ca)+_0x59f79c(0x211)+_0x59f79c(0x1f8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x59f79c(0x1ec)+_0x59f79c(0x24f)+_0x59f79c(0x1ae)+_0x59f79c(0x198)+_0x59f79c(0x1e9)+'</thead>'+_0x59f79c(0x1d0)+'\x20'+_0x22b0d5+'\x20'+_0x59f79c(0x1d7)+_0x59f79c(0x1d3)+_0x59f79c(0x25d)+_0x59f79c(0x1ff)+_0x59f79c(0x1de)+_0xe21728[0x0][_0x59f79c(0x1f4)]+_0x59f79c(0x1b2)+'</div>'+_0x59f79c(0x233)+_0x59f79c(0x1a9)};_0x3594cf['sendMail'](_0x5d9225,function(_0x5619b4,_0x596d27){var _0xa5fb02=_0x59f79c;_0x5619b4?(console[_0xa5fb02(0x256)](_0x5619b4),console[_0xa5fb02(0x256)](_0xa5fb02(0x1fa))):console[_0xa5fb02(0x256)]('Email\x20sent\x20successfully');}),_0x507db7[_0x59f79c(0x1d2)](_0x59f79c(0x195),_0x59f79c(0x19a)),_0x43e5fc[_0x59f79c(0x22f)](_0x59f79c(0x1b1)+_0x494490[_0x59f79c(0x263)]);}catch(_0x4ba2d2){console[_0x59f79c(0x1cf)](_0x4ba2d2),_0x43e5fc['status'](0x1f4)[_0x59f79c(0x1d8)]({'Perror':_0x59f79c(0x197),'message':_0x4ba2d2['message']});}})[_0x3bc3e4(0x1bb)](_0x53e6fa=>{var _0x539ce4=_0x3bc3e4;console[_0x539ce4(0x1cf)](_0x53e6fa),_0x43e5fc[_0x539ce4(0x1bc)](0x1f4)[_0x539ce4(0x1d8)]({'Perror':_0x539ce4(0x1a3)});});}catch(_0x1f7949){_0x43e5fc[_0x3bc3e4(0x1d8)](_0x1f7949);}}catch(_0x56984a){console['error'](_0x56984a),_0x43e5fc[_0x3bc3e4(0x1bc)](0x1f4)['json']({'Merror':_0x3bc3e4(0x197),'Message':_0x56984a['message']});}})[_0x2ea998(0x1bb)](_0x170634=>{var _0x3b5fb7=_0x2ea998;console['error'](_0x170634),_0x43e5fc['status'](0x1f4)['json']({'Merror':_0x3b5fb7(0x1a3)});});}catch(_0x3b2475){console[_0x2ea998(0x256)](_0x3b2475);}});function BayBinSelected(_0x359509,_0x312c56){var _0x43aac6=a0_0x46fbe4,_0x4b9a35=[],_0x3c3fff=[],_0x300caf=[],_0x4cdaba=[],_0xeb162d=[],_0x442907=[];let _0x38b2f3=[];if(_0x359509==_0x43aac6(0x24e))switch(_0x312c56){case'Rack\x20A':_0x4b9a35=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x3c3fff=[0x1,0x2],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=[_0x43aac6(0x1db),_0x43aac6(0x24c)],_0xeb162d=['D'],_0x442907=['A'];break;case _0x43aac6(0x1ea):_0x4b9a35=[0x6,0x5,0x4,0x3,0x2,0x1],_0x3c3fff=[0x1,0x2],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=[_0x43aac6(0x1db),'Floor'],_0xeb162d=['D'],_0x442907=['B'];break;case _0x43aac6(0x217):_0x4b9a35=[0x0],_0x3c3fff=[0x0],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=[_0x43aac6(0x24c)],_0xeb162d=['D'],_0x442907=['S'];break;case _0x43aac6(0x1c1):_0x4b9a35=[0x0],_0x3c3fff=[0x0],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x300caf=[_0x43aac6(0x24c)],_0xeb162d=['D'],_0x442907=['R'];break;}else{if(_0x359509==_0x43aac6(0x18f))switch(_0x312c56){case'Rack\x20A':_0x4b9a35=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x3c3fff=['B','F'],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=[_0x43aac6(0x1db),_0x43aac6(0x24c)],_0xeb162d=['C'],_0x442907=['A'];break;case _0x43aac6(0x1ea):_0x4b9a35=[0x5,0x4,0x3,0x2,0x1],_0x3c3fff=['F','B','S'],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=[_0x43aac6(0x1db),_0x43aac6(0x24c)],_0xeb162d=['C'],_0x442907=['B'];break;case'Rack\x20C':_0x4b9a35=[0x1,0x2,0x3,0x4,0x5],_0x3c3fff=['B','F','S'],_0x4cdaba=[0x5,0x4,0x3,0x2,0x1],_0x300caf=['Level',_0x43aac6(0x24c)],_0xeb162d=['C'],_0x442907=['C'];break;case _0x43aac6(0x255):_0x4b9a35=[0x5,0x4,0x3,0x2,0x1],_0x3c3fff=['F','B','S'],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=[_0x43aac6(0x1db),_0x43aac6(0x24c)],_0xeb162d=['C'],_0x442907=['D'];break;case'Rack\x20E':_0x4b9a35=[0x4,0x3,0x2,0x1],_0x3c3fff=[0x1,0x2],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=[_0x43aac6(0x1db),_0x43aac6(0x24c)],_0xeb162d=['C'],_0x442907=['E'];break;case'Rack\x20F':_0x4b9a35=[0x1,0x2,0x3],_0x3c3fff=[0x1,0x2],_0x4cdaba=[0x1,0x2,0x3,0x4,0x5],_0x300caf=['Level'],_0xeb162d=['C'],_0x442907=['F'];break;}}return{'levels':_0x4b9a35,'Isle':_0x3c3fff,'rack':_0x4cdaba,'type':_0x300caf,'storage':_0xeb162d,'rak':_0x442907};}function a0_0x910b(){var _0x1b13ac=['$product_details.maxPerUnit','3QRXWCu','from_prod_isle','/preview/:id','then','488028MsTqiZ','floorlevel','length','catch','status','prod_name','3594050cOwGSB','rak','primary_unit','Receiving\x20Area','To_invoice','getFullYear','from_rack','aggregate','from_storage','True','production_date','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','bin','Transfer\x20Mail','20402723rjodJF','unit','error','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.bin','flash','</table>','27PnaPos','from_bay','$product_details.product_stock','</tbody>','json','Ambient','</head><body>','Level','primary_code','from_bin','<h5>','$product','maxProducts','$product_details.maxProducts','/view/:id','$product_details.pallet','../public/language/languages.json','body','14nqvTGB','$product_details.production_date','prod_cat','</tr>','Rack\x20B','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.isle','to_prod_isle','$product_details.bay','product_details','3878152dESRjs','getDate','concat','site_title','/transfer/view','render','from_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.secondary_unit','Error\x20Occurs','$date','<span\x20style=\x22float:\x20right;\x22>','add_transfer','/transfer/preview/','<strong>\x20Regards\x20</strong>','from_floorlevel','date','English\x20(US)','to_room_name','email','$product_details.level','Portuguese\x20(BR)','batch_code','findOne','post','slice','message','string','$product_details.rack','maxperunit','$product_details','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','secondary_unit','/CheckingWarehouse','max_per_unit','$product_details.unit','French','Shelves','to_floorlevel','storage','$product_details.secondary_code','1107226gwFvwU','findById','Chinese','MaxStocks_data2','to_warehouse','Router','/barcode_scanner3','edit_transfer_view','$product_details.storage','$product.from_room_name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','secondary_code','Spanish','$to_warehouse','$_id','to_types','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.batch_code','$isAllowEdit','updateOne','redirect','/view/add_transfer','from_prod_qty','from_room','</div>','product_stock','product_name','Portuguese','<tr>','password','from_invoice','logo','../middleware/auth','from_quantity','Arabic\x20(ae)','get','/barcode_scanner','user','$product_details.product_name','product_code','from_warehouse','toString','$product_details._id','staff','RMSEmail','params','TRF-','\x20<>\x20','bay','Floor','/view','DRY\x20STORAGE','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','here','master','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','to_room','invoice','Rack\x20D','log','Return\x20Rooms','split','$product.to_room_name','forEach','to_quantity','to_prod_qty','<div>','$product_details.product_code','/upload/','from_prod_level','Hindi','product','_id','port','\x20Order\x20Number\x20:\x20','map','id_transaction','RoomAssigned','<table\x20style=\x22width:\x20100%\x20!important;\x22>','language','20XeDkPt','type','to_bay','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','ToRoomAssigned','rack','all','$product_details.floorlevel','$finalize','</td>','note','product_code3','Enabled','save','filter','Raw\x20Materials','/../public','616415AKXNdf','COLD\x20STORAGE','to_bin','English','to_prod_level','warehouse','errors','success','to_invoice','An\x20error\x20occurred\x20while\x20saving\x20data.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','from_rak','Transfer\x20Finalize\x20Successfully','735425ysnNFx','$product_details.primary_code','\x20</h2>','$product_details.type','random','find','from_types','$name','An\x20error\x20occurred.','$room','expiry_date','New_Qty_Converted','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','floor','</body></html>','12uAGrwu','Logo.png','id_transaction_id','German','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','role','image','/picking_list/PDF_transfer_rm/','</h5>'];a0_0x910b=function(){return _0x1b13ac;};return a0_0x910b();}router['get'](a0_0x46fbe4(0x1e2),auth,async(_0x25a6cb,_0x502399)=>{var _0x5640c3=a0_0x46fbe4;try{const {username:_0x2b453d,email:_0x11f150,role:_0x5a8460}=_0x25a6cb[_0x5640c3(0x240)],_0x905fcd=_0x25a6cb[_0x5640c3(0x240)],_0x3b6eb0=await profile[_0x5640c3(0x208)]({'email':_0x905fcd['email']}),_0x59d85f=await master_shop['find'](),_0x1fe7bd=await transfers['findById'](_0x25a6cb[_0x5640c3(0x248)]['id']);let _0x5492c1;if(_0x905fcd['role']==_0x5640c3(0x246)){const _0x8139cd=await staff[_0x5640c3(0x208)]({'email':_0x905fcd[_0x5640c3(0x204)]});_0x5492c1=await warehouse[_0x5640c3(0x1c5)]([{'$match':{'status':_0x5640c3(0x277),'name':_0x8139cd[_0x5640c3(0x193)],'warehouse_category':_0x5640c3(0x27a)}},{'$group':{'_id':_0x5640c3(0x1a2),'name':{'$first':_0x5640c3(0x1a2)}}}]);}else _0x5492c1=await warehouse[_0x5640c3(0x1c5)]([{'$match':{'status':_0x5640c3(0x277),'warehouse_category':_0x5640c3(0x27a)}},{'$group':{'_id':_0x5640c3(0x1a2),'name':{'$first':_0x5640c3(0x1a2)}}}]);const _0x299f6a=await warehouse[_0x5640c3(0x1c5)]([{'$match':{'name':_0x1fe7bd[_0x5640c3(0x243)],'warehouse_category':_0x5640c3(0x27a)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5640c3(0x245),'name':{'$first':_0x5640c3(0x241)},'product_stock':{'$first':_0x5640c3(0x1d6)},'bay':{'$first':_0x5640c3(0x1ef)},'bin':{'$first':_0x5640c3(0x1d1)},'type':{'$first':_0x5640c3(0x19e)},'floorlevel':{'$first':_0x5640c3(0x272)},'primary_code':{'$first':_0x5640c3(0x19c)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5640c3(0x223)},'rack':{'$first':_0x5640c3(0x20d)},'expiry_date':{'$first':_0x5640c3(0x1eb)},'production_date':{'$first':_0x5640c3(0x1e7)},'room':{'$first':_0x5640c3(0x1a4)}}}]),_0x1418c9=await product[_0x5640c3(0x1a0)]({}),_0x4510e4=BayBinSelected(_0x1fe7bd[_0x5640c3(0x21f)],_0x1fe7bd['to_room']);if(_0x59d85f[0x0]['language']==_0x5640c3(0x202)){var _0x181177=users[_0x5640c3(0x191)];console[_0x5640c3(0x256)](_0x181177);}else{if(_0x59d85f[0x0]['language']==_0x5640c3(0x261))var _0x181177=users['Hindi'];else{if(_0x59d85f[0x0]['language']==_0x5640c3(0x1ad))var _0x181177=users[_0x5640c3(0x1ad)];else{if(_0x59d85f[0x0]['language']==_0x5640c3(0x227))var _0x181177=users[_0x5640c3(0x227)];else{if(_0x59d85f[0x0]['language']=='French')var _0x181177=users[_0x5640c3(0x216)];else{if(_0x59d85f[0x0][_0x5640c3(0x26a)]==_0x5640c3(0x206))var _0x181177=users[_0x5640c3(0x236)];else{if(_0x59d85f[0x0][_0x5640c3(0x26a)]==_0x5640c3(0x21d))var _0x181177=users[_0x5640c3(0x21d)];else{if(_0x59d85f[0x0][_0x5640c3(0x26a)]==_0x5640c3(0x23d))var _0x181177=users[_0x5640c3(0x210)];}}}}}}}_0x502399[_0x5640c3(0x1f6)]('edit_transfer',{'success':_0x25a6cb['flash'](_0x5640c3(0x195)),'errors':_0x25a6cb[_0x5640c3(0x1d2)](_0x5640c3(0x194)),'role':_0x905fcd,'profile':_0x3b6eb0,'master_shop':_0x59d85f,'warehouse':_0x5492c1,'transfer':_0x1fe7bd,'stock':_0x299f6a,'unit':_0x1418c9,'language':_0x181177});}catch(_0x466dea){console[_0x5640c3(0x256)](_0x466dea);}}),router[a0_0x46fbe4(0x209)](a0_0x46fbe4(0x1e2),auth,async(_0x34077a,_0x2b627b)=>{var _0x3e2d06=a0_0x46fbe4;try{const _0x9f6d1d=_0x34077a[_0x3e2d06(0x248)]['id'],_0x49a8af=await transfers[_0x3e2d06(0x21c)](_0x9f6d1d);_0x2b627b[_0x3e2d06(0x1d8)](_0x34077a[_0x3e2d06(0x1e5)]);return;const {date:_0x3389f9,from_warehouse:_0x4f3f80,FromRoom_name:_0x11db04,to_warehouse:_0x2f9f6a,ToRoom_name:_0x9a75f6,prod_name:_0x109d93,from_prod_qty:_0x5709e6,from_prod_level:_0x5e1dac,from_prod_isle:_0x288daf,from_prod_pallet:_0x3b138d,to_prod_qty:_0x1d14f2,to_prod_level:_0x3d0ad0,to_prod_isle:_0x366674,to_prod_pallet:_0x4fc9a8,primary_code:_0x2144f0,secondary_code:_0x45b6fc,product_code3:_0x31edde,note:_0x261cf7,invoice:_0x2403e7,expiry_date:_0x30ed8c}=_0x34077a['body'];if(typeof _0x109d93=='string')var _0x2909f4=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1bd)]],_0x1c1354=[_0x34077a['body'][_0x3e2d06(0x231)]],_0x1ebf10=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x260)]],_0x29dd6e=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1b5)]],_0x2e630d=[_0x34077a[_0x3e2d06(0x1e5)]['from_prod_pallet']],_0x8be8ce=[_0x34077a['body'][_0x3e2d06(0x1a1)]],_0xa518d3=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x25c)]],_0x4d6878=[_0x34077a['body'][_0x3e2d06(0x192)]],_0x1306b1=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1ee)]],_0x5dea1d=[_0x34077a[_0x3e2d06(0x1e5)]['to_prod_pallet']],_0x4f9fd7=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x22a)]],_0x383a50=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x219)]],_0x24f642=[_0x34077a['body']['rak']],_0x5e4a7d=[_0x34077a[_0x3e2d06(0x1e5)]['primary_code']],_0x163856=[_0x34077a[_0x3e2d06(0x1e5)]['secondary_code']],_0x52f410=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x276)]],_0x4151ef=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x21e)]],_0x5962b0=[_0x34077a[_0x3e2d06(0x1e5)]['unit']],_0x4e7da3=[_0x34077a['body'][_0x3e2d06(0x212)]],_0x5a585e=[_0x34077a['body'][_0x3e2d06(0x207)]],_0x82c3f3=[_0x34077a['body'][_0x3e2d06(0x1a5)]],_0x170ad1=[_0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1c6)]],_0x43f909=[_0x34077a[_0x3e2d06(0x1e5)]['from_rak']];else var _0x2909f4=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1bd)]],_0x383a50=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x219)]],_0x24f642=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1bf)]],_0x8be8ce=[..._0x34077a['body'][_0x3e2d06(0x1a1)]],_0x4f9fd7=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x22a)]],_0x1c1354=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x231)]],_0x1ebf10=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x260)]],_0x29dd6e=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1b5)]],_0x2e630d=[..._0x34077a[_0x3e2d06(0x1e5)]['from_prod_pallet']],_0xa518d3=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x25c)]],_0x4d6878=[..._0x34077a[_0x3e2d06(0x1e5)]['to_prod_level']],_0x1306b1=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1ee)]],_0x5dea1d=[..._0x34077a[_0x3e2d06(0x1e5)]['to_prod_pallet']],_0x5e4a7d=[..._0x34077a[_0x3e2d06(0x1e5)]['primary_code']],_0x163856=[..._0x34077a['body'][_0x3e2d06(0x226)]],_0x52f410=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x276)]],_0x4151ef=[..._0x34077a['body'][_0x3e2d06(0x21e)]],_0x5962b0=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1ce)]],_0x4e7da3=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x212)]],_0x5a585e=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x207)]],_0x82c3f3=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1a5)]],_0x170ad1=[..._0x34077a[_0x3e2d06(0x1e5)][_0x3e2d06(0x1c6)]],_0x43f909=[..._0x34077a['body'][_0x3e2d06(0x199)]];const _0x4e3737=_0x2909f4[_0x3e2d06(0x266)](_0x71368f=>{return _0x71368f={'product_name':_0x71368f};});_0x1c1354['forEach']((_0x3f3f34,_0x51896a)=>{var _0x45ed41=_0x3e2d06;_0x4e3737[_0x51896a][_0x45ed41(0x23c)]=_0x3f3f34;}),_0x1ebf10['forEach']((_0x5a9d63,_0x5f32f7)=>{var _0x33f67d=_0x3e2d06;_0x4e3737[_0x5f32f7][_0x33f67d(0x1d5)]=_0x5a9d63;}),_0x29dd6e[_0x3e2d06(0x25a)]((_0x1aef28,_0x42c138)=>{_0x4e3737[_0x42c138]['from_bin']=_0x1aef28;}),_0x2e630d['forEach']((_0x518cbe,_0x13db98)=>{var _0x407a3c=_0x3e2d06;_0x4e3737[_0x13db98][_0x407a3c(0x200)]=_0x518cbe;}),_0xa518d3[_0x3e2d06(0x25a)]((_0x438817,_0x20e826)=>{var _0x55575a=_0x3e2d06;_0x4e3737[_0x20e826][_0x55575a(0x25b)]=_0x438817;}),_0x4d6878['forEach']((_0x215047,_0x393c95)=>{_0x4e3737[_0x393c95]['to_bay']=_0x215047;}),_0x1306b1['forEach']((_0x5b59b7,_0x4c42bd)=>{var _0x5126d1=_0x3e2d06;_0x4e3737[_0x4c42bd][_0x5126d1(0x190)]=_0x5b59b7;}),_0x5dea1d[_0x3e2d06(0x25a)]((_0x721e66,_0x3bee35)=>{var _0x717177=_0x3e2d06;_0x4e3737[_0x3bee35][_0x717177(0x218)]=_0x721e66;}),_0x5e4a7d[_0x3e2d06(0x25a)]((_0x1e223b,_0x1ef99f)=>{var _0x22452d=_0x3e2d06;_0x4e3737[_0x1ef99f][_0x22452d(0x1dc)]=_0x1e223b;}),_0x163856[_0x3e2d06(0x25a)]((_0x5afcb4,_0x2324d9)=>{var _0x32b1fe=_0x3e2d06;_0x4e3737[_0x2324d9][_0x32b1fe(0x226)]=_0x5afcb4;}),_0x52f410[_0x3e2d06(0x25a)]((_0x18e767,_0x5ea859)=>{_0x4e3737[_0x5ea859]['product_code']=_0x18e767;}),_0x4151ef['forEach']((_0x21950d,_0x534e77)=>{_0x4e3737[_0x534e77]['maxProducts']=_0x21950d;}),_0x5962b0[_0x3e2d06(0x25a)]((_0x56fb08,_0x336892)=>{var _0x36cef7=_0x3e2d06;_0x4e3737[_0x336892][_0x36cef7(0x1ce)]=_0x56fb08;}),_0x4e7da3[_0x3e2d06(0x25a)]((_0x1656f1,_0x31be4f)=>{var _0xd396ad=_0x3e2d06;_0x4e3737[_0x31be4f][_0xd396ad(0x212)]=_0x1656f1;}),_0x5a585e[_0x3e2d06(0x25a)]((_0x5e8227,_0x247767)=>{var _0x2fcc3a=_0x3e2d06;_0x4e3737[_0x247767][_0x2fcc3a(0x207)]=_0x5e8227;}),_0x82c3f3['forEach']((_0x48a78e,_0x375f05)=>{var _0x2bb0c4=_0x3e2d06;_0x4e3737[_0x375f05][_0x2bb0c4(0x1a5)]=_0x48a78e;}),_0x383a50[_0x3e2d06(0x25a)]((_0x40f006,_0x482ef9)=>{var _0x3258c5=_0x3e2d06;_0x4e3737[_0x482ef9][_0x3258c5(0x219)]=_0x40f006;}),_0x24f642[_0x3e2d06(0x25a)]((_0x3aefe6,_0x4faac6)=>{var _0x13c5fc=_0x3e2d06;_0x4e3737[_0x4faac6][_0x13c5fc(0x270)]=_0x3aefe6;}),_0x8be8ce[_0x3e2d06(0x25a)]((_0x42b8ac,_0x3c785a)=>{var _0x1dba25=_0x3e2d06;_0x4e3737[_0x3c785a][_0x1dba25(0x1a1)]=_0x42b8ac;}),_0x4f9fd7['forEach']((_0x2ba47c,_0x3471b0)=>{var _0xdecff9=_0x3e2d06;_0x4e3737[_0x3471b0][_0xdecff9(0x22a)]=_0x2ba47c;}),_0x170ad1['forEach']((_0x288b9d,_0x92c145)=>{var _0x2ea4a7=_0x3e2d06;_0x4e3737[_0x92c145][_0x2ea4a7(0x1c6)]=_0x288b9d;}),_0x43f909['forEach']((_0x37762e,_0x178741)=>{var _0x1d8874=_0x3e2d06;_0x4e3737[_0x178741][_0x1d8874(0x1c4)]=_0x37762e;});const _0x4b1fe4=_0x4e3737[_0x3e2d06(0x279)](_0x5dc727=>_0x5dc727[_0x3e2d06(0x25b)]!=='0'&&_0x5dc727[_0x3e2d06(0x25b)]!==''||_0x5dc727[_0x3e2d06(0x218)]!=='0'&&_0x5dc727[_0x3e2d06(0x218)]!=='');var _0x4a4b30=0x0;_0x4b1fe4[_0x3e2d06(0x25a)](_0x48742b=>{var _0x2bf9c4=_0x3e2d06;parseInt(_0x48742b[_0x2bf9c4(0x23c)])<parseInt(_0x48742b[_0x2bf9c4(0x25b)])&&_0x4a4b30++;});if(_0x4a4b30!=0x0)return _0x34077a[_0x3e2d06(0x1d2)]('errors',_0x3e2d06(0x252)),_0x2b627b['redirect']('back');const _0x1a8153=await warehouse['findOne']({'name':_0x49a8af[_0x3e2d06(0x243)],'room':_0x49a8af[_0x3e2d06(0x232)]});_0x49a8af[_0x3e2d06(0x262)][_0x3e2d06(0x25a)](_0x20b12c=>{var _0x57078a=_0x3e2d06;if(_0x20b12c['to_quantity']>0x0){const _0x55661a=_0x1a8153[_0x57078a(0x1f0)]['map'](_0x48da65=>{var _0x4548b7=_0x57078a;_0x48da65[_0x4548b7(0x235)]==_0x20b12c[_0x4548b7(0x235)]&&_0x48da65[_0x4548b7(0x1b9)]==_0x20b12c[_0x4548b7(0x200)]&&_0x48da65[_0x4548b7(0x26c)]==_0x20b12c[_0x4548b7(0x1a1)]&&_0x48da65[_0x4548b7(0x1cb)]==_0x20b12c['from_bin']&&_0x48da65[_0x4548b7(0x24b)]==_0x20b12c['from_bay']&&_0x48da65['rack']==_0x20b12c[_0x4548b7(0x1c4)]&&_0x48da65[_0x4548b7(0x219)]==_0x20b12c[_0x4548b7(0x1c6)]&&(_0x48da65[_0x4548b7(0x234)]=parseInt(_0x48da65[_0x4548b7(0x234)])+parseInt(_0x20b12c['to_quantity']));});}}),await _0x1a8153[_0x3e2d06(0x278)]();const _0x432317=await warehouse[_0x3e2d06(0x208)]({'name':_0x49a8af[_0x3e2d06(0x21f)],'room':_0x49a8af[_0x3e2d06(0x253)]});_0x49a8af[_0x3e2d06(0x262)][_0x3e2d06(0x25a)](_0x50c7bb=>{var _0x303449=_0x3e2d06;if(_0x50c7bb[_0x303449(0x25b)]>0x0){const _0xefa300=_0x432317[_0x303449(0x1f0)]['map'](_0x30a569=>{var _0x5a1ceb=_0x303449;_0x30a569['product_name']==_0x50c7bb['product_name']&&_0x30a569['floorlevel']==_0x50c7bb[_0x5a1ceb(0x218)]&&_0x30a569['type']==_0x50c7bb['to_types']&&_0x30a569['bin']==_0x50c7bb[_0x5a1ceb(0x190)]&&_0x30a569[_0x5a1ceb(0x24b)]==_0x50c7bb[_0x5a1ceb(0x26d)]&&_0x30a569[_0x5a1ceb(0x270)]==_0x50c7bb[_0x5a1ceb(0x270)]&&_0x30a569[_0x5a1ceb(0x219)]==_0x50c7bb[_0x5a1ceb(0x219)]&&(_0x30a569[_0x5a1ceb(0x234)]=parseInt(_0x30a569[_0x5a1ceb(0x234)])-parseInt(_0x50c7bb[_0x5a1ceb(0x25b)]));});}}),await _0x432317['save'](),_0x49a8af[_0x3e2d06(0x201)]=_0x3389f9,_0x49a8af[_0x3e2d06(0x243)]=_0x4f3f80,_0x49a8af[_0x3e2d06(0x21f)]=_0x2f9f6a,_0x49a8af[_0x3e2d06(0x262)]=_0x4b1fe4,_0x49a8af[_0x3e2d06(0x275)]=_0x261cf7,_0x49a8af[_0x3e2d06(0x254)]=_0x2403e7;const _0x3dc631=await _0x49a8af[_0x3e2d06(0x278)]();console['log'](_0x3dc631);const _0x27b219=await warehouse[_0x3e2d06(0x208)]({'name':_0x4f3f80,'room':_0x11db04});_0x3dc631[_0x3e2d06(0x262)][_0x3e2d06(0x25a)](_0x5d7e53=>{var _0x229b92=_0x3e2d06;if(_0x5d7e53[_0x229b92(0x25b)]>0x0){const _0x2684c8=_0x27b219[_0x229b92(0x1f0)][_0x229b92(0x266)](_0x128942=>{var _0x5b4a9f=_0x229b92;_0x128942[_0x5b4a9f(0x235)]==_0x5d7e53[_0x5b4a9f(0x235)]&&_0x128942['floorlevel']==_0x5d7e53[_0x5b4a9f(0x200)]&&_0x128942['type']==_0x5d7e53[_0x5b4a9f(0x1a1)]&&_0x128942[_0x5b4a9f(0x1cb)]==_0x5d7e53[_0x5b4a9f(0x1dd)]&&_0x128942[_0x5b4a9f(0x24b)]==_0x5d7e53[_0x5b4a9f(0x1d5)]&&_0x128942[_0x5b4a9f(0x270)]==_0x5d7e53['from_rack']&&_0x128942[_0x5b4a9f(0x219)]==_0x5d7e53[_0x5b4a9f(0x1c6)]&&(_0x128942[_0x5b4a9f(0x234)]=parseInt(_0x128942[_0x5b4a9f(0x234)])-parseInt(_0x5d7e53[_0x5b4a9f(0x25b)]));});}}),await _0x27b219[_0x3e2d06(0x278)]();const _0x1cdfb6=await warehouse[_0x3e2d06(0x208)]({'name':_0x2f9f6a,'room':_0x9a75f6});_0x3dc631['product'][_0x3e2d06(0x25a)](_0x12561a=>{var _0x3f7244=_0x3e2d06;if(_0x12561a[_0x3f7244(0x25b)]>0x0){var _0x3d9116=0x0;const _0x3d89d5=_0x1cdfb6['product_details'][_0x3f7244(0x266)](_0x1096f7=>{var _0x270a2=_0x3f7244;_0x1096f7['product_name']==_0x12561a[_0x270a2(0x235)]&&_0x1096f7['floorlevel']==_0x12561a['to_floorlevel']&&_0x1096f7['type']==_0x12561a[_0x270a2(0x22a)]&&_0x1096f7[_0x270a2(0x1cb)]==_0x12561a[_0x270a2(0x190)]&&_0x1096f7[_0x270a2(0x24b)]==_0x12561a[_0x270a2(0x26d)]&&_0x1096f7[_0x270a2(0x270)]==_0x12561a['rack']&&_0x1096f7[_0x270a2(0x219)]==_0x12561a[_0x270a2(0x219)]&&(_0x1096f7['product_stock']=parseInt(_0x1096f7['product_stock'])+parseInt(_0x12561a[_0x270a2(0x25b)]),_0x3d9116++);});_0x3d9116=='0'&&(_0x1cdfb6['product_details']=_0x1cdfb6['product_details'][_0x3f7244(0x1f3)]({'product_name':_0x12561a[_0x3f7244(0x235)],'product_stock':_0x12561a[_0x3f7244(0x25b)],'bay':_0x12561a[_0x3f7244(0x26d)],'bin':_0x12561a[_0x3f7244(0x190)],'type':_0x12561a['to_types'],'floorlevel':_0x12561a[_0x3f7244(0x218)],'storage':_0x12561a['storage'],'rack':_0x12561a['rack'],'product_code':_0x12561a['product_code'],'primary_code':_0x12561a[_0x3f7244(0x1dc)],'secondary_code':_0x12561a[_0x3f7244(0x226)],'maxProducts':_0x12561a['maxProducts'],'storage':_0x12561a['storage'],'rack':_0x12561a[_0x3f7244(0x270)]}));}}),await _0x1cdfb6[_0x3e2d06(0x278)](),_0x34077a['flash'](_0x3e2d06(0x195),'Transfer\x20Edit\x20Successfully'),_0x2b627b[_0x3e2d06(0x22f)](_0x3e2d06(0x1f5));}catch(_0x4858f2){console[_0x3e2d06(0x256)](_0x4858f2);}}),router['post'](a0_0x46fbe4(0x23f),async(_0x1400b9,_0x4d4296)=>{var _0x5e1c2f=a0_0x46fbe4;const {FromWareHouse:_0x4b29d5,FromRoom:_0x1618bd,ToWarehouse:_0x55b355,ToRoom:_0x33541b,primary_code:_0x57f23a,Roomslist:_0x4ff7be}=_0x1400b9[_0x5e1c2f(0x1e5)],_0x57bcca=_0x4ff7be[_0x5e1c2f(0x258)](','),_0x57c8cb=[];async function _0x501f12(_0x5a6f53){var _0x325860=_0x5e1c2f;const _0x1fc69=await warehouse[_0x325860(0x1c5)]([{'$match':{'name':_0x4b29d5,'room':_0x5a6f53}},{'$unwind':_0x325860(0x20f)},{'$match':{'product_details.primary_code':_0x57f23a}},{'$group':{'_id':_0x325860(0x245),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x325860(0x1d6)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x325860(0x21a)},'product_code':{'$first':_0x325860(0x25e)},'level':{'$first':_0x325860(0x1ef)},'isle':{'$first':_0x325860(0x1d1)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x325860(0x272)},'unit':{'$first':_0x325860(0x215)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x325860(0x223)},'rack':{'$first':_0x325860(0x20d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x325860(0x1e7)},'batch_code':{'$first':_0x325860(0x22c)},'maxPerUnit':{'$first':_0x325860(0x1b3)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x325860(0x1a4)},'maxProducts':{'$first':_0x325860(0x1e1)},'invoice_product':{'$first':_0x325860(0x1c9)}}}]),_0x4db235=await warehouse['aggregate']([{'$match':{'name':_0x4b29d5,'room':_0x5a6f53}},{'$unwind':_0x325860(0x20f)},{'$match':{'product_details.secondary_code':_0x57f23a}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x325860(0x241)},'instock':{'$first':_0x325860(0x1d6)},'primary_code':{'$first':_0x325860(0x19c)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x325860(0x25e)},'level':{'$first':_0x325860(0x1ef)},'isle':{'$first':_0x325860(0x1d1)},'type':{'$first':_0x325860(0x19e)},'pallet':{'$first':_0x325860(0x272)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x325860(0x1f9)},'storage':{'$first':_0x325860(0x223)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x325860(0x22c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x325860(0x1c9)}}}]);if(_0x1fc69[_0x325860(0x1ba)]>0x0)_0x57c8cb['push'](_0x1fc69);else _0x4db235['length']>0x0&&_0x57c8cb['push'](_0x4db235);}const _0xc5a073=_0x57bcca[_0x5e1c2f(0x266)](_0x215b6b=>_0x501f12(_0x215b6b));await Promise[_0x5e1c2f(0x271)](_0xc5a073),_0x4d4296[_0x5e1c2f(0x1d8)](_0x57c8cb);}),router[a0_0x46fbe4(0x209)]('/barcode_scanner2',async(_0xa903a3,_0x2194d9)=>{var _0x47a6a6=a0_0x46fbe4;try{const {FromWareHouse:_0x490cfc,FromRoom:_0x2da884,ToWarehouse:_0x224d8b,ToRoom:_0x3a0af5,secondary_code:_0x1ee5f1}=_0xa903a3['body'],_0x4f79e7=await warehouse['aggregate']([{'$match':{'name':_0x490cfc}},{'$unwind':_0x47a6a6(0x20f)},{'$match':{'product_details.secondary_code':_0x1ee5f1}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x47a6a6(0x19c)},'secondary_code':{'$first':_0x47a6a6(0x21a)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x47a6a6(0x1a2)},'level':{'$first':_0x47a6a6(0x205)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x47a6a6(0x1e3)},'maxProducts':{'$first':_0x47a6a6(0x1e1)},'unit':{'$first':'$product_details.unit'}}}]);_0x2194d9[_0x47a6a6(0x1bc)](0xc8)[_0x47a6a6(0x1d8)](_0x4f79e7);}catch(_0x1dbd1e){_0x2194d9[_0x47a6a6(0x1bc)](0x194)['json']({'message':_0x1dbd1e['message']});}}),router[a0_0x46fbe4(0x209)](a0_0x46fbe4(0x221),async(_0x29663f,_0x102344)=>{var _0xc46fe2=a0_0x46fbe4;try{const {FromWareHouse:_0x29f8e2,FromRoom:_0x28db74,ToWarehouse:_0x21e900,ToRoom:_0xc9fdbe,product_code:_0x395474}=_0x29663f[_0xc46fe2(0x1e5)],_0x50d188=await warehouse[_0xc46fe2(0x1c5)]([{'$match':{'name':_0x29f8e2}},{'$unwind':_0xc46fe2(0x20f)},{'$match':{'product_details.product_code':_0x395474}},{'$group':{'_id':_0xc46fe2(0x245),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0xc46fe2(0x19c)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xc46fe2(0x25e)},'instock':{'$first':_0xc46fe2(0x1d6)},'warehouse':{'$first':'$name'},'level':{'$first':_0xc46fe2(0x205)},'isle':{'$first':_0xc46fe2(0x1ed)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0xc46fe2(0x215)}}}]);_0x102344[_0xc46fe2(0x1bc)](0xc8)[_0xc46fe2(0x1d8)](_0x50d188);}catch(_0x365360){_0x102344['status'](0x194)[_0xc46fe2(0x1d8)]({'message':_0x365360[_0xc46fe2(0x20b)]});}}),router['post'](a0_0x46fbe4(0x213),async(_0x2e6bd2,_0x1db00e)=>{var _0x211816=a0_0x46fbe4;const {level:_0x52b39a,isle:_0x5356cf,pallet:_0x42b13f,warehouses:_0x2bc3bf,room:_0x190232}=_0x2e6bd2['body'];try{const _0x3df335=await warehouse[_0x211816(0x1c5)]([{'$match':{'name':_0x2bc3bf,'room':_0x190232}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x52b39a),'product_details.isle':_0x5356cf,'product_details.pallet':parseInt(_0x42b13f)}},{'$group':{'_id':_0x211816(0x245),'name':{'$first':_0x211816(0x241)},'product_stock':{'$first':_0x211816(0x1d6)},'level':{'$first':_0x211816(0x205)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x211816(0x1e3)},'maxProducts':{'$first':_0x211816(0x1e1)}}}]);_0x1db00e[_0x211816(0x1bc)](0xc8)[_0x211816(0x1d8)](_0x3df335);}catch(_0xfacaef){_0x1db00e[_0x211816(0x1bc)](0x194)[_0x211816(0x1d8)]({'message':_0xfacaef['message']});}}),module['exports']=router;