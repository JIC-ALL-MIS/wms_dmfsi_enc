var a0_0x50b1ff=a0_0x48cc;(function(_0x5606f9,_0x5344a2){var _0x2f02f5=a0_0x48cc,_0x10d8b8=_0x5606f9();while(!![]){try{var _0x36b0f0=parseInt(_0x2f02f5(0x105))/0x1+-parseInt(_0x2f02f5(0x146))/0x2+parseInt(_0x2f02f5(0x136))/0x3*(parseInt(_0x2f02f5(0x145))/0x4)+parseInt(_0x2f02f5(0x115))/0x5+-parseInt(_0x2f02f5(0x152))/0x6+parseInt(_0x2f02f5(0xf6))/0x7+parseInt(_0x2f02f5(0x141))/0x8*(parseInt(_0x2f02f5(0x1a5))/0x9);if(_0x36b0f0===_0x5344a2)break;else _0x10d8b8['push'](_0x10d8b8['shift']());}catch(_0x998586){_0x10d8b8['push'](_0x10d8b8['shift']());}}}(a0_0x5480,0xad83c));function a0_0x5480(){var _0x134e3a=['4187424jUOtBq','Raw\x20Materials','exports','English\x20(US)','from_prod_pallet','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','all','</tbody>','../models/all_models','email','get','prod_name','English','$product_details._id','$product_details.product_code','note','../public/language/languages.json','role','<table\x20style=\x22width:\x20100%\x20!important;\x22>','_id','logo','staff','toString','from_room','to_prod_isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</td>','user','floorlevel','aggregate','</tr>','$product_details.unit','Rack\x20C','from_rack','Arabic','<h2>\x20','language','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Rack\x20A','to_floorlevel','<tr>','unit','Arabic\x20(ae)','$product_details','<h5>','Transfer\x20Finalize\x20Successfully','findById','nodemailer','type','$from_warehouse','$product_details.maxProducts','$product_details.secondary_unit','rak','$invoice','to_types','$product_details.secondary_code','Transfer\x20Edit\x20Successfully','German','Transfer\x20Mail','invoice','post','Logo.png','/barcode_scanner2','secondary_unit','$product_details.storage','maxProducts','product_name','Product\x20Transfer\x20successfully','map','to_bin','Receiving\x20Area','to_room_name','expiry_date','$product_details.bay','updateOne','True','/preview/:id','$product_details.product_name','length','body','$product_details.primary_code','add_transfer','An\x20error\x20occurred\x20while\x20saving\x20data.','18kMrKuS','password','from_bay','primary_code','An\x20error\x20occurred.','from_prod_isle','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','\x20Order\x20Date\x20:\x20','primary_unit','$product_details.product_stock','/CheckingWarehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.pallet','RoomAssigned','port','from_invoice','Hindi','from_storage','site_title','render','to_room','findOne','from_rak','createTransport','then','Enabled','product','log','secondary_code','/view/add_transfer','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.type','$product_details.bin','ToRoomAssigned','string','Floor','to_prod_pallet','errors','Enclosed','from_room_name','to_warehouse','$finalize','RMSEmail','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','image','batch_code','$name','max_per_unit','from_prod_level','/view/:id','Portuguese\x20(BR)','<h5\x20style=\x22text-align:\x20left;\x22>','product_details','Email\x20sent\x20successfully','getFullYear','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','flash','Spanish','\x20Order\x20Number\x20:\x20','push','4228784FzPPtN','To_invoice','</div>','/picking_list/PDF_transfer_rm/','</table>','from_types','prod_cat','padStart','TRF-','redirect','save','</h5>','production_date','from_floorlevel','/transfer/view','598263nLHfKT','product_code3','MaxStocks_data2','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.expiry_date','<div>','slice','Ambient','sendMail','edit_transfer','to_quantity','Rack\x20D','success','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','storage','/view','5506790cnqVVQ','to_prod_qty','product_stock','from_warehouse','params','message','date','maxperunit','</head><body>','Chinese','Portuguese','DRY\x20STORAGE','$product_details.rack','filter','$product_details.batch_code','from_prod_qty','Rack\x20B','$product_details.maxPerUnit','to_invoice','Level','rack','Shelves','to_bay','json','Rack\x20F','getDate','split','COLD\x20STORAGE','transfer','<span\x20style=\x22float:\x20right;\x22>','warehouse','$room','</thead>','830514ISADjc','master','catch','product_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.floorlevel','concat','forEach','Router','to_prod_level','French','415616jrbhnR','$date','<html><head><title></title>','from_quantity','4OUpUGG','2551710RPtuyq','$product_details.level','$product_details.production_date','bin','<hr\x20class=\x22my-3\x22>','$product_details.isle','express','<strong>\x20Regards\x20</strong>','from_bin','bay','error','$isAllowEdit'];a0_0x5480=function(){return _0x134e3a;};return a0_0x5480();}const express=require(a0_0x50b1ff(0x14c)),app=express(),router=express[a0_0x50b1ff(0x13e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x50b1ff(0x15a)),auth=require('../middleware/auth'),users=require(a0_0x50b1ff(0x162)),nodemailer=require(a0_0x50b1ff(0x181));function a0_0x48cc(_0x1d9a4a,_0x2598f8){var _0x5480b4=a0_0x5480();return a0_0x48cc=function(_0x48cc2f,_0x39b1fa){_0x48cc2f=_0x48cc2f-0xe0;var _0x4b0609=_0x5480b4[_0x48cc2f];return _0x4b0609;},a0_0x48cc(_0x1d9a4a,_0x2598f8);}router[a0_0x50b1ff(0x15c)](a0_0x50b1ff(0x114),auth,async(_0x2e1502,_0x4eb5c4)=>{var _0x17f9e3=a0_0x50b1ff;try{const {username:_0x91525,email:_0x173e96,role:_0x7ff9b3}=_0x2e1502[_0x17f9e3(0x16d)],_0x4375c4=_0x2e1502['user'],_0x1dd78c=await profile[_0x17f9e3(0x1ba)]({'email':_0x4375c4['email']}),_0x14fece=await master_shop[_0x17f9e3(0xf0)]();console[_0x17f9e3(0x1c0)](_0x17f9e3(0x137),_0x14fece);let _0x487fe5;if(_0x4375c4[_0x17f9e3(0x163)]==_0x17f9e3(0x167)){const _0x16611f=await staff[_0x17f9e3(0x1ba)]({'email':_0x4375c4[_0x17f9e3(0x15b)]});_0x487fe5=await transfers[_0x17f9e3(0xf0)]({'from_warehouse':_0x16611f[_0x17f9e3(0x133)]});}else _0x487fe5=await transfers[_0x17f9e3(0x16f)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x17f9e3(0x187)},'date':{'$first':_0x17f9e3(0x142)},'from_warehouse':{'$first':_0x17f9e3(0x183)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x17f9e3(0xe2)},'isAllowEdit':{'$first':_0x17f9e3(0x151)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x14fece[0x0][_0x17f9e3(0x176)]==_0x17f9e3(0x155)){var _0x59d147=users[_0x17f9e3(0x15e)];console[_0x17f9e3(0x1c0)](_0x59d147);}else{if(_0x14fece[0x0][_0x17f9e3(0x176)]==_0x17f9e3(0x1b5))var _0x59d147=users[_0x17f9e3(0x1b5)];else{if(_0x14fece[0x0][_0x17f9e3(0x176)]==_0x17f9e3(0x18b))var _0x59d147=users[_0x17f9e3(0x18b)];else{if(_0x14fece[0x0]['language']==_0x17f9e3(0xf3))var _0x59d147=users[_0x17f9e3(0xf3)];else{if(_0x14fece[0x0][_0x17f9e3(0x176)]=='French')var _0x59d147=users[_0x17f9e3(0x140)];else{if(_0x14fece[0x0][_0x17f9e3(0x176)]=='Portuguese\x20(BR)')var _0x59d147=users[_0x17f9e3(0x11f)];else{if(_0x14fece[0x0][_0x17f9e3(0x176)]=='Chinese')var _0x59d147=users[_0x17f9e3(0x11e)];else{if(_0x14fece[0x0][_0x17f9e3(0x176)]=='Arabic\x20(ae)')var _0x59d147=users[_0x17f9e3(0x174)];}}}}}}}_0x4eb5c4['render'](_0x17f9e3(0x131),{'success':_0x2e1502[_0x17f9e3(0xf2)](_0x17f9e3(0x111)),'errors':_0x2e1502[_0x17f9e3(0xf2)](_0x17f9e3(0x1cb)),'role':_0x4375c4,'profile':_0x1dd78c,'master_shop':_0x14fece,'transfer':_0x487fe5,'language':_0x59d147});}catch(_0x262035){console[_0x17f9e3(0x1c0)](_0x262035);}});async function getRandom8DigitNumber(){var _0x500dac=a0_0x50b1ff;const _0x868b99=0x989680,_0x35fe43=0x5f5e0ff,_0x69dbbc=Math['floor'](Math['random']()*(_0x35fe43-_0x868b99+0x1))+_0x868b99;var _0x412f42;const _0xdf1c3b=await transfers[_0x500dac(0x1ba)]({'invoice':'TRF-'+_0x69dbbc});return _0xdf1c3b&&_0xdf1c3b[_0x500dac(0x1a0)]>0x0?_0x412f42='TRF-'+_0x69dbbc:_0x412f42='TRF-'+_0x69dbbc,_0x412f42;}router['get']('/view/add_transfer',auth,async(_0x8ca342,_0x2cb7c9)=>{var _0x5ed86b=a0_0x50b1ff;try{const {username:_0x573f05,email:_0xde52da,role:_0x5e54d0}=_0x8ca342[_0x5ed86b(0x16d)],_0x5dd0d1=_0x8ca342[_0x5ed86b(0x16d)],_0x2b73cd=await profile[_0x5ed86b(0x1ba)]({'email':_0x5dd0d1[_0x5ed86b(0x15b)]}),_0x117d10=await master_shop[_0x5ed86b(0xf0)]();console[_0x5ed86b(0x1c0)](_0x5ed86b(0x137),_0x117d10);let _0x1684ec;if(_0x5dd0d1['role']==_0x5ed86b(0x167)){const _0x180077=await staff[_0x5ed86b(0x1ba)]({'email':_0x5dd0d1['email']});_0x1684ec=await warehouse[_0x5ed86b(0x16f)]([{'$match':{'status':'Enabled','name':_0x180077['warehouse'],'warehouse_category':_0x5ed86b(0x153)}},{'$group':{'_id':'$name','name':{'$first':_0x5ed86b(0xe7)}}}]);}else _0x1684ec=await warehouse[_0x5ed86b(0x16f)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x5ed86b(0xe7)}}}]);var _0x37da14=[_0x5ed86b(0x10c),_0x5ed86b(0x1cc),'Return\x20Rooms'];const _0x2a124e=await transfers[_0x5ed86b(0xf0)]({}),_0x10fd7b=_0x2a124e[_0x5ed86b(0x1a0)]+0x1,_0x2f7cc4=_0x5ed86b(0xfe)+_0x10fd7b[_0x5ed86b(0x168)]()[_0x5ed86b(0xfd)](0x5,'0');if(_0x117d10[0x0][_0x5ed86b(0x176)]==_0x5ed86b(0x155)){var _0x5b3db1=users[_0x5ed86b(0x15e)];console['log'](_0x5b3db1);}else{if(_0x117d10[0x0][_0x5ed86b(0x176)]=='Hindi')var _0x5b3db1=users[_0x5ed86b(0x1b5)];else{if(_0x117d10[0x0][_0x5ed86b(0x176)]=='German')var _0x5b3db1=users[_0x5ed86b(0x18b)];else{if(_0x117d10[0x0][_0x5ed86b(0x176)]==_0x5ed86b(0xf3))var _0x5b3db1=users[_0x5ed86b(0xf3)];else{if(_0x117d10[0x0][_0x5ed86b(0x176)]==_0x5ed86b(0x140))var _0x5b3db1=users[_0x5ed86b(0x140)];else{if(_0x117d10[0x0][_0x5ed86b(0x176)]=='Portuguese\x20(BR)')var _0x5b3db1=users[_0x5ed86b(0x11f)];else{if(_0x117d10[0x0][_0x5ed86b(0x176)]==_0x5ed86b(0x11e))var _0x5b3db1=users[_0x5ed86b(0x11e)];else{if(_0x117d10[0x0]['language']==_0x5ed86b(0x17c))var _0x5b3db1=users[_0x5ed86b(0x174)];}}}}}}}const _0x569878=getRandom8DigitNumber();_0x569878[_0x5ed86b(0x1bd)](_0xffd91a=>{var _0x3f544c=_0x5ed86b;_0x2cb7c9[_0x3f544c(0x1b8)](_0x3f544c(0x1a3),{'success':_0x8ca342['flash'](_0x3f544c(0x111)),'errors':_0x8ca342[_0x3f544c(0xf2)](_0x3f544c(0x1cb)),'role':_0x5dd0d1,'profile':_0x2b73cd,'master_shop':_0x117d10,'warehouse':_0x1684ec,'language':_0x5b3db1,'rooms_data':_0x37da14,'invoice':_0xffd91a});})['catch'](_0x1db112=>{var _0x381174=_0x5ed86b;_0x8ca342[_0x381174(0xf2)](_0x381174(0x1cb),_0x381174(0x13a)),_0x2cb7c9[_0x381174(0xff)](_0x381174(0x104));});}catch(_0x423dbe){console[_0x5ed86b(0x1c0)](_0x423dbe);}}),router[a0_0x50b1ff(0x18e)](a0_0x50b1ff(0x1c2),auth,async(_0x488d13,_0x2ecd7d)=>{var _0x59ac58=a0_0x50b1ff;try{console[_0x59ac58(0x1c0)](_0x488d13['body']);const {date:_0x20b213,from_warehouse:_0x17c05b,FromRoom_name:_0x367e68,to_warehouse:_0x7fb219,ToRoom_name:_0x38bed1,prod_name:_0x3a7486,from_prod_qty:_0x275e18,from_prod_level:_0xe7aed4,from_prod_isle:_0x548d40,from_prod_pallet:_0x328be5,to_prod_qty:_0x59029b,to_prod_level:_0x4715c9,to_prod_isle:_0xa68c73,to_prod_pallet:_0x5df7c8,primary_code:_0x3c0ea9,secondary_code:_0x302f1b,product_code3:_0x529147,note:_0x28dde8,MaxStocks_data2:_0x1dae70,invoice:_0x57bae5,expiry_date:_0x368d7b}=_0x488d13[_0x59ac58(0x1a1)];if(typeof _0x3a7486==_0x59ac58(0x1c8))var _0x10f455=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x15d)]],_0x4b2c58=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x124)]],_0x5c463e=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0xe9)]],_0x287470=[_0x488d13[_0x59ac58(0x1a1)]['New_Qty_Converted']],_0x3837a7=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x13f)]],_0x12d49a=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1a8)]],_0x2676dc=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1c1)]],_0x460485=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x106)]],_0xa23e80=[_0x488d13['body'][_0x59ac58(0x107)]],_0x31e398=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1ad)]],_0x42f217=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x191)]],_0x5723b8=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0xe6)]],_0x18a455=[_0x488d13['body'][_0x59ac58(0x19a)]],_0x6693c1=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0xe8)]],_0x1f9386=[_0x488d13['body'][_0x59ac58(0x102)]],_0x33f82b=[_0x488d13['body'][_0x59ac58(0xfc)]],_0x2916de=[_0x488d13['body'][_0x59ac58(0x1b2)]],_0x3461da=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1c7)]],_0x5e66d1=[_0x488d13['body']['from_invoice']],_0x529ed1=[_0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x127)]];else var _0x10f455=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x15d)]],_0x4b2c58=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x124)]],_0x5c463e=[..._0x488d13[_0x59ac58(0x1a1)]['from_prod_level']],_0x287470=[..._0x488d13[_0x59ac58(0x1a1)]['New_Qty_Converted']],_0x3837a7=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x13f)]],_0x12d49a=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1a8)]],_0x2676dc=[..._0x488d13[_0x59ac58(0x1a1)]['secondary_code']],_0x460485=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x106)]],_0xa23e80=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x107)]],_0x31e398=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1ad)]],_0x42f217=[..._0x488d13['body'][_0x59ac58(0x191)]],_0x5723b8=[..._0x488d13[_0x59ac58(0x1a1)]['batch_code']],_0x18a455=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x19a)]],_0x6693c1=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0xe8)]],_0x1f9386=[..._0x488d13['body'][_0x59ac58(0x102)]],_0x33f82b=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0xfc)]],_0x2916de=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1b2)]],_0x3461da=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1c7)]],_0x5e66d1=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x1b4)]],_0x529ed1=[..._0x488d13[_0x59ac58(0x1a1)][_0x59ac58(0x127)]];const _0x506840=_0x10f455[_0x59ac58(0x196)](_0x83110f=>{return _0x83110f={'product_name':_0x83110f};});_0x4b2c58['forEach']((_0x4b0b62,_0x265125)=>{var _0x46138c=_0x59ac58;_0x506840[_0x265125][_0x46138c(0x144)]=_0x4b0b62;}),_0x5e66d1[_0x59ac58(0x13d)]((_0x28692f,_0x387485)=>{var _0xe679c3=_0x59ac58;_0x506840[_0x387485][_0xe679c3(0x1b4)]=_0x28692f;}),_0x529ed1[_0x59ac58(0x13d)]((_0x107823,_0x58bdd5)=>{var _0x17883e=_0x59ac58;_0x506840[_0x58bdd5][_0x17883e(0xf7)]=_0x107823;}),_0x5c463e[_0x59ac58(0x13d)]((_0x505dd5,_0x428cec)=>{_0x2916de['forEach']((_0x586c76,_0x5b2246)=>{var _0xe9589c=a0_0x48cc;if(_0x586c76=='Receiving\x20Area'&&_0x428cec==_0x5b2246){var _0x1a4d01=_0x505dd5[_0xe9589c(0x10b)](0x3);_0x506840[_0x428cec][_0xe9589c(0x1b6)]=_0x505dd5[0x0],_0x506840[_0x428cec][_0xe9589c(0x173)]=_0x505dd5[0x1],_0x506840[_0x428cec][_0xe9589c(0x1a7)]=0x0,_0x506840[_0x428cec][_0xe9589c(0x14e)]=0x0,_0x506840[_0x428cec][_0xe9589c(0xfb)]='Floor',_0x506840[_0x428cec][_0xe9589c(0x103)]=_0x1a4d01;}else{if(_0x586c76=='Shelves'&&_0x428cec==_0x5b2246){var _0x1a4d01=_0x505dd5[_0xe9589c(0x10b)](0x3);_0x506840[_0x428cec][_0xe9589c(0x1b6)]=_0x505dd5[0x0],_0x506840[_0x428cec]['from_rack']=_0x505dd5[0x1],_0x506840[_0x428cec][_0xe9589c(0x1a7)]=0x0,_0x506840[_0x428cec][_0xe9589c(0x14e)]=0x0,_0x506840[_0x428cec][_0xe9589c(0xfb)]='Floor',_0x506840[_0x428cec]['from_floorlevel']=_0x505dd5[0x5];}else{if(_0x428cec==_0x5b2246){var _0x28ac50;if(_0x505dd5[0x4]=='L')_0x28ac50=_0xe9589c(0x128);else _0x505dd5[0x4]=='F'&&(_0x28ac50=_0xe9589c(0x1c9));_0x506840[_0x428cec][_0xe9589c(0x1b6)]=_0x505dd5[0x0],_0x506840[_0x428cec][_0xe9589c(0x173)]=_0x505dd5[0x1],_0x506840[_0x428cec]['from_bay']=_0x505dd5[0x2],_0x506840[_0x428cec]['from_bin']=_0x505dd5[0x3],_0x506840[_0x428cec][_0xe9589c(0xfb)]=_0x28ac50,_0x506840[_0x428cec][_0xe9589c(0x103)]=_0x505dd5[0x5];}}}});}),_0x287470[_0x59ac58(0x13d)]((_0x8bbac0,_0x3c39b3)=>{var _0x5c2d7a=_0x59ac58;_0x506840[_0x3c39b3][_0x5c2d7a(0x10f)]=_0x8bbac0;}),_0x3837a7[_0x59ac58(0x13d)]((_0x442dd3,_0x2adf75)=>{_0x3461da['forEach']((_0x25df61,_0x22990b)=>{var _0x3d9113=a0_0x48cc;if(_0x25df61==_0x3d9113(0x198)&&_0x2adf75==_0x22990b){var _0x28e061=_0x442dd3[_0x3d9113(0x10b)](0x3);_0x506840[_0x2adf75][_0x3d9113(0x113)]=_0x442dd3[0x0],_0x506840[_0x2adf75][_0x3d9113(0x129)]=_0x442dd3[0x1],_0x506840[_0x2adf75][_0x3d9113(0x12b)]=0x0,_0x506840[_0x2adf75]['to_bin']=0x0,_0x506840[_0x2adf75][_0x3d9113(0x188)]=_0x3d9113(0x1c9),_0x506840[_0x2adf75][_0x3d9113(0x179)]=_0x28e061;}else{if(_0x25df61==_0x3d9113(0x12a)&&_0x2adf75==_0x22990b){var _0x28e061=_0x442dd3[_0x3d9113(0x10b)](0x3);_0x506840[_0x2adf75]['storage']=_0x442dd3[0x0],_0x506840[_0x2adf75][_0x3d9113(0x129)]=_0x442dd3[0x1],_0x506840[_0x2adf75]['to_bay']=0x0,_0x506840[_0x2adf75][_0x3d9113(0x197)]=0x0,_0x506840[_0x2adf75][_0x3d9113(0x188)]='Floor',_0x506840[_0x2adf75][_0x3d9113(0x179)]=_0x442dd3[0x5];}else{if(_0x2adf75==_0x22990b){var _0x5a35eb;if(_0x442dd3[0x4]=='L')_0x5a35eb=_0x3d9113(0x128);else _0x442dd3[0x4]=='F'&&(_0x5a35eb=_0x3d9113(0x1c9));_0x506840[_0x2adf75][_0x3d9113(0x113)]=_0x442dd3[0x0],_0x506840[_0x2adf75][_0x3d9113(0x129)]=_0x442dd3[0x1],_0x506840[_0x2adf75][_0x3d9113(0x12b)]=_0x442dd3[0x2],_0x506840[_0x2adf75][_0x3d9113(0x197)]=_0x442dd3[0x3],_0x506840[_0x2adf75][_0x3d9113(0x188)]=_0x5a35eb,_0x506840[_0x2adf75][_0x3d9113(0x179)]=_0x442dd3[0x5];}}}});}),_0x12d49a['forEach']((_0x5a4f05,_0x3a20fa)=>{var _0x5d2b0a=_0x59ac58;_0x506840[_0x3a20fa][_0x5d2b0a(0x1a8)]=_0x5a4f05;}),_0x2676dc[_0x59ac58(0x13d)]((_0x57a0d3,_0x16d90d)=>{var _0x421735=_0x59ac58;_0x506840[_0x16d90d][_0x421735(0x1c1)]=_0x57a0d3;}),_0x460485[_0x59ac58(0x13d)]((_0x620436,_0x4fd40b)=>{_0x506840[_0x4fd40b]['product_code']=_0x620436;}),_0xa23e80[_0x59ac58(0x13d)]((_0xb55b3b,_0x2ebdb2)=>{var _0xa258c4=_0x59ac58;_0x506840[_0x2ebdb2][_0xa258c4(0x193)]=_0xb55b3b;}),_0x31e398['forEach']((_0x9bb547,_0x3bb19d)=>{var _0x4071be=_0x59ac58;_0x506840[_0x3bb19d][_0x4071be(0x17b)]=_0x9bb547;}),_0x42f217[_0x59ac58(0x13d)]((_0x335fb4,_0x33d78e)=>{_0x506840[_0x33d78e]['secondary_unit']=_0x335fb4;}),_0x5723b8[_0x59ac58(0x13d)]((_0x258a2d,_0x38c186)=>{_0x506840[_0x38c186]['batch_code']=_0x258a2d;}),_0x18a455['forEach']((_0x69f964,_0x21ffb5)=>{var _0x42357f=_0x59ac58;_0x506840[_0x21ffb5][_0x42357f(0x19a)]=_0x69f964;}),_0x6693c1[_0x59ac58(0x13d)]((_0xb64eab,_0x5194cc)=>{var _0x9260d5=_0x59ac58;_0x506840[_0x5194cc][_0x9260d5(0x11c)]=_0xb64eab;}),_0x1f9386[_0x59ac58(0x13d)]((_0x1facf4,_0xe5e5d1)=>{var _0x27d9b7=_0x59ac58;_0x506840[_0xe5e5d1][_0x27d9b7(0x102)]=_0x1facf4;}),_0x33f82b['forEach']((_0x2fb038,_0x1e30bd)=>{_0x506840[_0x1e30bd]['prod_cat']=_0x2fb038;}),_0x2916de[_0x59ac58(0x13d)]((_0x13de90,_0x2fdda0)=>{var _0x3ef2ff=_0x59ac58;_0x506840[_0x2fdda0][_0x3ef2ff(0xe0)]=_0x13de90;}),_0x3461da[_0x59ac58(0x13d)]((_0x55c3c5,_0x4322f9)=>{_0x506840[_0x4322f9]['to_room_name']=_0x55c3c5;});const _0x41c39f=_0x506840[_0x59ac58(0x122)](_0x430995=>_0x430995[_0x59ac58(0x10f)]!=='0'&&_0x430995['to_quantity']!==''||_0x430995['to_floorlevel']!=='0'&&_0x430995[_0x59ac58(0x179)]!==''),_0x5c99e0=new transfers({'date':_0x20b213,'from_warehouse':_0x17c05b,'to_warehouse':_0x7fb219,'product':_0x41c39f,'note':_0x28dde8,'invoice':_0x57bae5}),_0x47c4f4=await _0x5c99e0['save']();_0x488d13[_0x59ac58(0xf2)](_0x59ac58(0x111),_0x59ac58(0x195)),_0x2ecd7d[_0x59ac58(0xff)]('/transfer/preview/'+_0x47c4f4[_0x59ac58(0x165)]);}catch(_0x3971e9){console['log'](_0x3971e9),_0x2ecd7d['status'](0xc8)[_0x59ac58(0x12c)]({'errorMessage':_0x3971e9[_0x59ac58(0x11a)]});}}),router[a0_0x50b1ff(0x15c)](a0_0x50b1ff(0x19e),auth,async(_0x24a6ba,_0x3f63d9)=>{var _0x5754bd=a0_0x50b1ff;try{const {username:_0x74c265,email:_0x10d5d1,role:_0x1bcfce}=_0x24a6ba[_0x5754bd(0x16d)],_0x5287f3=_0x24a6ba[_0x5754bd(0x16d)],_0x1e8f65=await profile['findOne']({'email':_0x5287f3[_0x5754bd(0x15b)]}),_0x57b263=await master_shop[_0x5754bd(0xf0)]();console[_0x5754bd(0x1c0)](_0x5754bd(0x137),_0x57b263);const _0x165331=await transfers[_0x5754bd(0x180)](_0x24a6ba[_0x5754bd(0x119)]['id']);let _0x2d2c84=new Date(_0x165331[_0x5754bd(0x19a)]),_0x320ebb=('0'+_0x2d2c84[_0x5754bd(0x12e)]())[_0x5754bd(0x10b)](-0x2),_0x1c1aad=('0'+(_0x2d2c84['getMonth']()+0x1))[_0x5754bd(0x10b)](-0x2),_0x1bd47a=_0x2d2c84[_0x5754bd(0xef)](),_0x2caaf0=_0x1bd47a+'-'+_0x1c1aad+'-'+_0x320ebb,_0x4ac3e4;if(_0x5287f3[_0x5754bd(0x163)]==_0x5754bd(0x167)){const _0x7f574=await staff['findOne']({'email':_0x5287f3['email']});_0x4ac3e4=await warehouse['find']({'status':_0x5754bd(0x1be),'name':_0x7f574[_0x5754bd(0x133)],'warehouse_category':'Raw\x20Materials'});}else _0x4ac3e4=await warehouse['find']({'status':_0x5754bd(0x1be),'warehouse_category':_0x5754bd(0x153)});const _0x3997d4=await warehouse[_0x5754bd(0x16f)]([{'$match':{'name':_0x165331[_0x5754bd(0x118)]}},{'$unwind':_0x5754bd(0x17d)},{'$group':{'_id':_0x5754bd(0x15f),'name':{'$first':_0x5754bd(0x19f)},'product_stock':{'$first':_0x5754bd(0x1ae)},'bay':{'$first':_0x5754bd(0x19b)},'bin':{'$first':_0x5754bd(0x1c6)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5754bd(0x13b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5754bd(0x189)},'product_code':{'$first':_0x5754bd(0x160)},'storage':{'$first':_0x5754bd(0x192)},'rack':{'$first':_0x5754bd(0x121)},'expiry_date':{'$first':_0x5754bd(0x109)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x5754bd(0x134)}}}]);if(_0x57b263[0x0]['language']==_0x5754bd(0x155)){var _0x170dbe=users[_0x5754bd(0x15e)];console[_0x5754bd(0x1c0)](_0x170dbe);}else{if(_0x57b263[0x0][_0x5754bd(0x176)]==_0x5754bd(0x1b5))var _0x170dbe=users['Hindi'];else{if(_0x57b263[0x0]['language']=='German')var _0x170dbe=users['German'];else{if(_0x57b263[0x0][_0x5754bd(0x176)]==_0x5754bd(0xf3))var _0x170dbe=users[_0x5754bd(0xf3)];else{if(_0x57b263[0x0][_0x5754bd(0x176)]==_0x5754bd(0x140))var _0x170dbe=users[_0x5754bd(0x140)];else{if(_0x57b263[0x0][_0x5754bd(0x176)]=='Portuguese\x20(BR)')var _0x170dbe=users['Portuguese'];else{if(_0x57b263[0x0]['language']==_0x5754bd(0x11e))var _0x170dbe=users[_0x5754bd(0x11e)];else{if(_0x57b263[0x0][_0x5754bd(0x176)]==_0x5754bd(0x17c))var _0x170dbe=users['Arabic'];}}}}}}}_0x3f63d9[_0x5754bd(0x1b8)]('edit_transfer_view',{'success':_0x24a6ba[_0x5754bd(0xf2)](_0x5754bd(0x111)),'errors':_0x24a6ba['flash'](_0x5754bd(0x1cb)),'role':_0x5287f3,'profile':_0x1e8f65,'master_shop':_0x57b263,'warehouse':_0x4ac3e4,'transfer':_0x165331,'stock':_0x3997d4,'language':_0x170dbe});}catch(_0x1258d4){console[_0x5754bd(0x1c0)](_0x1258d4);}}),router[a0_0x50b1ff(0x18e)](a0_0x50b1ff(0x19e),auth,async(_0x20f15c,_0x141fb9)=>{var _0xa9cd49=a0_0x50b1ff;try{const _0xcb43b1=_0x20f15c[_0xa9cd49(0x119)]['id'],{from_warehouse:_0x2b0a73,FromRoom_name:_0x1aa942,to_warehouse:_0x4ece7f,ToRoom_name:_0x5909b7}=_0x20f15c['body'],_0x1440f2=await transfers[_0xa9cd49(0x180)]({'_id':_0xcb43b1}),_0x2e33ff=_0x1440f2[_0xa9cd49(0x1bf)][_0xa9cd49(0x196)](async _0x575637=>{var _0x8adee4=_0xa9cd49;if(_0x575637['to_quantity']>0x0){var _0x43a86e=await warehouse[_0x8adee4(0x1ba)]({'name':_0x1440f2['from_warehouse'],'room':_0x575637[_0x8adee4(0xe0)],'warehouse_category':'Raw\x20Materials'});const _0x2f109f=_0x43a86e[_0x8adee4(0xed)][_0x8adee4(0x196)](_0xa79d92=>{var _0x3f019f=_0x8adee4;_0xa79d92['product_name']==_0x575637['product_name']&&_0xa79d92[_0x3f019f(0x16e)]==_0x575637[_0x3f019f(0x103)]&&_0xa79d92[_0x3f019f(0x182)]==_0x575637[_0x3f019f(0xfb)]&&_0xa79d92[_0x3f019f(0x149)]==_0x575637[_0x3f019f(0x14e)]&&_0xa79d92[_0x3f019f(0x14f)]==_0x575637[_0x3f019f(0x1a7)]&&_0xa79d92[_0x3f019f(0x129)]==_0x575637['from_rack']&&_0xa79d92[_0x3f019f(0x113)]==_0x575637['from_storage']&&_0xa79d92['expiry_date']==_0x575637[_0x3f019f(0x19a)]&&_0xa79d92['batch_code']==_0x575637[_0x3f019f(0xe6)]&&_0xa79d92['production_date']==_0x575637[_0x3f019f(0x102)]&&_0xa79d92[_0x3f019f(0x18d)]==_0x575637['from_invoice']&&(_0xa79d92[_0x3f019f(0x117)]=_0xa79d92[_0x3f019f(0x117)]-_0x575637[_0x3f019f(0x10f)]);});}return _0x43a86e;});Promise[_0xa9cd49(0x158)](_0x2e33ff)[_0xa9cd49(0x1bd)](async _0x2181d8=>{var _0x4a189b=_0xa9cd49;try{for(const _0x121a69 of _0x2181d8){await _0x121a69[_0x4a189b(0x100)]();}try{const _0x4862da=_0x1440f2[_0x4a189b(0x1bf)][_0x4a189b(0x196)](async _0xc93cf5=>{var _0x58c45b=_0x4a189b;if(_0xc93cf5[_0x58c45b(0x10f)]>0x0){var _0x5761ef=await warehouse[_0x58c45b(0x1ba)]({'name':_0x1440f2[_0x58c45b(0xe1)],'room':_0xc93cf5[_0x58c45b(0x199)],'warehouse_category':'Raw\x20Materials'}),_0x3fabd5=0x0;const _0x309efc=_0x5761ef[_0x58c45b(0xed)][_0x58c45b(0x196)](_0x1c62ab=>{var _0x862cb9=_0x58c45b;_0x1c62ab[_0x862cb9(0x194)]==_0xc93cf5['product_name']&&_0x1c62ab[_0x862cb9(0x16e)]==_0xc93cf5[_0x862cb9(0x179)]&&_0x1c62ab['type']==_0xc93cf5[_0x862cb9(0x188)]&&_0x1c62ab[_0x862cb9(0x149)]==_0xc93cf5[_0x862cb9(0x197)]&&_0x1c62ab['bay']==_0xc93cf5[_0x862cb9(0x12b)]&&_0x1c62ab[_0x862cb9(0x129)]==_0xc93cf5[_0x862cb9(0x129)]&&_0x1c62ab[_0x862cb9(0x113)]==_0xc93cf5['storage']&&_0x1c62ab[_0x862cb9(0x19a)]==_0xc93cf5['expiry_date']&&_0x1c62ab[_0x862cb9(0xe6)]==_0xc93cf5[_0x862cb9(0xe6)]&&_0x1c62ab[_0x862cb9(0x102)]==_0xc93cf5['production_date']&&_0x1c62ab[_0x862cb9(0x18d)]==_0xc93cf5['To_invoice']&&(_0x1c62ab[_0x862cb9(0x117)]=_0x1c62ab['product_stock']+_0xc93cf5[_0x862cb9(0x10f)],_0x3fabd5++);});_0x3fabd5=='0'&&(_0x5761ef['product_details']=_0x5761ef[_0x58c45b(0xed)]['concat']({'product_name':_0xc93cf5[_0x58c45b(0x194)],'product_stock':_0xc93cf5[_0x58c45b(0x10f)],'bay':_0xc93cf5[_0x58c45b(0x12b)],'bin':_0xc93cf5['to_bin'],'type':_0xc93cf5[_0x58c45b(0x188)],'floorlevel':_0xc93cf5[_0x58c45b(0x179)],'storage':_0xc93cf5[_0x58c45b(0x113)],'rack':_0xc93cf5[_0x58c45b(0x129)],'product_code':_0xc93cf5[_0x58c45b(0x139)],'primary_code':_0xc93cf5[_0x58c45b(0x1a8)],'secondary_code':_0xc93cf5[_0x58c45b(0x1c1)],'maxProducts':_0xc93cf5[_0x58c45b(0x193)],'storage':_0xc93cf5[_0x58c45b(0x113)],'rack':_0xc93cf5[_0x58c45b(0x129)],'expiry_date':_0xc93cf5['expiry_date'],'maxPerUnit':_0xc93cf5[_0x58c45b(0x11c)],'batch_code':_0xc93cf5[_0x58c45b(0xe6)],'production_date':_0xc93cf5[_0x58c45b(0x102)]}));}return _0x5761ef;});Promise[_0x4a189b(0x158)](_0x4862da)[_0x4a189b(0x1bd)](async _0x35cae5=>{var _0x208448=_0x4a189b;try{for(const _0x7e8ed3 of _0x35cae5){await warehouse[_0x208448(0x19c)]({'_id':_0x7e8ed3[_0x208448(0x165)]},{'$addToSet':{'product_details':{'$each':_0x7e8ed3[_0x208448(0xed)]}}});}_0x1440f2['finalize']=_0x208448(0x19d);const _0x19040f=await _0x1440f2[_0x208448(0x100)](),_0x454459=await master_shop[_0x208448(0xf0)](),_0x30c4ea=await email_settings[_0x208448(0x1ba)](),_0xdfa0d3=await supervisor_settings[_0x208448(0xf0)]();var _0x29d59b=_0x1440f2[_0x208448(0x1bf)],_0x4281d8='',_0x20a4ae;for(_0x20a4ae in _0x29d59b){_0x4281d8+=_0x208448(0x17a)+_0x208448(0x1ab)+_0x29d59b[_0x20a4ae][_0x208448(0x194)]+'</td>'+_0x208448(0x1ab)+_0x29d59b[_0x20a4ae][_0x208448(0x139)]+_0x208448(0x16c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x29d59b[_0x20a4ae][_0x208448(0x10f)]+_0x208448(0x16c)+_0x208448(0x1ab)+_0x29d59b[_0x20a4ae][_0x208448(0x17b)]+_0x208448(0x16c)+_0x208448(0x1ab)+_0x29d59b[_0x20a4ae]['secondary_unit']+_0x208448(0x16c)+_0x208448(0x1ab)+_0x1440f2[_0x208448(0xe1)]+_0x208448(0x16c)+_0x208448(0x1ab)+_0x29d59b[_0x20a4ae]['to_room_name']+_0x208448(0x16c)+_0x208448(0x1ab)+_0x29d59b[_0x20a4ae]['storage']+_0x29d59b[_0x20a4ae][_0x208448(0x129)]+_0x29d59b[_0x20a4ae]['to_bay']+_0x29d59b[_0x20a4ae][_0x208448(0x197)]+_0x29d59b[_0x20a4ae][_0x208448(0x188)][0x0]+_0x29d59b[_0x20a4ae][_0x208448(0x179)]+_0x208448(0x16c),_0x208448(0x170);}let _0x8777fb=nodemailer[_0x208448(0x1bc)]({'host':_0x30c4ea['host'],'port':Number(_0x30c4ea[_0x208448(0x1b3)]),'secure':![],'auth':{'user':_0x30c4ea[_0x208448(0x15b)],'pass':_0x30c4ea[_0x208448(0x1a6)]}}),_0x6e0880={'from':_0x30c4ea['email'],'to':_0xdfa0d3[0x0][_0x208448(0xe3)],'subject':_0x208448(0x18c),'attachments':[{'filename':_0x208448(0x18f),'path':__dirname+'/../public'+'/upload/'+_0x454459[0x0][_0x208448(0xe5)],'cid':_0x208448(0x166)}],'html':'<!DOCTYPE\x20html>'+_0x208448(0x143)+_0x208448(0x11d)+_0x208448(0x10a)+_0x208448(0x112)+_0x208448(0x10a)+_0x208448(0x157)+_0x208448(0xf8)+_0x208448(0x10a)+_0x208448(0x175)+_0x454459[0x0][_0x208448(0x1b7)]+'\x20</h2>'+'</div>'+_0x208448(0xf8)+_0x208448(0x14a)+_0x208448(0x10a)+_0x208448(0xec)+_0x208448(0xf4)+_0x1440f2['invoice']+'\x20'+_0x208448(0x132)+_0x208448(0x1ac)+_0x1440f2['date']+'\x20'+'</span>'+_0x208448(0x101)+_0x208448(0xf8)+_0x208448(0x164)+_0x208448(0xe4)+_0x208448(0x17a)+_0x208448(0x1c4)+_0x208448(0x1b0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x208448(0x16b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x208448(0xf1)+_0x208448(0x108)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+_0x208448(0x135)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4281d8+'\x20'+_0x208448(0x159)+_0x208448(0xfa)+_0x208448(0x10a)+_0x208448(0x14d)+_0x208448(0x17e)+_0x454459[0x0][_0x208448(0x1b7)]+_0x208448(0x101)+'</div>'+_0x208448(0xf8)+'</body></html>'};_0x8777fb[_0x208448(0x10d)](_0x6e0880,function(_0x3661f,_0x17fc97){var _0x3625ca=_0x208448;_0x3661f?(console['log'](_0x3661f),console[_0x3625ca(0x1c0)]('Error\x20Occurs')):console['log'](_0x3625ca(0xee));}),_0x20f15c['flash']('success',_0x208448(0x17f)),_0x141fb9[_0x208448(0xff)](_0x208448(0xf9)+_0x19040f['_id']);}catch(_0x2979ae){console[_0x208448(0x150)](_0x2979ae),_0x141fb9[_0x208448(0x1c3)](0x1f4)['json']({'Perror':_0x208448(0x1a4),'message':_0x2979ae['message']});}})['catch'](_0x32186f=>{var _0x1cf441=_0x4a189b;console[_0x1cf441(0x150)](_0x32186f),_0x141fb9['status'](0x1f4)[_0x1cf441(0x12c)]({'Perror':_0x1cf441(0x1a9)});});}catch(_0x23d62c){_0x141fb9[_0x4a189b(0x12c)](_0x23d62c);}}catch(_0x3c936d){console['error'](_0x3c936d),_0x141fb9[_0x4a189b(0x1c3)](0x1f4)[_0x4a189b(0x12c)]({'Merror':_0x4a189b(0x1a4),'Message':_0x3c936d[_0x4a189b(0x11a)]});}})[_0xa9cd49(0x138)](_0x56596e=>{var _0x4c939b=_0xa9cd49;console[_0x4c939b(0x150)](_0x56596e),_0x141fb9['status'](0x1f4)[_0x4c939b(0x12c)]({'Merror':_0x4c939b(0x1a9)});});}catch(_0x132c02){console[_0xa9cd49(0x1c0)](_0x132c02);}});function BayBinSelected(_0x443138,_0x65770e){var _0x6a2884=a0_0x50b1ff,_0x5098ae=[],_0x48732c=[],_0x42c74f=[],_0x27eba5=[],_0x4f921c=[],_0x85f812=[];let _0x10ea8d=[];if(_0x443138==_0x6a2884(0x120))switch(_0x65770e){case _0x6a2884(0x178):_0x5098ae=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x48732c=[0x1,0x2],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=[_0x6a2884(0x128),_0x6a2884(0x1c9)],_0x4f921c=['D'],_0x85f812=['A'];break;case _0x6a2884(0x125):_0x5098ae=[0x6,0x5,0x4,0x3,0x2,0x1],_0x48732c=[0x1,0x2],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=[_0x6a2884(0x128),_0x6a2884(0x1c9)],_0x4f921c=['D'],_0x85f812=['B'];break;case'Shelves':_0x5098ae=[0x0],_0x48732c=[0x0],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=[_0x6a2884(0x1c9)],_0x4f921c=['D'],_0x85f812=['S'];break;case _0x6a2884(0x198):_0x5098ae=[0x0],_0x48732c=[0x0],_0x27eba5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x42c74f=[_0x6a2884(0x1c9)],_0x4f921c=['D'],_0x85f812=['R'];break;}else{if(_0x443138==_0x6a2884(0x130))switch(_0x65770e){case _0x6a2884(0x178):_0x5098ae=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x48732c=['B','F'],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=[_0x6a2884(0x128),'Floor'],_0x4f921c=['C'],_0x85f812=['A'];break;case'Rack\x20B':_0x5098ae=[0x5,0x4,0x3,0x2,0x1],_0x48732c=['F','B','S'],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=[_0x6a2884(0x128),_0x6a2884(0x1c9)],_0x4f921c=['C'],_0x85f812=['B'];break;case _0x6a2884(0x172):_0x5098ae=[0x1,0x2,0x3,0x4,0x5],_0x48732c=['B','F','S'],_0x27eba5=[0x5,0x4,0x3,0x2,0x1],_0x42c74f=[_0x6a2884(0x128),_0x6a2884(0x1c9)],_0x4f921c=['C'],_0x85f812=['C'];break;case _0x6a2884(0x110):_0x5098ae=[0x5,0x4,0x3,0x2,0x1],_0x48732c=['F','B','S'],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=[_0x6a2884(0x128),_0x6a2884(0x1c9)],_0x4f921c=['C'],_0x85f812=['D'];break;case'Rack\x20E':_0x5098ae=[0x4,0x3,0x2,0x1],_0x48732c=[0x1,0x2],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=['Level',_0x6a2884(0x1c9)],_0x4f921c=['C'],_0x85f812=['E'];break;case _0x6a2884(0x12d):_0x5098ae=[0x1,0x2,0x3],_0x48732c=[0x1,0x2],_0x27eba5=[0x1,0x2,0x3,0x4,0x5],_0x42c74f=['Level'],_0x4f921c=['C'],_0x85f812=['F'];break;}}return{'levels':_0x5098ae,'Isle':_0x48732c,'rack':_0x27eba5,'type':_0x42c74f,'storage':_0x4f921c,'rak':_0x85f812};}router[a0_0x50b1ff(0x15c)](a0_0x50b1ff(0xea),auth,async(_0x4c3580,_0x56ca61)=>{var _0xb6b867=a0_0x50b1ff;try{const {username:_0x15eb03,email:_0x16e12c,role:_0x38531b}=_0x4c3580[_0xb6b867(0x16d)],_0xdf9db5=_0x4c3580[_0xb6b867(0x16d)],_0x179cc2=await profile[_0xb6b867(0x1ba)]({'email':_0xdf9db5[_0xb6b867(0x15b)]}),_0x33b367=await master_shop[_0xb6b867(0xf0)](),_0x335b94=await transfers[_0xb6b867(0x180)](_0x4c3580['params']['id']);let _0x16a86d;if(_0xdf9db5['role']==_0xb6b867(0x167)){const _0x7eec79=await staff[_0xb6b867(0x1ba)]({'email':_0xdf9db5[_0xb6b867(0x15b)]});_0x16a86d=await warehouse[_0xb6b867(0x16f)]([{'$match':{'status':_0xb6b867(0x1be),'name':_0x7eec79[_0xb6b867(0x133)],'warehouse_category':_0xb6b867(0x153)}},{'$group':{'_id':_0xb6b867(0xe7),'name':{'$first':_0xb6b867(0xe7)}}}]);}else _0x16a86d=await warehouse[_0xb6b867(0x16f)]([{'$match':{'status':_0xb6b867(0x1be),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0xb6b867(0xe7)}}}]);const _0x2d5139=await warehouse[_0xb6b867(0x16f)]([{'$match':{'name':_0x335b94[_0xb6b867(0x118)],'warehouse_category':_0xb6b867(0x153)}},{'$unwind':_0xb6b867(0x17d)},{'$group':{'_id':_0xb6b867(0x15f),'name':{'$first':_0xb6b867(0x19f)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xb6b867(0x19b)},'bin':{'$first':_0xb6b867(0x1c6)},'type':{'$first':_0xb6b867(0x1c5)},'floorlevel':{'$first':_0xb6b867(0x13b)},'primary_code':{'$first':_0xb6b867(0x1a2)},'secondary_code':{'$first':_0xb6b867(0x189)},'product_code':{'$first':_0xb6b867(0x160)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xb6b867(0x121)},'expiry_date':{'$first':_0xb6b867(0x109)},'production_date':{'$first':_0xb6b867(0x148)},'room':{'$first':_0xb6b867(0x134)}}}]),_0x38aae3=await product['find']({}),_0x206012=BayBinSelected(_0x335b94['to_warehouse'],_0x335b94['to_room']);if(_0x33b367[0x0][_0xb6b867(0x176)]==_0xb6b867(0x155)){var _0xfa56a2=users[_0xb6b867(0x15e)];console[_0xb6b867(0x1c0)](_0xfa56a2);}else{if(_0x33b367[0x0]['language']==_0xb6b867(0x1b5))var _0xfa56a2=users[_0xb6b867(0x1b5)];else{if(_0x33b367[0x0][_0xb6b867(0x176)]==_0xb6b867(0x18b))var _0xfa56a2=users['German'];else{if(_0x33b367[0x0]['language']==_0xb6b867(0xf3))var _0xfa56a2=users[_0xb6b867(0xf3)];else{if(_0x33b367[0x0]['language']==_0xb6b867(0x140))var _0xfa56a2=users['French'];else{if(_0x33b367[0x0]['language']==_0xb6b867(0xeb))var _0xfa56a2=users[_0xb6b867(0x11f)];else{if(_0x33b367[0x0][_0xb6b867(0x176)]==_0xb6b867(0x11e))var _0xfa56a2=users[_0xb6b867(0x11e)];else{if(_0x33b367[0x0]['language']=='Arabic\x20(ae)')var _0xfa56a2=users['Arabic'];}}}}}}}_0x56ca61['render'](_0xb6b867(0x10e),{'success':_0x4c3580[_0xb6b867(0xf2)](_0xb6b867(0x111)),'errors':_0x4c3580[_0xb6b867(0xf2)]('errors'),'role':_0xdf9db5,'profile':_0x179cc2,'master_shop':_0x33b367,'warehouse':_0x16a86d,'transfer':_0x335b94,'stock':_0x2d5139,'unit':_0x38aae3,'language':_0xfa56a2});}catch(_0x4832be){console[_0xb6b867(0x1c0)](_0x4832be);}}),router[a0_0x50b1ff(0x18e)](a0_0x50b1ff(0xea),auth,async(_0x2d20fa,_0x42271c)=>{var _0x47c0ec=a0_0x50b1ff;try{const _0x17d1a0=_0x2d20fa[_0x47c0ec(0x119)]['id'],_0x29fa9f=await transfers['findById'](_0x17d1a0);_0x42271c['json'](_0x2d20fa[_0x47c0ec(0x1a1)]);return;const {date:_0x19566c,from_warehouse:_0x23ef95,FromRoom_name:_0xda7e00,to_warehouse:_0x56a98e,ToRoom_name:_0x11219d,prod_name:_0x30351c,from_prod_qty:_0x4c051b,from_prod_level:_0x48665b,from_prod_isle:_0x4aa114,from_prod_pallet:_0x40b2e3,to_prod_qty:_0x33f8ba,to_prod_level:_0x470d8b,to_prod_isle:_0x546d6f,to_prod_pallet:_0x222803,primary_code:_0x295be4,secondary_code:_0x4c2d64,product_code3:_0x2e7aa7,note:_0x21b9db,invoice:_0x52644a,expiry_date:_0x5200de}=_0x2d20fa[_0x47c0ec(0x1a1)];if(typeof _0x30351c==_0x47c0ec(0x1c8))var _0x47690d=[_0x2d20fa[_0x47c0ec(0x1a1)]['prod_name']],_0x31686f=[_0x2d20fa[_0x47c0ec(0x1a1)]['from_prod_qty']],_0x512303=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0xe9)]],_0x3d6aa4=[_0x2d20fa['body'][_0x47c0ec(0x1aa)]],_0xa6b53f=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x156)]],_0x4bff3d=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0xfb)]],_0x49e0b8=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x116)]],_0x211493=[_0x2d20fa['body'][_0x47c0ec(0x13f)]],_0x14f1a5=[_0x2d20fa['body'][_0x47c0ec(0x16a)]],_0x525f50=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1ca)]],_0x10fba0=[_0x2d20fa['body'][_0x47c0ec(0x188)]],_0x2d78c6=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x113)]],_0x359e5a=[_0x2d20fa[_0x47c0ec(0x1a1)]['rak']],_0x5d2e62=[_0x2d20fa['body']['primary_code']],_0x3f0b26=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1c1)]],_0x56067f=[_0x2d20fa['body'][_0x47c0ec(0x106)]],_0x58de20=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x107)]],_0x1c13e4=[_0x2d20fa[_0x47c0ec(0x1a1)]['unit']],_0x194975=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x191)]],_0x4a1807=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0xe6)]],_0x4eed33=[_0x2d20fa['body'][_0x47c0ec(0x19a)]],_0x2a1135=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1b6)]],_0x25f054=[_0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1bb)]];else var _0x47690d=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x15d)]],_0x2d78c6=[..._0x2d20fa[_0x47c0ec(0x1a1)]['storage']],_0x359e5a=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x186)]],_0x4bff3d=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0xfb)]],_0x10fba0=[..._0x2d20fa[_0x47c0ec(0x1a1)]['to_types']],_0x31686f=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x124)]],_0x512303=[..._0x2d20fa['body'][_0x47c0ec(0xe9)]],_0x3d6aa4=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1aa)]],_0xa6b53f=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x156)]],_0x49e0b8=[..._0x2d20fa[_0x47c0ec(0x1a1)]['to_prod_qty']],_0x211493=[..._0x2d20fa['body'][_0x47c0ec(0x13f)]],_0x14f1a5=[..._0x2d20fa[_0x47c0ec(0x1a1)]['to_prod_isle']],_0x525f50=[..._0x2d20fa['body'][_0x47c0ec(0x1ca)]],_0x5d2e62=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1a8)]],_0x3f0b26=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1c1)]],_0x56067f=[..._0x2d20fa[_0x47c0ec(0x1a1)]['product_code3']],_0x58de20=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x107)]],_0x1c13e4=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x17b)]],_0x194975=[..._0x2d20fa[_0x47c0ec(0x1a1)]['secondary_unit']],_0x4a1807=[..._0x2d20fa['body'][_0x47c0ec(0xe6)]],_0x4eed33=[..._0x2d20fa[_0x47c0ec(0x1a1)]['expiry_date']],_0x2a1135=[..._0x2d20fa['body'][_0x47c0ec(0x1b6)]],_0x25f054=[..._0x2d20fa[_0x47c0ec(0x1a1)][_0x47c0ec(0x1bb)]];const _0x5659ff=_0x47690d[_0x47c0ec(0x196)](_0x3b4af8=>{return _0x3b4af8={'product_name':_0x3b4af8};});_0x31686f[_0x47c0ec(0x13d)]((_0x11f313,_0x22274e)=>{var _0x4898d0=_0x47c0ec;_0x5659ff[_0x22274e][_0x4898d0(0x144)]=_0x11f313;}),_0x512303['forEach']((_0x209a08,_0x5f282d)=>{var _0x2c3d8d=_0x47c0ec;_0x5659ff[_0x5f282d][_0x2c3d8d(0x1a7)]=_0x209a08;}),_0x3d6aa4['forEach']((_0x33d31b,_0x49b558)=>{_0x5659ff[_0x49b558]['from_bin']=_0x33d31b;}),_0xa6b53f[_0x47c0ec(0x13d)]((_0x53d58b,_0x4e5129)=>{var _0x22b394=_0x47c0ec;_0x5659ff[_0x4e5129][_0x22b394(0x103)]=_0x53d58b;}),_0x49e0b8[_0x47c0ec(0x13d)]((_0xbaf4c0,_0x4faf55)=>{var _0xf2972b=_0x47c0ec;_0x5659ff[_0x4faf55][_0xf2972b(0x10f)]=_0xbaf4c0;}),_0x211493[_0x47c0ec(0x13d)]((_0x55ed35,_0x281998)=>{_0x5659ff[_0x281998]['to_bay']=_0x55ed35;}),_0x14f1a5[_0x47c0ec(0x13d)]((_0x42e9ab,_0x76656c)=>{_0x5659ff[_0x76656c]['to_bin']=_0x42e9ab;}),_0x525f50[_0x47c0ec(0x13d)]((_0x4f2f41,_0x5f2e26)=>{var _0x5c92ec=_0x47c0ec;_0x5659ff[_0x5f2e26][_0x5c92ec(0x179)]=_0x4f2f41;}),_0x5d2e62['forEach']((_0x3c147a,_0x9a58e4)=>{var _0x2a8979=_0x47c0ec;_0x5659ff[_0x9a58e4][_0x2a8979(0x1a8)]=_0x3c147a;}),_0x3f0b26[_0x47c0ec(0x13d)]((_0xf93bbd,_0x489acf)=>{var _0x3b0e5c=_0x47c0ec;_0x5659ff[_0x489acf][_0x3b0e5c(0x1c1)]=_0xf93bbd;}),_0x56067f['forEach']((_0x1b5310,_0x32d94b)=>{var _0x8d5a05=_0x47c0ec;_0x5659ff[_0x32d94b][_0x8d5a05(0x139)]=_0x1b5310;}),_0x58de20[_0x47c0ec(0x13d)]((_0x4e8078,_0x48d910)=>{var _0x36bd3e=_0x47c0ec;_0x5659ff[_0x48d910][_0x36bd3e(0x193)]=_0x4e8078;}),_0x1c13e4['forEach']((_0x2c1523,_0x1c4893)=>{_0x5659ff[_0x1c4893]['unit']=_0x2c1523;}),_0x194975[_0x47c0ec(0x13d)]((_0xdb95aa,_0x3bca80)=>{var _0x56087e=_0x47c0ec;_0x5659ff[_0x3bca80][_0x56087e(0x191)]=_0xdb95aa;}),_0x4a1807[_0x47c0ec(0x13d)]((_0x5c0968,_0x434b23)=>{var _0x2021c1=_0x47c0ec;_0x5659ff[_0x434b23][_0x2021c1(0xe6)]=_0x5c0968;}),_0x4eed33[_0x47c0ec(0x13d)]((_0x274d5f,_0x311d8a)=>{var _0x429ea7=_0x47c0ec;_0x5659ff[_0x311d8a][_0x429ea7(0x19a)]=_0x274d5f;}),_0x2d78c6['forEach']((_0x5a7faf,_0x5db99b)=>{var _0x1d0263=_0x47c0ec;_0x5659ff[_0x5db99b][_0x1d0263(0x113)]=_0x5a7faf;}),_0x359e5a[_0x47c0ec(0x13d)]((_0x4c4f3e,_0xa97509)=>{var _0xa9d6c9=_0x47c0ec;_0x5659ff[_0xa97509][_0xa9d6c9(0x129)]=_0x4c4f3e;}),_0x4bff3d[_0x47c0ec(0x13d)]((_0x2b47c2,_0x48f2a1)=>{_0x5659ff[_0x48f2a1]['from_types']=_0x2b47c2;}),_0x10fba0[_0x47c0ec(0x13d)]((_0x4b1bd6,_0x10cdf6)=>{var _0x1d9002=_0x47c0ec;_0x5659ff[_0x10cdf6][_0x1d9002(0x188)]=_0x4b1bd6;}),_0x2a1135['forEach']((_0x5e64b1,_0x338781)=>{var _0x3c8be1=_0x47c0ec;_0x5659ff[_0x338781][_0x3c8be1(0x1b6)]=_0x5e64b1;}),_0x25f054['forEach']((_0x58104a,_0x17d5cc)=>{_0x5659ff[_0x17d5cc]['from_rack']=_0x58104a;});const _0x38dea4=_0x5659ff[_0x47c0ec(0x122)](_0xc21ba7=>_0xc21ba7['to_quantity']!=='0'&&_0xc21ba7[_0x47c0ec(0x10f)]!==''||_0xc21ba7[_0x47c0ec(0x179)]!=='0'&&_0xc21ba7[_0x47c0ec(0x179)]!=='');var _0x5d7644=0x0;_0x38dea4[_0x47c0ec(0x13d)](_0x444267=>{var _0x795717=_0x47c0ec;parseInt(_0x444267['from_quantity'])<parseInt(_0x444267[_0x795717(0x10f)])&&_0x5d7644++;});if(_0x5d7644!=0x0)return _0x2d20fa[_0x47c0ec(0xf2)]('errors',_0x47c0ec(0x177)),_0x42271c['redirect']('back');const _0x5ba46d=await warehouse[_0x47c0ec(0x1ba)]({'name':_0x29fa9f[_0x47c0ec(0x118)],'room':_0x29fa9f[_0x47c0ec(0x169)]});_0x29fa9f['product']['forEach'](_0x5f22e2=>{var _0x49e6fc=_0x47c0ec;if(_0x5f22e2[_0x49e6fc(0x10f)]>0x0){const _0x41f2a7=_0x5ba46d['product_details'][_0x49e6fc(0x196)](_0x3ad0cf=>{var _0xdce4c3=_0x49e6fc;_0x3ad0cf['product_name']==_0x5f22e2[_0xdce4c3(0x194)]&&_0x3ad0cf[_0xdce4c3(0x16e)]==_0x5f22e2['from_floorlevel']&&_0x3ad0cf[_0xdce4c3(0x182)]==_0x5f22e2[_0xdce4c3(0xfb)]&&_0x3ad0cf[_0xdce4c3(0x149)]==_0x5f22e2[_0xdce4c3(0x14e)]&&_0x3ad0cf['bay']==_0x5f22e2[_0xdce4c3(0x1a7)]&&_0x3ad0cf[_0xdce4c3(0x129)]==_0x5f22e2[_0xdce4c3(0x173)]&&_0x3ad0cf['storage']==_0x5f22e2[_0xdce4c3(0x1b6)]&&(_0x3ad0cf[_0xdce4c3(0x117)]=parseInt(_0x3ad0cf[_0xdce4c3(0x117)])+parseInt(_0x5f22e2[_0xdce4c3(0x10f)]));});}}),await _0x5ba46d[_0x47c0ec(0x100)]();const _0x45bd85=await warehouse[_0x47c0ec(0x1ba)]({'name':_0x29fa9f[_0x47c0ec(0xe1)],'room':_0x29fa9f[_0x47c0ec(0x1b9)]});_0x29fa9f[_0x47c0ec(0x1bf)][_0x47c0ec(0x13d)](_0x478dd2=>{var _0x28e2fe=_0x47c0ec;if(_0x478dd2[_0x28e2fe(0x10f)]>0x0){const _0x1be240=_0x45bd85[_0x28e2fe(0xed)][_0x28e2fe(0x196)](_0x54081c=>{var _0x272c0e=_0x28e2fe;_0x54081c[_0x272c0e(0x194)]==_0x478dd2[_0x272c0e(0x194)]&&_0x54081c[_0x272c0e(0x16e)]==_0x478dd2[_0x272c0e(0x179)]&&_0x54081c[_0x272c0e(0x182)]==_0x478dd2[_0x272c0e(0x188)]&&_0x54081c[_0x272c0e(0x149)]==_0x478dd2[_0x272c0e(0x197)]&&_0x54081c[_0x272c0e(0x14f)]==_0x478dd2[_0x272c0e(0x12b)]&&_0x54081c[_0x272c0e(0x129)]==_0x478dd2[_0x272c0e(0x129)]&&_0x54081c[_0x272c0e(0x113)]==_0x478dd2['storage']&&(_0x54081c[_0x272c0e(0x117)]=parseInt(_0x54081c['product_stock'])-parseInt(_0x478dd2[_0x272c0e(0x10f)]));});}}),await _0x45bd85[_0x47c0ec(0x100)](),_0x29fa9f[_0x47c0ec(0x11b)]=_0x19566c,_0x29fa9f[_0x47c0ec(0x118)]=_0x23ef95,_0x29fa9f[_0x47c0ec(0xe1)]=_0x56a98e,_0x29fa9f['product']=_0x38dea4,_0x29fa9f[_0x47c0ec(0x161)]=_0x21b9db,_0x29fa9f['invoice']=_0x52644a;const _0x5471b9=await _0x29fa9f[_0x47c0ec(0x100)]();console['log'](_0x5471b9);const _0x3076ce=await warehouse[_0x47c0ec(0x1ba)]({'name':_0x23ef95,'room':_0xda7e00});_0x5471b9['product']['forEach'](_0x109b03=>{var _0x1b2b34=_0x47c0ec;if(_0x109b03[_0x1b2b34(0x10f)]>0x0){const _0x2dabd8=_0x3076ce[_0x1b2b34(0xed)][_0x1b2b34(0x196)](_0x210f46=>{var _0x4f688d=_0x1b2b34;_0x210f46[_0x4f688d(0x194)]==_0x109b03[_0x4f688d(0x194)]&&_0x210f46[_0x4f688d(0x16e)]==_0x109b03[_0x4f688d(0x103)]&&_0x210f46[_0x4f688d(0x182)]==_0x109b03[_0x4f688d(0xfb)]&&_0x210f46[_0x4f688d(0x149)]==_0x109b03['from_bin']&&_0x210f46[_0x4f688d(0x14f)]==_0x109b03['from_bay']&&_0x210f46[_0x4f688d(0x129)]==_0x109b03['from_rack']&&_0x210f46[_0x4f688d(0x113)]==_0x109b03[_0x4f688d(0x1b6)]&&(_0x210f46[_0x4f688d(0x117)]=parseInt(_0x210f46[_0x4f688d(0x117)])-parseInt(_0x109b03[_0x4f688d(0x10f)]));});}}),await _0x3076ce['save']();const _0x344ec=await warehouse['findOne']({'name':_0x56a98e,'room':_0x11219d});_0x5471b9[_0x47c0ec(0x1bf)][_0x47c0ec(0x13d)](_0x43387d=>{var _0x2e90b5=_0x47c0ec;if(_0x43387d[_0x2e90b5(0x10f)]>0x0){var _0x3c5aab=0x0;const _0x481dee=_0x344ec['product_details']['map'](_0x4fcfed=>{var _0x5a5de3=_0x2e90b5;_0x4fcfed[_0x5a5de3(0x194)]==_0x43387d[_0x5a5de3(0x194)]&&_0x4fcfed[_0x5a5de3(0x16e)]==_0x43387d[_0x5a5de3(0x179)]&&_0x4fcfed[_0x5a5de3(0x182)]==_0x43387d['to_types']&&_0x4fcfed[_0x5a5de3(0x149)]==_0x43387d[_0x5a5de3(0x197)]&&_0x4fcfed[_0x5a5de3(0x14f)]==_0x43387d[_0x5a5de3(0x12b)]&&_0x4fcfed[_0x5a5de3(0x129)]==_0x43387d[_0x5a5de3(0x129)]&&_0x4fcfed['storage']==_0x43387d[_0x5a5de3(0x113)]&&(_0x4fcfed[_0x5a5de3(0x117)]=parseInt(_0x4fcfed[_0x5a5de3(0x117)])+parseInt(_0x43387d[_0x5a5de3(0x10f)]),_0x3c5aab++);});_0x3c5aab=='0'&&(_0x344ec[_0x2e90b5(0xed)]=_0x344ec[_0x2e90b5(0xed)][_0x2e90b5(0x13c)]({'product_name':_0x43387d[_0x2e90b5(0x194)],'product_stock':_0x43387d[_0x2e90b5(0x10f)],'bay':_0x43387d[_0x2e90b5(0x12b)],'bin':_0x43387d[_0x2e90b5(0x197)],'type':_0x43387d[_0x2e90b5(0x188)],'floorlevel':_0x43387d[_0x2e90b5(0x179)],'storage':_0x43387d[_0x2e90b5(0x113)],'rack':_0x43387d[_0x2e90b5(0x129)],'product_code':_0x43387d['product_code'],'primary_code':_0x43387d[_0x2e90b5(0x1a8)],'secondary_code':_0x43387d[_0x2e90b5(0x1c1)],'maxProducts':_0x43387d[_0x2e90b5(0x193)],'storage':_0x43387d[_0x2e90b5(0x113)],'rack':_0x43387d[_0x2e90b5(0x129)]}));}}),await _0x344ec['save'](),_0x2d20fa[_0x47c0ec(0xf2)]('success',_0x47c0ec(0x18a)),_0x42271c['redirect'](_0x47c0ec(0x104));}catch(_0x1ae9d1){console[_0x47c0ec(0x1c0)](_0x1ae9d1);}}),router[a0_0x50b1ff(0x18e)]('/barcode_scanner',async(_0x44ad0e,_0x3dbf52)=>{var _0x349446=a0_0x50b1ff;const {FromWareHouse:_0x40b057,FromRoom:_0x23980d,ToWarehouse:_0x338378,ToRoom:_0x530e5c,primary_code:_0x4e6e12,Roomslist:_0x44e5a3}=_0x44ad0e[_0x349446(0x1a1)],_0x496288=_0x44e5a3[_0x349446(0x12f)](','),_0x597260=[];async function _0x177cb6(_0x565731){var _0x50f8f2=_0x349446;const _0x3091ae=await warehouse['aggregate']([{'$match':{'name':_0x40b057,'room':_0x565731}},{'$unwind':_0x50f8f2(0x17d)},{'$match':{'product_details.primary_code':_0x4e6e12}},{'$group':{'_id':_0x50f8f2(0x15f),'name':{'$first':_0x50f8f2(0x19f)},'instock':{'$first':_0x50f8f2(0x1ae)},'primary_code':{'$first':_0x50f8f2(0x1a2)},'secondary_code':{'$first':_0x50f8f2(0x189)},'product_code':{'$first':_0x50f8f2(0x160)},'level':{'$first':_0x50f8f2(0x19b)},'isle':{'$first':_0x50f8f2(0x1c6)},'type':{'$first':_0x50f8f2(0x1c5)},'pallet':{'$first':_0x50f8f2(0x13b)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x50f8f2(0x185)},'storage':{'$first':_0x50f8f2(0x192)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x50f8f2(0x109)},'production_date':{'$first':_0x50f8f2(0x148)},'batch_code':{'$first':_0x50f8f2(0x123)},'maxPerUnit':{'$first':_0x50f8f2(0x126)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x50f8f2(0x184)}}}]),_0x43b945=await warehouse[_0x50f8f2(0x16f)]([{'$match':{'name':_0x40b057,'room':_0x565731}},{'$unwind':_0x50f8f2(0x17d)},{'$match':{'product_details.secondary_code':_0x4e6e12}},{'$group':{'_id':_0x50f8f2(0x15f),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x50f8f2(0x1ae)},'primary_code':{'$first':_0x50f8f2(0x1a2)},'secondary_code':{'$first':_0x50f8f2(0x189)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x50f8f2(0x19b)},'isle':{'$first':_0x50f8f2(0x1c6)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x50f8f2(0x13b)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x50f8f2(0x192)},'rack':{'$first':_0x50f8f2(0x121)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x50f8f2(0x148)},'batch_code':{'$first':_0x50f8f2(0x123)},'maxPerUnit':{'$first':_0x50f8f2(0x126)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x50f8f2(0x134)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);if(_0x3091ae[_0x50f8f2(0x1a0)]>0x0)_0x597260[_0x50f8f2(0xf5)](_0x3091ae);else _0x43b945['length']>0x0&&_0x597260['push'](_0x43b945);}const _0x10be1f=_0x496288['map'](_0xcc5e7a=>_0x177cb6(_0xcc5e7a));await Promise['all'](_0x10be1f),_0x3dbf52[_0x349446(0x12c)](_0x597260);}),router['post'](a0_0x50b1ff(0x190),async(_0x267ffb,_0x38aeea)=>{var _0x979cb5=a0_0x50b1ff;try{const {FromWareHouse:_0x408ca7,FromRoom:_0x58058c,ToWarehouse:_0x5066d5,ToRoom:_0x18fee4,secondary_code:_0x4d974b}=_0x267ffb[_0x979cb5(0x1a1)],_0x4ffb7d=await warehouse[_0x979cb5(0x16f)]([{'$match':{'name':_0x408ca7}},{'$unwind':_0x979cb5(0x17d)},{'$match':{'product_details.secondary_code':_0x4d974b}},{'$group':{'_id':_0x979cb5(0x15f),'name':{'$first':_0x979cb5(0x19f)},'primary_code':{'$first':_0x979cb5(0x1a2)},'secondary_code':{'$first':_0x979cb5(0x189)},'product_code':{'$first':_0x979cb5(0x160)},'instock':{'$first':_0x979cb5(0x1ae)},'warehouse':{'$first':'$name'},'level':{'$first':_0x979cb5(0x147)},'isle':{'$first':_0x979cb5(0x14b)},'pallet':{'$first':_0x979cb5(0x1b1)},'maxProducts':{'$first':_0x979cb5(0x184)},'unit':{'$first':_0x979cb5(0x171)}}}]);_0x38aeea[_0x979cb5(0x1c3)](0xc8)[_0x979cb5(0x12c)](_0x4ffb7d);}catch(_0x96da81){_0x38aeea['status'](0x194)[_0x979cb5(0x12c)]({'message':_0x96da81[_0x979cb5(0x11a)]});}}),router[a0_0x50b1ff(0x18e)]('/barcode_scanner3',async(_0x502843,_0x58d742)=>{var _0x35546f=a0_0x50b1ff;try{const {FromWareHouse:_0x45b3de,FromRoom:_0x2b49da,ToWarehouse:_0x50b5da,ToRoom:_0x5cb7a2,product_code:_0x20062f}=_0x502843['body'],_0x32af0e=await warehouse[_0x35546f(0x16f)]([{'$match':{'name':_0x45b3de}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x20062f}},{'$group':{'_id':_0x35546f(0x15f),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x35546f(0x1a2)},'secondary_code':{'$first':_0x35546f(0x189)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x35546f(0xe7)},'level':{'$first':_0x35546f(0x147)},'isle':{'$first':_0x35546f(0x14b)},'pallet':{'$first':_0x35546f(0x1b1)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0x58d742['status'](0xc8)[_0x35546f(0x12c)](_0x32af0e);}catch(_0x3406c7){_0x58d742[_0x35546f(0x1c3)](0x194)[_0x35546f(0x12c)]({'message':_0x3406c7['message']});}}),router['post'](a0_0x50b1ff(0x1af),async(_0x1e37f5,_0xed1741)=>{var _0x5afe81=a0_0x50b1ff;const {level:_0x45dbee,isle:_0x2015f5,pallet:_0x12648a,warehouses:_0x505ff7,room:_0x5f16ad}=_0x1e37f5[_0x5afe81(0x1a1)];try{const _0x20ef15=await warehouse[_0x5afe81(0x16f)]([{'$match':{'name':_0x505ff7,'room':_0x5f16ad}},{'$unwind':_0x5afe81(0x17d)},{'$match':{'product_details.level':parseInt(_0x45dbee),'product_details.isle':_0x2015f5,'product_details.pallet':parseInt(_0x12648a)}},{'$group':{'_id':_0x5afe81(0x15f),'name':{'$first':_0x5afe81(0x19f)},'product_stock':{'$first':_0x5afe81(0x1ae)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5afe81(0x14b)},'pallet':{'$first':_0x5afe81(0x1b1)},'maxProducts':{'$first':_0x5afe81(0x184)}}}]);_0xed1741[_0x5afe81(0x1c3)](0xc8)[_0x5afe81(0x12c)](_0x20ef15);}catch(_0x1c2ed0){_0xed1741[_0x5afe81(0x1c3)](0x194)[_0x5afe81(0x12c)]({'message':_0x1c2ed0[_0x5afe81(0x11a)]});}}),module[a0_0x50b1ff(0x154)]=router;