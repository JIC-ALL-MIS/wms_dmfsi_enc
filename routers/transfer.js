var a0_0x19b242=a0_0x261e;(function(_0x101497,_0x371516){var _0x9e1be3=a0_0x261e,_0x503d44=_0x101497();while(!![]){try{var _0x1e064b=-parseInt(_0x9e1be3(0x131))/0x1+parseInt(_0x9e1be3(0xc3))/0x2+parseInt(_0x9e1be3(0xeb))/0x3+parseInt(_0x9e1be3(0xd0))/0x4+-parseInt(_0x9e1be3(0x170))/0x5*(parseInt(_0x9e1be3(0x10c))/0x6)+-parseInt(_0x9e1be3(0x167))/0x7+parseInt(_0x9e1be3(0xf3))/0x8*(parseInt(_0x9e1be3(0x17b))/0x9);if(_0x1e064b===_0x371516)break;else _0x503d44['push'](_0x503d44['shift']());}catch(_0x39e2c1){_0x503d44['push'](_0x503d44['shift']());}}}(a0_0x1fd8,0x7c5c5));function a0_0x261e(_0x2cb786,_0x104604){var _0x1fd8d6=a0_0x1fd8();return a0_0x261e=function(_0x261ed,_0x1e5bbe){_0x261ed=_0x261ed-0x9d;var _0x4c59be=_0x1fd8d6[_0x261ed];return _0x4c59be;},a0_0x261e(_0x2cb786,_0x104604);}const express=require('express'),app=express(),router=express[a0_0x19b242(0x158)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x19b242(0xe5)),auth=require(a0_0x19b242(0x14d)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x19b242(0x183));router['get'](a0_0x19b242(0xc4),auth,async(_0x2feae8,_0x44eb4d)=>{var _0xd71249=a0_0x19b242;try{const {username:_0xb5fbf3,email:_0x127067,role:_0x253d87}=_0x2feae8[_0xd71249(0x168)],_0x49c5f8=_0x2feae8[_0xd71249(0x168)],_0x123ece=await profile[_0xd71249(0xde)]({'email':_0x49c5f8[_0xd71249(0x11a)]}),_0x547906=await master_shop[_0xd71249(0xda)]();console['log'](_0xd71249(0xd1),_0x547906);let _0x35345c;if(_0x49c5f8[_0xd71249(0xd4)]==_0xd71249(0x164)){const _0x2c1f7e=await staff['findOne']({'email':_0x49c5f8['email']});_0x35345c=await transfers['find']({'from_warehouse':_0x2c1f7e[_0xd71249(0x156)]});}else _0x35345c=await transfers[_0xd71249(0x17a)]([{'$unwind':'$product'},{'$group':{'_id':_0xd71249(0xb7),'invoice':{'$first':'$invoice'},'date':{'$first':_0xd71249(0x15b)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0xd71249(0xf1)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x547906[0x0][_0xd71249(0xb6)]==_0xd71249(0x140)){var _0x2c5155=users[_0xd71249(0xc2)];console[_0xd71249(0x129)](_0x2c5155);}else{if(_0x547906[0x0]['language']==_0xd71249(0xfb))var _0x2c5155=users[_0xd71249(0xfb)];else{if(_0x547906[0x0][_0xd71249(0xb6)]=='German')var _0x2c5155=users['German'];else{if(_0x547906[0x0][_0xd71249(0xb6)]=='Spanish')var _0x2c5155=users['Spanish'];else{if(_0x547906[0x0]['language']=='French')var _0x2c5155=users[_0xd71249(0xba)];else{if(_0x547906[0x0][_0xd71249(0xb6)]==_0xd71249(0x110))var _0x2c5155=users[_0xd71249(0x18c)];else{if(_0x547906[0x0][_0xd71249(0xb6)]=='Chinese')var _0x2c5155=users['Chinese'];else{if(_0x547906[0x0][_0xd71249(0xb6)]==_0xd71249(0x123))var _0x2c5155=users[_0xd71249(0x187)];}}}}}}}_0x44eb4d[_0xd71249(0xac)](_0xd71249(0x100),{'success':_0x2feae8[_0xd71249(0xb5)](_0xd71249(0x13c)),'errors':_0x2feae8[_0xd71249(0xb5)]('errors'),'role':_0x49c5f8,'profile':_0x123ece,'master_shop':_0x547906,'transfer':_0x35345c,'language':_0x2c5155});}catch(_0x3553ea){console[_0xd71249(0x129)](_0x3553ea);}});function a0_0x1fd8(){var _0x2d96cd=['/../public','prod_name','/transfer/view','/barcode_scanner2','flash','language','$_id','$product_details.floorlevel','to_prod_level','French','Ambient','Transfer\x20Finalize\x20Successfully','json','product_code3','maxProducts','$product_details.storage','forEach','English','325842VaAtKi','/view','to_room_name','primary_code','logo','New_Qty_Converted','<tbody\x20style=\x22text-align:\x20center;\x22>','to_prod_isle','save','to_prod_pallet','$product_details.product_name','$product_details.secondary_code','to_bin','823656ljYROA','master','$product_details.product_code','$product_details.pallet','role','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Enclosed','<tr>','Transfer\x20Edit\x20Successfully','from_storage','find','An\x20error\x20occurred\x20while\x20saving\x20data.','to_prod_qty','$product_details.batch_code','findOne','Shelves','<hr\x20class=\x22my-3\x22>','/upload/','from_room_name','$product_details.maxPerUnit','$product_details.isle','../models/all_models','batch_code','\x20Order\x20Date\x20:\x20','<table\x20style=\x22width:\x20100%\x20!important;\x22>','getFullYear','</head><body>','301128IlsASp','</td>','from_types','/barcode_scanner3','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Receiving\x20Area','$product.to_room_name','push','152NgCjgJ','<span\x20style=\x22float:\x20right;\x22>','/transfer/preview/','\x20</h2>','post','status','expiry_date','secondary_unit','Hindi','$room','</thead>','site_title','$product_details.production_date','transfer','primary_unit','Rack\x20A','$product_details.level','ToRoomAssigned','bay','unit','here','Floor','add_transfer','</h5>','get','6hAxdNc','<h2>\x20','Enabled','</div>','Portuguese\x20(BR)','to_types','maxperunit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Rack\x20E','back','from_prod_qty','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','floor','$product_details.unit','email','to_invoice','exports','createTransport','secondary_code','$product_details.rack','from_warehouse','concat','COLD\x20STORAGE','Arabic\x20(ae)','host','rack','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<html><head><title></title>','RoomAssigned','log','id_transaction','/view/:id','body','sendMail','prod_cat','to_warehouse','<strong>\x20Regards\x20</strong>','810UngoPE','to_bay','<!DOCTYPE\x20html>','product','product_stock','$product_details.type','storage','updateOne','image','catch','slice','success','bin','finalize','params','English\x20(US)','product_name','<div>','German','error','type','message','date','$product_details.bay','Spanish','getMonth','to_quantity','$product_details.primary_code','../middleware/auth','</tr>','\x20Order\x20Number\x20:\x20','TRF-','Product\x20Transfer\x20successfully','Level','invoice','Rack\x20C','$product_details.secondary_unit','warehouse','from_invoice','Router','from_bay','from_rack','$date','An\x20error\x20occurred.','from_room','True','to_floorlevel','$product_details.bin','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details._id','filter','staff','_id','from_rak','33222ewaWMN','user','/preview/:id','Return\x20Rooms','all','then','RMSEmail','product_code','edit_transfer_view','3278105kVUxQK','</tbody>','errors','from_prod_pallet','getDate','Raw\x20Materials','max_per_unit','from_prod_isle','redirect','/barcode_scanner','aggregate','332217UWGgiC','Rack\x20D','password','/CheckingWarehouse','length','Rack\x20F','$product_details.expiry_date','$name','nodemailer','product_details','<h5>','id_transaction_id','Arabic','Error\x20Occurs','/view/add_transfer','from_prod_level','\x20<>\x20','Portuguese','$product_details','port','DRY\x20STORAGE','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.product_stock','from_bin','to_room','Chinese','rak','toString','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','floorlevel','production_date','MaxStocks_data2','from_floorlevel','$product_details.maxProducts','render','$product_details.invoice','split','findById','map'];a0_0x1fd8=function(){return _0x2d96cd;};return a0_0x1fd8();}async function getRandom8DigitNumber(){var _0x350d5b=a0_0x19b242;const _0x1b7765=0x989680,_0x204e86=0x5f5e0ff,_0x3a0cea=Math[_0x350d5b(0x118)](Math['random']()*(_0x204e86-_0x1b7765+0x1))+_0x1b7765;var _0x4b38cc;const _0x33cee5=await transfers[_0x350d5b(0xde)]({'invoice':_0x350d5b(0x150)+_0x3a0cea});return _0x33cee5&&_0x33cee5['length']>0x0?_0x4b38cc=_0x350d5b(0x150)+_0x3a0cea:_0x4b38cc=_0x350d5b(0x150)+_0x3a0cea,_0x4b38cc;}router[a0_0x19b242(0x10b)](a0_0x19b242(0x189),auth,async(_0xbfb210,_0x319f3b)=>{var _0x42587d=a0_0x19b242;try{const {username:_0x5ded0d,email:_0x3fed7f,role:_0x1f58d9}=_0xbfb210['user'],_0x20c33f=_0xbfb210[_0x42587d(0x168)],_0x5b740c=await profile[_0x42587d(0xde)]({'email':_0x20c33f[_0x42587d(0x11a)]}),_0x28df48=await master_shop[_0x42587d(0xda)]();console['log'](_0x42587d(0xd1),_0x28df48);let _0x49f1b4;if(_0x20c33f[_0x42587d(0xd4)]==_0x42587d(0x164)){const _0x163219=await staff[_0x42587d(0xde)]({'email':_0x20c33f[_0x42587d(0x11a)]});_0x49f1b4=await warehouse[_0x42587d(0x17a)]([{'$match':{'status':_0x42587d(0x10e),'name':_0x163219[_0x42587d(0x156)],'warehouse_category':_0x42587d(0x175)}},{'$group':{'_id':'$name','name':{'$first':_0x42587d(0x182)}}}]);}else _0x49f1b4=await warehouse[_0x42587d(0x17a)]([{'$match':{'status':_0x42587d(0x10e),'warehouse_category':_0x42587d(0x175)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);var _0xf897f9=[_0x42587d(0xbb),_0x42587d(0xd6),_0x42587d(0x16a)];const _0x1614b9=await transfers[_0x42587d(0xda)]({}),_0x285270=_0x1614b9[_0x42587d(0x17f)]+0x1,_0x37a524=_0x42587d(0x150)+_0x285270[_0x42587d(0xa5)]()['padStart'](0x5,'0');if(_0x28df48[0x0]['language']==_0x42587d(0x140)){var _0x12d930=users[_0x42587d(0xc2)];console[_0x42587d(0x129)](_0x12d930);}else{if(_0x28df48[0x0][_0x42587d(0xb6)]==_0x42587d(0xfb))var _0x12d930=users[_0x42587d(0xfb)];else{if(_0x28df48[0x0][_0x42587d(0xb6)]=='German')var _0x12d930=users[_0x42587d(0x143)];else{if(_0x28df48[0x0][_0x42587d(0xb6)]=='Spanish')var _0x12d930=users[_0x42587d(0x149)];else{if(_0x28df48[0x0][_0x42587d(0xb6)]=='French')var _0x12d930=users[_0x42587d(0xba)];else{if(_0x28df48[0x0][_0x42587d(0xb6)]==_0x42587d(0x110))var _0x12d930=users[_0x42587d(0x18c)];else{if(_0x28df48[0x0][_0x42587d(0xb6)]==_0x42587d(0xa3))var _0x12d930=users['Chinese'];else{if(_0x28df48[0x0]['language']==_0x42587d(0x123))var _0x12d930=users[_0x42587d(0x187)];}}}}}}}const _0x5a645c=getRandom8DigitNumber();_0x5a645c['then'](_0x104525=>{var _0x3c228b=_0x42587d;_0x319f3b['render'](_0x3c228b(0x109),{'success':_0xbfb210[_0x3c228b(0xb5)]('success'),'errors':_0xbfb210['flash'](_0x3c228b(0x172)),'role':_0x20c33f,'profile':_0x5b740c,'master_shop':_0x28df48,'warehouse':_0x49f1b4,'language':_0x12d930,'rooms_data':_0xf897f9,'invoice':_0x104525});})[_0x42587d(0x13a)](_0x9f7c2c=>{var _0x23dab9=_0x42587d;_0xbfb210[_0x23dab9(0xb5)](_0x23dab9(0x172),_0x23dab9(0x113)),_0x319f3b[_0x23dab9(0x178)](_0x23dab9(0xb3));});}catch(_0xc91475){console[_0x42587d(0x129)](_0xc91475);}}),router[a0_0x19b242(0xf7)](a0_0x19b242(0x189),auth,async(_0x59d2b0,_0x30b7df)=>{var _0x5f0e65=a0_0x19b242;try{console[_0x5f0e65(0x129)](_0x59d2b0[_0x5f0e65(0x12c)]);const {date:_0x4320eb,from_warehouse:_0x5edb8e,FromRoom_name:_0x2cc0b4,to_warehouse:_0x1c16fc,ToRoom_name:_0x2606c7,prod_name:_0x9eb6ed,from_prod_qty:_0x362971,from_prod_level:_0x1f6ab3,from_prod_isle:_0x3fd06d,from_prod_pallet:_0x136f9a,to_prod_qty:_0x2179ea,to_prod_level:_0x24d1f8,to_prod_isle:_0x27d6c2,to_prod_pallet:_0x10e053,primary_code:_0x3e92f7,secondary_code:_0x20c8a2,product_code3:_0x5a5702,note:_0x398f73,MaxStocks_data2:_0xba2db8,invoice:_0x1b2628,expiry_date:_0x446ac4}=_0x59d2b0[_0x5f0e65(0x12c)];if(typeof _0x9eb6ed=='string')var _0x5ed61d=[_0x59d2b0[_0x5f0e65(0x12c)]['prod_name']],_0x3fba87=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x116)]],_0x1f5f2a=[_0x59d2b0[_0x5f0e65(0x12c)]['from_prod_level']],_0x3b13ee=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xc8)]],_0x213e28=[_0x59d2b0[_0x5f0e65(0x12c)]['to_prod_level']],_0x4adf08=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xc6)]],_0x5c682e=[_0x59d2b0['body']['secondary_code']],_0xd40f6a=[_0x59d2b0[_0x5f0e65(0x12c)]['product_code3']],_0x27f007=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xa9)]],_0x3398f3=[_0x59d2b0['body'][_0x5f0e65(0x101)]],_0x537332=[_0x59d2b0['body'][_0x5f0e65(0xfa)]],_0x3a7df8=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xe6)]],_0x1bf025=[_0x59d2b0[_0x5f0e65(0x12c)]['expiry_date']],_0xf30132=[_0x59d2b0[_0x5f0e65(0x12c)]['max_per_unit']],_0x46e446=[_0x59d2b0[_0x5f0e65(0x12c)]['production_date']],_0x3f5abb=[_0x59d2b0[_0x5f0e65(0x12c)]['prod_cat']],_0x5c0304=[_0x59d2b0[_0x5f0e65(0x12c)]['RoomAssigned']],_0x259820=[_0x59d2b0['body'][_0x5f0e65(0x104)]],_0x4e7e93=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x157)]],_0x5bfc9d=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x11b)]],_0x49f5f7=[_0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x12a)]];else var _0x5ed61d=[..._0x59d2b0[_0x5f0e65(0x12c)]['prod_name']],_0x3fba87=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x116)]],_0x1f5f2a=[..._0x59d2b0['body'][_0x5f0e65(0x18a)]],_0x3b13ee=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xc8)]],_0x213e28=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xb9)]],_0x4adf08=[..._0x59d2b0[_0x5f0e65(0x12c)]['primary_code']],_0x5c682e=[..._0x59d2b0['body']['secondary_code']],_0xd40f6a=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xbe)]],_0x27f007=[..._0x59d2b0[_0x5f0e65(0x12c)]['MaxStocks_data2']],_0x3398f3=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x101)]],_0x537332=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xfa)]],_0x3a7df8=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0xe6)]],_0x1bf025=[..._0x59d2b0['body']['expiry_date']],_0xf30132=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x176)]],_0x46e446=[..._0x59d2b0[_0x5f0e65(0x12c)]['production_date']],_0x3f5abb=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x12e)]],_0x5c0304=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x128)]],_0x259820=[..._0x59d2b0['body'][_0x5f0e65(0x104)]],_0x4e7e93=[..._0x59d2b0[_0x5f0e65(0x12c)]['from_invoice']],_0x5bfc9d=[..._0x59d2b0[_0x5f0e65(0x12c)][_0x5f0e65(0x11b)]],_0x49f5f7=[..._0x59d2b0['body'][_0x5f0e65(0x12a)]];const _0x40f4dc=_0x5ed61d['map'](_0x35bad4=>{return _0x35bad4={'product_name':_0x35bad4};});_0x3fba87['forEach']((_0x595f67,_0x1ae66a)=>{_0x40f4dc[_0x1ae66a]['from_quantity']=_0x595f67;}),_0x4e7e93[_0x5f0e65(0xc1)]((_0xc695e6,_0x59f81b)=>{_0x40f4dc[_0x59f81b]['from_invoice']=_0xc695e6;}),_0x5bfc9d[_0x5f0e65(0xc1)]((_0x3f1e9a,_0x22862f)=>{_0x40f4dc[_0x22862f]['To_invoice']=_0x3f1e9a;}),_0x49f5f7[_0x5f0e65(0xc1)]((_0x4e227d,_0x58fe71)=>{_0x40f4dc[_0x58fe71]['id_transaction_id']=_0x4e227d;}),_0x1f5f2a[_0x5f0e65(0xc1)]((_0x100daf,_0x28845f)=>{var _0x29b22a=_0x5f0e65;_0x5c0304[_0x29b22a(0xc1)]((_0x345788,_0x2ce740)=>{var _0xa377b1=_0x29b22a;if(_0x345788==_0xa377b1(0xf0)&&_0x28845f==_0x2ce740){var _0x1cbdd7=_0x100daf['slice'](0x3);_0x40f4dc[_0x28845f][_0xa377b1(0xd9)]=_0x100daf[0x0],_0x40f4dc[_0x28845f][_0xa377b1(0x15a)]=_0x100daf[0x1],_0x40f4dc[_0x28845f][_0xa377b1(0x159)]=0x0,_0x40f4dc[_0x28845f][_0xa377b1(0xa1)]=0x0,_0x40f4dc[_0x28845f][_0xa377b1(0xed)]=_0xa377b1(0x108),_0x40f4dc[_0x28845f][_0xa377b1(0xaa)]=_0x1cbdd7;}else{if(_0x345788==_0xa377b1(0xdf)&&_0x28845f==_0x2ce740){var _0x1cbdd7=_0x100daf['slice'](0x3);_0x40f4dc[_0x28845f][_0xa377b1(0xd9)]=_0x100daf[0x0],_0x40f4dc[_0x28845f]['from_rack']=_0x100daf[0x1],_0x40f4dc[_0x28845f][_0xa377b1(0x159)]=0x0,_0x40f4dc[_0x28845f][_0xa377b1(0xa1)]=0x0,_0x40f4dc[_0x28845f][_0xa377b1(0xed)]=_0xa377b1(0x108),_0x40f4dc[_0x28845f][_0xa377b1(0xaa)]=_0x100daf[0x5];}else{if(_0x28845f==_0x2ce740){if(_0x100daf[0x0]=='A'&&_0x100daf[0x1]=='L'&&_0x100daf[0x2]=='L')console[_0xa377b1(0x129)](_0x345788+'\x20<>\x20'+_0x28845f+_0xa377b1(0x18b)+_0x2ce740+_0xa377b1(0x18b)+_0x100daf+_0xa377b1(0x107)),_0x40f4dc[_0x28845f][_0xa377b1(0xd9)]=_0x100daf[0x0],_0x40f4dc[_0x28845f][_0xa377b1(0x15a)]=_0x100daf[0x1],_0x40f4dc[_0x28845f][_0xa377b1(0x159)]=0x0,_0x40f4dc[_0x28845f][_0xa377b1(0xa1)]=0x0,_0x40f4dc[_0x28845f][_0xa377b1(0xed)]=_0xa377b1(0x108),_0x40f4dc[_0x28845f][_0xa377b1(0xaa)]=_0x100daf[0x3];else{var _0x561d2c;if(_0x100daf[0x4]=='L')_0x561d2c=_0xa377b1(0x152);else _0x100daf[0x4]=='F'&&(_0x561d2c=_0xa377b1(0x108));_0x40f4dc[_0x28845f][_0xa377b1(0xd9)]=_0x100daf[0x0],_0x40f4dc[_0x28845f][_0xa377b1(0x15a)]=_0x100daf[0x1],_0x40f4dc[_0x28845f][_0xa377b1(0x159)]=_0x100daf[0x2],_0x40f4dc[_0x28845f][_0xa377b1(0xa1)]=_0x100daf[0x3],_0x40f4dc[_0x28845f]['from_types']=_0x561d2c,_0x40f4dc[_0x28845f][_0xa377b1(0xaa)]=_0x100daf[0x5];}}}}});}),_0x3b13ee['forEach']((_0x12bbe5,_0xc85071)=>{var _0xaabe38=_0x5f0e65;_0x40f4dc[_0xc85071][_0xaabe38(0x14b)]=_0x12bbe5;}),_0x213e28[_0x5f0e65(0xc1)]((_0x2f0348,_0x581240)=>{var _0x564978=_0x5f0e65;_0x259820[_0x564978(0xc1)]((_0x3225da,_0x40fea0)=>{var _0x1576b8=_0x564978;if(_0x3225da==_0x1576b8(0xf0)&&_0x581240==_0x40fea0){var _0x5ca810=_0x2f0348['slice'](0x3);_0x40f4dc[_0x581240][_0x1576b8(0x137)]=_0x2f0348[0x0],_0x40f4dc[_0x581240][_0x1576b8(0x125)]=_0x2f0348[0x1],_0x40f4dc[_0x581240][_0x1576b8(0x132)]=0x0,_0x40f4dc[_0x581240][_0x1576b8(0xcf)]=0x0,_0x40f4dc[_0x581240][_0x1576b8(0x111)]=_0x1576b8(0x108),_0x40f4dc[_0x581240][_0x1576b8(0x15f)]=_0x5ca810;}else{if(_0x3225da==_0x1576b8(0xdf)&&_0x581240==_0x40fea0){var _0x5ca810=_0x2f0348[_0x1576b8(0x13b)](0x3);_0x40f4dc[_0x581240][_0x1576b8(0x137)]=_0x2f0348[0x0],_0x40f4dc[_0x581240]['rack']=_0x2f0348[0x1],_0x40f4dc[_0x581240][_0x1576b8(0x132)]=0x0,_0x40f4dc[_0x581240][_0x1576b8(0xcf)]=0x0,_0x40f4dc[_0x581240][_0x1576b8(0x111)]=_0x1576b8(0x108),_0x40f4dc[_0x581240][_0x1576b8(0x15f)]=_0x2f0348[0x5];}else{if(_0x581240==_0x40fea0){if(_0x2f0348[0x0]=='A'&&_0x2f0348[0x1]=='L'&&_0x2f0348[0x2]=='L')console[_0x1576b8(0x129)](_0x3225da+'\x20<>\x20'+_0x581240+_0x1576b8(0x18b)+_0x40fea0+_0x1576b8(0x18b)+_0x2f0348+_0x1576b8(0x107)),_0x40f4dc[_0x581240][_0x1576b8(0x137)]=_0x2f0348[0x0],_0x40f4dc[_0x581240][_0x1576b8(0x125)]=_0x2f0348[0x1],_0x40f4dc[_0x581240][_0x1576b8(0x132)]=0x0,_0x40f4dc[_0x581240][_0x1576b8(0xcf)]=0x0,_0x40f4dc[_0x581240][_0x1576b8(0x111)]=_0x1576b8(0x108),_0x40f4dc[_0x581240][_0x1576b8(0x15f)]=_0x2f0348[0x3];else{var _0x47611f;if(_0x2f0348[0x4]=='L')_0x47611f=_0x1576b8(0x152);else _0x2f0348[0x4]=='F'&&(_0x47611f=_0x1576b8(0x108));_0x40f4dc[_0x581240]['storage']=_0x2f0348[0x0],_0x40f4dc[_0x581240]['rack']=_0x2f0348[0x1],_0x40f4dc[_0x581240][_0x1576b8(0x132)]=_0x2f0348[0x2],_0x40f4dc[_0x581240]['to_bin']=_0x2f0348[0x3],_0x40f4dc[_0x581240][_0x1576b8(0x111)]=_0x47611f,_0x40f4dc[_0x581240][_0x1576b8(0x15f)]=_0x2f0348[0x5];}}}}});}),_0x4adf08[_0x5f0e65(0xc1)]((_0x33a7a6,_0x447914)=>{var _0x4959d9=_0x5f0e65;_0x40f4dc[_0x447914][_0x4959d9(0xc6)]=_0x33a7a6;}),_0x5c682e[_0x5f0e65(0xc1)]((_0x420bfd,_0x15ef24)=>{_0x40f4dc[_0x15ef24]['secondary_code']=_0x420bfd;}),_0xd40f6a[_0x5f0e65(0xc1)]((_0x2ebfac,_0xe281da)=>{_0x40f4dc[_0xe281da]['product_code']=_0x2ebfac;}),_0x27f007[_0x5f0e65(0xc1)]((_0x314262,_0x2592fe)=>{_0x40f4dc[_0x2592fe]['maxProducts']=_0x314262;}),_0x3398f3[_0x5f0e65(0xc1)]((_0x20af50,_0x4150cc)=>{var _0x306a00=_0x5f0e65;_0x40f4dc[_0x4150cc][_0x306a00(0x106)]=_0x20af50;}),_0x537332['forEach']((_0x2b27e3,_0x24ea33)=>{var _0x2459d2=_0x5f0e65;_0x40f4dc[_0x24ea33][_0x2459d2(0xfa)]=_0x2b27e3;}),_0x3a7df8[_0x5f0e65(0xc1)]((_0x138f20,_0x1e059a)=>{_0x40f4dc[_0x1e059a]['batch_code']=_0x138f20;}),_0x1bf025[_0x5f0e65(0xc1)]((_0x59b3ee,_0x25d133)=>{var _0x3d743b=_0x5f0e65;_0x40f4dc[_0x25d133][_0x3d743b(0xf9)]=_0x59b3ee;}),_0xf30132[_0x5f0e65(0xc1)]((_0x65a93c,_0xaa7252)=>{var _0x7d9a8d=_0x5f0e65;_0x40f4dc[_0xaa7252][_0x7d9a8d(0x112)]=_0x65a93c;}),_0x46e446[_0x5f0e65(0xc1)]((_0x80fa05,_0x2f3a79)=>{var _0x523498=_0x5f0e65;_0x40f4dc[_0x2f3a79][_0x523498(0xa8)]=_0x80fa05;}),_0x3f5abb[_0x5f0e65(0xc1)]((_0x2d5f53,_0x5a8993)=>{var _0x767ca8=_0x5f0e65;_0x40f4dc[_0x5a8993][_0x767ca8(0x12e)]=_0x2d5f53;}),_0x5c0304[_0x5f0e65(0xc1)]((_0x497692,_0x5c3875)=>{var _0x552401=_0x5f0e65;_0x40f4dc[_0x5c3875][_0x552401(0xe2)]=_0x497692;}),_0x259820[_0x5f0e65(0xc1)]((_0x5e7a56,_0x339527)=>{var _0x2457b7=_0x5f0e65;_0x40f4dc[_0x339527][_0x2457b7(0xc5)]=_0x5e7a56;});const _0x5b9aa5=_0x40f4dc[_0x5f0e65(0x163)](_0x54577a=>_0x54577a[_0x5f0e65(0x14b)]!=='0'&&_0x54577a[_0x5f0e65(0x14b)]!==''||_0x54577a[_0x5f0e65(0x15f)]!=='0'&&_0x54577a[_0x5f0e65(0x15f)]!==''),_0x45bbed=new transfers({'date':_0x4320eb,'from_warehouse':_0x5edb8e,'to_warehouse':_0x1c16fc,'product':_0x5b9aa5,'note':_0x398f73,'invoice':_0x1b2628}),_0x1a208c=await _0x45bbed[_0x5f0e65(0xcb)]();_0x59d2b0['flash']('success',_0x5f0e65(0x151)),_0x30b7df[_0x5f0e65(0x178)](_0x5f0e65(0xf5)+_0x1a208c['_id']);}catch(_0x2821fc){console[_0x5f0e65(0x129)](_0x2821fc),_0x30b7df[_0x5f0e65(0xf8)](0xc8)['json']({'errorMessage':_0x2821fc[_0x5f0e65(0x146)]});}}),router['get'](a0_0x19b242(0x169),auth,async(_0x293303,_0x42f3c4)=>{var _0x134415=a0_0x19b242;try{const {username:_0x3eb321,email:_0x241f33,role:_0x1feddd}=_0x293303[_0x134415(0x168)],_0x4151af=_0x293303[_0x134415(0x168)],_0x5c2644=await profile[_0x134415(0xde)]({'email':_0x4151af[_0x134415(0x11a)]}),_0x2c46f7=await master_shop[_0x134415(0xda)]();console[_0x134415(0x129)]('master',_0x2c46f7);const _0xc033c7=await transfers[_0x134415(0xaf)](_0x293303['params']['id']);let _0x40c991=new Date(_0xc033c7[_0x134415(0xf9)]),_0x5830d9=('0'+_0x40c991[_0x134415(0x174)]())['slice'](-0x2),_0x409594=('0'+(_0x40c991[_0x134415(0x14a)]()+0x1))[_0x134415(0x13b)](-0x2),_0x47bdd7=_0x40c991[_0x134415(0xe9)](),_0x267441=_0x47bdd7+'-'+_0x409594+'-'+_0x5830d9,_0x4fe84f;if(_0x4151af['role']==_0x134415(0x164)){const _0x51b6e2=await staff['findOne']({'email':_0x4151af[_0x134415(0x11a)]});_0x4fe84f=await warehouse['find']({'status':_0x134415(0x10e),'name':_0x51b6e2['warehouse'],'warehouse_category':_0x134415(0x175)});}else _0x4fe84f=await warehouse[_0x134415(0xda)]({'status':_0x134415(0x10e),'warehouse_category':_0x134415(0x175)});const _0x5527c4=await warehouse[_0x134415(0x17a)]([{'$match':{'name':_0xc033c7[_0x134415(0x120)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x134415(0x162),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x134415(0xb8)},'primary_code':{'$first':_0x134415(0x14c)},'secondary_code':{'$first':_0x134415(0xce)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x134415(0xc0)},'rack':{'$first':_0x134415(0x11f)},'expiry_date':{'$first':_0x134415(0x181)},'production_date':{'$first':_0x134415(0xff)},'room':{'$first':_0x134415(0xfc)}}}]);if(_0x2c46f7[0x0]['language']==_0x134415(0x140)){var _0x4edca9=users['English'];console['log'](_0x4edca9);}else{if(_0x2c46f7[0x0][_0x134415(0xb6)]=='Hindi')var _0x4edca9=users[_0x134415(0xfb)];else{if(_0x2c46f7[0x0][_0x134415(0xb6)]==_0x134415(0x143))var _0x4edca9=users[_0x134415(0x143)];else{if(_0x2c46f7[0x0]['language']==_0x134415(0x149))var _0x4edca9=users[_0x134415(0x149)];else{if(_0x2c46f7[0x0][_0x134415(0xb6)]==_0x134415(0xba))var _0x4edca9=users['French'];else{if(_0x2c46f7[0x0][_0x134415(0xb6)]==_0x134415(0x110))var _0x4edca9=users['Portuguese'];else{if(_0x2c46f7[0x0][_0x134415(0xb6)]==_0x134415(0xa3))var _0x4edca9=users[_0x134415(0xa3)];else{if(_0x2c46f7[0x0][_0x134415(0xb6)]==_0x134415(0x123))var _0x4edca9=users[_0x134415(0x187)];}}}}}}}_0x42f3c4[_0x134415(0xac)](_0x134415(0x16f),{'success':_0x293303[_0x134415(0xb5)]('success'),'errors':_0x293303[_0x134415(0xb5)](_0x134415(0x172)),'role':_0x4151af,'profile':_0x5c2644,'master_shop':_0x2c46f7,'warehouse':_0x4fe84f,'transfer':_0xc033c7,'stock':_0x5527c4,'language':_0x4edca9});}catch(_0x2de662){console[_0x134415(0x129)](_0x2de662);}}),router['post'](a0_0x19b242(0x169),auth,async(_0x5c2d8d,_0x3f19e1)=>{var _0x3ae7bf=a0_0x19b242;try{const _0x48f025=_0x5c2d8d[_0x3ae7bf(0x13f)]['id'],{from_warehouse:_0x1bc876,FromRoom_name:_0x10337d,to_warehouse:_0xc35ef,ToRoom_name:_0x1b0d28}=_0x5c2d8d['body'],_0x4e44a0=await transfers[_0x3ae7bf(0xaf)]({'_id':_0x48f025}),_0xd27d2f=_0x4e44a0[_0x3ae7bf(0x134)]['map'](async _0x3c91d3=>{var _0x391ebf=_0x3ae7bf;if(_0x3c91d3[_0x391ebf(0x14b)]>0x0){var _0x273ab3=await warehouse['findOne']({'name':_0x4e44a0[_0x391ebf(0x120)],'room':_0x3c91d3[_0x391ebf(0xe2)],'warehouse_category':_0x391ebf(0x175)});const _0x5428c6=_0x273ab3['product_details'][_0x391ebf(0xb0)](_0x93a8d3=>{var _0x514e86=_0x391ebf;_0x93a8d3[_0x514e86(0x141)]==_0x3c91d3[_0x514e86(0x141)]&&_0x93a8d3[_0x514e86(0xa7)]==_0x3c91d3['from_floorlevel']&&_0x93a8d3[_0x514e86(0x145)]==_0x3c91d3[_0x514e86(0xed)]&&_0x93a8d3[_0x514e86(0x13d)]==_0x3c91d3[_0x514e86(0xa1)]&&_0x93a8d3['bay']==_0x3c91d3[_0x514e86(0x159)]&&_0x93a8d3[_0x514e86(0x125)]==_0x3c91d3['from_rack']&&_0x93a8d3['storage']==_0x3c91d3['from_storage']&&_0x93a8d3[_0x514e86(0xf9)]==_0x3c91d3['expiry_date']&&_0x93a8d3[_0x514e86(0xe6)]==_0x3c91d3[_0x514e86(0xe6)]&&_0x93a8d3[_0x514e86(0xa8)]==_0x3c91d3['production_date']&&_0x93a8d3[_0x514e86(0x153)]==_0x3c91d3[_0x514e86(0x157)]&&_0x93a8d3['_id']==_0x3c91d3[_0x514e86(0x186)]&&(_0x93a8d3[_0x514e86(0x135)]=_0x93a8d3[_0x514e86(0x135)]-_0x3c91d3[_0x514e86(0x14b)]);});}return _0x273ab3;});Promise[_0x3ae7bf(0x16b)](_0xd27d2f)[_0x3ae7bf(0x16c)](async _0x1d9c90=>{var _0x345096=_0x3ae7bf;try{for(const _0x1d8dd1 of _0x1d9c90){await _0x1d8dd1['save']();}try{const _0x315f98=_0x4e44a0['product'][_0x345096(0xb0)](async _0x4cc255=>{var _0x4bb47a=_0x345096;if(_0x4cc255[_0x4bb47a(0x14b)]>0x0){var _0x362c49=await warehouse[_0x4bb47a(0xde)]({'name':_0x4e44a0[_0x4bb47a(0x12f)],'room':_0x4cc255[_0x4bb47a(0xc5)],'warehouse_category':'Raw\x20Materials'}),_0x5bfa1a=0x0;const _0x23aed7=_0x362c49[_0x4bb47a(0x184)][_0x4bb47a(0xb0)](_0x5d68bb=>{var _0x37ac32=_0x4bb47a;_0x5d68bb[_0x37ac32(0x141)]==_0x4cc255['product_name']&&_0x5d68bb[_0x37ac32(0xa7)]==_0x4cc255['to_floorlevel']&&_0x5d68bb[_0x37ac32(0x145)]==_0x4cc255['to_types']&&_0x5d68bb['bin']==_0x4cc255[_0x37ac32(0xcf)]&&_0x5d68bb['bay']==_0x4cc255[_0x37ac32(0x132)]&&_0x5d68bb[_0x37ac32(0x125)]==_0x4cc255[_0x37ac32(0x125)]&&_0x5d68bb[_0x37ac32(0x137)]==_0x4cc255[_0x37ac32(0x137)]&&_0x5d68bb[_0x37ac32(0xf9)]==_0x4cc255['expiry_date']&&_0x5d68bb[_0x37ac32(0xe6)]==_0x4cc255[_0x37ac32(0xe6)]&&_0x5d68bb[_0x37ac32(0xa8)]==_0x4cc255[_0x37ac32(0xa8)]&&_0x5d68bb[_0x37ac32(0x153)]==_0x4cc255['To_invoice']&&(_0x5d68bb['product_stock']=_0x5d68bb[_0x37ac32(0x135)]+_0x4cc255[_0x37ac32(0x14b)],_0x5bfa1a++);});_0x5bfa1a=='0'&&(_0x362c49[_0x4bb47a(0x184)]=_0x362c49['product_details'][_0x4bb47a(0x121)]({'product_name':_0x4cc255[_0x4bb47a(0x141)],'product_stock':_0x4cc255[_0x4bb47a(0x14b)],'bay':_0x4cc255[_0x4bb47a(0x132)],'bin':_0x4cc255['to_bin'],'type':_0x4cc255[_0x4bb47a(0x111)],'floorlevel':_0x4cc255['to_floorlevel'],'storage':_0x4cc255['storage'],'rack':_0x4cc255['rack'],'product_code':_0x4cc255[_0x4bb47a(0x16e)],'primary_code':_0x4cc255[_0x4bb47a(0xc6)],'secondary_code':_0x4cc255['secondary_code'],'maxProducts':_0x4cc255[_0x4bb47a(0xbf)],'storage':_0x4cc255[_0x4bb47a(0x137)],'rack':_0x4cc255[_0x4bb47a(0x125)],'expiry_date':_0x4cc255[_0x4bb47a(0xf9)],'maxPerUnit':_0x4cc255[_0x4bb47a(0x112)],'batch_code':_0x4cc255[_0x4bb47a(0xe6)],'production_date':_0x4cc255[_0x4bb47a(0xa8)]}));}return _0x362c49;});Promise['all'](_0x315f98)[_0x345096(0x16c)](async _0x327bc2=>{var _0x208f25=_0x345096;try{for(const _0x104676 of _0x327bc2){await warehouse[_0x208f25(0x138)]({'_id':_0x104676[_0x208f25(0x165)]},{'$addToSet':{'product_details':{'$each':_0x104676[_0x208f25(0x184)]}}});}_0x4e44a0[_0x208f25(0x13e)]=_0x208f25(0x15e);const _0x557c58=await _0x4e44a0[_0x208f25(0xcb)](),_0x327901=await master_shop[_0x208f25(0xda)](),_0x4732e3=await email_settings[_0x208f25(0xde)](),_0x3b250c=await supervisor_settings[_0x208f25(0xda)]();var _0x2ffc3d=_0x4e44a0[_0x208f25(0x134)],_0x3b120d='',_0x52b830;for(_0x52b830 in _0x2ffc3d){_0x3b120d+=_0x208f25(0xd7)+_0x208f25(0x126)+_0x2ffc3d[_0x52b830][_0x208f25(0x141)]+_0x208f25(0xec)+_0x208f25(0x126)+_0x2ffc3d[_0x52b830]['product_code']+_0x208f25(0xec)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2ffc3d[_0x52b830][_0x208f25(0x14b)]+_0x208f25(0xec)+_0x208f25(0x126)+_0x2ffc3d[_0x52b830]['unit']+'</td>'+_0x208f25(0x126)+_0x2ffc3d[_0x52b830]['secondary_unit']+_0x208f25(0xec)+_0x208f25(0x126)+_0x4e44a0[_0x208f25(0x12f)]+'</td>'+_0x208f25(0x126)+_0x2ffc3d[_0x52b830][_0x208f25(0xc5)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2ffc3d[_0x52b830][_0x208f25(0x137)]+_0x2ffc3d[_0x52b830][_0x208f25(0x125)]+_0x2ffc3d[_0x52b830][_0x208f25(0x132)]+_0x2ffc3d[_0x52b830]['to_bin']+_0x2ffc3d[_0x52b830][_0x208f25(0x111)][0x0]+_0x2ffc3d[_0x52b830][_0x208f25(0x15f)]+'</td>','</tr>';}let _0x149fed=nodemailer[_0x208f25(0x11d)]({'host':_0x4732e3[_0x208f25(0x124)],'port':Number(_0x4732e3[_0x208f25(0x9d)]),'secure':![],'auth':{'user':_0x4732e3[_0x208f25(0x11a)],'pass':_0x4732e3[_0x208f25(0x17d)]}}),_0x12fa0a={'from':_0x4732e3['email'],'to':_0x3b250c[0x0][_0x208f25(0x16d)],'subject':'Transfer\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x208f25(0xb1)+_0x208f25(0xe1)+_0x327901[0x0][_0x208f25(0x139)],'cid':_0x208f25(0xc7)}],'html':_0x208f25(0x133)+_0x208f25(0x127)+_0x208f25(0xea)+_0x208f25(0x142)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x208f25(0x142)+_0x208f25(0x117)+_0x208f25(0x10f)+_0x208f25(0x142)+_0x208f25(0x10d)+_0x327901[0x0][_0x208f25(0xfe)]+_0x208f25(0xf6)+_0x208f25(0x10f)+_0x208f25(0x10f)+_0x208f25(0xe0)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x208f25(0x14f)+_0x4e44a0[_0x208f25(0x153)]+'\x20'+_0x208f25(0xf4)+_0x208f25(0xe7)+_0x4e44a0[_0x208f25(0x147)]+'\x20'+'</span>'+_0x208f25(0x10a)+_0x208f25(0x10f)+_0x208f25(0xe8)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x208f25(0xd7)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x208f25(0xa6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x208f25(0xd5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x208f25(0xef)+_0x208f25(0x9f)+_0x208f25(0x14e)+_0x208f25(0xfd)+_0x208f25(0xc9)+'\x20'+_0x3b120d+'\x20'+_0x208f25(0x171)+'</table>'+_0x208f25(0x142)+_0x208f25(0x130)+_0x208f25(0x185)+_0x327901[0x0]['site_title']+'</h5>'+'</div>'+_0x208f25(0x10f)+'</body></html>'};_0x149fed[_0x208f25(0x12d)](_0x12fa0a,function(_0x525655,_0xc549bf){var _0x307d47=_0x208f25;_0x525655?(console['log'](_0x525655),console[_0x307d47(0x129)](_0x307d47(0x188))):console[_0x307d47(0x129)]('Email\x20sent\x20successfully');}),_0x5c2d8d[_0x208f25(0xb5)](_0x208f25(0x13c),_0x208f25(0xbc)),_0x3f19e1[_0x208f25(0x178)]('/picking_list/PDF_transfer_rm/'+_0x557c58[_0x208f25(0x165)]);}catch(_0x34cfc4){console[_0x208f25(0x144)](_0x34cfc4),_0x3f19e1['status'](0x1f4)['json']({'Perror':_0x208f25(0xdb),'message':_0x34cfc4[_0x208f25(0x146)]});}})['catch'](_0x142d14=>{var _0x9f1c46=_0x345096;console[_0x9f1c46(0x144)](_0x142d14),_0x3f19e1[_0x9f1c46(0xf8)](0x1f4)['json']({'Perror':_0x9f1c46(0x15c)});});}catch(_0x5cd7d8){_0x3f19e1['json'](_0x5cd7d8);}}catch(_0x2a46a3){console[_0x345096(0x144)](_0x2a46a3),_0x3f19e1[_0x345096(0xf8)](0x1f4)[_0x345096(0xbd)]({'Merror':_0x345096(0xdb),'Message':_0x2a46a3[_0x345096(0x146)]});}})[_0x3ae7bf(0x13a)](_0x4eeb38=>{var _0x54f41e=_0x3ae7bf;console['error'](_0x4eeb38),_0x3f19e1[_0x54f41e(0xf8)](0x1f4)['json']({'Merror':'An\x20error\x20occurred.'});});}catch(_0x32d010){console['log'](_0x32d010);}});function BayBinSelected(_0x14193b,_0x2ad486){var _0x145580=a0_0x19b242,_0x51c760=[],_0x2c099a=[],_0x387210=[],_0x379b59=[],_0x438786=[],_0x2a8a59=[];let _0x122f9d=[];if(_0x14193b==_0x145580(0x9e))switch(_0x2ad486){case _0x145580(0x102):_0x51c760=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2c099a=[0x1,0x2],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=[_0x145580(0x152),_0x145580(0x108)],_0x438786=['D'],_0x2a8a59=['A'];break;case'Rack\x20B':_0x51c760=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2c099a=[0x1,0x2],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=[_0x145580(0x152),_0x145580(0x108)],_0x438786=['D'],_0x2a8a59=['B'];break;case _0x145580(0xdf):_0x51c760=[0x0],_0x2c099a=[0x0],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=[_0x145580(0x108)],_0x438786=['D'],_0x2a8a59=['S'];break;case _0x145580(0xf0):_0x51c760=[0x0],_0x2c099a=[0x0],_0x379b59=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x387210=[_0x145580(0x108)],_0x438786=['D'],_0x2a8a59=['R'];break;}else{if(_0x14193b==_0x145580(0x122))switch(_0x2ad486){case'Rack\x20A':_0x51c760=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2c099a=['B','F'],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=[_0x145580(0x152),_0x145580(0x108)],_0x438786=['C'],_0x2a8a59=['A'];break;case'Rack\x20B':_0x51c760=[0x5,0x4,0x3,0x2,0x1],_0x2c099a=['F','B','S'],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=[_0x145580(0x152),_0x145580(0x108)],_0x438786=['C'],_0x2a8a59=['B'];break;case _0x145580(0x154):_0x51c760=[0x1,0x2,0x3,0x4,0x5],_0x2c099a=['B','F','S'],_0x379b59=[0x5,0x4,0x3,0x2,0x1],_0x387210=[_0x145580(0x152),_0x145580(0x108)],_0x438786=['C'],_0x2a8a59=['C'];break;case _0x145580(0x17c):_0x51c760=[0x5,0x4,0x3,0x2,0x1],_0x2c099a=['F','B','S'],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=['Level','Floor'],_0x438786=['C'],_0x2a8a59=['D'];break;case _0x145580(0x114):_0x51c760=[0x4,0x3,0x2,0x1],_0x2c099a=[0x1,0x2],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=['Level','Floor'],_0x438786=['C'],_0x2a8a59=['E'];break;case _0x145580(0x180):_0x51c760=[0x1,0x2,0x3],_0x2c099a=[0x1,0x2],_0x379b59=[0x1,0x2,0x3,0x4,0x5],_0x387210=[_0x145580(0x152)],_0x438786=['C'],_0x2a8a59=['F'];break;}}return{'levels':_0x51c760,'Isle':_0x2c099a,'rack':_0x379b59,'type':_0x387210,'storage':_0x438786,'rak':_0x2a8a59};}router[a0_0x19b242(0x10b)](a0_0x19b242(0x12b),auth,async(_0x40f54b,_0xbb797b)=>{var _0x5dd358=a0_0x19b242;try{const {username:_0x1adf64,email:_0x18a7c7,role:_0x5ea8bf}=_0x40f54b[_0x5dd358(0x168)],_0x2199a5=_0x40f54b['user'],_0x107376=await profile['findOne']({'email':_0x2199a5['email']}),_0x35d723=await master_shop[_0x5dd358(0xda)](),_0x478e59=await transfers[_0x5dd358(0xaf)](_0x40f54b[_0x5dd358(0x13f)]['id']);let _0x35704d;if(_0x2199a5['role']=='staff'){const _0x33978f=await staff[_0x5dd358(0xde)]({'email':_0x2199a5['email']});_0x35704d=await warehouse[_0x5dd358(0x17a)]([{'$match':{'status':_0x5dd358(0x10e),'name':_0x33978f[_0x5dd358(0x156)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x5dd358(0x182),'name':{'$first':_0x5dd358(0x182)}}}]);}else _0x35704d=await warehouse['aggregate']([{'$match':{'status':_0x5dd358(0x10e),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x5dd358(0x182),'name':{'$first':_0x5dd358(0x182)}}}]);const _0x2b0774=await warehouse[_0x5dd358(0x17a)]([{'$match':{'name':_0x478e59[_0x5dd358(0x120)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x5dd358(0x18d)},{'$group':{'_id':_0x5dd358(0x162),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5dd358(0xa0)},'bay':{'$first':_0x5dd358(0x148)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5dd358(0xce)},'product_code':{'$first':_0x5dd358(0xd2)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5dd358(0x11f)},'expiry_date':{'$first':_0x5dd358(0x181)},'production_date':{'$first':_0x5dd358(0xff)},'room':{'$first':_0x5dd358(0xfc)}}}]),_0x3b54e7=await product[_0x5dd358(0xda)]({}),_0x597416=BayBinSelected(_0x478e59[_0x5dd358(0x12f)],_0x478e59['to_room']);if(_0x35d723[0x0][_0x5dd358(0xb6)]==_0x5dd358(0x140)){var _0x1e7479=users['English'];console[_0x5dd358(0x129)](_0x1e7479);}else{if(_0x35d723[0x0]['language']==_0x5dd358(0xfb))var _0x1e7479=users['Hindi'];else{if(_0x35d723[0x0]['language']==_0x5dd358(0x143))var _0x1e7479=users['German'];else{if(_0x35d723[0x0]['language']=='Spanish')var _0x1e7479=users[_0x5dd358(0x149)];else{if(_0x35d723[0x0][_0x5dd358(0xb6)]==_0x5dd358(0xba))var _0x1e7479=users[_0x5dd358(0xba)];else{if(_0x35d723[0x0][_0x5dd358(0xb6)]==_0x5dd358(0x110))var _0x1e7479=users[_0x5dd358(0x18c)];else{if(_0x35d723[0x0][_0x5dd358(0xb6)]==_0x5dd358(0xa3))var _0x1e7479=users[_0x5dd358(0xa3)];else{if(_0x35d723[0x0][_0x5dd358(0xb6)]=='Arabic\x20(ae)')var _0x1e7479=users[_0x5dd358(0x187)];}}}}}}}_0xbb797b[_0x5dd358(0xac)]('edit_transfer',{'success':_0x40f54b[_0x5dd358(0xb5)]('success'),'errors':_0x40f54b['flash']('errors'),'role':_0x2199a5,'profile':_0x107376,'master_shop':_0x35d723,'warehouse':_0x35704d,'transfer':_0x478e59,'stock':_0x2b0774,'unit':_0x3b54e7,'language':_0x1e7479});}catch(_0x1bdb5f){console[_0x5dd358(0x129)](_0x1bdb5f);}}),router[a0_0x19b242(0xf7)](a0_0x19b242(0x12b),auth,async(_0x1925fd,_0x3e9e4e)=>{var _0x5741c8=a0_0x19b242;try{const _0x5dacdb=_0x1925fd[_0x5741c8(0x13f)]['id'],_0x294010=await transfers[_0x5741c8(0xaf)](_0x5dacdb);_0x3e9e4e[_0x5741c8(0xbd)](_0x1925fd[_0x5741c8(0x12c)]);return;const {date:_0x4d0ca0,from_warehouse:_0xabae8a,FromRoom_name:_0x2a245e,to_warehouse:_0x54a854,ToRoom_name:_0x17249c,prod_name:_0x5d6c3f,from_prod_qty:_0x192284,from_prod_level:_0x10c41a,from_prod_isle:_0x2afb2c,from_prod_pallet:_0x1e55be,to_prod_qty:_0x4b9e3d,to_prod_level:_0x46ec08,to_prod_isle:_0x4bc76d,to_prod_pallet:_0x2c4bb4,primary_code:_0x553443,secondary_code:_0x11d666,product_code3:_0x36a955,note:_0x4c7b78,invoice:_0x1cfc8f,expiry_date:_0x58db34}=_0x1925fd[_0x5741c8(0x12c)];if(typeof _0x5d6c3f=='string')var _0x49d8c1=[_0x1925fd['body']['prod_name']],_0x64cece=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x116)]],_0x5d20d2=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x18a)]],_0x3ae5b1=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x177)]],_0x536b9e=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x173)]],_0x34882f=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xed)]],_0x528cd2=[_0x1925fd['body'][_0x5741c8(0xdc)]],_0x15541f=[_0x1925fd['body'][_0x5741c8(0xb9)]],_0x1d087f=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xca)]],_0x52d16f=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xcc)]],_0x460f1b=[_0x1925fd[_0x5741c8(0x12c)]['to_types']],_0x783b61=[_0x1925fd['body'][_0x5741c8(0x137)]],_0x578acc=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xa4)]],_0x3fe84b=[_0x1925fd['body'][_0x5741c8(0xc6)]],_0x5123d4=[_0x1925fd['body'][_0x5741c8(0x11e)]],_0x580a52=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xbe)]],_0x49aa4d=[_0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xa9)]],_0x5e9c19=[_0x1925fd['body']['unit']],_0x4bea38=[_0x1925fd[_0x5741c8(0x12c)]['secondary_unit']],_0x3f5606=[_0x1925fd[_0x5741c8(0x12c)]['batch_code']],_0x55b8a9=[_0x1925fd['body'][_0x5741c8(0xf9)]],_0x4b5032=[_0x1925fd[_0x5741c8(0x12c)]['from_storage']],_0x5b9a1f=[_0x1925fd['body'][_0x5741c8(0x166)]];else var _0x49d8c1=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xb2)]],_0x783b61=[..._0x1925fd['body'][_0x5741c8(0x137)]],_0x578acc=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xa4)]],_0x34882f=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xed)]],_0x460f1b=[..._0x1925fd['body'][_0x5741c8(0x111)]],_0x64cece=[..._0x1925fd[_0x5741c8(0x12c)]['from_prod_qty']],_0x5d20d2=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x18a)]],_0x3ae5b1=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x177)]],_0x536b9e=[..._0x1925fd['body']['from_prod_pallet']],_0x528cd2=[..._0x1925fd['body'][_0x5741c8(0xdc)]],_0x15541f=[..._0x1925fd['body'][_0x5741c8(0xb9)]],_0x1d087f=[..._0x1925fd[_0x5741c8(0x12c)]['to_prod_isle']],_0x52d16f=[..._0x1925fd[_0x5741c8(0x12c)]['to_prod_pallet']],_0x3fe84b=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xc6)]],_0x5123d4=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x11e)]],_0x580a52=[..._0x1925fd['body'][_0x5741c8(0xbe)]],_0x49aa4d=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xa9)]],_0x5e9c19=[..._0x1925fd['body']['unit']],_0x4bea38=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xfa)]],_0x3f5606=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0xe6)]],_0x55b8a9=[..._0x1925fd['body']['expiry_date']],_0x4b5032=[..._0x1925fd['body']['from_storage']],_0x5b9a1f=[..._0x1925fd[_0x5741c8(0x12c)][_0x5741c8(0x166)]];const _0x1ef878=_0x49d8c1['map'](_0x2dbb46=>{return _0x2dbb46={'product_name':_0x2dbb46};});_0x64cece[_0x5741c8(0xc1)]((_0x3a3d0e,_0x4c24cd)=>{_0x1ef878[_0x4c24cd]['from_quantity']=_0x3a3d0e;}),_0x5d20d2['forEach']((_0x139043,_0x2d986f)=>{var _0x4abe95=_0x5741c8;_0x1ef878[_0x2d986f][_0x4abe95(0x159)]=_0x139043;}),_0x3ae5b1[_0x5741c8(0xc1)]((_0x28072e,_0x4d893c)=>{var _0x4eff4e=_0x5741c8;_0x1ef878[_0x4d893c][_0x4eff4e(0xa1)]=_0x28072e;}),_0x536b9e[_0x5741c8(0xc1)]((_0x1b3b29,_0x1cb0f4)=>{var _0x14f09e=_0x5741c8;_0x1ef878[_0x1cb0f4][_0x14f09e(0xaa)]=_0x1b3b29;}),_0x528cd2[_0x5741c8(0xc1)]((_0x3bb21d,_0x20893a)=>{var _0x15d328=_0x5741c8;_0x1ef878[_0x20893a][_0x15d328(0x14b)]=_0x3bb21d;}),_0x15541f[_0x5741c8(0xc1)]((_0x4f67b9,_0x1e258a)=>{var _0x1b23dc=_0x5741c8;_0x1ef878[_0x1e258a][_0x1b23dc(0x132)]=_0x4f67b9;}),_0x1d087f[_0x5741c8(0xc1)]((_0x4ce348,_0x4aa0e7)=>{var _0x142f7e=_0x5741c8;_0x1ef878[_0x4aa0e7][_0x142f7e(0xcf)]=_0x4ce348;}),_0x52d16f[_0x5741c8(0xc1)]((_0x1197ec,_0x16991c)=>{var _0x4f6227=_0x5741c8;_0x1ef878[_0x16991c][_0x4f6227(0x15f)]=_0x1197ec;}),_0x3fe84b[_0x5741c8(0xc1)]((_0x37e16f,_0x13b07e)=>{_0x1ef878[_0x13b07e]['primary_code']=_0x37e16f;}),_0x5123d4[_0x5741c8(0xc1)]((_0x13e7b8,_0x1d6df2)=>{var _0xf6340b=_0x5741c8;_0x1ef878[_0x1d6df2][_0xf6340b(0x11e)]=_0x13e7b8;}),_0x580a52[_0x5741c8(0xc1)]((_0x1ab5b4,_0x18031a)=>{var _0x5c947d=_0x5741c8;_0x1ef878[_0x18031a][_0x5c947d(0x16e)]=_0x1ab5b4;}),_0x49aa4d[_0x5741c8(0xc1)]((_0x3b8cf1,_0x560d30)=>{var _0x2ad249=_0x5741c8;_0x1ef878[_0x560d30][_0x2ad249(0xbf)]=_0x3b8cf1;}),_0x5e9c19[_0x5741c8(0xc1)]((_0x32b2c8,_0x1ea22a)=>{_0x1ef878[_0x1ea22a]['unit']=_0x32b2c8;}),_0x4bea38[_0x5741c8(0xc1)]((_0x1659e8,_0x20e711)=>{var _0xd0c405=_0x5741c8;_0x1ef878[_0x20e711][_0xd0c405(0xfa)]=_0x1659e8;}),_0x3f5606[_0x5741c8(0xc1)]((_0x47cd4c,_0x440699)=>{_0x1ef878[_0x440699]['batch_code']=_0x47cd4c;}),_0x55b8a9[_0x5741c8(0xc1)]((_0x9dfba5,_0x56f61f)=>{var _0x5b9008=_0x5741c8;_0x1ef878[_0x56f61f][_0x5b9008(0xf9)]=_0x9dfba5;}),_0x783b61['forEach']((_0x1114d1,_0x1825c3)=>{var _0x7dd734=_0x5741c8;_0x1ef878[_0x1825c3][_0x7dd734(0x137)]=_0x1114d1;}),_0x578acc['forEach']((_0x267b49,_0x38640e)=>{_0x1ef878[_0x38640e]['rack']=_0x267b49;}),_0x34882f['forEach']((_0x3e67d6,_0x47eb51)=>{var _0x111b1b=_0x5741c8;_0x1ef878[_0x47eb51][_0x111b1b(0xed)]=_0x3e67d6;}),_0x460f1b[_0x5741c8(0xc1)]((_0x1a94f6,_0x52896c)=>{_0x1ef878[_0x52896c]['to_types']=_0x1a94f6;}),_0x4b5032[_0x5741c8(0xc1)]((_0x37cb9c,_0x25a419)=>{var _0x479437=_0x5741c8;_0x1ef878[_0x25a419][_0x479437(0xd9)]=_0x37cb9c;}),_0x5b9a1f[_0x5741c8(0xc1)]((_0x405dfa,_0x53b7ec)=>{var _0x3ccea3=_0x5741c8;_0x1ef878[_0x53b7ec][_0x3ccea3(0x15a)]=_0x405dfa;});const _0x1bc0af=_0x1ef878[_0x5741c8(0x163)](_0x126311=>_0x126311[_0x5741c8(0x14b)]!=='0'&&_0x126311[_0x5741c8(0x14b)]!==''||_0x126311[_0x5741c8(0x15f)]!=='0'&&_0x126311[_0x5741c8(0x15f)]!=='');var _0x2be96d=0x0;_0x1bc0af[_0x5741c8(0xc1)](_0x56f2d4=>{var _0x293e66=_0x5741c8;parseInt(_0x56f2d4['from_quantity'])<parseInt(_0x56f2d4[_0x293e66(0x14b)])&&_0x2be96d++;});if(_0x2be96d!=0x0)return _0x1925fd[_0x5741c8(0xb5)]('errors',_0x5741c8(0x161)),_0x3e9e4e['redirect'](_0x5741c8(0x115));const _0x1bb16a=await warehouse[_0x5741c8(0xde)]({'name':_0x294010[_0x5741c8(0x120)],'room':_0x294010[_0x5741c8(0x15d)]});_0x294010['product']['forEach'](_0x125d48=>{var _0x4c83bc=_0x5741c8;if(_0x125d48[_0x4c83bc(0x14b)]>0x0){const _0x42876f=_0x1bb16a[_0x4c83bc(0x184)][_0x4c83bc(0xb0)](_0x1035e9=>{var _0x1dbc9d=_0x4c83bc;_0x1035e9['product_name']==_0x125d48['product_name']&&_0x1035e9['floorlevel']==_0x125d48[_0x1dbc9d(0xaa)]&&_0x1035e9[_0x1dbc9d(0x145)]==_0x125d48[_0x1dbc9d(0xed)]&&_0x1035e9[_0x1dbc9d(0x13d)]==_0x125d48[_0x1dbc9d(0xa1)]&&_0x1035e9[_0x1dbc9d(0x105)]==_0x125d48['from_bay']&&_0x1035e9[_0x1dbc9d(0x125)]==_0x125d48['from_rack']&&_0x1035e9[_0x1dbc9d(0x137)]==_0x125d48['from_storage']&&(_0x1035e9[_0x1dbc9d(0x135)]=parseInt(_0x1035e9[_0x1dbc9d(0x135)])+parseInt(_0x125d48[_0x1dbc9d(0x14b)]));});}}),await _0x1bb16a[_0x5741c8(0xcb)]();const _0x5e8061=await warehouse[_0x5741c8(0xde)]({'name':_0x294010['to_warehouse'],'room':_0x294010[_0x5741c8(0xa2)]});_0x294010[_0x5741c8(0x134)][_0x5741c8(0xc1)](_0x5eb173=>{var _0x2f37a0=_0x5741c8;if(_0x5eb173[_0x2f37a0(0x14b)]>0x0){const _0x313227=_0x5e8061[_0x2f37a0(0x184)][_0x2f37a0(0xb0)](_0x3d311e=>{var _0x29f642=_0x2f37a0;_0x3d311e[_0x29f642(0x141)]==_0x5eb173[_0x29f642(0x141)]&&_0x3d311e[_0x29f642(0xa7)]==_0x5eb173['to_floorlevel']&&_0x3d311e[_0x29f642(0x145)]==_0x5eb173[_0x29f642(0x111)]&&_0x3d311e[_0x29f642(0x13d)]==_0x5eb173['to_bin']&&_0x3d311e['bay']==_0x5eb173[_0x29f642(0x132)]&&_0x3d311e[_0x29f642(0x125)]==_0x5eb173[_0x29f642(0x125)]&&_0x3d311e[_0x29f642(0x137)]==_0x5eb173[_0x29f642(0x137)]&&(_0x3d311e['product_stock']=parseInt(_0x3d311e[_0x29f642(0x135)])-parseInt(_0x5eb173[_0x29f642(0x14b)]));});}}),await _0x5e8061[_0x5741c8(0xcb)](),_0x294010['date']=_0x4d0ca0,_0x294010[_0x5741c8(0x120)]=_0xabae8a,_0x294010[_0x5741c8(0x12f)]=_0x54a854,_0x294010['product']=_0x1bc0af,_0x294010['note']=_0x4c7b78,_0x294010[_0x5741c8(0x153)]=_0x1cfc8f;const _0x4f98f0=await _0x294010['save']();console[_0x5741c8(0x129)](_0x4f98f0);const _0x2c4c4e=await warehouse['findOne']({'name':_0xabae8a,'room':_0x2a245e});_0x4f98f0[_0x5741c8(0x134)][_0x5741c8(0xc1)](_0xff4135=>{var _0x52f74e=_0x5741c8;if(_0xff4135[_0x52f74e(0x14b)]>0x0){const _0x5c7b74=_0x2c4c4e[_0x52f74e(0x184)][_0x52f74e(0xb0)](_0x55bc16=>{var _0x34a071=_0x52f74e;_0x55bc16[_0x34a071(0x141)]==_0xff4135[_0x34a071(0x141)]&&_0x55bc16[_0x34a071(0xa7)]==_0xff4135['from_floorlevel']&&_0x55bc16[_0x34a071(0x145)]==_0xff4135['from_types']&&_0x55bc16['bin']==_0xff4135[_0x34a071(0xa1)]&&_0x55bc16[_0x34a071(0x105)]==_0xff4135['from_bay']&&_0x55bc16[_0x34a071(0x125)]==_0xff4135[_0x34a071(0x15a)]&&_0x55bc16[_0x34a071(0x137)]==_0xff4135[_0x34a071(0xd9)]&&(_0x55bc16[_0x34a071(0x135)]=parseInt(_0x55bc16[_0x34a071(0x135)])-parseInt(_0xff4135[_0x34a071(0x14b)]));});}}),await _0x2c4c4e[_0x5741c8(0xcb)]();const _0x406108=await warehouse[_0x5741c8(0xde)]({'name':_0x54a854,'room':_0x17249c});_0x4f98f0[_0x5741c8(0x134)][_0x5741c8(0xc1)](_0x4f0038=>{var _0x20fb40=_0x5741c8;if(_0x4f0038[_0x20fb40(0x14b)]>0x0){var _0xc6e543=0x0;const _0x15e873=_0x406108[_0x20fb40(0x184)][_0x20fb40(0xb0)](_0x4e7124=>{var _0x453907=_0x20fb40;_0x4e7124[_0x453907(0x141)]==_0x4f0038[_0x453907(0x141)]&&_0x4e7124[_0x453907(0xa7)]==_0x4f0038[_0x453907(0x15f)]&&_0x4e7124[_0x453907(0x145)]==_0x4f0038['to_types']&&_0x4e7124[_0x453907(0x13d)]==_0x4f0038['to_bin']&&_0x4e7124[_0x453907(0x105)]==_0x4f0038[_0x453907(0x132)]&&_0x4e7124['rack']==_0x4f0038[_0x453907(0x125)]&&_0x4e7124[_0x453907(0x137)]==_0x4f0038[_0x453907(0x137)]&&(_0x4e7124[_0x453907(0x135)]=parseInt(_0x4e7124[_0x453907(0x135)])+parseInt(_0x4f0038[_0x453907(0x14b)]),_0xc6e543++);});_0xc6e543=='0'&&(_0x406108[_0x20fb40(0x184)]=_0x406108['product_details'][_0x20fb40(0x121)]({'product_name':_0x4f0038[_0x20fb40(0x141)],'product_stock':_0x4f0038[_0x20fb40(0x14b)],'bay':_0x4f0038['to_bay'],'bin':_0x4f0038[_0x20fb40(0xcf)],'type':_0x4f0038['to_types'],'floorlevel':_0x4f0038['to_floorlevel'],'storage':_0x4f0038[_0x20fb40(0x137)],'rack':_0x4f0038[_0x20fb40(0x125)],'product_code':_0x4f0038['product_code'],'primary_code':_0x4f0038[_0x20fb40(0xc6)],'secondary_code':_0x4f0038['secondary_code'],'maxProducts':_0x4f0038[_0x20fb40(0xbf)],'storage':_0x4f0038[_0x20fb40(0x137)],'rack':_0x4f0038[_0x20fb40(0x125)]}));}}),await _0x406108[_0x5741c8(0xcb)](),_0x1925fd[_0x5741c8(0xb5)](_0x5741c8(0x13c),_0x5741c8(0xd8)),_0x3e9e4e[_0x5741c8(0x178)](_0x5741c8(0xb3));}catch(_0x16aa1a){console[_0x5741c8(0x129)](_0x16aa1a);}}),router['post'](a0_0x19b242(0x179),async(_0x25faa0,_0x5eaef6)=>{var _0x4f93ff=a0_0x19b242;const {FromWareHouse:_0x33459c,FromRoom:_0x30dabb,ToWarehouse:_0x39a2d0,ToRoom:_0x5443dc,primary_code:_0x3a52af,Roomslist:_0xa88271}=_0x25faa0[_0x4f93ff(0x12c)],_0x8e5a4c=_0xa88271[_0x4f93ff(0xae)](','),_0x1d8631=[];async function _0x4b9bb6(_0x4658e5){var _0xa7782e=_0x4f93ff;const _0x33333d=await warehouse[_0xa7782e(0x17a)]([{'$match':{'name':_0x33459c,'room':_0x4658e5}},{'$unwind':_0xa7782e(0x18d)},{'$match':{'product_details.primary_code':_0x3a52af}},{'$group':{'_id':_0xa7782e(0x162),'name':{'$first':_0xa7782e(0xcd)},'instock':{'$first':_0xa7782e(0xa0)},'primary_code':{'$first':_0xa7782e(0x14c)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xa7782e(0xd2)},'level':{'$first':_0xa7782e(0x148)},'isle':{'$first':_0xa7782e(0x160)},'type':{'$first':_0xa7782e(0x136)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0xa7782e(0x119)},'secondary_unit':{'$first':_0xa7782e(0x155)},'storage':{'$first':_0xa7782e(0xc0)},'rack':{'$first':_0xa7782e(0x11f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xa7782e(0xff)},'batch_code':{'$first':_0xa7782e(0xdd)},'maxPerUnit':{'$first':_0xa7782e(0xe3)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0xa7782e(0xfc)},'maxProducts':{'$first':_0xa7782e(0xab)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x4306ed=await warehouse[_0xa7782e(0x17a)]([{'$match':{'name':_0x33459c,'room':_0x4658e5}},{'$unwind':_0xa7782e(0x18d)},{'$match':{'product_details.secondary_code':_0x3a52af}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0xa7782e(0xa0)},'primary_code':{'$first':_0xa7782e(0x14c)},'secondary_code':{'$first':_0xa7782e(0xce)},'product_code':{'$first':_0xa7782e(0xd2)},'level':{'$first':_0xa7782e(0x148)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xa7782e(0x136)},'pallet':{'$first':_0xa7782e(0xb8)},'unit':{'$first':_0xa7782e(0x119)},'secondary_unit':{'$first':_0xa7782e(0x155)},'storage':{'$first':_0xa7782e(0xc0)},'rack':{'$first':_0xa7782e(0x11f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xa7782e(0xff)},'batch_code':{'$first':_0xa7782e(0xdd)},'maxPerUnit':{'$first':_0xa7782e(0xe3)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0xa7782e(0xfc)},'maxProducts':{'$first':_0xa7782e(0xab)},'invoice_product':{'$first':_0xa7782e(0xad)}}}]);if(_0x33333d[_0xa7782e(0x17f)]>0x0)_0x1d8631[_0xa7782e(0xf2)](_0x33333d);else _0x4306ed['length']>0x0&&_0x1d8631['push'](_0x4306ed);}const _0x4196f6=_0x8e5a4c[_0x4f93ff(0xb0)](_0x57d7f8=>_0x4b9bb6(_0x57d7f8));await Promise[_0x4f93ff(0x16b)](_0x4196f6),_0x5eaef6[_0x4f93ff(0xbd)](_0x1d8631);}),router[a0_0x19b242(0xf7)](a0_0x19b242(0xb4),async(_0x5b0954,_0x1ac5c7)=>{var _0x51ca57=a0_0x19b242;try{const {FromWareHouse:_0x5caee7,FromRoom:_0x2f5395,ToWarehouse:_0x582e37,ToRoom:_0x286cca,secondary_code:_0x27f6bf}=_0x5b0954[_0x51ca57(0x12c)],_0xf7af0c=await warehouse['aggregate']([{'$match':{'name':_0x5caee7}},{'$unwind':_0x51ca57(0x18d)},{'$match':{'product_details.secondary_code':_0x27f6bf}},{'$group':{'_id':_0x51ca57(0x162),'name':{'$first':_0x51ca57(0xcd)},'primary_code':{'$first':_0x51ca57(0x14c)},'secondary_code':{'$first':_0x51ca57(0xce)},'product_code':{'$first':_0x51ca57(0xd2)},'instock':{'$first':_0x51ca57(0xa0)},'warehouse':{'$first':_0x51ca57(0x182)},'level':{'$first':_0x51ca57(0x103)},'isle':{'$first':_0x51ca57(0xe4)},'pallet':{'$first':_0x51ca57(0xd3)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x51ca57(0x119)}}}]);_0x1ac5c7['status'](0xc8)['json'](_0xf7af0c);}catch(_0x173933){_0x1ac5c7[_0x51ca57(0xf8)](0x194)[_0x51ca57(0xbd)]({'message':_0x173933[_0x51ca57(0x146)]});}}),router[a0_0x19b242(0xf7)](a0_0x19b242(0xee),async(_0x21b048,_0x43670f)=>{var _0x41ea93=a0_0x19b242;try{const {FromWareHouse:_0x24f32a,FromRoom:_0x2012a7,ToWarehouse:_0x551295,ToRoom:_0x243d9f,product_code:_0x297103}=_0x21b048['body'],_0x3177a2=await warehouse[_0x41ea93(0x17a)]([{'$match':{'name':_0x24f32a}},{'$unwind':_0x41ea93(0x18d)},{'$match':{'product_details.product_code':_0x297103}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x41ea93(0x14c)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x41ea93(0xd2)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x41ea93(0x103)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0x43670f[_0x41ea93(0xf8)](0xc8)[_0x41ea93(0xbd)](_0x3177a2);}catch(_0x1d9f73){_0x43670f[_0x41ea93(0xf8)](0x194)['json']({'message':_0x1d9f73['message']});}}),router[a0_0x19b242(0xf7)](a0_0x19b242(0x17e),async(_0x49b46e,_0x205876)=>{var _0xcc00cc=a0_0x19b242;const {level:_0x33a90e,isle:_0x11501c,pallet:_0x483fc3,warehouses:_0x1a4bbf,room:_0x5afbcb}=_0x49b46e[_0xcc00cc(0x12c)];try{const _0x1ee49b=await warehouse['aggregate']([{'$match':{'name':_0x1a4bbf,'room':_0x5afbcb}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x33a90e),'product_details.isle':_0x11501c,'product_details.pallet':parseInt(_0x483fc3)}},{'$group':{'_id':_0xcc00cc(0x162),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xcc00cc(0xa0)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0xcc00cc(0xe4)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0xcc00cc(0xab)}}}]);_0x205876[_0xcc00cc(0xf8)](0xc8)[_0xcc00cc(0xbd)](_0x1ee49b);}catch(_0xf6a1c7){_0x205876[_0xcc00cc(0xf8)](0x194)['json']({'message':_0xf6a1c7[_0xcc00cc(0x146)]});}}),module[a0_0x19b242(0x11c)]=router;