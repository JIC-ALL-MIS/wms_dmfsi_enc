var a0_0x37e73e=a0_0x16d3;function a0_0x1631(){var _0x2c487a=['An\x20error\x20occurred.','</td>','Spanish','<tr>','to_prod_qty','</body></html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','primary_code','from_quantity','rack','Shelves','/view','findById','</table>','$product_details.level','length','Rack\x20E','to_quantity','render','logo','exports','Rack\x20A','COLD\x20STORAGE','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','flash','from_floorlevel','$product_details.expiry_date','to_invoice','3GtCyWV','ToRoomAssigned','To_invoice','rak','staff','max_per_unit','edit_transfer_view','</tbody>','/barcode_scanner3','$product_details._id','$product_details.type','Rack\x20C','production_date','expiry_date','push','master','$product_details.primary_code','/upload/','filter','There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_rack','$product_details.bin','back','770441sGTrZA','type','Error\x20Occurs','catch','user','to_prod_level','Portuguese','forEach','status','toString','$product_details.bay','transfer','TRF-','\x20Order\x20Number\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$name','/barcode_scanner2','True','slice','to_warehouse','French','Level','to_prod_pallet','<!DOCTYPE\x20html>','$product_details.floorlevel','../models/all_models','json','$product_details.product_code','port','error','getMonth','$product_details','English','$product_details.product_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</h5>','concat','split','4008232TTmzOh','random','all','message','RoomAssigned','MaxStocks_data2','find','<h5\x20style=\x22text-align:\x20left;\x22>','Arabic\x20(ae)','</thead>','$product_details.secondary_unit','<strong>\x20Regards\x20</strong>','Receiving\x20Area','$to_warehouse','$product_details.maxProducts','<div>','RMSEmail','German','warehouse','Rack\x20B','<html><head><title></title>','/preview/:id','477380CDICyE','$product_details.batch_code','language','product','Logo.png','Raw\x20Materials','$product_details.maxPerUnit','<hr\x20class=\x22my-3\x22>','product_details','5611032JhGCOA','updateOne','product_name','map','from_room_name','invoice','Rack\x20D','/transfer/view','to_room','from_bin','redirect','unit','findOne','Arabic','then','\x20Order\x20Date\x20:\x20','/../public','floorlevel','$product_details.isle','from_rak','secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','to_types','from_prod_qty','from_prod_isle','to_room_name','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','get','Return\x20Rooms','maxProducts','product_code3','$isAllowEdit','Floor','bin','</div>','batch_code','email','\x20</h2>','getFullYear','Portuguese\x20(BR)','Router','$product_details.storage','body','Hindi','from_bay','prod_cat','25wBKUrh','site_title','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/barcode_scanner','New_Qty_Converted','</head><body>','/view/:id','to_bay','1410106dITFmq','bay','to_prod_isle','express','product_code','note','product_stock','from_prod_pallet','Transfer\x20Edit\x20Successfully','to_bin','$product_details.rack','Email\x20sent\x20successfully','aggregate','/transfer/preview/','/picking_list/PDF_transfer_rm/','to_floorlevel','role','</tr>','188538aQxgKM','host','prod_name','nodemailer','$invoice','Enabled','6315239GnZEhY','Ambient','string','$product_details.product_stock','createTransport','_id','from_storage','maxperunit','$product_details.secondary_code','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$room','post','<span\x20style=\x22float:\x20right;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product.to_room_name','$product_details.unit','Chinese','from_prod_level','Transfer\x20Finalize\x20Successfully','from_types','getDate','image','success','password','$product','from_room','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.production_date','storage','errors','log','secondary_unit','from_invoice','params','$product_details.pallet','save','English\x20(US)','$finalize','from_warehouse'];a0_0x1631=function(){return _0x2c487a;};return a0_0x1631();}(function(_0x1e2197,_0x98ca9e){var _0x2adaa3=a0_0x16d3,_0x30cd91=_0x1e2197();while(!![]){try{var _0xf90478=parseInt(_0x2adaa3(0x20a))/0x1+-parseInt(_0x2adaa3(0x198))/0x2*(-parseInt(_0x2adaa3(0x1f3))/0x3)+-parseInt(_0x2adaa3(0x159))/0x4*(parseInt(_0x2adaa3(0x190))/0x5)+parseInt(_0x2adaa3(0x1aa))/0x6+parseInt(_0x2adaa3(0x1b0))/0x7+-parseInt(_0x2adaa3(0x143))/0x8+-parseInt(_0x2adaa3(0x162))/0x9;if(_0xf90478===_0x98ca9e)break;else _0x30cd91['push'](_0x30cd91['shift']());}catch(_0x24cc7f){_0x30cd91['push'](_0x30cd91['shift']());}}}(a0_0x1631,0xa7f14));const express=require(a0_0x37e73e(0x19b)),app=express(),router=express[a0_0x37e73e(0x18a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x37e73e(0x223)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x37e73e(0x1ad));router[a0_0x37e73e(0x17d)](a0_0x37e73e(0x1e2),auth,async(_0x539be4,_0x4a38e0)=>{var _0x2b5e3a=a0_0x37e73e;try{const {username:_0x3eba2d,email:_0x548030,role:_0x2664e4}=_0x539be4[_0x2b5e3a(0x20e)],_0x515e20=_0x539be4[_0x2b5e3a(0x20e)],_0x52debd=await profile[_0x2b5e3a(0x16e)]({'email':_0x515e20[_0x2b5e3a(0x186)]}),_0x10d1e1=await master_shop['find']();console[_0x2b5e3a(0x1ce)](_0x2b5e3a(0x202),_0x10d1e1);let _0x5202f2;if(_0x515e20[_0x2b5e3a(0x1a8)]=='staff'){const _0x417305=await staff[_0x2b5e3a(0x16e)]({'email':_0x515e20[_0x2b5e3a(0x186)]});_0x5202f2=await transfers[_0x2b5e3a(0x149)]({'from_warehouse':_0x417305['warehouse']});}else _0x5202f2=await transfers['aggregate']([{'$unwind':_0x2b5e3a(0x1c8)},{'$group':{'_id':'$_id','invoice':{'$first':_0x2b5e3a(0x1ae)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x2b5e3a(0x150)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x2b5e3a(0x1be)},'finalize':{'$first':_0x2b5e3a(0x1d5)},'isAllowEdit':{'$first':_0x2b5e3a(0x181)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x10d1e1[0x0][_0x2b5e3a(0x15b)]=='English\x20(US)'){var _0x2c73f0=users[_0x2b5e3a(0x22a)];console[_0x2b5e3a(0x1ce)](_0x2c73f0);}else{if(_0x10d1e1[0x0]['language']=='Hindi')var _0x2c73f0=users[_0x2b5e3a(0x18d)];else{if(_0x10d1e1[0x0][_0x2b5e3a(0x15b)]==_0x2b5e3a(0x154))var _0x2c73f0=users[_0x2b5e3a(0x154)];else{if(_0x10d1e1[0x0][_0x2b5e3a(0x15b)]==_0x2b5e3a(0x1d9))var _0x2c73f0=users['Spanish'];else{if(_0x10d1e1[0x0][_0x2b5e3a(0x15b)]==_0x2b5e3a(0x21e))var _0x2c73f0=users[_0x2b5e3a(0x21e)];else{if(_0x10d1e1[0x0][_0x2b5e3a(0x15b)]==_0x2b5e3a(0x189))var _0x2c73f0=users[_0x2b5e3a(0x210)];else{if(_0x10d1e1[0x0][_0x2b5e3a(0x15b)]=='Chinese')var _0x2c73f0=users['Chinese'];else{if(_0x10d1e1[0x0][_0x2b5e3a(0x15b)]==_0x2b5e3a(0x14b))var _0x2c73f0=users[_0x2b5e3a(0x16f)];}}}}}}}_0x4a38e0[_0x2b5e3a(0x1e9)](_0x2b5e3a(0x215),{'success':_0x539be4[_0x2b5e3a(0x1ef)](_0x2b5e3a(0x1c6)),'errors':_0x539be4['flash'](_0x2b5e3a(0x1cd)),'role':_0x515e20,'profile':_0x52debd,'master_shop':_0x10d1e1,'transfer':_0x5202f2,'language':_0x2c73f0});}catch(_0x38820c){console[_0x2b5e3a(0x1ce)](_0x38820c);}});function a0_0x16d3(_0x44f5f0,_0xbdb12e){var _0x1631d4=a0_0x1631();return a0_0x16d3=function(_0x16d3f6,_0x588b4f){_0x16d3f6=_0x16d3f6-0x142;var _0x5b2123=_0x1631d4[_0x16d3f6];return _0x5b2123;},a0_0x16d3(_0x44f5f0,_0xbdb12e);}async function getRandom8DigitNumber(){var _0x5a472e=a0_0x37e73e;const _0x518971=0x989680,_0x3366ad=0x5f5e0ff,_0x509233=Math['floor'](Math[_0x5a472e(0x144)]()*(_0x3366ad-_0x518971+0x1))+_0x518971;var _0x1e56cf;const _0x39c5d1=await transfers['findOne']({'invoice':_0x5a472e(0x216)+_0x509233});return _0x39c5d1&&_0x39c5d1[_0x5a472e(0x1e6)]>0x0?_0x1e56cf=_0x5a472e(0x216)+_0x509233:_0x1e56cf='TRF-'+_0x509233,_0x1e56cf;}router[a0_0x37e73e(0x17d)]('/view/add_transfer',auth,async(_0x377bcd,_0x9f91ca)=>{var _0x14b9c7=a0_0x37e73e;try{const {username:_0x87f428,email:_0x3f16a0,role:_0xef0b11}=_0x377bcd[_0x14b9c7(0x20e)],_0x240f61=_0x377bcd['user'],_0x12dcf8=await profile['findOne']({'email':_0x240f61['email']}),_0xff654d=await master_shop[_0x14b9c7(0x149)]();console[_0x14b9c7(0x1ce)]('master',_0xff654d);let _0x2ed06a;if(_0x240f61[_0x14b9c7(0x1a8)]==_0x14b9c7(0x1f7)){const _0x698a40=await staff['findOne']({'email':_0x240f61[_0x14b9c7(0x186)]});_0x2ed06a=await warehouse[_0x14b9c7(0x1a4)]([{'$match':{'status':'Enabled','name':_0x698a40[_0x14b9c7(0x155)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x14b9c7(0x219),'name':{'$first':_0x14b9c7(0x219)}}}]);}else _0x2ed06a=await warehouse[_0x14b9c7(0x1a4)]([{'$match':{'status':'Enabled','warehouse_category':_0x14b9c7(0x15e)}},{'$group':{'_id':_0x14b9c7(0x219),'name':{'$first':'$name'}}}]);var _0x56f718=[_0x14b9c7(0x1b1),'Enclosed',_0x14b9c7(0x17e)];const _0x43e230=await transfers[_0x14b9c7(0x149)]({}),_0x25084b=_0x43e230[_0x14b9c7(0x1e6)]+0x1,_0x23adff=_0x14b9c7(0x216)+_0x25084b[_0x14b9c7(0x213)]()['padStart'](0x5,'0');if(_0xff654d[0x0][_0x14b9c7(0x15b)]==_0x14b9c7(0x1d4)){var _0x4387db=users[_0x14b9c7(0x22a)];console[_0x14b9c7(0x1ce)](_0x4387db);}else{if(_0xff654d[0x0]['language']==_0x14b9c7(0x18d))var _0x4387db=users['Hindi'];else{if(_0xff654d[0x0][_0x14b9c7(0x15b)]==_0x14b9c7(0x154))var _0x4387db=users['German'];else{if(_0xff654d[0x0]['language']==_0x14b9c7(0x1d9))var _0x4387db=users[_0x14b9c7(0x1d9)];else{if(_0xff654d[0x0]['language']==_0x14b9c7(0x21e))var _0x4387db=users['French'];else{if(_0xff654d[0x0][_0x14b9c7(0x15b)]==_0x14b9c7(0x189))var _0x4387db=users[_0x14b9c7(0x210)];else{if(_0xff654d[0x0]['language']==_0x14b9c7(0x1c0))var _0x4387db=users[_0x14b9c7(0x1c0)];else{if(_0xff654d[0x0][_0x14b9c7(0x15b)]=='Arabic\x20(ae)')var _0x4387db=users[_0x14b9c7(0x16f)];}}}}}}}const _0x4720a2=getRandom8DigitNumber();_0x4720a2[_0x14b9c7(0x170)](_0x26a93e=>{var _0x2beb71=_0x14b9c7;_0x9f91ca[_0x2beb71(0x1e9)]('add_transfer',{'success':_0x377bcd[_0x2beb71(0x1ef)](_0x2beb71(0x1c6)),'errors':_0x377bcd[_0x2beb71(0x1ef)](_0x2beb71(0x1cd)),'role':_0x240f61,'profile':_0x12dcf8,'master_shop':_0xff654d,'warehouse':_0x2ed06a,'language':_0x4387db,'rooms_data':_0x56f718,'invoice':_0x26a93e});})['catch'](_0x9e86fe=>{var _0x23c2ae=_0x14b9c7;_0x377bcd[_0x23c2ae(0x1ef)](_0x23c2ae(0x1cd),_0x23c2ae(0x206)),_0x9f91ca[_0x23c2ae(0x16c)](_0x23c2ae(0x169));});}catch(_0x5b944a){console[_0x14b9c7(0x1ce)](_0x5b944a);}}),router[a0_0x37e73e(0x1bb)]('/view/add_transfer',auth,async(_0x484a56,_0x450e85)=>{var _0x1a24f4=a0_0x37e73e;try{console[_0x1a24f4(0x1ce)](_0x484a56[_0x1a24f4(0x18c)]);const {date:_0x330623,from_warehouse:_0x4a3c17,FromRoom_name:_0x2bfab5,to_warehouse:_0x421e94,ToRoom_name:_0x30075c,prod_name:_0x5a1294,from_prod_qty:_0x30235c,from_prod_level:_0x2c8681,from_prod_isle:_0x1ce7c7,from_prod_pallet:_0x91398f,to_prod_qty:_0x94afc1,to_prod_level:_0x3545d5,to_prod_isle:_0x3e533c,to_prod_pallet:_0x45a9a2,primary_code:_0x3ea3d6,secondary_code:_0x2b06ca,product_code3:_0xce41f1,note:_0x468b7c,MaxStocks_data2:_0x223234,invoice:_0x230b2f,expiry_date:_0x3441fb}=_0x484a56[_0x1a24f4(0x18c)];if(typeof _0x5a1294==_0x1a24f4(0x1b2))var _0x3ff732=[_0x484a56[_0x1a24f4(0x18c)]['prod_name']],_0x36d4ed=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x179)]],_0x5dfce5=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1c1)]],_0xb3ed6c=[_0x484a56[_0x1a24f4(0x18c)]['New_Qty_Converted']],_0xd579db=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x20f)]],_0x5ebf47=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1de)]],_0x48a991=[_0x484a56[_0x1a24f4(0x18c)]['secondary_code']],_0x289063=[_0x484a56[_0x1a24f4(0x18c)]['product_code3']],_0x3843a0=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x148)]],_0x338a0d=[_0x484a56[_0x1a24f4(0x18c)]['primary_unit']],_0x5ed717=[_0x484a56['body'][_0x1a24f4(0x1cf)]],_0x5697d8=[_0x484a56['body'][_0x1a24f4(0x185)]],_0x392454=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x200)]],_0x5bf1c3=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1f8)]],_0x45aec5=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1ff)]],_0x256991=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x18f)]],_0x23e7eb=[_0x484a56['body'][_0x1a24f4(0x147)]],_0xc7606b=[_0x484a56['body'][_0x1a24f4(0x1f4)]],_0x45965b=[_0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1d0)]],_0x5e63ee=[_0x484a56[_0x1a24f4(0x18c)]['to_invoice']];else var _0x3ff732=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1ac)]],_0x36d4ed=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x179)]],_0x5dfce5=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1c1)]],_0xb3ed6c=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x194)]],_0xd579db=[..._0x484a56[_0x1a24f4(0x18c)]['to_prod_level']],_0x5ebf47=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1de)]],_0x48a991=[..._0x484a56[_0x1a24f4(0x18c)]['secondary_code']],_0x289063=[..._0x484a56['body']['product_code3']],_0x3843a0=[..._0x484a56[_0x1a24f4(0x18c)]['MaxStocks_data2']],_0x338a0d=[..._0x484a56[_0x1a24f4(0x18c)]['primary_unit']],_0x5ed717=[..._0x484a56[_0x1a24f4(0x18c)]['secondary_unit']],_0x5697d8=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x185)]],_0x392454=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x200)]],_0x5bf1c3=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1f8)]],_0x45aec5=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1ff)]],_0x256991=[..._0x484a56['body'][_0x1a24f4(0x18f)]],_0x23e7eb=[..._0x484a56['body']['RoomAssigned']],_0xc7606b=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1f4)]],_0x45965b=[..._0x484a56['body'][_0x1a24f4(0x1d0)]],_0x5e63ee=[..._0x484a56[_0x1a24f4(0x18c)][_0x1a24f4(0x1f2)]];const _0x1a7f94=_0x3ff732[_0x1a24f4(0x165)](_0x43aac6=>{return _0x43aac6={'product_name':_0x43aac6};});_0x36d4ed[_0x1a24f4(0x211)]((_0x4901fa,_0x18cd4f)=>{_0x1a7f94[_0x18cd4f]['from_quantity']=_0x4901fa;}),_0x45965b[_0x1a24f4(0x211)]((_0x4ddde5,_0x5e1e20)=>{var _0x267a64=_0x1a24f4;_0x1a7f94[_0x5e1e20][_0x267a64(0x1d0)]=_0x4ddde5;}),_0x5e63ee[_0x1a24f4(0x211)]((_0x44b35a,_0x23c35b)=>{var _0xd16701=_0x1a24f4;_0x1a7f94[_0x23c35b][_0xd16701(0x1f5)]=_0x44b35a;}),_0x5dfce5[_0x1a24f4(0x211)]((_0x2bfffe,_0x387899)=>{var _0x371e50=_0x1a24f4;_0x23e7eb[_0x371e50(0x211)]((_0x452a2b,_0xf2558a)=>{var _0x526498=_0x371e50;if(_0x452a2b==_0x526498(0x14f)&&_0x387899==_0xf2558a){var _0xf59ded=_0x2bfffe[_0x526498(0x21c)](0x3);_0x1a7f94[_0x387899]['from_storage']=_0x2bfffe[0x0],_0x1a7f94[_0x387899]['from_rack']=_0x2bfffe[0x1],_0x1a7f94[_0x387899][_0x526498(0x18e)]=0x0,_0x1a7f94[_0x387899][_0x526498(0x16b)]=0x0,_0x1a7f94[_0x387899]['from_types']='Floor',_0x1a7f94[_0x387899][_0x526498(0x1f0)]=_0xf59ded;}else{if(_0x452a2b==_0x526498(0x1e1)&&_0x387899==_0xf2558a){var _0xf59ded=_0x2bfffe[_0x526498(0x21c)](0x3);_0x1a7f94[_0x387899]['from_storage']=_0x2bfffe[0x0],_0x1a7f94[_0x387899][_0x526498(0x207)]=_0x2bfffe[0x1],_0x1a7f94[_0x387899][_0x526498(0x18e)]=0x0,_0x1a7f94[_0x387899]['from_bin']=0x0,_0x1a7f94[_0x387899][_0x526498(0x1c3)]=_0x526498(0x182),_0x1a7f94[_0x387899][_0x526498(0x1f0)]=_0x2bfffe[0x5];}else{if(_0x387899==_0xf2558a){var _0x1d7c3b;if(_0x2bfffe[0x4]=='L')_0x1d7c3b=_0x526498(0x21f);else _0x2bfffe[0x4]=='F'&&(_0x1d7c3b=_0x526498(0x182));_0x1a7f94[_0x387899][_0x526498(0x1b6)]=_0x2bfffe[0x0],_0x1a7f94[_0x387899]['from_rack']=_0x2bfffe[0x1],_0x1a7f94[_0x387899][_0x526498(0x18e)]=_0x2bfffe[0x2],_0x1a7f94[_0x387899][_0x526498(0x16b)]=_0x2bfffe[0x3],_0x1a7f94[_0x387899][_0x526498(0x1c3)]=_0x1d7c3b,_0x1a7f94[_0x387899][_0x526498(0x1f0)]=_0x2bfffe[0x5];}}}});}),_0xb3ed6c[_0x1a24f4(0x211)]((_0x953d5d,_0xa3812f)=>{_0x1a7f94[_0xa3812f]['to_quantity']=_0x953d5d;}),_0xd579db[_0x1a24f4(0x211)]((_0x3cae4d,_0x565622)=>{var _0x26f9e4=_0x1a24f4;_0xc7606b[_0x26f9e4(0x211)]((_0x45eff3,_0x521f0f)=>{var _0x66a2ea=_0x26f9e4;if(_0x45eff3==_0x66a2ea(0x14f)&&_0x565622==_0x521f0f){var _0x488fd6=_0x3cae4d[_0x66a2ea(0x21c)](0x3);_0x1a7f94[_0x565622][_0x66a2ea(0x1cc)]=_0x3cae4d[0x0],_0x1a7f94[_0x565622][_0x66a2ea(0x1e0)]=_0x3cae4d[0x1],_0x1a7f94[_0x565622][_0x66a2ea(0x197)]=0x0,_0x1a7f94[_0x565622]['to_bin']=0x0,_0x1a7f94[_0x565622][_0x66a2ea(0x178)]=_0x66a2ea(0x182),_0x1a7f94[_0x565622][_0x66a2ea(0x1a7)]=_0x488fd6;}else{if(_0x45eff3==_0x66a2ea(0x1e1)&&_0x565622==_0x521f0f){var _0x488fd6=_0x3cae4d['slice'](0x3);_0x1a7f94[_0x565622]['storage']=_0x3cae4d[0x0],_0x1a7f94[_0x565622][_0x66a2ea(0x1e0)]=_0x3cae4d[0x1],_0x1a7f94[_0x565622]['to_bay']=0x0,_0x1a7f94[_0x565622][_0x66a2ea(0x1a1)]=0x0,_0x1a7f94[_0x565622][_0x66a2ea(0x178)]=_0x66a2ea(0x182),_0x1a7f94[_0x565622][_0x66a2ea(0x1a7)]=_0x3cae4d[0x5];}else{if(_0x565622==_0x521f0f){var _0x3cef0d;if(_0x3cae4d[0x4]=='L')_0x3cef0d=_0x66a2ea(0x21f);else _0x3cae4d[0x4]=='F'&&(_0x3cef0d=_0x66a2ea(0x182));_0x1a7f94[_0x565622][_0x66a2ea(0x1cc)]=_0x3cae4d[0x0],_0x1a7f94[_0x565622]['rack']=_0x3cae4d[0x1],_0x1a7f94[_0x565622][_0x66a2ea(0x197)]=_0x3cae4d[0x2],_0x1a7f94[_0x565622]['to_bin']=_0x3cae4d[0x3],_0x1a7f94[_0x565622]['to_types']=_0x3cef0d,_0x1a7f94[_0x565622][_0x66a2ea(0x1a7)]=_0x3cae4d[0x5];}}}});}),_0x5ebf47[_0x1a24f4(0x211)]((_0x236823,_0x27a487)=>{var _0x4e85e3=_0x1a24f4;_0x1a7f94[_0x27a487][_0x4e85e3(0x1de)]=_0x236823;}),_0x48a991[_0x1a24f4(0x211)]((_0x246fd1,_0x321dd7)=>{var _0x5f5715=_0x1a24f4;_0x1a7f94[_0x321dd7][_0x5f5715(0x176)]=_0x246fd1;}),_0x289063[_0x1a24f4(0x211)]((_0x5e6bcc,_0x3ce44a)=>{_0x1a7f94[_0x3ce44a]['product_code']=_0x5e6bcc;}),_0x3843a0[_0x1a24f4(0x211)]((_0x4570f8,_0x27d856)=>{var _0x46eb68=_0x1a24f4;_0x1a7f94[_0x27d856][_0x46eb68(0x17f)]=_0x4570f8;}),_0x338a0d[_0x1a24f4(0x211)]((_0x50d2bc,_0x4f0fb8)=>{var _0x3925bb=_0x1a24f4;_0x1a7f94[_0x4f0fb8][_0x3925bb(0x16d)]=_0x50d2bc;}),_0x5ed717[_0x1a24f4(0x211)]((_0x49651f,_0x25a5c4)=>{var _0x18b41c=_0x1a24f4;_0x1a7f94[_0x25a5c4][_0x18b41c(0x1cf)]=_0x49651f;}),_0x5697d8[_0x1a24f4(0x211)]((_0x555e1f,_0x42538b)=>{var _0x4385fa=_0x1a24f4;_0x1a7f94[_0x42538b][_0x4385fa(0x185)]=_0x555e1f;}),_0x392454[_0x1a24f4(0x211)]((_0x3ec0fd,_0x3c2a6b)=>{_0x1a7f94[_0x3c2a6b]['expiry_date']=_0x3ec0fd;}),_0x5bf1c3[_0x1a24f4(0x211)]((_0x1a494d,_0x1912c5)=>{var _0x20f39c=_0x1a24f4;_0x1a7f94[_0x1912c5][_0x20f39c(0x1b7)]=_0x1a494d;}),_0x45aec5[_0x1a24f4(0x211)]((_0x57a0a7,_0xdffd1d)=>{_0x1a7f94[_0xdffd1d]['production_date']=_0x57a0a7;}),_0x256991[_0x1a24f4(0x211)]((_0x4307d8,_0xb09801)=>{var _0x4be0da=_0x1a24f4;_0x1a7f94[_0xb09801][_0x4be0da(0x18f)]=_0x4307d8;}),_0x23e7eb[_0x1a24f4(0x211)]((_0xcd0c2,_0xa543bd)=>{_0x1a7f94[_0xa543bd]['from_room_name']=_0xcd0c2;}),_0xc7606b['forEach']((_0x361cfe,_0xf6076c)=>{var _0x2b7387=_0x1a24f4;_0x1a7f94[_0xf6076c][_0x2b7387(0x17b)]=_0x361cfe;});const _0x554e06=_0x1a7f94[_0x1a24f4(0x205)](_0x545a7c=>_0x545a7c[_0x1a24f4(0x1e8)]!=='0'&&_0x545a7c[_0x1a24f4(0x1e8)]!==''||_0x545a7c[_0x1a24f4(0x1a7)]!=='0'&&_0x545a7c[_0x1a24f4(0x1a7)]!==''),_0x523abc=new transfers({'date':_0x330623,'from_warehouse':_0x4a3c17,'to_warehouse':_0x421e94,'product':_0x554e06,'note':_0x468b7c,'invoice':_0x230b2f}),_0x4e6f2f=await _0x523abc['save']();_0x484a56[_0x1a24f4(0x1ef)](_0x1a24f4(0x1c6),'Product\x20Transfer\x20successfully'),_0x450e85['redirect'](_0x1a24f4(0x1a5)+_0x4e6f2f[_0x1a24f4(0x1b5)]);}catch(_0x35412e){console['log'](_0x35412e),_0x450e85[_0x1a24f4(0x212)](0xc8)[_0x1a24f4(0x224)]({'errorMessage':_0x35412e[_0x1a24f4(0x146)]});}}),router[a0_0x37e73e(0x17d)](a0_0x37e73e(0x158),auth,async(_0x2530c5,_0xa837a4)=>{var _0x5d2657=a0_0x37e73e;try{const {username:_0x18b15c,email:_0x3317c8,role:_0x76e747}=_0x2530c5[_0x5d2657(0x20e)],_0x596d47=_0x2530c5['user'],_0x48123f=await profile[_0x5d2657(0x16e)]({'email':_0x596d47[_0x5d2657(0x186)]}),_0x553242=await master_shop[_0x5d2657(0x149)]();console['log'](_0x5d2657(0x202),_0x553242);const _0x344cb8=await transfers[_0x5d2657(0x1e3)](_0x2530c5['params']['id']);let _0x4bcbca=new Date(_0x344cb8[_0x5d2657(0x200)]),_0x47ea73=('0'+_0x4bcbca[_0x5d2657(0x1c4)]())[_0x5d2657(0x21c)](-0x2),_0x2c14d6=('0'+(_0x4bcbca[_0x5d2657(0x228)]()+0x1))[_0x5d2657(0x21c)](-0x2),_0x3153e6=_0x4bcbca[_0x5d2657(0x188)](),_0x1871f4=_0x3153e6+'-'+_0x2c14d6+'-'+_0x47ea73,_0x5c36df;if(_0x596d47['role']=='staff'){const _0x3a47a1=await staff[_0x5d2657(0x16e)]({'email':_0x596d47[_0x5d2657(0x186)]});_0x5c36df=await warehouse[_0x5d2657(0x149)]({'status':_0x5d2657(0x1af),'name':_0x3a47a1['warehouse'],'warehouse_category':_0x5d2657(0x15e)});}else _0x5c36df=await warehouse[_0x5d2657(0x149)]({'status':_0x5d2657(0x1af),'warehouse_category':'Raw\x20Materials'});const _0x503cfe=await warehouse[_0x5d2657(0x1a4)]([{'$match':{'name':_0x344cb8[_0x5d2657(0x1d6)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5d2657(0x1fc),'name':{'$first':_0x5d2657(0x22b)},'product_stock':{'$first':_0x5d2657(0x1b3)},'bay':{'$first':_0x5d2657(0x214)},'bin':{'$first':_0x5d2657(0x208)},'type':{'$first':_0x5d2657(0x1fd)},'floorlevel':{'$first':_0x5d2657(0x222)},'primary_code':{'$first':_0x5d2657(0x203)},'secondary_code':{'$first':_0x5d2657(0x1b8)},'product_code':{'$first':_0x5d2657(0x225)},'storage':{'$first':_0x5d2657(0x18b)},'rack':{'$first':_0x5d2657(0x1a2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5d2657(0x1cb)},'room':{'$first':'$room'}}}]);if(_0x553242[0x0][_0x5d2657(0x15b)]==_0x5d2657(0x1d4)){var _0x8f4edd=users[_0x5d2657(0x22a)];console[_0x5d2657(0x1ce)](_0x8f4edd);}else{if(_0x553242[0x0][_0x5d2657(0x15b)]==_0x5d2657(0x18d))var _0x8f4edd=users[_0x5d2657(0x18d)];else{if(_0x553242[0x0][_0x5d2657(0x15b)]==_0x5d2657(0x154))var _0x8f4edd=users['German'];else{if(_0x553242[0x0][_0x5d2657(0x15b)]==_0x5d2657(0x1d9))var _0x8f4edd=users[_0x5d2657(0x1d9)];else{if(_0x553242[0x0][_0x5d2657(0x15b)]=='French')var _0x8f4edd=users['French'];else{if(_0x553242[0x0][_0x5d2657(0x15b)]=='Portuguese\x20(BR)')var _0x8f4edd=users[_0x5d2657(0x210)];else{if(_0x553242[0x0][_0x5d2657(0x15b)]==_0x5d2657(0x1c0))var _0x8f4edd=users[_0x5d2657(0x1c0)];else{if(_0x553242[0x0][_0x5d2657(0x15b)]==_0x5d2657(0x14b))var _0x8f4edd=users[_0x5d2657(0x16f)];}}}}}}}_0xa837a4[_0x5d2657(0x1e9)](_0x5d2657(0x1f9),{'success':_0x2530c5[_0x5d2657(0x1ef)](_0x5d2657(0x1c6)),'errors':_0x2530c5[_0x5d2657(0x1ef)](_0x5d2657(0x1cd)),'role':_0x596d47,'profile':_0x48123f,'master_shop':_0x553242,'warehouse':_0x5c36df,'transfer':_0x344cb8,'stock':_0x503cfe,'language':_0x8f4edd});}catch(_0x21e0ed){console['log'](_0x21e0ed);}}),router[a0_0x37e73e(0x1bb)]('/preview/:id',auth,async(_0x19b005,_0x77e8f0)=>{var _0x2a9c4a=a0_0x37e73e;try{const _0x1e99ef=_0x19b005[_0x2a9c4a(0x1d1)]['id'],{from_warehouse:_0x5b4591,FromRoom_name:_0xf7bf4,to_warehouse:_0x1390e3,ToRoom_name:_0x79e3cd}=_0x19b005[_0x2a9c4a(0x18c)],_0x573f6f=await transfers[_0x2a9c4a(0x1e3)]({'_id':_0x1e99ef}),_0x3461fe=_0x573f6f[_0x2a9c4a(0x15c)][_0x2a9c4a(0x165)](async _0x2a249d=>{var _0x2ee88c=_0x2a9c4a;if(_0x2a249d[_0x2ee88c(0x1e8)]>0x0){var _0x284af1=await warehouse[_0x2ee88c(0x16e)]({'name':_0x573f6f['from_warehouse'],'room':_0x2a249d[_0x2ee88c(0x166)],'warehouse_category':'Raw\x20Materials'});const _0x2c937c=_0x284af1[_0x2ee88c(0x161)][_0x2ee88c(0x165)](_0x38e545=>{var _0x5d80b0=_0x2ee88c;_0x38e545[_0x5d80b0(0x164)]==_0x2a249d['product_name']&&_0x38e545[_0x5d80b0(0x173)]==_0x2a249d['from_floorlevel']&&_0x38e545['type']==_0x2a249d[_0x5d80b0(0x1c3)]&&_0x38e545[_0x5d80b0(0x183)]==_0x2a249d[_0x5d80b0(0x16b)]&&_0x38e545[_0x5d80b0(0x199)]==_0x2a249d['from_bay']&&_0x38e545[_0x5d80b0(0x1e0)]==_0x2a249d['from_rack']&&_0x38e545[_0x5d80b0(0x1cc)]==_0x2a249d[_0x5d80b0(0x1b6)]&&_0x38e545['expiry_date']==_0x2a249d[_0x5d80b0(0x200)]&&_0x38e545[_0x5d80b0(0x185)]==_0x2a249d[_0x5d80b0(0x185)]&&_0x38e545['production_date']==_0x2a249d['production_date']&&_0x38e545[_0x5d80b0(0x167)]==_0x2a249d[_0x5d80b0(0x1d0)]&&(_0x38e545[_0x5d80b0(0x19e)]=_0x38e545[_0x5d80b0(0x19e)]-_0x2a249d[_0x5d80b0(0x1e8)]);});}return _0x284af1;});Promise[_0x2a9c4a(0x145)](_0x3461fe)[_0x2a9c4a(0x170)](async _0x59802d=>{var _0x1a75e2=_0x2a9c4a;try{for(const _0x5b6b0e of _0x59802d){await _0x5b6b0e[_0x1a75e2(0x1d3)]();}try{const _0x4d6f24=_0x573f6f[_0x1a75e2(0x15c)][_0x1a75e2(0x165)](async _0x5a637f=>{var _0x48ecc5=_0x1a75e2;if(_0x5a637f[_0x48ecc5(0x1e8)]>0x0){var _0x1e05e7=await warehouse['findOne']({'name':_0x573f6f[_0x48ecc5(0x21d)],'room':_0x5a637f['to_room_name'],'warehouse_category':_0x48ecc5(0x15e)}),_0x207326=0x0;const _0x37c51a=_0x1e05e7[_0x48ecc5(0x161)][_0x48ecc5(0x165)](_0x393511=>{var _0x383751=_0x48ecc5;_0x393511[_0x383751(0x164)]==_0x5a637f['product_name']&&_0x393511[_0x383751(0x173)]==_0x5a637f['to_floorlevel']&&_0x393511[_0x383751(0x20b)]==_0x5a637f[_0x383751(0x178)]&&_0x393511[_0x383751(0x183)]==_0x5a637f[_0x383751(0x1a1)]&&_0x393511['bay']==_0x5a637f[_0x383751(0x197)]&&_0x393511[_0x383751(0x1e0)]==_0x5a637f[_0x383751(0x1e0)]&&_0x393511['storage']==_0x5a637f['storage']&&_0x393511[_0x383751(0x200)]==_0x5a637f['expiry_date']&&_0x393511[_0x383751(0x185)]==_0x5a637f['batch_code']&&_0x393511[_0x383751(0x1ff)]==_0x5a637f[_0x383751(0x1ff)]&&_0x393511[_0x383751(0x167)]==_0x5a637f[_0x383751(0x1f5)]&&(_0x393511[_0x383751(0x19e)]=_0x393511['product_stock']+_0x5a637f['to_quantity'],_0x207326++);});_0x207326=='0'&&(_0x1e05e7['product_details']=_0x1e05e7[_0x48ecc5(0x161)][_0x48ecc5(0x22e)]({'product_name':_0x5a637f[_0x48ecc5(0x164)],'product_stock':_0x5a637f['to_quantity'],'bay':_0x5a637f[_0x48ecc5(0x197)],'bin':_0x5a637f[_0x48ecc5(0x1a1)],'type':_0x5a637f[_0x48ecc5(0x178)],'floorlevel':_0x5a637f[_0x48ecc5(0x1a7)],'storage':_0x5a637f['storage'],'rack':_0x5a637f[_0x48ecc5(0x1e0)],'product_code':_0x5a637f[_0x48ecc5(0x19c)],'primary_code':_0x5a637f[_0x48ecc5(0x1de)],'secondary_code':_0x5a637f['secondary_code'],'maxProducts':_0x5a637f[_0x48ecc5(0x17f)],'storage':_0x5a637f[_0x48ecc5(0x1cc)],'rack':_0x5a637f['rack'],'expiry_date':_0x5a637f[_0x48ecc5(0x200)],'maxPerUnit':_0x5a637f['maxperunit'],'batch_code':_0x5a637f[_0x48ecc5(0x185)],'production_date':_0x5a637f[_0x48ecc5(0x1ff)]}));}return _0x1e05e7;});Promise[_0x1a75e2(0x145)](_0x4d6f24)[_0x1a75e2(0x170)](async _0x1a6f71=>{var _0x25bd22=_0x1a75e2;try{for(const _0x1f0df5 of _0x1a6f71){await warehouse[_0x25bd22(0x163)]({'_id':_0x1f0df5['_id']},{'$addToSet':{'product_details':{'$each':_0x1f0df5['product_details']}}});}_0x573f6f['finalize']=_0x25bd22(0x21b);const _0x21d8a9=await _0x573f6f[_0x25bd22(0x1d3)](),_0x3fc420=await master_shop[_0x25bd22(0x149)](),_0xfc4018=await email_settings[_0x25bd22(0x16e)](),_0x1f5feb=await supervisor_settings[_0x25bd22(0x149)]();var _0x53245f=_0x573f6f[_0x25bd22(0x15c)],_0x55fc63='',_0x2edabd;for(_0x2edabd in _0x53245f){_0x55fc63+=_0x25bd22(0x1da)+_0x25bd22(0x192)+_0x53245f[_0x2edabd][_0x25bd22(0x164)]+'</td>'+_0x25bd22(0x192)+_0x53245f[_0x2edabd][_0x25bd22(0x19c)]+_0x25bd22(0x1d8)+_0x25bd22(0x192)+_0x53245f[_0x2edabd][_0x25bd22(0x1e8)]+_0x25bd22(0x1d8)+_0x25bd22(0x192)+_0x53245f[_0x2edabd][_0x25bd22(0x16d)]+'</td>'+_0x25bd22(0x192)+_0x53245f[_0x2edabd][_0x25bd22(0x1cf)]+_0x25bd22(0x1d8)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x573f6f[_0x25bd22(0x21d)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x53245f[_0x2edabd]['to_room_name']+_0x25bd22(0x1d8)+_0x25bd22(0x192)+_0x53245f[_0x2edabd]['storage']+_0x53245f[_0x2edabd][_0x25bd22(0x1e0)]+_0x53245f[_0x2edabd][_0x25bd22(0x197)]+_0x53245f[_0x2edabd][_0x25bd22(0x1a1)]+_0x53245f[_0x2edabd][_0x25bd22(0x178)][0x0]+_0x53245f[_0x2edabd][_0x25bd22(0x1a7)]+_0x25bd22(0x1d8),_0x25bd22(0x1a9);}let _0x35c449=nodemailer[_0x25bd22(0x1b4)]({'host':_0xfc4018[_0x25bd22(0x1ab)],'port':Number(_0xfc4018[_0x25bd22(0x226)]),'secure':![],'auth':{'user':_0xfc4018[_0x25bd22(0x186)],'pass':_0xfc4018[_0x25bd22(0x1c7)]}}),_0x5aab9c={'from':_0xfc4018[_0x25bd22(0x186)],'to':_0x1f5feb[0x0][_0x25bd22(0x153)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x25bd22(0x15d),'path':__dirname+_0x25bd22(0x172)+_0x25bd22(0x204)+_0x3fc420[0x0][_0x25bd22(0x1c5)],'cid':_0x25bd22(0x1ea)}],'html':_0x25bd22(0x221)+_0x25bd22(0x157)+_0x25bd22(0x195)+_0x25bd22(0x152)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x25bd22(0x17c)+_0x25bd22(0x184)+_0x25bd22(0x152)+'<h2>\x20'+_0x3fc420[0x0][_0x25bd22(0x191)]+_0x25bd22(0x187)+_0x25bd22(0x184)+_0x25bd22(0x184)+_0x25bd22(0x160)+_0x25bd22(0x152)+_0x25bd22(0x14a)+_0x25bd22(0x217)+_0x573f6f[_0x25bd22(0x167)]+'\x20'+_0x25bd22(0x1bc)+_0x25bd22(0x171)+_0x573f6f['date']+'\x20'+'</span>'+'</h5>'+_0x25bd22(0x184)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x25bd22(0x22c)+_0x25bd22(0x1da)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x25bd22(0x1bd)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x25bd22(0x177)+_0x25bd22(0x1dd)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x25bd22(0x218)+_0x25bd22(0x1ee)+'</tr>'+_0x25bd22(0x14c)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x55fc63+'\x20'+_0x25bd22(0x1fa)+_0x25bd22(0x1e4)+_0x25bd22(0x152)+_0x25bd22(0x14e)+'<h5>'+_0x3fc420[0x0]['site_title']+_0x25bd22(0x22d)+_0x25bd22(0x184)+'</div>'+_0x25bd22(0x1dc)};_0x35c449['sendMail'](_0x5aab9c,function(_0x122023,_0x3fcdcc){var _0x43eb39=_0x25bd22;_0x122023?(console['log'](_0x122023),console[_0x43eb39(0x1ce)](_0x43eb39(0x20c))):console[_0x43eb39(0x1ce)](_0x43eb39(0x1a3));}),_0x19b005['flash']('success',_0x25bd22(0x1c2)),_0x77e8f0[_0x25bd22(0x16c)](_0x25bd22(0x1a6)+_0x21d8a9[_0x25bd22(0x1b5)]);}catch(_0x3e6aa7){console[_0x25bd22(0x227)](_0x3e6aa7),_0x77e8f0['status'](0x1f4)[_0x25bd22(0x224)]({'Perror':_0x25bd22(0x1ca),'message':_0x3e6aa7[_0x25bd22(0x146)]});}})[_0x1a75e2(0x20d)](_0x17f436=>{var _0x453a64=_0x1a75e2;console[_0x453a64(0x227)](_0x17f436),_0x77e8f0[_0x453a64(0x212)](0x1f4)[_0x453a64(0x224)]({'Perror':_0x453a64(0x1d7)});});}catch(_0x124d14){_0x77e8f0[_0x1a75e2(0x224)](_0x124d14);}}catch(_0x26fb5f){console[_0x1a75e2(0x227)](_0x26fb5f),_0x77e8f0['status'](0x1f4)['json']({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x26fb5f[_0x1a75e2(0x146)]});}})['catch'](_0x473b2e=>{var _0x268918=_0x2a9c4a;console[_0x268918(0x227)](_0x473b2e),_0x77e8f0[_0x268918(0x212)](0x1f4)[_0x268918(0x224)]({'Merror':_0x268918(0x1d7)});});}catch(_0x7e8d8a){console['log'](_0x7e8d8a);}});function BayBinSelected(_0x2c843b,_0x40a1c9){var _0x3ea86a=a0_0x37e73e,_0x33894d=[],_0x435ac7=[],_0x53add0=[],_0x2c85b6=[],_0x25fdb2=[],_0x51cc50=[];let _0x135516=[];if(_0x2c843b=='DRY\x20STORAGE')switch(_0x40a1c9){case _0x3ea86a(0x1ec):_0x33894d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x435ac7=[0x1,0x2],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x21f),_0x3ea86a(0x182)],_0x25fdb2=['D'],_0x51cc50=['A'];break;case _0x3ea86a(0x156):_0x33894d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x435ac7=[0x1,0x2],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x21f),_0x3ea86a(0x182)],_0x25fdb2=['D'],_0x51cc50=['B'];break;case'Shelves':_0x33894d=[0x0],_0x435ac7=[0x0],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x182)],_0x25fdb2=['D'],_0x51cc50=['S'];break;case _0x3ea86a(0x14f):_0x33894d=[0x0],_0x435ac7=[0x0],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x53add0=[_0x3ea86a(0x182)],_0x25fdb2=['D'],_0x51cc50=['R'];break;}else{if(_0x2c843b==_0x3ea86a(0x1ed))switch(_0x40a1c9){case _0x3ea86a(0x1ec):_0x33894d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x435ac7=['B','F'],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x21f),_0x3ea86a(0x182)],_0x25fdb2=['C'],_0x51cc50=['A'];break;case'Rack\x20B':_0x33894d=[0x5,0x4,0x3,0x2,0x1],_0x435ac7=['F','B','S'],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x21f),_0x3ea86a(0x182)],_0x25fdb2=['C'],_0x51cc50=['B'];break;case _0x3ea86a(0x1fe):_0x33894d=[0x1,0x2,0x3,0x4,0x5],_0x435ac7=['B','F','S'],_0x2c85b6=[0x5,0x4,0x3,0x2,0x1],_0x53add0=[_0x3ea86a(0x21f),_0x3ea86a(0x182)],_0x25fdb2=['C'],_0x51cc50=['C'];break;case _0x3ea86a(0x168):_0x33894d=[0x5,0x4,0x3,0x2,0x1],_0x435ac7=['F','B','S'],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x21f),_0x3ea86a(0x182)],_0x25fdb2=['C'],_0x51cc50=['D'];break;case _0x3ea86a(0x1e7):_0x33894d=[0x4,0x3,0x2,0x1],_0x435ac7=[0x1,0x2],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x21f),_0x3ea86a(0x182)],_0x25fdb2=['C'],_0x51cc50=['E'];break;case'Rack\x20F':_0x33894d=[0x1,0x2,0x3],_0x435ac7=[0x1,0x2],_0x2c85b6=[0x1,0x2,0x3,0x4,0x5],_0x53add0=[_0x3ea86a(0x21f)],_0x25fdb2=['C'],_0x51cc50=['F'];break;}}return{'levels':_0x33894d,'Isle':_0x435ac7,'rack':_0x2c85b6,'type':_0x53add0,'storage':_0x25fdb2,'rak':_0x51cc50};}router['get'](a0_0x37e73e(0x196),auth,async(_0x58a75d,_0x5131be)=>{var _0x33390b=a0_0x37e73e;try{const {username:_0x43ed4f,email:_0x2dab4e,role:_0x477a24}=_0x58a75d[_0x33390b(0x20e)],_0x494130=_0x58a75d[_0x33390b(0x20e)],_0x3d5b33=await profile[_0x33390b(0x16e)]({'email':_0x494130[_0x33390b(0x186)]}),_0x52de0a=await master_shop[_0x33390b(0x149)](),_0x219f97=await transfers[_0x33390b(0x1e3)](_0x58a75d[_0x33390b(0x1d1)]['id']);let _0x749748;if(_0x494130['role']=='staff'){const _0x58ddc4=await staff[_0x33390b(0x16e)]({'email':_0x494130[_0x33390b(0x186)]});_0x749748=await warehouse[_0x33390b(0x1a4)]([{'$match':{'status':_0x33390b(0x1af),'name':_0x58ddc4[_0x33390b(0x155)],'warehouse_category':_0x33390b(0x15e)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x749748=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x33390b(0x15e)}},{'$group':{'_id':_0x33390b(0x219),'name':{'$first':'$name'}}}]);const _0x59c898=await warehouse['aggregate']([{'$match':{'name':_0x219f97[_0x33390b(0x1d6)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x33390b(0x229)},{'$group':{'_id':_0x33390b(0x1fc),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x33390b(0x1b3)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x33390b(0x208)},'type':{'$first':_0x33390b(0x1fd)},'floorlevel':{'$first':_0x33390b(0x222)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x33390b(0x1b8)},'product_code':{'$first':_0x33390b(0x225)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x33390b(0x1a2)},'expiry_date':{'$first':_0x33390b(0x1f1)},'production_date':{'$first':_0x33390b(0x1cb)},'room':{'$first':_0x33390b(0x1ba)}}}]),_0x37bf40=await product['find']({}),_0xbe0ec7=BayBinSelected(_0x219f97[_0x33390b(0x21d)],_0x219f97['to_room']);if(_0x52de0a[0x0][_0x33390b(0x15b)]=='English\x20(US)'){var _0x1ff98b=users[_0x33390b(0x22a)];console['log'](_0x1ff98b);}else{if(_0x52de0a[0x0][_0x33390b(0x15b)]==_0x33390b(0x18d))var _0x1ff98b=users['Hindi'];else{if(_0x52de0a[0x0][_0x33390b(0x15b)]==_0x33390b(0x154))var _0x1ff98b=users[_0x33390b(0x154)];else{if(_0x52de0a[0x0][_0x33390b(0x15b)]==_0x33390b(0x1d9))var _0x1ff98b=users[_0x33390b(0x1d9)];else{if(_0x52de0a[0x0]['language']==_0x33390b(0x21e))var _0x1ff98b=users[_0x33390b(0x21e)];else{if(_0x52de0a[0x0][_0x33390b(0x15b)]=='Portuguese\x20(BR)')var _0x1ff98b=users[_0x33390b(0x210)];else{if(_0x52de0a[0x0][_0x33390b(0x15b)]==_0x33390b(0x1c0))var _0x1ff98b=users[_0x33390b(0x1c0)];else{if(_0x52de0a[0x0][_0x33390b(0x15b)]==_0x33390b(0x14b))var _0x1ff98b=users[_0x33390b(0x16f)];}}}}}}}_0x5131be[_0x33390b(0x1e9)]('edit_transfer',{'success':_0x58a75d[_0x33390b(0x1ef)]('success'),'errors':_0x58a75d[_0x33390b(0x1ef)]('errors'),'role':_0x494130,'profile':_0x3d5b33,'master_shop':_0x52de0a,'warehouse':_0x749748,'transfer':_0x219f97,'stock':_0x59c898,'unit':_0x37bf40,'language':_0x1ff98b});}catch(_0x518894){console[_0x33390b(0x1ce)](_0x518894);}}),router[a0_0x37e73e(0x1bb)](a0_0x37e73e(0x196),auth,async(_0x3c7d91,_0x458998)=>{var _0x315de1=a0_0x37e73e;try{const _0x18eee9=_0x3c7d91[_0x315de1(0x1d1)]['id'],_0x28b922=await transfers['findById'](_0x18eee9);_0x458998[_0x315de1(0x224)](_0x3c7d91[_0x315de1(0x18c)]);return;const {date:_0x3d4c53,from_warehouse:_0x1536d8,FromRoom_name:_0x18e603,to_warehouse:_0x470ac8,ToRoom_name:_0x3f6cab,prod_name:_0x1cc6a3,from_prod_qty:_0x243814,from_prod_level:_0x4752c2,from_prod_isle:_0x19f5c8,from_prod_pallet:_0x1e7e96,to_prod_qty:_0x11e4fa,to_prod_level:_0x3384b3,to_prod_isle:_0x4d8e72,to_prod_pallet:_0x35fb5a,primary_code:_0xc89583,secondary_code:_0x2a5475,product_code3:_0x604fd2,note:_0x3d9930,invoice:_0x1bccc5,expiry_date:_0x57980f}=_0x3c7d91[_0x315de1(0x18c)];if(typeof _0x1cc6a3==_0x315de1(0x1b2))var _0x541ad4=[_0x3c7d91['body'][_0x315de1(0x1ac)]],_0x18f2f7=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x179)]],_0x1ea3ad=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1c1)]],_0x19c749=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x17a)]],_0xaad0e9=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x19f)]],_0x3569c3=[_0x3c7d91['body'][_0x315de1(0x1c3)]],_0x511db2=[_0x3c7d91['body'][_0x315de1(0x1db)]],_0x14393=[_0x3c7d91['body']['to_prod_level']],_0x2f4bf2=[_0x3c7d91['body'][_0x315de1(0x19a)]],_0x76abfa=[_0x3c7d91[_0x315de1(0x18c)]['to_prod_pallet']],_0x4e6547=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x178)]],_0x441004=[_0x3c7d91[_0x315de1(0x18c)]['storage']],_0x25685d=[_0x3c7d91[_0x315de1(0x18c)]['rak']],_0x1a8677=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1de)]],_0x345827=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x176)]],_0x5ca2d0=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x180)]],_0x242636=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x148)]],_0x34309d=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x16d)]],_0x309ab0=[_0x3c7d91['body']['secondary_unit']],_0x32a5b9=[_0x3c7d91['body']['batch_code']],_0x86eed3=[_0x3c7d91[_0x315de1(0x18c)]['expiry_date']],_0x298e0c=[_0x3c7d91['body']['from_storage']],_0x17163e=[_0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x175)]];else var _0x541ad4=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1ac)]],_0x441004=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1cc)]],_0x25685d=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1f6)]],_0x3569c3=[..._0x3c7d91[_0x315de1(0x18c)]['from_types']],_0x4e6547=[..._0x3c7d91['body'][_0x315de1(0x178)]],_0x18f2f7=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x179)]],_0x1ea3ad=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1c1)]],_0x19c749=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x17a)]],_0xaad0e9=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x19f)]],_0x511db2=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1db)]],_0x14393=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x20f)]],_0x2f4bf2=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x19a)]],_0x76abfa=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x220)]],_0x1a8677=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x1de)]],_0x345827=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x176)]],_0x5ca2d0=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x180)]],_0x242636=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x148)]],_0x34309d=[..._0x3c7d91[_0x315de1(0x18c)]['unit']],_0x309ab0=[..._0x3c7d91['body']['secondary_unit']],_0x32a5b9=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x185)]],_0x86eed3=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x200)]],_0x298e0c=[..._0x3c7d91['body'][_0x315de1(0x1b6)]],_0x17163e=[..._0x3c7d91[_0x315de1(0x18c)][_0x315de1(0x175)]];const _0x258ae5=_0x541ad4['map'](_0x5f03b6=>{return _0x5f03b6={'product_name':_0x5f03b6};});_0x18f2f7['forEach']((_0x5d25fb,_0x375072)=>{var _0x135420=_0x315de1;_0x258ae5[_0x375072][_0x135420(0x1df)]=_0x5d25fb;}),_0x1ea3ad[_0x315de1(0x211)]((_0x4688aa,_0x1b543f)=>{var _0x447b55=_0x315de1;_0x258ae5[_0x1b543f][_0x447b55(0x18e)]=_0x4688aa;}),_0x19c749[_0x315de1(0x211)]((_0x242342,_0x36cae2)=>{var _0x2b26da=_0x315de1;_0x258ae5[_0x36cae2][_0x2b26da(0x16b)]=_0x242342;}),_0xaad0e9[_0x315de1(0x211)]((_0x72ba56,_0x404bc3)=>{var _0x2ce8cf=_0x315de1;_0x258ae5[_0x404bc3][_0x2ce8cf(0x1f0)]=_0x72ba56;}),_0x511db2[_0x315de1(0x211)]((_0x119dfa,_0x244889)=>{_0x258ae5[_0x244889]['to_quantity']=_0x119dfa;}),_0x14393[_0x315de1(0x211)]((_0x1bb741,_0x562c6a)=>{var _0xdba21c=_0x315de1;_0x258ae5[_0x562c6a][_0xdba21c(0x197)]=_0x1bb741;}),_0x2f4bf2[_0x315de1(0x211)]((_0x3bab38,_0x224e39)=>{var _0x5602cb=_0x315de1;_0x258ae5[_0x224e39][_0x5602cb(0x1a1)]=_0x3bab38;}),_0x76abfa[_0x315de1(0x211)]((_0xdc0a49,_0x56fcfe)=>{_0x258ae5[_0x56fcfe]['to_floorlevel']=_0xdc0a49;}),_0x1a8677['forEach']((_0x301612,_0x2ac547)=>{var _0x37ebec=_0x315de1;_0x258ae5[_0x2ac547][_0x37ebec(0x1de)]=_0x301612;}),_0x345827[_0x315de1(0x211)]((_0x45dc01,_0x48340d)=>{_0x258ae5[_0x48340d]['secondary_code']=_0x45dc01;}),_0x5ca2d0[_0x315de1(0x211)]((_0x4d0fb8,_0x4b474e)=>{_0x258ae5[_0x4b474e]['product_code']=_0x4d0fb8;}),_0x242636['forEach']((_0x2784fd,_0x3b581a)=>{var _0x38aa9d=_0x315de1;_0x258ae5[_0x3b581a][_0x38aa9d(0x17f)]=_0x2784fd;}),_0x34309d[_0x315de1(0x211)]((_0x41ab45,_0x2e4c85)=>{var _0x53f599=_0x315de1;_0x258ae5[_0x2e4c85][_0x53f599(0x16d)]=_0x41ab45;}),_0x309ab0[_0x315de1(0x211)]((_0x2f26f5,_0x607b8c)=>{_0x258ae5[_0x607b8c]['secondary_unit']=_0x2f26f5;}),_0x32a5b9[_0x315de1(0x211)]((_0x503149,_0xd3daca)=>{var _0x25684b=_0x315de1;_0x258ae5[_0xd3daca][_0x25684b(0x185)]=_0x503149;}),_0x86eed3['forEach']((_0x5b5062,_0x344e1f)=>{_0x258ae5[_0x344e1f]['expiry_date']=_0x5b5062;}),_0x441004[_0x315de1(0x211)]((_0x4581bf,_0x1d9a78)=>{var _0x1062d5=_0x315de1;_0x258ae5[_0x1d9a78][_0x1062d5(0x1cc)]=_0x4581bf;}),_0x25685d[_0x315de1(0x211)]((_0x4f2201,_0xc311b2)=>{var _0x403a3b=_0x315de1;_0x258ae5[_0xc311b2][_0x403a3b(0x1e0)]=_0x4f2201;}),_0x3569c3['forEach']((_0x2b1d4e,_0x239699)=>{var _0x3c9075=_0x315de1;_0x258ae5[_0x239699][_0x3c9075(0x1c3)]=_0x2b1d4e;}),_0x4e6547['forEach']((_0x5dbf3c,_0x5dbfdf)=>{var _0x20dafe=_0x315de1;_0x258ae5[_0x5dbfdf][_0x20dafe(0x178)]=_0x5dbf3c;}),_0x298e0c['forEach']((_0x59a7da,_0x481d92)=>{var _0x14415c=_0x315de1;_0x258ae5[_0x481d92][_0x14415c(0x1b6)]=_0x59a7da;}),_0x17163e[_0x315de1(0x211)]((_0x20d113,_0xe8b3e)=>{var _0x40e8cf=_0x315de1;_0x258ae5[_0xe8b3e][_0x40e8cf(0x207)]=_0x20d113;});const _0x46bc37=_0x258ae5[_0x315de1(0x205)](_0x355aa8=>_0x355aa8['to_quantity']!=='0'&&_0x355aa8[_0x315de1(0x1e8)]!==''||_0x355aa8['to_floorlevel']!=='0'&&_0x355aa8[_0x315de1(0x1a7)]!=='');var _0x533561=0x0;_0x46bc37[_0x315de1(0x211)](_0x38cd9f=>{var _0x20e977=_0x315de1;parseInt(_0x38cd9f['from_quantity'])<parseInt(_0x38cd9f[_0x20e977(0x1e8)])&&_0x533561++;});if(_0x533561!=0x0)return _0x3c7d91[_0x315de1(0x1ef)](_0x315de1(0x1cd),_0x315de1(0x1b9)),_0x458998['redirect'](_0x315de1(0x209));const _0xd166db=await warehouse[_0x315de1(0x16e)]({'name':_0x28b922[_0x315de1(0x1d6)],'room':_0x28b922[_0x315de1(0x1c9)]});_0x28b922[_0x315de1(0x15c)][_0x315de1(0x211)](_0x4fd7fd=>{var _0x23f4c0=_0x315de1;if(_0x4fd7fd[_0x23f4c0(0x1e8)]>0x0){const _0x44d2b6=_0xd166db['product_details']['map'](_0x9dd2b8=>{var _0x2f33ca=_0x23f4c0;_0x9dd2b8[_0x2f33ca(0x164)]==_0x4fd7fd[_0x2f33ca(0x164)]&&_0x9dd2b8[_0x2f33ca(0x173)]==_0x4fd7fd['from_floorlevel']&&_0x9dd2b8[_0x2f33ca(0x20b)]==_0x4fd7fd[_0x2f33ca(0x1c3)]&&_0x9dd2b8[_0x2f33ca(0x183)]==_0x4fd7fd[_0x2f33ca(0x16b)]&&_0x9dd2b8['bay']==_0x4fd7fd['from_bay']&&_0x9dd2b8[_0x2f33ca(0x1e0)]==_0x4fd7fd[_0x2f33ca(0x207)]&&_0x9dd2b8['storage']==_0x4fd7fd['from_storage']&&(_0x9dd2b8['product_stock']=parseInt(_0x9dd2b8[_0x2f33ca(0x19e)])+parseInt(_0x4fd7fd['to_quantity']));});}}),await _0xd166db[_0x315de1(0x1d3)]();const _0x61ce22=await warehouse[_0x315de1(0x16e)]({'name':_0x28b922['to_warehouse'],'room':_0x28b922[_0x315de1(0x16a)]});_0x28b922[_0x315de1(0x15c)]['forEach'](_0x583d8d=>{var _0x4af9c4=_0x315de1;if(_0x583d8d[_0x4af9c4(0x1e8)]>0x0){const _0x4f5978=_0x61ce22[_0x4af9c4(0x161)][_0x4af9c4(0x165)](_0x45006a=>{var _0x5eb39d=_0x4af9c4;_0x45006a[_0x5eb39d(0x164)]==_0x583d8d[_0x5eb39d(0x164)]&&_0x45006a[_0x5eb39d(0x173)]==_0x583d8d[_0x5eb39d(0x1a7)]&&_0x45006a['type']==_0x583d8d[_0x5eb39d(0x178)]&&_0x45006a['bin']==_0x583d8d[_0x5eb39d(0x1a1)]&&_0x45006a[_0x5eb39d(0x199)]==_0x583d8d[_0x5eb39d(0x197)]&&_0x45006a[_0x5eb39d(0x1e0)]==_0x583d8d[_0x5eb39d(0x1e0)]&&_0x45006a['storage']==_0x583d8d[_0x5eb39d(0x1cc)]&&(_0x45006a[_0x5eb39d(0x19e)]=parseInt(_0x45006a[_0x5eb39d(0x19e)])-parseInt(_0x583d8d[_0x5eb39d(0x1e8)]));});}}),await _0x61ce22[_0x315de1(0x1d3)](),_0x28b922['date']=_0x3d4c53,_0x28b922[_0x315de1(0x1d6)]=_0x1536d8,_0x28b922[_0x315de1(0x21d)]=_0x470ac8,_0x28b922['product']=_0x46bc37,_0x28b922[_0x315de1(0x19d)]=_0x3d9930,_0x28b922[_0x315de1(0x167)]=_0x1bccc5;const _0x1541cc=await _0x28b922[_0x315de1(0x1d3)]();console['log'](_0x1541cc);const _0x378142=await warehouse[_0x315de1(0x16e)]({'name':_0x1536d8,'room':_0x18e603});_0x1541cc[_0x315de1(0x15c)][_0x315de1(0x211)](_0x47dd9d=>{var _0x404491=_0x315de1;if(_0x47dd9d[_0x404491(0x1e8)]>0x0){const _0x1a8f3f=_0x378142[_0x404491(0x161)][_0x404491(0x165)](_0x1c5858=>{var _0x9ea6fb=_0x404491;_0x1c5858[_0x9ea6fb(0x164)]==_0x47dd9d[_0x9ea6fb(0x164)]&&_0x1c5858[_0x9ea6fb(0x173)]==_0x47dd9d['from_floorlevel']&&_0x1c5858[_0x9ea6fb(0x20b)]==_0x47dd9d[_0x9ea6fb(0x1c3)]&&_0x1c5858[_0x9ea6fb(0x183)]==_0x47dd9d[_0x9ea6fb(0x16b)]&&_0x1c5858[_0x9ea6fb(0x199)]==_0x47dd9d[_0x9ea6fb(0x18e)]&&_0x1c5858[_0x9ea6fb(0x1e0)]==_0x47dd9d[_0x9ea6fb(0x207)]&&_0x1c5858[_0x9ea6fb(0x1cc)]==_0x47dd9d[_0x9ea6fb(0x1b6)]&&(_0x1c5858['product_stock']=parseInt(_0x1c5858[_0x9ea6fb(0x19e)])-parseInt(_0x47dd9d[_0x9ea6fb(0x1e8)]));});}}),await _0x378142[_0x315de1(0x1d3)]();const _0x5b1e99=await warehouse['findOne']({'name':_0x470ac8,'room':_0x3f6cab});_0x1541cc[_0x315de1(0x15c)][_0x315de1(0x211)](_0x453096=>{var _0x519571=_0x315de1;if(_0x453096['to_quantity']>0x0){var _0x3e89b6=0x0;const _0x1a17ec=_0x5b1e99['product_details']['map'](_0x4f41ed=>{var _0x392e7a=a0_0x16d3;_0x4f41ed[_0x392e7a(0x164)]==_0x453096[_0x392e7a(0x164)]&&_0x4f41ed[_0x392e7a(0x173)]==_0x453096[_0x392e7a(0x1a7)]&&_0x4f41ed[_0x392e7a(0x20b)]==_0x453096[_0x392e7a(0x178)]&&_0x4f41ed[_0x392e7a(0x183)]==_0x453096[_0x392e7a(0x1a1)]&&_0x4f41ed[_0x392e7a(0x199)]==_0x453096['to_bay']&&_0x4f41ed[_0x392e7a(0x1e0)]==_0x453096[_0x392e7a(0x1e0)]&&_0x4f41ed['storage']==_0x453096['storage']&&(_0x4f41ed[_0x392e7a(0x19e)]=parseInt(_0x4f41ed['product_stock'])+parseInt(_0x453096['to_quantity']),_0x3e89b6++);});_0x3e89b6=='0'&&(_0x5b1e99['product_details']=_0x5b1e99[_0x519571(0x161)]['concat']({'product_name':_0x453096['product_name'],'product_stock':_0x453096[_0x519571(0x1e8)],'bay':_0x453096[_0x519571(0x197)],'bin':_0x453096[_0x519571(0x1a1)],'type':_0x453096[_0x519571(0x178)],'floorlevel':_0x453096[_0x519571(0x1a7)],'storage':_0x453096[_0x519571(0x1cc)],'rack':_0x453096[_0x519571(0x1e0)],'product_code':_0x453096[_0x519571(0x19c)],'primary_code':_0x453096[_0x519571(0x1de)],'secondary_code':_0x453096[_0x519571(0x176)],'maxProducts':_0x453096[_0x519571(0x17f)],'storage':_0x453096[_0x519571(0x1cc)],'rack':_0x453096[_0x519571(0x1e0)]}));}}),await _0x5b1e99[_0x315de1(0x1d3)](),_0x3c7d91[_0x315de1(0x1ef)](_0x315de1(0x1c6),_0x315de1(0x1a0)),_0x458998[_0x315de1(0x16c)](_0x315de1(0x169));}catch(_0x1ee9c5){console[_0x315de1(0x1ce)](_0x1ee9c5);}}),router['post'](a0_0x37e73e(0x193),async(_0x145e74,_0xaba760)=>{var _0x5183dd=a0_0x37e73e;const {FromWareHouse:_0x51c593,FromRoom:_0x4e18c2,ToWarehouse:_0x5f9cb7,ToRoom:_0x76a273,primary_code:_0x18882e,Roomslist:_0x13b8de}=_0x145e74[_0x5183dd(0x18c)],_0x13da03=_0x13b8de[_0x5183dd(0x142)](','),_0x939fc7=[];async function _0x254261(_0x4505d6){var _0x208dae=_0x5183dd;const _0x1270ed=await warehouse[_0x208dae(0x1a4)]([{'$match':{'name':_0x51c593,'room':_0x4505d6}},{'$unwind':_0x208dae(0x229)},{'$match':{'product_details.primary_code':_0x18882e}},{'$group':{'_id':_0x208dae(0x1fc),'name':{'$first':_0x208dae(0x22b)},'instock':{'$first':_0x208dae(0x1b3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x208dae(0x225)},'level':{'$first':_0x208dae(0x214)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x208dae(0x222)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x208dae(0x14d)},'storage':{'$first':_0x208dae(0x18b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x208dae(0x1f1)},'production_date':{'$first':_0x208dae(0x1cb)},'batch_code':{'$first':_0x208dae(0x15a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x208dae(0x1ba)},'maxProducts':{'$first':_0x208dae(0x151)}}}]),_0x1a09fc=await warehouse[_0x208dae(0x1a4)]([{'$match':{'name':_0x51c593,'room':_0x4505d6}},{'$unwind':_0x208dae(0x229)},{'$match':{'product_details.secondary_code':_0x18882e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x208dae(0x22b)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x208dae(0x203)},'secondary_code':{'$first':_0x208dae(0x1b8)},'product_code':{'$first':_0x208dae(0x225)},'level':{'$first':_0x208dae(0x214)},'isle':{'$first':_0x208dae(0x208)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x208dae(0x222)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x208dae(0x14d)},'storage':{'$first':_0x208dae(0x18b)},'rack':{'$first':_0x208dae(0x1a2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x208dae(0x15a)},'maxPerUnit':{'$first':_0x208dae(0x15f)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x208dae(0x151)}}}]);if(_0x1270ed[_0x208dae(0x1e6)]>0x0)_0x939fc7['push'](_0x1270ed);else _0x1a09fc['length']>0x0&&_0x939fc7[_0x208dae(0x201)](_0x1a09fc);}const _0x8696=_0x13da03[_0x5183dd(0x165)](_0x5e84a4=>_0x254261(_0x5e84a4));await Promise[_0x5183dd(0x145)](_0x8696),_0xaba760[_0x5183dd(0x224)](_0x939fc7);}),router[a0_0x37e73e(0x1bb)](a0_0x37e73e(0x21a),async(_0x2af9ca,_0x52cb80)=>{var _0x480560=a0_0x37e73e;try{const {FromWareHouse:_0x18e1af,FromRoom:_0x45d9dc,ToWarehouse:_0x5a0e04,ToRoom:_0x361ccc,secondary_code:_0x16637a}=_0x2af9ca[_0x480560(0x18c)],_0x21a71b=await warehouse[_0x480560(0x1a4)]([{'$match':{'name':_0x18e1af}},{'$unwind':_0x480560(0x229)},{'$match':{'product_details.secondary_code':_0x16637a}},{'$group':{'_id':_0x480560(0x1fc),'name':{'$first':_0x480560(0x22b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x480560(0x1b8)},'product_code':{'$first':_0x480560(0x225)},'instock':{'$first':_0x480560(0x1b3)},'warehouse':{'$first':_0x480560(0x219)},'level':{'$first':_0x480560(0x1e5)},'isle':{'$first':_0x480560(0x174)},'pallet':{'$first':_0x480560(0x1d2)},'maxProducts':{'$first':_0x480560(0x151)},'unit':{'$first':_0x480560(0x1bf)}}}]);_0x52cb80['status'](0xc8)[_0x480560(0x224)](_0x21a71b);}catch(_0x2653d8){_0x52cb80[_0x480560(0x212)](0x194)[_0x480560(0x224)]({'message':_0x2653d8[_0x480560(0x146)]});}}),router[a0_0x37e73e(0x1bb)](a0_0x37e73e(0x1fb),async(_0x767e40,_0x4cf90e)=>{var _0x2cc88e=a0_0x37e73e;try{const {FromWareHouse:_0xb3e4,FromRoom:_0x20dbfe,ToWarehouse:_0x12b3aa,ToRoom:_0x361652,product_code:_0x398a06}=_0x767e40['body'],_0x15a874=await warehouse['aggregate']([{'$match':{'name':_0xb3e4}},{'$unwind':_0x2cc88e(0x229)},{'$match':{'product_details.product_code':_0x398a06}},{'$group':{'_id':_0x2cc88e(0x1fc),'name':{'$first':_0x2cc88e(0x22b)},'primary_code':{'$first':_0x2cc88e(0x203)},'secondary_code':{'$first':_0x2cc88e(0x1b8)},'product_code':{'$first':_0x2cc88e(0x225)},'instock':{'$first':_0x2cc88e(0x1b3)},'warehouse':{'$first':_0x2cc88e(0x219)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x2cc88e(0x174)},'pallet':{'$first':_0x2cc88e(0x1d2)},'maxProducts':{'$first':_0x2cc88e(0x151)},'unit':{'$first':_0x2cc88e(0x1bf)}}}]);_0x4cf90e[_0x2cc88e(0x212)](0xc8)[_0x2cc88e(0x224)](_0x15a874);}catch(_0x22c92f){_0x4cf90e[_0x2cc88e(0x212)](0x194)['json']({'message':_0x22c92f[_0x2cc88e(0x146)]});}}),router[a0_0x37e73e(0x1bb)]('/CheckingWarehouse',async(_0x2ddfb2,_0x9a3c5)=>{var _0x4f380d=a0_0x37e73e;const {level:_0x5da40e,isle:_0x4bffd8,pallet:_0x35b581,warehouses:_0x40d836,room:_0x562847}=_0x2ddfb2['body'];try{const _0x2ed42c=await warehouse['aggregate']([{'$match':{'name':_0x40d836,'room':_0x562847}},{'$unwind':_0x4f380d(0x229)},{'$match':{'product_details.level':parseInt(_0x5da40e),'product_details.isle':_0x4bffd8,'product_details.pallet':parseInt(_0x35b581)}},{'$group':{'_id':_0x4f380d(0x1fc),'name':{'$first':_0x4f380d(0x22b)},'product_stock':{'$first':_0x4f380d(0x1b3)},'level':{'$first':_0x4f380d(0x1e5)},'isle':{'$first':_0x4f380d(0x174)},'pallet':{'$first':_0x4f380d(0x1d2)},'maxProducts':{'$first':_0x4f380d(0x151)}}}]);_0x9a3c5['status'](0xc8)['json'](_0x2ed42c);}catch(_0x2f14b3){_0x9a3c5[_0x4f380d(0x212)](0x194)[_0x4f380d(0x224)]({'message':_0x2f14b3[_0x4f380d(0x146)]});}}),module[a0_0x37e73e(0x1eb)]=router;