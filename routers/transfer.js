function a0_0x5d34(){var _0xc5ba26=['to_prod_qty','Spanish','from_prod_pallet','$product_details.primary_code','to_prod_level','$product_details.bay','Rack\x20E','production_date','message','$product_details.storage','product_details','forEach','product_stock','secondary_code','success','$product_details.level','split','email','from_storage','max_per_unit','985232Uxzuzq','<div>','</tr>','<h5\x20style=\x22text-align:\x20left;\x22>','from_floorlevel','from_types','map','nodemailer','Raw\x20Materials','English','1377318wNucdV','product_code3','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','edit_transfer_view','<tr>','$isAllowEdit','product_name','$product_details.secondary_unit','Rack\x20F','</h5>','$product_details.bin','True','/CheckingWarehouse','params','$product_details.product_code','body','to_types','Ambient','storage','prod_cat','380211duwGDO','invoice','<span\x20style=\x22float:\x20right;\x22>','\x20</h2>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Shelves','Rack\x20B','port','Error\x20Occurs','to_room_name','to_invoice','German','to_prod_pallet','from_prod_isle','Arabic','An\x20error\x20occurred\x20while\x20saving\x20data.','from_bin','$room','status','/view/:id','$date','Portuguese\x20(BR)','Receiving\x20Area','createTransport','image','$product_details.secondary_code','findOne','French','to_room','master','</span>','ToRoomAssigned','<strong>\x20Regards\x20</strong>','<!DOCTYPE\x20html>','$product_details.rack','language','Level','Enabled','add_transfer','push','$product.from_room_name','to_prod_isle','Logo.png','/upload/','</tbody>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','297366YCKBSf','render','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','updateOne','<h2>\x20','getMonth','get','TRF-','/preview/:id','Portuguese','Transfer\x20Edit\x20Successfully','bay','floor','English\x20(US)','length','type','$product_details.product_name','$product_details.batch_code','filter','expiry_date','$_id','from_room','MaxStocks_data2','json','from_bay','\x20Order\x20Number\x20:\x20','from_invoice','$product_details.unit','user','../public/language/languages.json','Rack\x20C','to_quantity','$product_details','then','Arabic\x20(ae)','rack','bin','/barcode_scanner2','767404kcfqum','toString','An\x20error\x20occurred.','batch_code','prod_name','$product_details.maxPerUnit','</td>','primary_unit','error','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/picking_list/PDF_transfer_rm/','/view/add_transfer','$to_warehouse','string','Rack\x20D','all','/transfer/preview/','to_bin','from_room_name','to_bay','findById','Rack\x20A','New_Qty_Converted','</div>','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','RoomAssigned','concat','from_rack','save','To_invoice','$product_details.floorlevel','from_warehouse','from_prod_level','</thead>','floorlevel','557179gCciaj','$product_details.expiry_date','logo','rak','from_prod_qty','Router','unit','8623888kEdDAU','errors','redirect','post','to_warehouse','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.isle','slice','site_title','getDate','staff','role','Product\x20Transfer\x20successfully','/barcode_scanner3','$product_details.pallet','/transfer/view','exports','$product_details.type','5vmUpPH','$product.to_room_name','host','Transfer\x20Mail','</head><body>','$product','date','catch','product','from_rak','$product_details.maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','../middleware/auth','secondary_unit','to_floorlevel','Floor','$product_details._id','<html><head><title></title>','maxperunit','password','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','warehouse','aggregate','Enclosed','maxProducts','Transfer\x20Finalize\x20Successfully','find','from_quantity','_id','/../public','express','<h5>','flash','Hindi','\x20Order\x20Date\x20:\x20','edit_transfer','<tbody\x20style=\x22text-align:\x20center;\x22>','primary_code'];a0_0x5d34=function(){return _0xc5ba26;};return a0_0x5d34();}var a0_0x3355c1=a0_0x1693;(function(_0x11ad97,_0x3a5071){var _0x213306=a0_0x1693,_0x5d7a8f=_0x11ad97();while(!![]){try{var _0x25ed02=-parseInt(_0x213306(0x1d9))/0x1+-parseInt(_0x213306(0x22e))/0x2+parseInt(_0x213306(0x207))/0x3+-parseInt(_0x213306(0x1bb))/0x4+parseInt(_0x213306(0x17f))/0x5*(parseInt(_0x213306(0x1c5))/0x6)+-parseInt(_0x213306(0x252))/0x7+parseInt(_0x213306(0x259))/0x8;if(_0x25ed02===_0x3a5071)break;else _0x5d7a8f['push'](_0x5d7a8f['shift']());}catch(_0x226386){_0x5d7a8f['push'](_0x5d7a8f['shift']());}}}(a0_0x5d34,0x4d5ab));const express=require(a0_0x3355c1(0x19f)),app=express(),router=express[a0_0x3355c1(0x257)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x3355c1(0x18b)),users=require(a0_0x3355c1(0x225)),nodemailer=require(a0_0x3355c1(0x1c2));router[a0_0x3355c1(0x20e)]('/view',auth,async(_0x45f730,_0xa237ad)=>{var _0xec780f=a0_0x3355c1;try{const {username:_0x477ad3,email:_0x5de341,role:_0x3b0971}=_0x45f730[_0xec780f(0x224)],_0x3704cd=_0x45f730[_0xec780f(0x224)],_0x34c81c=await profile[_0xec780f(0x1f3)]({'email':_0x3704cd[_0xec780f(0x1b8)]}),_0x163a00=await master_shop[_0xec780f(0x19b)]();console[_0xec780f(0x209)](_0xec780f(0x1f6),_0x163a00);let _0x1b7b44;if(_0x3704cd[_0xec780f(0x178)]==_0xec780f(0x177)){const _0xbc5cc2=await staff[_0xec780f(0x1f3)]({'email':_0x3704cd[_0xec780f(0x1b8)]});_0x1b7b44=await transfers['find']({'from_warehouse':_0xbc5cc2[_0xec780f(0x196)]});}else _0x1b7b44=await transfers[_0xec780f(0x197)]([{'$unwind':_0xec780f(0x184)},{'$group':{'_id':_0xec780f(0x21c),'invoice':{'$first':'$invoice'},'date':{'$first':_0xec780f(0x1ed)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0xec780f(0x23a)},'from_room_name':{'$addToSet':_0xec780f(0x201)},'to_room_name':{'$addToSet':_0xec780f(0x180)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0xec780f(0x1ca)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x163a00[0x0]['language']==_0xec780f(0x215)){var _0x3e8359=users[_0xec780f(0x1c4)];console[_0xec780f(0x209)](_0x3e8359);}else{if(_0x163a00[0x0][_0xec780f(0x1fc)]==_0xec780f(0x1a2))var _0x3e8359=users[_0xec780f(0x1a2)];else{if(_0x163a00[0x0][_0xec780f(0x1fc)]==_0xec780f(0x1e4))var _0x3e8359=users['German'];else{if(_0x163a00[0x0]['language']==_0xec780f(0x1a8))var _0x3e8359=users[_0xec780f(0x1a8)];else{if(_0x163a00[0x0]['language']==_0xec780f(0x1f4))var _0x3e8359=users[_0xec780f(0x1f4)];else{if(_0x163a00[0x0]['language']==_0xec780f(0x1ee))var _0x3e8359=users['Portuguese'];else{if(_0x163a00[0x0][_0xec780f(0x1fc)]==_0xec780f(0x171))var _0x3e8359=users[_0xec780f(0x171)];else{if(_0x163a00[0x0][_0xec780f(0x1fc)]==_0xec780f(0x22a))var _0x3e8359=users[_0xec780f(0x1e7)];}}}}}}}_0xa237ad[_0xec780f(0x208)]('transfer',{'success':_0x45f730['flash'](_0xec780f(0x1b5)),'errors':_0x45f730['flash'](_0xec780f(0x25a)),'role':_0x3704cd,'profile':_0x34c81c,'master_shop':_0x163a00,'transfer':_0x1b7b44,'language':_0x3e8359});}catch(_0x5648b1){console[_0xec780f(0x209)](_0x5648b1);}});function a0_0x1693(_0x265344,_0x1f6fbf){var _0x5d34d9=a0_0x5d34();return a0_0x1693=function(_0x1693ca,_0x30ec8b){_0x1693ca=_0x1693ca-0x16f;var _0x49ead0=_0x5d34d9[_0x1693ca];return _0x49ead0;},a0_0x1693(_0x265344,_0x1f6fbf);}async function getRandom8DigitNumber(){var _0x152c1e=a0_0x3355c1;const _0x292c3c=0x989680,_0x5e1116=0x5f5e0ff,_0x127c2e=Math[_0x152c1e(0x214)](Math['random']()*(_0x5e1116-_0x292c3c+0x1))+_0x292c3c;var _0x404f6b;const _0x891262=await transfers[_0x152c1e(0x1f3)]({'invoice':_0x152c1e(0x20f)+_0x127c2e});return _0x891262&&_0x891262[_0x152c1e(0x216)]>0x0?_0x404f6b=_0x152c1e(0x20f)+_0x127c2e:_0x404f6b=_0x152c1e(0x20f)+_0x127c2e,_0x404f6b;}router[a0_0x3355c1(0x20e)](a0_0x3355c1(0x239),auth,async(_0x4fe1bd,_0x1df73a)=>{var _0x128f92=a0_0x3355c1;try{const {username:_0x25fc66,email:_0x3febae,role:_0x4943a8}=_0x4fe1bd[_0x128f92(0x224)],_0x57c1d7=_0x4fe1bd['user'],_0x5ba045=await profile[_0x128f92(0x1f3)]({'email':_0x57c1d7['email']}),_0x53b4e7=await master_shop[_0x128f92(0x19b)]();console[_0x128f92(0x209)](_0x128f92(0x1f6),_0x53b4e7);let _0x82f08d;if(_0x57c1d7['role']=='staff'){const _0x3dd10e=await staff[_0x128f92(0x1f3)]({'email':_0x57c1d7[_0x128f92(0x1b8)]});_0x82f08d=await warehouse[_0x128f92(0x197)]([{'$match':{'status':_0x128f92(0x1fe),'name':_0x3dd10e[_0x128f92(0x196)],'warehouse_category':_0x128f92(0x1c3)}},{'$group':{'_id':_0x128f92(0x246),'name':{'$first':_0x128f92(0x246)}}}]);}else _0x82f08d=await warehouse[_0x128f92(0x197)]([{'$match':{'status':_0x128f92(0x1fe),'warehouse_category':_0x128f92(0x1c3)}},{'$group':{'_id':_0x128f92(0x246),'name':{'$first':_0x128f92(0x246)}}}]);var _0x1f364d=[_0x128f92(0x1d6),_0x128f92(0x198),'Return\x20Rooms'];const _0x1910b0=await transfers[_0x128f92(0x19b)]({}),_0x39521a=_0x1910b0[_0x128f92(0x216)]+0x1,_0x4ae1d1=_0x128f92(0x20f)+_0x39521a[_0x128f92(0x22f)]()['padStart'](0x5,'0');if(_0x53b4e7[0x0]['language']==_0x128f92(0x215)){var _0x104107=users['English'];console[_0x128f92(0x209)](_0x104107);}else{if(_0x53b4e7[0x0][_0x128f92(0x1fc)]==_0x128f92(0x1a2))var _0x104107=users[_0x128f92(0x1a2)];else{if(_0x53b4e7[0x0]['language']=='German')var _0x104107=users['German'];else{if(_0x53b4e7[0x0][_0x128f92(0x1fc)]==_0x128f92(0x1a8))var _0x104107=users[_0x128f92(0x1a8)];else{if(_0x53b4e7[0x0]['language']==_0x128f92(0x1f4))var _0x104107=users[_0x128f92(0x1f4)];else{if(_0x53b4e7[0x0][_0x128f92(0x1fc)]==_0x128f92(0x1ee))var _0x104107=users[_0x128f92(0x211)];else{if(_0x53b4e7[0x0][_0x128f92(0x1fc)]=='Chinese')var _0x104107=users[_0x128f92(0x171)];else{if(_0x53b4e7[0x0][_0x128f92(0x1fc)]==_0x128f92(0x22a))var _0x104107=users['Arabic'];}}}}}}}const _0x11b5c6=getRandom8DigitNumber();_0x11b5c6['then'](_0x2799b2=>{var _0x1b78eb=_0x128f92;_0x1df73a[_0x1b78eb(0x208)](_0x1b78eb(0x1ff),{'success':_0x4fe1bd[_0x1b78eb(0x1a1)](_0x1b78eb(0x1b5)),'errors':_0x4fe1bd[_0x1b78eb(0x1a1)](_0x1b78eb(0x25a)),'role':_0x57c1d7,'profile':_0x5ba045,'master_shop':_0x53b4e7,'warehouse':_0x82f08d,'language':_0x104107,'rooms_data':_0x1f364d,'invoice':_0x2799b2});})[_0x128f92(0x186)](_0x5eb749=>{var _0x46fe5a=_0x128f92;_0x4fe1bd[_0x46fe5a(0x1a1)](_0x46fe5a(0x25a),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1df73a[_0x46fe5a(0x25b)](_0x46fe5a(0x17c));});}catch(_0x57cebc){console['log'](_0x57cebc);}}),router[a0_0x3355c1(0x16f)](a0_0x3355c1(0x239),auth,async(_0x319daf,_0x563eda)=>{var _0x57d8bb=a0_0x3355c1;try{console[_0x57d8bb(0x209)](_0x319daf[_0x57d8bb(0x1d4)]);const {date:_0x56ffb6,from_warehouse:_0x501b32,FromRoom_name:_0x2b7e3b,to_warehouse:_0xad8fcb,ToRoom_name:_0x541792,prod_name:_0x1430ed,from_prod_qty:_0x502a89,from_prod_level:_0x559833,from_prod_isle:_0xc25524,from_prod_pallet:_0x9b5db,to_prod_qty:_0x5bf84a,to_prod_level:_0x57763e,to_prod_isle:_0x118210,to_prod_pallet:_0x1e5970,primary_code:_0x21cdd4,secondary_code:_0x3f41d0,product_code3:_0x60170,note:_0x3d9fa4,MaxStocks_data2:_0x12e092,invoice:_0x4f9497,expiry_date:_0x54264a}=_0x319daf['body'];if(typeof _0x1430ed==_0x57d8bb(0x23b))var _0x4549e0=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x232)]],_0x5074b4=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x256)]],_0x3505e8=[_0x319daf['body'][_0x57d8bb(0x24f)]],_0x4ea085=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x244)]],_0x12447d=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1ab)]],_0x1f17ae=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1a6)]],_0x2cf1d7=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1b4)]],_0x9e6c81=[_0x319daf['body'][_0x57d8bb(0x1c6)]],_0x4f2daf=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x21e)]],_0x585af0=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x235)]],_0x552480=[_0x319daf[_0x57d8bb(0x1d4)]['secondary_unit']],_0x5addb1=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x231)]],_0x36a6a0=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x21b)]],_0x53ccf5=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1ba)]],_0x4174b8=[_0x319daf['body']['production_date']],_0x3acc97=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1d8)]],_0x136931=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x248)]],_0x3370ed=[_0x319daf[_0x57d8bb(0x1d4)]['ToRoomAssigned']],_0x4af614=[_0x319daf['body'][_0x57d8bb(0x222)]],_0xba4d90=[_0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1e3)]];else var _0x4549e0=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x232)]],_0x5074b4=[..._0x319daf['body'][_0x57d8bb(0x256)]],_0x3505e8=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x24f)]],_0x4ea085=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x244)]],_0x12447d=[..._0x319daf['body'][_0x57d8bb(0x1ab)]],_0x1f17ae=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1a6)]],_0x2cf1d7=[..._0x319daf[_0x57d8bb(0x1d4)]['secondary_code']],_0x9e6c81=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1c6)]],_0x4f2daf=[..._0x319daf['body']['MaxStocks_data2']],_0x585af0=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x235)]],_0x552480=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x18c)]],_0x5addb1=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x231)]],_0x36a6a0=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x21b)]],_0x53ccf5=[..._0x319daf[_0x57d8bb(0x1d4)]['max_per_unit']],_0x4174b8=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1ae)]],_0x3acc97=[..._0x319daf['body'][_0x57d8bb(0x1d8)]],_0x136931=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x248)]],_0x3370ed=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x1f8)]],_0x4af614=[..._0x319daf[_0x57d8bb(0x1d4)][_0x57d8bb(0x222)]],_0xba4d90=[..._0x319daf['body']['to_invoice']];const _0x44fd24=_0x4549e0[_0x57d8bb(0x1c1)](_0x3a2aaa=>{return _0x3a2aaa={'product_name':_0x3a2aaa};});_0x5074b4[_0x57d8bb(0x1b2)]((_0x2dc12d,_0x464be1)=>{var _0x117cc5=_0x57d8bb;_0x44fd24[_0x464be1][_0x117cc5(0x19c)]=_0x2dc12d;}),_0x4af614[_0x57d8bb(0x1b2)]((_0x2653c0,_0x5d9b24)=>{var _0x295ac8=_0x57d8bb;_0x44fd24[_0x5d9b24][_0x295ac8(0x222)]=_0x2653c0;}),_0xba4d90[_0x57d8bb(0x1b2)]((_0x2baba3,_0x364c43)=>{_0x44fd24[_0x364c43]['To_invoice']=_0x2baba3;}),_0x3505e8['forEach']((_0x3d76e8,_0xdc1ce4)=>{_0x136931['forEach']((_0x5acb87,_0xc6d67a)=>{var _0x198eab=a0_0x1693;if(_0x5acb87=='Receiving\x20Area'&&_0xdc1ce4==_0xc6d67a){var _0x5700e2=_0x3d76e8['slice'](0x3);_0x44fd24[_0xdc1ce4]['from_storage']=_0x3d76e8[0x0],_0x44fd24[_0xdc1ce4][_0x198eab(0x24a)]=_0x3d76e8[0x1],_0x44fd24[_0xdc1ce4][_0x198eab(0x220)]=0x0,_0x44fd24[_0xdc1ce4][_0x198eab(0x1e9)]=0x0,_0x44fd24[_0xdc1ce4][_0x198eab(0x1c0)]=_0x198eab(0x18e),_0x44fd24[_0xdc1ce4]['from_floorlevel']=_0x5700e2;}else{if(_0x5acb87=='Shelves'&&_0xdc1ce4==_0xc6d67a){var _0x5700e2=_0x3d76e8['slice'](0x3);_0x44fd24[_0xdc1ce4]['from_storage']=_0x3d76e8[0x0],_0x44fd24[_0xdc1ce4][_0x198eab(0x24a)]=_0x3d76e8[0x1],_0x44fd24[_0xdc1ce4][_0x198eab(0x220)]=0x0,_0x44fd24[_0xdc1ce4]['from_bin']=0x0,_0x44fd24[_0xdc1ce4][_0x198eab(0x1c0)]=_0x198eab(0x18e),_0x44fd24[_0xdc1ce4]['from_floorlevel']=_0x3d76e8[0x5];}else{if(_0xdc1ce4==_0xc6d67a){var _0x1a0bf1;if(_0x3d76e8[0x4]=='L')_0x1a0bf1=_0x198eab(0x1fd);else _0x3d76e8[0x4]=='F'&&(_0x1a0bf1=_0x198eab(0x18e));_0x44fd24[_0xdc1ce4][_0x198eab(0x1b9)]=_0x3d76e8[0x0],_0x44fd24[_0xdc1ce4]['from_rack']=_0x3d76e8[0x1],_0x44fd24[_0xdc1ce4][_0x198eab(0x220)]=_0x3d76e8[0x2],_0x44fd24[_0xdc1ce4][_0x198eab(0x1e9)]=_0x3d76e8[0x3],_0x44fd24[_0xdc1ce4][_0x198eab(0x1c0)]=_0x1a0bf1,_0x44fd24[_0xdc1ce4]['from_floorlevel']=_0x3d76e8[0x5];}}}});}),_0x4ea085['forEach']((_0x9380fa,_0x40dbf3)=>{var _0x4e637c=_0x57d8bb;_0x44fd24[_0x40dbf3][_0x4e637c(0x227)]=_0x9380fa;}),_0x12447d['forEach']((_0x6a934c,_0x5bfd5c)=>{_0x3370ed['forEach']((_0x20dd7c,_0x3802f0)=>{var _0x5eb893=a0_0x1693;if(_0x20dd7c=='Receiving\x20Area'&&_0x5bfd5c==_0x3802f0){var _0x17a786=_0x6a934c['slice'](0x3);_0x44fd24[_0x5bfd5c][_0x5eb893(0x1d7)]=_0x6a934c[0x0],_0x44fd24[_0x5bfd5c][_0x5eb893(0x22b)]=_0x6a934c[0x1],_0x44fd24[_0x5bfd5c]['to_bay']=0x0,_0x44fd24[_0x5bfd5c][_0x5eb893(0x23f)]=0x0,_0x44fd24[_0x5bfd5c][_0x5eb893(0x1d5)]=_0x5eb893(0x18e),_0x44fd24[_0x5bfd5c][_0x5eb893(0x18d)]=_0x17a786;}else{if(_0x20dd7c==_0x5eb893(0x1de)&&_0x5bfd5c==_0x3802f0){var _0x17a786=_0x6a934c[_0x5eb893(0x174)](0x3);_0x44fd24[_0x5bfd5c][_0x5eb893(0x1d7)]=_0x6a934c[0x0],_0x44fd24[_0x5bfd5c]['rack']=_0x6a934c[0x1],_0x44fd24[_0x5bfd5c][_0x5eb893(0x241)]=0x0,_0x44fd24[_0x5bfd5c][_0x5eb893(0x23f)]=0x0,_0x44fd24[_0x5bfd5c]['to_types']=_0x5eb893(0x18e),_0x44fd24[_0x5bfd5c]['to_floorlevel']=_0x6a934c[0x5];}else{if(_0x5bfd5c==_0x3802f0){var _0x4920c3;if(_0x6a934c[0x4]=='L')_0x4920c3=_0x5eb893(0x1fd);else _0x6a934c[0x4]=='F'&&(_0x4920c3=_0x5eb893(0x18e));_0x44fd24[_0x5bfd5c][_0x5eb893(0x1d7)]=_0x6a934c[0x0],_0x44fd24[_0x5bfd5c][_0x5eb893(0x22b)]=_0x6a934c[0x1],_0x44fd24[_0x5bfd5c]['to_bay']=_0x6a934c[0x2],_0x44fd24[_0x5bfd5c][_0x5eb893(0x23f)]=_0x6a934c[0x3],_0x44fd24[_0x5bfd5c][_0x5eb893(0x1d5)]=_0x4920c3,_0x44fd24[_0x5bfd5c][_0x5eb893(0x18d)]=_0x6a934c[0x5];}}}});}),_0x1f17ae[_0x57d8bb(0x1b2)]((_0x5187b4,_0x15047f)=>{_0x44fd24[_0x15047f]['primary_code']=_0x5187b4;}),_0x2cf1d7[_0x57d8bb(0x1b2)]((_0x62b960,_0x49e9b9)=>{_0x44fd24[_0x49e9b9]['secondary_code']=_0x62b960;}),_0x9e6c81[_0x57d8bb(0x1b2)]((_0x3ca099,_0x36a9e6)=>{var _0x5dd025=_0x57d8bb;_0x44fd24[_0x36a9e6][_0x5dd025(0x193)]=_0x3ca099;}),_0x4f2daf[_0x57d8bb(0x1b2)]((_0x895300,_0xe96b0a)=>{var _0x2ea89d=_0x57d8bb;_0x44fd24[_0xe96b0a][_0x2ea89d(0x199)]=_0x895300;}),_0x585af0['forEach']((_0x11941d,_0x3f02af)=>{var _0x2b1591=_0x57d8bb;_0x44fd24[_0x3f02af][_0x2b1591(0x258)]=_0x11941d;}),_0x552480[_0x57d8bb(0x1b2)]((_0x25c30f,_0x3b7511)=>{var _0x39eea9=_0x57d8bb;_0x44fd24[_0x3b7511][_0x39eea9(0x18c)]=_0x25c30f;}),_0x5addb1['forEach']((_0x27528a,_0xc6c33f)=>{var _0x123380=_0x57d8bb;_0x44fd24[_0xc6c33f][_0x123380(0x231)]=_0x27528a;}),_0x36a6a0[_0x57d8bb(0x1b2)]((_0x1e25da,_0x5929da)=>{var _0x23cac7=_0x57d8bb;_0x44fd24[_0x5929da][_0x23cac7(0x21b)]=_0x1e25da;}),_0x53ccf5[_0x57d8bb(0x1b2)]((_0x12d036,_0x48c708)=>{var _0x1eab5b=_0x57d8bb;_0x44fd24[_0x48c708][_0x1eab5b(0x191)]=_0x12d036;}),_0x4174b8[_0x57d8bb(0x1b2)]((_0x3be1b3,_0x39956b)=>{var _0x394ecc=_0x57d8bb;_0x44fd24[_0x39956b][_0x394ecc(0x1ae)]=_0x3be1b3;}),_0x3acc97[_0x57d8bb(0x1b2)]((_0xeae168,_0x9bd64d)=>{var _0x81d363=_0x57d8bb;_0x44fd24[_0x9bd64d][_0x81d363(0x1d8)]=_0xeae168;}),_0x136931['forEach']((_0x2f46d6,_0x5bcbc5)=>{var _0xd9c4c8=_0x57d8bb;_0x44fd24[_0x5bcbc5][_0xd9c4c8(0x240)]=_0x2f46d6;}),_0x3370ed[_0x57d8bb(0x1b2)]((_0x41bb4e,_0xc62c72)=>{_0x44fd24[_0xc62c72]['to_room_name']=_0x41bb4e;});const _0x44e828=_0x44fd24['filter'](_0x3e5f07=>_0x3e5f07[_0x57d8bb(0x227)]!=='0'&&_0x3e5f07[_0x57d8bb(0x227)]!==''||_0x3e5f07[_0x57d8bb(0x18d)]!=='0'&&_0x3e5f07[_0x57d8bb(0x18d)]!==''),_0x38f05d=new transfers({'date':_0x56ffb6,'from_warehouse':_0x501b32,'to_warehouse':_0xad8fcb,'product':_0x44e828,'note':_0x3d9fa4,'invoice':_0x4f9497}),_0x4e83c7=await _0x38f05d[_0x57d8bb(0x24b)]();_0x319daf['flash'](_0x57d8bb(0x1b5),_0x57d8bb(0x179)),_0x563eda[_0x57d8bb(0x25b)](_0x57d8bb(0x23e)+_0x4e83c7[_0x57d8bb(0x19d)]);}catch(_0x69f14a){console[_0x57d8bb(0x209)](_0x69f14a),_0x563eda[_0x57d8bb(0x1eb)](0xc8)['json']({'errorMessage':_0x69f14a[_0x57d8bb(0x1af)]});}}),router[a0_0x3355c1(0x20e)](a0_0x3355c1(0x210),auth,async(_0x4b4f4c,_0x12fbc4)=>{var _0x2dab9b=a0_0x3355c1;try{const {username:_0x31341e,email:_0x457c2f,role:_0x5853a1}=_0x4b4f4c['user'],_0x87a7b5=_0x4b4f4c[_0x2dab9b(0x224)],_0xfe68e6=await profile[_0x2dab9b(0x1f3)]({'email':_0x87a7b5[_0x2dab9b(0x1b8)]}),_0x3ac5b6=await master_shop['find']();console['log'](_0x2dab9b(0x1f6),_0x3ac5b6);const _0x388148=await transfers['findById'](_0x4b4f4c[_0x2dab9b(0x1d2)]['id']);let _0x1d3b40=new Date(_0x388148[_0x2dab9b(0x21b)]),_0x3d3f24=('0'+_0x1d3b40[_0x2dab9b(0x176)]())[_0x2dab9b(0x174)](-0x2),_0x277ecc=('0'+(_0x1d3b40[_0x2dab9b(0x20d)]()+0x1))[_0x2dab9b(0x174)](-0x2),_0x1b139c=_0x1d3b40['getFullYear'](),_0x683673=_0x1b139c+'-'+_0x277ecc+'-'+_0x3d3f24,_0x246ed0;if(_0x87a7b5[_0x2dab9b(0x178)]==_0x2dab9b(0x177)){const _0x932b33=await staff[_0x2dab9b(0x1f3)]({'email':_0x87a7b5[_0x2dab9b(0x1b8)]});_0x246ed0=await warehouse[_0x2dab9b(0x19b)]({'status':'Enabled','name':_0x932b33[_0x2dab9b(0x196)],'warehouse_category':'Raw\x20Materials'});}else _0x246ed0=await warehouse[_0x2dab9b(0x19b)]({'status':_0x2dab9b(0x1fe),'warehouse_category':_0x2dab9b(0x1c3)});const _0x1fa34d=await warehouse[_0x2dab9b(0x197)]([{'$match':{'name':_0x388148[_0x2dab9b(0x24e)]}},{'$unwind':_0x2dab9b(0x228)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2dab9b(0x1ac)},'bin':{'$first':_0x2dab9b(0x1cf)},'type':{'$first':_0x2dab9b(0x17e)},'floorlevel':{'$first':_0x2dab9b(0x24d)},'primary_code':{'$first':_0x2dab9b(0x1aa)},'secondary_code':{'$first':_0x2dab9b(0x1f2)},'product_code':{'$first':_0x2dab9b(0x1d3)},'storage':{'$first':_0x2dab9b(0x1b0)},'rack':{'$first':_0x2dab9b(0x1fb)},'expiry_date':{'$first':_0x2dab9b(0x253)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]);if(_0x3ac5b6[0x0][_0x2dab9b(0x1fc)]==_0x2dab9b(0x215)){var _0x2bbeee=users[_0x2dab9b(0x1c4)];console[_0x2dab9b(0x209)](_0x2bbeee);}else{if(_0x3ac5b6[0x0]['language']==_0x2dab9b(0x1a2))var _0x2bbeee=users[_0x2dab9b(0x1a2)];else{if(_0x3ac5b6[0x0][_0x2dab9b(0x1fc)]==_0x2dab9b(0x1e4))var _0x2bbeee=users[_0x2dab9b(0x1e4)];else{if(_0x3ac5b6[0x0][_0x2dab9b(0x1fc)]==_0x2dab9b(0x1a8))var _0x2bbeee=users['Spanish'];else{if(_0x3ac5b6[0x0][_0x2dab9b(0x1fc)]=='French')var _0x2bbeee=users[_0x2dab9b(0x1f4)];else{if(_0x3ac5b6[0x0][_0x2dab9b(0x1fc)]==_0x2dab9b(0x1ee))var _0x2bbeee=users[_0x2dab9b(0x211)];else{if(_0x3ac5b6[0x0]['language']=='Chinese')var _0x2bbeee=users[_0x2dab9b(0x171)];else{if(_0x3ac5b6[0x0][_0x2dab9b(0x1fc)]==_0x2dab9b(0x22a))var _0x2bbeee=users[_0x2dab9b(0x1e7)];}}}}}}}_0x12fbc4[_0x2dab9b(0x208)](_0x2dab9b(0x1c8),{'success':_0x4b4f4c[_0x2dab9b(0x1a1)]('success'),'errors':_0x4b4f4c[_0x2dab9b(0x1a1)](_0x2dab9b(0x25a)),'role':_0x87a7b5,'profile':_0xfe68e6,'master_shop':_0x3ac5b6,'warehouse':_0x246ed0,'transfer':_0x388148,'stock':_0x1fa34d,'language':_0x2bbeee});}catch(_0x7f9395){console['log'](_0x7f9395);}}),router[a0_0x3355c1(0x16f)](a0_0x3355c1(0x210),auth,async(_0x1de512,_0x544e96)=>{var _0x17d7e4=a0_0x3355c1;try{const _0x663989=_0x1de512[_0x17d7e4(0x1d2)]['id'],{from_warehouse:_0x400dd0,FromRoom_name:_0x3cf45a,to_warehouse:_0x5c0742,ToRoom_name:_0x298c11}=_0x1de512[_0x17d7e4(0x1d4)],_0x4ecf76=await transfers[_0x17d7e4(0x242)]({'_id':_0x663989}),_0x3f0398=_0x4ecf76['product'][_0x17d7e4(0x1c1)](async _0x2de960=>{var _0xef907e=_0x17d7e4;if(_0x2de960[_0xef907e(0x227)]>0x0){var _0x1b22a6=await warehouse[_0xef907e(0x1f3)]({'name':_0x4ecf76[_0xef907e(0x24e)],'room':_0x2de960['from_room_name'],'warehouse_category':'Raw\x20Materials'});const _0x36a004=_0x1b22a6[_0xef907e(0x1b1)][_0xef907e(0x1c1)](_0x5099a1=>{var _0x4996fa=_0xef907e;_0x5099a1[_0x4996fa(0x1cb)]==_0x2de960[_0x4996fa(0x1cb)]&&_0x5099a1['floorlevel']==_0x2de960[_0x4996fa(0x1bf)]&&_0x5099a1[_0x4996fa(0x217)]==_0x2de960[_0x4996fa(0x1c0)]&&_0x5099a1[_0x4996fa(0x22c)]==_0x2de960[_0x4996fa(0x1e9)]&&_0x5099a1[_0x4996fa(0x213)]==_0x2de960[_0x4996fa(0x220)]&&_0x5099a1[_0x4996fa(0x22b)]==_0x2de960['from_rack']&&_0x5099a1['storage']==_0x2de960[_0x4996fa(0x1b9)]&&_0x5099a1[_0x4996fa(0x21b)]==_0x2de960[_0x4996fa(0x21b)]&&_0x5099a1[_0x4996fa(0x231)]==_0x2de960[_0x4996fa(0x231)]&&_0x5099a1['production_date']==_0x2de960[_0x4996fa(0x1ae)]&&_0x5099a1[_0x4996fa(0x1da)]==_0x2de960[_0x4996fa(0x222)]&&(_0x5099a1[_0x4996fa(0x1b3)]=_0x5099a1[_0x4996fa(0x1b3)]-_0x2de960[_0x4996fa(0x227)]);});}return _0x1b22a6;});Promise[_0x17d7e4(0x23d)](_0x3f0398)[_0x17d7e4(0x229)](async _0x1f97a0=>{var _0x2878cd=_0x17d7e4;try{for(const _0x1b9b99 of _0x1f97a0){await _0x1b9b99['save']();}try{const _0x36904c=_0x4ecf76[_0x2878cd(0x187)][_0x2878cd(0x1c1)](async _0x418740=>{var _0x523a9e=_0x2878cd;if(_0x418740[_0x523a9e(0x227)]>0x0){var _0x335b6a=await warehouse[_0x523a9e(0x1f3)]({'name':_0x4ecf76[_0x523a9e(0x170)],'room':_0x418740[_0x523a9e(0x1e2)],'warehouse_category':_0x523a9e(0x1c3)}),_0x7fae55=0x0;const _0x4b1683=_0x335b6a[_0x523a9e(0x1b1)][_0x523a9e(0x1c1)](_0x4d610b=>{var _0x2b0e4f=_0x523a9e;_0x4d610b['product_name']==_0x418740[_0x2b0e4f(0x1cb)]&&_0x4d610b['floorlevel']==_0x418740[_0x2b0e4f(0x18d)]&&_0x4d610b[_0x2b0e4f(0x217)]==_0x418740['to_types']&&_0x4d610b[_0x2b0e4f(0x22c)]==_0x418740['to_bin']&&_0x4d610b[_0x2b0e4f(0x213)]==_0x418740[_0x2b0e4f(0x241)]&&_0x4d610b[_0x2b0e4f(0x22b)]==_0x418740[_0x2b0e4f(0x22b)]&&_0x4d610b['storage']==_0x418740['storage']&&_0x4d610b[_0x2b0e4f(0x21b)]==_0x418740[_0x2b0e4f(0x21b)]&&_0x4d610b['batch_code']==_0x418740['batch_code']&&_0x4d610b[_0x2b0e4f(0x1ae)]==_0x418740[_0x2b0e4f(0x1ae)]&&_0x4d610b['invoice']==_0x418740[_0x2b0e4f(0x24c)]&&(_0x4d610b[_0x2b0e4f(0x1b3)]=_0x4d610b[_0x2b0e4f(0x1b3)]+_0x418740[_0x2b0e4f(0x227)],_0x7fae55++);});_0x7fae55=='0'&&(_0x335b6a[_0x523a9e(0x1b1)]=_0x335b6a[_0x523a9e(0x1b1)][_0x523a9e(0x249)]({'product_name':_0x418740['product_name'],'product_stock':_0x418740[_0x523a9e(0x227)],'bay':_0x418740[_0x523a9e(0x241)],'bin':_0x418740['to_bin'],'type':_0x418740[_0x523a9e(0x1d5)],'floorlevel':_0x418740[_0x523a9e(0x18d)],'storage':_0x418740[_0x523a9e(0x1d7)],'rack':_0x418740[_0x523a9e(0x22b)],'product_code':_0x418740[_0x523a9e(0x193)],'primary_code':_0x418740['primary_code'],'secondary_code':_0x418740[_0x523a9e(0x1b4)],'maxProducts':_0x418740[_0x523a9e(0x199)],'storage':_0x418740[_0x523a9e(0x1d7)],'rack':_0x418740[_0x523a9e(0x22b)],'expiry_date':_0x418740[_0x523a9e(0x21b)],'maxPerUnit':_0x418740[_0x523a9e(0x191)],'batch_code':_0x418740[_0x523a9e(0x231)],'production_date':_0x418740[_0x523a9e(0x1ae)]}));}return _0x335b6a;});Promise[_0x2878cd(0x23d)](_0x36904c)[_0x2878cd(0x229)](async _0x2a3b61=>{var _0x4b278c=_0x2878cd;try{for(const _0x49c844 of _0x2a3b61){await warehouse[_0x4b278c(0x20b)]({'_id':_0x49c844[_0x4b278c(0x19d)]},{'$addToSet':{'product_details':{'$each':_0x49c844[_0x4b278c(0x1b1)]}}});}_0x4ecf76['finalize']=_0x4b278c(0x1d0);const _0x4e4dc0=await _0x4ecf76[_0x4b278c(0x24b)](),_0x2528a1=await master_shop[_0x4b278c(0x19b)](),_0x139483=await email_settings['findOne'](),_0x299ebe=await supervisor_settings['find']();var _0x1cbed0=_0x4ecf76[_0x4b278c(0x187)],_0x4b3981='',_0x427b0d;for(_0x427b0d in _0x1cbed0){_0x4b3981+=_0x4b278c(0x1c9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1cbed0[_0x427b0d][_0x4b278c(0x1cb)]+_0x4b278c(0x234)+_0x4b278c(0x237)+_0x1cbed0[_0x427b0d]['product_code']+'</td>'+_0x4b278c(0x237)+_0x1cbed0[_0x427b0d]['to_quantity']+_0x4b278c(0x234)+_0x4b278c(0x237)+_0x1cbed0[_0x427b0d][_0x4b278c(0x258)]+_0x4b278c(0x234)+_0x4b278c(0x237)+_0x1cbed0[_0x427b0d][_0x4b278c(0x18c)]+_0x4b278c(0x234)+_0x4b278c(0x237)+_0x4ecf76[_0x4b278c(0x170)]+_0x4b278c(0x234)+_0x4b278c(0x237)+_0x1cbed0[_0x427b0d]['to_room_name']+'</td>'+_0x4b278c(0x237)+_0x1cbed0[_0x427b0d][_0x4b278c(0x1d7)]+_0x1cbed0[_0x427b0d][_0x4b278c(0x22b)]+_0x1cbed0[_0x427b0d][_0x4b278c(0x241)]+_0x1cbed0[_0x427b0d][_0x4b278c(0x23f)]+_0x1cbed0[_0x427b0d][_0x4b278c(0x1d5)][0x0]+_0x1cbed0[_0x427b0d][_0x4b278c(0x18d)]+'</td>',_0x4b278c(0x1bd);}let _0x3f4823=nodemailer[_0x4b278c(0x1f0)]({'host':_0x139483[_0x4b278c(0x181)],'port':Number(_0x139483[_0x4b278c(0x1e0)]),'secure':![],'auth':{'user':_0x139483['email'],'pass':_0x139483[_0x4b278c(0x192)]}}),_0x16ff9a={'from':_0x139483[_0x4b278c(0x1b8)],'to':_0x299ebe[0x0]['RMSEmail'],'subject':_0x4b278c(0x182),'attachments':[{'filename':_0x4b278c(0x203),'path':__dirname+_0x4b278c(0x19e)+_0x4b278c(0x204)+_0x2528a1[0x0][_0x4b278c(0x1f1)],'cid':_0x4b278c(0x254)}],'html':_0x4b278c(0x1fa)+_0x4b278c(0x190)+_0x4b278c(0x183)+_0x4b278c(0x1bc)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x4b278c(0x1bc)+_0x4b278c(0x1c7)+_0x4b278c(0x245)+_0x4b278c(0x1bc)+_0x4b278c(0x20c)+_0x2528a1[0x0][_0x4b278c(0x175)]+_0x4b278c(0x1dc)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x4b278c(0x1bc)+_0x4b278c(0x1be)+_0x4b278c(0x221)+_0x4ecf76[_0x4b278c(0x1da)]+'\x20'+_0x4b278c(0x1db)+_0x4b278c(0x1a3)+_0x4ecf76[_0x4b278c(0x185)]+'\x20'+_0x4b278c(0x1f7)+'</h5>'+_0x4b278c(0x245)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4b278c(0x1dd)+'<tr>'+_0x4b278c(0x18a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x4b278c(0x247)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x4b278c(0x195)+_0x4b278c(0x194)+_0x4b278c(0x172)+_0x4b278c(0x20a)+_0x4b278c(0x1bd)+_0x4b278c(0x250)+_0x4b278c(0x1a5)+'\x20'+_0x4b3981+'\x20'+_0x4b278c(0x205)+'</table>'+_0x4b278c(0x1bc)+_0x4b278c(0x1f9)+_0x4b278c(0x1a0)+_0x2528a1[0x0]['site_title']+_0x4b278c(0x1ce)+'</div>'+_0x4b278c(0x245)+'</body></html>'};_0x3f4823['sendMail'](_0x16ff9a,function(_0x5a317c,_0x2a7365){var _0x3feb0c=_0x4b278c;_0x5a317c?(console[_0x3feb0c(0x209)](_0x5a317c),console[_0x3feb0c(0x209)](_0x3feb0c(0x1e1))):console[_0x3feb0c(0x209)]('Email\x20sent\x20successfully');}),_0x1de512[_0x4b278c(0x1a1)](_0x4b278c(0x1b5),_0x4b278c(0x19a)),_0x544e96[_0x4b278c(0x25b)](_0x4b278c(0x238)+_0x4e4dc0[_0x4b278c(0x19d)]);}catch(_0x2b2121){console[_0x4b278c(0x236)](_0x2b2121),_0x544e96[_0x4b278c(0x1eb)](0x1f4)[_0x4b278c(0x21f)]({'Perror':_0x4b278c(0x1e8),'message':_0x2b2121[_0x4b278c(0x1af)]});}})[_0x2878cd(0x186)](_0x11e52d=>{var _0x2bf1f2=_0x2878cd;console[_0x2bf1f2(0x236)](_0x11e52d),_0x544e96['status'](0x1f4)[_0x2bf1f2(0x21f)]({'Perror':_0x2bf1f2(0x230)});});}catch(_0x4a70b6){_0x544e96[_0x2878cd(0x21f)](_0x4a70b6);}}catch(_0xbb6cca){console['error'](_0xbb6cca),_0x544e96[_0x2878cd(0x1eb)](0x1f4)[_0x2878cd(0x21f)]({'Merror':_0x2878cd(0x1e8),'Message':_0xbb6cca['message']});}})[_0x17d7e4(0x186)](_0x330b6f=>{var _0x12dffd=_0x17d7e4;console[_0x12dffd(0x236)](_0x330b6f),_0x544e96[_0x12dffd(0x1eb)](0x1f4)[_0x12dffd(0x21f)]({'Merror':_0x12dffd(0x230)});});}catch(_0x1bc749){console[_0x17d7e4(0x209)](_0x1bc749);}});function BayBinSelected(_0x1a272b,_0x12f0e0){var _0x4da06b=a0_0x3355c1,_0x16be8f=[],_0x50c6f1=[],_0x1e5aa4=[],_0x1f861c=[],_0x29b00e=[],_0xea9c31=[];let _0x13d868=[];if(_0x1a272b=='DRY\x20STORAGE')switch(_0x12f0e0){case _0x4da06b(0x243):_0x16be8f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x50c6f1=[0x1,0x2],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=['Level',_0x4da06b(0x18e)],_0x29b00e=['D'],_0xea9c31=['A'];break;case _0x4da06b(0x1df):_0x16be8f=[0x6,0x5,0x4,0x3,0x2,0x1],_0x50c6f1=[0x1,0x2],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=[_0x4da06b(0x1fd),_0x4da06b(0x18e)],_0x29b00e=['D'],_0xea9c31=['B'];break;case'Shelves':_0x16be8f=[0x0],_0x50c6f1=[0x0],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=[_0x4da06b(0x18e)],_0x29b00e=['D'],_0xea9c31=['S'];break;case _0x4da06b(0x1ef):_0x16be8f=[0x0],_0x50c6f1=[0x0],_0x1f861c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1e5aa4=[_0x4da06b(0x18e)],_0x29b00e=['D'],_0xea9c31=['R'];break;}else{if(_0x1a272b=='COLD\x20STORAGE')switch(_0x12f0e0){case'Rack\x20A':_0x16be8f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x50c6f1=['B','F'],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=['Level','Floor'],_0x29b00e=['C'],_0xea9c31=['A'];break;case'Rack\x20B':_0x16be8f=[0x5,0x4,0x3,0x2,0x1],_0x50c6f1=['F','B','S'],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=['Level',_0x4da06b(0x18e)],_0x29b00e=['C'],_0xea9c31=['B'];break;case _0x4da06b(0x226):_0x16be8f=[0x1,0x2,0x3,0x4,0x5],_0x50c6f1=['B','F','S'],_0x1f861c=[0x5,0x4,0x3,0x2,0x1],_0x1e5aa4=[_0x4da06b(0x1fd),'Floor'],_0x29b00e=['C'],_0xea9c31=['C'];break;case _0x4da06b(0x23c):_0x16be8f=[0x5,0x4,0x3,0x2,0x1],_0x50c6f1=['F','B','S'],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=[_0x4da06b(0x1fd),'Floor'],_0x29b00e=['C'],_0xea9c31=['D'];break;case _0x4da06b(0x1ad):_0x16be8f=[0x4,0x3,0x2,0x1],_0x50c6f1=[0x1,0x2],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=['Level','Floor'],_0x29b00e=['C'],_0xea9c31=['E'];break;case _0x4da06b(0x1cd):_0x16be8f=[0x1,0x2,0x3],_0x50c6f1=[0x1,0x2],_0x1f861c=[0x1,0x2,0x3,0x4,0x5],_0x1e5aa4=[_0x4da06b(0x1fd)],_0x29b00e=['C'],_0xea9c31=['F'];break;}}return{'levels':_0x16be8f,'Isle':_0x50c6f1,'rack':_0x1f861c,'type':_0x1e5aa4,'storage':_0x29b00e,'rak':_0xea9c31};}router['get'](a0_0x3355c1(0x1ec),auth,async(_0x382dd2,_0x48ff52)=>{var _0x10cce6=a0_0x3355c1;try{const {username:_0xf5c277,email:_0x407772,role:_0x52be14}=_0x382dd2[_0x10cce6(0x224)],_0x1755b2=_0x382dd2[_0x10cce6(0x224)],_0x52fb89=await profile['findOne']({'email':_0x1755b2['email']}),_0x417658=await master_shop['find'](),_0x149b1b=await transfers['findById'](_0x382dd2[_0x10cce6(0x1d2)]['id']);let _0x31775a;if(_0x1755b2['role']==_0x10cce6(0x177)){const _0x4f6c08=await staff['findOne']({'email':_0x1755b2[_0x10cce6(0x1b8)]});_0x31775a=await warehouse[_0x10cce6(0x197)]([{'$match':{'status':_0x10cce6(0x1fe),'name':_0x4f6c08['warehouse'],'warehouse_category':_0x10cce6(0x1c3)}},{'$group':{'_id':_0x10cce6(0x246),'name':{'$first':_0x10cce6(0x246)}}}]);}else _0x31775a=await warehouse['aggregate']([{'$match':{'status':_0x10cce6(0x1fe),'warehouse_category':_0x10cce6(0x1c3)}},{'$group':{'_id':'$name','name':{'$first':_0x10cce6(0x246)}}}]);const _0x2afaa5=await warehouse['aggregate']([{'$match':{'name':_0x149b1b[_0x10cce6(0x24e)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x10cce6(0x228)},{'$group':{'_id':_0x10cce6(0x18f),'name':{'$first':_0x10cce6(0x218)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x10cce6(0x17e)},'floorlevel':{'$first':_0x10cce6(0x24d)},'primary_code':{'$first':_0x10cce6(0x1aa)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x10cce6(0x1b0)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x10cce6(0x253)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x10cce6(0x1ea)}}}]),_0x5e8135=await product[_0x10cce6(0x19b)]({}),_0x1a720e=BayBinSelected(_0x149b1b['to_warehouse'],_0x149b1b[_0x10cce6(0x1f5)]);if(_0x417658[0x0][_0x10cce6(0x1fc)]==_0x10cce6(0x215)){var _0x28a582=users[_0x10cce6(0x1c4)];console[_0x10cce6(0x209)](_0x28a582);}else{if(_0x417658[0x0][_0x10cce6(0x1fc)]=='Hindi')var _0x28a582=users[_0x10cce6(0x1a2)];else{if(_0x417658[0x0][_0x10cce6(0x1fc)]==_0x10cce6(0x1e4))var _0x28a582=users[_0x10cce6(0x1e4)];else{if(_0x417658[0x0][_0x10cce6(0x1fc)]==_0x10cce6(0x1a8))var _0x28a582=users[_0x10cce6(0x1a8)];else{if(_0x417658[0x0][_0x10cce6(0x1fc)]==_0x10cce6(0x1f4))var _0x28a582=users[_0x10cce6(0x1f4)];else{if(_0x417658[0x0][_0x10cce6(0x1fc)]=='Portuguese\x20(BR)')var _0x28a582=users[_0x10cce6(0x211)];else{if(_0x417658[0x0][_0x10cce6(0x1fc)]==_0x10cce6(0x171))var _0x28a582=users['Chinese'];else{if(_0x417658[0x0]['language']==_0x10cce6(0x22a))var _0x28a582=users['Arabic'];}}}}}}}_0x48ff52[_0x10cce6(0x208)](_0x10cce6(0x1a4),{'success':_0x382dd2[_0x10cce6(0x1a1)](_0x10cce6(0x1b5)),'errors':_0x382dd2[_0x10cce6(0x1a1)](_0x10cce6(0x25a)),'role':_0x1755b2,'profile':_0x52fb89,'master_shop':_0x417658,'warehouse':_0x31775a,'transfer':_0x149b1b,'stock':_0x2afaa5,'unit':_0x5e8135,'language':_0x28a582});}catch(_0x5aa03a){console['log'](_0x5aa03a);}}),router[a0_0x3355c1(0x16f)](a0_0x3355c1(0x1ec),auth,async(_0x36d79f,_0x5c927e)=>{var _0x93a08c=a0_0x3355c1;try{const _0x4691b1=_0x36d79f[_0x93a08c(0x1d2)]['id'],_0x4643d4=await transfers['findById'](_0x4691b1);_0x5c927e[_0x93a08c(0x21f)](_0x36d79f['body']);return;const {date:_0x2cd05e,from_warehouse:_0x14895f,FromRoom_name:_0x4a40b6,to_warehouse:_0x499cd5,ToRoom_name:_0x3329e7,prod_name:_0x585447,from_prod_qty:_0x1a293c,from_prod_level:_0x3d699d,from_prod_isle:_0x54a198,from_prod_pallet:_0x5ee173,to_prod_qty:_0x3bf81c,to_prod_level:_0x48d1cf,to_prod_isle:_0x12d13e,to_prod_pallet:_0x2655e7,primary_code:_0x42ca37,secondary_code:_0xb84f30,product_code3:_0x192a6c,note:_0x28f2e2,invoice:_0x75ce71,expiry_date:_0x326696}=_0x36d79f['body'];if(typeof _0x585447=='string')var _0x1568ba=[_0x36d79f['body']['prod_name']],_0x5d8a34=[_0x36d79f[_0x93a08c(0x1d4)]['from_prod_qty']],_0x5cbb9e=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x24f)]],_0x5a5a57=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1e6)]],_0x50b6bb=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1a9)]],_0x94bfdf=[_0x36d79f['body']['from_types']],_0x46a517=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1a7)]],_0x3bfdba=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1ab)]],_0x389dba=[_0x36d79f['body'][_0x93a08c(0x202)]],_0x5e6cea=[_0x36d79f['body'][_0x93a08c(0x1e5)]],_0x9f78a4=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1d5)]],_0x44f80a=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1d7)]],_0x1b77d5=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x255)]],_0x58c295=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1a6)]],_0x4cafb5=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1b4)]],_0x43be68=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1c6)]],_0x577ba3=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x21e)]],_0x57d346=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x258)]],_0x151f0f=[_0x36d79f[_0x93a08c(0x1d4)]['secondary_unit']],_0xc31df0=[_0x36d79f['body']['batch_code']],_0x37d7b6=[_0x36d79f[_0x93a08c(0x1d4)]['expiry_date']],_0x56bd58=[_0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1b9)]],_0x585353=[_0x36d79f[_0x93a08c(0x1d4)]['from_rak']];else var _0x1568ba=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x232)]],_0x44f80a=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1d7)]],_0x1b77d5=[..._0x36d79f[_0x93a08c(0x1d4)]['rak']],_0x94bfdf=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1c0)]],_0x9f78a4=[..._0x36d79f[_0x93a08c(0x1d4)]['to_types']],_0x5d8a34=[..._0x36d79f['body']['from_prod_qty']],_0x5cbb9e=[..._0x36d79f['body'][_0x93a08c(0x24f)]],_0x5a5a57=[..._0x36d79f[_0x93a08c(0x1d4)]['from_prod_isle']],_0x50b6bb=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1a9)]],_0x46a517=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1a7)]],_0x3bfdba=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1ab)]],_0x389dba=[..._0x36d79f[_0x93a08c(0x1d4)]['to_prod_isle']],_0x5e6cea=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1e5)]],_0x58c295=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1a6)]],_0x4cafb5=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1b4)]],_0x43be68=[..._0x36d79f['body'][_0x93a08c(0x1c6)]],_0x577ba3=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x21e)]],_0x57d346=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x258)]],_0x151f0f=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x18c)]],_0xc31df0=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x231)]],_0x37d7b6=[..._0x36d79f[_0x93a08c(0x1d4)]['expiry_date']],_0x56bd58=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x1b9)]],_0x585353=[..._0x36d79f[_0x93a08c(0x1d4)][_0x93a08c(0x188)]];const _0x131b74=_0x1568ba['map'](_0x2e3185=>{return _0x2e3185={'product_name':_0x2e3185};});_0x5d8a34[_0x93a08c(0x1b2)]((_0x384734,_0x5cb04a)=>{var _0x5d2e8a=_0x93a08c;_0x131b74[_0x5cb04a][_0x5d2e8a(0x19c)]=_0x384734;}),_0x5cbb9e[_0x93a08c(0x1b2)]((_0x334893,_0x2340ed)=>{_0x131b74[_0x2340ed]['from_bay']=_0x334893;}),_0x5a5a57['forEach']((_0x45f722,_0x2396d6)=>{var _0x3b0f63=_0x93a08c;_0x131b74[_0x2396d6][_0x3b0f63(0x1e9)]=_0x45f722;}),_0x50b6bb[_0x93a08c(0x1b2)]((_0x4e060e,_0x45246b)=>{var _0x5d1bb9=_0x93a08c;_0x131b74[_0x45246b][_0x5d1bb9(0x1bf)]=_0x4e060e;}),_0x46a517[_0x93a08c(0x1b2)]((_0x587b5b,_0x23faa5)=>{var _0xa04285=_0x93a08c;_0x131b74[_0x23faa5][_0xa04285(0x227)]=_0x587b5b;}),_0x3bfdba[_0x93a08c(0x1b2)]((_0x3132c8,_0x22491b)=>{var _0x2fb5db=_0x93a08c;_0x131b74[_0x22491b][_0x2fb5db(0x241)]=_0x3132c8;}),_0x389dba[_0x93a08c(0x1b2)]((_0x7fef21,_0x1edc07)=>{var _0x49596e=_0x93a08c;_0x131b74[_0x1edc07][_0x49596e(0x23f)]=_0x7fef21;}),_0x5e6cea[_0x93a08c(0x1b2)]((_0x422cd0,_0x4e6c02)=>{var _0x3d156a=_0x93a08c;_0x131b74[_0x4e6c02][_0x3d156a(0x18d)]=_0x422cd0;}),_0x58c295[_0x93a08c(0x1b2)]((_0x5d42fd,_0x39560a)=>{_0x131b74[_0x39560a]['primary_code']=_0x5d42fd;}),_0x4cafb5[_0x93a08c(0x1b2)]((_0x7586d5,_0x63cf56)=>{var _0x202bbe=_0x93a08c;_0x131b74[_0x63cf56][_0x202bbe(0x1b4)]=_0x7586d5;}),_0x43be68[_0x93a08c(0x1b2)]((_0x4827bc,_0x222dcf)=>{var _0x490e25=_0x93a08c;_0x131b74[_0x222dcf][_0x490e25(0x193)]=_0x4827bc;}),_0x577ba3[_0x93a08c(0x1b2)]((_0x128d61,_0x30cf98)=>{_0x131b74[_0x30cf98]['maxProducts']=_0x128d61;}),_0x57d346[_0x93a08c(0x1b2)]((_0x38a614,_0x3a9fd1)=>{_0x131b74[_0x3a9fd1]['unit']=_0x38a614;}),_0x151f0f['forEach']((_0x1546b7,_0x184b19)=>{var _0x3fc07b=_0x93a08c;_0x131b74[_0x184b19][_0x3fc07b(0x18c)]=_0x1546b7;}),_0xc31df0['forEach']((_0x554f2b,_0x39871b)=>{var _0x54bda5=_0x93a08c;_0x131b74[_0x39871b][_0x54bda5(0x231)]=_0x554f2b;}),_0x37d7b6[_0x93a08c(0x1b2)]((_0x247f23,_0x326e27)=>{var _0x582ea4=_0x93a08c;_0x131b74[_0x326e27][_0x582ea4(0x21b)]=_0x247f23;}),_0x44f80a[_0x93a08c(0x1b2)]((_0x2ccc8c,_0x2dad7e)=>{var _0x28b6ca=_0x93a08c;_0x131b74[_0x2dad7e][_0x28b6ca(0x1d7)]=_0x2ccc8c;}),_0x1b77d5[_0x93a08c(0x1b2)]((_0x343994,_0x30fa20)=>{_0x131b74[_0x30fa20]['rack']=_0x343994;}),_0x94bfdf['forEach']((_0x3dbd48,_0x332cb6)=>{var _0x3c1c2f=_0x93a08c;_0x131b74[_0x332cb6][_0x3c1c2f(0x1c0)]=_0x3dbd48;}),_0x9f78a4[_0x93a08c(0x1b2)]((_0x3e5039,_0x54cf5b)=>{var _0xd26beb=_0x93a08c;_0x131b74[_0x54cf5b][_0xd26beb(0x1d5)]=_0x3e5039;}),_0x56bd58[_0x93a08c(0x1b2)]((_0x17c0b8,_0x5c21a6)=>{var _0x2840bc=_0x93a08c;_0x131b74[_0x5c21a6][_0x2840bc(0x1b9)]=_0x17c0b8;}),_0x585353[_0x93a08c(0x1b2)]((_0x34a8ec,_0x3caac9)=>{var _0x17b31e=_0x93a08c;_0x131b74[_0x3caac9][_0x17b31e(0x24a)]=_0x34a8ec;});const _0x4f2de4=_0x131b74[_0x93a08c(0x21a)](_0xcd26f6=>_0xcd26f6[_0x93a08c(0x227)]!=='0'&&_0xcd26f6[_0x93a08c(0x227)]!==''||_0xcd26f6[_0x93a08c(0x18d)]!=='0'&&_0xcd26f6['to_floorlevel']!=='');var _0x285db7=0x0;_0x4f2de4[_0x93a08c(0x1b2)](_0x3a6e81=>{var _0x47509d=_0x93a08c;parseInt(_0x3a6e81[_0x47509d(0x19c)])<parseInt(_0x3a6e81[_0x47509d(0x227)])&&_0x285db7++;});if(_0x285db7!=0x0)return _0x36d79f[_0x93a08c(0x1a1)]('errors',_0x93a08c(0x206)),_0x5c927e['redirect']('back');const _0x4f7742=await warehouse['findOne']({'name':_0x4643d4[_0x93a08c(0x24e)],'room':_0x4643d4[_0x93a08c(0x21d)]});_0x4643d4[_0x93a08c(0x187)][_0x93a08c(0x1b2)](_0x23ca25=>{var _0x28649f=_0x93a08c;if(_0x23ca25[_0x28649f(0x227)]>0x0){const _0x2ee7dc=_0x4f7742[_0x28649f(0x1b1)][_0x28649f(0x1c1)](_0x3da5ce=>{var _0x551ecf=_0x28649f;_0x3da5ce[_0x551ecf(0x1cb)]==_0x23ca25[_0x551ecf(0x1cb)]&&_0x3da5ce[_0x551ecf(0x251)]==_0x23ca25['from_floorlevel']&&_0x3da5ce['type']==_0x23ca25[_0x551ecf(0x1c0)]&&_0x3da5ce[_0x551ecf(0x22c)]==_0x23ca25[_0x551ecf(0x1e9)]&&_0x3da5ce[_0x551ecf(0x213)]==_0x23ca25[_0x551ecf(0x220)]&&_0x3da5ce[_0x551ecf(0x22b)]==_0x23ca25[_0x551ecf(0x24a)]&&_0x3da5ce['storage']==_0x23ca25[_0x551ecf(0x1b9)]&&(_0x3da5ce[_0x551ecf(0x1b3)]=parseInt(_0x3da5ce[_0x551ecf(0x1b3)])+parseInt(_0x23ca25[_0x551ecf(0x227)]));});}}),await _0x4f7742['save']();const _0x22e466=await warehouse[_0x93a08c(0x1f3)]({'name':_0x4643d4[_0x93a08c(0x170)],'room':_0x4643d4[_0x93a08c(0x1f5)]});_0x4643d4[_0x93a08c(0x187)][_0x93a08c(0x1b2)](_0xcf54ef=>{var _0x40ea71=_0x93a08c;if(_0xcf54ef[_0x40ea71(0x227)]>0x0){const _0x1cbd90=_0x22e466[_0x40ea71(0x1b1)][_0x40ea71(0x1c1)](_0xa8c0cf=>{var _0xcd7bd0=_0x40ea71;_0xa8c0cf['product_name']==_0xcf54ef[_0xcd7bd0(0x1cb)]&&_0xa8c0cf[_0xcd7bd0(0x251)]==_0xcf54ef[_0xcd7bd0(0x18d)]&&_0xa8c0cf['type']==_0xcf54ef[_0xcd7bd0(0x1d5)]&&_0xa8c0cf[_0xcd7bd0(0x22c)]==_0xcf54ef[_0xcd7bd0(0x23f)]&&_0xa8c0cf[_0xcd7bd0(0x213)]==_0xcf54ef['to_bay']&&_0xa8c0cf[_0xcd7bd0(0x22b)]==_0xcf54ef[_0xcd7bd0(0x22b)]&&_0xa8c0cf[_0xcd7bd0(0x1d7)]==_0xcf54ef['storage']&&(_0xa8c0cf[_0xcd7bd0(0x1b3)]=parseInt(_0xa8c0cf[_0xcd7bd0(0x1b3)])-parseInt(_0xcf54ef['to_quantity']));});}}),await _0x22e466['save'](),_0x4643d4[_0x93a08c(0x185)]=_0x2cd05e,_0x4643d4[_0x93a08c(0x24e)]=_0x14895f,_0x4643d4[_0x93a08c(0x170)]=_0x499cd5,_0x4643d4[_0x93a08c(0x187)]=_0x4f2de4,_0x4643d4['note']=_0x28f2e2,_0x4643d4[_0x93a08c(0x1da)]=_0x75ce71;const _0x11164e=await _0x4643d4[_0x93a08c(0x24b)]();console[_0x93a08c(0x209)](_0x11164e);const _0x3f538e=await warehouse[_0x93a08c(0x1f3)]({'name':_0x14895f,'room':_0x4a40b6});_0x11164e[_0x93a08c(0x187)]['forEach'](_0x21f87a=>{var _0x10d6cc=_0x93a08c;if(_0x21f87a['to_quantity']>0x0){const _0x2d4a4e=_0x3f538e[_0x10d6cc(0x1b1)][_0x10d6cc(0x1c1)](_0x36d43c=>{var _0x595f5c=_0x10d6cc;_0x36d43c[_0x595f5c(0x1cb)]==_0x21f87a[_0x595f5c(0x1cb)]&&_0x36d43c[_0x595f5c(0x251)]==_0x21f87a[_0x595f5c(0x1bf)]&&_0x36d43c[_0x595f5c(0x217)]==_0x21f87a[_0x595f5c(0x1c0)]&&_0x36d43c['bin']==_0x21f87a[_0x595f5c(0x1e9)]&&_0x36d43c[_0x595f5c(0x213)]==_0x21f87a[_0x595f5c(0x220)]&&_0x36d43c[_0x595f5c(0x22b)]==_0x21f87a['from_rack']&&_0x36d43c[_0x595f5c(0x1d7)]==_0x21f87a[_0x595f5c(0x1b9)]&&(_0x36d43c[_0x595f5c(0x1b3)]=parseInt(_0x36d43c['product_stock'])-parseInt(_0x21f87a['to_quantity']));});}}),await _0x3f538e[_0x93a08c(0x24b)]();const _0x6087d1=await warehouse['findOne']({'name':_0x499cd5,'room':_0x3329e7});_0x11164e[_0x93a08c(0x187)][_0x93a08c(0x1b2)](_0x22cfdd=>{var _0x39aaba=_0x93a08c;if(_0x22cfdd[_0x39aaba(0x227)]>0x0){var _0x48ef96=0x0;const _0x367415=_0x6087d1[_0x39aaba(0x1b1)][_0x39aaba(0x1c1)](_0x36b5e4=>{var _0x5b7ff4=_0x39aaba;_0x36b5e4[_0x5b7ff4(0x1cb)]==_0x22cfdd['product_name']&&_0x36b5e4[_0x5b7ff4(0x251)]==_0x22cfdd[_0x5b7ff4(0x18d)]&&_0x36b5e4['type']==_0x22cfdd[_0x5b7ff4(0x1d5)]&&_0x36b5e4[_0x5b7ff4(0x22c)]==_0x22cfdd['to_bin']&&_0x36b5e4[_0x5b7ff4(0x213)]==_0x22cfdd['to_bay']&&_0x36b5e4['rack']==_0x22cfdd[_0x5b7ff4(0x22b)]&&_0x36b5e4[_0x5b7ff4(0x1d7)]==_0x22cfdd[_0x5b7ff4(0x1d7)]&&(_0x36b5e4[_0x5b7ff4(0x1b3)]=parseInt(_0x36b5e4[_0x5b7ff4(0x1b3)])+parseInt(_0x22cfdd[_0x5b7ff4(0x227)]),_0x48ef96++);});_0x48ef96=='0'&&(_0x6087d1['product_details']=_0x6087d1[_0x39aaba(0x1b1)][_0x39aaba(0x249)]({'product_name':_0x22cfdd[_0x39aaba(0x1cb)],'product_stock':_0x22cfdd[_0x39aaba(0x227)],'bay':_0x22cfdd[_0x39aaba(0x241)],'bin':_0x22cfdd['to_bin'],'type':_0x22cfdd[_0x39aaba(0x1d5)],'floorlevel':_0x22cfdd[_0x39aaba(0x18d)],'storage':_0x22cfdd['storage'],'rack':_0x22cfdd['rack'],'product_code':_0x22cfdd[_0x39aaba(0x193)],'primary_code':_0x22cfdd[_0x39aaba(0x1a6)],'secondary_code':_0x22cfdd[_0x39aaba(0x1b4)],'maxProducts':_0x22cfdd['maxProducts'],'storage':_0x22cfdd['storage'],'rack':_0x22cfdd[_0x39aaba(0x22b)]}));}}),await _0x6087d1[_0x93a08c(0x24b)](),_0x36d79f[_0x93a08c(0x1a1)](_0x93a08c(0x1b5),_0x93a08c(0x212)),_0x5c927e[_0x93a08c(0x25b)](_0x93a08c(0x17c));}catch(_0x4a5e80){console[_0x93a08c(0x209)](_0x4a5e80);}}),router[a0_0x3355c1(0x16f)]('/barcode_scanner',async(_0x1e1719,_0x2e5121)=>{var _0x4c99fa=a0_0x3355c1;const {FromWareHouse:_0x54de93,FromRoom:_0x1b5c72,ToWarehouse:_0x2cb7bd,ToRoom:_0x13d959,primary_code:_0x4648a5,Roomslist:_0x2f2a52}=_0x1e1719[_0x4c99fa(0x1d4)],_0x5583fa=_0x2f2a52[_0x4c99fa(0x1b7)](','),_0x2714ff=[];async function _0x3c8f66(_0x34c9b3){var _0xf5f6b8=_0x4c99fa;const _0x49ac5d=await warehouse['aggregate']([{'$match':{'name':_0x54de93,'room':_0x34c9b3}},{'$unwind':_0xf5f6b8(0x228)},{'$match':{'product_details.primary_code':_0x4648a5}},{'$group':{'_id':_0xf5f6b8(0x18f),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xf5f6b8(0x1aa)},'secondary_code':{'$first':_0xf5f6b8(0x1f2)},'product_code':{'$first':_0xf5f6b8(0x1d3)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0xf5f6b8(0x1cf)},'type':{'$first':_0xf5f6b8(0x17e)},'pallet':{'$first':_0xf5f6b8(0x24d)},'unit':{'$first':_0xf5f6b8(0x223)},'secondary_unit':{'$first':_0xf5f6b8(0x1cc)},'storage':{'$first':_0xf5f6b8(0x1b0)},'rack':{'$first':_0xf5f6b8(0x1fb)},'expiry_date':{'$first':_0xf5f6b8(0x253)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xf5f6b8(0x219)},'maxPerUnit':{'$first':_0xf5f6b8(0x233)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0xf5f6b8(0x189)}}}]),_0x2e0971=await warehouse[_0xf5f6b8(0x197)]([{'$match':{'name':_0x54de93,'room':_0x34c9b3}},{'$unwind':_0xf5f6b8(0x228)},{'$match':{'product_details.secondary_code':_0x4648a5}},{'$group':{'_id':_0xf5f6b8(0x18f),'name':{'$first':_0xf5f6b8(0x218)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xf5f6b8(0x1aa)},'secondary_code':{'$first':_0xf5f6b8(0x1f2)},'product_code':{'$first':_0xf5f6b8(0x1d3)},'level':{'$first':_0xf5f6b8(0x1ac)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xf5f6b8(0x17e)},'pallet':{'$first':_0xf5f6b8(0x24d)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xf5f6b8(0x1cc)},'storage':{'$first':_0xf5f6b8(0x1b0)},'rack':{'$first':_0xf5f6b8(0x1fb)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0xf5f6b8(0x233)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0xf5f6b8(0x1ea)},'maxProducts':{'$first':_0xf5f6b8(0x189)}}}]);if(_0x49ac5d[_0xf5f6b8(0x216)]>0x0)_0x2714ff[_0xf5f6b8(0x200)](_0x49ac5d);else _0x2e0971[_0xf5f6b8(0x216)]>0x0&&_0x2714ff[_0xf5f6b8(0x200)](_0x2e0971);}const _0x4823fc=_0x5583fa['map'](_0xb8b249=>_0x3c8f66(_0xb8b249));await Promise[_0x4c99fa(0x23d)](_0x4823fc),_0x2e5121[_0x4c99fa(0x21f)](_0x2714ff);}),router[a0_0x3355c1(0x16f)](a0_0x3355c1(0x22d),async(_0x4938c7,_0x881704)=>{var _0x513989=a0_0x3355c1;try{const {FromWareHouse:_0x26b523,FromRoom:_0x32d62e,ToWarehouse:_0x52be73,ToRoom:_0x55cd96,secondary_code:_0x3aaa14}=_0x4938c7['body'],_0x6e72a0=await warehouse[_0x513989(0x197)]([{'$match':{'name':_0x26b523}},{'$unwind':_0x513989(0x228)},{'$match':{'product_details.secondary_code':_0x3aaa14}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x513989(0x218)},'primary_code':{'$first':_0x513989(0x1aa)},'secondary_code':{'$first':_0x513989(0x1f2)},'product_code':{'$first':_0x513989(0x1d3)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x513989(0x246)},'level':{'$first':_0x513989(0x1b6)},'isle':{'$first':_0x513989(0x173)},'pallet':{'$first':_0x513989(0x17b)},'maxProducts':{'$first':_0x513989(0x189)},'unit':{'$first':_0x513989(0x223)}}}]);_0x881704[_0x513989(0x1eb)](0xc8)[_0x513989(0x21f)](_0x6e72a0);}catch(_0x4d4ff5){_0x881704[_0x513989(0x1eb)](0x194)[_0x513989(0x21f)]({'message':_0x4d4ff5[_0x513989(0x1af)]});}}),router[a0_0x3355c1(0x16f)](a0_0x3355c1(0x17a),async(_0x48988d,_0x7c0c18)=>{var _0x58ba94=a0_0x3355c1;try{const {FromWareHouse:_0x4f86fd,FromRoom:_0x1b6e7f,ToWarehouse:_0x44f69a,ToRoom:_0x4fed28,product_code:_0x21b781}=_0x48988d[_0x58ba94(0x1d4)],_0x4efad7=await warehouse[_0x58ba94(0x197)]([{'$match':{'name':_0x4f86fd}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x21b781}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x58ba94(0x218)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x58ba94(0x1f2)},'product_code':{'$first':_0x58ba94(0x1d3)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x58ba94(0x246)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x58ba94(0x173)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x58ba94(0x189)},'unit':{'$first':_0x58ba94(0x223)}}}]);_0x7c0c18[_0x58ba94(0x1eb)](0xc8)[_0x58ba94(0x21f)](_0x4efad7);}catch(_0x35ebc8){_0x7c0c18[_0x58ba94(0x1eb)](0x194)['json']({'message':_0x35ebc8['message']});}}),router['post'](a0_0x3355c1(0x1d1),async(_0x1a080e,_0x57a13e)=>{var _0x3ed07a=a0_0x3355c1;const {level:_0x334663,isle:_0x4ff5ab,pallet:_0x16a72c,warehouses:_0x2a0611,room:_0x42973c}=_0x1a080e[_0x3ed07a(0x1d4)];try{const _0x4702b3=await warehouse['aggregate']([{'$match':{'name':_0x2a0611,'room':_0x42973c}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x334663),'product_details.isle':_0x4ff5ab,'product_details.pallet':parseInt(_0x16a72c)}},{'$group':{'_id':_0x3ed07a(0x18f),'name':{'$first':_0x3ed07a(0x218)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x3ed07a(0x1b6)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x3ed07a(0x189)}}}]);_0x57a13e[_0x3ed07a(0x1eb)](0xc8)[_0x3ed07a(0x21f)](_0x4702b3);}catch(_0xd44658){_0x57a13e['status'](0x194)['json']({'message':_0xd44658['message']});}}),module[a0_0x3355c1(0x17d)]=router;