var a0_0x30d976=a0_0x4781;function a0_0x4781(_0x1e0c9b,_0x110deb){var _0x10ee85=a0_0x10ee();return a0_0x4781=function(_0x47819d,_0x1377da){_0x47819d=_0x47819d-0x1e9;var _0x358286=_0x10ee85[_0x47819d];return _0x358286;},a0_0x4781(_0x1e0c9b,_0x110deb);}(function(_0x2a9e6c,_0x135308){var _0x2ba281=a0_0x4781,_0x1d3c2a=_0x2a9e6c();while(!![]){try{var _0xea7386=parseInt(_0x2ba281(0x251))/0x1*(parseInt(_0x2ba281(0x262))/0x2)+-parseInt(_0x2ba281(0x295))/0x3*(-parseInt(_0x2ba281(0x21b))/0x4)+-parseInt(_0x2ba281(0x2d7))/0x5+-parseInt(_0x2ba281(0x22a))/0x6+-parseInt(_0x2ba281(0x2a3))/0x7+parseInt(_0x2ba281(0x279))/0x8+parseInt(_0x2ba281(0x27a))/0x9;if(_0xea7386===_0x135308)break;else _0x1d3c2a['push'](_0x1d3c2a['shift']());}catch(_0x9dc93e){_0x1d3c2a['push'](_0x1d3c2a['shift']());}}}(a0_0x10ee,0x9c38f),require(a0_0x30d976(0x240))['config']());const express=require(a0_0x30d976(0x27b)),app=express(),router=express[a0_0x30d976(0x24d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x30d976(0x23c)),auth=require(a0_0x30d976(0x2c8)),users=require(a0_0x30d976(0x236)),nodemailer=require(a0_0x30d976(0x22f)),mongoose=require(a0_0x30d976(0x29b));router[a0_0x30d976(0x239)](a0_0x30d976(0x2c6),auth,async(_0x5e31d9,_0x2d6370)=>{var _0x18e099=a0_0x30d976;try{const {username:_0x297b7c,email:_0x22c840,role:_0x53e646}=_0x5e31d9[_0x18e099(0x2df)],_0x3a6107=_0x5e31d9[_0x18e099(0x2df)],_0x13e195=await profile[_0x18e099(0x211)]({'email':_0x3a6107[_0x18e099(0x238)]}),_0x2d2fee=await master_shop[_0x18e099(0x206)]();console[_0x18e099(0x299)](_0x18e099(0x275),_0x2d2fee);let _0xe3173a;if(_0x3a6107[_0x18e099(0x266)]=='staff'){const _0x1adec6=await staff['findOne']({'email':_0x3a6107[_0x18e099(0x238)]});_0xe3173a=await transfers[_0x18e099(0x206)]({'from_warehouse':_0x1adec6[_0x18e099(0x24e)]});}else _0xe3173a=await transfers[_0x18e099(0x277)]([{'$unwind':'$product'},{'$group':{'_id':_0x18e099(0x264),'invoice':{'$first':'$invoice'},'date':{'$first':_0x18e099(0x213)},'from_warehouse':{'$first':_0x18e099(0x25a)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2d2fee[0x0][_0x18e099(0x1f1)]==_0x18e099(0x2d9)){var _0x3d7f8c=users[_0x18e099(0x2aa)];console[_0x18e099(0x299)](_0x3d7f8c);}else{if(_0x2d2fee[0x0][_0x18e099(0x1f1)]==_0x18e099(0x20e))var _0x3d7f8c=users['Hindi'];else{if(_0x2d2fee[0x0][_0x18e099(0x1f1)]==_0x18e099(0x227))var _0x3d7f8c=users[_0x18e099(0x227)];else{if(_0x2d2fee[0x0]['language']==_0x18e099(0x254))var _0x3d7f8c=users[_0x18e099(0x254)];else{if(_0x2d2fee[0x0][_0x18e099(0x1f1)]==_0x18e099(0x1ec))var _0x3d7f8c=users[_0x18e099(0x1ec)];else{if(_0x2d2fee[0x0]['language']=='Portuguese\x20(BR)')var _0x3d7f8c=users[_0x18e099(0x256)];else{if(_0x2d2fee[0x0][_0x18e099(0x1f1)]==_0x18e099(0x263))var _0x3d7f8c=users['Chinese'];else{if(_0x2d2fee[0x0][_0x18e099(0x1f1)]==_0x18e099(0x22d))var _0x3d7f8c=users[_0x18e099(0x2a7)];}}}}}}}_0x2d6370['render']('transfer',{'success':_0x5e31d9[_0x18e099(0x207)](_0x18e099(0x212)),'errors':_0x5e31d9[_0x18e099(0x207)](_0x18e099(0x2b1)),'role':_0x3a6107,'profile':_0x13e195,'master_shop':_0x2d2fee,'transfer':_0xe3173a,'language':_0x3d7f8c});}catch(_0x1d2ac6){console[_0x18e099(0x299)](_0x1d2ac6);}});function a0_0x10ee(){var _0xac60ad=['$product_details.invoice','9618864WZZQsA','6658605vCQVyb','express','Floor','/../public','prod_cat','padStart','Raw\x20Materials','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','batch_code','from_prod_level','maxperunit','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details','edit_transfer','RoomAssigned','/barcode_scanner','Receiving\x20Area','Portuguese\x20(BR)','all','Ambient','toFixed','storage','status','delivery_date','Rack\x20F','ObjectId','to_prod_isle','130434QUAVkL','meet\x20the\x20need\x20stock','floor','body','log','getDate','mongoose','to_room_name','here','expiry_date','startSession','getMonth','Error\x20Occurs','Enabled','6570592QPQHLf','</div>','product_stock','Rack\x20A','Arabic','to_invoice','Transfer\x20Edit\x20Successfully','English','password','To_invoice','$product_details.production_date','</body></html>','from_warehouse','</span>','errors','secondary_code','date','forEach','id_transaction_id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/barcode_scanner3','_id','findById','Rack\x20B','MaxStocks_data2','</table>','</thead>','<!DOCTYPE\x20html>','from_bin','$product_details.bay','product_name','\x20Order\x20Date\x20:\x20','to_prod_pallet','to_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/view','<div>','../middleware/auth','params','catch','$product_details.product_stock','/view/:id','<h2>\x20','note','$product_details.storage','</h5>','<html><head><title></title>','getFullYear','concat','then','max_per_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','2481690gOZyWr','to_floorlevel','English\x20(US)','/view/add_transfer','Level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<span\x20style=\x22float:\x20right;\x22>','staff','user','from_prod_qty','from_rak','<tbody\x20style=\x22text-align:\x20center;\x22>','\x20<>\x20','back','$product_details.product_code','product_code3','..............from\x20deducted.....................','to_room','updateOne','to_prod_qty','COLD\x20STORAGE','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.bin','French','bay','$product_details.maxPerUnit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','to_prod_level','language','from_rack','secondary_unit','$product_details.rack','alertQTY','from_bay','abortTransaction','New_Qty_Converted','filter','$product_details.type','/transfer/view','edit_transfer_view','from_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','from_storage','string','message','$product_details.primary_code','Shelves','..............to\x20deducted.....................','$product_details.pallet','find','flash','/barcode_scanner2','from_prod_isle','from_floorlevel','not\x20meet\x20the\x20need\x20stock','Rack\x20D','$product_details.isle','Hindi','product','prod_name','findOne','success','$date','render','/CheckingWarehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','production_date','<tr>','to_bin','Transfer\x20Finalize\x20Successfully','8BXyAwL','$product_details.expiry_date','bin','to_types','</td>','endSession','TRF-','/transfer/preview/','site_title','primary_code','createTransport','product_details','German','from_types','</tr>','6479934QeNEJB','length','image','Arabic\x20(ae)','add_transfer','nodemailer','redirect','\x20and\x20QTY\x20:\x20','\x20Order\x20Number\x20:\x20','json','/preview/:id','Logo.png','../public/language/languages.json','True','email','get','rak','floorlevel','../models/all_models','from_quantity','port','from_prod_pallet','dotenv','$room','ToRoomAssigned','save','map','/upload/','<hr\x20class=\x22my-3\x22>','Return\x20Rooms','No\x20warehouse\x20data\x20found\x20for\x20room:\x20','maxProducts','\x20</h2>','host','session','Router','warehouse','post','unit','1557WuclLe','$product_details.secondary_unit','$product_details.product_name','Spanish','random','Portuguese','to_warehouse','Rack\x20E','type','$from_warehouse','rack','push','id_transaction','DRY\x20STORAGE','invoice','$product_details.unit','to_quantity','1446yTceMF','Chinese','$_id','toString','role','$product_details.floorlevel','$product_details.level','Enclosed','$product_details.maxProducts','slice','finalize','$product_details.secondary_code','..............connected.....................','$product_details._id','Transaction\x20aborted.','from_invoice','$product_details.batch_code','product_code','$name','master','/picking_list/PDF_transfer_rm/','aggregate'];a0_0x10ee=function(){return _0xac60ad;};return a0_0x10ee();}async function getRandom8DigitNumber(){var _0x31776e=a0_0x30d976;const _0x178632=0x989680,_0x4f2dfc=0x5f5e0ff,_0x79bbb5=Math[_0x31776e(0x297)](Math[_0x31776e(0x255)]()*(_0x4f2dfc-_0x178632+0x1))+_0x178632;var _0x5c2ef1;const _0x43dd8c=await transfers[_0x31776e(0x211)]({'invoice':_0x31776e(0x221)+_0x79bbb5});return _0x43dd8c&&_0x43dd8c[_0x31776e(0x22b)]>0x0?_0x5c2ef1=_0x31776e(0x221)+_0x79bbb5:_0x5c2ef1=_0x31776e(0x221)+_0x79bbb5,_0x5c2ef1;}router['get']('/view/add_transfer',auth,async(_0x2eda42,_0x1a92d6)=>{var _0x258186=a0_0x30d976;try{const {username:_0x24a446,email:_0xb6e375,role:_0x2dbb14}=_0x2eda42[_0x258186(0x2df)],_0x493c46=_0x2eda42[_0x258186(0x2df)],_0x45c5ab=await profile[_0x258186(0x211)]({'email':_0x493c46[_0x258186(0x238)]}),_0x45b126=await master_shop[_0x258186(0x206)]();console['log'](_0x258186(0x275),_0x45b126);let _0x9e5a73;if(_0x493c46[_0x258186(0x266)]=='staff'){const _0x1ea892=await staff[_0x258186(0x211)]({'email':_0x493c46[_0x258186(0x238)]});_0x9e5a73=await warehouse[_0x258186(0x277)]([{'$match':{'status':_0x258186(0x2a2),'name':_0x1ea892[_0x258186(0x24e)],'warehouse_category':_0x258186(0x280)}},{'$group':{'_id':_0x258186(0x274),'name':{'$first':_0x258186(0x274)}}}]);}else _0x9e5a73=await warehouse[_0x258186(0x277)]([{'$match':{'status':_0x258186(0x2a2),'warehouse_category':_0x258186(0x280)}},{'$group':{'_id':_0x258186(0x274),'name':{'$first':_0x258186(0x274)}}}]);var _0x13379c=[_0x258186(0x28d),_0x258186(0x269),_0x258186(0x247)];const _0x7df8e9=await transfers[_0x258186(0x206)]({}),_0x8b66cc=_0x7df8e9[_0x258186(0x22b)]+0x1,_0x52eab9=_0x258186(0x221)+_0x8b66cc[_0x258186(0x265)]()[_0x258186(0x27f)](0x5,'0');if(_0x45b126[0x0][_0x258186(0x1f1)]==_0x258186(0x2d9)){var _0x14c1d8=users[_0x258186(0x2aa)];console['log'](_0x14c1d8);}else{if(_0x45b126[0x0][_0x258186(0x1f1)]=='Hindi')var _0x14c1d8=users[_0x258186(0x20e)];else{if(_0x45b126[0x0][_0x258186(0x1f1)]==_0x258186(0x227))var _0x14c1d8=users[_0x258186(0x227)];else{if(_0x45b126[0x0]['language']=='Spanish')var _0x14c1d8=users[_0x258186(0x254)];else{if(_0x45b126[0x0][_0x258186(0x1f1)]==_0x258186(0x1ec))var _0x14c1d8=users[_0x258186(0x1ec)];else{if(_0x45b126[0x0][_0x258186(0x1f1)]==_0x258186(0x28b))var _0x14c1d8=users[_0x258186(0x256)];else{if(_0x45b126[0x0][_0x258186(0x1f1)]==_0x258186(0x263))var _0x14c1d8=users['Chinese'];else{if(_0x45b126[0x0][_0x258186(0x1f1)]=='Arabic\x20(ae)')var _0x14c1d8=users[_0x258186(0x2a7)];}}}}}}}const _0x3b7b65=getRandom8DigitNumber();_0x3b7b65[_0x258186(0x2d4)](_0x508444=>{var _0x57b475=_0x258186;_0x1a92d6[_0x57b475(0x214)](_0x57b475(0x22e),{'success':_0x2eda42[_0x57b475(0x207)](_0x57b475(0x212)),'errors':_0x2eda42[_0x57b475(0x207)]('errors'),'role':_0x493c46,'profile':_0x45c5ab,'master_shop':_0x45b126,'warehouse':_0x9e5a73,'language':_0x14c1d8,'rooms_data':_0x13379c,'invoice':_0x508444});})[_0x258186(0x2ca)](_0x41c540=>{var _0x38455f=_0x258186;_0x2eda42[_0x38455f(0x207)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1a92d6['redirect'](_0x38455f(0x1fb));});}catch(_0x5b1f2c){console[_0x258186(0x299)](_0x5b1f2c);}}),router[a0_0x30d976(0x24f)](a0_0x30d976(0x2da),auth,async(_0x512f4a,_0x39ca91)=>{var _0x417da2=a0_0x30d976;try{console[_0x417da2(0x299)](_0x512f4a['body']);const {date:_0x3736cd,from_warehouse:_0x4fd752,FromRoom_name:_0x36dbca,to_warehouse:_0x381bf3,ToRoom_name:_0x5b4c66,prod_name:_0x2e5870,from_prod_qty:_0x5273fe,from_prod_level:_0x17df49,from_prod_isle:_0x33b160,from_prod_pallet:_0xfcd26,to_prod_qty:_0x3c8a49,to_prod_level:_0x2c8a98,to_prod_isle:_0x3ef9df,to_prod_pallet:_0x14a9f3,primary_code:_0xe5efb8,secondary_code:_0x4f5702,product_code3:_0x2d279b,note:_0x29c2eb,MaxStocks_data2:_0x14a510,invoice:_0x13204e,expiry_date:_0x4802c0}=_0x512f4a['body'];if(typeof _0x2e5870==_0x417da2(0x200))var _0x41b8a7=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x210)]],_0x145b46=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x2e0)]],_0x1e92d8=[_0x512f4a[_0x417da2(0x298)]['from_prod_level']],_0x3697d7=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x1f8)]],_0x2e623d=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x1f0)]],_0x2fe7f8=[_0x512f4a['body'][_0x417da2(0x224)]],_0x1e953e=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x2b2)]],_0x3cd1af=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x2e6)]],_0xea8e9e=[_0x512f4a[_0x417da2(0x298)]['MaxStocks_data2']],_0x1d609e=[_0x512f4a[_0x417da2(0x298)]['primary_unit']],_0x557bd4=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x1f3)]],_0x50a4b6=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x282)]],_0x1cf55a=[_0x512f4a[_0x417da2(0x298)]['expiry_date']],_0x509eb7=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x2d5)]],_0x4da07e=[_0x512f4a[_0x417da2(0x298)]['production_date']],_0x55a5f3=[_0x512f4a['body'][_0x417da2(0x27e)]],_0x9b9ce=[_0x512f4a[_0x417da2(0x298)]['RoomAssigned']],_0x51ecfb=[_0x512f4a['body'][_0x417da2(0x242)]],_0x180cc5=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x271)]],_0x48dc9b=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x2a8)]],_0x37068a=[_0x512f4a[_0x417da2(0x298)][_0x417da2(0x25d)]];else var _0x41b8a7=[..._0x512f4a['body'][_0x417da2(0x210)]],_0x145b46=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x2e0)]],_0x1e92d8=[..._0x512f4a[_0x417da2(0x298)]['from_prod_level']],_0x3697d7=[..._0x512f4a['body'][_0x417da2(0x1f8)]],_0x2e623d=[..._0x512f4a['body']['to_prod_level']],_0x2fe7f8=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x224)]],_0x1e953e=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x2b2)]],_0x3cd1af=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x2e6)]],_0xea8e9e=[..._0x512f4a['body'][_0x417da2(0x2bb)]],_0x1d609e=[..._0x512f4a[_0x417da2(0x298)]['primary_unit']],_0x557bd4=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x1f3)]],_0x50a4b6=[..._0x512f4a['body'][_0x417da2(0x282)]],_0x1cf55a=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x29e)]],_0x509eb7=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x2d5)]],_0x4da07e=[..._0x512f4a['body']['production_date']],_0x55a5f3=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x27e)]],_0x9b9ce=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x288)]],_0x51ecfb=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x242)]],_0x180cc5=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x271)]],_0x48dc9b=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x2a8)]],_0x37068a=[..._0x512f4a[_0x417da2(0x298)][_0x417da2(0x25d)]];const _0x489ee6=_0x41b8a7[_0x417da2(0x244)](_0x1ef134=>{return _0x1ef134={'product_name':_0x1ef134};});_0x145b46[_0x417da2(0x2b4)]((_0x552850,_0xd6871c)=>{var _0x13aebf=_0x417da2;_0x489ee6[_0xd6871c][_0x13aebf(0x23d)]=_0x552850;}),_0x180cc5[_0x417da2(0x2b4)]((_0x4b8aed,_0x1be0db)=>{var _0x2d11dd=_0x417da2;_0x489ee6[_0x1be0db][_0x2d11dd(0x271)]=_0x4b8aed;}),_0x48dc9b['forEach']((_0x4eb9e5,_0x3bae85)=>{var _0x3d07cf=_0x417da2;_0x489ee6[_0x3bae85][_0x3d07cf(0x2ac)]=_0x4eb9e5;}),_0x37068a[_0x417da2(0x2b4)]((_0x51a99a,_0x35fc96)=>{_0x489ee6[_0x35fc96]['id_transaction_id']=_0x51a99a;}),_0x1e92d8['forEach']((_0x1b0f70,_0x39fd9c)=>{var _0x1a9087=_0x417da2;_0x9b9ce[_0x1a9087(0x2b4)]((_0x441ca3,_0x3f9d43)=>{var _0x424629=_0x1a9087;if(_0x441ca3==_0x424629(0x28a)&&_0x39fd9c==_0x3f9d43){var _0xc52d1a=_0x1b0f70[_0x424629(0x26b)](0x3);_0x489ee6[_0x39fd9c]['from_storage']=_0x1b0f70[0x0],_0x489ee6[_0x39fd9c][_0x424629(0x1f2)]=_0x1b0f70[0x1],_0x489ee6[_0x39fd9c][_0x424629(0x1f6)]=0x0,_0x489ee6[_0x39fd9c][_0x424629(0x2bf)]=0x0,_0x489ee6[_0x39fd9c][_0x424629(0x228)]=_0x424629(0x27c),_0x489ee6[_0x39fd9c]['from_floorlevel']=_0xc52d1a;}else{if(_0x441ca3==_0x424629(0x203)&&_0x39fd9c==_0x3f9d43){var _0xc52d1a=_0x1b0f70['slice'](0x3);_0x489ee6[_0x39fd9c][_0x424629(0x1ff)]=_0x1b0f70[0x0],_0x489ee6[_0x39fd9c][_0x424629(0x1f2)]=_0x1b0f70[0x1],_0x489ee6[_0x39fd9c][_0x424629(0x1f6)]=0x0,_0x489ee6[_0x39fd9c][_0x424629(0x2bf)]=0x0,_0x489ee6[_0x39fd9c]['from_types']=_0x424629(0x27c),_0x489ee6[_0x39fd9c]['from_floorlevel']=_0x1b0f70[0x5];}else{if(_0x39fd9c==_0x3f9d43){if(_0x1b0f70[0x0]=='A'&&_0x1b0f70[0x1]=='L'&&_0x1b0f70[0x2]=='L')console[_0x424629(0x299)](_0x441ca3+_0x424629(0x2e3)+_0x39fd9c+_0x424629(0x2e3)+_0x3f9d43+'\x20<>\x20'+_0x1b0f70+_0x424629(0x29d)),_0x489ee6[_0x39fd9c][_0x424629(0x1ff)]=_0x1b0f70[0x0],_0x489ee6[_0x39fd9c][_0x424629(0x1f2)]=_0x1b0f70[0x1],_0x489ee6[_0x39fd9c][_0x424629(0x1f6)]=0x0,_0x489ee6[_0x39fd9c][_0x424629(0x2bf)]=0x0,_0x489ee6[_0x39fd9c][_0x424629(0x228)]='Floor',_0x489ee6[_0x39fd9c]['from_floorlevel']=_0x1b0f70[0x3];else{var _0x3ada33;if(_0x1b0f70[0x4]=='L')_0x3ada33=_0x424629(0x2db);else _0x1b0f70[0x4]=='F'&&(_0x3ada33=_0x424629(0x27c));_0x489ee6[_0x39fd9c][_0x424629(0x1ff)]=_0x1b0f70[0x0],_0x489ee6[_0x39fd9c]['from_rack']=_0x1b0f70[0x1],_0x489ee6[_0x39fd9c][_0x424629(0x1f6)]=_0x1b0f70[0x2],_0x489ee6[_0x39fd9c][_0x424629(0x2bf)]=_0x1b0f70[0x3],_0x489ee6[_0x39fd9c][_0x424629(0x228)]=_0x3ada33,_0x489ee6[_0x39fd9c][_0x424629(0x20a)]=_0x1b0f70[0x5];}}}}});}),_0x3697d7[_0x417da2(0x2b4)]((_0x3e0cf3,_0x193629)=>{var _0x52f59a=_0x417da2;_0x489ee6[_0x193629][_0x52f59a(0x261)]=_0x3e0cf3;}),_0x2e623d[_0x417da2(0x2b4)]((_0x4eaaa1,_0x60f2b8)=>{var _0x3bcbf3=_0x417da2;_0x51ecfb[_0x3bcbf3(0x2b4)]((_0x7b0322,_0x55a03d)=>{var _0x31ad6e=_0x3bcbf3;if(_0x7b0322==_0x31ad6e(0x28a)&&_0x60f2b8==_0x55a03d){var _0x295b79=_0x4eaaa1[_0x31ad6e(0x26b)](0x3);_0x489ee6[_0x60f2b8][_0x31ad6e(0x28f)]=_0x4eaaa1[0x0],_0x489ee6[_0x60f2b8][_0x31ad6e(0x25b)]=_0x4eaaa1[0x1],_0x489ee6[_0x60f2b8][_0x31ad6e(0x2c4)]=0x0,_0x489ee6[_0x60f2b8]['to_bin']=0x0,_0x489ee6[_0x60f2b8]['to_types']=_0x31ad6e(0x27c),_0x489ee6[_0x60f2b8][_0x31ad6e(0x2d8)]=_0x295b79;}else{if(_0x7b0322==_0x31ad6e(0x203)&&_0x60f2b8==_0x55a03d){var _0x295b79=_0x4eaaa1[_0x31ad6e(0x26b)](0x3);_0x489ee6[_0x60f2b8]['storage']=_0x4eaaa1[0x0],_0x489ee6[_0x60f2b8][_0x31ad6e(0x25b)]=_0x4eaaa1[0x1],_0x489ee6[_0x60f2b8][_0x31ad6e(0x2c4)]=0x0,_0x489ee6[_0x60f2b8][_0x31ad6e(0x219)]=0x0,_0x489ee6[_0x60f2b8][_0x31ad6e(0x21e)]=_0x31ad6e(0x27c),_0x489ee6[_0x60f2b8][_0x31ad6e(0x2d8)]=_0x4eaaa1[0x5];}else{if(_0x60f2b8==_0x55a03d){if(_0x4eaaa1[0x0]=='A'&&_0x4eaaa1[0x1]=='L'&&_0x4eaaa1[0x2]=='L')console[_0x31ad6e(0x299)](_0x7b0322+_0x31ad6e(0x2e3)+_0x60f2b8+_0x31ad6e(0x2e3)+_0x55a03d+_0x31ad6e(0x2e3)+_0x4eaaa1+'here'),_0x489ee6[_0x60f2b8][_0x31ad6e(0x28f)]=_0x4eaaa1[0x0],_0x489ee6[_0x60f2b8][_0x31ad6e(0x25b)]=_0x4eaaa1[0x1],_0x489ee6[_0x60f2b8]['to_bay']=0x0,_0x489ee6[_0x60f2b8][_0x31ad6e(0x219)]=0x0,_0x489ee6[_0x60f2b8][_0x31ad6e(0x21e)]=_0x31ad6e(0x27c),_0x489ee6[_0x60f2b8][_0x31ad6e(0x2d8)]=_0x4eaaa1[0x3];else{var _0x197277;if(_0x4eaaa1[0x4]=='L')_0x197277=_0x31ad6e(0x2db);else _0x4eaaa1[0x4]=='F'&&(_0x197277='Floor');_0x489ee6[_0x60f2b8]['storage']=_0x4eaaa1[0x0],_0x489ee6[_0x60f2b8][_0x31ad6e(0x25b)]=_0x4eaaa1[0x1],_0x489ee6[_0x60f2b8]['to_bay']=_0x4eaaa1[0x2],_0x489ee6[_0x60f2b8]['to_bin']=_0x4eaaa1[0x3],_0x489ee6[_0x60f2b8][_0x31ad6e(0x21e)]=_0x197277,_0x489ee6[_0x60f2b8][_0x31ad6e(0x2d8)]=_0x4eaaa1[0x5];}}}}});}),_0x2fe7f8[_0x417da2(0x2b4)]((_0x1f6406,_0x2c6c2a)=>{var _0x1a2056=_0x417da2;_0x489ee6[_0x2c6c2a][_0x1a2056(0x224)]=_0x1f6406;}),_0x1e953e[_0x417da2(0x2b4)]((_0xcf6329,_0x419b77)=>{var _0x4b297d=_0x417da2;_0x489ee6[_0x419b77][_0x4b297d(0x2b2)]=_0xcf6329;}),_0x3cd1af[_0x417da2(0x2b4)]((_0x12cfd4,_0x5c2db9)=>{var _0x30d452=_0x417da2;_0x489ee6[_0x5c2db9][_0x30d452(0x273)]=_0x12cfd4;}),_0xea8e9e[_0x417da2(0x2b4)]((_0x1e02f2,_0x425ee2)=>{_0x489ee6[_0x425ee2]['maxProducts']=_0x1e02f2;}),_0x1d609e[_0x417da2(0x2b4)]((_0xfe6acb,_0x3bdf5c)=>{var _0x335459=_0x417da2;_0x489ee6[_0x3bdf5c][_0x335459(0x250)]=_0xfe6acb;}),_0x557bd4[_0x417da2(0x2b4)]((_0x4aaccd,_0x45d4f9)=>{var _0xddbffb=_0x417da2;_0x489ee6[_0x45d4f9][_0xddbffb(0x1f3)]=_0x4aaccd;}),_0x50a4b6[_0x417da2(0x2b4)]((_0x50b4dc,_0x365733)=>{var _0x546198=_0x417da2;_0x489ee6[_0x365733][_0x546198(0x282)]=_0x50b4dc;}),_0x1cf55a[_0x417da2(0x2b4)]((_0x225651,_0x51d70c)=>{var _0x7b269e=_0x417da2;_0x489ee6[_0x51d70c][_0x7b269e(0x29e)]=_0x225651;}),_0x509eb7[_0x417da2(0x2b4)]((_0x16fd79,_0x37d210)=>{var _0x300ce8=_0x417da2;_0x489ee6[_0x37d210][_0x300ce8(0x284)]=_0x16fd79;}),_0x4da07e[_0x417da2(0x2b4)]((_0x15f871,_0x5e99fb)=>{var _0x447031=_0x417da2;_0x489ee6[_0x5e99fb][_0x447031(0x217)]=_0x15f871;}),_0x55a5f3[_0x417da2(0x2b4)]((_0x43fded,_0x43259e)=>{_0x489ee6[_0x43259e]['prod_cat']=_0x43fded;}),_0x9b9ce['forEach']((_0x2826f8,_0xb51c67)=>{var _0x2827bb=_0x417da2;_0x489ee6[_0xb51c67][_0x2827bb(0x1fd)]=_0x2826f8;}),_0x51ecfb[_0x417da2(0x2b4)]((_0xd63ed,_0xeafce0)=>{var _0x271456=_0x417da2;_0x489ee6[_0xeafce0][_0x271456(0x29c)]=_0xd63ed;});const _0x3df94f=_0x489ee6[_0x417da2(0x1f9)](_0x4cffdc=>_0x4cffdc[_0x417da2(0x261)]!=='0'&&_0x4cffdc[_0x417da2(0x261)]!==''||_0x4cffdc['to_floorlevel']!=='0'&&_0x4cffdc[_0x417da2(0x2d8)]!==''),_0x5a3101=new transfers({'date':_0x3736cd,'from_warehouse':_0x4fd752,'to_warehouse':_0x381bf3,'product':_0x3df94f,'note':_0x29c2eb,'invoice':_0x13204e}),_0x4f32ec=await _0x5a3101[_0x417da2(0x243)]();_0x512f4a['flash']('success','Product\x20Transfer\x20successfully'),_0x39ca91[_0x417da2(0x230)](_0x417da2(0x222)+_0x4f32ec['_id']);}catch(_0x2ee0ee){console[_0x417da2(0x299)](_0x2ee0ee),_0x39ca91['status'](0xc8)[_0x417da2(0x233)]({'errorMessage':_0x2ee0ee[_0x417da2(0x201)]});}}),router[a0_0x30d976(0x239)](a0_0x30d976(0x234),auth,async(_0x40cf42,_0x5cc0af)=>{var _0x65490f=a0_0x30d976;try{const {username:_0x2a48d5,email:_0x39b577,role:_0x5d30a5}=_0x40cf42['user'],_0x1d9652=_0x40cf42['user'],_0x5ceb69=await profile['findOne']({'email':_0x1d9652[_0x65490f(0x238)]}),_0x37d454=await master_shop[_0x65490f(0x206)]();console['log'](_0x65490f(0x275),_0x37d454);const _0x19162a=await transfers[_0x65490f(0x2b9)](_0x40cf42[_0x65490f(0x2c9)]['id']);let _0x5eaef3=new Date(_0x19162a[_0x65490f(0x29e)]),_0x5a73b1=('0'+_0x5eaef3[_0x65490f(0x29a)]())[_0x65490f(0x26b)](-0x2),_0x25f20f=('0'+(_0x5eaef3[_0x65490f(0x2a0)]()+0x1))[_0x65490f(0x26b)](-0x2),_0xd86d20=_0x5eaef3[_0x65490f(0x2d2)](),_0x195e15=_0xd86d20+'-'+_0x25f20f+'-'+_0x5a73b1,_0x27c7e5;if(_0x1d9652[_0x65490f(0x266)]==_0x65490f(0x2de)){const _0x2701cd=await staff[_0x65490f(0x211)]({'email':_0x1d9652[_0x65490f(0x238)]});_0x27c7e5=await warehouse['find']({'status':'Enabled','name':_0x2701cd[_0x65490f(0x24e)],'warehouse_category':_0x65490f(0x280)});}else _0x27c7e5=await warehouse['find']({'status':_0x65490f(0x2a2),'warehouse_category':_0x65490f(0x280)});const _0x33d420=await warehouse[_0x65490f(0x277)]([{'$match':{'name':_0x19162a[_0x65490f(0x2af)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x65490f(0x26f),'name':{'$first':_0x65490f(0x253)},'product_stock':{'$first':_0x65490f(0x2cb)},'bay':{'$first':_0x65490f(0x2c0)},'bin':{'$first':_0x65490f(0x1eb)},'type':{'$first':_0x65490f(0x1fa)},'floorlevel':{'$first':_0x65490f(0x267)},'primary_code':{'$first':_0x65490f(0x202)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x65490f(0x2e5)},'storage':{'$first':_0x65490f(0x2cf)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x65490f(0x2ad)},'room':{'$first':_0x65490f(0x241)}}}]);if(_0x37d454[0x0][_0x65490f(0x1f1)]==_0x65490f(0x2d9)){var _0x3e74c1=users[_0x65490f(0x2aa)];console[_0x65490f(0x299)](_0x3e74c1);}else{if(_0x37d454[0x0][_0x65490f(0x1f1)]==_0x65490f(0x20e))var _0x3e74c1=users[_0x65490f(0x20e)];else{if(_0x37d454[0x0][_0x65490f(0x1f1)]==_0x65490f(0x227))var _0x3e74c1=users['German'];else{if(_0x37d454[0x0][_0x65490f(0x1f1)]=='Spanish')var _0x3e74c1=users[_0x65490f(0x254)];else{if(_0x37d454[0x0][_0x65490f(0x1f1)]==_0x65490f(0x1ec))var _0x3e74c1=users[_0x65490f(0x1ec)];else{if(_0x37d454[0x0][_0x65490f(0x1f1)]==_0x65490f(0x28b))var _0x3e74c1=users[_0x65490f(0x256)];else{if(_0x37d454[0x0][_0x65490f(0x1f1)]==_0x65490f(0x263))var _0x3e74c1=users[_0x65490f(0x263)];else{if(_0x37d454[0x0][_0x65490f(0x1f1)]==_0x65490f(0x22d))var _0x3e74c1=users[_0x65490f(0x2a7)];}}}}}}}_0x5cc0af['render'](_0x65490f(0x1fc),{'success':_0x40cf42[_0x65490f(0x207)](_0x65490f(0x212)),'errors':_0x40cf42[_0x65490f(0x207)](_0x65490f(0x2b1)),'role':_0x1d9652,'profile':_0x5ceb69,'master_shop':_0x37d454,'warehouse':_0x27c7e5,'transfer':_0x19162a,'stock':_0x33d420,'language':_0x3e74c1});}catch(_0x375907){console[_0x65490f(0x299)](_0x375907);}});async function updateProduct_detl(_0x368ec0){var _0x18c222=a0_0x30d976;const _0x13e7b4=await mongoose[_0x18c222(0x29f)]();try{console['log'](_0x18c222(0x26e));const _0x4bf247=mongoose['Types'][_0x18c222(0x293)];return await _0x13e7b4['withTransaction'](async()=>{var _0x170eb5=_0x18c222;for(const _0x380871 of _0x368ec0[_0x170eb5(0x20f)]){console[_0x170eb5(0x299)](new _0x4bf247());const _0x340b50=await warehouse[_0x170eb5(0x277)]([{'$match':{'name':_0x368ec0[_0x170eb5(0x2af)],'room':_0x380871['from_room_name']}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x4bf247(_0x380871[_0x170eb5(0x2b5)])}}])['session'](_0x13e7b4);if(_0x340b50[_0x170eb5(0x22b)]===0x0)throw new Error(_0x170eb5(0x248)+_0x380871[_0x170eb5(0x1fd)]);for(const _0x2d781e of _0x340b50){console[_0x170eb5(0x299)](parseFloat(_0x2d781e[_0x170eb5(0x226)][_0x170eb5(0x2a5)][_0x170eb5(0x28e)](0x2))>=parseFloat(_0x380871[_0x170eb5(0x261)]['toFixed'](0x2)));if(parseFloat(_0x2d781e['product_details'][_0x170eb5(0x2a5)][_0x170eb5(0x28e)](0x2))>=parseFloat(_0x380871[_0x170eb5(0x261)][_0x170eb5(0x28e)](0x2))){let _0x4f907b=(parseFloat(_0x2d781e['product_details'][_0x170eb5(0x2a5)][_0x170eb5(0x28e)](0x2))-parseFloat(_0x380871[_0x170eb5(0x261)]))['toFixed'](0x2);console['log'](_0x170eb5(0x296),_0x4f907b),console['log'](_0x170eb5(0x2e7)),await warehouse['updateOne']({'_id':_0x4bf247(_0x2d781e[_0x170eb5(0x2b8)]),'product_details._id':_0x4bf247(_0x2d781e[_0x170eb5(0x226)][_0x170eb5(0x2b8)])},{'$set':{'product_details.$.product_stock':_0x4f907b,'product_details.$.trf_invoice':_0x368ec0[_0x170eb5(0x25f)]}},{'session':_0x13e7b4});const _0x3c7d25=await warehouse[_0x170eb5(0x277)]([{'$match':{'name':_0x368ec0[_0x170eb5(0x257)],'room':_0x380871[_0x170eb5(0x29c)]}}])[_0x170eb5(0x24c)](_0x13e7b4);console[_0x170eb5(0x299)](_0x170eb5(0x204)),await warehouse[_0x170eb5(0x2e9)]({'name':_0x368ec0[_0x170eb5(0x257)],'room':_0x380871['to_room_name']},{'$push':{'product_details':{'product_name':_0x380871['product_name'],'product_stock':_0x380871[_0x170eb5(0x261)],'primary_code':_0x380871[_0x170eb5(0x224)],'secondary_code':_0x380871['secondary_code'],'product_code':_0x380871['product_code'],'storage':_0x380871[_0x170eb5(0x28f)],'rack':_0x380871[_0x170eb5(0x25b)],'bay':_0x380871[_0x170eb5(0x2c4)],'bin':_0x380871[_0x170eb5(0x219)],'type':_0x380871[_0x170eb5(0x21e)],'floorlevel':_0x380871[_0x170eb5(0x2d8)],'maxProducts':_0x380871['maxProducts'],'expiry_date':_0x380871[_0x170eb5(0x29e)],'production_date':_0x380871['production_date'],'maxPerUnit':_0x380871['maxperunit'],'batch_code':_0x380871[_0x170eb5(0x282)],'unit':_0x380871[_0x170eb5(0x250)],'secondary_unit':_0x380871[_0x170eb5(0x1f3)],'alertQTY':_0x2d781e['product_details'][_0x170eb5(0x1f5)],'delivery_date':_0x2d781e[_0x170eb5(0x226)][_0x170eb5(0x291)],'delivery_code':_0x2d781e[_0x170eb5(0x226)]['delivery_code'],'product_cat':_0x2d781e[_0x170eb5(0x226)]['product_cat'],'invoice':_0x380871[_0x170eb5(0x271)],'trf_invoice':_0x368ec0[_0x170eb5(0x25f)],'date_data':_0x368ec0[_0x170eb5(0x2b3)],'_id':new _0x4bf247()}}},{'session':_0x13e7b4});}else{console[_0x170eb5(0x299)](_0x170eb5(0x20b),QTYTotal);throw new Error('No\x20matching\x20document\x20found\x20for\x20product\x20ID\x20'+_0x2d781e['_id']+_0x170eb5(0x231)+QTYTotal);}}}}),{'success':!![],'message':'Products\x20updated\x20successfully.'};}catch(_0x17a586){return console[_0x18c222(0x299)](_0x17a586),await _0x13e7b4[_0x18c222(0x1f7)](),console[_0x18c222(0x299)](_0x18c222(0x270)),{'success':![],'message':_0x17a586[_0x18c222(0x201)]};}finally{_0x13e7b4[_0x18c222(0x220)](),console[_0x18c222(0x299)]('..............disconnected.....................');}}router['post'](a0_0x30d976(0x234),auth,async(_0x392e9e,_0x53adc9)=>{var _0xa28496=a0_0x30d976;try{const _0x55a552=_0x392e9e[_0xa28496(0x2c9)]['id'],{from_warehouse:_0x4d82c2,FromRoom_name:_0x9a4602,to_warehouse:_0xcdd66e,ToRoom_name:_0x44e8e3}=_0x392e9e[_0xa28496(0x298)],_0x10624e=await transfers[_0xa28496(0x2b9)]({'_id':_0x55a552});await updateProduct_detl(_0x10624e),_0x10624e[_0xa28496(0x26c)]=_0xa28496(0x237);const _0x2f05ec=await _0x10624e[_0xa28496(0x243)](),_0x1c19a3=await master_shop[_0xa28496(0x206)](),_0x1e4f7f=await email_settings[_0xa28496(0x211)](),_0x1bf3fd=await supervisor_settings[_0xa28496(0x206)]();var _0x1b090d=_0x10624e[_0xa28496(0x20f)],_0x29f044='',_0x33b182;for(_0x33b182 in _0x1b090d){_0x29f044+=_0xa28496(0x218)+_0xa28496(0x1ef)+_0x1b090d[_0x33b182][_0xa28496(0x2c1)]+'</td>'+_0xa28496(0x1ef)+_0x1b090d[_0x33b182][_0xa28496(0x273)]+_0xa28496(0x21f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1b090d[_0x33b182][_0xa28496(0x261)]+_0xa28496(0x21f)+_0xa28496(0x1ef)+_0x1b090d[_0x33b182][_0xa28496(0x250)]+_0xa28496(0x21f)+_0xa28496(0x1ef)+_0x1b090d[_0x33b182][_0xa28496(0x1f3)]+_0xa28496(0x21f)+_0xa28496(0x1ef)+_0x10624e[_0xa28496(0x257)]+'</td>'+_0xa28496(0x1ef)+_0x1b090d[_0x33b182]['to_room_name']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1b090d[_0x33b182][_0xa28496(0x28f)]+_0x1b090d[_0x33b182]['rack']+_0x1b090d[_0x33b182][_0xa28496(0x2c4)]+_0x1b090d[_0x33b182]['to_bin']+_0x1b090d[_0x33b182][_0xa28496(0x21e)][0x0]+_0x1b090d[_0x33b182][_0xa28496(0x2d8)]+_0xa28496(0x21f),_0xa28496(0x229);}let _0x1a6a8=nodemailer[_0xa28496(0x225)]({'host':_0x1e4f7f[_0xa28496(0x24b)],'port':Number(_0x1e4f7f[_0xa28496(0x23e)]),'secure':![],'auth':{'user':_0x1e4f7f[_0xa28496(0x238)],'pass':_0x1e4f7f[_0xa28496(0x2ab)]}}),_0x2355e8={'from':_0x1e4f7f[_0xa28496(0x238)],'to':_0x1bf3fd[0x0]['RMSEmail'],'subject':'Transfer\x20Mail','attachments':[{'filename':_0xa28496(0x235),'path':__dirname+_0xa28496(0x27d)+_0xa28496(0x245)+_0x1c19a3[0x0][_0xa28496(0x22c)],'cid':'logo'}],'html':_0xa28496(0x2be)+_0xa28496(0x2d1)+'</head><body>'+_0xa28496(0x2c7)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0xa28496(0x2c7)+_0xa28496(0x1ea)+_0xa28496(0x2a4)+_0xa28496(0x2c7)+_0xa28496(0x2cd)+_0x1c19a3[0x0][_0xa28496(0x223)]+_0xa28496(0x24a)+'</div>'+_0xa28496(0x2a4)+_0xa28496(0x246)+_0xa28496(0x2c7)+_0xa28496(0x285)+_0xa28496(0x232)+_0x10624e[_0xa28496(0x25f)]+'\x20'+_0xa28496(0x2dd)+_0xa28496(0x2c2)+_0x10624e[_0xa28496(0x2b3)]+'\x20'+_0xa28496(0x2b0)+_0xa28496(0x2d0)+_0xa28496(0x2a4)+_0xa28496(0x2b6)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xa28496(0x218)+_0xa28496(0x281)+_0xa28496(0x216)+_0xa28496(0x2dc)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0xa28496(0x2d6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0xa28496(0x2c5)+_0xa28496(0x1fe)+'</tr>'+_0xa28496(0x2bd)+_0xa28496(0x2e2)+'\x20'+_0x29f044+'\x20'+'</tbody>'+_0xa28496(0x2bc)+_0xa28496(0x2c7)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x1c19a3[0x0]['site_title']+_0xa28496(0x2d0)+_0xa28496(0x2a4)+_0xa28496(0x2a4)+_0xa28496(0x2ae)};_0x1a6a8['sendMail'](_0x2355e8,function(_0x249c00,_0x54f3c2){var _0xfc5954=_0xa28496;_0x249c00?(console[_0xfc5954(0x299)](_0x249c00),console[_0xfc5954(0x299)](_0xfc5954(0x2a1))):console[_0xfc5954(0x299)]('Email\x20sent\x20successfully');}),_0x392e9e['flash'](_0xa28496(0x212),_0xa28496(0x21a)),_0x53adc9['redirect'](_0xa28496(0x276)+_0x2f05ec['_id']);}catch(_0x19d952){console[_0xa28496(0x299)](_0x19d952);}});function BayBinSelected(_0x453967,_0x442c8b){var _0x4b7510=a0_0x30d976,_0x123e1e=[],_0x5a3004=[],_0x5e3e00=[],_0x4cbe64=[],_0x168f97=[],_0x1c52b0=[];let _0x201d15=[];if(_0x453967==_0x4b7510(0x25e))switch(_0x442c8b){case _0x4b7510(0x2a6):_0x123e1e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x5a3004=[0x1,0x2],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x2db),_0x4b7510(0x27c)],_0x168f97=['D'],_0x1c52b0=['A'];break;case _0x4b7510(0x2ba):_0x123e1e=[0x6,0x5,0x4,0x3,0x2,0x1],_0x5a3004=[0x1,0x2],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x2db),_0x4b7510(0x27c)],_0x168f97=['D'],_0x1c52b0=['B'];break;case _0x4b7510(0x203):_0x123e1e=[0x0],_0x5a3004=[0x0],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x27c)],_0x168f97=['D'],_0x1c52b0=['S'];break;case _0x4b7510(0x28a):_0x123e1e=[0x0],_0x5a3004=[0x0],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5e3e00=[_0x4b7510(0x27c)],_0x168f97=['D'],_0x1c52b0=['R'];break;}else{if(_0x453967==_0x4b7510(0x1e9))switch(_0x442c8b){case'Rack\x20A':_0x123e1e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x5a3004=['B','F'],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x2db),_0x4b7510(0x27c)],_0x168f97=['C'],_0x1c52b0=['A'];break;case _0x4b7510(0x2ba):_0x123e1e=[0x5,0x4,0x3,0x2,0x1],_0x5a3004=['F','B','S'],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x2db),_0x4b7510(0x27c)],_0x168f97=['C'],_0x1c52b0=['B'];break;case'Rack\x20C':_0x123e1e=[0x1,0x2,0x3,0x4,0x5],_0x5a3004=['B','F','S'],_0x4cbe64=[0x5,0x4,0x3,0x2,0x1],_0x5e3e00=[_0x4b7510(0x2db),_0x4b7510(0x27c)],_0x168f97=['C'],_0x1c52b0=['C'];break;case _0x4b7510(0x20c):_0x123e1e=[0x5,0x4,0x3,0x2,0x1],_0x5a3004=['F','B','S'],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x2db),_0x4b7510(0x27c)],_0x168f97=['C'],_0x1c52b0=['D'];break;case _0x4b7510(0x258):_0x123e1e=[0x4,0x3,0x2,0x1],_0x5a3004=[0x1,0x2],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x2db),_0x4b7510(0x27c)],_0x168f97=['C'],_0x1c52b0=['E'];break;case _0x4b7510(0x292):_0x123e1e=[0x1,0x2,0x3],_0x5a3004=[0x1,0x2],_0x4cbe64=[0x1,0x2,0x3,0x4,0x5],_0x5e3e00=[_0x4b7510(0x2db)],_0x168f97=['C'],_0x1c52b0=['F'];break;}}return{'levels':_0x123e1e,'Isle':_0x5a3004,'rack':_0x4cbe64,'type':_0x5e3e00,'storage':_0x168f97,'rak':_0x1c52b0};}router['get'](a0_0x30d976(0x2cc),auth,async(_0x9cad72,_0x5cbfbb)=>{var _0x4981f2=a0_0x30d976;try{const {username:_0xf5a8a1,email:_0x3ef4ff,role:_0x5c255c}=_0x9cad72[_0x4981f2(0x2df)],_0x59ad3c=_0x9cad72['user'],_0xccb9d1=await profile['findOne']({'email':_0x59ad3c[_0x4981f2(0x238)]}),_0x19a23b=await master_shop[_0x4981f2(0x206)](),_0x59f3c5=await transfers[_0x4981f2(0x2b9)](_0x9cad72[_0x4981f2(0x2c9)]['id']);let _0x5cd7e1;if(_0x59ad3c[_0x4981f2(0x266)]==_0x4981f2(0x2de)){const _0x245209=await staff[_0x4981f2(0x211)]({'email':_0x59ad3c['email']});_0x5cd7e1=await warehouse[_0x4981f2(0x277)]([{'$match':{'status':_0x4981f2(0x2a2),'name':_0x245209[_0x4981f2(0x24e)],'warehouse_category':_0x4981f2(0x280)}},{'$group':{'_id':_0x4981f2(0x274),'name':{'$first':_0x4981f2(0x274)}}}]);}else _0x5cd7e1=await warehouse['aggregate']([{'$match':{'status':_0x4981f2(0x2a2),'warehouse_category':_0x4981f2(0x280)}},{'$group':{'_id':_0x4981f2(0x274),'name':{'$first':_0x4981f2(0x274)}}}]);const _0x3c656d=await warehouse[_0x4981f2(0x277)]([{'$match':{'name':_0x59f3c5['from_warehouse'],'warehouse_category':_0x4981f2(0x280)}},{'$unwind':_0x4981f2(0x286)},{'$group':{'_id':_0x4981f2(0x26f),'name':{'$first':_0x4981f2(0x253)},'product_stock':{'$first':_0x4981f2(0x2cb)},'bay':{'$first':_0x4981f2(0x2c0)},'bin':{'$first':_0x4981f2(0x1eb)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4981f2(0x202)},'secondary_code':{'$first':_0x4981f2(0x26d)},'product_code':{'$first':_0x4981f2(0x2e5)},'storage':{'$first':_0x4981f2(0x2cf)},'rack':{'$first':_0x4981f2(0x1f4)},'expiry_date':{'$first':_0x4981f2(0x21c)},'production_date':{'$first':_0x4981f2(0x2ad)},'room':{'$first':_0x4981f2(0x241)}}}]),_0x529c1e=await product[_0x4981f2(0x206)]({}),_0xc9ce5a=BayBinSelected(_0x59f3c5['to_warehouse'],_0x59f3c5[_0x4981f2(0x2e8)]);if(_0x19a23b[0x0][_0x4981f2(0x1f1)]=='English\x20(US)'){var _0x332e3e=users[_0x4981f2(0x2aa)];console[_0x4981f2(0x299)](_0x332e3e);}else{if(_0x19a23b[0x0][_0x4981f2(0x1f1)]==_0x4981f2(0x20e))var _0x332e3e=users['Hindi'];else{if(_0x19a23b[0x0]['language']==_0x4981f2(0x227))var _0x332e3e=users['German'];else{if(_0x19a23b[0x0][_0x4981f2(0x1f1)]==_0x4981f2(0x254))var _0x332e3e=users['Spanish'];else{if(_0x19a23b[0x0][_0x4981f2(0x1f1)]=='French')var _0x332e3e=users[_0x4981f2(0x1ec)];else{if(_0x19a23b[0x0][_0x4981f2(0x1f1)]==_0x4981f2(0x28b))var _0x332e3e=users['Portuguese'];else{if(_0x19a23b[0x0][_0x4981f2(0x1f1)]=='Chinese')var _0x332e3e=users[_0x4981f2(0x263)];else{if(_0x19a23b[0x0][_0x4981f2(0x1f1)]==_0x4981f2(0x22d))var _0x332e3e=users['Arabic'];}}}}}}}_0x5cbfbb[_0x4981f2(0x214)](_0x4981f2(0x287),{'success':_0x9cad72[_0x4981f2(0x207)](_0x4981f2(0x212)),'errors':_0x9cad72['flash']('errors'),'role':_0x59ad3c,'profile':_0xccb9d1,'master_shop':_0x19a23b,'warehouse':_0x5cd7e1,'transfer':_0x59f3c5,'stock':_0x3c656d,'unit':_0x529c1e,'language':_0x332e3e});}catch(_0x4c7adc){console[_0x4981f2(0x299)](_0x4c7adc);}}),router[a0_0x30d976(0x24f)]('/view/:id',auth,async(_0x2174b5,_0x10544e)=>{var _0x2c1728=a0_0x30d976;try{const _0x4ea3e8=_0x2174b5['params']['id'],_0x3c6603=await transfers[_0x2c1728(0x2b9)](_0x4ea3e8);_0x10544e['json'](_0x2174b5[_0x2c1728(0x298)]);return;const {date:_0x5cdd6a,from_warehouse:_0x48a9d0,FromRoom_name:_0x562815,to_warehouse:_0x12161c,ToRoom_name:_0x2315a8,prod_name:_0x26980a,from_prod_qty:_0x1e97db,from_prod_level:_0x4a3c8f,from_prod_isle:_0x5ead4b,from_prod_pallet:_0x26e595,to_prod_qty:_0x52aa65,to_prod_level:_0x9929de,to_prod_isle:_0x1c4da0,to_prod_pallet:_0x2755ce,primary_code:_0x42ca2f,secondary_code:_0x5e6db7,product_code3:_0x556cb7,note:_0x5529ce,invoice:_0x161722,expiry_date:_0x2b04a6}=_0x2174b5[_0x2c1728(0x298)];if(typeof _0x26980a==_0x2c1728(0x200))var _0x42de18=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x210)]],_0x1a712f=[_0x2174b5['body'][_0x2c1728(0x2e0)]],_0x2d7f5d=[_0x2174b5[_0x2c1728(0x298)]['from_prod_level']],_0x341ee1=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x209)]],_0x4e092d=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x23f)]],_0x375aaa=[_0x2174b5['body'][_0x2c1728(0x228)]],_0x40b1a2=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2ea)]],_0x28bf4c=[_0x2174b5[_0x2c1728(0x298)]['to_prod_level']],_0x1e11c3=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x294)]],_0xd086c2=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2c3)]],_0x5599b5=[_0x2174b5['body'][_0x2c1728(0x21e)]],_0x191bc0=[_0x2174b5[_0x2c1728(0x298)]['storage']],_0x171c20=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x23a)]],_0xd83ce=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x224)]],_0x454ede=[_0x2174b5['body'][_0x2c1728(0x2b2)]],_0x784591=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2e6)]],_0x527020=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2bb)]],_0x39f444=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x250)]],_0x45c8b3=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x1f3)]],_0x2d0944=[_0x2174b5['body']['batch_code']],_0x8b93a7=[_0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x29e)]],_0x25c8a1=[_0x2174b5[_0x2c1728(0x298)]['from_storage']],_0x322074=[_0x2174b5[_0x2c1728(0x298)]['from_rak']];else var _0x42de18=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x210)]],_0x191bc0=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x28f)]],_0x171c20=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x23a)]],_0x375aaa=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x228)]],_0x5599b5=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x21e)]],_0x1a712f=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2e0)]],_0x2d7f5d=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x283)]],_0x341ee1=[..._0x2174b5['body'][_0x2c1728(0x209)]],_0x4e092d=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x23f)]],_0x40b1a2=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2ea)]],_0x28bf4c=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x1f0)]],_0x1e11c3=[..._0x2174b5['body'][_0x2c1728(0x294)]],_0xd086c2=[..._0x2174b5['body']['to_prod_pallet']],_0xd83ce=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x224)]],_0x454ede=[..._0x2174b5['body'][_0x2c1728(0x2b2)]],_0x784591=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2e6)]],_0x527020=[..._0x2174b5[_0x2c1728(0x298)]['MaxStocks_data2']],_0x39f444=[..._0x2174b5[_0x2c1728(0x298)]['unit']],_0x45c8b3=[..._0x2174b5['body'][_0x2c1728(0x1f3)]],_0x2d0944=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x282)]],_0x8b93a7=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x29e)]],_0x25c8a1=[..._0x2174b5['body']['from_storage']],_0x322074=[..._0x2174b5[_0x2c1728(0x298)][_0x2c1728(0x2e1)]];const _0x3ae708=_0x42de18['map'](_0x5c43af=>{return _0x5c43af={'product_name':_0x5c43af};});_0x1a712f[_0x2c1728(0x2b4)]((_0x13adf1,_0x22993b)=>{var _0x9a23ca=_0x2c1728;_0x3ae708[_0x22993b][_0x9a23ca(0x23d)]=_0x13adf1;}),_0x2d7f5d[_0x2c1728(0x2b4)]((_0x264d2b,_0x442bee)=>{_0x3ae708[_0x442bee]['from_bay']=_0x264d2b;}),_0x341ee1[_0x2c1728(0x2b4)]((_0x1e4446,_0x399680)=>{var _0x185f81=_0x2c1728;_0x3ae708[_0x399680][_0x185f81(0x2bf)]=_0x1e4446;}),_0x4e092d[_0x2c1728(0x2b4)]((_0xd389bd,_0x4f185e)=>{var _0x596898=_0x2c1728;_0x3ae708[_0x4f185e][_0x596898(0x20a)]=_0xd389bd;}),_0x40b1a2['forEach']((_0x47aefe,_0x2c012c)=>{_0x3ae708[_0x2c012c]['to_quantity']=_0x47aefe;}),_0x28bf4c['forEach']((_0x3821a5,_0x2491e7)=>{var _0x2870ce=_0x2c1728;_0x3ae708[_0x2491e7][_0x2870ce(0x2c4)]=_0x3821a5;}),_0x1e11c3['forEach']((_0x5893e6,_0x50f831)=>{var _0x31ec40=_0x2c1728;_0x3ae708[_0x50f831][_0x31ec40(0x219)]=_0x5893e6;}),_0xd086c2[_0x2c1728(0x2b4)]((_0x14b5c0,_0x3a874a)=>{var _0x3bec54=_0x2c1728;_0x3ae708[_0x3a874a][_0x3bec54(0x2d8)]=_0x14b5c0;}),_0xd83ce['forEach']((_0x5d6dfb,_0x3b758b)=>{var _0xc1d6dd=_0x2c1728;_0x3ae708[_0x3b758b][_0xc1d6dd(0x224)]=_0x5d6dfb;}),_0x454ede[_0x2c1728(0x2b4)]((_0x2dce20,_0x255c1d)=>{_0x3ae708[_0x255c1d]['secondary_code']=_0x2dce20;}),_0x784591[_0x2c1728(0x2b4)]((_0x20ac5d,_0x48c0de)=>{var _0xafef12=_0x2c1728;_0x3ae708[_0x48c0de][_0xafef12(0x273)]=_0x20ac5d;}),_0x527020[_0x2c1728(0x2b4)]((_0x7feb8f,_0x597d20)=>{var _0x5509b1=_0x2c1728;_0x3ae708[_0x597d20][_0x5509b1(0x249)]=_0x7feb8f;}),_0x39f444[_0x2c1728(0x2b4)]((_0x10a833,_0x26b748)=>{var _0x11f3f3=_0x2c1728;_0x3ae708[_0x26b748][_0x11f3f3(0x250)]=_0x10a833;}),_0x45c8b3[_0x2c1728(0x2b4)]((_0x3e879c,_0x4c8200)=>{var _0x30e9b5=_0x2c1728;_0x3ae708[_0x4c8200][_0x30e9b5(0x1f3)]=_0x3e879c;}),_0x2d0944['forEach']((_0x4dc3c7,_0x500466)=>{_0x3ae708[_0x500466]['batch_code']=_0x4dc3c7;}),_0x8b93a7[_0x2c1728(0x2b4)]((_0xb14420,_0x2b3980)=>{_0x3ae708[_0x2b3980]['expiry_date']=_0xb14420;}),_0x191bc0[_0x2c1728(0x2b4)]((_0x420191,_0x4717a9)=>{var _0x4e2fdb=_0x2c1728;_0x3ae708[_0x4717a9][_0x4e2fdb(0x28f)]=_0x420191;}),_0x171c20[_0x2c1728(0x2b4)]((_0x3bf944,_0x13bc52)=>{var _0xb02f54=_0x2c1728;_0x3ae708[_0x13bc52][_0xb02f54(0x25b)]=_0x3bf944;}),_0x375aaa[_0x2c1728(0x2b4)]((_0x16e26f,_0x11ae2e)=>{_0x3ae708[_0x11ae2e]['from_types']=_0x16e26f;}),_0x5599b5[_0x2c1728(0x2b4)]((_0x3b7a9e,_0x2338e8)=>{var _0x55f194=_0x2c1728;_0x3ae708[_0x2338e8][_0x55f194(0x21e)]=_0x3b7a9e;}),_0x25c8a1[_0x2c1728(0x2b4)]((_0x18239d,_0x27443b)=>{_0x3ae708[_0x27443b]['from_storage']=_0x18239d;}),_0x322074[_0x2c1728(0x2b4)]((_0x123cad,_0x1488ef)=>{var _0x3681b5=_0x2c1728;_0x3ae708[_0x1488ef][_0x3681b5(0x1f2)]=_0x123cad;});const _0x4ba141=_0x3ae708[_0x2c1728(0x1f9)](_0x564c98=>_0x564c98['to_quantity']!=='0'&&_0x564c98[_0x2c1728(0x261)]!==''||_0x564c98[_0x2c1728(0x2d8)]!=='0'&&_0x564c98[_0x2c1728(0x2d8)]!=='');var _0x3ece94=0x0;_0x4ba141[_0x2c1728(0x2b4)](_0x2d37d3=>{parseInt(_0x2d37d3['from_quantity'])<parseInt(_0x2d37d3['to_quantity'])&&_0x3ece94++;});if(_0x3ece94!=0x0)return _0x2174b5[_0x2c1728(0x207)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x10544e[_0x2c1728(0x230)](_0x2c1728(0x2e4));const _0x48bb14=await warehouse[_0x2c1728(0x211)]({'name':_0x3c6603[_0x2c1728(0x2af)],'room':_0x3c6603['from_room']});_0x3c6603[_0x2c1728(0x20f)][_0x2c1728(0x2b4)](_0x136750=>{var _0x4f0d72=_0x2c1728;if(_0x136750[_0x4f0d72(0x261)]>0x0){const _0x310c6f=_0x48bb14[_0x4f0d72(0x226)]['map'](_0x1fe7c3=>{var _0x43dcd8=_0x4f0d72;_0x1fe7c3['product_name']==_0x136750['product_name']&&_0x1fe7c3[_0x43dcd8(0x23b)]==_0x136750[_0x43dcd8(0x20a)]&&_0x1fe7c3[_0x43dcd8(0x259)]==_0x136750['from_types']&&_0x1fe7c3[_0x43dcd8(0x21d)]==_0x136750['from_bin']&&_0x1fe7c3[_0x43dcd8(0x1ed)]==_0x136750[_0x43dcd8(0x1f6)]&&_0x1fe7c3[_0x43dcd8(0x25b)]==_0x136750[_0x43dcd8(0x1f2)]&&_0x1fe7c3[_0x43dcd8(0x28f)]==_0x136750[_0x43dcd8(0x1ff)]&&(_0x1fe7c3[_0x43dcd8(0x2a5)]=parseInt(_0x1fe7c3[_0x43dcd8(0x2a5)])+parseInt(_0x136750[_0x43dcd8(0x261)]));});}}),await _0x48bb14[_0x2c1728(0x243)]();const _0x336bd9=await warehouse[_0x2c1728(0x211)]({'name':_0x3c6603[_0x2c1728(0x257)],'room':_0x3c6603[_0x2c1728(0x2e8)]});_0x3c6603[_0x2c1728(0x20f)][_0x2c1728(0x2b4)](_0x3db669=>{var _0x30ada8=_0x2c1728;if(_0x3db669[_0x30ada8(0x261)]>0x0){const _0x52f0f9=_0x336bd9['product_details'][_0x30ada8(0x244)](_0x129930=>{var _0x47183c=_0x30ada8;_0x129930['product_name']==_0x3db669[_0x47183c(0x2c1)]&&_0x129930['floorlevel']==_0x3db669[_0x47183c(0x2d8)]&&_0x129930[_0x47183c(0x259)]==_0x3db669[_0x47183c(0x21e)]&&_0x129930[_0x47183c(0x21d)]==_0x3db669[_0x47183c(0x219)]&&_0x129930[_0x47183c(0x1ed)]==_0x3db669['to_bay']&&_0x129930[_0x47183c(0x25b)]==_0x3db669[_0x47183c(0x25b)]&&_0x129930['storage']==_0x3db669[_0x47183c(0x28f)]&&(_0x129930['product_stock']=parseInt(_0x129930[_0x47183c(0x2a5)])-parseInt(_0x3db669[_0x47183c(0x261)]));});}}),await _0x336bd9[_0x2c1728(0x243)](),_0x3c6603['date']=_0x5cdd6a,_0x3c6603[_0x2c1728(0x2af)]=_0x48a9d0,_0x3c6603[_0x2c1728(0x257)]=_0x12161c,_0x3c6603[_0x2c1728(0x20f)]=_0x4ba141,_0x3c6603[_0x2c1728(0x2ce)]=_0x5529ce,_0x3c6603[_0x2c1728(0x25f)]=_0x161722;const _0x11b539=await _0x3c6603['save']();console[_0x2c1728(0x299)](_0x11b539);const _0x275033=await warehouse[_0x2c1728(0x211)]({'name':_0x48a9d0,'room':_0x562815});_0x11b539['product']['forEach'](_0x564fbe=>{var _0x2ec456=_0x2c1728;if(_0x564fbe[_0x2ec456(0x261)]>0x0){const _0x56ceb8=_0x275033[_0x2ec456(0x226)][_0x2ec456(0x244)](_0x24ffbf=>{var _0x26ec90=_0x2ec456;_0x24ffbf[_0x26ec90(0x2c1)]==_0x564fbe[_0x26ec90(0x2c1)]&&_0x24ffbf[_0x26ec90(0x23b)]==_0x564fbe[_0x26ec90(0x20a)]&&_0x24ffbf[_0x26ec90(0x259)]==_0x564fbe[_0x26ec90(0x228)]&&_0x24ffbf[_0x26ec90(0x21d)]==_0x564fbe['from_bin']&&_0x24ffbf[_0x26ec90(0x1ed)]==_0x564fbe[_0x26ec90(0x1f6)]&&_0x24ffbf['rack']==_0x564fbe[_0x26ec90(0x1f2)]&&_0x24ffbf[_0x26ec90(0x28f)]==_0x564fbe[_0x26ec90(0x1ff)]&&(_0x24ffbf[_0x26ec90(0x2a5)]=parseInt(_0x24ffbf[_0x26ec90(0x2a5)])-parseInt(_0x564fbe[_0x26ec90(0x261)]));});}}),await _0x275033[_0x2c1728(0x243)]();const _0x825052=await warehouse[_0x2c1728(0x211)]({'name':_0x12161c,'room':_0x2315a8});_0x11b539[_0x2c1728(0x20f)]['forEach'](_0x7f52b2=>{var _0x2481fb=_0x2c1728;if(_0x7f52b2[_0x2481fb(0x261)]>0x0){var _0x2c0df6=0x0;const _0x5b2755=_0x825052[_0x2481fb(0x226)][_0x2481fb(0x244)](_0x26f5af=>{var _0x1254ab=_0x2481fb;_0x26f5af['product_name']==_0x7f52b2[_0x1254ab(0x2c1)]&&_0x26f5af['floorlevel']==_0x7f52b2[_0x1254ab(0x2d8)]&&_0x26f5af['type']==_0x7f52b2[_0x1254ab(0x21e)]&&_0x26f5af[_0x1254ab(0x21d)]==_0x7f52b2[_0x1254ab(0x219)]&&_0x26f5af[_0x1254ab(0x1ed)]==_0x7f52b2[_0x1254ab(0x2c4)]&&_0x26f5af['rack']==_0x7f52b2[_0x1254ab(0x25b)]&&_0x26f5af[_0x1254ab(0x28f)]==_0x7f52b2[_0x1254ab(0x28f)]&&(_0x26f5af[_0x1254ab(0x2a5)]=parseInt(_0x26f5af[_0x1254ab(0x2a5)])+parseInt(_0x7f52b2[_0x1254ab(0x261)]),_0x2c0df6++);});_0x2c0df6=='0'&&(_0x825052[_0x2481fb(0x226)]=_0x825052['product_details'][_0x2481fb(0x2d3)]({'product_name':_0x7f52b2['product_name'],'product_stock':_0x7f52b2[_0x2481fb(0x261)],'bay':_0x7f52b2[_0x2481fb(0x2c4)],'bin':_0x7f52b2[_0x2481fb(0x219)],'type':_0x7f52b2[_0x2481fb(0x21e)],'floorlevel':_0x7f52b2[_0x2481fb(0x2d8)],'storage':_0x7f52b2[_0x2481fb(0x28f)],'rack':_0x7f52b2[_0x2481fb(0x25b)],'product_code':_0x7f52b2['product_code'],'primary_code':_0x7f52b2['primary_code'],'secondary_code':_0x7f52b2['secondary_code'],'maxProducts':_0x7f52b2[_0x2481fb(0x249)],'storage':_0x7f52b2[_0x2481fb(0x28f)],'rack':_0x7f52b2[_0x2481fb(0x25b)]}));}}),await _0x825052['save'](),_0x2174b5[_0x2c1728(0x207)](_0x2c1728(0x212),_0x2c1728(0x2a9)),_0x10544e[_0x2c1728(0x230)](_0x2c1728(0x1fb));}catch(_0x5d01a0){console[_0x2c1728(0x299)](_0x5d01a0);}}),router['post'](a0_0x30d976(0x289),async(_0x25eb32,_0x2ac253)=>{var _0x55c516=a0_0x30d976;const {FromWareHouse:_0x4ecec0,FromRoom:_0x145873,ToWarehouse:_0x2e7f3c,ToRoom:_0x3a17da,primary_code:_0x5b7171,Roomslist:_0x4813bb}=_0x25eb32[_0x55c516(0x298)],_0x39c139=_0x4813bb['split'](','),_0x1fb682=[];async function _0x38c851(_0x26410){var _0x224109=_0x55c516;const _0x5bedac=await warehouse[_0x224109(0x277)]([{'$match':{'name':_0x4ecec0,'room':_0x26410}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5b7171}},{'$group':{'_id':_0x224109(0x26f),'name':{'$first':_0x224109(0x253)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x224109(0x202)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x224109(0x2e5)},'level':{'$first':_0x224109(0x2c0)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x224109(0x1fa)},'pallet':{'$first':_0x224109(0x267)},'unit':{'$first':_0x224109(0x260)},'secondary_unit':{'$first':_0x224109(0x252)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x224109(0x1f4)},'expiry_date':{'$first':_0x224109(0x21c)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x224109(0x272)},'maxPerUnit':{'$first':_0x224109(0x1ee)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x224109(0x241)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x3ecaeb=await warehouse[_0x224109(0x277)]([{'$match':{'name':_0x4ecec0,'room':_0x26410}},{'$unwind':_0x224109(0x286)},{'$match':{'product_details.secondary_code':_0x5b7171}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x224109(0x253)},'instock':{'$first':_0x224109(0x2cb)},'primary_code':{'$first':_0x224109(0x202)},'secondary_code':{'$first':_0x224109(0x26d)},'product_code':{'$first':_0x224109(0x2e5)},'level':{'$first':_0x224109(0x2c0)},'isle':{'$first':_0x224109(0x1eb)},'type':{'$first':_0x224109(0x1fa)},'pallet':{'$first':_0x224109(0x267)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x224109(0x1f4)},'expiry_date':{'$first':_0x224109(0x21c)},'production_date':{'$first':_0x224109(0x2ad)},'batch_code':{'$first':_0x224109(0x272)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x224109(0x26a)},'invoice_product':{'$first':_0x224109(0x278)}}}]);if(_0x5bedac['length']>0x0)_0x1fb682[_0x224109(0x25c)](_0x5bedac);else _0x3ecaeb[_0x224109(0x22b)]>0x0&&_0x1fb682['push'](_0x3ecaeb);}const _0x3ecd35=_0x39c139[_0x55c516(0x244)](_0x1b6243=>_0x38c851(_0x1b6243));await Promise[_0x55c516(0x28c)](_0x3ecd35),_0x2ac253[_0x55c516(0x233)](_0x1fb682);}),router[a0_0x30d976(0x24f)](a0_0x30d976(0x208),async(_0x330eae,_0x2e41b4)=>{var _0x57ac0f=a0_0x30d976;try{const {FromWareHouse:_0x25cc3d,FromRoom:_0x5c36db,ToWarehouse:_0x287c84,ToRoom:_0x31be5e,secondary_code:_0x4a8ec0}=_0x330eae['body'],_0x58f925=await warehouse[_0x57ac0f(0x277)]([{'$match':{'name':_0x25cc3d}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4a8ec0}},{'$group':{'_id':_0x57ac0f(0x26f),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x57ac0f(0x26d)},'product_code':{'$first':_0x57ac0f(0x2e5)},'instock':{'$first':_0x57ac0f(0x2cb)},'warehouse':{'$first':_0x57ac0f(0x274)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x57ac0f(0x205)},'maxProducts':{'$first':_0x57ac0f(0x26a)},'unit':{'$first':'$product_details.unit'}}}]);_0x2e41b4[_0x57ac0f(0x290)](0xc8)[_0x57ac0f(0x233)](_0x58f925);}catch(_0x2fd825){_0x2e41b4[_0x57ac0f(0x290)](0x194)[_0x57ac0f(0x233)]({'message':_0x2fd825[_0x57ac0f(0x201)]});}}),router['post'](a0_0x30d976(0x2b7),async(_0x5133a5,_0x3c1d92)=>{var _0x140e42=a0_0x30d976;try{const {FromWareHouse:_0x2c731c,FromRoom:_0x42bd07,ToWarehouse:_0x46845d,ToRoom:_0x517d78,product_code:_0x2132be}=_0x5133a5[_0x140e42(0x298)],_0x5c09b6=await warehouse[_0x140e42(0x277)]([{'$match':{'name':_0x2c731c}},{'$unwind':_0x140e42(0x286)},{'$match':{'product_details.product_code':_0x2132be}},{'$group':{'_id':_0x140e42(0x26f),'name':{'$first':_0x140e42(0x253)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x140e42(0x26d)},'product_code':{'$first':_0x140e42(0x2e5)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x140e42(0x274)},'level':{'$first':_0x140e42(0x268)},'isle':{'$first':_0x140e42(0x20d)},'pallet':{'$first':_0x140e42(0x205)},'maxProducts':{'$first':_0x140e42(0x26a)},'unit':{'$first':_0x140e42(0x260)}}}]);_0x3c1d92['status'](0xc8)[_0x140e42(0x233)](_0x5c09b6);}catch(_0x5802bb){_0x3c1d92[_0x140e42(0x290)](0x194)[_0x140e42(0x233)]({'message':_0x5802bb['message']});}}),router[a0_0x30d976(0x24f)](a0_0x30d976(0x215),async(_0x29a1da,_0x3dc172)=>{var _0x2020ef=a0_0x30d976;const {level:_0x911614,isle:_0xdf3d10,pallet:_0x21cfc8,warehouses:_0x69b2df,room:_0x56aa1f}=_0x29a1da[_0x2020ef(0x298)];try{const _0x569aba=await warehouse[_0x2020ef(0x277)]([{'$match':{'name':_0x69b2df,'room':_0x56aa1f}},{'$unwind':_0x2020ef(0x286)},{'$match':{'product_details.level':parseInt(_0x911614),'product_details.isle':_0xdf3d10,'product_details.pallet':parseInt(_0x21cfc8)}},{'$group':{'_id':_0x2020ef(0x26f),'name':{'$first':_0x2020ef(0x253)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x2020ef(0x268)},'isle':{'$first':_0x2020ef(0x20d)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x2020ef(0x26a)}}}]);_0x3dc172[_0x2020ef(0x290)](0xc8)[_0x2020ef(0x233)](_0x569aba);}catch(_0x56d8e0){_0x3dc172['status'](0x194)[_0x2020ef(0x233)]({'message':_0x56d8e0[_0x2020ef(0x201)]});}}),module['exports']=router;