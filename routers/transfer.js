var a0_0x2d7a19=a0_0x1945;(function(_0x1e8366,_0x326dcf){var _0x1b71c7=a0_0x1945,_0x2e878f=_0x1e8366();while(!![]){try{var _0x9e6a13=-parseInt(_0x1b71c7(0xca))/0x1*(-parseInt(_0x1b71c7(0x17e))/0x2)+parseInt(_0x1b71c7(0x12c))/0x3+parseInt(_0x1b71c7(0xb8))/0x4*(-parseInt(_0x1b71c7(0xdc))/0x5)+-parseInt(_0x1b71c7(0x179))/0x6+parseInt(_0x1b71c7(0x10a))/0x7*(parseInt(_0x1b71c7(0x12d))/0x8)+-parseInt(_0x1b71c7(0xf5))/0x9*(parseInt(_0x1b71c7(0x195))/0xa)+parseInt(_0x1b71c7(0x152))/0xb;if(_0x9e6a13===_0x326dcf)break;else _0x2e878f['push'](_0x2e878f['shift']());}catch(_0x4acbf3){_0x2e878f['push'](_0x2e878f['shift']());}}}(a0_0xf43f,0x525e9));function a0_0xf43f(){var _0x1a1e85=['$product_details.secondary_code','max_per_unit','email','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Enclosed','rak','/barcode_scanner','redirect','prod_name','$product_details.secondary_unit','map','password','$product_details.maxProducts','from_invoice','181143qauWll','save','$date','getDate','<h5\x20style=\x22text-align:\x20left;\x22>','back','German','Logo.png','product_code','</tbody>','createTransport','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','master','get','<tr>','site_title','\x20</h2>','from_rack','</div>','from_prod_pallet','from_room_name','7DBVyLq','prod_cat','/CheckingWarehouse','to_bin','English','To_invoice','$product.to_room_name','$product_details.unit','/upload/','push','secondary_unit','$product_details._id','product','to_warehouse','findById','to_invoice','bin','\x20<>\x20','<h2>\x20','$product_details.maxPerUnit','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','to_prod_qty','$product_details.batch_code','Rack\x20B','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Transfer\x20Edit\x20Successfully','\x20Order\x20Date\x20:\x20','aggregate','$product_details','Return\x20Rooms','$product_details.floorlevel','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view/add_transfer','278823Uyiazk','865352wVzggg','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','here','/barcode_scanner3','$product_details.storage','RoomAssigned','<!DOCTYPE\x20html>','user','Hindi','/picking_list/PDF_transfer_rm/','to_prod_level','to_quantity','from_types','/transfer/view','$name','maxperunit','id_transaction_id','ToRoomAssigned','$product','string','True','$product_details.product_code','params','to_prod_pallet','getFullYear','render','_id','catch','to_prod_isle','transfer','from_storage','nodemailer','random','DRY\x20STORAGE','from_room','Rack\x20F','staff','4213924iWvvWn','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','\x20Order\x20Number\x20:\x20','<span\x20style=\x22float:\x20right;\x22>','edit_transfer_view','COLD\x20STORAGE','logo','$product_details.bay','to_room_name','to_floorlevel','forEach','from_bin','body','Arabic\x20(ae)','finalize','</table>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','from_bay','to_types','product_details','$product_details.product_name','from_rak','product_code3','Rack\x20A','express','Spanish','/view','</body></html>','Router','/transfer/preview/','../middleware/auth','Portuguese\x20(BR)','then','</h5>','exports','from_prod_isle','from_quantity','$finalize','1383540PMveFL','log','</thead>','<strong>\x20Regards\x20</strong>','primary_unit','82sAUjmQ','$product_details.invoice','to_bay','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','from_floorlevel','storage','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.expiry_date','Ambient','$to_warehouse','/preview/:id','from_warehouse','$product_details.product_stock','<table\x20style=\x22width:\x20100%\x20!important;\x22>','English\x20(US)','Transfer\x20Mail','Receiving\x20Area','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Chinese','Product\x20Transfer\x20successfully','Level','260dMoRrX','length','$product_details.isle','product_name','padStart','French','primary_code','$invoice','date','<html><head><title></title>','from_prod_qty','New_Qty_Converted','</td>','Transfer\x20Finalize\x20Successfully','slice','RMSEmail','Arabic','Enabled','id_transaction','language','secondary_code','error','Shelves','findOne','all','concat','message','Rack\x20E','$product_details.bin','warehouse','TRF-','Email\x20sent\x20successfully','Raw\x20Materials','63964qkDmSJ','from_prod_level','<tbody\x20style=\x22text-align:\x20center;\x22>','edit_transfer','$product_details.production_date','errors','post','getMonth','production_date','flash','<div>','role','MaxStocks_data2','type','product_stock','</tr>','$product_details.type','find','14318ldxEBG','status','$product_details.rack','to_room','floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','floorlevel','Error\x20Occurs','maxProducts','Floor','$product_details.level','rack','note','$product.from_room_name','$room','port','bay','expiry_date','25OMZVVJ','filter','<hr\x20class=\x22my-3\x22>','$product_details.primary_code','unit','json','invoice','$isAllowEdit','$product_details.pallet','</span>'];a0_0xf43f=function(){return _0x1a1e85;};return a0_0xf43f();}const express=require(a0_0x2d7a19(0x16b)),app=express(),router=express[a0_0x2d7a19(0x16f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x2d7a19(0x171)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x2d7a19(0x14c));function a0_0x1945(_0x55ef62,_0x5f49ad){var _0xf43f64=a0_0xf43f();return a0_0x1945=function(_0x19455c,_0x551a71){_0x19455c=_0x19455c-0xb7;var _0x32ce6b=_0xf43f64[_0x19455c];return _0x32ce6b;},a0_0x1945(_0x55ef62,_0x5f49ad);}router[a0_0x2d7a19(0x102)](a0_0x2d7a19(0x16d),auth,async(_0x5edbb6,_0x1b3730)=>{var _0x33b3ee=a0_0x2d7a19;try{const {username:_0xbb9c6f,email:_0x32e7a2,role:_0x437543}=_0x5edbb6['user'],_0x4c6d6b=_0x5edbb6['user'],_0x3d5bc7=await profile[_0x33b3ee(0x1ac)]({'email':_0x4c6d6b[_0x33b3ee(0xe8)]}),_0x196b04=await master_shop['find']();console[_0x33b3ee(0x17a)](_0x33b3ee(0x101),_0x196b04);let _0x48fd63;if(_0x4c6d6b[_0x33b3ee(0xc3)]==_0x33b3ee(0x151)){const _0x5d0c21=await staff[_0x33b3ee(0x1ac)]({'email':_0x4c6d6b['email']});_0x48fd63=await transfers[_0x33b3ee(0xc9)]({'from_warehouse':_0x5d0c21[_0x33b3ee(0x1b2)]});}else _0x48fd63=await transfers['aggregate']([{'$unwind':_0x33b3ee(0x13f)},{'$group':{'_id':'$_id','invoice':{'$first':_0x33b3ee(0x19c)},'date':{'$first':_0x33b3ee(0xf7)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x33b3ee(0x188)},'from_room_name':{'$addToSet':_0x33b3ee(0xd7)},'to_room_name':{'$addToSet':_0x33b3ee(0x110)},'finalize':{'$first':_0x33b3ee(0x178)},'isAllowEdit':{'$first':_0x33b3ee(0xe3)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x196b04[0x0]['language']==_0x33b3ee(0x18d)){var _0x1a78cd=users[_0x33b3ee(0x10e)];console['log'](_0x1a78cd);}else{if(_0x196b04[0x0][_0x33b3ee(0x1a8)]=='Hindi')var _0x1a78cd=users[_0x33b3ee(0x135)];else{if(_0x196b04[0x0][_0x33b3ee(0x1a8)]==_0x33b3ee(0xfb))var _0x1a78cd=users['German'];else{if(_0x196b04[0x0]['language']==_0x33b3ee(0x16c))var _0x1a78cd=users['Spanish'];else{if(_0x196b04[0x0]['language']==_0x33b3ee(0x19a))var _0x1a78cd=users[_0x33b3ee(0x19a)];else{if(_0x196b04[0x0]['language']==_0x33b3ee(0x172))var _0x1a78cd=users['Portuguese'];else{if(_0x196b04[0x0][_0x33b3ee(0x1a8)]==_0x33b3ee(0x192))var _0x1a78cd=users[_0x33b3ee(0x192)];else{if(_0x196b04[0x0][_0x33b3ee(0x1a8)]=='Arabic\x20(ae)')var _0x1a78cd=users['Arabic'];}}}}}}}_0x1b3730[_0x33b3ee(0x146)](_0x33b3ee(0x14a),{'success':_0x5edbb6[_0x33b3ee(0xc1)](_0x33b3ee(0x153)),'errors':_0x5edbb6[_0x33b3ee(0xc1)](_0x33b3ee(0xbd)),'role':_0x4c6d6b,'profile':_0x3d5bc7,'master_shop':_0x196b04,'transfer':_0x48fd63,'language':_0x1a78cd});}catch(_0x372bbc){console['log'](_0x372bbc);}});async function getRandom8DigitNumber(){var _0x36a086=a0_0x2d7a19;const _0x2d7656=0x989680,_0x3622e5=0x5f5e0ff,_0x4ed7f5=Math[_0x36a086(0xce)](Math[_0x36a086(0x14d)]()*(_0x3622e5-_0x2d7656+0x1))+_0x2d7656;var _0x4c8f6a;const _0x240967=await transfers[_0x36a086(0x1ac)]({'invoice':'TRF-'+_0x4ed7f5});return _0x240967&&_0x240967['length']>0x0?_0x4c8f6a=_0x36a086(0x1b3)+_0x4ed7f5:_0x4c8f6a='TRF-'+_0x4ed7f5,_0x4c8f6a;}router[a0_0x2d7a19(0x102)](a0_0x2d7a19(0x12b),auth,async(_0x3ac9ec,_0x372aee)=>{var _0x5a2f40=a0_0x2d7a19;try{const {username:_0x3b3bd6,email:_0x35213c,role:_0x446461}=_0x3ac9ec[_0x5a2f40(0x134)],_0x310724=_0x3ac9ec['user'],_0x1ece90=await profile[_0x5a2f40(0x1ac)]({'email':_0x310724[_0x5a2f40(0xe8)]}),_0x266b11=await master_shop[_0x5a2f40(0xc9)]();console[_0x5a2f40(0x17a)](_0x5a2f40(0x101),_0x266b11);let _0x26b5a9;if(_0x310724[_0x5a2f40(0xc3)]==_0x5a2f40(0x151)){const _0x3e6204=await staff['findOne']({'email':_0x310724[_0x5a2f40(0xe8)]});_0x26b5a9=await warehouse[_0x5a2f40(0x125)]([{'$match':{'status':_0x5a2f40(0x1a6),'name':_0x3e6204[_0x5a2f40(0x1b2)],'warehouse_category':_0x5a2f40(0xb7)}},{'$group':{'_id':_0x5a2f40(0x13b),'name':{'$first':'$name'}}}]);}else _0x26b5a9=await warehouse[_0x5a2f40(0x125)]([{'$match':{'status':_0x5a2f40(0x1a6),'warehouse_category':_0x5a2f40(0xb7)}},{'$group':{'_id':_0x5a2f40(0x13b),'name':{'$first':_0x5a2f40(0x13b)}}}]);var _0x4ae18d=[_0x5a2f40(0x187),_0x5a2f40(0xeb),_0x5a2f40(0x127)];const _0x2d3076=await transfers[_0x5a2f40(0xc9)]({}),_0x2f5031=_0x2d3076[_0x5a2f40(0x196)]+0x1,_0xf414ed=_0x5a2f40(0x1b3)+_0x2f5031['toString']()[_0x5a2f40(0x199)](0x5,'0');if(_0x266b11[0x0][_0x5a2f40(0x1a8)]=='English\x20(US)'){var _0x547a22=users[_0x5a2f40(0x10e)];console[_0x5a2f40(0x17a)](_0x547a22);}else{if(_0x266b11[0x0][_0x5a2f40(0x1a8)]==_0x5a2f40(0x135))var _0x547a22=users['Hindi'];else{if(_0x266b11[0x0][_0x5a2f40(0x1a8)]==_0x5a2f40(0xfb))var _0x547a22=users[_0x5a2f40(0xfb)];else{if(_0x266b11[0x0][_0x5a2f40(0x1a8)]=='Spanish')var _0x547a22=users['Spanish'];else{if(_0x266b11[0x0][_0x5a2f40(0x1a8)]==_0x5a2f40(0x19a))var _0x547a22=users[_0x5a2f40(0x19a)];else{if(_0x266b11[0x0][_0x5a2f40(0x1a8)]==_0x5a2f40(0x172))var _0x547a22=users[_0x5a2f40(0x190)];else{if(_0x266b11[0x0]['language']=='Chinese')var _0x547a22=users[_0x5a2f40(0x192)];else{if(_0x266b11[0x0][_0x5a2f40(0x1a8)]=='Arabic\x20(ae)')var _0x547a22=users[_0x5a2f40(0x1a5)];}}}}}}}const _0x487109=getRandom8DigitNumber();_0x487109[_0x5a2f40(0x173)](_0x5aa750=>{var _0x48fb5a=_0x5a2f40;_0x372aee[_0x48fb5a(0x146)]('add_transfer',{'success':_0x3ac9ec[_0x48fb5a(0xc1)](_0x48fb5a(0x153)),'errors':_0x3ac9ec[_0x48fb5a(0xc1)]('errors'),'role':_0x310724,'profile':_0x1ece90,'master_shop':_0x266b11,'warehouse':_0x26b5a9,'language':_0x547a22,'rooms_data':_0x4ae18d,'invoice':_0x5aa750});})[_0x5a2f40(0x148)](_0x327edc=>{var _0x599a0f=_0x5a2f40;_0x3ac9ec[_0x599a0f(0xc1)](_0x599a0f(0xbd),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x372aee['redirect']('/transfer/view');});}catch(_0x284cb2){console[_0x5a2f40(0x17a)](_0x284cb2);}}),router['post']('/view/add_transfer',auth,async(_0x54d15c,_0x3fe59d)=>{var _0x27c04a=a0_0x2d7a19;try{console[_0x27c04a(0x17a)](_0x54d15c[_0x27c04a(0x15f)]);const {date:_0x359134,from_warehouse:_0x448ad8,FromRoom_name:_0xad9f8b,to_warehouse:_0x4e2924,ToRoom_name:_0x3adba4,prod_name:_0x384b5e,from_prod_qty:_0x2ba999,from_prod_level:_0x745e4a,from_prod_isle:_0x2bbafb,from_prod_pallet:_0x5b4822,to_prod_qty:_0x20e48f,to_prod_level:_0x3c7e7e,to_prod_isle:_0x50aeee,to_prod_pallet:_0x189562,primary_code:_0x35246c,secondary_code:_0x1491d5,product_code3:_0x5a0098,note:_0x32587e,MaxStocks_data2:_0xe526c2,invoice:_0x34e8d5,expiry_date:_0x4a589d}=_0x54d15c[_0x27c04a(0x15f)];if(typeof _0x384b5e==_0x27c04a(0x140))var _0xb6ef29=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xef)]],_0x5e1025=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x19f)]],_0x33eece=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xb9)]],_0x365f79=[_0x54d15c['body'][_0x27c04a(0x1a0)]],_0x2f784f=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x137)]],_0x5c3cbc=[_0x54d15c[_0x27c04a(0x15f)]['primary_code']],_0x21293c=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x1a9)]],_0x415f3e=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x169)]],_0x2c7112=[_0x54d15c['body'][_0x27c04a(0xc4)]],_0x50ad39=[_0x54d15c['body'][_0x27c04a(0x17d)]],_0x9853bb=[_0x54d15c['body'][_0x27c04a(0x114)]],_0x2364ed=[_0x54d15c['body']['batch_code']],_0x4b5748=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xdb)]],_0x30106f=[_0x54d15c['body']['max_per_unit']],_0xed5e09=[_0x54d15c[_0x27c04a(0x15f)]['production_date']],_0x3395fa=[_0x54d15c[_0x27c04a(0x15f)]['prod_cat']],_0x5aecd1=[_0x54d15c['body'][_0x27c04a(0x132)]],_0x3197d9=[_0x54d15c['body'][_0x27c04a(0x13e)]],_0x32969f=[_0x54d15c[_0x27c04a(0x15f)]['from_invoice']],_0x290618=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x119)]],_0x3b948a=[_0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x1a7)]];else var _0xb6ef29=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xef)]],_0x5e1025=[..._0x54d15c[_0x27c04a(0x15f)]['from_prod_qty']],_0x33eece=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xb9)]],_0x365f79=[..._0x54d15c['body'][_0x27c04a(0x1a0)]],_0x2f784f=[..._0x54d15c['body']['to_prod_level']],_0x5c3cbc=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x19b)]],_0x21293c=[..._0x54d15c[_0x27c04a(0x15f)]['secondary_code']],_0x415f3e=[..._0x54d15c[_0x27c04a(0x15f)]['product_code3']],_0x2c7112=[..._0x54d15c[_0x27c04a(0x15f)]['MaxStocks_data2']],_0x50ad39=[..._0x54d15c[_0x27c04a(0x15f)]['primary_unit']],_0x9853bb=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x114)]],_0x2364ed=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xe9)]],_0x4b5748=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xdb)]],_0x30106f=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xe7)]],_0xed5e09=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0xc0)]],_0x3395fa=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x10b)]],_0x5aecd1=[..._0x54d15c[_0x27c04a(0x15f)][_0x27c04a(0x132)]],_0x3197d9=[..._0x54d15c['body'][_0x27c04a(0x13e)]],_0x32969f=[..._0x54d15c['body'][_0x27c04a(0xf4)]],_0x290618=[..._0x54d15c['body'][_0x27c04a(0x119)]],_0x3b948a=[..._0x54d15c['body'][_0x27c04a(0x1a7)]];const _0x37e988=_0xb6ef29['map'](_0x1054db=>{return _0x1054db={'product_name':_0x1054db};});_0x5e1025[_0x27c04a(0x15d)]((_0x2b91ff,_0x583dd6)=>{var _0x5e64f9=_0x27c04a;_0x37e988[_0x583dd6][_0x5e64f9(0x177)]=_0x2b91ff;}),_0x32969f['forEach']((_0x298cb2,_0x1df3b7)=>{_0x37e988[_0x1df3b7]['from_invoice']=_0x298cb2;}),_0x290618[_0x27c04a(0x15d)]((_0x10595f,_0x9764b9)=>{var _0x3b5872=_0x27c04a;_0x37e988[_0x9764b9][_0x3b5872(0x10f)]=_0x10595f;}),_0x3b948a[_0x27c04a(0x15d)]((_0x4b88ed,_0x27d710)=>{_0x37e988[_0x27d710]['id_transaction_id']=_0x4b88ed;}),_0x33eece['forEach']((_0x161247,_0x35b1f5)=>{var _0x550b6c=_0x27c04a;_0x5aecd1[_0x550b6c(0x15d)]((_0x50284a,_0x1b2062)=>{var _0xda93b2=_0x550b6c;if(_0x50284a==_0xda93b2(0x18f)&&_0x35b1f5==_0x1b2062){var _0x2a9921=_0x161247[_0xda93b2(0x1a3)](0x3);_0x37e988[_0x35b1f5][_0xda93b2(0x14b)]=_0x161247[0x0],_0x37e988[_0x35b1f5][_0xda93b2(0x106)]=_0x161247[0x1],_0x37e988[_0x35b1f5][_0xda93b2(0x164)]=0x0,_0x37e988[_0x35b1f5][_0xda93b2(0x15e)]=0x0,_0x37e988[_0x35b1f5]['from_types']=_0xda93b2(0xd3),_0x37e988[_0x35b1f5]['from_floorlevel']=_0x2a9921;}else{if(_0x50284a=='Shelves'&&_0x35b1f5==_0x1b2062){var _0x2a9921=_0x161247[_0xda93b2(0x1a3)](0x3);_0x37e988[_0x35b1f5][_0xda93b2(0x14b)]=_0x161247[0x0],_0x37e988[_0x35b1f5][_0xda93b2(0x106)]=_0x161247[0x1],_0x37e988[_0x35b1f5][_0xda93b2(0x164)]=0x0,_0x37e988[_0x35b1f5][_0xda93b2(0x15e)]=0x0,_0x37e988[_0x35b1f5]['from_types']=_0xda93b2(0xd3),_0x37e988[_0x35b1f5][_0xda93b2(0x183)]=_0x161247[0x5];}else{if(_0x35b1f5==_0x1b2062){if(_0x161247[0x0]=='A'&&_0x161247[0x1]=='L'&&_0x161247[0x2]=='L')console[_0xda93b2(0x17a)](_0x50284a+_0xda93b2(0x11b)+_0x35b1f5+_0xda93b2(0x11b)+_0x1b2062+_0xda93b2(0x11b)+_0x161247+_0xda93b2(0x12f)),_0x37e988[_0x35b1f5][_0xda93b2(0x14b)]=_0x161247[0x0],_0x37e988[_0x35b1f5][_0xda93b2(0x106)]=_0x161247[0x1],_0x37e988[_0x35b1f5]['from_bay']=0x0,_0x37e988[_0x35b1f5]['from_bin']=0x0,_0x37e988[_0x35b1f5][_0xda93b2(0x139)]=_0xda93b2(0xd3),_0x37e988[_0x35b1f5][_0xda93b2(0x183)]=_0x161247[0x3];else{var _0x296ffd;if(_0x161247[0x4]=='L')_0x296ffd=_0xda93b2(0x194);else _0x161247[0x4]=='F'&&(_0x296ffd=_0xda93b2(0xd3));_0x37e988[_0x35b1f5][_0xda93b2(0x14b)]=_0x161247[0x0],_0x37e988[_0x35b1f5][_0xda93b2(0x106)]=_0x161247[0x1],_0x37e988[_0x35b1f5]['from_bay']=_0x161247[0x2],_0x37e988[_0x35b1f5][_0xda93b2(0x15e)]=_0x161247[0x3],_0x37e988[_0x35b1f5][_0xda93b2(0x139)]=_0x296ffd,_0x37e988[_0x35b1f5][_0xda93b2(0x183)]=_0x161247[0x5];}}}}});}),_0x365f79[_0x27c04a(0x15d)]((_0x191bae,_0x1e4c1)=>{var _0x4dffde=_0x27c04a;_0x37e988[_0x1e4c1][_0x4dffde(0x138)]=_0x191bae;}),_0x2f784f['forEach']((_0x1c434a,_0x4805db)=>{var _0x5e1c6d=_0x27c04a;_0x3197d9[_0x5e1c6d(0x15d)]((_0x27b74e,_0x20b638)=>{var _0x1d17c6=_0x5e1c6d;if(_0x27b74e==_0x1d17c6(0x18f)&&_0x4805db==_0x20b638){var _0x505d5c=_0x1c434a['slice'](0x3);_0x37e988[_0x4805db][_0x1d17c6(0x184)]=_0x1c434a[0x0],_0x37e988[_0x4805db][_0x1d17c6(0xd5)]=_0x1c434a[0x1],_0x37e988[_0x4805db]['to_bay']=0x0,_0x37e988[_0x4805db][_0x1d17c6(0x10d)]=0x0,_0x37e988[_0x4805db][_0x1d17c6(0x165)]='Floor',_0x37e988[_0x4805db][_0x1d17c6(0x15c)]=_0x505d5c;}else{if(_0x27b74e==_0x1d17c6(0x1ab)&&_0x4805db==_0x20b638){var _0x505d5c=_0x1c434a['slice'](0x3);_0x37e988[_0x4805db][_0x1d17c6(0x184)]=_0x1c434a[0x0],_0x37e988[_0x4805db][_0x1d17c6(0xd5)]=_0x1c434a[0x1],_0x37e988[_0x4805db][_0x1d17c6(0x180)]=0x0,_0x37e988[_0x4805db][_0x1d17c6(0x10d)]=0x0,_0x37e988[_0x4805db][_0x1d17c6(0x165)]=_0x1d17c6(0xd3),_0x37e988[_0x4805db][_0x1d17c6(0x15c)]=_0x1c434a[0x5];}else{if(_0x4805db==_0x20b638){if(_0x1c434a[0x0]=='A'&&_0x1c434a[0x1]=='L'&&_0x1c434a[0x2]=='L')console[_0x1d17c6(0x17a)](_0x27b74e+_0x1d17c6(0x11b)+_0x4805db+'\x20<>\x20'+_0x20b638+_0x1d17c6(0x11b)+_0x1c434a+_0x1d17c6(0x12f)),_0x37e988[_0x4805db][_0x1d17c6(0x184)]=_0x1c434a[0x0],_0x37e988[_0x4805db]['rack']=_0x1c434a[0x1],_0x37e988[_0x4805db]['to_bay']=0x0,_0x37e988[_0x4805db][_0x1d17c6(0x10d)]=0x0,_0x37e988[_0x4805db]['to_types']='Floor',_0x37e988[_0x4805db][_0x1d17c6(0x15c)]=_0x1c434a[0x3];else{var _0x3b253a;if(_0x1c434a[0x4]=='L')_0x3b253a='Level';else _0x1c434a[0x4]=='F'&&(_0x3b253a=_0x1d17c6(0xd3));_0x37e988[_0x4805db][_0x1d17c6(0x184)]=_0x1c434a[0x0],_0x37e988[_0x4805db]['rack']=_0x1c434a[0x1],_0x37e988[_0x4805db][_0x1d17c6(0x180)]=_0x1c434a[0x2],_0x37e988[_0x4805db][_0x1d17c6(0x10d)]=_0x1c434a[0x3],_0x37e988[_0x4805db][_0x1d17c6(0x165)]=_0x3b253a,_0x37e988[_0x4805db][_0x1d17c6(0x15c)]=_0x1c434a[0x5];}}}}});}),_0x5c3cbc[_0x27c04a(0x15d)]((_0x233913,_0x5a9bd8)=>{var _0x181565=_0x27c04a;_0x37e988[_0x5a9bd8][_0x181565(0x19b)]=_0x233913;}),_0x21293c[_0x27c04a(0x15d)]((_0x44625f,_0x366593)=>{var _0x21de9a=_0x27c04a;_0x37e988[_0x366593][_0x21de9a(0x1a9)]=_0x44625f;}),_0x415f3e[_0x27c04a(0x15d)]((_0x3b3107,_0x14857b)=>{var _0x727020=_0x27c04a;_0x37e988[_0x14857b][_0x727020(0xfd)]=_0x3b3107;}),_0x2c7112['forEach']((_0x5d0a7e,_0x282136)=>{var _0x33f14a=_0x27c04a;_0x37e988[_0x282136][_0x33f14a(0xd2)]=_0x5d0a7e;}),_0x50ad39[_0x27c04a(0x15d)]((_0x226fc3,_0x209137)=>{var _0xe3f043=_0x27c04a;_0x37e988[_0x209137][_0xe3f043(0xe0)]=_0x226fc3;}),_0x9853bb[_0x27c04a(0x15d)]((_0x2d45c1,_0x1fe870)=>{_0x37e988[_0x1fe870]['secondary_unit']=_0x2d45c1;}),_0x2364ed[_0x27c04a(0x15d)]((_0x5adfd3,_0x5bb979)=>{_0x37e988[_0x5bb979]['batch_code']=_0x5adfd3;}),_0x4b5748[_0x27c04a(0x15d)]((_0x4de0f4,_0x1bca62)=>{var _0x3c68ee=_0x27c04a;_0x37e988[_0x1bca62][_0x3c68ee(0xdb)]=_0x4de0f4;}),_0x30106f[_0x27c04a(0x15d)]((_0x40819d,_0x594e67)=>{var _0x25dee2=_0x27c04a;_0x37e988[_0x594e67][_0x25dee2(0x13c)]=_0x40819d;}),_0xed5e09[_0x27c04a(0x15d)]((_0x5e3f64,_0x508e5e)=>{var _0x3dbc56=_0x27c04a;_0x37e988[_0x508e5e][_0x3dbc56(0xc0)]=_0x5e3f64;}),_0x3395fa[_0x27c04a(0x15d)]((_0x35c791,_0x154b4c)=>{var _0x3533b7=_0x27c04a;_0x37e988[_0x154b4c][_0x3533b7(0x10b)]=_0x35c791;}),_0x5aecd1[_0x27c04a(0x15d)]((_0x3576f5,_0x1912cd)=>{var _0x132f35=_0x27c04a;_0x37e988[_0x1912cd][_0x132f35(0x109)]=_0x3576f5;}),_0x3197d9[_0x27c04a(0x15d)]((_0x171a59,_0x27fd92)=>{var _0x313c08=_0x27c04a;_0x37e988[_0x27fd92][_0x313c08(0x15b)]=_0x171a59;});const _0x273fc1=_0x37e988[_0x27c04a(0xdd)](_0x4996c8=>_0x4996c8[_0x27c04a(0x138)]!=='0'&&_0x4996c8[_0x27c04a(0x138)]!==''||_0x4996c8[_0x27c04a(0x15c)]!=='0'&&_0x4996c8[_0x27c04a(0x15c)]!==''),_0x31e55f=new transfers({'date':_0x359134,'from_warehouse':_0x448ad8,'to_warehouse':_0x4e2924,'product':_0x273fc1,'note':_0x32587e,'invoice':_0x34e8d5}),_0xffb437=await _0x31e55f[_0x27c04a(0xf6)]();_0x54d15c[_0x27c04a(0xc1)](_0x27c04a(0x153),_0x27c04a(0x193)),_0x3fe59d['redirect'](_0x27c04a(0x170)+_0xffb437[_0x27c04a(0x147)]);}catch(_0xee2457){console[_0x27c04a(0x17a)](_0xee2457),_0x3fe59d[_0x27c04a(0xcb)](0xc8)[_0x27c04a(0xe1)]({'errorMessage':_0xee2457[_0x27c04a(0x1af)]});}}),router[a0_0x2d7a19(0x102)](a0_0x2d7a19(0x189),auth,async(_0x23d81c,_0x24be7d)=>{var _0x1bb64a=a0_0x2d7a19;try{const {username:_0x45e5b7,email:_0x42b73e,role:_0x2b83d9}=_0x23d81c['user'],_0x4817f1=_0x23d81c[_0x1bb64a(0x134)],_0x466a21=await profile[_0x1bb64a(0x1ac)]({'email':_0x4817f1['email']}),_0x322746=await master_shop[_0x1bb64a(0xc9)]();console[_0x1bb64a(0x17a)](_0x1bb64a(0x101),_0x322746);const _0x582776=await transfers[_0x1bb64a(0x118)](_0x23d81c[_0x1bb64a(0x143)]['id']);let _0x321f96=new Date(_0x582776[_0x1bb64a(0xdb)]),_0x4506e5=('0'+_0x321f96[_0x1bb64a(0xf8)]())[_0x1bb64a(0x1a3)](-0x2),_0x50f9b5=('0'+(_0x321f96[_0x1bb64a(0xbf)]()+0x1))[_0x1bb64a(0x1a3)](-0x2),_0x547c87=_0x321f96[_0x1bb64a(0x145)](),_0x23f014=_0x547c87+'-'+_0x50f9b5+'-'+_0x4506e5,_0x1a127b;if(_0x4817f1[_0x1bb64a(0xc3)]=='staff'){const _0x443674=await staff[_0x1bb64a(0x1ac)]({'email':_0x4817f1[_0x1bb64a(0xe8)]});_0x1a127b=await warehouse[_0x1bb64a(0xc9)]({'status':'Enabled','name':_0x443674[_0x1bb64a(0x1b2)],'warehouse_category':_0x1bb64a(0xb7)});}else _0x1a127b=await warehouse[_0x1bb64a(0xc9)]({'status':'Enabled','warehouse_category':_0x1bb64a(0xb7)});const _0x191ae7=await warehouse[_0x1bb64a(0x125)]([{'$match':{'name':_0x582776[_0x1bb64a(0x18a)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1bb64a(0x115),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1bb64a(0x18b)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1bb64a(0x1b1)},'type':{'$first':_0x1bb64a(0xc8)},'floorlevel':{'$first':_0x1bb64a(0x128)},'primary_code':{'$first':_0x1bb64a(0xdf)},'secondary_code':{'$first':_0x1bb64a(0xe6)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1bb64a(0x131)},'rack':{'$first':_0x1bb64a(0xcc)},'expiry_date':{'$first':_0x1bb64a(0x186)},'production_date':{'$first':_0x1bb64a(0xbc)},'room':{'$first':_0x1bb64a(0xd8)}}}]);if(_0x322746[0x0]['language']==_0x1bb64a(0x18d)){var _0x12fe31=users['English'];console['log'](_0x12fe31);}else{if(_0x322746[0x0][_0x1bb64a(0x1a8)]==_0x1bb64a(0x135))var _0x12fe31=users[_0x1bb64a(0x135)];else{if(_0x322746[0x0][_0x1bb64a(0x1a8)]=='German')var _0x12fe31=users[_0x1bb64a(0xfb)];else{if(_0x322746[0x0]['language']==_0x1bb64a(0x16c))var _0x12fe31=users[_0x1bb64a(0x16c)];else{if(_0x322746[0x0][_0x1bb64a(0x1a8)]==_0x1bb64a(0x19a))var _0x12fe31=users[_0x1bb64a(0x19a)];else{if(_0x322746[0x0][_0x1bb64a(0x1a8)]==_0x1bb64a(0x172))var _0x12fe31=users[_0x1bb64a(0x190)];else{if(_0x322746[0x0]['language']=='Chinese')var _0x12fe31=users[_0x1bb64a(0x192)];else{if(_0x322746[0x0][_0x1bb64a(0x1a8)]==_0x1bb64a(0x160))var _0x12fe31=users[_0x1bb64a(0x1a5)];}}}}}}}_0x24be7d[_0x1bb64a(0x146)](_0x1bb64a(0x157),{'success':_0x23d81c[_0x1bb64a(0xc1)](_0x1bb64a(0x153)),'errors':_0x23d81c[_0x1bb64a(0xc1)](_0x1bb64a(0xbd)),'role':_0x4817f1,'profile':_0x466a21,'master_shop':_0x322746,'warehouse':_0x1a127b,'transfer':_0x582776,'stock':_0x191ae7,'language':_0x12fe31});}catch(_0x1a980e){console[_0x1bb64a(0x17a)](_0x1a980e);}}),router['post']('/preview/:id',auth,async(_0x3242c4,_0x2963fb)=>{var _0x19d5f4=a0_0x2d7a19;try{const _0x54eda=_0x3242c4[_0x19d5f4(0x143)]['id'],{from_warehouse:_0x1107b5,FromRoom_name:_0x37c9dc,to_warehouse:_0x503e97,ToRoom_name:_0x553e8a}=_0x3242c4[_0x19d5f4(0x15f)],_0x14e606=await transfers['findById']({'_id':_0x54eda}),_0x106c4f=_0x14e606[_0x19d5f4(0x116)][_0x19d5f4(0xf1)](async _0x3caba8=>{var _0x7837cf=_0x19d5f4;if(_0x3caba8[_0x7837cf(0x138)]>0x0){var _0x5a5ae4=await warehouse[_0x7837cf(0x1ac)]({'name':_0x14e606[_0x7837cf(0x18a)],'room':_0x3caba8[_0x7837cf(0x109)],'warehouse_category':_0x7837cf(0xb7)});const _0x2094e4=_0x5a5ae4[_0x7837cf(0x166)][_0x7837cf(0xf1)](_0x58b819=>{var _0x1569e4=_0x7837cf;_0x58b819[_0x1569e4(0x198)]==_0x3caba8[_0x1569e4(0x198)]&&_0x58b819[_0x1569e4(0xd0)]==_0x3caba8['from_floorlevel']&&_0x58b819[_0x1569e4(0xc5)]==_0x3caba8['from_types']&&_0x58b819[_0x1569e4(0x11a)]==_0x3caba8[_0x1569e4(0x15e)]&&_0x58b819['bay']==_0x3caba8[_0x1569e4(0x164)]&&_0x58b819[_0x1569e4(0xd5)]==_0x3caba8[_0x1569e4(0x106)]&&_0x58b819[_0x1569e4(0x184)]==_0x3caba8['from_storage']&&_0x58b819['expiry_date']==_0x3caba8[_0x1569e4(0xdb)]&&_0x58b819[_0x1569e4(0xe9)]==_0x3caba8[_0x1569e4(0xe9)]&&_0x58b819[_0x1569e4(0xc0)]==_0x3caba8['production_date']&&_0x58b819['invoice']==_0x3caba8[_0x1569e4(0xf4)]&&_0x58b819[_0x1569e4(0x147)]==_0x3caba8[_0x1569e4(0x13d)]&&(_0x58b819['product_stock']=_0x58b819['product_stock']-_0x3caba8['to_quantity']);});}return _0x5a5ae4;});Promise[_0x19d5f4(0x1ad)](_0x106c4f)['then'](async _0x572e07=>{var _0x58d1e4=_0x19d5f4;try{for(const _0x11691d of _0x572e07){await _0x11691d['save']();}try{const _0xc4e600=_0x14e606[_0x58d1e4(0x116)][_0x58d1e4(0xf1)](async _0x5ab293=>{var _0x24581e=_0x58d1e4;if(_0x5ab293[_0x24581e(0x138)]>0x0){var _0x82fca6=await warehouse[_0x24581e(0x1ac)]({'name':_0x14e606[_0x24581e(0x117)],'room':_0x5ab293[_0x24581e(0x15b)],'warehouse_category':'Raw\x20Materials'}),_0x2c67ed=0x0;const _0x30bed9=_0x82fca6[_0x24581e(0x166)][_0x24581e(0xf1)](_0x2bd878=>{var _0x11a597=_0x24581e;_0x2bd878[_0x11a597(0x198)]==_0x5ab293[_0x11a597(0x198)]&&_0x2bd878['floorlevel']==_0x5ab293['to_floorlevel']&&_0x2bd878[_0x11a597(0xc5)]==_0x5ab293['to_types']&&_0x2bd878[_0x11a597(0x11a)]==_0x5ab293[_0x11a597(0x10d)]&&_0x2bd878['bay']==_0x5ab293[_0x11a597(0x180)]&&_0x2bd878[_0x11a597(0xd5)]==_0x5ab293[_0x11a597(0xd5)]&&_0x2bd878['storage']==_0x5ab293['storage']&&_0x2bd878[_0x11a597(0xdb)]==_0x5ab293[_0x11a597(0xdb)]&&_0x2bd878[_0x11a597(0xe9)]==_0x5ab293[_0x11a597(0xe9)]&&_0x2bd878[_0x11a597(0xc0)]==_0x5ab293[_0x11a597(0xc0)]&&_0x2bd878['invoice']==_0x5ab293[_0x11a597(0x10f)]&&(_0x2bd878[_0x11a597(0xc6)]=_0x2bd878[_0x11a597(0xc6)]+_0x5ab293[_0x11a597(0x138)],_0x2c67ed++);});_0x2c67ed=='0'&&(_0x82fca6[_0x24581e(0x166)]=_0x82fca6[_0x24581e(0x166)][_0x24581e(0x1ae)]({'product_name':_0x5ab293[_0x24581e(0x198)],'product_stock':_0x5ab293[_0x24581e(0x138)],'bay':_0x5ab293['to_bay'],'bin':_0x5ab293[_0x24581e(0x10d)],'type':_0x5ab293[_0x24581e(0x165)],'floorlevel':_0x5ab293[_0x24581e(0x15c)],'storage':_0x5ab293[_0x24581e(0x184)],'rack':_0x5ab293[_0x24581e(0xd5)],'product_code':_0x5ab293[_0x24581e(0xfd)],'primary_code':_0x5ab293[_0x24581e(0x19b)],'secondary_code':_0x5ab293[_0x24581e(0x1a9)],'maxProducts':_0x5ab293[_0x24581e(0xd2)],'storage':_0x5ab293[_0x24581e(0x184)],'rack':_0x5ab293['rack'],'expiry_date':_0x5ab293['expiry_date'],'maxPerUnit':_0x5ab293['maxperunit'],'batch_code':_0x5ab293[_0x24581e(0xe9)],'production_date':_0x5ab293[_0x24581e(0xc0)]}));}return _0x82fca6;});Promise[_0x58d1e4(0x1ad)](_0xc4e600)[_0x58d1e4(0x173)](async _0x36365d=>{var _0x56d1f5=_0x58d1e4;try{for(const _0x2ddf1e of _0x36365d){await warehouse['updateOne']({'_id':_0x2ddf1e[_0x56d1f5(0x147)]},{'$addToSet':{'product_details':{'$each':_0x2ddf1e[_0x56d1f5(0x166)]}}});}_0x14e606[_0x56d1f5(0x161)]=_0x56d1f5(0x141);const _0x25e8b9=await _0x14e606['save'](),_0x2b0e67=await master_shop[_0x56d1f5(0xc9)](),_0x27ce62=await email_settings[_0x56d1f5(0x1ac)](),_0x467b50=await supervisor_settings[_0x56d1f5(0xc9)]();var _0x110f24=_0x14e606[_0x56d1f5(0x116)],_0x46c87e='',_0x1a7708;for(_0x1a7708 in _0x110f24){_0x46c87e+=_0x56d1f5(0x103)+_0x56d1f5(0x122)+_0x110f24[_0x1a7708][_0x56d1f5(0x198)]+_0x56d1f5(0x1a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x110f24[_0x1a7708][_0x56d1f5(0xfd)]+_0x56d1f5(0x1a1)+_0x56d1f5(0x122)+_0x110f24[_0x1a7708][_0x56d1f5(0x138)]+_0x56d1f5(0x1a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x110f24[_0x1a7708][_0x56d1f5(0xe0)]+_0x56d1f5(0x1a1)+_0x56d1f5(0x122)+_0x110f24[_0x1a7708][_0x56d1f5(0x114)]+_0x56d1f5(0x1a1)+_0x56d1f5(0x122)+_0x14e606[_0x56d1f5(0x117)]+_0x56d1f5(0x1a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x110f24[_0x1a7708][_0x56d1f5(0x15b)]+_0x56d1f5(0x1a1)+_0x56d1f5(0x122)+_0x110f24[_0x1a7708][_0x56d1f5(0x184)]+_0x110f24[_0x1a7708][_0x56d1f5(0xd5)]+_0x110f24[_0x1a7708][_0x56d1f5(0x180)]+_0x110f24[_0x1a7708][_0x56d1f5(0x10d)]+_0x110f24[_0x1a7708][_0x56d1f5(0x165)][0x0]+_0x110f24[_0x1a7708]['to_floorlevel']+'</td>',_0x56d1f5(0xc7);}let _0x20fd66=nodemailer[_0x56d1f5(0xff)]({'host':_0x27ce62['host'],'port':Number(_0x27ce62[_0x56d1f5(0xd9)]),'secure':![],'auth':{'user':_0x27ce62[_0x56d1f5(0xe8)],'pass':_0x27ce62[_0x56d1f5(0xf2)]}}),_0x3a8f21={'from':_0x27ce62[_0x56d1f5(0xe8)],'to':_0x467b50[0x0][_0x56d1f5(0x1a4)],'subject':_0x56d1f5(0x18e),'attachments':[{'filename':_0x56d1f5(0xfc),'path':__dirname+_0x56d1f5(0x129)+_0x56d1f5(0x112)+_0x2b0e67[0x0][_0x56d1f5(0x181)],'cid':_0x56d1f5(0x159)}],'html':_0x56d1f5(0x133)+_0x56d1f5(0x19e)+'</head><body>'+_0x56d1f5(0xc2)+_0x56d1f5(0x163)+_0x56d1f5(0xc2)+_0x56d1f5(0x11e)+_0x56d1f5(0x107)+'<div>'+_0x56d1f5(0x11c)+_0x2b0e67[0x0][_0x56d1f5(0x104)]+_0x56d1f5(0x105)+_0x56d1f5(0x107)+_0x56d1f5(0x107)+_0x56d1f5(0xde)+_0x56d1f5(0xc2)+_0x56d1f5(0xf9)+_0x56d1f5(0x155)+_0x14e606['invoice']+'\x20'+_0x56d1f5(0x156)+_0x56d1f5(0x124)+_0x14e606[_0x56d1f5(0x19d)]+'\x20'+_0x56d1f5(0xe5)+_0x56d1f5(0x174)+'</div>'+_0x56d1f5(0x18c)+_0x56d1f5(0x100)+_0x56d1f5(0x103)+_0x56d1f5(0x12a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x56d1f5(0x12e)+_0x56d1f5(0x182)+_0x56d1f5(0x191)+_0x56d1f5(0x154)+_0x56d1f5(0xcf)+_0x56d1f5(0xea)+_0x56d1f5(0xc7)+_0x56d1f5(0x17b)+_0x56d1f5(0xba)+'\x20'+_0x46c87e+'\x20'+_0x56d1f5(0xfe)+_0x56d1f5(0x162)+_0x56d1f5(0xc2)+_0x56d1f5(0x17c)+'<h5>'+_0x2b0e67[0x0][_0x56d1f5(0x104)]+'</h5>'+'</div>'+_0x56d1f5(0x107)+_0x56d1f5(0x16e)};_0x20fd66['sendMail'](_0x3a8f21,function(_0x58f67c,_0x5ee276){var _0x3f5846=_0x56d1f5;_0x58f67c?(console[_0x3f5846(0x17a)](_0x58f67c),console[_0x3f5846(0x17a)](_0x3f5846(0xd1))):console[_0x3f5846(0x17a)](_0x3f5846(0x1b4));}),_0x3242c4[_0x56d1f5(0xc1)](_0x56d1f5(0x153),_0x56d1f5(0x1a2)),_0x2963fb[_0x56d1f5(0xee)](_0x56d1f5(0x136)+_0x25e8b9[_0x56d1f5(0x147)]);}catch(_0x25c24c){console[_0x56d1f5(0x1aa)](_0x25c24c),_0x2963fb[_0x56d1f5(0xcb)](0x1f4)[_0x56d1f5(0xe1)]({'Perror':_0x56d1f5(0x185),'message':_0x25c24c[_0x56d1f5(0x1af)]});}})[_0x58d1e4(0x148)](_0xe82c55=>{var _0x3b255d=_0x58d1e4;console['error'](_0xe82c55),_0x2963fb[_0x3b255d(0xcb)](0x1f4)[_0x3b255d(0xe1)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x43605b){_0x2963fb['json'](_0x43605b);}}catch(_0x815a79){console[_0x58d1e4(0x1aa)](_0x815a79),_0x2963fb[_0x58d1e4(0xcb)](0x1f4)[_0x58d1e4(0xe1)]({'Merror':_0x58d1e4(0x185),'Message':_0x815a79[_0x58d1e4(0x1af)]});}})[_0x19d5f4(0x148)](_0x1d2f5f=>{var _0x55736f=_0x19d5f4;console['error'](_0x1d2f5f),_0x2963fb[_0x55736f(0xcb)](0x1f4)['json']({'Merror':'An\x20error\x20occurred.'});});}catch(_0x198bb2){console[_0x19d5f4(0x17a)](_0x198bb2);}});function BayBinSelected(_0xd86635,_0x293d5e){var _0x417fa7=a0_0x2d7a19,_0x4163fa=[],_0x4098cf=[],_0xe547f4=[],_0x50ece9=[],_0x457c04=[],_0x3f3a9a=[];let _0x566197=[];if(_0xd86635==_0x417fa7(0x14e))switch(_0x293d5e){case _0x417fa7(0x16a):_0x4163fa=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4098cf=[0x1,0x2],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=[_0x417fa7(0x194),_0x417fa7(0xd3)],_0x457c04=['D'],_0x3f3a9a=['A'];break;case'Rack\x20B':_0x4163fa=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4098cf=[0x1,0x2],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=['Level',_0x417fa7(0xd3)],_0x457c04=['D'],_0x3f3a9a=['B'];break;case _0x417fa7(0x1ab):_0x4163fa=[0x0],_0x4098cf=[0x0],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=[_0x417fa7(0xd3)],_0x457c04=['D'],_0x3f3a9a=['S'];break;case _0x417fa7(0x18f):_0x4163fa=[0x0],_0x4098cf=[0x0],_0x50ece9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0xe547f4=[_0x417fa7(0xd3)],_0x457c04=['D'],_0x3f3a9a=['R'];break;}else{if(_0xd86635==_0x417fa7(0x158))switch(_0x293d5e){case _0x417fa7(0x16a):_0x4163fa=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4098cf=['B','F'],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=[_0x417fa7(0x194),_0x417fa7(0xd3)],_0x457c04=['C'],_0x3f3a9a=['A'];break;case _0x417fa7(0x121):_0x4163fa=[0x5,0x4,0x3,0x2,0x1],_0x4098cf=['F','B','S'],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=['Level','Floor'],_0x457c04=['C'],_0x3f3a9a=['B'];break;case'Rack\x20C':_0x4163fa=[0x1,0x2,0x3,0x4,0x5],_0x4098cf=['B','F','S'],_0x50ece9=[0x5,0x4,0x3,0x2,0x1],_0xe547f4=[_0x417fa7(0x194),_0x417fa7(0xd3)],_0x457c04=['C'],_0x3f3a9a=['C'];break;case'Rack\x20D':_0x4163fa=[0x5,0x4,0x3,0x2,0x1],_0x4098cf=['F','B','S'],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=['Level','Floor'],_0x457c04=['C'],_0x3f3a9a=['D'];break;case _0x417fa7(0x1b0):_0x4163fa=[0x4,0x3,0x2,0x1],_0x4098cf=[0x1,0x2],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=[_0x417fa7(0x194),_0x417fa7(0xd3)],_0x457c04=['C'],_0x3f3a9a=['E'];break;case _0x417fa7(0x150):_0x4163fa=[0x1,0x2,0x3],_0x4098cf=[0x1,0x2],_0x50ece9=[0x1,0x2,0x3,0x4,0x5],_0xe547f4=[_0x417fa7(0x194)],_0x457c04=['C'],_0x3f3a9a=['F'];break;}}return{'levels':_0x4163fa,'Isle':_0x4098cf,'rack':_0x50ece9,'type':_0xe547f4,'storage':_0x457c04,'rak':_0x3f3a9a};}router[a0_0x2d7a19(0x102)]('/view/:id',auth,async(_0x3c3b71,_0x7249cb)=>{var _0xbde5a8=a0_0x2d7a19;try{const {username:_0x8c1caf,email:_0x369751,role:_0x473272}=_0x3c3b71[_0xbde5a8(0x134)],_0x55dd06=_0x3c3b71[_0xbde5a8(0x134)],_0x53a065=await profile['findOne']({'email':_0x55dd06[_0xbde5a8(0xe8)]}),_0x51dff1=await master_shop[_0xbde5a8(0xc9)](),_0x5eba06=await transfers['findById'](_0x3c3b71[_0xbde5a8(0x143)]['id']);let _0x22f915;if(_0x55dd06[_0xbde5a8(0xc3)]=='staff'){const _0x545bec=await staff['findOne']({'email':_0x55dd06[_0xbde5a8(0xe8)]});_0x22f915=await warehouse[_0xbde5a8(0x125)]([{'$match':{'status':_0xbde5a8(0x1a6),'name':_0x545bec[_0xbde5a8(0x1b2)],'warehouse_category':_0xbde5a8(0xb7)}},{'$group':{'_id':_0xbde5a8(0x13b),'name':{'$first':_0xbde5a8(0x13b)}}}]);}else _0x22f915=await warehouse['aggregate']([{'$match':{'status':_0xbde5a8(0x1a6),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0xbde5a8(0x13b),'name':{'$first':_0xbde5a8(0x13b)}}}]);const _0x4d74b1=await warehouse[_0xbde5a8(0x125)]([{'$match':{'name':_0x5eba06[_0xbde5a8(0x18a)],'warehouse_category':_0xbde5a8(0xb7)}},{'$unwind':'$product_details'},{'$group':{'_id':_0xbde5a8(0x115),'name':{'$first':_0xbde5a8(0x167)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xbde5a8(0x15a)},'bin':{'$first':_0xbde5a8(0x1b1)},'type':{'$first':_0xbde5a8(0xc8)},'floorlevel':{'$first':_0xbde5a8(0x128)},'primary_code':{'$first':_0xbde5a8(0xdf)},'secondary_code':{'$first':_0xbde5a8(0xe6)},'product_code':{'$first':_0xbde5a8(0x142)},'storage':{'$first':_0xbde5a8(0x131)},'rack':{'$first':_0xbde5a8(0xcc)},'expiry_date':{'$first':_0xbde5a8(0x186)},'production_date':{'$first':_0xbde5a8(0xbc)},'room':{'$first':_0xbde5a8(0xd8)}}}]),_0x3e938f=await product[_0xbde5a8(0xc9)]({}),_0x4c5369=BayBinSelected(_0x5eba06['to_warehouse'],_0x5eba06['to_room']);if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]==_0xbde5a8(0x18d)){var _0x4e0661=users[_0xbde5a8(0x10e)];console[_0xbde5a8(0x17a)](_0x4e0661);}else{if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]=='Hindi')var _0x4e0661=users['Hindi'];else{if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]=='German')var _0x4e0661=users['German'];else{if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]==_0xbde5a8(0x16c))var _0x4e0661=users[_0xbde5a8(0x16c)];else{if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]=='French')var _0x4e0661=users[_0xbde5a8(0x19a)];else{if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]==_0xbde5a8(0x172))var _0x4e0661=users[_0xbde5a8(0x190)];else{if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]==_0xbde5a8(0x192))var _0x4e0661=users[_0xbde5a8(0x192)];else{if(_0x51dff1[0x0][_0xbde5a8(0x1a8)]==_0xbde5a8(0x160))var _0x4e0661=users['Arabic'];}}}}}}}_0x7249cb[_0xbde5a8(0x146)](_0xbde5a8(0xbb),{'success':_0x3c3b71['flash']('success'),'errors':_0x3c3b71['flash']('errors'),'role':_0x55dd06,'profile':_0x53a065,'master_shop':_0x51dff1,'warehouse':_0x22f915,'transfer':_0x5eba06,'stock':_0x4d74b1,'unit':_0x3e938f,'language':_0x4e0661});}catch(_0x8ec248){console['log'](_0x8ec248);}}),router[a0_0x2d7a19(0xbe)]('/view/:id',auth,async(_0x642d10,_0x1d846b)=>{var _0x124b59=a0_0x2d7a19;try{const _0x2247f7=_0x642d10[_0x124b59(0x143)]['id'],_0x1e5b52=await transfers[_0x124b59(0x118)](_0x2247f7);_0x1d846b['json'](_0x642d10[_0x124b59(0x15f)]);return;const {date:_0x2a7bb1,from_warehouse:_0x12dedb,FromRoom_name:_0xf2254b,to_warehouse:_0x364559,ToRoom_name:_0x4c018c,prod_name:_0x175678,from_prod_qty:_0x4739b8,from_prod_level:_0x3164b3,from_prod_isle:_0x3587a0,from_prod_pallet:_0x35a7a1,to_prod_qty:_0x43ec92,to_prod_level:_0x573500,to_prod_isle:_0x207a2e,to_prod_pallet:_0x47178a,primary_code:_0x13dee9,secondary_code:_0x2bbf2e,product_code3:_0x456fdf,note:_0x9187cd,invoice:_0x210e83,expiry_date:_0xceebe9}=_0x642d10[_0x124b59(0x15f)];if(typeof _0x175678==_0x124b59(0x140))var _0x168541=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0xef)]],_0x44940d=[_0x642d10[_0x124b59(0x15f)]['from_prod_qty']],_0x31dc8b=[_0x642d10['body'][_0x124b59(0xb9)]],_0x10ebe9=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x176)]],_0x474e70=[_0x642d10['body'][_0x124b59(0x108)]],_0x83b1b=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x139)]],_0x21e014=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x11f)]],_0x49de04=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x137)]],_0x5ccbf1=[_0x642d10['body']['to_prod_isle']],_0x5138db=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x144)]],_0x2b7df3=[_0x642d10['body'][_0x124b59(0x165)]],_0xaa8990=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x184)]],_0x163c7d=[_0x642d10['body']['rak']],_0x40c4f0=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x19b)]],_0x404acc=[_0x642d10['body'][_0x124b59(0x1a9)]],_0x26ac88=[_0x642d10[_0x124b59(0x15f)]['product_code3']],_0x2afb18=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0xc4)]],_0x1b2d8d=[_0x642d10['body']['unit']],_0x3f8152=[_0x642d10['body'][_0x124b59(0x114)]],_0x4a418c=[_0x642d10[_0x124b59(0x15f)]['batch_code']],_0xcae15c=[_0x642d10['body'][_0x124b59(0xdb)]],_0x59a485=[_0x642d10[_0x124b59(0x15f)][_0x124b59(0x14b)]],_0x1e5219=[_0x642d10['body'][_0x124b59(0x168)]];else var _0x168541=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0xef)]],_0xaa8990=[..._0x642d10[_0x124b59(0x15f)]['storage']],_0x163c7d=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0xec)]],_0x83b1b=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x139)]],_0x2b7df3=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x165)]],_0x44940d=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x19f)]],_0x31dc8b=[..._0x642d10['body']['from_prod_level']],_0x10ebe9=[..._0x642d10[_0x124b59(0x15f)]['from_prod_isle']],_0x474e70=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x108)]],_0x21e014=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x11f)]],_0x49de04=[..._0x642d10['body']['to_prod_level']],_0x5ccbf1=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x149)]],_0x5138db=[..._0x642d10['body'][_0x124b59(0x144)]],_0x40c4f0=[..._0x642d10[_0x124b59(0x15f)]['primary_code']],_0x404acc=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x1a9)]],_0x26ac88=[..._0x642d10[_0x124b59(0x15f)]['product_code3']],_0x2afb18=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0xc4)]],_0x1b2d8d=[..._0x642d10['body']['unit']],_0x3f8152=[..._0x642d10[_0x124b59(0x15f)]['secondary_unit']],_0x4a418c=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0xe9)]],_0xcae15c=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0xdb)]],_0x59a485=[..._0x642d10[_0x124b59(0x15f)][_0x124b59(0x14b)]],_0x1e5219=[..._0x642d10['body'][_0x124b59(0x168)]];const _0x12a34c=_0x168541[_0x124b59(0xf1)](_0x34fdac=>{return _0x34fdac={'product_name':_0x34fdac};});_0x44940d[_0x124b59(0x15d)]((_0x418800,_0x5492ab)=>{var _0x4881ce=_0x124b59;_0x12a34c[_0x5492ab][_0x4881ce(0x177)]=_0x418800;}),_0x31dc8b[_0x124b59(0x15d)]((_0x2e4da4,_0x2aa753)=>{var _0x38ebfa=_0x124b59;_0x12a34c[_0x2aa753][_0x38ebfa(0x164)]=_0x2e4da4;}),_0x10ebe9['forEach']((_0x256e56,_0x162e56)=>{var _0x43c1a9=_0x124b59;_0x12a34c[_0x162e56][_0x43c1a9(0x15e)]=_0x256e56;}),_0x474e70[_0x124b59(0x15d)]((_0x168752,_0x431b81)=>{var _0x2bff14=_0x124b59;_0x12a34c[_0x431b81][_0x2bff14(0x183)]=_0x168752;}),_0x21e014[_0x124b59(0x15d)]((_0x564486,_0x451e35)=>{_0x12a34c[_0x451e35]['to_quantity']=_0x564486;}),_0x49de04[_0x124b59(0x15d)]((_0x26a928,_0x4c28aa)=>{_0x12a34c[_0x4c28aa]['to_bay']=_0x26a928;}),_0x5ccbf1[_0x124b59(0x15d)]((_0x150cff,_0x562d6e)=>{_0x12a34c[_0x562d6e]['to_bin']=_0x150cff;}),_0x5138db['forEach']((_0x168c7a,_0x166ab1)=>{var _0x423200=_0x124b59;_0x12a34c[_0x166ab1][_0x423200(0x15c)]=_0x168c7a;}),_0x40c4f0[_0x124b59(0x15d)]((_0x217156,_0x13a36b)=>{var _0x47e889=_0x124b59;_0x12a34c[_0x13a36b][_0x47e889(0x19b)]=_0x217156;}),_0x404acc[_0x124b59(0x15d)]((_0x20a3b1,_0x1cb547)=>{var _0x32f60a=_0x124b59;_0x12a34c[_0x1cb547][_0x32f60a(0x1a9)]=_0x20a3b1;}),_0x26ac88['forEach']((_0x49946b,_0x258ff7)=>{var _0x190ff3=_0x124b59;_0x12a34c[_0x258ff7][_0x190ff3(0xfd)]=_0x49946b;}),_0x2afb18[_0x124b59(0x15d)]((_0x166609,_0x1ef59f)=>{var _0xb8d26b=_0x124b59;_0x12a34c[_0x1ef59f][_0xb8d26b(0xd2)]=_0x166609;}),_0x1b2d8d['forEach']((_0x2b3452,_0x9da083)=>{var _0x14eabf=_0x124b59;_0x12a34c[_0x9da083][_0x14eabf(0xe0)]=_0x2b3452;}),_0x3f8152[_0x124b59(0x15d)]((_0xd11ca7,_0x5af782)=>{var _0x533c1f=_0x124b59;_0x12a34c[_0x5af782][_0x533c1f(0x114)]=_0xd11ca7;}),_0x4a418c[_0x124b59(0x15d)]((_0x303c92,_0x397363)=>{_0x12a34c[_0x397363]['batch_code']=_0x303c92;}),_0xcae15c['forEach']((_0x2ac1e0,_0x224680)=>{var _0x409fd4=_0x124b59;_0x12a34c[_0x224680][_0x409fd4(0xdb)]=_0x2ac1e0;}),_0xaa8990[_0x124b59(0x15d)]((_0x1b9e76,_0x55bdd1)=>{var _0x10298f=_0x124b59;_0x12a34c[_0x55bdd1][_0x10298f(0x184)]=_0x1b9e76;}),_0x163c7d[_0x124b59(0x15d)]((_0x19b4a3,_0x1cfc9d)=>{var _0x1deae4=_0x124b59;_0x12a34c[_0x1cfc9d][_0x1deae4(0xd5)]=_0x19b4a3;}),_0x83b1b[_0x124b59(0x15d)]((_0x43b7b6,_0x592352)=>{var _0x27c5b9=_0x124b59;_0x12a34c[_0x592352][_0x27c5b9(0x139)]=_0x43b7b6;}),_0x2b7df3[_0x124b59(0x15d)]((_0x4bda5f,_0x2000d4)=>{var _0x114a91=_0x124b59;_0x12a34c[_0x2000d4][_0x114a91(0x165)]=_0x4bda5f;}),_0x59a485['forEach']((_0x4a05c7,_0x3c0497)=>{var _0x38e10b=_0x124b59;_0x12a34c[_0x3c0497][_0x38e10b(0x14b)]=_0x4a05c7;}),_0x1e5219[_0x124b59(0x15d)]((_0x28f391,_0x5c8f67)=>{var _0x18f27e=_0x124b59;_0x12a34c[_0x5c8f67][_0x18f27e(0x106)]=_0x28f391;});const _0x45df31=_0x12a34c[_0x124b59(0xdd)](_0x52ca7d=>_0x52ca7d[_0x124b59(0x138)]!=='0'&&_0x52ca7d[_0x124b59(0x138)]!==''||_0x52ca7d[_0x124b59(0x15c)]!=='0'&&_0x52ca7d[_0x124b59(0x15c)]!=='');var _0x40bde1=0x0;_0x45df31[_0x124b59(0x15d)](_0x37cea3=>{parseInt(_0x37cea3['from_quantity'])<parseInt(_0x37cea3['to_quantity'])&&_0x40bde1++;});if(_0x40bde1!=0x0)return _0x642d10[_0x124b59(0xc1)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x1d846b['redirect'](_0x124b59(0xfa));const _0xc22dcc=await warehouse['findOne']({'name':_0x1e5b52[_0x124b59(0x18a)],'room':_0x1e5b52[_0x124b59(0x14f)]});_0x1e5b52[_0x124b59(0x116)][_0x124b59(0x15d)](_0x17d8bc=>{var _0x3c7fb4=_0x124b59;if(_0x17d8bc[_0x3c7fb4(0x138)]>0x0){const _0x335f28=_0xc22dcc['product_details'][_0x3c7fb4(0xf1)](_0x3cf690=>{var _0x36a888=_0x3c7fb4;_0x3cf690['product_name']==_0x17d8bc[_0x36a888(0x198)]&&_0x3cf690['floorlevel']==_0x17d8bc['from_floorlevel']&&_0x3cf690[_0x36a888(0xc5)]==_0x17d8bc[_0x36a888(0x139)]&&_0x3cf690[_0x36a888(0x11a)]==_0x17d8bc[_0x36a888(0x15e)]&&_0x3cf690['bay']==_0x17d8bc['from_bay']&&_0x3cf690[_0x36a888(0xd5)]==_0x17d8bc[_0x36a888(0x106)]&&_0x3cf690[_0x36a888(0x184)]==_0x17d8bc[_0x36a888(0x14b)]&&(_0x3cf690[_0x36a888(0xc6)]=parseInt(_0x3cf690[_0x36a888(0xc6)])+parseInt(_0x17d8bc[_0x36a888(0x138)]));});}}),await _0xc22dcc['save']();const _0x5dc4cd=await warehouse[_0x124b59(0x1ac)]({'name':_0x1e5b52[_0x124b59(0x117)],'room':_0x1e5b52[_0x124b59(0xcd)]});_0x1e5b52[_0x124b59(0x116)]['forEach'](_0x149953=>{var _0x126e50=_0x124b59;if(_0x149953[_0x126e50(0x138)]>0x0){const _0x3ce183=_0x5dc4cd[_0x126e50(0x166)][_0x126e50(0xf1)](_0x4d3113=>{var _0x2999c9=_0x126e50;_0x4d3113[_0x2999c9(0x198)]==_0x149953[_0x2999c9(0x198)]&&_0x4d3113['floorlevel']==_0x149953[_0x2999c9(0x15c)]&&_0x4d3113[_0x2999c9(0xc5)]==_0x149953[_0x2999c9(0x165)]&&_0x4d3113[_0x2999c9(0x11a)]==_0x149953[_0x2999c9(0x10d)]&&_0x4d3113['bay']==_0x149953[_0x2999c9(0x180)]&&_0x4d3113[_0x2999c9(0xd5)]==_0x149953[_0x2999c9(0xd5)]&&_0x4d3113[_0x2999c9(0x184)]==_0x149953['storage']&&(_0x4d3113['product_stock']=parseInt(_0x4d3113[_0x2999c9(0xc6)])-parseInt(_0x149953[_0x2999c9(0x138)]));});}}),await _0x5dc4cd['save'](),_0x1e5b52[_0x124b59(0x19d)]=_0x2a7bb1,_0x1e5b52[_0x124b59(0x18a)]=_0x12dedb,_0x1e5b52[_0x124b59(0x117)]=_0x364559,_0x1e5b52[_0x124b59(0x116)]=_0x45df31,_0x1e5b52[_0x124b59(0xd6)]=_0x9187cd,_0x1e5b52[_0x124b59(0xe2)]=_0x210e83;const _0x5197be=await _0x1e5b52['save']();console[_0x124b59(0x17a)](_0x5197be);const _0x1194b0=await warehouse[_0x124b59(0x1ac)]({'name':_0x12dedb,'room':_0xf2254b});_0x5197be[_0x124b59(0x116)][_0x124b59(0x15d)](_0x57e33e=>{var _0xa0c5ab=_0x124b59;if(_0x57e33e[_0xa0c5ab(0x138)]>0x0){const _0x22f4ad=_0x1194b0[_0xa0c5ab(0x166)][_0xa0c5ab(0xf1)](_0x537f17=>{var _0x9be1f1=_0xa0c5ab;_0x537f17[_0x9be1f1(0x198)]==_0x57e33e['product_name']&&_0x537f17[_0x9be1f1(0xd0)]==_0x57e33e[_0x9be1f1(0x183)]&&_0x537f17[_0x9be1f1(0xc5)]==_0x57e33e['from_types']&&_0x537f17[_0x9be1f1(0x11a)]==_0x57e33e['from_bin']&&_0x537f17['bay']==_0x57e33e[_0x9be1f1(0x164)]&&_0x537f17[_0x9be1f1(0xd5)]==_0x57e33e[_0x9be1f1(0x106)]&&_0x537f17[_0x9be1f1(0x184)]==_0x57e33e[_0x9be1f1(0x14b)]&&(_0x537f17[_0x9be1f1(0xc6)]=parseInt(_0x537f17['product_stock'])-parseInt(_0x57e33e[_0x9be1f1(0x138)]));});}}),await _0x1194b0[_0x124b59(0xf6)]();const _0x145883=await warehouse[_0x124b59(0x1ac)]({'name':_0x364559,'room':_0x4c018c});_0x5197be[_0x124b59(0x116)][_0x124b59(0x15d)](_0x20df37=>{var _0x154484=_0x124b59;if(_0x20df37[_0x154484(0x138)]>0x0){var _0x9ac81e=0x0;const _0x580f2b=_0x145883[_0x154484(0x166)]['map'](_0x1632e8=>{var _0x527c2b=_0x154484;_0x1632e8[_0x527c2b(0x198)]==_0x20df37[_0x527c2b(0x198)]&&_0x1632e8[_0x527c2b(0xd0)]==_0x20df37[_0x527c2b(0x15c)]&&_0x1632e8[_0x527c2b(0xc5)]==_0x20df37[_0x527c2b(0x165)]&&_0x1632e8[_0x527c2b(0x11a)]==_0x20df37['to_bin']&&_0x1632e8[_0x527c2b(0xda)]==_0x20df37[_0x527c2b(0x180)]&&_0x1632e8[_0x527c2b(0xd5)]==_0x20df37[_0x527c2b(0xd5)]&&_0x1632e8[_0x527c2b(0x184)]==_0x20df37['storage']&&(_0x1632e8[_0x527c2b(0xc6)]=parseInt(_0x1632e8['product_stock'])+parseInt(_0x20df37[_0x527c2b(0x138)]),_0x9ac81e++);});_0x9ac81e=='0'&&(_0x145883[_0x154484(0x166)]=_0x145883[_0x154484(0x166)][_0x154484(0x1ae)]({'product_name':_0x20df37[_0x154484(0x198)],'product_stock':_0x20df37[_0x154484(0x138)],'bay':_0x20df37[_0x154484(0x180)],'bin':_0x20df37[_0x154484(0x10d)],'type':_0x20df37[_0x154484(0x165)],'floorlevel':_0x20df37[_0x154484(0x15c)],'storage':_0x20df37[_0x154484(0x184)],'rack':_0x20df37[_0x154484(0xd5)],'product_code':_0x20df37[_0x154484(0xfd)],'primary_code':_0x20df37[_0x154484(0x19b)],'secondary_code':_0x20df37[_0x154484(0x1a9)],'maxProducts':_0x20df37[_0x154484(0xd2)],'storage':_0x20df37['storage'],'rack':_0x20df37[_0x154484(0xd5)]}));}}),await _0x145883['save'](),_0x642d10[_0x124b59(0xc1)]('success',_0x124b59(0x123)),_0x1d846b[_0x124b59(0xee)](_0x124b59(0x13a));}catch(_0x2c8d4d){console[_0x124b59(0x17a)](_0x2c8d4d);}}),router[a0_0x2d7a19(0xbe)](a0_0x2d7a19(0xed),async(_0x3372cb,_0x41f63e)=>{var _0xd9cbf8=a0_0x2d7a19;const {FromWareHouse:_0x5d5cb9,FromRoom:_0x3c3c07,ToWarehouse:_0x3a84a3,ToRoom:_0x22f529,primary_code:_0xe90951,Roomslist:_0x1fdb2}=_0x3372cb[_0xd9cbf8(0x15f)],_0x9e9625=_0x1fdb2['split'](','),_0x218fbf=[];async function _0x1e749a(_0x5402ff){var _0x2dfce0=_0xd9cbf8;const _0xa636e5=await warehouse['aggregate']([{'$match':{'name':_0x5d5cb9,'room':_0x5402ff}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0xe90951}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2dfce0(0x167)},'instock':{'$first':_0x2dfce0(0x18b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2dfce0(0xe6)},'product_code':{'$first':_0x2dfce0(0x142)},'level':{'$first':_0x2dfce0(0x15a)},'isle':{'$first':_0x2dfce0(0x1b1)},'type':{'$first':_0x2dfce0(0xc8)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2dfce0(0x111)},'secondary_unit':{'$first':_0x2dfce0(0xf0)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2dfce0(0xcc)},'expiry_date':{'$first':_0x2dfce0(0x186)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x2dfce0(0x11d)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x2dfce0(0xd8)},'maxProducts':{'$first':_0x2dfce0(0xf3)},'invoice_product':{'$first':_0x2dfce0(0x17f)}}}]),_0x836923=await warehouse[_0x2dfce0(0x125)]([{'$match':{'name':_0x5d5cb9,'room':_0x5402ff}},{'$unwind':_0x2dfce0(0x126)},{'$match':{'product_details.secondary_code':_0xe90951}},{'$group':{'_id':_0x2dfce0(0x115),'name':{'$first':_0x2dfce0(0x167)},'instock':{'$first':_0x2dfce0(0x18b)},'primary_code':{'$first':_0x2dfce0(0xdf)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2dfce0(0x142)},'level':{'$first':_0x2dfce0(0x15a)},'isle':{'$first':_0x2dfce0(0x1b1)},'type':{'$first':_0x2dfce0(0xc8)},'pallet':{'$first':_0x2dfce0(0x128)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2dfce0(0xf0)},'storage':{'$first':_0x2dfce0(0x131)},'rack':{'$first':_0x2dfce0(0xcc)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2dfce0(0xbc)},'batch_code':{'$first':_0x2dfce0(0x120)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x2dfce0(0xd8)},'maxProducts':{'$first':_0x2dfce0(0xf3)},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0xa636e5['length']>0x0)_0x218fbf[_0x2dfce0(0x113)](_0xa636e5);else _0x836923[_0x2dfce0(0x196)]>0x0&&_0x218fbf[_0x2dfce0(0x113)](_0x836923);}const _0x556cdd=_0x9e9625[_0xd9cbf8(0xf1)](_0x1f32d5=>_0x1e749a(_0x1f32d5));await Promise[_0xd9cbf8(0x1ad)](_0x556cdd),_0x41f63e[_0xd9cbf8(0xe1)](_0x218fbf);}),router[a0_0x2d7a19(0xbe)]('/barcode_scanner2',async(_0x302196,_0x50ee95)=>{var _0x4778c7=a0_0x2d7a19;try{const {FromWareHouse:_0x3d37e7,FromRoom:_0x1a4a8c,ToWarehouse:_0x312fe4,ToRoom:_0x482f83,secondary_code:_0x169321}=_0x302196[_0x4778c7(0x15f)],_0x5556b7=await warehouse[_0x4778c7(0x125)]([{'$match':{'name':_0x3d37e7}},{'$unwind':_0x4778c7(0x126)},{'$match':{'product_details.secondary_code':_0x169321}},{'$group':{'_id':_0x4778c7(0x115),'name':{'$first':_0x4778c7(0x167)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4778c7(0xe6)},'product_code':{'$first':_0x4778c7(0x142)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x4778c7(0xd4)},'isle':{'$first':_0x4778c7(0x197)},'pallet':{'$first':_0x4778c7(0xe4)},'maxProducts':{'$first':_0x4778c7(0xf3)},'unit':{'$first':_0x4778c7(0x111)}}}]);_0x50ee95[_0x4778c7(0xcb)](0xc8)[_0x4778c7(0xe1)](_0x5556b7);}catch(_0x2f77ff){_0x50ee95[_0x4778c7(0xcb)](0x194)[_0x4778c7(0xe1)]({'message':_0x2f77ff[_0x4778c7(0x1af)]});}}),router['post'](a0_0x2d7a19(0x130),async(_0x330dd6,_0x5de347)=>{var _0x1e736d=a0_0x2d7a19;try{const {FromWareHouse:_0x11b508,FromRoom:_0x53b9a8,ToWarehouse:_0x2f149a,ToRoom:_0x3c6960,product_code:_0x76b1}=_0x330dd6[_0x1e736d(0x15f)],_0x2e4089=await warehouse['aggregate']([{'$match':{'name':_0x11b508}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x76b1}},{'$group':{'_id':_0x1e736d(0x115),'name':{'$first':_0x1e736d(0x167)},'primary_code':{'$first':_0x1e736d(0xdf)},'secondary_code':{'$first':_0x1e736d(0xe6)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x1e736d(0x13b)},'level':{'$first':_0x1e736d(0xd4)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x1e736d(0xf3)},'unit':{'$first':_0x1e736d(0x111)}}}]);_0x5de347[_0x1e736d(0xcb)](0xc8)[_0x1e736d(0xe1)](_0x2e4089);}catch(_0x117e0e){_0x5de347[_0x1e736d(0xcb)](0x194)[_0x1e736d(0xe1)]({'message':_0x117e0e[_0x1e736d(0x1af)]});}}),router[a0_0x2d7a19(0xbe)](a0_0x2d7a19(0x10c),async(_0x6cf70c,_0x5d8889)=>{var _0x568545=a0_0x2d7a19;const {level:_0x48ca94,isle:_0x208bfc,pallet:_0x24b253,warehouses:_0x446876,room:_0x4ffaf4}=_0x6cf70c[_0x568545(0x15f)];try{const _0x3576a5=await warehouse[_0x568545(0x125)]([{'$match':{'name':_0x446876,'room':_0x4ffaf4}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x48ca94),'product_details.isle':_0x208bfc,'product_details.pallet':parseInt(_0x24b253)}},{'$group':{'_id':_0x568545(0x115),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x568545(0x18b)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x568545(0x197)},'pallet':{'$first':_0x568545(0xe4)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x5d8889[_0x568545(0xcb)](0xc8)[_0x568545(0xe1)](_0x3576a5);}catch(_0x1b5a25){_0x5d8889[_0x568545(0xcb)](0x194)[_0x568545(0xe1)]({'message':_0x1b5a25['message']});}}),module[a0_0x2d7a19(0x175)]=router;