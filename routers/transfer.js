var a0_0x326044=a0_0x2a72;function a0_0x2a72(_0x463773,_0x370f03){var _0x3a3263=a0_0x3a32();return a0_0x2a72=function(_0x2a7221,_0x4ec9c1){_0x2a7221=_0x2a7221-0x1e7;var _0x2481d8=_0x3a3263[_0x2a7221];return _0x2481d8;},a0_0x2a72(_0x463773,_0x370f03);}(function(_0x59cf4e,_0x574f76){var _0x3cae4d=a0_0x2a72,_0x3ae862=_0x59cf4e();while(!![]){try{var _0x429b64=-parseInt(_0x3cae4d(0x266))/0x1+parseInt(_0x3cae4d(0x2c6))/0x2*(-parseInt(_0x3cae4d(0x272))/0x3)+parseInt(_0x3cae4d(0x245))/0x4*(-parseInt(_0x3cae4d(0x222))/0x5)+-parseInt(_0x3cae4d(0x255))/0x6+-parseInt(_0x3cae4d(0x2a8))/0x7+parseInt(_0x3cae4d(0x1fa))/0x8*(parseInt(_0x3cae4d(0x2d0))/0x9)+-parseInt(_0x3cae4d(0x203))/0xa*(-parseInt(_0x3cae4d(0x218))/0xb);if(_0x429b64===_0x574f76)break;else _0x3ae862['push'](_0x3ae862['shift']());}catch(_0x25df19){_0x3ae862['push'](_0x3ae862['shift']());}}}(a0_0x3a32,0xd7eb4));const express=require(a0_0x326044(0x237)),app=express(),router=express[a0_0x326044(0x2a0)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x326044(0x2d3)),auth=require(a0_0x326044(0x268)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router['get'](a0_0x326044(0x246),auth,async(_0x4fe2db,_0x330806)=>{var _0xe041ce=a0_0x326044;try{const {username:_0x58c426,email:_0x1f0a1b,role:_0x4f2677}=_0x4fe2db[_0xe041ce(0x202)],_0x2f1e0f=_0x4fe2db[_0xe041ce(0x202)],_0x181d69=await profile[_0xe041ce(0x29e)]({'email':_0x2f1e0f[_0xe041ce(0x23d)]}),_0x6f51d0=await master_shop[_0xe041ce(0x2cd)]();console[_0xe041ce(0x24d)](_0xe041ce(0x29f),_0x6f51d0);let _0xe17fcc;if(_0x2f1e0f[_0xe041ce(0x1f7)]=='staff'){const _0x27f643=await staff['findOne']({'email':_0x2f1e0f[_0xe041ce(0x23d)]});_0xe17fcc=await transfers[_0xe041ce(0x2cd)]({'from_warehouse':_0x27f643[_0xe041ce(0x22b)]});}else _0xe17fcc=await transfers[_0xe041ce(0x2d4)]([{'$unwind':'$product'},{'$group':{'_id':_0xe041ce(0x1f2),'invoice':{'$first':_0xe041ce(0x2b8)},'date':{'$first':_0xe041ce(0x226)},'from_warehouse':{'$first':_0xe041ce(0x1f4)},'to_warehouse':{'$first':_0xe041ce(0x21b)},'from_room_name':{'$addToSet':_0xe041ce(0x296)},'to_room_name':{'$addToSet':_0xe041ce(0x278)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x6f51d0[0x0][_0xe041ce(0x289)]==_0xe041ce(0x1fd)){var _0x54e888=users[_0xe041ce(0x1ff)];console[_0xe041ce(0x24d)](_0x54e888);}else{if(_0x6f51d0[0x0][_0xe041ce(0x289)]=='Hindi')var _0x54e888=users[_0xe041ce(0x20d)];else{if(_0x6f51d0[0x0][_0xe041ce(0x289)]==_0xe041ce(0x253))var _0x54e888=users['German'];else{if(_0x6f51d0[0x0][_0xe041ce(0x289)]==_0xe041ce(0x299))var _0x54e888=users[_0xe041ce(0x299)];else{if(_0x6f51d0[0x0][_0xe041ce(0x289)]==_0xe041ce(0x228))var _0x54e888=users[_0xe041ce(0x228)];else{if(_0x6f51d0[0x0][_0xe041ce(0x289)]==_0xe041ce(0x1f6))var _0x54e888=users['Portuguese'];else{if(_0x6f51d0[0x0]['language']=='Chinese')var _0x54e888=users[_0xe041ce(0x232)];else{if(_0x6f51d0[0x0][_0xe041ce(0x289)]=='Arabic\x20(ae)')var _0x54e888=users['Arabic'];}}}}}}}_0x330806[_0xe041ce(0x1ed)]('transfer',{'success':_0x4fe2db[_0xe041ce(0x21d)](_0xe041ce(0x264)),'errors':_0x4fe2db[_0xe041ce(0x21d)](_0xe041ce(0x295)),'role':_0x2f1e0f,'profile':_0x181d69,'master_shop':_0x6f51d0,'transfer':_0xe17fcc,'language':_0x54e888});}catch(_0xcfd5f0){console[_0xe041ce(0x24d)](_0xcfd5f0);}});async function getRandom8DigitNumber(){var _0x5dfde4=a0_0x326044;const _0x23f9f1=0x989680,_0x54170d=0x5f5e0ff,_0x116f99=Math[_0x5dfde4(0x1f9)](Math[_0x5dfde4(0x200)]()*(_0x54170d-_0x23f9f1+0x1))+_0x23f9f1;var _0x1a2252;const _0x4eef05=await transfers[_0x5dfde4(0x29e)]({'invoice':_0x5dfde4(0x234)+_0x116f99});return _0x4eef05&&_0x4eef05[_0x5dfde4(0x244)]>0x0?_0x1a2252=_0x5dfde4(0x234)+_0x116f99:_0x1a2252=_0x5dfde4(0x234)+_0x116f99,_0x1a2252;}router[a0_0x326044(0x282)]('/view/add_transfer',auth,async(_0x66a1a8,_0x2f834b)=>{var _0x1e8f52=a0_0x326044;try{const {username:_0x165dda,email:_0x428151,role:_0x498faf}=_0x66a1a8[_0x1e8f52(0x202)],_0x2f52ab=_0x66a1a8[_0x1e8f52(0x202)],_0x33faa2=await profile[_0x1e8f52(0x29e)]({'email':_0x2f52ab[_0x1e8f52(0x23d)]}),_0x2d238e=await master_shop[_0x1e8f52(0x2cd)]();console['log'](_0x1e8f52(0x29f),_0x2d238e);let _0x554b05;if(_0x2f52ab[_0x1e8f52(0x1f7)]==_0x1e8f52(0x257)){const _0x495ed7=await staff['findOne']({'email':_0x2f52ab['email']});_0x554b05=await warehouse[_0x1e8f52(0x2d4)]([{'$match':{'status':'Enabled','name':_0x495ed7[_0x1e8f52(0x22b)],'warehouse_category':_0x1e8f52(0x256)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x554b05=await warehouse['aggregate']([{'$match':{'status':_0x1e8f52(0x23f),'warehouse_category':_0x1e8f52(0x256)}},{'$group':{'_id':_0x1e8f52(0x2ba),'name':{'$first':_0x1e8f52(0x2ba)}}}]);var _0x3e2139=[_0x1e8f52(0x201),_0x1e8f52(0x204),_0x1e8f52(0x2c5)];const _0xe87974=await transfers[_0x1e8f52(0x2cd)]({}),_0x4e10d5=_0xe87974['length']+0x1,_0x247aba='TRF-'+_0x4e10d5['toString']()[_0x1e8f52(0x227)](0x5,'0');if(_0x2d238e[0x0][_0x1e8f52(0x289)]==_0x1e8f52(0x1fd)){var _0x43d5c6=users[_0x1e8f52(0x1ff)];console['log'](_0x43d5c6);}else{if(_0x2d238e[0x0]['language']=='Hindi')var _0x43d5c6=users['Hindi'];else{if(_0x2d238e[0x0][_0x1e8f52(0x289)]==_0x1e8f52(0x253))var _0x43d5c6=users[_0x1e8f52(0x253)];else{if(_0x2d238e[0x0][_0x1e8f52(0x289)]==_0x1e8f52(0x299))var _0x43d5c6=users[_0x1e8f52(0x299)];else{if(_0x2d238e[0x0][_0x1e8f52(0x289)]==_0x1e8f52(0x228))var _0x43d5c6=users[_0x1e8f52(0x228)];else{if(_0x2d238e[0x0][_0x1e8f52(0x289)]=='Portuguese\x20(BR)')var _0x43d5c6=users[_0x1e8f52(0x258)];else{if(_0x2d238e[0x0]['language']==_0x1e8f52(0x232))var _0x43d5c6=users[_0x1e8f52(0x232)];else{if(_0x2d238e[0x0]['language']==_0x1e8f52(0x23c))var _0x43d5c6=users[_0x1e8f52(0x25d)];}}}}}}}const _0x3d7bfa=getRandom8DigitNumber();_0x3d7bfa[_0x1e8f52(0x249)](_0x4b3824=>{var _0x49a546=_0x1e8f52;_0x2f834b[_0x49a546(0x1ed)](_0x49a546(0x2bf),{'success':_0x66a1a8['flash'](_0x49a546(0x264)),'errors':_0x66a1a8[_0x49a546(0x21d)]('errors'),'role':_0x2f52ab,'profile':_0x33faa2,'master_shop':_0x2d238e,'warehouse':_0x554b05,'language':_0x43d5c6,'rooms_data':_0x3e2139,'invoice':_0x4b3824});})[_0x1e8f52(0x21c)](_0x42c062=>{var _0x34910a=_0x1e8f52;_0x66a1a8[_0x34910a(0x21d)](_0x34910a(0x295),_0x34910a(0x2a7)),_0x2f834b[_0x34910a(0x288)](_0x34910a(0x28c));});}catch(_0x50d51a){console['log'](_0x50d51a);}}),router[a0_0x326044(0x2b0)](a0_0x326044(0x2c4),auth,async(_0x387fbf,_0x43ef1a)=>{var _0x5cadd8=a0_0x326044;try{console[_0x5cadd8(0x24d)](_0x387fbf[_0x5cadd8(0x290)]);const {date:_0x1dc0a7,from_warehouse:_0xe9767c,FromRoom_name:_0x9c4af2,to_warehouse:_0x8e3785,ToRoom_name:_0x327033,prod_name:_0x4cad53,from_prod_qty:_0x374c5a,from_prod_level:_0x560153,from_prod_isle:_0x1b7a4f,from_prod_pallet:_0x487d59,to_prod_qty:_0xe11248,to_prod_level:_0x223a76,to_prod_isle:_0x3e83dc,to_prod_pallet:_0x17e7e2,primary_code:_0x59ce87,secondary_code:_0x4e1b74,product_code3:_0x3adbfb,note:_0x10e361,MaxStocks_data2:_0x1c3362,invoice:_0xa24c7c,expiry_date:_0x15d452}=_0x387fbf['body'];if(typeof _0x4cad53==_0x5cadd8(0x252))var _0x645639=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x1ee)]],_0x4ba2c5=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x23b)]],_0x2ff245=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x231)]],_0x47407e=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x1fe)]],_0x242679=[_0x387fbf[_0x5cadd8(0x290)]['to_prod_level']],_0x2312b0=[_0x387fbf['body'][_0x5cadd8(0x261)]],_0x4a4bfe=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x24b)]],_0x229028=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2ce)]],_0xcfc4ef=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x213)]],_0x9f6e6e=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x1e8)]],_0x6e3b35=[_0x387fbf['body'][_0x5cadd8(0x2d2)]],_0x5ea2f2=[_0x387fbf['body'][_0x5cadd8(0x223)]],_0x8cc4a7=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2bc)]],_0x32404d=[_0x387fbf['body'][_0x5cadd8(0x2ac)]],_0xdd2643=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x242)]],_0x5b896f=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x216)]],_0x2da74f=[_0x387fbf['body'][_0x5cadd8(0x2a2)]],_0x562b67=[_0x387fbf[_0x5cadd8(0x290)]['ToRoomAssigned']],_0x13e280=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2ab)]],_0x33d9e2=[_0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2bd)]];else var _0x645639=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x1ee)]],_0x4ba2c5=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x23b)]],_0x2ff245=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x231)]],_0x47407e=[..._0x387fbf['body'][_0x5cadd8(0x1fe)]],_0x242679=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2ae)]],_0x2312b0=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x261)]],_0x4a4bfe=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x24b)]],_0x229028=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2ce)]],_0xcfc4ef=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x213)]],_0x9f6e6e=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x1e8)]],_0x6e3b35=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2d2)]],_0x5ea2f2=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x223)]],_0x8cc4a7=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2bc)]],_0x32404d=[..._0x387fbf[_0x5cadd8(0x290)]['max_per_unit']],_0xdd2643=[..._0x387fbf['body'][_0x5cadd8(0x242)]],_0x5b896f=[..._0x387fbf[_0x5cadd8(0x290)]['prod_cat']],_0x2da74f=[..._0x387fbf[_0x5cadd8(0x290)]['RoomAssigned']],_0x562b67=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2a4)]],_0x13e280=[..._0x387fbf[_0x5cadd8(0x290)][_0x5cadd8(0x2ab)]],_0x33d9e2=[..._0x387fbf['body'][_0x5cadd8(0x2bd)]];const _0x2e4c8c=_0x645639[_0x5cadd8(0x275)](_0x25a870=>{return _0x25a870={'product_name':_0x25a870};});_0x4ba2c5['forEach']((_0x5c1582,_0x22b0c6)=>{var _0x3d1478=_0x5cadd8;_0x2e4c8c[_0x22b0c6][_0x3d1478(0x214)]=_0x5c1582;}),_0x13e280['forEach']((_0x3701b6,_0x192656)=>{var _0xe0b7ed=_0x5cadd8;_0x2e4c8c[_0x192656][_0xe0b7ed(0x2ab)]=_0x3701b6;}),_0x33d9e2['forEach']((_0x410b85,_0x546a38)=>{var _0x3c5a0a=_0x5cadd8;_0x2e4c8c[_0x546a38][_0x3c5a0a(0x2d1)]=_0x410b85;}),_0x2ff245[_0x5cadd8(0x1f5)]((_0x420dd4,_0x3a90cc)=>{var _0x5936ef=_0x5cadd8;_0x2da74f[_0x5936ef(0x1f5)]((_0x5e8d79,_0x4cff68)=>{var _0x2a3083=_0x5936ef;if(_0x5e8d79=='Receiving\x20Area'&&_0x3a90cc==_0x4cff68){var _0x2899e3=_0x420dd4[_0x2a3083(0x241)](0x3);_0x2e4c8c[_0x3a90cc][_0x2a3083(0x285)]=_0x420dd4[0x0],_0x2e4c8c[_0x3a90cc]['from_rack']=_0x420dd4[0x1],_0x2e4c8c[_0x3a90cc][_0x2a3083(0x286)]=0x0,_0x2e4c8c[_0x3a90cc]['from_bin']=0x0,_0x2e4c8c[_0x3a90cc]['from_types']=_0x2a3083(0x20e),_0x2e4c8c[_0x3a90cc][_0x2a3083(0x236)]=_0x2899e3;}else{if(_0x5e8d79=='Shelves'&&_0x3a90cc==_0x4cff68){var _0x2899e3=_0x420dd4[_0x2a3083(0x241)](0x3);_0x2e4c8c[_0x3a90cc][_0x2a3083(0x285)]=_0x420dd4[0x0],_0x2e4c8c[_0x3a90cc][_0x2a3083(0x239)]=_0x420dd4[0x1],_0x2e4c8c[_0x3a90cc]['from_bay']=0x0,_0x2e4c8c[_0x3a90cc][_0x2a3083(0x1e9)]=0x0,_0x2e4c8c[_0x3a90cc]['from_types']='Floor',_0x2e4c8c[_0x3a90cc][_0x2a3083(0x236)]=_0x420dd4[0x5];}else{if(_0x3a90cc==_0x4cff68){var _0x4986a7;if(_0x420dd4[0x4]=='L')_0x4986a7=_0x2a3083(0x281);else _0x420dd4[0x4]=='F'&&(_0x4986a7=_0x2a3083(0x20e));_0x2e4c8c[_0x3a90cc][_0x2a3083(0x285)]=_0x420dd4[0x0],_0x2e4c8c[_0x3a90cc][_0x2a3083(0x239)]=_0x420dd4[0x1],_0x2e4c8c[_0x3a90cc][_0x2a3083(0x286)]=_0x420dd4[0x2],_0x2e4c8c[_0x3a90cc][_0x2a3083(0x1e9)]=_0x420dd4[0x3],_0x2e4c8c[_0x3a90cc][_0x2a3083(0x2c7)]=_0x4986a7,_0x2e4c8c[_0x3a90cc][_0x2a3083(0x236)]=_0x420dd4[0x5];}}}});}),_0x47407e['forEach']((_0x3f4fa2,_0x1cbb7f)=>{var _0x2ae164=_0x5cadd8;_0x2e4c8c[_0x1cbb7f][_0x2ae164(0x1ea)]=_0x3f4fa2;}),_0x242679['forEach']((_0x5b4d60,_0x5ad017)=>{var _0x3614a9=_0x5cadd8;_0x562b67[_0x3614a9(0x1f5)]((_0x1a877a,_0x12e2f4)=>{var _0x3abd50=_0x3614a9;if(_0x1a877a==_0x3abd50(0x211)&&_0x5ad017==_0x12e2f4){var _0x5d1960=_0x5b4d60[_0x3abd50(0x241)](0x3);_0x2e4c8c[_0x5ad017][_0x3abd50(0x248)]=_0x5b4d60[0x0],_0x2e4c8c[_0x5ad017][_0x3abd50(0x2c2)]=_0x5b4d60[0x1],_0x2e4c8c[_0x5ad017][_0x3abd50(0x2af)]=0x0,_0x2e4c8c[_0x5ad017][_0x3abd50(0x279)]=0x0,_0x2e4c8c[_0x5ad017][_0x3abd50(0x26b)]='Floor',_0x2e4c8c[_0x5ad017][_0x3abd50(0x229)]=_0x5d1960;}else{if(_0x1a877a==_0x3abd50(0x1f3)&&_0x5ad017==_0x12e2f4){var _0x5d1960=_0x5b4d60[_0x3abd50(0x241)](0x3);_0x2e4c8c[_0x5ad017][_0x3abd50(0x248)]=_0x5b4d60[0x0],_0x2e4c8c[_0x5ad017]['rack']=_0x5b4d60[0x1],_0x2e4c8c[_0x5ad017][_0x3abd50(0x2af)]=0x0,_0x2e4c8c[_0x5ad017][_0x3abd50(0x279)]=0x0,_0x2e4c8c[_0x5ad017][_0x3abd50(0x26b)]=_0x3abd50(0x20e),_0x2e4c8c[_0x5ad017][_0x3abd50(0x229)]=_0x5b4d60[0x5];}else{if(_0x5ad017==_0x12e2f4){var _0x193181;if(_0x5b4d60[0x4]=='L')_0x193181=_0x3abd50(0x281);else _0x5b4d60[0x4]=='F'&&(_0x193181=_0x3abd50(0x20e));_0x2e4c8c[_0x5ad017]['storage']=_0x5b4d60[0x0],_0x2e4c8c[_0x5ad017][_0x3abd50(0x2c2)]=_0x5b4d60[0x1],_0x2e4c8c[_0x5ad017][_0x3abd50(0x2af)]=_0x5b4d60[0x2],_0x2e4c8c[_0x5ad017][_0x3abd50(0x279)]=_0x5b4d60[0x3],_0x2e4c8c[_0x5ad017]['to_types']=_0x193181,_0x2e4c8c[_0x5ad017]['to_floorlevel']=_0x5b4d60[0x5];}}}});}),_0x2312b0[_0x5cadd8(0x1f5)]((_0x3022a0,_0x8e27c2)=>{var _0x39f16c=_0x5cadd8;_0x2e4c8c[_0x8e27c2][_0x39f16c(0x261)]=_0x3022a0;}),_0x4a4bfe['forEach']((_0x290cd7,_0x3e055b)=>{var _0x2ef09c=_0x5cadd8;_0x2e4c8c[_0x3e055b][_0x2ef09c(0x24b)]=_0x290cd7;}),_0x229028['forEach']((_0x3fecee,_0x19d8d0)=>{var _0x5b4efd=_0x5cadd8;_0x2e4c8c[_0x19d8d0][_0x5b4efd(0x284)]=_0x3fecee;}),_0xcfc4ef[_0x5cadd8(0x1f5)]((_0x1f1c74,_0x14a277)=>{var _0x2b4a7c=_0x5cadd8;_0x2e4c8c[_0x14a277][_0x2b4a7c(0x2b1)]=_0x1f1c74;}),_0x9f6e6e[_0x5cadd8(0x1f5)]((_0x380eb2,_0x186544)=>{var _0x54c621=_0x5cadd8;_0x2e4c8c[_0x186544][_0x54c621(0x27e)]=_0x380eb2;}),_0x6e3b35[_0x5cadd8(0x1f5)]((_0x229c61,_0x4cc2de)=>{var _0x508e43=_0x5cadd8;_0x2e4c8c[_0x4cc2de][_0x508e43(0x2d2)]=_0x229c61;}),_0x5ea2f2[_0x5cadd8(0x1f5)]((_0x5ee806,_0x10512f)=>{_0x2e4c8c[_0x10512f]['batch_code']=_0x5ee806;}),_0x8cc4a7[_0x5cadd8(0x1f5)]((_0x127157,_0x558c0b)=>{var _0x41c6dc=_0x5cadd8;_0x2e4c8c[_0x558c0b][_0x41c6dc(0x2bc)]=_0x127157;}),_0x32404d[_0x5cadd8(0x1f5)]((_0x36fd1e,_0x548bf6)=>{var _0x4f9cc1=_0x5cadd8;_0x2e4c8c[_0x548bf6][_0x4f9cc1(0x26e)]=_0x36fd1e;}),_0xdd2643[_0x5cadd8(0x1f5)]((_0x4272b1,_0xc639b)=>{_0x2e4c8c[_0xc639b]['production_date']=_0x4272b1;}),_0x5b896f[_0x5cadd8(0x1f5)]((_0x3dad11,_0x55922a)=>{var _0x1f2e1b=_0x5cadd8;_0x2e4c8c[_0x55922a][_0x1f2e1b(0x216)]=_0x3dad11;}),_0x2da74f[_0x5cadd8(0x1f5)]((_0x3e7388,_0x1d4ccf)=>{_0x2e4c8c[_0x1d4ccf]['from_room_name']=_0x3e7388;}),_0x562b67[_0x5cadd8(0x1f5)]((_0x32e9e0,_0x5021b8)=>{var _0x3e6d5c=_0x5cadd8;_0x2e4c8c[_0x5021b8][_0x3e6d5c(0x28d)]=_0x32e9e0;});const _0x4842af=_0x2e4c8c[_0x5cadd8(0x21a)](_0x320bdf=>_0x320bdf[_0x5cadd8(0x1ea)]!=='0'&&_0x320bdf[_0x5cadd8(0x1ea)]!==''||_0x320bdf[_0x5cadd8(0x229)]!=='0'&&_0x320bdf[_0x5cadd8(0x229)]!==''),_0x5cd457=new transfers({'date':_0x1dc0a7,'from_warehouse':_0xe9767c,'to_warehouse':_0x8e3785,'product':_0x4842af,'note':_0x10e361,'invoice':_0xa24c7c}),_0x412ce5=await _0x5cd457[_0x5cadd8(0x22a)]();_0x387fbf[_0x5cadd8(0x21d)]('success',_0x5cadd8(0x26c)),_0x43ef1a[_0x5cadd8(0x288)](_0x5cadd8(0x2cb)+_0x412ce5[_0x5cadd8(0x2b4)]);}catch(_0x5c9f72){console[_0x5cadd8(0x24d)](_0x5c9f72),_0x43ef1a['status'](0xc8)[_0x5cadd8(0x265)]({'errorMessage':_0x5c9f72[_0x5cadd8(0x2be)]});}}),router[a0_0x326044(0x282)](a0_0x326044(0x1fc),auth,async(_0x2c5868,_0x298ba7)=>{var _0x144f40=a0_0x326044;try{const {username:_0x7b958,email:_0x494732,role:_0x2e7fe1}=_0x2c5868['user'],_0x23dba1=_0x2c5868[_0x144f40(0x202)],_0x24e11d=await profile[_0x144f40(0x29e)]({'email':_0x23dba1[_0x144f40(0x23d)]}),_0x503834=await master_shop['find']();console[_0x144f40(0x24d)]('master',_0x503834);const _0x566c76=await transfers['findById'](_0x2c5868['params']['id']);let _0x17e54f=new Date(_0x566c76[_0x144f40(0x2bc)]),_0x54e23d=('0'+_0x17e54f[_0x144f40(0x263)]())[_0x144f40(0x241)](-0x2),_0x2c6d19=('0'+(_0x17e54f[_0x144f40(0x23a)]()+0x1))[_0x144f40(0x241)](-0x2),_0x5deffb=_0x17e54f[_0x144f40(0x26a)](),_0x53c62e=_0x5deffb+'-'+_0x2c6d19+'-'+_0x54e23d,_0x3effbb;if(_0x23dba1[_0x144f40(0x1f7)]=='staff'){const _0x47f91b=await staff[_0x144f40(0x29e)]({'email':_0x23dba1[_0x144f40(0x23d)]});_0x3effbb=await warehouse[_0x144f40(0x2cd)]({'status':_0x144f40(0x23f),'name':_0x47f91b[_0x144f40(0x22b)],'warehouse_category':_0x144f40(0x256)});}else _0x3effbb=await warehouse[_0x144f40(0x2cd)]({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0x360348=await warehouse[_0x144f40(0x2d4)]([{'$match':{'name':_0x566c76[_0x144f40(0x2b6)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x144f40(0x233),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x144f40(0x2c1)},'bay':{'$first':_0x144f40(0x26d)},'bin':{'$first':_0x144f40(0x20c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x144f40(0x23e)},'secondary_code':{'$first':_0x144f40(0x247)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x144f40(0x27b)},'expiry_date':{'$first':_0x144f40(0x235)},'production_date':{'$first':_0x144f40(0x2a1)},'room':{'$first':_0x144f40(0x2a6)}}}]);if(_0x503834[0x0][_0x144f40(0x289)]==_0x144f40(0x1fd)){var _0x5c280c=users[_0x144f40(0x1ff)];console[_0x144f40(0x24d)](_0x5c280c);}else{if(_0x503834[0x0][_0x144f40(0x289)]==_0x144f40(0x20d))var _0x5c280c=users[_0x144f40(0x20d)];else{if(_0x503834[0x0]['language']==_0x144f40(0x253))var _0x5c280c=users['German'];else{if(_0x503834[0x0][_0x144f40(0x289)]==_0x144f40(0x299))var _0x5c280c=users[_0x144f40(0x299)];else{if(_0x503834[0x0]['language']==_0x144f40(0x228))var _0x5c280c=users[_0x144f40(0x228)];else{if(_0x503834[0x0][_0x144f40(0x289)]==_0x144f40(0x1f6))var _0x5c280c=users[_0x144f40(0x258)];else{if(_0x503834[0x0]['language']==_0x144f40(0x232))var _0x5c280c=users[_0x144f40(0x232)];else{if(_0x503834[0x0][_0x144f40(0x289)]=='Arabic\x20(ae)')var _0x5c280c=users[_0x144f40(0x25d)];}}}}}}}_0x298ba7[_0x144f40(0x1ed)](_0x144f40(0x260),{'success':_0x2c5868[_0x144f40(0x21d)](_0x144f40(0x264)),'errors':_0x2c5868['flash']('errors'),'role':_0x23dba1,'profile':_0x24e11d,'master_shop':_0x503834,'warehouse':_0x3effbb,'transfer':_0x566c76,'stock':_0x360348,'language':_0x5c280c});}catch(_0x4a69af){console[_0x144f40(0x24d)](_0x4a69af);}}),router['post'](a0_0x326044(0x1fc),auth,async(_0x981a98,_0x3798dc)=>{var _0x217cf4=a0_0x326044;try{const _0x3bc2bb=_0x981a98[_0x217cf4(0x1f1)]['id'],{from_warehouse:_0x4aa39c,FromRoom_name:_0x5af577,to_warehouse:_0xa55950,ToRoom_name:_0x5e135d}=_0x981a98[_0x217cf4(0x290)],_0x1ee742=await transfers['findById']({'_id':_0x3bc2bb}),_0x3fe6c8=_0x1ee742['product']['map'](async _0x522f5a=>{var _0x41e16f=_0x217cf4;if(_0x522f5a[_0x41e16f(0x1ea)]>0x0){var _0x32ee9c=await warehouse['findOne']({'name':_0x1ee742[_0x41e16f(0x2b6)],'room':_0x522f5a['from_room_name'],'warehouse_category':_0x41e16f(0x256)});const _0x17136d=_0x32ee9c[_0x41e16f(0x27d)][_0x41e16f(0x275)](_0x1ddbdc=>{var _0x19ca1f=_0x41e16f;_0x1ddbdc[_0x19ca1f(0x29b)]==_0x522f5a['product_name']&&_0x1ddbdc[_0x19ca1f(0x298)]==_0x522f5a['from_floorlevel']&&_0x1ddbdc[_0x19ca1f(0x2b3)]==_0x522f5a[_0x19ca1f(0x2c7)]&&_0x1ddbdc[_0x19ca1f(0x28e)]==_0x522f5a[_0x19ca1f(0x1e9)]&&_0x1ddbdc[_0x19ca1f(0x259)]==_0x522f5a['from_bay']&&_0x1ddbdc[_0x19ca1f(0x2c2)]==_0x522f5a[_0x19ca1f(0x239)]&&_0x1ddbdc['storage']==_0x522f5a[_0x19ca1f(0x285)]&&_0x1ddbdc['expiry_date']==_0x522f5a[_0x19ca1f(0x2bc)]&&_0x1ddbdc[_0x19ca1f(0x223)]==_0x522f5a[_0x19ca1f(0x223)]&&_0x1ddbdc[_0x19ca1f(0x242)]==_0x522f5a[_0x19ca1f(0x242)]&&_0x1ddbdc[_0x19ca1f(0x1ec)]==_0x522f5a[_0x19ca1f(0x2ab)]&&(_0x1ddbdc['product_stock']=_0x1ddbdc['product_stock']-_0x522f5a['to_quantity']);});}return _0x32ee9c;});Promise[_0x217cf4(0x2aa)](_0x3fe6c8)[_0x217cf4(0x249)](async _0x543172=>{var _0x91f6e3=_0x217cf4;try{for(const _0x433c36 of _0x543172){await _0x433c36['save']();}try{const _0x1bab00=_0x1ee742[_0x91f6e3(0x28f)]['map'](async _0xa90ed0=>{var _0x2e7912=_0x91f6e3;if(_0xa90ed0[_0x2e7912(0x1ea)]>0x0){var _0x486f67=await warehouse['findOne']({'name':_0x1ee742['to_warehouse'],'room':_0xa90ed0[_0x2e7912(0x28d)],'warehouse_category':_0x2e7912(0x256)}),_0x365231=0x0;const _0x2b2e0d=_0x486f67[_0x2e7912(0x27d)]['map'](_0x596a97=>{var _0x4477b0=_0x2e7912;_0x596a97[_0x4477b0(0x29b)]==_0xa90ed0[_0x4477b0(0x29b)]&&_0x596a97['floorlevel']==_0xa90ed0[_0x4477b0(0x229)]&&_0x596a97[_0x4477b0(0x2b3)]==_0xa90ed0[_0x4477b0(0x26b)]&&_0x596a97[_0x4477b0(0x28e)]==_0xa90ed0[_0x4477b0(0x279)]&&_0x596a97['bay']==_0xa90ed0[_0x4477b0(0x2af)]&&_0x596a97['rack']==_0xa90ed0[_0x4477b0(0x2c2)]&&_0x596a97[_0x4477b0(0x248)]==_0xa90ed0[_0x4477b0(0x248)]&&_0x596a97[_0x4477b0(0x2bc)]==_0xa90ed0['expiry_date']&&_0x596a97[_0x4477b0(0x223)]==_0xa90ed0['batch_code']&&_0x596a97[_0x4477b0(0x242)]==_0xa90ed0[_0x4477b0(0x242)]&&_0x596a97[_0x4477b0(0x1ec)]==_0xa90ed0[_0x4477b0(0x2d1)]&&(_0x596a97[_0x4477b0(0x212)]=_0x596a97[_0x4477b0(0x212)]+_0xa90ed0[_0x4477b0(0x1ea)],_0x365231++);});_0x365231=='0'&&(_0x486f67[_0x2e7912(0x27d)]=_0x486f67[_0x2e7912(0x27d)][_0x2e7912(0x2b7)]({'product_name':_0xa90ed0[_0x2e7912(0x29b)],'product_stock':_0xa90ed0[_0x2e7912(0x1ea)],'bay':_0xa90ed0[_0x2e7912(0x2af)],'bin':_0xa90ed0[_0x2e7912(0x279)],'type':_0xa90ed0['to_types'],'floorlevel':_0xa90ed0['to_floorlevel'],'storage':_0xa90ed0[_0x2e7912(0x248)],'rack':_0xa90ed0[_0x2e7912(0x2c2)],'product_code':_0xa90ed0[_0x2e7912(0x284)],'primary_code':_0xa90ed0[_0x2e7912(0x261)],'secondary_code':_0xa90ed0[_0x2e7912(0x24b)],'maxProducts':_0xa90ed0[_0x2e7912(0x2b1)],'storage':_0xa90ed0['storage'],'rack':_0xa90ed0[_0x2e7912(0x2c2)],'expiry_date':_0xa90ed0[_0x2e7912(0x2bc)],'maxPerUnit':_0xa90ed0[_0x2e7912(0x26e)],'batch_code':_0xa90ed0[_0x2e7912(0x223)],'production_date':_0xa90ed0[_0x2e7912(0x242)]}));}return _0x486f67;});Promise['all'](_0x1bab00)[_0x91f6e3(0x249)](async _0x136d93=>{var _0x2d5649=_0x91f6e3;try{for(const _0x130161 of _0x136d93){await warehouse[_0x2d5649(0x22f)]({'_id':_0x130161['_id']},{'$addToSet':{'product_details':{'$each':_0x130161[_0x2d5649(0x27d)]}}});}_0x1ee742[_0x2d5649(0x1e7)]=_0x2d5649(0x2a3);const _0xf26315=await _0x1ee742['save'](),_0x210683=await master_shop[_0x2d5649(0x2cd)](),_0x53674d=await email_settings[_0x2d5649(0x29e)](),_0x5b2ba5=await supervisor_settings[_0x2d5649(0x2cd)]();var _0x4bf03a=_0x1ee742[_0x2d5649(0x28f)],_0x45fb83='',_0x3181c8;for(_0x3181c8 in _0x4bf03a){_0x45fb83+='<tr>'+_0x2d5649(0x1fb)+_0x4bf03a[_0x3181c8][_0x2d5649(0x29b)]+_0x2d5649(0x25c)+_0x2d5649(0x1fb)+_0x4bf03a[_0x3181c8][_0x2d5649(0x284)]+_0x2d5649(0x25c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4bf03a[_0x3181c8][_0x2d5649(0x1ea)]+_0x2d5649(0x25c)+_0x2d5649(0x1fb)+_0x4bf03a[_0x3181c8][_0x2d5649(0x27e)]+_0x2d5649(0x25c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4bf03a[_0x3181c8][_0x2d5649(0x2d2)]+_0x2d5649(0x25c)+_0x2d5649(0x1fb)+_0x1ee742['to_warehouse']+_0x2d5649(0x25c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4bf03a[_0x3181c8][_0x2d5649(0x28d)]+_0x2d5649(0x25c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4bf03a[_0x3181c8][_0x2d5649(0x248)]+_0x4bf03a[_0x3181c8][_0x2d5649(0x2c2)]+_0x4bf03a[_0x3181c8][_0x2d5649(0x2af)]+_0x4bf03a[_0x3181c8][_0x2d5649(0x279)]+_0x4bf03a[_0x3181c8][_0x2d5649(0x26b)][0x0]+_0x4bf03a[_0x3181c8]['to_floorlevel']+_0x2d5649(0x25c),_0x2d5649(0x21e);}let _0x1e9d6e=nodemailer[_0x2d5649(0x2b5)]({'host':_0x53674d[_0x2d5649(0x26f)],'port':Number(_0x53674d[_0x2d5649(0x240)]),'secure':![],'auth':{'user':_0x53674d['email'],'pass':_0x53674d['password']}}),_0x363682={'from':_0x53674d[_0x2d5649(0x23d)],'to':_0x5b2ba5[0x0]['RMSEmail'],'subject':'Transfer\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x2d5649(0x276)+_0x2d5649(0x270)+_0x210683[0x0][_0x2d5649(0x277)],'cid':'logo'}],'html':_0x2d5649(0x22e)+_0x2d5649(0x22c)+'</head><body>'+_0x2d5649(0x220)+_0x2d5649(0x21f)+_0x2d5649(0x220)+_0x2d5649(0x251)+_0x2d5649(0x27c)+_0x2d5649(0x220)+_0x2d5649(0x25f)+_0x210683[0x0][_0x2d5649(0x2a5)]+_0x2d5649(0x254)+_0x2d5649(0x27c)+_0x2d5649(0x27c)+'<hr\x20class=\x22my-3\x22>'+_0x2d5649(0x220)+_0x2d5649(0x271)+_0x2d5649(0x29a)+_0x1ee742[_0x2d5649(0x1ec)]+'\x20'+_0x2d5649(0x24f)+'\x20Order\x20Date\x20:\x20'+_0x1ee742['date']+'\x20'+_0x2d5649(0x250)+'</h5>'+'</div>'+_0x2d5649(0x28a)+_0x2d5649(0x297)+_0x2d5649(0x243)+_0x2d5649(0x267)+_0x2d5649(0x20a)+_0x2d5649(0x273)+_0x2d5649(0x2b2)+_0x2d5649(0x20f)+_0x2d5649(0x25e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2d5649(0x21e)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x45fb83+'\x20'+_0x2d5649(0x25b)+_0x2d5649(0x2bb)+_0x2d5649(0x220)+_0x2d5649(0x1eb)+'<h5>'+_0x210683[0x0][_0x2d5649(0x2a5)]+'</h5>'+_0x2d5649(0x27c)+_0x2d5649(0x27c)+_0x2d5649(0x24c)};_0x1e9d6e[_0x2d5649(0x207)](_0x363682,function(_0x56a391,_0x20d48e){var _0x1febca=_0x2d5649;_0x56a391?(console[_0x1febca(0x24d)](_0x56a391),console[_0x1febca(0x24d)](_0x1febca(0x215))):console[_0x1febca(0x24d)](_0x1febca(0x27a));}),_0x981a98[_0x2d5649(0x21d)](_0x2d5649(0x264),'Transfer\x20Finalize\x20Successfully'),_0x3798dc[_0x2d5649(0x288)](_0x2d5649(0x1f0)+_0xf26315['_id']);}catch(_0x1878ef){console[_0x2d5649(0x262)](_0x1878ef),_0x3798dc['status'](0x1f4)[_0x2d5649(0x265)]({'Perror':_0x2d5649(0x29c),'message':_0x1878ef['message']});}})['catch'](_0x4067f6=>{var _0x35c26e=_0x91f6e3;console[_0x35c26e(0x262)](_0x4067f6),_0x3798dc[_0x35c26e(0x2c9)](0x1f4)[_0x35c26e(0x265)]({'Perror':_0x35c26e(0x292)});});}catch(_0x5ee778){_0x3798dc[_0x91f6e3(0x265)](_0x5ee778);}}catch(_0x4eb693){console[_0x91f6e3(0x262)](_0x4eb693),_0x3798dc[_0x91f6e3(0x2c9)](0x1f4)[_0x91f6e3(0x265)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x4eb693[_0x91f6e3(0x2be)]});}})[_0x217cf4(0x21c)](_0x47aa44=>{var _0x1b633d=_0x217cf4;console[_0x1b633d(0x262)](_0x47aa44),_0x3798dc[_0x1b633d(0x2c9)](0x1f4)['json']({'Merror':_0x1b633d(0x292)});});}catch(_0x3da23e){console[_0x217cf4(0x24d)](_0x3da23e);}});function a0_0x3a32(){var _0xdd0854=['user','30vcYzpS','Enclosed','$product_details.type','Rack\x20E','sendMail','/barcode_scanner2','from_prod_isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.product_name','$product_details.bin','Hindi','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','from_rak','Receiving\x20Area','product_stock','MaxStocks_data2','from_quantity','Error\x20Occurs','prod_cat','$product_details.batch_code','18371881Fslbaf','Rack\x20A','filter','$to_warehouse','catch','flash','</tr>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<div>','Rack\x20B','5GXSzPm','batch_code','Transfer\x20Edit\x20Successfully','Rack\x20D','$date','padStart','French','to_floorlevel','save','warehouse','<html><head><title></title>','DRY\x20STORAGE','<!DOCTYPE\x20html>','updateOne','$product_details.isle','from_prod_level','Chinese','$product_details._id','TRF-','$product_details.expiry_date','from_floorlevel','express','$product_details.storage','from_rack','getMonth','from_prod_qty','Arabic\x20(ae)','email','$product_details.primary_code','Enabled','port','slice','production_date','<tr>','length','7024916hjEEJp','/view','$product_details.secondary_code','storage','then','$product_details.maxProducts','secondary_code','</body></html>','log','$product_details','<span\x20style=\x22float:\x20right;\x22>','</span>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','string','German','\x20</h2>','3599142QVOASA','Raw\x20Materials','staff','Portuguese','bay','$product_details.product_code','</tbody>','</td>','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<h2>\x20','edit_transfer_view','primary_code','error','getDate','success','json','1730705apUJsQ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','../middleware/auth','push','getFullYear','to_types','Product\x20Transfer\x20successfully','$product_details.bay','maxperunit','host','/upload/','<h5\x20style=\x22text-align:\x20left;\x22>','405027dyOKca','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','back','map','/../public','image','$product.to_room_name','to_bin','Email\x20sent\x20successfully','$product_details.rack','</div>','product_details','unit','to_prod_isle','$product_details.floorlevel','Level','get','$product_details.secondary_unit','product_code','from_storage','from_bay','to_warehouse','redirect','language','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/view/:id','/transfer/view','to_room_name','bin','product','body','$product_details.pallet','An\x20error\x20occurred.','findById','/barcode_scanner','errors','$product.from_room_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','floorlevel','Spanish','\x20Order\x20Number\x20:\x20','product_name','An\x20error\x20occurred\x20while\x20saving\x20data.','from_prod_pallet','findOne','master','Router','$product_details.production_date','RoomAssigned','True','ToRoomAssigned','site_title','$room','There\x27s\x20a\x20error\x20in\x20this\x20transaction','1719501tuJtIh','to_prod_pallet','all','from_invoice','max_per_unit','$product_details.level','to_prod_level','to_bay','post','maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','type','_id','createTransport','from_warehouse','concat','$invoice','to_prod_qty','$name','</table>','expiry_date','to_invoice','message','add_transfer','COLD\x20STORAGE','$product_details.product_stock','rack','rak','/view/add_transfer','Return\x20Rooms','2PtgrqG','from_types','from_room','status','to_room','/transfer/preview/','note','find','product_code3','/barcode_scanner3','63WpqJiP','To_invoice','secondary_unit','../models/all_models','aggregate','finalize','primary_unit','from_bin','to_quantity','<strong>\x20Regards\x20</strong>','invoice','render','prod_name','$product_details.unit','/picking_list/PDF_transfer_rm/','params','$_id','Shelves','$from_warehouse','forEach','Portuguese\x20(BR)','role','/CheckingWarehouse','floor','390096FazhaF','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/preview/:id','English\x20(US)','New_Qty_Converted','English','random','Ambient'];a0_0x3a32=function(){return _0xdd0854;};return a0_0x3a32();}function BayBinSelected(_0x1c73d9,_0x44358c){var _0x4db5fc=a0_0x326044,_0x48dee9=[],_0x1e638c=[],_0x324af7=[],_0x2d702d=[],_0x45b042=[],_0x226532=[];let _0x121d7f=[];if(_0x1c73d9==_0x4db5fc(0x22d))switch(_0x44358c){case'Rack\x20A':_0x48dee9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x1e638c=[0x1,0x2],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=[_0x4db5fc(0x281),_0x4db5fc(0x20e)],_0x45b042=['D'],_0x226532=['A'];break;case _0x4db5fc(0x221):_0x48dee9=[0x6,0x5,0x4,0x3,0x2,0x1],_0x1e638c=[0x1,0x2],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=[_0x4db5fc(0x281),'Floor'],_0x45b042=['D'],_0x226532=['B'];break;case _0x4db5fc(0x1f3):_0x48dee9=[0x0],_0x1e638c=[0x0],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=[_0x4db5fc(0x20e)],_0x45b042=['D'],_0x226532=['S'];break;case _0x4db5fc(0x211):_0x48dee9=[0x0],_0x1e638c=[0x0],_0x2d702d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x324af7=[_0x4db5fc(0x20e)],_0x45b042=['D'],_0x226532=['R'];break;}else{if(_0x1c73d9==_0x4db5fc(0x2c0))switch(_0x44358c){case _0x4db5fc(0x219):_0x48dee9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x1e638c=['B','F'],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=[_0x4db5fc(0x281),_0x4db5fc(0x20e)],_0x45b042=['C'],_0x226532=['A'];break;case'Rack\x20B':_0x48dee9=[0x5,0x4,0x3,0x2,0x1],_0x1e638c=['F','B','S'],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=[_0x4db5fc(0x281),_0x4db5fc(0x20e)],_0x45b042=['C'],_0x226532=['B'];break;case'Rack\x20C':_0x48dee9=[0x1,0x2,0x3,0x4,0x5],_0x1e638c=['B','F','S'],_0x2d702d=[0x5,0x4,0x3,0x2,0x1],_0x324af7=[_0x4db5fc(0x281),_0x4db5fc(0x20e)],_0x45b042=['C'],_0x226532=['C'];break;case _0x4db5fc(0x225):_0x48dee9=[0x5,0x4,0x3,0x2,0x1],_0x1e638c=['F','B','S'],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=['Level',_0x4db5fc(0x20e)],_0x45b042=['C'],_0x226532=['D'];break;case _0x4db5fc(0x206):_0x48dee9=[0x4,0x3,0x2,0x1],_0x1e638c=[0x1,0x2],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=[_0x4db5fc(0x281),_0x4db5fc(0x20e)],_0x45b042=['C'],_0x226532=['E'];break;case'Rack\x20F':_0x48dee9=[0x1,0x2,0x3],_0x1e638c=[0x1,0x2],_0x2d702d=[0x1,0x2,0x3,0x4,0x5],_0x324af7=[_0x4db5fc(0x281)],_0x45b042=['C'],_0x226532=['F'];break;}}return{'levels':_0x48dee9,'Isle':_0x1e638c,'rack':_0x2d702d,'type':_0x324af7,'storage':_0x45b042,'rak':_0x226532};}router['get'](a0_0x326044(0x28b),auth,async(_0x21f581,_0x335e99)=>{var _0x58a27a=a0_0x326044;try{const {username:_0xebca3d,email:_0x2629c9,role:_0xffb0c6}=_0x21f581[_0x58a27a(0x202)],_0x45a186=_0x21f581[_0x58a27a(0x202)],_0x4d2d1e=await profile[_0x58a27a(0x29e)]({'email':_0x45a186[_0x58a27a(0x23d)]}),_0xfe837=await master_shop[_0x58a27a(0x2cd)](),_0x3a24f2=await transfers[_0x58a27a(0x293)](_0x21f581[_0x58a27a(0x1f1)]['id']);let _0x229f67;if(_0x45a186[_0x58a27a(0x1f7)]==_0x58a27a(0x257)){const _0x4f5143=await staff[_0x58a27a(0x29e)]({'email':_0x45a186[_0x58a27a(0x23d)]});_0x229f67=await warehouse[_0x58a27a(0x2d4)]([{'$match':{'status':'Enabled','name':_0x4f5143[_0x58a27a(0x22b)],'warehouse_category':_0x58a27a(0x256)}},{'$group':{'_id':_0x58a27a(0x2ba),'name':{'$first':_0x58a27a(0x2ba)}}}]);}else _0x229f67=await warehouse[_0x58a27a(0x2d4)]([{'$match':{'status':_0x58a27a(0x23f),'warehouse_category':_0x58a27a(0x256)}},{'$group':{'_id':_0x58a27a(0x2ba),'name':{'$first':_0x58a27a(0x2ba)}}}]);const _0x16b925=await warehouse[_0x58a27a(0x2d4)]([{'$match':{'name':_0x3a24f2[_0x58a27a(0x2b6)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x58a27a(0x24e)},{'$group':{'_id':_0x58a27a(0x233),'name':{'$first':_0x58a27a(0x20b)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x58a27a(0x26d)},'bin':{'$first':_0x58a27a(0x20c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x58a27a(0x280)},'primary_code':{'$first':_0x58a27a(0x23e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x58a27a(0x238)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x58a27a(0x235)},'production_date':{'$first':_0x58a27a(0x2a1)},'room':{'$first':'$room'}}}]),_0x15bb6c=await product[_0x58a27a(0x2cd)]({}),_0x22fb09=BayBinSelected(_0x3a24f2[_0x58a27a(0x287)],_0x3a24f2['to_room']);if(_0xfe837[0x0][_0x58a27a(0x289)]=='English\x20(US)'){var _0x17df1b=users['English'];console[_0x58a27a(0x24d)](_0x17df1b);}else{if(_0xfe837[0x0][_0x58a27a(0x289)]=='Hindi')var _0x17df1b=users['Hindi'];else{if(_0xfe837[0x0][_0x58a27a(0x289)]==_0x58a27a(0x253))var _0x17df1b=users[_0x58a27a(0x253)];else{if(_0xfe837[0x0][_0x58a27a(0x289)]==_0x58a27a(0x299))var _0x17df1b=users[_0x58a27a(0x299)];else{if(_0xfe837[0x0][_0x58a27a(0x289)]==_0x58a27a(0x228))var _0x17df1b=users['French'];else{if(_0xfe837[0x0][_0x58a27a(0x289)]=='Portuguese\x20(BR)')var _0x17df1b=users[_0x58a27a(0x258)];else{if(_0xfe837[0x0][_0x58a27a(0x289)]=='Chinese')var _0x17df1b=users[_0x58a27a(0x232)];else{if(_0xfe837[0x0][_0x58a27a(0x289)]=='Arabic\x20(ae)')var _0x17df1b=users[_0x58a27a(0x25d)];}}}}}}}_0x335e99[_0x58a27a(0x1ed)]('edit_transfer',{'success':_0x21f581['flash'](_0x58a27a(0x264)),'errors':_0x21f581[_0x58a27a(0x21d)](_0x58a27a(0x295)),'role':_0x45a186,'profile':_0x4d2d1e,'master_shop':_0xfe837,'warehouse':_0x229f67,'transfer':_0x3a24f2,'stock':_0x16b925,'unit':_0x15bb6c,'language':_0x17df1b});}catch(_0x1aa463){console[_0x58a27a(0x24d)](_0x1aa463);}}),router['post']('/view/:id',auth,async(_0x2a7211,_0x2c92b3)=>{var _0x186628=a0_0x326044;try{const _0x38e7c9=_0x2a7211[_0x186628(0x1f1)]['id'],_0x308bb8=await transfers[_0x186628(0x293)](_0x38e7c9);_0x2c92b3[_0x186628(0x265)](_0x2a7211[_0x186628(0x290)]);return;const {date:_0x14740a,from_warehouse:_0x35f5ba,FromRoom_name:_0x5de249,to_warehouse:_0x27affb,ToRoom_name:_0x18b440,prod_name:_0x4fc2f8,from_prod_qty:_0x52a19f,from_prod_level:_0x4c1c98,from_prod_isle:_0x812128,from_prod_pallet:_0x30225c,to_prod_qty:_0x28f801,to_prod_level:_0x49f07c,to_prod_isle:_0x97bd4f,to_prod_pallet:_0x4e53d7,primary_code:_0x452e5e,secondary_code:_0x3759d6,product_code3:_0x58036c,note:_0x5098fa,invoice:_0xbefb5c,expiry_date:_0x46cc19}=_0x2a7211[_0x186628(0x290)];if(typeof _0x4fc2f8=='string')var _0x3cff57=[_0x2a7211[_0x186628(0x290)][_0x186628(0x1ee)]],_0x55f725=[_0x2a7211[_0x186628(0x290)][_0x186628(0x23b)]],_0x2ab6ae=[_0x2a7211[_0x186628(0x290)][_0x186628(0x231)]],_0x1a7cb8=[_0x2a7211[_0x186628(0x290)]['from_prod_isle']],_0x4bebe9=[_0x2a7211[_0x186628(0x290)][_0x186628(0x29d)]],_0x16df6f=[_0x2a7211[_0x186628(0x290)][_0x186628(0x2c7)]],_0x5860cf=[_0x2a7211[_0x186628(0x290)][_0x186628(0x2b9)]],_0x69bd34=[_0x2a7211[_0x186628(0x290)][_0x186628(0x2ae)]],_0x5c7927=[_0x2a7211[_0x186628(0x290)][_0x186628(0x27f)]],_0x1689e4=[_0x2a7211[_0x186628(0x290)][_0x186628(0x2a9)]],_0x929be6=[_0x2a7211['body'][_0x186628(0x26b)]],_0x38a7dd=[_0x2a7211[_0x186628(0x290)][_0x186628(0x248)]],_0x348c4e=[_0x2a7211['body']['rak']],_0x4b77eb=[_0x2a7211['body'][_0x186628(0x261)]],_0x345f12=[_0x2a7211[_0x186628(0x290)][_0x186628(0x24b)]],_0x6e8c63=[_0x2a7211['body'][_0x186628(0x2ce)]],_0x224428=[_0x2a7211[_0x186628(0x290)]['MaxStocks_data2']],_0x367b06=[_0x2a7211[_0x186628(0x290)][_0x186628(0x27e)]],_0x3ea79d=[_0x2a7211[_0x186628(0x290)]['secondary_unit']],_0x249477=[_0x2a7211['body']['batch_code']],_0x134224=[_0x2a7211['body'][_0x186628(0x2bc)]],_0x5b04b0=[_0x2a7211[_0x186628(0x290)][_0x186628(0x285)]],_0x2d09d6=[_0x2a7211['body'][_0x186628(0x210)]];else var _0x3cff57=[..._0x2a7211[_0x186628(0x290)]['prod_name']],_0x38a7dd=[..._0x2a7211[_0x186628(0x290)]['storage']],_0x348c4e=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x2c3)]],_0x16df6f=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x2c7)]],_0x929be6=[..._0x2a7211['body']['to_types']],_0x55f725=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x23b)]],_0x2ab6ae=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x231)]],_0x1a7cb8=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x209)]],_0x4bebe9=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x29d)]],_0x5860cf=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x2b9)]],_0x69bd34=[..._0x2a7211['body'][_0x186628(0x2ae)]],_0x5c7927=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x27f)]],_0x1689e4=[..._0x2a7211['body'][_0x186628(0x2a9)]],_0x4b77eb=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x261)]],_0x345f12=[..._0x2a7211[_0x186628(0x290)]['secondary_code']],_0x6e8c63=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x2ce)]],_0x224428=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x213)]],_0x367b06=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x27e)]],_0x3ea79d=[..._0x2a7211['body'][_0x186628(0x2d2)]],_0x249477=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x223)]],_0x134224=[..._0x2a7211[_0x186628(0x290)]['expiry_date']],_0x5b04b0=[..._0x2a7211[_0x186628(0x290)][_0x186628(0x285)]],_0x2d09d6=[..._0x2a7211['body']['from_rak']];const _0x1ca156=_0x3cff57[_0x186628(0x275)](_0x4aa668=>{return _0x4aa668={'product_name':_0x4aa668};});_0x55f725[_0x186628(0x1f5)]((_0x11946e,_0x58ac6f)=>{_0x1ca156[_0x58ac6f]['from_quantity']=_0x11946e;}),_0x2ab6ae['forEach']((_0x3aeb07,_0x3cb46a)=>{var _0x26265e=_0x186628;_0x1ca156[_0x3cb46a][_0x26265e(0x286)]=_0x3aeb07;}),_0x1a7cb8[_0x186628(0x1f5)]((_0x3e8340,_0x57733e)=>{var _0x19b9d9=_0x186628;_0x1ca156[_0x57733e][_0x19b9d9(0x1e9)]=_0x3e8340;}),_0x4bebe9[_0x186628(0x1f5)]((_0xde3347,_0x1754ae)=>{var _0xfb938=_0x186628;_0x1ca156[_0x1754ae][_0xfb938(0x236)]=_0xde3347;}),_0x5860cf[_0x186628(0x1f5)]((_0x525ef4,_0x1397b3)=>{var _0x17bcd9=_0x186628;_0x1ca156[_0x1397b3][_0x17bcd9(0x1ea)]=_0x525ef4;}),_0x69bd34[_0x186628(0x1f5)]((_0x1c5eaf,_0x3c9129)=>{var _0x3e66b6=_0x186628;_0x1ca156[_0x3c9129][_0x3e66b6(0x2af)]=_0x1c5eaf;}),_0x5c7927[_0x186628(0x1f5)]((_0x5d297d,_0x2a5ef6)=>{_0x1ca156[_0x2a5ef6]['to_bin']=_0x5d297d;}),_0x1689e4[_0x186628(0x1f5)]((_0x5cd7b2,_0x1a79d9)=>{var _0x25d40c=_0x186628;_0x1ca156[_0x1a79d9][_0x25d40c(0x229)]=_0x5cd7b2;}),_0x4b77eb[_0x186628(0x1f5)]((_0x35c4b7,_0x1cb0ee)=>{var _0x444286=_0x186628;_0x1ca156[_0x1cb0ee][_0x444286(0x261)]=_0x35c4b7;}),_0x345f12[_0x186628(0x1f5)]((_0x19c18a,_0x4f7cd3)=>{var _0xce1c35=_0x186628;_0x1ca156[_0x4f7cd3][_0xce1c35(0x24b)]=_0x19c18a;}),_0x6e8c63[_0x186628(0x1f5)]((_0x4360e7,_0x4e62fc)=>{var _0x28c600=_0x186628;_0x1ca156[_0x4e62fc][_0x28c600(0x284)]=_0x4360e7;}),_0x224428[_0x186628(0x1f5)]((_0x7a9595,_0x48aa6a)=>{var _0x108348=_0x186628;_0x1ca156[_0x48aa6a][_0x108348(0x2b1)]=_0x7a9595;}),_0x367b06['forEach']((_0x2d8dd9,_0x2328a7)=>{_0x1ca156[_0x2328a7]['unit']=_0x2d8dd9;}),_0x3ea79d[_0x186628(0x1f5)]((_0x5dfb67,_0x5b4323)=>{var _0x1d18ed=_0x186628;_0x1ca156[_0x5b4323][_0x1d18ed(0x2d2)]=_0x5dfb67;}),_0x249477[_0x186628(0x1f5)]((_0x29fb9e,_0x1c8547)=>{_0x1ca156[_0x1c8547]['batch_code']=_0x29fb9e;}),_0x134224[_0x186628(0x1f5)]((_0x23bb43,_0x297da1)=>{var _0x46bcb3=_0x186628;_0x1ca156[_0x297da1][_0x46bcb3(0x2bc)]=_0x23bb43;}),_0x38a7dd[_0x186628(0x1f5)]((_0x15d7e8,_0x39a5e6)=>{var _0x46e1bf=_0x186628;_0x1ca156[_0x39a5e6][_0x46e1bf(0x248)]=_0x15d7e8;}),_0x348c4e[_0x186628(0x1f5)]((_0x1da0dd,_0xa55e2)=>{var _0xa99989=_0x186628;_0x1ca156[_0xa55e2][_0xa99989(0x2c2)]=_0x1da0dd;}),_0x16df6f[_0x186628(0x1f5)]((_0x4981a9,_0x409811)=>{_0x1ca156[_0x409811]['from_types']=_0x4981a9;}),_0x929be6[_0x186628(0x1f5)]((_0x4ca6d2,_0x50adc5)=>{var _0x34aace=_0x186628;_0x1ca156[_0x50adc5][_0x34aace(0x26b)]=_0x4ca6d2;}),_0x5b04b0[_0x186628(0x1f5)]((_0x3b4e73,_0x12f9c1)=>{var _0x521277=_0x186628;_0x1ca156[_0x12f9c1][_0x521277(0x285)]=_0x3b4e73;}),_0x2d09d6[_0x186628(0x1f5)]((_0x47a5b3,_0x309d09)=>{var _0x4c5019=_0x186628;_0x1ca156[_0x309d09][_0x4c5019(0x239)]=_0x47a5b3;});const _0x5ccc81=_0x1ca156[_0x186628(0x21a)](_0x2c63c0=>_0x2c63c0[_0x186628(0x1ea)]!=='0'&&_0x2c63c0[_0x186628(0x1ea)]!==''||_0x2c63c0['to_floorlevel']!=='0'&&_0x2c63c0['to_floorlevel']!=='');var _0x5abc2d=0x0;_0x5ccc81['forEach'](_0x5a5b3e=>{var _0x24a2fa=_0x186628;parseInt(_0x5a5b3e[_0x24a2fa(0x214)])<parseInt(_0x5a5b3e['to_quantity'])&&_0x5abc2d++;});if(_0x5abc2d!=0x0)return _0x2a7211['flash'](_0x186628(0x295),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2c92b3[_0x186628(0x288)](_0x186628(0x274));const _0x4adb61=await warehouse[_0x186628(0x29e)]({'name':_0x308bb8[_0x186628(0x2b6)],'room':_0x308bb8[_0x186628(0x2c8)]});_0x308bb8[_0x186628(0x28f)][_0x186628(0x1f5)](_0x11a202=>{var _0x599297=_0x186628;if(_0x11a202[_0x599297(0x1ea)]>0x0){const _0x4d46c4=_0x4adb61['product_details'][_0x599297(0x275)](_0x3e37ea=>{var _0x3dde73=_0x599297;_0x3e37ea[_0x3dde73(0x29b)]==_0x11a202['product_name']&&_0x3e37ea[_0x3dde73(0x298)]==_0x11a202[_0x3dde73(0x236)]&&_0x3e37ea[_0x3dde73(0x2b3)]==_0x11a202[_0x3dde73(0x2c7)]&&_0x3e37ea[_0x3dde73(0x28e)]==_0x11a202[_0x3dde73(0x1e9)]&&_0x3e37ea[_0x3dde73(0x259)]==_0x11a202[_0x3dde73(0x286)]&&_0x3e37ea['rack']==_0x11a202[_0x3dde73(0x239)]&&_0x3e37ea['storage']==_0x11a202[_0x3dde73(0x285)]&&(_0x3e37ea[_0x3dde73(0x212)]=parseInt(_0x3e37ea[_0x3dde73(0x212)])+parseInt(_0x11a202[_0x3dde73(0x1ea)]));});}}),await _0x4adb61[_0x186628(0x22a)]();const _0x484130=await warehouse['findOne']({'name':_0x308bb8['to_warehouse'],'room':_0x308bb8[_0x186628(0x2ca)]});_0x308bb8[_0x186628(0x28f)][_0x186628(0x1f5)](_0x179b82=>{var _0x218446=_0x186628;if(_0x179b82[_0x218446(0x1ea)]>0x0){const _0x58b129=_0x484130[_0x218446(0x27d)]['map'](_0x50fe10=>{var _0x74c05d=_0x218446;_0x50fe10['product_name']==_0x179b82[_0x74c05d(0x29b)]&&_0x50fe10[_0x74c05d(0x298)]==_0x179b82[_0x74c05d(0x229)]&&_0x50fe10[_0x74c05d(0x2b3)]==_0x179b82[_0x74c05d(0x26b)]&&_0x50fe10[_0x74c05d(0x28e)]==_0x179b82[_0x74c05d(0x279)]&&_0x50fe10[_0x74c05d(0x259)]==_0x179b82[_0x74c05d(0x2af)]&&_0x50fe10['rack']==_0x179b82[_0x74c05d(0x2c2)]&&_0x50fe10[_0x74c05d(0x248)]==_0x179b82[_0x74c05d(0x248)]&&(_0x50fe10[_0x74c05d(0x212)]=parseInt(_0x50fe10[_0x74c05d(0x212)])-parseInt(_0x179b82[_0x74c05d(0x1ea)]));});}}),await _0x484130[_0x186628(0x22a)](),_0x308bb8['date']=_0x14740a,_0x308bb8[_0x186628(0x2b6)]=_0x35f5ba,_0x308bb8[_0x186628(0x287)]=_0x27affb,_0x308bb8[_0x186628(0x28f)]=_0x5ccc81,_0x308bb8[_0x186628(0x2cc)]=_0x5098fa,_0x308bb8[_0x186628(0x1ec)]=_0xbefb5c;const _0x30f815=await _0x308bb8['save']();console[_0x186628(0x24d)](_0x30f815);const _0x471283=await warehouse['findOne']({'name':_0x35f5ba,'room':_0x5de249});_0x30f815[_0x186628(0x28f)][_0x186628(0x1f5)](_0x83ae90=>{var _0x483f36=_0x186628;if(_0x83ae90[_0x483f36(0x1ea)]>0x0){const _0x9e0d0d=_0x471283[_0x483f36(0x27d)][_0x483f36(0x275)](_0x5f1268=>{var _0x17b2dd=_0x483f36;_0x5f1268[_0x17b2dd(0x29b)]==_0x83ae90[_0x17b2dd(0x29b)]&&_0x5f1268[_0x17b2dd(0x298)]==_0x83ae90[_0x17b2dd(0x236)]&&_0x5f1268['type']==_0x83ae90[_0x17b2dd(0x2c7)]&&_0x5f1268['bin']==_0x83ae90[_0x17b2dd(0x1e9)]&&_0x5f1268['bay']==_0x83ae90['from_bay']&&_0x5f1268[_0x17b2dd(0x2c2)]==_0x83ae90[_0x17b2dd(0x239)]&&_0x5f1268['storage']==_0x83ae90[_0x17b2dd(0x285)]&&(_0x5f1268[_0x17b2dd(0x212)]=parseInt(_0x5f1268['product_stock'])-parseInt(_0x83ae90['to_quantity']));});}}),await _0x471283['save']();const _0x4d3086=await warehouse['findOne']({'name':_0x27affb,'room':_0x18b440});_0x30f815[_0x186628(0x28f)][_0x186628(0x1f5)](_0x1d3a87=>{var _0x14db98=_0x186628;if(_0x1d3a87[_0x14db98(0x1ea)]>0x0){var _0x45028d=0x0;const _0x2868b6=_0x4d3086[_0x14db98(0x27d)][_0x14db98(0x275)](_0x394f5e=>{var _0x43404b=_0x14db98;_0x394f5e[_0x43404b(0x29b)]==_0x1d3a87[_0x43404b(0x29b)]&&_0x394f5e[_0x43404b(0x298)]==_0x1d3a87[_0x43404b(0x229)]&&_0x394f5e[_0x43404b(0x2b3)]==_0x1d3a87[_0x43404b(0x26b)]&&_0x394f5e['bin']==_0x1d3a87[_0x43404b(0x279)]&&_0x394f5e['bay']==_0x1d3a87['to_bay']&&_0x394f5e[_0x43404b(0x2c2)]==_0x1d3a87[_0x43404b(0x2c2)]&&_0x394f5e[_0x43404b(0x248)]==_0x1d3a87[_0x43404b(0x248)]&&(_0x394f5e[_0x43404b(0x212)]=parseInt(_0x394f5e[_0x43404b(0x212)])+parseInt(_0x1d3a87[_0x43404b(0x1ea)]),_0x45028d++);});_0x45028d=='0'&&(_0x4d3086[_0x14db98(0x27d)]=_0x4d3086[_0x14db98(0x27d)]['concat']({'product_name':_0x1d3a87[_0x14db98(0x29b)],'product_stock':_0x1d3a87[_0x14db98(0x1ea)],'bay':_0x1d3a87['to_bay'],'bin':_0x1d3a87[_0x14db98(0x279)],'type':_0x1d3a87['to_types'],'floorlevel':_0x1d3a87[_0x14db98(0x229)],'storage':_0x1d3a87[_0x14db98(0x248)],'rack':_0x1d3a87[_0x14db98(0x2c2)],'product_code':_0x1d3a87['product_code'],'primary_code':_0x1d3a87[_0x14db98(0x261)],'secondary_code':_0x1d3a87[_0x14db98(0x24b)],'maxProducts':_0x1d3a87[_0x14db98(0x2b1)],'storage':_0x1d3a87[_0x14db98(0x248)],'rack':_0x1d3a87['rack']}));}}),await _0x4d3086[_0x186628(0x22a)](),_0x2a7211['flash'](_0x186628(0x264),_0x186628(0x224)),_0x2c92b3[_0x186628(0x288)](_0x186628(0x28c));}catch(_0x334e81){console[_0x186628(0x24d)](_0x334e81);}}),router['post'](a0_0x326044(0x294),async(_0xef540e,_0x14e99d)=>{var _0x4efd0c=a0_0x326044;const {FromWareHouse:_0x1ec348,FromRoom:_0x322de4,ToWarehouse:_0x2f6b8a,ToRoom:_0x6db9b6,primary_code:_0x25390b,Roomslist:_0x20b4b8}=_0xef540e[_0x4efd0c(0x290)],_0x5dc456=_0x20b4b8['split'](','),_0x333a18=[];async function _0x25c11c(_0x13c9ef){var _0x43908d=_0x4efd0c;const _0x1f0d64=await warehouse[_0x43908d(0x2d4)]([{'$match':{'name':_0x1ec348,'room':_0x13c9ef}},{'$unwind':_0x43908d(0x24e)},{'$match':{'product_details.primary_code':_0x25390b}},{'$group':{'_id':_0x43908d(0x233),'name':{'$first':_0x43908d(0x20b)},'instock':{'$first':_0x43908d(0x2c1)},'primary_code':{'$first':_0x43908d(0x23e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x43908d(0x25a)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x43908d(0x205)},'pallet':{'$first':_0x43908d(0x280)},'unit':{'$first':_0x43908d(0x1ef)},'secondary_unit':{'$first':_0x43908d(0x283)},'storage':{'$first':_0x43908d(0x238)},'rack':{'$first':_0x43908d(0x27b)},'expiry_date':{'$first':_0x43908d(0x235)},'production_date':{'$first':_0x43908d(0x2a1)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x43908d(0x2a6)},'maxProducts':{'$first':_0x43908d(0x24a)}}}]),_0x493a36=await warehouse[_0x43908d(0x2d4)]([{'$match':{'name':_0x1ec348,'room':_0x13c9ef}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x25390b}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x43908d(0x20b)},'instock':{'$first':_0x43908d(0x2c1)},'primary_code':{'$first':_0x43908d(0x23e)},'secondary_code':{'$first':_0x43908d(0x247)},'product_code':{'$first':_0x43908d(0x25a)},'level':{'$first':_0x43908d(0x26d)},'isle':{'$first':_0x43908d(0x20c)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x43908d(0x280)},'unit':{'$first':_0x43908d(0x1ef)},'secondary_unit':{'$first':_0x43908d(0x283)},'storage':{'$first':_0x43908d(0x238)},'rack':{'$first':_0x43908d(0x27b)},'expiry_date':{'$first':_0x43908d(0x235)},'production_date':{'$first':_0x43908d(0x2a1)},'batch_code':{'$first':_0x43908d(0x217)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x43908d(0x2a6)},'maxProducts':{'$first':_0x43908d(0x24a)}}}]);if(_0x1f0d64[_0x43908d(0x244)]>0x0)_0x333a18['push'](_0x1f0d64);else _0x493a36[_0x43908d(0x244)]>0x0&&_0x333a18[_0x43908d(0x269)](_0x493a36);}const _0x57be87=_0x5dc456['map'](_0x15db49=>_0x25c11c(_0x15db49));await Promise['all'](_0x57be87),_0x14e99d[_0x4efd0c(0x265)](_0x333a18);}),router[a0_0x326044(0x2b0)](a0_0x326044(0x208),async(_0x41e62b,_0x1675a9)=>{var _0x1bb13f=a0_0x326044;try{const {FromWareHouse:_0x33a97b,FromRoom:_0x432ee0,ToWarehouse:_0x36b148,ToRoom:_0x5d6f40,secondary_code:_0x143c81}=_0x41e62b[_0x1bb13f(0x290)],_0x4c238a=await warehouse[_0x1bb13f(0x2d4)]([{'$match':{'name':_0x33a97b}},{'$unwind':_0x1bb13f(0x24e)},{'$match':{'product_details.secondary_code':_0x143c81}},{'$group':{'_id':_0x1bb13f(0x233),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1bb13f(0x247)},'product_code':{'$first':_0x1bb13f(0x25a)},'instock':{'$first':_0x1bb13f(0x2c1)},'warehouse':{'$first':_0x1bb13f(0x2ba)},'level':{'$first':_0x1bb13f(0x2ad)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x1bb13f(0x24a)},'unit':{'$first':'$product_details.unit'}}}]);_0x1675a9['status'](0xc8)[_0x1bb13f(0x265)](_0x4c238a);}catch(_0x41373a){_0x1675a9[_0x1bb13f(0x2c9)](0x194)[_0x1bb13f(0x265)]({'message':_0x41373a['message']});}}),router['post'](a0_0x326044(0x2cf),async(_0x5d51eb,_0x59513c)=>{var _0x1525a1=a0_0x326044;try{const {FromWareHouse:_0x8d2eb0,FromRoom:_0x4a7507,ToWarehouse:_0x113d92,ToRoom:_0x307903,product_code:_0x5f4109}=_0x5d51eb[_0x1525a1(0x290)],_0x3c9fcb=await warehouse['aggregate']([{'$match':{'name':_0x8d2eb0}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x5f4109}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x1525a1(0x23e)},'secondary_code':{'$first':_0x1525a1(0x247)},'product_code':{'$first':_0x1525a1(0x25a)},'instock':{'$first':_0x1525a1(0x2c1)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x1525a1(0x230)},'pallet':{'$first':_0x1525a1(0x291)},'maxProducts':{'$first':_0x1525a1(0x24a)},'unit':{'$first':_0x1525a1(0x1ef)}}}]);_0x59513c['status'](0xc8)[_0x1525a1(0x265)](_0x3c9fcb);}catch(_0x4555ba){_0x59513c[_0x1525a1(0x2c9)](0x194)['json']({'message':_0x4555ba[_0x1525a1(0x2be)]});}}),router['post'](a0_0x326044(0x1f8),async(_0x22c06b,_0x4a06e6)=>{var _0x57f3db=a0_0x326044;const {level:_0x384f8d,isle:_0x2cb991,pallet:_0x1ce354,warehouses:_0x32c8c5,room:_0x49ed5f}=_0x22c06b[_0x57f3db(0x290)];try{const _0xc668c=await warehouse[_0x57f3db(0x2d4)]([{'$match':{'name':_0x32c8c5,'room':_0x49ed5f}},{'$unwind':_0x57f3db(0x24e)},{'$match':{'product_details.level':parseInt(_0x384f8d),'product_details.isle':_0x2cb991,'product_details.pallet':parseInt(_0x1ce354)}},{'$group':{'_id':_0x57f3db(0x233),'name':{'$first':_0x57f3db(0x20b)},'product_stock':{'$first':_0x57f3db(0x2c1)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x57f3db(0x230)},'pallet':{'$first':_0x57f3db(0x291)},'maxProducts':{'$first':_0x57f3db(0x24a)}}}]);_0x4a06e6['status'](0xc8)[_0x57f3db(0x265)](_0xc668c);}catch(_0x94ede1){_0x4a06e6['status'](0x194)[_0x57f3db(0x265)]({'message':_0x94ede1[_0x57f3db(0x2be)]});}}),module['exports']=router;