function a0_0x2a4f(_0x48f398,_0x33159e){var _0x4c29ce=a0_0x4c29();return a0_0x2a4f=function(_0x2a4f7b,_0x2c36bd){_0x2a4f7b=_0x2a4f7b-0x195;var _0x3bcbf8=_0x4c29ce[_0x2a4f7b];return _0x3bcbf8;},a0_0x2a4f(_0x48f398,_0x33159e);}var a0_0x289c97=a0_0x2a4f;(function(_0x82662b,_0x2db013){var _0xd3ae90=a0_0x2a4f,_0x52f1a9=_0x82662b();while(!![]){try{var _0x3b0d40=-parseInt(_0xd3ae90(0x1a8))/0x1*(-parseInt(_0xd3ae90(0x220))/0x2)+-parseInt(_0xd3ae90(0x239))/0x3+parseInt(_0xd3ae90(0x196))/0x4+parseInt(_0xd3ae90(0x1d4))/0x5+parseInt(_0xd3ae90(0x217))/0x6+parseInt(_0xd3ae90(0x270))/0x7+-parseInt(_0xd3ae90(0x1e6))/0x8*(parseInt(_0xd3ae90(0x1c1))/0x9);if(_0x3b0d40===_0x2db013)break;else _0x52f1a9['push'](_0x52f1a9['shift']());}catch(_0x13788f){_0x52f1a9['push'](_0x52f1a9['shift']());}}}(a0_0x4c29,0x9beea));const express=require(a0_0x289c97(0x1bf)),app=express(),router=express[a0_0x289c97(0x1fb)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x289c97(0x208)),users=require(a0_0x289c97(0x277)),nodemailer=require('nodemailer');router[a0_0x289c97(0x247)](a0_0x289c97(0x1ff),auth,async(_0x5f51e1,_0x103078)=>{var _0x28ea8a=a0_0x289c97;try{const {username:_0x2af54d,email:_0x2d8055,role:_0x5a3e36}=_0x5f51e1[_0x28ea8a(0x253)],_0xde64fc=_0x5f51e1[_0x28ea8a(0x253)],_0x5b720d=await profile[_0x28ea8a(0x1f2)]({'email':_0xde64fc['email']}),_0x569072=await master_shop[_0x28ea8a(0x278)]();console[_0x28ea8a(0x1f0)](_0x28ea8a(0x219),_0x569072);let _0x222321;if(_0xde64fc[_0x28ea8a(0x1cd)]=='staff'){const _0x172df5=await staff[_0x28ea8a(0x1f2)]({'email':_0xde64fc[_0x28ea8a(0x22c)]});_0x222321=await transfers['find']({'from_warehouse':_0x172df5['warehouse']});}else _0x222321=await transfers['aggregate']([{'$unwind':_0x28ea8a(0x19d)},{'$group':{'_id':_0x28ea8a(0x1cf),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x28ea8a(0x22a)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x28ea8a(0x1f8)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x28ea8a(0x1ef)},'isAllowEdit':{'$first':_0x28ea8a(0x275)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x569072[0x0][_0x28ea8a(0x23f)]=='English\x20(US)'){var _0x4dd94a=users[_0x28ea8a(0x26e)];console[_0x28ea8a(0x1f0)](_0x4dd94a);}else{if(_0x569072[0x0][_0x28ea8a(0x23f)]==_0x28ea8a(0x254))var _0x4dd94a=users['Hindi'];else{if(_0x569072[0x0][_0x28ea8a(0x23f)]==_0x28ea8a(0x23d))var _0x4dd94a=users[_0x28ea8a(0x23d)];else{if(_0x569072[0x0]['language']==_0x28ea8a(0x197))var _0x4dd94a=users[_0x28ea8a(0x197)];else{if(_0x569072[0x0]['language']==_0x28ea8a(0x279))var _0x4dd94a=users[_0x28ea8a(0x279)];else{if(_0x569072[0x0][_0x28ea8a(0x23f)]==_0x28ea8a(0x1a7))var _0x4dd94a=users[_0x28ea8a(0x26d)];else{if(_0x569072[0x0][_0x28ea8a(0x23f)]==_0x28ea8a(0x1be))var _0x4dd94a=users[_0x28ea8a(0x1be)];else{if(_0x569072[0x0][_0x28ea8a(0x23f)]=='Arabic\x20(ae)')var _0x4dd94a=users[_0x28ea8a(0x199)];}}}}}}}_0x103078[_0x28ea8a(0x21f)](_0x28ea8a(0x1db),{'success':_0x5f51e1[_0x28ea8a(0x1c7)](_0x28ea8a(0x201)),'errors':_0x5f51e1[_0x28ea8a(0x1c7)](_0x28ea8a(0x226)),'role':_0xde64fc,'profile':_0x5b720d,'master_shop':_0x569072,'transfer':_0x222321,'language':_0x4dd94a});}catch(_0x572b43){console[_0x28ea8a(0x1f0)](_0x572b43);}});async function getRandom8DigitNumber(){var _0x2ed186=a0_0x289c97;const _0xf2eed5=0x989680,_0x471a60=0x5f5e0ff,_0x331029=Math['floor'](Math[_0x2ed186(0x21c)]()*(_0x471a60-_0xf2eed5+0x1))+_0xf2eed5;var _0x1100f4;const _0x3e290f=await transfers[_0x2ed186(0x1f2)]({'invoice':_0x2ed186(0x230)+_0x331029});return _0x3e290f&&_0x3e290f[_0x2ed186(0x1ac)]>0x0?_0x1100f4=_0x2ed186(0x230)+_0x331029:_0x1100f4='TRF-'+_0x331029,_0x1100f4;}router[a0_0x289c97(0x247)](a0_0x289c97(0x1e7),auth,async(_0x173b37,_0x44afff)=>{var _0xbf48e3=a0_0x289c97;try{const {username:_0xb1c268,email:_0x240686,role:_0x8003f}=_0x173b37[_0xbf48e3(0x253)],_0x93c901=_0x173b37[_0xbf48e3(0x253)],_0x1f3c75=await profile[_0xbf48e3(0x1f2)]({'email':_0x93c901[_0xbf48e3(0x22c)]}),_0x1042ca=await master_shop[_0xbf48e3(0x278)]();console[_0xbf48e3(0x1f0)](_0xbf48e3(0x219),_0x1042ca);let _0xfa333a;if(_0x93c901['role']==_0xbf48e3(0x251)){const _0x670afa=await staff[_0xbf48e3(0x1f2)]({'email':_0x93c901[_0xbf48e3(0x22c)]});_0xfa333a=await warehouse[_0xbf48e3(0x265)]([{'$match':{'status':'Enabled','name':_0x670afa['warehouse'],'warehouse_category':_0xbf48e3(0x23e)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0xfa333a=await warehouse[_0xbf48e3(0x265)]([{'$match':{'status':_0xbf48e3(0x1f3),'warehouse_category':_0xbf48e3(0x23e)}},{'$group':{'_id':_0xbf48e3(0x224),'name':{'$first':'$name'}}}]);var _0x130c36=['Ambient',_0xbf48e3(0x19e),_0xbf48e3(0x232)];const _0x5ac320=await transfers[_0xbf48e3(0x278)]({}),_0x5e1a96=_0x5ac320[_0xbf48e3(0x1ac)]+0x1,_0x2e0782=_0xbf48e3(0x230)+_0x5e1a96['toString']()[_0xbf48e3(0x1d2)](0x5,'0');if(_0x1042ca[0x0][_0xbf48e3(0x23f)]==_0xbf48e3(0x244)){var _0x2b313b=users[_0xbf48e3(0x26e)];console[_0xbf48e3(0x1f0)](_0x2b313b);}else{if(_0x1042ca[0x0]['language']=='Hindi')var _0x2b313b=users['Hindi'];else{if(_0x1042ca[0x0]['language']==_0xbf48e3(0x23d))var _0x2b313b=users[_0xbf48e3(0x23d)];else{if(_0x1042ca[0x0][_0xbf48e3(0x23f)]==_0xbf48e3(0x197))var _0x2b313b=users[_0xbf48e3(0x197)];else{if(_0x1042ca[0x0][_0xbf48e3(0x23f)]==_0xbf48e3(0x279))var _0x2b313b=users[_0xbf48e3(0x279)];else{if(_0x1042ca[0x0][_0xbf48e3(0x23f)]==_0xbf48e3(0x1a7))var _0x2b313b=users[_0xbf48e3(0x26d)];else{if(_0x1042ca[0x0][_0xbf48e3(0x23f)]==_0xbf48e3(0x1be))var _0x2b313b=users[_0xbf48e3(0x1be)];else{if(_0x1042ca[0x0]['language']==_0xbf48e3(0x243))var _0x2b313b=users[_0xbf48e3(0x199)];}}}}}}}const _0x18c118=getRandom8DigitNumber();_0x18c118[_0xbf48e3(0x241)](_0x492af0=>{var _0x480678=_0xbf48e3;_0x44afff[_0x480678(0x21f)](_0x480678(0x248),{'success':_0x173b37[_0x480678(0x1c7)](_0x480678(0x201)),'errors':_0x173b37[_0x480678(0x1c7)]('errors'),'role':_0x93c901,'profile':_0x1f3c75,'master_shop':_0x1042ca,'warehouse':_0xfa333a,'language':_0x2b313b,'rooms_data':_0x130c36,'invoice':_0x492af0});})['catch'](_0x3197b3=>{var _0x4fbe9c=_0xbf48e3;_0x173b37['flash'](_0x4fbe9c(0x226),_0x4fbe9c(0x264)),_0x44afff['redirect'](_0x4fbe9c(0x22d));});}catch(_0x33c425){console[_0xbf48e3(0x1f0)](_0x33c425);}}),router['post'](a0_0x289c97(0x1e7),auth,async(_0x39a1f4,_0x34f0f7)=>{var _0x4dd3d6=a0_0x289c97;try{console[_0x4dd3d6(0x1f0)](_0x39a1f4['body']);const {date:_0x2c75dc,from_warehouse:_0xa5a796,FromRoom_name:_0x41a5e8,to_warehouse:_0x4060dc,ToRoom_name:_0x446ffb,prod_name:_0x227f3c,from_prod_qty:_0x2d862d,from_prod_level:_0x1580e1,from_prod_isle:_0x30c3b8,from_prod_pallet:_0x58be2a,to_prod_qty:_0x558aff,to_prod_level:_0x37bba7,to_prod_isle:_0x3a6dca,to_prod_pallet:_0x1fe4e7,primary_code:_0x485ef7,secondary_code:_0x42ac66,product_code3:_0x49a8fc,note:_0x31fec1,MaxStocks_data2:_0x4994dd,invoice:_0x2602f0,expiry_date:_0x43036e}=_0x39a1f4['body'];if(typeof _0x227f3c==_0x4dd3d6(0x1d5))var _0x99b73e=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x25d)]],_0xbc5386=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x26b)]],_0x3e4336=[_0x39a1f4['body']['from_prod_level']],_0x10d33b=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1ed)]],_0x5b9169=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x21a)]],_0x599832=[_0x39a1f4[_0x4dd3d6(0x1ab)]['primary_code']],_0x2c0820=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x271)]],_0x2e7af9=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x203)]],_0x44ce13=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x209)]],_0x322d3f=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x222)]],_0xf18371=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x22b)]],_0x526815=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x19c)]],_0x23184f=[_0x39a1f4['body'][_0x4dd3d6(0x225)]],_0x3c05a5=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1fa)]],_0x26500c=[_0x39a1f4[_0x4dd3d6(0x1ab)]['production_date']],_0xd7a423=[_0x39a1f4[_0x4dd3d6(0x1ab)]['prod_cat']],_0x44a1e9=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1d1)]],_0x112741=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1ca)]],_0x3a7766=[_0x39a1f4[_0x4dd3d6(0x1ab)]['from_invoice']],_0x341cb1=[_0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1c3)]];else var _0x99b73e=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x25d)]],_0xbc5386=[..._0x39a1f4[_0x4dd3d6(0x1ab)]['from_prod_qty']],_0x3e4336=[..._0x39a1f4['body'][_0x4dd3d6(0x1b3)]],_0x10d33b=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1ed)]],_0x5b9169=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x21a)]],_0x599832=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x24e)]],_0x2c0820=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x271)]],_0x2e7af9=[..._0x39a1f4[_0x4dd3d6(0x1ab)]['product_code3']],_0x44ce13=[..._0x39a1f4[_0x4dd3d6(0x1ab)]['MaxStocks_data2']],_0x322d3f=[..._0x39a1f4['body']['primary_unit']],_0xf18371=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x22b)]],_0x526815=[..._0x39a1f4['body'][_0x4dd3d6(0x19c)]],_0x23184f=[..._0x39a1f4[_0x4dd3d6(0x1ab)]['expiry_date']],_0x3c05a5=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1fa)]],_0x26500c=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x215)]],_0xd7a423=[..._0x39a1f4['body'][_0x4dd3d6(0x1f9)]],_0x44a1e9=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1d1)]],_0x112741=[..._0x39a1f4[_0x4dd3d6(0x1ab)][_0x4dd3d6(0x1ca)]],_0x3a7766=[..._0x39a1f4['body'][_0x4dd3d6(0x1a0)]],_0x341cb1=[..._0x39a1f4[_0x4dd3d6(0x1ab)]['to_invoice']];const _0x423fae=_0x99b73e[_0x4dd3d6(0x221)](_0x384277=>{return _0x384277={'product_name':_0x384277};});_0xbc5386[_0x4dd3d6(0x1b4)]((_0x6a89a6,_0x52e3e)=>{var _0x26fd0f=_0x4dd3d6;_0x423fae[_0x52e3e][_0x26fd0f(0x266)]=_0x6a89a6;}),_0x3a7766['forEach']((_0x5dfdc6,_0x1bba6d)=>{_0x423fae[_0x1bba6d]['from_invoice']=_0x5dfdc6;}),_0x341cb1[_0x4dd3d6(0x1b4)]((_0x4c17a4,_0x118cb6)=>{var _0x71637b=_0x4dd3d6;_0x423fae[_0x118cb6][_0x71637b(0x1a1)]=_0x4c17a4;}),_0x3e4336['forEach']((_0x18189a,_0x40cf20)=>{var _0x3c3b99=_0x4dd3d6;_0x44a1e9[_0x3c3b99(0x1b4)]((_0x3ed9ba,_0x3b44cb)=>{var _0xff66b3=_0x3c3b99;if(_0x3ed9ba==_0xff66b3(0x1c0)&&_0x40cf20==_0x3b44cb){var _0x57b3d7=_0x18189a[_0xff66b3(0x26f)](0x3);_0x423fae[_0x40cf20][_0xff66b3(0x214)]=_0x18189a[0x0],_0x423fae[_0x40cf20][_0xff66b3(0x26c)]=_0x18189a[0x1],_0x423fae[_0x40cf20][_0xff66b3(0x216)]=0x0,_0x423fae[_0x40cf20][_0xff66b3(0x1b8)]=0x0,_0x423fae[_0x40cf20][_0xff66b3(0x1e0)]=_0xff66b3(0x1e2),_0x423fae[_0x40cf20]['from_floorlevel']=_0x57b3d7;}else{if(_0x3ed9ba==_0xff66b3(0x211)&&_0x40cf20==_0x3b44cb){var _0x57b3d7=_0x18189a['slice'](0x3);_0x423fae[_0x40cf20][_0xff66b3(0x214)]=_0x18189a[0x0],_0x423fae[_0x40cf20][_0xff66b3(0x26c)]=_0x18189a[0x1],_0x423fae[_0x40cf20]['from_bay']=0x0,_0x423fae[_0x40cf20][_0xff66b3(0x1b8)]=0x0,_0x423fae[_0x40cf20][_0xff66b3(0x1e0)]='Floor',_0x423fae[_0x40cf20][_0xff66b3(0x1a5)]=_0x18189a[0x5];}else{if(_0x40cf20==_0x3b44cb){var _0x4d8ab9;if(_0x18189a[0x4]=='L')_0x4d8ab9=_0xff66b3(0x1f1);else _0x18189a[0x4]=='F'&&(_0x4d8ab9=_0xff66b3(0x1e2));_0x423fae[_0x40cf20][_0xff66b3(0x214)]=_0x18189a[0x0],_0x423fae[_0x40cf20][_0xff66b3(0x26c)]=_0x18189a[0x1],_0x423fae[_0x40cf20][_0xff66b3(0x216)]=_0x18189a[0x2],_0x423fae[_0x40cf20]['from_bin']=_0x18189a[0x3],_0x423fae[_0x40cf20][_0xff66b3(0x1e0)]=_0x4d8ab9,_0x423fae[_0x40cf20][_0xff66b3(0x1a5)]=_0x18189a[0x5];}}}});}),_0x10d33b[_0x4dd3d6(0x1b4)]((_0x27bd86,_0x265052)=>{var _0x114d60=_0x4dd3d6;_0x423fae[_0x265052][_0x114d60(0x1e1)]=_0x27bd86;}),_0x5b9169[_0x4dd3d6(0x1b4)]((_0x35c6e5,_0x31880e)=>{var _0x52a8b8=_0x4dd3d6;_0x112741[_0x52a8b8(0x1b4)]((_0x277f0b,_0x138606)=>{var _0x3f116b=_0x52a8b8;if(_0x277f0b=='Receiving\x20Area'&&_0x31880e==_0x138606){var _0x1e44cb=_0x35c6e5['slice'](0x3);_0x423fae[_0x31880e][_0x3f116b(0x1fe)]=_0x35c6e5[0x0],_0x423fae[_0x31880e]['rack']=_0x35c6e5[0x1],_0x423fae[_0x31880e][_0x3f116b(0x198)]=0x0,_0x423fae[_0x31880e]['to_bin']=0x0,_0x423fae[_0x31880e]['to_types']=_0x3f116b(0x1e2),_0x423fae[_0x31880e][_0x3f116b(0x26a)]=_0x1e44cb;}else{if(_0x277f0b==_0x3f116b(0x211)&&_0x31880e==_0x138606){var _0x1e44cb=_0x35c6e5[_0x3f116b(0x26f)](0x3);_0x423fae[_0x31880e][_0x3f116b(0x1fe)]=_0x35c6e5[0x0],_0x423fae[_0x31880e]['rack']=_0x35c6e5[0x1],_0x423fae[_0x31880e][_0x3f116b(0x198)]=0x0,_0x423fae[_0x31880e][_0x3f116b(0x267)]=0x0,_0x423fae[_0x31880e][_0x3f116b(0x1c2)]='Floor',_0x423fae[_0x31880e]['to_floorlevel']=_0x35c6e5[0x5];}else{if(_0x31880e==_0x138606){var _0x84c6f3;if(_0x35c6e5[0x4]=='L')_0x84c6f3=_0x3f116b(0x1f1);else _0x35c6e5[0x4]=='F'&&(_0x84c6f3=_0x3f116b(0x1e2));_0x423fae[_0x31880e]['storage']=_0x35c6e5[0x0],_0x423fae[_0x31880e][_0x3f116b(0x1b1)]=_0x35c6e5[0x1],_0x423fae[_0x31880e]['to_bay']=_0x35c6e5[0x2],_0x423fae[_0x31880e]['to_bin']=_0x35c6e5[0x3],_0x423fae[_0x31880e][_0x3f116b(0x1c2)]=_0x84c6f3,_0x423fae[_0x31880e]['to_floorlevel']=_0x35c6e5[0x5];}}}});}),_0x599832[_0x4dd3d6(0x1b4)]((_0x12f48f,_0x25d8b8)=>{var _0xfb9e73=_0x4dd3d6;_0x423fae[_0x25d8b8][_0xfb9e73(0x24e)]=_0x12f48f;}),_0x2c0820[_0x4dd3d6(0x1b4)]((_0x4835ce,_0x409c34)=>{var _0x2b9e26=_0x4dd3d6;_0x423fae[_0x409c34][_0x2b9e26(0x271)]=_0x4835ce;}),_0x2e7af9['forEach']((_0x536ec6,_0x505b28)=>{var _0x6e2a86=_0x4dd3d6;_0x423fae[_0x505b28][_0x6e2a86(0x1a2)]=_0x536ec6;}),_0x44ce13[_0x4dd3d6(0x1b4)]((_0x84df13,_0x5f3c4a)=>{var _0x3f9f1f=_0x4dd3d6;_0x423fae[_0x5f3c4a][_0x3f9f1f(0x1e8)]=_0x84df13;}),_0x322d3f['forEach']((_0x216258,_0x5c0f02)=>{var _0x2c939a=_0x4dd3d6;_0x423fae[_0x5c0f02][_0x2c939a(0x1f7)]=_0x216258;}),_0xf18371[_0x4dd3d6(0x1b4)]((_0x45ea28,_0x56a911)=>{var _0x4bad8c=_0x4dd3d6;_0x423fae[_0x56a911][_0x4bad8c(0x22b)]=_0x45ea28;}),_0x526815['forEach']((_0x6b0642,_0x1dc98c)=>{var _0x20a43b=_0x4dd3d6;_0x423fae[_0x1dc98c][_0x20a43b(0x19c)]=_0x6b0642;}),_0x23184f[_0x4dd3d6(0x1b4)]((_0x341418,_0x49c41e)=>{var _0x4d9b6d=_0x4dd3d6;_0x423fae[_0x49c41e][_0x4d9b6d(0x225)]=_0x341418;}),_0x3c05a5['forEach']((_0x55a2ed,_0x17c4ab)=>{var _0x74f1b4=_0x4dd3d6;_0x423fae[_0x17c4ab][_0x74f1b4(0x25b)]=_0x55a2ed;}),_0x26500c[_0x4dd3d6(0x1b4)]((_0x37a3a0,_0xac1d11)=>{var _0x54d268=_0x4dd3d6;_0x423fae[_0xac1d11][_0x54d268(0x215)]=_0x37a3a0;}),_0xd7a423[_0x4dd3d6(0x1b4)]((_0x2dd19c,_0x22d62c)=>{var _0x424cf4=_0x4dd3d6;_0x423fae[_0x22d62c][_0x424cf4(0x1f9)]=_0x2dd19c;}),_0x44a1e9[_0x4dd3d6(0x1b4)]((_0x2edfb1,_0x251af3)=>{var _0x56e376=_0x4dd3d6;_0x423fae[_0x251af3][_0x56e376(0x242)]=_0x2edfb1;}),_0x112741[_0x4dd3d6(0x1b4)]((_0x30fabe,_0x17cdff)=>{_0x423fae[_0x17cdff]['to_room_name']=_0x30fabe;});const _0x1e2299=_0x423fae['filter'](_0x4221dd=>_0x4221dd['to_quantity']!=='0'&&_0x4221dd['to_quantity']!==''||_0x4221dd[_0x4dd3d6(0x26a)]!=='0'&&_0x4221dd[_0x4dd3d6(0x26a)]!==''),_0x520ad8=new transfers({'date':_0x2c75dc,'from_warehouse':_0xa5a796,'to_warehouse':_0x4060dc,'product':_0x1e2299,'note':_0x31fec1,'invoice':_0x2602f0}),_0x4c771c=await _0x520ad8[_0x4dd3d6(0x1aa)]();_0x39a1f4[_0x4dd3d6(0x1c7)](_0x4dd3d6(0x201),_0x4dd3d6(0x23b)),_0x34f0f7[_0x4dd3d6(0x1ad)](_0x4dd3d6(0x20a)+_0x4c771c[_0x4dd3d6(0x218)]);}catch(_0x3db0af){console[_0x4dd3d6(0x1f0)](_0x3db0af),_0x34f0f7[_0x4dd3d6(0x1df)](0xc8)[_0x4dd3d6(0x272)]({'errorMessage':_0x3db0af[_0x4dd3d6(0x20f)]});}}),router[a0_0x289c97(0x247)](a0_0x289c97(0x262),auth,async(_0x2f2ad7,_0x50c4ea)=>{var _0x56b870=a0_0x289c97;try{const {username:_0x19dcd9,email:_0x5aaa26,role:_0x10cbb1}=_0x2f2ad7[_0x56b870(0x253)],_0x573faf=_0x2f2ad7[_0x56b870(0x253)],_0x6cf68d=await profile[_0x56b870(0x1f2)]({'email':_0x573faf[_0x56b870(0x22c)]}),_0x734ba3=await master_shop[_0x56b870(0x278)]();console[_0x56b870(0x1f0)](_0x56b870(0x219),_0x734ba3);const _0x219fe8=await transfers[_0x56b870(0x1b0)](_0x2f2ad7[_0x56b870(0x207)]['id']);let _0x5521e2=new Date(_0x219fe8[_0x56b870(0x225)]),_0x45c4c3=('0'+_0x5521e2[_0x56b870(0x21e)]())[_0x56b870(0x26f)](-0x2),_0x45ba9b=('0'+(_0x5521e2[_0x56b870(0x1bd)]()+0x1))[_0x56b870(0x26f)](-0x2),_0x5bad84=_0x5521e2['getFullYear'](),_0x54f228=_0x5bad84+'-'+_0x45ba9b+'-'+_0x45c4c3,_0x28630a;if(_0x573faf['role']=='staff'){const _0x592ac9=await staff[_0x56b870(0x1f2)]({'email':_0x573faf['email']});_0x28630a=await warehouse[_0x56b870(0x278)]({'status':_0x56b870(0x1f3),'name':_0x592ac9['warehouse'],'warehouse_category':_0x56b870(0x23e)});}else _0x28630a=await warehouse[_0x56b870(0x278)]({'status':_0x56b870(0x1f3),'warehouse_category':_0x56b870(0x23e)});const _0x1d29ca=await warehouse[_0x56b870(0x265)]([{'$match':{'name':_0x219fe8['from_warehouse']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x56b870(0x1cb),'name':{'$first':_0x56b870(0x1bb)},'product_stock':{'$first':_0x56b870(0x19b)},'bay':{'$first':_0x56b870(0x1c6)},'bin':{'$first':_0x56b870(0x25f)},'type':{'$first':_0x56b870(0x1a4)},'floorlevel':{'$first':_0x56b870(0x206)},'primary_code':{'$first':_0x56b870(0x261)},'secondary_code':{'$first':_0x56b870(0x25c)},'product_code':{'$first':_0x56b870(0x260)},'storage':{'$first':_0x56b870(0x1ec)},'rack':{'$first':_0x56b870(0x1b7)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x56b870(0x202)},'room':{'$first':_0x56b870(0x1da)}}}]);if(_0x734ba3[0x0][_0x56b870(0x23f)]==_0x56b870(0x244)){var _0x510764=users[_0x56b870(0x26e)];console[_0x56b870(0x1f0)](_0x510764);}else{if(_0x734ba3[0x0]['language']==_0x56b870(0x254))var _0x510764=users[_0x56b870(0x254)];else{if(_0x734ba3[0x0][_0x56b870(0x23f)]==_0x56b870(0x23d))var _0x510764=users[_0x56b870(0x23d)];else{if(_0x734ba3[0x0][_0x56b870(0x23f)]==_0x56b870(0x197))var _0x510764=users['Spanish'];else{if(_0x734ba3[0x0][_0x56b870(0x23f)]==_0x56b870(0x279))var _0x510764=users[_0x56b870(0x279)];else{if(_0x734ba3[0x0][_0x56b870(0x23f)]==_0x56b870(0x1a7))var _0x510764=users[_0x56b870(0x26d)];else{if(_0x734ba3[0x0][_0x56b870(0x23f)]=='Chinese')var _0x510764=users[_0x56b870(0x1be)];else{if(_0x734ba3[0x0]['language']==_0x56b870(0x243))var _0x510764=users[_0x56b870(0x199)];}}}}}}}_0x50c4ea[_0x56b870(0x21f)](_0x56b870(0x1f5),{'success':_0x2f2ad7['flash'](_0x56b870(0x201)),'errors':_0x2f2ad7[_0x56b870(0x1c7)](_0x56b870(0x226)),'role':_0x573faf,'profile':_0x6cf68d,'master_shop':_0x734ba3,'warehouse':_0x28630a,'transfer':_0x219fe8,'stock':_0x1d29ca,'language':_0x510764});}catch(_0x498be6){console[_0x56b870(0x1f0)](_0x498be6);}}),router[a0_0x289c97(0x228)]('/preview/:id',auth,async(_0x3d8785,_0x332032)=>{var _0x5ddfab=a0_0x289c97;try{const _0x29f7ff=_0x3d8785[_0x5ddfab(0x207)]['id'],{from_warehouse:_0x5987f3,FromRoom_name:_0x1c6f72,to_warehouse:_0x2efff4,ToRoom_name:_0x330ca5}=_0x3d8785[_0x5ddfab(0x1ab)],_0xef68f3=await transfers['findById']({'_id':_0x29f7ff}),_0x706c1b=_0xef68f3[_0x5ddfab(0x257)]['map'](async _0x2c2b70=>{var _0x37ced2=_0x5ddfab;if(_0x2c2b70[_0x37ced2(0x1e1)]>0x0){var _0x3dedaa=await warehouse['findOne']({'name':_0xef68f3[_0x37ced2(0x213)],'room':_0x2c2b70[_0x37ced2(0x242)],'warehouse_category':_0x37ced2(0x23e)});const _0x324919=_0x3dedaa[_0x37ced2(0x1f6)]['map'](_0x3f7a9d=>{var _0x493d29=_0x37ced2;_0x3f7a9d[_0x493d29(0x1c5)]==_0x2c2b70[_0x493d29(0x1c5)]&&_0x3f7a9d[_0x493d29(0x276)]==_0x2c2b70[_0x493d29(0x1a5)]&&_0x3f7a9d[_0x493d29(0x1a9)]==_0x2c2b70[_0x493d29(0x1e0)]&&_0x3f7a9d[_0x493d29(0x24b)]==_0x2c2b70[_0x493d29(0x1b8)]&&_0x3f7a9d['bay']==_0x2c2b70[_0x493d29(0x216)]&&_0x3f7a9d['rack']==_0x2c2b70[_0x493d29(0x26c)]&&_0x3f7a9d[_0x493d29(0x1fe)]==_0x2c2b70[_0x493d29(0x214)]&&_0x3f7a9d[_0x493d29(0x225)]==_0x2c2b70[_0x493d29(0x225)]&&_0x3f7a9d[_0x493d29(0x19c)]==_0x2c2b70[_0x493d29(0x19c)]&&_0x3f7a9d[_0x493d29(0x215)]==_0x2c2b70[_0x493d29(0x215)]&&_0x3f7a9d['invoice']==_0x2c2b70['from_invoice']&&(_0x3f7a9d['product_stock']=_0x3f7a9d[_0x493d29(0x1a6)]-_0x2c2b70[_0x493d29(0x1e1)]);});}return _0x3dedaa;});Promise[_0x5ddfab(0x1a3)](_0x706c1b)['then'](async _0x3862be=>{var _0x373e34=_0x5ddfab;try{for(const _0x280ab2 of _0x3862be){await _0x280ab2[_0x373e34(0x1aa)]();}try{const _0x19421b=_0xef68f3['product']['map'](async _0x19e9c8=>{var _0x47bd40=_0x373e34;if(_0x19e9c8[_0x47bd40(0x1e1)]>0x0){var _0x251608=await warehouse[_0x47bd40(0x1f2)]({'name':_0xef68f3[_0x47bd40(0x231)],'room':_0x19e9c8[_0x47bd40(0x1fc)],'warehouse_category':_0x47bd40(0x23e)}),_0x108df7=0x0;const _0x1959cc=_0x251608[_0x47bd40(0x1f6)][_0x47bd40(0x221)](_0x49d161=>{var _0x1b69ff=_0x47bd40;_0x49d161[_0x1b69ff(0x1c5)]==_0x19e9c8[_0x1b69ff(0x1c5)]&&_0x49d161[_0x1b69ff(0x276)]==_0x19e9c8[_0x1b69ff(0x26a)]&&_0x49d161[_0x1b69ff(0x1a9)]==_0x19e9c8['to_types']&&_0x49d161[_0x1b69ff(0x24b)]==_0x19e9c8[_0x1b69ff(0x267)]&&_0x49d161['bay']==_0x19e9c8[_0x1b69ff(0x198)]&&_0x49d161[_0x1b69ff(0x1b1)]==_0x19e9c8[_0x1b69ff(0x1b1)]&&_0x49d161[_0x1b69ff(0x1fe)]==_0x19e9c8[_0x1b69ff(0x1fe)]&&_0x49d161[_0x1b69ff(0x225)]==_0x19e9c8[_0x1b69ff(0x225)]&&_0x49d161[_0x1b69ff(0x19c)]==_0x19e9c8[_0x1b69ff(0x19c)]&&_0x49d161[_0x1b69ff(0x215)]==_0x19e9c8[_0x1b69ff(0x215)]&&_0x49d161[_0x1b69ff(0x23a)]==_0x19e9c8['To_invoice']&&(_0x49d161[_0x1b69ff(0x1a6)]=_0x49d161[_0x1b69ff(0x1a6)]+_0x19e9c8[_0x1b69ff(0x1e1)],_0x108df7++);});_0x108df7=='0'&&(_0x251608[_0x47bd40(0x1f6)]=_0x251608[_0x47bd40(0x1f6)][_0x47bd40(0x240)]({'product_name':_0x19e9c8[_0x47bd40(0x1c5)],'product_stock':_0x19e9c8[_0x47bd40(0x1e1)],'bay':_0x19e9c8[_0x47bd40(0x198)],'bin':_0x19e9c8[_0x47bd40(0x267)],'type':_0x19e9c8['to_types'],'floorlevel':_0x19e9c8[_0x47bd40(0x26a)],'storage':_0x19e9c8[_0x47bd40(0x1fe)],'rack':_0x19e9c8[_0x47bd40(0x1b1)],'product_code':_0x19e9c8['product_code'],'primary_code':_0x19e9c8[_0x47bd40(0x24e)],'secondary_code':_0x19e9c8['secondary_code'],'maxProducts':_0x19e9c8[_0x47bd40(0x1e8)],'storage':_0x19e9c8['storage'],'rack':_0x19e9c8[_0x47bd40(0x1b1)],'expiry_date':_0x19e9c8[_0x47bd40(0x225)],'maxPerUnit':_0x19e9c8[_0x47bd40(0x25b)],'batch_code':_0x19e9c8[_0x47bd40(0x19c)],'production_date':_0x19e9c8['production_date']}));}return _0x251608;});Promise[_0x373e34(0x1a3)](_0x19421b)[_0x373e34(0x241)](async _0x415944=>{var _0x3e25dc=_0x373e34;try{for(const _0x18d9f5 of _0x415944){await warehouse[_0x3e25dc(0x1b6)]({'_id':_0x18d9f5[_0x3e25dc(0x218)]},{'$addToSet':{'product_details':{'$each':_0x18d9f5['product_details']}}});}_0xef68f3['finalize']=_0x3e25dc(0x24d);const _0x42eb48=await _0xef68f3[_0x3e25dc(0x1aa)](),_0x4454e2=await master_shop['find'](),_0x347f3f=await email_settings['findOne'](),_0x33cb59=await supervisor_settings[_0x3e25dc(0x278)]();var _0x2eb828=_0xef68f3[_0x3e25dc(0x257)],_0x20791e='',_0x3aa624;for(_0x3aa624 in _0x2eb828){_0x20791e+='<tr>'+_0x3e25dc(0x273)+_0x2eb828[_0x3aa624][_0x3e25dc(0x1c5)]+_0x3e25dc(0x200)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2eb828[_0x3aa624]['product_code']+_0x3e25dc(0x200)+_0x3e25dc(0x273)+_0x2eb828[_0x3aa624]['to_quantity']+'</td>'+_0x3e25dc(0x273)+_0x2eb828[_0x3aa624][_0x3e25dc(0x1f7)]+_0x3e25dc(0x200)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2eb828[_0x3aa624]['secondary_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xef68f3['to_warehouse']+'</td>'+_0x3e25dc(0x273)+_0x2eb828[_0x3aa624][_0x3e25dc(0x1fc)]+_0x3e25dc(0x200)+_0x3e25dc(0x273)+_0x2eb828[_0x3aa624][_0x3e25dc(0x1fe)]+_0x2eb828[_0x3aa624][_0x3e25dc(0x1b1)]+_0x2eb828[_0x3aa624][_0x3e25dc(0x198)]+_0x2eb828[_0x3aa624]['to_bin']+_0x2eb828[_0x3aa624][_0x3e25dc(0x1c2)][0x0]+_0x2eb828[_0x3aa624]['to_floorlevel']+_0x3e25dc(0x200),_0x3e25dc(0x1dc);}let _0x41365d=nodemailer[_0x3e25dc(0x1ce)]({'host':_0x347f3f['host'],'port':Number(_0x347f3f[_0x3e25dc(0x1e3)]),'secure':![],'auth':{'user':_0x347f3f[_0x3e25dc(0x22c)],'pass':_0x347f3f['password']}}),_0x2539a3={'from':_0x347f3f[_0x3e25dc(0x22c)],'to':_0x33cb59[0x0][_0x3e25dc(0x1ea)],'subject':_0x3e25dc(0x19a),'attachments':[{'filename':_0x3e25dc(0x258),'path':__dirname+'/../public'+_0x3e25dc(0x210)+_0x4454e2[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x3e25dc(0x259)+'</head><body>'+_0x3e25dc(0x27a)+_0x3e25dc(0x20d)+_0x3e25dc(0x27a)+_0x3e25dc(0x1e4)+'</div>'+_0x3e25dc(0x27a)+'<h2>\x20'+_0x4454e2[0x0][_0x3e25dc(0x1d6)]+_0x3e25dc(0x1af)+_0x3e25dc(0x195)+'</div>'+_0x3e25dc(0x20c)+'<div>'+_0x3e25dc(0x22e)+_0x3e25dc(0x1d7)+_0xef68f3[_0x3e25dc(0x23a)]+'\x20'+_0x3e25dc(0x21b)+_0x3e25dc(0x1b2)+_0xef68f3[_0x3e25dc(0x1eb)]+'\x20'+_0x3e25dc(0x25e)+_0x3e25dc(0x223)+'</div>'+_0x3e25dc(0x20e)+_0x3e25dc(0x268)+_0x3e25dc(0x252)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x3e25dc(0x237)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3e25dc(0x235)+_0x3e25dc(0x1d0)+_0x3e25dc(0x205)+'</tr>'+_0x3e25dc(0x24f)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x20791e+'\x20'+_0x3e25dc(0x227)+_0x3e25dc(0x24c)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x4454e2[0x0][_0x3e25dc(0x1d6)]+_0x3e25dc(0x223)+_0x3e25dc(0x195)+'</div>'+'</body></html>'};_0x41365d['sendMail'](_0x2539a3,function(_0x21aee3,_0x17d832){var _0x4b15cd=_0x3e25dc;_0x21aee3?(console[_0x4b15cd(0x1f0)](_0x21aee3),console[_0x4b15cd(0x1f0)]('Error\x20Occurs')):console[_0x4b15cd(0x1f0)](_0x4b15cd(0x263));}),_0x3d8785[_0x3e25dc(0x1c7)](_0x3e25dc(0x201),_0x3e25dc(0x236)),_0x332032[_0x3e25dc(0x1ad)](_0x3e25dc(0x1d9)+_0x42eb48['_id']);}catch(_0x37c171){console[_0x3e25dc(0x1dd)](_0x37c171),_0x332032[_0x3e25dc(0x1df)](0x1f4)[_0x3e25dc(0x272)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x37c171['message']});}})[_0x373e34(0x245)](_0x104207=>{var _0x42c56a=_0x373e34;console[_0x42c56a(0x1dd)](_0x104207),_0x332032['status'](0x1f4)[_0x42c56a(0x272)]({'Perror':_0x42c56a(0x269)});});}catch(_0x5a6e70){_0x332032['json'](_0x5a6e70);}}catch(_0x2528ce){console[_0x373e34(0x1dd)](_0x2528ce),_0x332032[_0x373e34(0x1df)](0x1f4)[_0x373e34(0x272)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x2528ce[_0x373e34(0x20f)]});}})['catch'](_0x2650c3=>{var _0x47cb8c=_0x5ddfab;console[_0x47cb8c(0x1dd)](_0x2650c3),_0x332032['status'](0x1f4)[_0x47cb8c(0x272)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x162b1d){console['log'](_0x162b1d);}});function BayBinSelected(_0xadb695,_0x2a2f52){var _0xe65772=a0_0x289c97,_0x1f72c0=[],_0x71d22c=[],_0x47e853=[],_0x5803a0=[],_0x52d6f2=[],_0xc4b95a=[];let _0x4632fe=[];if(_0xadb695==_0xe65772(0x238))switch(_0x2a2f52){case _0xe65772(0x1ba):_0x1f72c0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x71d22c=[0x1,0x2],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=[_0xe65772(0x1f1),_0xe65772(0x1e2)],_0x52d6f2=['D'],_0xc4b95a=['A'];break;case _0xe65772(0x1e9):_0x1f72c0=[0x6,0x5,0x4,0x3,0x2,0x1],_0x71d22c=[0x1,0x2],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=[_0xe65772(0x1f1),'Floor'],_0x52d6f2=['D'],_0xc4b95a=['B'];break;case _0xe65772(0x211):_0x1f72c0=[0x0],_0x71d22c=[0x0],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=[_0xe65772(0x1e2)],_0x52d6f2=['D'],_0xc4b95a=['S'];break;case _0xe65772(0x1c0):_0x1f72c0=[0x0],_0x71d22c=[0x0],_0x5803a0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x47e853=[_0xe65772(0x1e2)],_0x52d6f2=['D'],_0xc4b95a=['R'];break;}else{if(_0xadb695=='COLD\x20STORAGE')switch(_0x2a2f52){case _0xe65772(0x1ba):_0x1f72c0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x71d22c=['B','F'],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=['Level',_0xe65772(0x1e2)],_0x52d6f2=['C'],_0xc4b95a=['A'];break;case _0xe65772(0x1e9):_0x1f72c0=[0x5,0x4,0x3,0x2,0x1],_0x71d22c=['F','B','S'],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=[_0xe65772(0x1f1),'Floor'],_0x52d6f2=['C'],_0xc4b95a=['B'];break;case _0xe65772(0x1c8):_0x1f72c0=[0x1,0x2,0x3,0x4,0x5],_0x71d22c=['B','F','S'],_0x5803a0=[0x5,0x4,0x3,0x2,0x1],_0x47e853=[_0xe65772(0x1f1),_0xe65772(0x1e2)],_0x52d6f2=['C'],_0xc4b95a=['C'];break;case _0xe65772(0x1e5):_0x1f72c0=[0x5,0x4,0x3,0x2,0x1],_0x71d22c=['F','B','S'],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=['Level',_0xe65772(0x1e2)],_0x52d6f2=['C'],_0xc4b95a=['D'];break;case _0xe65772(0x1b5):_0x1f72c0=[0x4,0x3,0x2,0x1],_0x71d22c=[0x1,0x2],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=[_0xe65772(0x1f1),_0xe65772(0x1e2)],_0x52d6f2=['C'],_0xc4b95a=['E'];break;case'Rack\x20F':_0x1f72c0=[0x1,0x2,0x3],_0x71d22c=[0x1,0x2],_0x5803a0=[0x1,0x2,0x3,0x4,0x5],_0x47e853=[_0xe65772(0x1f1)],_0x52d6f2=['C'],_0xc4b95a=['F'];break;}}return{'levels':_0x1f72c0,'Isle':_0x71d22c,'rack':_0x5803a0,'type':_0x47e853,'storage':_0x52d6f2,'rak':_0xc4b95a};}function a0_0x4c29(){var _0x337223=['transfer','</tr>','error','to_room','status','from_types','to_quantity','Floor','port','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Rack\x20D','2356632GUmfEY','/view/add_transfer','maxProducts','Rack\x20B','RMSEmail','date','$product_details.storage','New_Qty_Converted','$product_details','$finalize','log','Level','findOne','Enabled','rak','edit_transfer_view','product_details','unit','$product.from_room_name','prod_cat','max_per_unit','Router','to_room_name','push','storage','/view','</td>','success','$product_details.production_date','product_code3','$product_details.maxPerUnit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.floorlevel','params','../middleware/auth','MaxStocks_data2','/transfer/preview/','$product_details.maxProducts','<hr\x20class=\x22my-3\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','message','/upload/','Shelves','from_room','from_warehouse','from_storage','production_date','from_bay','7486308CyVUrK','_id','master','to_prod_level','<span\x20style=\x22float:\x20right;\x22>','random','to_prod_isle','getDate','render','18vhxDHS','map','primary_unit','</h5>','$name','expiry_date','errors','</tbody>','post','$product_details.isle','$from_warehouse','secondary_unit','email','/transfer/view','<h5\x20style=\x22text-align:\x20left;\x22>','note','TRF-','to_warehouse','Return\x20Rooms','to_prod_pallet','/barcode_scanner3','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Transfer\x20Finalize\x20Successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','DRY\x20STORAGE','2754954aYTLiI','invoice','Product\x20Transfer\x20successfully','/view/:id','German','Raw\x20Materials','language','concat','then','from_room_name','Arabic\x20(ae)','English\x20(US)','catch','filter','get','add_transfer','$product_details.pallet','$product_details.level','bin','</table>','True','primary_code','</thead>','$product_details.batch_code','staff','<tr>','user','Hindi','bay','$product_details.expiry_date','product','Logo.png','<html><head><title></title>','warehouse','maxperunit','$product_details.secondary_code','prod_name','</span>','$product_details.bin','$product_details.product_code','$product_details.primary_code','/preview/:id','Email\x20sent\x20successfully','There\x27s\x20a\x20error\x20in\x20this\x20transaction','aggregate','from_quantity','to_bin','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','An\x20error\x20occurred.','to_floorlevel','from_prod_qty','from_rack','Portuguese','English','slice','587902NDgWXX','secondary_code','json','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','back','$isAllowEdit','floorlevel','../public/language/languages.json','find','French','<div>','</div>','2695824ASoHWP','Spanish','to_bay','Arabic','Transfer\x20Mail','$product_details.product_stock','batch_code','$product','Enclosed','$product_details.secondary_unit','from_invoice','To_invoice','product_code','all','$product_details.type','from_floorlevel','product_stock','Portuguese\x20(BR)','56180eFnUvh','type','save','body','length','redirect','/CheckingWarehouse','\x20</h2>','findById','rack','\x20Order\x20Date\x20:\x20','from_prod_level','forEach','Rack\x20E','updateOne','$product_details.rack','from_bin','from_rak','Rack\x20A','$product_details.product_name','to_prod_qty','getMonth','Chinese','express','Receiving\x20Area','54BxpYzI','to_types','to_invoice','edit_transfer','product_name','$product_details.bay','flash','Rack\x20C','$product_details.unit','ToRoomAssigned','$product_details._id','split','role','createTransport','$_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','RoomAssigned','padStart','from_prod_isle','4066050TOrIER','string','site_title','\x20Order\x20Number\x20:\x20','from_prod_pallet','/picking_list/PDF_transfer_rm/','$room'];a0_0x4c29=function(){return _0x337223;};return a0_0x4c29();}router[a0_0x289c97(0x247)](a0_0x289c97(0x23c),auth,async(_0x3453aa,_0xa545ee)=>{var _0x3e5d3d=a0_0x289c97;try{const {username:_0x4846a5,email:_0x4f334c,role:_0x4b1059}=_0x3453aa[_0x3e5d3d(0x253)],_0x4cbd6e=_0x3453aa[_0x3e5d3d(0x253)],_0x4229af=await profile[_0x3e5d3d(0x1f2)]({'email':_0x4cbd6e['email']}),_0x175fbd=await master_shop[_0x3e5d3d(0x278)](),_0x4001fa=await transfers[_0x3e5d3d(0x1b0)](_0x3453aa[_0x3e5d3d(0x207)]['id']);let _0x43f567;if(_0x4cbd6e[_0x3e5d3d(0x1cd)]==_0x3e5d3d(0x251)){const _0x45cb8a=await staff[_0x3e5d3d(0x1f2)]({'email':_0x4cbd6e[_0x3e5d3d(0x22c)]});_0x43f567=await warehouse[_0x3e5d3d(0x265)]([{'$match':{'status':_0x3e5d3d(0x1f3),'name':_0x45cb8a[_0x3e5d3d(0x25a)],'warehouse_category':_0x3e5d3d(0x23e)}},{'$group':{'_id':_0x3e5d3d(0x224),'name':{'$first':_0x3e5d3d(0x224)}}}]);}else _0x43f567=await warehouse[_0x3e5d3d(0x265)]([{'$match':{'status':_0x3e5d3d(0x1f3),'warehouse_category':_0x3e5d3d(0x23e)}},{'$group':{'_id':_0x3e5d3d(0x224),'name':{'$first':_0x3e5d3d(0x224)}}}]);const _0x55987a=await warehouse['aggregate']([{'$match':{'name':_0x4001fa['from_warehouse'],'warehouse_category':_0x3e5d3d(0x23e)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3e5d3d(0x1cb),'name':{'$first':_0x3e5d3d(0x1bb)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3e5d3d(0x1c6)},'bin':{'$first':_0x3e5d3d(0x25f)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3e5d3d(0x206)},'primary_code':{'$first':_0x3e5d3d(0x261)},'secondary_code':{'$first':_0x3e5d3d(0x25c)},'product_code':{'$first':_0x3e5d3d(0x260)},'storage':{'$first':_0x3e5d3d(0x1ec)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3e5d3d(0x256)},'production_date':{'$first':_0x3e5d3d(0x202)},'room':{'$first':_0x3e5d3d(0x1da)}}}]),_0xd2b5b0=await product['find']({}),_0x5d2923=BayBinSelected(_0x4001fa[_0x3e5d3d(0x231)],_0x4001fa['to_room']);if(_0x175fbd[0x0][_0x3e5d3d(0x23f)]==_0x3e5d3d(0x244)){var _0x324807=users['English'];console[_0x3e5d3d(0x1f0)](_0x324807);}else{if(_0x175fbd[0x0][_0x3e5d3d(0x23f)]==_0x3e5d3d(0x254))var _0x324807=users['Hindi'];else{if(_0x175fbd[0x0]['language']==_0x3e5d3d(0x23d))var _0x324807=users[_0x3e5d3d(0x23d)];else{if(_0x175fbd[0x0]['language']==_0x3e5d3d(0x197))var _0x324807=users[_0x3e5d3d(0x197)];else{if(_0x175fbd[0x0][_0x3e5d3d(0x23f)]==_0x3e5d3d(0x279))var _0x324807=users[_0x3e5d3d(0x279)];else{if(_0x175fbd[0x0][_0x3e5d3d(0x23f)]==_0x3e5d3d(0x1a7))var _0x324807=users[_0x3e5d3d(0x26d)];else{if(_0x175fbd[0x0][_0x3e5d3d(0x23f)]==_0x3e5d3d(0x1be))var _0x324807=users[_0x3e5d3d(0x1be)];else{if(_0x175fbd[0x0][_0x3e5d3d(0x23f)]==_0x3e5d3d(0x243))var _0x324807=users[_0x3e5d3d(0x199)];}}}}}}}_0xa545ee[_0x3e5d3d(0x21f)](_0x3e5d3d(0x1c4),{'success':_0x3453aa['flash']('success'),'errors':_0x3453aa[_0x3e5d3d(0x1c7)]('errors'),'role':_0x4cbd6e,'profile':_0x4229af,'master_shop':_0x175fbd,'warehouse':_0x43f567,'transfer':_0x4001fa,'stock':_0x55987a,'unit':_0xd2b5b0,'language':_0x324807});}catch(_0x45d302){console[_0x3e5d3d(0x1f0)](_0x45d302);}}),router[a0_0x289c97(0x228)](a0_0x289c97(0x23c),auth,async(_0x234a4d,_0x10d117)=>{var _0x43690b=a0_0x289c97;try{const _0x9e63=_0x234a4d[_0x43690b(0x207)]['id'],_0x3292bb=await transfers[_0x43690b(0x1b0)](_0x9e63);_0x10d117['json'](_0x234a4d[_0x43690b(0x1ab)]);return;const {date:_0x2cbdfa,from_warehouse:_0x1049c7,FromRoom_name:_0x5a367c,to_warehouse:_0x218221,ToRoom_name:_0x5b1a0b,prod_name:_0x458355,from_prod_qty:_0xbd3774,from_prod_level:_0x3a99a7,from_prod_isle:_0x1c19b9,from_prod_pallet:_0x56b63b,to_prod_qty:_0x7b8f51,to_prod_level:_0x3b424b,to_prod_isle:_0xa11fdc,to_prod_pallet:_0x4fbf5f,primary_code:_0x50b5ea,secondary_code:_0x4bd8af,product_code3:_0x208e93,note:_0x56324d,invoice:_0x21b408,expiry_date:_0x3f5b78}=_0x234a4d[_0x43690b(0x1ab)];if(typeof _0x458355==_0x43690b(0x1d5))var _0x1fa0f3=[_0x234a4d[_0x43690b(0x1ab)]['prod_name']],_0x47278b=[_0x234a4d['body'][_0x43690b(0x26b)]],_0x37df24=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1b3)]],_0x1957fd=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1d3)]],_0x481366=[_0x234a4d[_0x43690b(0x1ab)]['from_prod_pallet']],_0x56b734=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1e0)]],_0x32f5ae=[_0x234a4d['body'][_0x43690b(0x1bc)]],_0x2629c1=[_0x234a4d[_0x43690b(0x1ab)]['to_prod_level']],_0x4a109b=[_0x234a4d['body'][_0x43690b(0x21d)]],_0x228998=[_0x234a4d['body'][_0x43690b(0x233)]],_0x4d5be2=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1c2)]],_0x43c8fd=[_0x234a4d['body'][_0x43690b(0x1fe)]],_0x26176d=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1f4)]],_0x12c446=[_0x234a4d[_0x43690b(0x1ab)]['primary_code']],_0x5dcd2f=[_0x234a4d['body'][_0x43690b(0x271)]],_0x36a301=[_0x234a4d[_0x43690b(0x1ab)]['product_code3']],_0x7eccb0=[_0x234a4d['body'][_0x43690b(0x209)]],_0x52c203=[_0x234a4d['body'][_0x43690b(0x1f7)]],_0x595647=[_0x234a4d['body'][_0x43690b(0x22b)]],_0x25ef54=[_0x234a4d[_0x43690b(0x1ab)]['batch_code']],_0x306d4c=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x225)]],_0x303a95=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x214)]],_0x421269=[_0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1b9)]];else var _0x1fa0f3=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x25d)]],_0x43c8fd=[..._0x234a4d['body'][_0x43690b(0x1fe)]],_0x26176d=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1f4)]],_0x56b734=[..._0x234a4d['body'][_0x43690b(0x1e0)]],_0x4d5be2=[..._0x234a4d['body'][_0x43690b(0x1c2)]],_0x47278b=[..._0x234a4d['body'][_0x43690b(0x26b)]],_0x37df24=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1b3)]],_0x1957fd=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1d3)]],_0x481366=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1d8)]],_0x32f5ae=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x1bc)]],_0x2629c1=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x21a)]],_0x4a109b=[..._0x234a4d['body'][_0x43690b(0x21d)]],_0x228998=[..._0x234a4d[_0x43690b(0x1ab)]['to_prod_pallet']],_0x12c446=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x24e)]],_0x5dcd2f=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x271)]],_0x36a301=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x203)]],_0x7eccb0=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x209)]],_0x52c203=[..._0x234a4d[_0x43690b(0x1ab)]['unit']],_0x595647=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x22b)]],_0x25ef54=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x19c)]],_0x306d4c=[..._0x234a4d['body'][_0x43690b(0x225)]],_0x303a95=[..._0x234a4d[_0x43690b(0x1ab)][_0x43690b(0x214)]],_0x421269=[..._0x234a4d[_0x43690b(0x1ab)]['from_rak']];const _0x3fa36d=_0x1fa0f3[_0x43690b(0x221)](_0x2b83bb=>{return _0x2b83bb={'product_name':_0x2b83bb};});_0x47278b['forEach']((_0x59555b,_0x4b0746)=>{var _0x2d89f8=_0x43690b;_0x3fa36d[_0x4b0746][_0x2d89f8(0x266)]=_0x59555b;}),_0x37df24[_0x43690b(0x1b4)]((_0x48e702,_0xfab539)=>{var _0x1c8e1c=_0x43690b;_0x3fa36d[_0xfab539][_0x1c8e1c(0x216)]=_0x48e702;}),_0x1957fd['forEach']((_0x696579,_0xddf529)=>{var _0x3d4034=_0x43690b;_0x3fa36d[_0xddf529][_0x3d4034(0x1b8)]=_0x696579;}),_0x481366[_0x43690b(0x1b4)]((_0x1d4882,_0xa05e4)=>{var _0x44e9ea=_0x43690b;_0x3fa36d[_0xa05e4][_0x44e9ea(0x1a5)]=_0x1d4882;}),_0x32f5ae[_0x43690b(0x1b4)]((_0x321e94,_0x2059ad)=>{_0x3fa36d[_0x2059ad]['to_quantity']=_0x321e94;}),_0x2629c1[_0x43690b(0x1b4)]((_0x4e7c8e,_0x138fda)=>{var _0x394f0b=_0x43690b;_0x3fa36d[_0x138fda][_0x394f0b(0x198)]=_0x4e7c8e;}),_0x4a109b[_0x43690b(0x1b4)]((_0x3e22b4,_0x3b3294)=>{var _0x582dfd=_0x43690b;_0x3fa36d[_0x3b3294][_0x582dfd(0x267)]=_0x3e22b4;}),_0x228998[_0x43690b(0x1b4)]((_0x2e2828,_0xeef097)=>{_0x3fa36d[_0xeef097]['to_floorlevel']=_0x2e2828;}),_0x12c446['forEach']((_0xa97c9e,_0x372d37)=>{var _0x205564=_0x43690b;_0x3fa36d[_0x372d37][_0x205564(0x24e)]=_0xa97c9e;}),_0x5dcd2f['forEach']((_0x3139e5,_0x4c266a)=>{var _0xcb5316=_0x43690b;_0x3fa36d[_0x4c266a][_0xcb5316(0x271)]=_0x3139e5;}),_0x36a301['forEach']((_0x1ec5f8,_0x4027bc)=>{var _0x2bc25d=_0x43690b;_0x3fa36d[_0x4027bc][_0x2bc25d(0x1a2)]=_0x1ec5f8;}),_0x7eccb0[_0x43690b(0x1b4)]((_0x25215a,_0x376884)=>{_0x3fa36d[_0x376884]['maxProducts']=_0x25215a;}),_0x52c203[_0x43690b(0x1b4)]((_0x514864,_0x5f3ed1)=>{var _0x4d35d0=_0x43690b;_0x3fa36d[_0x5f3ed1][_0x4d35d0(0x1f7)]=_0x514864;}),_0x595647[_0x43690b(0x1b4)]((_0x4b36a5,_0x1d9c11)=>{_0x3fa36d[_0x1d9c11]['secondary_unit']=_0x4b36a5;}),_0x25ef54[_0x43690b(0x1b4)]((_0x630bce,_0x4d3eb5)=>{var _0x426dff=_0x43690b;_0x3fa36d[_0x4d3eb5][_0x426dff(0x19c)]=_0x630bce;}),_0x306d4c[_0x43690b(0x1b4)]((_0x3d8316,_0x111891)=>{var _0x270fa5=_0x43690b;_0x3fa36d[_0x111891][_0x270fa5(0x225)]=_0x3d8316;}),_0x43c8fd[_0x43690b(0x1b4)]((_0x497976,_0x2a78e2)=>{var _0x1aa93b=_0x43690b;_0x3fa36d[_0x2a78e2][_0x1aa93b(0x1fe)]=_0x497976;}),_0x26176d['forEach']((_0x54be69,_0x191565)=>{var _0x36422e=_0x43690b;_0x3fa36d[_0x191565][_0x36422e(0x1b1)]=_0x54be69;}),_0x56b734[_0x43690b(0x1b4)]((_0x21e071,_0x32be28)=>{var _0x3bcc0b=_0x43690b;_0x3fa36d[_0x32be28][_0x3bcc0b(0x1e0)]=_0x21e071;}),_0x4d5be2[_0x43690b(0x1b4)]((_0x421ce9,_0x482da2)=>{var _0x2e6a3d=_0x43690b;_0x3fa36d[_0x482da2][_0x2e6a3d(0x1c2)]=_0x421ce9;}),_0x303a95[_0x43690b(0x1b4)]((_0x22fe03,_0x3f0730)=>{var _0x421c66=_0x43690b;_0x3fa36d[_0x3f0730][_0x421c66(0x214)]=_0x22fe03;}),_0x421269[_0x43690b(0x1b4)]((_0x3a8161,_0x323890)=>{_0x3fa36d[_0x323890]['from_rack']=_0x3a8161;});const _0x47756c=_0x3fa36d[_0x43690b(0x246)](_0x50f6cf=>_0x50f6cf[_0x43690b(0x1e1)]!=='0'&&_0x50f6cf[_0x43690b(0x1e1)]!==''||_0x50f6cf['to_floorlevel']!=='0'&&_0x50f6cf[_0x43690b(0x26a)]!=='');var _0x3ff697=0x0;_0x47756c[_0x43690b(0x1b4)](_0x160d16=>{var _0x5d5e76=_0x43690b;parseInt(_0x160d16[_0x5d5e76(0x266)])<parseInt(_0x160d16[_0x5d5e76(0x1e1)])&&_0x3ff697++;});if(_0x3ff697!=0x0)return _0x234a4d[_0x43690b(0x1c7)](_0x43690b(0x226),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x10d117[_0x43690b(0x1ad)](_0x43690b(0x274));const _0x5b55b9=await warehouse[_0x43690b(0x1f2)]({'name':_0x3292bb[_0x43690b(0x213)],'room':_0x3292bb[_0x43690b(0x212)]});_0x3292bb['product']['forEach'](_0x287795=>{var _0x4e77d9=_0x43690b;if(_0x287795['to_quantity']>0x0){const _0x1b0bd6=_0x5b55b9[_0x4e77d9(0x1f6)]['map'](_0x4636aa=>{var _0x1ad8a5=_0x4e77d9;_0x4636aa[_0x1ad8a5(0x1c5)]==_0x287795[_0x1ad8a5(0x1c5)]&&_0x4636aa[_0x1ad8a5(0x276)]==_0x287795[_0x1ad8a5(0x1a5)]&&_0x4636aa[_0x1ad8a5(0x1a9)]==_0x287795['from_types']&&_0x4636aa['bin']==_0x287795[_0x1ad8a5(0x1b8)]&&_0x4636aa[_0x1ad8a5(0x255)]==_0x287795['from_bay']&&_0x4636aa[_0x1ad8a5(0x1b1)]==_0x287795['from_rack']&&_0x4636aa['storage']==_0x287795[_0x1ad8a5(0x214)]&&(_0x4636aa['product_stock']=parseInt(_0x4636aa[_0x1ad8a5(0x1a6)])+parseInt(_0x287795[_0x1ad8a5(0x1e1)]));});}}),await _0x5b55b9['save']();const _0x90db27=await warehouse[_0x43690b(0x1f2)]({'name':_0x3292bb[_0x43690b(0x231)],'room':_0x3292bb[_0x43690b(0x1de)]});_0x3292bb[_0x43690b(0x257)][_0x43690b(0x1b4)](_0x105d2e=>{var _0x3d747f=_0x43690b;if(_0x105d2e[_0x3d747f(0x1e1)]>0x0){const _0x4af4ff=_0x90db27[_0x3d747f(0x1f6)][_0x3d747f(0x221)](_0xcbe549=>{var _0x2e15b0=_0x3d747f;_0xcbe549['product_name']==_0x105d2e[_0x2e15b0(0x1c5)]&&_0xcbe549[_0x2e15b0(0x276)]==_0x105d2e[_0x2e15b0(0x26a)]&&_0xcbe549[_0x2e15b0(0x1a9)]==_0x105d2e['to_types']&&_0xcbe549[_0x2e15b0(0x24b)]==_0x105d2e['to_bin']&&_0xcbe549[_0x2e15b0(0x255)]==_0x105d2e[_0x2e15b0(0x198)]&&_0xcbe549['rack']==_0x105d2e[_0x2e15b0(0x1b1)]&&_0xcbe549['storage']==_0x105d2e['storage']&&(_0xcbe549[_0x2e15b0(0x1a6)]=parseInt(_0xcbe549[_0x2e15b0(0x1a6)])-parseInt(_0x105d2e[_0x2e15b0(0x1e1)]));});}}),await _0x90db27[_0x43690b(0x1aa)](),_0x3292bb[_0x43690b(0x1eb)]=_0x2cbdfa,_0x3292bb['from_warehouse']=_0x1049c7,_0x3292bb[_0x43690b(0x231)]=_0x218221,_0x3292bb[_0x43690b(0x257)]=_0x47756c,_0x3292bb[_0x43690b(0x22f)]=_0x56324d,_0x3292bb[_0x43690b(0x23a)]=_0x21b408;const _0x554407=await _0x3292bb[_0x43690b(0x1aa)]();console['log'](_0x554407);const _0x43627a=await warehouse['findOne']({'name':_0x1049c7,'room':_0x5a367c});_0x554407['product'][_0x43690b(0x1b4)](_0x33dd6b=>{var _0x1db8b2=_0x43690b;if(_0x33dd6b[_0x1db8b2(0x1e1)]>0x0){const _0x157fdc=_0x43627a[_0x1db8b2(0x1f6)][_0x1db8b2(0x221)](_0x13d43b=>{var _0x4ea249=_0x1db8b2;_0x13d43b['product_name']==_0x33dd6b[_0x4ea249(0x1c5)]&&_0x13d43b['floorlevel']==_0x33dd6b['from_floorlevel']&&_0x13d43b[_0x4ea249(0x1a9)]==_0x33dd6b['from_types']&&_0x13d43b[_0x4ea249(0x24b)]==_0x33dd6b['from_bin']&&_0x13d43b['bay']==_0x33dd6b['from_bay']&&_0x13d43b[_0x4ea249(0x1b1)]==_0x33dd6b[_0x4ea249(0x26c)]&&_0x13d43b['storage']==_0x33dd6b['from_storage']&&(_0x13d43b[_0x4ea249(0x1a6)]=parseInt(_0x13d43b[_0x4ea249(0x1a6)])-parseInt(_0x33dd6b[_0x4ea249(0x1e1)]));});}}),await _0x43627a[_0x43690b(0x1aa)]();const _0x28570f=await warehouse[_0x43690b(0x1f2)]({'name':_0x218221,'room':_0x5b1a0b});_0x554407[_0x43690b(0x257)][_0x43690b(0x1b4)](_0x2460a9=>{var _0x3f49d1=_0x43690b;if(_0x2460a9['to_quantity']>0x0){var _0x4a1c20=0x0;const _0x2b8dbd=_0x28570f['product_details'][_0x3f49d1(0x221)](_0x29acb7=>{var _0x2d9c27=_0x3f49d1;_0x29acb7[_0x2d9c27(0x1c5)]==_0x2460a9[_0x2d9c27(0x1c5)]&&_0x29acb7[_0x2d9c27(0x276)]==_0x2460a9[_0x2d9c27(0x26a)]&&_0x29acb7['type']==_0x2460a9[_0x2d9c27(0x1c2)]&&_0x29acb7[_0x2d9c27(0x24b)]==_0x2460a9[_0x2d9c27(0x267)]&&_0x29acb7[_0x2d9c27(0x255)]==_0x2460a9[_0x2d9c27(0x198)]&&_0x29acb7[_0x2d9c27(0x1b1)]==_0x2460a9[_0x2d9c27(0x1b1)]&&_0x29acb7[_0x2d9c27(0x1fe)]==_0x2460a9[_0x2d9c27(0x1fe)]&&(_0x29acb7['product_stock']=parseInt(_0x29acb7['product_stock'])+parseInt(_0x2460a9[_0x2d9c27(0x1e1)]),_0x4a1c20++);});_0x4a1c20=='0'&&(_0x28570f[_0x3f49d1(0x1f6)]=_0x28570f['product_details']['concat']({'product_name':_0x2460a9[_0x3f49d1(0x1c5)],'product_stock':_0x2460a9[_0x3f49d1(0x1e1)],'bay':_0x2460a9[_0x3f49d1(0x198)],'bin':_0x2460a9[_0x3f49d1(0x267)],'type':_0x2460a9[_0x3f49d1(0x1c2)],'floorlevel':_0x2460a9['to_floorlevel'],'storage':_0x2460a9['storage'],'rack':_0x2460a9[_0x3f49d1(0x1b1)],'product_code':_0x2460a9[_0x3f49d1(0x1a2)],'primary_code':_0x2460a9['primary_code'],'secondary_code':_0x2460a9[_0x3f49d1(0x271)],'maxProducts':_0x2460a9[_0x3f49d1(0x1e8)],'storage':_0x2460a9[_0x3f49d1(0x1fe)],'rack':_0x2460a9[_0x3f49d1(0x1b1)]}));}}),await _0x28570f[_0x43690b(0x1aa)](),_0x234a4d[_0x43690b(0x1c7)](_0x43690b(0x201),'Transfer\x20Edit\x20Successfully'),_0x10d117[_0x43690b(0x1ad)]('/transfer/view');}catch(_0x1f82a6){console[_0x43690b(0x1f0)](_0x1f82a6);}}),router[a0_0x289c97(0x228)]('/barcode_scanner',async(_0x152720,_0x46b03f)=>{var _0x2bd4ef=a0_0x289c97;const {FromWareHouse:_0x1fc7c4,FromRoom:_0x5ecb5a,ToWarehouse:_0xb539af,ToRoom:_0x261be4,primary_code:_0x4e67dd,Roomslist:_0x42288d}=_0x152720['body'],_0x428792=_0x42288d[_0x2bd4ef(0x1cc)](','),_0x5730f0=[];async function _0x303c0c(_0x5da2ac){var _0x27c5be=_0x2bd4ef;const _0x3a6242=await warehouse[_0x27c5be(0x265)]([{'$match':{'name':_0x1fc7c4,'room':_0x5da2ac}},{'$unwind':_0x27c5be(0x1ee)},{'$match':{'product_details.primary_code':_0x4e67dd}},{'$group':{'_id':_0x27c5be(0x1cb),'name':{'$first':_0x27c5be(0x1bb)},'instock':{'$first':_0x27c5be(0x19b)},'primary_code':{'$first':_0x27c5be(0x261)},'secondary_code':{'$first':_0x27c5be(0x25c)},'product_code':{'$first':_0x27c5be(0x260)},'level':{'$first':_0x27c5be(0x1c6)},'isle':{'$first':_0x27c5be(0x25f)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x27c5be(0x206)},'unit':{'$first':_0x27c5be(0x1c9)},'secondary_unit':{'$first':_0x27c5be(0x19f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x27c5be(0x1b7)},'expiry_date':{'$first':_0x27c5be(0x256)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x27c5be(0x250)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x27c5be(0x1da)},'maxProducts':{'$first':_0x27c5be(0x20b)}}}]),_0x5a9b43=await warehouse[_0x27c5be(0x265)]([{'$match':{'name':_0x1fc7c4,'room':_0x5da2ac}},{'$unwind':_0x27c5be(0x1ee)},{'$match':{'product_details.secondary_code':_0x4e67dd}},{'$group':{'_id':_0x27c5be(0x1cb),'name':{'$first':_0x27c5be(0x1bb)},'instock':{'$first':_0x27c5be(0x19b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x27c5be(0x260)},'level':{'$first':_0x27c5be(0x1c6)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x27c5be(0x1a4)},'pallet':{'$first':_0x27c5be(0x206)},'unit':{'$first':_0x27c5be(0x1c9)},'secondary_unit':{'$first':_0x27c5be(0x19f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x27c5be(0x1b7)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x27c5be(0x202)},'batch_code':{'$first':_0x27c5be(0x250)},'maxPerUnit':{'$first':_0x27c5be(0x204)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x27c5be(0x1da)},'maxProducts':{'$first':_0x27c5be(0x20b)}}}]);if(_0x3a6242[_0x27c5be(0x1ac)]>0x0)_0x5730f0[_0x27c5be(0x1fd)](_0x3a6242);else _0x5a9b43['length']>0x0&&_0x5730f0[_0x27c5be(0x1fd)](_0x5a9b43);}const _0x1b73e9=_0x428792[_0x2bd4ef(0x221)](_0x29f694=>_0x303c0c(_0x29f694));await Promise[_0x2bd4ef(0x1a3)](_0x1b73e9),_0x46b03f[_0x2bd4ef(0x272)](_0x5730f0);}),router[a0_0x289c97(0x228)]('/barcode_scanner2',async(_0x536e01,_0x3aba34)=>{var _0x2dee55=a0_0x289c97;try{const {FromWareHouse:_0x436ba1,FromRoom:_0x38b340,ToWarehouse:_0x41dd1d,ToRoom:_0x5896e7,secondary_code:_0x5ac910}=_0x536e01[_0x2dee55(0x1ab)],_0x576d6c=await warehouse[_0x2dee55(0x265)]([{'$match':{'name':_0x436ba1}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5ac910}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x2dee55(0x261)},'secondary_code':{'$first':_0x2dee55(0x25c)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x2dee55(0x19b)},'warehouse':{'$first':_0x2dee55(0x224)},'level':{'$first':_0x2dee55(0x24a)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x2dee55(0x20b)},'unit':{'$first':_0x2dee55(0x1c9)}}}]);_0x3aba34[_0x2dee55(0x1df)](0xc8)[_0x2dee55(0x272)](_0x576d6c);}catch(_0x149db3){_0x3aba34[_0x2dee55(0x1df)](0x194)['json']({'message':_0x149db3[_0x2dee55(0x20f)]});}}),router['post'](a0_0x289c97(0x234),async(_0x4eb3db,_0x5becc0)=>{var _0x1dc915=a0_0x289c97;try{const {FromWareHouse:_0x432dd3,FromRoom:_0x1a4459,ToWarehouse:_0x3d7073,ToRoom:_0x4611aa,product_code:_0x315a58}=_0x4eb3db[_0x1dc915(0x1ab)],_0x22f033=await warehouse['aggregate']([{'$match':{'name':_0x432dd3}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x315a58}},{'$group':{'_id':_0x1dc915(0x1cb),'name':{'$first':_0x1dc915(0x1bb)},'primary_code':{'$first':_0x1dc915(0x261)},'secondary_code':{'$first':_0x1dc915(0x25c)},'product_code':{'$first':_0x1dc915(0x260)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x1dc915(0x24a)},'isle':{'$first':_0x1dc915(0x229)},'pallet':{'$first':_0x1dc915(0x249)},'maxProducts':{'$first':_0x1dc915(0x20b)},'unit':{'$first':_0x1dc915(0x1c9)}}}]);_0x5becc0[_0x1dc915(0x1df)](0xc8)[_0x1dc915(0x272)](_0x22f033);}catch(_0x37881f){_0x5becc0[_0x1dc915(0x1df)](0x194)[_0x1dc915(0x272)]({'message':_0x37881f[_0x1dc915(0x20f)]});}}),router['post'](a0_0x289c97(0x1ae),async(_0x63c5e,_0x14d8c8)=>{var _0x1c07af=a0_0x289c97;const {level:_0xd1adb9,isle:_0x5a9b9e,pallet:_0x52bfff,warehouses:_0xa04d48,room:_0x462ccd}=_0x63c5e[_0x1c07af(0x1ab)];try{const _0xd6c225=await warehouse[_0x1c07af(0x265)]([{'$match':{'name':_0xa04d48,'room':_0x462ccd}},{'$unwind':_0x1c07af(0x1ee)},{'$match':{'product_details.level':parseInt(_0xd1adb9),'product_details.isle':_0x5a9b9e,'product_details.pallet':parseInt(_0x52bfff)}},{'$group':{'_id':_0x1c07af(0x1cb),'name':{'$first':_0x1c07af(0x1bb)},'product_stock':{'$first':_0x1c07af(0x19b)},'level':{'$first':_0x1c07af(0x24a)},'isle':{'$first':_0x1c07af(0x229)},'pallet':{'$first':_0x1c07af(0x249)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x14d8c8[_0x1c07af(0x1df)](0xc8)['json'](_0xd6c225);}catch(_0x33ceae){_0x14d8c8[_0x1c07af(0x1df)](0x194)[_0x1c07af(0x272)]({'message':_0x33ceae['message']});}}),module['exports']=router;