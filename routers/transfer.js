var a0_0x426269=a0_0xb19f;(function(_0x56af39,_0x36b480){var _0x2f90af=a0_0xb19f,_0x45de48=_0x56af39();while(!![]){try{var _0x19de07=-parseInt(_0x2f90af(0xf3))/0x1+parseInt(_0x2f90af(0x152))/0x2+-parseInt(_0x2f90af(0x1a4))/0x3+parseInt(_0x2f90af(0x118))/0x4*(parseInt(_0x2f90af(0x1a6))/0x5)+parseInt(_0x2f90af(0x12f))/0x6*(-parseInt(_0x2f90af(0x17e))/0x7)+-parseInt(_0x2f90af(0x199))/0x8+parseInt(_0x2f90af(0xff))/0x9;if(_0x19de07===_0x36b480)break;else _0x45de48['push'](_0x45de48['shift']());}catch(_0x905168){_0x45de48['push'](_0x45de48['shift']());}}}(a0_0x8063,0x2c956));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x426269(0xf1)),auth=require(a0_0x426269(0x1c3)),users=require(a0_0x426269(0x119)),nodemailer=require(a0_0x426269(0x14b));router['get'](a0_0x426269(0x18a),auth,async(_0x52208a,_0x41fd5a)=>{var _0x4af88f=a0_0x426269;try{const {username:_0x7434d5,email:_0x2783d6,role:_0x4056b7}=_0x52208a['user'],_0x2ba198=_0x52208a[_0x4af88f(0x168)],_0x4e5fe4=await profile[_0x4af88f(0x1b6)]({'email':_0x2ba198[_0x4af88f(0x1b4)]}),_0x482bed=await master_shop[_0x4af88f(0x14d)]();console[_0x4af88f(0x19b)](_0x4af88f(0x120),_0x482bed);let _0x3c9c28;if(_0x2ba198[_0x4af88f(0x186)]==_0x4af88f(0x122)){const _0x4d16e4=await staff[_0x4af88f(0x1b6)]({'email':_0x2ba198['email']});_0x3c9c28=await transfers[_0x4af88f(0x14d)]({'from_warehouse':_0x4d16e4[_0x4af88f(0x11f)]});}else _0x3c9c28=await transfers['aggregate']([{'$unwind':_0x4af88f(0x173)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4af88f(0xf5)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x4af88f(0xf8)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x4af88f(0x1b5)},'finalize':{'$first':_0x4af88f(0x1a7)},'isAllowEdit':{'$first':_0x4af88f(0x1b8)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x482bed[0x0][_0x4af88f(0xfa)]=='English\x20(US)'){var _0x498523=users['English'];console['log'](_0x498523);}else{if(_0x482bed[0x0]['language']==_0x4af88f(0x19e))var _0x498523=users[_0x4af88f(0x19e)];else{if(_0x482bed[0x0][_0x4af88f(0xfa)]==_0x4af88f(0x189))var _0x498523=users[_0x4af88f(0x189)];else{if(_0x482bed[0x0]['language']==_0x4af88f(0x15e))var _0x498523=users[_0x4af88f(0x15e)];else{if(_0x482bed[0x0]['language']==_0x4af88f(0x134))var _0x498523=users['French'];else{if(_0x482bed[0x0]['language']==_0x4af88f(0x104))var _0x498523=users[_0x4af88f(0x1c0)];else{if(_0x482bed[0x0][_0x4af88f(0xfa)]=='Chinese')var _0x498523=users[_0x4af88f(0x156)];else{if(_0x482bed[0x0][_0x4af88f(0xfa)]=='Arabic\x20(ae)')var _0x498523=users['Arabic'];}}}}}}}_0x41fd5a[_0x4af88f(0x16d)](_0x4af88f(0x1a5),{'success':_0x52208a['flash'](_0x4af88f(0x15b)),'errors':_0x52208a['flash']('errors'),'role':_0x2ba198,'profile':_0x4e5fe4,'master_shop':_0x482bed,'transfer':_0x3c9c28,'language':_0x498523});}catch(_0x4e04d0){console[_0x4af88f(0x19b)](_0x4e04d0);}});async function getRandom8DigitNumber(){var _0x52be6c=a0_0x426269;const _0x432970=0x989680,_0x3176f2=0x5f5e0ff,_0x4e841a=Math[_0x52be6c(0x159)](Math[_0x52be6c(0x178)]()*(_0x3176f2-_0x432970+0x1))+_0x432970;var _0x4f3544;const _0x57b394=await transfers[_0x52be6c(0x1b6)]({'invoice':'TRF-'+_0x4e841a});return _0x57b394&&_0x57b394[_0x52be6c(0x164)]>0x0?_0x4f3544=_0x52be6c(0x144)+_0x4e841a:_0x4f3544=_0x52be6c(0x144)+_0x4e841a,_0x4f3544;}router[a0_0x426269(0x1ac)]('/view/add_transfer',auth,async(_0x1e0d18,_0x143623)=>{var _0x25002c=a0_0x426269;try{const {username:_0x3fc60a,email:_0x5f5121,role:_0x4ac52d}=_0x1e0d18[_0x25002c(0x168)],_0x2e149d=_0x1e0d18[_0x25002c(0x168)],_0x389884=await profile['findOne']({'email':_0x2e149d['email']}),_0x23f1f3=await master_shop[_0x25002c(0x14d)]();console[_0x25002c(0x19b)](_0x25002c(0x120),_0x23f1f3);let _0x32166d;if(_0x2e149d[_0x25002c(0x186)]==_0x25002c(0x122)){const _0x54b7e0=await staff[_0x25002c(0x1b6)]({'email':_0x2e149d[_0x25002c(0x1b4)]});_0x32166d=await warehouse[_0x25002c(0x166)]([{'$match':{'status':'Enabled','name':_0x54b7e0[_0x25002c(0x11f)],'warehouse_category':_0x25002c(0x127)}},{'$group':{'_id':_0x25002c(0x16c),'name':{'$first':_0x25002c(0x16c)}}}]);}else _0x32166d=await warehouse[_0x25002c(0x166)]([{'$match':{'status':'Enabled','warehouse_category':_0x25002c(0x127)}},{'$group':{'_id':_0x25002c(0x16c),'name':{'$first':'$name'}}}]);var _0x48cf1c=['Ambient',_0x25002c(0x19d),_0x25002c(0xf2)];const _0x55cb2e=await transfers[_0x25002c(0x14d)]({}),_0x50de36=_0x55cb2e['length']+0x1,_0x4b8b2f='TRF-'+_0x50de36[_0x25002c(0x18f)]()['padStart'](0x5,'0');if(_0x23f1f3[0x0][_0x25002c(0xfa)]=='English\x20(US)'){var _0xcecdd9=users[_0x25002c(0xef)];console['log'](_0xcecdd9);}else{if(_0x23f1f3[0x0][_0x25002c(0xfa)]==_0x25002c(0x19e))var _0xcecdd9=users[_0x25002c(0x19e)];else{if(_0x23f1f3[0x0]['language']==_0x25002c(0x189))var _0xcecdd9=users[_0x25002c(0x189)];else{if(_0x23f1f3[0x0]['language']=='Spanish')var _0xcecdd9=users[_0x25002c(0x15e)];else{if(_0x23f1f3[0x0][_0x25002c(0xfa)]=='French')var _0xcecdd9=users[_0x25002c(0x134)];else{if(_0x23f1f3[0x0][_0x25002c(0xfa)]==_0x25002c(0x104))var _0xcecdd9=users[_0x25002c(0x1c0)];else{if(_0x23f1f3[0x0][_0x25002c(0xfa)]==_0x25002c(0x156))var _0xcecdd9=users[_0x25002c(0x156)];else{if(_0x23f1f3[0x0]['language']=='Arabic\x20(ae)')var _0xcecdd9=users[_0x25002c(0xe9)];}}}}}}}const _0x296ec5=getRandom8DigitNumber();_0x296ec5[_0x25002c(0x15d)](_0x3500e6=>{var _0x2a331a=_0x25002c;_0x143623[_0x2a331a(0x16d)](_0x2a331a(0x102),{'success':_0x1e0d18[_0x2a331a(0x1ae)]('success'),'errors':_0x1e0d18[_0x2a331a(0x1ae)](_0x2a331a(0x108)),'role':_0x2e149d,'profile':_0x389884,'master_shop':_0x23f1f3,'warehouse':_0x32166d,'language':_0xcecdd9,'rooms_data':_0x48cf1c,'invoice':_0x3500e6});})['catch'](_0x81615=>{var _0x4bb28b=_0x25002c;_0x1e0d18['flash'](_0x4bb28b(0x108),_0x4bb28b(0x126)),_0x143623[_0x4bb28b(0x149)](_0x4bb28b(0x1ad));});}catch(_0x47d351){console['log'](_0x47d351);}}),router['post'](a0_0x426269(0x130),auth,async(_0x873f10,_0x5adec6)=>{var _0x114ec1=a0_0x426269;try{console['log'](_0x873f10[_0x114ec1(0x107)]);const {date:_0x5a560d,from_warehouse:_0x397db9,FromRoom_name:_0x3d3454,to_warehouse:_0xe93ab,ToRoom_name:_0x3380bf,prod_name:_0x1306d9,from_prod_qty:_0xe21254,from_prod_level:_0x329047,from_prod_isle:_0x401418,from_prod_pallet:_0x377c18,to_prod_qty:_0xa7a9f3,to_prod_level:_0x58cf2c,to_prod_isle:_0xb2f245,to_prod_pallet:_0x4558b0,primary_code:_0x1146c5,secondary_code:_0x27d269,product_code3:_0x487e28,note:_0xffc4e4,MaxStocks_data2:_0x1b0180,invoice:_0x36ccef,expiry_date:_0x3685f8}=_0x873f10[_0x114ec1(0x107)];if(typeof _0x1306d9=='string')var _0x4f3db8=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x113)]],_0x4c17ab=[_0x873f10[_0x114ec1(0x107)]['from_prod_qty']],_0x61a946=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x1b1)]],_0x2b4565=[_0x873f10['body'][_0x114ec1(0x155)]],_0x314027=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x17d)]],_0x28ce6d=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x160)]],_0x486933=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0xe6)]],_0x4db27c=[_0x873f10[_0x114ec1(0x107)]['product_code3']],_0x38affc=[_0x873f10[_0x114ec1(0x107)]['MaxStocks_data2']],_0x516d94=[_0x873f10['body'][_0x114ec1(0x13d)]],_0x56642e=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x1b7)]],_0x3af68b=[_0x873f10['body'][_0x114ec1(0x15a)]],_0x339dcb=[_0x873f10[_0x114ec1(0x107)]['expiry_date']],_0x23caa5=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x141)]],_0xb8b12b=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x106)]],_0x3c27fd=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x157)]],_0x13f057=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x131)]],_0x2943cf=[_0x873f10['body']['ToRoomAssigned']],_0xe1d069=[_0x873f10[_0x114ec1(0x107)]['from_invoice']],_0x210025=[_0x873f10[_0x114ec1(0x107)][_0x114ec1(0x10a)]];else var _0x4f3db8=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x113)]],_0x4c17ab=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x13e)]],_0x61a946=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x1b1)]],_0x2b4565=[..._0x873f10[_0x114ec1(0x107)]['New_Qty_Converted']],_0x314027=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x17d)]],_0x28ce6d=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x160)]],_0x486933=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0xe6)]],_0x4db27c=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x1af)]],_0x38affc=[..._0x873f10[_0x114ec1(0x107)]['MaxStocks_data2']],_0x516d94=[..._0x873f10[_0x114ec1(0x107)]['primary_unit']],_0x56642e=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x1b7)]],_0x3af68b=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x15a)]],_0x339dcb=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x11c)]],_0x23caa5=[..._0x873f10['body'][_0x114ec1(0x141)]],_0xb8b12b=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x106)]],_0x3c27fd=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x157)]],_0x13f057=[..._0x873f10[_0x114ec1(0x107)]['RoomAssigned']],_0x2943cf=[..._0x873f10['body'][_0x114ec1(0xec)]],_0xe1d069=[..._0x873f10[_0x114ec1(0x107)][_0x114ec1(0x135)]],_0x210025=[..._0x873f10[_0x114ec1(0x107)]['to_invoice']];const _0x52246a=_0x4f3db8[_0x114ec1(0x140)](_0x2fe762=>{return _0x2fe762={'product_name':_0x2fe762};});_0x4c17ab[_0x114ec1(0xe5)]((_0x2fc5a8,_0x382e91)=>{var _0x421b6c=_0x114ec1;_0x52246a[_0x382e91][_0x421b6c(0x105)]=_0x2fc5a8;}),_0xe1d069['forEach']((_0x2bad17,_0x20a816)=>{_0x52246a[_0x20a816]['from_invoice']=_0x2bad17;}),_0x210025[_0x114ec1(0xe5)]((_0x31f1ff,_0x5e7503)=>{_0x52246a[_0x5e7503]['To_invoice']=_0x31f1ff;}),_0x61a946[_0x114ec1(0xe5)]((_0x4fb200,_0x4ad094)=>{var _0x538b28=_0x114ec1;_0x13f057[_0x538b28(0xe5)]((_0x3a9ddd,_0x5525fe)=>{var _0x4f92c0=_0x538b28;if(_0x3a9ddd==_0x4f92c0(0x10e)&&_0x4ad094==_0x5525fe){var _0x11e391=_0x4fb200[_0x4f92c0(0x190)](0x3);_0x52246a[_0x4ad094]['from_storage']=_0x4fb200[0x0],_0x52246a[_0x4ad094][_0x4f92c0(0x10f)]=_0x4fb200[0x1],_0x52246a[_0x4ad094]['from_bay']=0x0,_0x52246a[_0x4ad094][_0x4f92c0(0x1c6)]=0x0,_0x52246a[_0x4ad094][_0x4f92c0(0x18e)]='Floor',_0x52246a[_0x4ad094]['from_floorlevel']=_0x11e391;}else{if(_0x3a9ddd==_0x4f92c0(0x1c8)&&_0x4ad094==_0x5525fe){var _0x11e391=_0x4fb200[_0x4f92c0(0x190)](0x3);_0x52246a[_0x4ad094][_0x4f92c0(0x185)]=_0x4fb200[0x0],_0x52246a[_0x4ad094][_0x4f92c0(0x10f)]=_0x4fb200[0x1],_0x52246a[_0x4ad094]['from_bay']=0x0,_0x52246a[_0x4ad094][_0x4f92c0(0x1c6)]=0x0,_0x52246a[_0x4ad094][_0x4f92c0(0x18e)]=_0x4f92c0(0xfe),_0x52246a[_0x4ad094]['from_floorlevel']=_0x4fb200[0x5];}else{if(_0x4ad094==_0x5525fe){var _0x3a11e1;if(_0x4fb200[0x4]=='L')_0x3a11e1=_0x4f92c0(0x10d);else _0x4fb200[0x4]=='F'&&(_0x3a11e1=_0x4f92c0(0xfe));_0x52246a[_0x4ad094][_0x4f92c0(0x185)]=_0x4fb200[0x0],_0x52246a[_0x4ad094][_0x4f92c0(0x10f)]=_0x4fb200[0x1],_0x52246a[_0x4ad094][_0x4f92c0(0x167)]=_0x4fb200[0x2],_0x52246a[_0x4ad094][_0x4f92c0(0x1c6)]=_0x4fb200[0x3],_0x52246a[_0x4ad094][_0x4f92c0(0x18e)]=_0x3a11e1,_0x52246a[_0x4ad094][_0x4f92c0(0x112)]=_0x4fb200[0x5];}}}});}),_0x2b4565[_0x114ec1(0xe5)]((_0x659189,_0x26d161)=>{_0x52246a[_0x26d161]['to_quantity']=_0x659189;}),_0x314027[_0x114ec1(0xe5)]((_0x189862,_0x5e3db3)=>{var _0x4fd1b5=_0x114ec1;_0x2943cf[_0x4fd1b5(0xe5)]((_0x275a38,_0x541522)=>{var _0x549680=_0x4fd1b5;if(_0x275a38==_0x549680(0x10e)&&_0x5e3db3==_0x541522){var _0x1ab6c3=_0x189862[_0x549680(0x190)](0x3);_0x52246a[_0x5e3db3][_0x549680(0x162)]=_0x189862[0x0],_0x52246a[_0x5e3db3][_0x549680(0x1c9)]=_0x189862[0x1],_0x52246a[_0x5e3db3][_0x549680(0x1b0)]=0x0,_0x52246a[_0x5e3db3]['to_bin']=0x0,_0x52246a[_0x5e3db3][_0x549680(0x1b9)]=_0x549680(0xfe),_0x52246a[_0x5e3db3]['to_floorlevel']=_0x1ab6c3;}else{if(_0x275a38==_0x549680(0x1c8)&&_0x5e3db3==_0x541522){var _0x1ab6c3=_0x189862[_0x549680(0x190)](0x3);_0x52246a[_0x5e3db3]['storage']=_0x189862[0x0],_0x52246a[_0x5e3db3]['rack']=_0x189862[0x1],_0x52246a[_0x5e3db3][_0x549680(0x1b0)]=0x0,_0x52246a[_0x5e3db3][_0x549680(0x192)]=0x0,_0x52246a[_0x5e3db3][_0x549680(0x1b9)]=_0x549680(0xfe),_0x52246a[_0x5e3db3][_0x549680(0x16e)]=_0x189862[0x5];}else{if(_0x5e3db3==_0x541522){var _0x18d072;if(_0x189862[0x4]=='L')_0x18d072=_0x549680(0x10d);else _0x189862[0x4]=='F'&&(_0x18d072='Floor');_0x52246a[_0x5e3db3][_0x549680(0x162)]=_0x189862[0x0],_0x52246a[_0x5e3db3][_0x549680(0x1c9)]=_0x189862[0x1],_0x52246a[_0x5e3db3]['to_bay']=_0x189862[0x2],_0x52246a[_0x5e3db3][_0x549680(0x192)]=_0x189862[0x3],_0x52246a[_0x5e3db3]['to_types']=_0x18d072,_0x52246a[_0x5e3db3]['to_floorlevel']=_0x189862[0x5];}}}});}),_0x28ce6d['forEach']((_0x139b3f,_0x3e3370)=>{var _0x426dc9=_0x114ec1;_0x52246a[_0x3e3370][_0x426dc9(0x160)]=_0x139b3f;}),_0x486933[_0x114ec1(0xe5)]((_0x11e41f,_0x5e8e23)=>{var _0x32dd48=_0x114ec1;_0x52246a[_0x5e8e23][_0x32dd48(0xe6)]=_0x11e41f;}),_0x4db27c[_0x114ec1(0xe5)]((_0x1f9523,_0x4e1c83)=>{var _0x9422d8=_0x114ec1;_0x52246a[_0x4e1c83][_0x9422d8(0x117)]=_0x1f9523;}),_0x38affc[_0x114ec1(0xe5)]((_0x3721be,_0x55a5e3)=>{var _0x5c663f=_0x114ec1;_0x52246a[_0x55a5e3][_0x5c663f(0xf9)]=_0x3721be;}),_0x516d94['forEach']((_0x16153d,_0xe601cf)=>{var _0x21fdf3=_0x114ec1;_0x52246a[_0xe601cf][_0x21fdf3(0x1a2)]=_0x16153d;}),_0x56642e[_0x114ec1(0xe5)]((_0x5f1d6a,_0x36bf41)=>{var _0xfe9344=_0x114ec1;_0x52246a[_0x36bf41][_0xfe9344(0x1b7)]=_0x5f1d6a;}),_0x3af68b[_0x114ec1(0xe5)]((_0x4ffe37,_0xe7ac53)=>{_0x52246a[_0xe7ac53]['batch_code']=_0x4ffe37;}),_0x339dcb[_0x114ec1(0xe5)]((_0x456b4e,_0x2d11d4)=>{var _0x550aa2=_0x114ec1;_0x52246a[_0x2d11d4][_0x550aa2(0x11c)]=_0x456b4e;}),_0x23caa5[_0x114ec1(0xe5)]((_0x37d0e0,_0x3ef69c)=>{_0x52246a[_0x3ef69c]['maxperunit']=_0x37d0e0;}),_0xb8b12b[_0x114ec1(0xe5)]((_0xa14585,_0x45a602)=>{var _0xaf56f0=_0x114ec1;_0x52246a[_0x45a602][_0xaf56f0(0x106)]=_0xa14585;}),_0x3c27fd[_0x114ec1(0xe5)]((_0x2ce8f2,_0x4c1ced)=>{var _0x56ad5a=_0x114ec1;_0x52246a[_0x4c1ced][_0x56ad5a(0x157)]=_0x2ce8f2;}),_0x13f057['forEach']((_0x432cc0,_0x4f7ed6)=>{var _0x5c9e11=_0x114ec1;_0x52246a[_0x4f7ed6][_0x5c9e11(0xe8)]=_0x432cc0;}),_0x2943cf[_0x114ec1(0xe5)]((_0x37904f,_0x16eaae)=>{_0x52246a[_0x16eaae]['to_room_name']=_0x37904f;});const _0x470af4=_0x52246a[_0x114ec1(0x148)](_0xe2d30=>_0xe2d30[_0x114ec1(0x115)]!=='0'&&_0xe2d30['to_quantity']!==''||_0xe2d30[_0x114ec1(0x16e)]!=='0'&&_0xe2d30[_0x114ec1(0x16e)]!==''),_0x299bae=new transfers({'date':_0x5a560d,'from_warehouse':_0x397db9,'to_warehouse':_0xe93ab,'product':_0x470af4,'note':_0xffc4e4,'invoice':_0x36ccef}),_0x58cd33=await _0x299bae[_0x114ec1(0xee)]();_0x873f10[_0x114ec1(0x1ae)]('success',_0x114ec1(0x1c2)),_0x5adec6['redirect']('/transfer/preview/'+_0x58cd33['_id']);}catch(_0xc4c5fb){console[_0x114ec1(0x19b)](_0xc4c5fb),_0x5adec6[_0x114ec1(0x124)](0xc8)[_0x114ec1(0x125)]({'errorMessage':_0xc4c5fb[_0x114ec1(0x12e)]});}}),router['get'](a0_0x426269(0x146),auth,async(_0x549a3d,_0x4e3f36)=>{var _0x1fff26=a0_0x426269;try{const {username:_0x13e2dd,email:_0x4d1e03,role:_0x3da45f}=_0x549a3d[_0x1fff26(0x168)],_0x326baf=_0x549a3d[_0x1fff26(0x168)],_0x383712=await profile[_0x1fff26(0x1b6)]({'email':_0x326baf['email']}),_0x394713=await master_shop[_0x1fff26(0x14d)]();console[_0x1fff26(0x19b)](_0x1fff26(0x120),_0x394713);const _0x3d2215=await transfers['findById'](_0x549a3d[_0x1fff26(0x15f)]['id']);let _0x3598c2=new Date(_0x3d2215[_0x1fff26(0x11c)]),_0x4813b4=('0'+_0x3598c2['getDate']())[_0x1fff26(0x190)](-0x2),_0x440db1=('0'+(_0x3598c2['getMonth']()+0x1))[_0x1fff26(0x190)](-0x2),_0x528643=_0x3598c2[_0x1fff26(0x1a0)](),_0x16cf84=_0x528643+'-'+_0x440db1+'-'+_0x4813b4,_0x3fb7a9;if(_0x326baf[_0x1fff26(0x186)]==_0x1fff26(0x122)){const _0x343d13=await staff[_0x1fff26(0x1b6)]({'email':_0x326baf[_0x1fff26(0x1b4)]});_0x3fb7a9=await warehouse[_0x1fff26(0x14d)]({'status':'Enabled','name':_0x343d13['warehouse'],'warehouse_category':_0x1fff26(0x127)});}else _0x3fb7a9=await warehouse[_0x1fff26(0x14d)]({'status':'Enabled','warehouse_category':_0x1fff26(0x127)});const _0xa7e298=await warehouse['aggregate']([{'$match':{'name':_0x3d2215[_0x1fff26(0xfd)]}},{'$unwind':_0x1fff26(0x12a)},{'$group':{'_id':_0x1fff26(0x161),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1fff26(0xe7)},'bay':{'$first':_0x1fff26(0x137)},'bin':{'$first':_0x1fff26(0x13c)},'type':{'$first':_0x1fff26(0x17c)},'floorlevel':{'$first':_0x1fff26(0x183)},'primary_code':{'$first':_0x1fff26(0x1b2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1fff26(0x19a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1fff26(0x181)},'expiry_date':{'$first':_0x1fff26(0x198)},'production_date':{'$first':_0x1fff26(0x154)},'room':{'$first':'$room'}}}]);if(_0x394713[0x0][_0x1fff26(0xfa)]==_0x1fff26(0x12b)){var _0x4d8d03=users['English'];console[_0x1fff26(0x19b)](_0x4d8d03);}else{if(_0x394713[0x0]['language']==_0x1fff26(0x19e))var _0x4d8d03=users[_0x1fff26(0x19e)];else{if(_0x394713[0x0][_0x1fff26(0xfa)]==_0x1fff26(0x189))var _0x4d8d03=users[_0x1fff26(0x189)];else{if(_0x394713[0x0]['language']==_0x1fff26(0x15e))var _0x4d8d03=users[_0x1fff26(0x15e)];else{if(_0x394713[0x0][_0x1fff26(0xfa)]==_0x1fff26(0x134))var _0x4d8d03=users[_0x1fff26(0x134)];else{if(_0x394713[0x0][_0x1fff26(0xfa)]==_0x1fff26(0x104))var _0x4d8d03=users[_0x1fff26(0x1c0)];else{if(_0x394713[0x0][_0x1fff26(0xfa)]==_0x1fff26(0x156))var _0x4d8d03=users[_0x1fff26(0x156)];else{if(_0x394713[0x0][_0x1fff26(0xfa)]==_0x1fff26(0x197))var _0x4d8d03=users[_0x1fff26(0xe9)];}}}}}}}_0x4e3f36[_0x1fff26(0x16d)](_0x1fff26(0x18d),{'success':_0x549a3d[_0x1fff26(0x1ae)](_0x1fff26(0x15b)),'errors':_0x549a3d[_0x1fff26(0x1ae)](_0x1fff26(0x108)),'role':_0x326baf,'profile':_0x383712,'master_shop':_0x394713,'warehouse':_0x3fb7a9,'transfer':_0x3d2215,'stock':_0xa7e298,'language':_0x4d8d03});}catch(_0x5a5fdf){console[_0x1fff26(0x19b)](_0x5a5fdf);}}),router[a0_0x426269(0x16b)](a0_0x426269(0x146),auth,async(_0x1cdf43,_0xf66b68)=>{var _0x5721d2=a0_0x426269;try{const _0x630f3e=_0x1cdf43[_0x5721d2(0x15f)]['id'],{from_warehouse:_0x3da415,FromRoom_name:_0x2b20dd,to_warehouse:_0x5a5138,ToRoom_name:_0x7d3bf7}=_0x1cdf43['body'],_0x341724=await transfers['findById']({'_id':_0x630f3e}),_0x459970=_0x341724[_0x5721d2(0x18b)][_0x5721d2(0x140)](async _0x14fbf7=>{var _0x2a84f9=_0x5721d2;if(_0x14fbf7[_0x2a84f9(0x115)]>0x0){var _0x411f6f=await warehouse['findOne']({'name':_0x341724[_0x2a84f9(0xfd)],'room':_0x14fbf7[_0x2a84f9(0xe8)],'warehouse_category':_0x2a84f9(0x127)});const _0x310d95=_0x411f6f[_0x2a84f9(0x1ba)]['map'](_0x2b7d4a=>{var _0x5e6b76=_0x2a84f9;_0x2b7d4a['product_name']==_0x14fbf7['product_name']&&_0x2b7d4a[_0x5e6b76(0xfc)]==_0x14fbf7[_0x5e6b76(0x112)]&&_0x2b7d4a[_0x5e6b76(0x139)]==_0x14fbf7[_0x5e6b76(0x18e)]&&_0x2b7d4a[_0x5e6b76(0x1bd)]==_0x14fbf7['from_bin']&&_0x2b7d4a[_0x5e6b76(0x136)]==_0x14fbf7[_0x5e6b76(0x167)]&&_0x2b7d4a[_0x5e6b76(0x1c9)]==_0x14fbf7[_0x5e6b76(0x10f)]&&_0x2b7d4a[_0x5e6b76(0x162)]==_0x14fbf7[_0x5e6b76(0x185)]&&_0x2b7d4a[_0x5e6b76(0x11c)]==_0x14fbf7[_0x5e6b76(0x11c)]&&_0x2b7d4a['batch_code']==_0x14fbf7[_0x5e6b76(0x15a)]&&_0x2b7d4a[_0x5e6b76(0x106)]==_0x14fbf7[_0x5e6b76(0x106)]&&_0x2b7d4a[_0x5e6b76(0x182)]==_0x14fbf7[_0x5e6b76(0x135)]&&(_0x2b7d4a['product_stock']=_0x2b7d4a[_0x5e6b76(0x1c7)]-_0x14fbf7['to_quantity']);});}return _0x411f6f;});Promise['all'](_0x459970)[_0x5721d2(0x15d)](async _0x257283=>{var _0x323c3c=_0x5721d2;try{for(const _0x35b9aa of _0x257283){await _0x35b9aa[_0x323c3c(0xee)]();}try{const _0x1ebebc=_0x341724[_0x323c3c(0x18b)][_0x323c3c(0x140)](async _0x4966df=>{var _0x57e181=_0x323c3c;if(_0x4966df[_0x57e181(0x115)]>0x0){var _0x10ace4=await warehouse[_0x57e181(0x1b6)]({'name':_0x341724['to_warehouse'],'room':_0x4966df[_0x57e181(0x111)],'warehouse_category':'Raw\x20Materials'}),_0x2cb586=0x0;const _0x8a5e9e=_0x10ace4[_0x57e181(0x1ba)]['map'](_0x148bbd=>{var _0x2b83bf=_0x57e181;_0x148bbd[_0x2b83bf(0x188)]==_0x4966df['product_name']&&_0x148bbd[_0x2b83bf(0xfc)]==_0x4966df['to_floorlevel']&&_0x148bbd[_0x2b83bf(0x139)]==_0x4966df[_0x2b83bf(0x1b9)]&&_0x148bbd[_0x2b83bf(0x1bd)]==_0x4966df[_0x2b83bf(0x192)]&&_0x148bbd[_0x2b83bf(0x136)]==_0x4966df[_0x2b83bf(0x1b0)]&&_0x148bbd[_0x2b83bf(0x1c9)]==_0x4966df['rack']&&_0x148bbd[_0x2b83bf(0x162)]==_0x4966df['storage']&&_0x148bbd[_0x2b83bf(0x11c)]==_0x4966df[_0x2b83bf(0x11c)]&&_0x148bbd['batch_code']==_0x4966df[_0x2b83bf(0x15a)]&&_0x148bbd[_0x2b83bf(0x106)]==_0x4966df[_0x2b83bf(0x106)]&&_0x148bbd[_0x2b83bf(0x182)]==_0x4966df[_0x2b83bf(0x10b)]&&(_0x148bbd['product_stock']=_0x148bbd[_0x2b83bf(0x1c7)]+_0x4966df['to_quantity'],_0x2cb586++);});_0x2cb586=='0'&&(_0x10ace4[_0x57e181(0x1ba)]=_0x10ace4['product_details']['concat']({'product_name':_0x4966df['product_name'],'product_stock':_0x4966df[_0x57e181(0x115)],'bay':_0x4966df[_0x57e181(0x1b0)],'bin':_0x4966df[_0x57e181(0x192)],'type':_0x4966df[_0x57e181(0x1b9)],'floorlevel':_0x4966df[_0x57e181(0x16e)],'storage':_0x4966df[_0x57e181(0x162)],'rack':_0x4966df[_0x57e181(0x1c9)],'product_code':_0x4966df['product_code'],'primary_code':_0x4966df[_0x57e181(0x160)],'secondary_code':_0x4966df[_0x57e181(0xe6)],'maxProducts':_0x4966df[_0x57e181(0xf9)],'storage':_0x4966df[_0x57e181(0x162)],'rack':_0x4966df[_0x57e181(0x1c9)],'expiry_date':_0x4966df[_0x57e181(0x11c)],'maxPerUnit':_0x4966df[_0x57e181(0x11e)],'batch_code':_0x4966df[_0x57e181(0x15a)],'production_date':_0x4966df[_0x57e181(0x106)]}));}return _0x10ace4;});Promise[_0x323c3c(0x1bf)](_0x1ebebc)['then'](async _0x4283ad=>{var _0x3740ef=_0x323c3c;try{for(const _0x438b89 of _0x4283ad){await warehouse[_0x3740ef(0xe3)]({'_id':_0x438b89['_id']},{'$addToSet':{'product_details':{'$each':_0x438b89['product_details']}}});}_0x341724[_0x3740ef(0x16f)]=_0x3740ef(0x17a);const _0xc2716e=await _0x341724[_0x3740ef(0xee)](),_0x4901ae=await master_shop[_0x3740ef(0x14d)](),_0xbf940d=await email_settings[_0x3740ef(0x1b6)](),_0x45dd9f=await supervisor_settings[_0x3740ef(0x14d)]();var _0x3ddf30=_0x341724[_0x3740ef(0x18b)],_0x304de7='',_0x936f41;for(_0x936f41 in _0x3ddf30){_0x304de7+=_0x3740ef(0xfb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3ddf30[_0x936f41][_0x3740ef(0x188)]+_0x3740ef(0x13a)+_0x3740ef(0x14a)+_0x3ddf30[_0x936f41][_0x3740ef(0x117)]+_0x3740ef(0x13a)+_0x3740ef(0x14a)+_0x3ddf30[_0x936f41][_0x3740ef(0x115)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3ddf30[_0x936f41][_0x3740ef(0x1a2)]+_0x3740ef(0x13a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3ddf30[_0x936f41][_0x3740ef(0x1b7)]+_0x3740ef(0x13a)+_0x3740ef(0x14a)+_0x341724['to_warehouse']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3ddf30[_0x936f41][_0x3740ef(0x111)]+'</td>'+_0x3740ef(0x14a)+_0x3ddf30[_0x936f41][_0x3740ef(0x162)]+_0x3ddf30[_0x936f41]['rack']+_0x3ddf30[_0x936f41]['to_bay']+_0x3ddf30[_0x936f41][_0x3740ef(0x192)]+_0x3ddf30[_0x936f41][_0x3740ef(0x1b9)][0x0]+_0x3ddf30[_0x936f41][_0x3740ef(0x16e)]+'</td>',_0x3740ef(0x1c1);}let _0x537689=nodemailer['createTransport']({'host':_0xbf940d[_0x3740ef(0x15c)],'port':Number(_0xbf940d[_0x3740ef(0xf4)]),'secure':![],'auth':{'user':_0xbf940d[_0x3740ef(0x1b4)],'pass':_0xbf940d[_0x3740ef(0xf0)]}}),_0x5d153d={'from':_0xbf940d[_0x3740ef(0x1b4)],'to':_0x45dd9f[0x0]['RMSEmail'],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x3740ef(0x142),'path':__dirname+_0x3740ef(0x16a)+'/upload/'+_0x4901ae[0x0][_0x3740ef(0x1ca)],'cid':'logo'}],'html':_0x3740ef(0x101)+'<html><head><title></title>'+'</head><body>'+_0x3740ef(0x171)+_0x3740ef(0x100)+'<div>'+_0x3740ef(0x133)+_0x3740ef(0x109)+_0x3740ef(0x171)+_0x3740ef(0x175)+_0x4901ae[0x0][_0x3740ef(0x169)]+_0x3740ef(0x114)+_0x3740ef(0x109)+_0x3740ef(0x109)+_0x3740ef(0x1bb)+_0x3740ef(0x171)+_0x3740ef(0x1aa)+_0x3740ef(0x153)+_0x341724[_0x3740ef(0x182)]+'\x20'+_0x3740ef(0x110)+_0x3740ef(0x151)+_0x341724[_0x3740ef(0x177)]+'\x20'+_0x3740ef(0xed)+'</h5>'+_0x3740ef(0x109)+_0x3740ef(0x19f)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x3740ef(0x165)+_0x3740ef(0x193)+_0x3740ef(0xea)+_0x3740ef(0x14e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3740ef(0xeb)+_0x3740ef(0x13f)+_0x3740ef(0xf6)+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x304de7+'\x20'+_0x3740ef(0x180)+'</table>'+'<div>'+_0x3740ef(0x1bc)+_0x3740ef(0x1b3)+_0x4901ae[0x0][_0x3740ef(0x169)]+_0x3740ef(0x11a)+_0x3740ef(0x109)+_0x3740ef(0x109)+_0x3740ef(0x11d)};_0x537689['sendMail'](_0x5d153d,function(_0x105baf,_0xd4a05d){var _0x5e7a6b=_0x3740ef;_0x105baf?(console['log'](_0x105baf),console[_0x5e7a6b(0x19b)](_0x5e7a6b(0x172))):console['log']('Email\x20sent\x20successfully');}),_0x1cdf43[_0x3740ef(0x1ae)](_0x3740ef(0x15b),_0x3740ef(0x12c)),_0xf66b68[_0x3740ef(0x149)](_0x3740ef(0x147)+_0xc2716e['_id']);}catch(_0x2ba2b0){console[_0x3740ef(0x12d)](_0x2ba2b0),_0xf66b68[_0x3740ef(0x124)](0x1f4)[_0x3740ef(0x125)]({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x2ba2b0[_0x3740ef(0x12e)]});}})[_0x323c3c(0x19c)](_0x53437c=>{var _0x28967b=_0x323c3c;console[_0x28967b(0x12d)](_0x53437c),_0xf66b68[_0x28967b(0x124)](0x1f4)[_0x28967b(0x125)]({'Perror':_0x28967b(0x17f)});});}catch(_0x2a640e){_0xf66b68[_0x323c3c(0x125)](_0x2a640e);}}catch(_0x74569d){console[_0x323c3c(0x12d)](_0x74569d),_0xf66b68[_0x323c3c(0x124)](0x1f4)['json']({'Merror':_0x323c3c(0x1be),'Message':_0x74569d['message']});}})[_0x5721d2(0x19c)](_0x49f89f=>{var _0x325f65=_0x5721d2;console['error'](_0x49f89f),_0xf66b68[_0x325f65(0x124)](0x1f4)[_0x325f65(0x125)]({'Merror':_0x325f65(0x17f)});});}catch(_0x46c782){console[_0x5721d2(0x19b)](_0x46c782);}});function BayBinSelected(_0xfaa843,_0x1e734e){var _0x1c689d=a0_0x426269,_0x39228d=[],_0x116a4b=[],_0x59cb64=[],_0x4f9600=[],_0x25fe59=[],_0x4aca9f=[];let _0x158005=[];if(_0xfaa843==_0x1c689d(0x184))switch(_0x1e734e){case _0x1c689d(0xe4):_0x39228d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x116a4b=[0x1,0x2],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=['Level',_0x1c689d(0xfe)],_0x25fe59=['D'],_0x4aca9f=['A'];break;case _0x1c689d(0x1c4):_0x39228d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x116a4b=[0x1,0x2],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=[_0x1c689d(0x10d),'Floor'],_0x25fe59=['D'],_0x4aca9f=['B'];break;case'Shelves':_0x39228d=[0x0],_0x116a4b=[0x0],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=[_0x1c689d(0xfe)],_0x25fe59=['D'],_0x4aca9f=['S'];break;case _0x1c689d(0x10e):_0x39228d=[0x0],_0x116a4b=[0x0],_0x4f9600=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x59cb64=[_0x1c689d(0xfe)],_0x25fe59=['D'],_0x4aca9f=['R'];break;}else{if(_0xfaa843==_0x1c689d(0x163))switch(_0x1e734e){case'Rack\x20A':_0x39228d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x116a4b=['B','F'],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=[_0x1c689d(0x10d),'Floor'],_0x25fe59=['C'],_0x4aca9f=['A'];break;case'Rack\x20B':_0x39228d=[0x5,0x4,0x3,0x2,0x1],_0x116a4b=['F','B','S'],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=[_0x1c689d(0x10d),_0x1c689d(0xfe)],_0x25fe59=['C'],_0x4aca9f=['B'];break;case'Rack\x20C':_0x39228d=[0x1,0x2,0x3,0x4,0x5],_0x116a4b=['B','F','S'],_0x4f9600=[0x5,0x4,0x3,0x2,0x1],_0x59cb64=[_0x1c689d(0x10d),_0x1c689d(0xfe)],_0x25fe59=['C'],_0x4aca9f=['C'];break;case _0x1c689d(0x1c5):_0x39228d=[0x5,0x4,0x3,0x2,0x1],_0x116a4b=['F','B','S'],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=[_0x1c689d(0x10d),'Floor'],_0x25fe59=['C'],_0x4aca9f=['D'];break;case _0x1c689d(0x170):_0x39228d=[0x4,0x3,0x2,0x1],_0x116a4b=[0x1,0x2],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=[_0x1c689d(0x10d),'Floor'],_0x25fe59=['C'],_0x4aca9f=['E'];break;case'Rack\x20F':_0x39228d=[0x1,0x2,0x3],_0x116a4b=[0x1,0x2],_0x4f9600=[0x1,0x2,0x3,0x4,0x5],_0x59cb64=[_0x1c689d(0x10d)],_0x25fe59=['C'],_0x4aca9f=['F'];break;}}return{'levels':_0x39228d,'Isle':_0x116a4b,'rack':_0x4f9600,'type':_0x59cb64,'storage':_0x25fe59,'rak':_0x4aca9f};}function a0_0xb19f(_0x34b68f,_0x5f3994){var _0x80632b=a0_0x8063();return a0_0xb19f=function(_0xb19f07,_0x36abee){_0xb19f07=_0xb19f07-0xe3;var _0x5d45ce=_0x80632b[_0xb19f07];return _0x5d45ce;},a0_0xb19f(_0x34b68f,_0x5f3994);}function a0_0x8063(){var _0x48c2c8=['\x20</h2>','to_quantity','edit_transfer','product_code','40AJXnby','../public/language/languages.json','</h5>','$room','expiry_date','</body></html>','maxperunit','warehouse','master','to_room','staff','rak','status','json','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Raw\x20Materials','$product_details.pallet','string','$product_details','English\x20(US)','Transfer\x20Finalize\x20Successfully','error','message','499854JznyZa','/view/add_transfer','RoomAssigned','$product_details.maxPerUnit','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','French','from_invoice','bay','$product_details.bay','$product_details.secondary_unit','type','</td>','from_rak','$product_details.bin','primary_unit','from_prod_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','map','max_per_unit','Logo.png','/CheckingWarehouse','TRF-','/view/:id','/preview/:id','/picking_list/PDF_transfer_rm/','filter','redirect','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','nodemailer','to_warehouse','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.batch_code','findById','\x20Order\x20Date\x20:\x20','109694YvYJQA','\x20Order\x20Number\x20:\x20','$product_details.production_date','New_Qty_Converted','Chinese','prod_cat','split','floor','batch_code','success','host','then','Spanish','params','primary_code','$product_details._id','storage','COLD\x20STORAGE','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','aggregate','from_bay','user','site_title','/../public','post','$name','render','to_floorlevel','finalize','Rack\x20E','<div>','Error\x20Occurs','$product','from_prod_isle','<h2>\x20','$product_details.secondary_code','date','random','push','True','to_prod_pallet','$product_details.type','to_prod_level','14QUwejg','An\x20error\x20occurred.','</tbody>','$product_details.rack','invoice','$product_details.floorlevel','DRY\x20STORAGE','from_storage','role','$product_details.level','product_name','German','/view','product','Enabled','edit_transfer_view','from_types','toString','slice','MaxStocks_data2','to_bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','note','to_prod_qty','$product_details.isle','Arabic\x20(ae)','$product_details.expiry_date','467032URKEJb','$product_details.product_code','log','catch','Enclosed','Hindi','<table\x20style=\x22width:\x20100%\x20!important;\x22>','getFullYear','$product_details.storage','unit','from_room','1076955gkgyHc','transfer','124525KrfhHR','$finalize','to_prod_isle','from_prod_pallet','<h5\x20style=\x22text-align:\x20left;\x22>','Transfer\x20Edit\x20Successfully','get','/transfer/view','flash','product_code3','to_bay','from_prod_level','$product_details.primary_code','<h5>','email','$product.to_room_name','findOne','secondary_unit','$isAllowEdit','to_types','product_details','<hr\x20class=\x22my-3\x22>','<strong>\x20Regards\x20</strong>','bin','An\x20error\x20occurred\x20while\x20saving\x20data.','all','Portuguese','</tr>','Product\x20Transfer\x20successfully','../middleware/auth','Rack\x20B','Rack\x20D','from_bin','product_stock','Shelves','rack','image','updateOne','Rack\x20A','forEach','secondary_code','$product_details.product_stock','from_room_name','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','ToRoomAssigned','</span>','save','English','password','../models/all_models','Return\x20Rooms','89000faDfmG','port','$invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.unit','$to_warehouse','maxProducts','language','<tr>','floorlevel','from_warehouse','Floor','4965291TgkYKW','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<!DOCTYPE\x20html>','add_transfer','$product_details.product_name','Portuguese\x20(BR)','from_quantity','production_date','body','errors','</div>','to_invoice','To_invoice','$product_details.maxProducts','Level','Receiving\x20Area','from_rack','<span\x20style=\x22float:\x20right;\x22>','to_room_name','from_floorlevel','prod_name'];a0_0x8063=function(){return _0x48c2c8;};return a0_0x8063();}router[a0_0x426269(0x1ac)](a0_0x426269(0x145),auth,async(_0x1a9c2a,_0x51e6a0)=>{var _0x1a4b71=a0_0x426269;try{const {username:_0x578a90,email:_0x717ff8,role:_0x564140}=_0x1a9c2a[_0x1a4b71(0x168)],_0x58cc6e=_0x1a9c2a[_0x1a4b71(0x168)],_0x521294=await profile[_0x1a4b71(0x1b6)]({'email':_0x58cc6e[_0x1a4b71(0x1b4)]}),_0x1c4315=await master_shop[_0x1a4b71(0x14d)](),_0x10d2a1=await transfers['findById'](_0x1a9c2a[_0x1a4b71(0x15f)]['id']);let _0x77f7b7;if(_0x58cc6e[_0x1a4b71(0x186)]==_0x1a4b71(0x122)){const _0x5a3c43=await staff[_0x1a4b71(0x1b6)]({'email':_0x58cc6e[_0x1a4b71(0x1b4)]});_0x77f7b7=await warehouse[_0x1a4b71(0x166)]([{'$match':{'status':_0x1a4b71(0x18c),'name':_0x5a3c43[_0x1a4b71(0x11f)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x1a4b71(0x16c),'name':{'$first':_0x1a4b71(0x16c)}}}]);}else _0x77f7b7=await warehouse[_0x1a4b71(0x166)]([{'$match':{'status':'Enabled','warehouse_category':_0x1a4b71(0x127)}},{'$group':{'_id':_0x1a4b71(0x16c),'name':{'$first':_0x1a4b71(0x16c)}}}]);const _0x351301=await warehouse['aggregate']([{'$match':{'name':_0x10d2a1[_0x1a4b71(0xfd)],'warehouse_category':_0x1a4b71(0x127)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1a4b71(0x161),'name':{'$first':_0x1a4b71(0x103)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1a4b71(0x137)},'bin':{'$first':_0x1a4b71(0x13c)},'type':{'$first':_0x1a4b71(0x17c)},'floorlevel':{'$first':_0x1a4b71(0x183)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1a4b71(0x176)},'product_code':{'$first':_0x1a4b71(0x19a)},'storage':{'$first':_0x1a4b71(0x1a1)},'rack':{'$first':_0x1a4b71(0x181)},'expiry_date':{'$first':_0x1a4b71(0x198)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0x264e08=await product[_0x1a4b71(0x14d)]({}),_0x1d4c96=BayBinSelected(_0x10d2a1['to_warehouse'],_0x10d2a1[_0x1a4b71(0x121)]);if(_0x1c4315[0x0][_0x1a4b71(0xfa)]==_0x1a4b71(0x12b)){var _0x279176=users['English'];console['log'](_0x279176);}else{if(_0x1c4315[0x0][_0x1a4b71(0xfa)]=='Hindi')var _0x279176=users[_0x1a4b71(0x19e)];else{if(_0x1c4315[0x0][_0x1a4b71(0xfa)]==_0x1a4b71(0x189))var _0x279176=users[_0x1a4b71(0x189)];else{if(_0x1c4315[0x0][_0x1a4b71(0xfa)]=='Spanish')var _0x279176=users[_0x1a4b71(0x15e)];else{if(_0x1c4315[0x0][_0x1a4b71(0xfa)]=='French')var _0x279176=users[_0x1a4b71(0x134)];else{if(_0x1c4315[0x0][_0x1a4b71(0xfa)]==_0x1a4b71(0x104))var _0x279176=users['Portuguese'];else{if(_0x1c4315[0x0][_0x1a4b71(0xfa)]==_0x1a4b71(0x156))var _0x279176=users[_0x1a4b71(0x156)];else{if(_0x1c4315[0x0][_0x1a4b71(0xfa)]==_0x1a4b71(0x197))var _0x279176=users[_0x1a4b71(0xe9)];}}}}}}}_0x51e6a0['render'](_0x1a4b71(0x116),{'success':_0x1a9c2a['flash'](_0x1a4b71(0x15b)),'errors':_0x1a9c2a[_0x1a4b71(0x1ae)]('errors'),'role':_0x58cc6e,'profile':_0x521294,'master_shop':_0x1c4315,'warehouse':_0x77f7b7,'transfer':_0x10d2a1,'stock':_0x351301,'unit':_0x264e08,'language':_0x279176});}catch(_0xd23694){console[_0x1a4b71(0x19b)](_0xd23694);}}),router[a0_0x426269(0x16b)](a0_0x426269(0x145),auth,async(_0x452c9a,_0x5f337c)=>{var _0x924e73=a0_0x426269;try{const _0x124b6c=_0x452c9a[_0x924e73(0x15f)]['id'],_0x251cb4=await transfers[_0x924e73(0x150)](_0x124b6c);_0x5f337c[_0x924e73(0x125)](_0x452c9a[_0x924e73(0x107)]);return;const {date:_0x30d9a6,from_warehouse:_0x2c41d9,FromRoom_name:_0x49f7a4,to_warehouse:_0x55795d,ToRoom_name:_0x612984,prod_name:_0x2fe729,from_prod_qty:_0xb8c23e,from_prod_level:_0x1e1311,from_prod_isle:_0x27a43c,from_prod_pallet:_0x3e1309,to_prod_qty:_0x3b5326,to_prod_level:_0x50932d,to_prod_isle:_0x4c07bb,to_prod_pallet:_0x28f19c,primary_code:_0x20d498,secondary_code:_0x349b12,product_code3:_0x1645bf,note:_0xd3c224,invoice:_0x36a3b5,expiry_date:_0x1550cd}=_0x452c9a['body'];if(typeof _0x2fe729==_0x924e73(0x129))var _0x2de384=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x113)]],_0x3ce836=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x13e)]],_0x3c22f8=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x1b1)]],_0x49326e=[_0x452c9a['body']['from_prod_isle']],_0x4f5e3c=[_0x452c9a['body'][_0x924e73(0x1a9)]],_0x310e9b=[_0x452c9a['body'][_0x924e73(0x18e)]],_0x244513=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x195)]],_0x17adff=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x17d)]],_0x17eb5a=[_0x452c9a['body'][_0x924e73(0x1a8)]],_0x44c86e=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x17b)]],_0x3d617c=[_0x452c9a['body']['to_types']],_0x325584=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x162)]],_0x3691ab=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x123)]],_0x140b30=[_0x452c9a['body'][_0x924e73(0x160)]],_0x40ea51=[_0x452c9a[_0x924e73(0x107)]['secondary_code']],_0x3b8b7d=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x1af)]],_0x4b7c6f=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x191)]],_0x18da6a=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x1a2)]],_0x25c8c0=[_0x452c9a[_0x924e73(0x107)][_0x924e73(0x1b7)]],_0x58857c=[_0x452c9a['body']['batch_code']],_0x4d5eeb=[_0x452c9a[_0x924e73(0x107)]['expiry_date']],_0xb7e2dc=[_0x452c9a['body'][_0x924e73(0x185)]],_0x236bad=[_0x452c9a['body'][_0x924e73(0x13b)]];else var _0x2de384=[..._0x452c9a['body']['prod_name']],_0x325584=[..._0x452c9a[_0x924e73(0x107)]['storage']],_0x3691ab=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x123)]],_0x310e9b=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x18e)]],_0x3d617c=[..._0x452c9a['body'][_0x924e73(0x1b9)]],_0x3ce836=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x13e)]],_0x3c22f8=[..._0x452c9a[_0x924e73(0x107)]['from_prod_level']],_0x49326e=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x174)]],_0x4f5e3c=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x1a9)]],_0x244513=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x195)]],_0x17adff=[..._0x452c9a['body'][_0x924e73(0x17d)]],_0x17eb5a=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x1a8)]],_0x44c86e=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x17b)]],_0x140b30=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x160)]],_0x40ea51=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0xe6)]],_0x3b8b7d=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x1af)]],_0x4b7c6f=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x191)]],_0x18da6a=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x1a2)]],_0x25c8c0=[..._0x452c9a[_0x924e73(0x107)]['secondary_unit']],_0x58857c=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x15a)]],_0x4d5eeb=[..._0x452c9a[_0x924e73(0x107)][_0x924e73(0x11c)]],_0xb7e2dc=[..._0x452c9a[_0x924e73(0x107)]['from_storage']],_0x236bad=[..._0x452c9a['body'][_0x924e73(0x13b)]];const _0x306ec1=_0x2de384[_0x924e73(0x140)](_0xfdc941=>{return _0xfdc941={'product_name':_0xfdc941};});_0x3ce836[_0x924e73(0xe5)]((_0x30f75e,_0x465599)=>{var _0x3f2d27=_0x924e73;_0x306ec1[_0x465599][_0x3f2d27(0x105)]=_0x30f75e;}),_0x3c22f8[_0x924e73(0xe5)]((_0x3bcabb,_0x227147)=>{var _0x45ee7e=_0x924e73;_0x306ec1[_0x227147][_0x45ee7e(0x167)]=_0x3bcabb;}),_0x49326e['forEach']((_0x3a6679,_0x56447f)=>{var _0x101748=_0x924e73;_0x306ec1[_0x56447f][_0x101748(0x1c6)]=_0x3a6679;}),_0x4f5e3c[_0x924e73(0xe5)]((_0x4c1c64,_0x51545e)=>{_0x306ec1[_0x51545e]['from_floorlevel']=_0x4c1c64;}),_0x244513[_0x924e73(0xe5)]((_0x484cef,_0x2c21ec)=>{var _0xd7a17b=_0x924e73;_0x306ec1[_0x2c21ec][_0xd7a17b(0x115)]=_0x484cef;}),_0x17adff[_0x924e73(0xe5)]((_0x271752,_0x1320f0)=>{var _0x7260c1=_0x924e73;_0x306ec1[_0x1320f0][_0x7260c1(0x1b0)]=_0x271752;}),_0x17eb5a['forEach']((_0x295398,_0x21f8cf)=>{var _0x1f9137=_0x924e73;_0x306ec1[_0x21f8cf][_0x1f9137(0x192)]=_0x295398;}),_0x44c86e['forEach']((_0x18266e,_0x14349a)=>{var _0x2278fb=_0x924e73;_0x306ec1[_0x14349a][_0x2278fb(0x16e)]=_0x18266e;}),_0x140b30[_0x924e73(0xe5)]((_0x161f39,_0x130940)=>{var _0x47ec72=_0x924e73;_0x306ec1[_0x130940][_0x47ec72(0x160)]=_0x161f39;}),_0x40ea51[_0x924e73(0xe5)]((_0x4e4d53,_0x2d9379)=>{var _0x52bf27=_0x924e73;_0x306ec1[_0x2d9379][_0x52bf27(0xe6)]=_0x4e4d53;}),_0x3b8b7d[_0x924e73(0xe5)]((_0x55003f,_0x37134b)=>{var _0x4f8ce4=_0x924e73;_0x306ec1[_0x37134b][_0x4f8ce4(0x117)]=_0x55003f;}),_0x4b7c6f[_0x924e73(0xe5)]((_0x5c65b9,_0x29e1f0)=>{var _0x25c76a=_0x924e73;_0x306ec1[_0x29e1f0][_0x25c76a(0xf9)]=_0x5c65b9;}),_0x18da6a[_0x924e73(0xe5)]((_0x3a818c,_0x3dde0c)=>{var _0x929515=_0x924e73;_0x306ec1[_0x3dde0c][_0x929515(0x1a2)]=_0x3a818c;}),_0x25c8c0['forEach']((_0x47a140,_0x145a05)=>{_0x306ec1[_0x145a05]['secondary_unit']=_0x47a140;}),_0x58857c['forEach']((_0x2f37fc,_0x4a78df)=>{var _0x476a04=_0x924e73;_0x306ec1[_0x4a78df][_0x476a04(0x15a)]=_0x2f37fc;}),_0x4d5eeb[_0x924e73(0xe5)]((_0x16863f,_0x20264b)=>{var _0x19f67f=_0x924e73;_0x306ec1[_0x20264b][_0x19f67f(0x11c)]=_0x16863f;}),_0x325584[_0x924e73(0xe5)]((_0x105498,_0x20735f)=>{var _0x56ef22=_0x924e73;_0x306ec1[_0x20735f][_0x56ef22(0x162)]=_0x105498;}),_0x3691ab[_0x924e73(0xe5)]((_0x38732c,_0x5f4dc0)=>{var _0x5ed9fa=_0x924e73;_0x306ec1[_0x5f4dc0][_0x5ed9fa(0x1c9)]=_0x38732c;}),_0x310e9b['forEach']((_0x50c3e6,_0x40101c)=>{var _0x189b74=_0x924e73;_0x306ec1[_0x40101c][_0x189b74(0x18e)]=_0x50c3e6;}),_0x3d617c['forEach']((_0x1ff479,_0x518371)=>{var _0x53876a=_0x924e73;_0x306ec1[_0x518371][_0x53876a(0x1b9)]=_0x1ff479;}),_0xb7e2dc[_0x924e73(0xe5)]((_0x29ca62,_0x44a85a)=>{_0x306ec1[_0x44a85a]['from_storage']=_0x29ca62;}),_0x236bad[_0x924e73(0xe5)]((_0x17f60a,_0x4dc4d3)=>{_0x306ec1[_0x4dc4d3]['from_rack']=_0x17f60a;});const _0x3dfd97=_0x306ec1[_0x924e73(0x148)](_0x3621fc=>_0x3621fc[_0x924e73(0x115)]!=='0'&&_0x3621fc[_0x924e73(0x115)]!==''||_0x3621fc[_0x924e73(0x16e)]!=='0'&&_0x3621fc[_0x924e73(0x16e)]!=='');var _0x46db24=0x0;_0x3dfd97['forEach'](_0x88924f=>{var _0x472698=_0x924e73;parseInt(_0x88924f[_0x472698(0x105)])<parseInt(_0x88924f[_0x472698(0x115)])&&_0x46db24++;});if(_0x46db24!=0x0)return _0x452c9a[_0x924e73(0x1ae)](_0x924e73(0x108),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x5f337c[_0x924e73(0x149)]('back');const _0x2a2da6=await warehouse[_0x924e73(0x1b6)]({'name':_0x251cb4[_0x924e73(0xfd)],'room':_0x251cb4[_0x924e73(0x1a3)]});_0x251cb4['product'][_0x924e73(0xe5)](_0x439137=>{var _0x18f6b9=_0x924e73;if(_0x439137[_0x18f6b9(0x115)]>0x0){const _0x5e3188=_0x2a2da6[_0x18f6b9(0x1ba)][_0x18f6b9(0x140)](_0x233ba5=>{var _0x4f0eb4=_0x18f6b9;_0x233ba5[_0x4f0eb4(0x188)]==_0x439137['product_name']&&_0x233ba5['floorlevel']==_0x439137[_0x4f0eb4(0x112)]&&_0x233ba5[_0x4f0eb4(0x139)]==_0x439137[_0x4f0eb4(0x18e)]&&_0x233ba5[_0x4f0eb4(0x1bd)]==_0x439137['from_bin']&&_0x233ba5['bay']==_0x439137['from_bay']&&_0x233ba5[_0x4f0eb4(0x1c9)]==_0x439137[_0x4f0eb4(0x10f)]&&_0x233ba5[_0x4f0eb4(0x162)]==_0x439137[_0x4f0eb4(0x185)]&&(_0x233ba5['product_stock']=parseInt(_0x233ba5[_0x4f0eb4(0x1c7)])+parseInt(_0x439137[_0x4f0eb4(0x115)]));});}}),await _0x2a2da6['save']();const _0x3d1d82=await warehouse['findOne']({'name':_0x251cb4[_0x924e73(0x14c)],'room':_0x251cb4[_0x924e73(0x121)]});_0x251cb4[_0x924e73(0x18b)]['forEach'](_0x2d3c26=>{var _0x56cdc8=_0x924e73;if(_0x2d3c26[_0x56cdc8(0x115)]>0x0){const _0x1e3680=_0x3d1d82[_0x56cdc8(0x1ba)][_0x56cdc8(0x140)](_0x39f195=>{var _0x284d30=_0x56cdc8;_0x39f195[_0x284d30(0x188)]==_0x2d3c26['product_name']&&_0x39f195[_0x284d30(0xfc)]==_0x2d3c26[_0x284d30(0x16e)]&&_0x39f195[_0x284d30(0x139)]==_0x2d3c26[_0x284d30(0x1b9)]&&_0x39f195['bin']==_0x2d3c26[_0x284d30(0x192)]&&_0x39f195[_0x284d30(0x136)]==_0x2d3c26[_0x284d30(0x1b0)]&&_0x39f195[_0x284d30(0x1c9)]==_0x2d3c26[_0x284d30(0x1c9)]&&_0x39f195['storage']==_0x2d3c26[_0x284d30(0x162)]&&(_0x39f195[_0x284d30(0x1c7)]=parseInt(_0x39f195[_0x284d30(0x1c7)])-parseInt(_0x2d3c26[_0x284d30(0x115)]));});}}),await _0x3d1d82[_0x924e73(0xee)](),_0x251cb4['date']=_0x30d9a6,_0x251cb4['from_warehouse']=_0x2c41d9,_0x251cb4['to_warehouse']=_0x55795d,_0x251cb4[_0x924e73(0x18b)]=_0x3dfd97,_0x251cb4[_0x924e73(0x194)]=_0xd3c224,_0x251cb4[_0x924e73(0x182)]=_0x36a3b5;const _0x305e66=await _0x251cb4['save']();console[_0x924e73(0x19b)](_0x305e66);const _0x25c775=await warehouse[_0x924e73(0x1b6)]({'name':_0x2c41d9,'room':_0x49f7a4});_0x305e66[_0x924e73(0x18b)][_0x924e73(0xe5)](_0x54a14c=>{var _0x4bb50f=_0x924e73;if(_0x54a14c['to_quantity']>0x0){const _0x21734c=_0x25c775['product_details'][_0x4bb50f(0x140)](_0x15c566=>{var _0x5065d9=_0x4bb50f;_0x15c566['product_name']==_0x54a14c[_0x5065d9(0x188)]&&_0x15c566[_0x5065d9(0xfc)]==_0x54a14c['from_floorlevel']&&_0x15c566[_0x5065d9(0x139)]==_0x54a14c['from_types']&&_0x15c566[_0x5065d9(0x1bd)]==_0x54a14c['from_bin']&&_0x15c566['bay']==_0x54a14c['from_bay']&&_0x15c566[_0x5065d9(0x1c9)]==_0x54a14c['from_rack']&&_0x15c566[_0x5065d9(0x162)]==_0x54a14c[_0x5065d9(0x185)]&&(_0x15c566[_0x5065d9(0x1c7)]=parseInt(_0x15c566[_0x5065d9(0x1c7)])-parseInt(_0x54a14c[_0x5065d9(0x115)]));});}}),await _0x25c775[_0x924e73(0xee)]();const _0xcb1099=await warehouse['findOne']({'name':_0x55795d,'room':_0x612984});_0x305e66['product'][_0x924e73(0xe5)](_0x20a974=>{var _0x3614a8=_0x924e73;if(_0x20a974[_0x3614a8(0x115)]>0x0){var _0x548661=0x0;const _0x10140d=_0xcb1099[_0x3614a8(0x1ba)][_0x3614a8(0x140)](_0x189ca4=>{var _0x1afe3d=_0x3614a8;_0x189ca4[_0x1afe3d(0x188)]==_0x20a974['product_name']&&_0x189ca4['floorlevel']==_0x20a974[_0x1afe3d(0x16e)]&&_0x189ca4[_0x1afe3d(0x139)]==_0x20a974[_0x1afe3d(0x1b9)]&&_0x189ca4[_0x1afe3d(0x1bd)]==_0x20a974[_0x1afe3d(0x192)]&&_0x189ca4[_0x1afe3d(0x136)]==_0x20a974[_0x1afe3d(0x1b0)]&&_0x189ca4[_0x1afe3d(0x1c9)]==_0x20a974[_0x1afe3d(0x1c9)]&&_0x189ca4[_0x1afe3d(0x162)]==_0x20a974[_0x1afe3d(0x162)]&&(_0x189ca4[_0x1afe3d(0x1c7)]=parseInt(_0x189ca4['product_stock'])+parseInt(_0x20a974[_0x1afe3d(0x115)]),_0x548661++);});_0x548661=='0'&&(_0xcb1099[_0x3614a8(0x1ba)]=_0xcb1099[_0x3614a8(0x1ba)]['concat']({'product_name':_0x20a974['product_name'],'product_stock':_0x20a974[_0x3614a8(0x115)],'bay':_0x20a974[_0x3614a8(0x1b0)],'bin':_0x20a974[_0x3614a8(0x192)],'type':_0x20a974[_0x3614a8(0x1b9)],'floorlevel':_0x20a974[_0x3614a8(0x16e)],'storage':_0x20a974['storage'],'rack':_0x20a974[_0x3614a8(0x1c9)],'product_code':_0x20a974[_0x3614a8(0x117)],'primary_code':_0x20a974[_0x3614a8(0x160)],'secondary_code':_0x20a974['secondary_code'],'maxProducts':_0x20a974['maxProducts'],'storage':_0x20a974[_0x3614a8(0x162)],'rack':_0x20a974[_0x3614a8(0x1c9)]}));}}),await _0xcb1099[_0x924e73(0xee)](),_0x452c9a['flash'](_0x924e73(0x15b),_0x924e73(0x1ab)),_0x5f337c[_0x924e73(0x149)](_0x924e73(0x1ad));}catch(_0x3cd077){console[_0x924e73(0x19b)](_0x3cd077);}}),router[a0_0x426269(0x16b)]('/barcode_scanner',async(_0x1a37fa,_0x550348)=>{var _0x506292=a0_0x426269;const {FromWareHouse:_0x25ff1c,FromRoom:_0xb51ac9,ToWarehouse:_0x565f87,ToRoom:_0x398f5a,primary_code:_0x18fb37,Roomslist:_0x50093a}=_0x1a37fa[_0x506292(0x107)],_0xde8908=_0x50093a[_0x506292(0x158)](','),_0x25bf78=[];async function _0x896c6f(_0x422660){var _0x2a6e60=_0x506292;const _0x367396=await warehouse[_0x2a6e60(0x166)]([{'$match':{'name':_0x25ff1c,'room':_0x422660}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x18fb37}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2a6e60(0x103)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2a6e60(0x1b2)},'secondary_code':{'$first':_0x2a6e60(0x176)},'product_code':{'$first':_0x2a6e60(0x19a)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x2a6e60(0x13c)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2a6e60(0x183)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2a6e60(0x181)},'expiry_date':{'$first':_0x2a6e60(0x198)},'production_date':{'$first':_0x2a6e60(0x154)},'batch_code':{'$first':_0x2a6e60(0x14f)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x2a6e60(0x11b)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]),_0x27a28c=await warehouse[_0x2a6e60(0x166)]([{'$match':{'name':_0x25ff1c,'room':_0x422660}},{'$unwind':_0x2a6e60(0x12a)},{'$match':{'product_details.secondary_code':_0x18fb37}},{'$group':{'_id':_0x2a6e60(0x161),'name':{'$first':_0x2a6e60(0x103)},'instock':{'$first':_0x2a6e60(0xe7)},'primary_code':{'$first':_0x2a6e60(0x1b2)},'secondary_code':{'$first':_0x2a6e60(0x176)},'product_code':{'$first':_0x2a6e60(0x19a)},'level':{'$first':_0x2a6e60(0x137)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x2a6e60(0x17c)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2a6e60(0xf7)},'secondary_unit':{'$first':_0x2a6e60(0x138)},'storage':{'$first':_0x2a6e60(0x1a1)},'rack':{'$first':_0x2a6e60(0x181)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2a6e60(0x154)},'batch_code':{'$first':_0x2a6e60(0x14f)},'maxPerUnit':{'$first':_0x2a6e60(0x132)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x2a6e60(0x11b)},'maxProducts':{'$first':_0x2a6e60(0x10c)}}}]);if(_0x367396['length']>0x0)_0x25bf78[_0x2a6e60(0x179)](_0x367396);else _0x27a28c[_0x2a6e60(0x164)]>0x0&&_0x25bf78['push'](_0x27a28c);}const _0x3eae84=_0xde8908[_0x506292(0x140)](_0x33a6cc=>_0x896c6f(_0x33a6cc));await Promise[_0x506292(0x1bf)](_0x3eae84),_0x550348[_0x506292(0x125)](_0x25bf78);}),router[a0_0x426269(0x16b)]('/barcode_scanner2',async(_0x29fcfd,_0x2538f4)=>{var _0x5cf9d3=a0_0x426269;try{const {FromWareHouse:_0x2d1ddb,FromRoom:_0x536f28,ToWarehouse:_0x29f215,ToRoom:_0x44bdbb,secondary_code:_0x36e8ae}=_0x29fcfd[_0x5cf9d3(0x107)],_0x479c7c=await warehouse[_0x5cf9d3(0x166)]([{'$match':{'name':_0x2d1ddb}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x36e8ae}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5cf9d3(0x103)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x5cf9d3(0xe7)},'warehouse':{'$first':_0x5cf9d3(0x16c)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5cf9d3(0x196)},'pallet':{'$first':_0x5cf9d3(0x128)},'maxProducts':{'$first':_0x5cf9d3(0x10c)},'unit':{'$first':_0x5cf9d3(0xf7)}}}]);_0x2538f4[_0x5cf9d3(0x124)](0xc8)['json'](_0x479c7c);}catch(_0x51fb27){_0x2538f4[_0x5cf9d3(0x124)](0x194)['json']({'message':_0x51fb27[_0x5cf9d3(0x12e)]});}}),router['post']('/barcode_scanner3',async(_0x2f4615,_0x5d74c6)=>{var _0x18959b=a0_0x426269;try{const {FromWareHouse:_0x4afbcd,FromRoom:_0x546b4b,ToWarehouse:_0x2a70c7,ToRoom:_0x3d538f,product_code:_0x2bf5b9}=_0x2f4615[_0x18959b(0x107)],_0x18aaac=await warehouse[_0x18959b(0x166)]([{'$match':{'name':_0x4afbcd}},{'$unwind':_0x18959b(0x12a)},{'$match':{'product_details.product_code':_0x2bf5b9}},{'$group':{'_id':_0x18959b(0x161),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x18959b(0x1b2)},'secondary_code':{'$first':_0x18959b(0x176)},'product_code':{'$first':_0x18959b(0x19a)},'instock':{'$first':_0x18959b(0xe7)},'warehouse':{'$first':_0x18959b(0x16c)},'level':{'$first':_0x18959b(0x187)},'isle':{'$first':_0x18959b(0x196)},'pallet':{'$first':_0x18959b(0x128)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x18959b(0xf7)}}}]);_0x5d74c6[_0x18959b(0x124)](0xc8)[_0x18959b(0x125)](_0x18aaac);}catch(_0x5c3ce8){_0x5d74c6[_0x18959b(0x124)](0x194)[_0x18959b(0x125)]({'message':_0x5c3ce8['message']});}}),router[a0_0x426269(0x16b)](a0_0x426269(0x143),async(_0x407eb6,_0x3b85cf)=>{var _0x3ae0e9=a0_0x426269;const {level:_0x24fd74,isle:_0x46397b,pallet:_0x2f522b,warehouses:_0x2e8c5e,room:_0x31ed52}=_0x407eb6[_0x3ae0e9(0x107)];try{const _0x1ed1e8=await warehouse['aggregate']([{'$match':{'name':_0x2e8c5e,'room':_0x31ed52}},{'$unwind':_0x3ae0e9(0x12a)},{'$match':{'product_details.level':parseInt(_0x24fd74),'product_details.isle':_0x46397b,'product_details.pallet':parseInt(_0x2f522b)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3ae0e9(0x103)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3ae0e9(0x196)},'pallet':{'$first':_0x3ae0e9(0x128)},'maxProducts':{'$first':_0x3ae0e9(0x10c)}}}]);_0x3b85cf[_0x3ae0e9(0x124)](0xc8)[_0x3ae0e9(0x125)](_0x1ed1e8);}catch(_0x4d7321){_0x3b85cf['status'](0x194)[_0x3ae0e9(0x125)]({'message':_0x4d7321[_0x3ae0e9(0x12e)]});}}),module['exports']=router;