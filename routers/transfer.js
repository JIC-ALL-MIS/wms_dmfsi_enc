var a0_0x515a4a=a0_0x5817;(function(_0x16cdab,_0x278914){var _0x5096ca=a0_0x5817,_0x2fae18=_0x16cdab();while(!![]){try{var _0x1fc6df=parseInt(_0x5096ca(0x1eb))/0x1*(-parseInt(_0x5096ca(0x1ae))/0x2)+parseInt(_0x5096ca(0x17c))/0x3*(parseInt(_0x5096ca(0x1c2))/0x4)+parseInt(_0x5096ca(0x1c6))/0x5+-parseInt(_0x5096ca(0x21d))/0x6+parseInt(_0x5096ca(0x1e6))/0x7+-parseInt(_0x5096ca(0x1a0))/0x8*(parseInt(_0x5096ca(0x182))/0x9)+-parseInt(_0x5096ca(0x221))/0xa;if(_0x1fc6df===_0x278914)break;else _0x2fae18['push'](_0x2fae18['shift']());}catch(_0x394010){_0x2fae18['push'](_0x2fae18['shift']());}}}(a0_0x26d0,0x80a09),require(a0_0x515a4a(0x20e))[a0_0x515a4a(0x17d)]());const express=require(a0_0x515a4a(0x1fc)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x515a4a(0x246)),auth=require('../middleware/auth'),users=require(a0_0x515a4a(0x241)),nodemailer=require('nodemailer'),mongoose=require(a0_0x515a4a(0x1a8));function a0_0x26d0(){var _0x3d7cc9=['Arabic\x20(ae)','withTransaction','from_quantity','$product_details.product_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','note','$product_details.product_name','$product_details.rack','/view/add_transfer','to_bin','from_floorlevel','Level','RoomAssigned','findOne','Product\x20Transfer\x20successfully','$product_details.product_stock','product','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','/view/:id','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.bay','Portuguese','No\x20matching\x20document\x20found\x20for\x20product\x20ID\x20','primary_code','to_prod_pallet','$invoice','language','</tr>','<span\x20style=\x22float:\x20right;\x22>','rack','6307385rrWFmb','unit','To_invoice','catch','to_invoice','3GOQjSm','Rack\x20D','Return\x20Rooms','session','$product_details.floorlevel','True','getDate','id_transaction_id','<hr\x20class=\x22my-3\x22>','Receiving\x20Area','Enabled','$name','$product_details.expiry_date','..............connected.....................','Shelves','$product_details.secondary_code','getFullYear','express','delivery_date','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/barcode_scanner3','from_invoice','invoice','from_prod_level','$product_details.maxProducts','Products\x20updated\x20successfully.','Transfer\x20Finalize\x20Successfully','$product_details.type','to_warehouse','/../public','product_details','log','id_transaction','dotenv','aggregate','RMSEmail','push','from_prod_isle','New_Qty_Converted','Rack\x20F','from_bay','bay','/transfer/view','Types','to_types','$product','floor','<h2>\x20','5563674QgnDqr','from_rak','Hindi','<tr>','3907900ppzUnH','production_date','..............disconnected.....................','</td>','type','image','abortTransaction','render','\x20Order\x20Number\x20:\x20','redirect','$product_details.maxPerUnit','floorlevel','role','$product_details.production_date','$product_details','back','French','status','string','Chinese','Portuguese\x20(BR)','ObjectId','/picking_list/PDF_transfer_rm/','storage','date','padStart','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','from_prod_pallet','from_prod_qty','createTransport','to_room','</div>','../public/language/languages.json','..............to\x20deducted.....................','$from_warehouse','expiry_date','$product_details.unit','../models/all_models','save','staff','params','$product_details.storage','post','to_room_name','meet\x20the\x20need\x20stock','Rack\x20E','$product_details.secondary_unit','$product_details.pallet','$product_details.level','Raw\x20Materials','/view','$product_details.invoice','toFixed','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$room','here','find','success','\x20and\x20QTY\x20:\x20','to_prod_qty','Transfer\x20Mail','prod_cat','json','then','map','user','port','split','$product.from_room_name','/barcode_scanner2','master','secondary_unit','from_types','startSession','ToRoomAssigned','$product_details.isle','product_code','$product.to_room_name','Rack\x20A','slice','warehouse','from_rack','message','English','finalize','maxProducts','MaxStocks_data2','$product_details.batch_code','/transfer/preview/','Floor','<html><head><title></title>','135357iDbbSO','config','$product_details.bin','$date','filter','Spanish','3663JpVZjm','\x20</h2>','body','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','length','product_code3','\x20<>\x20','rak','/preview/:id','_id','errors','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','site_title','COLD\x20STORAGE','random','get','to_floorlevel','product_cat','Rack\x20C','forEach','add_transfer','updateOne','German','$product_details.primary_code','prod_name','from_room_name','sendMail','flash','2200XzsWjh','Rack\x20B','to_bay','TRF-','/barcode_scanner','to_prod_isle','maxperunit','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','mongoose','No\x20warehouse\x20data\x20found\x20for\x20room:\x20','password','primary_unit','from_room','product_name','134914hpsUKF','</h5>','to_prod_level','$to_warehouse','bin','secondary_code','host','from_bin','from_warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Enclosed','to_quantity','</tbody>','from_storage','product_stock','English\x20(US)','$product_details._id','max_per_unit','<!DOCTYPE\x20html>','email','76FhVksi','Arabic','findById','$_id','2004530rZVOyH'];a0_0x26d0=function(){return _0x3d7cc9;};return a0_0x26d0();}function a0_0x5817(_0x4cdcec,_0x3005da){var _0x26d087=a0_0x26d0();return a0_0x5817=function(_0x5817cd,_0x3010e9){_0x5817cd=_0x5817cd-0x165;var _0xf50d14=_0x26d087[_0x5817cd];return _0xf50d14;},a0_0x5817(_0x4cdcec,_0x3005da);}router[a0_0x515a4a(0x193)](a0_0x515a4a(0x253),auth,async(_0x3284a0,_0x4815d4)=>{var _0x5dad54=a0_0x515a4a;try{const {username:_0x505c8b,email:_0x518d2a,role:_0x3680bf}=_0x3284a0[_0x5dad54(0x262)],_0xd9c632=_0x3284a0[_0x5dad54(0x262)],_0x32a166=await profile[_0x5dad54(0x1d4)]({'email':_0xd9c632[_0x5dad54(0x1c1)]}),_0x53d00b=await master_shop[_0x5dad54(0x259)]();console[_0x5dad54(0x20c)](_0x5dad54(0x167),_0x53d00b);let _0x494564;if(_0xd9c632[_0x5dad54(0x22d)]==_0x5dad54(0x248)){const _0x29de1e=await staff['findOne']({'email':_0xd9c632[_0x5dad54(0x1c1)]});_0x494564=await transfers['find']({'from_warehouse':_0x29de1e[_0x5dad54(0x171)]});}else _0x494564=await transfers['aggregate']([{'$unwind':_0x5dad54(0x21a)},{'$group':{'_id':_0x5dad54(0x1c5),'invoice':{'$first':_0x5dad54(0x1e1)},'date':{'$first':_0x5dad54(0x17f)},'from_warehouse':{'$first':_0x5dad54(0x243)},'to_warehouse':{'$first':_0x5dad54(0x1b1)},'from_room_name':{'$addToSet':_0x5dad54(0x165)},'to_room_name':{'$addToSet':_0x5dad54(0x16e)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x53d00b[0x0][_0x5dad54(0x1e2)]=='English\x20(US)'){var _0x452b2d=users[_0x5dad54(0x174)];console[_0x5dad54(0x20c)](_0x452b2d);}else{if(_0x53d00b[0x0][_0x5dad54(0x1e2)]==_0x5dad54(0x21f))var _0x452b2d=users[_0x5dad54(0x21f)];else{if(_0x53d00b[0x0]['language']==_0x5dad54(0x19a))var _0x452b2d=users[_0x5dad54(0x19a)];else{if(_0x53d00b[0x0][_0x5dad54(0x1e2)]==_0x5dad54(0x181))var _0x452b2d=users[_0x5dad54(0x181)];else{if(_0x53d00b[0x0]['language']=='French')var _0x452b2d=users[_0x5dad54(0x231)];else{if(_0x53d00b[0x0][_0x5dad54(0x1e2)]==_0x5dad54(0x235))var _0x452b2d=users[_0x5dad54(0x1dd)];else{if(_0x53d00b[0x0][_0x5dad54(0x1e2)]==_0x5dad54(0x234))var _0x452b2d=users[_0x5dad54(0x234)];else{if(_0x53d00b[0x0][_0x5dad54(0x1e2)]==_0x5dad54(0x1c7))var _0x452b2d=users[_0x5dad54(0x1c3)];}}}}}}}_0x4815d4['render']('transfer',{'success':_0x3284a0[_0x5dad54(0x19f)](_0x5dad54(0x25a)),'errors':_0x3284a0[_0x5dad54(0x19f)](_0x5dad54(0x18e)),'role':_0xd9c632,'profile':_0x32a166,'master_shop':_0x53d00b,'transfer':_0x494564,'language':_0x452b2d});}catch(_0x13d63a){console['log'](_0x13d63a);}});async function getRandom8DigitNumber(){var _0x3ecd08=a0_0x515a4a;const _0x57bee4=0x989680,_0x17afde=0x5f5e0ff,_0x44ff48=Math[_0x3ecd08(0x21b)](Math[_0x3ecd08(0x192)]()*(_0x17afde-_0x57bee4+0x1))+_0x57bee4;var _0x516ed0;const _0x2217d6=await transfers[_0x3ecd08(0x1d4)]({'invoice':_0x3ecd08(0x1a3)+_0x44ff48});return _0x2217d6&&_0x2217d6['length']>0x0?_0x516ed0=_0x3ecd08(0x1a3)+_0x44ff48:_0x516ed0='TRF-'+_0x44ff48,_0x516ed0;}router[a0_0x515a4a(0x193)](a0_0x515a4a(0x1cf),auth,async(_0x17d42a,_0x487a57)=>{var _0x521b18=a0_0x515a4a;try{const {username:_0x1f54cf,email:_0x46dbc3,role:_0x3b181c}=_0x17d42a[_0x521b18(0x262)],_0x4963d8=_0x17d42a[_0x521b18(0x262)],_0x438c75=await profile[_0x521b18(0x1d4)]({'email':_0x4963d8['email']}),_0x2c9e5c=await master_shop['find']();console['log'](_0x521b18(0x167),_0x2c9e5c);let _0x1dd12c;if(_0x4963d8[_0x521b18(0x22d)]=='staff'){const _0x22c7a0=await staff[_0x521b18(0x1d4)]({'email':_0x4963d8[_0x521b18(0x1c1)]});_0x1dd12c=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x22c7a0[_0x521b18(0x171)],'warehouse_category':_0x521b18(0x252)}},{'$group':{'_id':_0x521b18(0x1f6),'name':{'$first':_0x521b18(0x1f6)}}}]);}else _0x1dd12c=await warehouse[_0x521b18(0x20f)]([{'$match':{'status':_0x521b18(0x1f5),'warehouse_category':_0x521b18(0x252)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);var _0x38c9bb=['Ambient',_0x521b18(0x1b8),_0x521b18(0x1ed)];const _0xa4c501=await transfers[_0x521b18(0x259)]({}),_0x4fe9eb=_0xa4c501[_0x521b18(0x188)]+0x1,_0x4582e6=_0x521b18(0x1a3)+_0x4fe9eb['toString']()[_0x521b18(0x23a)](0x5,'0');if(_0x2c9e5c[0x0]['language']==_0x521b18(0x1bd)){var _0x125adb=users['English'];console[_0x521b18(0x20c)](_0x125adb);}else{if(_0x2c9e5c[0x0][_0x521b18(0x1e2)]==_0x521b18(0x21f))var _0x125adb=users['Hindi'];else{if(_0x2c9e5c[0x0][_0x521b18(0x1e2)]==_0x521b18(0x19a))var _0x125adb=users[_0x521b18(0x19a)];else{if(_0x2c9e5c[0x0]['language']==_0x521b18(0x181))var _0x125adb=users['Spanish'];else{if(_0x2c9e5c[0x0][_0x521b18(0x1e2)]==_0x521b18(0x231))var _0x125adb=users[_0x521b18(0x231)];else{if(_0x2c9e5c[0x0][_0x521b18(0x1e2)]=='Portuguese\x20(BR)')var _0x125adb=users[_0x521b18(0x1dd)];else{if(_0x2c9e5c[0x0][_0x521b18(0x1e2)]==_0x521b18(0x234))var _0x125adb=users[_0x521b18(0x234)];else{if(_0x2c9e5c[0x0][_0x521b18(0x1e2)]=='Arabic\x20(ae)')var _0x125adb=users[_0x521b18(0x1c3)];}}}}}}}const _0x100840=getRandom8DigitNumber();_0x100840[_0x521b18(0x260)](_0x569c6a=>{var _0x5057ba=_0x521b18;_0x487a57[_0x5057ba(0x228)](_0x5057ba(0x198),{'success':_0x17d42a['flash']('success'),'errors':_0x17d42a[_0x5057ba(0x19f)](_0x5057ba(0x18e)),'role':_0x4963d8,'profile':_0x438c75,'master_shop':_0x2c9e5c,'warehouse':_0x1dd12c,'language':_0x125adb,'rooms_data':_0x38c9bb,'invoice':_0x569c6a});})[_0x521b18(0x1e9)](_0x2c130e=>{var _0x3d8ff8=_0x521b18;_0x17d42a['flash'](_0x3d8ff8(0x18e),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x487a57[_0x3d8ff8(0x22a)](_0x3d8ff8(0x217));});}catch(_0x3d8c4c){console[_0x521b18(0x20c)](_0x3d8c4c);}}),router[a0_0x515a4a(0x24b)](a0_0x515a4a(0x1cf),auth,async(_0x9f94b9,_0x56d2a3)=>{var _0xe01d6c=a0_0x515a4a;try{console[_0xe01d6c(0x20c)](_0x9f94b9[_0xe01d6c(0x184)]);const {date:_0x362556,from_warehouse:_0x114c40,FromRoom_name:_0x3ed1d6,to_warehouse:_0x5ad515,ToRoom_name:_0x305045,prod_name:_0x1cf9e4,from_prod_qty:_0x2ba5d4,from_prod_level:_0x5f2572,from_prod_isle:_0x2bf30d,from_prod_pallet:_0x352a4c,to_prod_qty:_0x49426a,to_prod_level:_0x1344c3,to_prod_isle:_0x2d3737,to_prod_pallet:_0x5a8fb1,primary_code:_0x100217,secondary_code:_0x1627e7,product_code3:_0x2415a2,note:_0x59d764,MaxStocks_data2:_0x5044d7,invoice:_0x1a9b6e,expiry_date:_0x3fd570}=_0x9f94b9[_0xe01d6c(0x184)];if(typeof _0x1cf9e4==_0xe01d6c(0x233))var _0x18ff44=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x19c)]],_0xa3de9d=[_0x9f94b9[_0xe01d6c(0x184)]['from_prod_qty']],_0x480a4a=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x204)]],_0x18ec48=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x213)]],_0x2f4c32=[_0x9f94b9[_0xe01d6c(0x184)]['to_prod_level']],_0x2c6e27=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x1df)]],_0x476ba7=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x1b3)]],_0x17f52e=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x189)]],_0xfb10c7=[_0x9f94b9['body'][_0xe01d6c(0x177)]],_0x4f59b4=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x1ab)]],_0x1efd0d=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x168)]],_0x241f6d=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x186)]],_0x32221b=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x244)]],_0x2b348e=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x1bf)]],_0x3b10f7=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x222)]],_0x1554b6=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x25e)]],_0x276de2=[_0x9f94b9['body'][_0xe01d6c(0x1d3)]],_0x45328c=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x16b)]],_0x228e5d=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x202)]],_0x48bef2=[_0x9f94b9['body'][_0xe01d6c(0x1ea)]],_0xb36b8=[_0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x20d)]];else var _0x18ff44=[..._0x9f94b9[_0xe01d6c(0x184)]['prod_name']],_0xa3de9d=[..._0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x23d)]],_0x480a4a=[..._0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x204)]],_0x18ec48=[..._0x9f94b9['body']['New_Qty_Converted']],_0x2f4c32=[..._0x9f94b9['body']['to_prod_level']],_0x2c6e27=[..._0x9f94b9['body'][_0xe01d6c(0x1df)]],_0x476ba7=[..._0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x1b3)]],_0x17f52e=[..._0x9f94b9['body']['product_code3']],_0xfb10c7=[..._0x9f94b9['body'][_0xe01d6c(0x177)]],_0x4f59b4=[..._0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x1ab)]],_0x1efd0d=[..._0x9f94b9[_0xe01d6c(0x184)]['secondary_unit']],_0x241f6d=[..._0x9f94b9[_0xe01d6c(0x184)]['batch_code']],_0x32221b=[..._0x9f94b9[_0xe01d6c(0x184)]['expiry_date']],_0x2b348e=[..._0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x1bf)]],_0x3b10f7=[..._0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x222)]],_0x1554b6=[..._0x9f94b9[_0xe01d6c(0x184)][_0xe01d6c(0x25e)]],_0x276de2=[..._0x9f94b9[_0xe01d6c(0x184)]['RoomAssigned']],_0x45328c=[..._0x9f94b9['body']['ToRoomAssigned']],_0x228e5d=[..._0x9f94b9[_0xe01d6c(0x184)]['from_invoice']],_0x48bef2=[..._0x9f94b9['body'][_0xe01d6c(0x1ea)]],_0xb36b8=[..._0x9f94b9[_0xe01d6c(0x184)]['id_transaction']];const _0x10e558=_0x18ff44[_0xe01d6c(0x261)](_0x580f62=>{return _0x580f62={'product_name':_0x580f62};});_0xa3de9d[_0xe01d6c(0x197)]((_0x499af2,_0x348745)=>{var _0x20d574=_0xe01d6c;_0x10e558[_0x348745][_0x20d574(0x1c9)]=_0x499af2;}),_0x228e5d[_0xe01d6c(0x197)]((_0x2b2bbb,_0x4206bc)=>{var _0x1a7849=_0xe01d6c;_0x10e558[_0x4206bc][_0x1a7849(0x202)]=_0x2b2bbb;}),_0x48bef2[_0xe01d6c(0x197)]((_0x1e340e,_0x96b05f)=>{var _0x5726c7=_0xe01d6c;_0x10e558[_0x96b05f][_0x5726c7(0x1e8)]=_0x1e340e;}),_0xb36b8[_0xe01d6c(0x197)]((_0x232dce,_0x36bb1)=>{var _0x1dd56b=_0xe01d6c;_0x10e558[_0x36bb1][_0x1dd56b(0x1f2)]=_0x232dce;}),_0x480a4a[_0xe01d6c(0x197)]((_0x575e38,_0x35f426)=>{var _0x3d210e=_0xe01d6c;_0x276de2[_0x3d210e(0x197)]((_0x1dcd35,_0x5b4c45)=>{var _0x287601=_0x3d210e;if(_0x1dcd35==_0x287601(0x1f4)&&_0x35f426==_0x5b4c45){var _0x56b284=_0x575e38[_0x287601(0x170)](0x3);_0x10e558[_0x35f426][_0x287601(0x1bb)]=_0x575e38[0x0],_0x10e558[_0x35f426][_0x287601(0x172)]=_0x575e38[0x1],_0x10e558[_0x35f426][_0x287601(0x215)]=0x0,_0x10e558[_0x35f426][_0x287601(0x1b5)]=0x0,_0x10e558[_0x35f426][_0x287601(0x169)]=_0x287601(0x17a),_0x10e558[_0x35f426][_0x287601(0x1d1)]=_0x56b284;}else{if(_0x1dcd35=='Shelves'&&_0x35f426==_0x5b4c45){var _0x56b284=_0x575e38[_0x287601(0x170)](0x3);_0x10e558[_0x35f426]['from_storage']=_0x575e38[0x0],_0x10e558[_0x35f426][_0x287601(0x172)]=_0x575e38[0x1],_0x10e558[_0x35f426][_0x287601(0x215)]=0x0,_0x10e558[_0x35f426][_0x287601(0x1b5)]=0x0,_0x10e558[_0x35f426][_0x287601(0x169)]=_0x287601(0x17a),_0x10e558[_0x35f426]['from_floorlevel']=_0x575e38[0x5];}else{if(_0x35f426==_0x5b4c45){if(_0x575e38[0x0]=='A'&&_0x575e38[0x1]=='L'&&_0x575e38[0x2]=='L')console[_0x287601(0x20c)](_0x1dcd35+_0x287601(0x18a)+_0x35f426+_0x287601(0x18a)+_0x5b4c45+_0x287601(0x18a)+_0x575e38+_0x287601(0x258)),_0x10e558[_0x35f426][_0x287601(0x1bb)]=_0x575e38[0x0],_0x10e558[_0x35f426][_0x287601(0x172)]=_0x575e38[0x1],_0x10e558[_0x35f426]['from_bay']=0x0,_0x10e558[_0x35f426][_0x287601(0x1b5)]=0x0,_0x10e558[_0x35f426][_0x287601(0x169)]=_0x287601(0x17a),_0x10e558[_0x35f426][_0x287601(0x1d1)]=_0x575e38[0x3];else{var _0x4e9a88;if(_0x575e38[0x4]=='L')_0x4e9a88='Level';else _0x575e38[0x4]=='F'&&(_0x4e9a88='Floor');_0x10e558[_0x35f426]['from_storage']=_0x575e38[0x0],_0x10e558[_0x35f426][_0x287601(0x172)]=_0x575e38[0x1],_0x10e558[_0x35f426][_0x287601(0x215)]=_0x575e38[0x2],_0x10e558[_0x35f426][_0x287601(0x1b5)]=_0x575e38[0x3],_0x10e558[_0x35f426]['from_types']=_0x4e9a88,_0x10e558[_0x35f426][_0x287601(0x1d1)]=_0x575e38[0x5];}}}}});}),_0x18ec48[_0xe01d6c(0x197)]((_0x2c9801,_0x48d6d0)=>{var _0x1eed95=_0xe01d6c;_0x10e558[_0x48d6d0][_0x1eed95(0x1b9)]=_0x2c9801;}),_0x2f4c32[_0xe01d6c(0x197)]((_0x254e78,_0x1addbe)=>{var _0x1c8c45=_0xe01d6c;_0x45328c[_0x1c8c45(0x197)]((_0x4dc94f,_0x3a16e0)=>{var _0x1860ce=_0x1c8c45;if(_0x4dc94f==_0x1860ce(0x1f4)&&_0x1addbe==_0x3a16e0){var _0x204321=_0x254e78['slice'](0x3);_0x10e558[_0x1addbe][_0x1860ce(0x238)]=_0x254e78[0x0],_0x10e558[_0x1addbe][_0x1860ce(0x1e5)]=_0x254e78[0x1],_0x10e558[_0x1addbe][_0x1860ce(0x1a2)]=0x0,_0x10e558[_0x1addbe][_0x1860ce(0x1d0)]=0x0,_0x10e558[_0x1addbe][_0x1860ce(0x219)]=_0x1860ce(0x17a),_0x10e558[_0x1addbe][_0x1860ce(0x194)]=_0x204321;}else{if(_0x4dc94f==_0x1860ce(0x1f9)&&_0x1addbe==_0x3a16e0){var _0x204321=_0x254e78[_0x1860ce(0x170)](0x3);_0x10e558[_0x1addbe][_0x1860ce(0x238)]=_0x254e78[0x0],_0x10e558[_0x1addbe][_0x1860ce(0x1e5)]=_0x254e78[0x1],_0x10e558[_0x1addbe][_0x1860ce(0x1a2)]=0x0,_0x10e558[_0x1addbe]['to_bin']=0x0,_0x10e558[_0x1addbe][_0x1860ce(0x219)]='Floor',_0x10e558[_0x1addbe][_0x1860ce(0x194)]=_0x254e78[0x5];}else{if(_0x1addbe==_0x3a16e0){if(_0x254e78[0x0]=='A'&&_0x254e78[0x1]=='L'&&_0x254e78[0x2]=='L')console['log'](_0x4dc94f+'\x20<>\x20'+_0x1addbe+_0x1860ce(0x18a)+_0x3a16e0+_0x1860ce(0x18a)+_0x254e78+_0x1860ce(0x258)),_0x10e558[_0x1addbe]['storage']=_0x254e78[0x0],_0x10e558[_0x1addbe][_0x1860ce(0x1e5)]=_0x254e78[0x1],_0x10e558[_0x1addbe][_0x1860ce(0x1a2)]=0x0,_0x10e558[_0x1addbe][_0x1860ce(0x1d0)]=0x0,_0x10e558[_0x1addbe][_0x1860ce(0x219)]='Floor',_0x10e558[_0x1addbe][_0x1860ce(0x194)]=_0x254e78[0x3];else{var _0x388ba3;if(_0x254e78[0x4]=='L')_0x388ba3='Level';else _0x254e78[0x4]=='F'&&(_0x388ba3=_0x1860ce(0x17a));_0x10e558[_0x1addbe][_0x1860ce(0x238)]=_0x254e78[0x0],_0x10e558[_0x1addbe][_0x1860ce(0x1e5)]=_0x254e78[0x1],_0x10e558[_0x1addbe][_0x1860ce(0x1a2)]=_0x254e78[0x2],_0x10e558[_0x1addbe][_0x1860ce(0x1d0)]=_0x254e78[0x3],_0x10e558[_0x1addbe][_0x1860ce(0x219)]=_0x388ba3,_0x10e558[_0x1addbe]['to_floorlevel']=_0x254e78[0x5];}}}}});}),_0x2c6e27['forEach']((_0xc9a8a6,_0x1cff08)=>{_0x10e558[_0x1cff08]['primary_code']=_0xc9a8a6;}),_0x476ba7[_0xe01d6c(0x197)]((_0x515be7,_0x3c4226)=>{var _0x48c053=_0xe01d6c;_0x10e558[_0x3c4226][_0x48c053(0x1b3)]=_0x515be7;}),_0x17f52e[_0xe01d6c(0x197)]((_0x546604,_0x4dbd7b)=>{var _0x198d65=_0xe01d6c;_0x10e558[_0x4dbd7b][_0x198d65(0x16d)]=_0x546604;}),_0xfb10c7[_0xe01d6c(0x197)]((_0x52f60c,_0x46b8d5)=>{var _0x46bbb9=_0xe01d6c;_0x10e558[_0x46b8d5][_0x46bbb9(0x176)]=_0x52f60c;}),_0x4f59b4[_0xe01d6c(0x197)]((_0x30d315,_0x501c47)=>{var _0x352f3d=_0xe01d6c;_0x10e558[_0x501c47][_0x352f3d(0x1e7)]=_0x30d315;}),_0x1efd0d[_0xe01d6c(0x197)]((_0x90052e,_0x208f4b)=>{var _0x588ca7=_0xe01d6c;_0x10e558[_0x208f4b][_0x588ca7(0x168)]=_0x90052e;}),_0x241f6d[_0xe01d6c(0x197)]((_0x5df782,_0x451907)=>{var _0x1a790b=_0xe01d6c;_0x10e558[_0x451907][_0x1a790b(0x186)]=_0x5df782;}),_0x32221b[_0xe01d6c(0x197)]((_0x7b104,_0x4f7eaa)=>{var _0x4ca855=_0xe01d6c;_0x10e558[_0x4f7eaa][_0x4ca855(0x244)]=_0x7b104;}),_0x2b348e['forEach']((_0x2c5d2f,_0x260484)=>{var _0x13f63d=_0xe01d6c;_0x10e558[_0x260484][_0x13f63d(0x1a6)]=_0x2c5d2f;}),_0x3b10f7['forEach']((_0x3c17b8,_0x53ffce)=>{var _0x346927=_0xe01d6c;_0x10e558[_0x53ffce][_0x346927(0x222)]=_0x3c17b8;}),_0x1554b6[_0xe01d6c(0x197)]((_0x54af95,_0x5412fc)=>{var _0x863a4=_0xe01d6c;_0x10e558[_0x5412fc][_0x863a4(0x25e)]=_0x54af95;}),_0x276de2[_0xe01d6c(0x197)]((_0x275203,_0x16281b)=>{_0x10e558[_0x16281b]['from_room_name']=_0x275203;}),_0x45328c['forEach']((_0xdc30dc,_0x2ea150)=>{_0x10e558[_0x2ea150]['to_room_name']=_0xdc30dc;});const _0x9a5086=_0x10e558[_0xe01d6c(0x180)](_0x82ecc5=>_0x82ecc5[_0xe01d6c(0x1b9)]!=='0'&&_0x82ecc5[_0xe01d6c(0x1b9)]!==''||_0x82ecc5[_0xe01d6c(0x194)]!=='0'&&_0x82ecc5[_0xe01d6c(0x194)]!==''),_0x2c7c59=new transfers({'date':_0x362556,'from_warehouse':_0x114c40,'to_warehouse':_0x5ad515,'product':_0x9a5086,'note':_0x59d764,'invoice':_0x1a9b6e}),_0x1db945=await _0x2c7c59[_0xe01d6c(0x247)]();_0x9f94b9[_0xe01d6c(0x19f)](_0xe01d6c(0x25a),_0xe01d6c(0x1d5)),_0x56d2a3[_0xe01d6c(0x22a)](_0xe01d6c(0x179)+_0x1db945[_0xe01d6c(0x18d)]);}catch(_0x1db616){console[_0xe01d6c(0x20c)](_0x1db616),_0x56d2a3[_0xe01d6c(0x232)](0xc8)[_0xe01d6c(0x25f)]({'errorMessage':_0x1db616['message']});}}),router[a0_0x515a4a(0x193)](a0_0x515a4a(0x18c),auth,async(_0x10dd22,_0x1bda38)=>{var _0x38018e=a0_0x515a4a;try{const {username:_0x339045,email:_0x17bd96,role:_0x51d0b3}=_0x10dd22['user'],_0x3b1ae6=_0x10dd22['user'],_0x2cdc2d=await profile[_0x38018e(0x1d4)]({'email':_0x3b1ae6['email']}),_0x27e89a=await master_shop[_0x38018e(0x259)]();console['log'](_0x38018e(0x167),_0x27e89a);const _0xd30e34=await transfers[_0x38018e(0x1c4)](_0x10dd22[_0x38018e(0x249)]['id']);let _0xe3d784=new Date(_0xd30e34[_0x38018e(0x244)]),_0x2014ac=('0'+_0xe3d784[_0x38018e(0x1f1)]())[_0x38018e(0x170)](-0x2),_0x1a89fc=('0'+(_0xe3d784['getMonth']()+0x1))[_0x38018e(0x170)](-0x2),_0x56c5e6=_0xe3d784[_0x38018e(0x1fb)](),_0x2e8c2e=_0x56c5e6+'-'+_0x1a89fc+'-'+_0x2014ac,_0x49fae9;if(_0x3b1ae6['role']==_0x38018e(0x248)){const _0x2117f0=await staff['findOne']({'email':_0x3b1ae6[_0x38018e(0x1c1)]});_0x49fae9=await warehouse[_0x38018e(0x259)]({'status':'Enabled','name':_0x2117f0[_0x38018e(0x171)],'warehouse_category':_0x38018e(0x252)});}else _0x49fae9=await warehouse[_0x38018e(0x259)]({'status':'Enabled','warehouse_category':_0x38018e(0x252)});const _0x45ebb0=await warehouse['aggregate']([{'$match':{'name':_0xd30e34[_0x38018e(0x1b6)]}},{'$unwind':_0x38018e(0x22f)},{'$group':{'_id':_0x38018e(0x1be),'name':{'$first':_0x38018e(0x1cd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x38018e(0x1dc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x38018e(0x208)},'floorlevel':{'$first':_0x38018e(0x1ef)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x38018e(0x1fa)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x38018e(0x24a)},'rack':{'$first':_0x38018e(0x1ce)},'expiry_date':{'$first':_0x38018e(0x1f7)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]);if(_0x27e89a[0x0][_0x38018e(0x1e2)]==_0x38018e(0x1bd)){var _0x3dad88=users[_0x38018e(0x174)];console[_0x38018e(0x20c)](_0x3dad88);}else{if(_0x27e89a[0x0][_0x38018e(0x1e2)]==_0x38018e(0x21f))var _0x3dad88=users[_0x38018e(0x21f)];else{if(_0x27e89a[0x0][_0x38018e(0x1e2)]=='German')var _0x3dad88=users[_0x38018e(0x19a)];else{if(_0x27e89a[0x0][_0x38018e(0x1e2)]=='Spanish')var _0x3dad88=users['Spanish'];else{if(_0x27e89a[0x0][_0x38018e(0x1e2)]==_0x38018e(0x231))var _0x3dad88=users[_0x38018e(0x231)];else{if(_0x27e89a[0x0]['language']=='Portuguese\x20(BR)')var _0x3dad88=users['Portuguese'];else{if(_0x27e89a[0x0][_0x38018e(0x1e2)]==_0x38018e(0x234))var _0x3dad88=users[_0x38018e(0x234)];else{if(_0x27e89a[0x0]['language']==_0x38018e(0x1c7))var _0x3dad88=users['Arabic'];}}}}}}}_0x1bda38[_0x38018e(0x228)]('edit_transfer_view',{'success':_0x10dd22['flash'](_0x38018e(0x25a)),'errors':_0x10dd22[_0x38018e(0x19f)](_0x38018e(0x18e)),'role':_0x3b1ae6,'profile':_0x2cdc2d,'master_shop':_0x27e89a,'warehouse':_0x49fae9,'transfer':_0xd30e34,'stock':_0x45ebb0,'language':_0x3dad88});}catch(_0x3dcd1d){console[_0x38018e(0x20c)](_0x3dcd1d);}});async function updateProduct_detl(_0x2dc5fe){var _0x2a1800=a0_0x515a4a;const _0x38902a=await mongoose[_0x2a1800(0x16a)]();try{console[_0x2a1800(0x20c)](_0x2a1800(0x1f8));const _0x576d3c=mongoose[_0x2a1800(0x218)][_0x2a1800(0x236)];return await _0x38902a[_0x2a1800(0x1c8)](async()=>{var _0x356500=_0x2a1800;for(const _0x31b3a8 of _0x2dc5fe[_0x356500(0x1d7)]){console[_0x356500(0x20c)](new _0x576d3c());const _0x8e00c5=await warehouse['aggregate']([{'$match':{'name':_0x2dc5fe[_0x356500(0x1b6)],'room':_0x31b3a8[_0x356500(0x19d)]}},{'$unwind':_0x356500(0x22f)},{'$match':{'product_details._id':_0x576d3c(_0x31b3a8[_0x356500(0x1f2)])}}])['session'](_0x38902a);if(_0x8e00c5[_0x356500(0x188)]===0x0)throw new Error(_0x356500(0x1a9)+_0x31b3a8[_0x356500(0x19d)]);for(const _0x4591b4 of _0x8e00c5){console[_0x356500(0x20c)](parseFloat(_0x4591b4['product_details'][_0x356500(0x1bc)][_0x356500(0x255)](0x2))>=parseFloat(_0x31b3a8[_0x356500(0x1b9)]['toFixed'](0x2)));if(parseFloat(_0x4591b4[_0x356500(0x20b)][_0x356500(0x1bc)][_0x356500(0x255)](0x2))>=parseFloat(_0x31b3a8[_0x356500(0x1b9)]['toFixed'](0x2))){let _0x1ce2d7=(parseFloat(_0x4591b4['product_details'][_0x356500(0x1bc)][_0x356500(0x255)](0x2))-parseFloat(_0x31b3a8['to_quantity']))[_0x356500(0x255)](0x2);console[_0x356500(0x20c)](_0x356500(0x24d),_0x1ce2d7),console['log']('..............from\x20deducted.....................'),await warehouse[_0x356500(0x199)]({'_id':_0x576d3c(_0x4591b4[_0x356500(0x18d)]),'product_details._id':_0x576d3c(_0x4591b4['product_details'][_0x356500(0x18d)])},{'$set':{'product_details.$.product_stock':_0x1ce2d7,'product_details.$.trf_invoice':_0x2dc5fe[_0x356500(0x203)]}},{'session':_0x38902a});const _0x263174=await warehouse['aggregate']([{'$match':{'name':_0x2dc5fe[_0x356500(0x209)],'room':_0x31b3a8['to_room_name']}}])[_0x356500(0x1ee)](_0x38902a);console['log'](_0x356500(0x242)),await warehouse[_0x356500(0x199)]({'name':_0x2dc5fe[_0x356500(0x209)],'room':_0x31b3a8[_0x356500(0x24c)]},{'$push':{'product_details':{'product_name':_0x31b3a8['product_name'],'product_stock':_0x31b3a8[_0x356500(0x1b9)],'primary_code':_0x31b3a8['primary_code'],'secondary_code':_0x31b3a8['secondary_code'],'product_code':_0x31b3a8[_0x356500(0x16d)],'storage':_0x31b3a8[_0x356500(0x238)],'rack':_0x31b3a8['rack'],'bay':_0x31b3a8[_0x356500(0x1a2)],'bin':_0x31b3a8[_0x356500(0x1d0)],'type':_0x31b3a8[_0x356500(0x219)],'floorlevel':_0x31b3a8['to_floorlevel'],'maxProducts':_0x31b3a8['maxProducts'],'expiry_date':_0x31b3a8['expiry_date'],'production_date':_0x31b3a8[_0x356500(0x222)],'maxPerUnit':_0x31b3a8[_0x356500(0x1a6)],'batch_code':_0x31b3a8[_0x356500(0x186)],'unit':_0x31b3a8[_0x356500(0x1e7)],'secondary_unit':_0x31b3a8['secondary_unit'],'alertQTY':_0x4591b4['product_details']['alertQTY'],'delivery_date':_0x4591b4[_0x356500(0x20b)][_0x356500(0x1fd)],'delivery_code':_0x4591b4['product_details']['delivery_code'],'product_cat':_0x4591b4[_0x356500(0x20b)][_0x356500(0x195)],'invoice':_0x31b3a8['from_invoice'],'trf_invoice':_0x2dc5fe['invoice'],'date_data':_0x2dc5fe[_0x356500(0x239)],'_id':new _0x576d3c()}}},{'session':_0x38902a});}else{console[_0x356500(0x20c)]('not\x20meet\x20the\x20need\x20stock',QTYTotal);throw new Error(_0x356500(0x1de)+_0x4591b4['_id']+_0x356500(0x25b)+QTYTotal);}}}}),{'success':!![],'message':_0x2a1800(0x206)};}catch(_0x188c47){return console[_0x2a1800(0x20c)](_0x188c47),await _0x38902a[_0x2a1800(0x227)](),console[_0x2a1800(0x20c)]('Transaction\x20aborted.'),{'success':![],'message':_0x188c47['message']};}finally{_0x38902a['endSession'](),console['log'](_0x2a1800(0x223));}}router[a0_0x515a4a(0x24b)]('/preview/:id',auth,async(_0xc389b1,_0x524865)=>{var _0x5254f9=a0_0x515a4a;try{const _0x12a591=_0xc389b1[_0x5254f9(0x249)]['id'],{from_warehouse:_0x548299,FromRoom_name:_0x59e714,to_warehouse:_0x2a77bf,ToRoom_name:_0x4128de}=_0xc389b1['body'],_0x431b0a=await transfers['findById']({'_id':_0x12a591});await updateProduct_detl(_0x431b0a),_0x431b0a[_0x5254f9(0x175)]=_0x5254f9(0x1f0);const _0x544f8d=await _0x431b0a[_0x5254f9(0x247)](),_0x46295c=await master_shop[_0x5254f9(0x259)](),_0x10bbba=await email_settings[_0x5254f9(0x1d4)](),_0xda0707=await supervisor_settings[_0x5254f9(0x259)]();var _0x3291c5=_0x431b0a[_0x5254f9(0x1d7)],_0x220ec5='',_0x44217d;for(_0x44217d in _0x3291c5){_0x220ec5+=_0x5254f9(0x220)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3291c5[_0x44217d][_0x5254f9(0x1ad)]+_0x5254f9(0x224)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3291c5[_0x44217d]['product_code']+_0x5254f9(0x224)+_0x5254f9(0x1cb)+_0x3291c5[_0x44217d]['to_quantity']+_0x5254f9(0x224)+_0x5254f9(0x1cb)+_0x3291c5[_0x44217d][_0x5254f9(0x1e7)]+_0x5254f9(0x224)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3291c5[_0x44217d][_0x5254f9(0x168)]+'</td>'+_0x5254f9(0x1cb)+_0x431b0a[_0x5254f9(0x209)]+_0x5254f9(0x224)+_0x5254f9(0x1cb)+_0x3291c5[_0x44217d][_0x5254f9(0x24c)]+_0x5254f9(0x224)+_0x5254f9(0x1cb)+_0x3291c5[_0x44217d]['storage']+_0x3291c5[_0x44217d][_0x5254f9(0x1e5)]+_0x3291c5[_0x44217d]['to_bay']+_0x3291c5[_0x44217d]['to_bin']+_0x3291c5[_0x44217d][_0x5254f9(0x219)][0x0]+_0x3291c5[_0x44217d][_0x5254f9(0x194)]+_0x5254f9(0x224),_0x5254f9(0x1e3);}let _0x4737ef=nodemailer[_0x5254f9(0x23e)]({'host':_0x10bbba[_0x5254f9(0x1b4)],'port':Number(_0x10bbba[_0x5254f9(0x263)]),'secure':![],'auth':{'user':_0x10bbba['email'],'pass':_0x10bbba[_0x5254f9(0x1aa)]}}),_0x527f69={'from':_0x10bbba[_0x5254f9(0x1c1)],'to':_0xda0707[0x0][_0x5254f9(0x210)],'subject':_0x5254f9(0x25d),'attachments':[{'filename':'Logo.png','path':__dirname+_0x5254f9(0x20a)+'/upload/'+_0x46295c[0x0][_0x5254f9(0x226)],'cid':'logo'}],'html':_0x5254f9(0x1c0)+_0x5254f9(0x17b)+_0x5254f9(0x1fe)+_0x5254f9(0x1d8)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x5254f9(0x1d8)+_0x5254f9(0x23b)+_0x5254f9(0x240)+_0x5254f9(0x1d8)+_0x5254f9(0x21c)+_0x46295c[0x0][_0x5254f9(0x190)]+_0x5254f9(0x183)+'</div>'+_0x5254f9(0x240)+_0x5254f9(0x1f3)+_0x5254f9(0x1d8)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x5254f9(0x229)+_0x431b0a['invoice']+'\x20'+_0x5254f9(0x1e4)+'\x20Order\x20Date\x20:\x20'+_0x431b0a['date']+'\x20'+'</span>'+_0x5254f9(0x1af)+'</div>'+_0x5254f9(0x256)+_0x5254f9(0x18f)+_0x5254f9(0x220)+_0x5254f9(0x1b7)+_0x5254f9(0x1ff)+_0x5254f9(0x200)+_0x5254f9(0x185)+_0x5254f9(0x1d9)+_0x5254f9(0x187)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+'</thead>'+_0x5254f9(0x1db)+'\x20'+_0x220ec5+'\x20'+_0x5254f9(0x1ba)+'</table>'+_0x5254f9(0x1d8)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x46295c[0x0][_0x5254f9(0x190)]+_0x5254f9(0x1af)+_0x5254f9(0x240)+_0x5254f9(0x240)+'</body></html>'};_0x4737ef[_0x5254f9(0x19e)](_0x527f69,function(_0x45dd78,_0x27aca4){var _0x2182ff=_0x5254f9;_0x45dd78?(console[_0x2182ff(0x20c)](_0x45dd78),console[_0x2182ff(0x20c)]('Error\x20Occurs')):console[_0x2182ff(0x20c)]('Email\x20sent\x20successfully');}),_0xc389b1[_0x5254f9(0x19f)](_0x5254f9(0x25a),_0x5254f9(0x207)),_0x524865[_0x5254f9(0x22a)](_0x5254f9(0x237)+_0x544f8d[_0x5254f9(0x18d)]);}catch(_0x129414){console[_0x5254f9(0x20c)](_0x129414);}});function BayBinSelected(_0x182889,_0x22a49b){var _0x450b79=a0_0x515a4a,_0x17b9ea=[],_0x2a9512=[],_0x35de98=[],_0x4f8312=[],_0x17d90d=[],_0x3a05b9=[];let _0x24410e=[];if(_0x182889=='DRY\x20STORAGE')switch(_0x22a49b){case _0x450b79(0x16f):_0x17b9ea=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2a9512=[0x1,0x2],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x1d2),'Floor'],_0x17d90d=['D'],_0x3a05b9=['A'];break;case _0x450b79(0x1a1):_0x17b9ea=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2a9512=[0x1,0x2],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x1d2),_0x450b79(0x17a)],_0x17d90d=['D'],_0x3a05b9=['B'];break;case _0x450b79(0x1f9):_0x17b9ea=[0x0],_0x2a9512=[0x0],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x17a)],_0x17d90d=['D'],_0x3a05b9=['S'];break;case _0x450b79(0x1f4):_0x17b9ea=[0x0],_0x2a9512=[0x0],_0x4f8312=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x35de98=[_0x450b79(0x17a)],_0x17d90d=['D'],_0x3a05b9=['R'];break;}else{if(_0x182889==_0x450b79(0x191))switch(_0x22a49b){case _0x450b79(0x16f):_0x17b9ea=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2a9512=['B','F'],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x1d2),_0x450b79(0x17a)],_0x17d90d=['C'],_0x3a05b9=['A'];break;case'Rack\x20B':_0x17b9ea=[0x5,0x4,0x3,0x2,0x1],_0x2a9512=['F','B','S'],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x1d2),_0x450b79(0x17a)],_0x17d90d=['C'],_0x3a05b9=['B'];break;case _0x450b79(0x196):_0x17b9ea=[0x1,0x2,0x3,0x4,0x5],_0x2a9512=['B','F','S'],_0x4f8312=[0x5,0x4,0x3,0x2,0x1],_0x35de98=[_0x450b79(0x1d2),'Floor'],_0x17d90d=['C'],_0x3a05b9=['C'];break;case _0x450b79(0x1ec):_0x17b9ea=[0x5,0x4,0x3,0x2,0x1],_0x2a9512=['F','B','S'],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x1d2),_0x450b79(0x17a)],_0x17d90d=['C'],_0x3a05b9=['D'];break;case _0x450b79(0x24e):_0x17b9ea=[0x4,0x3,0x2,0x1],_0x2a9512=[0x1,0x2],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x1d2),_0x450b79(0x17a)],_0x17d90d=['C'],_0x3a05b9=['E'];break;case _0x450b79(0x214):_0x17b9ea=[0x1,0x2,0x3],_0x2a9512=[0x1,0x2],_0x4f8312=[0x1,0x2,0x3,0x4,0x5],_0x35de98=[_0x450b79(0x1d2)],_0x17d90d=['C'],_0x3a05b9=['F'];break;}}return{'levels':_0x17b9ea,'Isle':_0x2a9512,'rack':_0x4f8312,'type':_0x35de98,'storage':_0x17d90d,'rak':_0x3a05b9};}router[a0_0x515a4a(0x193)](a0_0x515a4a(0x1da),auth,async(_0x4323d8,_0x4a0682)=>{var _0x2e6d5e=a0_0x515a4a;try{const {username:_0x4e85af,email:_0x57f94c,role:_0x381a26}=_0x4323d8['user'],_0x12b396=_0x4323d8['user'],_0x5e453c=await profile['findOne']({'email':_0x12b396[_0x2e6d5e(0x1c1)]}),_0x45613b=await master_shop[_0x2e6d5e(0x259)](),_0x55670e=await transfers[_0x2e6d5e(0x1c4)](_0x4323d8['params']['id']);let _0x5b7fd3;if(_0x12b396[_0x2e6d5e(0x22d)]==_0x2e6d5e(0x248)){const _0x86dcd7=await staff[_0x2e6d5e(0x1d4)]({'email':_0x12b396['email']});_0x5b7fd3=await warehouse[_0x2e6d5e(0x20f)]([{'$match':{'status':'Enabled','name':_0x86dcd7[_0x2e6d5e(0x171)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x2e6d5e(0x1f6),'name':{'$first':_0x2e6d5e(0x1f6)}}}]);}else _0x5b7fd3=await warehouse['aggregate']([{'$match':{'status':_0x2e6d5e(0x1f5),'warehouse_category':_0x2e6d5e(0x252)}},{'$group':{'_id':'$name','name':{'$first':_0x2e6d5e(0x1f6)}}}]);const _0x3929b0=await warehouse[_0x2e6d5e(0x20f)]([{'$match':{'name':_0x55670e[_0x2e6d5e(0x1b6)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2e6d5e(0x1be),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2e6d5e(0x1dc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2e6d5e(0x208)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2e6d5e(0x1fa)},'product_code':{'$first':_0x2e6d5e(0x1ca)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2e6d5e(0x1ce)},'expiry_date':{'$first':_0x2e6d5e(0x1f7)},'production_date':{'$first':_0x2e6d5e(0x22e)},'room':{'$first':_0x2e6d5e(0x257)}}}]),_0x29dfa8=await product[_0x2e6d5e(0x259)]({}),_0x2fa247=BayBinSelected(_0x55670e[_0x2e6d5e(0x209)],_0x55670e[_0x2e6d5e(0x23f)]);if(_0x45613b[0x0][_0x2e6d5e(0x1e2)]=='English\x20(US)'){var _0x2545fa=users[_0x2e6d5e(0x174)];console[_0x2e6d5e(0x20c)](_0x2545fa);}else{if(_0x45613b[0x0][_0x2e6d5e(0x1e2)]==_0x2e6d5e(0x21f))var _0x2545fa=users['Hindi'];else{if(_0x45613b[0x0][_0x2e6d5e(0x1e2)]==_0x2e6d5e(0x19a))var _0x2545fa=users[_0x2e6d5e(0x19a)];else{if(_0x45613b[0x0]['language']==_0x2e6d5e(0x181))var _0x2545fa=users[_0x2e6d5e(0x181)];else{if(_0x45613b[0x0][_0x2e6d5e(0x1e2)]=='French')var _0x2545fa=users[_0x2e6d5e(0x231)];else{if(_0x45613b[0x0]['language']==_0x2e6d5e(0x235))var _0x2545fa=users[_0x2e6d5e(0x1dd)];else{if(_0x45613b[0x0][_0x2e6d5e(0x1e2)]==_0x2e6d5e(0x234))var _0x2545fa=users['Chinese'];else{if(_0x45613b[0x0]['language']==_0x2e6d5e(0x1c7))var _0x2545fa=users[_0x2e6d5e(0x1c3)];}}}}}}}_0x4a0682['render']('edit_transfer',{'success':_0x4323d8[_0x2e6d5e(0x19f)](_0x2e6d5e(0x25a)),'errors':_0x4323d8['flash'](_0x2e6d5e(0x18e)),'role':_0x12b396,'profile':_0x5e453c,'master_shop':_0x45613b,'warehouse':_0x5b7fd3,'transfer':_0x55670e,'stock':_0x3929b0,'unit':_0x29dfa8,'language':_0x2545fa});}catch(_0x5cba95){console['log'](_0x5cba95);}}),router[a0_0x515a4a(0x24b)](a0_0x515a4a(0x1da),auth,async(_0x3fd531,_0x168f6b)=>{var _0x450b3d=a0_0x515a4a;try{const _0x266dda=_0x3fd531[_0x450b3d(0x249)]['id'],_0x381e72=await transfers[_0x450b3d(0x1c4)](_0x266dda);_0x168f6b[_0x450b3d(0x25f)](_0x3fd531[_0x450b3d(0x184)]);return;const {date:_0x212c67,from_warehouse:_0x19a857,FromRoom_name:_0x546c10,to_warehouse:_0x2727bd,ToRoom_name:_0x140de7,prod_name:_0x3afa37,from_prod_qty:_0x5d6bba,from_prod_level:_0x2bf2a1,from_prod_isle:_0x17cf58,from_prod_pallet:_0x3f7861,to_prod_qty:_0x2361a8,to_prod_level:_0x18ec85,to_prod_isle:_0x1fcf9a,to_prod_pallet:_0xec6d50,primary_code:_0x263b12,secondary_code:_0x31dbfe,product_code3:_0x175479,note:_0x29778b,invoice:_0x3e561f,expiry_date:_0x3b06b0}=_0x3fd531[_0x450b3d(0x184)];if(typeof _0x3afa37==_0x450b3d(0x233))var _0x103a95=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x19c)]],_0x1c82f3=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x23d)]],_0x337748=[_0x3fd531[_0x450b3d(0x184)]['from_prod_level']],_0x4e397c=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x212)]],_0x60b6df=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x23c)]],_0x437d62=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x169)]],_0x16a3f1=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x25c)]],_0x3c86ae=[_0x3fd531[_0x450b3d(0x184)]['to_prod_level']],_0x2d8418=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1a5)]],_0x6f140e=[_0x3fd531['body'][_0x450b3d(0x1e0)]],_0x420b6a=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x219)]],_0x474eeb=[_0x3fd531[_0x450b3d(0x184)]['storage']],_0x209657=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x18b)]],_0x1ecadf=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1df)]],_0x2072dc=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1b3)]],_0x1071c3=[_0x3fd531['body'][_0x450b3d(0x189)]],_0x1474a8=[_0x3fd531['body']['MaxStocks_data2']],_0x408fe7=[_0x3fd531[_0x450b3d(0x184)]['unit']],_0x3304cb=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x168)]],_0xd38c2=[_0x3fd531['body'][_0x450b3d(0x186)]],_0x5f3428=[_0x3fd531['body'][_0x450b3d(0x244)]],_0x5905ac=[_0x3fd531['body'][_0x450b3d(0x1bb)]],_0xad2b40=[_0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x21e)]];else var _0x103a95=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x19c)]],_0x474eeb=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x238)]],_0x209657=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x18b)]],_0x437d62=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x169)]],_0x420b6a=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x219)]],_0x1c82f3=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x23d)]],_0x337748=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x204)]],_0x4e397c=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x212)]],_0x60b6df=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x23c)]],_0x16a3f1=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x25c)]],_0x3c86ae=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1b0)]],_0x2d8418=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1a5)]],_0x6f140e=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1e0)]],_0x1ecadf=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1df)]],_0x2072dc=[..._0x3fd531['body']['secondary_code']],_0x1071c3=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x189)]],_0x1474a8=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x177)]],_0x408fe7=[..._0x3fd531['body'][_0x450b3d(0x1e7)]],_0x3304cb=[..._0x3fd531['body'][_0x450b3d(0x168)]],_0xd38c2=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x186)]],_0x5f3428=[..._0x3fd531[_0x450b3d(0x184)]['expiry_date']],_0x5905ac=[..._0x3fd531[_0x450b3d(0x184)][_0x450b3d(0x1bb)]],_0xad2b40=[..._0x3fd531['body'][_0x450b3d(0x21e)]];const _0x1617b6=_0x103a95[_0x450b3d(0x261)](_0x19faeb=>{return _0x19faeb={'product_name':_0x19faeb};});_0x1c82f3[_0x450b3d(0x197)]((_0x1cd9e8,_0x2ed8f4)=>{_0x1617b6[_0x2ed8f4]['from_quantity']=_0x1cd9e8;}),_0x337748[_0x450b3d(0x197)]((_0x592090,_0x631c7d)=>{_0x1617b6[_0x631c7d]['from_bay']=_0x592090;}),_0x4e397c[_0x450b3d(0x197)]((_0x18cde8,_0x3faa1c)=>{var _0x32ce03=_0x450b3d;_0x1617b6[_0x3faa1c][_0x32ce03(0x1b5)]=_0x18cde8;}),_0x60b6df[_0x450b3d(0x197)]((_0x710a4,_0x614a4c)=>{var _0x307478=_0x450b3d;_0x1617b6[_0x614a4c][_0x307478(0x1d1)]=_0x710a4;}),_0x16a3f1['forEach']((_0x37cf79,_0xbf3611)=>{_0x1617b6[_0xbf3611]['to_quantity']=_0x37cf79;}),_0x3c86ae[_0x450b3d(0x197)]((_0xa395d1,_0x5c75c2)=>{_0x1617b6[_0x5c75c2]['to_bay']=_0xa395d1;}),_0x2d8418[_0x450b3d(0x197)]((_0x12a63a,_0xf276b1)=>{var _0x312811=_0x450b3d;_0x1617b6[_0xf276b1][_0x312811(0x1d0)]=_0x12a63a;}),_0x6f140e[_0x450b3d(0x197)]((_0xf165eb,_0x132d10)=>{var _0x191c84=_0x450b3d;_0x1617b6[_0x132d10][_0x191c84(0x194)]=_0xf165eb;}),_0x1ecadf[_0x450b3d(0x197)]((_0x143a8a,_0x9b205b)=>{var _0x50d496=_0x450b3d;_0x1617b6[_0x9b205b][_0x50d496(0x1df)]=_0x143a8a;}),_0x2072dc[_0x450b3d(0x197)]((_0x4e2cd9,_0x18c94c)=>{var _0x32161c=_0x450b3d;_0x1617b6[_0x18c94c][_0x32161c(0x1b3)]=_0x4e2cd9;}),_0x1071c3[_0x450b3d(0x197)]((_0x1f1ed6,_0x850dbd)=>{var _0x21666a=_0x450b3d;_0x1617b6[_0x850dbd][_0x21666a(0x16d)]=_0x1f1ed6;}),_0x1474a8['forEach']((_0x16481a,_0x4d094c)=>{var _0x48c742=_0x450b3d;_0x1617b6[_0x4d094c][_0x48c742(0x176)]=_0x16481a;}),_0x408fe7[_0x450b3d(0x197)]((_0x441be7,_0x4fe29d)=>{var _0x5d4496=_0x450b3d;_0x1617b6[_0x4fe29d][_0x5d4496(0x1e7)]=_0x441be7;}),_0x3304cb['forEach']((_0x3a9956,_0x2ad0b8)=>{var _0x380233=_0x450b3d;_0x1617b6[_0x2ad0b8][_0x380233(0x168)]=_0x3a9956;}),_0xd38c2['forEach']((_0x38a373,_0x480409)=>{var _0x566dd4=_0x450b3d;_0x1617b6[_0x480409][_0x566dd4(0x186)]=_0x38a373;}),_0x5f3428[_0x450b3d(0x197)]((_0x53842d,_0x422ff1)=>{_0x1617b6[_0x422ff1]['expiry_date']=_0x53842d;}),_0x474eeb[_0x450b3d(0x197)]((_0x3bd217,_0x522883)=>{var _0x24682e=_0x450b3d;_0x1617b6[_0x522883][_0x24682e(0x238)]=_0x3bd217;}),_0x209657[_0x450b3d(0x197)]((_0x565d93,_0xdf364c)=>{_0x1617b6[_0xdf364c]['rack']=_0x565d93;}),_0x437d62['forEach']((_0x37ce1e,_0x1273fc)=>{var _0x62e0a3=_0x450b3d;_0x1617b6[_0x1273fc][_0x62e0a3(0x169)]=_0x37ce1e;}),_0x420b6a[_0x450b3d(0x197)]((_0x395fa8,_0x32217c)=>{var _0x29565f=_0x450b3d;_0x1617b6[_0x32217c][_0x29565f(0x219)]=_0x395fa8;}),_0x5905ac[_0x450b3d(0x197)]((_0x1e1cf8,_0x11536a)=>{var _0xc04159=_0x450b3d;_0x1617b6[_0x11536a][_0xc04159(0x1bb)]=_0x1e1cf8;}),_0xad2b40[_0x450b3d(0x197)]((_0x596c7f,_0x288007)=>{var _0x16a223=_0x450b3d;_0x1617b6[_0x288007][_0x16a223(0x172)]=_0x596c7f;});const _0x1b239f=_0x1617b6[_0x450b3d(0x180)](_0x5ee0aa=>_0x5ee0aa['to_quantity']!=='0'&&_0x5ee0aa[_0x450b3d(0x1b9)]!==''||_0x5ee0aa['to_floorlevel']!=='0'&&_0x5ee0aa['to_floorlevel']!=='');var _0x4e0d98=0x0;_0x1b239f[_0x450b3d(0x197)](_0x21e809=>{var _0x1fffc0=_0x450b3d;parseInt(_0x21e809[_0x1fffc0(0x1c9)])<parseInt(_0x21e809[_0x1fffc0(0x1b9)])&&_0x4e0d98++;});if(_0x4e0d98!=0x0)return _0x3fd531['flash'](_0x450b3d(0x18e),_0x450b3d(0x1a7)),_0x168f6b['redirect'](_0x450b3d(0x230));const _0x3135d3=await warehouse[_0x450b3d(0x1d4)]({'name':_0x381e72['from_warehouse'],'room':_0x381e72[_0x450b3d(0x1ac)]});_0x381e72[_0x450b3d(0x1d7)]['forEach'](_0x201f54=>{var _0x5e43f7=_0x450b3d;if(_0x201f54['to_quantity']>0x0){const _0x188af8=_0x3135d3[_0x5e43f7(0x20b)][_0x5e43f7(0x261)](_0x257a90=>{var _0x428174=_0x5e43f7;_0x257a90[_0x428174(0x1ad)]==_0x201f54[_0x428174(0x1ad)]&&_0x257a90[_0x428174(0x22c)]==_0x201f54[_0x428174(0x1d1)]&&_0x257a90[_0x428174(0x225)]==_0x201f54[_0x428174(0x169)]&&_0x257a90['bin']==_0x201f54[_0x428174(0x1b5)]&&_0x257a90[_0x428174(0x216)]==_0x201f54[_0x428174(0x215)]&&_0x257a90['rack']==_0x201f54[_0x428174(0x172)]&&_0x257a90[_0x428174(0x238)]==_0x201f54[_0x428174(0x1bb)]&&(_0x257a90[_0x428174(0x1bc)]=parseInt(_0x257a90[_0x428174(0x1bc)])+parseInt(_0x201f54[_0x428174(0x1b9)]));});}}),await _0x3135d3[_0x450b3d(0x247)]();const _0x586443=await warehouse[_0x450b3d(0x1d4)]({'name':_0x381e72[_0x450b3d(0x209)],'room':_0x381e72[_0x450b3d(0x23f)]});_0x381e72[_0x450b3d(0x1d7)][_0x450b3d(0x197)](_0x279d56=>{var _0x18ae40=_0x450b3d;if(_0x279d56[_0x18ae40(0x1b9)]>0x0){const _0x53698b=_0x586443[_0x18ae40(0x20b)][_0x18ae40(0x261)](_0x184205=>{var _0x247347=_0x18ae40;_0x184205[_0x247347(0x1ad)]==_0x279d56['product_name']&&_0x184205[_0x247347(0x22c)]==_0x279d56[_0x247347(0x194)]&&_0x184205['type']==_0x279d56['to_types']&&_0x184205[_0x247347(0x1b2)]==_0x279d56['to_bin']&&_0x184205['bay']==_0x279d56[_0x247347(0x1a2)]&&_0x184205[_0x247347(0x1e5)]==_0x279d56['rack']&&_0x184205['storage']==_0x279d56[_0x247347(0x238)]&&(_0x184205[_0x247347(0x1bc)]=parseInt(_0x184205[_0x247347(0x1bc)])-parseInt(_0x279d56[_0x247347(0x1b9)]));});}}),await _0x586443[_0x450b3d(0x247)](),_0x381e72[_0x450b3d(0x239)]=_0x212c67,_0x381e72[_0x450b3d(0x1b6)]=_0x19a857,_0x381e72[_0x450b3d(0x209)]=_0x2727bd,_0x381e72[_0x450b3d(0x1d7)]=_0x1b239f,_0x381e72[_0x450b3d(0x1cc)]=_0x29778b,_0x381e72[_0x450b3d(0x203)]=_0x3e561f;const _0x265e04=await _0x381e72[_0x450b3d(0x247)]();console[_0x450b3d(0x20c)](_0x265e04);const _0x4abfd2=await warehouse[_0x450b3d(0x1d4)]({'name':_0x19a857,'room':_0x546c10});_0x265e04[_0x450b3d(0x1d7)][_0x450b3d(0x197)](_0x11e61a=>{var _0x18b943=_0x450b3d;if(_0x11e61a[_0x18b943(0x1b9)]>0x0){const _0x50dbaf=_0x4abfd2['product_details'][_0x18b943(0x261)](_0x450ba8=>{var _0x8255ba=_0x18b943;_0x450ba8[_0x8255ba(0x1ad)]==_0x11e61a[_0x8255ba(0x1ad)]&&_0x450ba8[_0x8255ba(0x22c)]==_0x11e61a[_0x8255ba(0x1d1)]&&_0x450ba8[_0x8255ba(0x225)]==_0x11e61a['from_types']&&_0x450ba8[_0x8255ba(0x1b2)]==_0x11e61a[_0x8255ba(0x1b5)]&&_0x450ba8[_0x8255ba(0x216)]==_0x11e61a[_0x8255ba(0x215)]&&_0x450ba8[_0x8255ba(0x1e5)]==_0x11e61a['from_rack']&&_0x450ba8[_0x8255ba(0x238)]==_0x11e61a[_0x8255ba(0x1bb)]&&(_0x450ba8[_0x8255ba(0x1bc)]=parseInt(_0x450ba8[_0x8255ba(0x1bc)])-parseInt(_0x11e61a[_0x8255ba(0x1b9)]));});}}),await _0x4abfd2[_0x450b3d(0x247)]();const _0x430767=await warehouse['findOne']({'name':_0x2727bd,'room':_0x140de7});_0x265e04[_0x450b3d(0x1d7)][_0x450b3d(0x197)](_0xb0c27e=>{var _0x12fbaf=_0x450b3d;if(_0xb0c27e[_0x12fbaf(0x1b9)]>0x0){var _0x12d41c=0x0;const _0x1f9b82=_0x430767[_0x12fbaf(0x20b)]['map'](_0x21e3e3=>{var _0x2428e6=_0x12fbaf;_0x21e3e3[_0x2428e6(0x1ad)]==_0xb0c27e[_0x2428e6(0x1ad)]&&_0x21e3e3[_0x2428e6(0x22c)]==_0xb0c27e['to_floorlevel']&&_0x21e3e3[_0x2428e6(0x225)]==_0xb0c27e[_0x2428e6(0x219)]&&_0x21e3e3[_0x2428e6(0x1b2)]==_0xb0c27e[_0x2428e6(0x1d0)]&&_0x21e3e3[_0x2428e6(0x216)]==_0xb0c27e['to_bay']&&_0x21e3e3[_0x2428e6(0x1e5)]==_0xb0c27e[_0x2428e6(0x1e5)]&&_0x21e3e3[_0x2428e6(0x238)]==_0xb0c27e['storage']&&(_0x21e3e3[_0x2428e6(0x1bc)]=parseInt(_0x21e3e3[_0x2428e6(0x1bc)])+parseInt(_0xb0c27e['to_quantity']),_0x12d41c++);});_0x12d41c=='0'&&(_0x430767['product_details']=_0x430767[_0x12fbaf(0x20b)]['concat']({'product_name':_0xb0c27e[_0x12fbaf(0x1ad)],'product_stock':_0xb0c27e[_0x12fbaf(0x1b9)],'bay':_0xb0c27e[_0x12fbaf(0x1a2)],'bin':_0xb0c27e['to_bin'],'type':_0xb0c27e['to_types'],'floorlevel':_0xb0c27e['to_floorlevel'],'storage':_0xb0c27e['storage'],'rack':_0xb0c27e[_0x12fbaf(0x1e5)],'product_code':_0xb0c27e['product_code'],'primary_code':_0xb0c27e['primary_code'],'secondary_code':_0xb0c27e[_0x12fbaf(0x1b3)],'maxProducts':_0xb0c27e[_0x12fbaf(0x176)],'storage':_0xb0c27e['storage'],'rack':_0xb0c27e[_0x12fbaf(0x1e5)]}));}}),await _0x430767[_0x450b3d(0x247)](),_0x3fd531[_0x450b3d(0x19f)](_0x450b3d(0x25a),'Transfer\x20Edit\x20Successfully'),_0x168f6b[_0x450b3d(0x22a)](_0x450b3d(0x217));}catch(_0x5b5523){console[_0x450b3d(0x20c)](_0x5b5523);}}),router[a0_0x515a4a(0x24b)](a0_0x515a4a(0x1a4),async(_0x221b36,_0x8b6f0e)=>{var _0x2a934a=a0_0x515a4a;const {FromWareHouse:_0x2f98ad,FromRoom:_0x360ba9,ToWarehouse:_0x1c01e0,ToRoom:_0x45613e,primary_code:_0x18afee,Roomslist:_0x529802}=_0x221b36[_0x2a934a(0x184)],_0x114ec5=_0x529802[_0x2a934a(0x264)](','),_0x49fbbf=[];async function _0x586bd0(_0x4bb127){var _0x2d0b90=_0x2a934a;const _0x167c37=await warehouse['aggregate']([{'$match':{'name':_0x2f98ad,'room':_0x4bb127}},{'$unwind':_0x2d0b90(0x22f)},{'$match':{'product_details.primary_code':_0x18afee}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x2d0b90(0x1d6)},'primary_code':{'$first':_0x2d0b90(0x19b)},'secondary_code':{'$first':_0x2d0b90(0x1fa)},'product_code':{'$first':_0x2d0b90(0x1ca)},'level':{'$first':_0x2d0b90(0x1dc)},'isle':{'$first':_0x2d0b90(0x17e)},'type':{'$first':_0x2d0b90(0x208)},'pallet':{'$first':_0x2d0b90(0x1ef)},'unit':{'$first':_0x2d0b90(0x245)},'secondary_unit':{'$first':_0x2d0b90(0x24f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2d0b90(0x1f7)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2d0b90(0x178)},'maxPerUnit':{'$first':_0x2d0b90(0x22b)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x2d0b90(0x254)}}}]),_0x4d3685=await warehouse[_0x2d0b90(0x20f)]([{'$match':{'name':_0x2f98ad,'room':_0x4bb127}},{'$unwind':_0x2d0b90(0x22f)},{'$match':{'product_details.secondary_code':_0x18afee}},{'$group':{'_id':_0x2d0b90(0x1be),'name':{'$first':_0x2d0b90(0x1cd)},'instock':{'$first':_0x2d0b90(0x1d6)},'primary_code':{'$first':_0x2d0b90(0x19b)},'secondary_code':{'$first':_0x2d0b90(0x1fa)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2d0b90(0x1dc)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x2d0b90(0x208)},'pallet':{'$first':_0x2d0b90(0x1ef)},'unit':{'$first':_0x2d0b90(0x245)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2d0b90(0x1ce)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2d0b90(0x178)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x2d0b90(0x257)},'maxProducts':{'$first':_0x2d0b90(0x205)},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x167c37[_0x2d0b90(0x188)]>0x0)_0x49fbbf[_0x2d0b90(0x211)](_0x167c37);else _0x4d3685[_0x2d0b90(0x188)]>0x0&&_0x49fbbf[_0x2d0b90(0x211)](_0x4d3685);}const _0x1bc4ae=_0x114ec5[_0x2a934a(0x261)](_0x4953c9=>_0x586bd0(_0x4953c9));await Promise['all'](_0x1bc4ae),_0x8b6f0e['json'](_0x49fbbf);}),router[a0_0x515a4a(0x24b)](a0_0x515a4a(0x166),async(_0x4bf1fe,_0x5d2639)=>{var _0x7c3c07=a0_0x515a4a;try{const {FromWareHouse:_0x243bf1,FromRoom:_0x26cb6c,ToWarehouse:_0x3b8486,ToRoom:_0x56385b,secondary_code:_0x41caf8}=_0x4bf1fe['body'],_0x5ebb6e=await warehouse[_0x7c3c07(0x20f)]([{'$match':{'name':_0x243bf1}},{'$unwind':_0x7c3c07(0x22f)},{'$match':{'product_details.secondary_code':_0x41caf8}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x7c3c07(0x1cd)},'primary_code':{'$first':_0x7c3c07(0x19b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x7c3c07(0x1ca)},'instock':{'$first':_0x7c3c07(0x1d6)},'warehouse':{'$first':'$name'},'level':{'$first':_0x7c3c07(0x251)},'isle':{'$first':_0x7c3c07(0x16c)},'pallet':{'$first':_0x7c3c07(0x250)},'maxProducts':{'$first':_0x7c3c07(0x205)},'unit':{'$first':'$product_details.unit'}}}]);_0x5d2639[_0x7c3c07(0x232)](0xc8)['json'](_0x5ebb6e);}catch(_0xbaa703){_0x5d2639[_0x7c3c07(0x232)](0x194)['json']({'message':_0xbaa703[_0x7c3c07(0x173)]});}}),router[a0_0x515a4a(0x24b)](a0_0x515a4a(0x201),async(_0x42347f,_0x45a131)=>{var _0x229504=a0_0x515a4a;try{const {FromWareHouse:_0x204f05,FromRoom:_0x4de9ff,ToWarehouse:_0x28f9ac,ToRoom:_0x564ea3,product_code:_0x3c1512}=_0x42347f[_0x229504(0x184)],_0x17945e=await warehouse[_0x229504(0x20f)]([{'$match':{'name':_0x204f05}},{'$unwind':_0x229504(0x22f)},{'$match':{'product_details.product_code':_0x3c1512}},{'$group':{'_id':_0x229504(0x1be),'name':{'$first':_0x229504(0x1cd)},'primary_code':{'$first':_0x229504(0x19b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x229504(0x1ca)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x229504(0x1f6)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x229504(0x250)},'maxProducts':{'$first':_0x229504(0x205)},'unit':{'$first':_0x229504(0x245)}}}]);_0x45a131[_0x229504(0x232)](0xc8)[_0x229504(0x25f)](_0x17945e);}catch(_0x2e4e2c){_0x45a131['status'](0x194)[_0x229504(0x25f)]({'message':_0x2e4e2c[_0x229504(0x173)]});}}),router[a0_0x515a4a(0x24b)]('/CheckingWarehouse',async(_0x4dcd92,_0x3efcea)=>{var _0x362ee0=a0_0x515a4a;const {level:_0x149a2c,isle:_0x2e95fe,pallet:_0x18a30f,warehouses:_0x51deec,room:_0x339860}=_0x4dcd92[_0x362ee0(0x184)];try{const _0x5cc7fe=await warehouse[_0x362ee0(0x20f)]([{'$match':{'name':_0x51deec,'room':_0x339860}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x149a2c),'product_details.isle':_0x2e95fe,'product_details.pallet':parseInt(_0x18a30f)}},{'$group':{'_id':_0x362ee0(0x1be),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x362ee0(0x1d6)},'level':{'$first':_0x362ee0(0x251)},'isle':{'$first':_0x362ee0(0x16c)},'pallet':{'$first':_0x362ee0(0x250)},'maxProducts':{'$first':_0x362ee0(0x205)}}}]);_0x3efcea[_0x362ee0(0x232)](0xc8)['json'](_0x5cc7fe);}catch(_0x46ce5f){_0x3efcea[_0x362ee0(0x232)](0x194)[_0x362ee0(0x25f)]({'message':_0x46ce5f[_0x362ee0(0x173)]});}}),module['exports']=router;