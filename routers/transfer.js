var a0_0x1319f9=a0_0x4335;(function(_0x4d5ba4,_0x25fbe2){var _0x5e424d=a0_0x4335,_0x356ba7=_0x4d5ba4();while(!![]){try{var _0x75a472=-parseInt(_0x5e424d(0x1b9))/0x1*(parseInt(_0x5e424d(0x22e))/0x2)+-parseInt(_0x5e424d(0x1f3))/0x3*(-parseInt(_0x5e424d(0x25d))/0x4)+-parseInt(_0x5e424d(0x216))/0x5*(-parseInt(_0x5e424d(0x246))/0x6)+parseInt(_0x5e424d(0x271))/0x7*(-parseInt(_0x5e424d(0x27c))/0x8)+-parseInt(_0x5e424d(0x1d1))/0x9*(parseInt(_0x5e424d(0x21e))/0xa)+-parseInt(_0x5e424d(0x27d))/0xb*(-parseInt(_0x5e424d(0x241))/0xc)+-parseInt(_0x5e424d(0x1b4))/0xd;if(_0x75a472===_0x25fbe2)break;else _0x356ba7['push'](_0x356ba7['shift']());}catch(_0x118934){_0x356ba7['push'](_0x356ba7['shift']());}}}(a0_0x1f97,0x95d37));function a0_0x4335(_0x48acad,_0x34ea54){var _0x1f9754=a0_0x1f97();return a0_0x4335=function(_0x433548,_0x5ab74f){_0x433548=_0x433548-0x19f;var _0x1ca20c=_0x1f9754[_0x433548];return _0x1ca20c;},a0_0x4335(_0x48acad,_0x34ea54);}const express=require(a0_0x1319f9(0x1c4)),app=express(),router=express[a0_0x1319f9(0x25a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x1319f9(0x1e6)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x1319f9(0x1d9));router['get']('/view',auth,async(_0x646708,_0xd1d85e)=>{var _0x1c4a3f=a0_0x1319f9;try{const {username:_0x37664e,email:_0x566c82,role:_0x2abbbb}=_0x646708[_0x1c4a3f(0x1a1)],_0x5d54ce=_0x646708[_0x1c4a3f(0x1a1)],_0x3aac8e=await profile[_0x1c4a3f(0x272)]({'email':_0x5d54ce['email']}),_0x2559b5=await master_shop[_0x1c4a3f(0x1bc)]();console['log'](_0x1c4a3f(0x1ae),_0x2559b5);let _0xeeebe;if(_0x5d54ce['role']==_0x1c4a3f(0x219)){const _0x55f77e=await staff['findOne']({'email':_0x5d54ce[_0x1c4a3f(0x1c9)]});_0xeeebe=await transfers[_0x1c4a3f(0x1bc)]({'from_warehouse':_0x55f77e[_0x1c4a3f(0x260)]});}else _0xeeebe=await transfers[_0x1c4a3f(0x263)]([{'$unwind':_0x1c4a3f(0x259)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1c4a3f(0x1f0)},'date':{'$first':_0x1c4a3f(0x224)},'from_warehouse':{'$first':_0x1c4a3f(0x212)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x1c4a3f(0x252)},'to_room_name':{'$addToSet':_0x1c4a3f(0x27e)},'finalize':{'$first':_0x1c4a3f(0x1eb)},'isAllowEdit':{'$first':_0x1c4a3f(0x23e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2559b5[0x0][_0x1c4a3f(0x28b)]==_0x1c4a3f(0x1e4)){var _0x40795f=users[_0x1c4a3f(0x270)];console[_0x1c4a3f(0x273)](_0x40795f);}else{if(_0x2559b5[0x0][_0x1c4a3f(0x28b)]==_0x1c4a3f(0x239))var _0x40795f=users[_0x1c4a3f(0x239)];else{if(_0x2559b5[0x0]['language']==_0x1c4a3f(0x27f))var _0x40795f=users['German'];else{if(_0x2559b5[0x0][_0x1c4a3f(0x28b)]==_0x1c4a3f(0x204))var _0x40795f=users[_0x1c4a3f(0x204)];else{if(_0x2559b5[0x0][_0x1c4a3f(0x28b)]==_0x1c4a3f(0x1f8))var _0x40795f=users['French'];else{if(_0x2559b5[0x0][_0x1c4a3f(0x28b)]=='Portuguese\x20(BR)')var _0x40795f=users[_0x1c4a3f(0x202)];else{if(_0x2559b5[0x0][_0x1c4a3f(0x28b)]=='Chinese')var _0x40795f=users[_0x1c4a3f(0x292)];else{if(_0x2559b5[0x0][_0x1c4a3f(0x28b)]==_0x1c4a3f(0x1e5))var _0x40795f=users['Arabic'];}}}}}}}_0xd1d85e['render'](_0x1c4a3f(0x285),{'success':_0x646708['flash'](_0x1c4a3f(0x1ef)),'errors':_0x646708[_0x1c4a3f(0x280)]('errors'),'role':_0x5d54ce,'profile':_0x3aac8e,'master_shop':_0x2559b5,'transfer':_0xeeebe,'language':_0x40795f});}catch(_0x2035d3){console['log'](_0x2035d3);}});async function getRandom8DigitNumber(){var _0x57f7a0=a0_0x1319f9;const _0x2642e4=0x989680,_0x407bd6=0x5f5e0ff,_0x169ea8=Math[_0x57f7a0(0x264)](Math['random']()*(_0x407bd6-_0x2642e4+0x1))+_0x2642e4;var _0x3bdb03;const _0x12fcd9=await transfers['findOne']({'invoice':_0x57f7a0(0x209)+_0x169ea8});return _0x12fcd9&&_0x12fcd9[_0x57f7a0(0x28c)]>0x0?_0x3bdb03=_0x57f7a0(0x209)+_0x169ea8:_0x3bdb03=_0x57f7a0(0x209)+_0x169ea8,_0x3bdb03;}router[a0_0x1319f9(0x1e1)](a0_0x1319f9(0x1fb),auth,async(_0x2fe88a,_0x36f74c)=>{var _0x502e72=a0_0x1319f9;try{const {username:_0xa293c3,email:_0x5ef95c,role:_0x2ec920}=_0x2fe88a[_0x502e72(0x1a1)],_0x24815a=_0x2fe88a[_0x502e72(0x1a1)],_0x52fff2=await profile[_0x502e72(0x272)]({'email':_0x24815a[_0x502e72(0x1c9)]}),_0x2079cb=await master_shop[_0x502e72(0x1bc)]();console[_0x502e72(0x273)]('master',_0x2079cb);let _0x3bebf0;if(_0x24815a[_0x502e72(0x1bd)]==_0x502e72(0x219)){const _0x21dc9e=await staff[_0x502e72(0x272)]({'email':_0x24815a[_0x502e72(0x1c9)]});_0x3bebf0=await warehouse['aggregate']([{'$match':{'status':_0x502e72(0x236),'name':_0x21dc9e['warehouse'],'warehouse_category':_0x502e72(0x1fc)}},{'$group':{'_id':'$name','name':{'$first':_0x502e72(0x26f)}}}]);}else _0x3bebf0=await warehouse[_0x502e72(0x263)]([{'$match':{'status':_0x502e72(0x236),'warehouse_category':_0x502e72(0x1fc)}},{'$group':{'_id':_0x502e72(0x26f),'name':{'$first':_0x502e72(0x26f)}}}]);var _0x48e33a=[_0x502e72(0x220),_0x502e72(0x1ee),'Return\x20Rooms'];const _0x5a82f3=await transfers[_0x502e72(0x1bc)]({}),_0x3282e4=_0x5a82f3['length']+0x1,_0x2515d4=_0x502e72(0x209)+_0x3282e4[_0x502e72(0x1fe)]()[_0x502e72(0x281)](0x5,'0');if(_0x2079cb[0x0][_0x502e72(0x28b)]=='English\x20(US)'){var _0x38114d=users[_0x502e72(0x270)];console['log'](_0x38114d);}else{if(_0x2079cb[0x0][_0x502e72(0x28b)]==_0x502e72(0x239))var _0x38114d=users[_0x502e72(0x239)];else{if(_0x2079cb[0x0][_0x502e72(0x28b)]=='German')var _0x38114d=users[_0x502e72(0x27f)];else{if(_0x2079cb[0x0][_0x502e72(0x28b)]==_0x502e72(0x204))var _0x38114d=users['Spanish'];else{if(_0x2079cb[0x0]['language']==_0x502e72(0x1f8))var _0x38114d=users[_0x502e72(0x1f8)];else{if(_0x2079cb[0x0]['language']==_0x502e72(0x1fa))var _0x38114d=users[_0x502e72(0x202)];else{if(_0x2079cb[0x0][_0x502e72(0x28b)]=='Chinese')var _0x38114d=users[_0x502e72(0x292)];else{if(_0x2079cb[0x0][_0x502e72(0x28b)]==_0x502e72(0x1e5))var _0x38114d=users[_0x502e72(0x267)];}}}}}}}const _0x44f4c4=getRandom8DigitNumber();_0x44f4c4[_0x502e72(0x215)](_0x21f1e4=>{var _0x1d0fc5=_0x502e72;_0x36f74c['render'](_0x1d0fc5(0x229),{'success':_0x2fe88a['flash']('success'),'errors':_0x2fe88a[_0x1d0fc5(0x280)](_0x1d0fc5(0x1dd)),'role':_0x24815a,'profile':_0x52fff2,'master_shop':_0x2079cb,'warehouse':_0x3bebf0,'language':_0x38114d,'rooms_data':_0x48e33a,'invoice':_0x21f1e4});})[_0x502e72(0x214)](_0x2efbe6=>{var _0x3e64f9=_0x502e72;_0x2fe88a[_0x3e64f9(0x280)](_0x3e64f9(0x1dd),_0x3e64f9(0x227)),_0x36f74c[_0x3e64f9(0x23b)](_0x3e64f9(0x207));});}catch(_0x4f3520){console[_0x502e72(0x273)](_0x4f3520);}}),router['post'](a0_0x1319f9(0x1fb),auth,async(_0x535aea,_0x2f163a)=>{var _0x3a3a06=a0_0x1319f9;try{console[_0x3a3a06(0x273)](_0x535aea[_0x3a3a06(0x282)]);const {date:_0x404aa0,from_warehouse:_0x1b6116,FromRoom_name:_0x4ed3c8,to_warehouse:_0x4dfbe9,ToRoom_name:_0x200dd7,prod_name:_0x29e519,from_prod_qty:_0x284e17,from_prod_level:_0x42a596,from_prod_isle:_0x10f4fb,from_prod_pallet:_0x53033c,to_prod_qty:_0x25ee94,to_prod_level:_0x54b212,to_prod_isle:_0x108b93,to_prod_pallet:_0x53f794,primary_code:_0x26446f,secondary_code:_0x1fc648,product_code3:_0x50fff1,note:_0x2a72c7,MaxStocks_data2:_0x18195f,invoice:_0x313c6a,expiry_date:_0x11fd88}=_0x535aea[_0x3a3a06(0x282)];if(typeof _0x29e519=='string')var _0x58ca5a=[_0x535aea['body'][_0x3a3a06(0x278)]],_0x4178f0=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x254)]],_0x2888f8=[_0x535aea['body'][_0x3a3a06(0x1c5)]],_0x1ed68f=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x289)]],_0x434601=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x293)]],_0x2e90b3=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1e3)]],_0x3d9204=[_0x535aea['body']['secondary_code']],_0x32e783=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x22c)]],_0xe46d2d=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x230)]],_0x5ee93d=[_0x535aea[_0x3a3a06(0x282)]['primary_unit']],_0x40686a=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x22f)]],_0xd9e7c5=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x247)]],_0x281829=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1aa)]],_0x187029=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x265)]],_0x3f562d=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x262)]],_0x55427c=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1ce)]],_0x2195e3=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1cf)]],_0x29df40=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x23f)]],_0x4d0241=[_0x535aea['body'][_0x3a3a06(0x235)]],_0x3da48f=[_0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x25f)]];else var _0x58ca5a=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x278)]],_0x4178f0=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x254)]],_0x2888f8=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1c5)]],_0x1ed68f=[..._0x535aea['body'][_0x3a3a06(0x289)]],_0x434601=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x293)]],_0x2e90b3=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1e3)]],_0x3d9204=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1c1)]],_0x32e783=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x22c)]],_0xe46d2d=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x230)]],_0x5ee93d=[..._0x535aea['body']['primary_unit']],_0x40686a=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x22f)]],_0xd9e7c5=[..._0x535aea[_0x3a3a06(0x282)]['batch_code']],_0x281829=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1aa)]],_0x187029=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x265)]],_0x3f562d=[..._0x535aea['body'][_0x3a3a06(0x262)]],_0x55427c=[..._0x535aea[_0x3a3a06(0x282)]['prod_cat']],_0x2195e3=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x1cf)]],_0x29df40=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x23f)]],_0x4d0241=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x235)]],_0x3da48f=[..._0x535aea[_0x3a3a06(0x282)][_0x3a3a06(0x25f)]];const _0x57ebff=_0x58ca5a[_0x3a3a06(0x1ac)](_0x4c1d96=>{return _0x4c1d96={'product_name':_0x4c1d96};});_0x4178f0[_0x3a3a06(0x27a)]((_0x5062eb,_0x1c6405)=>{var _0x28e80f=_0x3a3a06;_0x57ebff[_0x1c6405][_0x28e80f(0x20b)]=_0x5062eb;}),_0x4d0241[_0x3a3a06(0x27a)]((_0x273156,_0x41c21f)=>{var _0x5d9702=_0x3a3a06;_0x57ebff[_0x41c21f][_0x5d9702(0x235)]=_0x273156;}),_0x3da48f[_0x3a3a06(0x27a)]((_0x155799,_0x82208e)=>{var _0x418419=_0x3a3a06;_0x57ebff[_0x82208e][_0x418419(0x1b0)]=_0x155799;}),_0x2888f8[_0x3a3a06(0x27a)]((_0x286d64,_0x11da68)=>{var _0x15416a=_0x3a3a06;_0x2195e3[_0x15416a(0x27a)]((_0x1b28a3,_0x481e1a)=>{var _0x33c98a=_0x15416a;if(_0x1b28a3=='Receiving\x20Area'&&_0x11da68==_0x481e1a){var _0x3594bc=_0x286d64[_0x33c98a(0x233)](0x3);_0x57ebff[_0x11da68][_0x33c98a(0x1e0)]=_0x286d64[0x0],_0x57ebff[_0x11da68][_0x33c98a(0x21d)]=_0x286d64[0x1],_0x57ebff[_0x11da68][_0x33c98a(0x242)]=0x0,_0x57ebff[_0x11da68][_0x33c98a(0x27b)]=0x0,_0x57ebff[_0x11da68][_0x33c98a(0x225)]=_0x33c98a(0x245),_0x57ebff[_0x11da68]['from_floorlevel']=_0x3594bc;}else{if(_0x1b28a3==_0x33c98a(0x228)&&_0x11da68==_0x481e1a){var _0x3594bc=_0x286d64[_0x33c98a(0x233)](0x3);_0x57ebff[_0x11da68]['from_storage']=_0x286d64[0x0],_0x57ebff[_0x11da68][_0x33c98a(0x21d)]=_0x286d64[0x1],_0x57ebff[_0x11da68][_0x33c98a(0x242)]=0x0,_0x57ebff[_0x11da68][_0x33c98a(0x27b)]=0x0,_0x57ebff[_0x11da68][_0x33c98a(0x225)]='Floor',_0x57ebff[_0x11da68][_0x33c98a(0x25c)]=_0x286d64[0x5];}else{if(_0x11da68==_0x481e1a){var _0x3f4e61;if(_0x286d64[0x4]=='L')_0x3f4e61=_0x33c98a(0x1bf);else _0x286d64[0x4]=='F'&&(_0x3f4e61='Floor');_0x57ebff[_0x11da68][_0x33c98a(0x1e0)]=_0x286d64[0x0],_0x57ebff[_0x11da68]['from_rack']=_0x286d64[0x1],_0x57ebff[_0x11da68][_0x33c98a(0x242)]=_0x286d64[0x2],_0x57ebff[_0x11da68][_0x33c98a(0x27b)]=_0x286d64[0x3],_0x57ebff[_0x11da68]['from_types']=_0x3f4e61,_0x57ebff[_0x11da68]['from_floorlevel']=_0x286d64[0x5];}}}});}),_0x1ed68f['forEach']((_0x2f0327,_0x12e625)=>{_0x57ebff[_0x12e625]['to_quantity']=_0x2f0327;}),_0x434601[_0x3a3a06(0x27a)]((_0x536a84,_0x589381)=>{var _0x429ba2=_0x3a3a06;_0x29df40[_0x429ba2(0x27a)]((_0x1ce75f,_0x410035)=>{var _0x1accf4=_0x429ba2;if(_0x1ce75f==_0x1accf4(0x1ab)&&_0x589381==_0x410035){var _0x17aa96=_0x536a84['slice'](0x3);_0x57ebff[_0x589381]['storage']=_0x536a84[0x0],_0x57ebff[_0x589381][_0x1accf4(0x1b2)]=_0x536a84[0x1],_0x57ebff[_0x589381][_0x1accf4(0x291)]=0x0,_0x57ebff[_0x589381][_0x1accf4(0x257)]=0x0,_0x57ebff[_0x589381][_0x1accf4(0x206)]=_0x1accf4(0x245),_0x57ebff[_0x589381][_0x1accf4(0x1a5)]=_0x17aa96;}else{if(_0x1ce75f==_0x1accf4(0x228)&&_0x589381==_0x410035){var _0x17aa96=_0x536a84[_0x1accf4(0x233)](0x3);_0x57ebff[_0x589381][_0x1accf4(0x1a3)]=_0x536a84[0x0],_0x57ebff[_0x589381]['rack']=_0x536a84[0x1],_0x57ebff[_0x589381][_0x1accf4(0x291)]=0x0,_0x57ebff[_0x589381][_0x1accf4(0x257)]=0x0,_0x57ebff[_0x589381]['to_types']=_0x1accf4(0x245),_0x57ebff[_0x589381][_0x1accf4(0x1a5)]=_0x536a84[0x5];}else{if(_0x589381==_0x410035){var _0x364542;if(_0x536a84[0x4]=='L')_0x364542=_0x1accf4(0x1bf);else _0x536a84[0x4]=='F'&&(_0x364542='Floor');_0x57ebff[_0x589381][_0x1accf4(0x1a3)]=_0x536a84[0x0],_0x57ebff[_0x589381]['rack']=_0x536a84[0x1],_0x57ebff[_0x589381][_0x1accf4(0x291)]=_0x536a84[0x2],_0x57ebff[_0x589381]['to_bin']=_0x536a84[0x3],_0x57ebff[_0x589381][_0x1accf4(0x206)]=_0x364542,_0x57ebff[_0x589381][_0x1accf4(0x1a5)]=_0x536a84[0x5];}}}});}),_0x2e90b3[_0x3a3a06(0x27a)]((_0x5b66d,_0x234703)=>{_0x57ebff[_0x234703]['primary_code']=_0x5b66d;}),_0x3d9204[_0x3a3a06(0x27a)]((_0x317ab2,_0x1df203)=>{_0x57ebff[_0x1df203]['secondary_code']=_0x317ab2;}),_0x32e783[_0x3a3a06(0x27a)]((_0x33f242,_0x44d0f9)=>{_0x57ebff[_0x44d0f9]['product_code']=_0x33f242;}),_0xe46d2d[_0x3a3a06(0x27a)]((_0x1d436d,_0x3c5ebf)=>{_0x57ebff[_0x3c5ebf]['maxProducts']=_0x1d436d;}),_0x5ee93d[_0x3a3a06(0x27a)]((_0x3bf3ce,_0x3843e4)=>{var _0x423517=_0x3a3a06;_0x57ebff[_0x3843e4][_0x423517(0x1c8)]=_0x3bf3ce;}),_0x40686a['forEach']((_0x5814d1,_0x1e0859)=>{_0x57ebff[_0x1e0859]['secondary_unit']=_0x5814d1;}),_0xd9e7c5['forEach']((_0x44fa58,_0xeccb84)=>{var _0x2e7ff0=_0x3a3a06;_0x57ebff[_0xeccb84][_0x2e7ff0(0x247)]=_0x44fa58;}),_0x281829[_0x3a3a06(0x27a)]((_0x333be3,_0x568cdb)=>{var _0xee09de=_0x3a3a06;_0x57ebff[_0x568cdb][_0xee09de(0x1aa)]=_0x333be3;}),_0x187029['forEach']((_0x21b0f4,_0x382552)=>{_0x57ebff[_0x382552]['maxperunit']=_0x21b0f4;}),_0x3f562d[_0x3a3a06(0x27a)]((_0x3e5b49,_0x33fc8f)=>{var _0x4d452f=_0x3a3a06;_0x57ebff[_0x33fc8f][_0x4d452f(0x262)]=_0x3e5b49;}),_0x55427c['forEach']((_0x16755a,_0x25a1e2)=>{var _0x3c3a1f=_0x3a3a06;_0x57ebff[_0x25a1e2][_0x3c3a1f(0x1ce)]=_0x16755a;}),_0x2195e3[_0x3a3a06(0x27a)]((_0x1fe35e,_0x26b3f8)=>{_0x57ebff[_0x26b3f8]['from_room_name']=_0x1fe35e;}),_0x29df40[_0x3a3a06(0x27a)]((_0x119a16,_0x4a530a)=>{var _0x9d97aa=_0x3a3a06;_0x57ebff[_0x4a530a][_0x9d97aa(0x20d)]=_0x119a16;});const _0x5e55e3=_0x57ebff['filter'](_0x48284e=>_0x48284e[_0x3a3a06(0x1d4)]!=='0'&&_0x48284e[_0x3a3a06(0x1d4)]!==''||_0x48284e['to_floorlevel']!=='0'&&_0x48284e['to_floorlevel']!==''),_0x4f1eeb=new transfers({'date':_0x404aa0,'from_warehouse':_0x1b6116,'to_warehouse':_0x4dfbe9,'product':_0x5e55e3,'note':_0x2a72c7,'invoice':_0x313c6a}),_0x5f4ad5=await _0x4f1eeb[_0x3a3a06(0x1e8)]();_0x535aea[_0x3a3a06(0x280)](_0x3a3a06(0x1ef),_0x3a3a06(0x283)),_0x2f163a[_0x3a3a06(0x23b)](_0x3a3a06(0x274)+_0x5f4ad5[_0x3a3a06(0x1e2)]);}catch(_0x1eb999){console[_0x3a3a06(0x273)](_0x1eb999),_0x2f163a['status'](0xc8)[_0x3a3a06(0x23d)]({'errorMessage':_0x1eb999[_0x3a3a06(0x1b6)]});}}),router[a0_0x1319f9(0x1e1)](a0_0x1319f9(0x22d),auth,async(_0x3242fc,_0xdf7ada)=>{var _0xf01b03=a0_0x1319f9;try{const {username:_0x43c430,email:_0x257998,role:_0x251c0c}=_0x3242fc[_0xf01b03(0x1a1)],_0x1a8017=_0x3242fc[_0xf01b03(0x1a1)],_0x146b60=await profile[_0xf01b03(0x272)]({'email':_0x1a8017[_0xf01b03(0x1c9)]}),_0x40b400=await master_shop['find']();console[_0xf01b03(0x273)](_0xf01b03(0x1ae),_0x40b400);const _0x33451e=await transfers[_0xf01b03(0x211)](_0x3242fc[_0xf01b03(0x217)]['id']);let _0x190eb6=new Date(_0x33451e[_0xf01b03(0x1aa)]),_0x26f461=('0'+_0x190eb6[_0xf01b03(0x1f5)]())[_0xf01b03(0x233)](-0x2),_0x17b91c=('0'+(_0x190eb6['getMonth']()+0x1))[_0xf01b03(0x233)](-0x2),_0x485c43=_0x190eb6[_0xf01b03(0x1f7)](),_0x465f68=_0x485c43+'-'+_0x17b91c+'-'+_0x26f461,_0x143f7d;if(_0x1a8017['role']=='staff'){const _0x34427e=await staff[_0xf01b03(0x272)]({'email':_0x1a8017[_0xf01b03(0x1c9)]});_0x143f7d=await warehouse[_0xf01b03(0x1bc)]({'status':_0xf01b03(0x236),'name':_0x34427e[_0xf01b03(0x260)],'warehouse_category':'Raw\x20Materials'});}else _0x143f7d=await warehouse[_0xf01b03(0x1bc)]({'status':'Enabled','warehouse_category':_0xf01b03(0x1fc)});const _0x2012f7=await warehouse[_0xf01b03(0x263)]([{'$match':{'name':_0x33451e['from_warehouse']}},{'$unwind':_0xf01b03(0x251)},{'$group':{'_id':_0xf01b03(0x1df),'name':{'$first':_0xf01b03(0x221)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xf01b03(0x1dc)},'bin':{'$first':_0xf01b03(0x256)},'type':{'$first':_0xf01b03(0x1be)},'floorlevel':{'$first':_0xf01b03(0x1b8)},'primary_code':{'$first':_0xf01b03(0x210)},'secondary_code':{'$first':_0xf01b03(0x25b)},'product_code':{'$first':_0xf01b03(0x1bb)},'storage':{'$first':_0xf01b03(0x1e9)},'rack':{'$first':_0xf01b03(0x20f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xf01b03(0x1d7)},'room':{'$first':'$room'}}}]);if(_0x40b400[0x0][_0xf01b03(0x28b)]=='English\x20(US)'){var _0x4ee4fa=users[_0xf01b03(0x270)];console['log'](_0x4ee4fa);}else{if(_0x40b400[0x0]['language']==_0xf01b03(0x239))var _0x4ee4fa=users[_0xf01b03(0x239)];else{if(_0x40b400[0x0]['language']==_0xf01b03(0x27f))var _0x4ee4fa=users[_0xf01b03(0x27f)];else{if(_0x40b400[0x0]['language']==_0xf01b03(0x204))var _0x4ee4fa=users['Spanish'];else{if(_0x40b400[0x0]['language']=='French')var _0x4ee4fa=users['French'];else{if(_0x40b400[0x0][_0xf01b03(0x28b)]==_0xf01b03(0x1fa))var _0x4ee4fa=users[_0xf01b03(0x202)];else{if(_0x40b400[0x0]['language']==_0xf01b03(0x292))var _0x4ee4fa=users[_0xf01b03(0x292)];else{if(_0x40b400[0x0][_0xf01b03(0x28b)]==_0xf01b03(0x1e5))var _0x4ee4fa=users[_0xf01b03(0x267)];}}}}}}}_0xdf7ada[_0xf01b03(0x1ad)](_0xf01b03(0x1b7),{'success':_0x3242fc['flash'](_0xf01b03(0x1ef)),'errors':_0x3242fc[_0xf01b03(0x280)]('errors'),'role':_0x1a8017,'profile':_0x146b60,'master_shop':_0x40b400,'warehouse':_0x143f7d,'transfer':_0x33451e,'stock':_0x2012f7,'language':_0x4ee4fa});}catch(_0x2f3b0f){console[_0xf01b03(0x273)](_0x2f3b0f);}}),router[a0_0x1319f9(0x1db)](a0_0x1319f9(0x22d),auth,async(_0x5aca62,_0x38e742)=>{var _0x35f89a=a0_0x1319f9;try{const _0x4198fb=_0x5aca62[_0x35f89a(0x217)]['id'],{from_warehouse:_0x1cff7b,FromRoom_name:_0x311698,to_warehouse:_0x308d9f,ToRoom_name:_0x3c726f}=_0x5aca62['body'],_0x5d5689=await transfers['findById']({'_id':_0x4198fb}),_0x17f028=_0x5d5689[_0x35f89a(0x277)][_0x35f89a(0x1ac)](async _0x496d34=>{var _0x2cebd1=_0x35f89a;if(_0x496d34[_0x2cebd1(0x1d4)]>0x0){var _0x56a016=await warehouse['findOne']({'name':_0x5d5689[_0x2cebd1(0x294)],'room':_0x496d34[_0x2cebd1(0x284)],'warehouse_category':_0x2cebd1(0x1fc)});const _0x10d1b8=_0x56a016['product_details'][_0x2cebd1(0x1ac)](_0x3664a5=>{var _0x34dc62=_0x2cebd1;_0x3664a5[_0x34dc62(0x276)]==_0x496d34[_0x34dc62(0x276)]&&_0x3664a5['floorlevel']==_0x496d34[_0x34dc62(0x25c)]&&_0x3664a5['type']==_0x496d34['from_types']&&_0x3664a5[_0x34dc62(0x23c)]==_0x496d34['from_bin']&&_0x3664a5[_0x34dc62(0x269)]==_0x496d34['from_bay']&&_0x3664a5[_0x34dc62(0x1b2)]==_0x496d34[_0x34dc62(0x21d)]&&_0x3664a5['storage']==_0x496d34['from_storage']&&_0x3664a5[_0x34dc62(0x1aa)]==_0x496d34['expiry_date']&&_0x3664a5['batch_code']==_0x496d34[_0x34dc62(0x247)]&&_0x3664a5[_0x34dc62(0x262)]==_0x496d34['production_date']&&_0x3664a5[_0x34dc62(0x1cb)]==_0x496d34[_0x34dc62(0x235)]&&(_0x3664a5[_0x34dc62(0x1d8)]=_0x3664a5[_0x34dc62(0x1d8)]-_0x496d34['to_quantity']);});}return _0x56a016;});Promise[_0x35f89a(0x21c)](_0x17f028)[_0x35f89a(0x215)](async _0x2ea52a=>{var _0x2886ac=_0x35f89a;try{for(const _0x50879b of _0x2ea52a){await _0x50879b[_0x2886ac(0x1e8)]();}try{const _0x55b1ff=_0x5d5689[_0x2886ac(0x277)][_0x2886ac(0x1ac)](async _0x51225f=>{var _0x359a78=_0x2886ac;if(_0x51225f[_0x359a78(0x1d4)]>0x0){var _0xec13ae=await warehouse[_0x359a78(0x272)]({'name':_0x5d5689[_0x359a78(0x1b5)],'room':_0x51225f[_0x359a78(0x20d)],'warehouse_category':'Raw\x20Materials'}),_0x12faa0=0x0;const _0x424169=_0xec13ae['product_details'][_0x359a78(0x1ac)](_0x3bf587=>{var _0x437aa8=_0x359a78;_0x3bf587[_0x437aa8(0x276)]==_0x51225f[_0x437aa8(0x276)]&&_0x3bf587[_0x437aa8(0x1f6)]==_0x51225f[_0x437aa8(0x1a5)]&&_0x3bf587[_0x437aa8(0x20a)]==_0x51225f[_0x437aa8(0x206)]&&_0x3bf587['bin']==_0x51225f[_0x437aa8(0x257)]&&_0x3bf587[_0x437aa8(0x269)]==_0x51225f[_0x437aa8(0x291)]&&_0x3bf587[_0x437aa8(0x1b2)]==_0x51225f['rack']&&_0x3bf587[_0x437aa8(0x1a3)]==_0x51225f[_0x437aa8(0x1a3)]&&_0x3bf587[_0x437aa8(0x1aa)]==_0x51225f[_0x437aa8(0x1aa)]&&_0x3bf587[_0x437aa8(0x247)]==_0x51225f[_0x437aa8(0x247)]&&_0x3bf587['production_date']==_0x51225f[_0x437aa8(0x262)]&&_0x3bf587[_0x437aa8(0x1cb)]==_0x51225f['To_invoice']&&(_0x3bf587[_0x437aa8(0x1d8)]=_0x3bf587['product_stock']+_0x51225f['to_quantity'],_0x12faa0++);});_0x12faa0=='0'&&(_0xec13ae[_0x359a78(0x26e)]=_0xec13ae[_0x359a78(0x26e)]['concat']({'product_name':_0x51225f['product_name'],'product_stock':_0x51225f['to_quantity'],'bay':_0x51225f[_0x359a78(0x291)],'bin':_0x51225f[_0x359a78(0x257)],'type':_0x51225f[_0x359a78(0x206)],'floorlevel':_0x51225f[_0x359a78(0x1a5)],'storage':_0x51225f[_0x359a78(0x1a3)],'rack':_0x51225f['rack'],'product_code':_0x51225f['product_code'],'primary_code':_0x51225f[_0x359a78(0x1e3)],'secondary_code':_0x51225f[_0x359a78(0x1c1)],'maxProducts':_0x51225f[_0x359a78(0x24b)],'storage':_0x51225f[_0x359a78(0x1a3)],'rack':_0x51225f[_0x359a78(0x1b2)],'expiry_date':_0x51225f[_0x359a78(0x1aa)],'maxPerUnit':_0x51225f['maxperunit'],'batch_code':_0x51225f[_0x359a78(0x247)],'production_date':_0x51225f[_0x359a78(0x262)]}));}return _0xec13ae;});Promise[_0x2886ac(0x21c)](_0x55b1ff)['then'](async _0x1b7b80=>{var _0x174357=_0x2886ac;try{for(const _0x5eeccf of _0x1b7b80){await warehouse[_0x174357(0x24a)]({'_id':_0x5eeccf[_0x174357(0x1e2)]},{'$addToSet':{'product_details':{'$each':_0x5eeccf[_0x174357(0x26e)]}}});}_0x5d5689['finalize']=_0x174357(0x1d0);const _0x235c4f=await _0x5d5689[_0x174357(0x1e8)](),_0x24bafb=await master_shop[_0x174357(0x1bc)](),_0x591a94=await email_settings[_0x174357(0x272)](),_0x441b8b=await supervisor_settings[_0x174357(0x1bc)]();var _0x561059=_0x5d5689['product'],_0x2a750a='',_0x379326;for(_0x379326 in _0x561059){_0x2a750a+=_0x174357(0x201)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x561059[_0x379326][_0x174357(0x276)]+_0x174357(0x1cc)+_0x174357(0x1b3)+_0x561059[_0x379326]['product_code']+_0x174357(0x1cc)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x561059[_0x379326][_0x174357(0x1d4)]+'</td>'+_0x174357(0x1b3)+_0x561059[_0x379326][_0x174357(0x1c8)]+'</td>'+_0x174357(0x1b3)+_0x561059[_0x379326][_0x174357(0x22f)]+_0x174357(0x1cc)+_0x174357(0x1b3)+_0x5d5689[_0x174357(0x1b5)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x561059[_0x379326][_0x174357(0x20d)]+_0x174357(0x1cc)+_0x174357(0x1b3)+_0x561059[_0x379326][_0x174357(0x1a3)]+_0x561059[_0x379326]['rack']+_0x561059[_0x379326]['to_bay']+_0x561059[_0x379326][_0x174357(0x257)]+_0x561059[_0x379326][_0x174357(0x206)][0x0]+_0x561059[_0x379326][_0x174357(0x1a5)]+_0x174357(0x1cc),_0x174357(0x28f);}let _0x151434=nodemailer['createTransport']({'host':_0x591a94[_0x174357(0x232)],'port':Number(_0x591a94[_0x174357(0x231)]),'secure':![],'auth':{'user':_0x591a94['email'],'pass':_0x591a94[_0x174357(0x1c6)]}}),_0x5ecd12={'from':_0x591a94[_0x174357(0x1c9)],'to':_0x441b8b[0x0][_0x174357(0x1ed)],'subject':_0x174357(0x21f),'attachments':[{'filename':'Logo.png','path':__dirname+_0x174357(0x205)+_0x174357(0x1de)+_0x24bafb[0x0][_0x174357(0x1ca)],'cid':'logo'}],'html':_0x174357(0x279)+_0x174357(0x286)+_0x174357(0x21a)+'<div>'+_0x174357(0x223)+'<div>'+_0x174357(0x268)+_0x174357(0x266)+_0x174357(0x1a0)+_0x174357(0x288)+_0x24bafb[0x0][_0x174357(0x1a8)]+_0x174357(0x1cd)+_0x174357(0x266)+_0x174357(0x266)+_0x174357(0x1af)+_0x174357(0x1a0)+_0x174357(0x1fd)+_0x174357(0x1ec)+_0x5d5689[_0x174357(0x1cb)]+'\x20'+_0x174357(0x1a7)+'\x20Order\x20Date\x20:\x20'+_0x5d5689[_0x174357(0x1d5)]+'\x20'+_0x174357(0x1c0)+_0x174357(0x213)+_0x174357(0x266)+_0x174357(0x1c2)+_0x174357(0x275)+_0x174357(0x201)+_0x174357(0x23a)+_0x174357(0x1d3)+_0x174357(0x1f4)+_0x174357(0x26d)+_0x174357(0x218)+_0x174357(0x1da)+_0x174357(0x1c3)+_0x174357(0x1c7)+'</tr>'+_0x174357(0x1a2)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x2a750a+'\x20'+_0x174357(0x243)+_0x174357(0x1ba)+_0x174357(0x1a0)+_0x174357(0x250)+_0x174357(0x22b)+_0x24bafb[0x0][_0x174357(0x1a8)]+'</h5>'+_0x174357(0x266)+'</div>'+_0x174357(0x1a9)};_0x151434['sendMail'](_0x5ecd12,function(_0x354855,_0x5dde8d){var _0x157fcf=_0x174357;_0x354855?(console[_0x157fcf(0x273)](_0x354855),console[_0x157fcf(0x273)]('Error\x20Occurs')):console[_0x157fcf(0x273)](_0x157fcf(0x240));}),_0x5aca62[_0x174357(0x280)](_0x174357(0x1ef),_0x174357(0x1a4)),_0x38e742[_0x174357(0x23b)](_0x174357(0x1a6)+_0x235c4f[_0x174357(0x1e2)]);}catch(_0x41923c){console['error'](_0x41923c),_0x38e742[_0x174357(0x1b1)](0x1f4)[_0x174357(0x23d)]({'Perror':_0x174357(0x249),'message':_0x41923c[_0x174357(0x1b6)]});}})[_0x2886ac(0x214)](_0x5619ca=>{var _0x1b7e10=_0x2886ac;console[_0x1b7e10(0x1ff)](_0x5619ca),_0x38e742[_0x1b7e10(0x1b1)](0x1f4)[_0x1b7e10(0x23d)]({'Perror':_0x1b7e10(0x24f)});});}catch(_0xe1e63e){_0x38e742['json'](_0xe1e63e);}}catch(_0x46a2a8){console[_0x2886ac(0x1ff)](_0x46a2a8),_0x38e742[_0x2886ac(0x1b1)](0x1f4)[_0x2886ac(0x23d)]({'Merror':_0x2886ac(0x249),'Message':_0x46a2a8['message']});}})[_0x35f89a(0x214)](_0x35dce2=>{var _0x16f4ee=_0x35f89a;console[_0x16f4ee(0x1ff)](_0x35dce2),_0x38e742[_0x16f4ee(0x1b1)](0x1f4)[_0x16f4ee(0x23d)]({'Merror':_0x16f4ee(0x24f)});});}catch(_0x26b586){console[_0x35f89a(0x273)](_0x26b586);}});function BayBinSelected(_0xf1a6ef,_0x3e0fe4){var _0x3e7924=a0_0x1319f9,_0x15d3ca=[],_0x48c03f=[],_0x479240=[],_0x13eda9=[],_0x2627ba=[],_0x3b1a3b=[];let _0x2daac7=[];if(_0xf1a6ef==_0x3e7924(0x26b))switch(_0x3e0fe4){case _0x3e7924(0x26a):_0x15d3ca=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x48c03f=[0x1,0x2],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=[_0x3e7924(0x1bf),_0x3e7924(0x245)],_0x2627ba=['D'],_0x3b1a3b=['A'];break;case _0x3e7924(0x21b):_0x15d3ca=[0x6,0x5,0x4,0x3,0x2,0x1],_0x48c03f=[0x1,0x2],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=['Level','Floor'],_0x2627ba=['D'],_0x3b1a3b=['B'];break;case _0x3e7924(0x228):_0x15d3ca=[0x0],_0x48c03f=[0x0],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=[_0x3e7924(0x245)],_0x2627ba=['D'],_0x3b1a3b=['S'];break;case _0x3e7924(0x1ab):_0x15d3ca=[0x0],_0x48c03f=[0x0],_0x13eda9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x479240=['Floor'],_0x2627ba=['D'],_0x3b1a3b=['R'];break;}else{if(_0xf1a6ef=='COLD\x20STORAGE')switch(_0x3e0fe4){case'Rack\x20A':_0x15d3ca=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x48c03f=['B','F'],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=[_0x3e7924(0x1bf),_0x3e7924(0x245)],_0x2627ba=['C'],_0x3b1a3b=['A'];break;case _0x3e7924(0x21b):_0x15d3ca=[0x5,0x4,0x3,0x2,0x1],_0x48c03f=['F','B','S'],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=[_0x3e7924(0x1bf),_0x3e7924(0x245)],_0x2627ba=['C'],_0x3b1a3b=['B'];break;case _0x3e7924(0x222):_0x15d3ca=[0x1,0x2,0x3,0x4,0x5],_0x48c03f=['B','F','S'],_0x13eda9=[0x5,0x4,0x3,0x2,0x1],_0x479240=[_0x3e7924(0x1bf),_0x3e7924(0x245)],_0x2627ba=['C'],_0x3b1a3b=['C'];break;case _0x3e7924(0x1d2):_0x15d3ca=[0x5,0x4,0x3,0x2,0x1],_0x48c03f=['F','B','S'],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=['Level','Floor'],_0x2627ba=['C'],_0x3b1a3b=['D'];break;case _0x3e7924(0x25e):_0x15d3ca=[0x4,0x3,0x2,0x1],_0x48c03f=[0x1,0x2],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=[_0x3e7924(0x1bf),_0x3e7924(0x245)],_0x2627ba=['C'],_0x3b1a3b=['E'];break;case _0x3e7924(0x237):_0x15d3ca=[0x1,0x2,0x3],_0x48c03f=[0x1,0x2],_0x13eda9=[0x1,0x2,0x3,0x4,0x5],_0x479240=[_0x3e7924(0x1bf)],_0x2627ba=['C'],_0x3b1a3b=['F'];break;}}return{'levels':_0x15d3ca,'Isle':_0x48c03f,'rack':_0x13eda9,'type':_0x479240,'storage':_0x2627ba,'rak':_0x3b1a3b};}function a0_0x1f97(){var _0x3a83c3=['$product_details.pallet','<div>','user','</thead>','storage','Transfer\x20Finalize\x20Successfully','to_floorlevel','/picking_list/PDF_transfer_rm/','<span\x20style=\x22float:\x20right;\x22>','site_title','</body></html>','expiry_date','Receiving\x20Area','map','render','master','<hr\x20class=\x22my-3\x22>','To_invoice','status','rack','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','9024834Bpvqns','to_warehouse','message','edit_transfer_view','$product_details.floorlevel','2332fDOakJ','</table>','$product_details.product_code','find','role','$product_details.type','Level','</span>','secondary_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','express','from_prod_level','password','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','unit','email','image','invoice','</td>','\x20</h2>','prod_cat','RoomAssigned','True','1882773speYXm','Rack\x20D','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_quantity','date','$product_details.secondary_unit','$product_details.production_date','product_stock','nodemailer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','post','$product_details.bay','errors','/upload/','$product_details._id','from_storage','get','_id','primary_code','English\x20(US)','Arabic\x20(ae)','../middleware/auth','from_prod_pallet','save','$product_details.storage','/view/:id','$finalize','\x20Order\x20Number\x20:\x20','RMSEmail','Enclosed','success','$invoice','to_prod_isle','from_rak','3nQvdXP','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','getDate','floorlevel','getFullYear','French','string','Portuguese\x20(BR)','/view/add_transfer','Raw\x20Materials','<h5\x20style=\x22text-align:\x20left;\x22>','toString','error','from_room','<tr>','Portuguese','$product_details.isle','Spanish','/../public','to_types','/transfer/view','to_prod_pallet','TRF-','type','from_quantity','$product_details.maxPerUnit','to_room_name','from_prod_isle','$product_details.rack','$product_details.primary_code','findById','$from_warehouse','</h5>','catch','then','5TppDhO','params','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','staff','</head><body>','Rack\x20B','all','from_rack','10sHposB','Transfer\x20Mail','Ambient','$product_details.product_name','Rack\x20C','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$date','from_types','rak','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Shelves','add_transfer','$product_details.expiry_date','<h5>','product_code3','/preview/:id','772SeABez','secondary_unit','MaxStocks_data2','port','host','slice','$product_details.maxProducts','from_invoice','Enabled','Rack\x20F','exports','Hindi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','redirect','bin','json','$isAllowEdit','ToRoomAssigned','Email\x20sent\x20successfully','204KSNtnx','from_bay','</tbody>','to_prod_qty','Floor','6032154BBROhW','batch_code','Transfer\x20Edit\x20Successfully','An\x20error\x20occurred\x20while\x20saving\x20data.','updateOne','maxProducts','$product_details.product_stock','$product_details.level','product_code','An\x20error\x20occurred.','<strong>\x20Regards\x20</strong>','$product_details','$product.from_room_name','edit_transfer','from_prod_qty','concat','$product_details.bin','to_bin','$room','$product','Router','$product_details.secondary_code','from_floorlevel','4679828cRRavn','Rack\x20E','to_invoice','warehouse','$product_details.batch_code','production_date','aggregate','floor','max_per_unit','</div>','Arabic','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','bay','Rack\x20A','DRY\x20STORAGE','push','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_details','$name','English','1561NKKagU','findOne','log','/transfer/preview/','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','product_name','product','prod_name','<!DOCTYPE\x20html>','forEach','from_bin','30488CffoAq','706453lQyRVV','$product.to_room_name','German','flash','padStart','body','Product\x20Transfer\x20successfully','from_room_name','transfer','<html><head><title></title>','/barcode_scanner','<h2>\x20','New_Qty_Converted','split','language','length','$product_details.unit','to_room','</tr>','/barcode_scanner2','to_bay','Chinese','to_prod_level','from_warehouse'];a0_0x1f97=function(){return _0x3a83c3;};return a0_0x1f97();}router['get'](a0_0x1319f9(0x1ea),auth,async(_0x2d104c,_0x27b01e)=>{var _0x4eb7f9=a0_0x1319f9;try{const {username:_0x45a082,email:_0x5971a9,role:_0x212af2}=_0x2d104c['user'],_0x1f802e=_0x2d104c['user'],_0x31ede2=await profile[_0x4eb7f9(0x272)]({'email':_0x1f802e[_0x4eb7f9(0x1c9)]}),_0x2de122=await master_shop['find'](),_0x3de239=await transfers[_0x4eb7f9(0x211)](_0x2d104c[_0x4eb7f9(0x217)]['id']);let _0x353ed6;if(_0x1f802e['role']==_0x4eb7f9(0x219)){const _0x159dae=await staff[_0x4eb7f9(0x272)]({'email':_0x1f802e[_0x4eb7f9(0x1c9)]});_0x353ed6=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x159dae[_0x4eb7f9(0x260)],'warehouse_category':_0x4eb7f9(0x1fc)}},{'$group':{'_id':_0x4eb7f9(0x26f),'name':{'$first':_0x4eb7f9(0x26f)}}}]);}else _0x353ed6=await warehouse[_0x4eb7f9(0x263)]([{'$match':{'status':'Enabled','warehouse_category':_0x4eb7f9(0x1fc)}},{'$group':{'_id':'$name','name':{'$first':_0x4eb7f9(0x26f)}}}]);const _0x37981f=await warehouse[_0x4eb7f9(0x263)]([{'$match':{'name':_0x3de239[_0x4eb7f9(0x294)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x4eb7f9(0x251)},{'$group':{'_id':_0x4eb7f9(0x1df),'name':{'$first':_0x4eb7f9(0x221)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4eb7f9(0x1dc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4eb7f9(0x1b8)},'primary_code':{'$first':_0x4eb7f9(0x210)},'secondary_code':{'$first':_0x4eb7f9(0x25b)},'product_code':{'$first':_0x4eb7f9(0x1bb)},'storage':{'$first':_0x4eb7f9(0x1e9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4eb7f9(0x22a)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4eb7f9(0x258)}}}]),_0x1abd64=await product[_0x4eb7f9(0x1bc)]({}),_0x2db104=BayBinSelected(_0x3de239[_0x4eb7f9(0x1b5)],_0x3de239['to_room']);if(_0x2de122[0x0][_0x4eb7f9(0x28b)]==_0x4eb7f9(0x1e4)){var _0x23bf64=users[_0x4eb7f9(0x270)];console['log'](_0x23bf64);}else{if(_0x2de122[0x0][_0x4eb7f9(0x28b)]=='Hindi')var _0x23bf64=users[_0x4eb7f9(0x239)];else{if(_0x2de122[0x0][_0x4eb7f9(0x28b)]==_0x4eb7f9(0x27f))var _0x23bf64=users['German'];else{if(_0x2de122[0x0]['language']==_0x4eb7f9(0x204))var _0x23bf64=users[_0x4eb7f9(0x204)];else{if(_0x2de122[0x0]['language']==_0x4eb7f9(0x1f8))var _0x23bf64=users[_0x4eb7f9(0x1f8)];else{if(_0x2de122[0x0][_0x4eb7f9(0x28b)]=='Portuguese\x20(BR)')var _0x23bf64=users['Portuguese'];else{if(_0x2de122[0x0][_0x4eb7f9(0x28b)]==_0x4eb7f9(0x292))var _0x23bf64=users['Chinese'];else{if(_0x2de122[0x0]['language']==_0x4eb7f9(0x1e5))var _0x23bf64=users[_0x4eb7f9(0x267)];}}}}}}}_0x27b01e[_0x4eb7f9(0x1ad)](_0x4eb7f9(0x253),{'success':_0x2d104c[_0x4eb7f9(0x280)](_0x4eb7f9(0x1ef)),'errors':_0x2d104c[_0x4eb7f9(0x280)]('errors'),'role':_0x1f802e,'profile':_0x31ede2,'master_shop':_0x2de122,'warehouse':_0x353ed6,'transfer':_0x3de239,'stock':_0x37981f,'unit':_0x1abd64,'language':_0x23bf64});}catch(_0x2758f3){console[_0x4eb7f9(0x273)](_0x2758f3);}}),router['post'](a0_0x1319f9(0x1ea),auth,async(_0xf4f46e,_0x47f8ff)=>{var _0x45c735=a0_0x1319f9;try{const _0x492536=_0xf4f46e[_0x45c735(0x217)]['id'],_0x5713e0=await transfers[_0x45c735(0x211)](_0x492536);_0x47f8ff['json'](_0xf4f46e['body']);return;const {date:_0x2f12ee,from_warehouse:_0x502e8a,FromRoom_name:_0x2a359a,to_warehouse:_0xf47c8d,ToRoom_name:_0x327a34,prod_name:_0x3bfdfc,from_prod_qty:_0x47e3ec,from_prod_level:_0x29e52e,from_prod_isle:_0x3d5d7a,from_prod_pallet:_0x4589f6,to_prod_qty:_0x1b74ba,to_prod_level:_0x44ef1a,to_prod_isle:_0x45ed50,to_prod_pallet:_0x5ac39c,primary_code:_0x39ada4,secondary_code:_0x59ba85,product_code3:_0x293220,note:_0x1276c2,invoice:_0xebec16,expiry_date:_0x3f839c}=_0xf4f46e[_0x45c735(0x282)];if(typeof _0x3bfdfc==_0x45c735(0x1f9))var _0x160353=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x278)]],_0x3c12bd=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x254)]],_0x506a2b=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1c5)]],_0x3f98aa=[_0xf4f46e['body'][_0x45c735(0x20e)]],_0x59a30c=[_0xf4f46e['body'][_0x45c735(0x1e7)]],_0x2a2dda=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x225)]],_0x2df488=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x244)]],_0x2fc31b=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x293)]],_0x1c5a73=[_0xf4f46e['body'][_0x45c735(0x1f1)]],_0x41d6bd=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x208)]],_0x2bea06=[_0xf4f46e[_0x45c735(0x282)]['to_types']],_0x903c47=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1a3)]],_0x21a686=[_0xf4f46e[_0x45c735(0x282)]['rak']],_0x4b4491=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1e3)]],_0x289cc2=[_0xf4f46e[_0x45c735(0x282)]['secondary_code']],_0x2aa115=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x22c)]],_0x57dffc=[_0xf4f46e[_0x45c735(0x282)]['MaxStocks_data2']],_0x485de1=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1c8)]],_0x5b2626=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x22f)]],_0x30c5f2=[_0xf4f46e[_0x45c735(0x282)]['batch_code']],_0xe08ba4=[_0xf4f46e[_0x45c735(0x282)]['expiry_date']],_0x3b1935=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1e0)]],_0x4733f1=[_0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1f2)]];else var _0x160353=[..._0xf4f46e[_0x45c735(0x282)]['prod_name']],_0x903c47=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1a3)]],_0x21a686=[..._0xf4f46e['body'][_0x45c735(0x226)]],_0x2a2dda=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x225)]],_0x2bea06=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x206)]],_0x3c12bd=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x254)]],_0x506a2b=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1c5)]],_0x3f98aa=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x20e)]],_0x59a30c=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1e7)]],_0x2df488=[..._0xf4f46e['body'][_0x45c735(0x244)]],_0x2fc31b=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x293)]],_0x1c5a73=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1f1)]],_0x41d6bd=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x208)]],_0x4b4491=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1e3)]],_0x289cc2=[..._0xf4f46e['body'][_0x45c735(0x1c1)]],_0x2aa115=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x22c)]],_0x57dffc=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x230)]],_0x485de1=[..._0xf4f46e['body'][_0x45c735(0x1c8)]],_0x5b2626=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x22f)]],_0x30c5f2=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x247)]],_0xe08ba4=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1aa)]],_0x3b1935=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1e0)]],_0x4733f1=[..._0xf4f46e[_0x45c735(0x282)][_0x45c735(0x1f2)]];const _0x1d4177=_0x160353['map'](_0x40b62b=>{return _0x40b62b={'product_name':_0x40b62b};});_0x3c12bd[_0x45c735(0x27a)]((_0x2b8de0,_0x482417)=>{var _0x41c281=_0x45c735;_0x1d4177[_0x482417][_0x41c281(0x20b)]=_0x2b8de0;}),_0x506a2b[_0x45c735(0x27a)]((_0x23d4b5,_0x1fd4af)=>{var _0x4b5676=_0x45c735;_0x1d4177[_0x1fd4af][_0x4b5676(0x242)]=_0x23d4b5;}),_0x3f98aa[_0x45c735(0x27a)]((_0x1f85e4,_0x586dfd)=>{var _0x5a06e8=_0x45c735;_0x1d4177[_0x586dfd][_0x5a06e8(0x27b)]=_0x1f85e4;}),_0x59a30c[_0x45c735(0x27a)]((_0x2fa807,_0x3f4122)=>{_0x1d4177[_0x3f4122]['from_floorlevel']=_0x2fa807;}),_0x2df488[_0x45c735(0x27a)]((_0x30c515,_0x5edcb3)=>{var _0x20314c=_0x45c735;_0x1d4177[_0x5edcb3][_0x20314c(0x1d4)]=_0x30c515;}),_0x2fc31b[_0x45c735(0x27a)]((_0x35c53e,_0x1530af)=>{var _0x2f9fe6=_0x45c735;_0x1d4177[_0x1530af][_0x2f9fe6(0x291)]=_0x35c53e;}),_0x1c5a73['forEach']((_0x5cc80b,_0x5e01fa)=>{var _0x80b60b=_0x45c735;_0x1d4177[_0x5e01fa][_0x80b60b(0x257)]=_0x5cc80b;}),_0x41d6bd[_0x45c735(0x27a)]((_0xb16b72,_0x2f17d6)=>{var _0x2e7296=_0x45c735;_0x1d4177[_0x2f17d6][_0x2e7296(0x1a5)]=_0xb16b72;}),_0x4b4491[_0x45c735(0x27a)]((_0x55e633,_0x535c64)=>{_0x1d4177[_0x535c64]['primary_code']=_0x55e633;}),_0x289cc2['forEach']((_0x501b33,_0x1f824d)=>{var _0x1b9ff3=_0x45c735;_0x1d4177[_0x1f824d][_0x1b9ff3(0x1c1)]=_0x501b33;}),_0x2aa115[_0x45c735(0x27a)]((_0x8dacb5,_0x39a04e)=>{var _0x3d18b7=_0x45c735;_0x1d4177[_0x39a04e][_0x3d18b7(0x24e)]=_0x8dacb5;}),_0x57dffc[_0x45c735(0x27a)]((_0x2bd136,_0x472cee)=>{var _0x4fecd8=_0x45c735;_0x1d4177[_0x472cee][_0x4fecd8(0x24b)]=_0x2bd136;}),_0x485de1['forEach']((_0x552eeb,_0x4b2cc4)=>{var _0x51d5c5=_0x45c735;_0x1d4177[_0x4b2cc4][_0x51d5c5(0x1c8)]=_0x552eeb;}),_0x5b2626[_0x45c735(0x27a)]((_0x288f76,_0xa64d93)=>{_0x1d4177[_0xa64d93]['secondary_unit']=_0x288f76;}),_0x30c5f2[_0x45c735(0x27a)]((_0x3808f9,_0x27be5e)=>{var _0x248de7=_0x45c735;_0x1d4177[_0x27be5e][_0x248de7(0x247)]=_0x3808f9;}),_0xe08ba4['forEach']((_0x512ccb,_0x1633a5)=>{var _0x1f242b=_0x45c735;_0x1d4177[_0x1633a5][_0x1f242b(0x1aa)]=_0x512ccb;}),_0x903c47[_0x45c735(0x27a)]((_0x1da6be,_0xbf5fe3)=>{var _0x19d8cf=_0x45c735;_0x1d4177[_0xbf5fe3][_0x19d8cf(0x1a3)]=_0x1da6be;}),_0x21a686[_0x45c735(0x27a)]((_0x15cf44,_0x1c45e9)=>{var _0x40eb0c=_0x45c735;_0x1d4177[_0x1c45e9][_0x40eb0c(0x1b2)]=_0x15cf44;}),_0x2a2dda[_0x45c735(0x27a)]((_0x9c5e89,_0x1a537d)=>{var _0x10fd8b=_0x45c735;_0x1d4177[_0x1a537d][_0x10fd8b(0x225)]=_0x9c5e89;}),_0x2bea06['forEach']((_0x59e2c8,_0x4920db)=>{var _0x7f5421=_0x45c735;_0x1d4177[_0x4920db][_0x7f5421(0x206)]=_0x59e2c8;}),_0x3b1935[_0x45c735(0x27a)]((_0x293589,_0x44734e)=>{var _0x753033=_0x45c735;_0x1d4177[_0x44734e][_0x753033(0x1e0)]=_0x293589;}),_0x4733f1[_0x45c735(0x27a)]((_0x166df8,_0xae875)=>{var _0x1658ea=_0x45c735;_0x1d4177[_0xae875][_0x1658ea(0x21d)]=_0x166df8;});const _0x2c6728=_0x1d4177['filter'](_0x255b50=>_0x255b50[_0x45c735(0x1d4)]!=='0'&&_0x255b50[_0x45c735(0x1d4)]!==''||_0x255b50[_0x45c735(0x1a5)]!=='0'&&_0x255b50[_0x45c735(0x1a5)]!=='');var _0x25cc94=0x0;_0x2c6728['forEach'](_0x329c46=>{var _0x27dea2=_0x45c735;parseInt(_0x329c46[_0x27dea2(0x20b)])<parseInt(_0x329c46['to_quantity'])&&_0x25cc94++;});if(_0x25cc94!=0x0)return _0xf4f46e['flash']('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x47f8ff[_0x45c735(0x23b)]('back');const _0x10e657=await warehouse[_0x45c735(0x272)]({'name':_0x5713e0[_0x45c735(0x294)],'room':_0x5713e0[_0x45c735(0x200)]});_0x5713e0['product'][_0x45c735(0x27a)](_0x2c16fe=>{var _0x110819=_0x45c735;if(_0x2c16fe[_0x110819(0x1d4)]>0x0){const _0x4759f6=_0x10e657[_0x110819(0x26e)][_0x110819(0x1ac)](_0x5a4c90=>{var _0x2b1dce=_0x110819;_0x5a4c90[_0x2b1dce(0x276)]==_0x2c16fe[_0x2b1dce(0x276)]&&_0x5a4c90[_0x2b1dce(0x1f6)]==_0x2c16fe['from_floorlevel']&&_0x5a4c90['type']==_0x2c16fe[_0x2b1dce(0x225)]&&_0x5a4c90[_0x2b1dce(0x23c)]==_0x2c16fe[_0x2b1dce(0x27b)]&&_0x5a4c90[_0x2b1dce(0x269)]==_0x2c16fe[_0x2b1dce(0x242)]&&_0x5a4c90[_0x2b1dce(0x1b2)]==_0x2c16fe[_0x2b1dce(0x21d)]&&_0x5a4c90[_0x2b1dce(0x1a3)]==_0x2c16fe[_0x2b1dce(0x1e0)]&&(_0x5a4c90[_0x2b1dce(0x1d8)]=parseInt(_0x5a4c90['product_stock'])+parseInt(_0x2c16fe[_0x2b1dce(0x1d4)]));});}}),await _0x10e657[_0x45c735(0x1e8)]();const _0x21c82b=await warehouse['findOne']({'name':_0x5713e0[_0x45c735(0x1b5)],'room':_0x5713e0[_0x45c735(0x28e)]});_0x5713e0[_0x45c735(0x277)][_0x45c735(0x27a)](_0x1676b3=>{var _0x2afa8c=_0x45c735;if(_0x1676b3['to_quantity']>0x0){const _0x387a1b=_0x21c82b['product_details'][_0x2afa8c(0x1ac)](_0x119005=>{var _0x55015e=_0x2afa8c;_0x119005[_0x55015e(0x276)]==_0x1676b3[_0x55015e(0x276)]&&_0x119005[_0x55015e(0x1f6)]==_0x1676b3[_0x55015e(0x1a5)]&&_0x119005[_0x55015e(0x20a)]==_0x1676b3[_0x55015e(0x206)]&&_0x119005[_0x55015e(0x23c)]==_0x1676b3['to_bin']&&_0x119005['bay']==_0x1676b3['to_bay']&&_0x119005['rack']==_0x1676b3[_0x55015e(0x1b2)]&&_0x119005[_0x55015e(0x1a3)]==_0x1676b3[_0x55015e(0x1a3)]&&(_0x119005[_0x55015e(0x1d8)]=parseInt(_0x119005['product_stock'])-parseInt(_0x1676b3['to_quantity']));});}}),await _0x21c82b[_0x45c735(0x1e8)](),_0x5713e0[_0x45c735(0x1d5)]=_0x2f12ee,_0x5713e0[_0x45c735(0x294)]=_0x502e8a,_0x5713e0[_0x45c735(0x1b5)]=_0xf47c8d,_0x5713e0[_0x45c735(0x277)]=_0x2c6728,_0x5713e0['note']=_0x1276c2,_0x5713e0[_0x45c735(0x1cb)]=_0xebec16;const _0x415987=await _0x5713e0[_0x45c735(0x1e8)]();console[_0x45c735(0x273)](_0x415987);const _0x1d0a92=await warehouse['findOne']({'name':_0x502e8a,'room':_0x2a359a});_0x415987['product'][_0x45c735(0x27a)](_0x38e9fd=>{var _0x328815=_0x45c735;if(_0x38e9fd[_0x328815(0x1d4)]>0x0){const _0x2588b4=_0x1d0a92[_0x328815(0x26e)][_0x328815(0x1ac)](_0x6dd172=>{var _0x579f09=_0x328815;_0x6dd172[_0x579f09(0x276)]==_0x38e9fd[_0x579f09(0x276)]&&_0x6dd172['floorlevel']==_0x38e9fd['from_floorlevel']&&_0x6dd172[_0x579f09(0x20a)]==_0x38e9fd[_0x579f09(0x225)]&&_0x6dd172[_0x579f09(0x23c)]==_0x38e9fd['from_bin']&&_0x6dd172[_0x579f09(0x269)]==_0x38e9fd[_0x579f09(0x242)]&&_0x6dd172[_0x579f09(0x1b2)]==_0x38e9fd[_0x579f09(0x21d)]&&_0x6dd172['storage']==_0x38e9fd[_0x579f09(0x1e0)]&&(_0x6dd172[_0x579f09(0x1d8)]=parseInt(_0x6dd172['product_stock'])-parseInt(_0x38e9fd['to_quantity']));});}}),await _0x1d0a92[_0x45c735(0x1e8)]();const _0x5bff32=await warehouse['findOne']({'name':_0xf47c8d,'room':_0x327a34});_0x415987['product'][_0x45c735(0x27a)](_0x475282=>{var _0x59b4cc=_0x45c735;if(_0x475282['to_quantity']>0x0){var _0x13891d=0x0;const _0x2f59b4=_0x5bff32[_0x59b4cc(0x26e)][_0x59b4cc(0x1ac)](_0xd7ba2c=>{var _0x22245a=_0x59b4cc;_0xd7ba2c[_0x22245a(0x276)]==_0x475282[_0x22245a(0x276)]&&_0xd7ba2c[_0x22245a(0x1f6)]==_0x475282['to_floorlevel']&&_0xd7ba2c[_0x22245a(0x20a)]==_0x475282[_0x22245a(0x206)]&&_0xd7ba2c[_0x22245a(0x23c)]==_0x475282[_0x22245a(0x257)]&&_0xd7ba2c[_0x22245a(0x269)]==_0x475282[_0x22245a(0x291)]&&_0xd7ba2c[_0x22245a(0x1b2)]==_0x475282['rack']&&_0xd7ba2c[_0x22245a(0x1a3)]==_0x475282[_0x22245a(0x1a3)]&&(_0xd7ba2c[_0x22245a(0x1d8)]=parseInt(_0xd7ba2c['product_stock'])+parseInt(_0x475282[_0x22245a(0x1d4)]),_0x13891d++);});_0x13891d=='0'&&(_0x5bff32[_0x59b4cc(0x26e)]=_0x5bff32[_0x59b4cc(0x26e)][_0x59b4cc(0x255)]({'product_name':_0x475282[_0x59b4cc(0x276)],'product_stock':_0x475282[_0x59b4cc(0x1d4)],'bay':_0x475282[_0x59b4cc(0x291)],'bin':_0x475282['to_bin'],'type':_0x475282[_0x59b4cc(0x206)],'floorlevel':_0x475282[_0x59b4cc(0x1a5)],'storage':_0x475282['storage'],'rack':_0x475282[_0x59b4cc(0x1b2)],'product_code':_0x475282['product_code'],'primary_code':_0x475282['primary_code'],'secondary_code':_0x475282[_0x59b4cc(0x1c1)],'maxProducts':_0x475282[_0x59b4cc(0x24b)],'storage':_0x475282[_0x59b4cc(0x1a3)],'rack':_0x475282[_0x59b4cc(0x1b2)]}));}}),await _0x5bff32['save'](),_0xf4f46e['flash'](_0x45c735(0x1ef),_0x45c735(0x248)),_0x47f8ff[_0x45c735(0x23b)](_0x45c735(0x207));}catch(_0x4a199d){console[_0x45c735(0x273)](_0x4a199d);}}),router['post'](a0_0x1319f9(0x287),async(_0x322824,_0xdde281)=>{var _0x35ab80=a0_0x1319f9;const {FromWareHouse:_0x4da534,FromRoom:_0x2bc157,ToWarehouse:_0x175cd9,ToRoom:_0x8c38a2,primary_code:_0x1bf220,Roomslist:_0x2b22a1}=_0x322824[_0x35ab80(0x282)],_0xa7b390=_0x2b22a1[_0x35ab80(0x28a)](','),_0x277db7=[];async function _0x394fd5(_0x3c19c9){var _0x446d94=_0x35ab80;const _0x2a81cb=await warehouse[_0x446d94(0x263)]([{'$match':{'name':_0x4da534,'room':_0x3c19c9}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x1bf220}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x446d94(0x221)},'instock':{'$first':_0x446d94(0x24c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x446d94(0x1bb)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x446d94(0x256)},'type':{'$first':_0x446d94(0x1be)},'pallet':{'$first':_0x446d94(0x1b8)},'unit':{'$first':_0x446d94(0x28d)},'secondary_unit':{'$first':_0x446d94(0x1d6)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x446d94(0x20f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x446d94(0x1d7)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x446d94(0x20c)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x446d94(0x258)},'maxProducts':{'$first':_0x446d94(0x234)}}}]),_0x8cad9f=await warehouse[_0x446d94(0x263)]([{'$match':{'name':_0x4da534,'room':_0x3c19c9}},{'$unwind':_0x446d94(0x251)},{'$match':{'product_details.secondary_code':_0x1bf220}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x446d94(0x221)},'instock':{'$first':_0x446d94(0x24c)},'primary_code':{'$first':_0x446d94(0x210)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x446d94(0x1dc)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x446d94(0x1be)},'pallet':{'$first':_0x446d94(0x1b8)},'unit':{'$first':_0x446d94(0x28d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x446d94(0x1e9)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x446d94(0x1d7)},'batch_code':{'$first':_0x446d94(0x261)},'maxPerUnit':{'$first':_0x446d94(0x20c)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x446d94(0x258)},'maxProducts':{'$first':_0x446d94(0x234)}}}]);if(_0x2a81cb[_0x446d94(0x28c)]>0x0)_0x277db7[_0x446d94(0x26c)](_0x2a81cb);else _0x8cad9f[_0x446d94(0x28c)]>0x0&&_0x277db7['push'](_0x8cad9f);}const _0x13089b=_0xa7b390[_0x35ab80(0x1ac)](_0x39da4d=>_0x394fd5(_0x39da4d));await Promise[_0x35ab80(0x21c)](_0x13089b),_0xdde281[_0x35ab80(0x23d)](_0x277db7);}),router['post'](a0_0x1319f9(0x290),async(_0x180d64,_0x3fac6a)=>{var _0x422317=a0_0x1319f9;try{const {FromWareHouse:_0x230b51,FromRoom:_0x4fd50c,ToWarehouse:_0x3abd09,ToRoom:_0x1c7bf7,secondary_code:_0x4a04b3}=_0x180d64[_0x422317(0x282)],_0x19e388=await warehouse['aggregate']([{'$match':{'name':_0x230b51}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4a04b3}},{'$group':{'_id':_0x422317(0x1df),'name':{'$first':_0x422317(0x221)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x422317(0x25b)},'product_code':{'$first':_0x422317(0x1bb)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x422317(0x26f)},'level':{'$first':_0x422317(0x24d)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x422317(0x19f)},'maxProducts':{'$first':_0x422317(0x234)},'unit':{'$first':_0x422317(0x28d)}}}]);_0x3fac6a[_0x422317(0x1b1)](0xc8)[_0x422317(0x23d)](_0x19e388);}catch(_0x265754){_0x3fac6a[_0x422317(0x1b1)](0x194)[_0x422317(0x23d)]({'message':_0x265754[_0x422317(0x1b6)]});}}),router[a0_0x1319f9(0x1db)]('/barcode_scanner3',async(_0x2ea10f,_0x4b580c)=>{var _0xa4b343=a0_0x1319f9;try{const {FromWareHouse:_0x10415d,FromRoom:_0x48596c,ToWarehouse:_0x5e81d9,ToRoom:_0x3c05c1,product_code:_0x333d98}=_0x2ea10f['body'],_0x2f6933=await warehouse[_0xa4b343(0x263)]([{'$match':{'name':_0x10415d}},{'$unwind':_0xa4b343(0x251)},{'$match':{'product_details.product_code':_0x333d98}},{'$group':{'_id':_0xa4b343(0x1df),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xa4b343(0x25b)},'product_code':{'$first':_0xa4b343(0x1bb)},'instock':{'$first':_0xa4b343(0x24c)},'warehouse':{'$first':_0xa4b343(0x26f)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0xa4b343(0x203)},'pallet':{'$first':_0xa4b343(0x19f)},'maxProducts':{'$first':_0xa4b343(0x234)},'unit':{'$first':_0xa4b343(0x28d)}}}]);_0x4b580c[_0xa4b343(0x1b1)](0xc8)['json'](_0x2f6933);}catch(_0x255cab){_0x4b580c['status'](0x194)['json']({'message':_0x255cab[_0xa4b343(0x1b6)]});}}),router[a0_0x1319f9(0x1db)]('/CheckingWarehouse',async(_0xa20f7b,_0x19ada5)=>{var _0x2d6c99=a0_0x1319f9;const {level:_0x5f3ab9,isle:_0x6184e,pallet:_0x48f13f,warehouses:_0x4e803d,room:_0x3b605b}=_0xa20f7b[_0x2d6c99(0x282)];try{const _0x22877a=await warehouse[_0x2d6c99(0x263)]([{'$match':{'name':_0x4e803d,'room':_0x3b605b}},{'$unwind':_0x2d6c99(0x251)},{'$match':{'product_details.level':parseInt(_0x5f3ab9),'product_details.isle':_0x6184e,'product_details.pallet':parseInt(_0x48f13f)}},{'$group':{'_id':_0x2d6c99(0x1df),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2d6c99(0x24c)},'level':{'$first':_0x2d6c99(0x24d)},'isle':{'$first':_0x2d6c99(0x203)},'pallet':{'$first':_0x2d6c99(0x19f)},'maxProducts':{'$first':_0x2d6c99(0x234)}}}]);_0x19ada5[_0x2d6c99(0x1b1)](0xc8)['json'](_0x22877a);}catch(_0x583bbc){_0x19ada5[_0x2d6c99(0x1b1)](0x194)[_0x2d6c99(0x23d)]({'message':_0x583bbc[_0x2d6c99(0x1b6)]});}}),module[a0_0x1319f9(0x238)]=router;