var a0_0x130251=a0_0x208c;function a0_0x208c(_0x1a8ddf,_0x13b943){var _0x36807d=a0_0x3680();return a0_0x208c=function(_0x208cab,_0x442820){_0x208cab=_0x208cab-0x13a;var _0x1ec87e=_0x36807d[_0x208cab];return _0x1ec87e;},a0_0x208c(_0x1a8ddf,_0x13b943);}(function(_0x299c48,_0x4935e1){var _0x3d9155=a0_0x208c,_0x457a68=_0x299c48();while(!![]){try{var _0x1e0558=-parseInt(_0x3d9155(0x22c))/0x1*(parseInt(_0x3d9155(0x172))/0x2)+parseInt(_0x3d9155(0x1fa))/0x3+parseInt(_0x3d9155(0x1cc))/0x4+-parseInt(_0x3d9155(0x188))/0x5+-parseInt(_0x3d9155(0x14f))/0x6+-parseInt(_0x3d9155(0x19a))/0x7*(parseInt(_0x3d9155(0x16f))/0x8)+-parseInt(_0x3d9155(0x204))/0x9*(-parseInt(_0x3d9155(0x1db))/0xa);if(_0x1e0558===_0x4935e1)break;else _0x457a68['push'](_0x457a68['shift']());}catch(_0x1b84dc){_0x457a68['push'](_0x457a68['shift']());}}}(a0_0x3680,0x63f4a));const express=require('express'),app=express(),router=express[a0_0x130251(0x1be)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x130251(0x1d4)),auth=require(a0_0x130251(0x19c)),users=require(a0_0x130251(0x1c3)),nodemailer=require('nodemailer');router[a0_0x130251(0x143)](a0_0x130251(0x1d9),auth,async(_0x456359,_0x197503)=>{var _0x3f97fe=a0_0x130251;try{const {username:_0x3e6ddc,email:_0x106b58,role:_0x4abfab}=_0x456359[_0x3f97fe(0x1cd)],_0x12b10c=_0x456359['user'],_0x49aecd=await profile[_0x3f97fe(0x22f)]({'email':_0x12b10c[_0x3f97fe(0x1cf)]}),_0x251718=await master_shop[_0x3f97fe(0x184)]();console[_0x3f97fe(0x16d)](_0x3f97fe(0x216),_0x251718);let _0x5250f4;if(_0x12b10c['role']==_0x3f97fe(0x1c9)){const _0x178fd6=await staff[_0x3f97fe(0x22f)]({'email':_0x12b10c[_0x3f97fe(0x1cf)]});_0x5250f4=await transfers[_0x3f97fe(0x184)]({'from_warehouse':_0x178fd6[_0x3f97fe(0x1a3)]});}else _0x5250f4=await transfers['aggregate']([{'$unwind':_0x3f97fe(0x1ba)},{'$group':{'_id':'$_id','invoice':{'$first':_0x3f97fe(0x176)},'date':{'$first':_0x3f97fe(0x21f)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x3f97fe(0x199)},'to_room_name':{'$addToSet':_0x3f97fe(0x14b)},'finalize':{'$first':_0x3f97fe(0x169)},'isAllowEdit':{'$first':_0x3f97fe(0x1e0)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x251718[0x0][_0x3f97fe(0x220)]==_0x3f97fe(0x156)){var _0x1780e6=users['English'];console[_0x3f97fe(0x16d)](_0x1780e6);}else{if(_0x251718[0x0]['language']==_0x3f97fe(0x158))var _0x1780e6=users['Hindi'];else{if(_0x251718[0x0][_0x3f97fe(0x220)]=='German')var _0x1780e6=users[_0x3f97fe(0x208)];else{if(_0x251718[0x0][_0x3f97fe(0x220)]==_0x3f97fe(0x1a6))var _0x1780e6=users[_0x3f97fe(0x1a6)];else{if(_0x251718[0x0][_0x3f97fe(0x220)]==_0x3f97fe(0x1ea))var _0x1780e6=users[_0x3f97fe(0x1ea)];else{if(_0x251718[0x0][_0x3f97fe(0x220)]=='Portuguese\x20(BR)')var _0x1780e6=users[_0x3f97fe(0x1c1)];else{if(_0x251718[0x0][_0x3f97fe(0x220)]==_0x3f97fe(0x1f6))var _0x1780e6=users[_0x3f97fe(0x1f6)];else{if(_0x251718[0x0][_0x3f97fe(0x220)]=='Arabic\x20(ae)')var _0x1780e6=users[_0x3f97fe(0x21c)];}}}}}}}_0x197503[_0x3f97fe(0x20c)]('transfer',{'success':_0x456359[_0x3f97fe(0x1fd)](_0x3f97fe(0x15f)),'errors':_0x456359['flash'](_0x3f97fe(0x180)),'role':_0x12b10c,'profile':_0x49aecd,'master_shop':_0x251718,'transfer':_0x5250f4,'language':_0x1780e6});}catch(_0x305fa4){console[_0x3f97fe(0x16d)](_0x305fa4);}});async function getRandom8DigitNumber(){var _0xc31739=a0_0x130251;const _0xd3c24e=0x989680,_0x176e81=0x5f5e0ff,_0x7e23f2=Math[_0xc31739(0x206)](Math[_0xc31739(0x17f)]()*(_0x176e81-_0xd3c24e+0x1))+_0xd3c24e;var _0x115ae9;const _0x9a5b1=await transfers[_0xc31739(0x22f)]({'invoice':'TRF-'+_0x7e23f2});return _0x9a5b1&&_0x9a5b1[_0xc31739(0x1d2)]>0x0?_0x115ae9=_0xc31739(0x165)+_0x7e23f2:_0x115ae9='TRF-'+_0x7e23f2,_0x115ae9;}function a0_0x3680(){var _0x370736=['batch_code','body','aggregate','success','to_invoice','$product_details.floorlevel','/upload/','from_types','</span>','TRF-','product_details','findById','prod_name','$finalize','product_stock','</tr>','from_room_name','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','16qCEAWU','to_bay','add_transfer','2eOiGEH','$product_details.isle','product_code','$product_details.product_name','$invoice','storage','</div>','from_invoice','exports','role','getMonth','to_types','/CheckingWarehouse','random','errors','Rack\x20A','sendMail','$product_details.pallet','find','Email\x20sent\x20successfully','Return\x20Rooms','product_name','2705830ekrIov','</tbody>','edit_transfer','ToRoomAssigned','image','Floor','getFullYear','Raw\x20Materials','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','push','prod_cat','$product_details.storage','type','English','</h5>','Transfer\x20Finalize\x20Successfully','$product.from_room_name','2029314IWHbVL','DRY\x20STORAGE','../middleware/auth','/view/:id','$product_details.secondary_code','</body></html>','to_prod_qty','unit','post','warehouse','An\x20error\x20occurred.','to_bin','Spanish','maxProducts','<hr\x20class=\x22my-3\x22>','<!DOCTYPE\x20html>','to_room','toString','concat','$room','back','id_transaction','</head><body>','$product_details.type','/barcode_scanner2','$product_details.maxPerUnit','Portuguese\x20(BR)','Rack\x20E','bin','$product_details.expiry_date','/barcode_scanner3','note','$product','$product_details.unit','from_warehouse','$product_details.bay','Router','$product_details.product_code','$product_details','Portuguese','from_room','../public/language/languages.json','padStart','updateOne','string','createTransport','New_Qty_Converted','staff','Arabic\x20(ae)','to_prod_pallet','1688576IOKfrb','user','maxperunit','email','primary_code','/picking_list/PDF_transfer_rm/','length','json','../models/all_models','max_per_unit','from_bin','catch','$name','/view','forEach','3400630kEiUxU','$product_details._id','$product_details.primary_code','secondary_unit','MaxStocks_data2','$isAllowEdit','slice','status','Shelves','_id','host','</td>','/barcode_scanner','to_warehouse','product_code3','French','message','from_rack','Transfer\x20Edit\x20Successfully','There\x27s\x20a\x20error\x20in\x20this\x20transaction','date','/preview/:id','Receiving\x20Area','</thead>','<h2>\x20','from_prod_qty','expiry_date','Chinese','filter','site_title','params','1438050zFuzRc','</table>','Enclosed','flash','Logo.png','<h5\x20style=\x22text-align:\x20left;\x22>','RoomAssigned','all','\x20<>\x20','<tr>','36WUflzu','to_prod_level','floor','from_prod_pallet','German','bay','invoice','from_rak','render','secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Ambient','from_bay','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','from_floorlevel','production_date','then','master','product','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','from_prod_level','$product_details.bin','split','Arabic','/transfer/view','\x20Order\x20Number\x20:\x20','$date','language','<strong>\x20Regards\x20</strong>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','\x20Order\x20Date\x20:\x20','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','RMSEmail','save','to_prod_isle','$product_details.production_date','Rack\x20F','/view/add_transfer','7054BvkhNH','Enabled','edit_transfer_view','findOne','primary_unit','to_quantity','rack','Level','redirect','Transfer\x20Mail','/transfer/preview/','map','error','<h5>','here','<div>','from_storage','get','$product_details.maxProducts','from_quantity','logo','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.secondary_unit','\x20</h2>','$product_details.rack','$product.to_room_name','$product_details.invoice','Rack\x20B','$product_details.level','4345824dibWaE','To_invoice','getDate','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','finalize','English\x20(US)','floorlevel','Hindi','to_floorlevel','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<table\x20style=\x22width:\x20100%\x20!important;\x22>'];a0_0x3680=function(){return _0x370736;};return a0_0x3680();}router[a0_0x130251(0x143)](a0_0x130251(0x22b),auth,async(_0x3a9546,_0x1da039)=>{var _0x51419a=a0_0x130251;try{const {username:_0x322ffe,email:_0x20c1e6,role:_0x35f07e}=_0x3a9546[_0x51419a(0x1cd)],_0x470d0a=_0x3a9546['user'],_0x56e0df=await profile[_0x51419a(0x22f)]({'email':_0x470d0a['email']}),_0x6c19c6=await master_shop[_0x51419a(0x184)]();console[_0x51419a(0x16d)](_0x51419a(0x216),_0x6c19c6);let _0xf7b281;if(_0x470d0a['role']==_0x51419a(0x1c9)){const _0x4ec9d7=await staff[_0x51419a(0x22f)]({'email':_0x470d0a[_0x51419a(0x1cf)]});_0xf7b281=await warehouse[_0x51419a(0x15e)]([{'$match':{'status':_0x51419a(0x22d),'name':_0x4ec9d7['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x51419a(0x1d8),'name':{'$first':_0x51419a(0x1d8)}}}]);}else _0xf7b281=await warehouse[_0x51419a(0x15e)]([{'$match':{'status':_0x51419a(0x22d),'warehouse_category':_0x51419a(0x18f)}},{'$group':{'_id':_0x51419a(0x1d8),'name':{'$first':_0x51419a(0x1d8)}}}]);var _0x110e48=[_0x51419a(0x20f),_0x51419a(0x1fc),_0x51419a(0x186)];const _0x2b5a68=await transfers[_0x51419a(0x184)]({}),_0x4d9148=_0x2b5a68[_0x51419a(0x1d2)]+0x1,_0x31c7a1='TRF-'+_0x4d9148[_0x51419a(0x1ab)]()[_0x51419a(0x1c4)](0x5,'0');if(_0x6c19c6[0x0][_0x51419a(0x220)]==_0x51419a(0x156)){var _0x2b07a4=users[_0x51419a(0x196)];console[_0x51419a(0x16d)](_0x2b07a4);}else{if(_0x6c19c6[0x0][_0x51419a(0x220)]==_0x51419a(0x158))var _0x2b07a4=users[_0x51419a(0x158)];else{if(_0x6c19c6[0x0][_0x51419a(0x220)]==_0x51419a(0x208))var _0x2b07a4=users[_0x51419a(0x208)];else{if(_0x6c19c6[0x0][_0x51419a(0x220)]==_0x51419a(0x1a6))var _0x2b07a4=users['Spanish'];else{if(_0x6c19c6[0x0][_0x51419a(0x220)]==_0x51419a(0x1ea))var _0x2b07a4=users[_0x51419a(0x1ea)];else{if(_0x6c19c6[0x0][_0x51419a(0x220)]==_0x51419a(0x1b4))var _0x2b07a4=users[_0x51419a(0x1c1)];else{if(_0x6c19c6[0x0][_0x51419a(0x220)]==_0x51419a(0x1f6))var _0x2b07a4=users[_0x51419a(0x1f6)];else{if(_0x6c19c6[0x0]['language']=='Arabic\x20(ae)')var _0x2b07a4=users[_0x51419a(0x21c)];}}}}}}}const _0x223c68=getRandom8DigitNumber();_0x223c68['then'](_0xdd89a2=>{var _0x2724b0=_0x51419a;_0x1da039['render'](_0x2724b0(0x171),{'success':_0x3a9546[_0x2724b0(0x1fd)]('success'),'errors':_0x3a9546['flash']('errors'),'role':_0x470d0a,'profile':_0x56e0df,'master_shop':_0x6c19c6,'warehouse':_0xf7b281,'language':_0x2b07a4,'rooms_data':_0x110e48,'invoice':_0xdd89a2});})[_0x51419a(0x1d7)](_0x593497=>{var _0x2e1f28=_0x51419a;_0x3a9546[_0x2e1f28(0x1fd)]('errors',_0x2e1f28(0x1ee)),_0x1da039[_0x2e1f28(0x13a)](_0x2e1f28(0x21d));});}catch(_0x261cee){console[_0x51419a(0x16d)](_0x261cee);}}),router[a0_0x130251(0x1a2)](a0_0x130251(0x22b),auth,async(_0x51c725,_0x536de3)=>{var _0x532aed=a0_0x130251;try{console[_0x532aed(0x16d)](_0x51c725[_0x532aed(0x15d)]);const {date:_0x122dee,from_warehouse:_0x3b2e51,FromRoom_name:_0x2285ba,to_warehouse:_0x1d199a,ToRoom_name:_0x2d9cdb,prod_name:_0x55d002,from_prod_qty:_0x955f07,from_prod_level:_0x4b91c2,from_prod_isle:_0x20b11e,from_prod_pallet:_0x2e0edb,to_prod_qty:_0x45eb35,to_prod_level:_0x1bada7,to_prod_isle:_0x28db2d,to_prod_pallet:_0x18eafa,primary_code:_0x33a914,secondary_code:_0x3b9833,product_code3:_0xd87fea,note:_0x19a4f3,MaxStocks_data2:_0x1b212c,invoice:_0x1bc25f,expiry_date:_0x25789c}=_0x51c725[_0x532aed(0x15d)];if(typeof _0x55d002==_0x532aed(0x1c6))var _0x4c2cb2=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x168)]],_0x279cf4=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x1f4)]],_0x39a1fe=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x219)]],_0x5963c9=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x1c8)]],_0x3b9e8e=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x205)]],_0x34f1a3=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x1d0)]],_0x478a6b=[_0x51c725['body'][_0x532aed(0x20d)]],_0x2c2361=[_0x51c725[_0x532aed(0x15d)]['product_code3']],_0x32ca08=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x1df)]],_0x54fda6=[_0x51c725[_0x532aed(0x15d)]['primary_unit']],_0x40d9f2=[_0x51c725['body']['secondary_unit']],_0xbe695a=[_0x51c725[_0x532aed(0x15d)]['batch_code']],_0x213f81=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x1f5)]],_0x7c9c94=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x1d5)]],_0x42e2ec=[_0x51c725['body'][_0x532aed(0x214)]],_0x30164b=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x193)]],_0x3e1320=[_0x51c725['body'][_0x532aed(0x200)]],_0x63b573=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x18b)]],_0x3525ab=[_0x51c725['body']['from_invoice']],_0x28d789=[_0x51c725['body'][_0x532aed(0x160)]],_0x1dcc8d=[_0x51c725[_0x532aed(0x15d)][_0x532aed(0x1af)]];else var _0x4c2cb2=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x168)]],_0x279cf4=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x1f4)]],_0x39a1fe=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x219)]],_0x5963c9=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x1c8)]],_0x3b9e8e=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x205)]],_0x34f1a3=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x1d0)]],_0x478a6b=[..._0x51c725[_0x532aed(0x15d)]['secondary_code']],_0x2c2361=[..._0x51c725['body']['product_code3']],_0x32ca08=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x1df)]],_0x54fda6=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x230)]],_0x40d9f2=[..._0x51c725[_0x532aed(0x15d)]['secondary_unit']],_0xbe695a=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x15c)]],_0x213f81=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x1f5)]],_0x7c9c94=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x1d5)]],_0x42e2ec=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x214)]],_0x30164b=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x193)]],_0x3e1320=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x200)]],_0x63b573=[..._0x51c725['body'][_0x532aed(0x18b)]],_0x3525ab=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x179)]],_0x28d789=[..._0x51c725[_0x532aed(0x15d)][_0x532aed(0x160)]],_0x1dcc8d=[..._0x51c725['body']['id_transaction']];const _0x367083=_0x4c2cb2[_0x532aed(0x13d)](_0x85b586=>{return _0x85b586={'product_name':_0x85b586};});_0x279cf4['forEach']((_0x47e088,_0x495834)=>{var _0x228712=_0x532aed;_0x367083[_0x495834][_0x228712(0x145)]=_0x47e088;}),_0x3525ab[_0x532aed(0x1da)]((_0x3843c7,_0x5332bd)=>{var _0x309585=_0x532aed;_0x367083[_0x5332bd][_0x309585(0x179)]=_0x3843c7;}),_0x28d789[_0x532aed(0x1da)]((_0x33a5cf,_0x47a24d)=>{_0x367083[_0x47a24d]['To_invoice']=_0x33a5cf;}),_0x1dcc8d['forEach']((_0x4b3f86,_0x159088)=>{_0x367083[_0x159088]['id_transaction_id']=_0x4b3f86;}),_0x39a1fe[_0x532aed(0x1da)]((_0x3bf9c5,_0x1cbeef)=>{var _0x195f4d=_0x532aed;_0x3e1320[_0x195f4d(0x1da)]((_0x2519f5,_0x324ed2)=>{var _0x124755=_0x195f4d;if(_0x2519f5==_0x124755(0x1f1)&&_0x1cbeef==_0x324ed2){var _0xdf8bfd=_0x3bf9c5['slice'](0x3);_0x367083[_0x1cbeef][_0x124755(0x142)]=_0x3bf9c5[0x0],_0x367083[_0x1cbeef][_0x124755(0x1ec)]=_0x3bf9c5[0x1],_0x367083[_0x1cbeef][_0x124755(0x210)]=0x0,_0x367083[_0x1cbeef][_0x124755(0x1d6)]=0x0,_0x367083[_0x1cbeef]['from_types']=_0x124755(0x18d),_0x367083[_0x1cbeef][_0x124755(0x213)]=_0xdf8bfd;}else{if(_0x2519f5=='Shelves'&&_0x1cbeef==_0x324ed2){var _0xdf8bfd=_0x3bf9c5[_0x124755(0x1e1)](0x3);_0x367083[_0x1cbeef]['from_storage']=_0x3bf9c5[0x0],_0x367083[_0x1cbeef]['from_rack']=_0x3bf9c5[0x1],_0x367083[_0x1cbeef][_0x124755(0x210)]=0x0,_0x367083[_0x1cbeef][_0x124755(0x1d6)]=0x0,_0x367083[_0x1cbeef][_0x124755(0x163)]=_0x124755(0x18d),_0x367083[_0x1cbeef][_0x124755(0x213)]=_0x3bf9c5[0x5];}else{if(_0x1cbeef==_0x324ed2){if(_0x3bf9c5[0x0]=='A'&&_0x3bf9c5[0x1]=='L'&&_0x3bf9c5[0x2]=='L')console[_0x124755(0x16d)](_0x2519f5+'\x20<>\x20'+_0x1cbeef+_0x124755(0x202)+_0x324ed2+_0x124755(0x202)+_0x3bf9c5+_0x124755(0x140)),_0x367083[_0x1cbeef][_0x124755(0x142)]=_0x3bf9c5[0x0],_0x367083[_0x1cbeef][_0x124755(0x1ec)]=_0x3bf9c5[0x1],_0x367083[_0x1cbeef][_0x124755(0x210)]=0x0,_0x367083[_0x1cbeef][_0x124755(0x1d6)]=0x0,_0x367083[_0x1cbeef][_0x124755(0x163)]=_0x124755(0x18d),_0x367083[_0x1cbeef][_0x124755(0x213)]=_0x3bf9c5[0x3];else{var _0x4a5b3c;if(_0x3bf9c5[0x4]=='L')_0x4a5b3c=_0x124755(0x233);else _0x3bf9c5[0x4]=='F'&&(_0x4a5b3c=_0x124755(0x18d));_0x367083[_0x1cbeef]['from_storage']=_0x3bf9c5[0x0],_0x367083[_0x1cbeef][_0x124755(0x1ec)]=_0x3bf9c5[0x1],_0x367083[_0x1cbeef][_0x124755(0x210)]=_0x3bf9c5[0x2],_0x367083[_0x1cbeef][_0x124755(0x1d6)]=_0x3bf9c5[0x3],_0x367083[_0x1cbeef][_0x124755(0x163)]=_0x4a5b3c,_0x367083[_0x1cbeef][_0x124755(0x213)]=_0x3bf9c5[0x5];}}}}});}),_0x5963c9['forEach']((_0xc25eb5,_0x22ae81)=>{var _0xe9e3d9=_0x532aed;_0x367083[_0x22ae81][_0xe9e3d9(0x231)]=_0xc25eb5;}),_0x3b9e8e['forEach']((_0x40b245,_0x1aa61f)=>{var _0x40b0d6=_0x532aed;_0x63b573[_0x40b0d6(0x1da)]((_0x64023c,_0x3a0780)=>{var _0x22b60c=_0x40b0d6;if(_0x64023c==_0x22b60c(0x1f1)&&_0x1aa61f==_0x3a0780){var _0x577c41=_0x40b245[_0x22b60c(0x1e1)](0x3);_0x367083[_0x1aa61f][_0x22b60c(0x177)]=_0x40b245[0x0],_0x367083[_0x1aa61f][_0x22b60c(0x232)]=_0x40b245[0x1],_0x367083[_0x1aa61f][_0x22b60c(0x170)]=0x0,_0x367083[_0x1aa61f][_0x22b60c(0x1a5)]=0x0,_0x367083[_0x1aa61f]['to_types']='Floor',_0x367083[_0x1aa61f]['to_floorlevel']=_0x577c41;}else{if(_0x64023c==_0x22b60c(0x1e3)&&_0x1aa61f==_0x3a0780){var _0x577c41=_0x40b245[_0x22b60c(0x1e1)](0x3);_0x367083[_0x1aa61f][_0x22b60c(0x177)]=_0x40b245[0x0],_0x367083[_0x1aa61f][_0x22b60c(0x232)]=_0x40b245[0x1],_0x367083[_0x1aa61f][_0x22b60c(0x170)]=0x0,_0x367083[_0x1aa61f][_0x22b60c(0x1a5)]=0x0,_0x367083[_0x1aa61f]['to_types']=_0x22b60c(0x18d),_0x367083[_0x1aa61f][_0x22b60c(0x159)]=_0x40b245[0x5];}else{if(_0x1aa61f==_0x3a0780){if(_0x40b245[0x0]=='A'&&_0x40b245[0x1]=='L'&&_0x40b245[0x2]=='L')console[_0x22b60c(0x16d)](_0x64023c+'\x20<>\x20'+_0x1aa61f+_0x22b60c(0x202)+_0x3a0780+_0x22b60c(0x202)+_0x40b245+_0x22b60c(0x140)),_0x367083[_0x1aa61f][_0x22b60c(0x177)]=_0x40b245[0x0],_0x367083[_0x1aa61f][_0x22b60c(0x232)]=_0x40b245[0x1],_0x367083[_0x1aa61f][_0x22b60c(0x170)]=0x0,_0x367083[_0x1aa61f]['to_bin']=0x0,_0x367083[_0x1aa61f][_0x22b60c(0x17d)]=_0x22b60c(0x18d),_0x367083[_0x1aa61f][_0x22b60c(0x159)]=_0x40b245[0x3];else{var _0x2defb9;if(_0x40b245[0x4]=='L')_0x2defb9=_0x22b60c(0x233);else _0x40b245[0x4]=='F'&&(_0x2defb9=_0x22b60c(0x18d));_0x367083[_0x1aa61f]['storage']=_0x40b245[0x0],_0x367083[_0x1aa61f][_0x22b60c(0x232)]=_0x40b245[0x1],_0x367083[_0x1aa61f][_0x22b60c(0x170)]=_0x40b245[0x2],_0x367083[_0x1aa61f]['to_bin']=_0x40b245[0x3],_0x367083[_0x1aa61f][_0x22b60c(0x17d)]=_0x2defb9,_0x367083[_0x1aa61f][_0x22b60c(0x159)]=_0x40b245[0x5];}}}}});}),_0x34f1a3['forEach']((_0x27e2d6,_0x277763)=>{var _0x3e14d8=_0x532aed;_0x367083[_0x277763][_0x3e14d8(0x1d0)]=_0x27e2d6;}),_0x478a6b[_0x532aed(0x1da)]((_0x282bf1,_0x42b08c)=>{_0x367083[_0x42b08c]['secondary_code']=_0x282bf1;}),_0x2c2361[_0x532aed(0x1da)]((_0x2d5521,_0x421db8)=>{var _0x992f93=_0x532aed;_0x367083[_0x421db8][_0x992f93(0x174)]=_0x2d5521;}),_0x32ca08[_0x532aed(0x1da)]((_0x304501,_0x209b48)=>{_0x367083[_0x209b48]['maxProducts']=_0x304501;}),_0x54fda6[_0x532aed(0x1da)]((_0x3a9e32,_0x11fcf0)=>{_0x367083[_0x11fcf0]['unit']=_0x3a9e32;}),_0x40d9f2[_0x532aed(0x1da)]((_0x2bbdd5,_0xa1eabf)=>{_0x367083[_0xa1eabf]['secondary_unit']=_0x2bbdd5;}),_0xbe695a['forEach']((_0x481bfb,_0x2f364a)=>{var _0x68699=_0x532aed;_0x367083[_0x2f364a][_0x68699(0x15c)]=_0x481bfb;}),_0x213f81[_0x532aed(0x1da)]((_0x316861,_0x55d3ed)=>{_0x367083[_0x55d3ed]['expiry_date']=_0x316861;}),_0x7c9c94['forEach']((_0xf4d10e,_0x541a75)=>{var _0x4594d9=_0x532aed;_0x367083[_0x541a75][_0x4594d9(0x1ce)]=_0xf4d10e;}),_0x42e2ec[_0x532aed(0x1da)]((_0x52ebac,_0x4172ab)=>{var _0x524ad4=_0x532aed;_0x367083[_0x4172ab][_0x524ad4(0x214)]=_0x52ebac;}),_0x30164b[_0x532aed(0x1da)]((_0x2bf15d,_0x334717)=>{var _0x3b8cbb=_0x532aed;_0x367083[_0x334717][_0x3b8cbb(0x193)]=_0x2bf15d;}),_0x3e1320[_0x532aed(0x1da)]((_0x3aeadf,_0x182f42)=>{var _0x4d0638=_0x532aed;_0x367083[_0x182f42][_0x4d0638(0x16c)]=_0x3aeadf;}),_0x63b573[_0x532aed(0x1da)]((_0x2871dd,_0x36a5e5)=>{var _0x3593e0=_0x532aed;_0x367083[_0x36a5e5][_0x3593e0(0x153)]=_0x2871dd;});const _0x4690cb=_0x367083[_0x532aed(0x1f7)](_0x2b37a1=>_0x2b37a1[_0x532aed(0x231)]!=='0'&&_0x2b37a1[_0x532aed(0x231)]!==''||_0x2b37a1[_0x532aed(0x159)]!=='0'&&_0x2b37a1['to_floorlevel']!==''),_0x16a444=new transfers({'date':_0x122dee,'from_warehouse':_0x3b2e51,'to_warehouse':_0x1d199a,'product':_0x4690cb,'note':_0x19a4f3,'invoice':_0x1bc25f}),_0x32052d=await _0x16a444[_0x532aed(0x227)]();_0x51c725['flash']('success','Product\x20Transfer\x20successfully'),_0x536de3['redirect'](_0x532aed(0x13c)+_0x32052d[_0x532aed(0x1e4)]);}catch(_0x369836){console[_0x532aed(0x16d)](_0x369836),_0x536de3[_0x532aed(0x1e2)](0xc8)[_0x532aed(0x1d3)]({'errorMessage':_0x369836[_0x532aed(0x1eb)]});}}),router[a0_0x130251(0x143)](a0_0x130251(0x1f0),auth,async(_0x2c8e98,_0x45ca01)=>{var _0x5a65f4=a0_0x130251;try{const {username:_0x2162fb,email:_0x401e73,role:_0xbfe7b1}=_0x2c8e98[_0x5a65f4(0x1cd)],_0xb3dbda=_0x2c8e98['user'],_0xde7537=await profile[_0x5a65f4(0x22f)]({'email':_0xb3dbda['email']}),_0x432185=await master_shop[_0x5a65f4(0x184)]();console[_0x5a65f4(0x16d)]('master',_0x432185);const _0x12153c=await transfers[_0x5a65f4(0x167)](_0x2c8e98[_0x5a65f4(0x1f9)]['id']);let _0x51b7df=new Date(_0x12153c[_0x5a65f4(0x1f5)]),_0x1a708c=('0'+_0x51b7df[_0x5a65f4(0x151)]())[_0x5a65f4(0x1e1)](-0x2),_0x439ab7=('0'+(_0x51b7df[_0x5a65f4(0x17c)]()+0x1))['slice'](-0x2),_0xf158de=_0x51b7df[_0x5a65f4(0x18e)](),_0x209990=_0xf158de+'-'+_0x439ab7+'-'+_0x1a708c,_0x26ddd5;if(_0xb3dbda[_0x5a65f4(0x17b)]==_0x5a65f4(0x1c9)){const _0x4c7244=await staff['findOne']({'email':_0xb3dbda[_0x5a65f4(0x1cf)]});_0x26ddd5=await warehouse[_0x5a65f4(0x184)]({'status':'Enabled','name':_0x4c7244['warehouse'],'warehouse_category':'Raw\x20Materials'});}else _0x26ddd5=await warehouse['find']({'status':_0x5a65f4(0x22d),'warehouse_category':_0x5a65f4(0x18f)});const _0x35af57=await warehouse[_0x5a65f4(0x15e)]([{'$match':{'name':_0x12153c[_0x5a65f4(0x1bc)]}},{'$unwind':_0x5a65f4(0x1c0)},{'$group':{'_id':_0x5a65f4(0x1dc),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5a65f4(0x190)},'bay':{'$first':_0x5a65f4(0x1bd)},'bin':{'$first':_0x5a65f4(0x21a)},'type':{'$first':_0x5a65f4(0x1b1)},'floorlevel':{'$first':_0x5a65f4(0x161)},'primary_code':{'$first':_0x5a65f4(0x1dd)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5a65f4(0x1b7)},'production_date':{'$first':_0x5a65f4(0x229)},'room':{'$first':_0x5a65f4(0x1ad)}}}]);if(_0x432185[0x0][_0x5a65f4(0x220)]==_0x5a65f4(0x156)){var _0xeb7ebb=users[_0x5a65f4(0x196)];console[_0x5a65f4(0x16d)](_0xeb7ebb);}else{if(_0x432185[0x0][_0x5a65f4(0x220)]==_0x5a65f4(0x158))var _0xeb7ebb=users['Hindi'];else{if(_0x432185[0x0]['language']=='German')var _0xeb7ebb=users[_0x5a65f4(0x208)];else{if(_0x432185[0x0][_0x5a65f4(0x220)]==_0x5a65f4(0x1a6))var _0xeb7ebb=users[_0x5a65f4(0x1a6)];else{if(_0x432185[0x0][_0x5a65f4(0x220)]==_0x5a65f4(0x1ea))var _0xeb7ebb=users['French'];else{if(_0x432185[0x0][_0x5a65f4(0x220)]==_0x5a65f4(0x1b4))var _0xeb7ebb=users[_0x5a65f4(0x1c1)];else{if(_0x432185[0x0]['language']==_0x5a65f4(0x1f6))var _0xeb7ebb=users[_0x5a65f4(0x1f6)];else{if(_0x432185[0x0][_0x5a65f4(0x220)]=='Arabic\x20(ae)')var _0xeb7ebb=users[_0x5a65f4(0x21c)];}}}}}}}_0x45ca01[_0x5a65f4(0x20c)](_0x5a65f4(0x22e),{'success':_0x2c8e98['flash'](_0x5a65f4(0x15f)),'errors':_0x2c8e98[_0x5a65f4(0x1fd)](_0x5a65f4(0x180)),'role':_0xb3dbda,'profile':_0xde7537,'master_shop':_0x432185,'warehouse':_0x26ddd5,'transfer':_0x12153c,'stock':_0x35af57,'language':_0xeb7ebb});}catch(_0x3de4d0){console['log'](_0x3de4d0);}}),router[a0_0x130251(0x1a2)](a0_0x130251(0x1f0),auth,async(_0x4faa00,_0x5ed222)=>{var _0x87e87f=a0_0x130251;try{const _0x5e795b=_0x4faa00[_0x87e87f(0x1f9)]['id'],{from_warehouse:_0x2838b8,FromRoom_name:_0x2b63c5,to_warehouse:_0x47328e,ToRoom_name:_0x4595d7}=_0x4faa00['body'],_0x1ad8ce=await transfers['findById']({'_id':_0x5e795b}),_0x3275a5=_0x1ad8ce[_0x87e87f(0x217)][_0x87e87f(0x13d)](async _0x5c18d2=>{var _0x22f743=_0x87e87f;if(_0x5c18d2[_0x22f743(0x231)]>0x0){var _0x54fdc5=await warehouse[_0x22f743(0x22f)]({'name':_0x1ad8ce[_0x22f743(0x1bc)],'room':_0x5c18d2['from_room_name'],'warehouse_category':_0x22f743(0x18f)});const _0x2edcd3=_0x54fdc5[_0x22f743(0x166)][_0x22f743(0x13d)](_0x87ca25=>{var _0x4b3a21=_0x22f743;_0x87ca25[_0x4b3a21(0x187)]==_0x5c18d2['product_name']&&_0x87ca25[_0x4b3a21(0x157)]==_0x5c18d2['from_floorlevel']&&_0x87ca25[_0x4b3a21(0x195)]==_0x5c18d2[_0x4b3a21(0x163)]&&_0x87ca25[_0x4b3a21(0x1b6)]==_0x5c18d2[_0x4b3a21(0x1d6)]&&_0x87ca25[_0x4b3a21(0x209)]==_0x5c18d2[_0x4b3a21(0x210)]&&_0x87ca25[_0x4b3a21(0x232)]==_0x5c18d2[_0x4b3a21(0x1ec)]&&_0x87ca25[_0x4b3a21(0x177)]==_0x5c18d2[_0x4b3a21(0x142)]&&_0x87ca25['expiry_date']==_0x5c18d2[_0x4b3a21(0x1f5)]&&_0x87ca25['batch_code']==_0x5c18d2[_0x4b3a21(0x15c)]&&_0x87ca25[_0x4b3a21(0x214)]==_0x5c18d2[_0x4b3a21(0x214)]&&_0x87ca25[_0x4b3a21(0x20a)]==_0x5c18d2[_0x4b3a21(0x179)]&&_0x87ca25[_0x4b3a21(0x1e4)]==_0x5c18d2['id_transaction_id']&&(_0x87ca25[_0x4b3a21(0x16a)]=_0x87ca25[_0x4b3a21(0x16a)]-_0x5c18d2[_0x4b3a21(0x231)]);});}return _0x54fdc5;});Promise[_0x87e87f(0x201)](_0x3275a5)['then'](async _0x5c92da=>{var _0x4b4d4e=_0x87e87f;try{for(const _0x27dd7a of _0x5c92da){await _0x27dd7a[_0x4b4d4e(0x227)]();}try{const _0xae30bf=_0x1ad8ce[_0x4b4d4e(0x217)]['map'](async _0x4a40de=>{var _0x4a1530=_0x4b4d4e;if(_0x4a40de[_0x4a1530(0x231)]>0x0){var _0x1fb7f1=await warehouse[_0x4a1530(0x22f)]({'name':_0x1ad8ce[_0x4a1530(0x1e8)],'room':_0x4a40de[_0x4a1530(0x153)],'warehouse_category':_0x4a1530(0x18f)}),_0x1f3f2e=0x0;const _0x32e909=_0x1fb7f1[_0x4a1530(0x166)][_0x4a1530(0x13d)](_0x304fe7=>{var _0xad86a=_0x4a1530;_0x304fe7[_0xad86a(0x187)]==_0x4a40de['product_name']&&_0x304fe7[_0xad86a(0x157)]==_0x4a40de['to_floorlevel']&&_0x304fe7[_0xad86a(0x195)]==_0x4a40de[_0xad86a(0x17d)]&&_0x304fe7[_0xad86a(0x1b6)]==_0x4a40de[_0xad86a(0x1a5)]&&_0x304fe7[_0xad86a(0x209)]==_0x4a40de[_0xad86a(0x170)]&&_0x304fe7[_0xad86a(0x232)]==_0x4a40de[_0xad86a(0x232)]&&_0x304fe7['storage']==_0x4a40de['storage']&&_0x304fe7[_0xad86a(0x1f5)]==_0x4a40de[_0xad86a(0x1f5)]&&_0x304fe7['batch_code']==_0x4a40de[_0xad86a(0x15c)]&&_0x304fe7[_0xad86a(0x214)]==_0x4a40de[_0xad86a(0x214)]&&_0x304fe7[_0xad86a(0x20a)]==_0x4a40de[_0xad86a(0x150)]&&(_0x304fe7[_0xad86a(0x16a)]=_0x304fe7['product_stock']+_0x4a40de['to_quantity'],_0x1f3f2e++);});_0x1f3f2e=='0'&&(_0x1fb7f1[_0x4a1530(0x166)]=_0x1fb7f1[_0x4a1530(0x166)]['concat']({'product_name':_0x4a40de[_0x4a1530(0x187)],'product_stock':_0x4a40de[_0x4a1530(0x231)],'bay':_0x4a40de[_0x4a1530(0x170)],'bin':_0x4a40de[_0x4a1530(0x1a5)],'type':_0x4a40de[_0x4a1530(0x17d)],'floorlevel':_0x4a40de['to_floorlevel'],'storage':_0x4a40de[_0x4a1530(0x177)],'rack':_0x4a40de['rack'],'product_code':_0x4a40de[_0x4a1530(0x174)],'primary_code':_0x4a40de[_0x4a1530(0x1d0)],'secondary_code':_0x4a40de[_0x4a1530(0x20d)],'maxProducts':_0x4a40de[_0x4a1530(0x1a7)],'storage':_0x4a40de[_0x4a1530(0x177)],'rack':_0x4a40de[_0x4a1530(0x232)],'expiry_date':_0x4a40de[_0x4a1530(0x1f5)],'maxPerUnit':_0x4a40de[_0x4a1530(0x1ce)],'batch_code':_0x4a40de[_0x4a1530(0x15c)],'production_date':_0x4a40de['production_date']}));}return _0x1fb7f1;});Promise[_0x4b4d4e(0x201)](_0xae30bf)[_0x4b4d4e(0x215)](async _0x330001=>{var _0x12f696=_0x4b4d4e;try{for(const _0x32fd80 of _0x330001){await warehouse[_0x12f696(0x1c5)]({'_id':_0x32fd80[_0x12f696(0x1e4)]},{'$addToSet':{'product_details':{'$each':_0x32fd80[_0x12f696(0x166)]}}});}_0x1ad8ce[_0x12f696(0x155)]='True';const _0x3f6a55=await _0x1ad8ce[_0x12f696(0x227)](),_0x58c12e=await master_shop[_0x12f696(0x184)](),_0x48bc91=await email_settings[_0x12f696(0x22f)](),_0x39271e=await supervisor_settings[_0x12f696(0x184)]();var _0x14a865=_0x1ad8ce[_0x12f696(0x217)],_0x4befa8='',_0x4ecace;for(_0x4ecace in _0x14a865){_0x4befa8+='<tr>'+_0x12f696(0x218)+_0x14a865[_0x4ecace][_0x12f696(0x187)]+_0x12f696(0x1e6)+_0x12f696(0x218)+_0x14a865[_0x4ecace][_0x12f696(0x174)]+_0x12f696(0x1e6)+_0x12f696(0x218)+_0x14a865[_0x4ecace][_0x12f696(0x231)]+'</td>'+_0x12f696(0x218)+_0x14a865[_0x4ecace][_0x12f696(0x1a1)]+_0x12f696(0x1e6)+_0x12f696(0x218)+_0x14a865[_0x4ecace][_0x12f696(0x1de)]+_0x12f696(0x1e6)+_0x12f696(0x218)+_0x1ad8ce['to_warehouse']+_0x12f696(0x1e6)+_0x12f696(0x218)+_0x14a865[_0x4ecace][_0x12f696(0x153)]+_0x12f696(0x1e6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x14a865[_0x4ecace][_0x12f696(0x177)]+_0x14a865[_0x4ecace]['rack']+_0x14a865[_0x4ecace][_0x12f696(0x170)]+_0x14a865[_0x4ecace][_0x12f696(0x1a5)]+_0x14a865[_0x4ecace][_0x12f696(0x17d)][0x0]+_0x14a865[_0x4ecace][_0x12f696(0x159)]+_0x12f696(0x1e6),'</tr>';}let _0x52143f=nodemailer[_0x12f696(0x1c7)]({'host':_0x48bc91[_0x12f696(0x1e5)],'port':Number(_0x48bc91['port']),'secure':![],'auth':{'user':_0x48bc91[_0x12f696(0x1cf)],'pass':_0x48bc91['password']}}),_0x31fb26={'from':_0x48bc91[_0x12f696(0x1cf)],'to':_0x39271e[0x0][_0x12f696(0x226)],'subject':_0x12f696(0x13b),'attachments':[{'filename':_0x12f696(0x1fe),'path':__dirname+'/../public'+_0x12f696(0x162)+_0x58c12e[0x0][_0x12f696(0x18c)],'cid':_0x12f696(0x146)}],'html':_0x12f696(0x1a9)+'<html><head><title></title>'+_0x12f696(0x1b0)+_0x12f696(0x141)+_0x12f696(0x15a)+'<div>'+_0x12f696(0x152)+'</div>'+_0x12f696(0x141)+_0x12f696(0x1f3)+_0x58c12e[0x0][_0x12f696(0x1f8)]+_0x12f696(0x149)+_0x12f696(0x178)+_0x12f696(0x178)+_0x12f696(0x1a8)+'<div>'+_0x12f696(0x1ff)+_0x12f696(0x21e)+_0x1ad8ce[_0x12f696(0x20a)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x12f696(0x223)+_0x1ad8ce['date']+'\x20'+_0x12f696(0x164)+_0x12f696(0x197)+_0x12f696(0x178)+_0x12f696(0x15b)+_0x12f696(0x211)+_0x12f696(0x203)+_0x12f696(0x16e)+_0x12f696(0x154)+_0x12f696(0x222)+_0x12f696(0x147)+_0x12f696(0x225)+_0x12f696(0x20e)+_0x12f696(0x191)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x12f696(0x16b)+_0x12f696(0x1f2)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4befa8+'\x20'+_0x12f696(0x189)+_0x12f696(0x1fb)+'<div>'+_0x12f696(0x221)+_0x12f696(0x13f)+_0x58c12e[0x0][_0x12f696(0x1f8)]+_0x12f696(0x197)+'</div>'+_0x12f696(0x178)+_0x12f696(0x19f)};_0x52143f[_0x12f696(0x182)](_0x31fb26,function(_0x55c36b,_0x135d59){var _0x5504f7=_0x12f696;_0x55c36b?(console[_0x5504f7(0x16d)](_0x55c36b),console[_0x5504f7(0x16d)]('Error\x20Occurs')):console['log'](_0x5504f7(0x185));}),_0x4faa00[_0x12f696(0x1fd)](_0x12f696(0x15f),_0x12f696(0x198)),_0x5ed222[_0x12f696(0x13a)](_0x12f696(0x1d1)+_0x3f6a55[_0x12f696(0x1e4)]);}catch(_0xd38a4){console[_0x12f696(0x13e)](_0xd38a4),_0x5ed222['status'](0x1f4)[_0x12f696(0x1d3)]({'Perror':_0x12f696(0x212),'message':_0xd38a4[_0x12f696(0x1eb)]});}})['catch'](_0x5a4ad4=>{var _0x3fafcd=_0x4b4d4e;console[_0x3fafcd(0x13e)](_0x5a4ad4),_0x5ed222[_0x3fafcd(0x1e2)](0x1f4)[_0x3fafcd(0x1d3)]({'Perror':_0x3fafcd(0x1a4)});});}catch(_0x25c738){_0x5ed222[_0x4b4d4e(0x1d3)](_0x25c738);}}catch(_0x56669f){console['error'](_0x56669f),_0x5ed222[_0x4b4d4e(0x1e2)](0x1f4)[_0x4b4d4e(0x1d3)]({'Merror':_0x4b4d4e(0x212),'Message':_0x56669f[_0x4b4d4e(0x1eb)]});}})[_0x87e87f(0x1d7)](_0x4ed4d0=>{var _0x182779=_0x87e87f;console[_0x182779(0x13e)](_0x4ed4d0),_0x5ed222[_0x182779(0x1e2)](0x1f4)[_0x182779(0x1d3)]({'Merror':_0x182779(0x1a4)});});}catch(_0x41d762){console[_0x87e87f(0x16d)](_0x41d762);}});function BayBinSelected(_0x2631ef,_0x5f2114){var _0xf3d32e=a0_0x130251,_0x5ca96c=[],_0x225275=[],_0x3654e2=[],_0x27c93f=[],_0x361220=[],_0x3129a4=[];let _0x240c2a=[];if(_0x2631ef==_0xf3d32e(0x19b))switch(_0x5f2114){case'Rack\x20A':_0x5ca96c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x225275=[0x1,0x2],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=[_0xf3d32e(0x233),_0xf3d32e(0x18d)],_0x361220=['D'],_0x3129a4=['A'];break;case _0xf3d32e(0x14d):_0x5ca96c=[0x6,0x5,0x4,0x3,0x2,0x1],_0x225275=[0x1,0x2],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=[_0xf3d32e(0x233),_0xf3d32e(0x18d)],_0x361220=['D'],_0x3129a4=['B'];break;case _0xf3d32e(0x1e3):_0x5ca96c=[0x0],_0x225275=[0x0],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=[_0xf3d32e(0x18d)],_0x361220=['D'],_0x3129a4=['S'];break;case _0xf3d32e(0x1f1):_0x5ca96c=[0x0],_0x225275=[0x0],_0x27c93f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3654e2=[_0xf3d32e(0x18d)],_0x361220=['D'],_0x3129a4=['R'];break;}else{if(_0x2631ef=='COLD\x20STORAGE')switch(_0x5f2114){case _0xf3d32e(0x181):_0x5ca96c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x225275=['B','F'],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=[_0xf3d32e(0x233),'Floor'],_0x361220=['C'],_0x3129a4=['A'];break;case _0xf3d32e(0x14d):_0x5ca96c=[0x5,0x4,0x3,0x2,0x1],_0x225275=['F','B','S'],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=[_0xf3d32e(0x233),_0xf3d32e(0x18d)],_0x361220=['C'],_0x3129a4=['B'];break;case'Rack\x20C':_0x5ca96c=[0x1,0x2,0x3,0x4,0x5],_0x225275=['B','F','S'],_0x27c93f=[0x5,0x4,0x3,0x2,0x1],_0x3654e2=[_0xf3d32e(0x233),'Floor'],_0x361220=['C'],_0x3129a4=['C'];break;case'Rack\x20D':_0x5ca96c=[0x5,0x4,0x3,0x2,0x1],_0x225275=['F','B','S'],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=[_0xf3d32e(0x233),'Floor'],_0x361220=['C'],_0x3129a4=['D'];break;case _0xf3d32e(0x1b5):_0x5ca96c=[0x4,0x3,0x2,0x1],_0x225275=[0x1,0x2],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=[_0xf3d32e(0x233),'Floor'],_0x361220=['C'],_0x3129a4=['E'];break;case _0xf3d32e(0x22a):_0x5ca96c=[0x1,0x2,0x3],_0x225275=[0x1,0x2],_0x27c93f=[0x1,0x2,0x3,0x4,0x5],_0x3654e2=['Level'],_0x361220=['C'],_0x3129a4=['F'];break;}}return{'levels':_0x5ca96c,'Isle':_0x225275,'rack':_0x27c93f,'type':_0x3654e2,'storage':_0x361220,'rak':_0x3129a4};}router['get'](a0_0x130251(0x19d),auth,async(_0x9bf0d9,_0x4b0824)=>{var _0x4634ab=a0_0x130251;try{const {username:_0x577865,email:_0x13941d,role:_0xd7fca3}=_0x9bf0d9[_0x4634ab(0x1cd)],_0x3268fc=_0x9bf0d9[_0x4634ab(0x1cd)],_0xd7e05a=await profile['findOne']({'email':_0x3268fc[_0x4634ab(0x1cf)]}),_0x1df5a0=await master_shop[_0x4634ab(0x184)](),_0x451c13=await transfers[_0x4634ab(0x167)](_0x9bf0d9[_0x4634ab(0x1f9)]['id']);let _0x8c7f4;if(_0x3268fc[_0x4634ab(0x17b)]=='staff'){const _0x4f5c2a=await staff[_0x4634ab(0x22f)]({'email':_0x3268fc['email']});_0x8c7f4=await warehouse[_0x4634ab(0x15e)]([{'$match':{'status':'Enabled','name':_0x4f5c2a[_0x4634ab(0x1a3)],'warehouse_category':_0x4634ab(0x18f)}},{'$group':{'_id':_0x4634ab(0x1d8),'name':{'$first':'$name'}}}]);}else _0x8c7f4=await warehouse['aggregate']([{'$match':{'status':_0x4634ab(0x22d),'warehouse_category':_0x4634ab(0x18f)}},{'$group':{'_id':_0x4634ab(0x1d8),'name':{'$first':_0x4634ab(0x1d8)}}}]);const _0x204755=await warehouse[_0x4634ab(0x15e)]([{'$match':{'name':_0x451c13[_0x4634ab(0x1bc)],'warehouse_category':_0x4634ab(0x18f)}},{'$unwind':_0x4634ab(0x1c0)},{'$group':{'_id':_0x4634ab(0x1dc),'name':{'$first':_0x4634ab(0x175)},'product_stock':{'$first':_0x4634ab(0x190)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x4634ab(0x21a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4634ab(0x161)},'primary_code':{'$first':_0x4634ab(0x1dd)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4634ab(0x1bf)},'storage':{'$first':_0x4634ab(0x194)},'rack':{'$first':_0x4634ab(0x14a)},'expiry_date':{'$first':_0x4634ab(0x1b7)},'production_date':{'$first':_0x4634ab(0x229)},'room':{'$first':_0x4634ab(0x1ad)}}}]),_0x3bd9ed=await product[_0x4634ab(0x184)]({}),_0x450936=BayBinSelected(_0x451c13['to_warehouse'],_0x451c13[_0x4634ab(0x1aa)]);if(_0x1df5a0[0x0][_0x4634ab(0x220)]==_0x4634ab(0x156)){var _0x12b820=users[_0x4634ab(0x196)];console[_0x4634ab(0x16d)](_0x12b820);}else{if(_0x1df5a0[0x0][_0x4634ab(0x220)]==_0x4634ab(0x158))var _0x12b820=users['Hindi'];else{if(_0x1df5a0[0x0]['language']==_0x4634ab(0x208))var _0x12b820=users[_0x4634ab(0x208)];else{if(_0x1df5a0[0x0][_0x4634ab(0x220)]==_0x4634ab(0x1a6))var _0x12b820=users[_0x4634ab(0x1a6)];else{if(_0x1df5a0[0x0][_0x4634ab(0x220)]==_0x4634ab(0x1ea))var _0x12b820=users[_0x4634ab(0x1ea)];else{if(_0x1df5a0[0x0][_0x4634ab(0x220)]==_0x4634ab(0x1b4))var _0x12b820=users[_0x4634ab(0x1c1)];else{if(_0x1df5a0[0x0][_0x4634ab(0x220)]==_0x4634ab(0x1f6))var _0x12b820=users[_0x4634ab(0x1f6)];else{if(_0x1df5a0[0x0][_0x4634ab(0x220)]==_0x4634ab(0x1ca))var _0x12b820=users[_0x4634ab(0x21c)];}}}}}}}_0x4b0824['render'](_0x4634ab(0x18a),{'success':_0x9bf0d9[_0x4634ab(0x1fd)](_0x4634ab(0x15f)),'errors':_0x9bf0d9[_0x4634ab(0x1fd)]('errors'),'role':_0x3268fc,'profile':_0xd7e05a,'master_shop':_0x1df5a0,'warehouse':_0x8c7f4,'transfer':_0x451c13,'stock':_0x204755,'unit':_0x3bd9ed,'language':_0x12b820});}catch(_0xcc965e){console[_0x4634ab(0x16d)](_0xcc965e);}}),router['post']('/view/:id',auth,async(_0x32c766,_0x249870)=>{var _0x1a55a5=a0_0x130251;try{const _0xec1ec2=_0x32c766[_0x1a55a5(0x1f9)]['id'],_0x282509=await transfers[_0x1a55a5(0x167)](_0xec1ec2);_0x249870['json'](_0x32c766[_0x1a55a5(0x15d)]);return;const {date:_0x28d22d,from_warehouse:_0x5ea476,FromRoom_name:_0x2d72a3,to_warehouse:_0x157a76,ToRoom_name:_0x3b5d28,prod_name:_0x43712d,from_prod_qty:_0x4171e2,from_prod_level:_0x178f52,from_prod_isle:_0x5cc3f7,from_prod_pallet:_0x302b55,to_prod_qty:_0xa77dc8,to_prod_level:_0x2e0c14,to_prod_isle:_0x398558,to_prod_pallet:_0x282fc7,primary_code:_0x1ed55a,secondary_code:_0x2e05ab,product_code3:_0x2dee13,note:_0x241b42,invoice:_0x101131,expiry_date:_0x5c77e6}=_0x32c766[_0x1a55a5(0x15d)];if(typeof _0x43712d==_0x1a55a5(0x1c6))var _0x4fab16=[_0x32c766['body'][_0x1a55a5(0x168)]],_0x3e4499=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1f4)]],_0x4589cb=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x219)]],_0x39e974=[_0x32c766[_0x1a55a5(0x15d)]['from_prod_isle']],_0x184a5f=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x207)]],_0x509e9c=[_0x32c766['body']['from_types']],_0x47f93b=[_0x32c766[_0x1a55a5(0x15d)]['to_prod_qty']],_0x104d4b=[_0x32c766[_0x1a55a5(0x15d)]['to_prod_level']],_0x52e9c8=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x228)]],_0x5d65cc=[_0x32c766[_0x1a55a5(0x15d)]['to_prod_pallet']],_0xdc75ec=[_0x32c766['body']['to_types']],_0xaf189d=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x177)]],_0x4f9e69=[_0x32c766['body']['rak']],_0x278d37=[_0x32c766['body'][_0x1a55a5(0x1d0)]],_0x4b93cc=[_0x32c766['body'][_0x1a55a5(0x20d)]],_0x5729d7=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1e9)]],_0x27fa77=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1df)]],_0xeb84b5=[_0x32c766[_0x1a55a5(0x15d)]['unit']],_0x2de03a=[_0x32c766['body'][_0x1a55a5(0x1de)]],_0x361088=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x15c)]],_0x5d276a=[_0x32c766['body'][_0x1a55a5(0x1f5)]],_0x52c42a=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x142)]],_0x385271=[_0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x20b)]];else var _0x4fab16=[..._0x32c766[_0x1a55a5(0x15d)]['prod_name']],_0xaf189d=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x177)]],_0x4f9e69=[..._0x32c766['body']['rak']],_0x509e9c=[..._0x32c766['body'][_0x1a55a5(0x163)]],_0xdc75ec=[..._0x32c766[_0x1a55a5(0x15d)]['to_types']],_0x3e4499=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1f4)]],_0x4589cb=[..._0x32c766['body'][_0x1a55a5(0x219)]],_0x39e974=[..._0x32c766['body']['from_prod_isle']],_0x184a5f=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x207)]],_0x47f93b=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1a0)]],_0x104d4b=[..._0x32c766[_0x1a55a5(0x15d)]['to_prod_level']],_0x52e9c8=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x228)]],_0x5d65cc=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1cb)]],_0x278d37=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1d0)]],_0x4b93cc=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x20d)]],_0x5729d7=[..._0x32c766['body']['product_code3']],_0x27fa77=[..._0x32c766[_0x1a55a5(0x15d)]['MaxStocks_data2']],_0xeb84b5=[..._0x32c766[_0x1a55a5(0x15d)]['unit']],_0x2de03a=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1de)]],_0x361088=[..._0x32c766[_0x1a55a5(0x15d)]['batch_code']],_0x5d276a=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x1f5)]],_0x52c42a=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x142)]],_0x385271=[..._0x32c766[_0x1a55a5(0x15d)][_0x1a55a5(0x20b)]];const _0x37e128=_0x4fab16[_0x1a55a5(0x13d)](_0x1610b2=>{return _0x1610b2={'product_name':_0x1610b2};});_0x3e4499['forEach']((_0x9af939,_0x5c0f0e)=>{var _0x2debf1=_0x1a55a5;_0x37e128[_0x5c0f0e][_0x2debf1(0x145)]=_0x9af939;}),_0x4589cb['forEach']((_0x4f9a57,_0x22060b)=>{var _0x513d5e=_0x1a55a5;_0x37e128[_0x22060b][_0x513d5e(0x210)]=_0x4f9a57;}),_0x39e974['forEach']((_0x27a7f0,_0xb25d6)=>{_0x37e128[_0xb25d6]['from_bin']=_0x27a7f0;}),_0x184a5f[_0x1a55a5(0x1da)]((_0x5a159c,_0x1db675)=>{var _0x5750b0=_0x1a55a5;_0x37e128[_0x1db675][_0x5750b0(0x213)]=_0x5a159c;}),_0x47f93b[_0x1a55a5(0x1da)]((_0x55ded7,_0x3c9177)=>{var _0x120127=_0x1a55a5;_0x37e128[_0x3c9177][_0x120127(0x231)]=_0x55ded7;}),_0x104d4b['forEach']((_0xd1b630,_0x229cf9)=>{var _0x1c00e7=_0x1a55a5;_0x37e128[_0x229cf9][_0x1c00e7(0x170)]=_0xd1b630;}),_0x52e9c8[_0x1a55a5(0x1da)]((_0xf6eddf,_0x27f3ab)=>{var _0x334ae2=_0x1a55a5;_0x37e128[_0x27f3ab][_0x334ae2(0x1a5)]=_0xf6eddf;}),_0x5d65cc[_0x1a55a5(0x1da)]((_0x28ff97,_0x16810a)=>{_0x37e128[_0x16810a]['to_floorlevel']=_0x28ff97;}),_0x278d37[_0x1a55a5(0x1da)]((_0x50ff49,_0x28fd04)=>{var _0x495122=_0x1a55a5;_0x37e128[_0x28fd04][_0x495122(0x1d0)]=_0x50ff49;}),_0x4b93cc[_0x1a55a5(0x1da)]((_0x598c7e,_0x5761a1)=>{var _0x558c88=_0x1a55a5;_0x37e128[_0x5761a1][_0x558c88(0x20d)]=_0x598c7e;}),_0x5729d7['forEach']((_0x4762b3,_0x3439e2)=>{var _0x365302=_0x1a55a5;_0x37e128[_0x3439e2][_0x365302(0x174)]=_0x4762b3;}),_0x27fa77[_0x1a55a5(0x1da)]((_0x2c1aab,_0x4bcf85)=>{var _0x3c0710=_0x1a55a5;_0x37e128[_0x4bcf85][_0x3c0710(0x1a7)]=_0x2c1aab;}),_0xeb84b5[_0x1a55a5(0x1da)]((_0x56e8fa,_0x3ba117)=>{var _0x480c26=_0x1a55a5;_0x37e128[_0x3ba117][_0x480c26(0x1a1)]=_0x56e8fa;}),_0x2de03a[_0x1a55a5(0x1da)]((_0x223298,_0x3f62f1)=>{var _0xd6a079=_0x1a55a5;_0x37e128[_0x3f62f1][_0xd6a079(0x1de)]=_0x223298;}),_0x361088[_0x1a55a5(0x1da)]((_0x510338,_0x4e3837)=>{_0x37e128[_0x4e3837]['batch_code']=_0x510338;}),_0x5d276a['forEach']((_0x15ded2,_0xe2a277)=>{_0x37e128[_0xe2a277]['expiry_date']=_0x15ded2;}),_0xaf189d[_0x1a55a5(0x1da)]((_0x1fcfa3,_0x291eab)=>{var _0x4309b6=_0x1a55a5;_0x37e128[_0x291eab][_0x4309b6(0x177)]=_0x1fcfa3;}),_0x4f9e69[_0x1a55a5(0x1da)]((_0x455b68,_0x48dc1f)=>{var _0x234987=_0x1a55a5;_0x37e128[_0x48dc1f][_0x234987(0x232)]=_0x455b68;}),_0x509e9c[_0x1a55a5(0x1da)]((_0x5008f0,_0xf15fdc)=>{_0x37e128[_0xf15fdc]['from_types']=_0x5008f0;}),_0xdc75ec[_0x1a55a5(0x1da)]((_0x5ad740,_0x41fe5b)=>{var _0x2406c4=_0x1a55a5;_0x37e128[_0x41fe5b][_0x2406c4(0x17d)]=_0x5ad740;}),_0x52c42a['forEach']((_0x4535ea,_0x31aecc)=>{var _0x591c51=_0x1a55a5;_0x37e128[_0x31aecc][_0x591c51(0x142)]=_0x4535ea;}),_0x385271[_0x1a55a5(0x1da)]((_0xc18e5a,_0xc79c95)=>{_0x37e128[_0xc79c95]['from_rack']=_0xc18e5a;});const _0x4f5bcb=_0x37e128['filter'](_0x18e986=>_0x18e986[_0x1a55a5(0x231)]!=='0'&&_0x18e986[_0x1a55a5(0x231)]!==''||_0x18e986[_0x1a55a5(0x159)]!=='0'&&_0x18e986['to_floorlevel']!=='');var _0x26bbf8=0x0;_0x4f5bcb[_0x1a55a5(0x1da)](_0x3bb801=>{var _0x1c918e=_0x1a55a5;parseInt(_0x3bb801[_0x1c918e(0x145)])<parseInt(_0x3bb801['to_quantity'])&&_0x26bbf8++;});if(_0x26bbf8!=0x0)return _0x32c766['flash'](_0x1a55a5(0x180),_0x1a55a5(0x224)),_0x249870[_0x1a55a5(0x13a)](_0x1a55a5(0x1ae));const _0x1c879d=await warehouse[_0x1a55a5(0x22f)]({'name':_0x282509[_0x1a55a5(0x1bc)],'room':_0x282509[_0x1a55a5(0x1c2)]});_0x282509[_0x1a55a5(0x217)][_0x1a55a5(0x1da)](_0x55ac17=>{var _0x2b733d=_0x1a55a5;if(_0x55ac17[_0x2b733d(0x231)]>0x0){const _0x1c3127=_0x1c879d[_0x2b733d(0x166)][_0x2b733d(0x13d)](_0x5d9a97=>{var _0x3937c1=_0x2b733d;_0x5d9a97[_0x3937c1(0x187)]==_0x55ac17[_0x3937c1(0x187)]&&_0x5d9a97[_0x3937c1(0x157)]==_0x55ac17[_0x3937c1(0x213)]&&_0x5d9a97['type']==_0x55ac17['from_types']&&_0x5d9a97[_0x3937c1(0x1b6)]==_0x55ac17[_0x3937c1(0x1d6)]&&_0x5d9a97[_0x3937c1(0x209)]==_0x55ac17['from_bay']&&_0x5d9a97[_0x3937c1(0x232)]==_0x55ac17[_0x3937c1(0x1ec)]&&_0x5d9a97[_0x3937c1(0x177)]==_0x55ac17['from_storage']&&(_0x5d9a97['product_stock']=parseInt(_0x5d9a97[_0x3937c1(0x16a)])+parseInt(_0x55ac17['to_quantity']));});}}),await _0x1c879d[_0x1a55a5(0x227)]();const _0x527946=await warehouse[_0x1a55a5(0x22f)]({'name':_0x282509[_0x1a55a5(0x1e8)],'room':_0x282509[_0x1a55a5(0x1aa)]});_0x282509['product'][_0x1a55a5(0x1da)](_0x5dd1de=>{var _0x378d50=_0x1a55a5;if(_0x5dd1de[_0x378d50(0x231)]>0x0){const _0x5c875e=_0x527946[_0x378d50(0x166)][_0x378d50(0x13d)](_0x38f128=>{var _0x2ac034=_0x378d50;_0x38f128[_0x2ac034(0x187)]==_0x5dd1de[_0x2ac034(0x187)]&&_0x38f128['floorlevel']==_0x5dd1de[_0x2ac034(0x159)]&&_0x38f128[_0x2ac034(0x195)]==_0x5dd1de['to_types']&&_0x38f128[_0x2ac034(0x1b6)]==_0x5dd1de['to_bin']&&_0x38f128[_0x2ac034(0x209)]==_0x5dd1de[_0x2ac034(0x170)]&&_0x38f128[_0x2ac034(0x232)]==_0x5dd1de[_0x2ac034(0x232)]&&_0x38f128['storage']==_0x5dd1de[_0x2ac034(0x177)]&&(_0x38f128[_0x2ac034(0x16a)]=parseInt(_0x38f128['product_stock'])-parseInt(_0x5dd1de[_0x2ac034(0x231)]));});}}),await _0x527946[_0x1a55a5(0x227)](),_0x282509[_0x1a55a5(0x1ef)]=_0x28d22d,_0x282509[_0x1a55a5(0x1bc)]=_0x5ea476,_0x282509[_0x1a55a5(0x1e8)]=_0x157a76,_0x282509[_0x1a55a5(0x217)]=_0x4f5bcb,_0x282509[_0x1a55a5(0x1b9)]=_0x241b42,_0x282509['invoice']=_0x101131;const _0x56415d=await _0x282509[_0x1a55a5(0x227)]();console[_0x1a55a5(0x16d)](_0x56415d);const _0x370160=await warehouse[_0x1a55a5(0x22f)]({'name':_0x5ea476,'room':_0x2d72a3});_0x56415d[_0x1a55a5(0x217)][_0x1a55a5(0x1da)](_0x21979f=>{var _0x1b3780=_0x1a55a5;if(_0x21979f[_0x1b3780(0x231)]>0x0){const _0x40269c=_0x370160[_0x1b3780(0x166)][_0x1b3780(0x13d)](_0x1fa1a2=>{var _0x4bd8e5=_0x1b3780;_0x1fa1a2['product_name']==_0x21979f[_0x4bd8e5(0x187)]&&_0x1fa1a2[_0x4bd8e5(0x157)]==_0x21979f[_0x4bd8e5(0x213)]&&_0x1fa1a2[_0x4bd8e5(0x195)]==_0x21979f[_0x4bd8e5(0x163)]&&_0x1fa1a2[_0x4bd8e5(0x1b6)]==_0x21979f[_0x4bd8e5(0x1d6)]&&_0x1fa1a2['bay']==_0x21979f[_0x4bd8e5(0x210)]&&_0x1fa1a2[_0x4bd8e5(0x232)]==_0x21979f['from_rack']&&_0x1fa1a2[_0x4bd8e5(0x177)]==_0x21979f[_0x4bd8e5(0x142)]&&(_0x1fa1a2[_0x4bd8e5(0x16a)]=parseInt(_0x1fa1a2[_0x4bd8e5(0x16a)])-parseInt(_0x21979f[_0x4bd8e5(0x231)]));});}}),await _0x370160[_0x1a55a5(0x227)]();const _0x47a8f4=await warehouse[_0x1a55a5(0x22f)]({'name':_0x157a76,'room':_0x3b5d28});_0x56415d['product'][_0x1a55a5(0x1da)](_0x3e5d15=>{var _0x299c2d=_0x1a55a5;if(_0x3e5d15['to_quantity']>0x0){var _0xcfe815=0x0;const _0x1ef657=_0x47a8f4[_0x299c2d(0x166)][_0x299c2d(0x13d)](_0x38e029=>{var _0x33e34e=_0x299c2d;_0x38e029[_0x33e34e(0x187)]==_0x3e5d15[_0x33e34e(0x187)]&&_0x38e029[_0x33e34e(0x157)]==_0x3e5d15[_0x33e34e(0x159)]&&_0x38e029['type']==_0x3e5d15[_0x33e34e(0x17d)]&&_0x38e029[_0x33e34e(0x1b6)]==_0x3e5d15[_0x33e34e(0x1a5)]&&_0x38e029['bay']==_0x3e5d15[_0x33e34e(0x170)]&&_0x38e029[_0x33e34e(0x232)]==_0x3e5d15['rack']&&_0x38e029['storage']==_0x3e5d15[_0x33e34e(0x177)]&&(_0x38e029[_0x33e34e(0x16a)]=parseInt(_0x38e029[_0x33e34e(0x16a)])+parseInt(_0x3e5d15['to_quantity']),_0xcfe815++);});_0xcfe815=='0'&&(_0x47a8f4[_0x299c2d(0x166)]=_0x47a8f4[_0x299c2d(0x166)][_0x299c2d(0x1ac)]({'product_name':_0x3e5d15['product_name'],'product_stock':_0x3e5d15[_0x299c2d(0x231)],'bay':_0x3e5d15['to_bay'],'bin':_0x3e5d15[_0x299c2d(0x1a5)],'type':_0x3e5d15[_0x299c2d(0x17d)],'floorlevel':_0x3e5d15[_0x299c2d(0x159)],'storage':_0x3e5d15[_0x299c2d(0x177)],'rack':_0x3e5d15[_0x299c2d(0x232)],'product_code':_0x3e5d15[_0x299c2d(0x174)],'primary_code':_0x3e5d15['primary_code'],'secondary_code':_0x3e5d15['secondary_code'],'maxProducts':_0x3e5d15['maxProducts'],'storage':_0x3e5d15[_0x299c2d(0x177)],'rack':_0x3e5d15[_0x299c2d(0x232)]}));}}),await _0x47a8f4[_0x1a55a5(0x227)](),_0x32c766['flash'](_0x1a55a5(0x15f),_0x1a55a5(0x1ed)),_0x249870[_0x1a55a5(0x13a)](_0x1a55a5(0x21d));}catch(_0x3657cb){console[_0x1a55a5(0x16d)](_0x3657cb);}}),router[a0_0x130251(0x1a2)](a0_0x130251(0x1e7),async(_0x3ed009,_0x5f2add)=>{var _0x9c0111=a0_0x130251;const {FromWareHouse:_0x4989ab,FromRoom:_0x407f4e,ToWarehouse:_0x11024d,ToRoom:_0x1987b1,primary_code:_0xac220e,Roomslist:_0x1a97c2}=_0x3ed009[_0x9c0111(0x15d)],_0x152905=_0x1a97c2[_0x9c0111(0x21b)](','),_0x28a6d5=[];async function _0x12436a(_0x3846e0){var _0x324b4d=_0x9c0111;const _0x54a65b=await warehouse[_0x324b4d(0x15e)]([{'$match':{'name':_0x4989ab,'room':_0x3846e0}},{'$unwind':_0x324b4d(0x1c0)},{'$match':{'product_details.primary_code':_0xac220e}},{'$group':{'_id':_0x324b4d(0x1dc),'name':{'$first':_0x324b4d(0x175)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x324b4d(0x19e)},'product_code':{'$first':_0x324b4d(0x1bf)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x324b4d(0x161)},'unit':{'$first':_0x324b4d(0x1bb)},'secondary_unit':{'$first':_0x324b4d(0x148)},'storage':{'$first':_0x324b4d(0x194)},'rack':{'$first':_0x324b4d(0x14a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x324b4d(0x229)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x324b4d(0x1ad)},'maxProducts':{'$first':_0x324b4d(0x144)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x4481a3=await warehouse['aggregate']([{'$match':{'name':_0x4989ab,'room':_0x3846e0}},{'$unwind':_0x324b4d(0x1c0)},{'$match':{'product_details.secondary_code':_0xac220e}},{'$group':{'_id':_0x324b4d(0x1dc),'name':{'$first':_0x324b4d(0x175)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x324b4d(0x1dd)},'secondary_code':{'$first':_0x324b4d(0x19e)},'product_code':{'$first':_0x324b4d(0x1bf)},'level':{'$first':_0x324b4d(0x1bd)},'isle':{'$first':_0x324b4d(0x21a)},'type':{'$first':_0x324b4d(0x1b1)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x324b4d(0x1bb)},'secondary_unit':{'$first':_0x324b4d(0x148)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x324b4d(0x14a)},'expiry_date':{'$first':_0x324b4d(0x1b7)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x324b4d(0x1b3)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x324b4d(0x1ad)},'maxProducts':{'$first':_0x324b4d(0x144)},'invoice_product':{'$first':_0x324b4d(0x14c)}}}]);if(_0x54a65b[_0x324b4d(0x1d2)]>0x0)_0x28a6d5[_0x324b4d(0x192)](_0x54a65b);else _0x4481a3[_0x324b4d(0x1d2)]>0x0&&_0x28a6d5[_0x324b4d(0x192)](_0x4481a3);}const _0x130e85=_0x152905[_0x9c0111(0x13d)](_0x1a94de=>_0x12436a(_0x1a94de));await Promise[_0x9c0111(0x201)](_0x130e85),_0x5f2add[_0x9c0111(0x1d3)](_0x28a6d5);}),router[a0_0x130251(0x1a2)](a0_0x130251(0x1b2),async(_0x3c2cb7,_0x2ba57f)=>{var _0x1bf497=a0_0x130251;try{const {FromWareHouse:_0x1f5594,FromRoom:_0x75488b,ToWarehouse:_0x1f564d,ToRoom:_0x236f8f,secondary_code:_0x283146}=_0x3c2cb7[_0x1bf497(0x15d)],_0x98705d=await warehouse['aggregate']([{'$match':{'name':_0x1f5594}},{'$unwind':_0x1bf497(0x1c0)},{'$match':{'product_details.secondary_code':_0x283146}},{'$group':{'_id':_0x1bf497(0x1dc),'name':{'$first':_0x1bf497(0x175)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1bf497(0x1bf)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x1bf497(0x1d8)},'level':{'$first':_0x1bf497(0x14e)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x1bf497(0x144)},'unit':{'$first':_0x1bf497(0x1bb)}}}]);_0x2ba57f[_0x1bf497(0x1e2)](0xc8)['json'](_0x98705d);}catch(_0xb2128e){_0x2ba57f[_0x1bf497(0x1e2)](0x194)[_0x1bf497(0x1d3)]({'message':_0xb2128e[_0x1bf497(0x1eb)]});}}),router['post'](a0_0x130251(0x1b8),async(_0x17f6d1,_0x21af24)=>{var _0x3b14d1=a0_0x130251;try{const {FromWareHouse:_0x29310d,FromRoom:_0x3daecd,ToWarehouse:_0x5f5ad5,ToRoom:_0x45d98e,product_code:_0x536339}=_0x17f6d1[_0x3b14d1(0x15d)],_0x19c30c=await warehouse[_0x3b14d1(0x15e)]([{'$match':{'name':_0x29310d}},{'$unwind':_0x3b14d1(0x1c0)},{'$match':{'product_details.product_code':_0x536339}},{'$group':{'_id':_0x3b14d1(0x1dc),'name':{'$first':_0x3b14d1(0x175)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3b14d1(0x19e)},'product_code':{'$first':_0x3b14d1(0x1bf)},'instock':{'$first':_0x3b14d1(0x190)},'warehouse':{'$first':_0x3b14d1(0x1d8)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x3b14d1(0x183)},'maxProducts':{'$first':_0x3b14d1(0x144)},'unit':{'$first':'$product_details.unit'}}}]);_0x21af24[_0x3b14d1(0x1e2)](0xc8)['json'](_0x19c30c);}catch(_0x3a0147){_0x21af24[_0x3b14d1(0x1e2)](0x194)[_0x3b14d1(0x1d3)]({'message':_0x3a0147[_0x3b14d1(0x1eb)]});}}),router['post'](a0_0x130251(0x17e),async(_0x5ba4d2,_0x4edb45)=>{var _0x578549=a0_0x130251;const {level:_0x2295aa,isle:_0x3a89bb,pallet:_0x9a6488,warehouses:_0x32fa67,room:_0x4792f7}=_0x5ba4d2['body'];try{const _0x284601=await warehouse[_0x578549(0x15e)]([{'$match':{'name':_0x32fa67,'room':_0x4792f7}},{'$unwind':_0x578549(0x1c0)},{'$match':{'product_details.level':parseInt(_0x2295aa),'product_details.isle':_0x3a89bb,'product_details.pallet':parseInt(_0x9a6488)}},{'$group':{'_id':_0x578549(0x1dc),'name':{'$first':_0x578549(0x175)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x578549(0x14e)},'isle':{'$first':_0x578549(0x173)},'pallet':{'$first':_0x578549(0x183)},'maxProducts':{'$first':_0x578549(0x144)}}}]);_0x4edb45[_0x578549(0x1e2)](0xc8)[_0x578549(0x1d3)](_0x284601);}catch(_0x57e2ca){_0x4edb45['status'](0x194)[_0x578549(0x1d3)]({'message':_0x57e2ca[_0x578549(0x1eb)]});}}),module[a0_0x130251(0x17a)]=router;