var a0_0x49fba4=a0_0x4fda;(function(_0x41c2fc,_0x1b5edb){var _0x4ff218=a0_0x4fda,_0x3c9713=_0x41c2fc();while(!![]){try{var _0xcb7054=parseInt(_0x4ff218(0xf9))/0x1*(-parseInt(_0x4ff218(0x127))/0x2)+parseInt(_0x4ff218(0xff))/0x3+-parseInt(_0x4ff218(0x164))/0x4+-parseInt(_0x4ff218(0xec))/0x5+parseInt(_0x4ff218(0x10f))/0x6+parseInt(_0x4ff218(0xdb))/0x7*(parseInt(_0x4ff218(0x173))/0x8)+parseInt(_0x4ff218(0xd2))/0x9*(parseInt(_0x4ff218(0x19e))/0xa);if(_0xcb7054===_0x1b5edb)break;else _0x3c9713['push'](_0x3c9713['shift']());}catch(_0x14698c){_0x3c9713['push'](_0x3c9713['shift']());}}}(a0_0xffed,0x1c2ed));const express=require(a0_0x49fba4(0x12b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x49fba4(0x13d)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x49fba4(0x115));router[a0_0x49fba4(0x148)](a0_0x49fba4(0xbd),auth,async(_0x21aa2e,_0x5e4129)=>{var _0x446c47=a0_0x49fba4;try{const {username:_0x5a0844,email:_0x41fa8b,role:_0x195cbe}=_0x21aa2e[_0x446c47(0xf8)],_0x25b084=_0x21aa2e[_0x446c47(0xf8)],_0x3eb0ad=await profile[_0x446c47(0x152)]({'email':_0x25b084[_0x446c47(0x180)]}),_0x533a84=await master_shop[_0x446c47(0xc7)]();console[_0x446c47(0x178)]('master',_0x533a84);let _0x412f39;if(_0x25b084[_0x446c47(0x138)]==_0x446c47(0x182)){const _0x55099f=await staff[_0x446c47(0x152)]({'email':_0x25b084[_0x446c47(0x180)]});_0x412f39=await transfers[_0x446c47(0xc7)]({'from_warehouse':_0x55099f['warehouse']});}else _0x412f39=await transfers[_0x446c47(0x15d)]([{'$unwind':_0x446c47(0x145)},{'$group':{'_id':'$_id','invoice':{'$first':_0x446c47(0x18e)},'date':{'$first':_0x446c47(0x142)},'from_warehouse':{'$first':_0x446c47(0x131)},'to_warehouse':{'$first':_0x446c47(0x12f)},'from_room_name':{'$addToSet':_0x446c47(0xd1)},'to_room_name':{'$addToSet':_0x446c47(0x15f)},'finalize':{'$first':_0x446c47(0xb0)},'isAllowEdit':{'$first':_0x446c47(0x146)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x533a84[0x0]['language']==_0x446c47(0xf7)){var _0x4d15ad=users['English'];console['log'](_0x4d15ad);}else{if(_0x533a84[0x0]['language']==_0x446c47(0x195))var _0x4d15ad=users[_0x446c47(0x195)];else{if(_0x533a84[0x0]['language']=='German')var _0x4d15ad=users['German'];else{if(_0x533a84[0x0][_0x446c47(0x165)]==_0x446c47(0xef))var _0x4d15ad=users['Spanish'];else{if(_0x533a84[0x0]['language']==_0x446c47(0x19b))var _0x4d15ad=users['French'];else{if(_0x533a84[0x0][_0x446c47(0x165)]==_0x446c47(0x149))var _0x4d15ad=users['Portuguese'];else{if(_0x533a84[0x0][_0x446c47(0x165)]==_0x446c47(0xfb))var _0x4d15ad=users['Chinese'];else{if(_0x533a84[0x0]['language']==_0x446c47(0x181))var _0x4d15ad=users[_0x446c47(0x157)];}}}}}}}_0x5e4129[_0x446c47(0x171)]('transfer',{'success':_0x21aa2e['flash'](_0x446c47(0xed)),'errors':_0x21aa2e[_0x446c47(0xd9)]('errors'),'role':_0x25b084,'profile':_0x3eb0ad,'master_shop':_0x533a84,'transfer':_0x412f39,'language':_0x4d15ad});}catch(_0x3a801f){console[_0x446c47(0x178)](_0x3a801f);}});function a0_0xffed(){var _0x20645c=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','489624RFlIrB','to_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.bay','error','product','nodemailer','$product_details.batch_code','maxperunit','body','Receiving\x20Area','exports','bin','An\x20error\x20occurred\x20while\x20saving\x20data.','\x20Order\x20Number\x20:\x20','filter','to_room_name','rack','Ambient','</tbody>','An\x20error\x20occurred.','TRF-','Enabled','/picking_list/PDF_transfer_rm/','1474IIYJRq','logo','Portuguese','bay','express','Rack\x20F','from_prod_level','Floor','$to_warehouse','to_invoice','$from_warehouse','batch_code','<h5>','length','$product_details.product_stock','Rack\x20A','Rack\x20D','role','then','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_prod_qty','../middleware/auth','from_rack','to_prod_pallet','$product_details.product_name','post','$date','prod_name','Rack\x20B','$product','$isAllowEdit','<tr>','get','Portuguese\x20(BR)','from_types','$product_details.type','errors','max_per_unit','message','\x20</h2>','push','from_prod_isle','findOne','rak','$product_details.unit','to_prod_level','to_floorlevel','Arabic','json','\x20Order\x20Date\x20:\x20','$product_details.floorlevel','random','RoomAssigned','aggregate','/view/add_transfer','$product.to_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','site_title','/transfer/view','to_prod_isle','554088jMcfAp','language','English','/view/:id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','forEach','</span>','createTransport','password','ToRoomAssigned','</head><body>','Logo.png','$product_details.level','render','$room','881128ceNFON','$product_details.rack','secondary_code','to_prod_qty','from_bin','log','MaxStocks_data2','Return\x20Rooms','warehouse','floorlevel','map','<h2>\x20','</td>','email','Arabic\x20(ae)','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','all','<hr\x20class=\x22my-3\x22>','$product_details.maxProducts','Error\x20Occurs','Rack\x20C','floor','Shelves','catch','save','to_bin','$invoice','to_warehouse','split','getFullYear','to_quantity','production_date','from_quantity','Hindi','</body></html>','</div>','</h5>','True','$product_details','French','from_bay','add_transfer','215210mgLYvZ','Enclosed','expiry_date','Raw\x20Materials','getMonth','<strong>\x20Regards\x20</strong>','$finalize','product_code3','from_storage','status','back','unit','concat','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.primary_code','from_floorlevel','secondary_unit','German','$product_details.product_code','/view','<div>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<span\x20style=\x22float:\x20right;\x22>','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.isle','$product_details.secondary_unit','maxProducts','New_Qty_Converted','find','params','product_details','</thead>','primary_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','master','date','from_warehouse','from_room_name','$product.from_room_name','27BkfSVJ','Product\x20Transfer\x20successfully','Transfer\x20Finalize\x20Successfully','$product_details.pallet','slice','to_types','</tr>','flash','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','14wkDwaq','/preview/:id','/barcode_scanner3','edit_transfer','finalize','</table>','<tbody\x20style=\x22text-align:\x20center;\x22>','storage','product_name','product_stock','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','invoice','$product_details.production_date','$product_details.storage','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','getDate','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','992210ycBNaz','success','redirect','Spanish','Rack\x20E','type','/upload/','_id','<html><head><title></title>','$name','Level','English\x20(US)','user','70lMaRqA','from_prod_pallet','Chinese','/../public','/barcode_scanner','product_code','412626ZOVJKy','findById','from_invoice','$product_details.bin','RMSEmail','primary_unit','prod_cat','to_room','$product_details._id','Transfer\x20Mail','string','COLD\x20STORAGE','$product_details.expiry_date','image','from_rak'];a0_0xffed=function(){return _0x20645c;};return a0_0xffed();}async function getRandom8DigitNumber(){var _0x41044a=a0_0x49fba4;const _0x190b09=0x989680,_0x4a4d75=0x5f5e0ff,_0x183bf0=Math[_0x41044a(0x189)](Math[_0x41044a(0x15b)]()*(_0x4a4d75-_0x190b09+0x1))+_0x190b09;var _0x13d8fe;const _0x45ccfa=await transfers[_0x41044a(0x152)]({'invoice':_0x41044a(0x124)+_0x183bf0});return _0x45ccfa&&_0x45ccfa[_0x41044a(0x134)]>0x0?_0x13d8fe=_0x41044a(0x124)+_0x183bf0:_0x13d8fe=_0x41044a(0x124)+_0x183bf0,_0x13d8fe;}function a0_0x4fda(_0x31a3f8,_0x3584c2){var _0xffeda9=a0_0xffed();return a0_0x4fda=function(_0x4fda99,_0x247796){_0x4fda99=_0x4fda99-0xac;var _0x4a864e=_0xffeda9[_0x4fda99];return _0x4a864e;},a0_0x4fda(_0x31a3f8,_0x3584c2);}router['get'](a0_0x49fba4(0x15e),auth,async(_0xd49ea7,_0x58c3fe)=>{var _0x66751b=a0_0x49fba4;try{const {username:_0x1730d1,email:_0x535060,role:_0x29c04d}=_0xd49ea7['user'],_0xd4b0e7=_0xd49ea7[_0x66751b(0xf8)],_0x154eb6=await profile[_0x66751b(0x152)]({'email':_0xd4b0e7[_0x66751b(0x180)]}),_0x27cfb8=await master_shop[_0x66751b(0xc7)]();console[_0x66751b(0x178)](_0x66751b(0xcd),_0x27cfb8);let _0x102304;if(_0xd4b0e7[_0x66751b(0x138)]==_0x66751b(0x182)){const _0x272494=await staff['findOne']({'email':_0xd4b0e7[_0x66751b(0x180)]});_0x102304=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x272494[_0x66751b(0x17b)],'warehouse_category':_0x66751b(0xad)}},{'$group':{'_id':_0x66751b(0xf5),'name':{'$first':_0x66751b(0xf5)}}}]);}else _0x102304=await warehouse['aggregate']([{'$match':{'status':_0x66751b(0x125),'warehouse_category':_0x66751b(0xad)}},{'$group':{'_id':_0x66751b(0xf5),'name':{'$first':_0x66751b(0xf5)}}}]);var _0x1e27b9=[_0x66751b(0x121),_0x66751b(0x19f),_0x66751b(0x17a)];const _0x448273=await transfers[_0x66751b(0xc7)]({}),_0x3515bf=_0x448273[_0x66751b(0x134)]+0x1,_0x2c8f78=_0x66751b(0x124)+_0x3515bf['toString']()['padStart'](0x5,'0');if(_0x27cfb8[0x0]['language']==_0x66751b(0xf7)){var _0x29d147=users[_0x66751b(0x166)];console['log'](_0x29d147);}else{if(_0x27cfb8[0x0]['language']==_0x66751b(0x195))var _0x29d147=users[_0x66751b(0x195)];else{if(_0x27cfb8[0x0][_0x66751b(0x165)]==_0x66751b(0xbb))var _0x29d147=users[_0x66751b(0xbb)];else{if(_0x27cfb8[0x0][_0x66751b(0x165)]=='Spanish')var _0x29d147=users[_0x66751b(0xef)];else{if(_0x27cfb8[0x0][_0x66751b(0x165)]==_0x66751b(0x19b))var _0x29d147=users[_0x66751b(0x19b)];else{if(_0x27cfb8[0x0][_0x66751b(0x165)]==_0x66751b(0x149))var _0x29d147=users[_0x66751b(0x129)];else{if(_0x27cfb8[0x0]['language']=='Chinese')var _0x29d147=users['Chinese'];else{if(_0x27cfb8[0x0][_0x66751b(0x165)]==_0x66751b(0x181))var _0x29d147=users[_0x66751b(0x157)];}}}}}}}const _0x51326f=getRandom8DigitNumber();_0x51326f[_0x66751b(0x139)](_0x2149de=>{var _0x1d8e41=_0x66751b;_0x58c3fe['render'](_0x1d8e41(0x19d),{'success':_0xd49ea7['flash'](_0x1d8e41(0xed)),'errors':_0xd49ea7['flash'](_0x1d8e41(0x14c)),'role':_0xd4b0e7,'profile':_0x154eb6,'master_shop':_0x27cfb8,'warehouse':_0x102304,'language':_0x29d147,'rooms_data':_0x1e27b9,'invoice':_0x2149de});})[_0x66751b(0x18b)](_0x30e0d2=>{var _0x5abea5=_0x66751b;_0xd49ea7[_0x5abea5(0xd9)](_0x5abea5(0x14c),_0x5abea5(0xcc)),_0x58c3fe['redirect'](_0x5abea5(0x162));});}catch(_0xa62ad8){console[_0x66751b(0x178)](_0xa62ad8);}}),router['post'](a0_0x49fba4(0x15e),auth,async(_0x517f18,_0x2f4be2)=>{var _0xe81b5=a0_0x49fba4;try{console[_0xe81b5(0x178)](_0x517f18[_0xe81b5(0x118)]);const {date:_0x4d2dbb,from_warehouse:_0x10551b,FromRoom_name:_0x179e14,to_warehouse:_0x5e3de1,ToRoom_name:_0x416168,prod_name:_0x1a2fb8,from_prod_qty:_0x21c43b,from_prod_level:_0xaaf555,from_prod_isle:_0x48232f,from_prod_pallet:_0x5cbdf3,to_prod_qty:_0x5e91d2,to_prod_level:_0xb7326a,to_prod_isle:_0x3d5d21,to_prod_pallet:_0x724067,primary_code:_0xc346c6,secondary_code:_0xc49d31,product_code3:_0x2f5b25,note:_0x43af64,MaxStocks_data2:_0xbd79fb,invoice:_0x369565,expiry_date:_0x2e9a14}=_0x517f18[_0xe81b5(0x118)];if(typeof _0x1a2fb8==_0xe81b5(0x109))var _0x385381=[_0x517f18[_0xe81b5(0x118)]['prod_name']],_0xde7da7=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x13c)]],_0x5a01ca=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x12d)]],_0x5e2694=[_0x517f18['body'][_0xe81b5(0xc6)]],_0x58d023=[_0x517f18['body'][_0xe81b5(0x155)]],_0x48f528=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0xcb)]],_0x42cae0=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x175)]],_0x3de9e3=[_0x517f18['body'][_0xe81b5(0xb1)]],_0x2a2ce4=[_0x517f18['body'][_0xe81b5(0x179)]],_0x21f4ec=[_0x517f18['body'][_0xe81b5(0x104)]],_0x25bf18=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0xba)]],_0x4ac34f=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x132)]],_0x58f51b=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0xac)]],_0x14e2ea=[_0x517f18['body'][_0xe81b5(0x14d)]],_0x270f7f=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x193)]],_0x317747=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x105)]],_0x47ef8e=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x15c)]],_0x364f5e=[_0x517f18['body'][_0xe81b5(0x16d)]],_0x1ec486=[_0x517f18['body']['from_invoice']],_0x125dd4=[_0x517f18[_0xe81b5(0x118)][_0xe81b5(0x130)]];else var _0x385381=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x143)]],_0xde7da7=[..._0x517f18[_0xe81b5(0x118)]['from_prod_qty']],_0x5a01ca=[..._0x517f18['body'][_0xe81b5(0x12d)]],_0x5e2694=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0xc6)]],_0x58d023=[..._0x517f18['body']['to_prod_level']],_0x48f528=[..._0x517f18['body'][_0xe81b5(0xcb)]],_0x42cae0=[..._0x517f18[_0xe81b5(0x118)]['secondary_code']],_0x3de9e3=[..._0x517f18[_0xe81b5(0x118)]['product_code3']],_0x2a2ce4=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x179)]],_0x21f4ec=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x104)]],_0x25bf18=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0xba)]],_0x4ac34f=[..._0x517f18['body']['batch_code']],_0x58f51b=[..._0x517f18['body']['expiry_date']],_0x14e2ea=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x14d)]],_0x270f7f=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x193)]],_0x317747=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x105)]],_0x47ef8e=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x15c)]],_0x364f5e=[..._0x517f18['body'][_0xe81b5(0x16d)]],_0x1ec486=[..._0x517f18[_0xe81b5(0x118)]['from_invoice']],_0x125dd4=[..._0x517f18[_0xe81b5(0x118)][_0xe81b5(0x130)]];const _0x59ff3b=_0x385381[_0xe81b5(0x17d)](_0x2ebd65=>{return _0x2ebd65={'product_name':_0x2ebd65};});_0xde7da7[_0xe81b5(0x169)]((_0x160bea,_0x2f2f30)=>{var _0x4162d3=_0xe81b5;_0x59ff3b[_0x2f2f30][_0x4162d3(0x194)]=_0x160bea;}),_0x1ec486[_0xe81b5(0x169)]((_0x426e2c,_0x5dc7d1)=>{var _0x43b0af=_0xe81b5;_0x59ff3b[_0x5dc7d1][_0x43b0af(0x101)]=_0x426e2c;}),_0x125dd4[_0xe81b5(0x169)]((_0x494945,_0x1e6de7)=>{_0x59ff3b[_0x1e6de7]['To_invoice']=_0x494945;}),_0x5a01ca[_0xe81b5(0x169)]((_0x444b50,_0x47e4b2)=>{var _0x175d2d=_0xe81b5;_0x47ef8e[_0x175d2d(0x169)]((_0x39c25a,_0x34c79b)=>{var _0x3d4ecc=_0x175d2d;if(_0x39c25a==_0x3d4ecc(0x119)&&_0x47e4b2==_0x34c79b){var _0x56da6a=_0x444b50[_0x3d4ecc(0xd6)](0x3);_0x59ff3b[_0x47e4b2][_0x3d4ecc(0xb2)]=_0x444b50[0x0],_0x59ff3b[_0x47e4b2][_0x3d4ecc(0x13e)]=_0x444b50[0x1],_0x59ff3b[_0x47e4b2][_0x3d4ecc(0x19c)]=0x0,_0x59ff3b[_0x47e4b2]['from_bin']=0x0,_0x59ff3b[_0x47e4b2]['from_types']=_0x3d4ecc(0x12e),_0x59ff3b[_0x47e4b2][_0x3d4ecc(0xb9)]=_0x56da6a;}else{if(_0x39c25a=='Shelves'&&_0x47e4b2==_0x34c79b){var _0x56da6a=_0x444b50[_0x3d4ecc(0xd6)](0x3);_0x59ff3b[_0x47e4b2][_0x3d4ecc(0xb2)]=_0x444b50[0x0],_0x59ff3b[_0x47e4b2]['from_rack']=_0x444b50[0x1],_0x59ff3b[_0x47e4b2][_0x3d4ecc(0x19c)]=0x0,_0x59ff3b[_0x47e4b2][_0x3d4ecc(0x177)]=0x0,_0x59ff3b[_0x47e4b2][_0x3d4ecc(0x14a)]=_0x3d4ecc(0x12e),_0x59ff3b[_0x47e4b2]['from_floorlevel']=_0x444b50[0x5];}else{if(_0x47e4b2==_0x34c79b){var _0x504150;if(_0x444b50[0x4]=='L')_0x504150='Level';else _0x444b50[0x4]=='F'&&(_0x504150=_0x3d4ecc(0x12e));_0x59ff3b[_0x47e4b2][_0x3d4ecc(0xb2)]=_0x444b50[0x0],_0x59ff3b[_0x47e4b2][_0x3d4ecc(0x13e)]=_0x444b50[0x1],_0x59ff3b[_0x47e4b2][_0x3d4ecc(0x19c)]=_0x444b50[0x2],_0x59ff3b[_0x47e4b2]['from_bin']=_0x444b50[0x3],_0x59ff3b[_0x47e4b2]['from_types']=_0x504150,_0x59ff3b[_0x47e4b2][_0x3d4ecc(0xb9)]=_0x444b50[0x5];}}}});}),_0x5e2694[_0xe81b5(0x169)]((_0x532ff3,_0x6a6fc9)=>{var _0x32f548=_0xe81b5;_0x59ff3b[_0x6a6fc9][_0x32f548(0x192)]=_0x532ff3;}),_0x58d023['forEach']((_0x38090d,_0x28d9fe)=>{_0x364f5e['forEach']((_0x499b59,_0x22dd77)=>{var _0xf74797=a0_0x4fda;if(_0x499b59==_0xf74797(0x119)&&_0x28d9fe==_0x22dd77){var _0x337141=_0x38090d[_0xf74797(0xd6)](0x3);_0x59ff3b[_0x28d9fe][_0xf74797(0xe2)]=_0x38090d[0x0],_0x59ff3b[_0x28d9fe][_0xf74797(0x120)]=_0x38090d[0x1],_0x59ff3b[_0x28d9fe][_0xf74797(0x110)]=0x0,_0x59ff3b[_0x28d9fe][_0xf74797(0x18d)]=0x0,_0x59ff3b[_0x28d9fe][_0xf74797(0xd7)]='Floor',_0x59ff3b[_0x28d9fe][_0xf74797(0x156)]=_0x337141;}else{if(_0x499b59==_0xf74797(0x18a)&&_0x28d9fe==_0x22dd77){var _0x337141=_0x38090d[_0xf74797(0xd6)](0x3);_0x59ff3b[_0x28d9fe][_0xf74797(0xe2)]=_0x38090d[0x0],_0x59ff3b[_0x28d9fe][_0xf74797(0x120)]=_0x38090d[0x1],_0x59ff3b[_0x28d9fe][_0xf74797(0x110)]=0x0,_0x59ff3b[_0x28d9fe][_0xf74797(0x18d)]=0x0,_0x59ff3b[_0x28d9fe]['to_types']=_0xf74797(0x12e),_0x59ff3b[_0x28d9fe][_0xf74797(0x156)]=_0x38090d[0x5];}else{if(_0x28d9fe==_0x22dd77){var _0x4cbc8f;if(_0x38090d[0x4]=='L')_0x4cbc8f=_0xf74797(0xf6);else _0x38090d[0x4]=='F'&&(_0x4cbc8f=_0xf74797(0x12e));_0x59ff3b[_0x28d9fe][_0xf74797(0xe2)]=_0x38090d[0x0],_0x59ff3b[_0x28d9fe]['rack']=_0x38090d[0x1],_0x59ff3b[_0x28d9fe][_0xf74797(0x110)]=_0x38090d[0x2],_0x59ff3b[_0x28d9fe][_0xf74797(0x18d)]=_0x38090d[0x3],_0x59ff3b[_0x28d9fe]['to_types']=_0x4cbc8f,_0x59ff3b[_0x28d9fe][_0xf74797(0x156)]=_0x38090d[0x5];}}}});}),_0x48f528[_0xe81b5(0x169)]((_0xd85179,_0x1f1e91)=>{var _0x3b9adc=_0xe81b5;_0x59ff3b[_0x1f1e91][_0x3b9adc(0xcb)]=_0xd85179;}),_0x42cae0[_0xe81b5(0x169)]((_0x1dbe89,_0x25e976)=>{var _0xd8838d=_0xe81b5;_0x59ff3b[_0x25e976][_0xd8838d(0x175)]=_0x1dbe89;}),_0x3de9e3['forEach']((_0x426695,_0x24d2dc)=>{var _0x23f1eb=_0xe81b5;_0x59ff3b[_0x24d2dc][_0x23f1eb(0xfe)]=_0x426695;}),_0x2a2ce4[_0xe81b5(0x169)]((_0x3c7f05,_0x1d9745)=>{var _0x2cce15=_0xe81b5;_0x59ff3b[_0x1d9745][_0x2cce15(0xc5)]=_0x3c7f05;}),_0x21f4ec[_0xe81b5(0x169)]((_0x3fdc0d,_0x6293e2)=>{_0x59ff3b[_0x6293e2]['unit']=_0x3fdc0d;}),_0x25bf18[_0xe81b5(0x169)]((_0x1b6f57,_0x20700d)=>{var _0x1667d2=_0xe81b5;_0x59ff3b[_0x20700d][_0x1667d2(0xba)]=_0x1b6f57;}),_0x4ac34f[_0xe81b5(0x169)]((_0x3a682f,_0xb34aab)=>{_0x59ff3b[_0xb34aab]['batch_code']=_0x3a682f;}),_0x58f51b['forEach']((_0x5b4aa6,_0x2daca7)=>{_0x59ff3b[_0x2daca7]['expiry_date']=_0x5b4aa6;}),_0x14e2ea['forEach']((_0x57ec56,_0x2ec2c1)=>{var _0x18fe21=_0xe81b5;_0x59ff3b[_0x2ec2c1][_0x18fe21(0x117)]=_0x57ec56;}),_0x270f7f[_0xe81b5(0x169)]((_0x4ddbb4,_0x1ca588)=>{var _0x5b792f=_0xe81b5;_0x59ff3b[_0x1ca588][_0x5b792f(0x193)]=_0x4ddbb4;}),_0x317747[_0xe81b5(0x169)]((_0xbff138,_0x5f295b)=>{_0x59ff3b[_0x5f295b]['prod_cat']=_0xbff138;}),_0x47ef8e[_0xe81b5(0x169)]((_0x2785d5,_0x90cd54)=>{_0x59ff3b[_0x90cd54]['from_room_name']=_0x2785d5;}),_0x364f5e[_0xe81b5(0x169)]((_0x100619,_0x27bf49)=>{var _0x3133ab=_0xe81b5;_0x59ff3b[_0x27bf49][_0x3133ab(0x11f)]=_0x100619;});const _0x3d9193=_0x59ff3b[_0xe81b5(0x11e)](_0x32bf2c=>_0x32bf2c[_0xe81b5(0x192)]!=='0'&&_0x32bf2c[_0xe81b5(0x192)]!==''||_0x32bf2c['to_floorlevel']!=='0'&&_0x32bf2c[_0xe81b5(0x156)]!==''),_0x469eea=new transfers({'date':_0x4d2dbb,'from_warehouse':_0x10551b,'to_warehouse':_0x5e3de1,'product':_0x3d9193,'note':_0x43af64,'invoice':_0x369565}),_0x13be5c=await _0x469eea[_0xe81b5(0x18c)]();_0x517f18['flash']('success',_0xe81b5(0xd3)),_0x2f4be2['redirect']('/transfer/preview/'+_0x13be5c[_0xe81b5(0xf3)]);}catch(_0x36d283){console['log'](_0x36d283),_0x2f4be2['status'](0xc8)[_0xe81b5(0x158)]({'errorMessage':_0x36d283[_0xe81b5(0x14e)]});}}),router[a0_0x49fba4(0x148)]('/preview/:id',auth,async(_0x3d565,_0x3e5f65)=>{var _0x5821cd=a0_0x49fba4;try{const {username:_0x2fa219,email:_0x366016,role:_0x59c8ee}=_0x3d565[_0x5821cd(0xf8)],_0x4857e5=_0x3d565[_0x5821cd(0xf8)],_0xd5af86=await profile[_0x5821cd(0x152)]({'email':_0x4857e5['email']}),_0x3211c1=await master_shop[_0x5821cd(0xc7)]();console[_0x5821cd(0x178)]('master',_0x3211c1);const _0x473a25=await transfers[_0x5821cd(0x100)](_0x3d565[_0x5821cd(0xc8)]['id']);let _0x1578c1=new Date(_0x473a25[_0x5821cd(0xac)]),_0x420d51=('0'+_0x1578c1[_0x5821cd(0xea)]())[_0x5821cd(0xd6)](-0x2),_0x3c0b2c=('0'+(_0x1578c1[_0x5821cd(0xae)]()+0x1))[_0x5821cd(0xd6)](-0x2),_0x2fb80c=_0x1578c1[_0x5821cd(0x191)](),_0x3ff6eb=_0x2fb80c+'-'+_0x3c0b2c+'-'+_0x420d51,_0x45c6ab;if(_0x4857e5[_0x5821cd(0x138)]==_0x5821cd(0x182)){const _0x526c8b=await staff[_0x5821cd(0x152)]({'email':_0x4857e5[_0x5821cd(0x180)]});_0x45c6ab=await warehouse[_0x5821cd(0xc7)]({'status':_0x5821cd(0x125),'name':_0x526c8b['warehouse'],'warehouse_category':_0x5821cd(0xad)});}else _0x45c6ab=await warehouse[_0x5821cd(0xc7)]({'status':_0x5821cd(0x125),'warehouse_category':_0x5821cd(0xad)});const _0x403473=await warehouse[_0x5821cd(0x15d)]([{'$match':{'name':_0x473a25[_0x5821cd(0xcf)]}},{'$unwind':_0x5821cd(0x19a)},{'$group':{'_id':_0x5821cd(0x107),'name':{'$first':_0x5821cd(0x140)},'product_stock':{'$first':_0x5821cd(0x135)},'bay':{'$first':_0x5821cd(0x112)},'bin':{'$first':_0x5821cd(0x102)},'type':{'$first':_0x5821cd(0x14b)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5821cd(0xc1)},'product_code':{'$first':_0x5821cd(0xbc)},'storage':{'$first':_0x5821cd(0xe8)},'rack':{'$first':_0x5821cd(0x174)},'expiry_date':{'$first':_0x5821cd(0x10b)},'production_date':{'$first':_0x5821cd(0xe7)},'room':{'$first':_0x5821cd(0x172)}}}]);if(_0x3211c1[0x0]['language']==_0x5821cd(0xf7)){var _0xe115fc=users[_0x5821cd(0x166)];console[_0x5821cd(0x178)](_0xe115fc);}else{if(_0x3211c1[0x0][_0x5821cd(0x165)]==_0x5821cd(0x195))var _0xe115fc=users[_0x5821cd(0x195)];else{if(_0x3211c1[0x0]['language']=='German')var _0xe115fc=users[_0x5821cd(0xbb)];else{if(_0x3211c1[0x0][_0x5821cd(0x165)]==_0x5821cd(0xef))var _0xe115fc=users[_0x5821cd(0xef)];else{if(_0x3211c1[0x0][_0x5821cd(0x165)]=='French')var _0xe115fc=users['French'];else{if(_0x3211c1[0x0][_0x5821cd(0x165)]==_0x5821cd(0x149))var _0xe115fc=users[_0x5821cd(0x129)];else{if(_0x3211c1[0x0]['language']==_0x5821cd(0xfb))var _0xe115fc=users[_0x5821cd(0xfb)];else{if(_0x3211c1[0x0][_0x5821cd(0x165)]==_0x5821cd(0x181))var _0xe115fc=users[_0x5821cd(0x157)];}}}}}}}_0x3e5f65[_0x5821cd(0x171)]('edit_transfer_view',{'success':_0x3d565[_0x5821cd(0xd9)](_0x5821cd(0xed)),'errors':_0x3d565[_0x5821cd(0xd9)](_0x5821cd(0x14c)),'role':_0x4857e5,'profile':_0xd5af86,'master_shop':_0x3211c1,'warehouse':_0x45c6ab,'transfer':_0x473a25,'stock':_0x403473,'language':_0xe115fc});}catch(_0x403de8){console[_0x5821cd(0x178)](_0x403de8);}}),router[a0_0x49fba4(0x141)](a0_0x49fba4(0xdc),auth,async(_0x53653d,_0x589d83)=>{var _0x47d11f=a0_0x49fba4;try{const _0x10a718=_0x53653d[_0x47d11f(0xc8)]['id'],{from_warehouse:_0x4beb6e,FromRoom_name:_0x11e123,to_warehouse:_0x9a1b4d,ToRoom_name:_0x3688d2}=_0x53653d['body'],_0x88f6e9=await transfers['findById']({'_id':_0x10a718}),_0x323e74=_0x88f6e9[_0x47d11f(0x114)][_0x47d11f(0x17d)](async _0x4271eb=>{var _0x57263b=_0x47d11f;if(_0x4271eb['to_quantity']>0x0){var _0xd43f21=await warehouse[_0x57263b(0x152)]({'name':_0x88f6e9[_0x57263b(0xcf)],'room':_0x4271eb[_0x57263b(0xd0)],'warehouse_category':_0x57263b(0xad)});const _0x33b531=_0xd43f21[_0x57263b(0xc9)][_0x57263b(0x17d)](_0x1ed64c=>{var _0x49ad3a=_0x57263b;_0x1ed64c[_0x49ad3a(0xe3)]==_0x4271eb[_0x49ad3a(0xe3)]&&_0x1ed64c[_0x49ad3a(0x17c)]==_0x4271eb[_0x49ad3a(0xb9)]&&_0x1ed64c[_0x49ad3a(0xf1)]==_0x4271eb['from_types']&&_0x1ed64c[_0x49ad3a(0x11b)]==_0x4271eb[_0x49ad3a(0x177)]&&_0x1ed64c['bay']==_0x4271eb[_0x49ad3a(0x19c)]&&_0x1ed64c[_0x49ad3a(0x120)]==_0x4271eb[_0x49ad3a(0x13e)]&&_0x1ed64c['storage']==_0x4271eb['from_storage']&&_0x1ed64c[_0x49ad3a(0xac)]==_0x4271eb[_0x49ad3a(0xac)]&&_0x1ed64c['batch_code']==_0x4271eb['batch_code']&&_0x1ed64c['production_date']==_0x4271eb[_0x49ad3a(0x193)]&&_0x1ed64c[_0x49ad3a(0xe6)]==_0x4271eb[_0x49ad3a(0x101)]&&(_0x1ed64c[_0x49ad3a(0xe4)]=_0x1ed64c[_0x49ad3a(0xe4)]-_0x4271eb[_0x49ad3a(0x192)]);});}return _0xd43f21;});Promise[_0x47d11f(0x184)](_0x323e74)[_0x47d11f(0x139)](async _0x1dc460=>{var _0x99e5fe=_0x47d11f;try{for(const _0x222222 of _0x1dc460){await _0x222222['save']();}try{const _0x541927=_0x88f6e9[_0x99e5fe(0x114)][_0x99e5fe(0x17d)](async _0x1cf576=>{var _0xdc6c76=_0x99e5fe;if(_0x1cf576[_0xdc6c76(0x192)]>0x0){var _0x47a674=await warehouse['findOne']({'name':_0x88f6e9[_0xdc6c76(0x18f)],'room':_0x1cf576[_0xdc6c76(0x11f)],'warehouse_category':_0xdc6c76(0xad)}),_0x67862e=0x0;const _0x1e2e2e=_0x47a674[_0xdc6c76(0xc9)][_0xdc6c76(0x17d)](_0x25da54=>{var _0x1e9051=_0xdc6c76;_0x25da54[_0x1e9051(0xe3)]==_0x1cf576[_0x1e9051(0xe3)]&&_0x25da54[_0x1e9051(0x17c)]==_0x1cf576[_0x1e9051(0x156)]&&_0x25da54[_0x1e9051(0xf1)]==_0x1cf576['to_types']&&_0x25da54['bin']==_0x1cf576['to_bin']&&_0x25da54[_0x1e9051(0x12a)]==_0x1cf576[_0x1e9051(0x110)]&&_0x25da54[_0x1e9051(0x120)]==_0x1cf576[_0x1e9051(0x120)]&&_0x25da54[_0x1e9051(0xe2)]==_0x1cf576[_0x1e9051(0xe2)]&&_0x25da54[_0x1e9051(0xac)]==_0x1cf576[_0x1e9051(0xac)]&&_0x25da54[_0x1e9051(0x132)]==_0x1cf576['batch_code']&&_0x25da54[_0x1e9051(0x193)]==_0x1cf576['production_date']&&_0x25da54[_0x1e9051(0xe6)]==_0x1cf576['To_invoice']&&(_0x25da54[_0x1e9051(0xe4)]=_0x25da54[_0x1e9051(0xe4)]+_0x1cf576[_0x1e9051(0x192)],_0x67862e++);});_0x67862e=='0'&&(_0x47a674[_0xdc6c76(0xc9)]=_0x47a674['product_details'][_0xdc6c76(0xb6)]({'product_name':_0x1cf576[_0xdc6c76(0xe3)],'product_stock':_0x1cf576[_0xdc6c76(0x192)],'bay':_0x1cf576[_0xdc6c76(0x110)],'bin':_0x1cf576[_0xdc6c76(0x18d)],'type':_0x1cf576[_0xdc6c76(0xd7)],'floorlevel':_0x1cf576[_0xdc6c76(0x156)],'storage':_0x1cf576[_0xdc6c76(0xe2)],'rack':_0x1cf576['rack'],'product_code':_0x1cf576[_0xdc6c76(0xfe)],'primary_code':_0x1cf576[_0xdc6c76(0xcb)],'secondary_code':_0x1cf576[_0xdc6c76(0x175)],'maxProducts':_0x1cf576[_0xdc6c76(0xc5)],'storage':_0x1cf576[_0xdc6c76(0xe2)],'rack':_0x1cf576['rack'],'expiry_date':_0x1cf576[_0xdc6c76(0xac)],'maxPerUnit':_0x1cf576[_0xdc6c76(0x117)],'batch_code':_0x1cf576[_0xdc6c76(0x132)],'production_date':_0x1cf576[_0xdc6c76(0x193)]}));}return _0x47a674;});Promise[_0x99e5fe(0x184)](_0x541927)['then'](async _0x31fc95=>{var _0x44907f=_0x99e5fe;try{for(const _0x5dc542 of _0x31fc95){await warehouse['updateOne']({'_id':_0x5dc542['_id']},{'$addToSet':{'product_details':{'$each':_0x5dc542[_0x44907f(0xc9)]}}});}_0x88f6e9[_0x44907f(0xdf)]=_0x44907f(0x199);const _0x3ee9bb=await _0x88f6e9['save'](),_0x465bd0=await master_shop[_0x44907f(0xc7)](),_0x3a708b=await email_settings[_0x44907f(0x152)](),_0x5807b4=await supervisor_settings['find']();var _0x569b3a=_0x88f6e9['product'],_0x3dc75a='',_0x524540;for(_0x524540 in _0x569b3a){_0x3dc75a+=_0x44907f(0x147)+_0x44907f(0x168)+_0x569b3a[_0x524540][_0x44907f(0xe3)]+_0x44907f(0x17f)+_0x44907f(0x168)+_0x569b3a[_0x524540][_0x44907f(0xfe)]+_0x44907f(0x17f)+_0x44907f(0x168)+_0x569b3a[_0x524540][_0x44907f(0x192)]+'</td>'+_0x44907f(0x168)+_0x569b3a[_0x524540][_0x44907f(0xb5)]+_0x44907f(0x17f)+_0x44907f(0x168)+_0x569b3a[_0x524540]['secondary_unit']+_0x44907f(0x17f)+_0x44907f(0x168)+_0x88f6e9[_0x44907f(0x18f)]+'</td>'+_0x44907f(0x168)+_0x569b3a[_0x524540][_0x44907f(0x11f)]+_0x44907f(0x17f)+_0x44907f(0x168)+_0x569b3a[_0x524540][_0x44907f(0xe2)]+_0x569b3a[_0x524540]['rack']+_0x569b3a[_0x524540][_0x44907f(0x110)]+_0x569b3a[_0x524540][_0x44907f(0x18d)]+_0x569b3a[_0x524540][_0x44907f(0xd7)][0x0]+_0x569b3a[_0x524540]['to_floorlevel']+_0x44907f(0x17f),_0x44907f(0xd8);}let _0x80eeec=nodemailer[_0x44907f(0x16b)]({'host':_0x3a708b['host'],'port':Number(_0x3a708b['port']),'secure':![],'auth':{'user':_0x3a708b[_0x44907f(0x180)],'pass':_0x3a708b[_0x44907f(0x16c)]}}),_0x2b7c5e={'from':_0x3a708b[_0x44907f(0x180)],'to':_0x5807b4[0x0][_0x44907f(0x103)],'subject':_0x44907f(0x108),'attachments':[{'filename':_0x44907f(0x16f),'path':__dirname+_0x44907f(0xfc)+_0x44907f(0xf2)+_0x465bd0[0x0][_0x44907f(0x10c)],'cid':_0x44907f(0x128)}],'html':'<!DOCTYPE\x20html>'+_0x44907f(0xf4)+_0x44907f(0x16e)+_0x44907f(0xbe)+_0x44907f(0xda)+_0x44907f(0xbe)+_0x44907f(0xe9)+_0x44907f(0x197)+_0x44907f(0xbe)+_0x44907f(0x17e)+_0x465bd0[0x0][_0x44907f(0x161)]+_0x44907f(0x14f)+_0x44907f(0x197)+_0x44907f(0x197)+_0x44907f(0x185)+'<div>'+_0x44907f(0xb7)+_0x44907f(0x11d)+_0x88f6e9['invoice']+'\x20'+_0x44907f(0xc0)+_0x44907f(0x159)+_0x88f6e9[_0x44907f(0xce)]+'\x20'+_0x44907f(0x16a)+'</h5>'+_0x44907f(0x197)+_0x44907f(0xbf)+_0x44907f(0xeb)+_0x44907f(0x147)+_0x44907f(0x13b)+_0x44907f(0x10e)+_0x44907f(0x13a)+_0x44907f(0x111)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x44907f(0x160)+_0x44907f(0xc2)+_0x44907f(0x183)+_0x44907f(0xd8)+_0x44907f(0xca)+_0x44907f(0xe1)+'\x20'+_0x3dc75a+'\x20'+_0x44907f(0x122)+_0x44907f(0xe0)+_0x44907f(0xbe)+_0x44907f(0xaf)+_0x44907f(0x133)+_0x465bd0[0x0][_0x44907f(0x161)]+_0x44907f(0x198)+_0x44907f(0x197)+'</div>'+_0x44907f(0x196)};_0x80eeec['sendMail'](_0x2b7c5e,function(_0x43a6e1,_0x38adfd){var _0x2de408=_0x44907f;_0x43a6e1?(console['log'](_0x43a6e1),console[_0x2de408(0x178)](_0x2de408(0x187))):console[_0x2de408(0x178)]('Email\x20sent\x20successfully');}),_0x53653d[_0x44907f(0xd9)](_0x44907f(0xed),_0x44907f(0xd4)),_0x589d83[_0x44907f(0xee)](_0x44907f(0x126)+_0x3ee9bb[_0x44907f(0xf3)]);}catch(_0x3991b3){console[_0x44907f(0x113)](_0x3991b3),_0x589d83[_0x44907f(0xb3)](0x1f4)[_0x44907f(0x158)]({'Perror':_0x44907f(0x11c),'message':_0x3991b3['message']});}})[_0x99e5fe(0x18b)](_0x4829e0=>{var _0xf40c7f=_0x99e5fe;console['error'](_0x4829e0),_0x589d83['status'](0x1f4)['json']({'Perror':_0xf40c7f(0x123)});});}catch(_0x5ee296){_0x589d83['json'](_0x5ee296);}}catch(_0x425c09){console[_0x99e5fe(0x113)](_0x425c09),_0x589d83[_0x99e5fe(0xb3)](0x1f4)[_0x99e5fe(0x158)]({'Merror':_0x99e5fe(0x11c),'Message':_0x425c09[_0x99e5fe(0x14e)]});}})[_0x47d11f(0x18b)](_0x157a32=>{var _0x4b4b20=_0x47d11f;console['error'](_0x157a32),_0x589d83['status'](0x1f4)['json']({'Merror':_0x4b4b20(0x123)});});}catch(_0x57928e){console['log'](_0x57928e);}});function BayBinSelected(_0x69f91b,_0x2c4fac){var _0x249086=a0_0x49fba4,_0x555035=[],_0x4d876f=[],_0x420bf4=[],_0x12fe89=[],_0x2de569=[],_0x1b8a87=[];let _0xe00854=[];if(_0x69f91b=='DRY\x20STORAGE')switch(_0x2c4fac){case _0x249086(0x136):_0x555035=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4d876f=[0x1,0x2],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0xf6),_0x249086(0x12e)],_0x2de569=['D'],_0x1b8a87=['A'];break;case _0x249086(0x144):_0x555035=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4d876f=[0x1,0x2],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0xf6),_0x249086(0x12e)],_0x2de569=['D'],_0x1b8a87=['B'];break;case _0x249086(0x18a):_0x555035=[0x0],_0x4d876f=[0x0],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0x12e)],_0x2de569=['D'],_0x1b8a87=['S'];break;case _0x249086(0x119):_0x555035=[0x0],_0x4d876f=[0x0],_0x12fe89=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x420bf4=[_0x249086(0x12e)],_0x2de569=['D'],_0x1b8a87=['R'];break;}else{if(_0x69f91b==_0x249086(0x10a))switch(_0x2c4fac){case _0x249086(0x136):_0x555035=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4d876f=['B','F'],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0xf6),_0x249086(0x12e)],_0x2de569=['C'],_0x1b8a87=['A'];break;case'Rack\x20B':_0x555035=[0x5,0x4,0x3,0x2,0x1],_0x4d876f=['F','B','S'],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0xf6),_0x249086(0x12e)],_0x2de569=['C'],_0x1b8a87=['B'];break;case _0x249086(0x188):_0x555035=[0x1,0x2,0x3,0x4,0x5],_0x4d876f=['B','F','S'],_0x12fe89=[0x5,0x4,0x3,0x2,0x1],_0x420bf4=[_0x249086(0xf6),_0x249086(0x12e)],_0x2de569=['C'],_0x1b8a87=['C'];break;case _0x249086(0x137):_0x555035=[0x5,0x4,0x3,0x2,0x1],_0x4d876f=['F','B','S'],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0xf6),_0x249086(0x12e)],_0x2de569=['C'],_0x1b8a87=['D'];break;case _0x249086(0xf0):_0x555035=[0x4,0x3,0x2,0x1],_0x4d876f=[0x1,0x2],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0xf6),_0x249086(0x12e)],_0x2de569=['C'],_0x1b8a87=['E'];break;case _0x249086(0x12c):_0x555035=[0x1,0x2,0x3],_0x4d876f=[0x1,0x2],_0x12fe89=[0x1,0x2,0x3,0x4,0x5],_0x420bf4=[_0x249086(0xf6)],_0x2de569=['C'],_0x1b8a87=['F'];break;}}return{'levels':_0x555035,'Isle':_0x4d876f,'rack':_0x12fe89,'type':_0x420bf4,'storage':_0x2de569,'rak':_0x1b8a87};}router[a0_0x49fba4(0x148)]('/view/:id',auth,async(_0x1971ac,_0x5202ed)=>{var _0x3e6531=a0_0x49fba4;try{const {username:_0x544288,email:_0x817200,role:_0x27c011}=_0x1971ac['user'],_0x116489=_0x1971ac[_0x3e6531(0xf8)],_0x58bf71=await profile[_0x3e6531(0x152)]({'email':_0x116489[_0x3e6531(0x180)]}),_0x220c72=await master_shop['find'](),_0x852370=await transfers[_0x3e6531(0x100)](_0x1971ac[_0x3e6531(0xc8)]['id']);let _0x5432b1;if(_0x116489[_0x3e6531(0x138)]==_0x3e6531(0x182)){const _0x372647=await staff[_0x3e6531(0x152)]({'email':_0x116489['email']});_0x5432b1=await warehouse[_0x3e6531(0x15d)]([{'$match':{'status':_0x3e6531(0x125),'name':_0x372647['warehouse'],'warehouse_category':_0x3e6531(0xad)}},{'$group':{'_id':_0x3e6531(0xf5),'name':{'$first':_0x3e6531(0xf5)}}}]);}else _0x5432b1=await warehouse[_0x3e6531(0x15d)]([{'$match':{'status':_0x3e6531(0x125),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3e6531(0xf5),'name':{'$first':'$name'}}}]);const _0x51893d=await warehouse[_0x3e6531(0x15d)]([{'$match':{'name':_0x852370[_0x3e6531(0xcf)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3e6531(0x107),'name':{'$first':_0x3e6531(0x140)},'product_stock':{'$first':_0x3e6531(0x135)},'bay':{'$first':_0x3e6531(0x112)},'bin':{'$first':_0x3e6531(0x102)},'type':{'$first':_0x3e6531(0x14b)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3e6531(0xc1)},'product_code':{'$first':_0x3e6531(0xbc)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3e6531(0x174)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3e6531(0xe7)},'room':{'$first':'$room'}}}]),_0x822e2e=await product[_0x3e6531(0xc7)]({}),_0x7e74e9=BayBinSelected(_0x852370[_0x3e6531(0x18f)],_0x852370[_0x3e6531(0x106)]);if(_0x220c72[0x0][_0x3e6531(0x165)]=='English\x20(US)'){var _0x49ee28=users[_0x3e6531(0x166)];console[_0x3e6531(0x178)](_0x49ee28);}else{if(_0x220c72[0x0]['language']==_0x3e6531(0x195))var _0x49ee28=users[_0x3e6531(0x195)];else{if(_0x220c72[0x0][_0x3e6531(0x165)]==_0x3e6531(0xbb))var _0x49ee28=users[_0x3e6531(0xbb)];else{if(_0x220c72[0x0][_0x3e6531(0x165)]==_0x3e6531(0xef))var _0x49ee28=users[_0x3e6531(0xef)];else{if(_0x220c72[0x0][_0x3e6531(0x165)]==_0x3e6531(0x19b))var _0x49ee28=users[_0x3e6531(0x19b)];else{if(_0x220c72[0x0][_0x3e6531(0x165)]==_0x3e6531(0x149))var _0x49ee28=users[_0x3e6531(0x129)];else{if(_0x220c72[0x0][_0x3e6531(0x165)]==_0x3e6531(0xfb))var _0x49ee28=users['Chinese'];else{if(_0x220c72[0x0]['language']==_0x3e6531(0x181))var _0x49ee28=users[_0x3e6531(0x157)];}}}}}}}_0x5202ed[_0x3e6531(0x171)](_0x3e6531(0xde),{'success':_0x1971ac[_0x3e6531(0xd9)](_0x3e6531(0xed)),'errors':_0x1971ac[_0x3e6531(0xd9)](_0x3e6531(0x14c)),'role':_0x116489,'profile':_0x58bf71,'master_shop':_0x220c72,'warehouse':_0x5432b1,'transfer':_0x852370,'stock':_0x51893d,'unit':_0x822e2e,'language':_0x49ee28});}catch(_0x3fb244){console[_0x3e6531(0x178)](_0x3fb244);}}),router[a0_0x49fba4(0x141)](a0_0x49fba4(0x167),auth,async(_0xbef8a2,_0x2af6ce)=>{var _0x5ed4c7=a0_0x49fba4;try{const _0x53fb0c=_0xbef8a2[_0x5ed4c7(0xc8)]['id'],_0x541684=await transfers[_0x5ed4c7(0x100)](_0x53fb0c);_0x2af6ce['json'](_0xbef8a2[_0x5ed4c7(0x118)]);return;const {date:_0x112bd4,from_warehouse:_0x44e694,FromRoom_name:_0x35f7f7,to_warehouse:_0x21300d,ToRoom_name:_0x28bb6b,prod_name:_0x4b55fe,from_prod_qty:_0x1a123e,from_prod_level:_0xb3e243,from_prod_isle:_0x2d1392,from_prod_pallet:_0x2f549f,to_prod_qty:_0x223131,to_prod_level:_0xb5069f,to_prod_isle:_0x36edbc,to_prod_pallet:_0x54f317,primary_code:_0x546f69,secondary_code:_0x38a2dc,product_code3:_0x3eec1b,note:_0x269272,invoice:_0xc2e605,expiry_date:_0x33b1ca}=_0xbef8a2[_0x5ed4c7(0x118)];if(typeof _0x4b55fe==_0x5ed4c7(0x109))var _0x37ee2d=[_0xbef8a2['body'][_0x5ed4c7(0x143)]],_0x33e481=[_0xbef8a2['body'][_0x5ed4c7(0x13c)]],_0x11e71b=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x12d)]],_0x69d897=[_0xbef8a2['body'][_0x5ed4c7(0x151)]],_0xff68d4=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xfa)]],_0x1ad014=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x14a)]],_0x4e2e62=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x176)]],_0x3d1738=[_0xbef8a2['body'][_0x5ed4c7(0x155)]],_0x4bebe0=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x163)]],_0x5a0291=[_0xbef8a2['body'][_0x5ed4c7(0x13f)]],_0x2a252b=[_0xbef8a2[_0x5ed4c7(0x118)]['to_types']],_0x994895=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xe2)]],_0x1ac761=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x153)]],_0xedf797=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xcb)]],_0x4389c1=[_0xbef8a2['body']['secondary_code']],_0x164aa9=[_0xbef8a2['body']['product_code3']],_0xbc25d0=[_0xbef8a2['body']['MaxStocks_data2']],_0x360cab=[_0xbef8a2['body'][_0x5ed4c7(0xb5)]],_0x306e52=[_0xbef8a2['body'][_0x5ed4c7(0xba)]],_0x2d7deb=[_0xbef8a2[_0x5ed4c7(0x118)]['batch_code']],_0x47505f=[_0xbef8a2['body']['expiry_date']],_0x13708a=[_0xbef8a2['body'][_0x5ed4c7(0xb2)]],_0x2cd960=[_0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x10d)]];else var _0x37ee2d=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x143)]],_0x994895=[..._0xbef8a2['body'][_0x5ed4c7(0xe2)]],_0x1ac761=[..._0xbef8a2[_0x5ed4c7(0x118)]['rak']],_0x1ad014=[..._0xbef8a2['body'][_0x5ed4c7(0x14a)]],_0x2a252b=[..._0xbef8a2[_0x5ed4c7(0x118)]['to_types']],_0x33e481=[..._0xbef8a2['body'][_0x5ed4c7(0x13c)]],_0x11e71b=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x12d)]],_0x69d897=[..._0xbef8a2['body'][_0x5ed4c7(0x151)]],_0xff68d4=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xfa)]],_0x4e2e62=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x176)]],_0x3d1738=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x155)]],_0x4bebe0=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x163)]],_0x5a0291=[..._0xbef8a2[_0x5ed4c7(0x118)]['to_prod_pallet']],_0xedf797=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xcb)]],_0x4389c1=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x175)]],_0x164aa9=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xb1)]],_0xbc25d0=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x179)]],_0x360cab=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xb5)]],_0x306e52=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xba)]],_0x2d7deb=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0x132)]],_0x47505f=[..._0xbef8a2[_0x5ed4c7(0x118)]['expiry_date']],_0x13708a=[..._0xbef8a2[_0x5ed4c7(0x118)][_0x5ed4c7(0xb2)]],_0x2cd960=[..._0xbef8a2['body'][_0x5ed4c7(0x10d)]];const _0xf2ce9c=_0x37ee2d[_0x5ed4c7(0x17d)](_0x413618=>{return _0x413618={'product_name':_0x413618};});_0x33e481[_0x5ed4c7(0x169)]((_0xa64719,_0x5cc16d)=>{_0xf2ce9c[_0x5cc16d]['from_quantity']=_0xa64719;}),_0x11e71b[_0x5ed4c7(0x169)]((_0xc4c884,_0x5dea9b)=>{var _0x12c5c5=_0x5ed4c7;_0xf2ce9c[_0x5dea9b][_0x12c5c5(0x19c)]=_0xc4c884;}),_0x69d897[_0x5ed4c7(0x169)]((_0x5943c7,_0x25c142)=>{_0xf2ce9c[_0x25c142]['from_bin']=_0x5943c7;}),_0xff68d4[_0x5ed4c7(0x169)]((_0x5f553f,_0x19a20c)=>{var _0x528773=_0x5ed4c7;_0xf2ce9c[_0x19a20c][_0x528773(0xb9)]=_0x5f553f;}),_0x4e2e62[_0x5ed4c7(0x169)]((_0x45a1de,_0x22f916)=>{var _0x2eee2e=_0x5ed4c7;_0xf2ce9c[_0x22f916][_0x2eee2e(0x192)]=_0x45a1de;}),_0x3d1738[_0x5ed4c7(0x169)]((_0x341955,_0x5513be)=>{var _0x1c91e7=_0x5ed4c7;_0xf2ce9c[_0x5513be][_0x1c91e7(0x110)]=_0x341955;}),_0x4bebe0[_0x5ed4c7(0x169)]((_0x281944,_0x3fdafa)=>{var _0x173546=_0x5ed4c7;_0xf2ce9c[_0x3fdafa][_0x173546(0x18d)]=_0x281944;}),_0x5a0291['forEach']((_0x2fc7d8,_0x2b9249)=>{var _0x157774=_0x5ed4c7;_0xf2ce9c[_0x2b9249][_0x157774(0x156)]=_0x2fc7d8;}),_0xedf797[_0x5ed4c7(0x169)]((_0x85b7d6,_0x521bb3)=>{var _0x5dfdb2=_0x5ed4c7;_0xf2ce9c[_0x521bb3][_0x5dfdb2(0xcb)]=_0x85b7d6;}),_0x4389c1[_0x5ed4c7(0x169)]((_0x9b11d1,_0x3d6503)=>{var _0x38b30d=_0x5ed4c7;_0xf2ce9c[_0x3d6503][_0x38b30d(0x175)]=_0x9b11d1;}),_0x164aa9[_0x5ed4c7(0x169)]((_0x56cd07,_0x381695)=>{var _0x4ba3ff=_0x5ed4c7;_0xf2ce9c[_0x381695][_0x4ba3ff(0xfe)]=_0x56cd07;}),_0xbc25d0[_0x5ed4c7(0x169)]((_0x4fb83b,_0x3b3ea6)=>{var _0x1f64fe=_0x5ed4c7;_0xf2ce9c[_0x3b3ea6][_0x1f64fe(0xc5)]=_0x4fb83b;}),_0x360cab['forEach']((_0x34b5f6,_0x179ce5)=>{var _0x299e88=_0x5ed4c7;_0xf2ce9c[_0x179ce5][_0x299e88(0xb5)]=_0x34b5f6;}),_0x306e52['forEach']((_0x49fb5b,_0x2af7ac)=>{var _0xa8fbc6=_0x5ed4c7;_0xf2ce9c[_0x2af7ac][_0xa8fbc6(0xba)]=_0x49fb5b;}),_0x2d7deb['forEach']((_0x138d31,_0xbec1f)=>{var _0x54d766=_0x5ed4c7;_0xf2ce9c[_0xbec1f][_0x54d766(0x132)]=_0x138d31;}),_0x47505f[_0x5ed4c7(0x169)]((_0x182151,_0x1aa49b)=>{_0xf2ce9c[_0x1aa49b]['expiry_date']=_0x182151;}),_0x994895[_0x5ed4c7(0x169)]((_0x1e54e6,_0x189b4e)=>{var _0x382d11=_0x5ed4c7;_0xf2ce9c[_0x189b4e][_0x382d11(0xe2)]=_0x1e54e6;}),_0x1ac761[_0x5ed4c7(0x169)]((_0x30b4c1,_0x55e9a8)=>{var _0x1f3bda=_0x5ed4c7;_0xf2ce9c[_0x55e9a8][_0x1f3bda(0x120)]=_0x30b4c1;}),_0x1ad014[_0x5ed4c7(0x169)]((_0x3e3e13,_0x2c84ee)=>{_0xf2ce9c[_0x2c84ee]['from_types']=_0x3e3e13;}),_0x2a252b[_0x5ed4c7(0x169)]((_0xc03fa4,_0x22109b)=>{var _0x424633=_0x5ed4c7;_0xf2ce9c[_0x22109b][_0x424633(0xd7)]=_0xc03fa4;}),_0x13708a[_0x5ed4c7(0x169)]((_0x46cbec,_0x4c7d78)=>{var _0x45250f=_0x5ed4c7;_0xf2ce9c[_0x4c7d78][_0x45250f(0xb2)]=_0x46cbec;}),_0x2cd960[_0x5ed4c7(0x169)]((_0x50bc4e,_0x32099e)=>{_0xf2ce9c[_0x32099e]['from_rack']=_0x50bc4e;});const _0x4cdd6a=_0xf2ce9c['filter'](_0x314161=>_0x314161[_0x5ed4c7(0x192)]!=='0'&&_0x314161['to_quantity']!==''||_0x314161['to_floorlevel']!=='0'&&_0x314161['to_floorlevel']!=='');var _0x2aa9e2=0x0;_0x4cdd6a['forEach'](_0x2f1380=>{var _0x3a750c=_0x5ed4c7;parseInt(_0x2f1380[_0x3a750c(0x194)])<parseInt(_0x2f1380[_0x3a750c(0x192)])&&_0x2aa9e2++;});if(_0x2aa9e2!=0x0)return _0xbef8a2['flash'](_0x5ed4c7(0x14c),_0x5ed4c7(0xe5)),_0x2af6ce[_0x5ed4c7(0xee)](_0x5ed4c7(0xb4));const _0x39fd3c=await warehouse['findOne']({'name':_0x541684[_0x5ed4c7(0xcf)],'room':_0x541684['from_room']});_0x541684[_0x5ed4c7(0x114)][_0x5ed4c7(0x169)](_0x596783=>{var _0x4c6a14=_0x5ed4c7;if(_0x596783[_0x4c6a14(0x192)]>0x0){const _0x40eb20=_0x39fd3c[_0x4c6a14(0xc9)][_0x4c6a14(0x17d)](_0x1ed3d3=>{var _0x5cf4b7=_0x4c6a14;_0x1ed3d3[_0x5cf4b7(0xe3)]==_0x596783[_0x5cf4b7(0xe3)]&&_0x1ed3d3[_0x5cf4b7(0x17c)]==_0x596783['from_floorlevel']&&_0x1ed3d3[_0x5cf4b7(0xf1)]==_0x596783[_0x5cf4b7(0x14a)]&&_0x1ed3d3[_0x5cf4b7(0x11b)]==_0x596783['from_bin']&&_0x1ed3d3[_0x5cf4b7(0x12a)]==_0x596783[_0x5cf4b7(0x19c)]&&_0x1ed3d3['rack']==_0x596783[_0x5cf4b7(0x13e)]&&_0x1ed3d3[_0x5cf4b7(0xe2)]==_0x596783[_0x5cf4b7(0xb2)]&&(_0x1ed3d3[_0x5cf4b7(0xe4)]=parseInt(_0x1ed3d3[_0x5cf4b7(0xe4)])+parseInt(_0x596783['to_quantity']));});}}),await _0x39fd3c[_0x5ed4c7(0x18c)]();const _0x5a7fa5=await warehouse[_0x5ed4c7(0x152)]({'name':_0x541684['to_warehouse'],'room':_0x541684['to_room']});_0x541684[_0x5ed4c7(0x114)][_0x5ed4c7(0x169)](_0x6100d6=>{var _0x4a46f6=_0x5ed4c7;if(_0x6100d6[_0x4a46f6(0x192)]>0x0){const _0xc7c9c=_0x5a7fa5[_0x4a46f6(0xc9)][_0x4a46f6(0x17d)](_0x28c95a=>{var _0x63fe71=_0x4a46f6;_0x28c95a[_0x63fe71(0xe3)]==_0x6100d6[_0x63fe71(0xe3)]&&_0x28c95a[_0x63fe71(0x17c)]==_0x6100d6[_0x63fe71(0x156)]&&_0x28c95a['type']==_0x6100d6['to_types']&&_0x28c95a[_0x63fe71(0x11b)]==_0x6100d6['to_bin']&&_0x28c95a['bay']==_0x6100d6[_0x63fe71(0x110)]&&_0x28c95a['rack']==_0x6100d6['rack']&&_0x28c95a['storage']==_0x6100d6[_0x63fe71(0xe2)]&&(_0x28c95a[_0x63fe71(0xe4)]=parseInt(_0x28c95a['product_stock'])-parseInt(_0x6100d6[_0x63fe71(0x192)]));});}}),await _0x5a7fa5[_0x5ed4c7(0x18c)](),_0x541684[_0x5ed4c7(0xce)]=_0x112bd4,_0x541684['from_warehouse']=_0x44e694,_0x541684[_0x5ed4c7(0x18f)]=_0x21300d,_0x541684['product']=_0x4cdd6a,_0x541684['note']=_0x269272,_0x541684[_0x5ed4c7(0xe6)]=_0xc2e605;const _0x43422f=await _0x541684[_0x5ed4c7(0x18c)]();console[_0x5ed4c7(0x178)](_0x43422f);const _0x2d0a5a=await warehouse[_0x5ed4c7(0x152)]({'name':_0x44e694,'room':_0x35f7f7});_0x43422f[_0x5ed4c7(0x114)][_0x5ed4c7(0x169)](_0x378516=>{var _0x589ca7=_0x5ed4c7;if(_0x378516[_0x589ca7(0x192)]>0x0){const _0x126499=_0x2d0a5a[_0x589ca7(0xc9)]['map'](_0x550efa=>{var _0x2188a1=_0x589ca7;_0x550efa[_0x2188a1(0xe3)]==_0x378516[_0x2188a1(0xe3)]&&_0x550efa['floorlevel']==_0x378516[_0x2188a1(0xb9)]&&_0x550efa[_0x2188a1(0xf1)]==_0x378516[_0x2188a1(0x14a)]&&_0x550efa[_0x2188a1(0x11b)]==_0x378516[_0x2188a1(0x177)]&&_0x550efa[_0x2188a1(0x12a)]==_0x378516[_0x2188a1(0x19c)]&&_0x550efa[_0x2188a1(0x120)]==_0x378516[_0x2188a1(0x13e)]&&_0x550efa[_0x2188a1(0xe2)]==_0x378516[_0x2188a1(0xb2)]&&(_0x550efa[_0x2188a1(0xe4)]=parseInt(_0x550efa[_0x2188a1(0xe4)])-parseInt(_0x378516['to_quantity']));});}}),await _0x2d0a5a[_0x5ed4c7(0x18c)]();const _0x27e1f2=await warehouse[_0x5ed4c7(0x152)]({'name':_0x21300d,'room':_0x28bb6b});_0x43422f[_0x5ed4c7(0x114)][_0x5ed4c7(0x169)](_0x4e22fd=>{var _0x55b802=_0x5ed4c7;if(_0x4e22fd[_0x55b802(0x192)]>0x0){var _0x2b47b2=0x0;const _0x1ae928=_0x27e1f2[_0x55b802(0xc9)][_0x55b802(0x17d)](_0x5b020b=>{var _0x2b7d6f=_0x55b802;_0x5b020b[_0x2b7d6f(0xe3)]==_0x4e22fd[_0x2b7d6f(0xe3)]&&_0x5b020b[_0x2b7d6f(0x17c)]==_0x4e22fd['to_floorlevel']&&_0x5b020b[_0x2b7d6f(0xf1)]==_0x4e22fd['to_types']&&_0x5b020b[_0x2b7d6f(0x11b)]==_0x4e22fd[_0x2b7d6f(0x18d)]&&_0x5b020b[_0x2b7d6f(0x12a)]==_0x4e22fd[_0x2b7d6f(0x110)]&&_0x5b020b[_0x2b7d6f(0x120)]==_0x4e22fd[_0x2b7d6f(0x120)]&&_0x5b020b[_0x2b7d6f(0xe2)]==_0x4e22fd[_0x2b7d6f(0xe2)]&&(_0x5b020b['product_stock']=parseInt(_0x5b020b[_0x2b7d6f(0xe4)])+parseInt(_0x4e22fd['to_quantity']),_0x2b47b2++);});_0x2b47b2=='0'&&(_0x27e1f2[_0x55b802(0xc9)]=_0x27e1f2['product_details'][_0x55b802(0xb6)]({'product_name':_0x4e22fd[_0x55b802(0xe3)],'product_stock':_0x4e22fd['to_quantity'],'bay':_0x4e22fd[_0x55b802(0x110)],'bin':_0x4e22fd['to_bin'],'type':_0x4e22fd['to_types'],'floorlevel':_0x4e22fd[_0x55b802(0x156)],'storage':_0x4e22fd[_0x55b802(0xe2)],'rack':_0x4e22fd['rack'],'product_code':_0x4e22fd[_0x55b802(0xfe)],'primary_code':_0x4e22fd[_0x55b802(0xcb)],'secondary_code':_0x4e22fd[_0x55b802(0x175)],'maxProducts':_0x4e22fd[_0x55b802(0xc5)],'storage':_0x4e22fd[_0x55b802(0xe2)],'rack':_0x4e22fd['rack']}));}}),await _0x27e1f2[_0x5ed4c7(0x18c)](),_0xbef8a2[_0x5ed4c7(0xd9)](_0x5ed4c7(0xed),'Transfer\x20Edit\x20Successfully'),_0x2af6ce[_0x5ed4c7(0xee)](_0x5ed4c7(0x162));}catch(_0x2ece3e){console['log'](_0x2ece3e);}}),router[a0_0x49fba4(0x141)](a0_0x49fba4(0xfd),async(_0x19df90,_0x1ec8f0)=>{var _0x35da00=a0_0x49fba4;const {FromWareHouse:_0x4347c,FromRoom:_0xc58a09,ToWarehouse:_0x4ad4c5,ToRoom:_0x41b0b4,primary_code:_0xca9565,Roomslist:_0x16114e}=_0x19df90[_0x35da00(0x118)],_0x3259b3=_0x16114e[_0x35da00(0x190)](','),_0x25915a=[];async function _0x258be0(_0x20cbf7){var _0x461063=_0x35da00;const _0x191964=await warehouse[_0x461063(0x15d)]([{'$match':{'name':_0x4347c,'room':_0x20cbf7}},{'$unwind':_0x461063(0x19a)},{'$match':{'product_details.primary_code':_0xca9565}},{'$group':{'_id':_0x461063(0x107),'name':{'$first':_0x461063(0x140)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x461063(0xb8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x461063(0x15a)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x461063(0xc4)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x461063(0x174)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x461063(0xe7)},'batch_code':{'$first':_0x461063(0x116)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x461063(0x172)},'maxProducts':{'$first':_0x461063(0x186)}}}]),_0x4482cb=await warehouse[_0x461063(0x15d)]([{'$match':{'name':_0x4347c,'room':_0x20cbf7}},{'$unwind':_0x461063(0x19a)},{'$match':{'product_details.secondary_code':_0xca9565}},{'$group':{'_id':_0x461063(0x107),'name':{'$first':_0x461063(0x140)},'instock':{'$first':_0x461063(0x135)},'primary_code':{'$first':_0x461063(0xb8)},'secondary_code':{'$first':_0x461063(0xc1)},'product_code':{'$first':_0x461063(0xbc)},'level':{'$first':_0x461063(0x112)},'isle':{'$first':_0x461063(0x102)},'type':{'$first':_0x461063(0x14b)},'pallet':{'$first':_0x461063(0x15a)},'unit':{'$first':_0x461063(0x154)},'secondary_unit':{'$first':_0x461063(0xc4)},'storage':{'$first':_0x461063(0xe8)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x461063(0x10b)},'production_date':{'$first':_0x461063(0xe7)},'batch_code':{'$first':_0x461063(0x116)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x461063(0x172)},'maxProducts':{'$first':_0x461063(0x186)}}}]);if(_0x191964[_0x461063(0x134)]>0x0)_0x25915a[_0x461063(0x150)](_0x191964);else _0x4482cb[_0x461063(0x134)]>0x0&&_0x25915a[_0x461063(0x150)](_0x4482cb);}const _0x34b43b=_0x3259b3[_0x35da00(0x17d)](_0x478e27=>_0x258be0(_0x478e27));await Promise[_0x35da00(0x184)](_0x34b43b),_0x1ec8f0[_0x35da00(0x158)](_0x25915a);}),router[a0_0x49fba4(0x141)]('/barcode_scanner2',async(_0x4cd785,_0x3c415a)=>{var _0x4cf1d9=a0_0x49fba4;try{const {FromWareHouse:_0x536ff4,FromRoom:_0x15c379,ToWarehouse:_0x4bea6c,ToRoom:_0x588386,secondary_code:_0x288a1}=_0x4cd785[_0x4cf1d9(0x118)],_0x4157b5=await warehouse[_0x4cf1d9(0x15d)]([{'$match':{'name':_0x536ff4}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x288a1}},{'$group':{'_id':_0x4cf1d9(0x107),'name':{'$first':_0x4cf1d9(0x140)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4cf1d9(0xbc)},'instock':{'$first':_0x4cf1d9(0x135)},'warehouse':{'$first':_0x4cf1d9(0xf5)},'level':{'$first':_0x4cf1d9(0x170)},'isle':{'$first':_0x4cf1d9(0xc3)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4cf1d9(0x186)},'unit':{'$first':_0x4cf1d9(0x154)}}}]);_0x3c415a['status'](0xc8)[_0x4cf1d9(0x158)](_0x4157b5);}catch(_0x50598c){_0x3c415a[_0x4cf1d9(0xb3)](0x194)[_0x4cf1d9(0x158)]({'message':_0x50598c[_0x4cf1d9(0x14e)]});}}),router['post'](a0_0x49fba4(0xdd),async(_0x5dbd5c,_0x897cde)=>{var _0x2fb639=a0_0x49fba4;try{const {FromWareHouse:_0x4cae4c,FromRoom:_0xf6151f,ToWarehouse:_0x4e18e2,ToRoom:_0x1bd479,product_code:_0x46d2eb}=_0x5dbd5c['body'],_0x38a129=await warehouse[_0x2fb639(0x15d)]([{'$match':{'name':_0x4cae4c}},{'$unwind':_0x2fb639(0x19a)},{'$match':{'product_details.product_code':_0x46d2eb}},{'$group':{'_id':_0x2fb639(0x107),'name':{'$first':_0x2fb639(0x140)},'primary_code':{'$first':_0x2fb639(0xb8)},'secondary_code':{'$first':_0x2fb639(0xc1)},'product_code':{'$first':_0x2fb639(0xbc)},'instock':{'$first':_0x2fb639(0x135)},'warehouse':{'$first':_0x2fb639(0xf5)},'level':{'$first':_0x2fb639(0x170)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x2fb639(0x154)}}}]);_0x897cde[_0x2fb639(0xb3)](0xc8)[_0x2fb639(0x158)](_0x38a129);}catch(_0x9c95fe){_0x897cde[_0x2fb639(0xb3)](0x194)[_0x2fb639(0x158)]({'message':_0x9c95fe[_0x2fb639(0x14e)]});}}),router[a0_0x49fba4(0x141)]('/CheckingWarehouse',async(_0x51ba66,_0x23a06c)=>{var _0x59b810=a0_0x49fba4;const {level:_0x30a15c,isle:_0x3eddf8,pallet:_0x18685a,warehouses:_0x11d464,room:_0x294f24}=_0x51ba66[_0x59b810(0x118)];try{const _0x11c7f9=await warehouse[_0x59b810(0x15d)]([{'$match':{'name':_0x11d464,'room':_0x294f24}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x30a15c),'product_details.isle':_0x3eddf8,'product_details.pallet':parseInt(_0x18685a)}},{'$group':{'_id':_0x59b810(0x107),'name':{'$first':_0x59b810(0x140)},'product_stock':{'$first':_0x59b810(0x135)},'level':{'$first':_0x59b810(0x170)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x59b810(0xd5)},'maxProducts':{'$first':_0x59b810(0x186)}}}]);_0x23a06c[_0x59b810(0xb3)](0xc8)[_0x59b810(0x158)](_0x11c7f9);}catch(_0x581f65){_0x23a06c['status'](0x194)[_0x59b810(0x158)]({'message':_0x581f65[_0x59b810(0x14e)]});}}),module[a0_0x49fba4(0x11a)]=router;