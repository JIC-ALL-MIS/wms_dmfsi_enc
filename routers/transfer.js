var a0_0x137580=a0_0x5262;(function(_0x3c7d26,_0x3af818){var _0x225460=a0_0x5262,_0x5797e2=_0x3c7d26();while(!![]){try{var _0x427fbe=parseInt(_0x225460(0x122))/0x1*(parseInt(_0x225460(0xc3))/0x2)+-parseInt(_0x225460(0xcf))/0x3+-parseInt(_0x225460(0xe9))/0x4*(parseInt(_0x225460(0x15d))/0x5)+parseInt(_0x225460(0xcc))/0x6*(-parseInt(_0x225460(0xec))/0x7)+parseInt(_0x225460(0x185))/0x8*(parseInt(_0x225460(0xc1))/0x9)+-parseInt(_0x225460(0x18a))/0xa*(parseInt(_0x225460(0x181))/0xb)+parseInt(_0x225460(0x16c))/0xc*(-parseInt(_0x225460(0x180))/0xd);if(_0x427fbe===_0x3af818)break;else _0x5797e2['push'](_0x5797e2['shift']());}catch(_0x49e3f9){_0x5797e2['push'](_0x5797e2['shift']());}}}(a0_0x433f,0x1cf0d));function a0_0x5262(_0x3f7544,_0x4c3d1d){var _0x433f69=a0_0x433f();return a0_0x5262=function(_0x526265,_0x1ff36a){_0x526265=_0x526265-0xa0;var _0x35cbc0=_0x433f69[_0x526265];return _0x35cbc0;},a0_0x5262(_0x3f7544,_0x4c3d1d);}const express=require(a0_0x137580(0x156)),app=express(),router=express[a0_0x137580(0x188)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x137580(0x173)),auth=require(a0_0x137580(0xd7)),users=require(a0_0x137580(0x11f)),nodemailer=require(a0_0x137580(0xe5));router['get'](a0_0x137580(0xb6),auth,async(_0x9ee125,_0x5d988f)=>{var _0x4c6f82=a0_0x137580;try{const {username:_0xb3a2ad,email:_0x1a363,role:_0x23586c}=_0x9ee125[_0x4c6f82(0xb7)],_0x4a2473=_0x9ee125[_0x4c6f82(0xb7)],_0x162ace=await profile[_0x4c6f82(0x149)]({'email':_0x4a2473[_0x4c6f82(0xf1)]}),_0x2ffe3e=await master_shop[_0x4c6f82(0xbc)]();console[_0x4c6f82(0x14a)](_0x4c6f82(0xb8),_0x2ffe3e);let _0x1850c4;if(_0x4a2473['role']=='staff'){const _0x4e7f67=await staff['findOne']({'email':_0x4a2473[_0x4c6f82(0xf1)]});_0x1850c4=await transfers[_0x4c6f82(0xbc)]({'from_warehouse':_0x4e7f67['warehouse']});}else _0x1850c4=await transfers['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x4c6f82(0x14d),'invoice':{'$first':_0x4c6f82(0xb2)},'date':{'$first':_0x4c6f82(0x136)},'from_warehouse':{'$first':_0x4c6f82(0x17e)},'to_warehouse':{'$first':_0x4c6f82(0x165)},'from_room_name':{'$addToSet':_0x4c6f82(0x119)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x4c6f82(0x13e)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2ffe3e[0x0][_0x4c6f82(0x155)]==_0x4c6f82(0xfb)){var _0x342f10=users[_0x4c6f82(0x134)];console['log'](_0x342f10);}else{if(_0x2ffe3e[0x0][_0x4c6f82(0x155)]==_0x4c6f82(0xc9))var _0x342f10=users[_0x4c6f82(0xc9)];else{if(_0x2ffe3e[0x0][_0x4c6f82(0x155)]==_0x4c6f82(0xae))var _0x342f10=users['German'];else{if(_0x2ffe3e[0x0][_0x4c6f82(0x155)]==_0x4c6f82(0x121))var _0x342f10=users[_0x4c6f82(0x121)];else{if(_0x2ffe3e[0x0]['language']==_0x4c6f82(0xf4))var _0x342f10=users[_0x4c6f82(0xf4)];else{if(_0x2ffe3e[0x0][_0x4c6f82(0x155)]==_0x4c6f82(0x130))var _0x342f10=users['Portuguese'];else{if(_0x2ffe3e[0x0][_0x4c6f82(0x155)]=='Chinese')var _0x342f10=users['Chinese'];else{if(_0x2ffe3e[0x0][_0x4c6f82(0x155)]==_0x4c6f82(0x15b))var _0x342f10=users[_0x4c6f82(0x157)];}}}}}}}_0x5d988f[_0x4c6f82(0xe2)](_0x4c6f82(0x111),{'success':_0x9ee125[_0x4c6f82(0x131)](_0x4c6f82(0xd9)),'errors':_0x9ee125[_0x4c6f82(0x131)](_0x4c6f82(0x176)),'role':_0x4a2473,'profile':_0x162ace,'master_shop':_0x2ffe3e,'transfer':_0x1850c4,'language':_0x342f10});}catch(_0x4722af){console[_0x4c6f82(0x14a)](_0x4722af);}});async function getRandom8DigitNumber(){var _0x4af716=a0_0x137580;const _0x145aff=0x989680,_0x41191f=0x5f5e0ff,_0x2fb12f=Math[_0x4af716(0xea)](Math['random']()*(_0x41191f-_0x145aff+0x1))+_0x145aff;var _0x4730bb;const _0x4389b7=await transfers[_0x4af716(0x149)]({'invoice':_0x4af716(0x139)+_0x2fb12f});return _0x4389b7&&_0x4389b7[_0x4af716(0xb3)]>0x0?_0x4730bb=_0x4af716(0x139)+_0x2fb12f:_0x4730bb=_0x4af716(0x139)+_0x2fb12f,_0x4730bb;}router['get']('/view/add_transfer',auth,async(_0x397f9d,_0x3bc761)=>{var _0x47a009=a0_0x137580;try{const {username:_0x20ae54,email:_0xa46813,role:_0x405d92}=_0x397f9d[_0x47a009(0xb7)],_0x4cf526=_0x397f9d[_0x47a009(0xb7)],_0x25f635=await profile[_0x47a009(0x149)]({'email':_0x4cf526[_0x47a009(0xf1)]}),_0x23d14a=await master_shop[_0x47a009(0xbc)]();console[_0x47a009(0x14a)]('master',_0x23d14a);let _0x2323a7;if(_0x4cf526['role']==_0x47a009(0xa2)){const _0x236ffb=await staff[_0x47a009(0x149)]({'email':_0x4cf526[_0x47a009(0xf1)]});_0x2323a7=await warehouse[_0x47a009(0x150)]([{'$match':{'status':'Enabled','name':_0x236ffb[_0x47a009(0x160)],'warehouse_category':_0x47a009(0x16a)}},{'$group':{'_id':_0x47a009(0x167),'name':{'$first':_0x47a009(0x167)}}}]);}else _0x2323a7=await warehouse['aggregate']([{'$match':{'status':_0x47a009(0x11a),'warehouse_category':_0x47a009(0x16a)}},{'$group':{'_id':'$name','name':{'$first':_0x47a009(0x167)}}}]);var _0x1375ec=[_0x47a009(0x129),_0x47a009(0xa0),_0x47a009(0xb0)];const _0x4b764c=await transfers[_0x47a009(0xbc)]({}),_0x21f30a=_0x4b764c[_0x47a009(0xb3)]+0x1,_0x5aa65d=_0x47a009(0x139)+_0x21f30a[_0x47a009(0xda)]()['padStart'](0x5,'0');if(_0x23d14a[0x0][_0x47a009(0x155)]==_0x47a009(0xfb)){var _0x3131c4=users['English'];console['log'](_0x3131c4);}else{if(_0x23d14a[0x0][_0x47a009(0x155)]==_0x47a009(0xc9))var _0x3131c4=users[_0x47a009(0xc9)];else{if(_0x23d14a[0x0]['language']==_0x47a009(0xae))var _0x3131c4=users[_0x47a009(0xae)];else{if(_0x23d14a[0x0]['language']=='Spanish')var _0x3131c4=users[_0x47a009(0x121)];else{if(_0x23d14a[0x0][_0x47a009(0x155)]=='French')var _0x3131c4=users[_0x47a009(0xf4)];else{if(_0x23d14a[0x0][_0x47a009(0x155)]==_0x47a009(0x130))var _0x3131c4=users[_0x47a009(0x12b)];else{if(_0x23d14a[0x0][_0x47a009(0x155)]=='Chinese')var _0x3131c4=users[_0x47a009(0x14e)];else{if(_0x23d14a[0x0][_0x47a009(0x155)]==_0x47a009(0x15b))var _0x3131c4=users[_0x47a009(0x157)];}}}}}}}const _0x2578d2=getRandom8DigitNumber();_0x2578d2['then'](_0x76d127=>{var _0x214ccf=_0x47a009;_0x3bc761['render'](_0x214ccf(0xce),{'success':_0x397f9d['flash'](_0x214ccf(0xd9)),'errors':_0x397f9d[_0x214ccf(0x131)](_0x214ccf(0x176)),'role':_0x4cf526,'profile':_0x25f635,'master_shop':_0x23d14a,'warehouse':_0x2323a7,'language':_0x3131c4,'rooms_data':_0x1375ec,'invoice':_0x76d127});})['catch'](_0x3f3609=>{var _0x3e6316=_0x47a009;_0x397f9d[_0x3e6316(0x131)](_0x3e6316(0x176),_0x3e6316(0xa7)),_0x3bc761['redirect'](_0x3e6316(0xdb));});}catch(_0x23de84){console[_0x47a009(0x14a)](_0x23de84);}}),router[a0_0x137580(0xaa)](a0_0x137580(0xc2),auth,async(_0xbc65ad,_0x43c8f8)=>{var _0x124b2f=a0_0x137580;try{console['log'](_0xbc65ad[_0x124b2f(0x123)]);const {date:_0x24d007,from_warehouse:_0x450aca,FromRoom_name:_0x21a3a2,to_warehouse:_0x175601,ToRoom_name:_0x1b61f5,prod_name:_0x2db05a,from_prod_qty:_0x14120c,from_prod_level:_0x2ed477,from_prod_isle:_0xd7172,from_prod_pallet:_0xf1141e,to_prod_qty:_0x2ed493,to_prod_level:_0x396c34,to_prod_isle:_0x382668,to_prod_pallet:_0x361e41,primary_code:_0x26f76a,secondary_code:_0x3a3b4d,product_code3:_0x14ad1f,note:_0x4d90bf,MaxStocks_data2:_0x56095f,invoice:_0x2f05a2,expiry_date:_0x484c86}=_0xbc65ad['body'];if(typeof _0x2db05a==_0x124b2f(0x145))var _0x23275a=[_0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xca)]],_0xa6cbb8=[_0xbc65ad[_0x124b2f(0x123)]['from_prod_qty']],_0x3ce868=[_0xbc65ad[_0x124b2f(0x123)]['from_prod_level']],_0x46b2c8=[_0xbc65ad[_0x124b2f(0x123)]['New_Qty_Converted']],_0x2e6316=[_0xbc65ad[_0x124b2f(0x123)]['to_prod_level']],_0x4c01a1=[_0xbc65ad['body'][_0x124b2f(0xa1)]],_0x414374=[_0xbc65ad['body'][_0x124b2f(0xd6)]],_0x50a810=[_0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x163)]],_0x316617=[_0xbc65ad[_0x124b2f(0x123)]['MaxStocks_data2']],_0x16a343=[_0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x10e)]],_0x23d65f=[_0xbc65ad[_0x124b2f(0x123)]['secondary_unit']],_0x71e8ef=[_0xbc65ad[_0x124b2f(0x123)]['batch_code']],_0x4f35a1=[_0xbc65ad[_0x124b2f(0x123)]['expiry_date']],_0x2f62d8=[_0xbc65ad['body'][_0x124b2f(0x10c)]],_0x2ecdff=[_0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x128)]],_0x47c67c=[_0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xfd)]],_0xd91afd=[_0xbc65ad[_0x124b2f(0x123)]['RoomAssigned']],_0x5f5092=[_0xbc65ad[_0x124b2f(0x123)]['ToRoomAssigned']],_0x18b1ca=[_0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xb9)]],_0x24a0bd=[_0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x175)]];else var _0x23275a=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xca)]],_0xa6cbb8=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x132)]],_0x3ce868=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x120)]],_0x46b2c8=[..._0xbc65ad['body'][_0x124b2f(0x189)]],_0x2e6316=[..._0xbc65ad[_0x124b2f(0x123)]['to_prod_level']],_0x4c01a1=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xa1)]],_0x414374=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xd6)]],_0x50a810=[..._0xbc65ad['body'][_0x124b2f(0x163)]],_0x316617=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x107)]],_0x16a343=[..._0xbc65ad[_0x124b2f(0x123)]['primary_unit']],_0x23d65f=[..._0xbc65ad['body']['secondary_unit']],_0x71e8ef=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xe0)]],_0x4f35a1=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x108)]],_0x2f62d8=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x10c)]],_0x2ecdff=[..._0xbc65ad['body']['production_date']],_0x47c67c=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xfd)]],_0xd91afd=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x110)]],_0x5f5092=[..._0xbc65ad[_0x124b2f(0x123)]['ToRoomAssigned']],_0x18b1ca=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0xb9)]],_0x24a0bd=[..._0xbc65ad[_0x124b2f(0x123)][_0x124b2f(0x175)]];const _0x25b0f8=_0x23275a[_0x124b2f(0x104)](_0x21a6e4=>{return _0x21a6e4={'product_name':_0x21a6e4};});_0xa6cbb8[_0x124b2f(0xf9)]((_0x34c13f,_0xc924c6)=>{var _0x100fd7=_0x124b2f;_0x25b0f8[_0xc924c6][_0x100fd7(0x12c)]=_0x34c13f;}),_0x18b1ca['forEach']((_0x4b84dc,_0x40249c)=>{var _0xf64a5=_0x124b2f;_0x25b0f8[_0x40249c][_0xf64a5(0xb9)]=_0x4b84dc;}),_0x24a0bd['forEach']((_0x141e31,_0xbcb826)=>{var _0x45d57e=_0x124b2f;_0x25b0f8[_0xbcb826][_0x45d57e(0x118)]=_0x141e31;}),_0x3ce868[_0x124b2f(0xf9)]((_0x77dd93,_0x178a05)=>{var _0x3b5810=_0x124b2f;_0xd91afd[_0x3b5810(0xf9)]((_0x6ad6f2,_0x1b8c60)=>{var _0x5ac6f5=_0x3b5810;if(_0x6ad6f2==_0x5ac6f5(0xba)&&_0x178a05==_0x1b8c60){var _0x31a487=_0x77dd93[_0x5ac6f5(0xa8)](0x3);_0x25b0f8[_0x178a05][_0x5ac6f5(0x106)]=_0x77dd93[0x0],_0x25b0f8[_0x178a05][_0x5ac6f5(0xbf)]=_0x77dd93[0x1],_0x25b0f8[_0x178a05][_0x5ac6f5(0xd8)]=0x0,_0x25b0f8[_0x178a05][_0x5ac6f5(0xfa)]=0x0,_0x25b0f8[_0x178a05][_0x5ac6f5(0xad)]=_0x5ac6f5(0x146),_0x25b0f8[_0x178a05][_0x5ac6f5(0xe8)]=_0x31a487;}else{if(_0x6ad6f2==_0x5ac6f5(0xd5)&&_0x178a05==_0x1b8c60){var _0x31a487=_0x77dd93[_0x5ac6f5(0xa8)](0x3);_0x25b0f8[_0x178a05]['from_storage']=_0x77dd93[0x0],_0x25b0f8[_0x178a05][_0x5ac6f5(0xbf)]=_0x77dd93[0x1],_0x25b0f8[_0x178a05][_0x5ac6f5(0xd8)]=0x0,_0x25b0f8[_0x178a05][_0x5ac6f5(0xfa)]=0x0,_0x25b0f8[_0x178a05][_0x5ac6f5(0xad)]=_0x5ac6f5(0x146),_0x25b0f8[_0x178a05][_0x5ac6f5(0xe8)]=_0x77dd93[0x5];}else{if(_0x178a05==_0x1b8c60){var _0x3e894e;if(_0x77dd93[0x4]=='L')_0x3e894e=_0x5ac6f5(0xe1);else _0x77dd93[0x4]=='F'&&(_0x3e894e=_0x5ac6f5(0x146));_0x25b0f8[_0x178a05]['from_storage']=_0x77dd93[0x0],_0x25b0f8[_0x178a05][_0x5ac6f5(0xbf)]=_0x77dd93[0x1],_0x25b0f8[_0x178a05][_0x5ac6f5(0xd8)]=_0x77dd93[0x2],_0x25b0f8[_0x178a05][_0x5ac6f5(0xfa)]=_0x77dd93[0x3],_0x25b0f8[_0x178a05][_0x5ac6f5(0xad)]=_0x3e894e,_0x25b0f8[_0x178a05][_0x5ac6f5(0xe8)]=_0x77dd93[0x5];}}}});}),_0x46b2c8['forEach']((_0x8e1032,_0x9b0a8f)=>{var _0x31190e=_0x124b2f;_0x25b0f8[_0x9b0a8f][_0x31190e(0xe4)]=_0x8e1032;}),_0x2e6316[_0x124b2f(0xf9)]((_0x4ca6c1,_0x54fcff)=>{var _0x11fbad=_0x124b2f;_0x5f5092[_0x11fbad(0xf9)]((_0x10e06d,_0xb869f9)=>{var _0x13fc6e=_0x11fbad;if(_0x10e06d==_0x13fc6e(0xba)&&_0x54fcff==_0xb869f9){var _0x37c2d1=_0x4ca6c1[_0x13fc6e(0xa8)](0x3);_0x25b0f8[_0x54fcff]['storage']=_0x4ca6c1[0x0],_0x25b0f8[_0x54fcff][_0x13fc6e(0x12e)]=_0x4ca6c1[0x1],_0x25b0f8[_0x54fcff][_0x13fc6e(0xcb)]=0x0,_0x25b0f8[_0x54fcff][_0x13fc6e(0x187)]=0x0,_0x25b0f8[_0x54fcff][_0x13fc6e(0x182)]=_0x13fc6e(0x146),_0x25b0f8[_0x54fcff]['to_floorlevel']=_0x37c2d1;}else{if(_0x10e06d=='Shelves'&&_0x54fcff==_0xb869f9){var _0x37c2d1=_0x4ca6c1[_0x13fc6e(0xa8)](0x3);_0x25b0f8[_0x54fcff][_0x13fc6e(0xb1)]=_0x4ca6c1[0x0],_0x25b0f8[_0x54fcff]['rack']=_0x4ca6c1[0x1],_0x25b0f8[_0x54fcff][_0x13fc6e(0xcb)]=0x0,_0x25b0f8[_0x54fcff]['to_bin']=0x0,_0x25b0f8[_0x54fcff][_0x13fc6e(0x182)]=_0x13fc6e(0x146),_0x25b0f8[_0x54fcff]['to_floorlevel']=_0x4ca6c1[0x5];}else{if(_0x54fcff==_0xb869f9){var _0x29a5a4;if(_0x4ca6c1[0x4]=='L')_0x29a5a4=_0x13fc6e(0xe1);else _0x4ca6c1[0x4]=='F'&&(_0x29a5a4=_0x13fc6e(0x146));_0x25b0f8[_0x54fcff][_0x13fc6e(0xb1)]=_0x4ca6c1[0x0],_0x25b0f8[_0x54fcff][_0x13fc6e(0x12e)]=_0x4ca6c1[0x1],_0x25b0f8[_0x54fcff][_0x13fc6e(0xcb)]=_0x4ca6c1[0x2],_0x25b0f8[_0x54fcff]['to_bin']=_0x4ca6c1[0x3],_0x25b0f8[_0x54fcff]['to_types']=_0x29a5a4,_0x25b0f8[_0x54fcff]['to_floorlevel']=_0x4ca6c1[0x5];}}}});}),_0x4c01a1[_0x124b2f(0xf9)]((_0x27b7cd,_0x2ddedc)=>{var _0x1702ee=_0x124b2f;_0x25b0f8[_0x2ddedc][_0x1702ee(0xa1)]=_0x27b7cd;}),_0x414374[_0x124b2f(0xf9)]((_0x3a3913,_0x399ced)=>{var _0x5714b7=_0x124b2f;_0x25b0f8[_0x399ced][_0x5714b7(0xd6)]=_0x3a3913;}),_0x50a810[_0x124b2f(0xf9)]((_0x4aa322,_0x160c6f)=>{_0x25b0f8[_0x160c6f]['product_code']=_0x4aa322;}),_0x316617[_0x124b2f(0xf9)]((_0x3d7a71,_0x1eee44)=>{_0x25b0f8[_0x1eee44]['maxProducts']=_0x3d7a71;}),_0x16a343[_0x124b2f(0xf9)]((_0x3208bd,_0x1e7904)=>{var _0x1b1e52=_0x124b2f;_0x25b0f8[_0x1e7904][_0x1b1e52(0x158)]=_0x3208bd;}),_0x23d65f['forEach']((_0x25260c,_0x3745a2)=>{var _0x13e551=_0x124b2f;_0x25b0f8[_0x3745a2][_0x13e551(0xc4)]=_0x25260c;}),_0x71e8ef['forEach']((_0x48b450,_0x5bc81b)=>{_0x25b0f8[_0x5bc81b]['batch_code']=_0x48b450;}),_0x4f35a1[_0x124b2f(0xf9)]((_0x5ad2c7,_0x35cf34)=>{var _0x4befd4=_0x124b2f;_0x25b0f8[_0x35cf34][_0x4befd4(0x108)]=_0x5ad2c7;}),_0x2f62d8['forEach']((_0x21ef15,_0x5c959c)=>{var _0x41fc3b=_0x124b2f;_0x25b0f8[_0x5c959c][_0x41fc3b(0xc0)]=_0x21ef15;}),_0x2ecdff['forEach']((_0x3ae82c,_0x55b6f2)=>{var _0x1b6646=_0x124b2f;_0x25b0f8[_0x55b6f2][_0x1b6646(0x128)]=_0x3ae82c;}),_0x47c67c[_0x124b2f(0xf9)]((_0x3a645e,_0x5b6dc4)=>{var _0x293c76=_0x124b2f;_0x25b0f8[_0x5b6dc4][_0x293c76(0xfd)]=_0x3a645e;}),_0xd91afd[_0x124b2f(0xf9)]((_0x222ea5,_0x353629)=>{var _0xef57bd=_0x124b2f;_0x25b0f8[_0x353629][_0xef57bd(0x135)]=_0x222ea5;}),_0x5f5092[_0x124b2f(0xf9)]((_0x4f8ea2,_0x1fe2c0)=>{var _0x1ea6ae=_0x124b2f;_0x25b0f8[_0x1fe2c0][_0x1ea6ae(0x154)]=_0x4f8ea2;});const _0x25c55d=_0x25b0f8[_0x124b2f(0xb4)](_0x3a7c6a=>_0x3a7c6a[_0x124b2f(0xe4)]!=='0'&&_0x3a7c6a[_0x124b2f(0xe4)]!==''||_0x3a7c6a[_0x124b2f(0x124)]!=='0'&&_0x3a7c6a[_0x124b2f(0x124)]!==''),_0x31ebbc=new transfers({'date':_0x24d007,'from_warehouse':_0x450aca,'to_warehouse':_0x175601,'product':_0x25c55d,'note':_0x4d90bf,'invoice':_0x2f05a2}),_0x131700=await _0x31ebbc['save']();_0xbc65ad[_0x124b2f(0x131)](_0x124b2f(0xd9),_0x124b2f(0x144)),_0x43c8f8[_0x124b2f(0xf2)]('/transfer/preview/'+_0x131700[_0x124b2f(0x171)]);}catch(_0xf7770f){console['log'](_0xf7770f),_0x43c8f8['status'](0xc8)[_0x124b2f(0xed)]({'errorMessage':_0xf7770f['message']});}}),router[a0_0x137580(0x112)](a0_0x137580(0x16f),auth,async(_0x89e072,_0x2be97a)=>{var _0x4161b6=a0_0x137580;try{const {username:_0x43a2f6,email:_0x2a54e8,role:_0x1bde71}=_0x89e072[_0x4161b6(0xb7)],_0x2d2f1f=_0x89e072['user'],_0x46a17e=await profile[_0x4161b6(0x149)]({'email':_0x2d2f1f[_0x4161b6(0xf1)]}),_0x2c5f46=await master_shop['find']();console['log'](_0x4161b6(0xb8),_0x2c5f46);const _0x4f8ff4=await transfers[_0x4161b6(0xc8)](_0x89e072[_0x4161b6(0x183)]['id']);let _0x942348=new Date(_0x4f8ff4[_0x4161b6(0x108)]),_0x3a3369=('0'+_0x942348['getDate']())[_0x4161b6(0xa8)](-0x2),_0x1c4f35=('0'+(_0x942348['getMonth']()+0x1))['slice'](-0x2),_0x227fc5=_0x942348['getFullYear'](),_0xb418a1=_0x227fc5+'-'+_0x1c4f35+'-'+_0x3a3369,_0x2c3ced;if(_0x2d2f1f['role']==_0x4161b6(0xa2)){const _0x1ad534=await staff[_0x4161b6(0x149)]({'email':_0x2d2f1f[_0x4161b6(0xf1)]});_0x2c3ced=await warehouse['find']({'status':_0x4161b6(0x11a),'name':_0x1ad534[_0x4161b6(0x160)],'warehouse_category':_0x4161b6(0x16a)});}else _0x2c3ced=await warehouse[_0x4161b6(0xbc)]({'status':_0x4161b6(0x11a),'warehouse_category':'Raw\x20Materials'});const _0x141846=await warehouse[_0x4161b6(0x150)]([{'$match':{'name':_0x4f8ff4[_0x4161b6(0x17f)]}},{'$unwind':_0x4161b6(0x18b)},{'$group':{'_id':_0x4161b6(0xc7),'name':{'$first':_0x4161b6(0x101)},'product_stock':{'$first':_0x4161b6(0x15e)},'bay':{'$first':_0x4161b6(0x186)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4161b6(0x102)},'floorlevel':{'$first':_0x4161b6(0xfe)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4161b6(0x13a)},'product_code':{'$first':_0x4161b6(0x159)},'storage':{'$first':_0x4161b6(0x179)},'rack':{'$first':_0x4161b6(0x184)},'expiry_date':{'$first':_0x4161b6(0x13b)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4161b6(0x12f)}}}]);if(_0x2c5f46[0x0]['language']==_0x4161b6(0xfb)){var _0x599adb=users[_0x4161b6(0x134)];console[_0x4161b6(0x14a)](_0x599adb);}else{if(_0x2c5f46[0x0][_0x4161b6(0x155)]==_0x4161b6(0xc9))var _0x599adb=users['Hindi'];else{if(_0x2c5f46[0x0]['language']==_0x4161b6(0xae))var _0x599adb=users[_0x4161b6(0xae)];else{if(_0x2c5f46[0x0][_0x4161b6(0x155)]==_0x4161b6(0x121))var _0x599adb=users[_0x4161b6(0x121)];else{if(_0x2c5f46[0x0][_0x4161b6(0x155)]==_0x4161b6(0xf4))var _0x599adb=users[_0x4161b6(0xf4)];else{if(_0x2c5f46[0x0][_0x4161b6(0x155)]=='Portuguese\x20(BR)')var _0x599adb=users[_0x4161b6(0x12b)];else{if(_0x2c5f46[0x0][_0x4161b6(0x155)]==_0x4161b6(0x14e))var _0x599adb=users['Chinese'];else{if(_0x2c5f46[0x0][_0x4161b6(0x155)]==_0x4161b6(0x15b))var _0x599adb=users[_0x4161b6(0x157)];}}}}}}}_0x2be97a[_0x4161b6(0xe2)](_0x4161b6(0x13c),{'success':_0x89e072[_0x4161b6(0x131)](_0x4161b6(0xd9)),'errors':_0x89e072['flash'](_0x4161b6(0x176)),'role':_0x2d2f1f,'profile':_0x46a17e,'master_shop':_0x2c5f46,'warehouse':_0x2c3ced,'transfer':_0x4f8ff4,'stock':_0x141846,'language':_0x599adb});}catch(_0xc62201){console[_0x4161b6(0x14a)](_0xc62201);}}),router[a0_0x137580(0xaa)](a0_0x137580(0x16f),auth,async(_0x5665d4,_0x17fab4)=>{var _0x385556=a0_0x137580;try{const _0x4b7a87=_0x5665d4['params']['id'],{from_warehouse:_0x140a93,FromRoom_name:_0x4ef363,to_warehouse:_0x1de3dd,ToRoom_name:_0x4f200b}=_0x5665d4['body'],_0x1597bb=await transfers['findById']({'_id':_0x4b7a87}),_0x5f0511=_0x1597bb[_0x385556(0x147)]['map'](async _0x20c34b=>{var _0x207093=_0x385556;if(_0x20c34b[_0x207093(0xe4)]>0x0){var _0x14e654=await warehouse[_0x207093(0x149)]({'name':_0x1597bb['from_warehouse'],'room':_0x20c34b['from_room_name'],'warehouse_category':_0x207093(0x16a)});const _0x195fce=_0x14e654['product_details'][_0x207093(0x104)](_0x394280=>{var _0x2789f3=_0x207093;_0x394280['product_name']==_0x20c34b[_0x2789f3(0xdd)]&&_0x394280['floorlevel']==_0x20c34b['from_floorlevel']&&_0x394280[_0x2789f3(0x142)]==_0x20c34b['from_types']&&_0x394280[_0x2789f3(0x100)]==_0x20c34b['from_bin']&&_0x394280[_0x2789f3(0x125)]==_0x20c34b['from_bay']&&_0x394280[_0x2789f3(0x12e)]==_0x20c34b[_0x2789f3(0xbf)]&&_0x394280[_0x2789f3(0xb1)]==_0x20c34b['from_storage']&&_0x394280[_0x2789f3(0x108)]==_0x20c34b[_0x2789f3(0x108)]&&_0x394280[_0x2789f3(0xe0)]==_0x20c34b[_0x2789f3(0xe0)]&&_0x394280[_0x2789f3(0x128)]==_0x20c34b['production_date']&&_0x394280[_0x2789f3(0x14b)]==_0x20c34b[_0x2789f3(0xb9)]&&(_0x394280[_0x2789f3(0x133)]=_0x394280[_0x2789f3(0x133)]-_0x20c34b['to_quantity']);});}return _0x14e654;});Promise[_0x385556(0x152)](_0x5f0511)[_0x385556(0x178)](async _0x37fb5c=>{var _0x585edd=_0x385556;try{for(const _0xdb707 of _0x37fb5c){await _0xdb707[_0x585edd(0xe6)]();}try{const _0x41ecfd=_0x1597bb['product']['map'](async _0x30c179=>{var _0x390800=_0x585edd;if(_0x30c179['to_quantity']>0x0){var _0x44e29e=await warehouse['findOne']({'name':_0x1597bb['to_warehouse'],'room':_0x30c179[_0x390800(0x154)],'warehouse_category':_0x390800(0x16a)}),_0x27a637=0x0;const _0x28175b=_0x44e29e['product_details'][_0x390800(0x104)](_0x46de6f=>{var _0x32395a=_0x390800;_0x46de6f[_0x32395a(0xdd)]==_0x30c179[_0x32395a(0xdd)]&&_0x46de6f[_0x32395a(0x12d)]==_0x30c179[_0x32395a(0x124)]&&_0x46de6f['type']==_0x30c179['to_types']&&_0x46de6f[_0x32395a(0x100)]==_0x30c179['to_bin']&&_0x46de6f[_0x32395a(0x125)]==_0x30c179[_0x32395a(0xcb)]&&_0x46de6f[_0x32395a(0x12e)]==_0x30c179['rack']&&_0x46de6f['storage']==_0x30c179[_0x32395a(0xb1)]&&_0x46de6f[_0x32395a(0x108)]==_0x30c179[_0x32395a(0x108)]&&_0x46de6f[_0x32395a(0xe0)]==_0x30c179[_0x32395a(0xe0)]&&_0x46de6f['production_date']==_0x30c179[_0x32395a(0x128)]&&_0x46de6f['invoice']==_0x30c179['To_invoice']&&(_0x46de6f['product_stock']=_0x46de6f['product_stock']+_0x30c179[_0x32395a(0xe4)],_0x27a637++);});_0x27a637=='0'&&(_0x44e29e[_0x390800(0xa3)]=_0x44e29e[_0x390800(0xa3)][_0x390800(0x127)]({'product_name':_0x30c179['product_name'],'product_stock':_0x30c179[_0x390800(0xe4)],'bay':_0x30c179[_0x390800(0xcb)],'bin':_0x30c179[_0x390800(0x187)],'type':_0x30c179[_0x390800(0x182)],'floorlevel':_0x30c179[_0x390800(0x124)],'storage':_0x30c179[_0x390800(0xb1)],'rack':_0x30c179[_0x390800(0x12e)],'product_code':_0x30c179['product_code'],'primary_code':_0x30c179[_0x390800(0xa1)],'secondary_code':_0x30c179[_0x390800(0xd6)],'maxProducts':_0x30c179['maxProducts'],'storage':_0x30c179[_0x390800(0xb1)],'rack':_0x30c179[_0x390800(0x12e)],'expiry_date':_0x30c179[_0x390800(0x108)],'maxPerUnit':_0x30c179[_0x390800(0xc0)],'batch_code':_0x30c179[_0x390800(0xe0)],'production_date':_0x30c179[_0x390800(0x128)]}));}return _0x44e29e;});Promise[_0x585edd(0x152)](_0x41ecfd)[_0x585edd(0x178)](async _0x5c512f=>{var _0xdb89fa=_0x585edd;try{for(const _0x572be6 of _0x5c512f){await warehouse[_0xdb89fa(0xd3)]({'_id':_0x572be6[_0xdb89fa(0x171)]},{'$addToSet':{'product_details':{'$each':_0x572be6['product_details']}}});}_0x1597bb[_0xdb89fa(0xf0)]=_0xdb89fa(0x166);const _0x303349=await _0x1597bb[_0xdb89fa(0xe6)](),_0x240806=await master_shop[_0xdb89fa(0xbc)](),_0x597315=await email_settings[_0xdb89fa(0x149)](),_0x2ed400=await supervisor_settings[_0xdb89fa(0xbc)]();var _0xfd7eff=_0x1597bb[_0xdb89fa(0x147)],_0x44e693='',_0x580bac;for(_0x580bac in _0xfd7eff){_0x44e693+=_0xdb89fa(0xff)+_0xdb89fa(0x140)+_0xfd7eff[_0x580bac][_0xdb89fa(0xdd)]+_0xdb89fa(0x11d)+_0xdb89fa(0x140)+_0xfd7eff[_0x580bac]['product_code']+_0xdb89fa(0x11d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfd7eff[_0x580bac][_0xdb89fa(0xe4)]+_0xdb89fa(0x11d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfd7eff[_0x580bac][_0xdb89fa(0x158)]+_0xdb89fa(0x11d)+_0xdb89fa(0x140)+_0xfd7eff[_0x580bac]['secondary_unit']+'</td>'+_0xdb89fa(0x140)+_0x1597bb[_0xdb89fa(0x141)]+_0xdb89fa(0x11d)+_0xdb89fa(0x140)+_0xfd7eff[_0x580bac][_0xdb89fa(0x154)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfd7eff[_0x580bac][_0xdb89fa(0xb1)]+_0xfd7eff[_0x580bac]['rack']+_0xfd7eff[_0x580bac][_0xdb89fa(0xcb)]+_0xfd7eff[_0x580bac][_0xdb89fa(0x187)]+_0xfd7eff[_0x580bac][_0xdb89fa(0x182)][0x0]+_0xfd7eff[_0x580bac]['to_floorlevel']+_0xdb89fa(0x11d),'</tr>';}let _0x5bb32d=nodemailer[_0xdb89fa(0xcd)]({'host':_0x597315['host'],'port':Number(_0x597315[_0xdb89fa(0x115)]),'secure':![],'auth':{'user':_0x597315[_0xdb89fa(0xf1)],'pass':_0x597315[_0xdb89fa(0x116)]}}),_0x3476d3={'from':_0x597315[_0xdb89fa(0xf1)],'to':_0x2ed400[0x0][_0xdb89fa(0x10a)],'subject':_0xdb89fa(0x10b),'attachments':[{'filename':_0xdb89fa(0xd1),'path':__dirname+'/../public'+_0xdb89fa(0x13f)+_0x240806[0x0][_0xdb89fa(0x14f)],'cid':'logo'}],'html':_0xdb89fa(0x148)+_0xdb89fa(0x161)+_0xdb89fa(0x16d)+_0xdb89fa(0xac)+_0xdb89fa(0x169)+_0xdb89fa(0xac)+_0xdb89fa(0x137)+_0xdb89fa(0x13d)+_0xdb89fa(0xac)+'<h2>\x20'+_0x240806[0x0][_0xdb89fa(0x16b)]+_0xdb89fa(0xf6)+_0xdb89fa(0x13d)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0xdb89fa(0xac)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x1597bb[_0xdb89fa(0x14b)]+'\x20'+_0xdb89fa(0xee)+'\x20Order\x20Date\x20:\x20'+_0x1597bb[_0xdb89fa(0x15a)]+'\x20'+_0xdb89fa(0x109)+_0xdb89fa(0x174)+'</div>'+_0xdb89fa(0xa9)+_0xdb89fa(0xef)+_0xdb89fa(0xff)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0xdb89fa(0xe3)+_0xdb89fa(0x14c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0xdb89fa(0x162)+_0xdb89fa(0xeb)+_0xdb89fa(0xf5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0xdb89fa(0x17a)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x44e693+'\x20'+_0xdb89fa(0x117)+'</table>'+_0xdb89fa(0xac)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x240806[0x0][_0xdb89fa(0x16b)]+_0xdb89fa(0x174)+_0xdb89fa(0x13d)+'</div>'+_0xdb89fa(0xbb)};_0x5bb32d[_0xdb89fa(0xc6)](_0x3476d3,function(_0x581421,_0x29ad0e){var _0x569c04=_0xdb89fa;_0x581421?(console['log'](_0x581421),console[_0x569c04(0x14a)](_0x569c04(0xdf))):console[_0x569c04(0x14a)](_0x569c04(0xd4));}),_0x5665d4['flash']('success',_0xdb89fa(0xc5)),_0x17fab4[_0xdb89fa(0xf2)]('/picking_list/PDF_transfer_rm/'+_0x303349[_0xdb89fa(0x171)]);}catch(_0x545adb){console[_0xdb89fa(0x170)](_0x545adb),_0x17fab4[_0xdb89fa(0xd2)](0x1f4)[_0xdb89fa(0xed)]({'Perror':_0xdb89fa(0x168),'message':_0x545adb[_0xdb89fa(0x113)]});}})[_0x585edd(0xfc)](_0x2b9964=>{var _0x4638cf=_0x585edd;console[_0x4638cf(0x170)](_0x2b9964),_0x17fab4[_0x4638cf(0xd2)](0x1f4)[_0x4638cf(0xed)]({'Perror':_0x4638cf(0x17b)});});}catch(_0x55685d){_0x17fab4[_0x585edd(0xed)](_0x55685d);}}catch(_0x11de55){console[_0x585edd(0x170)](_0x11de55),_0x17fab4[_0x585edd(0xd2)](0x1f4)[_0x585edd(0xed)]({'Merror':_0x585edd(0x168),'Message':_0x11de55[_0x585edd(0x113)]});}})[_0x385556(0xfc)](_0x31f138=>{var _0x532d5d=_0x385556;console['error'](_0x31f138),_0x17fab4[_0x532d5d(0xd2)](0x1f4)[_0x532d5d(0xed)]({'Merror':_0x532d5d(0x17b)});});}catch(_0x202df1){console[_0x385556(0x14a)](_0x202df1);}});function a0_0x433f(){var _0x2b2f48=['password','</tbody>','To_invoice','$product.from_room_name','Enabled','$product_details.maxPerUnit','/barcode_scanner','</td>','$product_details.unit','../public/language/languages.json','from_prod_level','Spanish','1NIjmSx','body','to_floorlevel','bay','$product_details.secondary_unit','concat','production_date','Ambient','from_prod_pallet','Portuguese','from_quantity','floorlevel','rack','$room','Portuguese\x20(BR)','flash','from_prod_qty','product_stock','English','from_room_name','$date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view/:id','TRF-','$product_details.secondary_code','$product_details.expiry_date','edit_transfer_view','</div>','$finalize','/upload/','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','to_warehouse','type','Rack\x20A','Product\x20Transfer\x20successfully','string','Floor','product','<!DOCTYPE\x20html>','findOne','log','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$_id','Chinese','image','aggregate','$product_details.maxProducts','all','to_prod_isle','to_room_name','language','express','Arabic','unit','$product_details.product_code','date','Arabic\x20(ae)','$product_details.primary_code','80rWqxqO','$product_details.product_stock','role','warehouse','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','product_code3','exports','$to_warehouse','True','$name','An\x20error\x20occurred\x20while\x20saving\x20data.','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Raw\x20Materials','site_title','36IMQCEO','</head><body>','$product_details.batch_code','/preview/:id','error','_id','to_prod_qty','../models/all_models','</h5>','to_invoice','errors','$product_details.production_date','then','$product_details.storage','</tr>','An\x20error\x20occurred.','$product_details.isle','split','$from_warehouse','from_warehouse','157547nRIEyZ','55VQnsdj','to_types','params','$product_details.rack','2048vLesKW','$product_details.bay','to_bin','Router','New_Qty_Converted','30540wvuTmN','$product_details','Enclosed','primary_code','staff','product_details','from_rak','note','Rack\x20C','There\x27s\x20a\x20error\x20in\x20this\x20transaction','slice','<table\x20style=\x22width:\x20100%\x20!important;\x22>','post','to_room','<div>','from_types','German','/barcode_scanner3','Return\x20Rooms','storage','$invoice','length','filter','product_code','/view','user','master','from_invoice','Receiving\x20Area','</body></html>','find','Rack\x20B','Rack\x20E','from_rack','maxperunit','6912VnWgoo','/view/add_transfer','436850yHIHGZ','secondary_unit','Transfer\x20Finalize\x20Successfully','sendMail','$product_details._id','findById','Hindi','prod_name','to_bay','6eAfaxL','createTransport','add_transfer','142368LDPWmw','Rack\x20F','Logo.png','status','updateOne','Email\x20sent\x20successfully','Shelves','secondary_code','../middleware/auth','from_bay','success','toString','/transfer/view','to_prod_pallet','product_name','maxProducts','Error\x20Occurs','batch_code','Level','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_quantity','nodemailer','save','$product_details.level','from_floorlevel','2192ayfrns','floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','1320487uFAFhk','json','<span\x20style=\x22float:\x20right;\x22>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','finalize','email','redirect','Transfer\x20Edit\x20Successfully','French','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','\x20</h2>','from_room','back','forEach','from_bin','English\x20(US)','catch','prod_cat','$product_details.floorlevel','<tr>','bin','$product_details.product_name','$product_details.type','$product_details.pallet','map','push','from_storage','MaxStocks_data2','expiry_date','</span>','RMSEmail','Transfer\x20Mail','max_per_unit','from_prod_isle','primary_unit','$product_details.bin','RoomAssigned','transfer','get','message','to_prod_level','port'];a0_0x433f=function(){return _0x2b2f48;};return a0_0x433f();}function BayBinSelected(_0x20bd03,_0x2595ed){var _0xdacd49=a0_0x137580,_0x18ab89=[],_0x4a821a=[],_0x4cfa95=[],_0xa33fe9=[],_0x449866=[],_0x27b993=[];let _0x4553d7=[];if(_0x20bd03=='DRY\x20STORAGE')switch(_0x2595ed){case _0xdacd49(0x143):_0x18ab89=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4a821a=[0x1,0x2],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=[_0xdacd49(0xe1),_0xdacd49(0x146)],_0x449866=['D'],_0x27b993=['A'];break;case _0xdacd49(0xbd):_0x18ab89=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4a821a=[0x1,0x2],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=[_0xdacd49(0xe1),_0xdacd49(0x146)],_0x449866=['D'],_0x27b993=['B'];break;case _0xdacd49(0xd5):_0x18ab89=[0x0],_0x4a821a=[0x0],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=[_0xdacd49(0x146)],_0x449866=['D'],_0x27b993=['S'];break;case _0xdacd49(0xba):_0x18ab89=[0x0],_0x4a821a=[0x0],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x4cfa95=[_0xdacd49(0x146)],_0x449866=['D'],_0x27b993=['R'];break;}else{if(_0x20bd03=='COLD\x20STORAGE')switch(_0x2595ed){case _0xdacd49(0x143):_0x18ab89=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4a821a=['B','F'],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=['Level',_0xdacd49(0x146)],_0x449866=['C'],_0x27b993=['A'];break;case'Rack\x20B':_0x18ab89=[0x5,0x4,0x3,0x2,0x1],_0x4a821a=['F','B','S'],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=[_0xdacd49(0xe1),_0xdacd49(0x146)],_0x449866=['C'],_0x27b993=['B'];break;case _0xdacd49(0xa6):_0x18ab89=[0x1,0x2,0x3,0x4,0x5],_0x4a821a=['B','F','S'],_0xa33fe9=[0x5,0x4,0x3,0x2,0x1],_0x4cfa95=[_0xdacd49(0xe1),'Floor'],_0x449866=['C'],_0x27b993=['C'];break;case'Rack\x20D':_0x18ab89=[0x5,0x4,0x3,0x2,0x1],_0x4a821a=['F','B','S'],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=[_0xdacd49(0xe1),_0xdacd49(0x146)],_0x449866=['C'],_0x27b993=['D'];break;case _0xdacd49(0xbe):_0x18ab89=[0x4,0x3,0x2,0x1],_0x4a821a=[0x1,0x2],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=['Level',_0xdacd49(0x146)],_0x449866=['C'],_0x27b993=['E'];break;case _0xdacd49(0xd0):_0x18ab89=[0x1,0x2,0x3],_0x4a821a=[0x1,0x2],_0xa33fe9=[0x1,0x2,0x3,0x4,0x5],_0x4cfa95=[_0xdacd49(0xe1)],_0x449866=['C'],_0x27b993=['F'];break;}}return{'levels':_0x18ab89,'Isle':_0x4a821a,'rack':_0xa33fe9,'type':_0x4cfa95,'storage':_0x449866,'rak':_0x27b993};}router[a0_0x137580(0x112)](a0_0x137580(0x138),auth,async(_0x5653dd,_0x440f0b)=>{var _0x3ca204=a0_0x137580;try{const {username:_0x557eb0,email:_0xb9b7ad,role:_0x302434}=_0x5653dd[_0x3ca204(0xb7)],_0x4fe781=_0x5653dd[_0x3ca204(0xb7)],_0x121cb8=await profile[_0x3ca204(0x149)]({'email':_0x4fe781[_0x3ca204(0xf1)]}),_0x33c94f=await master_shop[_0x3ca204(0xbc)](),_0x46b39a=await transfers[_0x3ca204(0xc8)](_0x5653dd[_0x3ca204(0x183)]['id']);let _0x2336d;if(_0x4fe781[_0x3ca204(0x15f)]==_0x3ca204(0xa2)){const _0x2dd7cf=await staff['findOne']({'email':_0x4fe781[_0x3ca204(0xf1)]});_0x2336d=await warehouse['aggregate']([{'$match':{'status':_0x3ca204(0x11a),'name':_0x2dd7cf[_0x3ca204(0x160)],'warehouse_category':_0x3ca204(0x16a)}},{'$group':{'_id':_0x3ca204(0x167),'name':{'$first':_0x3ca204(0x167)}}}]);}else _0x2336d=await warehouse['aggregate']([{'$match':{'status':_0x3ca204(0x11a),'warehouse_category':_0x3ca204(0x16a)}},{'$group':{'_id':_0x3ca204(0x167),'name':{'$first':_0x3ca204(0x167)}}}]);const _0x6b67ce=await warehouse[_0x3ca204(0x150)]([{'$match':{'name':_0x46b39a['from_warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x3ca204(0x18b)},{'$group':{'_id':_0x3ca204(0xc7),'name':{'$first':_0x3ca204(0x101)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3ca204(0x186)},'bin':{'$first':_0x3ca204(0x10f)},'type':{'$first':_0x3ca204(0x102)},'floorlevel':{'$first':_0x3ca204(0xfe)},'primary_code':{'$first':_0x3ca204(0x15c)},'secondary_code':{'$first':_0x3ca204(0x13a)},'product_code':{'$first':_0x3ca204(0x159)},'storage':{'$first':_0x3ca204(0x179)},'rack':{'$first':_0x3ca204(0x184)},'expiry_date':{'$first':_0x3ca204(0x13b)},'production_date':{'$first':_0x3ca204(0x177)},'room':{'$first':_0x3ca204(0x12f)}}}]),_0x287bcb=await product[_0x3ca204(0xbc)]({}),_0x28b741=BayBinSelected(_0x46b39a[_0x3ca204(0x141)],_0x46b39a['to_room']);if(_0x33c94f[0x0][_0x3ca204(0x155)]==_0x3ca204(0xfb)){var _0x1bfdb2=users[_0x3ca204(0x134)];console[_0x3ca204(0x14a)](_0x1bfdb2);}else{if(_0x33c94f[0x0][_0x3ca204(0x155)]==_0x3ca204(0xc9))var _0x1bfdb2=users['Hindi'];else{if(_0x33c94f[0x0]['language']=='German')var _0x1bfdb2=users['German'];else{if(_0x33c94f[0x0]['language']==_0x3ca204(0x121))var _0x1bfdb2=users['Spanish'];else{if(_0x33c94f[0x0][_0x3ca204(0x155)]==_0x3ca204(0xf4))var _0x1bfdb2=users[_0x3ca204(0xf4)];else{if(_0x33c94f[0x0][_0x3ca204(0x155)]==_0x3ca204(0x130))var _0x1bfdb2=users[_0x3ca204(0x12b)];else{if(_0x33c94f[0x0][_0x3ca204(0x155)]=='Chinese')var _0x1bfdb2=users[_0x3ca204(0x14e)];else{if(_0x33c94f[0x0][_0x3ca204(0x155)]==_0x3ca204(0x15b))var _0x1bfdb2=users[_0x3ca204(0x157)];}}}}}}}_0x440f0b['render']('edit_transfer',{'success':_0x5653dd[_0x3ca204(0x131)](_0x3ca204(0xd9)),'errors':_0x5653dd[_0x3ca204(0x131)](_0x3ca204(0x176)),'role':_0x4fe781,'profile':_0x121cb8,'master_shop':_0x33c94f,'warehouse':_0x2336d,'transfer':_0x46b39a,'stock':_0x6b67ce,'unit':_0x287bcb,'language':_0x1bfdb2});}catch(_0x5c8008){console[_0x3ca204(0x14a)](_0x5c8008);}}),router['post']('/view/:id',auth,async(_0x10f9da,_0x2bd588)=>{var _0x521593=a0_0x137580;try{const _0x1b2085=_0x10f9da[_0x521593(0x183)]['id'],_0x29295d=await transfers[_0x521593(0xc8)](_0x1b2085);_0x2bd588['json'](_0x10f9da['body']);return;const {date:_0x4f1904,from_warehouse:_0x58b207,FromRoom_name:_0x2ef54d,to_warehouse:_0x8277c3,ToRoom_name:_0x31a048,prod_name:_0x1fed4c,from_prod_qty:_0x4cbd1d,from_prod_level:_0xd4aa5d,from_prod_isle:_0x85118a,from_prod_pallet:_0x19347d,to_prod_qty:_0x494e17,to_prod_level:_0x177176,to_prod_isle:_0x271d00,to_prod_pallet:_0x1f36c6,primary_code:_0x466ddc,secondary_code:_0x572150,product_code3:_0x4cc65b,note:_0x5ae6bd,invoice:_0xba913f,expiry_date:_0x10dc54}=_0x10f9da[_0x521593(0x123)];if(typeof _0x1fed4c==_0x521593(0x145))var _0x3d459f=[_0x10f9da[_0x521593(0x123)][_0x521593(0xca)]],_0x9f004c=[_0x10f9da['body']['from_prod_qty']],_0x2e2f10=[_0x10f9da[_0x521593(0x123)]['from_prod_level']],_0x9c1db0=[_0x10f9da['body'][_0x521593(0x10d)]],_0xd4dc07=[_0x10f9da[_0x521593(0x123)][_0x521593(0x12a)]],_0x1e3786=[_0x10f9da['body'][_0x521593(0xad)]],_0x254e43=[_0x10f9da[_0x521593(0x123)][_0x521593(0x172)]],_0x37fcc0=[_0x10f9da[_0x521593(0x123)][_0x521593(0x114)]],_0x4d6c56=[_0x10f9da[_0x521593(0x123)][_0x521593(0x153)]],_0x4307b1=[_0x10f9da[_0x521593(0x123)][_0x521593(0xdc)]],_0x3e3d6b=[_0x10f9da[_0x521593(0x123)][_0x521593(0x182)]],_0x5bb9d7=[_0x10f9da[_0x521593(0x123)][_0x521593(0xb1)]],_0xb8baee=[_0x10f9da[_0x521593(0x123)]['rak']],_0x52def8=[_0x10f9da[_0x521593(0x123)][_0x521593(0xa1)]],_0x2bdd01=[_0x10f9da[_0x521593(0x123)][_0x521593(0xd6)]],_0x7f2029=[_0x10f9da[_0x521593(0x123)][_0x521593(0x163)]],_0x5a1319=[_0x10f9da[_0x521593(0x123)][_0x521593(0x107)]],_0x51a6d4=[_0x10f9da[_0x521593(0x123)][_0x521593(0x158)]],_0x2049d4=[_0x10f9da[_0x521593(0x123)][_0x521593(0xc4)]],_0x2b868b=[_0x10f9da[_0x521593(0x123)][_0x521593(0xe0)]],_0x293efb=[_0x10f9da[_0x521593(0x123)][_0x521593(0x108)]],_0x1ca945=[_0x10f9da[_0x521593(0x123)]['from_storage']],_0x4808ea=[_0x10f9da['body'][_0x521593(0xa4)]];else var _0x3d459f=[..._0x10f9da['body'][_0x521593(0xca)]],_0x5bb9d7=[..._0x10f9da['body'][_0x521593(0xb1)]],_0xb8baee=[..._0x10f9da['body']['rak']],_0x1e3786=[..._0x10f9da[_0x521593(0x123)][_0x521593(0xad)]],_0x3e3d6b=[..._0x10f9da[_0x521593(0x123)][_0x521593(0x182)]],_0x9f004c=[..._0x10f9da[_0x521593(0x123)][_0x521593(0x132)]],_0x2e2f10=[..._0x10f9da[_0x521593(0x123)]['from_prod_level']],_0x9c1db0=[..._0x10f9da[_0x521593(0x123)][_0x521593(0x10d)]],_0xd4dc07=[..._0x10f9da['body']['from_prod_pallet']],_0x254e43=[..._0x10f9da[_0x521593(0x123)]['to_prod_qty']],_0x37fcc0=[..._0x10f9da['body'][_0x521593(0x114)]],_0x4d6c56=[..._0x10f9da['body'][_0x521593(0x153)]],_0x4307b1=[..._0x10f9da['body'][_0x521593(0xdc)]],_0x52def8=[..._0x10f9da['body'][_0x521593(0xa1)]],_0x2bdd01=[..._0x10f9da[_0x521593(0x123)][_0x521593(0xd6)]],_0x7f2029=[..._0x10f9da[_0x521593(0x123)][_0x521593(0x163)]],_0x5a1319=[..._0x10f9da[_0x521593(0x123)][_0x521593(0x107)]],_0x51a6d4=[..._0x10f9da[_0x521593(0x123)][_0x521593(0x158)]],_0x2049d4=[..._0x10f9da[_0x521593(0x123)][_0x521593(0xc4)]],_0x2b868b=[..._0x10f9da['body']['batch_code']],_0x293efb=[..._0x10f9da[_0x521593(0x123)]['expiry_date']],_0x1ca945=[..._0x10f9da['body']['from_storage']],_0x4808ea=[..._0x10f9da['body'][_0x521593(0xa4)]];const _0x37653e=_0x3d459f[_0x521593(0x104)](_0x4151e1=>{return _0x4151e1={'product_name':_0x4151e1};});_0x9f004c['forEach']((_0xbb3e6c,_0x4f795a)=>{var _0x57ddb2=_0x521593;_0x37653e[_0x4f795a][_0x57ddb2(0x12c)]=_0xbb3e6c;}),_0x2e2f10[_0x521593(0xf9)]((_0xee5554,_0x142023)=>{var _0x24e6e6=_0x521593;_0x37653e[_0x142023][_0x24e6e6(0xd8)]=_0xee5554;}),_0x9c1db0[_0x521593(0xf9)]((_0x1a84d2,_0x151578)=>{var _0x3ad661=_0x521593;_0x37653e[_0x151578][_0x3ad661(0xfa)]=_0x1a84d2;}),_0xd4dc07['forEach']((_0x3d0833,_0x143ee3)=>{var _0x5978f6=_0x521593;_0x37653e[_0x143ee3][_0x5978f6(0xe8)]=_0x3d0833;}),_0x254e43[_0x521593(0xf9)]((_0x42f45c,_0x2b0bc5)=>{var _0x429dd1=_0x521593;_0x37653e[_0x2b0bc5][_0x429dd1(0xe4)]=_0x42f45c;}),_0x37fcc0['forEach']((_0x2913d0,_0xaaa958)=>{var _0xa09152=_0x521593;_0x37653e[_0xaaa958][_0xa09152(0xcb)]=_0x2913d0;}),_0x4d6c56[_0x521593(0xf9)]((_0x18a169,_0x3199ef)=>{var _0x8bc56c=_0x521593;_0x37653e[_0x3199ef][_0x8bc56c(0x187)]=_0x18a169;}),_0x4307b1[_0x521593(0xf9)]((_0x3c95c4,_0x3aa963)=>{_0x37653e[_0x3aa963]['to_floorlevel']=_0x3c95c4;}),_0x52def8[_0x521593(0xf9)]((_0x5a5676,_0xde4c50)=>{var _0x3d5a5b=_0x521593;_0x37653e[_0xde4c50][_0x3d5a5b(0xa1)]=_0x5a5676;}),_0x2bdd01[_0x521593(0xf9)]((_0x46b1b9,_0x176de5)=>{_0x37653e[_0x176de5]['secondary_code']=_0x46b1b9;}),_0x7f2029[_0x521593(0xf9)]((_0x22de3c,_0x4c0b5e)=>{var _0x232503=_0x521593;_0x37653e[_0x4c0b5e][_0x232503(0xb5)]=_0x22de3c;}),_0x5a1319[_0x521593(0xf9)]((_0x9d2424,_0x1710a4)=>{var _0x5d279c=_0x521593;_0x37653e[_0x1710a4][_0x5d279c(0xde)]=_0x9d2424;}),_0x51a6d4[_0x521593(0xf9)]((_0x20fb9a,_0x2b63c4)=>{var _0x2f60c8=_0x521593;_0x37653e[_0x2b63c4][_0x2f60c8(0x158)]=_0x20fb9a;}),_0x2049d4[_0x521593(0xf9)]((_0xc63ff7,_0x5724a8)=>{var _0x5ed0aa=_0x521593;_0x37653e[_0x5724a8][_0x5ed0aa(0xc4)]=_0xc63ff7;}),_0x2b868b[_0x521593(0xf9)]((_0x1d92a4,_0x34e151)=>{var _0x1a3e1d=_0x521593;_0x37653e[_0x34e151][_0x1a3e1d(0xe0)]=_0x1d92a4;}),_0x293efb['forEach']((_0x1d7202,_0x51387e)=>{var _0x141c4d=_0x521593;_0x37653e[_0x51387e][_0x141c4d(0x108)]=_0x1d7202;}),_0x5bb9d7[_0x521593(0xf9)]((_0x12b4fb,_0x29eab8)=>{var _0x3504b0=_0x521593;_0x37653e[_0x29eab8][_0x3504b0(0xb1)]=_0x12b4fb;}),_0xb8baee[_0x521593(0xf9)]((_0x236e0e,_0x1da2ef)=>{var _0x5c00a4=_0x521593;_0x37653e[_0x1da2ef][_0x5c00a4(0x12e)]=_0x236e0e;}),_0x1e3786[_0x521593(0xf9)]((_0x2f9236,_0x3b2a00)=>{_0x37653e[_0x3b2a00]['from_types']=_0x2f9236;}),_0x3e3d6b[_0x521593(0xf9)]((_0x34d275,_0x4dd7c5)=>{var _0x537ef6=_0x521593;_0x37653e[_0x4dd7c5][_0x537ef6(0x182)]=_0x34d275;}),_0x1ca945[_0x521593(0xf9)]((_0x20a8e5,_0x2bf389)=>{_0x37653e[_0x2bf389]['from_storage']=_0x20a8e5;}),_0x4808ea[_0x521593(0xf9)]((_0x10b2f1,_0x1571fb)=>{var _0x3d14b1=_0x521593;_0x37653e[_0x1571fb][_0x3d14b1(0xbf)]=_0x10b2f1;});const _0x57c724=_0x37653e[_0x521593(0xb4)](_0x554a9b=>_0x554a9b[_0x521593(0xe4)]!=='0'&&_0x554a9b[_0x521593(0xe4)]!==''||_0x554a9b[_0x521593(0x124)]!=='0'&&_0x554a9b[_0x521593(0x124)]!=='');var _0x25977a=0x0;_0x57c724['forEach'](_0x498f39=>{var _0x1508b6=_0x521593;parseInt(_0x498f39[_0x1508b6(0x12c)])<parseInt(_0x498f39[_0x1508b6(0xe4)])&&_0x25977a++;});if(_0x25977a!=0x0)return _0x10f9da[_0x521593(0x131)](_0x521593(0x176),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2bd588[_0x521593(0xf2)](_0x521593(0xf8));const _0xa74851=await warehouse[_0x521593(0x149)]({'name':_0x29295d[_0x521593(0x17f)],'room':_0x29295d[_0x521593(0xf7)]});_0x29295d[_0x521593(0x147)][_0x521593(0xf9)](_0x1dad12=>{var _0x28b208=_0x521593;if(_0x1dad12[_0x28b208(0xe4)]>0x0){const _0x540301=_0xa74851[_0x28b208(0xa3)][_0x28b208(0x104)](_0x2a7489=>{var _0x1ba357=_0x28b208;_0x2a7489['product_name']==_0x1dad12['product_name']&&_0x2a7489[_0x1ba357(0x12d)]==_0x1dad12[_0x1ba357(0xe8)]&&_0x2a7489[_0x1ba357(0x142)]==_0x1dad12[_0x1ba357(0xad)]&&_0x2a7489['bin']==_0x1dad12['from_bin']&&_0x2a7489[_0x1ba357(0x125)]==_0x1dad12[_0x1ba357(0xd8)]&&_0x2a7489['rack']==_0x1dad12[_0x1ba357(0xbf)]&&_0x2a7489[_0x1ba357(0xb1)]==_0x1dad12[_0x1ba357(0x106)]&&(_0x2a7489[_0x1ba357(0x133)]=parseInt(_0x2a7489[_0x1ba357(0x133)])+parseInt(_0x1dad12[_0x1ba357(0xe4)]));});}}),await _0xa74851['save']();const _0x3eb142=await warehouse['findOne']({'name':_0x29295d[_0x521593(0x141)],'room':_0x29295d[_0x521593(0xab)]});_0x29295d[_0x521593(0x147)][_0x521593(0xf9)](_0x2fcad2=>{var _0xf64613=_0x521593;if(_0x2fcad2[_0xf64613(0xe4)]>0x0){const _0x35ab09=_0x3eb142[_0xf64613(0xa3)][_0xf64613(0x104)](_0x48df3f=>{var _0x25bfcf=_0xf64613;_0x48df3f['product_name']==_0x2fcad2['product_name']&&_0x48df3f[_0x25bfcf(0x12d)]==_0x2fcad2['to_floorlevel']&&_0x48df3f[_0x25bfcf(0x142)]==_0x2fcad2[_0x25bfcf(0x182)]&&_0x48df3f[_0x25bfcf(0x100)]==_0x2fcad2[_0x25bfcf(0x187)]&&_0x48df3f['bay']==_0x2fcad2[_0x25bfcf(0xcb)]&&_0x48df3f[_0x25bfcf(0x12e)]==_0x2fcad2[_0x25bfcf(0x12e)]&&_0x48df3f[_0x25bfcf(0xb1)]==_0x2fcad2[_0x25bfcf(0xb1)]&&(_0x48df3f[_0x25bfcf(0x133)]=parseInt(_0x48df3f[_0x25bfcf(0x133)])-parseInt(_0x2fcad2[_0x25bfcf(0xe4)]));});}}),await _0x3eb142['save'](),_0x29295d[_0x521593(0x15a)]=_0x4f1904,_0x29295d[_0x521593(0x17f)]=_0x58b207,_0x29295d[_0x521593(0x141)]=_0x8277c3,_0x29295d[_0x521593(0x147)]=_0x57c724,_0x29295d[_0x521593(0xa5)]=_0x5ae6bd,_0x29295d['invoice']=_0xba913f;const _0x397d6f=await _0x29295d[_0x521593(0xe6)]();console[_0x521593(0x14a)](_0x397d6f);const _0x483767=await warehouse[_0x521593(0x149)]({'name':_0x58b207,'room':_0x2ef54d});_0x397d6f[_0x521593(0x147)][_0x521593(0xf9)](_0x3876f1=>{var _0x231a19=_0x521593;if(_0x3876f1[_0x231a19(0xe4)]>0x0){const _0x4d8833=_0x483767[_0x231a19(0xa3)]['map'](_0x3a95d7=>{var _0x5d15cf=_0x231a19;_0x3a95d7[_0x5d15cf(0xdd)]==_0x3876f1[_0x5d15cf(0xdd)]&&_0x3a95d7[_0x5d15cf(0x12d)]==_0x3876f1['from_floorlevel']&&_0x3a95d7[_0x5d15cf(0x142)]==_0x3876f1['from_types']&&_0x3a95d7['bin']==_0x3876f1[_0x5d15cf(0xfa)]&&_0x3a95d7[_0x5d15cf(0x125)]==_0x3876f1[_0x5d15cf(0xd8)]&&_0x3a95d7['rack']==_0x3876f1[_0x5d15cf(0xbf)]&&_0x3a95d7[_0x5d15cf(0xb1)]==_0x3876f1['from_storage']&&(_0x3a95d7[_0x5d15cf(0x133)]=parseInt(_0x3a95d7[_0x5d15cf(0x133)])-parseInt(_0x3876f1[_0x5d15cf(0xe4)]));});}}),await _0x483767[_0x521593(0xe6)]();const _0x443baa=await warehouse[_0x521593(0x149)]({'name':_0x8277c3,'room':_0x31a048});_0x397d6f[_0x521593(0x147)][_0x521593(0xf9)](_0x3fea8a=>{var _0xa34c3f=_0x521593;if(_0x3fea8a[_0xa34c3f(0xe4)]>0x0){var _0x1e1b96=0x0;const _0x365bba=_0x443baa[_0xa34c3f(0xa3)][_0xa34c3f(0x104)](_0x36bc18=>{var _0x13fa3c=_0xa34c3f;_0x36bc18[_0x13fa3c(0xdd)]==_0x3fea8a['product_name']&&_0x36bc18['floorlevel']==_0x3fea8a[_0x13fa3c(0x124)]&&_0x36bc18[_0x13fa3c(0x142)]==_0x3fea8a[_0x13fa3c(0x182)]&&_0x36bc18['bin']==_0x3fea8a[_0x13fa3c(0x187)]&&_0x36bc18[_0x13fa3c(0x125)]==_0x3fea8a[_0x13fa3c(0xcb)]&&_0x36bc18[_0x13fa3c(0x12e)]==_0x3fea8a[_0x13fa3c(0x12e)]&&_0x36bc18['storage']==_0x3fea8a[_0x13fa3c(0xb1)]&&(_0x36bc18[_0x13fa3c(0x133)]=parseInt(_0x36bc18[_0x13fa3c(0x133)])+parseInt(_0x3fea8a[_0x13fa3c(0xe4)]),_0x1e1b96++);});_0x1e1b96=='0'&&(_0x443baa[_0xa34c3f(0xa3)]=_0x443baa[_0xa34c3f(0xa3)][_0xa34c3f(0x127)]({'product_name':_0x3fea8a[_0xa34c3f(0xdd)],'product_stock':_0x3fea8a[_0xa34c3f(0xe4)],'bay':_0x3fea8a[_0xa34c3f(0xcb)],'bin':_0x3fea8a[_0xa34c3f(0x187)],'type':_0x3fea8a[_0xa34c3f(0x182)],'floorlevel':_0x3fea8a['to_floorlevel'],'storage':_0x3fea8a[_0xa34c3f(0xb1)],'rack':_0x3fea8a['rack'],'product_code':_0x3fea8a[_0xa34c3f(0xb5)],'primary_code':_0x3fea8a[_0xa34c3f(0xa1)],'secondary_code':_0x3fea8a[_0xa34c3f(0xd6)],'maxProducts':_0x3fea8a[_0xa34c3f(0xde)],'storage':_0x3fea8a[_0xa34c3f(0xb1)],'rack':_0x3fea8a[_0xa34c3f(0x12e)]}));}}),await _0x443baa[_0x521593(0xe6)](),_0x10f9da[_0x521593(0x131)]('success',_0x521593(0xf3)),_0x2bd588['redirect'](_0x521593(0xdb));}catch(_0x376fd1){console['log'](_0x376fd1);}}),router[a0_0x137580(0xaa)](a0_0x137580(0x11c),async(_0x59e6ed,_0x54d7ea)=>{var _0x4cc9e9=a0_0x137580;const {FromWareHouse:_0x324445,FromRoom:_0x747e32,ToWarehouse:_0x2ac600,ToRoom:_0x483035,primary_code:_0x4b3e21,Roomslist:_0x55875d}=_0x59e6ed[_0x4cc9e9(0x123)],_0x371e35=_0x55875d[_0x4cc9e9(0x17d)](','),_0x16ecf1=[];async function _0x3496c5(_0x3a85b7){var _0xbb5b29=_0x4cc9e9;const _0x36823d=await warehouse[_0xbb5b29(0x150)]([{'$match':{'name':_0x324445,'room':_0x3a85b7}},{'$unwind':_0xbb5b29(0x18b)},{'$match':{'product_details.primary_code':_0x4b3e21}},{'$group':{'_id':_0xbb5b29(0xc7),'name':{'$first':_0xbb5b29(0x101)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xbb5b29(0x15c)},'secondary_code':{'$first':_0xbb5b29(0x13a)},'product_code':{'$first':_0xbb5b29(0x159)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xbb5b29(0x102)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0xbb5b29(0x11e)},'secondary_unit':{'$first':_0xbb5b29(0x126)},'storage':{'$first':_0xbb5b29(0x179)},'rack':{'$first':_0xbb5b29(0x184)},'expiry_date':{'$first':_0xbb5b29(0x13b)},'production_date':{'$first':_0xbb5b29(0x177)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0xbb5b29(0x11b)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0xbb5b29(0x12f)},'maxProducts':{'$first':_0xbb5b29(0x151)}}}]),_0x21fd7a=await warehouse[_0xbb5b29(0x150)]([{'$match':{'name':_0x324445,'room':_0x3a85b7}},{'$unwind':_0xbb5b29(0x18b)},{'$match':{'product_details.secondary_code':_0x4b3e21}},{'$group':{'_id':_0xbb5b29(0xc7),'name':{'$first':_0xbb5b29(0x101)},'instock':{'$first':_0xbb5b29(0x15e)},'primary_code':{'$first':_0xbb5b29(0x15c)},'secondary_code':{'$first':_0xbb5b29(0x13a)},'product_code':{'$first':_0xbb5b29(0x159)},'level':{'$first':_0xbb5b29(0x186)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xbb5b29(0x102)},'pallet':{'$first':_0xbb5b29(0xfe)},'unit':{'$first':_0xbb5b29(0x11e)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xbb5b29(0x179)},'rack':{'$first':_0xbb5b29(0x184)},'expiry_date':{'$first':_0xbb5b29(0x13b)},'production_date':{'$first':_0xbb5b29(0x177)},'batch_code':{'$first':_0xbb5b29(0x16e)},'maxPerUnit':{'$first':_0xbb5b29(0x11b)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0xbb5b29(0x151)}}}]);if(_0x36823d['length']>0x0)_0x16ecf1[_0xbb5b29(0x105)](_0x36823d);else _0x21fd7a[_0xbb5b29(0xb3)]>0x0&&_0x16ecf1[_0xbb5b29(0x105)](_0x21fd7a);}const _0x5315fe=_0x371e35[_0x4cc9e9(0x104)](_0x2f3f2c=>_0x3496c5(_0x2f3f2c));await Promise[_0x4cc9e9(0x152)](_0x5315fe),_0x54d7ea[_0x4cc9e9(0xed)](_0x16ecf1);}),router[a0_0x137580(0xaa)]('/barcode_scanner2',async(_0x2c00d3,_0xee6fa5)=>{var _0x4da1d3=a0_0x137580;try{const {FromWareHouse:_0x3f7b70,FromRoom:_0xc09394,ToWarehouse:_0x56ca99,ToRoom:_0x3c3329,secondary_code:_0x158278}=_0x2c00d3[_0x4da1d3(0x123)],_0x488838=await warehouse['aggregate']([{'$match':{'name':_0x3f7b70}},{'$unwind':_0x4da1d3(0x18b)},{'$match':{'product_details.secondary_code':_0x158278}},{'$group':{'_id':_0x4da1d3(0xc7),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4da1d3(0x13a)},'product_code':{'$first':_0x4da1d3(0x159)},'instock':{'$first':_0x4da1d3(0x15e)},'warehouse':{'$first':_0x4da1d3(0x167)},'level':{'$first':_0x4da1d3(0xe7)},'isle':{'$first':_0x4da1d3(0x17c)},'pallet':{'$first':_0x4da1d3(0x103)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x4da1d3(0x11e)}}}]);_0xee6fa5[_0x4da1d3(0xd2)](0xc8)[_0x4da1d3(0xed)](_0x488838);}catch(_0x38e0a8){_0xee6fa5['status'](0x194)['json']({'message':_0x38e0a8[_0x4da1d3(0x113)]});}}),router[a0_0x137580(0xaa)](a0_0x137580(0xaf),async(_0x3aa139,_0xf8c314)=>{var _0x44da93=a0_0x137580;try{const {FromWareHouse:_0x94f7aa,FromRoom:_0x24cf42,ToWarehouse:_0x3287ee,ToRoom:_0xcacfa2,product_code:_0x30196e}=_0x3aa139[_0x44da93(0x123)],_0x28c4f7=await warehouse[_0x44da93(0x150)]([{'$match':{'name':_0x94f7aa}},{'$unwind':_0x44da93(0x18b)},{'$match':{'product_details.product_code':_0x30196e}},{'$group':{'_id':_0x44da93(0xc7),'name':{'$first':_0x44da93(0x101)},'primary_code':{'$first':_0x44da93(0x15c)},'secondary_code':{'$first':_0x44da93(0x13a)},'product_code':{'$first':_0x44da93(0x159)},'instock':{'$first':_0x44da93(0x15e)},'warehouse':{'$first':'$name'},'level':{'$first':_0x44da93(0xe7)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x44da93(0x151)},'unit':{'$first':_0x44da93(0x11e)}}}]);_0xf8c314[_0x44da93(0xd2)](0xc8)[_0x44da93(0xed)](_0x28c4f7);}catch(_0x45c170){_0xf8c314[_0x44da93(0xd2)](0x194)[_0x44da93(0xed)]({'message':_0x45c170['message']});}}),router['post']('/CheckingWarehouse',async(_0x3946bf,_0x3e871e)=>{var _0x15bb4e=a0_0x137580;const {level:_0x5e7294,isle:_0x48ed14,pallet:_0x4556e7,warehouses:_0x185174,room:_0x328e10}=_0x3946bf['body'];try{const _0x9aa75f=await warehouse[_0x15bb4e(0x150)]([{'$match':{'name':_0x185174,'room':_0x328e10}},{'$unwind':_0x15bb4e(0x18b)},{'$match':{'product_details.level':parseInt(_0x5e7294),'product_details.isle':_0x48ed14,'product_details.pallet':parseInt(_0x4556e7)}},{'$group':{'_id':_0x15bb4e(0xc7),'name':{'$first':_0x15bb4e(0x101)},'product_stock':{'$first':_0x15bb4e(0x15e)},'level':{'$first':_0x15bb4e(0xe7)},'isle':{'$first':_0x15bb4e(0x17c)},'pallet':{'$first':_0x15bb4e(0x103)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x3e871e[_0x15bb4e(0xd2)](0xc8)[_0x15bb4e(0xed)](_0x9aa75f);}catch(_0x56999a){_0x3e871e[_0x15bb4e(0xd2)](0x194)['json']({'message':_0x56999a[_0x15bb4e(0x113)]});}}),module[a0_0x137580(0x164)]=router;