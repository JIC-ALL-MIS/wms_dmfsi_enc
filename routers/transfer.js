var a0_0x2b3321=a0_0x3313;(function(_0x328278,_0x628d9e){var _0xfbf800=a0_0x3313,_0x321f20=_0x328278();while(!![]){try{var _0x1a77c7=parseInt(_0xfbf800(0x173))/0x1*(-parseInt(_0xfbf800(0x1b9))/0x2)+-parseInt(_0xfbf800(0x1c2))/0x3*(parseInt(_0xfbf800(0x1dd))/0x4)+-parseInt(_0xfbf800(0x1bc))/0x5*(parseInt(_0xfbf800(0x201))/0x6)+-parseInt(_0xfbf800(0x1c5))/0x7*(-parseInt(_0xfbf800(0x1e2))/0x8)+parseInt(_0xfbf800(0x1fa))/0x9*(parseInt(_0xfbf800(0x17b))/0xa)+-parseInt(_0xfbf800(0x1f7))/0xb+parseInt(_0xfbf800(0x1e3))/0xc;if(_0x1a77c7===_0x628d9e)break;else _0x321f20['push'](_0x321f20['shift']());}catch(_0x197a25){_0x321f20['push'](_0x321f20['shift']());}}}(a0_0x39df,0xdc2d1));const express=require(a0_0x2b3321(0x14e)),app=express(),router=express[a0_0x2b3321(0x190)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x2b3321(0x18d)),auth=require('../middleware/auth'),users=require(a0_0x2b3321(0x222)),nodemailer=require(a0_0x2b3321(0x1dc));function a0_0x3313(_0x5f0049,_0x519dfb){var _0x39df9d=a0_0x39df();return a0_0x3313=function(_0x331389,_0x4c40c8){_0x331389=_0x331389-0x132;var _0x58aeee=_0x39df9d[_0x331389];return _0x58aeee;},a0_0x3313(_0x5f0049,_0x519dfb);}router[a0_0x2b3321(0x1ad)]('/view',auth,async(_0x30f2c7,_0x1d763e)=>{var _0x3ab56a=a0_0x2b3321;try{const {username:_0x175786,email:_0x1dc4ee,role:_0x411285}=_0x30f2c7[_0x3ab56a(0x139)],_0x535a01=_0x30f2c7[_0x3ab56a(0x139)],_0x7bd3ca=await profile[_0x3ab56a(0x218)]({'email':_0x535a01['email']}),_0x4f57a1=await master_shop[_0x3ab56a(0x1cf)]();console[_0x3ab56a(0x1f4)](_0x3ab56a(0x1d5),_0x4f57a1);let _0x5cda09;if(_0x535a01[_0x3ab56a(0x18f)]==_0x3ab56a(0x15b)){const _0x1b2a05=await staff[_0x3ab56a(0x218)]({'email':_0x535a01[_0x3ab56a(0x1a1)]});_0x5cda09=await transfers[_0x3ab56a(0x1cf)]({'from_warehouse':_0x1b2a05[_0x3ab56a(0x16b)]});}else _0x5cda09=await transfers[_0x3ab56a(0x1c1)]([{'$unwind':_0x3ab56a(0x1e9)},{'$group':{'_id':_0x3ab56a(0x1de),'invoice':{'$first':_0x3ab56a(0x1d0)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x3ab56a(0x14a)},'from_room_name':{'$addToSet':_0x3ab56a(0x223)},'to_room_name':{'$addToSet':_0x3ab56a(0x1b1)},'finalize':{'$first':_0x3ab56a(0x21c)},'isAllowEdit':{'$first':_0x3ab56a(0x1d8)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4f57a1[0x0][_0x3ab56a(0x191)]==_0x3ab56a(0x198)){var _0x532710=users['English'];console[_0x3ab56a(0x1f4)](_0x532710);}else{if(_0x4f57a1[0x0][_0x3ab56a(0x191)]==_0x3ab56a(0x1b6))var _0x532710=users['Hindi'];else{if(_0x4f57a1[0x0][_0x3ab56a(0x191)]=='German')var _0x532710=users[_0x3ab56a(0x17a)];else{if(_0x4f57a1[0x0]['language']==_0x3ab56a(0x1d7))var _0x532710=users[_0x3ab56a(0x1d7)];else{if(_0x4f57a1[0x0][_0x3ab56a(0x191)]==_0x3ab56a(0x216))var _0x532710=users[_0x3ab56a(0x216)];else{if(_0x4f57a1[0x0][_0x3ab56a(0x191)]==_0x3ab56a(0x194))var _0x532710=users['Portuguese'];else{if(_0x4f57a1[0x0]['language']==_0x3ab56a(0x197))var _0x532710=users[_0x3ab56a(0x197)];else{if(_0x4f57a1[0x0][_0x3ab56a(0x191)]==_0x3ab56a(0x180))var _0x532710=users[_0x3ab56a(0x15c)];}}}}}}}_0x1d763e[_0x3ab56a(0x163)](_0x3ab56a(0x183),{'success':_0x30f2c7[_0x3ab56a(0x15e)]('success'),'errors':_0x30f2c7[_0x3ab56a(0x15e)](_0x3ab56a(0x1e1)),'role':_0x535a01,'profile':_0x7bd3ca,'master_shop':_0x4f57a1,'transfer':_0x5cda09,'language':_0x532710});}catch(_0x523cd5){console[_0x3ab56a(0x1f4)](_0x523cd5);}});async function getRandom8DigitNumber(){var _0x452282=a0_0x2b3321;const _0x3bdb47=0x989680,_0x4857bd=0x5f5e0ff,_0x2ddfc9=Math[_0x452282(0x21e)](Math[_0x452282(0x204)]()*(_0x4857bd-_0x3bdb47+0x1))+_0x3bdb47;var _0x20f18a;const _0x3eb19b=await transfers['findOne']({'invoice':_0x452282(0x146)+_0x2ddfc9});return _0x3eb19b&&_0x3eb19b[_0x452282(0x1bb)]>0x0?_0x20f18a=_0x452282(0x146)+_0x2ddfc9:_0x20f18a='TRF-'+_0x2ddfc9,_0x20f18a;}function a0_0x39df(){var _0x44c20b=['Arabic','to_prod_isle','flash','date','redirect','$product_details.rack','To_invoice','render','Enabled','$product_details.unit','Return\x20Rooms','floorlevel','from_bin','Rack\x20E','\x20Order\x20Date\x20:\x20','warehouse','ToRoomAssigned','\x20Order\x20Number\x20:\x20','from_room_name','product_code3','expiry_date','from_prod_qty','forEach','1vNYPpE','/barcode_scanner2','rak','New_Qty_Converted','<html><head><title></title>','from_floorlevel','to_prod_pallet','German','3190exaZvP','getFullYear','bin','<strong>\x20Regards\x20</strong>','An\x20error\x20occurred\x20while\x20saving\x20data.','Arabic\x20(ae)','$product_details.type','$product_details.isle','transfer','sendMail','Enclosed','</tr>','<h2>\x20','max_per_unit','logo','bay','product_name','updateOne','../models/all_models','prod_cat','role','Router','language','<tbody\x20style=\x22text-align:\x20center;\x22>','/barcode_scanner','Portuguese\x20(BR)','Rack\x20B','<div>','Chinese','English\x20(US)','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','</h5>','getMonth','storage','/transfer/view','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','email','/picking_list/PDF_transfer_rm/','from_bay','from_warehouse','to_bin','/upload/','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','COLD\x20STORAGE','from_rack','MaxStocks_data2','_id','Transfer\x20Mail','get','Transfer\x20Edit\x20Successfully','<tr>','edit_transfer_view','$product.to_room_name','secondary_code','Error\x20Occurs','Transfer\x20Finalize\x20Successfully','product_code','Hindi','from_prod_level','$product_details','1897814rprntX','primary_unit','length','10cebXYf','Rack\x20C','host','to_types','maxProducts','aggregate','732WythZK','\x20</h2>','Level','14kNHeRq','message','then','findById','Shelves','RMSEmail','rack','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','batch_code','find','$invoice','post','Rack\x20A','to_quantity','invoice','master','to_prod_qty','Spanish','$isAllowEdit','all','</div>','<h5>','nodemailer','1992GINYIX','$_id','params','to_room','errors','658232eAgTmi','31974348PROVSh','</span>','site_title','$product_details.bay','slice','from_quantity','$product','maxperunit','$product_details.bin','RoomAssigned','$product_details.maxProducts','/barcode_scanner3','prod_name','to_prod_level','An\x20error\x20occurred.','Rack\x20F','from_prod_pallet','log','to_invoice','$product_details.maxPerUnit','633754HhujTc','string','secondary_unit','21519tmuNgg','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','to_bay','add_transfer','Portuguese','from_storage','4685826Oitjyv','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.product_stock','random','product_details','Rack\x20D','body','from_rak','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','to_room_name','/view/add_transfer','/transfer/preview/','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','edit_transfer','</body></html>','unit','</td>','$product_details.level','<hr\x20class=\x22my-3\x22>','French','$product_details.secondary_unit','findOne','Floor','</table>','from_room','$finalize','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','floor','$product_details.production_date','$product_details.floorlevel','to_warehouse','../public/language/languages.json','$product.from_room_name','save','back','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details._id','English','$product_details.product_code','from_invoice','$product_details.product_name','user','createTransport','map','toString','Raw\x20Materials','primary_code','catch','$product_details.expiry_date','from_types','note','type','DRY\x20STORAGE','Receiving\x20Area','TRF-','error','$product_details.storage','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$to_warehouse','$product_details.primary_code','success','product','express','$room','getDate','product_stock','filter','json','to_floorlevel','</tbody>','$name','Logo.png','concat','from_prod_isle','/preview/:id','staff'];a0_0x39df=function(){return _0x44c20b;};return a0_0x39df();}router['get'](a0_0x2b3321(0x20d),auth,async(_0x48d847,_0xdf5afc)=>{var _0x208dbd=a0_0x2b3321;try{const {username:_0x3788ca,email:_0x24c6bc,role:_0x5d1b0b}=_0x48d847[_0x208dbd(0x139)],_0x21e642=_0x48d847[_0x208dbd(0x139)],_0x261cd5=await profile['findOne']({'email':_0x21e642[_0x208dbd(0x1a1)]}),_0x1b83ea=await master_shop['find']();console['log'](_0x208dbd(0x1d5),_0x1b83ea);let _0x25cb9b;if(_0x21e642[_0x208dbd(0x18f)]=='staff'){const _0x2854de=await staff['findOne']({'email':_0x21e642[_0x208dbd(0x1a1)]});_0x25cb9b=await warehouse[_0x208dbd(0x1c1)]([{'$match':{'status':_0x208dbd(0x164),'name':_0x2854de['warehouse'],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x208dbd(0x156),'name':{'$first':_0x208dbd(0x156)}}}]);}else _0x25cb9b=await warehouse[_0x208dbd(0x1c1)]([{'$match':{'status':'Enabled','warehouse_category':_0x208dbd(0x13d)}},{'$group':{'_id':_0x208dbd(0x156),'name':{'$first':_0x208dbd(0x156)}}}]);var _0xbc20b4=['Ambient',_0x208dbd(0x185),_0x208dbd(0x166)];const _0x5ab997=await transfers[_0x208dbd(0x1cf)]({}),_0x5e7f6f=_0x5ab997[_0x208dbd(0x1bb)]+0x1,_0x26d13c='TRF-'+_0x5e7f6f[_0x208dbd(0x13c)]()['padStart'](0x5,'0');if(_0x1b83ea[0x0][_0x208dbd(0x191)]==_0x208dbd(0x198)){var _0x2a898b=users[_0x208dbd(0x135)];console['log'](_0x2a898b);}else{if(_0x1b83ea[0x0]['language']=='Hindi')var _0x2a898b=users[_0x208dbd(0x1b6)];else{if(_0x1b83ea[0x0]['language']==_0x208dbd(0x17a))var _0x2a898b=users[_0x208dbd(0x17a)];else{if(_0x1b83ea[0x0][_0x208dbd(0x191)]==_0x208dbd(0x1d7))var _0x2a898b=users['Spanish'];else{if(_0x1b83ea[0x0][_0x208dbd(0x191)]=='French')var _0x2a898b=users[_0x208dbd(0x216)];else{if(_0x1b83ea[0x0][_0x208dbd(0x191)]==_0x208dbd(0x194))var _0x2a898b=users[_0x208dbd(0x1ff)];else{if(_0x1b83ea[0x0][_0x208dbd(0x191)]==_0x208dbd(0x197))var _0x2a898b=users['Chinese'];else{if(_0x1b83ea[0x0]['language']==_0x208dbd(0x180))var _0x2a898b=users[_0x208dbd(0x15c)];}}}}}}}const _0x31521d=getRandom8DigitNumber();_0x31521d['then'](_0x45bb51=>{var _0x2a3280=_0x208dbd;_0xdf5afc[_0x2a3280(0x163)](_0x2a3280(0x1fe),{'success':_0x48d847['flash'](_0x2a3280(0x14c)),'errors':_0x48d847[_0x2a3280(0x15e)]('errors'),'role':_0x21e642,'profile':_0x261cd5,'master_shop':_0x1b83ea,'warehouse':_0x25cb9b,'language':_0x2a898b,'rooms_data':_0xbc20b4,'invoice':_0x45bb51});})[_0x208dbd(0x13f)](_0x35b4fb=>{var _0x2c73f3=_0x208dbd;_0x48d847[_0x2c73f3(0x15e)](_0x2c73f3(0x1e1),_0x2c73f3(0x19b)),_0xdf5afc[_0x2c73f3(0x160)](_0x2c73f3(0x19f));});}catch(_0x485c63){console[_0x208dbd(0x1f4)](_0x485c63);}}),router[a0_0x2b3321(0x1d1)](a0_0x2b3321(0x20d),auth,async(_0x2e891f,_0x2bd6a8)=>{var _0xe05a14=a0_0x2b3321;try{console[_0xe05a14(0x1f4)](_0x2e891f[_0xe05a14(0x207)]);const {date:_0x3bc662,from_warehouse:_0xfebecd,FromRoom_name:_0x3a4156,to_warehouse:_0x66b4ca,ToRoom_name:_0x416504,prod_name:_0x178402,from_prod_qty:_0x24776e,from_prod_level:_0x2eaabd,from_prod_isle:_0x37d6d1,from_prod_pallet:_0x170ff1,to_prod_qty:_0x2aae56,to_prod_level:_0x409431,to_prod_isle:_0x1d6089,to_prod_pallet:_0x1275f1,primary_code:_0x48b5a2,secondary_code:_0x1c4924,product_code3:_0x56b263,note:_0x18588f,MaxStocks_data2:_0x4cb22e,invoice:_0x1483d0,expiry_date:_0x3818f4}=_0x2e891f[_0xe05a14(0x207)];if(typeof _0x178402==_0xe05a14(0x1f8))var _0x5dd1b2=[_0x2e891f[_0xe05a14(0x207)]['prod_name']],_0x5b9914=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x171)]],_0x37faed=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1b7)]],_0x12f6d0=[_0x2e891f[_0xe05a14(0x207)]['New_Qty_Converted']],_0x55a325=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1f0)]],_0x53083a=[_0x2e891f['body'][_0xe05a14(0x13e)]],_0x573da2=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1b2)]],_0x11f07c=[_0x2e891f['body'][_0xe05a14(0x16f)]],_0x4876ee=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1aa)]],_0x1fab45=[_0x2e891f[_0xe05a14(0x207)]['primary_unit']],_0x3dad0f=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1f9)]],_0x2e9688=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1ce)]],_0x40c800=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x170)]],_0x4556f4=[_0x2e891f['body'][_0xe05a14(0x188)]],_0x4e778a=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1cc)]],_0x2882c3=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x18e)]],_0x5dd769=[_0x2e891f[_0xe05a14(0x207)]['RoomAssigned']],_0x8d63e4=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x16c)]],_0x56abe0=[_0x2e891f[_0xe05a14(0x207)]['from_invoice']],_0x3b301b=[_0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1f5)]];else var _0x5dd1b2=[..._0x2e891f['body']['prod_name']],_0x5b9914=[..._0x2e891f[_0xe05a14(0x207)]['from_prod_qty']],_0x37faed=[..._0x2e891f['body'][_0xe05a14(0x1b7)]],_0x12f6d0=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x176)]],_0x55a325=[..._0x2e891f['body'][_0xe05a14(0x1f0)]],_0x53083a=[..._0x2e891f['body'][_0xe05a14(0x13e)]],_0x573da2=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1b2)]],_0x11f07c=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x16f)]],_0x4876ee=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1aa)]],_0x1fab45=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1ba)]],_0x3dad0f=[..._0x2e891f[_0xe05a14(0x207)]['secondary_unit']],_0x2e9688=[..._0x2e891f['body']['batch_code']],_0x40c800=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x170)]],_0x4556f4=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x188)]],_0x4e778a=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1cc)]],_0x2882c3=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x18e)]],_0x5dd769=[..._0x2e891f['body'][_0xe05a14(0x1ec)]],_0x8d63e4=[..._0x2e891f[_0xe05a14(0x207)]['ToRoomAssigned']],_0x56abe0=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x137)]],_0x3b301b=[..._0x2e891f[_0xe05a14(0x207)][_0xe05a14(0x1f5)]];const _0x25c1cb=_0x5dd1b2[_0xe05a14(0x13b)](_0x4ff2ef=>{return _0x4ff2ef={'product_name':_0x4ff2ef};});_0x5b9914[_0xe05a14(0x172)]((_0x351adb,_0x3d559c)=>{_0x25c1cb[_0x3d559c]['from_quantity']=_0x351adb;}),_0x56abe0['forEach']((_0x1dc32c,_0xdc548e)=>{var _0x167834=_0xe05a14;_0x25c1cb[_0xdc548e][_0x167834(0x137)]=_0x1dc32c;}),_0x3b301b[_0xe05a14(0x172)]((_0x3d45c9,_0x948460)=>{var _0x1fff4b=_0xe05a14;_0x25c1cb[_0x948460][_0x1fff4b(0x162)]=_0x3d45c9;}),_0x37faed['forEach']((_0x44eb52,_0x15b658)=>{var _0x2893f5=_0xe05a14;_0x5dd769[_0x2893f5(0x172)]((_0x20ff6b,_0x323432)=>{var _0x25d21b=_0x2893f5;if(_0x20ff6b=='Receiving\x20Area'&&_0x15b658==_0x323432){var _0x1a69f4=_0x44eb52[_0x25d21b(0x1e7)](0x3);_0x25c1cb[_0x15b658]['from_storage']=_0x44eb52[0x0],_0x25c1cb[_0x15b658][_0x25d21b(0x1a9)]=_0x44eb52[0x1],_0x25c1cb[_0x15b658][_0x25d21b(0x1a3)]=0x0,_0x25c1cb[_0x15b658]['from_bin']=0x0,_0x25c1cb[_0x15b658][_0x25d21b(0x141)]=_0x25d21b(0x219),_0x25c1cb[_0x15b658]['from_floorlevel']=_0x1a69f4;}else{if(_0x20ff6b==_0x25d21b(0x1c9)&&_0x15b658==_0x323432){var _0x1a69f4=_0x44eb52['slice'](0x3);_0x25c1cb[_0x15b658]['from_storage']=_0x44eb52[0x0],_0x25c1cb[_0x15b658][_0x25d21b(0x1a9)]=_0x44eb52[0x1],_0x25c1cb[_0x15b658][_0x25d21b(0x1a3)]=0x0,_0x25c1cb[_0x15b658][_0x25d21b(0x168)]=0x0,_0x25c1cb[_0x15b658][_0x25d21b(0x141)]=_0x25d21b(0x219),_0x25c1cb[_0x15b658][_0x25d21b(0x178)]=_0x44eb52[0x5];}else{if(_0x15b658==_0x323432){var _0x228bbe;if(_0x44eb52[0x4]=='L')_0x228bbe=_0x25d21b(0x1c4);else _0x44eb52[0x4]=='F'&&(_0x228bbe=_0x25d21b(0x219));_0x25c1cb[_0x15b658]['from_storage']=_0x44eb52[0x0],_0x25c1cb[_0x15b658][_0x25d21b(0x1a9)]=_0x44eb52[0x1],_0x25c1cb[_0x15b658][_0x25d21b(0x1a3)]=_0x44eb52[0x2],_0x25c1cb[_0x15b658]['from_bin']=_0x44eb52[0x3],_0x25c1cb[_0x15b658][_0x25d21b(0x141)]=_0x228bbe,_0x25c1cb[_0x15b658][_0x25d21b(0x178)]=_0x44eb52[0x5];}}}});}),_0x12f6d0[_0xe05a14(0x172)]((_0x58cd11,_0xdff33c)=>{var _0x426bbc=_0xe05a14;_0x25c1cb[_0xdff33c][_0x426bbc(0x1d3)]=_0x58cd11;}),_0x55a325[_0xe05a14(0x172)]((_0xbd674e,_0x16b192)=>{var _0x4bf8cc=_0xe05a14;_0x8d63e4[_0x4bf8cc(0x172)]((_0x594ce4,_0x2376bf)=>{var _0x35cf52=_0x4bf8cc;if(_0x594ce4==_0x35cf52(0x145)&&_0x16b192==_0x2376bf){var _0x217ecf=_0xbd674e['slice'](0x3);_0x25c1cb[_0x16b192][_0x35cf52(0x19e)]=_0xbd674e[0x0],_0x25c1cb[_0x16b192][_0x35cf52(0x1cb)]=_0xbd674e[0x1],_0x25c1cb[_0x16b192][_0x35cf52(0x1fd)]=0x0,_0x25c1cb[_0x16b192][_0x35cf52(0x1a5)]=0x0,_0x25c1cb[_0x16b192][_0x35cf52(0x1bf)]=_0x35cf52(0x219),_0x25c1cb[_0x16b192][_0x35cf52(0x154)]=_0x217ecf;}else{if(_0x594ce4=='Shelves'&&_0x16b192==_0x2376bf){var _0x217ecf=_0xbd674e['slice'](0x3);_0x25c1cb[_0x16b192]['storage']=_0xbd674e[0x0],_0x25c1cb[_0x16b192]['rack']=_0xbd674e[0x1],_0x25c1cb[_0x16b192][_0x35cf52(0x1fd)]=0x0,_0x25c1cb[_0x16b192][_0x35cf52(0x1a5)]=0x0,_0x25c1cb[_0x16b192][_0x35cf52(0x1bf)]=_0x35cf52(0x219),_0x25c1cb[_0x16b192]['to_floorlevel']=_0xbd674e[0x5];}else{if(_0x16b192==_0x2376bf){var _0x57938f;if(_0xbd674e[0x4]=='L')_0x57938f=_0x35cf52(0x1c4);else _0xbd674e[0x4]=='F'&&(_0x57938f=_0x35cf52(0x219));_0x25c1cb[_0x16b192]['storage']=_0xbd674e[0x0],_0x25c1cb[_0x16b192][_0x35cf52(0x1cb)]=_0xbd674e[0x1],_0x25c1cb[_0x16b192][_0x35cf52(0x1fd)]=_0xbd674e[0x2],_0x25c1cb[_0x16b192][_0x35cf52(0x1a5)]=_0xbd674e[0x3],_0x25c1cb[_0x16b192][_0x35cf52(0x1bf)]=_0x57938f,_0x25c1cb[_0x16b192][_0x35cf52(0x154)]=_0xbd674e[0x5];}}}});}),_0x53083a[_0xe05a14(0x172)]((_0x10120b,_0xf1812e)=>{var _0x7dc51=_0xe05a14;_0x25c1cb[_0xf1812e][_0x7dc51(0x13e)]=_0x10120b;}),_0x573da2['forEach']((_0x3c3570,_0x2110fd)=>{var _0x73c83f=_0xe05a14;_0x25c1cb[_0x2110fd][_0x73c83f(0x1b2)]=_0x3c3570;}),_0x11f07c[_0xe05a14(0x172)]((_0x2f02da,_0xb35169)=>{_0x25c1cb[_0xb35169]['product_code']=_0x2f02da;}),_0x4876ee[_0xe05a14(0x172)]((_0xd9fbcc,_0x2a546c)=>{var _0x2721b8=_0xe05a14;_0x25c1cb[_0x2a546c][_0x2721b8(0x1c0)]=_0xd9fbcc;}),_0x1fab45[_0xe05a14(0x172)]((_0x2ea93c,_0x9cde1)=>{var _0x42c224=_0xe05a14;_0x25c1cb[_0x9cde1][_0x42c224(0x212)]=_0x2ea93c;}),_0x3dad0f[_0xe05a14(0x172)]((_0x3b91d1,_0x46a0d6)=>{_0x25c1cb[_0x46a0d6]['secondary_unit']=_0x3b91d1;}),_0x2e9688[_0xe05a14(0x172)]((_0x5a58b3,_0x126738)=>{var _0x3c9a0d=_0xe05a14;_0x25c1cb[_0x126738][_0x3c9a0d(0x1ce)]=_0x5a58b3;}),_0x40c800[_0xe05a14(0x172)]((_0x1587b7,_0x4d0926)=>{var _0x4723b0=_0xe05a14;_0x25c1cb[_0x4d0926][_0x4723b0(0x170)]=_0x1587b7;}),_0x4556f4[_0xe05a14(0x172)]((_0xc868d5,_0x2c74c8)=>{var _0x5318e3=_0xe05a14;_0x25c1cb[_0x2c74c8][_0x5318e3(0x1ea)]=_0xc868d5;}),_0x4e778a[_0xe05a14(0x172)]((_0x527a3e,_0x46d380)=>{var _0x37ab39=_0xe05a14;_0x25c1cb[_0x46d380][_0x37ab39(0x1cc)]=_0x527a3e;}),_0x2882c3[_0xe05a14(0x172)]((_0x1a00da,_0x17031b)=>{var _0x14c190=_0xe05a14;_0x25c1cb[_0x17031b][_0x14c190(0x18e)]=_0x1a00da;}),_0x5dd769[_0xe05a14(0x172)]((_0x445f6,_0x43d4bb)=>{var _0x530499=_0xe05a14;_0x25c1cb[_0x43d4bb][_0x530499(0x16e)]=_0x445f6;}),_0x8d63e4['forEach']((_0x34140a,_0x8bc393)=>{_0x25c1cb[_0x8bc393]['to_room_name']=_0x34140a;});const _0x2376cf=_0x25c1cb[_0xe05a14(0x152)](_0x335701=>_0x335701[_0xe05a14(0x1d3)]!=='0'&&_0x335701[_0xe05a14(0x1d3)]!==''||_0x335701[_0xe05a14(0x154)]!=='0'&&_0x335701[_0xe05a14(0x154)]!==''),_0x46017e=new transfers({'date':_0x3bc662,'from_warehouse':_0xfebecd,'to_warehouse':_0x66b4ca,'product':_0x2376cf,'note':_0x18588f,'invoice':_0x1483d0}),_0xaf3545=await _0x46017e[_0xe05a14(0x224)]();_0x2e891f['flash'](_0xe05a14(0x14c),'Product\x20Transfer\x20successfully'),_0x2bd6a8[_0xe05a14(0x160)](_0xe05a14(0x20e)+_0xaf3545[_0xe05a14(0x1ab)]);}catch(_0x3a1562){console[_0xe05a14(0x1f4)](_0x3a1562),_0x2bd6a8[_0xe05a14(0x199)](0xc8)['json']({'errorMessage':_0x3a1562[_0xe05a14(0x1c6)]});}}),router[a0_0x2b3321(0x1ad)](a0_0x2b3321(0x15a),auth,async(_0x4d7a22,_0x535bd7)=>{var _0x4edcd2=a0_0x2b3321;try{const {username:_0x39fecd,email:_0x123352,role:_0x478769}=_0x4d7a22[_0x4edcd2(0x139)],_0x1d4317=_0x4d7a22['user'],_0x5eae12=await profile[_0x4edcd2(0x218)]({'email':_0x1d4317[_0x4edcd2(0x1a1)]}),_0xa6f01a=await master_shop[_0x4edcd2(0x1cf)]();console[_0x4edcd2(0x1f4)](_0x4edcd2(0x1d5),_0xa6f01a);const _0x40dad9=await transfers['findById'](_0x4d7a22[_0x4edcd2(0x1df)]['id']);let _0x5b99fd=new Date(_0x40dad9[_0x4edcd2(0x170)]),_0x8a034e=('0'+_0x5b99fd[_0x4edcd2(0x150)]())['slice'](-0x2),_0x26a9b0=('0'+(_0x5b99fd[_0x4edcd2(0x19d)]()+0x1))[_0x4edcd2(0x1e7)](-0x2),_0xf162b6=_0x5b99fd[_0x4edcd2(0x17c)](),_0xebef8d=_0xf162b6+'-'+_0x26a9b0+'-'+_0x8a034e,_0x5892ef;if(_0x1d4317[_0x4edcd2(0x18f)]==_0x4edcd2(0x15b)){const _0x16ade8=await staff['findOne']({'email':_0x1d4317[_0x4edcd2(0x1a1)]});_0x5892ef=await warehouse[_0x4edcd2(0x1cf)]({'status':_0x4edcd2(0x164),'name':_0x16ade8[_0x4edcd2(0x16b)],'warehouse_category':_0x4edcd2(0x13d)});}else _0x5892ef=await warehouse[_0x4edcd2(0x1cf)]({'status':_0x4edcd2(0x164),'warehouse_category':_0x4edcd2(0x13d)});const _0x705744=await warehouse[_0x4edcd2(0x1c1)]([{'$match':{'name':_0x40dad9['from_warehouse']}},{'$unwind':_0x4edcd2(0x1b8)},{'$group':{'_id':_0x4edcd2(0x134),'name':{'$first':_0x4edcd2(0x138)},'product_stock':{'$first':_0x4edcd2(0x203)},'bay':{'$first':_0x4edcd2(0x1e6)},'bin':{'$first':_0x4edcd2(0x1eb)},'type':{'$first':_0x4edcd2(0x181)},'floorlevel':{'$first':_0x4edcd2(0x220)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4edcd2(0x136)},'storage':{'$first':_0x4edcd2(0x148)},'rack':{'$first':_0x4edcd2(0x161)},'expiry_date':{'$first':_0x4edcd2(0x140)},'production_date':{'$first':_0x4edcd2(0x21f)},'room':{'$first':_0x4edcd2(0x14f)}}}]);if(_0xa6f01a[0x0][_0x4edcd2(0x191)]==_0x4edcd2(0x198)){var _0x19cec5=users[_0x4edcd2(0x135)];console[_0x4edcd2(0x1f4)](_0x19cec5);}else{if(_0xa6f01a[0x0][_0x4edcd2(0x191)]=='Hindi')var _0x19cec5=users[_0x4edcd2(0x1b6)];else{if(_0xa6f01a[0x0][_0x4edcd2(0x191)]=='German')var _0x19cec5=users[_0x4edcd2(0x17a)];else{if(_0xa6f01a[0x0][_0x4edcd2(0x191)]==_0x4edcd2(0x1d7))var _0x19cec5=users[_0x4edcd2(0x1d7)];else{if(_0xa6f01a[0x0][_0x4edcd2(0x191)]==_0x4edcd2(0x216))var _0x19cec5=users['French'];else{if(_0xa6f01a[0x0][_0x4edcd2(0x191)]==_0x4edcd2(0x194))var _0x19cec5=users[_0x4edcd2(0x1ff)];else{if(_0xa6f01a[0x0][_0x4edcd2(0x191)]=='Chinese')var _0x19cec5=users[_0x4edcd2(0x197)];else{if(_0xa6f01a[0x0][_0x4edcd2(0x191)]==_0x4edcd2(0x180))var _0x19cec5=users[_0x4edcd2(0x15c)];}}}}}}}_0x535bd7[_0x4edcd2(0x163)](_0x4edcd2(0x1b0),{'success':_0x4d7a22[_0x4edcd2(0x15e)](_0x4edcd2(0x14c)),'errors':_0x4d7a22['flash']('errors'),'role':_0x1d4317,'profile':_0x5eae12,'master_shop':_0xa6f01a,'warehouse':_0x5892ef,'transfer':_0x40dad9,'stock':_0x705744,'language':_0x19cec5});}catch(_0x524ca7){console[_0x4edcd2(0x1f4)](_0x524ca7);}}),router['post']('/preview/:id',auth,async(_0x45b605,_0x3625e6)=>{var _0x5bcb66=a0_0x2b3321;try{const _0x260e45=_0x45b605[_0x5bcb66(0x1df)]['id'],{from_warehouse:_0x35d85c,FromRoom_name:_0xe49b9c,to_warehouse:_0x38247f,ToRoom_name:_0x211167}=_0x45b605[_0x5bcb66(0x207)],_0x30e80d=await transfers[_0x5bcb66(0x1c8)]({'_id':_0x260e45}),_0x4dad65=_0x30e80d[_0x5bcb66(0x14d)]['map'](async _0x9c7d92=>{var _0x32ad9b=_0x5bcb66;if(_0x9c7d92['to_quantity']>0x0){var _0x591679=await warehouse[_0x32ad9b(0x218)]({'name':_0x30e80d[_0x32ad9b(0x1a4)],'room':_0x9c7d92[_0x32ad9b(0x16e)],'warehouse_category':_0x32ad9b(0x13d)});const _0x5b2b62=_0x591679['product_details'][_0x32ad9b(0x13b)](_0x2ac0b8=>{var _0xa5fd3f=_0x32ad9b;_0x2ac0b8[_0xa5fd3f(0x18b)]==_0x9c7d92[_0xa5fd3f(0x18b)]&&_0x2ac0b8[_0xa5fd3f(0x167)]==_0x9c7d92[_0xa5fd3f(0x178)]&&_0x2ac0b8[_0xa5fd3f(0x143)]==_0x9c7d92[_0xa5fd3f(0x141)]&&_0x2ac0b8['bin']==_0x9c7d92[_0xa5fd3f(0x168)]&&_0x2ac0b8['bay']==_0x9c7d92['from_bay']&&_0x2ac0b8[_0xa5fd3f(0x1cb)]==_0x9c7d92[_0xa5fd3f(0x1a9)]&&_0x2ac0b8[_0xa5fd3f(0x19e)]==_0x9c7d92[_0xa5fd3f(0x200)]&&_0x2ac0b8[_0xa5fd3f(0x170)]==_0x9c7d92[_0xa5fd3f(0x170)]&&_0x2ac0b8[_0xa5fd3f(0x1ce)]==_0x9c7d92[_0xa5fd3f(0x1ce)]&&_0x2ac0b8['production_date']==_0x9c7d92[_0xa5fd3f(0x1cc)]&&_0x2ac0b8[_0xa5fd3f(0x1d4)]==_0x9c7d92['from_invoice']&&(_0x2ac0b8['product_stock']=_0x2ac0b8[_0xa5fd3f(0x151)]-_0x9c7d92[_0xa5fd3f(0x1d3)]);});}return _0x591679;});Promise[_0x5bcb66(0x1d9)](_0x4dad65)[_0x5bcb66(0x1c7)](async _0x327648=>{var _0x26492c=_0x5bcb66;try{for(const _0xe6eb38 of _0x327648){await _0xe6eb38[_0x26492c(0x224)]();}try{const _0x3796cf=_0x30e80d[_0x26492c(0x14d)]['map'](async _0x3dfca4=>{var _0x5f1a8e=_0x26492c;if(_0x3dfca4[_0x5f1a8e(0x1d3)]>0x0){var _0x47c7a0=await warehouse[_0x5f1a8e(0x218)]({'name':_0x30e80d[_0x5f1a8e(0x221)],'room':_0x3dfca4[_0x5f1a8e(0x20c)],'warehouse_category':'Raw\x20Materials'}),_0x3eacea=0x0;const _0x454000=_0x47c7a0[_0x5f1a8e(0x205)][_0x5f1a8e(0x13b)](_0x120d11=>{var _0x17c095=_0x5f1a8e;_0x120d11[_0x17c095(0x18b)]==_0x3dfca4[_0x17c095(0x18b)]&&_0x120d11[_0x17c095(0x167)]==_0x3dfca4[_0x17c095(0x154)]&&_0x120d11[_0x17c095(0x143)]==_0x3dfca4[_0x17c095(0x1bf)]&&_0x120d11[_0x17c095(0x17d)]==_0x3dfca4[_0x17c095(0x1a5)]&&_0x120d11[_0x17c095(0x18a)]==_0x3dfca4[_0x17c095(0x1fd)]&&_0x120d11[_0x17c095(0x1cb)]==_0x3dfca4[_0x17c095(0x1cb)]&&_0x120d11[_0x17c095(0x19e)]==_0x3dfca4[_0x17c095(0x19e)]&&_0x120d11[_0x17c095(0x170)]==_0x3dfca4[_0x17c095(0x170)]&&_0x120d11[_0x17c095(0x1ce)]==_0x3dfca4[_0x17c095(0x1ce)]&&_0x120d11[_0x17c095(0x1cc)]==_0x3dfca4['production_date']&&_0x120d11[_0x17c095(0x1d4)]==_0x3dfca4[_0x17c095(0x162)]&&(_0x120d11['product_stock']=_0x120d11[_0x17c095(0x151)]+_0x3dfca4[_0x17c095(0x1d3)],_0x3eacea++);});_0x3eacea=='0'&&(_0x47c7a0[_0x5f1a8e(0x205)]=_0x47c7a0[_0x5f1a8e(0x205)][_0x5f1a8e(0x158)]({'product_name':_0x3dfca4[_0x5f1a8e(0x18b)],'product_stock':_0x3dfca4['to_quantity'],'bay':_0x3dfca4[_0x5f1a8e(0x1fd)],'bin':_0x3dfca4[_0x5f1a8e(0x1a5)],'type':_0x3dfca4['to_types'],'floorlevel':_0x3dfca4[_0x5f1a8e(0x154)],'storage':_0x3dfca4[_0x5f1a8e(0x19e)],'rack':_0x3dfca4['rack'],'product_code':_0x3dfca4[_0x5f1a8e(0x1b5)],'primary_code':_0x3dfca4[_0x5f1a8e(0x13e)],'secondary_code':_0x3dfca4[_0x5f1a8e(0x1b2)],'maxProducts':_0x3dfca4[_0x5f1a8e(0x1c0)],'storage':_0x3dfca4[_0x5f1a8e(0x19e)],'rack':_0x3dfca4[_0x5f1a8e(0x1cb)],'expiry_date':_0x3dfca4[_0x5f1a8e(0x170)],'maxPerUnit':_0x3dfca4['maxperunit'],'batch_code':_0x3dfca4['batch_code'],'production_date':_0x3dfca4[_0x5f1a8e(0x1cc)]}));}return _0x47c7a0;});Promise['all'](_0x3796cf)['then'](async _0x3eb1e5=>{var _0x2e8191=_0x26492c;try{for(const _0x232e25 of _0x3eb1e5){await warehouse[_0x2e8191(0x18c)]({'_id':_0x232e25['_id']},{'$addToSet':{'product_details':{'$each':_0x232e25[_0x2e8191(0x205)]}}});}_0x30e80d['finalize']='True';const _0x52c617=await _0x30e80d['save'](),_0x36c349=await master_shop['find'](),_0x1a13d2=await email_settings[_0x2e8191(0x218)](),_0xc44cda=await supervisor_settings[_0x2e8191(0x1cf)]();var _0x399898=_0x30e80d[_0x2e8191(0x14d)],_0x4ba7ff='',_0x48ef87;for(_0x48ef87 in _0x399898){_0x4ba7ff+='<tr>'+_0x2e8191(0x20f)+_0x399898[_0x48ef87][_0x2e8191(0x18b)]+_0x2e8191(0x213)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x399898[_0x48ef87][_0x2e8191(0x1b5)]+_0x2e8191(0x213)+_0x2e8191(0x20f)+_0x399898[_0x48ef87]['to_quantity']+_0x2e8191(0x213)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x399898[_0x48ef87][_0x2e8191(0x212)]+_0x2e8191(0x213)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x399898[_0x48ef87][_0x2e8191(0x1f9)]+_0x2e8191(0x213)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x30e80d[_0x2e8191(0x221)]+'</td>'+_0x2e8191(0x20f)+_0x399898[_0x48ef87][_0x2e8191(0x20c)]+_0x2e8191(0x213)+_0x2e8191(0x20f)+_0x399898[_0x48ef87][_0x2e8191(0x19e)]+_0x399898[_0x48ef87]['rack']+_0x399898[_0x48ef87][_0x2e8191(0x1fd)]+_0x399898[_0x48ef87][_0x2e8191(0x1a5)]+_0x399898[_0x48ef87][_0x2e8191(0x1bf)][0x0]+_0x399898[_0x48ef87][_0x2e8191(0x154)]+'</td>',_0x2e8191(0x186);}let _0x26b1fb=nodemailer[_0x2e8191(0x13a)]({'host':_0x1a13d2[_0x2e8191(0x1be)],'port':Number(_0x1a13d2['port']),'secure':![],'auth':{'user':_0x1a13d2['email'],'pass':_0x1a13d2['password']}}),_0x3e4267={'from':_0x1a13d2['email'],'to':_0xc44cda[0x0][_0x2e8191(0x1ca)],'subject':_0x2e8191(0x1ac),'attachments':[{'filename':_0x2e8191(0x157),'path':__dirname+'/../public'+_0x2e8191(0x1a6)+_0x36c349[0x0]['image'],'cid':_0x2e8191(0x189)}],'html':'<!DOCTYPE\x20html>'+_0x2e8191(0x177)+'</head><body>'+_0x2e8191(0x196)+_0x2e8191(0x21d)+'<div>'+_0x2e8191(0x1a0)+_0x2e8191(0x1da)+_0x2e8191(0x196)+_0x2e8191(0x187)+_0x36c349[0x0][_0x2e8191(0x1e5)]+_0x2e8191(0x1c3)+_0x2e8191(0x1da)+_0x2e8191(0x1da)+_0x2e8191(0x215)+'<div>'+_0x2e8191(0x209)+_0x2e8191(0x16d)+_0x30e80d[_0x2e8191(0x1d4)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2e8191(0x16a)+_0x30e80d[_0x2e8191(0x15f)]+'\x20'+_0x2e8191(0x1e4)+_0x2e8191(0x19c)+_0x2e8191(0x1da)+_0x2e8191(0x149)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2e8191(0x1af)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2e8191(0x202)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x2e8191(0x133)+_0x2e8191(0x19a)+_0x2e8191(0x20b)+_0x2e8191(0x1cd)+_0x2e8191(0x1fc)+_0x2e8191(0x186)+'</thead>'+_0x2e8191(0x192)+'\x20'+_0x4ba7ff+'\x20'+_0x2e8191(0x155)+_0x2e8191(0x21a)+_0x2e8191(0x196)+_0x2e8191(0x17e)+_0x2e8191(0x1db)+_0x36c349[0x0][_0x2e8191(0x1e5)]+_0x2e8191(0x19c)+_0x2e8191(0x1da)+_0x2e8191(0x1da)+_0x2e8191(0x211)};_0x26b1fb[_0x2e8191(0x184)](_0x3e4267,function(_0xb99ecc,_0x1df383){var _0x3e36d9=_0x2e8191;_0xb99ecc?(console[_0x3e36d9(0x1f4)](_0xb99ecc),console[_0x3e36d9(0x1f4)](_0x3e36d9(0x1b3))):console[_0x3e36d9(0x1f4)]('Email\x20sent\x20successfully');}),_0x45b605[_0x2e8191(0x15e)](_0x2e8191(0x14c),_0x2e8191(0x1b4)),_0x3625e6['redirect'](_0x2e8191(0x1a2)+_0x52c617[_0x2e8191(0x1ab)]);}catch(_0x527189){console[_0x2e8191(0x147)](_0x527189),_0x3625e6['status'](0x1f4)[_0x2e8191(0x153)]({'Perror':_0x2e8191(0x17f),'message':_0x527189[_0x2e8191(0x1c6)]});}})[_0x26492c(0x13f)](_0x5371bf=>{var _0x1e7efe=_0x26492c;console[_0x1e7efe(0x147)](_0x5371bf),_0x3625e6[_0x1e7efe(0x199)](0x1f4)[_0x1e7efe(0x153)]({'Perror':_0x1e7efe(0x1f1)});});}catch(_0x24df9a){_0x3625e6[_0x26492c(0x153)](_0x24df9a);}}catch(_0x56cab7){console[_0x26492c(0x147)](_0x56cab7),_0x3625e6[_0x26492c(0x199)](0x1f4)[_0x26492c(0x153)]({'Merror':_0x26492c(0x17f),'Message':_0x56cab7[_0x26492c(0x1c6)]});}})['catch'](_0x4feac1=>{var _0x4843ee=_0x5bcb66;console['error'](_0x4feac1),_0x3625e6[_0x4843ee(0x199)](0x1f4)[_0x4843ee(0x153)]({'Merror':_0x4843ee(0x1f1)});});}catch(_0x336f33){console['log'](_0x336f33);}});function BayBinSelected(_0x356901,_0x2f26b8){var _0x9975cd=a0_0x2b3321,_0xe12413=[],_0x506a76=[],_0x5eec20=[],_0x20ffb7=[],_0x2ee964=[],_0x5ea5cc=[];let _0x201ff5=[];if(_0x356901==_0x9975cd(0x144))switch(_0x2f26b8){case _0x9975cd(0x1d2):_0xe12413=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x506a76=[0x1,0x2],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x1c4),'Floor'],_0x2ee964=['D'],_0x5ea5cc=['A'];break;case _0x9975cd(0x195):_0xe12413=[0x6,0x5,0x4,0x3,0x2,0x1],_0x506a76=[0x1,0x2],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x1c4),_0x9975cd(0x219)],_0x2ee964=['D'],_0x5ea5cc=['B'];break;case'Shelves':_0xe12413=[0x0],_0x506a76=[0x0],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x219)],_0x2ee964=['D'],_0x5ea5cc=['S'];break;case _0x9975cd(0x145):_0xe12413=[0x0],_0x506a76=[0x0],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5eec20=['Floor'],_0x2ee964=['D'],_0x5ea5cc=['R'];break;}else{if(_0x356901==_0x9975cd(0x1a8))switch(_0x2f26b8){case _0x9975cd(0x1d2):_0xe12413=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x506a76=['B','F'],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x1c4),'Floor'],_0x2ee964=['C'],_0x5ea5cc=['A'];break;case'Rack\x20B':_0xe12413=[0x5,0x4,0x3,0x2,0x1],_0x506a76=['F','B','S'],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x1c4),_0x9975cd(0x219)],_0x2ee964=['C'],_0x5ea5cc=['B'];break;case _0x9975cd(0x1bd):_0xe12413=[0x1,0x2,0x3,0x4,0x5],_0x506a76=['B','F','S'],_0x20ffb7=[0x5,0x4,0x3,0x2,0x1],_0x5eec20=[_0x9975cd(0x1c4),'Floor'],_0x2ee964=['C'],_0x5ea5cc=['C'];break;case _0x9975cd(0x206):_0xe12413=[0x5,0x4,0x3,0x2,0x1],_0x506a76=['F','B','S'],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x1c4),_0x9975cd(0x219)],_0x2ee964=['C'],_0x5ea5cc=['D'];break;case _0x9975cd(0x169):_0xe12413=[0x4,0x3,0x2,0x1],_0x506a76=[0x1,0x2],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x1c4),_0x9975cd(0x219)],_0x2ee964=['C'],_0x5ea5cc=['E'];break;case _0x9975cd(0x1f2):_0xe12413=[0x1,0x2,0x3],_0x506a76=[0x1,0x2],_0x20ffb7=[0x1,0x2,0x3,0x4,0x5],_0x5eec20=[_0x9975cd(0x1c4)],_0x2ee964=['C'],_0x5ea5cc=['F'];break;}}return{'levels':_0xe12413,'Isle':_0x506a76,'rack':_0x20ffb7,'type':_0x5eec20,'storage':_0x2ee964,'rak':_0x5ea5cc};}router[a0_0x2b3321(0x1ad)]('/view/:id',auth,async(_0x5312f3,_0x40631b)=>{var _0x3a3e9c=a0_0x2b3321;try{const {username:_0x12fe2b,email:_0x36f164,role:_0x574152}=_0x5312f3[_0x3a3e9c(0x139)],_0x526958=_0x5312f3[_0x3a3e9c(0x139)],_0x25ced0=await profile['findOne']({'email':_0x526958[_0x3a3e9c(0x1a1)]}),_0xf32ae3=await master_shop['find'](),_0x281ea0=await transfers[_0x3a3e9c(0x1c8)](_0x5312f3[_0x3a3e9c(0x1df)]['id']);let _0x384b0d;if(_0x526958[_0x3a3e9c(0x18f)]==_0x3a3e9c(0x15b)){const _0x5fdc34=await staff[_0x3a3e9c(0x218)]({'email':_0x526958[_0x3a3e9c(0x1a1)]});_0x384b0d=await warehouse[_0x3a3e9c(0x1c1)]([{'$match':{'status':_0x3a3e9c(0x164),'name':_0x5fdc34['warehouse'],'warehouse_category':_0x3a3e9c(0x13d)}},{'$group':{'_id':_0x3a3e9c(0x156),'name':{'$first':_0x3a3e9c(0x156)}}}]);}else _0x384b0d=await warehouse[_0x3a3e9c(0x1c1)]([{'$match':{'status':_0x3a3e9c(0x164),'warehouse_category':_0x3a3e9c(0x13d)}},{'$group':{'_id':'$name','name':{'$first':_0x3a3e9c(0x156)}}}]);const _0x13845f=await warehouse['aggregate']([{'$match':{'name':_0x281ea0[_0x3a3e9c(0x1a4)],'warehouse_category':_0x3a3e9c(0x13d)}},{'$unwind':_0x3a3e9c(0x1b8)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3a3e9c(0x138)},'product_stock':{'$first':_0x3a3e9c(0x203)},'bay':{'$first':_0x3a3e9c(0x1e6)},'bin':{'$first':_0x3a3e9c(0x1eb)},'type':{'$first':_0x3a3e9c(0x181)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x3a3e9c(0x14b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3a3e9c(0x136)},'storage':{'$first':_0x3a3e9c(0x148)},'rack':{'$first':_0x3a3e9c(0x161)},'expiry_date':{'$first':_0x3a3e9c(0x140)},'production_date':{'$first':_0x3a3e9c(0x21f)},'room':{'$first':_0x3a3e9c(0x14f)}}}]),_0x24ef13=await product[_0x3a3e9c(0x1cf)]({}),_0x5da581=BayBinSelected(_0x281ea0[_0x3a3e9c(0x221)],_0x281ea0[_0x3a3e9c(0x1e0)]);if(_0xf32ae3[0x0][_0x3a3e9c(0x191)]==_0x3a3e9c(0x198)){var _0x15c239=users[_0x3a3e9c(0x135)];console[_0x3a3e9c(0x1f4)](_0x15c239);}else{if(_0xf32ae3[0x0]['language']==_0x3a3e9c(0x1b6))var _0x15c239=users[_0x3a3e9c(0x1b6)];else{if(_0xf32ae3[0x0][_0x3a3e9c(0x191)]=='German')var _0x15c239=users[_0x3a3e9c(0x17a)];else{if(_0xf32ae3[0x0][_0x3a3e9c(0x191)]==_0x3a3e9c(0x1d7))var _0x15c239=users[_0x3a3e9c(0x1d7)];else{if(_0xf32ae3[0x0][_0x3a3e9c(0x191)]==_0x3a3e9c(0x216))var _0x15c239=users[_0x3a3e9c(0x216)];else{if(_0xf32ae3[0x0][_0x3a3e9c(0x191)]==_0x3a3e9c(0x194))var _0x15c239=users['Portuguese'];else{if(_0xf32ae3[0x0]['language']==_0x3a3e9c(0x197))var _0x15c239=users[_0x3a3e9c(0x197)];else{if(_0xf32ae3[0x0][_0x3a3e9c(0x191)]==_0x3a3e9c(0x180))var _0x15c239=users[_0x3a3e9c(0x15c)];}}}}}}}_0x40631b[_0x3a3e9c(0x163)](_0x3a3e9c(0x210),{'success':_0x5312f3[_0x3a3e9c(0x15e)](_0x3a3e9c(0x14c)),'errors':_0x5312f3[_0x3a3e9c(0x15e)](_0x3a3e9c(0x1e1)),'role':_0x526958,'profile':_0x25ced0,'master_shop':_0xf32ae3,'warehouse':_0x384b0d,'transfer':_0x281ea0,'stock':_0x13845f,'unit':_0x24ef13,'language':_0x15c239});}catch(_0x2f4202){console[_0x3a3e9c(0x1f4)](_0x2f4202);}}),router[a0_0x2b3321(0x1d1)]('/view/:id',auth,async(_0x4c9901,_0x58c737)=>{var _0xf05b40=a0_0x2b3321;try{const _0x591ae3=_0x4c9901[_0xf05b40(0x1df)]['id'],_0x32ed31=await transfers['findById'](_0x591ae3);_0x58c737[_0xf05b40(0x153)](_0x4c9901[_0xf05b40(0x207)]);return;const {date:_0x4c292d,from_warehouse:_0x2b3dc0,FromRoom_name:_0x3a068a,to_warehouse:_0x3426b7,ToRoom_name:_0x227c1a,prod_name:_0x38e3a7,from_prod_qty:_0x1ba51b,from_prod_level:_0xab7a1d,from_prod_isle:_0x1bbd1b,from_prod_pallet:_0x10a9b0,to_prod_qty:_0x44f624,to_prod_level:_0xfbb019,to_prod_isle:_0x3fb47c,to_prod_pallet:_0x5a5c9b,primary_code:_0x37cafa,secondary_code:_0x193f28,product_code3:_0x12c4e6,note:_0x164209,invoice:_0x3f15da,expiry_date:_0xf8d036}=_0x4c9901[_0xf05b40(0x207)];if(typeof _0x38e3a7==_0xf05b40(0x1f8))var _0x5ae071=[_0x4c9901[_0xf05b40(0x207)]['prod_name']],_0x20c375=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x171)]],_0x559701=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1b7)]],_0xf735df=[_0x4c9901[_0xf05b40(0x207)]['from_prod_isle']],_0x1c29f5=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1f3)]],_0x38a3ad=[_0x4c9901['body']['from_types']],_0x52fda6=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1d6)]],_0x4a7bcb=[_0x4c9901['body'][_0xf05b40(0x1f0)]],_0x22582d=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x15d)]],_0x382235=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x179)]],_0x51f932=[_0x4c9901['body'][_0xf05b40(0x1bf)]],_0xcbb220=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x19e)]],_0x7526c9=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x175)]],_0x3d08a6=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x13e)]],_0x4f50c6=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1b2)]],_0x33b09e=[_0x4c9901[_0xf05b40(0x207)]['product_code3']],_0x747a3a=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1aa)]],_0xb88380=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x212)]],_0x50b38d=[_0x4c9901[_0xf05b40(0x207)]['secondary_unit']],_0xa4efe3=[_0x4c9901['body']['batch_code']],_0x3aeb03=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x170)]],_0x5dc33a=[_0x4c9901[_0xf05b40(0x207)]['from_storage']],_0x4bc83e=[_0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x208)]];else var _0x5ae071=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1ef)]],_0xcbb220=[..._0x4c9901['body'][_0xf05b40(0x19e)]],_0x7526c9=[..._0x4c9901['body'][_0xf05b40(0x175)]],_0x38a3ad=[..._0x4c9901[_0xf05b40(0x207)]['from_types']],_0x51f932=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1bf)]],_0x20c375=[..._0x4c9901['body'][_0xf05b40(0x171)]],_0x559701=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1b7)]],_0xf735df=[..._0x4c9901['body'][_0xf05b40(0x159)]],_0x1c29f5=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1f3)]],_0x52fda6=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1d6)]],_0x4a7bcb=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1f0)]],_0x22582d=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x15d)]],_0x382235=[..._0x4c9901['body'][_0xf05b40(0x179)]],_0x3d08a6=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x13e)]],_0x4f50c6=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1b2)]],_0x33b09e=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x16f)]],_0x747a3a=[..._0x4c9901[_0xf05b40(0x207)]['MaxStocks_data2']],_0xb88380=[..._0x4c9901[_0xf05b40(0x207)]['unit']],_0x50b38d=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1f9)]],_0xa4efe3=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x1ce)]],_0x3aeb03=[..._0x4c9901['body']['expiry_date']],_0x5dc33a=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x200)]],_0x4bc83e=[..._0x4c9901[_0xf05b40(0x207)][_0xf05b40(0x208)]];const _0x5ccf65=_0x5ae071[_0xf05b40(0x13b)](_0x513d5d=>{return _0x513d5d={'product_name':_0x513d5d};});_0x20c375[_0xf05b40(0x172)]((_0x132b28,_0x3a84cb)=>{var _0x1bf8d4=_0xf05b40;_0x5ccf65[_0x3a84cb][_0x1bf8d4(0x1e8)]=_0x132b28;}),_0x559701[_0xf05b40(0x172)]((_0x23634e,_0x11df4a)=>{var _0x1ad972=_0xf05b40;_0x5ccf65[_0x11df4a][_0x1ad972(0x1a3)]=_0x23634e;}),_0xf735df[_0xf05b40(0x172)]((_0x2bd162,_0x12ed51)=>{var _0x443102=_0xf05b40;_0x5ccf65[_0x12ed51][_0x443102(0x168)]=_0x2bd162;}),_0x1c29f5[_0xf05b40(0x172)]((_0x34f35e,_0x4538e0)=>{_0x5ccf65[_0x4538e0]['from_floorlevel']=_0x34f35e;}),_0x52fda6[_0xf05b40(0x172)]((_0x56a3f0,_0x4d7212)=>{_0x5ccf65[_0x4d7212]['to_quantity']=_0x56a3f0;}),_0x4a7bcb[_0xf05b40(0x172)]((_0x2134c8,_0x58e54d)=>{_0x5ccf65[_0x58e54d]['to_bay']=_0x2134c8;}),_0x22582d[_0xf05b40(0x172)]((_0x16b41b,_0x4c38f2)=>{var _0x10cd27=_0xf05b40;_0x5ccf65[_0x4c38f2][_0x10cd27(0x1a5)]=_0x16b41b;}),_0x382235[_0xf05b40(0x172)]((_0xeabcaf,_0x5eb2cb)=>{var _0x499d46=_0xf05b40;_0x5ccf65[_0x5eb2cb][_0x499d46(0x154)]=_0xeabcaf;}),_0x3d08a6['forEach']((_0x21001a,_0x2bdb77)=>{_0x5ccf65[_0x2bdb77]['primary_code']=_0x21001a;}),_0x4f50c6[_0xf05b40(0x172)]((_0x43a399,_0x228901)=>{_0x5ccf65[_0x228901]['secondary_code']=_0x43a399;}),_0x33b09e['forEach']((_0x5559df,_0x2a6c61)=>{var _0x513584=_0xf05b40;_0x5ccf65[_0x2a6c61][_0x513584(0x1b5)]=_0x5559df;}),_0x747a3a[_0xf05b40(0x172)]((_0x2b9f5d,_0x227a55)=>{_0x5ccf65[_0x227a55]['maxProducts']=_0x2b9f5d;}),_0xb88380[_0xf05b40(0x172)]((_0x5a6125,_0x4378af)=>{_0x5ccf65[_0x4378af]['unit']=_0x5a6125;}),_0x50b38d[_0xf05b40(0x172)]((_0x697550,_0x126e3b)=>{var _0x3f1e39=_0xf05b40;_0x5ccf65[_0x126e3b][_0x3f1e39(0x1f9)]=_0x697550;}),_0xa4efe3[_0xf05b40(0x172)]((_0x2c5060,_0x218d70)=>{var _0x26179b=_0xf05b40;_0x5ccf65[_0x218d70][_0x26179b(0x1ce)]=_0x2c5060;}),_0x3aeb03['forEach']((_0x6c4e2,_0x4ac280)=>{_0x5ccf65[_0x4ac280]['expiry_date']=_0x6c4e2;}),_0xcbb220['forEach']((_0x303b1b,_0x29cd39)=>{_0x5ccf65[_0x29cd39]['storage']=_0x303b1b;}),_0x7526c9[_0xf05b40(0x172)]((_0x4bd539,_0x5434c7)=>{var _0x4873df=_0xf05b40;_0x5ccf65[_0x5434c7][_0x4873df(0x1cb)]=_0x4bd539;}),_0x38a3ad[_0xf05b40(0x172)]((_0x3e84de,_0x2776f5)=>{var _0xc4a321=_0xf05b40;_0x5ccf65[_0x2776f5][_0xc4a321(0x141)]=_0x3e84de;}),_0x51f932[_0xf05b40(0x172)]((_0x4e96e1,_0x120d64)=>{var _0x3ec8ef=_0xf05b40;_0x5ccf65[_0x120d64][_0x3ec8ef(0x1bf)]=_0x4e96e1;}),_0x5dc33a[_0xf05b40(0x172)]((_0x44dbd0,_0xdd49a9)=>{_0x5ccf65[_0xdd49a9]['from_storage']=_0x44dbd0;}),_0x4bc83e['forEach']((_0x170b1c,_0x4c3751)=>{var _0x7406e=_0xf05b40;_0x5ccf65[_0x4c3751][_0x7406e(0x1a9)]=_0x170b1c;});const _0x217803=_0x5ccf65[_0xf05b40(0x152)](_0x96bf5e=>_0x96bf5e[_0xf05b40(0x1d3)]!=='0'&&_0x96bf5e[_0xf05b40(0x1d3)]!==''||_0x96bf5e[_0xf05b40(0x154)]!=='0'&&_0x96bf5e[_0xf05b40(0x154)]!=='');var _0x47fe47=0x0;_0x217803[_0xf05b40(0x172)](_0x76151c=>{var _0x74e608=_0xf05b40;parseInt(_0x76151c[_0x74e608(0x1e8)])<parseInt(_0x76151c['to_quantity'])&&_0x47fe47++;});if(_0x47fe47!=0x0)return _0x4c9901[_0xf05b40(0x15e)]('errors',_0xf05b40(0x1a7)),_0x58c737['redirect'](_0xf05b40(0x132));const _0x3a60bc=await warehouse['findOne']({'name':_0x32ed31[_0xf05b40(0x1a4)],'room':_0x32ed31[_0xf05b40(0x21b)]});_0x32ed31[_0xf05b40(0x14d)][_0xf05b40(0x172)](_0x2ca32b=>{var _0x4bf0a4=_0xf05b40;if(_0x2ca32b[_0x4bf0a4(0x1d3)]>0x0){const _0x2eb8cd=_0x3a60bc['product_details'][_0x4bf0a4(0x13b)](_0x3dd942=>{var _0x37ee6a=_0x4bf0a4;_0x3dd942[_0x37ee6a(0x18b)]==_0x2ca32b[_0x37ee6a(0x18b)]&&_0x3dd942['floorlevel']==_0x2ca32b['from_floorlevel']&&_0x3dd942['type']==_0x2ca32b[_0x37ee6a(0x141)]&&_0x3dd942[_0x37ee6a(0x17d)]==_0x2ca32b[_0x37ee6a(0x168)]&&_0x3dd942['bay']==_0x2ca32b[_0x37ee6a(0x1a3)]&&_0x3dd942[_0x37ee6a(0x1cb)]==_0x2ca32b[_0x37ee6a(0x1a9)]&&_0x3dd942[_0x37ee6a(0x19e)]==_0x2ca32b[_0x37ee6a(0x200)]&&(_0x3dd942[_0x37ee6a(0x151)]=parseInt(_0x3dd942['product_stock'])+parseInt(_0x2ca32b[_0x37ee6a(0x1d3)]));});}}),await _0x3a60bc[_0xf05b40(0x224)]();const _0x41cbe7=await warehouse[_0xf05b40(0x218)]({'name':_0x32ed31[_0xf05b40(0x221)],'room':_0x32ed31[_0xf05b40(0x1e0)]});_0x32ed31[_0xf05b40(0x14d)][_0xf05b40(0x172)](_0x311b82=>{var _0x4aea7c=_0xf05b40;if(_0x311b82[_0x4aea7c(0x1d3)]>0x0){const _0x2239db=_0x41cbe7[_0x4aea7c(0x205)]['map'](_0x1db6fc=>{var _0xb0f9f4=_0x4aea7c;_0x1db6fc[_0xb0f9f4(0x18b)]==_0x311b82[_0xb0f9f4(0x18b)]&&_0x1db6fc[_0xb0f9f4(0x167)]==_0x311b82[_0xb0f9f4(0x154)]&&_0x1db6fc[_0xb0f9f4(0x143)]==_0x311b82['to_types']&&_0x1db6fc[_0xb0f9f4(0x17d)]==_0x311b82[_0xb0f9f4(0x1a5)]&&_0x1db6fc['bay']==_0x311b82[_0xb0f9f4(0x1fd)]&&_0x1db6fc['rack']==_0x311b82[_0xb0f9f4(0x1cb)]&&_0x1db6fc[_0xb0f9f4(0x19e)]==_0x311b82[_0xb0f9f4(0x19e)]&&(_0x1db6fc[_0xb0f9f4(0x151)]=parseInt(_0x1db6fc[_0xb0f9f4(0x151)])-parseInt(_0x311b82['to_quantity']));});}}),await _0x41cbe7[_0xf05b40(0x224)](),_0x32ed31[_0xf05b40(0x15f)]=_0x4c292d,_0x32ed31[_0xf05b40(0x1a4)]=_0x2b3dc0,_0x32ed31['to_warehouse']=_0x3426b7,_0x32ed31[_0xf05b40(0x14d)]=_0x217803,_0x32ed31[_0xf05b40(0x142)]=_0x164209,_0x32ed31[_0xf05b40(0x1d4)]=_0x3f15da;const _0x36c415=await _0x32ed31[_0xf05b40(0x224)]();console[_0xf05b40(0x1f4)](_0x36c415);const _0x27bcf5=await warehouse[_0xf05b40(0x218)]({'name':_0x2b3dc0,'room':_0x3a068a});_0x36c415[_0xf05b40(0x14d)][_0xf05b40(0x172)](_0x27db32=>{var _0x2c46b0=_0xf05b40;if(_0x27db32[_0x2c46b0(0x1d3)]>0x0){const _0x25619d=_0x27bcf5['product_details'][_0x2c46b0(0x13b)](_0x59b29e=>{var _0x24dc3a=_0x2c46b0;_0x59b29e['product_name']==_0x27db32[_0x24dc3a(0x18b)]&&_0x59b29e[_0x24dc3a(0x167)]==_0x27db32[_0x24dc3a(0x178)]&&_0x59b29e[_0x24dc3a(0x143)]==_0x27db32[_0x24dc3a(0x141)]&&_0x59b29e[_0x24dc3a(0x17d)]==_0x27db32[_0x24dc3a(0x168)]&&_0x59b29e['bay']==_0x27db32['from_bay']&&_0x59b29e['rack']==_0x27db32[_0x24dc3a(0x1a9)]&&_0x59b29e['storage']==_0x27db32['from_storage']&&(_0x59b29e[_0x24dc3a(0x151)]=parseInt(_0x59b29e['product_stock'])-parseInt(_0x27db32[_0x24dc3a(0x1d3)]));});}}),await _0x27bcf5[_0xf05b40(0x224)]();const _0x27bd06=await warehouse[_0xf05b40(0x218)]({'name':_0x3426b7,'room':_0x227c1a});_0x36c415['product'][_0xf05b40(0x172)](_0x25d4e8=>{var _0x572c07=_0xf05b40;if(_0x25d4e8[_0x572c07(0x1d3)]>0x0){var _0x1e751e=0x0;const _0x28bc66=_0x27bd06[_0x572c07(0x205)][_0x572c07(0x13b)](_0x291ed9=>{var _0x4e2fe8=_0x572c07;_0x291ed9['product_name']==_0x25d4e8['product_name']&&_0x291ed9[_0x4e2fe8(0x167)]==_0x25d4e8[_0x4e2fe8(0x154)]&&_0x291ed9[_0x4e2fe8(0x143)]==_0x25d4e8[_0x4e2fe8(0x1bf)]&&_0x291ed9[_0x4e2fe8(0x17d)]==_0x25d4e8['to_bin']&&_0x291ed9[_0x4e2fe8(0x18a)]==_0x25d4e8[_0x4e2fe8(0x1fd)]&&_0x291ed9[_0x4e2fe8(0x1cb)]==_0x25d4e8[_0x4e2fe8(0x1cb)]&&_0x291ed9[_0x4e2fe8(0x19e)]==_0x25d4e8[_0x4e2fe8(0x19e)]&&(_0x291ed9[_0x4e2fe8(0x151)]=parseInt(_0x291ed9[_0x4e2fe8(0x151)])+parseInt(_0x25d4e8['to_quantity']),_0x1e751e++);});_0x1e751e=='0'&&(_0x27bd06[_0x572c07(0x205)]=_0x27bd06[_0x572c07(0x205)][_0x572c07(0x158)]({'product_name':_0x25d4e8['product_name'],'product_stock':_0x25d4e8[_0x572c07(0x1d3)],'bay':_0x25d4e8[_0x572c07(0x1fd)],'bin':_0x25d4e8[_0x572c07(0x1a5)],'type':_0x25d4e8[_0x572c07(0x1bf)],'floorlevel':_0x25d4e8['to_floorlevel'],'storage':_0x25d4e8['storage'],'rack':_0x25d4e8[_0x572c07(0x1cb)],'product_code':_0x25d4e8[_0x572c07(0x1b5)],'primary_code':_0x25d4e8['primary_code'],'secondary_code':_0x25d4e8[_0x572c07(0x1b2)],'maxProducts':_0x25d4e8[_0x572c07(0x1c0)],'storage':_0x25d4e8[_0x572c07(0x19e)],'rack':_0x25d4e8[_0x572c07(0x1cb)]}));}}),await _0x27bd06['save'](),_0x4c9901[_0xf05b40(0x15e)]('success',_0xf05b40(0x1ae)),_0x58c737[_0xf05b40(0x160)](_0xf05b40(0x19f));}catch(_0x2b3be8){console['log'](_0x2b3be8);}}),router[a0_0x2b3321(0x1d1)](a0_0x2b3321(0x193),async(_0x1bfcef,_0x3117e7)=>{var _0x1a813c=a0_0x2b3321;const {FromWareHouse:_0xd5ae1e,FromRoom:_0x1767a2,ToWarehouse:_0x37f8a0,ToRoom:_0x4a213c,primary_code:_0x34b08a,Roomslist:_0x10dbe5}=_0x1bfcef[_0x1a813c(0x207)],_0x42b4a6=_0x10dbe5['split'](','),_0x3dc542=[];async function _0x1bcc8b(_0x2fc869){var _0x501e03=_0x1a813c;const _0x54c52e=await warehouse[_0x501e03(0x1c1)]([{'$match':{'name':_0xd5ae1e,'room':_0x2fc869}},{'$unwind':_0x501e03(0x1b8)},{'$match':{'product_details.primary_code':_0x34b08a}},{'$group':{'_id':_0x501e03(0x134),'name':{'$first':_0x501e03(0x138)},'instock':{'$first':_0x501e03(0x203)},'primary_code':{'$first':_0x501e03(0x14b)},'secondary_code':{'$first':_0x501e03(0x1fb)},'product_code':{'$first':_0x501e03(0x136)},'level':{'$first':_0x501e03(0x1e6)},'isle':{'$first':_0x501e03(0x1eb)},'type':{'$first':_0x501e03(0x181)},'pallet':{'$first':_0x501e03(0x220)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x501e03(0x217)},'storage':{'$first':_0x501e03(0x148)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x501e03(0x140)},'production_date':{'$first':_0x501e03(0x21f)},'batch_code':{'$first':_0x501e03(0x20a)},'maxPerUnit':{'$first':_0x501e03(0x1f6)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x501e03(0x14f)},'maxProducts':{'$first':_0x501e03(0x1ed)}}}]),_0x12acd9=await warehouse[_0x501e03(0x1c1)]([{'$match':{'name':_0xd5ae1e,'room':_0x2fc869}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x34b08a}},{'$group':{'_id':_0x501e03(0x134),'name':{'$first':_0x501e03(0x138)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x501e03(0x14b)},'secondary_code':{'$first':_0x501e03(0x1fb)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x501e03(0x181)},'pallet':{'$first':_0x501e03(0x220)},'unit':{'$first':_0x501e03(0x165)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x501e03(0x140)},'production_date':{'$first':_0x501e03(0x21f)},'batch_code':{'$first':_0x501e03(0x20a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x501e03(0x1ed)}}}]);if(_0x54c52e[_0x501e03(0x1bb)]>0x0)_0x3dc542['push'](_0x54c52e);else _0x12acd9[_0x501e03(0x1bb)]>0x0&&_0x3dc542['push'](_0x12acd9);}const _0x5699f0=_0x42b4a6['map'](_0x465f6b=>_0x1bcc8b(_0x465f6b));await Promise[_0x1a813c(0x1d9)](_0x5699f0),_0x3117e7['json'](_0x3dc542);}),router[a0_0x2b3321(0x1d1)](a0_0x2b3321(0x174),async(_0x2a0293,_0x37e169)=>{var _0x2247d2=a0_0x2b3321;try{const {FromWareHouse:_0x2eeb17,FromRoom:_0x44fadc,ToWarehouse:_0x27241a,ToRoom:_0x2d2f59,secondary_code:_0x1d8eec}=_0x2a0293[_0x2247d2(0x207)],_0x46af24=await warehouse['aggregate']([{'$match':{'name':_0x2eeb17}},{'$unwind':_0x2247d2(0x1b8)},{'$match':{'product_details.secondary_code':_0x1d8eec}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2247d2(0x138)},'primary_code':{'$first':_0x2247d2(0x14b)},'secondary_code':{'$first':_0x2247d2(0x1fb)},'product_code':{'$first':_0x2247d2(0x136)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x2247d2(0x214)},'isle':{'$first':_0x2247d2(0x182)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x2247d2(0x1ed)},'unit':{'$first':_0x2247d2(0x165)}}}]);_0x37e169['status'](0xc8)[_0x2247d2(0x153)](_0x46af24);}catch(_0x35edd5){_0x37e169[_0x2247d2(0x199)](0x194)[_0x2247d2(0x153)]({'message':_0x35edd5[_0x2247d2(0x1c6)]});}}),router[a0_0x2b3321(0x1d1)](a0_0x2b3321(0x1ee),async(_0x37cd48,_0x153966)=>{var _0x4fbd39=a0_0x2b3321;try{const {FromWareHouse:_0x46e9fe,FromRoom:_0x2c079f,ToWarehouse:_0x64b026,ToRoom:_0x3252b9,product_code:_0x31af95}=_0x37cd48['body'],_0x38efd7=await warehouse[_0x4fbd39(0x1c1)]([{'$match':{'name':_0x46e9fe}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x31af95}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4fbd39(0x138)},'primary_code':{'$first':_0x4fbd39(0x14b)},'secondary_code':{'$first':_0x4fbd39(0x1fb)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x4fbd39(0x203)},'warehouse':{'$first':_0x4fbd39(0x156)},'level':{'$first':_0x4fbd39(0x214)},'isle':{'$first':_0x4fbd39(0x182)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x4fbd39(0x1ed)},'unit':{'$first':_0x4fbd39(0x165)}}}]);_0x153966[_0x4fbd39(0x199)](0xc8)[_0x4fbd39(0x153)](_0x38efd7);}catch(_0x582b4a){_0x153966[_0x4fbd39(0x199)](0x194)[_0x4fbd39(0x153)]({'message':_0x582b4a[_0x4fbd39(0x1c6)]});}}),router['post']('/CheckingWarehouse',async(_0x405b33,_0x2fbfc9)=>{var _0x289fb5=a0_0x2b3321;const {level:_0x3ea385,isle:_0x190361,pallet:_0x230b4f,warehouses:_0x1e96b7,room:_0x45450d}=_0x405b33[_0x289fb5(0x207)];try{const _0x1ec567=await warehouse[_0x289fb5(0x1c1)]([{'$match':{'name':_0x1e96b7,'room':_0x45450d}},{'$unwind':_0x289fb5(0x1b8)},{'$match':{'product_details.level':parseInt(_0x3ea385),'product_details.isle':_0x190361,'product_details.pallet':parseInt(_0x230b4f)}},{'$group':{'_id':_0x289fb5(0x134),'name':{'$first':_0x289fb5(0x138)},'product_stock':{'$first':_0x289fb5(0x203)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x289fb5(0x182)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x289fb5(0x1ed)}}}]);_0x2fbfc9[_0x289fb5(0x199)](0xc8)[_0x289fb5(0x153)](_0x1ec567);}catch(_0x559797){_0x2fbfc9[_0x289fb5(0x199)](0x194)[_0x289fb5(0x153)]({'message':_0x559797[_0x289fb5(0x1c6)]});}}),module['exports']=router;