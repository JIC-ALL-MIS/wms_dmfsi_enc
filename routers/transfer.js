function a0_0x5c49(_0x1cbf3e,_0x99343f){var _0x139a10=a0_0x139a();return a0_0x5c49=function(_0x5c4972,_0x4799ed){_0x5c4972=_0x5c4972-0x1d9;var _0x5e0040=_0x139a10[_0x5c4972];return _0x5e0040;},a0_0x5c49(_0x1cbf3e,_0x99343f);}function a0_0x139a(){var _0x46c913=['Ambient','1698ttYKRF','product_stock','logo','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/../public','floorlevel','then','to_prod_pallet','$product_details.floorlevel','/barcode_scanner2','</head><body>','Receiving\x20Area','Rack\x20A','from_floorlevel','<tr>','$product_details.unit','DRY\x20STORAGE','Spanish','from_prod_level','to_prod_level','concat','$product_details.isle','_id','product','edit_transfer','primary_code','Rack\x20B','from_quantity','batch_code','/transfer/preview/','An\x20error\x20occurred.','Arabic','/preview/:id','$room','product_code3','language','Email\x20sent\x20successfully','<div>','Logo.png','to_prod_qty','Portuguese','maxProducts','from_warehouse','17717GlbdvH','<h5\x20style=\x22text-align:\x20left;\x22>','<span\x20style=\x22float:\x20right;\x22>','$product_details.primary_code','length','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','4ZbFsSk','port','from_storage','type','$product_details.maxProducts','catch','Rack\x20F','40690YUzYAG','to_types','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Level','from_types','COLD\x20STORAGE','date','Error\x20Occurs','from_room','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','200965NyIbiV','An\x20error\x20occurred\x20while\x20saving\x20data.','production_date','German','<!DOCTYPE\x20html>','express','$finalize','random','from_prod_isle','push','<h5>','add_transfer','$product_details.expiry_date','invoice','get','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.maxPerUnit','$product_details.product_stock','from_invoice','to_room','</span>','status','post','Router','to_bin','ToRoomAssigned','French','/view/:id','secondary_unit','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</tbody>','message','image','Enabled','getMonth','$product_details.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view/add_transfer','There\x27s\x20a\x20error\x20in\x20this\x20transaction','password','</thead>','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','render','toString','storage','json','to_bay','product_name','padStart','Transfer\x20Finalize\x20Successfully','$product_details.type','site_title','from_prod_qty','bin','findById','Floor','</body></html>','Return\x20Rooms','findOne','$product_details._id','$product_details.secondary_code','2175468xLDscP','Transfer\x20Mail','Product\x20Transfer\x20successfully','primary_unit','prod_name','all','Rack\x20E','99PLNOue','$date','../public/language/languages.json','getDate','/picking_list/PDF_transfer_rm/','</div>','$product.from_room_name','Transfer\x20Edit\x20Successfully','</table>','map','English\x20(US)','bay','rack','$product_details.secondary_unit','$invoice','Rack\x20D','error','Hindi','../middleware/auth','$product_details.level','Arabic\x20(ae)','$product_details.product_code','$product_details.bin','9079884epaKDE','<strong>\x20Regards\x20</strong>','from_bin','to_quantity','slice','from_bay','English','$product_details.rack','split','Chinese','Shelves','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','aggregate','max_per_unit','Portuguese\x20(BR)','sendMail','from_prod_pallet','errors','$product_details.bay','prod_cat','host','product_details','unit','save','/barcode_scanner','$from_warehouse','\x20Order\x20Date\x20:\x20','<html><head><title></title>','role','floor','forEach','</h5>','body','to_invoice','$product_details.production_date','filter','True','Rack\x20C','to_warehouse','expiry_date','maxperunit','flash','secondary_code','params','23249rzVIrt','36ZkAVeI','RMSEmail','</td>','<hr\x20class=\x22my-3\x22>','<h2>\x20','$product_details.storage','note','to_room_name','user','$product_details.pallet','edit_transfer_view','success','master','\x20Order\x20Number\x20:\x20','$name','</tr>','product_code','finalize','/barcode_scanner3','redirect','from_rack','$product_details.batch_code','log','find','warehouse','email','Enclosed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','MaxStocks_data2','To_invoice','updateOne','$product_details','New_Qty_Converted','rak','Raw\x20Materials','transfer','to_floorlevel','$_id','TRF-','$product','from_room_name','RoomAssigned','623872phbofK'];a0_0x139a=function(){return _0x46c913;};return a0_0x139a();}var a0_0x342c66=a0_0x5c49;(function(_0x303cd8,_0x252a81){var _0x3d8387=a0_0x5c49,_0x5aa6b6=_0x303cd8();while(!![]){try{var _0x192e09=parseInt(_0x3d8387(0x28e))/0x1*(parseInt(_0x3d8387(0x1f5))/0x2)+parseInt(_0x3d8387(0x244))/0x3+-parseInt(_0x3d8387(0x28f))/0x4*(parseInt(_0x3d8387(0x206))/0x5)+parseInt(_0x3d8387(0x2bb))/0x6*(-parseInt(_0x3d8387(0x1ef))/0x7)+-parseInt(_0x3d8387(0x2b9))/0x8+-parseInt(_0x3d8387(0x24b))/0x9*(parseInt(_0x3d8387(0x1fc))/0xa)+parseInt(_0x3d8387(0x262))/0xb;if(_0x192e09===_0x252a81)break;else _0x5aa6b6['push'](_0x5aa6b6['shift']());}catch(_0x9943b7){_0x5aa6b6['push'](_0x5aa6b6['shift']());}}}(a0_0x139a,0x60c39));const express=require(a0_0x342c66(0x20b)),app=express(),router=express[a0_0x342c66(0x21d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x342c66(0x25d)),users=require(a0_0x342c66(0x24d)),nodemailer=require('nodemailer');router[a0_0x342c66(0x214)]('/view',auth,async(_0x80874b,_0x5d2586)=>{var _0x185b2b=a0_0x342c66;try{const {username:_0x2b9946,email:_0x55c084,role:_0x265617}=_0x80874b[_0x185b2b(0x297)],_0x3da9d3=_0x80874b[_0x185b2b(0x297)],_0x97552e=await profile[_0x185b2b(0x241)]({'email':_0x3da9d3[_0x185b2b(0x2a8)]}),_0xc284e8=await master_shop['find']();console[_0x185b2b(0x2a5)](_0x185b2b(0x29b),_0xc284e8);let _0x5898c3;if(_0x3da9d3[_0x185b2b(0x27e)]==_0x185b2b(0x22f)){const _0x2d504c=await staff[_0x185b2b(0x241)]({'email':_0x3da9d3[_0x185b2b(0x2a8)]});_0x5898c3=await transfers[_0x185b2b(0x2a6)]({'from_warehouse':_0x2d504c[_0x185b2b(0x2a7)]});}else _0x5898c3=await transfers['aggregate']([{'$unwind':_0x185b2b(0x2b6)},{'$group':{'_id':_0x185b2b(0x2b4),'invoice':{'$first':_0x185b2b(0x259)},'date':{'$first':_0x185b2b(0x24c)},'from_warehouse':{'$first':_0x185b2b(0x27b)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x185b2b(0x251)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x185b2b(0x20c)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xc284e8[0x0][_0x185b2b(0x1e7)]==_0x185b2b(0x255)){var _0x548116=users[_0x185b2b(0x268)];console['log'](_0x548116);}else{if(_0xc284e8[0x0]['language']==_0x185b2b(0x25c))var _0x548116=users[_0x185b2b(0x25c)];else{if(_0xc284e8[0x0][_0x185b2b(0x1e7)]==_0x185b2b(0x209))var _0x548116=users['German'];else{if(_0xc284e8[0x0][_0x185b2b(0x1e7)]==_0x185b2b(0x2cc))var _0x548116=users[_0x185b2b(0x2cc)];else{if(_0xc284e8[0x0][_0x185b2b(0x1e7)]==_0x185b2b(0x220))var _0x548116=users[_0x185b2b(0x220)];else{if(_0xc284e8[0x0][_0x185b2b(0x1e7)]==_0x185b2b(0x270))var _0x548116=users[_0x185b2b(0x1ec)];else{if(_0xc284e8[0x0]['language']==_0x185b2b(0x26b))var _0x548116=users[_0x185b2b(0x26b)];else{if(_0xc284e8[0x0]['language']=='Arabic\x20(ae)')var _0x548116=users['Arabic'];}}}}}}}_0x5d2586[_0x185b2b(0x231)](_0x185b2b(0x2b2),{'success':_0x80874b[_0x185b2b(0x28b)](_0x185b2b(0x29a)),'errors':_0x80874b['flash'](_0x185b2b(0x273)),'role':_0x3da9d3,'profile':_0x97552e,'master_shop':_0xc284e8,'transfer':_0x5898c3,'language':_0x548116});}catch(_0x5bdde6){console[_0x185b2b(0x2a5)](_0x5bdde6);}});async function getRandom8DigitNumber(){var _0x5dcb86=a0_0x342c66;const _0x103c03=0x989680,_0x5d9290=0x5f5e0ff,_0x247832=Math[_0x5dcb86(0x27f)](Math[_0x5dcb86(0x20d)]()*(_0x5d9290-_0x103c03+0x1))+_0x103c03;var _0x1a7846;const _0xc20373=await transfers[_0x5dcb86(0x241)]({'invoice':_0x5dcb86(0x2b5)+_0x247832});return _0xc20373&&_0xc20373[_0x5dcb86(0x1f3)]>0x0?_0x1a7846=_0x5dcb86(0x2b5)+_0x247832:_0x1a7846='TRF-'+_0x247832,_0x1a7846;}router[a0_0x342c66(0x214)](a0_0x342c66(0x22b),auth,async(_0x33946c,_0x52f27b)=>{var _0x36cbc6=a0_0x342c66;try{const {username:_0x5ab998,email:_0x559a11,role:_0x397000}=_0x33946c[_0x36cbc6(0x297)],_0x23c702=_0x33946c['user'],_0x4b9696=await profile[_0x36cbc6(0x241)]({'email':_0x23c702[_0x36cbc6(0x2a8)]}),_0x89ad13=await master_shop['find']();console[_0x36cbc6(0x2a5)](_0x36cbc6(0x29b),_0x89ad13);let _0x2e8bc6;if(_0x23c702[_0x36cbc6(0x27e)]==_0x36cbc6(0x22f)){const _0x14ae75=await staff[_0x36cbc6(0x241)]({'email':_0x23c702[_0x36cbc6(0x2a8)]});_0x2e8bc6=await warehouse[_0x36cbc6(0x26e)]([{'$match':{'status':_0x36cbc6(0x227),'name':_0x14ae75[_0x36cbc6(0x2a7)],'warehouse_category':_0x36cbc6(0x2b1)}},{'$group':{'_id':_0x36cbc6(0x29d),'name':{'$first':_0x36cbc6(0x29d)}}}]);}else _0x2e8bc6=await warehouse[_0x36cbc6(0x26e)]([{'$match':{'status':_0x36cbc6(0x227),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x36cbc6(0x29d),'name':{'$first':_0x36cbc6(0x29d)}}}]);var _0x1d1ab1=[_0x36cbc6(0x2ba),_0x36cbc6(0x2a9),_0x36cbc6(0x240)];const _0xedc707=await transfers[_0x36cbc6(0x2a6)]({}),_0x3921e3=_0xedc707[_0x36cbc6(0x1f3)]+0x1,_0x661c5=_0x36cbc6(0x2b5)+_0x3921e3[_0x36cbc6(0x232)]()[_0x36cbc6(0x237)](0x5,'0');if(_0x89ad13[0x0][_0x36cbc6(0x1e7)]==_0x36cbc6(0x255)){var _0x45bcc4=users[_0x36cbc6(0x268)];console[_0x36cbc6(0x2a5)](_0x45bcc4);}else{if(_0x89ad13[0x0][_0x36cbc6(0x1e7)]==_0x36cbc6(0x25c))var _0x45bcc4=users[_0x36cbc6(0x25c)];else{if(_0x89ad13[0x0]['language']=='German')var _0x45bcc4=users[_0x36cbc6(0x209)];else{if(_0x89ad13[0x0][_0x36cbc6(0x1e7)]==_0x36cbc6(0x2cc))var _0x45bcc4=users[_0x36cbc6(0x2cc)];else{if(_0x89ad13[0x0][_0x36cbc6(0x1e7)]==_0x36cbc6(0x220))var _0x45bcc4=users['French'];else{if(_0x89ad13[0x0][_0x36cbc6(0x1e7)]==_0x36cbc6(0x270))var _0x45bcc4=users[_0x36cbc6(0x1ec)];else{if(_0x89ad13[0x0][_0x36cbc6(0x1e7)]==_0x36cbc6(0x26b))var _0x45bcc4=users[_0x36cbc6(0x26b)];else{if(_0x89ad13[0x0][_0x36cbc6(0x1e7)]==_0x36cbc6(0x25f))var _0x45bcc4=users[_0x36cbc6(0x1e3)];}}}}}}}const _0x364b3d=getRandom8DigitNumber();_0x364b3d[_0x36cbc6(0x2c1)](_0x12b78b=>{var _0x2cca58=_0x36cbc6;_0x52f27b[_0x2cca58(0x231)](_0x2cca58(0x211),{'success':_0x33946c[_0x2cca58(0x28b)](_0x2cca58(0x29a)),'errors':_0x33946c['flash'](_0x2cca58(0x273)),'role':_0x23c702,'profile':_0x4b9696,'master_shop':_0x89ad13,'warehouse':_0x2e8bc6,'language':_0x45bcc4,'rooms_data':_0x1d1ab1,'invoice':_0x12b78b});})[_0x36cbc6(0x1fa)](_0x17ce99=>{var _0x8565ff=_0x36cbc6;_0x33946c[_0x8565ff(0x28b)]('errors',_0x8565ff(0x22c)),_0x52f27b['redirect']('/transfer/view');});}catch(_0x1c2b82){console['log'](_0x1c2b82);}}),router[a0_0x342c66(0x21c)]('/view/add_transfer',auth,async(_0x2ca3e3,_0x1779e1)=>{var _0x73b08b=a0_0x342c66;try{console[_0x73b08b(0x2a5)](_0x2ca3e3[_0x73b08b(0x282)]);const {date:_0xc701b5,from_warehouse:_0x42a34b,FromRoom_name:_0xfdef10,to_warehouse:_0x59436b,ToRoom_name:_0x4eeed8,prod_name:_0x3f0b73,from_prod_qty:_0x4a2e5b,from_prod_level:_0x13b9f4,from_prod_isle:_0x598211,from_prod_pallet:_0x433153,to_prod_qty:_0x296da6,to_prod_level:_0x58256d,to_prod_isle:_0x13b4e9,to_prod_pallet:_0x527417,primary_code:_0x2a457b,secondary_code:_0x278549,product_code3:_0x587b06,note:_0x3d5587,MaxStocks_data2:_0x4ac7fb,invoice:_0x1fd3af,expiry_date:_0x459dfd}=_0x2ca3e3[_0x73b08b(0x282)];if(typeof _0x3f0b73=='string')var _0x41cf2e=[_0x2ca3e3[_0x73b08b(0x282)]['prod_name']],_0x4e2fc6=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x23b)]],_0x200e52=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x2cd)]],_0x1168b5=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x2af)]],_0x1241ae=[_0x2ca3e3[_0x73b08b(0x282)]['to_prod_level']],_0x59a51a=[_0x2ca3e3[_0x73b08b(0x282)]['primary_code']],_0x44eca5=[_0x2ca3e3['body'][_0x73b08b(0x28c)]],_0x65ee7=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x1e6)]],_0x443703=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x2ab)]],_0x846ca=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x247)]],_0x291636=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x222)]],_0x19d13c=[_0x2ca3e3[_0x73b08b(0x282)]['batch_code']],_0x4348c6=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x289)]],_0x2f5f7f=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x26f)]],_0x3835e6=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x208)]],_0x1e756b=[_0x2ca3e3['body']['prod_cat']],_0x2d8007=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x2b8)]],_0x1d0ee2=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x21f)]],_0x234651=[_0x2ca3e3[_0x73b08b(0x282)]['from_invoice']],_0x367743=[_0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x283)]];else var _0x41cf2e=[..._0x2ca3e3['body']['prod_name']],_0x4e2fc6=[..._0x2ca3e3[_0x73b08b(0x282)]['from_prod_qty']],_0x200e52=[..._0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x2cd)]],_0x1168b5=[..._0x2ca3e3['body'][_0x73b08b(0x2af)]],_0x1241ae=[..._0x2ca3e3['body']['to_prod_level']],_0x59a51a=[..._0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x1dd)]],_0x44eca5=[..._0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x28c)]],_0x65ee7=[..._0x2ca3e3['body'][_0x73b08b(0x1e6)]],_0x443703=[..._0x2ca3e3[_0x73b08b(0x282)]['MaxStocks_data2']],_0x846ca=[..._0x2ca3e3['body'][_0x73b08b(0x247)]],_0x291636=[..._0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x222)]],_0x19d13c=[..._0x2ca3e3['body'][_0x73b08b(0x1e0)]],_0x4348c6=[..._0x2ca3e3['body'][_0x73b08b(0x289)]],_0x2f5f7f=[..._0x2ca3e3[_0x73b08b(0x282)][_0x73b08b(0x26f)]],_0x3835e6=[..._0x2ca3e3['body'][_0x73b08b(0x208)]],_0x1e756b=[..._0x2ca3e3['body'][_0x73b08b(0x275)]],_0x2d8007=[..._0x2ca3e3['body'][_0x73b08b(0x2b8)]],_0x1d0ee2=[..._0x2ca3e3['body']['ToRoomAssigned']],_0x234651=[..._0x2ca3e3['body'][_0x73b08b(0x218)]],_0x367743=[..._0x2ca3e3[_0x73b08b(0x282)]['to_invoice']];const _0x4ab964=_0x41cf2e['map'](_0x1cdb84=>{return _0x1cdb84={'product_name':_0x1cdb84};});_0x4e2fc6[_0x73b08b(0x280)]((_0x15415d,_0x23ed5b)=>{var _0x375033=_0x73b08b;_0x4ab964[_0x23ed5b][_0x375033(0x1df)]=_0x15415d;}),_0x234651['forEach']((_0x474837,_0x3d3fee)=>{var _0x1b8756=_0x73b08b;_0x4ab964[_0x3d3fee][_0x1b8756(0x218)]=_0x474837;}),_0x367743['forEach']((_0x389e2d,_0x5d4ad5)=>{var _0x235b10=_0x73b08b;_0x4ab964[_0x5d4ad5][_0x235b10(0x2ac)]=_0x389e2d;}),_0x200e52['forEach']((_0x118663,_0x36c675)=>{var _0x573657=_0x73b08b;_0x2d8007[_0x573657(0x280)]((_0x2a148d,_0x19879d)=>{var _0x2a48ec=_0x573657;if(_0x2a148d==_0x2a48ec(0x2c6)&&_0x36c675==_0x19879d){var _0x9fb482=_0x118663['slice'](0x3);_0x4ab964[_0x36c675][_0x2a48ec(0x1f7)]=_0x118663[0x0],_0x4ab964[_0x36c675][_0x2a48ec(0x2a3)]=_0x118663[0x1],_0x4ab964[_0x36c675]['from_bay']=0x0,_0x4ab964[_0x36c675]['from_bin']=0x0,_0x4ab964[_0x36c675][_0x2a48ec(0x200)]=_0x2a48ec(0x23e),_0x4ab964[_0x36c675][_0x2a48ec(0x2c8)]=_0x9fb482;}else{if(_0x2a148d==_0x2a48ec(0x26c)&&_0x36c675==_0x19879d){var _0x9fb482=_0x118663[_0x2a48ec(0x266)](0x3);_0x4ab964[_0x36c675]['from_storage']=_0x118663[0x0],_0x4ab964[_0x36c675]['from_rack']=_0x118663[0x1],_0x4ab964[_0x36c675]['from_bay']=0x0,_0x4ab964[_0x36c675]['from_bin']=0x0,_0x4ab964[_0x36c675]['from_types']=_0x2a48ec(0x23e),_0x4ab964[_0x36c675]['from_floorlevel']=_0x118663[0x5];}else{if(_0x36c675==_0x19879d){var _0x2f1dca;if(_0x118663[0x4]=='L')_0x2f1dca='Level';else _0x118663[0x4]=='F'&&(_0x2f1dca=_0x2a48ec(0x23e));_0x4ab964[_0x36c675][_0x2a48ec(0x1f7)]=_0x118663[0x0],_0x4ab964[_0x36c675][_0x2a48ec(0x2a3)]=_0x118663[0x1],_0x4ab964[_0x36c675][_0x2a48ec(0x267)]=_0x118663[0x2],_0x4ab964[_0x36c675][_0x2a48ec(0x264)]=_0x118663[0x3],_0x4ab964[_0x36c675][_0x2a48ec(0x200)]=_0x2f1dca,_0x4ab964[_0x36c675][_0x2a48ec(0x2c8)]=_0x118663[0x5];}}}});}),_0x1168b5[_0x73b08b(0x280)]((_0x13b9f6,_0x5c6f95)=>{_0x4ab964[_0x5c6f95]['to_quantity']=_0x13b9f6;}),_0x1241ae[_0x73b08b(0x280)]((_0x325853,_0xc1d5f5)=>{var _0x32ff70=_0x73b08b;_0x1d0ee2[_0x32ff70(0x280)]((_0x306e4e,_0x53f408)=>{var _0x1eb8a9=_0x32ff70;if(_0x306e4e==_0x1eb8a9(0x2c6)&&_0xc1d5f5==_0x53f408){var _0x324c0f=_0x325853[_0x1eb8a9(0x266)](0x3);_0x4ab964[_0xc1d5f5]['storage']=_0x325853[0x0],_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x257)]=_0x325853[0x1],_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x235)]=0x0,_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x21e)]=0x0,_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x1fd)]='Floor',_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x2b3)]=_0x324c0f;}else{if(_0x306e4e==_0x1eb8a9(0x26c)&&_0xc1d5f5==_0x53f408){var _0x324c0f=_0x325853[_0x1eb8a9(0x266)](0x3);_0x4ab964[_0xc1d5f5]['storage']=_0x325853[0x0],_0x4ab964[_0xc1d5f5]['rack']=_0x325853[0x1],_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x235)]=0x0,_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x21e)]=0x0,_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x1fd)]=_0x1eb8a9(0x23e),_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x2b3)]=_0x325853[0x5];}else{if(_0xc1d5f5==_0x53f408){var _0x4386ce;if(_0x325853[0x4]=='L')_0x4386ce=_0x1eb8a9(0x1ff);else _0x325853[0x4]=='F'&&(_0x4386ce='Floor');_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x233)]=_0x325853[0x0],_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x257)]=_0x325853[0x1],_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x235)]=_0x325853[0x2],_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x21e)]=_0x325853[0x3],_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x1fd)]=_0x4386ce,_0x4ab964[_0xc1d5f5][_0x1eb8a9(0x2b3)]=_0x325853[0x5];}}}});}),_0x59a51a['forEach']((_0x429a3a,_0x4e0342)=>{var _0x45dfa3=_0x73b08b;_0x4ab964[_0x4e0342][_0x45dfa3(0x1dd)]=_0x429a3a;}),_0x44eca5[_0x73b08b(0x280)]((_0x65cdf5,_0x50c144)=>{_0x4ab964[_0x50c144]['secondary_code']=_0x65cdf5;}),_0x65ee7[_0x73b08b(0x280)]((_0x345cfb,_0x14174d)=>{_0x4ab964[_0x14174d]['product_code']=_0x345cfb;}),_0x443703[_0x73b08b(0x280)]((_0x3e4ef2,_0x4f7e29)=>{var _0x2e2c08=_0x73b08b;_0x4ab964[_0x4f7e29][_0x2e2c08(0x1ed)]=_0x3e4ef2;}),_0x846ca[_0x73b08b(0x280)]((_0x53e1ea,_0x4a914d)=>{var _0x20406d=_0x73b08b;_0x4ab964[_0x4a914d][_0x20406d(0x278)]=_0x53e1ea;}),_0x291636['forEach']((_0x3f4a18,_0xf0a25c)=>{var _0x14dd5c=_0x73b08b;_0x4ab964[_0xf0a25c][_0x14dd5c(0x222)]=_0x3f4a18;}),_0x19d13c[_0x73b08b(0x280)]((_0x24b2b9,_0x1936b3)=>{_0x4ab964[_0x1936b3]['batch_code']=_0x24b2b9;}),_0x4348c6[_0x73b08b(0x280)]((_0x31cb52,_0x1e12aa)=>{var _0x14f326=_0x73b08b;_0x4ab964[_0x1e12aa][_0x14f326(0x289)]=_0x31cb52;}),_0x2f5f7f[_0x73b08b(0x280)]((_0x102ccb,_0x46cc28)=>{var _0x4ef6b1=_0x73b08b;_0x4ab964[_0x46cc28][_0x4ef6b1(0x28a)]=_0x102ccb;}),_0x3835e6[_0x73b08b(0x280)]((_0x4b3955,_0x47ada8)=>{var _0x5e33bf=_0x73b08b;_0x4ab964[_0x47ada8][_0x5e33bf(0x208)]=_0x4b3955;}),_0x1e756b[_0x73b08b(0x280)]((_0x3a649f,_0xea5644)=>{var _0x5cbf70=_0x73b08b;_0x4ab964[_0xea5644][_0x5cbf70(0x275)]=_0x3a649f;}),_0x2d8007[_0x73b08b(0x280)]((_0x2346b0,_0x5d3779)=>{var _0x2d40f0=_0x73b08b;_0x4ab964[_0x5d3779][_0x2d40f0(0x2b7)]=_0x2346b0;}),_0x1d0ee2[_0x73b08b(0x280)]((_0x224a63,_0x5d6bbb)=>{var _0x32b06c=_0x73b08b;_0x4ab964[_0x5d6bbb][_0x32b06c(0x296)]=_0x224a63;});const _0x7ce7dd=_0x4ab964[_0x73b08b(0x285)](_0x50041a=>_0x50041a[_0x73b08b(0x265)]!=='0'&&_0x50041a[_0x73b08b(0x265)]!==''||_0x50041a[_0x73b08b(0x2b3)]!=='0'&&_0x50041a[_0x73b08b(0x2b3)]!==''),_0x536a66=new transfers({'date':_0xc701b5,'from_warehouse':_0x42a34b,'to_warehouse':_0x59436b,'product':_0x7ce7dd,'note':_0x3d5587,'invoice':_0x1fd3af}),_0x234c06=await _0x536a66[_0x73b08b(0x279)]();_0x2ca3e3[_0x73b08b(0x28b)](_0x73b08b(0x29a),_0x73b08b(0x246)),_0x1779e1[_0x73b08b(0x2a2)](_0x73b08b(0x1e1)+_0x234c06[_0x73b08b(0x1da)]);}catch(_0xa71a){console[_0x73b08b(0x2a5)](_0xa71a),_0x1779e1[_0x73b08b(0x21b)](0xc8)[_0x73b08b(0x234)]({'errorMessage':_0xa71a[_0x73b08b(0x225)]});}}),router[a0_0x342c66(0x214)](a0_0x342c66(0x1e4),auth,async(_0x58bba0,_0x5a9296)=>{var _0x48584e=a0_0x342c66;try{const {username:_0x92909,email:_0xc3b0f6,role:_0xc2187e}=_0x58bba0['user'],_0x500457=_0x58bba0[_0x48584e(0x297)],_0x20aeb=await profile[_0x48584e(0x241)]({'email':_0x500457[_0x48584e(0x2a8)]}),_0x3c9a8e=await master_shop[_0x48584e(0x2a6)]();console[_0x48584e(0x2a5)]('master',_0x3c9a8e);const _0x4be499=await transfers[_0x48584e(0x23d)](_0x58bba0[_0x48584e(0x28d)]['id']);let _0x3880d2=new Date(_0x4be499['expiry_date']),_0x2c66e0=('0'+_0x3880d2[_0x48584e(0x24e)]())[_0x48584e(0x266)](-0x2),_0x23fa10=('0'+(_0x3880d2[_0x48584e(0x228)]()+0x1))[_0x48584e(0x266)](-0x2),_0x456114=_0x3880d2['getFullYear'](),_0x2d04dd=_0x456114+'-'+_0x23fa10+'-'+_0x2c66e0,_0x1aff28;if(_0x500457['role']==_0x48584e(0x22f)){const _0x5a43bd=await staff['findOne']({'email':_0x500457[_0x48584e(0x2a8)]});_0x1aff28=await warehouse[_0x48584e(0x2a6)]({'status':_0x48584e(0x227),'name':_0x5a43bd['warehouse'],'warehouse_category':'Raw\x20Materials'});}else _0x1aff28=await warehouse[_0x48584e(0x2a6)]({'status':_0x48584e(0x227),'warehouse_category':_0x48584e(0x2b1)});const _0x28cc00=await warehouse[_0x48584e(0x26e)]([{'$match':{'name':_0x4be499[_0x48584e(0x1ee)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x48584e(0x242),'name':{'$first':_0x48584e(0x229)},'product_stock':{'$first':_0x48584e(0x217)},'bay':{'$first':_0x48584e(0x274)},'bin':{'$first':_0x48584e(0x261)},'type':{'$first':_0x48584e(0x239)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x48584e(0x1f2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x48584e(0x260)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x48584e(0x269)},'expiry_date':{'$first':_0x48584e(0x212)},'production_date':{'$first':_0x48584e(0x284)},'room':{'$first':_0x48584e(0x1e5)}}}]);if(_0x3c9a8e[0x0][_0x48584e(0x1e7)]=='English\x20(US)'){var _0x26a8f4=users[_0x48584e(0x268)];console[_0x48584e(0x2a5)](_0x26a8f4);}else{if(_0x3c9a8e[0x0][_0x48584e(0x1e7)]==_0x48584e(0x25c))var _0x26a8f4=users[_0x48584e(0x25c)];else{if(_0x3c9a8e[0x0][_0x48584e(0x1e7)]==_0x48584e(0x209))var _0x26a8f4=users[_0x48584e(0x209)];else{if(_0x3c9a8e[0x0][_0x48584e(0x1e7)]==_0x48584e(0x2cc))var _0x26a8f4=users[_0x48584e(0x2cc)];else{if(_0x3c9a8e[0x0][_0x48584e(0x1e7)]==_0x48584e(0x220))var _0x26a8f4=users['French'];else{if(_0x3c9a8e[0x0]['language']=='Portuguese\x20(BR)')var _0x26a8f4=users['Portuguese'];else{if(_0x3c9a8e[0x0][_0x48584e(0x1e7)]==_0x48584e(0x26b))var _0x26a8f4=users[_0x48584e(0x26b)];else{if(_0x3c9a8e[0x0]['language']==_0x48584e(0x25f))var _0x26a8f4=users['Arabic'];}}}}}}}_0x5a9296[_0x48584e(0x231)](_0x48584e(0x299),{'success':_0x58bba0[_0x48584e(0x28b)](_0x48584e(0x29a)),'errors':_0x58bba0[_0x48584e(0x28b)](_0x48584e(0x273)),'role':_0x500457,'profile':_0x20aeb,'master_shop':_0x3c9a8e,'warehouse':_0x1aff28,'transfer':_0x4be499,'stock':_0x28cc00,'language':_0x26a8f4});}catch(_0x15c767){console[_0x48584e(0x2a5)](_0x15c767);}}),router['post'](a0_0x342c66(0x1e4),auth,async(_0x43c834,_0x47d392)=>{var _0x2c3308=a0_0x342c66;try{const _0x4d4143=_0x43c834[_0x2c3308(0x28d)]['id'],{from_warehouse:_0x3221cd,FromRoom_name:_0x4c3210,to_warehouse:_0x347003,ToRoom_name:_0x453be9}=_0x43c834[_0x2c3308(0x282)],_0x117f5a=await transfers[_0x2c3308(0x23d)]({'_id':_0x4d4143}),_0x4a25fd=_0x117f5a[_0x2c3308(0x1db)][_0x2c3308(0x254)](async _0x4333fc=>{var _0x5bd4f4=_0x2c3308;if(_0x4333fc[_0x5bd4f4(0x265)]>0x0){var _0x4a307c=await warehouse[_0x5bd4f4(0x241)]({'name':_0x117f5a['from_warehouse'],'room':_0x4333fc[_0x5bd4f4(0x2b7)],'warehouse_category':_0x5bd4f4(0x2b1)});const _0x36c9ad=_0x4a307c[_0x5bd4f4(0x277)][_0x5bd4f4(0x254)](_0x2a46f7=>{var _0x2ccdc7=_0x5bd4f4;_0x2a46f7[_0x2ccdc7(0x236)]==_0x4333fc[_0x2ccdc7(0x236)]&&_0x2a46f7[_0x2ccdc7(0x2c0)]==_0x4333fc[_0x2ccdc7(0x2c8)]&&_0x2a46f7[_0x2ccdc7(0x1f8)]==_0x4333fc[_0x2ccdc7(0x200)]&&_0x2a46f7[_0x2ccdc7(0x23c)]==_0x4333fc[_0x2ccdc7(0x264)]&&_0x2a46f7[_0x2ccdc7(0x256)]==_0x4333fc['from_bay']&&_0x2a46f7[_0x2ccdc7(0x257)]==_0x4333fc[_0x2ccdc7(0x2a3)]&&_0x2a46f7[_0x2ccdc7(0x233)]==_0x4333fc[_0x2ccdc7(0x1f7)]&&_0x2a46f7[_0x2ccdc7(0x289)]==_0x4333fc['expiry_date']&&_0x2a46f7['batch_code']==_0x4333fc['batch_code']&&_0x2a46f7['production_date']==_0x4333fc[_0x2ccdc7(0x208)]&&_0x2a46f7['invoice']==_0x4333fc[_0x2ccdc7(0x218)]&&(_0x2a46f7[_0x2ccdc7(0x2bc)]=_0x2a46f7[_0x2ccdc7(0x2bc)]-_0x4333fc[_0x2ccdc7(0x265)]);});}return _0x4a307c;});Promise[_0x2c3308(0x249)](_0x4a25fd)['then'](async _0x416e84=>{var _0x56eb5f=_0x2c3308;try{for(const _0x2f9cea of _0x416e84){await _0x2f9cea[_0x56eb5f(0x279)]();}try{const _0x588571=_0x117f5a['product']['map'](async _0x49eafc=>{var _0x8a135b=_0x56eb5f;if(_0x49eafc[_0x8a135b(0x265)]>0x0){var _0x399296=await warehouse['findOne']({'name':_0x117f5a[_0x8a135b(0x288)],'room':_0x49eafc[_0x8a135b(0x296)],'warehouse_category':_0x8a135b(0x2b1)}),_0x88f7f6=0x0;const _0x3ad04d=_0x399296[_0x8a135b(0x277)][_0x8a135b(0x254)](_0x435beb=>{var _0x4bb747=_0x8a135b;_0x435beb[_0x4bb747(0x236)]==_0x49eafc[_0x4bb747(0x236)]&&_0x435beb[_0x4bb747(0x2c0)]==_0x49eafc[_0x4bb747(0x2b3)]&&_0x435beb[_0x4bb747(0x1f8)]==_0x49eafc[_0x4bb747(0x1fd)]&&_0x435beb[_0x4bb747(0x23c)]==_0x49eafc[_0x4bb747(0x21e)]&&_0x435beb[_0x4bb747(0x256)]==_0x49eafc[_0x4bb747(0x235)]&&_0x435beb[_0x4bb747(0x257)]==_0x49eafc['rack']&&_0x435beb[_0x4bb747(0x233)]==_0x49eafc[_0x4bb747(0x233)]&&_0x435beb[_0x4bb747(0x289)]==_0x49eafc['expiry_date']&&_0x435beb[_0x4bb747(0x1e0)]==_0x49eafc[_0x4bb747(0x1e0)]&&_0x435beb[_0x4bb747(0x208)]==_0x49eafc[_0x4bb747(0x208)]&&_0x435beb[_0x4bb747(0x213)]==_0x49eafc[_0x4bb747(0x2ac)]&&(_0x435beb[_0x4bb747(0x2bc)]=_0x435beb['product_stock']+_0x49eafc[_0x4bb747(0x265)],_0x88f7f6++);});_0x88f7f6=='0'&&(_0x399296['product_details']=_0x399296['product_details'][_0x8a135b(0x2cf)]({'product_name':_0x49eafc['product_name'],'product_stock':_0x49eafc[_0x8a135b(0x265)],'bay':_0x49eafc['to_bay'],'bin':_0x49eafc[_0x8a135b(0x21e)],'type':_0x49eafc[_0x8a135b(0x1fd)],'floorlevel':_0x49eafc[_0x8a135b(0x2b3)],'storage':_0x49eafc['storage'],'rack':_0x49eafc[_0x8a135b(0x257)],'product_code':_0x49eafc[_0x8a135b(0x29f)],'primary_code':_0x49eafc[_0x8a135b(0x1dd)],'secondary_code':_0x49eafc['secondary_code'],'maxProducts':_0x49eafc[_0x8a135b(0x1ed)],'storage':_0x49eafc[_0x8a135b(0x233)],'rack':_0x49eafc['rack'],'expiry_date':_0x49eafc[_0x8a135b(0x289)],'maxPerUnit':_0x49eafc[_0x8a135b(0x28a)],'batch_code':_0x49eafc[_0x8a135b(0x1e0)],'production_date':_0x49eafc[_0x8a135b(0x208)]}));}return _0x399296;});Promise[_0x56eb5f(0x249)](_0x588571)[_0x56eb5f(0x2c1)](async _0x520f0c=>{var _0x486b11=_0x56eb5f;try{for(const _0x2d9d4b of _0x520f0c){await warehouse[_0x486b11(0x2ad)]({'_id':_0x2d9d4b[_0x486b11(0x1da)]},{'$addToSet':{'product_details':{'$each':_0x2d9d4b[_0x486b11(0x277)]}}});}_0x117f5a[_0x486b11(0x2a0)]=_0x486b11(0x286);const _0x206aea=await _0x117f5a[_0x486b11(0x279)](),_0x10d5dc=await master_shop['find'](),_0x13aef8=await email_settings[_0x486b11(0x241)](),_0x59e7c3=await supervisor_settings['find']();var _0x5a8816=_0x117f5a[_0x486b11(0x1db)],_0x194eb8='',_0x34dec0;for(_0x34dec0 in _0x5a8816){_0x194eb8+=_0x486b11(0x2c9)+_0x486b11(0x1f4)+_0x5a8816[_0x34dec0]['product_name']+_0x486b11(0x291)+_0x486b11(0x1f4)+_0x5a8816[_0x34dec0]['product_code']+'</td>'+_0x486b11(0x1f4)+_0x5a8816[_0x34dec0][_0x486b11(0x265)]+_0x486b11(0x291)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5a8816[_0x34dec0][_0x486b11(0x278)]+_0x486b11(0x291)+_0x486b11(0x1f4)+_0x5a8816[_0x34dec0][_0x486b11(0x222)]+_0x486b11(0x291)+_0x486b11(0x1f4)+_0x117f5a['to_warehouse']+_0x486b11(0x291)+_0x486b11(0x1f4)+_0x5a8816[_0x34dec0][_0x486b11(0x296)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5a8816[_0x34dec0]['storage']+_0x5a8816[_0x34dec0][_0x486b11(0x257)]+_0x5a8816[_0x34dec0][_0x486b11(0x235)]+_0x5a8816[_0x34dec0][_0x486b11(0x21e)]+_0x5a8816[_0x34dec0][_0x486b11(0x1fd)][0x0]+_0x5a8816[_0x34dec0]['to_floorlevel']+_0x486b11(0x291),_0x486b11(0x29e);}let _0x263ff2=nodemailer['createTransport']({'host':_0x13aef8[_0x486b11(0x276)],'port':Number(_0x13aef8[_0x486b11(0x1f6)]),'secure':![],'auth':{'user':_0x13aef8[_0x486b11(0x2a8)],'pass':_0x13aef8[_0x486b11(0x22d)]}}),_0x54c268={'from':_0x13aef8[_0x486b11(0x2a8)],'to':_0x59e7c3[0x0][_0x486b11(0x290)],'subject':_0x486b11(0x245),'attachments':[{'filename':_0x486b11(0x1ea),'path':__dirname+_0x486b11(0x2bf)+'/upload/'+_0x10d5dc[0x0][_0x486b11(0x226)],'cid':_0x486b11(0x2bd)}],'html':_0x486b11(0x20a)+_0x486b11(0x27d)+_0x486b11(0x2c5)+'<div>'+_0x486b11(0x223)+_0x486b11(0x1e9)+_0x486b11(0x205)+_0x486b11(0x250)+_0x486b11(0x1e9)+_0x486b11(0x293)+_0x10d5dc[0x0][_0x486b11(0x23a)]+'\x20</h2>'+_0x486b11(0x250)+_0x486b11(0x250)+_0x486b11(0x292)+_0x486b11(0x1e9)+_0x486b11(0x1f0)+_0x486b11(0x29c)+_0x117f5a[_0x486b11(0x213)]+'\x20'+_0x486b11(0x1f1)+_0x486b11(0x27c)+_0x117f5a[_0x486b11(0x202)]+'\x20'+_0x486b11(0x21a)+_0x486b11(0x281)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x486b11(0x22a)+_0x486b11(0x2aa)+_0x486b11(0x1fe)+_0x486b11(0x2be)+_0x486b11(0x26d)+_0x486b11(0x230)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x486b11(0x215)+_0x486b11(0x29e)+_0x486b11(0x22e)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x194eb8+'\x20'+_0x486b11(0x224)+_0x486b11(0x253)+_0x486b11(0x1e9)+_0x486b11(0x263)+_0x486b11(0x210)+_0x10d5dc[0x0][_0x486b11(0x23a)]+_0x486b11(0x281)+_0x486b11(0x250)+_0x486b11(0x250)+_0x486b11(0x23f)};_0x263ff2[_0x486b11(0x271)](_0x54c268,function(_0xc371d3,_0x4e5c8a){var _0x36f660=_0x486b11;_0xc371d3?(console[_0x36f660(0x2a5)](_0xc371d3),console[_0x36f660(0x2a5)](_0x36f660(0x203))):console[_0x36f660(0x2a5)](_0x36f660(0x1e8));}),_0x43c834[_0x486b11(0x28b)](_0x486b11(0x29a),_0x486b11(0x238)),_0x47d392[_0x486b11(0x2a2)](_0x486b11(0x24f)+_0x206aea[_0x486b11(0x1da)]);}catch(_0x568ddf){console[_0x486b11(0x25b)](_0x568ddf),_0x47d392[_0x486b11(0x21b)](0x1f4)[_0x486b11(0x234)]({'Perror':_0x486b11(0x207),'message':_0x568ddf[_0x486b11(0x225)]});}})['catch'](_0x20add5=>{var _0x4ac64d=_0x56eb5f;console['error'](_0x20add5),_0x47d392[_0x4ac64d(0x21b)](0x1f4)[_0x4ac64d(0x234)]({'Perror':_0x4ac64d(0x1e2)});});}catch(_0x388df4){_0x47d392['json'](_0x388df4);}}catch(_0x20eedb){console[_0x56eb5f(0x25b)](_0x20eedb),_0x47d392['status'](0x1f4)['json']({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x20eedb[_0x56eb5f(0x225)]});}})[_0x2c3308(0x1fa)](_0x537a8b=>{var _0x505fab=_0x2c3308;console[_0x505fab(0x25b)](_0x537a8b),_0x47d392[_0x505fab(0x21b)](0x1f4)[_0x505fab(0x234)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x4eccb7){console[_0x2c3308(0x2a5)](_0x4eccb7);}});function BayBinSelected(_0x5e9048,_0x598ac8){var _0x1c60f1=a0_0x342c66,_0x47ab78=[],_0x67e5e4=[],_0x3778b4=[],_0x2a6fa6=[],_0x2b2049=[],_0x396eb5=[];let _0x5a3fdb=[];if(_0x5e9048==_0x1c60f1(0x2cb))switch(_0x598ac8){case _0x1c60f1(0x2c7):_0x47ab78=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x67e5e4=[0x1,0x2],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=[_0x1c60f1(0x1ff),_0x1c60f1(0x23e)],_0x2b2049=['D'],_0x396eb5=['A'];break;case _0x1c60f1(0x1de):_0x47ab78=[0x6,0x5,0x4,0x3,0x2,0x1],_0x67e5e4=[0x1,0x2],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=[_0x1c60f1(0x1ff),_0x1c60f1(0x23e)],_0x2b2049=['D'],_0x396eb5=['B'];break;case'Shelves':_0x47ab78=[0x0],_0x67e5e4=[0x0],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=[_0x1c60f1(0x23e)],_0x2b2049=['D'],_0x396eb5=['S'];break;case _0x1c60f1(0x2c6):_0x47ab78=[0x0],_0x67e5e4=[0x0],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3778b4=[_0x1c60f1(0x23e)],_0x2b2049=['D'],_0x396eb5=['R'];break;}else{if(_0x5e9048==_0x1c60f1(0x201))switch(_0x598ac8){case _0x1c60f1(0x2c7):_0x47ab78=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x67e5e4=['B','F'],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=[_0x1c60f1(0x1ff),'Floor'],_0x2b2049=['C'],_0x396eb5=['A'];break;case _0x1c60f1(0x1de):_0x47ab78=[0x5,0x4,0x3,0x2,0x1],_0x67e5e4=['F','B','S'],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=[_0x1c60f1(0x1ff),_0x1c60f1(0x23e)],_0x2b2049=['C'],_0x396eb5=['B'];break;case _0x1c60f1(0x287):_0x47ab78=[0x1,0x2,0x3,0x4,0x5],_0x67e5e4=['B','F','S'],_0x2a6fa6=[0x5,0x4,0x3,0x2,0x1],_0x3778b4=['Level',_0x1c60f1(0x23e)],_0x2b2049=['C'],_0x396eb5=['C'];break;case _0x1c60f1(0x25a):_0x47ab78=[0x5,0x4,0x3,0x2,0x1],_0x67e5e4=['F','B','S'],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=['Level',_0x1c60f1(0x23e)],_0x2b2049=['C'],_0x396eb5=['D'];break;case _0x1c60f1(0x24a):_0x47ab78=[0x4,0x3,0x2,0x1],_0x67e5e4=[0x1,0x2],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=[_0x1c60f1(0x1ff),'Floor'],_0x2b2049=['C'],_0x396eb5=['E'];break;case _0x1c60f1(0x1fb):_0x47ab78=[0x1,0x2,0x3],_0x67e5e4=[0x1,0x2],_0x2a6fa6=[0x1,0x2,0x3,0x4,0x5],_0x3778b4=[_0x1c60f1(0x1ff)],_0x2b2049=['C'],_0x396eb5=['F'];break;}}return{'levels':_0x47ab78,'Isle':_0x67e5e4,'rack':_0x2a6fa6,'type':_0x3778b4,'storage':_0x2b2049,'rak':_0x396eb5};}router[a0_0x342c66(0x214)](a0_0x342c66(0x221),auth,async(_0x43cc5c,_0x66a265)=>{var _0x12f4f3=a0_0x342c66;try{const {username:_0x18b151,email:_0x4ce118,role:_0x2ef044}=_0x43cc5c[_0x12f4f3(0x297)],_0xc406aa=_0x43cc5c['user'],_0x189c5b=await profile[_0x12f4f3(0x241)]({'email':_0xc406aa[_0x12f4f3(0x2a8)]}),_0x55787f=await master_shop['find'](),_0x25c6f5=await transfers[_0x12f4f3(0x23d)](_0x43cc5c[_0x12f4f3(0x28d)]['id']);let _0x397ed7;if(_0xc406aa['role']==_0x12f4f3(0x22f)){const _0x5a2bdd=await staff[_0x12f4f3(0x241)]({'email':_0xc406aa[_0x12f4f3(0x2a8)]});_0x397ed7=await warehouse[_0x12f4f3(0x26e)]([{'$match':{'status':_0x12f4f3(0x227),'name':_0x5a2bdd[_0x12f4f3(0x2a7)],'warehouse_category':_0x12f4f3(0x2b1)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x397ed7=await warehouse[_0x12f4f3(0x26e)]([{'$match':{'status':_0x12f4f3(0x227),'warehouse_category':_0x12f4f3(0x2b1)}},{'$group':{'_id':_0x12f4f3(0x29d),'name':{'$first':_0x12f4f3(0x29d)}}}]);const _0x75e0df=await warehouse['aggregate']([{'$match':{'name':_0x25c6f5[_0x12f4f3(0x1ee)],'warehouse_category':_0x12f4f3(0x2b1)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x12f4f3(0x242),'name':{'$first':_0x12f4f3(0x229)},'product_stock':{'$first':_0x12f4f3(0x217)},'bay':{'$first':_0x12f4f3(0x274)},'bin':{'$first':_0x12f4f3(0x261)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x12f4f3(0x2c3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x12f4f3(0x243)},'product_code':{'$first':_0x12f4f3(0x260)},'storage':{'$first':_0x12f4f3(0x294)},'rack':{'$first':_0x12f4f3(0x269)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x12f4f3(0x1e5)}}}]),_0x1f6a05=await product[_0x12f4f3(0x2a6)]({}),_0x384c99=BayBinSelected(_0x25c6f5['to_warehouse'],_0x25c6f5[_0x12f4f3(0x219)]);if(_0x55787f[0x0][_0x12f4f3(0x1e7)]==_0x12f4f3(0x255)){var _0x2aef32=users['English'];console[_0x12f4f3(0x2a5)](_0x2aef32);}else{if(_0x55787f[0x0][_0x12f4f3(0x1e7)]==_0x12f4f3(0x25c))var _0x2aef32=users[_0x12f4f3(0x25c)];else{if(_0x55787f[0x0][_0x12f4f3(0x1e7)]=='German')var _0x2aef32=users[_0x12f4f3(0x209)];else{if(_0x55787f[0x0][_0x12f4f3(0x1e7)]=='Spanish')var _0x2aef32=users[_0x12f4f3(0x2cc)];else{if(_0x55787f[0x0][_0x12f4f3(0x1e7)]==_0x12f4f3(0x220))var _0x2aef32=users[_0x12f4f3(0x220)];else{if(_0x55787f[0x0][_0x12f4f3(0x1e7)]==_0x12f4f3(0x270))var _0x2aef32=users[_0x12f4f3(0x1ec)];else{if(_0x55787f[0x0][_0x12f4f3(0x1e7)]==_0x12f4f3(0x26b))var _0x2aef32=users[_0x12f4f3(0x26b)];else{if(_0x55787f[0x0][_0x12f4f3(0x1e7)]==_0x12f4f3(0x25f))var _0x2aef32=users['Arabic'];}}}}}}}_0x66a265['render'](_0x12f4f3(0x1dc),{'success':_0x43cc5c[_0x12f4f3(0x28b)](_0x12f4f3(0x29a)),'errors':_0x43cc5c[_0x12f4f3(0x28b)](_0x12f4f3(0x273)),'role':_0xc406aa,'profile':_0x189c5b,'master_shop':_0x55787f,'warehouse':_0x397ed7,'transfer':_0x25c6f5,'stock':_0x75e0df,'unit':_0x1f6a05,'language':_0x2aef32});}catch(_0x321a9e){console[_0x12f4f3(0x2a5)](_0x321a9e);}}),router[a0_0x342c66(0x21c)](a0_0x342c66(0x221),auth,async(_0x451549,_0x18eefc)=>{var _0x1f5058=a0_0x342c66;try{const _0x5d37d1=_0x451549[_0x1f5058(0x28d)]['id'],_0x248f8e=await transfers[_0x1f5058(0x23d)](_0x5d37d1);_0x18eefc[_0x1f5058(0x234)](_0x451549[_0x1f5058(0x282)]);return;const {date:_0x2d9c3d,from_warehouse:_0x508979,FromRoom_name:_0x15bf1a,to_warehouse:_0x4b73a7,ToRoom_name:_0x36b0a0,prod_name:_0x539d7f,from_prod_qty:_0x150ea7,from_prod_level:_0x5a6397,from_prod_isle:_0x471ff2,from_prod_pallet:_0x4384f0,to_prod_qty:_0x41b08b,to_prod_level:_0x4b11b1,to_prod_isle:_0x1ed73b,to_prod_pallet:_0x59ecfd,primary_code:_0x35b5c7,secondary_code:_0x5b5ee0,product_code3:_0x5e8db8,note:_0x518eb8,invoice:_0x357814,expiry_date:_0x44392d}=_0x451549[_0x1f5058(0x282)];if(typeof _0x539d7f=='string')var _0x262566=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x248)]],_0x2b492f=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x23b)]],_0x188f7f=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x2cd)]],_0x5d423e=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x20e)]],_0x3d82ca=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x272)]],_0x634d6e=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x200)]],_0x15da8a=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x1eb)]],_0x68b6d5=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x2ce)]],_0xb6e689=[_0x451549['body']['to_prod_isle']],_0x3475a2=[_0x451549['body'][_0x1f5058(0x2c2)]],_0x329c3f=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x1fd)]],_0x56cfb0=[_0x451549['body'][_0x1f5058(0x233)]],_0x502525=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x2b0)]],_0xf70ca7=[_0x451549[_0x1f5058(0x282)]['primary_code']],_0x4720d6=[_0x451549['body'][_0x1f5058(0x28c)]],_0x5b41e4=[_0x451549['body'][_0x1f5058(0x1e6)]],_0x2b7b4d=[_0x451549[_0x1f5058(0x282)]['MaxStocks_data2']],_0x170088=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x278)]],_0x1dadf1=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x222)]],_0x4a47a1=[_0x451549[_0x1f5058(0x282)]['batch_code']],_0x322557=[_0x451549[_0x1f5058(0x282)][_0x1f5058(0x289)]],_0x2b9ae8=[_0x451549['body'][_0x1f5058(0x1f7)]],_0x4b037d=[_0x451549[_0x1f5058(0x282)]['from_rak']];else var _0x262566=[..._0x451549[_0x1f5058(0x282)]['prod_name']],_0x56cfb0=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x233)]],_0x502525=[..._0x451549['body']['rak']],_0x634d6e=[..._0x451549['body'][_0x1f5058(0x200)]],_0x329c3f=[..._0x451549[_0x1f5058(0x282)]['to_types']],_0x2b492f=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x23b)]],_0x188f7f=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x2cd)]],_0x5d423e=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x20e)]],_0x3d82ca=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x272)]],_0x15da8a=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x1eb)]],_0x68b6d5=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x2ce)]],_0xb6e689=[..._0x451549[_0x1f5058(0x282)]['to_prod_isle']],_0x3475a2=[..._0x451549['body'][_0x1f5058(0x2c2)]],_0xf70ca7=[..._0x451549[_0x1f5058(0x282)]['primary_code']],_0x4720d6=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x28c)]],_0x5b41e4=[..._0x451549['body'][_0x1f5058(0x1e6)]],_0x2b7b4d=[..._0x451549[_0x1f5058(0x282)]['MaxStocks_data2']],_0x170088=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x278)]],_0x1dadf1=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x222)]],_0x4a47a1=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x1e0)]],_0x322557=[..._0x451549['body'][_0x1f5058(0x289)]],_0x2b9ae8=[..._0x451549[_0x1f5058(0x282)][_0x1f5058(0x1f7)]],_0x4b037d=[..._0x451549['body']['from_rak']];const _0x3cf50c=_0x262566[_0x1f5058(0x254)](_0x4781a2=>{return _0x4781a2={'product_name':_0x4781a2};});_0x2b492f[_0x1f5058(0x280)]((_0x30b38c,_0x4b9921)=>{var _0x1b06bf=_0x1f5058;_0x3cf50c[_0x4b9921][_0x1b06bf(0x1df)]=_0x30b38c;}),_0x188f7f['forEach']((_0x5cd26,_0x5c81b6)=>{var _0x1c1005=_0x1f5058;_0x3cf50c[_0x5c81b6][_0x1c1005(0x267)]=_0x5cd26;}),_0x5d423e['forEach']((_0x58a5b6,_0x221460)=>{var _0x528151=_0x1f5058;_0x3cf50c[_0x221460][_0x528151(0x264)]=_0x58a5b6;}),_0x3d82ca[_0x1f5058(0x280)]((_0x1db7de,_0x510194)=>{var _0x4b9d9c=_0x1f5058;_0x3cf50c[_0x510194][_0x4b9d9c(0x2c8)]=_0x1db7de;}),_0x15da8a[_0x1f5058(0x280)]((_0x735582,_0x2964f5)=>{var _0x35f89a=_0x1f5058;_0x3cf50c[_0x2964f5][_0x35f89a(0x265)]=_0x735582;}),_0x68b6d5[_0x1f5058(0x280)]((_0x5b2ee0,_0x223dac)=>{_0x3cf50c[_0x223dac]['to_bay']=_0x5b2ee0;}),_0xb6e689[_0x1f5058(0x280)]((_0x31712a,_0x5ac41d)=>{_0x3cf50c[_0x5ac41d]['to_bin']=_0x31712a;}),_0x3475a2[_0x1f5058(0x280)]((_0x63e8fb,_0x2c7dd8)=>{_0x3cf50c[_0x2c7dd8]['to_floorlevel']=_0x63e8fb;}),_0xf70ca7[_0x1f5058(0x280)]((_0x59b6c5,_0x1c8899)=>{var _0x421d89=_0x1f5058;_0x3cf50c[_0x1c8899][_0x421d89(0x1dd)]=_0x59b6c5;}),_0x4720d6['forEach']((_0x4766c7,_0x4659d1)=>{var _0x28b499=_0x1f5058;_0x3cf50c[_0x4659d1][_0x28b499(0x28c)]=_0x4766c7;}),_0x5b41e4['forEach']((_0x27dbc3,_0x329f38)=>{var _0xdf4dab=_0x1f5058;_0x3cf50c[_0x329f38][_0xdf4dab(0x29f)]=_0x27dbc3;}),_0x2b7b4d[_0x1f5058(0x280)]((_0x27554c,_0x41b80a)=>{var _0xf6cb76=_0x1f5058;_0x3cf50c[_0x41b80a][_0xf6cb76(0x1ed)]=_0x27554c;}),_0x170088[_0x1f5058(0x280)]((_0x1b3837,_0x40da0c)=>{var _0x51e66c=_0x1f5058;_0x3cf50c[_0x40da0c][_0x51e66c(0x278)]=_0x1b3837;}),_0x1dadf1['forEach']((_0x1a92fe,_0x2d29ee)=>{var _0x2d4de6=_0x1f5058;_0x3cf50c[_0x2d29ee][_0x2d4de6(0x222)]=_0x1a92fe;}),_0x4a47a1['forEach']((_0x366a6f,_0x5e2ac8)=>{_0x3cf50c[_0x5e2ac8]['batch_code']=_0x366a6f;}),_0x322557[_0x1f5058(0x280)]((_0xe0f2e3,_0x3f3a9e)=>{var _0x3f99e0=_0x1f5058;_0x3cf50c[_0x3f3a9e][_0x3f99e0(0x289)]=_0xe0f2e3;}),_0x56cfb0[_0x1f5058(0x280)]((_0xb1e327,_0x2eb002)=>{_0x3cf50c[_0x2eb002]['storage']=_0xb1e327;}),_0x502525['forEach']((_0x3eaad7,_0x453955)=>{var _0x2e3b94=_0x1f5058;_0x3cf50c[_0x453955][_0x2e3b94(0x257)]=_0x3eaad7;}),_0x634d6e[_0x1f5058(0x280)]((_0x3be74e,_0x347253)=>{_0x3cf50c[_0x347253]['from_types']=_0x3be74e;}),_0x329c3f[_0x1f5058(0x280)]((_0x2774e0,_0x41d152)=>{var _0x2dfa76=_0x1f5058;_0x3cf50c[_0x41d152][_0x2dfa76(0x1fd)]=_0x2774e0;}),_0x2b9ae8[_0x1f5058(0x280)]((_0x72663f,_0x3edbdf)=>{var _0x7ea02=_0x1f5058;_0x3cf50c[_0x3edbdf][_0x7ea02(0x1f7)]=_0x72663f;}),_0x4b037d['forEach']((_0x1687fd,_0x240853)=>{var _0xa29d0e=_0x1f5058;_0x3cf50c[_0x240853][_0xa29d0e(0x2a3)]=_0x1687fd;});const _0x3bae7b=_0x3cf50c[_0x1f5058(0x285)](_0x2480ef=>_0x2480ef[_0x1f5058(0x265)]!=='0'&&_0x2480ef[_0x1f5058(0x265)]!==''||_0x2480ef[_0x1f5058(0x2b3)]!=='0'&&_0x2480ef[_0x1f5058(0x2b3)]!=='');var _0xae70a9=0x0;_0x3bae7b[_0x1f5058(0x280)](_0x4aede7=>{var _0x4a7116=_0x1f5058;parseInt(_0x4aede7[_0x4a7116(0x1df)])<parseInt(_0x4aede7['to_quantity'])&&_0xae70a9++;});if(_0xae70a9!=0x0)return _0x451549[_0x1f5058(0x28b)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x18eefc['redirect']('back');const _0x31fab4=await warehouse[_0x1f5058(0x241)]({'name':_0x248f8e[_0x1f5058(0x1ee)],'room':_0x248f8e[_0x1f5058(0x204)]});_0x248f8e['product']['forEach'](_0x287349=>{var _0x43675b=_0x1f5058;if(_0x287349[_0x43675b(0x265)]>0x0){const _0x3cce26=_0x31fab4[_0x43675b(0x277)][_0x43675b(0x254)](_0x43ab2a=>{var _0x4d393a=_0x43675b;_0x43ab2a[_0x4d393a(0x236)]==_0x287349[_0x4d393a(0x236)]&&_0x43ab2a['floorlevel']==_0x287349['from_floorlevel']&&_0x43ab2a[_0x4d393a(0x1f8)]==_0x287349[_0x4d393a(0x200)]&&_0x43ab2a[_0x4d393a(0x23c)]==_0x287349[_0x4d393a(0x264)]&&_0x43ab2a['bay']==_0x287349[_0x4d393a(0x267)]&&_0x43ab2a[_0x4d393a(0x257)]==_0x287349[_0x4d393a(0x2a3)]&&_0x43ab2a['storage']==_0x287349[_0x4d393a(0x1f7)]&&(_0x43ab2a[_0x4d393a(0x2bc)]=parseInt(_0x43ab2a['product_stock'])+parseInt(_0x287349[_0x4d393a(0x265)]));});}}),await _0x31fab4[_0x1f5058(0x279)]();const _0x44024d=await warehouse['findOne']({'name':_0x248f8e[_0x1f5058(0x288)],'room':_0x248f8e[_0x1f5058(0x219)]});_0x248f8e['product']['forEach'](_0x5b49b2=>{var _0x39509=_0x1f5058;if(_0x5b49b2[_0x39509(0x265)]>0x0){const _0x2f2988=_0x44024d[_0x39509(0x277)][_0x39509(0x254)](_0x35d993=>{var _0x3f19f4=_0x39509;_0x35d993[_0x3f19f4(0x236)]==_0x5b49b2[_0x3f19f4(0x236)]&&_0x35d993[_0x3f19f4(0x2c0)]==_0x5b49b2[_0x3f19f4(0x2b3)]&&_0x35d993[_0x3f19f4(0x1f8)]==_0x5b49b2[_0x3f19f4(0x1fd)]&&_0x35d993[_0x3f19f4(0x23c)]==_0x5b49b2['to_bin']&&_0x35d993[_0x3f19f4(0x256)]==_0x5b49b2[_0x3f19f4(0x235)]&&_0x35d993[_0x3f19f4(0x257)]==_0x5b49b2[_0x3f19f4(0x257)]&&_0x35d993[_0x3f19f4(0x233)]==_0x5b49b2[_0x3f19f4(0x233)]&&(_0x35d993[_0x3f19f4(0x2bc)]=parseInt(_0x35d993['product_stock'])-parseInt(_0x5b49b2[_0x3f19f4(0x265)]));});}}),await _0x44024d[_0x1f5058(0x279)](),_0x248f8e[_0x1f5058(0x202)]=_0x2d9c3d,_0x248f8e[_0x1f5058(0x1ee)]=_0x508979,_0x248f8e[_0x1f5058(0x288)]=_0x4b73a7,_0x248f8e[_0x1f5058(0x1db)]=_0x3bae7b,_0x248f8e[_0x1f5058(0x295)]=_0x518eb8,_0x248f8e[_0x1f5058(0x213)]=_0x357814;const _0x957dc0=await _0x248f8e[_0x1f5058(0x279)]();console[_0x1f5058(0x2a5)](_0x957dc0);const _0x1f1a35=await warehouse[_0x1f5058(0x241)]({'name':_0x508979,'room':_0x15bf1a});_0x957dc0[_0x1f5058(0x1db)][_0x1f5058(0x280)](_0xe4ec5d=>{var _0xd08be9=_0x1f5058;if(_0xe4ec5d['to_quantity']>0x0){const _0x17eeda=_0x1f1a35[_0xd08be9(0x277)][_0xd08be9(0x254)](_0x351afb=>{var _0x4ac9b2=_0xd08be9;_0x351afb[_0x4ac9b2(0x236)]==_0xe4ec5d[_0x4ac9b2(0x236)]&&_0x351afb[_0x4ac9b2(0x2c0)]==_0xe4ec5d['from_floorlevel']&&_0x351afb[_0x4ac9b2(0x1f8)]==_0xe4ec5d[_0x4ac9b2(0x200)]&&_0x351afb[_0x4ac9b2(0x23c)]==_0xe4ec5d['from_bin']&&_0x351afb[_0x4ac9b2(0x256)]==_0xe4ec5d[_0x4ac9b2(0x267)]&&_0x351afb[_0x4ac9b2(0x257)]==_0xe4ec5d[_0x4ac9b2(0x2a3)]&&_0x351afb[_0x4ac9b2(0x233)]==_0xe4ec5d[_0x4ac9b2(0x1f7)]&&(_0x351afb[_0x4ac9b2(0x2bc)]=parseInt(_0x351afb['product_stock'])-parseInt(_0xe4ec5d['to_quantity']));});}}),await _0x1f1a35[_0x1f5058(0x279)]();const _0x3e3fb6=await warehouse[_0x1f5058(0x241)]({'name':_0x4b73a7,'room':_0x36b0a0});_0x957dc0[_0x1f5058(0x1db)][_0x1f5058(0x280)](_0xd54dee=>{var _0x4fea60=_0x1f5058;if(_0xd54dee['to_quantity']>0x0){var _0x57af2c=0x0;const _0x1904a1=_0x3e3fb6['product_details'][_0x4fea60(0x254)](_0x5bc105=>{var _0x586e12=_0x4fea60;_0x5bc105[_0x586e12(0x236)]==_0xd54dee[_0x586e12(0x236)]&&_0x5bc105[_0x586e12(0x2c0)]==_0xd54dee[_0x586e12(0x2b3)]&&_0x5bc105[_0x586e12(0x1f8)]==_0xd54dee[_0x586e12(0x1fd)]&&_0x5bc105[_0x586e12(0x23c)]==_0xd54dee[_0x586e12(0x21e)]&&_0x5bc105[_0x586e12(0x256)]==_0xd54dee[_0x586e12(0x235)]&&_0x5bc105['rack']==_0xd54dee['rack']&&_0x5bc105[_0x586e12(0x233)]==_0xd54dee[_0x586e12(0x233)]&&(_0x5bc105['product_stock']=parseInt(_0x5bc105['product_stock'])+parseInt(_0xd54dee[_0x586e12(0x265)]),_0x57af2c++);});_0x57af2c=='0'&&(_0x3e3fb6['product_details']=_0x3e3fb6['product_details'][_0x4fea60(0x2cf)]({'product_name':_0xd54dee[_0x4fea60(0x236)],'product_stock':_0xd54dee['to_quantity'],'bay':_0xd54dee[_0x4fea60(0x235)],'bin':_0xd54dee[_0x4fea60(0x21e)],'type':_0xd54dee[_0x4fea60(0x1fd)],'floorlevel':_0xd54dee[_0x4fea60(0x2b3)],'storage':_0xd54dee['storage'],'rack':_0xd54dee[_0x4fea60(0x257)],'product_code':_0xd54dee['product_code'],'primary_code':_0xd54dee[_0x4fea60(0x1dd)],'secondary_code':_0xd54dee[_0x4fea60(0x28c)],'maxProducts':_0xd54dee[_0x4fea60(0x1ed)],'storage':_0xd54dee[_0x4fea60(0x233)],'rack':_0xd54dee[_0x4fea60(0x257)]}));}}),await _0x3e3fb6[_0x1f5058(0x279)](),_0x451549[_0x1f5058(0x28b)](_0x1f5058(0x29a),_0x1f5058(0x252)),_0x18eefc[_0x1f5058(0x2a2)]('/transfer/view');}catch(_0xd682a){console[_0x1f5058(0x2a5)](_0xd682a);}}),router[a0_0x342c66(0x21c)](a0_0x342c66(0x27a),async(_0x36ebc7,_0x576070)=>{var _0x4ad20b=a0_0x342c66;const {FromWareHouse:_0xfdfa25,FromRoom:_0x5b9671,ToWarehouse:_0x1ee65b,ToRoom:_0x532425,primary_code:_0x3f61bd,Roomslist:_0x2b0498}=_0x36ebc7['body'],_0x237d83=_0x2b0498[_0x4ad20b(0x26a)](','),_0x25d2d4=[];async function _0x7e7779(_0x3742b3){var _0x199fcd=_0x4ad20b;const _0x46245f=await warehouse[_0x199fcd(0x26e)]([{'$match':{'name':_0xfdfa25,'room':_0x3742b3}},{'$unwind':_0x199fcd(0x2ae)},{'$match':{'product_details.primary_code':_0x3f61bd}},{'$group':{'_id':_0x199fcd(0x242),'name':{'$first':_0x199fcd(0x229)},'instock':{'$first':_0x199fcd(0x217)},'primary_code':{'$first':_0x199fcd(0x1f2)},'secondary_code':{'$first':_0x199fcd(0x243)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x199fcd(0x261)},'type':{'$first':_0x199fcd(0x239)},'pallet':{'$first':_0x199fcd(0x2c3)},'unit':{'$first':_0x199fcd(0x2ca)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x199fcd(0x294)},'rack':{'$first':_0x199fcd(0x269)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x199fcd(0x284)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x199fcd(0x1e5)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]),_0x4c69f1=await warehouse[_0x199fcd(0x26e)]([{'$match':{'name':_0xfdfa25,'room':_0x3742b3}},{'$unwind':_0x199fcd(0x2ae)},{'$match':{'product_details.secondary_code':_0x3f61bd}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x199fcd(0x1f2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x199fcd(0x260)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x199fcd(0x2c3)},'unit':{'$first':_0x199fcd(0x2ca)},'secondary_unit':{'$first':_0x199fcd(0x258)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x199fcd(0x269)},'expiry_date':{'$first':_0x199fcd(0x212)},'production_date':{'$first':_0x199fcd(0x284)},'batch_code':{'$first':_0x199fcd(0x2a4)},'maxPerUnit':{'$first':_0x199fcd(0x216)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x199fcd(0x1e5)},'maxProducts':{'$first':_0x199fcd(0x1f9)}}}]);if(_0x46245f[_0x199fcd(0x1f3)]>0x0)_0x25d2d4['push'](_0x46245f);else _0x4c69f1[_0x199fcd(0x1f3)]>0x0&&_0x25d2d4[_0x199fcd(0x20f)](_0x4c69f1);}const _0x58970f=_0x237d83[_0x4ad20b(0x254)](_0x1653f3=>_0x7e7779(_0x1653f3));await Promise[_0x4ad20b(0x249)](_0x58970f),_0x576070[_0x4ad20b(0x234)](_0x25d2d4);}),router[a0_0x342c66(0x21c)](a0_0x342c66(0x2c4),async(_0x4e9c0f,_0x2b7436)=>{var _0x27b017=a0_0x342c66;try{const {FromWareHouse:_0x35dbd3,FromRoom:_0x3b4cd7,ToWarehouse:_0x20a69d,ToRoom:_0x33b357,secondary_code:_0x388af4}=_0x4e9c0f['body'],_0x1fec8a=await warehouse[_0x27b017(0x26e)]([{'$match':{'name':_0x35dbd3}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x388af4}},{'$group':{'_id':_0x27b017(0x242),'name':{'$first':_0x27b017(0x229)},'primary_code':{'$first':_0x27b017(0x1f2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x27b017(0x260)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x27b017(0x29d)},'level':{'$first':_0x27b017(0x25e)},'isle':{'$first':_0x27b017(0x1d9)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x27b017(0x1f9)},'unit':{'$first':_0x27b017(0x2ca)}}}]);_0x2b7436[_0x27b017(0x21b)](0xc8)[_0x27b017(0x234)](_0x1fec8a);}catch(_0x63961e){_0x2b7436['status'](0x194)['json']({'message':_0x63961e[_0x27b017(0x225)]});}}),router[a0_0x342c66(0x21c)](a0_0x342c66(0x2a1),async(_0x4aa900,_0x24bb41)=>{var _0x3bed3c=a0_0x342c66;try{const {FromWareHouse:_0x1fc1e3,FromRoom:_0x1ed17a,ToWarehouse:_0x2a1c13,ToRoom:_0x4dbfd2,product_code:_0x5a2ad3}=_0x4aa900[_0x3bed3c(0x282)],_0x48eedb=await warehouse[_0x3bed3c(0x26e)]([{'$match':{'name':_0x1fc1e3}},{'$unwind':_0x3bed3c(0x2ae)},{'$match':{'product_details.product_code':_0x5a2ad3}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3bed3c(0x229)},'primary_code':{'$first':_0x3bed3c(0x1f2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3bed3c(0x260)},'instock':{'$first':_0x3bed3c(0x217)},'warehouse':{'$first':_0x3bed3c(0x29d)},'level':{'$first':_0x3bed3c(0x25e)},'isle':{'$first':_0x3bed3c(0x1d9)},'pallet':{'$first':_0x3bed3c(0x298)},'maxProducts':{'$first':_0x3bed3c(0x1f9)},'unit':{'$first':_0x3bed3c(0x2ca)}}}]);_0x24bb41[_0x3bed3c(0x21b)](0xc8)[_0x3bed3c(0x234)](_0x48eedb);}catch(_0x2f34e3){_0x24bb41[_0x3bed3c(0x21b)](0x194)[_0x3bed3c(0x234)]({'message':_0x2f34e3[_0x3bed3c(0x225)]});}}),router[a0_0x342c66(0x21c)]('/CheckingWarehouse',async(_0x3f7935,_0x55f4f4)=>{var _0x45a71b=a0_0x342c66;const {level:_0x4e34b2,isle:_0x4686b2,pallet:_0x3fd937,warehouses:_0x1560ed,room:_0x38f1a1}=_0x3f7935[_0x45a71b(0x282)];try{const _0xce0c8=await warehouse['aggregate']([{'$match':{'name':_0x1560ed,'room':_0x38f1a1}},{'$unwind':_0x45a71b(0x2ae)},{'$match':{'product_details.level':parseInt(_0x4e34b2),'product_details.isle':_0x4686b2,'product_details.pallet':parseInt(_0x3fd937)}},{'$group':{'_id':_0x45a71b(0x242),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x45a71b(0x25e)},'isle':{'$first':_0x45a71b(0x1d9)},'pallet':{'$first':_0x45a71b(0x298)},'maxProducts':{'$first':_0x45a71b(0x1f9)}}}]);_0x55f4f4[_0x45a71b(0x21b)](0xc8)[_0x45a71b(0x234)](_0xce0c8);}catch(_0x411fe9){_0x55f4f4[_0x45a71b(0x21b)](0x194)[_0x45a71b(0x234)]({'message':_0x411fe9[_0x45a71b(0x225)]});}}),module['exports']=router;