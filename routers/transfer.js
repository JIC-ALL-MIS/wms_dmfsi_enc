var a0_0x449360=a0_0x1a17;(function(_0x1ffa6b,_0x4dbe96){var _0x2fc765=a0_0x1a17,_0x4ccbf5=_0x1ffa6b();while(!![]){try{var _0x531afb=-parseInt(_0x2fc765(0x1bc))/0x1+parseInt(_0x2fc765(0x240))/0x2+-parseInt(_0x2fc765(0x286))/0x3*(parseInt(_0x2fc765(0x1c1))/0x4)+parseInt(_0x2fc765(0x267))/0x5*(parseInt(_0x2fc765(0x1f0))/0x6)+parseInt(_0x2fc765(0x1bd))/0x7+-parseInt(_0x2fc765(0x288))/0x8+-parseInt(_0x2fc765(0x1aa))/0x9;if(_0x531afb===_0x4dbe96)break;else _0x4ccbf5['push'](_0x4ccbf5['shift']());}catch(_0x506a4c){_0x4ccbf5['push'](_0x4ccbf5['shift']());}}}(a0_0x5ad8,0xb5fa8));function a0_0x5ad8(){var _0x16da35=['to_bay','Rack\x20E','</table>','product_stock','from_warehouse','An\x20error\x20occurred\x20while\x20saving\x20data.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','ToRoomAssigned','email','</td>','Email\x20sent\x20successfully','Raw\x20Materials','$isAllowEdit','Spanish','Transfer\x20Edit\x20Successfully','from_rack','concat','Level','Logo.png','maxProducts','$product_details','1916472qHeXPZ','warehouse','then','product_code','</div>','</tr>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','save','Arabic\x20(ae)','Return\x20Rooms','$product_details.unit','exports','$product_details.invoice','from_prod_qty','type','$to_warehouse','from_prod_isle','$product_details.isle','$product_details.bay','$product_details.product_stock','$product_details.product_code','Shelves','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product.from_room_name','<table\x20style=\x22width:\x20100%\x20!important;\x22>','from_types','to_prod_level','role','True','Product\x20Transfer\x20successfully','Transfer\x20Mail','length','English','TRF-','German','log','transfer','add_transfer','3592330TSipIo','user','Enabled','max_per_unit','product_code3','json','$product_details.bin','Rack\x20F','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','id_transaction_id','logo','Chinese','Rack\x20D','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Rack\x20C','from_quantity','product_name','findById','$product_details.storage','$name','to_prod_pallet','../middleware/auth','secondary_unit','/view/add_transfer','status','$product_details.type','/CheckingWarehouse','Router','RoomAssigned','forEach','100281uYUefh','<hr\x20class=\x22my-3\x22>','8224696HACAsA','storage','params','production_date','To_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.maxProducts','to_room','from_bay','to_quantity','$product_details.maxPerUnit','date','batch_code','/view','from_room','staff','rack','product','password','slice','Receiving\x20Area','114021wNsGLH','rak','id_transaction','New_Qty_Converted','errors','finalize','\x20<>\x20','from_room_name','$product_details.pallet','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','catch','/barcode_scanner2','<div>','$product_details.secondary_code','$from_warehouse','$product','maxperunit','aggregate','440728RRPGwP','225834sgPEDw','MaxStocks_data2','$product_details.level','filter','24ZNHUVH','edit_transfer_view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','invoice','$product_details._id','message','from_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/picking_list/PDF_transfer_rm/','to_invoice','/preview/:id','to_prod_qty','$invoice','to_warehouse','bay','note','$product.to_room_name','$product_details.expiry_date','\x20</h2>','from_prod_level','$product_details.batch_code','error','<tr>','to_prod_isle','flash','$product_details.production_date','getDate','to_room_name','Rack\x20A','image','Floor','\x20Order\x20Number\x20:\x20','$product_details.rack','map','from_floorlevel','split','success','DRY\x20STORAGE','<h5>','port','/transfer/preview/','from_prod_pallet','../models/all_models','Arabic','/view/:id','get','$room','12YZFlaT','\x20Order\x20Date\x20:\x20','/barcode_scanner','Error\x20Occurs','<tbody\x20style=\x22text-align:\x20center;\x22>','Rack\x20B','Portuguese\x20(BR)','site_title','language','floorlevel','find','</body></html>','to_types','English\x20(US)','Portuguese','body','to_floorlevel','render','findOne','prod_cat','from_rak','French','Transfer\x20Finalize\x20Successfully','_id','COLD\x20STORAGE','host','/barcode_scanner3','</thead>','here','createTransport','<!DOCTYPE\x20html>','<span\x20style=\x22float:\x20right;\x22>','primary_code','prod_name','secondary_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Hindi','$_id','post','$product_details.primary_code','all','$product_details.secondary_unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_storage','</h5>','unit','/transfer/view','bin','from_bin','string','<html><head><title></title>','master','product_details','RMSEmail','to_bin','$product_details.product_name','redirect','primary_unit','$product_details.floorlevel'];a0_0x5ad8=function(){return _0x16da35;};return a0_0x5ad8();}const express=require('express'),app=express(),router=express[a0_0x449360(0x283)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x449360(0x1eb)),auth=require(a0_0x449360(0x27d)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x449360(0x1ee)](a0_0x449360(0x295),auth,async(_0x557507,_0x5ec68e)=>{var _0x15230b=a0_0x449360;try{const {username:_0x24aa1a,email:_0x1fb7e3,role:_0x42dda4}=_0x557507['user'],_0x12b007=_0x557507[_0x15230b(0x268)],_0x3156a6=await profile[_0x15230b(0x202)]({'email':_0x12b007[_0x15230b(0x233)]}),_0x322524=await master_shop[_0x15230b(0x1fa)]();console[_0x15230b(0x264)](_0x15230b(0x223),_0x322524);let _0x32b3a5;if(_0x12b007[_0x15230b(0x25c)]=='staff'){const _0x2e2ae4=await staff['findOne']({'email':_0x12b007[_0x15230b(0x233)]});_0x32b3a5=await transfers[_0x15230b(0x1fa)]({'from_warehouse':_0x2e2ae4[_0x15230b(0x241)]});}else _0x32b3a5=await transfers['aggregate']([{'$unwind':_0x15230b(0x1b9)},{'$group':{'_id':_0x15230b(0x215),'invoice':{'$first':_0x15230b(0x1cd)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x15230b(0x1b8)},'to_warehouse':{'$first':_0x15230b(0x24f)},'from_room_name':{'$addToSet':_0x15230b(0x258)},'to_room_name':{'$addToSet':_0x15230b(0x1d1)},'finalize':{'$first':_0x15230b(0x256)},'isAllowEdit':{'$first':_0x15230b(0x237)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x322524[0x0]['language']==_0x15230b(0x1fd)){var _0x32f20e=users[_0x15230b(0x261)];console[_0x15230b(0x264)](_0x32f20e);}else{if(_0x322524[0x0][_0x15230b(0x1f8)]=='Hindi')var _0x32f20e=users[_0x15230b(0x214)];else{if(_0x322524[0x0][_0x15230b(0x1f8)]==_0x15230b(0x263))var _0x32f20e=users[_0x15230b(0x263)];else{if(_0x322524[0x0][_0x15230b(0x1f8)]==_0x15230b(0x238))var _0x32f20e=users[_0x15230b(0x238)];else{if(_0x322524[0x0]['language']==_0x15230b(0x205))var _0x32f20e=users[_0x15230b(0x205)];else{if(_0x322524[0x0]['language']==_0x15230b(0x1f6))var _0x32f20e=users[_0x15230b(0x1fe)];else{if(_0x322524[0x0][_0x15230b(0x1f8)]==_0x15230b(0x273))var _0x32f20e=users[_0x15230b(0x273)];else{if(_0x322524[0x0][_0x15230b(0x1f8)]==_0x15230b(0x248))var _0x32f20e=users[_0x15230b(0x1ec)];}}}}}}}_0x5ec68e[_0x15230b(0x201)](_0x15230b(0x265),{'success':_0x557507['flash'](_0x15230b(0x1e5)),'errors':_0x557507[_0x15230b(0x1d9)]('errors'),'role':_0x12b007,'profile':_0x3156a6,'master_shop':_0x322524,'transfer':_0x32b3a5,'language':_0x32f20e});}catch(_0x334059){console[_0x15230b(0x264)](_0x334059);}});async function getRandom8DigitNumber(){var _0x15fa8d=a0_0x449360;const _0x1896f1=0x989680,_0x4b4d57=0x5f5e0ff,_0x381d8e=Math['floor'](Math['random']()*(_0x4b4d57-_0x1896f1+0x1))+_0x1896f1;var _0x45f80a;const _0x4efaac=await transfers[_0x15fa8d(0x202)]({'invoice':_0x15fa8d(0x262)+_0x381d8e});return _0x4efaac&&_0x4efaac[_0x15fa8d(0x260)]>0x0?_0x45f80a=_0x15fa8d(0x262)+_0x381d8e:_0x45f80a=_0x15fa8d(0x262)+_0x381d8e,_0x45f80a;}router[a0_0x449360(0x1ee)](a0_0x449360(0x27f),auth,async(_0x37e2f6,_0x48ec8c)=>{var _0x33a6da=a0_0x449360;try{const {username:_0x11ccd3,email:_0x4fb8dd,role:_0x1feef8}=_0x37e2f6['user'],_0x58c80c=_0x37e2f6['user'],_0x31f18b=await profile[_0x33a6da(0x202)]({'email':_0x58c80c[_0x33a6da(0x233)]}),_0x3b9802=await master_shop[_0x33a6da(0x1fa)]();console[_0x33a6da(0x264)](_0x33a6da(0x223),_0x3b9802);let _0x197d8d;if(_0x58c80c['role']==_0x33a6da(0x1a4)){const _0xae98dd=await staff[_0x33a6da(0x202)]({'email':_0x58c80c[_0x33a6da(0x233)]});_0x197d8d=await warehouse[_0x33a6da(0x1bb)]([{'$match':{'status':'Enabled','name':_0xae98dd[_0x33a6da(0x241)],'warehouse_category':_0x33a6da(0x236)}},{'$group':{'_id':_0x33a6da(0x27b),'name':{'$first':_0x33a6da(0x27b)}}}]);}else _0x197d8d=await warehouse[_0x33a6da(0x1bb)]([{'$match':{'status':_0x33a6da(0x269),'warehouse_category':_0x33a6da(0x236)}},{'$group':{'_id':_0x33a6da(0x27b),'name':{'$first':_0x33a6da(0x27b)}}}]);var _0x45b9d4=['Ambient','Enclosed',_0x33a6da(0x249)];const _0x436b0a=await transfers['find']({}),_0x4776c1=_0x436b0a['length']+0x1,_0x1b9ddb=_0x33a6da(0x262)+_0x4776c1['toString']()['padStart'](0x5,'0');if(_0x3b9802[0x0][_0x33a6da(0x1f8)]==_0x33a6da(0x1fd)){var _0x20e208=users[_0x33a6da(0x261)];console[_0x33a6da(0x264)](_0x20e208);}else{if(_0x3b9802[0x0][_0x33a6da(0x1f8)]==_0x33a6da(0x214))var _0x20e208=users['Hindi'];else{if(_0x3b9802[0x0]['language']==_0x33a6da(0x263))var _0x20e208=users[_0x33a6da(0x263)];else{if(_0x3b9802[0x0]['language']==_0x33a6da(0x238))var _0x20e208=users[_0x33a6da(0x238)];else{if(_0x3b9802[0x0][_0x33a6da(0x1f8)]==_0x33a6da(0x205))var _0x20e208=users['French'];else{if(_0x3b9802[0x0][_0x33a6da(0x1f8)]==_0x33a6da(0x1f6))var _0x20e208=users[_0x33a6da(0x1fe)];else{if(_0x3b9802[0x0][_0x33a6da(0x1f8)]==_0x33a6da(0x273))var _0x20e208=users[_0x33a6da(0x273)];else{if(_0x3b9802[0x0][_0x33a6da(0x1f8)]==_0x33a6da(0x248))var _0x20e208=users['Arabic'];}}}}}}}const _0x1665ab=getRandom8DigitNumber();_0x1665ab[_0x33a6da(0x242)](_0x3f8e5a=>{var _0x3a544f=_0x33a6da;_0x48ec8c[_0x3a544f(0x201)](_0x3a544f(0x266),{'success':_0x37e2f6[_0x3a544f(0x1d9)](_0x3a544f(0x1e5)),'errors':_0x37e2f6[_0x3a544f(0x1d9)](_0x3a544f(0x1ae)),'role':_0x58c80c,'profile':_0x31f18b,'master_shop':_0x3b9802,'warehouse':_0x197d8d,'language':_0x20e208,'rooms_data':_0x45b9d4,'invoice':_0x3f8e5a});})[_0x33a6da(0x1b4)](_0xcbc16a=>{var _0x1d9e51=_0x33a6da;_0x37e2f6['flash']('errors',_0x1d9e51(0x21a)),_0x48ec8c['redirect'](_0x1d9e51(0x21e));});}catch(_0x22fbcd){console['log'](_0x22fbcd);}}),router['post'](a0_0x449360(0x27f),auth,async(_0x3dc1dd,_0xe89788)=>{var _0x362ec8=a0_0x449360;try{console[_0x362ec8(0x264)](_0x3dc1dd[_0x362ec8(0x1ff)]);const {date:_0x49ab0c,from_warehouse:_0xf9aad1,FromRoom_name:_0x40c022,to_warehouse:_0x36d669,ToRoom_name:_0xbae95a,prod_name:_0x5d66a0,from_prod_qty:_0x31b2ef,from_prod_level:_0x1de714,from_prod_isle:_0x92c3d2,from_prod_pallet:_0x19f886,to_prod_qty:_0x55863e,to_prod_level:_0x440c6f,to_prod_isle:_0x1b9f61,to_prod_pallet:_0x4ee41a,primary_code:_0x35b737,secondary_code:_0x487cb9,product_code3:_0x5e41d6,note:_0x258a45,MaxStocks_data2:_0x25a864,invoice:_0x2f646c,expiry_date:_0x44d876}=_0x3dc1dd['body'];if(typeof _0x5d66a0==_0x362ec8(0x221))var _0x51f600=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x211)]],_0x357c4e=[_0x3dc1dd[_0x362ec8(0x1ff)]['from_prod_qty']],_0x5072fe=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x1d4)]],_0x5b660e=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x1ad)]],_0x46ab20=[_0x3dc1dd['body'][_0x362ec8(0x25b)]],_0x2c42a2=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x210)]],_0x5dd31e=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x212)]],_0x4692d9=[_0x3dc1dd[_0x362ec8(0x1ff)]['product_code3']],_0x4618fd=[_0x3dc1dd['body'][_0x362ec8(0x1be)]],_0x16e17f=[_0x3dc1dd['body']['primary_unit']],_0x2e46de=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x27e)]],_0xdd9f34=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x294)]],_0x32744d=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x26f)]],_0x1200ab=[_0x3dc1dd[_0x362ec8(0x1ff)]['max_per_unit']],_0x38d04b=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x28b)]],_0x4ebe23=[_0x3dc1dd[_0x362ec8(0x1ff)]['prod_cat']],_0x3ee463=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x284)]],_0x1c49db=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x232)]],_0x40eb54=[_0x3dc1dd['body'][_0x362ec8(0x1c7)]],_0x196b96=[_0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x1ca)]],_0xc5a79=[_0x3dc1dd['body']['id_transaction']];else var _0x51f600=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x211)]],_0x357c4e=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x24d)]],_0x5072fe=[..._0x3dc1dd[_0x362ec8(0x1ff)]['from_prod_level']],_0x5b660e=[..._0x3dc1dd[_0x362ec8(0x1ff)]['New_Qty_Converted']],_0x46ab20=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x25b)]],_0x2c42a2=[..._0x3dc1dd[_0x362ec8(0x1ff)]['primary_code']],_0x5dd31e=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x212)]],_0x4692d9=[..._0x3dc1dd['body'][_0x362ec8(0x26b)]],_0x4618fd=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x1be)]],_0x16e17f=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x229)]],_0x2e46de=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x27e)]],_0xdd9f34=[..._0x3dc1dd['body'][_0x362ec8(0x294)]],_0x32744d=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x26f)]],_0x1200ab=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x26a)]],_0x38d04b=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x28b)]],_0x4ebe23=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x203)]],_0x3ee463=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x284)]],_0x1c49db=[..._0x3dc1dd[_0x362ec8(0x1ff)]['ToRoomAssigned']],_0x40eb54=[..._0x3dc1dd['body'][_0x362ec8(0x1c7)]],_0x196b96=[..._0x3dc1dd['body'][_0x362ec8(0x1ca)]],_0xc5a79=[..._0x3dc1dd[_0x362ec8(0x1ff)][_0x362ec8(0x1ac)]];const _0x14dcba=_0x51f600[_0x362ec8(0x1e2)](_0x19c98c=>{return _0x19c98c={'product_name':_0x19c98c};});_0x357c4e[_0x362ec8(0x285)]((_0xd3923c,_0x153ded)=>{var _0x4b98cf=_0x362ec8;_0x14dcba[_0x153ded][_0x4b98cf(0x277)]=_0xd3923c;}),_0x40eb54[_0x362ec8(0x285)]((_0x58bc02,_0x18a2eb)=>{var _0x38f69a=_0x362ec8;_0x14dcba[_0x18a2eb][_0x38f69a(0x1c7)]=_0x58bc02;}),_0x196b96['forEach']((_0x28e40f,_0x5865d5)=>{var _0x2b0549=_0x362ec8;_0x14dcba[_0x5865d5][_0x2b0549(0x28c)]=_0x28e40f;}),_0xc5a79[_0x362ec8(0x285)]((_0x5eb1de,_0x4a3a65)=>{var _0x4b26da=_0x362ec8;_0x14dcba[_0x4a3a65][_0x4b26da(0x271)]=_0x5eb1de;}),_0x5072fe[_0x362ec8(0x285)]((_0x4e4d4b,_0x52050a)=>{_0x3ee463['forEach']((_0x8db6c9,_0x10317a)=>{var _0x80a69c=a0_0x1a17;if(_0x8db6c9==_0x80a69c(0x1a9)&&_0x52050a==_0x10317a){var _0x3a3d8a=_0x4e4d4b[_0x80a69c(0x1a8)](0x3);_0x14dcba[_0x52050a][_0x80a69c(0x21b)]=_0x4e4d4b[0x0],_0x14dcba[_0x52050a][_0x80a69c(0x23a)]=_0x4e4d4b[0x1],_0x14dcba[_0x52050a][_0x80a69c(0x290)]=0x0,_0x14dcba[_0x52050a][_0x80a69c(0x220)]=0x0,_0x14dcba[_0x52050a]['from_types']=_0x80a69c(0x1df),_0x14dcba[_0x52050a]['from_floorlevel']=_0x3a3d8a;}else{if(_0x8db6c9==_0x80a69c(0x255)&&_0x52050a==_0x10317a){var _0x3a3d8a=_0x4e4d4b[_0x80a69c(0x1a8)](0x3);_0x14dcba[_0x52050a][_0x80a69c(0x21b)]=_0x4e4d4b[0x0],_0x14dcba[_0x52050a][_0x80a69c(0x23a)]=_0x4e4d4b[0x1],_0x14dcba[_0x52050a][_0x80a69c(0x290)]=0x0,_0x14dcba[_0x52050a][_0x80a69c(0x220)]=0x0,_0x14dcba[_0x52050a][_0x80a69c(0x25a)]='Floor',_0x14dcba[_0x52050a][_0x80a69c(0x1e3)]=_0x4e4d4b[0x5];}else{if(_0x52050a==_0x10317a){if(_0x4e4d4b[0x0]=='A'&&_0x4e4d4b[0x1]=='L'&&_0x4e4d4b[0x2]=='L')console[_0x80a69c(0x264)](_0x8db6c9+_0x80a69c(0x1b0)+_0x52050a+_0x80a69c(0x1b0)+_0x10317a+'\x20<>\x20'+_0x4e4d4b+_0x80a69c(0x20c)),_0x14dcba[_0x52050a][_0x80a69c(0x21b)]=_0x4e4d4b[0x0],_0x14dcba[_0x52050a][_0x80a69c(0x23a)]=_0x4e4d4b[0x1],_0x14dcba[_0x52050a][_0x80a69c(0x290)]=0x0,_0x14dcba[_0x52050a][_0x80a69c(0x220)]=0x0,_0x14dcba[_0x52050a]['from_types']=_0x80a69c(0x1df),_0x14dcba[_0x52050a][_0x80a69c(0x1e3)]=_0x4e4d4b[0x3];else{var _0x434e03;if(_0x4e4d4b[0x4]=='L')_0x434e03=_0x80a69c(0x23c);else _0x4e4d4b[0x4]=='F'&&(_0x434e03=_0x80a69c(0x1df));_0x14dcba[_0x52050a][_0x80a69c(0x21b)]=_0x4e4d4b[0x0],_0x14dcba[_0x52050a][_0x80a69c(0x23a)]=_0x4e4d4b[0x1],_0x14dcba[_0x52050a][_0x80a69c(0x290)]=_0x4e4d4b[0x2],_0x14dcba[_0x52050a][_0x80a69c(0x220)]=_0x4e4d4b[0x3],_0x14dcba[_0x52050a]['from_types']=_0x434e03,_0x14dcba[_0x52050a]['from_floorlevel']=_0x4e4d4b[0x5];}}}}});}),_0x5b660e[_0x362ec8(0x285)]((_0x13d157,_0x33af0d)=>{var _0x47b3ee=_0x362ec8;_0x14dcba[_0x33af0d][_0x47b3ee(0x291)]=_0x13d157;}),_0x46ab20['forEach']((_0x555805,_0x53a669)=>{var _0xaf082a=_0x362ec8;_0x1c49db[_0xaf082a(0x285)]((_0x10c27d,_0x32bccd)=>{var _0x5a2bda=_0xaf082a;if(_0x10c27d==_0x5a2bda(0x1a9)&&_0x53a669==_0x32bccd){var _0xbc86ad=_0x555805['slice'](0x3);_0x14dcba[_0x53a669][_0x5a2bda(0x289)]=_0x555805[0x0],_0x14dcba[_0x53a669][_0x5a2bda(0x1a5)]=_0x555805[0x1],_0x14dcba[_0x53a669][_0x5a2bda(0x22b)]=0x0,_0x14dcba[_0x53a669][_0x5a2bda(0x226)]=0x0,_0x14dcba[_0x53a669][_0x5a2bda(0x1fc)]=_0x5a2bda(0x1df),_0x14dcba[_0x53a669][_0x5a2bda(0x200)]=_0xbc86ad;}else{if(_0x10c27d==_0x5a2bda(0x255)&&_0x53a669==_0x32bccd){var _0xbc86ad=_0x555805[_0x5a2bda(0x1a8)](0x3);_0x14dcba[_0x53a669]['storage']=_0x555805[0x0],_0x14dcba[_0x53a669][_0x5a2bda(0x1a5)]=_0x555805[0x1],_0x14dcba[_0x53a669]['to_bay']=0x0,_0x14dcba[_0x53a669][_0x5a2bda(0x226)]=0x0,_0x14dcba[_0x53a669]['to_types']='Floor',_0x14dcba[_0x53a669]['to_floorlevel']=_0x555805[0x5];}else{if(_0x53a669==_0x32bccd){if(_0x555805[0x0]=='A'&&_0x555805[0x1]=='L'&&_0x555805[0x2]=='L')console['log'](_0x10c27d+_0x5a2bda(0x1b0)+_0x53a669+_0x5a2bda(0x1b0)+_0x32bccd+'\x20<>\x20'+_0x555805+'here'),_0x14dcba[_0x53a669][_0x5a2bda(0x289)]=_0x555805[0x0],_0x14dcba[_0x53a669][_0x5a2bda(0x1a5)]=_0x555805[0x1],_0x14dcba[_0x53a669][_0x5a2bda(0x22b)]=0x0,_0x14dcba[_0x53a669][_0x5a2bda(0x226)]=0x0,_0x14dcba[_0x53a669][_0x5a2bda(0x1fc)]=_0x5a2bda(0x1df),_0x14dcba[_0x53a669][_0x5a2bda(0x200)]=_0x555805[0x3];else{var _0x3f37d4;if(_0x555805[0x4]=='L')_0x3f37d4=_0x5a2bda(0x23c);else _0x555805[0x4]=='F'&&(_0x3f37d4=_0x5a2bda(0x1df));_0x14dcba[_0x53a669][_0x5a2bda(0x289)]=_0x555805[0x0],_0x14dcba[_0x53a669][_0x5a2bda(0x1a5)]=_0x555805[0x1],_0x14dcba[_0x53a669]['to_bay']=_0x555805[0x2],_0x14dcba[_0x53a669][_0x5a2bda(0x226)]=_0x555805[0x3],_0x14dcba[_0x53a669][_0x5a2bda(0x1fc)]=_0x3f37d4,_0x14dcba[_0x53a669]['to_floorlevel']=_0x555805[0x5];}}}}});}),_0x2c42a2[_0x362ec8(0x285)]((_0xd55a1f,_0x5b7fa2)=>{var _0x4f8524=_0x362ec8;_0x14dcba[_0x5b7fa2][_0x4f8524(0x210)]=_0xd55a1f;}),_0x5dd31e[_0x362ec8(0x285)]((_0x449b32,_0x51bc12)=>{var _0x1d878a=_0x362ec8;_0x14dcba[_0x51bc12][_0x1d878a(0x212)]=_0x449b32;}),_0x4692d9[_0x362ec8(0x285)]((_0x491f9f,_0x3af02c)=>{var _0x104625=_0x362ec8;_0x14dcba[_0x3af02c][_0x104625(0x243)]=_0x491f9f;}),_0x4618fd[_0x362ec8(0x285)]((_0x26a6e3,_0x66984e)=>{var _0x585241=_0x362ec8;_0x14dcba[_0x66984e][_0x585241(0x23e)]=_0x26a6e3;}),_0x16e17f[_0x362ec8(0x285)]((_0x17c199,_0x1ba276)=>{var _0x16bc00=_0x362ec8;_0x14dcba[_0x1ba276][_0x16bc00(0x21d)]=_0x17c199;}),_0x2e46de['forEach']((_0x46b3f6,_0x2fb177)=>{_0x14dcba[_0x2fb177]['secondary_unit']=_0x46b3f6;}),_0xdd9f34['forEach']((_0xd0b6a,_0x2e885b)=>{_0x14dcba[_0x2e885b]['batch_code']=_0xd0b6a;}),_0x32744d[_0x362ec8(0x285)]((_0x24b6ae,_0x2be107)=>{var _0x3339f4=_0x362ec8;_0x14dcba[_0x2be107][_0x3339f4(0x26f)]=_0x24b6ae;}),_0x1200ab[_0x362ec8(0x285)]((_0x25ee6e,_0x17871c)=>{var _0x1f5d76=_0x362ec8;_0x14dcba[_0x17871c][_0x1f5d76(0x1ba)]=_0x25ee6e;}),_0x38d04b['forEach']((_0x28c3eb,_0x1fe6ea)=>{var _0x12a0a7=_0x362ec8;_0x14dcba[_0x1fe6ea][_0x12a0a7(0x28b)]=_0x28c3eb;}),_0x4ebe23[_0x362ec8(0x285)]((_0x4d690b,_0x359653)=>{var _0x490032=_0x362ec8;_0x14dcba[_0x359653][_0x490032(0x203)]=_0x4d690b;}),_0x3ee463[_0x362ec8(0x285)]((_0x1e3ade,_0x461643)=>{var _0x21decf=_0x362ec8;_0x14dcba[_0x461643][_0x21decf(0x1b1)]=_0x1e3ade;}),_0x1c49db[_0x362ec8(0x285)]((_0x1502ac,_0x1fcbee)=>{var _0x38ecc0=_0x362ec8;_0x14dcba[_0x1fcbee][_0x38ecc0(0x1dc)]=_0x1502ac;});const _0x18fc36=_0x14dcba[_0x362ec8(0x1c0)](_0x24e797=>_0x24e797[_0x362ec8(0x291)]!=='0'&&_0x24e797['to_quantity']!==''||_0x24e797[_0x362ec8(0x200)]!=='0'&&_0x24e797[_0x362ec8(0x200)]!==''),_0x289d20=new transfers({'date':_0x49ab0c,'from_warehouse':_0xf9aad1,'to_warehouse':_0x36d669,'product':_0x18fc36,'note':_0x258a45,'invoice':_0x2f646c}),_0x2ab11b=await _0x289d20[_0x362ec8(0x247)]();_0x3dc1dd[_0x362ec8(0x1d9)](_0x362ec8(0x1e5),_0x362ec8(0x25e)),_0xe89788[_0x362ec8(0x228)](_0x362ec8(0x1e9)+_0x2ab11b[_0x362ec8(0x207)]);}catch(_0x374692){console['log'](_0x374692),_0xe89788[_0x362ec8(0x280)](0xc8)[_0x362ec8(0x26c)]({'errorMessage':_0x374692[_0x362ec8(0x1c6)]});}}),router[a0_0x449360(0x1ee)](a0_0x449360(0x1cb),auth,async(_0xd7cbdd,_0x2e38c4)=>{var _0x5862d4=a0_0x449360;try{const {username:_0x4b9cae,email:_0xbfc73a,role:_0x316c99}=_0xd7cbdd['user'],_0x3a0e2d=_0xd7cbdd['user'],_0x188c21=await profile[_0x5862d4(0x202)]({'email':_0x3a0e2d[_0x5862d4(0x233)]}),_0x3ce6aa=await master_shop[_0x5862d4(0x1fa)]();console[_0x5862d4(0x264)](_0x5862d4(0x223),_0x3ce6aa);const _0x1c1dab=await transfers[_0x5862d4(0x279)](_0xd7cbdd[_0x5862d4(0x28a)]['id']);let _0x32a9a8=new Date(_0x1c1dab['expiry_date']),_0x3fca84=('0'+_0x32a9a8[_0x5862d4(0x1db)]())[_0x5862d4(0x1a8)](-0x2),_0x2d76f4=('0'+(_0x32a9a8['getMonth']()+0x1))[_0x5862d4(0x1a8)](-0x2),_0x14b81a=_0x32a9a8['getFullYear'](),_0x4966f3=_0x14b81a+'-'+_0x2d76f4+'-'+_0x3fca84,_0x4478b8;if(_0x3a0e2d[_0x5862d4(0x25c)]==_0x5862d4(0x1a4)){const _0x411fd2=await staff['findOne']({'email':_0x3a0e2d[_0x5862d4(0x233)]});_0x4478b8=await warehouse['find']({'status':_0x5862d4(0x269),'name':_0x411fd2['warehouse'],'warehouse_category':_0x5862d4(0x236)});}else _0x4478b8=await warehouse[_0x5862d4(0x1fa)]({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0x2321b8=await warehouse[_0x5862d4(0x1bb)]([{'$match':{'name':_0x1c1dab[_0x5862d4(0x22f)]}},{'$unwind':_0x5862d4(0x23f)},{'$group':{'_id':_0x5862d4(0x1c5),'name':{'$first':_0x5862d4(0x227)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5862d4(0x252)},'bin':{'$first':_0x5862d4(0x26d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5862d4(0x22a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5862d4(0x1b7)},'product_code':{'$first':_0x5862d4(0x254)},'storage':{'$first':_0x5862d4(0x27a)},'rack':{'$first':_0x5862d4(0x1e1)},'expiry_date':{'$first':_0x5862d4(0x1d2)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x5862d4(0x1ef)}}}]);if(_0x3ce6aa[0x0][_0x5862d4(0x1f8)]==_0x5862d4(0x1fd)){var _0x5eb332=users[_0x5862d4(0x261)];console[_0x5862d4(0x264)](_0x5eb332);}else{if(_0x3ce6aa[0x0]['language']==_0x5862d4(0x214))var _0x5eb332=users[_0x5862d4(0x214)];else{if(_0x3ce6aa[0x0][_0x5862d4(0x1f8)]==_0x5862d4(0x263))var _0x5eb332=users[_0x5862d4(0x263)];else{if(_0x3ce6aa[0x0][_0x5862d4(0x1f8)]==_0x5862d4(0x238))var _0x5eb332=users[_0x5862d4(0x238)];else{if(_0x3ce6aa[0x0][_0x5862d4(0x1f8)]==_0x5862d4(0x205))var _0x5eb332=users[_0x5862d4(0x205)];else{if(_0x3ce6aa[0x0][_0x5862d4(0x1f8)]=='Portuguese\x20(BR)')var _0x5eb332=users[_0x5862d4(0x1fe)];else{if(_0x3ce6aa[0x0][_0x5862d4(0x1f8)]=='Chinese')var _0x5eb332=users['Chinese'];else{if(_0x3ce6aa[0x0]['language']==_0x5862d4(0x248))var _0x5eb332=users[_0x5862d4(0x1ec)];}}}}}}}_0x2e38c4[_0x5862d4(0x201)](_0x5862d4(0x1c2),{'success':_0xd7cbdd['flash'](_0x5862d4(0x1e5)),'errors':_0xd7cbdd['flash']('errors'),'role':_0x3a0e2d,'profile':_0x188c21,'master_shop':_0x3ce6aa,'warehouse':_0x4478b8,'transfer':_0x1c1dab,'stock':_0x2321b8,'language':_0x5eb332});}catch(_0xec79e2){console[_0x5862d4(0x264)](_0xec79e2);}}),router[a0_0x449360(0x216)](a0_0x449360(0x1cb),auth,async(_0x27935b,_0xd69f0)=>{var _0x56dad6=a0_0x449360;try{const _0x1a5196=_0x27935b['params']['id'],{from_warehouse:_0x189691,FromRoom_name:_0x1a2f45,to_warehouse:_0x55238d,ToRoom_name:_0x242e5c}=_0x27935b['body'],_0x4bf372=await transfers['findById']({'_id':_0x1a5196}),_0x2a9e2f=_0x4bf372[_0x56dad6(0x1a6)][_0x56dad6(0x1e2)](async _0x457ff5=>{var _0x1cb987=_0x56dad6;if(_0x457ff5['to_quantity']>0x0){var _0x9e805b=await warehouse[_0x1cb987(0x202)]({'name':_0x4bf372[_0x1cb987(0x22f)],'room':_0x457ff5[_0x1cb987(0x1b1)],'warehouse_category':_0x1cb987(0x236)});const _0x158920=_0x9e805b[_0x1cb987(0x224)][_0x1cb987(0x1e2)](_0x31236d=>{var _0x3b57be=_0x1cb987;_0x31236d[_0x3b57be(0x278)]==_0x457ff5[_0x3b57be(0x278)]&&_0x31236d[_0x3b57be(0x1f9)]==_0x457ff5['from_floorlevel']&&_0x31236d['type']==_0x457ff5[_0x3b57be(0x25a)]&&_0x31236d[_0x3b57be(0x21f)]==_0x457ff5[_0x3b57be(0x220)]&&_0x31236d[_0x3b57be(0x1cf)]==_0x457ff5[_0x3b57be(0x290)]&&_0x31236d['rack']==_0x457ff5[_0x3b57be(0x23a)]&&_0x31236d['storage']==_0x457ff5[_0x3b57be(0x21b)]&&_0x31236d[_0x3b57be(0x26f)]==_0x457ff5[_0x3b57be(0x26f)]&&_0x31236d[_0x3b57be(0x294)]==_0x457ff5[_0x3b57be(0x294)]&&_0x31236d[_0x3b57be(0x28b)]==_0x457ff5[_0x3b57be(0x28b)]&&_0x31236d['invoice']==_0x457ff5[_0x3b57be(0x1c7)]&&_0x31236d[_0x3b57be(0x207)]==_0x457ff5[_0x3b57be(0x271)]&&(_0x31236d[_0x3b57be(0x22e)]=_0x31236d['product_stock']-_0x457ff5[_0x3b57be(0x291)]);});}return _0x9e805b;});Promise[_0x56dad6(0x218)](_0x2a9e2f)[_0x56dad6(0x242)](async _0x5639ac=>{var _0x171737=_0x56dad6;try{for(const _0x3b652c of _0x5639ac){await _0x3b652c[_0x171737(0x247)]();}try{const _0x18efc0=_0x4bf372[_0x171737(0x1a6)][_0x171737(0x1e2)](async _0xf7f918=>{var _0x5c8723=_0x171737;if(_0xf7f918[_0x5c8723(0x291)]>0x0){var _0x43c4c6=await warehouse[_0x5c8723(0x202)]({'name':_0x4bf372[_0x5c8723(0x1ce)],'room':_0xf7f918[_0x5c8723(0x1dc)],'warehouse_category':_0x5c8723(0x236)}),_0x4fa2a0=0x0;const _0x302d2e=_0x43c4c6[_0x5c8723(0x224)][_0x5c8723(0x1e2)](_0x468bca=>{var _0x393b25=_0x5c8723;_0x468bca[_0x393b25(0x278)]==_0xf7f918[_0x393b25(0x278)]&&_0x468bca[_0x393b25(0x1f9)]==_0xf7f918['to_floorlevel']&&_0x468bca[_0x393b25(0x24e)]==_0xf7f918[_0x393b25(0x1fc)]&&_0x468bca[_0x393b25(0x21f)]==_0xf7f918[_0x393b25(0x226)]&&_0x468bca[_0x393b25(0x1cf)]==_0xf7f918[_0x393b25(0x22b)]&&_0x468bca['rack']==_0xf7f918[_0x393b25(0x1a5)]&&_0x468bca[_0x393b25(0x289)]==_0xf7f918[_0x393b25(0x289)]&&_0x468bca[_0x393b25(0x26f)]==_0xf7f918['expiry_date']&&_0x468bca[_0x393b25(0x294)]==_0xf7f918[_0x393b25(0x294)]&&_0x468bca[_0x393b25(0x28b)]==_0xf7f918[_0x393b25(0x28b)]&&_0x468bca['invoice']==_0xf7f918[_0x393b25(0x28c)]&&(_0x468bca[_0x393b25(0x22e)]=_0x468bca[_0x393b25(0x22e)]+_0xf7f918[_0x393b25(0x291)],_0x4fa2a0++);});_0x4fa2a0=='0'&&(_0x43c4c6['product_details']=_0x43c4c6[_0x5c8723(0x224)][_0x5c8723(0x23b)]({'product_name':_0xf7f918[_0x5c8723(0x278)],'product_stock':_0xf7f918[_0x5c8723(0x291)],'bay':_0xf7f918[_0x5c8723(0x22b)],'bin':_0xf7f918[_0x5c8723(0x226)],'type':_0xf7f918[_0x5c8723(0x1fc)],'floorlevel':_0xf7f918[_0x5c8723(0x200)],'storage':_0xf7f918[_0x5c8723(0x289)],'rack':_0xf7f918[_0x5c8723(0x1a5)],'product_code':_0xf7f918[_0x5c8723(0x243)],'primary_code':_0xf7f918[_0x5c8723(0x210)],'secondary_code':_0xf7f918[_0x5c8723(0x212)],'maxProducts':_0xf7f918['maxProducts'],'storage':_0xf7f918['storage'],'rack':_0xf7f918['rack'],'expiry_date':_0xf7f918[_0x5c8723(0x26f)],'maxPerUnit':_0xf7f918[_0x5c8723(0x1ba)],'batch_code':_0xf7f918[_0x5c8723(0x294)],'production_date':_0xf7f918[_0x5c8723(0x28b)]}));}return _0x43c4c6;});Promise[_0x171737(0x218)](_0x18efc0)[_0x171737(0x242)](async _0x370372=>{var _0x360d07=_0x171737;try{for(const _0x29ea5c of _0x370372){await warehouse['updateOne']({'_id':_0x29ea5c['_id']},{'$addToSet':{'product_details':{'$each':_0x29ea5c['product_details']}}});}_0x4bf372[_0x360d07(0x1af)]=_0x360d07(0x25d);const _0x2dbda0=await _0x4bf372[_0x360d07(0x247)](),_0xb4a9a9=await master_shop[_0x360d07(0x1fa)](),_0x6087e5=await email_settings['findOne'](),_0x1c280e=await supervisor_settings[_0x360d07(0x1fa)]();var _0x543fdf=_0x4bf372[_0x360d07(0x1a6)],_0x1d40b9='',_0x1aebc1;for(_0x1aebc1 in _0x543fdf){_0x1d40b9+=_0x360d07(0x1d7)+_0x360d07(0x1b3)+_0x543fdf[_0x1aebc1][_0x360d07(0x278)]+_0x360d07(0x234)+_0x360d07(0x1b3)+_0x543fdf[_0x1aebc1][_0x360d07(0x243)]+_0x360d07(0x234)+_0x360d07(0x1b3)+_0x543fdf[_0x1aebc1][_0x360d07(0x291)]+_0x360d07(0x234)+_0x360d07(0x1b3)+_0x543fdf[_0x1aebc1]['unit']+_0x360d07(0x234)+_0x360d07(0x1b3)+_0x543fdf[_0x1aebc1][_0x360d07(0x27e)]+_0x360d07(0x234)+_0x360d07(0x1b3)+_0x4bf372[_0x360d07(0x1ce)]+_0x360d07(0x234)+_0x360d07(0x1b3)+_0x543fdf[_0x1aebc1][_0x360d07(0x1dc)]+'</td>'+_0x360d07(0x1b3)+_0x543fdf[_0x1aebc1][_0x360d07(0x289)]+_0x543fdf[_0x1aebc1][_0x360d07(0x1a5)]+_0x543fdf[_0x1aebc1][_0x360d07(0x22b)]+_0x543fdf[_0x1aebc1][_0x360d07(0x226)]+_0x543fdf[_0x1aebc1][_0x360d07(0x1fc)][0x0]+_0x543fdf[_0x1aebc1][_0x360d07(0x200)]+_0x360d07(0x234),_0x360d07(0x245);}let _0x5a0b72=nodemailer[_0x360d07(0x20d)]({'host':_0x6087e5[_0x360d07(0x209)],'port':Number(_0x6087e5[_0x360d07(0x1e8)]),'secure':![],'auth':{'user':_0x6087e5[_0x360d07(0x233)],'pass':_0x6087e5[_0x360d07(0x1a7)]}}),_0x30817f={'from':_0x6087e5[_0x360d07(0x233)],'to':_0x1c280e[0x0][_0x360d07(0x225)],'subject':_0x360d07(0x25f),'attachments':[{'filename':_0x360d07(0x23d),'path':__dirname+'/../public'+'/upload/'+_0xb4a9a9[0x0][_0x360d07(0x1de)],'cid':_0x360d07(0x272)}],'html':_0x360d07(0x20e)+_0x360d07(0x222)+'</head><body>'+_0x360d07(0x1b6)+_0x360d07(0x275)+_0x360d07(0x1b6)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+'<h2>\x20'+_0xb4a9a9[0x0][_0x360d07(0x1f7)]+_0x360d07(0x1d3)+_0x360d07(0x244)+'</div>'+_0x360d07(0x287)+_0x360d07(0x1b6)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x360d07(0x1e0)+_0x4bf372[_0x360d07(0x1c4)]+'\x20'+_0x360d07(0x20f)+_0x360d07(0x1f1)+_0x4bf372[_0x360d07(0x293)]+'\x20'+'</span>'+_0x360d07(0x21c)+_0x360d07(0x244)+_0x360d07(0x259)+_0x360d07(0x213)+_0x360d07(0x1d7)+_0x360d07(0x257)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x360d07(0x1c8)+_0x360d07(0x231)+_0x360d07(0x28d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x360d07(0x270)+_0x360d07(0x1c3)+'</tr>'+_0x360d07(0x20b)+_0x360d07(0x1f4)+'\x20'+_0x1d40b9+'\x20'+'</tbody>'+_0x360d07(0x22d)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x360d07(0x1e7)+_0xb4a9a9[0x0][_0x360d07(0x1f7)]+_0x360d07(0x21c)+'</div>'+'</div>'+_0x360d07(0x1fb)};_0x5a0b72['sendMail'](_0x30817f,function(_0x3373ff,_0x5e5b46){var _0x5586b5=_0x360d07;_0x3373ff?(console[_0x5586b5(0x264)](_0x3373ff),console[_0x5586b5(0x264)](_0x5586b5(0x1f3))):console[_0x5586b5(0x264)](_0x5586b5(0x235));}),_0x27935b['flash']('success',_0x360d07(0x206)),_0xd69f0['redirect'](_0x360d07(0x1c9)+_0x2dbda0[_0x360d07(0x207)]);}catch(_0x2afe0f){console[_0x360d07(0x1d6)](_0x2afe0f),_0xd69f0[_0x360d07(0x280)](0x1f4)['json']({'Perror':_0x360d07(0x230),'message':_0x2afe0f[_0x360d07(0x1c6)]});}})[_0x171737(0x1b4)](_0x3a48cb=>{var _0x517dd4=_0x171737;console['error'](_0x3a48cb),_0xd69f0['status'](0x1f4)[_0x517dd4(0x26c)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x2ec268){_0xd69f0[_0x171737(0x26c)](_0x2ec268);}}catch(_0x472373){console[_0x171737(0x1d6)](_0x472373),_0xd69f0[_0x171737(0x280)](0x1f4)['json']({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x472373[_0x171737(0x1c6)]});}})[_0x56dad6(0x1b4)](_0x59053e=>{var _0x368901=_0x56dad6;console[_0x368901(0x1d6)](_0x59053e),_0xd69f0[_0x368901(0x280)](0x1f4)['json']({'Merror':'An\x20error\x20occurred.'});});}catch(_0x591c57){console['log'](_0x591c57);}});function BayBinSelected(_0x581455,_0x396758){var _0x23239c=a0_0x449360,_0x309038=[],_0x8221b9=[],_0x46cff7=[],_0x528c5f=[],_0x2ee694=[],_0xd13ac5=[];let _0x74e54=[];if(_0x581455==_0x23239c(0x1e6))switch(_0x396758){case'Rack\x20A':_0x309038=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x8221b9=[0x1,0x2],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=[_0x23239c(0x23c),_0x23239c(0x1df)],_0x2ee694=['D'],_0xd13ac5=['A'];break;case _0x23239c(0x1f5):_0x309038=[0x6,0x5,0x4,0x3,0x2,0x1],_0x8221b9=[0x1,0x2],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=[_0x23239c(0x23c),_0x23239c(0x1df)],_0x2ee694=['D'],_0xd13ac5=['B'];break;case'Shelves':_0x309038=[0x0],_0x8221b9=[0x0],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=['Floor'],_0x2ee694=['D'],_0xd13ac5=['S'];break;case _0x23239c(0x1a9):_0x309038=[0x0],_0x8221b9=[0x0],_0x528c5f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x46cff7=[_0x23239c(0x1df)],_0x2ee694=['D'],_0xd13ac5=['R'];break;}else{if(_0x581455==_0x23239c(0x208))switch(_0x396758){case _0x23239c(0x1dd):_0x309038=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x8221b9=['B','F'],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=[_0x23239c(0x23c),_0x23239c(0x1df)],_0x2ee694=['C'],_0xd13ac5=['A'];break;case _0x23239c(0x1f5):_0x309038=[0x5,0x4,0x3,0x2,0x1],_0x8221b9=['F','B','S'],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=[_0x23239c(0x23c),'Floor'],_0x2ee694=['C'],_0xd13ac5=['B'];break;case _0x23239c(0x276):_0x309038=[0x1,0x2,0x3,0x4,0x5],_0x8221b9=['B','F','S'],_0x528c5f=[0x5,0x4,0x3,0x2,0x1],_0x46cff7=[_0x23239c(0x23c),_0x23239c(0x1df)],_0x2ee694=['C'],_0xd13ac5=['C'];break;case _0x23239c(0x274):_0x309038=[0x5,0x4,0x3,0x2,0x1],_0x8221b9=['F','B','S'],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=[_0x23239c(0x23c),_0x23239c(0x1df)],_0x2ee694=['C'],_0xd13ac5=['D'];break;case _0x23239c(0x22c):_0x309038=[0x4,0x3,0x2,0x1],_0x8221b9=[0x1,0x2],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=[_0x23239c(0x23c),'Floor'],_0x2ee694=['C'],_0xd13ac5=['E'];break;case _0x23239c(0x26e):_0x309038=[0x1,0x2,0x3],_0x8221b9=[0x1,0x2],_0x528c5f=[0x1,0x2,0x3,0x4,0x5],_0x46cff7=[_0x23239c(0x23c)],_0x2ee694=['C'],_0xd13ac5=['F'];break;}}return{'levels':_0x309038,'Isle':_0x8221b9,'rack':_0x528c5f,'type':_0x46cff7,'storage':_0x2ee694,'rak':_0xd13ac5};}function a0_0x1a17(_0x550c9b,_0x79cd5b){var _0x5ad813=a0_0x5ad8();return a0_0x1a17=function(_0x1a1751,_0x3d33af){_0x1a1751=_0x1a1751-0x1a4;var _0x31ee96=_0x5ad813[_0x1a1751];return _0x31ee96;},a0_0x1a17(_0x550c9b,_0x79cd5b);}router[a0_0x449360(0x1ee)](a0_0x449360(0x1ed),auth,async(_0x6ee593,_0x27dd43)=>{var _0xd4d97f=a0_0x449360;try{const {username:_0x494bef,email:_0x39807a,role:_0x423012}=_0x6ee593['user'],_0x21f388=_0x6ee593[_0xd4d97f(0x268)],_0xded3ef=await profile[_0xd4d97f(0x202)]({'email':_0x21f388[_0xd4d97f(0x233)]}),_0x453ee8=await master_shop[_0xd4d97f(0x1fa)](),_0x1440f6=await transfers['findById'](_0x6ee593[_0xd4d97f(0x28a)]['id']);let _0xe120da;if(_0x21f388[_0xd4d97f(0x25c)]==_0xd4d97f(0x1a4)){const _0x2c655f=await staff[_0xd4d97f(0x202)]({'email':_0x21f388[_0xd4d97f(0x233)]});_0xe120da=await warehouse['aggregate']([{'$match':{'status':_0xd4d97f(0x269),'name':_0x2c655f['warehouse'],'warehouse_category':_0xd4d97f(0x236)}},{'$group':{'_id':'$name','name':{'$first':_0xd4d97f(0x27b)}}}]);}else _0xe120da=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0xd4d97f(0x236)}},{'$group':{'_id':_0xd4d97f(0x27b),'name':{'$first':_0xd4d97f(0x27b)}}}]);const _0x58757f=await warehouse['aggregate']([{'$match':{'name':_0x1440f6[_0xd4d97f(0x22f)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':_0xd4d97f(0x1c5),'name':{'$first':_0xd4d97f(0x227)},'product_stock':{'$first':_0xd4d97f(0x253)},'bay':{'$first':_0xd4d97f(0x252)},'bin':{'$first':_0xd4d97f(0x26d)},'type':{'$first':_0xd4d97f(0x281)},'floorlevel':{'$first':_0xd4d97f(0x22a)},'primary_code':{'$first':_0xd4d97f(0x217)},'secondary_code':{'$first':_0xd4d97f(0x1b7)},'product_code':{'$first':_0xd4d97f(0x254)},'storage':{'$first':_0xd4d97f(0x27a)},'rack':{'$first':_0xd4d97f(0x1e1)},'expiry_date':{'$first':_0xd4d97f(0x1d2)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0x5e74bd=await product[_0xd4d97f(0x1fa)]({}),_0x5466f7=BayBinSelected(_0x1440f6[_0xd4d97f(0x1ce)],_0x1440f6[_0xd4d97f(0x28f)]);if(_0x453ee8[0x0][_0xd4d97f(0x1f8)]==_0xd4d97f(0x1fd)){var _0x5d79b6=users['English'];console[_0xd4d97f(0x264)](_0x5d79b6);}else{if(_0x453ee8[0x0]['language']==_0xd4d97f(0x214))var _0x5d79b6=users['Hindi'];else{if(_0x453ee8[0x0][_0xd4d97f(0x1f8)]==_0xd4d97f(0x263))var _0x5d79b6=users[_0xd4d97f(0x263)];else{if(_0x453ee8[0x0][_0xd4d97f(0x1f8)]==_0xd4d97f(0x238))var _0x5d79b6=users[_0xd4d97f(0x238)];else{if(_0x453ee8[0x0][_0xd4d97f(0x1f8)]=='French')var _0x5d79b6=users[_0xd4d97f(0x205)];else{if(_0x453ee8[0x0][_0xd4d97f(0x1f8)]==_0xd4d97f(0x1f6))var _0x5d79b6=users[_0xd4d97f(0x1fe)];else{if(_0x453ee8[0x0]['language']==_0xd4d97f(0x273))var _0x5d79b6=users['Chinese'];else{if(_0x453ee8[0x0][_0xd4d97f(0x1f8)]==_0xd4d97f(0x248))var _0x5d79b6=users[_0xd4d97f(0x1ec)];}}}}}}}_0x27dd43['render']('edit_transfer',{'success':_0x6ee593[_0xd4d97f(0x1d9)](_0xd4d97f(0x1e5)),'errors':_0x6ee593[_0xd4d97f(0x1d9)](_0xd4d97f(0x1ae)),'role':_0x21f388,'profile':_0xded3ef,'master_shop':_0x453ee8,'warehouse':_0xe120da,'transfer':_0x1440f6,'stock':_0x58757f,'unit':_0x5e74bd,'language':_0x5d79b6});}catch(_0x5bce4f){console['log'](_0x5bce4f);}}),router[a0_0x449360(0x216)](a0_0x449360(0x1ed),auth,async(_0x29ab40,_0x1333be)=>{var _0x5b4590=a0_0x449360;try{const _0x9288a1=_0x29ab40[_0x5b4590(0x28a)]['id'],_0x25f20c=await transfers[_0x5b4590(0x279)](_0x9288a1);_0x1333be['json'](_0x29ab40['body']);return;const {date:_0x217455,from_warehouse:_0x438a9c,FromRoom_name:_0x1f450d,to_warehouse:_0x58938b,ToRoom_name:_0x59ba15,prod_name:_0x3357c8,from_prod_qty:_0x463ec4,from_prod_level:_0x2233a4,from_prod_isle:_0x1dceaa,from_prod_pallet:_0x7a9e56,to_prod_qty:_0x322dd6,to_prod_level:_0x1f3f43,to_prod_isle:_0x76fc8,to_prod_pallet:_0x314a0b,primary_code:_0x57c042,secondary_code:_0x2c15ae,product_code3:_0x57f25e,note:_0x554389,invoice:_0x9b9286,expiry_date:_0xf33f7f}=_0x29ab40[_0x5b4590(0x1ff)];if(typeof _0x3357c8==_0x5b4590(0x221))var _0x1d7081=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x211)]],_0xb0207c=[_0x29ab40['body']['from_prod_qty']],_0x3914be=[_0x29ab40['body']['from_prod_level']],_0x143013=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x250)]],_0x596930=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1ea)]],_0x7d22b7=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x25a)]],_0x13966c=[_0x29ab40['body'][_0x5b4590(0x1cc)]],_0x664611=[_0x29ab40['body'][_0x5b4590(0x25b)]],_0x5ed235=[_0x29ab40['body'][_0x5b4590(0x1d8)]],_0x517d15=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x27c)]],_0x2608ea=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1fc)]],_0x2aed67=[_0x29ab40['body'][_0x5b4590(0x289)]],_0x1768ae=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1ab)]],_0x834216=[_0x29ab40['body'][_0x5b4590(0x210)]],_0x190328=[_0x29ab40[_0x5b4590(0x1ff)]['secondary_code']],_0x1b3add=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x26b)]],_0x5d1e55=[_0x29ab40['body'][_0x5b4590(0x1be)]],_0x3c8b5e=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x21d)]],_0x531c2d=[_0x29ab40[_0x5b4590(0x1ff)]['secondary_unit']],_0x6e9be6=[_0x29ab40[_0x5b4590(0x1ff)]['batch_code']],_0x4f334f=[_0x29ab40[_0x5b4590(0x1ff)]['expiry_date']],_0x367a67=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x21b)]],_0x448e91=[_0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x204)]];else var _0x1d7081=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x211)]],_0x2aed67=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x289)]],_0x1768ae=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1ab)]],_0x7d22b7=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x25a)]],_0x2608ea=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1fc)]],_0xb0207c=[..._0x29ab40[_0x5b4590(0x1ff)]['from_prod_qty']],_0x3914be=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1d4)]],_0x143013=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x250)]],_0x596930=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1ea)]],_0x13966c=[..._0x29ab40['body'][_0x5b4590(0x1cc)]],_0x664611=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x25b)]],_0x5ed235=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x1d8)]],_0x517d15=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x27c)]],_0x834216=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x210)]],_0x190328=[..._0x29ab40['body']['secondary_code']],_0x1b3add=[..._0x29ab40['body'][_0x5b4590(0x26b)]],_0x5d1e55=[..._0x29ab40[_0x5b4590(0x1ff)]['MaxStocks_data2']],_0x3c8b5e=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x21d)]],_0x531c2d=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x27e)]],_0x6e9be6=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x294)]],_0x4f334f=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x26f)]],_0x367a67=[..._0x29ab40['body'][_0x5b4590(0x21b)]],_0x448e91=[..._0x29ab40[_0x5b4590(0x1ff)][_0x5b4590(0x204)]];const _0x5caace=_0x1d7081[_0x5b4590(0x1e2)](_0x5725e9=>{return _0x5725e9={'product_name':_0x5725e9};});_0xb0207c[_0x5b4590(0x285)]((_0xc04d0d,_0x4bf60e)=>{var _0x305fbf=_0x5b4590;_0x5caace[_0x4bf60e][_0x305fbf(0x277)]=_0xc04d0d;}),_0x3914be['forEach']((_0x430a2f,_0x5d38a2)=>{var _0x3193b9=_0x5b4590;_0x5caace[_0x5d38a2][_0x3193b9(0x290)]=_0x430a2f;}),_0x143013[_0x5b4590(0x285)]((_0x42a0be,_0x1bc226)=>{var _0x36c357=_0x5b4590;_0x5caace[_0x1bc226][_0x36c357(0x220)]=_0x42a0be;}),_0x596930[_0x5b4590(0x285)]((_0x1150e1,_0x4863a3)=>{_0x5caace[_0x4863a3]['from_floorlevel']=_0x1150e1;}),_0x13966c[_0x5b4590(0x285)]((_0xab57bd,_0x39c42f)=>{_0x5caace[_0x39c42f]['to_quantity']=_0xab57bd;}),_0x664611[_0x5b4590(0x285)]((_0x3ba906,_0x5321b1)=>{var _0x1859c9=_0x5b4590;_0x5caace[_0x5321b1][_0x1859c9(0x22b)]=_0x3ba906;}),_0x5ed235['forEach']((_0x9b4da,_0x1b5fac)=>{var _0x221e9a=_0x5b4590;_0x5caace[_0x1b5fac][_0x221e9a(0x226)]=_0x9b4da;}),_0x517d15[_0x5b4590(0x285)]((_0x470736,_0x5466cb)=>{var _0x11d76b=_0x5b4590;_0x5caace[_0x5466cb][_0x11d76b(0x200)]=_0x470736;}),_0x834216['forEach']((_0x1742f3,_0xf77ac5)=>{var _0x1cccc3=_0x5b4590;_0x5caace[_0xf77ac5][_0x1cccc3(0x210)]=_0x1742f3;}),_0x190328[_0x5b4590(0x285)]((_0x32d0dc,_0xfe7a36)=>{_0x5caace[_0xfe7a36]['secondary_code']=_0x32d0dc;}),_0x1b3add['forEach']((_0x2f0a91,_0x1a98f4)=>{var _0x5728eb=_0x5b4590;_0x5caace[_0x1a98f4][_0x5728eb(0x243)]=_0x2f0a91;}),_0x5d1e55['forEach']((_0x14fb55,_0x370f17)=>{var _0x40e58d=_0x5b4590;_0x5caace[_0x370f17][_0x40e58d(0x23e)]=_0x14fb55;}),_0x3c8b5e[_0x5b4590(0x285)]((_0x55824a,_0x1353fe)=>{var _0x208a9a=_0x5b4590;_0x5caace[_0x1353fe][_0x208a9a(0x21d)]=_0x55824a;}),_0x531c2d['forEach']((_0x384845,_0x2cbdee)=>{_0x5caace[_0x2cbdee]['secondary_unit']=_0x384845;}),_0x6e9be6[_0x5b4590(0x285)]((_0xf6760b,_0x298732)=>{var _0x587ed6=_0x5b4590;_0x5caace[_0x298732][_0x587ed6(0x294)]=_0xf6760b;}),_0x4f334f['forEach']((_0x1209da,_0x501f2c)=>{_0x5caace[_0x501f2c]['expiry_date']=_0x1209da;}),_0x2aed67['forEach']((_0x4e29d8,_0x20a715)=>{var _0x1a547c=_0x5b4590;_0x5caace[_0x20a715][_0x1a547c(0x289)]=_0x4e29d8;}),_0x1768ae[_0x5b4590(0x285)]((_0x570421,_0x13261d)=>{var _0x332ff3=_0x5b4590;_0x5caace[_0x13261d][_0x332ff3(0x1a5)]=_0x570421;}),_0x7d22b7['forEach']((_0x193862,_0x211d61)=>{var _0x104ec8=_0x5b4590;_0x5caace[_0x211d61][_0x104ec8(0x25a)]=_0x193862;}),_0x2608ea['forEach']((_0xc889ba,_0x2ac467)=>{_0x5caace[_0x2ac467]['to_types']=_0xc889ba;}),_0x367a67[_0x5b4590(0x285)]((_0x178ea7,_0x5c2508)=>{_0x5caace[_0x5c2508]['from_storage']=_0x178ea7;}),_0x448e91[_0x5b4590(0x285)]((_0x336ad4,_0x3a3f04)=>{_0x5caace[_0x3a3f04]['from_rack']=_0x336ad4;});const _0x6a28bb=_0x5caace['filter'](_0x1ae499=>_0x1ae499[_0x5b4590(0x291)]!=='0'&&_0x1ae499[_0x5b4590(0x291)]!==''||_0x1ae499[_0x5b4590(0x200)]!=='0'&&_0x1ae499[_0x5b4590(0x200)]!=='');var _0xfad95d=0x0;_0x6a28bb['forEach'](_0x350827=>{var _0x5e138d=_0x5b4590;parseInt(_0x350827[_0x5e138d(0x277)])<parseInt(_0x350827[_0x5e138d(0x291)])&&_0xfad95d++;});if(_0xfad95d!=0x0)return _0x29ab40['flash'](_0x5b4590(0x1ae),_0x5b4590(0x246)),_0x1333be[_0x5b4590(0x228)]('back');const _0x34b7cf=await warehouse['findOne']({'name':_0x25f20c[_0x5b4590(0x22f)],'room':_0x25f20c[_0x5b4590(0x296)]});_0x25f20c[_0x5b4590(0x1a6)]['forEach'](_0x571d0d=>{var _0x5a3cb8=_0x5b4590;if(_0x571d0d[_0x5a3cb8(0x291)]>0x0){const _0x11ad51=_0x34b7cf[_0x5a3cb8(0x224)][_0x5a3cb8(0x1e2)](_0x303051=>{var _0x2e1db7=_0x5a3cb8;_0x303051[_0x2e1db7(0x278)]==_0x571d0d[_0x2e1db7(0x278)]&&_0x303051['floorlevel']==_0x571d0d[_0x2e1db7(0x1e3)]&&_0x303051['type']==_0x571d0d[_0x2e1db7(0x25a)]&&_0x303051[_0x2e1db7(0x21f)]==_0x571d0d[_0x2e1db7(0x220)]&&_0x303051['bay']==_0x571d0d[_0x2e1db7(0x290)]&&_0x303051['rack']==_0x571d0d[_0x2e1db7(0x23a)]&&_0x303051[_0x2e1db7(0x289)]==_0x571d0d[_0x2e1db7(0x21b)]&&(_0x303051[_0x2e1db7(0x22e)]=parseInt(_0x303051[_0x2e1db7(0x22e)])+parseInt(_0x571d0d['to_quantity']));});}}),await _0x34b7cf['save']();const _0x1d6a70=await warehouse[_0x5b4590(0x202)]({'name':_0x25f20c[_0x5b4590(0x1ce)],'room':_0x25f20c['to_room']});_0x25f20c[_0x5b4590(0x1a6)][_0x5b4590(0x285)](_0x4d72ea=>{var _0x42697b=_0x5b4590;if(_0x4d72ea[_0x42697b(0x291)]>0x0){const _0x1a3175=_0x1d6a70[_0x42697b(0x224)][_0x42697b(0x1e2)](_0x5e7514=>{var _0x190d39=_0x42697b;_0x5e7514[_0x190d39(0x278)]==_0x4d72ea[_0x190d39(0x278)]&&_0x5e7514['floorlevel']==_0x4d72ea['to_floorlevel']&&_0x5e7514['type']==_0x4d72ea[_0x190d39(0x1fc)]&&_0x5e7514['bin']==_0x4d72ea[_0x190d39(0x226)]&&_0x5e7514[_0x190d39(0x1cf)]==_0x4d72ea[_0x190d39(0x22b)]&&_0x5e7514['rack']==_0x4d72ea[_0x190d39(0x1a5)]&&_0x5e7514[_0x190d39(0x289)]==_0x4d72ea[_0x190d39(0x289)]&&(_0x5e7514['product_stock']=parseInt(_0x5e7514[_0x190d39(0x22e)])-parseInt(_0x4d72ea['to_quantity']));});}}),await _0x1d6a70[_0x5b4590(0x247)](),_0x25f20c[_0x5b4590(0x293)]=_0x217455,_0x25f20c[_0x5b4590(0x22f)]=_0x438a9c,_0x25f20c[_0x5b4590(0x1ce)]=_0x58938b,_0x25f20c['product']=_0x6a28bb,_0x25f20c[_0x5b4590(0x1d0)]=_0x554389,_0x25f20c[_0x5b4590(0x1c4)]=_0x9b9286;const _0x1a61ed=await _0x25f20c['save']();console['log'](_0x1a61ed);const _0x17aa02=await warehouse[_0x5b4590(0x202)]({'name':_0x438a9c,'room':_0x1f450d});_0x1a61ed[_0x5b4590(0x1a6)]['forEach'](_0x6c0a09=>{var _0x4c57ba=_0x5b4590;if(_0x6c0a09[_0x4c57ba(0x291)]>0x0){const _0x4761e7=_0x17aa02[_0x4c57ba(0x224)][_0x4c57ba(0x1e2)](_0x11f345=>{var _0x5468f6=_0x4c57ba;_0x11f345[_0x5468f6(0x278)]==_0x6c0a09['product_name']&&_0x11f345[_0x5468f6(0x1f9)]==_0x6c0a09[_0x5468f6(0x1e3)]&&_0x11f345[_0x5468f6(0x24e)]==_0x6c0a09['from_types']&&_0x11f345['bin']==_0x6c0a09[_0x5468f6(0x220)]&&_0x11f345[_0x5468f6(0x1cf)]==_0x6c0a09[_0x5468f6(0x290)]&&_0x11f345['rack']==_0x6c0a09[_0x5468f6(0x23a)]&&_0x11f345[_0x5468f6(0x289)]==_0x6c0a09[_0x5468f6(0x21b)]&&(_0x11f345['product_stock']=parseInt(_0x11f345[_0x5468f6(0x22e)])-parseInt(_0x6c0a09['to_quantity']));});}}),await _0x17aa02[_0x5b4590(0x247)]();const _0x223a0a=await warehouse[_0x5b4590(0x202)]({'name':_0x58938b,'room':_0x59ba15});_0x1a61ed['product'][_0x5b4590(0x285)](_0xcb197f=>{var _0x51da6e=_0x5b4590;if(_0xcb197f[_0x51da6e(0x291)]>0x0){var _0x25ad2f=0x0;const _0x406de5=_0x223a0a[_0x51da6e(0x224)][_0x51da6e(0x1e2)](_0x291e5b=>{var _0x1ef9e5=_0x51da6e;_0x291e5b[_0x1ef9e5(0x278)]==_0xcb197f[_0x1ef9e5(0x278)]&&_0x291e5b[_0x1ef9e5(0x1f9)]==_0xcb197f[_0x1ef9e5(0x200)]&&_0x291e5b[_0x1ef9e5(0x24e)]==_0xcb197f[_0x1ef9e5(0x1fc)]&&_0x291e5b[_0x1ef9e5(0x21f)]==_0xcb197f[_0x1ef9e5(0x226)]&&_0x291e5b[_0x1ef9e5(0x1cf)]==_0xcb197f['to_bay']&&_0x291e5b[_0x1ef9e5(0x1a5)]==_0xcb197f[_0x1ef9e5(0x1a5)]&&_0x291e5b[_0x1ef9e5(0x289)]==_0xcb197f['storage']&&(_0x291e5b[_0x1ef9e5(0x22e)]=parseInt(_0x291e5b[_0x1ef9e5(0x22e)])+parseInt(_0xcb197f[_0x1ef9e5(0x291)]),_0x25ad2f++);});_0x25ad2f=='0'&&(_0x223a0a[_0x51da6e(0x224)]=_0x223a0a[_0x51da6e(0x224)][_0x51da6e(0x23b)]({'product_name':_0xcb197f['product_name'],'product_stock':_0xcb197f[_0x51da6e(0x291)],'bay':_0xcb197f['to_bay'],'bin':_0xcb197f['to_bin'],'type':_0xcb197f['to_types'],'floorlevel':_0xcb197f[_0x51da6e(0x200)],'storage':_0xcb197f[_0x51da6e(0x289)],'rack':_0xcb197f[_0x51da6e(0x1a5)],'product_code':_0xcb197f[_0x51da6e(0x243)],'primary_code':_0xcb197f['primary_code'],'secondary_code':_0xcb197f[_0x51da6e(0x212)],'maxProducts':_0xcb197f['maxProducts'],'storage':_0xcb197f[_0x51da6e(0x289)],'rack':_0xcb197f[_0x51da6e(0x1a5)]}));}}),await _0x223a0a[_0x5b4590(0x247)](),_0x29ab40[_0x5b4590(0x1d9)](_0x5b4590(0x1e5),_0x5b4590(0x239)),_0x1333be[_0x5b4590(0x228)]('/transfer/view');}catch(_0x4f0d36){console[_0x5b4590(0x264)](_0x4f0d36);}}),router[a0_0x449360(0x216)](a0_0x449360(0x1f2),async(_0x404202,_0x58fb01)=>{var _0x15f112=a0_0x449360;const {FromWareHouse:_0x3fceda,FromRoom:_0x2c6aeb,ToWarehouse:_0x3b86b3,ToRoom:_0x33d513,primary_code:_0x37fe85,Roomslist:_0x229f9a}=_0x404202[_0x15f112(0x1ff)],_0x26411b=_0x229f9a[_0x15f112(0x1e4)](','),_0x5cba02=[];async function _0x576914(_0x4d5934){var _0x4ded9e=_0x15f112;const _0x30edbc=await warehouse[_0x4ded9e(0x1bb)]([{'$match':{'name':_0x3fceda,'room':_0x4d5934}},{'$unwind':_0x4ded9e(0x23f)},{'$match':{'product_details.primary_code':_0x37fe85}},{'$group':{'_id':_0x4ded9e(0x1c5),'name':{'$first':_0x4ded9e(0x227)},'instock':{'$first':_0x4ded9e(0x253)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4ded9e(0x1b7)},'product_code':{'$first':_0x4ded9e(0x254)},'level':{'$first':_0x4ded9e(0x252)},'isle':{'$first':_0x4ded9e(0x26d)},'type':{'$first':_0x4ded9e(0x281)},'pallet':{'$first':_0x4ded9e(0x22a)},'unit':{'$first':_0x4ded9e(0x24a)},'secondary_unit':{'$first':_0x4ded9e(0x219)},'storage':{'$first':_0x4ded9e(0x27a)},'rack':{'$first':_0x4ded9e(0x1e1)},'expiry_date':{'$first':_0x4ded9e(0x1d2)},'production_date':{'$first':_0x4ded9e(0x1da)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x4ded9e(0x292)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x4ded9e(0x1ef)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x4ded9e(0x24c)}}}]),_0x2fc712=await warehouse['aggregate']([{'$match':{'name':_0x3fceda,'room':_0x4d5934}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x37fe85}},{'$group':{'_id':_0x4ded9e(0x1c5),'name':{'$first':_0x4ded9e(0x227)},'instock':{'$first':_0x4ded9e(0x253)},'primary_code':{'$first':_0x4ded9e(0x217)},'secondary_code':{'$first':_0x4ded9e(0x1b7)},'product_code':{'$first':_0x4ded9e(0x254)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4ded9e(0x26d)},'type':{'$first':_0x4ded9e(0x281)},'pallet':{'$first':_0x4ded9e(0x22a)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4ded9e(0x219)},'storage':{'$first':_0x4ded9e(0x27a)},'rack':{'$first':_0x4ded9e(0x1e1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4ded9e(0x1d5)},'maxPerUnit':{'$first':_0x4ded9e(0x292)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x4ded9e(0x24c)}}}]);if(_0x30edbc[_0x4ded9e(0x260)]>0x0)_0x5cba02['push'](_0x30edbc);else _0x2fc712[_0x4ded9e(0x260)]>0x0&&_0x5cba02['push'](_0x2fc712);}const _0x348c4c=_0x26411b[_0x15f112(0x1e2)](_0x8e5af9=>_0x576914(_0x8e5af9));await Promise['all'](_0x348c4c),_0x58fb01[_0x15f112(0x26c)](_0x5cba02);}),router['post'](a0_0x449360(0x1b5),async(_0x4fcf03,_0x1c33ec)=>{var _0x194924=a0_0x449360;try{const {FromWareHouse:_0x5d35b7,FromRoom:_0x59dee5,ToWarehouse:_0x2d5804,ToRoom:_0x22d014,secondary_code:_0x2b924b}=_0x4fcf03[_0x194924(0x1ff)],_0x263f82=await warehouse[_0x194924(0x1bb)]([{'$match':{'name':_0x5d35b7}},{'$unwind':_0x194924(0x23f)},{'$match':{'product_details.secondary_code':_0x2b924b}},{'$group':{'_id':_0x194924(0x1c5),'name':{'$first':_0x194924(0x227)},'primary_code':{'$first':_0x194924(0x217)},'secondary_code':{'$first':_0x194924(0x1b7)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x194924(0x27b)},'level':{'$first':_0x194924(0x1bf)},'isle':{'$first':_0x194924(0x251)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x194924(0x28e)},'unit':{'$first':_0x194924(0x24a)}}}]);_0x1c33ec[_0x194924(0x280)](0xc8)[_0x194924(0x26c)](_0x263f82);}catch(_0x1b03c3){_0x1c33ec[_0x194924(0x280)](0x194)[_0x194924(0x26c)]({'message':_0x1b03c3['message']});}}),router[a0_0x449360(0x216)](a0_0x449360(0x20a),async(_0x43ba17,_0x4d0ac4)=>{var _0x363391=a0_0x449360;try{const {FromWareHouse:_0x2e075e,FromRoom:_0x2f9521,ToWarehouse:_0x17892b,ToRoom:_0x1d1d50,product_code:_0x6399b1}=_0x43ba17[_0x363391(0x1ff)],_0x49254d=await warehouse[_0x363391(0x1bb)]([{'$match':{'name':_0x2e075e}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x6399b1}},{'$group':{'_id':_0x363391(0x1c5),'name':{'$first':_0x363391(0x227)},'primary_code':{'$first':_0x363391(0x217)},'secondary_code':{'$first':_0x363391(0x1b7)},'product_code':{'$first':_0x363391(0x254)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x363391(0x27b)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x363391(0x251)},'pallet':{'$first':_0x363391(0x1b2)},'maxProducts':{'$first':_0x363391(0x28e)},'unit':{'$first':_0x363391(0x24a)}}}]);_0x4d0ac4[_0x363391(0x280)](0xc8)[_0x363391(0x26c)](_0x49254d);}catch(_0x5332dd){_0x4d0ac4['status'](0x194)[_0x363391(0x26c)]({'message':_0x5332dd[_0x363391(0x1c6)]});}}),router[a0_0x449360(0x216)](a0_0x449360(0x282),async(_0x1c315f,_0x199cc2)=>{var _0x67785=a0_0x449360;const {level:_0x38d7a6,isle:_0x459f8d,pallet:_0x52922d,warehouses:_0x2b0e66,room:_0x4d1768}=_0x1c315f[_0x67785(0x1ff)];try{const _0x68082a=await warehouse['aggregate']([{'$match':{'name':_0x2b0e66,'room':_0x4d1768}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x38d7a6),'product_details.isle':_0x459f8d,'product_details.pallet':parseInt(_0x52922d)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x67785(0x227)},'product_stock':{'$first':_0x67785(0x253)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x67785(0x251)},'pallet':{'$first':_0x67785(0x1b2)},'maxProducts':{'$first':_0x67785(0x28e)}}}]);_0x199cc2['status'](0xc8)[_0x67785(0x26c)](_0x68082a);}catch(_0x291423){_0x199cc2[_0x67785(0x280)](0x194)['json']({'message':_0x291423[_0x67785(0x1c6)]});}}),module[a0_0x449360(0x24b)]=router;