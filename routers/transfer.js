var a0_0x91de44=a0_0x1306;(function(_0x243dd1,_0x19eb41){var _0x25bb79=a0_0x1306,_0x269fa0=_0x243dd1();while(!![]){try{var _0x148c0f=-parseInt(_0x25bb79(0x1d7))/0x1*(-parseInt(_0x25bb79(0x210))/0x2)+parseInt(_0x25bb79(0x23d))/0x3+-parseInt(_0x25bb79(0x14c))/0x4*(parseInt(_0x25bb79(0x211))/0x5)+parseInt(_0x25bb79(0x220))/0x6+parseInt(_0x25bb79(0x1a5))/0x7*(-parseInt(_0x25bb79(0x23e))/0x8)+-parseInt(_0x25bb79(0x16e))/0x9*(parseInt(_0x25bb79(0x20c))/0xa)+parseInt(_0x25bb79(0x1ad))/0xb;if(_0x148c0f===_0x19eb41)break;else _0x269fa0['push'](_0x269fa0['shift']());}catch(_0x210f41){_0x269fa0['push'](_0x269fa0['shift']());}}}(a0_0x4f8e,0x8a4f4));const express=require(a0_0x91de44(0x15f)),app=express(),router=express[a0_0x91de44(0x226)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x91de44(0x1b4)),users=require(a0_0x91de44(0x1cb)),nodemailer=require(a0_0x91de44(0x152));router[a0_0x91de44(0x229)](a0_0x91de44(0x20d),auth,async(_0x416c15,_0x42d550)=>{var _0x249991=a0_0x91de44;try{const {username:_0x29ede7,email:_0x560d45,role:_0x3e96dd}=_0x416c15[_0x249991(0x161)],_0xf5bec0=_0x416c15[_0x249991(0x161)],_0x12784d=await profile[_0x249991(0x1ca)]({'email':_0xf5bec0['email']}),_0x45fccc=await master_shop[_0x249991(0x227)]();console[_0x249991(0x156)]('master',_0x45fccc);let _0x3e39ca;if(_0xf5bec0[_0x249991(0x20b)]=='staff'){const _0x4108d2=await staff['findOne']({'email':_0xf5bec0[_0x249991(0x177)]});_0x3e39ca=await transfers['find']({'from_warehouse':_0x4108d2['warehouse']});}else _0x3e39ca=await transfers['aggregate']([{'$unwind':_0x249991(0x159)},{'$group':{'_id':'$_id','invoice':{'$first':_0x249991(0x238)},'date':{'$first':_0x249991(0x1a7)},'from_warehouse':{'$first':_0x249991(0x187)},'to_warehouse':{'$first':_0x249991(0x23b)},'from_room_name':{'$addToSet':_0x249991(0x1ec)},'to_room_name':{'$addToSet':_0x249991(0x183)},'finalize':{'$first':_0x249991(0x209)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x45fccc[0x0][_0x249991(0x185)]==_0x249991(0x20a)){var _0x32d923=users['English'];console['log'](_0x32d923);}else{if(_0x45fccc[0x0]['language']=='Hindi')var _0x32d923=users['Hindi'];else{if(_0x45fccc[0x0]['language']==_0x249991(0x22a))var _0x32d923=users[_0x249991(0x22a)];else{if(_0x45fccc[0x0][_0x249991(0x185)]=='Spanish')var _0x32d923=users[_0x249991(0x1d6)];else{if(_0x45fccc[0x0]['language']==_0x249991(0x15a))var _0x32d923=users[_0x249991(0x15a)];else{if(_0x45fccc[0x0][_0x249991(0x185)]==_0x249991(0x212))var _0x32d923=users['Portuguese'];else{if(_0x45fccc[0x0][_0x249991(0x185)]==_0x249991(0x204))var _0x32d923=users[_0x249991(0x204)];else{if(_0x45fccc[0x0][_0x249991(0x185)]=='Arabic\x20(ae)')var _0x32d923=users[_0x249991(0x18e)];}}}}}}}_0x42d550[_0x249991(0x1d4)](_0x249991(0x228),{'success':_0x416c15[_0x249991(0x1b1)](_0x249991(0x18a)),'errors':_0x416c15[_0x249991(0x1b1)](_0x249991(0x21c)),'role':_0xf5bec0,'profile':_0x12784d,'master_shop':_0x45fccc,'transfer':_0x3e39ca,'language':_0x32d923});}catch(_0x3d11ce){console[_0x249991(0x156)](_0x3d11ce);}});async function getRandom8DigitNumber(){var _0x426dd9=a0_0x91de44;const _0x38da46=0x989680,_0x423e95=0x5f5e0ff,_0xe40809=Math[_0x426dd9(0x16a)](Math[_0x426dd9(0x1c3)]()*(_0x423e95-_0x38da46+0x1))+_0x38da46;var _0x3714a7;const _0x3cb884=await transfers['findOne']({'invoice':_0x426dd9(0x22c)+_0xe40809});return _0x3cb884&&_0x3cb884['length']>0x0?_0x3714a7='TRF-'+_0xe40809:_0x3714a7=_0x426dd9(0x22c)+_0xe40809,_0x3714a7;}router[a0_0x91de44(0x229)](a0_0x91de44(0x1ee),auth,async(_0x91ea1f,_0x598d32)=>{var _0xcf1bd3=a0_0x91de44;try{const {username:_0x2106c0,email:_0x5b16db,role:_0x5dce7d}=_0x91ea1f[_0xcf1bd3(0x161)],_0x302db4=_0x91ea1f[_0xcf1bd3(0x161)],_0xce9c26=await profile[_0xcf1bd3(0x1ca)]({'email':_0x302db4['email']}),_0x2e1052=await master_shop['find']();console[_0xcf1bd3(0x156)]('master',_0x2e1052);let _0x46ce56;if(_0x302db4[_0xcf1bd3(0x20b)]==_0xcf1bd3(0x154)){const _0x2c5b3e=await staff[_0xcf1bd3(0x1ca)]({'email':_0x302db4[_0xcf1bd3(0x177)]});_0x46ce56=await warehouse[_0xcf1bd3(0x181)]([{'$match':{'status':_0xcf1bd3(0x1e0),'name':_0x2c5b3e[_0xcf1bd3(0x1b7)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0xcf1bd3(0x14f),'name':{'$first':'$name'}}}]);}else _0x46ce56=await warehouse[_0xcf1bd3(0x181)]([{'$match':{'status':_0xcf1bd3(0x1e0),'warehouse_category':_0xcf1bd3(0x165)}},{'$group':{'_id':_0xcf1bd3(0x14f),'name':{'$first':_0xcf1bd3(0x14f)}}}]);var _0x342658=[_0xcf1bd3(0x153),_0xcf1bd3(0x1c2),_0xcf1bd3(0x23f)];const _0x5665e9=await transfers[_0xcf1bd3(0x227)]({}),_0x1d493e=_0x5665e9[_0xcf1bd3(0x1bc)]+0x1,_0x23df66='TRF-'+_0x1d493e[_0xcf1bd3(0x189)]()['padStart'](0x5,'0');if(_0x2e1052[0x0][_0xcf1bd3(0x185)]==_0xcf1bd3(0x20a)){var _0x18811f=users[_0xcf1bd3(0x19b)];console['log'](_0x18811f);}else{if(_0x2e1052[0x0][_0xcf1bd3(0x185)]==_0xcf1bd3(0x1a9))var _0x18811f=users[_0xcf1bd3(0x1a9)];else{if(_0x2e1052[0x0][_0xcf1bd3(0x185)]=='German')var _0x18811f=users[_0xcf1bd3(0x22a)];else{if(_0x2e1052[0x0][_0xcf1bd3(0x185)]==_0xcf1bd3(0x1d6))var _0x18811f=users['Spanish'];else{if(_0x2e1052[0x0]['language']==_0xcf1bd3(0x15a))var _0x18811f=users[_0xcf1bd3(0x15a)];else{if(_0x2e1052[0x0][_0xcf1bd3(0x185)]==_0xcf1bd3(0x212))var _0x18811f=users[_0xcf1bd3(0x1aa)];else{if(_0x2e1052[0x0]['language']==_0xcf1bd3(0x204))var _0x18811f=users[_0xcf1bd3(0x204)];else{if(_0x2e1052[0x0]['language']==_0xcf1bd3(0x1be))var _0x18811f=users[_0xcf1bd3(0x18e)];}}}}}}}const _0x411a13=getRandom8DigitNumber();_0x411a13['then'](_0x3ae2a5=>{var _0x949686=_0xcf1bd3;_0x598d32[_0x949686(0x1d4)]('add_transfer',{'success':_0x91ea1f[_0x949686(0x1b1)](_0x949686(0x18a)),'errors':_0x91ea1f[_0x949686(0x1b1)](_0x949686(0x21c)),'role':_0x302db4,'profile':_0xce9c26,'master_shop':_0x2e1052,'warehouse':_0x46ce56,'language':_0x18811f,'rooms_data':_0x342658,'invoice':_0x3ae2a5});})[_0xcf1bd3(0x1ab)](_0x383f78=>{var _0x2f64f3=_0xcf1bd3;_0x91ea1f[_0x2f64f3(0x1b1)](_0x2f64f3(0x21c),_0x2f64f3(0x225)),_0x598d32['redirect']('/transfer/view');});}catch(_0x46c4af){console['log'](_0x46c4af);}}),router[a0_0x91de44(0x1e8)]('/view/add_transfer',auth,async(_0x3f0d2b,_0x55e6d2)=>{var _0x20323d=a0_0x91de44;try{console[_0x20323d(0x156)](_0x3f0d2b['body']);const {date:_0x4c2437,from_warehouse:_0x5db48e,FromRoom_name:_0x5e3860,to_warehouse:_0xec63d8,ToRoom_name:_0x3a54aa,prod_name:_0x2ffbee,from_prod_qty:_0x5bc5f5,from_prod_level:_0x27857d,from_prod_isle:_0x502355,from_prod_pallet:_0x4dc792,to_prod_qty:_0xbc0af3,to_prod_level:_0x5e2295,to_prod_isle:_0x27edb3,to_prod_pallet:_0x219d9b,primary_code:_0x1b2253,secondary_code:_0x50b86b,product_code3:_0x1c8765,note:_0x445fb2,MaxStocks_data2:_0x14d8e4,invoice:_0x4a47b1,expiry_date:_0x55707d}=_0x3f0d2b['body'];if(typeof _0x2ffbee=='string')var _0xb9ea2a=[_0x3f0d2b['body']['prod_name']],_0x5ecc62=[_0x3f0d2b['body'][_0x20323d(0x1b2)]],_0x1b1012=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1b0)]],_0xb4751b=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1a4)]],_0x39d58e=[_0x3f0d2b[_0x20323d(0x224)]['to_prod_level']],_0x119452=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1f1)]],_0x36f76f=[_0x3f0d2b[_0x20323d(0x224)]['secondary_code']],_0x2f6fe2=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x167)]],_0x1d6e45=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x150)]],_0x5bc807=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x16c)]],_0x274234=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1c6)]],_0x44d219=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1df)]],_0x2db852=[_0x3f0d2b['body']['expiry_date']],_0x470fed=[_0x3f0d2b['body'][_0x20323d(0x21b)]],_0x38ea1a=[_0x3f0d2b[_0x20323d(0x224)]['production_date']],_0x4abf35=[_0x3f0d2b['body'][_0x20323d(0x207)]],_0x2db00b=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1a6)]],_0x173c97=[_0x3f0d2b[_0x20323d(0x224)]['ToRoomAssigned']],_0x404c11=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x170)]],_0x5009d0=[_0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1fa)]];else var _0xb9ea2a=[..._0x3f0d2b['body'][_0x20323d(0x1b9)]],_0x5ecc62=[..._0x3f0d2b['body'][_0x20323d(0x1b2)]],_0x1b1012=[..._0x3f0d2b['body']['from_prod_level']],_0xb4751b=[..._0x3f0d2b['body'][_0x20323d(0x1a4)]],_0x39d58e=[..._0x3f0d2b[_0x20323d(0x224)]['to_prod_level']],_0x119452=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1f1)]],_0x36f76f=[..._0x3f0d2b['body'][_0x20323d(0x18c)]],_0x2f6fe2=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x167)]],_0x1d6e45=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x150)]],_0x5bc807=[..._0x3f0d2b[_0x20323d(0x224)]['primary_unit']],_0x274234=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1c6)]],_0x44d219=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1df)]],_0x2db852=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1c0)]],_0x470fed=[..._0x3f0d2b['body']['max_per_unit']],_0x38ea1a=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x1f6)]],_0x4abf35=[..._0x3f0d2b[_0x20323d(0x224)][_0x20323d(0x207)]],_0x2db00b=[..._0x3f0d2b['body']['RoomAssigned']],_0x173c97=[..._0x3f0d2b[_0x20323d(0x224)]['ToRoomAssigned']],_0x404c11=[..._0x3f0d2b['body'][_0x20323d(0x170)]],_0x5009d0=[..._0x3f0d2b['body']['to_invoice']];const _0x48404e=_0xb9ea2a[_0x20323d(0x178)](_0x425f1d=>{return _0x425f1d={'product_name':_0x425f1d};});_0x5ecc62[_0x20323d(0x171)]((_0x48d9ba,_0x1a8dac)=>{var _0x69d12e=_0x20323d;_0x48404e[_0x1a8dac][_0x69d12e(0x151)]=_0x48d9ba;}),_0x404c11[_0x20323d(0x171)]((_0x4fad31,_0x2d4662)=>{var _0x36d05e=_0x20323d;_0x48404e[_0x2d4662][_0x36d05e(0x170)]=_0x4fad31;}),_0x5009d0[_0x20323d(0x171)]((_0x5d103f,_0x5c793d)=>{var _0x3f42ee=_0x20323d;_0x48404e[_0x5c793d][_0x3f42ee(0x1b6)]=_0x5d103f;}),_0x1b1012['forEach']((_0x40d28a,_0x8bed5c)=>{_0x2db00b['forEach']((_0x280656,_0x2c7c1f)=>{var _0x566db1=a0_0x1306;if(_0x280656=='Receiving\x20Area'&&_0x8bed5c==_0x2c7c1f){var _0x47ef0d=_0x40d28a[_0x566db1(0x1f5)](0x3);_0x48404e[_0x8bed5c][_0x566db1(0x1c7)]=_0x40d28a[0x0],_0x48404e[_0x8bed5c][_0x566db1(0x1d5)]=_0x40d28a[0x1],_0x48404e[_0x8bed5c][_0x566db1(0x21d)]=0x0,_0x48404e[_0x8bed5c][_0x566db1(0x1ac)]=0x0,_0x48404e[_0x8bed5c][_0x566db1(0x1e5)]=_0x566db1(0x19a),_0x48404e[_0x8bed5c][_0x566db1(0x15b)]=_0x47ef0d;}else{if(_0x280656==_0x566db1(0x1af)&&_0x8bed5c==_0x2c7c1f){var _0x47ef0d=_0x40d28a[_0x566db1(0x1f5)](0x3);_0x48404e[_0x8bed5c]['from_storage']=_0x40d28a[0x0],_0x48404e[_0x8bed5c][_0x566db1(0x1d5)]=_0x40d28a[0x1],_0x48404e[_0x8bed5c][_0x566db1(0x21d)]=0x0,_0x48404e[_0x8bed5c][_0x566db1(0x1ac)]=0x0,_0x48404e[_0x8bed5c][_0x566db1(0x1e5)]=_0x566db1(0x19a),_0x48404e[_0x8bed5c][_0x566db1(0x15b)]=_0x40d28a[0x5];}else{if(_0x8bed5c==_0x2c7c1f){var _0x395da0;if(_0x40d28a[0x4]=='L')_0x395da0=_0x566db1(0x208);else _0x40d28a[0x4]=='F'&&(_0x395da0=_0x566db1(0x19a));_0x48404e[_0x8bed5c][_0x566db1(0x1c7)]=_0x40d28a[0x0],_0x48404e[_0x8bed5c][_0x566db1(0x1d5)]=_0x40d28a[0x1],_0x48404e[_0x8bed5c][_0x566db1(0x21d)]=_0x40d28a[0x2],_0x48404e[_0x8bed5c]['from_bin']=_0x40d28a[0x3],_0x48404e[_0x8bed5c][_0x566db1(0x1e5)]=_0x395da0,_0x48404e[_0x8bed5c]['from_floorlevel']=_0x40d28a[0x5];}}}});}),_0xb4751b['forEach']((_0x357c8b,_0x5126dd)=>{var _0x267594=_0x20323d;_0x48404e[_0x5126dd][_0x267594(0x1eb)]=_0x357c8b;}),_0x39d58e[_0x20323d(0x171)]((_0x58b8ed,_0x834d8b)=>{var _0xc888f5=_0x20323d;_0x173c97[_0xc888f5(0x171)]((_0x26ccc2,_0x3f5e7f)=>{var _0xf6b18e=_0xc888f5;if(_0x26ccc2==_0xf6b18e(0x17d)&&_0x834d8b==_0x3f5e7f){var _0x3f8990=_0x58b8ed[_0xf6b18e(0x1f5)](0x3);_0x48404e[_0x834d8b][_0xf6b18e(0x233)]=_0x58b8ed[0x0],_0x48404e[_0x834d8b]['rack']=_0x58b8ed[0x1],_0x48404e[_0x834d8b][_0xf6b18e(0x1b3)]=0x0,_0x48404e[_0x834d8b][_0xf6b18e(0x1bf)]=0x0,_0x48404e[_0x834d8b]['to_types']=_0xf6b18e(0x19a),_0x48404e[_0x834d8b][_0xf6b18e(0x1cf)]=_0x3f8990;}else{if(_0x26ccc2==_0xf6b18e(0x1af)&&_0x834d8b==_0x3f5e7f){var _0x3f8990=_0x58b8ed[_0xf6b18e(0x1f5)](0x3);_0x48404e[_0x834d8b]['storage']=_0x58b8ed[0x0],_0x48404e[_0x834d8b][_0xf6b18e(0x1db)]=_0x58b8ed[0x1],_0x48404e[_0x834d8b][_0xf6b18e(0x1b3)]=0x0,_0x48404e[_0x834d8b][_0xf6b18e(0x1bf)]=0x0,_0x48404e[_0x834d8b][_0xf6b18e(0x217)]=_0xf6b18e(0x19a),_0x48404e[_0x834d8b][_0xf6b18e(0x1cf)]=_0x58b8ed[0x5];}else{if(_0x834d8b==_0x3f5e7f){var _0x17e72b;if(_0x58b8ed[0x4]=='L')_0x17e72b=_0xf6b18e(0x208);else _0x58b8ed[0x4]=='F'&&(_0x17e72b=_0xf6b18e(0x19a));_0x48404e[_0x834d8b][_0xf6b18e(0x233)]=_0x58b8ed[0x0],_0x48404e[_0x834d8b][_0xf6b18e(0x1db)]=_0x58b8ed[0x1],_0x48404e[_0x834d8b][_0xf6b18e(0x1b3)]=_0x58b8ed[0x2],_0x48404e[_0x834d8b][_0xf6b18e(0x1bf)]=_0x58b8ed[0x3],_0x48404e[_0x834d8b][_0xf6b18e(0x217)]=_0x17e72b,_0x48404e[_0x834d8b]['to_floorlevel']=_0x58b8ed[0x5];}}}});}),_0x119452[_0x20323d(0x171)]((_0x334cc4,_0x5ba522)=>{var _0x11d1d5=_0x20323d;_0x48404e[_0x5ba522][_0x11d1d5(0x1f1)]=_0x334cc4;}),_0x36f76f[_0x20323d(0x171)]((_0x5e43d8,_0x1ad70e)=>{var _0x32b9ad=_0x20323d;_0x48404e[_0x1ad70e][_0x32b9ad(0x18c)]=_0x5e43d8;}),_0x2f6fe2['forEach']((_0x2d7ed3,_0x5063b8)=>{var _0x35bfa8=_0x20323d;_0x48404e[_0x5063b8][_0x35bfa8(0x1fe)]=_0x2d7ed3;}),_0x1d6e45[_0x20323d(0x171)]((_0x14b138,_0xd47ca2)=>{var _0x312d3b=_0x20323d;_0x48404e[_0xd47ca2][_0x312d3b(0x1d2)]=_0x14b138;}),_0x5bc807[_0x20323d(0x171)]((_0xa3af84,_0x560a6c)=>{var _0x134d74=_0x20323d;_0x48404e[_0x560a6c][_0x134d74(0x1d9)]=_0xa3af84;}),_0x274234[_0x20323d(0x171)]((_0x4fe4a6,_0x369229)=>{var _0x13d19e=_0x20323d;_0x48404e[_0x369229][_0x13d19e(0x1c6)]=_0x4fe4a6;}),_0x44d219['forEach']((_0x5a60c8,_0x3521d8)=>{var _0x35b4e6=_0x20323d;_0x48404e[_0x3521d8][_0x35b4e6(0x1df)]=_0x5a60c8;}),_0x2db852['forEach']((_0x113fa9,_0x54c4c1)=>{_0x48404e[_0x54c4c1]['expiry_date']=_0x113fa9;}),_0x470fed[_0x20323d(0x171)]((_0x3f6104,_0x3f1416)=>{var _0x26a51c=_0x20323d;_0x48404e[_0x3f1416][_0x26a51c(0x1d3)]=_0x3f6104;}),_0x38ea1a[_0x20323d(0x171)]((_0x3f9e99,_0x3904b5)=>{var _0x19b85a=_0x20323d;_0x48404e[_0x3904b5][_0x19b85a(0x1f6)]=_0x3f9e99;}),_0x4abf35['forEach']((_0x4c0aaf,_0x57ecd2)=>{_0x48404e[_0x57ecd2]['prod_cat']=_0x4c0aaf;}),_0x2db00b[_0x20323d(0x171)]((_0x2cb53c,_0x193696)=>{_0x48404e[_0x193696]['from_room_name']=_0x2cb53c;}),_0x173c97[_0x20323d(0x171)]((_0x5cab15,_0x5c6652)=>{var _0x1aef4f=_0x20323d;_0x48404e[_0x5c6652][_0x1aef4f(0x18b)]=_0x5cab15;});const _0x5c6a61=_0x48404e[_0x20323d(0x182)](_0xaf8d75=>_0xaf8d75[_0x20323d(0x1eb)]!=='0'&&_0xaf8d75[_0x20323d(0x1eb)]!==''||_0xaf8d75['to_floorlevel']!=='0'&&_0xaf8d75[_0x20323d(0x1cf)]!==''),_0x5bfe72=new transfers({'date':_0x4c2437,'from_warehouse':_0x5db48e,'to_warehouse':_0xec63d8,'product':_0x5c6a61,'note':_0x445fb2,'invoice':_0x4a47b1}),_0x52aedf=await _0x5bfe72[_0x20323d(0x17b)]();_0x3f0d2b[_0x20323d(0x1b1)](_0x20323d(0x18a),'Product\x20Transfer\x20successfully'),_0x55e6d2[_0x20323d(0x21f)]('/transfer/preview/'+_0x52aedf[_0x20323d(0x1ef)]);}catch(_0x509ea1){console[_0x20323d(0x156)](_0x509ea1),_0x55e6d2[_0x20323d(0x199)](0xc8)['json']({'errorMessage':_0x509ea1[_0x20323d(0x173)]});}}),router[a0_0x91de44(0x229)](a0_0x91de44(0x179),auth,async(_0x5b5ce4,_0x74a801)=>{var _0x27c094=a0_0x91de44;try{const {username:_0x28b209,email:_0xb5b3f9,role:_0x1b9411}=_0x5b5ce4[_0x27c094(0x161)],_0x23f30c=_0x5b5ce4['user'],_0x3f5bef=await profile[_0x27c094(0x1ca)]({'email':_0x23f30c[_0x27c094(0x177)]}),_0x1e66a9=await master_shop[_0x27c094(0x227)]();console[_0x27c094(0x156)]('master',_0x1e66a9);const _0x3e381e=await transfers[_0x27c094(0x1e1)](_0x5b5ce4[_0x27c094(0x174)]['id']);let _0x41fc8d=new Date(_0x3e381e[_0x27c094(0x1c0)]),_0x1eda50=('0'+_0x41fc8d[_0x27c094(0x172)]())[_0x27c094(0x1f5)](-0x2),_0x1968bf=('0'+(_0x41fc8d[_0x27c094(0x216)]()+0x1))['slice'](-0x2),_0x4eeff5=_0x41fc8d[_0x27c094(0x214)](),_0x28eff3=_0x4eeff5+'-'+_0x1968bf+'-'+_0x1eda50,_0x3fdf66;if(_0x23f30c[_0x27c094(0x20b)]==_0x27c094(0x154)){const _0x1089cf=await staff[_0x27c094(0x1ca)]({'email':_0x23f30c[_0x27c094(0x177)]});_0x3fdf66=await warehouse[_0x27c094(0x227)]({'status':_0x27c094(0x1e0),'name':_0x1089cf[_0x27c094(0x1b7)],'warehouse_category':_0x27c094(0x165)});}else _0x3fdf66=await warehouse[_0x27c094(0x227)]({'status':_0x27c094(0x1e0),'warehouse_category':_0x27c094(0x165)});const _0x41da8a=await warehouse['aggregate']([{'$match':{'name':_0x3e381e[_0x27c094(0x1a3)]}},{'$unwind':_0x27c094(0x14e)},{'$group':{'_id':_0x27c094(0x1cc),'name':{'$first':_0x27c094(0x169)},'product_stock':{'$first':_0x27c094(0x20e)},'bay':{'$first':_0x27c094(0x223)},'bin':{'$first':_0x27c094(0x1f2)},'type':{'$first':_0x27c094(0x195)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x27c094(0x1ff)},'secondary_code':{'$first':_0x27c094(0x194)},'product_code':{'$first':_0x27c094(0x23c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x27c094(0x15d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]);if(_0x1e66a9[0x0][_0x27c094(0x185)]=='English\x20(US)'){var _0x196f3f=users[_0x27c094(0x19b)];console['log'](_0x196f3f);}else{if(_0x1e66a9[0x0]['language']=='Hindi')var _0x196f3f=users['Hindi'];else{if(_0x1e66a9[0x0][_0x27c094(0x185)]==_0x27c094(0x22a))var _0x196f3f=users['German'];else{if(_0x1e66a9[0x0]['language']==_0x27c094(0x1d6))var _0x196f3f=users['Spanish'];else{if(_0x1e66a9[0x0][_0x27c094(0x185)]==_0x27c094(0x15a))var _0x196f3f=users['French'];else{if(_0x1e66a9[0x0][_0x27c094(0x185)]==_0x27c094(0x212))var _0x196f3f=users[_0x27c094(0x1aa)];else{if(_0x1e66a9[0x0]['language']==_0x27c094(0x204))var _0x196f3f=users['Chinese'];else{if(_0x1e66a9[0x0]['language']==_0x27c094(0x1be))var _0x196f3f=users[_0x27c094(0x18e)];}}}}}}}_0x74a801[_0x27c094(0x1d4)]('edit_transfer_view',{'success':_0x5b5ce4[_0x27c094(0x1b1)](_0x27c094(0x18a)),'errors':_0x5b5ce4[_0x27c094(0x1b1)](_0x27c094(0x21c)),'role':_0x23f30c,'profile':_0x3f5bef,'master_shop':_0x1e66a9,'warehouse':_0x3fdf66,'transfer':_0x3e381e,'stock':_0x41da8a,'language':_0x196f3f});}catch(_0x54f011){console[_0x27c094(0x156)](_0x54f011);}}),router['post'](a0_0x91de44(0x179),auth,async(_0x911aac,_0x302010)=>{var _0x3d67db=a0_0x91de44;try{const _0x2ca6af=_0x911aac['params']['id'],{from_warehouse:_0x48dc4d,FromRoom_name:_0x5e9b0f,to_warehouse:_0x661ff0,ToRoom_name:_0x13233e}=_0x911aac[_0x3d67db(0x224)],_0x15d716=await transfers[_0x3d67db(0x1e1)]({'_id':_0x2ca6af}),_0x3d910c=_0x15d716[_0x3d67db(0x19f)][_0x3d67db(0x178)](async _0x947444=>{var _0x10d416=_0x3d67db;if(_0x947444[_0x10d416(0x1eb)]>0x0){var _0x3d965e=await warehouse[_0x10d416(0x1ca)]({'name':_0x15d716[_0x10d416(0x1a3)],'room':_0x947444[_0x10d416(0x1ae)],'warehouse_category':_0x10d416(0x165)});const _0x20b711=_0x3d965e[_0x10d416(0x163)]['map'](_0x574bf8=>{var _0x5d8c79=_0x10d416;_0x574bf8[_0x5d8c79(0x1f0)]==_0x947444['product_name']&&_0x574bf8['floorlevel']==_0x947444[_0x5d8c79(0x15b)]&&_0x574bf8[_0x5d8c79(0x1c5)]==_0x947444[_0x5d8c79(0x1e5)]&&_0x574bf8[_0x5d8c79(0x196)]==_0x947444[_0x5d8c79(0x1ac)]&&_0x574bf8[_0x5d8c79(0x218)]==_0x947444[_0x5d8c79(0x21d)]&&_0x574bf8[_0x5d8c79(0x1db)]==_0x947444[_0x5d8c79(0x1d5)]&&_0x574bf8[_0x5d8c79(0x233)]==_0x947444[_0x5d8c79(0x1c7)]&&_0x574bf8[_0x5d8c79(0x1c0)]==_0x947444[_0x5d8c79(0x1c0)]&&_0x574bf8[_0x5d8c79(0x1df)]==_0x947444[_0x5d8c79(0x1df)]&&_0x574bf8[_0x5d8c79(0x1f6)]==_0x947444['production_date']&&_0x574bf8[_0x5d8c79(0x1a8)]==_0x947444[_0x5d8c79(0x170)]&&(_0x574bf8[_0x5d8c79(0x1ba)]=_0x574bf8['product_stock']-_0x947444[_0x5d8c79(0x1eb)]);});}return _0x3d965e;});Promise['all'](_0x3d910c)['then'](async _0x44607a=>{var _0x2c47a9=_0x3d67db;try{for(const _0x26d848 of _0x44607a){await _0x26d848[_0x2c47a9(0x17b)]();}try{const _0x388619=_0x15d716[_0x2c47a9(0x19f)][_0x2c47a9(0x178)](async _0x9c5c78=>{var _0x27e0d7=_0x2c47a9;if(_0x9c5c78[_0x27e0d7(0x1eb)]>0x0){var _0x325de3=await warehouse['findOne']({'name':_0x15d716[_0x27e0d7(0x19c)],'room':_0x9c5c78[_0x27e0d7(0x18b)],'warehouse_category':_0x27e0d7(0x165)}),_0x1f0726=0x0;const _0x4c185b=_0x325de3[_0x27e0d7(0x163)][_0x27e0d7(0x178)](_0x299672=>{var _0x33397d=_0x27e0d7;_0x299672[_0x33397d(0x1f0)]==_0x9c5c78['product_name']&&_0x299672['floorlevel']==_0x9c5c78[_0x33397d(0x1cf)]&&_0x299672['type']==_0x9c5c78[_0x33397d(0x217)]&&_0x299672[_0x33397d(0x196)]==_0x9c5c78[_0x33397d(0x1bf)]&&_0x299672[_0x33397d(0x218)]==_0x9c5c78['to_bay']&&_0x299672[_0x33397d(0x1db)]==_0x9c5c78[_0x33397d(0x1db)]&&_0x299672[_0x33397d(0x233)]==_0x9c5c78[_0x33397d(0x233)]&&_0x299672[_0x33397d(0x1c0)]==_0x9c5c78['expiry_date']&&_0x299672[_0x33397d(0x1df)]==_0x9c5c78['batch_code']&&_0x299672[_0x33397d(0x1f6)]==_0x9c5c78[_0x33397d(0x1f6)]&&_0x299672[_0x33397d(0x1a8)]==_0x9c5c78[_0x33397d(0x1b6)]&&(_0x299672[_0x33397d(0x1ba)]=_0x299672[_0x33397d(0x1ba)]+_0x9c5c78['to_quantity'],_0x1f0726++);});_0x1f0726=='0'&&(_0x325de3[_0x27e0d7(0x163)]=_0x325de3[_0x27e0d7(0x163)][_0x27e0d7(0x202)]({'product_name':_0x9c5c78[_0x27e0d7(0x1f0)],'product_stock':_0x9c5c78[_0x27e0d7(0x1eb)],'bay':_0x9c5c78[_0x27e0d7(0x1b3)],'bin':_0x9c5c78[_0x27e0d7(0x1bf)],'type':_0x9c5c78[_0x27e0d7(0x217)],'floorlevel':_0x9c5c78[_0x27e0d7(0x1cf)],'storage':_0x9c5c78[_0x27e0d7(0x233)],'rack':_0x9c5c78[_0x27e0d7(0x1db)],'product_code':_0x9c5c78[_0x27e0d7(0x1fe)],'primary_code':_0x9c5c78['primary_code'],'secondary_code':_0x9c5c78[_0x27e0d7(0x18c)],'maxProducts':_0x9c5c78[_0x27e0d7(0x1d2)],'storage':_0x9c5c78[_0x27e0d7(0x233)],'rack':_0x9c5c78[_0x27e0d7(0x1db)],'expiry_date':_0x9c5c78['expiry_date'],'maxPerUnit':_0x9c5c78[_0x27e0d7(0x1d3)],'batch_code':_0x9c5c78[_0x27e0d7(0x1df)],'production_date':_0x9c5c78[_0x27e0d7(0x1f6)]}));}return _0x325de3;});Promise[_0x2c47a9(0x205)](_0x388619)[_0x2c47a9(0x230)](async _0x2d80bf=>{var _0x4d378a=_0x2c47a9;try{for(const _0x3a4150 of _0x2d80bf){await warehouse[_0x4d378a(0x17e)]({'_id':_0x3a4150[_0x4d378a(0x1ef)]},{'$addToSet':{'product_details':{'$each':_0x3a4150[_0x4d378a(0x163)]}}});}_0x15d716[_0x4d378a(0x219)]=_0x4d378a(0x157);const _0x1a06e8=await _0x15d716['save'](),_0x1264df=await master_shop[_0x4d378a(0x227)](),_0x314caf=await email_settings[_0x4d378a(0x1ca)](),_0x592ece=await supervisor_settings[_0x4d378a(0x227)]();var _0x1bf88f=_0x15d716[_0x4d378a(0x19f)],_0x24665e='',_0x21ae0a;for(_0x21ae0a in _0x1bf88f){_0x24665e+='<tr>'+_0x4d378a(0x176)+_0x1bf88f[_0x21ae0a][_0x4d378a(0x1f0)]+_0x4d378a(0x164)+_0x4d378a(0x176)+_0x1bf88f[_0x21ae0a][_0x4d378a(0x1fe)]+'</td>'+_0x4d378a(0x176)+_0x1bf88f[_0x21ae0a]['to_quantity']+'</td>'+_0x4d378a(0x176)+_0x1bf88f[_0x21ae0a]['unit']+'</td>'+_0x4d378a(0x176)+_0x1bf88f[_0x21ae0a][_0x4d378a(0x1c6)]+_0x4d378a(0x164)+_0x4d378a(0x176)+_0x15d716['to_warehouse']+_0x4d378a(0x164)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1bf88f[_0x21ae0a][_0x4d378a(0x18b)]+_0x4d378a(0x164)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1bf88f[_0x21ae0a][_0x4d378a(0x233)]+_0x1bf88f[_0x21ae0a][_0x4d378a(0x1db)]+_0x1bf88f[_0x21ae0a][_0x4d378a(0x1b3)]+_0x1bf88f[_0x21ae0a]['to_bin']+_0x1bf88f[_0x21ae0a]['to_types'][0x0]+_0x1bf88f[_0x21ae0a][_0x4d378a(0x1cf)]+_0x4d378a(0x164),_0x4d378a(0x241);}let _0xb90ead=nodemailer[_0x4d378a(0x1a2)]({'host':_0x314caf['host'],'port':Number(_0x314caf[_0x4d378a(0x1e7)]),'secure':![],'auth':{'user':_0x314caf[_0x4d378a(0x177)],'pass':_0x314caf[_0x4d378a(0x237)]}}),_0x5abe15={'from':_0x314caf['email'],'to':_0x592ece[0x0]['RMSEmail'],'subject':_0x4d378a(0x184),'attachments':[{'filename':_0x4d378a(0x1d1),'path':__dirname+_0x4d378a(0x14d)+'/upload/'+_0x1264df[0x0][_0x4d378a(0x1a0)],'cid':_0x4d378a(0x1bd)}],'html':_0x4d378a(0x18f)+_0x4d378a(0x1c4)+'</head><body>'+_0x4d378a(0x201)+_0x4d378a(0x206)+'<div>'+_0x4d378a(0x22d)+_0x4d378a(0x1c9)+_0x4d378a(0x201)+_0x4d378a(0x1a1)+_0x1264df[0x0][_0x4d378a(0x22b)]+'\x20</h2>'+'</div>'+'</div>'+_0x4d378a(0x235)+_0x4d378a(0x201)+_0x4d378a(0x1f3)+_0x4d378a(0x1dd)+_0x15d716[_0x4d378a(0x1a8)]+'\x20'+_0x4d378a(0x1fc)+_0x4d378a(0x1fb)+_0x15d716[_0x4d378a(0x17f)]+'\x20'+_0x4d378a(0x23a)+_0x4d378a(0x17a)+_0x4d378a(0x1c9)+_0x4d378a(0x190)+_0x4d378a(0x1e6)+_0x4d378a(0x1e4)+_0x4d378a(0x22e)+_0x4d378a(0x1bb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x4d378a(0x240)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x4d378a(0x1f7)+_0x4d378a(0x20f)+_0x4d378a(0x241)+_0x4d378a(0x166)+_0x4d378a(0x1fd)+'\x20'+_0x24665e+'\x20'+_0x4d378a(0x1e9)+'</table>'+_0x4d378a(0x201)+_0x4d378a(0x231)+'<h5>'+_0x1264df[0x0][_0x4d378a(0x22b)]+'</h5>'+_0x4d378a(0x1c9)+'</div>'+'</body></html>'};_0xb90ead[_0x4d378a(0x213)](_0x5abe15,function(_0x2a2955,_0x3ea12f){var _0x69e600=_0x4d378a;_0x2a2955?(console[_0x69e600(0x156)](_0x2a2955),console[_0x69e600(0x156)](_0x69e600(0x22f))):console[_0x69e600(0x156)](_0x69e600(0x191));}),_0x911aac[_0x4d378a(0x1b1)]('success',_0x4d378a(0x197)),_0x302010[_0x4d378a(0x21f)](_0x4d378a(0x1f8)+_0x1a06e8[_0x4d378a(0x1ef)]);}catch(_0x35c311){console[_0x4d378a(0x236)](_0x35c311),_0x302010['status'](0x1f4)[_0x4d378a(0x1e2)]({'Perror':_0x4d378a(0x1c8),'message':_0x35c311[_0x4d378a(0x173)]});}})[_0x2c47a9(0x1ab)](_0x14c16b=>{var _0x33f960=_0x2c47a9;console[_0x33f960(0x236)](_0x14c16b),_0x302010[_0x33f960(0x199)](0x1f4)[_0x33f960(0x1e2)]({'Perror':_0x33f960(0x18d)});});}catch(_0x495f6b){_0x302010[_0x2c47a9(0x1e2)](_0x495f6b);}}catch(_0x1528a6){console['error'](_0x1528a6),_0x302010[_0x2c47a9(0x199)](0x1f4)[_0x2c47a9(0x1e2)]({'Merror':_0x2c47a9(0x1c8),'Message':_0x1528a6['message']});}})['catch'](_0x4b49e8=>{var _0x37d1b2=_0x3d67db;console[_0x37d1b2(0x236)](_0x4b49e8),_0x302010['status'](0x1f4)['json']({'Merror':_0x37d1b2(0x18d)});});}catch(_0x1e1366){console[_0x3d67db(0x156)](_0x1e1366);}});function a0_0x4f8e(){var _0x5da6af=['$product_details.pallet','to_floorlevel','rak','Logo.png','maxProducts','maxperunit','render','from_rack','Spanish','91350nQgETV','floorlevel','unit','/barcode_scanner','rack','from_prod_isle','\x20Order\x20Number\x20:\x20','to_prod_qty','batch_code','Enabled','findById','json','Rack\x20D','<tr>','from_types','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','port','post','</tbody>','$product_details.expiry_date','to_quantity','$product.from_room_name','$product_details.production_date','/view/add_transfer','_id','product_name','primary_code','$product_details.bin','<h5\x20style=\x22text-align:\x20left;\x22>','from_room','slice','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/picking_list/PDF_transfer_rm/','COLD\x20STORAGE','to_invoice','\x20Order\x20Date\x20:\x20','<span\x20style=\x22float:\x20right;\x22>','<tbody\x20style=\x22text-align:\x20center;\x22>','product_code','$product_details.primary_code','$product_details.batch_code','<div>','concat','note','Chinese','all','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','prod_cat','Level','$finalize','English\x20(US)','role','189710BcEdGI','/view','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','10bIkzKO','5lgbjMT','Portuguese\x20(BR)','sendMail','getFullYear','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','getMonth','to_types','bay','finalize','to_room','max_per_unit','errors','from_bay','back','redirect','4817286FKGunx','$product_details.floorlevel','$product_details.maxPerUnit','$product_details.bay','body','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Router','find','transfer','get','German','site_title','TRF-','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Error\x20Occurs','then','<strong>\x20Regards\x20</strong>','$product_details.maxProducts','storage','$product_details.storage','<hr\x20class=\x22my-3\x22>','error','password','$invoice','from_rak','</span>','$to_warehouse','$product_details.product_code','1069863yTNKbZ','4528knjFla','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</tr>','4252748PboRvm','/../public','$product_details','$name','MaxStocks_data2','from_quantity','nodemailer','Ambient','staff','/transfer/view','log','True','Rack\x20C','$product','French','from_floorlevel','string','$product_details.rack','split','express','to_prod_level','user','$product_details.level','product_details','</td>','Raw\x20Materials','</thead>','product_code3','$room','$product_details.product_name','floor','from_prod_pallet','primary_unit','/view/:id','333iXiDvH','/barcode_scanner3','from_invoice','forEach','getDate','message','params','Rack\x20B','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','email','map','/preview/:id','</h5>','save','$product_details.unit','Receiving\x20Area','updateOne','date','to_prod_isle','aggregate','filter','$product.to_room_name','Transfer\x20Mail','language','$product_details.secondary_unit','$from_warehouse','Rack\x20E','toString','success','to_room_name','secondary_code','An\x20error\x20occurred.','Arabic','<!DOCTYPE\x20html>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Email\x20sent\x20successfully','/barcode_scanner2','$product_details.isle','$product_details.secondary_code','$product_details.type','bin','Transfer\x20Finalize\x20Successfully','push','status','Floor','English','to_warehouse','DRY\x20STORAGE','Rack\x20F','product','image','<h2>\x20','createTransport','from_warehouse','New_Qty_Converted','1624KHBpVV','RoomAssigned','$date','invoice','Hindi','Portuguese','catch','from_bin','9313590lCSlfk','from_room_name','Shelves','from_prod_level','flash','from_prod_qty','to_bay','../middleware/auth','edit_transfer','To_invoice','warehouse','Transfer\x20Edit\x20Successfully','prod_name','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','length','logo','Arabic\x20(ae)','to_bin','expiry_date','exports','Enclosed','random','<html><head><title></title>','type','secondary_unit','from_storage','An\x20error\x20occurred\x20while\x20saving\x20data.','</div>','findOne','../public/language/languages.json','$product_details._id','to_prod_pallet'];a0_0x4f8e=function(){return _0x5da6af;};return a0_0x4f8e();}function BayBinSelected(_0x92e7c1,_0x2c27bf){var _0x2b6486=a0_0x91de44,_0xbc0a0d=[],_0x237100=[],_0x2a09cd=[],_0x55248d=[],_0x11ea8a=[],_0x29762d=[];let _0x2a0533=[];if(_0x92e7c1==_0x2b6486(0x19d))switch(_0x2c27bf){case'Rack\x20A':_0xbc0a0d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x237100=[0x1,0x2],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=[_0x2b6486(0x208),_0x2b6486(0x19a)],_0x11ea8a=['D'],_0x29762d=['A'];break;case _0x2b6486(0x175):_0xbc0a0d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x237100=[0x1,0x2],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=[_0x2b6486(0x208),_0x2b6486(0x19a)],_0x11ea8a=['D'],_0x29762d=['B'];break;case _0x2b6486(0x1af):_0xbc0a0d=[0x0],_0x237100=[0x0],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=[_0x2b6486(0x19a)],_0x11ea8a=['D'],_0x29762d=['S'];break;case _0x2b6486(0x17d):_0xbc0a0d=[0x0],_0x237100=[0x0],_0x55248d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x2a09cd=[_0x2b6486(0x19a)],_0x11ea8a=['D'],_0x29762d=['R'];break;}else{if(_0x92e7c1==_0x2b6486(0x1f9))switch(_0x2c27bf){case'Rack\x20A':_0xbc0a0d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x237100=['B','F'],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=[_0x2b6486(0x208),_0x2b6486(0x19a)],_0x11ea8a=['C'],_0x29762d=['A'];break;case _0x2b6486(0x175):_0xbc0a0d=[0x5,0x4,0x3,0x2,0x1],_0x237100=['F','B','S'],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=[_0x2b6486(0x208),'Floor'],_0x11ea8a=['C'],_0x29762d=['B'];break;case _0x2b6486(0x158):_0xbc0a0d=[0x1,0x2,0x3,0x4,0x5],_0x237100=['B','F','S'],_0x55248d=[0x5,0x4,0x3,0x2,0x1],_0x2a09cd=[_0x2b6486(0x208),_0x2b6486(0x19a)],_0x11ea8a=['C'],_0x29762d=['C'];break;case _0x2b6486(0x1e3):_0xbc0a0d=[0x5,0x4,0x3,0x2,0x1],_0x237100=['F','B','S'],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=[_0x2b6486(0x208),_0x2b6486(0x19a)],_0x11ea8a=['C'],_0x29762d=['D'];break;case _0x2b6486(0x188):_0xbc0a0d=[0x4,0x3,0x2,0x1],_0x237100=[0x1,0x2],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=['Level','Floor'],_0x11ea8a=['C'],_0x29762d=['E'];break;case _0x2b6486(0x19e):_0xbc0a0d=[0x1,0x2,0x3],_0x237100=[0x1,0x2],_0x55248d=[0x1,0x2,0x3,0x4,0x5],_0x2a09cd=[_0x2b6486(0x208)],_0x11ea8a=['C'],_0x29762d=['F'];break;}}return{'levels':_0xbc0a0d,'Isle':_0x237100,'rack':_0x55248d,'type':_0x2a09cd,'storage':_0x11ea8a,'rak':_0x29762d};}function a0_0x1306(_0x484b71,_0x21cfcf){var _0x4f8eb9=a0_0x4f8e();return a0_0x1306=function(_0x13069f,_0x18fc1c){_0x13069f=_0x13069f-0x14c;var _0x580545=_0x4f8eb9[_0x13069f];return _0x580545;},a0_0x1306(_0x484b71,_0x21cfcf);}router[a0_0x91de44(0x229)](a0_0x91de44(0x16d),auth,async(_0x353ca9,_0x3b315e)=>{var _0x1ca448=a0_0x91de44;try{const {username:_0x1eac11,email:_0xdcbb10,role:_0x1ed75a}=_0x353ca9['user'],_0x1ac708=_0x353ca9[_0x1ca448(0x161)],_0x1a4252=await profile[_0x1ca448(0x1ca)]({'email':_0x1ac708[_0x1ca448(0x177)]}),_0x35d30b=await master_shop[_0x1ca448(0x227)](),_0x242402=await transfers[_0x1ca448(0x1e1)](_0x353ca9['params']['id']);let _0x10ff36;if(_0x1ac708['role']==_0x1ca448(0x154)){const _0x1bcafa=await staff[_0x1ca448(0x1ca)]({'email':_0x1ac708[_0x1ca448(0x177)]});_0x10ff36=await warehouse[_0x1ca448(0x181)]([{'$match':{'status':_0x1ca448(0x1e0),'name':_0x1bcafa[_0x1ca448(0x1b7)],'warehouse_category':_0x1ca448(0x165)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x10ff36=await warehouse['aggregate']([{'$match':{'status':_0x1ca448(0x1e0),'warehouse_category':_0x1ca448(0x165)}},{'$group':{'_id':_0x1ca448(0x14f),'name':{'$first':_0x1ca448(0x14f)}}}]);const _0x2f631c=await warehouse[_0x1ca448(0x181)]([{'$match':{'name':_0x242402[_0x1ca448(0x1a3)],'warehouse_category':_0x1ca448(0x165)}},{'$unwind':_0x1ca448(0x14e)},{'$group':{'_id':_0x1ca448(0x1cc),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1ca448(0x223)},'bin':{'$first':_0x1ca448(0x1f2)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1ca448(0x221)},'primary_code':{'$first':_0x1ca448(0x1ff)},'secondary_code':{'$first':_0x1ca448(0x194)},'product_code':{'$first':_0x1ca448(0x23c)},'storage':{'$first':_0x1ca448(0x234)},'rack':{'$first':_0x1ca448(0x15d)},'expiry_date':{'$first':_0x1ca448(0x1ea)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0x39c32d=await product[_0x1ca448(0x227)]({}),_0x14f9af=BayBinSelected(_0x242402[_0x1ca448(0x19c)],_0x242402['to_room']);if(_0x35d30b[0x0][_0x1ca448(0x185)]==_0x1ca448(0x20a)){var _0x2d2dde=users[_0x1ca448(0x19b)];console[_0x1ca448(0x156)](_0x2d2dde);}else{if(_0x35d30b[0x0][_0x1ca448(0x185)]==_0x1ca448(0x1a9))var _0x2d2dde=users['Hindi'];else{if(_0x35d30b[0x0]['language']=='German')var _0x2d2dde=users[_0x1ca448(0x22a)];else{if(_0x35d30b[0x0][_0x1ca448(0x185)]==_0x1ca448(0x1d6))var _0x2d2dde=users[_0x1ca448(0x1d6)];else{if(_0x35d30b[0x0][_0x1ca448(0x185)]==_0x1ca448(0x15a))var _0x2d2dde=users['French'];else{if(_0x35d30b[0x0][_0x1ca448(0x185)]==_0x1ca448(0x212))var _0x2d2dde=users[_0x1ca448(0x1aa)];else{if(_0x35d30b[0x0][_0x1ca448(0x185)]==_0x1ca448(0x204))var _0x2d2dde=users[_0x1ca448(0x204)];else{if(_0x35d30b[0x0][_0x1ca448(0x185)]==_0x1ca448(0x1be))var _0x2d2dde=users[_0x1ca448(0x18e)];}}}}}}}_0x3b315e[_0x1ca448(0x1d4)](_0x1ca448(0x1b5),{'success':_0x353ca9['flash'](_0x1ca448(0x18a)),'errors':_0x353ca9['flash'](_0x1ca448(0x21c)),'role':_0x1ac708,'profile':_0x1a4252,'master_shop':_0x35d30b,'warehouse':_0x10ff36,'transfer':_0x242402,'stock':_0x2f631c,'unit':_0x39c32d,'language':_0x2d2dde});}catch(_0x30f573){console[_0x1ca448(0x156)](_0x30f573);}}),router[a0_0x91de44(0x1e8)](a0_0x91de44(0x16d),auth,async(_0x180a03,_0x50e2bd)=>{var _0x28b803=a0_0x91de44;try{const _0x405653=_0x180a03['params']['id'],_0x47f085=await transfers[_0x28b803(0x1e1)](_0x405653);_0x50e2bd[_0x28b803(0x1e2)](_0x180a03[_0x28b803(0x224)]);return;const {date:_0x29af9a,from_warehouse:_0x317dee,FromRoom_name:_0x38cd8f,to_warehouse:_0x320dcb,ToRoom_name:_0x475a2a,prod_name:_0x217e9f,from_prod_qty:_0x1dc910,from_prod_level:_0x4f42bd,from_prod_isle:_0x53df5e,from_prod_pallet:_0x25dcd4,to_prod_qty:_0x2e5b61,to_prod_level:_0x5d69cd,to_prod_isle:_0x5cb17b,to_prod_pallet:_0xc3d6b1,primary_code:_0x11c73d,secondary_code:_0xf84a7b,product_code3:_0x13d31a,note:_0x5617f4,invoice:_0x1eb4e8,expiry_date:_0x3aa0f0}=_0x180a03[_0x28b803(0x224)];if(typeof _0x217e9f==_0x28b803(0x15c))var _0x24886f=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1b9)]],_0x5c3686=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1b2)]],_0x1edc93=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1b0)]],_0xae2772=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1dc)]],_0x230af4=[_0x180a03['body'][_0x28b803(0x16b)]],_0x57e5d8=[_0x180a03[_0x28b803(0x224)]['from_types']],_0x383cc9=[_0x180a03[_0x28b803(0x224)]['to_prod_qty']],_0x35406c=[_0x180a03['body']['to_prod_level']],_0x417108=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x180)]],_0x2f4609=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1cd)]],_0x12f667=[_0x180a03[_0x28b803(0x224)]['to_types']],_0x26c06e=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x233)]],_0x37b9a3=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1d0)]],_0x58895c=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1f1)]],_0x4507c9=[_0x180a03[_0x28b803(0x224)]['secondary_code']],_0x2eb3b8=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x167)]],_0x33b2cf=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x150)]],_0x33a246=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1d9)]],_0x26ab13=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1c6)]],_0x29dd3d=[_0x180a03['body'][_0x28b803(0x1df)]],_0x576ebc=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1c0)]],_0x2707e0=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x1c7)]],_0x3aa725=[_0x180a03[_0x28b803(0x224)][_0x28b803(0x239)]];else var _0x24886f=[..._0x180a03['body'][_0x28b803(0x1b9)]],_0x26c06e=[..._0x180a03[_0x28b803(0x224)]['storage']],_0x37b9a3=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1d0)]],_0x57e5d8=[..._0x180a03['body'][_0x28b803(0x1e5)]],_0x12f667=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x217)]],_0x5c3686=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1b2)]],_0x1edc93=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1b0)]],_0xae2772=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1dc)]],_0x230af4=[..._0x180a03['body'][_0x28b803(0x16b)]],_0x383cc9=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1de)]],_0x35406c=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x160)]],_0x417108=[..._0x180a03['body'][_0x28b803(0x180)]],_0x2f4609=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1cd)]],_0x58895c=[..._0x180a03['body'][_0x28b803(0x1f1)]],_0x4507c9=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x18c)]],_0x2eb3b8=[..._0x180a03[_0x28b803(0x224)]['product_code3']],_0x33b2cf=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x150)]],_0x33a246=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1d9)]],_0x26ab13=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1c6)]],_0x29dd3d=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1df)]],_0x576ebc=[..._0x180a03[_0x28b803(0x224)][_0x28b803(0x1c0)]],_0x2707e0=[..._0x180a03['body']['from_storage']],_0x3aa725=[..._0x180a03[_0x28b803(0x224)]['from_rak']];const _0x379cad=_0x24886f[_0x28b803(0x178)](_0x128608=>{return _0x128608={'product_name':_0x128608};});_0x5c3686['forEach']((_0x4c7bbe,_0x41b287)=>{var _0x1e6a07=_0x28b803;_0x379cad[_0x41b287][_0x1e6a07(0x151)]=_0x4c7bbe;}),_0x1edc93[_0x28b803(0x171)]((_0x583b22,_0x2eb348)=>{var _0x5dc925=_0x28b803;_0x379cad[_0x2eb348][_0x5dc925(0x21d)]=_0x583b22;}),_0xae2772[_0x28b803(0x171)]((_0x22f320,_0x5aa894)=>{var _0x274d5c=_0x28b803;_0x379cad[_0x5aa894][_0x274d5c(0x1ac)]=_0x22f320;}),_0x230af4[_0x28b803(0x171)]((_0x332db2,_0x3f7b14)=>{var _0x3704a3=_0x28b803;_0x379cad[_0x3f7b14][_0x3704a3(0x15b)]=_0x332db2;}),_0x383cc9[_0x28b803(0x171)]((_0x405b1f,_0x1a8d25)=>{var _0x5a1264=_0x28b803;_0x379cad[_0x1a8d25][_0x5a1264(0x1eb)]=_0x405b1f;}),_0x35406c['forEach']((_0x111a65,_0x3a4dba)=>{var _0xc24a92=_0x28b803;_0x379cad[_0x3a4dba][_0xc24a92(0x1b3)]=_0x111a65;}),_0x417108['forEach']((_0x95516f,_0x5aaae3)=>{var _0x36ffd0=_0x28b803;_0x379cad[_0x5aaae3][_0x36ffd0(0x1bf)]=_0x95516f;}),_0x2f4609[_0x28b803(0x171)]((_0x47a632,_0x10dc8d)=>{var _0x586888=_0x28b803;_0x379cad[_0x10dc8d][_0x586888(0x1cf)]=_0x47a632;}),_0x58895c[_0x28b803(0x171)]((_0x4ed8ee,_0x580ff2)=>{var _0x1c3748=_0x28b803;_0x379cad[_0x580ff2][_0x1c3748(0x1f1)]=_0x4ed8ee;}),_0x4507c9[_0x28b803(0x171)]((_0x1b44e6,_0x4f118a)=>{_0x379cad[_0x4f118a]['secondary_code']=_0x1b44e6;}),_0x2eb3b8[_0x28b803(0x171)]((_0x14eaa9,_0x5b7faa)=>{var _0x213f49=_0x28b803;_0x379cad[_0x5b7faa][_0x213f49(0x1fe)]=_0x14eaa9;}),_0x33b2cf[_0x28b803(0x171)]((_0x3748d0,_0x5d86ec)=>{var _0x4127d0=_0x28b803;_0x379cad[_0x5d86ec][_0x4127d0(0x1d2)]=_0x3748d0;}),_0x33a246[_0x28b803(0x171)]((_0x41a061,_0x558b68)=>{var _0x183a65=_0x28b803;_0x379cad[_0x558b68][_0x183a65(0x1d9)]=_0x41a061;}),_0x26ab13['forEach']((_0xd50625,_0x42a089)=>{_0x379cad[_0x42a089]['secondary_unit']=_0xd50625;}),_0x29dd3d[_0x28b803(0x171)]((_0x159471,_0xf20b71)=>{var _0x193682=_0x28b803;_0x379cad[_0xf20b71][_0x193682(0x1df)]=_0x159471;}),_0x576ebc['forEach']((_0x4db795,_0x449b79)=>{_0x379cad[_0x449b79]['expiry_date']=_0x4db795;}),_0x26c06e[_0x28b803(0x171)]((_0xd0dca,_0x4b4aa4)=>{var _0x4167a3=_0x28b803;_0x379cad[_0x4b4aa4][_0x4167a3(0x233)]=_0xd0dca;}),_0x37b9a3['forEach']((_0x1c58a0,_0x167bda)=>{_0x379cad[_0x167bda]['rack']=_0x1c58a0;}),_0x57e5d8[_0x28b803(0x171)]((_0xbf309e,_0x4767ee)=>{var _0x430b5d=_0x28b803;_0x379cad[_0x4767ee][_0x430b5d(0x1e5)]=_0xbf309e;}),_0x12f667[_0x28b803(0x171)]((_0x52d999,_0x4e9b75)=>{var _0x3cc1b7=_0x28b803;_0x379cad[_0x4e9b75][_0x3cc1b7(0x217)]=_0x52d999;}),_0x2707e0[_0x28b803(0x171)]((_0x183772,_0x37e34a)=>{var _0x2c7d81=_0x28b803;_0x379cad[_0x37e34a][_0x2c7d81(0x1c7)]=_0x183772;}),_0x3aa725['forEach']((_0x4b9878,_0x13b4f9)=>{var _0x1d9cd0=_0x28b803;_0x379cad[_0x13b4f9][_0x1d9cd0(0x1d5)]=_0x4b9878;});const _0x5110c8=_0x379cad[_0x28b803(0x182)](_0x7df065=>_0x7df065['to_quantity']!=='0'&&_0x7df065[_0x28b803(0x1eb)]!==''||_0x7df065[_0x28b803(0x1cf)]!=='0'&&_0x7df065['to_floorlevel']!=='');var _0x19b98e=0x0;_0x5110c8['forEach'](_0x427b88=>{var _0x9e70b2=_0x28b803;parseInt(_0x427b88['from_quantity'])<parseInt(_0x427b88[_0x9e70b2(0x1eb)])&&_0x19b98e++;});if(_0x19b98e!=0x0)return _0x180a03[_0x28b803(0x1b1)](_0x28b803(0x21c),_0x28b803(0x215)),_0x50e2bd[_0x28b803(0x21f)](_0x28b803(0x21e));const _0x3fb271=await warehouse[_0x28b803(0x1ca)]({'name':_0x47f085[_0x28b803(0x1a3)],'room':_0x47f085[_0x28b803(0x1f4)]});_0x47f085['product']['forEach'](_0x3f20b4=>{var _0x246857=_0x28b803;if(_0x3f20b4['to_quantity']>0x0){const _0x4baca6=_0x3fb271[_0x246857(0x163)]['map'](_0x270da3=>{var _0xd3963e=_0x246857;_0x270da3[_0xd3963e(0x1f0)]==_0x3f20b4[_0xd3963e(0x1f0)]&&_0x270da3[_0xd3963e(0x1d8)]==_0x3f20b4[_0xd3963e(0x15b)]&&_0x270da3[_0xd3963e(0x1c5)]==_0x3f20b4[_0xd3963e(0x1e5)]&&_0x270da3[_0xd3963e(0x196)]==_0x3f20b4['from_bin']&&_0x270da3[_0xd3963e(0x218)]==_0x3f20b4[_0xd3963e(0x21d)]&&_0x270da3[_0xd3963e(0x1db)]==_0x3f20b4['from_rack']&&_0x270da3['storage']==_0x3f20b4[_0xd3963e(0x1c7)]&&(_0x270da3[_0xd3963e(0x1ba)]=parseInt(_0x270da3['product_stock'])+parseInt(_0x3f20b4[_0xd3963e(0x1eb)]));});}}),await _0x3fb271[_0x28b803(0x17b)]();const _0x2c87cd=await warehouse['findOne']({'name':_0x47f085[_0x28b803(0x19c)],'room':_0x47f085[_0x28b803(0x21a)]});_0x47f085[_0x28b803(0x19f)]['forEach'](_0x3c503e=>{var _0x1038dd=_0x28b803;if(_0x3c503e['to_quantity']>0x0){const _0x494c7e=_0x2c87cd[_0x1038dd(0x163)][_0x1038dd(0x178)](_0x3c7694=>{var _0x5c9a30=_0x1038dd;_0x3c7694['product_name']==_0x3c503e[_0x5c9a30(0x1f0)]&&_0x3c7694[_0x5c9a30(0x1d8)]==_0x3c503e[_0x5c9a30(0x1cf)]&&_0x3c7694[_0x5c9a30(0x1c5)]==_0x3c503e['to_types']&&_0x3c7694[_0x5c9a30(0x196)]==_0x3c503e[_0x5c9a30(0x1bf)]&&_0x3c7694[_0x5c9a30(0x218)]==_0x3c503e['to_bay']&&_0x3c7694[_0x5c9a30(0x1db)]==_0x3c503e['rack']&&_0x3c7694['storage']==_0x3c503e[_0x5c9a30(0x233)]&&(_0x3c7694[_0x5c9a30(0x1ba)]=parseInt(_0x3c7694['product_stock'])-parseInt(_0x3c503e[_0x5c9a30(0x1eb)]));});}}),await _0x2c87cd[_0x28b803(0x17b)](),_0x47f085[_0x28b803(0x17f)]=_0x29af9a,_0x47f085[_0x28b803(0x1a3)]=_0x317dee,_0x47f085[_0x28b803(0x19c)]=_0x320dcb,_0x47f085[_0x28b803(0x19f)]=_0x5110c8,_0x47f085[_0x28b803(0x203)]=_0x5617f4,_0x47f085['invoice']=_0x1eb4e8;const _0x1c48fc=await _0x47f085[_0x28b803(0x17b)]();console[_0x28b803(0x156)](_0x1c48fc);const _0x22a060=await warehouse['findOne']({'name':_0x317dee,'room':_0x38cd8f});_0x1c48fc[_0x28b803(0x19f)][_0x28b803(0x171)](_0x2065ea=>{var _0x2fe348=_0x28b803;if(_0x2065ea[_0x2fe348(0x1eb)]>0x0){const _0x212f63=_0x22a060['product_details'][_0x2fe348(0x178)](_0x2e56d8=>{var _0x50797a=_0x2fe348;_0x2e56d8[_0x50797a(0x1f0)]==_0x2065ea[_0x50797a(0x1f0)]&&_0x2e56d8['floorlevel']==_0x2065ea[_0x50797a(0x15b)]&&_0x2e56d8[_0x50797a(0x1c5)]==_0x2065ea['from_types']&&_0x2e56d8['bin']==_0x2065ea[_0x50797a(0x1ac)]&&_0x2e56d8[_0x50797a(0x218)]==_0x2065ea['from_bay']&&_0x2e56d8[_0x50797a(0x1db)]==_0x2065ea['from_rack']&&_0x2e56d8['storage']==_0x2065ea['from_storage']&&(_0x2e56d8[_0x50797a(0x1ba)]=parseInt(_0x2e56d8[_0x50797a(0x1ba)])-parseInt(_0x2065ea['to_quantity']));});}}),await _0x22a060['save']();const _0x28f303=await warehouse[_0x28b803(0x1ca)]({'name':_0x320dcb,'room':_0x475a2a});_0x1c48fc[_0x28b803(0x19f)][_0x28b803(0x171)](_0xc3667e=>{var _0x3eed81=_0x28b803;if(_0xc3667e[_0x3eed81(0x1eb)]>0x0){var _0x509702=0x0;const _0x55d7ab=_0x28f303[_0x3eed81(0x163)][_0x3eed81(0x178)](_0x4292c8=>{var _0x5e3b52=_0x3eed81;_0x4292c8[_0x5e3b52(0x1f0)]==_0xc3667e[_0x5e3b52(0x1f0)]&&_0x4292c8['floorlevel']==_0xc3667e[_0x5e3b52(0x1cf)]&&_0x4292c8[_0x5e3b52(0x1c5)]==_0xc3667e[_0x5e3b52(0x217)]&&_0x4292c8['bin']==_0xc3667e[_0x5e3b52(0x1bf)]&&_0x4292c8[_0x5e3b52(0x218)]==_0xc3667e[_0x5e3b52(0x1b3)]&&_0x4292c8[_0x5e3b52(0x1db)]==_0xc3667e['rack']&&_0x4292c8['storage']==_0xc3667e[_0x5e3b52(0x233)]&&(_0x4292c8[_0x5e3b52(0x1ba)]=parseInt(_0x4292c8[_0x5e3b52(0x1ba)])+parseInt(_0xc3667e[_0x5e3b52(0x1eb)]),_0x509702++);});_0x509702=='0'&&(_0x28f303['product_details']=_0x28f303[_0x3eed81(0x163)]['concat']({'product_name':_0xc3667e[_0x3eed81(0x1f0)],'product_stock':_0xc3667e[_0x3eed81(0x1eb)],'bay':_0xc3667e[_0x3eed81(0x1b3)],'bin':_0xc3667e[_0x3eed81(0x1bf)],'type':_0xc3667e[_0x3eed81(0x217)],'floorlevel':_0xc3667e[_0x3eed81(0x1cf)],'storage':_0xc3667e[_0x3eed81(0x233)],'rack':_0xc3667e['rack'],'product_code':_0xc3667e[_0x3eed81(0x1fe)],'primary_code':_0xc3667e[_0x3eed81(0x1f1)],'secondary_code':_0xc3667e[_0x3eed81(0x18c)],'maxProducts':_0xc3667e[_0x3eed81(0x1d2)],'storage':_0xc3667e[_0x3eed81(0x233)],'rack':_0xc3667e['rack']}));}}),await _0x28f303[_0x28b803(0x17b)](),_0x180a03['flash']('success',_0x28b803(0x1b8)),_0x50e2bd[_0x28b803(0x21f)](_0x28b803(0x155));}catch(_0x545e84){console[_0x28b803(0x156)](_0x545e84);}}),router['post'](a0_0x91de44(0x1da),async(_0x3a5d2e,_0x2a1049)=>{var _0x3b2c71=a0_0x91de44;const {FromWareHouse:_0x286ae6,FromRoom:_0x1dbfee,ToWarehouse:_0x221fcb,ToRoom:_0x357cdd,primary_code:_0x598cfe,Roomslist:_0x54f85d}=_0x3a5d2e[_0x3b2c71(0x224)],_0x554c54=_0x54f85d[_0x3b2c71(0x15e)](','),_0xdeb316=[];async function _0x935434(_0x3a048d){var _0x2b0a2=_0x3b2c71;const _0xb5b4a4=await warehouse[_0x2b0a2(0x181)]([{'$match':{'name':_0x286ae6,'room':_0x3a048d}},{'$unwind':_0x2b0a2(0x14e)},{'$match':{'product_details.primary_code':_0x598cfe}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2b0a2(0x169)},'instock':{'$first':_0x2b0a2(0x20e)},'primary_code':{'$first':_0x2b0a2(0x1ff)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2b0a2(0x223)},'isle':{'$first':_0x2b0a2(0x1f2)},'type':{'$first':_0x2b0a2(0x195)},'pallet':{'$first':_0x2b0a2(0x221)},'unit':{'$first':_0x2b0a2(0x17c)},'secondary_unit':{'$first':_0x2b0a2(0x186)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2b0a2(0x1ea)},'production_date':{'$first':_0x2b0a2(0x1ed)},'batch_code':{'$first':_0x2b0a2(0x200)},'maxPerUnit':{'$first':_0x2b0a2(0x222)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x2b0a2(0x168)},'maxProducts':{'$first':_0x2b0a2(0x232)}}}]),_0x57f306=await warehouse[_0x2b0a2(0x181)]([{'$match':{'name':_0x286ae6,'room':_0x3a048d}},{'$unwind':_0x2b0a2(0x14e)},{'$match':{'product_details.secondary_code':_0x598cfe}},{'$group':{'_id':_0x2b0a2(0x1cc),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x2b0a2(0x20e)},'primary_code':{'$first':_0x2b0a2(0x1ff)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2b0a2(0x23c)},'level':{'$first':_0x2b0a2(0x223)},'isle':{'$first':_0x2b0a2(0x1f2)},'type':{'$first':_0x2b0a2(0x195)},'pallet':{'$first':_0x2b0a2(0x221)},'unit':{'$first':_0x2b0a2(0x17c)},'secondary_unit':{'$first':_0x2b0a2(0x186)},'storage':{'$first':_0x2b0a2(0x234)},'rack':{'$first':_0x2b0a2(0x15d)},'expiry_date':{'$first':_0x2b0a2(0x1ea)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2b0a2(0x200)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x2b0a2(0x168)},'maxProducts':{'$first':_0x2b0a2(0x232)}}}]);if(_0xb5b4a4['length']>0x0)_0xdeb316[_0x2b0a2(0x198)](_0xb5b4a4);else _0x57f306[_0x2b0a2(0x1bc)]>0x0&&_0xdeb316[_0x2b0a2(0x198)](_0x57f306);}const _0x30b332=_0x554c54['map'](_0x3e7d00=>_0x935434(_0x3e7d00));await Promise['all'](_0x30b332),_0x2a1049[_0x3b2c71(0x1e2)](_0xdeb316);}),router[a0_0x91de44(0x1e8)](a0_0x91de44(0x192),async(_0x75cbf8,_0x12b15d)=>{var _0x5306a2=a0_0x91de44;try{const {FromWareHouse:_0x307a9f,FromRoom:_0x13b536,ToWarehouse:_0x5e74c8,ToRoom:_0x3fd69b,secondary_code:_0x36711b}=_0x75cbf8[_0x5306a2(0x224)],_0x195601=await warehouse['aggregate']([{'$match':{'name':_0x307a9f}},{'$unwind':_0x5306a2(0x14e)},{'$match':{'product_details.secondary_code':_0x36711b}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x5306a2(0x1ff)},'secondary_code':{'$first':_0x5306a2(0x194)},'product_code':{'$first':_0x5306a2(0x23c)},'instock':{'$first':_0x5306a2(0x20e)},'warehouse':{'$first':_0x5306a2(0x14f)},'level':{'$first':_0x5306a2(0x162)},'isle':{'$first':_0x5306a2(0x193)},'pallet':{'$first':_0x5306a2(0x1ce)},'maxProducts':{'$first':_0x5306a2(0x232)},'unit':{'$first':_0x5306a2(0x17c)}}}]);_0x12b15d['status'](0xc8)[_0x5306a2(0x1e2)](_0x195601);}catch(_0x27a476){_0x12b15d[_0x5306a2(0x199)](0x194)[_0x5306a2(0x1e2)]({'message':_0x27a476[_0x5306a2(0x173)]});}}),router[a0_0x91de44(0x1e8)](a0_0x91de44(0x16f),async(_0x4eca9b,_0x1ecdd9)=>{var _0x55b87c=a0_0x91de44;try{const {FromWareHouse:_0x2834d5,FromRoom:_0x58a86e,ToWarehouse:_0xd4848e,ToRoom:_0xdf7fe9,product_code:_0x5582c4}=_0x4eca9b['body'],_0x32e360=await warehouse[_0x55b87c(0x181)]([{'$match':{'name':_0x2834d5}},{'$unwind':_0x55b87c(0x14e)},{'$match':{'product_details.product_code':_0x5582c4}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x55b87c(0x169)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x55b87c(0x194)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x55b87c(0x20e)},'warehouse':{'$first':_0x55b87c(0x14f)},'level':{'$first':_0x55b87c(0x162)},'isle':{'$first':_0x55b87c(0x193)},'pallet':{'$first':_0x55b87c(0x1ce)},'maxProducts':{'$first':_0x55b87c(0x232)},'unit':{'$first':'$product_details.unit'}}}]);_0x1ecdd9[_0x55b87c(0x199)](0xc8)['json'](_0x32e360);}catch(_0x53f501){_0x1ecdd9[_0x55b87c(0x199)](0x194)[_0x55b87c(0x1e2)]({'message':_0x53f501['message']});}}),router[a0_0x91de44(0x1e8)]('/CheckingWarehouse',async(_0xaf8c14,_0x5d7b08)=>{var _0x305eae=a0_0x91de44;const {level:_0x14bedd,isle:_0x118439,pallet:_0x503dc5,warehouses:_0x357c1d,room:_0x3969a0}=_0xaf8c14[_0x305eae(0x224)];try{const _0xfbaff=await warehouse[_0x305eae(0x181)]([{'$match':{'name':_0x357c1d,'room':_0x3969a0}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x14bedd),'product_details.isle':_0x118439,'product_details.pallet':parseInt(_0x503dc5)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x305eae(0x169)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x305eae(0x162)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x305eae(0x1ce)},'maxProducts':{'$first':_0x305eae(0x232)}}}]);_0x5d7b08[_0x305eae(0x199)](0xc8)[_0x305eae(0x1e2)](_0xfbaff);}catch(_0xf46592){_0x5d7b08[_0x305eae(0x199)](0x194)[_0x305eae(0x1e2)]({'message':_0xf46592[_0x305eae(0x173)]});}}),module[a0_0x91de44(0x1c1)]=router;