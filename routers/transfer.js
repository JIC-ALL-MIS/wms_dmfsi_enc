var a0_0xbc1db0=a0_0x5f44;function a0_0x5f44(_0x5224e2,_0x554412){var _0x560061=a0_0x5600();return a0_0x5f44=function(_0x5f4431,_0x1e3d5e){_0x5f4431=_0x5f4431-0x134;var _0x56ff36=_0x560061[_0x5f4431];return _0x56ff36;},a0_0x5f44(_0x5224e2,_0x554412);}(function(_0x10b1ca,_0x5208f4){var _0x5cbce2=a0_0x5f44,_0x1d817d=_0x10b1ca();while(!![]){try{var _0xb7719f=parseInt(_0x5cbce2(0x1f1))/0x1*(parseInt(_0x5cbce2(0x176))/0x2)+-parseInt(_0x5cbce2(0x1cc))/0x3+-parseInt(_0x5cbce2(0x1f2))/0x4*(-parseInt(_0x5cbce2(0x18e))/0x5)+-parseInt(_0x5cbce2(0x14f))/0x6*(parseInt(_0x5cbce2(0x169))/0x7)+-parseInt(_0x5cbce2(0x186))/0x8*(-parseInt(_0x5cbce2(0x218))/0x9)+-parseInt(_0x5cbce2(0x1d9))/0xa+-parseInt(_0x5cbce2(0x1e1))/0xb;if(_0xb7719f===_0x5208f4)break;else _0x1d817d['push'](_0x1d817d['shift']());}catch(_0x5a71ec){_0x1d817d['push'](_0x1d817d['shift']());}}}(a0_0x5600,0x19cc5));function a0_0x5600(){var _0x1a9dcf=['\x20</h2>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<hr\x20class=\x22my-3\x22>','transfer','from_bin','An\x20error\x20occurred\x20while\x20saving\x20data.','<tr>','filter','<div>','back','<span\x20style=\x22float:\x20right;\x22>','Transfer\x20Finalize\x20Successfully','from_room_name','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.primary_code','8bgnsOE','express','$name','/barcode_scanner','nodemailer','../middleware/auth','sendMail','Portuguese','78465SqhfBn','_id','</tr>','$room','type','message','push','Floor','floor','expiry_date','Router','Spanish','all','render','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details','Transfer\x20Edit\x20Successfully','to_prod_pallet','Portuguese\x20(BR)','slice','createTransport','from_prod_level','$product_details.product_code','staff','product_name','findById','invoice','unit','product_details','from_floorlevel','body','to_room','Shelves','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','getFullYear','English\x20(US)','RMSEmail','$product_details._id','site_title','bay','$product_details.floorlevel','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Enabled','$product_details.level','to_prod_qty','from_prod_pallet','</tbody>','from_types','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','ToRoomAssigned','Rack\x20C','/transfer/preview/','edit_transfer_view','$product_details.type','</div>','success','max_per_unit','$product_details.product_name','length','<h5\x20style=\x22text-align:\x20left;\x22>','An\x20error\x20occurred.','144381IrHMpP','note','from_rack','findOne','rack','</td>','logo','Rack\x20B','Ambient','../models/all_models','$finalize','role','json','2023960wWWtLH','to_types','from_warehouse','from_bay','to_warehouse','$product.from_room_name','password','split','415756VprlKc','forEach','Rack\x20A','from_prod_isle','$isAllowEdit','maxProducts','$product_details.maxPerUnit','product_code3','updateOne','flash','COLD\x20STORAGE','secondary_unit','edit_transfer','Rack\x20D','/view','\x20Order\x20Date\x20:\x20','77002uNWvFR','24SXSxmH','warehouse','to_bin','$product_details.product_stock','product_stock','$product_details.bin','primary_unit','storage','catch','Arabic','product','/../public','$date','$product_details.batch_code','log','errors','primary_code','Rack\x20E','product_code','Chinese','aggregate','DRY\x20STORAGE','Raw\x20Materials','date','MaxStocks_data2','to_prod_level','</head><body>','/view/:id','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Hindi','</body></html>','$product_details.secondary_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','status','production_date','add_transfer','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','1850571BzbMLX','Return\x20Rooms','/CheckingWarehouse','floorlevel','/preview/:id','batch_code','from_quantity','then','host','map','$product_details.unit','Level','maxperunit','$_id','<strong>\x20Regards\x20</strong>','$product_details.production_date','concat','/picking_list/PDF_transfer_rm/','secondary_code','from_storage','True','port','master','Receiving\x20Area','user','email','params','/barcode_scanner2','German','$product_details.maxProducts','from_invoice','<h5>','$product_details.bay','get','find','<table\x20style=\x22width:\x20100%\x20!important;\x22>','French','../public/language/languages.json','from_prod_qty','TRF-','$product_details.rack','bin','language','exports','358758PrPGph','to_room_name','Arabic\x20(ae)','/view/add_transfer','New_Qty_Converted','getDate','string','$from_warehouse','rak','Error\x20Occurs','<!DOCTYPE\x20html>','from_room','$product_details.expiry_date','$product_details.secondary_unit','</thead>','$product_details.storage','prod_cat','Rack\x20F','RoomAssigned','</h5>','to_bay','To_invoice','redirect','getMonth','save','post','7kJYyWO','to_quantity','to_prod_isle','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Enclosed','to_floorlevel','Logo.png','/transfer/view','prod_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','random','$product_details.pallet','</span>','4KklacE'];a0_0x5600=function(){return _0x1a9dcf;};return a0_0x5600();}const express=require(a0_0xbc1db0(0x187)),app=express(),router=express[a0_0xbc1db0(0x198)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0xbc1db0(0x1d5)),auth=require(a0_0xbc1db0(0x18b)),users=require(a0_0xbc1db0(0x148)),nodemailer=require(a0_0xbc1db0(0x18a));router[a0_0xbc1db0(0x144)](a0_0xbc1db0(0x1ef),auth,async(_0x4c7b21,_0x5d8836)=>{var _0x5aaadd=a0_0xbc1db0;try{const {username:_0x2e714a,email:_0x524ace,role:_0x448d63}=_0x4c7b21[_0x5aaadd(0x13b)],_0x3769d9=_0x4c7b21[_0x5aaadd(0x13b)],_0xfc088a=await profile['findOne']({'email':_0x3769d9[_0x5aaadd(0x13c)]}),_0x1ee83f=await master_shop['find']();console[_0x5aaadd(0x200)](_0x5aaadd(0x139),_0x1ee83f);let _0xd5382f;if(_0x3769d9[_0x5aaadd(0x1d7)]==_0x5aaadd(0x1a5)){const _0xd2371d=await staff[_0x5aaadd(0x1cf)]({'email':_0x3769d9[_0x5aaadd(0x13c)]});_0xd5382f=await transfers['find']({'from_warehouse':_0xd2371d[_0x5aaadd(0x1f3)]});}else _0xd5382f=await transfers[_0x5aaadd(0x206)]([{'$unwind':'$product'},{'$group':{'_id':_0x5aaadd(0x225),'invoice':{'$first':'$invoice'},'date':{'$first':_0x5aaadd(0x1fe)},'from_warehouse':{'$first':_0x5aaadd(0x156)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x5aaadd(0x1de)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x5aaadd(0x1d6)},'isAllowEdit':{'$first':_0x5aaadd(0x1e5)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1ee83f[0x0][_0x5aaadd(0x14d)]==_0x5aaadd(0x1b2)){var _0x45577b=users[_0x5aaadd(0x20e)];console['log'](_0x45577b);}else{if(_0x1ee83f[0x0]['language']==_0x5aaadd(0x210))var _0x45577b=users[_0x5aaadd(0x210)];else{if(_0x1ee83f[0x0][_0x5aaadd(0x14d)]==_0x5aaadd(0x13f))var _0x45577b=users[_0x5aaadd(0x13f)];else{if(_0x1ee83f[0x0]['language']==_0x5aaadd(0x199))var _0x45577b=users[_0x5aaadd(0x199)];else{if(_0x1ee83f[0x0]['language']==_0x5aaadd(0x147))var _0x45577b=users[_0x5aaadd(0x147)];else{if(_0x1ee83f[0x0][_0x5aaadd(0x14d)]==_0x5aaadd(0x1a0))var _0x45577b=users[_0x5aaadd(0x18d)];else{if(_0x1ee83f[0x0]['language']==_0x5aaadd(0x205))var _0x45577b=users[_0x5aaadd(0x205)];else{if(_0x1ee83f[0x0][_0x5aaadd(0x14d)]==_0x5aaadd(0x151))var _0x45577b=users['Arabic'];}}}}}}}_0x5d8836[_0x5aaadd(0x19b)](_0x5aaadd(0x17a),{'success':_0x4c7b21[_0x5aaadd(0x1ea)](_0x5aaadd(0x1c6)),'errors':_0x4c7b21[_0x5aaadd(0x1ea)](_0x5aaadd(0x201)),'role':_0x3769d9,'profile':_0xfc088a,'master_shop':_0x1ee83f,'transfer':_0xd5382f,'language':_0x45577b});}catch(_0x585b09){console[_0x5aaadd(0x200)](_0x585b09);}});async function getRandom8DigitNumber(){var _0x1c6523=a0_0xbc1db0;const _0x2decaf=0x989680,_0x51f8fd=0x5f5e0ff,_0x29b883=Math[_0x1c6523(0x196)](Math[_0x1c6523(0x173)]()*(_0x51f8fd-_0x2decaf+0x1))+_0x2decaf;var _0xc3008e;const _0x2f36af=await transfers[_0x1c6523(0x1cf)]({'invoice':'TRF-'+_0x29b883});return _0x2f36af&&_0x2f36af[_0x1c6523(0x1c9)]>0x0?_0xc3008e=_0x1c6523(0x14a)+_0x29b883:_0xc3008e=_0x1c6523(0x14a)+_0x29b883,_0xc3008e;}router[a0_0xbc1db0(0x144)]('/view/add_transfer',auth,async(_0x5f05c4,_0x435ed2)=>{var _0x57c1ee=a0_0xbc1db0;try{const {username:_0x5bb820,email:_0x448466,role:_0x4b58f5}=_0x5f05c4['user'],_0xdcfece=_0x5f05c4[_0x57c1ee(0x13b)],_0x14f948=await profile[_0x57c1ee(0x1cf)]({'email':_0xdcfece[_0x57c1ee(0x13c)]}),_0xa5b443=await master_shop[_0x57c1ee(0x145)]();console[_0x57c1ee(0x200)](_0x57c1ee(0x139),_0xa5b443);let _0x286e00;if(_0xdcfece[_0x57c1ee(0x1d7)]=='staff'){const _0x257f0d=await staff[_0x57c1ee(0x1cf)]({'email':_0xdcfece[_0x57c1ee(0x13c)]});_0x286e00=await warehouse['aggregate']([{'$match':{'status':_0x57c1ee(0x1b9),'name':_0x257f0d[_0x57c1ee(0x1f3)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x57c1ee(0x188),'name':{'$first':'$name'}}}]);}else _0x286e00=await warehouse[_0x57c1ee(0x206)]([{'$match':{'status':_0x57c1ee(0x1b9),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x57c1ee(0x188),'name':{'$first':_0x57c1ee(0x188)}}}]);var _0x5e48b7=[_0x57c1ee(0x1d4),_0x57c1ee(0x16d),_0x57c1ee(0x219)];const _0x232c5a=await transfers[_0x57c1ee(0x145)]({}),_0x3617dc=_0x232c5a[_0x57c1ee(0x1c9)]+0x1,_0x2f8226='TRF-'+_0x3617dc['toString']()['padStart'](0x5,'0');if(_0xa5b443[0x0]['language']=='English\x20(US)'){var _0x707a06=users[_0x57c1ee(0x20e)];console[_0x57c1ee(0x200)](_0x707a06);}else{if(_0xa5b443[0x0][_0x57c1ee(0x14d)]=='Hindi')var _0x707a06=users[_0x57c1ee(0x210)];else{if(_0xa5b443[0x0][_0x57c1ee(0x14d)]==_0x57c1ee(0x13f))var _0x707a06=users[_0x57c1ee(0x13f)];else{if(_0xa5b443[0x0][_0x57c1ee(0x14d)]==_0x57c1ee(0x199))var _0x707a06=users[_0x57c1ee(0x199)];else{if(_0xa5b443[0x0][_0x57c1ee(0x14d)]==_0x57c1ee(0x147))var _0x707a06=users[_0x57c1ee(0x147)];else{if(_0xa5b443[0x0]['language']==_0x57c1ee(0x1a0))var _0x707a06=users[_0x57c1ee(0x18d)];else{if(_0xa5b443[0x0][_0x57c1ee(0x14d)]==_0x57c1ee(0x205))var _0x707a06=users[_0x57c1ee(0x205)];else{if(_0xa5b443[0x0][_0x57c1ee(0x14d)]==_0x57c1ee(0x151))var _0x707a06=users[_0x57c1ee(0x1fb)];}}}}}}}const _0x22f20e=getRandom8DigitNumber();_0x22f20e['then'](_0x4a8df9=>{var _0x4bd918=_0x57c1ee;_0x435ed2[_0x4bd918(0x19b)](_0x4bd918(0x216),{'success':_0x5f05c4['flash']('success'),'errors':_0x5f05c4[_0x4bd918(0x1ea)](_0x4bd918(0x201)),'role':_0xdcfece,'profile':_0x14f948,'master_shop':_0xa5b443,'warehouse':_0x286e00,'language':_0x707a06,'rooms_data':_0x5e48b7,'invoice':_0x4a8df9});})['catch'](_0x5e583d=>{var _0x34e148=_0x57c1ee;_0x5f05c4[_0x34e148(0x1ea)]('errors',_0x34e148(0x1b8)),_0x435ed2[_0x34e148(0x165)](_0x34e148(0x170));});}catch(_0x1f7b8f){console[_0x57c1ee(0x200)](_0x1f7b8f);}}),router[a0_0xbc1db0(0x168)](a0_0xbc1db0(0x152),auth,async(_0x15b0e7,_0x31ede5)=>{var _0x171057=a0_0xbc1db0;try{console[_0x171057(0x200)](_0x15b0e7[_0x171057(0x1ac)]);const {date:_0x278d1c,from_warehouse:_0x36b136,FromRoom_name:_0x4fae6e,to_warehouse:_0x5410cc,ToRoom_name:_0x422f2d,prod_name:_0x239f87,from_prod_qty:_0x187a6d,from_prod_level:_0x5437a3,from_prod_isle:_0x3e4d43,from_prod_pallet:_0x214983,to_prod_qty:_0x9c4913,to_prod_level:_0x40172a,to_prod_isle:_0x373e7f,to_prod_pallet:_0x3032ae,primary_code:_0x40c327,secondary_code:_0x16d0ed,product_code3:_0x24b4e9,note:_0x4541db,MaxStocks_data2:_0x434e43,invoice:_0x44c859,expiry_date:_0x17330a}=_0x15b0e7['body'];if(typeof _0x239f87==_0x171057(0x155))var _0x17f9f9=[_0x15b0e7[_0x171057(0x1ac)]['prod_name']],_0x39b085=[_0x15b0e7[_0x171057(0x1ac)]['from_prod_qty']],_0x491ce0=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x1a3)]],_0x57c8f6=[_0x15b0e7['body'][_0x171057(0x153)]],_0x17a28d=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x20b)]],_0x489e3a=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x202)]],_0x5e471a=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x135)]],_0x4c757d=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x1e8)]],_0x9f5924=[_0x15b0e7[_0x171057(0x1ac)]['MaxStocks_data2']],_0x2a3585=[_0x15b0e7['body'][_0x171057(0x1f8)]],_0x543401=[_0x15b0e7[_0x171057(0x1ac)]['secondary_unit']],_0x176ec6=[_0x15b0e7[_0x171057(0x1ac)]['batch_code']],_0x29e492=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x197)]],_0x2fb636=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x1c7)]],_0x343a42=[_0x15b0e7['body']['production_date']],_0x4bb965=[_0x15b0e7[_0x171057(0x1ac)]['prod_cat']],_0x5caac1=[_0x15b0e7['body'][_0x171057(0x161)]],_0x452efa=[_0x15b0e7[_0x171057(0x1ac)][_0x171057(0x1c0)]],_0x56d302=[_0x15b0e7[_0x171057(0x1ac)]['from_invoice']],_0x523742=[_0x15b0e7[_0x171057(0x1ac)]['to_invoice']];else var _0x17f9f9=[..._0x15b0e7['body'][_0x171057(0x171)]],_0x39b085=[..._0x15b0e7['body']['from_prod_qty']],_0x491ce0=[..._0x15b0e7['body'][_0x171057(0x1a3)]],_0x57c8f6=[..._0x15b0e7[_0x171057(0x1ac)]['New_Qty_Converted']],_0x17a28d=[..._0x15b0e7[_0x171057(0x1ac)][_0x171057(0x20b)]],_0x489e3a=[..._0x15b0e7[_0x171057(0x1ac)]['primary_code']],_0x5e471a=[..._0x15b0e7['body'][_0x171057(0x135)]],_0x4c757d=[..._0x15b0e7[_0x171057(0x1ac)]['product_code3']],_0x9f5924=[..._0x15b0e7[_0x171057(0x1ac)][_0x171057(0x20a)]],_0x2a3585=[..._0x15b0e7[_0x171057(0x1ac)]['primary_unit']],_0x543401=[..._0x15b0e7['body'][_0x171057(0x1ec)]],_0x176ec6=[..._0x15b0e7[_0x171057(0x1ac)][_0x171057(0x21d)]],_0x29e492=[..._0x15b0e7[_0x171057(0x1ac)][_0x171057(0x197)]],_0x2fb636=[..._0x15b0e7[_0x171057(0x1ac)]['max_per_unit']],_0x343a42=[..._0x15b0e7[_0x171057(0x1ac)][_0x171057(0x215)]],_0x4bb965=[..._0x15b0e7[_0x171057(0x1ac)]['prod_cat']],_0x5caac1=[..._0x15b0e7['body'][_0x171057(0x161)]],_0x452efa=[..._0x15b0e7['body']['ToRoomAssigned']],_0x56d302=[..._0x15b0e7[_0x171057(0x1ac)][_0x171057(0x141)]],_0x523742=[..._0x15b0e7[_0x171057(0x1ac)]['to_invoice']];const _0xdd785f=_0x17f9f9[_0x171057(0x221)](_0xccd145=>{return _0xccd145={'product_name':_0xccd145};});_0x39b085[_0x171057(0x1e2)]((_0x7679f,_0x38f545)=>{var _0x23f9a7=_0x171057;_0xdd785f[_0x38f545][_0x23f9a7(0x21e)]=_0x7679f;}),_0x56d302[_0x171057(0x1e2)]((_0x1521b0,_0x499afe)=>{_0xdd785f[_0x499afe]['from_invoice']=_0x1521b0;}),_0x523742[_0x171057(0x1e2)]((_0xb3fed9,_0x1a6bc3)=>{_0xdd785f[_0x1a6bc3]['To_invoice']=_0xb3fed9;}),_0x491ce0[_0x171057(0x1e2)]((_0x16691d,_0xb61f9e)=>{var _0x22cfba=_0x171057;_0x5caac1[_0x22cfba(0x1e2)]((_0x6fa209,_0x10fedf)=>{var _0x3bace0=_0x22cfba;if(_0x6fa209==_0x3bace0(0x13a)&&_0xb61f9e==_0x10fedf){var _0x36ab2=_0x16691d[_0x3bace0(0x1a1)](0x3);_0xdd785f[_0xb61f9e]['from_storage']=_0x16691d[0x0],_0xdd785f[_0xb61f9e]['from_rack']=_0x16691d[0x1],_0xdd785f[_0xb61f9e][_0x3bace0(0x1dc)]=0x0,_0xdd785f[_0xb61f9e][_0x3bace0(0x17b)]=0x0,_0xdd785f[_0xb61f9e][_0x3bace0(0x1be)]=_0x3bace0(0x195),_0xdd785f[_0xb61f9e][_0x3bace0(0x1ab)]=_0x36ab2;}else{if(_0x6fa209==_0x3bace0(0x1ae)&&_0xb61f9e==_0x10fedf){var _0x36ab2=_0x16691d[_0x3bace0(0x1a1)](0x3);_0xdd785f[_0xb61f9e][_0x3bace0(0x136)]=_0x16691d[0x0],_0xdd785f[_0xb61f9e]['from_rack']=_0x16691d[0x1],_0xdd785f[_0xb61f9e][_0x3bace0(0x1dc)]=0x0,_0xdd785f[_0xb61f9e][_0x3bace0(0x17b)]=0x0,_0xdd785f[_0xb61f9e][_0x3bace0(0x1be)]=_0x3bace0(0x195),_0xdd785f[_0xb61f9e]['from_floorlevel']=_0x16691d[0x5];}else{if(_0xb61f9e==_0x10fedf){var _0x5e47f9;if(_0x16691d[0x4]=='L')_0x5e47f9=_0x3bace0(0x223);else _0x16691d[0x4]=='F'&&(_0x5e47f9=_0x3bace0(0x195));_0xdd785f[_0xb61f9e]['from_storage']=_0x16691d[0x0],_0xdd785f[_0xb61f9e][_0x3bace0(0x1ce)]=_0x16691d[0x1],_0xdd785f[_0xb61f9e][_0x3bace0(0x1dc)]=_0x16691d[0x2],_0xdd785f[_0xb61f9e][_0x3bace0(0x17b)]=_0x16691d[0x3],_0xdd785f[_0xb61f9e]['from_types']=_0x5e47f9,_0xdd785f[_0xb61f9e][_0x3bace0(0x1ab)]=_0x16691d[0x5];}}}});}),_0x57c8f6['forEach']((_0x373f23,_0x1769d7)=>{var _0x2b2ee5=_0x171057;_0xdd785f[_0x1769d7][_0x2b2ee5(0x16a)]=_0x373f23;}),_0x17a28d[_0x171057(0x1e2)]((_0x346362,_0x2844f7)=>{var _0x16e645=_0x171057;_0x452efa[_0x16e645(0x1e2)]((_0x34ec88,_0xb328df)=>{var _0x19f504=_0x16e645;if(_0x34ec88==_0x19f504(0x13a)&&_0x2844f7==_0xb328df){var _0x41a9e5=_0x346362['slice'](0x3);_0xdd785f[_0x2844f7]['storage']=_0x346362[0x0],_0xdd785f[_0x2844f7][_0x19f504(0x1d0)]=_0x346362[0x1],_0xdd785f[_0x2844f7][_0x19f504(0x163)]=0x0,_0xdd785f[_0x2844f7]['to_bin']=0x0,_0xdd785f[_0x2844f7][_0x19f504(0x1da)]=_0x19f504(0x195),_0xdd785f[_0x2844f7]['to_floorlevel']=_0x41a9e5;}else{if(_0x34ec88==_0x19f504(0x1ae)&&_0x2844f7==_0xb328df){var _0x41a9e5=_0x346362['slice'](0x3);_0xdd785f[_0x2844f7][_0x19f504(0x1f9)]=_0x346362[0x0],_0xdd785f[_0x2844f7][_0x19f504(0x1d0)]=_0x346362[0x1],_0xdd785f[_0x2844f7][_0x19f504(0x163)]=0x0,_0xdd785f[_0x2844f7][_0x19f504(0x1f4)]=0x0,_0xdd785f[_0x2844f7][_0x19f504(0x1da)]=_0x19f504(0x195),_0xdd785f[_0x2844f7][_0x19f504(0x16e)]=_0x346362[0x5];}else{if(_0x2844f7==_0xb328df){var _0x16452a;if(_0x346362[0x4]=='L')_0x16452a=_0x19f504(0x223);else _0x346362[0x4]=='F'&&(_0x16452a='Floor');_0xdd785f[_0x2844f7][_0x19f504(0x1f9)]=_0x346362[0x0],_0xdd785f[_0x2844f7][_0x19f504(0x1d0)]=_0x346362[0x1],_0xdd785f[_0x2844f7][_0x19f504(0x163)]=_0x346362[0x2],_0xdd785f[_0x2844f7][_0x19f504(0x1f4)]=_0x346362[0x3],_0xdd785f[_0x2844f7][_0x19f504(0x1da)]=_0x16452a,_0xdd785f[_0x2844f7][_0x19f504(0x16e)]=_0x346362[0x5];}}}});}),_0x489e3a[_0x171057(0x1e2)]((_0x4e6984,_0x9e6346)=>{var _0x4fa2ec=_0x171057;_0xdd785f[_0x9e6346][_0x4fa2ec(0x202)]=_0x4e6984;}),_0x5e471a[_0x171057(0x1e2)]((_0x2b1b14,_0x45ae5b)=>{var _0x13cd98=_0x171057;_0xdd785f[_0x45ae5b][_0x13cd98(0x135)]=_0x2b1b14;}),_0x4c757d[_0x171057(0x1e2)]((_0x1acda1,_0x178288)=>{var _0x1b8ec0=_0x171057;_0xdd785f[_0x178288][_0x1b8ec0(0x204)]=_0x1acda1;}),_0x9f5924['forEach']((_0x398547,_0x1c2b67)=>{var _0x58faf4=_0x171057;_0xdd785f[_0x1c2b67][_0x58faf4(0x1e6)]=_0x398547;}),_0x2a3585[_0x171057(0x1e2)]((_0x5962fd,_0x485a4f)=>{var _0x274dcc=_0x171057;_0xdd785f[_0x485a4f][_0x274dcc(0x1a9)]=_0x5962fd;}),_0x543401[_0x171057(0x1e2)]((_0x476921,_0x412dc9)=>{var _0x3ce7af=_0x171057;_0xdd785f[_0x412dc9][_0x3ce7af(0x1ec)]=_0x476921;}),_0x176ec6[_0x171057(0x1e2)]((_0x8bd29,_0x3da640)=>{_0xdd785f[_0x3da640]['batch_code']=_0x8bd29;}),_0x29e492[_0x171057(0x1e2)]((_0xebcc07,_0x1498e7)=>{var _0x33a32f=_0x171057;_0xdd785f[_0x1498e7][_0x33a32f(0x197)]=_0xebcc07;}),_0x2fb636['forEach']((_0xd7155a,_0x346bd7)=>{_0xdd785f[_0x346bd7]['maxperunit']=_0xd7155a;}),_0x343a42[_0x171057(0x1e2)]((_0x4d8672,_0x230fda)=>{var _0x5989bb=_0x171057;_0xdd785f[_0x230fda][_0x5989bb(0x215)]=_0x4d8672;}),_0x4bb965[_0x171057(0x1e2)]((_0x4ccc22,_0xb11c6a)=>{var _0x3f99b0=_0x171057;_0xdd785f[_0xb11c6a][_0x3f99b0(0x15f)]=_0x4ccc22;}),_0x5caac1[_0x171057(0x1e2)]((_0xeda53c,_0x1d5310)=>{var _0x204601=_0x171057;_0xdd785f[_0x1d5310][_0x204601(0x183)]=_0xeda53c;}),_0x452efa[_0x171057(0x1e2)]((_0x4a2bbb,_0x41ab38)=>{var _0x2f5a4e=_0x171057;_0xdd785f[_0x41ab38][_0x2f5a4e(0x150)]=_0x4a2bbb;});const _0x3bd418=_0xdd785f[_0x171057(0x17e)](_0x3db1d6=>_0x3db1d6[_0x171057(0x16a)]!=='0'&&_0x3db1d6[_0x171057(0x16a)]!==''||_0x3db1d6['to_floorlevel']!=='0'&&_0x3db1d6['to_floorlevel']!==''),_0x2b5daa=new transfers({'date':_0x278d1c,'from_warehouse':_0x36b136,'to_warehouse':_0x5410cc,'product':_0x3bd418,'note':_0x4541db,'invoice':_0x44c859}),_0x358f1d=await _0x2b5daa[_0x171057(0x167)]();_0x15b0e7[_0x171057(0x1ea)](_0x171057(0x1c6),'Product\x20Transfer\x20successfully'),_0x31ede5[_0x171057(0x165)](_0x171057(0x1c2)+_0x358f1d[_0x171057(0x18f)]);}catch(_0x50293e){console[_0x171057(0x200)](_0x50293e),_0x31ede5[_0x171057(0x214)](0xc8)[_0x171057(0x1d8)]({'errorMessage':_0x50293e[_0x171057(0x193)]});}}),router[a0_0xbc1db0(0x144)](a0_0xbc1db0(0x21c),auth,async(_0x43925f,_0x4631c6)=>{var _0x4cd3a0=a0_0xbc1db0;try{const {username:_0x1ccd2a,email:_0x242120,role:_0x1870e1}=_0x43925f[_0x4cd3a0(0x13b)],_0x342fc0=_0x43925f[_0x4cd3a0(0x13b)],_0x1d137f=await profile['findOne']({'email':_0x342fc0[_0x4cd3a0(0x13c)]}),_0x45e8ca=await master_shop[_0x4cd3a0(0x145)]();console['log'](_0x4cd3a0(0x139),_0x45e8ca);const _0x595271=await transfers[_0x4cd3a0(0x1a7)](_0x43925f[_0x4cd3a0(0x13d)]['id']);let _0xd57822=new Date(_0x595271[_0x4cd3a0(0x197)]),_0x1f955d=('0'+_0xd57822[_0x4cd3a0(0x154)]())['slice'](-0x2),_0x6a0a99=('0'+(_0xd57822[_0x4cd3a0(0x166)]()+0x1))['slice'](-0x2),_0x4e149f=_0xd57822[_0x4cd3a0(0x1b1)](),_0x488011=_0x4e149f+'-'+_0x6a0a99+'-'+_0x1f955d,_0x41ad47;if(_0x342fc0['role']==_0x4cd3a0(0x1a5)){const _0x3836e9=await staff[_0x4cd3a0(0x1cf)]({'email':_0x342fc0[_0x4cd3a0(0x13c)]});_0x41ad47=await warehouse[_0x4cd3a0(0x145)]({'status':'Enabled','name':_0x3836e9[_0x4cd3a0(0x1f3)],'warehouse_category':'Raw\x20Materials'});}else _0x41ad47=await warehouse['find']({'status':_0x4cd3a0(0x1b9),'warehouse_category':_0x4cd3a0(0x208)});const _0x4f8442=await warehouse[_0x4cd3a0(0x206)]([{'$match':{'name':_0x595271[_0x4cd3a0(0x1db)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4cd3a0(0x1b4),'name':{'$first':_0x4cd3a0(0x1c8)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4cd3a0(0x143)},'bin':{'$first':_0x4cd3a0(0x1f7)},'type':{'$first':_0x4cd3a0(0x1c4)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4cd3a0(0x185)},'secondary_code':{'$first':_0x4cd3a0(0x212)},'product_code':{'$first':_0x4cd3a0(0x1a4)},'storage':{'$first':_0x4cd3a0(0x15e)},'rack':{'$first':_0x4cd3a0(0x14b)},'expiry_date':{'$first':_0x4cd3a0(0x15b)},'production_date':{'$first':_0x4cd3a0(0x227)},'room':{'$first':_0x4cd3a0(0x191)}}}]);if(_0x45e8ca[0x0]['language']==_0x4cd3a0(0x1b2)){var _0x24f83f=users[_0x4cd3a0(0x20e)];console[_0x4cd3a0(0x200)](_0x24f83f);}else{if(_0x45e8ca[0x0][_0x4cd3a0(0x14d)]==_0x4cd3a0(0x210))var _0x24f83f=users['Hindi'];else{if(_0x45e8ca[0x0]['language']==_0x4cd3a0(0x13f))var _0x24f83f=users[_0x4cd3a0(0x13f)];else{if(_0x45e8ca[0x0][_0x4cd3a0(0x14d)]==_0x4cd3a0(0x199))var _0x24f83f=users['Spanish'];else{if(_0x45e8ca[0x0][_0x4cd3a0(0x14d)]==_0x4cd3a0(0x147))var _0x24f83f=users[_0x4cd3a0(0x147)];else{if(_0x45e8ca[0x0]['language']==_0x4cd3a0(0x1a0))var _0x24f83f=users[_0x4cd3a0(0x18d)];else{if(_0x45e8ca[0x0][_0x4cd3a0(0x14d)]==_0x4cd3a0(0x205))var _0x24f83f=users['Chinese'];else{if(_0x45e8ca[0x0][_0x4cd3a0(0x14d)]==_0x4cd3a0(0x151))var _0x24f83f=users[_0x4cd3a0(0x1fb)];}}}}}}}_0x4631c6['render'](_0x4cd3a0(0x1c3),{'success':_0x43925f[_0x4cd3a0(0x1ea)](_0x4cd3a0(0x1c6)),'errors':_0x43925f['flash'](_0x4cd3a0(0x201)),'role':_0x342fc0,'profile':_0x1d137f,'master_shop':_0x45e8ca,'warehouse':_0x41ad47,'transfer':_0x595271,'stock':_0x4f8442,'language':_0x24f83f});}catch(_0x544e60){console[_0x4cd3a0(0x200)](_0x544e60);}}),router[a0_0xbc1db0(0x168)](a0_0xbc1db0(0x21c),auth,async(_0x1edb66,_0x4ea433)=>{var _0x436eec=a0_0xbc1db0;try{const _0x5a9b52=_0x1edb66[_0x436eec(0x13d)]['id'],{from_warehouse:_0xbced33,FromRoom_name:_0x554ca6,to_warehouse:_0x1eda30,ToRoom_name:_0x70cb43}=_0x1edb66[_0x436eec(0x1ac)],_0x320090=await transfers[_0x436eec(0x1a7)]({'_id':_0x5a9b52}),_0x5c0ca0=_0x320090[_0x436eec(0x1fc)][_0x436eec(0x221)](async _0x99c926=>{var _0x132110=_0x436eec;if(_0x99c926[_0x132110(0x16a)]>0x0){var _0x2c4af7=await warehouse[_0x132110(0x1cf)]({'name':_0x320090[_0x132110(0x1db)],'room':_0x99c926[_0x132110(0x183)],'warehouse_category':_0x132110(0x208)});const _0x53be57=_0x2c4af7[_0x132110(0x1aa)][_0x132110(0x221)](_0x33c24f=>{var _0x3b282a=_0x132110;_0x33c24f['product_name']==_0x99c926[_0x3b282a(0x1a6)]&&_0x33c24f[_0x3b282a(0x21b)]==_0x99c926[_0x3b282a(0x1ab)]&&_0x33c24f['type']==_0x99c926[_0x3b282a(0x1be)]&&_0x33c24f['bin']==_0x99c926[_0x3b282a(0x17b)]&&_0x33c24f[_0x3b282a(0x1b6)]==_0x99c926[_0x3b282a(0x1dc)]&&_0x33c24f[_0x3b282a(0x1d0)]==_0x99c926[_0x3b282a(0x1ce)]&&_0x33c24f[_0x3b282a(0x1f9)]==_0x99c926[_0x3b282a(0x136)]&&_0x33c24f['expiry_date']==_0x99c926['expiry_date']&&_0x33c24f[_0x3b282a(0x21d)]==_0x99c926[_0x3b282a(0x21d)]&&_0x33c24f[_0x3b282a(0x215)]==_0x99c926['production_date']&&_0x33c24f[_0x3b282a(0x1a8)]==_0x99c926[_0x3b282a(0x141)]&&(_0x33c24f[_0x3b282a(0x1f6)]=_0x33c24f[_0x3b282a(0x1f6)]-_0x99c926['to_quantity']);});}return _0x2c4af7;});Promise['all'](_0x5c0ca0)['then'](async _0x1c4497=>{var _0x5479ee=_0x436eec;try{for(const _0x12720c of _0x1c4497){await _0x12720c[_0x5479ee(0x167)]();}try{const _0x5b7338=_0x320090[_0x5479ee(0x1fc)]['map'](async _0x17f214=>{var _0x5b7f20=_0x5479ee;if(_0x17f214[_0x5b7f20(0x16a)]>0x0){var _0x5cee4b=await warehouse[_0x5b7f20(0x1cf)]({'name':_0x320090[_0x5b7f20(0x1dd)],'room':_0x17f214[_0x5b7f20(0x150)],'warehouse_category':_0x5b7f20(0x208)}),_0x367b80=0x0;const _0xb26540=_0x5cee4b['product_details'][_0x5b7f20(0x221)](_0x1c32de=>{var _0x15fe05=_0x5b7f20;_0x1c32de[_0x15fe05(0x1a6)]==_0x17f214[_0x15fe05(0x1a6)]&&_0x1c32de[_0x15fe05(0x21b)]==_0x17f214['to_floorlevel']&&_0x1c32de['type']==_0x17f214['to_types']&&_0x1c32de[_0x15fe05(0x14c)]==_0x17f214[_0x15fe05(0x1f4)]&&_0x1c32de['bay']==_0x17f214[_0x15fe05(0x163)]&&_0x1c32de[_0x15fe05(0x1d0)]==_0x17f214[_0x15fe05(0x1d0)]&&_0x1c32de[_0x15fe05(0x1f9)]==_0x17f214[_0x15fe05(0x1f9)]&&_0x1c32de[_0x15fe05(0x197)]==_0x17f214[_0x15fe05(0x197)]&&_0x1c32de[_0x15fe05(0x21d)]==_0x17f214[_0x15fe05(0x21d)]&&_0x1c32de[_0x15fe05(0x215)]==_0x17f214['production_date']&&_0x1c32de[_0x15fe05(0x1a8)]==_0x17f214[_0x15fe05(0x164)]&&(_0x1c32de['product_stock']=_0x1c32de['product_stock']+_0x17f214[_0x15fe05(0x16a)],_0x367b80++);});_0x367b80=='0'&&(_0x5cee4b[_0x5b7f20(0x1aa)]=_0x5cee4b[_0x5b7f20(0x1aa)][_0x5b7f20(0x228)]({'product_name':_0x17f214[_0x5b7f20(0x1a6)],'product_stock':_0x17f214['to_quantity'],'bay':_0x17f214[_0x5b7f20(0x163)],'bin':_0x17f214[_0x5b7f20(0x1f4)],'type':_0x17f214['to_types'],'floorlevel':_0x17f214[_0x5b7f20(0x16e)],'storage':_0x17f214['storage'],'rack':_0x17f214[_0x5b7f20(0x1d0)],'product_code':_0x17f214[_0x5b7f20(0x204)],'primary_code':_0x17f214['primary_code'],'secondary_code':_0x17f214[_0x5b7f20(0x135)],'maxProducts':_0x17f214[_0x5b7f20(0x1e6)],'storage':_0x17f214[_0x5b7f20(0x1f9)],'rack':_0x17f214[_0x5b7f20(0x1d0)],'expiry_date':_0x17f214[_0x5b7f20(0x197)],'maxPerUnit':_0x17f214[_0x5b7f20(0x224)],'batch_code':_0x17f214[_0x5b7f20(0x21d)],'production_date':_0x17f214[_0x5b7f20(0x215)]}));}return _0x5cee4b;});Promise[_0x5479ee(0x19a)](_0x5b7338)[_0x5479ee(0x21f)](async _0x52772d=>{var _0x16159d=_0x5479ee;try{for(const _0x4dd486 of _0x52772d){await warehouse[_0x16159d(0x1e9)]({'_id':_0x4dd486[_0x16159d(0x18f)]},{'$addToSet':{'product_details':{'$each':_0x4dd486[_0x16159d(0x1aa)]}}});}_0x320090['finalize']=_0x16159d(0x137);const _0x8c6695=await _0x320090[_0x16159d(0x167)](),_0x323d05=await master_shop[_0x16159d(0x145)](),_0x3c4ee0=await email_settings['findOne'](),_0x548bbe=await supervisor_settings[_0x16159d(0x145)]();var _0x444e09=_0x320090['product'],_0x566107='',_0x131279;for(_0x131279 in _0x444e09){_0x566107+=_0x16159d(0x17d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x444e09[_0x131279][_0x16159d(0x1a6)]+_0x16159d(0x1d1)+_0x16159d(0x16c)+_0x444e09[_0x131279]['product_code']+_0x16159d(0x1d1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x444e09[_0x131279][_0x16159d(0x16a)]+_0x16159d(0x1d1)+_0x16159d(0x16c)+_0x444e09[_0x131279]['unit']+_0x16159d(0x1d1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x444e09[_0x131279][_0x16159d(0x1ec)]+_0x16159d(0x1d1)+_0x16159d(0x16c)+_0x320090['to_warehouse']+'</td>'+_0x16159d(0x16c)+_0x444e09[_0x131279]['to_room_name']+_0x16159d(0x1d1)+_0x16159d(0x16c)+_0x444e09[_0x131279][_0x16159d(0x1f9)]+_0x444e09[_0x131279]['rack']+_0x444e09[_0x131279][_0x16159d(0x163)]+_0x444e09[_0x131279]['to_bin']+_0x444e09[_0x131279]['to_types'][0x0]+_0x444e09[_0x131279][_0x16159d(0x16e)]+_0x16159d(0x1d1),_0x16159d(0x190);}let _0x2efa34=nodemailer[_0x16159d(0x1a2)]({'host':_0x3c4ee0[_0x16159d(0x220)],'port':Number(_0x3c4ee0[_0x16159d(0x138)]),'secure':![],'auth':{'user':_0x3c4ee0['email'],'pass':_0x3c4ee0[_0x16159d(0x1df)]}}),_0x5e57b8={'from':_0x3c4ee0['email'],'to':_0x548bbe[0x0][_0x16159d(0x1b3)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x16159d(0x16f),'path':__dirname+_0x16159d(0x1fd)+'/upload/'+_0x323d05[0x0]['image'],'cid':_0x16159d(0x1d2)}],'html':_0x16159d(0x159)+'<html><head><title></title>'+_0x16159d(0x20c)+'<div>'+_0x16159d(0x217)+_0x16159d(0x17f)+_0x16159d(0x213)+_0x16159d(0x1c5)+_0x16159d(0x17f)+'<h2>\x20'+_0x323d05[0x0][_0x16159d(0x1b5)]+_0x16159d(0x177)+'</div>'+_0x16159d(0x1c5)+_0x16159d(0x179)+_0x16159d(0x17f)+_0x16159d(0x1ca)+'\x20Order\x20Number\x20:\x20'+_0x320090[_0x16159d(0x1a8)]+'\x20'+_0x16159d(0x181)+_0x16159d(0x1f0)+_0x320090[_0x16159d(0x209)]+'\x20'+_0x16159d(0x175)+'</h5>'+_0x16159d(0x1c5)+_0x16159d(0x146)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x16159d(0x17d)+_0x16159d(0x178)+_0x16159d(0x1b0)+_0x16159d(0x20f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x16159d(0x1bf)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x16159d(0x172)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x16159d(0x190)+_0x16159d(0x15d)+_0x16159d(0x19c)+'\x20'+_0x566107+'\x20'+_0x16159d(0x1bd)+'</table>'+'<div>'+_0x16159d(0x226)+_0x16159d(0x142)+_0x323d05[0x0][_0x16159d(0x1b5)]+_0x16159d(0x162)+'</div>'+'</div>'+_0x16159d(0x211)};_0x2efa34[_0x16159d(0x18c)](_0x5e57b8,function(_0x45a5cb,_0x49b167){var _0x4d1569=_0x16159d;_0x45a5cb?(console[_0x4d1569(0x200)](_0x45a5cb),console[_0x4d1569(0x200)](_0x4d1569(0x158))):console[_0x4d1569(0x200)]('Email\x20sent\x20successfully');}),_0x1edb66[_0x16159d(0x1ea)](_0x16159d(0x1c6),_0x16159d(0x182)),_0x4ea433[_0x16159d(0x165)](_0x16159d(0x134)+_0x8c6695['_id']);}catch(_0x4876e3){console[_0x16159d(0x1af)](_0x4876e3),_0x4ea433['status'](0x1f4)[_0x16159d(0x1d8)]({'Perror':_0x16159d(0x17c),'message':_0x4876e3['message']});}})['catch'](_0x2c79b2=>{var _0x310ed0=_0x5479ee;console[_0x310ed0(0x1af)](_0x2c79b2),_0x4ea433[_0x310ed0(0x214)](0x1f4)['json']({'Perror':_0x310ed0(0x1cb)});});}catch(_0x3340d2){_0x4ea433[_0x5479ee(0x1d8)](_0x3340d2);}}catch(_0x50c83b){console[_0x5479ee(0x1af)](_0x50c83b),_0x4ea433[_0x5479ee(0x214)](0x1f4)[_0x5479ee(0x1d8)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x50c83b['message']});}})[_0x436eec(0x1fa)](_0x4e6924=>{var _0x2d40af=_0x436eec;console['error'](_0x4e6924),_0x4ea433[_0x2d40af(0x214)](0x1f4)[_0x2d40af(0x1d8)]({'Merror':_0x2d40af(0x1cb)});});}catch(_0xf1ae18){console['log'](_0xf1ae18);}});function BayBinSelected(_0x56fe79,_0x49a411){var _0x28e3ac=a0_0xbc1db0,_0x49e29b=[],_0x833b45=[],_0x1578ba=[],_0x572576=[],_0x26b465=[],_0x201e7e=[];let _0x309323=[];if(_0x56fe79==_0x28e3ac(0x207))switch(_0x49a411){case _0x28e3ac(0x1e3):_0x49e29b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x833b45=[0x1,0x2],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=[_0x28e3ac(0x223),_0x28e3ac(0x195)],_0x26b465=['D'],_0x201e7e=['A'];break;case _0x28e3ac(0x1d3):_0x49e29b=[0x6,0x5,0x4,0x3,0x2,0x1],_0x833b45=[0x1,0x2],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=[_0x28e3ac(0x223),_0x28e3ac(0x195)],_0x26b465=['D'],_0x201e7e=['B'];break;case _0x28e3ac(0x1ae):_0x49e29b=[0x0],_0x833b45=[0x0],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=[_0x28e3ac(0x195)],_0x26b465=['D'],_0x201e7e=['S'];break;case _0x28e3ac(0x13a):_0x49e29b=[0x0],_0x833b45=[0x0],_0x572576=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1578ba=['Floor'],_0x26b465=['D'],_0x201e7e=['R'];break;}else{if(_0x56fe79==_0x28e3ac(0x1eb))switch(_0x49a411){case _0x28e3ac(0x1e3):_0x49e29b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x833b45=['B','F'],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=[_0x28e3ac(0x223),'Floor'],_0x26b465=['C'],_0x201e7e=['A'];break;case _0x28e3ac(0x1d3):_0x49e29b=[0x5,0x4,0x3,0x2,0x1],_0x833b45=['F','B','S'],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=[_0x28e3ac(0x223),_0x28e3ac(0x195)],_0x26b465=['C'],_0x201e7e=['B'];break;case _0x28e3ac(0x1c1):_0x49e29b=[0x1,0x2,0x3,0x4,0x5],_0x833b45=['B','F','S'],_0x572576=[0x5,0x4,0x3,0x2,0x1],_0x1578ba=[_0x28e3ac(0x223),'Floor'],_0x26b465=['C'],_0x201e7e=['C'];break;case _0x28e3ac(0x1ee):_0x49e29b=[0x5,0x4,0x3,0x2,0x1],_0x833b45=['F','B','S'],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=['Level',_0x28e3ac(0x195)],_0x26b465=['C'],_0x201e7e=['D'];break;case _0x28e3ac(0x203):_0x49e29b=[0x4,0x3,0x2,0x1],_0x833b45=[0x1,0x2],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=[_0x28e3ac(0x223),_0x28e3ac(0x195)],_0x26b465=['C'],_0x201e7e=['E'];break;case _0x28e3ac(0x160):_0x49e29b=[0x1,0x2,0x3],_0x833b45=[0x1,0x2],_0x572576=[0x1,0x2,0x3,0x4,0x5],_0x1578ba=[_0x28e3ac(0x223)],_0x26b465=['C'],_0x201e7e=['F'];break;}}return{'levels':_0x49e29b,'Isle':_0x833b45,'rack':_0x572576,'type':_0x1578ba,'storage':_0x26b465,'rak':_0x201e7e};}router[a0_0xbc1db0(0x144)](a0_0xbc1db0(0x20d),auth,async(_0x191257,_0x57ebd2)=>{var _0x4fd504=a0_0xbc1db0;try{const {username:_0x11bd39,email:_0x1bf3af,role:_0x41195c}=_0x191257[_0x4fd504(0x13b)],_0x5f0d16=_0x191257[_0x4fd504(0x13b)],_0x15d8d7=await profile[_0x4fd504(0x1cf)]({'email':_0x5f0d16[_0x4fd504(0x13c)]}),_0x32656d=await master_shop[_0x4fd504(0x145)](),_0x5d0592=await transfers[_0x4fd504(0x1a7)](_0x191257['params']['id']);let _0x3cc9c1;if(_0x5f0d16[_0x4fd504(0x1d7)]=='staff'){const _0x1c1258=await staff[_0x4fd504(0x1cf)]({'email':_0x5f0d16[_0x4fd504(0x13c)]});_0x3cc9c1=await warehouse[_0x4fd504(0x206)]([{'$match':{'status':_0x4fd504(0x1b9),'name':_0x1c1258[_0x4fd504(0x1f3)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4fd504(0x188),'name':{'$first':_0x4fd504(0x188)}}}]);}else _0x3cc9c1=await warehouse['aggregate']([{'$match':{'status':_0x4fd504(0x1b9),'warehouse_category':_0x4fd504(0x208)}},{'$group':{'_id':_0x4fd504(0x188),'name':{'$first':_0x4fd504(0x188)}}}]);const _0x41b3f9=await warehouse[_0x4fd504(0x206)]([{'$match':{'name':_0x5d0592[_0x4fd504(0x1db)],'warehouse_category':_0x4fd504(0x208)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4fd504(0x1b4),'name':{'$first':_0x4fd504(0x1c8)},'product_stock':{'$first':_0x4fd504(0x1f5)},'bay':{'$first':_0x4fd504(0x143)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4fd504(0x1c4)},'floorlevel':{'$first':_0x4fd504(0x1b7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4fd504(0x212)},'product_code':{'$first':_0x4fd504(0x1a4)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4fd504(0x14b)},'expiry_date':{'$first':_0x4fd504(0x15b)},'production_date':{'$first':_0x4fd504(0x227)},'room':{'$first':'$room'}}}]),_0x250ef=await product['find']({}),_0xdc99cb=BayBinSelected(_0x5d0592[_0x4fd504(0x1dd)],_0x5d0592['to_room']);if(_0x32656d[0x0][_0x4fd504(0x14d)]=='English\x20(US)'){var _0xb7ad86=users[_0x4fd504(0x20e)];console[_0x4fd504(0x200)](_0xb7ad86);}else{if(_0x32656d[0x0]['language']=='Hindi')var _0xb7ad86=users[_0x4fd504(0x210)];else{if(_0x32656d[0x0]['language']==_0x4fd504(0x13f))var _0xb7ad86=users['German'];else{if(_0x32656d[0x0][_0x4fd504(0x14d)]==_0x4fd504(0x199))var _0xb7ad86=users[_0x4fd504(0x199)];else{if(_0x32656d[0x0][_0x4fd504(0x14d)]==_0x4fd504(0x147))var _0xb7ad86=users[_0x4fd504(0x147)];else{if(_0x32656d[0x0][_0x4fd504(0x14d)]==_0x4fd504(0x1a0))var _0xb7ad86=users[_0x4fd504(0x18d)];else{if(_0x32656d[0x0][_0x4fd504(0x14d)]==_0x4fd504(0x205))var _0xb7ad86=users['Chinese'];else{if(_0x32656d[0x0]['language']==_0x4fd504(0x151))var _0xb7ad86=users[_0x4fd504(0x1fb)];}}}}}}}_0x57ebd2['render'](_0x4fd504(0x1ed),{'success':_0x191257[_0x4fd504(0x1ea)](_0x4fd504(0x1c6)),'errors':_0x191257[_0x4fd504(0x1ea)](_0x4fd504(0x201)),'role':_0x5f0d16,'profile':_0x15d8d7,'master_shop':_0x32656d,'warehouse':_0x3cc9c1,'transfer':_0x5d0592,'stock':_0x41b3f9,'unit':_0x250ef,'language':_0xb7ad86});}catch(_0xcd13b8){console[_0x4fd504(0x200)](_0xcd13b8);}}),router['post']('/view/:id',auth,async(_0x3e2279,_0x237586)=>{var _0x40df9d=a0_0xbc1db0;try{const _0x3108b9=_0x3e2279[_0x40df9d(0x13d)]['id'],_0xa7418c=await transfers[_0x40df9d(0x1a7)](_0x3108b9);_0x237586[_0x40df9d(0x1d8)](_0x3e2279[_0x40df9d(0x1ac)]);return;const {date:_0x21bc91,from_warehouse:_0x251dd2,FromRoom_name:_0x1d8b6a,to_warehouse:_0x318c0c,ToRoom_name:_0x3855c9,prod_name:_0xa03bda,from_prod_qty:_0x3c6063,from_prod_level:_0x17e5aa,from_prod_isle:_0x234614,from_prod_pallet:_0x196d23,to_prod_qty:_0x563adf,to_prod_level:_0x4f5f17,to_prod_isle:_0x1e7b57,to_prod_pallet:_0x25d00d,primary_code:_0x7c5eb5,secondary_code:_0x47c1ce,product_code3:_0x3cb1e3,note:_0x1d8ae6,invoice:_0x30b572,expiry_date:_0x49c77b}=_0x3e2279[_0x40df9d(0x1ac)];if(typeof _0xa03bda==_0x40df9d(0x155))var _0x13e072=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x171)]],_0x22e288=[_0x3e2279['body']['from_prod_qty']],_0x4c7270=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1a3)]],_0x27bbd9=[_0x3e2279['body']['from_prod_isle']],_0x8d1d87=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1bc)]],_0x463553=[_0x3e2279['body'][_0x40df9d(0x1be)]],_0x1aead7=[_0x3e2279[_0x40df9d(0x1ac)]['to_prod_qty']],_0x5e0f95=[_0x3e2279['body'][_0x40df9d(0x20b)]],_0xe71c55=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x16b)]],_0x28fe0e=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x19f)]],_0x5a628f=[_0x3e2279['body'][_0x40df9d(0x1da)]],_0xebed46=[_0x3e2279[_0x40df9d(0x1ac)]['storage']],_0x308daf=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x157)]],_0x521052=[_0x3e2279[_0x40df9d(0x1ac)]['primary_code']],_0x457fa2=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x135)]],_0x506355=[_0x3e2279[_0x40df9d(0x1ac)]['product_code3']],_0xd0b16a=[_0x3e2279[_0x40df9d(0x1ac)]['MaxStocks_data2']],_0x33403c=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1a9)]],_0x15b2e1=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1ec)]],_0x16878a=[_0x3e2279['body'][_0x40df9d(0x21d)]],_0x1d5bde=[_0x3e2279[_0x40df9d(0x1ac)]['expiry_date']],_0x2c4067=[_0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x136)]],_0x4f4289=[_0x3e2279[_0x40df9d(0x1ac)]['from_rak']];else var _0x13e072=[..._0x3e2279[_0x40df9d(0x1ac)]['prod_name']],_0xebed46=[..._0x3e2279['body'][_0x40df9d(0x1f9)]],_0x308daf=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x157)]],_0x463553=[..._0x3e2279['body'][_0x40df9d(0x1be)]],_0x5a628f=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1da)]],_0x22e288=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x149)]],_0x4c7270=[..._0x3e2279[_0x40df9d(0x1ac)]['from_prod_level']],_0x27bbd9=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1e4)]],_0x8d1d87=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1bc)]],_0x1aead7=[..._0x3e2279['body'][_0x40df9d(0x1bb)]],_0x5e0f95=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x20b)]],_0xe71c55=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x16b)]],_0x28fe0e=[..._0x3e2279['body'][_0x40df9d(0x19f)]],_0x521052=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x202)]],_0x457fa2=[..._0x3e2279['body'][_0x40df9d(0x135)]],_0x506355=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1e8)]],_0xd0b16a=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x20a)]],_0x33403c=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x1a9)]],_0x15b2e1=[..._0x3e2279['body'][_0x40df9d(0x1ec)]],_0x16878a=[..._0x3e2279[_0x40df9d(0x1ac)][_0x40df9d(0x21d)]],_0x1d5bde=[..._0x3e2279[_0x40df9d(0x1ac)]['expiry_date']],_0x2c4067=[..._0x3e2279['body'][_0x40df9d(0x136)]],_0x4f4289=[..._0x3e2279[_0x40df9d(0x1ac)]['from_rak']];const _0x40fecb=_0x13e072['map'](_0x4ba3ca=>{return _0x4ba3ca={'product_name':_0x4ba3ca};});_0x22e288['forEach']((_0x2f1cad,_0x3ea187)=>{var _0x48ee14=_0x40df9d;_0x40fecb[_0x3ea187][_0x48ee14(0x21e)]=_0x2f1cad;}),_0x4c7270[_0x40df9d(0x1e2)]((_0x516a4a,_0x42c686)=>{_0x40fecb[_0x42c686]['from_bay']=_0x516a4a;}),_0x27bbd9['forEach']((_0x174095,_0x2f780f)=>{var _0x26d09e=_0x40df9d;_0x40fecb[_0x2f780f][_0x26d09e(0x17b)]=_0x174095;}),_0x8d1d87['forEach']((_0x45f883,_0x4c0605)=>{var _0x5551f6=_0x40df9d;_0x40fecb[_0x4c0605][_0x5551f6(0x1ab)]=_0x45f883;}),_0x1aead7['forEach']((_0xece58a,_0xda671a)=>{var _0x215058=_0x40df9d;_0x40fecb[_0xda671a][_0x215058(0x16a)]=_0xece58a;}),_0x5e0f95[_0x40df9d(0x1e2)]((_0x438b1b,_0x2d55df)=>{var _0x2bcc12=_0x40df9d;_0x40fecb[_0x2d55df][_0x2bcc12(0x163)]=_0x438b1b;}),_0xe71c55[_0x40df9d(0x1e2)]((_0x4f3027,_0x205db7)=>{var _0x106c43=_0x40df9d;_0x40fecb[_0x205db7][_0x106c43(0x1f4)]=_0x4f3027;}),_0x28fe0e[_0x40df9d(0x1e2)]((_0x49182e,_0x56c1f2)=>{var _0x50fbf9=_0x40df9d;_0x40fecb[_0x56c1f2][_0x50fbf9(0x16e)]=_0x49182e;}),_0x521052[_0x40df9d(0x1e2)]((_0x590f59,_0x1e2d02)=>{_0x40fecb[_0x1e2d02]['primary_code']=_0x590f59;}),_0x457fa2[_0x40df9d(0x1e2)]((_0x3d428b,_0x3490db)=>{var _0x482b88=_0x40df9d;_0x40fecb[_0x3490db][_0x482b88(0x135)]=_0x3d428b;}),_0x506355[_0x40df9d(0x1e2)]((_0x517d21,_0x2d379c)=>{var _0x346606=_0x40df9d;_0x40fecb[_0x2d379c][_0x346606(0x204)]=_0x517d21;}),_0xd0b16a[_0x40df9d(0x1e2)]((_0x1110ff,_0x1ca55a)=>{var _0x1036cb=_0x40df9d;_0x40fecb[_0x1ca55a][_0x1036cb(0x1e6)]=_0x1110ff;}),_0x33403c[_0x40df9d(0x1e2)]((_0x2c60b2,_0x58d485)=>{var _0x1fa38c=_0x40df9d;_0x40fecb[_0x58d485][_0x1fa38c(0x1a9)]=_0x2c60b2;}),_0x15b2e1['forEach']((_0x5dfdc4,_0x2adefa)=>{var _0x121ec1=_0x40df9d;_0x40fecb[_0x2adefa][_0x121ec1(0x1ec)]=_0x5dfdc4;}),_0x16878a['forEach']((_0x5e8e00,_0x3f013b)=>{_0x40fecb[_0x3f013b]['batch_code']=_0x5e8e00;}),_0x1d5bde[_0x40df9d(0x1e2)]((_0x1445e0,_0x12047e)=>{var _0x5a8312=_0x40df9d;_0x40fecb[_0x12047e][_0x5a8312(0x197)]=_0x1445e0;}),_0xebed46[_0x40df9d(0x1e2)]((_0x52a3f0,_0x5db88b)=>{var _0x373e78=_0x40df9d;_0x40fecb[_0x5db88b][_0x373e78(0x1f9)]=_0x52a3f0;}),_0x308daf[_0x40df9d(0x1e2)]((_0xacec05,_0x9ee54b)=>{var _0x2b96a5=_0x40df9d;_0x40fecb[_0x9ee54b][_0x2b96a5(0x1d0)]=_0xacec05;}),_0x463553[_0x40df9d(0x1e2)]((_0x3df1e8,_0x5a1fc6)=>{var _0x411f8a=_0x40df9d;_0x40fecb[_0x5a1fc6][_0x411f8a(0x1be)]=_0x3df1e8;}),_0x5a628f[_0x40df9d(0x1e2)]((_0x181745,_0x33c55b)=>{var _0x5e59e7=_0x40df9d;_0x40fecb[_0x33c55b][_0x5e59e7(0x1da)]=_0x181745;}),_0x2c4067[_0x40df9d(0x1e2)]((_0x1372ef,_0x3a3f9c)=>{var _0x421f5b=_0x40df9d;_0x40fecb[_0x3a3f9c][_0x421f5b(0x136)]=_0x1372ef;}),_0x4f4289['forEach']((_0x3370f6,_0x4714db)=>{_0x40fecb[_0x4714db]['from_rack']=_0x3370f6;});const _0xd7d68e=_0x40fecb['filter'](_0x5d7852=>_0x5d7852[_0x40df9d(0x16a)]!=='0'&&_0x5d7852[_0x40df9d(0x16a)]!==''||_0x5d7852['to_floorlevel']!=='0'&&_0x5d7852[_0x40df9d(0x16e)]!=='');var _0x179fae=0x0;_0xd7d68e[_0x40df9d(0x1e2)](_0x4b4f71=>{var _0x56daa4=_0x40df9d;parseInt(_0x4b4f71['from_quantity'])<parseInt(_0x4b4f71[_0x56daa4(0x16a)])&&_0x179fae++;});if(_0x179fae!=0x0)return _0x3e2279[_0x40df9d(0x1ea)](_0x40df9d(0x201),_0x40df9d(0x184)),_0x237586[_0x40df9d(0x165)](_0x40df9d(0x180));const _0x54d387=await warehouse[_0x40df9d(0x1cf)]({'name':_0xa7418c[_0x40df9d(0x1db)],'room':_0xa7418c[_0x40df9d(0x15a)]});_0xa7418c[_0x40df9d(0x1fc)][_0x40df9d(0x1e2)](_0x489bed=>{var _0x38b3b5=_0x40df9d;if(_0x489bed[_0x38b3b5(0x16a)]>0x0){const _0x410e6e=_0x54d387[_0x38b3b5(0x1aa)][_0x38b3b5(0x221)](_0x30fdec=>{var _0x25d228=_0x38b3b5;_0x30fdec[_0x25d228(0x1a6)]==_0x489bed[_0x25d228(0x1a6)]&&_0x30fdec[_0x25d228(0x21b)]==_0x489bed[_0x25d228(0x1ab)]&&_0x30fdec[_0x25d228(0x192)]==_0x489bed['from_types']&&_0x30fdec[_0x25d228(0x14c)]==_0x489bed['from_bin']&&_0x30fdec[_0x25d228(0x1b6)]==_0x489bed['from_bay']&&_0x30fdec[_0x25d228(0x1d0)]==_0x489bed[_0x25d228(0x1ce)]&&_0x30fdec[_0x25d228(0x1f9)]==_0x489bed[_0x25d228(0x136)]&&(_0x30fdec[_0x25d228(0x1f6)]=parseInt(_0x30fdec[_0x25d228(0x1f6)])+parseInt(_0x489bed[_0x25d228(0x16a)]));});}}),await _0x54d387[_0x40df9d(0x167)]();const _0x295a44=await warehouse[_0x40df9d(0x1cf)]({'name':_0xa7418c[_0x40df9d(0x1dd)],'room':_0xa7418c[_0x40df9d(0x1ad)]});_0xa7418c['product'][_0x40df9d(0x1e2)](_0x53cc0b=>{var _0x2152fb=_0x40df9d;if(_0x53cc0b[_0x2152fb(0x16a)]>0x0){const _0x4aea0a=_0x295a44[_0x2152fb(0x1aa)][_0x2152fb(0x221)](_0x13b16c=>{var _0x34ace2=_0x2152fb;_0x13b16c['product_name']==_0x53cc0b['product_name']&&_0x13b16c[_0x34ace2(0x21b)]==_0x53cc0b[_0x34ace2(0x16e)]&&_0x13b16c[_0x34ace2(0x192)]==_0x53cc0b[_0x34ace2(0x1da)]&&_0x13b16c['bin']==_0x53cc0b['to_bin']&&_0x13b16c[_0x34ace2(0x1b6)]==_0x53cc0b[_0x34ace2(0x163)]&&_0x13b16c[_0x34ace2(0x1d0)]==_0x53cc0b[_0x34ace2(0x1d0)]&&_0x13b16c[_0x34ace2(0x1f9)]==_0x53cc0b[_0x34ace2(0x1f9)]&&(_0x13b16c['product_stock']=parseInt(_0x13b16c[_0x34ace2(0x1f6)])-parseInt(_0x53cc0b[_0x34ace2(0x16a)]));});}}),await _0x295a44['save'](),_0xa7418c[_0x40df9d(0x209)]=_0x21bc91,_0xa7418c[_0x40df9d(0x1db)]=_0x251dd2,_0xa7418c[_0x40df9d(0x1dd)]=_0x318c0c,_0xa7418c[_0x40df9d(0x1fc)]=_0xd7d68e,_0xa7418c[_0x40df9d(0x1cd)]=_0x1d8ae6,_0xa7418c[_0x40df9d(0x1a8)]=_0x30b572;const _0xe60e69=await _0xa7418c[_0x40df9d(0x167)]();console[_0x40df9d(0x200)](_0xe60e69);const _0x55667c=await warehouse[_0x40df9d(0x1cf)]({'name':_0x251dd2,'room':_0x1d8b6a});_0xe60e69[_0x40df9d(0x1fc)][_0x40df9d(0x1e2)](_0x5ccc8c=>{var _0xdb5df3=_0x40df9d;if(_0x5ccc8c[_0xdb5df3(0x16a)]>0x0){const _0x25b7e2=_0x55667c['product_details'][_0xdb5df3(0x221)](_0x1ddfb6=>{var _0x338ffb=_0xdb5df3;_0x1ddfb6[_0x338ffb(0x1a6)]==_0x5ccc8c[_0x338ffb(0x1a6)]&&_0x1ddfb6['floorlevel']==_0x5ccc8c[_0x338ffb(0x1ab)]&&_0x1ddfb6['type']==_0x5ccc8c['from_types']&&_0x1ddfb6[_0x338ffb(0x14c)]==_0x5ccc8c['from_bin']&&_0x1ddfb6[_0x338ffb(0x1b6)]==_0x5ccc8c[_0x338ffb(0x1dc)]&&_0x1ddfb6['rack']==_0x5ccc8c[_0x338ffb(0x1ce)]&&_0x1ddfb6['storage']==_0x5ccc8c[_0x338ffb(0x136)]&&(_0x1ddfb6[_0x338ffb(0x1f6)]=parseInt(_0x1ddfb6[_0x338ffb(0x1f6)])-parseInt(_0x5ccc8c[_0x338ffb(0x16a)]));});}}),await _0x55667c[_0x40df9d(0x167)]();const _0x3858d7=await warehouse['findOne']({'name':_0x318c0c,'room':_0x3855c9});_0xe60e69[_0x40df9d(0x1fc)]['forEach'](_0x1c0290=>{var _0x21d704=_0x40df9d;if(_0x1c0290['to_quantity']>0x0){var _0x2a5875=0x0;const _0x1b08f5=_0x3858d7[_0x21d704(0x1aa)]['map'](_0x366319=>{var _0x40b1ab=_0x21d704;_0x366319[_0x40b1ab(0x1a6)]==_0x1c0290[_0x40b1ab(0x1a6)]&&_0x366319[_0x40b1ab(0x21b)]==_0x1c0290[_0x40b1ab(0x16e)]&&_0x366319[_0x40b1ab(0x192)]==_0x1c0290['to_types']&&_0x366319[_0x40b1ab(0x14c)]==_0x1c0290[_0x40b1ab(0x1f4)]&&_0x366319[_0x40b1ab(0x1b6)]==_0x1c0290[_0x40b1ab(0x163)]&&_0x366319[_0x40b1ab(0x1d0)]==_0x1c0290[_0x40b1ab(0x1d0)]&&_0x366319[_0x40b1ab(0x1f9)]==_0x1c0290[_0x40b1ab(0x1f9)]&&(_0x366319[_0x40b1ab(0x1f6)]=parseInt(_0x366319[_0x40b1ab(0x1f6)])+parseInt(_0x1c0290[_0x40b1ab(0x16a)]),_0x2a5875++);});_0x2a5875=='0'&&(_0x3858d7[_0x21d704(0x1aa)]=_0x3858d7[_0x21d704(0x1aa)]['concat']({'product_name':_0x1c0290[_0x21d704(0x1a6)],'product_stock':_0x1c0290[_0x21d704(0x16a)],'bay':_0x1c0290[_0x21d704(0x163)],'bin':_0x1c0290[_0x21d704(0x1f4)],'type':_0x1c0290[_0x21d704(0x1da)],'floorlevel':_0x1c0290[_0x21d704(0x16e)],'storage':_0x1c0290[_0x21d704(0x1f9)],'rack':_0x1c0290[_0x21d704(0x1d0)],'product_code':_0x1c0290['product_code'],'primary_code':_0x1c0290[_0x21d704(0x202)],'secondary_code':_0x1c0290[_0x21d704(0x135)],'maxProducts':_0x1c0290[_0x21d704(0x1e6)],'storage':_0x1c0290[_0x21d704(0x1f9)],'rack':_0x1c0290[_0x21d704(0x1d0)]}));}}),await _0x3858d7[_0x40df9d(0x167)](),_0x3e2279['flash']('success',_0x40df9d(0x19e)),_0x237586['redirect']('/transfer/view');}catch(_0x4e609b){console[_0x40df9d(0x200)](_0x4e609b);}}),router[a0_0xbc1db0(0x168)](a0_0xbc1db0(0x189),async(_0x38dbf7,_0x130e78)=>{var _0x1c0fa7=a0_0xbc1db0;const {FromWareHouse:_0x124e02,FromRoom:_0x2fd938,ToWarehouse:_0x736f59,ToRoom:_0x2d464b,primary_code:_0x1cf743,Roomslist:_0x373e73}=_0x38dbf7[_0x1c0fa7(0x1ac)],_0x87ee3c=_0x373e73[_0x1c0fa7(0x1e0)](','),_0x163365=[];async function _0x40e824(_0x182e78){var _0x13b431=_0x1c0fa7;const _0x2b192f=await warehouse['aggregate']([{'$match':{'name':_0x124e02,'room':_0x182e78}},{'$unwind':_0x13b431(0x19d)},{'$match':{'product_details.primary_code':_0x1cf743}},{'$group':{'_id':_0x13b431(0x1b4),'name':{'$first':_0x13b431(0x1c8)},'instock':{'$first':_0x13b431(0x1f5)},'primary_code':{'$first':_0x13b431(0x185)},'secondary_code':{'$first':_0x13b431(0x212)},'product_code':{'$first':_0x13b431(0x1a4)},'level':{'$first':_0x13b431(0x143)},'isle':{'$first':_0x13b431(0x1f7)},'type':{'$first':_0x13b431(0x1c4)},'pallet':{'$first':_0x13b431(0x1b7)},'unit':{'$first':_0x13b431(0x222)},'secondary_unit':{'$first':_0x13b431(0x15c)},'storage':{'$first':_0x13b431(0x15e)},'rack':{'$first':_0x13b431(0x14b)},'expiry_date':{'$first':_0x13b431(0x15b)},'production_date':{'$first':_0x13b431(0x227)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x13b431(0x191)},'maxProducts':{'$first':_0x13b431(0x140)}}}]),_0x3a89ea=await warehouse[_0x13b431(0x206)]([{'$match':{'name':_0x124e02,'room':_0x182e78}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x1cf743}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x13b431(0x1c8)},'instock':{'$first':_0x13b431(0x1f5)},'primary_code':{'$first':_0x13b431(0x185)},'secondary_code':{'$first':_0x13b431(0x212)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x13b431(0x143)},'isle':{'$first':_0x13b431(0x1f7)},'type':{'$first':_0x13b431(0x1c4)},'pallet':{'$first':_0x13b431(0x1b7)},'unit':{'$first':_0x13b431(0x222)},'secondary_unit':{'$first':_0x13b431(0x15c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x13b431(0x14b)},'expiry_date':{'$first':_0x13b431(0x15b)},'production_date':{'$first':_0x13b431(0x227)},'batch_code':{'$first':_0x13b431(0x1ff)},'maxPerUnit':{'$first':_0x13b431(0x1e7)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x13b431(0x140)}}}]);if(_0x2b192f[_0x13b431(0x1c9)]>0x0)_0x163365[_0x13b431(0x194)](_0x2b192f);else _0x3a89ea[_0x13b431(0x1c9)]>0x0&&_0x163365[_0x13b431(0x194)](_0x3a89ea);}const _0x3ded34=_0x87ee3c[_0x1c0fa7(0x221)](_0x953d48=>_0x40e824(_0x953d48));await Promise[_0x1c0fa7(0x19a)](_0x3ded34),_0x130e78['json'](_0x163365);}),router[a0_0xbc1db0(0x168)](a0_0xbc1db0(0x13e),async(_0x4b344a,_0xca5ba1)=>{var _0x5950bc=a0_0xbc1db0;try{const {FromWareHouse:_0x579108,FromRoom:_0x3f4f06,ToWarehouse:_0x4309ce,ToRoom:_0x1875a7,secondary_code:_0x569057}=_0x4b344a[_0x5950bc(0x1ac)],_0x14d075=await warehouse['aggregate']([{'$match':{'name':_0x579108}},{'$unwind':_0x5950bc(0x19d)},{'$match':{'product_details.secondary_code':_0x569057}},{'$group':{'_id':_0x5950bc(0x1b4),'name':{'$first':_0x5950bc(0x1c8)},'primary_code':{'$first':_0x5950bc(0x185)},'secondary_code':{'$first':_0x5950bc(0x212)},'product_code':{'$first':_0x5950bc(0x1a4)},'instock':{'$first':_0x5950bc(0x1f5)},'warehouse':{'$first':'$name'},'level':{'$first':_0x5950bc(0x1ba)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x5950bc(0x174)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x5950bc(0x222)}}}]);_0xca5ba1[_0x5950bc(0x214)](0xc8)['json'](_0x14d075);}catch(_0x26a8ab){_0xca5ba1['status'](0x194)[_0x5950bc(0x1d8)]({'message':_0x26a8ab[_0x5950bc(0x193)]});}}),router['post']('/barcode_scanner3',async(_0x1372a4,_0x5cf5d2)=>{var _0x243493=a0_0xbc1db0;try{const {FromWareHouse:_0x2dd157,FromRoom:_0x35fc88,ToWarehouse:_0x9f031c,ToRoom:_0x1daed0,product_code:_0x4136f9}=_0x1372a4[_0x243493(0x1ac)],_0x17aa38=await warehouse['aggregate']([{'$match':{'name':_0x2dd157}},{'$unwind':_0x243493(0x19d)},{'$match':{'product_details.product_code':_0x4136f9}},{'$group':{'_id':_0x243493(0x1b4),'name':{'$first':_0x243493(0x1c8)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x243493(0x212)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x243493(0x1ba)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x243493(0x174)},'maxProducts':{'$first':_0x243493(0x140)},'unit':{'$first':'$product_details.unit'}}}]);_0x5cf5d2[_0x243493(0x214)](0xc8)[_0x243493(0x1d8)](_0x17aa38);}catch(_0x434410){_0x5cf5d2['status'](0x194)[_0x243493(0x1d8)]({'message':_0x434410[_0x243493(0x193)]});}}),router[a0_0xbc1db0(0x168)](a0_0xbc1db0(0x21a),async(_0x57f54e,_0x3f8ee5)=>{var _0x1023b2=a0_0xbc1db0;const {level:_0x5e539d,isle:_0x3547a6,pallet:_0x3869a1,warehouses:_0x5c328c,room:_0x2e682e}=_0x57f54e[_0x1023b2(0x1ac)];try{const _0x553bed=await warehouse['aggregate']([{'$match':{'name':_0x5c328c,'room':_0x2e682e}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x5e539d),'product_details.isle':_0x3547a6,'product_details.pallet':parseInt(_0x3869a1)}},{'$group':{'_id':_0x1023b2(0x1b4),'name':{'$first':_0x1023b2(0x1c8)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x1023b2(0x1ba)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x1023b2(0x174)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x3f8ee5['status'](0xc8)[_0x1023b2(0x1d8)](_0x553bed);}catch(_0x14e9e1){_0x3f8ee5[_0x1023b2(0x214)](0x194)[_0x1023b2(0x1d8)]({'message':_0x14e9e1[_0x1023b2(0x193)]});}}),module[a0_0xbc1db0(0x14e)]=router;