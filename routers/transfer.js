var a0_0x12f112=a0_0x40cb;(function(_0x187ccb,_0x1d26a0){var _0x2d6042=a0_0x40cb,_0x1d4683=_0x187ccb();while(!![]){try{var _0x4e67f3=-parseInt(_0x2d6042(0x1a3))/0x1*(parseInt(_0x2d6042(0x178))/0x2)+parseInt(_0x2d6042(0x16d))/0x3+parseInt(_0x2d6042(0xcd))/0x4+parseInt(_0x2d6042(0x1bc))/0x5*(parseInt(_0x2d6042(0x189))/0x6)+parseInt(_0x2d6042(0x19a))/0x7*(parseInt(_0x2d6042(0xd5))/0x8)+parseInt(_0x2d6042(0x1b6))/0x9+-parseInt(_0x2d6042(0x1b2))/0xa*(parseInt(_0x2d6042(0xc7))/0xb);if(_0x4e67f3===_0x1d26a0)break;else _0x1d4683['push'](_0x1d4683['shift']());}catch(_0x1172df){_0x1d4683['push'](_0x1d4683['shift']());}}}(a0_0xb0d4,0xb84ec),require(a0_0x12f112(0xf9))[a0_0x12f112(0x143)]());const express=require('express'),app=express(),router=express[a0_0x12f112(0x127)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x12f112(0x19c)),nodemailer=require(a0_0x12f112(0xf7)),mongoose=require(a0_0x12f112(0x139));router[a0_0x12f112(0x11f)](a0_0x12f112(0x175),auth,async(_0x5e4ec3,_0x3bbfa0)=>{var _0x291f92=a0_0x12f112;try{const {username:_0x28813c,email:_0x21bc7e,role:_0x52ed92}=_0x5e4ec3[_0x291f92(0xe1)],_0xc97cec=_0x5e4ec3['user'],_0x3b32b9=await profile[_0x291f92(0x13a)]({'email':_0xc97cec['email']}),_0x511edd=await master_shop['find']();console['log'](_0x291f92(0xdd),_0x511edd);let _0x406bad;if(_0xc97cec[_0x291f92(0xea)]==_0x291f92(0x146)){const _0x13c05a=await staff['findOne']({'email':_0xc97cec[_0x291f92(0x131)]});_0x406bad=await transfers[_0x291f92(0x19d)]({'from_warehouse':_0x13c05a[_0x291f92(0xbf)]});}else _0x406bad=await transfers['aggregate']([{'$unwind':_0x291f92(0x17b)},{'$group':{'_id':_0x291f92(0x14d),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x291f92(0x185)},'to_warehouse':{'$first':_0x291f92(0x114)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x291f92(0x107)},'finalize':{'$first':_0x291f92(0xe4)},'isAllowEdit':{'$first':_0x291f92(0x10f)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x511edd[0x0][_0x291f92(0xeb)]==_0x291f92(0x15d)){var _0x1774a6=users[_0x291f92(0xcc)];console['log'](_0x1774a6);}else{if(_0x511edd[0x0]['language']==_0x291f92(0x15b))var _0x1774a6=users['Hindi'];else{if(_0x511edd[0x0][_0x291f92(0xeb)]==_0x291f92(0xf2))var _0x1774a6=users['German'];else{if(_0x511edd[0x0][_0x291f92(0xeb)]==_0x291f92(0x159))var _0x1774a6=users['Spanish'];else{if(_0x511edd[0x0]['language']=='French')var _0x1774a6=users[_0x291f92(0x15c)];else{if(_0x511edd[0x0][_0x291f92(0xeb)]==_0x291f92(0xb7))var _0x1774a6=users[_0x291f92(0x101)];else{if(_0x511edd[0x0][_0x291f92(0xeb)]=='Chinese')var _0x1774a6=users[_0x291f92(0x10b)];else{if(_0x511edd[0x0][_0x291f92(0xeb)]==_0x291f92(0xe3))var _0x1774a6=users[_0x291f92(0x157)];}}}}}}}_0x3bbfa0['render'](_0x291f92(0x109),{'success':_0x5e4ec3['flash']('success'),'errors':_0x5e4ec3[_0x291f92(0x108)](_0x291f92(0x11d)),'role':_0xc97cec,'profile':_0x3b32b9,'master_shop':_0x511edd,'transfer':_0x406bad,'language':_0x1774a6});}catch(_0x3ffdb9){console[_0x291f92(0x133)](_0x3ffdb9);}});async function getRandom8DigitNumber(){var _0x389efc=a0_0x12f112;const _0x4f669f=0x989680,_0xb61aaa=0x5f5e0ff,_0x56b1fb=Math[_0x389efc(0xe8)](Math[_0x389efc(0x1bd)]()*(_0xb61aaa-_0x4f669f+0x1))+_0x4f669f;var _0x8c1eda;const _0xfedd4c=await transfers[_0x389efc(0x13a)]({'invoice':_0x389efc(0xc2)+_0x56b1fb});return _0xfedd4c&&_0xfedd4c[_0x389efc(0x180)]>0x0?_0x8c1eda=_0x389efc(0xc2)+_0x56b1fb:_0x8c1eda=_0x389efc(0xc2)+_0x56b1fb,_0x8c1eda;}router[a0_0x12f112(0x11f)](a0_0x12f112(0x1ac),auth,async(_0x2c9261,_0x2c1e5c)=>{var _0x394a4c=a0_0x12f112;try{const {username:_0x4cc9ea,email:_0x44d1a2,role:_0x439142}=_0x2c9261['user'],_0x5e6abc=_0x2c9261['user'],_0x184a1a=await profile[_0x394a4c(0x13a)]({'email':_0x5e6abc[_0x394a4c(0x131)]}),_0x36d796=await master_shop['find']();console['log'](_0x394a4c(0xdd),_0x36d796);let _0x6ad54a;if(_0x5e6abc[_0x394a4c(0xea)]==_0x394a4c(0x146)){const _0x33b487=await staff[_0x394a4c(0x13a)]({'email':_0x5e6abc[_0x394a4c(0x131)]});_0x6ad54a=await warehouse['aggregate']([{'$match':{'status':_0x394a4c(0x15f),'name':_0x33b487[_0x394a4c(0xbf)],'warehouse_category':_0x394a4c(0xde)}},{'$group':{'_id':_0x394a4c(0xd0),'name':{'$first':_0x394a4c(0xd0)}}}]);}else _0x6ad54a=await warehouse[_0x394a4c(0xbd)]([{'$match':{'status':_0x394a4c(0x15f),'warehouse_category':_0x394a4c(0xde)}},{'$group':{'_id':_0x394a4c(0xd0),'name':{'$first':_0x394a4c(0xd0)}}}]);var _0x17aa54=[_0x394a4c(0x14f),_0x394a4c(0x13e),'Return\x20Rooms'];const _0x48c9d4=await transfers[_0x394a4c(0x19d)]({}),_0x42ca51=_0x48c9d4['length']+0x1,_0x18589d=_0x394a4c(0xc2)+_0x42ca51[_0x394a4c(0x199)]()['padStart'](0x5,'0');if(_0x36d796[0x0][_0x394a4c(0xeb)]=='English\x20(US)'){var _0x336d1f=users['English'];console[_0x394a4c(0x133)](_0x336d1f);}else{if(_0x36d796[0x0][_0x394a4c(0xeb)]==_0x394a4c(0x15b))var _0x336d1f=users[_0x394a4c(0x15b)];else{if(_0x36d796[0x0][_0x394a4c(0xeb)]=='German')var _0x336d1f=users['German'];else{if(_0x36d796[0x0][_0x394a4c(0xeb)]=='Spanish')var _0x336d1f=users[_0x394a4c(0x159)];else{if(_0x36d796[0x0][_0x394a4c(0xeb)]=='French')var _0x336d1f=users[_0x394a4c(0x15c)];else{if(_0x36d796[0x0][_0x394a4c(0xeb)]==_0x394a4c(0xb7))var _0x336d1f=users[_0x394a4c(0x101)];else{if(_0x36d796[0x0]['language']=='Chinese')var _0x336d1f=users['Chinese'];else{if(_0x36d796[0x0][_0x394a4c(0xeb)]==_0x394a4c(0xe3))var _0x336d1f=users[_0x394a4c(0x157)];}}}}}}}const _0x5a9f83=getRandom8DigitNumber();_0x5a9f83[_0x394a4c(0xb9)](_0x219d1a=>{var _0x393958=_0x394a4c;_0x2c1e5c['render']('add_transfer',{'success':_0x2c9261['flash']('success'),'errors':_0x2c9261['flash'](_0x393958(0x11d)),'role':_0x5e6abc,'profile':_0x184a1a,'master_shop':_0x36d796,'warehouse':_0x6ad54a,'language':_0x336d1f,'rooms_data':_0x17aa54,'invoice':_0x219d1a});})[_0x394a4c(0x149)](_0x196c32=>{var _0x354793=_0x394a4c;_0x2c9261[_0x354793(0x108)](_0x354793(0x11d),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2c1e5c[_0x354793(0xe6)](_0x354793(0xc6));});}catch(_0xfaace0){console[_0x394a4c(0x133)](_0xfaace0);}}),router[a0_0x12f112(0x12f)]('/view/add_transfer',auth,async(_0x2ab7fd,_0x1a1bf6)=>{var _0x242800=a0_0x12f112;try{console['log'](_0x2ab7fd[_0x242800(0xce)]);const {date:_0xbefbaa,from_warehouse:_0xa6933d,FromRoom_name:_0x270f9f,to_warehouse:_0x191854,ToRoom_name:_0x4d2de7,prod_name:_0x4563ed,from_prod_qty:_0xc74703,from_prod_level:_0x3e7a4a,from_prod_isle:_0x5c6071,from_prod_pallet:_0x532af9,to_prod_qty:_0x16c3e2,to_prod_level:_0xc3c9ba,to_prod_isle:_0x41d916,to_prod_pallet:_0x2b6ead,primary_code:_0x1ac48e,secondary_code:_0x5df3cb,product_code3:_0x4e03c1,note:_0x2f517b,MaxStocks_data2:_0x4bc046,invoice:_0x380586,expiry_date:_0x17d899}=_0x2ab7fd[_0x242800(0xce)];if(typeof _0x4563ed=='string')var _0xb6dd09=[_0x2ab7fd['body'][_0x242800(0xe0)]],_0x5ce2cb=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x18c)]],_0x3383ca=[_0x2ab7fd[_0x242800(0xce)]['from_prod_level']],_0x1507eb=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0xd8)]],_0x4e0b04=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x16b)]],_0x121da1=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x1b1)]],_0x35082d=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x116)]],_0x481836=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x12b)]],_0xbd20b0=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x198)]],_0x227f5a=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0xbe)]],_0x4d8a3b=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x1a8)]],_0x16e93b=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x17a)]],_0x45c20f=[_0x2ab7fd['body'][_0x242800(0x113)]],_0x43ea83=[_0x2ab7fd['body'][_0x242800(0x15e)]],_0x4cc3e4=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x100)]],_0x58514d=[_0x2ab7fd[_0x242800(0xce)]['prod_cat']],_0x1fe036=[_0x2ab7fd[_0x242800(0xce)]['RoomAssigned']],_0x995dcb=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x148)]],_0x30e77f=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x119)]],_0x20f7c4=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0x18f)]],_0x3ac296=[_0x2ab7fd[_0x242800(0xce)][_0x242800(0xe5)]];else var _0xb6dd09=[..._0x2ab7fd['body']['prod_name']],_0x5ce2cb=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x18c)]],_0x3383ca=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x1b7)]],_0x1507eb=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0xd8)]],_0x4e0b04=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x16b)]],_0x121da1=[..._0x2ab7fd['body'][_0x242800(0x1b1)]],_0x35082d=[..._0x2ab7fd[_0x242800(0xce)]['secondary_code']],_0x481836=[..._0x2ab7fd[_0x242800(0xce)]['product_code3']],_0xbd20b0=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x198)]],_0x227f5a=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0xbe)]],_0x4d8a3b=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x1a8)]],_0x16e93b=[..._0x2ab7fd[_0x242800(0xce)]['batch_code']],_0x45c20f=[..._0x2ab7fd['body'][_0x242800(0x113)]],_0x43ea83=[..._0x2ab7fd[_0x242800(0xce)]['max_per_unit']],_0x4cc3e4=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x100)]],_0x58514d=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x18a)]],_0x1fe036=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x122)]],_0x995dcb=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x148)]],_0x30e77f=[..._0x2ab7fd[_0x242800(0xce)]['from_invoice']],_0x20f7c4=[..._0x2ab7fd[_0x242800(0xce)][_0x242800(0x18f)]],_0x3ac296=[..._0x2ab7fd['body'][_0x242800(0xe5)]];const _0x5c57b9=_0xb6dd09[_0x242800(0x138)](_0x4c835b=>{return _0x4c835b={'product_name':_0x4c835b};});_0x5ce2cb['forEach']((_0xe3c856,_0x3bbd65)=>{var _0x1cca96=_0x242800;_0x5c57b9[_0x3bbd65][_0x1cca96(0x18b)]=_0xe3c856;}),_0x30e77f[_0x242800(0x193)]((_0x2b045e,_0x81b03a)=>{var _0x4c3d7d=_0x242800;_0x5c57b9[_0x81b03a][_0x4c3d7d(0x119)]=_0x2b045e;}),_0x20f7c4['forEach']((_0x447ec9,_0x3ff94f)=>{_0x5c57b9[_0x3ff94f]['To_invoice']=_0x447ec9;}),_0x3ac296['forEach']((_0x5776bc,_0x1f7202)=>{_0x5c57b9[_0x1f7202]['id_transaction_id']=_0x5776bc;}),_0x3383ca[_0x242800(0x193)]((_0xdd174c,_0x4b9ca1)=>{_0x1fe036['forEach']((_0x13715c,_0x2e31ee)=>{var _0x177d9d=a0_0x40cb;if(_0x13715c==_0x177d9d(0x1ae)&&_0x4b9ca1==_0x2e31ee){var _0x16032e=_0xdd174c[_0x177d9d(0x141)](0x3);_0x5c57b9[_0x4b9ca1]['from_storage']=_0xdd174c[0x0],_0x5c57b9[_0x4b9ca1][_0x177d9d(0x170)]=_0xdd174c[0x1],_0x5c57b9[_0x4b9ca1][_0x177d9d(0xff)]=0x0,_0x5c57b9[_0x4b9ca1][_0x177d9d(0x126)]=0x0,_0x5c57b9[_0x4b9ca1][_0x177d9d(0x196)]='Floor',_0x5c57b9[_0x4b9ca1][_0x177d9d(0x165)]=_0x16032e;}else{if(_0x13715c==_0x177d9d(0xbc)&&_0x4b9ca1==_0x2e31ee){var _0x16032e=_0xdd174c[_0x177d9d(0x141)](0x3);_0x5c57b9[_0x4b9ca1][_0x177d9d(0x168)]=_0xdd174c[0x0],_0x5c57b9[_0x4b9ca1][_0x177d9d(0x170)]=_0xdd174c[0x1],_0x5c57b9[_0x4b9ca1]['from_bay']=0x0,_0x5c57b9[_0x4b9ca1]['from_bin']=0x0,_0x5c57b9[_0x4b9ca1][_0x177d9d(0x196)]=_0x177d9d(0x16f),_0x5c57b9[_0x4b9ca1][_0x177d9d(0x165)]=_0xdd174c[0x5];}else{if(_0x4b9ca1==_0x2e31ee){if(_0xdd174c[0x0]=='A'&&_0xdd174c[0x1]=='L'&&_0xdd174c[0x2]=='L')console['log'](_0x13715c+_0x177d9d(0x173)+_0x4b9ca1+_0x177d9d(0x173)+_0x2e31ee+_0x177d9d(0x173)+_0xdd174c+_0x177d9d(0x1ba)),_0x5c57b9[_0x4b9ca1]['from_storage']=_0xdd174c[0x0],_0x5c57b9[_0x4b9ca1][_0x177d9d(0x170)]=_0xdd174c[0x1],_0x5c57b9[_0x4b9ca1][_0x177d9d(0xff)]=0x0,_0x5c57b9[_0x4b9ca1][_0x177d9d(0x126)]=0x0,_0x5c57b9[_0x4b9ca1][_0x177d9d(0x196)]=_0x177d9d(0x16f),_0x5c57b9[_0x4b9ca1]['from_floorlevel']=_0xdd174c[0x3];else{var _0x561222;if(_0xdd174c[0x4]=='L')_0x561222='Level';else _0xdd174c[0x4]=='F'&&(_0x561222=_0x177d9d(0x16f));_0x5c57b9[_0x4b9ca1][_0x177d9d(0x168)]=_0xdd174c[0x0],_0x5c57b9[_0x4b9ca1][_0x177d9d(0x170)]=_0xdd174c[0x1],_0x5c57b9[_0x4b9ca1]['from_bay']=_0xdd174c[0x2],_0x5c57b9[_0x4b9ca1][_0x177d9d(0x126)]=_0xdd174c[0x3],_0x5c57b9[_0x4b9ca1]['from_types']=_0x561222,_0x5c57b9[_0x4b9ca1][_0x177d9d(0x165)]=_0xdd174c[0x5];}}}}});}),_0x1507eb[_0x242800(0x193)]((_0x1ee0db,_0x27460f)=>{var _0x211e60=_0x242800;_0x5c57b9[_0x27460f][_0x211e60(0x13f)]=_0x1ee0db;}),_0x4e0b04[_0x242800(0x193)]((_0x19e790,_0x56c7d4)=>{_0x995dcb['forEach']((_0x11b612,_0xddc2c)=>{var _0x235d6c=a0_0x40cb;if(_0x11b612==_0x235d6c(0x1ae)&&_0x56c7d4==_0xddc2c){var _0x423ce5=_0x19e790[_0x235d6c(0x141)](0x3);_0x5c57b9[_0x56c7d4][_0x235d6c(0xfb)]=_0x19e790[0x0],_0x5c57b9[_0x56c7d4][_0x235d6c(0x129)]=_0x19e790[0x1],_0x5c57b9[_0x56c7d4][_0x235d6c(0x167)]=0x0,_0x5c57b9[_0x56c7d4][_0x235d6c(0x16e)]=0x0,_0x5c57b9[_0x56c7d4]['to_types']='Floor',_0x5c57b9[_0x56c7d4][_0x235d6c(0x155)]=_0x423ce5;}else{if(_0x11b612==_0x235d6c(0xbc)&&_0x56c7d4==_0xddc2c){var _0x423ce5=_0x19e790[_0x235d6c(0x141)](0x3);_0x5c57b9[_0x56c7d4][_0x235d6c(0xfb)]=_0x19e790[0x0],_0x5c57b9[_0x56c7d4][_0x235d6c(0x129)]=_0x19e790[0x1],_0x5c57b9[_0x56c7d4][_0x235d6c(0x167)]=0x0,_0x5c57b9[_0x56c7d4][_0x235d6c(0x16e)]=0x0,_0x5c57b9[_0x56c7d4][_0x235d6c(0x186)]=_0x235d6c(0x16f),_0x5c57b9[_0x56c7d4][_0x235d6c(0x155)]=_0x19e790[0x5];}else{if(_0x56c7d4==_0xddc2c){if(_0x19e790[0x0]=='A'&&_0x19e790[0x1]=='L'&&_0x19e790[0x2]=='L')console[_0x235d6c(0x133)](_0x11b612+'\x20<>\x20'+_0x56c7d4+_0x235d6c(0x173)+_0xddc2c+_0x235d6c(0x173)+_0x19e790+'here'),_0x5c57b9[_0x56c7d4]['storage']=_0x19e790[0x0],_0x5c57b9[_0x56c7d4][_0x235d6c(0x129)]=_0x19e790[0x1],_0x5c57b9[_0x56c7d4][_0x235d6c(0x167)]=0x0,_0x5c57b9[_0x56c7d4][_0x235d6c(0x16e)]=0x0,_0x5c57b9[_0x56c7d4][_0x235d6c(0x186)]='Floor',_0x5c57b9[_0x56c7d4]['to_floorlevel']=_0x19e790[0x3];else{var _0x39564c;if(_0x19e790[0x4]=='L')_0x39564c=_0x235d6c(0xed);else _0x19e790[0x4]=='F'&&(_0x39564c='Floor');_0x5c57b9[_0x56c7d4]['storage']=_0x19e790[0x0],_0x5c57b9[_0x56c7d4]['rack']=_0x19e790[0x1],_0x5c57b9[_0x56c7d4][_0x235d6c(0x167)]=_0x19e790[0x2],_0x5c57b9[_0x56c7d4][_0x235d6c(0x16e)]=_0x19e790[0x3],_0x5c57b9[_0x56c7d4][_0x235d6c(0x186)]=_0x39564c,_0x5c57b9[_0x56c7d4][_0x235d6c(0x155)]=_0x19e790[0x5];}}}}});}),_0x121da1[_0x242800(0x193)]((_0x5f2a51,_0x1529b8)=>{var _0x23c305=_0x242800;_0x5c57b9[_0x1529b8][_0x23c305(0x1b1)]=_0x5f2a51;}),_0x35082d[_0x242800(0x193)]((_0x527646,_0x2b7d1e)=>{_0x5c57b9[_0x2b7d1e]['secondary_code']=_0x527646;}),_0x481836[_0x242800(0x193)]((_0x261d1d,_0x2853e1)=>{var _0x94eec4=_0x242800;_0x5c57b9[_0x2853e1][_0x94eec4(0x12e)]=_0x261d1d;}),_0xbd20b0[_0x242800(0x193)]((_0x121304,_0xc90c63)=>{var _0x570b58=_0x242800;_0x5c57b9[_0xc90c63][_0x570b58(0x194)]=_0x121304;}),_0x227f5a[_0x242800(0x193)]((_0x56eae2,_0x446270)=>{var _0x40e74b=_0x242800;_0x5c57b9[_0x446270][_0x40e74b(0x132)]=_0x56eae2;}),_0x4d8a3b['forEach']((_0x9cad22,_0x45707a)=>{var _0x1fc7e9=_0x242800;_0x5c57b9[_0x45707a][_0x1fc7e9(0x1a8)]=_0x9cad22;}),_0x16e93b[_0x242800(0x193)]((_0x4c7d60,_0x44ce04)=>{var _0x2c9c82=_0x242800;_0x5c57b9[_0x44ce04][_0x2c9c82(0x17a)]=_0x4c7d60;}),_0x45c20f[_0x242800(0x193)]((_0x2e9545,_0x58efb4)=>{var _0x1b28e0=_0x242800;_0x5c57b9[_0x58efb4][_0x1b28e0(0x113)]=_0x2e9545;}),_0x43ea83['forEach']((_0x594e08,_0x301ada)=>{var _0x5b13f7=_0x242800;_0x5c57b9[_0x301ada][_0x5b13f7(0xb4)]=_0x594e08;}),_0x4cc3e4[_0x242800(0x193)]((_0x32bdfa,_0x4be3a7)=>{_0x5c57b9[_0x4be3a7]['production_date']=_0x32bdfa;}),_0x58514d[_0x242800(0x193)]((_0x56c2e3,_0x27b508)=>{_0x5c57b9[_0x27b508]['prod_cat']=_0x56c2e3;}),_0x1fe036[_0x242800(0x193)]((_0x2203fa,_0x51ab70)=>{var _0x4f3fd5=_0x242800;_0x5c57b9[_0x51ab70][_0x4f3fd5(0x151)]=_0x2203fa;}),_0x995dcb[_0x242800(0x193)]((_0x421d03,_0x2b2985)=>{_0x5c57b9[_0x2b2985]['to_room_name']=_0x421d03;});const _0x54d24a=_0x5c57b9[_0x242800(0x1a0)](_0x5163f2=>_0x5163f2[_0x242800(0x13f)]!=='0'&&_0x5163f2[_0x242800(0x13f)]!==''||_0x5163f2[_0x242800(0x155)]!=='0'&&_0x5163f2['to_floorlevel']!==''),_0x1b47c9=new transfers({'date':_0xbefbaa,'from_warehouse':_0xa6933d,'to_warehouse':_0x191854,'product':_0x54d24a,'note':_0x2f517b,'invoice':_0x380586}),_0x2b9222=await _0x1b47c9[_0x242800(0x18e)]();_0x2ab7fd[_0x242800(0x108)](_0x242800(0x12c),'Product\x20Transfer\x20successfully'),_0x1a1bf6[_0x242800(0xe6)](_0x242800(0x12d)+_0x2b9222['_id']);}catch(_0x1bdb48){console[_0x242800(0x133)](_0x1bdb48),_0x1a1bf6['status'](0xc8)[_0x242800(0xe2)]({'errorMessage':_0x1bdb48[_0x242800(0x115)]});}}),router[a0_0x12f112(0x11f)]('/preview/:id',auth,async(_0x587748,_0x3db3da)=>{var _0x1b27fe=a0_0x12f112;try{const {username:_0x363f9e,email:_0x1fb194,role:_0x1863e4}=_0x587748[_0x1b27fe(0xe1)],_0x27af35=_0x587748[_0x1b27fe(0xe1)],_0x44163b=await profile[_0x1b27fe(0x13a)]({'email':_0x27af35[_0x1b27fe(0x131)]}),_0x4fb9be=await master_shop[_0x1b27fe(0x19d)]();console['log'](_0x1b27fe(0xdd),_0x4fb9be);const _0x2f92ba=await transfers[_0x1b27fe(0x162)](_0x587748[_0x1b27fe(0xb6)]['id']);let _0x58510a=new Date(_0x2f92ba['expiry_date']),_0x80c607=('0'+_0x58510a[_0x1b27fe(0x1b4)]())[_0x1b27fe(0x141)](-0x2),_0xaafbbe=('0'+(_0x58510a[_0x1b27fe(0x1a2)]()+0x1))[_0x1b27fe(0x141)](-0x2),_0x128dd9=_0x58510a[_0x1b27fe(0x1aa)](),_0x2c408c=_0x128dd9+'-'+_0xaafbbe+'-'+_0x80c607,_0x3f325b;if(_0x27af35['role']=='staff'){const _0x19e13a=await staff[_0x1b27fe(0x13a)]({'email':_0x27af35[_0x1b27fe(0x131)]});_0x3f325b=await warehouse[_0x1b27fe(0x19d)]({'status':_0x1b27fe(0x15f),'name':_0x19e13a[_0x1b27fe(0xbf)],'warehouse_category':_0x1b27fe(0xde)});}else _0x3f325b=await warehouse[_0x1b27fe(0x19d)]({'status':_0x1b27fe(0x15f),'warehouse_category':_0x1b27fe(0xde)});const _0x24bb6d=await warehouse[_0x1b27fe(0xbd)]([{'$match':{'name':_0x2f92ba[_0x1b27fe(0x187)]}},{'$unwind':_0x1b27fe(0xb8)},{'$group':{'_id':_0x1b27fe(0x177),'name':{'$first':_0x1b27fe(0x124)},'product_stock':{'$first':_0x1b27fe(0x106)},'bay':{'$first':_0x1b27fe(0x1b3)},'bin':{'$first':_0x1b27fe(0x103)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1b27fe(0x12a)},'primary_code':{'$first':_0x1b27fe(0xba)},'secondary_code':{'$first':_0x1b27fe(0x1af)},'product_code':{'$first':_0x1b27fe(0xee)},'storage':{'$first':_0x1b27fe(0x153)},'rack':{'$first':_0x1b27fe(0x150)},'expiry_date':{'$first':_0x1b27fe(0xc5)},'production_date':{'$first':_0x1b27fe(0xca)},'room':{'$first':_0x1b27fe(0x17f)}}}]);if(_0x4fb9be[0x0]['language']==_0x1b27fe(0x15d)){var _0x40a376=users[_0x1b27fe(0xcc)];console[_0x1b27fe(0x133)](_0x40a376);}else{if(_0x4fb9be[0x0][_0x1b27fe(0xeb)]=='Hindi')var _0x40a376=users[_0x1b27fe(0x15b)];else{if(_0x4fb9be[0x0][_0x1b27fe(0xeb)]==_0x1b27fe(0xf2))var _0x40a376=users[_0x1b27fe(0xf2)];else{if(_0x4fb9be[0x0]['language']==_0x1b27fe(0x159))var _0x40a376=users[_0x1b27fe(0x159)];else{if(_0x4fb9be[0x0]['language']==_0x1b27fe(0x15c))var _0x40a376=users[_0x1b27fe(0x15c)];else{if(_0x4fb9be[0x0][_0x1b27fe(0xeb)]==_0x1b27fe(0xb7))var _0x40a376=users[_0x1b27fe(0x101)];else{if(_0x4fb9be[0x0][_0x1b27fe(0xeb)]==_0x1b27fe(0x10b))var _0x40a376=users['Chinese'];else{if(_0x4fb9be[0x0]['language']==_0x1b27fe(0xe3))var _0x40a376=users[_0x1b27fe(0x157)];}}}}}}}_0x3db3da[_0x1b27fe(0x191)](_0x1b27fe(0xc9),{'success':_0x587748[_0x1b27fe(0x108)](_0x1b27fe(0x12c)),'errors':_0x587748[_0x1b27fe(0x108)](_0x1b27fe(0x11d)),'role':_0x27af35,'profile':_0x44163b,'master_shop':_0x4fb9be,'warehouse':_0x3f325b,'transfer':_0x2f92ba,'stock':_0x24bb6d,'language':_0x40a376});}catch(_0x299640){console['log'](_0x299640);}});function a0_0x40cb(_0x352503,_0x7c0b0){var _0xb0d4af=a0_0xb0d4();return a0_0x40cb=function(_0x40cbce,_0x3f8cb9){_0x40cbce=_0x40cbce-0xb4;var _0x300c57=_0xb0d4af[_0x40cbce];return _0x300c57;},a0_0x40cb(_0x352503,_0x7c0b0);}async function updateProduct_detl(_0x2d5318){var _0x1ad88a=a0_0x12f112;const _0x39bb03=await mongoose[_0x1ad88a(0x183)]();try{console['log'](_0x1ad88a(0x172));const _0x25e320=mongoose['Types'][_0x1ad88a(0x140)];return await _0x39bb03['withTransaction'](async()=>{var _0x438473=_0x1ad88a;for(const _0x389efe of _0x2d5318[_0x438473(0x154)]){console[_0x438473(0x133)](new _0x25e320());const _0x54ad91=await warehouse['aggregate']([{'$match':{'name':_0x2d5318[_0x438473(0x187)],'room':_0x389efe[_0x438473(0x151)]}},{'$unwind':'$product_details'},{'$match':{'product_details._id':_0x25e320(_0x389efe['id_transaction_id'])}}])[_0x438473(0x174)](_0x39bb03);if(_0x54ad91[_0x438473(0x180)]===0x0)throw new Error(_0x438473(0x105)+_0x389efe[_0x438473(0x151)]);for(const _0x43461d of _0x54ad91){console[_0x438473(0x133)](parseFloat(_0x43461d[_0x438473(0x142)]['product_stock'][_0x438473(0x15a)](0x2))>=parseFloat(_0x389efe[_0x438473(0x13f)]['toFixed'](0x2)));if(parseFloat(_0x43461d['product_details'][_0x438473(0x121)][_0x438473(0x15a)](0x2))>=parseFloat(_0x389efe[_0x438473(0x13f)][_0x438473(0x15a)](0x2))){let _0x422733=(parseFloat(_0x43461d[_0x438473(0x142)]['product_stock'][_0x438473(0x15a)](0x2))-parseFloat(_0x389efe['to_quantity']))[_0x438473(0x15a)](0x2);console[_0x438473(0x133)](_0x438473(0x130),_0x422733),console[_0x438473(0x133)](_0x438473(0xef)),await warehouse[_0x438473(0x104)]({'_id':_0x25e320(_0x43461d['_id']),'product_details._id':_0x25e320(_0x43461d[_0x438473(0x142)][_0x438473(0xb5)])},{'$set':{'product_details.$.product_stock':_0x422733,'product_details.$.trf_invoice':_0x2d5318[_0x438473(0x1b8)]}},{'session':_0x39bb03});const _0x18eb6a=await warehouse[_0x438473(0xbd)]([{'$match':{'name':_0x2d5318[_0x438473(0x192)],'room':_0x389efe['to_room_name']}}])[_0x438473(0x174)](_0x39bb03);console[_0x438473(0x133)]('..............to\x20deducted.....................'),await warehouse[_0x438473(0x104)]({'name':_0x2d5318[_0x438473(0x192)],'room':_0x389efe['to_room_name']},{'$push':{'product_details':{'product_name':_0x389efe[_0x438473(0xfe)],'product_stock':_0x389efe[_0x438473(0x13f)],'primary_code':_0x389efe[_0x438473(0x1b1)],'secondary_code':_0x389efe['secondary_code'],'product_code':_0x389efe[_0x438473(0x12e)],'storage':_0x389efe[_0x438473(0xfb)],'rack':_0x389efe[_0x438473(0x129)],'bay':_0x389efe[_0x438473(0x167)],'bin':_0x389efe['to_bin'],'type':_0x389efe[_0x438473(0x186)],'floorlevel':_0x389efe[_0x438473(0x155)],'maxProducts':_0x389efe[_0x438473(0x194)],'expiry_date':_0x389efe[_0x438473(0x113)],'production_date':_0x389efe['production_date'],'maxPerUnit':_0x389efe[_0x438473(0xb4)],'batch_code':_0x389efe[_0x438473(0x17a)],'unit':_0x389efe[_0x438473(0x132)],'secondary_unit':_0x389efe[_0x438473(0x1a8)],'alertQTY':_0x43461d['product_details'][_0x438473(0xf1)],'delivery_date':_0x43461d[_0x438473(0x142)][_0x438473(0x190)],'delivery_code':_0x43461d[_0x438473(0x142)][_0x438473(0x10e)],'product_cat':_0x43461d[_0x438473(0x142)][_0x438473(0x1a7)],'invoice':_0x389efe[_0x438473(0x119)],'trf_invoice':_0x2d5318['invoice'],'date_data':_0x2d5318[_0x438473(0x117)],'_id':new _0x25e320()}}},{'session':_0x39bb03});}else{console[_0x438473(0x133)](_0x438473(0x102),QTYTotal);throw new Error('No\x20matching\x20document\x20found\x20for\x20product\x20ID\x20'+_0x43461d['_id']+_0x438473(0xd6)+QTYTotal);}}}}),{'success':!![],'message':_0x1ad88a(0xf3)};}catch(_0x1c6b50){return console[_0x1ad88a(0x133)](_0x1c6b50),await _0x39bb03['abortTransaction'](),console[_0x1ad88a(0x133)](_0x1ad88a(0x1a9)),{'success':![],'message':_0x1c6b50['message']};}finally{_0x39bb03[_0x1ad88a(0x14c)](),console['log']('..............disconnected.....................');}}router['post'](a0_0x12f112(0x135),auth,async(_0xbfd3d9,_0x1fa851)=>{var _0x5f1591=a0_0x12f112;try{const _0x9af3c=_0xbfd3d9[_0x5f1591(0xb6)]['id'],{from_warehouse:_0xbfdad3,FromRoom_name:_0x5d34f9,to_warehouse:_0x58a477,ToRoom_name:_0x1c8746}=_0xbfd3d9[_0x5f1591(0xce)],_0x5644c7=await transfers[_0x5f1591(0x162)]({'_id':_0x9af3c});await updateProduct_detl(_0x5644c7),_0x5644c7[_0x5f1591(0x112)]='True';const _0x4c3429=await _0x5644c7[_0x5f1591(0x18e)](),_0x4da1fd=await master_shop['find'](),_0x3eeec6=await email_settings['findOne'](),_0x2e0629=await supervisor_settings[_0x5f1591(0x19d)]();var _0x2edffe=_0x5644c7[_0x5f1591(0x154)],_0x5a3dff='',_0x70a544;for(_0x70a544 in _0x2edffe){_0x5a3dff+=_0x5f1591(0xec)+_0x5f1591(0xbb)+_0x2edffe[_0x70a544][_0x5f1591(0xfe)]+_0x5f1591(0xdb)+_0x5f1591(0xbb)+_0x2edffe[_0x70a544]['product_code']+_0x5f1591(0xdb)+_0x5f1591(0xbb)+_0x2edffe[_0x70a544][_0x5f1591(0x13f)]+_0x5f1591(0xdb)+_0x5f1591(0xbb)+_0x2edffe[_0x70a544][_0x5f1591(0x132)]+_0x5f1591(0xdb)+_0x5f1591(0xbb)+_0x2edffe[_0x70a544][_0x5f1591(0x1a8)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5644c7[_0x5f1591(0x192)]+_0x5f1591(0xdb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2edffe[_0x70a544][_0x5f1591(0x11a)]+'</td>'+_0x5f1591(0xbb)+_0x2edffe[_0x70a544][_0x5f1591(0xfb)]+_0x2edffe[_0x70a544][_0x5f1591(0x129)]+_0x2edffe[_0x70a544]['to_bay']+_0x2edffe[_0x70a544][_0x5f1591(0x16e)]+_0x2edffe[_0x70a544][_0x5f1591(0x186)][0x0]+_0x2edffe[_0x70a544]['to_floorlevel']+'</td>',_0x5f1591(0x1b9);}let _0x352346=nodemailer[_0x5f1591(0x184)]({'host':_0x3eeec6[_0x5f1591(0x181)],'port':Number(_0x3eeec6[_0x5f1591(0xd1)]),'secure':![],'auth':{'user':_0x3eeec6['email'],'pass':_0x3eeec6[_0x5f1591(0xf0)]}}),_0x51079f={'from':_0x3eeec6['email'],'to':_0x2e0629[0x0][_0x5f1591(0x156)],'subject':_0x5f1591(0x13d),'attachments':[{'filename':_0x5f1591(0x182),'path':__dirname+_0x5f1591(0x17d)+_0x5f1591(0x144)+_0x4da1fd[0x0][_0x5f1591(0x1ad)],'cid':_0x5f1591(0xf4)}],'html':_0x5f1591(0x147)+_0x5f1591(0x17c)+_0x5f1591(0x18d)+_0x5f1591(0xc0)+_0x5f1591(0xdf)+_0x5f1591(0xc0)+_0x5f1591(0xcb)+'</div>'+_0x5f1591(0xc0)+_0x5f1591(0x125)+_0x4da1fd[0x0]['site_title']+_0x5f1591(0xd9)+'</div>'+_0x5f1591(0x164)+_0x5f1591(0x197)+_0x5f1591(0xc0)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x5f1591(0x176)+_0x5644c7[_0x5f1591(0x1b8)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x5f1591(0x120)+_0x5644c7[_0x5f1591(0x117)]+'\x20'+_0x5f1591(0x1b0)+_0x5f1591(0xdc)+_0x5f1591(0x164)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5f1591(0xe7)+_0x5f1591(0xec)+_0x5f1591(0xd3)+_0x5f1591(0x14e)+_0x5f1591(0x152)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x5f1591(0xfc)+_0x5f1591(0x19b)+_0x5f1591(0xfd)+_0x5f1591(0x11e)+'</tr>'+_0x5f1591(0xf5)+_0x5f1591(0xfa)+'\x20'+_0x5a3dff+'\x20'+_0x5f1591(0x128)+_0x5f1591(0x1a1)+_0x5f1591(0xc0)+_0x5f1591(0x14b)+_0x5f1591(0x11b)+_0x4da1fd[0x0][_0x5f1591(0x1a4)]+_0x5f1591(0xdc)+'</div>'+'</div>'+_0x5f1591(0x123)};_0x352346[_0x5f1591(0x1a6)](_0x51079f,function(_0x1d8213,_0x1cc999){var _0x411412=_0x5f1591;_0x1d8213?(console[_0x411412(0x133)](_0x1d8213),console[_0x411412(0x133)](_0x411412(0x1be))):console[_0x411412(0x133)](_0x411412(0x14a));}),_0xbfd3d9[_0x5f1591(0x108)]('success','Transfer\x20Finalize\x20Successfully'),_0x1fa851['redirect'](_0x5f1591(0x195)+_0x4c3429[_0x5f1591(0xb5)]);}catch(_0xa79723){console[_0x5f1591(0x133)](_0xa79723);}});function BayBinSelected(_0x44467b,_0x494c5a){var _0x2208b0=a0_0x12f112,_0x48f269=[],_0x421978=[],_0x542d1b=[],_0x550a5d=[],_0x2a42e9=[],_0x202790=[];let _0x161b86=[];if(_0x44467b==_0x2208b0(0xc1))switch(_0x494c5a){case _0x2208b0(0x171):_0x48f269=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x421978=[0x1,0x2],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=[_0x2208b0(0xed),'Floor'],_0x2a42e9=['D'],_0x202790=['A'];break;case'Rack\x20B':_0x48f269=[0x6,0x5,0x4,0x3,0x2,0x1],_0x421978=[0x1,0x2],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=['Level',_0x2208b0(0x16f)],_0x2a42e9=['D'],_0x202790=['B'];break;case _0x2208b0(0xbc):_0x48f269=[0x0],_0x421978=[0x0],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=[_0x2208b0(0x16f)],_0x2a42e9=['D'],_0x202790=['S'];break;case _0x2208b0(0x1ae):_0x48f269=[0x0],_0x421978=[0x0],_0x550a5d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x542d1b=['Floor'],_0x2a42e9=['D'],_0x202790=['R'];break;}else{if(_0x44467b==_0x2208b0(0x110))switch(_0x494c5a){case _0x2208b0(0x171):_0x48f269=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x421978=['B','F'],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=[_0x2208b0(0xed),_0x2208b0(0x16f)],_0x2a42e9=['C'],_0x202790=['A'];break;case _0x2208b0(0x10d):_0x48f269=[0x5,0x4,0x3,0x2,0x1],_0x421978=['F','B','S'],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=[_0x2208b0(0xed),_0x2208b0(0x16f)],_0x2a42e9=['C'],_0x202790=['B'];break;case _0x2208b0(0x161):_0x48f269=[0x1,0x2,0x3,0x4,0x5],_0x421978=['B','F','S'],_0x550a5d=[0x5,0x4,0x3,0x2,0x1],_0x542d1b=[_0x2208b0(0xed),_0x2208b0(0x16f)],_0x2a42e9=['C'],_0x202790=['C'];break;case _0x2208b0(0xf8):_0x48f269=[0x5,0x4,0x3,0x2,0x1],_0x421978=['F','B','S'],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=[_0x2208b0(0xed),_0x2208b0(0x16f)],_0x2a42e9=['C'],_0x202790=['D'];break;case _0x2208b0(0xc8):_0x48f269=[0x4,0x3,0x2,0x1],_0x421978=[0x1,0x2],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=[_0x2208b0(0xed),_0x2208b0(0x16f)],_0x2a42e9=['C'],_0x202790=['E'];break;case _0x2208b0(0xc3):_0x48f269=[0x1,0x2,0x3],_0x421978=[0x1,0x2],_0x550a5d=[0x1,0x2,0x3,0x4,0x5],_0x542d1b=[_0x2208b0(0xed)],_0x2a42e9=['C'],_0x202790=['F'];break;}}return{'levels':_0x48f269,'Isle':_0x421978,'rack':_0x550a5d,'type':_0x542d1b,'storage':_0x2a42e9,'rak':_0x202790};}function a0_0xb0d4(){var _0x2c89c6=['product','to_floorlevel','RMSEmail','Arabic','back','Spanish','toFixed','Hindi','French','English\x20(US)','max_per_unit','Enabled','bin','Rack\x20C','findById','from_prod_pallet','</div>','from_floorlevel','string','to_bay','from_storage','Transfer\x20Edit\x20Successfully','$product_details.maxProducts','to_prod_level','status','1321776engAFw','to_bin','Floor','from_rack','Rack\x20A','..............connected.....................','\x20<>\x20','session','/view','\x20Order\x20Number\x20:\x20','$product_details._id','188926NHlQEe','split','batch_code','$product','<html><head><title></title>','/../public','$product_details.level','$room','length','host','Logo.png','startSession','createTransport','$from_warehouse','to_types','from_warehouse','$product_details.batch_code','2358IpIwZL','prod_cat','from_quantity','from_prod_qty','</head><body>','save','to_invoice','delivery_date','render','to_warehouse','forEach','maxProducts','/picking_list/PDF_transfer_rm/','from_types','<hr\x20class=\x22my-3\x22>','MaxStocks_data2','toString','7eIIxOa','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','../public/language/languages.json','find','$product_details.maxPerUnit','to_prod_pallet','filter','</table>','getMonth','14zoXCjx','site_title','from_room','sendMail','product_cat','secondary_unit','Transaction\x20aborted.','getFullYear','push','/view/add_transfer','image','Receiving\x20Area','$product_details.secondary_code','</span>','primary_code','4880WxFrTq','$product_details.bay','getDate','from_rak','13127706zMipwd','from_prod_level','invoice','</tr>','here','note','12440pcOvmC','random','Error\x20Occurs','maxperunit','_id','params','Portuguese\x20(BR)','$product_details','then','$product_details.primary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Shelves','aggregate','primary_unit','warehouse','<div>','DRY\x20STORAGE','TRF-','Rack\x20F','$product_details.type','$product_details.expiry_date','/transfer/view','35563QePREO','Rack\x20E','edit_transfer_view','$product_details.production_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','English','784012qbDKdx','body','/view/:id','$name','port','to_prod_isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.pallet','4656776bCljsh','\x20and\x20QTY\x20:\x20','/CheckingWarehouse','New_Qty_Converted','\x20</h2>','bay','</td>','</h5>','master','Raw\x20Materials','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','prod_name','user','json','Arabic\x20(ae)','$finalize','id_transaction','redirect','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','floor','$product_details.unit','role','language','<tr>','Level','$product_details.product_code','..............from\x20deducted.....................','password','alertQTY','German','Products\x20updated\x20successfully.','logo','</thead>','$product_details.invoice','nodemailer','Rack\x20D','dotenv','<tbody\x20style=\x22text-align:\x20center;\x22>','storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','product_name','from_bay','production_date','Portuguese','not\x20meet\x20the\x20need\x20stock','$product_details.bin','updateOne','No\x20warehouse\x20data\x20found\x20for\x20room:\x20','$product_details.product_stock','$product.to_room_name','flash','transfer','all','Chinese','$product_details.secondary_unit','Rack\x20B','delivery_code','$isAllowEdit','COLD\x20STORAGE','floorlevel','finalize','expiry_date','$to_warehouse','message','secondary_code','date','to_prod_qty','from_invoice','to_room_name','<h5>','/barcode_scanner3','errors','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','get','\x20Order\x20Date\x20:\x20','product_stock','RoomAssigned','</body></html>','$product_details.product_name','<h2>\x20','from_bin','Router','</tbody>','rack','$product_details.floorlevel','product_code3','success','/transfer/preview/','product_code','post','meet\x20the\x20need\x20stock','email','unit','log','$product_details.isle','/preview/:id','type','to_room','map','mongoose','findOne','from_prod_isle','/barcode_scanner','Transfer\x20Mail','Enclosed','to_quantity','ObjectId','slice','product_details','config','/upload/','exports','staff','<!DOCTYPE\x20html>','ToRoomAssigned','catch','Email\x20sent\x20successfully','<strong>\x20Regards\x20</strong>','endSession','$_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Ambient','$product_details.rack','from_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.storage'];a0_0xb0d4=function(){return _0x2c89c6;};return a0_0xb0d4();}router[a0_0x12f112(0x11f)](a0_0x12f112(0xcf),auth,async(_0x497fb8,_0x231a76)=>{var _0xb57d43=a0_0x12f112;try{const {username:_0x29e7a4,email:_0x3e442f,role:_0x5df6f9}=_0x497fb8[_0xb57d43(0xe1)],_0x32dd37=_0x497fb8[_0xb57d43(0xe1)],_0x4b6005=await profile[_0xb57d43(0x13a)]({'email':_0x32dd37[_0xb57d43(0x131)]}),_0x21429c=await master_shop[_0xb57d43(0x19d)](),_0x556348=await transfers[_0xb57d43(0x162)](_0x497fb8['params']['id']);let _0x358dae;if(_0x32dd37['role']==_0xb57d43(0x146)){const _0x38cd01=await staff['findOne']({'email':_0x32dd37[_0xb57d43(0x131)]});_0x358dae=await warehouse[_0xb57d43(0xbd)]([{'$match':{'status':_0xb57d43(0x15f),'name':_0x38cd01[_0xb57d43(0xbf)],'warehouse_category':_0xb57d43(0xde)}},{'$group':{'_id':_0xb57d43(0xd0),'name':{'$first':_0xb57d43(0xd0)}}}]);}else _0x358dae=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0xb57d43(0xde)}},{'$group':{'_id':_0xb57d43(0xd0),'name':{'$first':'$name'}}}]);const _0x254118=await warehouse['aggregate']([{'$match':{'name':_0x556348['from_warehouse'],'warehouse_category':_0xb57d43(0xde)}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0xb57d43(0x124)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xb57d43(0x1b3)},'bin':{'$first':_0xb57d43(0x103)},'type':{'$first':_0xb57d43(0xc4)},'floorlevel':{'$first':_0xb57d43(0x12a)},'primary_code':{'$first':_0xb57d43(0xba)},'secondary_code':{'$first':_0xb57d43(0x1af)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xb57d43(0x150)},'expiry_date':{'$first':_0xb57d43(0xc5)},'production_date':{'$first':_0xb57d43(0xca)},'room':{'$first':'$room'}}}]),_0x56b568=await product[_0xb57d43(0x19d)]({}),_0x385e03=BayBinSelected(_0x556348['to_warehouse'],_0x556348[_0xb57d43(0x137)]);if(_0x21429c[0x0]['language']=='English\x20(US)'){var _0x347116=users[_0xb57d43(0xcc)];console[_0xb57d43(0x133)](_0x347116);}else{if(_0x21429c[0x0]['language']==_0xb57d43(0x15b))var _0x347116=users['Hindi'];else{if(_0x21429c[0x0][_0xb57d43(0xeb)]==_0xb57d43(0xf2))var _0x347116=users['German'];else{if(_0x21429c[0x0][_0xb57d43(0xeb)]==_0xb57d43(0x159))var _0x347116=users[_0xb57d43(0x159)];else{if(_0x21429c[0x0]['language']==_0xb57d43(0x15c))var _0x347116=users[_0xb57d43(0x15c)];else{if(_0x21429c[0x0][_0xb57d43(0xeb)]==_0xb57d43(0xb7))var _0x347116=users[_0xb57d43(0x101)];else{if(_0x21429c[0x0][_0xb57d43(0xeb)]=='Chinese')var _0x347116=users[_0xb57d43(0x10b)];else{if(_0x21429c[0x0][_0xb57d43(0xeb)]==_0xb57d43(0xe3))var _0x347116=users[_0xb57d43(0x157)];}}}}}}}_0x231a76[_0xb57d43(0x191)]('edit_transfer',{'success':_0x497fb8[_0xb57d43(0x108)](_0xb57d43(0x12c)),'errors':_0x497fb8['flash'](_0xb57d43(0x11d)),'role':_0x32dd37,'profile':_0x4b6005,'master_shop':_0x21429c,'warehouse':_0x358dae,'transfer':_0x556348,'stock':_0x254118,'unit':_0x56b568,'language':_0x347116});}catch(_0x481322){console[_0xb57d43(0x133)](_0x481322);}}),router[a0_0x12f112(0x12f)](a0_0x12f112(0xcf),auth,async(_0x12a464,_0x3c45e3)=>{var _0x567707=a0_0x12f112;try{const _0x2a85e1=_0x12a464['params']['id'],_0x12f5c0=await transfers[_0x567707(0x162)](_0x2a85e1);_0x3c45e3[_0x567707(0xe2)](_0x12a464[_0x567707(0xce)]);return;const {date:_0x271d19,from_warehouse:_0x26907d,FromRoom_name:_0x3c5187,to_warehouse:_0x5118f6,ToRoom_name:_0x40e94e,prod_name:_0x3cfabf,from_prod_qty:_0x573df8,from_prod_level:_0x1577cf,from_prod_isle:_0x5779f4,from_prod_pallet:_0x3eb07d,to_prod_qty:_0x4d7208,to_prod_level:_0x1c2d82,to_prod_isle:_0x2ecc9e,to_prod_pallet:_0x252e43,primary_code:_0x4abfc1,secondary_code:_0xc3d9a3,product_code3:_0x5287b4,note:_0x1638a4,invoice:_0x12182e,expiry_date:_0x15b92b}=_0x12a464['body'];if(typeof _0x3cfabf==_0x567707(0x166))var _0x53b886=[_0x12a464[_0x567707(0xce)][_0x567707(0xe0)]],_0x173a01=[_0x12a464[_0x567707(0xce)][_0x567707(0x18c)]],_0xc704df=[_0x12a464[_0x567707(0xce)][_0x567707(0x1b7)]],_0x3a2989=[_0x12a464[_0x567707(0xce)][_0x567707(0x13b)]],_0xb6c58=[_0x12a464['body'][_0x567707(0x163)]],_0x32bcc7=[_0x12a464[_0x567707(0xce)][_0x567707(0x196)]],_0x59d0a0=[_0x12a464[_0x567707(0xce)]['to_prod_qty']],_0x5c8691=[_0x12a464[_0x567707(0xce)][_0x567707(0x16b)]],_0x261666=[_0x12a464[_0x567707(0xce)]['to_prod_isle']],_0x59cb76=[_0x12a464['body'][_0x567707(0x19f)]],_0x3711e1=[_0x12a464[_0x567707(0xce)]['to_types']],_0x214a78=[_0x12a464['body']['storage']],_0xae1b4a=[_0x12a464[_0x567707(0xce)]['rak']],_0x2d034e=[_0x12a464[_0x567707(0xce)][_0x567707(0x1b1)]],_0x3ea6e5=[_0x12a464[_0x567707(0xce)]['secondary_code']],_0x4cd8fb=[_0x12a464[_0x567707(0xce)][_0x567707(0x12b)]],_0xc6bfbc=[_0x12a464['body'][_0x567707(0x198)]],_0x5ce0d1=[_0x12a464[_0x567707(0xce)]['unit']],_0x3467b4=[_0x12a464[_0x567707(0xce)]['secondary_unit']],_0x5bdec4=[_0x12a464[_0x567707(0xce)][_0x567707(0x17a)]],_0x3e9019=[_0x12a464[_0x567707(0xce)][_0x567707(0x113)]],_0x9e53f=[_0x12a464[_0x567707(0xce)][_0x567707(0x168)]],_0x6e44af=[_0x12a464[_0x567707(0xce)][_0x567707(0x1b5)]];else var _0x53b886=[..._0x12a464[_0x567707(0xce)]['prod_name']],_0x214a78=[..._0x12a464[_0x567707(0xce)][_0x567707(0xfb)]],_0xae1b4a=[..._0x12a464['body']['rak']],_0x32bcc7=[..._0x12a464['body']['from_types']],_0x3711e1=[..._0x12a464['body'][_0x567707(0x186)]],_0x173a01=[..._0x12a464['body']['from_prod_qty']],_0xc704df=[..._0x12a464[_0x567707(0xce)][_0x567707(0x1b7)]],_0x3a2989=[..._0x12a464['body'][_0x567707(0x13b)]],_0xb6c58=[..._0x12a464[_0x567707(0xce)]['from_prod_pallet']],_0x59d0a0=[..._0x12a464[_0x567707(0xce)][_0x567707(0x118)]],_0x5c8691=[..._0x12a464[_0x567707(0xce)][_0x567707(0x16b)]],_0x261666=[..._0x12a464['body'][_0x567707(0xd2)]],_0x59cb76=[..._0x12a464[_0x567707(0xce)][_0x567707(0x19f)]],_0x2d034e=[..._0x12a464[_0x567707(0xce)][_0x567707(0x1b1)]],_0x3ea6e5=[..._0x12a464[_0x567707(0xce)]['secondary_code']],_0x4cd8fb=[..._0x12a464['body'][_0x567707(0x12b)]],_0xc6bfbc=[..._0x12a464['body'][_0x567707(0x198)]],_0x5ce0d1=[..._0x12a464['body'][_0x567707(0x132)]],_0x3467b4=[..._0x12a464[_0x567707(0xce)][_0x567707(0x1a8)]],_0x5bdec4=[..._0x12a464['body'][_0x567707(0x17a)]],_0x3e9019=[..._0x12a464[_0x567707(0xce)]['expiry_date']],_0x9e53f=[..._0x12a464[_0x567707(0xce)][_0x567707(0x168)]],_0x6e44af=[..._0x12a464[_0x567707(0xce)][_0x567707(0x1b5)]];const _0x1d9f5a=_0x53b886[_0x567707(0x138)](_0x523599=>{return _0x523599={'product_name':_0x523599};});_0x173a01[_0x567707(0x193)]((_0x509925,_0x453442)=>{_0x1d9f5a[_0x453442]['from_quantity']=_0x509925;}),_0xc704df['forEach']((_0x3ad6ac,_0x2f29cf)=>{_0x1d9f5a[_0x2f29cf]['from_bay']=_0x3ad6ac;}),_0x3a2989[_0x567707(0x193)]((_0x41c9c3,_0x9d7ecd)=>{_0x1d9f5a[_0x9d7ecd]['from_bin']=_0x41c9c3;}),_0xb6c58[_0x567707(0x193)]((_0x803709,_0x11b592)=>{_0x1d9f5a[_0x11b592]['from_floorlevel']=_0x803709;}),_0x59d0a0[_0x567707(0x193)]((_0x4c1167,_0x3ee1d0)=>{var _0x1ed5df=_0x567707;_0x1d9f5a[_0x3ee1d0][_0x1ed5df(0x13f)]=_0x4c1167;}),_0x5c8691[_0x567707(0x193)]((_0x26c0ce,_0x38b447)=>{_0x1d9f5a[_0x38b447]['to_bay']=_0x26c0ce;}),_0x261666[_0x567707(0x193)]((_0xbcbae7,_0x3b3a05)=>{_0x1d9f5a[_0x3b3a05]['to_bin']=_0xbcbae7;}),_0x59cb76[_0x567707(0x193)]((_0x286af9,_0x19c8e2)=>{var _0x498581=_0x567707;_0x1d9f5a[_0x19c8e2][_0x498581(0x155)]=_0x286af9;}),_0x2d034e[_0x567707(0x193)]((_0x4dec9e,_0x21a859)=>{_0x1d9f5a[_0x21a859]['primary_code']=_0x4dec9e;}),_0x3ea6e5['forEach']((_0x475d50,_0x57a156)=>{var _0xc1381f=_0x567707;_0x1d9f5a[_0x57a156][_0xc1381f(0x116)]=_0x475d50;}),_0x4cd8fb['forEach']((_0x942c6b,_0x542193)=>{var _0x62227f=_0x567707;_0x1d9f5a[_0x542193][_0x62227f(0x12e)]=_0x942c6b;}),_0xc6bfbc[_0x567707(0x193)]((_0x2314a4,_0x153973)=>{var _0x509536=_0x567707;_0x1d9f5a[_0x153973][_0x509536(0x194)]=_0x2314a4;}),_0x5ce0d1[_0x567707(0x193)]((_0x54ceaf,_0x15222a)=>{var _0x42d11e=_0x567707;_0x1d9f5a[_0x15222a][_0x42d11e(0x132)]=_0x54ceaf;}),_0x3467b4['forEach']((_0x2336a7,_0x236464)=>{var _0x27785e=_0x567707;_0x1d9f5a[_0x236464][_0x27785e(0x1a8)]=_0x2336a7;}),_0x5bdec4['forEach']((_0x19cb8e,_0x2df8d6)=>{var _0x431bb7=_0x567707;_0x1d9f5a[_0x2df8d6][_0x431bb7(0x17a)]=_0x19cb8e;}),_0x3e9019[_0x567707(0x193)]((_0x45179d,_0x2dc6ae)=>{_0x1d9f5a[_0x2dc6ae]['expiry_date']=_0x45179d;}),_0x214a78[_0x567707(0x193)]((_0x4ed59e,_0x1ca4f9)=>{_0x1d9f5a[_0x1ca4f9]['storage']=_0x4ed59e;}),_0xae1b4a[_0x567707(0x193)]((_0x5226d6,_0x5655b2)=>{_0x1d9f5a[_0x5655b2]['rack']=_0x5226d6;}),_0x32bcc7[_0x567707(0x193)]((_0x1b7297,_0x606ac9)=>{_0x1d9f5a[_0x606ac9]['from_types']=_0x1b7297;}),_0x3711e1[_0x567707(0x193)]((_0x3f6d11,_0xca099b)=>{_0x1d9f5a[_0xca099b]['to_types']=_0x3f6d11;}),_0x9e53f[_0x567707(0x193)]((_0x5a5ad7,_0x4fe579)=>{var _0x29a663=_0x567707;_0x1d9f5a[_0x4fe579][_0x29a663(0x168)]=_0x5a5ad7;}),_0x6e44af[_0x567707(0x193)]((_0x1e4d77,_0x25300f)=>{var _0x3bcd94=_0x567707;_0x1d9f5a[_0x25300f][_0x3bcd94(0x170)]=_0x1e4d77;});const _0xfdb376=_0x1d9f5a[_0x567707(0x1a0)](_0x2d9173=>_0x2d9173[_0x567707(0x13f)]!=='0'&&_0x2d9173[_0x567707(0x13f)]!==''||_0x2d9173[_0x567707(0x155)]!=='0'&&_0x2d9173[_0x567707(0x155)]!=='');var _0x3dafb0=0x0;_0xfdb376[_0x567707(0x193)](_0x1cae92=>{var _0x18e0b5=_0x567707;parseInt(_0x1cae92[_0x18e0b5(0x18b)])<parseInt(_0x1cae92[_0x18e0b5(0x13f)])&&_0x3dafb0++;});if(_0x3dafb0!=0x0)return _0x12a464['flash'](_0x567707(0x11d),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x3c45e3[_0x567707(0xe6)](_0x567707(0x158));const _0xb01e41=await warehouse[_0x567707(0x13a)]({'name':_0x12f5c0['from_warehouse'],'room':_0x12f5c0[_0x567707(0x1a5)]});_0x12f5c0[_0x567707(0x154)][_0x567707(0x193)](_0x35869c=>{var _0x2ffec8=_0x567707;if(_0x35869c[_0x2ffec8(0x13f)]>0x0){const _0x360d32=_0xb01e41['product_details'][_0x2ffec8(0x138)](_0x1f0cae=>{var _0x380cdd=_0x2ffec8;_0x1f0cae['product_name']==_0x35869c[_0x380cdd(0xfe)]&&_0x1f0cae['floorlevel']==_0x35869c[_0x380cdd(0x165)]&&_0x1f0cae['type']==_0x35869c[_0x380cdd(0x196)]&&_0x1f0cae['bin']==_0x35869c[_0x380cdd(0x126)]&&_0x1f0cae['bay']==_0x35869c[_0x380cdd(0xff)]&&_0x1f0cae['rack']==_0x35869c[_0x380cdd(0x170)]&&_0x1f0cae[_0x380cdd(0xfb)]==_0x35869c[_0x380cdd(0x168)]&&(_0x1f0cae[_0x380cdd(0x121)]=parseInt(_0x1f0cae[_0x380cdd(0x121)])+parseInt(_0x35869c[_0x380cdd(0x13f)]));});}}),await _0xb01e41[_0x567707(0x18e)]();const _0x4b8fae=await warehouse[_0x567707(0x13a)]({'name':_0x12f5c0[_0x567707(0x192)],'room':_0x12f5c0['to_room']});_0x12f5c0[_0x567707(0x154)]['forEach'](_0x193783=>{var _0x241c9f=_0x567707;if(_0x193783['to_quantity']>0x0){const _0x42ffc1=_0x4b8fae['product_details'][_0x241c9f(0x138)](_0x2b446e=>{var _0x1ff35c=_0x241c9f;_0x2b446e['product_name']==_0x193783[_0x1ff35c(0xfe)]&&_0x2b446e[_0x1ff35c(0x111)]==_0x193783[_0x1ff35c(0x155)]&&_0x2b446e[_0x1ff35c(0x136)]==_0x193783[_0x1ff35c(0x186)]&&_0x2b446e[_0x1ff35c(0x160)]==_0x193783[_0x1ff35c(0x16e)]&&_0x2b446e[_0x1ff35c(0xda)]==_0x193783[_0x1ff35c(0x167)]&&_0x2b446e[_0x1ff35c(0x129)]==_0x193783[_0x1ff35c(0x129)]&&_0x2b446e['storage']==_0x193783[_0x1ff35c(0xfb)]&&(_0x2b446e[_0x1ff35c(0x121)]=parseInt(_0x2b446e[_0x1ff35c(0x121)])-parseInt(_0x193783['to_quantity']));});}}),await _0x4b8fae[_0x567707(0x18e)](),_0x12f5c0[_0x567707(0x117)]=_0x271d19,_0x12f5c0[_0x567707(0x187)]=_0x26907d,_0x12f5c0['to_warehouse']=_0x5118f6,_0x12f5c0[_0x567707(0x154)]=_0xfdb376,_0x12f5c0[_0x567707(0x1bb)]=_0x1638a4,_0x12f5c0['invoice']=_0x12182e;const _0x5b0cdf=await _0x12f5c0[_0x567707(0x18e)]();console[_0x567707(0x133)](_0x5b0cdf);const _0x4cae30=await warehouse['findOne']({'name':_0x26907d,'room':_0x3c5187});_0x5b0cdf['product']['forEach'](_0x39b714=>{var _0x5df3e7=_0x567707;if(_0x39b714['to_quantity']>0x0){const _0x1ef168=_0x4cae30[_0x5df3e7(0x142)][_0x5df3e7(0x138)](_0x2f2e18=>{var _0x3ef8b5=_0x5df3e7;_0x2f2e18[_0x3ef8b5(0xfe)]==_0x39b714[_0x3ef8b5(0xfe)]&&_0x2f2e18['floorlevel']==_0x39b714['from_floorlevel']&&_0x2f2e18['type']==_0x39b714[_0x3ef8b5(0x196)]&&_0x2f2e18[_0x3ef8b5(0x160)]==_0x39b714[_0x3ef8b5(0x126)]&&_0x2f2e18[_0x3ef8b5(0xda)]==_0x39b714[_0x3ef8b5(0xff)]&&_0x2f2e18['rack']==_0x39b714[_0x3ef8b5(0x170)]&&_0x2f2e18[_0x3ef8b5(0xfb)]==_0x39b714[_0x3ef8b5(0x168)]&&(_0x2f2e18[_0x3ef8b5(0x121)]=parseInt(_0x2f2e18[_0x3ef8b5(0x121)])-parseInt(_0x39b714[_0x3ef8b5(0x13f)]));});}}),await _0x4cae30[_0x567707(0x18e)]();const _0x1ac131=await warehouse[_0x567707(0x13a)]({'name':_0x5118f6,'room':_0x40e94e});_0x5b0cdf[_0x567707(0x154)][_0x567707(0x193)](_0x59071d=>{var _0x592527=_0x567707;if(_0x59071d[_0x592527(0x13f)]>0x0){var _0x46fb4a=0x0;const _0x388e43=_0x1ac131[_0x592527(0x142)][_0x592527(0x138)](_0x3c6a5e=>{var _0x149746=_0x592527;_0x3c6a5e[_0x149746(0xfe)]==_0x59071d[_0x149746(0xfe)]&&_0x3c6a5e[_0x149746(0x111)]==_0x59071d[_0x149746(0x155)]&&_0x3c6a5e[_0x149746(0x136)]==_0x59071d['to_types']&&_0x3c6a5e[_0x149746(0x160)]==_0x59071d[_0x149746(0x16e)]&&_0x3c6a5e[_0x149746(0xda)]==_0x59071d[_0x149746(0x167)]&&_0x3c6a5e[_0x149746(0x129)]==_0x59071d[_0x149746(0x129)]&&_0x3c6a5e[_0x149746(0xfb)]==_0x59071d['storage']&&(_0x3c6a5e['product_stock']=parseInt(_0x3c6a5e[_0x149746(0x121)])+parseInt(_0x59071d[_0x149746(0x13f)]),_0x46fb4a++);});_0x46fb4a=='0'&&(_0x1ac131[_0x592527(0x142)]=_0x1ac131[_0x592527(0x142)]['concat']({'product_name':_0x59071d[_0x592527(0xfe)],'product_stock':_0x59071d['to_quantity'],'bay':_0x59071d[_0x592527(0x167)],'bin':_0x59071d['to_bin'],'type':_0x59071d[_0x592527(0x186)],'floorlevel':_0x59071d[_0x592527(0x155)],'storage':_0x59071d['storage'],'rack':_0x59071d[_0x592527(0x129)],'product_code':_0x59071d[_0x592527(0x12e)],'primary_code':_0x59071d[_0x592527(0x1b1)],'secondary_code':_0x59071d[_0x592527(0x116)],'maxProducts':_0x59071d['maxProducts'],'storage':_0x59071d[_0x592527(0xfb)],'rack':_0x59071d['rack']}));}}),await _0x1ac131['save'](),_0x12a464[_0x567707(0x108)]('success',_0x567707(0x169)),_0x3c45e3['redirect']('/transfer/view');}catch(_0x3f4fd4){console[_0x567707(0x133)](_0x3f4fd4);}}),router[a0_0x12f112(0x12f)](a0_0x12f112(0x13c),async(_0x4715f9,_0x52daaa)=>{var _0x4c920a=a0_0x12f112;const {FromWareHouse:_0x499960,FromRoom:_0x37de33,ToWarehouse:_0x215029,ToRoom:_0x514701,primary_code:_0x552c1c,Roomslist:_0x16558f}=_0x4715f9[_0x4c920a(0xce)],_0x2548ce=_0x16558f[_0x4c920a(0x179)](','),_0x35a5ef=[];async function _0x22966d(_0x5a17ef){var _0x587201=_0x4c920a;const _0x2a243d=await warehouse['aggregate']([{'$match':{'name':_0x499960,'room':_0x5a17ef}},{'$unwind':_0x587201(0xb8)},{'$match':{'product_details.primary_code':_0x552c1c}},{'$group':{'_id':_0x587201(0x177),'name':{'$first':_0x587201(0x124)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x587201(0x1af)},'product_code':{'$first':_0x587201(0xee)},'level':{'$first':_0x587201(0x1b3)},'isle':{'$first':_0x587201(0x103)},'type':{'$first':_0x587201(0xc4)},'pallet':{'$first':_0x587201(0x12a)},'unit':{'$first':_0x587201(0xe9)},'secondary_unit':{'$first':_0x587201(0x10c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x587201(0x150)},'expiry_date':{'$first':_0x587201(0xc5)},'production_date':{'$first':_0x587201(0xca)},'batch_code':{'$first':_0x587201(0x188)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x587201(0x17f)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x587201(0xf6)}}}]),_0x10e62b=await warehouse[_0x587201(0xbd)]([{'$match':{'name':_0x499960,'room':_0x5a17ef}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x552c1c}},{'$group':{'_id':_0x587201(0x177),'name':{'$first':_0x587201(0x124)},'instock':{'$first':_0x587201(0x106)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x587201(0x1af)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x587201(0x103)},'type':{'$first':_0x587201(0xc4)},'pallet':{'$first':_0x587201(0x12a)},'unit':{'$first':_0x587201(0xe9)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x587201(0x153)},'rack':{'$first':_0x587201(0x150)},'expiry_date':{'$first':_0x587201(0xc5)},'production_date':{'$first':_0x587201(0xca)},'batch_code':{'$first':_0x587201(0x188)},'maxPerUnit':{'$first':_0x587201(0x19e)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x587201(0x17f)},'maxProducts':{'$first':_0x587201(0x16a)},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x2a243d[_0x587201(0x180)]>0x0)_0x35a5ef[_0x587201(0x1ab)](_0x2a243d);else _0x10e62b[_0x587201(0x180)]>0x0&&_0x35a5ef[_0x587201(0x1ab)](_0x10e62b);}const _0x5baa2f=_0x2548ce[_0x4c920a(0x138)](_0x334174=>_0x22966d(_0x334174));await Promise[_0x4c920a(0x10a)](_0x5baa2f),_0x52daaa['json'](_0x35a5ef);}),router['post']('/barcode_scanner2',async(_0x549368,_0x2e9904)=>{var _0x6a360e=a0_0x12f112;try{const {FromWareHouse:_0x28e625,FromRoom:_0x38597e,ToWarehouse:_0x33749e,ToRoom:_0x666fd,secondary_code:_0x14c229}=_0x549368[_0x6a360e(0xce)],_0xf267e3=await warehouse[_0x6a360e(0xbd)]([{'$match':{'name':_0x28e625}},{'$unwind':_0x6a360e(0xb8)},{'$match':{'product_details.secondary_code':_0x14c229}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x6a360e(0xba)},'secondary_code':{'$first':_0x6a360e(0x1af)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x6a360e(0x106)},'warehouse':{'$first':'$name'},'level':{'$first':_0x6a360e(0x17e)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x6a360e(0xd4)},'maxProducts':{'$first':_0x6a360e(0x16a)},'unit':{'$first':_0x6a360e(0xe9)}}}]);_0x2e9904[_0x6a360e(0x16c)](0xc8)[_0x6a360e(0xe2)](_0xf267e3);}catch(_0x470685){_0x2e9904['status'](0x194)[_0x6a360e(0xe2)]({'message':_0x470685[_0x6a360e(0x115)]});}}),router[a0_0x12f112(0x12f)](a0_0x12f112(0x11c),async(_0x3982ee,_0x522b41)=>{var _0x309aea=a0_0x12f112;try{const {FromWareHouse:_0x133de9,FromRoom:_0x162442,ToWarehouse:_0x5b1c40,ToRoom:_0x3b847b,product_code:_0x2b5aed}=_0x3982ee[_0x309aea(0xce)],_0x2ba616=await warehouse[_0x309aea(0xbd)]([{'$match':{'name':_0x133de9}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x2b5aed}},{'$group':{'_id':_0x309aea(0x177),'name':{'$first':_0x309aea(0x124)},'primary_code':{'$first':_0x309aea(0xba)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x309aea(0xee)},'instock':{'$first':_0x309aea(0x106)},'warehouse':{'$first':'$name'},'level':{'$first':_0x309aea(0x17e)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x309aea(0xd4)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0x522b41[_0x309aea(0x16c)](0xc8)[_0x309aea(0xe2)](_0x2ba616);}catch(_0x1afe38){_0x522b41[_0x309aea(0x16c)](0x194)[_0x309aea(0xe2)]({'message':_0x1afe38[_0x309aea(0x115)]});}}),router[a0_0x12f112(0x12f)](a0_0x12f112(0xd7),async(_0x2fcac7,_0xb6e90c)=>{var _0xa3be5a=a0_0x12f112;const {level:_0x17e2fb,isle:_0x4c1596,pallet:_0x493f85,warehouses:_0x46f13d,room:_0x2d6fb5}=_0x2fcac7[_0xa3be5a(0xce)];try{const _0xdfe646=await warehouse[_0xa3be5a(0xbd)]([{'$match':{'name':_0x46f13d,'room':_0x2d6fb5}},{'$unwind':_0xa3be5a(0xb8)},{'$match':{'product_details.level':parseInt(_0x17e2fb),'product_details.isle':_0x4c1596,'product_details.pallet':parseInt(_0x493f85)}},{'$group':{'_id':_0xa3be5a(0x177),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xa3be5a(0x106)},'level':{'$first':_0xa3be5a(0x17e)},'isle':{'$first':_0xa3be5a(0x134)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0xa3be5a(0x16a)}}}]);_0xb6e90c[_0xa3be5a(0x16c)](0xc8)[_0xa3be5a(0xe2)](_0xdfe646);}catch(_0x23528a){_0xb6e90c[_0xa3be5a(0x16c)](0x194)[_0xa3be5a(0xe2)]({'message':_0x23528a[_0xa3be5a(0x115)]});}}),module[a0_0x12f112(0x145)]=router;