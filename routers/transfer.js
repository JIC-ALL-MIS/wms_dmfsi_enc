var a0_0x406a47=a0_0x51ae;(function(_0x4397cc,_0xf25c34){var _0x388d50=a0_0x51ae,_0x77a80b=_0x4397cc();while(!![]){try{var _0x14dbee=-parseInt(_0x388d50(0x227))/0x1*(parseInt(_0x388d50(0x1f8))/0x2)+parseInt(_0x388d50(0x1ae))/0x3*(parseInt(_0x388d50(0x18c))/0x4)+parseInt(_0x388d50(0x20e))/0x5*(-parseInt(_0x388d50(0x1e1))/0x6)+parseInt(_0x388d50(0x1e9))/0x7+parseInt(_0x388d50(0x1ed))/0x8*(-parseInt(_0x388d50(0x15c))/0x9)+parseInt(_0x388d50(0x1dc))/0xa*(parseInt(_0x388d50(0x210))/0xb)+parseInt(_0x388d50(0x142))/0xc*(parseInt(_0x388d50(0x187))/0xd);if(_0x14dbee===_0xf25c34)break;else _0x77a80b['push'](_0x77a80b['shift']());}catch(_0x1a7ebd){_0x77a80b['push'](_0x77a80b['shift']());}}}(a0_0x27c2,0x1f130),require('dotenv')['config']());const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x406a47(0x1c8)),users=require(a0_0x406a47(0x1be)),nodemailer=require(a0_0x406a47(0x245)),mongoose=require(a0_0x406a47(0x19c));router[a0_0x406a47(0x19b)](a0_0x406a47(0x1c6),auth,async(_0x1ce6cf,_0x380134)=>{var _0x12e2f0=a0_0x406a47;try{const {username:_0x102878,email:_0x488708,role:_0xad697c}=_0x1ce6cf[_0x12e2f0(0x229)],_0x37aa06=_0x1ce6cf[_0x12e2f0(0x229)],_0x3d7efd=await profile['findOne']({'email':_0x37aa06[_0x12e2f0(0x207)]}),_0x2adaa9=await master_shop['find']();console[_0x12e2f0(0x1d6)](_0x12e2f0(0x20a),_0x2adaa9);let _0x15593d;if(_0x37aa06[_0x12e2f0(0x20f)]==_0x12e2f0(0x15d)){const _0x3efb8d=await staff['findOne']({'email':_0x37aa06[_0x12e2f0(0x207)]});_0x15593d=await transfers[_0x12e2f0(0x205)]({'from_warehouse':_0x3efb8d[_0x12e2f0(0x21e)]});}else _0x15593d=await transfers['aggregate']([{'$unwind':_0x12e2f0(0x158)},{'$group':{'_id':_0x12e2f0(0x174),'invoice':{'$first':_0x12e2f0(0x172)},'date':{'$first':_0x12e2f0(0x16b)},'from_warehouse':{'$first':_0x12e2f0(0x1ef)},'to_warehouse':{'$first':_0x12e2f0(0x19e)},'from_room_name':{'$addToSet':_0x12e2f0(0x13f)},'to_room_name':{'$addToSet':_0x12e2f0(0x235)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x12e2f0(0x242)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2adaa9[0x0][_0x12e2f0(0x204)]==_0x12e2f0(0x1ec)){var _0x44a96a=users['English'];console[_0x12e2f0(0x1d6)](_0x44a96a);}else{if(_0x2adaa9[0x0][_0x12e2f0(0x204)]==_0x12e2f0(0x234))var _0x44a96a=users['Hindi'];else{if(_0x2adaa9[0x0]['language']==_0x12e2f0(0x19a))var _0x44a96a=users[_0x12e2f0(0x19a)];else{if(_0x2adaa9[0x0]['language']=='Spanish')var _0x44a96a=users[_0x12e2f0(0x1ab)];else{if(_0x2adaa9[0x0][_0x12e2f0(0x204)]=='French')var _0x44a96a=users[_0x12e2f0(0x144)];else{if(_0x2adaa9[0x0][_0x12e2f0(0x204)]==_0x12e2f0(0x24a))var _0x44a96a=users[_0x12e2f0(0x1f9)];else{if(_0x2adaa9[0x0][_0x12e2f0(0x204)]==_0x12e2f0(0x1a9))var _0x44a96a=users['Chinese'];else{if(_0x2adaa9[0x0][_0x12e2f0(0x204)]=='Arabic\x20(ae)')var _0x44a96a=users[_0x12e2f0(0x141)];}}}}}}}_0x380134[_0x12e2f0(0x215)](_0x12e2f0(0x17d),{'success':_0x1ce6cf[_0x12e2f0(0x1b9)](_0x12e2f0(0x1df)),'errors':_0x1ce6cf[_0x12e2f0(0x1b9)](_0x12e2f0(0x225)),'role':_0x37aa06,'profile':_0x3d7efd,'master_shop':_0x2adaa9,'transfer':_0x15593d,'language':_0x44a96a});}catch(_0x4b831b){console[_0x12e2f0(0x1d6)](_0x4b831b);}});async function getRandom8DigitNumber(){var _0x1bdd06=a0_0x406a47;const _0x3ac352=0x989680,_0x253a90=0x5f5e0ff,_0x241045=Math['floor'](Math[_0x1bdd06(0x156)]()*(_0x253a90-_0x3ac352+0x1))+_0x3ac352;var _0x48f0cc;const _0x19a009=await transfers[_0x1bdd06(0x1b8)]({'invoice':_0x1bdd06(0x1b5)+_0x241045});return _0x19a009&&_0x19a009[_0x1bdd06(0x23e)]>0x0?_0x48f0cc=_0x1bdd06(0x1b5)+_0x241045:_0x48f0cc=_0x1bdd06(0x1b5)+_0x241045,_0x48f0cc;}router[a0_0x406a47(0x19b)](a0_0x406a47(0x22d),auth,async(_0x71a325,_0x112f8a)=>{var _0x165e54=a0_0x406a47;try{const {username:_0x3bf190,email:_0x1a6c6e,role:_0x36873e}=_0x71a325['user'],_0x27ace3=_0x71a325[_0x165e54(0x229)],_0x299d9f=await profile[_0x165e54(0x1b8)]({'email':_0x27ace3[_0x165e54(0x207)]}),_0x84c5f3=await master_shop[_0x165e54(0x205)]();console[_0x165e54(0x1d6)](_0x165e54(0x20a),_0x84c5f3);let _0x5819e9;if(_0x27ace3[_0x165e54(0x20f)]=='staff'){const _0x1636d9=await staff[_0x165e54(0x1b8)]({'email':_0x27ace3['email']});_0x5819e9=await warehouse[_0x165e54(0x1b4)]([{'$match':{'status':_0x165e54(0x178),'name':_0x1636d9[_0x165e54(0x21e)],'warehouse_category':_0x165e54(0x1d4)}},{'$group':{'_id':_0x165e54(0x1a0),'name':{'$first':_0x165e54(0x1a0)}}}]);}else _0x5819e9=await warehouse[_0x165e54(0x1b4)]([{'$match':{'status':_0x165e54(0x178),'warehouse_category':_0x165e54(0x1d4)}},{'$group':{'_id':_0x165e54(0x1a0),'name':{'$first':_0x165e54(0x1a0)}}}]);var _0x24a599=[_0x165e54(0x241),_0x165e54(0x195),_0x165e54(0x188)];const _0x49ac68=await transfers[_0x165e54(0x205)]({}),_0x1027f3=_0x49ac68['length']+0x1,_0xbf63f0=_0x165e54(0x1b5)+_0x1027f3[_0x165e54(0x1d9)]()[_0x165e54(0x1b0)](0x5,'0');if(_0x84c5f3[0x0][_0x165e54(0x204)]==_0x165e54(0x1ec)){var _0x460ab9=users[_0x165e54(0x214)];console[_0x165e54(0x1d6)](_0x460ab9);}else{if(_0x84c5f3[0x0][_0x165e54(0x204)]==_0x165e54(0x234))var _0x460ab9=users[_0x165e54(0x234)];else{if(_0x84c5f3[0x0][_0x165e54(0x204)]==_0x165e54(0x19a))var _0x460ab9=users['German'];else{if(_0x84c5f3[0x0]['language']==_0x165e54(0x1ab))var _0x460ab9=users[_0x165e54(0x1ab)];else{if(_0x84c5f3[0x0][_0x165e54(0x204)]==_0x165e54(0x144))var _0x460ab9=users['French'];else{if(_0x84c5f3[0x0][_0x165e54(0x204)]==_0x165e54(0x24a))var _0x460ab9=users[_0x165e54(0x1f9)];else{if(_0x84c5f3[0x0][_0x165e54(0x204)]=='Chinese')var _0x460ab9=users[_0x165e54(0x1a9)];else{if(_0x84c5f3[0x0][_0x165e54(0x204)]==_0x165e54(0x16f))var _0x460ab9=users[_0x165e54(0x141)];}}}}}}}const _0x3a89ff=getRandom8DigitNumber();_0x3a89ff[_0x165e54(0x192)](_0x3ea806=>{var _0x3c9667=_0x165e54;_0x112f8a[_0x3c9667(0x215)](_0x3c9667(0x164),{'success':_0x71a325[_0x3c9667(0x1b9)]('success'),'errors':_0x71a325[_0x3c9667(0x1b9)]('errors'),'role':_0x27ace3,'profile':_0x299d9f,'master_shop':_0x84c5f3,'warehouse':_0x5819e9,'language':_0x460ab9,'rooms_data':_0x24a599,'invoice':_0x3ea806});})[_0x165e54(0x1c4)](_0x35ce87=>{var _0x4fcefe=_0x165e54;_0x71a325[_0x4fcefe(0x1b9)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x112f8a[_0x4fcefe(0x21d)](_0x4fcefe(0x1cd));});}catch(_0x561716){console[_0x165e54(0x1d6)](_0x561716);}}),router[a0_0x406a47(0x18e)](a0_0x406a47(0x22d),auth,async(_0x4d0613,_0x2e440f)=>{var _0x12cc7d=a0_0x406a47;try{console[_0x12cc7d(0x1d6)](_0x4d0613[_0x12cc7d(0x180)]);const {date:_0x29ba70,from_warehouse:_0x4d810d,FromRoom_name:_0x5cf400,to_warehouse:_0x461f48,ToRoom_name:_0x228f2e,prod_name:_0x1c20ef,from_prod_qty:_0x41689b,from_prod_level:_0x47fbd1,from_prod_isle:_0x2493e2,from_prod_pallet:_0x3f30e8,to_prod_qty:_0x43e4e4,to_prod_level:_0x419fb9,to_prod_isle:_0x31de44,to_prod_pallet:_0x5b76b1,primary_code:_0x1fe61f,secondary_code:_0x505681,product_code3:_0x44e9a7,note:_0x387da1,MaxStocks_data2:_0x3167ee,invoice:_0x569c9b,expiry_date:_0x9abdfd}=_0x4d0613['body'];if(typeof _0x1c20ef==_0x12cc7d(0x21f))var _0x367952=[_0x4d0613['body'][_0x12cc7d(0x1ac)]],_0x270062=[_0x4d0613['body'][_0x12cc7d(0x143)]],_0x2e4af5=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x16a)]],_0x5a7744=[_0x4d0613[_0x12cc7d(0x180)]['New_Qty_Converted']],_0x352872=[_0x4d0613['body'][_0x12cc7d(0x1e4)]],_0x5c7104=[_0x4d0613[_0x12cc7d(0x180)]['primary_code']],_0x27cfe1=[_0x4d0613[_0x12cc7d(0x180)]['secondary_code']],_0x53997f=[_0x4d0613[_0x12cc7d(0x180)]['product_code3']],_0x1e69ee=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x196)]],_0x1755ad=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x151)]],_0x2b2a4a=[_0x4d0613['body'][_0x12cc7d(0x1f5)]],_0x3da6a8=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1e7)]],_0x4f5444=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x217)]],_0x544857=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1ba)]],_0x44db40=[_0x4d0613['body'][_0x12cc7d(0x1bc)]],_0x3a4e3e=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x236)]],_0x140f8d=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x21c)]],_0x1a2401=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x228)]],_0x51a601=[_0x4d0613['body'][_0x12cc7d(0x1e3)]],_0x5f268e=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x206)]],_0xcc1570=[_0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1a2)]];else var _0x367952=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1ac)]],_0x270062=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x143)]],_0x2e4af5=[..._0x4d0613['body'][_0x12cc7d(0x16a)]],_0x5a7744=[..._0x4d0613['body'][_0x12cc7d(0x1f2)]],_0x352872=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1e4)]],_0x5c7104=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x15b)]],_0x27cfe1=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x216)]],_0x53997f=[..._0x4d0613['body'][_0x12cc7d(0x1d5)]],_0x1e69ee=[..._0x4d0613[_0x12cc7d(0x180)]['MaxStocks_data2']],_0x1755ad=[..._0x4d0613['body']['primary_unit']],_0x2b2a4a=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1f5)]],_0x3da6a8=[..._0x4d0613[_0x12cc7d(0x180)]['batch_code']],_0x4f5444=[..._0x4d0613['body'][_0x12cc7d(0x217)]],_0x544857=[..._0x4d0613[_0x12cc7d(0x180)]['max_per_unit']],_0x44db40=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1bc)]],_0x3a4e3e=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x236)]],_0x140f8d=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x21c)]],_0x1a2401=[..._0x4d0613['body'][_0x12cc7d(0x228)]],_0x51a601=[..._0x4d0613[_0x12cc7d(0x180)]['from_invoice']],_0x5f268e=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x206)]],_0xcc1570=[..._0x4d0613[_0x12cc7d(0x180)][_0x12cc7d(0x1a2)]];const _0x4835b6=_0x367952[_0x12cc7d(0x17f)](_0xa68e5d=>{return _0xa68e5d={'product_name':_0xa68e5d};});_0x270062[_0x12cc7d(0x145)]((_0x19826a,_0x573aaa)=>{var _0x2122c1=_0x12cc7d;_0x4835b6[_0x573aaa][_0x2122c1(0x237)]=_0x19826a;}),_0x51a601[_0x12cc7d(0x145)]((_0x3ec902,_0x206296)=>{var _0x223dae=_0x12cc7d;_0x4835b6[_0x206296][_0x223dae(0x1e3)]=_0x3ec902;}),_0x5f268e[_0x12cc7d(0x145)]((_0x4cf55e,_0x3132f9)=>{var _0x1150e5=_0x12cc7d;_0x4835b6[_0x3132f9][_0x1150e5(0x1a7)]=_0x4cf55e;}),_0xcc1570[_0x12cc7d(0x145)]((_0x73cfab,_0x4552d8)=>{_0x4835b6[_0x4552d8]['id_transaction_id']=_0x73cfab;}),_0x2e4af5[_0x12cc7d(0x145)]((_0x354ba9,_0x1a1747)=>{var _0x119a73=_0x12cc7d;_0x140f8d[_0x119a73(0x145)]((_0x3a6bef,_0x43b9dd)=>{var _0x4fdbcd=_0x119a73;if(_0x3a6bef==_0x4fdbcd(0x1af)&&_0x1a1747==_0x43b9dd){var _0x499287=_0x354ba9[_0x4fdbcd(0x213)](0x3);_0x4835b6[_0x1a1747][_0x4fdbcd(0x173)]=_0x354ba9[0x0],_0x4835b6[_0x1a1747]['from_rack']=_0x354ba9[0x1],_0x4835b6[_0x1a1747]['from_bay']=0x0,_0x4835b6[_0x1a1747][_0x4fdbcd(0x221)]=0x0,_0x4835b6[_0x1a1747][_0x4fdbcd(0x1d3)]=_0x4fdbcd(0x189),_0x4835b6[_0x1a1747][_0x4fdbcd(0x149)]=_0x499287;}else{if(_0x3a6bef==_0x4fdbcd(0x159)&&_0x1a1747==_0x43b9dd){var _0x499287=_0x354ba9[_0x4fdbcd(0x213)](0x3);_0x4835b6[_0x1a1747][_0x4fdbcd(0x173)]=_0x354ba9[0x0],_0x4835b6[_0x1a1747][_0x4fdbcd(0x246)]=_0x354ba9[0x1],_0x4835b6[_0x1a1747][_0x4fdbcd(0x230)]=0x0,_0x4835b6[_0x1a1747][_0x4fdbcd(0x221)]=0x0,_0x4835b6[_0x1a1747][_0x4fdbcd(0x1d3)]=_0x4fdbcd(0x189),_0x4835b6[_0x1a1747][_0x4fdbcd(0x149)]=_0x354ba9[0x5];}else{if(_0x1a1747==_0x43b9dd){if(_0x354ba9[0x0]=='A'&&_0x354ba9[0x1]=='L'&&_0x354ba9[0x2]=='L')console[_0x4fdbcd(0x1d6)](_0x3a6bef+_0x4fdbcd(0x1e0)+_0x1a1747+'\x20<>\x20'+_0x43b9dd+_0x4fdbcd(0x1e0)+_0x354ba9+_0x4fdbcd(0x1bd)),_0x4835b6[_0x1a1747]['from_storage']=_0x354ba9[0x0],_0x4835b6[_0x1a1747][_0x4fdbcd(0x246)]=_0x354ba9[0x1],_0x4835b6[_0x1a1747][_0x4fdbcd(0x230)]=0x0,_0x4835b6[_0x1a1747][_0x4fdbcd(0x221)]=0x0,_0x4835b6[_0x1a1747][_0x4fdbcd(0x1d3)]=_0x4fdbcd(0x189),_0x4835b6[_0x1a1747][_0x4fdbcd(0x149)]=_0x354ba9[0x3];else{var _0x10435f;if(_0x354ba9[0x4]=='L')_0x10435f=_0x4fdbcd(0x1fa);else _0x354ba9[0x4]=='F'&&(_0x10435f='Floor');_0x4835b6[_0x1a1747][_0x4fdbcd(0x173)]=_0x354ba9[0x0],_0x4835b6[_0x1a1747][_0x4fdbcd(0x246)]=_0x354ba9[0x1],_0x4835b6[_0x1a1747][_0x4fdbcd(0x230)]=_0x354ba9[0x2],_0x4835b6[_0x1a1747]['from_bin']=_0x354ba9[0x3],_0x4835b6[_0x1a1747][_0x4fdbcd(0x1d3)]=_0x10435f,_0x4835b6[_0x1a1747]['from_floorlevel']=_0x354ba9[0x5];}}}}});}),_0x5a7744[_0x12cc7d(0x145)]((_0x523448,_0x19be41)=>{_0x4835b6[_0x19be41]['to_quantity']=_0x523448;}),_0x352872[_0x12cc7d(0x145)]((_0x330eba,_0x521fa8)=>{var _0x140a8c=_0x12cc7d;_0x1a2401[_0x140a8c(0x145)]((_0x3c6ab7,_0x83e975)=>{var _0x2af1d1=_0x140a8c;if(_0x3c6ab7==_0x2af1d1(0x1af)&&_0x521fa8==_0x83e975){var _0x1457d8=_0x330eba[_0x2af1d1(0x213)](0x3);_0x4835b6[_0x521fa8][_0x2af1d1(0x19f)]=_0x330eba[0x0],_0x4835b6[_0x521fa8]['rack']=_0x330eba[0x1],_0x4835b6[_0x521fa8]['to_bay']=0x0,_0x4835b6[_0x521fa8][_0x2af1d1(0x1a1)]=0x0,_0x4835b6[_0x521fa8][_0x2af1d1(0x184)]=_0x2af1d1(0x189),_0x4835b6[_0x521fa8][_0x2af1d1(0x157)]=_0x1457d8;}else{if(_0x3c6ab7==_0x2af1d1(0x159)&&_0x521fa8==_0x83e975){var _0x1457d8=_0x330eba[_0x2af1d1(0x213)](0x3);_0x4835b6[_0x521fa8]['storage']=_0x330eba[0x0],_0x4835b6[_0x521fa8][_0x2af1d1(0x1de)]=_0x330eba[0x1],_0x4835b6[_0x521fa8]['to_bay']=0x0,_0x4835b6[_0x521fa8][_0x2af1d1(0x1a1)]=0x0,_0x4835b6[_0x521fa8][_0x2af1d1(0x184)]=_0x2af1d1(0x189),_0x4835b6[_0x521fa8][_0x2af1d1(0x157)]=_0x330eba[0x5];}else{if(_0x521fa8==_0x83e975){if(_0x330eba[0x0]=='A'&&_0x330eba[0x1]=='L'&&_0x330eba[0x2]=='L')console[_0x2af1d1(0x1d6)](_0x3c6ab7+_0x2af1d1(0x1e0)+_0x521fa8+_0x2af1d1(0x1e0)+_0x83e975+_0x2af1d1(0x1e0)+_0x330eba+_0x2af1d1(0x1bd)),_0x4835b6[_0x521fa8]['storage']=_0x330eba[0x0],_0x4835b6[_0x521fa8]['rack']=_0x330eba[0x1],_0x4835b6[_0x521fa8][_0x2af1d1(0x18d)]=0x0,_0x4835b6[_0x521fa8][_0x2af1d1(0x1a1)]=0x0,_0x4835b6[_0x521fa8]['to_types']='Floor',_0x4835b6[_0x521fa8][_0x2af1d1(0x157)]=_0x330eba[0x3];else{var _0x8f78c8;if(_0x330eba[0x4]=='L')_0x8f78c8=_0x2af1d1(0x1fa);else _0x330eba[0x4]=='F'&&(_0x8f78c8='Floor');_0x4835b6[_0x521fa8][_0x2af1d1(0x19f)]=_0x330eba[0x0],_0x4835b6[_0x521fa8][_0x2af1d1(0x1de)]=_0x330eba[0x1],_0x4835b6[_0x521fa8][_0x2af1d1(0x18d)]=_0x330eba[0x2],_0x4835b6[_0x521fa8][_0x2af1d1(0x1a1)]=_0x330eba[0x3],_0x4835b6[_0x521fa8][_0x2af1d1(0x184)]=_0x8f78c8,_0x4835b6[_0x521fa8][_0x2af1d1(0x157)]=_0x330eba[0x5];}}}}});}),_0x5c7104['forEach']((_0x3ba416,_0x5c3c44)=>{var _0x555910=_0x12cc7d;_0x4835b6[_0x5c3c44][_0x555910(0x15b)]=_0x3ba416;}),_0x27cfe1[_0x12cc7d(0x145)]((_0x2316a1,_0x573de6)=>{var _0x36c801=_0x12cc7d;_0x4835b6[_0x573de6][_0x36c801(0x216)]=_0x2316a1;}),_0x53997f['forEach']((_0x18ca79,_0x26414d)=>{var _0x2a9010=_0x12cc7d;_0x4835b6[_0x26414d][_0x2a9010(0x148)]=_0x18ca79;}),_0x1e69ee[_0x12cc7d(0x145)]((_0x1e41f6,_0x1e76a4)=>{var _0x2025a6=_0x12cc7d;_0x4835b6[_0x1e76a4][_0x2025a6(0x1f4)]=_0x1e41f6;}),_0x1755ad[_0x12cc7d(0x145)]((_0x49a2d1,_0x568ac9)=>{var _0x292278=_0x12cc7d;_0x4835b6[_0x568ac9][_0x292278(0x1a4)]=_0x49a2d1;}),_0x2b2a4a[_0x12cc7d(0x145)]((_0x4646a3,_0x218925)=>{var _0x3a4f8e=_0x12cc7d;_0x4835b6[_0x218925][_0x3a4f8e(0x1f5)]=_0x4646a3;}),_0x3da6a8[_0x12cc7d(0x145)]((_0x3b56df,_0x39abb5)=>{var _0x3d7597=_0x12cc7d;_0x4835b6[_0x39abb5][_0x3d7597(0x1e7)]=_0x3b56df;}),_0x4f5444[_0x12cc7d(0x145)]((_0x27542d,_0x3bb64a)=>{var _0x3fa9e2=_0x12cc7d;_0x4835b6[_0x3bb64a][_0x3fa9e2(0x217)]=_0x27542d;}),_0x544857['forEach']((_0x2dda28,_0x241222)=>{var _0x12bbd9=_0x12cc7d;_0x4835b6[_0x241222][_0x12bbd9(0x1d8)]=_0x2dda28;}),_0x44db40['forEach']((_0x725eca,_0x52c398)=>{_0x4835b6[_0x52c398]['production_date']=_0x725eca;}),_0x3a4e3e[_0x12cc7d(0x145)]((_0x2ee31c,_0x24f403)=>{var _0x3575e1=_0x12cc7d;_0x4835b6[_0x24f403][_0x3575e1(0x236)]=_0x2ee31c;}),_0x140f8d['forEach']((_0x4b21c6,_0x195250)=>{var _0x44e02f=_0x12cc7d;_0x4835b6[_0x195250][_0x44e02f(0x1b1)]=_0x4b21c6;}),_0x1a2401[_0x12cc7d(0x145)]((_0x1cb486,_0xc4c68c)=>{_0x4835b6[_0xc4c68c]['to_room_name']=_0x1cb486;});const _0x408680=_0x4835b6[_0x12cc7d(0x222)](_0x4ac25a=>_0x4ac25a[_0x12cc7d(0x1ca)]!=='0'&&_0x4ac25a['to_quantity']!==''||_0x4ac25a[_0x12cc7d(0x157)]!=='0'&&_0x4ac25a[_0x12cc7d(0x157)]!==''),_0x5eb259=new transfers({'date':_0x29ba70,'from_warehouse':_0x4d810d,'to_warehouse':_0x461f48,'product':_0x408680,'note':_0x387da1,'invoice':_0x569c9b}),_0x497cf6=await _0x5eb259[_0x12cc7d(0x218)]();_0x4d0613[_0x12cc7d(0x1b9)]('success','Product\x20Transfer\x20successfully'),_0x2e440f[_0x12cc7d(0x21d)](_0x12cc7d(0x1a5)+_0x497cf6['_id']);}catch(_0x40cf74){console['log'](_0x40cf74),_0x2e440f[_0x12cc7d(0x1e8)](0xc8)[_0x12cc7d(0x208)]({'errorMessage':_0x40cf74[_0x12cc7d(0x190)]});}}),router[a0_0x406a47(0x19b)](a0_0x406a47(0x14d),auth,async(_0x484a1e,_0x45b605)=>{var _0x21bdef=a0_0x406a47;try{const {username:_0x111f53,email:_0x2fea63,role:_0x4ad9fb}=_0x484a1e[_0x21bdef(0x229)],_0x5eedda=_0x484a1e[_0x21bdef(0x229)],_0x17cc4c=await profile[_0x21bdef(0x1b8)]({'email':_0x5eedda[_0x21bdef(0x207)]}),_0x185814=await master_shop[_0x21bdef(0x205)]();console[_0x21bdef(0x1d6)]('master',_0x185814);const _0x18f18a=await transfers[_0x21bdef(0x16c)](_0x484a1e['params']['id']);let _0x115c01=new Date(_0x18f18a[_0x21bdef(0x217)]),_0x1e9446=('0'+_0x115c01[_0x21bdef(0x1b3)]())[_0x21bdef(0x213)](-0x2),_0x312ea9=('0'+(_0x115c01[_0x21bdef(0x183)]()+0x1))['slice'](-0x2),_0x5381fa=_0x115c01['getFullYear'](),_0x282914=_0x5381fa+'-'+_0x312ea9+'-'+_0x1e9446,_0xd748;if(_0x5eedda[_0x21bdef(0x20f)]==_0x21bdef(0x15d)){const _0x41562a=await staff['findOne']({'email':_0x5eedda[_0x21bdef(0x207)]});_0xd748=await warehouse['find']({'status':'Enabled','name':_0x41562a['warehouse'],'warehouse_category':'Raw\x20Materials'});}else _0xd748=await warehouse['find']({'status':_0x21bdef(0x178),'warehouse_category':_0x21bdef(0x1d4)});const _0x5892a2=await warehouse[_0x21bdef(0x1b4)]([{'$match':{'name':_0x18f18a[_0x21bdef(0x14b)]}},{'$unwind':_0x21bdef(0x209)},{'$group':{'_id':_0x21bdef(0x153),'name':{'$first':_0x21bdef(0x17a)},'product_stock':{'$first':_0x21bdef(0x1db)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x21bdef(0x1f1)},'type':{'$first':_0x21bdef(0x1b7)},'floorlevel':{'$first':_0x21bdef(0x1fe)},'primary_code':{'$first':_0x21bdef(0x233)},'secondary_code':{'$first':_0x21bdef(0x247)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x21bdef(0x244)},'expiry_date':{'$first':_0x21bdef(0x22b)},'production_date':{'$first':_0x21bdef(0x1f6)},'room':{'$first':_0x21bdef(0x21b)}}}]);if(_0x185814[0x0][_0x21bdef(0x204)]==_0x21bdef(0x1ec)){var _0x44617e=users[_0x21bdef(0x214)];console[_0x21bdef(0x1d6)](_0x44617e);}else{if(_0x185814[0x0][_0x21bdef(0x204)]=='Hindi')var _0x44617e=users[_0x21bdef(0x234)];else{if(_0x185814[0x0]['language']=='German')var _0x44617e=users[_0x21bdef(0x19a)];else{if(_0x185814[0x0][_0x21bdef(0x204)]==_0x21bdef(0x1ab))var _0x44617e=users[_0x21bdef(0x1ab)];else{if(_0x185814[0x0][_0x21bdef(0x204)]==_0x21bdef(0x144))var _0x44617e=users[_0x21bdef(0x144)];else{if(_0x185814[0x0][_0x21bdef(0x204)]==_0x21bdef(0x24a))var _0x44617e=users[_0x21bdef(0x1f9)];else{if(_0x185814[0x0][_0x21bdef(0x204)]==_0x21bdef(0x1a9))var _0x44617e=users[_0x21bdef(0x1a9)];else{if(_0x185814[0x0][_0x21bdef(0x204)]==_0x21bdef(0x16f))var _0x44617e=users['Arabic'];}}}}}}}_0x45b605[_0x21bdef(0x215)](_0x21bdef(0x21a),{'success':_0x484a1e['flash'](_0x21bdef(0x1df)),'errors':_0x484a1e[_0x21bdef(0x1b9)](_0x21bdef(0x225)),'role':_0x5eedda,'profile':_0x17cc4c,'master_shop':_0x185814,'warehouse':_0xd748,'transfer':_0x18f18a,'stock':_0x5892a2,'language':_0x44617e});}catch(_0x3dfa40){console[_0x21bdef(0x1d6)](_0x3dfa40);}});function a0_0x27c2(){var _0x5856c4=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','244PhSwpU','to_bay','post','</thead>','message','<table\x20style=\x22width:\x20100%\x20!important;\x22>','then','..............from\x20deducted.....................','$product_details.product_code','Enclosed','MaxStocks_data2','site_title','</table>','session','German','get','mongoose','Rack\x20D','$to_warehouse','storage','$name','to_bin','id_transaction','$product_details.level','unit','/transfer/preview/','<!DOCTYPE\x20html>','To_invoice','not\x20meet\x20the\x20need\x20stock','Chinese','product','Spanish','prod_name','product_details','1893ipWpua','Receiving\x20Area','padStart','from_room_name','/CheckingWarehouse','getDate','aggregate','TRF-','Types','$product_details.type','findOne','flash','max_per_unit','id_transaction_id','production_date','here','../public/language/languages.json','True','params','$product_details.isle','Products\x20updated\x20successfully.','<h5>','catch','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','/view','$product_details.unit','../middleware/auth','from_prod_isle','to_quantity','delivery_date','\x20Order\x20Number\x20:\x20','/transfer/view','port','toFixed','exports','$product_details.maxProducts','to_prod_qty','from_types','Raw\x20Materials','product_code3','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','maxperunit','toString','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.product_stock','265510sWoktK','DRY\x20STORAGE','rack','success','\x20<>\x20','918924XYaTYP','</body></html>','from_invoice','to_prod_level','RMSEmail','/picking_list/PDF_transfer_rm/','batch_code','status','144473HpLYGT','/barcode_scanner2','logo','English\x20(US)','8wEjqkT','/view/:id','$from_warehouse','<tr>','$product_details.bin','New_Qty_Converted','updateOne','maxProducts','secondary_unit','$product_details.production_date','Rack\x20A','2jZxLTw','Portuguese','Level','</span>','split','Logo.png','$product_details.floorlevel','<span\x20style=\x22float:\x20right;\x22>','</td>','Email\x20sent\x20successfully','</tr>','$product_details.bay','language','find','to_invoice','email','json','$product_details','master','$product_details.invoice','product_stock','$product_details.secondary_unit','5dEwirt','role','55XfSYRe','from_prod_pallet','Rack\x20F','slice','English','render','secondary_code','expiry_date','save','\x20and\x20QTY\x20:\x20','edit_transfer_view','$room','RoomAssigned','redirect','warehouse','string','$product_details.maxPerUnit','from_bin','filter','/barcode_scanner3','COLD\x20STORAGE','errors','endSession','203131WnKSqj','ToRoomAssigned','user','invoice','$product_details.expiry_date','ObjectId','/view/add_transfer','Error\x20Occurs','type','from_bay','push','_id','$product_details.primary_code','Hindi','$product.to_room_name','prod_cat','from_quantity','\x20Order\x20Date\x20:\x20','floorlevel','</h5>','date','$product_details.batch_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.pallet','Ambient','$isAllowEdit','<hr\x20class=\x22my-3\x22>','$product_details.rack','nodemailer','from_rack','$product_details.secondary_code','<h2>\x20','<strong>\x20Regards\x20</strong>','Portuguese\x20(BR)','$product.from_room_name','Transaction\x20aborted.','Arabic','72vCTkYt','from_prod_qty','French','forEach','concat','host','product_code','from_floorlevel','</tbody>','from_warehouse','bin','/preview/:id','Transfer\x20Finalize\x20Successfully','password','<div>','primary_unit','..............connected.....................','$product_details._id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','..............disconnected.....................','random','to_floorlevel','$product','Shelves','bay','primary_code','1504314MhdgNR','staff','<html><head><title></title>','meet\x20the\x20need\x20stock','alertQTY','to_warehouse','..............to\x20deducted.....................','$product_details.storage','add_transfer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','to_prod_pallet','Rack\x20C','note','</div>','from_prod_level','$date','findById','withTransaction','rak','Arabic\x20(ae)','Transfer\x20Mail','image','$invoice','from_storage','$_id','abortTransaction','startSession','/barcode_scanner','Enabled','from_rak','$product_details.product_name','product_name','to_room_name','transfer','finalize','map','body','Rack\x20B','delivery_code','getMonth','to_types','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','No\x20warehouse\x20data\x20found\x20for\x20room:\x20','994123kFCMuy','Return\x20Rooms','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'];a0_0x27c2=function(){return _0x5856c4;};return a0_0x27c2();}async function updateProduct_detl(_0x2928e6){var _0x182fd4=a0_0x406a47;const _0x3c2a10=await mongoose[_0x182fd4(0x176)]();try{console['log'](_0x182fd4(0x152));const _0x1332b1=mongoose[_0x182fd4(0x1b6)][_0x182fd4(0x22c)];return await _0x3c2a10[_0x182fd4(0x16d)](async()=>{var _0x390c98=_0x182fd4;for(const _0x47293b of _0x2928e6[_0x390c98(0x1aa)]){console[_0x390c98(0x1d6)](new _0x1332b1());const _0x553846=await warehouse[_0x390c98(0x1b4)]([{'$match':{'name':_0x2928e6['from_warehouse'],'room':_0x47293b[_0x390c98(0x1b1)]}},{'$unwind':_0x390c98(0x209)},{'$match':{'product_details._id':_0x1332b1(_0x47293b[_0x390c98(0x1bb)])}}])[_0x390c98(0x199)](_0x3c2a10);if(_0x553846[_0x390c98(0x23e)]===0x0)throw new Error(_0x390c98(0x186)+_0x47293b[_0x390c98(0x1b1)]);for(const _0x1d025b of _0x553846){let _0x120aaf=(parseFloat(_0x1d025b[_0x390c98(0x1ad)]['product_stock'][_0x390c98(0x1cf)](0x2))-parseFloat(_0x47293b[_0x390c98(0x1ca)]))['toFixed'](0x2);if(_0x120aaf>0x0){console['log'](_0x390c98(0x15f),_0x120aaf),console['log'](_0x390c98(0x193)),await warehouse[_0x390c98(0x1f3)]({'_id':_0x1332b1(_0x1d025b[_0x390c98(0x232)]),'product_details._id':_0x1332b1(_0x1d025b[_0x390c98(0x1ad)][_0x390c98(0x232)])},{'$set':{'product_details.$.product_stock':_0x120aaf,'product_details.$.trf_invoice':_0x2928e6[_0x390c98(0x22a)]}},{'session':_0x3c2a10});const _0x5bf802=await warehouse[_0x390c98(0x1b4)]([{'$match':{'name':_0x2928e6[_0x390c98(0x161)],'room':_0x47293b[_0x390c98(0x17c)]}}])['session'](_0x3c2a10);console[_0x390c98(0x1d6)](_0x390c98(0x162)),await warehouse[_0x390c98(0x1f3)]({'name':_0x2928e6['to_warehouse'],'room':_0x47293b[_0x390c98(0x17c)]},{'$push':{'product_details':{'product_name':_0x47293b[_0x390c98(0x17b)],'product_stock':_0x47293b[_0x390c98(0x1ca)],'primary_code':_0x47293b[_0x390c98(0x15b)],'secondary_code':_0x47293b[_0x390c98(0x216)],'product_code':_0x47293b[_0x390c98(0x148)],'storage':_0x47293b[_0x390c98(0x19f)],'rack':_0x47293b[_0x390c98(0x1de)],'bay':_0x47293b[_0x390c98(0x18d)],'bin':_0x47293b['to_bin'],'type':_0x47293b[_0x390c98(0x184)],'floorlevel':_0x47293b['to_floorlevel'],'maxProducts':_0x47293b['maxProducts'],'expiry_date':_0x47293b['expiry_date'],'production_date':_0x47293b[_0x390c98(0x1bc)],'maxPerUnit':_0x47293b['maxperunit'],'batch_code':_0x47293b[_0x390c98(0x1e7)],'unit':_0x47293b['unit'],'secondary_unit':_0x47293b['secondary_unit'],'alertQTY':_0x1d025b[_0x390c98(0x1ad)][_0x390c98(0x160)],'delivery_date':_0x1d025b['product_details'][_0x390c98(0x1cb)],'delivery_code':_0x1d025b[_0x390c98(0x1ad)][_0x390c98(0x182)],'product_cat':_0x1d025b[_0x390c98(0x1ad)]['product_cat'],'invoice':_0x47293b[_0x390c98(0x1e3)],'trf_invoice':_0x2928e6['invoice'],'date_data':_0x2928e6[_0x390c98(0x23b)],'_id':new _0x1332b1()}}},{'session':_0x3c2a10});}else{console['log'](_0x390c98(0x1a8),_0x120aaf);throw new Error('No\x20matching\x20document\x20found\x20for\x20product\x20ID\x20'+_0x1d025b[_0x390c98(0x232)]+_0x390c98(0x219)+_0x120aaf);}}}}),{'success':!![],'message':_0x182fd4(0x1c2)};}catch(_0x515402){return console['log'](_0x515402),await _0x3c2a10[_0x182fd4(0x175)](),console[_0x182fd4(0x1d6)](_0x182fd4(0x140)),{'success':![],'message':_0x515402[_0x182fd4(0x190)]};}finally{_0x3c2a10[_0x182fd4(0x226)](),console['log'](_0x182fd4(0x155));}}router[a0_0x406a47(0x18e)](a0_0x406a47(0x14d),auth,async(_0xb966a7,_0xd18dba)=>{var _0x385159=a0_0x406a47;try{const _0x2ba4a5=_0xb966a7[_0x385159(0x1c0)]['id'],{from_warehouse:_0x12e88c,FromRoom_name:_0x5d1a06,to_warehouse:_0x3b4cc9,ToRoom_name:_0x4d0614}=_0xb966a7[_0x385159(0x180)],_0x4a4df4=await transfers[_0x385159(0x16c)]({'_id':_0x2ba4a5});await updateProduct_detl(_0x4a4df4),_0x4a4df4[_0x385159(0x17e)]=_0x385159(0x1bf);const _0x4f9b5d=await _0x4a4df4[_0x385159(0x218)](),_0x448202=await master_shop[_0x385159(0x205)](),_0x48cc5a=await email_settings[_0x385159(0x1b8)](),_0x360756=await supervisor_settings[_0x385159(0x205)]();var _0x130ec5=_0x4a4df4[_0x385159(0x1aa)],_0x33fef7='',_0x27fbe4;for(_0x27fbe4 in _0x130ec5){_0x33fef7+=_0x385159(0x1f0)+_0x385159(0x154)+_0x130ec5[_0x27fbe4][_0x385159(0x17b)]+_0x385159(0x200)+_0x385159(0x154)+_0x130ec5[_0x27fbe4][_0x385159(0x148)]+'</td>'+_0x385159(0x154)+_0x130ec5[_0x27fbe4][_0x385159(0x1ca)]+'</td>'+_0x385159(0x154)+_0x130ec5[_0x27fbe4][_0x385159(0x1a4)]+'</td>'+_0x385159(0x154)+_0x130ec5[_0x27fbe4][_0x385159(0x1f5)]+_0x385159(0x200)+_0x385159(0x154)+_0x4a4df4[_0x385159(0x161)]+'</td>'+_0x385159(0x154)+_0x130ec5[_0x27fbe4][_0x385159(0x17c)]+'</td>'+_0x385159(0x154)+_0x130ec5[_0x27fbe4][_0x385159(0x19f)]+_0x130ec5[_0x27fbe4]['rack']+_0x130ec5[_0x27fbe4][_0x385159(0x18d)]+_0x130ec5[_0x27fbe4][_0x385159(0x1a1)]+_0x130ec5[_0x27fbe4][_0x385159(0x184)][0x0]+_0x130ec5[_0x27fbe4][_0x385159(0x157)]+'</td>',_0x385159(0x202);}let _0x30a1cc=nodemailer['createTransport']({'host':_0x48cc5a[_0x385159(0x147)],'port':Number(_0x48cc5a[_0x385159(0x1ce)]),'secure':![],'auth':{'user':_0x48cc5a[_0x385159(0x207)],'pass':_0x48cc5a[_0x385159(0x14f)]}}),_0x50b7e5={'from':_0x48cc5a['email'],'to':_0x360756[0x0][_0x385159(0x1e5)],'subject':_0x385159(0x170),'attachments':[{'filename':_0x385159(0x1fd),'path':__dirname+'/../public'+'/upload/'+_0x448202[0x0][_0x385159(0x171)],'cid':_0x385159(0x1eb)}],'html':_0x385159(0x1a6)+_0x385159(0x15e)+'</head><body>'+_0x385159(0x150)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x385159(0x150)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x385159(0x150)+_0x385159(0x248)+_0x448202[0x0][_0x385159(0x197)]+'\x20</h2>'+_0x385159(0x169)+_0x385159(0x169)+_0x385159(0x243)+_0x385159(0x150)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x385159(0x1cc)+_0x4a4df4[_0x385159(0x22a)]+'\x20'+_0x385159(0x1ff)+_0x385159(0x238)+_0x4a4df4['date']+'\x20'+_0x385159(0x1fb)+_0x385159(0x23a)+'</div>'+_0x385159(0x191)+_0x385159(0x23d)+_0x385159(0x1f0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x385159(0x1d7)+_0x385159(0x165)+_0x385159(0x18b)+_0x385159(0x1c5)+_0x385159(0x185)+_0x385159(0x18a)+_0x385159(0x23f)+_0x385159(0x202)+_0x385159(0x18f)+_0x385159(0x1da)+'\x20'+_0x33fef7+'\x20'+_0x385159(0x14a)+_0x385159(0x198)+'<div>'+_0x385159(0x249)+_0x385159(0x1c3)+_0x448202[0x0][_0x385159(0x197)]+_0x385159(0x23a)+'</div>'+_0x385159(0x169)+_0x385159(0x1e2)};_0x30a1cc['sendMail'](_0x50b7e5,function(_0x3ef788,_0x3d2855){var _0x116236=_0x385159;_0x3ef788?(console[_0x116236(0x1d6)](_0x3ef788),console[_0x116236(0x1d6)](_0x116236(0x22e))):console[_0x116236(0x1d6)](_0x116236(0x201));}),_0xb966a7[_0x385159(0x1b9)](_0x385159(0x1df),_0x385159(0x14e)),_0xd18dba[_0x385159(0x21d)](_0x385159(0x1e6)+_0x4f9b5d[_0x385159(0x232)]);}catch(_0x27021e){console[_0x385159(0x1d6)](_0x27021e);}});function BayBinSelected(_0x5b1040,_0x12a4f3){var _0x52666=a0_0x406a47,_0x26001d=[],_0x436ab5=[],_0x3a13a6=[],_0x33a1ce=[],_0x391789=[],_0x58dca9=[];let _0x32651b=[];if(_0x5b1040==_0x52666(0x1dd))switch(_0x12a4f3){case _0x52666(0x1f7):_0x26001d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x436ab5=[0x1,0x2],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=[_0x52666(0x1fa),_0x52666(0x189)],_0x391789=['D'],_0x58dca9=['A'];break;case _0x52666(0x181):_0x26001d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x436ab5=[0x1,0x2],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=['Level',_0x52666(0x189)],_0x391789=['D'],_0x58dca9=['B'];break;case _0x52666(0x159):_0x26001d=[0x0],_0x436ab5=[0x0],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=['Floor'],_0x391789=['D'],_0x58dca9=['S'];break;case _0x52666(0x1af):_0x26001d=[0x0],_0x436ab5=[0x0],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3a13a6=['Floor'],_0x391789=['D'],_0x58dca9=['R'];break;}else{if(_0x5b1040==_0x52666(0x224))switch(_0x12a4f3){case'Rack\x20A':_0x26001d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x436ab5=['B','F'],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=['Level',_0x52666(0x189)],_0x391789=['C'],_0x58dca9=['A'];break;case _0x52666(0x181):_0x26001d=[0x5,0x4,0x3,0x2,0x1],_0x436ab5=['F','B','S'],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=[_0x52666(0x1fa),_0x52666(0x189)],_0x391789=['C'],_0x58dca9=['B'];break;case _0x52666(0x167):_0x26001d=[0x1,0x2,0x3,0x4,0x5],_0x436ab5=['B','F','S'],_0x33a1ce=[0x5,0x4,0x3,0x2,0x1],_0x3a13a6=['Level',_0x52666(0x189)],_0x391789=['C'],_0x58dca9=['C'];break;case _0x52666(0x19d):_0x26001d=[0x5,0x4,0x3,0x2,0x1],_0x436ab5=['F','B','S'],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=[_0x52666(0x1fa),_0x52666(0x189)],_0x391789=['C'],_0x58dca9=['D'];break;case'Rack\x20E':_0x26001d=[0x4,0x3,0x2,0x1],_0x436ab5=[0x1,0x2],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=[_0x52666(0x1fa),_0x52666(0x189)],_0x391789=['C'],_0x58dca9=['E'];break;case _0x52666(0x212):_0x26001d=[0x1,0x2,0x3],_0x436ab5=[0x1,0x2],_0x33a1ce=[0x1,0x2,0x3,0x4,0x5],_0x3a13a6=['Level'],_0x391789=['C'],_0x58dca9=['F'];break;}}return{'levels':_0x26001d,'Isle':_0x436ab5,'rack':_0x33a1ce,'type':_0x3a13a6,'storage':_0x391789,'rak':_0x58dca9};}function a0_0x51ae(_0x1b9223,_0x346210){var _0x27c214=a0_0x27c2();return a0_0x51ae=function(_0x51ae38,_0x4e0805){_0x51ae38=_0x51ae38-0x13f;var _0x5d6dcf=_0x27c214[_0x51ae38];return _0x5d6dcf;},a0_0x51ae(_0x1b9223,_0x346210);}router['get'](a0_0x406a47(0x1ee),auth,async(_0x3f6c7f,_0x21bb57)=>{var _0x4b2d7d=a0_0x406a47;try{const {username:_0x402112,email:_0x4ae99a,role:_0x5b61cf}=_0x3f6c7f[_0x4b2d7d(0x229)],_0x1cfa90=_0x3f6c7f['user'],_0x1462ca=await profile[_0x4b2d7d(0x1b8)]({'email':_0x1cfa90[_0x4b2d7d(0x207)]}),_0x38ffec=await master_shop[_0x4b2d7d(0x205)](),_0x20a261=await transfers[_0x4b2d7d(0x16c)](_0x3f6c7f[_0x4b2d7d(0x1c0)]['id']);let _0x194525;if(_0x1cfa90[_0x4b2d7d(0x20f)]=='staff'){const _0x29a475=await staff['findOne']({'email':_0x1cfa90['email']});_0x194525=await warehouse['aggregate']([{'$match':{'status':_0x4b2d7d(0x178),'name':_0x29a475[_0x4b2d7d(0x21e)],'warehouse_category':_0x4b2d7d(0x1d4)}},{'$group':{'_id':_0x4b2d7d(0x1a0),'name':{'$first':_0x4b2d7d(0x1a0)}}}]);}else _0x194525=await warehouse['aggregate']([{'$match':{'status':_0x4b2d7d(0x178),'warehouse_category':_0x4b2d7d(0x1d4)}},{'$group':{'_id':'$name','name':{'$first':_0x4b2d7d(0x1a0)}}}]);const _0x11145d=await warehouse[_0x4b2d7d(0x1b4)]([{'$match':{'name':_0x20a261[_0x4b2d7d(0x14b)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x4b2d7d(0x209)},{'$group':{'_id':_0x4b2d7d(0x153),'name':{'$first':_0x4b2d7d(0x17a)},'product_stock':{'$first':_0x4b2d7d(0x1db)},'bay':{'$first':_0x4b2d7d(0x203)},'bin':{'$first':_0x4b2d7d(0x1f1)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4b2d7d(0x1fe)},'primary_code':{'$first':_0x4b2d7d(0x233)},'secondary_code':{'$first':_0x4b2d7d(0x247)},'product_code':{'$first':_0x4b2d7d(0x194)},'storage':{'$first':_0x4b2d7d(0x163)},'rack':{'$first':_0x4b2d7d(0x244)},'expiry_date':{'$first':_0x4b2d7d(0x22b)},'production_date':{'$first':_0x4b2d7d(0x1f6)},'room':{'$first':_0x4b2d7d(0x21b)}}}]),_0x2ebf7f=await product[_0x4b2d7d(0x205)]({}),_0xfa2f8d=BayBinSelected(_0x20a261[_0x4b2d7d(0x161)],_0x20a261['to_room']);if(_0x38ffec[0x0][_0x4b2d7d(0x204)]==_0x4b2d7d(0x1ec)){var _0x3edd64=users['English'];console[_0x4b2d7d(0x1d6)](_0x3edd64);}else{if(_0x38ffec[0x0][_0x4b2d7d(0x204)]==_0x4b2d7d(0x234))var _0x3edd64=users['Hindi'];else{if(_0x38ffec[0x0][_0x4b2d7d(0x204)]==_0x4b2d7d(0x19a))var _0x3edd64=users[_0x4b2d7d(0x19a)];else{if(_0x38ffec[0x0][_0x4b2d7d(0x204)]==_0x4b2d7d(0x1ab))var _0x3edd64=users[_0x4b2d7d(0x1ab)];else{if(_0x38ffec[0x0][_0x4b2d7d(0x204)]==_0x4b2d7d(0x144))var _0x3edd64=users[_0x4b2d7d(0x144)];else{if(_0x38ffec[0x0]['language']==_0x4b2d7d(0x24a))var _0x3edd64=users['Portuguese'];else{if(_0x38ffec[0x0][_0x4b2d7d(0x204)]=='Chinese')var _0x3edd64=users[_0x4b2d7d(0x1a9)];else{if(_0x38ffec[0x0]['language']==_0x4b2d7d(0x16f))var _0x3edd64=users[_0x4b2d7d(0x141)];}}}}}}}_0x21bb57['render']('edit_transfer',{'success':_0x3f6c7f[_0x4b2d7d(0x1b9)](_0x4b2d7d(0x1df)),'errors':_0x3f6c7f[_0x4b2d7d(0x1b9)](_0x4b2d7d(0x225)),'role':_0x1cfa90,'profile':_0x1462ca,'master_shop':_0x38ffec,'warehouse':_0x194525,'transfer':_0x20a261,'stock':_0x11145d,'unit':_0x2ebf7f,'language':_0x3edd64});}catch(_0xc7530){console['log'](_0xc7530);}}),router[a0_0x406a47(0x18e)]('/view/:id',auth,async(_0x3de86d,_0xb0c2ca)=>{var _0x1ed08d=a0_0x406a47;try{const _0x1c08df=_0x3de86d[_0x1ed08d(0x1c0)]['id'],_0x27658f=await transfers[_0x1ed08d(0x16c)](_0x1c08df);_0xb0c2ca[_0x1ed08d(0x208)](_0x3de86d[_0x1ed08d(0x180)]);return;const {date:_0x27d3ea,from_warehouse:_0x59d2ea,FromRoom_name:_0x26b7ca,to_warehouse:_0x4c68ca,ToRoom_name:_0x2db7d5,prod_name:_0x11d31e,from_prod_qty:_0x591c3e,from_prod_level:_0x384748,from_prod_isle:_0x52efd2,from_prod_pallet:_0x29ce4f,to_prod_qty:_0x321dc1,to_prod_level:_0x18a791,to_prod_isle:_0x50479c,to_prod_pallet:_0x5c732e,primary_code:_0x5ab666,secondary_code:_0x2612b5,product_code3:_0x91fe9e,note:_0x31fda2,invoice:_0x1356f4,expiry_date:_0x31fd0b}=_0x3de86d['body'];if(typeof _0x11d31e==_0x1ed08d(0x21f))var _0x47f1f0=[_0x3de86d['body']['prod_name']],_0x4b2a76=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x143)]],_0x2c7a00=[_0x3de86d[_0x1ed08d(0x180)]['from_prod_level']],_0x3aeb02=[_0x3de86d['body'][_0x1ed08d(0x1c9)]],_0x46df37=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x211)]],_0x3c80e2=[_0x3de86d['body'][_0x1ed08d(0x1d3)]],_0x3eb5a3=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1d2)]],_0x3600ad=[_0x3de86d['body'][_0x1ed08d(0x1e4)]],_0x492599=[_0x3de86d['body']['to_prod_isle']],_0x2465b4=[_0x3de86d['body'][_0x1ed08d(0x166)]],_0xd0ce2a=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x184)]],_0x35b583=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x19f)]],_0x1caa3e=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x16e)]],_0x3a0f8c=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x15b)]],_0x219583=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x216)]],_0x1e62b8=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1d5)]],_0xea49e0=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x196)]],_0x2962df=[_0x3de86d[_0x1ed08d(0x180)]['unit']],_0xa50c08=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1f5)]],_0x1d0a6b=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1e7)]],_0x1a6955=[_0x3de86d[_0x1ed08d(0x180)]['expiry_date']],_0x58803b=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x173)]],_0x3d0d59=[_0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x179)]];else var _0x47f1f0=[..._0x3de86d['body'][_0x1ed08d(0x1ac)]],_0x35b583=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x19f)]],_0x1caa3e=[..._0x3de86d['body'][_0x1ed08d(0x16e)]],_0x3c80e2=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1d3)]],_0xd0ce2a=[..._0x3de86d['body'][_0x1ed08d(0x184)]],_0x4b2a76=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x143)]],_0x2c7a00=[..._0x3de86d['body'][_0x1ed08d(0x16a)]],_0x3aeb02=[..._0x3de86d['body'][_0x1ed08d(0x1c9)]],_0x46df37=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x211)]],_0x3eb5a3=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1d2)]],_0x3600ad=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1e4)]],_0x492599=[..._0x3de86d['body']['to_prod_isle']],_0x2465b4=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x166)]],_0x3a0f8c=[..._0x3de86d['body']['primary_code']],_0x219583=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x216)]],_0x1e62b8=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1d5)]],_0xea49e0=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x196)]],_0x2962df=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1a4)]],_0xa50c08=[..._0x3de86d[_0x1ed08d(0x180)]['secondary_unit']],_0x1d0a6b=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x1e7)]],_0x1a6955=[..._0x3de86d[_0x1ed08d(0x180)][_0x1ed08d(0x217)]],_0x58803b=[..._0x3de86d['body']['from_storage']],_0x3d0d59=[..._0x3de86d[_0x1ed08d(0x180)]['from_rak']];const _0x5b15f1=_0x47f1f0['map'](_0x48a240=>{return _0x48a240={'product_name':_0x48a240};});_0x4b2a76[_0x1ed08d(0x145)]((_0x5c4d46,_0x1313b7)=>{var _0x23ee2c=_0x1ed08d;_0x5b15f1[_0x1313b7][_0x23ee2c(0x237)]=_0x5c4d46;}),_0x2c7a00[_0x1ed08d(0x145)]((_0x190d03,_0x221d22)=>{_0x5b15f1[_0x221d22]['from_bay']=_0x190d03;}),_0x3aeb02[_0x1ed08d(0x145)]((_0x296e0a,_0x266f5d)=>{var _0x3c6297=_0x1ed08d;_0x5b15f1[_0x266f5d][_0x3c6297(0x221)]=_0x296e0a;}),_0x46df37[_0x1ed08d(0x145)]((_0x39f8e2,_0x4af3a9)=>{var _0x2eccd2=_0x1ed08d;_0x5b15f1[_0x4af3a9][_0x2eccd2(0x149)]=_0x39f8e2;}),_0x3eb5a3['forEach']((_0x5280b6,_0x48a210)=>{var _0x43f2ff=_0x1ed08d;_0x5b15f1[_0x48a210][_0x43f2ff(0x1ca)]=_0x5280b6;}),_0x3600ad['forEach']((_0x4403d3,_0xb7795c)=>{var _0xe0a756=_0x1ed08d;_0x5b15f1[_0xb7795c][_0xe0a756(0x18d)]=_0x4403d3;}),_0x492599[_0x1ed08d(0x145)]((_0x144d2a,_0x221d14)=>{var _0x3adfbd=_0x1ed08d;_0x5b15f1[_0x221d14][_0x3adfbd(0x1a1)]=_0x144d2a;}),_0x2465b4['forEach']((_0x488424,_0x28f747)=>{var _0x27557f=_0x1ed08d;_0x5b15f1[_0x28f747][_0x27557f(0x157)]=_0x488424;}),_0x3a0f8c[_0x1ed08d(0x145)]((_0x2fbe1a,_0x429af8)=>{var _0x2be701=_0x1ed08d;_0x5b15f1[_0x429af8][_0x2be701(0x15b)]=_0x2fbe1a;}),_0x219583[_0x1ed08d(0x145)]((_0xa912a6,_0x550da8)=>{var _0x1e37a8=_0x1ed08d;_0x5b15f1[_0x550da8][_0x1e37a8(0x216)]=_0xa912a6;}),_0x1e62b8[_0x1ed08d(0x145)]((_0x1777ba,_0x329d23)=>{var _0x49816a=_0x1ed08d;_0x5b15f1[_0x329d23][_0x49816a(0x148)]=_0x1777ba;}),_0xea49e0[_0x1ed08d(0x145)]((_0x42f5ff,_0x2b359e)=>{var _0x48eb5f=_0x1ed08d;_0x5b15f1[_0x2b359e][_0x48eb5f(0x1f4)]=_0x42f5ff;}),_0x2962df[_0x1ed08d(0x145)]((_0x32e921,_0x5ebeca)=>{var _0x350d14=_0x1ed08d;_0x5b15f1[_0x5ebeca][_0x350d14(0x1a4)]=_0x32e921;}),_0xa50c08[_0x1ed08d(0x145)]((_0x467b04,_0x1881ce)=>{_0x5b15f1[_0x1881ce]['secondary_unit']=_0x467b04;}),_0x1d0a6b[_0x1ed08d(0x145)]((_0xb436e7,_0x59a150)=>{_0x5b15f1[_0x59a150]['batch_code']=_0xb436e7;}),_0x1a6955[_0x1ed08d(0x145)]((_0x3e0e78,_0x19d77d)=>{var _0x3e3b81=_0x1ed08d;_0x5b15f1[_0x19d77d][_0x3e3b81(0x217)]=_0x3e0e78;}),_0x35b583[_0x1ed08d(0x145)]((_0x47365f,_0x5c3cac)=>{var _0x1a9c9c=_0x1ed08d;_0x5b15f1[_0x5c3cac][_0x1a9c9c(0x19f)]=_0x47365f;}),_0x1caa3e[_0x1ed08d(0x145)]((_0x395aae,_0x550f39)=>{var _0x28635b=_0x1ed08d;_0x5b15f1[_0x550f39][_0x28635b(0x1de)]=_0x395aae;}),_0x3c80e2['forEach']((_0x5ec724,_0xa1cde9)=>{var _0x432855=_0x1ed08d;_0x5b15f1[_0xa1cde9][_0x432855(0x1d3)]=_0x5ec724;}),_0xd0ce2a['forEach']((_0x9d051,_0x5afd9c)=>{_0x5b15f1[_0x5afd9c]['to_types']=_0x9d051;}),_0x58803b[_0x1ed08d(0x145)]((_0x4fa80b,_0x302b88)=>{var _0x574a10=_0x1ed08d;_0x5b15f1[_0x302b88][_0x574a10(0x173)]=_0x4fa80b;}),_0x3d0d59[_0x1ed08d(0x145)]((_0x2d694a,_0x1e3271)=>{var _0x397b3c=_0x1ed08d;_0x5b15f1[_0x1e3271][_0x397b3c(0x246)]=_0x2d694a;});const _0x1c9ee8=_0x5b15f1['filter'](_0x23a50e=>_0x23a50e[_0x1ed08d(0x1ca)]!=='0'&&_0x23a50e[_0x1ed08d(0x1ca)]!==''||_0x23a50e[_0x1ed08d(0x157)]!=='0'&&_0x23a50e['to_floorlevel']!=='');var _0x59136b=0x0;_0x1c9ee8['forEach'](_0x3791b9=>{var _0x22e89e=_0x1ed08d;parseInt(_0x3791b9[_0x22e89e(0x237)])<parseInt(_0x3791b9[_0x22e89e(0x1ca)])&&_0x59136b++;});if(_0x59136b!=0x0)return _0x3de86d[_0x1ed08d(0x1b9)](_0x1ed08d(0x225),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0xb0c2ca['redirect']('back');const _0xc09daa=await warehouse[_0x1ed08d(0x1b8)]({'name':_0x27658f[_0x1ed08d(0x14b)],'room':_0x27658f['from_room']});_0x27658f['product'][_0x1ed08d(0x145)](_0x12f6d6=>{var _0x366844=_0x1ed08d;if(_0x12f6d6[_0x366844(0x1ca)]>0x0){const _0x2a3729=_0xc09daa['product_details'][_0x366844(0x17f)](_0x327d9e=>{var _0x4d0e18=_0x366844;_0x327d9e['product_name']==_0x12f6d6['product_name']&&_0x327d9e['floorlevel']==_0x12f6d6['from_floorlevel']&&_0x327d9e[_0x4d0e18(0x22f)]==_0x12f6d6['from_types']&&_0x327d9e[_0x4d0e18(0x14c)]==_0x12f6d6['from_bin']&&_0x327d9e[_0x4d0e18(0x15a)]==_0x12f6d6['from_bay']&&_0x327d9e['rack']==_0x12f6d6[_0x4d0e18(0x246)]&&_0x327d9e[_0x4d0e18(0x19f)]==_0x12f6d6[_0x4d0e18(0x173)]&&(_0x327d9e[_0x4d0e18(0x20c)]=parseInt(_0x327d9e[_0x4d0e18(0x20c)])+parseInt(_0x12f6d6[_0x4d0e18(0x1ca)]));});}}),await _0xc09daa[_0x1ed08d(0x218)]();const _0x737c38=await warehouse['findOne']({'name':_0x27658f['to_warehouse'],'room':_0x27658f['to_room']});_0x27658f[_0x1ed08d(0x1aa)][_0x1ed08d(0x145)](_0x9f903=>{var _0x1aed61=_0x1ed08d;if(_0x9f903['to_quantity']>0x0){const _0x12c40b=_0x737c38[_0x1aed61(0x1ad)][_0x1aed61(0x17f)](_0x4dc970=>{var _0x3cd66c=_0x1aed61;_0x4dc970[_0x3cd66c(0x17b)]==_0x9f903['product_name']&&_0x4dc970['floorlevel']==_0x9f903['to_floorlevel']&&_0x4dc970['type']==_0x9f903[_0x3cd66c(0x184)]&&_0x4dc970[_0x3cd66c(0x14c)]==_0x9f903[_0x3cd66c(0x1a1)]&&_0x4dc970['bay']==_0x9f903[_0x3cd66c(0x18d)]&&_0x4dc970['rack']==_0x9f903['rack']&&_0x4dc970[_0x3cd66c(0x19f)]==_0x9f903['storage']&&(_0x4dc970[_0x3cd66c(0x20c)]=parseInt(_0x4dc970['product_stock'])-parseInt(_0x9f903['to_quantity']));});}}),await _0x737c38['save'](),_0x27658f['date']=_0x27d3ea,_0x27658f[_0x1ed08d(0x14b)]=_0x59d2ea,_0x27658f[_0x1ed08d(0x161)]=_0x4c68ca,_0x27658f['product']=_0x1c9ee8,_0x27658f[_0x1ed08d(0x168)]=_0x31fda2,_0x27658f[_0x1ed08d(0x22a)]=_0x1356f4;const _0x337d45=await _0x27658f[_0x1ed08d(0x218)]();console[_0x1ed08d(0x1d6)](_0x337d45);const _0x549a7d=await warehouse['findOne']({'name':_0x59d2ea,'room':_0x26b7ca});_0x337d45['product'][_0x1ed08d(0x145)](_0x370c89=>{if(_0x370c89['to_quantity']>0x0){const _0x311d9a=_0x549a7d['product_details']['map'](_0x2dc3ac=>{var _0x48089f=a0_0x51ae;_0x2dc3ac[_0x48089f(0x17b)]==_0x370c89[_0x48089f(0x17b)]&&_0x2dc3ac[_0x48089f(0x239)]==_0x370c89[_0x48089f(0x149)]&&_0x2dc3ac[_0x48089f(0x22f)]==_0x370c89[_0x48089f(0x1d3)]&&_0x2dc3ac['bin']==_0x370c89['from_bin']&&_0x2dc3ac[_0x48089f(0x15a)]==_0x370c89[_0x48089f(0x230)]&&_0x2dc3ac[_0x48089f(0x1de)]==_0x370c89[_0x48089f(0x246)]&&_0x2dc3ac[_0x48089f(0x19f)]==_0x370c89['from_storage']&&(_0x2dc3ac[_0x48089f(0x20c)]=parseInt(_0x2dc3ac[_0x48089f(0x20c)])-parseInt(_0x370c89[_0x48089f(0x1ca)]));});}}),await _0x549a7d['save']();const _0x179443=await warehouse[_0x1ed08d(0x1b8)]({'name':_0x4c68ca,'room':_0x2db7d5});_0x337d45[_0x1ed08d(0x1aa)][_0x1ed08d(0x145)](_0x3771f9=>{var _0x43feac=_0x1ed08d;if(_0x3771f9[_0x43feac(0x1ca)]>0x0){var _0x2a8c47=0x0;const _0x216dab=_0x179443[_0x43feac(0x1ad)][_0x43feac(0x17f)](_0x402d98=>{var _0x13486f=_0x43feac;_0x402d98[_0x13486f(0x17b)]==_0x3771f9[_0x13486f(0x17b)]&&_0x402d98['floorlevel']==_0x3771f9[_0x13486f(0x157)]&&_0x402d98['type']==_0x3771f9[_0x13486f(0x184)]&&_0x402d98[_0x13486f(0x14c)]==_0x3771f9[_0x13486f(0x1a1)]&&_0x402d98[_0x13486f(0x15a)]==_0x3771f9['to_bay']&&_0x402d98[_0x13486f(0x1de)]==_0x3771f9[_0x13486f(0x1de)]&&_0x402d98[_0x13486f(0x19f)]==_0x3771f9['storage']&&(_0x402d98['product_stock']=parseInt(_0x402d98['product_stock'])+parseInt(_0x3771f9[_0x13486f(0x1ca)]),_0x2a8c47++);});_0x2a8c47=='0'&&(_0x179443[_0x43feac(0x1ad)]=_0x179443['product_details'][_0x43feac(0x146)]({'product_name':_0x3771f9[_0x43feac(0x17b)],'product_stock':_0x3771f9[_0x43feac(0x1ca)],'bay':_0x3771f9[_0x43feac(0x18d)],'bin':_0x3771f9[_0x43feac(0x1a1)],'type':_0x3771f9['to_types'],'floorlevel':_0x3771f9['to_floorlevel'],'storage':_0x3771f9[_0x43feac(0x19f)],'rack':_0x3771f9[_0x43feac(0x1de)],'product_code':_0x3771f9['product_code'],'primary_code':_0x3771f9['primary_code'],'secondary_code':_0x3771f9['secondary_code'],'maxProducts':_0x3771f9[_0x43feac(0x1f4)],'storage':_0x3771f9['storage'],'rack':_0x3771f9['rack']}));}}),await _0x179443[_0x1ed08d(0x218)](),_0x3de86d[_0x1ed08d(0x1b9)](_0x1ed08d(0x1df),'Transfer\x20Edit\x20Successfully'),_0xb0c2ca[_0x1ed08d(0x21d)](_0x1ed08d(0x1cd));}catch(_0x5407ca){console[_0x1ed08d(0x1d6)](_0x5407ca);}}),router[a0_0x406a47(0x18e)](a0_0x406a47(0x177),async(_0x7a1922,_0x434d99)=>{var _0x3290e7=a0_0x406a47;const {FromWareHouse:_0x2b3bb6,FromRoom:_0x4812b8,ToWarehouse:_0x997112,ToRoom:_0x249666,primary_code:_0x1189b3,Roomslist:_0x58d7ee}=_0x7a1922[_0x3290e7(0x180)],_0x581ffc=_0x58d7ee[_0x3290e7(0x1fc)](','),_0xb2c04e=[];async function _0x3309b4(_0x145e06){var _0x201c25=_0x3290e7;const _0x510388=await warehouse['aggregate']([{'$match':{'name':_0x2b3bb6,'room':_0x145e06}},{'$unwind':_0x201c25(0x209)},{'$match':{'product_details.primary_code':_0x1189b3}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x201c25(0x1db)},'primary_code':{'$first':_0x201c25(0x233)},'secondary_code':{'$first':_0x201c25(0x247)},'product_code':{'$first':_0x201c25(0x194)},'level':{'$first':_0x201c25(0x203)},'isle':{'$first':_0x201c25(0x1f1)},'type':{'$first':_0x201c25(0x1b7)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x201c25(0x1c7)},'secondary_unit':{'$first':_0x201c25(0x20d)},'storage':{'$first':_0x201c25(0x163)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x201c25(0x22b)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x201c25(0x23c)},'maxPerUnit':{'$first':_0x201c25(0x220)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x201c25(0x21b)},'maxProducts':{'$first':_0x201c25(0x1d1)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x4ac075=await warehouse[_0x201c25(0x1b4)]([{'$match':{'name':_0x2b3bb6,'room':_0x145e06}},{'$unwind':_0x201c25(0x209)},{'$match':{'product_details.secondary_code':_0x1189b3}},{'$group':{'_id':_0x201c25(0x153),'name':{'$first':_0x201c25(0x17a)},'instock':{'$first':_0x201c25(0x1db)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x201c25(0x247)},'product_code':{'$first':_0x201c25(0x194)},'level':{'$first':_0x201c25(0x203)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x201c25(0x1b7)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x201c25(0x1c7)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x201c25(0x163)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x201c25(0x22b)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x201c25(0x23c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x201c25(0x21b)},'maxProducts':{'$first':_0x201c25(0x1d1)},'invoice_product':{'$first':_0x201c25(0x20b)}}}]);if(_0x510388[_0x201c25(0x23e)]>0x0)_0xb2c04e['push'](_0x510388);else _0x4ac075[_0x201c25(0x23e)]>0x0&&_0xb2c04e[_0x201c25(0x231)](_0x4ac075);}const _0x18adc0=_0x581ffc[_0x3290e7(0x17f)](_0x3d9e5c=>_0x3309b4(_0x3d9e5c));await Promise['all'](_0x18adc0),_0x434d99[_0x3290e7(0x208)](_0xb2c04e);}),router[a0_0x406a47(0x18e)](a0_0x406a47(0x1ea),async(_0x24345c,_0x5aa699)=>{var _0x4f4088=a0_0x406a47;try{const {FromWareHouse:_0x10c704,FromRoom:_0x4d5a13,ToWarehouse:_0x24682c,ToRoom:_0x52e5e3,secondary_code:_0xba0a2a}=_0x24345c[_0x4f4088(0x180)],_0x4020fc=await warehouse['aggregate']([{'$match':{'name':_0x10c704}},{'$unwind':_0x4f4088(0x209)},{'$match':{'product_details.secondary_code':_0xba0a2a}},{'$group':{'_id':_0x4f4088(0x153),'name':{'$first':_0x4f4088(0x17a)},'primary_code':{'$first':_0x4f4088(0x233)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x4f4088(0x1db)},'warehouse':{'$first':_0x4f4088(0x1a0)},'level':{'$first':_0x4f4088(0x1a3)},'isle':{'$first':_0x4f4088(0x1c1)},'pallet':{'$first':_0x4f4088(0x240)},'maxProducts':{'$first':_0x4f4088(0x1d1)},'unit':{'$first':_0x4f4088(0x1c7)}}}]);_0x5aa699[_0x4f4088(0x1e8)](0xc8)[_0x4f4088(0x208)](_0x4020fc);}catch(_0x2d99bc){_0x5aa699[_0x4f4088(0x1e8)](0x194)['json']({'message':_0x2d99bc['message']});}}),router[a0_0x406a47(0x18e)](a0_0x406a47(0x223),async(_0xb1bb89,_0x3e5c4c)=>{var _0x1db499=a0_0x406a47;try{const {FromWareHouse:_0xfc03b0,FromRoom:_0x457938,ToWarehouse:_0x260cc3,ToRoom:_0x549135,product_code:_0x3bd064}=_0xb1bb89[_0x1db499(0x180)],_0x1f68b8=await warehouse['aggregate']([{'$match':{'name':_0xfc03b0}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x3bd064}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1db499(0x17a)},'primary_code':{'$first':_0x1db499(0x233)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1db499(0x194)},'instock':{'$first':_0x1db499(0x1db)},'warehouse':{'$first':_0x1db499(0x1a0)},'level':{'$first':_0x1db499(0x1a3)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x1db499(0x1c7)}}}]);_0x3e5c4c[_0x1db499(0x1e8)](0xc8)[_0x1db499(0x208)](_0x1f68b8);}catch(_0x565b87){_0x3e5c4c['status'](0x194)[_0x1db499(0x208)]({'message':_0x565b87['message']});}}),router['post'](a0_0x406a47(0x1b2),async(_0x3b04af,_0x51c4ab)=>{var _0xd6fa4=a0_0x406a47;const {level:_0x31de5b,isle:_0x587cd1,pallet:_0x10abcc,warehouses:_0x28d732,room:_0x2d2566}=_0x3b04af[_0xd6fa4(0x180)];try{const _0x3da79e=await warehouse['aggregate']([{'$match':{'name':_0x28d732,'room':_0x2d2566}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x31de5b),'product_details.isle':_0x587cd1,'product_details.pallet':parseInt(_0x10abcc)}},{'$group':{'_id':_0xd6fa4(0x153),'name':{'$first':_0xd6fa4(0x17a)},'product_stock':{'$first':_0xd6fa4(0x1db)},'level':{'$first':_0xd6fa4(0x1a3)},'isle':{'$first':_0xd6fa4(0x1c1)},'pallet':{'$first':_0xd6fa4(0x240)},'maxProducts':{'$first':_0xd6fa4(0x1d1)}}}]);_0x51c4ab[_0xd6fa4(0x1e8)](0xc8)[_0xd6fa4(0x208)](_0x3da79e);}catch(_0x2426d0){_0x51c4ab[_0xd6fa4(0x1e8)](0x194)[_0xd6fa4(0x208)]({'message':_0x2426d0['message']});}}),module[a0_0x406a47(0x1d0)]=router;