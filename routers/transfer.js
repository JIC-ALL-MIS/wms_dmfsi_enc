var a0_0x4e9d91=a0_0x4eeb;function a0_0x4eeb(_0x2846b0,_0x219114){var _0x1bcecd=a0_0x1bce();return a0_0x4eeb=function(_0x4eeb19,_0xff73e2){_0x4eeb19=_0x4eeb19-0xcc;var _0x1936bd=_0x1bcecd[_0x4eeb19];return _0x1936bd;},a0_0x4eeb(_0x2846b0,_0x219114);}(function(_0x2ecc92,_0x33c70b){var _0x5e4410=a0_0x4eeb,_0x54df99=_0x2ecc92();while(!![]){try{var _0x5e6f89=-parseInt(_0x5e4410(0xde))/0x1*(-parseInt(_0x5e4410(0x164))/0x2)+-parseInt(_0x5e4410(0x106))/0x3*(parseInt(_0x5e4410(0xe3))/0x4)+-parseInt(_0x5e4410(0x19a))/0x5*(parseInt(_0x5e4410(0x149))/0x6)+parseInt(_0x5e4410(0xf3))/0x7*(parseInt(_0x5e4410(0x1b3))/0x8)+-parseInt(_0x5e4410(0x17a))/0x9*(parseInt(_0x5e4410(0x154))/0xa)+-parseInt(_0x5e4410(0x1b1))/0xb*(parseInt(_0x5e4410(0x13c))/0xc)+parseInt(_0x5e4410(0x11d))/0xd*(parseInt(_0x5e4410(0xe0))/0xe);if(_0x5e6f89===_0x33c70b)break;else _0x54df99['push'](_0x54df99['shift']());}catch(_0x38b697){_0x54df99['push'](_0x54df99['shift']());}}}(a0_0x1bce,0xab4b0));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x4e9d91(0x10c)),auth=require('../middleware/auth'),users=require(a0_0x4e9d91(0xdc)),nodemailer=require(a0_0x4e9d91(0x15c));router[a0_0x4e9d91(0xf9)](a0_0x4e9d91(0x18f),auth,async(_0x5df69b,_0x277a7b)=>{var _0x149b65=a0_0x4e9d91;try{const {username:_0x2976f7,email:_0xa86fc9,role:_0x54af91}=_0x5df69b['user'],_0x477c84=_0x5df69b[_0x149b65(0x111)],_0x25c728=await profile['findOne']({'email':_0x477c84[_0x149b65(0xdb)]}),_0x4f43d1=await master_shop[_0x149b65(0x14b)]();console[_0x149b65(0xf8)](_0x149b65(0x185),_0x4f43d1);let _0x404db9;if(_0x477c84[_0x149b65(0x19b)]==_0x149b65(0xcc)){const _0x2b90c0=await staff['findOne']({'email':_0x477c84[_0x149b65(0xdb)]});_0x404db9=await transfers[_0x149b65(0x14b)]({'from_warehouse':_0x2b90c0[_0x149b65(0x18a)]});}else _0x404db9=await transfers[_0x149b65(0xdd)]([{'$unwind':_0x149b65(0x1b6)},{'$group':{'_id':_0x149b65(0x108),'invoice':{'$first':_0x149b65(0x16b)},'date':{'$first':_0x149b65(0x1bf)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x149b65(0x179)},'from_room_name':{'$addToSet':_0x149b65(0x187)},'to_room_name':{'$addToSet':_0x149b65(0x17d)},'finalize':{'$first':_0x149b65(0x162)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4f43d1[0x0]['language']==_0x149b65(0x14d)){var _0x3155ca=users[_0x149b65(0x198)];console[_0x149b65(0xf8)](_0x3155ca);}else{if(_0x4f43d1[0x0][_0x149b65(0x1b8)]==_0x149b65(0x168))var _0x3155ca=users['Hindi'];else{if(_0x4f43d1[0x0][_0x149b65(0x1b8)]==_0x149b65(0x103))var _0x3155ca=users[_0x149b65(0x103)];else{if(_0x4f43d1[0x0]['language']=='Spanish')var _0x3155ca=users['Spanish'];else{if(_0x4f43d1[0x0]['language']==_0x149b65(0x15e))var _0x3155ca=users[_0x149b65(0x15e)];else{if(_0x4f43d1[0x0][_0x149b65(0x1b8)]==_0x149b65(0x161))var _0x3155ca=users[_0x149b65(0xe9)];else{if(_0x4f43d1[0x0]['language']=='Chinese')var _0x3155ca=users[_0x149b65(0x10e)];else{if(_0x4f43d1[0x0][_0x149b65(0x1b8)]=='Arabic\x20(ae)')var _0x3155ca=users[_0x149b65(0x10b)];}}}}}}}_0x277a7b[_0x149b65(0x13a)](_0x149b65(0x112),{'success':_0x5df69b[_0x149b65(0x137)]('success'),'errors':_0x5df69b[_0x149b65(0x137)]('errors'),'role':_0x477c84,'profile':_0x25c728,'master_shop':_0x4f43d1,'transfer':_0x404db9,'language':_0x3155ca});}catch(_0x14a202){console[_0x149b65(0xf8)](_0x14a202);}});function a0_0x1bce(){var _0xd26dc3=['370WzERKD','</tr>','production_date','bay','from_floorlevel','<tbody\x20style=\x22text-align:\x20center;\x22>','Email\x20sent\x20successfully','from_bay','nodemailer','sendMail','French','bin','$room','Portuguese\x20(BR)','$finalize','from_prod_qty','35142cCstpA','from_warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','from_prod_level','Hindi','$product_details.pallet','forEach','$invoice','secondary_unit','to_quantity','filter','port','invoice','Enabled','params','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','redirect','product_code','$product_details.product_name','Receiving\x20Area','Ambient','$to_warehouse','58203ajEDFx','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','product_stock','$product.to_room_name','to_bay','$product_details.storage','Rack\x20E','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','/picking_list/PDF_transfer_rm/','batch_code','unit','master','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product.from_room_name','product_name','primary_unit','warehouse','maxperunit','product_details','to_types','_id','/view','from_rack','<html><head><title></title>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view/add_transfer','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.maxPerUnit','Floor','Rack\x20F','English','To_invoice','554895gzrlru','role','from_rak','all','secondary_code','host','/view/:id','</td>','from_room_name','random','floorlevel','from_storage','save','finalize','$product_details.product_code','Rack\x20A','Logo.png','$product_details.product_stock','from_bin','product_code3','RoomAssigned','from_invoice','status','429pJKbbV','max_per_unit','16TMlZkA','Level','createTransport','$product','post','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','message','\x20Order\x20Date\x20:\x20','/../public','$product_details.bin','product','$date','to_warehouse','staff','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<!DOCTYPE\x20html>','concat','push','TRF-','expiry_date','map','note','Transfer\x20Mail','primary_code','<span\x20style=\x22float:\x20right;\x22>','$product_details.production_date','to_invoice','email','../public/language/languages.json','aggregate','15vpbPqq','body','30684010eczPKu','json','split','820kbVxRm','Shelves','$product_details.secondary_code','$product_details.bay','</table>','from_quantity','Portuguese','rak','Product\x20Transfer\x20successfully','error','padStart','DRY\x20STORAGE','/barcode_scanner3','Raw\x20Materials','$product_details','$product_details._id','60739cvfsuZ','$product_details.primary_code','type','prod_cat','RMSEmail','log','get','Rack\x20C','Return\x20Rooms','$product_details.unit','\x20</h2>','$product_details.rack','from_prod_isle','$product_details.isle','ToRoomAssigned','rack','German','to_prod_pallet','New_Qty_Converted','17313NWTsby','back','$_id','to_prod_isle','$name','Arabic','../models/all_models','Transfer\x20Edit\x20Successfully','Chinese','<strong>\x20Regards\x20</strong>','Enclosed','user','transfer','There\x27s\x20a\x20error\x20in\x20this\x20transaction','toString','password','$product_details.type','from_types','$product_details.expiry_date','date','to_room_name','to_prod_qty','findOne','13EHjFvt','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<tr>','</head><body>','</h5>','Rack\x20D','errors','to_prod_level','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.maxProducts','Rack\x20B','$product_details.floorlevel','from_room','floor','string','$product_details.level','/CheckingWarehouse','/preview/:id','site_title','success','catch','to_room','/transfer/view','length','</tbody>','$product_details.batch_code','flash','edit_transfer','slice','render','/barcode_scanner2','73140YHfKxc','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','image','\x20Order\x20Number\x20:\x20','then','</thead>','An\x20error\x20occurred.','to_floorlevel','Spanish','maxProducts','prod_name','add_transfer','MaxStocks_data2','6fxnjOo','/barcode_scanner','find','<div>','English\x20(US)','to_bin','storage','findById','from_prod_pallet','updateOne','$product_details.secondary_unit'];a0_0x1bce=function(){return _0xd26dc3;};return a0_0x1bce();}async function getRandom8DigitNumber(){var _0x9587d6=a0_0x4e9d91;const _0x36cf55=0x989680,_0x25821a=0x5f5e0ff,_0x3e4f19=Math[_0x9587d6(0x12a)](Math[_0x9587d6(0x1a3)]()*(_0x25821a-_0x36cf55+0x1))+_0x36cf55;var _0x4a2178;const _0x2eb197=await transfers[_0x9587d6(0x11c)]({'invoice':_0x9587d6(0xd2)+_0x3e4f19});return _0x2eb197&&_0x2eb197[_0x9587d6(0x134)]>0x0?_0x4a2178=_0x9587d6(0xd2)+_0x3e4f19:_0x4a2178='TRF-'+_0x3e4f19,_0x4a2178;}router[a0_0x4e9d91(0xf9)](a0_0x4e9d91(0x193),auth,async(_0x5713bc,_0x17b9e2)=>{var _0x14e663=a0_0x4e9d91;try{const {username:_0x54909d,email:_0x2a2236,role:_0x15ba73}=_0x5713bc[_0x14e663(0x111)],_0x5ea770=_0x5713bc[_0x14e663(0x111)],_0x198541=await profile[_0x14e663(0x11c)]({'email':_0x5ea770[_0x14e663(0xdb)]}),_0x1dd55c=await master_shop[_0x14e663(0x14b)]();console[_0x14e663(0xf8)](_0x14e663(0x185),_0x1dd55c);let _0x2554c3;if(_0x5ea770[_0x14e663(0x19b)]==_0x14e663(0xcc)){const _0x191738=await staff[_0x14e663(0x11c)]({'email':_0x5ea770[_0x14e663(0xdb)]});_0x2554c3=await warehouse[_0x14e663(0xdd)]([{'$match':{'status':_0x14e663(0x171),'name':_0x191738[_0x14e663(0x18a)],'warehouse_category':_0x14e663(0xf0)}},{'$group':{'_id':_0x14e663(0x10a),'name':{'$first':_0x14e663(0x10a)}}}]);}else _0x2554c3=await warehouse[_0x14e663(0xdd)]([{'$match':{'status':'Enabled','warehouse_category':_0x14e663(0xf0)}},{'$group':{'_id':_0x14e663(0x10a),'name':{'$first':_0x14e663(0x10a)}}}]);var _0x43ec82=[_0x14e663(0x178),_0x14e663(0x110),_0x14e663(0xfb)];const _0x1fd901=await transfers[_0x14e663(0x14b)]({}),_0x272723=_0x1fd901[_0x14e663(0x134)]+0x1,_0x415c92='TRF-'+_0x272723[_0x14e663(0x114)]()[_0x14e663(0xed)](0x5,'0');if(_0x1dd55c[0x0][_0x14e663(0x1b8)]=='English\x20(US)'){var _0x3b23ec=users[_0x14e663(0x198)];console[_0x14e663(0xf8)](_0x3b23ec);}else{if(_0x1dd55c[0x0][_0x14e663(0x1b8)]==_0x14e663(0x168))var _0x3b23ec=users['Hindi'];else{if(_0x1dd55c[0x0][_0x14e663(0x1b8)]==_0x14e663(0x103))var _0x3b23ec=users[_0x14e663(0x103)];else{if(_0x1dd55c[0x0][_0x14e663(0x1b8)]=='Spanish')var _0x3b23ec=users['Spanish'];else{if(_0x1dd55c[0x0][_0x14e663(0x1b8)]==_0x14e663(0x15e))var _0x3b23ec=users[_0x14e663(0x15e)];else{if(_0x1dd55c[0x0][_0x14e663(0x1b8)]==_0x14e663(0x161))var _0x3b23ec=users[_0x14e663(0xe9)];else{if(_0x1dd55c[0x0][_0x14e663(0x1b8)]==_0x14e663(0x10e))var _0x3b23ec=users[_0x14e663(0x10e)];else{if(_0x1dd55c[0x0][_0x14e663(0x1b8)]=='Arabic\x20(ae)')var _0x3b23ec=users[_0x14e663(0x10b)];}}}}}}}const _0x4713d7=getRandom8DigitNumber();_0x4713d7[_0x14e663(0x140)](_0x5e1527=>{var _0x5e4ced=_0x14e663;_0x17b9e2[_0x5e4ced(0x13a)](_0x5e4ced(0x147),{'success':_0x5713bc['flash']('success'),'errors':_0x5713bc[_0x5e4ced(0x137)]('errors'),'role':_0x5ea770,'profile':_0x198541,'master_shop':_0x1dd55c,'warehouse':_0x2554c3,'language':_0x3b23ec,'rooms_data':_0x43ec82,'invoice':_0x5e1527});})[_0x14e663(0x131)](_0x7e2a8c=>{var _0x2722cd=_0x14e663;_0x5713bc[_0x2722cd(0x137)](_0x2722cd(0x123),_0x2722cd(0x113)),_0x17b9e2[_0x2722cd(0x174)](_0x2722cd(0x133));});}catch(_0x294861){console[_0x14e663(0xf8)](_0x294861);}}),router[a0_0x4e9d91(0x1b7)](a0_0x4e9d91(0x193),auth,async(_0x59a27e,_0xee49ba)=>{var _0xc268ec=a0_0x4e9d91;try{console[_0xc268ec(0xf8)](_0x59a27e['body']);const {date:_0x5e84f4,from_warehouse:_0x4b640e,FromRoom_name:_0x1bb18b,to_warehouse:_0x26d19a,ToRoom_name:_0x397efa,prod_name:_0xb51525,from_prod_qty:_0x5c3873,from_prod_level:_0x1a143d,from_prod_isle:_0x35d97b,from_prod_pallet:_0x5ad135,to_prod_qty:_0x14bed8,to_prod_level:_0x6c4b11,to_prod_isle:_0x3cf78d,to_prod_pallet:_0xa29de7,primary_code:_0x609ae8,secondary_code:_0x27ae7d,product_code3:_0x200f7c,note:_0x2a6f4b,MaxStocks_data2:_0x590cc8,invoice:_0x44c29b,expiry_date:_0xcaabbf}=_0x59a27e[_0xc268ec(0xdf)];if(typeof _0xb51525=='string')var _0x4add14=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x146)]],_0x37210d=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x163)]],_0x485b05=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x167)]],_0x5abf97=[_0x59a27e['body'][_0xc268ec(0x105)]],_0x370868=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x124)]],_0x1e1c0a=[_0x59a27e[_0xc268ec(0xdf)]['primary_code']],_0xf2f5a7=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x19e)]],_0x2936ed=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x1ad)]],_0x2b9efe=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x148)]],_0x4a84e4=[_0x59a27e['body'][_0xc268ec(0x189)]],_0x18c3f0=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x16c)]],_0x28dfb2=[_0x59a27e['body'][_0xc268ec(0x183)]],_0x2d9de5=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0xd3)]],_0x3b63ad=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x1b2)]],_0x43c50d=[_0x59a27e[_0xc268ec(0xdf)]['production_date']],_0x2e274e=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0xf6)]],_0x316d81=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x1ae)]],_0x5e97a0=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x101)]],_0x1e2a09=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x1af)]],_0x22cbed=[_0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0xda)]];else var _0x4add14=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x146)]],_0x37210d=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x163)]],_0x485b05=[..._0x59a27e[_0xc268ec(0xdf)]['from_prod_level']],_0x5abf97=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x105)]],_0x370868=[..._0x59a27e[_0xc268ec(0xdf)]['to_prod_level']],_0x1e1c0a=[..._0x59a27e[_0xc268ec(0xdf)]['primary_code']],_0xf2f5a7=[..._0x59a27e['body']['secondary_code']],_0x2936ed=[..._0x59a27e['body'][_0xc268ec(0x1ad)]],_0x2b9efe=[..._0x59a27e['body']['MaxStocks_data2']],_0x4a84e4=[..._0x59a27e[_0xc268ec(0xdf)]['primary_unit']],_0x18c3f0=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x16c)]],_0x28dfb2=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x183)]],_0x2d9de5=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0xd3)]],_0x3b63ad=[..._0x59a27e['body']['max_per_unit']],_0x43c50d=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x156)]],_0x2e274e=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0xf6)]],_0x316d81=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x1ae)]],_0x5e97a0=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x101)]],_0x1e2a09=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0x1af)]],_0x22cbed=[..._0x59a27e[_0xc268ec(0xdf)][_0xc268ec(0xda)]];const _0x1c81b0=_0x4add14[_0xc268ec(0xd4)](_0x438656=>{return _0x438656={'product_name':_0x438656};});_0x37210d[_0xc268ec(0x16a)]((_0x14e31f,_0x5f4696)=>{_0x1c81b0[_0x5f4696]['from_quantity']=_0x14e31f;}),_0x1e2a09[_0xc268ec(0x16a)]((_0x479a92,_0x3c3253)=>{var _0x18fb26=_0xc268ec;_0x1c81b0[_0x3c3253][_0x18fb26(0x1af)]=_0x479a92;}),_0x22cbed[_0xc268ec(0x16a)]((_0x1eb29c,_0x118449)=>{var _0xe0ed3=_0xc268ec;_0x1c81b0[_0x118449][_0xe0ed3(0x199)]=_0x1eb29c;}),_0x485b05['forEach']((_0x2bb4cc,_0x2a10f9)=>{var _0x480a47=_0xc268ec;_0x316d81[_0x480a47(0x16a)]((_0x3fee78,_0xbd08e)=>{var _0x14e88e=_0x480a47;if(_0x3fee78==_0x14e88e(0x177)&&_0x2a10f9==_0xbd08e){var _0x57f324=_0x2bb4cc['slice'](0x3);_0x1c81b0[_0x2a10f9][_0x14e88e(0x1a5)]=_0x2bb4cc[0x0],_0x1c81b0[_0x2a10f9][_0x14e88e(0x190)]=_0x2bb4cc[0x1],_0x1c81b0[_0x2a10f9]['from_bay']=0x0,_0x1c81b0[_0x2a10f9][_0x14e88e(0x1ac)]=0x0,_0x1c81b0[_0x2a10f9][_0x14e88e(0x117)]=_0x14e88e(0x196),_0x1c81b0[_0x2a10f9][_0x14e88e(0x158)]=_0x57f324;}else{if(_0x3fee78==_0x14e88e(0xe4)&&_0x2a10f9==_0xbd08e){var _0x57f324=_0x2bb4cc[_0x14e88e(0x139)](0x3);_0x1c81b0[_0x2a10f9][_0x14e88e(0x1a5)]=_0x2bb4cc[0x0],_0x1c81b0[_0x2a10f9][_0x14e88e(0x190)]=_0x2bb4cc[0x1],_0x1c81b0[_0x2a10f9]['from_bay']=0x0,_0x1c81b0[_0x2a10f9][_0x14e88e(0x1ac)]=0x0,_0x1c81b0[_0x2a10f9][_0x14e88e(0x117)]=_0x14e88e(0x196),_0x1c81b0[_0x2a10f9][_0x14e88e(0x158)]=_0x2bb4cc[0x5];}else{if(_0x2a10f9==_0xbd08e){var _0x3f8601;if(_0x2bb4cc[0x4]=='L')_0x3f8601=_0x14e88e(0x1b4);else _0x2bb4cc[0x4]=='F'&&(_0x3f8601='Floor');_0x1c81b0[_0x2a10f9][_0x14e88e(0x1a5)]=_0x2bb4cc[0x0],_0x1c81b0[_0x2a10f9][_0x14e88e(0x190)]=_0x2bb4cc[0x1],_0x1c81b0[_0x2a10f9][_0x14e88e(0x15b)]=_0x2bb4cc[0x2],_0x1c81b0[_0x2a10f9][_0x14e88e(0x1ac)]=_0x2bb4cc[0x3],_0x1c81b0[_0x2a10f9]['from_types']=_0x3f8601,_0x1c81b0[_0x2a10f9][_0x14e88e(0x158)]=_0x2bb4cc[0x5];}}}});}),_0x5abf97[_0xc268ec(0x16a)]((_0x279390,_0x593847)=>{var _0x5cb819=_0xc268ec;_0x1c81b0[_0x593847][_0x5cb819(0x16d)]=_0x279390;}),_0x370868[_0xc268ec(0x16a)]((_0x10af46,_0x27ebb4)=>{var _0x1fd19b=_0xc268ec;_0x5e97a0[_0x1fd19b(0x16a)]((_0x4d40e1,_0x5a9215)=>{var _0x22b8cb=_0x1fd19b;if(_0x4d40e1=='Receiving\x20Area'&&_0x27ebb4==_0x5a9215){var _0x209d94=_0x10af46[_0x22b8cb(0x139)](0x3);_0x1c81b0[_0x27ebb4]['storage']=_0x10af46[0x0],_0x1c81b0[_0x27ebb4][_0x22b8cb(0x102)]=_0x10af46[0x1],_0x1c81b0[_0x27ebb4]['to_bay']=0x0,_0x1c81b0[_0x27ebb4]['to_bin']=0x0,_0x1c81b0[_0x27ebb4][_0x22b8cb(0x18d)]='Floor',_0x1c81b0[_0x27ebb4][_0x22b8cb(0x143)]=_0x209d94;}else{if(_0x4d40e1=='Shelves'&&_0x27ebb4==_0x5a9215){var _0x209d94=_0x10af46[_0x22b8cb(0x139)](0x3);_0x1c81b0[_0x27ebb4]['storage']=_0x10af46[0x0],_0x1c81b0[_0x27ebb4][_0x22b8cb(0x102)]=_0x10af46[0x1],_0x1c81b0[_0x27ebb4][_0x22b8cb(0x17e)]=0x0,_0x1c81b0[_0x27ebb4]['to_bin']=0x0,_0x1c81b0[_0x27ebb4][_0x22b8cb(0x18d)]='Floor',_0x1c81b0[_0x27ebb4]['to_floorlevel']=_0x10af46[0x5];}else{if(_0x27ebb4==_0x5a9215){var _0x11de58;if(_0x10af46[0x4]=='L')_0x11de58=_0x22b8cb(0x1b4);else _0x10af46[0x4]=='F'&&(_0x11de58=_0x22b8cb(0x196));_0x1c81b0[_0x27ebb4][_0x22b8cb(0x14f)]=_0x10af46[0x0],_0x1c81b0[_0x27ebb4][_0x22b8cb(0x102)]=_0x10af46[0x1],_0x1c81b0[_0x27ebb4][_0x22b8cb(0x17e)]=_0x10af46[0x2],_0x1c81b0[_0x27ebb4][_0x22b8cb(0x14e)]=_0x10af46[0x3],_0x1c81b0[_0x27ebb4][_0x22b8cb(0x18d)]=_0x11de58,_0x1c81b0[_0x27ebb4][_0x22b8cb(0x143)]=_0x10af46[0x5];}}}});}),_0x1e1c0a[_0xc268ec(0x16a)]((_0x5ea391,_0x3033e2)=>{var _0x4bb8f0=_0xc268ec;_0x1c81b0[_0x3033e2][_0x4bb8f0(0xd7)]=_0x5ea391;}),_0xf2f5a7['forEach']((_0x29b8b,_0x2b751b)=>{_0x1c81b0[_0x2b751b]['secondary_code']=_0x29b8b;}),_0x2936ed[_0xc268ec(0x16a)]((_0x178029,_0x2ad977)=>{var _0x596c46=_0xc268ec;_0x1c81b0[_0x2ad977][_0x596c46(0x175)]=_0x178029;}),_0x2b9efe[_0xc268ec(0x16a)]((_0x345eed,_0x14e567)=>{var _0x208210=_0xc268ec;_0x1c81b0[_0x14e567][_0x208210(0x145)]=_0x345eed;}),_0x4a84e4[_0xc268ec(0x16a)]((_0x5ab5bb,_0x3903e3)=>{var _0x179bab=_0xc268ec;_0x1c81b0[_0x3903e3][_0x179bab(0x184)]=_0x5ab5bb;}),_0x18c3f0[_0xc268ec(0x16a)]((_0x548d89,_0x10d70e)=>{var _0xce28bb=_0xc268ec;_0x1c81b0[_0x10d70e][_0xce28bb(0x16c)]=_0x548d89;}),_0x28dfb2[_0xc268ec(0x16a)]((_0x49ded3,_0x43b15b)=>{_0x1c81b0[_0x43b15b]['batch_code']=_0x49ded3;}),_0x2d9de5['forEach']((_0x2aff16,_0x26eee0)=>{var _0x486046=_0xc268ec;_0x1c81b0[_0x26eee0][_0x486046(0xd3)]=_0x2aff16;}),_0x3b63ad[_0xc268ec(0x16a)]((_0x16d947,_0x1cff43)=>{_0x1c81b0[_0x1cff43]['maxperunit']=_0x16d947;}),_0x43c50d['forEach']((_0x40c0d8,_0x2e0e49)=>{var _0x47f1c3=_0xc268ec;_0x1c81b0[_0x2e0e49][_0x47f1c3(0x156)]=_0x40c0d8;}),_0x2e274e[_0xc268ec(0x16a)]((_0xa36d13,_0x3299d0)=>{var _0x2f099f=_0xc268ec;_0x1c81b0[_0x3299d0][_0x2f099f(0xf6)]=_0xa36d13;}),_0x316d81[_0xc268ec(0x16a)]((_0x39cf8b,_0x5d520e)=>{_0x1c81b0[_0x5d520e]['from_room_name']=_0x39cf8b;}),_0x5e97a0['forEach']((_0x5ef10b,_0x65e149)=>{_0x1c81b0[_0x65e149]['to_room_name']=_0x5ef10b;});const _0x1d4782=_0x1c81b0['filter'](_0x2ed2d1=>_0x2ed2d1[_0xc268ec(0x16d)]!=='0'&&_0x2ed2d1[_0xc268ec(0x16d)]!==''||_0x2ed2d1[_0xc268ec(0x143)]!=='0'&&_0x2ed2d1[_0xc268ec(0x143)]!==''),_0x425351=new transfers({'date':_0x5e84f4,'from_warehouse':_0x4b640e,'to_warehouse':_0x26d19a,'product':_0x1d4782,'note':_0x2a6f4b,'invoice':_0x44c29b}),_0x53147c=await _0x425351[_0xc268ec(0x1a6)]();_0x59a27e[_0xc268ec(0x137)](_0xc268ec(0x130),_0xc268ec(0xeb)),_0xee49ba[_0xc268ec(0x174)]('/transfer/preview/'+_0x53147c[_0xc268ec(0x18e)]);}catch(_0x50ec33){console[_0xc268ec(0xf8)](_0x50ec33),_0xee49ba[_0xc268ec(0x1b0)](0xc8)['json']({'errorMessage':_0x50ec33['message']});}}),router[a0_0x4e9d91(0xf9)](a0_0x4e9d91(0x12e),auth,async(_0x1b8439,_0x4ead50)=>{var _0x3e32f=a0_0x4e9d91;try{const {username:_0x67cfae,email:_0x2f23b4,role:_0x2d0859}=_0x1b8439['user'],_0x1e2b5e=_0x1b8439[_0x3e32f(0x111)],_0x59cfdb=await profile[_0x3e32f(0x11c)]({'email':_0x1e2b5e[_0x3e32f(0xdb)]}),_0x109fd4=await master_shop[_0x3e32f(0x14b)]();console[_0x3e32f(0xf8)](_0x3e32f(0x185),_0x109fd4);const _0x32608c=await transfers[_0x3e32f(0x150)](_0x1b8439['params']['id']);let _0x23905c=new Date(_0x32608c[_0x3e32f(0xd3)]),_0x282774=('0'+_0x23905c['getDate']())['slice'](-0x2),_0x2f280b=('0'+(_0x23905c['getMonth']()+0x1))['slice'](-0x2),_0x498af2=_0x23905c['getFullYear'](),_0x3ab57e=_0x498af2+'-'+_0x2f280b+'-'+_0x282774,_0x2b72dd;if(_0x1e2b5e[_0x3e32f(0x19b)]==_0x3e32f(0xcc)){const _0x399b1c=await staff[_0x3e32f(0x11c)]({'email':_0x1e2b5e[_0x3e32f(0xdb)]});_0x2b72dd=await warehouse[_0x3e32f(0x14b)]({'status':_0x3e32f(0x171),'name':_0x399b1c[_0x3e32f(0x18a)],'warehouse_category':_0x3e32f(0xf0)});}else _0x2b72dd=await warehouse[_0x3e32f(0x14b)]({'status':'Enabled','warehouse_category':_0x3e32f(0xf0)});const _0xe1f154=await warehouse[_0x3e32f(0xdd)]([{'$match':{'name':_0x32608c['from_warehouse']}},{'$unwind':_0x3e32f(0xf1)},{'$group':{'_id':_0x3e32f(0xf2),'name':{'$first':_0x3e32f(0x176)},'product_stock':{'$first':_0x3e32f(0x1ab)},'bay':{'$first':_0x3e32f(0xe6)},'bin':{'$first':_0x3e32f(0x1bd)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3e32f(0x128)},'primary_code':{'$first':_0x3e32f(0xf4)},'secondary_code':{'$first':_0x3e32f(0xe5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3e32f(0x17f)},'rack':{'$first':_0x3e32f(0xfe)},'expiry_date':{'$first':_0x3e32f(0x118)},'production_date':{'$first':_0x3e32f(0xd9)},'room':{'$first':_0x3e32f(0x160)}}}]);if(_0x109fd4[0x0][_0x3e32f(0x1b8)]==_0x3e32f(0x14d)){var _0x12790c=users[_0x3e32f(0x198)];console['log'](_0x12790c);}else{if(_0x109fd4[0x0]['language']==_0x3e32f(0x168))var _0x12790c=users['Hindi'];else{if(_0x109fd4[0x0][_0x3e32f(0x1b8)]==_0x3e32f(0x103))var _0x12790c=users[_0x3e32f(0x103)];else{if(_0x109fd4[0x0][_0x3e32f(0x1b8)]==_0x3e32f(0x144))var _0x12790c=users[_0x3e32f(0x144)];else{if(_0x109fd4[0x0]['language']==_0x3e32f(0x15e))var _0x12790c=users[_0x3e32f(0x15e)];else{if(_0x109fd4[0x0][_0x3e32f(0x1b8)]==_0x3e32f(0x161))var _0x12790c=users[_0x3e32f(0xe9)];else{if(_0x109fd4[0x0][_0x3e32f(0x1b8)]==_0x3e32f(0x10e))var _0x12790c=users[_0x3e32f(0x10e)];else{if(_0x109fd4[0x0][_0x3e32f(0x1b8)]=='Arabic\x20(ae)')var _0x12790c=users[_0x3e32f(0x10b)];}}}}}}}_0x4ead50['render']('edit_transfer_view',{'success':_0x1b8439[_0x3e32f(0x137)](_0x3e32f(0x130)),'errors':_0x1b8439[_0x3e32f(0x137)](_0x3e32f(0x123)),'role':_0x1e2b5e,'profile':_0x59cfdb,'master_shop':_0x109fd4,'warehouse':_0x2b72dd,'transfer':_0x32608c,'stock':_0xe1f154,'language':_0x12790c});}catch(_0x3a9ba1){console[_0x3e32f(0xf8)](_0x3a9ba1);}}),router[a0_0x4e9d91(0x1b7)](a0_0x4e9d91(0x12e),auth,async(_0x15bc00,_0x381937)=>{var _0x1d5277=a0_0x4e9d91;try{const _0xe17a5b=_0x15bc00[_0x1d5277(0x172)]['id'],{from_warehouse:_0x2dca19,FromRoom_name:_0xa10634,to_warehouse:_0x4c30c2,ToRoom_name:_0x19969a}=_0x15bc00[_0x1d5277(0xdf)],_0x3d78d3=await transfers[_0x1d5277(0x150)]({'_id':_0xe17a5b}),_0x26f75e=_0x3d78d3[_0x1d5277(0x1be)][_0x1d5277(0xd4)](async _0x52de5e=>{var _0x5b163b=_0x1d5277;if(_0x52de5e['to_quantity']>0x0){var _0x44d709=await warehouse[_0x5b163b(0x11c)]({'name':_0x3d78d3[_0x5b163b(0x165)],'room':_0x52de5e[_0x5b163b(0x1a2)],'warehouse_category':_0x5b163b(0xf0)});const _0xaf6275=_0x44d709[_0x5b163b(0x18c)]['map'](_0x5b610a=>{var _0x279999=_0x5b163b;_0x5b610a[_0x279999(0x188)]==_0x52de5e[_0x279999(0x188)]&&_0x5b610a[_0x279999(0x1a4)]==_0x52de5e[_0x279999(0x158)]&&_0x5b610a[_0x279999(0xf5)]==_0x52de5e['from_types']&&_0x5b610a[_0x279999(0x15f)]==_0x52de5e[_0x279999(0x1ac)]&&_0x5b610a[_0x279999(0x157)]==_0x52de5e[_0x279999(0x15b)]&&_0x5b610a[_0x279999(0x102)]==_0x52de5e[_0x279999(0x190)]&&_0x5b610a[_0x279999(0x14f)]==_0x52de5e[_0x279999(0x1a5)]&&_0x5b610a[_0x279999(0xd3)]==_0x52de5e['expiry_date']&&_0x5b610a[_0x279999(0x183)]==_0x52de5e['batch_code']&&_0x5b610a['production_date']==_0x52de5e['production_date']&&_0x5b610a[_0x279999(0x170)]==_0x52de5e[_0x279999(0x1af)]&&(_0x5b610a[_0x279999(0x17c)]=_0x5b610a[_0x279999(0x17c)]-_0x52de5e[_0x279999(0x16d)]);});}return _0x44d709;});Promise['all'](_0x26f75e)['then'](async _0x406cc7=>{var _0x875a5d=_0x1d5277;try{for(const _0x462b11 of _0x406cc7){await _0x462b11[_0x875a5d(0x1a6)]();}try{const _0x342060=_0x3d78d3[_0x875a5d(0x1be)][_0x875a5d(0xd4)](async _0x14cdf0=>{var _0x1ee8ea=_0x875a5d;if(_0x14cdf0[_0x1ee8ea(0x16d)]>0x0){var _0x65350b=await warehouse[_0x1ee8ea(0x11c)]({'name':_0x3d78d3[_0x1ee8ea(0x1c0)],'room':_0x14cdf0[_0x1ee8ea(0x11a)],'warehouse_category':_0x1ee8ea(0xf0)}),_0x2c7691=0x0;const _0x9a563d=_0x65350b[_0x1ee8ea(0x18c)]['map'](_0x12f22e=>{var _0x40ea6c=_0x1ee8ea;_0x12f22e[_0x40ea6c(0x188)]==_0x14cdf0[_0x40ea6c(0x188)]&&_0x12f22e['floorlevel']==_0x14cdf0[_0x40ea6c(0x143)]&&_0x12f22e[_0x40ea6c(0xf5)]==_0x14cdf0['to_types']&&_0x12f22e[_0x40ea6c(0x15f)]==_0x14cdf0[_0x40ea6c(0x14e)]&&_0x12f22e[_0x40ea6c(0x157)]==_0x14cdf0['to_bay']&&_0x12f22e[_0x40ea6c(0x102)]==_0x14cdf0[_0x40ea6c(0x102)]&&_0x12f22e[_0x40ea6c(0x14f)]==_0x14cdf0[_0x40ea6c(0x14f)]&&_0x12f22e['expiry_date']==_0x14cdf0[_0x40ea6c(0xd3)]&&_0x12f22e[_0x40ea6c(0x183)]==_0x14cdf0[_0x40ea6c(0x183)]&&_0x12f22e['production_date']==_0x14cdf0['production_date']&&_0x12f22e[_0x40ea6c(0x170)]==_0x14cdf0[_0x40ea6c(0x199)]&&(_0x12f22e[_0x40ea6c(0x17c)]=_0x12f22e[_0x40ea6c(0x17c)]+_0x14cdf0[_0x40ea6c(0x16d)],_0x2c7691++);});_0x2c7691=='0'&&(_0x65350b[_0x1ee8ea(0x18c)]=_0x65350b[_0x1ee8ea(0x18c)][_0x1ee8ea(0xd0)]({'product_name':_0x14cdf0[_0x1ee8ea(0x188)],'product_stock':_0x14cdf0[_0x1ee8ea(0x16d)],'bay':_0x14cdf0[_0x1ee8ea(0x17e)],'bin':_0x14cdf0['to_bin'],'type':_0x14cdf0[_0x1ee8ea(0x18d)],'floorlevel':_0x14cdf0[_0x1ee8ea(0x143)],'storage':_0x14cdf0[_0x1ee8ea(0x14f)],'rack':_0x14cdf0['rack'],'product_code':_0x14cdf0[_0x1ee8ea(0x175)],'primary_code':_0x14cdf0[_0x1ee8ea(0xd7)],'secondary_code':_0x14cdf0['secondary_code'],'maxProducts':_0x14cdf0[_0x1ee8ea(0x145)],'storage':_0x14cdf0['storage'],'rack':_0x14cdf0[_0x1ee8ea(0x102)],'expiry_date':_0x14cdf0[_0x1ee8ea(0xd3)],'maxPerUnit':_0x14cdf0[_0x1ee8ea(0x18b)],'batch_code':_0x14cdf0[_0x1ee8ea(0x183)],'production_date':_0x14cdf0[_0x1ee8ea(0x156)]}));}return _0x65350b;});Promise[_0x875a5d(0x19d)](_0x342060)[_0x875a5d(0x140)](async _0x288feb=>{var _0x3c41d0=_0x875a5d;try{for(const _0x4a4cfc of _0x288feb){await warehouse[_0x3c41d0(0x152)]({'_id':_0x4a4cfc['_id']},{'$addToSet':{'product_details':{'$each':_0x4a4cfc[_0x3c41d0(0x18c)]}}});}_0x3d78d3[_0x3c41d0(0x1a7)]='True';const _0x5821ed=await _0x3d78d3['save'](),_0xf3235a=await master_shop[_0x3c41d0(0x14b)](),_0x1cc6b3=await email_settings[_0x3c41d0(0x11c)](),_0x1aa3df=await supervisor_settings['find']();var _0x3f2ae7=_0x3d78d3[_0x3c41d0(0x1be)],_0x42b7fc='',_0x380711;for(_0x380711 in _0x3f2ae7){_0x42b7fc+=_0x3c41d0(0x11f)+_0x3c41d0(0x186)+_0x3f2ae7[_0x380711][_0x3c41d0(0x188)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f2ae7[_0x380711][_0x3c41d0(0x175)]+_0x3c41d0(0x1a1)+_0x3c41d0(0x186)+_0x3f2ae7[_0x380711]['to_quantity']+_0x3c41d0(0x1a1)+_0x3c41d0(0x186)+_0x3f2ae7[_0x380711][_0x3c41d0(0x184)]+_0x3c41d0(0x1a1)+_0x3c41d0(0x186)+_0x3f2ae7[_0x380711][_0x3c41d0(0x16c)]+_0x3c41d0(0x1a1)+_0x3c41d0(0x186)+_0x3d78d3[_0x3c41d0(0x1c0)]+'</td>'+_0x3c41d0(0x186)+_0x3f2ae7[_0x380711]['to_room_name']+_0x3c41d0(0x1a1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f2ae7[_0x380711]['storage']+_0x3f2ae7[_0x380711][_0x3c41d0(0x102)]+_0x3f2ae7[_0x380711][_0x3c41d0(0x17e)]+_0x3f2ae7[_0x380711][_0x3c41d0(0x14e)]+_0x3f2ae7[_0x380711][_0x3c41d0(0x18d)][0x0]+_0x3f2ae7[_0x380711][_0x3c41d0(0x143)]+'</td>','</tr>';}let _0x35d0c3=nodemailer[_0x3c41d0(0x1b5)]({'host':_0x1cc6b3[_0x3c41d0(0x19f)],'port':Number(_0x1cc6b3[_0x3c41d0(0x16f)]),'secure':![],'auth':{'user':_0x1cc6b3[_0x3c41d0(0xdb)],'pass':_0x1cc6b3[_0x3c41d0(0x115)]}}),_0x26128e={'from':_0x1cc6b3[_0x3c41d0(0xdb)],'to':_0x1aa3df[0x0][_0x3c41d0(0xf7)],'subject':_0x3c41d0(0xd6),'attachments':[{'filename':_0x3c41d0(0x1aa),'path':__dirname+_0x3c41d0(0x1bc)+'/upload/'+_0xf3235a[0x0][_0x3c41d0(0x13e)],'cid':'logo'}],'html':_0x3c41d0(0xcf)+_0x3c41d0(0x191)+_0x3c41d0(0x120)+_0x3c41d0(0x14c)+_0x3c41d0(0x173)+_0x3c41d0(0x14c)+_0x3c41d0(0x192)+'</div>'+_0x3c41d0(0x14c)+'<h2>\x20'+_0xf3235a[0x0][_0x3c41d0(0x12f)]+_0x3c41d0(0xfd)+_0x3c41d0(0xcd)+_0x3c41d0(0xcd)+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3c41d0(0x13f)+_0x3d78d3[_0x3c41d0(0x170)]+'\x20'+_0x3c41d0(0xd8)+_0x3c41d0(0x1bb)+_0x3d78d3['date']+'\x20'+'</span>'+_0x3c41d0(0x121)+_0x3c41d0(0xcd)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3c41d0(0x17b)+_0x3c41d0(0x11f)+_0x3c41d0(0x11e)+_0x3c41d0(0x13d)+_0x3c41d0(0xce)+_0x3c41d0(0x166)+_0x3c41d0(0x181)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3c41d0(0x1b9)+_0x3c41d0(0x155)+_0x3c41d0(0x141)+_0x3c41d0(0x159)+'\x20'+_0x42b7fc+'\x20'+_0x3c41d0(0x135)+_0x3c41d0(0xe7)+_0x3c41d0(0x14c)+_0x3c41d0(0x10f)+'<h5>'+_0xf3235a[0x0][_0x3c41d0(0x12f)]+_0x3c41d0(0x121)+_0x3c41d0(0xcd)+'</div>'+'</body></html>'};_0x35d0c3[_0x3c41d0(0x15d)](_0x26128e,function(_0x500e08,_0x14895e){var _0x12f426=_0x3c41d0;_0x500e08?(console[_0x12f426(0xf8)](_0x500e08),console['log']('Error\x20Occurs')):console[_0x12f426(0xf8)](_0x12f426(0x15a));}),_0x15bc00[_0x3c41d0(0x137)](_0x3c41d0(0x130),'Transfer\x20Finalize\x20Successfully'),_0x381937[_0x3c41d0(0x174)](_0x3c41d0(0x182)+_0x5821ed[_0x3c41d0(0x18e)]);}catch(_0x4a74c9){console[_0x3c41d0(0xec)](_0x4a74c9),_0x381937[_0x3c41d0(0x1b0)](0x1f4)['json']({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x4a74c9['message']});}})[_0x875a5d(0x131)](_0x5d688f=>{var _0x2b4166=_0x875a5d;console[_0x2b4166(0xec)](_0x5d688f),_0x381937[_0x2b4166(0x1b0)](0x1f4)[_0x2b4166(0xe1)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x5ea3d8){_0x381937['json'](_0x5ea3d8);}}catch(_0x5be44f){console[_0x875a5d(0xec)](_0x5be44f),_0x381937[_0x875a5d(0x1b0)](0x1f4)['json']({'Merror':_0x875a5d(0x194),'Message':_0x5be44f[_0x875a5d(0x1ba)]});}})[_0x1d5277(0x131)](_0x23837e=>{var _0x2f9760=_0x1d5277;console['error'](_0x23837e),_0x381937['status'](0x1f4)['json']({'Merror':_0x2f9760(0x142)});});}catch(_0x245164){console[_0x1d5277(0xf8)](_0x245164);}});function BayBinSelected(_0x5d0d26,_0x12c896){var _0xe5e3cb=a0_0x4e9d91,_0x559a60=[],_0x9d290d=[],_0x1928c5=[],_0x1e1e59=[],_0x39da15=[],_0x294b6b=[];let _0x9f8b7f=[];if(_0x5d0d26==_0xe5e3cb(0xee))switch(_0x12c896){case _0xe5e3cb(0x1a9):_0x559a60=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x9d290d=[0x1,0x2],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=[_0xe5e3cb(0x1b4),_0xe5e3cb(0x196)],_0x39da15=['D'],_0x294b6b=['A'];break;case _0xe5e3cb(0x127):_0x559a60=[0x6,0x5,0x4,0x3,0x2,0x1],_0x9d290d=[0x1,0x2],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=[_0xe5e3cb(0x1b4),'Floor'],_0x39da15=['D'],_0x294b6b=['B'];break;case'Shelves':_0x559a60=[0x0],_0x9d290d=[0x0],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=['Floor'],_0x39da15=['D'],_0x294b6b=['S'];break;case _0xe5e3cb(0x177):_0x559a60=[0x0],_0x9d290d=[0x0],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1928c5=['Floor'],_0x39da15=['D'],_0x294b6b=['R'];break;}else{if(_0x5d0d26=='COLD\x20STORAGE')switch(_0x12c896){case _0xe5e3cb(0x1a9):_0x559a60=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x9d290d=['B','F'],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=['Level','Floor'],_0x39da15=['C'],_0x294b6b=['A'];break;case _0xe5e3cb(0x127):_0x559a60=[0x5,0x4,0x3,0x2,0x1],_0x9d290d=['F','B','S'],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=[_0xe5e3cb(0x1b4),'Floor'],_0x39da15=['C'],_0x294b6b=['B'];break;case _0xe5e3cb(0xfa):_0x559a60=[0x1,0x2,0x3,0x4,0x5],_0x9d290d=['B','F','S'],_0x1e1e59=[0x5,0x4,0x3,0x2,0x1],_0x1928c5=[_0xe5e3cb(0x1b4),_0xe5e3cb(0x196)],_0x39da15=['C'],_0x294b6b=['C'];break;case _0xe5e3cb(0x122):_0x559a60=[0x5,0x4,0x3,0x2,0x1],_0x9d290d=['F','B','S'],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=['Level','Floor'],_0x39da15=['C'],_0x294b6b=['D'];break;case _0xe5e3cb(0x180):_0x559a60=[0x4,0x3,0x2,0x1],_0x9d290d=[0x1,0x2],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=[_0xe5e3cb(0x1b4),_0xe5e3cb(0x196)],_0x39da15=['C'],_0x294b6b=['E'];break;case _0xe5e3cb(0x197):_0x559a60=[0x1,0x2,0x3],_0x9d290d=[0x1,0x2],_0x1e1e59=[0x1,0x2,0x3,0x4,0x5],_0x1928c5=[_0xe5e3cb(0x1b4)],_0x39da15=['C'],_0x294b6b=['F'];break;}}return{'levels':_0x559a60,'Isle':_0x9d290d,'rack':_0x1e1e59,'type':_0x1928c5,'storage':_0x39da15,'rak':_0x294b6b};}router[a0_0x4e9d91(0xf9)](a0_0x4e9d91(0x1a0),auth,async(_0x1217cd,_0x37b86f)=>{var _0x6da6b8=a0_0x4e9d91;try{const {username:_0xf5371d,email:_0xe1417c,role:_0x5145da}=_0x1217cd[_0x6da6b8(0x111)],_0x38c5e7=_0x1217cd[_0x6da6b8(0x111)],_0x5d7dbf=await profile[_0x6da6b8(0x11c)]({'email':_0x38c5e7['email']}),_0x551fc2=await master_shop[_0x6da6b8(0x14b)](),_0x436722=await transfers[_0x6da6b8(0x150)](_0x1217cd[_0x6da6b8(0x172)]['id']);let _0x3136bb;if(_0x38c5e7[_0x6da6b8(0x19b)]==_0x6da6b8(0xcc)){const _0x25d573=await staff[_0x6da6b8(0x11c)]({'email':_0x38c5e7[_0x6da6b8(0xdb)]});_0x3136bb=await warehouse[_0x6da6b8(0xdd)]([{'$match':{'status':_0x6da6b8(0x171),'name':_0x25d573[_0x6da6b8(0x18a)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x6da6b8(0x10a),'name':{'$first':_0x6da6b8(0x10a)}}}]);}else _0x3136bb=await warehouse[_0x6da6b8(0xdd)]([{'$match':{'status':_0x6da6b8(0x171),'warehouse_category':_0x6da6b8(0xf0)}},{'$group':{'_id':_0x6da6b8(0x10a),'name':{'$first':_0x6da6b8(0x10a)}}}]);const _0x37bfdf=await warehouse['aggregate']([{'$match':{'name':_0x436722['from_warehouse'],'warehouse_category':_0x6da6b8(0xf0)}},{'$unwind':_0x6da6b8(0xf1)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x6da6b8(0x176)},'product_stock':{'$first':_0x6da6b8(0x1ab)},'bay':{'$first':_0x6da6b8(0xe6)},'bin':{'$first':_0x6da6b8(0x1bd)},'type':{'$first':_0x6da6b8(0x116)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x6da6b8(0xf4)},'secondary_code':{'$first':_0x6da6b8(0xe5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x6da6b8(0x17f)},'rack':{'$first':_0x6da6b8(0xfe)},'expiry_date':{'$first':_0x6da6b8(0x118)},'production_date':{'$first':_0x6da6b8(0xd9)},'room':{'$first':'$room'}}}]),_0x321dba=await product[_0x6da6b8(0x14b)]({}),_0x202ac5=BayBinSelected(_0x436722[_0x6da6b8(0x1c0)],_0x436722[_0x6da6b8(0x132)]);if(_0x551fc2[0x0][_0x6da6b8(0x1b8)]=='English\x20(US)'){var _0x4ac49f=users['English'];console['log'](_0x4ac49f);}else{if(_0x551fc2[0x0][_0x6da6b8(0x1b8)]==_0x6da6b8(0x168))var _0x4ac49f=users[_0x6da6b8(0x168)];else{if(_0x551fc2[0x0]['language']=='German')var _0x4ac49f=users[_0x6da6b8(0x103)];else{if(_0x551fc2[0x0]['language']==_0x6da6b8(0x144))var _0x4ac49f=users[_0x6da6b8(0x144)];else{if(_0x551fc2[0x0][_0x6da6b8(0x1b8)]==_0x6da6b8(0x15e))var _0x4ac49f=users['French'];else{if(_0x551fc2[0x0][_0x6da6b8(0x1b8)]==_0x6da6b8(0x161))var _0x4ac49f=users[_0x6da6b8(0xe9)];else{if(_0x551fc2[0x0][_0x6da6b8(0x1b8)]==_0x6da6b8(0x10e))var _0x4ac49f=users[_0x6da6b8(0x10e)];else{if(_0x551fc2[0x0][_0x6da6b8(0x1b8)]=='Arabic\x20(ae)')var _0x4ac49f=users[_0x6da6b8(0x10b)];}}}}}}}_0x37b86f[_0x6da6b8(0x13a)](_0x6da6b8(0x138),{'success':_0x1217cd[_0x6da6b8(0x137)]('success'),'errors':_0x1217cd[_0x6da6b8(0x137)](_0x6da6b8(0x123)),'role':_0x38c5e7,'profile':_0x5d7dbf,'master_shop':_0x551fc2,'warehouse':_0x3136bb,'transfer':_0x436722,'stock':_0x37bfdf,'unit':_0x321dba,'language':_0x4ac49f});}catch(_0x1516a9){console['log'](_0x1516a9);}}),router[a0_0x4e9d91(0x1b7)](a0_0x4e9d91(0x1a0),auth,async(_0x2b97b8,_0x10b2dd)=>{var _0x4703c5=a0_0x4e9d91;try{const _0x2e6c7a=_0x2b97b8[_0x4703c5(0x172)]['id'],_0x11197e=await transfers[_0x4703c5(0x150)](_0x2e6c7a);_0x10b2dd[_0x4703c5(0xe1)](_0x2b97b8[_0x4703c5(0xdf)]);return;const {date:_0x4e6955,from_warehouse:_0xa095b0,FromRoom_name:_0x50ae00,to_warehouse:_0x117654,ToRoom_name:_0x835053,prod_name:_0x1d83b1,from_prod_qty:_0x14ac05,from_prod_level:_0x40b6d1,from_prod_isle:_0x51b28e,from_prod_pallet:_0x12ad37,to_prod_qty:_0x7b10f,to_prod_level:_0x1d1046,to_prod_isle:_0x5269ab,to_prod_pallet:_0x59513f,primary_code:_0x3f75e0,secondary_code:_0x57af33,product_code3:_0x24baba,note:_0x17576b,invoice:_0x625fc4,expiry_date:_0xe23965}=_0x2b97b8[_0x4703c5(0xdf)];if(typeof _0x1d83b1==_0x4703c5(0x12b))var _0x58117c=[_0x2b97b8['body'][_0x4703c5(0x146)]],_0x5acec7=[_0x2b97b8['body'][_0x4703c5(0x163)]],_0x5263eb=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x167)]],_0x42ddc4=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0xff)]],_0x2960c3=[_0x2b97b8['body'][_0x4703c5(0x151)]],_0xeca81f=[_0x2b97b8['body']['from_types']],_0x1241f7=[_0x2b97b8['body'][_0x4703c5(0x11b)]],_0x5f32ed=[_0x2b97b8['body']['to_prod_level']],_0x819690=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x109)]],_0x263a9b=[_0x2b97b8[_0x4703c5(0xdf)]['to_prod_pallet']],_0x51b974=[_0x2b97b8[_0x4703c5(0xdf)]['to_types']],_0xba31=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x14f)]],_0x184ca7=[_0x2b97b8['body'][_0x4703c5(0xea)]],_0x5f1607=[_0x2b97b8['body']['primary_code']],_0x21a2e2=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x19e)]],_0x2c4325=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x1ad)]],_0x35ceb0=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x148)]],_0x121edf=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x184)]],_0x3be3a5=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x16c)]],_0x4361d0=[_0x2b97b8[_0x4703c5(0xdf)]['batch_code']],_0x4c7d0c=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0xd3)]],_0x3d78e3=[_0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x1a5)]],_0x56bdbe=[_0x2b97b8[_0x4703c5(0xdf)]['from_rak']];else var _0x58117c=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x146)]],_0xba31=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x14f)]],_0x184ca7=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0xea)]],_0xeca81f=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x117)]],_0x51b974=[..._0x2b97b8['body'][_0x4703c5(0x18d)]],_0x5acec7=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x163)]],_0x5263eb=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x167)]],_0x42ddc4=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0xff)]],_0x2960c3=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x151)]],_0x1241f7=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x11b)]],_0x5f32ed=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x124)]],_0x819690=[..._0x2b97b8[_0x4703c5(0xdf)]['to_prod_isle']],_0x263a9b=[..._0x2b97b8['body'][_0x4703c5(0x104)]],_0x5f1607=[..._0x2b97b8[_0x4703c5(0xdf)]['primary_code']],_0x21a2e2=[..._0x2b97b8['body']['secondary_code']],_0x2c4325=[..._0x2b97b8['body'][_0x4703c5(0x1ad)]],_0x35ceb0=[..._0x2b97b8[_0x4703c5(0xdf)]['MaxStocks_data2']],_0x121edf=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x184)]],_0x3be3a5=[..._0x2b97b8['body'][_0x4703c5(0x16c)]],_0x4361d0=[..._0x2b97b8[_0x4703c5(0xdf)]['batch_code']],_0x4c7d0c=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0xd3)]],_0x3d78e3=[..._0x2b97b8['body'][_0x4703c5(0x1a5)]],_0x56bdbe=[..._0x2b97b8[_0x4703c5(0xdf)][_0x4703c5(0x19c)]];const _0x5da70b=_0x58117c[_0x4703c5(0xd4)](_0x788f27=>{return _0x788f27={'product_name':_0x788f27};});_0x5acec7['forEach']((_0x425073,_0x4cd28b)=>{var _0x1f079c=_0x4703c5;_0x5da70b[_0x4cd28b][_0x1f079c(0xe8)]=_0x425073;}),_0x5263eb['forEach']((_0x3e33f4,_0x22cdf1)=>{_0x5da70b[_0x22cdf1]['from_bay']=_0x3e33f4;}),_0x42ddc4[_0x4703c5(0x16a)]((_0x1dcb2c,_0xe2075a)=>{var _0x4072ad=_0x4703c5;_0x5da70b[_0xe2075a][_0x4072ad(0x1ac)]=_0x1dcb2c;}),_0x2960c3['forEach']((_0x25b5a6,_0x4accf3)=>{var _0x12202=_0x4703c5;_0x5da70b[_0x4accf3][_0x12202(0x158)]=_0x25b5a6;}),_0x1241f7[_0x4703c5(0x16a)]((_0x21dc07,_0x1f1790)=>{_0x5da70b[_0x1f1790]['to_quantity']=_0x21dc07;}),_0x5f32ed['forEach']((_0x158196,_0x2c7e6b)=>{var _0x511731=_0x4703c5;_0x5da70b[_0x2c7e6b][_0x511731(0x17e)]=_0x158196;}),_0x819690['forEach']((_0x367090,_0x216f0e)=>{var _0x3e220c=_0x4703c5;_0x5da70b[_0x216f0e][_0x3e220c(0x14e)]=_0x367090;}),_0x263a9b[_0x4703c5(0x16a)]((_0x4965cf,_0xa2d058)=>{var _0x471031=_0x4703c5;_0x5da70b[_0xa2d058][_0x471031(0x143)]=_0x4965cf;}),_0x5f1607[_0x4703c5(0x16a)]((_0x3a407a,_0x15f68c)=>{var _0x1bf0c9=_0x4703c5;_0x5da70b[_0x15f68c][_0x1bf0c9(0xd7)]=_0x3a407a;}),_0x21a2e2['forEach']((_0x35df7d,_0x46e196)=>{var _0x2e6562=_0x4703c5;_0x5da70b[_0x46e196][_0x2e6562(0x19e)]=_0x35df7d;}),_0x2c4325[_0x4703c5(0x16a)]((_0x40bcab,_0x3b5a77)=>{var _0x50d7fc=_0x4703c5;_0x5da70b[_0x3b5a77][_0x50d7fc(0x175)]=_0x40bcab;}),_0x35ceb0[_0x4703c5(0x16a)]((_0x5c4d9e,_0x135d79)=>{var _0x3212d2=_0x4703c5;_0x5da70b[_0x135d79][_0x3212d2(0x145)]=_0x5c4d9e;}),_0x121edf[_0x4703c5(0x16a)]((_0xfd7f6b,_0x5bcf3e)=>{var _0x737a03=_0x4703c5;_0x5da70b[_0x5bcf3e][_0x737a03(0x184)]=_0xfd7f6b;}),_0x3be3a5[_0x4703c5(0x16a)]((_0x1ce070,_0x2acff6)=>{_0x5da70b[_0x2acff6]['secondary_unit']=_0x1ce070;}),_0x4361d0[_0x4703c5(0x16a)]((_0xd2f281,_0x54bd32)=>{var _0x32aa84=_0x4703c5;_0x5da70b[_0x54bd32][_0x32aa84(0x183)]=_0xd2f281;}),_0x4c7d0c[_0x4703c5(0x16a)]((_0x4a09cf,_0x5abe76)=>{_0x5da70b[_0x5abe76]['expiry_date']=_0x4a09cf;}),_0xba31[_0x4703c5(0x16a)]((_0x2f84ba,_0x552cda)=>{var _0x2448c2=_0x4703c5;_0x5da70b[_0x552cda][_0x2448c2(0x14f)]=_0x2f84ba;}),_0x184ca7[_0x4703c5(0x16a)]((_0x42e0fd,_0x5bc720)=>{_0x5da70b[_0x5bc720]['rack']=_0x42e0fd;}),_0xeca81f[_0x4703c5(0x16a)]((_0x580042,_0x399293)=>{var _0x500152=_0x4703c5;_0x5da70b[_0x399293][_0x500152(0x117)]=_0x580042;}),_0x51b974[_0x4703c5(0x16a)]((_0x32e9fc,_0x5945cc)=>{var _0x4d2dee=_0x4703c5;_0x5da70b[_0x5945cc][_0x4d2dee(0x18d)]=_0x32e9fc;}),_0x3d78e3[_0x4703c5(0x16a)]((_0x5dc73f,_0x23f135)=>{var _0x447704=_0x4703c5;_0x5da70b[_0x23f135][_0x447704(0x1a5)]=_0x5dc73f;}),_0x56bdbe['forEach']((_0x53a175,_0x5e3353)=>{var _0x55d65c=_0x4703c5;_0x5da70b[_0x5e3353][_0x55d65c(0x190)]=_0x53a175;});const _0x27f88d=_0x5da70b[_0x4703c5(0x16e)](_0x5e4bf0=>_0x5e4bf0['to_quantity']!=='0'&&_0x5e4bf0[_0x4703c5(0x16d)]!==''||_0x5e4bf0[_0x4703c5(0x143)]!=='0'&&_0x5e4bf0['to_floorlevel']!=='');var _0x5933a0=0x0;_0x27f88d[_0x4703c5(0x16a)](_0x2b87bf=>{var _0x2d1ac1=_0x4703c5;parseInt(_0x2b87bf[_0x2d1ac1(0xe8)])<parseInt(_0x2b87bf[_0x2d1ac1(0x16d)])&&_0x5933a0++;});if(_0x5933a0!=0x0)return _0x2b97b8[_0x4703c5(0x137)](_0x4703c5(0x123),_0x4703c5(0x125)),_0x10b2dd['redirect'](_0x4703c5(0x107));const _0x152126=await warehouse[_0x4703c5(0x11c)]({'name':_0x11197e[_0x4703c5(0x165)],'room':_0x11197e[_0x4703c5(0x129)]});_0x11197e[_0x4703c5(0x1be)][_0x4703c5(0x16a)](_0x26950d=>{var _0x27b08c=_0x4703c5;if(_0x26950d[_0x27b08c(0x16d)]>0x0){const _0x3d1d21=_0x152126[_0x27b08c(0x18c)][_0x27b08c(0xd4)](_0x2848b6=>{var _0x55fa12=_0x27b08c;_0x2848b6[_0x55fa12(0x188)]==_0x26950d[_0x55fa12(0x188)]&&_0x2848b6['floorlevel']==_0x26950d[_0x55fa12(0x158)]&&_0x2848b6['type']==_0x26950d['from_types']&&_0x2848b6['bin']==_0x26950d['from_bin']&&_0x2848b6['bay']==_0x26950d[_0x55fa12(0x15b)]&&_0x2848b6[_0x55fa12(0x102)]==_0x26950d['from_rack']&&_0x2848b6[_0x55fa12(0x14f)]==_0x26950d[_0x55fa12(0x1a5)]&&(_0x2848b6[_0x55fa12(0x17c)]=parseInt(_0x2848b6[_0x55fa12(0x17c)])+parseInt(_0x26950d[_0x55fa12(0x16d)]));});}}),await _0x152126['save']();const _0x48ef63=await warehouse['findOne']({'name':_0x11197e[_0x4703c5(0x1c0)],'room':_0x11197e[_0x4703c5(0x132)]});_0x11197e[_0x4703c5(0x1be)]['forEach'](_0x1bba48=>{var _0x4382c8=_0x4703c5;if(_0x1bba48[_0x4382c8(0x16d)]>0x0){const _0x457827=_0x48ef63[_0x4382c8(0x18c)][_0x4382c8(0xd4)](_0x2b8dde=>{var _0x15bf7e=_0x4382c8;_0x2b8dde[_0x15bf7e(0x188)]==_0x1bba48[_0x15bf7e(0x188)]&&_0x2b8dde['floorlevel']==_0x1bba48[_0x15bf7e(0x143)]&&_0x2b8dde[_0x15bf7e(0xf5)]==_0x1bba48['to_types']&&_0x2b8dde[_0x15bf7e(0x15f)]==_0x1bba48['to_bin']&&_0x2b8dde[_0x15bf7e(0x157)]==_0x1bba48['to_bay']&&_0x2b8dde[_0x15bf7e(0x102)]==_0x1bba48[_0x15bf7e(0x102)]&&_0x2b8dde[_0x15bf7e(0x14f)]==_0x1bba48[_0x15bf7e(0x14f)]&&(_0x2b8dde[_0x15bf7e(0x17c)]=parseInt(_0x2b8dde[_0x15bf7e(0x17c)])-parseInt(_0x1bba48['to_quantity']));});}}),await _0x48ef63[_0x4703c5(0x1a6)](),_0x11197e[_0x4703c5(0x119)]=_0x4e6955,_0x11197e[_0x4703c5(0x165)]=_0xa095b0,_0x11197e['to_warehouse']=_0x117654,_0x11197e['product']=_0x27f88d,_0x11197e[_0x4703c5(0xd5)]=_0x17576b,_0x11197e[_0x4703c5(0x170)]=_0x625fc4;const _0x59abae=await _0x11197e[_0x4703c5(0x1a6)]();console[_0x4703c5(0xf8)](_0x59abae);const _0x42c84e=await warehouse[_0x4703c5(0x11c)]({'name':_0xa095b0,'room':_0x50ae00});_0x59abae[_0x4703c5(0x1be)][_0x4703c5(0x16a)](_0x495d25=>{var _0x3220f9=_0x4703c5;if(_0x495d25['to_quantity']>0x0){const _0x3f9f0e=_0x42c84e[_0x3220f9(0x18c)][_0x3220f9(0xd4)](_0x3c08c6=>{var _0xc18257=_0x3220f9;_0x3c08c6[_0xc18257(0x188)]==_0x495d25[_0xc18257(0x188)]&&_0x3c08c6[_0xc18257(0x1a4)]==_0x495d25[_0xc18257(0x158)]&&_0x3c08c6[_0xc18257(0xf5)]==_0x495d25[_0xc18257(0x117)]&&_0x3c08c6[_0xc18257(0x15f)]==_0x495d25[_0xc18257(0x1ac)]&&_0x3c08c6[_0xc18257(0x157)]==_0x495d25[_0xc18257(0x15b)]&&_0x3c08c6['rack']==_0x495d25[_0xc18257(0x190)]&&_0x3c08c6['storage']==_0x495d25['from_storage']&&(_0x3c08c6[_0xc18257(0x17c)]=parseInt(_0x3c08c6[_0xc18257(0x17c)])-parseInt(_0x495d25[_0xc18257(0x16d)]));});}}),await _0x42c84e[_0x4703c5(0x1a6)]();const _0x31e66f=await warehouse['findOne']({'name':_0x117654,'room':_0x835053});_0x59abae['product'][_0x4703c5(0x16a)](_0x580886=>{var _0x15f107=_0x4703c5;if(_0x580886['to_quantity']>0x0){var _0x2e94e2=0x0;const _0x3da201=_0x31e66f[_0x15f107(0x18c)][_0x15f107(0xd4)](_0x449b3d=>{var _0x20ad38=_0x15f107;_0x449b3d[_0x20ad38(0x188)]==_0x580886['product_name']&&_0x449b3d[_0x20ad38(0x1a4)]==_0x580886[_0x20ad38(0x143)]&&_0x449b3d[_0x20ad38(0xf5)]==_0x580886[_0x20ad38(0x18d)]&&_0x449b3d[_0x20ad38(0x15f)]==_0x580886[_0x20ad38(0x14e)]&&_0x449b3d[_0x20ad38(0x157)]==_0x580886['to_bay']&&_0x449b3d[_0x20ad38(0x102)]==_0x580886[_0x20ad38(0x102)]&&_0x449b3d[_0x20ad38(0x14f)]==_0x580886[_0x20ad38(0x14f)]&&(_0x449b3d[_0x20ad38(0x17c)]=parseInt(_0x449b3d[_0x20ad38(0x17c)])+parseInt(_0x580886[_0x20ad38(0x16d)]),_0x2e94e2++);});_0x2e94e2=='0'&&(_0x31e66f['product_details']=_0x31e66f[_0x15f107(0x18c)][_0x15f107(0xd0)]({'product_name':_0x580886['product_name'],'product_stock':_0x580886['to_quantity'],'bay':_0x580886[_0x15f107(0x17e)],'bin':_0x580886['to_bin'],'type':_0x580886[_0x15f107(0x18d)],'floorlevel':_0x580886['to_floorlevel'],'storage':_0x580886[_0x15f107(0x14f)],'rack':_0x580886['rack'],'product_code':_0x580886[_0x15f107(0x175)],'primary_code':_0x580886[_0x15f107(0xd7)],'secondary_code':_0x580886[_0x15f107(0x19e)],'maxProducts':_0x580886[_0x15f107(0x145)],'storage':_0x580886[_0x15f107(0x14f)],'rack':_0x580886[_0x15f107(0x102)]}));}}),await _0x31e66f[_0x4703c5(0x1a6)](),_0x2b97b8[_0x4703c5(0x137)](_0x4703c5(0x130),_0x4703c5(0x10d)),_0x10b2dd['redirect']('/transfer/view');}catch(_0x8a8176){console['log'](_0x8a8176);}}),router['post'](a0_0x4e9d91(0x14a),async(_0x1ddf3b,_0x317f25)=>{var _0x3607da=a0_0x4e9d91;const {FromWareHouse:_0x5be106,FromRoom:_0x56317e,ToWarehouse:_0x1a399b,ToRoom:_0x4c11ba,primary_code:_0x2aeb3d,Roomslist:_0x160ec2}=_0x1ddf3b[_0x3607da(0xdf)],_0x2f913c=_0x160ec2[_0x3607da(0xe2)](','),_0x2c0b4d=[];async function _0x582e55(_0x4c6191){var _0x190196=_0x3607da;const _0x3c00a9=await warehouse['aggregate']([{'$match':{'name':_0x5be106,'room':_0x4c6191}},{'$unwind':_0x190196(0xf1)},{'$match':{'product_details.primary_code':_0x2aeb3d}},{'$group':{'_id':_0x190196(0xf2),'name':{'$first':_0x190196(0x176)},'instock':{'$first':_0x190196(0x1ab)},'primary_code':{'$first':_0x190196(0xf4)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x190196(0x1a8)},'level':{'$first':_0x190196(0xe6)},'isle':{'$first':_0x190196(0x1bd)},'type':{'$first':_0x190196(0x116)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x190196(0xfc)},'secondary_unit':{'$first':_0x190196(0x153)},'storage':{'$first':_0x190196(0x17f)},'rack':{'$first':_0x190196(0xfe)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x190196(0xd9)},'batch_code':{'$first':_0x190196(0x136)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x190196(0x160)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]),_0x549d6a=await warehouse[_0x190196(0xdd)]([{'$match':{'name':_0x5be106,'room':_0x4c6191}},{'$unwind':_0x190196(0xf1)},{'$match':{'product_details.secondary_code':_0x2aeb3d}},{'$group':{'_id':_0x190196(0xf2),'name':{'$first':_0x190196(0x176)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x190196(0xf4)},'secondary_code':{'$first':_0x190196(0xe5)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x190196(0xe6)},'isle':{'$first':_0x190196(0x1bd)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x190196(0x128)},'unit':{'$first':_0x190196(0xfc)},'secondary_unit':{'$first':_0x190196(0x153)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x190196(0x118)},'production_date':{'$first':_0x190196(0xd9)},'batch_code':{'$first':_0x190196(0x136)},'maxPerUnit':{'$first':_0x190196(0x195)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x190196(0x160)},'maxProducts':{'$first':_0x190196(0x126)}}}]);if(_0x3c00a9[_0x190196(0x134)]>0x0)_0x2c0b4d[_0x190196(0xd1)](_0x3c00a9);else _0x549d6a['length']>0x0&&_0x2c0b4d[_0x190196(0xd1)](_0x549d6a);}const _0x178d36=_0x2f913c[_0x3607da(0xd4)](_0x161445=>_0x582e55(_0x161445));await Promise[_0x3607da(0x19d)](_0x178d36),_0x317f25['json'](_0x2c0b4d);}),router[a0_0x4e9d91(0x1b7)](a0_0x4e9d91(0x13b),async(_0x9b490f,_0x29aef2)=>{var _0x2d6517=a0_0x4e9d91;try{const {FromWareHouse:_0x185807,FromRoom:_0x15ef56,ToWarehouse:_0x16ad60,ToRoom:_0x448195,secondary_code:_0x3ee022}=_0x9b490f[_0x2d6517(0xdf)],_0xebb323=await warehouse[_0x2d6517(0xdd)]([{'$match':{'name':_0x185807}},{'$unwind':_0x2d6517(0xf1)},{'$match':{'product_details.secondary_code':_0x3ee022}},{'$group':{'_id':_0x2d6517(0xf2),'name':{'$first':_0x2d6517(0x176)},'primary_code':{'$first':_0x2d6517(0xf4)},'secondary_code':{'$first':_0x2d6517(0xe5)},'product_code':{'$first':_0x2d6517(0x1a8)},'instock':{'$first':_0x2d6517(0x1ab)},'warehouse':{'$first':_0x2d6517(0x10a)},'level':{'$first':_0x2d6517(0x12c)},'isle':{'$first':_0x2d6517(0x100)},'pallet':{'$first':_0x2d6517(0x169)},'maxProducts':{'$first':_0x2d6517(0x126)},'unit':{'$first':_0x2d6517(0xfc)}}}]);_0x29aef2['status'](0xc8)[_0x2d6517(0xe1)](_0xebb323);}catch(_0x2f78e7){_0x29aef2[_0x2d6517(0x1b0)](0x194)[_0x2d6517(0xe1)]({'message':_0x2f78e7['message']});}}),router['post'](a0_0x4e9d91(0xef),async(_0x5bfaa5,_0x4c5918)=>{var _0x1ef544=a0_0x4e9d91;try{const {FromWareHouse:_0x1935b4,FromRoom:_0x2ba8ab,ToWarehouse:_0x569bad,ToRoom:_0x4fb188,product_code:_0x4b115d}=_0x5bfaa5[_0x1ef544(0xdf)],_0x529792=await warehouse[_0x1ef544(0xdd)]([{'$match':{'name':_0x1935b4}},{'$unwind':_0x1ef544(0xf1)},{'$match':{'product_details.product_code':_0x4b115d}},{'$group':{'_id':_0x1ef544(0xf2),'name':{'$first':_0x1ef544(0x176)},'primary_code':{'$first':_0x1ef544(0xf4)},'secondary_code':{'$first':_0x1ef544(0xe5)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x1ef544(0x1ab)},'warehouse':{'$first':_0x1ef544(0x10a)},'level':{'$first':_0x1ef544(0x12c)},'isle':{'$first':_0x1ef544(0x100)},'pallet':{'$first':_0x1ef544(0x169)},'maxProducts':{'$first':_0x1ef544(0x126)},'unit':{'$first':_0x1ef544(0xfc)}}}]);_0x4c5918[_0x1ef544(0x1b0)](0xc8)[_0x1ef544(0xe1)](_0x529792);}catch(_0x25678e){_0x4c5918[_0x1ef544(0x1b0)](0x194)[_0x1ef544(0xe1)]({'message':_0x25678e[_0x1ef544(0x1ba)]});}}),router[a0_0x4e9d91(0x1b7)](a0_0x4e9d91(0x12d),async(_0x833b8,_0x53c1c4)=>{var _0xa8860c=a0_0x4e9d91;const {level:_0x5962f6,isle:_0x1ba536,pallet:_0x462a84,warehouses:_0x3447c8,room:_0x9037de}=_0x833b8[_0xa8860c(0xdf)];try{const _0x3d2a1e=await warehouse[_0xa8860c(0xdd)]([{'$match':{'name':_0x3447c8,'room':_0x9037de}},{'$unwind':_0xa8860c(0xf1)},{'$match':{'product_details.level':parseInt(_0x5962f6),'product_details.isle':_0x1ba536,'product_details.pallet':parseInt(_0x462a84)}},{'$group':{'_id':_0xa8860c(0xf2),'name':{'$first':_0xa8860c(0x176)},'product_stock':{'$first':_0xa8860c(0x1ab)},'level':{'$first':_0xa8860c(0x12c)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xa8860c(0x169)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x53c1c4[_0xa8860c(0x1b0)](0xc8)[_0xa8860c(0xe1)](_0x3d2a1e);}catch(_0x43c3b1){_0x53c1c4['status'](0x194)[_0xa8860c(0xe1)]({'message':_0x43c3b1[_0xa8860c(0x1ba)]});}}),module['exports']=router;