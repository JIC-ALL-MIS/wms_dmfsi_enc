var a0_0x58368d=a0_0x1944;(function(_0x3db622,_0x375752){var _0x82a54d=a0_0x1944,_0x43959c=_0x3db622();while(!![]){try{var _0x3fb8b0=parseInt(_0x82a54d(0x158))/0x1+parseInt(_0x82a54d(0x1b6))/0x2+-parseInt(_0x82a54d(0x1cd))/0x3*(-parseInt(_0x82a54d(0x1ea))/0x4)+parseInt(_0x82a54d(0x19b))/0x5+parseInt(_0x82a54d(0x13d))/0x6*(parseInt(_0x82a54d(0x220))/0x7)+parseInt(_0x82a54d(0x1f8))/0x8+parseInt(_0x82a54d(0x1f5))/0x9*(-parseInt(_0x82a54d(0x1a5))/0xa);if(_0x3fb8b0===_0x375752)break;else _0x43959c['push'](_0x43959c['shift']());}catch(_0x17533f){_0x43959c['push'](_0x43959c['shift']());}}}(a0_0x1f34,0xb377a));function a0_0x1f34(){var _0x183265=['True','An\x20error\x20occurred\x20while\x20saving\x20data.','$finalize','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','here','padStart','storage','Enclosed','<h2>\x20','body','</span>','</thead>','rak','/CheckingWarehouse','from_invoice','$product_details.product_code','staff','finalize','<strong>\x20Regards\x20</strong>','$product_details.secondary_unit','updateOne','invoice','redirect','express','TRF-','prod_cat','English\x20(US)','post','findOne','maxperunit','../public/language/languages.json','to_prod_isle','forEach','Rack\x20B','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','New_Qty_Converted','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','toString','primary_unit','to_invoice','RoomAssigned','floor','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','site_title','edit_transfer_view','note','filter','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','1441815btNDDu','to_bay','$product_details._id','$product_details.floorlevel','$name','Portuguese\x20(BR)','port','bin','length','$isAllowEdit','619370exoQzB','to_quantity','$product_details.rack','$product_details.batch_code','</body></html>','/../public','prod_name','$product_details.isle','$invoice','/barcode_scanner2','$product','$product_details.maxProducts','string','product_name','Receiving\x20Area','from_quantity','image','2762868zpDxPi','from_types','_id','MaxStocks_data2','English','map','find','/picking_list/PDF_transfer_rm/','warehouse','status','/preview/:id','/view','/transfer/view','Arabic','errors','createTransport','to_room_name','$product_details.invoice','product_code3','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','to_prod_level','flash','from_prod_pallet','6LpYCSL','Floor','Rack\x20D','$product_details.product_name','</h5>','/upload/','German','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','unit','<table\x20style=\x22width:\x20100%\x20!important;\x22>','then','<hr\x20class=\x22my-3\x22>','role','type','<div>','to_prod_pallet','Enabled','from_prod_qty','id_transaction','$product_details','Portuguese','/barcode_scanner3','back','catch','Rack\x20F','split','params','expiry_date','email','1351656FXcxBm','from_floorlevel','To_invoice','to_room','max_per_unit','id_transaction_id','Arabic\x20(ae)','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','from_rak','$product_details.type','COLD\x20STORAGE','666QstCjV','message','getDate','10310448qHOHlz','$product_details.bay','concat','date','\x20<>\x20','render','Chinese','push','error','Rack\x20E','Transfer\x20Edit\x20Successfully','sendMail','from_prod_level','Router','to_floorlevel','$room','json','product_stock','secondary_code','batch_code','rack','</tr>','<span\x20style=\x22float:\x20right;\x22>','all','from_warehouse','$product_details.product_stock','\x20Order\x20Date\x20:\x20','random','$product_details.production_date','/view/:id','Rack\x20A','Email\x20sent\x20successfully','log','from_bin','getMonth','Hindi','$from_warehouse','Raw\x20Materials','master','<html><head><title></title>','7GkMkBP','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_prod_isle','</td>','slice','An\x20error\x20occurred.','\x20Order\x20Number\x20:\x20','exports','$product_details.pallet','<tr>','maxProducts','from_bay','product','$product_details.primary_code','from_rack','findById','</head><body>','$product_details.bin','transfer','add_transfer','from_storage','floorlevel','5127432PwDvAT','RMSEmail','$product_details.storage','$product_details.maxPerUnit','/view/add_transfer','Level','get','French','Shelves','Transfer\x20Finalize\x20Successfully','to_bin','$product_details.unit','primary_code','$product_details.secondary_code','language','$product_details.level','secondary_unit','<!DOCTYPE\x20html>','to_warehouse','production_date','product_details','save','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</div>','from_room_name','password','Spanish','829433pRCTUb','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','\x20</h2>','ToRoomAssigned','user','success','../middleware/auth','$_id','$product.to_room_name','logo','to_types','to_prod_qty','$to_warehouse','../models/all_models','from_room'];a0_0x1f34=function(){return _0x183265;};return a0_0x1f34();}const express=require(a0_0x58368d(0x17f)),app=express(),router=express[a0_0x58368d(0x205)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x58368d(0x165)),auth=require(a0_0x58368d(0x15e)),users=require(a0_0x58368d(0x186)),nodemailer=require('nodemailer');router[a0_0x58368d(0x143)](a0_0x58368d(0x1c1),auth,async(_0x48fc4a,_0x3b1c28)=>{var _0x299ad0=a0_0x58368d;try{const {username:_0x4bbd46,email:_0x387b51,role:_0x24f6f9}=_0x48fc4a[_0x299ad0(0x15c)],_0xfc8dbb=_0x48fc4a['user'],_0x5ef304=await profile[_0x299ad0(0x184)]({'email':_0xfc8dbb[_0x299ad0(0x1e9)]}),_0x1d5e1a=await master_shop[_0x299ad0(0x1bc)]();console[_0x299ad0(0x218)](_0x299ad0(0x21e),_0x1d5e1a);let _0x14dd1a;if(_0xfc8dbb[_0x299ad0(0x1d9)]==_0x299ad0(0x178)){const _0x2b03c1=await staff[_0x299ad0(0x184)]({'email':_0xfc8dbb[_0x299ad0(0x1e9)]});_0x14dd1a=await transfers['find']({'from_warehouse':_0x2b03c1[_0x299ad0(0x1be)]});}else _0x14dd1a=await transfers[_0x299ad0(0x194)]([{'$unwind':_0x299ad0(0x1af)},{'$group':{'_id':_0x299ad0(0x15f),'invoice':{'$first':_0x299ad0(0x1ad)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x299ad0(0x21c)},'to_warehouse':{'$first':_0x299ad0(0x164)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x299ad0(0x160)},'finalize':{'$first':_0x299ad0(0x169)},'isAllowEdit':{'$first':_0x299ad0(0x1a4)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1d5e1a[0x0][_0x299ad0(0x14b)]=='English\x20(US)'){var _0x1defee=users[_0x299ad0(0x1ba)];console[_0x299ad0(0x218)](_0x1defee);}else{if(_0x1d5e1a[0x0][_0x299ad0(0x14b)]==_0x299ad0(0x21b))var _0x1defee=users[_0x299ad0(0x21b)];else{if(_0x1d5e1a[0x0]['language']==_0x299ad0(0x1d3))var _0x1defee=users['German'];else{if(_0x1d5e1a[0x0]['language']==_0x299ad0(0x157))var _0x1defee=users[_0x299ad0(0x157)];else{if(_0x1d5e1a[0x0][_0x299ad0(0x14b)]==_0x299ad0(0x144))var _0x1defee=users[_0x299ad0(0x144)];else{if(_0x1d5e1a[0x0][_0x299ad0(0x14b)]==_0x299ad0(0x1a0))var _0x1defee=users[_0x299ad0(0x1e1)];else{if(_0x1d5e1a[0x0][_0x299ad0(0x14b)]==_0x299ad0(0x1fe))var _0x1defee=users[_0x299ad0(0x1fe)];else{if(_0x1d5e1a[0x0][_0x299ad0(0x14b)]=='Arabic\x20(ae)')var _0x1defee=users['Arabic'];}}}}}}}_0x3b1c28[_0x299ad0(0x1fd)](_0x299ad0(0x139),{'success':_0x48fc4a[_0x299ad0(0x1cb)](_0x299ad0(0x15d)),'errors':_0x48fc4a[_0x299ad0(0x1cb)]('errors'),'role':_0xfc8dbb,'profile':_0x5ef304,'master_shop':_0x1d5e1a,'transfer':_0x14dd1a,'language':_0x1defee});}catch(_0x1c0fac){console['log'](_0x1c0fac);}});async function getRandom8DigitNumber(){var _0x329b67=a0_0x58368d;const _0x389cd7=0x989680,_0x138d53=0x5f5e0ff,_0x1d9550=Math[_0x329b67(0x193)](Math[_0x329b67(0x213)]()*(_0x138d53-_0x389cd7+0x1))+_0x389cd7;var _0x463f1c;const _0xfe2d11=await transfers[_0x329b67(0x184)]({'invoice':_0x329b67(0x180)+_0x1d9550});return _0xfe2d11&&_0xfe2d11['length']>0x0?_0x463f1c=_0x329b67(0x180)+_0x1d9550:_0x463f1c=_0x329b67(0x180)+_0x1d9550,_0x463f1c;}function a0_0x1944(_0x505846,_0x381030){var _0x1f348b=a0_0x1f34();return a0_0x1944=function(_0x19442f,_0xf8517d){_0x19442f=_0x19442f-0x12f;var _0x317618=_0x1f348b[_0x19442f];return _0x317618;},a0_0x1944(_0x505846,_0x381030);}router[a0_0x58368d(0x143)]('/view/add_transfer',auth,async(_0x2ecbd2,_0x15ba08)=>{var _0x40948a=a0_0x58368d;try{const {username:_0x429fc0,email:_0x38a2cc,role:_0x430a46}=_0x2ecbd2[_0x40948a(0x15c)],_0x339b28=_0x2ecbd2[_0x40948a(0x15c)],_0x6c8494=await profile[_0x40948a(0x184)]({'email':_0x339b28[_0x40948a(0x1e9)]}),_0x26cb16=await master_shop[_0x40948a(0x1bc)]();console[_0x40948a(0x218)](_0x40948a(0x21e),_0x26cb16);let _0x3419f8;if(_0x339b28[_0x40948a(0x1d9)]==_0x40948a(0x178)){const _0x469620=await staff[_0x40948a(0x184)]({'email':_0x339b28['email']});_0x3419f8=await warehouse[_0x40948a(0x194)]([{'$match':{'status':_0x40948a(0x1dd),'name':_0x469620[_0x40948a(0x1be)],'warehouse_category':_0x40948a(0x21d)}},{'$group':{'_id':_0x40948a(0x19f),'name':{'$first':_0x40948a(0x19f)}}}]);}else _0x3419f8=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x40948a(0x19f),'name':{'$first':_0x40948a(0x19f)}}}]);var _0x12e1f7=['Ambient',_0x40948a(0x16f),'Return\x20Rooms'];const _0x58b0cb=await transfers[_0x40948a(0x1bc)]({}),_0x30a6e6=_0x58b0cb[_0x40948a(0x1a3)]+0x1,_0x38b8d8='TRF-'+_0x30a6e6[_0x40948a(0x18f)]()[_0x40948a(0x16d)](0x5,'0');if(_0x26cb16[0x0]['language']=='English\x20(US)'){var _0x5db9d9=users[_0x40948a(0x1ba)];console[_0x40948a(0x218)](_0x5db9d9);}else{if(_0x26cb16[0x0][_0x40948a(0x14b)]==_0x40948a(0x21b))var _0x5db9d9=users[_0x40948a(0x21b)];else{if(_0x26cb16[0x0][_0x40948a(0x14b)]=='German')var _0x5db9d9=users[_0x40948a(0x1d3)];else{if(_0x26cb16[0x0][_0x40948a(0x14b)]==_0x40948a(0x157))var _0x5db9d9=users[_0x40948a(0x157)];else{if(_0x26cb16[0x0][_0x40948a(0x14b)]==_0x40948a(0x144))var _0x5db9d9=users[_0x40948a(0x144)];else{if(_0x26cb16[0x0][_0x40948a(0x14b)]==_0x40948a(0x1a0))var _0x5db9d9=users['Portuguese'];else{if(_0x26cb16[0x0]['language']==_0x40948a(0x1fe))var _0x5db9d9=users[_0x40948a(0x1fe)];else{if(_0x26cb16[0x0]['language']=='Arabic\x20(ae)')var _0x5db9d9=users['Arabic'];}}}}}}}const _0x2b643d=getRandom8DigitNumber();_0x2b643d['then'](_0x34e6e1=>{var _0x557bc2=_0x40948a;_0x15ba08[_0x557bc2(0x1fd)](_0x557bc2(0x13a),{'success':_0x2ecbd2['flash'](_0x557bc2(0x15d)),'errors':_0x2ecbd2['flash'](_0x557bc2(0x1c4)),'role':_0x339b28,'profile':_0x6c8494,'master_shop':_0x26cb16,'warehouse':_0x3419f8,'language':_0x5db9d9,'rooms_data':_0x12e1f7,'invoice':_0x34e6e1});})[_0x40948a(0x1e4)](_0x3d2095=>{var _0x1a5b8d=_0x40948a;_0x2ecbd2[_0x1a5b8d(0x1cb)](_0x1a5b8d(0x1c4),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x15ba08[_0x1a5b8d(0x17e)](_0x1a5b8d(0x1c2));});}catch(_0x497b84){console['log'](_0x497b84);}}),router['post'](a0_0x58368d(0x141),auth,async(_0x20bc45,_0x864b5a)=>{var _0x179aab=a0_0x58368d;try{console[_0x179aab(0x218)](_0x20bc45['body']);const {date:_0x3e36e8,from_warehouse:_0x2cc4dc,FromRoom_name:_0x5c1973,to_warehouse:_0x435a19,ToRoom_name:_0x5a73af,prod_name:_0x3a0be8,from_prod_qty:_0x3fbe9d,from_prod_level:_0x2aec38,from_prod_isle:_0x11eef9,from_prod_pallet:_0x142983,to_prod_qty:_0x35a911,to_prod_level:_0x11fe6f,to_prod_isle:_0x363c40,to_prod_pallet:_0x54fe6e,primary_code:_0x53f25e,secondary_code:_0x102c86,product_code3:_0xcce047,note:_0x157920,MaxStocks_data2:_0x53b98e,invoice:_0x1f923e,expiry_date:_0x266713}=_0x20bc45[_0x179aab(0x171)];if(typeof _0x3a0be8==_0x179aab(0x1b1))var _0x57c11e=[_0x20bc45['body'][_0x179aab(0x1ab)]],_0x511169=[_0x20bc45['body'][_0x179aab(0x1de)]],_0x482cd8=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x204)]],_0x2fa61e=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x18c)]],_0x455972=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x1ca)]],_0x3b89b2=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x149)]],_0x2d1d68=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x20a)]],_0x62fe49=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x1c8)]],_0x322f20=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x1b9)]],_0x44571c=[_0x20bc45[_0x179aab(0x171)]['primary_unit']],_0x3e96d5=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x14d)]],_0x52e839=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x20b)]],_0x5d188f=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x1e8)]],_0x3cd670=[_0x20bc45['body'][_0x179aab(0x1ee)]],_0x4e17c8=[_0x20bc45[_0x179aab(0x171)]['production_date']],_0x535cee=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x181)]],_0xc667f2=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x192)]],_0x2edb0e=[_0x20bc45['body'][_0x179aab(0x15b)]],_0x4a076e=[_0x20bc45['body'][_0x179aab(0x176)]],_0x54e98d=[_0x20bc45['body'][_0x179aab(0x191)]],_0x1346ee=[_0x20bc45[_0x179aab(0x171)][_0x179aab(0x1df)]];else var _0x57c11e=[..._0x20bc45['body'][_0x179aab(0x1ab)]],_0x511169=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x1de)]],_0x482cd8=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x204)]],_0x2fa61e=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x18c)]],_0x455972=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x1ca)]],_0x3b89b2=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x149)]],_0x2d1d68=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x20a)]],_0x62fe49=[..._0x20bc45[_0x179aab(0x171)]['product_code3']],_0x322f20=[..._0x20bc45[_0x179aab(0x171)]['MaxStocks_data2']],_0x44571c=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x190)]],_0x3e96d5=[..._0x20bc45['body']['secondary_unit']],_0x52e839=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x20b)]],_0x5d188f=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x1e8)]],_0x3cd670=[..._0x20bc45['body'][_0x179aab(0x1ee)]],_0x4e17c8=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x150)]],_0x535cee=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x181)]],_0xc667f2=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x192)]],_0x2edb0e=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x15b)]],_0x4a076e=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x176)]],_0x54e98d=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x191)]],_0x1346ee=[..._0x20bc45[_0x179aab(0x171)][_0x179aab(0x1df)]];const _0x2041fa=_0x57c11e[_0x179aab(0x1bb)](_0x361914=>{return _0x361914={'product_name':_0x361914};});_0x511169['forEach']((_0x2911ab,_0x1f0b8a)=>{var _0x1c4e79=_0x179aab;_0x2041fa[_0x1f0b8a][_0x1c4e79(0x1b4)]=_0x2911ab;}),_0x4a076e[_0x179aab(0x188)]((_0x5583ac,_0x23ed2f)=>{var _0x2f5e9c=_0x179aab;_0x2041fa[_0x23ed2f][_0x2f5e9c(0x176)]=_0x5583ac;}),_0x54e98d[_0x179aab(0x188)]((_0x50dc79,_0x4ae9b4)=>{var _0x30e347=_0x179aab;_0x2041fa[_0x4ae9b4][_0x30e347(0x1ec)]=_0x50dc79;}),_0x1346ee['forEach']((_0x29cd22,_0x17d2de)=>{var _0x149832=_0x179aab;_0x2041fa[_0x17d2de][_0x149832(0x1ef)]=_0x29cd22;}),_0x482cd8[_0x179aab(0x188)]((_0x164f8f,_0x50f1cc)=>{var _0x2954cc=_0x179aab;_0xc667f2[_0x2954cc(0x188)]((_0x57851c,_0x1a2f4d)=>{var _0x768f8c=_0x2954cc;if(_0x57851c==_0x768f8c(0x1b3)&&_0x50f1cc==_0x1a2f4d){var _0x3d081a=_0x164f8f[_0x768f8c(0x225)](0x3);_0x2041fa[_0x50f1cc]['from_storage']=_0x164f8f[0x0],_0x2041fa[_0x50f1cc][_0x768f8c(0x135)]=_0x164f8f[0x1],_0x2041fa[_0x50f1cc][_0x768f8c(0x132)]=0x0,_0x2041fa[_0x50f1cc][_0x768f8c(0x219)]=0x0,_0x2041fa[_0x50f1cc][_0x768f8c(0x1b7)]=_0x768f8c(0x1ce),_0x2041fa[_0x50f1cc][_0x768f8c(0x1eb)]=_0x3d081a;}else{if(_0x57851c==_0x768f8c(0x145)&&_0x50f1cc==_0x1a2f4d){var _0x3d081a=_0x164f8f[_0x768f8c(0x225)](0x3);_0x2041fa[_0x50f1cc][_0x768f8c(0x13b)]=_0x164f8f[0x0],_0x2041fa[_0x50f1cc][_0x768f8c(0x135)]=_0x164f8f[0x1],_0x2041fa[_0x50f1cc][_0x768f8c(0x132)]=0x0,_0x2041fa[_0x50f1cc][_0x768f8c(0x219)]=0x0,_0x2041fa[_0x50f1cc][_0x768f8c(0x1b7)]=_0x768f8c(0x1ce),_0x2041fa[_0x50f1cc][_0x768f8c(0x1eb)]=_0x164f8f[0x5];}else{if(_0x50f1cc==_0x1a2f4d){if(_0x164f8f[0x0]=='A'&&_0x164f8f[0x1]=='L'&&_0x164f8f[0x2]=='L')console[_0x768f8c(0x218)](_0x57851c+_0x768f8c(0x1fc)+_0x50f1cc+_0x768f8c(0x1fc)+_0x1a2f4d+_0x768f8c(0x1fc)+_0x164f8f+_0x768f8c(0x16c)),_0x2041fa[_0x50f1cc][_0x768f8c(0x13b)]=_0x164f8f[0x0],_0x2041fa[_0x50f1cc][_0x768f8c(0x135)]=_0x164f8f[0x1],_0x2041fa[_0x50f1cc][_0x768f8c(0x132)]=0x0,_0x2041fa[_0x50f1cc]['from_bin']=0x0,_0x2041fa[_0x50f1cc][_0x768f8c(0x1b7)]='Floor',_0x2041fa[_0x50f1cc][_0x768f8c(0x1eb)]=_0x164f8f[0x3];else{var _0x2b9756;if(_0x164f8f[0x4]=='L')_0x2b9756=_0x768f8c(0x142);else _0x164f8f[0x4]=='F'&&(_0x2b9756=_0x768f8c(0x1ce));_0x2041fa[_0x50f1cc][_0x768f8c(0x13b)]=_0x164f8f[0x0],_0x2041fa[_0x50f1cc][_0x768f8c(0x135)]=_0x164f8f[0x1],_0x2041fa[_0x50f1cc][_0x768f8c(0x132)]=_0x164f8f[0x2],_0x2041fa[_0x50f1cc][_0x768f8c(0x219)]=_0x164f8f[0x3],_0x2041fa[_0x50f1cc][_0x768f8c(0x1b7)]=_0x2b9756,_0x2041fa[_0x50f1cc][_0x768f8c(0x1eb)]=_0x164f8f[0x5];}}}}});}),_0x2fa61e[_0x179aab(0x188)]((_0x54fd47,_0x5540b8)=>{_0x2041fa[_0x5540b8]['to_quantity']=_0x54fd47;}),_0x455972['forEach']((_0x35c1a2,_0x151b62)=>{var _0x1769f6=_0x179aab;_0x2edb0e[_0x1769f6(0x188)]((_0x3fa890,_0x2468f0)=>{var _0xeef0b3=_0x1769f6;if(_0x3fa890==_0xeef0b3(0x1b3)&&_0x151b62==_0x2468f0){var _0x481378=_0x35c1a2[_0xeef0b3(0x225)](0x3);_0x2041fa[_0x151b62][_0xeef0b3(0x16e)]=_0x35c1a2[0x0],_0x2041fa[_0x151b62][_0xeef0b3(0x20c)]=_0x35c1a2[0x1],_0x2041fa[_0x151b62][_0xeef0b3(0x19c)]=0x0,_0x2041fa[_0x151b62]['to_bin']=0x0,_0x2041fa[_0x151b62][_0xeef0b3(0x162)]=_0xeef0b3(0x1ce),_0x2041fa[_0x151b62][_0xeef0b3(0x206)]=_0x481378;}else{if(_0x3fa890==_0xeef0b3(0x145)&&_0x151b62==_0x2468f0){var _0x481378=_0x35c1a2[_0xeef0b3(0x225)](0x3);_0x2041fa[_0x151b62][_0xeef0b3(0x16e)]=_0x35c1a2[0x0],_0x2041fa[_0x151b62]['rack']=_0x35c1a2[0x1],_0x2041fa[_0x151b62][_0xeef0b3(0x19c)]=0x0,_0x2041fa[_0x151b62][_0xeef0b3(0x147)]=0x0,_0x2041fa[_0x151b62][_0xeef0b3(0x162)]=_0xeef0b3(0x1ce),_0x2041fa[_0x151b62][_0xeef0b3(0x206)]=_0x35c1a2[0x5];}else{if(_0x151b62==_0x2468f0){if(_0x35c1a2[0x0]=='A'&&_0x35c1a2[0x1]=='L'&&_0x35c1a2[0x2]=='L')console[_0xeef0b3(0x218)](_0x3fa890+_0xeef0b3(0x1fc)+_0x151b62+_0xeef0b3(0x1fc)+_0x2468f0+'\x20<>\x20'+_0x35c1a2+_0xeef0b3(0x16c)),_0x2041fa[_0x151b62][_0xeef0b3(0x16e)]=_0x35c1a2[0x0],_0x2041fa[_0x151b62][_0xeef0b3(0x20c)]=_0x35c1a2[0x1],_0x2041fa[_0x151b62][_0xeef0b3(0x19c)]=0x0,_0x2041fa[_0x151b62][_0xeef0b3(0x147)]=0x0,_0x2041fa[_0x151b62]['to_types']=_0xeef0b3(0x1ce),_0x2041fa[_0x151b62][_0xeef0b3(0x206)]=_0x35c1a2[0x3];else{var _0x24862c;if(_0x35c1a2[0x4]=='L')_0x24862c=_0xeef0b3(0x142);else _0x35c1a2[0x4]=='F'&&(_0x24862c='Floor');_0x2041fa[_0x151b62]['storage']=_0x35c1a2[0x0],_0x2041fa[_0x151b62][_0xeef0b3(0x20c)]=_0x35c1a2[0x1],_0x2041fa[_0x151b62][_0xeef0b3(0x19c)]=_0x35c1a2[0x2],_0x2041fa[_0x151b62][_0xeef0b3(0x147)]=_0x35c1a2[0x3],_0x2041fa[_0x151b62][_0xeef0b3(0x162)]=_0x24862c,_0x2041fa[_0x151b62][_0xeef0b3(0x206)]=_0x35c1a2[0x5];}}}}});}),_0x3b89b2[_0x179aab(0x188)]((_0x4928e4,_0x11967d)=>{var _0x196c4f=_0x179aab;_0x2041fa[_0x11967d][_0x196c4f(0x149)]=_0x4928e4;}),_0x2d1d68[_0x179aab(0x188)]((_0x208b47,_0x568fbc)=>{var _0x282874=_0x179aab;_0x2041fa[_0x568fbc][_0x282874(0x20a)]=_0x208b47;}),_0x62fe49[_0x179aab(0x188)]((_0x3f5162,_0x2c0b08)=>{var _0x46c90a=_0x179aab;_0x2041fa[_0x2c0b08][_0x46c90a(0x18a)]=_0x3f5162;}),_0x322f20[_0x179aab(0x188)]((_0x20b03d,_0x1c212a)=>{var _0xde2db2=_0x179aab;_0x2041fa[_0x1c212a][_0xde2db2(0x131)]=_0x20b03d;}),_0x44571c[_0x179aab(0x188)]((_0x3c5647,_0x544e4b)=>{var _0x3f949f=_0x179aab;_0x2041fa[_0x544e4b][_0x3f949f(0x1d5)]=_0x3c5647;}),_0x3e96d5[_0x179aab(0x188)]((_0x401a5e,_0x2b8a4f)=>{var _0x5d4614=_0x179aab;_0x2041fa[_0x2b8a4f][_0x5d4614(0x14d)]=_0x401a5e;}),_0x52e839['forEach']((_0x3a243c,_0x20d664)=>{var _0x4fd567=_0x179aab;_0x2041fa[_0x20d664][_0x4fd567(0x20b)]=_0x3a243c;}),_0x5d188f[_0x179aab(0x188)]((_0x3fbdea,_0x1e6dd0)=>{_0x2041fa[_0x1e6dd0]['expiry_date']=_0x3fbdea;}),_0x3cd670[_0x179aab(0x188)]((_0x4bf151,_0x11ac52)=>{var _0x32ef34=_0x179aab;_0x2041fa[_0x11ac52][_0x32ef34(0x185)]=_0x4bf151;}),_0x4e17c8['forEach']((_0x4ec190,_0x169321)=>{var _0x1ef0fd=_0x179aab;_0x2041fa[_0x169321][_0x1ef0fd(0x150)]=_0x4ec190;}),_0x535cee['forEach']((_0x25bf0,_0x527fb1)=>{var _0x135ed8=_0x179aab;_0x2041fa[_0x527fb1][_0x135ed8(0x181)]=_0x25bf0;}),_0xc667f2['forEach']((_0x1ebd0d,_0x364ca0)=>{var _0x2b88ff=_0x179aab;_0x2041fa[_0x364ca0][_0x2b88ff(0x155)]=_0x1ebd0d;}),_0x2edb0e[_0x179aab(0x188)]((_0x24b929,_0x18d63e)=>{var _0x484603=_0x179aab;_0x2041fa[_0x18d63e][_0x484603(0x1c6)]=_0x24b929;});const _0x11f77c=_0x2041fa[_0x179aab(0x199)](_0x1087e8=>_0x1087e8['to_quantity']!=='0'&&_0x1087e8[_0x179aab(0x1a6)]!==''||_0x1087e8[_0x179aab(0x206)]!=='0'&&_0x1087e8['to_floorlevel']!==''),_0x114de6=new transfers({'date':_0x3e36e8,'from_warehouse':_0x2cc4dc,'to_warehouse':_0x435a19,'product':_0x11f77c,'note':_0x157920,'invoice':_0x1f923e}),_0x298383=await _0x114de6[_0x179aab(0x152)]();_0x20bc45['flash']('success','Product\x20Transfer\x20successfully'),_0x864b5a['redirect']('/transfer/preview/'+_0x298383[_0x179aab(0x1b8)]);}catch(_0x2326ce){console[_0x179aab(0x218)](_0x2326ce),_0x864b5a[_0x179aab(0x1bf)](0xc8)['json']({'errorMessage':_0x2326ce['message']});}}),router['get']('/preview/:id',auth,async(_0x105fb0,_0x31d426)=>{var _0x394729=a0_0x58368d;try{const {username:_0x421dcc,email:_0x412d86,role:_0x51369c}=_0x105fb0['user'],_0x1d1704=_0x105fb0[_0x394729(0x15c)],_0x57385d=await profile[_0x394729(0x184)]({'email':_0x1d1704[_0x394729(0x1e9)]}),_0x47b9a5=await master_shop['find']();console[_0x394729(0x218)](_0x394729(0x21e),_0x47b9a5);const _0x3f40e0=await transfers[_0x394729(0x136)](_0x105fb0['params']['id']);let _0x215f15=new Date(_0x3f40e0[_0x394729(0x1e8)]),_0x32ec1c=('0'+_0x215f15[_0x394729(0x1f7)]())[_0x394729(0x225)](-0x2),_0x2b662f=('0'+(_0x215f15[_0x394729(0x21a)]()+0x1))[_0x394729(0x225)](-0x2),_0x53d96e=_0x215f15['getFullYear'](),_0x56d1d2=_0x53d96e+'-'+_0x2b662f+'-'+_0x32ec1c,_0x1fc1a4;if(_0x1d1704[_0x394729(0x1d9)]==_0x394729(0x178)){const _0x2f7591=await staff[_0x394729(0x184)]({'email':_0x1d1704[_0x394729(0x1e9)]});_0x1fc1a4=await warehouse[_0x394729(0x1bc)]({'status':_0x394729(0x1dd),'name':_0x2f7591['warehouse'],'warehouse_category':_0x394729(0x21d)});}else _0x1fc1a4=await warehouse[_0x394729(0x1bc)]({'status':_0x394729(0x1dd),'warehouse_category':'Raw\x20Materials'});const _0x33c580=await warehouse[_0x394729(0x194)]([{'$match':{'name':_0x3f40e0[_0x394729(0x210)]}},{'$unwind':_0x394729(0x1e0)},{'$group':{'_id':_0x394729(0x19d),'name':{'$first':_0x394729(0x1d0)},'product_stock':{'$first':_0x394729(0x211)},'bay':{'$first':_0x394729(0x1f9)},'bin':{'$first':_0x394729(0x138)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x394729(0x19e)},'primary_code':{'$first':_0x394729(0x134)},'secondary_code':{'$first':_0x394729(0x14a)},'product_code':{'$first':_0x394729(0x177)},'storage':{'$first':_0x394729(0x13f)},'rack':{'$first':_0x394729(0x1a7)},'expiry_date':{'$first':_0x394729(0x16a)},'production_date':{'$first':_0x394729(0x214)},'room':{'$first':_0x394729(0x207)}}}]);if(_0x47b9a5[0x0][_0x394729(0x14b)]=='English\x20(US)'){var _0x1253db=users[_0x394729(0x1ba)];console[_0x394729(0x218)](_0x1253db);}else{if(_0x47b9a5[0x0][_0x394729(0x14b)]==_0x394729(0x21b))var _0x1253db=users[_0x394729(0x21b)];else{if(_0x47b9a5[0x0][_0x394729(0x14b)]==_0x394729(0x1d3))var _0x1253db=users[_0x394729(0x1d3)];else{if(_0x47b9a5[0x0][_0x394729(0x14b)]==_0x394729(0x157))var _0x1253db=users[_0x394729(0x157)];else{if(_0x47b9a5[0x0][_0x394729(0x14b)]==_0x394729(0x144))var _0x1253db=users[_0x394729(0x144)];else{if(_0x47b9a5[0x0][_0x394729(0x14b)]=='Portuguese\x20(BR)')var _0x1253db=users[_0x394729(0x1e1)];else{if(_0x47b9a5[0x0]['language']==_0x394729(0x1fe))var _0x1253db=users[_0x394729(0x1fe)];else{if(_0x47b9a5[0x0][_0x394729(0x14b)]=='Arabic\x20(ae)')var _0x1253db=users['Arabic'];}}}}}}}_0x31d426['render'](_0x394729(0x197),{'success':_0x105fb0[_0x394729(0x1cb)]('success'),'errors':_0x105fb0['flash']('errors'),'role':_0x1d1704,'profile':_0x57385d,'master_shop':_0x47b9a5,'warehouse':_0x1fc1a4,'transfer':_0x3f40e0,'stock':_0x33c580,'language':_0x1253db});}catch(_0x1b95b7){console['log'](_0x1b95b7);}}),router[a0_0x58368d(0x183)](a0_0x58368d(0x1c0),auth,async(_0x157f7f,_0xc6a991)=>{var _0x2f7fbb=a0_0x58368d;try{const _0x1a915e=_0x157f7f[_0x2f7fbb(0x1e7)]['id'],{from_warehouse:_0x444636,FromRoom_name:_0x3e45de,to_warehouse:_0x3540e5,ToRoom_name:_0x461fee}=_0x157f7f['body'],_0x2e2e80=await transfers[_0x2f7fbb(0x136)]({'_id':_0x1a915e}),_0x1f0419=_0x2e2e80[_0x2f7fbb(0x133)]['map'](async _0x5a6ec7=>{var _0x2cbd3f=_0x2f7fbb;if(_0x5a6ec7[_0x2cbd3f(0x1a6)]>0x0){var _0xf5e86d=await warehouse[_0x2cbd3f(0x184)]({'name':_0x2e2e80[_0x2cbd3f(0x210)],'room':_0x5a6ec7['from_room_name'],'warehouse_category':_0x2cbd3f(0x21d)});const _0x581f8d=_0xf5e86d[_0x2cbd3f(0x151)][_0x2cbd3f(0x1bb)](_0x389eeb=>{var _0x57802e=_0x2cbd3f;_0x389eeb[_0x57802e(0x1b2)]==_0x5a6ec7['product_name']&&_0x389eeb['floorlevel']==_0x5a6ec7['from_floorlevel']&&_0x389eeb[_0x57802e(0x1da)]==_0x5a6ec7[_0x57802e(0x1b7)]&&_0x389eeb[_0x57802e(0x1a2)]==_0x5a6ec7[_0x57802e(0x219)]&&_0x389eeb[_0x57802e(0x221)]==_0x5a6ec7['from_bay']&&_0x389eeb[_0x57802e(0x20c)]==_0x5a6ec7[_0x57802e(0x135)]&&_0x389eeb['storage']==_0x5a6ec7[_0x57802e(0x13b)]&&_0x389eeb[_0x57802e(0x1e8)]==_0x5a6ec7[_0x57802e(0x1e8)]&&_0x389eeb['batch_code']==_0x5a6ec7[_0x57802e(0x20b)]&&_0x389eeb['production_date']==_0x5a6ec7[_0x57802e(0x150)]&&_0x389eeb[_0x57802e(0x17d)]==_0x5a6ec7[_0x57802e(0x176)]&&_0x389eeb['_id']==_0x5a6ec7[_0x57802e(0x1ef)]&&(_0x389eeb[_0x57802e(0x209)]=_0x389eeb[_0x57802e(0x209)]-_0x5a6ec7[_0x57802e(0x1a6)]);});}return _0xf5e86d;});Promise[_0x2f7fbb(0x20f)](_0x1f0419)[_0x2f7fbb(0x1d7)](async _0x59ab0f=>{var _0x20d5f0=_0x2f7fbb;try{for(const _0x2964dd of _0x59ab0f){await _0x2964dd['save']();}try{const _0x39d650=_0x2e2e80['product']['map'](async _0x419f9f=>{var _0x1f1525=a0_0x1944;if(_0x419f9f['to_quantity']>0x0){var _0x3f2dcc=await warehouse['findOne']({'name':_0x2e2e80['to_warehouse'],'room':_0x419f9f[_0x1f1525(0x1c6)],'warehouse_category':_0x1f1525(0x21d)}),_0x519288=0x0;const _0x39667b=_0x3f2dcc['product_details'][_0x1f1525(0x1bb)](_0x39fe80=>{var _0x3a1c93=_0x1f1525;_0x39fe80[_0x3a1c93(0x1b2)]==_0x419f9f[_0x3a1c93(0x1b2)]&&_0x39fe80[_0x3a1c93(0x13c)]==_0x419f9f['to_floorlevel']&&_0x39fe80[_0x3a1c93(0x1da)]==_0x419f9f[_0x3a1c93(0x162)]&&_0x39fe80[_0x3a1c93(0x1a2)]==_0x419f9f[_0x3a1c93(0x147)]&&_0x39fe80['bay']==_0x419f9f[_0x3a1c93(0x19c)]&&_0x39fe80['rack']==_0x419f9f['rack']&&_0x39fe80[_0x3a1c93(0x16e)]==_0x419f9f[_0x3a1c93(0x16e)]&&_0x39fe80['expiry_date']==_0x419f9f[_0x3a1c93(0x1e8)]&&_0x39fe80['batch_code']==_0x419f9f[_0x3a1c93(0x20b)]&&_0x39fe80[_0x3a1c93(0x150)]==_0x419f9f[_0x3a1c93(0x150)]&&_0x39fe80[_0x3a1c93(0x17d)]==_0x419f9f['To_invoice']&&(_0x39fe80[_0x3a1c93(0x209)]=_0x39fe80[_0x3a1c93(0x209)]+_0x419f9f[_0x3a1c93(0x1a6)],_0x519288++);});_0x519288=='0'&&(_0x3f2dcc['product_details']=_0x3f2dcc[_0x1f1525(0x151)][_0x1f1525(0x1fa)]({'product_name':_0x419f9f[_0x1f1525(0x1b2)],'product_stock':_0x419f9f[_0x1f1525(0x1a6)],'bay':_0x419f9f[_0x1f1525(0x19c)],'bin':_0x419f9f[_0x1f1525(0x147)],'type':_0x419f9f['to_types'],'floorlevel':_0x419f9f[_0x1f1525(0x206)],'storage':_0x419f9f[_0x1f1525(0x16e)],'rack':_0x419f9f[_0x1f1525(0x20c)],'product_code':_0x419f9f[_0x1f1525(0x18a)],'primary_code':_0x419f9f[_0x1f1525(0x149)],'secondary_code':_0x419f9f['secondary_code'],'maxProducts':_0x419f9f[_0x1f1525(0x131)],'storage':_0x419f9f['storage'],'rack':_0x419f9f[_0x1f1525(0x20c)],'expiry_date':_0x419f9f[_0x1f1525(0x1e8)],'maxPerUnit':_0x419f9f[_0x1f1525(0x185)],'batch_code':_0x419f9f[_0x1f1525(0x20b)],'production_date':_0x419f9f[_0x1f1525(0x150)]}));}return _0x3f2dcc;});Promise[_0x20d5f0(0x20f)](_0x39d650)['then'](async _0x2cf59d=>{var _0x6f84db=_0x20d5f0;try{for(const _0xb27963 of _0x2cf59d){await warehouse[_0x6f84db(0x17c)]({'_id':_0xb27963[_0x6f84db(0x1b8)]},{'$addToSet':{'product_details':{'$each':_0xb27963[_0x6f84db(0x151)]}}});}_0x2e2e80[_0x6f84db(0x179)]=_0x6f84db(0x167);const _0xfaba64=await _0x2e2e80[_0x6f84db(0x152)](),_0xbd522a=await master_shop['find'](),_0x945d6a=await email_settings['findOne'](),_0x4062bf=await supervisor_settings['find']();var _0xe6be64=_0x2e2e80[_0x6f84db(0x133)],_0x5f2dc2='',_0x49e7a8;for(_0x49e7a8 in _0xe6be64){_0x5f2dc2+=_0x6f84db(0x130)+_0x6f84db(0x1c9)+_0xe6be64[_0x49e7a8][_0x6f84db(0x1b2)]+'</td>'+_0x6f84db(0x1c9)+_0xe6be64[_0x49e7a8][_0x6f84db(0x18a)]+_0x6f84db(0x224)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xe6be64[_0x49e7a8][_0x6f84db(0x1a6)]+_0x6f84db(0x224)+_0x6f84db(0x1c9)+_0xe6be64[_0x49e7a8][_0x6f84db(0x1d5)]+_0x6f84db(0x224)+_0x6f84db(0x1c9)+_0xe6be64[_0x49e7a8][_0x6f84db(0x14d)]+_0x6f84db(0x224)+_0x6f84db(0x1c9)+_0x2e2e80[_0x6f84db(0x14f)]+_0x6f84db(0x224)+_0x6f84db(0x1c9)+_0xe6be64[_0x49e7a8][_0x6f84db(0x1c6)]+'</td>'+_0x6f84db(0x1c9)+_0xe6be64[_0x49e7a8][_0x6f84db(0x16e)]+_0xe6be64[_0x49e7a8][_0x6f84db(0x20c)]+_0xe6be64[_0x49e7a8]['to_bay']+_0xe6be64[_0x49e7a8][_0x6f84db(0x147)]+_0xe6be64[_0x49e7a8][_0x6f84db(0x162)][0x0]+_0xe6be64[_0x49e7a8][_0x6f84db(0x206)]+_0x6f84db(0x224),_0x6f84db(0x20d);}let _0xb4d3b9=nodemailer[_0x6f84db(0x1c5)]({'host':_0x945d6a['host'],'port':Number(_0x945d6a[_0x6f84db(0x1a1)]),'secure':![],'auth':{'user':_0x945d6a['email'],'pass':_0x945d6a[_0x6f84db(0x156)]}}),_0x14b7f7={'from':_0x945d6a['email'],'to':_0x4062bf[0x0][_0x6f84db(0x13e)],'subject':'Transfer\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x6f84db(0x1aa)+_0x6f84db(0x1d2)+_0xbd522a[0x0][_0x6f84db(0x1b5)],'cid':_0x6f84db(0x161)}],'html':_0x6f84db(0x14e)+_0x6f84db(0x21f)+_0x6f84db(0x137)+_0x6f84db(0x1db)+_0x6f84db(0x153)+_0x6f84db(0x1db)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x6f84db(0x154)+'<div>'+_0x6f84db(0x170)+_0xbd522a[0x0]['site_title']+_0x6f84db(0x15a)+'</div>'+_0x6f84db(0x154)+_0x6f84db(0x1d8)+_0x6f84db(0x1db)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x6f84db(0x227)+_0x2e2e80['invoice']+'\x20'+_0x6f84db(0x20e)+_0x6f84db(0x212)+_0x2e2e80[_0x6f84db(0x1fb)]+'\x20'+_0x6f84db(0x172)+_0x6f84db(0x1d1)+_0x6f84db(0x154)+_0x6f84db(0x1d6)+_0x6f84db(0x159)+'<tr>'+_0x6f84db(0x222)+_0x6f84db(0x18b)+_0x6f84db(0x1d4)+_0x6f84db(0x18e)+_0x6f84db(0x16b)+_0x6f84db(0x19a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x6f84db(0x195)+_0x6f84db(0x20d)+_0x6f84db(0x173)+_0x6f84db(0x18d)+'\x20'+_0x5f2dc2+'\x20'+'</tbody>'+'</table>'+_0x6f84db(0x1db)+_0x6f84db(0x17a)+'<h5>'+_0xbd522a[0x0][_0x6f84db(0x196)]+_0x6f84db(0x1d1)+'</div>'+'</div>'+_0x6f84db(0x1a9)};_0xb4d3b9[_0x6f84db(0x203)](_0x14b7f7,function(_0x476e14,_0x394fa7){var _0x4a9cab=_0x6f84db;_0x476e14?(console[_0x4a9cab(0x218)](_0x476e14),console[_0x4a9cab(0x218)]('Error\x20Occurs')):console[_0x4a9cab(0x218)](_0x4a9cab(0x217));}),_0x157f7f['flash'](_0x6f84db(0x15d),_0x6f84db(0x146)),_0xc6a991[_0x6f84db(0x17e)](_0x6f84db(0x1bd)+_0xfaba64[_0x6f84db(0x1b8)]);}catch(_0x4e59e6){console[_0x6f84db(0x200)](_0x4e59e6),_0xc6a991[_0x6f84db(0x1bf)](0x1f4)[_0x6f84db(0x208)]({'Perror':_0x6f84db(0x168),'message':_0x4e59e6['message']});}})[_0x20d5f0(0x1e4)](_0x3d9c3a=>{var _0x10c3ad=_0x20d5f0;console[_0x10c3ad(0x200)](_0x3d9c3a),_0xc6a991[_0x10c3ad(0x1bf)](0x1f4)[_0x10c3ad(0x208)]({'Perror':_0x10c3ad(0x226)});});}catch(_0x5eea46){_0xc6a991[_0x20d5f0(0x208)](_0x5eea46);}}catch(_0x23b4c2){console[_0x20d5f0(0x200)](_0x23b4c2),_0xc6a991['status'](0x1f4)['json']({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x23b4c2[_0x20d5f0(0x1f6)]});}})[_0x2f7fbb(0x1e4)](_0x53edae=>{var _0x58e32a=_0x2f7fbb;console[_0x58e32a(0x200)](_0x53edae),_0xc6a991[_0x58e32a(0x1bf)](0x1f4)[_0x58e32a(0x208)]({'Merror':_0x58e32a(0x226)});});}catch(_0x3778e2){console[_0x2f7fbb(0x218)](_0x3778e2);}});function BayBinSelected(_0x279c98,_0x3658a4){var _0xa4a14b=a0_0x58368d,_0x47a3d7=[],_0x453ddb=[],_0x2273b2=[],_0x5e0b28=[],_0xce8d04=[],_0x489d81=[];let _0x22131b=[];if(_0x279c98=='DRY\x20STORAGE')switch(_0x3658a4){case _0xa4a14b(0x216):_0x47a3d7=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x453ddb=[0x1,0x2],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=[_0xa4a14b(0x142),'Floor'],_0xce8d04=['D'],_0x489d81=['A'];break;case _0xa4a14b(0x189):_0x47a3d7=[0x6,0x5,0x4,0x3,0x2,0x1],_0x453ddb=[0x1,0x2],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=[_0xa4a14b(0x142),'Floor'],_0xce8d04=['D'],_0x489d81=['B'];break;case'Shelves':_0x47a3d7=[0x0],_0x453ddb=[0x0],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=['Floor'],_0xce8d04=['D'],_0x489d81=['S'];break;case _0xa4a14b(0x1b3):_0x47a3d7=[0x0],_0x453ddb=[0x0],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x2273b2=[_0xa4a14b(0x1ce)],_0xce8d04=['D'],_0x489d81=['R'];break;}else{if(_0x279c98==_0xa4a14b(0x1f4))switch(_0x3658a4){case _0xa4a14b(0x216):_0x47a3d7=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x453ddb=['B','F'],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=[_0xa4a14b(0x142),_0xa4a14b(0x1ce)],_0xce8d04=['C'],_0x489d81=['A'];break;case'Rack\x20B':_0x47a3d7=[0x5,0x4,0x3,0x2,0x1],_0x453ddb=['F','B','S'],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=[_0xa4a14b(0x142),_0xa4a14b(0x1ce)],_0xce8d04=['C'],_0x489d81=['B'];break;case'Rack\x20C':_0x47a3d7=[0x1,0x2,0x3,0x4,0x5],_0x453ddb=['B','F','S'],_0x5e0b28=[0x5,0x4,0x3,0x2,0x1],_0x2273b2=['Level','Floor'],_0xce8d04=['C'],_0x489d81=['C'];break;case _0xa4a14b(0x1cf):_0x47a3d7=[0x5,0x4,0x3,0x2,0x1],_0x453ddb=['F','B','S'],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=[_0xa4a14b(0x142),_0xa4a14b(0x1ce)],_0xce8d04=['C'],_0x489d81=['D'];break;case _0xa4a14b(0x201):_0x47a3d7=[0x4,0x3,0x2,0x1],_0x453ddb=[0x1,0x2],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=['Level',_0xa4a14b(0x1ce)],_0xce8d04=['C'],_0x489d81=['E'];break;case _0xa4a14b(0x1e5):_0x47a3d7=[0x1,0x2,0x3],_0x453ddb=[0x1,0x2],_0x5e0b28=[0x1,0x2,0x3,0x4,0x5],_0x2273b2=[_0xa4a14b(0x142)],_0xce8d04=['C'],_0x489d81=['F'];break;}}return{'levels':_0x47a3d7,'Isle':_0x453ddb,'rack':_0x5e0b28,'type':_0x2273b2,'storage':_0xce8d04,'rak':_0x489d81};}router[a0_0x58368d(0x143)](a0_0x58368d(0x215),auth,async(_0x43c66f,_0xfa0385)=>{var _0x377ecc=a0_0x58368d;try{const {username:_0x527ba2,email:_0x27fe37,role:_0x5173b2}=_0x43c66f['user'],_0xab3386=_0x43c66f[_0x377ecc(0x15c)],_0x2d12db=await profile[_0x377ecc(0x184)]({'email':_0xab3386[_0x377ecc(0x1e9)]}),_0x44984=await master_shop['find'](),_0x28a179=await transfers['findById'](_0x43c66f[_0x377ecc(0x1e7)]['id']);let _0x92f0e8;if(_0xab3386[_0x377ecc(0x1d9)]==_0x377ecc(0x178)){const _0x1927e4=await staff['findOne']({'email':_0xab3386[_0x377ecc(0x1e9)]});_0x92f0e8=await warehouse[_0x377ecc(0x194)]([{'$match':{'status':_0x377ecc(0x1dd),'name':_0x1927e4['warehouse'],'warehouse_category':_0x377ecc(0x21d)}},{'$group':{'_id':_0x377ecc(0x19f),'name':{'$first':_0x377ecc(0x19f)}}}]);}else _0x92f0e8=await warehouse[_0x377ecc(0x194)]([{'$match':{'status':_0x377ecc(0x1dd),'warehouse_category':_0x377ecc(0x21d)}},{'$group':{'_id':_0x377ecc(0x19f),'name':{'$first':_0x377ecc(0x19f)}}}]);const _0x477485=await warehouse[_0x377ecc(0x194)]([{'$match':{'name':_0x28a179[_0x377ecc(0x210)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x377ecc(0x1e0)},{'$group':{'_id':_0x377ecc(0x19d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x377ecc(0x211)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x377ecc(0x138)},'type':{'$first':_0x377ecc(0x1f3)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x377ecc(0x177)},'storage':{'$first':_0x377ecc(0x13f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x377ecc(0x16a)},'production_date':{'$first':_0x377ecc(0x214)},'room':{'$first':_0x377ecc(0x207)}}}]),_0x2a0bf6=await product[_0x377ecc(0x1bc)]({}),_0xe41337=BayBinSelected(_0x28a179[_0x377ecc(0x14f)],_0x28a179['to_room']);if(_0x44984[0x0][_0x377ecc(0x14b)]==_0x377ecc(0x182)){var _0x1aadba=users[_0x377ecc(0x1ba)];console[_0x377ecc(0x218)](_0x1aadba);}else{if(_0x44984[0x0][_0x377ecc(0x14b)]=='Hindi')var _0x1aadba=users[_0x377ecc(0x21b)];else{if(_0x44984[0x0][_0x377ecc(0x14b)]=='German')var _0x1aadba=users['German'];else{if(_0x44984[0x0]['language']=='Spanish')var _0x1aadba=users[_0x377ecc(0x157)];else{if(_0x44984[0x0]['language']==_0x377ecc(0x144))var _0x1aadba=users[_0x377ecc(0x144)];else{if(_0x44984[0x0][_0x377ecc(0x14b)]==_0x377ecc(0x1a0))var _0x1aadba=users['Portuguese'];else{if(_0x44984[0x0][_0x377ecc(0x14b)]==_0x377ecc(0x1fe))var _0x1aadba=users[_0x377ecc(0x1fe)];else{if(_0x44984[0x0]['language']==_0x377ecc(0x1f0))var _0x1aadba=users[_0x377ecc(0x1c3)];}}}}}}}_0xfa0385[_0x377ecc(0x1fd)]('edit_transfer',{'success':_0x43c66f[_0x377ecc(0x1cb)](_0x377ecc(0x15d)),'errors':_0x43c66f[_0x377ecc(0x1cb)]('errors'),'role':_0xab3386,'profile':_0x2d12db,'master_shop':_0x44984,'warehouse':_0x92f0e8,'transfer':_0x28a179,'stock':_0x477485,'unit':_0x2a0bf6,'language':_0x1aadba});}catch(_0x46c6d5){console[_0x377ecc(0x218)](_0x46c6d5);}}),router[a0_0x58368d(0x183)]('/view/:id',auth,async(_0x263e70,_0x3217a1)=>{var _0x449a7a=a0_0x58368d;try{const _0x33c2c9=_0x263e70[_0x449a7a(0x1e7)]['id'],_0xa49b3e=await transfers['findById'](_0x33c2c9);_0x3217a1[_0x449a7a(0x208)](_0x263e70[_0x449a7a(0x171)]);return;const {date:_0x4a2a7a,from_warehouse:_0x8cfedb,FromRoom_name:_0x593a92,to_warehouse:_0x2119cf,ToRoom_name:_0x1a3980,prod_name:_0x537989,from_prod_qty:_0x5e146e,from_prod_level:_0x51e175,from_prod_isle:_0x221672,from_prod_pallet:_0x1c2ab7,to_prod_qty:_0x40b22e,to_prod_level:_0x3e8b6e,to_prod_isle:_0x1c1a87,to_prod_pallet:_0x5b2311,primary_code:_0x19069b,secondary_code:_0x234771,product_code3:_0x5414ea,note:_0x3f2dd2,invoice:_0x575e95,expiry_date:_0x5d010d}=_0x263e70[_0x449a7a(0x171)];if(typeof _0x537989=='string')var _0x15b2ff=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1ab)]],_0x353521=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1de)]],_0x3f1c97=[_0x263e70[_0x449a7a(0x171)]['from_prod_level']],_0x1cb6b3=[_0x263e70['body'][_0x449a7a(0x223)]],_0x177bf8=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1cc)]],_0x18732f=[_0x263e70['body'][_0x449a7a(0x1b7)]],_0x3f4f8d=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x163)]],_0x33212a=[_0x263e70['body'][_0x449a7a(0x1ca)]],_0x1e4b70=[_0x263e70['body'][_0x449a7a(0x187)]],_0x37112d=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1dc)]],_0x1cfea7=[_0x263e70['body'][_0x449a7a(0x162)]],_0x9ccbf8=[_0x263e70[_0x449a7a(0x171)]['storage']],_0x119ce0=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x174)]],_0xd1d4bd=[_0x263e70['body'][_0x449a7a(0x149)]],_0x289c46=[_0x263e70[_0x449a7a(0x171)]['secondary_code']],_0x43b44f=[_0x263e70['body'][_0x449a7a(0x1c8)]],_0x1163b8=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1b9)]],_0x5e8537=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1d5)]],_0x16bf58=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x14d)]],_0x20e993=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x20b)]],_0x2412c3=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1e8)]],_0x4fed83=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x13b)]],_0xd68eba=[_0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1f2)]];else var _0x15b2ff=[..._0x263e70[_0x449a7a(0x171)]['prod_name']],_0x9ccbf8=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x16e)]],_0x119ce0=[..._0x263e70['body'][_0x449a7a(0x174)]],_0x18732f=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1b7)]],_0x1cfea7=[..._0x263e70[_0x449a7a(0x171)]['to_types']],_0x353521=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1de)]],_0x3f1c97=[..._0x263e70['body'][_0x449a7a(0x204)]],_0x1cb6b3=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x223)]],_0x177bf8=[..._0x263e70['body']['from_prod_pallet']],_0x3f4f8d=[..._0x263e70[_0x449a7a(0x171)]['to_prod_qty']],_0x33212a=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1ca)]],_0x1e4b70=[..._0x263e70[_0x449a7a(0x171)]['to_prod_isle']],_0x37112d=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1dc)]],_0xd1d4bd=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x149)]],_0x289c46=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x20a)]],_0x43b44f=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1c8)]],_0x1163b8=[..._0x263e70[_0x449a7a(0x171)]['MaxStocks_data2']],_0x5e8537=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x1d5)]],_0x16bf58=[..._0x263e70['body'][_0x449a7a(0x14d)]],_0x20e993=[..._0x263e70[_0x449a7a(0x171)][_0x449a7a(0x20b)]],_0x2412c3=[..._0x263e70[_0x449a7a(0x171)]['expiry_date']],_0x4fed83=[..._0x263e70['body']['from_storage']],_0xd68eba=[..._0x263e70[_0x449a7a(0x171)]['from_rak']];const _0x57eb43=_0x15b2ff[_0x449a7a(0x1bb)](_0x490506=>{return _0x490506={'product_name':_0x490506};});_0x353521[_0x449a7a(0x188)]((_0x45dd4a,_0x273e6c)=>{var _0x4c253e=_0x449a7a;_0x57eb43[_0x273e6c][_0x4c253e(0x1b4)]=_0x45dd4a;}),_0x3f1c97[_0x449a7a(0x188)]((_0x4428d3,_0xa9b948)=>{var _0x3c759a=_0x449a7a;_0x57eb43[_0xa9b948][_0x3c759a(0x132)]=_0x4428d3;}),_0x1cb6b3[_0x449a7a(0x188)]((_0x533a5e,_0x2ee426)=>{var _0x108e99=_0x449a7a;_0x57eb43[_0x2ee426][_0x108e99(0x219)]=_0x533a5e;}),_0x177bf8['forEach']((_0x223b9f,_0x52b080)=>{_0x57eb43[_0x52b080]['from_floorlevel']=_0x223b9f;}),_0x3f4f8d['forEach']((_0x87a07a,_0x541270)=>{var _0xaa97a2=_0x449a7a;_0x57eb43[_0x541270][_0xaa97a2(0x1a6)]=_0x87a07a;}),_0x33212a[_0x449a7a(0x188)]((_0x3d2a36,_0x31875e)=>{var _0x3ab020=_0x449a7a;_0x57eb43[_0x31875e][_0x3ab020(0x19c)]=_0x3d2a36;}),_0x1e4b70[_0x449a7a(0x188)]((_0x55e1cf,_0x117603)=>{var _0x10fd3b=_0x449a7a;_0x57eb43[_0x117603][_0x10fd3b(0x147)]=_0x55e1cf;}),_0x37112d[_0x449a7a(0x188)]((_0x41a8d7,_0x4333e2)=>{_0x57eb43[_0x4333e2]['to_floorlevel']=_0x41a8d7;}),_0xd1d4bd[_0x449a7a(0x188)]((_0x62bba8,_0x47146a)=>{var _0x34ce15=_0x449a7a;_0x57eb43[_0x47146a][_0x34ce15(0x149)]=_0x62bba8;}),_0x289c46['forEach']((_0x4d2377,_0x558292)=>{var _0x4e1ab4=_0x449a7a;_0x57eb43[_0x558292][_0x4e1ab4(0x20a)]=_0x4d2377;}),_0x43b44f[_0x449a7a(0x188)]((_0x4e18e8,_0x339337)=>{var _0x5aef63=_0x449a7a;_0x57eb43[_0x339337][_0x5aef63(0x18a)]=_0x4e18e8;}),_0x1163b8[_0x449a7a(0x188)]((_0x560bda,_0x11337e)=>{var _0x13d0d9=_0x449a7a;_0x57eb43[_0x11337e][_0x13d0d9(0x131)]=_0x560bda;}),_0x5e8537[_0x449a7a(0x188)]((_0x20e556,_0x5481c6)=>{_0x57eb43[_0x5481c6]['unit']=_0x20e556;}),_0x16bf58[_0x449a7a(0x188)]((_0x2ac290,_0x497f66)=>{_0x57eb43[_0x497f66]['secondary_unit']=_0x2ac290;}),_0x20e993['forEach']((_0x29cfd2,_0x4c408f)=>{var _0xa4c4a=_0x449a7a;_0x57eb43[_0x4c408f][_0xa4c4a(0x20b)]=_0x29cfd2;}),_0x2412c3['forEach']((_0x737394,_0x55d789)=>{var _0x3cc141=_0x449a7a;_0x57eb43[_0x55d789][_0x3cc141(0x1e8)]=_0x737394;}),_0x9ccbf8[_0x449a7a(0x188)]((_0x563775,_0xcb16ee)=>{var _0x5dba62=_0x449a7a;_0x57eb43[_0xcb16ee][_0x5dba62(0x16e)]=_0x563775;}),_0x119ce0[_0x449a7a(0x188)]((_0xfcb3d1,_0x2e8803)=>{var _0x30e906=_0x449a7a;_0x57eb43[_0x2e8803][_0x30e906(0x20c)]=_0xfcb3d1;}),_0x18732f[_0x449a7a(0x188)]((_0x7c2f77,_0x55c1fd)=>{var _0xdeb554=_0x449a7a;_0x57eb43[_0x55c1fd][_0xdeb554(0x1b7)]=_0x7c2f77;}),_0x1cfea7[_0x449a7a(0x188)]((_0xcf21e1,_0x21d6a6)=>{var _0x5c8340=_0x449a7a;_0x57eb43[_0x21d6a6][_0x5c8340(0x162)]=_0xcf21e1;}),_0x4fed83['forEach']((_0x2542e4,_0x5eedb0)=>{var _0x2345a2=_0x449a7a;_0x57eb43[_0x5eedb0][_0x2345a2(0x13b)]=_0x2542e4;}),_0xd68eba['forEach']((_0x395c31,_0x26a961)=>{_0x57eb43[_0x26a961]['from_rack']=_0x395c31;});const _0x5de3e4=_0x57eb43[_0x449a7a(0x199)](_0x293d65=>_0x293d65[_0x449a7a(0x1a6)]!=='0'&&_0x293d65['to_quantity']!==''||_0x293d65[_0x449a7a(0x206)]!=='0'&&_0x293d65[_0x449a7a(0x206)]!=='');var _0x4c5f32=0x0;_0x5de3e4[_0x449a7a(0x188)](_0x37de4e=>{parseInt(_0x37de4e['from_quantity'])<parseInt(_0x37de4e['to_quantity'])&&_0x4c5f32++;});if(_0x4c5f32!=0x0)return _0x263e70[_0x449a7a(0x1cb)](_0x449a7a(0x1c4),_0x449a7a(0x1f1)),_0x3217a1[_0x449a7a(0x17e)](_0x449a7a(0x1e3));const _0x5118d2=await warehouse[_0x449a7a(0x184)]({'name':_0xa49b3e[_0x449a7a(0x210)],'room':_0xa49b3e[_0x449a7a(0x166)]});_0xa49b3e[_0x449a7a(0x133)][_0x449a7a(0x188)](_0x5f2ac9=>{var _0x2faff9=_0x449a7a;if(_0x5f2ac9['to_quantity']>0x0){const _0x277c26=_0x5118d2[_0x2faff9(0x151)][_0x2faff9(0x1bb)](_0x415ccb=>{var _0x1a40ec=_0x2faff9;_0x415ccb[_0x1a40ec(0x1b2)]==_0x5f2ac9[_0x1a40ec(0x1b2)]&&_0x415ccb['floorlevel']==_0x5f2ac9[_0x1a40ec(0x1eb)]&&_0x415ccb[_0x1a40ec(0x1da)]==_0x5f2ac9['from_types']&&_0x415ccb['bin']==_0x5f2ac9[_0x1a40ec(0x219)]&&_0x415ccb[_0x1a40ec(0x221)]==_0x5f2ac9['from_bay']&&_0x415ccb[_0x1a40ec(0x20c)]==_0x5f2ac9[_0x1a40ec(0x135)]&&_0x415ccb[_0x1a40ec(0x16e)]==_0x5f2ac9[_0x1a40ec(0x13b)]&&(_0x415ccb[_0x1a40ec(0x209)]=parseInt(_0x415ccb[_0x1a40ec(0x209)])+parseInt(_0x5f2ac9[_0x1a40ec(0x1a6)]));});}}),await _0x5118d2[_0x449a7a(0x152)]();const _0x4853d8=await warehouse['findOne']({'name':_0xa49b3e[_0x449a7a(0x14f)],'room':_0xa49b3e[_0x449a7a(0x1ed)]});_0xa49b3e[_0x449a7a(0x133)][_0x449a7a(0x188)](_0x4b5007=>{var _0x483ce5=_0x449a7a;if(_0x4b5007[_0x483ce5(0x1a6)]>0x0){const _0x3e54d4=_0x4853d8[_0x483ce5(0x151)][_0x483ce5(0x1bb)](_0x5b3f99=>{var _0xbbadaa=_0x483ce5;_0x5b3f99[_0xbbadaa(0x1b2)]==_0x4b5007[_0xbbadaa(0x1b2)]&&_0x5b3f99[_0xbbadaa(0x13c)]==_0x4b5007[_0xbbadaa(0x206)]&&_0x5b3f99[_0xbbadaa(0x1da)]==_0x4b5007[_0xbbadaa(0x162)]&&_0x5b3f99[_0xbbadaa(0x1a2)]==_0x4b5007[_0xbbadaa(0x147)]&&_0x5b3f99[_0xbbadaa(0x221)]==_0x4b5007['to_bay']&&_0x5b3f99[_0xbbadaa(0x20c)]==_0x4b5007['rack']&&_0x5b3f99['storage']==_0x4b5007[_0xbbadaa(0x16e)]&&(_0x5b3f99[_0xbbadaa(0x209)]=parseInt(_0x5b3f99[_0xbbadaa(0x209)])-parseInt(_0x4b5007[_0xbbadaa(0x1a6)]));});}}),await _0x4853d8[_0x449a7a(0x152)](),_0xa49b3e[_0x449a7a(0x1fb)]=_0x4a2a7a,_0xa49b3e[_0x449a7a(0x210)]=_0x8cfedb,_0xa49b3e['to_warehouse']=_0x2119cf,_0xa49b3e['product']=_0x5de3e4,_0xa49b3e[_0x449a7a(0x198)]=_0x3f2dd2,_0xa49b3e['invoice']=_0x575e95;const _0x27c3f3=await _0xa49b3e[_0x449a7a(0x152)]();console[_0x449a7a(0x218)](_0x27c3f3);const _0x30af58=await warehouse[_0x449a7a(0x184)]({'name':_0x8cfedb,'room':_0x593a92});_0x27c3f3[_0x449a7a(0x133)][_0x449a7a(0x188)](_0x15eba6=>{if(_0x15eba6['to_quantity']>0x0){const _0x4008d9=_0x30af58['product_details']['map'](_0x5934b3=>{var _0x436564=a0_0x1944;_0x5934b3[_0x436564(0x1b2)]==_0x15eba6['product_name']&&_0x5934b3[_0x436564(0x13c)]==_0x15eba6[_0x436564(0x1eb)]&&_0x5934b3[_0x436564(0x1da)]==_0x15eba6[_0x436564(0x1b7)]&&_0x5934b3[_0x436564(0x1a2)]==_0x15eba6[_0x436564(0x219)]&&_0x5934b3[_0x436564(0x221)]==_0x15eba6[_0x436564(0x132)]&&_0x5934b3['rack']==_0x15eba6['from_rack']&&_0x5934b3[_0x436564(0x16e)]==_0x15eba6['from_storage']&&(_0x5934b3[_0x436564(0x209)]=parseInt(_0x5934b3['product_stock'])-parseInt(_0x15eba6[_0x436564(0x1a6)]));});}}),await _0x30af58[_0x449a7a(0x152)]();const _0x1d43de=await warehouse[_0x449a7a(0x184)]({'name':_0x2119cf,'room':_0x1a3980});_0x27c3f3[_0x449a7a(0x133)]['forEach'](_0x52a157=>{var _0x50dbb6=_0x449a7a;if(_0x52a157[_0x50dbb6(0x1a6)]>0x0){var _0x4366a9=0x0;const _0x31747c=_0x1d43de['product_details'][_0x50dbb6(0x1bb)](_0x1f29e4=>{var _0x3b4e99=_0x50dbb6;_0x1f29e4[_0x3b4e99(0x1b2)]==_0x52a157[_0x3b4e99(0x1b2)]&&_0x1f29e4[_0x3b4e99(0x13c)]==_0x52a157['to_floorlevel']&&_0x1f29e4[_0x3b4e99(0x1da)]==_0x52a157[_0x3b4e99(0x162)]&&_0x1f29e4['bin']==_0x52a157[_0x3b4e99(0x147)]&&_0x1f29e4[_0x3b4e99(0x221)]==_0x52a157[_0x3b4e99(0x19c)]&&_0x1f29e4[_0x3b4e99(0x20c)]==_0x52a157[_0x3b4e99(0x20c)]&&_0x1f29e4[_0x3b4e99(0x16e)]==_0x52a157[_0x3b4e99(0x16e)]&&(_0x1f29e4['product_stock']=parseInt(_0x1f29e4['product_stock'])+parseInt(_0x52a157[_0x3b4e99(0x1a6)]),_0x4366a9++);});_0x4366a9=='0'&&(_0x1d43de[_0x50dbb6(0x151)]=_0x1d43de[_0x50dbb6(0x151)][_0x50dbb6(0x1fa)]({'product_name':_0x52a157[_0x50dbb6(0x1b2)],'product_stock':_0x52a157[_0x50dbb6(0x1a6)],'bay':_0x52a157[_0x50dbb6(0x19c)],'bin':_0x52a157[_0x50dbb6(0x147)],'type':_0x52a157[_0x50dbb6(0x162)],'floorlevel':_0x52a157[_0x50dbb6(0x206)],'storage':_0x52a157['storage'],'rack':_0x52a157[_0x50dbb6(0x20c)],'product_code':_0x52a157[_0x50dbb6(0x18a)],'primary_code':_0x52a157[_0x50dbb6(0x149)],'secondary_code':_0x52a157['secondary_code'],'maxProducts':_0x52a157['maxProducts'],'storage':_0x52a157[_0x50dbb6(0x16e)],'rack':_0x52a157[_0x50dbb6(0x20c)]}));}}),await _0x1d43de[_0x449a7a(0x152)](),_0x263e70[_0x449a7a(0x1cb)]('success',_0x449a7a(0x202)),_0x3217a1['redirect'](_0x449a7a(0x1c2));}catch(_0x5e73c0){console[_0x449a7a(0x218)](_0x5e73c0);}}),router[a0_0x58368d(0x183)]('/barcode_scanner',async(_0x53333b,_0x248ff5)=>{var _0x3fdae3=a0_0x58368d;const {FromWareHouse:_0x4dbee6,FromRoom:_0x224ee6,ToWarehouse:_0x421a78,ToRoom:_0x3d3dfa,primary_code:_0x35a247,Roomslist:_0x1c0e72}=_0x53333b[_0x3fdae3(0x171)],_0x129ef9=_0x1c0e72[_0x3fdae3(0x1e6)](','),_0x433544=[];async function _0x332758(_0x281daf){var _0x51d4e6=_0x3fdae3;const _0x82cc52=await warehouse[_0x51d4e6(0x194)]([{'$match':{'name':_0x4dbee6,'room':_0x281daf}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x35a247}},{'$group':{'_id':_0x51d4e6(0x19d),'name':{'$first':_0x51d4e6(0x1d0)},'instock':{'$first':_0x51d4e6(0x211)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x51d4e6(0x177)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x51d4e6(0x138)},'type':{'$first':_0x51d4e6(0x1f3)},'pallet':{'$first':_0x51d4e6(0x19e)},'unit':{'$first':_0x51d4e6(0x148)},'secondary_unit':{'$first':_0x51d4e6(0x17b)},'storage':{'$first':_0x51d4e6(0x13f)},'rack':{'$first':_0x51d4e6(0x1a7)},'expiry_date':{'$first':_0x51d4e6(0x16a)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x51d4e6(0x1a8)},'maxPerUnit':{'$first':_0x51d4e6(0x140)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x51d4e6(0x207)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x51d4e6(0x1c7)}}}]),_0x2e7635=await warehouse[_0x51d4e6(0x194)]([{'$match':{'name':_0x4dbee6,'room':_0x281daf}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x35a247}},{'$group':{'_id':_0x51d4e6(0x19d),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x51d4e6(0x211)},'primary_code':{'$first':_0x51d4e6(0x134)},'secondary_code':{'$first':_0x51d4e6(0x14a)},'product_code':{'$first':_0x51d4e6(0x177)},'level':{'$first':_0x51d4e6(0x1f9)},'isle':{'$first':_0x51d4e6(0x138)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x51d4e6(0x19e)},'unit':{'$first':_0x51d4e6(0x148)},'secondary_unit':{'$first':_0x51d4e6(0x17b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x51d4e6(0x1a7)},'expiry_date':{'$first':_0x51d4e6(0x16a)},'production_date':{'$first':_0x51d4e6(0x214)},'batch_code':{'$first':_0x51d4e6(0x1a8)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x51d4e6(0x207)},'maxProducts':{'$first':_0x51d4e6(0x1b0)},'invoice_product':{'$first':_0x51d4e6(0x1c7)}}}]);if(_0x82cc52[_0x51d4e6(0x1a3)]>0x0)_0x433544[_0x51d4e6(0x1ff)](_0x82cc52);else _0x2e7635[_0x51d4e6(0x1a3)]>0x0&&_0x433544[_0x51d4e6(0x1ff)](_0x2e7635);}const _0x4e8a41=_0x129ef9[_0x3fdae3(0x1bb)](_0x5b900b=>_0x332758(_0x5b900b));await Promise[_0x3fdae3(0x20f)](_0x4e8a41),_0x248ff5[_0x3fdae3(0x208)](_0x433544);}),router[a0_0x58368d(0x183)](a0_0x58368d(0x1ae),async(_0x59e8b0,_0x4ad2e8)=>{var _0x4f2cd4=a0_0x58368d;try{const {FromWareHouse:_0x33d086,FromRoom:_0x4fa5c9,ToWarehouse:_0x47f818,ToRoom:_0x3c3b11,secondary_code:_0x3b9697}=_0x59e8b0[_0x4f2cd4(0x171)],_0x4fc849=await warehouse[_0x4f2cd4(0x194)]([{'$match':{'name':_0x33d086}},{'$unwind':_0x4f2cd4(0x1e0)},{'$match':{'product_details.secondary_code':_0x3b9697}},{'$group':{'_id':_0x4f2cd4(0x19d),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4f2cd4(0x177)},'instock':{'$first':_0x4f2cd4(0x211)},'warehouse':{'$first':_0x4f2cd4(0x19f)},'level':{'$first':_0x4f2cd4(0x14c)},'isle':{'$first':_0x4f2cd4(0x1ac)},'pallet':{'$first':_0x4f2cd4(0x12f)},'maxProducts':{'$first':_0x4f2cd4(0x1b0)},'unit':{'$first':_0x4f2cd4(0x148)}}}]);_0x4ad2e8['status'](0xc8)[_0x4f2cd4(0x208)](_0x4fc849);}catch(_0x49a3cd){_0x4ad2e8[_0x4f2cd4(0x1bf)](0x194)[_0x4f2cd4(0x208)]({'message':_0x49a3cd[_0x4f2cd4(0x1f6)]});}}),router['post'](a0_0x58368d(0x1e2),async(_0x24507c,_0x1fcf04)=>{var _0x3ddcd7=a0_0x58368d;try{const {FromWareHouse:_0x190e9e,FromRoom:_0xeee145,ToWarehouse:_0x274a4a,ToRoom:_0x1b6b7e,product_code:_0x83aaaf}=_0x24507c[_0x3ddcd7(0x171)],_0x179e05=await warehouse[_0x3ddcd7(0x194)]([{'$match':{'name':_0x190e9e}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x83aaaf}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3ddcd7(0x1d0)},'primary_code':{'$first':_0x3ddcd7(0x134)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x3ddcd7(0x211)},'warehouse':{'$first':_0x3ddcd7(0x19f)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3ddcd7(0x1ac)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x3ddcd7(0x1b0)},'unit':{'$first':'$product_details.unit'}}}]);_0x1fcf04[_0x3ddcd7(0x1bf)](0xc8)[_0x3ddcd7(0x208)](_0x179e05);}catch(_0x6f3224){_0x1fcf04['status'](0x194)[_0x3ddcd7(0x208)]({'message':_0x6f3224[_0x3ddcd7(0x1f6)]});}}),router['post'](a0_0x58368d(0x175),async(_0x5ec1b1,_0x50333a)=>{var _0x3f62d4=a0_0x58368d;const {level:_0x37dd0b,isle:_0xc1565d,pallet:_0x23bdf7,warehouses:_0x4e21fc,room:_0x4a7a6a}=_0x5ec1b1[_0x3f62d4(0x171)];try{const _0x1f4d1f=await warehouse['aggregate']([{'$match':{'name':_0x4e21fc,'room':_0x4a7a6a}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x37dd0b),'product_details.isle':_0xc1565d,'product_details.pallet':parseInt(_0x23bdf7)}},{'$group':{'_id':_0x3f62d4(0x19d),'name':{'$first':_0x3f62d4(0x1d0)},'product_stock':{'$first':_0x3f62d4(0x211)},'level':{'$first':_0x3f62d4(0x14c)},'isle':{'$first':_0x3f62d4(0x1ac)},'pallet':{'$first':_0x3f62d4(0x12f)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x50333a[_0x3f62d4(0x1bf)](0xc8)[_0x3f62d4(0x208)](_0x1f4d1f);}catch(_0x8077fb){_0x50333a['status'](0x194)[_0x3f62d4(0x208)]({'message':_0x8077fb[_0x3f62d4(0x1f6)]});}}),module[a0_0x58368d(0x228)]=router;