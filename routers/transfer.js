var a0_0xce18d3=a0_0x5ed2;(function(_0x346234,_0x1af8bc){var _0x943621=a0_0x5ed2,_0x675d29=_0x346234();while(!![]){try{var _0x370e4b=parseInt(_0x943621(0x1e6))/0x1*(parseInt(_0x943621(0x1f1))/0x2)+-parseInt(_0x943621(0x20b))/0x3+parseInt(_0x943621(0x239))/0x4*(-parseInt(_0x943621(0x255))/0x5)+-parseInt(_0x943621(0x1ac))/0x6+parseInt(_0x943621(0x1bf))/0x7+parseInt(_0x943621(0x1ba))/0x8+parseInt(_0x943621(0x229))/0x9;if(_0x370e4b===_0x1af8bc)break;else _0x675d29['push'](_0x675d29['shift']());}catch(_0x14cbcd){_0x675d29['push'](_0x675d29['shift']());}}}(a0_0x4d19,0x31d56));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0xce18d3(0x222)),auth=require(a0_0xce18d3(0x184)),users=require('../public/language/languages.json'),nodemailer=require(a0_0xce18d3(0x1c0));router['get'](a0_0xce18d3(0x1e2),auth,async(_0x55f47a,_0x41467b)=>{var _0x6ff4da=a0_0xce18d3;try{const {username:_0x2c3394,email:_0x20fc6a,role:_0x3e92d6}=_0x55f47a[_0x6ff4da(0x1e7)],_0x4354b4=_0x55f47a[_0x6ff4da(0x1e7)],_0x6a917e=await profile[_0x6ff4da(0x1b3)]({'email':_0x4354b4['email']}),_0xdc3b8b=await master_shop[_0x6ff4da(0x248)]();console[_0x6ff4da(0x22e)]('master',_0xdc3b8b);let _0x50f5f0;if(_0x4354b4[_0x6ff4da(0x23d)]==_0x6ff4da(0x1ea)){const _0x2e07d2=await staff[_0x6ff4da(0x1b3)]({'email':_0x4354b4[_0x6ff4da(0x250)]});_0x50f5f0=await transfers[_0x6ff4da(0x248)]({'from_warehouse':_0x2e07d2['warehouse']});}else _0x50f5f0=await transfers[_0x6ff4da(0x247)]([{'$unwind':'$product'},{'$group':{'_id':_0x6ff4da(0x1ce),'invoice':{'$first':'$invoice'},'date':{'$first':_0x6ff4da(0x204)},'from_warehouse':{'$first':_0x6ff4da(0x22b)},'to_warehouse':{'$first':_0x6ff4da(0x22f)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x6ff4da(0x258)},'finalize':{'$first':_0x6ff4da(0x25f)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xdc3b8b[0x0][_0x6ff4da(0x1d0)]==_0x6ff4da(0x223)){var _0x3ab8fb=users[_0x6ff4da(0x1e0)];console[_0x6ff4da(0x22e)](_0x3ab8fb);}else{if(_0xdc3b8b[0x0]['language']==_0x6ff4da(0x1dd))var _0x3ab8fb=users[_0x6ff4da(0x1dd)];else{if(_0xdc3b8b[0x0]['language']==_0x6ff4da(0x185))var _0x3ab8fb=users[_0x6ff4da(0x185)];else{if(_0xdc3b8b[0x0][_0x6ff4da(0x1d0)]==_0x6ff4da(0x20c))var _0x3ab8fb=users[_0x6ff4da(0x20c)];else{if(_0xdc3b8b[0x0][_0x6ff4da(0x1d0)]==_0x6ff4da(0x1ae))var _0x3ab8fb=users[_0x6ff4da(0x1ae)];else{if(_0xdc3b8b[0x0][_0x6ff4da(0x1d0)]==_0x6ff4da(0x211))var _0x3ab8fb=users['Portuguese'];else{if(_0xdc3b8b[0x0][_0x6ff4da(0x1d0)]==_0x6ff4da(0x17c))var _0x3ab8fb=users[_0x6ff4da(0x17c)];else{if(_0xdc3b8b[0x0][_0x6ff4da(0x1d0)]=='Arabic\x20(ae)')var _0x3ab8fb=users[_0x6ff4da(0x23f)];}}}}}}}_0x41467b[_0x6ff4da(0x1a6)](_0x6ff4da(0x261),{'success':_0x55f47a['flash']('success'),'errors':_0x55f47a[_0x6ff4da(0x230)](_0x6ff4da(0x1f5)),'role':_0x4354b4,'profile':_0x6a917e,'master_shop':_0xdc3b8b,'transfer':_0x50f5f0,'language':_0x3ab8fb});}catch(_0x3f26bd){console[_0x6ff4da(0x22e)](_0x3f26bd);}});async function getRandom8DigitNumber(){var _0x626f1d=a0_0xce18d3;const _0x548258=0x989680,_0x27f52a=0x5f5e0ff,_0x5cec36=Math[_0x626f1d(0x24b)](Math[_0x626f1d(0x1cf)]()*(_0x27f52a-_0x548258+0x1))+_0x548258;var _0x2de8e8;const _0x12457f=await transfers[_0x626f1d(0x1b3)]({'invoice':_0x626f1d(0x1c7)+_0x5cec36});return _0x12457f&&_0x12457f['length']>0x0?_0x2de8e8=_0x626f1d(0x1c7)+_0x5cec36:_0x2de8e8='TRF-'+_0x5cec36,_0x2de8e8;}router[a0_0xce18d3(0x23e)]('/view/add_transfer',auth,async(_0x29f3de,_0x27a5d9)=>{var _0x2351c5=a0_0xce18d3;try{const {username:_0x312dcf,email:_0x3a5c2a,role:_0x98ebe7}=_0x29f3de[_0x2351c5(0x1e7)],_0x2ecaf6=_0x29f3de[_0x2351c5(0x1e7)],_0x111e0e=await profile[_0x2351c5(0x1b3)]({'email':_0x2ecaf6[_0x2351c5(0x250)]}),_0x3640a1=await master_shop[_0x2351c5(0x248)]();console[_0x2351c5(0x22e)](_0x2351c5(0x19a),_0x3640a1);let _0xb935d9;if(_0x2ecaf6[_0x2351c5(0x23d)]=='staff'){const _0x17f0a0=await staff['findOne']({'email':_0x2ecaf6[_0x2351c5(0x250)]});_0xb935d9=await warehouse[_0x2351c5(0x247)]([{'$match':{'status':_0x2351c5(0x17a),'name':_0x17f0a0[_0x2351c5(0x1f2)],'warehouse_category':_0x2351c5(0x207)}},{'$group':{'_id':'$name','name':{'$first':_0x2351c5(0x205)}}}]);}else _0xb935d9=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x2351c5(0x205),'name':{'$first':_0x2351c5(0x205)}}}]);var _0xabed4=[_0x2351c5(0x25c),_0x2351c5(0x18f),'Return\x20Rooms'];const _0x359f15=await transfers['find']({}),_0x3875e7=_0x359f15['length']+0x1,_0x2782d3=_0x2351c5(0x1c7)+_0x3875e7[_0x2351c5(0x1a9)]()[_0x2351c5(0x243)](0x5,'0');if(_0x3640a1[0x0][_0x2351c5(0x1d0)]=='English\x20(US)'){var _0x533228=users['English'];console[_0x2351c5(0x22e)](_0x533228);}else{if(_0x3640a1[0x0][_0x2351c5(0x1d0)]=='Hindi')var _0x533228=users[_0x2351c5(0x1dd)];else{if(_0x3640a1[0x0]['language']==_0x2351c5(0x185))var _0x533228=users[_0x2351c5(0x185)];else{if(_0x3640a1[0x0][_0x2351c5(0x1d0)]=='Spanish')var _0x533228=users[_0x2351c5(0x20c)];else{if(_0x3640a1[0x0]['language']==_0x2351c5(0x1ae))var _0x533228=users[_0x2351c5(0x1ae)];else{if(_0x3640a1[0x0][_0x2351c5(0x1d0)]==_0x2351c5(0x211))var _0x533228=users[_0x2351c5(0x25e)];else{if(_0x3640a1[0x0][_0x2351c5(0x1d0)]==_0x2351c5(0x17c))var _0x533228=users[_0x2351c5(0x17c)];else{if(_0x3640a1[0x0]['language']=='Arabic\x20(ae)')var _0x533228=users[_0x2351c5(0x23f)];}}}}}}}const _0x5bf0c0=getRandom8DigitNumber();_0x5bf0c0[_0x2351c5(0x193)](_0x2999d4=>{var _0x31c85b=_0x2351c5;_0x27a5d9['render'](_0x31c85b(0x214),{'success':_0x29f3de['flash']('success'),'errors':_0x29f3de[_0x31c85b(0x230)](_0x31c85b(0x1f5)),'role':_0x2ecaf6,'profile':_0x111e0e,'master_shop':_0x3640a1,'warehouse':_0xb935d9,'language':_0x533228,'rooms_data':_0xabed4,'invoice':_0x2999d4});})[_0x2351c5(0x208)](_0x14702a=>{var _0xa31381=_0x2351c5;_0x29f3de['flash'](_0xa31381(0x1f5),_0xa31381(0x23c)),_0x27a5d9[_0xa31381(0x1fd)](_0xa31381(0x1fe));});}catch(_0x349992){console['log'](_0x349992);}}),router[a0_0xce18d3(0x1a0)]('/view/add_transfer',auth,async(_0x41f2af,_0x110bdb)=>{var _0x5f2be8=a0_0xce18d3;try{console[_0x5f2be8(0x22e)](_0x41f2af[_0x5f2be8(0x1b2)]);const {date:_0x45df34,from_warehouse:_0x525c25,FromRoom_name:_0x3d9ce8,to_warehouse:_0x4d2e44,ToRoom_name:_0x21a5f6,prod_name:_0xd98f83,from_prod_qty:_0x45ac4b,from_prod_level:_0x561e1b,from_prod_isle:_0xce61c3,from_prod_pallet:_0x35c4af,to_prod_qty:_0x4c0964,to_prod_level:_0xfa8c62,to_prod_isle:_0x4c2c35,to_prod_pallet:_0x240cdd,primary_code:_0x1483cb,secondary_code:_0x5c275d,product_code3:_0x578314,note:_0x272e71,MaxStocks_data2:_0x5bf2b4,invoice:_0x169fc5,expiry_date:_0x56fc37}=_0x41f2af[_0x5f2be8(0x1b2)];if(typeof _0xd98f83==_0x5f2be8(0x195))var _0x5bae1b=[_0x41f2af['body'][_0x5f2be8(0x22a)]],_0x2116e=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1f0)]],_0x34e270=[_0x41f2af[_0x5f2be8(0x1b2)]['from_prod_level']],_0x1bb360=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x200)]],_0x218932=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x186)]],_0x358247=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x213)]],_0x52b4de=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x17d)]],_0x1d8def=[_0x41f2af[_0x5f2be8(0x1b2)]['product_code3']],_0x1d9492=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1be)]],_0x492fb1=[_0x41f2af[_0x5f2be8(0x1b2)]['primary_unit']],_0xe6a5e1=[_0x41f2af['body'][_0x5f2be8(0x1e4)]],_0x47a1ad=[_0x41f2af['body']['batch_code']],_0x4a2739=[_0x41f2af['body'][_0x5f2be8(0x1d4)]],_0x84bd1d=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1f8)]],_0x402cb1=[_0x41f2af['body'][_0x5f2be8(0x1b0)]],_0x3cc259=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1e3)]],_0x159ee9=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1b5)]],_0x1b628d=[_0x41f2af['body'][_0x5f2be8(0x189)]],_0x4849e0=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1f7)]],_0x45a135=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1d1)]],_0x57f26a=[_0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1c8)]];else var _0x5bae1b=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x22a)]],_0x2116e=[..._0x41f2af[_0x5f2be8(0x1b2)]['from_prod_qty']],_0x34e270=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x21e)]],_0x1bb360=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x200)]],_0x218932=[..._0x41f2af[_0x5f2be8(0x1b2)]['to_prod_level']],_0x358247=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x213)]],_0x52b4de=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x17d)]],_0x1d8def=[..._0x41f2af['body'][_0x5f2be8(0x20e)]],_0x1d9492=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1be)]],_0x492fb1=[..._0x41f2af['body']['primary_unit']],_0xe6a5e1=[..._0x41f2af['body'][_0x5f2be8(0x1e4)]],_0x47a1ad=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1f9)]],_0x4a2739=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1d4)]],_0x84bd1d=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1f8)]],_0x402cb1=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1b0)]],_0x3cc259=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1e3)]],_0x159ee9=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1b5)]],_0x1b628d=[..._0x41f2af['body'][_0x5f2be8(0x189)]],_0x4849e0=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1f7)]],_0x45a135=[..._0x41f2af['body'][_0x5f2be8(0x1d1)]],_0x57f26a=[..._0x41f2af[_0x5f2be8(0x1b2)][_0x5f2be8(0x1c8)]];const _0x29d2d5=_0x5bae1b['map'](_0x49e0e0=>{return _0x49e0e0={'product_name':_0x49e0e0};});_0x2116e[_0x5f2be8(0x21b)]((_0x4c8b92,_0x165332)=>{var _0x51a117=_0x5f2be8;_0x29d2d5[_0x165332][_0x51a117(0x220)]=_0x4c8b92;}),_0x4849e0[_0x5f2be8(0x21b)]((_0x57f31c,_0x5b5ab5)=>{var _0x34b2fa=_0x5f2be8;_0x29d2d5[_0x5b5ab5][_0x34b2fa(0x1f7)]=_0x57f31c;}),_0x45a135[_0x5f2be8(0x21b)]((_0x937195,_0x163772)=>{var _0x571b03=_0x5f2be8;_0x29d2d5[_0x163772][_0x571b03(0x1bb)]=_0x937195;}),_0x57f26a['forEach']((_0x3863ba,_0x2aa2a4)=>{var _0x424bfd=_0x5f2be8;_0x29d2d5[_0x2aa2a4][_0x424bfd(0x1ad)]=_0x3863ba;}),_0x34e270[_0x5f2be8(0x21b)]((_0x1b03bd,_0x24fe93)=>{_0x159ee9['forEach']((_0x3c119c,_0x11b21d)=>{var _0x48f1d0=a0_0x5ed2;if(_0x3c119c==_0x48f1d0(0x263)&&_0x24fe93==_0x11b21d){var _0x41c60b=_0x1b03bd[_0x48f1d0(0x203)](0x3);_0x29d2d5[_0x24fe93][_0x48f1d0(0x198)]=_0x1b03bd[0x0],_0x29d2d5[_0x24fe93][_0x48f1d0(0x1bc)]=_0x1b03bd[0x1],_0x29d2d5[_0x24fe93][_0x48f1d0(0x1ec)]=0x0,_0x29d2d5[_0x24fe93][_0x48f1d0(0x1d6)]=0x0,_0x29d2d5[_0x24fe93]['from_types']=_0x48f1d0(0x221),_0x29d2d5[_0x24fe93][_0x48f1d0(0x215)]=_0x41c60b;}else{if(_0x3c119c=='Shelves'&&_0x24fe93==_0x11b21d){var _0x41c60b=_0x1b03bd[_0x48f1d0(0x203)](0x3);_0x29d2d5[_0x24fe93][_0x48f1d0(0x198)]=_0x1b03bd[0x0],_0x29d2d5[_0x24fe93][_0x48f1d0(0x1bc)]=_0x1b03bd[0x1],_0x29d2d5[_0x24fe93]['from_bay']=0x0,_0x29d2d5[_0x24fe93][_0x48f1d0(0x1d6)]=0x0,_0x29d2d5[_0x24fe93][_0x48f1d0(0x181)]=_0x48f1d0(0x221),_0x29d2d5[_0x24fe93][_0x48f1d0(0x215)]=_0x1b03bd[0x5];}else{if(_0x24fe93==_0x11b21d){if(_0x1b03bd[0x0]=='A'&&_0x1b03bd[0x1]=='L'&&_0x1b03bd[0x2]=='L')console[_0x48f1d0(0x22e)](_0x3c119c+_0x48f1d0(0x20d)+_0x24fe93+'\x20<>\x20'+_0x11b21d+_0x48f1d0(0x20d)+_0x1b03bd+_0x48f1d0(0x225)),_0x29d2d5[_0x24fe93][_0x48f1d0(0x198)]=_0x1b03bd[0x0],_0x29d2d5[_0x24fe93][_0x48f1d0(0x1bc)]=_0x1b03bd[0x1],_0x29d2d5[_0x24fe93][_0x48f1d0(0x1ec)]=0x0,_0x29d2d5[_0x24fe93][_0x48f1d0(0x1d6)]=0x0,_0x29d2d5[_0x24fe93][_0x48f1d0(0x181)]=_0x48f1d0(0x221),_0x29d2d5[_0x24fe93][_0x48f1d0(0x215)]=_0x1b03bd[0x3];else{var _0x4b3864;if(_0x1b03bd[0x4]=='L')_0x4b3864='Level';else _0x1b03bd[0x4]=='F'&&(_0x4b3864='Floor');_0x29d2d5[_0x24fe93][_0x48f1d0(0x198)]=_0x1b03bd[0x0],_0x29d2d5[_0x24fe93][_0x48f1d0(0x1bc)]=_0x1b03bd[0x1],_0x29d2d5[_0x24fe93]['from_bay']=_0x1b03bd[0x2],_0x29d2d5[_0x24fe93][_0x48f1d0(0x1d6)]=_0x1b03bd[0x3],_0x29d2d5[_0x24fe93][_0x48f1d0(0x181)]=_0x4b3864,_0x29d2d5[_0x24fe93]['from_floorlevel']=_0x1b03bd[0x5];}}}}});}),_0x1bb360[_0x5f2be8(0x21b)]((_0x276611,_0x5dc20b)=>{var _0x4a51e8=_0x5f2be8;_0x29d2d5[_0x5dc20b][_0x4a51e8(0x1a4)]=_0x276611;}),_0x218932['forEach']((_0x200200,_0x5925eb)=>{var _0x28c7a5=_0x5f2be8;_0x1b628d[_0x28c7a5(0x21b)]((_0x1148f1,_0x441aa9)=>{var _0x246f5f=_0x28c7a5;if(_0x1148f1==_0x246f5f(0x263)&&_0x5925eb==_0x441aa9){var _0x32a9bb=_0x200200[_0x246f5f(0x203)](0x3);_0x29d2d5[_0x5925eb]['storage']=_0x200200[0x0],_0x29d2d5[_0x5925eb]['rack']=_0x200200[0x1],_0x29d2d5[_0x5925eb][_0x246f5f(0x1f3)]=0x0,_0x29d2d5[_0x5925eb][_0x246f5f(0x177)]=0x0,_0x29d2d5[_0x5925eb]['to_types']=_0x246f5f(0x221),_0x29d2d5[_0x5925eb]['to_floorlevel']=_0x32a9bb;}else{if(_0x1148f1==_0x246f5f(0x1dc)&&_0x5925eb==_0x441aa9){var _0x32a9bb=_0x200200[_0x246f5f(0x203)](0x3);_0x29d2d5[_0x5925eb][_0x246f5f(0x21c)]=_0x200200[0x0],_0x29d2d5[_0x5925eb][_0x246f5f(0x25d)]=_0x200200[0x1],_0x29d2d5[_0x5925eb][_0x246f5f(0x1f3)]=0x0,_0x29d2d5[_0x5925eb][_0x246f5f(0x177)]=0x0,_0x29d2d5[_0x5925eb][_0x246f5f(0x242)]=_0x246f5f(0x221),_0x29d2d5[_0x5925eb][_0x246f5f(0x237)]=_0x200200[0x5];}else{if(_0x5925eb==_0x441aa9){if(_0x200200[0x0]=='A'&&_0x200200[0x1]=='L'&&_0x200200[0x2]=='L')console[_0x246f5f(0x22e)](_0x1148f1+_0x246f5f(0x20d)+_0x5925eb+'\x20<>\x20'+_0x441aa9+_0x246f5f(0x20d)+_0x200200+_0x246f5f(0x225)),_0x29d2d5[_0x5925eb][_0x246f5f(0x21c)]=_0x200200[0x0],_0x29d2d5[_0x5925eb][_0x246f5f(0x25d)]=_0x200200[0x1],_0x29d2d5[_0x5925eb][_0x246f5f(0x1f3)]=0x0,_0x29d2d5[_0x5925eb]['to_bin']=0x0,_0x29d2d5[_0x5925eb][_0x246f5f(0x242)]=_0x246f5f(0x221),_0x29d2d5[_0x5925eb][_0x246f5f(0x237)]=_0x200200[0x3];else{var _0x5534e7;if(_0x200200[0x4]=='L')_0x5534e7=_0x246f5f(0x1cc);else _0x200200[0x4]=='F'&&(_0x5534e7=_0x246f5f(0x221));_0x29d2d5[_0x5925eb][_0x246f5f(0x21c)]=_0x200200[0x0],_0x29d2d5[_0x5925eb]['rack']=_0x200200[0x1],_0x29d2d5[_0x5925eb][_0x246f5f(0x1f3)]=_0x200200[0x2],_0x29d2d5[_0x5925eb][_0x246f5f(0x177)]=_0x200200[0x3],_0x29d2d5[_0x5925eb][_0x246f5f(0x242)]=_0x5534e7,_0x29d2d5[_0x5925eb]['to_floorlevel']=_0x200200[0x5];}}}}});}),_0x358247[_0x5f2be8(0x21b)]((_0x569a1d,_0x423f99)=>{_0x29d2d5[_0x423f99]['primary_code']=_0x569a1d;}),_0x52b4de[_0x5f2be8(0x21b)]((_0x3634d5,_0x5b4e16)=>{_0x29d2d5[_0x5b4e16]['secondary_code']=_0x3634d5;}),_0x1d8def[_0x5f2be8(0x21b)]((_0x3319ca,_0x359e82)=>{var _0x1e698c=_0x5f2be8;_0x29d2d5[_0x359e82][_0x1e698c(0x23b)]=_0x3319ca;}),_0x1d9492[_0x5f2be8(0x21b)]((_0x46267e,_0x4ede90)=>{var _0x507213=_0x5f2be8;_0x29d2d5[_0x4ede90][_0x507213(0x23a)]=_0x46267e;}),_0x492fb1[_0x5f2be8(0x21b)]((_0x2e63fa,_0x5d1cc9)=>{var _0x3b6ab2=_0x5f2be8;_0x29d2d5[_0x5d1cc9][_0x3b6ab2(0x192)]=_0x2e63fa;}),_0xe6a5e1[_0x5f2be8(0x21b)]((_0x2b7a22,_0x768677)=>{var _0x4f5bbf=_0x5f2be8;_0x29d2d5[_0x768677][_0x4f5bbf(0x1e4)]=_0x2b7a22;}),_0x47a1ad[_0x5f2be8(0x21b)]((_0x56ca25,_0x2b4291)=>{var _0x1eb770=_0x5f2be8;_0x29d2d5[_0x2b4291][_0x1eb770(0x1f9)]=_0x56ca25;}),_0x4a2739[_0x5f2be8(0x21b)]((_0x169e0f,_0x406273)=>{var _0x161171=_0x5f2be8;_0x29d2d5[_0x406273][_0x161171(0x1d4)]=_0x169e0f;}),_0x84bd1d['forEach']((_0x3ba75c,_0xded1a7)=>{var _0x1ab934=_0x5f2be8;_0x29d2d5[_0xded1a7][_0x1ab934(0x234)]=_0x3ba75c;}),_0x402cb1['forEach']((_0x4cc90a,_0x533b26)=>{_0x29d2d5[_0x533b26]['production_date']=_0x4cc90a;}),_0x3cc259[_0x5f2be8(0x21b)]((_0xc373ea,_0x1f660a)=>{var _0x4760d7=_0x5f2be8;_0x29d2d5[_0x1f660a][_0x4760d7(0x1e3)]=_0xc373ea;}),_0x159ee9[_0x5f2be8(0x21b)]((_0x35915f,_0x21e4d6)=>{var _0x580bd1=_0x5f2be8;_0x29d2d5[_0x21e4d6][_0x580bd1(0x18e)]=_0x35915f;}),_0x1b628d[_0x5f2be8(0x21b)]((_0x35b857,_0x4d6aee)=>{var _0x430c6e=_0x5f2be8;_0x29d2d5[_0x4d6aee][_0x430c6e(0x1a2)]=_0x35b857;});const _0x57fbdf=_0x29d2d5['filter'](_0x4f9de2=>_0x4f9de2['to_quantity']!=='0'&&_0x4f9de2[_0x5f2be8(0x1a4)]!==''||_0x4f9de2[_0x5f2be8(0x237)]!=='0'&&_0x4f9de2[_0x5f2be8(0x237)]!==''),_0x14ce32=new transfers({'date':_0x45df34,'from_warehouse':_0x525c25,'to_warehouse':_0x4d2e44,'product':_0x57fbdf,'note':_0x272e71,'invoice':_0x169fc5}),_0x3c4f9c=await _0x14ce32[_0x5f2be8(0x196)]();_0x41f2af[_0x5f2be8(0x230)](_0x5f2be8(0x19b),'Product\x20Transfer\x20successfully'),_0x110bdb[_0x5f2be8(0x1fd)](_0x5f2be8(0x219)+_0x3c4f9c[_0x5f2be8(0x227)]);}catch(_0x55487e){console[_0x5f2be8(0x22e)](_0x55487e),_0x110bdb['status'](0xc8)[_0x5f2be8(0x217)]({'errorMessage':_0x55487e[_0x5f2be8(0x201)]});}}),router[a0_0xce18d3(0x23e)](a0_0xce18d3(0x24c),auth,async(_0x16331f,_0x4969fd)=>{var _0x4dab1a=a0_0xce18d3;try{const {username:_0x3c5de0,email:_0x4f6b8d,role:_0x584474}=_0x16331f[_0x4dab1a(0x1e7)],_0x5ab8bb=_0x16331f[_0x4dab1a(0x1e7)],_0x2f9a8a=await profile['findOne']({'email':_0x5ab8bb['email']}),_0x1ae096=await master_shop[_0x4dab1a(0x248)]();console[_0x4dab1a(0x22e)](_0x4dab1a(0x19a),_0x1ae096);const _0x4e0442=await transfers[_0x4dab1a(0x180)](_0x16331f[_0x4dab1a(0x1cd)]['id']);let _0x4f2a7d=new Date(_0x4e0442['expiry_date']),_0x29c6a2=('0'+_0x4f2a7d[_0x4dab1a(0x1fc)]())[_0x4dab1a(0x203)](-0x2),_0x46abc8=('0'+(_0x4f2a7d[_0x4dab1a(0x262)]()+0x1))[_0x4dab1a(0x203)](-0x2),_0x2c0871=_0x4f2a7d[_0x4dab1a(0x206)](),_0xbd3afc=_0x2c0871+'-'+_0x46abc8+'-'+_0x29c6a2,_0x18cf6e;if(_0x5ab8bb[_0x4dab1a(0x23d)]=='staff'){const _0x371ac5=await staff[_0x4dab1a(0x1b3)]({'email':_0x5ab8bb[_0x4dab1a(0x250)]});_0x18cf6e=await warehouse[_0x4dab1a(0x248)]({'status':'Enabled','name':_0x371ac5[_0x4dab1a(0x1f2)],'warehouse_category':'Raw\x20Materials'});}else _0x18cf6e=await warehouse[_0x4dab1a(0x248)]({'status':_0x4dab1a(0x17a),'warehouse_category':_0x4dab1a(0x207)});const _0x93fe4e=await warehouse[_0x4dab1a(0x247)]([{'$match':{'name':_0x4e0442[_0x4dab1a(0x257)]}},{'$unwind':_0x4dab1a(0x1b9)},{'$group':{'_id':_0x4dab1a(0x21f),'name':{'$first':_0x4dab1a(0x1a5)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4dab1a(0x1d7)},'bin':{'$first':_0x4dab1a(0x21d)},'type':{'$first':_0x4dab1a(0x1a3)},'floorlevel':{'$first':_0x4dab1a(0x197)},'primary_code':{'$first':_0x4dab1a(0x224)},'secondary_code':{'$first':_0x4dab1a(0x233)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4dab1a(0x1d3)},'rack':{'$first':_0x4dab1a(0x20f)},'expiry_date':{'$first':_0x4dab1a(0x22c)},'production_date':{'$first':_0x4dab1a(0x18c)},'room':{'$first':'$room'}}}]);if(_0x1ae096[0x0][_0x4dab1a(0x1d0)]=='English\x20(US)'){var _0x5c0586=users['English'];console[_0x4dab1a(0x22e)](_0x5c0586);}else{if(_0x1ae096[0x0][_0x4dab1a(0x1d0)]==_0x4dab1a(0x1dd))var _0x5c0586=users[_0x4dab1a(0x1dd)];else{if(_0x1ae096[0x0]['language']==_0x4dab1a(0x185))var _0x5c0586=users[_0x4dab1a(0x185)];else{if(_0x1ae096[0x0][_0x4dab1a(0x1d0)]==_0x4dab1a(0x20c))var _0x5c0586=users[_0x4dab1a(0x20c)];else{if(_0x1ae096[0x0]['language']=='French')var _0x5c0586=users['French'];else{if(_0x1ae096[0x0][_0x4dab1a(0x1d0)]==_0x4dab1a(0x211))var _0x5c0586=users[_0x4dab1a(0x25e)];else{if(_0x1ae096[0x0]['language']==_0x4dab1a(0x17c))var _0x5c0586=users[_0x4dab1a(0x17c)];else{if(_0x1ae096[0x0][_0x4dab1a(0x1d0)]==_0x4dab1a(0x187))var _0x5c0586=users[_0x4dab1a(0x23f)];}}}}}}}_0x4969fd[_0x4dab1a(0x1a6)](_0x4dab1a(0x1ed),{'success':_0x16331f['flash'](_0x4dab1a(0x19b)),'errors':_0x16331f[_0x4dab1a(0x230)](_0x4dab1a(0x1f5)),'role':_0x5ab8bb,'profile':_0x2f9a8a,'master_shop':_0x1ae096,'warehouse':_0x18cf6e,'transfer':_0x4e0442,'stock':_0x93fe4e,'language':_0x5c0586});}catch(_0x3a808a){console[_0x4dab1a(0x22e)](_0x3a808a);}}),router['post'](a0_0xce18d3(0x24c),auth,async(_0x4ac0d7,_0x3307da)=>{var _0x20a0bf=a0_0xce18d3;try{const _0x5788ab=_0x4ac0d7[_0x20a0bf(0x1cd)]['id'],{from_warehouse:_0x4bf18e,FromRoom_name:_0x29ffcb,to_warehouse:_0x2ad3d5,ToRoom_name:_0x4c6581}=_0x4ac0d7[_0x20a0bf(0x1b2)],_0x28c835=await transfers[_0x20a0bf(0x180)]({'_id':_0x5788ab}),_0x390ef6=_0x28c835[_0x20a0bf(0x22d)][_0x20a0bf(0x1df)](async _0x24c5a3=>{var _0x41969f=_0x20a0bf;if(_0x24c5a3['to_quantity']>0x0){var _0x157e7a=await warehouse[_0x41969f(0x1b3)]({'name':_0x28c835[_0x41969f(0x257)],'room':_0x24c5a3['from_room_name'],'warehouse_category':_0x41969f(0x207)});const _0x6b1e3b=_0x157e7a[_0x41969f(0x246)][_0x41969f(0x1df)](_0x262b2a=>{var _0x472407=_0x41969f;_0x262b2a[_0x472407(0x199)]==_0x24c5a3[_0x472407(0x199)]&&_0x262b2a[_0x472407(0x231)]==_0x24c5a3[_0x472407(0x215)]&&_0x262b2a[_0x472407(0x19e)]==_0x24c5a3[_0x472407(0x181)]&&_0x262b2a['bin']==_0x24c5a3['from_bin']&&_0x262b2a['bay']==_0x24c5a3['from_bay']&&_0x262b2a[_0x472407(0x25d)]==_0x24c5a3[_0x472407(0x1bc)]&&_0x262b2a[_0x472407(0x21c)]==_0x24c5a3[_0x472407(0x198)]&&_0x262b2a[_0x472407(0x1d4)]==_0x24c5a3[_0x472407(0x1d4)]&&_0x262b2a[_0x472407(0x1f9)]==_0x24c5a3[_0x472407(0x1f9)]&&_0x262b2a[_0x472407(0x1b0)]==_0x24c5a3['production_date']&&_0x262b2a[_0x472407(0x183)]==_0x24c5a3[_0x472407(0x1f7)]&&_0x262b2a[_0x472407(0x227)]==_0x24c5a3[_0x472407(0x1ad)]&&(_0x262b2a[_0x472407(0x244)]=_0x262b2a['product_stock']-_0x24c5a3['to_quantity']);});}return _0x157e7a;});Promise[_0x20a0bf(0x216)](_0x390ef6)['then'](async _0xdd9baf=>{var _0x5a217c=_0x20a0bf;try{for(const _0x4330f8 of _0xdd9baf){await _0x4330f8[_0x5a217c(0x196)]();}try{const _0x2e4ece=_0x28c835[_0x5a217c(0x22d)][_0x5a217c(0x1df)](async _0x48e034=>{var _0x31d342=_0x5a217c;if(_0x48e034[_0x31d342(0x1a4)]>0x0){var _0xd2e757=await warehouse[_0x31d342(0x1b3)]({'name':_0x28c835[_0x31d342(0x24a)],'room':_0x48e034[_0x31d342(0x1a2)],'warehouse_category':_0x31d342(0x207)}),_0x434630=0x0;const _0x4ce3f0=_0xd2e757[_0x31d342(0x246)][_0x31d342(0x1df)](_0x4b3661=>{var _0x177884=_0x31d342;_0x4b3661[_0x177884(0x199)]==_0x48e034[_0x177884(0x199)]&&_0x4b3661['floorlevel']==_0x48e034[_0x177884(0x237)]&&_0x4b3661[_0x177884(0x19e)]==_0x48e034['to_types']&&_0x4b3661[_0x177884(0x210)]==_0x48e034[_0x177884(0x177)]&&_0x4b3661[_0x177884(0x190)]==_0x48e034[_0x177884(0x1f3)]&&_0x4b3661[_0x177884(0x25d)]==_0x48e034[_0x177884(0x25d)]&&_0x4b3661[_0x177884(0x21c)]==_0x48e034[_0x177884(0x21c)]&&_0x4b3661[_0x177884(0x1d4)]==_0x48e034[_0x177884(0x1d4)]&&_0x4b3661[_0x177884(0x1f9)]==_0x48e034[_0x177884(0x1f9)]&&_0x4b3661['production_date']==_0x48e034['production_date']&&_0x4b3661[_0x177884(0x183)]==_0x48e034[_0x177884(0x1bb)]&&(_0x4b3661['product_stock']=_0x4b3661[_0x177884(0x244)]+_0x48e034[_0x177884(0x1a4)],_0x434630++);});_0x434630=='0'&&(_0xd2e757[_0x31d342(0x246)]=_0xd2e757[_0x31d342(0x246)][_0x31d342(0x245)]({'product_name':_0x48e034[_0x31d342(0x199)],'product_stock':_0x48e034[_0x31d342(0x1a4)],'bay':_0x48e034[_0x31d342(0x1f3)],'bin':_0x48e034['to_bin'],'type':_0x48e034[_0x31d342(0x242)],'floorlevel':_0x48e034[_0x31d342(0x237)],'storage':_0x48e034[_0x31d342(0x21c)],'rack':_0x48e034['rack'],'product_code':_0x48e034[_0x31d342(0x23b)],'primary_code':_0x48e034[_0x31d342(0x213)],'secondary_code':_0x48e034[_0x31d342(0x17d)],'maxProducts':_0x48e034[_0x31d342(0x23a)],'storage':_0x48e034['storage'],'rack':_0x48e034[_0x31d342(0x25d)],'expiry_date':_0x48e034[_0x31d342(0x1d4)],'maxPerUnit':_0x48e034['maxperunit'],'batch_code':_0x48e034['batch_code'],'production_date':_0x48e034[_0x31d342(0x1b0)]}));}return _0xd2e757;});Promise['all'](_0x2e4ece)[_0x5a217c(0x193)](async _0x1c6dd6=>{var _0x19bfd1=_0x5a217c;try{for(const _0x329f44 of _0x1c6dd6){await warehouse[_0x19bfd1(0x1e1)]({'_id':_0x329f44[_0x19bfd1(0x227)]},{'$addToSet':{'product_details':{'$each':_0x329f44[_0x19bfd1(0x246)]}}});}_0x28c835[_0x19bfd1(0x1ee)]='True';const _0x1b5aed=await _0x28c835['save'](),_0x573dab=await master_shop[_0x19bfd1(0x248)](),_0x302ad2=await email_settings[_0x19bfd1(0x1b3)](),_0x49c78e=await supervisor_settings[_0x19bfd1(0x248)]();var _0x1d1a79=_0x28c835[_0x19bfd1(0x22d)],_0x4ea144='',_0x47e737;for(_0x47e737 in _0x1d1a79){_0x4ea144+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1d1a79[_0x47e737][_0x19bfd1(0x199)]+_0x19bfd1(0x17b)+_0x19bfd1(0x1e5)+_0x1d1a79[_0x47e737][_0x19bfd1(0x23b)]+_0x19bfd1(0x17b)+_0x19bfd1(0x1e5)+_0x1d1a79[_0x47e737][_0x19bfd1(0x1a4)]+_0x19bfd1(0x17b)+_0x19bfd1(0x1e5)+_0x1d1a79[_0x47e737][_0x19bfd1(0x192)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1d1a79[_0x47e737]['secondary_unit']+'</td>'+_0x19bfd1(0x1e5)+_0x28c835[_0x19bfd1(0x24a)]+'</td>'+_0x19bfd1(0x1e5)+_0x1d1a79[_0x47e737][_0x19bfd1(0x1a2)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1d1a79[_0x47e737][_0x19bfd1(0x21c)]+_0x1d1a79[_0x47e737][_0x19bfd1(0x25d)]+_0x1d1a79[_0x47e737][_0x19bfd1(0x1f3)]+_0x1d1a79[_0x47e737]['to_bin']+_0x1d1a79[_0x47e737]['to_types'][0x0]+_0x1d1a79[_0x47e737]['to_floorlevel']+_0x19bfd1(0x17b),_0x19bfd1(0x1aa);}let _0x282745=nodemailer[_0x19bfd1(0x19f)]({'host':_0x302ad2[_0x19bfd1(0x18b)],'port':Number(_0x302ad2[_0x19bfd1(0x194)]),'secure':![],'auth':{'user':_0x302ad2[_0x19bfd1(0x250)],'pass':_0x302ad2[_0x19bfd1(0x191)]}}),_0x523c8b={'from':_0x302ad2[_0x19bfd1(0x250)],'to':_0x49c78e[0x0][_0x19bfd1(0x236)],'subject':_0x19bfd1(0x1c3),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+'/upload/'+_0x573dab[0x0]['image'],'cid':_0x19bfd1(0x24f)}],'html':_0x19bfd1(0x249)+_0x19bfd1(0x264)+_0x19bfd1(0x1cb)+_0x19bfd1(0x1d2)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x19bfd1(0x1d2)+_0x19bfd1(0x24d)+_0x19bfd1(0x19d)+_0x19bfd1(0x1d2)+'<h2>\x20'+_0x573dab[0x0][_0x19bfd1(0x1e8)]+_0x19bfd1(0x1b8)+_0x19bfd1(0x19d)+_0x19bfd1(0x19d)+_0x19bfd1(0x218)+_0x19bfd1(0x1d2)+_0x19bfd1(0x1eb)+'\x20Order\x20Number\x20:\x20'+_0x28c835[_0x19bfd1(0x183)]+'\x20'+_0x19bfd1(0x209)+_0x19bfd1(0x241)+_0x28c835[_0x19bfd1(0x182)]+'\x20'+_0x19bfd1(0x1ca)+_0x19bfd1(0x251)+'</div>'+_0x19bfd1(0x1fb)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x19bfd1(0x17f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x19bfd1(0x1ab)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x19bfd1(0x1c6)+_0x19bfd1(0x1bd)+_0x19bfd1(0x1d8)+_0x19bfd1(0x1d5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x19bfd1(0x1aa)+_0x19bfd1(0x20a)+_0x19bfd1(0x18d)+'\x20'+_0x4ea144+'\x20'+_0x19bfd1(0x253)+_0x19bfd1(0x1da)+'<div>'+_0x19bfd1(0x1e9)+_0x19bfd1(0x1f6)+_0x573dab[0x0][_0x19bfd1(0x1e8)]+'</h5>'+'</div>'+_0x19bfd1(0x19d)+'</body></html>'};_0x282745[_0x19bfd1(0x1b1)](_0x523c8b,function(_0x5967d5,_0x19ae66){var _0x52d22c=_0x19bfd1;_0x5967d5?(console[_0x52d22c(0x22e)](_0x5967d5),console[_0x52d22c(0x22e)]('Error\x20Occurs')):console[_0x52d22c(0x22e)](_0x52d22c(0x18a));}),_0x4ac0d7[_0x19bfd1(0x230)]('success','Transfer\x20Finalize\x20Successfully'),_0x3307da[_0x19bfd1(0x1fd)](_0x19bfd1(0x235)+_0x1b5aed[_0x19bfd1(0x227)]);}catch(_0x319cdb){console[_0x19bfd1(0x1ff)](_0x319cdb),_0x3307da['status'](0x1f4)['json']({'Perror':_0x19bfd1(0x1c1),'message':_0x319cdb[_0x19bfd1(0x201)]});}})['catch'](_0x5882a9=>{var _0x4aec41=_0x5a217c;console[_0x4aec41(0x1ff)](_0x5882a9),_0x3307da['status'](0x1f4)['json']({'Perror':_0x4aec41(0x1c2)});});}catch(_0x465ac2){_0x3307da['json'](_0x465ac2);}}catch(_0x35d11e){console[_0x5a217c(0x1ff)](_0x35d11e),_0x3307da[_0x5a217c(0x1af)](0x1f4)['json']({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x35d11e[_0x5a217c(0x201)]});}})[_0x20a0bf(0x208)](_0x1e6e2d=>{var _0x40bb0a=_0x20a0bf;console[_0x40bb0a(0x1ff)](_0x1e6e2d),_0x3307da[_0x40bb0a(0x1af)](0x1f4)['json']({'Merror':_0x40bb0a(0x1c2)});});}catch(_0x887e59){console['log'](_0x887e59);}});function a0_0x4d19(){var _0x1e4a4e=['$product_details.production_date','<tbody\x20style=\x22text-align:\x20center;\x22>','from_room_name','Enclosed','bay','password','unit','then','port','string','save','$product_details.floorlevel','from_storage','product_name','master','success','$product_details.level','</div>','type','createTransport','post','$product_details.pallet','to_room_name','$product_details.type','to_quantity','$product_details.product_name','render','from_rak','/view/:id','toString','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','1848444TpqVnf','id_transaction_id','French','status','production_date','sendMail','body','findOne','Rack\x20B','RoomAssigned','to_room','$product_details.secondary_unit','\x20</h2>','$product_details','2516672TzrmLj','To_invoice','from_rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','MaxStocks_data2','2834489oxutuJ','nodemailer','An\x20error\x20occurred\x20while\x20saving\x20data.','An\x20error\x20occurred.','Transfer\x20Mail','COLD\x20STORAGE','to_prod_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','TRF-','id_transaction','DRY\x20STORAGE','</span>','</head><body>','Level','params','$_id','random','language','to_invoice','<div>','$product_details.storage','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','from_bin','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.maxPerUnit','</table>','$product_details.batch_code','Shelves','Hindi','Rack\x20A','map','English','updateOne','/view','prod_cat','secondary_unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','1Nhrlzu','user','site_title','<strong>\x20Regards\x20</strong>','staff','<h5\x20style=\x22text-align:\x20left;\x22>','from_bay','edit_transfer_view','finalize','length','from_prod_qty','431006jxBTUU','warehouse','to_bay','$product_details.invoice','errors','<h5>','from_invoice','max_per_unit','batch_code','Transfer\x20Edit\x20Successfully','<table\x20style=\x22width:\x20100%\x20!important;\x22>','getDate','redirect','/transfer/view','error','New_Qty_Converted','message','$product_details.product_stock','slice','$date','$name','getFullYear','Raw\x20Materials','catch','<span\x20style=\x22float:\x20right;\x22>','</thead>','976059jRIEXs','Spanish','\x20<>\x20','product_code3','$product_details.rack','bin','Portuguese\x20(BR)','push','primary_code','add_transfer','from_floorlevel','all','json','<hr\x20class=\x22my-3\x22>','/transfer/preview/','/barcode_scanner3','forEach','storage','$product_details.bin','from_prod_level','$product_details._id','from_quantity','Floor','../models/all_models','English\x20(US)','$product_details.primary_code','here','filter','_id','Rack\x20F','400365KYdltf','prod_name','$from_warehouse','$product_details.expiry_date','product','log','$to_warehouse','flash','floorlevel','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.secondary_code','maxperunit','/picking_list/PDF_transfer_rm/','RMSEmail','to_floorlevel','split','708JNOoMb','maxProducts','product_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','role','get','Arabic','$product_details.isle','\x20Order\x20Date\x20:\x20','to_types','padStart','product_stock','concat','product_details','aggregate','find','<!DOCTYPE\x20html>','to_warehouse','floor','/preview/:id','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/CheckingWarehouse','logo','email','</h5>','$room','</tbody>','to_prod_isle','4010UKbJkn','$product_details.unit','from_warehouse','$product.to_room_name','$product_details.product_code','rak','Rack\x20D','Ambient','rack','Portuguese','$finalize','back','transfer','getMonth','Receiving\x20Area','<html><head><title></title>','to_bin','edit_transfer','/barcode_scanner2','Enabled','</td>','Chinese','secondary_code','$product_details.maxProducts','<tr>','findById','from_types','date','invoice','../middleware/auth','German','to_prod_level','Arabic\x20(ae)','to_prod_pallet','ToRoomAssigned','Email\x20sent\x20successfully','host'];a0_0x4d19=function(){return _0x1e4a4e;};return a0_0x4d19();}function a0_0x5ed2(_0x46f0b2,_0x4bb77d){var _0x4d19de=a0_0x4d19();return a0_0x5ed2=function(_0x5ed242,_0x420758){_0x5ed242=_0x5ed242-0x177;var _0x2cc485=_0x4d19de[_0x5ed242];return _0x2cc485;},a0_0x5ed2(_0x46f0b2,_0x4bb77d);}function BayBinSelected(_0x4ddaa7,_0x54a461){var _0x3c25e7=a0_0xce18d3,_0x3d8ec6=[],_0x563b29=[],_0x35e264=[],_0x3b2ce7=[],_0x6b9553=[],_0xb0a621=[];let _0x29c157=[];if(_0x4ddaa7==_0x3c25e7(0x1c9))switch(_0x54a461){case _0x3c25e7(0x1de):_0x3d8ec6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x563b29=[0x1,0x2],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=[_0x3c25e7(0x1cc),_0x3c25e7(0x221)],_0x6b9553=['D'],_0xb0a621=['A'];break;case _0x3c25e7(0x1b4):_0x3d8ec6=[0x6,0x5,0x4,0x3,0x2,0x1],_0x563b29=[0x1,0x2],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=[_0x3c25e7(0x1cc),_0x3c25e7(0x221)],_0x6b9553=['D'],_0xb0a621=['B'];break;case _0x3c25e7(0x1dc):_0x3d8ec6=[0x0],_0x563b29=[0x0],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=['Floor'],_0x6b9553=['D'],_0xb0a621=['S'];break;case _0x3c25e7(0x263):_0x3d8ec6=[0x0],_0x563b29=[0x0],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x35e264=[_0x3c25e7(0x221)],_0x6b9553=['D'],_0xb0a621=['R'];break;}else{if(_0x4ddaa7==_0x3c25e7(0x1c4))switch(_0x54a461){case _0x3c25e7(0x1de):_0x3d8ec6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x563b29=['B','F'],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=[_0x3c25e7(0x1cc),_0x3c25e7(0x221)],_0x6b9553=['C'],_0xb0a621=['A'];break;case _0x3c25e7(0x1b4):_0x3d8ec6=[0x5,0x4,0x3,0x2,0x1],_0x563b29=['F','B','S'],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=[_0x3c25e7(0x1cc),_0x3c25e7(0x221)],_0x6b9553=['C'],_0xb0a621=['B'];break;case'Rack\x20C':_0x3d8ec6=[0x1,0x2,0x3,0x4,0x5],_0x563b29=['B','F','S'],_0x3b2ce7=[0x5,0x4,0x3,0x2,0x1],_0x35e264=[_0x3c25e7(0x1cc),_0x3c25e7(0x221)],_0x6b9553=['C'],_0xb0a621=['C'];break;case _0x3c25e7(0x25b):_0x3d8ec6=[0x5,0x4,0x3,0x2,0x1],_0x563b29=['F','B','S'],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=[_0x3c25e7(0x1cc),_0x3c25e7(0x221)],_0x6b9553=['C'],_0xb0a621=['D'];break;case'Rack\x20E':_0x3d8ec6=[0x4,0x3,0x2,0x1],_0x563b29=[0x1,0x2],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=[_0x3c25e7(0x1cc),_0x3c25e7(0x221)],_0x6b9553=['C'],_0xb0a621=['E'];break;case _0x3c25e7(0x228):_0x3d8ec6=[0x1,0x2,0x3],_0x563b29=[0x1,0x2],_0x3b2ce7=[0x1,0x2,0x3,0x4,0x5],_0x35e264=['Level'],_0x6b9553=['C'],_0xb0a621=['F'];break;}}return{'levels':_0x3d8ec6,'Isle':_0x563b29,'rack':_0x3b2ce7,'type':_0x35e264,'storage':_0x6b9553,'rak':_0xb0a621};}router['get'](a0_0xce18d3(0x1a8),auth,async(_0xd8ae9a,_0x1fa3a6)=>{var _0x3089a8=a0_0xce18d3;try{const {username:_0x2bce7e,email:_0x29c458,role:_0xabc14f}=_0xd8ae9a[_0x3089a8(0x1e7)],_0x19e3d1=_0xd8ae9a[_0x3089a8(0x1e7)],_0x228501=await profile[_0x3089a8(0x1b3)]({'email':_0x19e3d1[_0x3089a8(0x250)]}),_0x43a34a=await master_shop[_0x3089a8(0x248)](),_0x2689dc=await transfers[_0x3089a8(0x180)](_0xd8ae9a[_0x3089a8(0x1cd)]['id']);let _0x26192c;if(_0x19e3d1[_0x3089a8(0x23d)]=='staff'){const _0x175aa8=await staff[_0x3089a8(0x1b3)]({'email':_0x19e3d1['email']});_0x26192c=await warehouse[_0x3089a8(0x247)]([{'$match':{'status':_0x3089a8(0x17a),'name':_0x175aa8['warehouse'],'warehouse_category':_0x3089a8(0x207)}},{'$group':{'_id':_0x3089a8(0x205),'name':{'$first':_0x3089a8(0x205)}}}]);}else _0x26192c=await warehouse[_0x3089a8(0x247)]([{'$match':{'status':_0x3089a8(0x17a),'warehouse_category':_0x3089a8(0x207)}},{'$group':{'_id':_0x3089a8(0x205),'name':{'$first':'$name'}}}]);const _0x1400a0=await warehouse[_0x3089a8(0x247)]([{'$match':{'name':_0x2689dc[_0x3089a8(0x257)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x3089a8(0x1b9)},{'$group':{'_id':_0x3089a8(0x21f),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3089a8(0x1a3)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3089a8(0x259)},'storage':{'$first':_0x3089a8(0x1d3)},'rack':{'$first':_0x3089a8(0x20f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3089a8(0x18c)},'room':{'$first':_0x3089a8(0x252)}}}]),_0x2c923a=await product[_0x3089a8(0x248)]({}),_0x1105ae=BayBinSelected(_0x2689dc['to_warehouse'],_0x2689dc[_0x3089a8(0x1b6)]);if(_0x43a34a[0x0]['language']==_0x3089a8(0x223)){var _0x13ab85=users[_0x3089a8(0x1e0)];console['log'](_0x13ab85);}else{if(_0x43a34a[0x0][_0x3089a8(0x1d0)]==_0x3089a8(0x1dd))var _0x13ab85=users[_0x3089a8(0x1dd)];else{if(_0x43a34a[0x0]['language']==_0x3089a8(0x185))var _0x13ab85=users[_0x3089a8(0x185)];else{if(_0x43a34a[0x0][_0x3089a8(0x1d0)]==_0x3089a8(0x20c))var _0x13ab85=users[_0x3089a8(0x20c)];else{if(_0x43a34a[0x0]['language']=='French')var _0x13ab85=users[_0x3089a8(0x1ae)];else{if(_0x43a34a[0x0][_0x3089a8(0x1d0)]==_0x3089a8(0x211))var _0x13ab85=users['Portuguese'];else{if(_0x43a34a[0x0][_0x3089a8(0x1d0)]==_0x3089a8(0x17c))var _0x13ab85=users[_0x3089a8(0x17c)];else{if(_0x43a34a[0x0][_0x3089a8(0x1d0)]==_0x3089a8(0x187))var _0x13ab85=users[_0x3089a8(0x23f)];}}}}}}}_0x1fa3a6[_0x3089a8(0x1a6)](_0x3089a8(0x178),{'success':_0xd8ae9a['flash'](_0x3089a8(0x19b)),'errors':_0xd8ae9a[_0x3089a8(0x230)](_0x3089a8(0x1f5)),'role':_0x19e3d1,'profile':_0x228501,'master_shop':_0x43a34a,'warehouse':_0x26192c,'transfer':_0x2689dc,'stock':_0x1400a0,'unit':_0x2c923a,'language':_0x13ab85});}catch(_0x31bf7b){console['log'](_0x31bf7b);}}),router['post'](a0_0xce18d3(0x1a8),auth,async(_0x352081,_0x5efe4d)=>{var _0x55ec69=a0_0xce18d3;try{const _0x4661a3=_0x352081[_0x55ec69(0x1cd)]['id'],_0x55c8e1=await transfers[_0x55ec69(0x180)](_0x4661a3);_0x5efe4d['json'](_0x352081['body']);return;const {date:_0x5a7dc,from_warehouse:_0x5c9cbd,FromRoom_name:_0x170d55,to_warehouse:_0x16314d,ToRoom_name:_0x52936d,prod_name:_0x1d82cc,from_prod_qty:_0x3ba58c,from_prod_level:_0x216de0,from_prod_isle:_0x23e755,from_prod_pallet:_0x2592ac,to_prod_qty:_0x5c99bd,to_prod_level:_0x11f0d6,to_prod_isle:_0x503f87,to_prod_pallet:_0x2699f1,primary_code:_0x2b4b83,secondary_code:_0x562185,product_code3:_0x50de68,note:_0x131773,invoice:_0x41c8b3,expiry_date:_0x164953}=_0x352081[_0x55ec69(0x1b2)];if(typeof _0x1d82cc=='string')var _0x37d355=[_0x352081['body'][_0x55ec69(0x22a)]],_0x5bbab0=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1f0)]],_0x353679=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x21e)]],_0x44e013=[_0x352081['body']['from_prod_isle']],_0x279ed6=[_0x352081[_0x55ec69(0x1b2)]['from_prod_pallet']],_0x2b4eb5=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x181)]],_0x32b62b=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1c5)]],_0x3a832f=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x186)]],_0x5781d2=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x254)]],_0x2ef6a9=[_0x352081['body'][_0x55ec69(0x188)]],_0x258fad=[_0x352081[_0x55ec69(0x1b2)]['to_types']],_0x4941ed=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x21c)]],_0x1c51f4=[_0x352081['body'][_0x55ec69(0x25a)]],_0x2bc489=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x213)]],_0x1955ac=[_0x352081['body'][_0x55ec69(0x17d)]],_0x56ee63=[_0x352081[_0x55ec69(0x1b2)]['product_code3']],_0x5e35e4=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1be)]],_0x2638b2=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x192)]],_0x4243f6=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1e4)]],_0x2f121d=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1f9)]],_0x5ddeb9=[_0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1d4)]],_0x22b3b0=[_0x352081['body'][_0x55ec69(0x198)]],_0x40764a=[_0x352081['body']['from_rak']];else var _0x37d355=[..._0x352081[_0x55ec69(0x1b2)]['prod_name']],_0x4941ed=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x21c)]],_0x1c51f4=[..._0x352081[_0x55ec69(0x1b2)]['rak']],_0x2b4eb5=[..._0x352081['body'][_0x55ec69(0x181)]],_0x258fad=[..._0x352081['body'][_0x55ec69(0x242)]],_0x5bbab0=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1f0)]],_0x353679=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x21e)]],_0x44e013=[..._0x352081['body']['from_prod_isle']],_0x279ed6=[..._0x352081[_0x55ec69(0x1b2)]['from_prod_pallet']],_0x32b62b=[..._0x352081['body'][_0x55ec69(0x1c5)]],_0x3a832f=[..._0x352081[_0x55ec69(0x1b2)]['to_prod_level']],_0x5781d2=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x254)]],_0x2ef6a9=[..._0x352081[_0x55ec69(0x1b2)]['to_prod_pallet']],_0x2bc489=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x213)]],_0x1955ac=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x17d)]],_0x56ee63=[..._0x352081['body']['product_code3']],_0x5e35e4=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1be)]],_0x2638b2=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x192)]],_0x4243f6=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1e4)]],_0x2f121d=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1f9)]],_0x5ddeb9=[..._0x352081['body'][_0x55ec69(0x1d4)]],_0x22b3b0=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x198)]],_0x40764a=[..._0x352081[_0x55ec69(0x1b2)][_0x55ec69(0x1a7)]];const _0x41bd6a=_0x37d355['map'](_0x558b6c=>{return _0x558b6c={'product_name':_0x558b6c};});_0x5bbab0[_0x55ec69(0x21b)]((_0x531071,_0x586188)=>{_0x41bd6a[_0x586188]['from_quantity']=_0x531071;}),_0x353679[_0x55ec69(0x21b)]((_0x3644af,_0x36b216)=>{_0x41bd6a[_0x36b216]['from_bay']=_0x3644af;}),_0x44e013[_0x55ec69(0x21b)]((_0x4dd2e1,_0x10c724)=>{var _0x507a79=_0x55ec69;_0x41bd6a[_0x10c724][_0x507a79(0x1d6)]=_0x4dd2e1;}),_0x279ed6[_0x55ec69(0x21b)]((_0x15145a,_0x57646f)=>{var _0xaba125=_0x55ec69;_0x41bd6a[_0x57646f][_0xaba125(0x215)]=_0x15145a;}),_0x32b62b[_0x55ec69(0x21b)]((_0x359000,_0x3cf3ca)=>{_0x41bd6a[_0x3cf3ca]['to_quantity']=_0x359000;}),_0x3a832f[_0x55ec69(0x21b)]((_0x5a23c3,_0x40936f)=>{var _0x1e86b1=_0x55ec69;_0x41bd6a[_0x40936f][_0x1e86b1(0x1f3)]=_0x5a23c3;}),_0x5781d2['forEach']((_0x2c3be8,_0x5eff98)=>{var _0x527d71=_0x55ec69;_0x41bd6a[_0x5eff98][_0x527d71(0x177)]=_0x2c3be8;}),_0x2ef6a9[_0x55ec69(0x21b)]((_0x2292bc,_0x4c69e8)=>{_0x41bd6a[_0x4c69e8]['to_floorlevel']=_0x2292bc;}),_0x2bc489[_0x55ec69(0x21b)]((_0x14f36a,_0x3a642f)=>{var _0x467f7e=_0x55ec69;_0x41bd6a[_0x3a642f][_0x467f7e(0x213)]=_0x14f36a;}),_0x1955ac[_0x55ec69(0x21b)]((_0x2a7283,_0x4e0a89)=>{_0x41bd6a[_0x4e0a89]['secondary_code']=_0x2a7283;}),_0x56ee63[_0x55ec69(0x21b)]((_0x166f8c,_0x79cad9)=>{var _0x455016=_0x55ec69;_0x41bd6a[_0x79cad9][_0x455016(0x23b)]=_0x166f8c;}),_0x5e35e4[_0x55ec69(0x21b)]((_0x2128c7,_0x5c3318)=>{var _0x2df06f=_0x55ec69;_0x41bd6a[_0x5c3318][_0x2df06f(0x23a)]=_0x2128c7;}),_0x2638b2[_0x55ec69(0x21b)]((_0x39cec9,_0x43e8fb)=>{_0x41bd6a[_0x43e8fb]['unit']=_0x39cec9;}),_0x4243f6[_0x55ec69(0x21b)]((_0x378cd3,_0x4bcd8d)=>{var _0x5ddea8=_0x55ec69;_0x41bd6a[_0x4bcd8d][_0x5ddea8(0x1e4)]=_0x378cd3;}),_0x2f121d['forEach']((_0x5510d2,_0x4b5a0e)=>{var _0x524f08=_0x55ec69;_0x41bd6a[_0x4b5a0e][_0x524f08(0x1f9)]=_0x5510d2;}),_0x5ddeb9['forEach']((_0x4b7d0b,_0x5aa9f7)=>{var _0x1c8432=_0x55ec69;_0x41bd6a[_0x5aa9f7][_0x1c8432(0x1d4)]=_0x4b7d0b;}),_0x4941ed['forEach']((_0x4fa0a8,_0x2ed6cc)=>{_0x41bd6a[_0x2ed6cc]['storage']=_0x4fa0a8;}),_0x1c51f4['forEach']((_0x1fb0ce,_0xa1d90c)=>{_0x41bd6a[_0xa1d90c]['rack']=_0x1fb0ce;}),_0x2b4eb5['forEach']((_0xcd044f,_0x109a23)=>{var _0x3cacc2=_0x55ec69;_0x41bd6a[_0x109a23][_0x3cacc2(0x181)]=_0xcd044f;}),_0x258fad[_0x55ec69(0x21b)]((_0x494759,_0x364e7e)=>{var _0x15e6d7=_0x55ec69;_0x41bd6a[_0x364e7e][_0x15e6d7(0x242)]=_0x494759;}),_0x22b3b0[_0x55ec69(0x21b)]((_0x48d5ed,_0x3a4222)=>{var _0x2a2f7a=_0x55ec69;_0x41bd6a[_0x3a4222][_0x2a2f7a(0x198)]=_0x48d5ed;}),_0x40764a['forEach']((_0xc4aee9,_0x445f8b)=>{var _0x35ef85=_0x55ec69;_0x41bd6a[_0x445f8b][_0x35ef85(0x1bc)]=_0xc4aee9;});const _0x3aaa52=_0x41bd6a[_0x55ec69(0x226)](_0x2526c5=>_0x2526c5[_0x55ec69(0x1a4)]!=='0'&&_0x2526c5[_0x55ec69(0x1a4)]!==''||_0x2526c5[_0x55ec69(0x237)]!=='0'&&_0x2526c5[_0x55ec69(0x237)]!=='');var _0x81a5d3=0x0;_0x3aaa52[_0x55ec69(0x21b)](_0x57b3f6=>{var _0x4ada7e=_0x55ec69;parseInt(_0x57b3f6[_0x4ada7e(0x220)])<parseInt(_0x57b3f6[_0x4ada7e(0x1a4)])&&_0x81a5d3++;});if(_0x81a5d3!=0x0)return _0x352081[_0x55ec69(0x230)](_0x55ec69(0x1f5),_0x55ec69(0x232)),_0x5efe4d[_0x55ec69(0x1fd)](_0x55ec69(0x260));const _0x5ee288=await warehouse['findOne']({'name':_0x55c8e1[_0x55ec69(0x257)],'room':_0x55c8e1['from_room']});_0x55c8e1[_0x55ec69(0x22d)]['forEach'](_0x15776a=>{var _0x5b6f92=_0x55ec69;if(_0x15776a['to_quantity']>0x0){const _0x4c7f1c=_0x5ee288[_0x5b6f92(0x246)][_0x5b6f92(0x1df)](_0x7dc1e8=>{var _0x2ea14b=_0x5b6f92;_0x7dc1e8[_0x2ea14b(0x199)]==_0x15776a[_0x2ea14b(0x199)]&&_0x7dc1e8['floorlevel']==_0x15776a[_0x2ea14b(0x215)]&&_0x7dc1e8[_0x2ea14b(0x19e)]==_0x15776a[_0x2ea14b(0x181)]&&_0x7dc1e8[_0x2ea14b(0x210)]==_0x15776a[_0x2ea14b(0x1d6)]&&_0x7dc1e8[_0x2ea14b(0x190)]==_0x15776a[_0x2ea14b(0x1ec)]&&_0x7dc1e8[_0x2ea14b(0x25d)]==_0x15776a[_0x2ea14b(0x1bc)]&&_0x7dc1e8[_0x2ea14b(0x21c)]==_0x15776a[_0x2ea14b(0x198)]&&(_0x7dc1e8[_0x2ea14b(0x244)]=parseInt(_0x7dc1e8['product_stock'])+parseInt(_0x15776a['to_quantity']));});}}),await _0x5ee288[_0x55ec69(0x196)]();const _0x574af5=await warehouse[_0x55ec69(0x1b3)]({'name':_0x55c8e1[_0x55ec69(0x24a)],'room':_0x55c8e1[_0x55ec69(0x1b6)]});_0x55c8e1[_0x55ec69(0x22d)][_0x55ec69(0x21b)](_0x3e0fd5=>{var _0x43f3e7=_0x55ec69;if(_0x3e0fd5[_0x43f3e7(0x1a4)]>0x0){const _0x5ed1b1=_0x574af5[_0x43f3e7(0x246)][_0x43f3e7(0x1df)](_0x33e6eb=>{var _0x2d7ba8=_0x43f3e7;_0x33e6eb[_0x2d7ba8(0x199)]==_0x3e0fd5[_0x2d7ba8(0x199)]&&_0x33e6eb['floorlevel']==_0x3e0fd5[_0x2d7ba8(0x237)]&&_0x33e6eb[_0x2d7ba8(0x19e)]==_0x3e0fd5[_0x2d7ba8(0x242)]&&_0x33e6eb[_0x2d7ba8(0x210)]==_0x3e0fd5[_0x2d7ba8(0x177)]&&_0x33e6eb['bay']==_0x3e0fd5[_0x2d7ba8(0x1f3)]&&_0x33e6eb[_0x2d7ba8(0x25d)]==_0x3e0fd5[_0x2d7ba8(0x25d)]&&_0x33e6eb[_0x2d7ba8(0x21c)]==_0x3e0fd5[_0x2d7ba8(0x21c)]&&(_0x33e6eb[_0x2d7ba8(0x244)]=parseInt(_0x33e6eb['product_stock'])-parseInt(_0x3e0fd5[_0x2d7ba8(0x1a4)]));});}}),await _0x574af5[_0x55ec69(0x196)](),_0x55c8e1[_0x55ec69(0x182)]=_0x5a7dc,_0x55c8e1[_0x55ec69(0x257)]=_0x5c9cbd,_0x55c8e1['to_warehouse']=_0x16314d,_0x55c8e1['product']=_0x3aaa52,_0x55c8e1['note']=_0x131773,_0x55c8e1[_0x55ec69(0x183)]=_0x41c8b3;const _0x30052f=await _0x55c8e1[_0x55ec69(0x196)]();console[_0x55ec69(0x22e)](_0x30052f);const _0x9616db=await warehouse[_0x55ec69(0x1b3)]({'name':_0x5c9cbd,'room':_0x170d55});_0x30052f[_0x55ec69(0x22d)][_0x55ec69(0x21b)](_0x22ad61=>{var _0x3c34f8=_0x55ec69;if(_0x22ad61['to_quantity']>0x0){const _0x2d0540=_0x9616db[_0x3c34f8(0x246)][_0x3c34f8(0x1df)](_0xf8034c=>{var _0xd7c070=_0x3c34f8;_0xf8034c['product_name']==_0x22ad61[_0xd7c070(0x199)]&&_0xf8034c[_0xd7c070(0x231)]==_0x22ad61['from_floorlevel']&&_0xf8034c[_0xd7c070(0x19e)]==_0x22ad61[_0xd7c070(0x181)]&&_0xf8034c[_0xd7c070(0x210)]==_0x22ad61['from_bin']&&_0xf8034c['bay']==_0x22ad61[_0xd7c070(0x1ec)]&&_0xf8034c['rack']==_0x22ad61[_0xd7c070(0x1bc)]&&_0xf8034c[_0xd7c070(0x21c)]==_0x22ad61['from_storage']&&(_0xf8034c[_0xd7c070(0x244)]=parseInt(_0xf8034c[_0xd7c070(0x244)])-parseInt(_0x22ad61[_0xd7c070(0x1a4)]));});}}),await _0x9616db[_0x55ec69(0x196)]();const _0x2f1b81=await warehouse[_0x55ec69(0x1b3)]({'name':_0x16314d,'room':_0x52936d});_0x30052f[_0x55ec69(0x22d)][_0x55ec69(0x21b)](_0x210b6d=>{var _0x3b8cbc=_0x55ec69;if(_0x210b6d['to_quantity']>0x0){var _0x357f74=0x0;const _0x1d7125=_0x2f1b81[_0x3b8cbc(0x246)][_0x3b8cbc(0x1df)](_0x27189d=>{var _0x3188b2=_0x3b8cbc;_0x27189d['product_name']==_0x210b6d[_0x3188b2(0x199)]&&_0x27189d[_0x3188b2(0x231)]==_0x210b6d['to_floorlevel']&&_0x27189d['type']==_0x210b6d[_0x3188b2(0x242)]&&_0x27189d['bin']==_0x210b6d[_0x3188b2(0x177)]&&_0x27189d[_0x3188b2(0x190)]==_0x210b6d['to_bay']&&_0x27189d[_0x3188b2(0x25d)]==_0x210b6d[_0x3188b2(0x25d)]&&_0x27189d[_0x3188b2(0x21c)]==_0x210b6d[_0x3188b2(0x21c)]&&(_0x27189d[_0x3188b2(0x244)]=parseInt(_0x27189d['product_stock'])+parseInt(_0x210b6d[_0x3188b2(0x1a4)]),_0x357f74++);});_0x357f74=='0'&&(_0x2f1b81[_0x3b8cbc(0x246)]=_0x2f1b81['product_details'][_0x3b8cbc(0x245)]({'product_name':_0x210b6d['product_name'],'product_stock':_0x210b6d[_0x3b8cbc(0x1a4)],'bay':_0x210b6d[_0x3b8cbc(0x1f3)],'bin':_0x210b6d[_0x3b8cbc(0x177)],'type':_0x210b6d['to_types'],'floorlevel':_0x210b6d[_0x3b8cbc(0x237)],'storage':_0x210b6d[_0x3b8cbc(0x21c)],'rack':_0x210b6d['rack'],'product_code':_0x210b6d[_0x3b8cbc(0x23b)],'primary_code':_0x210b6d[_0x3b8cbc(0x213)],'secondary_code':_0x210b6d[_0x3b8cbc(0x17d)],'maxProducts':_0x210b6d[_0x3b8cbc(0x23a)],'storage':_0x210b6d['storage'],'rack':_0x210b6d[_0x3b8cbc(0x25d)]}));}}),await _0x2f1b81[_0x55ec69(0x196)](),_0x352081[_0x55ec69(0x230)](_0x55ec69(0x19b),_0x55ec69(0x1fa)),_0x5efe4d[_0x55ec69(0x1fd)](_0x55ec69(0x1fe));}catch(_0x339d2b){console['log'](_0x339d2b);}}),router[a0_0xce18d3(0x1a0)]('/barcode_scanner',async(_0x2e055c,_0x3ac2ee)=>{var _0x71e2f=a0_0xce18d3;const {FromWareHouse:_0x3b6f65,FromRoom:_0xa3d0dd,ToWarehouse:_0x45fce3,ToRoom:_0x17bb27,primary_code:_0x1f66f6,Roomslist:_0x1401a6}=_0x2e055c[_0x71e2f(0x1b2)],_0x3635a7=_0x1401a6[_0x71e2f(0x238)](','),_0x4b7e01=[];async function _0x9bc4e0(_0x497b1d){var _0x13de0e=_0x71e2f;const _0xcb1717=await warehouse[_0x13de0e(0x247)]([{'$match':{'name':_0x3b6f65,'room':_0x497b1d}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x1f66f6}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x13de0e(0x1a5)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x13de0e(0x224)},'secondary_code':{'$first':_0x13de0e(0x233)},'product_code':{'$first':_0x13de0e(0x259)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x13de0e(0x197)},'unit':{'$first':_0x13de0e(0x256)},'secondary_unit':{'$first':_0x13de0e(0x1b7)},'storage':{'$first':_0x13de0e(0x1d3)},'rack':{'$first':_0x13de0e(0x20f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x13de0e(0x18c)},'batch_code':{'$first':_0x13de0e(0x1db)},'maxPerUnit':{'$first':_0x13de0e(0x1d9)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x13de0e(0x252)},'maxProducts':{'$first':_0x13de0e(0x17e)},'invoice_product':{'$first':_0x13de0e(0x1f4)}}}]),_0x243fe9=await warehouse[_0x13de0e(0x247)]([{'$match':{'name':_0x3b6f65,'room':_0x497b1d}},{'$unwind':_0x13de0e(0x1b9)},{'$match':{'product_details.secondary_code':_0x1f66f6}},{'$group':{'_id':_0x13de0e(0x21f),'name':{'$first':_0x13de0e(0x1a5)},'instock':{'$first':_0x13de0e(0x202)},'primary_code':{'$first':_0x13de0e(0x224)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x13de0e(0x1d7)},'isle':{'$first':_0x13de0e(0x21d)},'type':{'$first':_0x13de0e(0x1a3)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x13de0e(0x256)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x13de0e(0x1d3)},'rack':{'$first':_0x13de0e(0x20f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x13de0e(0x18c)},'batch_code':{'$first':_0x13de0e(0x1db)},'maxPerUnit':{'$first':_0x13de0e(0x1d9)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x13de0e(0x1f4)}}}]);if(_0xcb1717[_0x13de0e(0x1ef)]>0x0)_0x4b7e01[_0x13de0e(0x212)](_0xcb1717);else _0x243fe9[_0x13de0e(0x1ef)]>0x0&&_0x4b7e01['push'](_0x243fe9);}const _0xb81acb=_0x3635a7[_0x71e2f(0x1df)](_0xfe35fb=>_0x9bc4e0(_0xfe35fb));await Promise['all'](_0xb81acb),_0x3ac2ee[_0x71e2f(0x217)](_0x4b7e01);}),router[a0_0xce18d3(0x1a0)](a0_0xce18d3(0x179),async(_0x5ca27e,_0x34de01)=>{var _0x507182=a0_0xce18d3;try{const {FromWareHouse:_0x17c4c8,FromRoom:_0x389ad7,ToWarehouse:_0x39977b,ToRoom:_0x1bd5cf,secondary_code:_0xcdbe42}=_0x5ca27e[_0x507182(0x1b2)],_0x57075f=await warehouse['aggregate']([{'$match':{'name':_0x17c4c8}},{'$unwind':_0x507182(0x1b9)},{'$match':{'product_details.secondary_code':_0xcdbe42}},{'$group':{'_id':_0x507182(0x21f),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x507182(0x224)},'secondary_code':{'$first':_0x507182(0x233)},'product_code':{'$first':_0x507182(0x259)},'instock':{'$first':_0x507182(0x202)},'warehouse':{'$first':_0x507182(0x205)},'level':{'$first':_0x507182(0x19c)},'isle':{'$first':_0x507182(0x240)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x507182(0x17e)},'unit':{'$first':'$product_details.unit'}}}]);_0x34de01[_0x507182(0x1af)](0xc8)['json'](_0x57075f);}catch(_0x53c3b7){_0x34de01[_0x507182(0x1af)](0x194)[_0x507182(0x217)]({'message':_0x53c3b7[_0x507182(0x201)]});}}),router[a0_0xce18d3(0x1a0)](a0_0xce18d3(0x21a),async(_0x59b763,_0xf92328)=>{var _0x1db538=a0_0xce18d3;try{const {FromWareHouse:_0x229f2d,FromRoom:_0x2bcf86,ToWarehouse:_0x145ee6,ToRoom:_0x3616b7,product_code:_0x4d4322}=_0x59b763[_0x1db538(0x1b2)],_0x37a3a1=await warehouse[_0x1db538(0x247)]([{'$match':{'name':_0x229f2d}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x4d4322}},{'$group':{'_id':_0x1db538(0x21f),'name':{'$first':_0x1db538(0x1a5)},'primary_code':{'$first':_0x1db538(0x224)},'secondary_code':{'$first':_0x1db538(0x233)},'product_code':{'$first':_0x1db538(0x259)},'instock':{'$first':_0x1db538(0x202)},'warehouse':{'$first':_0x1db538(0x205)},'level':{'$first':_0x1db538(0x19c)},'isle':{'$first':_0x1db538(0x240)},'pallet':{'$first':_0x1db538(0x1a1)},'maxProducts':{'$first':_0x1db538(0x17e)},'unit':{'$first':_0x1db538(0x256)}}}]);_0xf92328['status'](0xc8)[_0x1db538(0x217)](_0x37a3a1);}catch(_0x13b132){_0xf92328[_0x1db538(0x1af)](0x194)[_0x1db538(0x217)]({'message':_0x13b132['message']});}}),router[a0_0xce18d3(0x1a0)](a0_0xce18d3(0x24e),async(_0x1cb1ef,_0x221f4b)=>{var _0x4f0fa7=a0_0xce18d3;const {level:_0x4f3f54,isle:_0x795d5c,pallet:_0x13f1a2,warehouses:_0x10ea64,room:_0x5d52a4}=_0x1cb1ef[_0x4f0fa7(0x1b2)];try{const _0x4017b8=await warehouse[_0x4f0fa7(0x247)]([{'$match':{'name':_0x10ea64,'room':_0x5d52a4}},{'$unwind':_0x4f0fa7(0x1b9)},{'$match':{'product_details.level':parseInt(_0x4f3f54),'product_details.isle':_0x795d5c,'product_details.pallet':parseInt(_0x13f1a2)}},{'$group':{'_id':_0x4f0fa7(0x21f),'name':{'$first':_0x4f0fa7(0x1a5)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x4f0fa7(0x19c)},'isle':{'$first':_0x4f0fa7(0x240)},'pallet':{'$first':_0x4f0fa7(0x1a1)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x221f4b[_0x4f0fa7(0x1af)](0xc8)['json'](_0x4017b8);}catch(_0x2b26af){_0x221f4b['status'](0x194)[_0x4f0fa7(0x217)]({'message':_0x2b26af[_0x4f0fa7(0x201)]});}}),module['exports']=router;