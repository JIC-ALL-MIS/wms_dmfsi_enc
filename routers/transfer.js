var a0_0x2c49f8=a0_0x4b83;(function(_0x2ee8ba,_0x33c8ad){var _0x21ff85=a0_0x4b83,_0x47e3ee=_0x2ee8ba();while(!![]){try{var _0xe3501c=parseInt(_0x21ff85(0xc0))/0x1*(-parseInt(_0x21ff85(0xb2))/0x2)+parseInt(_0x21ff85(0xc7))/0x3*(parseInt(_0x21ff85(0x14d))/0x4)+-parseInt(_0x21ff85(0x10c))/0x5+-parseInt(_0x21ff85(0x160))/0x6*(-parseInt(_0x21ff85(0xb5))/0x7)+-parseInt(_0x21ff85(0x165))/0x8+parseInt(_0x21ff85(0xee))/0x9*(-parseInt(_0x21ff85(0x134))/0xa)+-parseInt(_0x21ff85(0x85))/0xb*(-parseInt(_0x21ff85(0x11e))/0xc);if(_0xe3501c===_0x33c8ad)break;else _0x47e3ee['push'](_0x47e3ee['shift']());}catch(_0x5c4f9b){_0x47e3ee['push'](_0x47e3ee['shift']());}}}(a0_0x3037,0x47cb6));const express=require('express'),app=express(),router=express[a0_0x2c49f8(0x161)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x2c49f8(0x122)),users=require(a0_0x2c49f8(0x112)),nodemailer=require(a0_0x2c49f8(0x89));router[a0_0x2c49f8(0x13b)](a0_0x2c49f8(0x121),auth,async(_0x1bdb4e,_0x302f85)=>{var _0x5d2cad=a0_0x2c49f8;try{const {username:_0x1948b4,email:_0x2cf35d,role:_0x1cebf1}=_0x1bdb4e[_0x5d2cad(0xbf)],_0x408b74=_0x1bdb4e[_0x5d2cad(0xbf)],_0x486fbe=await profile[_0x5d2cad(0xf8)]({'email':_0x408b74['email']}),_0x3fd86d=await master_shop[_0x5d2cad(0xca)]();console[_0x5d2cad(0xad)](_0x5d2cad(0x80),_0x3fd86d);let _0x3e87f4;if(_0x408b74[_0x5d2cad(0x7e)]=='staff'){const _0x3070d9=await staff[_0x5d2cad(0xf8)]({'email':_0x408b74[_0x5d2cad(0x153)]});_0x3e87f4=await transfers[_0x5d2cad(0xca)]({'from_warehouse':_0x3070d9[_0x5d2cad(0x11d)]});}else _0x3e87f4=await transfers[_0x5d2cad(0xf5)]([{'$unwind':_0x5d2cad(0xaa)},{'$group':{'_id':_0x5d2cad(0xe2),'invoice':{'$first':'$invoice'},'date':{'$first':_0x5d2cad(0x159)},'from_warehouse':{'$first':_0x5d2cad(0xdf)},'to_warehouse':{'$first':_0x5d2cad(0xa5)},'from_room_name':{'$addToSet':_0x5d2cad(0xdd)},'to_room_name':{'$addToSet':_0x5d2cad(0x15f)},'finalize':{'$first':_0x5d2cad(0x142)},'isAllowEdit':{'$first':_0x5d2cad(0x12a)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3fd86d[0x0]['language']=='English\x20(US)'){var _0x11ff57=users[_0x5d2cad(0xab)];console[_0x5d2cad(0xad)](_0x11ff57);}else{if(_0x3fd86d[0x0][_0x5d2cad(0xff)]==_0x5d2cad(0x8b))var _0x11ff57=users[_0x5d2cad(0x8b)];else{if(_0x3fd86d[0x0][_0x5d2cad(0xff)]==_0x5d2cad(0x97))var _0x11ff57=users['German'];else{if(_0x3fd86d[0x0][_0x5d2cad(0xff)]=='Spanish')var _0x11ff57=users[_0x5d2cad(0x77)];else{if(_0x3fd86d[0x0][_0x5d2cad(0xff)]==_0x5d2cad(0xd7))var _0x11ff57=users['French'];else{if(_0x3fd86d[0x0][_0x5d2cad(0xff)]=='Portuguese\x20(BR)')var _0x11ff57=users[_0x5d2cad(0x15b)];else{if(_0x3fd86d[0x0][_0x5d2cad(0xff)]=='Chinese')var _0x11ff57=users[_0x5d2cad(0xd2)];else{if(_0x3fd86d[0x0][_0x5d2cad(0xff)]=='Arabic\x20(ae)')var _0x11ff57=users['Arabic'];}}}}}}}_0x302f85[_0x5d2cad(0xe8)](_0x5d2cad(0xe9),{'success':_0x1bdb4e[_0x5d2cad(0xe3)](_0x5d2cad(0xc4)),'errors':_0x1bdb4e['flash'](_0x5d2cad(0x13d)),'role':_0x408b74,'profile':_0x486fbe,'master_shop':_0x3fd86d,'transfer':_0x3e87f4,'language':_0x11ff57});}catch(_0x5cc548){console[_0x5d2cad(0xad)](_0x5cc548);}});async function getRandom8DigitNumber(){var _0x292346=a0_0x2c49f8;const _0x2d0f77=0x989680,_0x3af660=0x5f5e0ff,_0x3f4ad9=Math[_0x292346(0xe4)](Math[_0x292346(0x130)]()*(_0x3af660-_0x2d0f77+0x1))+_0x2d0f77;var _0x148bd5;const _0x52c215=await transfers[_0x292346(0xf8)]({'invoice':_0x292346(0x146)+_0x3f4ad9});return _0x52c215&&_0x52c215[_0x292346(0xc8)]>0x0?_0x148bd5=_0x292346(0x146)+_0x3f4ad9:_0x148bd5=_0x292346(0x146)+_0x3f4ad9,_0x148bd5;}router[a0_0x2c49f8(0x13b)]('/view/add_transfer',auth,async(_0x555c54,_0x3b0504)=>{var _0x39514c=a0_0x2c49f8;try{const {username:_0x1032b5,email:_0x433261,role:_0x862b12}=_0x555c54[_0x39514c(0xbf)],_0x190c1e=_0x555c54[_0x39514c(0xbf)],_0x3d79b1=await profile[_0x39514c(0xf8)]({'email':_0x190c1e[_0x39514c(0x153)]}),_0x483623=await master_shop[_0x39514c(0xca)]();console['log'](_0x39514c(0x80),_0x483623);let _0x5821bc;if(_0x190c1e['role']=='staff'){const _0x1dbd52=await staff[_0x39514c(0xf8)]({'email':_0x190c1e[_0x39514c(0x153)]});_0x5821bc=await warehouse[_0x39514c(0xf5)]([{'$match':{'status':_0x39514c(0xdc),'name':_0x1dbd52['warehouse'],'warehouse_category':_0x39514c(0xc3)}},{'$group':{'_id':_0x39514c(0x86),'name':{'$first':_0x39514c(0x86)}}}]);}else _0x5821bc=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x39514c(0xc3)}},{'$group':{'_id':_0x39514c(0x86),'name':{'$first':_0x39514c(0x86)}}}]);var _0x4a5399=[_0x39514c(0x7b),'Enclosed',_0x39514c(0x137)];const _0x70a3d3=await transfers[_0x39514c(0xca)]({}),_0x4ba8c0=_0x70a3d3[_0x39514c(0xc8)]+0x1,_0x24f0ca=_0x39514c(0x146)+_0x4ba8c0[_0x39514c(0x9c)]()[_0x39514c(0x131)](0x5,'0');if(_0x483623[0x0]['language']=='English\x20(US)'){var _0x4c6458=users['English'];console[_0x39514c(0xad)](_0x4c6458);}else{if(_0x483623[0x0][_0x39514c(0xff)]==_0x39514c(0x8b))var _0x4c6458=users['Hindi'];else{if(_0x483623[0x0][_0x39514c(0xff)]==_0x39514c(0x97))var _0x4c6458=users['German'];else{if(_0x483623[0x0]['language']=='Spanish')var _0x4c6458=users[_0x39514c(0x77)];else{if(_0x483623[0x0][_0x39514c(0xff)]==_0x39514c(0xd7))var _0x4c6458=users['French'];else{if(_0x483623[0x0][_0x39514c(0xff)]==_0x39514c(0x149))var _0x4c6458=users[_0x39514c(0x15b)];else{if(_0x483623[0x0][_0x39514c(0xff)]==_0x39514c(0xd2))var _0x4c6458=users['Chinese'];else{if(_0x483623[0x0]['language']==_0x39514c(0xb6))var _0x4c6458=users[_0x39514c(0xda)];}}}}}}}const _0x344dfa=getRandom8DigitNumber();_0x344dfa[_0x39514c(0x8f)](_0x418e91=>{var _0x23aa99=_0x39514c;_0x3b0504[_0x23aa99(0xe8)](_0x23aa99(0xd0),{'success':_0x555c54[_0x23aa99(0xe3)](_0x23aa99(0xc4)),'errors':_0x555c54[_0x23aa99(0xe3)](_0x23aa99(0x13d)),'role':_0x190c1e,'profile':_0x3d79b1,'master_shop':_0x483623,'warehouse':_0x5821bc,'language':_0x4c6458,'rooms_data':_0x4a5399,'invoice':_0x418e91});})[_0x39514c(0x76)](_0x3308b7=>{var _0x4bd9f4=_0x39514c;_0x555c54[_0x4bd9f4(0xe3)](_0x4bd9f4(0x13d),_0x4bd9f4(0x7c)),_0x3b0504['redirect'](_0x4bd9f4(0x104));});}catch(_0x41a2f7){console['log'](_0x41a2f7);}}),router[a0_0x2c49f8(0x136)](a0_0x2c49f8(0x10a),auth,async(_0x4670ea,_0x6a967)=>{var _0x580d6e=a0_0x2c49f8;try{console['log'](_0x4670ea['body']);const {date:_0x2c45da,from_warehouse:_0x3cab90,FromRoom_name:_0x5bc449,to_warehouse:_0x2f0a0a,ToRoom_name:_0x124c7c,prod_name:_0x33200c,from_prod_qty:_0x45ca0a,from_prod_level:_0x14fdb6,from_prod_isle:_0x155a76,from_prod_pallet:_0x5ef68d,to_prod_qty:_0x4f2bc7,to_prod_level:_0x38c264,to_prod_isle:_0x136c23,to_prod_pallet:_0x49e72f,primary_code:_0x3ba519,secondary_code:_0x2230c2,product_code3:_0x1a406e,note:_0x300fd0,MaxStocks_data2:_0x6b5d36,invoice:_0x1a0dfc,expiry_date:_0x51da5e}=_0x4670ea[_0x580d6e(0x157)];if(typeof _0x33200c==_0x580d6e(0xbb))var _0x5d68e2=[_0x4670ea['body'][_0x580d6e(0xd5)]],_0x5c44d1=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x8c)]],_0x3a4005=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x9a)]],_0x3282a6=[_0x4670ea[_0x580d6e(0x157)]['New_Qty_Converted']],_0xd9d584=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x88)]],_0x5ed249=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x120)]],_0xb6da34=[_0x4670ea['body'][_0x580d6e(0x12b)]],_0x14a843=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0xa2)]],_0xd1ef52=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0xfa)]],_0x1a86cc=[_0x4670ea['body'][_0x580d6e(0x106)]],_0x542fdd=[_0x4670ea['body'][_0x580d6e(0x101)]],_0x84226e=[_0x4670ea['body'][_0x580d6e(0x103)]],_0x444138=[_0x4670ea['body'][_0x580d6e(0x117)]],_0x456e28=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x164)]],_0x5a8b8e=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x82)]],_0x5c2a71=[_0x4670ea['body'][_0x580d6e(0x100)]],_0x2916d3=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x133)]],_0x56b110=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x126)]],_0x3fc3f3=[_0x4670ea[_0x580d6e(0x157)]['from_invoice']],_0x45e227=[_0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x10e)]],_0x5ae25a=[_0x4670ea[_0x580d6e(0x157)]['id_transaction']];else var _0x5d68e2=[..._0x4670ea[_0x580d6e(0x157)]['prod_name']],_0x5c44d1=[..._0x4670ea['body']['from_prod_qty']],_0x3a4005=[..._0x4670ea[_0x580d6e(0x157)]['from_prod_level']],_0x3282a6=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0xf4)]],_0xd9d584=[..._0x4670ea['body'][_0x580d6e(0x88)]],_0x5ed249=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x120)]],_0xb6da34=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x12b)]],_0x14a843=[..._0x4670ea['body'][_0x580d6e(0xa2)]],_0xd1ef52=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0xfa)]],_0x1a86cc=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x106)]],_0x542fdd=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x101)]],_0x84226e=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x103)]],_0x444138=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x117)]],_0x456e28=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x164)]],_0x5a8b8e=[..._0x4670ea['body']['production_date']],_0x5c2a71=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x100)]],_0x2916d3=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x133)]],_0x56b110=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x126)]],_0x3fc3f3=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x129)]],_0x45e227=[..._0x4670ea['body']['to_invoice']],_0x5ae25a=[..._0x4670ea[_0x580d6e(0x157)][_0x580d6e(0x11f)]];const _0x11763a=_0x5d68e2[_0x580d6e(0x107)](_0xac2fa0=>{return _0xac2fa0={'product_name':_0xac2fa0};});_0x5c44d1[_0x580d6e(0xbe)]((_0x1d673c,_0x5dc158)=>{var _0xd48679=_0x580d6e;_0x11763a[_0x5dc158][_0xd48679(0x9f)]=_0x1d673c;}),_0x3fc3f3['forEach']((_0x4fb223,_0x4a1e5f)=>{var _0x4d842f=_0x580d6e;_0x11763a[_0x4a1e5f][_0x4d842f(0x129)]=_0x4fb223;}),_0x45e227['forEach']((_0x59c446,_0x12320d)=>{_0x11763a[_0x12320d]['To_invoice']=_0x59c446;}),_0x5ae25a[_0x580d6e(0xbe)]((_0x1d9001,_0x1ca995)=>{_0x11763a[_0x1ca995]['id_transaction_id']=_0x1d9001;}),_0x3a4005['forEach']((_0x1e4c81,_0x5f02d9)=>{var _0x2b209b=_0x580d6e;_0x2916d3[_0x2b209b(0xbe)]((_0x561ee5,_0xc13745)=>{var _0x418050=_0x2b209b;if(_0x561ee5==_0x418050(0x94)&&_0x5f02d9==_0xc13745){var _0x4b1aed=_0x1e4c81[_0x418050(0xa1)](0x3);_0x11763a[_0x5f02d9][_0x418050(0xfe)]=_0x1e4c81[0x0],_0x11763a[_0x5f02d9]['from_rack']=_0x1e4c81[0x1],_0x11763a[_0x5f02d9][_0x418050(0x139)]=0x0,_0x11763a[_0x5f02d9][_0x418050(0xc5)]=0x0,_0x11763a[_0x5f02d9]['from_types']=_0x418050(0x8a),_0x11763a[_0x5f02d9]['from_floorlevel']=_0x4b1aed;}else{if(_0x561ee5==_0x418050(0xb0)&&_0x5f02d9==_0xc13745){var _0x4b1aed=_0x1e4c81[_0x418050(0xa1)](0x3);_0x11763a[_0x5f02d9][_0x418050(0xfe)]=_0x1e4c81[0x0],_0x11763a[_0x5f02d9][_0x418050(0xef)]=_0x1e4c81[0x1],_0x11763a[_0x5f02d9][_0x418050(0x139)]=0x0,_0x11763a[_0x5f02d9]['from_bin']=0x0,_0x11763a[_0x5f02d9][_0x418050(0x90)]=_0x418050(0x8a),_0x11763a[_0x5f02d9][_0x418050(0x15a)]=_0x1e4c81[0x5];}else{if(_0x5f02d9==_0xc13745){if(_0x1e4c81[0x0]=='A'&&_0x1e4c81[0x1]=='L'&&_0x1e4c81[0x2]=='L')console['log'](_0x561ee5+'\x20<>\x20'+_0x5f02d9+'\x20<>\x20'+_0xc13745+_0x418050(0x13f)+_0x1e4c81+_0x418050(0x83)),_0x11763a[_0x5f02d9][_0x418050(0xfe)]=_0x1e4c81[0x0],_0x11763a[_0x5f02d9][_0x418050(0xef)]=_0x1e4c81[0x1],_0x11763a[_0x5f02d9][_0x418050(0x139)]=0x0,_0x11763a[_0x5f02d9][_0x418050(0xc5)]=0x0,_0x11763a[_0x5f02d9][_0x418050(0x90)]=_0x418050(0x8a),_0x11763a[_0x5f02d9]['from_floorlevel']=_0x1e4c81[0x3];else{var _0x1840f3;if(_0x1e4c81[0x4]=='L')_0x1840f3=_0x418050(0x9d);else _0x1e4c81[0x4]=='F'&&(_0x1840f3=_0x418050(0x8a));_0x11763a[_0x5f02d9][_0x418050(0xfe)]=_0x1e4c81[0x0],_0x11763a[_0x5f02d9][_0x418050(0xef)]=_0x1e4c81[0x1],_0x11763a[_0x5f02d9]['from_bay']=_0x1e4c81[0x2],_0x11763a[_0x5f02d9][_0x418050(0xc5)]=_0x1e4c81[0x3],_0x11763a[_0x5f02d9][_0x418050(0x90)]=_0x1840f3,_0x11763a[_0x5f02d9][_0x418050(0x15a)]=_0x1e4c81[0x5];}}}}});}),_0x3282a6[_0x580d6e(0xbe)]((_0x326975,_0xcca708)=>{_0x11763a[_0xcca708]['to_quantity']=_0x326975;}),_0xd9d584[_0x580d6e(0xbe)]((_0x33b034,_0x4f66c7)=>{var _0x375212=_0x580d6e;_0x56b110[_0x375212(0xbe)]((_0x1f95b3,_0x30bba5)=>{var _0x54ff23=_0x375212;if(_0x1f95b3==_0x54ff23(0x94)&&_0x4f66c7==_0x30bba5){var _0x391ed4=_0x33b034[_0x54ff23(0xa1)](0x3);_0x11763a[_0x4f66c7]['storage']=_0x33b034[0x0],_0x11763a[_0x4f66c7][_0x54ff23(0x12f)]=_0x33b034[0x1],_0x11763a[_0x4f66c7]['to_bay']=0x0,_0x11763a[_0x4f66c7][_0x54ff23(0xdb)]=0x0,_0x11763a[_0x4f66c7][_0x54ff23(0xe0)]=_0x54ff23(0x8a),_0x11763a[_0x4f66c7]['to_floorlevel']=_0x391ed4;}else{if(_0x1f95b3==_0x54ff23(0xb0)&&_0x4f66c7==_0x30bba5){var _0x391ed4=_0x33b034[_0x54ff23(0xa1)](0x3);_0x11763a[_0x4f66c7]['storage']=_0x33b034[0x0],_0x11763a[_0x4f66c7][_0x54ff23(0x12f)]=_0x33b034[0x1],_0x11763a[_0x4f66c7][_0x54ff23(0x12d)]=0x0,_0x11763a[_0x4f66c7]['to_bin']=0x0,_0x11763a[_0x4f66c7][_0x54ff23(0xe0)]=_0x54ff23(0x8a),_0x11763a[_0x4f66c7][_0x54ff23(0x155)]=_0x33b034[0x5];}else{if(_0x4f66c7==_0x30bba5){if(_0x33b034[0x0]=='A'&&_0x33b034[0x1]=='L'&&_0x33b034[0x2]=='L')console[_0x54ff23(0xad)](_0x1f95b3+_0x54ff23(0x13f)+_0x4f66c7+_0x54ff23(0x13f)+_0x30bba5+'\x20<>\x20'+_0x33b034+_0x54ff23(0x83)),_0x11763a[_0x4f66c7][_0x54ff23(0xbc)]=_0x33b034[0x0],_0x11763a[_0x4f66c7][_0x54ff23(0x12f)]=_0x33b034[0x1],_0x11763a[_0x4f66c7][_0x54ff23(0x12d)]=0x0,_0x11763a[_0x4f66c7][_0x54ff23(0xdb)]=0x0,_0x11763a[_0x4f66c7][_0x54ff23(0xe0)]=_0x54ff23(0x8a),_0x11763a[_0x4f66c7][_0x54ff23(0x155)]=_0x33b034[0x3];else{var _0x414b5b;if(_0x33b034[0x4]=='L')_0x414b5b=_0x54ff23(0x9d);else _0x33b034[0x4]=='F'&&(_0x414b5b=_0x54ff23(0x8a));_0x11763a[_0x4f66c7][_0x54ff23(0xbc)]=_0x33b034[0x0],_0x11763a[_0x4f66c7][_0x54ff23(0x12f)]=_0x33b034[0x1],_0x11763a[_0x4f66c7][_0x54ff23(0x12d)]=_0x33b034[0x2],_0x11763a[_0x4f66c7]['to_bin']=_0x33b034[0x3],_0x11763a[_0x4f66c7]['to_types']=_0x414b5b,_0x11763a[_0x4f66c7][_0x54ff23(0x155)]=_0x33b034[0x5];}}}}});}),_0x5ed249[_0x580d6e(0xbe)]((_0x1704ca,_0x1acc56)=>{_0x11763a[_0x1acc56]['primary_code']=_0x1704ca;}),_0xb6da34[_0x580d6e(0xbe)]((_0x4ea043,_0x1d54be)=>{_0x11763a[_0x1d54be]['secondary_code']=_0x4ea043;}),_0x14a843[_0x580d6e(0xbe)]((_0x555726,_0x1ae3b4)=>{var _0x43a0f9=_0x580d6e;_0x11763a[_0x1ae3b4][_0x43a0f9(0x154)]=_0x555726;}),_0xd1ef52['forEach']((_0x2e3fd1,_0x2c8689)=>{var _0x2e4e32=_0x580d6e;_0x11763a[_0x2c8689][_0x2e4e32(0x13c)]=_0x2e3fd1;}),_0x1a86cc[_0x580d6e(0xbe)]((_0xf06e1c,_0x5b0fc5)=>{var _0x56e88f=_0x580d6e;_0x11763a[_0x5b0fc5][_0x56e88f(0xea)]=_0xf06e1c;}),_0x542fdd[_0x580d6e(0xbe)]((_0x152d69,_0x5f3568)=>{var _0x449b74=_0x580d6e;_0x11763a[_0x5f3568][_0x449b74(0x101)]=_0x152d69;}),_0x84226e[_0x580d6e(0xbe)]((_0x570881,_0x59de61)=>{var _0x370051=_0x580d6e;_0x11763a[_0x59de61][_0x370051(0x103)]=_0x570881;}),_0x444138['forEach']((_0x3f0db5,_0x1118c5)=>{var _0x12d95e=_0x580d6e;_0x11763a[_0x1118c5][_0x12d95e(0x117)]=_0x3f0db5;}),_0x456e28['forEach']((_0x3bb87a,_0x457c17)=>{var _0x106622=_0x580d6e;_0x11763a[_0x457c17][_0x106622(0x143)]=_0x3bb87a;}),_0x5a8b8e[_0x580d6e(0xbe)]((_0x45f519,_0x3e2d85)=>{_0x11763a[_0x3e2d85]['production_date']=_0x45f519;}),_0x5c2a71[_0x580d6e(0xbe)]((_0x27668f,_0x118d62)=>{var _0x194436=_0x580d6e;_0x11763a[_0x118d62][_0x194436(0x100)]=_0x27668f;}),_0x2916d3['forEach']((_0x502e7c,_0x412de7)=>{var _0x5ab502=_0x580d6e;_0x11763a[_0x412de7][_0x5ab502(0xb8)]=_0x502e7c;}),_0x56b110[_0x580d6e(0xbe)]((_0x2cee5b,_0x283587)=>{_0x11763a[_0x283587]['to_room_name']=_0x2cee5b;});const _0x505958=_0x11763a[_0x580d6e(0x13a)](_0x361618=>_0x361618['to_quantity']!=='0'&&_0x361618[_0x580d6e(0xf0)]!==''||_0x361618[_0x580d6e(0x155)]!=='0'&&_0x361618[_0x580d6e(0x155)]!==''),_0x1c0562=new transfers({'date':_0x2c45da,'from_warehouse':_0x3cab90,'to_warehouse':_0x2f0a0a,'product':_0x505958,'note':_0x300fd0,'invoice':_0x1a0dfc}),_0x3bbe69=await _0x1c0562[_0x580d6e(0x14c)]();_0x4670ea[_0x580d6e(0xe3)](_0x580d6e(0xc4),'Product\x20Transfer\x20successfully'),_0x6a967[_0x580d6e(0x144)](_0x580d6e(0x135)+_0x3bbe69['_id']);}catch(_0x2f2304){console[_0x580d6e(0xad)](_0x2f2304),_0x6a967['status'](0xc8)[_0x580d6e(0x108)]({'errorMessage':_0x2f2304[_0x580d6e(0xd1)]});}}),router[a0_0x2c49f8(0x13b)](a0_0x2c49f8(0x162),auth,async(_0x4f5172,_0x21dba5)=>{var _0x95b1cf=a0_0x2c49f8;try{const {username:_0x25540b,email:_0xd86a3d,role:_0x39de16}=_0x4f5172[_0x95b1cf(0xbf)],_0x2a1ba4=_0x4f5172['user'],_0x1e74a2=await profile[_0x95b1cf(0xf8)]({'email':_0x2a1ba4[_0x95b1cf(0x153)]}),_0x425249=await master_shop[_0x95b1cf(0xca)]();console[_0x95b1cf(0xad)]('master',_0x425249);const _0x440d6a=await transfers[_0x95b1cf(0xa3)](_0x4f5172[_0x95b1cf(0xec)]['id']);let _0x2a33a4=new Date(_0x440d6a['expiry_date']),_0x321ee8=('0'+_0x2a33a4[_0x95b1cf(0x14e)]())[_0x95b1cf(0xa1)](-0x2),_0x525ed8=('0'+(_0x2a33a4[_0x95b1cf(0x158)]()+0x1))[_0x95b1cf(0xa1)](-0x2),_0x8be7c1=_0x2a33a4['getFullYear'](),_0x5dcfa9=_0x8be7c1+'-'+_0x525ed8+'-'+_0x321ee8,_0x596a7c;if(_0x2a1ba4[_0x95b1cf(0x7e)]=='staff'){const _0x12165f=await staff['findOne']({'email':_0x2a1ba4[_0x95b1cf(0x153)]});_0x596a7c=await warehouse[_0x95b1cf(0xca)]({'status':_0x95b1cf(0xdc),'name':_0x12165f[_0x95b1cf(0x11d)],'warehouse_category':_0x95b1cf(0xc3)});}else _0x596a7c=await warehouse[_0x95b1cf(0xca)]({'status':_0x95b1cf(0xdc),'warehouse_category':_0x95b1cf(0xc3)});const _0x50bc07=await warehouse[_0x95b1cf(0xf5)]([{'$match':{'name':_0x440d6a['from_warehouse']}},{'$unwind':_0x95b1cf(0x14f)},{'$group':{'_id':_0x95b1cf(0x128),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x95b1cf(0x156)},'bin':{'$first':_0x95b1cf(0xfd)},'type':{'$first':_0x95b1cf(0x138)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x95b1cf(0xcc)},'secondary_code':{'$first':_0x95b1cf(0xcf)},'product_code':{'$first':_0x95b1cf(0x92)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x95b1cf(0x115)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x95b1cf(0x102)},'room':{'$first':_0x95b1cf(0xba)}}}]);if(_0x425249[0x0][_0x95b1cf(0xff)]==_0x95b1cf(0x124)){var _0x465e77=users['English'];console[_0x95b1cf(0xad)](_0x465e77);}else{if(_0x425249[0x0][_0x95b1cf(0xff)]==_0x95b1cf(0x8b))var _0x465e77=users[_0x95b1cf(0x8b)];else{if(_0x425249[0x0][_0x95b1cf(0xff)]=='German')var _0x465e77=users[_0x95b1cf(0x97)];else{if(_0x425249[0x0][_0x95b1cf(0xff)]==_0x95b1cf(0x77))var _0x465e77=users[_0x95b1cf(0x77)];else{if(_0x425249[0x0][_0x95b1cf(0xff)]==_0x95b1cf(0xd7))var _0x465e77=users[_0x95b1cf(0xd7)];else{if(_0x425249[0x0][_0x95b1cf(0xff)]==_0x95b1cf(0x149))var _0x465e77=users[_0x95b1cf(0x15b)];else{if(_0x425249[0x0][_0x95b1cf(0xff)]==_0x95b1cf(0xd2))var _0x465e77=users[_0x95b1cf(0xd2)];else{if(_0x425249[0x0][_0x95b1cf(0xff)]=='Arabic\x20(ae)')var _0x465e77=users[_0x95b1cf(0xda)];}}}}}}}_0x21dba5[_0x95b1cf(0xe8)](_0x95b1cf(0xa8),{'success':_0x4f5172['flash']('success'),'errors':_0x4f5172[_0x95b1cf(0xe3)](_0x95b1cf(0x13d)),'role':_0x2a1ba4,'profile':_0x1e74a2,'master_shop':_0x425249,'warehouse':_0x596a7c,'transfer':_0x440d6a,'stock':_0x50bc07,'language':_0x465e77});}catch(_0x1b84cf){console[_0x95b1cf(0xad)](_0x1b84cf);}}),router[a0_0x2c49f8(0x136)]('/preview/:id',auth,async(_0x339440,_0xdd469c)=>{var _0x19b389=a0_0x2c49f8;try{const _0x160674=_0x339440[_0x19b389(0xec)]['id'],{from_warehouse:_0x2fcc6b,FromRoom_name:_0x2ab058,to_warehouse:_0x1cc957,ToRoom_name:_0x5d05b7}=_0x339440[_0x19b389(0x157)],_0x5b65a7=await transfers[_0x19b389(0xa3)]({'_id':_0x160674}),_0x3c2fe1=_0x5b65a7[_0x19b389(0x9e)][_0x19b389(0x107)](async _0x4ddeaf=>{var _0x22d929=_0x19b389;if(_0x4ddeaf[_0x22d929(0xf0)]>0x0){var _0x4dc819=await warehouse[_0x22d929(0xf8)]({'name':_0x5b65a7[_0x22d929(0xd3)],'room':_0x4ddeaf['from_room_name'],'warehouse_category':_0x22d929(0xc3)});const _0x45e94d=_0x4dc819['product_details'][_0x22d929(0x107)](_0x2ece12=>{var _0x51b121=_0x22d929;_0x2ece12['product_name']==_0x4ddeaf[_0x51b121(0xa7)]&&_0x2ece12[_0x51b121(0x123)]==_0x4ddeaf[_0x51b121(0x15a)]&&_0x2ece12['type']==_0x4ddeaf[_0x51b121(0x90)]&&_0x2ece12[_0x51b121(0x118)]==_0x4ddeaf['from_bin']&&_0x2ece12[_0x51b121(0xe5)]==_0x4ddeaf[_0x51b121(0x139)]&&_0x2ece12[_0x51b121(0x12f)]==_0x4ddeaf[_0x51b121(0xef)]&&_0x2ece12[_0x51b121(0xbc)]==_0x4ddeaf[_0x51b121(0xfe)]&&_0x2ece12[_0x51b121(0x117)]==_0x4ddeaf[_0x51b121(0x117)]&&_0x2ece12['batch_code']==_0x4ddeaf[_0x51b121(0x103)]&&_0x2ece12['production_date']==_0x4ddeaf[_0x51b121(0x82)]&&_0x2ece12[_0x51b121(0x98)]==_0x4ddeaf['from_invoice']&&_0x2ece12[_0x51b121(0x10d)]==_0x4ddeaf['id_transaction_id']&&(_0x2ece12[_0x51b121(0x12c)]=_0x2ece12[_0x51b121(0x12c)]-_0x4ddeaf['to_quantity']);});}return _0x4dc819;});Promise['all'](_0x3c2fe1)['then'](async _0x14a812=>{var _0x9bde3c=_0x19b389;try{for(const _0x345516 of _0x14a812){await _0x345516['save']();}try{const _0x549761=_0x5b65a7[_0x9bde3c(0x9e)]['map'](async _0x327f72=>{var _0x12736f=_0x9bde3c;if(_0x327f72[_0x12736f(0xf0)]>0x0){var _0x4a947e=await warehouse[_0x12736f(0xf8)]({'name':_0x5b65a7[_0x12736f(0xd9)],'room':_0x327f72[_0x12736f(0xc2)],'warehouse_category':_0x12736f(0xc3)}),_0x1869ed=0x0;const _0x2746a1=_0x4a947e['product_details'][_0x12736f(0x107)](_0xfec463=>{var _0x2e1d86=_0x12736f;_0xfec463[_0x2e1d86(0xa7)]==_0x327f72[_0x2e1d86(0xa7)]&&_0xfec463[_0x2e1d86(0x123)]==_0x327f72[_0x2e1d86(0x155)]&&_0xfec463['type']==_0x327f72[_0x2e1d86(0xe0)]&&_0xfec463[_0x2e1d86(0x118)]==_0x327f72[_0x2e1d86(0xdb)]&&_0xfec463[_0x2e1d86(0xe5)]==_0x327f72[_0x2e1d86(0x12d)]&&_0xfec463[_0x2e1d86(0x12f)]==_0x327f72[_0x2e1d86(0x12f)]&&_0xfec463[_0x2e1d86(0xbc)]==_0x327f72['storage']&&_0xfec463['expiry_date']==_0x327f72['expiry_date']&&_0xfec463[_0x2e1d86(0x103)]==_0x327f72[_0x2e1d86(0x103)]&&_0xfec463[_0x2e1d86(0x82)]==_0x327f72[_0x2e1d86(0x82)]&&_0xfec463['invoice']==_0x327f72[_0x2e1d86(0x127)]&&(_0xfec463[_0x2e1d86(0x12c)]=_0xfec463[_0x2e1d86(0x12c)]+_0x327f72['to_quantity'],_0x1869ed++);});_0x1869ed=='0'&&(_0x4a947e[_0x12736f(0xeb)]=_0x4a947e['product_details'][_0x12736f(0x148)]({'product_name':_0x327f72[_0x12736f(0xa7)],'product_stock':_0x327f72[_0x12736f(0xf0)],'bay':_0x327f72[_0x12736f(0x12d)],'bin':_0x327f72['to_bin'],'type':_0x327f72[_0x12736f(0xe0)],'floorlevel':_0x327f72[_0x12736f(0x155)],'storage':_0x327f72['storage'],'rack':_0x327f72[_0x12736f(0x12f)],'product_code':_0x327f72['product_code'],'primary_code':_0x327f72[_0x12736f(0x120)],'secondary_code':_0x327f72['secondary_code'],'maxProducts':_0x327f72['maxProducts'],'storage':_0x327f72['storage'],'rack':_0x327f72['rack'],'expiry_date':_0x327f72[_0x12736f(0x117)],'maxPerUnit':_0x327f72[_0x12736f(0x143)],'batch_code':_0x327f72[_0x12736f(0x103)],'production_date':_0x327f72[_0x12736f(0x82)]}));}return _0x4a947e;});Promise[_0x9bde3c(0xa4)](_0x549761)[_0x9bde3c(0x8f)](async _0x16cac2=>{var _0x2f8a84=_0x9bde3c;try{for(const _0xd10db6 of _0x16cac2){await warehouse['updateOne']({'_id':_0xd10db6['_id']},{'$addToSet':{'product_details':{'$each':_0xd10db6[_0x2f8a84(0xeb)]}}});}_0x5b65a7[_0x2f8a84(0x109)]='True';const _0x5efde3=await _0x5b65a7[_0x2f8a84(0x14c)](),_0x36bcb3=await master_shop[_0x2f8a84(0xca)](),_0x2b3167=await email_settings[_0x2f8a84(0xf8)](),_0xe6dcf5=await supervisor_settings[_0x2f8a84(0xca)]();var _0x5ccc96=_0x5b65a7[_0x2f8a84(0x9e)],_0x5103ee='',_0x145b42;for(_0x145b42 in _0x5ccc96){_0x5103ee+=_0x2f8a84(0x91)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5ccc96[_0x145b42][_0x2f8a84(0xa7)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5ccc96[_0x145b42][_0x2f8a84(0x154)]+_0x2f8a84(0x110)+_0x2f8a84(0xd4)+_0x5ccc96[_0x145b42][_0x2f8a84(0xf0)]+_0x2f8a84(0x110)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5ccc96[_0x145b42][_0x2f8a84(0xea)]+_0x2f8a84(0x110)+_0x2f8a84(0xd4)+_0x5ccc96[_0x145b42]['secondary_unit']+_0x2f8a84(0x110)+_0x2f8a84(0xd4)+_0x5b65a7[_0x2f8a84(0xd9)]+_0x2f8a84(0x110)+_0x2f8a84(0xd4)+_0x5ccc96[_0x145b42][_0x2f8a84(0xc2)]+'</td>'+_0x2f8a84(0xd4)+_0x5ccc96[_0x145b42][_0x2f8a84(0xbc)]+_0x5ccc96[_0x145b42][_0x2f8a84(0x12f)]+_0x5ccc96[_0x145b42][_0x2f8a84(0x12d)]+_0x5ccc96[_0x145b42]['to_bin']+_0x5ccc96[_0x145b42][_0x2f8a84(0xe0)][0x0]+_0x5ccc96[_0x145b42][_0x2f8a84(0x155)]+_0x2f8a84(0x110),_0x2f8a84(0xac);}let _0x1da7fc=nodemailer[_0x2f8a84(0xe1)]({'host':_0x2b3167['host'],'port':Number(_0x2b3167[_0x2f8a84(0xce)]),'secure':![],'auth':{'user':_0x2b3167[_0x2f8a84(0x153)],'pass':_0x2b3167[_0x2f8a84(0x84)]}}),_0x1baacb={'from':_0x2b3167[_0x2f8a84(0x153)],'to':_0xe6dcf5[0x0][_0x2f8a84(0xe7)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x2f8a84(0x87),'path':__dirname+'/../public'+_0x2f8a84(0x10b)+_0x36bcb3[0x0][_0x2f8a84(0xf3)],'cid':_0x2f8a84(0x8e)}],'html':_0x2f8a84(0x166)+'<html><head><title></title>'+'</head><body>'+_0x2f8a84(0x14a)+_0x2f8a84(0x96)+_0x2f8a84(0x14a)+_0x2f8a84(0x150)+_0x2f8a84(0xb3)+_0x2f8a84(0x14a)+'<h2>\x20'+_0x36bcb3[0x0][_0x2f8a84(0x116)]+_0x2f8a84(0xb7)+_0x2f8a84(0xb3)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x2f8a84(0x14a)+_0x2f8a84(0xb9)+'\x20Order\x20Number\x20:\x20'+_0x5b65a7['invoice']+'\x20'+_0x2f8a84(0x14b)+_0x2f8a84(0x12e)+_0x5b65a7['date']+'\x20'+'</span>'+_0x2f8a84(0x79)+_0x2f8a84(0xb3)+_0x2f8a84(0x147)+_0x2f8a84(0xf7)+_0x2f8a84(0x91)+_0x2f8a84(0x15c)+_0x2f8a84(0x151)+_0x2f8a84(0xcb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x2f8a84(0xf6)+_0x2f8a84(0x125)+_0x2f8a84(0xae)+_0x2f8a84(0xac)+_0x2f8a84(0x8d)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x5103ee+'\x20'+_0x2f8a84(0xa0)+_0x2f8a84(0x11a)+'<div>'+_0x2f8a84(0x111)+_0x2f8a84(0x105)+_0x36bcb3[0x0][_0x2f8a84(0x116)]+_0x2f8a84(0x79)+_0x2f8a84(0xb3)+_0x2f8a84(0xb3)+_0x2f8a84(0x7a)};_0x1da7fc['sendMail'](_0x1baacb,function(_0x4f95d4,_0x5bd13f){var _0x28790c=_0x2f8a84;_0x4f95d4?(console[_0x28790c(0xad)](_0x4f95d4),console[_0x28790c(0xad)](_0x28790c(0x10f))):console[_0x28790c(0xad)](_0x28790c(0x119));}),_0x339440[_0x2f8a84(0xe3)](_0x2f8a84(0xc4),_0x2f8a84(0xc6)),_0xdd469c[_0x2f8a84(0x144)](_0x2f8a84(0x81)+_0x5efde3[_0x2f8a84(0x10d)]);}catch(_0x4a2415){console[_0x2f8a84(0x99)](_0x4a2415),_0xdd469c[_0x2f8a84(0x15d)](0x1f4)['json']({'Perror':_0x2f8a84(0xf2),'message':_0x4a2415[_0x2f8a84(0xd1)]});}})['catch'](_0x3118aa=>{var _0x5d5326=_0x9bde3c;console[_0x5d5326(0x99)](_0x3118aa),_0xdd469c['status'](0x1f4)[_0x5d5326(0x108)]({'Perror':_0x5d5326(0x7d)});});}catch(_0x41b103){_0xdd469c[_0x9bde3c(0x108)](_0x41b103);}}catch(_0x27a898){console[_0x9bde3c(0x99)](_0x27a898),_0xdd469c['status'](0x1f4)[_0x9bde3c(0x108)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x27a898['message']});}})[_0x19b389(0x76)](_0x63ff47=>{var _0x102d72=_0x19b389;console[_0x102d72(0x99)](_0x63ff47),_0xdd469c[_0x102d72(0x15d)](0x1f4)[_0x102d72(0x108)]({'Merror':_0x102d72(0x7d)});});}catch(_0x22a082){console[_0x19b389(0xad)](_0x22a082);}});function a0_0x3037(){var _0x5f1082=['$product_details','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.batch_code','email','product_code','to_floorlevel','$product_details.bay','body','getMonth','$date','from_floorlevel','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','status','$product_details.expiry_date','$product.to_room_name','6GQThnf','Router','/preview/:id','/view/:id','max_per_unit','2769096XHagpb','<!DOCTYPE\x20html>','catch','Spanish','/CheckingWarehouse','</h5>','</body></html>','Ambient','There\x27s\x20a\x20error\x20in\x20this\x20transaction','An\x20error\x20occurred.','role','Transfer\x20Edit\x20Successfully','master','/picking_list/PDF_transfer_rm/','production_date','here','password','121UkqPFo','$name','Logo.png','to_prod_level','nodemailer','Floor','Hindi','from_prod_qty','</thead>','logo','then','from_types','<tr>','$product_details.product_code','to_prod_qty','Receiving\x20Area','staff','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','German','invoice','error','from_prod_level','$product_details.invoice','toString','Level','product','from_quantity','</tbody>','slice','product_code3','findById','all','$to_warehouse','type','product_name','edit_transfer_view','Rack\x20B','$product','English','</tr>','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.floorlevel','Shelves','$product_details.level','6dpAPWK','</div>','$product_details.isle','3944857momFpv','Arabic\x20(ae)','\x20</h2>','from_room_name','<h5\x20style=\x22text-align:\x20left;\x22>','$room','string','storage','push','forEach','user','154514KhCvQK','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','to_room_name','Raw\x20Materials','success','from_bin','Transfer\x20Finalize\x20Successfully','88104IqGiee','length','Rack\x20A','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.primary_code','$product_details.unit','port','$product_details.secondary_code','add_transfer','message','Chinese','from_warehouse','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','prod_name','/barcode_scanner2','French','$product_details.storage','to_warehouse','Arabic','to_bin','Enabled','$product.from_room_name','edit_transfer','$from_warehouse','to_types','createTransport','$_id','flash','floor','bay','from_rak','RMSEmail','render','transfer','unit','product_details','params','$product_details.product_stock','3026223MGUKFD','from_rack','to_quantity','$product_details.maxPerUnit','An\x20error\x20occurred\x20while\x20saving\x20data.','image','New_Qty_Converted','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','findOne','Rack\x20F','MaxStocks_data2','Rack\x20D','Rack\x20C','$product_details.bin','from_storage','language','prod_cat','secondary_unit','$product_details.production_date','batch_code','/transfer/view','<h5>','primary_unit','map','json','finalize','/view/add_transfer','/upload/','265330KTeZlj','_id','to_invoice','Error\x20Occurs','</td>','<strong>\x20Regards\x20</strong>','../public/language/languages.json','rak','$product_details.maxProducts','$product_details.rack','site_title','expiry_date','bin','Email\x20sent\x20successfully','</table>','split','back','warehouse','661596lSLIGh','id_transaction','primary_code','/view','../middleware/auth','floorlevel','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','ToRoomAssigned','To_invoice','$product_details._id','from_invoice','$isAllowEdit','secondary_code','product_stock','to_bay','\x20Order\x20Date\x20:\x20','rack','random','padStart','to_prod_isle','RoomAssigned','10BpxqFr','/transfer/preview/','post','Return\x20Rooms','$product_details.type','from_bay','filter','get','maxProducts','errors','note','\x20<>\x20','to_room','$product_details.pallet','$finalize','maxperunit','redirect','$product_details.product_name','TRF-','<table\x20style=\x22width:\x20100%\x20!important;\x22>','concat','Portuguese\x20(BR)','<div>','<span\x20style=\x22float:\x20right;\x22>','save','44mzTGiA','getDate'];a0_0x3037=function(){return _0x5f1082;};return a0_0x3037();}function BayBinSelected(_0x5ba045,_0x17b05b){var _0x449830=a0_0x2c49f8,_0x23f35b=[],_0x47b795=[],_0x241563=[],_0x8047b0=[],_0x3c8b12=[],_0x26832c=[];let _0x460224=[];if(_0x5ba045=='DRY\x20STORAGE')switch(_0x17b05b){case _0x449830(0xc9):_0x23f35b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x47b795=[0x1,0x2],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=[_0x449830(0x9d),_0x449830(0x8a)],_0x3c8b12=['D'],_0x26832c=['A'];break;case _0x449830(0xa9):_0x23f35b=[0x6,0x5,0x4,0x3,0x2,0x1],_0x47b795=[0x1,0x2],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=[_0x449830(0x9d),_0x449830(0x8a)],_0x3c8b12=['D'],_0x26832c=['B'];break;case _0x449830(0xb0):_0x23f35b=[0x0],_0x47b795=[0x0],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=[_0x449830(0x8a)],_0x3c8b12=['D'],_0x26832c=['S'];break;case _0x449830(0x94):_0x23f35b=[0x0],_0x47b795=[0x0],_0x8047b0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x241563=[_0x449830(0x8a)],_0x3c8b12=['D'],_0x26832c=['R'];break;}else{if(_0x5ba045=='COLD\x20STORAGE')switch(_0x17b05b){case _0x449830(0xc9):_0x23f35b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x47b795=['B','F'],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=['Level',_0x449830(0x8a)],_0x3c8b12=['C'],_0x26832c=['A'];break;case _0x449830(0xa9):_0x23f35b=[0x5,0x4,0x3,0x2,0x1],_0x47b795=['F','B','S'],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=[_0x449830(0x9d),'Floor'],_0x3c8b12=['C'],_0x26832c=['B'];break;case _0x449830(0xfc):_0x23f35b=[0x1,0x2,0x3,0x4,0x5],_0x47b795=['B','F','S'],_0x8047b0=[0x5,0x4,0x3,0x2,0x1],_0x241563=[_0x449830(0x9d),'Floor'],_0x3c8b12=['C'],_0x26832c=['C'];break;case _0x449830(0xfb):_0x23f35b=[0x5,0x4,0x3,0x2,0x1],_0x47b795=['F','B','S'],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=[_0x449830(0x9d),_0x449830(0x8a)],_0x3c8b12=['C'],_0x26832c=['D'];break;case'Rack\x20E':_0x23f35b=[0x4,0x3,0x2,0x1],_0x47b795=[0x1,0x2],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=[_0x449830(0x9d),'Floor'],_0x3c8b12=['C'],_0x26832c=['E'];break;case _0x449830(0xf9):_0x23f35b=[0x1,0x2,0x3],_0x47b795=[0x1,0x2],_0x8047b0=[0x1,0x2,0x3,0x4,0x5],_0x241563=['Level'],_0x3c8b12=['C'],_0x26832c=['F'];break;}}return{'levels':_0x23f35b,'Isle':_0x47b795,'rack':_0x8047b0,'type':_0x241563,'storage':_0x3c8b12,'rak':_0x26832c};}function a0_0x4b83(_0x1cec97,_0x4cb23f){var _0x303732=a0_0x3037();return a0_0x4b83=function(_0x4b839a,_0x4e0b5b){_0x4b839a=_0x4b839a-0x76;var _0x2065d7=_0x303732[_0x4b839a];return _0x2065d7;},a0_0x4b83(_0x1cec97,_0x4cb23f);}router['get']('/view/:id',auth,async(_0x5bd3a2,_0x4d6e34)=>{var _0x32a525=a0_0x2c49f8;try{const {username:_0x38cb40,email:_0x2a9dbd,role:_0x15fbaa}=_0x5bd3a2[_0x32a525(0xbf)],_0x5d722b=_0x5bd3a2[_0x32a525(0xbf)],_0x32b35b=await profile[_0x32a525(0xf8)]({'email':_0x5d722b[_0x32a525(0x153)]}),_0x5121fe=await master_shop['find'](),_0x5593b5=await transfers[_0x32a525(0xa3)](_0x5bd3a2[_0x32a525(0xec)]['id']);let _0x1427ad;if(_0x5d722b[_0x32a525(0x7e)]==_0x32a525(0x95)){const _0xb18baf=await staff[_0x32a525(0xf8)]({'email':_0x5d722b[_0x32a525(0x153)]});_0x1427ad=await warehouse['aggregate']([{'$match':{'status':_0x32a525(0xdc),'name':_0xb18baf[_0x32a525(0x11d)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x32a525(0x86),'name':{'$first':_0x32a525(0x86)}}}]);}else _0x1427ad=await warehouse[_0x32a525(0xf5)]([{'$match':{'status':_0x32a525(0xdc),'warehouse_category':_0x32a525(0xc3)}},{'$group':{'_id':_0x32a525(0x86),'name':{'$first':_0x32a525(0x86)}}}]);const _0x24896f=await warehouse['aggregate']([{'$match':{'name':_0x5593b5[_0x32a525(0xd3)],'warehouse_category':_0x32a525(0xc3)}},{'$unwind':_0x32a525(0x14f)},{'$group':{'_id':_0x32a525(0x128),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x32a525(0xed)},'bay':{'$first':_0x32a525(0x156)},'bin':{'$first':_0x32a525(0xfd)},'type':{'$first':_0x32a525(0x138)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x32a525(0xd8)},'rack':{'$first':_0x32a525(0x115)},'expiry_date':{'$first':_0x32a525(0x15e)},'production_date':{'$first':_0x32a525(0x102)},'room':{'$first':_0x32a525(0xba)}}}]),_0x4c0be6=await product[_0x32a525(0xca)]({}),_0x2f121d=BayBinSelected(_0x5593b5[_0x32a525(0xd9)],_0x5593b5['to_room']);if(_0x5121fe[0x0][_0x32a525(0xff)]=='English\x20(US)'){var _0x3b32b0=users['English'];console[_0x32a525(0xad)](_0x3b32b0);}else{if(_0x5121fe[0x0]['language']==_0x32a525(0x8b))var _0x3b32b0=users[_0x32a525(0x8b)];else{if(_0x5121fe[0x0][_0x32a525(0xff)]=='German')var _0x3b32b0=users[_0x32a525(0x97)];else{if(_0x5121fe[0x0][_0x32a525(0xff)]==_0x32a525(0x77))var _0x3b32b0=users[_0x32a525(0x77)];else{if(_0x5121fe[0x0]['language']==_0x32a525(0xd7))var _0x3b32b0=users['French'];else{if(_0x5121fe[0x0]['language']==_0x32a525(0x149))var _0x3b32b0=users['Portuguese'];else{if(_0x5121fe[0x0]['language']==_0x32a525(0xd2))var _0x3b32b0=users['Chinese'];else{if(_0x5121fe[0x0][_0x32a525(0xff)]==_0x32a525(0xb6))var _0x3b32b0=users['Arabic'];}}}}}}}_0x4d6e34['render'](_0x32a525(0xde),{'success':_0x5bd3a2[_0x32a525(0xe3)](_0x32a525(0xc4)),'errors':_0x5bd3a2[_0x32a525(0xe3)](_0x32a525(0x13d)),'role':_0x5d722b,'profile':_0x32b35b,'master_shop':_0x5121fe,'warehouse':_0x1427ad,'transfer':_0x5593b5,'stock':_0x24896f,'unit':_0x4c0be6,'language':_0x3b32b0});}catch(_0x212d08){console[_0x32a525(0xad)](_0x212d08);}}),router[a0_0x2c49f8(0x136)](a0_0x2c49f8(0x163),auth,async(_0x4f7cbd,_0xb56731)=>{var _0x578e57=a0_0x2c49f8;try{const _0x46cbfa=_0x4f7cbd[_0x578e57(0xec)]['id'],_0x835898=await transfers['findById'](_0x46cbfa);_0xb56731[_0x578e57(0x108)](_0x4f7cbd['body']);return;const {date:_0x12fbb1,from_warehouse:_0x2ca349,FromRoom_name:_0x367af6,to_warehouse:_0x46f5b,ToRoom_name:_0x35b7d7,prod_name:_0x482b84,from_prod_qty:_0x2ba5af,from_prod_level:_0x4d34e3,from_prod_isle:_0x2a4b27,from_prod_pallet:_0x2abec7,to_prod_qty:_0x759cac,to_prod_level:_0x2464ef,to_prod_isle:_0x55d4eb,to_prod_pallet:_0x3463a3,primary_code:_0x457326,secondary_code:_0x36d837,product_code3:_0x5a1b3b,note:_0x1479ee,invoice:_0x24c55f,expiry_date:_0x174d4b}=_0x4f7cbd[_0x578e57(0x157)];if(typeof _0x482b84==_0x578e57(0xbb))var _0x3876dd=[_0x4f7cbd['body']['prod_name']],_0x1ea4ef=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x8c)]],_0x4ba7bc=[_0x4f7cbd[_0x578e57(0x157)]['from_prod_level']],_0x1a7f49=[_0x4f7cbd[_0x578e57(0x157)]['from_prod_isle']],_0x35f2e9=[_0x4f7cbd[_0x578e57(0x157)]['from_prod_pallet']],_0x706252=[_0x4f7cbd[_0x578e57(0x157)]['from_types']],_0x5e4d6b=[_0x4f7cbd['body'][_0x578e57(0x93)]],_0x53822b=[_0x4f7cbd['body']['to_prod_level']],_0x1aa541=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x132)]],_0x23d1f2=[_0x4f7cbd['body']['to_prod_pallet']],_0x59fc0e=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xe0)]],_0x801ed6=[_0x4f7cbd['body']['storage']],_0xa736a3=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x113)]],_0x5b0c4a=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x120)]],_0x91315a=[_0x4f7cbd[_0x578e57(0x157)]['secondary_code']],_0x420213=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xa2)]],_0x4b9b75=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xfa)]],_0x187ce3=[_0x4f7cbd[_0x578e57(0x157)]['unit']],_0x505334=[_0x4f7cbd[_0x578e57(0x157)]['secondary_unit']],_0x2df938=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x103)]],_0x355306=[_0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x117)]],_0x1aa9dc=[_0x4f7cbd['body'][_0x578e57(0xfe)]],_0x181292=[_0x4f7cbd[_0x578e57(0x157)]['from_rak']];else var _0x3876dd=[..._0x4f7cbd['body']['prod_name']],_0x801ed6=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xbc)]],_0xa736a3=[..._0x4f7cbd['body'][_0x578e57(0x113)]],_0x706252=[..._0x4f7cbd['body']['from_types']],_0x59fc0e=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xe0)]],_0x1ea4ef=[..._0x4f7cbd[_0x578e57(0x157)]['from_prod_qty']],_0x4ba7bc=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x9a)]],_0x1a7f49=[..._0x4f7cbd[_0x578e57(0x157)]['from_prod_isle']],_0x35f2e9=[..._0x4f7cbd['body']['from_prod_pallet']],_0x5e4d6b=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x93)]],_0x53822b=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x88)]],_0x1aa541=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x132)]],_0x23d1f2=[..._0x4f7cbd['body']['to_prod_pallet']],_0x5b0c4a=[..._0x4f7cbd['body'][_0x578e57(0x120)]],_0x91315a=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x12b)]],_0x420213=[..._0x4f7cbd[_0x578e57(0x157)]['product_code3']],_0x4b9b75=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xfa)]],_0x187ce3=[..._0x4f7cbd[_0x578e57(0x157)]['unit']],_0x505334=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x101)]],_0x2df938=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x103)]],_0x355306=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0x117)]],_0x1aa9dc=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xfe)]],_0x181292=[..._0x4f7cbd[_0x578e57(0x157)][_0x578e57(0xe6)]];const _0x497099=_0x3876dd[_0x578e57(0x107)](_0x502647=>{return _0x502647={'product_name':_0x502647};});_0x1ea4ef['forEach']((_0x1292c3,_0x597c4b)=>{var _0x2144ba=_0x578e57;_0x497099[_0x597c4b][_0x2144ba(0x9f)]=_0x1292c3;}),_0x4ba7bc[_0x578e57(0xbe)]((_0x57831a,_0x1d2d2e)=>{var _0x2e1881=_0x578e57;_0x497099[_0x1d2d2e][_0x2e1881(0x139)]=_0x57831a;}),_0x1a7f49[_0x578e57(0xbe)]((_0x2dafcc,_0x398026)=>{var _0x38dadb=_0x578e57;_0x497099[_0x398026][_0x38dadb(0xc5)]=_0x2dafcc;}),_0x35f2e9['forEach']((_0x35f5db,_0x21d886)=>{var _0x4497bc=_0x578e57;_0x497099[_0x21d886][_0x4497bc(0x15a)]=_0x35f5db;}),_0x5e4d6b['forEach']((_0x24d00c,_0xdfd57)=>{_0x497099[_0xdfd57]['to_quantity']=_0x24d00c;}),_0x53822b[_0x578e57(0xbe)]((_0x3902b1,_0xf1de82)=>{var _0x5cbff0=_0x578e57;_0x497099[_0xf1de82][_0x5cbff0(0x12d)]=_0x3902b1;}),_0x1aa541[_0x578e57(0xbe)]((_0x1a8070,_0x23355e)=>{var _0xc5887a=_0x578e57;_0x497099[_0x23355e][_0xc5887a(0xdb)]=_0x1a8070;}),_0x23d1f2['forEach']((_0xd302c8,_0x7763c2)=>{var _0x5e81a8=_0x578e57;_0x497099[_0x7763c2][_0x5e81a8(0x155)]=_0xd302c8;}),_0x5b0c4a[_0x578e57(0xbe)]((_0x2bdc87,_0x2cf0c5)=>{var _0x3975e9=_0x578e57;_0x497099[_0x2cf0c5][_0x3975e9(0x120)]=_0x2bdc87;}),_0x91315a[_0x578e57(0xbe)]((_0x49558a,_0x376a72)=>{_0x497099[_0x376a72]['secondary_code']=_0x49558a;}),_0x420213[_0x578e57(0xbe)]((_0x395d7b,_0x1e09e8)=>{var _0xdb2a5d=_0x578e57;_0x497099[_0x1e09e8][_0xdb2a5d(0x154)]=_0x395d7b;}),_0x4b9b75[_0x578e57(0xbe)]((_0x148a1c,_0x284d68)=>{var _0x1fe495=_0x578e57;_0x497099[_0x284d68][_0x1fe495(0x13c)]=_0x148a1c;}),_0x187ce3[_0x578e57(0xbe)]((_0x238a19,_0xe34c3e)=>{var _0x35b19f=_0x578e57;_0x497099[_0xe34c3e][_0x35b19f(0xea)]=_0x238a19;}),_0x505334[_0x578e57(0xbe)]((_0x11eae4,_0x175b57)=>{var _0x282ea0=_0x578e57;_0x497099[_0x175b57][_0x282ea0(0x101)]=_0x11eae4;}),_0x2df938[_0x578e57(0xbe)]((_0x43c86f,_0x16cb65)=>{_0x497099[_0x16cb65]['batch_code']=_0x43c86f;}),_0x355306[_0x578e57(0xbe)]((_0x5612ed,_0x1243aa)=>{var _0x21e222=_0x578e57;_0x497099[_0x1243aa][_0x21e222(0x117)]=_0x5612ed;}),_0x801ed6[_0x578e57(0xbe)]((_0x3f3094,_0x397fc8)=>{var _0x127e82=_0x578e57;_0x497099[_0x397fc8][_0x127e82(0xbc)]=_0x3f3094;}),_0xa736a3[_0x578e57(0xbe)]((_0x516d40,_0x2c596a)=>{var _0x5274a0=_0x578e57;_0x497099[_0x2c596a][_0x5274a0(0x12f)]=_0x516d40;}),_0x706252[_0x578e57(0xbe)]((_0x412652,_0x5d58c3)=>{_0x497099[_0x5d58c3]['from_types']=_0x412652;}),_0x59fc0e[_0x578e57(0xbe)]((_0x5251d4,_0x1660ad)=>{var _0x394732=_0x578e57;_0x497099[_0x1660ad][_0x394732(0xe0)]=_0x5251d4;}),_0x1aa9dc[_0x578e57(0xbe)]((_0x56d48c,_0x1744ab)=>{var _0x35ef9d=_0x578e57;_0x497099[_0x1744ab][_0x35ef9d(0xfe)]=_0x56d48c;}),_0x181292[_0x578e57(0xbe)]((_0x430dc0,_0x12af09)=>{_0x497099[_0x12af09]['from_rack']=_0x430dc0;});const _0x203e37=_0x497099[_0x578e57(0x13a)](_0x3a2795=>_0x3a2795[_0x578e57(0xf0)]!=='0'&&_0x3a2795[_0x578e57(0xf0)]!==''||_0x3a2795[_0x578e57(0x155)]!=='0'&&_0x3a2795[_0x578e57(0x155)]!=='');var _0x6774b=0x0;_0x203e37[_0x578e57(0xbe)](_0xc0c208=>{var _0x2fa0ed=_0x578e57;parseInt(_0xc0c208[_0x2fa0ed(0x9f)])<parseInt(_0xc0c208[_0x2fa0ed(0xf0)])&&_0x6774b++;});if(_0x6774b!=0x0)return _0x4f7cbd[_0x578e57(0xe3)]('errors',_0x578e57(0xc1)),_0xb56731[_0x578e57(0x144)](_0x578e57(0x11c));const _0x5c9f7d=await warehouse['findOne']({'name':_0x835898[_0x578e57(0xd3)],'room':_0x835898['from_room']});_0x835898[_0x578e57(0x9e)][_0x578e57(0xbe)](_0x2a449d=>{var _0x503a71=_0x578e57;if(_0x2a449d[_0x503a71(0xf0)]>0x0){const _0x3d583f=_0x5c9f7d['product_details'][_0x503a71(0x107)](_0x2965f1=>{var _0x563d31=_0x503a71;_0x2965f1[_0x563d31(0xa7)]==_0x2a449d['product_name']&&_0x2965f1['floorlevel']==_0x2a449d[_0x563d31(0x15a)]&&_0x2965f1[_0x563d31(0xa6)]==_0x2a449d['from_types']&&_0x2965f1[_0x563d31(0x118)]==_0x2a449d[_0x563d31(0xc5)]&&_0x2965f1[_0x563d31(0xe5)]==_0x2a449d['from_bay']&&_0x2965f1[_0x563d31(0x12f)]==_0x2a449d[_0x563d31(0xef)]&&_0x2965f1[_0x563d31(0xbc)]==_0x2a449d[_0x563d31(0xfe)]&&(_0x2965f1[_0x563d31(0x12c)]=parseInt(_0x2965f1[_0x563d31(0x12c)])+parseInt(_0x2a449d['to_quantity']));});}}),await _0x5c9f7d[_0x578e57(0x14c)]();const _0x4b8bef=await warehouse[_0x578e57(0xf8)]({'name':_0x835898[_0x578e57(0xd9)],'room':_0x835898[_0x578e57(0x140)]});_0x835898[_0x578e57(0x9e)][_0x578e57(0xbe)](_0x114e17=>{var _0x3da1f7=_0x578e57;if(_0x114e17[_0x3da1f7(0xf0)]>0x0){const _0x181224=_0x4b8bef['product_details'][_0x3da1f7(0x107)](_0x4f79ec=>{var _0x500fff=_0x3da1f7;_0x4f79ec[_0x500fff(0xa7)]==_0x114e17[_0x500fff(0xa7)]&&_0x4f79ec[_0x500fff(0x123)]==_0x114e17[_0x500fff(0x155)]&&_0x4f79ec[_0x500fff(0xa6)]==_0x114e17['to_types']&&_0x4f79ec[_0x500fff(0x118)]==_0x114e17[_0x500fff(0xdb)]&&_0x4f79ec['bay']==_0x114e17[_0x500fff(0x12d)]&&_0x4f79ec[_0x500fff(0x12f)]==_0x114e17[_0x500fff(0x12f)]&&_0x4f79ec[_0x500fff(0xbc)]==_0x114e17['storage']&&(_0x4f79ec['product_stock']=parseInt(_0x4f79ec[_0x500fff(0x12c)])-parseInt(_0x114e17[_0x500fff(0xf0)]));});}}),await _0x4b8bef['save'](),_0x835898['date']=_0x12fbb1,_0x835898['from_warehouse']=_0x2ca349,_0x835898['to_warehouse']=_0x46f5b,_0x835898['product']=_0x203e37,_0x835898[_0x578e57(0x13e)]=_0x1479ee,_0x835898[_0x578e57(0x98)]=_0x24c55f;const _0x197dac=await _0x835898[_0x578e57(0x14c)]();console[_0x578e57(0xad)](_0x197dac);const _0x53db60=await warehouse[_0x578e57(0xf8)]({'name':_0x2ca349,'room':_0x367af6});_0x197dac[_0x578e57(0x9e)][_0x578e57(0xbe)](_0x198073=>{var _0xc355cd=_0x578e57;if(_0x198073['to_quantity']>0x0){const _0x37e3aa=_0x53db60[_0xc355cd(0xeb)][_0xc355cd(0x107)](_0x3c1843=>{var _0x15c9e9=_0xc355cd;_0x3c1843['product_name']==_0x198073['product_name']&&_0x3c1843[_0x15c9e9(0x123)]==_0x198073['from_floorlevel']&&_0x3c1843[_0x15c9e9(0xa6)]==_0x198073[_0x15c9e9(0x90)]&&_0x3c1843['bin']==_0x198073['from_bin']&&_0x3c1843['bay']==_0x198073[_0x15c9e9(0x139)]&&_0x3c1843['rack']==_0x198073[_0x15c9e9(0xef)]&&_0x3c1843[_0x15c9e9(0xbc)]==_0x198073[_0x15c9e9(0xfe)]&&(_0x3c1843[_0x15c9e9(0x12c)]=parseInt(_0x3c1843[_0x15c9e9(0x12c)])-parseInt(_0x198073['to_quantity']));});}}),await _0x53db60[_0x578e57(0x14c)]();const _0x17bf60=await warehouse['findOne']({'name':_0x46f5b,'room':_0x35b7d7});_0x197dac[_0x578e57(0x9e)]['forEach'](_0x3f8d75=>{var _0x4cc2a0=_0x578e57;if(_0x3f8d75[_0x4cc2a0(0xf0)]>0x0){var _0x1d5606=0x0;const _0xd74096=_0x17bf60['product_details'][_0x4cc2a0(0x107)](_0x1fd4b9=>{var _0x10eeff=_0x4cc2a0;_0x1fd4b9[_0x10eeff(0xa7)]==_0x3f8d75[_0x10eeff(0xa7)]&&_0x1fd4b9['floorlevel']==_0x3f8d75['to_floorlevel']&&_0x1fd4b9[_0x10eeff(0xa6)]==_0x3f8d75['to_types']&&_0x1fd4b9[_0x10eeff(0x118)]==_0x3f8d75[_0x10eeff(0xdb)]&&_0x1fd4b9['bay']==_0x3f8d75[_0x10eeff(0x12d)]&&_0x1fd4b9[_0x10eeff(0x12f)]==_0x3f8d75['rack']&&_0x1fd4b9['storage']==_0x3f8d75['storage']&&(_0x1fd4b9['product_stock']=parseInt(_0x1fd4b9['product_stock'])+parseInt(_0x3f8d75[_0x10eeff(0xf0)]),_0x1d5606++);});_0x1d5606=='0'&&(_0x17bf60[_0x4cc2a0(0xeb)]=_0x17bf60[_0x4cc2a0(0xeb)][_0x4cc2a0(0x148)]({'product_name':_0x3f8d75[_0x4cc2a0(0xa7)],'product_stock':_0x3f8d75[_0x4cc2a0(0xf0)],'bay':_0x3f8d75['to_bay'],'bin':_0x3f8d75['to_bin'],'type':_0x3f8d75['to_types'],'floorlevel':_0x3f8d75['to_floorlevel'],'storage':_0x3f8d75[_0x4cc2a0(0xbc)],'rack':_0x3f8d75[_0x4cc2a0(0x12f)],'product_code':_0x3f8d75[_0x4cc2a0(0x154)],'primary_code':_0x3f8d75['primary_code'],'secondary_code':_0x3f8d75[_0x4cc2a0(0x12b)],'maxProducts':_0x3f8d75[_0x4cc2a0(0x13c)],'storage':_0x3f8d75['storage'],'rack':_0x3f8d75['rack']}));}}),await _0x17bf60[_0x578e57(0x14c)](),_0x4f7cbd['flash']('success',_0x578e57(0x7f)),_0xb56731[_0x578e57(0x144)]('/transfer/view');}catch(_0x1549bd){console['log'](_0x1549bd);}}),router[a0_0x2c49f8(0x136)]('/barcode_scanner',async(_0x2c8ad0,_0x3cba0b)=>{var _0x2e0392=a0_0x2c49f8;const {FromWareHouse:_0x19758d,FromRoom:_0x3a39bb,ToWarehouse:_0x16d902,ToRoom:_0x239f1f,primary_code:_0x5ec93d,Roomslist:_0x137c00}=_0x2c8ad0['body'],_0x3ed0bf=_0x137c00[_0x2e0392(0x11b)](','),_0x36dbef=[];async function _0x5ca067(_0x378827){var _0x243270=_0x2e0392;const _0x1cdd27=await warehouse[_0x243270(0xf5)]([{'$match':{'name':_0x19758d,'room':_0x378827}},{'$unwind':_0x243270(0x14f)},{'$match':{'product_details.primary_code':_0x5ec93d}},{'$group':{'_id':_0x243270(0x128),'name':{'$first':_0x243270(0x145)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x243270(0xcc)},'secondary_code':{'$first':_0x243270(0xcf)},'product_code':{'$first':_0x243270(0x92)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x243270(0xfd)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x243270(0xaf)},'unit':{'$first':_0x243270(0xcd)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x243270(0xd8)},'rack':{'$first':_0x243270(0x115)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x243270(0x102)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x243270(0xf1)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x243270(0xba)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x243270(0x9b)}}}]),_0x90f7bb=await warehouse['aggregate']([{'$match':{'name':_0x19758d,'room':_0x378827}},{'$unwind':_0x243270(0x14f)},{'$match':{'product_details.secondary_code':_0x5ec93d}},{'$group':{'_id':_0x243270(0x128),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x243270(0xed)},'primary_code':{'$first':_0x243270(0xcc)},'secondary_code':{'$first':_0x243270(0xcf)},'product_code':{'$first':_0x243270(0x92)},'level':{'$first':_0x243270(0x156)},'isle':{'$first':_0x243270(0xfd)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x243270(0xaf)},'unit':{'$first':_0x243270(0xcd)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x243270(0x15e)},'production_date':{'$first':_0x243270(0x102)},'batch_code':{'$first':_0x243270(0x152)},'maxPerUnit':{'$first':_0x243270(0xf1)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x243270(0xba)},'maxProducts':{'$first':_0x243270(0x114)},'invoice_product':{'$first':_0x243270(0x9b)}}}]);if(_0x1cdd27['length']>0x0)_0x36dbef[_0x243270(0xbd)](_0x1cdd27);else _0x90f7bb['length']>0x0&&_0x36dbef[_0x243270(0xbd)](_0x90f7bb);}const _0x5daa15=_0x3ed0bf[_0x2e0392(0x107)](_0x299b79=>_0x5ca067(_0x299b79));await Promise[_0x2e0392(0xa4)](_0x5daa15),_0x3cba0b[_0x2e0392(0x108)](_0x36dbef);}),router[a0_0x2c49f8(0x136)](a0_0x2c49f8(0xd6),async(_0x543a82,_0x4109bd)=>{var _0x24a1fc=a0_0x2c49f8;try{const {FromWareHouse:_0x48fc49,FromRoom:_0x10c5b5,ToWarehouse:_0x1de9ae,ToRoom:_0x37275b,secondary_code:_0x4c9937}=_0x543a82[_0x24a1fc(0x157)],_0x1cc47b=await warehouse['aggregate']([{'$match':{'name':_0x48fc49}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4c9937}},{'$group':{'_id':_0x24a1fc(0x128),'name':{'$first':_0x24a1fc(0x145)},'primary_code':{'$first':_0x24a1fc(0xcc)},'secondary_code':{'$first':_0x24a1fc(0xcf)},'product_code':{'$first':_0x24a1fc(0x92)},'instock':{'$first':_0x24a1fc(0xed)},'warehouse':{'$first':_0x24a1fc(0x86)},'level':{'$first':_0x24a1fc(0xb1)},'isle':{'$first':_0x24a1fc(0xb4)},'pallet':{'$first':_0x24a1fc(0x141)},'maxProducts':{'$first':_0x24a1fc(0x114)},'unit':{'$first':_0x24a1fc(0xcd)}}}]);_0x4109bd[_0x24a1fc(0x15d)](0xc8)['json'](_0x1cc47b);}catch(_0xca5fe0){_0x4109bd[_0x24a1fc(0x15d)](0x194)[_0x24a1fc(0x108)]({'message':_0xca5fe0[_0x24a1fc(0xd1)]});}}),router[a0_0x2c49f8(0x136)]('/barcode_scanner3',async(_0xf4c604,_0x121c3a)=>{var _0x16fb0b=a0_0x2c49f8;try{const {FromWareHouse:_0xc17fcf,FromRoom:_0x36eabe,ToWarehouse:_0x3df22a,ToRoom:_0x17104c,product_code:_0x63f398}=_0xf4c604[_0x16fb0b(0x157)],_0x4ddce7=await warehouse[_0x16fb0b(0xf5)]([{'$match':{'name':_0xc17fcf}},{'$unwind':_0x16fb0b(0x14f)},{'$match':{'product_details.product_code':_0x63f398}},{'$group':{'_id':_0x16fb0b(0x128),'name':{'$first':_0x16fb0b(0x145)},'primary_code':{'$first':_0x16fb0b(0xcc)},'secondary_code':{'$first':_0x16fb0b(0xcf)},'product_code':{'$first':_0x16fb0b(0x92)},'instock':{'$first':_0x16fb0b(0xed)},'warehouse':{'$first':_0x16fb0b(0x86)},'level':{'$first':_0x16fb0b(0xb1)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x16fb0b(0x114)},'unit':{'$first':_0x16fb0b(0xcd)}}}]);_0x121c3a[_0x16fb0b(0x15d)](0xc8)[_0x16fb0b(0x108)](_0x4ddce7);}catch(_0xd81ea7){_0x121c3a[_0x16fb0b(0x15d)](0x194)[_0x16fb0b(0x108)]({'message':_0xd81ea7[_0x16fb0b(0xd1)]});}}),router[a0_0x2c49f8(0x136)](a0_0x2c49f8(0x78),async(_0x35617a,_0x5c5470)=>{var _0x494e40=a0_0x2c49f8;const {level:_0x50aeb4,isle:_0x1724cc,pallet:_0x4b9a76,warehouses:_0x26774e,room:_0x1fae9a}=_0x35617a[_0x494e40(0x157)];try{const _0x2fa85a=await warehouse[_0x494e40(0xf5)]([{'$match':{'name':_0x26774e,'room':_0x1fae9a}},{'$unwind':_0x494e40(0x14f)},{'$match':{'product_details.level':parseInt(_0x50aeb4),'product_details.isle':_0x1724cc,'product_details.pallet':parseInt(_0x4b9a76)}},{'$group':{'_id':_0x494e40(0x128),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x494e40(0xb1)},'isle':{'$first':_0x494e40(0xb4)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x494e40(0x114)}}}]);_0x5c5470['status'](0xc8)[_0x494e40(0x108)](_0x2fa85a);}catch(_0xc99fea){_0x5c5470[_0x494e40(0x15d)](0x194)[_0x494e40(0x108)]({'message':_0xc99fea['message']});}}),module['exports']=router;