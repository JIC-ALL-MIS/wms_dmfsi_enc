var a0_0xff52d4=a0_0x28f8;(function(_0x4cf080,_0x15333c){var _0x27cf40=a0_0x28f8,_0x55782e=_0x4cf080();while(!![]){try{var _0x36c34=-parseInt(_0x27cf40(0x118))/0x1*(-parseInt(_0x27cf40(0x11f))/0x2)+parseInt(_0x27cf40(0x12a))/0x3+parseInt(_0x27cf40(0xf0))/0x4*(parseInt(_0x27cf40(0x155))/0x5)+parseInt(_0x27cf40(0x127))/0x6*(-parseInt(_0x27cf40(0xf6))/0x7)+parseInt(_0x27cf40(0x101))/0x8+parseInt(_0x27cf40(0xd4))/0x9+parseInt(_0x27cf40(0x136))/0xa*(-parseInt(_0x27cf40(0x124))/0xb);if(_0x36c34===_0x15333c)break;else _0x55782e['push'](_0x55782e['shift']());}catch(_0x480262){_0x55782e['push'](_0x55782e['shift']());}}}(a0_0x401c,0x3e499));const express=require(a0_0xff52d4(0x14e)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0xff52d4(0x143)),auth=require(a0_0xff52d4(0x12f)),users=require(a0_0xff52d4(0x96)),nodemailer=require(a0_0xff52d4(0xda));function a0_0x28f8(_0x2b1cdb,_0x17e6cf){var _0x401cdb=a0_0x401c();return a0_0x28f8=function(_0x28f833,_0x33fefb){_0x28f833=_0x28f833-0x8b;var _0x13ab3d=_0x401cdb[_0x28f833];return _0x13ab3d;},a0_0x28f8(_0x2b1cdb,_0x17e6cf);}router['get'](a0_0xff52d4(0x16e),auth,async(_0x26b2ae,_0x5672b1)=>{var _0x449569=a0_0xff52d4;try{const {username:_0x43d538,email:_0x4cc6e4,role:_0x14817a}=_0x26b2ae[_0x449569(0x145)],_0xe8541c=_0x26b2ae[_0x449569(0x145)],_0x2b781d=await profile['findOne']({'email':_0xe8541c[_0x449569(0xce)]}),_0x4a3917=await master_shop[_0x449569(0x17b)]();console[_0x449569(0x146)](_0x449569(0xe4),_0x4a3917);let _0x2cc937;if(_0xe8541c['role']==_0x449569(0x133)){const _0x118ae6=await staff[_0x449569(0xcc)]({'email':_0xe8541c[_0x449569(0xce)]});_0x2cc937=await transfers['find']({'from_warehouse':_0x118ae6['warehouse']});}else _0x2cc937=await transfers[_0x449569(0x162)]([{'$unwind':'$product'},{'$group':{'_id':_0x449569(0x17e),'invoice':{'$first':_0x449569(0xf8)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x449569(0x138)},'to_warehouse':{'$first':_0x449569(0xc4)},'from_room_name':{'$addToSet':_0x449569(0xcf)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x449569(0x95)},'isAllowEdit':{'$first':_0x449569(0x114)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4a3917[0x0][_0x449569(0xcb)]==_0x449569(0x15f)){var _0xa757dc=users['English'];console[_0x449569(0x146)](_0xa757dc);}else{if(_0x4a3917[0x0][_0x449569(0xcb)]==_0x449569(0x159))var _0xa757dc=users[_0x449569(0x159)];else{if(_0x4a3917[0x0][_0x449569(0xcb)]==_0x449569(0x15a))var _0xa757dc=users['German'];else{if(_0x4a3917[0x0]['language']==_0x449569(0x91))var _0xa757dc=users[_0x449569(0x91)];else{if(_0x4a3917[0x0][_0x449569(0xcb)]=='French')var _0xa757dc=users[_0x449569(0x14f)];else{if(_0x4a3917[0x0]['language']==_0x449569(0x105))var _0xa757dc=users['Portuguese'];else{if(_0x4a3917[0x0][_0x449569(0xcb)]==_0x449569(0x132))var _0xa757dc=users['Chinese'];else{if(_0x4a3917[0x0][_0x449569(0xcb)]==_0x449569(0xca))var _0xa757dc=users[_0x449569(0x139)];}}}}}}}_0x5672b1[_0x449569(0x10c)](_0x449569(0x164),{'success':_0x26b2ae[_0x449569(0x149)](_0x449569(0xfd)),'errors':_0x26b2ae[_0x449569(0x149)](_0x449569(0x104)),'role':_0xe8541c,'profile':_0x2b781d,'master_shop':_0x4a3917,'transfer':_0x2cc937,'language':_0xa757dc});}catch(_0x244f91){console[_0x449569(0x146)](_0x244f91);}});function a0_0x401c(){var _0x184baf=['exports','Ambient','from_prod_pallet','rak','forEach','redirect','createTransport','$product_details.isle','id_transaction_id','sendMail','$product_details.primary_code','type','unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','slice','Logo.png','to_warehouse','$product_details.production_date','$product_details.invoice','TRF-','save','<html><head><title></title>','getFullYear','error','rack','from_prod_level','Transfer\x20Edit\x20Successfully','Enabled','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.maxProducts','Rack\x20C','edit_transfer_view','from_types','/view/:id','Rack\x20E','product_name','$to_warehouse','</td>','$product_details._id','</h5>','Rack\x20B','prod_name','Arabic\x20(ae)','language','findOne','role','email','$product.from_room_name','to_quantity','$product_details.bin','$product_details.expiry_date','image','585900wXUiUA','_id','$product_details.unit','</div>','Enclosed','status','nodemailer','</body></html>','from_prod_isle','product','Floor','$product_details.floorlevel','product_code3','random','\x20Order\x20Number\x20:\x20','to_prod_pallet','master','from_storage','from_bay','RMSEmail','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','floorlevel','<span\x20style=\x22float:\x20right;\x22>','RoomAssigned','<div>','product_code','916QUWFjo','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','string','catch','21497cAUttd','storage','$invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','body','secondary_code','get','success','product_details','Shelves','$product_details.maxPerUnit','1629080EjRtai','<h5\x20style=\x22text-align:\x20left;\x22>','add_transfer','errors','Portuguese\x20(BR)','warehouse','from_bin','host','from_warehouse','to_room','padStart','render','expiry_date','/view/add_transfer','An\x20error\x20occurred\x20while\x20saving\x20data.','/barcode_scanner','bin','here','maxperunit','$isAllowEdit','Rack\x20F','$room','edit_transfer','214237wzJzID','from_quantity','logo','primary_unit','$product_details.pallet','New_Qty_Converted','back','2rXQxql','Level','post','getMonth','English','1113233gfQMsm','\x20<>\x20','to_types','84KVveFd','params','then','841122uKKyXw','Return\x20Rooms','push','findById','$product_details.secondary_code','../middleware/auth','/preview/:id','</tbody>','Chinese','staff','<!DOCTYPE\x20html>','from_room_name','70HqBuMy','to_floorlevel','$from_warehouse','Arabic','Error\x20Occurs','finalize','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$name','Portuguese','message','/barcode_scanner2','<tr>','from_room','../models/all_models','from_prod_qty','user','log','</thead>','An\x20error\x20occurred.','flash','$product_details.type','/upload/','ToRoomAssigned','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','express','French','Transfer\x20Mail','map','to_prod_level','all','$product_details','5310GJkOrt','id_transaction','Transfer\x20Finalize\x20Successfully','/transfer/preview/','Hindi','German','$product_details.product_stock','to_room_name','Receiving\x20Area','</table>','English\x20(US)','$product_details.product_name','toString','aggregate','to_bay','transfer','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','site_title','/transfer/view','secondary_unit','</span>','primary_code','</head><body>','/view','$product_details.batch_code','$product_details.level','COLD\x20STORAGE','$product_details.storage','prod_cat','to_bin','to_prod_isle','production_date','Rack\x20D','maxProducts','to_invoice','<hr\x20class=\x22my-3\x22>','find','<h2>\x20','to_prod_qty','$_id','Raw\x20Materials','password','bay','json','\x20</h2>','date','DRY\x20STORAGE','<h5>','$product_details.product_code','updateOne','length','Email\x20sent\x20successfully','Spanish','\x20Order\x20Date\x20:\x20','from_rack','product_stock','$finalize','../public/language/languages.json','from_floorlevel','MaxStocks_data2','batch_code','$product_details.secondary_unit','floor','from_invoice','To_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_rak'];a0_0x401c=function(){return _0x184baf;};return a0_0x401c();}async function getRandom8DigitNumber(){var _0x7b55b7=a0_0xff52d4;const _0xaf31dc=0x989680,_0x1a7e5d=0x5f5e0ff,_0x10f690=Math[_0x7b55b7(0x9b)](Math[_0x7b55b7(0xe1)]()*(_0x1a7e5d-_0xaf31dc+0x1))+_0xaf31dc;var _0x2b2ab9;const _0x1d022c=await transfers['findOne']({'invoice':_0x7b55b7(0xb3)+_0x10f690});return _0x1d022c&&_0x1d022c[_0x7b55b7(0x8f)]>0x0?_0x2b2ab9=_0x7b55b7(0xb3)+_0x10f690:_0x2b2ab9=_0x7b55b7(0xb3)+_0x10f690,_0x2b2ab9;}router['get']('/view/add_transfer',auth,async(_0x4b1748,_0x5e9eab)=>{var _0x5f0b2c=a0_0xff52d4;try{const {username:_0x1f782e,email:_0x3f912a,role:_0xc89d03}=_0x4b1748[_0x5f0b2c(0x145)],_0x1de125=_0x4b1748[_0x5f0b2c(0x145)],_0x4b0eb2=await profile['findOne']({'email':_0x1de125['email']}),_0x460f7a=await master_shop[_0x5f0b2c(0x17b)]();console[_0x5f0b2c(0x146)](_0x5f0b2c(0xe4),_0x460f7a);let _0x264407;if(_0x1de125[_0x5f0b2c(0xcd)]==_0x5f0b2c(0x133)){const _0x3662dd=await staff[_0x5f0b2c(0xcc)]({'email':_0x1de125[_0x5f0b2c(0xce)]});_0x264407=await warehouse[_0x5f0b2c(0x162)]([{'$match':{'status':_0x5f0b2c(0xbb),'name':_0x3662dd['warehouse'],'warehouse_category':_0x5f0b2c(0x17f)}},{'$group':{'_id':_0x5f0b2c(0x13d),'name':{'$first':'$name'}}}]);}else _0x264407=await warehouse[_0x5f0b2c(0x162)]([{'$match':{'status':_0x5f0b2c(0xbb),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x5f0b2c(0x13d)}}}]);var _0x11d170=[_0x5f0b2c(0xa1),_0x5f0b2c(0xd8),_0x5f0b2c(0x12b)];const _0x34ab17=await transfers[_0x5f0b2c(0x17b)]({}),_0x2c5740=_0x34ab17[_0x5f0b2c(0x8f)]+0x1,_0x5d7285=_0x5f0b2c(0xb3)+_0x2c5740[_0x5f0b2c(0x161)]()[_0x5f0b2c(0x10b)](0x5,'0');if(_0x460f7a[0x0][_0x5f0b2c(0xcb)]==_0x5f0b2c(0x15f)){var _0x35b7ca=users[_0x5f0b2c(0x123)];console[_0x5f0b2c(0x146)](_0x35b7ca);}else{if(_0x460f7a[0x0][_0x5f0b2c(0xcb)]=='Hindi')var _0x35b7ca=users[_0x5f0b2c(0x159)];else{if(_0x460f7a[0x0][_0x5f0b2c(0xcb)]==_0x5f0b2c(0x15a))var _0x35b7ca=users[_0x5f0b2c(0x15a)];else{if(_0x460f7a[0x0][_0x5f0b2c(0xcb)]==_0x5f0b2c(0x91))var _0x35b7ca=users['Spanish'];else{if(_0x460f7a[0x0]['language']==_0x5f0b2c(0x14f))var _0x35b7ca=users[_0x5f0b2c(0x14f)];else{if(_0x460f7a[0x0][_0x5f0b2c(0xcb)]=='Portuguese\x20(BR)')var _0x35b7ca=users[_0x5f0b2c(0x13e)];else{if(_0x460f7a[0x0]['language']==_0x5f0b2c(0x132))var _0x35b7ca=users[_0x5f0b2c(0x132)];else{if(_0x460f7a[0x0][_0x5f0b2c(0xcb)]==_0x5f0b2c(0xca))var _0x35b7ca=users[_0x5f0b2c(0x139)];}}}}}}}const _0x295199=getRandom8DigitNumber();_0x295199[_0x5f0b2c(0x129)](_0x194e2e=>{var _0x42edf8=_0x5f0b2c;_0x5e9eab[_0x42edf8(0x10c)](_0x42edf8(0x103),{'success':_0x4b1748['flash']('success'),'errors':_0x4b1748[_0x42edf8(0x149)](_0x42edf8(0x104)),'role':_0x1de125,'profile':_0x4b0eb2,'master_shop':_0x460f7a,'warehouse':_0x264407,'language':_0x35b7ca,'rooms_data':_0x11d170,'invoice':_0x194e2e});})[_0x5f0b2c(0xf5)](_0x3b14fc=>{var _0x477091=_0x5f0b2c;_0x4b1748[_0x477091(0x149)](_0x477091(0x104),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x5e9eab[_0x477091(0xa5)](_0x477091(0x169));});}catch(_0x281a21){console[_0x5f0b2c(0x146)](_0x281a21);}}),router['post'](a0_0xff52d4(0x10e),auth,async(_0x31a4c9,_0x2b8a1b)=>{var _0x29eb6=a0_0xff52d4;try{console[_0x29eb6(0x146)](_0x31a4c9[_0x29eb6(0xfa)]);const {date:_0x45a4b6,from_warehouse:_0xca2c52,FromRoom_name:_0x4cc6a6,to_warehouse:_0x5116ac,ToRoom_name:_0x5a16a4,prod_name:_0x49049e,from_prod_qty:_0x6fc749,from_prod_level:_0x67cc87,from_prod_isle:_0x394d9f,from_prod_pallet:_0x322aa5,to_prod_qty:_0x509d26,to_prod_level:_0x387862,to_prod_isle:_0x2df119,to_prod_pallet:_0xc4e213,primary_code:_0x4d2719,secondary_code:_0x684b8d,product_code3:_0x2c26ee,note:_0x2b3c0b,MaxStocks_data2:_0x41945d,invoice:_0x15b3d7,expiry_date:_0x111715}=_0x31a4c9[_0x29eb6(0xfa)];if(typeof _0x49049e==_0x29eb6(0xf4))var _0x4a42a5=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0xc9)]],_0x100fc7=[_0x31a4c9['body'][_0x29eb6(0x144)]],_0x134308=[_0x31a4c9[_0x29eb6(0xfa)]['from_prod_level']],_0x2bcd6f=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x11d)]],_0x9d0d9=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x152)]],_0xd0c62a=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x16c)]],_0x322aab=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0xfb)]],_0xe544c1=[_0x31a4c9[_0x29eb6(0xfa)]['product_code3']],_0x1afbca=[_0x31a4c9[_0x29eb6(0xfa)]['MaxStocks_data2']],_0x259f80=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x11b)]],_0x22fb04=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x16a)]],_0x2b1e6f=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x99)]],_0xd25b2c=[_0x31a4c9[_0x29eb6(0xfa)]['expiry_date']],_0x14e35d=[_0x31a4c9[_0x29eb6(0xfa)]['max_per_unit']],_0x529347=[_0x31a4c9['body'][_0x29eb6(0x176)]],_0xb1740e=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x173)]],_0xe4e58d=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0xed)]],_0x18ec3d=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x14c)]],_0x2cd160=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x9c)]],_0x19e92a=[_0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x179)]],_0x334a6c=[_0x31a4c9[_0x29eb6(0xfa)]['id_transaction']];else var _0x4a42a5=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0xc9)]],_0x100fc7=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x144)]],_0x134308=[..._0x31a4c9['body'][_0x29eb6(0xb9)]],_0x2bcd6f=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x11d)]],_0x9d0d9=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x152)]],_0xd0c62a=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x16c)]],_0x322aab=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0xfb)]],_0xe544c1=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0xe0)]],_0x1afbca=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x98)]],_0x259f80=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x11b)]],_0x22fb04=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x16a)]],_0x2b1e6f=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x99)]],_0xd25b2c=[..._0x31a4c9['body'][_0x29eb6(0x10d)]],_0x14e35d=[..._0x31a4c9['body']['max_per_unit']],_0x529347=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x176)]],_0xb1740e=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x173)]],_0xe4e58d=[..._0x31a4c9['body'][_0x29eb6(0xed)]],_0x18ec3d=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x14c)]],_0x2cd160=[..._0x31a4c9[_0x29eb6(0xfa)]['from_invoice']],_0x19e92a=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x179)]],_0x334a6c=[..._0x31a4c9[_0x29eb6(0xfa)][_0x29eb6(0x156)]];const _0x11c865=_0x4a42a5['map'](_0x2e64dc=>{return _0x2e64dc={'product_name':_0x2e64dc};});_0x100fc7[_0x29eb6(0xa4)]((_0x365bf2,_0x33ac80)=>{_0x11c865[_0x33ac80]['from_quantity']=_0x365bf2;}),_0x2cd160[_0x29eb6(0xa4)]((_0x1a51e2,_0x1f8801)=>{_0x11c865[_0x1f8801]['from_invoice']=_0x1a51e2;}),_0x19e92a[_0x29eb6(0xa4)]((_0x2df1c6,_0x5f4dbb)=>{var _0x1bca9b=_0x29eb6;_0x11c865[_0x5f4dbb][_0x1bca9b(0x9d)]=_0x2df1c6;}),_0x334a6c[_0x29eb6(0xa4)]((_0x5e73b3,_0x22d794)=>{var _0x3264d3=_0x29eb6;_0x11c865[_0x22d794][_0x3264d3(0xa8)]=_0x5e73b3;}),_0x134308[_0x29eb6(0xa4)]((_0x14d39a,_0x386d58)=>{_0xe4e58d['forEach']((_0x1f098b,_0x409332)=>{var _0x416a9a=a0_0x28f8;if(_0x1f098b==_0x416a9a(0x15d)&&_0x386d58==_0x409332){var _0x2399d7=_0x14d39a['slice'](0x3);_0x11c865[_0x386d58]['from_storage']=_0x14d39a[0x0],_0x11c865[_0x386d58]['from_rack']=_0x14d39a[0x1],_0x11c865[_0x386d58][_0x416a9a(0xe6)]=0x0,_0x11c865[_0x386d58][_0x416a9a(0x107)]=0x0,_0x11c865[_0x386d58][_0x416a9a(0xc0)]=_0x416a9a(0xde),_0x11c865[_0x386d58][_0x416a9a(0x97)]=_0x2399d7;}else{if(_0x1f098b==_0x416a9a(0xff)&&_0x386d58==_0x409332){var _0x2399d7=_0x14d39a[_0x416a9a(0xae)](0x3);_0x11c865[_0x386d58]['from_storage']=_0x14d39a[0x0],_0x11c865[_0x386d58]['from_rack']=_0x14d39a[0x1],_0x11c865[_0x386d58][_0x416a9a(0xe6)]=0x0,_0x11c865[_0x386d58][_0x416a9a(0x107)]=0x0,_0x11c865[_0x386d58]['from_types']=_0x416a9a(0xde),_0x11c865[_0x386d58][_0x416a9a(0x97)]=_0x14d39a[0x5];}else{if(_0x386d58==_0x409332){if(_0x14d39a[0x0]=='A'&&_0x14d39a[0x1]=='L'&&_0x14d39a[0x2]=='L')console[_0x416a9a(0x146)](_0x1f098b+_0x416a9a(0x125)+_0x386d58+_0x416a9a(0x125)+_0x409332+_0x416a9a(0x125)+_0x14d39a+_0x416a9a(0x112)),_0x11c865[_0x386d58][_0x416a9a(0xe5)]=_0x14d39a[0x0],_0x11c865[_0x386d58]['from_rack']=_0x14d39a[0x1],_0x11c865[_0x386d58][_0x416a9a(0xe6)]=0x0,_0x11c865[_0x386d58]['from_bin']=0x0,_0x11c865[_0x386d58][_0x416a9a(0xc0)]='Floor',_0x11c865[_0x386d58]['from_floorlevel']=_0x14d39a[0x3];else{var _0x44c8a4;if(_0x14d39a[0x4]=='L')_0x44c8a4=_0x416a9a(0x120);else _0x14d39a[0x4]=='F'&&(_0x44c8a4=_0x416a9a(0xde));_0x11c865[_0x386d58][_0x416a9a(0xe5)]=_0x14d39a[0x0],_0x11c865[_0x386d58][_0x416a9a(0x93)]=_0x14d39a[0x1],_0x11c865[_0x386d58][_0x416a9a(0xe6)]=_0x14d39a[0x2],_0x11c865[_0x386d58][_0x416a9a(0x107)]=_0x14d39a[0x3],_0x11c865[_0x386d58]['from_types']=_0x44c8a4,_0x11c865[_0x386d58][_0x416a9a(0x97)]=_0x14d39a[0x5];}}}}});}),_0x2bcd6f[_0x29eb6(0xa4)]((_0x5aae2d,_0x40ad1b)=>{var _0x11bc98=_0x29eb6;_0x11c865[_0x40ad1b][_0x11bc98(0xd0)]=_0x5aae2d;}),_0x9d0d9[_0x29eb6(0xa4)]((_0x56a238,_0x43362e)=>{_0x18ec3d['forEach']((_0x4868d6,_0xf43fca)=>{var _0x1e35d7=a0_0x28f8;if(_0x4868d6=='Receiving\x20Area'&&_0x43362e==_0xf43fca){var _0x3d4d12=_0x56a238[_0x1e35d7(0xae)](0x3);_0x11c865[_0x43362e][_0x1e35d7(0xf7)]=_0x56a238[0x0],_0x11c865[_0x43362e][_0x1e35d7(0xb8)]=_0x56a238[0x1],_0x11c865[_0x43362e][_0x1e35d7(0x163)]=0x0,_0x11c865[_0x43362e]['to_bin']=0x0,_0x11c865[_0x43362e]['to_types']=_0x1e35d7(0xde),_0x11c865[_0x43362e][_0x1e35d7(0x137)]=_0x3d4d12;}else{if(_0x4868d6==_0x1e35d7(0xff)&&_0x43362e==_0xf43fca){var _0x3d4d12=_0x56a238['slice'](0x3);_0x11c865[_0x43362e][_0x1e35d7(0xf7)]=_0x56a238[0x0],_0x11c865[_0x43362e]['rack']=_0x56a238[0x1],_0x11c865[_0x43362e][_0x1e35d7(0x163)]=0x0,_0x11c865[_0x43362e]['to_bin']=0x0,_0x11c865[_0x43362e][_0x1e35d7(0x126)]=_0x1e35d7(0xde),_0x11c865[_0x43362e][_0x1e35d7(0x137)]=_0x56a238[0x5];}else{if(_0x43362e==_0xf43fca){if(_0x56a238[0x0]=='A'&&_0x56a238[0x1]=='L'&&_0x56a238[0x2]=='L')console['log'](_0x4868d6+'\x20<>\x20'+_0x43362e+_0x1e35d7(0x125)+_0xf43fca+_0x1e35d7(0x125)+_0x56a238+_0x1e35d7(0x112)),_0x11c865[_0x43362e]['storage']=_0x56a238[0x0],_0x11c865[_0x43362e]['rack']=_0x56a238[0x1],_0x11c865[_0x43362e][_0x1e35d7(0x163)]=0x0,_0x11c865[_0x43362e]['to_bin']=0x0,_0x11c865[_0x43362e][_0x1e35d7(0x126)]=_0x1e35d7(0xde),_0x11c865[_0x43362e]['to_floorlevel']=_0x56a238[0x3];else{var _0x24f325;if(_0x56a238[0x4]=='L')_0x24f325=_0x1e35d7(0x120);else _0x56a238[0x4]=='F'&&(_0x24f325=_0x1e35d7(0xde));_0x11c865[_0x43362e][_0x1e35d7(0xf7)]=_0x56a238[0x0],_0x11c865[_0x43362e][_0x1e35d7(0xb8)]=_0x56a238[0x1],_0x11c865[_0x43362e]['to_bay']=_0x56a238[0x2],_0x11c865[_0x43362e][_0x1e35d7(0x174)]=_0x56a238[0x3],_0x11c865[_0x43362e]['to_types']=_0x24f325,_0x11c865[_0x43362e]['to_floorlevel']=_0x56a238[0x5];}}}}});}),_0xd0c62a['forEach']((_0x364fff,_0x235c81)=>{var _0x18c58b=_0x29eb6;_0x11c865[_0x235c81][_0x18c58b(0x16c)]=_0x364fff;}),_0x322aab[_0x29eb6(0xa4)]((_0x5009d2,_0x19df45)=>{_0x11c865[_0x19df45]['secondary_code']=_0x5009d2;}),_0xe544c1[_0x29eb6(0xa4)]((_0x130d3e,_0x15978b)=>{_0x11c865[_0x15978b]['product_code']=_0x130d3e;}),_0x1afbca[_0x29eb6(0xa4)]((_0x592f29,_0x1dc5d1)=>{_0x11c865[_0x1dc5d1]['maxProducts']=_0x592f29;}),_0x259f80['forEach']((_0x3840c0,_0x3b2418)=>{var _0x313ea9=_0x29eb6;_0x11c865[_0x3b2418][_0x313ea9(0xac)]=_0x3840c0;}),_0x22fb04['forEach']((_0xf5a39d,_0x5dead5)=>{var _0x8d3074=_0x29eb6;_0x11c865[_0x5dead5][_0x8d3074(0x16a)]=_0xf5a39d;}),_0x2b1e6f[_0x29eb6(0xa4)]((_0x284c53,_0x213a84)=>{var _0x5c5303=_0x29eb6;_0x11c865[_0x213a84][_0x5c5303(0x99)]=_0x284c53;}),_0xd25b2c[_0x29eb6(0xa4)]((_0x3bab78,_0x519fc9)=>{_0x11c865[_0x519fc9]['expiry_date']=_0x3bab78;}),_0x14e35d['forEach']((_0x283f78,_0x1d3bb7)=>{_0x11c865[_0x1d3bb7]['maxperunit']=_0x283f78;}),_0x529347[_0x29eb6(0xa4)]((_0x51be70,_0x52e822)=>{_0x11c865[_0x52e822]['production_date']=_0x51be70;}),_0xb1740e['forEach']((_0x526d09,_0x5245c7)=>{var _0x9e9880=_0x29eb6;_0x11c865[_0x5245c7][_0x9e9880(0x173)]=_0x526d09;}),_0xe4e58d[_0x29eb6(0xa4)]((_0x510d33,_0x967d7d)=>{var _0x3d6ca7=_0x29eb6;_0x11c865[_0x967d7d][_0x3d6ca7(0x135)]=_0x510d33;}),_0x18ec3d[_0x29eb6(0xa4)]((_0x1d817e,_0x152d6c)=>{var _0x4bd66c=_0x29eb6;_0x11c865[_0x152d6c][_0x4bd66c(0x15c)]=_0x1d817e;});const _0x1d58b8=_0x11c865['filter'](_0x20b415=>_0x20b415['to_quantity']!=='0'&&_0x20b415[_0x29eb6(0xd0)]!==''||_0x20b415[_0x29eb6(0x137)]!=='0'&&_0x20b415[_0x29eb6(0x137)]!==''),_0x1e841b=new transfers({'date':_0x45a4b6,'from_warehouse':_0xca2c52,'to_warehouse':_0x5116ac,'product':_0x1d58b8,'note':_0x2b3c0b,'invoice':_0x15b3d7}),_0x417887=await _0x1e841b['save']();_0x31a4c9[_0x29eb6(0x149)](_0x29eb6(0xfd),'Product\x20Transfer\x20successfully'),_0x2b8a1b['redirect'](_0x29eb6(0x158)+_0x417887[_0x29eb6(0xd5)]);}catch(_0x44a744){console['log'](_0x44a744),_0x2b8a1b[_0x29eb6(0xd9)](0xc8)[_0x29eb6(0x182)]({'errorMessage':_0x44a744['message']});}}),router[a0_0xff52d4(0xfc)](a0_0xff52d4(0x130),auth,async(_0x134dfd,_0x34d5ca)=>{var _0x43286f=a0_0xff52d4;try{const {username:_0x1db7c6,email:_0x40e949,role:_0x1a65c9}=_0x134dfd[_0x43286f(0x145)],_0x11965f=_0x134dfd['user'],_0x4fe66c=await profile[_0x43286f(0xcc)]({'email':_0x11965f[_0x43286f(0xce)]}),_0x3d1fe3=await master_shop['find']();console[_0x43286f(0x146)](_0x43286f(0xe4),_0x3d1fe3);const _0x23ab29=await transfers['findById'](_0x134dfd['params']['id']);let _0x53c93a=new Date(_0x23ab29['expiry_date']),_0x180531=('0'+_0x53c93a['getDate']())[_0x43286f(0xae)](-0x2),_0x3e6c0b=('0'+(_0x53c93a[_0x43286f(0x122)]()+0x1))[_0x43286f(0xae)](-0x2),_0x4213e7=_0x53c93a[_0x43286f(0xb6)](),_0xd71003=_0x4213e7+'-'+_0x3e6c0b+'-'+_0x180531,_0x3c6602;if(_0x11965f[_0x43286f(0xcd)]=='staff'){const _0x20749f=await staff[_0x43286f(0xcc)]({'email':_0x11965f[_0x43286f(0xce)]});_0x3c6602=await warehouse[_0x43286f(0x17b)]({'status':_0x43286f(0xbb),'name':_0x20749f[_0x43286f(0x106)],'warehouse_category':_0x43286f(0x17f)});}else _0x3c6602=await warehouse[_0x43286f(0x17b)]({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0x2ef47b=await warehouse['aggregate']([{'$match':{'name':_0x23ab29[_0x43286f(0x109)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x43286f(0xc6),'name':{'$first':_0x43286f(0x160)},'product_stock':{'$first':_0x43286f(0x15b)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x43286f(0x14a)},'floorlevel':{'$first':_0x43286f(0xdf)},'primary_code':{'$first':_0x43286f(0xaa)},'secondary_code':{'$first':_0x43286f(0x12e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x43286f(0x172)},'rack':{'$first':_0x43286f(0x166)},'expiry_date':{'$first':_0x43286f(0xd2)},'production_date':{'$first':_0x43286f(0xb1)},'room':{'$first':_0x43286f(0x116)}}}]);if(_0x3d1fe3[0x0][_0x43286f(0xcb)]==_0x43286f(0x15f)){var _0x5f5446=users[_0x43286f(0x123)];console[_0x43286f(0x146)](_0x5f5446);}else{if(_0x3d1fe3[0x0][_0x43286f(0xcb)]==_0x43286f(0x159))var _0x5f5446=users[_0x43286f(0x159)];else{if(_0x3d1fe3[0x0]['language']==_0x43286f(0x15a))var _0x5f5446=users['German'];else{if(_0x3d1fe3[0x0][_0x43286f(0xcb)]==_0x43286f(0x91))var _0x5f5446=users['Spanish'];else{if(_0x3d1fe3[0x0][_0x43286f(0xcb)]==_0x43286f(0x14f))var _0x5f5446=users[_0x43286f(0x14f)];else{if(_0x3d1fe3[0x0][_0x43286f(0xcb)]==_0x43286f(0x105))var _0x5f5446=users['Portuguese'];else{if(_0x3d1fe3[0x0][_0x43286f(0xcb)]==_0x43286f(0x132))var _0x5f5446=users['Chinese'];else{if(_0x3d1fe3[0x0][_0x43286f(0xcb)]==_0x43286f(0xca))var _0x5f5446=users['Arabic'];}}}}}}}_0x34d5ca[_0x43286f(0x10c)](_0x43286f(0xbf),{'success':_0x134dfd['flash'](_0x43286f(0xfd)),'errors':_0x134dfd['flash'](_0x43286f(0x104)),'role':_0x11965f,'profile':_0x4fe66c,'master_shop':_0x3d1fe3,'warehouse':_0x3c6602,'transfer':_0x23ab29,'stock':_0x2ef47b,'language':_0x5f5446});}catch(_0x1197d0){console[_0x43286f(0x146)](_0x1197d0);}}),router[a0_0xff52d4(0x121)]('/preview/:id',auth,async(_0x115a9d,_0x4ed1a4)=>{var _0x5cff8a=a0_0xff52d4;try{const _0x5179f6=_0x115a9d[_0x5cff8a(0x128)]['id'],{from_warehouse:_0x1e680a,FromRoom_name:_0x95ecb0,to_warehouse:_0x4542d2,ToRoom_name:_0xb82064}=_0x115a9d['body'],_0x33db96=await transfers['findById']({'_id':_0x5179f6}),_0x5a0b60=_0x33db96[_0x5cff8a(0xdd)]['map'](async _0x52d508=>{var _0x506b13=_0x5cff8a;if(_0x52d508[_0x506b13(0xd0)]>0x0){var _0xc48762=await warehouse[_0x506b13(0xcc)]({'name':_0x33db96[_0x506b13(0x109)],'room':_0x52d508[_0x506b13(0x135)],'warehouse_category':_0x506b13(0x17f)});const _0x3ddfad=_0xc48762[_0x506b13(0xfe)][_0x506b13(0x151)](_0x288492=>{var _0x433885=_0x506b13;_0x288492['product_name']==_0x52d508[_0x433885(0xc3)]&&_0x288492['floorlevel']==_0x52d508[_0x433885(0x97)]&&_0x288492[_0x433885(0xab)]==_0x52d508[_0x433885(0xc0)]&&_0x288492[_0x433885(0x111)]==_0x52d508[_0x433885(0x107)]&&_0x288492['bay']==_0x52d508[_0x433885(0xe6)]&&_0x288492[_0x433885(0xb8)]==_0x52d508['from_rack']&&_0x288492[_0x433885(0xf7)]==_0x52d508[_0x433885(0xe5)]&&_0x288492['expiry_date']==_0x52d508['expiry_date']&&_0x288492[_0x433885(0x99)]==_0x52d508[_0x433885(0x99)]&&_0x288492[_0x433885(0x176)]==_0x52d508[_0x433885(0x176)]&&_0x288492[_0x433885(0xe9)]==_0x52d508['from_invoice']&&_0x288492[_0x433885(0xd5)]==_0x52d508['id_transaction_id']&&(_0x288492[_0x433885(0x94)]=_0x288492[_0x433885(0x94)]-_0x52d508['to_quantity']);});}return _0xc48762;});Promise[_0x5cff8a(0x153)](_0x5a0b60)['then'](async _0x15b728=>{var _0x474a4f=_0x5cff8a;try{for(const _0x4c22c8 of _0x15b728){await _0x4c22c8[_0x474a4f(0xb4)]();}try{const _0x47f35a=_0x33db96[_0x474a4f(0xdd)][_0x474a4f(0x151)](async _0x1a3c19=>{var _0x36e425=_0x474a4f;if(_0x1a3c19[_0x36e425(0xd0)]>0x0){var _0x57d302=await warehouse[_0x36e425(0xcc)]({'name':_0x33db96['to_warehouse'],'room':_0x1a3c19[_0x36e425(0x15c)],'warehouse_category':'Raw\x20Materials'}),_0x137385=0x0;const _0x537daf=_0x57d302[_0x36e425(0xfe)][_0x36e425(0x151)](_0x271778=>{var _0xe73aba=_0x36e425;_0x271778[_0xe73aba(0xc3)]==_0x1a3c19[_0xe73aba(0xc3)]&&_0x271778[_0xe73aba(0xeb)]==_0x1a3c19['to_floorlevel']&&_0x271778[_0xe73aba(0xab)]==_0x1a3c19[_0xe73aba(0x126)]&&_0x271778['bin']==_0x1a3c19['to_bin']&&_0x271778[_0xe73aba(0x181)]==_0x1a3c19['to_bay']&&_0x271778[_0xe73aba(0xb8)]==_0x1a3c19[_0xe73aba(0xb8)]&&_0x271778[_0xe73aba(0xf7)]==_0x1a3c19['storage']&&_0x271778[_0xe73aba(0x10d)]==_0x1a3c19[_0xe73aba(0x10d)]&&_0x271778['batch_code']==_0x1a3c19[_0xe73aba(0x99)]&&_0x271778[_0xe73aba(0x176)]==_0x1a3c19[_0xe73aba(0x176)]&&_0x271778[_0xe73aba(0xe9)]==_0x1a3c19[_0xe73aba(0x9d)]&&(_0x271778['product_stock']=_0x271778[_0xe73aba(0x94)]+_0x1a3c19[_0xe73aba(0xd0)],_0x137385++);});_0x137385=='0'&&(_0x57d302[_0x36e425(0xfe)]=_0x57d302[_0x36e425(0xfe)]['concat']({'product_name':_0x1a3c19[_0x36e425(0xc3)],'product_stock':_0x1a3c19[_0x36e425(0xd0)],'bay':_0x1a3c19[_0x36e425(0x163)],'bin':_0x1a3c19[_0x36e425(0x174)],'type':_0x1a3c19[_0x36e425(0x126)],'floorlevel':_0x1a3c19[_0x36e425(0x137)],'storage':_0x1a3c19[_0x36e425(0xf7)],'rack':_0x1a3c19[_0x36e425(0xb8)],'product_code':_0x1a3c19[_0x36e425(0xef)],'primary_code':_0x1a3c19['primary_code'],'secondary_code':_0x1a3c19[_0x36e425(0xfb)],'maxProducts':_0x1a3c19[_0x36e425(0x178)],'storage':_0x1a3c19[_0x36e425(0xf7)],'rack':_0x1a3c19[_0x36e425(0xb8)],'expiry_date':_0x1a3c19[_0x36e425(0x10d)],'maxPerUnit':_0x1a3c19[_0x36e425(0x113)],'batch_code':_0x1a3c19['batch_code'],'production_date':_0x1a3c19[_0x36e425(0x176)]}));}return _0x57d302;});Promise[_0x474a4f(0x153)](_0x47f35a)['then'](async _0x41605d=>{var _0x2d4065=_0x474a4f;try{for(const _0x53b238 of _0x41605d){await warehouse[_0x2d4065(0x8e)]({'_id':_0x53b238[_0x2d4065(0xd5)]},{'$addToSet':{'product_details':{'$each':_0x53b238[_0x2d4065(0xfe)]}}});}_0x33db96[_0x2d4065(0x13b)]='True';const _0x27794f=await _0x33db96[_0x2d4065(0xb4)](),_0x465c4c=await master_shop[_0x2d4065(0x17b)](),_0x32d6db=await email_settings[_0x2d4065(0xcc)](),_0x2a01d=await supervisor_settings['find']();var _0xe6015d=_0x33db96[_0x2d4065(0xdd)],_0x3ac36b='',_0x8b305a;for(_0x8b305a in _0xe6015d){_0x3ac36b+=_0x2d4065(0x141)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xe6015d[_0x8b305a]['product_name']+_0x2d4065(0xc5)+_0x2d4065(0x14d)+_0xe6015d[_0x8b305a]['product_code']+_0x2d4065(0xc5)+_0x2d4065(0x14d)+_0xe6015d[_0x8b305a][_0x2d4065(0xd0)]+'</td>'+_0x2d4065(0x14d)+_0xe6015d[_0x8b305a][_0x2d4065(0xac)]+_0x2d4065(0xc5)+_0x2d4065(0x14d)+_0xe6015d[_0x8b305a][_0x2d4065(0x16a)]+_0x2d4065(0xc5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x33db96[_0x2d4065(0xb0)]+_0x2d4065(0xc5)+_0x2d4065(0x14d)+_0xe6015d[_0x8b305a]['to_room_name']+_0x2d4065(0xc5)+_0x2d4065(0x14d)+_0xe6015d[_0x8b305a][_0x2d4065(0xf7)]+_0xe6015d[_0x8b305a][_0x2d4065(0xb8)]+_0xe6015d[_0x8b305a][_0x2d4065(0x163)]+_0xe6015d[_0x8b305a]['to_bin']+_0xe6015d[_0x8b305a][_0x2d4065(0x126)][0x0]+_0xe6015d[_0x8b305a][_0x2d4065(0x137)]+'</td>','</tr>';}let _0x2f0d11=nodemailer[_0x2d4065(0xa6)]({'host':_0x32d6db[_0x2d4065(0x108)],'port':Number(_0x32d6db['port']),'secure':![],'auth':{'user':_0x32d6db['email'],'pass':_0x32d6db[_0x2d4065(0x180)]}}),_0x320b93={'from':_0x32d6db[_0x2d4065(0xce)],'to':_0x2a01d[0x0][_0x2d4065(0xe7)],'subject':_0x2d4065(0x150),'attachments':[{'filename':_0x2d4065(0xaf),'path':__dirname+'/../public'+_0x2d4065(0x14b)+_0x465c4c[0x0][_0x2d4065(0xd3)],'cid':_0x2d4065(0x11a)}],'html':_0x2d4065(0x134)+_0x2d4065(0xb5)+_0x2d4065(0x16d)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2d4065(0xee)+_0x2d4065(0xe8)+_0x2d4065(0xd7)+_0x2d4065(0xee)+_0x2d4065(0x17c)+_0x465c4c[0x0][_0x2d4065(0x168)]+_0x2d4065(0x183)+_0x2d4065(0xd7)+_0x2d4065(0xd7)+_0x2d4065(0x17a)+_0x2d4065(0xee)+_0x2d4065(0x102)+_0x2d4065(0xe2)+_0x33db96[_0x2d4065(0xe9)]+'\x20'+_0x2d4065(0xec)+_0x2d4065(0x92)+_0x33db96[_0x2d4065(0x184)]+'\x20'+_0x2d4065(0x16b)+_0x2d4065(0xc7)+_0x2d4065(0xd7)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2d4065(0x13c)+_0x2d4065(0x141)+_0x2d4065(0x9e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x2d4065(0x167)+_0x2d4065(0xf9)+_0x2d4065(0xf3)+_0x2d4065(0xbc)+_0x2d4065(0xad)+_0x2d4065(0xea)+'</tr>'+_0x2d4065(0x147)+_0x2d4065(0x165)+'\x20'+_0x3ac36b+'\x20'+_0x2d4065(0x131)+_0x2d4065(0x15e)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x2d4065(0x8c)+_0x465c4c[0x0]['site_title']+_0x2d4065(0xc7)+_0x2d4065(0xd7)+_0x2d4065(0xd7)+_0x2d4065(0xdb)};_0x2f0d11[_0x2d4065(0xa9)](_0x320b93,function(_0x345611,_0x55470f){var _0x49d573=_0x2d4065;_0x345611?(console['log'](_0x345611),console['log'](_0x49d573(0x13a))):console[_0x49d573(0x146)](_0x49d573(0x90));}),_0x115a9d[_0x2d4065(0x149)](_0x2d4065(0xfd),_0x2d4065(0x157)),_0x4ed1a4['redirect']('/picking_list/PDF_transfer_rm/'+_0x27794f['_id']);}catch(_0x2ec990){console[_0x2d4065(0xb7)](_0x2ec990),_0x4ed1a4[_0x2d4065(0xd9)](0x1f4)[_0x2d4065(0x182)]({'Perror':_0x2d4065(0x10f),'message':_0x2ec990[_0x2d4065(0x13f)]});}})[_0x474a4f(0xf5)](_0x438d1f=>{var _0x5c6043=_0x474a4f;console[_0x5c6043(0xb7)](_0x438d1f),_0x4ed1a4['status'](0x1f4)[_0x5c6043(0x182)]({'Perror':_0x5c6043(0x148)});});}catch(_0x5a768e){_0x4ed1a4[_0x474a4f(0x182)](_0x5a768e);}}catch(_0x87fdc4){console[_0x474a4f(0xb7)](_0x87fdc4),_0x4ed1a4[_0x474a4f(0xd9)](0x1f4)['json']({'Merror':_0x474a4f(0x10f),'Message':_0x87fdc4[_0x474a4f(0x13f)]});}})[_0x5cff8a(0xf5)](_0x5b8237=>{var _0x57007a=_0x5cff8a;console[_0x57007a(0xb7)](_0x5b8237),_0x4ed1a4[_0x57007a(0xd9)](0x1f4)[_0x57007a(0x182)]({'Merror':_0x57007a(0x148)});});}catch(_0x362c45){console['log'](_0x362c45);}});function BayBinSelected(_0x4f0715,_0x19721e){var _0x465292=a0_0xff52d4,_0x31c880=[],_0x19f4b2=[],_0xd63518=[],_0x8bff10=[],_0x1f9b43=[],_0x8b0efc=[];let _0x513cc1=[];if(_0x4f0715==_0x465292(0x8b))switch(_0x19721e){case'Rack\x20A':_0x31c880=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x19f4b2=[0x1,0x2],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=[_0x465292(0x120),_0x465292(0xde)],_0x1f9b43=['D'],_0x8b0efc=['A'];break;case _0x465292(0xc8):_0x31c880=[0x6,0x5,0x4,0x3,0x2,0x1],_0x19f4b2=[0x1,0x2],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=[_0x465292(0x120),_0x465292(0xde)],_0x1f9b43=['D'],_0x8b0efc=['B'];break;case _0x465292(0xff):_0x31c880=[0x0],_0x19f4b2=[0x0],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=['Floor'],_0x1f9b43=['D'],_0x8b0efc=['S'];break;case'Receiving\x20Area':_0x31c880=[0x0],_0x19f4b2=[0x0],_0x8bff10=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0xd63518=[_0x465292(0xde)],_0x1f9b43=['D'],_0x8b0efc=['R'];break;}else{if(_0x4f0715==_0x465292(0x171))switch(_0x19721e){case'Rack\x20A':_0x31c880=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x19f4b2=['B','F'],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=['Level',_0x465292(0xde)],_0x1f9b43=['C'],_0x8b0efc=['A'];break;case _0x465292(0xc8):_0x31c880=[0x5,0x4,0x3,0x2,0x1],_0x19f4b2=['F','B','S'],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=[_0x465292(0x120),'Floor'],_0x1f9b43=['C'],_0x8b0efc=['B'];break;case _0x465292(0xbe):_0x31c880=[0x1,0x2,0x3,0x4,0x5],_0x19f4b2=['B','F','S'],_0x8bff10=[0x5,0x4,0x3,0x2,0x1],_0xd63518=['Level',_0x465292(0xde)],_0x1f9b43=['C'],_0x8b0efc=['C'];break;case _0x465292(0x177):_0x31c880=[0x5,0x4,0x3,0x2,0x1],_0x19f4b2=['F','B','S'],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=[_0x465292(0x120),_0x465292(0xde)],_0x1f9b43=['C'],_0x8b0efc=['D'];break;case _0x465292(0xc2):_0x31c880=[0x4,0x3,0x2,0x1],_0x19f4b2=[0x1,0x2],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=[_0x465292(0x120),'Floor'],_0x1f9b43=['C'],_0x8b0efc=['E'];break;case _0x465292(0x115):_0x31c880=[0x1,0x2,0x3],_0x19f4b2=[0x1,0x2],_0x8bff10=[0x1,0x2,0x3,0x4,0x5],_0xd63518=['Level'],_0x1f9b43=['C'],_0x8b0efc=['F'];break;}}return{'levels':_0x31c880,'Isle':_0x19f4b2,'rack':_0x8bff10,'type':_0xd63518,'storage':_0x1f9b43,'rak':_0x8b0efc};}router[a0_0xff52d4(0xfc)](a0_0xff52d4(0xc1),auth,async(_0x1f0303,_0xc28788)=>{var _0x46a089=a0_0xff52d4;try{const {username:_0xc0907d,email:_0x17790b,role:_0x44ca60}=_0x1f0303[_0x46a089(0x145)],_0xe8121a=_0x1f0303['user'],_0x274757=await profile[_0x46a089(0xcc)]({'email':_0xe8121a[_0x46a089(0xce)]}),_0x1a241f=await master_shop['find'](),_0x2a925a=await transfers[_0x46a089(0x12d)](_0x1f0303[_0x46a089(0x128)]['id']);let _0x39c401;if(_0xe8121a[_0x46a089(0xcd)]==_0x46a089(0x133)){const _0x1049ca=await staff[_0x46a089(0xcc)]({'email':_0xe8121a['email']});_0x39c401=await warehouse[_0x46a089(0x162)]([{'$match':{'status':_0x46a089(0xbb),'name':_0x1049ca[_0x46a089(0x106)],'warehouse_category':_0x46a089(0x17f)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x39c401=await warehouse[_0x46a089(0x162)]([{'$match':{'status':_0x46a089(0xbb),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x46a089(0x13d),'name':{'$first':_0x46a089(0x13d)}}}]);const _0x2f64fc=await warehouse[_0x46a089(0x162)]([{'$match':{'name':_0x2a925a['from_warehouse'],'warehouse_category':_0x46a089(0x17f)}},{'$unwind':_0x46a089(0x154)},{'$group':{'_id':_0x46a089(0xc6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x46a089(0xf2)},'bin':{'$first':_0x46a089(0xd1)},'type':{'$first':_0x46a089(0x14a)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x46a089(0xaa)},'secondary_code':{'$first':_0x46a089(0x12e)},'product_code':{'$first':_0x46a089(0x8d)},'storage':{'$first':_0x46a089(0x172)},'rack':{'$first':_0x46a089(0x166)},'expiry_date':{'$first':_0x46a089(0xd2)},'production_date':{'$first':_0x46a089(0xb1)},'room':{'$first':'$room'}}}]),_0x53337d=await product[_0x46a089(0x17b)]({}),_0x2a48e6=BayBinSelected(_0x2a925a['to_warehouse'],_0x2a925a[_0x46a089(0x10a)]);if(_0x1a241f[0x0]['language']==_0x46a089(0x15f)){var _0x2d14b1=users[_0x46a089(0x123)];console[_0x46a089(0x146)](_0x2d14b1);}else{if(_0x1a241f[0x0][_0x46a089(0xcb)]==_0x46a089(0x159))var _0x2d14b1=users[_0x46a089(0x159)];else{if(_0x1a241f[0x0][_0x46a089(0xcb)]==_0x46a089(0x15a))var _0x2d14b1=users[_0x46a089(0x15a)];else{if(_0x1a241f[0x0][_0x46a089(0xcb)]=='Spanish')var _0x2d14b1=users[_0x46a089(0x91)];else{if(_0x1a241f[0x0][_0x46a089(0xcb)]=='French')var _0x2d14b1=users['French'];else{if(_0x1a241f[0x0][_0x46a089(0xcb)]=='Portuguese\x20(BR)')var _0x2d14b1=users[_0x46a089(0x13e)];else{if(_0x1a241f[0x0]['language']==_0x46a089(0x132))var _0x2d14b1=users[_0x46a089(0x132)];else{if(_0x1a241f[0x0]['language']==_0x46a089(0xca))var _0x2d14b1=users[_0x46a089(0x139)];}}}}}}}_0xc28788[_0x46a089(0x10c)](_0x46a089(0x117),{'success':_0x1f0303[_0x46a089(0x149)]('success'),'errors':_0x1f0303['flash']('errors'),'role':_0xe8121a,'profile':_0x274757,'master_shop':_0x1a241f,'warehouse':_0x39c401,'transfer':_0x2a925a,'stock':_0x2f64fc,'unit':_0x53337d,'language':_0x2d14b1});}catch(_0xcc7722){console[_0x46a089(0x146)](_0xcc7722);}}),router['post'](a0_0xff52d4(0xc1),auth,async(_0x28c80d,_0x2cca88)=>{var _0x597725=a0_0xff52d4;try{const _0x141788=_0x28c80d[_0x597725(0x128)]['id'],_0x526d2f=await transfers['findById'](_0x141788);_0x2cca88['json'](_0x28c80d['body']);return;const {date:_0x36eb73,from_warehouse:_0x15b2f,FromRoom_name:_0x3868a5,to_warehouse:_0x2cfb58,ToRoom_name:_0xbb5f52,prod_name:_0x42bfa3,from_prod_qty:_0x593151,from_prod_level:_0x3e1e82,from_prod_isle:_0x3114fa,from_prod_pallet:_0x35b112,to_prod_qty:_0x318816,to_prod_level:_0x3c7029,to_prod_isle:_0xd90787,to_prod_pallet:_0x1b84de,primary_code:_0x25e505,secondary_code:_0xeaafa8,product_code3:_0x57dc17,note:_0x376ef8,invoice:_0x4e13d8,expiry_date:_0x357664}=_0x28c80d[_0x597725(0xfa)];if(typeof _0x42bfa3==_0x597725(0xf4))var _0x5d5595=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xc9)]],_0x17e0a5=[_0x28c80d[_0x597725(0xfa)]['from_prod_qty']],_0x2dcac8=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xb9)]],_0x48158a=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xdc)]],_0x55ec2e=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xa2)]],_0x263160=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xc0)]],_0x2f42a0=[_0x28c80d['body'][_0x597725(0x17d)]],_0x56bf26=[_0x28c80d[_0x597725(0xfa)]['to_prod_level']],_0x5e8406=[_0x28c80d[_0x597725(0xfa)]['to_prod_isle']],_0x1fc15c=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xe3)]],_0x5369b6=[_0x28c80d[_0x597725(0xfa)][_0x597725(0x126)]],_0x594854=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xf7)]],_0x118871=[_0x28c80d['body'][_0x597725(0xa3)]],_0x5b8f2f=[_0x28c80d[_0x597725(0xfa)]['primary_code']],_0x411a75=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xfb)]],_0x1d29b8=[_0x28c80d[_0x597725(0xfa)]['product_code3']],_0x4b1ed7=[_0x28c80d[_0x597725(0xfa)][_0x597725(0x98)]],_0xa38838=[_0x28c80d[_0x597725(0xfa)][_0x597725(0xac)]],_0x4f32da=[_0x28c80d['body'][_0x597725(0x16a)]],_0x5d5e51=[_0x28c80d[_0x597725(0xfa)]['batch_code']],_0xece240=[_0x28c80d[_0x597725(0xfa)]['expiry_date']],_0x2dcaea=[_0x28c80d['body'][_0x597725(0xe5)]],_0xfb4086=[_0x28c80d[_0x597725(0xfa)][_0x597725(0x9f)]];else var _0x5d5595=[..._0x28c80d[_0x597725(0xfa)]['prod_name']],_0x594854=[..._0x28c80d['body']['storage']],_0x118871=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xa3)]],_0x263160=[..._0x28c80d['body'][_0x597725(0xc0)]],_0x5369b6=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0x126)]],_0x17e0a5=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0x144)]],_0x2dcac8=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xb9)]],_0x48158a=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xdc)]],_0x55ec2e=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xa2)]],_0x2f42a0=[..._0x28c80d['body']['to_prod_qty']],_0x56bf26=[..._0x28c80d[_0x597725(0xfa)]['to_prod_level']],_0x5e8406=[..._0x28c80d['body'][_0x597725(0x175)]],_0x1fc15c=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xe3)]],_0x5b8f2f=[..._0x28c80d[_0x597725(0xfa)]['primary_code']],_0x411a75=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xfb)]],_0x1d29b8=[..._0x28c80d['body'][_0x597725(0xe0)]],_0x4b1ed7=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0x98)]],_0xa38838=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xac)]],_0x4f32da=[..._0x28c80d['body']['secondary_unit']],_0x5d5e51=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0x99)]],_0xece240=[..._0x28c80d[_0x597725(0xfa)]['expiry_date']],_0x2dcaea=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0xe5)]],_0xfb4086=[..._0x28c80d[_0x597725(0xfa)][_0x597725(0x9f)]];const _0x12c5fb=_0x5d5595['map'](_0x3c2455=>{return _0x3c2455={'product_name':_0x3c2455};});_0x17e0a5['forEach']((_0x5ad846,_0x4645ed)=>{var _0x10180a=_0x597725;_0x12c5fb[_0x4645ed][_0x10180a(0x119)]=_0x5ad846;}),_0x2dcac8[_0x597725(0xa4)]((_0x499429,_0x315ebe)=>{var _0xa7dfc8=_0x597725;_0x12c5fb[_0x315ebe][_0xa7dfc8(0xe6)]=_0x499429;}),_0x48158a['forEach']((_0x1d7454,_0x32390d)=>{var _0x2f2d1d=_0x597725;_0x12c5fb[_0x32390d][_0x2f2d1d(0x107)]=_0x1d7454;}),_0x55ec2e[_0x597725(0xa4)]((_0x1bd4b1,_0x3459d7)=>{_0x12c5fb[_0x3459d7]['from_floorlevel']=_0x1bd4b1;}),_0x2f42a0[_0x597725(0xa4)]((_0x2a430b,_0x37b1fa)=>{var _0x4702b7=_0x597725;_0x12c5fb[_0x37b1fa][_0x4702b7(0xd0)]=_0x2a430b;}),_0x56bf26[_0x597725(0xa4)]((_0x1bf87a,_0x58206a)=>{var _0x5dc204=_0x597725;_0x12c5fb[_0x58206a][_0x5dc204(0x163)]=_0x1bf87a;}),_0x5e8406[_0x597725(0xa4)]((_0x6d7167,_0x3eda21)=>{var _0x1a860e=_0x597725;_0x12c5fb[_0x3eda21][_0x1a860e(0x174)]=_0x6d7167;}),_0x1fc15c[_0x597725(0xa4)]((_0xc978d9,_0x12e6a9)=>{var _0x945023=_0x597725;_0x12c5fb[_0x12e6a9][_0x945023(0x137)]=_0xc978d9;}),_0x5b8f2f[_0x597725(0xa4)]((_0x2c08f8,_0x4216b9)=>{var _0x3890aa=_0x597725;_0x12c5fb[_0x4216b9][_0x3890aa(0x16c)]=_0x2c08f8;}),_0x411a75[_0x597725(0xa4)]((_0xcf8c6f,_0x4c287e)=>{var _0x1a2dd6=_0x597725;_0x12c5fb[_0x4c287e][_0x1a2dd6(0xfb)]=_0xcf8c6f;}),_0x1d29b8[_0x597725(0xa4)]((_0x1f4684,_0x41dc25)=>{var _0x376c2a=_0x597725;_0x12c5fb[_0x41dc25][_0x376c2a(0xef)]=_0x1f4684;}),_0x4b1ed7['forEach']((_0x51d72a,_0x1c3612)=>{var _0x266c6d=_0x597725;_0x12c5fb[_0x1c3612][_0x266c6d(0x178)]=_0x51d72a;}),_0xa38838[_0x597725(0xa4)]((_0x4ebaac,_0xf41890)=>{var _0x5e5b09=_0x597725;_0x12c5fb[_0xf41890][_0x5e5b09(0xac)]=_0x4ebaac;}),_0x4f32da['forEach']((_0x243f81,_0x380dc8)=>{_0x12c5fb[_0x380dc8]['secondary_unit']=_0x243f81;}),_0x5d5e51[_0x597725(0xa4)]((_0x5d0df8,_0xbb3166)=>{var _0x453b58=_0x597725;_0x12c5fb[_0xbb3166][_0x453b58(0x99)]=_0x5d0df8;}),_0xece240[_0x597725(0xa4)]((_0x253aae,_0x1a606d)=>{var _0x34a7ff=_0x597725;_0x12c5fb[_0x1a606d][_0x34a7ff(0x10d)]=_0x253aae;}),_0x594854[_0x597725(0xa4)]((_0x1a37c9,_0x560113)=>{var _0x15f2f7=_0x597725;_0x12c5fb[_0x560113][_0x15f2f7(0xf7)]=_0x1a37c9;}),_0x118871[_0x597725(0xa4)]((_0x4a1d22,_0x145a8b)=>{_0x12c5fb[_0x145a8b]['rack']=_0x4a1d22;}),_0x263160['forEach']((_0x42c8d8,_0x47fac7)=>{var _0x4129d4=_0x597725;_0x12c5fb[_0x47fac7][_0x4129d4(0xc0)]=_0x42c8d8;}),_0x5369b6['forEach']((_0x33ac96,_0x29792c)=>{var _0xa22d97=_0x597725;_0x12c5fb[_0x29792c][_0xa22d97(0x126)]=_0x33ac96;}),_0x2dcaea[_0x597725(0xa4)]((_0x381f49,_0x52eab1)=>{_0x12c5fb[_0x52eab1]['from_storage']=_0x381f49;}),_0xfb4086[_0x597725(0xa4)]((_0x50e52d,_0x74b6c5)=>{var _0x10c1c3=_0x597725;_0x12c5fb[_0x74b6c5][_0x10c1c3(0x93)]=_0x50e52d;});const _0x4275e4=_0x12c5fb['filter'](_0xebb1d1=>_0xebb1d1[_0x597725(0xd0)]!=='0'&&_0xebb1d1['to_quantity']!==''||_0xebb1d1['to_floorlevel']!=='0'&&_0xebb1d1[_0x597725(0x137)]!=='');var _0x2e74cc=0x0;_0x4275e4[_0x597725(0xa4)](_0x3bdc43=>{var _0x1e0d31=_0x597725;parseInt(_0x3bdc43[_0x1e0d31(0x119)])<parseInt(_0x3bdc43[_0x1e0d31(0xd0)])&&_0x2e74cc++;});if(_0x2e74cc!=0x0)return _0x28c80d[_0x597725(0x149)]('errors',_0x597725(0xf1)),_0x2cca88[_0x597725(0xa5)](_0x597725(0x11e));const _0x367047=await warehouse[_0x597725(0xcc)]({'name':_0x526d2f['from_warehouse'],'room':_0x526d2f[_0x597725(0x142)]});_0x526d2f[_0x597725(0xdd)][_0x597725(0xa4)](_0x42f433=>{var _0x4dac7f=_0x597725;if(_0x42f433['to_quantity']>0x0){const _0x340ff5=_0x367047[_0x4dac7f(0xfe)][_0x4dac7f(0x151)](_0x561d2f=>{var _0x30d380=_0x4dac7f;_0x561d2f[_0x30d380(0xc3)]==_0x42f433[_0x30d380(0xc3)]&&_0x561d2f['floorlevel']==_0x42f433[_0x30d380(0x97)]&&_0x561d2f['type']==_0x42f433[_0x30d380(0xc0)]&&_0x561d2f[_0x30d380(0x111)]==_0x42f433[_0x30d380(0x107)]&&_0x561d2f[_0x30d380(0x181)]==_0x42f433[_0x30d380(0xe6)]&&_0x561d2f[_0x30d380(0xb8)]==_0x42f433[_0x30d380(0x93)]&&_0x561d2f[_0x30d380(0xf7)]==_0x42f433[_0x30d380(0xe5)]&&(_0x561d2f[_0x30d380(0x94)]=parseInt(_0x561d2f['product_stock'])+parseInt(_0x42f433[_0x30d380(0xd0)]));});}}),await _0x367047['save']();const _0x477b06=await warehouse[_0x597725(0xcc)]({'name':_0x526d2f[_0x597725(0xb0)],'room':_0x526d2f[_0x597725(0x10a)]});_0x526d2f['product'][_0x597725(0xa4)](_0x1bd709=>{var _0x1a9e16=_0x597725;if(_0x1bd709[_0x1a9e16(0xd0)]>0x0){const _0x57ca46=_0x477b06[_0x1a9e16(0xfe)]['map'](_0x46ba9f=>{var _0xf7aeb5=_0x1a9e16;_0x46ba9f[_0xf7aeb5(0xc3)]==_0x1bd709[_0xf7aeb5(0xc3)]&&_0x46ba9f[_0xf7aeb5(0xeb)]==_0x1bd709['to_floorlevel']&&_0x46ba9f['type']==_0x1bd709[_0xf7aeb5(0x126)]&&_0x46ba9f['bin']==_0x1bd709[_0xf7aeb5(0x174)]&&_0x46ba9f[_0xf7aeb5(0x181)]==_0x1bd709[_0xf7aeb5(0x163)]&&_0x46ba9f['rack']==_0x1bd709[_0xf7aeb5(0xb8)]&&_0x46ba9f[_0xf7aeb5(0xf7)]==_0x1bd709[_0xf7aeb5(0xf7)]&&(_0x46ba9f[_0xf7aeb5(0x94)]=parseInt(_0x46ba9f[_0xf7aeb5(0x94)])-parseInt(_0x1bd709[_0xf7aeb5(0xd0)]));});}}),await _0x477b06[_0x597725(0xb4)](),_0x526d2f[_0x597725(0x184)]=_0x36eb73,_0x526d2f[_0x597725(0x109)]=_0x15b2f,_0x526d2f[_0x597725(0xb0)]=_0x2cfb58,_0x526d2f[_0x597725(0xdd)]=_0x4275e4,_0x526d2f['note']=_0x376ef8,_0x526d2f[_0x597725(0xe9)]=_0x4e13d8;const _0x3fbf5d=await _0x526d2f[_0x597725(0xb4)]();console[_0x597725(0x146)](_0x3fbf5d);const _0x3ed9cf=await warehouse[_0x597725(0xcc)]({'name':_0x15b2f,'room':_0x3868a5});_0x3fbf5d[_0x597725(0xdd)][_0x597725(0xa4)](_0x2618fc=>{var _0x6050ce=_0x597725;if(_0x2618fc[_0x6050ce(0xd0)]>0x0){const _0x1d8a96=_0x3ed9cf[_0x6050ce(0xfe)][_0x6050ce(0x151)](_0x2dff5b=>{var _0x5b6554=_0x6050ce;_0x2dff5b[_0x5b6554(0xc3)]==_0x2618fc[_0x5b6554(0xc3)]&&_0x2dff5b[_0x5b6554(0xeb)]==_0x2618fc['from_floorlevel']&&_0x2dff5b['type']==_0x2618fc['from_types']&&_0x2dff5b[_0x5b6554(0x111)]==_0x2618fc[_0x5b6554(0x107)]&&_0x2dff5b[_0x5b6554(0x181)]==_0x2618fc[_0x5b6554(0xe6)]&&_0x2dff5b[_0x5b6554(0xb8)]==_0x2618fc[_0x5b6554(0x93)]&&_0x2dff5b[_0x5b6554(0xf7)]==_0x2618fc[_0x5b6554(0xe5)]&&(_0x2dff5b[_0x5b6554(0x94)]=parseInt(_0x2dff5b['product_stock'])-parseInt(_0x2618fc[_0x5b6554(0xd0)]));});}}),await _0x3ed9cf['save']();const _0x382d65=await warehouse[_0x597725(0xcc)]({'name':_0x2cfb58,'room':_0xbb5f52});_0x3fbf5d['product'][_0x597725(0xa4)](_0x803724=>{var _0x2010e0=_0x597725;if(_0x803724[_0x2010e0(0xd0)]>0x0){var _0x40a0d8=0x0;const _0x12148f=_0x382d65[_0x2010e0(0xfe)][_0x2010e0(0x151)](_0x5b353d=>{var _0x545962=_0x2010e0;_0x5b353d[_0x545962(0xc3)]==_0x803724['product_name']&&_0x5b353d[_0x545962(0xeb)]==_0x803724[_0x545962(0x137)]&&_0x5b353d[_0x545962(0xab)]==_0x803724[_0x545962(0x126)]&&_0x5b353d[_0x545962(0x111)]==_0x803724[_0x545962(0x174)]&&_0x5b353d['bay']==_0x803724[_0x545962(0x163)]&&_0x5b353d[_0x545962(0xb8)]==_0x803724['rack']&&_0x5b353d[_0x545962(0xf7)]==_0x803724['storage']&&(_0x5b353d[_0x545962(0x94)]=parseInt(_0x5b353d['product_stock'])+parseInt(_0x803724[_0x545962(0xd0)]),_0x40a0d8++);});_0x40a0d8=='0'&&(_0x382d65[_0x2010e0(0xfe)]=_0x382d65[_0x2010e0(0xfe)]['concat']({'product_name':_0x803724['product_name'],'product_stock':_0x803724[_0x2010e0(0xd0)],'bay':_0x803724[_0x2010e0(0x163)],'bin':_0x803724['to_bin'],'type':_0x803724['to_types'],'floorlevel':_0x803724['to_floorlevel'],'storage':_0x803724[_0x2010e0(0xf7)],'rack':_0x803724['rack'],'product_code':_0x803724['product_code'],'primary_code':_0x803724[_0x2010e0(0x16c)],'secondary_code':_0x803724['secondary_code'],'maxProducts':_0x803724[_0x2010e0(0x178)],'storage':_0x803724[_0x2010e0(0xf7)],'rack':_0x803724[_0x2010e0(0xb8)]}));}}),await _0x382d65[_0x597725(0xb4)](),_0x28c80d['flash'](_0x597725(0xfd),_0x597725(0xba)),_0x2cca88[_0x597725(0xa5)](_0x597725(0x169));}catch(_0x232241){console[_0x597725(0x146)](_0x232241);}}),router[a0_0xff52d4(0x121)](a0_0xff52d4(0x110),async(_0x26a5b4,_0x160c8c)=>{var _0x360acc=a0_0xff52d4;const {FromWareHouse:_0x2f7908,FromRoom:_0x57222d,ToWarehouse:_0x1117d1,ToRoom:_0x135e3d,primary_code:_0x162fe3,Roomslist:_0x5c7cae}=_0x26a5b4[_0x360acc(0xfa)],_0x4535f2=_0x5c7cae['split'](','),_0x28456a=[];async function _0x557f09(_0x245f6d){var _0x4be1c4=_0x360acc;const _0xe583ce=await warehouse['aggregate']([{'$match':{'name':_0x2f7908,'room':_0x245f6d}},{'$unwind':_0x4be1c4(0x154)},{'$match':{'product_details.primary_code':_0x162fe3}},{'$group':{'_id':_0x4be1c4(0xc6),'name':{'$first':_0x4be1c4(0x160)},'instock':{'$first':_0x4be1c4(0x15b)},'primary_code':{'$first':_0x4be1c4(0xaa)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4be1c4(0x8d)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4be1c4(0xdf)},'unit':{'$first':_0x4be1c4(0xd6)},'secondary_unit':{'$first':_0x4be1c4(0x9a)},'storage':{'$first':_0x4be1c4(0x172)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4be1c4(0xb1)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x4be1c4(0x116)},'maxProducts':{'$first':_0x4be1c4(0xbd)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x2ce3d5=await warehouse[_0x4be1c4(0x162)]([{'$match':{'name':_0x2f7908,'room':_0x245f6d}},{'$unwind':_0x4be1c4(0x154)},{'$match':{'product_details.secondary_code':_0x162fe3}},{'$group':{'_id':_0x4be1c4(0xc6),'name':{'$first':_0x4be1c4(0x160)},'instock':{'$first':_0x4be1c4(0x15b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4be1c4(0x12e)},'product_code':{'$first':_0x4be1c4(0x8d)},'level':{'$first':_0x4be1c4(0xf2)},'isle':{'$first':_0x4be1c4(0xd1)},'type':{'$first':_0x4be1c4(0x14a)},'pallet':{'$first':_0x4be1c4(0xdf)},'unit':{'$first':_0x4be1c4(0xd6)},'secondary_unit':{'$first':_0x4be1c4(0x9a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4be1c4(0x166)},'expiry_date':{'$first':_0x4be1c4(0xd2)},'production_date':{'$first':_0x4be1c4(0xb1)},'batch_code':{'$first':_0x4be1c4(0x16f)},'maxPerUnit':{'$first':_0x4be1c4(0x100)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x4be1c4(0xb2)}}}]);if(_0xe583ce['length']>0x0)_0x28456a[_0x4be1c4(0x12c)](_0xe583ce);else _0x2ce3d5[_0x4be1c4(0x8f)]>0x0&&_0x28456a[_0x4be1c4(0x12c)](_0x2ce3d5);}const _0x4b0a40=_0x4535f2[_0x360acc(0x151)](_0x229945=>_0x557f09(_0x229945));await Promise['all'](_0x4b0a40),_0x160c8c[_0x360acc(0x182)](_0x28456a);}),router[a0_0xff52d4(0x121)](a0_0xff52d4(0x140),async(_0x1193bb,_0x1d1e60)=>{var _0x2d7bc6=a0_0xff52d4;try{const {FromWareHouse:_0xc41215,FromRoom:_0x4732e5,ToWarehouse:_0x402a08,ToRoom:_0x10755e,secondary_code:_0x2ad920}=_0x1193bb[_0x2d7bc6(0xfa)],_0x2491d1=await warehouse[_0x2d7bc6(0x162)]([{'$match':{'name':_0xc41215}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2ad920}},{'$group':{'_id':_0x2d7bc6(0xc6),'name':{'$first':_0x2d7bc6(0x160)},'primary_code':{'$first':_0x2d7bc6(0xaa)},'secondary_code':{'$first':_0x2d7bc6(0x12e)},'product_code':{'$first':_0x2d7bc6(0x8d)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x2d7bc6(0x170)},'isle':{'$first':_0x2d7bc6(0xa7)},'pallet':{'$first':_0x2d7bc6(0x11c)},'maxProducts':{'$first':_0x2d7bc6(0xbd)},'unit':{'$first':_0x2d7bc6(0xd6)}}}]);_0x1d1e60[_0x2d7bc6(0xd9)](0xc8)[_0x2d7bc6(0x182)](_0x2491d1);}catch(_0x2be658){_0x1d1e60[_0x2d7bc6(0xd9)](0x194)[_0x2d7bc6(0x182)]({'message':_0x2be658[_0x2d7bc6(0x13f)]});}}),router[a0_0xff52d4(0x121)]('/barcode_scanner3',async(_0x4d0560,_0x51488a)=>{var _0x2ec6dc=a0_0xff52d4;try{const {FromWareHouse:_0x2cdc51,FromRoom:_0x5172ec,ToWarehouse:_0x224bf9,ToRoom:_0x43be74,product_code:_0x115661}=_0x4d0560[_0x2ec6dc(0xfa)],_0x92848b=await warehouse[_0x2ec6dc(0x162)]([{'$match':{'name':_0x2cdc51}},{'$unwind':_0x2ec6dc(0x154)},{'$match':{'product_details.product_code':_0x115661}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x2ec6dc(0xaa)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2ec6dc(0x8d)},'instock':{'$first':_0x2ec6dc(0x15b)},'warehouse':{'$first':_0x2ec6dc(0x13d)},'level':{'$first':_0x2ec6dc(0x170)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x2ec6dc(0x11c)},'maxProducts':{'$first':_0x2ec6dc(0xbd)},'unit':{'$first':'$product_details.unit'}}}]);_0x51488a[_0x2ec6dc(0xd9)](0xc8)[_0x2ec6dc(0x182)](_0x92848b);}catch(_0x3c4b7a){_0x51488a[_0x2ec6dc(0xd9)](0x194)[_0x2ec6dc(0x182)]({'message':_0x3c4b7a[_0x2ec6dc(0x13f)]});}}),router[a0_0xff52d4(0x121)]('/CheckingWarehouse',async(_0x125a48,_0x3f5c49)=>{var _0x4a78a9=a0_0xff52d4;const {level:_0x5963dd,isle:_0x44e4f2,pallet:_0x2f121,warehouses:_0x206eac,room:_0x394bae}=_0x125a48[_0x4a78a9(0xfa)];try{const _0x484bae=await warehouse[_0x4a78a9(0x162)]([{'$match':{'name':_0x206eac,'room':_0x394bae}},{'$unwind':_0x4a78a9(0x154)},{'$match':{'product_details.level':parseInt(_0x5963dd),'product_details.isle':_0x44e4f2,'product_details.pallet':parseInt(_0x2f121)}},{'$group':{'_id':_0x4a78a9(0xc6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x4a78a9(0x170)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x4a78a9(0x11c)},'maxProducts':{'$first':_0x4a78a9(0xbd)}}}]);_0x3f5c49[_0x4a78a9(0xd9)](0xc8)['json'](_0x484bae);}catch(_0x2cfa70){_0x3f5c49['status'](0x194)[_0x4a78a9(0x182)]({'message':_0x2cfa70[_0x4a78a9(0x13f)]});}}),module[a0_0xff52d4(0xa0)]=router;