var a0_0x1c04e8=a0_0x4427;function a0_0x4464(){var _0x122ca4=['secondary_unit','role','push','Arabic\x20(ae)','add_transfer','exports','product_name','Raw\x20Materials','from_prod_level','</table>','../middleware/auth','$product_details.type','catch','$product_details.maxPerUnit','True','$name','$product_details.product_name','to_prod_isle','Arabic','Error\x20Occurs','$product_details.storage','from_invoice','edit_transfer_view','host','edit_transfer','master','updateOne','Router','getDate','floor','$room','warehouse','save','secondary_code','Rack\x20C','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Shelves','<h2>\x20','/barcode_scanner3','prod_cat','Portuguese\x20(BR)','from_room','map','../public/language/languages.json','548nNGkQk','<table\x20style=\x22width:\x20100%\x20!important;\x22>','948564Hvagzd','rack','errors','Transfer\x20Finalize\x20Successfully','</head><body>','from_prod_isle','floorlevel','status','staff','invoice','port','$product_details.unit','prod_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','\x20<>\x20','/../public','split','2854710oYzkBh','Floor','forEach','from_storage','Rack\x20E','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.product_stock','to_floorlevel','email','id_transaction','body','to_warehouse','rak','$product.to_room_name','filter','<tbody\x20style=\x22text-align:\x20center;\x22>','then','</div>','Transfer\x20Mail','unit','$product_details.production_date','$product_details','<hr\x20class=\x22my-3\x22>','RMSEmail','from_quantity','redirect','$_id','$product_details.bay','$product_details.pallet','/transfer/view','site_title','from_rack','</td>','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','420390muEprq','Chinese','message','createTransport','findOne','An\x20error\x20occurred.','Email\x20sent\x20successfully','DRY\x20STORAGE','/upload/','Logo.png','Return\x20Rooms','maxperunit','New_Qty_Converted','../models/all_models','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.product_code','$product','string','$product_details.bin','/CheckingWarehouse','\x20Order\x20Date\x20:\x20','<div>','7XxvjUs','max_per_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','logo','French','batch_code','$product_details.floorlevel','to_prod_level','json','321728wkOekx','error','padStart','getFullYear','Rack\x20A','all','ToRoomAssigned','/preview/:id','$product_details.primary_code','language','$from_warehouse','$product_details.secondary_unit','to_bay','from_floorlevel','random','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.invoice','<strong>\x20Regards\x20</strong>','To_invoice','getMonth','to_bin','<tr>','find','/view/add_transfer','</body></html>','Transfer\x20Edit\x20Successfully','primary_code','Rack\x20B','$product_details.batch_code','</span>','$product_details.secondary_code','72qisSOQ','get','from_prod_qty','user','length','to_room','3601150IjQgEh','</tr>','$product_details.isle','from_warehouse','sendMail','product_code','7479yORByF','concat','There\x27s\x20a\x20error\x20in\x20this\x20transaction','from_prod_pallet','Portuguese','from_rak','German','COLD\x20STORAGE','render','Product\x20Transfer\x20successfully','expiry_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<h5>','primary_unit','id_transaction_id','Receiving\x20Area','product','type','to_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','product_stock','transfer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','success','bay','$date','flash','Level','product_code3','RoomAssigned','$finalize','Enabled','$product_details.maxProducts','from_types','express','Ambient','$invoice','findById','3670TdHkEV','to_prod_qty','TRF-','date','aggregate','$product_details.level','from_room_name','/view/:id','nodemailer','</h5>','slice','$product_details.rack','to_prod_pallet','product_details','params','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','image','Hindi','MaxStocks_data2','production_date','Rack\x20D','$product_details._id','English\x20(US)','post','An\x20error\x20occurred\x20while\x20saving\x20data.','password','English','to_types','maxProducts','/picking_list/PDF_transfer_rm/','storage','Spanish','toString','from_bin','\x20Order\x20Number\x20:\x20','/barcode_scanner','bin','to_room_name','from_bay','$product_details.expiry_date'];a0_0x4464=function(){return _0x122ca4;};return a0_0x4464();}(function(_0x297fff,_0x4cdfe3){var _0x7b065d=a0_0x4427,_0x1a4d37=_0x297fff();while(!![]){try{var _0xecfea0=parseInt(_0x7b065d(0x259))/0x1*(-parseInt(_0x7b065d(0x24d))/0x2)+-parseInt(_0x7b065d(0x1db))/0x3+parseInt(_0x7b065d(0x1d9))/0x4*(parseInt(_0x7b065d(0x27f))/0x5)+-parseInt(_0x7b065d(0x20f))/0x6+-parseInt(_0x7b065d(0x225))/0x7*(-parseInt(_0x7b065d(0x22e))/0x8)+parseInt(_0x7b065d(0x1ec))/0x9+parseInt(_0x7b065d(0x253))/0xa;if(_0xecfea0===_0x4cdfe3)break;else _0x1a4d37['push'](_0x1a4d37['shift']());}catch(_0x4408ef){_0x1a4d37['push'](_0x1a4d37['shift']());}}}(a0_0x4464,0x27b16));const express=require(a0_0x1c04e8(0x27b)),app=express(),router=express[a0_0x1c04e8(0x1c8)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x1c04e8(0x21c)),auth=require(a0_0x1c04e8(0x1b7)),users=require(a0_0x1c04e8(0x1d8)),nodemailer=require(a0_0x1c04e8(0x18d));router[a0_0x1c04e8(0x24e)]('/view',auth,async(_0x3da149,_0x1a58c2)=>{var _0x5536f4=a0_0x1c04e8;try{const {username:_0x13deeb,email:_0x75868d,role:_0x1af0dc}=_0x3da149[_0x5536f4(0x250)],_0x1c75a7=_0x3da149[_0x5536f4(0x250)],_0x5804f7=await profile[_0x5536f4(0x213)]({'email':_0x1c75a7[_0x5536f4(0x1f4)]}),_0x636c=await master_shop[_0x5536f4(0x244)]();console['log']('master',_0x636c);let _0x1209ee;if(_0x1c75a7[_0x5536f4(0x1ae)]==_0x5536f4(0x1e3)){const _0x444205=await staff[_0x5536f4(0x213)]({'email':_0x1c75a7['email']});_0x1209ee=await transfers[_0x5536f4(0x244)]({'from_warehouse':_0x444205[_0x5536f4(0x1cc)]});}else _0x1209ee=await transfers[_0x5536f4(0x189)]([{'$unwind':_0x5536f4(0x21f)},{'$group':{'_id':_0x5536f4(0x206),'invoice':{'$first':_0x5536f4(0x27d)},'date':{'$first':_0x5536f4(0x272)},'from_warehouse':{'$first':_0x5536f4(0x238)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x5536f4(0x1f9)},'finalize':{'$first':_0x5536f4(0x277)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x636c[0x0][_0x5536f4(0x237)]==_0x5536f4(0x19b)){var _0x3fe544=users[_0x5536f4(0x19f)];console[_0x5536f4(0x20d)](_0x3fe544);}else{if(_0x636c[0x0][_0x5536f4(0x237)]=='Hindi')var _0x3fe544=users[_0x5536f4(0x196)];else{if(_0x636c[0x0][_0x5536f4(0x237)]=='German')var _0x3fe544=users[_0x5536f4(0x25f)];else{if(_0x636c[0x0][_0x5536f4(0x237)]=='Spanish')var _0x3fe544=users[_0x5536f4(0x1a4)];else{if(_0x636c[0x0][_0x5536f4(0x237)]==_0x5536f4(0x229))var _0x3fe544=users[_0x5536f4(0x229)];else{if(_0x636c[0x0][_0x5536f4(0x237)]==_0x5536f4(0x1d5))var _0x3fe544=users['Portuguese'];else{if(_0x636c[0x0]['language']=='Chinese')var _0x3fe544=users[_0x5536f4(0x210)];else{if(_0x636c[0x0][_0x5536f4(0x237)]==_0x5536f4(0x1b0))var _0x3fe544=users[_0x5536f4(0x1bf)];}}}}}}}_0x1a58c2['render'](_0x5536f4(0x26e),{'success':_0x3da149['flash']('success'),'errors':_0x3da149[_0x5536f4(0x273)](_0x5536f4(0x1dd)),'role':_0x1c75a7,'profile':_0x5804f7,'master_shop':_0x636c,'transfer':_0x1209ee,'language':_0x3fe544});}catch(_0x3396a7){console[_0x5536f4(0x20d)](_0x3396a7);}});function a0_0x4427(_0x307b71,_0xa7a2a0){var _0x44643b=a0_0x4464();return a0_0x4427=function(_0x4427e9,_0x1d0c55){_0x4427e9=_0x4427e9-0x189;var _0x423b4e=_0x44643b[_0x4427e9];return _0x423b4e;},a0_0x4427(_0x307b71,_0xa7a2a0);}async function getRandom8DigitNumber(){var _0x17344b=a0_0x1c04e8;const _0x16098f=0x989680,_0x6432f4=0x5f5e0ff,_0x1466b3=Math[_0x17344b(0x1ca)](Math[_0x17344b(0x23c)]()*(_0x6432f4-_0x16098f+0x1))+_0x16098f;var _0x437b86;const _0xaa2914=await transfers['findOne']({'invoice':_0x17344b(0x281)+_0x1466b3});return _0xaa2914&&_0xaa2914[_0x17344b(0x251)]>0x0?_0x437b86=_0x17344b(0x281)+_0x1466b3:_0x437b86=_0x17344b(0x281)+_0x1466b3,_0x437b86;}router[a0_0x1c04e8(0x24e)](a0_0x1c04e8(0x245),auth,async(_0x23bac8,_0x2fbd9f)=>{var _0xf41e9d=a0_0x1c04e8;try{const {username:_0x5e7be3,email:_0x52361b,role:_0x373d70}=_0x23bac8['user'],_0x209929=_0x23bac8[_0xf41e9d(0x250)],_0x3f07dd=await profile[_0xf41e9d(0x213)]({'email':_0x209929[_0xf41e9d(0x1f4)]}),_0x268c29=await master_shop[_0xf41e9d(0x244)]();console[_0xf41e9d(0x20d)](_0xf41e9d(0x1c6),_0x268c29);let _0x3a79f9;if(_0x209929[_0xf41e9d(0x1ae)]==_0xf41e9d(0x1e3)){const _0x155b3b=await staff['findOne']({'email':_0x209929[_0xf41e9d(0x1f4)]});_0x3a79f9=await warehouse['aggregate']([{'$match':{'status':_0xf41e9d(0x278),'name':_0x155b3b[_0xf41e9d(0x1cc)],'warehouse_category':_0xf41e9d(0x1b4)}},{'$group':{'_id':_0xf41e9d(0x1bc),'name':{'$first':_0xf41e9d(0x1bc)}}}]);}else _0x3a79f9=await warehouse['aggregate']([{'$match':{'status':_0xf41e9d(0x278),'warehouse_category':_0xf41e9d(0x1b4)}},{'$group':{'_id':'$name','name':{'$first':_0xf41e9d(0x1bc)}}}]);var _0xfa5a4d=[_0xf41e9d(0x27c),'Enclosed',_0xf41e9d(0x219)];const _0x120fc9=await transfers['find']({}),_0x54dbae=_0x120fc9[_0xf41e9d(0x251)]+0x1,_0x4a3345=_0xf41e9d(0x281)+_0x54dbae[_0xf41e9d(0x1a5)]()[_0xf41e9d(0x230)](0x5,'0');if(_0x268c29[0x0][_0xf41e9d(0x237)]==_0xf41e9d(0x19b)){var _0x148f9a=users[_0xf41e9d(0x19f)];console[_0xf41e9d(0x20d)](_0x148f9a);}else{if(_0x268c29[0x0][_0xf41e9d(0x237)]==_0xf41e9d(0x196))var _0x148f9a=users['Hindi'];else{if(_0x268c29[0x0][_0xf41e9d(0x237)]==_0xf41e9d(0x25f))var _0x148f9a=users['German'];else{if(_0x268c29[0x0][_0xf41e9d(0x237)]=='Spanish')var _0x148f9a=users[_0xf41e9d(0x1a4)];else{if(_0x268c29[0x0]['language']==_0xf41e9d(0x229))var _0x148f9a=users[_0xf41e9d(0x229)];else{if(_0x268c29[0x0][_0xf41e9d(0x237)]=='Portuguese\x20(BR)')var _0x148f9a=users[_0xf41e9d(0x25d)];else{if(_0x268c29[0x0][_0xf41e9d(0x237)]==_0xf41e9d(0x210))var _0x148f9a=users[_0xf41e9d(0x210)];else{if(_0x268c29[0x0]['language']=='Arabic\x20(ae)')var _0x148f9a=users['Arabic'];}}}}}}}const _0x3e04f8=getRandom8DigitNumber();_0x3e04f8[_0xf41e9d(0x1fc)](_0x419fce=>{var _0x1f5710=_0xf41e9d;_0x2fbd9f[_0x1f5710(0x261)](_0x1f5710(0x1b1),{'success':_0x23bac8[_0x1f5710(0x273)](_0x1f5710(0x270)),'errors':_0x23bac8['flash']('errors'),'role':_0x209929,'profile':_0x3f07dd,'master_shop':_0x268c29,'warehouse':_0x3a79f9,'language':_0x148f9a,'rooms_data':_0xfa5a4d,'invoice':_0x419fce});})[_0xf41e9d(0x1b9)](_0x2be16b=>{var _0x2fbfe1=_0xf41e9d;_0x23bac8[_0x2fbfe1(0x273)](_0x2fbfe1(0x1dd),_0x2fbfe1(0x25b)),_0x2fbd9f[_0x2fbfe1(0x205)]('/transfer/view');});}catch(_0xe7ab45){console[_0xf41e9d(0x20d)](_0xe7ab45);}}),router[a0_0x1c04e8(0x19c)](a0_0x1c04e8(0x245),auth,async(_0x619d95,_0x2b0a0c)=>{var _0x5ca2c0=a0_0x1c04e8;try{console[_0x5ca2c0(0x20d)](_0x619d95[_0x5ca2c0(0x1f6)]);const {date:_0x187005,from_warehouse:_0x31f8f4,FromRoom_name:_0x3868b6,to_warehouse:_0x3445ad,ToRoom_name:_0x15ade9,prod_name:_0xee1e2f,from_prod_qty:_0x520cf0,from_prod_level:_0x2e7bc9,from_prod_isle:_0x4e2fd0,from_prod_pallet:_0x2761e4,to_prod_qty:_0x5af7c5,to_prod_level:_0x41f764,to_prod_isle:_0x394e63,to_prod_pallet:_0xc766b4,primary_code:_0x1e2bba,secondary_code:_0xd1aaca,product_code3:_0x34ad71,note:_0x4bdd06,MaxStocks_data2:_0x3e5d61,invoice:_0x1ba994,expiry_date:_0x2981cd}=_0x619d95[_0x5ca2c0(0x1f6)];if(typeof _0xee1e2f=='string')var _0x4c3a6f=[_0x619d95[_0x5ca2c0(0x1f6)]['prod_name']],_0xa99f0b=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x24f)]],_0x6b40d1=[_0x619d95[_0x5ca2c0(0x1f6)]['from_prod_level']],_0x32a9c9=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x21b)]],_0x464e5d=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x22c)]],_0x11f684=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x248)]],_0x1e72ec=[_0x619d95['body'][_0x5ca2c0(0x1ce)]],_0x41fc2b=[_0x619d95['body'][_0x5ca2c0(0x275)]],_0x415269=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x197)]],_0x1a00fd=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x266)]],_0x31c3ee=[_0x619d95['body'][_0x5ca2c0(0x1ad)]],_0x4da6b2=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x22a)]],_0x29b4ec=[_0x619d95['body'][_0x5ca2c0(0x263)]],_0x2c306f=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x226)]],_0x5007e6=[_0x619d95['body']['production_date']],_0x4a6685=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x1d4)]],_0x405b5f=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x276)]],_0x43e489=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x234)]],_0x1f32ef=[_0x619d95['body'][_0x5ca2c0(0x1c2)]],_0x3dda0e=[_0x619d95[_0x5ca2c0(0x1f6)]['to_invoice']],_0x11573b=[_0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x1f5)]];else var _0x4c3a6f=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x1e7)]],_0xa99f0b=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x24f)]],_0x6b40d1=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x1b5)]],_0x32a9c9=[..._0x619d95['body'][_0x5ca2c0(0x21b)]],_0x464e5d=[..._0x619d95['body'][_0x5ca2c0(0x22c)]],_0x11f684=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x248)]],_0x1e72ec=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x1ce)]],_0x41fc2b=[..._0x619d95['body']['product_code3']],_0x415269=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x197)]],_0x1a00fd=[..._0x619d95['body'][_0x5ca2c0(0x266)]],_0x31c3ee=[..._0x619d95[_0x5ca2c0(0x1f6)]['secondary_unit']],_0x4da6b2=[..._0x619d95['body']['batch_code']],_0x29b4ec=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x263)]],_0x2c306f=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x226)]],_0x5007e6=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x198)]],_0x4a6685=[..._0x619d95[_0x5ca2c0(0x1f6)]['prod_cat']],_0x405b5f=[..._0x619d95['body']['RoomAssigned']],_0x43e489=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x234)]],_0x1f32ef=[..._0x619d95['body'][_0x5ca2c0(0x1c2)]],_0x3dda0e=[..._0x619d95[_0x5ca2c0(0x1f6)]['to_invoice']],_0x11573b=[..._0x619d95[_0x5ca2c0(0x1f6)][_0x5ca2c0(0x1f5)]];const _0x1bd214=_0x4c3a6f[_0x5ca2c0(0x1d7)](_0x36224b=>{return _0x36224b={'product_name':_0x36224b};});_0xa99f0b[_0x5ca2c0(0x1ee)]((_0x4b9162,_0x29bb9c)=>{var _0x598f40=_0x5ca2c0;_0x1bd214[_0x29bb9c][_0x598f40(0x204)]=_0x4b9162;}),_0x1f32ef[_0x5ca2c0(0x1ee)]((_0x397127,_0x1ab471)=>{var _0x5c2bac=_0x5ca2c0;_0x1bd214[_0x1ab471][_0x5c2bac(0x1c2)]=_0x397127;}),_0x3dda0e['forEach']((_0x4ee341,_0x423454)=>{var _0x1caa87=_0x5ca2c0;_0x1bd214[_0x423454][_0x1caa87(0x240)]=_0x4ee341;}),_0x11573b[_0x5ca2c0(0x1ee)]((_0x3e51b9,_0x1b1e66)=>{var _0x41cd5a=_0x5ca2c0;_0x1bd214[_0x1b1e66][_0x41cd5a(0x267)]=_0x3e51b9;}),_0x6b40d1[_0x5ca2c0(0x1ee)]((_0x2016c6,_0x279b2e)=>{var _0x44f679=_0x5ca2c0;_0x405b5f[_0x44f679(0x1ee)]((_0x246e43,_0x5ec31a)=>{var _0x3e828e=_0x44f679;if(_0x246e43==_0x3e828e(0x268)&&_0x279b2e==_0x5ec31a){var _0x58ad6c=_0x2016c6[_0x3e828e(0x18f)](0x3);_0x1bd214[_0x279b2e]['from_storage']=_0x2016c6[0x0],_0x1bd214[_0x279b2e]['from_rack']=_0x2016c6[0x1],_0x1bd214[_0x279b2e]['from_bay']=0x0,_0x1bd214[_0x279b2e][_0x3e828e(0x1a6)]=0x0,_0x1bd214[_0x279b2e][_0x3e828e(0x27a)]='Floor',_0x1bd214[_0x279b2e][_0x3e828e(0x23b)]=_0x58ad6c;}else{if(_0x246e43=='Shelves'&&_0x279b2e==_0x5ec31a){var _0x58ad6c=_0x2016c6['slice'](0x3);_0x1bd214[_0x279b2e][_0x3e828e(0x1ef)]=_0x2016c6[0x0],_0x1bd214[_0x279b2e][_0x3e828e(0x20b)]=_0x2016c6[0x1],_0x1bd214[_0x279b2e][_0x3e828e(0x1ab)]=0x0,_0x1bd214[_0x279b2e][_0x3e828e(0x1a6)]=0x0,_0x1bd214[_0x279b2e]['from_types']=_0x3e828e(0x1ed),_0x1bd214[_0x279b2e][_0x3e828e(0x23b)]=_0x2016c6[0x5];}else{if(_0x279b2e==_0x5ec31a){if(_0x2016c6[0x0]=='A'&&_0x2016c6[0x1]=='L'&&_0x2016c6[0x2]=='L')console['log'](_0x246e43+_0x3e828e(0x1e9)+_0x279b2e+_0x3e828e(0x1e9)+_0x5ec31a+_0x3e828e(0x1e9)+_0x2016c6+'here'),_0x1bd214[_0x279b2e][_0x3e828e(0x1ef)]=_0x2016c6[0x0],_0x1bd214[_0x279b2e][_0x3e828e(0x20b)]=_0x2016c6[0x1],_0x1bd214[_0x279b2e]['from_bay']=0x0,_0x1bd214[_0x279b2e][_0x3e828e(0x1a6)]=0x0,_0x1bd214[_0x279b2e][_0x3e828e(0x27a)]=_0x3e828e(0x1ed),_0x1bd214[_0x279b2e]['from_floorlevel']=_0x2016c6[0x3];else{var _0x18f6fe;if(_0x2016c6[0x4]=='L')_0x18f6fe=_0x3e828e(0x274);else _0x2016c6[0x4]=='F'&&(_0x18f6fe=_0x3e828e(0x1ed));_0x1bd214[_0x279b2e][_0x3e828e(0x1ef)]=_0x2016c6[0x0],_0x1bd214[_0x279b2e][_0x3e828e(0x20b)]=_0x2016c6[0x1],_0x1bd214[_0x279b2e][_0x3e828e(0x1ab)]=_0x2016c6[0x2],_0x1bd214[_0x279b2e]['from_bin']=_0x2016c6[0x3],_0x1bd214[_0x279b2e]['from_types']=_0x18f6fe,_0x1bd214[_0x279b2e][_0x3e828e(0x23b)]=_0x2016c6[0x5];}}}}});}),_0x32a9c9['forEach']((_0x65c548,_0x5016b2)=>{_0x1bd214[_0x5016b2]['to_quantity']=_0x65c548;}),_0x464e5d[_0x5ca2c0(0x1ee)]((_0x186055,_0x41dda1)=>{var _0x268b56=_0x5ca2c0;_0x43e489[_0x268b56(0x1ee)]((_0x12cb64,_0x3e7971)=>{var _0x2292be=_0x268b56;if(_0x12cb64==_0x2292be(0x268)&&_0x41dda1==_0x3e7971){var _0x592413=_0x186055[_0x2292be(0x18f)](0x3);_0x1bd214[_0x41dda1][_0x2292be(0x1a3)]=_0x186055[0x0],_0x1bd214[_0x41dda1]['rack']=_0x186055[0x1],_0x1bd214[_0x41dda1][_0x2292be(0x23a)]=0x0,_0x1bd214[_0x41dda1][_0x2292be(0x242)]=0x0,_0x1bd214[_0x41dda1][_0x2292be(0x1a0)]='Floor',_0x1bd214[_0x41dda1][_0x2292be(0x1f3)]=_0x592413;}else{if(_0x12cb64==_0x2292be(0x1d1)&&_0x41dda1==_0x3e7971){var _0x592413=_0x186055['slice'](0x3);_0x1bd214[_0x41dda1][_0x2292be(0x1a3)]=_0x186055[0x0],_0x1bd214[_0x41dda1][_0x2292be(0x1dc)]=_0x186055[0x1],_0x1bd214[_0x41dda1][_0x2292be(0x23a)]=0x0,_0x1bd214[_0x41dda1][_0x2292be(0x242)]=0x0,_0x1bd214[_0x41dda1]['to_types']=_0x2292be(0x1ed),_0x1bd214[_0x41dda1][_0x2292be(0x1f3)]=_0x186055[0x5];}else{if(_0x41dda1==_0x3e7971){if(_0x186055[0x0]=='A'&&_0x186055[0x1]=='L'&&_0x186055[0x2]=='L')console[_0x2292be(0x20d)](_0x12cb64+_0x2292be(0x1e9)+_0x41dda1+_0x2292be(0x1e9)+_0x3e7971+_0x2292be(0x1e9)+_0x186055+'here'),_0x1bd214[_0x41dda1][_0x2292be(0x1a3)]=_0x186055[0x0],_0x1bd214[_0x41dda1][_0x2292be(0x1dc)]=_0x186055[0x1],_0x1bd214[_0x41dda1][_0x2292be(0x23a)]=0x0,_0x1bd214[_0x41dda1][_0x2292be(0x242)]=0x0,_0x1bd214[_0x41dda1][_0x2292be(0x1a0)]=_0x2292be(0x1ed),_0x1bd214[_0x41dda1]['to_floorlevel']=_0x186055[0x3];else{var _0x5f4acc;if(_0x186055[0x4]=='L')_0x5f4acc=_0x2292be(0x274);else _0x186055[0x4]=='F'&&(_0x5f4acc='Floor');_0x1bd214[_0x41dda1][_0x2292be(0x1a3)]=_0x186055[0x0],_0x1bd214[_0x41dda1][_0x2292be(0x1dc)]=_0x186055[0x1],_0x1bd214[_0x41dda1][_0x2292be(0x23a)]=_0x186055[0x2],_0x1bd214[_0x41dda1]['to_bin']=_0x186055[0x3],_0x1bd214[_0x41dda1]['to_types']=_0x5f4acc,_0x1bd214[_0x41dda1]['to_floorlevel']=_0x186055[0x5];}}}}});}),_0x11f684[_0x5ca2c0(0x1ee)]((_0x25ec99,_0x161f89)=>{_0x1bd214[_0x161f89]['primary_code']=_0x25ec99;}),_0x1e72ec['forEach']((_0x247f30,_0xdb95b0)=>{var _0x253c22=_0x5ca2c0;_0x1bd214[_0xdb95b0][_0x253c22(0x1ce)]=_0x247f30;}),_0x41fc2b[_0x5ca2c0(0x1ee)]((_0x12b704,_0x14002e)=>{var _0x1641d1=_0x5ca2c0;_0x1bd214[_0x14002e][_0x1641d1(0x258)]=_0x12b704;}),_0x415269['forEach']((_0x5ed0c1,_0x274020)=>{var _0xf5b9d4=_0x5ca2c0;_0x1bd214[_0x274020][_0xf5b9d4(0x1a1)]=_0x5ed0c1;}),_0x1a00fd['forEach']((_0x55756b,_0x3a8fb6)=>{var _0x4cb293=_0x5ca2c0;_0x1bd214[_0x3a8fb6][_0x4cb293(0x1ff)]=_0x55756b;}),_0x31c3ee[_0x5ca2c0(0x1ee)]((_0xfe453e,_0x921ef4)=>{var _0x20bb3d=_0x5ca2c0;_0x1bd214[_0x921ef4][_0x20bb3d(0x1ad)]=_0xfe453e;}),_0x4da6b2[_0x5ca2c0(0x1ee)]((_0x5872b0,_0x9e69e1)=>{var _0x5f4fe5=_0x5ca2c0;_0x1bd214[_0x9e69e1][_0x5f4fe5(0x22a)]=_0x5872b0;}),_0x29b4ec[_0x5ca2c0(0x1ee)]((_0x17c5ee,_0x3eb1f7)=>{_0x1bd214[_0x3eb1f7]['expiry_date']=_0x17c5ee;}),_0x2c306f['forEach']((_0x1b4e9,_0x73ae32)=>{_0x1bd214[_0x73ae32]['maxperunit']=_0x1b4e9;}),_0x5007e6[_0x5ca2c0(0x1ee)]((_0x7d8216,_0x10d6b5)=>{var _0x54cb9a=_0x5ca2c0;_0x1bd214[_0x10d6b5][_0x54cb9a(0x198)]=_0x7d8216;}),_0x4a6685[_0x5ca2c0(0x1ee)]((_0x66352c,_0x3c1282)=>{var _0x2505f6=_0x5ca2c0;_0x1bd214[_0x3c1282][_0x2505f6(0x1d4)]=_0x66352c;}),_0x405b5f[_0x5ca2c0(0x1ee)]((_0x387d6c,_0x1d5aad)=>{var _0x2bf697=_0x5ca2c0;_0x1bd214[_0x1d5aad][_0x2bf697(0x18b)]=_0x387d6c;}),_0x43e489['forEach']((_0x19cbbc,_0x445394)=>{_0x1bd214[_0x445394]['to_room_name']=_0x19cbbc;});const _0x533c43=_0x1bd214[_0x5ca2c0(0x1fa)](_0x248690=>_0x248690[_0x5ca2c0(0x26b)]!=='0'&&_0x248690['to_quantity']!==''||_0x248690['to_floorlevel']!=='0'&&_0x248690[_0x5ca2c0(0x1f3)]!==''),_0x101a58=new transfers({'date':_0x187005,'from_warehouse':_0x31f8f4,'to_warehouse':_0x3445ad,'product':_0x533c43,'note':_0x4bdd06,'invoice':_0x1ba994}),_0x20e1cd=await _0x101a58[_0x5ca2c0(0x1cd)]();_0x619d95[_0x5ca2c0(0x273)](_0x5ca2c0(0x270),_0x5ca2c0(0x262)),_0x2b0a0c['redirect']('/transfer/preview/'+_0x20e1cd['_id']);}catch(_0x17067e){console['log'](_0x17067e),_0x2b0a0c[_0x5ca2c0(0x1e2)](0xc8)[_0x5ca2c0(0x22d)]({'errorMessage':_0x17067e[_0x5ca2c0(0x211)]});}}),router['get']('/preview/:id',auth,async(_0x5e2502,_0x14ba7d)=>{var _0x2a638c=a0_0x1c04e8;try{const {username:_0x4410b6,email:_0x91da70,role:_0x33a592}=_0x5e2502[_0x2a638c(0x250)],_0x1060b2=_0x5e2502[_0x2a638c(0x250)],_0x5c20e9=await profile['findOne']({'email':_0x1060b2[_0x2a638c(0x1f4)]}),_0x18f363=await master_shop['find']();console['log'](_0x2a638c(0x1c6),_0x18f363);const _0x3cdabd=await transfers[_0x2a638c(0x27e)](_0x5e2502['params']['id']);let _0x315c81=new Date(_0x3cdabd[_0x2a638c(0x263)]),_0x18cec7=('0'+_0x315c81[_0x2a638c(0x1c9)]())[_0x2a638c(0x18f)](-0x2),_0x3189b8=('0'+(_0x315c81[_0x2a638c(0x241)]()+0x1))[_0x2a638c(0x18f)](-0x2),_0x1a5c5b=_0x315c81[_0x2a638c(0x231)](),_0x4248f1=_0x1a5c5b+'-'+_0x3189b8+'-'+_0x18cec7,_0x57ffdd;if(_0x1060b2[_0x2a638c(0x1ae)]==_0x2a638c(0x1e3)){const _0x1d4f5a=await staff[_0x2a638c(0x213)]({'email':_0x1060b2[_0x2a638c(0x1f4)]});_0x57ffdd=await warehouse['find']({'status':'Enabled','name':_0x1d4f5a['warehouse'],'warehouse_category':_0x2a638c(0x1b4)});}else _0x57ffdd=await warehouse[_0x2a638c(0x244)]({'status':_0x2a638c(0x278),'warehouse_category':_0x2a638c(0x1b4)});const _0x15c229=await warehouse[_0x2a638c(0x189)]([{'$match':{'name':_0x3cdabd[_0x2a638c(0x256)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2a638c(0x19a),'name':{'$first':_0x2a638c(0x1bd)},'product_stock':{'$first':_0x2a638c(0x1f2)},'bay':{'$first':_0x2a638c(0x207)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2a638c(0x1b8)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2a638c(0x236)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2a638c(0x21e)},'storage':{'$first':_0x2a638c(0x1c1)},'rack':{'$first':_0x2a638c(0x190)},'expiry_date':{'$first':_0x2a638c(0x1ac)},'production_date':{'$first':_0x2a638c(0x200)},'room':{'$first':'$room'}}}]);if(_0x18f363[0x0][_0x2a638c(0x237)]=='English\x20(US)'){var _0x4014d9=users['English'];console[_0x2a638c(0x20d)](_0x4014d9);}else{if(_0x18f363[0x0][_0x2a638c(0x237)]==_0x2a638c(0x196))var _0x4014d9=users['Hindi'];else{if(_0x18f363[0x0][_0x2a638c(0x237)]=='German')var _0x4014d9=users[_0x2a638c(0x25f)];else{if(_0x18f363[0x0][_0x2a638c(0x237)]==_0x2a638c(0x1a4))var _0x4014d9=users['Spanish'];else{if(_0x18f363[0x0][_0x2a638c(0x237)]=='French')var _0x4014d9=users[_0x2a638c(0x229)];else{if(_0x18f363[0x0][_0x2a638c(0x237)]=='Portuguese\x20(BR)')var _0x4014d9=users[_0x2a638c(0x25d)];else{if(_0x18f363[0x0]['language']==_0x2a638c(0x210))var _0x4014d9=users[_0x2a638c(0x210)];else{if(_0x18f363[0x0][_0x2a638c(0x237)]==_0x2a638c(0x1b0))var _0x4014d9=users[_0x2a638c(0x1bf)];}}}}}}}_0x14ba7d[_0x2a638c(0x261)](_0x2a638c(0x1c3),{'success':_0x5e2502[_0x2a638c(0x273)]('success'),'errors':_0x5e2502[_0x2a638c(0x273)](_0x2a638c(0x1dd)),'role':_0x1060b2,'profile':_0x5c20e9,'master_shop':_0x18f363,'warehouse':_0x57ffdd,'transfer':_0x3cdabd,'stock':_0x15c229,'language':_0x4014d9});}catch(_0x389e3f){console[_0x2a638c(0x20d)](_0x389e3f);}}),router[a0_0x1c04e8(0x19c)](a0_0x1c04e8(0x235),auth,async(_0x4d45c7,_0x3b8fea)=>{var _0xa6a4f8=a0_0x1c04e8;try{const _0x3f8d9d=_0x4d45c7[_0xa6a4f8(0x193)]['id'],{from_warehouse:_0x3a5776,FromRoom_name:_0x383538,to_warehouse:_0x4aea06,ToRoom_name:_0x10dc94}=_0x4d45c7['body'],_0x5a13fc=await transfers[_0xa6a4f8(0x27e)]({'_id':_0x3f8d9d}),_0x4649a4=_0x5a13fc['product'][_0xa6a4f8(0x1d7)](async _0x506bbf=>{var _0x90635b=_0xa6a4f8;if(_0x506bbf[_0x90635b(0x26b)]>0x0){var _0x3b2a14=await warehouse[_0x90635b(0x213)]({'name':_0x5a13fc['from_warehouse'],'room':_0x506bbf[_0x90635b(0x18b)],'warehouse_category':_0x90635b(0x1b4)});const _0x1e8a63=_0x3b2a14[_0x90635b(0x192)][_0x90635b(0x1d7)](_0x165a03=>{var _0xaf9d1e=_0x90635b;_0x165a03['product_name']==_0x506bbf[_0xaf9d1e(0x1b3)]&&_0x165a03[_0xaf9d1e(0x1e1)]==_0x506bbf[_0xaf9d1e(0x23b)]&&_0x165a03['type']==_0x506bbf['from_types']&&_0x165a03[_0xaf9d1e(0x1a9)]==_0x506bbf[_0xaf9d1e(0x1a6)]&&_0x165a03[_0xaf9d1e(0x271)]==_0x506bbf['from_bay']&&_0x165a03[_0xaf9d1e(0x1dc)]==_0x506bbf['from_rack']&&_0x165a03[_0xaf9d1e(0x1a3)]==_0x506bbf[_0xaf9d1e(0x1ef)]&&_0x165a03[_0xaf9d1e(0x263)]==_0x506bbf[_0xaf9d1e(0x263)]&&_0x165a03['batch_code']==_0x506bbf[_0xaf9d1e(0x22a)]&&_0x165a03[_0xaf9d1e(0x198)]==_0x506bbf[_0xaf9d1e(0x198)]&&_0x165a03[_0xaf9d1e(0x1e4)]==_0x506bbf['from_invoice']&&_0x165a03['_id']==_0x506bbf[_0xaf9d1e(0x267)]&&(_0x165a03[_0xaf9d1e(0x26d)]=_0x165a03['product_stock']-_0x506bbf['to_quantity']);});}return _0x3b2a14;});Promise[_0xa6a4f8(0x233)](_0x4649a4)['then'](async _0x5c8c2f=>{var _0x365869=_0xa6a4f8;try{for(const _0x5c4105 of _0x5c8c2f){await _0x5c4105[_0x365869(0x1cd)]();}try{const _0x2aafb0=_0x5a13fc[_0x365869(0x269)][_0x365869(0x1d7)](async _0x293a1d=>{var _0x58a4fb=_0x365869;if(_0x293a1d[_0x58a4fb(0x26b)]>0x0){var _0x212168=await warehouse['findOne']({'name':_0x5a13fc[_0x58a4fb(0x1f7)],'room':_0x293a1d['to_room_name'],'warehouse_category':'Raw\x20Materials'}),_0x1a076d=0x0;const _0x2685d9=_0x212168[_0x58a4fb(0x192)][_0x58a4fb(0x1d7)](_0x170c5e=>{var _0x4c5103=_0x58a4fb;_0x170c5e[_0x4c5103(0x1b3)]==_0x293a1d[_0x4c5103(0x1b3)]&&_0x170c5e[_0x4c5103(0x1e1)]==_0x293a1d['to_floorlevel']&&_0x170c5e[_0x4c5103(0x26a)]==_0x293a1d[_0x4c5103(0x1a0)]&&_0x170c5e['bin']==_0x293a1d[_0x4c5103(0x242)]&&_0x170c5e['bay']==_0x293a1d['to_bay']&&_0x170c5e[_0x4c5103(0x1dc)]==_0x293a1d['rack']&&_0x170c5e[_0x4c5103(0x1a3)]==_0x293a1d[_0x4c5103(0x1a3)]&&_0x170c5e[_0x4c5103(0x263)]==_0x293a1d[_0x4c5103(0x263)]&&_0x170c5e[_0x4c5103(0x22a)]==_0x293a1d[_0x4c5103(0x22a)]&&_0x170c5e[_0x4c5103(0x198)]==_0x293a1d['production_date']&&_0x170c5e[_0x4c5103(0x1e4)]==_0x293a1d[_0x4c5103(0x240)]&&(_0x170c5e['product_stock']=_0x170c5e[_0x4c5103(0x26d)]+_0x293a1d['to_quantity'],_0x1a076d++);});_0x1a076d=='0'&&(_0x212168[_0x58a4fb(0x192)]=_0x212168[_0x58a4fb(0x192)][_0x58a4fb(0x25a)]({'product_name':_0x293a1d[_0x58a4fb(0x1b3)],'product_stock':_0x293a1d[_0x58a4fb(0x26b)],'bay':_0x293a1d[_0x58a4fb(0x23a)],'bin':_0x293a1d[_0x58a4fb(0x242)],'type':_0x293a1d[_0x58a4fb(0x1a0)],'floorlevel':_0x293a1d[_0x58a4fb(0x1f3)],'storage':_0x293a1d[_0x58a4fb(0x1a3)],'rack':_0x293a1d['rack'],'product_code':_0x293a1d['product_code'],'primary_code':_0x293a1d[_0x58a4fb(0x248)],'secondary_code':_0x293a1d[_0x58a4fb(0x1ce)],'maxProducts':_0x293a1d['maxProducts'],'storage':_0x293a1d[_0x58a4fb(0x1a3)],'rack':_0x293a1d[_0x58a4fb(0x1dc)],'expiry_date':_0x293a1d[_0x58a4fb(0x263)],'maxPerUnit':_0x293a1d[_0x58a4fb(0x21a)],'batch_code':_0x293a1d[_0x58a4fb(0x22a)],'production_date':_0x293a1d['production_date']}));}return _0x212168;});Promise['all'](_0x2aafb0)['then'](async _0x42ce9d=>{var _0x3d4da0=_0x365869;try{for(const _0x291dab of _0x42ce9d){await warehouse[_0x3d4da0(0x1c7)]({'_id':_0x291dab['_id']},{'$addToSet':{'product_details':{'$each':_0x291dab['product_details']}}});}_0x5a13fc['finalize']=_0x3d4da0(0x1bb);const _0xd85e46=await _0x5a13fc[_0x3d4da0(0x1cd)](),_0x4e4d07=await master_shop[_0x3d4da0(0x244)](),_0x4c58d9=await email_settings['findOne'](),_0x15bf16=await supervisor_settings[_0x3d4da0(0x244)]();var _0x52b6b6=_0x5a13fc['product'],_0x29929a='',_0x5ac2a7;for(_0x5ac2a7 in _0x52b6b6){_0x29929a+='<tr>'+_0x3d4da0(0x264)+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x1b3)]+_0x3d4da0(0x20c)+_0x3d4da0(0x264)+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x258)]+'</td>'+_0x3d4da0(0x264)+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x26b)]+_0x3d4da0(0x20c)+_0x3d4da0(0x264)+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x1ff)]+_0x3d4da0(0x20c)+_0x3d4da0(0x264)+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x1ad)]+_0x3d4da0(0x20c)+_0x3d4da0(0x264)+_0x5a13fc[_0x3d4da0(0x1f7)]+_0x3d4da0(0x20c)+_0x3d4da0(0x264)+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x1aa)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x1a3)]+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x1dc)]+_0x52b6b6[_0x5ac2a7]['to_bay']+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x242)]+_0x52b6b6[_0x5ac2a7][_0x3d4da0(0x1a0)][0x0]+_0x52b6b6[_0x5ac2a7]['to_floorlevel']+_0x3d4da0(0x20c),_0x3d4da0(0x254);}let _0x1e522d=nodemailer[_0x3d4da0(0x212)]({'host':_0x4c58d9[_0x3d4da0(0x1c4)],'port':Number(_0x4c58d9[_0x3d4da0(0x1e5)]),'secure':![],'auth':{'user':_0x4c58d9[_0x3d4da0(0x1f4)],'pass':_0x4c58d9[_0x3d4da0(0x19e)]}}),_0x464d3c={'from':_0x4c58d9[_0x3d4da0(0x1f4)],'to':_0x15bf16[0x0][_0x3d4da0(0x203)],'subject':_0x3d4da0(0x1fe),'attachments':[{'filename':_0x3d4da0(0x218),'path':__dirname+_0x3d4da0(0x1ea)+_0x3d4da0(0x217)+_0x4e4d07[0x0][_0x3d4da0(0x195)],'cid':_0x3d4da0(0x228)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x3d4da0(0x1df)+_0x3d4da0(0x224)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x3d4da0(0x224)+_0x3d4da0(0x1d0)+_0x3d4da0(0x1fd)+_0x3d4da0(0x224)+_0x3d4da0(0x1d2)+_0x4e4d07[0x0][_0x3d4da0(0x20a)]+'\x20</h2>'+_0x3d4da0(0x1fd)+_0x3d4da0(0x1fd)+_0x3d4da0(0x202)+_0x3d4da0(0x224)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3d4da0(0x1a7)+_0x5a13fc[_0x3d4da0(0x1e4)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x3d4da0(0x223)+_0x5a13fc[_0x3d4da0(0x282)]+'\x20'+_0x3d4da0(0x24b)+_0x3d4da0(0x18e)+_0x3d4da0(0x1fd)+_0x3d4da0(0x1da)+_0x3d4da0(0x1f1)+_0x3d4da0(0x243)+_0x3d4da0(0x1e8)+_0x3d4da0(0x227)+_0x3d4da0(0x20e)+_0x3d4da0(0x21d)+_0x3d4da0(0x26c)+_0x3d4da0(0x26f)+_0x3d4da0(0x194)+_0x3d4da0(0x23d)+_0x3d4da0(0x254)+'</thead>'+_0x3d4da0(0x1fb)+'\x20'+_0x29929a+'\x20'+'</tbody>'+_0x3d4da0(0x1b6)+'<div>'+_0x3d4da0(0x23f)+_0x3d4da0(0x265)+_0x4e4d07[0x0][_0x3d4da0(0x20a)]+_0x3d4da0(0x18e)+'</div>'+_0x3d4da0(0x1fd)+_0x3d4da0(0x246)};_0x1e522d[_0x3d4da0(0x257)](_0x464d3c,function(_0x9ee5fa,_0x2fd6f3){var _0x3b91d7=_0x3d4da0;_0x9ee5fa?(console[_0x3b91d7(0x20d)](_0x9ee5fa),console[_0x3b91d7(0x20d)](_0x3b91d7(0x1c0))):console['log'](_0x3b91d7(0x215));}),_0x4d45c7[_0x3d4da0(0x273)]('success',_0x3d4da0(0x1de)),_0x3b8fea['redirect'](_0x3d4da0(0x1a2)+_0xd85e46['_id']);}catch(_0x57c7e8){console[_0x3d4da0(0x22f)](_0x57c7e8),_0x3b8fea[_0x3d4da0(0x1e2)](0x1f4)[_0x3d4da0(0x22d)]({'Perror':_0x3d4da0(0x19d),'message':_0x57c7e8['message']});}})[_0x365869(0x1b9)](_0x1ab3ac=>{var _0x340a03=_0x365869;console[_0x340a03(0x22f)](_0x1ab3ac),_0x3b8fea['status'](0x1f4)[_0x340a03(0x22d)]({'Perror':_0x340a03(0x214)});});}catch(_0x4c38dd){_0x3b8fea[_0x365869(0x22d)](_0x4c38dd);}}catch(_0x3726d8){console[_0x365869(0x22f)](_0x3726d8),_0x3b8fea[_0x365869(0x1e2)](0x1f4)[_0x365869(0x22d)]({'Merror':_0x365869(0x19d),'Message':_0x3726d8[_0x365869(0x211)]});}})[_0xa6a4f8(0x1b9)](_0x110dbf=>{var _0x232119=_0xa6a4f8;console[_0x232119(0x22f)](_0x110dbf),_0x3b8fea['status'](0x1f4)[_0x232119(0x22d)]({'Merror':_0x232119(0x214)});});}catch(_0x54f66d){console[_0xa6a4f8(0x20d)](_0x54f66d);}});function BayBinSelected(_0x41ccde,_0x3cd53d){var _0x1e7362=a0_0x1c04e8,_0x36e332=[],_0x1b5301=[],_0x42131a=[],_0x293473=[],_0x1dc210=[],_0x18471f=[];let _0x491732=[];if(_0x41ccde==_0x1e7362(0x216))switch(_0x3cd53d){case _0x1e7362(0x232):_0x36e332=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x1b5301=[0x1,0x2],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=[_0x1e7362(0x274),'Floor'],_0x1dc210=['D'],_0x18471f=['A'];break;case'Rack\x20B':_0x36e332=[0x6,0x5,0x4,0x3,0x2,0x1],_0x1b5301=[0x1,0x2],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=[_0x1e7362(0x274),'Floor'],_0x1dc210=['D'],_0x18471f=['B'];break;case _0x1e7362(0x1d1):_0x36e332=[0x0],_0x1b5301=[0x0],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=[_0x1e7362(0x1ed)],_0x1dc210=['D'],_0x18471f=['S'];break;case'Receiving\x20Area':_0x36e332=[0x0],_0x1b5301=[0x0],_0x293473=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x42131a=[_0x1e7362(0x1ed)],_0x1dc210=['D'],_0x18471f=['R'];break;}else{if(_0x41ccde==_0x1e7362(0x260))switch(_0x3cd53d){case _0x1e7362(0x232):_0x36e332=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x1b5301=['B','F'],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=['Level',_0x1e7362(0x1ed)],_0x1dc210=['C'],_0x18471f=['A'];break;case _0x1e7362(0x249):_0x36e332=[0x5,0x4,0x3,0x2,0x1],_0x1b5301=['F','B','S'],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=[_0x1e7362(0x274),_0x1e7362(0x1ed)],_0x1dc210=['C'],_0x18471f=['B'];break;case _0x1e7362(0x1cf):_0x36e332=[0x1,0x2,0x3,0x4,0x5],_0x1b5301=['B','F','S'],_0x293473=[0x5,0x4,0x3,0x2,0x1],_0x42131a=[_0x1e7362(0x274),_0x1e7362(0x1ed)],_0x1dc210=['C'],_0x18471f=['C'];break;case _0x1e7362(0x199):_0x36e332=[0x5,0x4,0x3,0x2,0x1],_0x1b5301=['F','B','S'],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=[_0x1e7362(0x274),_0x1e7362(0x1ed)],_0x1dc210=['C'],_0x18471f=['D'];break;case _0x1e7362(0x1f0):_0x36e332=[0x4,0x3,0x2,0x1],_0x1b5301=[0x1,0x2],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=[_0x1e7362(0x274),_0x1e7362(0x1ed)],_0x1dc210=['C'],_0x18471f=['E'];break;case'Rack\x20F':_0x36e332=[0x1,0x2,0x3],_0x1b5301=[0x1,0x2],_0x293473=[0x1,0x2,0x3,0x4,0x5],_0x42131a=['Level'],_0x1dc210=['C'],_0x18471f=['F'];break;}}return{'levels':_0x36e332,'Isle':_0x1b5301,'rack':_0x293473,'type':_0x42131a,'storage':_0x1dc210,'rak':_0x18471f};}router[a0_0x1c04e8(0x24e)](a0_0x1c04e8(0x18c),auth,async(_0x4518c0,_0x2474fd)=>{var _0x2ee113=a0_0x1c04e8;try{const {username:_0x8742ea,email:_0x29f6a8,role:_0x1b60ed}=_0x4518c0['user'],_0xc23014=_0x4518c0['user'],_0x2b8b1c=await profile['findOne']({'email':_0xc23014[_0x2ee113(0x1f4)]}),_0x2ecef7=await master_shop['find'](),_0x2f2e21=await transfers['findById'](_0x4518c0[_0x2ee113(0x193)]['id']);let _0x2e8ec5;if(_0xc23014['role']==_0x2ee113(0x1e3)){const _0x1d8ee0=await staff['findOne']({'email':_0xc23014['email']});_0x2e8ec5=await warehouse[_0x2ee113(0x189)]([{'$match':{'status':_0x2ee113(0x278),'name':_0x1d8ee0[_0x2ee113(0x1cc)],'warehouse_category':_0x2ee113(0x1b4)}},{'$group':{'_id':_0x2ee113(0x1bc),'name':{'$first':_0x2ee113(0x1bc)}}}]);}else _0x2e8ec5=await warehouse[_0x2ee113(0x189)]([{'$match':{'status':_0x2ee113(0x278),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x2ee113(0x1bc),'name':{'$first':_0x2ee113(0x1bc)}}}]);const _0x409e65=await warehouse[_0x2ee113(0x189)]([{'$match':{'name':_0x2f2e21['from_warehouse'],'warehouse_category':_0x2ee113(0x1b4)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2ee113(0x19a),'name':{'$first':_0x2ee113(0x1bd)},'product_stock':{'$first':_0x2ee113(0x1f2)},'bay':{'$first':_0x2ee113(0x207)},'bin':{'$first':_0x2ee113(0x221)},'type':{'$first':_0x2ee113(0x1b8)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2ee113(0x236)},'secondary_code':{'$first':_0x2ee113(0x24c)},'product_code':{'$first':_0x2ee113(0x21e)},'storage':{'$first':_0x2ee113(0x1c1)},'rack':{'$first':_0x2ee113(0x190)},'expiry_date':{'$first':_0x2ee113(0x1ac)},'production_date':{'$first':_0x2ee113(0x200)},'room':{'$first':_0x2ee113(0x1cb)}}}]),_0x92e072=await product[_0x2ee113(0x244)]({}),_0x345b04=BayBinSelected(_0x2f2e21[_0x2ee113(0x1f7)],_0x2f2e21[_0x2ee113(0x252)]);if(_0x2ecef7[0x0]['language']==_0x2ee113(0x19b)){var _0x52fa25=users['English'];console['log'](_0x52fa25);}else{if(_0x2ecef7[0x0][_0x2ee113(0x237)]==_0x2ee113(0x196))var _0x52fa25=users[_0x2ee113(0x196)];else{if(_0x2ecef7[0x0]['language']==_0x2ee113(0x25f))var _0x52fa25=users[_0x2ee113(0x25f)];else{if(_0x2ecef7[0x0][_0x2ee113(0x237)]==_0x2ee113(0x1a4))var _0x52fa25=users['Spanish'];else{if(_0x2ecef7[0x0]['language']=='French')var _0x52fa25=users['French'];else{if(_0x2ecef7[0x0]['language']==_0x2ee113(0x1d5))var _0x52fa25=users[_0x2ee113(0x25d)];else{if(_0x2ecef7[0x0][_0x2ee113(0x237)]=='Chinese')var _0x52fa25=users[_0x2ee113(0x210)];else{if(_0x2ecef7[0x0]['language']=='Arabic\x20(ae)')var _0x52fa25=users[_0x2ee113(0x1bf)];}}}}}}}_0x2474fd[_0x2ee113(0x261)](_0x2ee113(0x1c5),{'success':_0x4518c0[_0x2ee113(0x273)](_0x2ee113(0x270)),'errors':_0x4518c0[_0x2ee113(0x273)]('errors'),'role':_0xc23014,'profile':_0x2b8b1c,'master_shop':_0x2ecef7,'warehouse':_0x2e8ec5,'transfer':_0x2f2e21,'stock':_0x409e65,'unit':_0x92e072,'language':_0x52fa25});}catch(_0x444590){console[_0x2ee113(0x20d)](_0x444590);}}),router[a0_0x1c04e8(0x19c)]('/view/:id',auth,async(_0x2545f8,_0x3ce8c6)=>{var _0x5ca76e=a0_0x1c04e8;try{const _0xdcd0cd=_0x2545f8[_0x5ca76e(0x193)]['id'],_0x4af72c=await transfers[_0x5ca76e(0x27e)](_0xdcd0cd);_0x3ce8c6['json'](_0x2545f8[_0x5ca76e(0x1f6)]);return;const {date:_0x13819a,from_warehouse:_0x16016c,FromRoom_name:_0x44e039,to_warehouse:_0x225bf0,ToRoom_name:_0x541952,prod_name:_0x1d8240,from_prod_qty:_0x4d6cf7,from_prod_level:_0x4ae178,from_prod_isle:_0x2a9137,from_prod_pallet:_0x4e4e85,to_prod_qty:_0x1139f7,to_prod_level:_0x3d912b,to_prod_isle:_0x3dddcf,to_prod_pallet:_0x5816a9,primary_code:_0x3a27c0,secondary_code:_0x2b7cf4,product_code3:_0x3ac8c1,note:_0x5c7c72,invoice:_0x43b44a,expiry_date:_0x13f33a}=_0x2545f8['body'];if(typeof _0x1d8240==_0x5ca76e(0x220))var _0x5bbc46=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1e7)]],_0x4d0da2=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x24f)]],_0x4be6a0=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1b5)]],_0x561172=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1e0)]],_0x26b08b=[_0x2545f8[_0x5ca76e(0x1f6)]['from_prod_pallet']],_0x588a41=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x27a)]],_0x163585=[_0x2545f8['body'][_0x5ca76e(0x280)]],_0x37be76=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x22c)]],_0x33ab62=[_0x2545f8['body'][_0x5ca76e(0x1be)]],_0x3931cb=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x191)]],_0x18b527=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1a0)]],_0x57da7f=[_0x2545f8['body'][_0x5ca76e(0x1a3)]],_0x4e18e9=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1f8)]],_0x388f30=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x248)]],_0x339c09=[_0x2545f8[_0x5ca76e(0x1f6)]['secondary_code']],_0x40b6d9=[_0x2545f8['body'][_0x5ca76e(0x275)]],_0x270a74=[_0x2545f8['body']['MaxStocks_data2']],_0x4a872e=[_0x2545f8[_0x5ca76e(0x1f6)]['unit']],_0x5eb19f=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1ad)]],_0x46ea55=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x22a)]],_0x345f35=[_0x2545f8['body'][_0x5ca76e(0x263)]],_0x3ef6a1=[_0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1ef)]],_0x7dc78d=[_0x2545f8['body'][_0x5ca76e(0x25e)]];else var _0x5bbc46=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1e7)]],_0x57da7f=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1a3)]],_0x4e18e9=[..._0x2545f8[_0x5ca76e(0x1f6)]['rak']],_0x588a41=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x27a)]],_0x18b527=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1a0)]],_0x4d0da2=[..._0x2545f8['body'][_0x5ca76e(0x24f)]],_0x4be6a0=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1b5)]],_0x561172=[..._0x2545f8[_0x5ca76e(0x1f6)]['from_prod_isle']],_0x26b08b=[..._0x2545f8['body'][_0x5ca76e(0x25c)]],_0x163585=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x280)]],_0x37be76=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x22c)]],_0x33ab62=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1be)]],_0x3931cb=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x191)]],_0x388f30=[..._0x2545f8['body'][_0x5ca76e(0x248)]],_0x339c09=[..._0x2545f8['body'][_0x5ca76e(0x1ce)]],_0x40b6d9=[..._0x2545f8['body'][_0x5ca76e(0x275)]],_0x270a74=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x197)]],_0x4a872e=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x1ff)]],_0x5eb19f=[..._0x2545f8['body'][_0x5ca76e(0x1ad)]],_0x46ea55=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x22a)]],_0x345f35=[..._0x2545f8[_0x5ca76e(0x1f6)][_0x5ca76e(0x263)]],_0x3ef6a1=[..._0x2545f8['body'][_0x5ca76e(0x1ef)]],_0x7dc78d=[..._0x2545f8[_0x5ca76e(0x1f6)]['from_rak']];const _0x2c86b2=_0x5bbc46[_0x5ca76e(0x1d7)](_0x3478b5=>{return _0x3478b5={'product_name':_0x3478b5};});_0x4d0da2['forEach']((_0xf210d4,_0x55b663)=>{_0x2c86b2[_0x55b663]['from_quantity']=_0xf210d4;}),_0x4be6a0[_0x5ca76e(0x1ee)]((_0x2cd0f9,_0x31d014)=>{var _0x417b25=_0x5ca76e;_0x2c86b2[_0x31d014][_0x417b25(0x1ab)]=_0x2cd0f9;}),_0x561172['forEach']((_0x437139,_0x2e1fae)=>{var _0x566bcb=_0x5ca76e;_0x2c86b2[_0x2e1fae][_0x566bcb(0x1a6)]=_0x437139;}),_0x26b08b[_0x5ca76e(0x1ee)]((_0x25cfd1,_0x2cae90)=>{var _0x559050=_0x5ca76e;_0x2c86b2[_0x2cae90][_0x559050(0x23b)]=_0x25cfd1;}),_0x163585[_0x5ca76e(0x1ee)]((_0x599b13,_0x2dc73d)=>{var _0xeae6e0=_0x5ca76e;_0x2c86b2[_0x2dc73d][_0xeae6e0(0x26b)]=_0x599b13;}),_0x37be76[_0x5ca76e(0x1ee)]((_0x4934d0,_0x149820)=>{var _0x13e0ce=_0x5ca76e;_0x2c86b2[_0x149820][_0x13e0ce(0x23a)]=_0x4934d0;}),_0x33ab62[_0x5ca76e(0x1ee)]((_0x33ff96,_0x506d2b)=>{_0x2c86b2[_0x506d2b]['to_bin']=_0x33ff96;}),_0x3931cb[_0x5ca76e(0x1ee)]((_0x3f1849,_0xcdcbc)=>{var _0x27aa39=_0x5ca76e;_0x2c86b2[_0xcdcbc][_0x27aa39(0x1f3)]=_0x3f1849;}),_0x388f30['forEach']((_0x1372df,_0x4f78a6)=>{var _0x400868=_0x5ca76e;_0x2c86b2[_0x4f78a6][_0x400868(0x248)]=_0x1372df;}),_0x339c09[_0x5ca76e(0x1ee)]((_0x4b4f8b,_0x4adba3)=>{var _0x26839a=_0x5ca76e;_0x2c86b2[_0x4adba3][_0x26839a(0x1ce)]=_0x4b4f8b;}),_0x40b6d9[_0x5ca76e(0x1ee)]((_0x48aa07,_0x47328d)=>{_0x2c86b2[_0x47328d]['product_code']=_0x48aa07;}),_0x270a74[_0x5ca76e(0x1ee)]((_0x43f2fd,_0x255d4a)=>{var _0x527de3=_0x5ca76e;_0x2c86b2[_0x255d4a][_0x527de3(0x1a1)]=_0x43f2fd;}),_0x4a872e[_0x5ca76e(0x1ee)]((_0x27bd62,_0x52fa4b)=>{var _0xa259dd=_0x5ca76e;_0x2c86b2[_0x52fa4b][_0xa259dd(0x1ff)]=_0x27bd62;}),_0x5eb19f[_0x5ca76e(0x1ee)]((_0x2af48a,_0x5c1c88)=>{var _0x326932=_0x5ca76e;_0x2c86b2[_0x5c1c88][_0x326932(0x1ad)]=_0x2af48a;}),_0x46ea55[_0x5ca76e(0x1ee)]((_0x4b6a17,_0x4f398d)=>{_0x2c86b2[_0x4f398d]['batch_code']=_0x4b6a17;}),_0x345f35[_0x5ca76e(0x1ee)]((_0x3d0a03,_0x49ff8d)=>{_0x2c86b2[_0x49ff8d]['expiry_date']=_0x3d0a03;}),_0x57da7f[_0x5ca76e(0x1ee)]((_0x4dfcd3,_0x417e8a)=>{var _0x4508dd=_0x5ca76e;_0x2c86b2[_0x417e8a][_0x4508dd(0x1a3)]=_0x4dfcd3;}),_0x4e18e9['forEach']((_0x561958,_0x58c6cd)=>{_0x2c86b2[_0x58c6cd]['rack']=_0x561958;}),_0x588a41[_0x5ca76e(0x1ee)]((_0x326c8d,_0x39f1c9)=>{var _0xd795d6=_0x5ca76e;_0x2c86b2[_0x39f1c9][_0xd795d6(0x27a)]=_0x326c8d;}),_0x18b527[_0x5ca76e(0x1ee)]((_0x2916cd,_0x1779d8)=>{var _0x590e81=_0x5ca76e;_0x2c86b2[_0x1779d8][_0x590e81(0x1a0)]=_0x2916cd;}),_0x3ef6a1[_0x5ca76e(0x1ee)]((_0x45a38b,_0x276e65)=>{var _0x45f5b9=_0x5ca76e;_0x2c86b2[_0x276e65][_0x45f5b9(0x1ef)]=_0x45a38b;}),_0x7dc78d[_0x5ca76e(0x1ee)]((_0x28ad14,_0x11dd0c)=>{var _0x4bf8af=_0x5ca76e;_0x2c86b2[_0x11dd0c][_0x4bf8af(0x20b)]=_0x28ad14;});const _0x2cb639=_0x2c86b2['filter'](_0x1ebca9=>_0x1ebca9[_0x5ca76e(0x26b)]!=='0'&&_0x1ebca9[_0x5ca76e(0x26b)]!==''||_0x1ebca9[_0x5ca76e(0x1f3)]!=='0'&&_0x1ebca9[_0x5ca76e(0x1f3)]!=='');var _0x2ca917=0x0;_0x2cb639[_0x5ca76e(0x1ee)](_0x45ba60=>{var _0x521631=_0x5ca76e;parseInt(_0x45ba60[_0x521631(0x204)])<parseInt(_0x45ba60[_0x521631(0x26b)])&&_0x2ca917++;});if(_0x2ca917!=0x0)return _0x2545f8['flash'](_0x5ca76e(0x1dd),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x3ce8c6['redirect']('back');const _0x128cc3=await warehouse[_0x5ca76e(0x213)]({'name':_0x4af72c[_0x5ca76e(0x256)],'room':_0x4af72c[_0x5ca76e(0x1d6)]});_0x4af72c[_0x5ca76e(0x269)][_0x5ca76e(0x1ee)](_0x49aa9c=>{var _0x17cc85=_0x5ca76e;if(_0x49aa9c[_0x17cc85(0x26b)]>0x0){const _0x54e2ad=_0x128cc3[_0x17cc85(0x192)][_0x17cc85(0x1d7)](_0x3868c9=>{var _0x47fdf7=_0x17cc85;_0x3868c9['product_name']==_0x49aa9c[_0x47fdf7(0x1b3)]&&_0x3868c9['floorlevel']==_0x49aa9c[_0x47fdf7(0x23b)]&&_0x3868c9[_0x47fdf7(0x26a)]==_0x49aa9c[_0x47fdf7(0x27a)]&&_0x3868c9[_0x47fdf7(0x1a9)]==_0x49aa9c[_0x47fdf7(0x1a6)]&&_0x3868c9[_0x47fdf7(0x271)]==_0x49aa9c[_0x47fdf7(0x1ab)]&&_0x3868c9['rack']==_0x49aa9c[_0x47fdf7(0x20b)]&&_0x3868c9[_0x47fdf7(0x1a3)]==_0x49aa9c['from_storage']&&(_0x3868c9[_0x47fdf7(0x26d)]=parseInt(_0x3868c9[_0x47fdf7(0x26d)])+parseInt(_0x49aa9c[_0x47fdf7(0x26b)]));});}}),await _0x128cc3['save']();const _0x28b86a=await warehouse[_0x5ca76e(0x213)]({'name':_0x4af72c[_0x5ca76e(0x1f7)],'room':_0x4af72c[_0x5ca76e(0x252)]});_0x4af72c[_0x5ca76e(0x269)][_0x5ca76e(0x1ee)](_0x410c56=>{var _0x477419=_0x5ca76e;if(_0x410c56[_0x477419(0x26b)]>0x0){const _0x56d1eb=_0x28b86a['product_details'][_0x477419(0x1d7)](_0x452bef=>{var _0x2e1a77=_0x477419;_0x452bef[_0x2e1a77(0x1b3)]==_0x410c56[_0x2e1a77(0x1b3)]&&_0x452bef['floorlevel']==_0x410c56['to_floorlevel']&&_0x452bef[_0x2e1a77(0x26a)]==_0x410c56[_0x2e1a77(0x1a0)]&&_0x452bef[_0x2e1a77(0x1a9)]==_0x410c56[_0x2e1a77(0x242)]&&_0x452bef['bay']==_0x410c56[_0x2e1a77(0x23a)]&&_0x452bef['rack']==_0x410c56[_0x2e1a77(0x1dc)]&&_0x452bef[_0x2e1a77(0x1a3)]==_0x410c56[_0x2e1a77(0x1a3)]&&(_0x452bef[_0x2e1a77(0x26d)]=parseInt(_0x452bef['product_stock'])-parseInt(_0x410c56[_0x2e1a77(0x26b)]));});}}),await _0x28b86a[_0x5ca76e(0x1cd)](),_0x4af72c['date']=_0x13819a,_0x4af72c[_0x5ca76e(0x256)]=_0x16016c,_0x4af72c[_0x5ca76e(0x1f7)]=_0x225bf0,_0x4af72c[_0x5ca76e(0x269)]=_0x2cb639,_0x4af72c['note']=_0x5c7c72,_0x4af72c[_0x5ca76e(0x1e4)]=_0x43b44a;const _0x287977=await _0x4af72c[_0x5ca76e(0x1cd)]();console[_0x5ca76e(0x20d)](_0x287977);const _0x4bae52=await warehouse[_0x5ca76e(0x213)]({'name':_0x16016c,'room':_0x44e039});_0x287977[_0x5ca76e(0x269)][_0x5ca76e(0x1ee)](_0x1a0105=>{var _0x442da7=_0x5ca76e;if(_0x1a0105[_0x442da7(0x26b)]>0x0){const _0x594454=_0x4bae52['product_details'][_0x442da7(0x1d7)](_0x2ff0c3=>{var _0x1f2590=_0x442da7;_0x2ff0c3[_0x1f2590(0x1b3)]==_0x1a0105[_0x1f2590(0x1b3)]&&_0x2ff0c3['floorlevel']==_0x1a0105[_0x1f2590(0x23b)]&&_0x2ff0c3['type']==_0x1a0105[_0x1f2590(0x27a)]&&_0x2ff0c3[_0x1f2590(0x1a9)]==_0x1a0105[_0x1f2590(0x1a6)]&&_0x2ff0c3[_0x1f2590(0x271)]==_0x1a0105[_0x1f2590(0x1ab)]&&_0x2ff0c3['rack']==_0x1a0105[_0x1f2590(0x20b)]&&_0x2ff0c3['storage']==_0x1a0105[_0x1f2590(0x1ef)]&&(_0x2ff0c3['product_stock']=parseInt(_0x2ff0c3[_0x1f2590(0x26d)])-parseInt(_0x1a0105[_0x1f2590(0x26b)]));});}}),await _0x4bae52[_0x5ca76e(0x1cd)]();const _0x4cc177=await warehouse[_0x5ca76e(0x213)]({'name':_0x225bf0,'room':_0x541952});_0x287977['product'][_0x5ca76e(0x1ee)](_0x44ce06=>{var _0x396683=_0x5ca76e;if(_0x44ce06['to_quantity']>0x0){var _0x14f6f1=0x0;const _0xe939af=_0x4cc177[_0x396683(0x192)][_0x396683(0x1d7)](_0x54dcca=>{var _0xe2e26=_0x396683;_0x54dcca[_0xe2e26(0x1b3)]==_0x44ce06[_0xe2e26(0x1b3)]&&_0x54dcca['floorlevel']==_0x44ce06[_0xe2e26(0x1f3)]&&_0x54dcca[_0xe2e26(0x26a)]==_0x44ce06[_0xe2e26(0x1a0)]&&_0x54dcca[_0xe2e26(0x1a9)]==_0x44ce06[_0xe2e26(0x242)]&&_0x54dcca['bay']==_0x44ce06[_0xe2e26(0x23a)]&&_0x54dcca[_0xe2e26(0x1dc)]==_0x44ce06[_0xe2e26(0x1dc)]&&_0x54dcca[_0xe2e26(0x1a3)]==_0x44ce06[_0xe2e26(0x1a3)]&&(_0x54dcca[_0xe2e26(0x26d)]=parseInt(_0x54dcca[_0xe2e26(0x26d)])+parseInt(_0x44ce06[_0xe2e26(0x26b)]),_0x14f6f1++);});_0x14f6f1=='0'&&(_0x4cc177[_0x396683(0x192)]=_0x4cc177[_0x396683(0x192)]['concat']({'product_name':_0x44ce06[_0x396683(0x1b3)],'product_stock':_0x44ce06[_0x396683(0x26b)],'bay':_0x44ce06[_0x396683(0x23a)],'bin':_0x44ce06[_0x396683(0x242)],'type':_0x44ce06[_0x396683(0x1a0)],'floorlevel':_0x44ce06['to_floorlevel'],'storage':_0x44ce06[_0x396683(0x1a3)],'rack':_0x44ce06[_0x396683(0x1dc)],'product_code':_0x44ce06[_0x396683(0x258)],'primary_code':_0x44ce06[_0x396683(0x248)],'secondary_code':_0x44ce06['secondary_code'],'maxProducts':_0x44ce06[_0x396683(0x1a1)],'storage':_0x44ce06['storage'],'rack':_0x44ce06['rack']}));}}),await _0x4cc177[_0x5ca76e(0x1cd)](),_0x2545f8[_0x5ca76e(0x273)](_0x5ca76e(0x270),_0x5ca76e(0x247)),_0x3ce8c6[_0x5ca76e(0x205)](_0x5ca76e(0x209));}catch(_0x4ab272){console['log'](_0x4ab272);}}),router[a0_0x1c04e8(0x19c)](a0_0x1c04e8(0x1a8),async(_0x56c998,_0x22e7dd)=>{var _0x244ed6=a0_0x1c04e8;const {FromWareHouse:_0x41737a,FromRoom:_0x4a19b0,ToWarehouse:_0x2a5fca,ToRoom:_0x3201ab,primary_code:_0x484b61,Roomslist:_0x559523}=_0x56c998[_0x244ed6(0x1f6)],_0x319935=_0x559523[_0x244ed6(0x1eb)](','),_0x2cf36e=[];async function _0xc892eb(_0x2b1592){var _0x5a894d=_0x244ed6;const _0x3b29e1=await warehouse[_0x5a894d(0x189)]([{'$match':{'name':_0x41737a,'room':_0x2b1592}},{'$unwind':_0x5a894d(0x201)},{'$match':{'product_details.primary_code':_0x484b61}},{'$group':{'_id':_0x5a894d(0x19a),'name':{'$first':_0x5a894d(0x1bd)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5a894d(0x236)},'secondary_code':{'$first':_0x5a894d(0x24c)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5a894d(0x221)},'type':{'$first':_0x5a894d(0x1b8)},'pallet':{'$first':_0x5a894d(0x22b)},'unit':{'$first':_0x5a894d(0x1e6)},'secondary_unit':{'$first':_0x5a894d(0x239)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5a894d(0x190)},'expiry_date':{'$first':_0x5a894d(0x1ac)},'production_date':{'$first':_0x5a894d(0x200)},'batch_code':{'$first':_0x5a894d(0x24a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x5a894d(0x1cb)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x5a894d(0x23e)}}}]),_0x4aaee2=await warehouse['aggregate']([{'$match':{'name':_0x41737a,'room':_0x2b1592}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x484b61}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x5a894d(0x1f2)},'primary_code':{'$first':_0x5a894d(0x236)},'secondary_code':{'$first':_0x5a894d(0x24c)},'product_code':{'$first':_0x5a894d(0x21e)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5a894d(0x221)},'type':{'$first':_0x5a894d(0x1b8)},'pallet':{'$first':_0x5a894d(0x22b)},'unit':{'$first':_0x5a894d(0x1e6)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5a894d(0x190)},'expiry_date':{'$first':_0x5a894d(0x1ac)},'production_date':{'$first':_0x5a894d(0x200)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x5a894d(0x1ba)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5a894d(0x1cb)},'maxProducts':{'$first':_0x5a894d(0x279)},'invoice_product':{'$first':'$product_details.invoice'}}}]);if(_0x3b29e1['length']>0x0)_0x2cf36e[_0x5a894d(0x1af)](_0x3b29e1);else _0x4aaee2[_0x5a894d(0x251)]>0x0&&_0x2cf36e[_0x5a894d(0x1af)](_0x4aaee2);}const _0x52be12=_0x319935[_0x244ed6(0x1d7)](_0x526892=>_0xc892eb(_0x526892));await Promise['all'](_0x52be12),_0x22e7dd[_0x244ed6(0x22d)](_0x2cf36e);}),router['post']('/barcode_scanner2',async(_0x5d7e26,_0x2a4e1f)=>{var _0x481dea=a0_0x1c04e8;try{const {FromWareHouse:_0x5956d8,FromRoom:_0xca5a20,ToWarehouse:_0x19d0ee,ToRoom:_0x3113fe,secondary_code:_0x5479d0}=_0x5d7e26[_0x481dea(0x1f6)],_0x123f4d=await warehouse[_0x481dea(0x189)]([{'$match':{'name':_0x5956d8}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5479d0}},{'$group':{'_id':_0x481dea(0x19a),'name':{'$first':_0x481dea(0x1bd)},'primary_code':{'$first':_0x481dea(0x236)},'secondary_code':{'$first':_0x481dea(0x24c)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x481dea(0x1f2)},'warehouse':{'$first':_0x481dea(0x1bc)},'level':{'$first':_0x481dea(0x18a)},'isle':{'$first':_0x481dea(0x255)},'pallet':{'$first':_0x481dea(0x208)},'maxProducts':{'$first':_0x481dea(0x279)},'unit':{'$first':_0x481dea(0x1e6)}}}]);_0x2a4e1f[_0x481dea(0x1e2)](0xc8)['json'](_0x123f4d);}catch(_0x3fd5e9){_0x2a4e1f['status'](0x194)['json']({'message':_0x3fd5e9[_0x481dea(0x211)]});}}),router[a0_0x1c04e8(0x19c)](a0_0x1c04e8(0x1d3),async(_0x3a1835,_0x40fc86)=>{var _0x51117e=a0_0x1c04e8;try{const {FromWareHouse:_0x3ae3b3,FromRoom:_0x492ba8,ToWarehouse:_0x5e77a9,ToRoom:_0x353a48,product_code:_0x494a52}=_0x3a1835[_0x51117e(0x1f6)],_0x58c579=await warehouse[_0x51117e(0x189)]([{'$match':{'name':_0x3ae3b3}},{'$unwind':_0x51117e(0x201)},{'$match':{'product_details.product_code':_0x494a52}},{'$group':{'_id':_0x51117e(0x19a),'name':{'$first':_0x51117e(0x1bd)},'primary_code':{'$first':_0x51117e(0x236)},'secondary_code':{'$first':_0x51117e(0x24c)},'product_code':{'$first':_0x51117e(0x21e)},'instock':{'$first':_0x51117e(0x1f2)},'warehouse':{'$first':'$name'},'level':{'$first':_0x51117e(0x18a)},'isle':{'$first':_0x51117e(0x255)},'pallet':{'$first':_0x51117e(0x208)},'maxProducts':{'$first':_0x51117e(0x279)},'unit':{'$first':'$product_details.unit'}}}]);_0x40fc86[_0x51117e(0x1e2)](0xc8)['json'](_0x58c579);}catch(_0xf0d553){_0x40fc86[_0x51117e(0x1e2)](0x194)[_0x51117e(0x22d)]({'message':_0xf0d553[_0x51117e(0x211)]});}}),router[a0_0x1c04e8(0x19c)](a0_0x1c04e8(0x222),async(_0x4e4cf2,_0x32b293)=>{var _0x2b0075=a0_0x1c04e8;const {level:_0x4a2bc2,isle:_0xfca116,pallet:_0x427f88,warehouses:_0x1a64a2,room:_0x27dfc8}=_0x4e4cf2[_0x2b0075(0x1f6)];try{const _0x1b5a28=await warehouse['aggregate']([{'$match':{'name':_0x1a64a2,'room':_0x27dfc8}},{'$unwind':_0x2b0075(0x201)},{'$match':{'product_details.level':parseInt(_0x4a2bc2),'product_details.isle':_0xfca116,'product_details.pallet':parseInt(_0x427f88)}},{'$group':{'_id':_0x2b0075(0x19a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2b0075(0x1f2)},'level':{'$first':_0x2b0075(0x18a)},'isle':{'$first':_0x2b0075(0x255)},'pallet':{'$first':_0x2b0075(0x208)},'maxProducts':{'$first':_0x2b0075(0x279)}}}]);_0x32b293[_0x2b0075(0x1e2)](0xc8)[_0x2b0075(0x22d)](_0x1b5a28);}catch(_0x1fe56c){_0x32b293['status'](0x194)['json']({'message':_0x1fe56c[_0x2b0075(0x211)]});}}),module[a0_0x1c04e8(0x1b2)]=router;