var a0_0x47bdc2=a0_0x1bf8;(function(_0x36f662,_0x36f4f7){var _0xb38c91=a0_0x1bf8,_0x5f22a2=_0x36f662();while(!![]){try{var _0x11092b=parseInt(_0xb38c91(0x168))/0x1*(-parseInt(_0xb38c91(0x144))/0x2)+parseInt(_0xb38c91(0xa5))/0x3+-parseInt(_0xb38c91(0xd3))/0x4+parseInt(_0xb38c91(0xd5))/0x5*(-parseInt(_0xb38c91(0x15c))/0x6)+parseInt(_0xb38c91(0x161))/0x7+-parseInt(_0xb38c91(0x102))/0x8+parseInt(_0xb38c91(0x119))/0x9;if(_0x11092b===_0x36f4f7)break;else _0x5f22a2['push'](_0x5f22a2['shift']());}catch(_0x3b10b2){_0x5f22a2['push'](_0x5f22a2['shift']());}}}(a0_0xdb57,0xc539d));const express=require(a0_0x47bdc2(0x176)),app=express(),router=express[a0_0x47bdc2(0x110)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x47bdc2(0x126)),auth=require(a0_0x47bdc2(0xbf)),users=require(a0_0x47bdc2(0x109)),nodemailer=require(a0_0x47bdc2(0x125));router['get'](a0_0x47bdc2(0x173),auth,async(_0x24ae85,_0x4919ce)=>{var _0x17914d=a0_0x47bdc2;try{const {username:_0x3ec8ae,email:_0x28db48,role:_0x243eb6}=_0x24ae85['user'],_0x487bcd=_0x24ae85[_0x17914d(0x175)],_0x2b8297=await profile[_0x17914d(0x16b)]({'email':_0x487bcd[_0x17914d(0x117)]}),_0x228255=await master_shop['find']();console[_0x17914d(0x10e)](_0x17914d(0x18a),_0x228255);let _0x2a4347;if(_0x487bcd[_0x17914d(0x108)]==_0x17914d(0x150)){const _0x53d7cd=await staff[_0x17914d(0x16b)]({'email':_0x487bcd['email']});_0x2a4347=await transfers['find']({'from_warehouse':_0x53d7cd[_0x17914d(0x159)]});}else _0x2a4347=await transfers[_0x17914d(0x9e)]([{'$unwind':_0x17914d(0xfa)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x17914d(0x182)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x17914d(0x160)},'isAllowEdit':{'$first':_0x17914d(0xdd)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x228255[0x0]['language']==_0x17914d(0x155)){var _0x11d165=users[_0x17914d(0x130)];console['log'](_0x11d165);}else{if(_0x228255[0x0][_0x17914d(0x11c)]==_0x17914d(0x171))var _0x11d165=users[_0x17914d(0x171)];else{if(_0x228255[0x0]['language']==_0x17914d(0x128))var _0x11d165=users['German'];else{if(_0x228255[0x0][_0x17914d(0x11c)]==_0x17914d(0x140))var _0x11d165=users[_0x17914d(0x140)];else{if(_0x228255[0x0][_0x17914d(0x11c)]=='French')var _0x11d165=users[_0x17914d(0xbd)];else{if(_0x228255[0x0][_0x17914d(0x11c)]=='Portuguese\x20(BR)')var _0x11d165=users['Portuguese'];else{if(_0x228255[0x0][_0x17914d(0x11c)]==_0x17914d(0x10d))var _0x11d165=users['Chinese'];else{if(_0x228255[0x0][_0x17914d(0x11c)]==_0x17914d(0x103))var _0x11d165=users['Arabic'];}}}}}}}_0x4919ce[_0x17914d(0x15e)](_0x17914d(0xdc),{'success':_0x24ae85[_0x17914d(0x18b)]('success'),'errors':_0x24ae85[_0x17914d(0x18b)](_0x17914d(0xa1)),'role':_0x487bcd,'profile':_0x2b8297,'master_shop':_0x228255,'transfer':_0x2a4347,'language':_0x11d165});}catch(_0x242dfb){console[_0x17914d(0x10e)](_0x242dfb);}});async function getRandom8DigitNumber(){var _0xca4f8b=a0_0x47bdc2;const _0x10eabc=0x989680,_0xd4ba99=0x5f5e0ff,_0x23b2f9=Math['floor'](Math[_0xca4f8b(0x11a)]()*(_0xd4ba99-_0x10eabc+0x1))+_0x10eabc;var _0x2134d4;const _0x5ec8d8=await transfers[_0xca4f8b(0x16b)]({'invoice':_0xca4f8b(0x13f)+_0x23b2f9});return _0x5ec8d8&&_0x5ec8d8['length']>0x0?_0x2134d4=_0xca4f8b(0x13f)+_0x23b2f9:_0x2134d4='TRF-'+_0x23b2f9,_0x2134d4;}function a0_0x1bf8(_0x21db3a,_0x14c2f5){var _0xdb57f2=a0_0xdb57();return a0_0x1bf8=function(_0x1bf878,_0x285bbb){_0x1bf878=_0x1bf878-0x9b;var _0x2a5ecb=_0xdb57f2[_0x1bf878];return _0x2a5ecb;},a0_0x1bf8(_0x21db3a,_0x14c2f5);}router['get'](a0_0x47bdc2(0xb7),auth,async(_0x14c130,_0x34c631)=>{var _0x6312a3=a0_0x47bdc2;try{const {username:_0x395a7f,email:_0x1614f5,role:_0x3f10b9}=_0x14c130['user'],_0x5858ec=_0x14c130[_0x6312a3(0x175)],_0xe56372=await profile[_0x6312a3(0x16b)]({'email':_0x5858ec['email']}),_0xbef0f9=await master_shop[_0x6312a3(0xd2)]();console['log'](_0x6312a3(0x18a),_0xbef0f9);let _0x3782ef;if(_0x5858ec[_0x6312a3(0x108)]==_0x6312a3(0x150)){const _0x5bec6d=await staff[_0x6312a3(0x16b)]({'email':_0x5858ec[_0x6312a3(0x117)]});_0x3782ef=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x5bec6d[_0x6312a3(0x159)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x6312a3(0x16c)}}}]);}else _0x3782ef=await warehouse[_0x6312a3(0x9e)]([{'$match':{'status':_0x6312a3(0x122),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x6312a3(0x16c)}}}]);var _0x4cd30b=[_0x6312a3(0x142),_0x6312a3(0x106),_0x6312a3(0x167)];const _0x2cac9f=await transfers[_0x6312a3(0xd2)]({}),_0x1acaab=_0x2cac9f[_0x6312a3(0xf0)]+0x1,_0xaac0=_0x6312a3(0x13f)+_0x1acaab[_0x6312a3(0xfe)]()[_0x6312a3(0xec)](0x5,'0');if(_0xbef0f9[0x0][_0x6312a3(0x11c)]==_0x6312a3(0x155)){var _0x1ac44b=users['English'];console[_0x6312a3(0x10e)](_0x1ac44b);}else{if(_0xbef0f9[0x0]['language']=='Hindi')var _0x1ac44b=users[_0x6312a3(0x171)];else{if(_0xbef0f9[0x0]['language']==_0x6312a3(0x128))var _0x1ac44b=users['German'];else{if(_0xbef0f9[0x0]['language']==_0x6312a3(0x140))var _0x1ac44b=users[_0x6312a3(0x140)];else{if(_0xbef0f9[0x0][_0x6312a3(0x11c)]==_0x6312a3(0xbd))var _0x1ac44b=users[_0x6312a3(0xbd)];else{if(_0xbef0f9[0x0]['language']==_0x6312a3(0xcc))var _0x1ac44b=users['Portuguese'];else{if(_0xbef0f9[0x0]['language']==_0x6312a3(0x10d))var _0x1ac44b=users[_0x6312a3(0x10d)];else{if(_0xbef0f9[0x0][_0x6312a3(0x11c)]==_0x6312a3(0x103))var _0x1ac44b=users[_0x6312a3(0xac)];}}}}}}}const _0x26db3c=getRandom8DigitNumber();_0x26db3c['then'](_0x246678=>{var _0x575a71=_0x6312a3;_0x34c631[_0x575a71(0x15e)]('add_transfer',{'success':_0x14c130[_0x575a71(0x18b)](_0x575a71(0x18e)),'errors':_0x14c130[_0x575a71(0x18b)](_0x575a71(0xa1)),'role':_0x5858ec,'profile':_0xe56372,'master_shop':_0xbef0f9,'warehouse':_0x3782ef,'language':_0x1ac44b,'rooms_data':_0x4cd30b,'invoice':_0x246678});})[_0x6312a3(0x188)](_0x76f11d=>{var _0x26e3eb=_0x6312a3;_0x14c130[_0x26e3eb(0x18b)]('errors',_0x26e3eb(0x15f)),_0x34c631[_0x26e3eb(0x9f)](_0x26e3eb(0x17a));});}catch(_0x499ab0){console[_0x6312a3(0x10e)](_0x499ab0);}}),router[a0_0x47bdc2(0x189)](a0_0x47bdc2(0xb7),auth,async(_0x12cd25,_0x449b47)=>{var _0x2b802f=a0_0x47bdc2;try{console['log'](_0x12cd25[_0x2b802f(0xab)]);const {date:_0x18cc35,from_warehouse:_0x28a555,FromRoom_name:_0x120dcf,to_warehouse:_0x75b1cd,ToRoom_name:_0x1801c7,prod_name:_0x5001e9,from_prod_qty:_0x5c60dd,from_prod_level:_0x3962aa,from_prod_isle:_0x203d5c,from_prod_pallet:_0x3228ed,to_prod_qty:_0x55df81,to_prod_level:_0x595318,to_prod_isle:_0x1f795d,to_prod_pallet:_0x56ca8a,primary_code:_0x535c73,secondary_code:_0x58f170,product_code3:_0x2dc4e2,note:_0x2938aa,MaxStocks_data2:_0x533bee,invoice:_0x4db6f2,expiry_date:_0x15a8be}=_0x12cd25[_0x2b802f(0xab)];if(typeof _0x5001e9=='string')var _0x236e4c=[_0x12cd25['body'][_0x2b802f(0xf9)]],_0x13ba8f=[_0x12cd25[_0x2b802f(0xab)]['from_prod_qty']],_0x4300f5=[_0x12cd25[_0x2b802f(0xab)]['from_prod_level']],_0x568906=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x17c)]],_0x576e45=[_0x12cd25[_0x2b802f(0xab)]['to_prod_level']],_0x160224=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x113)]],_0x525eb6=[_0x12cd25['body'][_0x2b802f(0xeb)]],_0x14a327=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x12a)]],_0x2c2d52=[_0x12cd25[_0x2b802f(0xab)]['MaxStocks_data2']],_0x59b582=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xa6)]],_0xd22445=[_0x12cd25['body'][_0x2b802f(0x172)]],_0x3aa383=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xce)]],_0x8fdd50=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xb5)]],_0x3b046a=[_0x12cd25[_0x2b802f(0xab)]['max_per_unit']],_0x24f41d=[_0x12cd25['body'][_0x2b802f(0xae)]],_0x5df7c9=[_0x12cd25['body']['prod_cat']],_0x34ed68=[_0x12cd25['body'][_0x2b802f(0xee)]],_0x28252f=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x116)]],_0x133370=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x164)]],_0x486ccb=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xfd)]],_0x4016ce=[_0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x16f)]];else var _0x236e4c=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xf9)]],_0x13ba8f=[..._0x12cd25[_0x2b802f(0xab)]['from_prod_qty']],_0x4300f5=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xe4)]],_0x568906=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x17c)]],_0x576e45=[..._0x12cd25['body'][_0x2b802f(0xa0)]],_0x160224=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x113)]],_0x525eb6=[..._0x12cd25['body']['secondary_code']],_0x14a327=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x12a)]],_0x2c2d52=[..._0x12cd25['body'][_0x2b802f(0x181)]],_0x59b582=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xa6)]],_0xd22445=[..._0x12cd25['body'][_0x2b802f(0x172)]],_0x3aa383=[..._0x12cd25['body']['batch_code']],_0x8fdd50=[..._0x12cd25[_0x2b802f(0xab)]['expiry_date']],_0x3b046a=[..._0x12cd25['body']['max_per_unit']],_0x24f41d=[..._0x12cd25[_0x2b802f(0xab)]['production_date']],_0x5df7c9=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x14b)]],_0x34ed68=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xee)]],_0x28252f=[..._0x12cd25['body'][_0x2b802f(0x116)]],_0x133370=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x164)]],_0x486ccb=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0xfd)]],_0x4016ce=[..._0x12cd25[_0x2b802f(0xab)][_0x2b802f(0x16f)]];const _0x2f0062=_0x236e4c[_0x2b802f(0xd9)](_0x218b62=>{return _0x218b62={'product_name':_0x218b62};});_0x13ba8f[_0x2b802f(0xa7)]((_0x1acda0,_0x1d58b1)=>{var _0x2bea7a=_0x2b802f;_0x2f0062[_0x1d58b1][_0x2bea7a(0x169)]=_0x1acda0;}),_0x133370[_0x2b802f(0xa7)]((_0x3128fa,_0x2887d9)=>{var _0x7ab72a=_0x2b802f;_0x2f0062[_0x2887d9][_0x7ab72a(0x164)]=_0x3128fa;}),_0x486ccb[_0x2b802f(0xa7)]((_0x143bdc,_0x404ee7)=>{var _0x433a42=_0x2b802f;_0x2f0062[_0x404ee7][_0x433a42(0x146)]=_0x143bdc;}),_0x4016ce[_0x2b802f(0xa7)]((_0x2b51bf,_0x135ac1)=>{_0x2f0062[_0x135ac1]['id_transaction_id']=_0x2b51bf;}),_0x4300f5['forEach']((_0x484d18,_0x22c629)=>{var _0x317b51=_0x2b802f;_0x34ed68[_0x317b51(0xa7)]((_0x813de8,_0x586ddc)=>{var _0x587370=_0x317b51;if(_0x813de8=='Receiving\x20Area'&&_0x22c629==_0x586ddc){var _0x3e3eeb=_0x484d18[_0x587370(0x14c)](0x3);_0x2f0062[_0x22c629][_0x587370(0xc9)]=_0x484d18[0x0],_0x2f0062[_0x22c629][_0x587370(0xd7)]=_0x484d18[0x1],_0x2f0062[_0x22c629][_0x587370(0x115)]=0x0,_0x2f0062[_0x22c629][_0x587370(0xe8)]=0x0,_0x2f0062[_0x22c629][_0x587370(0x12f)]=_0x587370(0xc6),_0x2f0062[_0x22c629][_0x587370(0x133)]=_0x3e3eeb;}else{if(_0x813de8==_0x587370(0xd8)&&_0x22c629==_0x586ddc){var _0x3e3eeb=_0x484d18[_0x587370(0x14c)](0x3);_0x2f0062[_0x22c629][_0x587370(0xc9)]=_0x484d18[0x0],_0x2f0062[_0x22c629][_0x587370(0xd7)]=_0x484d18[0x1],_0x2f0062[_0x22c629]['from_bay']=0x0,_0x2f0062[_0x22c629][_0x587370(0xe8)]=0x0,_0x2f0062[_0x22c629][_0x587370(0x12f)]='Floor',_0x2f0062[_0x22c629][_0x587370(0x133)]=_0x484d18[0x5];}else{if(_0x22c629==_0x586ddc){if(_0x484d18[0x0]=='A'&&_0x484d18[0x1]=='L'&&_0x484d18[0x2]=='L')console[_0x587370(0x10e)](_0x813de8+_0x587370(0x15d)+_0x22c629+_0x587370(0x15d)+_0x586ddc+_0x587370(0x15d)+_0x484d18+_0x587370(0x185)),_0x2f0062[_0x22c629]['from_storage']=_0x484d18[0x0],_0x2f0062[_0x22c629][_0x587370(0xd7)]=_0x484d18[0x1],_0x2f0062[_0x22c629][_0x587370(0x115)]=0x0,_0x2f0062[_0x22c629][_0x587370(0xe8)]=0x0,_0x2f0062[_0x22c629]['from_types']='Floor',_0x2f0062[_0x22c629][_0x587370(0x133)]=_0x484d18[0x3];else{var _0x123e47;if(_0x484d18[0x4]=='L')_0x123e47=_0x587370(0xcb);else _0x484d18[0x4]=='F'&&(_0x123e47=_0x587370(0xc6));_0x2f0062[_0x22c629][_0x587370(0xc9)]=_0x484d18[0x0],_0x2f0062[_0x22c629][_0x587370(0xd7)]=_0x484d18[0x1],_0x2f0062[_0x22c629][_0x587370(0x115)]=_0x484d18[0x2],_0x2f0062[_0x22c629]['from_bin']=_0x484d18[0x3],_0x2f0062[_0x22c629][_0x587370(0x12f)]=_0x123e47,_0x2f0062[_0x22c629][_0x587370(0x133)]=_0x484d18[0x5];}}}}});}),_0x568906[_0x2b802f(0xa7)]((_0x2aa3d5,_0x438431)=>{var _0xe9a143=_0x2b802f;_0x2f0062[_0x438431][_0xe9a143(0x120)]=_0x2aa3d5;}),_0x576e45[_0x2b802f(0xa7)]((_0x549f8c,_0x18150e)=>{_0x28252f['forEach']((_0x5ba2f1,_0x4a14fe)=>{var _0x58e927=a0_0x1bf8;if(_0x5ba2f1==_0x58e927(0x124)&&_0x18150e==_0x4a14fe){var _0x5ba559=_0x549f8c['slice'](0x3);_0x2f0062[_0x18150e][_0x58e927(0xd6)]=_0x549f8c[0x0],_0x2f0062[_0x18150e][_0x58e927(0x163)]=_0x549f8c[0x1],_0x2f0062[_0x18150e][_0x58e927(0x13d)]=0x0,_0x2f0062[_0x18150e]['to_bin']=0x0,_0x2f0062[_0x18150e][_0x58e927(0xe5)]='Floor',_0x2f0062[_0x18150e][_0x58e927(0x12c)]=_0x5ba559;}else{if(_0x5ba2f1==_0x58e927(0xd8)&&_0x18150e==_0x4a14fe){var _0x5ba559=_0x549f8c[_0x58e927(0x14c)](0x3);_0x2f0062[_0x18150e][_0x58e927(0xd6)]=_0x549f8c[0x0],_0x2f0062[_0x18150e][_0x58e927(0x163)]=_0x549f8c[0x1],_0x2f0062[_0x18150e][_0x58e927(0x13d)]=0x0,_0x2f0062[_0x18150e][_0x58e927(0x11f)]=0x0,_0x2f0062[_0x18150e][_0x58e927(0xe5)]='Floor',_0x2f0062[_0x18150e][_0x58e927(0x12c)]=_0x549f8c[0x5];}else{if(_0x18150e==_0x4a14fe){if(_0x549f8c[0x0]=='A'&&_0x549f8c[0x1]=='L'&&_0x549f8c[0x2]=='L')console[_0x58e927(0x10e)](_0x5ba2f1+_0x58e927(0x15d)+_0x18150e+_0x58e927(0x15d)+_0x4a14fe+_0x58e927(0x15d)+_0x549f8c+_0x58e927(0x185)),_0x2f0062[_0x18150e][_0x58e927(0xd6)]=_0x549f8c[0x0],_0x2f0062[_0x18150e]['rack']=_0x549f8c[0x1],_0x2f0062[_0x18150e][_0x58e927(0x13d)]=0x0,_0x2f0062[_0x18150e][_0x58e927(0x11f)]=0x0,_0x2f0062[_0x18150e][_0x58e927(0xe5)]=_0x58e927(0xc6),_0x2f0062[_0x18150e][_0x58e927(0x12c)]=_0x549f8c[0x3];else{var _0x43a95f;if(_0x549f8c[0x4]=='L')_0x43a95f='Level';else _0x549f8c[0x4]=='F'&&(_0x43a95f=_0x58e927(0xc6));_0x2f0062[_0x18150e][_0x58e927(0xd6)]=_0x549f8c[0x0],_0x2f0062[_0x18150e][_0x58e927(0x163)]=_0x549f8c[0x1],_0x2f0062[_0x18150e][_0x58e927(0x13d)]=_0x549f8c[0x2],_0x2f0062[_0x18150e]['to_bin']=_0x549f8c[0x3],_0x2f0062[_0x18150e][_0x58e927(0xe5)]=_0x43a95f,_0x2f0062[_0x18150e][_0x58e927(0x12c)]=_0x549f8c[0x5];}}}}});}),_0x160224['forEach']((_0x3c9e16,_0x24b82c)=>{_0x2f0062[_0x24b82c]['primary_code']=_0x3c9e16;}),_0x525eb6[_0x2b802f(0xa7)]((_0x14f4db,_0x403603)=>{var _0x262ce0=_0x2b802f;_0x2f0062[_0x403603][_0x262ce0(0xeb)]=_0x14f4db;}),_0x14a327['forEach']((_0x1ddc00,_0x3e4458)=>{_0x2f0062[_0x3e4458]['product_code']=_0x1ddc00;}),_0x2c2d52['forEach']((_0x3c1224,_0x566fe1)=>{var _0x247453=_0x2b802f;_0x2f0062[_0x566fe1][_0x247453(0xad)]=_0x3c1224;}),_0x59b582[_0x2b802f(0xa7)]((_0xaa8fdc,_0x509c5b)=>{_0x2f0062[_0x509c5b]['unit']=_0xaa8fdc;}),_0xd22445['forEach']((_0x3356d7,_0x2d7542)=>{var _0x45e95b=_0x2b802f;_0x2f0062[_0x2d7542][_0x45e95b(0x172)]=_0x3356d7;}),_0x3aa383['forEach']((_0x15e355,_0x1e3e80)=>{var _0x461abd=_0x2b802f;_0x2f0062[_0x1e3e80][_0x461abd(0xce)]=_0x15e355;}),_0x8fdd50[_0x2b802f(0xa7)]((_0xceff6e,_0x224541)=>{_0x2f0062[_0x224541]['expiry_date']=_0xceff6e;}),_0x3b046a[_0x2b802f(0xa7)]((_0x557808,_0x50a789)=>{var _0x1ff406=_0x2b802f;_0x2f0062[_0x50a789][_0x1ff406(0x11e)]=_0x557808;}),_0x24f41d[_0x2b802f(0xa7)]((_0x2d7cd6,_0x4f090e)=>{_0x2f0062[_0x4f090e]['production_date']=_0x2d7cd6;}),_0x5df7c9[_0x2b802f(0xa7)]((_0x5b9e68,_0x27d2dc)=>{var _0x4effcb=_0x2b802f;_0x2f0062[_0x27d2dc][_0x4effcb(0x14b)]=_0x5b9e68;}),_0x34ed68[_0x2b802f(0xa7)]((_0xc786fc,_0x5659cf)=>{_0x2f0062[_0x5659cf]['from_room_name']=_0xc786fc;}),_0x28252f[_0x2b802f(0xa7)]((_0x17ced5,_0x48ff08)=>{_0x2f0062[_0x48ff08]['to_room_name']=_0x17ced5;});const _0x334196=_0x2f0062[_0x2b802f(0xba)](_0x4946f7=>_0x4946f7['to_quantity']!=='0'&&_0x4946f7[_0x2b802f(0x120)]!==''||_0x4946f7[_0x2b802f(0x12c)]!=='0'&&_0x4946f7[_0x2b802f(0x12c)]!==''),_0x271993=new transfers({'date':_0x18cc35,'from_warehouse':_0x28a555,'to_warehouse':_0x75b1cd,'product':_0x334196,'note':_0x2938aa,'invoice':_0x4db6f2}),_0x29ff84=await _0x271993['save']();_0x12cd25[_0x2b802f(0x18b)](_0x2b802f(0x18e),_0x2b802f(0x104)),_0x449b47[_0x2b802f(0x9f)](_0x2b802f(0x121)+_0x29ff84['_id']);}catch(_0x20441f){console[_0x2b802f(0x10e)](_0x20441f),_0x449b47[_0x2b802f(0xc8)](0xc8)['json']({'errorMessage':_0x20441f['message']});}}),router['get'](a0_0x47bdc2(0x17d),auth,async(_0x1914f4,_0x515e23)=>{var _0x332468=a0_0x47bdc2;try{const {username:_0x5e2df8,email:_0x45c333,role:_0x5b5611}=_0x1914f4[_0x332468(0x175)],_0x312042=_0x1914f4[_0x332468(0x175)],_0x1c14dc=await profile[_0x332468(0x16b)]({'email':_0x312042['email']}),_0x2db38b=await master_shop[_0x332468(0xd2)]();console[_0x332468(0x10e)](_0x332468(0x18a),_0x2db38b);const _0xbbddcb=await transfers[_0x332468(0x14e)](_0x1914f4[_0x332468(0xe6)]['id']);let _0x19385b=new Date(_0xbbddcb['expiry_date']),_0x471fc2=('0'+_0x19385b[_0x332468(0x139)]())[_0x332468(0x14c)](-0x2),_0x4dff7b=('0'+(_0x19385b[_0x332468(0x147)]()+0x1))[_0x332468(0x14c)](-0x2),_0x48fcf8=_0x19385b[_0x332468(0x162)](),_0x612466=_0x48fcf8+'-'+_0x4dff7b+'-'+_0x471fc2,_0x1b263c;if(_0x312042[_0x332468(0x108)]=='staff'){const _0x830faf=await staff[_0x332468(0x16b)]({'email':_0x312042['email']});_0x1b263c=await warehouse[_0x332468(0xd2)]({'status':'Enabled','name':_0x830faf[_0x332468(0x159)],'warehouse_category':'Raw\x20Materials'});}else _0x1b263c=await warehouse['find']({'status':_0x332468(0x122),'warehouse_category':_0x332468(0xb2)});const _0x525961=await warehouse[_0x332468(0x9e)]([{'$match':{'name':_0xbbddcb[_0x332468(0x101)]}},{'$unwind':_0x332468(0xfc)},{'$group':{'_id':_0x332468(0x180),'name':{'$first':_0x332468(0xaf)},'product_stock':{'$first':_0x332468(0x13b)},'bay':{'$first':_0x332468(0x190)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x332468(0x152)},'floorlevel':{'$first':_0x332468(0x141)},'primary_code':{'$first':_0x332468(0x18f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x332468(0x143)},'rack':{'$first':_0x332468(0xf3)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x332468(0xaa)}}}]);if(_0x2db38b[0x0][_0x332468(0x11c)]==_0x332468(0x155)){var _0x1971fc=users['English'];console['log'](_0x1971fc);}else{if(_0x2db38b[0x0][_0x332468(0x11c)]==_0x332468(0x171))var _0x1971fc=users[_0x332468(0x171)];else{if(_0x2db38b[0x0][_0x332468(0x11c)]==_0x332468(0x128))var _0x1971fc=users[_0x332468(0x128)];else{if(_0x2db38b[0x0][_0x332468(0x11c)]==_0x332468(0x140))var _0x1971fc=users[_0x332468(0x140)];else{if(_0x2db38b[0x0][_0x332468(0x11c)]==_0x332468(0xbd))var _0x1971fc=users[_0x332468(0xbd)];else{if(_0x2db38b[0x0][_0x332468(0x11c)]==_0x332468(0xcc))var _0x1971fc=users[_0x332468(0x100)];else{if(_0x2db38b[0x0][_0x332468(0x11c)]=='Chinese')var _0x1971fc=users[_0x332468(0x10d)];else{if(_0x2db38b[0x0][_0x332468(0x11c)]==_0x332468(0x103))var _0x1971fc=users[_0x332468(0xac)];}}}}}}}_0x515e23['render'](_0x332468(0xc5),{'success':_0x1914f4['flash'](_0x332468(0x18e)),'errors':_0x1914f4[_0x332468(0x18b)](_0x332468(0xa1)),'role':_0x312042,'profile':_0x1c14dc,'master_shop':_0x2db38b,'warehouse':_0x1b263c,'transfer':_0xbbddcb,'stock':_0x525961,'language':_0x1971fc});}catch(_0x23708f){console[_0x332468(0x10e)](_0x23708f);}}),router['post'](a0_0x47bdc2(0x17d),auth,async(_0x2682c8,_0x11e84c)=>{var _0x32e296=a0_0x47bdc2;try{const _0x1d477c=_0x2682c8[_0x32e296(0xe6)]['id'],{from_warehouse:_0x2ffe2c,FromRoom_name:_0x157413,to_warehouse:_0x20e5cf,ToRoom_name:_0x29cb00}=_0x2682c8[_0x32e296(0xab)],_0x5640dd=await transfers['findById']({'_id':_0x1d477c}),_0x200350=_0x5640dd[_0x32e296(0x174)][_0x32e296(0xd9)](async _0x47567a=>{var _0x30aea2=_0x32e296;if(_0x47567a[_0x30aea2(0x120)]>0x0){var _0x21f3a0=await warehouse[_0x30aea2(0x16b)]({'name':_0x5640dd[_0x30aea2(0x101)],'room':_0x47567a[_0x30aea2(0xa4)],'warehouse_category':'Raw\x20Materials'});const _0xd8d3b1=_0x21f3a0['product_details'][_0x30aea2(0xd9)](_0x47e179=>{var _0x2130d9=_0x30aea2;_0x47e179[_0x2130d9(0x15b)]==_0x47567a['product_name']&&_0x47e179[_0x2130d9(0x156)]==_0x47567a['from_floorlevel']&&_0x47e179[_0x2130d9(0xea)]==_0x47567a[_0x2130d9(0x12f)]&&_0x47e179[_0x2130d9(0xc1)]==_0x47567a[_0x2130d9(0xe8)]&&_0x47e179['bay']==_0x47567a[_0x2130d9(0x115)]&&_0x47e179[_0x2130d9(0x163)]==_0x47567a['from_rack']&&_0x47e179[_0x2130d9(0xd6)]==_0x47567a['from_storage']&&_0x47e179[_0x2130d9(0xb5)]==_0x47567a[_0x2130d9(0xb5)]&&_0x47e179[_0x2130d9(0xce)]==_0x47567a[_0x2130d9(0xce)]&&_0x47e179['production_date']==_0x47567a['production_date']&&_0x47e179['invoice']==_0x47567a[_0x2130d9(0x164)]&&_0x47e179[_0x2130d9(0x148)]==_0x47567a[_0x2130d9(0xcd)]&&(_0x47e179[_0x2130d9(0x111)]=_0x47e179['product_stock']-_0x47567a[_0x2130d9(0x120)]);});}return _0x21f3a0;});Promise['all'](_0x200350)['then'](async _0x423b24=>{var _0x3429ba=_0x32e296;try{for(const _0x17587d of _0x423b24){await _0x17587d[_0x3429ba(0x13a)]();}try{const _0x4dc4d9=_0x5640dd['product']['map'](async _0x2228fb=>{var _0x1dd278=_0x3429ba;if(_0x2228fb[_0x1dd278(0x120)]>0x0){var _0x30d455=await warehouse[_0x1dd278(0x16b)]({'name':_0x5640dd[_0x1dd278(0x10f)],'room':_0x2228fb[_0x1dd278(0xa8)],'warehouse_category':_0x1dd278(0xb2)}),_0x1430a0=0x0;const _0x139630=_0x30d455['product_details'][_0x1dd278(0xd9)](_0x4cd042=>{var _0x111c3b=_0x1dd278;_0x4cd042['product_name']==_0x2228fb[_0x111c3b(0x15b)]&&_0x4cd042[_0x111c3b(0x156)]==_0x2228fb[_0x111c3b(0x12c)]&&_0x4cd042[_0x111c3b(0xea)]==_0x2228fb[_0x111c3b(0xe5)]&&_0x4cd042[_0x111c3b(0xc1)]==_0x2228fb[_0x111c3b(0x11f)]&&_0x4cd042['bay']==_0x2228fb[_0x111c3b(0x13d)]&&_0x4cd042[_0x111c3b(0x163)]==_0x2228fb[_0x111c3b(0x163)]&&_0x4cd042[_0x111c3b(0xd6)]==_0x2228fb[_0x111c3b(0xd6)]&&_0x4cd042[_0x111c3b(0xb5)]==_0x2228fb['expiry_date']&&_0x4cd042[_0x111c3b(0xce)]==_0x2228fb[_0x111c3b(0xce)]&&_0x4cd042[_0x111c3b(0xae)]==_0x2228fb[_0x111c3b(0xae)]&&_0x4cd042[_0x111c3b(0xb4)]==_0x2228fb[_0x111c3b(0x146)]&&(_0x4cd042[_0x111c3b(0x111)]=_0x4cd042[_0x111c3b(0x111)]+_0x2228fb[_0x111c3b(0x120)],_0x1430a0++);});_0x1430a0=='0'&&(_0x30d455['product_details']=_0x30d455['product_details']['concat']({'product_name':_0x2228fb['product_name'],'product_stock':_0x2228fb[_0x1dd278(0x120)],'bay':_0x2228fb[_0x1dd278(0x13d)],'bin':_0x2228fb[_0x1dd278(0x11f)],'type':_0x2228fb[_0x1dd278(0xe5)],'floorlevel':_0x2228fb[_0x1dd278(0x12c)],'storage':_0x2228fb['storage'],'rack':_0x2228fb['rack'],'product_code':_0x2228fb[_0x1dd278(0x9d)],'primary_code':_0x2228fb[_0x1dd278(0x113)],'secondary_code':_0x2228fb['secondary_code'],'maxProducts':_0x2228fb[_0x1dd278(0xad)],'storage':_0x2228fb['storage'],'rack':_0x2228fb['rack'],'expiry_date':_0x2228fb[_0x1dd278(0xb5)],'maxPerUnit':_0x2228fb[_0x1dd278(0x11e)],'batch_code':_0x2228fb[_0x1dd278(0xce)],'production_date':_0x2228fb[_0x1dd278(0xae)]}));}return _0x30d455;});Promise[_0x3429ba(0xbb)](_0x4dc4d9)[_0x3429ba(0x166)](async _0x116624=>{var _0x1a19f5=_0x3429ba;try{for(const _0x566e07 of _0x116624){await warehouse[_0x1a19f5(0x12d)]({'_id':_0x566e07[_0x1a19f5(0x148)]},{'$addToSet':{'product_details':{'$each':_0x566e07['product_details']}}});}_0x5640dd[_0x1a19f5(0x137)]='True';const _0x4e1cc8=await _0x5640dd[_0x1a19f5(0x13a)](),_0x2f68de=await master_shop[_0x1a19f5(0xd2)](),_0x514bcd=await email_settings[_0x1a19f5(0x16b)](),_0x27fde9=await supervisor_settings[_0x1a19f5(0xd2)]();var _0x1f5702=_0x5640dd[_0x1a19f5(0x174)],_0x476eab='',_0x11158b;for(_0x11158b in _0x1f5702){_0x476eab+=_0x1a19f5(0x18c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1f5702[_0x11158b]['product_name']+_0x1a19f5(0x114)+_0x1a19f5(0xb0)+_0x1f5702[_0x11158b][_0x1a19f5(0x9d)]+_0x1a19f5(0x114)+_0x1a19f5(0xb0)+_0x1f5702[_0x11158b]['to_quantity']+_0x1a19f5(0x114)+_0x1a19f5(0xb0)+_0x1f5702[_0x11158b][_0x1a19f5(0xa9)]+_0x1a19f5(0x114)+_0x1a19f5(0xb0)+_0x1f5702[_0x11158b][_0x1a19f5(0x172)]+_0x1a19f5(0x114)+_0x1a19f5(0xb0)+_0x5640dd['to_warehouse']+'</td>'+_0x1a19f5(0xb0)+_0x1f5702[_0x11158b][_0x1a19f5(0xa8)]+_0x1a19f5(0x114)+_0x1a19f5(0xb0)+_0x1f5702[_0x11158b][_0x1a19f5(0xd6)]+_0x1f5702[_0x11158b]['rack']+_0x1f5702[_0x11158b][_0x1a19f5(0x13d)]+_0x1f5702[_0x11158b][_0x1a19f5(0x11f)]+_0x1f5702[_0x11158b][_0x1a19f5(0xe5)][0x0]+_0x1f5702[_0x11158b]['to_floorlevel']+_0x1a19f5(0x114),'</tr>';}let _0x2e9d19=nodemailer[_0x1a19f5(0x184)]({'host':_0x514bcd[_0x1a19f5(0xdf)],'port':Number(_0x514bcd[_0x1a19f5(0x14d)]),'secure':![],'auth':{'user':_0x514bcd[_0x1a19f5(0x117)],'pass':_0x514bcd['password']}}),_0x3327e7={'from':_0x514bcd['email'],'to':_0x27fde9[0x0][_0x1a19f5(0xb3)],'subject':_0x1a19f5(0x145),'attachments':[{'filename':_0x1a19f5(0x149),'path':__dirname+_0x1a19f5(0xc0)+_0x1a19f5(0x13e)+_0x2f68de[0x0][_0x1a19f5(0x18d)],'cid':_0x1a19f5(0xa2)}],'html':_0x1a19f5(0x179)+_0x1a19f5(0x11b)+'</head><body>'+_0x1a19f5(0xd0)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x1a19f5(0xd0)+_0x1a19f5(0xa3)+'</div>'+_0x1a19f5(0xd0)+'<h2>\x20'+_0x2f68de[0x0][_0x1a19f5(0xf2)]+_0x1a19f5(0x187)+_0x1a19f5(0x17e)+'</div>'+_0x1a19f5(0x131)+_0x1a19f5(0xd0)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x5640dd['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x1a19f5(0x178)+_0x5640dd[_0x1a19f5(0x154)]+'\x20'+_0x1a19f5(0xc4)+_0x1a19f5(0xb1)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1a19f5(0x18c)+_0x1a19f5(0xbe)+_0x1a19f5(0xdb)+_0x1a19f5(0xca)+_0x1a19f5(0x10c)+_0x1a19f5(0xe7)+_0x1a19f5(0x9b)+_0x1a19f5(0x12b)+_0x1a19f5(0x134)+_0x1a19f5(0x112)+_0x1a19f5(0x151)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x476eab+'\x20'+_0x1a19f5(0xd1)+_0x1a19f5(0x157)+_0x1a19f5(0xd0)+_0x1a19f5(0xef)+_0x1a19f5(0x16e)+_0x2f68de[0x0][_0x1a19f5(0xf2)]+_0x1a19f5(0xb1)+'</div>'+_0x1a19f5(0x17e)+_0x1a19f5(0xe2)};_0x2e9d19[_0x1a19f5(0x15a)](_0x3327e7,function(_0x21d0dd,_0x573082){var _0x465f82=_0x1a19f5;_0x21d0dd?(console['log'](_0x21d0dd),console[_0x465f82(0x10e)](_0x465f82(0x17f))):console[_0x465f82(0x10e)](_0x465f82(0xc3));}),_0x2682c8[_0x1a19f5(0x18b)](_0x1a19f5(0x18e),_0x1a19f5(0x17b)),_0x11e84c['redirect']('/picking_list/PDF_transfer_rm/'+_0x4e1cc8[_0x1a19f5(0x148)]);}catch(_0xaf95f5){console[_0x1a19f5(0xde)](_0xaf95f5),_0x11e84c[_0x1a19f5(0xc8)](0x1f4)['json']({'Perror':_0x1a19f5(0x105),'message':_0xaf95f5['message']});}})[_0x3429ba(0x188)](_0x168aba=>{var _0xae7221=_0x3429ba;console[_0xae7221(0xde)](_0x168aba),_0x11e84c[_0xae7221(0xc8)](0x1f4)['json']({'Perror':_0xae7221(0x14f)});});}catch(_0x450cd1){_0x11e84c[_0x3429ba(0x127)](_0x450cd1);}}catch(_0x22f55b){console[_0x3429ba(0xde)](_0x22f55b),_0x11e84c[_0x3429ba(0xc8)](0x1f4)['json']({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x22f55b[_0x3429ba(0x153)]});}})[_0x32e296(0x188)](_0x5e12a7=>{var _0x2f3a1d=_0x32e296;console[_0x2f3a1d(0xde)](_0x5e12a7),_0x11e84c[_0x2f3a1d(0xc8)](0x1f4)[_0x2f3a1d(0x127)]({'Merror':_0x2f3a1d(0x14f)});});}catch(_0x2dc859){console[_0x32e296(0x10e)](_0x2dc859);}});function BayBinSelected(_0x16c075,_0x54ca22){var _0x3ec153=a0_0x47bdc2,_0x316f1d=[],_0x2ac2cd=[],_0x3ead0a=[],_0x3ba48e=[],_0xf4e584=[],_0x105351=[];let _0x4f860e=[];if(_0x16c075=='DRY\x20STORAGE')switch(_0x54ca22){case'Rack\x20A':_0x316f1d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2ac2cd=[0x1,0x2],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=['Level','Floor'],_0xf4e584=['D'],_0x105351=['A'];break;case _0x3ec153(0xc2):_0x316f1d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2ac2cd=[0x1,0x2],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=['Level',_0x3ec153(0xc6)],_0xf4e584=['D'],_0x105351=['B'];break;case _0x3ec153(0xd8):_0x316f1d=[0x0],_0x2ac2cd=[0x0],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=[_0x3ec153(0xc6)],_0xf4e584=['D'],_0x105351=['S'];break;case _0x3ec153(0x124):_0x316f1d=[0x0],_0x2ac2cd=[0x0],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3ead0a=[_0x3ec153(0xc6)],_0xf4e584=['D'],_0x105351=['R'];break;}else{if(_0x16c075==_0x3ec153(0x16a))switch(_0x54ca22){case _0x3ec153(0xff):_0x316f1d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2ac2cd=['B','F'],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=['Level',_0x3ec153(0xc6)],_0xf4e584=['C'],_0x105351=['A'];break;case _0x3ec153(0xc2):_0x316f1d=[0x5,0x4,0x3,0x2,0x1],_0x2ac2cd=['F','B','S'],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=[_0x3ec153(0xcb),_0x3ec153(0xc6)],_0xf4e584=['C'],_0x105351=['B'];break;case'Rack\x20C':_0x316f1d=[0x1,0x2,0x3,0x4,0x5],_0x2ac2cd=['B','F','S'],_0x3ba48e=[0x5,0x4,0x3,0x2,0x1],_0x3ead0a=[_0x3ec153(0xcb),_0x3ec153(0xc6)],_0xf4e584=['C'],_0x105351=['C'];break;case _0x3ec153(0xc7):_0x316f1d=[0x5,0x4,0x3,0x2,0x1],_0x2ac2cd=['F','B','S'],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=[_0x3ec153(0xcb),_0x3ec153(0xc6)],_0xf4e584=['C'],_0x105351=['D'];break;case _0x3ec153(0x186):_0x316f1d=[0x4,0x3,0x2,0x1],_0x2ac2cd=[0x1,0x2],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=[_0x3ec153(0xcb),_0x3ec153(0xc6)],_0xf4e584=['C'],_0x105351=['E'];break;case _0x3ec153(0x138):_0x316f1d=[0x1,0x2,0x3],_0x2ac2cd=[0x1,0x2],_0x3ba48e=[0x1,0x2,0x3,0x4,0x5],_0x3ead0a=['Level'],_0xf4e584=['C'],_0x105351=['F'];break;}}return{'levels':_0x316f1d,'Isle':_0x2ac2cd,'rack':_0x3ba48e,'type':_0x3ead0a,'storage':_0xf4e584,'rak':_0x105351};}function a0_0xdb57(){var _0x1a9680=['<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</h5>','Raw\x20Materials','RMSEmail','invoice','expiry_date','note','/view/add_transfer','exports','/barcode_scanner','filter','all','$product_details.maxPerUnit','French','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','../middleware/auth','/../public','bin','Rack\x20B','Email\x20sent\x20successfully','</span>','edit_transfer_view','Floor','Rack\x20D','status','from_storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Level','Portuguese\x20(BR)','id_transaction_id','batch_code','to_prod_pallet','<div>','</tbody>','find','1864892PVCjlY','$product_details.production_date','5JUcmdX','storage','from_rack','Shelves','map','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','transfer','$isAllowEdit','error','host','push','rak','</body></html>','$product_details.bin','from_prod_level','to_types','params','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','from_bin','split','type','secondary_code','padStart','to_room','RoomAssigned','<strong>\x20Regards\x20</strong>','length','string','site_title','$product_details.rack','$product_details.secondary_code','$product_details.secondary_unit','$product_details.unit','to_prod_qty','from_prod_qty','prod_name','$product','$product_details.batch_code','$product_details','to_invoice','toString','Rack\x20A','Portuguese','from_warehouse','1280024WUVYBH','Arabic\x20(ae)','Product\x20Transfer\x20successfully','An\x20error\x20occurred\x20while\x20saving\x20data.','Enclosed','back','role','../public/language/languages.json','$product_details.level','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Chinese','log','to_warehouse','Router','product_stock','</tr>','primary_code','</td>','from_bay','ToRoomAssigned','email','$product_details.maxProducts','26128404bIhtNV','random','<html><head><title></title>','language','from_rak','maxperunit','to_bin','to_quantity','/transfer/preview/','Enabled','$product_details.expiry_date','Receiving\x20Area','nodemailer','../models/all_models','json','German','/view/:id','product_code3','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','to_floorlevel','updateOne','/barcode_scanner2','from_types','English','<hr\x20class=\x22my-3\x22>','concat','from_floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.pallet','to_prod_isle','finalize','Rack\x20F','getDate','save','$product_details.product_stock','product_details','to_bay','/upload/','TRF-','Spanish','$product_details.floorlevel','Ambient','$product_details.storage','2BxpmMc','Transfer\x20Mail','To_invoice','getMonth','_id','Logo.png','$product_details.product_code','prod_cat','slice','port','findById','An\x20error\x20occurred.','staff','</thead>','$product_details.type','message','date','English\x20(US)','floorlevel','</table>','$product_details.isle','warehouse','sendMail','product_name','6340278vBLrwk','\x20<>\x20','render','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$finalize','5412008KtiswO','getFullYear','rack','from_invoice','from_prod_pallet','then','Return\x20Rooms','1519334xPzUDo','from_quantity','COLD\x20STORAGE','findOne','$name','get','<h5>','id_transaction','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Hindi','secondary_unit','/view','product','user','express','/CheckingWarehouse','\x20Order\x20Date\x20:\x20','<!DOCTYPE\x20html>','/transfer/view','Transfer\x20Finalize\x20Successfully','New_Qty_Converted','/preview/:id','</div>','Error\x20Occurs','$product_details._id','MaxStocks_data2','$date','from_room','createTransport','here','Rack\x20E','\x20</h2>','catch','post','master','flash','<tr>','image','success','$product_details.primary_code','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','from_prod_isle','product_code','aggregate','redirect','to_prod_level','errors','logo','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','from_room_name','1001430owaqai','primary_unit','forEach','to_room_name','unit','$room','body','Arabic','maxProducts','production_date','$product_details.product_name'];a0_0xdb57=function(){return _0x1a9680;};return a0_0xdb57();}router[a0_0x47bdc2(0x16d)](a0_0x47bdc2(0x129),auth,async(_0x525271,_0x2a1430)=>{var _0x403dc3=a0_0x47bdc2;try{const {username:_0x13c1a6,email:_0x26a962,role:_0x2dd128}=_0x525271[_0x403dc3(0x175)],_0x32882d=_0x525271[_0x403dc3(0x175)],_0x4c95c5=await profile[_0x403dc3(0x16b)]({'email':_0x32882d[_0x403dc3(0x117)]}),_0x49c841=await master_shop[_0x403dc3(0xd2)](),_0x4c21c0=await transfers[_0x403dc3(0x14e)](_0x525271['params']['id']);let _0x55966f;if(_0x32882d[_0x403dc3(0x108)]==_0x403dc3(0x150)){const _0x16bf2d=await staff['findOne']({'email':_0x32882d[_0x403dc3(0x117)]});_0x55966f=await warehouse[_0x403dc3(0x9e)]([{'$match':{'status':_0x403dc3(0x122),'name':_0x16bf2d['warehouse'],'warehouse_category':_0x403dc3(0xb2)}},{'$group':{'_id':_0x403dc3(0x16c),'name':{'$first':_0x403dc3(0x16c)}}}]);}else _0x55966f=await warehouse[_0x403dc3(0x9e)]([{'$match':{'status':_0x403dc3(0x122),'warehouse_category':_0x403dc3(0xb2)}},{'$group':{'_id':'$name','name':{'$first':_0x403dc3(0x16c)}}}]);const _0x3dc255=await warehouse[_0x403dc3(0x9e)]([{'$match':{'name':_0x4c21c0[_0x403dc3(0x101)],'warehouse_category':_0x403dc3(0xb2)}},{'$unwind':_0x403dc3(0xfc)},{'$group':{'_id':_0x403dc3(0x180),'name':{'$first':_0x403dc3(0xaf)},'product_stock':{'$first':_0x403dc3(0x13b)},'bay':{'$first':_0x403dc3(0x190)},'bin':{'$first':_0x403dc3(0xe3)},'type':{'$first':_0x403dc3(0x152)},'floorlevel':{'$first':_0x403dc3(0x141)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x403dc3(0xf4)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x403dc3(0x143)},'rack':{'$first':_0x403dc3(0xf3)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x403dc3(0xaa)}}}]),_0x21f7d1=await product[_0x403dc3(0xd2)]({}),_0x3de43f=BayBinSelected(_0x4c21c0['to_warehouse'],_0x4c21c0['to_room']);if(_0x49c841[0x0][_0x403dc3(0x11c)]==_0x403dc3(0x155)){var _0x36b382=users[_0x403dc3(0x130)];console[_0x403dc3(0x10e)](_0x36b382);}else{if(_0x49c841[0x0][_0x403dc3(0x11c)]==_0x403dc3(0x171))var _0x36b382=users[_0x403dc3(0x171)];else{if(_0x49c841[0x0][_0x403dc3(0x11c)]=='German')var _0x36b382=users[_0x403dc3(0x128)];else{if(_0x49c841[0x0][_0x403dc3(0x11c)]==_0x403dc3(0x140))var _0x36b382=users['Spanish'];else{if(_0x49c841[0x0][_0x403dc3(0x11c)]==_0x403dc3(0xbd))var _0x36b382=users[_0x403dc3(0xbd)];else{if(_0x49c841[0x0]['language']==_0x403dc3(0xcc))var _0x36b382=users[_0x403dc3(0x100)];else{if(_0x49c841[0x0]['language']==_0x403dc3(0x10d))var _0x36b382=users[_0x403dc3(0x10d)];else{if(_0x49c841[0x0][_0x403dc3(0x11c)]==_0x403dc3(0x103))var _0x36b382=users[_0x403dc3(0xac)];}}}}}}}_0x2a1430['render']('edit_transfer',{'success':_0x525271[_0x403dc3(0x18b)]('success'),'errors':_0x525271['flash'](_0x403dc3(0xa1)),'role':_0x32882d,'profile':_0x4c95c5,'master_shop':_0x49c841,'warehouse':_0x55966f,'transfer':_0x4c21c0,'stock':_0x3dc255,'unit':_0x21f7d1,'language':_0x36b382});}catch(_0x16a064){console[_0x403dc3(0x10e)](_0x16a064);}}),router[a0_0x47bdc2(0x189)](a0_0x47bdc2(0x129),auth,async(_0x351b16,_0x516f96)=>{var _0x125f04=a0_0x47bdc2;try{const _0x56c773=_0x351b16[_0x125f04(0xe6)]['id'],_0x59f399=await transfers[_0x125f04(0x14e)](_0x56c773);_0x516f96[_0x125f04(0x127)](_0x351b16[_0x125f04(0xab)]);return;const {date:_0x5b9307,from_warehouse:_0x2d35d0,FromRoom_name:_0x59b4ba,to_warehouse:_0xba6f9,ToRoom_name:_0x5d58dc,prod_name:_0x5c4624,from_prod_qty:_0x168410,from_prod_level:_0x187bbf,from_prod_isle:_0x537ef1,from_prod_pallet:_0x58bee5,to_prod_qty:_0xbb54f2,to_prod_level:_0x2a0789,to_prod_isle:_0x17ecd2,to_prod_pallet:_0x29d7ac,primary_code:_0x48393b,secondary_code:_0x5779ac,product_code3:_0x5edd48,note:_0x4eba5c,invoice:_0xc873eb,expiry_date:_0x1ba05c}=_0x351b16[_0x125f04(0xab)];if(typeof _0x5c4624==_0x125f04(0xf1))var _0xd86966=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xf9)]],_0x5ecab7=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xf8)]],_0x2f834f=[_0x351b16[_0x125f04(0xab)]['from_prod_level']],_0x5a86ba=[_0x351b16[_0x125f04(0xab)]['from_prod_isle']],_0x406720=[_0x351b16[_0x125f04(0xab)]['from_prod_pallet']],_0x144e4b=[_0x351b16[_0x125f04(0xab)][_0x125f04(0x12f)]],_0x21d17f=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xf7)]],_0x512990=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xa0)]],_0x124d69=[_0x351b16[_0x125f04(0xab)][_0x125f04(0x136)]],_0x1af041=[_0x351b16['body'][_0x125f04(0xcf)]],_0x2e9f94=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xe5)]],_0x54ea74=[_0x351b16[_0x125f04(0xab)]['storage']],_0x3518f9=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xe1)]],_0x1805f6=[_0x351b16[_0x125f04(0xab)][_0x125f04(0x113)]],_0x1d1b8b=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xeb)]],_0x21961b=[_0x351b16[_0x125f04(0xab)]['product_code3']],_0x39e219=[_0x351b16[_0x125f04(0xab)][_0x125f04(0x181)]],_0x57c28e=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xa9)]],_0x29ab78=[_0x351b16['body']['secondary_unit']],_0x25c1f4=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xce)]],_0x4d1923=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xb5)]],_0x58be25=[_0x351b16[_0x125f04(0xab)][_0x125f04(0xc9)]],_0xe02d8=[_0x351b16[_0x125f04(0xab)][_0x125f04(0x11d)]];else var _0xd86966=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0xf9)]],_0x54ea74=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0xd6)]],_0x3518f9=[..._0x351b16['body'][_0x125f04(0xe1)]],_0x144e4b=[..._0x351b16[_0x125f04(0xab)]['from_types']],_0x2e9f94=[..._0x351b16['body'][_0x125f04(0xe5)]],_0x5ecab7=[..._0x351b16['body'][_0x125f04(0xf8)]],_0x2f834f=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0xe4)]],_0x5a86ba=[..._0x351b16['body'][_0x125f04(0x9c)]],_0x406720=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0x165)]],_0x21d17f=[..._0x351b16['body'][_0x125f04(0xf7)]],_0x512990=[..._0x351b16[_0x125f04(0xab)]['to_prod_level']],_0x124d69=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0x136)]],_0x1af041=[..._0x351b16[_0x125f04(0xab)]['to_prod_pallet']],_0x1805f6=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0x113)]],_0x1d1b8b=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0xeb)]],_0x21961b=[..._0x351b16['body'][_0x125f04(0x12a)]],_0x39e219=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0x181)]],_0x57c28e=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0xa9)]],_0x29ab78=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0x172)]],_0x25c1f4=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0xce)]],_0x4d1923=[..._0x351b16['body'][_0x125f04(0xb5)]],_0x58be25=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0xc9)]],_0xe02d8=[..._0x351b16[_0x125f04(0xab)][_0x125f04(0x11d)]];const _0x79c5ed=_0xd86966['map'](_0x3bbd3e=>{return _0x3bbd3e={'product_name':_0x3bbd3e};});_0x5ecab7[_0x125f04(0xa7)]((_0x27056b,_0x372401)=>{var _0x442b9c=_0x125f04;_0x79c5ed[_0x372401][_0x442b9c(0x169)]=_0x27056b;}),_0x2f834f[_0x125f04(0xa7)]((_0xae6c00,_0x542558)=>{var _0x73c7d1=_0x125f04;_0x79c5ed[_0x542558][_0x73c7d1(0x115)]=_0xae6c00;}),_0x5a86ba[_0x125f04(0xa7)]((_0x5bfd48,_0x56ae38)=>{var _0x34e301=_0x125f04;_0x79c5ed[_0x56ae38][_0x34e301(0xe8)]=_0x5bfd48;}),_0x406720['forEach']((_0x4eefd0,_0x28e263)=>{var _0x28417c=_0x125f04;_0x79c5ed[_0x28e263][_0x28417c(0x133)]=_0x4eefd0;}),_0x21d17f['forEach']((_0x582145,_0x595891)=>{var _0x2b7c89=_0x125f04;_0x79c5ed[_0x595891][_0x2b7c89(0x120)]=_0x582145;}),_0x512990[_0x125f04(0xa7)]((_0x2672b9,_0x35f3a1)=>{var _0x514e38=_0x125f04;_0x79c5ed[_0x35f3a1][_0x514e38(0x13d)]=_0x2672b9;}),_0x124d69[_0x125f04(0xa7)]((_0x202f2d,_0x36a5f5)=>{_0x79c5ed[_0x36a5f5]['to_bin']=_0x202f2d;}),_0x1af041['forEach']((_0x44cc76,_0x3941b5)=>{var _0x2a19b2=_0x125f04;_0x79c5ed[_0x3941b5][_0x2a19b2(0x12c)]=_0x44cc76;}),_0x1805f6[_0x125f04(0xa7)]((_0x11d09d,_0x36482a)=>{var _0x4ac9e0=_0x125f04;_0x79c5ed[_0x36482a][_0x4ac9e0(0x113)]=_0x11d09d;}),_0x1d1b8b[_0x125f04(0xa7)]((_0x3a0b3f,_0x1350b2)=>{var _0x8a4408=_0x125f04;_0x79c5ed[_0x1350b2][_0x8a4408(0xeb)]=_0x3a0b3f;}),_0x21961b[_0x125f04(0xa7)]((_0x3a78be,_0x3ddb00)=>{var _0x54e43c=_0x125f04;_0x79c5ed[_0x3ddb00][_0x54e43c(0x9d)]=_0x3a78be;}),_0x39e219[_0x125f04(0xa7)]((_0x168fdf,_0x2df244)=>{var _0x288876=_0x125f04;_0x79c5ed[_0x2df244][_0x288876(0xad)]=_0x168fdf;}),_0x57c28e['forEach']((_0xfe9905,_0x41377e)=>{var _0xcfa440=_0x125f04;_0x79c5ed[_0x41377e][_0xcfa440(0xa9)]=_0xfe9905;}),_0x29ab78[_0x125f04(0xa7)]((_0x376078,_0x35f51d)=>{_0x79c5ed[_0x35f51d]['secondary_unit']=_0x376078;}),_0x25c1f4[_0x125f04(0xa7)]((_0x267be2,_0x5d13ab)=>{_0x79c5ed[_0x5d13ab]['batch_code']=_0x267be2;}),_0x4d1923[_0x125f04(0xa7)]((_0x35210e,_0x330f55)=>{var _0x1feb30=_0x125f04;_0x79c5ed[_0x330f55][_0x1feb30(0xb5)]=_0x35210e;}),_0x54ea74['forEach']((_0x5cbbf2,_0x399bd2)=>{var _0x3e1684=_0x125f04;_0x79c5ed[_0x399bd2][_0x3e1684(0xd6)]=_0x5cbbf2;}),_0x3518f9[_0x125f04(0xa7)]((_0x15c38f,_0x3f359f)=>{var _0x60d6b2=_0x125f04;_0x79c5ed[_0x3f359f][_0x60d6b2(0x163)]=_0x15c38f;}),_0x144e4b[_0x125f04(0xa7)]((_0x4b45fb,_0x39be0c)=>{var _0x4e8fe1=_0x125f04;_0x79c5ed[_0x39be0c][_0x4e8fe1(0x12f)]=_0x4b45fb;}),_0x2e9f94[_0x125f04(0xa7)]((_0x23ff35,_0x11ff1a)=>{var _0x2ab3ff=_0x125f04;_0x79c5ed[_0x11ff1a][_0x2ab3ff(0xe5)]=_0x23ff35;}),_0x58be25[_0x125f04(0xa7)]((_0x392fbb,_0x24c7d8)=>{var _0x2985f6=_0x125f04;_0x79c5ed[_0x24c7d8][_0x2985f6(0xc9)]=_0x392fbb;}),_0xe02d8[_0x125f04(0xa7)]((_0x446faf,_0x5c4fac)=>{var _0x16e102=_0x125f04;_0x79c5ed[_0x5c4fac][_0x16e102(0xd7)]=_0x446faf;});const _0x1d91c7=_0x79c5ed['filter'](_0x543044=>_0x543044[_0x125f04(0x120)]!=='0'&&_0x543044['to_quantity']!==''||_0x543044[_0x125f04(0x12c)]!=='0'&&_0x543044[_0x125f04(0x12c)]!=='');var _0x2ce9a3=0x0;_0x1d91c7['forEach'](_0x4c6f5b=>{var _0x55a388=_0x125f04;parseInt(_0x4c6f5b[_0x55a388(0x169)])<parseInt(_0x4c6f5b[_0x55a388(0x120)])&&_0x2ce9a3++;});if(_0x2ce9a3!=0x0)return _0x351b16[_0x125f04(0x18b)](_0x125f04(0xa1),_0x125f04(0x170)),_0x516f96[_0x125f04(0x9f)](_0x125f04(0x107));const _0x2086bc=await warehouse[_0x125f04(0x16b)]({'name':_0x59f399['from_warehouse'],'room':_0x59f399[_0x125f04(0x183)]});_0x59f399[_0x125f04(0x174)][_0x125f04(0xa7)](_0x36dc92=>{var _0x59a366=_0x125f04;if(_0x36dc92[_0x59a366(0x120)]>0x0){const _0x5e7554=_0x2086bc['product_details'][_0x59a366(0xd9)](_0x411410=>{var _0x4d921d=_0x59a366;_0x411410[_0x4d921d(0x15b)]==_0x36dc92[_0x4d921d(0x15b)]&&_0x411410['floorlevel']==_0x36dc92[_0x4d921d(0x133)]&&_0x411410['type']==_0x36dc92[_0x4d921d(0x12f)]&&_0x411410[_0x4d921d(0xc1)]==_0x36dc92['from_bin']&&_0x411410[_0x4d921d(0xda)]==_0x36dc92[_0x4d921d(0x115)]&&_0x411410[_0x4d921d(0x163)]==_0x36dc92[_0x4d921d(0xd7)]&&_0x411410[_0x4d921d(0xd6)]==_0x36dc92[_0x4d921d(0xc9)]&&(_0x411410['product_stock']=parseInt(_0x411410[_0x4d921d(0x111)])+parseInt(_0x36dc92[_0x4d921d(0x120)]));});}}),await _0x2086bc[_0x125f04(0x13a)]();const _0x5d0039=await warehouse[_0x125f04(0x16b)]({'name':_0x59f399[_0x125f04(0x10f)],'room':_0x59f399[_0x125f04(0xed)]});_0x59f399[_0x125f04(0x174)]['forEach'](_0x119564=>{var _0x13f972=_0x125f04;if(_0x119564[_0x13f972(0x120)]>0x0){const _0x5ddd3a=_0x5d0039[_0x13f972(0x13c)][_0x13f972(0xd9)](_0x138736=>{var _0x5999f3=_0x13f972;_0x138736[_0x5999f3(0x15b)]==_0x119564[_0x5999f3(0x15b)]&&_0x138736[_0x5999f3(0x156)]==_0x119564[_0x5999f3(0x12c)]&&_0x138736['type']==_0x119564[_0x5999f3(0xe5)]&&_0x138736['bin']==_0x119564['to_bin']&&_0x138736[_0x5999f3(0xda)]==_0x119564[_0x5999f3(0x13d)]&&_0x138736[_0x5999f3(0x163)]==_0x119564['rack']&&_0x138736['storage']==_0x119564[_0x5999f3(0xd6)]&&(_0x138736[_0x5999f3(0x111)]=parseInt(_0x138736[_0x5999f3(0x111)])-parseInt(_0x119564[_0x5999f3(0x120)]));});}}),await _0x5d0039['save'](),_0x59f399['date']=_0x5b9307,_0x59f399[_0x125f04(0x101)]=_0x2d35d0,_0x59f399['to_warehouse']=_0xba6f9,_0x59f399['product']=_0x1d91c7,_0x59f399[_0x125f04(0xb6)]=_0x4eba5c,_0x59f399[_0x125f04(0xb4)]=_0xc873eb;const _0x26a101=await _0x59f399['save']();console[_0x125f04(0x10e)](_0x26a101);const _0x42601f=await warehouse['findOne']({'name':_0x2d35d0,'room':_0x59b4ba});_0x26a101[_0x125f04(0x174)][_0x125f04(0xa7)](_0x87e9cd=>{var _0x40bf08=_0x125f04;if(_0x87e9cd[_0x40bf08(0x120)]>0x0){const _0x11af7b=_0x42601f[_0x40bf08(0x13c)][_0x40bf08(0xd9)](_0xee4f23=>{var _0x3da0d6=_0x40bf08;_0xee4f23['product_name']==_0x87e9cd['product_name']&&_0xee4f23['floorlevel']==_0x87e9cd[_0x3da0d6(0x133)]&&_0xee4f23[_0x3da0d6(0xea)]==_0x87e9cd[_0x3da0d6(0x12f)]&&_0xee4f23['bin']==_0x87e9cd[_0x3da0d6(0xe8)]&&_0xee4f23[_0x3da0d6(0xda)]==_0x87e9cd[_0x3da0d6(0x115)]&&_0xee4f23[_0x3da0d6(0x163)]==_0x87e9cd[_0x3da0d6(0xd7)]&&_0xee4f23['storage']==_0x87e9cd['from_storage']&&(_0xee4f23[_0x3da0d6(0x111)]=parseInt(_0xee4f23['product_stock'])-parseInt(_0x87e9cd['to_quantity']));});}}),await _0x42601f[_0x125f04(0x13a)]();const _0xfee77b=await warehouse[_0x125f04(0x16b)]({'name':_0xba6f9,'room':_0x5d58dc});_0x26a101['product'][_0x125f04(0xa7)](_0x579bca=>{var _0x3ce661=_0x125f04;if(_0x579bca[_0x3ce661(0x120)]>0x0){var _0x51b65c=0x0;const _0xf7595c=_0xfee77b[_0x3ce661(0x13c)][_0x3ce661(0xd9)](_0x27c0da=>{var _0x2455ba=_0x3ce661;_0x27c0da[_0x2455ba(0x15b)]==_0x579bca['product_name']&&_0x27c0da[_0x2455ba(0x156)]==_0x579bca[_0x2455ba(0x12c)]&&_0x27c0da[_0x2455ba(0xea)]==_0x579bca['to_types']&&_0x27c0da['bin']==_0x579bca['to_bin']&&_0x27c0da[_0x2455ba(0xda)]==_0x579bca['to_bay']&&_0x27c0da[_0x2455ba(0x163)]==_0x579bca[_0x2455ba(0x163)]&&_0x27c0da[_0x2455ba(0xd6)]==_0x579bca[_0x2455ba(0xd6)]&&(_0x27c0da[_0x2455ba(0x111)]=parseInt(_0x27c0da['product_stock'])+parseInt(_0x579bca[_0x2455ba(0x120)]),_0x51b65c++);});_0x51b65c=='0'&&(_0xfee77b['product_details']=_0xfee77b[_0x3ce661(0x13c)][_0x3ce661(0x132)]({'product_name':_0x579bca[_0x3ce661(0x15b)],'product_stock':_0x579bca[_0x3ce661(0x120)],'bay':_0x579bca[_0x3ce661(0x13d)],'bin':_0x579bca[_0x3ce661(0x11f)],'type':_0x579bca[_0x3ce661(0xe5)],'floorlevel':_0x579bca[_0x3ce661(0x12c)],'storage':_0x579bca['storage'],'rack':_0x579bca[_0x3ce661(0x163)],'product_code':_0x579bca['product_code'],'primary_code':_0x579bca['primary_code'],'secondary_code':_0x579bca[_0x3ce661(0xeb)],'maxProducts':_0x579bca[_0x3ce661(0xad)],'storage':_0x579bca[_0x3ce661(0xd6)],'rack':_0x579bca[_0x3ce661(0x163)]}));}}),await _0xfee77b['save'](),_0x351b16['flash'](_0x125f04(0x18e),'Transfer\x20Edit\x20Successfully'),_0x516f96[_0x125f04(0x9f)](_0x125f04(0x17a));}catch(_0xb2abe1){console['log'](_0xb2abe1);}}),router[a0_0x47bdc2(0x189)](a0_0x47bdc2(0xb9),async(_0x4b8e15,_0x367f83)=>{var _0x283da5=a0_0x47bdc2;const {FromWareHouse:_0x383ea1,FromRoom:_0x36d63b,ToWarehouse:_0x516b09,ToRoom:_0xfb297b,primary_code:_0x173cf6,Roomslist:_0x3f3a50}=_0x4b8e15[_0x283da5(0xab)],_0x274ce6=_0x3f3a50[_0x283da5(0xe9)](','),_0x4bbbb0=[];async function _0x186cb4(_0x57bf1f){var _0x215999=_0x283da5;const _0x2c2921=await warehouse[_0x215999(0x9e)]([{'$match':{'name':_0x383ea1,'room':_0x57bf1f}},{'$unwind':_0x215999(0xfc)},{'$match':{'product_details.primary_code':_0x173cf6}},{'$group':{'_id':_0x215999(0x180),'name':{'$first':_0x215999(0xaf)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x215999(0x18f)},'secondary_code':{'$first':_0x215999(0xf4)},'product_code':{'$first':_0x215999(0x14a)},'level':{'$first':_0x215999(0x190)},'isle':{'$first':_0x215999(0xe3)},'type':{'$first':_0x215999(0x152)},'pallet':{'$first':_0x215999(0x141)},'unit':{'$first':_0x215999(0xf6)},'secondary_unit':{'$first':_0x215999(0xf5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x215999(0x123)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x215999(0xfb)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x215999(0xaa)},'maxProducts':{'$first':_0x215999(0x118)},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x12cec8=await warehouse['aggregate']([{'$match':{'name':_0x383ea1,'room':_0x57bf1f}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x173cf6}},{'$group':{'_id':_0x215999(0x180),'name':{'$first':_0x215999(0xaf)},'instock':{'$first':_0x215999(0x13b)},'primary_code':{'$first':_0x215999(0x18f)},'secondary_code':{'$first':_0x215999(0xf4)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x215999(0x190)},'isle':{'$first':_0x215999(0xe3)},'type':{'$first':_0x215999(0x152)},'pallet':{'$first':_0x215999(0x141)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x215999(0xf5)},'storage':{'$first':_0x215999(0x143)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x215999(0xd4)},'batch_code':{'$first':_0x215999(0xfb)},'maxPerUnit':{'$first':_0x215999(0xbc)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x215999(0xaa)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':_0x215999(0x10b)}}}]);if(_0x2c2921[_0x215999(0xf0)]>0x0)_0x4bbbb0['push'](_0x2c2921);else _0x12cec8['length']>0x0&&_0x4bbbb0[_0x215999(0xe0)](_0x12cec8);}const _0x2ebeaf=_0x274ce6[_0x283da5(0xd9)](_0x5a298f=>_0x186cb4(_0x5a298f));await Promise[_0x283da5(0xbb)](_0x2ebeaf),_0x367f83[_0x283da5(0x127)](_0x4bbbb0);}),router[a0_0x47bdc2(0x189)](a0_0x47bdc2(0x12e),async(_0x4021a8,_0x4b9bae)=>{var _0x190fff=a0_0x47bdc2;try{const {FromWareHouse:_0x24b95e,FromRoom:_0x2d4a6d,ToWarehouse:_0x33d336,ToRoom:_0x156450,secondary_code:_0x31baeb}=_0x4021a8[_0x190fff(0xab)],_0x4e8a02=await warehouse[_0x190fff(0x9e)]([{'$match':{'name':_0x24b95e}},{'$unwind':_0x190fff(0xfc)},{'$match':{'product_details.secondary_code':_0x31baeb}},{'$group':{'_id':_0x190fff(0x180),'name':{'$first':_0x190fff(0xaf)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x190fff(0x14a)},'instock':{'$first':_0x190fff(0x13b)},'warehouse':{'$first':_0x190fff(0x16c)},'level':{'$first':_0x190fff(0x10a)},'isle':{'$first':_0x190fff(0x158)},'pallet':{'$first':_0x190fff(0x135)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x190fff(0xf6)}}}]);_0x4b9bae[_0x190fff(0xc8)](0xc8)[_0x190fff(0x127)](_0x4e8a02);}catch(_0x53366c){_0x4b9bae[_0x190fff(0xc8)](0x194)[_0x190fff(0x127)]({'message':_0x53366c[_0x190fff(0x153)]});}}),router[a0_0x47bdc2(0x189)]('/barcode_scanner3',async(_0x2910fa,_0x55dcc8)=>{var _0x175775=a0_0x47bdc2;try{const {FromWareHouse:_0x150cc5,FromRoom:_0x1a87a7,ToWarehouse:_0x35c198,ToRoom:_0x5558ac,product_code:_0x27b401}=_0x2910fa[_0x175775(0xab)],_0x283880=await warehouse['aggregate']([{'$match':{'name':_0x150cc5}},{'$unwind':_0x175775(0xfc)},{'$match':{'product_details.product_code':_0x27b401}},{'$group':{'_id':_0x175775(0x180),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x175775(0x18f)},'secondary_code':{'$first':_0x175775(0xf4)},'product_code':{'$first':_0x175775(0x14a)},'instock':{'$first':_0x175775(0x13b)},'warehouse':{'$first':_0x175775(0x16c)},'level':{'$first':_0x175775(0x10a)},'isle':{'$first':_0x175775(0x158)},'pallet':{'$first':_0x175775(0x135)},'maxProducts':{'$first':_0x175775(0x118)},'unit':{'$first':'$product_details.unit'}}}]);_0x55dcc8['status'](0xc8)[_0x175775(0x127)](_0x283880);}catch(_0x2a786d){_0x55dcc8[_0x175775(0xc8)](0x194)['json']({'message':_0x2a786d[_0x175775(0x153)]});}}),router[a0_0x47bdc2(0x189)](a0_0x47bdc2(0x177),async(_0x129bdd,_0x36fcb9)=>{var _0x170a9a=a0_0x47bdc2;const {level:_0x411852,isle:_0xc36dfd,pallet:_0x3cf73a,warehouses:_0xbb7a19,room:_0x4718b1}=_0x129bdd[_0x170a9a(0xab)];try{const _0x11c8ee=await warehouse['aggregate']([{'$match':{'name':_0xbb7a19,'room':_0x4718b1}},{'$unwind':_0x170a9a(0xfc)},{'$match':{'product_details.level':parseInt(_0x411852),'product_details.isle':_0xc36dfd,'product_details.pallet':parseInt(_0x3cf73a)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x170a9a(0x13b)},'level':{'$first':_0x170a9a(0x10a)},'isle':{'$first':_0x170a9a(0x158)},'pallet':{'$first':_0x170a9a(0x135)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x36fcb9[_0x170a9a(0xc8)](0xc8)[_0x170a9a(0x127)](_0x11c8ee);}catch(_0x2edddf){_0x36fcb9[_0x170a9a(0xc8)](0x194)['json']({'message':_0x2edddf[_0x170a9a(0x153)]});}}),module[a0_0x47bdc2(0xb8)]=router;