var a0_0x43b53a=a0_0x2268;(function(_0x36407d,_0x2078f8){var _0x3a4161=a0_0x2268,_0x33368e=_0x36407d();while(!![]){try{var _0xd6b121=-parseInt(_0x3a4161(0x120))/0x1*(-parseInt(_0x3a4161(0x141))/0x2)+parseInt(_0x3a4161(0x168))/0x3*(-parseInt(_0x3a4161(0x13c))/0x4)+-parseInt(_0x3a4161(0xb3))/0x5*(parseInt(_0x3a4161(0x9d))/0x6)+-parseInt(_0x3a4161(0x93))/0x7+-parseInt(_0x3a4161(0xb0))/0x8*(-parseInt(_0x3a4161(0x100))/0x9)+-parseInt(_0x3a4161(0xe9))/0xa+-parseInt(_0x3a4161(0x9c))/0xb*(parseInt(_0x3a4161(0xc8))/0xc);if(_0xd6b121===_0x2078f8)break;else _0x33368e['push'](_0x33368e['shift']());}catch(_0xfb6f39){_0x33368e['push'](_0x33368e['shift']());}}}(a0_0x197e,0x8f31b));const express=require(a0_0x43b53a(0x14d)),app=express(),router=express[a0_0x43b53a(0x128)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x43b53a(0xcd)),auth=require(a0_0x43b53a(0x175)),users=require(a0_0x43b53a(0x16c)),nodemailer=require(a0_0x43b53a(0x14b));function a0_0x2268(_0x466bd8,_0xe6948c){var _0x197e39=a0_0x197e();return a0_0x2268=function(_0x22688f,_0x78d90e){_0x22688f=_0x22688f-0x87;var _0x876f14=_0x197e39[_0x22688f];return _0x876f14;},a0_0x2268(_0x466bd8,_0xe6948c);}router[a0_0x43b53a(0xc0)]('/view',auth,async(_0x1f4eaa,_0x13a53f)=>{var _0x96780=a0_0x43b53a;try{const {username:_0x55e831,email:_0x3a437c,role:_0x1cbfda}=_0x1f4eaa[_0x96780(0xab)],_0x352698=_0x1f4eaa[_0x96780(0xab)],_0x4f5390=await profile[_0x96780(0xb9)]({'email':_0x352698[_0x96780(0xd5)]}),_0x517987=await master_shop[_0x96780(0xba)]();console[_0x96780(0xf6)](_0x96780(0xbf),_0x517987);let _0x2e7bf4;if(_0x352698[_0x96780(0xaf)]==_0x96780(0x167)){const _0x11a226=await staff[_0x96780(0xb9)]({'email':_0x352698[_0x96780(0xd5)]});_0x2e7bf4=await transfers[_0x96780(0xba)]({'from_warehouse':_0x11a226[_0x96780(0x135)]});}else _0x2e7bf4=await transfers[_0x96780(0x97)]([{'$unwind':_0x96780(0xfc)},{'$group':{'_id':_0x96780(0xd2),'invoice':{'$first':_0x96780(0xed)},'date':{'$first':_0x96780(0xf4)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x96780(0xa6)},'from_room_name':{'$addToSet':_0x96780(0x164)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x96780(0x155)},'isAllowEdit':{'$first':_0x96780(0x147)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x517987[0x0][_0x96780(0xdf)]==_0x96780(0xfb)){var _0x41a335=users['English'];console['log'](_0x41a335);}else{if(_0x517987[0x0][_0x96780(0xdf)]==_0x96780(0xc9))var _0x41a335=users[_0x96780(0xc9)];else{if(_0x517987[0x0][_0x96780(0xdf)]==_0x96780(0xef))var _0x41a335=users[_0x96780(0xef)];else{if(_0x517987[0x0][_0x96780(0xdf)]==_0x96780(0xca))var _0x41a335=users[_0x96780(0xca)];else{if(_0x517987[0x0][_0x96780(0xdf)]==_0x96780(0xaa))var _0x41a335=users['French'];else{if(_0x517987[0x0][_0x96780(0xdf)]==_0x96780(0x116))var _0x41a335=users['Portuguese'];else{if(_0x517987[0x0][_0x96780(0xdf)]==_0x96780(0x148))var _0x41a335=users['Chinese'];else{if(_0x517987[0x0]['language']==_0x96780(0x104))var _0x41a335=users[_0x96780(0x143)];}}}}}}}_0x13a53f[_0x96780(0xc3)]('transfer',{'success':_0x1f4eaa['flash'](_0x96780(0x92)),'errors':_0x1f4eaa['flash']('errors'),'role':_0x352698,'profile':_0x4f5390,'master_shop':_0x517987,'transfer':_0x2e7bf4,'language':_0x41a335});}catch(_0x330c90){console[_0x96780(0xf6)](_0x330c90);}});async function getRandom8DigitNumber(){var _0x2a3e11=a0_0x43b53a;const _0x12c14f=0x989680,_0x195536=0x5f5e0ff,_0x4f7312=Math[_0x2a3e11(0x174)](Math['random']()*(_0x195536-_0x12c14f+0x1))+_0x12c14f;var _0x146cd1;const _0x19dbed=await transfers[_0x2a3e11(0xb9)]({'invoice':'TRF-'+_0x4f7312});return _0x19dbed&&_0x19dbed[_0x2a3e11(0x133)]>0x0?_0x146cd1=_0x2a3e11(0xc2)+_0x4f7312:_0x146cd1=_0x2a3e11(0xc2)+_0x4f7312,_0x146cd1;}function a0_0x197e(){var _0x53a18b=['RoomAssigned','Rack\x20A','padStart','Portuguese','to_warehouse','from_invoice','password','errors','bin','Transfer\x20Edit\x20Successfully','</div>','/barcode_scanner2','expiry_date','$product_details.maxProducts','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Portuguese\x20(BR)','params','from_types','logo','COLD\x20STORAGE','from_room','$product_details.bin','_id','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','384665CPzEWV','$product_details.pallet','$room','to_invoice','rak','from_rak','True','findById','Router','exports','/picking_list/PDF_transfer_rm/','max_per_unit','$product_details.expiry_date','</td>','primary_code','getFullYear','from_prod_level','unit','to_quantity','length','</table>','warehouse','redirect','finalize','product_details','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','add_transfer','/../public','3196ZFrtiK','$product_details.product_code','</h5>','edit_transfer','to_types','6DAExRT','to_bay','Arabic','$product_details.product_stock','then','$product_details.product_name','$isAllowEdit','Chinese','post','split','nodemailer','from_storage','express','to_prod_pallet','message','$product_details.level','edit_transfer_view','Logo.png','from_bay','Enclosed','$finalize','<hr\x20class=\x22my-3\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','\x20Order\x20Date\x20:\x20','Rack\x20E','from_quantity','invoice','<div>','Transfer\x20Finalize\x20Successfully','$product_details.isle','$product_details.unit','date','\x20Order\x20Number\x20:\x20','Rack\x20C','flash','$product.from_room_name','</body></html>','updateOne','staff','2433hNLRLr','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','image','../public/language/languages.json','primary_unit','$product_details.secondary_unit','<html><head><title></title>','/barcode_scanner3','Email\x20sent\x20successfully','maxProducts','$product_details.primary_code','floor','../middleware/auth','to_prod_isle','</tr>','push','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','<h2>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','save','slice','/transfer/view','catch','Return\x20Rooms','from_warehouse','to_floorlevel','success','268261XTOpoe','from_prod_isle','Error\x20Occurs','New_Qty_Converted','aggregate','prod_cat','product','/upload/','Transfer\x20Mail','55RAmdZa','954zJkCxW','product_code3','Raw\x20Materials','from_floorlevel','$product_details.bay','createTransport','$product_details.batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','MaxStocks_data2','$to_warehouse','Enabled','Floor','from_prod_pallet','French','user','floorlevel','to_prod_level','production_date','role','4904CoGVMf','map','<!DOCTYPE\x20html>','23935wFfuaS','$product_details.rack','$product_details.secondary_code','rack','$name','prod_name','findOne','find','$product_details.type','To_invoice','concat','product_stock','master','get','ToRoomAssigned','TRF-','render','Ambient','$product_details.floorlevel','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product_name','55668gosCKc','Hindi','Spanish','from_bin','to_room','../models/all_models','Rack\x20B','sendMail','bay','$product_details._id','$_id','from_rack','secondary_unit','email','/preview/:id','site_title','$product_details','product_code','/view/:id','$product_details.production_date','Level','type','/view/add_transfer','language','Receiving\x20Area','to_prod_qty','note','to_bin','</tbody>','string','getMonth','all','forEach','856010ddZssh','storage','json','batch_code','$invoice','getDate','German','maxperunit','An\x20error\x20occurred\x20while\x20saving\x20data.','to_room_name','Shelves','$date','/CheckingWarehouse','log','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.maxPerUnit','from_prod_qty','body','English\x20(US)','$product','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','secondary_code','14517CCovAC','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','port','English','Arabic\x20(ae)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','status'];a0_0x197e=function(){return _0x53a18b;};return a0_0x197e();}router[a0_0x43b53a(0xc0)](a0_0x43b53a(0xde),auth,async(_0x219069,_0x469221)=>{var _0x4caa34=a0_0x43b53a;try{const {username:_0x596929,email:_0x2ac9b4,role:_0x45d437}=_0x219069[_0x4caa34(0xab)],_0x44b352=_0x219069[_0x4caa34(0xab)],_0xbc4cdf=await profile[_0x4caa34(0xb9)]({'email':_0x44b352[_0x4caa34(0xd5)]}),_0x3d6a5e=await master_shop[_0x4caa34(0xba)]();console['log']('master',_0x3d6a5e);let _0x3f8530;if(_0x44b352[_0x4caa34(0xaf)]==_0x4caa34(0x167)){const _0x36512d=await staff[_0x4caa34(0xb9)]({'email':_0x44b352[_0x4caa34(0xd5)]});_0x3f8530=await warehouse[_0x4caa34(0x97)]([{'$match':{'status':_0x4caa34(0xa7),'name':_0x36512d[_0x4caa34(0x135)],'warehouse_category':_0x4caa34(0x9f)}},{'$group':{'_id':_0x4caa34(0xb7),'name':{'$first':_0x4caa34(0xb7)}}}]);}else _0x3f8530=await warehouse[_0x4caa34(0x97)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x4caa34(0xb7),'name':{'$first':_0x4caa34(0xb7)}}}]);var _0x34bb91=[_0x4caa34(0xc4),_0x4caa34(0x154),_0x4caa34(0x8f)];const _0x10578f=await transfers[_0x4caa34(0xba)]({}),_0x3294fe=_0x10578f[_0x4caa34(0x133)]+0x1,_0x2f997b=_0x4caa34(0xc2)+_0x3294fe['toString']()[_0x4caa34(0x109)](0x5,'0');if(_0x3d6a5e[0x0][_0x4caa34(0xdf)]==_0x4caa34(0xfb)){var _0x2ba0f1=users['English'];console[_0x4caa34(0xf6)](_0x2ba0f1);}else{if(_0x3d6a5e[0x0][_0x4caa34(0xdf)]==_0x4caa34(0xc9))var _0x2ba0f1=users['Hindi'];else{if(_0x3d6a5e[0x0]['language']==_0x4caa34(0xef))var _0x2ba0f1=users['German'];else{if(_0x3d6a5e[0x0][_0x4caa34(0xdf)]==_0x4caa34(0xca))var _0x2ba0f1=users[_0x4caa34(0xca)];else{if(_0x3d6a5e[0x0][_0x4caa34(0xdf)]==_0x4caa34(0xaa))var _0x2ba0f1=users['French'];else{if(_0x3d6a5e[0x0][_0x4caa34(0xdf)]==_0x4caa34(0x116))var _0x2ba0f1=users[_0x4caa34(0x10a)];else{if(_0x3d6a5e[0x0]['language']==_0x4caa34(0x148))var _0x2ba0f1=users[_0x4caa34(0x148)];else{if(_0x3d6a5e[0x0][_0x4caa34(0xdf)]=='Arabic\x20(ae)')var _0x2ba0f1=users[_0x4caa34(0x143)];}}}}}}}const _0x1b622a=getRandom8DigitNumber();_0x1b622a[_0x4caa34(0x145)](_0x124cfa=>{var _0x5cf331=_0x4caa34;_0x469221['render'](_0x5cf331(0x13a),{'success':_0x219069['flash'](_0x5cf331(0x92)),'errors':_0x219069[_0x5cf331(0x163)](_0x5cf331(0x10e)),'role':_0x44b352,'profile':_0xbc4cdf,'master_shop':_0x3d6a5e,'warehouse':_0x3f8530,'language':_0x2ba0f1,'rooms_data':_0x34bb91,'invoice':_0x124cfa});})[_0x4caa34(0x8e)](_0x474093=>{var _0x22203c=_0x4caa34;_0x219069[_0x22203c(0x163)](_0x22203c(0x10e),_0x22203c(0xf7)),_0x469221[_0x22203c(0x136)](_0x22203c(0x8d));});}catch(_0x20d049){console[_0x4caa34(0xf6)](_0x20d049);}}),router[a0_0x43b53a(0x149)](a0_0x43b53a(0xde),auth,async(_0x1e4b88,_0x429c09)=>{var _0x325e49=a0_0x43b53a;try{console[_0x325e49(0xf6)](_0x1e4b88['body']);const {date:_0x243804,from_warehouse:_0x4b6001,FromRoom_name:_0x1a456e,to_warehouse:_0x59fae4,ToRoom_name:_0x240dcc,prod_name:_0x40d244,from_prod_qty:_0x2995cc,from_prod_level:_0x295d28,from_prod_isle:_0x1224a5,from_prod_pallet:_0x3b4b68,to_prod_qty:_0x111660,to_prod_level:_0x5e691b,to_prod_isle:_0x4eee37,to_prod_pallet:_0x408111,primary_code:_0x4526f3,secondary_code:_0x3a49e0,product_code3:_0x3b8382,note:_0x44b851,MaxStocks_data2:_0x4c086d,invoice:_0x308ffe,expiry_date:_0x64c73f}=_0x1e4b88['body'];if(typeof _0x40d244==_0x325e49(0xe5))var _0x194bff=[_0x1e4b88[_0x325e49(0xfa)]['prod_name']],_0x5682bd=[_0x1e4b88['body']['from_prod_qty']],_0x4f835b=[_0x1e4b88['body']['from_prod_level']],_0x4be51a=[_0x1e4b88['body']['New_Qty_Converted']],_0x2a080e=[_0x1e4b88['body'][_0x325e49(0xad)]],_0x94f93f=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x12e)]],_0x3c852a=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xff)]],_0x26542a=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x9e)]],_0xd784c5=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xa5)]],_0x3bb455=[_0x1e4b88['body']['primary_unit']],_0x4e5642=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xd4)]],_0x127873=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xec)]],_0x98d7e9=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x113)]],_0xeacc8f=[_0x1e4b88[_0x325e49(0xfa)]['max_per_unit']],_0x4c8de4=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xae)]],_0xf739be=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x98)]],_0x241243=[_0x1e4b88['body'][_0x325e49(0x107)]],_0x12259f=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xc1)]],_0x22a069=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x10c)]],_0x27253e=[_0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x123)]];else var _0x194bff=[..._0x1e4b88['body']['prod_name']],_0x5682bd=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xf9)]],_0x4f835b=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x130)]],_0x4be51a=[..._0x1e4b88['body'][_0x325e49(0x96)]],_0x2a080e=[..._0x1e4b88[_0x325e49(0xfa)]['to_prod_level']],_0x94f93f=[..._0x1e4b88[_0x325e49(0xfa)]['primary_code']],_0x3c852a=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xff)]],_0x26542a=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x9e)]],_0xd784c5=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xa5)]],_0x3bb455=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x16d)]],_0x4e5642=[..._0x1e4b88['body'][_0x325e49(0xd4)]],_0x127873=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0xec)]],_0x98d7e9=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x113)]],_0xeacc8f=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x12b)]],_0x4c8de4=[..._0x1e4b88[_0x325e49(0xfa)]['production_date']],_0xf739be=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x98)]],_0x241243=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x107)]],_0x12259f=[..._0x1e4b88[_0x325e49(0xfa)]['ToRoomAssigned']],_0x22a069=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x10c)]],_0x27253e=[..._0x1e4b88[_0x325e49(0xfa)][_0x325e49(0x123)]];const _0xf5b78e=_0x194bff[_0x325e49(0xb1)](_0x58d4c4=>{return _0x58d4c4={'product_name':_0x58d4c4};});_0x5682bd[_0x325e49(0xe8)]((_0x4bf9b5,_0x1d09a3)=>{var _0x7ed894=_0x325e49;_0xf5b78e[_0x1d09a3][_0x7ed894(0x15a)]=_0x4bf9b5;}),_0x22a069[_0x325e49(0xe8)]((_0x1ee017,_0x221968)=>{var _0x2f57c5=_0x325e49;_0xf5b78e[_0x221968][_0x2f57c5(0x10c)]=_0x1ee017;}),_0x27253e[_0x325e49(0xe8)]((_0x42efda,_0x127982)=>{var _0x2e748f=_0x325e49;_0xf5b78e[_0x127982][_0x2e748f(0xbc)]=_0x42efda;}),_0x4f835b[_0x325e49(0xe8)]((_0x500c9e,_0x414dee)=>{_0x241243['forEach']((_0x9087a3,_0x59d6f5)=>{var _0x1a8ea9=a0_0x2268;if(_0x9087a3=='Receiving\x20Area'&&_0x414dee==_0x59d6f5){var _0x425800=_0x500c9e[_0x1a8ea9(0x8c)](0x3);_0xf5b78e[_0x414dee][_0x1a8ea9(0x14c)]=_0x500c9e[0x0],_0xf5b78e[_0x414dee][_0x1a8ea9(0xd3)]=_0x500c9e[0x1],_0xf5b78e[_0x414dee]['from_bay']=0x0,_0xf5b78e[_0x414dee][_0x1a8ea9(0xcb)]=0x0,_0xf5b78e[_0x414dee][_0x1a8ea9(0x118)]='Floor',_0xf5b78e[_0x414dee][_0x1a8ea9(0xa0)]=_0x425800;}else{if(_0x9087a3==_0x1a8ea9(0xf3)&&_0x414dee==_0x59d6f5){var _0x425800=_0x500c9e[_0x1a8ea9(0x8c)](0x3);_0xf5b78e[_0x414dee]['from_storage']=_0x500c9e[0x0],_0xf5b78e[_0x414dee][_0x1a8ea9(0xd3)]=_0x500c9e[0x1],_0xf5b78e[_0x414dee][_0x1a8ea9(0x153)]=0x0,_0xf5b78e[_0x414dee]['from_bin']=0x0,_0xf5b78e[_0x414dee]['from_types']=_0x1a8ea9(0xa8),_0xf5b78e[_0x414dee][_0x1a8ea9(0xa0)]=_0x500c9e[0x5];}else{if(_0x414dee==_0x59d6f5){var _0x421c06;if(_0x500c9e[0x4]=='L')_0x421c06=_0x1a8ea9(0xdc);else _0x500c9e[0x4]=='F'&&(_0x421c06=_0x1a8ea9(0xa8));_0xf5b78e[_0x414dee]['from_storage']=_0x500c9e[0x0],_0xf5b78e[_0x414dee]['from_rack']=_0x500c9e[0x1],_0xf5b78e[_0x414dee][_0x1a8ea9(0x153)]=_0x500c9e[0x2],_0xf5b78e[_0x414dee]['from_bin']=_0x500c9e[0x3],_0xf5b78e[_0x414dee][_0x1a8ea9(0x118)]=_0x421c06,_0xf5b78e[_0x414dee][_0x1a8ea9(0xa0)]=_0x500c9e[0x5];}}}});}),_0x4be51a['forEach']((_0x19b4a7,_0x4441ee)=>{var _0x403af6=_0x325e49;_0xf5b78e[_0x4441ee][_0x403af6(0x132)]=_0x19b4a7;}),_0x2a080e[_0x325e49(0xe8)]((_0x226f2f,_0x180741)=>{var _0x12958f=_0x325e49;_0x12259f[_0x12958f(0xe8)]((_0x5d1906,_0x4893ab)=>{var _0x184a56=_0x12958f;if(_0x5d1906==_0x184a56(0xe0)&&_0x180741==_0x4893ab){var _0x3ae5dc=_0x226f2f[_0x184a56(0x8c)](0x3);_0xf5b78e[_0x180741][_0x184a56(0xea)]=_0x226f2f[0x0],_0xf5b78e[_0x180741][_0x184a56(0xb6)]=_0x226f2f[0x1],_0xf5b78e[_0x180741]['to_bay']=0x0,_0xf5b78e[_0x180741][_0x184a56(0xe3)]=0x0,_0xf5b78e[_0x180741][_0x184a56(0x140)]=_0x184a56(0xa8),_0xf5b78e[_0x180741][_0x184a56(0x91)]=_0x3ae5dc;}else{if(_0x5d1906=='Shelves'&&_0x180741==_0x4893ab){var _0x3ae5dc=_0x226f2f['slice'](0x3);_0xf5b78e[_0x180741]['storage']=_0x226f2f[0x0],_0xf5b78e[_0x180741][_0x184a56(0xb6)]=_0x226f2f[0x1],_0xf5b78e[_0x180741][_0x184a56(0x142)]=0x0,_0xf5b78e[_0x180741][_0x184a56(0xe3)]=0x0,_0xf5b78e[_0x180741][_0x184a56(0x140)]=_0x184a56(0xa8),_0xf5b78e[_0x180741]['to_floorlevel']=_0x226f2f[0x5];}else{if(_0x180741==_0x4893ab){var _0x4a2064;if(_0x226f2f[0x4]=='L')_0x4a2064='Level';else _0x226f2f[0x4]=='F'&&(_0x4a2064=_0x184a56(0xa8));_0xf5b78e[_0x180741][_0x184a56(0xea)]=_0x226f2f[0x0],_0xf5b78e[_0x180741]['rack']=_0x226f2f[0x1],_0xf5b78e[_0x180741][_0x184a56(0x142)]=_0x226f2f[0x2],_0xf5b78e[_0x180741][_0x184a56(0xe3)]=_0x226f2f[0x3],_0xf5b78e[_0x180741]['to_types']=_0x4a2064,_0xf5b78e[_0x180741][_0x184a56(0x91)]=_0x226f2f[0x5];}}}});}),_0x94f93f[_0x325e49(0xe8)]((_0x10a465,_0xc9f4dc)=>{_0xf5b78e[_0xc9f4dc]['primary_code']=_0x10a465;}),_0x3c852a[_0x325e49(0xe8)]((_0x312b67,_0x22ee0f)=>{_0xf5b78e[_0x22ee0f]['secondary_code']=_0x312b67;}),_0x26542a[_0x325e49(0xe8)]((_0x13f2e5,_0x5d3361)=>{var _0x3285ed=_0x325e49;_0xf5b78e[_0x5d3361][_0x3285ed(0xd9)]=_0x13f2e5;}),_0xd784c5[_0x325e49(0xe8)]((_0x1f1767,_0x47be62)=>{var _0x2c42c9=_0x325e49;_0xf5b78e[_0x47be62][_0x2c42c9(0x172)]=_0x1f1767;}),_0x3bb455[_0x325e49(0xe8)]((_0x1c11d1,_0x2873a3)=>{_0xf5b78e[_0x2873a3]['unit']=_0x1c11d1;}),_0x4e5642[_0x325e49(0xe8)]((_0x3018de,_0x2f970d)=>{var _0x3ea810=_0x325e49;_0xf5b78e[_0x2f970d][_0x3ea810(0xd4)]=_0x3018de;}),_0x127873[_0x325e49(0xe8)]((_0x8caf6,_0x85674)=>{var _0x50e215=_0x325e49;_0xf5b78e[_0x85674][_0x50e215(0xec)]=_0x8caf6;}),_0x98d7e9[_0x325e49(0xe8)]((_0x5c1b95,_0x36258b)=>{var _0x1af0a6=_0x325e49;_0xf5b78e[_0x36258b][_0x1af0a6(0x113)]=_0x5c1b95;}),_0xeacc8f[_0x325e49(0xe8)]((_0x14f7a0,_0x5cebf7)=>{_0xf5b78e[_0x5cebf7]['maxperunit']=_0x14f7a0;}),_0x4c8de4[_0x325e49(0xe8)]((_0x493b8b,_0x3afb96)=>{var _0x306de3=_0x325e49;_0xf5b78e[_0x3afb96][_0x306de3(0xae)]=_0x493b8b;}),_0xf739be[_0x325e49(0xe8)]((_0x4b176b,_0x52503c)=>{var _0x29b8fd=_0x325e49;_0xf5b78e[_0x52503c][_0x29b8fd(0x98)]=_0x4b176b;}),_0x241243[_0x325e49(0xe8)]((_0xa4eb22,_0x13a9e8)=>{_0xf5b78e[_0x13a9e8]['from_room_name']=_0xa4eb22;}),_0x12259f[_0x325e49(0xe8)]((_0x1e6526,_0x14917c)=>{var _0x1ef93d=_0x325e49;_0xf5b78e[_0x14917c][_0x1ef93d(0xf2)]=_0x1e6526;});const _0x5c8a67=_0xf5b78e['filter'](_0x298a34=>_0x298a34[_0x325e49(0x132)]!=='0'&&_0x298a34[_0x325e49(0x132)]!==''||_0x298a34['to_floorlevel']!=='0'&&_0x298a34[_0x325e49(0x91)]!==''),_0x42a661=new transfers({'date':_0x243804,'from_warehouse':_0x4b6001,'to_warehouse':_0x59fae4,'product':_0x5c8a67,'note':_0x44b851,'invoice':_0x308ffe}),_0x50c65b=await _0x42a661[_0x325e49(0x8b)]();_0x1e4b88[_0x325e49(0x163)](_0x325e49(0x92),'Product\x20Transfer\x20successfully'),_0x429c09[_0x325e49(0x136)]('/transfer/preview/'+_0x50c65b[_0x325e49(0x11d)]);}catch(_0x43719e){console[_0x325e49(0xf6)](_0x43719e),_0x429c09['status'](0xc8)[_0x325e49(0xeb)]({'errorMessage':_0x43719e['message']});}}),router['get'](a0_0x43b53a(0xd6),auth,async(_0x4176b8,_0x5bc126)=>{var _0x441ba5=a0_0x43b53a;try{const {username:_0x41e98e,email:_0x35ccee,role:_0x4f6953}=_0x4176b8[_0x441ba5(0xab)],_0x46e75b=_0x4176b8[_0x441ba5(0xab)],_0x40ba14=await profile[_0x441ba5(0xb9)]({'email':_0x46e75b['email']}),_0x3fa52b=await master_shop[_0x441ba5(0xba)]();console[_0x441ba5(0xf6)]('master',_0x3fa52b);const _0x8382fa=await transfers[_0x441ba5(0x127)](_0x4176b8[_0x441ba5(0x117)]['id']);let _0x204b5f=new Date(_0x8382fa[_0x441ba5(0x113)]),_0x3a7203=('0'+_0x204b5f[_0x441ba5(0xee)]())[_0x441ba5(0x8c)](-0x2),_0x28b954=('0'+(_0x204b5f[_0x441ba5(0xe6)]()+0x1))[_0x441ba5(0x8c)](-0x2),_0x15ffc5=_0x204b5f[_0x441ba5(0x12f)](),_0x40d1c6=_0x15ffc5+'-'+_0x28b954+'-'+_0x3a7203,_0x145ab5;if(_0x46e75b['role']=='staff'){const _0xba5667=await staff[_0x441ba5(0xb9)]({'email':_0x46e75b[_0x441ba5(0xd5)]});_0x145ab5=await warehouse['find']({'status':_0x441ba5(0xa7),'name':_0xba5667[_0x441ba5(0x135)],'warehouse_category':_0x441ba5(0x9f)});}else _0x145ab5=await warehouse[_0x441ba5(0xba)]({'status':_0x441ba5(0xa7),'warehouse_category':_0x441ba5(0x9f)});const _0x29e5c9=await warehouse[_0x441ba5(0x97)]([{'$match':{'name':_0x8382fa[_0x441ba5(0x90)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x441ba5(0x146)},'product_stock':{'$first':_0x441ba5(0x144)},'bay':{'$first':_0x441ba5(0xa1)},'bin':{'$first':_0x441ba5(0x11c)},'type':{'$first':_0x441ba5(0xbb)},'floorlevel':{'$first':_0x441ba5(0xc5)},'primary_code':{'$first':_0x441ba5(0x173)},'secondary_code':{'$first':_0x441ba5(0xb5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x441ba5(0x169)},'rack':{'$first':_0x441ba5(0xb4)},'expiry_date':{'$first':_0x441ba5(0x12c)},'production_date':{'$first':_0x441ba5(0xdb)},'room':{'$first':'$room'}}}]);if(_0x3fa52b[0x0]['language']=='English\x20(US)'){var _0x34f1e9=users[_0x441ba5(0x103)];console['log'](_0x34f1e9);}else{if(_0x3fa52b[0x0]['language']==_0x441ba5(0xc9))var _0x34f1e9=users['Hindi'];else{if(_0x3fa52b[0x0][_0x441ba5(0xdf)]==_0x441ba5(0xef))var _0x34f1e9=users[_0x441ba5(0xef)];else{if(_0x3fa52b[0x0]['language']=='Spanish')var _0x34f1e9=users[_0x441ba5(0xca)];else{if(_0x3fa52b[0x0][_0x441ba5(0xdf)]==_0x441ba5(0xaa))var _0x34f1e9=users['French'];else{if(_0x3fa52b[0x0][_0x441ba5(0xdf)]==_0x441ba5(0x116))var _0x34f1e9=users[_0x441ba5(0x10a)];else{if(_0x3fa52b[0x0][_0x441ba5(0xdf)]==_0x441ba5(0x148))var _0x34f1e9=users[_0x441ba5(0x148)];else{if(_0x3fa52b[0x0][_0x441ba5(0xdf)]=='Arabic\x20(ae)')var _0x34f1e9=users['Arabic'];}}}}}}}_0x5bc126[_0x441ba5(0xc3)](_0x441ba5(0x151),{'success':_0x4176b8[_0x441ba5(0x163)](_0x441ba5(0x92)),'errors':_0x4176b8[_0x441ba5(0x163)](_0x441ba5(0x10e)),'role':_0x46e75b,'profile':_0x40ba14,'master_shop':_0x3fa52b,'warehouse':_0x145ab5,'transfer':_0x8382fa,'stock':_0x29e5c9,'language':_0x34f1e9});}catch(_0x3bd0f4){console[_0x441ba5(0xf6)](_0x3bd0f4);}}),router[a0_0x43b53a(0x149)](a0_0x43b53a(0xd6),auth,async(_0xa400c5,_0x52f661)=>{var _0x1ecb91=a0_0x43b53a;try{const _0x3b9c79=_0xa400c5['params']['id'],{from_warehouse:_0x1ff084,FromRoom_name:_0x5da76b,to_warehouse:_0x4a79b2,ToRoom_name:_0x23b808}=_0xa400c5['body'],_0x31e453=await transfers[_0x1ecb91(0x127)]({'_id':_0x3b9c79}),_0x117c94=_0x31e453[_0x1ecb91(0x99)][_0x1ecb91(0xb1)](async _0x2e320e=>{var _0x8fefec=_0x1ecb91;if(_0x2e320e[_0x8fefec(0x132)]>0x0){var _0x3b1f1c=await warehouse[_0x8fefec(0xb9)]({'name':_0x31e453[_0x8fefec(0x90)],'room':_0x2e320e['from_room_name'],'warehouse_category':'Raw\x20Materials'});const _0x4d90c3=_0x3b1f1c[_0x8fefec(0x138)][_0x8fefec(0xb1)](_0x2cf8df=>{var _0x6d568c=_0x8fefec;_0x2cf8df[_0x6d568c(0xc7)]==_0x2e320e[_0x6d568c(0xc7)]&&_0x2cf8df[_0x6d568c(0xac)]==_0x2e320e[_0x6d568c(0xa0)]&&_0x2cf8df[_0x6d568c(0xdd)]==_0x2e320e[_0x6d568c(0x118)]&&_0x2cf8df[_0x6d568c(0x10f)]==_0x2e320e['from_bin']&&_0x2cf8df[_0x6d568c(0xd0)]==_0x2e320e[_0x6d568c(0x153)]&&_0x2cf8df[_0x6d568c(0xb6)]==_0x2e320e[_0x6d568c(0xd3)]&&_0x2cf8df[_0x6d568c(0xea)]==_0x2e320e[_0x6d568c(0x14c)]&&_0x2cf8df[_0x6d568c(0x113)]==_0x2e320e[_0x6d568c(0x113)]&&_0x2cf8df[_0x6d568c(0xec)]==_0x2e320e['batch_code']&&_0x2cf8df[_0x6d568c(0xae)]==_0x2e320e[_0x6d568c(0xae)]&&_0x2cf8df[_0x6d568c(0x15b)]==_0x2e320e[_0x6d568c(0x10c)]&&(_0x2cf8df['product_stock']=_0x2cf8df[_0x6d568c(0xbe)]-_0x2e320e[_0x6d568c(0x132)]);});}return _0x3b1f1c;});Promise['all'](_0x117c94)[_0x1ecb91(0x145)](async _0x399f4f=>{var _0x25eab8=_0x1ecb91;try{for(const _0x32f3e6 of _0x399f4f){await _0x32f3e6[_0x25eab8(0x8b)]();}try{const _0x208801=_0x31e453[_0x25eab8(0x99)][_0x25eab8(0xb1)](async _0x2cc069=>{var _0x2387bf=_0x25eab8;if(_0x2cc069[_0x2387bf(0x132)]>0x0){var _0x5e2877=await warehouse[_0x2387bf(0xb9)]({'name':_0x31e453[_0x2387bf(0x10b)],'room':_0x2cc069[_0x2387bf(0xf2)],'warehouse_category':'Raw\x20Materials'}),_0x5ba2c5=0x0;const _0x18cf0b=_0x5e2877[_0x2387bf(0x138)][_0x2387bf(0xb1)](_0x47e733=>{var _0xc61e8f=_0x2387bf;_0x47e733['product_name']==_0x2cc069[_0xc61e8f(0xc7)]&&_0x47e733['floorlevel']==_0x2cc069[_0xc61e8f(0x91)]&&_0x47e733[_0xc61e8f(0xdd)]==_0x2cc069[_0xc61e8f(0x140)]&&_0x47e733[_0xc61e8f(0x10f)]==_0x2cc069['to_bin']&&_0x47e733[_0xc61e8f(0xd0)]==_0x2cc069[_0xc61e8f(0x142)]&&_0x47e733[_0xc61e8f(0xb6)]==_0x2cc069['rack']&&_0x47e733[_0xc61e8f(0xea)]==_0x2cc069[_0xc61e8f(0xea)]&&_0x47e733['expiry_date']==_0x2cc069[_0xc61e8f(0x113)]&&_0x47e733[_0xc61e8f(0xec)]==_0x2cc069[_0xc61e8f(0xec)]&&_0x47e733[_0xc61e8f(0xae)]==_0x2cc069[_0xc61e8f(0xae)]&&_0x47e733['invoice']==_0x2cc069[_0xc61e8f(0xbc)]&&(_0x47e733[_0xc61e8f(0xbe)]=_0x47e733[_0xc61e8f(0xbe)]+_0x2cc069['to_quantity'],_0x5ba2c5++);});_0x5ba2c5=='0'&&(_0x5e2877[_0x2387bf(0x138)]=_0x5e2877['product_details'][_0x2387bf(0xbd)]({'product_name':_0x2cc069[_0x2387bf(0xc7)],'product_stock':_0x2cc069['to_quantity'],'bay':_0x2cc069[_0x2387bf(0x142)],'bin':_0x2cc069[_0x2387bf(0xe3)],'type':_0x2cc069[_0x2387bf(0x140)],'floorlevel':_0x2cc069['to_floorlevel'],'storage':_0x2cc069[_0x2387bf(0xea)],'rack':_0x2cc069[_0x2387bf(0xb6)],'product_code':_0x2cc069[_0x2387bf(0xd9)],'primary_code':_0x2cc069[_0x2387bf(0x12e)],'secondary_code':_0x2cc069[_0x2387bf(0xff)],'maxProducts':_0x2cc069['maxProducts'],'storage':_0x2cc069[_0x2387bf(0xea)],'rack':_0x2cc069[_0x2387bf(0xb6)],'expiry_date':_0x2cc069['expiry_date'],'maxPerUnit':_0x2cc069[_0x2387bf(0xf0)],'batch_code':_0x2cc069[_0x2387bf(0xec)],'production_date':_0x2cc069['production_date']}));}return _0x5e2877;});Promise[_0x25eab8(0xe7)](_0x208801)[_0x25eab8(0x145)](async _0x29a2c1=>{var _0x3ac99e=_0x25eab8;try{for(const _0x3bd87d of _0x29a2c1){await warehouse[_0x3ac99e(0x166)]({'_id':_0x3bd87d['_id']},{'$addToSet':{'product_details':{'$each':_0x3bd87d[_0x3ac99e(0x138)]}}});}_0x31e453[_0x3ac99e(0x137)]=_0x3ac99e(0x126);const _0x538aef=await _0x31e453[_0x3ac99e(0x8b)](),_0x17aac3=await master_shop[_0x3ac99e(0xba)](),_0x5e79fb=await email_settings['findOne'](),_0x4e752a=await supervisor_settings[_0x3ac99e(0xba)]();var _0x3a9fe0=_0x31e453[_0x3ac99e(0x99)],_0x1cd265='',_0x307992;for(_0x307992 in _0x3a9fe0){_0x1cd265+='<tr>'+_0x3ac99e(0x139)+_0x3a9fe0[_0x307992][_0x3ac99e(0xc7)]+_0x3ac99e(0x12d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a9fe0[_0x307992][_0x3ac99e(0xd9)]+'</td>'+_0x3ac99e(0x139)+_0x3a9fe0[_0x307992]['to_quantity']+_0x3ac99e(0x12d)+_0x3ac99e(0x139)+_0x3a9fe0[_0x307992][_0x3ac99e(0x131)]+_0x3ac99e(0x12d)+_0x3ac99e(0x139)+_0x3a9fe0[_0x307992][_0x3ac99e(0xd4)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x31e453['to_warehouse']+_0x3ac99e(0x12d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a9fe0[_0x307992]['to_room_name']+_0x3ac99e(0x12d)+_0x3ac99e(0x139)+_0x3a9fe0[_0x307992][_0x3ac99e(0xea)]+_0x3a9fe0[_0x307992][_0x3ac99e(0xb6)]+_0x3a9fe0[_0x307992][_0x3ac99e(0x142)]+_0x3a9fe0[_0x307992][_0x3ac99e(0xe3)]+_0x3a9fe0[_0x307992][_0x3ac99e(0x140)][0x0]+_0x3a9fe0[_0x307992]['to_floorlevel']+_0x3ac99e(0x12d),_0x3ac99e(0x177);}let _0x1b3cc9=nodemailer[_0x3ac99e(0xa2)]({'host':_0x5e79fb['host'],'port':Number(_0x5e79fb[_0x3ac99e(0x102)]),'secure':![],'auth':{'user':_0x5e79fb[_0x3ac99e(0xd5)],'pass':_0x5e79fb[_0x3ac99e(0x10d)]}}),_0x28ec37={'from':_0x5e79fb['email'],'to':_0x4e752a[0x0]['RMSEmail'],'subject':_0x3ac99e(0x9b),'attachments':[{'filename':_0x3ac99e(0x152),'path':__dirname+_0x3ac99e(0x13b)+_0x3ac99e(0x9a)+_0x17aac3[0x0][_0x3ac99e(0x16b)],'cid':_0x3ac99e(0x119)}],'html':_0x3ac99e(0xb2)+_0x3ac99e(0x16f)+'</head><body>'+_0x3ac99e(0x15c)+_0x3ac99e(0xc6)+_0x3ac99e(0x15c)+_0x3ac99e(0x115)+'</div>'+_0x3ac99e(0x15c)+_0x3ac99e(0x89)+_0x17aac3[0x0][_0x3ac99e(0xd7)]+'\x20</h2>'+_0x3ac99e(0x111)+_0x3ac99e(0x111)+_0x3ac99e(0x156)+'<div>'+_0x3ac99e(0x157)+_0x3ac99e(0x161)+_0x31e453[_0x3ac99e(0x15b)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x3ac99e(0x158)+_0x31e453[_0x3ac99e(0x160)]+'\x20'+'</span>'+_0x3ac99e(0x13e)+_0x3ac99e(0x111)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x3ac99e(0xa4)+_0x3ac99e(0xfe)+_0x3ac99e(0x101)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x3ac99e(0x16a)+_0x3ac99e(0x11f)+_0x3ac99e(0x105)+_0x3ac99e(0x8a)+_0x3ac99e(0x177)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1cd265+'\x20'+_0x3ac99e(0xe4)+_0x3ac99e(0x134)+_0x3ac99e(0x15c)+'<strong>\x20Regards\x20</strong>'+_0x3ac99e(0x11e)+_0x17aac3[0x0][_0x3ac99e(0xd7)]+_0x3ac99e(0x13e)+_0x3ac99e(0x111)+_0x3ac99e(0x111)+_0x3ac99e(0x165)};_0x1b3cc9[_0x3ac99e(0xcf)](_0x28ec37,function(_0x366146,_0x256e74){var _0xb37bd1=_0x3ac99e;_0x366146?(console['log'](_0x366146),console[_0xb37bd1(0xf6)](_0xb37bd1(0x95))):console[_0xb37bd1(0xf6)](_0xb37bd1(0x171));}),_0xa400c5[_0x3ac99e(0x163)](_0x3ac99e(0x92),_0x3ac99e(0x15d)),_0x52f661[_0x3ac99e(0x136)](_0x3ac99e(0x12a)+_0x538aef[_0x3ac99e(0x11d)]);}catch(_0x5c736d){console[_0x3ac99e(0xfd)](_0x5c736d),_0x52f661[_0x3ac99e(0x106)](0x1f4)[_0x3ac99e(0xeb)]({'Perror':_0x3ac99e(0xf1),'message':_0x5c736d['message']});}})[_0x25eab8(0x8e)](_0x481752=>{var _0x196162=_0x25eab8;console[_0x196162(0xfd)](_0x481752),_0x52f661[_0x196162(0x106)](0x1f4)[_0x196162(0xeb)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x43a176){_0x52f661[_0x25eab8(0xeb)](_0x43a176);}}catch(_0xf39138){console[_0x25eab8(0xfd)](_0xf39138),_0x52f661['status'](0x1f4)[_0x25eab8(0xeb)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0xf39138[_0x25eab8(0x14f)]});}})[_0x1ecb91(0x8e)](_0x3eed3a=>{var _0x48f6d0=_0x1ecb91;console['error'](_0x3eed3a),_0x52f661['status'](0x1f4)[_0x48f6d0(0xeb)]({'Merror':'An\x20error\x20occurred.'});});}catch(_0x8b276){console[_0x1ecb91(0xf6)](_0x8b276);}});function BayBinSelected(_0x52dad0,_0x56ddaa){var _0x557912=a0_0x43b53a,_0x380840=[],_0x14ffbb=[],_0x45c0fe=[],_0xbf1120=[],_0x40be97=[],_0x157444=[];let _0x2ae913=[];if(_0x52dad0=='DRY\x20STORAGE')switch(_0x56ddaa){case'Rack\x20A':_0x380840=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x14ffbb=[0x1,0x2],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=[_0x557912(0xdc),_0x557912(0xa8)],_0x40be97=['D'],_0x157444=['A'];break;case _0x557912(0xce):_0x380840=[0x6,0x5,0x4,0x3,0x2,0x1],_0x14ffbb=[0x1,0x2],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=[_0x557912(0xdc),_0x557912(0xa8)],_0x40be97=['D'],_0x157444=['B'];break;case _0x557912(0xf3):_0x380840=[0x0],_0x14ffbb=[0x0],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=['Floor'],_0x40be97=['D'],_0x157444=['S'];break;case _0x557912(0xe0):_0x380840=[0x0],_0x14ffbb=[0x0],_0xbf1120=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x45c0fe=[_0x557912(0xa8)],_0x40be97=['D'],_0x157444=['R'];break;}else{if(_0x52dad0==_0x557912(0x11a))switch(_0x56ddaa){case _0x557912(0x108):_0x380840=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x14ffbb=['B','F'],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=[_0x557912(0xdc),_0x557912(0xa8)],_0x40be97=['C'],_0x157444=['A'];break;case'Rack\x20B':_0x380840=[0x5,0x4,0x3,0x2,0x1],_0x14ffbb=['F','B','S'],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=['Level',_0x557912(0xa8)],_0x40be97=['C'],_0x157444=['B'];break;case _0x557912(0x162):_0x380840=[0x1,0x2,0x3,0x4,0x5],_0x14ffbb=['B','F','S'],_0xbf1120=[0x5,0x4,0x3,0x2,0x1],_0x45c0fe=[_0x557912(0xdc),_0x557912(0xa8)],_0x40be97=['C'],_0x157444=['C'];break;case'Rack\x20D':_0x380840=[0x5,0x4,0x3,0x2,0x1],_0x14ffbb=['F','B','S'],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=[_0x557912(0xdc),'Floor'],_0x40be97=['C'],_0x157444=['D'];break;case _0x557912(0x159):_0x380840=[0x4,0x3,0x2,0x1],_0x14ffbb=[0x1,0x2],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=[_0x557912(0xdc),_0x557912(0xa8)],_0x40be97=['C'],_0x157444=['E'];break;case'Rack\x20F':_0x380840=[0x1,0x2,0x3],_0x14ffbb=[0x1,0x2],_0xbf1120=[0x1,0x2,0x3,0x4,0x5],_0x45c0fe=[_0x557912(0xdc)],_0x40be97=['C'],_0x157444=['F'];break;}}return{'levels':_0x380840,'Isle':_0x14ffbb,'rack':_0xbf1120,'type':_0x45c0fe,'storage':_0x40be97,'rak':_0x157444};}router[a0_0x43b53a(0xc0)](a0_0x43b53a(0xda),auth,async(_0x2baa61,_0x4e698f)=>{var _0x3e1da0=a0_0x43b53a;try{const {username:_0x329f17,email:_0x3aac79,role:_0x40d3c0}=_0x2baa61[_0x3e1da0(0xab)],_0x50003b=_0x2baa61['user'],_0x26e0f6=await profile[_0x3e1da0(0xb9)]({'email':_0x50003b[_0x3e1da0(0xd5)]}),_0x2245a0=await master_shop[_0x3e1da0(0xba)](),_0x350713=await transfers[_0x3e1da0(0x127)](_0x2baa61[_0x3e1da0(0x117)]['id']);let _0x2ee1ae;if(_0x50003b[_0x3e1da0(0xaf)]==_0x3e1da0(0x167)){const _0x3aa17f=await staff[_0x3e1da0(0xb9)]({'email':_0x50003b[_0x3e1da0(0xd5)]});_0x2ee1ae=await warehouse[_0x3e1da0(0x97)]([{'$match':{'status':_0x3e1da0(0xa7),'name':_0x3aa17f[_0x3e1da0(0x135)],'warehouse_category':_0x3e1da0(0x9f)}},{'$group':{'_id':_0x3e1da0(0xb7),'name':{'$first':_0x3e1da0(0xb7)}}}]);}else _0x2ee1ae=await warehouse[_0x3e1da0(0x97)]([{'$match':{'status':_0x3e1da0(0xa7),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x3e1da0(0xb7)}}}]);const _0x4f7095=await warehouse[_0x3e1da0(0x97)]([{'$match':{'name':_0x350713[_0x3e1da0(0x90)],'warehouse_category':_0x3e1da0(0x9f)}},{'$unwind':_0x3e1da0(0xd8)},{'$group':{'_id':_0x3e1da0(0xd1),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3e1da0(0x144)},'bay':{'$first':_0x3e1da0(0xa1)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3e1da0(0xbb)},'floorlevel':{'$first':_0x3e1da0(0xc5)},'primary_code':{'$first':_0x3e1da0(0x173)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3e1da0(0x169)},'rack':{'$first':_0x3e1da0(0xb4)},'expiry_date':{'$first':_0x3e1da0(0x12c)},'production_date':{'$first':_0x3e1da0(0xdb)},'room':{'$first':_0x3e1da0(0x122)}}}]),_0x2c57c5=await product['find']({}),_0x103da2=BayBinSelected(_0x350713['to_warehouse'],_0x350713[_0x3e1da0(0xcc)]);if(_0x2245a0[0x0]['language']==_0x3e1da0(0xfb)){var _0x3b00dc=users[_0x3e1da0(0x103)];console['log'](_0x3b00dc);}else{if(_0x2245a0[0x0][_0x3e1da0(0xdf)]==_0x3e1da0(0xc9))var _0x3b00dc=users['Hindi'];else{if(_0x2245a0[0x0][_0x3e1da0(0xdf)]==_0x3e1da0(0xef))var _0x3b00dc=users[_0x3e1da0(0xef)];else{if(_0x2245a0[0x0][_0x3e1da0(0xdf)]==_0x3e1da0(0xca))var _0x3b00dc=users['Spanish'];else{if(_0x2245a0[0x0]['language']==_0x3e1da0(0xaa))var _0x3b00dc=users['French'];else{if(_0x2245a0[0x0]['language']==_0x3e1da0(0x116))var _0x3b00dc=users[_0x3e1da0(0x10a)];else{if(_0x2245a0[0x0][_0x3e1da0(0xdf)]==_0x3e1da0(0x148))var _0x3b00dc=users[_0x3e1da0(0x148)];else{if(_0x2245a0[0x0][_0x3e1da0(0xdf)]==_0x3e1da0(0x104))var _0x3b00dc=users[_0x3e1da0(0x143)];}}}}}}}_0x4e698f[_0x3e1da0(0xc3)](_0x3e1da0(0x13f),{'success':_0x2baa61[_0x3e1da0(0x163)](_0x3e1da0(0x92)),'errors':_0x2baa61[_0x3e1da0(0x163)](_0x3e1da0(0x10e)),'role':_0x50003b,'profile':_0x26e0f6,'master_shop':_0x2245a0,'warehouse':_0x2ee1ae,'transfer':_0x350713,'stock':_0x4f7095,'unit':_0x2c57c5,'language':_0x3b00dc});}catch(_0x5bfbca){console[_0x3e1da0(0xf6)](_0x5bfbca);}}),router[a0_0x43b53a(0x149)](a0_0x43b53a(0xda),auth,async(_0x35ab30,_0x1718d2)=>{var _0x45412d=a0_0x43b53a;try{const _0x20f5eb=_0x35ab30[_0x45412d(0x117)]['id'],_0x46e075=await transfers[_0x45412d(0x127)](_0x20f5eb);_0x1718d2[_0x45412d(0xeb)](_0x35ab30['body']);return;const {date:_0x56aeb4,from_warehouse:_0x14b137,FromRoom_name:_0x42c993,to_warehouse:_0x576f5f,ToRoom_name:_0x11ef70,prod_name:_0x1dfae0,from_prod_qty:_0x168cb9,from_prod_level:_0x5de604,from_prod_isle:_0x5ca40b,from_prod_pallet:_0x4b4006,to_prod_qty:_0x542a6b,to_prod_level:_0x3d8e79,to_prod_isle:_0x14c0ec,to_prod_pallet:_0x177bba,primary_code:_0xda6fee,secondary_code:_0xff6f3e,product_code3:_0x238994,note:_0x24cf7f,invoice:_0x31cc87,expiry_date:_0x3930dd}=_0x35ab30[_0x45412d(0xfa)];if(typeof _0x1dfae0==_0x45412d(0xe5))var _0x44be4b=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xb8)]],_0x85917e=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xf9)]],_0x52fafd=[_0x35ab30[_0x45412d(0xfa)]['from_prod_level']],_0x51161f=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x94)]],_0x2a48cd=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xa9)]],_0x2acf8f=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x118)]],_0x287af1=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xe1)]],_0x93b51f=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xad)]],_0x45db7a=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x176)]],_0x5160dd=[_0x35ab30['body']['to_prod_pallet']],_0x5f05e5=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x140)]],_0x3a1244=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xea)]],_0x5db854=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x124)]],_0x5f263c=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x12e)]],_0x259a99=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xff)]],_0x3c8f0e=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x9e)]],_0x2bd2ce=[_0x35ab30[_0x45412d(0xfa)]['MaxStocks_data2']],_0x263392=[_0x35ab30['body'][_0x45412d(0x131)]],_0x1df21d=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0xd4)]],_0x447411=[_0x35ab30[_0x45412d(0xfa)]['batch_code']],_0x5e66f4=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x113)]],_0x38158b=[_0x35ab30['body']['from_storage']],_0x484081=[_0x35ab30[_0x45412d(0xfa)][_0x45412d(0x125)]];else var _0x44be4b=[..._0x35ab30['body'][_0x45412d(0xb8)]],_0x3a1244=[..._0x35ab30[_0x45412d(0xfa)]['storage']],_0x5db854=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0x124)]],_0x2acf8f=[..._0x35ab30['body'][_0x45412d(0x118)]],_0x5f05e5=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0x140)]],_0x85917e=[..._0x35ab30['body'][_0x45412d(0xf9)]],_0x52fafd=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0x130)]],_0x51161f=[..._0x35ab30['body'][_0x45412d(0x94)]],_0x2a48cd=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0xa9)]],_0x287af1=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0xe1)]],_0x93b51f=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0xad)]],_0x45db7a=[..._0x35ab30[_0x45412d(0xfa)]['to_prod_isle']],_0x5160dd=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0x14e)]],_0x5f263c=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0x12e)]],_0x259a99=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0xff)]],_0x3c8f0e=[..._0x35ab30[_0x45412d(0xfa)]['product_code3']],_0x2bd2ce=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0xa5)]],_0x263392=[..._0x35ab30[_0x45412d(0xfa)]['unit']],_0x1df21d=[..._0x35ab30['body']['secondary_unit']],_0x447411=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0xec)]],_0x5e66f4=[..._0x35ab30[_0x45412d(0xfa)][_0x45412d(0x113)]],_0x38158b=[..._0x35ab30['body'][_0x45412d(0x14c)]],_0x484081=[..._0x35ab30[_0x45412d(0xfa)]['from_rak']];const _0x4b4cd4=_0x44be4b['map'](_0x512b94=>{return _0x512b94={'product_name':_0x512b94};});_0x85917e['forEach']((_0x1c14fd,_0x226c0a)=>{var _0x42133d=_0x45412d;_0x4b4cd4[_0x226c0a][_0x42133d(0x15a)]=_0x1c14fd;}),_0x52fafd[_0x45412d(0xe8)]((_0xb87ad8,_0x1dfbcf)=>{var _0x2cd2ca=_0x45412d;_0x4b4cd4[_0x1dfbcf][_0x2cd2ca(0x153)]=_0xb87ad8;}),_0x51161f['forEach']((_0x1002a1,_0x10c3f9)=>{var _0x5d981f=_0x45412d;_0x4b4cd4[_0x10c3f9][_0x5d981f(0xcb)]=_0x1002a1;}),_0x2a48cd[_0x45412d(0xe8)]((_0x4218fa,_0x7a90a6)=>{var _0x3422f8=_0x45412d;_0x4b4cd4[_0x7a90a6][_0x3422f8(0xa0)]=_0x4218fa;}),_0x287af1[_0x45412d(0xe8)]((_0x3f2874,_0x5a782a)=>{var _0x229f87=_0x45412d;_0x4b4cd4[_0x5a782a][_0x229f87(0x132)]=_0x3f2874;}),_0x93b51f[_0x45412d(0xe8)]((_0x3a3919,_0x30e47e)=>{var _0x4bd47d=_0x45412d;_0x4b4cd4[_0x30e47e][_0x4bd47d(0x142)]=_0x3a3919;}),_0x45db7a['forEach']((_0x775c01,_0x3287b8)=>{var _0xdda87a=_0x45412d;_0x4b4cd4[_0x3287b8][_0xdda87a(0xe3)]=_0x775c01;}),_0x5160dd[_0x45412d(0xe8)]((_0x3ea2eb,_0x12b0c6)=>{var _0x3e8988=_0x45412d;_0x4b4cd4[_0x12b0c6][_0x3e8988(0x91)]=_0x3ea2eb;}),_0x5f263c[_0x45412d(0xe8)]((_0x5a9691,_0xaabf14)=>{var _0x1c9e18=_0x45412d;_0x4b4cd4[_0xaabf14][_0x1c9e18(0x12e)]=_0x5a9691;}),_0x259a99['forEach']((_0x460701,_0x8eecf1)=>{_0x4b4cd4[_0x8eecf1]['secondary_code']=_0x460701;}),_0x3c8f0e[_0x45412d(0xe8)]((_0x1f053a,_0x1210af)=>{var _0x4c4094=_0x45412d;_0x4b4cd4[_0x1210af][_0x4c4094(0xd9)]=_0x1f053a;}),_0x2bd2ce['forEach']((_0x5780a2,_0x49aee7)=>{_0x4b4cd4[_0x49aee7]['maxProducts']=_0x5780a2;}),_0x263392[_0x45412d(0xe8)]((_0x51be30,_0x45c453)=>{_0x4b4cd4[_0x45c453]['unit']=_0x51be30;}),_0x1df21d[_0x45412d(0xe8)]((_0x212587,_0x2a1bfb)=>{var _0x459214=_0x45412d;_0x4b4cd4[_0x2a1bfb][_0x459214(0xd4)]=_0x212587;}),_0x447411[_0x45412d(0xe8)]((_0x5869c7,_0x4821e0)=>{var _0x44e42e=_0x45412d;_0x4b4cd4[_0x4821e0][_0x44e42e(0xec)]=_0x5869c7;}),_0x5e66f4[_0x45412d(0xe8)]((_0xfeef96,_0x55641c)=>{_0x4b4cd4[_0x55641c]['expiry_date']=_0xfeef96;}),_0x3a1244[_0x45412d(0xe8)]((_0xa501d7,_0x53045d)=>{var _0x47efd9=_0x45412d;_0x4b4cd4[_0x53045d][_0x47efd9(0xea)]=_0xa501d7;}),_0x5db854[_0x45412d(0xe8)]((_0xc98505,_0x4d1314)=>{var _0x4167cc=_0x45412d;_0x4b4cd4[_0x4d1314][_0x4167cc(0xb6)]=_0xc98505;}),_0x2acf8f['forEach']((_0x229526,_0x279e47)=>{var _0x25ffbf=_0x45412d;_0x4b4cd4[_0x279e47][_0x25ffbf(0x118)]=_0x229526;}),_0x5f05e5[_0x45412d(0xe8)]((_0x4edf8a,_0x8437f1)=>{var _0x3cb6f9=_0x45412d;_0x4b4cd4[_0x8437f1][_0x3cb6f9(0x140)]=_0x4edf8a;}),_0x38158b[_0x45412d(0xe8)]((_0x2e36bc,_0x1b18e4)=>{var _0x4c9be0=_0x45412d;_0x4b4cd4[_0x1b18e4][_0x4c9be0(0x14c)]=_0x2e36bc;}),_0x484081[_0x45412d(0xe8)]((_0x5cecd9,_0x149865)=>{var _0x119edd=_0x45412d;_0x4b4cd4[_0x149865][_0x119edd(0xd3)]=_0x5cecd9;});const _0x5221be=_0x4b4cd4['filter'](_0x16bd61=>_0x16bd61[_0x45412d(0x132)]!=='0'&&_0x16bd61[_0x45412d(0x132)]!==''||_0x16bd61['to_floorlevel']!=='0'&&_0x16bd61[_0x45412d(0x91)]!=='');var _0x324a2a=0x0;_0x5221be[_0x45412d(0xe8)](_0x2b402d=>{var _0x241ccb=_0x45412d;parseInt(_0x2b402d['from_quantity'])<parseInt(_0x2b402d[_0x241ccb(0x132)])&&_0x324a2a++;});if(_0x324a2a!=0x0)return _0x35ab30[_0x45412d(0x163)]('errors',_0x45412d(0x88)),_0x1718d2['redirect']('back');const _0x4404df=await warehouse[_0x45412d(0xb9)]({'name':_0x46e075[_0x45412d(0x90)],'room':_0x46e075[_0x45412d(0x11b)]});_0x46e075['product'][_0x45412d(0xe8)](_0xb7abac=>{var _0x5ef921=_0x45412d;if(_0xb7abac[_0x5ef921(0x132)]>0x0){const _0xa97bea=_0x4404df[_0x5ef921(0x138)][_0x5ef921(0xb1)](_0x3b97dd=>{var _0x52f3a9=_0x5ef921;_0x3b97dd[_0x52f3a9(0xc7)]==_0xb7abac[_0x52f3a9(0xc7)]&&_0x3b97dd[_0x52f3a9(0xac)]==_0xb7abac['from_floorlevel']&&_0x3b97dd['type']==_0xb7abac[_0x52f3a9(0x118)]&&_0x3b97dd[_0x52f3a9(0x10f)]==_0xb7abac[_0x52f3a9(0xcb)]&&_0x3b97dd[_0x52f3a9(0xd0)]==_0xb7abac[_0x52f3a9(0x153)]&&_0x3b97dd[_0x52f3a9(0xb6)]==_0xb7abac[_0x52f3a9(0xd3)]&&_0x3b97dd[_0x52f3a9(0xea)]==_0xb7abac[_0x52f3a9(0x14c)]&&(_0x3b97dd[_0x52f3a9(0xbe)]=parseInt(_0x3b97dd[_0x52f3a9(0xbe)])+parseInt(_0xb7abac[_0x52f3a9(0x132)]));});}}),await _0x4404df[_0x45412d(0x8b)]();const _0x2a19c4=await warehouse[_0x45412d(0xb9)]({'name':_0x46e075[_0x45412d(0x10b)],'room':_0x46e075[_0x45412d(0xcc)]});_0x46e075[_0x45412d(0x99)][_0x45412d(0xe8)](_0x37d605=>{var _0xf21cff=_0x45412d;if(_0x37d605[_0xf21cff(0x132)]>0x0){const _0x26c1c9=_0x2a19c4[_0xf21cff(0x138)]['map'](_0x54ba71=>{var _0x52d71b=_0xf21cff;_0x54ba71[_0x52d71b(0xc7)]==_0x37d605[_0x52d71b(0xc7)]&&_0x54ba71[_0x52d71b(0xac)]==_0x37d605[_0x52d71b(0x91)]&&_0x54ba71[_0x52d71b(0xdd)]==_0x37d605['to_types']&&_0x54ba71['bin']==_0x37d605['to_bin']&&_0x54ba71[_0x52d71b(0xd0)]==_0x37d605[_0x52d71b(0x142)]&&_0x54ba71[_0x52d71b(0xb6)]==_0x37d605[_0x52d71b(0xb6)]&&_0x54ba71[_0x52d71b(0xea)]==_0x37d605[_0x52d71b(0xea)]&&(_0x54ba71[_0x52d71b(0xbe)]=parseInt(_0x54ba71[_0x52d71b(0xbe)])-parseInt(_0x37d605[_0x52d71b(0x132)]));});}}),await _0x2a19c4['save'](),_0x46e075['date']=_0x56aeb4,_0x46e075[_0x45412d(0x90)]=_0x14b137,_0x46e075[_0x45412d(0x10b)]=_0x576f5f,_0x46e075[_0x45412d(0x99)]=_0x5221be,_0x46e075[_0x45412d(0xe2)]=_0x24cf7f,_0x46e075[_0x45412d(0x15b)]=_0x31cc87;const _0xd34ce2=await _0x46e075[_0x45412d(0x8b)]();console['log'](_0xd34ce2);const _0x2a098f=await warehouse[_0x45412d(0xb9)]({'name':_0x14b137,'room':_0x42c993});_0xd34ce2[_0x45412d(0x99)][_0x45412d(0xe8)](_0x5e644c=>{var _0x400e24=_0x45412d;if(_0x5e644c[_0x400e24(0x132)]>0x0){const _0x38c910=_0x2a098f[_0x400e24(0x138)][_0x400e24(0xb1)](_0x58de3c=>{var _0x3f2f2d=_0x400e24;_0x58de3c['product_name']==_0x5e644c[_0x3f2f2d(0xc7)]&&_0x58de3c['floorlevel']==_0x5e644c['from_floorlevel']&&_0x58de3c[_0x3f2f2d(0xdd)]==_0x5e644c[_0x3f2f2d(0x118)]&&_0x58de3c[_0x3f2f2d(0x10f)]==_0x5e644c[_0x3f2f2d(0xcb)]&&_0x58de3c[_0x3f2f2d(0xd0)]==_0x5e644c['from_bay']&&_0x58de3c[_0x3f2f2d(0xb6)]==_0x5e644c[_0x3f2f2d(0xd3)]&&_0x58de3c[_0x3f2f2d(0xea)]==_0x5e644c[_0x3f2f2d(0x14c)]&&(_0x58de3c[_0x3f2f2d(0xbe)]=parseInt(_0x58de3c[_0x3f2f2d(0xbe)])-parseInt(_0x5e644c[_0x3f2f2d(0x132)]));});}}),await _0x2a098f[_0x45412d(0x8b)]();const _0x35476d=await warehouse[_0x45412d(0xb9)]({'name':_0x576f5f,'room':_0x11ef70});_0xd34ce2[_0x45412d(0x99)]['forEach'](_0x3479a3=>{var _0x2a522f=_0x45412d;if(_0x3479a3[_0x2a522f(0x132)]>0x0){var _0x3ba4a0=0x0;const _0x27ddd5=_0x35476d[_0x2a522f(0x138)][_0x2a522f(0xb1)](_0x10e7e1=>{var _0x3db55e=_0x2a522f;_0x10e7e1['product_name']==_0x3479a3[_0x3db55e(0xc7)]&&_0x10e7e1[_0x3db55e(0xac)]==_0x3479a3[_0x3db55e(0x91)]&&_0x10e7e1[_0x3db55e(0xdd)]==_0x3479a3[_0x3db55e(0x140)]&&_0x10e7e1[_0x3db55e(0x10f)]==_0x3479a3[_0x3db55e(0xe3)]&&_0x10e7e1[_0x3db55e(0xd0)]==_0x3479a3['to_bay']&&_0x10e7e1[_0x3db55e(0xb6)]==_0x3479a3[_0x3db55e(0xb6)]&&_0x10e7e1[_0x3db55e(0xea)]==_0x3479a3['storage']&&(_0x10e7e1['product_stock']=parseInt(_0x10e7e1[_0x3db55e(0xbe)])+parseInt(_0x3479a3[_0x3db55e(0x132)]),_0x3ba4a0++);});_0x3ba4a0=='0'&&(_0x35476d[_0x2a522f(0x138)]=_0x35476d['product_details'][_0x2a522f(0xbd)]({'product_name':_0x3479a3[_0x2a522f(0xc7)],'product_stock':_0x3479a3[_0x2a522f(0x132)],'bay':_0x3479a3['to_bay'],'bin':_0x3479a3[_0x2a522f(0xe3)],'type':_0x3479a3[_0x2a522f(0x140)],'floorlevel':_0x3479a3[_0x2a522f(0x91)],'storage':_0x3479a3[_0x2a522f(0xea)],'rack':_0x3479a3[_0x2a522f(0xb6)],'product_code':_0x3479a3[_0x2a522f(0xd9)],'primary_code':_0x3479a3[_0x2a522f(0x12e)],'secondary_code':_0x3479a3[_0x2a522f(0xff)],'maxProducts':_0x3479a3['maxProducts'],'storage':_0x3479a3[_0x2a522f(0xea)],'rack':_0x3479a3[_0x2a522f(0xb6)]}));}}),await _0x35476d[_0x45412d(0x8b)](),_0x35ab30[_0x45412d(0x163)](_0x45412d(0x92),_0x45412d(0x110)),_0x1718d2[_0x45412d(0x136)](_0x45412d(0x8d));}catch(_0xb153a4){console['log'](_0xb153a4);}}),router[a0_0x43b53a(0x149)]('/barcode_scanner',async(_0x1f2867,_0x5e3118)=>{var _0x5cac67=a0_0x43b53a;const {FromWareHouse:_0x6e00e5,FromRoom:_0x49aec1,ToWarehouse:_0x47be9e,ToRoom:_0x13921,primary_code:_0x3175c0,Roomslist:_0x319878}=_0x1f2867[_0x5cac67(0xfa)],_0x4cd0ea=_0x319878[_0x5cac67(0x14a)](','),_0x54e4d3=[];async function _0x5098bc(_0xd38cd4){var _0x3aea27=_0x5cac67;const _0x3a5374=await warehouse['aggregate']([{'$match':{'name':_0x6e00e5,'room':_0xd38cd4}},{'$unwind':_0x3aea27(0xd8)},{'$match':{'product_details.primary_code':_0x3175c0}},{'$group':{'_id':_0x3aea27(0xd1),'name':{'$first':_0x3aea27(0x146)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x3aea27(0x173)},'secondary_code':{'$first':_0x3aea27(0xb5)},'product_code':{'$first':_0x3aea27(0x13d)},'level':{'$first':_0x3aea27(0xa1)},'isle':{'$first':_0x3aea27(0x11c)},'type':{'$first':_0x3aea27(0xbb)},'pallet':{'$first':_0x3aea27(0xc5)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3aea27(0x16e)},'storage':{'$first':_0x3aea27(0x169)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3aea27(0x12c)},'production_date':{'$first':_0x3aea27(0xdb)},'batch_code':{'$first':_0x3aea27(0xa3)},'maxPerUnit':{'$first':_0x3aea27(0xf8)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x3aea27(0x122)},'maxProducts':{'$first':_0x3aea27(0x114)}}}]),_0x4f401d=await warehouse[_0x3aea27(0x97)]([{'$match':{'name':_0x6e00e5,'room':_0xd38cd4}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3175c0}},{'$group':{'_id':_0x3aea27(0xd1),'name':{'$first':_0x3aea27(0x146)},'instock':{'$first':_0x3aea27(0x144)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3aea27(0xb5)},'product_code':{'$first':_0x3aea27(0x13d)},'level':{'$first':_0x3aea27(0xa1)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3aea27(0xbb)},'pallet':{'$first':_0x3aea27(0xc5)},'unit':{'$first':_0x3aea27(0x15f)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3aea27(0x169)},'rack':{'$first':_0x3aea27(0xb4)},'expiry_date':{'$first':_0x3aea27(0x12c)},'production_date':{'$first':_0x3aea27(0xdb)},'batch_code':{'$first':_0x3aea27(0xa3)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x3aea27(0x122)},'maxProducts':{'$first':_0x3aea27(0x114)}}}]);if(_0x3a5374[_0x3aea27(0x133)]>0x0)_0x54e4d3[_0x3aea27(0x87)](_0x3a5374);else _0x4f401d['length']>0x0&&_0x54e4d3[_0x3aea27(0x87)](_0x4f401d);}const _0x1107c5=_0x4cd0ea[_0x5cac67(0xb1)](_0x5d18b5=>_0x5098bc(_0x5d18b5));await Promise['all'](_0x1107c5),_0x5e3118[_0x5cac67(0xeb)](_0x54e4d3);}),router['post'](a0_0x43b53a(0x112),async(_0x1ceff9,_0x3db0f1)=>{var _0x4918c7=a0_0x43b53a;try{const {FromWareHouse:_0x25cde3,FromRoom:_0x5695fd,ToWarehouse:_0x2f2315,ToRoom:_0x1e2c3b,secondary_code:_0x5802d6}=_0x1ceff9[_0x4918c7(0xfa)],_0x5af527=await warehouse[_0x4918c7(0x97)]([{'$match':{'name':_0x25cde3}},{'$unwind':_0x4918c7(0xd8)},{'$match':{'product_details.secondary_code':_0x5802d6}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4918c7(0x146)},'primary_code':{'$first':_0x4918c7(0x173)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4918c7(0x13d)},'instock':{'$first':_0x4918c7(0x144)},'warehouse':{'$first':'$name'},'level':{'$first':_0x4918c7(0x150)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x4918c7(0x121)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x4918c7(0x15f)}}}]);_0x3db0f1[_0x4918c7(0x106)](0xc8)[_0x4918c7(0xeb)](_0x5af527);}catch(_0x32ef48){_0x3db0f1[_0x4918c7(0x106)](0x194)[_0x4918c7(0xeb)]({'message':_0x32ef48[_0x4918c7(0x14f)]});}}),router[a0_0x43b53a(0x149)](a0_0x43b53a(0x170),async(_0x2ff66a,_0x482cc6)=>{var _0x2d5da1=a0_0x43b53a;try{const {FromWareHouse:_0x481d59,FromRoom:_0x23a23b,ToWarehouse:_0x50c39f,ToRoom:_0x5d9295,product_code:_0x4cba12}=_0x2ff66a['body'],_0x382df5=await warehouse['aggregate']([{'$match':{'name':_0x481d59}},{'$unwind':_0x2d5da1(0xd8)},{'$match':{'product_details.product_code':_0x4cba12}},{'$group':{'_id':_0x2d5da1(0xd1),'name':{'$first':_0x2d5da1(0x146)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2d5da1(0xb5)},'product_code':{'$first':_0x2d5da1(0x13d)},'instock':{'$first':_0x2d5da1(0x144)},'warehouse':{'$first':'$name'},'level':{'$first':_0x2d5da1(0x150)},'isle':{'$first':_0x2d5da1(0x15e)},'pallet':{'$first':_0x2d5da1(0x121)},'maxProducts':{'$first':_0x2d5da1(0x114)},'unit':{'$first':'$product_details.unit'}}}]);_0x482cc6['status'](0xc8)[_0x2d5da1(0xeb)](_0x382df5);}catch(_0x2b7206){_0x482cc6['status'](0x194)['json']({'message':_0x2b7206[_0x2d5da1(0x14f)]});}}),router[a0_0x43b53a(0x149)](a0_0x43b53a(0xf5),async(_0x553a73,_0x4364c9)=>{var _0x3b2258=a0_0x43b53a;const {level:_0x378c6e,isle:_0x45e965,pallet:_0x4b4be8,warehouses:_0x26900a,room:_0x279c97}=_0x553a73[_0x3b2258(0xfa)];try{const _0x3d2d70=await warehouse['aggregate']([{'$match':{'name':_0x26900a,'room':_0x279c97}},{'$unwind':_0x3b2258(0xd8)},{'$match':{'product_details.level':parseInt(_0x378c6e),'product_details.isle':_0x45e965,'product_details.pallet':parseInt(_0x4b4be8)}},{'$group':{'_id':_0x3b2258(0xd1),'name':{'$first':_0x3b2258(0x146)},'product_stock':{'$first':_0x3b2258(0x144)},'level':{'$first':_0x3b2258(0x150)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x3b2258(0x114)}}}]);_0x4364c9[_0x3b2258(0x106)](0xc8)[_0x3b2258(0xeb)](_0x3d2d70);}catch(_0xb1a33f){_0x4364c9[_0x3b2258(0x106)](0x194)[_0x3b2258(0xeb)]({'message':_0xb1a33f['message']});}}),module[a0_0x43b53a(0x129)]=router;