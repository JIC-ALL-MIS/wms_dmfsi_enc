var a0_0x2048ee=a0_0x37a3;function a0_0x5330(){var _0x665378=['Logo.png','<table\x20style=\x22width:\x20100%\x20!important;\x22>','to_bay','$invoice','from_rack','maxperunit','from_bay','TRF-','/CheckingWarehouse','English','Rack\x20A','Rack\x20E','master','3884vhARzD','findOne','13700Hxnduk','New_Qty_Converted','<h5>','staff','secondary_code','</head><body>','/picking_list/PDF_transfer_rm/','storage','status','1731UcTcUy','_id','from_prod_qty','expiry_date','An\x20error\x20occurred.','to_room_name','push','$product_details.production_date','prod_name','$product_details.product_stock','log','/../public','type','$to_warehouse','updateOne','primary_unit','90580QFlDoh','from_storage','bin','split','from_warehouse','$_id','to_prod_qty','$product_details.expiry_date','MaxStocks_data2','$product_details.level','from_invoice','to_prod_level','floor','French','product_code3','<h5\x20style=\x22text-align:\x20left;\x22>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','role','aggregate','to_prod_isle','from_quantity','22046068VYMdCI','random','Floor','to_bin','/view/:id','Portuguese','248EfPyhq','edit_transfer_view','message','from_floorlevel','$product_details.floorlevel','length','sendMail','</table>','string','Return\x20Rooms','Router','An\x20error\x20occurred\x20while\x20saving\x20data.','product_name','<span\x20style=\x22float:\x20right;\x22>','filter','COLD\x20STORAGE','from_prod_level','Chinese','findById','render','bay','toString','Raw\x20Materials','Arabic','/transfer/preview/','getMonth','unit','$finalize','email','3948702EvjbCV','invoice','from_room','secondary_unit','errors','prod_cat','Level','Arabic\x20(ae)','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/barcode_scanner3','German','$product_details.pallet','Rack\x20C','max_per_unit','Shelves','floorlevel','finalize','Ambient','exports','Receiving\x20Area','from_room_name','$product_details.bin','</div>','$product_details.batch_code','\x20Order\x20Number\x20:\x20','/barcode_scanner','from_rak','Spanish','to_invoice','body','<html><head><title></title>','password','createTransport','flash','redirect','nodemailer','Rack\x20B','Error\x20Occurs','$product_details.product_name','$product.from_room_name','primary_code','$product_details.maxProducts','English\x20(US)','$product_details','107950stqHWh','forEach','$product_details.product_code','all','239218dSjdgR','site_title','To_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$date','</tr>','product_code','save','date','Transfer\x20Edit\x20Successfully','note','$product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','to_quantity','$room','map','$product_details.secondary_code','../public/language/languages.json','$product_details._id','/preview/:id','$product_details.unit','RMSEmail','ToRoomAssigned','$product_details.rack','image','json','express','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','transfer','/transfer/view','padStart','$product_details.primary_code','Rack\x20D','../models/all_models','RoomAssigned','rack','$name','maxProducts','product_details','to_room','catch','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','to_floorlevel','$product.to_room_name','from_prod_pallet','find','from_prod_isle','rak','product_stock','Enabled','post','to_prod_pallet','concat','from_bin','$product_details.storage','$product_details.maxPerUnit','warehouse','to_warehouse','from_types','$product_details.bay','Enclosed','$product_details.isle','Rack\x20F','language','Hindi','get','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Email\x20sent\x20successfully','user','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','</h5>','slice','Portuguese\x20(BR)','</td>','to_types','$from_warehouse','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.secondary_unit','success','<tbody\x20style=\x22text-align:\x20center;\x22>','then','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.type','Transfer\x20Finalize\x20Successfully','112nPAnOj','<div>','</thead>','243fOlSLo','product','params'];a0_0x5330=function(){return _0x665378;};return a0_0x5330();}(function(_0x2b0632,_0x4bf075){var _0x50a0f1=a0_0x37a3,_0x97f8b=_0x2b0632();while(!![]){try{var _0x148c57=parseInt(_0x50a0f1(0x121))/0x1+-parseInt(_0x50a0f1(0x11f))/0x2*(-parseInt(_0x50a0f1(0x12a))/0x3)+-parseInt(_0x50a0f1(0x155))/0x4*(parseInt(_0x50a0f1(0x19f))/0x5)+-parseInt(_0x50a0f1(0x172))/0x6+-parseInt(_0x50a0f1(0x1a3))/0x7*(parseInt(_0x50a0f1(0x1f8))/0x8)+-parseInt(_0x50a0f1(0x1fb))/0x9*(-parseInt(_0x50a0f1(0x13a))/0xa)+parseInt(_0x50a0f1(0x14f))/0xb;if(_0x148c57===_0x4bf075)break;else _0x97f8b['push'](_0x97f8b['shift']());}catch(_0x11d7ee){_0x97f8b['push'](_0x97f8b['shift']());}}}(a0_0x5330,0xdda4f));const express=require(a0_0x2048ee(0x1bd)),app=express(),router=express[a0_0x2048ee(0x15f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x2048ee(0x1c4)),auth=require('../middleware/auth'),users=require(a0_0x2048ee(0x1b4)),nodemailer=require(a0_0x2048ee(0x196));router[a0_0x2048ee(0x1e5)]('/view',auth,async(_0x11ef2e,_0x2f291e)=>{var _0x4e1976=a0_0x2048ee;try{const {username:_0x1e507a,email:_0x13a4ec,role:_0x199acb}=_0x11ef2e[_0x4e1976(0x1e8)],_0x3a0df8=_0x11ef2e[_0x4e1976(0x1e8)],_0x7d6aa=await profile[_0x4e1976(0x120)]({'email':_0x3a0df8['email']}),_0x1a8a0b=await master_shop['find']();console['log'](_0x4e1976(0x11e),_0x1a8a0b);let _0x2edaca;if(_0x3a0df8[_0x4e1976(0x14b)]==_0x4e1976(0x124)){const _0x527069=await staff['findOne']({'email':_0x3a0df8[_0x4e1976(0x171)]});_0x2edaca=await transfers[_0x4e1976(0x1d1)]({'from_warehouse':_0x527069['warehouse']});}else _0x2edaca=await transfers[_0x4e1976(0x14c)]([{'$unwind':_0x4e1976(0x1ae)},{'$group':{'_id':_0x4e1976(0x13f),'invoice':{'$first':_0x4e1976(0x201)},'date':{'$first':_0x4e1976(0x1a7)},'from_warehouse':{'$first':_0x4e1976(0x1ef)},'to_warehouse':{'$first':_0x4e1976(0x137)},'from_room_name':{'$addToSet':_0x4e1976(0x19a)},'to_room_name':{'$addToSet':_0x4e1976(0x1cf)},'finalize':{'$first':_0x4e1976(0x170)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1a8a0b[0x0][_0x4e1976(0x1e3)]=='English\x20(US)'){var _0x528fff=users[_0x4e1976(0x207)];console[_0x4e1976(0x134)](_0x528fff);}else{if(_0x1a8a0b[0x0][_0x4e1976(0x1e3)]=='Hindi')var _0x528fff=users[_0x4e1976(0x1e4)];else{if(_0x1a8a0b[0x0]['language']==_0x4e1976(0x17d))var _0x528fff=users['German'];else{if(_0x1a8a0b[0x0][_0x4e1976(0x1e3)]==_0x4e1976(0x18e))var _0x528fff=users['Spanish'];else{if(_0x1a8a0b[0x0][_0x4e1976(0x1e3)]==_0x4e1976(0x147))var _0x528fff=users[_0x4e1976(0x147)];else{if(_0x1a8a0b[0x0][_0x4e1976(0x1e3)]==_0x4e1976(0x1ec))var _0x528fff=users[_0x4e1976(0x154)];else{if(_0x1a8a0b[0x0]['language']==_0x4e1976(0x166))var _0x528fff=users['Chinese'];else{if(_0x1a8a0b[0x0]['language']==_0x4e1976(0x179))var _0x528fff=users[_0x4e1976(0x16c)];}}}}}}}_0x2f291e[_0x4e1976(0x168)](_0x4e1976(0x1bf),{'success':_0x11ef2e[_0x4e1976(0x194)]('success'),'errors':_0x11ef2e[_0x4e1976(0x194)](_0x4e1976(0x176)),'role':_0x3a0df8,'profile':_0x7d6aa,'master_shop':_0x1a8a0b,'transfer':_0x2edaca,'language':_0x528fff});}catch(_0x1e3d8b){console[_0x4e1976(0x134)](_0x1e3d8b);}});async function getRandom8DigitNumber(){var _0x469627=a0_0x2048ee;const _0x4757b9=0x989680,_0x348f06=0x5f5e0ff,_0x12e931=Math[_0x469627(0x146)](Math[_0x469627(0x150)]()*(_0x348f06-_0x4757b9+0x1))+_0x4757b9;var _0xf40b5c;const _0x8a8c55=await transfers['findOne']({'invoice':_0x469627(0x205)+_0x12e931});return _0x8a8c55&&_0x8a8c55[_0x469627(0x15a)]>0x0?_0xf40b5c=_0x469627(0x205)+_0x12e931:_0xf40b5c=_0x469627(0x205)+_0x12e931,_0xf40b5c;}router['get']('/view/add_transfer',auth,async(_0x179297,_0x44bd98)=>{var _0x5b0cb2=a0_0x2048ee;try{const {username:_0x12bf6f,email:_0x37fd76,role:_0x2f2d57}=_0x179297[_0x5b0cb2(0x1e8)],_0x506824=_0x179297[_0x5b0cb2(0x1e8)],_0xf79e03=await profile['findOne']({'email':_0x506824['email']}),_0x6253f2=await master_shop[_0x5b0cb2(0x1d1)]();console[_0x5b0cb2(0x134)](_0x5b0cb2(0x11e),_0x6253f2);let _0x6a3df8;if(_0x506824[_0x5b0cb2(0x14b)]==_0x5b0cb2(0x124)){const _0x362d31=await staff[_0x5b0cb2(0x120)]({'email':_0x506824[_0x5b0cb2(0x171)]});_0x6a3df8=await warehouse[_0x5b0cb2(0x14c)]([{'$match':{'status':_0x5b0cb2(0x1d5),'name':_0x362d31[_0x5b0cb2(0x1dc)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x5b0cb2(0x1c7),'name':{'$first':_0x5b0cb2(0x1c7)}}}]);}else _0x6a3df8=await warehouse['aggregate']([{'$match':{'status':_0x5b0cb2(0x1d5),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x5b0cb2(0x1c7),'name':{'$first':_0x5b0cb2(0x1c7)}}}]);var _0x3ed2c3=[_0x5b0cb2(0x184),_0x5b0cb2(0x1e0),_0x5b0cb2(0x15e)];const _0x4d9e14=await transfers['find']({}),_0x12e5b7=_0x4d9e14['length']+0x1,_0x39e1b=_0x5b0cb2(0x205)+_0x12e5b7[_0x5b0cb2(0x16a)]()[_0x5b0cb2(0x1c1)](0x5,'0');if(_0x6253f2[0x0][_0x5b0cb2(0x1e3)]=='English\x20(US)'){var _0x172cb0=users[_0x5b0cb2(0x207)];console[_0x5b0cb2(0x134)](_0x172cb0);}else{if(_0x6253f2[0x0][_0x5b0cb2(0x1e3)]=='Hindi')var _0x172cb0=users['Hindi'];else{if(_0x6253f2[0x0][_0x5b0cb2(0x1e3)]==_0x5b0cb2(0x17d))var _0x172cb0=users[_0x5b0cb2(0x17d)];else{if(_0x6253f2[0x0]['language']==_0x5b0cb2(0x18e))var _0x172cb0=users[_0x5b0cb2(0x18e)];else{if(_0x6253f2[0x0][_0x5b0cb2(0x1e3)]==_0x5b0cb2(0x147))var _0x172cb0=users[_0x5b0cb2(0x147)];else{if(_0x6253f2[0x0][_0x5b0cb2(0x1e3)]==_0x5b0cb2(0x1ec))var _0x172cb0=users['Portuguese'];else{if(_0x6253f2[0x0][_0x5b0cb2(0x1e3)]==_0x5b0cb2(0x166))var _0x172cb0=users[_0x5b0cb2(0x166)];else{if(_0x6253f2[0x0][_0x5b0cb2(0x1e3)]=='Arabic\x20(ae)')var _0x172cb0=users['Arabic'];}}}}}}}const _0x15cfc6=getRandom8DigitNumber();_0x15cfc6[_0x5b0cb2(0x1f4)](_0x3d0547=>{var _0x1970c0=_0x5b0cb2;_0x44bd98[_0x1970c0(0x168)]('add_transfer',{'success':_0x179297[_0x1970c0(0x194)](_0x1970c0(0x1f2)),'errors':_0x179297[_0x1970c0(0x194)](_0x1970c0(0x176)),'role':_0x506824,'profile':_0xf79e03,'master_shop':_0x6253f2,'warehouse':_0x6a3df8,'language':_0x172cb0,'rooms_data':_0x3ed2c3,'invoice':_0x3d0547});})['catch'](_0x231548=>{var _0x481656=_0x5b0cb2;_0x179297[_0x481656(0x194)](_0x481656(0x176),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x44bd98[_0x481656(0x195)](_0x481656(0x1c0));});}catch(_0x39ae98){console['log'](_0x39ae98);}}),router['post']('/view/add_transfer',auth,async(_0x139e3e,_0x5c3183)=>{var _0x458d04=a0_0x2048ee;try{console[_0x458d04(0x134)](_0x139e3e[_0x458d04(0x190)]);const {date:_0x380fba,from_warehouse:_0x246571,FromRoom_name:_0x45f463,to_warehouse:_0x4ffb36,ToRoom_name:_0x2bfd02,prod_name:_0x4a842a,from_prod_qty:_0x3812aa,from_prod_level:_0x39dc4e,from_prod_isle:_0x202ee8,from_prod_pallet:_0x4f8e1f,to_prod_qty:_0x11eb99,to_prod_level:_0x3c9302,to_prod_isle:_0x1b432b,to_prod_pallet:_0x5a9f9d,primary_code:_0x11a503,secondary_code:_0x384cc6,product_code3:_0x5a250d,note:_0x111164,MaxStocks_data2:_0x4db08d,invoice:_0x3ee45b,expiry_date:_0x19e60b}=_0x139e3e[_0x458d04(0x190)];if(typeof _0x4a842a==_0x458d04(0x15d))var _0x54377a=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x132)]],_0xabfea7=[_0x139e3e['body'][_0x458d04(0x12c)]],_0x224068=[_0x139e3e['body']['from_prod_level']],_0x29c186=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x122)]],_0x2fb172=[_0x139e3e[_0x458d04(0x190)]['to_prod_level']],_0x175583=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x19b)]],_0x5d51ac=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x125)]],_0x55af8b=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x148)]],_0x591c90=[_0x139e3e['body'][_0x458d04(0x142)]],_0x2095b5=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x139)]],_0x555def=[_0x139e3e[_0x458d04(0x190)]['secondary_unit']],_0x4f458a=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x17a)]],_0x3d9a9a=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x12d)]],_0x304102=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x180)]],_0x2c9b73=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x1cc)]],_0x1eff57=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x177)]],_0x117ae0=[_0x139e3e['body'][_0x458d04(0x1c5)]],_0x1cfe9d=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x1b9)]],_0x4662ca=[_0x139e3e[_0x458d04(0x190)]['from_invoice']],_0xed26c3=[_0x139e3e[_0x458d04(0x190)][_0x458d04(0x18f)]];else var _0x54377a=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x132)]],_0xabfea7=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x12c)]],_0x224068=[..._0x139e3e[_0x458d04(0x190)]['from_prod_level']],_0x29c186=[..._0x139e3e['body'][_0x458d04(0x122)]],_0x2fb172=[..._0x139e3e['body'][_0x458d04(0x145)]],_0x175583=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x19b)]],_0x5d51ac=[..._0x139e3e['body']['secondary_code']],_0x55af8b=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x148)]],_0x591c90=[..._0x139e3e['body'][_0x458d04(0x142)]],_0x2095b5=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x139)]],_0x555def=[..._0x139e3e[_0x458d04(0x190)]['secondary_unit']],_0x4f458a=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x17a)]],_0x3d9a9a=[..._0x139e3e[_0x458d04(0x190)]['expiry_date']],_0x304102=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x180)]],_0x2c9b73=[..._0x139e3e['body']['production_date']],_0x1eff57=[..._0x139e3e['body']['prod_cat']],_0x117ae0=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x1c5)]],_0x1cfe9d=[..._0x139e3e[_0x458d04(0x190)]['ToRoomAssigned']],_0x4662ca=[..._0x139e3e[_0x458d04(0x190)][_0x458d04(0x144)]],_0xed26c3=[..._0x139e3e[_0x458d04(0x190)]['to_invoice']];const _0x55b075=_0x54377a[_0x458d04(0x1b2)](_0x18a51c=>{return _0x18a51c={'product_name':_0x18a51c};});_0xabfea7[_0x458d04(0x1a0)]((_0x2807b0,_0x1b9ebb)=>{var _0x54bdb0=_0x458d04;_0x55b075[_0x1b9ebb][_0x54bdb0(0x14e)]=_0x2807b0;}),_0x4662ca[_0x458d04(0x1a0)]((_0x5c73cf,_0x156e7b)=>{_0x55b075[_0x156e7b]['from_invoice']=_0x5c73cf;}),_0xed26c3[_0x458d04(0x1a0)]((_0x8e62fa,_0x240e34)=>{_0x55b075[_0x240e34]['To_invoice']=_0x8e62fa;}),_0x224068['forEach']((_0x47d6cc,_0x10dfde)=>{var _0x4ab1ef=_0x458d04;_0x117ae0[_0x4ab1ef(0x1a0)]((_0x32f7e7,_0x364dec)=>{var _0x53d98a=_0x4ab1ef;if(_0x32f7e7==_0x53d98a(0x186)&&_0x10dfde==_0x364dec){var _0x1ad2e4=_0x47d6cc[_0x53d98a(0x1eb)](0x3);_0x55b075[_0x10dfde][_0x53d98a(0x13b)]=_0x47d6cc[0x0],_0x55b075[_0x10dfde][_0x53d98a(0x202)]=_0x47d6cc[0x1],_0x55b075[_0x10dfde]['from_bay']=0x0,_0x55b075[_0x10dfde]['from_bin']=0x0,_0x55b075[_0x10dfde][_0x53d98a(0x1de)]=_0x53d98a(0x151),_0x55b075[_0x10dfde][_0x53d98a(0x158)]=_0x1ad2e4;}else{if(_0x32f7e7==_0x53d98a(0x181)&&_0x10dfde==_0x364dec){var _0x1ad2e4=_0x47d6cc[_0x53d98a(0x1eb)](0x3);_0x55b075[_0x10dfde]['from_storage']=_0x47d6cc[0x0],_0x55b075[_0x10dfde]['from_rack']=_0x47d6cc[0x1],_0x55b075[_0x10dfde][_0x53d98a(0x204)]=0x0,_0x55b075[_0x10dfde][_0x53d98a(0x1d9)]=0x0,_0x55b075[_0x10dfde][_0x53d98a(0x1de)]=_0x53d98a(0x151),_0x55b075[_0x10dfde][_0x53d98a(0x158)]=_0x47d6cc[0x5];}else{if(_0x10dfde==_0x364dec){var _0x1520a0;if(_0x47d6cc[0x4]=='L')_0x1520a0=_0x53d98a(0x178);else _0x47d6cc[0x4]=='F'&&(_0x1520a0=_0x53d98a(0x151));_0x55b075[_0x10dfde]['from_storage']=_0x47d6cc[0x0],_0x55b075[_0x10dfde][_0x53d98a(0x202)]=_0x47d6cc[0x1],_0x55b075[_0x10dfde]['from_bay']=_0x47d6cc[0x2],_0x55b075[_0x10dfde]['from_bin']=_0x47d6cc[0x3],_0x55b075[_0x10dfde][_0x53d98a(0x1de)]=_0x1520a0,_0x55b075[_0x10dfde]['from_floorlevel']=_0x47d6cc[0x5];}}}});}),_0x29c186[_0x458d04(0x1a0)]((_0xb60525,_0x229ce2)=>{var _0xfa7cce=_0x458d04;_0x55b075[_0x229ce2][_0xfa7cce(0x1b0)]=_0xb60525;}),_0x2fb172[_0x458d04(0x1a0)]((_0x1a11e8,_0x16b1b8)=>{_0x1cfe9d['forEach']((_0x26ef25,_0x284bfe)=>{var _0x4f4fa9=a0_0x37a3;if(_0x26ef25==_0x4f4fa9(0x186)&&_0x16b1b8==_0x284bfe){var _0x14766b=_0x1a11e8[_0x4f4fa9(0x1eb)](0x3);_0x55b075[_0x16b1b8][_0x4f4fa9(0x128)]=_0x1a11e8[0x0],_0x55b075[_0x16b1b8]['rack']=_0x1a11e8[0x1],_0x55b075[_0x16b1b8]['to_bay']=0x0,_0x55b075[_0x16b1b8][_0x4f4fa9(0x152)]=0x0,_0x55b075[_0x16b1b8][_0x4f4fa9(0x1ee)]='Floor',_0x55b075[_0x16b1b8][_0x4f4fa9(0x1ce)]=_0x14766b;}else{if(_0x26ef25=='Shelves'&&_0x16b1b8==_0x284bfe){var _0x14766b=_0x1a11e8[_0x4f4fa9(0x1eb)](0x3);_0x55b075[_0x16b1b8][_0x4f4fa9(0x128)]=_0x1a11e8[0x0],_0x55b075[_0x16b1b8]['rack']=_0x1a11e8[0x1],_0x55b075[_0x16b1b8][_0x4f4fa9(0x200)]=0x0,_0x55b075[_0x16b1b8][_0x4f4fa9(0x152)]=0x0,_0x55b075[_0x16b1b8]['to_types']=_0x4f4fa9(0x151),_0x55b075[_0x16b1b8]['to_floorlevel']=_0x1a11e8[0x5];}else{if(_0x16b1b8==_0x284bfe){var _0x12bac3;if(_0x1a11e8[0x4]=='L')_0x12bac3=_0x4f4fa9(0x178);else _0x1a11e8[0x4]=='F'&&(_0x12bac3=_0x4f4fa9(0x151));_0x55b075[_0x16b1b8][_0x4f4fa9(0x128)]=_0x1a11e8[0x0],_0x55b075[_0x16b1b8][_0x4f4fa9(0x1c6)]=_0x1a11e8[0x1],_0x55b075[_0x16b1b8][_0x4f4fa9(0x200)]=_0x1a11e8[0x2],_0x55b075[_0x16b1b8]['to_bin']=_0x1a11e8[0x3],_0x55b075[_0x16b1b8]['to_types']=_0x12bac3,_0x55b075[_0x16b1b8]['to_floorlevel']=_0x1a11e8[0x5];}}}});}),_0x175583[_0x458d04(0x1a0)]((_0x24ee8e,_0x28af31)=>{var _0x4d2500=_0x458d04;_0x55b075[_0x28af31][_0x4d2500(0x19b)]=_0x24ee8e;}),_0x5d51ac[_0x458d04(0x1a0)]((_0x1630ad,_0x55a29f)=>{var _0x5e33e6=_0x458d04;_0x55b075[_0x55a29f][_0x5e33e6(0x125)]=_0x1630ad;}),_0x55af8b[_0x458d04(0x1a0)]((_0x5be758,_0x1e0e19)=>{var _0x1536a1=_0x458d04;_0x55b075[_0x1e0e19][_0x1536a1(0x1a9)]=_0x5be758;}),_0x591c90[_0x458d04(0x1a0)]((_0x19e726,_0x1c0dc5)=>{var _0x2c4925=_0x458d04;_0x55b075[_0x1c0dc5][_0x2c4925(0x1c8)]=_0x19e726;}),_0x2095b5[_0x458d04(0x1a0)]((_0x4806f2,_0x1703ff)=>{var _0xc866c3=_0x458d04;_0x55b075[_0x1703ff][_0xc866c3(0x16f)]=_0x4806f2;}),_0x555def[_0x458d04(0x1a0)]((_0x4e9293,_0x1af89b)=>{var _0x3f9f64=_0x458d04;_0x55b075[_0x1af89b][_0x3f9f64(0x175)]=_0x4e9293;}),_0x4f458a[_0x458d04(0x1a0)]((_0x3e041c,_0x1dfd47)=>{var _0x47ef3a=_0x458d04;_0x55b075[_0x1dfd47][_0x47ef3a(0x17a)]=_0x3e041c;}),_0x3d9a9a[_0x458d04(0x1a0)]((_0x20eec7,_0xa37235)=>{_0x55b075[_0xa37235]['expiry_date']=_0x20eec7;}),_0x304102[_0x458d04(0x1a0)]((_0x44d531,_0x2fcff6)=>{var _0x52d5a9=_0x458d04;_0x55b075[_0x2fcff6][_0x52d5a9(0x203)]=_0x44d531;}),_0x2c9b73[_0x458d04(0x1a0)]((_0x3ed971,_0x1a920f)=>{var _0x454103=_0x458d04;_0x55b075[_0x1a920f][_0x454103(0x1cc)]=_0x3ed971;}),_0x1eff57[_0x458d04(0x1a0)]((_0x52ec37,_0x5395ed)=>{var _0x226078=_0x458d04;_0x55b075[_0x5395ed][_0x226078(0x177)]=_0x52ec37;}),_0x117ae0[_0x458d04(0x1a0)]((_0x54f361,_0x5bba1f)=>{_0x55b075[_0x5bba1f]['from_room_name']=_0x54f361;}),_0x1cfe9d[_0x458d04(0x1a0)]((_0x45e345,_0xfd696c)=>{_0x55b075[_0xfd696c]['to_room_name']=_0x45e345;});const _0x262390=_0x55b075[_0x458d04(0x163)](_0x758f59=>_0x758f59[_0x458d04(0x1b0)]!=='0'&&_0x758f59[_0x458d04(0x1b0)]!==''||_0x758f59['to_floorlevel']!=='0'&&_0x758f59[_0x458d04(0x1ce)]!==''),_0x208c78=new transfers({'date':_0x380fba,'from_warehouse':_0x246571,'to_warehouse':_0x4ffb36,'product':_0x262390,'note':_0x111164,'invoice':_0x3ee45b}),_0x3231e8=await _0x208c78[_0x458d04(0x1aa)]();_0x139e3e[_0x458d04(0x194)]('success','Product\x20Transfer\x20successfully'),_0x5c3183[_0x458d04(0x195)](_0x458d04(0x16d)+_0x3231e8['_id']);}catch(_0x45600a){console[_0x458d04(0x134)](_0x45600a),_0x5c3183['status'](0xc8)[_0x458d04(0x1bc)]({'errorMessage':_0x45600a[_0x458d04(0x157)]});}}),router[a0_0x2048ee(0x1e5)](a0_0x2048ee(0x1b6),auth,async(_0x4eb477,_0x15060d)=>{var _0xbff409=a0_0x2048ee;try{const {username:_0x213c9d,email:_0x59e98e,role:_0x4925cf}=_0x4eb477['user'],_0x49ba68=_0x4eb477[_0xbff409(0x1e8)],_0xa59874=await profile[_0xbff409(0x120)]({'email':_0x49ba68[_0xbff409(0x171)]}),_0x59e4b9=await master_shop[_0xbff409(0x1d1)]();console[_0xbff409(0x134)](_0xbff409(0x11e),_0x59e4b9);const _0x22e111=await transfers[_0xbff409(0x167)](_0x4eb477['params']['id']);let _0x3584b8=new Date(_0x22e111['expiry_date']),_0x56c2ef=('0'+_0x3584b8['getDate']())[_0xbff409(0x1eb)](-0x2),_0x2c03b6=('0'+(_0x3584b8[_0xbff409(0x16e)]()+0x1))[_0xbff409(0x1eb)](-0x2),_0x4ef68f=_0x3584b8['getFullYear'](),_0x34790a=_0x4ef68f+'-'+_0x2c03b6+'-'+_0x56c2ef,_0x1ac484;if(_0x49ba68[_0xbff409(0x14b)]==_0xbff409(0x124)){const _0x12e3ef=await staff[_0xbff409(0x120)]({'email':_0x49ba68[_0xbff409(0x171)]});_0x1ac484=await warehouse[_0xbff409(0x1d1)]({'status':_0xbff409(0x1d5),'name':_0x12e3ef['warehouse'],'warehouse_category':_0xbff409(0x16b)});}else _0x1ac484=await warehouse[_0xbff409(0x1d1)]({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0x27c01f=await warehouse[_0xbff409(0x14c)]([{'$match':{'name':_0x22e111[_0xbff409(0x13e)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0xbff409(0x1b5),'name':{'$first':_0xbff409(0x199)},'product_stock':{'$first':_0xbff409(0x133)},'bay':{'$first':_0xbff409(0x1df)},'bin':{'$first':_0xbff409(0x188)},'type':{'$first':_0xbff409(0x1f6)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xbff409(0x1c2)},'secondary_code':{'$first':_0xbff409(0x1b3)},'product_code':{'$first':_0xbff409(0x1a1)},'storage':{'$first':_0xbff409(0x1da)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xbff409(0x141)},'production_date':{'$first':_0xbff409(0x131)},'room':{'$first':_0xbff409(0x1b1)}}}]);if(_0x59e4b9[0x0][_0xbff409(0x1e3)]=='English\x20(US)'){var _0xaac78d=users['English'];console[_0xbff409(0x134)](_0xaac78d);}else{if(_0x59e4b9[0x0][_0xbff409(0x1e3)]==_0xbff409(0x1e4))var _0xaac78d=users['Hindi'];else{if(_0x59e4b9[0x0]['language']=='German')var _0xaac78d=users[_0xbff409(0x17d)];else{if(_0x59e4b9[0x0][_0xbff409(0x1e3)]=='Spanish')var _0xaac78d=users[_0xbff409(0x18e)];else{if(_0x59e4b9[0x0][_0xbff409(0x1e3)]==_0xbff409(0x147))var _0xaac78d=users[_0xbff409(0x147)];else{if(_0x59e4b9[0x0][_0xbff409(0x1e3)]==_0xbff409(0x1ec))var _0xaac78d=users['Portuguese'];else{if(_0x59e4b9[0x0][_0xbff409(0x1e3)]==_0xbff409(0x166))var _0xaac78d=users[_0xbff409(0x166)];else{if(_0x59e4b9[0x0][_0xbff409(0x1e3)]==_0xbff409(0x179))var _0xaac78d=users[_0xbff409(0x16c)];}}}}}}}_0x15060d[_0xbff409(0x168)](_0xbff409(0x156),{'success':_0x4eb477[_0xbff409(0x194)](_0xbff409(0x1f2)),'errors':_0x4eb477[_0xbff409(0x194)](_0xbff409(0x176)),'role':_0x49ba68,'profile':_0xa59874,'master_shop':_0x59e4b9,'warehouse':_0x1ac484,'transfer':_0x22e111,'stock':_0x27c01f,'language':_0xaac78d});}catch(_0x560668){console[_0xbff409(0x134)](_0x560668);}}),router[a0_0x2048ee(0x1d6)](a0_0x2048ee(0x1b6),auth,async(_0x236f4d,_0x630568)=>{var _0x5549f2=a0_0x2048ee;try{const _0x3584ca=_0x236f4d[_0x5549f2(0x1fd)]['id'],{from_warehouse:_0xf2e750,FromRoom_name:_0x246e00,to_warehouse:_0xc690e3,ToRoom_name:_0x4da5ac}=_0x236f4d[_0x5549f2(0x190)],_0x4279b5=await transfers[_0x5549f2(0x167)]({'_id':_0x3584ca}),_0x224795=_0x4279b5[_0x5549f2(0x1fc)]['map'](async _0x579f21=>{var _0x42bd21=_0x5549f2;if(_0x579f21[_0x42bd21(0x1b0)]>0x0){var _0x41f208=await warehouse[_0x42bd21(0x120)]({'name':_0x4279b5[_0x42bd21(0x13e)],'room':_0x579f21[_0x42bd21(0x187)],'warehouse_category':'Raw\x20Materials'});const _0x54d278=_0x41f208[_0x42bd21(0x1c9)]['map'](_0x922622=>{var _0x289149=_0x42bd21;_0x922622[_0x289149(0x161)]==_0x579f21[_0x289149(0x161)]&&_0x922622[_0x289149(0x182)]==_0x579f21[_0x289149(0x158)]&&_0x922622[_0x289149(0x136)]==_0x579f21['from_types']&&_0x922622[_0x289149(0x13c)]==_0x579f21[_0x289149(0x1d9)]&&_0x922622[_0x289149(0x169)]==_0x579f21[_0x289149(0x204)]&&_0x922622['rack']==_0x579f21[_0x289149(0x202)]&&_0x922622[_0x289149(0x128)]==_0x579f21['from_storage']&&_0x922622[_0x289149(0x12d)]==_0x579f21['expiry_date']&&_0x922622[_0x289149(0x17a)]==_0x579f21[_0x289149(0x17a)]&&_0x922622[_0x289149(0x1cc)]==_0x579f21['production_date']&&_0x922622[_0x289149(0x173)]==_0x579f21[_0x289149(0x144)]&&(_0x922622[_0x289149(0x1d4)]=_0x922622[_0x289149(0x1d4)]-_0x579f21[_0x289149(0x1b0)]);});}return _0x41f208;});Promise[_0x5549f2(0x1a2)](_0x224795)[_0x5549f2(0x1f4)](async _0x3320b7=>{var _0x20f33a=_0x5549f2;try{for(const _0x482c67 of _0x3320b7){await _0x482c67[_0x20f33a(0x1aa)]();}try{const _0x3fa8fd=_0x4279b5['product']['map'](async _0x48947a=>{var _0x4bc0f4=_0x20f33a;if(_0x48947a[_0x4bc0f4(0x1b0)]>0x0){var _0x4336ae=await warehouse[_0x4bc0f4(0x120)]({'name':_0x4279b5['to_warehouse'],'room':_0x48947a[_0x4bc0f4(0x12f)],'warehouse_category':_0x4bc0f4(0x16b)}),_0x51f671=0x0;const _0xd2bfab=_0x4336ae[_0x4bc0f4(0x1c9)]['map'](_0x419efb=>{var _0x2c03d6=_0x4bc0f4;_0x419efb[_0x2c03d6(0x161)]==_0x48947a['product_name']&&_0x419efb[_0x2c03d6(0x182)]==_0x48947a[_0x2c03d6(0x1ce)]&&_0x419efb[_0x2c03d6(0x136)]==_0x48947a[_0x2c03d6(0x1ee)]&&_0x419efb[_0x2c03d6(0x13c)]==_0x48947a[_0x2c03d6(0x152)]&&_0x419efb[_0x2c03d6(0x169)]==_0x48947a[_0x2c03d6(0x200)]&&_0x419efb[_0x2c03d6(0x1c6)]==_0x48947a['rack']&&_0x419efb[_0x2c03d6(0x128)]==_0x48947a['storage']&&_0x419efb[_0x2c03d6(0x12d)]==_0x48947a['expiry_date']&&_0x419efb['batch_code']==_0x48947a['batch_code']&&_0x419efb[_0x2c03d6(0x1cc)]==_0x48947a[_0x2c03d6(0x1cc)]&&_0x419efb[_0x2c03d6(0x173)]==_0x48947a[_0x2c03d6(0x1a5)]&&(_0x419efb[_0x2c03d6(0x1d4)]=_0x419efb[_0x2c03d6(0x1d4)]+_0x48947a[_0x2c03d6(0x1b0)],_0x51f671++);});_0x51f671=='0'&&(_0x4336ae[_0x4bc0f4(0x1c9)]=_0x4336ae['product_details'][_0x4bc0f4(0x1d8)]({'product_name':_0x48947a[_0x4bc0f4(0x161)],'product_stock':_0x48947a[_0x4bc0f4(0x1b0)],'bay':_0x48947a[_0x4bc0f4(0x200)],'bin':_0x48947a[_0x4bc0f4(0x152)],'type':_0x48947a[_0x4bc0f4(0x1ee)],'floorlevel':_0x48947a['to_floorlevel'],'storage':_0x48947a['storage'],'rack':_0x48947a[_0x4bc0f4(0x1c6)],'product_code':_0x48947a['product_code'],'primary_code':_0x48947a['primary_code'],'secondary_code':_0x48947a['secondary_code'],'maxProducts':_0x48947a[_0x4bc0f4(0x1c8)],'storage':_0x48947a[_0x4bc0f4(0x128)],'rack':_0x48947a[_0x4bc0f4(0x1c6)],'expiry_date':_0x48947a[_0x4bc0f4(0x12d)],'maxPerUnit':_0x48947a[_0x4bc0f4(0x203)],'batch_code':_0x48947a['batch_code'],'production_date':_0x48947a[_0x4bc0f4(0x1cc)]}));}return _0x4336ae;});Promise[_0x20f33a(0x1a2)](_0x3fa8fd)[_0x20f33a(0x1f4)](async _0x290940=>{var _0xcb75f6=_0x20f33a;try{for(const _0x36e71f of _0x290940){await warehouse[_0xcb75f6(0x138)]({'_id':_0x36e71f[_0xcb75f6(0x12b)]},{'$addToSet':{'product_details':{'$each':_0x36e71f[_0xcb75f6(0x1c9)]}}});}_0x4279b5[_0xcb75f6(0x183)]='True';const _0x3f7d17=await _0x4279b5[_0xcb75f6(0x1aa)](),_0x24ed6c=await master_shop[_0xcb75f6(0x1d1)](),_0x241288=await email_settings[_0xcb75f6(0x120)](),_0x2a577f=await supervisor_settings[_0xcb75f6(0x1d1)]();var _0xf64db=_0x4279b5[_0xcb75f6(0x1fc)],_0x4af35b='',_0xeb23d8;for(_0xeb23d8 in _0xf64db){_0x4af35b+='<tr>'+_0xcb75f6(0x1f0)+_0xf64db[_0xeb23d8][_0xcb75f6(0x161)]+'</td>'+_0xcb75f6(0x1f0)+_0xf64db[_0xeb23d8][_0xcb75f6(0x1a9)]+_0xcb75f6(0x1ed)+_0xcb75f6(0x1f0)+_0xf64db[_0xeb23d8][_0xcb75f6(0x1b0)]+_0xcb75f6(0x1ed)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xf64db[_0xeb23d8][_0xcb75f6(0x16f)]+_0xcb75f6(0x1ed)+_0xcb75f6(0x1f0)+_0xf64db[_0xeb23d8]['secondary_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4279b5[_0xcb75f6(0x1dd)]+_0xcb75f6(0x1ed)+_0xcb75f6(0x1f0)+_0xf64db[_0xeb23d8]['to_room_name']+_0xcb75f6(0x1ed)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xf64db[_0xeb23d8][_0xcb75f6(0x128)]+_0xf64db[_0xeb23d8]['rack']+_0xf64db[_0xeb23d8]['to_bay']+_0xf64db[_0xeb23d8][_0xcb75f6(0x152)]+_0xf64db[_0xeb23d8][_0xcb75f6(0x1ee)][0x0]+_0xf64db[_0xeb23d8][_0xcb75f6(0x1ce)]+_0xcb75f6(0x1ed),_0xcb75f6(0x1a8);}let _0x178912=nodemailer[_0xcb75f6(0x193)]({'host':_0x241288['host'],'port':Number(_0x241288['port']),'secure':![],'auth':{'user':_0x241288[_0xcb75f6(0x171)],'pass':_0x241288[_0xcb75f6(0x192)]}}),_0x5afe1a={'from':_0x241288[_0xcb75f6(0x171)],'to':_0x2a577f[0x0][_0xcb75f6(0x1b8)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0xcb75f6(0x1fe),'path':__dirname+_0xcb75f6(0x135)+'/upload/'+_0x24ed6c[0x0][_0xcb75f6(0x1bb)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0xcb75f6(0x191)+_0xcb75f6(0x126)+'<div>'+_0xcb75f6(0x1e6)+_0xcb75f6(0x1f9)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0xcb75f6(0x189)+_0xcb75f6(0x1f9)+'<h2>\x20'+_0x24ed6c[0x0][_0xcb75f6(0x1a4)]+'\x20</h2>'+'</div>'+_0xcb75f6(0x189)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0xcb75f6(0x149)+_0xcb75f6(0x18b)+_0x4279b5[_0xcb75f6(0x173)]+'\x20'+_0xcb75f6(0x162)+'\x20Order\x20Date\x20:\x20'+_0x4279b5['date']+'\x20'+'</span>'+_0xcb75f6(0x1ea)+_0xcb75f6(0x189)+_0xcb75f6(0x1ff)+_0xcb75f6(0x14a)+'<tr>'+_0xcb75f6(0x1e9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0xcb75f6(0x1be)+_0xcb75f6(0x1cd)+_0xcb75f6(0x1f5)+_0xcb75f6(0x17b)+_0xcb75f6(0x1af)+_0xcb75f6(0x1a6)+_0xcb75f6(0x1a8)+_0xcb75f6(0x1fa)+_0xcb75f6(0x1f3)+'\x20'+_0x4af35b+'\x20'+'</tbody>'+_0xcb75f6(0x15c)+_0xcb75f6(0x1f9)+'<strong>\x20Regards\x20</strong>'+_0xcb75f6(0x123)+_0x24ed6c[0x0][_0xcb75f6(0x1a4)]+'</h5>'+_0xcb75f6(0x189)+_0xcb75f6(0x189)+'</body></html>'};_0x178912[_0xcb75f6(0x15b)](_0x5afe1a,function(_0x3c3b65,_0x57ac28){var _0x1f8807=_0xcb75f6;_0x3c3b65?(console[_0x1f8807(0x134)](_0x3c3b65),console[_0x1f8807(0x134)](_0x1f8807(0x198))):console['log'](_0x1f8807(0x1e7));}),_0x236f4d[_0xcb75f6(0x194)](_0xcb75f6(0x1f2),_0xcb75f6(0x1f7)),_0x630568[_0xcb75f6(0x195)](_0xcb75f6(0x127)+_0x3f7d17[_0xcb75f6(0x12b)]);}catch(_0xcd5968){console['error'](_0xcd5968),_0x630568[_0xcb75f6(0x129)](0x1f4)[_0xcb75f6(0x1bc)]({'Perror':_0xcb75f6(0x160),'message':_0xcd5968['message']});}})[_0x20f33a(0x1cb)](_0x1988cd=>{var _0x2c306a=_0x20f33a;console['error'](_0x1988cd),_0x630568['status'](0x1f4)[_0x2c306a(0x1bc)]({'Perror':_0x2c306a(0x12e)});});}catch(_0x57ccaa){_0x630568['json'](_0x57ccaa);}}catch(_0x241e5e){console['error'](_0x241e5e),_0x630568['status'](0x1f4)[_0x20f33a(0x1bc)]({'Merror':_0x20f33a(0x160),'Message':_0x241e5e['message']});}})[_0x5549f2(0x1cb)](_0x5ed6c6=>{var _0x24e33a=_0x5549f2;console['error'](_0x5ed6c6),_0x630568[_0x24e33a(0x129)](0x1f4)['json']({'Merror':'An\x20error\x20occurred.'});});}catch(_0x5171bd){console[_0x5549f2(0x134)](_0x5171bd);}});function a0_0x37a3(_0x191e24,_0x27cb33){var _0x533034=a0_0x5330();return a0_0x37a3=function(_0x37a303,_0x468824){_0x37a303=_0x37a303-0x11e;var _0xe7de5b=_0x533034[_0x37a303];return _0xe7de5b;},a0_0x37a3(_0x191e24,_0x27cb33);}function BayBinSelected(_0xbee154,_0x5307d5){var _0x50c78c=a0_0x2048ee,_0x258261=[],_0x4edc71=[],_0x4cd7f7=[],_0x44eb3b=[],_0x6ed475=[],_0x255a6b=[];let _0x21757d=[];if(_0xbee154=='DRY\x20STORAGE')switch(_0x5307d5){case'Rack\x20A':_0x258261=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4edc71=[0x1,0x2],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x178),'Floor'],_0x6ed475=['D'],_0x255a6b=['A'];break;case _0x50c78c(0x197):_0x258261=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4edc71=[0x1,0x2],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x178),_0x50c78c(0x151)],_0x6ed475=['D'],_0x255a6b=['B'];break;case _0x50c78c(0x181):_0x258261=[0x0],_0x4edc71=[0x0],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x151)],_0x6ed475=['D'],_0x255a6b=['S'];break;case _0x50c78c(0x186):_0x258261=[0x0],_0x4edc71=[0x0],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x4cd7f7=[_0x50c78c(0x151)],_0x6ed475=['D'],_0x255a6b=['R'];break;}else{if(_0xbee154==_0x50c78c(0x164))switch(_0x5307d5){case _0x50c78c(0x208):_0x258261=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4edc71=['B','F'],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x178),'Floor'],_0x6ed475=['C'],_0x255a6b=['A'];break;case _0x50c78c(0x197):_0x258261=[0x5,0x4,0x3,0x2,0x1],_0x4edc71=['F','B','S'],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x178),_0x50c78c(0x151)],_0x6ed475=['C'],_0x255a6b=['B'];break;case _0x50c78c(0x17f):_0x258261=[0x1,0x2,0x3,0x4,0x5],_0x4edc71=['B','F','S'],_0x44eb3b=[0x5,0x4,0x3,0x2,0x1],_0x4cd7f7=[_0x50c78c(0x178),_0x50c78c(0x151)],_0x6ed475=['C'],_0x255a6b=['C'];break;case _0x50c78c(0x1c3):_0x258261=[0x5,0x4,0x3,0x2,0x1],_0x4edc71=['F','B','S'],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x178),_0x50c78c(0x151)],_0x6ed475=['C'],_0x255a6b=['D'];break;case _0x50c78c(0x209):_0x258261=[0x4,0x3,0x2,0x1],_0x4edc71=[0x1,0x2],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x178),_0x50c78c(0x151)],_0x6ed475=['C'],_0x255a6b=['E'];break;case _0x50c78c(0x1e2):_0x258261=[0x1,0x2,0x3],_0x4edc71=[0x1,0x2],_0x44eb3b=[0x1,0x2,0x3,0x4,0x5],_0x4cd7f7=[_0x50c78c(0x178)],_0x6ed475=['C'],_0x255a6b=['F'];break;}}return{'levels':_0x258261,'Isle':_0x4edc71,'rack':_0x44eb3b,'type':_0x4cd7f7,'storage':_0x6ed475,'rak':_0x255a6b};}router[a0_0x2048ee(0x1e5)](a0_0x2048ee(0x153),auth,async(_0x3287a7,_0x26e31e)=>{var _0x419871=a0_0x2048ee;try{const {username:_0x5badbc,email:_0x272303,role:_0x2895b5}=_0x3287a7[_0x419871(0x1e8)],_0x36dee8=_0x3287a7[_0x419871(0x1e8)],_0x16c3ae=await profile[_0x419871(0x120)]({'email':_0x36dee8[_0x419871(0x171)]}),_0x465b24=await master_shop[_0x419871(0x1d1)](),_0x54bbc9=await transfers[_0x419871(0x167)](_0x3287a7['params']['id']);let _0x5caf75;if(_0x36dee8[_0x419871(0x14b)]==_0x419871(0x124)){const _0x55b468=await staff[_0x419871(0x120)]({'email':_0x36dee8[_0x419871(0x171)]});_0x5caf75=await warehouse[_0x419871(0x14c)]([{'$match':{'status':'Enabled','name':_0x55b468[_0x419871(0x1dc)],'warehouse_category':_0x419871(0x16b)}},{'$group':{'_id':_0x419871(0x1c7),'name':{'$first':'$name'}}}]);}else _0x5caf75=await warehouse[_0x419871(0x14c)]([{'$match':{'status':_0x419871(0x1d5),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x419871(0x1c7),'name':{'$first':_0x419871(0x1c7)}}}]);const _0x1f5f84=await warehouse['aggregate']([{'$match':{'name':_0x54bbc9['from_warehouse'],'warehouse_category':_0x419871(0x16b)}},{'$unwind':_0x419871(0x19e)},{'$group':{'_id':_0x419871(0x1b5),'name':{'$first':_0x419871(0x199)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x419871(0x1df)},'bin':{'$first':_0x419871(0x188)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x419871(0x159)},'primary_code':{'$first':_0x419871(0x1c2)},'secondary_code':{'$first':_0x419871(0x1b3)},'product_code':{'$first':_0x419871(0x1a1)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x419871(0x1ba)},'expiry_date':{'$first':_0x419871(0x141)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0x541549=await product[_0x419871(0x1d1)]({}),_0x5b1bef=BayBinSelected(_0x54bbc9[_0x419871(0x1dd)],_0x54bbc9[_0x419871(0x1ca)]);if(_0x465b24[0x0]['language']==_0x419871(0x19d)){var _0x4c6e82=users[_0x419871(0x207)];console[_0x419871(0x134)](_0x4c6e82);}else{if(_0x465b24[0x0][_0x419871(0x1e3)]==_0x419871(0x1e4))var _0x4c6e82=users[_0x419871(0x1e4)];else{if(_0x465b24[0x0][_0x419871(0x1e3)]==_0x419871(0x17d))var _0x4c6e82=users['German'];else{if(_0x465b24[0x0][_0x419871(0x1e3)]==_0x419871(0x18e))var _0x4c6e82=users[_0x419871(0x18e)];else{if(_0x465b24[0x0]['language']==_0x419871(0x147))var _0x4c6e82=users[_0x419871(0x147)];else{if(_0x465b24[0x0][_0x419871(0x1e3)]==_0x419871(0x1ec))var _0x4c6e82=users[_0x419871(0x154)];else{if(_0x465b24[0x0][_0x419871(0x1e3)]==_0x419871(0x166))var _0x4c6e82=users[_0x419871(0x166)];else{if(_0x465b24[0x0]['language']=='Arabic\x20(ae)')var _0x4c6e82=users['Arabic'];}}}}}}}_0x26e31e['render']('edit_transfer',{'success':_0x3287a7['flash']('success'),'errors':_0x3287a7[_0x419871(0x194)](_0x419871(0x176)),'role':_0x36dee8,'profile':_0x16c3ae,'master_shop':_0x465b24,'warehouse':_0x5caf75,'transfer':_0x54bbc9,'stock':_0x1f5f84,'unit':_0x541549,'language':_0x4c6e82});}catch(_0x1734bf){console[_0x419871(0x134)](_0x1734bf);}}),router[a0_0x2048ee(0x1d6)](a0_0x2048ee(0x153),auth,async(_0x20a745,_0x476a6f)=>{var _0x9bf1b2=a0_0x2048ee;try{const _0x4e40b5=_0x20a745['params']['id'],_0x4ae468=await transfers[_0x9bf1b2(0x167)](_0x4e40b5);_0x476a6f[_0x9bf1b2(0x1bc)](_0x20a745['body']);return;const {date:_0x3befa3,from_warehouse:_0x31f5fa,FromRoom_name:_0x1f6524,to_warehouse:_0x4b8297,ToRoom_name:_0x101e37,prod_name:_0x52fffa,from_prod_qty:_0x53784a,from_prod_level:_0x5da72c,from_prod_isle:_0x482d19,from_prod_pallet:_0x357030,to_prod_qty:_0x2606cf,to_prod_level:_0x599bdd,to_prod_isle:_0x30d72d,to_prod_pallet:_0x23ad5c,primary_code:_0x40c7b7,secondary_code:_0x304955,product_code3:_0x2c7b9a,note:_0x32d2aa,invoice:_0x49b046,expiry_date:_0x3561be}=_0x20a745['body'];if(typeof _0x52fffa==_0x9bf1b2(0x15d))var _0x582ff9=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x132)]],_0x3fab47=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x12c)]],_0x3742d1=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x165)]],_0x47df12=[_0x20a745['body'][_0x9bf1b2(0x1d2)]],_0x2588ca=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x1d0)]],_0xa4e791=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x1de)]],_0x268f9b=[_0x20a745[_0x9bf1b2(0x190)]['to_prod_qty']],_0xad6c70=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x145)]],_0x1e4d9e=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x14d)]],_0x53353b=[_0x20a745['body']['to_prod_pallet']],_0x25cc13=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x1ee)]],_0x544350=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x128)]],_0x4bd5fa=[_0x20a745[_0x9bf1b2(0x190)]['rak']],_0x7d2dca=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x19b)]],_0x11c939=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x125)]],_0xec0a02=[_0x20a745['body'][_0x9bf1b2(0x148)]],_0x10963b=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x142)]],_0x4f6b0a=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x16f)]],_0x73f1d8=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x175)]],_0x369e42=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x17a)]],_0x35178d=[_0x20a745[_0x9bf1b2(0x190)]['expiry_date']],_0x1cab0b=[_0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x13b)]],_0x4f2c02=[_0x20a745['body'][_0x9bf1b2(0x18d)]];else var _0x582ff9=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x132)]],_0x544350=[..._0x20a745['body'][_0x9bf1b2(0x128)]],_0x4bd5fa=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x1d3)]],_0xa4e791=[..._0x20a745['body'][_0x9bf1b2(0x1de)]],_0x25cc13=[..._0x20a745['body']['to_types']],_0x3fab47=[..._0x20a745[_0x9bf1b2(0x190)]['from_prod_qty']],_0x3742d1=[..._0x20a745['body'][_0x9bf1b2(0x165)]],_0x47df12=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x1d2)]],_0x2588ca=[..._0x20a745[_0x9bf1b2(0x190)]['from_prod_pallet']],_0x268f9b=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x140)]],_0xad6c70=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x145)]],_0x1e4d9e=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x14d)]],_0x53353b=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x1d7)]],_0x7d2dca=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x19b)]],_0x11c939=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x125)]],_0xec0a02=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x148)]],_0x10963b=[..._0x20a745['body']['MaxStocks_data2']],_0x4f6b0a=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x16f)]],_0x73f1d8=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x175)]],_0x369e42=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x17a)]],_0x35178d=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x12d)]],_0x1cab0b=[..._0x20a745[_0x9bf1b2(0x190)][_0x9bf1b2(0x13b)]],_0x4f2c02=[..._0x20a745[_0x9bf1b2(0x190)]['from_rak']];const _0x59bcb1=_0x582ff9[_0x9bf1b2(0x1b2)](_0x2cc7b2=>{return _0x2cc7b2={'product_name':_0x2cc7b2};});_0x3fab47['forEach']((_0x35b5ab,_0x428583)=>{_0x59bcb1[_0x428583]['from_quantity']=_0x35b5ab;}),_0x3742d1[_0x9bf1b2(0x1a0)]((_0x195830,_0x5fc611)=>{_0x59bcb1[_0x5fc611]['from_bay']=_0x195830;}),_0x47df12[_0x9bf1b2(0x1a0)]((_0x5d8ad8,_0x468beb)=>{var _0x44986f=_0x9bf1b2;_0x59bcb1[_0x468beb][_0x44986f(0x1d9)]=_0x5d8ad8;}),_0x2588ca['forEach']((_0x258215,_0xa04817)=>{var _0x4fa018=_0x9bf1b2;_0x59bcb1[_0xa04817][_0x4fa018(0x158)]=_0x258215;}),_0x268f9b[_0x9bf1b2(0x1a0)]((_0x3baa1e,_0x2bfc74)=>{var _0x1012f3=_0x9bf1b2;_0x59bcb1[_0x2bfc74][_0x1012f3(0x1b0)]=_0x3baa1e;}),_0xad6c70[_0x9bf1b2(0x1a0)]((_0x39022d,_0x28142d)=>{var _0x487e60=_0x9bf1b2;_0x59bcb1[_0x28142d][_0x487e60(0x200)]=_0x39022d;}),_0x1e4d9e[_0x9bf1b2(0x1a0)]((_0x1eab95,_0x2926e0)=>{var _0x39ba4d=_0x9bf1b2;_0x59bcb1[_0x2926e0][_0x39ba4d(0x152)]=_0x1eab95;}),_0x53353b['forEach']((_0x400a44,_0x3d57f5)=>{var _0x21a7df=_0x9bf1b2;_0x59bcb1[_0x3d57f5][_0x21a7df(0x1ce)]=_0x400a44;}),_0x7d2dca[_0x9bf1b2(0x1a0)]((_0x2297d6,_0x61faeb)=>{_0x59bcb1[_0x61faeb]['primary_code']=_0x2297d6;}),_0x11c939['forEach']((_0x34816e,_0x1ffcb7)=>{_0x59bcb1[_0x1ffcb7]['secondary_code']=_0x34816e;}),_0xec0a02[_0x9bf1b2(0x1a0)]((_0x381672,_0x350a44)=>{var _0x4b7a86=_0x9bf1b2;_0x59bcb1[_0x350a44][_0x4b7a86(0x1a9)]=_0x381672;}),_0x10963b[_0x9bf1b2(0x1a0)]((_0x12a791,_0x2ad552)=>{var _0x5862c9=_0x9bf1b2;_0x59bcb1[_0x2ad552][_0x5862c9(0x1c8)]=_0x12a791;}),_0x4f6b0a['forEach']((_0x146866,_0xffb80)=>{var _0xd36c24=_0x9bf1b2;_0x59bcb1[_0xffb80][_0xd36c24(0x16f)]=_0x146866;}),_0x73f1d8['forEach']((_0x14a48d,_0x29b167)=>{_0x59bcb1[_0x29b167]['secondary_unit']=_0x14a48d;}),_0x369e42['forEach']((_0x1a928a,_0x5d43ea)=>{var _0x363395=_0x9bf1b2;_0x59bcb1[_0x5d43ea][_0x363395(0x17a)]=_0x1a928a;}),_0x35178d[_0x9bf1b2(0x1a0)]((_0x31ccf0,_0x5d7131)=>{_0x59bcb1[_0x5d7131]['expiry_date']=_0x31ccf0;}),_0x544350['forEach']((_0x41184c,_0x12c131)=>{var _0x14864d=_0x9bf1b2;_0x59bcb1[_0x12c131][_0x14864d(0x128)]=_0x41184c;}),_0x4bd5fa['forEach']((_0x24fe6a,_0x27fe45)=>{var _0x2c375a=_0x9bf1b2;_0x59bcb1[_0x27fe45][_0x2c375a(0x1c6)]=_0x24fe6a;}),_0xa4e791[_0x9bf1b2(0x1a0)]((_0x4739a2,_0x3b7ae9)=>{_0x59bcb1[_0x3b7ae9]['from_types']=_0x4739a2;}),_0x25cc13[_0x9bf1b2(0x1a0)]((_0x4468ba,_0x3b1ca3)=>{var _0x54f2c3=_0x9bf1b2;_0x59bcb1[_0x3b1ca3][_0x54f2c3(0x1ee)]=_0x4468ba;}),_0x1cab0b[_0x9bf1b2(0x1a0)]((_0x5e0813,_0x1d7b2b)=>{var _0x536653=_0x9bf1b2;_0x59bcb1[_0x1d7b2b][_0x536653(0x13b)]=_0x5e0813;}),_0x4f2c02[_0x9bf1b2(0x1a0)]((_0x4de80e,_0x4bd2bd)=>{var _0x4f15ed=_0x9bf1b2;_0x59bcb1[_0x4bd2bd][_0x4f15ed(0x202)]=_0x4de80e;});const _0x325be5=_0x59bcb1['filter'](_0x22f933=>_0x22f933[_0x9bf1b2(0x1b0)]!=='0'&&_0x22f933[_0x9bf1b2(0x1b0)]!==''||_0x22f933[_0x9bf1b2(0x1ce)]!=='0'&&_0x22f933[_0x9bf1b2(0x1ce)]!=='');var _0x2665ea=0x0;_0x325be5[_0x9bf1b2(0x1a0)](_0x2c753f=>{var _0xbcb172=_0x9bf1b2;parseInt(_0x2c753f['from_quantity'])<parseInt(_0x2c753f[_0xbcb172(0x1b0)])&&_0x2665ea++;});if(_0x2665ea!=0x0)return _0x20a745['flash'](_0x9bf1b2(0x176),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x476a6f['redirect']('back');const _0x210c4b=await warehouse['findOne']({'name':_0x4ae468[_0x9bf1b2(0x13e)],'room':_0x4ae468[_0x9bf1b2(0x174)]});_0x4ae468['product'][_0x9bf1b2(0x1a0)](_0x55495e=>{var _0x292ad4=_0x9bf1b2;if(_0x55495e[_0x292ad4(0x1b0)]>0x0){const _0x48c05c=_0x210c4b[_0x292ad4(0x1c9)][_0x292ad4(0x1b2)](_0x4a39e7=>{var _0xed91aa=_0x292ad4;_0x4a39e7[_0xed91aa(0x161)]==_0x55495e[_0xed91aa(0x161)]&&_0x4a39e7[_0xed91aa(0x182)]==_0x55495e['from_floorlevel']&&_0x4a39e7[_0xed91aa(0x136)]==_0x55495e['from_types']&&_0x4a39e7['bin']==_0x55495e[_0xed91aa(0x1d9)]&&_0x4a39e7[_0xed91aa(0x169)]==_0x55495e[_0xed91aa(0x204)]&&_0x4a39e7[_0xed91aa(0x1c6)]==_0x55495e[_0xed91aa(0x202)]&&_0x4a39e7[_0xed91aa(0x128)]==_0x55495e[_0xed91aa(0x13b)]&&(_0x4a39e7['product_stock']=parseInt(_0x4a39e7[_0xed91aa(0x1d4)])+parseInt(_0x55495e[_0xed91aa(0x1b0)]));});}}),await _0x210c4b[_0x9bf1b2(0x1aa)]();const _0x7bb8d7=await warehouse['findOne']({'name':_0x4ae468[_0x9bf1b2(0x1dd)],'room':_0x4ae468[_0x9bf1b2(0x1ca)]});_0x4ae468[_0x9bf1b2(0x1fc)][_0x9bf1b2(0x1a0)](_0x1aff65=>{var _0x5a06d3=_0x9bf1b2;if(_0x1aff65['to_quantity']>0x0){const _0x15dbb5=_0x7bb8d7[_0x5a06d3(0x1c9)][_0x5a06d3(0x1b2)](_0x4e8a2b=>{var _0x2cae50=_0x5a06d3;_0x4e8a2b[_0x2cae50(0x161)]==_0x1aff65[_0x2cae50(0x161)]&&_0x4e8a2b[_0x2cae50(0x182)]==_0x1aff65[_0x2cae50(0x1ce)]&&_0x4e8a2b[_0x2cae50(0x136)]==_0x1aff65[_0x2cae50(0x1ee)]&&_0x4e8a2b[_0x2cae50(0x13c)]==_0x1aff65[_0x2cae50(0x152)]&&_0x4e8a2b[_0x2cae50(0x169)]==_0x1aff65[_0x2cae50(0x200)]&&_0x4e8a2b[_0x2cae50(0x1c6)]==_0x1aff65[_0x2cae50(0x1c6)]&&_0x4e8a2b[_0x2cae50(0x128)]==_0x1aff65[_0x2cae50(0x128)]&&(_0x4e8a2b[_0x2cae50(0x1d4)]=parseInt(_0x4e8a2b[_0x2cae50(0x1d4)])-parseInt(_0x1aff65['to_quantity']));});}}),await _0x7bb8d7[_0x9bf1b2(0x1aa)](),_0x4ae468[_0x9bf1b2(0x1ab)]=_0x3befa3,_0x4ae468[_0x9bf1b2(0x13e)]=_0x31f5fa,_0x4ae468['to_warehouse']=_0x4b8297,_0x4ae468[_0x9bf1b2(0x1fc)]=_0x325be5,_0x4ae468[_0x9bf1b2(0x1ad)]=_0x32d2aa,_0x4ae468[_0x9bf1b2(0x173)]=_0x49b046;const _0x2f34a4=await _0x4ae468[_0x9bf1b2(0x1aa)]();console[_0x9bf1b2(0x134)](_0x2f34a4);const _0x3658f2=await warehouse[_0x9bf1b2(0x120)]({'name':_0x31f5fa,'room':_0x1f6524});_0x2f34a4[_0x9bf1b2(0x1fc)]['forEach'](_0x1c3f8a=>{var _0x59739d=_0x9bf1b2;if(_0x1c3f8a[_0x59739d(0x1b0)]>0x0){const _0x104669=_0x3658f2[_0x59739d(0x1c9)][_0x59739d(0x1b2)](_0x183b51=>{var _0x1f0663=_0x59739d;_0x183b51['product_name']==_0x1c3f8a['product_name']&&_0x183b51[_0x1f0663(0x182)]==_0x1c3f8a[_0x1f0663(0x158)]&&_0x183b51[_0x1f0663(0x136)]==_0x1c3f8a[_0x1f0663(0x1de)]&&_0x183b51['bin']==_0x1c3f8a[_0x1f0663(0x1d9)]&&_0x183b51[_0x1f0663(0x169)]==_0x1c3f8a['from_bay']&&_0x183b51[_0x1f0663(0x1c6)]==_0x1c3f8a[_0x1f0663(0x202)]&&_0x183b51[_0x1f0663(0x128)]==_0x1c3f8a[_0x1f0663(0x13b)]&&(_0x183b51[_0x1f0663(0x1d4)]=parseInt(_0x183b51['product_stock'])-parseInt(_0x1c3f8a[_0x1f0663(0x1b0)]));});}}),await _0x3658f2[_0x9bf1b2(0x1aa)]();const _0x39d1d4=await warehouse[_0x9bf1b2(0x120)]({'name':_0x4b8297,'room':_0x101e37});_0x2f34a4[_0x9bf1b2(0x1fc)][_0x9bf1b2(0x1a0)](_0x4f1243=>{var _0x3afe41=_0x9bf1b2;if(_0x4f1243['to_quantity']>0x0){var _0x42882c=0x0;const _0x426955=_0x39d1d4[_0x3afe41(0x1c9)][_0x3afe41(0x1b2)](_0x4453ed=>{var _0x5e3b77=_0x3afe41;_0x4453ed[_0x5e3b77(0x161)]==_0x4f1243['product_name']&&_0x4453ed[_0x5e3b77(0x182)]==_0x4f1243['to_floorlevel']&&_0x4453ed[_0x5e3b77(0x136)]==_0x4f1243[_0x5e3b77(0x1ee)]&&_0x4453ed['bin']==_0x4f1243[_0x5e3b77(0x152)]&&_0x4453ed[_0x5e3b77(0x169)]==_0x4f1243[_0x5e3b77(0x200)]&&_0x4453ed['rack']==_0x4f1243[_0x5e3b77(0x1c6)]&&_0x4453ed[_0x5e3b77(0x128)]==_0x4f1243[_0x5e3b77(0x128)]&&(_0x4453ed[_0x5e3b77(0x1d4)]=parseInt(_0x4453ed[_0x5e3b77(0x1d4)])+parseInt(_0x4f1243[_0x5e3b77(0x1b0)]),_0x42882c++);});_0x42882c=='0'&&(_0x39d1d4[_0x3afe41(0x1c9)]=_0x39d1d4['product_details']['concat']({'product_name':_0x4f1243[_0x3afe41(0x161)],'product_stock':_0x4f1243['to_quantity'],'bay':_0x4f1243[_0x3afe41(0x200)],'bin':_0x4f1243[_0x3afe41(0x152)],'type':_0x4f1243[_0x3afe41(0x1ee)],'floorlevel':_0x4f1243[_0x3afe41(0x1ce)],'storage':_0x4f1243[_0x3afe41(0x128)],'rack':_0x4f1243['rack'],'product_code':_0x4f1243[_0x3afe41(0x1a9)],'primary_code':_0x4f1243[_0x3afe41(0x19b)],'secondary_code':_0x4f1243['secondary_code'],'maxProducts':_0x4f1243[_0x3afe41(0x1c8)],'storage':_0x4f1243[_0x3afe41(0x128)],'rack':_0x4f1243['rack']}));}}),await _0x39d1d4['save'](),_0x20a745[_0x9bf1b2(0x194)](_0x9bf1b2(0x1f2),_0x9bf1b2(0x1ac)),_0x476a6f[_0x9bf1b2(0x195)](_0x9bf1b2(0x1c0));}catch(_0x10ac2a){console['log'](_0x10ac2a);}}),router[a0_0x2048ee(0x1d6)](a0_0x2048ee(0x18c),async(_0x31bb58,_0x5179f2)=>{var _0x5f0c88=a0_0x2048ee;const {FromWareHouse:_0x1ad3c5,FromRoom:_0x430bbf,ToWarehouse:_0x13329c,ToRoom:_0x27c75f,primary_code:_0x35363d,Roomslist:_0x5cdfa9}=_0x31bb58[_0x5f0c88(0x190)],_0x59c5d0=_0x5cdfa9[_0x5f0c88(0x13d)](','),_0x1c91d8=[];async function _0x5d4698(_0x1ef721){var _0xd2a169=_0x5f0c88;const _0x524281=await warehouse[_0xd2a169(0x14c)]([{'$match':{'name':_0x1ad3c5,'room':_0x1ef721}},{'$unwind':_0xd2a169(0x19e)},{'$match':{'product_details.primary_code':_0x35363d}},{'$group':{'_id':_0xd2a169(0x1b5),'name':{'$first':_0xd2a169(0x199)},'instock':{'$first':_0xd2a169(0x133)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xd2a169(0x1b3)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0xd2a169(0x1df)},'isle':{'$first':_0xd2a169(0x188)},'type':{'$first':_0xd2a169(0x1f6)},'pallet':{'$first':_0xd2a169(0x159)},'unit':{'$first':_0xd2a169(0x1b7)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xd2a169(0x1da)},'rack':{'$first':_0xd2a169(0x1ba)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xd2a169(0x131)},'batch_code':{'$first':_0xd2a169(0x18a)},'maxPerUnit':{'$first':_0xd2a169(0x1db)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0xd2a169(0x1b1)},'maxProducts':{'$first':_0xd2a169(0x19c)}}}]),_0xd78e4d=await warehouse[_0xd2a169(0x14c)]([{'$match':{'name':_0x1ad3c5,'room':_0x1ef721}},{'$unwind':_0xd2a169(0x19e)},{'$match':{'product_details.secondary_code':_0x35363d}},{'$group':{'_id':_0xd2a169(0x1b5),'name':{'$first':_0xd2a169(0x199)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xd2a169(0x1b3)},'product_code':{'$first':_0xd2a169(0x1a1)},'level':{'$first':_0xd2a169(0x1df)},'isle':{'$first':_0xd2a169(0x188)},'type':{'$first':_0xd2a169(0x1f6)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xd2a169(0x1f1)},'storage':{'$first':_0xd2a169(0x1da)},'rack':{'$first':_0xd2a169(0x1ba)},'expiry_date':{'$first':_0xd2a169(0x141)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xd2a169(0x18a)},'maxPerUnit':{'$first':_0xd2a169(0x1db)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0xd2a169(0x1b1)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);if(_0x524281[_0xd2a169(0x15a)]>0x0)_0x1c91d8[_0xd2a169(0x130)](_0x524281);else _0xd78e4d[_0xd2a169(0x15a)]>0x0&&_0x1c91d8[_0xd2a169(0x130)](_0xd78e4d);}const _0x28956e=_0x59c5d0[_0x5f0c88(0x1b2)](_0x39bda4=>_0x5d4698(_0x39bda4));await Promise[_0x5f0c88(0x1a2)](_0x28956e),_0x5179f2[_0x5f0c88(0x1bc)](_0x1c91d8);}),router[a0_0x2048ee(0x1d6)]('/barcode_scanner2',async(_0x4d33c3,_0x5348ec)=>{var _0x146753=a0_0x2048ee;try{const {FromWareHouse:_0x31b957,FromRoom:_0x5cf3c6,ToWarehouse:_0x259112,ToRoom:_0x7c986a,secondary_code:_0x7804b7}=_0x4d33c3['body'],_0x3d02e4=await warehouse[_0x146753(0x14c)]([{'$match':{'name':_0x31b957}},{'$unwind':_0x146753(0x19e)},{'$match':{'product_details.secondary_code':_0x7804b7}},{'$group':{'_id':_0x146753(0x1b5),'name':{'$first':_0x146753(0x199)},'primary_code':{'$first':_0x146753(0x1c2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x146753(0x1a1)},'instock':{'$first':_0x146753(0x133)},'warehouse':{'$first':_0x146753(0x1c7)},'level':{'$first':_0x146753(0x143)},'isle':{'$first':_0x146753(0x1e1)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x146753(0x19c)},'unit':{'$first':_0x146753(0x1b7)}}}]);_0x5348ec[_0x146753(0x129)](0xc8)['json'](_0x3d02e4);}catch(_0x421e87){_0x5348ec['status'](0x194)[_0x146753(0x1bc)]({'message':_0x421e87[_0x146753(0x157)]});}}),router[a0_0x2048ee(0x1d6)](a0_0x2048ee(0x17c),async(_0xc6a5df,_0x256c2c)=>{var _0x5ee2b3=a0_0x2048ee;try{const {FromWareHouse:_0x170ea1,FromRoom:_0x181ff3,ToWarehouse:_0x1eda40,ToRoom:_0x31400b,product_code:_0x2ec1f1}=_0xc6a5df['body'],_0x18afb1=await warehouse[_0x5ee2b3(0x14c)]([{'$match':{'name':_0x170ea1}},{'$unwind':_0x5ee2b3(0x19e)},{'$match':{'product_details.product_code':_0x2ec1f1}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5ee2b3(0x199)},'primary_code':{'$first':_0x5ee2b3(0x1c2)},'secondary_code':{'$first':_0x5ee2b3(0x1b3)},'product_code':{'$first':_0x5ee2b3(0x1a1)},'instock':{'$first':_0x5ee2b3(0x133)},'warehouse':{'$first':_0x5ee2b3(0x1c7)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5ee2b3(0x1e1)},'pallet':{'$first':_0x5ee2b3(0x17e)},'maxProducts':{'$first':_0x5ee2b3(0x19c)},'unit':{'$first':_0x5ee2b3(0x1b7)}}}]);_0x256c2c[_0x5ee2b3(0x129)](0xc8)[_0x5ee2b3(0x1bc)](_0x18afb1);}catch(_0xf9bd54){_0x256c2c[_0x5ee2b3(0x129)](0x194)[_0x5ee2b3(0x1bc)]({'message':_0xf9bd54[_0x5ee2b3(0x157)]});}}),router[a0_0x2048ee(0x1d6)](a0_0x2048ee(0x206),async(_0x50d6c5,_0xa9d866)=>{var _0x5d9c35=a0_0x2048ee;const {level:_0x4a18ff,isle:_0x3a81a1,pallet:_0x8ef552,warehouses:_0x37bf9a,room:_0x4f1426}=_0x50d6c5[_0x5d9c35(0x190)];try{const _0x495ca7=await warehouse[_0x5d9c35(0x14c)]([{'$match':{'name':_0x37bf9a,'room':_0x4f1426}},{'$unwind':_0x5d9c35(0x19e)},{'$match':{'product_details.level':parseInt(_0x4a18ff),'product_details.isle':_0x3a81a1,'product_details.pallet':parseInt(_0x8ef552)}},{'$group':{'_id':_0x5d9c35(0x1b5),'name':{'$first':_0x5d9c35(0x199)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x5d9c35(0x143)},'isle':{'$first':_0x5d9c35(0x1e1)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0xa9d866[_0x5d9c35(0x129)](0xc8)[_0x5d9c35(0x1bc)](_0x495ca7);}catch(_0x5b17d5){_0xa9d866[_0x5d9c35(0x129)](0x194)['json']({'message':_0x5b17d5['message']});}}),module[a0_0x2048ee(0x185)]=router;