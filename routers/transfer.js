var a0_0x39b899=a0_0x3b50;(function(_0x48cd07,_0x57ce00){var _0x51d6cd=a0_0x3b50,_0x1d98a2=_0x48cd07();while(!![]){try{var _0x1f2e74=-parseInt(_0x51d6cd(0x204))/0x1+-parseInt(_0x51d6cd(0x1fe))/0x2*(parseInt(_0x51d6cd(0x1f9))/0x3)+parseInt(_0x51d6cd(0x2a6))/0x4*(-parseInt(_0x51d6cd(0x1c2))/0x5)+-parseInt(_0x51d6cd(0x225))/0x6*(-parseInt(_0x51d6cd(0x27a))/0x7)+parseInt(_0x51d6cd(0x202))/0x8*(parseInt(_0x51d6cd(0x1fa))/0x9)+-parseInt(_0x51d6cd(0x21c))/0xa+parseInt(_0x51d6cd(0x218))/0xb;if(_0x1f2e74===_0x57ce00)break;else _0x1d98a2['push'](_0x1d98a2['shift']());}catch(_0x201d0a){_0x1d98a2['push'](_0x1d98a2['shift']());}}}(a0_0x4186,0xe345a));const express=require(a0_0x39b899(0x1f3)),app=express(),router=express[a0_0x39b899(0x27d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x39b899(0x201)),auth=require('../middleware/auth'),users=require(a0_0x39b899(0x274)),nodemailer=require(a0_0x39b899(0x21f));function a0_0x3b50(_0x55911d,_0x5f3de1){var _0x418641=a0_0x4186();return a0_0x3b50=function(_0x3b5042,_0x259514){_0x3b5042=_0x3b5042-0x1bc;var _0x3184fb=_0x418641[_0x3b5042];return _0x3184fb;},a0_0x3b50(_0x55911d,_0x5f3de1);}router[a0_0x39b899(0x22d)](a0_0x39b899(0x210),auth,async(_0x488d31,_0x247c2e)=>{var _0x497621=a0_0x39b899;try{const {username:_0xf2996f,email:_0x4e1d62,role:_0x4d74e9}=_0x488d31[_0x497621(0x2a9)],_0x210a88=_0x488d31['user'],_0x3512ae=await profile['findOne']({'email':_0x210a88['email']}),_0x328215=await master_shop[_0x497621(0x24b)]();console[_0x497621(0x247)](_0x497621(0x237),_0x328215);let _0x9840f2;if(_0x210a88['role']==_0x497621(0x1c8)){const _0x312e03=await staff['findOne']({'email':_0x210a88[_0x497621(0x216)]});_0x9840f2=await transfers['find']({'from_warehouse':_0x312e03[_0x497621(0x1ce)]});}else _0x9840f2=await transfers[_0x497621(0x27f)]([{'$unwind':_0x497621(0x25f)},{'$group':{'_id':_0x497621(0x207),'invoice':{'$first':_0x497621(0x29e)},'date':{'$first':_0x497621(0x208)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x497621(0x1cc)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x497621(0x1be)},'finalize':{'$first':_0x497621(0x270)},'isAllowEdit':{'$first':_0x497621(0x2b1)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x328215[0x0]['language']==_0x497621(0x1f8)){var _0x1812bd=users[_0x497621(0x20c)];console[_0x497621(0x247)](_0x1812bd);}else{if(_0x328215[0x0][_0x497621(0x288)]=='Hindi')var _0x1812bd=users[_0x497621(0x1fb)];else{if(_0x328215[0x0][_0x497621(0x288)]==_0x497621(0x283))var _0x1812bd=users['German'];else{if(_0x328215[0x0][_0x497621(0x288)]==_0x497621(0x266))var _0x1812bd=users[_0x497621(0x266)];else{if(_0x328215[0x0][_0x497621(0x288)]==_0x497621(0x21e))var _0x1812bd=users['French'];else{if(_0x328215[0x0]['language']==_0x497621(0x215))var _0x1812bd=users[_0x497621(0x294)];else{if(_0x328215[0x0][_0x497621(0x288)]==_0x497621(0x285))var _0x1812bd=users[_0x497621(0x285)];else{if(_0x328215[0x0]['language']==_0x497621(0x297))var _0x1812bd=users['Arabic'];}}}}}}}_0x247c2e[_0x497621(0x2a2)](_0x497621(0x1db),{'success':_0x488d31[_0x497621(0x28d)](_0x497621(0x25b)),'errors':_0x488d31[_0x497621(0x28d)]('errors'),'role':_0x210a88,'profile':_0x3512ae,'master_shop':_0x328215,'transfer':_0x9840f2,'language':_0x1812bd});}catch(_0x353cc7){console['log'](_0x353cc7);}});async function getRandom8DigitNumber(){var _0x259d05=a0_0x39b899;const _0x4866f1=0x989680,_0xe976e7=0x5f5e0ff,_0x2115f9=Math[_0x259d05(0x245)](Math['random']()*(_0xe976e7-_0x4866f1+0x1))+_0x4866f1;var _0xee9636;const _0x28de7a=await transfers[_0x259d05(0x1c3)]({'invoice':_0x259d05(0x224)+_0x2115f9});return _0x28de7a&&_0x28de7a[_0x259d05(0x293)]>0x0?_0xee9636='TRF-'+_0x2115f9:_0xee9636='TRF-'+_0x2115f9,_0xee9636;}router[a0_0x39b899(0x22d)](a0_0x39b899(0x276),auth,async(_0x58bc3d,_0x1f86b6)=>{var _0x11b85b=a0_0x39b899;try{const {username:_0x2babc2,email:_0x135fd6,role:_0x3d4d4a}=_0x58bc3d[_0x11b85b(0x2a9)],_0x240854=_0x58bc3d['user'],_0x4202ac=await profile[_0x11b85b(0x1c3)]({'email':_0x240854[_0x11b85b(0x216)]}),_0x5942d2=await master_shop[_0x11b85b(0x24b)]();console[_0x11b85b(0x247)](_0x11b85b(0x237),_0x5942d2);let _0x176b27;if(_0x240854[_0x11b85b(0x1d9)]=='staff'){const _0x2385a1=await staff['findOne']({'email':_0x240854['email']});_0x176b27=await warehouse[_0x11b85b(0x27f)]([{'$match':{'status':_0x11b85b(0x1c1),'name':_0x2385a1[_0x11b85b(0x1ce)],'warehouse_category':_0x11b85b(0x21d)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x176b27=await warehouse[_0x11b85b(0x27f)]([{'$match':{'status':_0x11b85b(0x1c1),'warehouse_category':_0x11b85b(0x21d)}},{'$group':{'_id':_0x11b85b(0x1ea),'name':{'$first':'$name'}}}]);var _0x17af3d=[_0x11b85b(0x1e0),_0x11b85b(0x268),_0x11b85b(0x260)];const _0x40cb79=await transfers['find']({}),_0x51de3b=_0x40cb79[_0x11b85b(0x293)]+0x1,_0x459796=_0x11b85b(0x224)+_0x51de3b['toString']()[_0x11b85b(0x1d0)](0x5,'0');if(_0x5942d2[0x0][_0x11b85b(0x288)]==_0x11b85b(0x1f8)){var _0x3d181f=users[_0x11b85b(0x20c)];console[_0x11b85b(0x247)](_0x3d181f);}else{if(_0x5942d2[0x0][_0x11b85b(0x288)]==_0x11b85b(0x1fb))var _0x3d181f=users[_0x11b85b(0x1fb)];else{if(_0x5942d2[0x0][_0x11b85b(0x288)]==_0x11b85b(0x283))var _0x3d181f=users['German'];else{if(_0x5942d2[0x0][_0x11b85b(0x288)]==_0x11b85b(0x266))var _0x3d181f=users[_0x11b85b(0x266)];else{if(_0x5942d2[0x0][_0x11b85b(0x288)]==_0x11b85b(0x21e))var _0x3d181f=users[_0x11b85b(0x21e)];else{if(_0x5942d2[0x0]['language']==_0x11b85b(0x215))var _0x3d181f=users[_0x11b85b(0x294)];else{if(_0x5942d2[0x0][_0x11b85b(0x288)]==_0x11b85b(0x285))var _0x3d181f=users[_0x11b85b(0x285)];else{if(_0x5942d2[0x0]['language']=='Arabic\x20(ae)')var _0x3d181f=users['Arabic'];}}}}}}}const _0x5e5d90=getRandom8DigitNumber();_0x5e5d90['then'](_0x499489=>{var _0x5420ea=_0x11b85b;_0x1f86b6[_0x5420ea(0x2a2)]('add_transfer',{'success':_0x58bc3d[_0x5420ea(0x28d)](_0x5420ea(0x25b)),'errors':_0x58bc3d[_0x5420ea(0x28d)]('errors'),'role':_0x240854,'profile':_0x4202ac,'master_shop':_0x5942d2,'warehouse':_0x176b27,'language':_0x3d181f,'rooms_data':_0x17af3d,'invoice':_0x499489});})[_0x11b85b(0x261)](_0xbd54b9=>{var _0xd6b19f=_0x11b85b;_0x58bc3d[_0xd6b19f(0x28d)](_0xd6b19f(0x223),_0xd6b19f(0x298)),_0x1f86b6['redirect'](_0xd6b19f(0x28e));});}catch(_0x303b01){console[_0x11b85b(0x247)](_0x303b01);}}),router['post']('/view/add_transfer',auth,async(_0x13c621,_0x121590)=>{var _0x3c1c51=a0_0x39b899;try{console[_0x3c1c51(0x247)](_0x13c621[_0x3c1c51(0x20f)]);const {date:_0x46d53c,from_warehouse:_0x1334e4,FromRoom_name:_0x7c902e,to_warehouse:_0x32e8ad,ToRoom_name:_0xbe0e4f,prod_name:_0x1e85fb,from_prod_qty:_0x1abf45,from_prod_level:_0x361076,from_prod_isle:_0x127368,from_prod_pallet:_0x389426,to_prod_qty:_0x157813,to_prod_level:_0x376a82,to_prod_isle:_0x37eee9,to_prod_pallet:_0x44fe32,primary_code:_0x1fe625,secondary_code:_0x1663c3,product_code3:_0xec952b,note:_0x2f1a5f,MaxStocks_data2:_0x434728,invoice:_0x352346,expiry_date:_0x1d541e}=_0x13c621[_0x3c1c51(0x20f)];if(typeof _0x1e85fb==_0x3c1c51(0x1f0))var _0x5b43f4=[_0x13c621[_0x3c1c51(0x20f)]['prod_name']],_0x53bca8=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x290)]],_0x4ca760=[_0x13c621['body'][_0x3c1c51(0x24f)]],_0x2d5405=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x241)]],_0x44fd50=[_0x13c621[_0x3c1c51(0x20f)]['to_prod_level']],_0x566601=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x2a3)]],_0x35e76e=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x25a)]],_0x128438=[_0x13c621[_0x3c1c51(0x20f)]['product_code3']],_0xe64777=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x21b)]],_0x411239=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x22b)]],_0x258d43=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x226)]],_0xf0de57=[_0x13c621[_0x3c1c51(0x20f)]['batch_code']],_0x2dab12=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x29c)]],_0xe990bb=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x1bd)]],_0xfa7abc=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x24c)]],_0x4fb780=[_0x13c621[_0x3c1c51(0x20f)]['prod_cat']],_0x3208f5=[_0x13c621[_0x3c1c51(0x20f)]['RoomAssigned']],_0x250b34=[_0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x1da)]],_0x59159b=[_0x13c621[_0x3c1c51(0x20f)]['from_invoice']],_0x219bfd=[_0x13c621[_0x3c1c51(0x20f)]['to_invoice']];else var _0x5b43f4=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x250)]],_0x53bca8=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x290)]],_0x4ca760=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x24f)]],_0x2d5405=[..._0x13c621['body'][_0x3c1c51(0x241)]],_0x44fd50=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x234)]],_0x566601=[..._0x13c621[_0x3c1c51(0x20f)]['primary_code']],_0x35e76e=[..._0x13c621[_0x3c1c51(0x20f)]['secondary_code']],_0x128438=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x1cd)]],_0xe64777=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x21b)]],_0x411239=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x22b)]],_0x258d43=[..._0x13c621['body'][_0x3c1c51(0x226)]],_0xf0de57=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x287)]],_0x2dab12=[..._0x13c621['body'][_0x3c1c51(0x29c)]],_0xe990bb=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x1bd)]],_0xfa7abc=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x24c)]],_0x4fb780=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x1e5)]],_0x3208f5=[..._0x13c621['body']['RoomAssigned']],_0x250b34=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x1da)]],_0x59159b=[..._0x13c621['body'][_0x3c1c51(0x1d4)]],_0x219bfd=[..._0x13c621[_0x3c1c51(0x20f)][_0x3c1c51(0x275)]];const _0x1c58e7=_0x5b43f4[_0x3c1c51(0x28c)](_0x5c8bf3=>{return _0x5c8bf3={'product_name':_0x5c8bf3};});_0x53bca8[_0x3c1c51(0x269)]((_0x138e16,_0x11ee2d)=>{var _0x16563f=_0x3c1c51;_0x1c58e7[_0x11ee2d][_0x16563f(0x22c)]=_0x138e16;}),_0x59159b[_0x3c1c51(0x269)]((_0x4076c6,_0x406700)=>{var _0x11af0c=_0x3c1c51;_0x1c58e7[_0x406700][_0x11af0c(0x1d4)]=_0x4076c6;}),_0x219bfd[_0x3c1c51(0x269)]((_0x33d4b3,_0x185b29)=>{var _0x4f20ad=_0x3c1c51;_0x1c58e7[_0x185b29][_0x4f20ad(0x23e)]=_0x33d4b3;}),_0x4ca760[_0x3c1c51(0x269)]((_0xf058c9,_0x1c10d5)=>{var _0x3795d0=_0x3c1c51;_0x3208f5[_0x3795d0(0x269)]((_0x59e98c,_0x276c54)=>{var _0xc6400a=_0x3795d0;if(_0x59e98c=='Receiving\x20Area'&&_0x1c10d5==_0x276c54){var _0x156967=_0xf058c9[_0xc6400a(0x1c9)](0x3);_0x1c58e7[_0x1c10d5][_0xc6400a(0x235)]=_0xf058c9[0x0],_0x1c58e7[_0x1c10d5][_0xc6400a(0x28f)]=_0xf058c9[0x1],_0x1c58e7[_0x1c10d5][_0xc6400a(0x1ca)]=0x0,_0x1c58e7[_0x1c10d5]['from_bin']=0x0,_0x1c58e7[_0x1c10d5][_0xc6400a(0x1c7)]=_0xc6400a(0x1df),_0x1c58e7[_0x1c10d5][_0xc6400a(0x23c)]=_0x156967;}else{if(_0x59e98c==_0xc6400a(0x221)&&_0x1c10d5==_0x276c54){var _0x156967=_0xf058c9[_0xc6400a(0x1c9)](0x3);_0x1c58e7[_0x1c10d5][_0xc6400a(0x235)]=_0xf058c9[0x0],_0x1c58e7[_0x1c10d5]['from_rack']=_0xf058c9[0x1],_0x1c58e7[_0x1c10d5][_0xc6400a(0x1ca)]=0x0,_0x1c58e7[_0x1c10d5]['from_bin']=0x0,_0x1c58e7[_0x1c10d5][_0xc6400a(0x1c7)]=_0xc6400a(0x1df),_0x1c58e7[_0x1c10d5][_0xc6400a(0x23c)]=_0xf058c9[0x5];}else{if(_0x1c10d5==_0x276c54){var _0x51bde9;if(_0xf058c9[0x4]=='L')_0x51bde9='Level';else _0xf058c9[0x4]=='F'&&(_0x51bde9='Floor');_0x1c58e7[_0x1c10d5][_0xc6400a(0x235)]=_0xf058c9[0x0],_0x1c58e7[_0x1c10d5]['from_rack']=_0xf058c9[0x1],_0x1c58e7[_0x1c10d5]['from_bay']=_0xf058c9[0x2],_0x1c58e7[_0x1c10d5][_0xc6400a(0x213)]=_0xf058c9[0x3],_0x1c58e7[_0x1c10d5][_0xc6400a(0x1c7)]=_0x51bde9,_0x1c58e7[_0x1c10d5]['from_floorlevel']=_0xf058c9[0x5];}}}});}),_0x2d5405[_0x3c1c51(0x269)]((_0x4d91ee,_0x28a170)=>{_0x1c58e7[_0x28a170]['to_quantity']=_0x4d91ee;}),_0x44fd50[_0x3c1c51(0x269)]((_0x2c803b,_0x7bf1d8)=>{_0x250b34['forEach']((_0xab118e,_0x102ce8)=>{var _0x40bba=a0_0x3b50;if(_0xab118e==_0x40bba(0x1f5)&&_0x7bf1d8==_0x102ce8){var _0x1422c1=_0x2c803b[_0x40bba(0x1c9)](0x3);_0x1c58e7[_0x7bf1d8][_0x40bba(0x23f)]=_0x2c803b[0x0],_0x1c58e7[_0x7bf1d8][_0x40bba(0x20e)]=_0x2c803b[0x1],_0x1c58e7[_0x7bf1d8][_0x40bba(0x1d2)]=0x0,_0x1c58e7[_0x7bf1d8]['to_bin']=0x0,_0x1c58e7[_0x7bf1d8]['to_types']=_0x40bba(0x1df),_0x1c58e7[_0x7bf1d8][_0x40bba(0x228)]=_0x1422c1;}else{if(_0xab118e==_0x40bba(0x221)&&_0x7bf1d8==_0x102ce8){var _0x1422c1=_0x2c803b[_0x40bba(0x1c9)](0x3);_0x1c58e7[_0x7bf1d8][_0x40bba(0x23f)]=_0x2c803b[0x0],_0x1c58e7[_0x7bf1d8][_0x40bba(0x20e)]=_0x2c803b[0x1],_0x1c58e7[_0x7bf1d8]['to_bay']=0x0,_0x1c58e7[_0x7bf1d8][_0x40bba(0x2ab)]=0x0,_0x1c58e7[_0x7bf1d8][_0x40bba(0x1c0)]=_0x40bba(0x1df),_0x1c58e7[_0x7bf1d8]['to_floorlevel']=_0x2c803b[0x5];}else{if(_0x7bf1d8==_0x102ce8){var _0x233cb2;if(_0x2c803b[0x4]=='L')_0x233cb2=_0x40bba(0x1fc);else _0x2c803b[0x4]=='F'&&(_0x233cb2=_0x40bba(0x1df));_0x1c58e7[_0x7bf1d8][_0x40bba(0x23f)]=_0x2c803b[0x0],_0x1c58e7[_0x7bf1d8][_0x40bba(0x20e)]=_0x2c803b[0x1],_0x1c58e7[_0x7bf1d8]['to_bay']=_0x2c803b[0x2],_0x1c58e7[_0x7bf1d8][_0x40bba(0x2ab)]=_0x2c803b[0x3],_0x1c58e7[_0x7bf1d8][_0x40bba(0x1c0)]=_0x233cb2,_0x1c58e7[_0x7bf1d8][_0x40bba(0x228)]=_0x2c803b[0x5];}}}});}),_0x566601['forEach']((_0x241355,_0x5d178f)=>{var _0x15228c=_0x3c1c51;_0x1c58e7[_0x5d178f][_0x15228c(0x2a3)]=_0x241355;}),_0x35e76e[_0x3c1c51(0x269)]((_0x3b7ef7,_0x23eaed)=>{_0x1c58e7[_0x23eaed]['secondary_code']=_0x3b7ef7;}),_0x128438[_0x3c1c51(0x269)]((_0x2ada6e,_0x308b76)=>{var _0x5c1496=_0x3c1c51;_0x1c58e7[_0x308b76][_0x5c1496(0x1c5)]=_0x2ada6e;}),_0xe64777[_0x3c1c51(0x269)]((_0x20fc84,_0x598567)=>{var _0x3a1a26=_0x3c1c51;_0x1c58e7[_0x598567][_0x3a1a26(0x24e)]=_0x20fc84;}),_0x411239[_0x3c1c51(0x269)]((_0x185d55,_0x4ae762)=>{var _0x2e815f=_0x3c1c51;_0x1c58e7[_0x4ae762][_0x2e815f(0x291)]=_0x185d55;}),_0x258d43['forEach']((_0x29f2fc,_0x20b2c7)=>{var _0x29f016=_0x3c1c51;_0x1c58e7[_0x20b2c7][_0x29f016(0x226)]=_0x29f2fc;}),_0xf0de57[_0x3c1c51(0x269)]((_0x2e9feb,_0x155f9a)=>{var _0xf25603=_0x3c1c51;_0x1c58e7[_0x155f9a][_0xf25603(0x287)]=_0x2e9feb;}),_0x2dab12['forEach']((_0x3edb04,_0x3753bc)=>{var _0x44ace1=_0x3c1c51;_0x1c58e7[_0x3753bc][_0x44ace1(0x29c)]=_0x3edb04;}),_0xe990bb[_0x3c1c51(0x269)]((_0x11a5c1,_0x6fe11c)=>{var _0x37a717=_0x3c1c51;_0x1c58e7[_0x6fe11c][_0x37a717(0x1f6)]=_0x11a5c1;}),_0xfa7abc[_0x3c1c51(0x269)]((_0x5b8ee8,_0x5c8c67)=>{_0x1c58e7[_0x5c8c67]['production_date']=_0x5b8ee8;}),_0x4fb780[_0x3c1c51(0x269)]((_0x4658a0,_0x31f8ce)=>{var _0x5be36c=_0x3c1c51;_0x1c58e7[_0x31f8ce][_0x5be36c(0x1e5)]=_0x4658a0;}),_0x3208f5[_0x3c1c51(0x269)]((_0x55b757,_0x4d6505)=>{var _0x45206a=_0x3c1c51;_0x1c58e7[_0x4d6505][_0x45206a(0x236)]=_0x55b757;}),_0x250b34[_0x3c1c51(0x269)]((_0x5c6032,_0x43143f)=>{var _0x389513=_0x3c1c51;_0x1c58e7[_0x43143f][_0x389513(0x295)]=_0x5c6032;});const _0x1d6722=_0x1c58e7['filter'](_0xd6815b=>_0xd6815b['to_quantity']!=='0'&&_0xd6815b[_0x3c1c51(0x249)]!==''||_0xd6815b[_0x3c1c51(0x228)]!=='0'&&_0xd6815b[_0x3c1c51(0x228)]!==''),_0x8ac0a2=new transfers({'date':_0x46d53c,'from_warehouse':_0x1334e4,'to_warehouse':_0x32e8ad,'product':_0x1d6722,'note':_0x2f1a5f,'invoice':_0x352346}),_0x3e71ad=await _0x8ac0a2[_0x3c1c51(0x29a)]();_0x13c621['flash'](_0x3c1c51(0x25b),_0x3c1c51(0x220)),_0x121590[_0x3c1c51(0x1f4)](_0x3c1c51(0x243)+_0x3e71ad['_id']);}catch(_0x45371c){console[_0x3c1c51(0x247)](_0x45371c),_0x121590[_0x3c1c51(0x258)](0xc8)[_0x3c1c51(0x1e3)]({'errorMessage':_0x45371c[_0x3c1c51(0x1e7)]});}}),router[a0_0x39b899(0x22d)]('/preview/:id',auth,async(_0x4a9145,_0x104aab)=>{var _0x2f08b7=a0_0x39b899;try{const {username:_0x554f58,email:_0x70903f,role:_0x4f723a}=_0x4a9145[_0x2f08b7(0x2a9)],_0x56afb7=_0x4a9145[_0x2f08b7(0x2a9)],_0x11ef58=await profile[_0x2f08b7(0x1c3)]({'email':_0x56afb7[_0x2f08b7(0x216)]}),_0x51cf35=await master_shop['find']();console['log'](_0x2f08b7(0x237),_0x51cf35);const _0x54a85d=await transfers[_0x2f08b7(0x1bf)](_0x4a9145['params']['id']);let _0x5ee851=new Date(_0x54a85d[_0x2f08b7(0x29c)]),_0x1d92ef=('0'+_0x5ee851[_0x2f08b7(0x257)]())[_0x2f08b7(0x1c9)](-0x2),_0xede421=('0'+(_0x5ee851['getMonth']()+0x1))[_0x2f08b7(0x1c9)](-0x2),_0x26da11=_0x5ee851[_0x2f08b7(0x214)](),_0x2fcd64=_0x26da11+'-'+_0xede421+'-'+_0x1d92ef,_0x376a63;if(_0x56afb7[_0x2f08b7(0x1d9)]==_0x2f08b7(0x1c8)){const _0x1fbc65=await staff[_0x2f08b7(0x1c3)]({'email':_0x56afb7[_0x2f08b7(0x216)]});_0x376a63=await warehouse[_0x2f08b7(0x24b)]({'status':_0x2f08b7(0x1c1),'name':_0x1fbc65[_0x2f08b7(0x1ce)],'warehouse_category':'Raw\x20Materials'});}else _0x376a63=await warehouse[_0x2f08b7(0x24b)]({'status':_0x2f08b7(0x1c1),'warehouse_category':'Raw\x20Materials'});const _0x3ffe10=await warehouse[_0x2f08b7(0x27f)]([{'$match':{'name':_0x54a85d['from_warehouse']}},{'$unwind':_0x2f08b7(0x240)},{'$group':{'_id':_0x2f08b7(0x26d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2f08b7(0x23a)},'bay':{'$first':_0x2f08b7(0x1d1)},'bin':{'$first':_0x2f08b7(0x233)},'type':{'$first':_0x2f08b7(0x27b)},'floorlevel':{'$first':_0x2f08b7(0x1e4)},'primary_code':{'$first':_0x2f08b7(0x24d)},'secondary_code':{'$first':_0x2f08b7(0x230)},'product_code':{'$first':_0x2f08b7(0x1e9)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2f08b7(0x26c)},'expiry_date':{'$first':_0x2f08b7(0x2ad)},'production_date':{'$first':_0x2f08b7(0x211)},'room':{'$first':_0x2f08b7(0x2ae)}}}]);if(_0x51cf35[0x0][_0x2f08b7(0x288)]==_0x2f08b7(0x1f8)){var _0x59b91e=users['English'];console[_0x2f08b7(0x247)](_0x59b91e);}else{if(_0x51cf35[0x0][_0x2f08b7(0x288)]=='Hindi')var _0x59b91e=users['Hindi'];else{if(_0x51cf35[0x0][_0x2f08b7(0x288)]=='German')var _0x59b91e=users[_0x2f08b7(0x283)];else{if(_0x51cf35[0x0][_0x2f08b7(0x288)]==_0x2f08b7(0x266))var _0x59b91e=users[_0x2f08b7(0x266)];else{if(_0x51cf35[0x0][_0x2f08b7(0x288)]=='French')var _0x59b91e=users[_0x2f08b7(0x21e)];else{if(_0x51cf35[0x0][_0x2f08b7(0x288)]==_0x2f08b7(0x215))var _0x59b91e=users[_0x2f08b7(0x294)];else{if(_0x51cf35[0x0][_0x2f08b7(0x288)]==_0x2f08b7(0x285))var _0x59b91e=users[_0x2f08b7(0x285)];else{if(_0x51cf35[0x0][_0x2f08b7(0x288)]==_0x2f08b7(0x297))var _0x59b91e=users[_0x2f08b7(0x22a)];}}}}}}}_0x104aab[_0x2f08b7(0x2a2)](_0x2f08b7(0x1c4),{'success':_0x4a9145[_0x2f08b7(0x28d)](_0x2f08b7(0x25b)),'errors':_0x4a9145[_0x2f08b7(0x28d)](_0x2f08b7(0x223)),'role':_0x56afb7,'profile':_0x11ef58,'master_shop':_0x51cf35,'warehouse':_0x376a63,'transfer':_0x54a85d,'stock':_0x3ffe10,'language':_0x59b91e});}catch(_0x3a5a73){console[_0x2f08b7(0x247)](_0x3a5a73);}}),router[a0_0x39b899(0x1fd)](a0_0x39b899(0x1d6),auth,async(_0xd88373,_0x5f175e)=>{var _0xefb6c7=a0_0x39b899;try{const _0x488851=_0xd88373[_0xefb6c7(0x219)]['id'],{from_warehouse:_0xa3ed4f,FromRoom_name:_0x421b3d,to_warehouse:_0x2ee38a,ToRoom_name:_0x549185}=_0xd88373['body'],_0x280267=await transfers['findById']({'_id':_0x488851}),_0x35af73=_0x280267['product'][_0xefb6c7(0x28c)](async _0xb3d6e3=>{var _0x31887b=_0xefb6c7;if(_0xb3d6e3['to_quantity']>0x0){var _0x4beb41=await warehouse[_0x31887b(0x1c3)]({'name':_0x280267[_0x31887b(0x1d5)],'room':_0xb3d6e3[_0x31887b(0x236)],'warehouse_category':_0x31887b(0x21d)});const _0x30cac9=_0x4beb41['product_details'][_0x31887b(0x28c)](_0x2448fe=>{var _0x1d7e5a=_0x31887b;_0x2448fe['product_name']==_0xb3d6e3[_0x1d7e5a(0x203)]&&_0x2448fe[_0x1d7e5a(0x229)]==_0xb3d6e3['from_floorlevel']&&_0x2448fe[_0x1d7e5a(0x1ef)]==_0xb3d6e3['from_types']&&_0x2448fe['bin']==_0xb3d6e3[_0x1d7e5a(0x213)]&&_0x2448fe['bay']==_0xb3d6e3[_0x1d7e5a(0x1ca)]&&_0x2448fe[_0x1d7e5a(0x20e)]==_0xb3d6e3['from_rack']&&_0x2448fe['storage']==_0xb3d6e3['from_storage']&&_0x2448fe[_0x1d7e5a(0x29c)]==_0xb3d6e3['expiry_date']&&_0x2448fe[_0x1d7e5a(0x287)]==_0xb3d6e3[_0x1d7e5a(0x287)]&&_0x2448fe[_0x1d7e5a(0x24c)]==_0xb3d6e3['production_date']&&_0x2448fe['invoice']==_0xb3d6e3[_0x1d7e5a(0x1d4)]&&(_0x2448fe[_0x1d7e5a(0x1cf)]=_0x2448fe[_0x1d7e5a(0x1cf)]-_0xb3d6e3[_0x1d7e5a(0x249)]);});}return _0x4beb41;});Promise['all'](_0x35af73)[_0xefb6c7(0x238)](async _0x283a24=>{var _0x3d11d8=_0xefb6c7;try{for(const _0x2a2cca of _0x283a24){await _0x2a2cca[_0x3d11d8(0x29a)]();}try{const _0x1c529c=_0x280267[_0x3d11d8(0x2a1)][_0x3d11d8(0x28c)](async _0x384436=>{var _0x8e87ad=_0x3d11d8;if(_0x384436[_0x8e87ad(0x249)]>0x0){var _0x3a590d=await warehouse[_0x8e87ad(0x1c3)]({'name':_0x280267[_0x8e87ad(0x255)],'room':_0x384436[_0x8e87ad(0x295)],'warehouse_category':'Raw\x20Materials'}),_0x2512e8=0x0;const _0x30e4fb=_0x3a590d[_0x8e87ad(0x1d8)][_0x8e87ad(0x28c)](_0x2a5947=>{var _0x31dde3=_0x8e87ad;_0x2a5947[_0x31dde3(0x203)]==_0x384436[_0x31dde3(0x203)]&&_0x2a5947[_0x31dde3(0x229)]==_0x384436[_0x31dde3(0x228)]&&_0x2a5947[_0x31dde3(0x1ef)]==_0x384436[_0x31dde3(0x1c0)]&&_0x2a5947[_0x31dde3(0x26f)]==_0x384436[_0x31dde3(0x2ab)]&&_0x2a5947['bay']==_0x384436[_0x31dde3(0x1d2)]&&_0x2a5947['rack']==_0x384436['rack']&&_0x2a5947[_0x31dde3(0x23f)]==_0x384436[_0x31dde3(0x23f)]&&_0x2a5947['expiry_date']==_0x384436[_0x31dde3(0x29c)]&&_0x2a5947[_0x31dde3(0x287)]==_0x384436[_0x31dde3(0x287)]&&_0x2a5947[_0x31dde3(0x24c)]==_0x384436[_0x31dde3(0x24c)]&&_0x2a5947[_0x31dde3(0x28a)]==_0x384436[_0x31dde3(0x23e)]&&(_0x2a5947['product_stock']=_0x2a5947[_0x31dde3(0x1cf)]+_0x384436[_0x31dde3(0x249)],_0x2512e8++);});_0x2512e8=='0'&&(_0x3a590d[_0x8e87ad(0x1d8)]=_0x3a590d['product_details'][_0x8e87ad(0x23b)]({'product_name':_0x384436['product_name'],'product_stock':_0x384436[_0x8e87ad(0x249)],'bay':_0x384436[_0x8e87ad(0x1d2)],'bin':_0x384436['to_bin'],'type':_0x384436[_0x8e87ad(0x1c0)],'floorlevel':_0x384436[_0x8e87ad(0x228)],'storage':_0x384436[_0x8e87ad(0x23f)],'rack':_0x384436[_0x8e87ad(0x20e)],'product_code':_0x384436[_0x8e87ad(0x1c5)],'primary_code':_0x384436[_0x8e87ad(0x2a3)],'secondary_code':_0x384436[_0x8e87ad(0x25a)],'maxProducts':_0x384436[_0x8e87ad(0x24e)],'storage':_0x384436['storage'],'rack':_0x384436['rack'],'expiry_date':_0x384436[_0x8e87ad(0x29c)],'maxPerUnit':_0x384436[_0x8e87ad(0x1f6)],'batch_code':_0x384436[_0x8e87ad(0x287)],'production_date':_0x384436[_0x8e87ad(0x24c)]}));}return _0x3a590d;});Promise[_0x3d11d8(0x209)](_0x1c529c)[_0x3d11d8(0x238)](async _0x200772=>{var _0x36b254=_0x3d11d8;try{for(const _0x1f5331 of _0x200772){await warehouse['updateOne']({'_id':_0x1f5331['_id']},{'$addToSet':{'product_details':{'$each':_0x1f5331[_0x36b254(0x1d8)]}}});}_0x280267[_0x36b254(0x292)]=_0x36b254(0x29f);const _0x524b4e=await _0x280267[_0x36b254(0x29a)](),_0x587d6e=await master_shop[_0x36b254(0x24b)](),_0x40e2cf=await email_settings[_0x36b254(0x1c3)](),_0x14adcb=await supervisor_settings['find']();var _0x1dbb35=_0x280267['product'],_0x19218c='',_0x36481e;for(_0x36481e in _0x1dbb35){_0x19218c+=_0x36b254(0x25d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1dbb35[_0x36481e][_0x36b254(0x203)]+_0x36b254(0x222)+_0x36b254(0x2a8)+_0x1dbb35[_0x36481e][_0x36b254(0x1c5)]+_0x36b254(0x222)+_0x36b254(0x2a8)+_0x1dbb35[_0x36481e]['to_quantity']+'</td>'+_0x36b254(0x2a8)+_0x1dbb35[_0x36481e]['unit']+_0x36b254(0x222)+_0x36b254(0x2a8)+_0x1dbb35[_0x36481e][_0x36b254(0x226)]+_0x36b254(0x222)+_0x36b254(0x2a8)+_0x280267[_0x36b254(0x255)]+_0x36b254(0x222)+_0x36b254(0x2a8)+_0x1dbb35[_0x36481e]['to_room_name']+_0x36b254(0x222)+_0x36b254(0x2a8)+_0x1dbb35[_0x36481e][_0x36b254(0x23f)]+_0x1dbb35[_0x36481e][_0x36b254(0x20e)]+_0x1dbb35[_0x36481e][_0x36b254(0x1d2)]+_0x1dbb35[_0x36481e]['to_bin']+_0x1dbb35[_0x36481e][_0x36b254(0x1c0)][0x0]+_0x1dbb35[_0x36481e]['to_floorlevel']+_0x36b254(0x222),'</tr>';}let _0x5017e2=nodemailer[_0x36b254(0x286)]({'host':_0x40e2cf[_0x36b254(0x2a0)],'port':Number(_0x40e2cf['port']),'secure':![],'auth':{'user':_0x40e2cf[_0x36b254(0x216)],'pass':_0x40e2cf[_0x36b254(0x254)]}}),_0x4d7eec={'from':_0x40e2cf[_0x36b254(0x216)],'to':_0x14adcb[0x0][_0x36b254(0x1f1)],'subject':_0x36b254(0x22e),'attachments':[{'filename':_0x36b254(0x27c),'path':__dirname+_0x36b254(0x289)+_0x36b254(0x2a4)+_0x587d6e[0x0][_0x36b254(0x1ff)],'cid':_0x36b254(0x251)}],'html':_0x36b254(0x273)+_0x36b254(0x1bc)+_0x36b254(0x1ed)+_0x36b254(0x21a)+_0x36b254(0x26a)+_0x36b254(0x21a)+_0x36b254(0x239)+_0x36b254(0x296)+_0x36b254(0x21a)+_0x36b254(0x23d)+_0x587d6e[0x0][_0x36b254(0x231)]+'\x20</h2>'+_0x36b254(0x296)+'</div>'+_0x36b254(0x200)+_0x36b254(0x21a)+_0x36b254(0x1e6)+_0x36b254(0x1de)+_0x280267[_0x36b254(0x28a)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x36b254(0x25e)+_0x280267[_0x36b254(0x264)]+'\x20'+_0x36b254(0x26e)+'</h5>'+_0x36b254(0x296)+_0x36b254(0x1ec)+_0x36b254(0x278)+_0x36b254(0x25d)+_0x36b254(0x1d3)+_0x36b254(0x1f2)+_0x36b254(0x232)+_0x36b254(0x29b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x36b254(0x272)+_0x36b254(0x1e2)+_0x36b254(0x26b)+_0x36b254(0x281)+_0x36b254(0x1e8)+'\x20'+_0x19218c+'\x20'+_0x36b254(0x242)+_0x36b254(0x1ee)+_0x36b254(0x21a)+_0x36b254(0x28b)+_0x36b254(0x20b)+_0x587d6e[0x0]['site_title']+_0x36b254(0x25c)+_0x36b254(0x296)+'</div>'+_0x36b254(0x282)};_0x5017e2[_0x36b254(0x212)](_0x4d7eec,function(_0x1d22c6,_0x490792){var _0xdb2f54=_0x36b254;_0x1d22c6?(console['log'](_0x1d22c6),console[_0xdb2f54(0x247)](_0xdb2f54(0x205))):console[_0xdb2f54(0x247)](_0xdb2f54(0x253));}),_0xd88373[_0x36b254(0x28d)](_0x36b254(0x25b),'Transfer\x20Finalize\x20Successfully'),_0x5f175e[_0x36b254(0x1f4)]('/picking_list/PDF_transfer_rm/'+_0x524b4e[_0x36b254(0x217)]);}catch(_0x75ed6){console['error'](_0x75ed6),_0x5f175e['status'](0x1f4)['json']({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x75ed6[_0x36b254(0x1e7)]});}})[_0x3d11d8(0x261)](_0x26ae9e=>{var _0x8e392d=_0x3d11d8;console['error'](_0x26ae9e),_0x5f175e[_0x8e392d(0x258)](0x1f4)[_0x8e392d(0x1e3)]({'Perror':_0x8e392d(0x27e)});});}catch(_0x3624df){_0x5f175e[_0x3d11d8(0x1e3)](_0x3624df);}}catch(_0x5045fc){console[_0x3d11d8(0x206)](_0x5045fc),_0x5f175e[_0x3d11d8(0x258)](0x1f4)['json']({'Merror':_0x3d11d8(0x263),'Message':_0x5045fc[_0x3d11d8(0x1e7)]});}})[_0xefb6c7(0x261)](_0x120f61=>{var _0xab9cc7=_0xefb6c7;console[_0xab9cc7(0x206)](_0x120f61),_0x5f175e[_0xab9cc7(0x258)](0x1f4)[_0xab9cc7(0x1e3)]({'Merror':_0xab9cc7(0x27e)});});}catch(_0x212ba5){console['log'](_0x212ba5);}});function a0_0x4186(){var _0x4cc31f=['nodemailer','Product\x20Transfer\x20successfully','Shelves','</td>','errors','TRF-','133764YzMBej','secondary_unit','$product_details.isle','to_floorlevel','floorlevel','Arabic','primary_unit','from_quantity','get','Transfer\x20Mail','Rack\x20F','$product_details.secondary_code','site_title','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.bin','to_prod_level','from_storage','from_room_name','master','then','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.product_stock','concat','from_floorlevel','<h2>\x20','To_invoice','storage','$product_details','New_Qty_Converted','</tbody>','/transfer/preview/','rak','floor','note','log','push','to_quantity','$product_details.pallet','find','production_date','$product_details.primary_code','maxProducts','from_prod_level','prod_name','logo','$product_details.storage','Email\x20sent\x20successfully','password','to_warehouse','from_rak','getDate','status','back','secondary_code','success','</h5>','<tr>','\x20Order\x20Date\x20:\x20','$product','Return\x20Rooms','catch','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','An\x20error\x20occurred\x20while\x20saving\x20data.','date','Rack\x20C','Spanish','$product_details.batch_code','Enclosed','forEach','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</tr>','$product_details.rack','$product_details._id','</span>','bin','$finalize','to_prod_pallet','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<!DOCTYPE\x20html>','../public/language/languages.json','to_invoice','/view/add_transfer','exports','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','from_prod_isle','448QkWhig','$product_details.type','Logo.png','Router','An\x20error\x20occurred.','aggregate','/view/:id','</thead>','</body></html>','German','Transfer\x20Edit\x20Successfully','Chinese','createTransport','batch_code','language','/../public','invoice','<strong>\x20Regards\x20</strong>','map','flash','/transfer/view','from_rack','from_prod_qty','unit','finalize','length','Portuguese','to_room_name','</div>','Arabic\x20(ae)','There\x27s\x20a\x20error\x20in\x20this\x20transaction','to_room','save','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','expiry_date','$product_details.maxPerUnit','$invoice','True','host','product','render','primary_code','/upload/','$product_details.unit','3504596eMmQAb','from_prod_pallet','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','user','$product_details.maxProducts','to_bin','bay','$product_details.expiry_date','$room','to_prod_isle','/barcode_scanner','$isAllowEdit','<html><head><title></title>','max_per_unit','$product.to_room_name','findById','to_types','Enabled','10dVrIlL','findOne','edit_transfer_view','product_code','to_prod_qty','from_types','staff','slice','from_bay','$product_details.level','$to_warehouse','product_code3','warehouse','product_stock','padStart','$product_details.bay','to_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','from_invoice','from_warehouse','/preview/:id','$product_details.secondary_unit','product_details','role','ToRoomAssigned','transfer','DRY\x20STORAGE','/barcode_scanner2','\x20Order\x20Number\x20:\x20','Floor','Ambient','Rack\x20B','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','json','$product_details.floorlevel','prod_cat','<h5\x20style=\x22text-align:\x20left;\x22>','message','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.product_code','$name','$product_details.product_name','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</head><body>','</table>','type','string','RMSEmail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','express','redirect','Receiving\x20Area','maxperunit','edit_transfer','English\x20(US)','66oVRnEi','153zdVdqe','Hindi','Level','post','153546pNMvDk','image','<hr\x20class=\x22my-3\x22>','../models/all_models','69728RJwjqx','product_name','1585226cVZXxv','Error\x20Occurs','error','$_id','$date','all','Rack\x20E','<h5>','English','Rack\x20A','rack','body','/view','$product_details.production_date','sendMail','from_bin','getFullYear','Portuguese\x20(BR)','email','_id','54545601ApKubo','params','<div>','MaxStocks_data2','5762430IneXqV','Raw\x20Materials','French'];a0_0x4186=function(){return _0x4cc31f;};return a0_0x4186();}function BayBinSelected(_0x5199f3,_0x5bf84c){var _0x500321=a0_0x39b899,_0x315865=[],_0x46a9d0=[],_0x5aeff6=[],_0x567a6c=[],_0x13015b=[],_0x11921a=[];let _0x277759=[];if(_0x5199f3==_0x500321(0x1dc))switch(_0x5bf84c){case _0x500321(0x20d):_0x315865=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x46a9d0=[0x1,0x2],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=[_0x500321(0x1fc),'Floor'],_0x13015b=['D'],_0x11921a=['A'];break;case _0x500321(0x1e1):_0x315865=[0x6,0x5,0x4,0x3,0x2,0x1],_0x46a9d0=[0x1,0x2],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=[_0x500321(0x1fc),_0x500321(0x1df)],_0x13015b=['D'],_0x11921a=['B'];break;case _0x500321(0x221):_0x315865=[0x0],_0x46a9d0=[0x0],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=['Floor'],_0x13015b=['D'],_0x11921a=['S'];break;case _0x500321(0x1f5):_0x315865=[0x0],_0x46a9d0=[0x0],_0x567a6c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5aeff6=[_0x500321(0x1df)],_0x13015b=['D'],_0x11921a=['R'];break;}else{if(_0x5199f3=='COLD\x20STORAGE')switch(_0x5bf84c){case _0x500321(0x20d):_0x315865=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x46a9d0=['B','F'],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=[_0x500321(0x1fc),_0x500321(0x1df)],_0x13015b=['C'],_0x11921a=['A'];break;case _0x500321(0x1e1):_0x315865=[0x5,0x4,0x3,0x2,0x1],_0x46a9d0=['F','B','S'],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=[_0x500321(0x1fc),_0x500321(0x1df)],_0x13015b=['C'],_0x11921a=['B'];break;case _0x500321(0x265):_0x315865=[0x1,0x2,0x3,0x4,0x5],_0x46a9d0=['B','F','S'],_0x567a6c=[0x5,0x4,0x3,0x2,0x1],_0x5aeff6=[_0x500321(0x1fc),_0x500321(0x1df)],_0x13015b=['C'],_0x11921a=['C'];break;case'Rack\x20D':_0x315865=[0x5,0x4,0x3,0x2,0x1],_0x46a9d0=['F','B','S'],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=[_0x500321(0x1fc),_0x500321(0x1df)],_0x13015b=['C'],_0x11921a=['D'];break;case _0x500321(0x20a):_0x315865=[0x4,0x3,0x2,0x1],_0x46a9d0=[0x1,0x2],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=['Level',_0x500321(0x1df)],_0x13015b=['C'],_0x11921a=['E'];break;case _0x500321(0x22f):_0x315865=[0x1,0x2,0x3],_0x46a9d0=[0x1,0x2],_0x567a6c=[0x1,0x2,0x3,0x4,0x5],_0x5aeff6=[_0x500321(0x1fc)],_0x13015b=['C'],_0x11921a=['F'];break;}}return{'levels':_0x315865,'Isle':_0x46a9d0,'rack':_0x567a6c,'type':_0x5aeff6,'storage':_0x13015b,'rak':_0x11921a};}router['get'](a0_0x39b899(0x280),auth,async(_0xe876c3,_0x44f619)=>{var _0x598138=a0_0x39b899;try{const {username:_0x5645b6,email:_0x308723,role:_0x571461}=_0xe876c3[_0x598138(0x2a9)],_0x38d3b6=_0xe876c3[_0x598138(0x2a9)],_0x4cc835=await profile[_0x598138(0x1c3)]({'email':_0x38d3b6[_0x598138(0x216)]}),_0x39f3df=await master_shop[_0x598138(0x24b)](),_0x26aa86=await transfers[_0x598138(0x1bf)](_0xe876c3[_0x598138(0x219)]['id']);let _0x529cce;if(_0x38d3b6[_0x598138(0x1d9)]==_0x598138(0x1c8)){const _0x3c638d=await staff[_0x598138(0x1c3)]({'email':_0x38d3b6[_0x598138(0x216)]});_0x529cce=await warehouse[_0x598138(0x27f)]([{'$match':{'status':'Enabled','name':_0x3c638d[_0x598138(0x1ce)],'warehouse_category':_0x598138(0x21d)}},{'$group':{'_id':'$name','name':{'$first':_0x598138(0x1ea)}}}]);}else _0x529cce=await warehouse['aggregate']([{'$match':{'status':_0x598138(0x1c1),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x598138(0x1ea),'name':{'$first':'$name'}}}]);const _0x23de62=await warehouse['aggregate']([{'$match':{'name':_0x26aa86[_0x598138(0x1d5)],'warehouse_category':_0x598138(0x21d)}},{'$unwind':_0x598138(0x240)},{'$group':{'_id':_0x598138(0x26d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x598138(0x23a)},'bay':{'$first':_0x598138(0x1d1)},'bin':{'$first':_0x598138(0x233)},'type':{'$first':_0x598138(0x27b)},'floorlevel':{'$first':_0x598138(0x1e4)},'primary_code':{'$first':_0x598138(0x24d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x598138(0x1e9)},'storage':{'$first':_0x598138(0x252)},'rack':{'$first':_0x598138(0x26c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x598138(0x211)},'room':{'$first':_0x598138(0x2ae)}}}]),_0x37ad89=await product[_0x598138(0x24b)]({}),_0x3ef928=BayBinSelected(_0x26aa86[_0x598138(0x255)],_0x26aa86[_0x598138(0x299)]);if(_0x39f3df[0x0][_0x598138(0x288)]==_0x598138(0x1f8)){var _0xfd98f2=users['English'];console[_0x598138(0x247)](_0xfd98f2);}else{if(_0x39f3df[0x0][_0x598138(0x288)]==_0x598138(0x1fb))var _0xfd98f2=users[_0x598138(0x1fb)];else{if(_0x39f3df[0x0][_0x598138(0x288)]==_0x598138(0x283))var _0xfd98f2=users[_0x598138(0x283)];else{if(_0x39f3df[0x0][_0x598138(0x288)]==_0x598138(0x266))var _0xfd98f2=users[_0x598138(0x266)];else{if(_0x39f3df[0x0][_0x598138(0x288)]=='French')var _0xfd98f2=users[_0x598138(0x21e)];else{if(_0x39f3df[0x0][_0x598138(0x288)]=='Portuguese\x20(BR)')var _0xfd98f2=users['Portuguese'];else{if(_0x39f3df[0x0][_0x598138(0x288)]=='Chinese')var _0xfd98f2=users[_0x598138(0x285)];else{if(_0x39f3df[0x0]['language']=='Arabic\x20(ae)')var _0xfd98f2=users[_0x598138(0x22a)];}}}}}}}_0x44f619[_0x598138(0x2a2)](_0x598138(0x1f7),{'success':_0xe876c3[_0x598138(0x28d)](_0x598138(0x25b)),'errors':_0xe876c3['flash']('errors'),'role':_0x38d3b6,'profile':_0x4cc835,'master_shop':_0x39f3df,'warehouse':_0x529cce,'transfer':_0x26aa86,'stock':_0x23de62,'unit':_0x37ad89,'language':_0xfd98f2});}catch(_0x7a3e2d){console[_0x598138(0x247)](_0x7a3e2d);}}),router[a0_0x39b899(0x1fd)](a0_0x39b899(0x280),auth,async(_0x36f90e,_0x25589c)=>{var _0x502a72=a0_0x39b899;try{const _0xd50215=_0x36f90e[_0x502a72(0x219)]['id'],_0x14445b=await transfers[_0x502a72(0x1bf)](_0xd50215);_0x25589c[_0x502a72(0x1e3)](_0x36f90e[_0x502a72(0x20f)]);return;const {date:_0xa59362,from_warehouse:_0x5c30d3,FromRoom_name:_0x500703,to_warehouse:_0x200b60,ToRoom_name:_0x4d7b44,prod_name:_0x111c43,from_prod_qty:_0x385646,from_prod_level:_0x182a5a,from_prod_isle:_0x2e7723,from_prod_pallet:_0x45b082,to_prod_qty:_0x2d9f62,to_prod_level:_0x323dfa,to_prod_isle:_0x5b02aa,to_prod_pallet:_0x51b0d3,primary_code:_0x5c9114,secondary_code:_0x422836,product_code3:_0x4bf708,note:_0x33fb5e,invoice:_0x5a5293,expiry_date:_0xe2be38}=_0x36f90e[_0x502a72(0x20f)];if(typeof _0x111c43=='string')var _0x4835c0=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x250)]],_0x1f9687=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x290)]],_0x1447e8=[_0x36f90e[_0x502a72(0x20f)]['from_prod_level']],_0xfb8efd=[_0x36f90e['body']['from_prod_isle']],_0x4f42d7=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x2a7)]],_0x2a3412=[_0x36f90e['body'][_0x502a72(0x1c7)]],_0xb1527d=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x1c6)]],_0x4017b2=[_0x36f90e[_0x502a72(0x20f)]['to_prod_level']],_0x29fe2c=[_0x36f90e[_0x502a72(0x20f)]['to_prod_isle']],_0x1291d9=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x271)]],_0x3b88ef=[_0x36f90e['body'][_0x502a72(0x1c0)]],_0x6eb58=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x23f)]],_0x201a01=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x244)]],_0x1940a1=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x2a3)]],_0x44c1d8=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x25a)]],_0x3fdb69=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x1cd)]],_0x421a31=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x21b)]],_0x335e46=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x291)]],_0x20fe4f=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x226)]],_0x4cdf75=[_0x36f90e['body'][_0x502a72(0x287)]],_0x53ff10=[_0x36f90e['body'][_0x502a72(0x29c)]],_0x1200ef=[_0x36f90e[_0x502a72(0x20f)]['from_storage']],_0x62da1f=[_0x36f90e[_0x502a72(0x20f)][_0x502a72(0x256)]];else var _0x4835c0=[..._0x36f90e[_0x502a72(0x20f)]['prod_name']],_0x6eb58=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x23f)]],_0x201a01=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x244)]],_0x2a3412=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x1c7)]],_0x3b88ef=[..._0x36f90e['body'][_0x502a72(0x1c0)]],_0x1f9687=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x290)]],_0x1447e8=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x24f)]],_0xfb8efd=[..._0x36f90e['body'][_0x502a72(0x279)]],_0x4f42d7=[..._0x36f90e[_0x502a72(0x20f)]['from_prod_pallet']],_0xb1527d=[..._0x36f90e[_0x502a72(0x20f)]['to_prod_qty']],_0x4017b2=[..._0x36f90e[_0x502a72(0x20f)]['to_prod_level']],_0x29fe2c=[..._0x36f90e['body'][_0x502a72(0x2af)]],_0x1291d9=[..._0x36f90e['body'][_0x502a72(0x271)]],_0x1940a1=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x2a3)]],_0x44c1d8=[..._0x36f90e[_0x502a72(0x20f)]['secondary_code']],_0x3fdb69=[..._0x36f90e['body'][_0x502a72(0x1cd)]],_0x421a31=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x21b)]],_0x335e46=[..._0x36f90e['body']['unit']],_0x20fe4f=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x226)]],_0x4cdf75=[..._0x36f90e['body'][_0x502a72(0x287)]],_0x53ff10=[..._0x36f90e[_0x502a72(0x20f)]['expiry_date']],_0x1200ef=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x235)]],_0x62da1f=[..._0x36f90e[_0x502a72(0x20f)][_0x502a72(0x256)]];const _0x1afc6f=_0x4835c0[_0x502a72(0x28c)](_0x4d4cf4=>{return _0x4d4cf4={'product_name':_0x4d4cf4};});_0x1f9687['forEach']((_0x121c9d,_0x293d6e)=>{var _0xf010fe=_0x502a72;_0x1afc6f[_0x293d6e][_0xf010fe(0x22c)]=_0x121c9d;}),_0x1447e8[_0x502a72(0x269)]((_0x3b3a58,_0x507c52)=>{var _0x90b5a8=_0x502a72;_0x1afc6f[_0x507c52][_0x90b5a8(0x1ca)]=_0x3b3a58;}),_0xfb8efd['forEach']((_0x1832a2,_0x2a5e5c)=>{_0x1afc6f[_0x2a5e5c]['from_bin']=_0x1832a2;}),_0x4f42d7[_0x502a72(0x269)]((_0x2292b2,_0x184a76)=>{_0x1afc6f[_0x184a76]['from_floorlevel']=_0x2292b2;}),_0xb1527d[_0x502a72(0x269)]((_0x13c8a7,_0x5fb767)=>{var _0xa613b5=_0x502a72;_0x1afc6f[_0x5fb767][_0xa613b5(0x249)]=_0x13c8a7;}),_0x4017b2[_0x502a72(0x269)]((_0x4b4003,_0x3cdbe0)=>{_0x1afc6f[_0x3cdbe0]['to_bay']=_0x4b4003;}),_0x29fe2c[_0x502a72(0x269)]((_0xcafb3c,_0x2d8c4d)=>{var _0x17bcd1=_0x502a72;_0x1afc6f[_0x2d8c4d][_0x17bcd1(0x2ab)]=_0xcafb3c;}),_0x1291d9[_0x502a72(0x269)]((_0x1f5ae5,_0x4a7729)=>{var _0x4e1a10=_0x502a72;_0x1afc6f[_0x4a7729][_0x4e1a10(0x228)]=_0x1f5ae5;}),_0x1940a1['forEach']((_0x23b719,_0x47caac)=>{var _0x60fa2f=_0x502a72;_0x1afc6f[_0x47caac][_0x60fa2f(0x2a3)]=_0x23b719;}),_0x44c1d8[_0x502a72(0x269)]((_0x507081,_0x331850)=>{var _0x5dca4c=_0x502a72;_0x1afc6f[_0x331850][_0x5dca4c(0x25a)]=_0x507081;}),_0x3fdb69[_0x502a72(0x269)]((_0x1f54ad,_0x3c5b88)=>{var _0x50022f=_0x502a72;_0x1afc6f[_0x3c5b88][_0x50022f(0x1c5)]=_0x1f54ad;}),_0x421a31[_0x502a72(0x269)]((_0x419fc0,_0x475c7d)=>{_0x1afc6f[_0x475c7d]['maxProducts']=_0x419fc0;}),_0x335e46['forEach']((_0x10bef8,_0x159798)=>{var _0x3f90d1=_0x502a72;_0x1afc6f[_0x159798][_0x3f90d1(0x291)]=_0x10bef8;}),_0x20fe4f[_0x502a72(0x269)]((_0x27f7e7,_0x12ae44)=>{var _0x10e7d7=_0x502a72;_0x1afc6f[_0x12ae44][_0x10e7d7(0x226)]=_0x27f7e7;}),_0x4cdf75[_0x502a72(0x269)]((_0x1d311d,_0x5437ef)=>{var _0x284e70=_0x502a72;_0x1afc6f[_0x5437ef][_0x284e70(0x287)]=_0x1d311d;}),_0x53ff10['forEach']((_0x4bd33a,_0x2d3066)=>{var _0x59acf6=_0x502a72;_0x1afc6f[_0x2d3066][_0x59acf6(0x29c)]=_0x4bd33a;}),_0x6eb58[_0x502a72(0x269)]((_0x48db93,_0x2a9e27)=>{var _0x36098f=_0x502a72;_0x1afc6f[_0x2a9e27][_0x36098f(0x23f)]=_0x48db93;}),_0x201a01[_0x502a72(0x269)]((_0x5486f1,_0x36e1b4)=>{_0x1afc6f[_0x36e1b4]['rack']=_0x5486f1;}),_0x2a3412['forEach']((_0x2f3bc4,_0x39c1b1)=>{var _0x973a46=_0x502a72;_0x1afc6f[_0x39c1b1][_0x973a46(0x1c7)]=_0x2f3bc4;}),_0x3b88ef[_0x502a72(0x269)]((_0x315aec,_0x22fb49)=>{var _0x33123f=_0x502a72;_0x1afc6f[_0x22fb49][_0x33123f(0x1c0)]=_0x315aec;}),_0x1200ef['forEach']((_0x386876,_0x20ebd9)=>{var _0x5a9508=_0x502a72;_0x1afc6f[_0x20ebd9][_0x5a9508(0x235)]=_0x386876;}),_0x62da1f[_0x502a72(0x269)]((_0x354d75,_0x554423)=>{_0x1afc6f[_0x554423]['from_rack']=_0x354d75;});const _0x45743c=_0x1afc6f['filter'](_0x38435d=>_0x38435d['to_quantity']!=='0'&&_0x38435d[_0x502a72(0x249)]!==''||_0x38435d[_0x502a72(0x228)]!=='0'&&_0x38435d[_0x502a72(0x228)]!=='');var _0x2cb70b=0x0;_0x45743c[_0x502a72(0x269)](_0x5a95bb=>{var _0xa33dc0=_0x502a72;parseInt(_0x5a95bb[_0xa33dc0(0x22c)])<parseInt(_0x5a95bb[_0xa33dc0(0x249)])&&_0x2cb70b++;});if(_0x2cb70b!=0x0)return _0x36f90e[_0x502a72(0x28d)]('errors',_0x502a72(0x262)),_0x25589c['redirect'](_0x502a72(0x259));const _0x5435bd=await warehouse['findOne']({'name':_0x14445b[_0x502a72(0x1d5)],'room':_0x14445b['from_room']});_0x14445b[_0x502a72(0x2a1)][_0x502a72(0x269)](_0x3b574e=>{var _0x4d042a=_0x502a72;if(_0x3b574e[_0x4d042a(0x249)]>0x0){const _0x40a438=_0x5435bd[_0x4d042a(0x1d8)][_0x4d042a(0x28c)](_0x5100e5=>{var _0x502e8f=_0x4d042a;_0x5100e5[_0x502e8f(0x203)]==_0x3b574e[_0x502e8f(0x203)]&&_0x5100e5['floorlevel']==_0x3b574e[_0x502e8f(0x23c)]&&_0x5100e5[_0x502e8f(0x1ef)]==_0x3b574e[_0x502e8f(0x1c7)]&&_0x5100e5[_0x502e8f(0x26f)]==_0x3b574e[_0x502e8f(0x213)]&&_0x5100e5['bay']==_0x3b574e['from_bay']&&_0x5100e5[_0x502e8f(0x20e)]==_0x3b574e[_0x502e8f(0x28f)]&&_0x5100e5[_0x502e8f(0x23f)]==_0x3b574e['from_storage']&&(_0x5100e5[_0x502e8f(0x1cf)]=parseInt(_0x5100e5['product_stock'])+parseInt(_0x3b574e[_0x502e8f(0x249)]));});}}),await _0x5435bd['save']();const _0x584649=await warehouse[_0x502a72(0x1c3)]({'name':_0x14445b['to_warehouse'],'room':_0x14445b[_0x502a72(0x299)]});_0x14445b[_0x502a72(0x2a1)][_0x502a72(0x269)](_0x42f245=>{var _0x4a22e6=_0x502a72;if(_0x42f245[_0x4a22e6(0x249)]>0x0){const _0x50020b=_0x584649['product_details'][_0x4a22e6(0x28c)](_0x30a637=>{var _0x12f434=_0x4a22e6;_0x30a637[_0x12f434(0x203)]==_0x42f245[_0x12f434(0x203)]&&_0x30a637[_0x12f434(0x229)]==_0x42f245[_0x12f434(0x228)]&&_0x30a637[_0x12f434(0x1ef)]==_0x42f245[_0x12f434(0x1c0)]&&_0x30a637[_0x12f434(0x26f)]==_0x42f245[_0x12f434(0x2ab)]&&_0x30a637[_0x12f434(0x2ac)]==_0x42f245['to_bay']&&_0x30a637[_0x12f434(0x20e)]==_0x42f245[_0x12f434(0x20e)]&&_0x30a637[_0x12f434(0x23f)]==_0x42f245['storage']&&(_0x30a637['product_stock']=parseInt(_0x30a637[_0x12f434(0x1cf)])-parseInt(_0x42f245['to_quantity']));});}}),await _0x584649[_0x502a72(0x29a)](),_0x14445b[_0x502a72(0x264)]=_0xa59362,_0x14445b['from_warehouse']=_0x5c30d3,_0x14445b['to_warehouse']=_0x200b60,_0x14445b[_0x502a72(0x2a1)]=_0x45743c,_0x14445b[_0x502a72(0x246)]=_0x33fb5e,_0x14445b['invoice']=_0x5a5293;const _0x476a91=await _0x14445b['save']();console['log'](_0x476a91);const _0x1bf5cf=await warehouse['findOne']({'name':_0x5c30d3,'room':_0x500703});_0x476a91[_0x502a72(0x2a1)]['forEach'](_0xbcaa15=>{var _0x275b6c=_0x502a72;if(_0xbcaa15[_0x275b6c(0x249)]>0x0){const _0xf5288c=_0x1bf5cf[_0x275b6c(0x1d8)][_0x275b6c(0x28c)](_0x3de271=>{var _0x43aa66=_0x275b6c;_0x3de271['product_name']==_0xbcaa15['product_name']&&_0x3de271[_0x43aa66(0x229)]==_0xbcaa15[_0x43aa66(0x23c)]&&_0x3de271['type']==_0xbcaa15[_0x43aa66(0x1c7)]&&_0x3de271[_0x43aa66(0x26f)]==_0xbcaa15[_0x43aa66(0x213)]&&_0x3de271['bay']==_0xbcaa15[_0x43aa66(0x1ca)]&&_0x3de271[_0x43aa66(0x20e)]==_0xbcaa15[_0x43aa66(0x28f)]&&_0x3de271[_0x43aa66(0x23f)]==_0xbcaa15['from_storage']&&(_0x3de271[_0x43aa66(0x1cf)]=parseInt(_0x3de271[_0x43aa66(0x1cf)])-parseInt(_0xbcaa15[_0x43aa66(0x249)]));});}}),await _0x1bf5cf['save']();const _0xdf7dfe=await warehouse[_0x502a72(0x1c3)]({'name':_0x200b60,'room':_0x4d7b44});_0x476a91['product']['forEach'](_0x394ef0=>{var _0x12a0ee=_0x502a72;if(_0x394ef0[_0x12a0ee(0x249)]>0x0){var _0x23274d=0x0;const _0x14eaef=_0xdf7dfe[_0x12a0ee(0x1d8)][_0x12a0ee(0x28c)](_0x4c1061=>{var _0x3c11b3=_0x12a0ee;_0x4c1061[_0x3c11b3(0x203)]==_0x394ef0[_0x3c11b3(0x203)]&&_0x4c1061['floorlevel']==_0x394ef0[_0x3c11b3(0x228)]&&_0x4c1061[_0x3c11b3(0x1ef)]==_0x394ef0[_0x3c11b3(0x1c0)]&&_0x4c1061[_0x3c11b3(0x26f)]==_0x394ef0['to_bin']&&_0x4c1061[_0x3c11b3(0x2ac)]==_0x394ef0[_0x3c11b3(0x1d2)]&&_0x4c1061[_0x3c11b3(0x20e)]==_0x394ef0[_0x3c11b3(0x20e)]&&_0x4c1061[_0x3c11b3(0x23f)]==_0x394ef0[_0x3c11b3(0x23f)]&&(_0x4c1061[_0x3c11b3(0x1cf)]=parseInt(_0x4c1061['product_stock'])+parseInt(_0x394ef0[_0x3c11b3(0x249)]),_0x23274d++);});_0x23274d=='0'&&(_0xdf7dfe[_0x12a0ee(0x1d8)]=_0xdf7dfe[_0x12a0ee(0x1d8)][_0x12a0ee(0x23b)]({'product_name':_0x394ef0[_0x12a0ee(0x203)],'product_stock':_0x394ef0[_0x12a0ee(0x249)],'bay':_0x394ef0['to_bay'],'bin':_0x394ef0['to_bin'],'type':_0x394ef0[_0x12a0ee(0x1c0)],'floorlevel':_0x394ef0[_0x12a0ee(0x228)],'storage':_0x394ef0[_0x12a0ee(0x23f)],'rack':_0x394ef0[_0x12a0ee(0x20e)],'product_code':_0x394ef0[_0x12a0ee(0x1c5)],'primary_code':_0x394ef0['primary_code'],'secondary_code':_0x394ef0[_0x12a0ee(0x25a)],'maxProducts':_0x394ef0[_0x12a0ee(0x24e)],'storage':_0x394ef0['storage'],'rack':_0x394ef0[_0x12a0ee(0x20e)]}));}}),await _0xdf7dfe[_0x502a72(0x29a)](),_0x36f90e[_0x502a72(0x28d)](_0x502a72(0x25b),_0x502a72(0x284)),_0x25589c['redirect'](_0x502a72(0x28e));}catch(_0x331fbf){console[_0x502a72(0x247)](_0x331fbf);}}),router['post'](a0_0x39b899(0x2b0),async(_0x42199b,_0x1bd780)=>{var _0x46396b=a0_0x39b899;const {FromWareHouse:_0x52c625,FromRoom:_0x5ba34a,ToWarehouse:_0x1c236c,ToRoom:_0x32aba4,primary_code:_0x1332be,Roomslist:_0x5e00d4}=_0x42199b['body'],_0x51d6fe=_0x5e00d4['split'](','),_0x169951=[];async function _0x4f3020(_0x14c600){var _0x598a82=a0_0x3b50;const _0x39bc81=await warehouse['aggregate']([{'$match':{'name':_0x52c625,'room':_0x14c600}},{'$unwind':_0x598a82(0x240)},{'$match':{'product_details.primary_code':_0x1332be}},{'$group':{'_id':_0x598a82(0x26d),'name':{'$first':_0x598a82(0x1eb)},'instock':{'$first':_0x598a82(0x23a)},'primary_code':{'$first':_0x598a82(0x24d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x598a82(0x1e9)},'level':{'$first':_0x598a82(0x1d1)},'isle':{'$first':_0x598a82(0x233)},'type':{'$first':_0x598a82(0x27b)},'pallet':{'$first':_0x598a82(0x1e4)},'unit':{'$first':_0x598a82(0x2a5)},'secondary_unit':{'$first':_0x598a82(0x1d7)},'storage':{'$first':_0x598a82(0x252)},'rack':{'$first':_0x598a82(0x26c)},'expiry_date':{'$first':_0x598a82(0x2ad)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x598a82(0x267)},'maxPerUnit':{'$first':_0x598a82(0x29d)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x598a82(0x2ae)},'maxProducts':{'$first':_0x598a82(0x2aa)}}}]),_0x34c2d7=await warehouse[_0x598a82(0x27f)]([{'$match':{'name':_0x52c625,'room':_0x14c600}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x1332be}},{'$group':{'_id':_0x598a82(0x26d),'name':{'$first':_0x598a82(0x1eb)},'instock':{'$first':_0x598a82(0x23a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x598a82(0x230)},'product_code':{'$first':_0x598a82(0x1e9)},'level':{'$first':_0x598a82(0x1d1)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x598a82(0x27b)},'pallet':{'$first':_0x598a82(0x1e4)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x598a82(0x1d7)},'storage':{'$first':_0x598a82(0x252)},'rack':{'$first':_0x598a82(0x26c)},'expiry_date':{'$first':_0x598a82(0x2ad)},'production_date':{'$first':_0x598a82(0x211)},'batch_code':{'$first':_0x598a82(0x267)},'maxPerUnit':{'$first':_0x598a82(0x29d)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x598a82(0x2aa)}}}]);if(_0x39bc81['length']>0x0)_0x169951[_0x598a82(0x248)](_0x39bc81);else _0x34c2d7[_0x598a82(0x293)]>0x0&&_0x169951[_0x598a82(0x248)](_0x34c2d7);}const _0x30033c=_0x51d6fe[_0x46396b(0x28c)](_0x3befdb=>_0x4f3020(_0x3befdb));await Promise[_0x46396b(0x209)](_0x30033c),_0x1bd780[_0x46396b(0x1e3)](_0x169951);}),router[a0_0x39b899(0x1fd)](a0_0x39b899(0x1dd),async(_0x14dcf3,_0x230f84)=>{var _0x386fdc=a0_0x39b899;try{const {FromWareHouse:_0x4809a5,FromRoom:_0x160695,ToWarehouse:_0x3a2183,ToRoom:_0x10e314,secondary_code:_0x13db67}=_0x14dcf3[_0x386fdc(0x20f)],_0x3b823c=await warehouse[_0x386fdc(0x27f)]([{'$match':{'name':_0x4809a5}},{'$unwind':_0x386fdc(0x240)},{'$match':{'product_details.secondary_code':_0x13db67}},{'$group':{'_id':_0x386fdc(0x26d),'name':{'$first':_0x386fdc(0x1eb)},'primary_code':{'$first':_0x386fdc(0x24d)},'secondary_code':{'$first':_0x386fdc(0x230)},'product_code':{'$first':_0x386fdc(0x1e9)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x386fdc(0x1ea)},'level':{'$first':_0x386fdc(0x1cb)},'isle':{'$first':_0x386fdc(0x227)},'pallet':{'$first':_0x386fdc(0x24a)},'maxProducts':{'$first':_0x386fdc(0x2aa)},'unit':{'$first':'$product_details.unit'}}}]);_0x230f84[_0x386fdc(0x258)](0xc8)[_0x386fdc(0x1e3)](_0x3b823c);}catch(_0x1faeaa){_0x230f84['status'](0x194)[_0x386fdc(0x1e3)]({'message':_0x1faeaa[_0x386fdc(0x1e7)]});}}),router[a0_0x39b899(0x1fd)]('/barcode_scanner3',async(_0x257d9a,_0x5edd48)=>{var _0x2bc6f7=a0_0x39b899;try{const {FromWareHouse:_0x5665a3,FromRoom:_0x2ac614,ToWarehouse:_0x4014d4,ToRoom:_0x402f53,product_code:_0xbb43c6}=_0x257d9a['body'],_0x37ccb1=await warehouse[_0x2bc6f7(0x27f)]([{'$match':{'name':_0x5665a3}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0xbb43c6}},{'$group':{'_id':_0x2bc6f7(0x26d),'name':{'$first':_0x2bc6f7(0x1eb)},'primary_code':{'$first':_0x2bc6f7(0x24d)},'secondary_code':{'$first':_0x2bc6f7(0x230)},'product_code':{'$first':_0x2bc6f7(0x1e9)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x2bc6f7(0x1cb)},'isle':{'$first':_0x2bc6f7(0x227)},'pallet':{'$first':_0x2bc6f7(0x24a)},'maxProducts':{'$first':_0x2bc6f7(0x2aa)},'unit':{'$first':_0x2bc6f7(0x2a5)}}}]);_0x5edd48[_0x2bc6f7(0x258)](0xc8)[_0x2bc6f7(0x1e3)](_0x37ccb1);}catch(_0xcd5223){_0x5edd48[_0x2bc6f7(0x258)](0x194)[_0x2bc6f7(0x1e3)]({'message':_0xcd5223['message']});}}),router[a0_0x39b899(0x1fd)]('/CheckingWarehouse',async(_0x3e8411,_0x2ab369)=>{var _0x3ef3f6=a0_0x39b899;const {level:_0x6c6740,isle:_0xba046c,pallet:_0x51584e,warehouses:_0x4fae43,room:_0x2609a9}=_0x3e8411[_0x3ef3f6(0x20f)];try{const _0x42bec5=await warehouse['aggregate']([{'$match':{'name':_0x4fae43,'room':_0x2609a9}},{'$unwind':_0x3ef3f6(0x240)},{'$match':{'product_details.level':parseInt(_0x6c6740),'product_details.isle':_0xba046c,'product_details.pallet':parseInt(_0x51584e)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3ef3f6(0x1eb)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x3ef3f6(0x1cb)},'isle':{'$first':_0x3ef3f6(0x227)},'pallet':{'$first':_0x3ef3f6(0x24a)},'maxProducts':{'$first':_0x3ef3f6(0x2aa)}}}]);_0x2ab369[_0x3ef3f6(0x258)](0xc8)[_0x3ef3f6(0x1e3)](_0x42bec5);}catch(_0x260ae7){_0x2ab369[_0x3ef3f6(0x258)](0x194)[_0x3ef3f6(0x1e3)]({'message':_0x260ae7[_0x3ef3f6(0x1e7)]});}}),module[a0_0x39b899(0x277)]=router;