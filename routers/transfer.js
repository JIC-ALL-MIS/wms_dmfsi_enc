var a0_0xf7b6e9=a0_0x2cb4;(function(_0x4c69b8,_0x24a686){var _0x46f41c=a0_0x2cb4,_0x19e607=_0x4c69b8();while(!![]){try{var _0x27089e=-parseInt(_0x46f41c(0x195))/0x1*(-parseInt(_0x46f41c(0x1d5))/0x2)+parseInt(_0x46f41c(0x178))/0x3+parseInt(_0x46f41c(0x1ba))/0x4*(parseInt(_0x46f41c(0x1c5))/0x5)+-parseInt(_0x46f41c(0x1ec))/0x6+parseInt(_0x46f41c(0x126))/0x7*(-parseInt(_0x46f41c(0x14b))/0x8)+-parseInt(_0x46f41c(0x192))/0x9*(parseInt(_0x46f41c(0x1bc))/0xa)+parseInt(_0x46f41c(0x170))/0xb*(-parseInt(_0x46f41c(0x1e2))/0xc);if(_0x27089e===_0x24a686)break;else _0x19e607['push'](_0x19e607['shift']());}catch(_0x36761e){_0x19e607['push'](_0x19e607['shift']());}}}(a0_0x2d46,0xd20dd));const express=require('express'),app=express(),router=express[a0_0xf7b6e9(0x128)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0xf7b6e9(0x1c4)),auth=require(a0_0xf7b6e9(0x159)),users=require(a0_0xf7b6e9(0x13e)),nodemailer=require('nodemailer');router[a0_0xf7b6e9(0x1e8)]('/view',auth,async(_0x3914fa,_0x196067)=>{var _0x5e94d7=a0_0xf7b6e9;try{const {username:_0x1faf30,email:_0x5db835,role:_0x42bb08}=_0x3914fa[_0x5e94d7(0x1e3)],_0x37b8f9=_0x3914fa[_0x5e94d7(0x1e3)],_0x354c60=await profile[_0x5e94d7(0x1a2)]({'email':_0x37b8f9[_0x5e94d7(0x1b3)]}),_0x4839e3=await master_shop[_0x5e94d7(0x1d6)]();console[_0x5e94d7(0x172)](_0x5e94d7(0x147),_0x4839e3);let _0x5ab825;if(_0x37b8f9['role']==_0x5e94d7(0x208)){const _0x33fb53=await staff[_0x5e94d7(0x1a2)]({'email':_0x37b8f9[_0x5e94d7(0x1b3)]});_0x5ab825=await transfers[_0x5e94d7(0x1d6)]({'from_warehouse':_0x33fb53['warehouse']});}else _0x5ab825=await transfers[_0x5e94d7(0x15f)]([{'$unwind':'$product'},{'$group':{'_id':_0x5e94d7(0x17c),'invoice':{'$first':_0x5e94d7(0x1d0)},'date':{'$first':_0x5e94d7(0x1f4)},'from_warehouse':{'$first':_0x5e94d7(0x152)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x5e94d7(0x186)},'finalize':{'$first':_0x5e94d7(0x14e)},'isAllowEdit':{'$first':_0x5e94d7(0x1b8)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4839e3[0x0][_0x5e94d7(0x1cd)]==_0x5e94d7(0x1d1)){var _0x1401f7=users[_0x5e94d7(0x15e)];console[_0x5e94d7(0x172)](_0x1401f7);}else{if(_0x4839e3[0x0]['language']==_0x5e94d7(0x187))var _0x1401f7=users[_0x5e94d7(0x187)];else{if(_0x4839e3[0x0][_0x5e94d7(0x1cd)]==_0x5e94d7(0x184))var _0x1401f7=users[_0x5e94d7(0x184)];else{if(_0x4839e3[0x0][_0x5e94d7(0x1cd)]=='Spanish')var _0x1401f7=users['Spanish'];else{if(_0x4839e3[0x0][_0x5e94d7(0x1cd)]==_0x5e94d7(0x14f))var _0x1401f7=users[_0x5e94d7(0x14f)];else{if(_0x4839e3[0x0][_0x5e94d7(0x1cd)]==_0x5e94d7(0x182))var _0x1401f7=users['Portuguese'];else{if(_0x4839e3[0x0][_0x5e94d7(0x1cd)]==_0x5e94d7(0x158))var _0x1401f7=users[_0x5e94d7(0x158)];else{if(_0x4839e3[0x0][_0x5e94d7(0x1cd)]==_0x5e94d7(0x1c1))var _0x1401f7=users['Arabic'];}}}}}}}_0x196067[_0x5e94d7(0x154)]('transfer',{'success':_0x3914fa['flash'](_0x5e94d7(0x1af)),'errors':_0x3914fa['flash']('errors'),'role':_0x37b8f9,'profile':_0x354c60,'master_shop':_0x4839e3,'transfer':_0x5ab825,'language':_0x1401f7});}catch(_0x4651c2){console['log'](_0x4651c2);}});async function getRandom8DigitNumber(){var _0x426e1c=a0_0xf7b6e9;const _0x3f6586=0x989680,_0x3f21d8=0x5f5e0ff,_0x24c934=Math[_0x426e1c(0x15d)](Math[_0x426e1c(0x12a)]()*(_0x3f21d8-_0x3f6586+0x1))+_0x3f6586;var _0x2b4600;const _0x4f7896=await transfers[_0x426e1c(0x1a2)]({'invoice':_0x426e1c(0x168)+_0x24c934});return _0x4f7896&&_0x4f7896[_0x426e1c(0x12f)]>0x0?_0x2b4600=_0x426e1c(0x168)+_0x24c934:_0x2b4600='TRF-'+_0x24c934,_0x2b4600;}router[a0_0xf7b6e9(0x1e8)](a0_0xf7b6e9(0x1cf),auth,async(_0x2972b9,_0x5410dd)=>{var _0x477ac0=a0_0xf7b6e9;try{const {username:_0x1f5aca,email:_0x43044a,role:_0x656bf8}=_0x2972b9['user'],_0x51fd77=_0x2972b9[_0x477ac0(0x1e3)],_0x24e8bf=await profile[_0x477ac0(0x1a2)]({'email':_0x51fd77['email']}),_0x93fc95=await master_shop[_0x477ac0(0x1d6)]();console['log'](_0x477ac0(0x147),_0x93fc95);let _0x1c100a;if(_0x51fd77['role']==_0x477ac0(0x208)){const _0x3620d4=await staff[_0x477ac0(0x1a2)]({'email':_0x51fd77[_0x477ac0(0x1b3)]});_0x1c100a=await warehouse[_0x477ac0(0x15f)]([{'$match':{'status':_0x477ac0(0x190),'name':_0x3620d4[_0x477ac0(0x153)],'warehouse_category':_0x477ac0(0x1d7)}},{'$group':{'_id':_0x477ac0(0x123),'name':{'$first':_0x477ac0(0x123)}}}]);}else _0x1c100a=await warehouse['aggregate']([{'$match':{'status':_0x477ac0(0x190),'warehouse_category':_0x477ac0(0x1d7)}},{'$group':{'_id':_0x477ac0(0x123),'name':{'$first':_0x477ac0(0x123)}}}]);var _0x4696dc=[_0x477ac0(0x14a),_0x477ac0(0x150),_0x477ac0(0x14d)];const _0x23817d=await transfers[_0x477ac0(0x1d6)]({}),_0x373fa1=_0x23817d[_0x477ac0(0x12f)]+0x1,_0x59c31e=_0x477ac0(0x168)+_0x373fa1[_0x477ac0(0x1bf)]()[_0x477ac0(0x146)](0x5,'0');if(_0x93fc95[0x0][_0x477ac0(0x1cd)]==_0x477ac0(0x1d1)){var _0x45dbc6=users[_0x477ac0(0x15e)];console['log'](_0x45dbc6);}else{if(_0x93fc95[0x0][_0x477ac0(0x1cd)]==_0x477ac0(0x187))var _0x45dbc6=users[_0x477ac0(0x187)];else{if(_0x93fc95[0x0]['language']==_0x477ac0(0x184))var _0x45dbc6=users[_0x477ac0(0x184)];else{if(_0x93fc95[0x0][_0x477ac0(0x1cd)]==_0x477ac0(0x1f3))var _0x45dbc6=users[_0x477ac0(0x1f3)];else{if(_0x93fc95[0x0][_0x477ac0(0x1cd)]==_0x477ac0(0x14f))var _0x45dbc6=users[_0x477ac0(0x14f)];else{if(_0x93fc95[0x0][_0x477ac0(0x1cd)]=='Portuguese\x20(BR)')var _0x45dbc6=users[_0x477ac0(0x166)];else{if(_0x93fc95[0x0]['language']==_0x477ac0(0x158))var _0x45dbc6=users[_0x477ac0(0x158)];else{if(_0x93fc95[0x0][_0x477ac0(0x1cd)]==_0x477ac0(0x1c1))var _0x45dbc6=users[_0x477ac0(0x171)];}}}}}}}const _0x37c66d=getRandom8DigitNumber();_0x37c66d[_0x477ac0(0x1ce)](_0x2b57cf=>{var _0x2e3005=_0x477ac0;_0x5410dd[_0x2e3005(0x154)]('add_transfer',{'success':_0x2972b9['flash']('success'),'errors':_0x2972b9['flash'](_0x2e3005(0x118)),'role':_0x51fd77,'profile':_0x24e8bf,'master_shop':_0x93fc95,'warehouse':_0x1c100a,'language':_0x45dbc6,'rooms_data':_0x4696dc,'invoice':_0x2b57cf});})[_0x477ac0(0x203)](_0x4eeb80=>{var _0x4f0da1=_0x477ac0;_0x2972b9[_0x4f0da1(0x138)](_0x4f0da1(0x118),_0x4f0da1(0x1a1)),_0x5410dd[_0x4f0da1(0x1a9)](_0x4f0da1(0x1e1));});}catch(_0x5ed617){console[_0x477ac0(0x172)](_0x5ed617);}}),router['post'](a0_0xf7b6e9(0x1cf),auth,async(_0x448da7,_0x551fc6)=>{var _0x2264ed=a0_0xf7b6e9;try{console[_0x2264ed(0x172)](_0x448da7[_0x2264ed(0x1e5)]);const {date:_0x1b39db,from_warehouse:_0x4bba6d,FromRoom_name:_0x5d7fb9,to_warehouse:_0x2aa0f2,ToRoom_name:_0x32049d,prod_name:_0x4b9fc6,from_prod_qty:_0x12f0bf,from_prod_level:_0x307f53,from_prod_isle:_0x15e1d5,from_prod_pallet:_0x3274bf,to_prod_qty:_0x56cc4f,to_prod_level:_0x545fa3,to_prod_isle:_0x1d156a,to_prod_pallet:_0x50ea71,primary_code:_0xa8d9f5,secondary_code:_0x2723e6,product_code3:_0x3f1290,note:_0x45479e,MaxStocks_data2:_0x4ec197,invoice:_0xaa429b,expiry_date:_0x194971}=_0x448da7[_0x2264ed(0x1e5)];if(typeof _0x4b9fc6==_0x2264ed(0x176))var _0x580a22=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1f9)]],_0x47432c=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1dd)]],_0x257b07=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1b6)]],_0xcdd599=[_0x448da7['body'][_0x2264ed(0x1f0)]],_0x15b4bb=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x16d)]],_0x583768=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1a0)]],_0xae679d=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x13a)]],_0x355956=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x122)]],_0x1e862b=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x16b)]],_0x4e1758=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x11b)]],_0x58cdeb=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x180)]],_0x2c3074=[_0x448da7['body'][_0x2264ed(0x1a5)]],_0x30aac3=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x140)]],_0x425c03=[_0x448da7['body']['max_per_unit']],_0x592a7d=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1f7)]],_0x19c9ed=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x161)]],_0x2f8792=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1ed)]],_0x3e5019=[_0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x13f)]],_0x11de19=[_0x448da7['body'][_0x2264ed(0x1b4)]],_0x4cd267=[_0x448da7['body'][_0x2264ed(0x193)]];else var _0x580a22=[..._0x448da7['body']['prod_name']],_0x47432c=[..._0x448da7[_0x2264ed(0x1e5)]['from_prod_qty']],_0x257b07=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1b6)]],_0xcdd599=[..._0x448da7['body'][_0x2264ed(0x1f0)]],_0x15b4bb=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x16d)]],_0x583768=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1a0)]],_0xae679d=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x13a)]],_0x355956=[..._0x448da7['body'][_0x2264ed(0x122)]],_0x1e862b=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x16b)]],_0x4e1758=[..._0x448da7[_0x2264ed(0x1e5)]['primary_unit']],_0x58cdeb=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x180)]],_0x2c3074=[..._0x448da7['body']['batch_code']],_0x30aac3=[..._0x448da7[_0x2264ed(0x1e5)]['expiry_date']],_0x425c03=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x151)]],_0x592a7d=[..._0x448da7['body'][_0x2264ed(0x1f7)]],_0x19c9ed=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x161)]],_0x2f8792=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x1ed)]],_0x3e5019=[..._0x448da7[_0x2264ed(0x1e5)][_0x2264ed(0x13f)]],_0x11de19=[..._0x448da7[_0x2264ed(0x1e5)]['from_invoice']],_0x4cd267=[..._0x448da7['body'][_0x2264ed(0x193)]];const _0x423596=_0x580a22[_0x2264ed(0x198)](_0x4b0b91=>{return _0x4b0b91={'product_name':_0x4b0b91};});_0x47432c[_0x2264ed(0x137)]((_0x2b6f01,_0x151508)=>{var _0x1541b4=_0x2264ed;_0x423596[_0x151508][_0x1541b4(0x1b2)]=_0x2b6f01;}),_0x11de19[_0x2264ed(0x137)]((_0x4f1b2f,_0x535b3c)=>{var _0x33e772=_0x2264ed;_0x423596[_0x535b3c][_0x33e772(0x1b4)]=_0x4f1b2f;}),_0x4cd267[_0x2264ed(0x137)]((_0x4af12a,_0x389898)=>{_0x423596[_0x389898]['To_invoice']=_0x4af12a;}),_0x257b07[_0x2264ed(0x137)]((_0x2ef197,_0x25b623)=>{var _0x1109d7=_0x2264ed;_0x2f8792[_0x1109d7(0x137)]((_0x68bf2d,_0x4a3e0a)=>{var _0x13f9ad=_0x1109d7;if(_0x68bf2d==_0x13f9ad(0x1a8)&&_0x25b623==_0x4a3e0a){var _0x288c27=_0x2ef197[_0x13f9ad(0x1c7)](0x3);_0x423596[_0x25b623][_0x13f9ad(0x142)]=_0x2ef197[0x0],_0x423596[_0x25b623]['from_rack']=_0x2ef197[0x1],_0x423596[_0x25b623][_0x13f9ad(0x1a6)]=0x0,_0x423596[_0x25b623][_0x13f9ad(0x204)]=0x0,_0x423596[_0x25b623][_0x13f9ad(0x194)]='Floor',_0x423596[_0x25b623]['from_floorlevel']=_0x288c27;}else{if(_0x68bf2d==_0x13f9ad(0x1ca)&&_0x25b623==_0x4a3e0a){var _0x288c27=_0x2ef197[_0x13f9ad(0x1c7)](0x3);_0x423596[_0x25b623]['from_storage']=_0x2ef197[0x0],_0x423596[_0x25b623][_0x13f9ad(0x1fa)]=_0x2ef197[0x1],_0x423596[_0x25b623][_0x13f9ad(0x1a6)]=0x0,_0x423596[_0x25b623][_0x13f9ad(0x204)]=0x0,_0x423596[_0x25b623][_0x13f9ad(0x194)]=_0x13f9ad(0x1e4),_0x423596[_0x25b623][_0x13f9ad(0x18c)]=_0x2ef197[0x5];}else{if(_0x25b623==_0x4a3e0a){var _0x578d0c;if(_0x2ef197[0x4]=='L')_0x578d0c=_0x13f9ad(0x134);else _0x2ef197[0x4]=='F'&&(_0x578d0c=_0x13f9ad(0x1e4));_0x423596[_0x25b623]['from_storage']=_0x2ef197[0x0],_0x423596[_0x25b623]['from_rack']=_0x2ef197[0x1],_0x423596[_0x25b623][_0x13f9ad(0x1a6)]=_0x2ef197[0x2],_0x423596[_0x25b623]['from_bin']=_0x2ef197[0x3],_0x423596[_0x25b623]['from_types']=_0x578d0c,_0x423596[_0x25b623]['from_floorlevel']=_0x2ef197[0x5];}}}});}),_0xcdd599[_0x2264ed(0x137)]((_0x30c1dd,_0x7c669c)=>{_0x423596[_0x7c669c]['to_quantity']=_0x30c1dd;}),_0x15b4bb['forEach']((_0x2e0a73,_0x37fc71)=>{var _0x302aae=_0x2264ed;_0x3e5019[_0x302aae(0x137)]((_0x476941,_0xafb93d)=>{var _0x27c6cc=_0x302aae;if(_0x476941==_0x27c6cc(0x1a8)&&_0x37fc71==_0xafb93d){var _0x9d6300=_0x2e0a73[_0x27c6cc(0x1c7)](0x3);_0x423596[_0x37fc71][_0x27c6cc(0x181)]=_0x2e0a73[0x0],_0x423596[_0x37fc71]['rack']=_0x2e0a73[0x1],_0x423596[_0x37fc71][_0x27c6cc(0x14c)]=0x0,_0x423596[_0x37fc71][_0x27c6cc(0x139)]=0x0,_0x423596[_0x37fc71]['to_types']=_0x27c6cc(0x1e4),_0x423596[_0x37fc71][_0x27c6cc(0x1ff)]=_0x9d6300;}else{if(_0x476941=='Shelves'&&_0x37fc71==_0xafb93d){var _0x9d6300=_0x2e0a73[_0x27c6cc(0x1c7)](0x3);_0x423596[_0x37fc71][_0x27c6cc(0x181)]=_0x2e0a73[0x0],_0x423596[_0x37fc71][_0x27c6cc(0x1f1)]=_0x2e0a73[0x1],_0x423596[_0x37fc71][_0x27c6cc(0x14c)]=0x0,_0x423596[_0x37fc71][_0x27c6cc(0x139)]=0x0,_0x423596[_0x37fc71][_0x27c6cc(0x177)]='Floor',_0x423596[_0x37fc71][_0x27c6cc(0x1ff)]=_0x2e0a73[0x5];}else{if(_0x37fc71==_0xafb93d){var _0x305a00;if(_0x2e0a73[0x4]=='L')_0x305a00=_0x27c6cc(0x134);else _0x2e0a73[0x4]=='F'&&(_0x305a00=_0x27c6cc(0x1e4));_0x423596[_0x37fc71][_0x27c6cc(0x181)]=_0x2e0a73[0x0],_0x423596[_0x37fc71]['rack']=_0x2e0a73[0x1],_0x423596[_0x37fc71]['to_bay']=_0x2e0a73[0x2],_0x423596[_0x37fc71]['to_bin']=_0x2e0a73[0x3],_0x423596[_0x37fc71][_0x27c6cc(0x177)]=_0x305a00,_0x423596[_0x37fc71][_0x27c6cc(0x1ff)]=_0x2e0a73[0x5];}}}});}),_0x583768['forEach']((_0x27e578,_0x311222)=>{var _0x373da9=_0x2264ed;_0x423596[_0x311222][_0x373da9(0x1a0)]=_0x27e578;}),_0xae679d[_0x2264ed(0x137)]((_0x2bda8f,_0x22e8a1)=>{var _0xbda79f=_0x2264ed;_0x423596[_0x22e8a1][_0xbda79f(0x13a)]=_0x2bda8f;}),_0x355956['forEach']((_0x76af5d,_0x31c00e)=>{var _0x24c4f7=_0x2264ed;_0x423596[_0x31c00e][_0x24c4f7(0x206)]=_0x76af5d;}),_0x1e862b[_0x2264ed(0x137)]((_0x56a2a9,_0x44c59b)=>{var _0x1d2617=_0x2264ed;_0x423596[_0x44c59b][_0x1d2617(0x130)]=_0x56a2a9;}),_0x4e1758[_0x2264ed(0x137)]((_0x2954ef,_0x4eef58)=>{var _0x1a7031=_0x2264ed;_0x423596[_0x4eef58][_0x1a7031(0x20a)]=_0x2954ef;}),_0x58cdeb[_0x2264ed(0x137)]((_0x1e3093,_0x26409a)=>{var _0x1fea2b=_0x2264ed;_0x423596[_0x26409a][_0x1fea2b(0x180)]=_0x1e3093;}),_0x2c3074[_0x2264ed(0x137)]((_0x23722c,_0x894103)=>{_0x423596[_0x894103]['batch_code']=_0x23722c;}),_0x30aac3[_0x2264ed(0x137)]((_0x3a14c5,_0x557585)=>{var _0x2ba64b=_0x2264ed;_0x423596[_0x557585][_0x2ba64b(0x140)]=_0x3a14c5;}),_0x425c03['forEach']((_0x47ae10,_0x4845cd)=>{var _0xb3380=_0x2264ed;_0x423596[_0x4845cd][_0xb3380(0x17b)]=_0x47ae10;}),_0x592a7d[_0x2264ed(0x137)]((_0x2c9549,_0x111bd8)=>{_0x423596[_0x111bd8]['production_date']=_0x2c9549;}),_0x19c9ed[_0x2264ed(0x137)]((_0x5b94a4,_0x1a0484)=>{var _0x25eb17=_0x2264ed;_0x423596[_0x1a0484][_0x25eb17(0x161)]=_0x5b94a4;}),_0x2f8792['forEach']((_0x406c7a,_0x490b5f)=>{var _0x1c0cef=_0x2264ed;_0x423596[_0x490b5f][_0x1c0cef(0x145)]=_0x406c7a;}),_0x3e5019[_0x2264ed(0x137)]((_0x157a04,_0x4aa752)=>{var _0x62692=_0x2264ed;_0x423596[_0x4aa752][_0x62692(0x148)]=_0x157a04;});const _0x3ad26f=_0x423596[_0x2264ed(0x16f)](_0x5d87b7=>_0x5d87b7[_0x2264ed(0x11a)]!=='0'&&_0x5d87b7[_0x2264ed(0x11a)]!==''||_0x5d87b7[_0x2264ed(0x1ff)]!=='0'&&_0x5d87b7[_0x2264ed(0x1ff)]!==''),_0x1e34b8=new transfers({'date':_0x1b39db,'from_warehouse':_0x4bba6d,'to_warehouse':_0x2aa0f2,'product':_0x3ad26f,'note':_0x45479e,'invoice':_0xaa429b}),_0x1ce4a0=await _0x1e34b8['save']();_0x448da7[_0x2264ed(0x138)](_0x2264ed(0x1af),_0x2264ed(0x156)),_0x551fc6['redirect'](_0x2264ed(0x163)+_0x1ce4a0[_0x2264ed(0x124)]);}catch(_0x49c040){console[_0x2264ed(0x172)](_0x49c040),_0x551fc6[_0x2264ed(0x1fc)](0xc8)[_0x2264ed(0x1bb)]({'errorMessage':_0x49c040[_0x2264ed(0x16e)]});}}),router[a0_0xf7b6e9(0x1e8)](a0_0xf7b6e9(0x12d),auth,async(_0x45605e,_0x20bd68)=>{var _0xfa1e8c=a0_0xf7b6e9;try{const {username:_0x5f56a,email:_0x541955,role:_0x52142d}=_0x45605e[_0xfa1e8c(0x1e3)],_0x4b19c0=_0x45605e['user'],_0x48c735=await profile['findOne']({'email':_0x4b19c0[_0xfa1e8c(0x1b3)]}),_0x342167=await master_shop[_0xfa1e8c(0x1d6)]();console['log'](_0xfa1e8c(0x147),_0x342167);const _0x538680=await transfers[_0xfa1e8c(0x144)](_0x45605e[_0xfa1e8c(0x1aa)]['id']);let _0x5026f5=new Date(_0x538680[_0xfa1e8c(0x140)]),_0x2595a5=('0'+_0x5026f5[_0xfa1e8c(0x160)]())[_0xfa1e8c(0x1c7)](-0x2),_0x22a7a5=('0'+(_0x5026f5[_0xfa1e8c(0x12c)]()+0x1))['slice'](-0x2),_0x50b060=_0x5026f5[_0xfa1e8c(0x1ad)](),_0x2ba5e3=_0x50b060+'-'+_0x22a7a5+'-'+_0x2595a5,_0x362b3e;if(_0x4b19c0[_0xfa1e8c(0x1ef)]==_0xfa1e8c(0x208)){const _0x478615=await staff[_0xfa1e8c(0x1a2)]({'email':_0x4b19c0[_0xfa1e8c(0x1b3)]});_0x362b3e=await warehouse[_0xfa1e8c(0x1d6)]({'status':'Enabled','name':_0x478615['warehouse'],'warehouse_category':_0xfa1e8c(0x1d7)});}else _0x362b3e=await warehouse[_0xfa1e8c(0x1d6)]({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0x15970b=await warehouse[_0xfa1e8c(0x15f)]([{'$match':{'name':_0x538680[_0xfa1e8c(0x136)]}},{'$unwind':_0xfa1e8c(0x17a)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xfa1e8c(0x16a)},'bin':{'$first':_0xfa1e8c(0x207)},'type':{'$first':_0xfa1e8c(0x1a3)},'floorlevel':{'$first':_0xfa1e8c(0x18a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xfa1e8c(0x1d8)},'product_code':{'$first':_0xfa1e8c(0x1d2)},'storage':{'$first':_0xfa1e8c(0x1ae)},'rack':{'$first':_0xfa1e8c(0x1e9)},'expiry_date':{'$first':_0xfa1e8c(0x188)},'production_date':{'$first':_0xfa1e8c(0x149)},'room':{'$first':_0xfa1e8c(0x1ac)}}}]);if(_0x342167[0x0][_0xfa1e8c(0x1cd)]==_0xfa1e8c(0x1d1)){var _0x345245=users[_0xfa1e8c(0x15e)];console[_0xfa1e8c(0x172)](_0x345245);}else{if(_0x342167[0x0][_0xfa1e8c(0x1cd)]==_0xfa1e8c(0x187))var _0x345245=users['Hindi'];else{if(_0x342167[0x0][_0xfa1e8c(0x1cd)]==_0xfa1e8c(0x184))var _0x345245=users[_0xfa1e8c(0x184)];else{if(_0x342167[0x0][_0xfa1e8c(0x1cd)]==_0xfa1e8c(0x1f3))var _0x345245=users['Spanish'];else{if(_0x342167[0x0][_0xfa1e8c(0x1cd)]==_0xfa1e8c(0x14f))var _0x345245=users['French'];else{if(_0x342167[0x0]['language']==_0xfa1e8c(0x182))var _0x345245=users['Portuguese'];else{if(_0x342167[0x0][_0xfa1e8c(0x1cd)]=='Chinese')var _0x345245=users['Chinese'];else{if(_0x342167[0x0][_0xfa1e8c(0x1cd)]=='Arabic\x20(ae)')var _0x345245=users['Arabic'];}}}}}}}_0x20bd68[_0xfa1e8c(0x154)](_0xfa1e8c(0x1c9),{'success':_0x45605e[_0xfa1e8c(0x138)](_0xfa1e8c(0x1af)),'errors':_0x45605e['flash']('errors'),'role':_0x4b19c0,'profile':_0x48c735,'master_shop':_0x342167,'warehouse':_0x362b3e,'transfer':_0x538680,'stock':_0x15970b,'language':_0x345245});}catch(_0xfcaee1){console[_0xfa1e8c(0x172)](_0xfcaee1);}}),router[a0_0xf7b6e9(0x15b)](a0_0xf7b6e9(0x12d),auth,async(_0x28b1ed,_0x35f303)=>{var _0x309da0=a0_0xf7b6e9;try{const _0x37ed1f=_0x28b1ed[_0x309da0(0x1aa)]['id'],{from_warehouse:_0x5cd83f,FromRoom_name:_0x27a2ab,to_warehouse:_0x3d21f4,ToRoom_name:_0x1c0266}=_0x28b1ed[_0x309da0(0x1e5)],_0x2be1f6=await transfers[_0x309da0(0x144)]({'_id':_0x37ed1f}),_0x3a373f=_0x2be1f6[_0x309da0(0x202)][_0x309da0(0x198)](async _0x4e3803=>{var _0x28a5ef=_0x309da0;if(_0x4e3803[_0x28a5ef(0x11a)]>0x0){var _0x3b71f6=await warehouse[_0x28a5ef(0x1a2)]({'name':_0x2be1f6['from_warehouse'],'room':_0x4e3803[_0x28a5ef(0x145)],'warehouse_category':_0x28a5ef(0x1d7)});const _0x3eba35=_0x3b71f6[_0x28a5ef(0x17f)]['map'](_0x54371c=>{var _0x2d8a3b=_0x28a5ef;_0x54371c[_0x2d8a3b(0x15c)]==_0x4e3803[_0x2d8a3b(0x15c)]&&_0x54371c[_0x2d8a3b(0x1c2)]==_0x4e3803[_0x2d8a3b(0x18c)]&&_0x54371c[_0x2d8a3b(0x196)]==_0x4e3803[_0x2d8a3b(0x194)]&&_0x54371c['bin']==_0x4e3803[_0x2d8a3b(0x204)]&&_0x54371c['bay']==_0x4e3803['from_bay']&&_0x54371c['rack']==_0x4e3803[_0x2d8a3b(0x1fa)]&&_0x54371c[_0x2d8a3b(0x181)]==_0x4e3803[_0x2d8a3b(0x142)]&&_0x54371c[_0x2d8a3b(0x140)]==_0x4e3803[_0x2d8a3b(0x140)]&&_0x54371c[_0x2d8a3b(0x1a5)]==_0x4e3803['batch_code']&&_0x54371c[_0x2d8a3b(0x1f7)]==_0x4e3803['production_date']&&_0x54371c[_0x2d8a3b(0x1df)]==_0x4e3803[_0x2d8a3b(0x1b4)]&&(_0x54371c[_0x2d8a3b(0x1f8)]=_0x54371c[_0x2d8a3b(0x1f8)]-_0x4e3803[_0x2d8a3b(0x11a)]);});}return _0x3b71f6;});Promise[_0x309da0(0x133)](_0x3a373f)[_0x309da0(0x1ce)](async _0x537183=>{var _0x3676cd=_0x309da0;try{for(const _0x43e41f of _0x537183){await _0x43e41f[_0x3676cd(0x1e0)]();}try{const _0x1db902=_0x2be1f6[_0x3676cd(0x202)][_0x3676cd(0x198)](async _0x98be91=>{var _0x255dbb=_0x3676cd;if(_0x98be91[_0x255dbb(0x11a)]>0x0){var _0x5e950f=await warehouse[_0x255dbb(0x1a2)]({'name':_0x2be1f6[_0x255dbb(0x1b1)],'room':_0x98be91[_0x255dbb(0x148)],'warehouse_category':'Raw\x20Materials'}),_0x3f4068=0x0;const _0x3c4c76=_0x5e950f[_0x255dbb(0x17f)]['map'](_0x26f1af=>{var _0x3c59b6=_0x255dbb;_0x26f1af[_0x3c59b6(0x15c)]==_0x98be91[_0x3c59b6(0x15c)]&&_0x26f1af['floorlevel']==_0x98be91[_0x3c59b6(0x1ff)]&&_0x26f1af['type']==_0x98be91['to_types']&&_0x26f1af[_0x3c59b6(0x127)]==_0x98be91['to_bin']&&_0x26f1af[_0x3c59b6(0x12b)]==_0x98be91[_0x3c59b6(0x14c)]&&_0x26f1af[_0x3c59b6(0x1f1)]==_0x98be91[_0x3c59b6(0x1f1)]&&_0x26f1af[_0x3c59b6(0x181)]==_0x98be91['storage']&&_0x26f1af[_0x3c59b6(0x140)]==_0x98be91[_0x3c59b6(0x140)]&&_0x26f1af[_0x3c59b6(0x1a5)]==_0x98be91[_0x3c59b6(0x1a5)]&&_0x26f1af[_0x3c59b6(0x1f7)]==_0x98be91[_0x3c59b6(0x1f7)]&&_0x26f1af['invoice']==_0x98be91[_0x3c59b6(0x19d)]&&(_0x26f1af[_0x3c59b6(0x1f8)]=_0x26f1af[_0x3c59b6(0x1f8)]+_0x98be91['to_quantity'],_0x3f4068++);});_0x3f4068=='0'&&(_0x5e950f[_0x255dbb(0x17f)]=_0x5e950f[_0x255dbb(0x17f)][_0x255dbb(0x17d)]({'product_name':_0x98be91['product_name'],'product_stock':_0x98be91[_0x255dbb(0x11a)],'bay':_0x98be91[_0x255dbb(0x14c)],'bin':_0x98be91[_0x255dbb(0x139)],'type':_0x98be91['to_types'],'floorlevel':_0x98be91['to_floorlevel'],'storage':_0x98be91['storage'],'rack':_0x98be91['rack'],'product_code':_0x98be91[_0x255dbb(0x206)],'primary_code':_0x98be91[_0x255dbb(0x1a0)],'secondary_code':_0x98be91[_0x255dbb(0x13a)],'maxProducts':_0x98be91[_0x255dbb(0x130)],'storage':_0x98be91['storage'],'rack':_0x98be91[_0x255dbb(0x1f1)],'expiry_date':_0x98be91['expiry_date'],'maxPerUnit':_0x98be91[_0x255dbb(0x17b)],'batch_code':_0x98be91[_0x255dbb(0x1a5)],'production_date':_0x98be91[_0x255dbb(0x1f7)]}));}return _0x5e950f;});Promise[_0x3676cd(0x133)](_0x1db902)[_0x3676cd(0x1ce)](async _0x3cebdc=>{var _0x4a709c=_0x3676cd;try{for(const _0x32b14f of _0x3cebdc){await warehouse[_0x4a709c(0x18d)]({'_id':_0x32b14f['_id']},{'$addToSet':{'product_details':{'$each':_0x32b14f[_0x4a709c(0x17f)]}}});}_0x2be1f6[_0x4a709c(0x179)]=_0x4a709c(0x197);const _0x366dec=await _0x2be1f6[_0x4a709c(0x1e0)](),_0x173cfb=await master_shop[_0x4a709c(0x1d6)](),_0x5e008f=await email_settings['findOne'](),_0x25a543=await supervisor_settings['find']();var _0x32b80a=_0x2be1f6[_0x4a709c(0x202)],_0x438104='',_0x3ef39f;for(_0x3ef39f in _0x32b80a){_0x438104+=_0x4a709c(0x1ea)+_0x4a709c(0x1cb)+_0x32b80a[_0x3ef39f][_0x4a709c(0x15c)]+_0x4a709c(0x169)+_0x4a709c(0x1cb)+_0x32b80a[_0x3ef39f][_0x4a709c(0x206)]+_0x4a709c(0x169)+_0x4a709c(0x1cb)+_0x32b80a[_0x3ef39f][_0x4a709c(0x11a)]+'</td>'+_0x4a709c(0x1cb)+_0x32b80a[_0x3ef39f][_0x4a709c(0x20a)]+_0x4a709c(0x169)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x32b80a[_0x3ef39f][_0x4a709c(0x180)]+_0x4a709c(0x169)+_0x4a709c(0x1cb)+_0x2be1f6[_0x4a709c(0x1b1)]+_0x4a709c(0x169)+_0x4a709c(0x1cb)+_0x32b80a[_0x3ef39f][_0x4a709c(0x148)]+'</td>'+_0x4a709c(0x1cb)+_0x32b80a[_0x3ef39f][_0x4a709c(0x181)]+_0x32b80a[_0x3ef39f][_0x4a709c(0x1f1)]+_0x32b80a[_0x3ef39f][_0x4a709c(0x14c)]+_0x32b80a[_0x3ef39f]['to_bin']+_0x32b80a[_0x3ef39f][_0x4a709c(0x177)][0x0]+_0x32b80a[_0x3ef39f][_0x4a709c(0x1ff)]+_0x4a709c(0x169),_0x4a709c(0x174);}let _0x4bd7c4=nodemailer[_0x4a709c(0x125)]({'host':_0x5e008f[_0x4a709c(0x15a)],'port':Number(_0x5e008f['port']),'secure':![],'auth':{'user':_0x5e008f[_0x4a709c(0x1b3)],'pass':_0x5e008f['password']}}),_0x4c2a6b={'from':_0x5e008f['email'],'to':_0x25a543[0x0][_0x4a709c(0x1b0)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x4a709c(0x1fd),'path':__dirname+'/../public'+_0x4a709c(0x199)+_0x173cfb[0x0][_0x4a709c(0x119)],'cid':_0x4a709c(0x129)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x4a709c(0x201)+'<div>'+_0x4a709c(0x165)+_0x4a709c(0x205)+_0x4a709c(0x1b5)+_0x4a709c(0x155)+_0x4a709c(0x205)+_0x4a709c(0x1be)+_0x173cfb[0x0]['site_title']+_0x4a709c(0x1cc)+_0x4a709c(0x155)+_0x4a709c(0x155)+_0x4a709c(0x175)+'<div>'+_0x4a709c(0x1e6)+_0x4a709c(0x185)+_0x2be1f6[_0x4a709c(0x1df)]+'\x20'+_0x4a709c(0x13d)+_0x4a709c(0x1eb)+_0x2be1f6[_0x4a709c(0x120)]+'\x20'+'</span>'+'</h5>'+_0x4a709c(0x155)+_0x4a709c(0x18f)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x4a709c(0x11c)+_0x4a709c(0x200)+_0x4a709c(0x11e)+_0x4a709c(0x1fb)+_0x4a709c(0x143)+_0x4a709c(0x19e)+_0x4a709c(0x18e)+'</tr>'+_0x4a709c(0x135)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x438104+'\x20'+_0x4a709c(0x1ee)+'</table>'+_0x4a709c(0x205)+_0x4a709c(0x19f)+_0x4a709c(0x132)+_0x173cfb[0x0][_0x4a709c(0x1a7)]+_0x4a709c(0x1f6)+_0x4a709c(0x155)+_0x4a709c(0x155)+_0x4a709c(0x1c3)};_0x4bd7c4[_0x4a709c(0x12e)](_0x4c2a6b,function(_0x22a0b3,_0xfa4f17){var _0x3651e3=_0x4a709c;_0x22a0b3?(console[_0x3651e3(0x172)](_0x22a0b3),console['log'](_0x3651e3(0x164))):console[_0x3651e3(0x172)](_0x3651e3(0x209));}),_0x28b1ed[_0x4a709c(0x138)]('success',_0x4a709c(0x167)),_0x35f303[_0x4a709c(0x1a9)]('/picking_list/PDF_transfer_rm/'+_0x366dec[_0x4a709c(0x124)]);}catch(_0x392a5f){console[_0x4a709c(0x1bd)](_0x392a5f),_0x35f303[_0x4a709c(0x1fc)](0x1f4)['json']({'Perror':_0x4a709c(0x18b),'message':_0x392a5f[_0x4a709c(0x16e)]});}})[_0x3676cd(0x203)](_0xa75852=>{var _0x18db8f=_0x3676cd;console[_0x18db8f(0x1bd)](_0xa75852),_0x35f303[_0x18db8f(0x1fc)](0x1f4)[_0x18db8f(0x1bb)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x3ccf9e){_0x35f303[_0x3676cd(0x1bb)](_0x3ccf9e);}}catch(_0x202091){console[_0x3676cd(0x1bd)](_0x202091),_0x35f303[_0x3676cd(0x1fc)](0x1f4)['json']({'Merror':_0x3676cd(0x18b),'Message':_0x202091[_0x3676cd(0x16e)]});}})[_0x309da0(0x203)](_0xde3348=>{var _0x33a333=_0x309da0;console[_0x33a333(0x1bd)](_0xde3348),_0x35f303['status'](0x1f4)[_0x33a333(0x1bb)]({'Merror':_0x33a333(0x1da)});});}catch(_0x1aafcf){console[_0x309da0(0x172)](_0x1aafcf);}});function BayBinSelected(_0x129016,_0x13e0de){var _0x4bd31c=a0_0xf7b6e9,_0x363208=[],_0x26464d=[],_0x474de5=[],_0x58fb57=[],_0x55dfbe=[],_0x4c8817=[];let _0x39cc4f=[];if(_0x129016==_0x4bd31c(0x183))switch(_0x13e0de){case'Rack\x20A':_0x363208=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x26464d=[0x1,0x2],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=[_0x4bd31c(0x134),'Floor'],_0x55dfbe=['D'],_0x4c8817=['A'];break;case _0x4bd31c(0x173):_0x363208=[0x6,0x5,0x4,0x3,0x2,0x1],_0x26464d=[0x1,0x2],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=[_0x4bd31c(0x134),'Floor'],_0x55dfbe=['D'],_0x4c8817=['B'];break;case _0x4bd31c(0x1ca):_0x363208=[0x0],_0x26464d=[0x0],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=[_0x4bd31c(0x1e4)],_0x55dfbe=['D'],_0x4c8817=['S'];break;case _0x4bd31c(0x1a8):_0x363208=[0x0],_0x26464d=[0x0],_0x58fb57=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x474de5=['Floor'],_0x55dfbe=['D'],_0x4c8817=['R'];break;}else{if(_0x129016==_0x4bd31c(0x1e7))switch(_0x13e0de){case'Rack\x20A':_0x363208=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x26464d=['B','F'],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=['Level',_0x4bd31c(0x1e4)],_0x55dfbe=['C'],_0x4c8817=['A'];break;case _0x4bd31c(0x173):_0x363208=[0x5,0x4,0x3,0x2,0x1],_0x26464d=['F','B','S'],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=[_0x4bd31c(0x134),_0x4bd31c(0x1e4)],_0x55dfbe=['C'],_0x4c8817=['B'];break;case _0x4bd31c(0x1f2):_0x363208=[0x1,0x2,0x3,0x4,0x5],_0x26464d=['B','F','S'],_0x58fb57=[0x5,0x4,0x3,0x2,0x1],_0x474de5=['Level',_0x4bd31c(0x1e4)],_0x55dfbe=['C'],_0x4c8817=['C'];break;case'Rack\x20D':_0x363208=[0x5,0x4,0x3,0x2,0x1],_0x26464d=['F','B','S'],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=['Level',_0x4bd31c(0x1e4)],_0x55dfbe=['C'],_0x4c8817=['D'];break;case'Rack\x20E':_0x363208=[0x4,0x3,0x2,0x1],_0x26464d=[0x1,0x2],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=[_0x4bd31c(0x134),'Floor'],_0x55dfbe=['C'],_0x4c8817=['E'];break;case _0x4bd31c(0x11f):_0x363208=[0x1,0x2,0x3],_0x26464d=[0x1,0x2],_0x58fb57=[0x1,0x2,0x3,0x4,0x5],_0x474de5=[_0x4bd31c(0x134)],_0x55dfbe=['C'],_0x4c8817=['F'];break;}}return{'levels':_0x363208,'Isle':_0x26464d,'rack':_0x58fb57,'type':_0x474de5,'storage':_0x55dfbe,'rak':_0x4c8817};}function a0_0x2cb4(_0x277bf5,_0x1164ea){var _0x2d46de=a0_0x2d46();return a0_0x2cb4=function(_0x2cb404,_0x59e374){_0x2cb404=_0x2cb404-0x118;var _0x2a20fa=_0x2d46de[_0x2cb404];return _0x2a20fa;},a0_0x2cb4(_0x277bf5,_0x1164ea);}router[a0_0xf7b6e9(0x1e8)](a0_0xf7b6e9(0x1c0),auth,async(_0x162797,_0x149366)=>{var _0x386a82=a0_0xf7b6e9;try{const {username:_0x143ac5,email:_0x3276b1,role:_0x35c744}=_0x162797[_0x386a82(0x1e3)],_0x358300=_0x162797[_0x386a82(0x1e3)],_0x29799b=await profile[_0x386a82(0x1a2)]({'email':_0x358300[_0x386a82(0x1b3)]}),_0x4f4493=await master_shop['find'](),_0x1bb8df=await transfers[_0x386a82(0x144)](_0x162797[_0x386a82(0x1aa)]['id']);let _0x2cde22;if(_0x358300[_0x386a82(0x1ef)]==_0x386a82(0x208)){const _0x25109a=await staff[_0x386a82(0x1a2)]({'email':_0x358300['email']});_0x2cde22=await warehouse[_0x386a82(0x15f)]([{'$match':{'status':_0x386a82(0x190),'name':_0x25109a[_0x386a82(0x153)],'warehouse_category':_0x386a82(0x1d7)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x2cde22=await warehouse['aggregate']([{'$match':{'status':_0x386a82(0x190),'warehouse_category':_0x386a82(0x1d7)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x4deefb=await warehouse[_0x386a82(0x15f)]([{'$match':{'name':_0x1bb8df[_0x386a82(0x136)],'warehouse_category':_0x386a82(0x1d7)}},{'$unwind':_0x386a82(0x17a)},{'$group':{'_id':_0x386a82(0x13c),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x386a82(0x121)},'bay':{'$first':_0x386a82(0x16a)},'bin':{'$first':_0x386a82(0x207)},'type':{'$first':_0x386a82(0x1a3)},'floorlevel':{'$first':_0x386a82(0x18a)},'primary_code':{'$first':_0x386a82(0x1de)},'secondary_code':{'$first':_0x386a82(0x1d8)},'product_code':{'$first':_0x386a82(0x1d2)},'storage':{'$first':_0x386a82(0x1ae)},'rack':{'$first':_0x386a82(0x1e9)},'expiry_date':{'$first':_0x386a82(0x188)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x386a82(0x1ac)}}}]),_0x39e740=await product[_0x386a82(0x1d6)]({}),_0x509947=BayBinSelected(_0x1bb8df[_0x386a82(0x1b1)],_0x1bb8df['to_room']);if(_0x4f4493[0x0][_0x386a82(0x1cd)]==_0x386a82(0x1d1)){var _0x2b96f4=users['English'];console[_0x386a82(0x172)](_0x2b96f4);}else{if(_0x4f4493[0x0]['language']==_0x386a82(0x187))var _0x2b96f4=users[_0x386a82(0x187)];else{if(_0x4f4493[0x0][_0x386a82(0x1cd)]=='German')var _0x2b96f4=users[_0x386a82(0x184)];else{if(_0x4f4493[0x0][_0x386a82(0x1cd)]=='Spanish')var _0x2b96f4=users[_0x386a82(0x1f3)];else{if(_0x4f4493[0x0][_0x386a82(0x1cd)]=='French')var _0x2b96f4=users[_0x386a82(0x14f)];else{if(_0x4f4493[0x0][_0x386a82(0x1cd)]=='Portuguese\x20(BR)')var _0x2b96f4=users[_0x386a82(0x166)];else{if(_0x4f4493[0x0][_0x386a82(0x1cd)]=='Chinese')var _0x2b96f4=users['Chinese'];else{if(_0x4f4493[0x0][_0x386a82(0x1cd)]==_0x386a82(0x1c1))var _0x2b96f4=users[_0x386a82(0x171)];}}}}}}}_0x149366[_0x386a82(0x154)](_0x386a82(0x1d3),{'success':_0x162797[_0x386a82(0x138)]('success'),'errors':_0x162797[_0x386a82(0x138)](_0x386a82(0x118)),'role':_0x358300,'profile':_0x29799b,'master_shop':_0x4f4493,'warehouse':_0x2cde22,'transfer':_0x1bb8df,'stock':_0x4deefb,'unit':_0x39e740,'language':_0x2b96f4});}catch(_0x1ae11f){console['log'](_0x1ae11f);}}),router[a0_0xf7b6e9(0x15b)](a0_0xf7b6e9(0x1c0),auth,async(_0xaddd32,_0x48e822)=>{var _0x26e783=a0_0xf7b6e9;try{const _0x5e4223=_0xaddd32[_0x26e783(0x1aa)]['id'],_0x550bbf=await transfers['findById'](_0x5e4223);_0x48e822[_0x26e783(0x1bb)](_0xaddd32['body']);return;const {date:_0x440b08,from_warehouse:_0x561e8f,FromRoom_name:_0x39f4b7,to_warehouse:_0x4b3fd6,ToRoom_name:_0x527c43,prod_name:_0x57f911,from_prod_qty:_0x58b4fc,from_prod_level:_0x3c2934,from_prod_isle:_0x579a4f,from_prod_pallet:_0x61158d,to_prod_qty:_0x4cee13,to_prod_level:_0x452d57,to_prod_isle:_0x321100,to_prod_pallet:_0x676282,primary_code:_0x1d1b58,secondary_code:_0x298d26,product_code3:_0x446d75,note:_0x3979a8,invoice:_0x10f38d,expiry_date:_0x3d0604}=_0xaddd32[_0x26e783(0x1e5)];if(typeof _0x57f911==_0x26e783(0x176))var _0x56b2dc=[_0xaddd32[_0x26e783(0x1e5)]['prod_name']],_0x473e3f=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1dd)]],_0x106183=[_0xaddd32[_0x26e783(0x1e5)]['from_prod_level']],_0x5379b7=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1c8)]],_0x99a9b=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x17e)]],_0x4dce15=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x194)]],_0x1b765b=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x131)]],_0x40b6aa=[_0xaddd32[_0x26e783(0x1e5)]['to_prod_level']],_0x25513d=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1c6)]],_0x3ed125=[_0xaddd32['body']['to_prod_pallet']],_0x5c8559=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x177)]],_0x2e8e84=[_0xaddd32['body'][_0x26e783(0x181)]],_0x926e9a=[_0xaddd32['body']['rak']],_0x282a43=[_0xaddd32['body'][_0x26e783(0x1a0)]],_0xc75314=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x13a)]],_0x4eaacb=[_0xaddd32['body'][_0x26e783(0x122)]],_0x51df9b=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x16b)]],_0x27875b=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x20a)]],_0x591a03=[_0xaddd32['body'][_0x26e783(0x180)]],_0x505eb9=[_0xaddd32[_0x26e783(0x1e5)]['batch_code']],_0xea7802=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x140)]],_0x390269=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x142)]],_0x260740=[_0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x19b)]];else var _0x56b2dc=[..._0xaddd32[_0x26e783(0x1e5)]['prod_name']],_0x2e8e84=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x181)]],_0x926e9a=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x162)]],_0x4dce15=[..._0xaddd32['body']['from_types']],_0x5c8559=[..._0xaddd32[_0x26e783(0x1e5)]['to_types']],_0x473e3f=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1dd)]],_0x106183=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1b6)]],_0x5379b7=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1c8)]],_0x99a9b=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x17e)]],_0x1b765b=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x131)]],_0x40b6aa=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x16d)]],_0x25513d=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1c6)]],_0x3ed125=[..._0xaddd32[_0x26e783(0x1e5)]['to_prod_pallet']],_0x282a43=[..._0xaddd32[_0x26e783(0x1e5)]['primary_code']],_0xc75314=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x13a)]],_0x4eaacb=[..._0xaddd32[_0x26e783(0x1e5)]['product_code3']],_0x51df9b=[..._0xaddd32['body'][_0x26e783(0x16b)]],_0x27875b=[..._0xaddd32[_0x26e783(0x1e5)]['unit']],_0x591a03=[..._0xaddd32['body'][_0x26e783(0x180)]],_0x505eb9=[..._0xaddd32[_0x26e783(0x1e5)][_0x26e783(0x1a5)]],_0xea7802=[..._0xaddd32['body']['expiry_date']],_0x390269=[..._0xaddd32['body']['from_storage']],_0x260740=[..._0xaddd32['body']['from_rak']];const _0x4a47a0=_0x56b2dc[_0x26e783(0x198)](_0x95d5ed=>{return _0x95d5ed={'product_name':_0x95d5ed};});_0x473e3f[_0x26e783(0x137)]((_0x460bd3,_0x56e453)=>{var _0x274529=_0x26e783;_0x4a47a0[_0x56e453][_0x274529(0x1b2)]=_0x460bd3;}),_0x106183['forEach']((_0x42981b,_0x4e4077)=>{var _0x713833=_0x26e783;_0x4a47a0[_0x4e4077][_0x713833(0x1a6)]=_0x42981b;}),_0x5379b7[_0x26e783(0x137)]((_0x135bd8,_0x2e027b)=>{_0x4a47a0[_0x2e027b]['from_bin']=_0x135bd8;}),_0x99a9b[_0x26e783(0x137)]((_0x8a0bd3,_0x3b4d7e)=>{var _0xec4767=_0x26e783;_0x4a47a0[_0x3b4d7e][_0xec4767(0x18c)]=_0x8a0bd3;}),_0x1b765b[_0x26e783(0x137)]((_0x3f7021,_0x4ce5c0)=>{var _0x283a6f=_0x26e783;_0x4a47a0[_0x4ce5c0][_0x283a6f(0x11a)]=_0x3f7021;}),_0x40b6aa['forEach']((_0x1ccac7,_0x5318ed)=>{var _0x4caebe=_0x26e783;_0x4a47a0[_0x5318ed][_0x4caebe(0x14c)]=_0x1ccac7;}),_0x25513d[_0x26e783(0x137)]((_0x29ce41,_0x5e789c)=>{var _0x1c6702=_0x26e783;_0x4a47a0[_0x5e789c][_0x1c6702(0x139)]=_0x29ce41;}),_0x3ed125[_0x26e783(0x137)]((_0x5d6640,_0x39d7d0)=>{_0x4a47a0[_0x39d7d0]['to_floorlevel']=_0x5d6640;}),_0x282a43['forEach']((_0x418d6d,_0x49db07)=>{var _0x37e689=_0x26e783;_0x4a47a0[_0x49db07][_0x37e689(0x1a0)]=_0x418d6d;}),_0xc75314['forEach']((_0x20281e,_0x240cdc)=>{var _0x1f911d=_0x26e783;_0x4a47a0[_0x240cdc][_0x1f911d(0x13a)]=_0x20281e;}),_0x4eaacb['forEach']((_0x16d07a,_0x41f15e)=>{var _0x1600a2=_0x26e783;_0x4a47a0[_0x41f15e][_0x1600a2(0x206)]=_0x16d07a;}),_0x51df9b['forEach']((_0x141481,_0x243b53)=>{_0x4a47a0[_0x243b53]['maxProducts']=_0x141481;}),_0x27875b[_0x26e783(0x137)]((_0x127403,_0x1fca44)=>{_0x4a47a0[_0x1fca44]['unit']=_0x127403;}),_0x591a03[_0x26e783(0x137)]((_0x2add16,_0x3c3589)=>{var _0x361854=_0x26e783;_0x4a47a0[_0x3c3589][_0x361854(0x180)]=_0x2add16;}),_0x505eb9[_0x26e783(0x137)]((_0x5426f9,_0x227e9d)=>{_0x4a47a0[_0x227e9d]['batch_code']=_0x5426f9;}),_0xea7802[_0x26e783(0x137)]((_0x213bd6,_0x4a64f2)=>{var _0xb042b=_0x26e783;_0x4a47a0[_0x4a64f2][_0xb042b(0x140)]=_0x213bd6;}),_0x2e8e84[_0x26e783(0x137)]((_0x3077e1,_0x52e892)=>{var _0x3b2c13=_0x26e783;_0x4a47a0[_0x52e892][_0x3b2c13(0x181)]=_0x3077e1;}),_0x926e9a[_0x26e783(0x137)]((_0x180ad3,_0x6017fc)=>{_0x4a47a0[_0x6017fc]['rack']=_0x180ad3;}),_0x4dce15['forEach']((_0x1699a5,_0x708378)=>{var _0x28a6f3=_0x26e783;_0x4a47a0[_0x708378][_0x28a6f3(0x194)]=_0x1699a5;}),_0x5c8559['forEach']((_0x23b39f,_0x35d621)=>{_0x4a47a0[_0x35d621]['to_types']=_0x23b39f;}),_0x390269[_0x26e783(0x137)]((_0x205289,_0x57cc23)=>{var _0x112193=_0x26e783;_0x4a47a0[_0x57cc23][_0x112193(0x142)]=_0x205289;}),_0x260740['forEach']((_0x3e54d8,_0x331cbf)=>{var _0x1ee047=_0x26e783;_0x4a47a0[_0x331cbf][_0x1ee047(0x1fa)]=_0x3e54d8;});const _0x5bded0=_0x4a47a0['filter'](_0x302ffb=>_0x302ffb[_0x26e783(0x11a)]!=='0'&&_0x302ffb['to_quantity']!==''||_0x302ffb[_0x26e783(0x1ff)]!=='0'&&_0x302ffb[_0x26e783(0x1ff)]!=='');var _0x125472=0x0;_0x5bded0[_0x26e783(0x137)](_0x285da7=>{var _0x1e33ac=_0x26e783;parseInt(_0x285da7['from_quantity'])<parseInt(_0x285da7[_0x1e33ac(0x11a)])&&_0x125472++;});if(_0x125472!=0x0)return _0xaddd32[_0x26e783(0x138)](_0x26e783(0x118),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x48e822[_0x26e783(0x1a9)](_0x26e783(0x1b9));const _0x544863=await warehouse[_0x26e783(0x1a2)]({'name':_0x550bbf['from_warehouse'],'room':_0x550bbf[_0x26e783(0x1fe)]});_0x550bbf['product'][_0x26e783(0x137)](_0x54127b=>{var _0x33ddd3=_0x26e783;if(_0x54127b[_0x33ddd3(0x11a)]>0x0){const _0x1af8c4=_0x544863[_0x33ddd3(0x17f)][_0x33ddd3(0x198)](_0xf5a294=>{var _0x36f18c=_0x33ddd3;_0xf5a294[_0x36f18c(0x15c)]==_0x54127b[_0x36f18c(0x15c)]&&_0xf5a294[_0x36f18c(0x1c2)]==_0x54127b[_0x36f18c(0x18c)]&&_0xf5a294['type']==_0x54127b[_0x36f18c(0x194)]&&_0xf5a294[_0x36f18c(0x127)]==_0x54127b[_0x36f18c(0x204)]&&_0xf5a294['bay']==_0x54127b[_0x36f18c(0x1a6)]&&_0xf5a294[_0x36f18c(0x1f1)]==_0x54127b[_0x36f18c(0x1fa)]&&_0xf5a294['storage']==_0x54127b[_0x36f18c(0x142)]&&(_0xf5a294[_0x36f18c(0x1f8)]=parseInt(_0xf5a294[_0x36f18c(0x1f8)])+parseInt(_0x54127b[_0x36f18c(0x11a)]));});}}),await _0x544863[_0x26e783(0x1e0)]();const _0x2d0a56=await warehouse[_0x26e783(0x1a2)]({'name':_0x550bbf[_0x26e783(0x1b1)],'room':_0x550bbf[_0x26e783(0x1a4)]});_0x550bbf[_0x26e783(0x202)]['forEach'](_0x158b07=>{var _0x2f50e1=_0x26e783;if(_0x158b07[_0x2f50e1(0x11a)]>0x0){const _0x47d4c2=_0x2d0a56[_0x2f50e1(0x17f)][_0x2f50e1(0x198)](_0x92c5b=>{var _0x245f53=_0x2f50e1;_0x92c5b[_0x245f53(0x15c)]==_0x158b07[_0x245f53(0x15c)]&&_0x92c5b[_0x245f53(0x1c2)]==_0x158b07[_0x245f53(0x1ff)]&&_0x92c5b[_0x245f53(0x196)]==_0x158b07[_0x245f53(0x177)]&&_0x92c5b[_0x245f53(0x127)]==_0x158b07[_0x245f53(0x139)]&&_0x92c5b[_0x245f53(0x12b)]==_0x158b07[_0x245f53(0x14c)]&&_0x92c5b[_0x245f53(0x1f1)]==_0x158b07[_0x245f53(0x1f1)]&&_0x92c5b[_0x245f53(0x181)]==_0x158b07['storage']&&(_0x92c5b[_0x245f53(0x1f8)]=parseInt(_0x92c5b['product_stock'])-parseInt(_0x158b07[_0x245f53(0x11a)]));});}}),await _0x2d0a56[_0x26e783(0x1e0)](),_0x550bbf[_0x26e783(0x120)]=_0x440b08,_0x550bbf['from_warehouse']=_0x561e8f,_0x550bbf['to_warehouse']=_0x4b3fd6,_0x550bbf[_0x26e783(0x202)]=_0x5bded0,_0x550bbf[_0x26e783(0x157)]=_0x3979a8,_0x550bbf['invoice']=_0x10f38d;const _0x2f4b0c=await _0x550bbf[_0x26e783(0x1e0)]();console[_0x26e783(0x172)](_0x2f4b0c);const _0x365387=await warehouse[_0x26e783(0x1a2)]({'name':_0x561e8f,'room':_0x39f4b7});_0x2f4b0c[_0x26e783(0x202)][_0x26e783(0x137)](_0x14b60d=>{var _0x574111=_0x26e783;if(_0x14b60d['to_quantity']>0x0){const _0x5d613e=_0x365387['product_details'][_0x574111(0x198)](_0x18a337=>{var _0x564438=_0x574111;_0x18a337[_0x564438(0x15c)]==_0x14b60d[_0x564438(0x15c)]&&_0x18a337[_0x564438(0x1c2)]==_0x14b60d[_0x564438(0x18c)]&&_0x18a337['type']==_0x14b60d[_0x564438(0x194)]&&_0x18a337[_0x564438(0x127)]==_0x14b60d[_0x564438(0x204)]&&_0x18a337[_0x564438(0x12b)]==_0x14b60d[_0x564438(0x1a6)]&&_0x18a337['rack']==_0x14b60d[_0x564438(0x1fa)]&&_0x18a337[_0x564438(0x181)]==_0x14b60d[_0x564438(0x142)]&&(_0x18a337[_0x564438(0x1f8)]=parseInt(_0x18a337['product_stock'])-parseInt(_0x14b60d[_0x564438(0x11a)]));});}}),await _0x365387[_0x26e783(0x1e0)]();const _0x459f1e=await warehouse[_0x26e783(0x1a2)]({'name':_0x4b3fd6,'room':_0x527c43});_0x2f4b0c[_0x26e783(0x202)]['forEach'](_0x1c7b37=>{var _0x942477=_0x26e783;if(_0x1c7b37[_0x942477(0x11a)]>0x0){var _0x1a432c=0x0;const _0x144ee2=_0x459f1e[_0x942477(0x17f)][_0x942477(0x198)](_0x45282a=>{var _0x234cc9=_0x942477;_0x45282a[_0x234cc9(0x15c)]==_0x1c7b37['product_name']&&_0x45282a[_0x234cc9(0x1c2)]==_0x1c7b37[_0x234cc9(0x1ff)]&&_0x45282a[_0x234cc9(0x196)]==_0x1c7b37[_0x234cc9(0x177)]&&_0x45282a[_0x234cc9(0x127)]==_0x1c7b37[_0x234cc9(0x139)]&&_0x45282a[_0x234cc9(0x12b)]==_0x1c7b37[_0x234cc9(0x14c)]&&_0x45282a['rack']==_0x1c7b37[_0x234cc9(0x1f1)]&&_0x45282a[_0x234cc9(0x181)]==_0x1c7b37[_0x234cc9(0x181)]&&(_0x45282a[_0x234cc9(0x1f8)]=parseInt(_0x45282a[_0x234cc9(0x1f8)])+parseInt(_0x1c7b37[_0x234cc9(0x11a)]),_0x1a432c++);});_0x1a432c=='0'&&(_0x459f1e[_0x942477(0x17f)]=_0x459f1e['product_details']['concat']({'product_name':_0x1c7b37[_0x942477(0x15c)],'product_stock':_0x1c7b37[_0x942477(0x11a)],'bay':_0x1c7b37['to_bay'],'bin':_0x1c7b37[_0x942477(0x139)],'type':_0x1c7b37['to_types'],'floorlevel':_0x1c7b37[_0x942477(0x1ff)],'storage':_0x1c7b37[_0x942477(0x181)],'rack':_0x1c7b37[_0x942477(0x1f1)],'product_code':_0x1c7b37[_0x942477(0x206)],'primary_code':_0x1c7b37[_0x942477(0x1a0)],'secondary_code':_0x1c7b37[_0x942477(0x13a)],'maxProducts':_0x1c7b37[_0x942477(0x130)],'storage':_0x1c7b37[_0x942477(0x181)],'rack':_0x1c7b37[_0x942477(0x1f1)]}));}}),await _0x459f1e[_0x26e783(0x1e0)](),_0xaddd32[_0x26e783(0x138)](_0x26e783(0x1af),_0x26e783(0x1d4)),_0x48e822['redirect']('/transfer/view');}catch(_0x1cc05c){console[_0x26e783(0x172)](_0x1cc05c);}}),router[a0_0xf7b6e9(0x15b)](a0_0xf7b6e9(0x189),async(_0x379066,_0x1c4fca)=>{var _0x16d934=a0_0xf7b6e9;const {FromWareHouse:_0x116089,FromRoom:_0x37f5f7,ToWarehouse:_0x1b18cf,ToRoom:_0x386b7d,primary_code:_0x32a660,Roomslist:_0x232522}=_0x379066[_0x16d934(0x1e5)],_0x4fd5e8=_0x232522[_0x16d934(0x1f5)](','),_0xfc4366=[];async function _0x394038(_0x21f301){var _0x40232c=_0x16d934;const _0x33ab04=await warehouse[_0x40232c(0x15f)]([{'$match':{'name':_0x116089,'room':_0x21f301}},{'$unwind':_0x40232c(0x17a)},{'$match':{'product_details.primary_code':_0x32a660}},{'$group':{'_id':_0x40232c(0x13c),'name':{'$first':_0x40232c(0x1d9)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x40232c(0x1de)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x40232c(0x207)},'type':{'$first':_0x40232c(0x1a3)},'pallet':{'$first':_0x40232c(0x18a)},'unit':{'$first':_0x40232c(0x16c)},'secondary_unit':{'$first':_0x40232c(0x1dc)},'storage':{'$first':_0x40232c(0x1ae)},'rack':{'$first':_0x40232c(0x1e9)},'expiry_date':{'$first':_0x40232c(0x188)},'production_date':{'$first':_0x40232c(0x149)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x40232c(0x11d)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x40232c(0x1ac)},'maxProducts':{'$first':_0x40232c(0x1ab)}}}]),_0x479950=await warehouse[_0x40232c(0x15f)]([{'$match':{'name':_0x116089,'room':_0x21f301}},{'$unwind':_0x40232c(0x17a)},{'$match':{'product_details.secondary_code':_0x32a660}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x40232c(0x1d9)},'instock':{'$first':_0x40232c(0x121)},'primary_code':{'$first':_0x40232c(0x1de)},'secondary_code':{'$first':_0x40232c(0x1d8)},'product_code':{'$first':_0x40232c(0x1d2)},'level':{'$first':_0x40232c(0x16a)},'isle':{'$first':_0x40232c(0x207)},'type':{'$first':_0x40232c(0x1a3)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x40232c(0x1dc)},'storage':{'$first':_0x40232c(0x1ae)},'rack':{'$first':_0x40232c(0x1e9)},'expiry_date':{'$first':_0x40232c(0x188)},'production_date':{'$first':_0x40232c(0x149)},'batch_code':{'$first':_0x40232c(0x1b7)},'maxPerUnit':{'$first':_0x40232c(0x11d)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x40232c(0x1ac)},'maxProducts':{'$first':_0x40232c(0x1ab)}}}]);if(_0x33ab04[_0x40232c(0x12f)]>0x0)_0xfc4366['push'](_0x33ab04);else _0x479950['length']>0x0&&_0xfc4366['push'](_0x479950);}const _0x178ae5=_0x4fd5e8[_0x16d934(0x198)](_0x4fe09e=>_0x394038(_0x4fe09e));await Promise[_0x16d934(0x133)](_0x178ae5),_0x1c4fca[_0x16d934(0x1bb)](_0xfc4366);}),router[a0_0xf7b6e9(0x15b)](a0_0xf7b6e9(0x141),async(_0x3c2e80,_0x413c28)=>{var _0x588bc1=a0_0xf7b6e9;try{const {FromWareHouse:_0x3443f9,FromRoom:_0x4da783,ToWarehouse:_0x5b8bbc,ToRoom:_0x54a500,secondary_code:_0x58cad6}=_0x3c2e80[_0x588bc1(0x1e5)],_0x5e4f4e=await warehouse[_0x588bc1(0x15f)]([{'$match':{'name':_0x3443f9}},{'$unwind':_0x588bc1(0x17a)},{'$match':{'product_details.secondary_code':_0x58cad6}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x588bc1(0x1de)},'secondary_code':{'$first':_0x588bc1(0x1d8)},'product_code':{'$first':_0x588bc1(0x1d2)},'instock':{'$first':_0x588bc1(0x121)},'warehouse':{'$first':_0x588bc1(0x123)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x588bc1(0x191)},'maxProducts':{'$first':_0x588bc1(0x1ab)},'unit':{'$first':_0x588bc1(0x16c)}}}]);_0x413c28[_0x588bc1(0x1fc)](0xc8)[_0x588bc1(0x1bb)](_0x5e4f4e);}catch(_0x3916cc){_0x413c28[_0x588bc1(0x1fc)](0x194)['json']({'message':_0x3916cc['message']});}}),router[a0_0xf7b6e9(0x15b)](a0_0xf7b6e9(0x19a),async(_0x22f117,_0x11cf24)=>{var _0x358f61=a0_0xf7b6e9;try{const {FromWareHouse:_0xd8957b,FromRoom:_0x2c0463,ToWarehouse:_0x1ae723,ToRoom:_0x5cdaf0,product_code:_0x232be7}=_0x22f117[_0x358f61(0x1e5)],_0x58f2ed=await warehouse[_0x358f61(0x15f)]([{'$match':{'name':_0xd8957b}},{'$unwind':_0x358f61(0x17a)},{'$match':{'product_details.product_code':_0x232be7}},{'$group':{'_id':_0x358f61(0x13c),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x358f61(0x1de)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x358f61(0x1d2)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x358f61(0x19c)},'isle':{'$first':_0x358f61(0x13b)},'pallet':{'$first':_0x358f61(0x191)},'maxProducts':{'$first':_0x358f61(0x1ab)},'unit':{'$first':_0x358f61(0x16c)}}}]);_0x11cf24['status'](0xc8)[_0x358f61(0x1bb)](_0x58f2ed);}catch(_0x399926){_0x11cf24[_0x358f61(0x1fc)](0x194)[_0x358f61(0x1bb)]({'message':_0x399926[_0x358f61(0x16e)]});}}),router[a0_0xf7b6e9(0x15b)]('/CheckingWarehouse',async(_0xba1082,_0xdab97c)=>{var _0x322c37=a0_0xf7b6e9;const {level:_0x1dcc34,isle:_0x29bef6,pallet:_0x17eedb,warehouses:_0x5d77ec,room:_0x30030e}=_0xba1082[_0x322c37(0x1e5)];try{const _0x3397fe=await warehouse[_0x322c37(0x15f)]([{'$match':{'name':_0x5d77ec,'room':_0x30030e}},{'$unwind':_0x322c37(0x17a)},{'$match':{'product_details.level':parseInt(_0x1dcc34),'product_details.isle':_0x29bef6,'product_details.pallet':parseInt(_0x17eedb)}},{'$group':{'_id':_0x322c37(0x13c),'name':{'$first':_0x322c37(0x1d9)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x322c37(0x19c)},'isle':{'$first':_0x322c37(0x13b)},'pallet':{'$first':_0x322c37(0x191)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0xdab97c[_0x322c37(0x1fc)](0xc8)[_0x322c37(0x1bb)](_0x3397fe);}catch(_0x2913b0){_0xdab97c['status'](0x194)[_0x322c37(0x1bb)]({'message':_0x2913b0[_0x322c37(0x16e)]});}}),module[a0_0xf7b6e9(0x1db)]=router;function a0_0x2d46(){var _0x606f53=['primary_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','findOne','$product_details.type','to_room','batch_code','from_bay','site_title','Receiving\x20Area','redirect','params','$product_details.maxProducts','$room','getFullYear','$product_details.storage','success','RMSEmail','to_warehouse','from_quantity','email','from_invoice','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','from_prod_level','$product_details.batch_code','$isAllowEdit','back','6064zSftmY','json','160IqCLNA','error','<h2>\x20','toString','/view/:id','Arabic\x20(ae)','floorlevel','</body></html>','../models/all_models','2190lSCVVR','to_prod_isle','slice','from_prod_isle','edit_transfer_view','Shelves','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','\x20</h2>','language','then','/view/add_transfer','$invoice','English\x20(US)','$product_details.product_code','edit_transfer','Transfer\x20Edit\x20Successfully','70YrEJGy','find','Raw\x20Materials','$product_details.secondary_code','$product_details.product_name','An\x20error\x20occurred.','exports','$product_details.secondary_unit','from_prod_qty','$product_details.primary_code','invoice','save','/transfer/view','6211668vaXtiD','user','Floor','body','<h5\x20style=\x22text-align:\x20left;\x22>','COLD\x20STORAGE','get','$product_details.rack','<tr>','\x20Order\x20Date\x20:\x20','1322802QdpHrm','RoomAssigned','</tbody>','role','New_Qty_Converted','rack','Rack\x20C','Spanish','$date','split','</h5>','production_date','product_stock','prod_name','from_rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','status','Logo.png','from_room','to_floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','</head><body>','product','catch','from_bin','<div>','product_code','$product_details.bin','staff','Email\x20sent\x20successfully','unit','errors','image','to_quantity','primary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.maxPerUnit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Rack\x20F','date','$product_details.product_stock','product_code3','$name','_id','createTransport','7EYHViq','bin','Router','logo','random','bay','getMonth','/preview/:id','sendMail','length','maxProducts','to_prod_qty','<h5>','all','Level','</thead>','from_warehouse','forEach','flash','to_bin','secondary_code','$product_details.isle','$product_details._id','<span\x20style=\x22float:\x20right;\x22>','../public/language/languages.json','ToRoomAssigned','expiry_date','/barcode_scanner2','from_storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','findById','from_room_name','padStart','master','to_room_name','$product_details.production_date','Ambient','1618248WzWkOG','to_bay','Return\x20Rooms','$finalize','French','Enclosed','max_per_unit','$from_warehouse','warehouse','render','</div>','Product\x20Transfer\x20successfully','note','Chinese','../middleware/auth','host','post','product_name','floor','English','aggregate','getDate','prod_cat','rak','/transfer/preview/','Error\x20Occurs','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Portuguese','Transfer\x20Finalize\x20Successfully','TRF-','</td>','$product_details.bay','MaxStocks_data2','$product_details.unit','to_prod_level','message','filter','11krlcSs','Arabic','log','Rack\x20B','</tr>','<hr\x20class=\x22my-3\x22>','string','to_types','3335589adXjBN','finalize','$product_details','maxperunit','$_id','concat','from_prod_pallet','product_details','secondary_unit','storage','Portuguese\x20(BR)','DRY\x20STORAGE','German','\x20Order\x20Number\x20:\x20','$product.to_room_name','Hindi','$product_details.expiry_date','/barcode_scanner','$product_details.floorlevel','An\x20error\x20occurred\x20while\x20saving\x20data.','from_floorlevel','updateOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Enabled','$product_details.pallet','850572ucTqmL','to_invoice','from_types','43915ttngzd','type','True','map','/upload/','/barcode_scanner3','from_rak','$product_details.level','To_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<strong>\x20Regards\x20</strong>'];a0_0x2d46=function(){return _0x606f53;};return a0_0x2d46();}