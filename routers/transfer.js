var a0_0x395688=a0_0xb45b;(function(_0x13b1a4,_0x5be08c){var _0x54add3=a0_0xb45b,_0x920b8f=_0x13b1a4();while(!![]){try{var _0x3ca09e=parseInt(_0x54add3(0x244))/0x1+-parseInt(_0x54add3(0x188))/0x2+parseInt(_0x54add3(0x183))/0x3*(parseInt(_0x54add3(0x232))/0x4)+parseInt(_0x54add3(0x1fd))/0x5+parseInt(_0x54add3(0x18b))/0x6*(parseInt(_0x54add3(0x19f))/0x7)+parseInt(_0x54add3(0x1a0))/0x8*(-parseInt(_0x54add3(0x19b))/0x9)+parseInt(_0x54add3(0x21e))/0xa*(parseInt(_0x54add3(0x187))/0xb);if(_0x3ca09e===_0x5be08c)break;else _0x920b8f['push'](_0x920b8f['shift']());}catch(_0x28422e){_0x920b8f['push'](_0x920b8f['shift']());}}}(a0_0x5319,0x1f766));const express=require(a0_0x395688(0x212)),app=express(),router=express[a0_0x395688(0x220)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x395688(0x21d)),auth=require(a0_0x395688(0x24e)),users=require(a0_0x395688(0x271)),nodemailer=require('nodemailer');router[a0_0x395688(0x234)](a0_0x395688(0x249),auth,async(_0x2f57b5,_0x1c9115)=>{var _0x972525=a0_0x395688;try{const {username:_0x4857af,email:_0x2a885a,role:_0x31e1d0}=_0x2f57b5[_0x972525(0x1a9)],_0x5fd199=_0x2f57b5[_0x972525(0x1a9)],_0x474c50=await profile[_0x972525(0x216)]({'email':_0x5fd199[_0x972525(0x24a)]}),_0x57c6e3=await master_shop[_0x972525(0x1ee)]();console['log'](_0x972525(0x1f2),_0x57c6e3);let _0x1d2839;if(_0x5fd199[_0x972525(0x1cd)]==_0x972525(0x223)){const _0x41a652=await staff[_0x972525(0x216)]({'email':_0x5fd199['email']});_0x1d2839=await transfers[_0x972525(0x1ee)]({'from_warehouse':_0x41a652[_0x972525(0x26f)]});}else _0x1d2839=await transfers['aggregate']([{'$unwind':_0x972525(0x1b7)},{'$group':{'_id':_0x972525(0x221),'invoice':{'$first':_0x972525(0x1f0)},'date':{'$first':_0x972525(0x258)},'from_warehouse':{'$first':_0x972525(0x1fc)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x972525(0x26b)},'isAllowEdit':{'$first':_0x972525(0x219)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x57c6e3[0x0][_0x972525(0x260)]==_0x972525(0x1ca)){var _0x19eca5=users[_0x972525(0x25b)];console[_0x972525(0x239)](_0x19eca5);}else{if(_0x57c6e3[0x0][_0x972525(0x260)]=='Hindi')var _0x19eca5=users[_0x972525(0x241)];else{if(_0x57c6e3[0x0][_0x972525(0x260)]=='German')var _0x19eca5=users[_0x972525(0x24b)];else{if(_0x57c6e3[0x0][_0x972525(0x260)]==_0x972525(0x1eb))var _0x19eca5=users[_0x972525(0x1eb)];else{if(_0x57c6e3[0x0]['language']==_0x972525(0x1ec))var _0x19eca5=users[_0x972525(0x1ec)];else{if(_0x57c6e3[0x0]['language']==_0x972525(0x250))var _0x19eca5=users[_0x972525(0x201)];else{if(_0x57c6e3[0x0]['language']==_0x972525(0x1a1))var _0x19eca5=users[_0x972525(0x1a1)];else{if(_0x57c6e3[0x0][_0x972525(0x260)]==_0x972525(0x1d7))var _0x19eca5=users[_0x972525(0x1b6)];}}}}}}}_0x1c9115[_0x972525(0x1b8)](_0x972525(0x262),{'success':_0x2f57b5['flash']('success'),'errors':_0x2f57b5[_0x972525(0x22f)](_0x972525(0x1f6)),'role':_0x5fd199,'profile':_0x474c50,'master_shop':_0x57c6e3,'transfer':_0x1d2839,'language':_0x19eca5});}catch(_0x34d2df){console[_0x972525(0x239)](_0x34d2df);}});async function getRandom8DigitNumber(){var _0x53e464=a0_0x395688;const _0x32818e=0x989680,_0x315a9a=0x5f5e0ff,_0x49376c=Math[_0x53e464(0x211)](Math['random']()*(_0x315a9a-_0x32818e+0x1))+_0x32818e;var _0x327964;const _0x4de5d3=await transfers[_0x53e464(0x216)]({'invoice':_0x53e464(0x23f)+_0x49376c});return _0x4de5d3&&_0x4de5d3['length']>0x0?_0x327964='TRF-'+_0x49376c:_0x327964=_0x53e464(0x23f)+_0x49376c,_0x327964;}router[a0_0x395688(0x234)](a0_0x395688(0x1b4),auth,async(_0x41c691,_0x37e218)=>{var _0x23d664=a0_0x395688;try{const {username:_0xf15909,email:_0x2d7e84,role:_0x505db0}=_0x41c691['user'],_0x3c676d=_0x41c691['user'],_0x466773=await profile[_0x23d664(0x216)]({'email':_0x3c676d[_0x23d664(0x24a)]}),_0x26d689=await master_shop[_0x23d664(0x1ee)]();console['log']('master',_0x26d689);let _0x3edaa6;if(_0x3c676d[_0x23d664(0x1cd)]=='staff'){const _0x2681db=await staff[_0x23d664(0x216)]({'email':_0x3c676d['email']});_0x3edaa6=await warehouse[_0x23d664(0x1f3)]([{'$match':{'status':_0x23d664(0x19e),'name':_0x2681db[_0x23d664(0x26f)],'warehouse_category':_0x23d664(0x18f)}},{'$group':{'_id':_0x23d664(0x270),'name':{'$first':_0x23d664(0x270)}}}]);}else _0x3edaa6=await warehouse[_0x23d664(0x1f3)]([{'$match':{'status':_0x23d664(0x19e),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x23d664(0x270),'name':{'$first':_0x23d664(0x270)}}}]);var _0x2d0dd9=[_0x23d664(0x1bf),_0x23d664(0x217),_0x23d664(0x1ab)];const _0x47f104=await transfers[_0x23d664(0x1ee)]({}),_0x1edc22=_0x47f104[_0x23d664(0x182)]+0x1,_0x591aef=_0x23d664(0x23f)+_0x1edc22['toString']()[_0x23d664(0x203)](0x5,'0');if(_0x26d689[0x0][_0x23d664(0x260)]==_0x23d664(0x1ca)){var _0x146a29=users['English'];console['log'](_0x146a29);}else{if(_0x26d689[0x0][_0x23d664(0x260)]==_0x23d664(0x241))var _0x146a29=users[_0x23d664(0x241)];else{if(_0x26d689[0x0][_0x23d664(0x260)]==_0x23d664(0x24b))var _0x146a29=users[_0x23d664(0x24b)];else{if(_0x26d689[0x0][_0x23d664(0x260)]==_0x23d664(0x1eb))var _0x146a29=users[_0x23d664(0x1eb)];else{if(_0x26d689[0x0][_0x23d664(0x260)]==_0x23d664(0x1ec))var _0x146a29=users[_0x23d664(0x1ec)];else{if(_0x26d689[0x0][_0x23d664(0x260)]==_0x23d664(0x250))var _0x146a29=users['Portuguese'];else{if(_0x26d689[0x0][_0x23d664(0x260)]==_0x23d664(0x1a1))var _0x146a29=users['Chinese'];else{if(_0x26d689[0x0]['language']=='Arabic\x20(ae)')var _0x146a29=users['Arabic'];}}}}}}}const _0x223b76=getRandom8DigitNumber();_0x223b76[_0x23d664(0x20c)](_0x16925d=>{var _0x40e886=_0x23d664;_0x37e218['render'](_0x40e886(0x245),{'success':_0x41c691[_0x40e886(0x22f)]('success'),'errors':_0x41c691[_0x40e886(0x22f)](_0x40e886(0x1f6)),'role':_0x3c676d,'profile':_0x466773,'master_shop':_0x26d689,'warehouse':_0x3edaa6,'language':_0x146a29,'rooms_data':_0x2d0dd9,'invoice':_0x16925d});})[_0x23d664(0x1be)](_0x23b49f=>{var _0x1322b8=_0x23d664;_0x41c691['flash'](_0x1322b8(0x1f6),_0x1322b8(0x1a8)),_0x37e218[_0x1322b8(0x215)]('/transfer/view');});}catch(_0x31e50f){console['log'](_0x31e50f);}}),router[a0_0x395688(0x1c1)]('/view/add_transfer',auth,async(_0x4ebc4d,_0x4f9716)=>{var _0x44d44c=a0_0x395688;try{console[_0x44d44c(0x239)](_0x4ebc4d[_0x44d44c(0x20f)]);const {date:_0x18ad8d,from_warehouse:_0x5a199f,FromRoom_name:_0x74a1cf,to_warehouse:_0x330c7b,ToRoom_name:_0x1cbe80,prod_name:_0x58b841,from_prod_qty:_0x491219,from_prod_level:_0x17d48d,from_prod_isle:_0xdf7db5,from_prod_pallet:_0x42c770,to_prod_qty:_0x111924,to_prod_level:_0x1f4911,to_prod_isle:_0x504063,to_prod_pallet:_0x52b141,primary_code:_0x5d11e,secondary_code:_0x5e9a06,product_code3:_0x120f28,note:_0xe78d9,MaxStocks_data2:_0x2eaeb5,invoice:_0xc141c7,expiry_date:_0x4e4e2a}=_0x4ebc4d['body'];if(typeof _0x58b841==_0x44d44c(0x26e))var _0x21bb23=[_0x4ebc4d['body']['prod_name']],_0x17ffb4=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x191)]],_0x40aed1=[_0x4ebc4d['body'][_0x44d44c(0x1d6)]],_0x315f59=[_0x4ebc4d[_0x44d44c(0x20f)]['New_Qty_Converted']],_0x2eab10=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x204)]],_0x2fda77=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x229)]],_0x4b2fbc=[_0x4ebc4d['body']['secondary_code']],_0x58d540=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x20e)]],_0x30a7c2=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1c5)]],_0xfa2c44=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x210)]],_0xfc0f5=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x259)]],_0x459126=[_0x4ebc4d['body'][_0x44d44c(0x1ba)]],_0x119fd9=[_0x4ebc4d[_0x44d44c(0x20f)]['expiry_date']],_0x1a57d5=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1ae)]],_0x3437bb=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1de)]],_0x1a671f=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x21f)]],_0x2cc117=[_0x4ebc4d['body']['RoomAssigned']],_0x2a2924=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1a3)]],_0x1e6345=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1c2)]],_0x3dbc59=[_0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1e0)]],_0xa806c3=[_0x4ebc4d[_0x44d44c(0x20f)]['id_transaction']];else var _0x21bb23=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x20b)]],_0x17ffb4=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x191)]],_0x40aed1=[..._0x4ebc4d[_0x44d44c(0x20f)]['from_prod_level']],_0x315f59=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1cb)]],_0x2eab10=[..._0x4ebc4d[_0x44d44c(0x20f)]['to_prod_level']],_0x2fda77=[..._0x4ebc4d[_0x44d44c(0x20f)]['primary_code']],_0x4b2fbc=[..._0x4ebc4d['body'][_0x44d44c(0x1fa)]],_0x58d540=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x20e)]],_0x30a7c2=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1c5)]],_0xfa2c44=[..._0x4ebc4d['body']['primary_unit']],_0xfc0f5=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x259)]],_0x459126=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1ba)]],_0x119fd9=[..._0x4ebc4d['body']['expiry_date']],_0x1a57d5=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1ae)]],_0x3437bb=[..._0x4ebc4d['body']['production_date']],_0x1a671f=[..._0x4ebc4d['body'][_0x44d44c(0x21f)]],_0x2cc117=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1c7)]],_0x2a2924=[..._0x4ebc4d[_0x44d44c(0x20f)]['ToRoomAssigned']],_0x1e6345=[..._0x4ebc4d[_0x44d44c(0x20f)][_0x44d44c(0x1c2)]],_0x3dbc59=[..._0x4ebc4d['body']['to_invoice']],_0xa806c3=[..._0x4ebc4d['body'][_0x44d44c(0x1da)]];const _0x191b48=_0x21bb23['map'](_0x8b0ba5=>{return _0x8b0ba5={'product_name':_0x8b0ba5};});_0x17ffb4[_0x44d44c(0x1a4)]((_0x5eb81e,_0x24cc0c)=>{var _0x51e70d=_0x44d44c;_0x191b48[_0x24cc0c][_0x51e70d(0x1d1)]=_0x5eb81e;}),_0x1e6345[_0x44d44c(0x1a4)]((_0x11224e,_0x281ba2)=>{var _0x1b124b=_0x44d44c;_0x191b48[_0x281ba2][_0x1b124b(0x1c2)]=_0x11224e;}),_0x3dbc59[_0x44d44c(0x1a4)]((_0x2437b5,_0x5143ee)=>{_0x191b48[_0x5143ee]['To_invoice']=_0x2437b5;}),_0xa806c3[_0x44d44c(0x1a4)]((_0x3a1e58,_0x1bbb57)=>{_0x191b48[_0x1bbb57]['id_transaction_id']=_0x3a1e58;}),_0x40aed1['forEach']((_0x11b5b6,_0x36b64d)=>{var _0x38d001=_0x44d44c;_0x2cc117[_0x38d001(0x1a4)]((_0x5b41,_0x3a412d)=>{var _0x1d38fc=_0x38d001;if(_0x5b41==_0x1d38fc(0x200)&&_0x36b64d==_0x3a412d){var _0x3eb791=_0x11b5b6[_0x1d38fc(0x198)](0x3);_0x191b48[_0x36b64d]['from_storage']=_0x11b5b6[0x0],_0x191b48[_0x36b64d][_0x1d38fc(0x225)]=_0x11b5b6[0x1],_0x191b48[_0x36b64d][_0x1d38fc(0x1b0)]=0x0,_0x191b48[_0x36b64d]['from_bin']=0x0,_0x191b48[_0x36b64d][_0x1d38fc(0x1c3)]='Floor',_0x191b48[_0x36b64d][_0x1d38fc(0x1ff)]=_0x3eb791;}else{if(_0x5b41==_0x1d38fc(0x1d5)&&_0x36b64d==_0x3a412d){var _0x3eb791=_0x11b5b6[_0x1d38fc(0x198)](0x3);_0x191b48[_0x36b64d][_0x1d38fc(0x1c9)]=_0x11b5b6[0x0],_0x191b48[_0x36b64d][_0x1d38fc(0x225)]=_0x11b5b6[0x1],_0x191b48[_0x36b64d]['from_bay']=0x0,_0x191b48[_0x36b64d][_0x1d38fc(0x268)]=0x0,_0x191b48[_0x36b64d][_0x1d38fc(0x1c3)]=_0x1d38fc(0x181),_0x191b48[_0x36b64d][_0x1d38fc(0x1ff)]=_0x11b5b6[0x5];}else{if(_0x36b64d==_0x3a412d){if(_0x11b5b6[0x0]=='A'&&_0x11b5b6[0x1]=='L'&&_0x11b5b6[0x2]=='L')console[_0x1d38fc(0x239)](_0x5b41+_0x1d38fc(0x233)+_0x36b64d+'\x20<>\x20'+_0x3a412d+_0x1d38fc(0x233)+_0x11b5b6+_0x1d38fc(0x1e9)),_0x191b48[_0x36b64d][_0x1d38fc(0x1c9)]=_0x11b5b6[0x0],_0x191b48[_0x36b64d]['from_rack']=_0x11b5b6[0x1],_0x191b48[_0x36b64d]['from_bay']=0x0,_0x191b48[_0x36b64d][_0x1d38fc(0x268)]=0x0,_0x191b48[_0x36b64d][_0x1d38fc(0x1c3)]=_0x1d38fc(0x181),_0x191b48[_0x36b64d][_0x1d38fc(0x1ff)]=_0x11b5b6[0x3];else{var _0x38842a;if(_0x11b5b6[0x4]=='L')_0x38842a=_0x1d38fc(0x213);else _0x11b5b6[0x4]=='F'&&(_0x38842a='Floor');_0x191b48[_0x36b64d][_0x1d38fc(0x1c9)]=_0x11b5b6[0x0],_0x191b48[_0x36b64d][_0x1d38fc(0x225)]=_0x11b5b6[0x1],_0x191b48[_0x36b64d]['from_bay']=_0x11b5b6[0x2],_0x191b48[_0x36b64d][_0x1d38fc(0x268)]=_0x11b5b6[0x3],_0x191b48[_0x36b64d][_0x1d38fc(0x1c3)]=_0x38842a,_0x191b48[_0x36b64d][_0x1d38fc(0x1ff)]=_0x11b5b6[0x5];}}}}});}),_0x315f59[_0x44d44c(0x1a4)]((_0x154f08,_0x103696)=>{var _0x13d30b=_0x44d44c;_0x191b48[_0x103696][_0x13d30b(0x1c8)]=_0x154f08;}),_0x2eab10[_0x44d44c(0x1a4)]((_0x534f3f,_0x44b4ae)=>{var _0x2b7b22=_0x44d44c;_0x2a2924[_0x2b7b22(0x1a4)]((_0x3e6ce8,_0x31250b)=>{var _0x2f5d1c=_0x2b7b22;if(_0x3e6ce8==_0x2f5d1c(0x200)&&_0x44b4ae==_0x31250b){var _0x4909ad=_0x534f3f[_0x2f5d1c(0x198)](0x3);_0x191b48[_0x44b4ae][_0x2f5d1c(0x256)]=_0x534f3f[0x0],_0x191b48[_0x44b4ae][_0x2f5d1c(0x23b)]=_0x534f3f[0x1],_0x191b48[_0x44b4ae][_0x2f5d1c(0x1d0)]=0x0,_0x191b48[_0x44b4ae][_0x2f5d1c(0x1f8)]=0x0,_0x191b48[_0x44b4ae][_0x2f5d1c(0x251)]=_0x2f5d1c(0x181),_0x191b48[_0x44b4ae][_0x2f5d1c(0x186)]=_0x4909ad;}else{if(_0x3e6ce8==_0x2f5d1c(0x1d5)&&_0x44b4ae==_0x31250b){var _0x4909ad=_0x534f3f['slice'](0x3);_0x191b48[_0x44b4ae][_0x2f5d1c(0x256)]=_0x534f3f[0x0],_0x191b48[_0x44b4ae][_0x2f5d1c(0x23b)]=_0x534f3f[0x1],_0x191b48[_0x44b4ae][_0x2f5d1c(0x1d0)]=0x0,_0x191b48[_0x44b4ae][_0x2f5d1c(0x1f8)]=0x0,_0x191b48[_0x44b4ae]['to_types']=_0x2f5d1c(0x181),_0x191b48[_0x44b4ae][_0x2f5d1c(0x186)]=_0x534f3f[0x5];}else{if(_0x44b4ae==_0x31250b){if(_0x534f3f[0x0]=='A'&&_0x534f3f[0x1]=='L'&&_0x534f3f[0x2]=='L')console[_0x2f5d1c(0x239)](_0x3e6ce8+_0x2f5d1c(0x233)+_0x44b4ae+_0x2f5d1c(0x233)+_0x31250b+_0x2f5d1c(0x233)+_0x534f3f+'here'),_0x191b48[_0x44b4ae][_0x2f5d1c(0x256)]=_0x534f3f[0x0],_0x191b48[_0x44b4ae]['rack']=_0x534f3f[0x1],_0x191b48[_0x44b4ae][_0x2f5d1c(0x1d0)]=0x0,_0x191b48[_0x44b4ae][_0x2f5d1c(0x1f8)]=0x0,_0x191b48[_0x44b4ae][_0x2f5d1c(0x251)]='Floor',_0x191b48[_0x44b4ae][_0x2f5d1c(0x186)]=_0x534f3f[0x3];else{var _0x11fb28;if(_0x534f3f[0x4]=='L')_0x11fb28=_0x2f5d1c(0x213);else _0x534f3f[0x4]=='F'&&(_0x11fb28='Floor');_0x191b48[_0x44b4ae][_0x2f5d1c(0x256)]=_0x534f3f[0x0],_0x191b48[_0x44b4ae][_0x2f5d1c(0x23b)]=_0x534f3f[0x1],_0x191b48[_0x44b4ae][_0x2f5d1c(0x1d0)]=_0x534f3f[0x2],_0x191b48[_0x44b4ae][_0x2f5d1c(0x1f8)]=_0x534f3f[0x3],_0x191b48[_0x44b4ae]['to_types']=_0x11fb28,_0x191b48[_0x44b4ae][_0x2f5d1c(0x186)]=_0x534f3f[0x5];}}}}});}),_0x2fda77[_0x44d44c(0x1a4)]((_0x52fbbb,_0x2c18ae)=>{var _0x512c86=_0x44d44c;_0x191b48[_0x2c18ae][_0x512c86(0x229)]=_0x52fbbb;}),_0x4b2fbc[_0x44d44c(0x1a4)]((_0x3f262f,_0x28042f)=>{var _0x1e1dce=_0x44d44c;_0x191b48[_0x28042f][_0x1e1dce(0x1fa)]=_0x3f262f;}),_0x58d540[_0x44d44c(0x1a4)]((_0xb34bf3,_0x1a444c)=>{var _0x1ca116=_0x44d44c;_0x191b48[_0x1a444c][_0x1ca116(0x222)]=_0xb34bf3;}),_0x30a7c2['forEach']((_0x36ee66,_0x9eadff)=>{var _0x43c655=_0x44d44c;_0x191b48[_0x9eadff][_0x43c655(0x265)]=_0x36ee66;}),_0xfa2c44['forEach']((_0x3e6da4,_0x490d33)=>{var _0x3618b5=_0x44d44c;_0x191b48[_0x490d33][_0x3618b5(0x19a)]=_0x3e6da4;}),_0xfc0f5['forEach']((_0xccf76,_0x8b5729)=>{var _0x198451=_0x44d44c;_0x191b48[_0x8b5729][_0x198451(0x259)]=_0xccf76;}),_0x459126['forEach']((_0xc68c3b,_0xc95b3f)=>{var _0x15aa2a=_0x44d44c;_0x191b48[_0xc95b3f][_0x15aa2a(0x1ba)]=_0xc68c3b;}),_0x119fd9['forEach']((_0x4d52d9,_0x13c088)=>{var _0x29569f=_0x44d44c;_0x191b48[_0x13c088][_0x29569f(0x261)]=_0x4d52d9;}),_0x1a57d5[_0x44d44c(0x1a4)]((_0x144f36,_0x380b35)=>{var _0x406538=_0x44d44c;_0x191b48[_0x380b35][_0x406538(0x1b3)]=_0x144f36;}),_0x3437bb[_0x44d44c(0x1a4)]((_0x250191,_0x2a78f0)=>{var _0x2ba244=_0x44d44c;_0x191b48[_0x2a78f0][_0x2ba244(0x1de)]=_0x250191;}),_0x1a671f[_0x44d44c(0x1a4)]((_0xb4abb,_0x43e40b)=>{var _0x2c2307=_0x44d44c;_0x191b48[_0x43e40b][_0x2c2307(0x21f)]=_0xb4abb;}),_0x2cc117[_0x44d44c(0x1a4)]((_0x21050c,_0x2a163d)=>{var _0x59dd20=_0x44d44c;_0x191b48[_0x2a163d][_0x59dd20(0x243)]=_0x21050c;}),_0x2a2924[_0x44d44c(0x1a4)]((_0x47f9b8,_0x528713)=>{var _0x1529e5=_0x44d44c;_0x191b48[_0x528713][_0x1529e5(0x1ac)]=_0x47f9b8;});const _0x48ee1e=_0x191b48[_0x44d44c(0x1a7)](_0x7d6d05=>_0x7d6d05[_0x44d44c(0x1c8)]!=='0'&&_0x7d6d05[_0x44d44c(0x1c8)]!==''||_0x7d6d05[_0x44d44c(0x186)]!=='0'&&_0x7d6d05['to_floorlevel']!==''),_0x5e7950=new transfers({'date':_0x18ad8d,'from_warehouse':_0x5a199f,'to_warehouse':_0x330c7b,'product':_0x48ee1e,'note':_0xe78d9,'invoice':_0xc141c7}),_0x17c36a=await _0x5e7950[_0x44d44c(0x253)]();_0x4ebc4d[_0x44d44c(0x22f)](_0x44d44c(0x1b5),_0x44d44c(0x1dc)),_0x4f9716['redirect'](_0x44d44c(0x184)+_0x17c36a[_0x44d44c(0x1aa)]);}catch(_0x5d7297){console['log'](_0x5d7297),_0x4f9716[_0x44d44c(0x21a)](0xc8)[_0x44d44c(0x242)]({'errorMessage':_0x5d7297[_0x44d44c(0x199)]});}}),router[a0_0x395688(0x234)](a0_0x395688(0x1e3),auth,async(_0xb3181a,_0x168157)=>{var _0x1bd9a5=a0_0x395688;try{const {username:_0x1ff1ad,email:_0x6c8570,role:_0x10cd22}=_0xb3181a[_0x1bd9a5(0x1a9)],_0x4afac1=_0xb3181a[_0x1bd9a5(0x1a9)],_0x556c7e=await profile[_0x1bd9a5(0x216)]({'email':_0x4afac1[_0x1bd9a5(0x24a)]}),_0x499d19=await master_shop[_0x1bd9a5(0x1ee)]();console[_0x1bd9a5(0x239)](_0x1bd9a5(0x1f2),_0x499d19);const _0x4ee5a1=await transfers[_0x1bd9a5(0x22c)](_0xb3181a[_0x1bd9a5(0x26a)]['id']);let _0x53b97f=new Date(_0x4ee5a1['expiry_date']),_0x193dec=('0'+_0x53b97f[_0x1bd9a5(0x235)]())[_0x1bd9a5(0x198)](-0x2),_0x41594d=('0'+(_0x53b97f[_0x1bd9a5(0x208)]()+0x1))['slice'](-0x2),_0x3ef56c=_0x53b97f[_0x1bd9a5(0x1b1)](),_0x1fc59d=_0x3ef56c+'-'+_0x41594d+'-'+_0x193dec,_0x34fddb;if(_0x4afac1[_0x1bd9a5(0x1cd)]==_0x1bd9a5(0x223)){const _0x1f8b7e=await staff[_0x1bd9a5(0x216)]({'email':_0x4afac1[_0x1bd9a5(0x24a)]});_0x34fddb=await warehouse[_0x1bd9a5(0x1ee)]({'status':'Enabled','name':_0x1f8b7e[_0x1bd9a5(0x26f)],'warehouse_category':_0x1bd9a5(0x18f)});}else _0x34fddb=await warehouse[_0x1bd9a5(0x1ee)]({'status':_0x1bd9a5(0x19e),'warehouse_category':'Raw\x20Materials'});const _0x10a5c8=await warehouse[_0x1bd9a5(0x1f3)]([{'$match':{'name':_0x4ee5a1[_0x1bd9a5(0x264)]}},{'$unwind':_0x1bd9a5(0x20a)},{'$group':{'_id':_0x1bd9a5(0x1db),'name':{'$first':_0x1bd9a5(0x18a)},'product_stock':{'$first':_0x1bd9a5(0x1e7)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1bd9a5(0x190)},'type':{'$first':_0x1bd9a5(0x1ed)},'floorlevel':{'$first':_0x1bd9a5(0x237)},'primary_code':{'$first':_0x1bd9a5(0x195)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1bd9a5(0x231)},'rack':{'$first':_0x1bd9a5(0x19d)},'expiry_date':{'$first':_0x1bd9a5(0x1bc)},'production_date':{'$first':_0x1bd9a5(0x23e)},'room':{'$first':_0x1bd9a5(0x22a)}}}]);if(_0x499d19[0x0][_0x1bd9a5(0x260)]==_0x1bd9a5(0x1ca)){var _0x599b66=users[_0x1bd9a5(0x25b)];console[_0x1bd9a5(0x239)](_0x599b66);}else{if(_0x499d19[0x0][_0x1bd9a5(0x260)]==_0x1bd9a5(0x241))var _0x599b66=users[_0x1bd9a5(0x241)];else{if(_0x499d19[0x0][_0x1bd9a5(0x260)]=='German')var _0x599b66=users[_0x1bd9a5(0x24b)];else{if(_0x499d19[0x0]['language']==_0x1bd9a5(0x1eb))var _0x599b66=users[_0x1bd9a5(0x1eb)];else{if(_0x499d19[0x0]['language']=='French')var _0x599b66=users[_0x1bd9a5(0x1ec)];else{if(_0x499d19[0x0][_0x1bd9a5(0x260)]==_0x1bd9a5(0x250))var _0x599b66=users['Portuguese'];else{if(_0x499d19[0x0][_0x1bd9a5(0x260)]==_0x1bd9a5(0x1a1))var _0x599b66=users[_0x1bd9a5(0x1a1)];else{if(_0x499d19[0x0][_0x1bd9a5(0x260)]==_0x1bd9a5(0x1d7))var _0x599b66=users[_0x1bd9a5(0x1b6)];}}}}}}}_0x168157[_0x1bd9a5(0x1b8)](_0x1bd9a5(0x257),{'success':_0xb3181a[_0x1bd9a5(0x22f)](_0x1bd9a5(0x1b5)),'errors':_0xb3181a[_0x1bd9a5(0x22f)](_0x1bd9a5(0x1f6)),'role':_0x4afac1,'profile':_0x556c7e,'master_shop':_0x499d19,'warehouse':_0x34fddb,'transfer':_0x4ee5a1,'stock':_0x10a5c8,'language':_0x599b66});}catch(_0x13b75c){console[_0x1bd9a5(0x239)](_0x13b75c);}}),router[a0_0x395688(0x1c1)](a0_0x395688(0x1e3),auth,async(_0x28c6c6,_0x2dbf72)=>{var _0xbafb58=a0_0x395688;try{const _0x1f08b6=_0x28c6c6[_0xbafb58(0x26a)]['id'],{from_warehouse:_0x5a4979,FromRoom_name:_0x506ce7,to_warehouse:_0x20b72f,ToRoom_name:_0x30eb31}=_0x28c6c6[_0xbafb58(0x20f)],_0x1b6f23=await transfers['findById']({'_id':_0x1f08b6}),_0x27c013=_0x1b6f23['product'][_0xbafb58(0x24d)](async _0x9ce1a9=>{var _0x4f8410=_0xbafb58;if(_0x9ce1a9[_0x4f8410(0x1c8)]>0x0){var _0x41706d=await warehouse[_0x4f8410(0x216)]({'name':_0x1b6f23[_0x4f8410(0x264)],'room':_0x9ce1a9[_0x4f8410(0x243)],'warehouse_category':'Raw\x20Materials'});const _0x1036a5=_0x41706d[_0x4f8410(0x26c)][_0x4f8410(0x24d)](_0x2b2842=>{var _0x503e97=_0x4f8410;_0x2b2842[_0x503e97(0x227)]==_0x9ce1a9[_0x503e97(0x227)]&&_0x2b2842[_0x503e97(0x21c)]==_0x9ce1a9[_0x503e97(0x1ff)]&&_0x2b2842[_0x503e97(0x246)]==_0x9ce1a9[_0x503e97(0x1c3)]&&_0x2b2842[_0x503e97(0x1ce)]==_0x9ce1a9['from_bin']&&_0x2b2842[_0x503e97(0x1ad)]==_0x9ce1a9[_0x503e97(0x1b0)]&&_0x2b2842[_0x503e97(0x23b)]==_0x9ce1a9[_0x503e97(0x225)]&&_0x2b2842[_0x503e97(0x256)]==_0x9ce1a9[_0x503e97(0x1c9)]&&_0x2b2842[_0x503e97(0x261)]==_0x9ce1a9[_0x503e97(0x261)]&&_0x2b2842[_0x503e97(0x1ba)]==_0x9ce1a9[_0x503e97(0x1ba)]&&_0x2b2842[_0x503e97(0x1de)]==_0x9ce1a9[_0x503e97(0x1de)]&&_0x2b2842[_0x503e97(0x23c)]==_0x9ce1a9['from_invoice']&&_0x2b2842[_0x503e97(0x1aa)]==_0x9ce1a9[_0x503e97(0x1d3)]&&(_0x2b2842[_0x503e97(0x26d)]=_0x2b2842['product_stock']-_0x9ce1a9[_0x503e97(0x1c8)]);});}return _0x41706d;});Promise['all'](_0x27c013)[_0xbafb58(0x20c)](async _0x3ff9fb=>{var _0x5c3e29=_0xbafb58;try{for(const _0x30a1ed of _0x3ff9fb){await _0x30a1ed[_0x5c3e29(0x253)]();}try{const _0x467b6b=_0x1b6f23[_0x5c3e29(0x1e6)][_0x5c3e29(0x24d)](async _0xf6a4bd=>{var _0x279cc2=_0x5c3e29;if(_0xf6a4bd[_0x279cc2(0x1c8)]>0x0){var _0x477dcc=await warehouse[_0x279cc2(0x216)]({'name':_0x1b6f23[_0x279cc2(0x1fe)],'room':_0xf6a4bd[_0x279cc2(0x1ac)],'warehouse_category':_0x279cc2(0x18f)}),_0x5d1a04=0x0;const _0x5a429a=_0x477dcc[_0x279cc2(0x26c)][_0x279cc2(0x24d)](_0x238b7e=>{var _0x3426fd=_0x279cc2;_0x238b7e['product_name']==_0xf6a4bd[_0x3426fd(0x227)]&&_0x238b7e['floorlevel']==_0xf6a4bd[_0x3426fd(0x186)]&&_0x238b7e[_0x3426fd(0x246)]==_0xf6a4bd[_0x3426fd(0x251)]&&_0x238b7e['bin']==_0xf6a4bd['to_bin']&&_0x238b7e[_0x3426fd(0x1ad)]==_0xf6a4bd[_0x3426fd(0x1d0)]&&_0x238b7e[_0x3426fd(0x23b)]==_0xf6a4bd['rack']&&_0x238b7e[_0x3426fd(0x256)]==_0xf6a4bd['storage']&&_0x238b7e[_0x3426fd(0x261)]==_0xf6a4bd['expiry_date']&&_0x238b7e[_0x3426fd(0x1ba)]==_0xf6a4bd[_0x3426fd(0x1ba)]&&_0x238b7e['production_date']==_0xf6a4bd[_0x3426fd(0x1de)]&&_0x238b7e[_0x3426fd(0x23c)]==_0xf6a4bd[_0x3426fd(0x1a5)]&&(_0x238b7e[_0x3426fd(0x26d)]=_0x238b7e[_0x3426fd(0x26d)]+_0xf6a4bd[_0x3426fd(0x1c8)],_0x5d1a04++);});_0x5d1a04=='0'&&(_0x477dcc[_0x279cc2(0x26c)]=_0x477dcc[_0x279cc2(0x26c)][_0x279cc2(0x1ea)]({'product_name':_0xf6a4bd['product_name'],'product_stock':_0xf6a4bd[_0x279cc2(0x1c8)],'bay':_0xf6a4bd['to_bay'],'bin':_0xf6a4bd['to_bin'],'type':_0xf6a4bd['to_types'],'floorlevel':_0xf6a4bd[_0x279cc2(0x186)],'storage':_0xf6a4bd['storage'],'rack':_0xf6a4bd[_0x279cc2(0x23b)],'product_code':_0xf6a4bd[_0x279cc2(0x222)],'primary_code':_0xf6a4bd[_0x279cc2(0x229)],'secondary_code':_0xf6a4bd[_0x279cc2(0x1fa)],'maxProducts':_0xf6a4bd[_0x279cc2(0x265)],'storage':_0xf6a4bd[_0x279cc2(0x256)],'rack':_0xf6a4bd[_0x279cc2(0x23b)],'expiry_date':_0xf6a4bd[_0x279cc2(0x261)],'maxPerUnit':_0xf6a4bd[_0x279cc2(0x1b3)],'batch_code':_0xf6a4bd['batch_code'],'production_date':_0xf6a4bd['production_date']}));}return _0x477dcc;});Promise['all'](_0x467b6b)[_0x5c3e29(0x20c)](async _0x3a3670=>{var _0x1d04bb=_0x5c3e29;try{for(const _0x4aa4c7 of _0x3a3670){await warehouse[_0x1d04bb(0x1d2)]({'_id':_0x4aa4c7[_0x1d04bb(0x1aa)]},{'$addToSet':{'product_details':{'$each':_0x4aa4c7[_0x1d04bb(0x26c)]}}});}_0x1b6f23[_0x1d04bb(0x240)]='True';const _0x1b3b99=await _0x1b6f23['save'](),_0xf030c5=await master_shop['find'](),_0x404cfc=await email_settings[_0x1d04bb(0x216)](),_0x18637e=await supervisor_settings[_0x1d04bb(0x1ee)]();var _0x8d5e71=_0x1b6f23[_0x1d04bb(0x1e6)],_0x1615e4='',_0x38eeb8;for(_0x38eeb8 in _0x8d5e71){_0x1615e4+=_0x1d04bb(0x185)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8d5e71[_0x38eeb8][_0x1d04bb(0x227)]+_0x1d04bb(0x252)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8d5e71[_0x38eeb8]['product_code']+_0x1d04bb(0x252)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8d5e71[_0x38eeb8][_0x1d04bb(0x1c8)]+_0x1d04bb(0x252)+_0x1d04bb(0x1bb)+_0x8d5e71[_0x38eeb8][_0x1d04bb(0x19a)]+_0x1d04bb(0x252)+_0x1d04bb(0x1bb)+_0x8d5e71[_0x38eeb8]['secondary_unit']+_0x1d04bb(0x252)+_0x1d04bb(0x1bb)+_0x1b6f23['to_warehouse']+_0x1d04bb(0x252)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8d5e71[_0x38eeb8][_0x1d04bb(0x1ac)]+_0x1d04bb(0x252)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8d5e71[_0x38eeb8]['storage']+_0x8d5e71[_0x38eeb8]['rack']+_0x8d5e71[_0x38eeb8][_0x1d04bb(0x1d0)]+_0x8d5e71[_0x38eeb8]['to_bin']+_0x8d5e71[_0x38eeb8][_0x1d04bb(0x251)][0x0]+_0x8d5e71[_0x38eeb8][_0x1d04bb(0x186)]+_0x1d04bb(0x252),_0x1d04bb(0x22b);}let _0x2e6170=nodemailer[_0x1d04bb(0x1fb)]({'host':_0x404cfc[_0x1d04bb(0x1e2)],'port':Number(_0x404cfc['port']),'secure':![],'auth':{'user':_0x404cfc[_0x1d04bb(0x24a)],'pass':_0x404cfc['password']}}),_0x147f19={'from':_0x404cfc[_0x1d04bb(0x24a)],'to':_0x18637e[0x0]['RMSEmail'],'subject':_0x1d04bb(0x1c4),'attachments':[{'filename':'Logo.png','path':__dirname+_0x1d04bb(0x189)+'/upload/'+_0xf030c5[0x0][_0x1d04bb(0x18d)],'cid':'logo'}],'html':_0x1d04bb(0x1c0)+_0x1d04bb(0x273)+_0x1d04bb(0x1f7)+_0x1d04bb(0x238)+_0x1d04bb(0x22e)+_0x1d04bb(0x238)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1d04bb(0x25e)+_0x1d04bb(0x238)+_0x1d04bb(0x254)+_0xf030c5[0x0][_0x1d04bb(0x1cf)]+'\x20</h2>'+_0x1d04bb(0x25e)+_0x1d04bb(0x25e)+_0x1d04bb(0x1c6)+_0x1d04bb(0x238)+_0x1d04bb(0x1bd)+_0x1d04bb(0x214)+_0x1b6f23[_0x1d04bb(0x23c)]+'\x20'+_0x1d04bb(0x1d8)+_0x1d04bb(0x194)+_0x1b6f23['date']+'\x20'+'</span>'+_0x1d04bb(0x23a)+_0x1d04bb(0x25e)+_0x1d04bb(0x1dd)+_0x1d04bb(0x1f4)+_0x1d04bb(0x185)+_0x1d04bb(0x266)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x1d04bb(0x23d)+_0x1d04bb(0x206)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x1d04bb(0x207)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x1d04bb(0x263)+_0x1d04bb(0x22b)+_0x1d04bb(0x248)+_0x1d04bb(0x1e8)+'\x20'+_0x1615e4+'\x20'+_0x1d04bb(0x192)+'</table>'+_0x1d04bb(0x238)+_0x1d04bb(0x1e5)+_0x1d04bb(0x230)+_0xf030c5[0x0][_0x1d04bb(0x1cf)]+_0x1d04bb(0x23a)+'</div>'+_0x1d04bb(0x25e)+_0x1d04bb(0x193)};_0x2e6170[_0x1d04bb(0x1a6)](_0x147f19,function(_0x21f865,_0x42a3ec){var _0x37c031=_0x1d04bb;_0x21f865?(console[_0x37c031(0x239)](_0x21f865),console[_0x37c031(0x239)]('Error\x20Occurs')):console['log'](_0x37c031(0x1f1));}),_0x28c6c6['flash'](_0x1d04bb(0x1b5),_0x1d04bb(0x197)),_0x2dbf72[_0x1d04bb(0x215)](_0x1d04bb(0x25c)+_0x1b3b99[_0x1d04bb(0x1aa)]);}catch(_0x2f6b46){console[_0x1d04bb(0x1ef)](_0x2f6b46),_0x2dbf72[_0x1d04bb(0x21a)](0x1f4)[_0x1d04bb(0x242)]({'Perror':_0x1d04bb(0x1a2),'message':_0x2f6b46[_0x1d04bb(0x199)]});}})['catch'](_0x3eb103=>{var _0x544cf5=_0x5c3e29;console['error'](_0x3eb103),_0x2dbf72[_0x544cf5(0x21a)](0x1f4)[_0x544cf5(0x242)]({'Perror':_0x544cf5(0x202)});});}catch(_0x271b95){_0x2dbf72[_0x5c3e29(0x242)](_0x271b95);}}catch(_0x39c7b1){console[_0x5c3e29(0x1ef)](_0x39c7b1),_0x2dbf72[_0x5c3e29(0x21a)](0x1f4)[_0x5c3e29(0x242)]({'Merror':_0x5c3e29(0x1a2),'Message':_0x39c7b1[_0x5c3e29(0x199)]});}})[_0xbafb58(0x1be)](_0x470f79=>{var _0x48ec24=_0xbafb58;console[_0x48ec24(0x1ef)](_0x470f79),_0x2dbf72[_0x48ec24(0x21a)](0x1f4)[_0x48ec24(0x242)]({'Merror':_0x48ec24(0x202)});});}catch(_0x58f975){console[_0xbafb58(0x239)](_0x58f975);}});function a0_0xb45b(_0x173e3d,_0x1ed8d3){var _0x531974=a0_0x5319();return a0_0xb45b=function(_0xb45b9d,_0x1686cf){_0xb45b9d=_0xb45b9d-0x181;var _0x81f34e=_0x531974[_0xb45b9d];return _0x81f34e;},a0_0xb45b(_0x173e3d,_0x1ed8d3);}function a0_0x5319(){var _0x29b6aa=['_id','Return\x20Rooms','to_room_name','bay','max_per_unit','from_prod_isle','from_bay','getFullYear','edit_transfer','maxperunit','/view/add_transfer','success','Arabic','$product','render','$product_details.secondary_unit','batch_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.expiry_date','<h5\x20style=\x22text-align:\x20left;\x22>','catch','Ambient','<!DOCTYPE\x20html>','post','from_invoice','from_types','Transfer\x20Mail','MaxStocks_data2','<hr\x20class=\x22my-3\x22>','RoomAssigned','to_quantity','from_storage','English\x20(US)','New_Qty_Converted','to_prod_pallet','role','bin','site_title','to_bay','from_quantity','updateOne','id_transaction_id','to_room','Shelves','from_prod_level','Arabic\x20(ae)','<span\x20style=\x22float:\x20right;\x22>','back','id_transaction','$product_details._id','Product\x20Transfer\x20successfully','<table\x20style=\x22width:\x20100%\x20!important;\x22>','production_date','Rack\x20B','to_invoice','from_prod_pallet','host','/preview/:id','$product_details.secondary_code','<strong>\x20Regards\x20</strong>','product','$product_details.product_stock','<tbody\x20style=\x22text-align:\x20center;\x22>','here','concat','Spanish','French','$product_details.type','find','error','$invoice','Email\x20sent\x20successfully','master','aggregate','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','to_prod_isle','errors','</head><body>','to_bin','DRY\x20STORAGE','secondary_code','createTransport','$from_warehouse','139210oeXlgB','to_warehouse','from_floorlevel','Receiving\x20Area','Portuguese','An\x20error\x20occurred.','padStart','to_prod_level','date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','getMonth','from_rak','$product_details','prod_name','then','$product_details.batch_code','product_code3','body','primary_unit','floor','express','Level','\x20Order\x20Number\x20:\x20','redirect','findOne','Enclosed','$product_details.pallet','$isAllowEdit','status','$product_details.isle','floorlevel','../models/all_models','220270qIsEmu','prod_cat','Router','$_id','product_code','staff','/barcode_scanner','from_rack','Transfer\x20Edit\x20Successfully','product_name','$product_details.product_code','primary_code','$room','</tr>','findById','rak','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','flash','<h5>','$product_details.storage','13564GnemKw','\x20<>\x20','get','getDate','/transfer/view','$product_details.floorlevel','<div>','log','</h5>','rack','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.production_date','TRF-','finalize','Hindi','json','from_room_name','17556IctkAV','add_transfer','type','$product_details.bay','</thead>','/view','email','German','$product_details.unit','map','../middleware/auth','COLD\x20STORAGE','Portuguese\x20(BR)','to_types','</td>','save','<h2>\x20','all','storage','edit_transfer_view','$date','secondary_unit','$product_details.maxPerUnit','English','/picking_list/PDF_transfer_rm/','/view/:id','</div>','push','language','expiry_date','transfer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','from_warehouse','maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/barcode_scanner3','from_bin','$product_details.level','params','$finalize','product_details','product_stock','string','warehouse','$name','../public/language/languages.json','$product_details.maxProducts','<html><head><title></title>','Floor','length','3qAjuFZ','/transfer/preview/','<tr>','to_floorlevel','165uPuTaY','513646npWiBD','/../public','$product_details.product_name','7536zjhVqn','Rack\x20A','image','/CheckingWarehouse','Raw\x20Materials','$product_details.bin','from_prod_qty','</tbody>','</body></html>','\x20Order\x20Date\x20:\x20','$product_details.primary_code','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Transfer\x20Finalize\x20Successfully','slice','message','unit','631053eusfJi','/barcode_scanner2','$product_details.rack','Enabled','427nJkfim','8zAqydz','Chinese','An\x20error\x20occurred\x20while\x20saving\x20data.','ToRoomAssigned','forEach','To_invoice','sendMail','filter','There\x27s\x20a\x20error\x20in\x20this\x20transaction','user'];a0_0x5319=function(){return _0x29b6aa;};return a0_0x5319();}function BayBinSelected(_0x10e0ce,_0x5770a5){var _0x4ee521=a0_0x395688,_0x32bad0=[],_0x37eb5c=[],_0x14727e=[],_0x42769f=[],_0x784396=[],_0x206367=[];let _0x206929=[];if(_0x10e0ce==_0x4ee521(0x1f9))switch(_0x5770a5){case _0x4ee521(0x18c):_0x32bad0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x37eb5c=[0x1,0x2],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=[_0x4ee521(0x213),'Floor'],_0x784396=['D'],_0x206367=['A'];break;case _0x4ee521(0x1df):_0x32bad0=[0x6,0x5,0x4,0x3,0x2,0x1],_0x37eb5c=[0x1,0x2],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=[_0x4ee521(0x213),_0x4ee521(0x181)],_0x784396=['D'],_0x206367=['B'];break;case _0x4ee521(0x1d5):_0x32bad0=[0x0],_0x37eb5c=[0x0],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=['Floor'],_0x784396=['D'],_0x206367=['S'];break;case _0x4ee521(0x200):_0x32bad0=[0x0],_0x37eb5c=[0x0],_0x42769f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x14727e=[_0x4ee521(0x181)],_0x784396=['D'],_0x206367=['R'];break;}else{if(_0x10e0ce==_0x4ee521(0x24f))switch(_0x5770a5){case _0x4ee521(0x18c):_0x32bad0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x37eb5c=['B','F'],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=[_0x4ee521(0x213),_0x4ee521(0x181)],_0x784396=['C'],_0x206367=['A'];break;case _0x4ee521(0x1df):_0x32bad0=[0x5,0x4,0x3,0x2,0x1],_0x37eb5c=['F','B','S'],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=[_0x4ee521(0x213),_0x4ee521(0x181)],_0x784396=['C'],_0x206367=['B'];break;case'Rack\x20C':_0x32bad0=[0x1,0x2,0x3,0x4,0x5],_0x37eb5c=['B','F','S'],_0x42769f=[0x5,0x4,0x3,0x2,0x1],_0x14727e=[_0x4ee521(0x213),_0x4ee521(0x181)],_0x784396=['C'],_0x206367=['C'];break;case'Rack\x20D':_0x32bad0=[0x5,0x4,0x3,0x2,0x1],_0x37eb5c=['F','B','S'],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=[_0x4ee521(0x213),_0x4ee521(0x181)],_0x784396=['C'],_0x206367=['D'];break;case'Rack\x20E':_0x32bad0=[0x4,0x3,0x2,0x1],_0x37eb5c=[0x1,0x2],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=[_0x4ee521(0x213),_0x4ee521(0x181)],_0x784396=['C'],_0x206367=['E'];break;case'Rack\x20F':_0x32bad0=[0x1,0x2,0x3],_0x37eb5c=[0x1,0x2],_0x42769f=[0x1,0x2,0x3,0x4,0x5],_0x14727e=[_0x4ee521(0x213)],_0x784396=['C'],_0x206367=['F'];break;}}return{'levels':_0x32bad0,'Isle':_0x37eb5c,'rack':_0x42769f,'type':_0x14727e,'storage':_0x784396,'rak':_0x206367};}router[a0_0x395688(0x234)](a0_0x395688(0x25d),auth,async(_0x228719,_0x4b6b39)=>{var _0x34ed21=a0_0x395688;try{const {username:_0x438fc7,email:_0x558746,role:_0x1103dd}=_0x228719[_0x34ed21(0x1a9)],_0x33aaa5=_0x228719[_0x34ed21(0x1a9)],_0x3a1b9f=await profile[_0x34ed21(0x216)]({'email':_0x33aaa5['email']}),_0x2d998b=await master_shop[_0x34ed21(0x1ee)](),_0x50608d=await transfers['findById'](_0x228719['params']['id']);let _0x53c1d3;if(_0x33aaa5[_0x34ed21(0x1cd)]=='staff'){const _0x3768dd=await staff['findOne']({'email':_0x33aaa5['email']});_0x53c1d3=await warehouse[_0x34ed21(0x1f3)]([{'$match':{'status':_0x34ed21(0x19e),'name':_0x3768dd[_0x34ed21(0x26f)],'warehouse_category':_0x34ed21(0x18f)}},{'$group':{'_id':'$name','name':{'$first':_0x34ed21(0x270)}}}]);}else _0x53c1d3=await warehouse[_0x34ed21(0x1f3)]([{'$match':{'status':_0x34ed21(0x19e),'warehouse_category':_0x34ed21(0x18f)}},{'$group':{'_id':'$name','name':{'$first':_0x34ed21(0x270)}}}]);const _0x87f7fb=await warehouse[_0x34ed21(0x1f3)]([{'$match':{'name':_0x50608d[_0x34ed21(0x264)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x34ed21(0x20a)},{'$group':{'_id':_0x34ed21(0x1db),'name':{'$first':_0x34ed21(0x18a)},'product_stock':{'$first':_0x34ed21(0x1e7)},'bay':{'$first':_0x34ed21(0x247)},'bin':{'$first':_0x34ed21(0x190)},'type':{'$first':_0x34ed21(0x1ed)},'floorlevel':{'$first':_0x34ed21(0x237)},'primary_code':{'$first':_0x34ed21(0x195)},'secondary_code':{'$first':_0x34ed21(0x1e4)},'product_code':{'$first':_0x34ed21(0x228)},'storage':{'$first':_0x34ed21(0x231)},'rack':{'$first':_0x34ed21(0x19d)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x34ed21(0x23e)},'room':{'$first':_0x34ed21(0x22a)}}}]),_0x553d06=await product[_0x34ed21(0x1ee)]({}),_0x5ea09f=BayBinSelected(_0x50608d[_0x34ed21(0x1fe)],_0x50608d[_0x34ed21(0x1d4)]);if(_0x2d998b[0x0][_0x34ed21(0x260)]==_0x34ed21(0x1ca)){var _0x124325=users[_0x34ed21(0x25b)];console[_0x34ed21(0x239)](_0x124325);}else{if(_0x2d998b[0x0]['language']==_0x34ed21(0x241))var _0x124325=users[_0x34ed21(0x241)];else{if(_0x2d998b[0x0][_0x34ed21(0x260)]=='German')var _0x124325=users['German'];else{if(_0x2d998b[0x0][_0x34ed21(0x260)]==_0x34ed21(0x1eb))var _0x124325=users['Spanish'];else{if(_0x2d998b[0x0][_0x34ed21(0x260)]==_0x34ed21(0x1ec))var _0x124325=users[_0x34ed21(0x1ec)];else{if(_0x2d998b[0x0][_0x34ed21(0x260)]=='Portuguese\x20(BR)')var _0x124325=users['Portuguese'];else{if(_0x2d998b[0x0][_0x34ed21(0x260)]==_0x34ed21(0x1a1))var _0x124325=users[_0x34ed21(0x1a1)];else{if(_0x2d998b[0x0]['language']==_0x34ed21(0x1d7))var _0x124325=users[_0x34ed21(0x1b6)];}}}}}}}_0x4b6b39[_0x34ed21(0x1b8)](_0x34ed21(0x1b2),{'success':_0x228719['flash'](_0x34ed21(0x1b5)),'errors':_0x228719[_0x34ed21(0x22f)](_0x34ed21(0x1f6)),'role':_0x33aaa5,'profile':_0x3a1b9f,'master_shop':_0x2d998b,'warehouse':_0x53c1d3,'transfer':_0x50608d,'stock':_0x87f7fb,'unit':_0x553d06,'language':_0x124325});}catch(_0x47276d){console[_0x34ed21(0x239)](_0x47276d);}}),router[a0_0x395688(0x1c1)](a0_0x395688(0x25d),auth,async(_0x599d75,_0x5b8eec)=>{var _0x1ddc31=a0_0x395688;try{const _0x22e34c=_0x599d75['params']['id'],_0x1af34b=await transfers[_0x1ddc31(0x22c)](_0x22e34c);_0x5b8eec[_0x1ddc31(0x242)](_0x599d75['body']);return;const {date:_0x51d350,from_warehouse:_0x474351,FromRoom_name:_0x204354,to_warehouse:_0x57687d,ToRoom_name:_0x3ffa81,prod_name:_0x538a02,from_prod_qty:_0x2243de,from_prod_level:_0xf45fbd,from_prod_isle:_0x28cdc4,from_prod_pallet:_0x8ffeec,to_prod_qty:_0xdea6fe,to_prod_level:_0x51e294,to_prod_isle:_0x209101,to_prod_pallet:_0x3853ff,primary_code:_0x56e668,secondary_code:_0x94b66a,product_code3:_0x44f693,note:_0x33bcb2,invoice:_0x2f1a47,expiry_date:_0x4bd277}=_0x599d75[_0x1ddc31(0x20f)];if(typeof _0x538a02==_0x1ddc31(0x26e))var _0x3f1e00=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x20b)]],_0x154c25=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x191)]],_0x5f1c53=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1d6)]],_0x4a59bf=[_0x599d75[_0x1ddc31(0x20f)]['from_prod_isle']],_0x2d5cdc=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1e1)]],_0x418088=[_0x599d75[_0x1ddc31(0x20f)]['from_types']],_0x1e9baf=[_0x599d75[_0x1ddc31(0x20f)]['to_prod_qty']],_0x463cb0=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x204)]],_0x9b0b9b=[_0x599d75['body'][_0x1ddc31(0x1f5)]],_0x5bd8a9=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1cc)]],_0x4084e6=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x251)]],_0x512810=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x256)]],_0x1fc8ab=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x22d)]],_0xe80434=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x229)]],_0x2b73aa=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1fa)]],_0x356170=[_0x599d75['body']['product_code3']],_0x406996=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1c5)]],_0x138012=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x19a)]],_0xbbf61b=[_0x599d75['body']['secondary_unit']],_0x20cb96=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1ba)]],_0x553f32=[_0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x261)]],_0x5b76f9=[_0x599d75['body']['from_storage']],_0x15b93f=[_0x599d75[_0x1ddc31(0x20f)]['from_rak']];else var _0x3f1e00=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x20b)]],_0x512810=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x256)]],_0x1fc8ab=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x22d)]],_0x418088=[..._0x599d75[_0x1ddc31(0x20f)]['from_types']],_0x4084e6=[..._0x599d75['body'][_0x1ddc31(0x251)]],_0x154c25=[..._0x599d75[_0x1ddc31(0x20f)]['from_prod_qty']],_0x5f1c53=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1d6)]],_0x4a59bf=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1af)]],_0x2d5cdc=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1e1)]],_0x1e9baf=[..._0x599d75[_0x1ddc31(0x20f)]['to_prod_qty']],_0x463cb0=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x204)]],_0x9b0b9b=[..._0x599d75[_0x1ddc31(0x20f)]['to_prod_isle']],_0x5bd8a9=[..._0x599d75['body'][_0x1ddc31(0x1cc)]],_0xe80434=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x229)]],_0x2b73aa=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1fa)]],_0x356170=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x20e)]],_0x406996=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1c5)]],_0x138012=[..._0x599d75['body'][_0x1ddc31(0x19a)]],_0xbbf61b=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x259)]],_0x20cb96=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x1ba)]],_0x553f32=[..._0x599d75['body'][_0x1ddc31(0x261)]],_0x5b76f9=[..._0x599d75[_0x1ddc31(0x20f)]['from_storage']],_0x15b93f=[..._0x599d75[_0x1ddc31(0x20f)][_0x1ddc31(0x209)]];const _0x1b9e63=_0x3f1e00[_0x1ddc31(0x24d)](_0x29a7cd=>{return _0x29a7cd={'product_name':_0x29a7cd};});_0x154c25[_0x1ddc31(0x1a4)]((_0x248ef1,_0x5d1055)=>{var _0xd1d2a4=_0x1ddc31;_0x1b9e63[_0x5d1055][_0xd1d2a4(0x1d1)]=_0x248ef1;}),_0x5f1c53[_0x1ddc31(0x1a4)]((_0x7398eb,_0x216c14)=>{var _0x2e5be6=_0x1ddc31;_0x1b9e63[_0x216c14][_0x2e5be6(0x1b0)]=_0x7398eb;}),_0x4a59bf[_0x1ddc31(0x1a4)]((_0x101fa9,_0x11e588)=>{_0x1b9e63[_0x11e588]['from_bin']=_0x101fa9;}),_0x2d5cdc[_0x1ddc31(0x1a4)]((_0x22181d,_0x1355f3)=>{var _0x1e40cc=_0x1ddc31;_0x1b9e63[_0x1355f3][_0x1e40cc(0x1ff)]=_0x22181d;}),_0x1e9baf[_0x1ddc31(0x1a4)]((_0x20e436,_0x3f04c7)=>{_0x1b9e63[_0x3f04c7]['to_quantity']=_0x20e436;}),_0x463cb0['forEach']((_0x3b72e5,_0xdb6e82)=>{var _0x282fdb=_0x1ddc31;_0x1b9e63[_0xdb6e82][_0x282fdb(0x1d0)]=_0x3b72e5;}),_0x9b0b9b['forEach']((_0x189f27,_0x25a6fd)=>{_0x1b9e63[_0x25a6fd]['to_bin']=_0x189f27;}),_0x5bd8a9['forEach']((_0xe44f1e,_0x716a0e)=>{var _0x187328=_0x1ddc31;_0x1b9e63[_0x716a0e][_0x187328(0x186)]=_0xe44f1e;}),_0xe80434[_0x1ddc31(0x1a4)]((_0x24035f,_0x583fae)=>{var _0x1243d0=_0x1ddc31;_0x1b9e63[_0x583fae][_0x1243d0(0x229)]=_0x24035f;}),_0x2b73aa[_0x1ddc31(0x1a4)]((_0x33195f,_0x592663)=>{var _0x1f613e=_0x1ddc31;_0x1b9e63[_0x592663][_0x1f613e(0x1fa)]=_0x33195f;}),_0x356170[_0x1ddc31(0x1a4)]((_0xed8155,_0xbc785b)=>{var _0x86b942=_0x1ddc31;_0x1b9e63[_0xbc785b][_0x86b942(0x222)]=_0xed8155;}),_0x406996['forEach']((_0x2e729e,_0x3fd098)=>{var _0x5577ef=_0x1ddc31;_0x1b9e63[_0x3fd098][_0x5577ef(0x265)]=_0x2e729e;}),_0x138012[_0x1ddc31(0x1a4)]((_0x220765,_0x416024)=>{_0x1b9e63[_0x416024]['unit']=_0x220765;}),_0xbbf61b[_0x1ddc31(0x1a4)]((_0x3be725,_0x5b5537)=>{var _0x1d0d2b=_0x1ddc31;_0x1b9e63[_0x5b5537][_0x1d0d2b(0x259)]=_0x3be725;}),_0x20cb96['forEach']((_0x403d6f,_0x4dc16b)=>{var _0x434a0f=_0x1ddc31;_0x1b9e63[_0x4dc16b][_0x434a0f(0x1ba)]=_0x403d6f;}),_0x553f32[_0x1ddc31(0x1a4)]((_0x4e5e21,_0x2bf88f)=>{var _0x4c4b63=_0x1ddc31;_0x1b9e63[_0x2bf88f][_0x4c4b63(0x261)]=_0x4e5e21;}),_0x512810['forEach']((_0x5de424,_0x3924b5)=>{var _0x2e04f0=_0x1ddc31;_0x1b9e63[_0x3924b5][_0x2e04f0(0x256)]=_0x5de424;}),_0x1fc8ab[_0x1ddc31(0x1a4)]((_0x21819f,_0x508979)=>{var _0x5f3784=_0x1ddc31;_0x1b9e63[_0x508979][_0x5f3784(0x23b)]=_0x21819f;}),_0x418088[_0x1ddc31(0x1a4)]((_0x38cc85,_0x12c475)=>{var _0x4520e2=_0x1ddc31;_0x1b9e63[_0x12c475][_0x4520e2(0x1c3)]=_0x38cc85;}),_0x4084e6[_0x1ddc31(0x1a4)]((_0x25c1ce,_0xc6f2c9)=>{var _0x2af242=_0x1ddc31;_0x1b9e63[_0xc6f2c9][_0x2af242(0x251)]=_0x25c1ce;}),_0x5b76f9[_0x1ddc31(0x1a4)]((_0x3257f1,_0x3c5477)=>{_0x1b9e63[_0x3c5477]['from_storage']=_0x3257f1;}),_0x15b93f[_0x1ddc31(0x1a4)]((_0x5e04b7,_0x32e429)=>{var _0x1d6165=_0x1ddc31;_0x1b9e63[_0x32e429][_0x1d6165(0x225)]=_0x5e04b7;});const _0x54f6db=_0x1b9e63[_0x1ddc31(0x1a7)](_0x338dc4=>_0x338dc4[_0x1ddc31(0x1c8)]!=='0'&&_0x338dc4['to_quantity']!==''||_0x338dc4[_0x1ddc31(0x186)]!=='0'&&_0x338dc4[_0x1ddc31(0x186)]!=='');var _0x311b57=0x0;_0x54f6db['forEach'](_0x366215=>{var _0x17bd79=_0x1ddc31;parseInt(_0x366215[_0x17bd79(0x1d1)])<parseInt(_0x366215['to_quantity'])&&_0x311b57++;});if(_0x311b57!=0x0)return _0x599d75['flash'](_0x1ddc31(0x1f6),_0x1ddc31(0x196)),_0x5b8eec['redirect'](_0x1ddc31(0x1d9));const _0x15f4ca=await warehouse[_0x1ddc31(0x216)]({'name':_0x1af34b[_0x1ddc31(0x264)],'room':_0x1af34b['from_room']});_0x1af34b[_0x1ddc31(0x1e6)][_0x1ddc31(0x1a4)](_0x26f675=>{var _0x334be2=_0x1ddc31;if(_0x26f675[_0x334be2(0x1c8)]>0x0){const _0x5ac5b1=_0x15f4ca[_0x334be2(0x26c)]['map'](_0x650d96=>{var _0x21c846=_0x334be2;_0x650d96[_0x21c846(0x227)]==_0x26f675[_0x21c846(0x227)]&&_0x650d96['floorlevel']==_0x26f675[_0x21c846(0x1ff)]&&_0x650d96['type']==_0x26f675[_0x21c846(0x1c3)]&&_0x650d96['bin']==_0x26f675[_0x21c846(0x268)]&&_0x650d96['bay']==_0x26f675['from_bay']&&_0x650d96[_0x21c846(0x23b)]==_0x26f675[_0x21c846(0x225)]&&_0x650d96[_0x21c846(0x256)]==_0x26f675[_0x21c846(0x1c9)]&&(_0x650d96[_0x21c846(0x26d)]=parseInt(_0x650d96['product_stock'])+parseInt(_0x26f675[_0x21c846(0x1c8)]));});}}),await _0x15f4ca[_0x1ddc31(0x253)]();const _0x25ce37=await warehouse[_0x1ddc31(0x216)]({'name':_0x1af34b[_0x1ddc31(0x1fe)],'room':_0x1af34b[_0x1ddc31(0x1d4)]});_0x1af34b['product']['forEach'](_0x3329e7=>{var _0x3fdbef=_0x1ddc31;if(_0x3329e7[_0x3fdbef(0x1c8)]>0x0){const _0x4509a8=_0x25ce37[_0x3fdbef(0x26c)][_0x3fdbef(0x24d)](_0x2e2f25=>{var _0x5ec7ae=_0x3fdbef;_0x2e2f25['product_name']==_0x3329e7[_0x5ec7ae(0x227)]&&_0x2e2f25[_0x5ec7ae(0x21c)]==_0x3329e7[_0x5ec7ae(0x186)]&&_0x2e2f25[_0x5ec7ae(0x246)]==_0x3329e7['to_types']&&_0x2e2f25[_0x5ec7ae(0x1ce)]==_0x3329e7[_0x5ec7ae(0x1f8)]&&_0x2e2f25['bay']==_0x3329e7['to_bay']&&_0x2e2f25[_0x5ec7ae(0x23b)]==_0x3329e7[_0x5ec7ae(0x23b)]&&_0x2e2f25[_0x5ec7ae(0x256)]==_0x3329e7['storage']&&(_0x2e2f25[_0x5ec7ae(0x26d)]=parseInt(_0x2e2f25['product_stock'])-parseInt(_0x3329e7[_0x5ec7ae(0x1c8)]));});}}),await _0x25ce37['save'](),_0x1af34b[_0x1ddc31(0x205)]=_0x51d350,_0x1af34b[_0x1ddc31(0x264)]=_0x474351,_0x1af34b[_0x1ddc31(0x1fe)]=_0x57687d,_0x1af34b[_0x1ddc31(0x1e6)]=_0x54f6db,_0x1af34b['note']=_0x33bcb2,_0x1af34b[_0x1ddc31(0x23c)]=_0x2f1a47;const _0x144224=await _0x1af34b[_0x1ddc31(0x253)]();console[_0x1ddc31(0x239)](_0x144224);const _0x2c61f9=await warehouse['findOne']({'name':_0x474351,'room':_0x204354});_0x144224[_0x1ddc31(0x1e6)][_0x1ddc31(0x1a4)](_0x3a7991=>{var _0x7ec78a=_0x1ddc31;if(_0x3a7991[_0x7ec78a(0x1c8)]>0x0){const _0x1652c0=_0x2c61f9[_0x7ec78a(0x26c)][_0x7ec78a(0x24d)](_0x5da45f=>{var _0x510eed=_0x7ec78a;_0x5da45f[_0x510eed(0x227)]==_0x3a7991[_0x510eed(0x227)]&&_0x5da45f[_0x510eed(0x21c)]==_0x3a7991[_0x510eed(0x1ff)]&&_0x5da45f[_0x510eed(0x246)]==_0x3a7991[_0x510eed(0x1c3)]&&_0x5da45f[_0x510eed(0x1ce)]==_0x3a7991[_0x510eed(0x268)]&&_0x5da45f[_0x510eed(0x1ad)]==_0x3a7991['from_bay']&&_0x5da45f['rack']==_0x3a7991[_0x510eed(0x225)]&&_0x5da45f['storage']==_0x3a7991[_0x510eed(0x1c9)]&&(_0x5da45f['product_stock']=parseInt(_0x5da45f[_0x510eed(0x26d)])-parseInt(_0x3a7991['to_quantity']));});}}),await _0x2c61f9[_0x1ddc31(0x253)]();const _0x311959=await warehouse[_0x1ddc31(0x216)]({'name':_0x57687d,'room':_0x3ffa81});_0x144224[_0x1ddc31(0x1e6)][_0x1ddc31(0x1a4)](_0x2b146f=>{var _0x3fe413=_0x1ddc31;if(_0x2b146f['to_quantity']>0x0){var _0x4f9ae3=0x0;const _0x5631df=_0x311959[_0x3fe413(0x26c)][_0x3fe413(0x24d)](_0x1d4f64=>{var _0xe18a8d=_0x3fe413;_0x1d4f64[_0xe18a8d(0x227)]==_0x2b146f[_0xe18a8d(0x227)]&&_0x1d4f64[_0xe18a8d(0x21c)]==_0x2b146f[_0xe18a8d(0x186)]&&_0x1d4f64[_0xe18a8d(0x246)]==_0x2b146f[_0xe18a8d(0x251)]&&_0x1d4f64[_0xe18a8d(0x1ce)]==_0x2b146f[_0xe18a8d(0x1f8)]&&_0x1d4f64['bay']==_0x2b146f['to_bay']&&_0x1d4f64['rack']==_0x2b146f[_0xe18a8d(0x23b)]&&_0x1d4f64['storage']==_0x2b146f[_0xe18a8d(0x256)]&&(_0x1d4f64[_0xe18a8d(0x26d)]=parseInt(_0x1d4f64[_0xe18a8d(0x26d)])+parseInt(_0x2b146f['to_quantity']),_0x4f9ae3++);});_0x4f9ae3=='0'&&(_0x311959[_0x3fe413(0x26c)]=_0x311959[_0x3fe413(0x26c)][_0x3fe413(0x1ea)]({'product_name':_0x2b146f[_0x3fe413(0x227)],'product_stock':_0x2b146f[_0x3fe413(0x1c8)],'bay':_0x2b146f['to_bay'],'bin':_0x2b146f[_0x3fe413(0x1f8)],'type':_0x2b146f['to_types'],'floorlevel':_0x2b146f[_0x3fe413(0x186)],'storage':_0x2b146f[_0x3fe413(0x256)],'rack':_0x2b146f[_0x3fe413(0x23b)],'product_code':_0x2b146f['product_code'],'primary_code':_0x2b146f[_0x3fe413(0x229)],'secondary_code':_0x2b146f[_0x3fe413(0x1fa)],'maxProducts':_0x2b146f[_0x3fe413(0x265)],'storage':_0x2b146f[_0x3fe413(0x256)],'rack':_0x2b146f[_0x3fe413(0x23b)]}));}}),await _0x311959[_0x1ddc31(0x253)](),_0x599d75[_0x1ddc31(0x22f)]('success',_0x1ddc31(0x226)),_0x5b8eec[_0x1ddc31(0x215)](_0x1ddc31(0x236));}catch(_0x294418){console[_0x1ddc31(0x239)](_0x294418);}}),router[a0_0x395688(0x1c1)](a0_0x395688(0x224),async(_0x5b1f6f,_0x10fba9)=>{var _0x131bd4=a0_0x395688;const {FromWareHouse:_0x9799c6,FromRoom:_0x5f0437,ToWarehouse:_0x5d1522,ToRoom:_0xae7d48,primary_code:_0x5806a0,Roomslist:_0x40c3b2}=_0x5b1f6f[_0x131bd4(0x20f)],_0x1e28cb=_0x40c3b2['split'](','),_0x2f8f55=[];async function _0x17f1d4(_0x5199b3){var _0x5b439d=_0x131bd4;const _0x4f7128=await warehouse['aggregate']([{'$match':{'name':_0x9799c6,'room':_0x5199b3}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5806a0}},{'$group':{'_id':_0x5b439d(0x1db),'name':{'$first':_0x5b439d(0x18a)},'instock':{'$first':_0x5b439d(0x1e7)},'primary_code':{'$first':_0x5b439d(0x195)},'secondary_code':{'$first':_0x5b439d(0x1e4)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5b439d(0x247)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x5b439d(0x237)},'unit':{'$first':_0x5b439d(0x24c)},'secondary_unit':{'$first':_0x5b439d(0x1b9)},'storage':{'$first':_0x5b439d(0x231)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5b439d(0x1bc)},'production_date':{'$first':_0x5b439d(0x23e)},'batch_code':{'$first':_0x5b439d(0x20d)},'maxPerUnit':{'$first':_0x5b439d(0x25a)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]),_0x1c4afb=await warehouse['aggregate']([{'$match':{'name':_0x9799c6,'room':_0x5199b3}},{'$unwind':_0x5b439d(0x20a)},{'$match':{'product_details.secondary_code':_0x5806a0}},{'$group':{'_id':_0x5b439d(0x1db),'name':{'$first':_0x5b439d(0x18a)},'instock':{'$first':_0x5b439d(0x1e7)},'primary_code':{'$first':_0x5b439d(0x195)},'secondary_code':{'$first':_0x5b439d(0x1e4)},'product_code':{'$first':_0x5b439d(0x228)},'level':{'$first':_0x5b439d(0x247)},'isle':{'$first':_0x5b439d(0x190)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5b439d(0x24c)},'secondary_unit':{'$first':_0x5b439d(0x1b9)},'storage':{'$first':_0x5b439d(0x231)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5b439d(0x1bc)},'production_date':{'$first':_0x5b439d(0x23e)},'batch_code':{'$first':_0x5b439d(0x20d)},'maxPerUnit':{'$first':_0x5b439d(0x25a)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5b439d(0x22a)},'maxProducts':{'$first':_0x5b439d(0x272)}}}]);if(_0x4f7128['length']>0x0)_0x2f8f55[_0x5b439d(0x25f)](_0x4f7128);else _0x1c4afb[_0x5b439d(0x182)]>0x0&&_0x2f8f55[_0x5b439d(0x25f)](_0x1c4afb);}const _0x42be76=_0x1e28cb['map'](_0x2f2d96=>_0x17f1d4(_0x2f2d96));await Promise[_0x131bd4(0x255)](_0x42be76),_0x10fba9[_0x131bd4(0x242)](_0x2f8f55);}),router[a0_0x395688(0x1c1)](a0_0x395688(0x19c),async(_0x183743,_0x15abfb)=>{var _0x2bafce=a0_0x395688;try{const {FromWareHouse:_0x589924,FromRoom:_0x214207,ToWarehouse:_0x5da587,ToRoom:_0x25779b,secondary_code:_0x4cbf33}=_0x183743[_0x2bafce(0x20f)],_0xfd476a=await warehouse[_0x2bafce(0x1f3)]([{'$match':{'name':_0x589924}},{'$unwind':_0x2bafce(0x20a)},{'$match':{'product_details.secondary_code':_0x4cbf33}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2bafce(0x18a)},'primary_code':{'$first':_0x2bafce(0x195)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2bafce(0x228)},'instock':{'$first':_0x2bafce(0x1e7)},'warehouse':{'$first':'$name'},'level':{'$first':_0x2bafce(0x269)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x2bafce(0x218)},'maxProducts':{'$first':_0x2bafce(0x272)},'unit':{'$first':'$product_details.unit'}}}]);_0x15abfb[_0x2bafce(0x21a)](0xc8)[_0x2bafce(0x242)](_0xfd476a);}catch(_0x577d36){_0x15abfb['status'](0x194)[_0x2bafce(0x242)]({'message':_0x577d36[_0x2bafce(0x199)]});}}),router['post'](a0_0x395688(0x267),async(_0x298dfe,_0xd44712)=>{var _0x16ec71=a0_0x395688;try{const {FromWareHouse:_0xe73630,FromRoom:_0x168f05,ToWarehouse:_0x119ee4,ToRoom:_0x424c99,product_code:_0x2250ae}=_0x298dfe['body'],_0x2aa759=await warehouse[_0x16ec71(0x1f3)]([{'$match':{'name':_0xe73630}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x2250ae}},{'$group':{'_id':_0x16ec71(0x1db),'name':{'$first':_0x16ec71(0x18a)},'primary_code':{'$first':_0x16ec71(0x195)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x16ec71(0x228)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x16ec71(0x270)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x16ec71(0x21b)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x16ec71(0x272)},'unit':{'$first':_0x16ec71(0x24c)}}}]);_0xd44712[_0x16ec71(0x21a)](0xc8)[_0x16ec71(0x242)](_0x2aa759);}catch(_0x5025d5){_0xd44712[_0x16ec71(0x21a)](0x194)['json']({'message':_0x5025d5[_0x16ec71(0x199)]});}}),router[a0_0x395688(0x1c1)](a0_0x395688(0x18e),async(_0x2c77ee,_0x3a5fa8)=>{var _0x15bea4=a0_0x395688;const {level:_0x4b5b22,isle:_0x437d2e,pallet:_0x377643,warehouses:_0x4e4381,room:_0x5ec1de}=_0x2c77ee['body'];try{const _0x2b5ef8=await warehouse[_0x15bea4(0x1f3)]([{'$match':{'name':_0x4e4381,'room':_0x5ec1de}},{'$unwind':_0x15bea4(0x20a)},{'$match':{'product_details.level':parseInt(_0x4b5b22),'product_details.isle':_0x437d2e,'product_details.pallet':parseInt(_0x377643)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x15bea4(0x18a)},'product_stock':{'$first':_0x15bea4(0x1e7)},'level':{'$first':_0x15bea4(0x269)},'isle':{'$first':_0x15bea4(0x21b)},'pallet':{'$first':_0x15bea4(0x218)},'maxProducts':{'$first':_0x15bea4(0x272)}}}]);_0x3a5fa8[_0x15bea4(0x21a)](0xc8)[_0x15bea4(0x242)](_0x2b5ef8);}catch(_0x198e42){_0x3a5fa8[_0x15bea4(0x21a)](0x194)[_0x15bea4(0x242)]({'message':_0x198e42['message']});}}),module['exports']=router;