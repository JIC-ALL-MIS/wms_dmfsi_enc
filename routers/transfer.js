var a0_0xaf309c=a0_0x48b8;(function(_0x517146,_0x4bbf2f){var _0x2eff39=a0_0x48b8,_0x47c946=_0x517146();while(!![]){try{var _0x30e6c4=-parseInt(_0x2eff39(0x1ac))/0x1*(parseInt(_0x2eff39(0x19f))/0x2)+parseInt(_0x2eff39(0x1d0))/0x3+parseInt(_0x2eff39(0x216))/0x4*(parseInt(_0x2eff39(0x21e))/0x5)+-parseInt(_0x2eff39(0x21b))/0x6+-parseInt(_0x2eff39(0x19d))/0x7+-parseInt(_0x2eff39(0x1ee))/0x8+parseInt(_0x2eff39(0x1a1))/0x9*(parseInt(_0x2eff39(0x1d4))/0xa);if(_0x30e6c4===_0x4bbf2f)break;else _0x47c946['push'](_0x47c946['shift']());}catch(_0x16b1a4){_0x47c946['push'](_0x47c946['shift']());}}}(a0_0x3694,0x48f3c));function a0_0x48b8(_0x285da0,_0x61b919){var _0x36941d=a0_0x3694();return a0_0x48b8=function(_0x48b830,_0x4ef6fb){_0x48b830=_0x48b830-0x14f;var _0x2b46a0=_0x36941d[_0x48b830];return _0x2b46a0;},a0_0x48b8(_0x285da0,_0x61b919);}const express=require(a0_0xaf309c(0x1c3)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0xaf309c(0x222)),auth=require('../middleware/auth'),users=require(a0_0xaf309c(0x183)),nodemailer=require('nodemailer');router[a0_0xaf309c(0x16a)](a0_0xaf309c(0x15d),auth,async(_0x21f6cb,_0x28704f)=>{var _0xe1a557=a0_0xaf309c;try{const {username:_0x335d36,email:_0x1e0e9b,role:_0x2667e6}=_0x21f6cb[_0xe1a557(0x1cd)],_0x40fdd8=_0x21f6cb[_0xe1a557(0x1cd)],_0x582fcc=await profile[_0xe1a557(0x1ff)]({'email':_0x40fdd8['email']}),_0x371d63=await master_shop['find']();console[_0xe1a557(0x215)](_0xe1a557(0x171),_0x371d63);let _0x4f899b;if(_0x40fdd8[_0xe1a557(0x1d7)]==_0xe1a557(0x1a6)){const _0x4a44f2=await staff[_0xe1a557(0x1ff)]({'email':_0x40fdd8[_0xe1a557(0x227)]});_0x4f899b=await transfers['find']({'from_warehouse':_0x4a44f2[_0xe1a557(0x209)]});}else _0x4f899b=await transfers[_0xe1a557(0x1df)]([{'$unwind':_0xe1a557(0x1c5)},{'$group':{'_id':_0xe1a557(0x180),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'from_warehouse':{'$first':_0xe1a557(0x16b)},'to_warehouse':{'$first':_0xe1a557(0x198)},'from_room_name':{'$addToSet':_0xe1a557(0x17f)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0xe1a557(0x1f6)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x371d63[0x0]['language']==_0xe1a557(0x228)){var _0x2968c6=users[_0xe1a557(0x18a)];console[_0xe1a557(0x215)](_0x2968c6);}else{if(_0x371d63[0x0][_0xe1a557(0x224)]==_0xe1a557(0x23d))var _0x2968c6=users[_0xe1a557(0x23d)];else{if(_0x371d63[0x0][_0xe1a557(0x224)]==_0xe1a557(0x1de))var _0x2968c6=users[_0xe1a557(0x1de)];else{if(_0x371d63[0x0][_0xe1a557(0x224)]==_0xe1a557(0x22e))var _0x2968c6=users[_0xe1a557(0x22e)];else{if(_0x371d63[0x0][_0xe1a557(0x224)]==_0xe1a557(0x1b9))var _0x2968c6=users['French'];else{if(_0x371d63[0x0]['language']==_0xe1a557(0x177))var _0x2968c6=users[_0xe1a557(0x167)];else{if(_0x371d63[0x0][_0xe1a557(0x224)]==_0xe1a557(0x226))var _0x2968c6=users['Chinese'];else{if(_0x371d63[0x0][_0xe1a557(0x224)]==_0xe1a557(0x204))var _0x2968c6=users[_0xe1a557(0x176)];}}}}}}}_0x28704f[_0xe1a557(0x1b2)](_0xe1a557(0x1b4),{'success':_0x21f6cb[_0xe1a557(0x18f)](_0xe1a557(0x18b)),'errors':_0x21f6cb['flash']('errors'),'role':_0x40fdd8,'profile':_0x582fcc,'master_shop':_0x371d63,'transfer':_0x4f899b,'language':_0x2968c6});}catch(_0x3df317){console['log'](_0x3df317);}});async function getRandom8DigitNumber(){var _0x15c535=a0_0xaf309c;const _0xff433a=0x989680,_0x441b1b=0x5f5e0ff,_0x3cee90=Math['floor'](Math[_0x15c535(0x23b)]()*(_0x441b1b-_0xff433a+0x1))+_0xff433a;var _0x4981ad;const _0x40fd26=await transfers['findOne']({'invoice':_0x15c535(0x1f4)+_0x3cee90});return _0x40fd26&&_0x40fd26['length']>0x0?_0x4981ad=_0x15c535(0x1f4)+_0x3cee90:_0x4981ad='TRF-'+_0x3cee90,_0x4981ad;}router[a0_0xaf309c(0x16a)](a0_0xaf309c(0x172),auth,async(_0x2bfe99,_0x2ec129)=>{var _0x33c458=a0_0xaf309c;try{const {username:_0x36097c,email:_0x16c9e5,role:_0x238382}=_0x2bfe99[_0x33c458(0x1cd)],_0x3d6d18=_0x2bfe99['user'],_0x2cceb1=await profile[_0x33c458(0x1ff)]({'email':_0x3d6d18[_0x33c458(0x227)]}),_0x4f295a=await master_shop[_0x33c458(0x1ec)]();console[_0x33c458(0x215)](_0x33c458(0x171),_0x4f295a);let _0x134cd5;if(_0x3d6d18['role']==_0x33c458(0x1a6)){const _0x317e83=await staff['findOne']({'email':_0x3d6d18[_0x33c458(0x227)]});_0x134cd5=await warehouse['aggregate']([{'$match':{'status':_0x33c458(0x178),'name':_0x317e83[_0x33c458(0x209)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x33c458(0x185),'name':{'$first':_0x33c458(0x185)}}}]);}else _0x134cd5=await warehouse[_0x33c458(0x1df)]([{'$match':{'status':_0x33c458(0x178),'warehouse_category':_0x33c458(0x21c)}},{'$group':{'_id':_0x33c458(0x185),'name':{'$first':_0x33c458(0x185)}}}]);var _0x159b54=[_0x33c458(0x1ca),_0x33c458(0x197),_0x33c458(0x1ab)];const _0x4160f3=await transfers[_0x33c458(0x1ec)]({}),_0x4b77ed=_0x4160f3[_0x33c458(0x1b6)]+0x1,_0x411aee=_0x33c458(0x1f4)+_0x4b77ed['toString']()[_0x33c458(0x233)](0x5,'0');if(_0x4f295a[0x0][_0x33c458(0x224)]=='English\x20(US)'){var _0xd7dced=users[_0x33c458(0x18a)];console['log'](_0xd7dced);}else{if(_0x4f295a[0x0][_0x33c458(0x224)]==_0x33c458(0x23d))var _0xd7dced=users['Hindi'];else{if(_0x4f295a[0x0]['language']==_0x33c458(0x1de))var _0xd7dced=users[_0x33c458(0x1de)];else{if(_0x4f295a[0x0]['language']=='Spanish')var _0xd7dced=users[_0x33c458(0x22e)];else{if(_0x4f295a[0x0][_0x33c458(0x224)]==_0x33c458(0x1b9))var _0xd7dced=users['French'];else{if(_0x4f295a[0x0][_0x33c458(0x224)]==_0x33c458(0x177))var _0xd7dced=users[_0x33c458(0x167)];else{if(_0x4f295a[0x0][_0x33c458(0x224)]=='Chinese')var _0xd7dced=users[_0x33c458(0x226)];else{if(_0x4f295a[0x0][_0x33c458(0x224)]==_0x33c458(0x204))var _0xd7dced=users['Arabic'];}}}}}}}const _0x520b28=getRandom8DigitNumber();_0x520b28[_0x33c458(0x1a4)](_0x2a5b17=>{var _0x1585bd=_0x33c458;_0x2ec129['render'](_0x1585bd(0x193),{'success':_0x2bfe99['flash']('success'),'errors':_0x2bfe99[_0x1585bd(0x18f)](_0x1585bd(0x17c)),'role':_0x3d6d18,'profile':_0x2cceb1,'master_shop':_0x4f295a,'warehouse':_0x134cd5,'language':_0xd7dced,'rooms_data':_0x159b54,'invoice':_0x2a5b17});})[_0x33c458(0x196)](_0x292f3d=>{var _0x1e3d62=_0x33c458;_0x2bfe99[_0x1e3d62(0x18f)](_0x1e3d62(0x17c),_0x1e3d62(0x1a8)),_0x2ec129[_0x1e3d62(0x1a5)](_0x1e3d62(0x1d2));});}catch(_0x4352ba){console[_0x33c458(0x215)](_0x4352ba);}}),router['post'](a0_0xaf309c(0x172),auth,async(_0x59de94,_0x53d4a6)=>{var _0x455c63=a0_0xaf309c;try{console[_0x455c63(0x215)](_0x59de94[_0x455c63(0x1a9)]);const {date:_0x5b2bad,from_warehouse:_0x1eac65,FromRoom_name:_0x5b202d,to_warehouse:_0x38616d,ToRoom_name:_0x3a3b6f,prod_name:_0x2f3163,from_prod_qty:_0x1b3b5d,from_prod_level:_0x5591bb,from_prod_isle:_0xcd65b8,from_prod_pallet:_0x15689b,to_prod_qty:_0x4c2127,to_prod_level:_0x1bef5e,to_prod_isle:_0x20df05,to_prod_pallet:_0x4c3f8b,primary_code:_0x21f1ac,secondary_code:_0x40066b,product_code3:_0x24b97e,note:_0x58ce59,MaxStocks_data2:_0x2c7589,invoice:_0x53ac76,expiry_date:_0x552e97}=_0x59de94[_0x455c63(0x1a9)];if(typeof _0x2f3163==_0x455c63(0x1c2))var _0x36d0e7=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x161)]],_0x165c6b=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x1bc)]],_0x4c9625=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x1b5)]],_0x14b5ae=[_0x59de94[_0x455c63(0x1a9)]['New_Qty_Converted']],_0xab7a40=[_0x59de94[_0x455c63(0x1a9)]['to_prod_level']],_0x519be2=[_0x59de94['body'][_0x455c63(0x217)]],_0x383b96=[_0x59de94['body'][_0x455c63(0x202)]],_0x291ecc=[_0x59de94['body'][_0x455c63(0x194)]],_0x614145=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x15a)]],_0x1f2536=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x1c6)]],_0x89bfbf=[_0x59de94[_0x455c63(0x1a9)]['secondary_unit']],_0x3c4096=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x1c1)]],_0x572c36=[_0x59de94['body'][_0x455c63(0x1c9)]],_0x893f98=[_0x59de94[_0x455c63(0x1a9)]['max_per_unit']],_0x1c51ee=[_0x59de94[_0x455c63(0x1a9)]['production_date']],_0x45da4a=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x21a)]],_0x13be19=[_0x59de94['body']['RoomAssigned']],_0x39e20d=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x225)]],_0x1c6b54=[_0x59de94[_0x455c63(0x1a9)]['from_invoice']],_0x1c8f8b=[_0x59de94[_0x455c63(0x1a9)][_0x455c63(0x208)]],_0x44def2=[_0x59de94['body'][_0x455c63(0x20f)]];else var _0x36d0e7=[..._0x59de94[_0x455c63(0x1a9)]['prod_name']],_0x165c6b=[..._0x59de94['body'][_0x455c63(0x1bc)]],_0x4c9625=[..._0x59de94[_0x455c63(0x1a9)]['from_prod_level']],_0x14b5ae=[..._0x59de94['body'][_0x455c63(0x184)]],_0xab7a40=[..._0x59de94['body'][_0x455c63(0x1a0)]],_0x519be2=[..._0x59de94[_0x455c63(0x1a9)][_0x455c63(0x217)]],_0x383b96=[..._0x59de94['body'][_0x455c63(0x202)]],_0x291ecc=[..._0x59de94[_0x455c63(0x1a9)][_0x455c63(0x194)]],_0x614145=[..._0x59de94['body'][_0x455c63(0x15a)]],_0x1f2536=[..._0x59de94[_0x455c63(0x1a9)]['primary_unit']],_0x89bfbf=[..._0x59de94[_0x455c63(0x1a9)][_0x455c63(0x17a)]],_0x3c4096=[..._0x59de94['body'][_0x455c63(0x1c1)]],_0x572c36=[..._0x59de94[_0x455c63(0x1a9)][_0x455c63(0x1c9)]],_0x893f98=[..._0x59de94['body']['max_per_unit']],_0x1c51ee=[..._0x59de94[_0x455c63(0x1a9)]['production_date']],_0x45da4a=[..._0x59de94['body']['prod_cat']],_0x13be19=[..._0x59de94[_0x455c63(0x1a9)][_0x455c63(0x212)]],_0x39e20d=[..._0x59de94[_0x455c63(0x1a9)][_0x455c63(0x225)]],_0x1c6b54=[..._0x59de94[_0x455c63(0x1a9)][_0x455c63(0x182)]],_0x1c8f8b=[..._0x59de94[_0x455c63(0x1a9)]['to_invoice']],_0x44def2=[..._0x59de94[_0x455c63(0x1a9)]['id_transaction']];const _0x5abd9f=_0x36d0e7[_0x455c63(0x229)](_0x19f494=>{return _0x19f494={'product_name':_0x19f494};});_0x165c6b[_0x455c63(0x1c8)]((_0x100d9f,_0x105fd3)=>{var _0x11a9c4=_0x455c63;_0x5abd9f[_0x105fd3][_0x11a9c4(0x165)]=_0x100d9f;}),_0x1c6b54[_0x455c63(0x1c8)]((_0x46694c,_0x3d72aa)=>{_0x5abd9f[_0x3d72aa]['from_invoice']=_0x46694c;}),_0x1c8f8b['forEach']((_0x4542cd,_0x340a3d)=>{var _0x158e6b=_0x455c63;_0x5abd9f[_0x340a3d][_0x158e6b(0x19a)]=_0x4542cd;}),_0x44def2[_0x455c63(0x1c8)]((_0x50611a,_0x1ba5f3)=>{var _0x3120da=_0x455c63;_0x5abd9f[_0x1ba5f3][_0x3120da(0x236)]=_0x50611a;}),_0x4c9625[_0x455c63(0x1c8)]((_0x2a38c4,_0x3a16be)=>{_0x13be19['forEach']((_0x4c5988,_0x420705)=>{var _0x40d345=a0_0x48b8;if(_0x4c5988=='Receiving\x20Area'&&_0x3a16be==_0x420705){var _0x1ebf25=_0x2a38c4[_0x40d345(0x150)](0x3);_0x5abd9f[_0x3a16be]['from_storage']=_0x2a38c4[0x0],_0x5abd9f[_0x3a16be][_0x40d345(0x1ed)]=_0x2a38c4[0x1],_0x5abd9f[_0x3a16be][_0x40d345(0x175)]=0x0,_0x5abd9f[_0x3a16be][_0x40d345(0x214)]=0x0,_0x5abd9f[_0x3a16be][_0x40d345(0x153)]=_0x40d345(0x1d9),_0x5abd9f[_0x3a16be][_0x40d345(0x16d)]=_0x1ebf25;}else{if(_0x4c5988==_0x40d345(0x1c0)&&_0x3a16be==_0x420705){var _0x1ebf25=_0x2a38c4[_0x40d345(0x150)](0x3);_0x5abd9f[_0x3a16be]['from_storage']=_0x2a38c4[0x0],_0x5abd9f[_0x3a16be][_0x40d345(0x1ed)]=_0x2a38c4[0x1],_0x5abd9f[_0x3a16be]['from_bay']=0x0,_0x5abd9f[_0x3a16be]['from_bin']=0x0,_0x5abd9f[_0x3a16be][_0x40d345(0x153)]='Floor',_0x5abd9f[_0x3a16be][_0x40d345(0x16d)]=_0x2a38c4[0x5];}else{if(_0x3a16be==_0x420705){if(_0x2a38c4[0x0]=='A'&&_0x2a38c4[0x1]=='L'&&_0x2a38c4[0x2]=='L')console[_0x40d345(0x215)](_0x4c5988+_0x40d345(0x205)+_0x3a16be+'\x20<>\x20'+_0x420705+'\x20<>\x20'+_0x2a38c4+_0x40d345(0x14f)),_0x5abd9f[_0x3a16be]['from_storage']=_0x2a38c4[0x0],_0x5abd9f[_0x3a16be]['from_rack']=_0x2a38c4[0x1],_0x5abd9f[_0x3a16be]['from_bay']=0x0,_0x5abd9f[_0x3a16be]['from_bin']=0x0,_0x5abd9f[_0x3a16be][_0x40d345(0x153)]=_0x40d345(0x1d9),_0x5abd9f[_0x3a16be][_0x40d345(0x16d)]=_0x2a38c4[0x3];else{var _0x48332b;if(_0x2a38c4[0x4]=='L')_0x48332b='Level';else _0x2a38c4[0x4]=='F'&&(_0x48332b=_0x40d345(0x1d9));_0x5abd9f[_0x3a16be][_0x40d345(0x232)]=_0x2a38c4[0x0],_0x5abd9f[_0x3a16be]['from_rack']=_0x2a38c4[0x1],_0x5abd9f[_0x3a16be][_0x40d345(0x175)]=_0x2a38c4[0x2],_0x5abd9f[_0x3a16be][_0x40d345(0x214)]=_0x2a38c4[0x3],_0x5abd9f[_0x3a16be][_0x40d345(0x153)]=_0x48332b,_0x5abd9f[_0x3a16be][_0x40d345(0x16d)]=_0x2a38c4[0x5];}}}}});}),_0x14b5ae[_0x455c63(0x1c8)]((_0x477578,_0xafd1db)=>{var _0x3c1eef=_0x455c63;_0x5abd9f[_0xafd1db][_0x3c1eef(0x22d)]=_0x477578;}),_0xab7a40[_0x455c63(0x1c8)]((_0x245af5,_0x136b21)=>{var _0x3bb6c6=_0x455c63;_0x39e20d[_0x3bb6c6(0x1c8)]((_0xe42a77,_0x5d2fe3)=>{var _0x570982=_0x3bb6c6;if(_0xe42a77=='Receiving\x20Area'&&_0x136b21==_0x5d2fe3){var _0x17eb34=_0x245af5['slice'](0x3);_0x5abd9f[_0x136b21][_0x570982(0x1e2)]=_0x245af5[0x0],_0x5abd9f[_0x136b21][_0x570982(0x18c)]=_0x245af5[0x1],_0x5abd9f[_0x136b21][_0x570982(0x189)]=0x0,_0x5abd9f[_0x136b21]['to_bin']=0x0,_0x5abd9f[_0x136b21][_0x570982(0x1d3)]=_0x570982(0x1d9),_0x5abd9f[_0x136b21][_0x570982(0x223)]=_0x17eb34;}else{if(_0xe42a77==_0x570982(0x1c0)&&_0x136b21==_0x5d2fe3){var _0x17eb34=_0x245af5[_0x570982(0x150)](0x3);_0x5abd9f[_0x136b21][_0x570982(0x1e2)]=_0x245af5[0x0],_0x5abd9f[_0x136b21]['rack']=_0x245af5[0x1],_0x5abd9f[_0x136b21]['to_bay']=0x0,_0x5abd9f[_0x136b21][_0x570982(0x1c4)]=0x0,_0x5abd9f[_0x136b21][_0x570982(0x1d3)]='Floor',_0x5abd9f[_0x136b21]['to_floorlevel']=_0x245af5[0x5];}else{if(_0x136b21==_0x5d2fe3){if(_0x245af5[0x0]=='A'&&_0x245af5[0x1]=='L'&&_0x245af5[0x2]=='L')console['log'](_0xe42a77+_0x570982(0x205)+_0x136b21+_0x570982(0x205)+_0x5d2fe3+_0x570982(0x205)+_0x245af5+_0x570982(0x14f)),_0x5abd9f[_0x136b21][_0x570982(0x1e2)]=_0x245af5[0x0],_0x5abd9f[_0x136b21][_0x570982(0x18c)]=_0x245af5[0x1],_0x5abd9f[_0x136b21][_0x570982(0x189)]=0x0,_0x5abd9f[_0x136b21][_0x570982(0x1c4)]=0x0,_0x5abd9f[_0x136b21][_0x570982(0x1d3)]=_0x570982(0x1d9),_0x5abd9f[_0x136b21][_0x570982(0x223)]=_0x245af5[0x3];else{var _0x10d87b;if(_0x245af5[0x4]=='L')_0x10d87b=_0x570982(0x1e4);else _0x245af5[0x4]=='F'&&(_0x10d87b=_0x570982(0x1d9));_0x5abd9f[_0x136b21]['storage']=_0x245af5[0x0],_0x5abd9f[_0x136b21][_0x570982(0x18c)]=_0x245af5[0x1],_0x5abd9f[_0x136b21][_0x570982(0x189)]=_0x245af5[0x2],_0x5abd9f[_0x136b21][_0x570982(0x1c4)]=_0x245af5[0x3],_0x5abd9f[_0x136b21][_0x570982(0x1d3)]=_0x10d87b,_0x5abd9f[_0x136b21][_0x570982(0x223)]=_0x245af5[0x5];}}}}});}),_0x519be2[_0x455c63(0x1c8)]((_0x515909,_0x1b50b9)=>{var _0xfda409=_0x455c63;_0x5abd9f[_0x1b50b9][_0xfda409(0x217)]=_0x515909;}),_0x383b96[_0x455c63(0x1c8)]((_0x250f48,_0x456217)=>{var _0x4729e0=_0x455c63;_0x5abd9f[_0x456217][_0x4729e0(0x202)]=_0x250f48;}),_0x291ecc[_0x455c63(0x1c8)]((_0x14e1de,_0x3d3180)=>{var _0x36ea04=_0x455c63;_0x5abd9f[_0x3d3180][_0x36ea04(0x1bb)]=_0x14e1de;}),_0x614145[_0x455c63(0x1c8)]((_0x1bfbeb,_0x4253ec)=>{var _0x289d3f=_0x455c63;_0x5abd9f[_0x4253ec][_0x289d3f(0x1f7)]=_0x1bfbeb;}),_0x1f2536['forEach']((_0x4381c5,_0x92f228)=>{_0x5abd9f[_0x92f228]['unit']=_0x4381c5;}),_0x89bfbf[_0x455c63(0x1c8)]((_0x56f4da,_0x1e9d47)=>{var _0x44a961=_0x455c63;_0x5abd9f[_0x1e9d47][_0x44a961(0x17a)]=_0x56f4da;}),_0x3c4096[_0x455c63(0x1c8)]((_0x1ba6af,_0x3dff18)=>{_0x5abd9f[_0x3dff18]['batch_code']=_0x1ba6af;}),_0x572c36['forEach']((_0x30bd30,_0x245d36)=>{_0x5abd9f[_0x245d36]['expiry_date']=_0x30bd30;}),_0x893f98['forEach']((_0x776396,_0x35c382)=>{var _0x275f3=_0x455c63;_0x5abd9f[_0x35c382][_0x275f3(0x1ea)]=_0x776396;}),_0x1c51ee['forEach']((_0x37c3d0,_0x49c246)=>{var _0x11421d=_0x455c63;_0x5abd9f[_0x49c246][_0x11421d(0x1be)]=_0x37c3d0;}),_0x45da4a[_0x455c63(0x1c8)]((_0x1b4866,_0x140fc9)=>{var _0x1449b9=_0x455c63;_0x5abd9f[_0x140fc9][_0x1449b9(0x21a)]=_0x1b4866;}),_0x13be19[_0x455c63(0x1c8)]((_0x564cbb,_0x43dbed)=>{var _0x45ea18=_0x455c63;_0x5abd9f[_0x43dbed][_0x45ea18(0x187)]=_0x564cbb;}),_0x39e20d['forEach']((_0x13109f,_0x4944ea)=>{var _0x2b3ae7=_0x455c63;_0x5abd9f[_0x4944ea][_0x2b3ae7(0x20c)]=_0x13109f;});const _0xf782e6=_0x5abd9f[_0x455c63(0x1af)](_0x438905=>_0x438905[_0x455c63(0x22d)]!=='0'&&_0x438905[_0x455c63(0x22d)]!==''||_0x438905[_0x455c63(0x223)]!=='0'&&_0x438905[_0x455c63(0x223)]!==''),_0x5ee3f9=new transfers({'date':_0x5b2bad,'from_warehouse':_0x1eac65,'to_warehouse':_0x38616d,'product':_0xf782e6,'note':_0x58ce59,'invoice':_0x53ac76}),_0x3a996e=await _0x5ee3f9['save']();_0x59de94['flash']('success',_0x455c63(0x231)),_0x53d4a6[_0x455c63(0x1a5)]('/transfer/preview/'+_0x3a996e[_0x455c63(0x164)]);}catch(_0x25b198){console[_0x455c63(0x215)](_0x25b198),_0x53d4a6[_0x455c63(0x163)](0xc8)[_0x455c63(0x239)]({'errorMessage':_0x25b198[_0x455c63(0x1b0)]});}}),router[a0_0xaf309c(0x16a)](a0_0xaf309c(0x1b7),auth,async(_0x597a78,_0x3f06b9)=>{var _0x548fbd=a0_0xaf309c;try{const {username:_0x1f0b98,email:_0x5e72f8,role:_0x495841}=_0x597a78[_0x548fbd(0x1cd)],_0x4a14f8=_0x597a78[_0x548fbd(0x1cd)],_0x48c368=await profile['findOne']({'email':_0x4a14f8[_0x548fbd(0x227)]}),_0x3e1605=await master_shop['find']();console['log']('master',_0x3e1605);const _0x537c29=await transfers[_0x548fbd(0x1b3)](_0x597a78[_0x548fbd(0x22c)]['id']);let _0x2a74b4=new Date(_0x537c29[_0x548fbd(0x1c9)]),_0x4ca7db=('0'+_0x2a74b4[_0x548fbd(0x170)]())[_0x548fbd(0x150)](-0x2),_0x4b5b77=('0'+(_0x2a74b4['getMonth']()+0x1))[_0x548fbd(0x150)](-0x2),_0x3d1954=_0x2a74b4[_0x548fbd(0x1cc)](),_0x4f6710=_0x3d1954+'-'+_0x4b5b77+'-'+_0x4ca7db,_0x21c670;if(_0x4a14f8[_0x548fbd(0x1d7)]==_0x548fbd(0x1a6)){const _0x147257=await staff[_0x548fbd(0x1ff)]({'email':_0x4a14f8[_0x548fbd(0x227)]});_0x21c670=await warehouse[_0x548fbd(0x1ec)]({'status':'Enabled','name':_0x147257[_0x548fbd(0x209)],'warehouse_category':_0x548fbd(0x21c)});}else _0x21c670=await warehouse[_0x548fbd(0x1ec)]({'status':'Enabled','warehouse_category':'Raw\x20Materials'});const _0x559424=await warehouse[_0x548fbd(0x1df)]([{'$match':{'name':_0x537c29[_0x548fbd(0x16f)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x548fbd(0x1da)},'product_stock':{'$first':_0x548fbd(0x210)},'bay':{'$first':_0x548fbd(0x1dc)},'bin':{'$first':_0x548fbd(0x1d1)},'type':{'$first':_0x548fbd(0x1e7)},'floorlevel':{'$first':_0x548fbd(0x237)},'primary_code':{'$first':_0x548fbd(0x1eb)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x548fbd(0x1d6)},'rack':{'$first':_0x548fbd(0x20a)},'expiry_date':{'$first':_0x548fbd(0x1e8)},'production_date':{'$first':_0x548fbd(0x1bf)},'room':{'$first':_0x548fbd(0x162)}}}]);if(_0x3e1605[0x0][_0x548fbd(0x224)]==_0x548fbd(0x228)){var _0x4e84c1=users[_0x548fbd(0x18a)];console['log'](_0x4e84c1);}else{if(_0x3e1605[0x0][_0x548fbd(0x224)]=='Hindi')var _0x4e84c1=users[_0x548fbd(0x23d)];else{if(_0x3e1605[0x0][_0x548fbd(0x224)]=='German')var _0x4e84c1=users[_0x548fbd(0x1de)];else{if(_0x3e1605[0x0]['language']==_0x548fbd(0x22e))var _0x4e84c1=users[_0x548fbd(0x22e)];else{if(_0x3e1605[0x0][_0x548fbd(0x224)]==_0x548fbd(0x1b9))var _0x4e84c1=users[_0x548fbd(0x1b9)];else{if(_0x3e1605[0x0][_0x548fbd(0x224)]==_0x548fbd(0x177))var _0x4e84c1=users[_0x548fbd(0x167)];else{if(_0x3e1605[0x0][_0x548fbd(0x224)]==_0x548fbd(0x226))var _0x4e84c1=users[_0x548fbd(0x226)];else{if(_0x3e1605[0x0][_0x548fbd(0x224)]=='Arabic\x20(ae)')var _0x4e84c1=users[_0x548fbd(0x176)];}}}}}}}_0x3f06b9[_0x548fbd(0x1b2)]('edit_transfer_view',{'success':_0x597a78[_0x548fbd(0x18f)]('success'),'errors':_0x597a78[_0x548fbd(0x18f)](_0x548fbd(0x17c)),'role':_0x4a14f8,'profile':_0x48c368,'master_shop':_0x3e1605,'warehouse':_0x21c670,'transfer':_0x537c29,'stock':_0x559424,'language':_0x4e84c1});}catch(_0x758628){console[_0x548fbd(0x215)](_0x758628);}}),router[a0_0xaf309c(0x1fd)](a0_0xaf309c(0x1b7),auth,async(_0x398f64,_0x5f36dd)=>{var _0x301baa=a0_0xaf309c;try{const _0x2e4a26=_0x398f64[_0x301baa(0x22c)]['id'],{from_warehouse:_0x42102a,FromRoom_name:_0x1c61eb,to_warehouse:_0x1c292b,ToRoom_name:_0x35d2a1}=_0x398f64[_0x301baa(0x1a9)],_0x515784=await transfers[_0x301baa(0x1b3)]({'_id':_0x2e4a26}),_0x2ea386=_0x515784['product']['map'](async _0x165d31=>{var _0x4a6eda=_0x301baa;if(_0x165d31[_0x4a6eda(0x22d)]>0x0){var _0x24aec7=await warehouse[_0x4a6eda(0x1ff)]({'name':_0x515784[_0x4a6eda(0x16f)],'room':_0x165d31[_0x4a6eda(0x187)],'warehouse_category':_0x4a6eda(0x21c)});const _0xd5f436=_0x24aec7[_0x4a6eda(0x157)]['map'](_0x2da5ee=>{var _0x16c3f9=_0x4a6eda;_0x2da5ee[_0x16c3f9(0x181)]==_0x165d31[_0x16c3f9(0x181)]&&_0x2da5ee[_0x16c3f9(0x1c7)]==_0x165d31[_0x16c3f9(0x16d)]&&_0x2da5ee[_0x16c3f9(0x234)]==_0x165d31['from_types']&&_0x2da5ee[_0x16c3f9(0x1f3)]==_0x165d31[_0x16c3f9(0x214)]&&_0x2da5ee[_0x16c3f9(0x1ae)]==_0x165d31[_0x16c3f9(0x175)]&&_0x2da5ee[_0x16c3f9(0x18c)]==_0x165d31[_0x16c3f9(0x1ed)]&&_0x2da5ee[_0x16c3f9(0x1e2)]==_0x165d31[_0x16c3f9(0x232)]&&_0x2da5ee[_0x16c3f9(0x1c9)]==_0x165d31[_0x16c3f9(0x1c9)]&&_0x2da5ee[_0x16c3f9(0x1c1)]==_0x165d31['batch_code']&&_0x2da5ee['production_date']==_0x165d31['production_date']&&_0x2da5ee[_0x16c3f9(0x1fb)]==_0x165d31[_0x16c3f9(0x182)]&&_0x2da5ee['_id']==_0x165d31['id_transaction_id']&&(_0x2da5ee[_0x16c3f9(0x201)]=_0x2da5ee[_0x16c3f9(0x201)]-_0x165d31[_0x16c3f9(0x22d)]);});}return _0x24aec7;});Promise[_0x301baa(0x220)](_0x2ea386)[_0x301baa(0x1a4)](async _0x4beeec=>{var _0x214003=_0x301baa;try{for(const _0x11df1c of _0x4beeec){await _0x11df1c[_0x214003(0x16e)]();}try{const _0x549d87=_0x515784[_0x214003(0x1ba)][_0x214003(0x229)](async _0x1af8fc=>{var _0xbdfb9c=_0x214003;if(_0x1af8fc[_0xbdfb9c(0x22d)]>0x0){var _0x27d495=await warehouse[_0xbdfb9c(0x1ff)]({'name':_0x515784[_0xbdfb9c(0x1d8)],'room':_0x1af8fc[_0xbdfb9c(0x20c)],'warehouse_category':_0xbdfb9c(0x21c)}),_0x2cd38f=0x0;const _0x3a64f9=_0x27d495[_0xbdfb9c(0x157)][_0xbdfb9c(0x229)](_0x10827b=>{var _0x225e36=_0xbdfb9c;_0x10827b[_0x225e36(0x181)]==_0x1af8fc[_0x225e36(0x181)]&&_0x10827b[_0x225e36(0x1c7)]==_0x1af8fc[_0x225e36(0x223)]&&_0x10827b[_0x225e36(0x234)]==_0x1af8fc['to_types']&&_0x10827b[_0x225e36(0x1f3)]==_0x1af8fc[_0x225e36(0x1c4)]&&_0x10827b['bay']==_0x1af8fc[_0x225e36(0x189)]&&_0x10827b[_0x225e36(0x18c)]==_0x1af8fc['rack']&&_0x10827b[_0x225e36(0x1e2)]==_0x1af8fc[_0x225e36(0x1e2)]&&_0x10827b[_0x225e36(0x1c9)]==_0x1af8fc[_0x225e36(0x1c9)]&&_0x10827b[_0x225e36(0x1c1)]==_0x1af8fc[_0x225e36(0x1c1)]&&_0x10827b[_0x225e36(0x1be)]==_0x1af8fc['production_date']&&_0x10827b[_0x225e36(0x1fb)]==_0x1af8fc[_0x225e36(0x19a)]&&(_0x10827b['product_stock']=_0x10827b['product_stock']+_0x1af8fc['to_quantity'],_0x2cd38f++);});_0x2cd38f=='0'&&(_0x27d495[_0xbdfb9c(0x157)]=_0x27d495[_0xbdfb9c(0x157)]['concat']({'product_name':_0x1af8fc['product_name'],'product_stock':_0x1af8fc[_0xbdfb9c(0x22d)],'bay':_0x1af8fc[_0xbdfb9c(0x189)],'bin':_0x1af8fc[_0xbdfb9c(0x1c4)],'type':_0x1af8fc[_0xbdfb9c(0x1d3)],'floorlevel':_0x1af8fc['to_floorlevel'],'storage':_0x1af8fc[_0xbdfb9c(0x1e2)],'rack':_0x1af8fc['rack'],'product_code':_0x1af8fc[_0xbdfb9c(0x1bb)],'primary_code':_0x1af8fc[_0xbdfb9c(0x217)],'secondary_code':_0x1af8fc['secondary_code'],'maxProducts':_0x1af8fc[_0xbdfb9c(0x1f7)],'storage':_0x1af8fc[_0xbdfb9c(0x1e2)],'rack':_0x1af8fc[_0xbdfb9c(0x18c)],'expiry_date':_0x1af8fc[_0xbdfb9c(0x1c9)],'maxPerUnit':_0x1af8fc[_0xbdfb9c(0x1ea)],'batch_code':_0x1af8fc[_0xbdfb9c(0x1c1)],'production_date':_0x1af8fc['production_date']}));}return _0x27d495;});Promise[_0x214003(0x220)](_0x549d87)[_0x214003(0x1a4)](async _0x2b2ae1=>{var _0x1157d6=_0x214003;try{for(const _0x48f02a of _0x2b2ae1){await warehouse[_0x1157d6(0x1e6)]({'_id':_0x48f02a['_id']},{'$addToSet':{'product_details':{'$each':_0x48f02a['product_details']}}});}_0x515784['finalize']=_0x1157d6(0x19e);const _0x2342be=await _0x515784[_0x1157d6(0x16e)](),_0x31a258=await master_shop['find'](),_0x30ea28=await email_settings[_0x1157d6(0x1ff)](),_0x5bbb88=await supervisor_settings[_0x1157d6(0x1ec)]();var _0x4938ab=_0x515784['product'],_0x4147e3='',_0x4e461c;for(_0x4e461c in _0x4938ab){_0x4147e3+=_0x1157d6(0x1b1)+_0x1157d6(0x1e9)+_0x4938ab[_0x4e461c][_0x1157d6(0x181)]+_0x1157d6(0x186)+_0x1157d6(0x1e9)+_0x4938ab[_0x4e461c]['product_code']+_0x1157d6(0x186)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4938ab[_0x4e461c][_0x1157d6(0x22d)]+_0x1157d6(0x186)+_0x1157d6(0x1e9)+_0x4938ab[_0x4e461c][_0x1157d6(0x22a)]+_0x1157d6(0x186)+_0x1157d6(0x1e9)+_0x4938ab[_0x4e461c][_0x1157d6(0x17a)]+_0x1157d6(0x186)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x515784['to_warehouse']+_0x1157d6(0x186)+_0x1157d6(0x1e9)+_0x4938ab[_0x4e461c][_0x1157d6(0x20c)]+_0x1157d6(0x186)+_0x1157d6(0x1e9)+_0x4938ab[_0x4e461c][_0x1157d6(0x1e2)]+_0x4938ab[_0x4e461c][_0x1157d6(0x18c)]+_0x4938ab[_0x4e461c][_0x1157d6(0x189)]+_0x4938ab[_0x4e461c][_0x1157d6(0x1c4)]+_0x4938ab[_0x4e461c][_0x1157d6(0x1d3)][0x0]+_0x4938ab[_0x4e461c]['to_floorlevel']+'</td>','</tr>';}let _0x4e8af4=nodemailer['createTransport']({'host':_0x30ea28[_0x1157d6(0x1aa)],'port':Number(_0x30ea28[_0x1157d6(0x207)]),'secure':![],'auth':{'user':_0x30ea28[_0x1157d6(0x227)],'pass':_0x30ea28[_0x1157d6(0x213)]}}),_0x62250e={'from':_0x30ea28[_0x1157d6(0x227)],'to':_0x5bbb88[0x0]['RMSEmail'],'subject':_0x1157d6(0x195),'attachments':[{'filename':'Logo.png','path':__dirname+_0x1157d6(0x1e3)+'/upload/'+_0x31a258[0x0][_0x1157d6(0x218)],'cid':_0x1157d6(0x1fa)}],'html':_0x1157d6(0x238)+_0x1157d6(0x17b)+'</head><body>'+_0x1157d6(0x15b)+_0x1157d6(0x1dd)+'<div>'+_0x1157d6(0x15c)+_0x1157d6(0x1ad)+'<div>'+_0x1157d6(0x156)+_0x31a258[0x0][_0x1157d6(0x17e)]+_0x1157d6(0x19c)+_0x1157d6(0x1ad)+'</div>'+_0x1157d6(0x179)+'<div>'+_0x1157d6(0x169)+_0x1157d6(0x190)+_0x515784[_0x1157d6(0x1fb)]+'\x20'+_0x1157d6(0x211)+_0x1157d6(0x1f5)+_0x515784[_0x1157d6(0x159)]+'\x20'+_0x1157d6(0x152)+_0x1157d6(0x18e)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1157d6(0x1b1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x1157d6(0x160)+_0x1157d6(0x1fc)+_0x1157d6(0x1cb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x1157d6(0x1bd)+_0x1157d6(0x166)+_0x1157d6(0x1fe)+_0x1157d6(0x1f8)+_0x1157d6(0x191)+_0x1157d6(0x16c)+'\x20'+_0x4147e3+'\x20'+_0x1157d6(0x1b8)+_0x1157d6(0x199)+_0x1157d6(0x15b)+_0x1157d6(0x192)+'<h5>'+_0x31a258[0x0]['site_title']+_0x1157d6(0x18e)+_0x1157d6(0x1ad)+_0x1157d6(0x1ad)+_0x1157d6(0x230)};_0x4e8af4[_0x1157d6(0x1ef)](_0x62250e,function(_0x4b2ca6,_0x5a83be){var _0x4326e6=_0x1157d6;_0x4b2ca6?(console[_0x4326e6(0x215)](_0x4b2ca6),console[_0x4326e6(0x215)](_0x4326e6(0x200))):console[_0x4326e6(0x215)](_0x4326e6(0x188));}),_0x398f64[_0x1157d6(0x18f)](_0x1157d6(0x18b),_0x1157d6(0x168)),_0x5f36dd['redirect']('/picking_list/PDF_transfer_rm/'+_0x2342be[_0x1157d6(0x164)]);}catch(_0x30ff45){console['error'](_0x30ff45),_0x5f36dd[_0x1157d6(0x163)](0x1f4)[_0x1157d6(0x239)]({'Perror':_0x1157d6(0x1f1),'message':_0x30ff45[_0x1157d6(0x1b0)]});}})['catch'](_0x5e6fb2=>{var _0x15176e=_0x214003;console[_0x15176e(0x21f)](_0x5e6fb2),_0x5f36dd[_0x15176e(0x163)](0x1f4)['json']({'Perror':_0x15176e(0x219)});});}catch(_0x5be69d){_0x5f36dd[_0x214003(0x239)](_0x5be69d);}}catch(_0x275a80){console['error'](_0x275a80),_0x5f36dd['status'](0x1f4)['json']({'Merror':_0x214003(0x1f1),'Message':_0x275a80[_0x214003(0x1b0)]});}})[_0x301baa(0x196)](_0x4895d8=>{var _0x538987=_0x301baa;console[_0x538987(0x21f)](_0x4895d8),_0x5f36dd[_0x538987(0x163)](0x1f4)['json']({'Merror':'An\x20error\x20occurred.'});});}catch(_0x1e6643){console[_0x301baa(0x215)](_0x1e6643);}});function a0_0x3694(){var _0x329ba8=['Arabic','Portuguese\x20(BR)','Enabled','<hr\x20class=\x22my-3\x22>','secondary_unit','<html><head><title></title>','errors','Rack\x20E','site_title','$product.from_room_name','$_id','product_name','from_invoice','../public/language/languages.json','New_Qty_Converted','$name','</td>','from_room_name','Email\x20sent\x20successfully','to_bay','English','success','rack','to_prod_qty','</h5>','flash','\x20Order\x20Number\x20:\x20','</thead>','<strong>\x20Regards\x20</strong>','add_transfer','product_code3','Transfer\x20Mail','catch','Enclosed','$to_warehouse','</table>','To_invoice','$product_details','\x20</h2>','3246019ezoFDZ','True','549572ePGCIX','to_prod_level','696051ELzDDW','$product_details.maxProducts','to_prod_pallet','then','redirect','staff','$product_details.secondary_unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','body','host','Return\x20Rooms','2BUTTun','</div>','bay','filter','message','<tr>','render','findById','transfer','from_prod_level','length','/preview/:id','</tbody>','French','product','product_code','from_prod_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','production_date','$product_details.production_date','Shelves','batch_code','string','express','to_bin','$product','primary_unit','floorlevel','forEach','expiry_date','Ambient','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','getFullYear','user','concat','$product_details.product_code','31989fALpaH','$product_details.bin','/transfer/view','to_types','190EPEzcQ','$product_details._id','$product_details.storage','role','to_warehouse','Floor','$product_details.product_name','push','$product_details.bay','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','German','aggregate','to_room','rak','storage','/../public','Level','exports','updateOne','$product_details.type','$product_details.expiry_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','maxperunit','$product_details.primary_code','find','from_rack','813176FLfCbq','sendMail','$product_details.batch_code','An\x20error\x20occurred\x20while\x20saving\x20data.','/barcode_scanner2','bin','TRF-','\x20Order\x20Date\x20:\x20','$finalize','maxProducts','</tr>','to_prod_isle','logo','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','post','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','findOne','Error\x20Occurs','product_stock','secondary_code','from_prod_pallet','Arabic\x20(ae)','\x20<>\x20','$product_details.isle','port','to_invoice','warehouse','$product_details.rack','from_room','to_room_name','split','Rack\x20B','id_transaction','$product_details.product_stock','<span\x20style=\x22float:\x20right;\x22>','RoomAssigned','password','from_bin','log','132tgXfIa','primary_code','image','An\x20error\x20occurred.','prod_cat','1785126imsSHs','Raw\x20Materials','$product_details.level','35025UPfmFn','error','all','COLD\x20STORAGE','../models/all_models','to_floorlevel','language','ToRoomAssigned','Chinese','email','English\x20(US)','map','unit','Receiving\x20Area','params','to_quantity','Spanish','$product_details.pallet','</body></html>','Product\x20Transfer\x20successfully','from_storage','padStart','type','edit_transfer','id_transaction_id','$product_details.floorlevel','<!DOCTYPE\x20html>','json','$product_details.secondary_code','random','/barcode_scanner3','Hindi','here','slice','Rack\x20C','</span>','from_types','Rack\x20A','$product_details.unit','<h2>\x20','product_details','back','date','MaxStocks_data2','<div>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view','$product_details.invoice','from_prod_isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','prod_name','$room','status','_id','from_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Portuguese','Transfer\x20Finalize\x20Successfully','<h5\x20style=\x22text-align:\x20left;\x22>','get','$from_warehouse','<tbody\x20style=\x22text-align:\x20center;\x22>','from_floorlevel','save','from_warehouse','getDate','master','/view/add_transfer','$product_details.maxPerUnit','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','from_bay'];a0_0x3694=function(){return _0x329ba8;};return a0_0x3694();}function BayBinSelected(_0x1f8119,_0x55f611){var _0x4aadfb=a0_0xaf309c,_0x24e411=[],_0x398042=[],_0x4ff240=[],_0x347be6=[],_0x36a2ce=[],_0x5f5183=[];let _0x40e65b=[];if(_0x1f8119=='DRY\x20STORAGE')switch(_0x55f611){case _0x4aadfb(0x154):_0x24e411=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x398042=[0x1,0x2],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=[_0x4aadfb(0x1e4),'Floor'],_0x36a2ce=['D'],_0x5f5183=['A'];break;case'Rack\x20B':_0x24e411=[0x6,0x5,0x4,0x3,0x2,0x1],_0x398042=[0x1,0x2],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=[_0x4aadfb(0x1e4),_0x4aadfb(0x1d9)],_0x36a2ce=['D'],_0x5f5183=['B'];break;case _0x4aadfb(0x1c0):_0x24e411=[0x0],_0x398042=[0x0],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=[_0x4aadfb(0x1d9)],_0x36a2ce=['D'],_0x5f5183=['S'];break;case _0x4aadfb(0x22b):_0x24e411=[0x0],_0x398042=[0x0],_0x347be6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x4ff240=['Floor'],_0x36a2ce=['D'],_0x5f5183=['R'];break;}else{if(_0x1f8119==_0x4aadfb(0x221))switch(_0x55f611){case _0x4aadfb(0x154):_0x24e411=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x398042=['B','F'],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=[_0x4aadfb(0x1e4),_0x4aadfb(0x1d9)],_0x36a2ce=['C'],_0x5f5183=['A'];break;case _0x4aadfb(0x20e):_0x24e411=[0x5,0x4,0x3,0x2,0x1],_0x398042=['F','B','S'],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=['Level','Floor'],_0x36a2ce=['C'],_0x5f5183=['B'];break;case _0x4aadfb(0x151):_0x24e411=[0x1,0x2,0x3,0x4,0x5],_0x398042=['B','F','S'],_0x347be6=[0x5,0x4,0x3,0x2,0x1],_0x4ff240=['Level',_0x4aadfb(0x1d9)],_0x36a2ce=['C'],_0x5f5183=['C'];break;case'Rack\x20D':_0x24e411=[0x5,0x4,0x3,0x2,0x1],_0x398042=['F','B','S'],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=['Level',_0x4aadfb(0x1d9)],_0x36a2ce=['C'],_0x5f5183=['D'];break;case _0x4aadfb(0x17d):_0x24e411=[0x4,0x3,0x2,0x1],_0x398042=[0x1,0x2],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=[_0x4aadfb(0x1e4),_0x4aadfb(0x1d9)],_0x36a2ce=['C'],_0x5f5183=['E'];break;case'Rack\x20F':_0x24e411=[0x1,0x2,0x3],_0x398042=[0x1,0x2],_0x347be6=[0x1,0x2,0x3,0x4,0x5],_0x4ff240=['Level'],_0x36a2ce=['C'],_0x5f5183=['F'];break;}}return{'levels':_0x24e411,'Isle':_0x398042,'rack':_0x347be6,'type':_0x4ff240,'storage':_0x36a2ce,'rak':_0x5f5183};}router[a0_0xaf309c(0x16a)]('/view/:id',auth,async(_0x793364,_0x37725)=>{var _0x2ee426=a0_0xaf309c;try{const {username:_0x586156,email:_0x5d5445,role:_0x3af31f}=_0x793364['user'],_0x498dfa=_0x793364[_0x2ee426(0x1cd)],_0x456964=await profile[_0x2ee426(0x1ff)]({'email':_0x498dfa['email']}),_0x3704f3=await master_shop[_0x2ee426(0x1ec)](),_0x4e54d9=await transfers['findById'](_0x793364[_0x2ee426(0x22c)]['id']);let _0x34b63e;if(_0x498dfa['role']==_0x2ee426(0x1a6)){const _0x150f96=await staff[_0x2ee426(0x1ff)]({'email':_0x498dfa[_0x2ee426(0x227)]});_0x34b63e=await warehouse[_0x2ee426(0x1df)]([{'$match':{'status':_0x2ee426(0x178),'name':_0x150f96[_0x2ee426(0x209)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x2ee426(0x185),'name':{'$first':'$name'}}}]);}else _0x34b63e=await warehouse[_0x2ee426(0x1df)]([{'$match':{'status':_0x2ee426(0x178),'warehouse_category':_0x2ee426(0x21c)}},{'$group':{'_id':_0x2ee426(0x185),'name':{'$first':'$name'}}}]);const _0x267c7a=await warehouse[_0x2ee426(0x1df)]([{'$match':{'name':_0x4e54d9[_0x2ee426(0x16f)],'warehouse_category':_0x2ee426(0x21c)}},{'$unwind':_0x2ee426(0x19b)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2ee426(0x1dc)},'bin':{'$first':_0x2ee426(0x1d1)},'type':{'$first':_0x2ee426(0x1e7)},'floorlevel':{'$first':_0x2ee426(0x237)},'primary_code':{'$first':_0x2ee426(0x1eb)},'secondary_code':{'$first':_0x2ee426(0x23a)},'product_code':{'$first':_0x2ee426(0x1cf)},'storage':{'$first':_0x2ee426(0x1d6)},'rack':{'$first':_0x2ee426(0x20a)},'expiry_date':{'$first':_0x2ee426(0x1e8)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]),_0xd4e262=await product[_0x2ee426(0x1ec)]({}),_0xc7d917=BayBinSelected(_0x4e54d9[_0x2ee426(0x1d8)],_0x4e54d9['to_room']);if(_0x3704f3[0x0]['language']==_0x2ee426(0x228)){var _0x1397cd=users[_0x2ee426(0x18a)];console[_0x2ee426(0x215)](_0x1397cd);}else{if(_0x3704f3[0x0][_0x2ee426(0x224)]==_0x2ee426(0x23d))var _0x1397cd=users[_0x2ee426(0x23d)];else{if(_0x3704f3[0x0][_0x2ee426(0x224)]==_0x2ee426(0x1de))var _0x1397cd=users[_0x2ee426(0x1de)];else{if(_0x3704f3[0x0][_0x2ee426(0x224)]==_0x2ee426(0x22e))var _0x1397cd=users['Spanish'];else{if(_0x3704f3[0x0][_0x2ee426(0x224)]==_0x2ee426(0x1b9))var _0x1397cd=users[_0x2ee426(0x1b9)];else{if(_0x3704f3[0x0][_0x2ee426(0x224)]==_0x2ee426(0x177))var _0x1397cd=users[_0x2ee426(0x167)];else{if(_0x3704f3[0x0][_0x2ee426(0x224)]==_0x2ee426(0x226))var _0x1397cd=users[_0x2ee426(0x226)];else{if(_0x3704f3[0x0]['language']==_0x2ee426(0x204))var _0x1397cd=users[_0x2ee426(0x176)];}}}}}}}_0x37725[_0x2ee426(0x1b2)](_0x2ee426(0x235),{'success':_0x793364['flash'](_0x2ee426(0x18b)),'errors':_0x793364['flash']('errors'),'role':_0x498dfa,'profile':_0x456964,'master_shop':_0x3704f3,'warehouse':_0x34b63e,'transfer':_0x4e54d9,'stock':_0x267c7a,'unit':_0xd4e262,'language':_0x1397cd});}catch(_0x3e7186){console[_0x2ee426(0x215)](_0x3e7186);}}),router['post']('/view/:id',auth,async(_0x2c98c3,_0x4421f7)=>{var _0x1c661e=a0_0xaf309c;try{const _0x32d3fc=_0x2c98c3[_0x1c661e(0x22c)]['id'],_0x1f6740=await transfers[_0x1c661e(0x1b3)](_0x32d3fc);_0x4421f7[_0x1c661e(0x239)](_0x2c98c3['body']);return;const {date:_0x59dcdb,from_warehouse:_0x1d791d,FromRoom_name:_0x25e1e8,to_warehouse:_0x24647c,ToRoom_name:_0x3383ea,prod_name:_0x5d9b5a,from_prod_qty:_0x8d109,from_prod_level:_0x51ca8d,from_prod_isle:_0x351d06,from_prod_pallet:_0x25df31,to_prod_qty:_0x45ccd4,to_prod_level:_0x4c81c0,to_prod_isle:_0xb4decd,to_prod_pallet:_0x482711,primary_code:_0x5773f0,secondary_code:_0x287c2b,product_code3:_0x4a8eb1,note:_0x5f4e9d,invoice:_0x1ff567,expiry_date:_0x11fc3d}=_0x2c98c3[_0x1c661e(0x1a9)];if(typeof _0x5d9b5a==_0x1c661e(0x1c2))var _0x72c5c3=[_0x2c98c3['body'][_0x1c661e(0x161)]],_0x1d2881=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1bc)]],_0x38234f=[_0x2c98c3[_0x1c661e(0x1a9)]['from_prod_level']],_0x2b2a86=[_0x2c98c3['body'][_0x1c661e(0x15f)]],_0x3a7b77=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x203)]],_0x25d442=[_0x2c98c3['body'][_0x1c661e(0x153)]],_0x31efe9=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x18d)]],_0x4083b1=[_0x2c98c3['body'][_0x1c661e(0x1a0)]],_0x24e406=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1f9)]],_0x171c60=[_0x2c98c3['body'][_0x1c661e(0x1a3)]],_0x1043b4=[_0x2c98c3[_0x1c661e(0x1a9)]['to_types']],_0x27c25c=[_0x2c98c3['body'][_0x1c661e(0x1e2)]],_0x5c2a0e=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1e1)]],_0xca831e=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x217)]],_0x105349=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x202)]],_0xaded79=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x194)]],_0xaa97e6=[_0x2c98c3[_0x1c661e(0x1a9)]['MaxStocks_data2']],_0x5dbd9d=[_0x2c98c3['body'][_0x1c661e(0x22a)]],_0x2295b3=[_0x2c98c3[_0x1c661e(0x1a9)]['secondary_unit']],_0x14acbe=[_0x2c98c3['body'][_0x1c661e(0x1c1)]],_0x1b9e1a=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1c9)]],_0x56a84d=[_0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x232)]],_0x585850=[_0x2c98c3[_0x1c661e(0x1a9)]['from_rak']];else var _0x72c5c3=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x161)]],_0x27c25c=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1e2)]],_0x5c2a0e=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1e1)]],_0x25d442=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x153)]],_0x1043b4=[..._0x2c98c3[_0x1c661e(0x1a9)]['to_types']],_0x1d2881=[..._0x2c98c3[_0x1c661e(0x1a9)]['from_prod_qty']],_0x38234f=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1b5)]],_0x2b2a86=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x15f)]],_0x3a7b77=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x203)]],_0x31efe9=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x18d)]],_0x4083b1=[..._0x2c98c3[_0x1c661e(0x1a9)]['to_prod_level']],_0x24e406=[..._0x2c98c3[_0x1c661e(0x1a9)]['to_prod_isle']],_0x171c60=[..._0x2c98c3[_0x1c661e(0x1a9)]['to_prod_pallet']],_0xca831e=[..._0x2c98c3['body'][_0x1c661e(0x217)]],_0x105349=[..._0x2c98c3[_0x1c661e(0x1a9)]['secondary_code']],_0xaded79=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x194)]],_0xaa97e6=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x15a)]],_0x5dbd9d=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x22a)]],_0x2295b3=[..._0x2c98c3[_0x1c661e(0x1a9)]['secondary_unit']],_0x14acbe=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1c1)]],_0x1b9e1a=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x1c9)]],_0x56a84d=[..._0x2c98c3[_0x1c661e(0x1a9)][_0x1c661e(0x232)]],_0x585850=[..._0x2c98c3[_0x1c661e(0x1a9)]['from_rak']];const _0x4b764f=_0x72c5c3['map'](_0x556ff3=>{return _0x556ff3={'product_name':_0x556ff3};});_0x1d2881['forEach']((_0x4f11ce,_0x36c0c4)=>{var _0x4762ac=_0x1c661e;_0x4b764f[_0x36c0c4][_0x4762ac(0x165)]=_0x4f11ce;}),_0x38234f[_0x1c661e(0x1c8)]((_0x287994,_0xc18fcc)=>{var _0x494906=_0x1c661e;_0x4b764f[_0xc18fcc][_0x494906(0x175)]=_0x287994;}),_0x2b2a86[_0x1c661e(0x1c8)]((_0x3179ca,_0x384444)=>{var _0x15386d=_0x1c661e;_0x4b764f[_0x384444][_0x15386d(0x214)]=_0x3179ca;}),_0x3a7b77['forEach']((_0x488d8b,_0x1ec17a)=>{_0x4b764f[_0x1ec17a]['from_floorlevel']=_0x488d8b;}),_0x31efe9[_0x1c661e(0x1c8)]((_0x58ae73,_0xfe7f42)=>{var _0x16118f=_0x1c661e;_0x4b764f[_0xfe7f42][_0x16118f(0x22d)]=_0x58ae73;}),_0x4083b1[_0x1c661e(0x1c8)]((_0x139ec5,_0x5679e5)=>{_0x4b764f[_0x5679e5]['to_bay']=_0x139ec5;}),_0x24e406[_0x1c661e(0x1c8)]((_0x682df,_0x4f0f30)=>{var _0x17d9d9=_0x1c661e;_0x4b764f[_0x4f0f30][_0x17d9d9(0x1c4)]=_0x682df;}),_0x171c60['forEach']((_0x544220,_0x5d6638)=>{var _0x3156a6=_0x1c661e;_0x4b764f[_0x5d6638][_0x3156a6(0x223)]=_0x544220;}),_0xca831e[_0x1c661e(0x1c8)]((_0x42d595,_0x290b47)=>{_0x4b764f[_0x290b47]['primary_code']=_0x42d595;}),_0x105349[_0x1c661e(0x1c8)]((_0x1769de,_0x12179d)=>{var _0x2ec3bd=_0x1c661e;_0x4b764f[_0x12179d][_0x2ec3bd(0x202)]=_0x1769de;}),_0xaded79[_0x1c661e(0x1c8)]((_0x56ea74,_0x5bfaf5)=>{var _0x10cd78=_0x1c661e;_0x4b764f[_0x5bfaf5][_0x10cd78(0x1bb)]=_0x56ea74;}),_0xaa97e6[_0x1c661e(0x1c8)]((_0x33085f,_0x4601b9)=>{var _0x336ea5=_0x1c661e;_0x4b764f[_0x4601b9][_0x336ea5(0x1f7)]=_0x33085f;}),_0x5dbd9d[_0x1c661e(0x1c8)]((_0xd8ef13,_0x4ca5cb)=>{var _0x1f4525=_0x1c661e;_0x4b764f[_0x4ca5cb][_0x1f4525(0x22a)]=_0xd8ef13;}),_0x2295b3['forEach']((_0x15bf74,_0x9161bb)=>{var _0x3fa814=_0x1c661e;_0x4b764f[_0x9161bb][_0x3fa814(0x17a)]=_0x15bf74;}),_0x14acbe['forEach']((_0x44a20f,_0xdae9a0)=>{var _0x202215=_0x1c661e;_0x4b764f[_0xdae9a0][_0x202215(0x1c1)]=_0x44a20f;}),_0x1b9e1a[_0x1c661e(0x1c8)]((_0x1a6073,_0x15936c)=>{_0x4b764f[_0x15936c]['expiry_date']=_0x1a6073;}),_0x27c25c[_0x1c661e(0x1c8)]((_0x629e9a,_0xe862ba)=>{_0x4b764f[_0xe862ba]['storage']=_0x629e9a;}),_0x5c2a0e[_0x1c661e(0x1c8)]((_0x4ab45b,_0x44aedc)=>{var _0x11c141=_0x1c661e;_0x4b764f[_0x44aedc][_0x11c141(0x18c)]=_0x4ab45b;}),_0x25d442[_0x1c661e(0x1c8)]((_0x17b91d,_0x1676bf)=>{var _0x16c91=_0x1c661e;_0x4b764f[_0x1676bf][_0x16c91(0x153)]=_0x17b91d;}),_0x1043b4[_0x1c661e(0x1c8)]((_0x1f51be,_0xe33f16)=>{var _0x6c65a5=_0x1c661e;_0x4b764f[_0xe33f16][_0x6c65a5(0x1d3)]=_0x1f51be;}),_0x56a84d[_0x1c661e(0x1c8)]((_0x2674fd,_0x1028cf)=>{var _0x517dc4=_0x1c661e;_0x4b764f[_0x1028cf][_0x517dc4(0x232)]=_0x2674fd;}),_0x585850[_0x1c661e(0x1c8)]((_0x1f6c2c,_0x12321f)=>{var _0x168287=_0x1c661e;_0x4b764f[_0x12321f][_0x168287(0x1ed)]=_0x1f6c2c;});const _0x134ef6=_0x4b764f['filter'](_0x41c241=>_0x41c241['to_quantity']!=='0'&&_0x41c241[_0x1c661e(0x22d)]!==''||_0x41c241[_0x1c661e(0x223)]!=='0'&&_0x41c241[_0x1c661e(0x223)]!=='');var _0x121a27=0x0;_0x134ef6[_0x1c661e(0x1c8)](_0x97e965=>{var _0x4e0bc1=_0x1c661e;parseInt(_0x97e965[_0x4e0bc1(0x165)])<parseInt(_0x97e965[_0x4e0bc1(0x22d)])&&_0x121a27++;});if(_0x121a27!=0x0)return _0x2c98c3[_0x1c661e(0x18f)](_0x1c661e(0x17c),_0x1c661e(0x174)),_0x4421f7[_0x1c661e(0x1a5)](_0x1c661e(0x158));const _0x552141=await warehouse[_0x1c661e(0x1ff)]({'name':_0x1f6740[_0x1c661e(0x16f)],'room':_0x1f6740[_0x1c661e(0x20b)]});_0x1f6740[_0x1c661e(0x1ba)][_0x1c661e(0x1c8)](_0x480c00=>{var _0x2f35e9=_0x1c661e;if(_0x480c00[_0x2f35e9(0x22d)]>0x0){const _0x250b7=_0x552141['product_details'][_0x2f35e9(0x229)](_0x5dc339=>{var _0x1f57e5=_0x2f35e9;_0x5dc339[_0x1f57e5(0x181)]==_0x480c00[_0x1f57e5(0x181)]&&_0x5dc339[_0x1f57e5(0x1c7)]==_0x480c00['from_floorlevel']&&_0x5dc339[_0x1f57e5(0x234)]==_0x480c00[_0x1f57e5(0x153)]&&_0x5dc339[_0x1f57e5(0x1f3)]==_0x480c00[_0x1f57e5(0x214)]&&_0x5dc339[_0x1f57e5(0x1ae)]==_0x480c00[_0x1f57e5(0x175)]&&_0x5dc339['rack']==_0x480c00[_0x1f57e5(0x1ed)]&&_0x5dc339[_0x1f57e5(0x1e2)]==_0x480c00[_0x1f57e5(0x232)]&&(_0x5dc339[_0x1f57e5(0x201)]=parseInt(_0x5dc339[_0x1f57e5(0x201)])+parseInt(_0x480c00[_0x1f57e5(0x22d)]));});}}),await _0x552141[_0x1c661e(0x16e)]();const _0x3f176b=await warehouse['findOne']({'name':_0x1f6740['to_warehouse'],'room':_0x1f6740[_0x1c661e(0x1e0)]});_0x1f6740[_0x1c661e(0x1ba)][_0x1c661e(0x1c8)](_0x2f2ecd=>{var _0x4023bc=_0x1c661e;if(_0x2f2ecd[_0x4023bc(0x22d)]>0x0){const _0x52c19b=_0x3f176b[_0x4023bc(0x157)][_0x4023bc(0x229)](_0x1e139a=>{var _0x1dff6d=_0x4023bc;_0x1e139a[_0x1dff6d(0x181)]==_0x2f2ecd[_0x1dff6d(0x181)]&&_0x1e139a[_0x1dff6d(0x1c7)]==_0x2f2ecd[_0x1dff6d(0x223)]&&_0x1e139a[_0x1dff6d(0x234)]==_0x2f2ecd[_0x1dff6d(0x1d3)]&&_0x1e139a[_0x1dff6d(0x1f3)]==_0x2f2ecd[_0x1dff6d(0x1c4)]&&_0x1e139a['bay']==_0x2f2ecd['to_bay']&&_0x1e139a['rack']==_0x2f2ecd[_0x1dff6d(0x18c)]&&_0x1e139a[_0x1dff6d(0x1e2)]==_0x2f2ecd[_0x1dff6d(0x1e2)]&&(_0x1e139a[_0x1dff6d(0x201)]=parseInt(_0x1e139a[_0x1dff6d(0x201)])-parseInt(_0x2f2ecd[_0x1dff6d(0x22d)]));});}}),await _0x3f176b[_0x1c661e(0x16e)](),_0x1f6740['date']=_0x59dcdb,_0x1f6740[_0x1c661e(0x16f)]=_0x1d791d,_0x1f6740[_0x1c661e(0x1d8)]=_0x24647c,_0x1f6740[_0x1c661e(0x1ba)]=_0x134ef6,_0x1f6740['note']=_0x5f4e9d,_0x1f6740[_0x1c661e(0x1fb)]=_0x1ff567;const _0x1e3661=await _0x1f6740[_0x1c661e(0x16e)]();console[_0x1c661e(0x215)](_0x1e3661);const _0x101b93=await warehouse[_0x1c661e(0x1ff)]({'name':_0x1d791d,'room':_0x25e1e8});_0x1e3661['product'][_0x1c661e(0x1c8)](_0x56b8bc=>{var _0x10a7cb=_0x1c661e;if(_0x56b8bc[_0x10a7cb(0x22d)]>0x0){const _0x2f5c52=_0x101b93['product_details'][_0x10a7cb(0x229)](_0x42cc95=>{var _0x910190=_0x10a7cb;_0x42cc95[_0x910190(0x181)]==_0x56b8bc['product_name']&&_0x42cc95['floorlevel']==_0x56b8bc[_0x910190(0x16d)]&&_0x42cc95[_0x910190(0x234)]==_0x56b8bc[_0x910190(0x153)]&&_0x42cc95['bin']==_0x56b8bc[_0x910190(0x214)]&&_0x42cc95['bay']==_0x56b8bc[_0x910190(0x175)]&&_0x42cc95[_0x910190(0x18c)]==_0x56b8bc[_0x910190(0x1ed)]&&_0x42cc95['storage']==_0x56b8bc[_0x910190(0x232)]&&(_0x42cc95[_0x910190(0x201)]=parseInt(_0x42cc95[_0x910190(0x201)])-parseInt(_0x56b8bc[_0x910190(0x22d)]));});}}),await _0x101b93[_0x1c661e(0x16e)]();const _0x52d083=await warehouse[_0x1c661e(0x1ff)]({'name':_0x24647c,'room':_0x3383ea});_0x1e3661[_0x1c661e(0x1ba)][_0x1c661e(0x1c8)](_0x51919a=>{var _0x9aa699=_0x1c661e;if(_0x51919a['to_quantity']>0x0){var _0x14ffb5=0x0;const _0x55e188=_0x52d083[_0x9aa699(0x157)][_0x9aa699(0x229)](_0x4c90cc=>{var _0x4f2bd3=_0x9aa699;_0x4c90cc[_0x4f2bd3(0x181)]==_0x51919a[_0x4f2bd3(0x181)]&&_0x4c90cc[_0x4f2bd3(0x1c7)]==_0x51919a['to_floorlevel']&&_0x4c90cc[_0x4f2bd3(0x234)]==_0x51919a['to_types']&&_0x4c90cc['bin']==_0x51919a[_0x4f2bd3(0x1c4)]&&_0x4c90cc[_0x4f2bd3(0x1ae)]==_0x51919a[_0x4f2bd3(0x189)]&&_0x4c90cc[_0x4f2bd3(0x18c)]==_0x51919a[_0x4f2bd3(0x18c)]&&_0x4c90cc[_0x4f2bd3(0x1e2)]==_0x51919a[_0x4f2bd3(0x1e2)]&&(_0x4c90cc[_0x4f2bd3(0x201)]=parseInt(_0x4c90cc['product_stock'])+parseInt(_0x51919a['to_quantity']),_0x14ffb5++);});_0x14ffb5=='0'&&(_0x52d083[_0x9aa699(0x157)]=_0x52d083[_0x9aa699(0x157)][_0x9aa699(0x1ce)]({'product_name':_0x51919a[_0x9aa699(0x181)],'product_stock':_0x51919a[_0x9aa699(0x22d)],'bay':_0x51919a[_0x9aa699(0x189)],'bin':_0x51919a[_0x9aa699(0x1c4)],'type':_0x51919a[_0x9aa699(0x1d3)],'floorlevel':_0x51919a[_0x9aa699(0x223)],'storage':_0x51919a[_0x9aa699(0x1e2)],'rack':_0x51919a[_0x9aa699(0x18c)],'product_code':_0x51919a[_0x9aa699(0x1bb)],'primary_code':_0x51919a[_0x9aa699(0x217)],'secondary_code':_0x51919a[_0x9aa699(0x202)],'maxProducts':_0x51919a[_0x9aa699(0x1f7)],'storage':_0x51919a[_0x9aa699(0x1e2)],'rack':_0x51919a['rack']}));}}),await _0x52d083[_0x1c661e(0x16e)](),_0x2c98c3[_0x1c661e(0x18f)](_0x1c661e(0x18b),'Transfer\x20Edit\x20Successfully'),_0x4421f7[_0x1c661e(0x1a5)](_0x1c661e(0x1d2));}catch(_0x33a81c){console[_0x1c661e(0x215)](_0x33a81c);}}),router[a0_0xaf309c(0x1fd)]('/barcode_scanner',async(_0x37b7d2,_0x7b1da4)=>{var _0x561788=a0_0xaf309c;const {FromWareHouse:_0x6e878e,FromRoom:_0xae8b35,ToWarehouse:_0xb1235e,ToRoom:_0x431126,primary_code:_0x4c381c,Roomslist:_0x115093}=_0x37b7d2[_0x561788(0x1a9)],_0x6310cd=_0x115093[_0x561788(0x20d)](','),_0x37a694=[];async function _0x43cbab(_0x158f5d){var _0x6baf81=_0x561788;const _0x276ecc=await warehouse[_0x6baf81(0x1df)]([{'$match':{'name':_0x6e878e,'room':_0x158f5d}},{'$unwind':_0x6baf81(0x19b)},{'$match':{'product_details.primary_code':_0x4c381c}},{'$group':{'_id':_0x6baf81(0x1d5),'name':{'$first':_0x6baf81(0x1da)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x6baf81(0x1eb)},'secondary_code':{'$first':_0x6baf81(0x23a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x6baf81(0x1dc)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x6baf81(0x237)},'unit':{'$first':_0x6baf81(0x155)},'secondary_unit':{'$first':_0x6baf81(0x1a7)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x6baf81(0x20a)},'expiry_date':{'$first':_0x6baf81(0x1e8)},'production_date':{'$first':_0x6baf81(0x1bf)},'batch_code':{'$first':_0x6baf81(0x1f0)},'maxPerUnit':{'$first':_0x6baf81(0x173)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':_0x6baf81(0x162)},'maxProducts':{'$first':'$product_details.maxProducts'},'invoice_product':{'$first':'$product_details.invoice'}}}]),_0x55012f=await warehouse[_0x6baf81(0x1df)]([{'$match':{'name':_0x6e878e,'room':_0x158f5d}},{'$unwind':_0x6baf81(0x19b)},{'$match':{'product_details.secondary_code':_0x4c381c}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x6baf81(0x1da)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x6baf81(0x1eb)},'secondary_code':{'$first':_0x6baf81(0x23a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x6baf81(0x1dc)},'isle':{'$first':_0x6baf81(0x1d1)},'type':{'$first':_0x6baf81(0x1e7)},'pallet':{'$first':_0x6baf81(0x237)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x6baf81(0x1a7)},'storage':{'$first':_0x6baf81(0x1d6)},'rack':{'$first':_0x6baf81(0x20a)},'expiry_date':{'$first':_0x6baf81(0x1e8)},'production_date':{'$first':_0x6baf81(0x1bf)},'batch_code':{'$first':_0x6baf81(0x1f0)},'maxPerUnit':{'$first':_0x6baf81(0x173)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x6baf81(0x162)},'maxProducts':{'$first':_0x6baf81(0x1a2)},'invoice_product':{'$first':_0x6baf81(0x15e)}}}]);if(_0x276ecc[_0x6baf81(0x1b6)]>0x0)_0x37a694['push'](_0x276ecc);else _0x55012f[_0x6baf81(0x1b6)]>0x0&&_0x37a694[_0x6baf81(0x1db)](_0x55012f);}const _0x527b52=_0x6310cd['map'](_0xab7001=>_0x43cbab(_0xab7001));await Promise[_0x561788(0x220)](_0x527b52),_0x7b1da4[_0x561788(0x239)](_0x37a694);}),router[a0_0xaf309c(0x1fd)](a0_0xaf309c(0x1f2),async(_0x239239,_0x41ed23)=>{var _0x56d81c=a0_0xaf309c;try{const {FromWareHouse:_0xbe0239,FromRoom:_0x524721,ToWarehouse:_0x5608fd,ToRoom:_0x48fd7e,secondary_code:_0x3d4bcc}=_0x239239[_0x56d81c(0x1a9)],_0x523280=await warehouse[_0x56d81c(0x1df)]([{'$match':{'name':_0xbe0239}},{'$unwind':_0x56d81c(0x19b)},{'$match':{'product_details.secondary_code':_0x3d4bcc}},{'$group':{'_id':_0x56d81c(0x1d5),'name':{'$first':_0x56d81c(0x1da)},'primary_code':{'$first':_0x56d81c(0x1eb)},'secondary_code':{'$first':_0x56d81c(0x23a)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x56d81c(0x210)},'warehouse':{'$first':_0x56d81c(0x185)},'level':{'$first':_0x56d81c(0x21d)},'isle':{'$first':_0x56d81c(0x206)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x56d81c(0x155)}}}]);_0x41ed23[_0x56d81c(0x163)](0xc8)['json'](_0x523280);}catch(_0x1a96b3){_0x41ed23[_0x56d81c(0x163)](0x194)[_0x56d81c(0x239)]({'message':_0x1a96b3[_0x56d81c(0x1b0)]});}}),router['post'](a0_0xaf309c(0x23c),async(_0x3cc234,_0x28a9ad)=>{var _0x48dc2e=a0_0xaf309c;try{const {FromWareHouse:_0x506f14,FromRoom:_0x14d2da,ToWarehouse:_0x1fb1d2,ToRoom:_0x11a914,product_code:_0x5d5842}=_0x3cc234[_0x48dc2e(0x1a9)],_0x5782e3=await warehouse[_0x48dc2e(0x1df)]([{'$match':{'name':_0x506f14}},{'$unwind':_0x48dc2e(0x19b)},{'$match':{'product_details.product_code':_0x5d5842}},{'$group':{'_id':_0x48dc2e(0x1d5),'name':{'$first':_0x48dc2e(0x1da)},'primary_code':{'$first':_0x48dc2e(0x1eb)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x48dc2e(0x1cf)},'instock':{'$first':_0x48dc2e(0x210)},'warehouse':{'$first':_0x48dc2e(0x185)},'level':{'$first':_0x48dc2e(0x21d)},'isle':{'$first':_0x48dc2e(0x206)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x48dc2e(0x1a2)},'unit':{'$first':'$product_details.unit'}}}]);_0x28a9ad[_0x48dc2e(0x163)](0xc8)[_0x48dc2e(0x239)](_0x5782e3);}catch(_0x1e2a0d){_0x28a9ad[_0x48dc2e(0x163)](0x194)['json']({'message':_0x1e2a0d[_0x48dc2e(0x1b0)]});}}),router[a0_0xaf309c(0x1fd)]('/CheckingWarehouse',async(_0x3b00ee,_0x1f0ae1)=>{var _0xea37c6=a0_0xaf309c;const {level:_0x2b2dc1,isle:_0x2a0cc2,pallet:_0x64299a,warehouses:_0x354ab9,room:_0x5e2af3}=_0x3b00ee[_0xea37c6(0x1a9)];try{const _0x54f0ff=await warehouse[_0xea37c6(0x1df)]([{'$match':{'name':_0x354ab9,'room':_0x5e2af3}},{'$unwind':_0xea37c6(0x19b)},{'$match':{'product_details.level':parseInt(_0x2b2dc1),'product_details.isle':_0x2a0cc2,'product_details.pallet':parseInt(_0x64299a)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xea37c6(0x210)},'level':{'$first':_0xea37c6(0x21d)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xea37c6(0x22f)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x1f0ae1[_0xea37c6(0x163)](0xc8)[_0xea37c6(0x239)](_0x54f0ff);}catch(_0x22e8fe){_0x1f0ae1[_0xea37c6(0x163)](0x194)['json']({'message':_0x22e8fe['message']});}}),module[a0_0xaf309c(0x1e5)]=router;