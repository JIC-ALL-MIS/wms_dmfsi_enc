var a0_0x2871f2=a0_0x4174;function a0_0x2216(){var _0x594980=['<div>','errors','$product','padStart','secondary_code','Product\x20Transfer\x20successfully','$product_details.batch_code','1415244dsVegY','</td>','Error\x20Occurs','to_floorlevel','to_bay','invoice','65996qwDazs','batch_code','$name','maxperunit','sendMail','edit_transfer_view','product_code3','random','rak','success','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.maxPerUnit','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$date','../models/all_models','Portuguese\x20(BR)','Return\x20Rooms','from_warehouse','Enabled','toString','from_invoice','from_prod_pallet','from_rack','To_invoice','forEach','product_stock','product_name','</thead>','status','/transfer/preview/','site_title','Raw\x20Materials','$product_details.product_code','from_bay','/upload/','max_per_unit','storage','True','$product_details.level','getMonth','../public/language/languages.json','to_bin','English\x20(US)','_id','params','$product_details.storage','body','Transfer\x20Finalize\x20Successfully','French','Transfer\x20Edit\x20Successfully','to_quantity','$_id','nodemailer','flash','language','prod_name','$product_details.secondary_unit','to_warehouse','primary_code','Email\x20sent\x20successfully','find','New_Qty_Converted','$product_details.bay','$product_details.bin','$product.to_room_name','/preview/:id','staff','then','MaxStocks_data2','updateOne','RoomAssigned','</table>','from_quantity','<h2>\x20','product_details','Arabic\x20(ae)','/barcode_scanner','log','$product_details.maxProducts','date','<hr\x20class=\x22my-3\x22>','Level','/view/:id','\x20Order\x20Date\x20:\x20','English','$product_details.expiry_date','$product_details.floorlevel','</tbody>','from_floorlevel','product','Enclosed','916830vuhWTR','save','redirect','</tr>','add_transfer','$product_details._id','Arabic','rack','$product_details.secondary_code','$product_details.type','getFullYear','json','$product_details.product_stock','split','product_code','Rack\x20D','expiry_date','production_date','1349595aLckHV','to_prod_level','all','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','bay','3KEkgDA','COLD\x20STORAGE','TRF-','Ambient','back','user','$room','Portuguese','to_types','Rack\x20C','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/CheckingWarehouse','Floor','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details','from_bin','aggregate','render','note','role','An\x20error\x20occurred.','../middleware/auth','/picking_list/PDF_transfer_rm/','type','warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Rack\x20E','to_prod_pallet','maxProducts','RMSEmail','message','from_room_name','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.rack','An\x20error\x20occurred\x20while\x20saving\x20data.','Rack\x20A','Hindi','to_room','from_storage','$product_details.isle','concat','</div>','German','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','</h5>','to_prod_qty','master','<tbody\x20style=\x22text-align:\x20center;\x22>','email','</head><body>','/view/add_transfer','map','Rack\x20B','createTransport','$invoice','Chinese','from_prod_isle','317023TfAiKD','push','Shelves','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','catch','Router','error','$product_details.product_name','<tr>','filter','Rack\x20F','from_prod_qty','6tyDlsS','prod_cat','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','from_room','\x20Order\x20Number\x20:\x20','Spanish','port','length','primary_unit','$product_details.production_date','/transfer/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','secondary_unit','<html><head><title></title>','$product_details.unit','from_types','floorlevel','password','findById','findOne','get','Logo.png','bin','finalize','from_prod_level','to_invoice','slice','string','to_prod_isle','<span\x20style=\x22float:\x20right;\x22>','post','166318fyhFAK','797992aEuZHt','</body></html>','image','unit','<h5>'];a0_0x2216=function(){return _0x594980;};return a0_0x2216();}(function(_0x20c803,_0x3888ce){var _0x7595ab=a0_0x4174,_0x411a3e=_0x20c803();while(!![]){try{var _0x3eae5b=parseInt(_0x7595ab(0x14f))/0x1+parseInt(_0x7595ab(0x13c))/0x2+parseInt(_0x7595ab(0x1c1))/0x3*(-parseInt(_0x7595ab(0x149))/0x4)+parseInt(_0x7595ab(0x1bc))/0x5+parseInt(_0x7595ab(0x208))/0x6*(-parseInt(_0x7595ab(0x1fc))/0x7)+parseInt(_0x7595ab(0x13d))/0x8+parseInt(_0x7595ab(0x1aa))/0x9;if(_0x3eae5b===_0x3888ce)break;else _0x411a3e['push'](_0x411a3e['shift']());}catch(_0x19f992){_0x411a3e['push'](_0x411a3e['shift']());}}}(a0_0x2216,0x36199));const express=require('express'),app=express(),router=express[a0_0x2871f2(0x201)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x2871f2(0x15d)),auth=require(a0_0x2871f2(0x1d6)),users=require(a0_0x2871f2(0x177)),nodemailer=require(a0_0x2871f2(0x183));function a0_0x4174(_0x51fcde,_0x141a27){var _0x221655=a0_0x2216();return a0_0x4174=function(_0x4174c8,_0x11b542){_0x4174c8=_0x4174c8-0x138;var _0x4a0aa2=_0x221655[_0x4174c8];return _0x4a0aa2;},a0_0x4174(_0x51fcde,_0x141a27);}router['get']('/view',auth,async(_0xdccb9f,_0x5b64b7)=>{var _0x4752f4=a0_0x2871f2;try{const {username:_0x550f70,email:_0x223ac0,role:_0x567bb3}=_0xdccb9f[_0x4752f4(0x1c6)],_0x1eb92b=_0xdccb9f[_0x4752f4(0x1c6)],_0x481fd0=await profile[_0x4752f4(0x21b)]({'email':_0x1eb92b[_0x4752f4(0x1f3)]}),_0x6b1a4=await master_shop[_0x4752f4(0x18b)]();console[_0x4752f4(0x19c)](_0x4752f4(0x1f1),_0x6b1a4);let _0x3f1047;if(_0x1eb92b[_0x4752f4(0x1d4)]==_0x4752f4(0x191)){const _0x40d6b0=await staff[_0x4752f4(0x21b)]({'email':_0x1eb92b[_0x4752f4(0x1f3)]});_0x3f1047=await transfers['find']({'from_warehouse':_0x40d6b0[_0x4752f4(0x1d9)]});}else _0x3f1047=await transfers['aggregate']([{'$unwind':_0x4752f4(0x144)},{'$group':{'_id':_0x4752f4(0x182),'invoice':{'$first':_0x4752f4(0x1f9)},'date':{'$first':_0x4752f4(0x15c)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x4752f4(0x18f)},'finalize':{'$first':_0x4752f4(0x1e1)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x6b1a4[0x0]['language']==_0x4752f4(0x179)){var _0x13fc01=users['English'];console[_0x4752f4(0x19c)](_0x13fc01);}else{if(_0x6b1a4[0x0]['language']==_0x4752f4(0x1e6))var _0x13fc01=users['Hindi'];else{if(_0x6b1a4[0x0]['language']==_0x4752f4(0x1ec))var _0x13fc01=users[_0x4752f4(0x1ec)];else{if(_0x6b1a4[0x0][_0x4752f4(0x185)]==_0x4752f4(0x20d))var _0x13fc01=users[_0x4752f4(0x20d)];else{if(_0x6b1a4[0x0]['language']=='French')var _0x13fc01=users[_0x4752f4(0x17f)];else{if(_0x6b1a4[0x0]['language']=='Portuguese\x20(BR)')var _0x13fc01=users[_0x4752f4(0x1c8)];else{if(_0x6b1a4[0x0][_0x4752f4(0x185)]=='Chinese')var _0x13fc01=users[_0x4752f4(0x1fa)];else{if(_0x6b1a4[0x0][_0x4752f4(0x185)]==_0x4752f4(0x19a))var _0x13fc01=users[_0x4752f4(0x1b0)];}}}}}}}_0x5b64b7['render']('transfer',{'success':_0xdccb9f[_0x4752f4(0x184)]('success'),'errors':_0xdccb9f[_0x4752f4(0x184)]('errors'),'role':_0x1eb92b,'profile':_0x481fd0,'master_shop':_0x6b1a4,'transfer':_0x3f1047,'language':_0x13fc01});}catch(_0x1a6256){console[_0x4752f4(0x19c)](_0x1a6256);}});async function getRandom8DigitNumber(){var _0x5e986d=a0_0x2871f2;const _0x138448=0x989680,_0x9d1a60=0x5f5e0ff,_0x58f4eb=Math['floor'](Math[_0x5e986d(0x156)]()*(_0x9d1a60-_0x138448+0x1))+_0x138448;var _0x39518d;const _0x291273=await transfers['findOne']({'invoice':'TRF-'+_0x58f4eb});return _0x291273&&_0x291273['length']>0x0?_0x39518d=_0x5e986d(0x1c3)+_0x58f4eb:_0x39518d='TRF-'+_0x58f4eb,_0x39518d;}router[a0_0x2871f2(0x21c)](a0_0x2871f2(0x1f5),auth,async(_0x3dbb04,_0x4fc1cc)=>{var _0x44bbad=a0_0x2871f2;try{const {username:_0xb55653,email:_0x55241f,role:_0x480287}=_0x3dbb04[_0x44bbad(0x1c6)],_0x3bec3d=_0x3dbb04['user'],_0x13e954=await profile['findOne']({'email':_0x3bec3d[_0x44bbad(0x1f3)]}),_0x764f98=await master_shop[_0x44bbad(0x18b)]();console[_0x44bbad(0x19c)](_0x44bbad(0x1f1),_0x764f98);let _0x4d5d40;if(_0x3bec3d[_0x44bbad(0x1d4)]==_0x44bbad(0x191)){const _0xd91a3b=await staff[_0x44bbad(0x21b)]({'email':_0x3bec3d[_0x44bbad(0x1f3)]});_0x4d5d40=await warehouse['aggregate']([{'$match':{'status':_0x44bbad(0x161),'name':_0xd91a3b[_0x44bbad(0x1d9)],'warehouse_category':_0x44bbad(0x16e)}},{'$group':{'_id':'$name','name':{'$first':_0x44bbad(0x151)}}}]);}else _0x4d5d40=await warehouse['aggregate']([{'$match':{'status':_0x44bbad(0x161),'warehouse_category':_0x44bbad(0x16e)}},{'$group':{'_id':_0x44bbad(0x151),'name':{'$first':_0x44bbad(0x151)}}}]);var _0xde859f=[_0x44bbad(0x1c4),_0x44bbad(0x1a9),_0x44bbad(0x15f)];const _0x1615e2=await transfers[_0x44bbad(0x18b)]({}),_0x580930=_0x1615e2['length']+0x1,_0x1048d9=_0x44bbad(0x1c3)+_0x580930[_0x44bbad(0x162)]()[_0x44bbad(0x145)](0x5,'0');if(_0x764f98[0x0][_0x44bbad(0x185)]==_0x44bbad(0x179)){var _0x3d3a2d=users[_0x44bbad(0x1a3)];console[_0x44bbad(0x19c)](_0x3d3a2d);}else{if(_0x764f98[0x0][_0x44bbad(0x185)]==_0x44bbad(0x1e6))var _0x3d3a2d=users[_0x44bbad(0x1e6)];else{if(_0x764f98[0x0]['language']==_0x44bbad(0x1ec))var _0x3d3a2d=users[_0x44bbad(0x1ec)];else{if(_0x764f98[0x0][_0x44bbad(0x185)]=='Spanish')var _0x3d3a2d=users[_0x44bbad(0x20d)];else{if(_0x764f98[0x0][_0x44bbad(0x185)]=='French')var _0x3d3a2d=users[_0x44bbad(0x17f)];else{if(_0x764f98[0x0][_0x44bbad(0x185)]=='Portuguese\x20(BR)')var _0x3d3a2d=users[_0x44bbad(0x1c8)];else{if(_0x764f98[0x0]['language']=='Chinese')var _0x3d3a2d=users['Chinese'];else{if(_0x764f98[0x0][_0x44bbad(0x185)]==_0x44bbad(0x19a))var _0x3d3a2d=users['Arabic'];}}}}}}}const _0x221545=getRandom8DigitNumber();_0x221545[_0x44bbad(0x192)](_0x562008=>{var _0x1890b7=_0x44bbad;_0x4fc1cc[_0x1890b7(0x1d2)](_0x1890b7(0x1ae),{'success':_0x3dbb04[_0x1890b7(0x184)](_0x1890b7(0x158)),'errors':_0x3dbb04[_0x1890b7(0x184)](_0x1890b7(0x143)),'role':_0x3bec3d,'profile':_0x13e954,'master_shop':_0x764f98,'warehouse':_0x4d5d40,'language':_0x3d3a2d,'rooms_data':_0xde859f,'invoice':_0x562008});})[_0x44bbad(0x200)](_0x10d9c2=>{var _0x56365b=_0x44bbad;_0x3dbb04[_0x56365b(0x184)](_0x56365b(0x143),_0x56365b(0x1ce)),_0x4fc1cc['redirect'](_0x56365b(0x212));});}catch(_0x5bbb18){console['log'](_0x5bbb18);}}),router['post'](a0_0x2871f2(0x1f5),auth,async(_0x451060,_0x24ddbb)=>{var _0x735c0=a0_0x2871f2;try{console['log'](_0x451060[_0x735c0(0x17d)]);const {date:_0x33c3e8,from_warehouse:_0x1087dd,FromRoom_name:_0x443338,to_warehouse:_0x525e11,ToRoom_name:_0xdfe4c3,prod_name:_0x52245d,from_prod_qty:_0x30965a,from_prod_level:_0x1f505a,from_prod_isle:_0x58b26e,from_prod_pallet:_0x462ab9,to_prod_qty:_0x1e5a87,to_prod_level:_0x2c0004,to_prod_isle:_0x36db0c,to_prod_pallet:_0x237149,primary_code:_0x46b07e,secondary_code:_0x36d4de,product_code3:_0x1ac08f,note:_0x206786,MaxStocks_data2:_0xe3355f,invoice:_0x4cb348,expiry_date:_0x29556d}=_0x451060[_0x735c0(0x17d)];if(typeof _0x52245d==_0x735c0(0x138))var _0x57b59a=[_0x451060[_0x735c0(0x17d)]['prod_name']],_0x253b5f=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x207)]],_0x2fe73e=[_0x451060['body'][_0x735c0(0x220)]],_0x4faf23=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x18c)]],_0x3fa1ef=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x1bd)]],_0x167e77=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x189)]],_0x5dffdb=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x146)]],_0x7dd903=[_0x451060['body']['product_code3']],_0x2df3db=[_0x451060['body'][_0x735c0(0x193)]],_0xd85b57=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x210)]],_0x2a1063=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x214)]],_0x59f8b5=[_0x451060['body'][_0x735c0(0x150)]],_0x20db9e=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x1ba)]],_0x30ac5d=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x172)]],_0x20436a=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x1bb)]],_0x539c3d=[_0x451060['body']['prod_cat']],_0x2f0002=[_0x451060['body'][_0x735c0(0x195)]],_0x1ff73c=[_0x451060[_0x735c0(0x17d)]['ToRoomAssigned']],_0xb48c50=[_0x451060['body'][_0x735c0(0x163)]],_0x5e6bd5=[_0x451060[_0x735c0(0x17d)][_0x735c0(0x221)]];else var _0x57b59a=[..._0x451060['body'][_0x735c0(0x186)]],_0x253b5f=[..._0x451060['body'][_0x735c0(0x207)]],_0x2fe73e=[..._0x451060[_0x735c0(0x17d)]['from_prod_level']],_0x4faf23=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x18c)]],_0x3fa1ef=[..._0x451060['body'][_0x735c0(0x1bd)]],_0x167e77=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x189)]],_0x5dffdb=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x146)]],_0x7dd903=[..._0x451060[_0x735c0(0x17d)]['product_code3']],_0x2df3db=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x193)]],_0xd85b57=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x210)]],_0x2a1063=[..._0x451060[_0x735c0(0x17d)]['secondary_unit']],_0x59f8b5=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x150)]],_0x20db9e=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x1ba)]],_0x30ac5d=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x172)]],_0x20436a=[..._0x451060[_0x735c0(0x17d)]['production_date']],_0x539c3d=[..._0x451060[_0x735c0(0x17d)]['prod_cat']],_0x2f0002=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x195)]],_0x1ff73c=[..._0x451060[_0x735c0(0x17d)]['ToRoomAssigned']],_0xb48c50=[..._0x451060[_0x735c0(0x17d)][_0x735c0(0x163)]],_0x5e6bd5=[..._0x451060['body']['to_invoice']];const _0x15f0c3=_0x57b59a[_0x735c0(0x1f6)](_0x5c9938=>{return _0x5c9938={'product_name':_0x5c9938};});_0x253b5f[_0x735c0(0x167)]((_0x13f208,_0x5e5452)=>{_0x15f0c3[_0x5e5452]['from_quantity']=_0x13f208;}),_0xb48c50['forEach']((_0x5e271d,_0x3e551e)=>{var _0xbd759f=_0x735c0;_0x15f0c3[_0x3e551e][_0xbd759f(0x163)]=_0x5e271d;}),_0x5e6bd5['forEach']((_0x307070,_0x1b415b)=>{var _0x42f487=_0x735c0;_0x15f0c3[_0x1b415b][_0x42f487(0x166)]=_0x307070;}),_0x2fe73e[_0x735c0(0x167)]((_0x273550,_0x55a3d0)=>{_0x2f0002['forEach']((_0xfc9dfe,_0x7bd2d1)=>{var _0x432b95=a0_0x4174;if(_0xfc9dfe=='Receiving\x20Area'&&_0x55a3d0==_0x7bd2d1){var _0x3a3cdb=_0x273550[_0x432b95(0x222)](0x3);_0x15f0c3[_0x55a3d0][_0x432b95(0x1e8)]=_0x273550[0x0],_0x15f0c3[_0x55a3d0][_0x432b95(0x165)]=_0x273550[0x1],_0x15f0c3[_0x55a3d0][_0x432b95(0x170)]=0x0,_0x15f0c3[_0x55a3d0]['from_bin']=0x0,_0x15f0c3[_0x55a3d0][_0x432b95(0x217)]=_0x432b95(0x1cd),_0x15f0c3[_0x55a3d0][_0x432b95(0x1a7)]=_0x3a3cdb;}else{if(_0xfc9dfe==_0x432b95(0x1fe)&&_0x55a3d0==_0x7bd2d1){var _0x3a3cdb=_0x273550['slice'](0x3);_0x15f0c3[_0x55a3d0][_0x432b95(0x1e8)]=_0x273550[0x0],_0x15f0c3[_0x55a3d0][_0x432b95(0x165)]=_0x273550[0x1],_0x15f0c3[_0x55a3d0][_0x432b95(0x170)]=0x0,_0x15f0c3[_0x55a3d0][_0x432b95(0x1d0)]=0x0,_0x15f0c3[_0x55a3d0]['from_types']=_0x432b95(0x1cd),_0x15f0c3[_0x55a3d0][_0x432b95(0x1a7)]=_0x273550[0x5];}else{if(_0x55a3d0==_0x7bd2d1){var _0x98fd5b;if(_0x273550[0x4]=='L')_0x98fd5b='Level';else _0x273550[0x4]=='F'&&(_0x98fd5b=_0x432b95(0x1cd));_0x15f0c3[_0x55a3d0][_0x432b95(0x1e8)]=_0x273550[0x0],_0x15f0c3[_0x55a3d0][_0x432b95(0x165)]=_0x273550[0x1],_0x15f0c3[_0x55a3d0][_0x432b95(0x170)]=_0x273550[0x2],_0x15f0c3[_0x55a3d0]['from_bin']=_0x273550[0x3],_0x15f0c3[_0x55a3d0][_0x432b95(0x217)]=_0x98fd5b,_0x15f0c3[_0x55a3d0]['from_floorlevel']=_0x273550[0x5];}}}});}),_0x4faf23[_0x735c0(0x167)]((_0x51637a,_0x1762d4)=>{var _0x460e3b=_0x735c0;_0x15f0c3[_0x1762d4][_0x460e3b(0x181)]=_0x51637a;}),_0x3fa1ef['forEach']((_0x5dcad7,_0x27fb28)=>{var _0x588a72=_0x735c0;_0x1ff73c[_0x588a72(0x167)]((_0x106400,_0x5d02c6)=>{var _0x2ba6bc=_0x588a72;if(_0x106400=='Receiving\x20Area'&&_0x27fb28==_0x5d02c6){var _0x330db9=_0x5dcad7[_0x2ba6bc(0x222)](0x3);_0x15f0c3[_0x27fb28][_0x2ba6bc(0x173)]=_0x5dcad7[0x0],_0x15f0c3[_0x27fb28][_0x2ba6bc(0x1b1)]=_0x5dcad7[0x1],_0x15f0c3[_0x27fb28]['to_bay']=0x0,_0x15f0c3[_0x27fb28][_0x2ba6bc(0x178)]=0x0,_0x15f0c3[_0x27fb28][_0x2ba6bc(0x1c9)]='Floor',_0x15f0c3[_0x27fb28][_0x2ba6bc(0x14c)]=_0x330db9;}else{if(_0x106400==_0x2ba6bc(0x1fe)&&_0x27fb28==_0x5d02c6){var _0x330db9=_0x5dcad7[_0x2ba6bc(0x222)](0x3);_0x15f0c3[_0x27fb28][_0x2ba6bc(0x173)]=_0x5dcad7[0x0],_0x15f0c3[_0x27fb28][_0x2ba6bc(0x1b1)]=_0x5dcad7[0x1],_0x15f0c3[_0x27fb28][_0x2ba6bc(0x14d)]=0x0,_0x15f0c3[_0x27fb28][_0x2ba6bc(0x178)]=0x0,_0x15f0c3[_0x27fb28]['to_types']=_0x2ba6bc(0x1cd),_0x15f0c3[_0x27fb28][_0x2ba6bc(0x14c)]=_0x5dcad7[0x5];}else{if(_0x27fb28==_0x5d02c6){var _0x4a3a9f;if(_0x5dcad7[0x4]=='L')_0x4a3a9f='Level';else _0x5dcad7[0x4]=='F'&&(_0x4a3a9f=_0x2ba6bc(0x1cd));_0x15f0c3[_0x27fb28][_0x2ba6bc(0x173)]=_0x5dcad7[0x0],_0x15f0c3[_0x27fb28][_0x2ba6bc(0x1b1)]=_0x5dcad7[0x1],_0x15f0c3[_0x27fb28]['to_bay']=_0x5dcad7[0x2],_0x15f0c3[_0x27fb28][_0x2ba6bc(0x178)]=_0x5dcad7[0x3],_0x15f0c3[_0x27fb28]['to_types']=_0x4a3a9f,_0x15f0c3[_0x27fb28][_0x2ba6bc(0x14c)]=_0x5dcad7[0x5];}}}});}),_0x167e77[_0x735c0(0x167)]((_0x2f95af,_0x47236e)=>{var _0x21c204=_0x735c0;_0x15f0c3[_0x47236e][_0x21c204(0x189)]=_0x2f95af;}),_0x5dffdb[_0x735c0(0x167)]((_0x17077c,_0x28637e)=>{var _0x4970ee=_0x735c0;_0x15f0c3[_0x28637e][_0x4970ee(0x146)]=_0x17077c;}),_0x7dd903[_0x735c0(0x167)]((_0x4ebe07,_0x5e2583)=>{var _0x190c9a=_0x735c0;_0x15f0c3[_0x5e2583][_0x190c9a(0x1b8)]=_0x4ebe07;}),_0x2df3db[_0x735c0(0x167)]((_0xd3b5cf,_0x244731)=>{var _0x21b6f6=_0x735c0;_0x15f0c3[_0x244731][_0x21b6f6(0x1dd)]=_0xd3b5cf;}),_0xd85b57[_0x735c0(0x167)]((_0x24aea1,_0x35a6b3)=>{var _0x228565=_0x735c0;_0x15f0c3[_0x35a6b3][_0x228565(0x140)]=_0x24aea1;}),_0x2a1063[_0x735c0(0x167)]((_0x4b8bb4,_0x51a572)=>{_0x15f0c3[_0x51a572]['secondary_unit']=_0x4b8bb4;}),_0x59f8b5[_0x735c0(0x167)]((_0x1c37b4,_0x4ec6df)=>{_0x15f0c3[_0x4ec6df]['batch_code']=_0x1c37b4;}),_0x20db9e['forEach']((_0x37e5d7,_0x1374d6)=>{var _0x216147=_0x735c0;_0x15f0c3[_0x1374d6][_0x216147(0x1ba)]=_0x37e5d7;}),_0x30ac5d[_0x735c0(0x167)]((_0x42eda3,_0x160c7e)=>{var _0x18974c=_0x735c0;_0x15f0c3[_0x160c7e][_0x18974c(0x152)]=_0x42eda3;}),_0x20436a[_0x735c0(0x167)]((_0x38408f,_0x302090)=>{var _0x44535f=_0x735c0;_0x15f0c3[_0x302090][_0x44535f(0x1bb)]=_0x38408f;}),_0x539c3d[_0x735c0(0x167)]((_0x72f1aa,_0x21a72a)=>{var _0x2e7fa6=_0x735c0;_0x15f0c3[_0x21a72a][_0x2e7fa6(0x209)]=_0x72f1aa;}),_0x2f0002['forEach']((_0x4162e8,_0xa1621)=>{var _0x817cf1=_0x735c0;_0x15f0c3[_0xa1621][_0x817cf1(0x1e0)]=_0x4162e8;}),_0x1ff73c[_0x735c0(0x167)]((_0x41f0a3,_0x3bb565)=>{_0x15f0c3[_0x3bb565]['to_room_name']=_0x41f0a3;});const _0xee9a55=_0x15f0c3[_0x735c0(0x205)](_0x6fa14b=>_0x6fa14b['to_quantity']!=='0'&&_0x6fa14b[_0x735c0(0x181)]!==''||_0x6fa14b[_0x735c0(0x14c)]!=='0'&&_0x6fa14b[_0x735c0(0x14c)]!==''),_0x4ba022=new transfers({'date':_0x33c3e8,'from_warehouse':_0x1087dd,'to_warehouse':_0x525e11,'product':_0xee9a55,'note':_0x206786,'invoice':_0x4cb348}),_0xa05c6=await _0x4ba022['save']();_0x451060[_0x735c0(0x184)](_0x735c0(0x158),_0x735c0(0x147)),_0x24ddbb[_0x735c0(0x1ac)](_0x735c0(0x16c)+_0xa05c6[_0x735c0(0x17a)]);}catch(_0x28eadf){console[_0x735c0(0x19c)](_0x28eadf),_0x24ddbb[_0x735c0(0x16b)](0xc8)['json']({'errorMessage':_0x28eadf[_0x735c0(0x1df)]});}}),router['get'](a0_0x2871f2(0x190),auth,async(_0x292949,_0x38dc51)=>{var _0x36e2f8=a0_0x2871f2;try{const {username:_0x5e96cf,email:_0x2d6c2d,role:_0x599578}=_0x292949[_0x36e2f8(0x1c6)],_0x49a5ba=_0x292949[_0x36e2f8(0x1c6)],_0x3d6366=await profile['findOne']({'email':_0x49a5ba[_0x36e2f8(0x1f3)]}),_0x2783b9=await master_shop[_0x36e2f8(0x18b)]();console['log'](_0x36e2f8(0x1f1),_0x2783b9);const _0x122abe=await transfers[_0x36e2f8(0x21a)](_0x292949[_0x36e2f8(0x17b)]['id']);let _0x41a36c=new Date(_0x122abe[_0x36e2f8(0x1ba)]),_0x38968c=('0'+_0x41a36c['getDate']())[_0x36e2f8(0x222)](-0x2),_0x3787f1=('0'+(_0x41a36c[_0x36e2f8(0x176)]()+0x1))['slice'](-0x2),_0x7d76cb=_0x41a36c[_0x36e2f8(0x1b4)](),_0x190b51=_0x7d76cb+'-'+_0x3787f1+'-'+_0x38968c,_0x4a8020;if(_0x49a5ba['role']==_0x36e2f8(0x191)){const _0x1fc2c3=await staff[_0x36e2f8(0x21b)]({'email':_0x49a5ba[_0x36e2f8(0x1f3)]});_0x4a8020=await warehouse[_0x36e2f8(0x18b)]({'status':'Enabled','name':_0x1fc2c3['warehouse'],'warehouse_category':_0x36e2f8(0x16e)});}else _0x4a8020=await warehouse[_0x36e2f8(0x18b)]({'status':_0x36e2f8(0x161),'warehouse_category':'Raw\x20Materials'});const _0x5636ce=await warehouse[_0x36e2f8(0x1d1)]([{'$match':{'name':_0x122abe['from_warehouse']}},{'$unwind':_0x36e2f8(0x1cf)},{'$group':{'_id':_0x36e2f8(0x1af),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x36e2f8(0x1b6)},'bay':{'$first':_0x36e2f8(0x18d)},'bin':{'$first':_0x36e2f8(0x18e)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x36e2f8(0x1a5)},'primary_code':{'$first':_0x36e2f8(0x1ed)},'secondary_code':{'$first':_0x36e2f8(0x1b2)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x36e2f8(0x211)},'room':{'$first':'$room'}}}]);if(_0x2783b9[0x0][_0x36e2f8(0x185)]==_0x36e2f8(0x179)){var _0x2b1f29=users[_0x36e2f8(0x1a3)];console[_0x36e2f8(0x19c)](_0x2b1f29);}else{if(_0x2783b9[0x0][_0x36e2f8(0x185)]==_0x36e2f8(0x1e6))var _0x2b1f29=users['Hindi'];else{if(_0x2783b9[0x0]['language']==_0x36e2f8(0x1ec))var _0x2b1f29=users['German'];else{if(_0x2783b9[0x0]['language']=='Spanish')var _0x2b1f29=users[_0x36e2f8(0x20d)];else{if(_0x2783b9[0x0][_0x36e2f8(0x185)]==_0x36e2f8(0x17f))var _0x2b1f29=users[_0x36e2f8(0x17f)];else{if(_0x2783b9[0x0][_0x36e2f8(0x185)]==_0x36e2f8(0x15e))var _0x2b1f29=users['Portuguese'];else{if(_0x2783b9[0x0][_0x36e2f8(0x185)]==_0x36e2f8(0x1fa))var _0x2b1f29=users['Chinese'];else{if(_0x2783b9[0x0][_0x36e2f8(0x185)]==_0x36e2f8(0x19a))var _0x2b1f29=users[_0x36e2f8(0x1b0)];}}}}}}}_0x38dc51['render'](_0x36e2f8(0x154),{'success':_0x292949['flash']('success'),'errors':_0x292949[_0x36e2f8(0x184)](_0x36e2f8(0x143)),'role':_0x49a5ba,'profile':_0x3d6366,'master_shop':_0x2783b9,'warehouse':_0x4a8020,'transfer':_0x122abe,'stock':_0x5636ce,'language':_0x2b1f29});}catch(_0x5ee2fc){console[_0x36e2f8(0x19c)](_0x5ee2fc);}}),router[a0_0x2871f2(0x13b)](a0_0x2871f2(0x190),auth,async(_0x112ba8,_0x8f612b)=>{var _0x79d3b1=a0_0x2871f2;try{const _0x3a33bc=_0x112ba8[_0x79d3b1(0x17b)]['id'],{from_warehouse:_0x5f2d39,FromRoom_name:_0x530c80,to_warehouse:_0x5c355a,ToRoom_name:_0x18b8d0}=_0x112ba8[_0x79d3b1(0x17d)],_0x478494=await transfers[_0x79d3b1(0x21a)]({'_id':_0x3a33bc}),_0x4a8ef6=_0x478494[_0x79d3b1(0x1a8)][_0x79d3b1(0x1f6)](async _0x4a53ea=>{var _0xa8f041=_0x79d3b1;if(_0x4a53ea[_0xa8f041(0x181)]>0x0){var _0x18184e=await warehouse['findOne']({'name':_0x478494['from_warehouse'],'room':_0x4a53ea[_0xa8f041(0x1e0)],'warehouse_category':'Raw\x20Materials'});const _0x3ce39b=_0x18184e[_0xa8f041(0x199)][_0xa8f041(0x1f6)](_0x4d188f=>{var _0x35ad2a=_0xa8f041;_0x4d188f[_0x35ad2a(0x169)]==_0x4a53ea[_0x35ad2a(0x169)]&&_0x4d188f['floorlevel']==_0x4a53ea[_0x35ad2a(0x1a7)]&&_0x4d188f[_0x35ad2a(0x1d8)]==_0x4a53ea[_0x35ad2a(0x217)]&&_0x4d188f[_0x35ad2a(0x21e)]==_0x4a53ea['from_bin']&&_0x4d188f[_0x35ad2a(0x1c0)]==_0x4a53ea[_0x35ad2a(0x170)]&&_0x4d188f['rack']==_0x4a53ea['from_rack']&&_0x4d188f['storage']==_0x4a53ea[_0x35ad2a(0x1e8)]&&_0x4d188f[_0x35ad2a(0x1ba)]==_0x4a53ea[_0x35ad2a(0x1ba)]&&_0x4d188f[_0x35ad2a(0x150)]==_0x4a53ea[_0x35ad2a(0x150)]&&_0x4d188f[_0x35ad2a(0x1bb)]==_0x4a53ea[_0x35ad2a(0x1bb)]&&_0x4d188f[_0x35ad2a(0x14e)]==_0x4a53ea[_0x35ad2a(0x163)]&&(_0x4d188f[_0x35ad2a(0x168)]=_0x4d188f['product_stock']-_0x4a53ea['to_quantity']);});}return _0x18184e;});Promise['all'](_0x4a8ef6)['then'](async _0x3857d2=>{var _0x4d8458=_0x79d3b1;try{for(const _0x18b291 of _0x3857d2){await _0x18b291[_0x4d8458(0x1ab)]();}try{const _0x2bd1eb=_0x478494[_0x4d8458(0x1a8)][_0x4d8458(0x1f6)](async _0x33bfb2=>{var _0x206cfb=_0x4d8458;if(_0x33bfb2[_0x206cfb(0x181)]>0x0){var _0x1d996b=await warehouse[_0x206cfb(0x21b)]({'name':_0x478494[_0x206cfb(0x188)],'room':_0x33bfb2['to_room_name'],'warehouse_category':_0x206cfb(0x16e)}),_0x581866=0x0;const _0x564d64=_0x1d996b[_0x206cfb(0x199)][_0x206cfb(0x1f6)](_0x27b34f=>{var _0x22b36d=_0x206cfb;_0x27b34f[_0x22b36d(0x169)]==_0x33bfb2['product_name']&&_0x27b34f[_0x22b36d(0x218)]==_0x33bfb2[_0x22b36d(0x14c)]&&_0x27b34f[_0x22b36d(0x1d8)]==_0x33bfb2['to_types']&&_0x27b34f['bin']==_0x33bfb2[_0x22b36d(0x178)]&&_0x27b34f['bay']==_0x33bfb2['to_bay']&&_0x27b34f['rack']==_0x33bfb2[_0x22b36d(0x1b1)]&&_0x27b34f[_0x22b36d(0x173)]==_0x33bfb2['storage']&&_0x27b34f[_0x22b36d(0x1ba)]==_0x33bfb2[_0x22b36d(0x1ba)]&&_0x27b34f[_0x22b36d(0x150)]==_0x33bfb2[_0x22b36d(0x150)]&&_0x27b34f[_0x22b36d(0x1bb)]==_0x33bfb2[_0x22b36d(0x1bb)]&&_0x27b34f[_0x22b36d(0x14e)]==_0x33bfb2[_0x22b36d(0x166)]&&(_0x27b34f[_0x22b36d(0x168)]=_0x27b34f[_0x22b36d(0x168)]+_0x33bfb2[_0x22b36d(0x181)],_0x581866++);});_0x581866=='0'&&(_0x1d996b[_0x206cfb(0x199)]=_0x1d996b['product_details'][_0x206cfb(0x1ea)]({'product_name':_0x33bfb2[_0x206cfb(0x169)],'product_stock':_0x33bfb2[_0x206cfb(0x181)],'bay':_0x33bfb2[_0x206cfb(0x14d)],'bin':_0x33bfb2[_0x206cfb(0x178)],'type':_0x33bfb2[_0x206cfb(0x1c9)],'floorlevel':_0x33bfb2['to_floorlevel'],'storage':_0x33bfb2[_0x206cfb(0x173)],'rack':_0x33bfb2['rack'],'product_code':_0x33bfb2['product_code'],'primary_code':_0x33bfb2['primary_code'],'secondary_code':_0x33bfb2[_0x206cfb(0x146)],'maxProducts':_0x33bfb2[_0x206cfb(0x1dd)],'storage':_0x33bfb2['storage'],'rack':_0x33bfb2['rack'],'expiry_date':_0x33bfb2[_0x206cfb(0x1ba)],'maxPerUnit':_0x33bfb2[_0x206cfb(0x152)],'batch_code':_0x33bfb2[_0x206cfb(0x150)],'production_date':_0x33bfb2[_0x206cfb(0x1bb)]}));}return _0x1d996b;});Promise[_0x4d8458(0x1be)](_0x2bd1eb)[_0x4d8458(0x192)](async _0x2ea043=>{var _0x20aadb=_0x4d8458;try{for(const _0x7de8cc of _0x2ea043){await warehouse[_0x20aadb(0x194)]({'_id':_0x7de8cc['_id']},{'$addToSet':{'product_details':{'$each':_0x7de8cc['product_details']}}});}_0x478494[_0x20aadb(0x21f)]=_0x20aadb(0x174);const _0x87a8ec=await _0x478494['save'](),_0x442b3c=await master_shop[_0x20aadb(0x18b)](),_0x24dc01=await email_settings[_0x20aadb(0x21b)](),_0x1239cf=await supervisor_settings[_0x20aadb(0x18b)]();var _0x24e472=_0x478494[_0x20aadb(0x1a8)],_0x116625='',_0x3d2e38;for(_0x3d2e38 in _0x24e472){_0x116625+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24e472[_0x3d2e38][_0x20aadb(0x169)]+_0x20aadb(0x14a)+_0x20aadb(0x1ff)+_0x24e472[_0x3d2e38][_0x20aadb(0x1b8)]+'</td>'+_0x20aadb(0x1ff)+_0x24e472[_0x3d2e38]['to_quantity']+_0x20aadb(0x14a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24e472[_0x3d2e38][_0x20aadb(0x140)]+_0x20aadb(0x14a)+_0x20aadb(0x1ff)+_0x24e472[_0x3d2e38][_0x20aadb(0x214)]+'</td>'+_0x20aadb(0x1ff)+_0x478494[_0x20aadb(0x188)]+_0x20aadb(0x14a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24e472[_0x3d2e38]['to_room_name']+_0x20aadb(0x14a)+_0x20aadb(0x1ff)+_0x24e472[_0x3d2e38][_0x20aadb(0x173)]+_0x24e472[_0x3d2e38][_0x20aadb(0x1b1)]+_0x24e472[_0x3d2e38][_0x20aadb(0x14d)]+_0x24e472[_0x3d2e38][_0x20aadb(0x178)]+_0x24e472[_0x3d2e38]['to_types'][0x0]+_0x24e472[_0x3d2e38][_0x20aadb(0x14c)]+_0x20aadb(0x14a),_0x20aadb(0x1ad);}let _0x573fd6=nodemailer[_0x20aadb(0x1f8)]({'host':_0x24dc01['host'],'port':Number(_0x24dc01[_0x20aadb(0x20e)]),'secure':![],'auth':{'user':_0x24dc01[_0x20aadb(0x1f3)],'pass':_0x24dc01[_0x20aadb(0x219)]}}),_0x117250={'from':_0x24dc01['email'],'to':_0x1239cf[0x0][_0x20aadb(0x1de)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x20aadb(0x21d),'path':__dirname+'/../public'+_0x20aadb(0x171)+_0x442b3c[0x0][_0x20aadb(0x13f)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x20aadb(0x215)+_0x20aadb(0x1f4)+_0x20aadb(0x142)+_0x20aadb(0x1cb)+_0x20aadb(0x142)+_0x20aadb(0x1bf)+_0x20aadb(0x1eb)+_0x20aadb(0x142)+_0x20aadb(0x198)+_0x442b3c[0x0]['site_title']+'\x20</h2>'+'</div>'+_0x20aadb(0x1eb)+_0x20aadb(0x19f)+_0x20aadb(0x142)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x20aadb(0x20c)+_0x478494[_0x20aadb(0x14e)]+'\x20'+_0x20aadb(0x13a)+_0x20aadb(0x1a2)+_0x478494[_0x20aadb(0x19e)]+'\x20'+'</span>'+_0x20aadb(0x1ef)+'</div>'+_0x20aadb(0x159)+_0x20aadb(0x20a)+_0x20aadb(0x204)+_0x20aadb(0x1e2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x20aadb(0x1da)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x20aadb(0x1ee)+_0x20aadb(0x213)+_0x20aadb(0x1ad)+_0x20aadb(0x16a)+_0x20aadb(0x1f2)+'\x20'+_0x116625+'\x20'+_0x20aadb(0x1a6)+_0x20aadb(0x196)+_0x20aadb(0x142)+'<strong>\x20Regards\x20</strong>'+_0x20aadb(0x141)+_0x442b3c[0x0][_0x20aadb(0x16d)]+_0x20aadb(0x1ef)+'</div>'+_0x20aadb(0x1eb)+_0x20aadb(0x13e)};_0x573fd6[_0x20aadb(0x153)](_0x117250,function(_0xf28c73,_0x144656){var _0xb6ee08=_0x20aadb;_0xf28c73?(console[_0xb6ee08(0x19c)](_0xf28c73),console[_0xb6ee08(0x19c)](_0xb6ee08(0x14b))):console[_0xb6ee08(0x19c)](_0xb6ee08(0x18a));}),_0x112ba8[_0x20aadb(0x184)](_0x20aadb(0x158),_0x20aadb(0x17e)),_0x8f612b[_0x20aadb(0x1ac)](_0x20aadb(0x1d7)+_0x87a8ec[_0x20aadb(0x17a)]);}catch(_0x3d5f29){console[_0x20aadb(0x202)](_0x3d5f29),_0x8f612b['status'](0x1f4)[_0x20aadb(0x1b5)]({'Perror':_0x20aadb(0x1e4),'message':_0x3d5f29['message']});}})['catch'](_0x509312=>{var _0x44736a=_0x4d8458;console[_0x44736a(0x202)](_0x509312),_0x8f612b['status'](0x1f4)[_0x44736a(0x1b5)]({'Perror':_0x44736a(0x1d5)});});}catch(_0x2c693c){_0x8f612b[_0x4d8458(0x1b5)](_0x2c693c);}}catch(_0x5d7f6e){console[_0x4d8458(0x202)](_0x5d7f6e),_0x8f612b[_0x4d8458(0x16b)](0x1f4)[_0x4d8458(0x1b5)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x5d7f6e[_0x4d8458(0x1df)]});}})[_0x79d3b1(0x200)](_0x22a5e8=>{var _0x9d519a=_0x79d3b1;console[_0x9d519a(0x202)](_0x22a5e8),_0x8f612b[_0x9d519a(0x16b)](0x1f4)[_0x9d519a(0x1b5)]({'Merror':_0x9d519a(0x1d5)});});}catch(_0x4ec2ac){console['log'](_0x4ec2ac);}});function BayBinSelected(_0x3f47c1,_0x69eb61){var _0x23af65=a0_0x2871f2,_0x5b49d5=[],_0x2735ab=[],_0x52a04c=[],_0x3d2230=[],_0x43ac3b=[],_0x1b416b=[];let _0x448266=[];if(_0x3f47c1=='DRY\x20STORAGE')switch(_0x69eb61){case _0x23af65(0x1e5):_0x5b49d5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x2735ab=[0x1,0x2],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=[_0x23af65(0x1a0),'Floor'],_0x43ac3b=['D'],_0x1b416b=['A'];break;case'Rack\x20B':_0x5b49d5=[0x6,0x5,0x4,0x3,0x2,0x1],_0x2735ab=[0x1,0x2],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=[_0x23af65(0x1a0),_0x23af65(0x1cd)],_0x43ac3b=['D'],_0x1b416b=['B'];break;case _0x23af65(0x1fe):_0x5b49d5=[0x0],_0x2735ab=[0x0],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=[_0x23af65(0x1cd)],_0x43ac3b=['D'],_0x1b416b=['S'];break;case'Receiving\x20Area':_0x5b49d5=[0x0],_0x2735ab=[0x0],_0x3d2230=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x52a04c=[_0x23af65(0x1cd)],_0x43ac3b=['D'],_0x1b416b=['R'];break;}else{if(_0x3f47c1==_0x23af65(0x1c2))switch(_0x69eb61){case _0x23af65(0x1e5):_0x5b49d5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x2735ab=['B','F'],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=[_0x23af65(0x1a0),_0x23af65(0x1cd)],_0x43ac3b=['C'],_0x1b416b=['A'];break;case _0x23af65(0x1f7):_0x5b49d5=[0x5,0x4,0x3,0x2,0x1],_0x2735ab=['F','B','S'],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=['Level',_0x23af65(0x1cd)],_0x43ac3b=['C'],_0x1b416b=['B'];break;case _0x23af65(0x1ca):_0x5b49d5=[0x1,0x2,0x3,0x4,0x5],_0x2735ab=['B','F','S'],_0x3d2230=[0x5,0x4,0x3,0x2,0x1],_0x52a04c=[_0x23af65(0x1a0),'Floor'],_0x43ac3b=['C'],_0x1b416b=['C'];break;case _0x23af65(0x1b9):_0x5b49d5=[0x5,0x4,0x3,0x2,0x1],_0x2735ab=['F','B','S'],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=[_0x23af65(0x1a0),_0x23af65(0x1cd)],_0x43ac3b=['C'],_0x1b416b=['D'];break;case _0x23af65(0x1db):_0x5b49d5=[0x4,0x3,0x2,0x1],_0x2735ab=[0x1,0x2],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=['Level','Floor'],_0x43ac3b=['C'],_0x1b416b=['E'];break;case _0x23af65(0x206):_0x5b49d5=[0x1,0x2,0x3],_0x2735ab=[0x1,0x2],_0x3d2230=[0x1,0x2,0x3,0x4,0x5],_0x52a04c=[_0x23af65(0x1a0)],_0x43ac3b=['C'],_0x1b416b=['F'];break;}}return{'levels':_0x5b49d5,'Isle':_0x2735ab,'rack':_0x3d2230,'type':_0x52a04c,'storage':_0x43ac3b,'rak':_0x1b416b};}router[a0_0x2871f2(0x21c)](a0_0x2871f2(0x1a1),auth,async(_0x490787,_0x1897d8)=>{var _0x115430=a0_0x2871f2;try{const {username:_0x1da3b0,email:_0x546d6f,role:_0x5532df}=_0x490787['user'],_0x389356=_0x490787['user'],_0x3809b4=await profile['findOne']({'email':_0x389356[_0x115430(0x1f3)]}),_0x4264a3=await master_shop[_0x115430(0x18b)](),_0x2bab3c=await transfers[_0x115430(0x21a)](_0x490787[_0x115430(0x17b)]['id']);let _0x25e212;if(_0x389356[_0x115430(0x1d4)]==_0x115430(0x191)){const _0x2f0616=await staff[_0x115430(0x21b)]({'email':_0x389356['email']});_0x25e212=await warehouse[_0x115430(0x1d1)]([{'$match':{'status':_0x115430(0x161),'name':_0x2f0616[_0x115430(0x1d9)],'warehouse_category':_0x115430(0x16e)}},{'$group':{'_id':_0x115430(0x151),'name':{'$first':'$name'}}}]);}else _0x25e212=await warehouse[_0x115430(0x1d1)]([{'$match':{'status':_0x115430(0x161),'warehouse_category':_0x115430(0x16e)}},{'$group':{'_id':_0x115430(0x151),'name':{'$first':_0x115430(0x151)}}}]);const _0x3d3fda=await warehouse[_0x115430(0x1d1)]([{'$match':{'name':_0x2bab3c['from_warehouse'],'warehouse_category':_0x115430(0x16e)}},{'$unwind':_0x115430(0x1cf)},{'$group':{'_id':_0x115430(0x1af),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x115430(0x1b6)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x115430(0x18e)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x115430(0x1a5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x115430(0x1b2)},'product_code':{'$first':_0x115430(0x16f)},'storage':{'$first':_0x115430(0x17c)},'rack':{'$first':_0x115430(0x1e3)},'expiry_date':{'$first':_0x115430(0x1a4)},'production_date':{'$first':_0x115430(0x211)},'room':{'$first':_0x115430(0x1c7)}}}]),_0x5bcbbb=await product[_0x115430(0x18b)]({}),_0x2a3c2a=BayBinSelected(_0x2bab3c['to_warehouse'],_0x2bab3c[_0x115430(0x1e7)]);if(_0x4264a3[0x0]['language']==_0x115430(0x179)){var _0x46fea6=users[_0x115430(0x1a3)];console[_0x115430(0x19c)](_0x46fea6);}else{if(_0x4264a3[0x0][_0x115430(0x185)]==_0x115430(0x1e6))var _0x46fea6=users[_0x115430(0x1e6)];else{if(_0x4264a3[0x0][_0x115430(0x185)]==_0x115430(0x1ec))var _0x46fea6=users[_0x115430(0x1ec)];else{if(_0x4264a3[0x0][_0x115430(0x185)]==_0x115430(0x20d))var _0x46fea6=users['Spanish'];else{if(_0x4264a3[0x0][_0x115430(0x185)]==_0x115430(0x17f))var _0x46fea6=users[_0x115430(0x17f)];else{if(_0x4264a3[0x0]['language']==_0x115430(0x15e))var _0x46fea6=users[_0x115430(0x1c8)];else{if(_0x4264a3[0x0][_0x115430(0x185)]==_0x115430(0x1fa))var _0x46fea6=users[_0x115430(0x1fa)];else{if(_0x4264a3[0x0][_0x115430(0x185)]==_0x115430(0x19a))var _0x46fea6=users[_0x115430(0x1b0)];}}}}}}}_0x1897d8[_0x115430(0x1d2)]('edit_transfer',{'success':_0x490787[_0x115430(0x184)](_0x115430(0x158)),'errors':_0x490787[_0x115430(0x184)](_0x115430(0x143)),'role':_0x389356,'profile':_0x3809b4,'master_shop':_0x4264a3,'warehouse':_0x25e212,'transfer':_0x2bab3c,'stock':_0x3d3fda,'unit':_0x5bcbbb,'language':_0x46fea6});}catch(_0x13f59b){console[_0x115430(0x19c)](_0x13f59b);}}),router[a0_0x2871f2(0x13b)](a0_0x2871f2(0x1a1),auth,async(_0x438ed3,_0x2468ac)=>{var _0x1b262f=a0_0x2871f2;try{const _0x3584ad=_0x438ed3[_0x1b262f(0x17b)]['id'],_0x2b1a72=await transfers['findById'](_0x3584ad);_0x2468ac['json'](_0x438ed3[_0x1b262f(0x17d)]);return;const {date:_0x286e22,from_warehouse:_0x3a46e0,FromRoom_name:_0x7535c,to_warehouse:_0x4453d1,ToRoom_name:_0x24450a,prod_name:_0x26b49e,from_prod_qty:_0x421e85,from_prod_level:_0x543bef,from_prod_isle:_0x221e72,from_prod_pallet:_0x287a1a,to_prod_qty:_0x54aee3,to_prod_level:_0x2c5394,to_prod_isle:_0x4f5604,to_prod_pallet:_0xabec21,primary_code:_0x2e4e61,secondary_code:_0x1a8313,product_code3:_0x8c5e8f,note:_0x1a3391,invoice:_0x2e013e,expiry_date:_0x506f72}=_0x438ed3['body'];if(typeof _0x26b49e==_0x1b262f(0x138))var _0x2e8753=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x186)]],_0x347588=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x207)]],_0x3b5270=[_0x438ed3[_0x1b262f(0x17d)]['from_prod_level']],_0x4d5f52=[_0x438ed3['body'][_0x1b262f(0x1fb)]],_0x1f01fa=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x164)]],_0x1d453b=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x217)]],_0x4ad54c=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1f0)]],_0x27597b=[_0x438ed3['body'][_0x1b262f(0x1bd)]],_0x19497e=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x139)]],_0x5df1ae=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1dc)]],_0x2b447e=[_0x438ed3['body'][_0x1b262f(0x1c9)]],_0x1e08ea=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x173)]],_0x5767c2=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x157)]],_0x3378ed=[_0x438ed3['body'][_0x1b262f(0x189)]],_0x836ae9=[_0x438ed3['body'][_0x1b262f(0x146)]],_0xd611be=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x155)]],_0x1a8603=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x193)]],_0x3a636e=[_0x438ed3['body']['unit']],_0x2b3419=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x214)]],_0x25370c=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x150)]],_0x4b17e6=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1ba)]],_0x4f08e=[_0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1e8)]],_0x432b16=[_0x438ed3[_0x1b262f(0x17d)]['from_rak']];else var _0x2e8753=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x186)]],_0x1e08ea=[..._0x438ed3[_0x1b262f(0x17d)]['storage']],_0x5767c2=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x157)]],_0x1d453b=[..._0x438ed3[_0x1b262f(0x17d)]['from_types']],_0x2b447e=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1c9)]],_0x347588=[..._0x438ed3['body'][_0x1b262f(0x207)]],_0x3b5270=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x220)]],_0x4d5f52=[..._0x438ed3['body'][_0x1b262f(0x1fb)]],_0x1f01fa=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x164)]],_0x4ad54c=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1f0)]],_0x27597b=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1bd)]],_0x19497e=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x139)]],_0x5df1ae=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1dc)]],_0x3378ed=[..._0x438ed3['body']['primary_code']],_0x836ae9=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x146)]],_0xd611be=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x155)]],_0x1a8603=[..._0x438ed3['body'][_0x1b262f(0x193)]],_0x3a636e=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x140)]],_0x2b3419=[..._0x438ed3[_0x1b262f(0x17d)]['secondary_unit']],_0x25370c=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x150)]],_0x4b17e6=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1ba)]],_0x4f08e=[..._0x438ed3[_0x1b262f(0x17d)][_0x1b262f(0x1e8)]],_0x432b16=[..._0x438ed3['body']['from_rak']];const _0x5c8862=_0x2e8753[_0x1b262f(0x1f6)](_0x59bee6=>{return _0x59bee6={'product_name':_0x59bee6};});_0x347588['forEach']((_0x4c0415,_0x822798)=>{var _0x5d541c=_0x1b262f;_0x5c8862[_0x822798][_0x5d541c(0x197)]=_0x4c0415;}),_0x3b5270[_0x1b262f(0x167)]((_0x57cd5e,_0x5bac2b)=>{var _0x40c562=_0x1b262f;_0x5c8862[_0x5bac2b][_0x40c562(0x170)]=_0x57cd5e;}),_0x4d5f52[_0x1b262f(0x167)]((_0x14f094,_0x51806a)=>{_0x5c8862[_0x51806a]['from_bin']=_0x14f094;}),_0x1f01fa['forEach']((_0x140996,_0x2f6180)=>{_0x5c8862[_0x2f6180]['from_floorlevel']=_0x140996;}),_0x4ad54c[_0x1b262f(0x167)]((_0x2b122a,_0x3ce8c0)=>{var _0x37e700=_0x1b262f;_0x5c8862[_0x3ce8c0][_0x37e700(0x181)]=_0x2b122a;}),_0x27597b['forEach']((_0x2cce60,_0x3e33e5)=>{_0x5c8862[_0x3e33e5]['to_bay']=_0x2cce60;}),_0x19497e[_0x1b262f(0x167)]((_0x44f66f,_0x1e8235)=>{var _0x16ac02=_0x1b262f;_0x5c8862[_0x1e8235][_0x16ac02(0x178)]=_0x44f66f;}),_0x5df1ae['forEach']((_0x36b524,_0x2eedca)=>{var _0x5e6461=_0x1b262f;_0x5c8862[_0x2eedca][_0x5e6461(0x14c)]=_0x36b524;}),_0x3378ed[_0x1b262f(0x167)]((_0x388a2f,_0x4c84fb)=>{var _0x26c753=_0x1b262f;_0x5c8862[_0x4c84fb][_0x26c753(0x189)]=_0x388a2f;}),_0x836ae9[_0x1b262f(0x167)]((_0x2b73b9,_0x30a236)=>{var _0x2f7efe=_0x1b262f;_0x5c8862[_0x30a236][_0x2f7efe(0x146)]=_0x2b73b9;}),_0xd611be[_0x1b262f(0x167)]((_0xf79e61,_0x57e9b4)=>{var _0x540672=_0x1b262f;_0x5c8862[_0x57e9b4][_0x540672(0x1b8)]=_0xf79e61;}),_0x1a8603[_0x1b262f(0x167)]((_0x338cc9,_0x23661f)=>{var _0x27c5e9=_0x1b262f;_0x5c8862[_0x23661f][_0x27c5e9(0x1dd)]=_0x338cc9;}),_0x3a636e[_0x1b262f(0x167)]((_0x5a0f5,_0x1a4310)=>{var _0x2050a8=_0x1b262f;_0x5c8862[_0x1a4310][_0x2050a8(0x140)]=_0x5a0f5;}),_0x2b3419[_0x1b262f(0x167)]((_0x1149f3,_0x543d1b)=>{var _0x3222c1=_0x1b262f;_0x5c8862[_0x543d1b][_0x3222c1(0x214)]=_0x1149f3;}),_0x25370c['forEach']((_0x199bd4,_0x1abc6e)=>{var _0x2f3ffc=_0x1b262f;_0x5c8862[_0x1abc6e][_0x2f3ffc(0x150)]=_0x199bd4;}),_0x4b17e6[_0x1b262f(0x167)]((_0x13730f,_0x5617e7)=>{var _0x30fa5f=_0x1b262f;_0x5c8862[_0x5617e7][_0x30fa5f(0x1ba)]=_0x13730f;}),_0x1e08ea[_0x1b262f(0x167)]((_0x1cefe8,_0x52b92c)=>{var _0x2c7727=_0x1b262f;_0x5c8862[_0x52b92c][_0x2c7727(0x173)]=_0x1cefe8;}),_0x5767c2[_0x1b262f(0x167)]((_0xd11e1d,_0x9e187a)=>{var _0x3df65a=_0x1b262f;_0x5c8862[_0x9e187a][_0x3df65a(0x1b1)]=_0xd11e1d;}),_0x1d453b[_0x1b262f(0x167)]((_0x5d2583,_0x17d711)=>{var _0x201278=_0x1b262f;_0x5c8862[_0x17d711][_0x201278(0x217)]=_0x5d2583;}),_0x2b447e['forEach']((_0x17374a,_0x552bd7)=>{_0x5c8862[_0x552bd7]['to_types']=_0x17374a;}),_0x4f08e['forEach']((_0x2449ca,_0x5adbf4)=>{var _0x39c6ab=_0x1b262f;_0x5c8862[_0x5adbf4][_0x39c6ab(0x1e8)]=_0x2449ca;}),_0x432b16[_0x1b262f(0x167)]((_0x18f3aa,_0x358dc4)=>{var _0x354290=_0x1b262f;_0x5c8862[_0x358dc4][_0x354290(0x165)]=_0x18f3aa;});const _0x4e3a3a=_0x5c8862[_0x1b262f(0x205)](_0x6e162d=>_0x6e162d[_0x1b262f(0x181)]!=='0'&&_0x6e162d[_0x1b262f(0x181)]!==''||_0x6e162d[_0x1b262f(0x14c)]!=='0'&&_0x6e162d[_0x1b262f(0x14c)]!=='');var _0x477f9c=0x0;_0x4e3a3a[_0x1b262f(0x167)](_0x3b49b1=>{var _0x41066=_0x1b262f;parseInt(_0x3b49b1[_0x41066(0x197)])<parseInt(_0x3b49b1['to_quantity'])&&_0x477f9c++;});if(_0x477f9c!=0x0)return _0x438ed3[_0x1b262f(0x184)]('errors',_0x1b262f(0x15b)),_0x2468ac[_0x1b262f(0x1ac)](_0x1b262f(0x1c5));const _0x5ebb5a=await warehouse[_0x1b262f(0x21b)]({'name':_0x2b1a72[_0x1b262f(0x160)],'room':_0x2b1a72[_0x1b262f(0x20b)]});_0x2b1a72[_0x1b262f(0x1a8)][_0x1b262f(0x167)](_0x3ee562=>{var _0x58afe0=_0x1b262f;if(_0x3ee562['to_quantity']>0x0){const _0x4901be=_0x5ebb5a[_0x58afe0(0x199)][_0x58afe0(0x1f6)](_0x3fb564=>{var _0x20c6ce=_0x58afe0;_0x3fb564[_0x20c6ce(0x169)]==_0x3ee562[_0x20c6ce(0x169)]&&_0x3fb564[_0x20c6ce(0x218)]==_0x3ee562[_0x20c6ce(0x1a7)]&&_0x3fb564[_0x20c6ce(0x1d8)]==_0x3ee562[_0x20c6ce(0x217)]&&_0x3fb564[_0x20c6ce(0x21e)]==_0x3ee562[_0x20c6ce(0x1d0)]&&_0x3fb564[_0x20c6ce(0x1c0)]==_0x3ee562[_0x20c6ce(0x170)]&&_0x3fb564['rack']==_0x3ee562['from_rack']&&_0x3fb564[_0x20c6ce(0x173)]==_0x3ee562[_0x20c6ce(0x1e8)]&&(_0x3fb564[_0x20c6ce(0x168)]=parseInt(_0x3fb564[_0x20c6ce(0x168)])+parseInt(_0x3ee562[_0x20c6ce(0x181)]));});}}),await _0x5ebb5a[_0x1b262f(0x1ab)]();const _0x4848d7=await warehouse['findOne']({'name':_0x2b1a72[_0x1b262f(0x188)],'room':_0x2b1a72[_0x1b262f(0x1e7)]});_0x2b1a72[_0x1b262f(0x1a8)][_0x1b262f(0x167)](_0x19be47=>{var _0x4a60b7=_0x1b262f;if(_0x19be47[_0x4a60b7(0x181)]>0x0){const _0x4ce92b=_0x4848d7[_0x4a60b7(0x199)][_0x4a60b7(0x1f6)](_0x37dcd0=>{var _0x57e2a9=_0x4a60b7;_0x37dcd0[_0x57e2a9(0x169)]==_0x19be47[_0x57e2a9(0x169)]&&_0x37dcd0['floorlevel']==_0x19be47['to_floorlevel']&&_0x37dcd0[_0x57e2a9(0x1d8)]==_0x19be47[_0x57e2a9(0x1c9)]&&_0x37dcd0[_0x57e2a9(0x21e)]==_0x19be47[_0x57e2a9(0x178)]&&_0x37dcd0['bay']==_0x19be47[_0x57e2a9(0x14d)]&&_0x37dcd0[_0x57e2a9(0x1b1)]==_0x19be47[_0x57e2a9(0x1b1)]&&_0x37dcd0[_0x57e2a9(0x173)]==_0x19be47[_0x57e2a9(0x173)]&&(_0x37dcd0[_0x57e2a9(0x168)]=parseInt(_0x37dcd0[_0x57e2a9(0x168)])-parseInt(_0x19be47[_0x57e2a9(0x181)]));});}}),await _0x4848d7[_0x1b262f(0x1ab)](),_0x2b1a72['date']=_0x286e22,_0x2b1a72[_0x1b262f(0x160)]=_0x3a46e0,_0x2b1a72[_0x1b262f(0x188)]=_0x4453d1,_0x2b1a72['product']=_0x4e3a3a,_0x2b1a72[_0x1b262f(0x1d3)]=_0x1a3391,_0x2b1a72[_0x1b262f(0x14e)]=_0x2e013e;const _0x3f870e=await _0x2b1a72[_0x1b262f(0x1ab)]();console[_0x1b262f(0x19c)](_0x3f870e);const _0x4b21cf=await warehouse[_0x1b262f(0x21b)]({'name':_0x3a46e0,'room':_0x7535c});_0x3f870e[_0x1b262f(0x1a8)]['forEach'](_0x53a818=>{var _0x41de08=_0x1b262f;if(_0x53a818[_0x41de08(0x181)]>0x0){const _0x39a427=_0x4b21cf['product_details']['map'](_0x4b1679=>{var _0x49849d=_0x41de08;_0x4b1679[_0x49849d(0x169)]==_0x53a818[_0x49849d(0x169)]&&_0x4b1679[_0x49849d(0x218)]==_0x53a818['from_floorlevel']&&_0x4b1679[_0x49849d(0x1d8)]==_0x53a818[_0x49849d(0x217)]&&_0x4b1679[_0x49849d(0x21e)]==_0x53a818[_0x49849d(0x1d0)]&&_0x4b1679[_0x49849d(0x1c0)]==_0x53a818['from_bay']&&_0x4b1679[_0x49849d(0x1b1)]==_0x53a818[_0x49849d(0x165)]&&_0x4b1679[_0x49849d(0x173)]==_0x53a818['from_storage']&&(_0x4b1679[_0x49849d(0x168)]=parseInt(_0x4b1679['product_stock'])-parseInt(_0x53a818[_0x49849d(0x181)]));});}}),await _0x4b21cf['save']();const _0x3cdadd=await warehouse[_0x1b262f(0x21b)]({'name':_0x4453d1,'room':_0x24450a});_0x3f870e['product'][_0x1b262f(0x167)](_0x454c48=>{var _0x506b94=_0x1b262f;if(_0x454c48[_0x506b94(0x181)]>0x0){var _0x48f865=0x0;const _0x2d4167=_0x3cdadd[_0x506b94(0x199)][_0x506b94(0x1f6)](_0x3e5e5e=>{var _0x14cb87=_0x506b94;_0x3e5e5e['product_name']==_0x454c48[_0x14cb87(0x169)]&&_0x3e5e5e[_0x14cb87(0x218)]==_0x454c48[_0x14cb87(0x14c)]&&_0x3e5e5e[_0x14cb87(0x1d8)]==_0x454c48[_0x14cb87(0x1c9)]&&_0x3e5e5e[_0x14cb87(0x21e)]==_0x454c48[_0x14cb87(0x178)]&&_0x3e5e5e[_0x14cb87(0x1c0)]==_0x454c48[_0x14cb87(0x14d)]&&_0x3e5e5e[_0x14cb87(0x1b1)]==_0x454c48[_0x14cb87(0x1b1)]&&_0x3e5e5e['storage']==_0x454c48[_0x14cb87(0x173)]&&(_0x3e5e5e[_0x14cb87(0x168)]=parseInt(_0x3e5e5e[_0x14cb87(0x168)])+parseInt(_0x454c48['to_quantity']),_0x48f865++);});_0x48f865=='0'&&(_0x3cdadd['product_details']=_0x3cdadd['product_details'][_0x506b94(0x1ea)]({'product_name':_0x454c48[_0x506b94(0x169)],'product_stock':_0x454c48['to_quantity'],'bay':_0x454c48[_0x506b94(0x14d)],'bin':_0x454c48['to_bin'],'type':_0x454c48[_0x506b94(0x1c9)],'floorlevel':_0x454c48[_0x506b94(0x14c)],'storage':_0x454c48['storage'],'rack':_0x454c48[_0x506b94(0x1b1)],'product_code':_0x454c48[_0x506b94(0x1b8)],'primary_code':_0x454c48[_0x506b94(0x189)],'secondary_code':_0x454c48[_0x506b94(0x146)],'maxProducts':_0x454c48[_0x506b94(0x1dd)],'storage':_0x454c48[_0x506b94(0x173)],'rack':_0x454c48[_0x506b94(0x1b1)]}));}}),await _0x3cdadd[_0x1b262f(0x1ab)](),_0x438ed3[_0x1b262f(0x184)]('success',_0x1b262f(0x180)),_0x2468ac[_0x1b262f(0x1ac)](_0x1b262f(0x212));}catch(_0x317693){console[_0x1b262f(0x19c)](_0x317693);}}),router[a0_0x2871f2(0x13b)](a0_0x2871f2(0x19b),async(_0x370578,_0x39b1bf)=>{var _0xa8c056=a0_0x2871f2;const {FromWareHouse:_0x58057c,FromRoom:_0x37236f,ToWarehouse:_0x26efe9,ToRoom:_0x19483c,primary_code:_0x2ab7a4,Roomslist:_0x56d4a0}=_0x370578[_0xa8c056(0x17d)],_0x2096ed=_0x56d4a0[_0xa8c056(0x1b7)](','),_0x10d3b7=[];async function _0xf19090(_0x4f6eca){var _0x4c504d=_0xa8c056;const _0x4ddad1=await warehouse['aggregate']([{'$match':{'name':_0x58057c,'room':_0x4f6eca}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2ab7a4}},{'$group':{'_id':_0x4c504d(0x1af),'name':{'$first':_0x4c504d(0x203)},'instock':{'$first':_0x4c504d(0x1b6)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4c504d(0x1b2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4c504d(0x18d)},'isle':{'$first':_0x4c504d(0x18e)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4c504d(0x1a5)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4c504d(0x187)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4c504d(0x1e3)},'expiry_date':{'$first':_0x4c504d(0x1a4)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4c504d(0x148)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x4c504d(0x19d)}}}]),_0x28e948=await warehouse[_0x4c504d(0x1d1)]([{'$match':{'name':_0x58057c,'room':_0x4f6eca}},{'$unwind':_0x4c504d(0x1cf)},{'$match':{'product_details.secondary_code':_0x2ab7a4}},{'$group':{'_id':_0x4c504d(0x1af),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x4c504d(0x1b6)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4c504d(0x1b2)},'product_code':{'$first':_0x4c504d(0x16f)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4c504d(0x18e)},'type':{'$first':_0x4c504d(0x1b3)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x4c504d(0x216)},'secondary_unit':{'$first':_0x4c504d(0x187)},'storage':{'$first':_0x4c504d(0x17c)},'rack':{'$first':_0x4c504d(0x1e3)},'expiry_date':{'$first':_0x4c504d(0x1a4)},'production_date':{'$first':_0x4c504d(0x211)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x4c504d(0x15a)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x4c504d(0x1c7)},'maxProducts':{'$first':_0x4c504d(0x19d)}}}]);if(_0x4ddad1[_0x4c504d(0x20f)]>0x0)_0x10d3b7[_0x4c504d(0x1fd)](_0x4ddad1);else _0x28e948['length']>0x0&&_0x10d3b7[_0x4c504d(0x1fd)](_0x28e948);}const _0x293186=_0x2096ed[_0xa8c056(0x1f6)](_0x29b259=>_0xf19090(_0x29b259));await Promise['all'](_0x293186),_0x39b1bf[_0xa8c056(0x1b5)](_0x10d3b7);}),router[a0_0x2871f2(0x13b)]('/barcode_scanner2',async(_0x2fd682,_0x988d03)=>{var _0xd9132d=a0_0x2871f2;try{const {FromWareHouse:_0x75b9c8,FromRoom:_0xb3fbdd,ToWarehouse:_0x15b10a,ToRoom:_0x3bc0e1,secondary_code:_0x904633}=_0x2fd682[_0xd9132d(0x17d)],_0x19356f=await warehouse[_0xd9132d(0x1d1)]([{'$match':{'name':_0x75b9c8}},{'$unwind':_0xd9132d(0x1cf)},{'$match':{'product_details.secondary_code':_0x904633}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xd9132d(0x203)},'primary_code':{'$first':_0xd9132d(0x1ed)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0xd9132d(0x1b6)},'warehouse':{'$first':_0xd9132d(0x151)},'level':{'$first':_0xd9132d(0x175)},'isle':{'$first':_0xd9132d(0x1e9)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0xd9132d(0x19d)},'unit':{'$first':_0xd9132d(0x216)}}}]);_0x988d03['status'](0xc8)[_0xd9132d(0x1b5)](_0x19356f);}catch(_0x2cca39){_0x988d03[_0xd9132d(0x16b)](0x194)[_0xd9132d(0x1b5)]({'message':_0x2cca39['message']});}}),router['post']('/barcode_scanner3',async(_0x38b7c2,_0x2dfb15)=>{var _0x155d16=a0_0x2871f2;try{const {FromWareHouse:_0x39027f,FromRoom:_0x4fba55,ToWarehouse:_0x329d71,ToRoom:_0x95491e,product_code:_0x19e3a8}=_0x38b7c2[_0x155d16(0x17d)],_0x42d580=await warehouse[_0x155d16(0x1d1)]([{'$match':{'name':_0x39027f}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x19e3a8}},{'$group':{'_id':_0x155d16(0x1af),'name':{'$first':_0x155d16(0x203)},'primary_code':{'$first':_0x155d16(0x1ed)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x155d16(0x16f)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x155d16(0x151)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x155d16(0x1e9)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x155d16(0x216)}}}]);_0x2dfb15[_0x155d16(0x16b)](0xc8)[_0x155d16(0x1b5)](_0x42d580);}catch(_0x4826dd){_0x2dfb15[_0x155d16(0x16b)](0x194)[_0x155d16(0x1b5)]({'message':_0x4826dd[_0x155d16(0x1df)]});}}),router['post'](a0_0x2871f2(0x1cc),async(_0x25ef92,_0x36d665)=>{var _0x2973d6=a0_0x2871f2;const {level:_0x4adf6a,isle:_0x56a3e2,pallet:_0x24e896,warehouses:_0x2b8546,room:_0x1b63a1}=_0x25ef92[_0x2973d6(0x17d)];try{const _0x119317=await warehouse['aggregate']([{'$match':{'name':_0x2b8546,'room':_0x1b63a1}},{'$unwind':_0x2973d6(0x1cf)},{'$match':{'product_details.level':parseInt(_0x4adf6a),'product_details.isle':_0x56a3e2,'product_details.pallet':parseInt(_0x24e896)}},{'$group':{'_id':_0x2973d6(0x1af),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2973d6(0x1b6)},'level':{'$first':_0x2973d6(0x175)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x36d665[_0x2973d6(0x16b)](0xc8)[_0x2973d6(0x1b5)](_0x119317);}catch(_0x4661ff){_0x36d665['status'](0x194)[_0x2973d6(0x1b5)]({'message':_0x4661ff[_0x2973d6(0x1df)]});}}),module['exports']=router;