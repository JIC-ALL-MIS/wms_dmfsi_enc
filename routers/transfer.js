var a0_0x1f4596=a0_0x4041;(function(_0x41f489,_0x4af951){var _0x183960=a0_0x4041,_0x3ad9d6=_0x41f489();while(!![]){try{var _0x15f9b1=parseInt(_0x183960(0x289))/0x1+parseInt(_0x183960(0x263))/0x2*(parseInt(_0x183960(0x29e))/0x3)+parseInt(_0x183960(0x26f))/0x4+parseInt(_0x183960(0x1f7))/0x5+-parseInt(_0x183960(0x27f))/0x6+parseInt(_0x183960(0x2c4))/0x7*(parseInt(_0x183960(0x204))/0x8)+-parseInt(_0x183960(0x2b3))/0x9;if(_0x15f9b1===_0x4af951)break;else _0x3ad9d6['push'](_0x3ad9d6['shift']());}catch(_0x2c391a){_0x3ad9d6['push'](_0x3ad9d6['shift']());}}}(a0_0x402b,0xdea61));const express=require(a0_0x1f4596(0x2bb)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,email_settings,supervisor_settings}=require(a0_0x1f4596(0x205)),auth=require('../middleware/auth'),users=require(a0_0x1f4596(0x207)),nodemailer=require(a0_0x1f4596(0x294));router[a0_0x1f4596(0x2bd)]('/view',auth,async(_0x580e13,_0x27c694)=>{var _0x52a1e9=a0_0x1f4596;try{const {username:_0x408284,email:_0xf12ff3,role:_0x197ea1}=_0x580e13[_0x52a1e9(0x258)],_0x2975fe=_0x580e13[_0x52a1e9(0x258)],_0x17878f=await profile[_0x52a1e9(0x1f1)]({'email':_0x2975fe[_0x52a1e9(0x22d)]}),_0x55231e=await master_shop['find']();console['log'](_0x52a1e9(0x285),_0x55231e);let _0x125ced;if(_0x2975fe[_0x52a1e9(0x24c)]=='staff'){const _0x434dca=await staff[_0x52a1e9(0x1f1)]({'email':_0x2975fe[_0x52a1e9(0x22d)]});_0x125ced=await transfers['find']({'from_warehouse':_0x434dca['warehouse']});}else _0x125ced=await transfers[_0x52a1e9(0x1fb)]([{'$unwind':_0x52a1e9(0x2d8)},{'$group':{'_id':_0x52a1e9(0x20d),'invoice':{'$first':_0x52a1e9(0x286)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x52a1e9(0x2bf)},'to_warehouse':{'$first':_0x52a1e9(0x2aa)},'from_room_name':{'$addToSet':_0x52a1e9(0x280)},'to_room_name':{'$addToSet':_0x52a1e9(0x2a0)},'finalize':{'$first':_0x52a1e9(0x25f)},'isAllowEdit':{'$first':_0x52a1e9(0x232)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x55231e[0x0][_0x52a1e9(0x1f4)]==_0x52a1e9(0x1f2)){var _0x1fb06e=users['English'];console['log'](_0x1fb06e);}else{if(_0x55231e[0x0][_0x52a1e9(0x1f4)]==_0x52a1e9(0x2ca))var _0x1fb06e=users[_0x52a1e9(0x2ca)];else{if(_0x55231e[0x0][_0x52a1e9(0x1f4)]==_0x52a1e9(0x20b))var _0x1fb06e=users[_0x52a1e9(0x20b)];else{if(_0x55231e[0x0][_0x52a1e9(0x1f4)]=='Spanish')var _0x1fb06e=users[_0x52a1e9(0x260)];else{if(_0x55231e[0x0]['language']==_0x52a1e9(0x24f))var _0x1fb06e=users[_0x52a1e9(0x24f)];else{if(_0x55231e[0x0]['language']==_0x52a1e9(0x23d))var _0x1fb06e=users[_0x52a1e9(0x25e)];else{if(_0x55231e[0x0][_0x52a1e9(0x1f4)]==_0x52a1e9(0x243))var _0x1fb06e=users[_0x52a1e9(0x243)];else{if(_0x55231e[0x0][_0x52a1e9(0x1f4)]=='Arabic\x20(ae)')var _0x1fb06e=users['Arabic'];}}}}}}}_0x27c694[_0x52a1e9(0x2b4)](_0x52a1e9(0x1ef),{'success':_0x580e13[_0x52a1e9(0x26d)](_0x52a1e9(0x2d6)),'errors':_0x580e13[_0x52a1e9(0x26d)](_0x52a1e9(0x254)),'role':_0x2975fe,'profile':_0x17878f,'master_shop':_0x55231e,'transfer':_0x125ced,'language':_0x1fb06e});}catch(_0x3dcbd2){console['log'](_0x3dcbd2);}});async function getRandom8DigitNumber(){var _0x475c31=a0_0x1f4596;const _0x324980=0x989680,_0x567ca1=0x5f5e0ff,_0x3a46b3=Math[_0x475c31(0x2c3)](Math['random']()*(_0x567ca1-_0x324980+0x1))+_0x324980;var _0xc74979;const _0x114fd2=await transfers['findOne']({'invoice':_0x475c31(0x299)+_0x3a46b3});return _0x114fd2&&_0x114fd2[_0x475c31(0x265)]>0x0?_0xc74979=_0x475c31(0x299)+_0x3a46b3:_0xc74979='TRF-'+_0x3a46b3,_0xc74979;}router[a0_0x1f4596(0x2bd)](a0_0x1f4596(0x2b2),auth,async(_0x2e5bd4,_0x491114)=>{var _0x2545c6=a0_0x1f4596;try{const {username:_0x4d1b1e,email:_0x4d6b04,role:_0x391c87}=_0x2e5bd4[_0x2545c6(0x258)],_0x363c8d=_0x2e5bd4['user'],_0x502aad=await profile[_0x2545c6(0x1f1)]({'email':_0x363c8d['email']}),_0x9ba2ae=await master_shop[_0x2545c6(0x2b7)]();console[_0x2545c6(0x281)](_0x2545c6(0x285),_0x9ba2ae);let _0x1866b5;if(_0x363c8d[_0x2545c6(0x24c)]==_0x2545c6(0x236)){const _0x148316=await staff['findOne']({'email':_0x363c8d['email']});_0x1866b5=await warehouse[_0x2545c6(0x1fb)]([{'$match':{'status':_0x2545c6(0x23a),'name':_0x148316['warehouse'],'warehouse_category':_0x2545c6(0x1fc)}},{'$group':{'_id':_0x2545c6(0x1f3),'name':{'$first':'$name'}}}]);}else _0x1866b5=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x2545c6(0x1fc)}},{'$group':{'_id':_0x2545c6(0x1f3),'name':{'$first':_0x2545c6(0x1f3)}}}]);var _0x531e26=[_0x2545c6(0x1fd),_0x2545c6(0x234),_0x2545c6(0x27a)];const _0x80fc5c=await transfers['find']({}),_0x5b185a=_0x80fc5c[_0x2545c6(0x265)]+0x1,_0x5109aa=_0x2545c6(0x299)+_0x5b185a['toString']()[_0x2545c6(0x279)](0x5,'0');if(_0x9ba2ae[0x0][_0x2545c6(0x1f4)]==_0x2545c6(0x1f2)){var _0x2dd38b=users[_0x2545c6(0x25d)];console[_0x2545c6(0x281)](_0x2dd38b);}else{if(_0x9ba2ae[0x0][_0x2545c6(0x1f4)]==_0x2545c6(0x2ca))var _0x2dd38b=users['Hindi'];else{if(_0x9ba2ae[0x0][_0x2545c6(0x1f4)]==_0x2545c6(0x20b))var _0x2dd38b=users[_0x2545c6(0x20b)];else{if(_0x9ba2ae[0x0][_0x2545c6(0x1f4)]=='Spanish')var _0x2dd38b=users['Spanish'];else{if(_0x9ba2ae[0x0]['language']==_0x2545c6(0x24f))var _0x2dd38b=users[_0x2545c6(0x24f)];else{if(_0x9ba2ae[0x0][_0x2545c6(0x1f4)]==_0x2545c6(0x23d))var _0x2dd38b=users[_0x2545c6(0x25e)];else{if(_0x9ba2ae[0x0]['language']==_0x2545c6(0x243))var _0x2dd38b=users['Chinese'];else{if(_0x9ba2ae[0x0][_0x2545c6(0x1f4)]==_0x2545c6(0x2bc))var _0x2dd38b=users[_0x2545c6(0x229)];}}}}}}}const _0x177d91=getRandom8DigitNumber();_0x177d91['then'](_0x517b8a=>{var _0x26ddeb=_0x2545c6;_0x491114[_0x26ddeb(0x2b4)](_0x26ddeb(0x25b),{'success':_0x2e5bd4[_0x26ddeb(0x26d)](_0x26ddeb(0x2d6)),'errors':_0x2e5bd4[_0x26ddeb(0x26d)](_0x26ddeb(0x254)),'role':_0x363c8d,'profile':_0x502aad,'master_shop':_0x9ba2ae,'warehouse':_0x1866b5,'language':_0x2dd38b,'rooms_data':_0x531e26,'invoice':_0x517b8a});})[_0x2545c6(0x1ed)](_0xbb2768=>{var _0x20eb27=_0x2545c6;_0x2e5bd4['flash']('errors',_0x20eb27(0x221)),_0x491114[_0x20eb27(0x28a)](_0x20eb27(0x26a));});}catch(_0x5597ab){console[_0x2545c6(0x281)](_0x5597ab);}}),router['post'](a0_0x1f4596(0x2b2),auth,async(_0x345759,_0x1568bc)=>{var _0x6fad32=a0_0x1f4596;try{console['log'](_0x345759[_0x6fad32(0x2be)]);const {date:_0x1d044b,from_warehouse:_0xb76f0b,FromRoom_name:_0x4a8768,to_warehouse:_0x38bbf3,ToRoom_name:_0x548098,prod_name:_0x24d9a2,from_prod_qty:_0x365ac2,from_prod_level:_0xfc1488,from_prod_isle:_0x73ad18,from_prod_pallet:_0x45ad5c,to_prod_qty:_0x139120,to_prod_level:_0x7e0c12,to_prod_isle:_0x17f54f,to_prod_pallet:_0x665c6f,primary_code:_0x37c81f,secondary_code:_0x4a36a3,product_code3:_0xb023c6,note:_0x340a88,MaxStocks_data2:_0x44ed18,invoice:_0x4c25d4,expiry_date:_0x12e46d}=_0x345759[_0x6fad32(0x2be)];if(typeof _0x24d9a2==_0x6fad32(0x2a1))var _0x38a111=[_0x345759[_0x6fad32(0x2be)]['prod_name']],_0x570fd6=[_0x345759[_0x6fad32(0x2be)]['from_prod_qty']],_0x21c708=[_0x345759[_0x6fad32(0x2be)]['from_prod_level']],_0x4b630b=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x233)]],_0x24fe4f=[_0x345759[_0x6fad32(0x2be)]['to_prod_level']],_0x3a8783=[_0x345759['body'][_0x6fad32(0x21f)]],_0x126efc=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x275)]],_0x3b0c75=[_0x345759[_0x6fad32(0x2be)]['product_code3']],_0x1909de=[_0x345759['body']['MaxStocks_data2']],_0x38fde0=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x287)]],_0x31b0b9=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x239)]],_0x54b2b5=[_0x345759[_0x6fad32(0x2be)]['batch_code']],_0x577e66=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x215)]],_0x48332e=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x208)]],_0x2c7553=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x22f)]],_0x52e968=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x248)]],_0x2da63f=[_0x345759['body'][_0x6fad32(0x2b5)]],_0x4707e9=[_0x345759[_0x6fad32(0x2be)]['ToRoomAssigned']],_0x18722c=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x29a)]],_0x232a41=[_0x345759[_0x6fad32(0x2be)][_0x6fad32(0x26b)]];else var _0x38a111=[..._0x345759['body']['prod_name']],_0x570fd6=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x2ae)]],_0x21c708=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x220)]],_0x4b630b=[..._0x345759['body'][_0x6fad32(0x233)]],_0x24fe4f=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x22b)]],_0x3a8783=[..._0x345759[_0x6fad32(0x2be)]['primary_code']],_0x126efc=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x275)]],_0x3b0c75=[..._0x345759['body'][_0x6fad32(0x2af)]],_0x1909de=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x1f0)]],_0x38fde0=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x287)]],_0x31b0b9=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x239)]],_0x54b2b5=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x203)]],_0x577e66=[..._0x345759['body'][_0x6fad32(0x215)]],_0x48332e=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x208)]],_0x2c7553=[..._0x345759[_0x6fad32(0x2be)]['production_date']],_0x52e968=[..._0x345759['body'][_0x6fad32(0x248)]],_0x2da63f=[..._0x345759['body'][_0x6fad32(0x2b5)]],_0x4707e9=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x29f)]],_0x18722c=[..._0x345759[_0x6fad32(0x2be)][_0x6fad32(0x29a)]],_0x232a41=[..._0x345759['body'][_0x6fad32(0x26b)]];const _0xa3a41a=_0x38a111[_0x6fad32(0x26e)](_0x5535de=>{return _0x5535de={'product_name':_0x5535de};});_0x570fd6[_0x6fad32(0x274)]((_0x593016,_0x3479ae)=>{var _0x50ccdb=_0x6fad32;_0xa3a41a[_0x3479ae][_0x50ccdb(0x271)]=_0x593016;}),_0x18722c[_0x6fad32(0x274)]((_0x3c1dd8,_0x3d3c09)=>{var _0x422d27=_0x6fad32;_0xa3a41a[_0x3d3c09][_0x422d27(0x29a)]=_0x3c1dd8;}),_0x232a41[_0x6fad32(0x274)]((_0x5d40bf,_0x33c41e)=>{var _0x5100fe=_0x6fad32;_0xa3a41a[_0x33c41e][_0x5100fe(0x206)]=_0x5d40bf;}),_0x21c708[_0x6fad32(0x274)]((_0x574c61,_0x112eab)=>{var _0x390d6c=_0x6fad32;_0x2da63f[_0x390d6c(0x274)]((_0x9f3e03,_0x163a7e)=>{var _0x4f0101=_0x390d6c;if(_0x9f3e03==_0x4f0101(0x277)&&_0x112eab==_0x163a7e){var _0x2ef942=_0x574c61[_0x4f0101(0x282)](0x3);_0xa3a41a[_0x112eab][_0x4f0101(0x2c1)]=_0x574c61[0x0],_0xa3a41a[_0x112eab][_0x4f0101(0x2d5)]=_0x574c61[0x1],_0xa3a41a[_0x112eab][_0x4f0101(0x257)]=0x0,_0xa3a41a[_0x112eab][_0x4f0101(0x288)]=0x0,_0xa3a41a[_0x112eab][_0x4f0101(0x253)]=_0x4f0101(0x211),_0xa3a41a[_0x112eab]['from_floorlevel']=_0x2ef942;}else{if(_0x9f3e03==_0x4f0101(0x2d0)&&_0x112eab==_0x163a7e){var _0x2ef942=_0x574c61[_0x4f0101(0x282)](0x3);_0xa3a41a[_0x112eab][_0x4f0101(0x2c1)]=_0x574c61[0x0],_0xa3a41a[_0x112eab]['from_rack']=_0x574c61[0x1],_0xa3a41a[_0x112eab]['from_bay']=0x0,_0xa3a41a[_0x112eab][_0x4f0101(0x288)]=0x0,_0xa3a41a[_0x112eab]['from_types']=_0x4f0101(0x211),_0xa3a41a[_0x112eab][_0x4f0101(0x255)]=_0x574c61[0x5];}else{if(_0x112eab==_0x163a7e){var _0x2f0f76;if(_0x574c61[0x4]=='L')_0x2f0f76='Level';else _0x574c61[0x4]=='F'&&(_0x2f0f76='Floor');_0xa3a41a[_0x112eab][_0x4f0101(0x2c1)]=_0x574c61[0x0],_0xa3a41a[_0x112eab]['from_rack']=_0x574c61[0x1],_0xa3a41a[_0x112eab][_0x4f0101(0x257)]=_0x574c61[0x2],_0xa3a41a[_0x112eab][_0x4f0101(0x288)]=_0x574c61[0x3],_0xa3a41a[_0x112eab][_0x4f0101(0x253)]=_0x2f0f76,_0xa3a41a[_0x112eab][_0x4f0101(0x255)]=_0x574c61[0x5];}}}});}),_0x4b630b[_0x6fad32(0x274)]((_0x2c7870,_0x18e2c4)=>{var _0x27ff71=_0x6fad32;_0xa3a41a[_0x18e2c4][_0x27ff71(0x249)]=_0x2c7870;}),_0x24fe4f[_0x6fad32(0x274)]((_0x3c1840,_0xd8e3c)=>{var _0x2631a0=_0x6fad32;_0x4707e9[_0x2631a0(0x274)]((_0x34a2ee,_0x2dd6bc)=>{var _0x31cc00=_0x2631a0;if(_0x34a2ee=='Receiving\x20Area'&&_0xd8e3c==_0x2dd6bc){var _0x35289f=_0x3c1840['slice'](0x3);_0xa3a41a[_0xd8e3c][_0x31cc00(0x27b)]=_0x3c1840[0x0],_0xa3a41a[_0xd8e3c][_0x31cc00(0x266)]=_0x3c1840[0x1],_0xa3a41a[_0xd8e3c]['to_bay']=0x0,_0xa3a41a[_0xd8e3c][_0x31cc00(0x1f8)]=0x0,_0xa3a41a[_0xd8e3c]['to_types']=_0x31cc00(0x211),_0xa3a41a[_0xd8e3c][_0x31cc00(0x219)]=_0x35289f;}else{if(_0x34a2ee==_0x31cc00(0x2d0)&&_0xd8e3c==_0x2dd6bc){var _0x35289f=_0x3c1840[_0x31cc00(0x282)](0x3);_0xa3a41a[_0xd8e3c]['storage']=_0x3c1840[0x0],_0xa3a41a[_0xd8e3c]['rack']=_0x3c1840[0x1],_0xa3a41a[_0xd8e3c]['to_bay']=0x0,_0xa3a41a[_0xd8e3c][_0x31cc00(0x1f8)]=0x0,_0xa3a41a[_0xd8e3c][_0x31cc00(0x272)]=_0x31cc00(0x211),_0xa3a41a[_0xd8e3c][_0x31cc00(0x219)]=_0x3c1840[0x5];}else{if(_0xd8e3c==_0x2dd6bc){var _0x15b001;if(_0x3c1840[0x4]=='L')_0x15b001=_0x31cc00(0x244);else _0x3c1840[0x4]=='F'&&(_0x15b001=_0x31cc00(0x211));_0xa3a41a[_0xd8e3c][_0x31cc00(0x27b)]=_0x3c1840[0x0],_0xa3a41a[_0xd8e3c][_0x31cc00(0x266)]=_0x3c1840[0x1],_0xa3a41a[_0xd8e3c][_0x31cc00(0x2b1)]=_0x3c1840[0x2],_0xa3a41a[_0xd8e3c][_0x31cc00(0x1f8)]=_0x3c1840[0x3],_0xa3a41a[_0xd8e3c][_0x31cc00(0x272)]=_0x15b001,_0xa3a41a[_0xd8e3c][_0x31cc00(0x219)]=_0x3c1840[0x5];}}}});}),_0x3a8783['forEach']((_0x37ca5e,_0x1df4d6)=>{var _0x42e902=_0x6fad32;_0xa3a41a[_0x1df4d6][_0x42e902(0x21f)]=_0x37ca5e;}),_0x126efc[_0x6fad32(0x274)]((_0x49f5cd,_0x37920e)=>{_0xa3a41a[_0x37920e]['secondary_code']=_0x49f5cd;}),_0x3b0c75[_0x6fad32(0x274)]((_0x3497b7,_0x33fd12)=>{var _0x464b3d=_0x6fad32;_0xa3a41a[_0x33fd12][_0x464b3d(0x25a)]=_0x3497b7;}),_0x1909de[_0x6fad32(0x274)]((_0x506675,_0x1a4144)=>{_0xa3a41a[_0x1a4144]['maxProducts']=_0x506675;}),_0x38fde0[_0x6fad32(0x274)]((_0x64bcad,_0x1b6980)=>{var _0x1e5a09=_0x6fad32;_0xa3a41a[_0x1b6980][_0x1e5a09(0x278)]=_0x64bcad;}),_0x31b0b9[_0x6fad32(0x274)]((_0x754494,_0x26d36c)=>{var _0x18c34a=_0x6fad32;_0xa3a41a[_0x26d36c][_0x18c34a(0x239)]=_0x754494;}),_0x54b2b5[_0x6fad32(0x274)]((_0xf333d8,_0x2f4361)=>{var _0x558da8=_0x6fad32;_0xa3a41a[_0x2f4361][_0x558da8(0x203)]=_0xf333d8;}),_0x577e66[_0x6fad32(0x274)]((_0x2bca71,_0x5c370a)=>{var _0x7541c9=_0x6fad32;_0xa3a41a[_0x5c370a][_0x7541c9(0x215)]=_0x2bca71;}),_0x48332e[_0x6fad32(0x274)]((_0x51b166,_0x27d58b)=>{var _0x428a4a=_0x6fad32;_0xa3a41a[_0x27d58b][_0x428a4a(0x2c5)]=_0x51b166;}),_0x2c7553[_0x6fad32(0x274)]((_0x2d4998,_0xe7299d)=>{_0xa3a41a[_0xe7299d]['production_date']=_0x2d4998;}),_0x52e968['forEach']((_0x3c02f6,_0x32e2be)=>{var _0x4ae2cc=_0x6fad32;_0xa3a41a[_0x32e2be][_0x4ae2cc(0x248)]=_0x3c02f6;}),_0x2da63f[_0x6fad32(0x274)]((_0x175119,_0x347d1f)=>{var _0x12000f=_0x6fad32;_0xa3a41a[_0x347d1f][_0x12000f(0x21b)]=_0x175119;}),_0x4707e9[_0x6fad32(0x274)]((_0xdb535c,_0x1692cd)=>{var _0x8902fb=_0x6fad32;_0xa3a41a[_0x1692cd][_0x8902fb(0x256)]=_0xdb535c;});const _0xdc1718=_0xa3a41a[_0x6fad32(0x23e)](_0x3c9d16=>_0x3c9d16[_0x6fad32(0x249)]!=='0'&&_0x3c9d16[_0x6fad32(0x249)]!==''||_0x3c9d16[_0x6fad32(0x219)]!=='0'&&_0x3c9d16[_0x6fad32(0x219)]!==''),_0x5840ea=new transfers({'date':_0x1d044b,'from_warehouse':_0xb76f0b,'to_warehouse':_0x38bbf3,'product':_0xdc1718,'note':_0x340a88,'invoice':_0x4c25d4}),_0x2b9f57=await _0x5840ea['save']();_0x345759[_0x6fad32(0x26d)]('success','Product\x20Transfer\x20successfully'),_0x1568bc['redirect']('/transfer/preview/'+_0x2b9f57[_0x6fad32(0x230)]);}catch(_0x1637be){console[_0x6fad32(0x281)](_0x1637be),_0x1568bc[_0x6fad32(0x2b8)](0xc8)['json']({'errorMessage':_0x1637be[_0x6fad32(0x2cb)]});}}),router[a0_0x1f4596(0x2bd)]('/preview/:id',auth,async(_0x56e3b3,_0x54d00d)=>{var _0x6b43e=a0_0x1f4596;try{const {username:_0x4550f4,email:_0x3a50cf,role:_0x2537a6}=_0x56e3b3[_0x6b43e(0x258)],_0x409041=_0x56e3b3[_0x6b43e(0x258)],_0x2cf3fb=await profile['findOne']({'email':_0x409041['email']}),_0x33e3dd=await master_shop[_0x6b43e(0x2b7)]();console[_0x6b43e(0x281)](_0x6b43e(0x285),_0x33e3dd);const _0x5c37b7=await transfers[_0x6b43e(0x2da)](_0x56e3b3[_0x6b43e(0x22c)]['id']);let _0x21d274=new Date(_0x5c37b7[_0x6b43e(0x215)]),_0x323a46=('0'+_0x21d274[_0x6b43e(0x214)]())['slice'](-0x2),_0x30b7fd=('0'+(_0x21d274[_0x6b43e(0x224)]()+0x1))[_0x6b43e(0x282)](-0x2),_0x4cc6d3=_0x21d274[_0x6b43e(0x26c)](),_0x39446b=_0x4cc6d3+'-'+_0x30b7fd+'-'+_0x323a46,_0x29b8b9;if(_0x409041['role']==_0x6b43e(0x236)){const _0x5704de=await staff[_0x6b43e(0x1f1)]({'email':_0x409041[_0x6b43e(0x22d)]});_0x29b8b9=await warehouse[_0x6b43e(0x2b7)]({'status':'Enabled','name':_0x5704de[_0x6b43e(0x216)],'warehouse_category':_0x6b43e(0x1fc)});}else _0x29b8b9=await warehouse[_0x6b43e(0x2b7)]({'status':'Enabled','warehouse_category':_0x6b43e(0x1fc)});const _0x333cbd=await warehouse[_0x6b43e(0x1fb)]([{'$match':{'name':_0x5c37b7['from_warehouse']}},{'$unwind':_0x6b43e(0x20a)},{'$group':{'_id':_0x6b43e(0x2c8),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x6b43e(0x226)},'bay':{'$first':_0x6b43e(0x1fa)},'bin':{'$first':_0x6b43e(0x259)},'type':{'$first':_0x6b43e(0x293)},'floorlevel':{'$first':_0x6b43e(0x2ab)},'primary_code':{'$first':_0x6b43e(0x200)},'secondary_code':{'$first':_0x6b43e(0x202)},'product_code':{'$first':_0x6b43e(0x1f6)},'storage':{'$first':_0x6b43e(0x2d3)},'rack':{'$first':_0x6b43e(0x2db)},'expiry_date':{'$first':_0x6b43e(0x20c)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x6b43e(0x27c)}}}]);if(_0x33e3dd[0x0]['language']==_0x6b43e(0x1f2)){var _0x4f35f3=users[_0x6b43e(0x25d)];console[_0x6b43e(0x281)](_0x4f35f3);}else{if(_0x33e3dd[0x0][_0x6b43e(0x1f4)]==_0x6b43e(0x2ca))var _0x4f35f3=users[_0x6b43e(0x2ca)];else{if(_0x33e3dd[0x0][_0x6b43e(0x1f4)]==_0x6b43e(0x20b))var _0x4f35f3=users['German'];else{if(_0x33e3dd[0x0][_0x6b43e(0x1f4)]==_0x6b43e(0x260))var _0x4f35f3=users['Spanish'];else{if(_0x33e3dd[0x0][_0x6b43e(0x1f4)]==_0x6b43e(0x24f))var _0x4f35f3=users[_0x6b43e(0x24f)];else{if(_0x33e3dd[0x0][_0x6b43e(0x1f4)]==_0x6b43e(0x23d))var _0x4f35f3=users[_0x6b43e(0x25e)];else{if(_0x33e3dd[0x0][_0x6b43e(0x1f4)]==_0x6b43e(0x243))var _0x4f35f3=users[_0x6b43e(0x243)];else{if(_0x33e3dd[0x0][_0x6b43e(0x1f4)]=='Arabic\x20(ae)')var _0x4f35f3=users['Arabic'];}}}}}}}_0x54d00d[_0x6b43e(0x2b4)](_0x6b43e(0x2a3),{'success':_0x56e3b3[_0x6b43e(0x26d)](_0x6b43e(0x2d6)),'errors':_0x56e3b3['flash'](_0x6b43e(0x254)),'role':_0x409041,'profile':_0x2cf3fb,'master_shop':_0x33e3dd,'warehouse':_0x29b8b9,'transfer':_0x5c37b7,'stock':_0x333cbd,'language':_0x4f35f3});}catch(_0x4c6d76){console[_0x6b43e(0x281)](_0x4c6d76);}}),router[a0_0x1f4596(0x223)]('/preview/:id',auth,async(_0x58b279,_0x5c5c7f)=>{var _0x1b7fb6=a0_0x1f4596;try{const _0x3829f8=_0x58b279[_0x1b7fb6(0x22c)]['id'],{from_warehouse:_0x56a6d7,FromRoom_name:_0x352e57,to_warehouse:_0x3df68f,ToRoom_name:_0x25cc0e}=_0x58b279[_0x1b7fb6(0x2be)],_0x1e9eb7=await transfers['findById']({'_id':_0x3829f8}),_0x411483=_0x1e9eb7['product']['map'](async _0x44209d=>{var _0x5a4946=_0x1b7fb6;if(_0x44209d[_0x5a4946(0x249)]>0x0){var _0x489130=await warehouse[_0x5a4946(0x1f1)]({'name':_0x1e9eb7[_0x5a4946(0x273)],'room':_0x44209d[_0x5a4946(0x21b)],'warehouse_category':_0x5a4946(0x1fc)});const _0x2d2d6f=_0x489130[_0x5a4946(0x251)][_0x5a4946(0x26e)](_0x1a063b=>{var _0x4cd40b=_0x5a4946;_0x1a063b[_0x4cd40b(0x296)]==_0x44209d[_0x4cd40b(0x296)]&&_0x1a063b[_0x4cd40b(0x2d4)]==_0x44209d[_0x4cd40b(0x255)]&&_0x1a063b[_0x4cd40b(0x29d)]==_0x44209d['from_types']&&_0x1a063b['bin']==_0x44209d[_0x4cd40b(0x288)]&&_0x1a063b['bay']==_0x44209d['from_bay']&&_0x1a063b[_0x4cd40b(0x266)]==_0x44209d[_0x4cd40b(0x2d5)]&&_0x1a063b[_0x4cd40b(0x27b)]==_0x44209d[_0x4cd40b(0x2c1)]&&_0x1a063b[_0x4cd40b(0x215)]==_0x44209d['expiry_date']&&_0x1a063b[_0x4cd40b(0x203)]==_0x44209d['batch_code']&&_0x1a063b[_0x4cd40b(0x22f)]==_0x44209d[_0x4cd40b(0x22f)]&&_0x1a063b[_0x4cd40b(0x1ee)]==_0x44209d[_0x4cd40b(0x29a)]&&(_0x1a063b[_0x4cd40b(0x2ad)]=_0x1a063b[_0x4cd40b(0x2ad)]-_0x44209d[_0x4cd40b(0x249)]);});}return _0x489130;});Promise['all'](_0x411483)[_0x1b7fb6(0x2cf)](async _0x41e4cc=>{var _0x4a8679=_0x1b7fb6;try{for(const _0x28b4da of _0x41e4cc){await _0x28b4da[_0x4a8679(0x23c)]();}try{const _0x315448=_0x1e9eb7[_0x4a8679(0x2d2)]['map'](async _0x924138=>{var _0xc026e5=_0x4a8679;if(_0x924138[_0xc026e5(0x249)]>0x0){var _0x4afa59=await warehouse['findOne']({'name':_0x1e9eb7[_0xc026e5(0x2ba)],'room':_0x924138[_0xc026e5(0x256)],'warehouse_category':_0xc026e5(0x1fc)}),_0x33899e=0x0;const _0xf0dc5a=_0x4afa59[_0xc026e5(0x251)][_0xc026e5(0x26e)](_0x344719=>{var _0x197f8b=_0xc026e5;_0x344719[_0x197f8b(0x296)]==_0x924138[_0x197f8b(0x296)]&&_0x344719[_0x197f8b(0x2d4)]==_0x924138[_0x197f8b(0x219)]&&_0x344719['type']==_0x924138['to_types']&&_0x344719['bin']==_0x924138[_0x197f8b(0x1f8)]&&_0x344719[_0x197f8b(0x2a7)]==_0x924138['to_bay']&&_0x344719[_0x197f8b(0x266)]==_0x924138[_0x197f8b(0x266)]&&_0x344719[_0x197f8b(0x27b)]==_0x924138[_0x197f8b(0x27b)]&&_0x344719[_0x197f8b(0x215)]==_0x924138[_0x197f8b(0x215)]&&_0x344719['batch_code']==_0x924138['batch_code']&&_0x344719[_0x197f8b(0x22f)]==_0x924138['production_date']&&_0x344719['invoice']==_0x924138[_0x197f8b(0x206)]&&(_0x344719[_0x197f8b(0x2ad)]=_0x344719[_0x197f8b(0x2ad)]+_0x924138[_0x197f8b(0x249)],_0x33899e++);});_0x33899e=='0'&&(_0x4afa59['product_details']=_0x4afa59[_0xc026e5(0x251)][_0xc026e5(0x231)]({'product_name':_0x924138['product_name'],'product_stock':_0x924138[_0xc026e5(0x249)],'bay':_0x924138['to_bay'],'bin':_0x924138[_0xc026e5(0x1f8)],'type':_0x924138['to_types'],'floorlevel':_0x924138[_0xc026e5(0x219)],'storage':_0x924138['storage'],'rack':_0x924138[_0xc026e5(0x266)],'product_code':_0x924138[_0xc026e5(0x25a)],'primary_code':_0x924138[_0xc026e5(0x21f)],'secondary_code':_0x924138[_0xc026e5(0x275)],'maxProducts':_0x924138[_0xc026e5(0x247)],'storage':_0x924138[_0xc026e5(0x27b)],'rack':_0x924138['rack'],'expiry_date':_0x924138[_0xc026e5(0x215)],'maxPerUnit':_0x924138[_0xc026e5(0x2c5)],'batch_code':_0x924138[_0xc026e5(0x203)],'production_date':_0x924138['production_date']}));}return _0x4afa59;});Promise[_0x4a8679(0x23f)](_0x315448)[_0x4a8679(0x2cf)](async _0x5586c0=>{var _0x2f4b99=_0x4a8679;try{for(const _0x1ccc8f of _0x5586c0){await warehouse[_0x2f4b99(0x210)]({'_id':_0x1ccc8f[_0x2f4b99(0x230)]},{'$addToSet':{'product_details':{'$each':_0x1ccc8f['product_details']}}});}_0x1e9eb7[_0x2f4b99(0x27d)]=_0x2f4b99(0x297);const _0x51b35b=await _0x1e9eb7[_0x2f4b99(0x23c)](),_0x253c91=await master_shop[_0x2f4b99(0x2b7)](),_0x48e270=await email_settings[_0x2f4b99(0x1f1)](),_0x2774fe=await supervisor_settings[_0x2f4b99(0x2b7)]();var _0x37b719=_0x1e9eb7['product'],_0x246466='',_0x53c1c2;for(_0x53c1c2 in _0x37b719){_0x246466+=_0x2f4b99(0x238)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x37b719[_0x53c1c2][_0x2f4b99(0x296)]+_0x2f4b99(0x21e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x37b719[_0x53c1c2][_0x2f4b99(0x25a)]+_0x2f4b99(0x21e)+_0x2f4b99(0x2c2)+_0x37b719[_0x53c1c2][_0x2f4b99(0x249)]+_0x2f4b99(0x21e)+_0x2f4b99(0x2c2)+_0x37b719[_0x53c1c2][_0x2f4b99(0x278)]+_0x2f4b99(0x21e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x37b719[_0x53c1c2][_0x2f4b99(0x239)]+_0x2f4b99(0x21e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1e9eb7[_0x2f4b99(0x2ba)]+_0x2f4b99(0x21e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x37b719[_0x53c1c2][_0x2f4b99(0x256)]+_0x2f4b99(0x21e)+_0x2f4b99(0x2c2)+_0x37b719[_0x53c1c2][_0x2f4b99(0x27b)]+_0x37b719[_0x53c1c2][_0x2f4b99(0x266)]+_0x37b719[_0x53c1c2]['to_bay']+_0x37b719[_0x53c1c2][_0x2f4b99(0x1f8)]+_0x37b719[_0x53c1c2][_0x2f4b99(0x272)][0x0]+_0x37b719[_0x53c1c2][_0x2f4b99(0x219)]+_0x2f4b99(0x21e),'</tr>';}let _0x21febd=nodemailer[_0x2f4b99(0x22e)]({'host':_0x48e270[_0x2f4b99(0x2c7)],'port':Number(_0x48e270[_0x2f4b99(0x2cc)]),'secure':![],'auth':{'user':_0x48e270[_0x2f4b99(0x22d)],'pass':_0x48e270[_0x2f4b99(0x29b)]}}),_0x38c418={'from':_0x48e270[_0x2f4b99(0x22d)],'to':_0x2774fe[0x0][_0x2f4b99(0x290)],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x2f4b99(0x217),'path':__dirname+_0x2f4b99(0x2c0)+_0x2f4b99(0x29c)+_0x253c91[0x0]['image'],'cid':_0x2f4b99(0x1ff)}],'html':_0x2f4b99(0x252)+_0x2f4b99(0x242)+_0x2f4b99(0x24a)+_0x2f4b99(0x2b9)+_0x2f4b99(0x24b)+_0x2f4b99(0x2b9)+_0x2f4b99(0x269)+_0x2f4b99(0x28f)+'<div>'+_0x2f4b99(0x241)+_0x253c91[0x0][_0x2f4b99(0x1f9)]+_0x2f4b99(0x21d)+_0x2f4b99(0x28f)+_0x2f4b99(0x28f)+_0x2f4b99(0x28e)+_0x2f4b99(0x2b9)+_0x2f4b99(0x298)+_0x2f4b99(0x264)+_0x1e9eb7[_0x2f4b99(0x1ee)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2f4b99(0x222)+_0x1e9eb7[_0x2f4b99(0x209)]+'\x20'+_0x2f4b99(0x1ec)+_0x2f4b99(0x2a6)+_0x2f4b99(0x28f)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2f4b99(0x268)+_0x2f4b99(0x238)+_0x2f4b99(0x2a9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x2f4b99(0x1eb)+_0x2f4b99(0x218)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x2f4b99(0x2ac)+_0x2f4b99(0x267)+_0x2f4b99(0x284)+_0x2f4b99(0x245)+_0x2f4b99(0x225)+_0x2f4b99(0x25c)+'\x20'+_0x246466+'\x20'+_0x2f4b99(0x2b0)+'</table>'+_0x2f4b99(0x2b9)+_0x2f4b99(0x28d)+'<h5>'+_0x253c91[0x0]['site_title']+'</h5>'+'</div>'+_0x2f4b99(0x28f)+_0x2f4b99(0x235)};_0x21febd['sendMail'](_0x38c418,function(_0x20b5a7,_0x3a5287){var _0x2bc4f7=_0x2f4b99;_0x20b5a7?(console[_0x2bc4f7(0x281)](_0x20b5a7),console[_0x2bc4f7(0x281)]('Error\x20Occurs')):console[_0x2bc4f7(0x281)](_0x2bc4f7(0x295));}),_0x58b279['flash'](_0x2f4b99(0x2d6),'Transfer\x20Finalize\x20Successfully'),_0x5c5c7f[_0x2f4b99(0x28a)]('/picking_list/PDF_transfer_rm/'+_0x51b35b['_id']);}catch(_0x1084c8){console[_0x2f4b99(0x270)](_0x1084c8),_0x5c5c7f[_0x2f4b99(0x2b8)](0x1f4)[_0x2f4b99(0x2d1)]({'Perror':_0x2f4b99(0x2a5),'message':_0x1084c8[_0x2f4b99(0x2cb)]});}})['catch'](_0x30d7b5=>{var _0x1342a3=_0x4a8679;console[_0x1342a3(0x270)](_0x30d7b5),_0x5c5c7f['status'](0x1f4)[_0x1342a3(0x2d1)]({'Perror':'An\x20error\x20occurred.'});});}catch(_0x424abb){_0x5c5c7f[_0x4a8679(0x2d1)](_0x424abb);}}catch(_0x55a15d){console['error'](_0x55a15d),_0x5c5c7f[_0x4a8679(0x2b8)](0x1f4)[_0x4a8679(0x2d1)]({'Merror':'An\x20error\x20occurred\x20while\x20saving\x20data.','Message':_0x55a15d[_0x4a8679(0x2cb)]});}})['catch'](_0x5a13cf=>{var _0x2cde99=_0x1b7fb6;console[_0x2cde99(0x270)](_0x5a13cf),_0x5c5c7f[_0x2cde99(0x2b8)](0x1f4)[_0x2cde99(0x2d1)]({'Merror':_0x2cde99(0x213)});});}catch(_0x49f491){console['log'](_0x49f491);}});function a0_0x402b(){var _0x5a635c=['to_room_name','from_bay','user','$product_details.bin','product_code','add_transfer','<tbody\x20style=\x22text-align:\x20center;\x22>','English','Portuguese','$finalize','Spanish','to_prod_isle','from_rak','6122ZHihOZ','\x20Order\x20Number\x20:\x20','length','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/transfer/view','to_invoice','getFullYear','flash','map','6033196iKNawQ','error','from_quantity','to_types','from_warehouse','forEach','secondary_code','to_room','Receiving\x20Area','unit','padStart','Return\x20Rooms','storage','$room','finalize','/barcode_scanner3','8379744jeGyjl','$product.from_room_name','log','slice','/barcode_scanner2','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','master','$invoice','primary_unit','from_bin','1126116ytClJn','redirect','Rack\x20A','$product_details.level','<strong>\x20Regards\x20</strong>','<hr\x20class=\x22my-3\x22>','</div>','RMSEmail','rak','Rack\x20B','$product_details.type','nodemailer','Email\x20sent\x20successfully','product_name','True','<h5\x20style=\x22text-align:\x20left;\x22>','TRF-','from_invoice','password','/upload/','type','729Qwaulg','ToRoomAssigned','$product.to_room_name','string','$product_details.product_name','edit_transfer_view','note','An\x20error\x20occurred\x20while\x20saving\x20data.','</h5>','bay','/CheckingWarehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$to_warehouse','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','product_stock','from_prod_qty','product_code3','</tbody>','to_bay','/view/add_transfer','34561836NiCngg','render','RoomAssigned','$product_details.isle','find','status','<div>','to_warehouse','express','Arabic\x20(ae)','get','body','$from_warehouse','/../public','from_storage','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','floor','14dvJQdt','maxperunit','$product_details.maxPerUnit','host','$product_details._id','from_prod_isle','Hindi','message','port','DRY\x20STORAGE','Rack\x20F','then','Shelves','json','product','$product_details.storage','floorlevel','from_rack','success','$product_details.production_date','$product','Transfer\x20Edit\x20Successfully','findById','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','</span>','catch','invoice','transfer','MaxStocks_data2','findOne','English\x20(US)','$name','language','/view/:id','$product_details.product_code','8860565LHbsFj','to_bin','site_title','$product_details.bay','aggregate','Raw\x20Materials','Ambient','split','logo','$product_details.primary_code','edit_transfer','$product_details.secondary_code','batch_code','3993784iaOSdM','../models/all_models','To_invoice','../public/language/languages.json','max_per_unit','date','$product_details','German','$product_details.expiry_date','$_id','from_room','to_prod_pallet','updateOne','Floor','bin','An\x20error\x20occurred.','getDate','expiry_date','warehouse','Logo.png','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','to_floorlevel','$product_details.batch_code','from_room_name','$product_details.pallet','\x20</h2>','</td>','primary_code','from_prod_level','There\x27s\x20a\x20error\x20in\x20this\x20transaction','\x20Order\x20Date\x20:\x20','post','getMonth','</thead>','$product_details.product_stock','$product_details.maxProducts','/barcode_scanner','Arabic','prod_name','to_prod_level','params','email','createTransport','production_date','_id','concat','$isAllowEdit','New_Qty_Converted','Enclosed','</body></html>','staff','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','<tr>','secondary_unit','Enabled','from_prod_pallet','save','Portuguese\x20(BR)','filter','all','Rack\x20E','<h2>\x20','<html><head><title></title>','Chinese','Level','</tr>','to_prod_qty','maxProducts','prod_cat','to_quantity','</head><body>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','role','back','$product_details.secondary_unit','French','$product_details.unit','product_details','<!DOCTYPE\x20html>','from_types','errors','from_floorlevel'];a0_0x402b=function(){return _0x5a635c;};return a0_0x402b();}function a0_0x4041(_0x21e0f6,_0x3748c8){var _0x402b9e=a0_0x402b();return a0_0x4041=function(_0x4041f3,_0x374029){_0x4041f3=_0x4041f3-0x1eb;var _0x4c9d85=_0x402b9e[_0x4041f3];return _0x4c9d85;},a0_0x4041(_0x21e0f6,_0x3748c8);}function BayBinSelected(_0x191c41,_0x1cc8f1){var _0x8b623d=a0_0x1f4596,_0xe89485=[],_0x9b4f4d=[],_0x454242=[],_0x600d27=[],_0x23199c=[],_0xb15433=[];let _0x345f24=[];if(_0x191c41==_0x8b623d(0x2cd))switch(_0x1cc8f1){case'Rack\x20A':_0xe89485=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x9b4f4d=[0x1,0x2],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=[_0x8b623d(0x244),_0x8b623d(0x211)],_0x23199c=['D'],_0xb15433=['A'];break;case _0x8b623d(0x292):_0xe89485=[0x6,0x5,0x4,0x3,0x2,0x1],_0x9b4f4d=[0x1,0x2],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=[_0x8b623d(0x244),_0x8b623d(0x211)],_0x23199c=['D'],_0xb15433=['B'];break;case'Shelves':_0xe89485=[0x0],_0x9b4f4d=[0x0],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=['Floor'],_0x23199c=['D'],_0xb15433=['S'];break;case'Receiving\x20Area':_0xe89485=[0x0],_0x9b4f4d=[0x0],_0x600d27=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x454242=[_0x8b623d(0x211)],_0x23199c=['D'],_0xb15433=['R'];break;}else{if(_0x191c41=='COLD\x20STORAGE')switch(_0x1cc8f1){case _0x8b623d(0x28b):_0xe89485=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x9b4f4d=['B','F'],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=[_0x8b623d(0x244),_0x8b623d(0x211)],_0x23199c=['C'],_0xb15433=['A'];break;case _0x8b623d(0x292):_0xe89485=[0x5,0x4,0x3,0x2,0x1],_0x9b4f4d=['F','B','S'],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=[_0x8b623d(0x244),_0x8b623d(0x211)],_0x23199c=['C'],_0xb15433=['B'];break;case'Rack\x20C':_0xe89485=[0x1,0x2,0x3,0x4,0x5],_0x9b4f4d=['B','F','S'],_0x600d27=[0x5,0x4,0x3,0x2,0x1],_0x454242=[_0x8b623d(0x244),'Floor'],_0x23199c=['C'],_0xb15433=['C'];break;case'Rack\x20D':_0xe89485=[0x5,0x4,0x3,0x2,0x1],_0x9b4f4d=['F','B','S'],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=[_0x8b623d(0x244),_0x8b623d(0x211)],_0x23199c=['C'],_0xb15433=['D'];break;case _0x8b623d(0x240):_0xe89485=[0x4,0x3,0x2,0x1],_0x9b4f4d=[0x1,0x2],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=[_0x8b623d(0x244),_0x8b623d(0x211)],_0x23199c=['C'],_0xb15433=['E'];break;case _0x8b623d(0x2ce):_0xe89485=[0x1,0x2,0x3],_0x9b4f4d=[0x1,0x2],_0x600d27=[0x1,0x2,0x3,0x4,0x5],_0x454242=[_0x8b623d(0x244)],_0x23199c=['C'],_0xb15433=['F'];break;}}return{'levels':_0xe89485,'Isle':_0x9b4f4d,'rack':_0x600d27,'type':_0x454242,'storage':_0x23199c,'rak':_0xb15433};}router[a0_0x1f4596(0x2bd)](a0_0x1f4596(0x1f5),auth,async(_0x5d9096,_0x5bffb4)=>{var _0x2b7c3a=a0_0x1f4596;try{const {username:_0x491a10,email:_0x244a2d,role:_0x335055}=_0x5d9096[_0x2b7c3a(0x258)],_0x2585fd=_0x5d9096[_0x2b7c3a(0x258)],_0x4b5f35=await profile[_0x2b7c3a(0x1f1)]({'email':_0x2585fd[_0x2b7c3a(0x22d)]}),_0x373f54=await master_shop[_0x2b7c3a(0x2b7)](),_0x2e6a69=await transfers[_0x2b7c3a(0x2da)](_0x5d9096[_0x2b7c3a(0x22c)]['id']);let _0x53fb15;if(_0x2585fd['role']==_0x2b7c3a(0x236)){const _0x1a1c25=await staff['findOne']({'email':_0x2585fd['email']});_0x53fb15=await warehouse[_0x2b7c3a(0x1fb)]([{'$match':{'status':_0x2b7c3a(0x23a),'name':_0x1a1c25['warehouse'],'warehouse_category':_0x2b7c3a(0x1fc)}},{'$group':{'_id':_0x2b7c3a(0x1f3),'name':{'$first':'$name'}}}]);}else _0x53fb15=await warehouse[_0x2b7c3a(0x1fb)]([{'$match':{'status':_0x2b7c3a(0x23a),'warehouse_category':_0x2b7c3a(0x1fc)}},{'$group':{'_id':_0x2b7c3a(0x1f3),'name':{'$first':'$name'}}}]);const _0x5032c4=await warehouse[_0x2b7c3a(0x1fb)]([{'$match':{'name':_0x2e6a69[_0x2b7c3a(0x273)],'warehouse_category':_0x2b7c3a(0x1fc)}},{'$unwind':_0x2b7c3a(0x20a)},{'$group':{'_id':_0x2b7c3a(0x2c8),'name':{'$first':_0x2b7c3a(0x2a2)},'product_stock':{'$first':_0x2b7c3a(0x226)},'bay':{'$first':_0x2b7c3a(0x1fa)},'bin':{'$first':_0x2b7c3a(0x259)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2b7c3a(0x202)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2b7c3a(0x2d3)},'rack':{'$first':_0x2b7c3a(0x2db)},'expiry_date':{'$first':_0x2b7c3a(0x20c)},'production_date':{'$first':_0x2b7c3a(0x2d7)},'room':{'$first':'$room'}}}]),_0x411244=await product['find']({}),_0x7ed945=BayBinSelected(_0x2e6a69[_0x2b7c3a(0x2ba)],_0x2e6a69[_0x2b7c3a(0x276)]);if(_0x373f54[0x0][_0x2b7c3a(0x1f4)]==_0x2b7c3a(0x1f2)){var _0x4cf208=users[_0x2b7c3a(0x25d)];console[_0x2b7c3a(0x281)](_0x4cf208);}else{if(_0x373f54[0x0]['language']=='Hindi')var _0x4cf208=users['Hindi'];else{if(_0x373f54[0x0]['language']==_0x2b7c3a(0x20b))var _0x4cf208=users[_0x2b7c3a(0x20b)];else{if(_0x373f54[0x0][_0x2b7c3a(0x1f4)]==_0x2b7c3a(0x260))var _0x4cf208=users[_0x2b7c3a(0x260)];else{if(_0x373f54[0x0]['language']=='French')var _0x4cf208=users[_0x2b7c3a(0x24f)];else{if(_0x373f54[0x0][_0x2b7c3a(0x1f4)]==_0x2b7c3a(0x23d))var _0x4cf208=users[_0x2b7c3a(0x25e)];else{if(_0x373f54[0x0][_0x2b7c3a(0x1f4)]==_0x2b7c3a(0x243))var _0x4cf208=users[_0x2b7c3a(0x243)];else{if(_0x373f54[0x0][_0x2b7c3a(0x1f4)]==_0x2b7c3a(0x2bc))var _0x4cf208=users['Arabic'];}}}}}}}_0x5bffb4[_0x2b7c3a(0x2b4)](_0x2b7c3a(0x201),{'success':_0x5d9096[_0x2b7c3a(0x26d)](_0x2b7c3a(0x2d6)),'errors':_0x5d9096[_0x2b7c3a(0x26d)](_0x2b7c3a(0x254)),'role':_0x2585fd,'profile':_0x4b5f35,'master_shop':_0x373f54,'warehouse':_0x53fb15,'transfer':_0x2e6a69,'stock':_0x5032c4,'unit':_0x411244,'language':_0x4cf208});}catch(_0x43e3dc){console[_0x2b7c3a(0x281)](_0x43e3dc);}}),router[a0_0x1f4596(0x223)]('/view/:id',auth,async(_0x409a10,_0x5c25f5)=>{var _0x6d7add=a0_0x1f4596;try{const _0x5eddbf=_0x409a10['params']['id'],_0xd31f09=await transfers['findById'](_0x5eddbf);_0x5c25f5[_0x6d7add(0x2d1)](_0x409a10[_0x6d7add(0x2be)]);return;const {date:_0x350ba8,from_warehouse:_0x48a205,FromRoom_name:_0x1f60ef,to_warehouse:_0x5d0540,ToRoom_name:_0x103a81,prod_name:_0x4544bc,from_prod_qty:_0x453689,from_prod_level:_0x112a26,from_prod_isle:_0x383908,from_prod_pallet:_0x494c68,to_prod_qty:_0x3728d0,to_prod_level:_0x42ac11,to_prod_isle:_0x21200e,to_prod_pallet:_0x2c9939,primary_code:_0x31b028,secondary_code:_0x1a4403,product_code3:_0x1bde8a,note:_0x5789d6,invoice:_0x38a7db,expiry_date:_0x5bf13b}=_0x409a10[_0x6d7add(0x2be)];if(typeof _0x4544bc==_0x6d7add(0x2a1))var _0x323e12=[_0x409a10['body'][_0x6d7add(0x22a)]],_0x4ab2e1=[_0x409a10['body'][_0x6d7add(0x2ae)]],_0x9f07bd=[_0x409a10['body'][_0x6d7add(0x220)]],_0xb4323c=[_0x409a10['body']['from_prod_isle']],_0x3077b3=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x23b)]],_0xd0eaf=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x253)]],_0x147e6b=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x246)]],_0x4e6130=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x22b)]],_0x5aa8ff=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x261)]],_0x5b3773=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x20f)]],_0x1327f8=[_0x409a10[_0x6d7add(0x2be)]['to_types']],_0x3bdd31=[_0x409a10['body'][_0x6d7add(0x27b)]],_0x41ed70=[_0x409a10['body'][_0x6d7add(0x291)]],_0x2811d1=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x21f)]],_0x55bf41=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x275)]],_0x5a6313=[_0x409a10[_0x6d7add(0x2be)]['product_code3']],_0x3f28bd=[_0x409a10['body'][_0x6d7add(0x1f0)]],_0xbb37cc=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x278)]],_0x44d342=[_0x409a10['body']['secondary_unit']],_0x152d0e=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x203)]],_0x2dfbdf=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x215)]],_0x20b40b=[_0x409a10['body'][_0x6d7add(0x2c1)]],_0x2b34a0=[_0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x262)]];else var _0x323e12=[..._0x409a10['body'][_0x6d7add(0x22a)]],_0x3bdd31=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x27b)]],_0x41ed70=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x291)]],_0xd0eaf=[..._0x409a10[_0x6d7add(0x2be)]['from_types']],_0x1327f8=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x272)]],_0x4ab2e1=[..._0x409a10['body'][_0x6d7add(0x2ae)]],_0x9f07bd=[..._0x409a10['body'][_0x6d7add(0x220)]],_0xb4323c=[..._0x409a10['body'][_0x6d7add(0x2c9)]],_0x3077b3=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x23b)]],_0x147e6b=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x246)]],_0x4e6130=[..._0x409a10[_0x6d7add(0x2be)]['to_prod_level']],_0x5aa8ff=[..._0x409a10['body']['to_prod_isle']],_0x5b3773=[..._0x409a10['body'][_0x6d7add(0x20f)]],_0x2811d1=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x21f)]],_0x55bf41=[..._0x409a10[_0x6d7add(0x2be)]['secondary_code']],_0x5a6313=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x2af)]],_0x3f28bd=[..._0x409a10['body'][_0x6d7add(0x1f0)]],_0xbb37cc=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x278)]],_0x44d342=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x239)]],_0x152d0e=[..._0x409a10[_0x6d7add(0x2be)]['batch_code']],_0x2dfbdf=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x215)]],_0x20b40b=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x2c1)]],_0x2b34a0=[..._0x409a10[_0x6d7add(0x2be)][_0x6d7add(0x262)]];const _0x3a935d=_0x323e12['map'](_0x39a3c0=>{return _0x39a3c0={'product_name':_0x39a3c0};});_0x4ab2e1[_0x6d7add(0x274)]((_0x538171,_0x93c224)=>{_0x3a935d[_0x93c224]['from_quantity']=_0x538171;}),_0x9f07bd[_0x6d7add(0x274)]((_0x4cdffe,_0x5e4188)=>{var _0x4838aa=_0x6d7add;_0x3a935d[_0x5e4188][_0x4838aa(0x257)]=_0x4cdffe;}),_0xb4323c[_0x6d7add(0x274)]((_0xd2ceba,_0x4ab055)=>{var _0x2c7b0b=_0x6d7add;_0x3a935d[_0x4ab055][_0x2c7b0b(0x288)]=_0xd2ceba;}),_0x3077b3[_0x6d7add(0x274)]((_0x9051c3,_0x5c91ff)=>{var _0x513221=_0x6d7add;_0x3a935d[_0x5c91ff][_0x513221(0x255)]=_0x9051c3;}),_0x147e6b[_0x6d7add(0x274)]((_0x5b9d30,_0x13d528)=>{_0x3a935d[_0x13d528]['to_quantity']=_0x5b9d30;}),_0x4e6130[_0x6d7add(0x274)]((_0x5ba34e,_0x121520)=>{var _0xa9721=_0x6d7add;_0x3a935d[_0x121520][_0xa9721(0x2b1)]=_0x5ba34e;}),_0x5aa8ff['forEach']((_0x1c9202,_0x223666)=>{var _0x78aedd=_0x6d7add;_0x3a935d[_0x223666][_0x78aedd(0x1f8)]=_0x1c9202;}),_0x5b3773[_0x6d7add(0x274)]((_0x473e99,_0x357d39)=>{var _0x483b31=_0x6d7add;_0x3a935d[_0x357d39][_0x483b31(0x219)]=_0x473e99;}),_0x2811d1[_0x6d7add(0x274)]((_0x1cf683,_0x4875bf)=>{var _0x4e7a0d=_0x6d7add;_0x3a935d[_0x4875bf][_0x4e7a0d(0x21f)]=_0x1cf683;}),_0x55bf41[_0x6d7add(0x274)]((_0x2b3a06,_0x61290e)=>{_0x3a935d[_0x61290e]['secondary_code']=_0x2b3a06;}),_0x5a6313['forEach']((_0x333ded,_0x40d4d9)=>{_0x3a935d[_0x40d4d9]['product_code']=_0x333ded;}),_0x3f28bd['forEach']((_0x3d0e35,_0x5266b4)=>{var _0xcf7a41=_0x6d7add;_0x3a935d[_0x5266b4][_0xcf7a41(0x247)]=_0x3d0e35;}),_0xbb37cc[_0x6d7add(0x274)]((_0x5901e6,_0x41c5a0)=>{_0x3a935d[_0x41c5a0]['unit']=_0x5901e6;}),_0x44d342[_0x6d7add(0x274)]((_0x54299b,_0x185f48)=>{var _0x165461=_0x6d7add;_0x3a935d[_0x185f48][_0x165461(0x239)]=_0x54299b;}),_0x152d0e[_0x6d7add(0x274)]((_0x1c1069,_0x5ae8be)=>{var _0x17525b=_0x6d7add;_0x3a935d[_0x5ae8be][_0x17525b(0x203)]=_0x1c1069;}),_0x2dfbdf[_0x6d7add(0x274)]((_0x3b41d7,_0x5a3011)=>{var _0x4e4ff8=_0x6d7add;_0x3a935d[_0x5a3011][_0x4e4ff8(0x215)]=_0x3b41d7;}),_0x3bdd31[_0x6d7add(0x274)]((_0x5a6898,_0x1179ab)=>{var _0x5b8d39=_0x6d7add;_0x3a935d[_0x1179ab][_0x5b8d39(0x27b)]=_0x5a6898;}),_0x41ed70[_0x6d7add(0x274)]((_0x406681,_0x28e6cb)=>{_0x3a935d[_0x28e6cb]['rack']=_0x406681;}),_0xd0eaf[_0x6d7add(0x274)]((_0x54ef9d,_0x3de4ae)=>{var _0x309048=_0x6d7add;_0x3a935d[_0x3de4ae][_0x309048(0x253)]=_0x54ef9d;}),_0x1327f8[_0x6d7add(0x274)]((_0x21e430,_0x4bfc62)=>{var _0x4c2a41=_0x6d7add;_0x3a935d[_0x4bfc62][_0x4c2a41(0x272)]=_0x21e430;}),_0x20b40b[_0x6d7add(0x274)]((_0x36c36b,_0x4bfe9c)=>{var _0x8d3d0c=_0x6d7add;_0x3a935d[_0x4bfe9c][_0x8d3d0c(0x2c1)]=_0x36c36b;}),_0x2b34a0[_0x6d7add(0x274)]((_0x3a2b6d,_0x796b9)=>{var _0x2e228c=_0x6d7add;_0x3a935d[_0x796b9][_0x2e228c(0x2d5)]=_0x3a2b6d;});const _0x2805d4=_0x3a935d['filter'](_0x5e46f6=>_0x5e46f6[_0x6d7add(0x249)]!=='0'&&_0x5e46f6[_0x6d7add(0x249)]!==''||_0x5e46f6[_0x6d7add(0x219)]!=='0'&&_0x5e46f6[_0x6d7add(0x219)]!=='');var _0x473c9a=0x0;_0x2805d4[_0x6d7add(0x274)](_0x11c168=>{var _0x540680=_0x6d7add;parseInt(_0x11c168['from_quantity'])<parseInt(_0x11c168[_0x540680(0x249)])&&_0x473c9a++;});if(_0x473c9a!=0x0)return _0x409a10[_0x6d7add(0x26d)](_0x6d7add(0x254),_0x6d7add(0x237)),_0x5c25f5[_0x6d7add(0x28a)](_0x6d7add(0x24d));const _0x49536e=await warehouse[_0x6d7add(0x1f1)]({'name':_0xd31f09[_0x6d7add(0x273)],'room':_0xd31f09[_0x6d7add(0x20e)]});_0xd31f09['product'][_0x6d7add(0x274)](_0x6a0525=>{var _0x431658=_0x6d7add;if(_0x6a0525[_0x431658(0x249)]>0x0){const _0x2b2591=_0x49536e[_0x431658(0x251)][_0x431658(0x26e)](_0x3da1f9=>{var _0x1f5f9a=_0x431658;_0x3da1f9[_0x1f5f9a(0x296)]==_0x6a0525[_0x1f5f9a(0x296)]&&_0x3da1f9[_0x1f5f9a(0x2d4)]==_0x6a0525['from_floorlevel']&&_0x3da1f9[_0x1f5f9a(0x29d)]==_0x6a0525[_0x1f5f9a(0x253)]&&_0x3da1f9[_0x1f5f9a(0x212)]==_0x6a0525[_0x1f5f9a(0x288)]&&_0x3da1f9['bay']==_0x6a0525[_0x1f5f9a(0x257)]&&_0x3da1f9['rack']==_0x6a0525[_0x1f5f9a(0x2d5)]&&_0x3da1f9['storage']==_0x6a0525[_0x1f5f9a(0x2c1)]&&(_0x3da1f9[_0x1f5f9a(0x2ad)]=parseInt(_0x3da1f9[_0x1f5f9a(0x2ad)])+parseInt(_0x6a0525[_0x1f5f9a(0x249)]));});}}),await _0x49536e[_0x6d7add(0x23c)]();const _0x5380e3=await warehouse[_0x6d7add(0x1f1)]({'name':_0xd31f09[_0x6d7add(0x2ba)],'room':_0xd31f09[_0x6d7add(0x276)]});_0xd31f09[_0x6d7add(0x2d2)][_0x6d7add(0x274)](_0x5d323a=>{var _0x1508cf=_0x6d7add;if(_0x5d323a[_0x1508cf(0x249)]>0x0){const _0x53e65e=_0x5380e3['product_details']['map'](_0x536cfc=>{var _0x51972f=_0x1508cf;_0x536cfc['product_name']==_0x5d323a[_0x51972f(0x296)]&&_0x536cfc[_0x51972f(0x2d4)]==_0x5d323a[_0x51972f(0x219)]&&_0x536cfc[_0x51972f(0x29d)]==_0x5d323a[_0x51972f(0x272)]&&_0x536cfc[_0x51972f(0x212)]==_0x5d323a[_0x51972f(0x1f8)]&&_0x536cfc[_0x51972f(0x2a7)]==_0x5d323a[_0x51972f(0x2b1)]&&_0x536cfc[_0x51972f(0x266)]==_0x5d323a['rack']&&_0x536cfc[_0x51972f(0x27b)]==_0x5d323a['storage']&&(_0x536cfc['product_stock']=parseInt(_0x536cfc[_0x51972f(0x2ad)])-parseInt(_0x5d323a['to_quantity']));});}}),await _0x5380e3[_0x6d7add(0x23c)](),_0xd31f09[_0x6d7add(0x209)]=_0x350ba8,_0xd31f09[_0x6d7add(0x273)]=_0x48a205,_0xd31f09['to_warehouse']=_0x5d0540,_0xd31f09[_0x6d7add(0x2d2)]=_0x2805d4,_0xd31f09[_0x6d7add(0x2a4)]=_0x5789d6,_0xd31f09[_0x6d7add(0x1ee)]=_0x38a7db;const _0x249823=await _0xd31f09[_0x6d7add(0x23c)]();console[_0x6d7add(0x281)](_0x249823);const _0x34b5ae=await warehouse[_0x6d7add(0x1f1)]({'name':_0x48a205,'room':_0x1f60ef});_0x249823['product'][_0x6d7add(0x274)](_0x1fbc88=>{var _0x4e899b=_0x6d7add;if(_0x1fbc88[_0x4e899b(0x249)]>0x0){const _0x4cc520=_0x34b5ae[_0x4e899b(0x251)][_0x4e899b(0x26e)](_0x22e23f=>{var _0x41d57a=_0x4e899b;_0x22e23f[_0x41d57a(0x296)]==_0x1fbc88['product_name']&&_0x22e23f['floorlevel']==_0x1fbc88['from_floorlevel']&&_0x22e23f[_0x41d57a(0x29d)]==_0x1fbc88[_0x41d57a(0x253)]&&_0x22e23f['bin']==_0x1fbc88[_0x41d57a(0x288)]&&_0x22e23f['bay']==_0x1fbc88[_0x41d57a(0x257)]&&_0x22e23f[_0x41d57a(0x266)]==_0x1fbc88[_0x41d57a(0x2d5)]&&_0x22e23f[_0x41d57a(0x27b)]==_0x1fbc88[_0x41d57a(0x2c1)]&&(_0x22e23f['product_stock']=parseInt(_0x22e23f[_0x41d57a(0x2ad)])-parseInt(_0x1fbc88[_0x41d57a(0x249)]));});}}),await _0x34b5ae[_0x6d7add(0x23c)]();const _0x48b32e=await warehouse[_0x6d7add(0x1f1)]({'name':_0x5d0540,'room':_0x103a81});_0x249823[_0x6d7add(0x2d2)][_0x6d7add(0x274)](_0x243e56=>{var _0x321912=_0x6d7add;if(_0x243e56[_0x321912(0x249)]>0x0){var _0xd430ef=0x0;const _0x2ed89d=_0x48b32e[_0x321912(0x251)][_0x321912(0x26e)](_0x2394ac=>{var _0x31862e=_0x321912;_0x2394ac['product_name']==_0x243e56[_0x31862e(0x296)]&&_0x2394ac['floorlevel']==_0x243e56[_0x31862e(0x219)]&&_0x2394ac[_0x31862e(0x29d)]==_0x243e56['to_types']&&_0x2394ac[_0x31862e(0x212)]==_0x243e56[_0x31862e(0x1f8)]&&_0x2394ac[_0x31862e(0x2a7)]==_0x243e56[_0x31862e(0x2b1)]&&_0x2394ac[_0x31862e(0x266)]==_0x243e56[_0x31862e(0x266)]&&_0x2394ac[_0x31862e(0x27b)]==_0x243e56[_0x31862e(0x27b)]&&(_0x2394ac[_0x31862e(0x2ad)]=parseInt(_0x2394ac['product_stock'])+parseInt(_0x243e56[_0x31862e(0x249)]),_0xd430ef++);});_0xd430ef=='0'&&(_0x48b32e['product_details']=_0x48b32e[_0x321912(0x251)]['concat']({'product_name':_0x243e56['product_name'],'product_stock':_0x243e56[_0x321912(0x249)],'bay':_0x243e56[_0x321912(0x2b1)],'bin':_0x243e56[_0x321912(0x1f8)],'type':_0x243e56[_0x321912(0x272)],'floorlevel':_0x243e56[_0x321912(0x219)],'storage':_0x243e56[_0x321912(0x27b)],'rack':_0x243e56[_0x321912(0x266)],'product_code':_0x243e56[_0x321912(0x25a)],'primary_code':_0x243e56[_0x321912(0x21f)],'secondary_code':_0x243e56[_0x321912(0x275)],'maxProducts':_0x243e56[_0x321912(0x247)],'storage':_0x243e56[_0x321912(0x27b)],'rack':_0x243e56[_0x321912(0x266)]}));}}),await _0x48b32e[_0x6d7add(0x23c)](),_0x409a10[_0x6d7add(0x26d)](_0x6d7add(0x2d6),_0x6d7add(0x2d9)),_0x5c25f5['redirect'](_0x6d7add(0x26a));}catch(_0x1454b4){console[_0x6d7add(0x281)](_0x1454b4);}}),router['post'](a0_0x1f4596(0x228),async(_0x47d502,_0x335e23)=>{var _0xe92219=a0_0x1f4596;const {FromWareHouse:_0x444462,FromRoom:_0x40956b,ToWarehouse:_0x76b185,ToRoom:_0x226fe8,primary_code:_0x2e6c00,Roomslist:_0x3b8e8c}=_0x47d502['body'],_0x138ab9=_0x3b8e8c[_0xe92219(0x1fe)](','),_0x16c075=[];async function _0x5865e2(_0x40de5d){var _0x5b66cd=_0xe92219;const _0x3f2594=await warehouse['aggregate']([{'$match':{'name':_0x444462,'room':_0x40de5d}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2e6c00}},{'$group':{'_id':_0x5b66cd(0x2c8),'name':{'$first':_0x5b66cd(0x2a2)},'instock':{'$first':_0x5b66cd(0x226)},'primary_code':{'$first':_0x5b66cd(0x200)},'secondary_code':{'$first':_0x5b66cd(0x202)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5b66cd(0x1fa)},'isle':{'$first':_0x5b66cd(0x259)},'type':{'$first':_0x5b66cd(0x293)},'pallet':{'$first':_0x5b66cd(0x2ab)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5b66cd(0x24e)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5b66cd(0x2db)},'expiry_date':{'$first':_0x5b66cd(0x20c)},'production_date':{'$first':_0x5b66cd(0x2d7)},'batch_code':{'$first':_0x5b66cd(0x21a)},'maxPerUnit':{'$first':_0x5b66cd(0x2c6)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x5b66cd(0x227)}}}]),_0x375178=await warehouse[_0x5b66cd(0x1fb)]([{'$match':{'name':_0x444462,'room':_0x40de5d}},{'$unwind':_0x5b66cd(0x20a)},{'$match':{'product_details.secondary_code':_0x2e6c00}},{'$group':{'_id':_0x5b66cd(0x2c8),'name':{'$first':_0x5b66cd(0x2a2)},'instock':{'$first':_0x5b66cd(0x226)},'primary_code':{'$first':_0x5b66cd(0x200)},'secondary_code':{'$first':_0x5b66cd(0x202)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5b66cd(0x1fa)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x5b66cd(0x293)},'pallet':{'$first':_0x5b66cd(0x2ab)},'unit':{'$first':_0x5b66cd(0x250)},'secondary_unit':{'$first':_0x5b66cd(0x24e)},'storage':{'$first':_0x5b66cd(0x2d3)},'rack':{'$first':_0x5b66cd(0x2db)},'expiry_date':{'$first':_0x5b66cd(0x20c)},'production_date':{'$first':_0x5b66cd(0x2d7)},'batch_code':{'$first':_0x5b66cd(0x21a)},'maxPerUnit':{'$first':_0x5b66cd(0x2c6)},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x5b66cd(0x27c)},'maxProducts':{'$first':_0x5b66cd(0x227)}}}]);if(_0x3f2594['length']>0x0)_0x16c075['push'](_0x3f2594);else _0x375178[_0x5b66cd(0x265)]>0x0&&_0x16c075['push'](_0x375178);}const _0x39a64c=_0x138ab9[_0xe92219(0x26e)](_0x2611cd=>_0x5865e2(_0x2611cd));await Promise[_0xe92219(0x23f)](_0x39a64c),_0x335e23[_0xe92219(0x2d1)](_0x16c075);}),router['post'](a0_0x1f4596(0x283),async(_0x40ba82,_0x369efd)=>{var _0x42ac78=a0_0x1f4596;try{const {FromWareHouse:_0x468244,FromRoom:_0x466515,ToWarehouse:_0x553385,ToRoom:_0x355930,secondary_code:_0x401a1f}=_0x40ba82['body'],_0x121173=await warehouse[_0x42ac78(0x1fb)]([{'$match':{'name':_0x468244}},{'$unwind':_0x42ac78(0x20a)},{'$match':{'product_details.secondary_code':_0x401a1f}},{'$group':{'_id':_0x42ac78(0x2c8),'name':{'$first':_0x42ac78(0x2a2)},'primary_code':{'$first':_0x42ac78(0x200)},'secondary_code':{'$first':_0x42ac78(0x202)},'product_code':{'$first':_0x42ac78(0x1f6)},'instock':{'$first':_0x42ac78(0x226)},'warehouse':{'$first':_0x42ac78(0x1f3)},'level':{'$first':_0x42ac78(0x28c)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x42ac78(0x21c)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0x369efd['status'](0xc8)[_0x42ac78(0x2d1)](_0x121173);}catch(_0x144c6c){_0x369efd[_0x42ac78(0x2b8)](0x194)['json']({'message':_0x144c6c['message']});}}),router[a0_0x1f4596(0x223)](a0_0x1f4596(0x27e),async(_0x5cae82,_0x2ec317)=>{var _0x2350eb=a0_0x1f4596;try{const {FromWareHouse:_0x244eab,FromRoom:_0x16e963,ToWarehouse:_0x85dbf,ToRoom:_0x547531,product_code:_0x202af3}=_0x5cae82[_0x2350eb(0x2be)],_0x4e28df=await warehouse[_0x2350eb(0x1fb)]([{'$match':{'name':_0x244eab}},{'$unwind':_0x2350eb(0x20a)},{'$match':{'product_details.product_code':_0x202af3}},{'$group':{'_id':_0x2350eb(0x2c8),'name':{'$first':_0x2350eb(0x2a2)},'primary_code':{'$first':_0x2350eb(0x200)},'secondary_code':{'$first':_0x2350eb(0x202)},'product_code':{'$first':_0x2350eb(0x1f6)},'instock':{'$first':_0x2350eb(0x226)},'warehouse':{'$first':_0x2350eb(0x1f3)},'level':{'$first':_0x2350eb(0x28c)},'isle':{'$first':_0x2350eb(0x2b6)},'pallet':{'$first':_0x2350eb(0x21c)},'maxProducts':{'$first':_0x2350eb(0x227)},'unit':{'$first':_0x2350eb(0x250)}}}]);_0x2ec317['status'](0xc8)['json'](_0x4e28df);}catch(_0x5576e2){_0x2ec317['status'](0x194)[_0x2350eb(0x2d1)]({'message':_0x5576e2[_0x2350eb(0x2cb)]});}}),router[a0_0x1f4596(0x223)](a0_0x1f4596(0x2a8),async(_0x1d74d4,_0x1953b4)=>{var _0x360fd4=a0_0x1f4596;const {level:_0x2d425a,isle:_0x3b2d2a,pallet:_0x2f112f,warehouses:_0x79352b,room:_0x1987ba}=_0x1d74d4[_0x360fd4(0x2be)];try{const _0x443c94=await warehouse['aggregate']([{'$match':{'name':_0x79352b,'room':_0x1987ba}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x2d425a),'product_details.isle':_0x3b2d2a,'product_details.pallet':parseInt(_0x2f112f)}},{'$group':{'_id':_0x360fd4(0x2c8),'name':{'$first':_0x360fd4(0x2a2)},'product_stock':{'$first':_0x360fd4(0x226)},'level':{'$first':_0x360fd4(0x28c)},'isle':{'$first':_0x360fd4(0x2b6)},'pallet':{'$first':_0x360fd4(0x21c)},'maxProducts':{'$first':_0x360fd4(0x227)}}}]);_0x1953b4['status'](0xc8)['json'](_0x443c94);}catch(_0x1e6c03){_0x1953b4[_0x360fd4(0x2b8)](0x194)[_0x360fd4(0x2d1)]({'message':_0x1e6c03['message']});}}),module['exports']=router;