var a0_0x54ec11=a0_0x5466;function a0_0x4c3b(){var _0x589add=['maxperunit','</h5>','Logo.png','prod_Qty','$product.bin','English\x20(US)','payment\x20successfull','$product_code','findById','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.product_code','standard_unit','$brand','$due_amount','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$invoice','$name','add\x20post','prod_invoice','Level','room','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','</thead>','$date','DRY\x20STORAGE','Rack\x20F','$product.type','$finalize','$product_details._id','room_name','purchases\x20item\x20return\x20successfull','/barcode/:id','</tbody>','prod_level','$product_details.bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','types','</tr>','catch','$suppliers','alertQTY','delivery_code','<hr\x20class=\x22my-3\x22>','render','/../public','return_purchase','$maxStocks','return_data','user','max_product_unit','<tr>','note','slice','21894cmgoKJ','An\x20error\x20occurred.','\x20<\x20wew\x20>\x20','Hindi','flash','Rack\x20C','$product.bay','here','logo','prod_unit','1052752SJsNkd','stock_quantity','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','exports','image','pallet','find','name','$maxProdPerUnit','</body></html>','$product_details.floorlevel','672218pjqxtL','/all_purchases/view','10OVaibB','paid_amount','$room','Portuguese\x20(BR)','/give_payment/:id','/view','sendMail','Rack\x20B','bay','Floor','</table>','password','$product.floorlevel','5613471COwiGq','return_qty','$product_details.primary_code','email','express','prod_code','product_stock','\x20Order\x20Number\x20:\x20','rack','<strong>\x20Regards\x20</strong>','aggregate','JO_number','<h2>\x20','get','/view/return_purchase/:id','purchase_quantity','prod_isle','toString','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','MaxStocks_data','delivery_date','batch_code','save','expiry_date','storage','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$paid_amount','padStart','product_code','Receiving\x20Area','$product_details.product_stock','site_title','log','purchase\x20data\x20update\x20successfully','</span>','../public/language/languages.json','body','Error\x20Occurs','INC-','params','<tbody\x20style=\x22text-align:\x20center;\x22>','German','True','amount','Room_name','maxStocks','errors','</td>','$product_details.level','147LnuUPy','warehouse_name','secondary_code','<html><head><title></title>','currency_placement','Arabic\x20(ae)','prod_secondunit','secondary_unit','getDate','$batch_code','</head><body>','</div>','Enclosed','suppliers_docs','deliverycode','459535HUDeyO','prod_cat','$alertquantity','error','path','/view/:id','$expiry_date','purchase_invoice','303982UWsOvd','actual_uom','bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','string','user_id','French','Paid\x20For\x20Purchase','/CheckingWarehouse','$product_details.expiry_date','/barcode_scanner','edit_purchases_view','<!DOCTYPE\x20html>','master','Return\x20Goods','level','$product_details.type','random','actual_qty','\x20</h2>','$primary_code','product_name','$_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','/view/add_purchases','product_cat','\x20<>\x20','<h5\x20style=\x22text-align:\x20left;\x22>','length','Rack\x20A','currency','edit_purchases','abs','$product_details.secondary_code','table\x20page','RoomAssign','Raw\x20Materials','/preview/:id','ejs','Chinese','finalize','Purchase\x20Mail','Spanish','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/upload/','isle','date','Rack\x20E','$unit','Ambient','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$secondary_code','getMonth','../models/all_models','getFullYear','all_purchases','product_list','status','$warehouse_name','quantity','Router','Portuguese','$product_details.product_name','product_details','message','nodemailer','map','primary_code','An\x20error\x20occurred\x20while\x20saving\x20data.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product.quantity','59108ejLesV','findOne','English','floorlevel','prod_pallet','stocks','Enabled','invoice','$product_details.rack','<div>','product','prod_primunit','$note','$product_details.maxProducts','production_date','Arabic','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','push','suppliers','then','$product.room_name','createTransport','forEach','$product','concat','prod_name','post','filter','primary_code_hide','role','language','due_amount','type','suppliers_data','96ExRnkl','secondary_code_hide','$suppliers_docs','warehouse','rak','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','redirect','$category','/invoice/:id','\x20Order\x20Date\x20:\x20','staff','$product_details.bay','json'];a0_0x4c3b=function(){return _0x589add;};return a0_0x4c3b();}(function(_0x846941,_0x378a58){var _0x4dc75b=a0_0x5466,_0x42c90f=_0x846941();while(!![]){try{var _0x30d908=parseInt(_0x4dc75b(0x2dd))/0x1+parseInt(_0x4dc75b(0x219))/0x2+parseInt(_0x4dc75b(0x284))/0x3*(parseInt(_0x4dc75b(0x262))/0x4)+-parseInt(_0x4dc75b(0x211))/0x5+-parseInt(_0x4dc75b(0x2c7))/0x6*(parseInt(_0x4dc75b(0x202))/0x7)+-parseInt(_0x4dc75b(0x2d1))/0x8+-parseInt(_0x4dc75b(0x2ec))/0x9*(parseInt(_0x4dc75b(0x2df))/0xa);if(_0x30d908===_0x378a58)break;else _0x42c90f['push'](_0x42c90f['shift']());}catch(_0x26feb2){_0x42c90f['push'](_0x42c90f['shift']());}}}(a0_0x4c3b,0x5b1e8));const express=require(a0_0x54ec11(0x2f0)),app=express(),router=express[a0_0x54ec11(0x257)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x54ec11(0x250)),auth=require(a0_0x54ec11(0x244)),nodemailer=require(a0_0x54ec11(0x25c));var ejs=require(a0_0x54ec11(0x23f));const path=require(a0_0x54ec11(0x215)),users=require(a0_0x54ec11(0x1f4));router['get'](a0_0x54ec11(0x2e4),auth,async(_0x1c02c1,_0x4593ae)=>{var _0x12d061=a0_0x54ec11;try{const {username:_0x266109,email:_0x328c05,role:_0x11c5d2}=_0x1c02c1[_0x12d061(0x2c2)],_0x566c5c=_0x1c02c1['user'],_0x262192=await profile[_0x12d061(0x263)]({'email':_0x566c5c[_0x12d061(0x2ef)]}),_0x411c47=await staff[_0x12d061(0x263)]({'email':_0x566c5c[_0x12d061(0x2ef)]});if(_0x566c5c[_0x12d061(0x27f)]=='staff'){const _0x184076=await staff[_0x12d061(0x263)]({'email':_0x566c5c[_0x12d061(0x2ef)]});}const _0x1b4033=await master_shop[_0x12d061(0x2d8)]();let _0x15b6d;if(_0x566c5c[_0x12d061(0x27f)]=='staff'){const _0x4f9e5c=await staff[_0x12d061(0x263)]({'email':_0x566c5c['email']});_0x15b6d=await purchases[_0x12d061(0x2f6)]([{'$match':{'warehouse_name':_0x4f9e5c[_0x12d061(0x287)]}},{'$lookup':{'from':_0x12d061(0x274),'localField':_0x12d061(0x274),'foreignField':_0x12d061(0x2d9),'as':_0x12d061(0x20f)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x12d061(0x279)},{'$group':{'_id':_0x12d061(0x22f),'invoice':{'$first':_0x12d061(0x2a1)},'suppliers':{'$first':_0x12d061(0x2b9)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x12d061(0x255)},'room':{'$first':_0x12d061(0x2e1)},'product':{'$push':_0x12d061(0x279)},'note':{'$first':_0x12d061(0x26e)},'paid_amount':{'$first':_0x12d061(0x1eb)},'due_amount':{'$first':_0x12d061(0x29f)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x12d061(0x217)},'suppliers_docs':{'$first':_0x12d061(0x286)},'total_product_quantity':{'$sum':_0x12d061(0x261)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x12d061(0x2ac)},'floorlevel':{'$addToSet':_0x12d061(0x2eb)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x15b6d=await purchases[_0x12d061(0x2f6)]([{'$lookup':{'from':_0x12d061(0x274),'localField':_0x12d061(0x274),'foreignField':'name','as':'suppliers_docs'}},{'$unwind':_0x12d061(0x286)},{'$unwind':_0x12d061(0x279)},{'$group':{'_id':_0x12d061(0x22f),'invoice':{'$first':_0x12d061(0x2a1)},'suppliers':{'$first':_0x12d061(0x2b9)},'date':{'$first':_0x12d061(0x2a9)},'warehouse_name':{'$first':_0x12d061(0x255)},'room':{'$addToSet':_0x12d061(0x276)},'product':{'$push':_0x12d061(0x279)},'note':{'$first':_0x12d061(0x26e)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x12d061(0x20b)},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0x12d061(0x286)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x12d061(0x2cd)},'isle':{'$addToSet':_0x12d061(0x295)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x12d061(0x2eb)},'finalize':{'$first':_0x12d061(0x2ad)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x1b4033[0x0][_0x12d061(0x280)]=='English\x20(US)'){var _0x35920f=users[_0x12d061(0x264)];console[_0x12d061(0x1f1)](_0x35920f);}else{if(_0x1b4033[0x0]['language']==_0x12d061(0x2ca))var _0x35920f=users[_0x12d061(0x2ca)];else{if(_0x1b4033[0x0]['language']=='German')var _0x35920f=users[_0x12d061(0x1fa)];else{if(_0x1b4033[0x0]['language']==_0x12d061(0x243))var _0x35920f=users[_0x12d061(0x243)];else{if(_0x1b4033[0x0][_0x12d061(0x280)]==_0x12d061(0x21f))var _0x35920f=users['French'];else{if(_0x1b4033[0x0]['language']==_0x12d061(0x2e2))var _0x35920f=users['Portuguese'];else{if(_0x1b4033[0x0]['language']==_0x12d061(0x240))var _0x35920f=users['Chinese'];else{if(_0x1b4033[0x0]['language']=='Arabic\x20(ae)')var _0x35920f=users[_0x12d061(0x271)];}}}}}}}_0x4593ae[_0x12d061(0x2bd)](_0x12d061(0x252),{'success':_0x1c02c1[_0x12d061(0x2cb)](_0x12d061(0x29a)),'errors':_0x1c02c1[_0x12d061(0x2cb)]('errors'),'purchases':_0x15b6d,'role':_0x566c5c,'profile':_0x262192,'master_shop':_0x1b4033,'language':_0x35920f});}catch(_0x83e534){console['log'](_0x12d061(0x23b),_0x83e534),_0x4593ae[_0x12d061(0x254)](0xc8)[_0x12d061(0x290)]({'message':_0x83e534[_0x12d061(0x25b)]});}});function BayBinSelected(_0x2d39d7,_0x1cdc3e){var _0x2e36dc=a0_0x54ec11,_0x3111e1=[],_0x35b49b=[],_0x3047c2=[],_0x2cb93b=[],_0x13e7b1=[],_0x1b3647=[];let _0x3e2ecb=[];if(_0x2d39d7==_0x2e36dc(0x2aa))switch(_0x1cdc3e){case _0x2e36dc(0x236):_0x3111e1=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x35b49b=[0x1,0x2],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=['Level',_0x2e36dc(0x2e8)],_0x13e7b1=['D'],_0x1b3647=['A'];break;case'Rack\x20B':_0x3111e1=[0x6,0x5,0x4,0x3,0x2,0x1],_0x35b49b=[0x1,0x2],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=[_0x2e36dc(0x2a5),_0x2e36dc(0x2e8)],_0x13e7b1=['D'],_0x1b3647=['B'];break;case'Shelves':_0x3111e1=[0x0],_0x35b49b=[0x0],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=[_0x2e36dc(0x2e8)],_0x13e7b1=['D'],_0x1b3647=['S'];break;case _0x2e36dc(0x1ee):_0x3111e1=[0x0],_0x35b49b=[0x0],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3047c2=[_0x2e36dc(0x2e8)],_0x13e7b1=['D'],_0x1b3647=['R'];break;}else{if(_0x2d39d7=='COLD\x20STORAGE')switch(_0x1cdc3e){case _0x2e36dc(0x236):_0x3111e1=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x35b49b=['B','F'],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=[_0x2e36dc(0x2a5),'Floor'],_0x13e7b1=['C'],_0x1b3647=['A'];break;case _0x2e36dc(0x2e6):_0x3111e1=[0x5,0x4,0x3,0x2,0x1],_0x35b49b=['F','B','S'],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=[_0x2e36dc(0x2a5),'Floor'],_0x13e7b1=['C'],_0x1b3647=['B'];break;case _0x2e36dc(0x2cc):_0x3111e1=[0x1,0x2,0x3,0x4,0x5],_0x35b49b=['B','F','S'],_0x2cb93b=[0x5,0x4,0x3,0x2,0x1],_0x3047c2=[_0x2e36dc(0x2a5),'Floor'],_0x13e7b1=['C'],_0x1b3647=['C'];break;case'Rack\x20D':_0x3111e1=[0x5,0x4,0x3,0x2,0x1],_0x35b49b=['F','B','S'],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=[_0x2e36dc(0x2a5),'Floor'],_0x13e7b1=['C'],_0x1b3647=['D'];break;case _0x2e36dc(0x249):_0x3111e1=[0x4,0x3,0x2,0x1],_0x35b49b=[0x1,0x2],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=[_0x2e36dc(0x2a5),'Floor'],_0x13e7b1=['C'],_0x1b3647=['E'];break;case _0x2e36dc(0x2ab):_0x3111e1=[0x1,0x2,0x3],_0x35b49b=[0x1,0x2],_0x2cb93b=[0x1,0x2,0x3,0x4,0x5],_0x3047c2=[_0x2e36dc(0x2a5)],_0x13e7b1=['C'],_0x1b3647=['F'];break;}}return{'levels':_0x3111e1,'Isle':_0x35b49b,'rack':_0x2cb93b,'type':_0x3047c2,'storage':_0x13e7b1,'rak':_0x1b3647};}function a0_0x5466(_0x290fae,_0x7dd552){var _0x4c3b61=a0_0x4c3b();return a0_0x5466=function(_0x54660e,_0x448e1e){_0x54660e=_0x54660e-0x1dd;var _0xd5b185=_0x4c3b61[_0x54660e];return _0xd5b185;},a0_0x5466(_0x290fae,_0x7dd552);}async function getRandom8DigitNumber(){var _0x6e19fd=a0_0x54ec11;const _0x15a8d9=0x989680,_0x4fff8d=0x5f5e0ff,_0x359614=Math['floor'](Math[_0x6e19fd(0x22a)]()*(_0x4fff8d-_0x15a8d9+0x1))+_0x15a8d9;var _0x4f6047;const _0x43b3cd=await purchases[_0x6e19fd(0x263)]({'invoice':'INC-'+_0x359614});return _0x43b3cd&&_0x43b3cd['length']>0x0?_0x4f6047=_0x6e19fd(0x1f7)+_0x359614:_0x4f6047=_0x6e19fd(0x1f7)+_0x359614,_0x4f6047;}router[a0_0x54ec11(0x1de)](a0_0x54ec11(0x231),auth,async(_0x1fe04f,_0xe2645)=>{var _0x261dba=a0_0x54ec11;try{const {username:_0x371c3f,email:_0x17cc93,role:_0x563246}=_0x1fe04f[_0x261dba(0x2c2)],_0x1614e6=_0x1fe04f[_0x261dba(0x2c2)],_0x111c9c=await profile[_0x261dba(0x263)]({'email':_0x1614e6[_0x261dba(0x2ef)]}),_0x532176=await master_shop['find'](),_0x564892=await staff['findOne']({'email':_0x1614e6[_0x261dba(0x2ef)]}),_0x1e39f1=await suppliers[_0x261dba(0x2d8)]({});let _0x159b2a;if(_0x1614e6[_0x261dba(0x27f)]==_0x261dba(0x28e)){const _0x23914c=await staff['findOne']({'email':_0x1614e6[_0x261dba(0x2ef)]});_0x159b2a=await warehouse[_0x261dba(0x2f6)]([{'$match':{'status':_0x261dba(0x268),'name':_0x23914c[_0x261dba(0x287)],'warehouse_category':_0x261dba(0x23d),'name':{'$ne':_0x261dba(0x227)}}},{'$group':{'_id':_0x261dba(0x2a2),'name':{'$first':_0x261dba(0x2a2)}}}]);}else _0x159b2a=await warehouse[_0x261dba(0x2f6)]([{'$match':{'status':_0x261dba(0x268),'warehouse_category':_0x261dba(0x23d),'name':{'$ne':_0x261dba(0x227)}}},{'$group':{'_id':_0x261dba(0x2a2),'name':{'$first':'$name'}}}]);const _0x239894=await product[_0x261dba(0x2d8)]({}),_0x136ac2=await warehouse['find']({'status':'Enabled'}),_0x4aacde=await purchases[_0x261dba(0x2d8)]({}),_0x545cf7=_0x4aacde['length']+0x1,_0x544778=_0x261dba(0x1f7)+_0x545cf7[_0x261dba(0x1e2)]()[_0x261dba(0x1ec)](0x5,'0');var _0x5315d2=[_0x261dba(0x24b),_0x261dba(0x20e)];if(_0x532176[0x0][_0x261dba(0x280)]=='English\x20(US)')var _0x5dadea=users[_0x261dba(0x264)];else{if(_0x532176[0x0][_0x261dba(0x280)]==_0x261dba(0x2ca))var _0x5dadea=users['Hindi'];else{if(_0x532176[0x0][_0x261dba(0x280)]==_0x261dba(0x1fa))var _0x5dadea=users[_0x261dba(0x1fa)];else{if(_0x532176[0x0][_0x261dba(0x280)]==_0x261dba(0x243))var _0x5dadea=users[_0x261dba(0x243)];else{if(_0x532176[0x0][_0x261dba(0x280)]==_0x261dba(0x21f))var _0x5dadea=users[_0x261dba(0x21f)];else{if(_0x532176[0x0][_0x261dba(0x280)]==_0x261dba(0x2e2))var _0x5dadea=users[_0x261dba(0x258)];else{if(_0x532176[0x0][_0x261dba(0x280)]==_0x261dba(0x240))var _0x5dadea=users[_0x261dba(0x240)];else{if(_0x532176[0x0][_0x261dba(0x280)]==_0x261dba(0x207))var _0x5dadea=users['Arabic'];}}}}}}}const _0xe8b836=getRandom8DigitNumber();_0xe8b836['then'](_0x3ca61b=>{var _0x4ec96e=_0x261dba;_0xe2645[_0x4ec96e(0x2bd)]('add_purchases',{'success':_0x1fe04f[_0x4ec96e(0x2cb)](_0x4ec96e(0x29a)),'errors':_0x1fe04f[_0x4ec96e(0x2cb)]('errors'),'role':_0x1614e6,'profile':_0x111c9c,'suppliers':_0x1e39f1,'warehouse':_0x159b2a,'product':_0x239894,'invoice':_0x3ca61b,'master_shop':_0x532176,'language':_0x5dadea,'find_data':_0x136ac2,'rooms_data':_0x5315d2});})[_0x261dba(0x2b8)](_0x365d55=>{var _0x493583=_0x261dba;_0x1fe04f[_0x493583(0x2cb)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0xe2645[_0x493583(0x28a)]('/all_purchases/view');});}catch(_0x1fd2ab){console[_0x261dba(0x1f1)](_0x1fd2ab);}}),router['get']('/view/add_purchases/:id',auth,async(_0x11078a,_0x11e34d)=>{var _0x24a150=a0_0x54ec11;try{const _0x250f35=_0x11078a[_0x24a150(0x1f8)]['id'];console['log'](_0x250f35);const _0x5d87ed=await master_shop[_0x24a150(0x2d8)]();console['log'](_0x24a150(0x226),_0x5d87ed);const _0xf40f1a=await product[_0x24a150(0x263)]({'name':_0x250f35});console[_0x24a150(0x1f1)](_0x24a150(0x26c),_0xf40f1a),_0x11e34d[_0x24a150(0x254)](0xc8)[_0x24a150(0x290)]({'product_data':_0xf40f1a,'master':_0x5d87ed});}catch(_0x59161f){console[_0x24a150(0x1f1)]('add_purchases\x20error',_0x59161f);}}),router[a0_0x54ec11(0x27c)](a0_0x54ec11(0x231),auth,async(_0x14d01e,_0x190d97)=>{var _0x5b6312=a0_0x54ec11;try{const {invoice:_0x1ebd20,date:_0x3c6289,warehouse_name:_0x3b62d5,prod_name:_0x5716f0,prod_code:_0x2aa3e0,prod_qty:_0x485014,prod_unit:_0x573384,prod_secondunit:_0x2c81e8,prod_level:_0x4873c6,prod_isle:_0x10435f,prod_pallet:_0x4cf7b1,note:_0x26e346,expiry_date:_0x47156a,batch_code:_0x1bcc12,payable:_0x5bff39,due_amount:_0x113968,Room_name:_0x489eed,primary_code:_0x2a97ae,secondary_code:_0x2f52ad,MaxStocks_data:_0x3bfa05,PO_number:_0x6bd57b,SCRN:_0x13f031,JO_number:_0x5cf4ba}=_0x14d01e[_0x5b6312(0x1f5)];if(typeof _0x5716f0==_0x5b6312(0x21d))var _0x379631=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x27b)]],_0x364320=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x2f1)]],_0x42e069=[_0x14d01e['body']['prod_Qty']],_0x2700b1=[_0x14d01e[_0x5b6312(0x1f5)]['prod_primunit']],_0x3f895b=[_0x14d01e['body'][_0x5b6312(0x208)]],_0x23f196=[_0x14d01e[_0x5b6312(0x1f5)]['prod_level']],_0x3274ca=[_0x14d01e[_0x5b6312(0x1f5)]['primary_code']],_0x30178f=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x204)]],_0x268764=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x1e4)]],_0x348f3e=[_0x14d01e['body'][_0x5b6312(0x1e6)]],_0x2c7d7a=[_0x14d01e['body'][_0x5b6312(0x1e8)]],_0x1ba0dd=[_0x14d01e['body'][_0x5b6312(0x2c3)]],_0x4a324b=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x2ba)]],_0x2d94ec=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x270)]],_0x4d86a4=[_0x14d01e[_0x5b6312(0x1f5)]['prod_cat']],_0xda6c56=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x23c)]],_0x1ab2a1=[_0x14d01e['body']['deliverycode']],_0x1fec30=[_0x14d01e[_0x5b6312(0x1f5)]['prod_invoice']],_0x44efdd=[_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x22b)]],_0x1aa6c7=[_0x14d01e['body']['actual_uom']];else var _0x379631=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x27b)]],_0x364320=[..._0x14d01e[_0x5b6312(0x1f5)]['prod_code']],_0x42e069=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x294)]],_0x2700b1=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x26d)]],_0x3f895b=[..._0x14d01e['body']['prod_secondunit']],_0x23f196=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x2b3)]],_0x3274ca=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x25e)]],_0x30178f=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x204)]],_0x268764=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x1e4)]],_0x348f3e=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x1e6)]],_0x2c7d7a=[..._0x14d01e['body'][_0x5b6312(0x1e8)]],_0x1ba0dd=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x2c3)]],_0x4a324b=[..._0x14d01e['body'][_0x5b6312(0x2ba)]],_0x2d94ec=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x270)]],_0x4d86a4=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x212)]],_0xda6c56=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x23c)]],_0x1ab2a1=[..._0x14d01e['body'][_0x5b6312(0x210)]],_0x1fec30=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x2a4)]],_0x44efdd=[..._0x14d01e[_0x5b6312(0x1f5)]['actual_qty']],_0x1aa6c7=[..._0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x21a)]];const _0x49d840=_0x379631[_0x5b6312(0x25d)](_0x481496=>{return _0x481496={'product_name':_0x481496};});_0x44efdd[_0x5b6312(0x278)]((_0x1db5fe,_0xd296b1)=>{var _0x1bee86=_0x5b6312;_0x49d840[_0xd296b1][_0x1bee86(0x22b)]=Math[_0x1bee86(0x239)](_0x1db5fe);}),_0x1aa6c7[_0x5b6312(0x278)]((_0xd2c27d,_0x7c334b)=>{var _0x4be565=_0x5b6312;_0x49d840[_0x7c334b][_0x4be565(0x21a)]=_0xd2c27d;}),_0x364320['forEach']((_0x2ff557,_0x5e95ce)=>{var _0x1a5d60=_0x5b6312;_0x49d840[_0x5e95ce][_0x1a5d60(0x1ed)]=_0x2ff557;}),_0x42e069[_0x5b6312(0x278)]((_0x4e181d,_0x2a8fc8)=>{var _0x35a1db=_0x5b6312;_0x49d840[_0x2a8fc8][_0x35a1db(0x256)]=Math[_0x35a1db(0x239)](_0x4e181d);}),_0x2700b1[_0x5b6312(0x278)]((_0xe3794c,_0x4482ff)=>{var _0xa3b0e5=_0x5b6312;_0x49d840[_0x4482ff][_0xa3b0e5(0x29d)]=_0xe3794c;}),_0x3f895b[_0x5b6312(0x278)]((_0x2ef52d,_0x416a09)=>{_0x49d840[_0x416a09]['secondary_unit']=_0x2ef52d;}),_0x23f196[_0x5b6312(0x278)]((_0x4b593f,_0x29f48c)=>{var _0x38bffd=_0x5b6312;_0xda6c56[_0x38bffd(0x278)]((_0x4162e8,_0x24ffdf)=>{var _0x290919=_0x38bffd;if(_0x4162e8==_0x290919(0x1ee)&&_0x29f48c==_0x24ffdf){console[_0x290919(0x1f1)](_0x4162e8+_0x290919(0x2c9)+_0x29f48c+'\x20<>\x20'+_0x24ffdf+_0x290919(0x233)+_0x4b593f);var _0x527706=_0x4b593f[_0x290919(0x2c6)](0x3);_0x49d840[_0x29f48c]['storage']=_0x4b593f[0x0],_0x49d840[_0x29f48c][_0x290919(0x2f4)]=_0x4b593f[0x1],_0x49d840[_0x29f48c][_0x290919(0x2e7)]=0x0,_0x49d840[_0x29f48c][_0x290919(0x21b)]=0x0,_0x49d840[_0x29f48c][_0x290919(0x282)]='Floor',_0x49d840[_0x29f48c][_0x290919(0x265)]=_0x527706;}else{if(_0x4162e8=='Shelves'&&_0x29f48c==_0x24ffdf){var _0x527706=_0x4b593f['slice'](0x3);_0x49d840[_0x29f48c][_0x290919(0x1e9)]=_0x4b593f[0x0],_0x49d840[_0x29f48c][_0x290919(0x2f4)]=_0x4b593f[0x1],_0x49d840[_0x29f48c]['bay']=0x0,_0x49d840[_0x29f48c][_0x290919(0x21b)]=0x0,_0x49d840[_0x29f48c][_0x290919(0x282)]=_0x290919(0x2e8),_0x49d840[_0x29f48c][_0x290919(0x265)]=_0x4b593f[0x5];}else{if(_0x29f48c==_0x24ffdf){if(_0x4b593f[0x0]=='A'&&_0x4b593f[0x1]=='L'&&_0x4b593f[0x2]=='L')console['log'](_0x4162e8+_0x290919(0x233)+_0x29f48c+'\x20<>\x20'+_0x24ffdf+_0x290919(0x233)+_0x4b593f+_0x290919(0x2ce)),_0x49d840[_0x29f48c]['storage']=_0x4b593f[0x0],_0x49d840[_0x29f48c][_0x290919(0x2f4)]=_0x4b593f[0x1],_0x49d840[_0x29f48c][_0x290919(0x2e7)]=0x0,_0x49d840[_0x29f48c][_0x290919(0x21b)]=0x0,_0x49d840[_0x29f48c][_0x290919(0x282)]=_0x290919(0x2e8),_0x49d840[_0x29f48c][_0x290919(0x265)]=_0x4b593f[0x3];else{var _0x56c519;if(_0x4b593f[0x4]=='L')_0x56c519='Level';else _0x4b593f[0x4]=='F'&&(_0x56c519='Floor');_0x49d840[_0x29f48c][_0x290919(0x1e9)]=_0x4b593f[0x0],_0x49d840[_0x29f48c]['rack']=_0x4b593f[0x1],_0x49d840[_0x29f48c]['bay']=_0x4b593f[0x2],_0x49d840[_0x29f48c][_0x290919(0x21b)]=_0x4b593f[0x3],_0x49d840[_0x29f48c][_0x290919(0x282)]=_0x56c519,_0x49d840[_0x29f48c][_0x290919(0x265)]=_0x4b593f[0x5];}}}}});}),_0x3274ca[_0x5b6312(0x278)]((_0x3c6540,_0x2da146)=>{_0x49d840[_0x2da146]['primary_code']=_0x3c6540;}),_0x30178f[_0x5b6312(0x278)]((_0x499f1c,_0x53bcbc)=>{_0x49d840[_0x53bcbc]['secondary_code']=_0x499f1c;}),_0x268764[_0x5b6312(0x278)]((_0x1783c2,_0x4f3ce7)=>{_0x49d840[_0x4f3ce7]['maxStocks']=_0x1783c2;}),_0x348f3e[_0x5b6312(0x278)]((_0x5bf9ab,_0x597f7a)=>{var _0x59e665=_0x5b6312;_0x49d840[_0x597f7a][_0x59e665(0x1e6)]=_0x5bf9ab;}),_0x2c7d7a[_0x5b6312(0x278)]((_0x383992,_0x22bc00)=>{var _0x26b056=_0x5b6312;_0x49d840[_0x22bc00][_0x26b056(0x1e8)]=_0x383992;}),_0x1ba0dd[_0x5b6312(0x278)]((_0x6af751,_0xe3c482)=>{var _0x320fc0=_0x5b6312;_0x49d840[_0xe3c482][_0x320fc0(0x291)]=_0x6af751;}),_0x4a324b[_0x5b6312(0x278)]((_0x4ac781,_0x3a90fb)=>{_0x49d840[_0x3a90fb]['alertQTY']=_0x4ac781;}),_0x2d94ec['forEach']((_0x2201dc,_0x484862)=>{var _0x1a537d=_0x5b6312;_0x49d840[_0x484862][_0x1a537d(0x270)]=_0x2201dc;}),_0x4d86a4[_0x5b6312(0x278)]((_0x503f44,_0x19354e)=>{var _0x5596cc=_0x5b6312;_0x49d840[_0x19354e][_0x5596cc(0x232)]=_0x503f44;}),_0xda6c56['forEach']((_0x1b48b6,_0x54a5e0)=>{var _0x3c5727=_0x5b6312;_0x49d840[_0x54a5e0][_0x3c5727(0x2af)]=_0x1b48b6;}),_0x1ab2a1[_0x5b6312(0x278)]((_0x26217d,_0x18849c)=>{var _0x936c4b=_0x5b6312;_0x49d840[_0x18849c][_0x936c4b(0x2bb)]=_0x26217d;}),_0x1fec30['forEach']((_0x2b71b7,_0x53eef9)=>{var _0xd2b935=_0x5b6312;_0x49d840[_0x53eef9][_0xd2b935(0x269)]=_0x2b71b7;});const _0x200fb0=_0xda6c56[_0x5b6312(0x25d)](_0x49d536=>{return _0x49d536={'room_name':_0x49d536};}),_0x35e320=_0x49d840[_0x5b6312(0x27d)](_0x5af5ab=>_0x5af5ab['quantity']!=='0'&&_0x5af5ab[_0x5b6312(0x256)]!==''),_0x555309=new purchases({'invoice':_0x1ebd20,'suppliers':_0x14d01e[_0x5b6312(0x1f5)][_0x5b6312(0x274)],'date':_0x3c6289,'warehouse_name':_0x3b62d5,'product':_0x35e320,'note':_0x26e346,'due_amount':_0x113968,'POnumber':_0x6bd57b,'SCRN':_0x13f031,'JO_number':_0x5cf4ba,'roomList':_0x200fb0}),_0xd3399a=await _0x555309[_0x5b6312(0x1e7)](),_0x2bbf2b=await purchases[_0x5b6312(0x263)]({'invoice':_0x1ebd20}),_0x41e348=_0x2bbf2b[_0x5b6312(0x26c)][_0x5b6312(0x25d)](async _0x536f27=>{var _0x4928f6=_0x5b6312,_0x3b1d8c=await warehouse[_0x4928f6(0x263)]({'name':_0x3b62d5,'room':_0x536f27[_0x4928f6(0x2af)]}),_0x3af616=0x0;return _0x3b1d8c[_0x4928f6(0x25a)][_0x4928f6(0x278)](_0x246ded=>{var _0x4d94c6=_0x4928f6;_0x246ded[_0x4d94c6(0x22e)]==_0x536f27['product_name']&&_0x246ded['floorlevel']==_0x536f27[_0x4d94c6(0x265)]&&_0x246ded[_0x4d94c6(0x282)]==_0x536f27['type']&&_0x246ded['bin']==_0x536f27[_0x4d94c6(0x21b)]&&_0x246ded['bay']==_0x536f27[_0x4d94c6(0x2e7)]&&_0x246ded[_0x4d94c6(0x2f4)]==_0x536f27['rack']&&_0x246ded['storage']==_0x536f27[_0x4d94c6(0x1e9)]&&_0x246ded[_0x4d94c6(0x1e8)]==_0x536f27[_0x4d94c6(0x1e8)]&&_0x246ded[_0x4d94c6(0x1e6)]==_0x536f27['batch_code']&&_0x246ded[_0x4d94c6(0x270)]==_0x536f27[_0x4d94c6(0x270)]&&_0x246ded[_0x4d94c6(0x269)]==_0x2bbf2b[_0x4d94c6(0x269)]&&(_0x246ded['product_stock']+=Math['abs'](_0x536f27[_0x4d94c6(0x256)]),_0x3af616++);}),_0x3af616===0x0&&_0x3b1d8c[_0x4928f6(0x25a)][_0x4928f6(0x273)]({'product_name':_0x536f27[_0x4928f6(0x22e)],'product_stock':Math[_0x4928f6(0x239)](_0x536f27[_0x4928f6(0x256)]),'primary_code':_0x536f27[_0x4928f6(0x25e)],'secondary_code':_0x536f27[_0x4928f6(0x204)],'product_code':_0x536f27[_0x4928f6(0x1ed)],'storage':_0x536f27[_0x4928f6(0x1e9)],'rack':_0x536f27[_0x4928f6(0x2f4)],'bay':_0x536f27[_0x4928f6(0x2e7)],'bin':_0x536f27[_0x4928f6(0x21b)],'type':_0x536f27[_0x4928f6(0x282)],'floorlevel':_0x536f27['floorlevel'],'maxProducts':_0x536f27[_0x4928f6(0x1fe)],'unit':_0x536f27[_0x4928f6(0x29d)],'secondary_unit':_0x536f27[_0x4928f6(0x209)],'expiry_date':_0x536f27[_0x4928f6(0x1e8)],'maxPerUnit':_0x536f27[_0x4928f6(0x291)],'batch_code':_0x536f27[_0x4928f6(0x1e6)],'alertQTY':_0x536f27[_0x4928f6(0x2ba)],'production_date':_0x536f27['production_date'],'product_cat':_0x536f27[_0x4928f6(0x232)],'invoice':_0x536f27['invoice'],'actual_qty':Math['abs'](_0x536f27['actual_qty']),'actual_uom':_0x536f27['actual_uom']}),_0x3b1d8c;});Promise['all'](_0x41e348)[_0x5b6312(0x275)](async _0x28cf28=>{var _0x2067c5=_0x5b6312;try{for(const _0x144d3e of _0x28cf28){await _0x144d3e[_0x2067c5(0x1e7)]();}const _0x1217d3=await master_shop['find'](),_0x4d9ab3=await email_settings[_0x2067c5(0x263)](),_0x149a90=await supervisor_settings['find']();var _0xf923f7=_0x2bbf2b[_0x2067c5(0x26c)],_0x27524a='',_0x4bb6f1;for(_0x4bb6f1 in _0xf923f7){_0x27524a+=_0x2067c5(0x2c4)+_0x2067c5(0x289)+_0xf923f7[_0x4bb6f1][_0x2067c5(0x22e)]+_0x2067c5(0x200)+_0x2067c5(0x289)+_0xf923f7[_0x4bb6f1][_0x2067c5(0x1ed)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xf923f7[_0x4bb6f1][_0x2067c5(0x256)]+_0x2067c5(0x200)+_0x2067c5(0x289)+_0xf923f7[_0x4bb6f1][_0x2067c5(0x29d)]+'</td>'+_0x2067c5(0x289)+_0xf923f7[_0x4bb6f1]['secondary_unit']+_0x2067c5(0x200)+_0x2067c5(0x289)+_0x2bbf2b[_0x2067c5(0x203)]+_0x2067c5(0x200)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xf923f7[_0x4bb6f1][_0x2067c5(0x2af)]+_0x2067c5(0x200)+_0x2067c5(0x289)+_0xf923f7[_0x4bb6f1][_0x2067c5(0x1e9)]+_0xf923f7[_0x4bb6f1][_0x2067c5(0x2f4)]+_0xf923f7[_0x4bb6f1][_0x2067c5(0x2e7)]+_0xf923f7[_0x4bb6f1][_0x2067c5(0x21b)]+_0xf923f7[_0x4bb6f1]['type'][0x0]+_0xf923f7[_0x4bb6f1]['floorlevel']+_0x2067c5(0x200),_0x2067c5(0x2b7);}let _0x5bfc7d=nodemailer[_0x2067c5(0x277)]({'host':_0x4d9ab3['host'],'port':Number(_0x4d9ab3['port']),'secure':![],'auth':{'user':_0x4d9ab3[_0x2067c5(0x2ef)],'pass':_0x4d9ab3['password']}}),_0xf1809c={'from':_0x4d9ab3['email'],'to':_0x149a90[0x0]['RMSEmail'],'subject':_0x2067c5(0x242),'attachments':[{'filename':_0x2067c5(0x293),'path':__dirname+_0x2067c5(0x2be)+_0x2067c5(0x246)+_0x1217d3[0x0][_0x2067c5(0x2d6)],'cid':_0x2067c5(0x2cf)}],'html':_0x2067c5(0x225)+_0x2067c5(0x205)+_0x2067c5(0x20c)+_0x2067c5(0x26b)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2067c5(0x26b)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2067c5(0x20d)+_0x2067c5(0x26b)+_0x2067c5(0x1dd)+_0x1217d3[0x0][_0x2067c5(0x1f0)]+'\x20</h2>'+'</div>'+_0x2067c5(0x20d)+_0x2067c5(0x2bc)+_0x2067c5(0x26b)+_0x2067c5(0x234)+_0x2067c5(0x2f3)+_0x2bbf2b['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2067c5(0x28d)+_0x2bbf2b['date']+'\x20'+_0x2067c5(0x1f3)+_0x2067c5(0x292)+_0x2067c5(0x20d)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2067c5(0x272)+_0x2067c5(0x2c4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2067c5(0x29b)+_0x2067c5(0x2d4)+_0x2067c5(0x245)+_0x2067c5(0x24d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x2067c5(0x21c)+_0x2067c5(0x2b7)+_0x2067c5(0x2a8)+_0x2067c5(0x1f9)+'\x20'+_0x27524a+'\x20'+_0x2067c5(0x2b2)+_0x2067c5(0x2e9)+_0x2067c5(0x26b)+_0x2067c5(0x2f5)+_0x2067c5(0x24c)+_0x1217d3[0x0][_0x2067c5(0x1f0)]+_0x2067c5(0x292)+_0x2067c5(0x20d)+_0x2067c5(0x20d)+'</body></html>'};_0x5bfc7d['sendMail'](_0xf1809c,function(_0x54180c,_0x159ac2){var _0x5ab905=_0x2067c5;_0x54180c?(console[_0x5ab905(0x1f1)](_0x54180c),console[_0x5ab905(0x1f1)]('Error\x20Occurs')):console[_0x5ab905(0x1f1)]('Email\x20sent\x20successfully');}),_0x14d01e['flash']('success','Purchase\x20data\x20added\x20successfully'),_0x190d97[_0x2067c5(0x28a)]('/all_purchases/view/');}catch(_0x1872d0){console[_0x2067c5(0x214)](_0x1872d0),_0x190d97[_0x2067c5(0x254)](0x1f4)[_0x2067c5(0x290)]({'error':_0x2067c5(0x25f)});}})[_0x5b6312(0x2b8)](_0x4d111a=>{var _0x2512a0=_0x5b6312;console[_0x2512a0(0x214)](_0x4d111a),_0x190d97['status'](0x1f4)['json']({'error':_0x2512a0(0x2c8)});});}catch(_0x3917be){console[_0x5b6312(0x1f1)](_0x3917be);}}),router[a0_0x54ec11(0x1de)](a0_0x54ec11(0x23e),auth,async(_0x27b819,_0x5873b3)=>{var _0x11d5eb=a0_0x54ec11;try{const {username:_0x180651,email:_0x382090,role:_0x28fd91}=_0x27b819[_0x11d5eb(0x2c2)],_0xb4c89b=_0x27b819[_0x11d5eb(0x2c2)],_0x4ef59f=await profile['findOne']({'email':_0xb4c89b[_0x11d5eb(0x2ef)]}),_0x2a2174=await master_shop['find'](),_0x1b927b=_0x27b819[_0x11d5eb(0x1f8)]['id'],_0x5ac6ae=await purchases['findById'](_0x1b927b),_0x36ed90=await warehouse[_0x11d5eb(0x2f6)]([{'$match':{'name':_0x5ac6ae[_0x11d5eb(0x203)],'room':_0x5ac6ae['room']}},{'$unwind':_0x11d5eb(0x2d3)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x11d5eb(0x259)},'product_stock':{'$first':_0x11d5eb(0x1ef)},'bay':{'$first':_0x11d5eb(0x28f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x11d5eb(0x229)},'floorlevel':{'$first':_0x11d5eb(0x2dc)},'primary_code':{'$first':_0x11d5eb(0x2ee)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x11d5eb(0x29c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x11d5eb(0x26a)},'expiry_date':{'$first':_0x11d5eb(0x222)}}}]),_0x4638c2=await customer['find']({});let _0x3f8dc9;if(_0xb4c89b[_0x11d5eb(0x27f)]==_0x11d5eb(0x28e)){const _0x4d7fe9=await staff[_0x11d5eb(0x263)]({'email':_0xb4c89b[_0x11d5eb(0x2ef)]});_0x3f8dc9=await warehouse[_0x11d5eb(0x2f6)]([{'$match':{'status':_0x11d5eb(0x268),'name':_0x4d7fe9['warehouse']}},{'$group':{'_id':_0x11d5eb(0x2a2),'name':{'$first':_0x11d5eb(0x2a2)}}}]);}else _0x3f8dc9=await warehouse['aggregate']([{'$match':{'status':_0x11d5eb(0x268)}},{'$group':{'_id':'$name','name':{'$first':_0x11d5eb(0x2a2)}}}]);const _0x41668e=await product['find']({}),_0xbf2ccd=await suppliers['find']({}),_0x440cfc=BayBinSelected(_0x5ac6ae['warehouse_name'],_0x5ac6ae['room']);if(_0x2a2174[0x0]['language']==_0x11d5eb(0x296)){var _0x14f717=users['English'];console[_0x11d5eb(0x1f1)](_0x14f717);}else{if(_0x2a2174[0x0][_0x11d5eb(0x280)]=='Hindi')var _0x14f717=users[_0x11d5eb(0x2ca)];else{if(_0x2a2174[0x0][_0x11d5eb(0x280)]==_0x11d5eb(0x1fa))var _0x14f717=users[_0x11d5eb(0x1fa)];else{if(_0x2a2174[0x0][_0x11d5eb(0x280)]=='Spanish')var _0x14f717=users[_0x11d5eb(0x243)];else{if(_0x2a2174[0x0][_0x11d5eb(0x280)]==_0x11d5eb(0x21f))var _0x14f717=users[_0x11d5eb(0x21f)];else{if(_0x2a2174[0x0][_0x11d5eb(0x280)]==_0x11d5eb(0x2e2))var _0x14f717=users[_0x11d5eb(0x258)];else{if(_0x2a2174[0x0][_0x11d5eb(0x280)]==_0x11d5eb(0x240))var _0x14f717=users[_0x11d5eb(0x240)];else{if(_0x2a2174[0x0]['language']==_0x11d5eb(0x207))var _0x14f717=users[_0x11d5eb(0x271)];}}}}}}}_0x5873b3[_0x11d5eb(0x2bd)](_0x11d5eb(0x224),{'success':_0x27b819[_0x11d5eb(0x2cb)](_0x11d5eb(0x29a)),'errors':_0x27b819[_0x11d5eb(0x2cb)](_0x11d5eb(0x1ff)),'role':_0xb4c89b,'profile':_0x4ef59f,'customer':_0x4638c2,'warehouse':_0x3f8dc9,'product':_0x36ed90,'user':_0x5ac6ae,'master_shop':_0x2a2174,'unit':_0x41668e,'language':_0x14f717,'suppliers':_0xbf2ccd,'dataSelected':_0x440cfc});}catch(_0x474576){console[_0x11d5eb(0x1f1)](_0x474576);}}),router['post'](a0_0x54ec11(0x23e),auth,async(_0x187a99,_0x135905)=>{var _0xd2246e=a0_0x54ec11;try{const _0x3e8bce=_0x187a99['params']['id'],{invoice:_0x3d3111,warehouse_name:_0x399703,Room_name:_0xbdb021}=_0x187a99[_0xd2246e(0x1f5)],_0x21bd51=await warehouse[_0xd2246e(0x263)]({'name':_0x399703,'room':_0xbdb021}),_0x494e2f=await purchases['findOne']({'invoice':_0x3d3111});_0x494e2f[_0xd2246e(0x26c)][_0xd2246e(0x278)](_0x520939=>{var _0x46aeaf=_0xd2246e,_0x254e84=0x0;const _0x55bd85=_0x21bd51[_0x46aeaf(0x25a)][_0x46aeaf(0x25d)](_0xe2fe29=>{var _0x339576=_0x46aeaf;_0xe2fe29['product_name']==_0x520939[_0x339576(0x22e)]&&_0xe2fe29[_0x339576(0x265)]==_0x520939[_0x339576(0x265)]&&_0xe2fe29[_0x339576(0x282)]==_0x520939[_0x339576(0x282)]&&_0xe2fe29[_0x339576(0x21b)]==_0x520939[_0x339576(0x21b)]&&_0xe2fe29['bay']==_0x520939['bay']&&_0xe2fe29[_0x339576(0x2f4)]==_0x520939[_0x339576(0x2f4)]&&_0xe2fe29['storage']==_0x520939[_0x339576(0x1e9)]&&_0xe2fe29[_0x339576(0x1e8)]==_0x520939[_0x339576(0x1e8)]&&_0xe2fe29[_0x339576(0x1e6)]==_0x520939[_0x339576(0x1e6)]&&_0xe2fe29[_0x339576(0x270)]==_0x520939[_0x339576(0x270)]&&_0xe2fe29[_0x339576(0x1e5)]==_0x520939[_0x339576(0x1e5)]&&_0xe2fe29[_0x339576(0x2bb)]==_0x520939[_0x339576(0x2bb)]&&(_0xe2fe29['product_stock']=parseInt(_0xe2fe29[_0x339576(0x2f2)])+parseInt(_0x520939[_0x339576(0x256)]),_0x254e84++);});_0x254e84=='0'&&(_0x21bd51[_0x46aeaf(0x25a)]=_0x21bd51['product_details']['concat']({'product_name':_0x520939[_0x46aeaf(0x22e)],'product_stock':_0x520939[_0x46aeaf(0x256)],'primary_code':_0x520939[_0x46aeaf(0x25e)],'secondary_code':_0x520939['secondary_code'],'product_code':_0x520939[_0x46aeaf(0x1ed)],'storage':_0x520939[_0x46aeaf(0x1e9)],'rack':_0x520939[_0x46aeaf(0x2f4)],'bay':_0x520939[_0x46aeaf(0x2e7)],'bin':_0x520939[_0x46aeaf(0x21b)],'type':_0x520939['type'],'floorlevel':_0x520939['floorlevel'],'maxProducts':_0x520939[_0x46aeaf(0x1fe)],'unit':_0x520939[_0x46aeaf(0x29d)],'secondary_unit':_0x520939['secondary_unit'],'expiry_date':_0x520939[_0x46aeaf(0x1e8)],'maxPerUnit':_0x520939[_0x46aeaf(0x291)],'batch_code':_0x520939[_0x46aeaf(0x1e6)],'alertQTY':_0x520939[_0x46aeaf(0x2ba)],'production_date':_0x520939[_0x46aeaf(0x270)],'delivery_date':_0x520939['delivery_date'],'delivery_code':_0x520939[_0x46aeaf(0x2bb)]}));}),await _0x21bd51[_0xd2246e(0x1e7)](),_0x494e2f[_0xd2246e(0x241)]=_0xd2246e(0x1fb);const _0x55b599=await _0x494e2f[_0xd2246e(0x1e7)]();_0x187a99[_0xd2246e(0x2cb)](_0xd2246e(0x29a),'Sales\x20Update\x20successfully'),_0x135905[_0xd2246e(0x28a)](_0xd2246e(0x2de));}catch(_0x1cc82a){console[_0xd2246e(0x1f1)](_0x1cc82a);}}),router[a0_0x54ec11(0x1de)]('/view/:id',auth,async(_0x3aab43,_0x163b50)=>{var _0x25f8a1=a0_0x54ec11;try{const {username:_0x46e1b8,email:_0x4970dd,role:_0x3a6497}=_0x3aab43[_0x25f8a1(0x2c2)],_0x1e5792=_0x3aab43[_0x25f8a1(0x2c2)],_0x389ec7=await profile[_0x25f8a1(0x263)]({'email':_0x1e5792[_0x25f8a1(0x2ef)]}),_0x29e581=await master_shop[_0x25f8a1(0x2d8)](),_0x492a3c=_0x3aab43['params']['id'],_0x17c6ff=await purchases['findById'](_0x492a3c),_0x455c4e=await suppliers['find']({});let _0x58110f;if(_0x1e5792[_0x25f8a1(0x27f)]==_0x25f8a1(0x28e)){const _0x1c41c5=await staff[_0x25f8a1(0x263)]({'email':_0x1e5792[_0x25f8a1(0x2ef)]});_0x58110f=await warehouse[_0x25f8a1(0x2d8)]({'status':'Enabled','name':_0x1c41c5[_0x25f8a1(0x287)],'warehouse_category':'Raw\x20Materials'});}else _0x58110f=await warehouse[_0x25f8a1(0x2f6)]([{'$match':{'status':_0x25f8a1(0x268),'warehouse_category':_0x25f8a1(0x23d)}},{'$group':{'_id':_0x25f8a1(0x2a2),'name':{'$first':_0x25f8a1(0x2a2)}}}]);const _0x1ec823=await product[_0x25f8a1(0x2d8)]({}),_0x280a29=BayBinSelected(_0x17c6ff[_0x25f8a1(0x203)],_0x17c6ff[_0x25f8a1(0x2a6)]);let _0x58f568=new Date(_0x17c6ff['expiry_date']),_0x119c26=('0'+_0x58f568[_0x25f8a1(0x20a)]())[_0x25f8a1(0x2c6)](-0x2),_0xe021fd=('0'+(_0x58f568[_0x25f8a1(0x24f)]()+0x1))[_0x25f8a1(0x2c6)](-0x2),_0x338b6a=_0x58f568[_0x25f8a1(0x251)](),_0x152158=_0x338b6a+'-'+_0xe021fd+'-'+_0x119c26;if(_0x29e581[0x0]['language']==_0x25f8a1(0x296)){var _0x10d193=users['English'];console[_0x25f8a1(0x1f1)](_0x10d193);}else{if(_0x29e581[0x0][_0x25f8a1(0x280)]=='Hindi')var _0x10d193=users[_0x25f8a1(0x2ca)];else{if(_0x29e581[0x0][_0x25f8a1(0x280)]==_0x25f8a1(0x1fa))var _0x10d193=users[_0x25f8a1(0x1fa)];else{if(_0x29e581[0x0]['language']==_0x25f8a1(0x243))var _0x10d193=users['Spanish'];else{if(_0x29e581[0x0][_0x25f8a1(0x280)]==_0x25f8a1(0x21f))var _0x10d193=users[_0x25f8a1(0x21f)];else{if(_0x29e581[0x0][_0x25f8a1(0x280)]=='Portuguese\x20(BR)')var _0x10d193=users[_0x25f8a1(0x258)];else{if(_0x29e581[0x0][_0x25f8a1(0x280)]==_0x25f8a1(0x240))var _0x10d193=users[_0x25f8a1(0x240)];else{if(_0x29e581[0x0][_0x25f8a1(0x280)]==_0x25f8a1(0x207))var _0x10d193=users[_0x25f8a1(0x271)];}}}}}}}_0x163b50[_0x25f8a1(0x2bd)](_0x25f8a1(0x238),{'success':_0x3aab43[_0x25f8a1(0x2cb)](_0x25f8a1(0x29a)),'errors':_0x3aab43[_0x25f8a1(0x2cb)](_0x25f8a1(0x1ff)),'role':_0x1e5792,'profile':_0x389ec7,'purchases':_0x17c6ff,'suppliers':_0x455c4e,'warehouse':_0x58110f,'product':_0x1ec823,'master_shop':_0x29e581,'language':_0x10d193,'ed_fullDate':_0x152158,'dataSelected':_0x280a29});}catch(_0x2d5521){console[_0x25f8a1(0x1f1)](_0x2d5521);}}),router['post'](a0_0x54ec11(0x216),auth,async(_0x5d57cd,_0x39005b)=>{var _0x1c1672=a0_0x54ec11;try{const _0x5e8908=_0x5d57cd[_0x1c1672(0x1f8)]['id'],_0x188945=await purchases['findOne']({'_id':_0x5d57cd[_0x1c1672(0x1f8)]['id']}),_0x40f558=await warehouse[_0x1c1672(0x263)]({'name':_0x188945[_0x1c1672(0x203)],'room':_0x188945['room']});_0x188945['product'][_0x1c1672(0x278)](_0x2abb3d=>{var _0x1afb9a=_0x1c1672;const _0x100e8d=_0x40f558[_0x1afb9a(0x25a)][_0x1afb9a(0x25d)](_0x4ee454=>{var _0xf387ae=_0x1afb9a;_0x4ee454['product_name']==_0x2abb3d['product_name']&&_0x4ee454[_0xf387ae(0x265)]==_0x2abb3d[_0xf387ae(0x265)]&&_0x4ee454[_0xf387ae(0x282)]==_0x2abb3d[_0xf387ae(0x282)]&&_0x4ee454[_0xf387ae(0x21b)]==_0x2abb3d['bin']&&_0x4ee454[_0xf387ae(0x2e7)]==_0x2abb3d['bay']&&_0x4ee454[_0xf387ae(0x2f4)]==_0x2abb3d['rack']&&_0x4ee454['storage']==_0x2abb3d[_0xf387ae(0x1e9)]&&(_0x4ee454[_0xf387ae(0x2f2)]=parseInt(_0x4ee454[_0xf387ae(0x2f2)])-parseInt(_0x2abb3d[_0xf387ae(0x256)]));});}),await _0x40f558[_0x1c1672(0x1e7)]();const {invoice:_0x43ffa0,suppliers:_0x2f5d4b,date:_0xc8d6e5,warehouse_name:_0x4c406a,prod_name:_0x2dccd4,prod_code:_0x224969,prod_qty:_0x3c15d4,prod_unit:_0x3b0627,prod_secondunit:_0xb08c28,prod_level:_0x517f9c,prod_isle:_0x22dfae,prod_pallet:_0x48d8f7,note:_0x2a7a75,expiry_date:_0x449ba2,batch_code:_0x33adec,paid_amount:_0x4fd256,due_amount:_0x2c51df,Room_name:_0x5b0f01,primary_code:_0x3f2e5c,secondary_code:_0x47a897,PO_number:_0x591942,JO_number:_0x523142}=_0x5d57cd[_0x1c1672(0x1f5)];if(typeof _0x2dccd4==_0x1c1672(0x21d))var _0x31c303=[_0x5d57cd[_0x1c1672(0x1f5)]['prod_name']],_0x105bf8=[_0x5d57cd[_0x1c1672(0x1f5)]['prod_code']],_0xa592d4=[_0x5d57cd[_0x1c1672(0x1f5)]['prod_qty']],_0x32eee6=[_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x2d0)]],_0x2eb6c1=[_0x5d57cd[_0x1c1672(0x1f5)]['prod_secondunit']],_0x5b1d57=[_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x2b3)]],_0x46965f=[_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x1e1)]],_0x48441e=[_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x266)]],_0x51b562=[_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x25e)]],_0x219e63=[_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x204)]],_0x3f24f2=[_0x5d57cd['body']['MaxStocks_data']],_0x3f1a45=[_0x5d57cd['body'][_0x1c1672(0x1e6)]],_0x23cc86=[_0x5d57cd[_0x1c1672(0x1f5)]['expiry_date']],_0x40a584=[_0x5d57cd['body'][_0x1c1672(0x1e9)]],_0x9ce329=[_0x5d57cd[_0x1c1672(0x1f5)]['rak']],_0xfb00f7=[_0x5d57cd[_0x1c1672(0x1f5)]['type']];else var _0x31c303=[..._0x5d57cd[_0x1c1672(0x1f5)]['prod_name']],_0x105bf8=[..._0x5d57cd['body'][_0x1c1672(0x2f1)]],_0xa592d4=[..._0x5d57cd[_0x1c1672(0x1f5)]['prod_qty']],_0x32eee6=[..._0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x2d0)]],_0x2eb6c1=[..._0x5d57cd['body'][_0x1c1672(0x208)]],_0x5b1d57=[..._0x5d57cd[_0x1c1672(0x1f5)]['prod_level']],_0x46965f=[..._0x5d57cd['body']['prod_isle']],_0x48441e=[..._0x5d57cd['body'][_0x1c1672(0x266)]],_0x51b562=[..._0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x25e)]],_0x219e63=[..._0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x204)]],_0x3f24f2=[..._0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x1e4)]],_0x3f1a45=[..._0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x1e6)]],_0x23cc86=[..._0x5d57cd[_0x1c1672(0x1f5)]['expiry_date']],_0x40a584=[..._0x5d57cd['body'][_0x1c1672(0x1e9)]],_0x9ce329=[..._0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x288)]],_0xfb00f7=[..._0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x282)]];const _0x52377c=_0x31c303[_0x1c1672(0x25d)](_0x3adca2=>{return _0x3adca2={'product_name':_0x3adca2};});_0x105bf8[_0x1c1672(0x278)]((_0x522f76,_0x2a91e0)=>{var _0x2c3629=_0x1c1672;_0x52377c[_0x2a91e0][_0x2c3629(0x1ed)]=_0x522f76;}),_0xa592d4['forEach']((_0x3c2786,_0x503868)=>{var _0x5d1f24=_0x1c1672;_0x52377c[_0x503868][_0x5d1f24(0x256)]=_0x3c2786;}),_0x32eee6[_0x1c1672(0x278)]((_0x438f62,_0xbc3b97)=>{var _0x29e3b1=_0x1c1672;_0x52377c[_0xbc3b97][_0x29e3b1(0x29d)]=_0x438f62;}),_0x2eb6c1['forEach']((_0x1670da,_0x2decd4)=>{var _0x38d409=_0x1c1672;_0x52377c[_0x2decd4][_0x38d409(0x209)]=_0x1670da;}),_0x5b1d57[_0x1c1672(0x278)]((_0x1797fc,_0x338cea)=>{var _0x2af386=_0x1c1672;_0x52377c[_0x338cea][_0x2af386(0x2e7)]=_0x1797fc;}),_0x46965f[_0x1c1672(0x278)]((_0x2a43bd,_0x121fd2)=>{var _0x3a68cf=_0x1c1672;_0x52377c[_0x121fd2][_0x3a68cf(0x21b)]=_0x2a43bd;}),_0x48441e[_0x1c1672(0x278)]((_0x16d6c0,_0x48feea)=>{var _0x2adc22=_0x1c1672;_0x52377c[_0x48feea][_0x2adc22(0x265)]=_0x16d6c0;}),_0x51b562[_0x1c1672(0x278)]((_0x265270,_0xd2872b)=>{var _0x16c4d0=_0x1c1672;_0x52377c[_0xd2872b][_0x16c4d0(0x25e)]=_0x265270;}),_0x219e63[_0x1c1672(0x278)]((_0x3d8c1e,_0x218862)=>{var _0x1cc58f=_0x1c1672;_0x52377c[_0x218862][_0x1cc58f(0x204)]=_0x3d8c1e;}),_0x3f24f2[_0x1c1672(0x278)]((_0x1398c8,_0x2bf1d7)=>{var _0x338066=_0x1c1672;_0x52377c[_0x2bf1d7][_0x338066(0x1fe)]=_0x1398c8;}),_0x3f1a45[_0x1c1672(0x278)]((_0xa7454d,_0x57129f)=>{_0x52377c[_0x57129f]['batch_code']=_0xa7454d;}),_0x23cc86[_0x1c1672(0x278)]((_0x446854,_0x52457c)=>{var _0xe5a25=_0x1c1672;_0x52377c[_0x52457c][_0xe5a25(0x1e8)]=_0x446854;}),_0xfb00f7[_0x1c1672(0x278)]((_0x3b23ad,_0x259f64)=>{var _0x4275b2=_0x1c1672;_0x52377c[_0x259f64][_0x4275b2(0x282)]=_0x3b23ad;}),_0x40a584['forEach']((_0x50b100,_0x1bfc62)=>{var _0x1a6407=_0x1c1672;_0x52377c[_0x1bfc62][_0x1a6407(0x1e9)]=_0x50b100;}),_0x9ce329['forEach']((_0x2e9867,_0x1a41a3)=>{var _0x14f330=_0x1c1672;_0x52377c[_0x1a41a3][_0x14f330(0x2f4)]=_0x2e9867;});const _0x343020=_0x52377c[_0x1c1672(0x27d)](_0x47e108=>_0x47e108[_0x1c1672(0x256)]!=='0'&&_0x47e108[_0x1c1672(0x256)]!=='');_0x188945[_0x1c1672(0x269)]=_0x43ffa0,_0x188945[_0x1c1672(0x274)]=_0x2f5d4b,_0x188945[_0x1c1672(0x248)]=_0xc8d6e5,_0x188945[_0x1c1672(0x203)]=_0x4c406a,_0x188945[_0x1c1672(0x26c)]=_0x343020,_0x188945[_0x1c1672(0x2c5)]=_0x2a7a75,_0x188945['paid_amount']=_0x4fd256,_0x188945['due_amount']=_0x2c51df,_0x188945['room']=_0x5b0f01,_0x188945['POnumber']=_0x591942,_0x188945[_0x1c1672(0x2f7)]=_0x523142;const _0x21396b=await _0x188945[_0x1c1672(0x1e7)](),_0x440fd3=await warehouse[_0x1c1672(0x263)]({'name':_0x5d57cd[_0x1c1672(0x1f5)]['warehouse_name'],'room':_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x1fd)]});_0x188945[_0x1c1672(0x26c)][_0x1c1672(0x278)](_0x5a426e=>{var _0x391a70=_0x1c1672,_0x56bcb4=0x0;const _0x4ddab5=_0x440fd3[_0x391a70(0x25a)][_0x391a70(0x25d)](_0x303314=>{var _0x2217dc=_0x391a70;_0x303314['product_name']==_0x5a426e[_0x2217dc(0x22e)]&&_0x303314[_0x2217dc(0x265)]==_0x5a426e[_0x2217dc(0x265)]&&_0x303314['type']==_0x5a426e['type']&&_0x303314[_0x2217dc(0x21b)]==_0x5a426e[_0x2217dc(0x21b)]&&_0x303314[_0x2217dc(0x2e7)]==_0x5a426e[_0x2217dc(0x2e7)]&&_0x303314[_0x2217dc(0x2f4)]==_0x5a426e[_0x2217dc(0x2f4)]&&_0x303314[_0x2217dc(0x1e9)]==_0x5a426e[_0x2217dc(0x1e9)]&&(_0x303314[_0x2217dc(0x2f2)]=parseInt(_0x303314['product_stock'])+parseInt(_0x5a426e[_0x2217dc(0x256)]),_0x56bcb4++);});_0x56bcb4=='0'&&(_0x440fd3[_0x391a70(0x25a)]=_0x440fd3[_0x391a70(0x25a)][_0x391a70(0x27a)]({'product_name':_0x5a426e[_0x391a70(0x22e)],'product_stock':_0x5a426e[_0x391a70(0x256)],'primary_code':_0x5a426e[_0x391a70(0x25e)],'secondary_code':_0x5a426e[_0x391a70(0x204)],'product_code':_0x5a426e[_0x391a70(0x1ed)],'storage':_0x5a426e[_0x391a70(0x1e9)],'rack':_0x5a426e[_0x391a70(0x2f4)],'bay':_0x5a426e[_0x391a70(0x2e7)],'bin':_0x5a426e[_0x391a70(0x21b)],'type':_0x5a426e[_0x391a70(0x282)],'floorlevel':_0x5a426e[_0x391a70(0x265)],'maxProducts':_0x5a426e[_0x391a70(0x1fe)],'unit':_0x5a426e['standard_unit'],'secondary_unit':_0x5a426e[_0x391a70(0x209)],'expiry_date':_0x5a426e[_0x391a70(0x1e8)]}));}),await _0x440fd3[_0x1c1672(0x1e7)]();const _0x3c8a94=await s_payment_data[_0x1c1672(0x263)]({'invoice':_0x5d57cd['body'][_0x1c1672(0x269)]});if(_0x3c8a94===null){}else console['log'](_0x1c1672(0x274),_0x3c8a94,_0x5d57cd[_0x1c1672(0x1f5)][_0x1c1672(0x269)]),_0x3c8a94[_0x1c1672(0x274)]=_0x5d57cd[_0x1c1672(0x1f5)]['suppliers'],await _0x3c8a94[_0x1c1672(0x1e7)]();_0x5d57cd[_0x1c1672(0x2cb)](_0x1c1672(0x29a),_0x1c1672(0x1f2)),_0x39005b['redirect'](_0x1c1672(0x2de));}catch(_0x1fa6f7){console[_0x1c1672(0x1f1)](_0x1fa6f7);}}),router[a0_0x54ec11(0x27c)](a0_0x54ec11(0x2e3),auth,async(_0xc4e3e4,_0xb6d311)=>{var _0x883e89=a0_0x54ec11;try{const _0x330ba3=_0xc4e3e4[_0x883e89(0x1f8)]['id'],{invoice:_0x4e3baa,suppliers:_0x2544d6,payable:_0x5ed8c6,due_amount:_0x293f9a}=_0xc4e3e4[_0x883e89(0x1f5)],_0x2de833=await purchases[_0x883e89(0x299)](_0x330ba3);var _0x6fe4a2=_0x5ed8c6-_0x293f9a;_0x2de833[_0x883e89(0x2e0)]=parseFloat(_0x2de833[_0x883e89(0x2e0)])+parseFloat(_0x293f9a),_0x2de833[_0x883e89(0x281)]=_0x6fe4a2;const _0x150513=await _0x2de833['save']();console['log'](_0x150513);const _0x2cce36=await s_payment_data[_0x883e89(0x263)]({'invoice':_0x4e3baa});_0x2cce36[_0x883e89(0x1fc)]=_0x6fe4a2,await _0x2cce36[_0x883e89(0x1e7)]();let _0x539d5b=new Date(),_0x5edc1b=('0'+_0x539d5b['getDate']())[_0x883e89(0x2c6)](-0x2),_0x4e8211=('0'+(_0x539d5b[_0x883e89(0x24f)]()+0x1))[_0x883e89(0x2c6)](-0x2),_0x5d7b5f=_0x539d5b[_0x883e89(0x251)](),_0x24dd6d=_0x5d7b5f+'-'+_0x4e8211+'-'+_0x5edc1b;const _0x9ddbd7=new suppliers_payment({'invoice':_0x4e3baa,'date':_0x5d7b5f+'-'+_0x4e8211+'-'+_0x5edc1b,'suppliers':_0x2544d6,'reason':_0x883e89(0x220),'amount':_0x293f9a}),_0x37f64a=await _0x9ddbd7[_0x883e89(0x1e7)]();_0xc4e3e4[_0x883e89(0x2cb)](_0x883e89(0x29a),_0x883e89(0x297)),_0xb6d311[_0x883e89(0x28a)](_0x883e89(0x2de));}catch(_0x588308){console[_0x883e89(0x1f1)](_0x588308);}}),router['get'](a0_0x54ec11(0x28c),auth,async(_0x3e5d87,_0x13f496)=>{var _0x5a2401=a0_0x54ec11;try{const {username:_0x77f1bc,email:_0x30fedb,role:_0xa0d98b}=_0x3e5d87[_0x5a2401(0x2c2)],_0x207a95=_0x3e5d87[_0x5a2401(0x2c2)],_0x37dab8=await profile[_0x5a2401(0x263)]({'email':_0x207a95['email']}),_0x4e7f7f=await master_shop[_0x5a2401(0x2d8)]();console[_0x5a2401(0x1f1)](_0x5a2401(0x226),_0x4e7f7f);const _0x3dd7a1=_0x3e5d87[_0x5a2401(0x1f8)]['id'],_0x44ea07=await purchases[_0x5a2401(0x299)](_0x3dd7a1);console['log'](_0x44ea07);const _0x3ec4ae=await suppliers['findOne']({'name':_0x44ea07[_0x5a2401(0x274)]});console[_0x5a2401(0x1f1)](_0x3ec4ae);if(_0x4e7f7f[0x0][_0x5a2401(0x280)]==_0x5a2401(0x296)){var _0x5b8262=users[_0x5a2401(0x264)];console['log'](_0x5b8262);}else{if(_0x4e7f7f[0x0]['language']==_0x5a2401(0x2ca))var _0x5b8262=users[_0x5a2401(0x2ca)];else{if(_0x4e7f7f[0x0][_0x5a2401(0x280)]==_0x5a2401(0x1fa))var _0x5b8262=users[_0x5a2401(0x1fa)];else{if(_0x4e7f7f[0x0][_0x5a2401(0x280)]==_0x5a2401(0x243))var _0x5b8262=users[_0x5a2401(0x243)];else{if(_0x4e7f7f[0x0][_0x5a2401(0x280)]=='French')var _0x5b8262=users[_0x5a2401(0x21f)];else{if(_0x4e7f7f[0x0][_0x5a2401(0x280)]==_0x5a2401(0x2e2))var _0x5b8262=users[_0x5a2401(0x258)];else{if(_0x4e7f7f[0x0][_0x5a2401(0x280)]==_0x5a2401(0x240))var _0x5b8262=users['Chinese'];else{if(_0x4e7f7f[0x0][_0x5a2401(0x280)]==_0x5a2401(0x207))var _0x5b8262=users[_0x5a2401(0x271)];}}}}}}}_0x13f496[_0x5a2401(0x2bd)](_0x5a2401(0x218),{'success':_0x3e5d87[_0x5a2401(0x2cb)](_0x5a2401(0x29a)),'errors':_0x3e5d87[_0x5a2401(0x2cb)](_0x5a2401(0x1ff)),'role':_0x207a95,'profile':_0x37dab8,'master_shop':_0x4e7f7f,'supplier':_0x3ec4ae,'purchase':_0x44ea07,'language':_0x5b8262});}catch(_0x39159a){console[_0x5a2401(0x1f1)](_0x39159a);}}),router[a0_0x54ec11(0x1de)](a0_0x54ec11(0x1df),auth,async(_0xe20df8,_0xc1068f)=>{var _0x3c572c=a0_0x54ec11;try{const {username:_0x484f66,email:_0x1c8706,role:_0x73ad0a}=_0xe20df8['user'],_0x51b493=_0xe20df8[_0x3c572c(0x2c2)],_0x44c38f=await profile[_0x3c572c(0x263)]({'email':_0x51b493[_0x3c572c(0x2ef)]}),_0x1f7631=await master_shop['find']();console[_0x3c572c(0x1f1)]('master',_0x1f7631);const _0x10fb5b=_0xe20df8[_0x3c572c(0x1f8)]['id'];console[_0x3c572c(0x1f1)](_0x10fb5b);const _0x449481=await purchases[_0x3c572c(0x299)](_0x10fb5b);console[_0x3c572c(0x1f1)](_0x3c572c(0x21e),_0x449481);const _0x1fbcef=await product[_0x3c572c(0x2d8)]({}),_0x56b719=await warehouse[_0x3c572c(0x2f6)]([{'$match':{'name':_0x449481[_0x3c572c(0x203)],'room':_0x449481[_0x3c572c(0x2a6)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3c572c(0x2ae),'name':{'$first':_0x3c572c(0x259)},'product_stock':{'$first':_0x3c572c(0x1ef)},'bay':{'$first':_0x3c572c(0x28f)},'bin':{'$first':_0x3c572c(0x2b4)},'type':{'$first':_0x3c572c(0x229)},'floorlevel':{'$first':_0x3c572c(0x2dc)},'primary_code':{'$first':_0x3c572c(0x2ee)},'secondary_code':{'$first':_0x3c572c(0x23a)},'product_code':{'$first':_0x3c572c(0x29c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3c572c(0x26a)}}}]);warehouse_data=await warehouse[_0x3c572c(0x2f6)]([{'$match':{'status':_0x3c572c(0x268),'name':_0x3c572c(0x227),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3c572c(0x2a2),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console[_0x3c572c(0x1f1)]('stock_data',_0x56b719);if(_0x1f7631[0x0]['language']=='English\x20(US)'){var _0x10b67a=users['English'];console[_0x3c572c(0x1f1)](_0x10b67a);}else{if(_0x1f7631[0x0][_0x3c572c(0x280)]=='Hindi')var _0x10b67a=users[_0x3c572c(0x2ca)];else{if(_0x1f7631[0x0][_0x3c572c(0x280)]==_0x3c572c(0x1fa))var _0x10b67a=users['German'];else{if(_0x1f7631[0x0][_0x3c572c(0x280)]==_0x3c572c(0x243))var _0x10b67a=users[_0x3c572c(0x243)];else{if(_0x1f7631[0x0]['language']=='French')var _0x10b67a=users[_0x3c572c(0x21f)];else{if(_0x1f7631[0x0][_0x3c572c(0x280)]=='Portuguese\x20(BR)')var _0x10b67a=users[_0x3c572c(0x258)];else{if(_0x1f7631[0x0][_0x3c572c(0x280)]=='Chinese')var _0x10b67a=users[_0x3c572c(0x240)];else{if(_0x1f7631[0x0][_0x3c572c(0x280)]=='Arabic\x20(ae)')var _0x10b67a=users['Arabic'];}}}}}}}_0xc1068f[_0x3c572c(0x2bd)](_0x3c572c(0x2bf),{'success':_0xe20df8[_0x3c572c(0x2cb)](_0x3c572c(0x29a)),'errors':_0xe20df8[_0x3c572c(0x2cb)](_0x3c572c(0x1ff)),'role':_0x51b493,'profile':_0x44c38f,'user':_0x449481,'stock':_0x56b719,'master_shop':_0x1f7631,'product':_0x1fbcef,'language':_0x10b67a,'warehouse':warehouse_data});}catch(_0x51a0df){console[_0x3c572c(0x1f1)](_0x51a0df);}}),router[a0_0x54ec11(0x27c)](a0_0x54ec11(0x1df),auth,async(_0xdddf46,_0x5d9b1e)=>{var _0x4ec176=a0_0x54ec11;try{const {invoice:_0x4139d5,date:_0x5df334,warehouse_name:_0xe2d402,Room_name:_0x311dc4,product_name:_0x4f9138,purchase_quantity:_0x5ca34e,stocks:_0xe6cfb0,return_qty:_0x42350b,note:_0x310906,level:_0x415169,isle:_0x1e9ae5,pallet:_0xd1103c,to_warehouse_name:_0xb831d2,to_Room_name:_0x7b5203}=_0xdddf46['body'],_0x39f22c=await purchases[_0x4ec176(0x263)]({'_id':_0xdddf46[_0x4ec176(0x1f8)]['id']}),_0x4242b5=await warehouse[_0x4ec176(0x263)]({'name':_0xe2d402,'room':_0x311dc4});if(typeof _0x4f9138==_0x4ec176(0x21d))var _0x34b193=[_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x22e)]],_0x5caee4=[_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x1e0)]],_0x583740=[_0xdddf46[_0x4ec176(0x1f5)]['stocks']],_0x106df3=[_0xdddf46[_0x4ec176(0x1f5)]['return_qty']],_0x315bff=[_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x228)]],_0x77b5b7=[_0xdddf46['body'][_0x4ec176(0x247)]],_0x10a7a2=[_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x2d7)]],_0x5798de=[_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x2b6)]],_0x576822=[_0xdddf46[_0x4ec176(0x1f5)]['product_code_hide']],_0x2b91d5=[_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x27e)]],_0x138515=[_0xdddf46[_0x4ec176(0x1f5)]['secondary_code_hide']];else var _0x34b193=[..._0xdddf46['body'][_0x4ec176(0x22e)]],_0x5caee4=[..._0xdddf46['body'][_0x4ec176(0x1e0)]],_0x583740=[..._0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x267)]],_0x106df3=[..._0xdddf46['body'][_0x4ec176(0x2ed)]],_0x315bff=[..._0xdddf46['body'][_0x4ec176(0x228)]],_0x77b5b7=[..._0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x247)]],_0x10a7a2=[..._0xdddf46[_0x4ec176(0x1f5)]['pallet']],_0x5798de=[..._0xdddf46['body']['types']],_0x576822=[..._0xdddf46[_0x4ec176(0x1f5)]['product_code_hide']],_0x2b91d5=[..._0xdddf46[_0x4ec176(0x1f5)]['primary_code_hide']],_0x138515=[..._0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x285)]];const _0x529fe1=_0x34b193[_0x4ec176(0x25d)](_0x2adfc1=>{return _0x2adfc1={'product_name':_0x2adfc1};});_0x5caee4[_0x4ec176(0x278)]((_0x429bae,_0x28047e)=>{var _0x5375b7=_0x4ec176;_0x529fe1[_0x28047e][_0x5375b7(0x1e0)]=_0x429bae;}),_0x583740['forEach']((_0x250ca2,_0x36c291)=>{var _0x5bd8bd=_0x4ec176;_0x529fe1[_0x36c291][_0x5bd8bd(0x2d2)]=_0x250ca2;}),_0x106df3[_0x4ec176(0x278)]((_0x169b3b,_0x4b40db)=>{_0x529fe1[_0x4b40db]['return_qty']=_0x169b3b;}),_0x315bff['forEach']((_0x50d835,_0x56f574)=>{_0x529fe1[_0x56f574]['bay']=_0x50d835;}),_0x77b5b7[_0x4ec176(0x278)]((_0x1293cd,_0x45775d)=>{var _0x360978=_0x4ec176;_0x529fe1[_0x45775d][_0x360978(0x21b)]=_0x1293cd;}),_0x10a7a2[_0x4ec176(0x278)]((_0x670bd1,_0x3b43fd)=>{var _0x1ba45a=_0x4ec176;_0x529fe1[_0x3b43fd][_0x1ba45a(0x265)]=_0x670bd1;}),_0x5798de[_0x4ec176(0x278)]((_0x110ad9,_0x212c47)=>{var _0x393331=_0x4ec176;_0x529fe1[_0x212c47][_0x393331(0x282)]=_0x110ad9;}),_0x576822[_0x4ec176(0x278)]((_0x4b4228,_0x280047)=>{_0x529fe1[_0x280047]['product_code']=_0x4b4228;}),_0x2b91d5[_0x4ec176(0x278)]((_0x176d31,_0x5e9da8)=>{var _0x296d65=_0x4ec176;_0x529fe1[_0x5e9da8][_0x296d65(0x25e)]=_0x176d31;}),_0x138515[_0x4ec176(0x278)]((_0x2db627,_0x60f98e)=>{var _0x5a3e05=_0x4ec176;_0x529fe1[_0x60f98e][_0x5a3e05(0x204)]=_0x2db627;}),_0x39f22c[_0x4ec176(0x26c)]['forEach'](_0x5afd24=>{var _0x34e585=_0x4ec176;const _0xe01ff8=_0x4242b5[_0x34e585(0x25a)][_0x34e585(0x25d)](_0x9f4bdf=>{var _0x55c59d=_0x34e585;_0x9f4bdf['product_name']==_0x5afd24[_0x55c59d(0x22e)]&&_0x9f4bdf[_0x55c59d(0x265)]==_0x5afd24[_0x55c59d(0x265)]&&_0x9f4bdf[_0x55c59d(0x282)]==_0x5afd24['type']&&_0x9f4bdf[_0x55c59d(0x21b)]==_0x5afd24[_0x55c59d(0x21b)]&&_0x9f4bdf['bay']==_0x5afd24['bay']&&_0x9f4bdf['rack']==_0x5afd24[_0x55c59d(0x2f4)]&&_0x9f4bdf[_0x55c59d(0x1e9)]==_0x5afd24[_0x55c59d(0x1e9)]&&(console[_0x55c59d(0x1f1)](parseInt(_0x9f4bdf[_0x55c59d(0x2f2)])+'\x20<>\x20'+parseInt(_0x5afd24[_0x55c59d(0x256)])),_0x9f4bdf['product_stock']=parseInt(_0x9f4bdf['product_stock'])+parseInt(_0x5afd24['quantity']));});}),await _0x4242b5[_0x4ec176(0x1e7)]();const _0x114cf4=_0x529fe1[_0x4ec176(0x27d)](_0x5d6eb4=>_0x5d6eb4[_0x4ec176(0x2ed)]!=='0'&&_0x5d6eb4[_0x4ec176(0x2ed)]!=='');var _0x18d37e=0x0;_0x114cf4['forEach'](_0x1213ad=>{var _0x3cc4ac=_0x4ec176;console[_0x3cc4ac(0x1f1)]('foreach\x20newproduct',_0x1213ad),(parseInt(_0x1213ad[_0x3cc4ac(0x1e0)])<parseInt(_0x1213ad[_0x3cc4ac(0x2ed)])||parseInt(_0x1213ad[_0x3cc4ac(0x2d2)])<parseInt(_0x1213ad['return_qty']))&&_0x18d37e++;});if(_0x18d37e!=0x0)return _0xdddf46['flash'](_0x4ec176(0x1ff),_0x4ec176(0x2a7)),_0x5d9b1e[_0x4ec176(0x28a)]('back');const _0x3b7d24=new purchases_return({'invoice':_0x4139d5,'suppliers':_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x274)],'date':_0x5df334,'warehouse_name':_0xe2d402,'return_product':_0x114cf4,'note':_0x310906,'room':_0x311dc4,'to_warehouse_name':_0xb831d2,'to_room':_0x7b5203}),_0x40833b=await _0x3b7d24[_0x4ec176(0x1e7)]();console[_0x4ec176(0x1f1)](_0x3b7d24);const _0x31fb5f=await purchases_return[_0x4ec176(0x263)]({'invoice':_0x4139d5}),_0x1ad0bc=await warehouse[_0x4ec176(0x263)]({'name':_0xb831d2,'room':_0x7b5203});_0x31fb5f['return_product'][_0x4ec176(0x278)](_0x7ae287=>{var _0x55f456=_0x4ec176,_0x11efd5=0x0;const _0x2f1a19=_0x1ad0bc[_0x55f456(0x25a)][_0x55f456(0x25d)](_0xd6aed7=>{var _0x3ccd88=_0x55f456;_0xd6aed7[_0x3ccd88(0x22e)]==_0x7ae287[_0x3ccd88(0x22e)]&&_0xd6aed7['floorlevel']==_0x7ae287['floorlevel']&&_0xd6aed7[_0x3ccd88(0x282)]==_0x7ae287[_0x3ccd88(0x282)]&&_0xd6aed7[_0x3ccd88(0x21b)]==_0x7ae287['bin']&&_0xd6aed7[_0x3ccd88(0x2e7)]==_0x7ae287[_0x3ccd88(0x2e7)]&&(_0xd6aed7[_0x3ccd88(0x2f2)]=parseInt(_0xd6aed7[_0x3ccd88(0x2f2)])-parseInt(_0x7ae287[_0x3ccd88(0x2ed)]),_0x11efd5++);});_0x11efd5=='0'&&(_0x1ad0bc[_0x55f456(0x25a)]=_0x1ad0bc['product_details'][_0x55f456(0x27a)]({'product_name':_0x7ae287[_0x55f456(0x22e)],'product_stock':_0x7ae287[_0x55f456(0x2ed)],'primary_code':_0x7ae287[_0x55f456(0x25e)],'secondary_code':_0x7ae287[_0x55f456(0x204)],'product_code':_0x7ae287[_0x55f456(0x1ed)],'storage':_0x7ae287[_0x55f456(0x1e9)],'rack':_0x7ae287[_0x55f456(0x2f4)],'bay':_0x7ae287['bay'],'bin':_0x7ae287['bin'],'type':_0x7ae287[_0x55f456(0x282)],'floorlevel':_0x7ae287[_0x55f456(0x265)],'maxProducts':_0x7ae287['maxStocks'],'unit':_0x7ae287[_0x55f456(0x29d)],'secondary_unit':_0x7ae287[_0x55f456(0x209)],'expiry_date':_0x7ae287[_0x55f456(0x1e8)]}));}),await _0x1ad0bc[_0x4ec176(0x1e7)]();const _0x19ae6f=await purchases[_0x4ec176(0x263)]({'invoice':_0x4139d5});_0x19ae6f[_0x4ec176(0x2c1)]=_0x4ec176(0x1fb);const _0x1c790a=await _0x19ae6f[_0x4ec176(0x1e7)](),_0x3b184d=new s_payment_data({'invoice':_0x4139d5,'suppliers':_0xdddf46[_0x4ec176(0x1f5)][_0x4ec176(0x274)],'reason':'Purchase\x20Return'});await _0x3b184d[_0x4ec176(0x1e7)]();const _0x50f622=await master_shop[_0x4ec176(0x2d8)]();console[_0x4ec176(0x1f1)](_0x4ec176(0x2a3),_0x50f622[0x0][_0x4ec176(0x2d6)]);const _0x22437c=await email_settings['findOne'](),_0x5a6471=await suppliers[_0x4ec176(0x263)]({'name':_0xdddf46['body'][_0x4ec176(0x274)]});console[_0x4ec176(0x1f1)](_0x4ec176(0x283),_0x5a6471);_0x50f622[0x0][_0x4ec176(0x206)]==0x1?(right_currency=_0x50f622[0x0][_0x4ec176(0x237)],left_currency=''):(right_currency='',left_currency=_0x50f622[0x0][_0x4ec176(0x237)]);var _0x1d72a6=_0x34b193,_0x24d8fc=_0x106df3,_0x4d1ab5='',_0x2f9eeb;for(_0x2f9eeb in _0x1d72a6){_0x4d1ab5+=_0x4ec176(0x2c4)+_0x4ec176(0x289)+_0x1d72a6[_0x2f9eeb]+_0x4ec176(0x200)+_0x4ec176(0x289)+_0x24d8fc[_0x2f9eeb]+_0x4ec176(0x200)+_0x4ec176(0x2b7);}console['log'](_0x4ec176(0x253),_0x4d1ab5);let _0x2a9638=nodemailer['createTransport']({'service':'gmail','auth':{'user':_0x22437c[_0x4ec176(0x2ef)],'pass':_0x22437c[_0x4ec176(0x2ea)]}}),_0xa75498={'from':_0x22437c['email'],'to':_0x5a6471[_0x4ec176(0x2ef)],'subject':'Purchase\x20Return\x20Mail','attachments':[{'filename':_0x4ec176(0x293),'path':__dirname+_0x4ec176(0x2be)+_0x4ec176(0x246)+_0x50f622[0x0][_0x4ec176(0x2d6)],'cid':'logo'}],'html':_0x4ec176(0x225)+_0x4ec176(0x205)+'</head><body>'+'<div>'+_0x4ec176(0x1e3)+'<div>'+_0x4ec176(0x1ea)+_0x4ec176(0x20d)+_0x4ec176(0x26b)+_0x4ec176(0x1dd)+_0x50f622[0x0]['site_title']+_0x4ec176(0x22c)+'</div>'+'</div>'+_0x4ec176(0x2bc)+'<div>'+_0x4ec176(0x234)+_0x4ec176(0x2f3)+_0x4139d5+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x4ec176(0x28d)+_0x5df334+'\x20'+'</span>'+_0x4ec176(0x292)+_0x4ec176(0x20d)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4ec176(0x272)+_0x4ec176(0x2c4)+_0x4ec176(0x260)+_0x4ec176(0x2a0)+_0x4ec176(0x2b5)+_0x4ec176(0x230)+'</tr>'+_0x4ec176(0x2a8)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4d1ab5+'\x20'+'</tbody>'+_0x4ec176(0x2e9)+_0x4ec176(0x26b)+'<strong>\x20Regards\x20</strong>'+_0x4ec176(0x24c)+_0x50f622[0x0][_0x4ec176(0x1f0)]+'</h5>'+'</div>'+_0x4ec176(0x20d)+_0x4ec176(0x2db)};_0x2a9638[_0x4ec176(0x2e5)](_0xa75498,function(_0x134734,_0x31aeca){var _0x408923=_0x4ec176;_0x134734?(console['log'](_0x134734),console[_0x408923(0x1f1)](_0x408923(0x1f6))):console[_0x408923(0x1f1)]('Email\x20sent\x20successfully');}),_0xdddf46[_0x4ec176(0x2cb)]('success',_0x4ec176(0x2b0)),_0x5d9b1e[_0x4ec176(0x28a)](_0x4ec176(0x2de));}catch(_0x4e77bb){console[_0x4ec176(0x1f1)](_0x4e77bb),_0x5d9b1e[_0x4ec176(0x254)](0xc8)['json']({'message':_0x4e77bb['message']});}}),router['get'](a0_0x54ec11(0x2b1),auth,async(_0x4ab661,_0x1b9e80)=>{var _0x5f466b=a0_0x54ec11;try{const {username:_0x2b8891,email:_0xf95943,role:_0x31fdb3}=_0x4ab661[_0x5f466b(0x2c2)],_0x49bfa2=_0x4ab661[_0x5f466b(0x2c2)],_0x2972eb=await profile[_0x5f466b(0x263)]({'email':_0x49bfa2['email']}),_0xf4d23c=await master_shop[_0x5f466b(0x2d8)](),_0x54432c=_0x4ab661[_0x5f466b(0x1f8)]['id'],_0x184246=await purchases[_0x5f466b(0x299)](_0x54432c);if(_0xf4d23c[0x0][_0x5f466b(0x280)]==_0x5f466b(0x296))var _0x2a1b53=users[_0x5f466b(0x264)];else{if(_0xf4d23c[0x0][_0x5f466b(0x280)]==_0x5f466b(0x2ca))var _0x2a1b53=users[_0x5f466b(0x2ca)];else{if(_0xf4d23c[0x0][_0x5f466b(0x280)]==_0x5f466b(0x1fa))var _0x2a1b53=users[_0x5f466b(0x1fa)];else{if(_0xf4d23c[0x0][_0x5f466b(0x280)]==_0x5f466b(0x243))var _0x2a1b53=users[_0x5f466b(0x243)];else{if(_0xf4d23c[0x0]['language']==_0x5f466b(0x21f))var _0x2a1b53=users[_0x5f466b(0x21f)];else{if(_0xf4d23c[0x0][_0x5f466b(0x280)]==_0x5f466b(0x2e2))var _0x2a1b53=users['Portuguese'];else{if(_0xf4d23c[0x0][_0x5f466b(0x280)]=='Chinese')var _0x2a1b53=users[_0x5f466b(0x240)];else{if(_0xf4d23c[0x0][_0x5f466b(0x280)]=='Arabic\x20(ae)')var _0x2a1b53=users[_0x5f466b(0x271)];}}}}}}}_0x1b9e80[_0x5f466b(0x2bd)]('all_purchases_barcode',{'success':_0x4ab661[_0x5f466b(0x2cb)]('success'),'errors':_0x4ab661[_0x5f466b(0x2cb)]('errors'),'role':_0x49bfa2,'profile':_0x2972eb,'alldata':_0x184246,'master_shop':_0xf4d23c,'language':_0x2a1b53}),console[_0x5f466b(0x1f1)](alldata);}catch(_0x55090e){console['log'](_0x55090e);}}),router[a0_0x54ec11(0x27c)](a0_0x54ec11(0x223),async(_0x3decb0,_0xf93eac)=>{var _0x5d47ff=a0_0x54ec11;const {product_code:_0x5a21fe}=_0x3decb0[_0x5d47ff(0x1f5)];var _0x39ce6a;const _0x257c59=await product[_0x5d47ff(0x2f6)]([{'$match':{'primary_code':_0x5a21fe,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x5d47ff(0x22f),'name':{'$first':'$name'},'category':{'$first':_0x5d47ff(0x28b)},'brand':{'$first':_0x5d47ff(0x29e)},'unit':{'$first':_0x5d47ff(0x24a)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x5d47ff(0x298)},'primary_code':{'$first':_0x5d47ff(0x22d)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x5d47ff(0x2c0)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x4c17f0=await product[_0x5d47ff(0x2f6)]([{'$match':{'secondary_code':_0x5a21fe,'product_category':_0x5d47ff(0x23d)}},{'$group':{'_id':_0x5d47ff(0x22f),'name':{'$first':_0x5d47ff(0x2a2)},'category':{'$first':_0x5d47ff(0x28b)},'brand':{'$first':_0x5d47ff(0x29e)},'unit':{'$first':_0x5d47ff(0x24a)},'alertquantity':{'$first':_0x5d47ff(0x213)},'product_code':{'$first':_0x5d47ff(0x298)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x5d47ff(0x24e)},'maxStocks':{'$first':_0x5d47ff(0x2c0)},'maxProdPerUnit':{'$first':_0x5d47ff(0x2da)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x257c59[_0x5d47ff(0x235)]>0x0)_0x39ce6a=_0x257c59;else _0x4c17f0[_0x5d47ff(0x235)]>0x0&&(_0x39ce6a=_0x4c17f0);_0xf93eac[_0x5d47ff(0x290)](_0x39ce6a);}),router[a0_0x54ec11(0x27c)](a0_0x54ec11(0x221),async(_0x558578,_0x4c3ef2)=>{var _0x5afa31=a0_0x54ec11;const {primaryCode:_0x5dc3d7,secondaryCode:_0x4dbfe8,productCode:_0x5c9075,bay:_0x5c6528,bin:_0x32368f,types:_0x362579,pallet:_0x1f2239,warehouses:_0x370cb8,room:_0x493927}=_0x558578[_0x5afa31(0x1f5)];console[_0x5afa31(0x1f1)](_0x558578[_0x5afa31(0x1f5)]);try{const _0x22612f=await warehouse['aggregate']([{'$match':{'name':_0x370cb8,'room':_0x493927}},{'$unwind':_0x5afa31(0x2d3)},{'$match':{'product_details.bay':_0x5c6528,'product_details.bin':_0x32368f,'product_details.type':_0x362579}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5afa31(0x259)},'product_stock':{'$first':_0x5afa31(0x1ef)},'level':{'$first':_0x5afa31(0x201)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x5afa31(0x26f)}}}]);_0x4c3ef2[_0x5afa31(0x254)](0xc8)[_0x5afa31(0x290)](_0x22612f);}catch(_0x1a08ad){_0x4c3ef2[_0x5afa31(0x254)](0x194)[_0x5afa31(0x290)]({'message':_0x1a08ad[_0x5afa31(0x25b)]});}}),module[a0_0x54ec11(0x2d5)]=router;