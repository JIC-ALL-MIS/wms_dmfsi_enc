function a0_0x5bdf(){var _0x2e26f5=['3srnefn','Enclosed','15342qddBGf','/all_purchases/view','../models/all_models','\x20<\x20wew\x20>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','max_product_unit','Hindi','amount','\x20<>\x20','exports','stocks','</td>','aggregate','types','finalize','Rack\x20B','$product','$secondary_code','staff','/preview/:id','/CheckingWarehouse','room_name','$product.type','$product_details.product_code','all_purchases','$batch_code','getDate','</h5>','purchase_quantity','site_title','English','<strong>\x20Regards\x20</strong>','return_data','$expiry_date','express','11924PEgUWv','batch_code','createTransport','warehouse_name','product_cat','/../public','back','prod_code','flash','$product.bay','params','maxStocks','</table>','309032XTJHQq','language','user','Rack\x20F','delivery_date','prod_name','warehouse','POnumber','<!DOCTYPE\x20html>','secondary_code_hide','MaxStocks_data','Purchase\x20Mail','/view','$product_details._id','$due_amount','room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view/add_purchases/:id','$secondary_unit','prod_qty','COLD\x20STORAGE','$maxProdPerUnit','product_name','body','edit_purchases','474632LjabfC','$maxStocks','getMonth','prod_primunit','Enabled','prod_level','type','master','$warehouse_name','quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','\x20Order\x20Date\x20:\x20','Arabic','Return\x20Goods','46RftVqz','/all_purchases/view/','post','An\x20error\x20occurred.','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','<table\x20style=\x22width:\x20100%\x20!important;\x22>','get','Logo.png','product_code_hide','$product_details.type','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','string','product_list','purchase_invoice','findOne','Portuguese','stock_quantity','floorlevel','27214ojOUwb','$invoice','JO_number','$category','$product_details.secondary_code','<tbody\x20style=\x22text-align:\x20center;\x22>','French','$product_details.storage','$product_details.floorlevel','ejs','DRY\x20STORAGE','Portuguese\x20(BR)','product_stock','status','host','<hr\x20class=\x22my-3\x22>','bay','pallet','delivery_code','$alertquantity','Raw\x20Materials','foreach\x20newproduct','11196asDupX','$product_details.maxProducts','Purchase\x20Return','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','rack','$product_details.level','gmail','Level','all','<h2>\x20','actual_qty','length','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','bin','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','1185QOXwBE','$return_data','log','German','render','maxperunit','Error\x20Occurs','Arabic\x20(ae)','error','$product_details.product_stock','Floor','$product_details.expiry_date','$product_details.rack','secondary_code','Router','note','secondary_unit','level','success','product_code','return_product','prod_invoice','errors','stock_data','forEach','sendMail','prod_secondunit','/barcode/:id','An\x20error\x20occurred\x20while\x20saving\x20data.','prod_isle','/view/add_purchases','Room_name','email','padStart','$date','1981480HaSJjf','findById','suppliers','message','</div>','\x20Order\x20Number\x20:\x20','primary_code','name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','alertQTY','Receiving\x20Area','getFullYear','Spanish','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<tr>','port','return_qty','product','<html><head><title></title>','due_amount','prod_pallet','prod_Qty','$product_details','Shelves','date','$name','map','$note','user_id','save','Rack\x20D','/upload/','deliverycode','INC-','add\x20post','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','English\x20(US)','logo','redirect','password','slice','$product_details.product_name','5240424iHLVqn','json','paid_amount','$brand','$product_details.isle','</tr>','/barcode_scanner','$product_details.bay','<h5\x20style=\x22text-align:\x20left;\x22>','concat','</thead>','production_date','return_purchase','then','171JbKGYA','$product.bin','$product.quantity','Chinese','</tbody>','Rack\x20C','../public/language/languages.json','path','Email\x20sent\x20successfully','$product_details.bin','$suppliers_docs','$primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/view/:id','isle','$suppliers','$product_details.primary_code','$_id','Rack\x20E','<span\x20style=\x22float:\x20right;\x22>','currency','<div>','Rack\x20A','catch','prod_unit','$product_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','expiry_date','</body></html>','$product.room_name','suppliers_data','standard_unit','$unit','\x20</h2>','primary_code_hide','storage','filter','invoice','find','rak','image','role','suppliers_docs'];a0_0x5bdf=function(){return _0x2e26f5;};return a0_0x5bdf();}var a0_0x48db59=a0_0x570f;(function(_0x4b8aac,_0x4be996){var _0x11b114=a0_0x570f,_0x3e1f4d=_0x4b8aac();while(!![]){try{var _0x2b24ff=parseInt(_0x11b114(0x140))/0x1*(parseInt(_0x11b114(0x174))/0x2)+parseInt(_0x11b114(0x11b))/0x3*(parseInt(_0x11b114(0x166))/0x4)+-parseInt(_0x11b114(0x94))/0x5*(parseInt(_0x11b114(0x11d))/0x6)+-parseInt(_0x11b114(0xe2))/0x7+-parseInt(_0x11b114(0x14d))/0x8*(parseInt(_0x11b114(0xf0))/0x9)+-parseInt(_0x11b114(0xb7))/0xa+-parseInt(_0x11b114(0x186))/0xb*(-parseInt(_0x11b114(0x84))/0xc);if(_0x2b24ff===_0x4be996)break;else _0x3e1f4d['push'](_0x3e1f4d['shift']());}catch(_0x128aaf){_0x3e1f4d['push'](_0x3e1f4d['shift']());}}}(a0_0x5bdf,0x652cc));const express=require(a0_0x48db59(0x13f)),app=express(),router=express[a0_0x48db59(0xa2)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x48db59(0x11f)),auth=require('../middleware/auth'),nodemailer=require('nodemailer');var ejs=require(a0_0x48db59(0x18f));const path=require(a0_0x48db59(0xf7)),users=require(a0_0x48db59(0xf6));function a0_0x570f(_0x18001c,_0x14773b){var _0x5bdf61=a0_0x5bdf();return a0_0x570f=function(_0x570fc,_0x31fc9c){_0x570fc=_0x570fc-0x82;var _0x3e530a=_0x5bdf61[_0x570fc];return _0x3e530a;},a0_0x570f(_0x18001c,_0x14773b);}router[a0_0x48db59(0x17a)](a0_0x48db59(0x159),auth,async(_0x10c0bf,_0x4ebe95)=>{var _0x148b70=a0_0x48db59;try{const {username:_0x491248,email:_0x3beb70,role:_0x4aa74f}=_0x10c0bf['user'],_0x1880d6=_0x10c0bf['user'],_0x22cb08=await profile[_0x148b70(0x182)]({'email':_0x1880d6[_0x148b70(0xb4)]}),_0xa0bcce=await staff[_0x148b70(0x182)]({'email':_0x1880d6[_0x148b70(0xb4)]});if(_0x1880d6['role']==_0x148b70(0x12f)){const _0x549937=await staff[_0x148b70(0x182)]({'email':_0x1880d6[_0x148b70(0xb4)]});}const _0x569ee5=await master_shop['find']();let _0x268204;if(_0x1880d6[_0x148b70(0x119)]==_0x148b70(0x12f)){const _0x293951=await staff[_0x148b70(0x182)]({'email':_0x1880d6[_0x148b70(0xb4)]});_0x268204=await purchases[_0x148b70(0x129)]([{'$match':{'warehouse_name':_0x293951[_0x148b70(0x153)]}},{'$lookup':{'from':_0x148b70(0xb9),'localField':_0x148b70(0xb9),'foreignField':_0x148b70(0xbe),'as':_0x148b70(0x11a)}},{'$unwind':_0x148b70(0xfa)},{'$unwind':'$product'},{'$group':{'_id':_0x148b70(0x101),'invoice':{'$first':_0x148b70(0x187)},'suppliers':{'$first':_0x148b70(0xff)},'date':{'$first':_0x148b70(0xb6)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$first':'$room'},'product':{'$push':'$product'},'note':{'$first':_0x148b70(0xd2)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x148b70(0x15b)},'return_data':{'$first':_0x148b70(0x95)},'batch_code':{'$first':_0x148b70(0x136)},'expiry_date':{'$first':_0x148b70(0x13e)},'suppliers_docs':{'$first':_0x148b70(0xfa)},'total_product_quantity':{'$sum':_0x148b70(0xf2)},'level':{'$addToSet':_0x148b70(0x149)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x148b70(0x133)},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x268204=await purchases[_0x148b70(0x129)]([{'$lookup':{'from':_0x148b70(0xb9),'localField':_0x148b70(0xb9),'foreignField':_0x148b70(0xbe),'as':'suppliers_docs'}},{'$unwind':_0x148b70(0xfa)},{'$unwind':_0x148b70(0x12d)},{'$group':{'_id':_0x148b70(0x101),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0x148b70(0xff)},'date':{'$first':_0x148b70(0xb6)},'warehouse_name':{'$first':_0x148b70(0x16e)},'room':{'$addToSet':_0x148b70(0x10d)},'product':{'$push':_0x148b70(0x12d)},'note':{'$first':_0x148b70(0xd2)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x148b70(0x15b)},'return_data':{'$first':_0x148b70(0x95)},'batch_code':{'$first':_0x148b70(0x136)},'expiry_date':{'$first':_0x148b70(0x13e)},'suppliers_docs':{'$first':_0x148b70(0xfa)},'total_product_quantity':{'$sum':_0x148b70(0xf2)},'level':{'$addToSet':_0x148b70(0x149)},'isle':{'$addToSet':_0x148b70(0xf1)},'type':{'$addToSet':_0x148b70(0x133)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x569ee5[0x0][_0x148b70(0x14e)]=='English\x20(US)'){var _0x3e6723=users['English'];console[_0x148b70(0x96)](_0x3e6723);}else{if(_0x569ee5[0x0][_0x148b70(0x14e)]=='Hindi')var _0x3e6723=users[_0x148b70(0x123)];else{if(_0x569ee5[0x0]['language']=='German')var _0x3e6723=users['German'];else{if(_0x569ee5[0x0][_0x148b70(0x14e)]==_0x148b70(0xc3))var _0x3e6723=users[_0x148b70(0xc3)];else{if(_0x569ee5[0x0][_0x148b70(0x14e)]==_0x148b70(0x18c))var _0x3e6723=users[_0x148b70(0x18c)];else{if(_0x569ee5[0x0][_0x148b70(0x14e)]==_0x148b70(0x191))var _0x3e6723=users[_0x148b70(0x183)];else{if(_0x569ee5[0x0][_0x148b70(0x14e)]==_0x148b70(0xf3))var _0x3e6723=users[_0x148b70(0xf3)];else{if(_0x569ee5[0x0][_0x148b70(0x14e)]==_0x148b70(0x9b))var _0x3e6723=users['Arabic'];}}}}}}}_0x4ebe95[_0x148b70(0x98)](_0x148b70(0x135),{'success':_0x10c0bf[_0x148b70(0x148)]('success'),'errors':_0x10c0bf['flash'](_0x148b70(0xaa)),'purchases':_0x268204,'role':_0x1880d6,'profile':_0x22cb08,'master_shop':_0x569ee5,'language':_0x3e6723});}catch(_0x96d553){console['log']('table\x20page',_0x96d553),_0x4ebe95[_0x148b70(0x193)](0xc8)[_0x148b70(0xe3)]({'message':_0x96d553[_0x148b70(0xba)]});}});function BayBinSelected(_0x5a7d31,_0x4677bf){var _0x53fad5=a0_0x48db59,_0x306340=[],_0x4d263d=[],_0x325ffa=[],_0x37a48e=[],_0x49d7a0=[],_0x4072d2=[];let _0x5a816e=[];if(_0x5a7d31==_0x53fad5(0x190))switch(_0x4677bf){case'Rack\x20A':_0x306340=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4d263d=[0x1,0x2],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=[_0x53fad5(0x8b),_0x53fad5(0x9e)],_0x49d7a0=['D'],_0x4072d2=['A'];break;case _0x53fad5(0x12c):_0x306340=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4d263d=[0x1,0x2],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=[_0x53fad5(0x8b),_0x53fad5(0x9e)],_0x49d7a0=['D'],_0x4072d2=['B'];break;case _0x53fad5(0xce):_0x306340=[0x0],_0x4d263d=[0x0],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=[_0x53fad5(0x9e)],_0x49d7a0=['D'],_0x4072d2=['S'];break;case _0x53fad5(0xc1):_0x306340=[0x0],_0x4d263d=[0x0],_0x37a48e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x325ffa=[_0x53fad5(0x9e)],_0x49d7a0=['D'],_0x4072d2=['R'];break;}else{if(_0x5a7d31==_0x53fad5(0x161))switch(_0x4677bf){case _0x53fad5(0x106):_0x306340=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4d263d=['B','F'],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=[_0x53fad5(0x8b),_0x53fad5(0x9e)],_0x49d7a0=['C'],_0x4072d2=['A'];break;case'Rack\x20B':_0x306340=[0x5,0x4,0x3,0x2,0x1],_0x4d263d=['F','B','S'],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=['Level',_0x53fad5(0x9e)],_0x49d7a0=['C'],_0x4072d2=['B'];break;case _0x53fad5(0xf5):_0x306340=[0x1,0x2,0x3,0x4,0x5],_0x4d263d=['B','F','S'],_0x37a48e=[0x5,0x4,0x3,0x2,0x1],_0x325ffa=['Level',_0x53fad5(0x9e)],_0x49d7a0=['C'],_0x4072d2=['C'];break;case _0x53fad5(0xd5):_0x306340=[0x5,0x4,0x3,0x2,0x1],_0x4d263d=['F','B','S'],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=[_0x53fad5(0x8b),_0x53fad5(0x9e)],_0x49d7a0=['C'],_0x4072d2=['D'];break;case _0x53fad5(0x102):_0x306340=[0x4,0x3,0x2,0x1],_0x4d263d=[0x1,0x2],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=[_0x53fad5(0x8b),_0x53fad5(0x9e)],_0x49d7a0=['C'],_0x4072d2=['E'];break;case _0x53fad5(0x150):_0x306340=[0x1,0x2,0x3],_0x4d263d=[0x1,0x2],_0x37a48e=[0x1,0x2,0x3,0x4,0x5],_0x325ffa=[_0x53fad5(0x8b)],_0x49d7a0=['C'],_0x4072d2=['F'];break;}}return{'levels':_0x306340,'Isle':_0x4d263d,'rack':_0x37a48e,'type':_0x325ffa,'storage':_0x49d7a0,'rak':_0x4072d2};}async function getRandom8DigitNumber(){var _0x51413e=a0_0x48db59;const _0x18075c=0x989680,_0x4227ee=0x5f5e0ff,_0x336069=Math['floor'](Math['random']()*(_0x4227ee-_0x18075c+0x1))+_0x18075c;var _0x470cfd;const _0x188e65=await purchases['findOne']({'invoice':_0x51413e(0xd8)+_0x336069});return _0x188e65&&_0x188e65[_0x51413e(0x8f)]>0x0?_0x470cfd=_0x51413e(0xd8)+_0x336069:_0x470cfd='INC-'+_0x336069,_0x470cfd;}router[a0_0x48db59(0x17a)](a0_0x48db59(0xb2),auth,async(_0x3bb681,_0x382cbb)=>{var _0x2de98f=a0_0x48db59;try{const {username:_0x5e637a,email:_0x46dead,role:_0x1f0ad1}=_0x3bb681['user'],_0x57e3b0=_0x3bb681['user'],_0x208367=await profile[_0x2de98f(0x182)]({'email':_0x57e3b0['email']}),_0x18c1df=await master_shop[_0x2de98f(0x116)](),_0x1f812c=await staff[_0x2de98f(0x182)]({'email':_0x57e3b0[_0x2de98f(0xb4)]}),_0x346223=await suppliers[_0x2de98f(0x116)]({});let _0x39ce44;if(_0x57e3b0[_0x2de98f(0x119)]==_0x2de98f(0x12f)){const _0x3954a8=await staff[_0x2de98f(0x182)]({'email':_0x57e3b0['email']});_0x39ce44=await warehouse[_0x2de98f(0x129)]([{'$match':{'status':_0x2de98f(0x16a),'name':_0x3954a8['warehouse'],'warehouse_category':_0x2de98f(0x82),'name':{'$ne':_0x2de98f(0x173)}}},{'$group':{'_id':'$name','name':{'$first':_0x2de98f(0xd0)}}}]);}else _0x39ce44=await warehouse[_0x2de98f(0x129)]([{'$match':{'status':'Enabled','warehouse_category':_0x2de98f(0x82),'name':{'$ne':_0x2de98f(0x173)}}},{'$group':{'_id':_0x2de98f(0xd0),'name':{'$first':'$name'}}}]);const _0x29170d=await product[_0x2de98f(0x116)]({}),_0x105779=await warehouse[_0x2de98f(0x116)]({'status':_0x2de98f(0x16a)}),_0x29ede1=await purchases['find']({}),_0x2af646=_0x29ede1[_0x2de98f(0x8f)]+0x1,_0x40cba7=_0x2de98f(0xd8)+_0x2af646['toString']()[_0x2de98f(0xb5)](0x5,'0');var _0x37006d=['Ambient',_0x2de98f(0x11c)];if(_0x18c1df[0x0][_0x2de98f(0x14e)]==_0x2de98f(0xdc))var _0x3d0e7a=users['English'];else{if(_0x18c1df[0x0][_0x2de98f(0x14e)]==_0x2de98f(0x123))var _0x3d0e7a=users[_0x2de98f(0x123)];else{if(_0x18c1df[0x0][_0x2de98f(0x14e)]==_0x2de98f(0x97))var _0x3d0e7a=users[_0x2de98f(0x97)];else{if(_0x18c1df[0x0][_0x2de98f(0x14e)]==_0x2de98f(0xc3))var _0x3d0e7a=users[_0x2de98f(0xc3)];else{if(_0x18c1df[0x0][_0x2de98f(0x14e)]==_0x2de98f(0x18c))var _0x3d0e7a=users[_0x2de98f(0x18c)];else{if(_0x18c1df[0x0][_0x2de98f(0x14e)]=='Portuguese\x20(BR)')var _0x3d0e7a=users[_0x2de98f(0x183)];else{if(_0x18c1df[0x0][_0x2de98f(0x14e)]==_0x2de98f(0xf3))var _0x3d0e7a=users['Chinese'];else{if(_0x18c1df[0x0]['language']==_0x2de98f(0x9b))var _0x3d0e7a=users[_0x2de98f(0x172)];}}}}}}}const _0x1283e3=getRandom8DigitNumber();_0x1283e3[_0x2de98f(0xef)](_0x59a7fe=>{var _0x2bc469=_0x2de98f;_0x382cbb[_0x2bc469(0x98)]('add_purchases',{'success':_0x3bb681[_0x2bc469(0x148)](_0x2bc469(0xa6)),'errors':_0x3bb681[_0x2bc469(0x148)](_0x2bc469(0xaa)),'role':_0x57e3b0,'profile':_0x208367,'suppliers':_0x346223,'warehouse':_0x39ce44,'product':_0x29170d,'invoice':_0x59a7fe,'master_shop':_0x18c1df,'language':_0x3d0e7a,'find_data':_0x105779,'rooms_data':_0x37006d});})[_0x2de98f(0x107)](_0x44f660=>{var _0x219d1d=_0x2de98f;_0x3bb681[_0x219d1d(0x148)]('errors',_0x219d1d(0xbf)),_0x382cbb[_0x219d1d(0xde)](_0x219d1d(0x11e));});}catch(_0xa5f6b){console['log'](_0xa5f6b);}}),router['get'](a0_0x48db59(0x15e),auth,async(_0x443cb7,_0xa15741)=>{var _0x5c0502=a0_0x48db59;try{const _0x258130=_0x443cb7[_0x5c0502(0x14a)]['id'];console['log'](_0x258130);const _0xa21bcc=await master_shop[_0x5c0502(0x116)]();console[_0x5c0502(0x96)](_0x5c0502(0x16d),_0xa21bcc);const _0x4886f2=await product[_0x5c0502(0x182)]({'name':_0x258130});console[_0x5c0502(0x96)](_0x5c0502(0xc8),_0x4886f2),_0xa15741[_0x5c0502(0x193)](0xc8)[_0x5c0502(0xe3)]({'product_data':_0x4886f2,'master':_0xa21bcc});}catch(_0x46f13c){console[_0x5c0502(0x96)]('add_purchases\x20error',_0x46f13c);}}),router['post']('/view/add_purchases',auth,async(_0x9f801b,_0x24f54d)=>{var _0x23b6bd=a0_0x48db59;try{const {invoice:_0x4ef0f3,date:_0x59745a,warehouse_name:_0x191644,prod_name:_0x57110f,prod_code:_0x437504,prod_qty:_0x21b374,prod_unit:_0x5b65c8,prod_secondunit:_0x316452,prod_level:_0xc960a3,prod_isle:_0x1fdcbc,prod_pallet:_0x537b6b,note:_0x4fffe5,expiry_date:_0x277e16,batch_code:_0xe35461,payable:_0x2d6d99,due_amount:_0x4551b4,Room_name:_0x187026,primary_code:_0x1269c1,secondary_code:_0x397050,MaxStocks_data:_0x32cf94,PO_number:_0x5ef6ad,SCRN:_0x2cc3cf,JO_number:_0x104563}=_0x9f801b[_0x23b6bd(0x164)];if(typeof _0x57110f==_0x23b6bd(0x17f))var _0x5f374b=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x152)]],_0x25c117=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x147)]],_0x5db02d=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xcc)]],_0x5810fb=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x169)]],_0xe2ba41=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xae)]],_0x4847ea=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x16b)]],_0x51bd0f=[_0x9f801b['body']['primary_code']],_0x1daa77=[_0x9f801b['body'][_0x23b6bd(0xa1)]],_0x3a8287=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x157)]],_0xb42063=[_0x9f801b['body'][_0x23b6bd(0x141)]],_0x3c529f=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x10b)]],_0x22e616=[_0x9f801b['body'][_0x23b6bd(0x122)]],_0xe9b114=[_0x9f801b['body'][_0x23b6bd(0xc0)]],_0x127a83=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xed)]],_0x7886f2=[_0x9f801b[_0x23b6bd(0x164)]['prod_cat']],_0x491d0c=[_0x9f801b[_0x23b6bd(0x164)]['RoomAssign']],_0x4909b7=[_0x9f801b[_0x23b6bd(0x164)]['deliverycode']],_0x5359f5=[_0x9f801b[_0x23b6bd(0x164)]['prod_invoice']],_0x26cf2c=[_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x8e)]];else var _0x5f374b=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x152)]],_0x25c117=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x147)]],_0x5db02d=[..._0x9f801b['body'][_0x23b6bd(0xcc)]],_0x5810fb=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x169)]],_0xe2ba41=[..._0x9f801b[_0x23b6bd(0x164)]['prod_secondunit']],_0x4847ea=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x16b)]],_0x51bd0f=[..._0x9f801b['body'][_0x23b6bd(0xbd)]],_0x1daa77=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xa1)]],_0x3a8287=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x157)]],_0xb42063=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x141)]],_0x3c529f=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x10b)]],_0x22e616=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0x122)]],_0xe9b114=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xc0)]],_0x127a83=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xed)]],_0x7886f2=[..._0x9f801b[_0x23b6bd(0x164)]['prod_cat']],_0x491d0c=[..._0x9f801b[_0x23b6bd(0x164)]['RoomAssign']],_0x4909b7=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xd7)]],_0x5359f5=[..._0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xa9)]],_0x26cf2c=[..._0x9f801b['body'][_0x23b6bd(0x8e)]];const _0x40f973=_0x5f374b[_0x23b6bd(0xd1)](_0x55cdb9=>{return _0x55cdb9={'product_name':_0x55cdb9};});_0x26cf2c[_0x23b6bd(0xac)]((_0x516cce,_0x5e9fcb)=>{_0x40f973[_0x5e9fcb]['actual_qty']=_0x516cce;}),_0x25c117[_0x23b6bd(0xac)]((_0x3722e8,_0x355cb0)=>{var _0x5f23a2=_0x23b6bd;_0x40f973[_0x355cb0][_0x5f23a2(0xa7)]=_0x3722e8;}),_0x5db02d[_0x23b6bd(0xac)]((_0x531574,_0x337ce2)=>{var _0x3cc6c1=_0x23b6bd;_0x40f973[_0x337ce2][_0x3cc6c1(0x16f)]=_0x531574;}),_0x5810fb[_0x23b6bd(0xac)]((_0x50f99c,_0x3cbbef)=>{_0x40f973[_0x3cbbef]['standard_unit']=_0x50f99c;}),_0xe2ba41[_0x23b6bd(0xac)]((_0x318d02,_0x2c94c4)=>{_0x40f973[_0x2c94c4]['secondary_unit']=_0x318d02;}),_0x4847ea['forEach']((_0x56d2,_0x3e692d)=>{_0x491d0c['forEach']((_0x176c04,_0x28c7f0)=>{var _0xf8ba4f=a0_0x570f;if(_0x176c04==_0xf8ba4f(0xc1)&&_0x3e692d==_0x28c7f0){console['log'](_0x176c04+_0xf8ba4f(0x120)+_0x3e692d+_0xf8ba4f(0x125)+_0x28c7f0+_0xf8ba4f(0x125)+_0x56d2);var _0x267db7=_0x56d2[_0xf8ba4f(0xe0)](0x3);_0x40f973[_0x3e692d][_0xf8ba4f(0x113)]=_0x56d2[0x0],_0x40f973[_0x3e692d]['rack']=_0x56d2[0x1],_0x40f973[_0x3e692d]['bay']=0x0,_0x40f973[_0x3e692d][_0xf8ba4f(0x92)]=0x0,_0x40f973[_0x3e692d][_0xf8ba4f(0x16c)]='Floor',_0x40f973[_0x3e692d]['floorlevel']=_0x267db7;}else{if(_0x176c04==_0xf8ba4f(0xce)&&_0x3e692d==_0x28c7f0){var _0x267db7=_0x56d2[_0xf8ba4f(0xe0)](0x3);_0x40f973[_0x3e692d][_0xf8ba4f(0x113)]=_0x56d2[0x0],_0x40f973[_0x3e692d][_0xf8ba4f(0x88)]=_0x56d2[0x1],_0x40f973[_0x3e692d][_0xf8ba4f(0x196)]=0x0,_0x40f973[_0x3e692d]['bin']=0x0,_0x40f973[_0x3e692d][_0xf8ba4f(0x16c)]=_0xf8ba4f(0x9e),_0x40f973[_0x3e692d]['floorlevel']=_0x56d2[0x5];}else{if(_0x3e692d==_0x28c7f0){var _0x18e476;if(_0x56d2[0x4]=='L')_0x18e476=_0xf8ba4f(0x8b);else _0x56d2[0x4]=='F'&&(_0x18e476=_0xf8ba4f(0x9e));_0x40f973[_0x3e692d]['storage']=_0x56d2[0x0],_0x40f973[_0x3e692d][_0xf8ba4f(0x88)]=_0x56d2[0x1],_0x40f973[_0x3e692d][_0xf8ba4f(0x196)]=_0x56d2[0x2],_0x40f973[_0x3e692d]['bin']=_0x56d2[0x3],_0x40f973[_0x3e692d][_0xf8ba4f(0x16c)]=_0x18e476,_0x40f973[_0x3e692d]['floorlevel']=_0x56d2[0x5];}}}});}),_0x51bd0f[_0x23b6bd(0xac)]((_0x2f59e1,_0x2c81a3)=>{var _0x4ee70f=_0x23b6bd;_0x40f973[_0x2c81a3][_0x4ee70f(0xbd)]=_0x2f59e1;}),_0x1daa77['forEach']((_0x136e70,_0x3d5239)=>{var _0x54f86d=_0x23b6bd;_0x40f973[_0x3d5239][_0x54f86d(0xa1)]=_0x136e70;}),_0x3a8287['forEach']((_0x2a5ab0,_0x346c60)=>{var _0x5dffd9=_0x23b6bd;_0x40f973[_0x346c60][_0x5dffd9(0x14b)]=_0x2a5ab0;}),_0xb42063[_0x23b6bd(0xac)]((_0x5f6739,_0x5957e4)=>{var _0x141a28=_0x23b6bd;_0x40f973[_0x5957e4][_0x141a28(0x141)]=_0x5f6739;}),_0x3c529f['forEach']((_0x202d38,_0x4b66c8)=>{var _0x4e8705=_0x23b6bd;_0x40f973[_0x4b66c8][_0x4e8705(0x10b)]=_0x202d38;}),_0x22e616[_0x23b6bd(0xac)]((_0x57a34b,_0x5775b2)=>{var _0x4f6b39=_0x23b6bd;_0x40f973[_0x5775b2][_0x4f6b39(0x99)]=_0x57a34b;}),_0xe9b114[_0x23b6bd(0xac)]((_0x36b5a9,_0x10acee)=>{var _0x541d47=_0x23b6bd;_0x40f973[_0x10acee][_0x541d47(0xc0)]=_0x36b5a9;}),_0x127a83[_0x23b6bd(0xac)]((_0x1ad0ce,_0xa8f5c1)=>{var _0x5303c6=_0x23b6bd;_0x40f973[_0xa8f5c1][_0x5303c6(0xed)]=_0x1ad0ce;}),_0x7886f2[_0x23b6bd(0xac)]((_0x32a782,_0x558b45)=>{_0x40f973[_0x558b45]['product_cat']=_0x32a782;}),_0x491d0c['forEach']((_0xeba3f,_0x30c2)=>{var _0x33c158=_0x23b6bd;_0x40f973[_0x30c2][_0x33c158(0x132)]=_0xeba3f;}),_0x4909b7[_0x23b6bd(0xac)]((_0x36fb61,_0x4a60c6)=>{var _0x2f7541=_0x23b6bd;_0x40f973[_0x4a60c6][_0x2f7541(0x198)]=_0x36fb61;}),_0x5359f5[_0x23b6bd(0xac)]((_0x351c68,_0x49b192)=>{_0x40f973[_0x49b192]['invoice']=_0x351c68;});const _0x5aa9d2=_0x491d0c[_0x23b6bd(0xd1)](_0x4d4190=>{return _0x4d4190={'room_name':_0x4d4190};}),_0x4fee33=_0x40f973[_0x23b6bd(0x114)](_0x32bf99=>_0x32bf99[_0x23b6bd(0x16f)]!=='0'&&_0x32bf99[_0x23b6bd(0x16f)]!==''),_0x4909a1=new purchases({'invoice':_0x4ef0f3,'suppliers':_0x9f801b[_0x23b6bd(0x164)][_0x23b6bd(0xb9)],'date':_0x59745a,'warehouse_name':_0x191644,'product':_0x4fee33,'note':_0x4fffe5,'due_amount':_0x4551b4,'POnumber':_0x5ef6ad,'SCRN':_0x2cc3cf,'JO_number':_0x104563,'roomList':_0x5aa9d2}),_0x558534=await _0x4909a1['save'](),_0x1a3960=await purchases[_0x23b6bd(0x182)]({'invoice':_0x4ef0f3}),_0x19457c=_0x1a3960[_0x23b6bd(0xc8)][_0x23b6bd(0xd1)](async _0x487742=>{var _0x38374f=_0x23b6bd,_0x1c5931=await warehouse[_0x38374f(0x182)]({'name':_0x191644,'room':_0x487742[_0x38374f(0x132)]}),_0x25cf12=0x0;return _0x1c5931[_0x38374f(0xda)]['forEach'](_0x16dae2=>{var _0x575dca=_0x38374f;_0x16dae2['product_name']==_0x487742['product_name']&&_0x16dae2[_0x575dca(0x185)]==_0x487742[_0x575dca(0x185)]&&_0x16dae2['type']==_0x487742[_0x575dca(0x16c)]&&_0x16dae2[_0x575dca(0x92)]==_0x487742[_0x575dca(0x92)]&&_0x16dae2['bay']==_0x487742[_0x575dca(0x196)]&&_0x16dae2[_0x575dca(0x88)]==_0x487742[_0x575dca(0x88)]&&_0x16dae2[_0x575dca(0x113)]==_0x487742['storage']&&_0x16dae2[_0x575dca(0x10b)]==_0x487742[_0x575dca(0x10b)]&&_0x16dae2[_0x575dca(0x141)]==_0x487742['batch_code']&&_0x16dae2[_0x575dca(0xed)]==_0x487742['production_date']&&_0x16dae2[_0x575dca(0x115)]==_0x1a3960['invoice']&&(_0x16dae2[_0x575dca(0x192)]+=_0x487742[_0x575dca(0x16f)],_0x25cf12++);}),_0x25cf12===0x0&&_0x1c5931[_0x38374f(0xda)]['push']({'product_name':_0x487742[_0x38374f(0x163)],'product_stock':_0x487742[_0x38374f(0x16f)],'primary_code':_0x487742[_0x38374f(0xbd)],'secondary_code':_0x487742['secondary_code'],'product_code':_0x487742[_0x38374f(0xa7)],'storage':_0x487742[_0x38374f(0x113)],'rack':_0x487742[_0x38374f(0x88)],'bay':_0x487742[_0x38374f(0x196)],'bin':_0x487742['bin'],'type':_0x487742['type'],'floorlevel':_0x487742['floorlevel'],'maxProducts':_0x487742['maxStocks'],'unit':_0x487742['standard_unit'],'secondary_unit':_0x487742[_0x38374f(0xa4)],'expiry_date':_0x487742[_0x38374f(0x10b)],'maxPerUnit':_0x487742[_0x38374f(0x99)],'batch_code':_0x487742[_0x38374f(0x141)],'alertQTY':_0x487742['alertQTY'],'production_date':_0x487742[_0x38374f(0xed)],'product_cat':_0x487742[_0x38374f(0x144)],'invoice':_0x487742[_0x38374f(0x115)],'actual_qty':_0x487742['actual_qty']}),_0x1c5931;});Promise[_0x23b6bd(0x8c)](_0x19457c)[_0x23b6bd(0xef)](async _0x4eb929=>{var _0x1386b4=_0x23b6bd;try{for(const _0x2cfa55 of _0x4eb929){await _0x2cfa55[_0x1386b4(0xd4)]();}const _0x347955=await master_shop['find'](),_0x477bc8=await email_settings[_0x1386b4(0x182)](),_0x84e257=await supervisor_settings[_0x1386b4(0x116)]();var _0x6c49e3=_0x1a3960[_0x1386b4(0xc8)],_0x1ad9b7='',_0x10d864;for(_0x10d864 in _0x6c49e3){_0x1ad9b7+='<tr>'+_0x1386b4(0xc4)+_0x6c49e3[_0x10d864][_0x1386b4(0x163)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6c49e3[_0x10d864][_0x1386b4(0xa7)]+_0x1386b4(0x128)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6c49e3[_0x10d864]['quantity']+_0x1386b4(0x128)+_0x1386b4(0xc4)+_0x6c49e3[_0x10d864]['standard_unit']+_0x1386b4(0x128)+_0x1386b4(0xc4)+_0x6c49e3[_0x10d864][_0x1386b4(0xa4)]+'</td>'+_0x1386b4(0xc4)+_0x1a3960[_0x1386b4(0x143)]+_0x1386b4(0x128)+_0x1386b4(0xc4)+_0x6c49e3[_0x10d864][_0x1386b4(0x132)]+_0x1386b4(0x128)+_0x1386b4(0xc4)+_0x6c49e3[_0x10d864][_0x1386b4(0x113)]+_0x6c49e3[_0x10d864][_0x1386b4(0x88)]+_0x6c49e3[_0x10d864]['bay']+_0x6c49e3[_0x10d864][_0x1386b4(0x92)]+_0x6c49e3[_0x10d864][_0x1386b4(0x16c)][0x0]+_0x6c49e3[_0x10d864][_0x1386b4(0x185)]+'</td>',_0x1386b4(0xe7);}let _0x3ccc00=nodemailer[_0x1386b4(0x142)]({'host':_0x477bc8[_0x1386b4(0x194)],'port':Number(_0x477bc8[_0x1386b4(0xc6)]),'secure':![],'auth':{'user':_0x477bc8[_0x1386b4(0xb4)],'pass':_0x477bc8['password']}}),_0x3b0ece={'from':_0x477bc8['email'],'to':_0x84e257[0x0]['RMSEmail'],'subject':_0x1386b4(0x158),'attachments':[{'filename':_0x1386b4(0x17b),'path':__dirname+_0x1386b4(0x145)+_0x1386b4(0xd6)+_0x347955[0x0][_0x1386b4(0x118)],'cid':_0x1386b4(0xdd)}],'html':'<!DOCTYPE\x20html>'+_0x1386b4(0xc9)+'</head><body>'+_0x1386b4(0x105)+_0x1386b4(0x10a)+'<div>'+_0x1386b4(0x93)+_0x1386b4(0xbb)+_0x1386b4(0x105)+_0x1386b4(0x8d)+_0x347955[0x0][_0x1386b4(0x13a)]+_0x1386b4(0x111)+_0x1386b4(0xbb)+_0x1386b4(0xbb)+_0x1386b4(0x195)+_0x1386b4(0x105)+_0x1386b4(0xea)+'\x20Order\x20Number\x20:\x20'+_0x1a3960[_0x1386b4(0x115)]+'\x20'+_0x1386b4(0x103)+_0x1386b4(0x171)+_0x1a3960[_0x1386b4(0xcf)]+'\x20'+'</span>'+_0x1386b4(0x138)+_0x1386b4(0xbb)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1386b4(0x17e)+_0x1386b4(0xc5)+_0x1386b4(0x15d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x1386b4(0xdb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x1386b4(0x121)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x1386b4(0xfc)+_0x1386b4(0x170)+_0x1386b4(0xe7)+_0x1386b4(0xec)+_0x1386b4(0x18b)+'\x20'+_0x1ad9b7+'\x20'+_0x1386b4(0xf4)+'</table>'+_0x1386b4(0x105)+_0x1386b4(0x13c)+'<h5>'+_0x347955[0x0]['site_title']+_0x1386b4(0x138)+'</div>'+_0x1386b4(0xbb)+_0x1386b4(0x10c)};_0x3ccc00['sendMail'](_0x3b0ece,function(_0x2c1551,_0x3e4055){var _0x9885ff=_0x1386b4;_0x2c1551?(console['log'](_0x2c1551),console[_0x9885ff(0x96)](_0x9885ff(0x9a))):console[_0x9885ff(0x96)](_0x9885ff(0xf8));}),_0x9f801b[_0x1386b4(0x148)](_0x1386b4(0xa6),'Purchase\x20data\x20added\x20successfully'),_0x24f54d[_0x1386b4(0xde)](_0x1386b4(0x175));}catch(_0x59002c){console[_0x1386b4(0x9c)](_0x59002c),_0x24f54d[_0x1386b4(0x193)](0x1f4)[_0x1386b4(0xe3)]({'error':_0x1386b4(0xb0)});}})[_0x23b6bd(0x107)](_0x427c48=>{var _0x50ea3d=_0x23b6bd;console[_0x50ea3d(0x9c)](_0x427c48),_0x24f54d['status'](0x1f4)[_0x50ea3d(0xe3)]({'error':_0x50ea3d(0x177)});});}catch(_0x50d071){console['log'](_0x50d071);}}),router['get'](a0_0x48db59(0x130),auth,async(_0x44ab36,_0x3320a9)=>{var _0x281d61=a0_0x48db59;try{const {username:_0x578499,email:_0x1a2170,role:_0x435519}=_0x44ab36[_0x281d61(0x14f)],_0x4ba274=_0x44ab36['user'],_0x11a8b6=await profile['findOne']({'email':_0x4ba274[_0x281d61(0xb4)]}),_0x1bf9bf=await master_shop['find'](),_0x2a5f97=_0x44ab36[_0x281d61(0x14a)]['id'],_0x113c9a=await purchases[_0x281d61(0xb8)](_0x2a5f97),_0x4d8d9f=await warehouse[_0x281d61(0x129)]([{'$match':{'name':_0x113c9a[_0x281d61(0x143)],'room':_0x113c9a[_0x281d61(0x15c)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x281d61(0x15a),'name':{'$first':_0x281d61(0xe1)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x281d61(0xf9)},'type':{'$first':_0x281d61(0x17d)},'floorlevel':{'$first':_0x281d61(0x18e)},'primary_code':{'$first':_0x281d61(0x100)},'secondary_code':{'$first':_0x281d61(0x18a)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x281d61(0x18d)},'rack':{'$first':_0x281d61(0xa0)},'expiry_date':{'$first':_0x281d61(0x9f)}}}]),_0x35811b=await customer[_0x281d61(0x116)]({});let _0x495db0;if(_0x4ba274[_0x281d61(0x119)]==_0x281d61(0x12f)){const _0x5c7a70=await staff[_0x281d61(0x182)]({'email':_0x4ba274[_0x281d61(0xb4)]});_0x495db0=await warehouse[_0x281d61(0x129)]([{'$match':{'status':_0x281d61(0x16a),'name':_0x5c7a70[_0x281d61(0x153)]}},{'$group':{'_id':_0x281d61(0xd0),'name':{'$first':_0x281d61(0xd0)}}}]);}else _0x495db0=await warehouse['aggregate']([{'$match':{'status':_0x281d61(0x16a)}},{'$group':{'_id':_0x281d61(0xd0),'name':{'$first':'$name'}}}]);const _0x510068=await product[_0x281d61(0x116)]({}),_0x1733ad=await suppliers[_0x281d61(0x116)]({}),_0x457a18=BayBinSelected(_0x113c9a[_0x281d61(0x143)],_0x113c9a['room']);if(_0x1bf9bf[0x0][_0x281d61(0x14e)]==_0x281d61(0xdc)){var _0x5b3b96=users[_0x281d61(0x13b)];console[_0x281d61(0x96)](_0x5b3b96);}else{if(_0x1bf9bf[0x0][_0x281d61(0x14e)]=='Hindi')var _0x5b3b96=users[_0x281d61(0x123)];else{if(_0x1bf9bf[0x0][_0x281d61(0x14e)]==_0x281d61(0x97))var _0x5b3b96=users['German'];else{if(_0x1bf9bf[0x0]['language']==_0x281d61(0xc3))var _0x5b3b96=users[_0x281d61(0xc3)];else{if(_0x1bf9bf[0x0]['language']==_0x281d61(0x18c))var _0x5b3b96=users['French'];else{if(_0x1bf9bf[0x0][_0x281d61(0x14e)]==_0x281d61(0x191))var _0x5b3b96=users[_0x281d61(0x183)];else{if(_0x1bf9bf[0x0]['language']==_0x281d61(0xf3))var _0x5b3b96=users[_0x281d61(0xf3)];else{if(_0x1bf9bf[0x0][_0x281d61(0x14e)]==_0x281d61(0x9b))var _0x5b3b96=users[_0x281d61(0x172)];}}}}}}}_0x3320a9[_0x281d61(0x98)]('edit_purchases_view',{'success':_0x44ab36[_0x281d61(0x148)]('success'),'errors':_0x44ab36[_0x281d61(0x148)](_0x281d61(0xaa)),'role':_0x4ba274,'profile':_0x11a8b6,'customer':_0x35811b,'warehouse':_0x495db0,'product':_0x4d8d9f,'user':_0x113c9a,'master_shop':_0x1bf9bf,'unit':_0x510068,'language':_0x5b3b96,'suppliers':_0x1733ad,'dataSelected':_0x457a18});}catch(_0x44f033){console[_0x281d61(0x96)](_0x44f033);}}),router[a0_0x48db59(0x176)](a0_0x48db59(0x130),auth,async(_0x54e78d,_0x51e174)=>{var _0x24904f=a0_0x48db59;try{const _0x198ba6=_0x54e78d[_0x24904f(0x14a)]['id'],{invoice:_0x476aaf,warehouse_name:_0x4e5814,Room_name:_0x17744f}=_0x54e78d['body'],_0x3002bd=await warehouse[_0x24904f(0x182)]({'name':_0x4e5814,'room':_0x17744f}),_0x580089=await purchases[_0x24904f(0x182)]({'invoice':_0x476aaf});_0x580089['product']['forEach'](_0x555dd0=>{var _0x1cb8b0=_0x24904f,_0x9583df=0x0;const _0x16c465=_0x3002bd['product_details'][_0x1cb8b0(0xd1)](_0x3d8dd0=>{var _0x20e16a=_0x1cb8b0;_0x3d8dd0[_0x20e16a(0x163)]==_0x555dd0[_0x20e16a(0x163)]&&_0x3d8dd0['floorlevel']==_0x555dd0[_0x20e16a(0x185)]&&_0x3d8dd0[_0x20e16a(0x16c)]==_0x555dd0['type']&&_0x3d8dd0['bin']==_0x555dd0[_0x20e16a(0x92)]&&_0x3d8dd0[_0x20e16a(0x196)]==_0x555dd0[_0x20e16a(0x196)]&&_0x3d8dd0['rack']==_0x555dd0['rack']&&_0x3d8dd0['storage']==_0x555dd0['storage']&&_0x3d8dd0[_0x20e16a(0x10b)]==_0x555dd0[_0x20e16a(0x10b)]&&_0x3d8dd0[_0x20e16a(0x141)]==_0x555dd0[_0x20e16a(0x141)]&&_0x3d8dd0[_0x20e16a(0xed)]==_0x555dd0['production_date']&&_0x3d8dd0[_0x20e16a(0x151)]==_0x555dd0[_0x20e16a(0x151)]&&_0x3d8dd0[_0x20e16a(0x198)]==_0x555dd0[_0x20e16a(0x198)]&&(_0x3d8dd0[_0x20e16a(0x192)]=parseInt(_0x3d8dd0[_0x20e16a(0x192)])+parseInt(_0x555dd0[_0x20e16a(0x16f)]),_0x9583df++);});_0x9583df=='0'&&(_0x3002bd[_0x1cb8b0(0xda)]=_0x3002bd[_0x1cb8b0(0xda)]['concat']({'product_name':_0x555dd0[_0x1cb8b0(0x163)],'product_stock':_0x555dd0[_0x1cb8b0(0x16f)],'primary_code':_0x555dd0[_0x1cb8b0(0xbd)],'secondary_code':_0x555dd0[_0x1cb8b0(0xa1)],'product_code':_0x555dd0[_0x1cb8b0(0xa7)],'storage':_0x555dd0[_0x1cb8b0(0x113)],'rack':_0x555dd0['rack'],'bay':_0x555dd0[_0x1cb8b0(0x196)],'bin':_0x555dd0['bin'],'type':_0x555dd0[_0x1cb8b0(0x16c)],'floorlevel':_0x555dd0[_0x1cb8b0(0x185)],'maxProducts':_0x555dd0['maxStocks'],'unit':_0x555dd0[_0x1cb8b0(0x10f)],'secondary_unit':_0x555dd0[_0x1cb8b0(0xa4)],'expiry_date':_0x555dd0[_0x1cb8b0(0x10b)],'maxPerUnit':_0x555dd0[_0x1cb8b0(0x99)],'batch_code':_0x555dd0[_0x1cb8b0(0x141)],'alertQTY':_0x555dd0[_0x1cb8b0(0xc0)],'production_date':_0x555dd0[_0x1cb8b0(0xed)],'delivery_date':_0x555dd0[_0x1cb8b0(0x151)],'delivery_code':_0x555dd0[_0x1cb8b0(0x198)]}));}),await _0x3002bd[_0x24904f(0xd4)](),_0x580089[_0x24904f(0x12b)]=_0x24904f(0x90);const _0x75c8dd=await _0x580089[_0x24904f(0xd4)]();_0x54e78d['flash'](_0x24904f(0xa6),'Sales\x20Update\x20successfully'),_0x51e174[_0x24904f(0xde)]('/all_purchases/view');}catch(_0x4c4995){console[_0x24904f(0x96)](_0x4c4995);}}),router[a0_0x48db59(0x17a)]('/view/:id',auth,async(_0x353062,_0x5233e5)=>{var _0x430552=a0_0x48db59;try{const {username:_0x3f8496,email:_0xf40a92,role:_0x44b2cf}=_0x353062[_0x430552(0x14f)],_0x1d8480=_0x353062[_0x430552(0x14f)],_0x1cbe95=await profile[_0x430552(0x182)]({'email':_0x1d8480[_0x430552(0xb4)]}),_0x251c07=await master_shop[_0x430552(0x116)](),_0x2c194e=_0x353062[_0x430552(0x14a)]['id'],_0x3c97bd=await purchases[_0x430552(0xb8)](_0x2c194e),_0x2b38a7=await suppliers[_0x430552(0x116)]({});let _0x488dbb;if(_0x1d8480['role']==_0x430552(0x12f)){const _0x46b1a6=await staff['findOne']({'email':_0x1d8480['email']});_0x488dbb=await warehouse['find']({'status':'Enabled','name':_0x46b1a6[_0x430552(0x153)],'warehouse_category':_0x430552(0x82)});}else _0x488dbb=await warehouse[_0x430552(0x129)]([{'$match':{'status':'Enabled','warehouse_category':_0x430552(0x82)}},{'$group':{'_id':'$name','name':{'$first':_0x430552(0xd0)}}}]);const _0x156cfc=await product[_0x430552(0x116)]({}),_0x50b299=BayBinSelected(_0x3c97bd['warehouse_name'],_0x3c97bd[_0x430552(0x15c)]);let _0x2e750b=new Date(_0x3c97bd[_0x430552(0x10b)]),_0x765fa=('0'+_0x2e750b[_0x430552(0x137)]())[_0x430552(0xe0)](-0x2),_0x57e807=('0'+(_0x2e750b[_0x430552(0x168)]()+0x1))[_0x430552(0xe0)](-0x2),_0x11e058=_0x2e750b[_0x430552(0xc2)](),_0x34cc4f=_0x11e058+'-'+_0x57e807+'-'+_0x765fa;if(_0x251c07[0x0]['language']==_0x430552(0xdc)){var _0x17f6af=users[_0x430552(0x13b)];console['log'](_0x17f6af);}else{if(_0x251c07[0x0][_0x430552(0x14e)]==_0x430552(0x123))var _0x17f6af=users[_0x430552(0x123)];else{if(_0x251c07[0x0][_0x430552(0x14e)]==_0x430552(0x97))var _0x17f6af=users[_0x430552(0x97)];else{if(_0x251c07[0x0][_0x430552(0x14e)]==_0x430552(0xc3))var _0x17f6af=users['Spanish'];else{if(_0x251c07[0x0]['language']==_0x430552(0x18c))var _0x17f6af=users[_0x430552(0x18c)];else{if(_0x251c07[0x0][_0x430552(0x14e)]==_0x430552(0x191))var _0x17f6af=users['Portuguese'];else{if(_0x251c07[0x0][_0x430552(0x14e)]==_0x430552(0xf3))var _0x17f6af=users[_0x430552(0xf3)];else{if(_0x251c07[0x0][_0x430552(0x14e)]=='Arabic\x20(ae)')var _0x17f6af=users[_0x430552(0x172)];}}}}}}}_0x5233e5[_0x430552(0x98)](_0x430552(0x165),{'success':_0x353062[_0x430552(0x148)](_0x430552(0xa6)),'errors':_0x353062['flash']('errors'),'role':_0x1d8480,'profile':_0x1cbe95,'purchases':_0x3c97bd,'suppliers':_0x2b38a7,'warehouse':_0x488dbb,'product':_0x156cfc,'master_shop':_0x251c07,'language':_0x17f6af,'ed_fullDate':_0x34cc4f,'dataSelected':_0x50b299});}catch(_0x424d80){console[_0x430552(0x96)](_0x424d80);}}),router['post'](a0_0x48db59(0xfd),auth,async(_0x5d8df8,_0x559dd7)=>{var _0x3c2e47=a0_0x48db59;try{const _0x4631b2=_0x5d8df8[_0x3c2e47(0x14a)]['id'],_0x44c4c7=await purchases[_0x3c2e47(0x182)]({'_id':_0x5d8df8['params']['id']}),_0x52f39d=await warehouse[_0x3c2e47(0x182)]({'name':_0x44c4c7[_0x3c2e47(0x143)],'room':_0x44c4c7[_0x3c2e47(0x15c)]});_0x44c4c7[_0x3c2e47(0xc8)][_0x3c2e47(0xac)](_0x4795da=>{var _0x2d84e2=_0x3c2e47;const _0x369661=_0x52f39d[_0x2d84e2(0xda)][_0x2d84e2(0xd1)](_0x9c7392=>{var _0x8cd173=_0x2d84e2;_0x9c7392[_0x8cd173(0x163)]==_0x4795da[_0x8cd173(0x163)]&&_0x9c7392[_0x8cd173(0x185)]==_0x4795da[_0x8cd173(0x185)]&&_0x9c7392[_0x8cd173(0x16c)]==_0x4795da['type']&&_0x9c7392['bin']==_0x4795da[_0x8cd173(0x92)]&&_0x9c7392[_0x8cd173(0x196)]==_0x4795da[_0x8cd173(0x196)]&&_0x9c7392[_0x8cd173(0x88)]==_0x4795da['rack']&&_0x9c7392['storage']==_0x4795da[_0x8cd173(0x113)]&&(_0x9c7392['product_stock']=parseInt(_0x9c7392[_0x8cd173(0x192)])-parseInt(_0x4795da[_0x8cd173(0x16f)]));});}),await _0x52f39d[_0x3c2e47(0xd4)]();const {invoice:_0x27ba0a,suppliers:_0x43c6e9,date:_0x129b7b,warehouse_name:_0x49b0f9,prod_name:_0x2fef9d,prod_code:_0x28856c,prod_qty:_0x29c809,prod_unit:_0x48089d,prod_secondunit:_0x18bc2c,prod_level:_0x4c036d,prod_isle:_0x70ea10,prod_pallet:_0x453fcc,note:_0x2989cd,expiry_date:_0x5d417e,batch_code:_0x1cdda7,paid_amount:_0x46545f,due_amount:_0x2eaf8c,Room_name:_0x160d1a,primary_code:_0xa3f19f,secondary_code:_0x5cfa2d,PO_number:_0x5007ae,JO_number:_0x397931}=_0x5d8df8['body'];if(typeof _0x2fef9d==_0x3c2e47(0x17f))var _0x43d03f=[_0x5d8df8['body'][_0x3c2e47(0x152)]],_0x4571ba=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x147)]],_0x58b9e2=[_0x5d8df8['body'][_0x3c2e47(0x160)]],_0x1977da=[_0x5d8df8['body'][_0x3c2e47(0x108)]],_0x5a14f2=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0xae)]],_0x161b64=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x16b)]],_0x18e06c=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0xb1)]],_0x4a7072=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0xcb)]],_0x3c80c8=[_0x5d8df8['body'][_0x3c2e47(0xbd)]],_0x332dc4=[_0x5d8df8['body'][_0x3c2e47(0xa1)]],_0xb78353=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x157)]],_0x4b0dfb=[_0x5d8df8[_0x3c2e47(0x164)]['batch_code']],_0x5ceaed=[_0x5d8df8[_0x3c2e47(0x164)]['expiry_date']],_0x109145=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x113)]],_0x2b83d8=[_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x117)]],_0x27e5bf=[_0x5d8df8['body'][_0x3c2e47(0x16c)]];else var _0x43d03f=[..._0x5d8df8[_0x3c2e47(0x164)]['prod_name']],_0x4571ba=[..._0x5d8df8['body']['prod_code']],_0x58b9e2=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x160)]],_0x1977da=[..._0x5d8df8['body'][_0x3c2e47(0x108)]],_0x5a14f2=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0xae)]],_0x161b64=[..._0x5d8df8[_0x3c2e47(0x164)]['prod_level']],_0x18e06c=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0xb1)]],_0x4a7072=[..._0x5d8df8[_0x3c2e47(0x164)]['prod_pallet']],_0x3c80c8=[..._0x5d8df8['body'][_0x3c2e47(0xbd)]],_0x332dc4=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0xa1)]],_0xb78353=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x157)]],_0x4b0dfb=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x141)]],_0x5ceaed=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x10b)]],_0x109145=[..._0x5d8df8[_0x3c2e47(0x164)]['storage']],_0x2b83d8=[..._0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x117)]],_0x27e5bf=[..._0x5d8df8['body'][_0x3c2e47(0x16c)]];const _0x1a188e=_0x43d03f[_0x3c2e47(0xd1)](_0x3aeea8=>{return _0x3aeea8={'product_name':_0x3aeea8};});_0x4571ba[_0x3c2e47(0xac)]((_0x2a2609,_0x3a80f5)=>{_0x1a188e[_0x3a80f5]['product_code']=_0x2a2609;}),_0x58b9e2[_0x3c2e47(0xac)]((_0x301918,_0x3b6ef0)=>{var _0x25d721=_0x3c2e47;_0x1a188e[_0x3b6ef0][_0x25d721(0x16f)]=_0x301918;}),_0x1977da[_0x3c2e47(0xac)]((_0x50f084,_0x2e3669)=>{var _0x10c420=_0x3c2e47;_0x1a188e[_0x2e3669][_0x10c420(0x10f)]=_0x50f084;}),_0x5a14f2[_0x3c2e47(0xac)]((_0x1cac4a,_0x47ca4e)=>{_0x1a188e[_0x47ca4e]['secondary_unit']=_0x1cac4a;}),_0x161b64[_0x3c2e47(0xac)]((_0x96b94f,_0x11d57f)=>{var _0x9701d0=_0x3c2e47;_0x1a188e[_0x11d57f][_0x9701d0(0x196)]=_0x96b94f;}),_0x18e06c[_0x3c2e47(0xac)]((_0x403b30,_0x35a8a3)=>{var _0x2ced44=_0x3c2e47;_0x1a188e[_0x35a8a3][_0x2ced44(0x92)]=_0x403b30;}),_0x4a7072[_0x3c2e47(0xac)]((_0x188c5f,_0x4c75e7)=>{var _0x54a6a8=_0x3c2e47;_0x1a188e[_0x4c75e7][_0x54a6a8(0x185)]=_0x188c5f;}),_0x3c80c8[_0x3c2e47(0xac)]((_0xb1b4e6,_0x1a8c78)=>{var _0x29a25e=_0x3c2e47;_0x1a188e[_0x1a8c78][_0x29a25e(0xbd)]=_0xb1b4e6;}),_0x332dc4['forEach']((_0x333661,_0x19aa01)=>{_0x1a188e[_0x19aa01]['secondary_code']=_0x333661;}),_0xb78353[_0x3c2e47(0xac)]((_0x4e4e56,_0x2dc1eb)=>{var _0x487d13=_0x3c2e47;_0x1a188e[_0x2dc1eb][_0x487d13(0x14b)]=_0x4e4e56;}),_0x4b0dfb[_0x3c2e47(0xac)]((_0x48e75a,_0x28ba47)=>{_0x1a188e[_0x28ba47]['batch_code']=_0x48e75a;}),_0x5ceaed['forEach']((_0x3a8e1e,_0x17479a)=>{var _0x1a1b9e=_0x3c2e47;_0x1a188e[_0x17479a][_0x1a1b9e(0x10b)]=_0x3a8e1e;}),_0x27e5bf[_0x3c2e47(0xac)]((_0x20a918,_0x3da4f7)=>{_0x1a188e[_0x3da4f7]['type']=_0x20a918;}),_0x109145[_0x3c2e47(0xac)]((_0x27f1f5,_0x59e9bd)=>{var _0x1e148d=_0x3c2e47;_0x1a188e[_0x59e9bd][_0x1e148d(0x113)]=_0x27f1f5;}),_0x2b83d8[_0x3c2e47(0xac)]((_0x319428,_0x4fb0cd)=>{var _0x141d37=_0x3c2e47;_0x1a188e[_0x4fb0cd][_0x141d37(0x88)]=_0x319428;});const _0x155b08=_0x1a188e[_0x3c2e47(0x114)](_0x3a2700=>_0x3a2700[_0x3c2e47(0x16f)]!=='0'&&_0x3a2700[_0x3c2e47(0x16f)]!=='');_0x44c4c7[_0x3c2e47(0x115)]=_0x27ba0a,_0x44c4c7['suppliers']=_0x43c6e9,_0x44c4c7['date']=_0x129b7b,_0x44c4c7[_0x3c2e47(0x143)]=_0x49b0f9,_0x44c4c7['product']=_0x155b08,_0x44c4c7[_0x3c2e47(0xa3)]=_0x2989cd,_0x44c4c7['paid_amount']=_0x46545f,_0x44c4c7[_0x3c2e47(0xca)]=_0x2eaf8c,_0x44c4c7['room']=_0x160d1a,_0x44c4c7[_0x3c2e47(0x154)]=_0x5007ae,_0x44c4c7[_0x3c2e47(0x188)]=_0x397931;const _0x40e5fe=await _0x44c4c7[_0x3c2e47(0xd4)](),_0x76b46=await warehouse[_0x3c2e47(0x182)]({'name':_0x5d8df8[_0x3c2e47(0x164)]['warehouse_name'],'room':_0x5d8df8['body'][_0x3c2e47(0xb3)]});_0x44c4c7[_0x3c2e47(0xc8)]['forEach'](_0x1287d6=>{var _0x2ebdf7=_0x3c2e47,_0x5da144=0x0;const _0xfbf8e2=_0x76b46[_0x2ebdf7(0xda)][_0x2ebdf7(0xd1)](_0x137a8b=>{var _0xf3c36e=_0x2ebdf7;_0x137a8b[_0xf3c36e(0x163)]==_0x1287d6[_0xf3c36e(0x163)]&&_0x137a8b[_0xf3c36e(0x185)]==_0x1287d6[_0xf3c36e(0x185)]&&_0x137a8b[_0xf3c36e(0x16c)]==_0x1287d6[_0xf3c36e(0x16c)]&&_0x137a8b['bin']==_0x1287d6[_0xf3c36e(0x92)]&&_0x137a8b[_0xf3c36e(0x196)]==_0x1287d6['bay']&&_0x137a8b[_0xf3c36e(0x88)]==_0x1287d6['rack']&&_0x137a8b['storage']==_0x1287d6[_0xf3c36e(0x113)]&&(_0x137a8b['product_stock']=parseInt(_0x137a8b[_0xf3c36e(0x192)])+parseInt(_0x1287d6[_0xf3c36e(0x16f)]),_0x5da144++);});_0x5da144=='0'&&(_0x76b46[_0x2ebdf7(0xda)]=_0x76b46['product_details'][_0x2ebdf7(0xeb)]({'product_name':_0x1287d6[_0x2ebdf7(0x163)],'product_stock':_0x1287d6[_0x2ebdf7(0x16f)],'primary_code':_0x1287d6[_0x2ebdf7(0xbd)],'secondary_code':_0x1287d6[_0x2ebdf7(0xa1)],'product_code':_0x1287d6[_0x2ebdf7(0xa7)],'storage':_0x1287d6[_0x2ebdf7(0x113)],'rack':_0x1287d6['rack'],'bay':_0x1287d6[_0x2ebdf7(0x196)],'bin':_0x1287d6[_0x2ebdf7(0x92)],'type':_0x1287d6['type'],'floorlevel':_0x1287d6[_0x2ebdf7(0x185)],'maxProducts':_0x1287d6['maxStocks'],'unit':_0x1287d6['standard_unit'],'secondary_unit':_0x1287d6[_0x2ebdf7(0xa4)],'expiry_date':_0x1287d6['expiry_date']}));}),await _0x76b46[_0x3c2e47(0xd4)]();const _0x186f86=await s_payment_data[_0x3c2e47(0x182)]({'invoice':_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x115)]});if(_0x186f86===null){}else console[_0x3c2e47(0x96)](_0x3c2e47(0xb9),_0x186f86,_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0x115)]),_0x186f86[_0x3c2e47(0xb9)]=_0x5d8df8[_0x3c2e47(0x164)][_0x3c2e47(0xb9)],await _0x186f86[_0x3c2e47(0xd4)]();_0x5d8df8[_0x3c2e47(0x148)](_0x3c2e47(0xa6),'purchase\x20data\x20update\x20successfully'),_0x559dd7[_0x3c2e47(0xde)](_0x3c2e47(0x11e));}catch(_0x13d411){console[_0x3c2e47(0x96)](_0x13d411);}}),router[a0_0x48db59(0x176)]('/give_payment/:id',auth,async(_0xd25ef7,_0x4dd0d7)=>{var _0x2c4dec=a0_0x48db59;try{const _0x241e67=_0xd25ef7[_0x2c4dec(0x14a)]['id'],{invoice:_0x185cff,suppliers:_0x4c9576,payable:_0x3a12b5,due_amount:_0x3dd0bf}=_0xd25ef7['body'],_0x24e085=await purchases[_0x2c4dec(0xb8)](_0x241e67);var _0x1dadb1=_0x3a12b5-_0x3dd0bf;_0x24e085[_0x2c4dec(0xe4)]=parseFloat(_0x24e085[_0x2c4dec(0xe4)])+parseFloat(_0x3dd0bf),_0x24e085['due_amount']=_0x1dadb1;const _0xdf6c89=await _0x24e085[_0x2c4dec(0xd4)]();console[_0x2c4dec(0x96)](_0xdf6c89);const _0x47b9c4=await s_payment_data[_0x2c4dec(0x182)]({'invoice':_0x185cff});_0x47b9c4[_0x2c4dec(0x124)]=_0x1dadb1,await _0x47b9c4[_0x2c4dec(0xd4)]();let _0x198452=new Date(),_0x2f5236=('0'+_0x198452[_0x2c4dec(0x137)]())[_0x2c4dec(0xe0)](-0x2),_0x38c822=('0'+(_0x198452['getMonth']()+0x1))[_0x2c4dec(0xe0)](-0x2),_0x2d785b=_0x198452[_0x2c4dec(0xc2)](),_0x4a82be=_0x2d785b+'-'+_0x38c822+'-'+_0x2f5236;const _0x6dc7e3=new suppliers_payment({'invoice':_0x185cff,'date':_0x2d785b+'-'+_0x38c822+'-'+_0x2f5236,'suppliers':_0x4c9576,'reason':'Paid\x20For\x20Purchase','amount':_0x3dd0bf}),_0x7bdbe9=await _0x6dc7e3[_0x2c4dec(0xd4)]();_0xd25ef7['flash']('success','payment\x20successfull'),_0x4dd0d7[_0x2c4dec(0xde)](_0x2c4dec(0x11e));}catch(_0xc7162c){console['log'](_0xc7162c);}}),router[a0_0x48db59(0x17a)]('/invoice/:id',auth,async(_0x27379d,_0x5d5ef1)=>{var _0x2d63fc=a0_0x48db59;try{const {username:_0x2cf282,email:_0x29000c,role:_0x1114bf}=_0x27379d[_0x2d63fc(0x14f)],_0x12e6a5=_0x27379d[_0x2d63fc(0x14f)],_0x5b931b=await profile[_0x2d63fc(0x182)]({'email':_0x12e6a5[_0x2d63fc(0xb4)]}),_0xe777f6=await master_shop[_0x2d63fc(0x116)]();console[_0x2d63fc(0x96)](_0x2d63fc(0x16d),_0xe777f6);const _0x218ef2=_0x27379d[_0x2d63fc(0x14a)]['id'],_0x4931e4=await purchases[_0x2d63fc(0xb8)](_0x218ef2);console[_0x2d63fc(0x96)](_0x4931e4);const _0x381313=await suppliers[_0x2d63fc(0x182)]({'name':_0x4931e4[_0x2d63fc(0xb9)]});console[_0x2d63fc(0x96)](_0x381313);if(_0xe777f6[0x0][_0x2d63fc(0x14e)]=='English\x20(US)'){var _0x4cd516=users[_0x2d63fc(0x13b)];console[_0x2d63fc(0x96)](_0x4cd516);}else{if(_0xe777f6[0x0][_0x2d63fc(0x14e)]==_0x2d63fc(0x123))var _0x4cd516=users[_0x2d63fc(0x123)];else{if(_0xe777f6[0x0][_0x2d63fc(0x14e)]==_0x2d63fc(0x97))var _0x4cd516=users[_0x2d63fc(0x97)];else{if(_0xe777f6[0x0][_0x2d63fc(0x14e)]==_0x2d63fc(0xc3))var _0x4cd516=users[_0x2d63fc(0xc3)];else{if(_0xe777f6[0x0]['language']==_0x2d63fc(0x18c))var _0x4cd516=users[_0x2d63fc(0x18c)];else{if(_0xe777f6[0x0][_0x2d63fc(0x14e)]==_0x2d63fc(0x191))var _0x4cd516=users[_0x2d63fc(0x183)];else{if(_0xe777f6[0x0][_0x2d63fc(0x14e)]=='Chinese')var _0x4cd516=users[_0x2d63fc(0xf3)];else{if(_0xe777f6[0x0][_0x2d63fc(0x14e)]==_0x2d63fc(0x9b))var _0x4cd516=users['Arabic'];}}}}}}}_0x5d5ef1[_0x2d63fc(0x98)](_0x2d63fc(0x181),{'success':_0x27379d[_0x2d63fc(0x148)](_0x2d63fc(0xa6)),'errors':_0x27379d[_0x2d63fc(0x148)](_0x2d63fc(0xaa)),'role':_0x12e6a5,'profile':_0x5b931b,'master_shop':_0xe777f6,'supplier':_0x381313,'purchase':_0x4931e4,'language':_0x4cd516});}catch(_0x58cb23){console[_0x2d63fc(0x96)](_0x58cb23);}}),router['get']('/view/return_purchase/:id',auth,async(_0x3cf276,_0x3a5379)=>{var _0x441f6b=a0_0x48db59;try{const {username:_0x50b7d2,email:_0x28e07e,role:_0x499fa5}=_0x3cf276['user'],_0x1f0875=_0x3cf276[_0x441f6b(0x14f)],_0x238a72=await profile[_0x441f6b(0x182)]({'email':_0x1f0875[_0x441f6b(0xb4)]}),_0x3c85d1=await master_shop[_0x441f6b(0x116)]();console[_0x441f6b(0x96)](_0x441f6b(0x16d),_0x3c85d1);const _0x3a3f9e=_0x3cf276[_0x441f6b(0x14a)]['id'];console[_0x441f6b(0x96)](_0x3a3f9e);const _0x1d95f2=await purchases[_0x441f6b(0xb8)](_0x3a3f9e);console[_0x441f6b(0x96)](_0x441f6b(0xd3),_0x1d95f2);const _0x197cb7=await product[_0x441f6b(0x116)]({}),_0x1284c5=await warehouse[_0x441f6b(0x129)]([{'$match':{'name':_0x1d95f2[_0x441f6b(0x143)],'room':_0x1d95f2[_0x441f6b(0x15c)],'warehouse_category':_0x441f6b(0x82)}},{'$unwind':_0x441f6b(0xcd)},{'$group':{'_id':_0x441f6b(0x15a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x441f6b(0x9d)},'bay':{'$first':_0x441f6b(0xe9)},'bin':{'$first':_0x441f6b(0xf9)},'type':{'$first':_0x441f6b(0x17d)},'floorlevel':{'$first':_0x441f6b(0x18e)},'primary_code':{'$first':_0x441f6b(0x100)},'secondary_code':{'$first':_0x441f6b(0x18a)},'product_code':{'$first':_0x441f6b(0x134)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]);warehouse_data=await warehouse[_0x441f6b(0x129)]([{'$match':{'status':'Enabled','name':'Return\x20Goods','warehouse_category':_0x441f6b(0x82)}},{'$group':{'_id':_0x441f6b(0xd0),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console[_0x441f6b(0x96)](_0x441f6b(0xab),_0x1284c5);if(_0x3c85d1[0x0][_0x441f6b(0x14e)]==_0x441f6b(0xdc)){var _0x47df3a=users['English'];console['log'](_0x47df3a);}else{if(_0x3c85d1[0x0]['language']==_0x441f6b(0x123))var _0x47df3a=users[_0x441f6b(0x123)];else{if(_0x3c85d1[0x0]['language']==_0x441f6b(0x97))var _0x47df3a=users[_0x441f6b(0x97)];else{if(_0x3c85d1[0x0][_0x441f6b(0x14e)]=='Spanish')var _0x47df3a=users[_0x441f6b(0xc3)];else{if(_0x3c85d1[0x0][_0x441f6b(0x14e)]==_0x441f6b(0x18c))var _0x47df3a=users[_0x441f6b(0x18c)];else{if(_0x3c85d1[0x0]['language']==_0x441f6b(0x191))var _0x47df3a=users[_0x441f6b(0x183)];else{if(_0x3c85d1[0x0][_0x441f6b(0x14e)]==_0x441f6b(0xf3))var _0x47df3a=users[_0x441f6b(0xf3)];else{if(_0x3c85d1[0x0][_0x441f6b(0x14e)]==_0x441f6b(0x9b))var _0x47df3a=users[_0x441f6b(0x172)];}}}}}}}_0x3a5379[_0x441f6b(0x98)](_0x441f6b(0xee),{'success':_0x3cf276['flash'](_0x441f6b(0xa6)),'errors':_0x3cf276['flash']('errors'),'role':_0x1f0875,'profile':_0x238a72,'user':_0x1d95f2,'stock':_0x1284c5,'master_shop':_0x3c85d1,'product':_0x197cb7,'language':_0x47df3a,'warehouse':warehouse_data});}catch(_0x313a77){console[_0x441f6b(0x96)](_0x313a77);}}),router[a0_0x48db59(0x176)]('/view/return_purchase/:id',auth,async(_0x3f6bab,_0xa86c1a)=>{var _0x33cba3=a0_0x48db59;try{const {invoice:_0x5b98fa,date:_0x57cc3c,warehouse_name:_0x4e8713,Room_name:_0x122ebf,product_name:_0x2a68b9,purchase_quantity:_0xc85269,stocks:_0x39df61,return_qty:_0x555df4,note:_0x3986c9,level:_0x194dde,isle:_0x1935e3,pallet:_0x3360bc,to_warehouse_name:_0x208cd4,to_Room_name:_0xf2ec26}=_0x3f6bab[_0x33cba3(0x164)],_0x5d123c=await purchases[_0x33cba3(0x182)]({'_id':_0x3f6bab[_0x33cba3(0x14a)]['id']}),_0x4e5c15=await warehouse[_0x33cba3(0x182)]({'name':_0x4e8713,'room':_0x122ebf});if(typeof _0x2a68b9==_0x33cba3(0x17f))var _0x111970=[_0x3f6bab['body']['product_name']],_0x39b4bd=[_0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x139)]],_0x4f1403=[_0x3f6bab['body'][_0x33cba3(0x127)]],_0x2cfd08=[_0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0xc7)]],_0x19ac86=[_0x3f6bab['body'][_0x33cba3(0xa5)]],_0x56af69=[_0x3f6bab['body'][_0x33cba3(0xfe)]],_0x1444b6=[_0x3f6bab['body'][_0x33cba3(0x197)]],_0x52628e=[_0x3f6bab[_0x33cba3(0x164)]['types']],_0x17bd5b=[_0x3f6bab['body'][_0x33cba3(0x17c)]],_0x1479b3=[_0x3f6bab[_0x33cba3(0x164)]['primary_code_hide']],_0x346a40=[_0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x156)]];else var _0x111970=[..._0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x163)]],_0x39b4bd=[..._0x3f6bab['body'][_0x33cba3(0x139)]],_0x4f1403=[..._0x3f6bab['body'][_0x33cba3(0x127)]],_0x2cfd08=[..._0x3f6bab[_0x33cba3(0x164)]['return_qty']],_0x19ac86=[..._0x3f6bab['body'][_0x33cba3(0xa5)]],_0x56af69=[..._0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0xfe)]],_0x1444b6=[..._0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x197)]],_0x52628e=[..._0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x12a)]],_0x17bd5b=[..._0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x17c)]],_0x1479b3=[..._0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x112)]],_0x346a40=[..._0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0x156)]];const _0x1869d4=_0x111970[_0x33cba3(0xd1)](_0x3cee61=>{return _0x3cee61={'product_name':_0x3cee61};});_0x39b4bd['forEach']((_0x5ad5d6,_0x528ed6)=>{var _0x49923f=_0x33cba3;_0x1869d4[_0x528ed6][_0x49923f(0x139)]=_0x5ad5d6;}),_0x4f1403[_0x33cba3(0xac)]((_0x30c9ee,_0x17600f)=>{_0x1869d4[_0x17600f]['stock_quantity']=_0x30c9ee;}),_0x2cfd08['forEach']((_0x52466b,_0xfdab9c)=>{var _0x425591=_0x33cba3;_0x1869d4[_0xfdab9c][_0x425591(0xc7)]=_0x52466b;}),_0x19ac86[_0x33cba3(0xac)]((_0x22b459,_0x2de640)=>{var _0x381490=_0x33cba3;_0x1869d4[_0x2de640][_0x381490(0x196)]=_0x22b459;}),_0x56af69[_0x33cba3(0xac)]((_0x119e58,_0x147880)=>{var _0x233839=_0x33cba3;_0x1869d4[_0x147880][_0x233839(0x92)]=_0x119e58;}),_0x1444b6['forEach']((_0x294f78,_0x104a02)=>{var _0x3961dc=_0x33cba3;_0x1869d4[_0x104a02][_0x3961dc(0x185)]=_0x294f78;}),_0x52628e[_0x33cba3(0xac)]((_0x56da89,_0x41ace2)=>{_0x1869d4[_0x41ace2]['type']=_0x56da89;}),_0x17bd5b['forEach']((_0x4e274f,_0x4f821b)=>{var _0x28bbd9=_0x33cba3;_0x1869d4[_0x4f821b][_0x28bbd9(0xa7)]=_0x4e274f;}),_0x1479b3[_0x33cba3(0xac)]((_0x3a1616,_0x249e95)=>{var _0x4b0a40=_0x33cba3;_0x1869d4[_0x249e95][_0x4b0a40(0xbd)]=_0x3a1616;}),_0x346a40[_0x33cba3(0xac)]((_0x383f80,_0x46a7c5)=>{var _0x3d5d13=_0x33cba3;_0x1869d4[_0x46a7c5][_0x3d5d13(0xa1)]=_0x383f80;}),_0x5d123c[_0x33cba3(0xc8)][_0x33cba3(0xac)](_0x322fd6=>{var _0x37efeb=_0x33cba3;const _0x225eb0=_0x4e5c15['product_details'][_0x37efeb(0xd1)](_0x5d5a6f=>{var _0xeb6d1=_0x37efeb;_0x5d5a6f[_0xeb6d1(0x163)]==_0x322fd6[_0xeb6d1(0x163)]&&_0x5d5a6f['floorlevel']==_0x322fd6[_0xeb6d1(0x185)]&&_0x5d5a6f['type']==_0x322fd6[_0xeb6d1(0x16c)]&&_0x5d5a6f[_0xeb6d1(0x92)]==_0x322fd6['bin']&&_0x5d5a6f[_0xeb6d1(0x196)]==_0x322fd6['bay']&&_0x5d5a6f[_0xeb6d1(0x88)]==_0x322fd6['rack']&&_0x5d5a6f[_0xeb6d1(0x113)]==_0x322fd6[_0xeb6d1(0x113)]&&(console['log'](parseInt(_0x5d5a6f['product_stock'])+_0xeb6d1(0x125)+parseInt(_0x322fd6[_0xeb6d1(0x16f)])),_0x5d5a6f[_0xeb6d1(0x192)]=parseInt(_0x5d5a6f['product_stock'])+parseInt(_0x322fd6[_0xeb6d1(0x16f)]));});}),await _0x4e5c15['save']();const _0x19f45c=_0x1869d4['filter'](_0x94e28a=>_0x94e28a[_0x33cba3(0xc7)]!=='0'&&_0x94e28a[_0x33cba3(0xc7)]!=='');var _0x45aaac=0x0;_0x19f45c[_0x33cba3(0xac)](_0x42aa46=>{var _0x3dee85=_0x33cba3;console[_0x3dee85(0x96)](_0x3dee85(0x83),_0x42aa46),(parseInt(_0x42aa46[_0x3dee85(0x139)])<parseInt(_0x42aa46[_0x3dee85(0xc7)])||parseInt(_0x42aa46[_0x3dee85(0x184)])<parseInt(_0x42aa46[_0x3dee85(0xc7)]))&&_0x45aaac++;});if(_0x45aaac!=0x0)return _0x3f6bab['flash'](_0x33cba3(0xaa),_0x33cba3(0x178)),_0xa86c1a[_0x33cba3(0xde)](_0x33cba3(0x146));const _0x17b958=new purchases_return({'invoice':_0x5b98fa,'suppliers':_0x3f6bab['body']['suppliers'],'date':_0x57cc3c,'warehouse_name':_0x4e8713,'return_product':_0x19f45c,'note':_0x3986c9,'room':_0x122ebf,'to_warehouse_name':_0x208cd4,'to_room':_0xf2ec26}),_0x44c8d3=await _0x17b958[_0x33cba3(0xd4)]();console['log'](_0x17b958);const _0x404fe0=await purchases_return[_0x33cba3(0x182)]({'invoice':_0x5b98fa}),_0x26592e=await warehouse[_0x33cba3(0x182)]({'name':_0x208cd4,'room':_0xf2ec26});_0x404fe0[_0x33cba3(0xa8)][_0x33cba3(0xac)](_0x33ae42=>{var _0x2ae255=_0x33cba3,_0x1805b2=0x0;const _0x20eeaa=_0x26592e['product_details'][_0x2ae255(0xd1)](_0x28098f=>{var _0x25ba1a=_0x2ae255;_0x28098f[_0x25ba1a(0x163)]==_0x33ae42['product_name']&&_0x28098f[_0x25ba1a(0x185)]==_0x33ae42[_0x25ba1a(0x185)]&&_0x28098f[_0x25ba1a(0x16c)]==_0x33ae42[_0x25ba1a(0x16c)]&&_0x28098f[_0x25ba1a(0x92)]==_0x33ae42[_0x25ba1a(0x92)]&&_0x28098f[_0x25ba1a(0x196)]==_0x33ae42[_0x25ba1a(0x196)]&&(_0x28098f['product_stock']=parseInt(_0x28098f[_0x25ba1a(0x192)])-parseInt(_0x33ae42[_0x25ba1a(0xc7)]),_0x1805b2++);});_0x1805b2=='0'&&(_0x26592e[_0x2ae255(0xda)]=_0x26592e[_0x2ae255(0xda)][_0x2ae255(0xeb)]({'product_name':_0x33ae42[_0x2ae255(0x163)],'product_stock':_0x33ae42[_0x2ae255(0xc7)],'primary_code':_0x33ae42[_0x2ae255(0xbd)],'secondary_code':_0x33ae42['secondary_code'],'product_code':_0x33ae42['product_code'],'storage':_0x33ae42[_0x2ae255(0x113)],'rack':_0x33ae42[_0x2ae255(0x88)],'bay':_0x33ae42[_0x2ae255(0x196)],'bin':_0x33ae42[_0x2ae255(0x92)],'type':_0x33ae42['type'],'floorlevel':_0x33ae42[_0x2ae255(0x185)],'maxProducts':_0x33ae42[_0x2ae255(0x14b)],'unit':_0x33ae42[_0x2ae255(0x10f)],'secondary_unit':_0x33ae42[_0x2ae255(0xa4)],'expiry_date':_0x33ae42['expiry_date']}));}),await _0x26592e[_0x33cba3(0xd4)]();const _0x12f76a=await purchases['findOne']({'invoice':_0x5b98fa});_0x12f76a[_0x33cba3(0x13d)]='True';const _0x44db52=await _0x12f76a[_0x33cba3(0xd4)](),_0x20ccd7=new s_payment_data({'invoice':_0x5b98fa,'suppliers':_0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0xb9)],'reason':_0x33cba3(0x86)});await _0x20ccd7[_0x33cba3(0xd4)]();const _0x2a93ea=await master_shop['find']();console[_0x33cba3(0x96)](_0x33cba3(0xd9),_0x2a93ea[0x0][_0x33cba3(0x118)]);const _0x43ebda=await email_settings['findOne'](),_0x588d66=await suppliers[_0x33cba3(0x182)]({'name':_0x3f6bab[_0x33cba3(0x164)][_0x33cba3(0xb9)]});console['log'](_0x33cba3(0x10e),_0x588d66);_0x2a93ea[0x0]['currency_placement']==0x1?(right_currency=_0x2a93ea[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x2a93ea[0x0][_0x33cba3(0x104)]);var _0x2e837b=_0x111970,_0xb439e1=_0x2cfd08,_0x49120d='',_0x5d5993;for(_0x5d5993 in _0x2e837b){_0x49120d+=_0x33cba3(0xc5)+_0x33cba3(0xc4)+_0x2e837b[_0x5d5993]+_0x33cba3(0x128)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xb439e1[_0x5d5993]+_0x33cba3(0x128)+_0x33cba3(0xe7);}console[_0x33cba3(0x96)](_0x33cba3(0x180),_0x49120d);let _0x338f22=nodemailer[_0x33cba3(0x142)]({'service':_0x33cba3(0x8a),'auth':{'user':_0x43ebda[_0x33cba3(0xb4)],'pass':_0x43ebda[_0x33cba3(0xdf)]}}),_0x5e6aa1={'from':_0x43ebda[_0x33cba3(0xb4)],'to':_0x588d66['email'],'subject':'Purchase\x20Return\x20Mail','attachments':[{'filename':_0x33cba3(0x17b),'path':__dirname+'/../public'+'/upload/'+_0x2a93ea[0x0][_0x33cba3(0x118)],'cid':_0x33cba3(0xdd)}],'html':_0x33cba3(0x155)+_0x33cba3(0xc9)+'</head><body>'+_0x33cba3(0x105)+_0x33cba3(0x10a)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x33cba3(0xbb)+_0x33cba3(0x105)+_0x33cba3(0x8d)+_0x2a93ea[0x0][_0x33cba3(0x13a)]+_0x33cba3(0x111)+_0x33cba3(0xbb)+_0x33cba3(0xbb)+_0x33cba3(0x195)+_0x33cba3(0x105)+_0x33cba3(0xea)+_0x33cba3(0xbc)+_0x5b98fa+'\x20'+_0x33cba3(0x103)+_0x33cba3(0x171)+_0x57cc3c+'\x20'+'</span>'+'</h5>'+_0x33cba3(0xbb)+_0x33cba3(0x179)+_0x33cba3(0x17e)+_0x33cba3(0xc5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x33cba3(0x91)+_0x33cba3(0x87)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+'</tr>'+'</thead>'+_0x33cba3(0x18b)+'\x20'+_0x49120d+'\x20'+_0x33cba3(0xf4)+_0x33cba3(0x14c)+_0x33cba3(0x105)+_0x33cba3(0x13c)+'<h5>'+_0x2a93ea[0x0][_0x33cba3(0x13a)]+_0x33cba3(0x138)+_0x33cba3(0xbb)+_0x33cba3(0xbb)+_0x33cba3(0x10c)};_0x338f22[_0x33cba3(0xad)](_0x5e6aa1,function(_0x4f6659,_0x403147){var _0x1a0cc0=_0x33cba3;_0x4f6659?(console[_0x1a0cc0(0x96)](_0x4f6659),console[_0x1a0cc0(0x96)]('Error\x20Occurs')):console[_0x1a0cc0(0x96)]('Email\x20sent\x20successfully');}),_0x3f6bab[_0x33cba3(0x148)]('success','purchases\x20item\x20return\x20successfull'),_0xa86c1a[_0x33cba3(0xde)]('/all_purchases/view');}catch(_0x26629d){console[_0x33cba3(0x96)](_0x26629d),_0xa86c1a['status'](0xc8)[_0x33cba3(0xe3)]({'message':_0x26629d[_0x33cba3(0xba)]});}}),router[a0_0x48db59(0x17a)](a0_0x48db59(0xaf),auth,async(_0x17c023,_0x4a1eb7)=>{var _0x5d9da2=a0_0x48db59;try{const {username:_0x12cece,email:_0x4953f3,role:_0x4f85e2}=_0x17c023[_0x5d9da2(0x14f)],_0x240bd7=_0x17c023[_0x5d9da2(0x14f)],_0x2aa3d6=await profile['findOne']({'email':_0x240bd7['email']}),_0x5e252f=await master_shop[_0x5d9da2(0x116)](),_0x3da281=_0x17c023['params']['id'],_0x43c94a=await purchases[_0x5d9da2(0xb8)](_0x3da281);if(_0x5e252f[0x0][_0x5d9da2(0x14e)]==_0x5d9da2(0xdc))var _0x426b24=users[_0x5d9da2(0x13b)];else{if(_0x5e252f[0x0][_0x5d9da2(0x14e)]=='Hindi')var _0x426b24=users[_0x5d9da2(0x123)];else{if(_0x5e252f[0x0][_0x5d9da2(0x14e)]==_0x5d9da2(0x97))var _0x426b24=users[_0x5d9da2(0x97)];else{if(_0x5e252f[0x0][_0x5d9da2(0x14e)]==_0x5d9da2(0xc3))var _0x426b24=users[_0x5d9da2(0xc3)];else{if(_0x5e252f[0x0]['language']==_0x5d9da2(0x18c))var _0x426b24=users['French'];else{if(_0x5e252f[0x0][_0x5d9da2(0x14e)]==_0x5d9da2(0x191))var _0x426b24=users[_0x5d9da2(0x183)];else{if(_0x5e252f[0x0][_0x5d9da2(0x14e)]==_0x5d9da2(0xf3))var _0x426b24=users[_0x5d9da2(0xf3)];else{if(_0x5e252f[0x0]['language']==_0x5d9da2(0x9b))var _0x426b24=users[_0x5d9da2(0x172)];}}}}}}}_0x4a1eb7[_0x5d9da2(0x98)]('all_purchases_barcode',{'success':_0x17c023[_0x5d9da2(0x148)](_0x5d9da2(0xa6)),'errors':_0x17c023[_0x5d9da2(0x148)](_0x5d9da2(0xaa)),'role':_0x240bd7,'profile':_0x2aa3d6,'alldata':_0x43c94a,'master_shop':_0x5e252f,'language':_0x426b24}),console[_0x5d9da2(0x96)](alldata);}catch(_0x5d4d48){console[_0x5d9da2(0x96)](_0x5d4d48);}}),router[a0_0x48db59(0x176)](a0_0x48db59(0xe8),async(_0x2a359a,_0x2f380b)=>{var _0x3f8a5d=a0_0x48db59;const {product_code:_0x1aca80}=_0x2a359a[_0x3f8a5d(0x164)];var _0x1e568a;const _0x59d6f6=await product['aggregate']([{'$match':{'primary_code':_0x1aca80,'product_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3f8a5d(0x101),'name':{'$first':_0x3f8a5d(0xd0)},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':_0x3f8a5d(0x110)},'alertquantity':{'$first':_0x3f8a5d(0x199)},'product_code':{'$first':_0x3f8a5d(0x109)},'primary_code':{'$first':_0x3f8a5d(0xfb)},'secondary_code':{'$first':_0x3f8a5d(0x12e)},'maxStocks':{'$first':_0x3f8a5d(0x167)},'maxProdPerUnit':{'$first':_0x3f8a5d(0x162)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x3f8a5d(0x15f)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x221e75=await product[_0x3f8a5d(0x129)]([{'$match':{'secondary_code':_0x1aca80,'product_category':_0x3f8a5d(0x82)}},{'$group':{'_id':_0x3f8a5d(0x101),'name':{'$first':_0x3f8a5d(0xd0)},'category':{'$first':_0x3f8a5d(0x189)},'brand':{'$first':_0x3f8a5d(0xe5)},'unit':{'$first':_0x3f8a5d(0x110)},'alertquantity':{'$first':_0x3f8a5d(0x199)},'product_code':{'$first':_0x3f8a5d(0x109)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x3f8a5d(0x12e)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x3f8a5d(0x162)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x3f8a5d(0x15f)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x59d6f6[_0x3f8a5d(0x8f)]>0x0)_0x1e568a=_0x59d6f6;else _0x221e75[_0x3f8a5d(0x8f)]>0x0&&(_0x1e568a=_0x221e75);_0x2f380b[_0x3f8a5d(0xe3)](_0x1e568a);}),router[a0_0x48db59(0x176)](a0_0x48db59(0x131),async(_0x1aa613,_0x30a9be)=>{var _0x55aeae=a0_0x48db59;const {primaryCode:_0x4d606c,secondaryCode:_0x24327e,productCode:_0x181d4b,bay:_0x2ffbd6,bin:_0x4225c4,types:_0x35f43e,pallet:_0x547a15,warehouses:_0x4b6d91,room:_0x1d8b87}=_0x1aa613[_0x55aeae(0x164)];console[_0x55aeae(0x96)](_0x1aa613[_0x55aeae(0x164)]);try{const _0x380e73=await warehouse[_0x55aeae(0x129)]([{'$match':{'name':_0x4b6d91,'room':_0x1d8b87}},{'$unwind':_0x55aeae(0xcd)},{'$match':{'product_details.bay':_0x2ffbd6,'product_details.bin':_0x4225c4,'product_details.type':_0x35f43e}},{'$group':{'_id':_0x55aeae(0x15a),'name':{'$first':_0x55aeae(0xe1)},'product_stock':{'$first':_0x55aeae(0x9d)},'level':{'$first':_0x55aeae(0x89)},'isle':{'$first':_0x55aeae(0xe6)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x55aeae(0x85)}}}]);_0x30a9be['status'](0xc8)[_0x55aeae(0xe3)](_0x380e73);}catch(_0x11b46b){_0x30a9be[_0x55aeae(0x193)](0x194)[_0x55aeae(0xe3)]({'message':_0x11b46b[_0x55aeae(0xba)]});}}),module[a0_0x48db59(0x126)]=router;