function a0_0x194f(){var _0x75f41a=['date','suppliers_docs','16241DxAggq','product_name','\x20<>\x20','product_code','due_amount','secondary_code_hide','<h5\x20style=\x22text-align:\x20left;\x22>','Portuguese\x20(BR)','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','/preview/:id','$product_details.product_stock','$product.type','</td>','$product_code','prod_pallet','save','$brand','product_cat','COLD\x20STORAGE','finalize','random','Arabic','level','max_product_unit','Logo.png','RMSEmail','rack','gmail','findOne','pallet','$product_details.floorlevel','Rack\x20B','$product','Level','status','</div>','English','German','Raw\x20Materials','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','Enclosed','deliverycode','port','$product_details._id','$paid_amount','primary_code_hide','prod_secondunit','toString','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','Sales\x20Update\x20successfully','$product_details.primary_code','master','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</tr>','Rack\x20F','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','actual_qty','An\x20error\x20occurred.','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','flash','currency','French','Return\x20Goods','purchases\x20item\x20return\x20successfull','$product_details.level','</h5>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','prod_Qty','back','$maxStocks','/invoice/:id','email','all_purchases_barcode','abs','../models/all_models','prod_cat','error','$product_details.product_name','</thead>','language','push','Rack\x20A','/view','isle','stocks','product_code_hide','Error\x20Occurs','MaxStocks_data','errors','purchase_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</body></html>','DRY\x20STORAGE','staff','post','prod_name','delivery_code','rak','password','<tr>','role','prod_code','Enabled','product_stock','$product_details.bay','user_id','22Akokzo','<h2>\x20','$unit','delivery_date','$name','$product_details.bin','Chinese','add_purchases\x20error','table\x20page','/view/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','English\x20(US)','Spanish','<div>','room','edit_purchases_view','$product.quantity','1392904OEfNzq','/all_purchases/view','\x20<\x20wew\x20>\x20','$product_details.maxProducts','<strong>\x20Regards\x20</strong>','$suppliers_docs','/view/add_purchases/:id','$product.bin','prod_level','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/all_purchases/view/','Floor','Room_name','nodemailer','$category','1790874BQKcRD','suppliers','$product.floorlevel','prod_isle','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','user','getMonth','name','39IGRTpa','\x20</h2>','Ambient','body','</span>','Rack\x20E','product','path','all_purchases','../public/language/languages.json','batch_code','invoice','alertQTY','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/../public','express','$alertquantity','payment\x20successfull','Rack\x20C','prod_primunit','all','$invoice','primary_code','$suppliers','Purchase\x20Return','findById','maxStocks','host','quantity','purchase\x20data\x20update\x20successfully','bin','return_purchase','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$maxProdPerUnit','maxperunit','/view/return_purchase/:id','Arabic\x20(ae)','$product_details.isle','warehouse','Receiving\x20Area','string','type','Shelves','RoomAssign','INC-','bay','$product_details.rack','then','stock_data','<span\x20style=\x22float:\x20right;\x22>','site_title','map','return_qty','$note','<tbody\x20style=\x22text-align:\x20center;\x22>','production_date','$batch_code','$product.bay','image','standard_unit','add_purchases','prod_qty','</table>','$expiry_date','Purchase\x20Return\x20Mail','purchase_quantity','/view/add_purchases','getDate','expiry_date','<hr\x20class=\x22my-3\x22>','$product_details','sendMail','paid_amount','2640183VihuVD','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','actual_uom','log','Hindi','prod_unit','concat','Email\x20sent\x20successfully','createTransport','$primary_code','/barcode/:id','/upload/','forEach','36370YtzcHa','slice','$room','\x20Order\x20Number\x20:\x20','params','$product_details.expiry_date','</head><body>','$return_data','catch','$due_amount','get','secondary_code','<!DOCTYPE\x20html>','types','$warehouse_name','length','secondary_unit','redirect','getFullYear','filter','prod_invoice','$product_details.type','<h5>','$_id','\x20Order\x20Date\x20:\x20','$product.room_name','exports','room_name','json','suppliers_data','find','success','2386806QIpsGC','floorlevel','aggregate','storage','/CheckingWarehouse','amount','ejs','<html><head><title></title>','warehouse_name','$date','product_details','$secondary_unit','40436dDEnps','logo','$product_details.storage','message'];a0_0x194f=function(){return _0x75f41a;};return a0_0x194f();}function a0_0x3f89(_0x567dcf,_0x1892ee){var _0x194f65=a0_0x194f();return a0_0x3f89=function(_0x3f89f6,_0x1ae709){_0x3f89f6=_0x3f89f6-0x1a5;var _0x106ef6=_0x194f65[_0x3f89f6];return _0x106ef6;},a0_0x3f89(_0x567dcf,_0x1892ee);}var a0_0x245ab9=a0_0x3f89;(function(_0x51e0f6,_0x12d622){var _0x5abdd4=a0_0x3f89,_0x3885d5=_0x51e0f6();while(!![]){try{var _0x23894c=-parseInt(_0x5abdd4(0x253))/0x1*(-parseInt(_0x5abdd4(0x2c0))/0x2)+-parseInt(_0x5abdd4(0x1ca))/0x3*(-parseInt(_0x5abdd4(0x24d))/0x4)+-parseInt(_0x5abdd4(0x221))/0x5+parseInt(_0x5abdd4(0x241))/0x6+-parseInt(_0x5abdd4(0x214))/0x7+parseInt(_0x5abdd4(0x1b2))/0x8+-parseInt(_0x5abdd4(0x1c1))/0x9;if(_0x23894c===_0x12d622)break;else _0x3885d5['push'](_0x3885d5['shift']());}catch(_0x287780){_0x3885d5['push'](_0x3885d5['shift']());}}}(a0_0x194f,0x48e39));const express=require(a0_0x245ab9(0x1d9)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x245ab9(0x2a0)),auth=require('../middleware/auth'),nodemailer=require(a0_0x245ab9(0x1bf));var ejs=require(a0_0x245ab9(0x247));const path=require(a0_0x245ab9(0x1d1)),users=require(a0_0x245ab9(0x1d3));router[a0_0x245ab9(0x22b)](a0_0x245ab9(0x2a8),auth,async(_0x4edd3d,_0x38a989)=>{var _0x2a9eb2=a0_0x245ab9;try{const {username:_0x522c5d,email:_0x11a2e5,role:_0x373a3c}=_0x4edd3d[_0x2a9eb2(0x1c7)],_0x3198a4=_0x4edd3d[_0x2a9eb2(0x1c7)],_0x31c1f1=await profile[_0x2a9eb2(0x270)]({'email':_0x3198a4[_0x2a9eb2(0x29d)]}),_0x276a1d=await staff[_0x2a9eb2(0x270)]({'email':_0x3198a4['email']});if(_0x3198a4[_0x2a9eb2(0x2ba)]=='staff'){const _0x31b17a=await staff['findOne']({'email':_0x3198a4['email']});}const _0x4904b1=await master_shop[_0x2a9eb2(0x23f)]();let _0x259411;if(_0x3198a4[_0x2a9eb2(0x2ba)]==_0x2a9eb2(0x2b3)){const _0x2b60a2=await staff[_0x2a9eb2(0x270)]({'email':_0x3198a4[_0x2a9eb2(0x29d)]});_0x259411=await purchases[_0x2a9eb2(0x243)]([{'$match':{'warehouse_name':_0x2b60a2['warehouse']}},{'$lookup':{'from':_0x2a9eb2(0x1c2),'localField':_0x2a9eb2(0x1c2),'foreignField':'name','as':_0x2a9eb2(0x252)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x2a9eb2(0x274)},{'$group':{'_id':'$_id','invoice':{'$first':_0x2a9eb2(0x1df)},'suppliers':{'$first':_0x2a9eb2(0x1e1)},'date':{'$first':_0x2a9eb2(0x24a)},'warehouse_name':{'$first':_0x2a9eb2(0x22f)},'room':{'$first':_0x2a9eb2(0x223)},'product':{'$push':'$product'},'note':{'$first':_0x2a9eb2(0x200)},'paid_amount':{'$first':_0x2a9eb2(0x280)},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':_0x2a9eb2(0x228)},'batch_code':{'$first':_0x2a9eb2(0x203)},'expiry_date':{'$first':_0x2a9eb2(0x20a)},'suppliers_docs':{'$first':_0x2a9eb2(0x1b7)},'total_product_quantity':{'$sum':_0x2a9eb2(0x1b1)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0x2a9eb2(0x1b9)},'type':{'$addToSet':_0x2a9eb2(0x25f)},'floorlevel':{'$addToSet':_0x2a9eb2(0x1c3)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x259411=await purchases[_0x2a9eb2(0x243)]([{'$lookup':{'from':_0x2a9eb2(0x1c2),'localField':_0x2a9eb2(0x1c2),'foreignField':_0x2a9eb2(0x1c9),'as':_0x2a9eb2(0x252)}},{'$unwind':_0x2a9eb2(0x1b7)},{'$unwind':_0x2a9eb2(0x274)},{'$group':{'_id':_0x2a9eb2(0x238),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0x2a9eb2(0x1e1)},'date':{'$first':_0x2a9eb2(0x24a)},'warehouse_name':{'$first':_0x2a9eb2(0x22f)},'room':{'$addToSet':_0x2a9eb2(0x23a)},'product':{'$push':_0x2a9eb2(0x274)},'note':{'$first':'$note'},'paid_amount':{'$first':_0x2a9eb2(0x280)},'due_amount':{'$first':_0x2a9eb2(0x22a)},'return_data':{'$first':_0x2a9eb2(0x228)},'batch_code':{'$first':_0x2a9eb2(0x203)},'expiry_date':{'$first':_0x2a9eb2(0x20a)},'suppliers_docs':{'$first':_0x2a9eb2(0x1b7)},'total_product_quantity':{'$sum':_0x2a9eb2(0x1b1)},'level':{'$addToSet':_0x2a9eb2(0x204)},'isle':{'$addToSet':_0x2a9eb2(0x1b9)},'type':{'$addToSet':_0x2a9eb2(0x25f)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x4904b1[0x0][_0x2a9eb2(0x2a5)]==_0x2a9eb2(0x1ac)){var _0xf9745a=users['English'];console[_0x2a9eb2(0x217)](_0xf9745a);}else{if(_0x4904b1[0x0]['language']==_0x2a9eb2(0x218))var _0xf9745a=users[_0x2a9eb2(0x218)];else{if(_0x4904b1[0x0][_0x2a9eb2(0x2a5)]=='German')var _0xf9745a=users['German'];else{if(_0x4904b1[0x0][_0x2a9eb2(0x2a5)]==_0x2a9eb2(0x1ad))var _0xf9745a=users['Spanish'];else{if(_0x4904b1[0x0][_0x2a9eb2(0x2a5)]==_0x2a9eb2(0x293))var _0xf9745a=users[_0x2a9eb2(0x293)];else{if(_0x4904b1[0x0][_0x2a9eb2(0x2a5)]==_0x2a9eb2(0x25a))var _0xf9745a=users['Portuguese'];else{if(_0x4904b1[0x0][_0x2a9eb2(0x2a5)]==_0x2a9eb2(0x1a7))var _0xf9745a=users[_0x2a9eb2(0x1a7)];else{if(_0x4904b1[0x0][_0x2a9eb2(0x2a5)]==_0x2a9eb2(0x1ef))var _0xf9745a=users[_0x2a9eb2(0x269)];}}}}}}}_0x38a989[_0x2a9eb2(0x28f)](_0x2a9eb2(0x1d2),{'success':_0x4edd3d['flash']('success'),'errors':_0x4edd3d[_0x2a9eb2(0x291)](_0x2a9eb2(0x2ae)),'purchases':_0x259411,'role':_0x3198a4,'profile':_0x31c1f1,'master_shop':_0x4904b1,'language':_0xf9745a});}catch(_0xb67619){console['log'](_0x2a9eb2(0x1a9),_0xb67619),_0x38a989[_0x2a9eb2(0x276)](0xc8)[_0x2a9eb2(0x23d)]({'message':_0xb67619['message']});}});function BayBinSelected(_0x49e3af,_0x39556a){var _0x4b9356=a0_0x245ab9,_0x5e6d0d=[],_0x567094=[],_0x4534d6=[],_0x515b99=[],_0x4b8ede=[],_0x5b0ceb=[];let _0x51dc3a=[];if(_0x49e3af==_0x4b9356(0x2b2))switch(_0x39556a){case _0x4b9356(0x2a7):_0x5e6d0d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x567094=[0x1,0x2],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=[_0x4b9356(0x275),'Floor'],_0x4b8ede=['D'],_0x5b0ceb=['A'];break;case _0x4b9356(0x273):_0x5e6d0d=[0x6,0x5,0x4,0x3,0x2,0x1],_0x567094=[0x1,0x2],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=[_0x4b9356(0x275),_0x4b9356(0x1bd)],_0x4b8ede=['D'],_0x5b0ceb=['B'];break;case _0x4b9356(0x1f5):_0x5e6d0d=[0x0],_0x567094=[0x0],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=['Floor'],_0x4b8ede=['D'],_0x5b0ceb=['S'];break;case _0x4b9356(0x1f2):_0x5e6d0d=[0x0],_0x567094=[0x0],_0x515b99=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x4534d6=['Floor'],_0x4b8ede=['D'],_0x5b0ceb=['R'];break;}else{if(_0x49e3af==_0x4b9356(0x266))switch(_0x39556a){case _0x4b9356(0x2a7):_0x5e6d0d=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x567094=['B','F'],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=['Level',_0x4b9356(0x1bd)],_0x4b8ede=['C'],_0x5b0ceb=['A'];break;case _0x4b9356(0x273):_0x5e6d0d=[0x5,0x4,0x3,0x2,0x1],_0x567094=['F','B','S'],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=[_0x4b9356(0x275),_0x4b9356(0x1bd)],_0x4b8ede=['C'],_0x5b0ceb=['B'];break;case _0x4b9356(0x1dc):_0x5e6d0d=[0x1,0x2,0x3,0x4,0x5],_0x567094=['B','F','S'],_0x515b99=[0x5,0x4,0x3,0x2,0x1],_0x4534d6=[_0x4b9356(0x275),'Floor'],_0x4b8ede=['C'],_0x5b0ceb=['C'];break;case'Rack\x20D':_0x5e6d0d=[0x5,0x4,0x3,0x2,0x1],_0x567094=['F','B','S'],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=[_0x4b9356(0x275),_0x4b9356(0x1bd)],_0x4b8ede=['C'],_0x5b0ceb=['D'];break;case _0x4b9356(0x1cf):_0x5e6d0d=[0x4,0x3,0x2,0x1],_0x567094=[0x1,0x2],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=[_0x4b9356(0x275),_0x4b9356(0x1bd)],_0x4b8ede=['C'],_0x5b0ceb=['E'];break;case _0x4b9356(0x28b):_0x5e6d0d=[0x1,0x2,0x3],_0x567094=[0x1,0x2],_0x515b99=[0x1,0x2,0x3,0x4,0x5],_0x4534d6=['Level'],_0x4b8ede=['C'],_0x5b0ceb=['F'];break;}}return{'levels':_0x5e6d0d,'Isle':_0x567094,'rack':_0x515b99,'type':_0x4534d6,'storage':_0x4b8ede,'rak':_0x5b0ceb};}async function getRandom8DigitNumber(){var _0x549a08=a0_0x245ab9;const _0x23ed43=0x989680,_0x4e8819=0x5f5e0ff,_0x14cabb=Math['floor'](Math[_0x549a08(0x268)]()*(_0x4e8819-_0x23ed43+0x1))+_0x23ed43;var _0x17507a;const _0x3c6117=await purchases[_0x549a08(0x270)]({'invoice':'INC-'+_0x14cabb});return _0x3c6117&&_0x3c6117[_0x549a08(0x230)]>0x0?_0x17507a=_0x549a08(0x1f7)+_0x14cabb:_0x17507a=_0x549a08(0x1f7)+_0x14cabb,_0x17507a;}router[a0_0x245ab9(0x22b)](a0_0x245ab9(0x20d),auth,async(_0x2dccf0,_0x1a0dbf)=>{var _0x46d9e3=a0_0x245ab9;try{const {username:_0x536c14,email:_0x33b25b,role:_0x3b9b5b}=_0x2dccf0['user'],_0x1716f5=_0x2dccf0[_0x46d9e3(0x1c7)],_0x526b94=await profile[_0x46d9e3(0x270)]({'email':_0x1716f5[_0x46d9e3(0x29d)]}),_0x3e3fdb=await master_shop[_0x46d9e3(0x23f)](),_0x37849e=await staff[_0x46d9e3(0x270)]({'email':_0x1716f5[_0x46d9e3(0x29d)]}),_0x3622c8=await suppliers[_0x46d9e3(0x23f)]({});let _0x42e9ba;if(_0x1716f5[_0x46d9e3(0x2ba)]=='staff'){const _0x3f8fd6=await staff[_0x46d9e3(0x270)]({'email':_0x1716f5[_0x46d9e3(0x29d)]});_0x42e9ba=await warehouse[_0x46d9e3(0x243)]([{'$match':{'status':_0x46d9e3(0x2bc),'name':_0x3f8fd6['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x46d9e3(0x1a5),'name':{'$first':'$name'}}}]);}else _0x42e9ba=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x46d9e3(0x27a),'name':{'$ne':_0x46d9e3(0x294)}}},{'$group':{'_id':_0x46d9e3(0x1a5),'name':{'$first':'$name'}}}]);const _0x8500e8=await product[_0x46d9e3(0x23f)]({}),_0x3119ca=await warehouse['find']({'status':_0x46d9e3(0x2bc)}),_0x4e4629=await purchases[_0x46d9e3(0x23f)]({}),_0x27f175=_0x4e4629[_0x46d9e3(0x230)]+0x1,_0x52227d=_0x46d9e3(0x1f7)+_0x27f175[_0x46d9e3(0x283)]()['padStart'](0x5,'0');var _0x2949c6=[_0x46d9e3(0x1cc),_0x46d9e3(0x27c)];if(_0x3e3fdb[0x0][_0x46d9e3(0x2a5)]==_0x46d9e3(0x1ac))var _0x1d28c2=users[_0x46d9e3(0x278)];else{if(_0x3e3fdb[0x0]['language']=='Hindi')var _0x1d28c2=users[_0x46d9e3(0x218)];else{if(_0x3e3fdb[0x0][_0x46d9e3(0x2a5)]==_0x46d9e3(0x279))var _0x1d28c2=users[_0x46d9e3(0x279)];else{if(_0x3e3fdb[0x0][_0x46d9e3(0x2a5)]=='Spanish')var _0x1d28c2=users[_0x46d9e3(0x1ad)];else{if(_0x3e3fdb[0x0]['language']==_0x46d9e3(0x293))var _0x1d28c2=users['French'];else{if(_0x3e3fdb[0x0][_0x46d9e3(0x2a5)]==_0x46d9e3(0x25a))var _0x1d28c2=users[_0x46d9e3(0x284)];else{if(_0x3e3fdb[0x0][_0x46d9e3(0x2a5)]==_0x46d9e3(0x1a7))var _0x1d28c2=users[_0x46d9e3(0x1a7)];else{if(_0x3e3fdb[0x0][_0x46d9e3(0x2a5)]==_0x46d9e3(0x1ef))var _0x1d28c2=users[_0x46d9e3(0x269)];}}}}}}}const _0x434a88=getRandom8DigitNumber();_0x434a88[_0x46d9e3(0x1fa)](_0x533fae=>{var _0x11ba90=_0x46d9e3;_0x1a0dbf[_0x11ba90(0x28f)](_0x11ba90(0x207),{'success':_0x2dccf0[_0x11ba90(0x291)]('success'),'errors':_0x2dccf0[_0x11ba90(0x291)](_0x11ba90(0x2ae)),'role':_0x1716f5,'profile':_0x526b94,'suppliers':_0x3622c8,'warehouse':_0x42e9ba,'product':_0x8500e8,'invoice':_0x533fae,'master_shop':_0x3e3fdb,'language':_0x1d28c2,'find_data':_0x3119ca,'rooms_data':_0x2949c6});})[_0x46d9e3(0x229)](_0x4b43ce=>{var _0x4aba3c=_0x46d9e3;_0x2dccf0[_0x4aba3c(0x291)](_0x4aba3c(0x2ae),_0x4aba3c(0x1bb)),_0x1a0dbf[_0x4aba3c(0x232)](_0x4aba3c(0x1b3));});}catch(_0x1109e9){console['log'](_0x1109e9);}}),router[a0_0x245ab9(0x22b)](a0_0x245ab9(0x1b8),auth,async(_0x2344ad,_0x1a3404)=>{var _0x569c0d=a0_0x245ab9;try{const _0x165b98=_0x2344ad[_0x569c0d(0x225)]['id'];console[_0x569c0d(0x217)](_0x165b98);const _0xd40f82=await master_shop[_0x569c0d(0x23f)]();console[_0x569c0d(0x217)](_0x569c0d(0x288),_0xd40f82);const _0x32b22a=await product[_0x569c0d(0x270)]({'name':_0x165b98});console[_0x569c0d(0x217)](_0x569c0d(0x1d0),_0x32b22a),_0x1a3404['status'](0xc8)['json']({'product_data':_0x32b22a,'master':_0xd40f82});}catch(_0x2362e3){console[_0x569c0d(0x217)](_0x569c0d(0x1a8),_0x2362e3);}}),router[a0_0x245ab9(0x2b4)](a0_0x245ab9(0x20d),auth,async(_0x4326f7,_0x4d196a)=>{var _0x1783e2=a0_0x245ab9;try{const {invoice:_0x7b489d,date:_0x4ac485,warehouse_name:_0xf2b55c,prod_name:_0x1a4b17,prod_code:_0x590aa5,prod_qty:_0x476d99,prod_unit:_0x33d9e8,prod_secondunit:_0x4fd4fa,prod_level:_0x220e4e,prod_isle:_0x252b2d,prod_pallet:_0x228dd5,note:_0x2f1c98,expiry_date:_0x5b6195,batch_code:_0xae0485,payable:_0xa48fd0,due_amount:_0x471e67,Room_name:_0x20aef1,primary_code:_0x41385d,secondary_code:_0x5cfd69,MaxStocks_data:_0x234357,PO_number:_0x1a34e0,SCRN:_0x54b874,JO_number:_0x581eb}=_0x4326f7['body'];if(typeof _0x1a4b17==_0x1783e2(0x1f3))var _0x23a499=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x2b5)]],_0x21f57b=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x2bb)]],_0x1aa47f=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x299)]],_0x9b9f7b=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x1dd)]],_0x31ae34=[_0x4326f7[_0x1783e2(0x1cd)]['prod_secondunit']],_0x1a7e8b=[_0x4326f7[_0x1783e2(0x1cd)]['prod_level']],_0x4535ad=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x1e0)]],_0xe6f039=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x22c)]],_0x530a88=[_0x4326f7[_0x1783e2(0x1cd)]['MaxStocks_data']],_0x2d106d=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x1d4)]],_0x277d23=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x20f)]],_0x546fb5=[_0x4326f7['body'][_0x1783e2(0x26b)]],_0x57858e=[_0x4326f7['body'][_0x1783e2(0x1d6)]],_0x59ca58=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x202)]],_0x9e8ef0=[_0x4326f7['body']['prod_cat']],_0x1507f8=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x1f6)]],_0x43fc67=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x27d)]],_0x2c6343=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x235)]],_0x267617=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x28d)]],_0x33de39=[_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x216)]];else var _0x23a499=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x2b5)]],_0x21f57b=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x2bb)]],_0x1aa47f=[..._0x4326f7[_0x1783e2(0x1cd)]['prod_Qty']],_0x9b9f7b=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x1dd)]],_0x31ae34=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x282)]],_0x1a7e8b=[..._0x4326f7['body'][_0x1783e2(0x1ba)]],_0x4535ad=[..._0x4326f7[_0x1783e2(0x1cd)]['primary_code']],_0xe6f039=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x22c)]],_0x530a88=[..._0x4326f7['body'][_0x1783e2(0x2ad)]],_0x2d106d=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x1d4)]],_0x277d23=[..._0x4326f7[_0x1783e2(0x1cd)]['expiry_date']],_0x546fb5=[..._0x4326f7['body'][_0x1783e2(0x26b)]],_0x57858e=[..._0x4326f7[_0x1783e2(0x1cd)]['alertQTY']],_0x59ca58=[..._0x4326f7[_0x1783e2(0x1cd)]['production_date']],_0x9e8ef0=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x2a1)]],_0x1507f8=[..._0x4326f7['body']['RoomAssign']],_0x43fc67=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x27d)]],_0x2c6343=[..._0x4326f7[_0x1783e2(0x1cd)]['prod_invoice']],_0x267617=[..._0x4326f7['body'][_0x1783e2(0x28d)]],_0x33de39=[..._0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x216)]];const _0x1a6c5e=_0x23a499[_0x1783e2(0x1fe)](_0x5d8733=>{return _0x5d8733={'product_name':_0x5d8733};});_0x267617['forEach']((_0xebcb50,_0x18161d)=>{var _0x45fc72=_0x1783e2;_0x1a6c5e[_0x18161d][_0x45fc72(0x28d)]=Math[_0x45fc72(0x29f)](_0xebcb50);}),_0x33de39[_0x1783e2(0x220)]((_0x42f804,_0x3ef992)=>{_0x1a6c5e[_0x3ef992]['actual_uom']=_0x42f804;}),_0x21f57b[_0x1783e2(0x220)]((_0x43a022,_0x153f53)=>{var _0x1abe90=_0x1783e2;_0x1a6c5e[_0x153f53][_0x1abe90(0x256)]=_0x43a022;}),_0x1aa47f[_0x1783e2(0x220)]((_0x2081e6,_0xeadc0f)=>{var _0x35c03b=_0x1783e2;_0x1a6c5e[_0xeadc0f][_0x35c03b(0x1e6)]=Math[_0x35c03b(0x29f)](_0x2081e6);}),_0x9b9f7b[_0x1783e2(0x220)]((_0x1aea71,_0x2e0513)=>{_0x1a6c5e[_0x2e0513]['standard_unit']=_0x1aea71;}),_0x31ae34[_0x1783e2(0x220)]((_0x38429e,_0xae3511)=>{_0x1a6c5e[_0xae3511]['secondary_unit']=_0x38429e;}),_0x1a7e8b[_0x1783e2(0x220)]((_0x422818,_0x326dee)=>{var _0x3a560c=_0x1783e2;_0x1507f8[_0x3a560c(0x220)]((_0x3ff59a,_0x279338)=>{var _0x10dcfb=_0x3a560c;if(_0x3ff59a==_0x10dcfb(0x1f2)&&_0x326dee==_0x279338){console['log'](_0x3ff59a+_0x10dcfb(0x1b4)+_0x326dee+_0x10dcfb(0x255)+_0x279338+_0x10dcfb(0x255)+_0x422818);var _0xcb71a=_0x422818[_0x10dcfb(0x222)](0x3);_0x1a6c5e[_0x326dee][_0x10dcfb(0x244)]=_0x422818[0x0],_0x1a6c5e[_0x326dee][_0x10dcfb(0x26e)]=_0x422818[0x1],_0x1a6c5e[_0x326dee]['bay']=0x0,_0x1a6c5e[_0x326dee]['bin']=0x0,_0x1a6c5e[_0x326dee][_0x10dcfb(0x1f4)]='Floor',_0x1a6c5e[_0x326dee][_0x10dcfb(0x242)]=_0xcb71a;}else{if(_0x3ff59a=='Shelves'&&_0x326dee==_0x279338){var _0xcb71a=_0x422818[_0x10dcfb(0x222)](0x3);_0x1a6c5e[_0x326dee][_0x10dcfb(0x244)]=_0x422818[0x0],_0x1a6c5e[_0x326dee][_0x10dcfb(0x26e)]=_0x422818[0x1],_0x1a6c5e[_0x326dee][_0x10dcfb(0x1f8)]=0x0,_0x1a6c5e[_0x326dee][_0x10dcfb(0x1e8)]=0x0,_0x1a6c5e[_0x326dee][_0x10dcfb(0x1f4)]=_0x10dcfb(0x1bd),_0x1a6c5e[_0x326dee][_0x10dcfb(0x242)]=_0x422818[0x5];}else{if(_0x326dee==_0x279338){var _0x30ae44;if(_0x422818[0x4]=='L')_0x30ae44=_0x10dcfb(0x275);else _0x422818[0x4]=='F'&&(_0x30ae44=_0x10dcfb(0x1bd));_0x1a6c5e[_0x326dee][_0x10dcfb(0x244)]=_0x422818[0x0],_0x1a6c5e[_0x326dee][_0x10dcfb(0x26e)]=_0x422818[0x1],_0x1a6c5e[_0x326dee][_0x10dcfb(0x1f8)]=_0x422818[0x2],_0x1a6c5e[_0x326dee][_0x10dcfb(0x1e8)]=_0x422818[0x3],_0x1a6c5e[_0x326dee][_0x10dcfb(0x1f4)]=_0x30ae44,_0x1a6c5e[_0x326dee][_0x10dcfb(0x242)]=_0x422818[0x5];}}}});}),_0x4535ad[_0x1783e2(0x220)]((_0x51a738,_0x2dd3b2)=>{var _0x4fb0a2=_0x1783e2;_0x1a6c5e[_0x2dd3b2][_0x4fb0a2(0x1e0)]=_0x51a738;}),_0xe6f039[_0x1783e2(0x220)]((_0x107bee,_0x59a76d)=>{var _0x2e1114=_0x1783e2;_0x1a6c5e[_0x59a76d][_0x2e1114(0x22c)]=_0x107bee;}),_0x530a88[_0x1783e2(0x220)]((_0x103369,_0xe1d7e)=>{var _0x4c36a0=_0x1783e2;_0x1a6c5e[_0xe1d7e][_0x4c36a0(0x1e4)]=_0x103369;}),_0x2d106d[_0x1783e2(0x220)]((_0x52ff34,_0x1fb62a)=>{var _0x337d65=_0x1783e2;_0x1a6c5e[_0x1fb62a][_0x337d65(0x1d4)]=_0x52ff34;}),_0x277d23[_0x1783e2(0x220)]((_0x4883f7,_0x49ef02)=>{var _0x313a54=_0x1783e2;_0x1a6c5e[_0x49ef02][_0x313a54(0x20f)]=_0x4883f7;}),_0x546fb5['forEach']((_0x5f408b,_0x4b7251)=>{var _0x5e3ed5=_0x1783e2;_0x1a6c5e[_0x4b7251][_0x5e3ed5(0x1ed)]=_0x5f408b;}),_0x57858e[_0x1783e2(0x220)]((_0x5b792,_0x4a7f92)=>{var _0x49bbff=_0x1783e2;_0x1a6c5e[_0x4a7f92][_0x49bbff(0x1d6)]=_0x5b792;}),_0x59ca58[_0x1783e2(0x220)]((_0x425d67,_0x3a12a9)=>{_0x1a6c5e[_0x3a12a9]['production_date']=_0x425d67;}),_0x9e8ef0[_0x1783e2(0x220)]((_0x2c3d1f,_0x251137)=>{var _0x7ea198=_0x1783e2;_0x1a6c5e[_0x251137][_0x7ea198(0x265)]=_0x2c3d1f;}),_0x1507f8[_0x1783e2(0x220)]((_0x4e169a,_0xb97cfb)=>{_0x1a6c5e[_0xb97cfb]['room_name']=_0x4e169a;}),_0x43fc67[_0x1783e2(0x220)]((_0x4f3734,_0xd7e685)=>{var _0x5d9aa1=_0x1783e2;_0x1a6c5e[_0xd7e685][_0x5d9aa1(0x2b6)]=_0x4f3734;}),_0x2c6343[_0x1783e2(0x220)]((_0x49ac33,_0x4819f9)=>{_0x1a6c5e[_0x4819f9]['invoice']=_0x49ac33;});const _0x13c292=_0x1507f8[_0x1783e2(0x1fe)](_0x450a76=>{return _0x450a76={'room_name':_0x450a76};}),_0x222e86=_0x1a6c5e[_0x1783e2(0x234)](_0x162f1a=>_0x162f1a[_0x1783e2(0x1e6)]!=='0'&&_0x162f1a[_0x1783e2(0x1e6)]!==''),_0x1a58be=new purchases({'invoice':_0x7b489d,'suppliers':_0x4326f7[_0x1783e2(0x1cd)][_0x1783e2(0x1c2)],'date':_0x4ac485,'warehouse_name':_0xf2b55c,'product':_0x222e86,'note':_0x2f1c98,'due_amount':_0x471e67,'POnumber':_0x1a34e0,'SCRN':_0x54b874,'JO_number':_0x581eb,'roomList':_0x13c292}),_0x5576e6=await _0x1a58be[_0x1783e2(0x263)](),_0x328014=await purchases['findOne']({'invoice':_0x7b489d}),_0x1774f4=_0x328014['product'][_0x1783e2(0x1fe)](async _0x2054c1=>{var _0x4c2a8b=_0x1783e2,_0x241fe0=await warehouse[_0x4c2a8b(0x270)]({'name':_0xf2b55c,'room':_0x2054c1['room_name']}),_0x594b8a=0x0;return _0x241fe0[_0x4c2a8b(0x24b)][_0x4c2a8b(0x220)](_0x3524ec=>{var _0x14c184=_0x4c2a8b;_0x3524ec[_0x14c184(0x254)]==_0x2054c1['product_name']&&_0x3524ec['floorlevel']==_0x2054c1['floorlevel']&&_0x3524ec['type']==_0x2054c1[_0x14c184(0x1f4)]&&_0x3524ec['bin']==_0x2054c1[_0x14c184(0x1e8)]&&_0x3524ec['bay']==_0x2054c1[_0x14c184(0x1f8)]&&_0x3524ec[_0x14c184(0x26e)]==_0x2054c1[_0x14c184(0x26e)]&&_0x3524ec[_0x14c184(0x244)]==_0x2054c1['storage']&&_0x3524ec[_0x14c184(0x20f)]==_0x2054c1[_0x14c184(0x20f)]&&_0x3524ec[_0x14c184(0x1d4)]==_0x2054c1[_0x14c184(0x1d4)]&&_0x3524ec[_0x14c184(0x202)]==_0x2054c1[_0x14c184(0x202)]&&_0x3524ec[_0x14c184(0x1d5)]==_0x328014[_0x14c184(0x1d5)]&&(_0x3524ec['product_stock']+=Math[_0x14c184(0x29f)](_0x2054c1['quantity']),_0x594b8a++);}),_0x594b8a===0x0&&_0x241fe0['product_details'][_0x4c2a8b(0x2a6)]({'product_name':_0x2054c1[_0x4c2a8b(0x254)],'product_stock':Math[_0x4c2a8b(0x29f)](_0x2054c1[_0x4c2a8b(0x1e6)]),'primary_code':_0x2054c1[_0x4c2a8b(0x1e0)],'secondary_code':_0x2054c1[_0x4c2a8b(0x22c)],'product_code':_0x2054c1[_0x4c2a8b(0x256)],'storage':_0x2054c1['storage'],'rack':_0x2054c1[_0x4c2a8b(0x26e)],'bay':_0x2054c1[_0x4c2a8b(0x1f8)],'bin':_0x2054c1['bin'],'type':_0x2054c1[_0x4c2a8b(0x1f4)],'floorlevel':_0x2054c1[_0x4c2a8b(0x242)],'maxProducts':_0x2054c1[_0x4c2a8b(0x1e4)],'unit':_0x2054c1[_0x4c2a8b(0x206)],'secondary_unit':_0x2054c1['secondary_unit'],'expiry_date':_0x2054c1[_0x4c2a8b(0x20f)],'maxPerUnit':_0x2054c1[_0x4c2a8b(0x1ed)],'batch_code':_0x2054c1[_0x4c2a8b(0x1d4)],'alertQTY':_0x2054c1['alertQTY'],'production_date':_0x2054c1[_0x4c2a8b(0x202)],'product_cat':_0x2054c1[_0x4c2a8b(0x265)],'invoice':_0x2054c1[_0x4c2a8b(0x1d5)],'actual_qty':Math[_0x4c2a8b(0x29f)](_0x2054c1[_0x4c2a8b(0x28d)]),'actual_uom':_0x2054c1[_0x4c2a8b(0x216)]}),_0x241fe0;});Promise[_0x1783e2(0x1de)](_0x1774f4)[_0x1783e2(0x1fa)](async _0x30bcc1=>{var _0x36fa48=_0x1783e2;try{for(const _0x2552ec of _0x30bcc1){await _0x2552ec['save']();}const _0x270773=await master_shop[_0x36fa48(0x23f)](),_0x50e364=await email_settings[_0x36fa48(0x270)](),_0x10deb7=await supervisor_settings[_0x36fa48(0x23f)]();var _0x2c5d22=_0x328014[_0x36fa48(0x1d0)],_0x19641b='',_0x44291c;for(_0x44291c in _0x2c5d22){_0x19641b+=_0x36fa48(0x2b9)+_0x36fa48(0x289)+_0x2c5d22[_0x44291c][_0x36fa48(0x254)]+'</td>'+_0x36fa48(0x289)+_0x2c5d22[_0x44291c][_0x36fa48(0x256)]+_0x36fa48(0x260)+_0x36fa48(0x289)+_0x2c5d22[_0x44291c][_0x36fa48(0x1e6)]+_0x36fa48(0x260)+_0x36fa48(0x289)+_0x2c5d22[_0x44291c][_0x36fa48(0x206)]+_0x36fa48(0x260)+_0x36fa48(0x289)+_0x2c5d22[_0x44291c][_0x36fa48(0x231)]+_0x36fa48(0x260)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x328014[_0x36fa48(0x249)]+'</td>'+_0x36fa48(0x289)+_0x2c5d22[_0x44291c][_0x36fa48(0x23c)]+_0x36fa48(0x260)+_0x36fa48(0x289)+_0x2c5d22[_0x44291c][_0x36fa48(0x244)]+_0x2c5d22[_0x44291c][_0x36fa48(0x26e)]+_0x2c5d22[_0x44291c]['bay']+_0x2c5d22[_0x44291c][_0x36fa48(0x1e8)]+_0x2c5d22[_0x44291c]['type'][0x0]+_0x2c5d22[_0x44291c][_0x36fa48(0x242)]+'</td>',_0x36fa48(0x28a);}let _0x27aa54=nodemailer['createTransport']({'host':_0x50e364[_0x36fa48(0x1e5)],'port':Number(_0x50e364[_0x36fa48(0x27e)]),'secure':![],'auth':{'user':_0x50e364[_0x36fa48(0x29d)],'pass':_0x50e364[_0x36fa48(0x2b8)]}}),_0x5f26aa={'from':_0x50e364[_0x36fa48(0x29d)],'to':_0x10deb7[0x0][_0x36fa48(0x26d)],'subject':'Purchase\x20Mail','attachments':[{'filename':_0x36fa48(0x26c),'path':__dirname+_0x36fa48(0x1d8)+_0x36fa48(0x21f)+_0x270773[0x0][_0x36fa48(0x205)],'cid':'logo'}],'html':_0x36fa48(0x22d)+_0x36fa48(0x248)+_0x36fa48(0x227)+_0x36fa48(0x1ae)+_0x36fa48(0x298)+'<div>'+_0x36fa48(0x28c)+_0x36fa48(0x277)+_0x36fa48(0x1ae)+_0x36fa48(0x2c1)+_0x270773[0x0][_0x36fa48(0x1fd)]+_0x36fa48(0x1cb)+'</div>'+'</div>'+_0x36fa48(0x210)+_0x36fa48(0x1ae)+_0x36fa48(0x259)+_0x36fa48(0x224)+_0x328014[_0x36fa48(0x1d5)]+'\x20'+_0x36fa48(0x1fc)+_0x36fa48(0x239)+_0x328014[_0x36fa48(0x251)]+'\x20'+_0x36fa48(0x1ce)+_0x36fa48(0x297)+'</div>'+_0x36fa48(0x1ea)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x36fa48(0x2b9)+_0x36fa48(0x1ab)+_0x36fa48(0x290)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x36fa48(0x1eb)+_0x36fa48(0x2b0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x36fa48(0x1d7)+_0x36fa48(0x215)+_0x36fa48(0x28a)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x19641b+'\x20'+'</tbody>'+_0x36fa48(0x209)+_0x36fa48(0x1ae)+'<strong>\x20Regards\x20</strong>'+_0x36fa48(0x237)+_0x270773[0x0][_0x36fa48(0x1fd)]+'</h5>'+'</div>'+_0x36fa48(0x277)+_0x36fa48(0x2b1)};_0x27aa54[_0x36fa48(0x212)](_0x5f26aa,function(_0x2e8fb9,_0x50be7a){var _0x46c0b5=_0x36fa48;_0x2e8fb9?(console[_0x46c0b5(0x217)](_0x2e8fb9),console[_0x46c0b5(0x217)]('Error\x20Occurs')):console[_0x46c0b5(0x217)](_0x46c0b5(0x21b));}),_0x4326f7[_0x36fa48(0x291)]('success','Purchase\x20data\x20added\x20successfully'),_0x4d196a[_0x36fa48(0x232)](_0x36fa48(0x1bc));}catch(_0x105310){console['error'](_0x105310),_0x4d196a['status'](0x1f4)[_0x36fa48(0x23d)]({'error':_0x36fa48(0x1c6)});}})[_0x1783e2(0x229)](_0x53af1a=>{var _0x32ed24=_0x1783e2;console[_0x32ed24(0x2a2)](_0x53af1a),_0x4d196a['status'](0x1f4)[_0x32ed24(0x23d)]({'error':_0x32ed24(0x28e)});});}catch(_0x2b662e){console[_0x1783e2(0x217)](_0x2b662e);}}),router[a0_0x245ab9(0x22b)](a0_0x245ab9(0x25d),auth,async(_0xd982a2,_0x408951)=>{var _0xffb1a6=a0_0x245ab9;try{const {username:_0x1c56aa,email:_0x3ae1ee,role:_0x264d68}=_0xd982a2[_0xffb1a6(0x1c7)],_0x66bfda=_0xd982a2[_0xffb1a6(0x1c7)],_0x35aec7=await profile[_0xffb1a6(0x270)]({'email':_0x66bfda[_0xffb1a6(0x29d)]}),_0x3a6ae5=await master_shop[_0xffb1a6(0x23f)](),_0x5a933f=_0xd982a2[_0xffb1a6(0x225)]['id'],_0x128097=await purchases['findById'](_0x5a933f),_0x263440=await warehouse[_0xffb1a6(0x243)]([{'$match':{'name':_0x128097[_0xffb1a6(0x249)],'room':_0x128097['room']}},{'$unwind':_0xffb1a6(0x211)},{'$group':{'_id':'$product_details._id','name':{'$first':_0xffb1a6(0x2a3)},'product_stock':{'$first':_0xffb1a6(0x25e)},'bay':{'$first':_0xffb1a6(0x2be)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xffb1a6(0x236)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xffb1a6(0x287)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xffb1a6(0x24f)},'rack':{'$first':_0xffb1a6(0x1f9)},'expiry_date':{'$first':_0xffb1a6(0x226)}}}]),_0x32abd9=await customer[_0xffb1a6(0x23f)]({});let _0x53e1a5;if(_0x66bfda['role']==_0xffb1a6(0x2b3)){const _0x3bf406=await staff[_0xffb1a6(0x270)]({'email':_0x66bfda[_0xffb1a6(0x29d)]});_0x53e1a5=await warehouse[_0xffb1a6(0x243)]([{'$match':{'status':'Enabled','name':_0x3bf406[_0xffb1a6(0x1f1)]}},{'$group':{'_id':_0xffb1a6(0x1a5),'name':{'$first':_0xffb1a6(0x1a5)}}}]);}else _0x53e1a5=await warehouse[_0xffb1a6(0x243)]([{'$match':{'status':_0xffb1a6(0x2bc)}},{'$group':{'_id':_0xffb1a6(0x1a5),'name':{'$first':_0xffb1a6(0x1a5)}}}]);const _0x1867fb=await product[_0xffb1a6(0x23f)]({}),_0x554cf9=await suppliers[_0xffb1a6(0x23f)]({}),_0x139b13=BayBinSelected(_0x128097[_0xffb1a6(0x249)],_0x128097[_0xffb1a6(0x1af)]);if(_0x3a6ae5[0x0][_0xffb1a6(0x2a5)]=='English\x20(US)'){var _0x504540=users[_0xffb1a6(0x278)];console[_0xffb1a6(0x217)](_0x504540);}else{if(_0x3a6ae5[0x0][_0xffb1a6(0x2a5)]==_0xffb1a6(0x218))var _0x504540=users['Hindi'];else{if(_0x3a6ae5[0x0][_0xffb1a6(0x2a5)]==_0xffb1a6(0x279))var _0x504540=users[_0xffb1a6(0x279)];else{if(_0x3a6ae5[0x0][_0xffb1a6(0x2a5)]==_0xffb1a6(0x1ad))var _0x504540=users[_0xffb1a6(0x1ad)];else{if(_0x3a6ae5[0x0][_0xffb1a6(0x2a5)]=='French')var _0x504540=users[_0xffb1a6(0x293)];else{if(_0x3a6ae5[0x0]['language']==_0xffb1a6(0x25a))var _0x504540=users['Portuguese'];else{if(_0x3a6ae5[0x0][_0xffb1a6(0x2a5)]==_0xffb1a6(0x1a7))var _0x504540=users[_0xffb1a6(0x1a7)];else{if(_0x3a6ae5[0x0]['language']=='Arabic\x20(ae)')var _0x504540=users[_0xffb1a6(0x269)];}}}}}}}_0x408951[_0xffb1a6(0x28f)](_0xffb1a6(0x1b0),{'success':_0xd982a2[_0xffb1a6(0x291)](_0xffb1a6(0x240)),'errors':_0xd982a2[_0xffb1a6(0x291)](_0xffb1a6(0x2ae)),'role':_0x66bfda,'profile':_0x35aec7,'customer':_0x32abd9,'warehouse':_0x53e1a5,'product':_0x263440,'user':_0x128097,'master_shop':_0x3a6ae5,'unit':_0x1867fb,'language':_0x504540,'suppliers':_0x554cf9,'dataSelected':_0x139b13});}catch(_0x1f04f2){console[_0xffb1a6(0x217)](_0x1f04f2);}}),router[a0_0x245ab9(0x2b4)](a0_0x245ab9(0x25d),auth,async(_0x55573f,_0xff8ecf)=>{var _0x133ede=a0_0x245ab9;try{const _0x182155=_0x55573f[_0x133ede(0x225)]['id'],{invoice:_0x1a15dc,warehouse_name:_0x1a5cea,Room_name:_0x2d670e}=_0x55573f['body'],_0x3bc64c=await warehouse[_0x133ede(0x270)]({'name':_0x1a5cea,'room':_0x2d670e}),_0x1eaf2c=await purchases[_0x133ede(0x270)]({'invoice':_0x1a15dc});_0x1eaf2c[_0x133ede(0x1d0)][_0x133ede(0x220)](_0x39c91e=>{var _0x25bcb3=_0x133ede,_0x472263=0x0;const _0x4bdb00=_0x3bc64c[_0x25bcb3(0x24b)]['map'](_0x454e68=>{var _0xee53ac=_0x25bcb3;_0x454e68[_0xee53ac(0x254)]==_0x39c91e['product_name']&&_0x454e68[_0xee53ac(0x242)]==_0x39c91e['floorlevel']&&_0x454e68[_0xee53ac(0x1f4)]==_0x39c91e[_0xee53ac(0x1f4)]&&_0x454e68[_0xee53ac(0x1e8)]==_0x39c91e[_0xee53ac(0x1e8)]&&_0x454e68[_0xee53ac(0x1f8)]==_0x39c91e[_0xee53ac(0x1f8)]&&_0x454e68[_0xee53ac(0x26e)]==_0x39c91e[_0xee53ac(0x26e)]&&_0x454e68['storage']==_0x39c91e[_0xee53ac(0x244)]&&_0x454e68['expiry_date']==_0x39c91e['expiry_date']&&_0x454e68['batch_code']==_0x39c91e[_0xee53ac(0x1d4)]&&_0x454e68[_0xee53ac(0x202)]==_0x39c91e['production_date']&&_0x454e68[_0xee53ac(0x2c3)]==_0x39c91e[_0xee53ac(0x2c3)]&&_0x454e68[_0xee53ac(0x2b6)]==_0x39c91e[_0xee53ac(0x2b6)]&&(_0x454e68['product_stock']=parseInt(_0x454e68[_0xee53ac(0x2bd)])+parseInt(_0x39c91e[_0xee53ac(0x1e6)]),_0x472263++);});_0x472263=='0'&&(_0x3bc64c[_0x25bcb3(0x24b)]=_0x3bc64c[_0x25bcb3(0x24b)][_0x25bcb3(0x21a)]({'product_name':_0x39c91e['product_name'],'product_stock':_0x39c91e[_0x25bcb3(0x1e6)],'primary_code':_0x39c91e[_0x25bcb3(0x1e0)],'secondary_code':_0x39c91e[_0x25bcb3(0x22c)],'product_code':_0x39c91e[_0x25bcb3(0x256)],'storage':_0x39c91e[_0x25bcb3(0x244)],'rack':_0x39c91e[_0x25bcb3(0x26e)],'bay':_0x39c91e[_0x25bcb3(0x1f8)],'bin':_0x39c91e[_0x25bcb3(0x1e8)],'type':_0x39c91e[_0x25bcb3(0x1f4)],'floorlevel':_0x39c91e[_0x25bcb3(0x242)],'maxProducts':_0x39c91e[_0x25bcb3(0x1e4)],'unit':_0x39c91e[_0x25bcb3(0x206)],'secondary_unit':_0x39c91e[_0x25bcb3(0x231)],'expiry_date':_0x39c91e['expiry_date'],'maxPerUnit':_0x39c91e[_0x25bcb3(0x1ed)],'batch_code':_0x39c91e['batch_code'],'alertQTY':_0x39c91e[_0x25bcb3(0x1d6)],'production_date':_0x39c91e[_0x25bcb3(0x202)],'delivery_date':_0x39c91e['delivery_date'],'delivery_code':_0x39c91e[_0x25bcb3(0x2b6)]}));}),await _0x3bc64c[_0x133ede(0x263)](),_0x1eaf2c[_0x133ede(0x267)]='True';const _0x398707=await _0x1eaf2c[_0x133ede(0x263)]();_0x55573f[_0x133ede(0x291)](_0x133ede(0x240),_0x133ede(0x286)),_0xff8ecf[_0x133ede(0x232)]('/all_purchases/view');}catch(_0x16da35){console[_0x133ede(0x217)](_0x16da35);}}),router[a0_0x245ab9(0x22b)](a0_0x245ab9(0x1aa),auth,async(_0x46ca0a,_0x2815ce)=>{var _0x5026b8=a0_0x245ab9;try{const {username:_0x331a85,email:_0x2700b3,role:_0x7f4b01}=_0x46ca0a[_0x5026b8(0x1c7)],_0x845e8c=_0x46ca0a['user'],_0x102c70=await profile[_0x5026b8(0x270)]({'email':_0x845e8c['email']}),_0x590a58=await master_shop['find'](),_0x3473cd=_0x46ca0a['params']['id'],_0x419d6a=await purchases['findById'](_0x3473cd),_0x10b096=await suppliers[_0x5026b8(0x23f)]({});let _0x4f59de;if(_0x845e8c['role']==_0x5026b8(0x2b3)){const _0x1398ae=await staff[_0x5026b8(0x270)]({'email':_0x845e8c['email']});_0x4f59de=await warehouse[_0x5026b8(0x23f)]({'status':_0x5026b8(0x2bc),'name':_0x1398ae[_0x5026b8(0x1f1)],'warehouse_category':'Raw\x20Materials'});}else _0x4f59de=await warehouse[_0x5026b8(0x243)]([{'$match':{'status':_0x5026b8(0x2bc),'warehouse_category':_0x5026b8(0x27a)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x3d3ec4=await product[_0x5026b8(0x23f)]({}),_0x249693=BayBinSelected(_0x419d6a[_0x5026b8(0x249)],_0x419d6a[_0x5026b8(0x1af)]);let _0x55b5c6=new Date(_0x419d6a[_0x5026b8(0x20f)]),_0x12bbab=('0'+_0x55b5c6['getDate']())[_0x5026b8(0x222)](-0x2),_0x6ef86c=('0'+(_0x55b5c6[_0x5026b8(0x1c8)]()+0x1))[_0x5026b8(0x222)](-0x2),_0x3eb2fc=_0x55b5c6['getFullYear'](),_0xf3b936=_0x3eb2fc+'-'+_0x6ef86c+'-'+_0x12bbab;if(_0x590a58[0x0][_0x5026b8(0x2a5)]==_0x5026b8(0x1ac)){var _0x251004=users[_0x5026b8(0x278)];console['log'](_0x251004);}else{if(_0x590a58[0x0][_0x5026b8(0x2a5)]==_0x5026b8(0x218))var _0x251004=users['Hindi'];else{if(_0x590a58[0x0][_0x5026b8(0x2a5)]==_0x5026b8(0x279))var _0x251004=users[_0x5026b8(0x279)];else{if(_0x590a58[0x0][_0x5026b8(0x2a5)]==_0x5026b8(0x1ad))var _0x251004=users[_0x5026b8(0x1ad)];else{if(_0x590a58[0x0]['language']==_0x5026b8(0x293))var _0x251004=users[_0x5026b8(0x293)];else{if(_0x590a58[0x0][_0x5026b8(0x2a5)]=='Portuguese\x20(BR)')var _0x251004=users[_0x5026b8(0x284)];else{if(_0x590a58[0x0]['language']==_0x5026b8(0x1a7))var _0x251004=users[_0x5026b8(0x1a7)];else{if(_0x590a58[0x0][_0x5026b8(0x2a5)]==_0x5026b8(0x1ef))var _0x251004=users[_0x5026b8(0x269)];}}}}}}}_0x2815ce[_0x5026b8(0x28f)]('edit_purchases',{'success':_0x46ca0a[_0x5026b8(0x291)](_0x5026b8(0x240)),'errors':_0x46ca0a[_0x5026b8(0x291)](_0x5026b8(0x2ae)),'role':_0x845e8c,'profile':_0x102c70,'purchases':_0x419d6a,'suppliers':_0x10b096,'warehouse':_0x4f59de,'product':_0x3d3ec4,'master_shop':_0x590a58,'language':_0x251004,'ed_fullDate':_0xf3b936,'dataSelected':_0x249693});}catch(_0x425a50){console[_0x5026b8(0x217)](_0x425a50);}}),router[a0_0x245ab9(0x2b4)](a0_0x245ab9(0x1aa),auth,async(_0x33d206,_0x3d31d2)=>{var _0x5f5272=a0_0x245ab9;try{const _0x5e1d1b=_0x33d206[_0x5f5272(0x225)]['id'],_0x3b0833=await purchases[_0x5f5272(0x270)]({'_id':_0x33d206[_0x5f5272(0x225)]['id']}),_0x293f33=await warehouse['findOne']({'name':_0x3b0833[_0x5f5272(0x249)],'room':_0x3b0833[_0x5f5272(0x1af)]});_0x3b0833[_0x5f5272(0x1d0)][_0x5f5272(0x220)](_0x539c35=>{var _0xcf07d6=_0x5f5272;const _0x3cac24=_0x293f33[_0xcf07d6(0x24b)][_0xcf07d6(0x1fe)](_0x5b70a0=>{var _0x39823f=_0xcf07d6;_0x5b70a0[_0x39823f(0x254)]==_0x539c35['product_name']&&_0x5b70a0[_0x39823f(0x242)]==_0x539c35[_0x39823f(0x242)]&&_0x5b70a0[_0x39823f(0x1f4)]==_0x539c35[_0x39823f(0x1f4)]&&_0x5b70a0[_0x39823f(0x1e8)]==_0x539c35[_0x39823f(0x1e8)]&&_0x5b70a0['bay']==_0x539c35[_0x39823f(0x1f8)]&&_0x5b70a0[_0x39823f(0x26e)]==_0x539c35[_0x39823f(0x26e)]&&_0x5b70a0[_0x39823f(0x244)]==_0x539c35['storage']&&(_0x5b70a0['product_stock']=parseInt(_0x5b70a0[_0x39823f(0x2bd)])-parseInt(_0x539c35[_0x39823f(0x1e6)]));});}),await _0x293f33[_0x5f5272(0x263)]();const {invoice:_0x442e05,suppliers:_0x53229d,date:_0x1f3819,warehouse_name:_0x2bd0a1,prod_name:_0xc000c,prod_code:_0x21ae85,prod_qty:_0x579615,prod_unit:_0xf2e47c,prod_secondunit:_0x2bc0b1,prod_level:_0xded7f5,prod_isle:_0x19f1de,prod_pallet:_0x5285b9,note:_0xd0d903,expiry_date:_0x4fc843,batch_code:_0x3a4eb2,paid_amount:_0x69715d,due_amount:_0x435d21,Room_name:_0x51fe34,primary_code:_0x1e25c0,secondary_code:_0x15bb7f,PO_number:_0x6a3896,JO_number:_0x560a95}=_0x33d206['body'];if(typeof _0xc000c==_0x5f5272(0x1f3))var _0x197118=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x2b5)]],_0x872bdb=[_0x33d206[_0x5f5272(0x1cd)]['prod_code']],_0x285ea2=[_0x33d206['body'][_0x5f5272(0x208)]],_0x21fa4a=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x219)]],_0x2c6393=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x282)]],_0xaf1066=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x1ba)]],_0xe25834=[_0x33d206['body'][_0x5f5272(0x1c4)]],_0x3f4b7a=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x262)]],_0x1a5c31=[_0x33d206[_0x5f5272(0x1cd)]['primary_code']],_0x3031ad=[_0x33d206['body']['secondary_code']],_0x58128c=[_0x33d206[_0x5f5272(0x1cd)]['MaxStocks_data']],_0x1add1a=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x1d4)]],_0xcbdaa6=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x20f)]],_0x216d5c=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x244)]],_0x15b804=[_0x33d206['body'][_0x5f5272(0x2b7)]],_0x5829da=[_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x1f4)]];else var _0x197118=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x2b5)]],_0x872bdb=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x2bb)]],_0x285ea2=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x208)]],_0x21fa4a=[..._0x33d206['body'][_0x5f5272(0x219)]],_0x2c6393=[..._0x33d206['body'][_0x5f5272(0x282)]],_0xaf1066=[..._0x33d206[_0x5f5272(0x1cd)]['prod_level']],_0xe25834=[..._0x33d206['body'][_0x5f5272(0x1c4)]],_0x3f4b7a=[..._0x33d206[_0x5f5272(0x1cd)]['prod_pallet']],_0x1a5c31=[..._0x33d206['body'][_0x5f5272(0x1e0)]],_0x3031ad=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x22c)]],_0x58128c=[..._0x33d206['body'][_0x5f5272(0x2ad)]],_0x1add1a=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x1d4)]],_0xcbdaa6=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x20f)]],_0x216d5c=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x244)]],_0x15b804=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x2b7)]],_0x5829da=[..._0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x1f4)]];const _0x223245=_0x197118[_0x5f5272(0x1fe)](_0x14a614=>{return _0x14a614={'product_name':_0x14a614};});_0x872bdb['forEach']((_0x943f06,_0x10e9e0)=>{var _0x575f71=_0x5f5272;_0x223245[_0x10e9e0][_0x575f71(0x256)]=_0x943f06;}),_0x285ea2[_0x5f5272(0x220)]((_0x1757d8,_0x262071)=>{var _0x709de4=_0x5f5272;_0x223245[_0x262071][_0x709de4(0x1e6)]=_0x1757d8;}),_0x21fa4a[_0x5f5272(0x220)]((_0x2fa952,_0x24d24c)=>{var _0x571361=_0x5f5272;_0x223245[_0x24d24c][_0x571361(0x206)]=_0x2fa952;}),_0x2c6393[_0x5f5272(0x220)]((_0x421333,_0x12c917)=>{var _0x58fca0=_0x5f5272;_0x223245[_0x12c917][_0x58fca0(0x231)]=_0x421333;}),_0xaf1066[_0x5f5272(0x220)]((_0x3fc291,_0x11d0cd)=>{_0x223245[_0x11d0cd]['bay']=_0x3fc291;}),_0xe25834[_0x5f5272(0x220)]((_0x3d6407,_0x4aa3d1)=>{var _0x45c82e=_0x5f5272;_0x223245[_0x4aa3d1][_0x45c82e(0x1e8)]=_0x3d6407;}),_0x3f4b7a[_0x5f5272(0x220)]((_0x5c95a1,_0x2c15cb)=>{_0x223245[_0x2c15cb]['floorlevel']=_0x5c95a1;}),_0x1a5c31['forEach']((_0x3e56f0,_0x3e0ca3)=>{var _0x5348b5=_0x5f5272;_0x223245[_0x3e0ca3][_0x5348b5(0x1e0)]=_0x3e56f0;}),_0x3031ad[_0x5f5272(0x220)]((_0x1d3341,_0x216c3b)=>{var _0x1345f3=_0x5f5272;_0x223245[_0x216c3b][_0x1345f3(0x22c)]=_0x1d3341;}),_0x58128c[_0x5f5272(0x220)]((_0x2a9860,_0x3481da)=>{var _0x2ca9d6=_0x5f5272;_0x223245[_0x3481da][_0x2ca9d6(0x1e4)]=_0x2a9860;}),_0x1add1a[_0x5f5272(0x220)]((_0x377e72,_0x34cff4)=>{var _0x33d52e=_0x5f5272;_0x223245[_0x34cff4][_0x33d52e(0x1d4)]=_0x377e72;}),_0xcbdaa6[_0x5f5272(0x220)]((_0x1817db,_0x33477c)=>{var _0xb3204e=_0x5f5272;_0x223245[_0x33477c][_0xb3204e(0x20f)]=_0x1817db;}),_0x5829da[_0x5f5272(0x220)]((_0x4187d9,_0x4526ab)=>{var _0x1db0a4=_0x5f5272;_0x223245[_0x4526ab][_0x1db0a4(0x1f4)]=_0x4187d9;}),_0x216d5c['forEach']((_0x27cc37,_0x24dfad)=>{var _0x146f8e=_0x5f5272;_0x223245[_0x24dfad][_0x146f8e(0x244)]=_0x27cc37;}),_0x15b804['forEach']((_0x49c5c9,_0x20ae4a)=>{var _0x1982b0=_0x5f5272;_0x223245[_0x20ae4a][_0x1982b0(0x26e)]=_0x49c5c9;});const _0x4fba11=_0x223245['filter'](_0x8a463b=>_0x8a463b['quantity']!=='0'&&_0x8a463b[_0x5f5272(0x1e6)]!=='');_0x3b0833[_0x5f5272(0x1d5)]=_0x442e05,_0x3b0833['suppliers']=_0x53229d,_0x3b0833[_0x5f5272(0x251)]=_0x1f3819,_0x3b0833['warehouse_name']=_0x2bd0a1,_0x3b0833['product']=_0x4fba11,_0x3b0833['note']=_0xd0d903,_0x3b0833[_0x5f5272(0x213)]=_0x69715d,_0x3b0833[_0x5f5272(0x257)]=_0x435d21,_0x3b0833[_0x5f5272(0x1af)]=_0x51fe34,_0x3b0833['POnumber']=_0x6a3896,_0x3b0833['JO_number']=_0x560a95;const _0x3728b9=await _0x3b0833[_0x5f5272(0x263)](),_0x39e1ef=await warehouse['findOne']({'name':_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x249)],'room':_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x1be)]});_0x3b0833[_0x5f5272(0x1d0)][_0x5f5272(0x220)](_0x5380b8=>{var _0x1acef3=_0x5f5272,_0xd49c1a=0x0;const _0x4acd70=_0x39e1ef[_0x1acef3(0x24b)][_0x1acef3(0x1fe)](_0xe1f763=>{var _0x58b577=_0x1acef3;_0xe1f763[_0x58b577(0x254)]==_0x5380b8[_0x58b577(0x254)]&&_0xe1f763[_0x58b577(0x242)]==_0x5380b8['floorlevel']&&_0xe1f763[_0x58b577(0x1f4)]==_0x5380b8[_0x58b577(0x1f4)]&&_0xe1f763[_0x58b577(0x1e8)]==_0x5380b8[_0x58b577(0x1e8)]&&_0xe1f763[_0x58b577(0x1f8)]==_0x5380b8[_0x58b577(0x1f8)]&&_0xe1f763[_0x58b577(0x26e)]==_0x5380b8[_0x58b577(0x26e)]&&_0xe1f763['storage']==_0x5380b8[_0x58b577(0x244)]&&(_0xe1f763[_0x58b577(0x2bd)]=parseInt(_0xe1f763[_0x58b577(0x2bd)])+parseInt(_0x5380b8[_0x58b577(0x1e6)]),_0xd49c1a++);});_0xd49c1a=='0'&&(_0x39e1ef[_0x1acef3(0x24b)]=_0x39e1ef[_0x1acef3(0x24b)][_0x1acef3(0x21a)]({'product_name':_0x5380b8['product_name'],'product_stock':_0x5380b8['quantity'],'primary_code':_0x5380b8[_0x1acef3(0x1e0)],'secondary_code':_0x5380b8[_0x1acef3(0x22c)],'product_code':_0x5380b8[_0x1acef3(0x256)],'storage':_0x5380b8['storage'],'rack':_0x5380b8[_0x1acef3(0x26e)],'bay':_0x5380b8[_0x1acef3(0x1f8)],'bin':_0x5380b8['bin'],'type':_0x5380b8[_0x1acef3(0x1f4)],'floorlevel':_0x5380b8[_0x1acef3(0x242)],'maxProducts':_0x5380b8['maxStocks'],'unit':_0x5380b8['standard_unit'],'secondary_unit':_0x5380b8[_0x1acef3(0x231)],'expiry_date':_0x5380b8['expiry_date']}));}),await _0x39e1ef['save']();const _0x36f5b0=await s_payment_data['findOne']({'invoice':_0x33d206['body'][_0x5f5272(0x1d5)]});if(_0x36f5b0===null){}else console[_0x5f5272(0x217)]('suppliers',_0x36f5b0,_0x33d206['body'][_0x5f5272(0x1d5)]),_0x36f5b0[_0x5f5272(0x1c2)]=_0x33d206[_0x5f5272(0x1cd)][_0x5f5272(0x1c2)],await _0x36f5b0[_0x5f5272(0x263)]();_0x33d206[_0x5f5272(0x291)](_0x5f5272(0x240),_0x5f5272(0x1e7)),_0x3d31d2[_0x5f5272(0x232)](_0x5f5272(0x1b3));}catch(_0x2c785e){console[_0x5f5272(0x217)](_0x2c785e);}}),router['post']('/give_payment/:id',auth,async(_0x509292,_0x12f46a)=>{var _0x4a50a2=a0_0x245ab9;try{const _0x351c93=_0x509292[_0x4a50a2(0x225)]['id'],{invoice:_0x1ecc2e,suppliers:_0xf34699,payable:_0x5047e2,due_amount:_0x309052}=_0x509292[_0x4a50a2(0x1cd)],_0xc5c03f=await purchases[_0x4a50a2(0x1e3)](_0x351c93);var _0x1624a9=_0x5047e2-_0x309052;_0xc5c03f[_0x4a50a2(0x213)]=parseFloat(_0xc5c03f['paid_amount'])+parseFloat(_0x309052),_0xc5c03f['due_amount']=_0x1624a9;const _0x4d61ac=await _0xc5c03f['save']();console['log'](_0x4d61ac);const _0xcb7b32=await s_payment_data[_0x4a50a2(0x270)]({'invoice':_0x1ecc2e});_0xcb7b32[_0x4a50a2(0x246)]=_0x1624a9,await _0xcb7b32[_0x4a50a2(0x263)]();let _0x2a8456=new Date(),_0x2f0a75=('0'+_0x2a8456[_0x4a50a2(0x20e)]())[_0x4a50a2(0x222)](-0x2),_0x10fdc2=('0'+(_0x2a8456[_0x4a50a2(0x1c8)]()+0x1))[_0x4a50a2(0x222)](-0x2),_0x4ed394=_0x2a8456[_0x4a50a2(0x233)](),_0x5abc46=_0x4ed394+'-'+_0x10fdc2+'-'+_0x2f0a75;const _0x4b7580=new suppliers_payment({'invoice':_0x1ecc2e,'date':_0x4ed394+'-'+_0x10fdc2+'-'+_0x2f0a75,'suppliers':_0xf34699,'reason':'Paid\x20For\x20Purchase','amount':_0x309052}),_0xa09480=await _0x4b7580[_0x4a50a2(0x263)]();_0x509292[_0x4a50a2(0x291)]('success',_0x4a50a2(0x1db)),_0x12f46a[_0x4a50a2(0x232)]('/all_purchases/view');}catch(_0x1be3b1){console[_0x4a50a2(0x217)](_0x1be3b1);}}),router['get'](a0_0x245ab9(0x29c),auth,async(_0x2ad3c4,_0x294337)=>{var _0x43047f=a0_0x245ab9;try{const {username:_0x567d73,email:_0x1ee808,role:_0x7a7483}=_0x2ad3c4[_0x43047f(0x1c7)],_0x32e6a7=_0x2ad3c4['user'],_0x39e9e6=await profile[_0x43047f(0x270)]({'email':_0x32e6a7[_0x43047f(0x29d)]}),_0x5f41ef=await master_shop[_0x43047f(0x23f)]();console[_0x43047f(0x217)](_0x43047f(0x288),_0x5f41ef);const _0x1614f6=_0x2ad3c4['params']['id'],_0x30165b=await purchases[_0x43047f(0x1e3)](_0x1614f6);console[_0x43047f(0x217)](_0x30165b);const _0x5a04a3=await suppliers[_0x43047f(0x270)]({'name':_0x30165b['suppliers']});console[_0x43047f(0x217)](_0x5a04a3);if(_0x5f41ef[0x0]['language']==_0x43047f(0x1ac)){var _0x3ae560=users[_0x43047f(0x278)];console[_0x43047f(0x217)](_0x3ae560);}else{if(_0x5f41ef[0x0][_0x43047f(0x2a5)]==_0x43047f(0x218))var _0x3ae560=users[_0x43047f(0x218)];else{if(_0x5f41ef[0x0][_0x43047f(0x2a5)]==_0x43047f(0x279))var _0x3ae560=users[_0x43047f(0x279)];else{if(_0x5f41ef[0x0]['language']==_0x43047f(0x1ad))var _0x3ae560=users[_0x43047f(0x1ad)];else{if(_0x5f41ef[0x0][_0x43047f(0x2a5)]==_0x43047f(0x293))var _0x3ae560=users[_0x43047f(0x293)];else{if(_0x5f41ef[0x0]['language']==_0x43047f(0x25a))var _0x3ae560=users['Portuguese'];else{if(_0x5f41ef[0x0][_0x43047f(0x2a5)]==_0x43047f(0x1a7))var _0x3ae560=users[_0x43047f(0x1a7)];else{if(_0x5f41ef[0x0][_0x43047f(0x2a5)]==_0x43047f(0x1ef))var _0x3ae560=users['Arabic'];}}}}}}}_0x294337[_0x43047f(0x28f)](_0x43047f(0x2af),{'success':_0x2ad3c4['flash'](_0x43047f(0x240)),'errors':_0x2ad3c4[_0x43047f(0x291)](_0x43047f(0x2ae)),'role':_0x32e6a7,'profile':_0x39e9e6,'master_shop':_0x5f41ef,'supplier':_0x5a04a3,'purchase':_0x30165b,'language':_0x3ae560});}catch(_0x1a2f66){console['log'](_0x1a2f66);}}),router[a0_0x245ab9(0x22b)](a0_0x245ab9(0x1ee),auth,async(_0x43b080,_0x2f0f3b)=>{var _0x48d1cf=a0_0x245ab9;try{const {username:_0x3cc7f5,email:_0xcbb7c6,role:_0x5e84fe}=_0x43b080['user'],_0xdf098=_0x43b080[_0x48d1cf(0x1c7)],_0x2fe9b1=await profile['findOne']({'email':_0xdf098[_0x48d1cf(0x29d)]}),_0x50df14=await master_shop[_0x48d1cf(0x23f)]();console['log']('master',_0x50df14);const _0x19d039=_0x43b080[_0x48d1cf(0x225)]['id'];console[_0x48d1cf(0x217)](_0x19d039);const _0x1a163e=await purchases['findById'](_0x19d039);console[_0x48d1cf(0x217)](_0x48d1cf(0x2bf),_0x1a163e);const _0x437ef5=await product[_0x48d1cf(0x23f)]({}),_0x55ead7=await warehouse['aggregate']([{'$match':{'name':_0x1a163e['warehouse_name'],'room':_0x1a163e[_0x48d1cf(0x1af)],'warehouse_category':_0x48d1cf(0x27a)}},{'$unwind':_0x48d1cf(0x211)},{'$group':{'_id':_0x48d1cf(0x27f),'name':{'$first':_0x48d1cf(0x2a3)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x48d1cf(0x1a6)},'type':{'$first':_0x48d1cf(0x236)},'floorlevel':{'$first':_0x48d1cf(0x272)},'primary_code':{'$first':_0x48d1cf(0x287)},'secondary_code':{'$first':_0x48d1cf(0x25b)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x48d1cf(0x24f)},'rack':{'$first':_0x48d1cf(0x1f9)}}}]);warehouse_data=await warehouse[_0x48d1cf(0x243)]([{'$match':{'status':'Enabled','name':_0x48d1cf(0x294),'warehouse_category':_0x48d1cf(0x27a)}},{'$group':{'_id':_0x48d1cf(0x1a5),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console[_0x48d1cf(0x217)](_0x48d1cf(0x1fb),_0x55ead7);if(_0x50df14[0x0][_0x48d1cf(0x2a5)]==_0x48d1cf(0x1ac)){var _0xc47b98=users[_0x48d1cf(0x278)];console[_0x48d1cf(0x217)](_0xc47b98);}else{if(_0x50df14[0x0][_0x48d1cf(0x2a5)]==_0x48d1cf(0x218))var _0xc47b98=users[_0x48d1cf(0x218)];else{if(_0x50df14[0x0][_0x48d1cf(0x2a5)]==_0x48d1cf(0x279))var _0xc47b98=users['German'];else{if(_0x50df14[0x0][_0x48d1cf(0x2a5)]==_0x48d1cf(0x1ad))var _0xc47b98=users[_0x48d1cf(0x1ad)];else{if(_0x50df14[0x0][_0x48d1cf(0x2a5)]=='French')var _0xc47b98=users['French'];else{if(_0x50df14[0x0]['language']==_0x48d1cf(0x25a))var _0xc47b98=users[_0x48d1cf(0x284)];else{if(_0x50df14[0x0][_0x48d1cf(0x2a5)]==_0x48d1cf(0x1a7))var _0xc47b98=users[_0x48d1cf(0x1a7)];else{if(_0x50df14[0x0][_0x48d1cf(0x2a5)]==_0x48d1cf(0x1ef))var _0xc47b98=users[_0x48d1cf(0x269)];}}}}}}}_0x2f0f3b[_0x48d1cf(0x28f)](_0x48d1cf(0x1e9),{'success':_0x43b080['flash'](_0x48d1cf(0x240)),'errors':_0x43b080['flash']('errors'),'role':_0xdf098,'profile':_0x2fe9b1,'user':_0x1a163e,'stock':_0x55ead7,'master_shop':_0x50df14,'product':_0x437ef5,'language':_0xc47b98,'warehouse':warehouse_data});}catch(_0x18fcdf){console[_0x48d1cf(0x217)](_0x18fcdf);}}),router[a0_0x245ab9(0x2b4)](a0_0x245ab9(0x1ee),auth,async(_0x19eafa,_0xf16213)=>{var _0x1360b1=a0_0x245ab9;try{const {invoice:_0x19b5ac,date:_0x487ede,warehouse_name:_0x1209d5,Room_name:_0xbd5e83,product_name:_0x19168b,purchase_quantity:_0x37e548,stocks:_0x48ab14,return_qty:_0x34ae23,note:_0x5e3abb,level:_0x4f7661,isle:_0x436663,pallet:_0x4cd8ca,to_warehouse_name:_0xd0d032,to_Room_name:_0x3dfacc}=_0x19eafa[_0x1360b1(0x1cd)],_0x42a3a7=await purchases[_0x1360b1(0x270)]({'_id':_0x19eafa['params']['id']}),_0x2e28d6=await warehouse[_0x1360b1(0x270)]({'name':_0x1209d5,'room':_0xbd5e83});if(typeof _0x19168b==_0x1360b1(0x1f3))var _0x6dceb7=[_0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x254)]],_0x2aac59=[_0x19eafa[_0x1360b1(0x1cd)]['purchase_quantity']],_0x4c9bac=[_0x19eafa['body']['stocks']],_0x38827a=[_0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x1ff)]],_0x3c91ed=[_0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x26a)]],_0x4c9725=[_0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x2a9)]],_0x287c39=[_0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x271)]],_0xcf3f8=[_0x19eafa['body'][_0x1360b1(0x22e)]],_0xe5268e=[_0x19eafa[_0x1360b1(0x1cd)]['product_code_hide']],_0x420ecc=[_0x19eafa['body'][_0x1360b1(0x281)]],_0x434616=[_0x19eafa[_0x1360b1(0x1cd)]['secondary_code_hide']];else var _0x6dceb7=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x254)]],_0x2aac59=[..._0x19eafa[_0x1360b1(0x1cd)]['purchase_quantity']],_0x4c9bac=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x2aa)]],_0x38827a=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x1ff)]],_0x3c91ed=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x26a)]],_0x4c9725=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x2a9)]],_0x287c39=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x271)]],_0xcf3f8=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x22e)]],_0xe5268e=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x2ab)]],_0x420ecc=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x281)]],_0x434616=[..._0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x258)]];const _0xc648e6=_0x6dceb7[_0x1360b1(0x1fe)](_0x3c39a0=>{return _0x3c39a0={'product_name':_0x3c39a0};});_0x2aac59[_0x1360b1(0x220)]((_0x4599f8,_0x2e2d46)=>{var _0x10d2cc=_0x1360b1;_0xc648e6[_0x2e2d46][_0x10d2cc(0x20c)]=_0x4599f8;}),_0x4c9bac[_0x1360b1(0x220)]((_0x584a81,_0x558d9e)=>{_0xc648e6[_0x558d9e]['stock_quantity']=_0x584a81;}),_0x38827a[_0x1360b1(0x220)]((_0x3ee1f5,_0x3e31d7)=>{var _0x4e5e2a=_0x1360b1;_0xc648e6[_0x3e31d7][_0x4e5e2a(0x1ff)]=_0x3ee1f5;}),_0x3c91ed[_0x1360b1(0x220)]((_0x48a64d,_0x4f64eb)=>{var _0x1c56a9=_0x1360b1;_0xc648e6[_0x4f64eb][_0x1c56a9(0x1f8)]=_0x48a64d;}),_0x4c9725[_0x1360b1(0x220)]((_0x19fabe,_0x391e5b)=>{var _0x41ccb9=_0x1360b1;_0xc648e6[_0x391e5b][_0x41ccb9(0x1e8)]=_0x19fabe;}),_0x287c39[_0x1360b1(0x220)]((_0x3e5048,_0x7c42df)=>{_0xc648e6[_0x7c42df]['floorlevel']=_0x3e5048;}),_0xcf3f8['forEach']((_0x413579,_0x345b18)=>{var _0x50df75=_0x1360b1;_0xc648e6[_0x345b18][_0x50df75(0x1f4)]=_0x413579;}),_0xe5268e[_0x1360b1(0x220)]((_0x1e3882,_0x170d1d)=>{var _0x966395=_0x1360b1;_0xc648e6[_0x170d1d][_0x966395(0x256)]=_0x1e3882;}),_0x420ecc[_0x1360b1(0x220)]((_0x9998a4,_0xcf766b)=>{var _0x561ea7=_0x1360b1;_0xc648e6[_0xcf766b][_0x561ea7(0x1e0)]=_0x9998a4;}),_0x434616[_0x1360b1(0x220)]((_0x55bcba,_0x235f41)=>{var _0x4cbf74=_0x1360b1;_0xc648e6[_0x235f41][_0x4cbf74(0x22c)]=_0x55bcba;}),_0x42a3a7[_0x1360b1(0x1d0)][_0x1360b1(0x220)](_0xf3f9a9=>{var _0x30cefd=_0x1360b1;const _0x4dca1d=_0x2e28d6[_0x30cefd(0x24b)][_0x30cefd(0x1fe)](_0x342524=>{var _0x5933c2=_0x30cefd;_0x342524[_0x5933c2(0x254)]==_0xf3f9a9[_0x5933c2(0x254)]&&_0x342524[_0x5933c2(0x242)]==_0xf3f9a9['floorlevel']&&_0x342524['type']==_0xf3f9a9['type']&&_0x342524['bin']==_0xf3f9a9[_0x5933c2(0x1e8)]&&_0x342524[_0x5933c2(0x1f8)]==_0xf3f9a9[_0x5933c2(0x1f8)]&&_0x342524[_0x5933c2(0x26e)]==_0xf3f9a9[_0x5933c2(0x26e)]&&_0x342524[_0x5933c2(0x244)]==_0xf3f9a9['storage']&&(console['log'](parseInt(_0x342524[_0x5933c2(0x2bd)])+'\x20<>\x20'+parseInt(_0xf3f9a9['quantity'])),_0x342524['product_stock']=parseInt(_0x342524['product_stock'])+parseInt(_0xf3f9a9[_0x5933c2(0x1e6)]));});}),await _0x2e28d6['save']();const _0x556464=_0xc648e6[_0x1360b1(0x234)](_0x21e970=>_0x21e970[_0x1360b1(0x1ff)]!=='0'&&_0x21e970['return_qty']!=='');var _0x4a9673=0x0;_0x556464[_0x1360b1(0x220)](_0x5a4e93=>{var _0x3b1f41=_0x1360b1;console[_0x3b1f41(0x217)]('foreach\x20newproduct',_0x5a4e93),(parseInt(_0x5a4e93[_0x3b1f41(0x20c)])<parseInt(_0x5a4e93[_0x3b1f41(0x1ff)])||parseInt(_0x5a4e93['stock_quantity'])<parseInt(_0x5a4e93[_0x3b1f41(0x1ff)]))&&_0x4a9673++;});if(_0x4a9673!=0x0)return _0x19eafa['flash'](_0x1360b1(0x2ae),_0x1360b1(0x27b)),_0xf16213[_0x1360b1(0x232)](_0x1360b1(0x29a));const _0x66b2ec=new purchases_return({'invoice':_0x19b5ac,'suppliers':_0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x1c2)],'date':_0x487ede,'warehouse_name':_0x1209d5,'return_product':_0x556464,'note':_0x5e3abb,'room':_0xbd5e83,'to_warehouse_name':_0xd0d032,'to_room':_0x3dfacc}),_0x27e733=await _0x66b2ec[_0x1360b1(0x263)]();console[_0x1360b1(0x217)](_0x66b2ec);const _0x3e78b9=await purchases_return[_0x1360b1(0x270)]({'invoice':_0x19b5ac}),_0x376b0c=await warehouse[_0x1360b1(0x270)]({'name':_0xd0d032,'room':_0x3dfacc});_0x3e78b9['return_product'][_0x1360b1(0x220)](_0x2ad989=>{var _0x42f221=_0x1360b1,_0x4b4594=0x0;const _0x29930b=_0x376b0c[_0x42f221(0x24b)][_0x42f221(0x1fe)](_0x1b223f=>{var _0x39cbf1=_0x42f221;_0x1b223f[_0x39cbf1(0x254)]==_0x2ad989['product_name']&&_0x1b223f[_0x39cbf1(0x242)]==_0x2ad989[_0x39cbf1(0x242)]&&_0x1b223f[_0x39cbf1(0x1f4)]==_0x2ad989[_0x39cbf1(0x1f4)]&&_0x1b223f[_0x39cbf1(0x1e8)]==_0x2ad989[_0x39cbf1(0x1e8)]&&_0x1b223f[_0x39cbf1(0x1f8)]==_0x2ad989[_0x39cbf1(0x1f8)]&&(_0x1b223f[_0x39cbf1(0x2bd)]=parseInt(_0x1b223f['product_stock'])-parseInt(_0x2ad989[_0x39cbf1(0x1ff)]),_0x4b4594++);});_0x4b4594=='0'&&(_0x376b0c[_0x42f221(0x24b)]=_0x376b0c['product_details'][_0x42f221(0x21a)]({'product_name':_0x2ad989[_0x42f221(0x254)],'product_stock':_0x2ad989[_0x42f221(0x1ff)],'primary_code':_0x2ad989[_0x42f221(0x1e0)],'secondary_code':_0x2ad989['secondary_code'],'product_code':_0x2ad989[_0x42f221(0x256)],'storage':_0x2ad989[_0x42f221(0x244)],'rack':_0x2ad989[_0x42f221(0x26e)],'bay':_0x2ad989[_0x42f221(0x1f8)],'bin':_0x2ad989[_0x42f221(0x1e8)],'type':_0x2ad989[_0x42f221(0x1f4)],'floorlevel':_0x2ad989[_0x42f221(0x242)],'maxProducts':_0x2ad989[_0x42f221(0x1e4)],'unit':_0x2ad989['standard_unit'],'secondary_unit':_0x2ad989['secondary_unit'],'expiry_date':_0x2ad989[_0x42f221(0x20f)]}));}),await _0x376b0c[_0x1360b1(0x263)]();const _0x419355=await purchases[_0x1360b1(0x270)]({'invoice':_0x19b5ac});_0x419355['return_data']='True';const _0x5b61b1=await _0x419355['save'](),_0x4a585d=new s_payment_data({'invoice':_0x19b5ac,'suppliers':_0x19eafa['body']['suppliers'],'reason':_0x1360b1(0x1e2)});await _0x4a585d[_0x1360b1(0x263)]();const _0x125dc8=await master_shop[_0x1360b1(0x23f)]();console['log']('add\x20post',_0x125dc8[0x0][_0x1360b1(0x205)]);const _0x25ab06=await email_settings['findOne'](),_0x338e65=await suppliers[_0x1360b1(0x270)]({'name':_0x19eafa[_0x1360b1(0x1cd)][_0x1360b1(0x1c2)]});console['log'](_0x1360b1(0x23e),_0x338e65);_0x125dc8[0x0]['currency_placement']==0x1?(right_currency=_0x125dc8[0x0][_0x1360b1(0x292)],left_currency=''):(right_currency='',left_currency=_0x125dc8[0x0][_0x1360b1(0x292)]);var _0x53776a=_0x6dceb7,_0x5dd64c=_0x38827a,_0x5a5dc9='',_0x2d010e;for(_0x2d010e in _0x53776a){_0x5a5dc9+=_0x1360b1(0x2b9)+_0x1360b1(0x289)+_0x53776a[_0x2d010e]+_0x1360b1(0x260)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5dd64c[_0x2d010e]+_0x1360b1(0x260)+_0x1360b1(0x28a);}console[_0x1360b1(0x217)]('product_list',_0x5a5dc9);let _0x529665=nodemailer[_0x1360b1(0x21c)]({'service':_0x1360b1(0x26f),'auth':{'user':_0x25ab06[_0x1360b1(0x29d)],'pass':_0x25ab06[_0x1360b1(0x2b8)]}}),_0x152e1a={'from':_0x25ab06[_0x1360b1(0x29d)],'to':_0x338e65['email'],'subject':_0x1360b1(0x20b),'attachments':[{'filename':_0x1360b1(0x26c),'path':__dirname+_0x1360b1(0x1d8)+_0x1360b1(0x21f)+_0x125dc8[0x0][_0x1360b1(0x205)],'cid':_0x1360b1(0x24e)}],'html':_0x1360b1(0x22d)+'<html><head><title></title>'+_0x1360b1(0x227)+_0x1360b1(0x1ae)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x1360b1(0x1ae)+_0x1360b1(0x28c)+_0x1360b1(0x277)+_0x1360b1(0x1ae)+_0x1360b1(0x2c1)+_0x125dc8[0x0][_0x1360b1(0x1fd)]+_0x1360b1(0x1cb)+_0x1360b1(0x277)+'</div>'+_0x1360b1(0x210)+_0x1360b1(0x1ae)+_0x1360b1(0x259)+_0x1360b1(0x224)+_0x19b5ac+'\x20'+_0x1360b1(0x1fc)+_0x1360b1(0x239)+_0x487ede+'\x20'+'</span>'+'</h5>'+_0x1360b1(0x277)+_0x1360b1(0x1ea)+_0x1360b1(0x1c5)+_0x1360b1(0x2b9)+_0x1360b1(0x1ab)+_0x1360b1(0x25c)+_0x1360b1(0x285)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x1360b1(0x28a)+_0x1360b1(0x2a4)+_0x1360b1(0x201)+'\x20'+_0x5a5dc9+'\x20'+'</tbody>'+_0x1360b1(0x209)+_0x1360b1(0x1ae)+_0x1360b1(0x1b6)+_0x1360b1(0x237)+_0x125dc8[0x0][_0x1360b1(0x1fd)]+_0x1360b1(0x297)+_0x1360b1(0x277)+'</div>'+_0x1360b1(0x2b1)};_0x529665[_0x1360b1(0x212)](_0x152e1a,function(_0x1e61fa,_0x1e0103){var _0x38492c=_0x1360b1;_0x1e61fa?(console[_0x38492c(0x217)](_0x1e61fa),console[_0x38492c(0x217)](_0x38492c(0x2ac))):console[_0x38492c(0x217)](_0x38492c(0x21b));}),_0x19eafa[_0x1360b1(0x291)](_0x1360b1(0x240),_0x1360b1(0x295)),_0xf16213[_0x1360b1(0x232)](_0x1360b1(0x1b3));}catch(_0xb2884c){console[_0x1360b1(0x217)](_0xb2884c),_0xf16213[_0x1360b1(0x276)](0xc8)[_0x1360b1(0x23d)]({'message':_0xb2884c[_0x1360b1(0x250)]});}}),router[a0_0x245ab9(0x22b)](a0_0x245ab9(0x21e),auth,async(_0x5b6924,_0xdf9750)=>{var _0x1c4049=a0_0x245ab9;try{const {username:_0x2a0e72,email:_0x3133ff,role:_0x26988e}=_0x5b6924['user'],_0xeaaf24=_0x5b6924[_0x1c4049(0x1c7)],_0x288518=await profile[_0x1c4049(0x270)]({'email':_0xeaaf24[_0x1c4049(0x29d)]}),_0x46c1d0=await master_shop[_0x1c4049(0x23f)](),_0x5f40a7=_0x5b6924[_0x1c4049(0x225)]['id'],_0x4cf925=await purchases[_0x1c4049(0x1e3)](_0x5f40a7);if(_0x46c1d0[0x0]['language']==_0x1c4049(0x1ac))var _0x13c9dc=users[_0x1c4049(0x278)];else{if(_0x46c1d0[0x0][_0x1c4049(0x2a5)]==_0x1c4049(0x218))var _0x13c9dc=users[_0x1c4049(0x218)];else{if(_0x46c1d0[0x0][_0x1c4049(0x2a5)]==_0x1c4049(0x279))var _0x13c9dc=users[_0x1c4049(0x279)];else{if(_0x46c1d0[0x0][_0x1c4049(0x2a5)]=='Spanish')var _0x13c9dc=users[_0x1c4049(0x1ad)];else{if(_0x46c1d0[0x0][_0x1c4049(0x2a5)]=='French')var _0x13c9dc=users[_0x1c4049(0x293)];else{if(_0x46c1d0[0x0][_0x1c4049(0x2a5)]==_0x1c4049(0x25a))var _0x13c9dc=users[_0x1c4049(0x284)];else{if(_0x46c1d0[0x0][_0x1c4049(0x2a5)]==_0x1c4049(0x1a7))var _0x13c9dc=users[_0x1c4049(0x1a7)];else{if(_0x46c1d0[0x0]['language']==_0x1c4049(0x1ef))var _0x13c9dc=users['Arabic'];}}}}}}}_0xdf9750['render'](_0x1c4049(0x29e),{'success':_0x5b6924[_0x1c4049(0x291)](_0x1c4049(0x240)),'errors':_0x5b6924['flash']('errors'),'role':_0xeaaf24,'profile':_0x288518,'alldata':_0x4cf925,'master_shop':_0x46c1d0,'language':_0x13c9dc}),console[_0x1c4049(0x217)](alldata);}catch(_0x34fcc8){console[_0x1c4049(0x217)](_0x34fcc8);}}),router[a0_0x245ab9(0x2b4)]('/barcode_scanner',async(_0x54255c,_0x5d4357)=>{var _0x1760bc=a0_0x245ab9;const {product_code:_0x1d4c5d}=_0x54255c[_0x1760bc(0x1cd)];var _0x3a0427;const _0x7cc38c=await product[_0x1760bc(0x243)]([{'$match':{'primary_code':_0x1d4c5d,'product_category':_0x1760bc(0x27a)}},{'$group':{'_id':'$_id','name':{'$first':_0x1760bc(0x1a5)},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':_0x1760bc(0x2c2)},'alertquantity':{'$first':_0x1760bc(0x1da)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x1760bc(0x29b)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x1760bc(0x24c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x2f1a3e=await product[_0x1760bc(0x243)]([{'$match':{'secondary_code':_0x1d4c5d,'product_category':_0x1760bc(0x27a)}},{'$group':{'_id':_0x1760bc(0x238),'name':{'$first':'$name'},'category':{'$first':_0x1760bc(0x1c0)},'brand':{'$first':_0x1760bc(0x264)},'unit':{'$first':_0x1760bc(0x2c2)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x1760bc(0x261)},'primary_code':{'$first':_0x1760bc(0x21d)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x1760bc(0x29b)},'maxProdPerUnit':{'$first':_0x1760bc(0x1ec)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x1760bc(0x24c)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x7cc38c[_0x1760bc(0x230)]>0x0)_0x3a0427=_0x7cc38c;else _0x2f1a3e[_0x1760bc(0x230)]>0x0&&(_0x3a0427=_0x2f1a3e);_0x5d4357['json'](_0x3a0427);}),router[a0_0x245ab9(0x2b4)](a0_0x245ab9(0x245),async(_0x14dfcb,_0x460799)=>{var _0x2707da=a0_0x245ab9;const {primaryCode:_0x53ab85,secondaryCode:_0x286f66,productCode:_0x240b03,bay:_0x178cd9,bin:_0x665028,types:_0x2ca6a0,pallet:_0x4e7790,warehouses:_0x14b911,room:_0x2a9817}=_0x14dfcb[_0x2707da(0x1cd)];console['log'](_0x14dfcb[_0x2707da(0x1cd)]);try{const _0x2b5eda=await warehouse['aggregate']([{'$match':{'name':_0x14b911,'room':_0x2a9817}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':_0x178cd9,'product_details.bin':_0x665028,'product_details.type':_0x2ca6a0}},{'$group':{'_id':_0x2707da(0x27f),'name':{'$first':_0x2707da(0x2a3)},'product_stock':{'$first':_0x2707da(0x25e)},'level':{'$first':_0x2707da(0x296)},'isle':{'$first':_0x2707da(0x1f0)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x2707da(0x1b5)}}}]);_0x460799[_0x2707da(0x276)](0xc8)[_0x2707da(0x23d)](_0x2b5eda);}catch(_0x3ce7fd){_0x460799['status'](0x194)[_0x2707da(0x23d)]({'message':_0x3ce7fd[_0x2707da(0x250)]});}}),module[a0_0x245ab9(0x23b)]=router;