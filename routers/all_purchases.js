var a0_0x3e55f6=a0_0x2a5c;(function(_0x57f41f,_0x59b8ff){var _0x402578=a0_0x2a5c,_0x5dfb73=_0x57f41f();while(!![]){try{var _0x3543ad=-parseInt(_0x402578(0xab))/0x1+parseInt(_0x402578(0xc3))/0x2*(parseInt(_0x402578(0x15f))/0x3)+-parseInt(_0x402578(0x198))/0x4*(-parseInt(_0x402578(0x1b6))/0x5)+-parseInt(_0x402578(0x165))/0x6+parseInt(_0x402578(0x152))/0x7+parseInt(_0x402578(0x166))/0x8*(parseInt(_0x402578(0xb0))/0x9)+-parseInt(_0x402578(0x16a))/0xa*(-parseInt(_0x402578(0xd6))/0xb);if(_0x3543ad===_0x59b8ff)break;else _0x5dfb73['push'](_0x5dfb73['shift']());}catch(_0x23bf27){_0x5dfb73['push'](_0x5dfb73['shift']());}}}(a0_0x4589,0x73707));function a0_0x2a5c(_0x584029,_0x304f85){var _0x45896c=a0_0x4589();return a0_0x2a5c=function(_0x2a5cde,_0x381ab9){_0x2a5cde=_0x2a5cde-0x9e;var _0x422ed9=_0x45896c[_0x2a5cde];return _0x422ed9;},a0_0x2a5c(_0x584029,_0x304f85);}function a0_0x4589(){var _0x3fa0f9=['prod_pallet','<tbody\x20style=\x22text-align:\x20center;\x22>','add_purchases','$product_details.isle','$product_code','</table>','INC-','/view/add_purchases','prod_name','due_amount','$due_amount','Arabic\x20(ae)','/give_payment/:id','$product_details.rack','DRY\x20STORAGE','Level','Logo.png','$product_details.secondary_code','<h5>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','amount','note','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/view/:id','nodemailer','render','</h5>','Error\x20Occurs','filter','</div>','redirect','$maxStocks','all_purchases','rack','$product_details.product_code','../models/all_models','body','prod_primunit','prod_qty','There\x27s\x20a\x20error\x20in\x20this\x20transaction','host','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','expiry_date','deliverycode','save','$product','gmail','date','$product_details.bin','Enabled','purchase\x20data\x20update\x20successfully','createTransport','/barcode_scanner','payment\x20successfull','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','return_qty','5110833HtbKGO','prod_isle','user','user_id','table\x20page','secondary_code','padStart','$alertquantity','product','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_code_hide','$suppliers','level','3BSZDQb','finalize','$product_details._id','$product_details.product_stock','warehouse_name','delivery_code','4245270ITuUcN','306392zpaISW','quantity','$suppliers_docs','\x20Order\x20Number\x20:\x20','40FbWDzm','prod_cat','$product_details.storage','Shelves','<html><head><title></title>','purchase_quantity','../middleware/auth','/view/add_purchases/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','getDate','Spanish','Purchase\x20Return','sendMail','product_details','$product.floorlevel','$product.bay','/all_purchases/view','ejs','$name','room_name','primary_code','purchase_invoice','maxperunit','$warehouse_name','/all_purchases/view/','$primary_code','$product_details.product_name','product_list','status','type','abs','prod_level','$finalize','<tr>','suppliers_docs','return_purchase','all_purchases_barcode','</td>','add_purchases\x20error','logo','master','return_product','$product.bin','French','flash','\x20<\x20wew\x20>\x20','16BmqakC','Ambient','</span>','$_id','add\x20post','/view/return_purchase/:id','warehouse','</thead>','/preview/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.type','<div>','Paid\x20For\x20Purchase','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$category','$batch_code','log','<h2>\x20','\x20Order\x20Date\x20:\x20','primary_code_hide','actual_qty','MaxStocks_data','types','True','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</tbody>','$paid_amount','post','getMonth','Arabic','124220KqPXox','length','random','RoomAssign','/../public','product_cat','role','secondary_code_hide','standard_unit','$product.type','error','stocks','<h5\x20style=\x22text-align:\x20left;\x22>','prod_Qty','room','$date','image','actual_uom','\x20</h2>','$unit','prod_unit','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product.quantity','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','254273QTFHBE','params','pallet','prod_invoice','slice','63pgYyjy','floorlevel','Email\x20sent\x20successfully','find','Purchase\x20data\x20added\x20successfully','bin','$note','back','express','email','<hr\x20class=\x22my-3\x22>','json','batch_code','COLD\x20STORAGE','storage','success','findOne','currency','findById','366658NgHMVL','prod_secondunit','Floor','product_name','all','paid_amount','production_date','max_product_unit','site_title','Purchase\x20Return\x20Mail','delivery_date','/barcode/:id','errors','aggregate','$product_details.expiry_date','concat','Chinese','suppliers_data','../public/language/languages.json','422785iBYkqW','message','German','Rack\x20A','$product_details.primary_code','<span\x20style=\x22float:\x20right;\x22>','here','/CheckingWarehouse','Rack\x20B','invoice','$product_details','$product_details.level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','language','Rack\x20D','Room_name','map','$secondary_unit','An\x20error\x20occurred\x20while\x20saving\x20data.','$expiry_date','stock_data','then','</head><body>','floor','bay','push','/upload/','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','isle','$invoice','RMSEmail','forEach','$return_data','catch','Purchase\x20Mail','currency_placement','alertQTY','Hindi','</tr>','\x20<>\x20','/invoice/:id','stock_quantity','<strong>\x20Regards\x20</strong>','get','/view','English\x20(US)','$product_details.maxProducts','Raw\x20Materials','Rack\x20C','string','Return\x20Goods','prod_code','rak','foreach\x20newproduct','maxStocks','Portuguese\x20(BR)','English','$product_details.pallet','suppliers','Portuguese','product_code','password','Receiving\x20Area','purchases\x20item\x20return\x20successfull','getFullYear','$brand','product_stock'];a0_0x4589=function(){return _0x3fa0f9;};return a0_0x4589();}const express=require(a0_0x3e55f6(0xb8)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x3e55f6(0x13d)),auth=require(a0_0x3e55f6(0x170)),nodemailer=require(a0_0x3e55f6(0x132));var ejs=require(a0_0x3e55f6(0x17b));const path=require('path'),users=require(a0_0x3e55f6(0xd5));router[a0_0x3e55f6(0x101)](a0_0x3e55f6(0x102),auth,async(_0x32a2db,_0x69bacc)=>{var _0x2e5fda=a0_0x3e55f6;try{const {username:_0x2837f2,email:_0x48c301,role:_0x53625a}=_0x32a2db[_0x2e5fda(0x154)],_0xd56d9a=_0x32a2db['user'],_0xc839cb=await profile['findOne']({'email':_0xd56d9a['email']}),_0x5e34b5=await staff[_0x2e5fda(0xc0)]({'email':_0xd56d9a[_0x2e5fda(0xb9)]});if(_0xd56d9a['role']==_0x2e5fda(0x12f)){const _0x54b6c0=await staff[_0x2e5fda(0xc0)]({'email':_0xd56d9a[_0x2e5fda(0xb9)]});}const _0x596d9f=await master_shop[_0x2e5fda(0xb3)]();let _0x3ef41e;if(_0xd56d9a[_0x2e5fda(0x1bc)]=='staff'){const _0x3ed48d=await staff[_0x2e5fda(0xc0)]({'email':_0xd56d9a[_0x2e5fda(0xb9)]});_0x3ef41e=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3ed48d[_0x2e5fda(0x19e)]}},{'$lookup':{'from':_0x2e5fda(0x110),'localField':'suppliers','foreignField':'name','as':_0x2e5fda(0x18c)}},{'$unwind':_0x2e5fda(0x168)},{'$unwind':_0x2e5fda(0x147)},{'$group':{'_id':_0x2e5fda(0x19b),'invoice':{'$first':_0x2e5fda(0xf3)},'suppliers':{'$first':_0x2e5fda(0x15d)},'date':{'$first':_0x2e5fda(0xa0)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$first':'$room'},'product':{'$push':_0x2e5fda(0x147)},'note':{'$first':_0x2e5fda(0xb6)},'paid_amount':{'$first':_0x2e5fda(0x1b2)},'due_amount':{'$first':_0x2e5fda(0x123)},'return_data':{'$first':_0x2e5fda(0xf6)},'batch_code':{'$first':_0x2e5fda(0x1a7)},'expiry_date':{'$first':_0x2e5fda(0xe9)},'suppliers_docs':{'$first':_0x2e5fda(0x168)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x2e5fda(0x179)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x2e5fda(0x1bf)},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x3ef41e=await purchases[_0x2e5fda(0xd0)]([{'$lookup':{'from':'suppliers','localField':_0x2e5fda(0x110),'foreignField':'name','as':_0x2e5fda(0x18c)}},{'$unwind':'$suppliers_docs'},{'$unwind':_0x2e5fda(0x147)},{'$group':{'_id':_0x2e5fda(0x19b),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0x2e5fda(0x15d)},'date':{'$first':_0x2e5fda(0xa0)},'warehouse_name':{'$first':_0x2e5fda(0x181)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':_0x2e5fda(0x147)},'note':{'$first':'$note'},'paid_amount':{'$first':_0x2e5fda(0x1b2)},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':'$return_data'},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x2e5fda(0xe9)},'suppliers_docs':{'$first':_0x2e5fda(0x168)},'total_product_quantity':{'$sum':_0x2e5fda(0xa8)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0x2e5fda(0x194)},'type':{'$addToSet':_0x2e5fda(0x1bf)},'floorlevel':{'$addToSet':_0x2e5fda(0x178)},'finalize':{'$first':_0x2e5fda(0x18a)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x596d9f[0x0][_0x2e5fda(0xe3)]==_0x2e5fda(0x103)){var _0x2e5dc9=users[_0x2e5fda(0x10e)];console[_0x2e5fda(0x1a8)](_0x2e5dc9);}else{if(_0x596d9f[0x0][_0x2e5fda(0xe3)]=='Hindi')var _0x2e5dc9=users[_0x2e5fda(0xfb)];else{if(_0x596d9f[0x0][_0x2e5fda(0xe3)]==_0x2e5fda(0xd8))var _0x2e5dc9=users['German'];else{if(_0x596d9f[0x0][_0x2e5fda(0xe3)]==_0x2e5fda(0x174))var _0x2e5dc9=users[_0x2e5fda(0x174)];else{if(_0x596d9f[0x0][_0x2e5fda(0xe3)]==_0x2e5fda(0x195))var _0x2e5dc9=users['French'];else{if(_0x596d9f[0x0][_0x2e5fda(0xe3)]==_0x2e5fda(0x10d))var _0x2e5dc9=users['Portuguese'];else{if(_0x596d9f[0x0][_0x2e5fda(0xe3)]==_0x2e5fda(0xd3))var _0x2e5dc9=users[_0x2e5fda(0xd3)];else{if(_0x596d9f[0x0]['language']=='Arabic\x20(ae)')var _0x2e5dc9=users[_0x2e5fda(0x1b5)];}}}}}}}_0x69bacc['render'](_0x2e5fda(0x13a),{'success':_0x32a2db[_0x2e5fda(0x196)]('success'),'errors':_0x32a2db[_0x2e5fda(0x196)]('errors'),'purchases':_0x3ef41e,'role':_0xd56d9a,'profile':_0xc839cb,'master_shop':_0x596d9f,'language':_0x2e5dc9});}catch(_0x55e869){console[_0x2e5fda(0x1a8)](_0x2e5fda(0x156),_0x55e869),_0x69bacc['status'](0xc8)[_0x2e5fda(0xbb)]({'message':_0x55e869['message']});}});function BayBinSelected(_0x277fdd,_0x4b271c){var _0x550815=a0_0x3e55f6,_0x4cd5b8=[],_0x13c0a3=[],_0x342ef8=[],_0x5db48b=[],_0x1f3810=[],_0x22ec2d=[];let _0x513479=[];if(_0x277fdd==_0x550815(0x127))switch(_0x4b271c){case _0x550815(0xd9):_0x4cd5b8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x13c0a3=[0x1,0x2],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=['Level',_0x550815(0xc5)],_0x1f3810=['D'],_0x22ec2d=['A'];break;case'Rack\x20B':_0x4cd5b8=[0x6,0x5,0x4,0x3,0x2,0x1],_0x13c0a3=[0x1,0x2],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=[_0x550815(0x128),_0x550815(0xc5)],_0x1f3810=['D'],_0x22ec2d=['B'];break;case _0x550815(0x16d):_0x4cd5b8=[0x0],_0x13c0a3=[0x0],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=[_0x550815(0xc5)],_0x1f3810=['D'],_0x22ec2d=['S'];break;case _0x550815(0x114):_0x4cd5b8=[0x0],_0x13c0a3=[0x0],_0x5db48b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x342ef8=['Floor'],_0x1f3810=['D'],_0x22ec2d=['R'];break;}else{if(_0x277fdd==_0x550815(0xbd))switch(_0x4b271c){case _0x550815(0xd9):_0x4cd5b8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x13c0a3=['B','F'],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=[_0x550815(0x128),_0x550815(0xc5)],_0x1f3810=['C'],_0x22ec2d=['A'];break;case _0x550815(0xde):_0x4cd5b8=[0x5,0x4,0x3,0x2,0x1],_0x13c0a3=['F','B','S'],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=['Level','Floor'],_0x1f3810=['C'],_0x22ec2d=['B'];break;case _0x550815(0x106):_0x4cd5b8=[0x1,0x2,0x3,0x4,0x5],_0x13c0a3=['B','F','S'],_0x5db48b=[0x5,0x4,0x3,0x2,0x1],_0x342ef8=['Level',_0x550815(0xc5)],_0x1f3810=['C'],_0x22ec2d=['C'];break;case _0x550815(0xe4):_0x4cd5b8=[0x5,0x4,0x3,0x2,0x1],_0x13c0a3=['F','B','S'],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=[_0x550815(0x128),_0x550815(0xc5)],_0x1f3810=['C'],_0x22ec2d=['D'];break;case'Rack\x20E':_0x4cd5b8=[0x4,0x3,0x2,0x1],_0x13c0a3=[0x1,0x2],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=[_0x550815(0x128),_0x550815(0xc5)],_0x1f3810=['C'],_0x22ec2d=['E'];break;case'Rack\x20F':_0x4cd5b8=[0x1,0x2,0x3],_0x13c0a3=[0x1,0x2],_0x5db48b=[0x1,0x2,0x3,0x4,0x5],_0x342ef8=[_0x550815(0x128)],_0x1f3810=['C'],_0x22ec2d=['F'];break;}}return{'levels':_0x4cd5b8,'Isle':_0x13c0a3,'rack':_0x5db48b,'type':_0x342ef8,'storage':_0x1f3810,'rak':_0x22ec2d};}async function getRandom8DigitNumber(){var _0x2303de=a0_0x3e55f6;const _0x1e5759=0x989680,_0xe54085=0x5f5e0ff,_0x1a145e=Math[_0x2303de(0xed)](Math[_0x2303de(0x1b8)]()*(_0xe54085-_0x1e5759+0x1))+_0x1e5759;var _0x11e4bc;const _0x4e1f73=await purchases['findOne']({'invoice':_0x2303de(0x11f)+_0x1a145e});return _0x4e1f73&&_0x4e1f73['length']>0x0?_0x11e4bc='INC-'+_0x1a145e:_0x11e4bc=_0x2303de(0x11f)+_0x1a145e,_0x11e4bc;}router[a0_0x3e55f6(0x101)](a0_0x3e55f6(0x120),auth,async(_0x5b78a2,_0x48695b)=>{var _0x17607d=a0_0x3e55f6;try{const {username:_0x163cb9,email:_0x150343,role:_0x22d59f}=_0x5b78a2[_0x17607d(0x154)],_0x237fa6=_0x5b78a2['user'],_0x12002c=await profile['findOne']({'email':_0x237fa6[_0x17607d(0xb9)]}),_0x34b708=await master_shop[_0x17607d(0xb3)](),_0xbae741=await staff['findOne']({'email':_0x237fa6[_0x17607d(0xb9)]}),_0x47be67=await suppliers[_0x17607d(0xb3)]({});let _0x1971c1;if(_0x237fa6[_0x17607d(0x1bc)]=='staff'){const _0x23f775=await staff[_0x17607d(0xc0)]({'email':_0x237fa6[_0x17607d(0xb9)]});_0x1971c1=await warehouse[_0x17607d(0xd0)]([{'$match':{'status':_0x17607d(0x14b),'name':_0x23f775['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x17607d(0x17c),'name':{'$first':'$name'}}}]);}else _0x1971c1=await warehouse[_0x17607d(0xd0)]([{'$match':{'status':_0x17607d(0x14b),'warehouse_category':_0x17607d(0x105),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x17607d(0x17c),'name':{'$first':_0x17607d(0x17c)}}}]);const _0x10f405=await product[_0x17607d(0xb3)]({}),_0x503400=await warehouse[_0x17607d(0xb3)]({'status':_0x17607d(0x14b)}),_0x1ee068=await purchases[_0x17607d(0xb3)]({}),_0x4b4a65=_0x1ee068[_0x17607d(0x1b7)]+0x1,_0x3bf977=_0x17607d(0x11f)+_0x4b4a65['toString']()[_0x17607d(0x158)](0x5,'0');var _0x3b5322=[_0x17607d(0x199),'Enclosed'];if(_0x34b708[0x0][_0x17607d(0xe3)]==_0x17607d(0x103))var _0x33dafd=users[_0x17607d(0x10e)];else{if(_0x34b708[0x0][_0x17607d(0xe3)]==_0x17607d(0xfb))var _0x33dafd=users['Hindi'];else{if(_0x34b708[0x0][_0x17607d(0xe3)]=='German')var _0x33dafd=users['German'];else{if(_0x34b708[0x0][_0x17607d(0xe3)]==_0x17607d(0x174))var _0x33dafd=users['Spanish'];else{if(_0x34b708[0x0][_0x17607d(0xe3)]==_0x17607d(0x195))var _0x33dafd=users[_0x17607d(0x195)];else{if(_0x34b708[0x0][_0x17607d(0xe3)]==_0x17607d(0x10d))var _0x33dafd=users[_0x17607d(0x111)];else{if(_0x34b708[0x0][_0x17607d(0xe3)]==_0x17607d(0xd3))var _0x33dafd=users[_0x17607d(0xd3)];else{if(_0x34b708[0x0][_0x17607d(0xe3)]==_0x17607d(0x124))var _0x33dafd=users[_0x17607d(0x1b5)];}}}}}}}const _0x362ebd=getRandom8DigitNumber();_0x362ebd[_0x17607d(0xeb)](_0x2ae3e3=>{var _0x3b3e8c=_0x17607d;_0x48695b[_0x3b3e8c(0x133)](_0x3b3e8c(0x11b),{'success':_0x5b78a2[_0x3b3e8c(0x196)](_0x3b3e8c(0xbf)),'errors':_0x5b78a2[_0x3b3e8c(0x196)]('errors'),'role':_0x237fa6,'profile':_0x12002c,'suppliers':_0x47be67,'warehouse':_0x1971c1,'product':_0x10f405,'invoice':_0x2ae3e3,'master_shop':_0x34b708,'language':_0x33dafd,'find_data':_0x503400,'rooms_data':_0x3b5322});})[_0x17607d(0xf7)](_0x42fb56=>{var _0xe4b9a3=_0x17607d;_0x5b78a2[_0xe4b9a3(0x196)](_0xe4b9a3(0xcf),_0xe4b9a3(0x141)),_0x48695b[_0xe4b9a3(0x138)]('/all_purchases/view');});}catch(_0x466b47){console[_0x17607d(0x1a8)](_0x466b47);}}),router[a0_0x3e55f6(0x101)](a0_0x3e55f6(0x171),auth,async(_0x380d0a,_0xeb9515)=>{var _0x3e64ae=a0_0x3e55f6;try{const _0x3cf492=_0x380d0a[_0x3e64ae(0xac)]['id'];console[_0x3e64ae(0x1a8)](_0x3cf492);const _0x4b6338=await master_shop[_0x3e64ae(0xb3)]();console[_0x3e64ae(0x1a8)]('master',_0x4b6338);const _0x3f1cf0=await product[_0x3e64ae(0xc0)]({'name':_0x3cf492});console[_0x3e64ae(0x1a8)](_0x3e64ae(0x15a),_0x3f1cf0),_0xeb9515['status'](0xc8)[_0x3e64ae(0xbb)]({'product_data':_0x3f1cf0,'master':_0x4b6338});}catch(_0x49060c){console[_0x3e64ae(0x1a8)](_0x3e64ae(0x190),_0x49060c);}}),router[a0_0x3e55f6(0x1b3)](a0_0x3e55f6(0x120),auth,async(_0x3908f9,_0x5a553d)=>{var _0x3aab64=a0_0x3e55f6;try{const {invoice:_0x3e7fe7,date:_0x43be56,warehouse_name:_0x320341,prod_name:_0x38944b,prod_code:_0x3b342c,prod_qty:_0x465e15,prod_unit:_0x2593dc,prod_secondunit:_0x50b558,prod_level:_0x53695a,prod_isle:_0x21d567,prod_pallet:_0x5c5be0,note:_0x3e8720,expiry_date:_0x24c0d7,batch_code:_0x515172,payable:_0x2ada1c,due_amount:_0x5a0bb3,Room_name:_0x22c34a,primary_code:_0x22fe9f,secondary_code:_0x2dc672,MaxStocks_data:_0x5114bb,PO_number:_0x3b0313,SCRN:_0x5818ca,JO_number:_0x405160}=_0x3908f9[_0x3aab64(0x13e)];if(typeof _0x38944b==_0x3aab64(0x107))var _0x8df602=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x121)]],_0x332a80=[_0x3908f9[_0x3aab64(0x13e)]['prod_code']],_0x35a669=[_0x3908f9['body']['prod_Qty']],_0xb8b78b=[_0x3908f9['body'][_0x3aab64(0x13f)]],_0x36ee86=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xc4)]],_0x3bfb31=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x189)]],_0x5ec248=[_0x3908f9['body'][_0x3aab64(0x17e)]],_0x5a90ee=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x157)]],_0x9d79b2=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x1ad)]],_0x30da36=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xbc)]],_0x3c2d5a=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x144)]],_0x31269f=[_0x3908f9[_0x3aab64(0x13e)]['max_product_unit']],_0x3baed8=[_0x3908f9[_0x3aab64(0x13e)]['alertQTY']],_0x129fc8=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xc9)]],_0xbcda4c=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x16b)]],_0x236ff9=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x1b9)]],_0x48589c=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x145)]],_0x4e8547=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xae)]],_0x4dd57c=[_0x3908f9[_0x3aab64(0x13e)]['actual_qty']],_0x14d4dc=[_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xa2)]];else var _0x8df602=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x121)]],_0x332a80=[..._0x3908f9['body'][_0x3aab64(0x109)]],_0x35a669=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x9e)]],_0xb8b78b=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x13f)]],_0x36ee86=[..._0x3908f9[_0x3aab64(0x13e)]['prod_secondunit']],_0x3bfb31=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x189)]],_0x5ec248=[..._0x3908f9[_0x3aab64(0x13e)]['primary_code']],_0x5a90ee=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x157)]],_0x9d79b2=[..._0x3908f9[_0x3aab64(0x13e)]['MaxStocks_data']],_0x30da36=[..._0x3908f9[_0x3aab64(0x13e)]['batch_code']],_0x3c2d5a=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x144)]],_0x31269f=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xca)]],_0x3baed8=[..._0x3908f9['body']['alertQTY']],_0x129fc8=[..._0x3908f9['body'][_0x3aab64(0xc9)]],_0xbcda4c=[..._0x3908f9['body'][_0x3aab64(0x16b)]],_0x236ff9=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x1b9)]],_0x48589c=[..._0x3908f9['body']['deliverycode']],_0x4e8547=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xae)]],_0x4dd57c=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x1ac)]],_0x14d4dc=[..._0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0xa2)]];const _0x438c76=_0x8df602['map'](_0x5dc074=>{return _0x5dc074={'product_name':_0x5dc074};});_0x4dd57c[_0x3aab64(0xf5)]((_0x35c00d,_0x1d3ee4)=>{var _0x43fddd=_0x3aab64;_0x438c76[_0x1d3ee4][_0x43fddd(0x1ac)]=Math[_0x43fddd(0x188)](_0x35c00d);}),_0x14d4dc[_0x3aab64(0xf5)]((_0x32a7a0,_0x323b43)=>{var _0x2aaa0a=_0x3aab64;_0x438c76[_0x323b43][_0x2aaa0a(0xa2)]=_0x32a7a0;}),_0x332a80[_0x3aab64(0xf5)]((_0x1eab6e,_0x2aca0c)=>{var _0x5ddc55=_0x3aab64;_0x438c76[_0x2aca0c][_0x5ddc55(0x112)]=_0x1eab6e;}),_0x35a669[_0x3aab64(0xf5)]((_0xb5bef9,_0x2ffaf5)=>{var _0x4bd9e9=_0x3aab64;_0x438c76[_0x2ffaf5][_0x4bd9e9(0x167)]=Math[_0x4bd9e9(0x188)](_0xb5bef9);}),_0xb8b78b[_0x3aab64(0xf5)]((_0x501a36,_0x303716)=>{var _0x1a79ce=_0x3aab64;_0x438c76[_0x303716][_0x1a79ce(0x1be)]=_0x501a36;}),_0x36ee86[_0x3aab64(0xf5)]((_0x604ab9,_0x559a03)=>{var _0x6936ad=_0x3aab64;_0x438c76[_0x559a03][_0x6936ad(0xa6)]=_0x604ab9;}),_0x3bfb31[_0x3aab64(0xf5)]((_0x39aeb7,_0x49705f)=>{var _0xceac09=_0x3aab64;_0x236ff9[_0xceac09(0xf5)]((_0x14647a,_0x989607)=>{var _0x137492=_0xceac09;if(_0x14647a=='Receiving\x20Area'&&_0x49705f==_0x989607){console['log'](_0x14647a+_0x137492(0x197)+_0x49705f+_0x137492(0xfd)+_0x989607+_0x137492(0xfd)+_0x39aeb7);var _0x45d6ac=_0x39aeb7['slice'](0x3);_0x438c76[_0x49705f]['storage']=_0x39aeb7[0x0],_0x438c76[_0x49705f]['rack']=_0x39aeb7[0x1],_0x438c76[_0x49705f][_0x137492(0xee)]=0x0,_0x438c76[_0x49705f]['bin']=0x0,_0x438c76[_0x49705f][_0x137492(0x187)]=_0x137492(0xc5),_0x438c76[_0x49705f][_0x137492(0xb1)]=_0x45d6ac;}else{if(_0x14647a==_0x137492(0x16d)&&_0x49705f==_0x989607){var _0x45d6ac=_0x39aeb7[_0x137492(0xaf)](0x3);_0x438c76[_0x49705f][_0x137492(0xbe)]=_0x39aeb7[0x0],_0x438c76[_0x49705f][_0x137492(0x13b)]=_0x39aeb7[0x1],_0x438c76[_0x49705f][_0x137492(0xee)]=0x0,_0x438c76[_0x49705f][_0x137492(0xb5)]=0x0,_0x438c76[_0x49705f][_0x137492(0x187)]=_0x137492(0xc5),_0x438c76[_0x49705f][_0x137492(0xb1)]=_0x39aeb7[0x5];}else{if(_0x49705f==_0x989607){if(_0x39aeb7[0x0]=='A'&&_0x39aeb7[0x1]=='L'&&_0x39aeb7[0x2]=='L')console[_0x137492(0x1a8)](_0x14647a+_0x137492(0xfd)+_0x49705f+_0x137492(0xfd)+_0x989607+_0x137492(0xfd)+_0x39aeb7+_0x137492(0xdc)),_0x438c76[_0x49705f][_0x137492(0xbe)]=_0x39aeb7[0x0],_0x438c76[_0x49705f][_0x137492(0x13b)]=_0x39aeb7[0x1],_0x438c76[_0x49705f][_0x137492(0xee)]=0x0,_0x438c76[_0x49705f][_0x137492(0xb5)]=0x0,_0x438c76[_0x49705f][_0x137492(0x187)]=_0x137492(0xc5),_0x438c76[_0x49705f][_0x137492(0xb1)]=_0x39aeb7[0x3];else{var _0x5012f3;if(_0x39aeb7[0x4]=='L')_0x5012f3=_0x137492(0x128);else _0x39aeb7[0x4]=='F'&&(_0x5012f3=_0x137492(0xc5));_0x438c76[_0x49705f]['storage']=_0x39aeb7[0x0],_0x438c76[_0x49705f][_0x137492(0x13b)]=_0x39aeb7[0x1],_0x438c76[_0x49705f][_0x137492(0xee)]=_0x39aeb7[0x2],_0x438c76[_0x49705f][_0x137492(0xb5)]=_0x39aeb7[0x3],_0x438c76[_0x49705f]['type']=_0x5012f3,_0x438c76[_0x49705f]['floorlevel']=_0x39aeb7[0x5];}}}}});}),_0x5ec248[_0x3aab64(0xf5)]((_0x5be8fe,_0x5ac523)=>{var _0x24060b=_0x3aab64;_0x438c76[_0x5ac523][_0x24060b(0x17e)]=_0x5be8fe;}),_0x5a90ee[_0x3aab64(0xf5)]((_0x1a5648,_0x461a8f)=>{var _0x39a830=_0x3aab64;_0x438c76[_0x461a8f][_0x39a830(0x157)]=_0x1a5648;}),_0x9d79b2[_0x3aab64(0xf5)]((_0xc518e4,_0x15c577)=>{var _0x544e57=_0x3aab64;_0x438c76[_0x15c577][_0x544e57(0x10c)]=_0xc518e4;}),_0x30da36[_0x3aab64(0xf5)]((_0x5b2268,_0x5a6dfb)=>{var _0x1c57ce=_0x3aab64;_0x438c76[_0x5a6dfb][_0x1c57ce(0xbc)]=_0x5b2268;}),_0x3c2d5a[_0x3aab64(0xf5)]((_0x1f6afb,_0x204010)=>{var _0x285fc8=_0x3aab64;_0x438c76[_0x204010][_0x285fc8(0x144)]=_0x1f6afb;}),_0x31269f[_0x3aab64(0xf5)]((_0x4d6083,_0x42a960)=>{var _0x15e4f0=_0x3aab64;_0x438c76[_0x42a960][_0x15e4f0(0x180)]=_0x4d6083;}),_0x3baed8[_0x3aab64(0xf5)]((_0x2dcbc8,_0x56eba0)=>{var _0x285e07=_0x3aab64;_0x438c76[_0x56eba0][_0x285e07(0xfa)]=_0x2dcbc8;}),_0x129fc8['forEach']((_0x169cad,_0x53f943)=>{var _0x14eaa9=_0x3aab64;_0x438c76[_0x53f943][_0x14eaa9(0xc9)]=_0x169cad;}),_0xbcda4c[_0x3aab64(0xf5)]((_0x2b20ea,_0x34e6f7)=>{var _0x2ad804=_0x3aab64;_0x438c76[_0x34e6f7][_0x2ad804(0x1bb)]=_0x2b20ea;}),_0x236ff9[_0x3aab64(0xf5)]((_0x45342f,_0x28ccdd)=>{_0x438c76[_0x28ccdd]['room_name']=_0x45342f;}),_0x48589c[_0x3aab64(0xf5)]((_0x34049a,_0x1d016a)=>{var _0x7db6a9=_0x3aab64;_0x438c76[_0x1d016a][_0x7db6a9(0x164)]=_0x34049a;}),_0x4e8547['forEach']((_0x21782f,_0xe97129)=>{_0x438c76[_0xe97129]['invoice']=_0x21782f;});const _0x1b8520=_0x236ff9['map'](_0xc120e8=>{return _0xc120e8={'room_name':_0xc120e8};}),_0x57b551=_0x438c76[_0x3aab64(0x136)](_0x2150e3=>_0x2150e3[_0x3aab64(0x167)]!=='0'&&_0x2150e3[_0x3aab64(0x167)]!==''),_0x48120e=new purchases({'invoice':_0x3e7fe7,'suppliers':_0x3908f9[_0x3aab64(0x13e)][_0x3aab64(0x110)],'date':_0x43be56,'warehouse_name':_0x320341,'product':_0x57b551,'note':_0x3e8720,'due_amount':_0x5a0bb3,'POnumber':_0x3b0313,'SCRN':_0x5818ca,'JO_number':_0x405160,'roomList':_0x1b8520}),_0x35f4f9=await _0x48120e[_0x3aab64(0x146)](),_0x939475=await purchases['findOne']({'invoice':_0x3e7fe7}),_0x4416c1=_0x939475['product'][_0x3aab64(0xe6)](async _0x19b58f=>{var _0x16faa5=_0x3aab64,_0x34f257=await warehouse['findOne']({'name':_0x320341,'room':_0x19b58f['room_name']}),_0x58575d=0x0;return _0x34f257[_0x16faa5(0x177)][_0x16faa5(0xf5)](_0x37d917=>{var _0x16fa77=_0x16faa5;_0x37d917[_0x16fa77(0xc6)]==_0x19b58f[_0x16fa77(0xc6)]&&_0x37d917['floorlevel']==_0x19b58f[_0x16fa77(0xb1)]&&_0x37d917[_0x16fa77(0x187)]==_0x19b58f[_0x16fa77(0x187)]&&_0x37d917[_0x16fa77(0xb5)]==_0x19b58f[_0x16fa77(0xb5)]&&_0x37d917[_0x16fa77(0xee)]==_0x19b58f['bay']&&_0x37d917[_0x16fa77(0x13b)]==_0x19b58f[_0x16fa77(0x13b)]&&_0x37d917[_0x16fa77(0xbe)]==_0x19b58f[_0x16fa77(0xbe)]&&_0x37d917[_0x16fa77(0x144)]==_0x19b58f[_0x16fa77(0x144)]&&_0x37d917[_0x16fa77(0xbc)]==_0x19b58f[_0x16fa77(0xbc)]&&_0x37d917[_0x16fa77(0xc9)]==_0x19b58f[_0x16fa77(0xc9)]&&_0x37d917[_0x16fa77(0xdf)]==_0x939475['invoice']&&(_0x37d917[_0x16fa77(0x118)]+=Math[_0x16fa77(0x188)](_0x19b58f['quantity']),_0x58575d++);}),_0x58575d===0x0&&_0x34f257[_0x16faa5(0x177)][_0x16faa5(0xef)]({'product_name':_0x19b58f[_0x16faa5(0xc6)],'product_stock':Math[_0x16faa5(0x188)](_0x19b58f['quantity']),'primary_code':_0x19b58f[_0x16faa5(0x17e)],'secondary_code':_0x19b58f[_0x16faa5(0x157)],'product_code':_0x19b58f[_0x16faa5(0x112)],'storage':_0x19b58f['storage'],'rack':_0x19b58f['rack'],'bay':_0x19b58f['bay'],'bin':_0x19b58f[_0x16faa5(0xb5)],'type':_0x19b58f[_0x16faa5(0x187)],'floorlevel':_0x19b58f['floorlevel'],'maxProducts':_0x19b58f[_0x16faa5(0x10c)],'unit':_0x19b58f['standard_unit'],'secondary_unit':_0x19b58f[_0x16faa5(0xa6)],'expiry_date':_0x19b58f[_0x16faa5(0x144)],'maxPerUnit':_0x19b58f[_0x16faa5(0x180)],'batch_code':_0x19b58f[_0x16faa5(0xbc)],'alertQTY':_0x19b58f[_0x16faa5(0xfa)],'production_date':_0x19b58f[_0x16faa5(0xc9)],'product_cat':_0x19b58f[_0x16faa5(0x1bb)],'invoice':_0x19b58f['invoice'],'actual_qty':Math[_0x16faa5(0x188)](_0x19b58f[_0x16faa5(0x1ac)]),'actual_uom':_0x19b58f[_0x16faa5(0xa2)]}),_0x34f257;});Promise[_0x3aab64(0xc7)](_0x4416c1)[_0x3aab64(0xeb)](async _0x277e4d=>{var _0x11438b=_0x3aab64;try{for(const _0x3b5c5c of _0x277e4d){await _0x3b5c5c[_0x11438b(0x146)]();}const _0x1b01e1=await master_shop[_0x11438b(0xb3)](),_0x585617=await email_settings[_0x11438b(0xc0)](),_0x2b9e17=await supervisor_settings['find']();var _0x5b41e7=_0x939475[_0x11438b(0x15a)],_0x2fd51e='',_0x5383a4;for(_0x5383a4 in _0x5b41e7){_0x2fd51e+=_0x11438b(0x18b)+_0x11438b(0x15b)+_0x5b41e7[_0x5383a4][_0x11438b(0xc6)]+_0x11438b(0x18f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5b41e7[_0x5383a4][_0x11438b(0x112)]+_0x11438b(0x18f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5b41e7[_0x5383a4][_0x11438b(0x167)]+_0x11438b(0x18f)+_0x11438b(0x15b)+_0x5b41e7[_0x5383a4][_0x11438b(0x1be)]+_0x11438b(0x18f)+_0x11438b(0x15b)+_0x5b41e7[_0x5383a4][_0x11438b(0xa6)]+_0x11438b(0x18f)+_0x11438b(0x15b)+_0x939475[_0x11438b(0x163)]+_0x11438b(0x18f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5b41e7[_0x5383a4][_0x11438b(0x17d)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5b41e7[_0x5383a4][_0x11438b(0xbe)]+_0x5b41e7[_0x5383a4]['rack']+_0x5b41e7[_0x5383a4][_0x11438b(0xee)]+_0x5b41e7[_0x5383a4][_0x11438b(0xb5)]+_0x5b41e7[_0x5383a4]['type'][0x0]+_0x5b41e7[_0x5383a4][_0x11438b(0xb1)]+_0x11438b(0x18f),_0x11438b(0xfc);}let _0x2774e0=nodemailer[_0x11438b(0x14d)]({'host':_0x585617[_0x11438b(0x142)],'port':Number(_0x585617['port']),'secure':![],'auth':{'user':_0x585617['email'],'pass':_0x585617[_0x11438b(0x113)]}}),_0x18b35b={'from':_0x585617[_0x11438b(0xb9)],'to':_0x2b9e17[0x0][_0x11438b(0xf4)],'subject':_0x11438b(0xf8),'attachments':[{'filename':_0x11438b(0x129),'path':__dirname+'/../public'+_0x11438b(0xf0)+_0x1b01e1[0x0][_0x11438b(0xa1)],'cid':_0x11438b(0x191)}],'html':'<!DOCTYPE\x20html>'+_0x11438b(0x16e)+_0x11438b(0xec)+'<div>'+_0x11438b(0x150)+'<div>'+_0x11438b(0x12c)+_0x11438b(0x137)+'<div>'+_0x11438b(0x1a9)+_0x1b01e1[0x0]['site_title']+_0x11438b(0xa3)+_0x11438b(0x137)+_0x11438b(0x137)+_0x11438b(0xba)+_0x11438b(0x1a3)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x11438b(0x169)+_0x939475[_0x11438b(0xdf)]+'\x20'+_0x11438b(0xdb)+_0x11438b(0x1aa)+_0x939475[_0x11438b(0x149)]+'\x20'+'</span>'+_0x11438b(0x134)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x11438b(0xf1)+_0x11438b(0x18b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x11438b(0x143)+_0x11438b(0xaa)+_0x11438b(0xa7)+_0x11438b(0x1a1)+_0x11438b(0x130)+_0x11438b(0x1a5)+_0x11438b(0xe2)+_0x11438b(0xfc)+_0x11438b(0x19f)+_0x11438b(0x11a)+'\x20'+_0x2fd51e+'\x20'+_0x11438b(0x1b1)+_0x11438b(0x11e)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x11438b(0x12b)+_0x1b01e1[0x0][_0x11438b(0xcb)]+'</h5>'+'</div>'+_0x11438b(0x137)+'</body></html>'};_0x2774e0[_0x11438b(0x176)](_0x18b35b,function(_0x2bda4f,_0x3a8433){var _0x57b972=_0x11438b;_0x2bda4f?(console['log'](_0x2bda4f),console[_0x57b972(0x1a8)](_0x57b972(0x135))):console['log'](_0x57b972(0xb2));}),_0x3908f9['flash'](_0x11438b(0xbf),_0x11438b(0xb4)),_0x5a553d['redirect'](_0x11438b(0x182));}catch(_0x17e86b){console[_0x11438b(0x1c0)](_0x17e86b),_0x5a553d[_0x11438b(0x186)](0x1f4)['json']({'error':_0x11438b(0xe8)});}})[_0x3aab64(0xf7)](_0x2b7594=>{var _0x57134d=_0x3aab64;console[_0x57134d(0x1c0)](_0x2b7594),_0x5a553d[_0x57134d(0x186)](0x1f4)[_0x57134d(0xbb)]({'error':'An\x20error\x20occurred.'});});}catch(_0x5adfce){console[_0x3aab64(0x1a8)](_0x5adfce);}}),router[a0_0x3e55f6(0x101)](a0_0x3e55f6(0x1a0),auth,async(_0x295c98,_0x1a767a)=>{var _0x31c726=a0_0x3e55f6;try{const {username:_0x228794,email:_0xe6f3cb,role:_0x39a6bb}=_0x295c98[_0x31c726(0x154)],_0x8dfa67=_0x295c98[_0x31c726(0x154)],_0x238abd=await profile['findOne']({'email':_0x8dfa67[_0x31c726(0xb9)]}),_0x258a2f=await master_shop['find'](),_0x276f2e=_0x295c98[_0x31c726(0xac)]['id'],_0x12451c=await purchases['findById'](_0x276f2e),_0x2d5a76=await warehouse[_0x31c726(0xd0)]([{'$match':{'name':_0x12451c[_0x31c726(0x163)],'room':_0x12451c[_0x31c726(0x9f)]}},{'$unwind':_0x31c726(0xe0)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x31c726(0x184)},'product_stock':{'$first':_0x31c726(0x162)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x31c726(0x14a)},'type':{'$first':_0x31c726(0x1a2)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x31c726(0xda)},'secondary_code':{'$first':_0x31c726(0x12a)},'product_code':{'$first':_0x31c726(0x13c)},'storage':{'$first':_0x31c726(0x16c)},'rack':{'$first':_0x31c726(0x126)},'expiry_date':{'$first':_0x31c726(0xd1)}}}]),_0x8d38ad=await customer[_0x31c726(0xb3)]({});let _0x4182db;if(_0x8dfa67[_0x31c726(0x1bc)]=='staff'){const _0x41ab6d=await staff[_0x31c726(0xc0)]({'email':_0x8dfa67[_0x31c726(0xb9)]});_0x4182db=await warehouse['aggregate']([{'$match':{'status':_0x31c726(0x14b),'name':_0x41ab6d[_0x31c726(0x19e)]}},{'$group':{'_id':'$name','name':{'$first':_0x31c726(0x17c)}}}]);}else _0x4182db=await warehouse[_0x31c726(0xd0)]([{'$match':{'status':_0x31c726(0x14b)}},{'$group':{'_id':_0x31c726(0x17c),'name':{'$first':'$name'}}}]);const _0x3ade22=await product[_0x31c726(0xb3)]({}),_0x1c9f64=await suppliers[_0x31c726(0xb3)]({}),_0x1c03b3=BayBinSelected(_0x12451c[_0x31c726(0x163)],_0x12451c[_0x31c726(0x9f)]);if(_0x258a2f[0x0][_0x31c726(0xe3)]==_0x31c726(0x103)){var _0x15c22f=users[_0x31c726(0x10e)];console['log'](_0x15c22f);}else{if(_0x258a2f[0x0][_0x31c726(0xe3)]=='Hindi')var _0x15c22f=users[_0x31c726(0xfb)];else{if(_0x258a2f[0x0][_0x31c726(0xe3)]=='German')var _0x15c22f=users['German'];else{if(_0x258a2f[0x0][_0x31c726(0xe3)]==_0x31c726(0x174))var _0x15c22f=users[_0x31c726(0x174)];else{if(_0x258a2f[0x0][_0x31c726(0xe3)]==_0x31c726(0x195))var _0x15c22f=users['French'];else{if(_0x258a2f[0x0][_0x31c726(0xe3)]==_0x31c726(0x10d))var _0x15c22f=users['Portuguese'];else{if(_0x258a2f[0x0][_0x31c726(0xe3)]=='Chinese')var _0x15c22f=users[_0x31c726(0xd3)];else{if(_0x258a2f[0x0][_0x31c726(0xe3)]==_0x31c726(0x124))var _0x15c22f=users['Arabic'];}}}}}}}_0x1a767a[_0x31c726(0x133)]('edit_purchases_view',{'success':_0x295c98[_0x31c726(0x196)]('success'),'errors':_0x295c98[_0x31c726(0x196)](_0x31c726(0xcf)),'role':_0x8dfa67,'profile':_0x238abd,'customer':_0x8d38ad,'warehouse':_0x4182db,'product':_0x2d5a76,'user':_0x12451c,'master_shop':_0x258a2f,'unit':_0x3ade22,'language':_0x15c22f,'suppliers':_0x1c9f64,'dataSelected':_0x1c03b3});}catch(_0x28d66c){console[_0x31c726(0x1a8)](_0x28d66c);}}),router[a0_0x3e55f6(0x1b3)](a0_0x3e55f6(0x1a0),auth,async(_0x6e01d4,_0x3d99a8)=>{var _0x78ece9=a0_0x3e55f6;try{const _0x3e58f7=_0x6e01d4['params']['id'],{invoice:_0x4d6436,warehouse_name:_0x2697db,Room_name:_0x2cf8c2}=_0x6e01d4['body'],_0x69c98a=await warehouse[_0x78ece9(0xc0)]({'name':_0x2697db,'room':_0x2cf8c2}),_0x39f614=await purchases[_0x78ece9(0xc0)]({'invoice':_0x4d6436});_0x39f614['product'][_0x78ece9(0xf5)](_0x4c3139=>{var _0x14166c=_0x78ece9,_0x51223b=0x0;const _0x38cf5b=_0x69c98a[_0x14166c(0x177)][_0x14166c(0xe6)](_0x2f794e=>{var _0x5a117a=_0x14166c;_0x2f794e[_0x5a117a(0xc6)]==_0x4c3139['product_name']&&_0x2f794e[_0x5a117a(0xb1)]==_0x4c3139['floorlevel']&&_0x2f794e['type']==_0x4c3139['type']&&_0x2f794e[_0x5a117a(0xb5)]==_0x4c3139[_0x5a117a(0xb5)]&&_0x2f794e[_0x5a117a(0xee)]==_0x4c3139[_0x5a117a(0xee)]&&_0x2f794e['rack']==_0x4c3139[_0x5a117a(0x13b)]&&_0x2f794e[_0x5a117a(0xbe)]==_0x4c3139['storage']&&_0x2f794e[_0x5a117a(0x144)]==_0x4c3139[_0x5a117a(0x144)]&&_0x2f794e['batch_code']==_0x4c3139['batch_code']&&_0x2f794e[_0x5a117a(0xc9)]==_0x4c3139[_0x5a117a(0xc9)]&&_0x2f794e[_0x5a117a(0xcd)]==_0x4c3139['delivery_date']&&_0x2f794e[_0x5a117a(0x164)]==_0x4c3139[_0x5a117a(0x164)]&&(_0x2f794e['product_stock']=parseInt(_0x2f794e[_0x5a117a(0x118)])+parseInt(_0x4c3139[_0x5a117a(0x167)]),_0x51223b++);});_0x51223b=='0'&&(_0x69c98a['product_details']=_0x69c98a[_0x14166c(0x177)][_0x14166c(0xd2)]({'product_name':_0x4c3139[_0x14166c(0xc6)],'product_stock':_0x4c3139[_0x14166c(0x167)],'primary_code':_0x4c3139[_0x14166c(0x17e)],'secondary_code':_0x4c3139[_0x14166c(0x157)],'product_code':_0x4c3139[_0x14166c(0x112)],'storage':_0x4c3139['storage'],'rack':_0x4c3139[_0x14166c(0x13b)],'bay':_0x4c3139[_0x14166c(0xee)],'bin':_0x4c3139[_0x14166c(0xb5)],'type':_0x4c3139[_0x14166c(0x187)],'floorlevel':_0x4c3139[_0x14166c(0xb1)],'maxProducts':_0x4c3139[_0x14166c(0x10c)],'unit':_0x4c3139[_0x14166c(0x1be)],'secondary_unit':_0x4c3139['secondary_unit'],'expiry_date':_0x4c3139[_0x14166c(0x144)],'maxPerUnit':_0x4c3139[_0x14166c(0x180)],'batch_code':_0x4c3139[_0x14166c(0xbc)],'alertQTY':_0x4c3139[_0x14166c(0xfa)],'production_date':_0x4c3139['production_date'],'delivery_date':_0x4c3139[_0x14166c(0xcd)],'delivery_code':_0x4c3139[_0x14166c(0x164)]}));}),await _0x69c98a[_0x78ece9(0x146)](),_0x39f614[_0x78ece9(0x160)]=_0x78ece9(0x1af);const _0x11bdb4=await _0x39f614[_0x78ece9(0x146)]();_0x6e01d4[_0x78ece9(0x196)](_0x78ece9(0xbf),'Sales\x20Update\x20successfully'),_0x3d99a8[_0x78ece9(0x138)](_0x78ece9(0x17a));}catch(_0x3f8222){console[_0x78ece9(0x1a8)](_0x3f8222);}}),router[a0_0x3e55f6(0x101)](a0_0x3e55f6(0x131),auth,async(_0x56e1a1,_0x10c85c)=>{var _0x39b44d=a0_0x3e55f6;try{const {username:_0x211f69,email:_0x548f68,role:_0x1957d1}=_0x56e1a1[_0x39b44d(0x154)],_0x362e4a=_0x56e1a1[_0x39b44d(0x154)],_0x10f5da=await profile[_0x39b44d(0xc0)]({'email':_0x362e4a['email']}),_0x36b01d=await master_shop['find'](),_0x40ed23=_0x56e1a1[_0x39b44d(0xac)]['id'],_0x5a4cb=await purchases['findById'](_0x40ed23),_0x3ea6ca=await suppliers[_0x39b44d(0xb3)]({});let _0x250b12;if(_0x362e4a[_0x39b44d(0x1bc)]==_0x39b44d(0x12f)){const _0x449bc0=await staff[_0x39b44d(0xc0)]({'email':_0x362e4a[_0x39b44d(0xb9)]});_0x250b12=await warehouse[_0x39b44d(0xb3)]({'status':_0x39b44d(0x14b),'name':_0x449bc0[_0x39b44d(0x19e)],'warehouse_category':_0x39b44d(0x105)});}else _0x250b12=await warehouse[_0x39b44d(0xd0)]([{'$match':{'status':'Enabled','warehouse_category':_0x39b44d(0x105)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x4c91a8=await product[_0x39b44d(0xb3)]({}),_0x12a6d3=BayBinSelected(_0x5a4cb[_0x39b44d(0x163)],_0x5a4cb['room']);let _0x51e613=new Date(_0x5a4cb[_0x39b44d(0x144)]),_0x2ee3ea=('0'+_0x51e613[_0x39b44d(0x173)]())['slice'](-0x2),_0x5058c1=('0'+(_0x51e613[_0x39b44d(0x1b4)]()+0x1))[_0x39b44d(0xaf)](-0x2),_0x1d9dcb=_0x51e613[_0x39b44d(0x116)](),_0x4d0f82=_0x1d9dcb+'-'+_0x5058c1+'-'+_0x2ee3ea;if(_0x36b01d[0x0][_0x39b44d(0xe3)]=='English\x20(US)'){var _0x1d06d9=users[_0x39b44d(0x10e)];console[_0x39b44d(0x1a8)](_0x1d06d9);}else{if(_0x36b01d[0x0][_0x39b44d(0xe3)]==_0x39b44d(0xfb))var _0x1d06d9=users[_0x39b44d(0xfb)];else{if(_0x36b01d[0x0][_0x39b44d(0xe3)]==_0x39b44d(0xd8))var _0x1d06d9=users[_0x39b44d(0xd8)];else{if(_0x36b01d[0x0][_0x39b44d(0xe3)]=='Spanish')var _0x1d06d9=users[_0x39b44d(0x174)];else{if(_0x36b01d[0x0][_0x39b44d(0xe3)]==_0x39b44d(0x195))var _0x1d06d9=users[_0x39b44d(0x195)];else{if(_0x36b01d[0x0][_0x39b44d(0xe3)]==_0x39b44d(0x10d))var _0x1d06d9=users[_0x39b44d(0x111)];else{if(_0x36b01d[0x0][_0x39b44d(0xe3)]==_0x39b44d(0xd3))var _0x1d06d9=users[_0x39b44d(0xd3)];else{if(_0x36b01d[0x0][_0x39b44d(0xe3)]==_0x39b44d(0x124))var _0x1d06d9=users[_0x39b44d(0x1b5)];}}}}}}}_0x10c85c[_0x39b44d(0x133)]('edit_purchases',{'success':_0x56e1a1[_0x39b44d(0x196)](_0x39b44d(0xbf)),'errors':_0x56e1a1[_0x39b44d(0x196)](_0x39b44d(0xcf)),'role':_0x362e4a,'profile':_0x10f5da,'purchases':_0x5a4cb,'suppliers':_0x3ea6ca,'warehouse':_0x250b12,'product':_0x4c91a8,'master_shop':_0x36b01d,'language':_0x1d06d9,'ed_fullDate':_0x4d0f82,'dataSelected':_0x12a6d3});}catch(_0x41dd85){console['log'](_0x41dd85);}}),router[a0_0x3e55f6(0x1b3)](a0_0x3e55f6(0x131),auth,async(_0x476495,_0x333393)=>{var _0xc39a2b=a0_0x3e55f6;try{const _0x333ed2=_0x476495[_0xc39a2b(0xac)]['id'],_0x4f40df=await purchases[_0xc39a2b(0xc0)]({'_id':_0x476495[_0xc39a2b(0xac)]['id']}),_0x546c5d=await warehouse[_0xc39a2b(0xc0)]({'name':_0x4f40df[_0xc39a2b(0x163)],'room':_0x4f40df['room']});_0x4f40df[_0xc39a2b(0x15a)][_0xc39a2b(0xf5)](_0x554c70=>{var _0x15ffeb=_0xc39a2b;const _0x1a6203=_0x546c5d['product_details'][_0x15ffeb(0xe6)](_0x5e6e81=>{var _0x1d6e55=_0x15ffeb;_0x5e6e81['product_name']==_0x554c70['product_name']&&_0x5e6e81[_0x1d6e55(0xb1)]==_0x554c70['floorlevel']&&_0x5e6e81[_0x1d6e55(0x187)]==_0x554c70[_0x1d6e55(0x187)]&&_0x5e6e81[_0x1d6e55(0xb5)]==_0x554c70[_0x1d6e55(0xb5)]&&_0x5e6e81[_0x1d6e55(0xee)]==_0x554c70['bay']&&_0x5e6e81[_0x1d6e55(0x13b)]==_0x554c70[_0x1d6e55(0x13b)]&&_0x5e6e81[_0x1d6e55(0xbe)]==_0x554c70[_0x1d6e55(0xbe)]&&(_0x5e6e81[_0x1d6e55(0x118)]=parseInt(_0x5e6e81[_0x1d6e55(0x118)])-parseInt(_0x554c70[_0x1d6e55(0x167)]));});}),await _0x546c5d[_0xc39a2b(0x146)]();const {invoice:_0x3cc7f1,suppliers:_0x3a004a,date:_0x3f23dd,warehouse_name:_0x18ae55,prod_name:_0x3eb195,prod_code:_0x4e0332,prod_qty:_0x35f0b6,prod_unit:_0x59e277,prod_secondunit:_0x26006a,prod_level:_0x17afcd,prod_isle:_0x4d1798,prod_pallet:_0x3be071,note:_0x4c7c20,expiry_date:_0x44f584,batch_code:_0x5e9269,paid_amount:_0x1bb95c,due_amount:_0x5becdf,Room_name:_0xf6bf54,primary_code:_0x123bc2,secondary_code:_0xdbfe3a,PO_number:_0x26e609,JO_number:_0x4f1a47}=_0x476495['body'];if(typeof _0x3eb195==_0xc39a2b(0x107))var _0x3ed3f1=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x121)]],_0x5410dc=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x109)]],_0x49468a=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x140)]],_0x19f35b=[_0x476495['body'][_0xc39a2b(0xa5)]],_0x5a3bc2=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xc4)]],_0x54d3cd=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x189)]],_0xacd2c7=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x153)]],_0x1437f1=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x119)]],_0x10fe52=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x17e)]],_0x2eee57=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x157)]],_0x1a52f9=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x1ad)]],_0x332499=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xbc)]],_0x2803e3=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x144)]],_0x3c17f0=[_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xbe)]],_0x30d3e7=[_0x476495['body'][_0xc39a2b(0x10a)]],_0x56f467=[_0x476495['body']['type']];else var _0x3ed3f1=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x121)]],_0x5410dc=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x109)]],_0x49468a=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x140)]],_0x19f35b=[..._0x476495[_0xc39a2b(0x13e)]['prod_unit']],_0x5a3bc2=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xc4)]],_0x54d3cd=[..._0x476495[_0xc39a2b(0x13e)]['prod_level']],_0xacd2c7=[..._0x476495[_0xc39a2b(0x13e)]['prod_isle']],_0x1437f1=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x119)]],_0x10fe52=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x17e)]],_0x2eee57=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x157)]],_0x1a52f9=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x1ad)]],_0x332499=[..._0x476495[_0xc39a2b(0x13e)]['batch_code']],_0x2803e3=[..._0x476495['body'][_0xc39a2b(0x144)]],_0x3c17f0=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xbe)]],_0x30d3e7=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x10a)]],_0x56f467=[..._0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x187)]];const _0x823614=_0x3ed3f1[_0xc39a2b(0xe6)](_0xa12c51=>{return _0xa12c51={'product_name':_0xa12c51};});_0x5410dc['forEach']((_0x372b2e,_0x480408)=>{var _0x39deba=_0xc39a2b;_0x823614[_0x480408][_0x39deba(0x112)]=_0x372b2e;}),_0x49468a[_0xc39a2b(0xf5)]((_0x476c69,_0x1bf34b)=>{var _0x59b058=_0xc39a2b;_0x823614[_0x1bf34b][_0x59b058(0x167)]=_0x476c69;}),_0x19f35b[_0xc39a2b(0xf5)]((_0x103a49,_0x38051c)=>{var _0x3f90bd=_0xc39a2b;_0x823614[_0x38051c][_0x3f90bd(0x1be)]=_0x103a49;}),_0x5a3bc2[_0xc39a2b(0xf5)]((_0x21a0e3,_0x3a6905)=>{_0x823614[_0x3a6905]['secondary_unit']=_0x21a0e3;}),_0x54d3cd[_0xc39a2b(0xf5)]((_0x4e0f90,_0xf32418)=>{var _0x554d9a=_0xc39a2b;_0x823614[_0xf32418][_0x554d9a(0xee)]=_0x4e0f90;}),_0xacd2c7['forEach']((_0xb35ba5,_0x10a92f)=>{var _0x28db9b=_0xc39a2b;_0x823614[_0x10a92f][_0x28db9b(0xb5)]=_0xb35ba5;}),_0x1437f1[_0xc39a2b(0xf5)]((_0x59f752,_0x1e0b8a)=>{_0x823614[_0x1e0b8a]['floorlevel']=_0x59f752;}),_0x10fe52[_0xc39a2b(0xf5)]((_0x50b36a,_0x4a7d1a)=>{var _0x5f40ab=_0xc39a2b;_0x823614[_0x4a7d1a][_0x5f40ab(0x17e)]=_0x50b36a;}),_0x2eee57[_0xc39a2b(0xf5)]((_0x10513b,_0x5baccc)=>{_0x823614[_0x5baccc]['secondary_code']=_0x10513b;}),_0x1a52f9['forEach']((_0x5025d7,_0x4e0c94)=>{var _0x1455b2=_0xc39a2b;_0x823614[_0x4e0c94][_0x1455b2(0x10c)]=_0x5025d7;}),_0x332499[_0xc39a2b(0xf5)]((_0x23d017,_0x4c1334)=>{var _0x97d7b7=_0xc39a2b;_0x823614[_0x4c1334][_0x97d7b7(0xbc)]=_0x23d017;}),_0x2803e3[_0xc39a2b(0xf5)]((_0x53a592,_0x5477f6)=>{var _0x290751=_0xc39a2b;_0x823614[_0x5477f6][_0x290751(0x144)]=_0x53a592;}),_0x56f467['forEach']((_0x5ef5e0,_0x42df05)=>{var _0x2ac2e6=_0xc39a2b;_0x823614[_0x42df05][_0x2ac2e6(0x187)]=_0x5ef5e0;}),_0x3c17f0['forEach']((_0x538a2e,_0xa1ec53)=>{var _0x54c58=_0xc39a2b;_0x823614[_0xa1ec53][_0x54c58(0xbe)]=_0x538a2e;}),_0x30d3e7[_0xc39a2b(0xf5)]((_0xf0a36c,_0x38fca2)=>{var _0xc58612=_0xc39a2b;_0x823614[_0x38fca2][_0xc58612(0x13b)]=_0xf0a36c;});const _0x42d023=_0x823614['filter'](_0x1dfcd2=>_0x1dfcd2[_0xc39a2b(0x167)]!=='0'&&_0x1dfcd2[_0xc39a2b(0x167)]!=='');_0x4f40df[_0xc39a2b(0xdf)]=_0x3cc7f1,_0x4f40df[_0xc39a2b(0x110)]=_0x3a004a,_0x4f40df[_0xc39a2b(0x149)]=_0x3f23dd,_0x4f40df[_0xc39a2b(0x163)]=_0x18ae55,_0x4f40df['product']=_0x42d023,_0x4f40df[_0xc39a2b(0x12e)]=_0x4c7c20,_0x4f40df[_0xc39a2b(0xc8)]=_0x1bb95c,_0x4f40df[_0xc39a2b(0x122)]=_0x5becdf,_0x4f40df[_0xc39a2b(0x9f)]=_0xf6bf54,_0x4f40df['POnumber']=_0x26e609,_0x4f40df['JO_number']=_0x4f1a47;const _0x1be19b=await _0x4f40df[_0xc39a2b(0x146)](),_0x1b9fdb=await warehouse[_0xc39a2b(0xc0)]({'name':_0x476495[_0xc39a2b(0x13e)]['warehouse_name'],'room':_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xe5)]});_0x4f40df['product'][_0xc39a2b(0xf5)](_0x3c9a8b=>{var _0x575b51=_0xc39a2b,_0x43b38b=0x0;const _0x5e8e02=_0x1b9fdb[_0x575b51(0x177)]['map'](_0xbade6e=>{var _0xbb2607=_0x575b51;_0xbade6e[_0xbb2607(0xc6)]==_0x3c9a8b[_0xbb2607(0xc6)]&&_0xbade6e[_0xbb2607(0xb1)]==_0x3c9a8b[_0xbb2607(0xb1)]&&_0xbade6e[_0xbb2607(0x187)]==_0x3c9a8b[_0xbb2607(0x187)]&&_0xbade6e['bin']==_0x3c9a8b[_0xbb2607(0xb5)]&&_0xbade6e[_0xbb2607(0xee)]==_0x3c9a8b[_0xbb2607(0xee)]&&_0xbade6e[_0xbb2607(0x13b)]==_0x3c9a8b[_0xbb2607(0x13b)]&&_0xbade6e[_0xbb2607(0xbe)]==_0x3c9a8b[_0xbb2607(0xbe)]&&(_0xbade6e[_0xbb2607(0x118)]=parseInt(_0xbade6e[_0xbb2607(0x118)])+parseInt(_0x3c9a8b['quantity']),_0x43b38b++);});_0x43b38b=='0'&&(_0x1b9fdb[_0x575b51(0x177)]=_0x1b9fdb[_0x575b51(0x177)][_0x575b51(0xd2)]({'product_name':_0x3c9a8b[_0x575b51(0xc6)],'product_stock':_0x3c9a8b[_0x575b51(0x167)],'primary_code':_0x3c9a8b[_0x575b51(0x17e)],'secondary_code':_0x3c9a8b[_0x575b51(0x157)],'product_code':_0x3c9a8b[_0x575b51(0x112)],'storage':_0x3c9a8b[_0x575b51(0xbe)],'rack':_0x3c9a8b[_0x575b51(0x13b)],'bay':_0x3c9a8b[_0x575b51(0xee)],'bin':_0x3c9a8b[_0x575b51(0xb5)],'type':_0x3c9a8b[_0x575b51(0x187)],'floorlevel':_0x3c9a8b[_0x575b51(0xb1)],'maxProducts':_0x3c9a8b[_0x575b51(0x10c)],'unit':_0x3c9a8b['standard_unit'],'secondary_unit':_0x3c9a8b[_0x575b51(0xa6)],'expiry_date':_0x3c9a8b[_0x575b51(0x144)]}));}),await _0x1b9fdb['save']();const _0x43e846=await s_payment_data[_0xc39a2b(0xc0)]({'invoice':_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xdf)]});if(_0x43e846===null){}else console[_0xc39a2b(0x1a8)]('suppliers',_0x43e846,_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0xdf)]),_0x43e846[_0xc39a2b(0x110)]=_0x476495[_0xc39a2b(0x13e)][_0xc39a2b(0x110)],await _0x43e846[_0xc39a2b(0x146)]();_0x476495[_0xc39a2b(0x196)](_0xc39a2b(0xbf),_0xc39a2b(0x14c)),_0x333393[_0xc39a2b(0x138)]('/all_purchases/view');}catch(_0x36aaa5){console[_0xc39a2b(0x1a8)](_0x36aaa5);}}),router['post'](a0_0x3e55f6(0x125),auth,async(_0x1f2be9,_0x4286b7)=>{var _0x108854=a0_0x3e55f6;try{const _0x1bd75c=_0x1f2be9['params']['id'],{invoice:_0x9ee0b1,suppliers:_0x576718,payable:_0x15c06d,due_amount:_0x32ece9}=_0x1f2be9['body'],_0x1fa5d9=await purchases[_0x108854(0xc2)](_0x1bd75c);var _0x252c65=_0x15c06d-_0x32ece9;_0x1fa5d9[_0x108854(0xc8)]=parseFloat(_0x1fa5d9[_0x108854(0xc8)])+parseFloat(_0x32ece9),_0x1fa5d9[_0x108854(0x122)]=_0x252c65;const _0x4ac057=await _0x1fa5d9[_0x108854(0x146)]();console[_0x108854(0x1a8)](_0x4ac057);const _0x105c51=await s_payment_data[_0x108854(0xc0)]({'invoice':_0x9ee0b1});_0x105c51[_0x108854(0x12d)]=_0x252c65,await _0x105c51[_0x108854(0x146)]();let _0x57565f=new Date(),_0x50a9fe=('0'+_0x57565f['getDate']())[_0x108854(0xaf)](-0x2),_0x42c0d0=('0'+(_0x57565f['getMonth']()+0x1))[_0x108854(0xaf)](-0x2),_0x512aee=_0x57565f['getFullYear'](),_0x10fee9=_0x512aee+'-'+_0x42c0d0+'-'+_0x50a9fe;const _0x2d9ae0=new suppliers_payment({'invoice':_0x9ee0b1,'date':_0x512aee+'-'+_0x42c0d0+'-'+_0x50a9fe,'suppliers':_0x576718,'reason':_0x108854(0x1a4),'amount':_0x32ece9}),_0x426ac8=await _0x2d9ae0[_0x108854(0x146)]();_0x1f2be9['flash'](_0x108854(0xbf),_0x108854(0x14f)),_0x4286b7['redirect'](_0x108854(0x17a));}catch(_0xd8e655){console[_0x108854(0x1a8)](_0xd8e655);}}),router[a0_0x3e55f6(0x101)](a0_0x3e55f6(0xfe),auth,async(_0x1a942b,_0x4b22b7)=>{var _0xa1985a=a0_0x3e55f6;try{const {username:_0x1ab800,email:_0x120ace,role:_0x1ae130}=_0x1a942b[_0xa1985a(0x154)],_0x50e9b4=_0x1a942b[_0xa1985a(0x154)],_0x399679=await profile[_0xa1985a(0xc0)]({'email':_0x50e9b4[_0xa1985a(0xb9)]}),_0x1a5da7=await master_shop[_0xa1985a(0xb3)]();console[_0xa1985a(0x1a8)](_0xa1985a(0x192),_0x1a5da7);const _0x5bd80a=_0x1a942b[_0xa1985a(0xac)]['id'],_0x51a903=await purchases['findById'](_0x5bd80a);console[_0xa1985a(0x1a8)](_0x51a903);const _0x5cfa0f=await suppliers['findOne']({'name':_0x51a903['suppliers']});console['log'](_0x5cfa0f);if(_0x1a5da7[0x0][_0xa1985a(0xe3)]==_0xa1985a(0x103)){var _0x558c9e=users[_0xa1985a(0x10e)];console[_0xa1985a(0x1a8)](_0x558c9e);}else{if(_0x1a5da7[0x0][_0xa1985a(0xe3)]==_0xa1985a(0xfb))var _0x558c9e=users['Hindi'];else{if(_0x1a5da7[0x0][_0xa1985a(0xe3)]=='German')var _0x558c9e=users[_0xa1985a(0xd8)];else{if(_0x1a5da7[0x0][_0xa1985a(0xe3)]==_0xa1985a(0x174))var _0x558c9e=users[_0xa1985a(0x174)];else{if(_0x1a5da7[0x0][_0xa1985a(0xe3)]=='French')var _0x558c9e=users[_0xa1985a(0x195)];else{if(_0x1a5da7[0x0][_0xa1985a(0xe3)]==_0xa1985a(0x10d))var _0x558c9e=users['Portuguese'];else{if(_0x1a5da7[0x0][_0xa1985a(0xe3)]=='Chinese')var _0x558c9e=users[_0xa1985a(0xd3)];else{if(_0x1a5da7[0x0]['language']==_0xa1985a(0x124))var _0x558c9e=users[_0xa1985a(0x1b5)];}}}}}}}_0x4b22b7[_0xa1985a(0x133)](_0xa1985a(0x17f),{'success':_0x1a942b[_0xa1985a(0x196)](_0xa1985a(0xbf)),'errors':_0x1a942b[_0xa1985a(0x196)](_0xa1985a(0xcf)),'role':_0x50e9b4,'profile':_0x399679,'master_shop':_0x1a5da7,'supplier':_0x5cfa0f,'purchase':_0x51a903,'language':_0x558c9e});}catch(_0x50a6a2){console[_0xa1985a(0x1a8)](_0x50a6a2);}}),router[a0_0x3e55f6(0x101)]('/view/return_purchase/:id',auth,async(_0x199f50,_0x41f699)=>{var _0x4e872c=a0_0x3e55f6;try{const {username:_0x159799,email:_0x105868,role:_0x53bdf9}=_0x199f50[_0x4e872c(0x154)],_0x4d4ba0=_0x199f50['user'],_0x439ac4=await profile[_0x4e872c(0xc0)]({'email':_0x4d4ba0['email']}),_0x26f075=await master_shop[_0x4e872c(0xb3)]();console['log']('master',_0x26f075);const _0x5841bc=_0x199f50['params']['id'];console[_0x4e872c(0x1a8)](_0x5841bc);const _0x5df1ac=await purchases['findById'](_0x5841bc);console['log'](_0x4e872c(0x155),_0x5df1ac);const _0x5381da=await product[_0x4e872c(0xb3)]({}),_0x210430=await warehouse[_0x4e872c(0xd0)]([{'$match':{'name':_0x5df1ac[_0x4e872c(0x163)],'room':_0x5df1ac[_0x4e872c(0x9f)],'warehouse_category':_0x4e872c(0x105)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4e872c(0x161),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4e872c(0x162)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x4e872c(0x14a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4e872c(0xa9)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4e872c(0x12a)},'product_code':{'$first':_0x4e872c(0x13c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4e872c(0x126)}}}]);warehouse_data=await warehouse['aggregate']([{'$match':{'status':_0x4e872c(0x14b),'name':_0x4e872c(0x108),'warehouse_category':_0x4e872c(0x105)}},{'$group':{'_id':_0x4e872c(0x17c),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),console[_0x4e872c(0x1a8)](_0x4e872c(0xea),_0x210430);if(_0x26f075[0x0]['language']==_0x4e872c(0x103)){var _0x496746=users[_0x4e872c(0x10e)];console['log'](_0x496746);}else{if(_0x26f075[0x0][_0x4e872c(0xe3)]=='Hindi')var _0x496746=users[_0x4e872c(0xfb)];else{if(_0x26f075[0x0]['language']==_0x4e872c(0xd8))var _0x496746=users[_0x4e872c(0xd8)];else{if(_0x26f075[0x0][_0x4e872c(0xe3)]=='Spanish')var _0x496746=users[_0x4e872c(0x174)];else{if(_0x26f075[0x0][_0x4e872c(0xe3)]==_0x4e872c(0x195))var _0x496746=users['French'];else{if(_0x26f075[0x0][_0x4e872c(0xe3)]==_0x4e872c(0x10d))var _0x496746=users['Portuguese'];else{if(_0x26f075[0x0]['language']==_0x4e872c(0xd3))var _0x496746=users[_0x4e872c(0xd3)];else{if(_0x26f075[0x0][_0x4e872c(0xe3)]==_0x4e872c(0x124))var _0x496746=users[_0x4e872c(0x1b5)];}}}}}}}_0x41f699[_0x4e872c(0x133)](_0x4e872c(0x18d),{'success':_0x199f50['flash'](_0x4e872c(0xbf)),'errors':_0x199f50[_0x4e872c(0x196)]('errors'),'role':_0x4d4ba0,'profile':_0x439ac4,'user':_0x5df1ac,'stock':_0x210430,'master_shop':_0x26f075,'product':_0x5381da,'language':_0x496746,'warehouse':warehouse_data});}catch(_0x272285){console[_0x4e872c(0x1a8)](_0x272285);}}),router[a0_0x3e55f6(0x1b3)](a0_0x3e55f6(0x19d),auth,async(_0x50933c,_0x1a49aa)=>{var _0x426fd8=a0_0x3e55f6;try{const {invoice:_0x17801a,date:_0x5a8d5e,warehouse_name:_0x4d69ed,Room_name:_0x1c8de2,product_name:_0x273822,purchase_quantity:_0x28c771,stocks:_0x427e3f,return_qty:_0x376ae2,note:_0x5407f6,level:_0x563b18,isle:_0x328425,pallet:_0x24a102,to_warehouse_name:_0x514e12,to_Room_name:_0x44430d}=_0x50933c[_0x426fd8(0x13e)],_0x3f0abe=await purchases['findOne']({'_id':_0x50933c[_0x426fd8(0xac)]['id']}),_0xeea1d1=await warehouse[_0x426fd8(0xc0)]({'name':_0x4d69ed,'room':_0x1c8de2});if(typeof _0x273822==_0x426fd8(0x107))var _0x5a1ebc=[_0x50933c['body'][_0x426fd8(0xc6)]],_0x5daa16=[_0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x16f)]],_0x31c859=[_0x50933c[_0x426fd8(0x13e)]['stocks']],_0xeb4985=[_0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x151)]],_0x8244ed=[_0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x15e)]],_0x16e711=[_0x50933c[_0x426fd8(0x13e)]['isle']],_0x1631d2=[_0x50933c['body'][_0x426fd8(0xad)]],_0x5cec54=[_0x50933c['body'][_0x426fd8(0x1ae)]],_0x2edb80=[_0x50933c['body'][_0x426fd8(0x15c)]],_0x5d6deb=[_0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x1ab)]],_0x308a80=[_0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x1bd)]];else var _0x5a1ebc=[..._0x50933c['body'][_0x426fd8(0xc6)]],_0x5daa16=[..._0x50933c['body'][_0x426fd8(0x16f)]],_0x31c859=[..._0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x1c1)]],_0xeb4985=[..._0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x151)]],_0x8244ed=[..._0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x15e)]],_0x16e711=[..._0x50933c['body'][_0x426fd8(0xf2)]],_0x1631d2=[..._0x50933c[_0x426fd8(0x13e)][_0x426fd8(0xad)]],_0x5cec54=[..._0x50933c['body'][_0x426fd8(0x1ae)]],_0x2edb80=[..._0x50933c['body']['product_code_hide']],_0x5d6deb=[..._0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x1ab)]],_0x308a80=[..._0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x1bd)]];const _0x399abc=_0x5a1ebc['map'](_0xe240d8=>{return _0xe240d8={'product_name':_0xe240d8};});_0x5daa16[_0x426fd8(0xf5)]((_0x4bc3cd,_0x3d26df)=>{var _0x29169e=_0x426fd8;_0x399abc[_0x3d26df][_0x29169e(0x16f)]=_0x4bc3cd;}),_0x31c859[_0x426fd8(0xf5)]((_0x2dc1d4,_0x5421be)=>{var _0x4a6844=_0x426fd8;_0x399abc[_0x5421be][_0x4a6844(0xff)]=_0x2dc1d4;}),_0xeb4985[_0x426fd8(0xf5)]((_0x15a679,_0x401d03)=>{var _0xe1cf1e=_0x426fd8;_0x399abc[_0x401d03][_0xe1cf1e(0x151)]=_0x15a679;}),_0x8244ed[_0x426fd8(0xf5)]((_0x4d53b7,_0x47f052)=>{var _0x27e20f=_0x426fd8;_0x399abc[_0x47f052][_0x27e20f(0xee)]=_0x4d53b7;}),_0x16e711['forEach']((_0x167733,_0x14683f)=>{var _0xa2acf2=_0x426fd8;_0x399abc[_0x14683f][_0xa2acf2(0xb5)]=_0x167733;}),_0x1631d2['forEach']((_0x6d8494,_0x37244d)=>{var _0xc1d845=_0x426fd8;_0x399abc[_0x37244d][_0xc1d845(0xb1)]=_0x6d8494;}),_0x5cec54[_0x426fd8(0xf5)]((_0xff50d2,_0x28e194)=>{var _0x339048=_0x426fd8;_0x399abc[_0x28e194][_0x339048(0x187)]=_0xff50d2;}),_0x2edb80[_0x426fd8(0xf5)]((_0x312769,_0x45d9cc)=>{var _0x1cacf5=_0x426fd8;_0x399abc[_0x45d9cc][_0x1cacf5(0x112)]=_0x312769;}),_0x5d6deb[_0x426fd8(0xf5)]((_0x39f5c9,_0x173d2e)=>{var _0x145d41=_0x426fd8;_0x399abc[_0x173d2e][_0x145d41(0x17e)]=_0x39f5c9;}),_0x308a80['forEach']((_0x298a33,_0x5d057c)=>{var _0x2aa4a0=_0x426fd8;_0x399abc[_0x5d057c][_0x2aa4a0(0x157)]=_0x298a33;}),_0x3f0abe[_0x426fd8(0x15a)][_0x426fd8(0xf5)](_0x44c3fb=>{var _0x5c11fc=_0x426fd8;const _0x348e39=_0xeea1d1[_0x5c11fc(0x177)]['map'](_0x6ea507=>{var _0x2d3ec9=_0x5c11fc;_0x6ea507[_0x2d3ec9(0xc6)]==_0x44c3fb[_0x2d3ec9(0xc6)]&&_0x6ea507[_0x2d3ec9(0xb1)]==_0x44c3fb['floorlevel']&&_0x6ea507['type']==_0x44c3fb['type']&&_0x6ea507[_0x2d3ec9(0xb5)]==_0x44c3fb['bin']&&_0x6ea507[_0x2d3ec9(0xee)]==_0x44c3fb['bay']&&_0x6ea507[_0x2d3ec9(0x13b)]==_0x44c3fb[_0x2d3ec9(0x13b)]&&_0x6ea507[_0x2d3ec9(0xbe)]==_0x44c3fb[_0x2d3ec9(0xbe)]&&(console[_0x2d3ec9(0x1a8)](parseInt(_0x6ea507[_0x2d3ec9(0x118)])+_0x2d3ec9(0xfd)+parseInt(_0x44c3fb['quantity'])),_0x6ea507['product_stock']=parseInt(_0x6ea507['product_stock'])+parseInt(_0x44c3fb[_0x2d3ec9(0x167)]));});}),await _0xeea1d1[_0x426fd8(0x146)]();const _0xbf899b=_0x399abc[_0x426fd8(0x136)](_0x4afb4c=>_0x4afb4c[_0x426fd8(0x151)]!=='0'&&_0x4afb4c[_0x426fd8(0x151)]!=='');var _0x11d746=0x0;_0xbf899b[_0x426fd8(0xf5)](_0x4c6e45=>{var _0x5c8fb1=_0x426fd8;console[_0x5c8fb1(0x1a8)](_0x5c8fb1(0x10b),_0x4c6e45),(parseInt(_0x4c6e45[_0x5c8fb1(0x16f)])<parseInt(_0x4c6e45[_0x5c8fb1(0x151)])||parseInt(_0x4c6e45[_0x5c8fb1(0xff)])<parseInt(_0x4c6e45[_0x5c8fb1(0x151)]))&&_0x11d746++;});if(_0x11d746!=0x0)return _0x50933c[_0x426fd8(0x196)](_0x426fd8(0xcf),'Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty'),_0x1a49aa[_0x426fd8(0x138)](_0x426fd8(0xb7));const _0x1147d1=new purchases_return({'invoice':_0x17801a,'suppliers':_0x50933c[_0x426fd8(0x13e)]['suppliers'],'date':_0x5a8d5e,'warehouse_name':_0x4d69ed,'return_product':_0xbf899b,'note':_0x5407f6,'room':_0x1c8de2,'to_warehouse_name':_0x514e12,'to_room':_0x44430d}),_0x32bd82=await _0x1147d1[_0x426fd8(0x146)]();console[_0x426fd8(0x1a8)](_0x1147d1);const _0x12308c=await purchases_return[_0x426fd8(0xc0)]({'invoice':_0x17801a}),_0x1c2ab7=await warehouse[_0x426fd8(0xc0)]({'name':_0x514e12,'room':_0x44430d});_0x12308c[_0x426fd8(0x193)]['forEach'](_0x534e93=>{var _0x2c0b2e=_0x426fd8,_0x449d56=0x0;const _0xd5bdfe=_0x1c2ab7[_0x2c0b2e(0x177)][_0x2c0b2e(0xe6)](_0x2e24d9=>{var _0x554c7d=_0x2c0b2e;_0x2e24d9[_0x554c7d(0xc6)]==_0x534e93[_0x554c7d(0xc6)]&&_0x2e24d9['floorlevel']==_0x534e93[_0x554c7d(0xb1)]&&_0x2e24d9[_0x554c7d(0x187)]==_0x534e93[_0x554c7d(0x187)]&&_0x2e24d9['bin']==_0x534e93[_0x554c7d(0xb5)]&&_0x2e24d9[_0x554c7d(0xee)]==_0x534e93[_0x554c7d(0xee)]&&(_0x2e24d9[_0x554c7d(0x118)]=parseInt(_0x2e24d9[_0x554c7d(0x118)])-parseInt(_0x534e93[_0x554c7d(0x151)]),_0x449d56++);});_0x449d56=='0'&&(_0x1c2ab7[_0x2c0b2e(0x177)]=_0x1c2ab7[_0x2c0b2e(0x177)][_0x2c0b2e(0xd2)]({'product_name':_0x534e93[_0x2c0b2e(0xc6)],'product_stock':_0x534e93[_0x2c0b2e(0x151)],'primary_code':_0x534e93[_0x2c0b2e(0x17e)],'secondary_code':_0x534e93['secondary_code'],'product_code':_0x534e93['product_code'],'storage':_0x534e93[_0x2c0b2e(0xbe)],'rack':_0x534e93['rack'],'bay':_0x534e93['bay'],'bin':_0x534e93['bin'],'type':_0x534e93[_0x2c0b2e(0x187)],'floorlevel':_0x534e93[_0x2c0b2e(0xb1)],'maxProducts':_0x534e93[_0x2c0b2e(0x10c)],'unit':_0x534e93['standard_unit'],'secondary_unit':_0x534e93[_0x2c0b2e(0xa6)],'expiry_date':_0x534e93[_0x2c0b2e(0x144)]}));}),await _0x1c2ab7[_0x426fd8(0x146)]();const _0x33b78c=await purchases['findOne']({'invoice':_0x17801a});_0x33b78c['return_data']=_0x426fd8(0x1af);const _0x42d196=await _0x33b78c[_0x426fd8(0x146)](),_0x51d560=new s_payment_data({'invoice':_0x17801a,'suppliers':_0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x110)],'reason':_0x426fd8(0x175)});await _0x51d560[_0x426fd8(0x146)]();const _0x4c7076=await master_shop[_0x426fd8(0xb3)]();console['log'](_0x426fd8(0x19c),_0x4c7076[0x0][_0x426fd8(0xa1)]);const _0x382ab7=await email_settings[_0x426fd8(0xc0)](),_0x20de91=await suppliers[_0x426fd8(0xc0)]({'name':_0x50933c[_0x426fd8(0x13e)][_0x426fd8(0x110)]});console[_0x426fd8(0x1a8)](_0x426fd8(0xd4),_0x20de91);_0x4c7076[0x0][_0x426fd8(0xf9)]==0x1?(right_currency=_0x4c7076[0x0][_0x426fd8(0xc1)],left_currency=''):(right_currency='',left_currency=_0x4c7076[0x0][_0x426fd8(0xc1)]);var _0x2dc0e7=_0x5a1ebc,_0x19ae81=_0xeb4985,_0x27ba6b='',_0x5f4a9b;for(_0x5f4a9b in _0x2dc0e7){_0x27ba6b+=_0x426fd8(0x18b)+_0x426fd8(0x15b)+_0x2dc0e7[_0x5f4a9b]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19ae81[_0x5f4a9b]+_0x426fd8(0x18f)+'</tr>';}console[_0x426fd8(0x1a8)](_0x426fd8(0x185),_0x27ba6b);let _0x2d91cf=nodemailer['createTransport']({'service':_0x426fd8(0x148),'auth':{'user':_0x382ab7[_0x426fd8(0xb9)],'pass':_0x382ab7[_0x426fd8(0x113)]}}),_0x10aff1={'from':_0x382ab7[_0x426fd8(0xb9)],'to':_0x20de91['email'],'subject':_0x426fd8(0xcc),'attachments':[{'filename':_0x426fd8(0x129),'path':__dirname+_0x426fd8(0x1ba)+_0x426fd8(0xf0)+_0x4c7076[0x0][_0x426fd8(0xa1)],'cid':_0x426fd8(0x191)}],'html':'<!DOCTYPE\x20html>'+_0x426fd8(0x16e)+_0x426fd8(0xec)+_0x426fd8(0x1a3)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x426fd8(0x1a3)+_0x426fd8(0x12c)+_0x426fd8(0x137)+_0x426fd8(0x1a3)+_0x426fd8(0x1a9)+_0x4c7076[0x0][_0x426fd8(0xcb)]+_0x426fd8(0xa3)+_0x426fd8(0x137)+_0x426fd8(0x137)+_0x426fd8(0xba)+_0x426fd8(0x1a3)+_0x426fd8(0x1c2)+_0x426fd8(0x169)+_0x17801a+'\x20'+_0x426fd8(0xdb)+_0x426fd8(0x1aa)+_0x5a8d5e+'\x20'+_0x426fd8(0x19a)+_0x426fd8(0x134)+_0x426fd8(0x137)+_0x426fd8(0x1b0)+_0x426fd8(0xf1)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x426fd8(0x172)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x426fd8(0xfc)+_0x426fd8(0x19f)+_0x426fd8(0x11a)+'\x20'+_0x27ba6b+'\x20'+'</tbody>'+_0x426fd8(0x11e)+_0x426fd8(0x1a3)+_0x426fd8(0x100)+'<h5>'+_0x4c7076[0x0][_0x426fd8(0xcb)]+'</h5>'+_0x426fd8(0x137)+_0x426fd8(0x137)+'</body></html>'};_0x2d91cf[_0x426fd8(0x176)](_0x10aff1,function(_0x51f74a,_0x3f1338){var _0x97098e=_0x426fd8;_0x51f74a?(console[_0x97098e(0x1a8)](_0x51f74a),console[_0x97098e(0x1a8)]('Error\x20Occurs')):console['log'](_0x97098e(0xb2));}),_0x50933c[_0x426fd8(0x196)](_0x426fd8(0xbf),_0x426fd8(0x115)),_0x1a49aa['redirect'](_0x426fd8(0x17a));}catch(_0x272bba){console[_0x426fd8(0x1a8)](_0x272bba),_0x1a49aa[_0x426fd8(0x186)](0xc8)['json']({'message':_0x272bba[_0x426fd8(0xd7)]});}}),router[a0_0x3e55f6(0x101)](a0_0x3e55f6(0xce),auth,async(_0x17b671,_0xf589f1)=>{var _0x5f0fcf=a0_0x3e55f6;try{const {username:_0x441bb7,email:_0x3e4639,role:_0x4ea336}=_0x17b671[_0x5f0fcf(0x154)],_0x1b65b1=_0x17b671['user'],_0x2b00dc=await profile['findOne']({'email':_0x1b65b1[_0x5f0fcf(0xb9)]}),_0x135f4c=await master_shop[_0x5f0fcf(0xb3)](),_0x260589=_0x17b671[_0x5f0fcf(0xac)]['id'],_0x24515d=await purchases[_0x5f0fcf(0xc2)](_0x260589);if(_0x135f4c[0x0][_0x5f0fcf(0xe3)]==_0x5f0fcf(0x103))var _0x4c57a5=users['English'];else{if(_0x135f4c[0x0][_0x5f0fcf(0xe3)]=='Hindi')var _0x4c57a5=users['Hindi'];else{if(_0x135f4c[0x0][_0x5f0fcf(0xe3)]==_0x5f0fcf(0xd8))var _0x4c57a5=users[_0x5f0fcf(0xd8)];else{if(_0x135f4c[0x0]['language']==_0x5f0fcf(0x174))var _0x4c57a5=users[_0x5f0fcf(0x174)];else{if(_0x135f4c[0x0][_0x5f0fcf(0xe3)]==_0x5f0fcf(0x195))var _0x4c57a5=users[_0x5f0fcf(0x195)];else{if(_0x135f4c[0x0][_0x5f0fcf(0xe3)]==_0x5f0fcf(0x10d))var _0x4c57a5=users['Portuguese'];else{if(_0x135f4c[0x0][_0x5f0fcf(0xe3)]==_0x5f0fcf(0xd3))var _0x4c57a5=users[_0x5f0fcf(0xd3)];else{if(_0x135f4c[0x0][_0x5f0fcf(0xe3)]==_0x5f0fcf(0x124))var _0x4c57a5=users[_0x5f0fcf(0x1b5)];}}}}}}}_0xf589f1['render'](_0x5f0fcf(0x18e),{'success':_0x17b671[_0x5f0fcf(0x196)]('success'),'errors':_0x17b671[_0x5f0fcf(0x196)](_0x5f0fcf(0xcf)),'role':_0x1b65b1,'profile':_0x2b00dc,'alldata':_0x24515d,'master_shop':_0x135f4c,'language':_0x4c57a5}),console[_0x5f0fcf(0x1a8)](alldata);}catch(_0x1266cb){console[_0x5f0fcf(0x1a8)](_0x1266cb);}}),router['post'](a0_0x3e55f6(0x14e),async(_0x3b7243,_0x5bdff2)=>{var _0x4dddad=a0_0x3e55f6;const {product_code:_0x5408d5}=_0x3b7243[_0x4dddad(0x13e)];var _0x221f23;const _0x1027b0=await product['aggregate']([{'$match':{'primary_code':_0x5408d5,'product_category':_0x4dddad(0x105)}},{'$group':{'_id':_0x4dddad(0x19b),'name':{'$first':'$name'},'category':{'$first':_0x4dddad(0x1a6)},'brand':{'$first':_0x4dddad(0x117)},'unit':{'$first':_0x4dddad(0xa4)},'alertquantity':{'$first':_0x4dddad(0x159)},'product_code':{'$first':_0x4dddad(0x11d)},'primary_code':{'$first':_0x4dddad(0x183)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x4dddad(0x139)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x4dddad(0xe7)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x428bfb=await product[_0x4dddad(0xd0)]([{'$match':{'secondary_code':_0x5408d5,'product_category':_0x4dddad(0x105)}},{'$group':{'_id':_0x4dddad(0x19b),'name':{'$first':_0x4dddad(0x17c)},'category':{'$first':'$category'},'brand':{'$first':_0x4dddad(0x117)},'unit':{'$first':'$unit'},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x4dddad(0x11d)},'primary_code':{'$first':_0x4dddad(0x183)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x4dddad(0x139)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x4dddad(0xe7)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x1027b0[_0x4dddad(0x1b7)]>0x0)_0x221f23=_0x1027b0;else _0x428bfb['length']>0x0&&(_0x221f23=_0x428bfb);_0x5bdff2[_0x4dddad(0xbb)](_0x221f23);}),router[a0_0x3e55f6(0x1b3)](a0_0x3e55f6(0xdd),async(_0xa28176,_0x4b738b)=>{var _0x21a9a7=a0_0x3e55f6;const {primaryCode:_0x46c42b,secondaryCode:_0x39560f,productCode:_0x24a793,bay:_0x3810aa,bin:_0x2b0b88,types:_0x404eac,pallet:_0x53796f,warehouses:_0x3e8962,room:_0x11ff11}=_0xa28176['body'];console[_0x21a9a7(0x1a8)](_0xa28176[_0x21a9a7(0x13e)]);try{const _0x538abe=await warehouse[_0x21a9a7(0xd0)]([{'$match':{'name':_0x3e8962,'room':_0x11ff11}},{'$unwind':_0x21a9a7(0xe0)},{'$match':{'product_details.bay':_0x3810aa,'product_details.bin':_0x2b0b88,'product_details.type':_0x404eac}},{'$group':{'_id':_0x21a9a7(0x161),'name':{'$first':_0x21a9a7(0x184)},'product_stock':{'$first':_0x21a9a7(0x162)},'level':{'$first':_0x21a9a7(0xe1)},'isle':{'$first':_0x21a9a7(0x11c)},'pallet':{'$first':_0x21a9a7(0x10f)},'maxProducts':{'$first':_0x21a9a7(0x104)}}}]);_0x4b738b[_0x21a9a7(0x186)](0xc8)[_0x21a9a7(0xbb)](_0x538abe);}catch(_0x13bcc9){_0x4b738b[_0x21a9a7(0x186)](0x194)['json']({'message':_0x13bcc9[_0x21a9a7(0xd7)]});}}),module['exports']=router;