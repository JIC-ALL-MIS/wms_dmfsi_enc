var a0_0x484e45=a0_0x242c;(function(_0x25db91,_0x1fe0af){var _0x5b818c=a0_0x242c,_0x1e2a2c=_0x25db91();while(!![]){try{var _0x3005a4=parseInt(_0x5b818c(0x115))/0x1*(parseInt(_0x5b818c(0x10a))/0x2)+-parseInt(_0x5b818c(0xa9))/0x3+-parseInt(_0x5b818c(0x89))/0x4*(-parseInt(_0x5b818c(0xb6))/0x5)+-parseInt(_0x5b818c(0x116))/0x6+parseInt(_0x5b818c(0x16f))/0x7*(parseInt(_0x5b818c(0xee))/0x8)+-parseInt(_0x5b818c(0x8e))/0x9+-parseInt(_0x5b818c(0x174))/0xa*(-parseInt(_0x5b818c(0x18b))/0xb);if(_0x3005a4===_0x1fe0af)break;else _0x1e2a2c['push'](_0x1e2a2c['shift']());}catch(_0x13f1c2){_0x1e2a2c['push'](_0x1e2a2c['shift']());}}}(a0_0x1e86,0xc5c2e));const express=require('express'),app=express(),router=express[a0_0x484e45(0x127)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x484e45(0x10f)),nodemailer=require('nodemailer');var ejs=require(a0_0x484e45(0x14d));const path=require(a0_0x484e45(0x128)),users=require(a0_0x484e45(0x106));router[a0_0x484e45(0x156)](a0_0x484e45(0xfc),auth,async(_0xd30535,_0x3b015d)=>{var _0xe450d9=a0_0x484e45;try{const {username:_0x108843,email:_0x282941,role:_0x33db5f}=_0xd30535['user'],_0x39b634=_0xd30535['user'],_0x5bd889=await profile[_0xe450d9(0xd4)]({'email':_0x39b634['email']}),_0x5da609=await staff[_0xe450d9(0xd4)]({'email':_0x39b634['email']});if(_0x39b634[_0xe450d9(0x159)]==_0xe450d9(0x17b)){const _0xda3a64=await staff[_0xe450d9(0xd4)]({'email':_0x39b634[_0xe450d9(0x151)]});}const _0x25701a=await master_shop[_0xe450d9(0x144)]();let _0xbe7847;if(_0x39b634[_0xe450d9(0x159)]=='staff'){const _0x159ed2=await staff['findOne']({'email':_0x39b634[_0xe450d9(0x151)]});_0xbe7847=await purchases[_0xe450d9(0xe2)]([{'$match':{'warehouse_name':_0x159ed2[_0xe450d9(0x160)]}},{'$lookup':{'from':'suppliers','localField':'suppliers','foreignField':_0xe450d9(0x157),'as':_0xe450d9(0xd7)}},{'$unwind':_0xe450d9(0xe1)},{'$unwind':_0xe450d9(0x14b)},{'$group':{'_id':_0xe450d9(0xb4),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0xe450d9(0x110)},'date':{'$first':_0xe450d9(0x7e)},'warehouse_name':{'$first':_0xe450d9(0x78)},'room':{'$first':'$room'},'product':{'$push':_0xe450d9(0x14b)},'note':{'$first':_0xe450d9(0xea)},'paid_amount':{'$first':_0xe450d9(0xde)},'due_amount':{'$first':_0xe450d9(0x97)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0xe450d9(0xe1)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0xe450d9(0xbc)},'isle':{'$addToSet':_0xe450d9(0x70)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0xe450d9(0x133)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0xbe7847=await purchases[_0xe450d9(0xe2)]([{'$lookup':{'from':_0xe450d9(0xdd),'localField':_0xe450d9(0xdd),'foreignField':_0xe450d9(0x157),'as':_0xe450d9(0xd7)}},{'$unwind':_0xe450d9(0xe1)},{'$unwind':_0xe450d9(0x14b)},{'$group':{'_id':'$_id','invoice':{'$first':_0xe450d9(0x82)},'suppliers':{'$first':_0xe450d9(0x110)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0xe450d9(0x78)},'room':{'$addToSet':_0xe450d9(0xf6)},'product':{'$push':'$product'},'note':{'$first':'$note'},'paid_amount':{'$first':_0xe450d9(0xde)},'due_amount':{'$first':_0xe450d9(0x97)},'return_data':{'$first':_0xe450d9(0xce)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0xe450d9(0x180)},'suppliers_docs':{'$first':_0xe450d9(0xe1)},'total_product_quantity':{'$sum':_0xe450d9(0x139)},'level':{'$addToSet':_0xe450d9(0xbc)},'isle':{'$addToSet':_0xe450d9(0x70)},'type':{'$addToSet':_0xe450d9(0x102)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':_0xe450d9(0x119)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x25701a[0x0][_0xe450d9(0xc5)]==_0xe450d9(0x148)){var _0x267c75=users[_0xe450d9(0xaf)];console[_0xe450d9(0x75)](_0x267c75);}else{if(_0x25701a[0x0][_0xe450d9(0xc5)]==_0xe450d9(0x134))var _0x267c75=users['Hindi'];else{if(_0x25701a[0x0][_0xe450d9(0xc5)]==_0xe450d9(0x9d))var _0x267c75=users[_0xe450d9(0x9d)];else{if(_0x25701a[0x0][_0xe450d9(0xc5)]=='Spanish')var _0x267c75=users[_0xe450d9(0x132)];else{if(_0x25701a[0x0][_0xe450d9(0xc5)]=='French')var _0x267c75=users[_0xe450d9(0xc6)];else{if(_0x25701a[0x0][_0xe450d9(0xc5)]==_0xe450d9(0x93))var _0x267c75=users[_0xe450d9(0xbe)];else{if(_0x25701a[0x0][_0xe450d9(0xc5)]==_0xe450d9(0xd2))var _0x267c75=users[_0xe450d9(0xd2)];else{if(_0x25701a[0x0][_0xe450d9(0xc5)]==_0xe450d9(0x7d))var _0x267c75=users[_0xe450d9(0xf1)];}}}}}}}_0x3b015d[_0xe450d9(0x88)](_0xe450d9(0xae),{'success':_0xd30535[_0xe450d9(0xf9)]('success'),'errors':_0xd30535[_0xe450d9(0xf9)](_0xe450d9(0x7b)),'purchases':_0xbe7847,'role':_0x39b634,'profile':_0x5bd889,'master_shop':_0x25701a,'language':_0x267c75});}catch(_0x805cc6){console[_0xe450d9(0x75)](_0xe450d9(0x108),_0x805cc6),_0x3b015d[_0xe450d9(0x126)](0xc8)['json']({'message':_0x805cc6[_0xe450d9(0xdb)]});}});function BayBinSelected(_0x4e13fb,_0x620b94){var _0x5396f9=a0_0x484e45,_0x4d8f52=[],_0xab11f1=[],_0x1b894d=[],_0x10f6e4=[],_0xbe4cf6=[],_0x2fe6f6=[];let _0x3b7434=[];if(_0x4e13fb==_0x5396f9(0x86))switch(_0x620b94){case _0x5396f9(0x18a):_0x4d8f52=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0xab11f1=[0x1,0x2],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=[_0x5396f9(0x147),_0x5396f9(0x165)],_0xbe4cf6=['D'],_0x2fe6f6=['A'];break;case _0x5396f9(0x107):_0x4d8f52=[0x6,0x5,0x4,0x3,0x2,0x1],_0xab11f1=[0x1,0x2],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=['Level',_0x5396f9(0x165)],_0xbe4cf6=['D'],_0x2fe6f6=['B'];break;case _0x5396f9(0x10e):_0x4d8f52=[0x0],_0xab11f1=[0x0],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=[_0x5396f9(0x165)],_0xbe4cf6=['D'],_0x2fe6f6=['S'];break;case _0x5396f9(0x173):_0x4d8f52=[0x0],_0xab11f1=[0x0],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1b894d=[_0x5396f9(0x165)],_0xbe4cf6=['D'],_0x2fe6f6=['R'];break;}else{if(_0x4e13fb==_0x5396f9(0xff))switch(_0x620b94){case _0x5396f9(0x18a):_0x4d8f52=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0xab11f1=['B','F'],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=[_0x5396f9(0x147),_0x5396f9(0x165)],_0xbe4cf6=['C'],_0x2fe6f6=['A'];break;case'Rack\x20B':_0x4d8f52=[0x5,0x4,0x3,0x2,0x1],_0xab11f1=['F','B','S'],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=['Level','Floor'],_0xbe4cf6=['C'],_0x2fe6f6=['B'];break;case _0x5396f9(0x8b):_0x4d8f52=[0x1,0x2,0x3,0x4,0x5],_0xab11f1=['B','F','S'],_0x10f6e4=[0x5,0x4,0x3,0x2,0x1],_0x1b894d=[_0x5396f9(0x147),_0x5396f9(0x165)],_0xbe4cf6=['C'],_0x2fe6f6=['C'];break;case'Rack\x20D':_0x4d8f52=[0x5,0x4,0x3,0x2,0x1],_0xab11f1=['F','B','S'],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=[_0x5396f9(0x147),_0x5396f9(0x165)],_0xbe4cf6=['C'],_0x2fe6f6=['D'];break;case _0x5396f9(0xbd):_0x4d8f52=[0x4,0x3,0x2,0x1],_0xab11f1=[0x1,0x2],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=[_0x5396f9(0x147),'Floor'],_0xbe4cf6=['C'],_0x2fe6f6=['E'];break;case _0x5396f9(0x146):_0x4d8f52=[0x1,0x2,0x3],_0xab11f1=[0x1,0x2],_0x10f6e4=[0x1,0x2,0x3,0x4,0x5],_0x1b894d=[_0x5396f9(0x147)],_0xbe4cf6=['C'],_0x2fe6f6=['F'];break;}}return{'levels':_0x4d8f52,'Isle':_0xab11f1,'rack':_0x10f6e4,'type':_0x1b894d,'storage':_0xbe4cf6,'rak':_0x2fe6f6};}function a0_0x242c(_0x28d24a,_0x277851){var _0x1e8626=a0_0x1e86();return a0_0x242c=function(_0x242cff,_0x1485c9){_0x242cff=_0x242cff-0x6f;var _0x2794ef=_0x1e8626[_0x242cff];return _0x2794ef;},a0_0x242c(_0x28d24a,_0x277851);}async function getRandom8DigitNumber(){var _0x46a0b3=a0_0x484e45;const _0x32ebc0=0x989680,_0x14ac1d=0x5f5e0ff,_0x16f4ab=Math[_0x46a0b3(0x113)](Math[_0x46a0b3(0xed)]()*(_0x14ac1d-_0x32ebc0+0x1))+_0x32ebc0;var _0x2a6b34;const _0x308c5a=await purchases[_0x46a0b3(0xd4)]({'invoice':'INC-'+_0x16f4ab});return _0x308c5a&&_0x308c5a[_0x46a0b3(0x169)]>0x0?_0x2a6b34='INC-'+_0x16f4ab:_0x2a6b34='INC-'+_0x16f4ab,_0x2a6b34;}router[a0_0x484e45(0x156)](a0_0x484e45(0x83),auth,async(_0x121b11,_0x53ac97)=>{var _0x3f350f=a0_0x484e45;try{const {username:_0x513a64,email:_0x501eb3,role:_0x6a51da}=_0x121b11[_0x3f350f(0x9f)],_0x3af049=_0x121b11[_0x3f350f(0x9f)],_0xdc1718=await profile[_0x3f350f(0xd4)]({'email':_0x3af049[_0x3f350f(0x151)]}),_0x101113=await master_shop[_0x3f350f(0x144)](),_0x3b04bf=await staff['findOne']({'email':_0x3af049[_0x3f350f(0x151)]}),_0x40991c=await suppliers[_0x3f350f(0x144)]({});let _0x5d4081;if(_0x3af049[_0x3f350f(0x159)]==_0x3f350f(0x17b)){const _0xdf4590=await staff[_0x3f350f(0xd4)]({'email':_0x3af049['email']});_0x5d4081=await warehouse[_0x3f350f(0xe2)]([{'$match':{'status':_0x3f350f(0xa8),'name':_0xdf4590['warehouse'],'warehouse_category':_0x3f350f(0x170),'name':{'$ne':_0x3f350f(0x11a)}}},{'$group':{'_id':_0x3f350f(0x105),'name':{'$first':_0x3f350f(0x105)}}}]);}else _0x5d4081=await warehouse[_0x3f350f(0xe2)]([{'$match':{'status':_0x3f350f(0xa8),'warehouse_category':_0x3f350f(0x170),'name':{'$ne':_0x3f350f(0x11a)}}},{'$group':{'_id':_0x3f350f(0x105),'name':{'$first':'$name'}}}]);const _0x59d560=await product[_0x3f350f(0x144)]({}),_0x3094f4=await warehouse[_0x3f350f(0x144)]({'status':_0x3f350f(0xa8)}),_0x23fdd3=await purchases['find']({}),_0x1b4771=_0x23fdd3[_0x3f350f(0x169)]+0x1,_0xfb3190=_0x3f350f(0xa3)+_0x1b4771[_0x3f350f(0xa0)]()[_0x3f350f(0x111)](0x5,'0');var _0x2ebf13=[_0x3f350f(0x95),'Enclosed'];if(_0x101113[0x0][_0x3f350f(0xc5)]==_0x3f350f(0x148))var _0xefb6f6=users[_0x3f350f(0xaf)];else{if(_0x101113[0x0][_0x3f350f(0xc5)]=='Hindi')var _0xefb6f6=users['Hindi'];else{if(_0x101113[0x0]['language']==_0x3f350f(0x9d))var _0xefb6f6=users['German'];else{if(_0x101113[0x0][_0x3f350f(0xc5)]==_0x3f350f(0x132))var _0xefb6f6=users[_0x3f350f(0x132)];else{if(_0x101113[0x0][_0x3f350f(0xc5)]=='French')var _0xefb6f6=users[_0x3f350f(0xc6)];else{if(_0x101113[0x0][_0x3f350f(0xc5)]==_0x3f350f(0x93))var _0xefb6f6=users[_0x3f350f(0xbe)];else{if(_0x101113[0x0][_0x3f350f(0xc5)]==_0x3f350f(0xd2))var _0xefb6f6=users['Chinese'];else{if(_0x101113[0x0][_0x3f350f(0xc5)]=='Arabic\x20(ae)')var _0xefb6f6=users['Arabic'];}}}}}}}const _0x1f3d85=getRandom8DigitNumber();_0x1f3d85['then'](_0x53b941=>{var _0xbecf0=_0x3f350f;_0x53ac97[_0xbecf0(0x88)](_0xbecf0(0x164),{'success':_0x121b11[_0xbecf0(0xf9)]('success'),'errors':_0x121b11[_0xbecf0(0xf9)](_0xbecf0(0x7b)),'role':_0x3af049,'profile':_0xdc1718,'suppliers':_0x40991c,'warehouse':_0x5d4081,'product':_0x59d560,'invoice':_0x53b941,'master_shop':_0x101113,'language':_0xefb6f6,'find_data':_0x3094f4,'rooms_data':_0x2ebf13});})[_0x3f350f(0x17a)](_0x278a69=>{var _0x3f3ca4=_0x3f350f;_0x121b11[_0x3f3ca4(0xf9)](_0x3f3ca4(0x7b),_0x3f3ca4(0x179)),_0x53ac97[_0x3f3ca4(0x16c)](_0x3f3ca4(0x73));});}catch(_0x38e7d1){console[_0x3f350f(0x75)](_0x38e7d1);}}),router[a0_0x484e45(0x156)]('/view/add_purchases/:id',auth,async(_0x2c024c,_0x88fc23)=>{var _0x4db2d7=a0_0x484e45;try{const _0x10da74=_0x2c024c['params']['id'];console[_0x4db2d7(0x75)](_0x10da74);const _0x23d4d3=await master_shop[_0x4db2d7(0x144)]();console[_0x4db2d7(0x75)]('master',_0x23d4d3);const _0x20c821=await product[_0x4db2d7(0xd4)]({'name':_0x10da74});console[_0x4db2d7(0x75)]('product',_0x20c821),_0x88fc23[_0x4db2d7(0x126)](0xc8)[_0x4db2d7(0x96)]({'product_data':_0x20c821,'master':_0x23d4d3});}catch(_0xda6761){console[_0x4db2d7(0x75)](_0x4db2d7(0x100),_0xda6761);}}),router[a0_0x484e45(0x161)](a0_0x484e45(0x83),auth,async(_0x3f851d,_0x5b1bd8)=>{var _0x454e3f=a0_0x484e45;try{const {invoice:_0x9aabb8,date:_0x1c109f,warehouse_name:_0x5a4034,prod_name:_0x3c762e,prod_code:_0x5b4e5a,prod_qty:_0x2aedb8,prod_unit:_0x3f00f0,prod_secondunit:_0x271ed2,prod_level:_0x46302b,prod_isle:_0x410bc5,prod_pallet:_0x11263b,note:_0x1b27a4,expiry_date:_0x5130cf,batch_code:_0x44a7e2,payable:_0x484349,due_amount:_0x4ee830,Room_name:_0x417b3c,primary_code:_0x11dfdd,secondary_code:_0x3cbb34,MaxStocks_data:_0x1c589d,PO_number:_0x389ec1,SCRN:_0x4fb20a,JO_number:_0x1352ec}=_0x3f851d[_0x454e3f(0x153)];if(typeof _0x3c762e==_0x454e3f(0x12b))var _0x31f078=[_0x3f851d['body'][_0x454e3f(0x187)]],_0x5ee920=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x7c)]],_0x2432fa=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x17f)]],_0x4e93c9=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xd6)]],_0x21f7c8=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xa5)]],_0xdfc031=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x125)]],_0x546ead=[_0x3f851d['body']['primary_code']],_0x344ab8=[_0x3f851d['body'][_0x454e3f(0xc0)]],_0x44da3d=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xb7)]],_0x6268fc=[_0x3f851d[_0x454e3f(0x153)]['batch_code']],_0x1ef611=[_0x3f851d[_0x454e3f(0x153)]['expiry_date']],_0x5196ea=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x162)]],_0x58cef8=[_0x3f851d[_0x454e3f(0x153)]['alertQTY']],_0x3b8526=[_0x3f851d[_0x454e3f(0x153)]['production_date']],_0x12bf81=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x10d)]],_0x23b357=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x103)]],_0x1e18be=[_0x3f851d['body'][_0x454e3f(0x13d)]],_0x337e02=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xe0)]],_0x164425=[_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x17d)]],_0x21e950=[_0x3f851d['body'][_0x454e3f(0x158)]];else var _0x31f078=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x187)]],_0x5ee920=[..._0x3f851d['body'][_0x454e3f(0x7c)]],_0x2432fa=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x17f)]],_0x4e93c9=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xd6)]],_0x21f7c8=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xa5)]],_0xdfc031=[..._0x3f851d[_0x454e3f(0x153)]['prod_level']],_0x546ead=[..._0x3f851d[_0x454e3f(0x153)]['primary_code']],_0x344ab8=[..._0x3f851d[_0x454e3f(0x153)]['secondary_code']],_0x44da3d=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xb7)]],_0x6268fc=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xb0)]],_0x1ef611=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x11f)]],_0x5196ea=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x162)]],_0x58cef8=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x16b)]],_0x3b8526=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x185)]],_0x12bf81=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x10d)]],_0x23b357=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x103)]],_0x1e18be=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x13d)]],_0x337e02=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xe0)]],_0x164425=[..._0x3f851d[_0x454e3f(0x153)][_0x454e3f(0x17d)]],_0x21e950=[..._0x3f851d['body'][_0x454e3f(0x158)]];const _0x58ffd6=_0x31f078['map'](_0x386554=>{return _0x386554={'product_name':_0x386554};});_0x164425[_0x454e3f(0x14e)]((_0x879db9,_0x3548a4)=>{var _0x5caf6d=_0x454e3f;_0x58ffd6[_0x3548a4][_0x5caf6d(0x17d)]=Math[_0x5caf6d(0x145)](_0x879db9);}),_0x21e950[_0x454e3f(0x14e)]((_0x30f0df,_0x1e451e)=>{var _0x1d0ee9=_0x454e3f;_0x58ffd6[_0x1e451e][_0x1d0ee9(0x158)]=_0x30f0df;}),_0x5ee920['forEach']((_0x5ebac2,_0x3b67f8)=>{var _0x586bfa=_0x454e3f;_0x58ffd6[_0x3b67f8][_0x586bfa(0x136)]=_0x5ebac2;}),_0x2432fa['forEach']((_0x3e9616,_0x1d6bb9)=>{var _0x5999f5=_0x454e3f;_0x58ffd6[_0x1d6bb9][_0x5999f5(0xfb)]=Math[_0x5999f5(0x145)](_0x3e9616);}),_0x4e93c9['forEach']((_0x3842c3,_0x18ed24)=>{_0x58ffd6[_0x18ed24]['standard_unit']=_0x3842c3;}),_0x21f7c8[_0x454e3f(0x14e)]((_0x1e7e35,_0x485bfd)=>{_0x58ffd6[_0x485bfd]['secondary_unit']=_0x1e7e35;}),_0xdfc031['forEach']((_0x2180a5,_0x39dbcc)=>{var _0x5bf95b=_0x454e3f;_0x23b357[_0x5bf95b(0x14e)]((_0x1d2123,_0x325a25)=>{var _0x37a0a7=_0x5bf95b;if(_0x1d2123==_0x37a0a7(0x173)&&_0x39dbcc==_0x325a25){console['log'](_0x1d2123+'\x20<\x20wew\x20>\x20'+_0x39dbcc+'\x20<>\x20'+_0x325a25+_0x37a0a7(0x131)+_0x2180a5);var _0x24f6f3=_0x2180a5[_0x37a0a7(0xb2)](0x3);_0x58ffd6[_0x39dbcc]['storage']=_0x2180a5[0x0],_0x58ffd6[_0x39dbcc][_0x37a0a7(0x81)]=_0x2180a5[0x1],_0x58ffd6[_0x39dbcc][_0x37a0a7(0x188)]=0x0,_0x58ffd6[_0x39dbcc][_0x37a0a7(0xf0)]=0x0,_0x58ffd6[_0x39dbcc]['type']='Floor',_0x58ffd6[_0x39dbcc][_0x37a0a7(0x9c)]=_0x24f6f3;}else{if(_0x1d2123==_0x37a0a7(0x10e)&&_0x39dbcc==_0x325a25){var _0x24f6f3=_0x2180a5[_0x37a0a7(0xb2)](0x3);_0x58ffd6[_0x39dbcc][_0x37a0a7(0x71)]=_0x2180a5[0x0],_0x58ffd6[_0x39dbcc][_0x37a0a7(0x81)]=_0x2180a5[0x1],_0x58ffd6[_0x39dbcc][_0x37a0a7(0x188)]=0x0,_0x58ffd6[_0x39dbcc]['bin']=0x0,_0x58ffd6[_0x39dbcc][_0x37a0a7(0x9a)]=_0x37a0a7(0x165),_0x58ffd6[_0x39dbcc][_0x37a0a7(0x9c)]=_0x2180a5[0x5];}else{if(_0x39dbcc==_0x325a25){if(_0x2180a5[0x0]=='A'&&_0x2180a5[0x1]=='L'&&_0x2180a5[0x2]=='L')console[_0x37a0a7(0x75)](_0x1d2123+_0x37a0a7(0x131)+_0x39dbcc+_0x37a0a7(0x131)+_0x325a25+_0x37a0a7(0x131)+_0x2180a5+'here'),_0x58ffd6[_0x39dbcc][_0x37a0a7(0x71)]=_0x2180a5[0x0],_0x58ffd6[_0x39dbcc]['rack']=_0x2180a5[0x1],_0x58ffd6[_0x39dbcc]['bay']=0x0,_0x58ffd6[_0x39dbcc][_0x37a0a7(0xf0)]=0x0,_0x58ffd6[_0x39dbcc][_0x37a0a7(0x9a)]=_0x37a0a7(0x165),_0x58ffd6[_0x39dbcc][_0x37a0a7(0x9c)]=_0x2180a5[0x3];else{var _0x2a3531;if(_0x2180a5[0x4]=='L')_0x2a3531=_0x37a0a7(0x147);else _0x2180a5[0x4]=='F'&&(_0x2a3531=_0x37a0a7(0x165));_0x58ffd6[_0x39dbcc][_0x37a0a7(0x71)]=_0x2180a5[0x0],_0x58ffd6[_0x39dbcc][_0x37a0a7(0x81)]=_0x2180a5[0x1],_0x58ffd6[_0x39dbcc][_0x37a0a7(0x188)]=_0x2180a5[0x2],_0x58ffd6[_0x39dbcc][_0x37a0a7(0xf0)]=_0x2180a5[0x3],_0x58ffd6[_0x39dbcc]['type']=_0x2a3531,_0x58ffd6[_0x39dbcc][_0x37a0a7(0x9c)]=_0x2180a5[0x5];}}}}});}),_0x546ead[_0x454e3f(0x14e)]((_0x56b329,_0x2bda4d)=>{_0x58ffd6[_0x2bda4d]['primary_code']=_0x56b329;}),_0x344ab8[_0x454e3f(0x14e)]((_0x53a1c3,_0x48f189)=>{var _0x501b88=_0x454e3f;_0x58ffd6[_0x48f189][_0x501b88(0xc0)]=_0x53a1c3;}),_0x44da3d['forEach']((_0x24e6ba,_0x59f6cc)=>{var _0x1b3e94=_0x454e3f;_0x58ffd6[_0x59f6cc][_0x1b3e94(0x114)]=_0x24e6ba;}),_0x6268fc[_0x454e3f(0x14e)]((_0x33a70b,_0x3b2af2)=>{var _0x33be1d=_0x454e3f;_0x58ffd6[_0x3b2af2][_0x33be1d(0xb0)]=_0x33a70b;}),_0x1ef611[_0x454e3f(0x14e)]((_0x1f62a6,_0x5550fd)=>{var _0x37dba6=_0x454e3f;_0x58ffd6[_0x5550fd][_0x37dba6(0x11f)]=_0x1f62a6;}),_0x5196ea[_0x454e3f(0x14e)]((_0x521704,_0x18e5bf)=>{var _0x9c4b34=_0x454e3f;_0x58ffd6[_0x18e5bf][_0x9c4b34(0x94)]=_0x521704;}),_0x58cef8[_0x454e3f(0x14e)]((_0x2376cc,_0x3eec2c)=>{_0x58ffd6[_0x3eec2c]['alertQTY']=_0x2376cc;}),_0x3b8526[_0x454e3f(0x14e)]((_0x428a6e,_0x417558)=>{var _0x45a883=_0x454e3f;_0x58ffd6[_0x417558][_0x45a883(0x185)]=_0x428a6e;}),_0x12bf81[_0x454e3f(0x14e)]((_0x39910d,_0x3d7940)=>{var _0x2b8378=_0x454e3f;_0x58ffd6[_0x3d7940][_0x2b8378(0x77)]=_0x39910d;}),_0x23b357[_0x454e3f(0x14e)]((_0x2b1948,_0x35fe56)=>{var _0x2dff10=_0x454e3f;_0x58ffd6[_0x35fe56][_0x2dff10(0xe4)]=_0x2b1948;}),_0x1e18be[_0x454e3f(0x14e)]((_0x5f5c92,_0x343bad)=>{var _0x5b2324=_0x454e3f;_0x58ffd6[_0x343bad][_0x5b2324(0xe9)]=_0x5f5c92;}),_0x337e02[_0x454e3f(0x14e)]((_0x55c670,_0xbc1d1c)=>{var _0xc15b97=_0x454e3f;_0x58ffd6[_0xbc1d1c][_0xc15b97(0xdf)]=_0x55c670;});const _0x14545c=_0x23b357['map'](_0x3bac10=>{return _0x3bac10={'room_name':_0x3bac10};}),_0x174838=_0x58ffd6[_0x454e3f(0x7a)](_0x5319f1=>_0x5319f1[_0x454e3f(0xfb)]!=='0'&&_0x5319f1[_0x454e3f(0xfb)]!==''),_0x4e6f3c=new purchases({'invoice':_0x9aabb8,'suppliers':_0x3f851d[_0x454e3f(0x153)][_0x454e3f(0xdd)],'date':_0x1c109f,'warehouse_name':_0x5a4034,'product':_0x174838,'note':_0x1b27a4,'due_amount':_0x4ee830,'POnumber':_0x389ec1,'SCRN':_0x4fb20a,'JO_number':_0x1352ec,'roomList':_0x14545c}),_0x3833d1=await _0x4e6f3c[_0x454e3f(0x168)](),_0x2b241f=await purchases[_0x454e3f(0xd4)]({'invoice':_0x9aabb8}),_0x497b59=_0x2b241f[_0x454e3f(0x99)][_0x454e3f(0x149)](async _0x5660db=>{var _0x193d29=_0x454e3f,_0x292158=await warehouse[_0x193d29(0xd4)]({'name':_0x5a4034,'room':_0x5660db[_0x193d29(0xe4)]}),_0x71c90=0x0;return _0x292158[_0x193d29(0x98)][_0x193d29(0x14e)](_0x489521=>{var _0x3c2406=_0x193d29;_0x489521[_0x3c2406(0x142)]==_0x5660db[_0x3c2406(0x142)]&&_0x489521['floorlevel']==_0x5660db['floorlevel']&&_0x489521[_0x3c2406(0x9a)]==_0x5660db[_0x3c2406(0x9a)]&&_0x489521[_0x3c2406(0xf0)]==_0x5660db[_0x3c2406(0xf0)]&&_0x489521[_0x3c2406(0x188)]==_0x5660db['bay']&&_0x489521['rack']==_0x5660db[_0x3c2406(0x81)]&&_0x489521[_0x3c2406(0x71)]==_0x5660db['storage']&&_0x489521[_0x3c2406(0x11f)]==_0x5660db[_0x3c2406(0x11f)]&&_0x489521[_0x3c2406(0xb0)]==_0x5660db[_0x3c2406(0xb0)]&&_0x489521[_0x3c2406(0x185)]==_0x5660db[_0x3c2406(0x185)]&&_0x489521[_0x3c2406(0xdf)]==_0x2b241f[_0x3c2406(0xdf)]&&(_0x489521[_0x3c2406(0xc1)]+=Math['abs'](_0x5660db[_0x3c2406(0xfb)]),_0x71c90++);}),_0x71c90===0x0&&_0x292158['product_details'][_0x193d29(0xaa)]({'product_name':_0x5660db['product_name'],'product_stock':Math[_0x193d29(0x145)](_0x5660db['quantity']),'primary_code':_0x5660db[_0x193d29(0x104)],'secondary_code':_0x5660db['secondary_code'],'product_code':_0x5660db['product_code'],'storage':_0x5660db['storage'],'rack':_0x5660db[_0x193d29(0x81)],'bay':_0x5660db[_0x193d29(0x188)],'bin':_0x5660db[_0x193d29(0xf0)],'type':_0x5660db['type'],'floorlevel':_0x5660db[_0x193d29(0x9c)],'maxProducts':_0x5660db[_0x193d29(0x114)],'unit':_0x5660db[_0x193d29(0x118)],'secondary_unit':_0x5660db[_0x193d29(0xd9)],'expiry_date':_0x5660db['expiry_date'],'maxPerUnit':_0x5660db[_0x193d29(0x94)],'batch_code':_0x5660db[_0x193d29(0xb0)],'alertQTY':_0x5660db[_0x193d29(0x16b)],'production_date':_0x5660db[_0x193d29(0x185)],'product_cat':_0x5660db['product_cat'],'invoice':_0x5660db[_0x193d29(0xdf)],'actual_qty':Math['abs'](_0x5660db[_0x193d29(0x17d)]),'actual_uom':_0x5660db['actual_uom']}),_0x292158;});Promise[_0x454e3f(0x181)](_0x497b59)[_0x454e3f(0x11e)](async _0x23f509=>{var _0x2de8c9=_0x454e3f;try{for(const _0x389e92 of _0x23f509){await _0x389e92[_0x2de8c9(0x168)]();}const _0xb5280d=await master_shop[_0x2de8c9(0x144)](),_0x1d9a28=await email_settings[_0x2de8c9(0xd4)](),_0x1503cb=await supervisor_settings['find']();var _0x1a2643=_0x2b241f['product'],_0x20ab25='',_0x415ba0;for(_0x415ba0 in _0x1a2643){_0x20ab25+='<tr>'+_0x2de8c9(0xbb)+_0x1a2643[_0x415ba0][_0x2de8c9(0x142)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a2643[_0x415ba0][_0x2de8c9(0x136)]+'</td>'+_0x2de8c9(0xbb)+_0x1a2643[_0x415ba0][_0x2de8c9(0xfb)]+_0x2de8c9(0xe6)+_0x2de8c9(0xbb)+_0x1a2643[_0x415ba0]['standard_unit']+_0x2de8c9(0xe6)+_0x2de8c9(0xbb)+_0x1a2643[_0x415ba0]['secondary_unit']+_0x2de8c9(0xe6)+_0x2de8c9(0xbb)+_0x2b241f[_0x2de8c9(0x15c)]+_0x2de8c9(0xe6)+_0x2de8c9(0xbb)+_0x1a2643[_0x415ba0][_0x2de8c9(0xe4)]+_0x2de8c9(0xe6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a2643[_0x415ba0][_0x2de8c9(0x71)]+_0x1a2643[_0x415ba0][_0x2de8c9(0x81)]+_0x1a2643[_0x415ba0][_0x2de8c9(0x188)]+_0x1a2643[_0x415ba0][_0x2de8c9(0xf0)]+_0x1a2643[_0x415ba0][_0x2de8c9(0x9a)][0x0]+_0x1a2643[_0x415ba0]['floorlevel']+_0x2de8c9(0xe6),_0x2de8c9(0x6f);}let _0x21fd5d=nodemailer[_0x2de8c9(0xcb)]({'host':_0x1d9a28['host'],'port':Number(_0x1d9a28[_0x2de8c9(0x184)]),'secure':![],'auth':{'user':_0x1d9a28[_0x2de8c9(0x151)],'pass':_0x1d9a28[_0x2de8c9(0xfe)]}}),_0x11b276={'from':_0x1d9a28['email'],'to':_0x1503cb[0x0]['RMSEmail'],'subject':'Purchase\x20Mail','attachments':[{'filename':_0x2de8c9(0xb8),'path':__dirname+_0x2de8c9(0xad)+_0x2de8c9(0xd0)+_0xb5280d[0x0][_0x2de8c9(0x13c)],'cid':_0x2de8c9(0x10b)}],'html':_0x2de8c9(0xb3)+'<html><head><title></title>'+_0x2de8c9(0x8f)+_0x2de8c9(0x130)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2de8c9(0x130)+_0x2de8c9(0x182)+_0x2de8c9(0xd8)+_0x2de8c9(0x130)+'<h2>\x20'+_0xb5280d[0x0][_0x2de8c9(0xc7)]+'\x20</h2>'+'</div>'+_0x2de8c9(0xd8)+_0x2de8c9(0xcf)+_0x2de8c9(0x130)+_0x2de8c9(0x154)+_0x2de8c9(0x8a)+_0x2b241f[_0x2de8c9(0xdf)]+'\x20'+_0x2de8c9(0x120)+_0x2de8c9(0x10c)+_0x2b241f[_0x2de8c9(0xdc)]+'\x20'+'</span>'+'</h5>'+'</div>'+_0x2de8c9(0x85)+_0x2de8c9(0x90)+_0x2de8c9(0xd5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x2de8c9(0x143)+_0x2de8c9(0x178)+_0x2de8c9(0xa4)+_0x2de8c9(0xc2)+_0x2de8c9(0xeb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2de8c9(0x6f)+_0x2de8c9(0x76)+_0x2de8c9(0x13b)+'\x20'+_0x20ab25+'\x20'+_0x2de8c9(0xf5)+_0x2de8c9(0x129)+_0x2de8c9(0x130)+_0x2de8c9(0x7f)+_0x2de8c9(0x17c)+_0xb5280d[0x0][_0x2de8c9(0xc7)]+_0x2de8c9(0xc9)+'</div>'+_0x2de8c9(0xd8)+_0x2de8c9(0x109)};_0x21fd5d[_0x2de8c9(0x8d)](_0x11b276,function(_0x3f102a,_0x1c4237){var _0x567f6c=_0x2de8c9;_0x3f102a?(console['log'](_0x3f102a),console[_0x567f6c(0x75)](_0x567f6c(0xf8))):console[_0x567f6c(0x75)](_0x567f6c(0xd3));}),_0x3f851d[_0x2de8c9(0xf9)](_0x2de8c9(0xda),_0x2de8c9(0xf2)),_0x5b1bd8['redirect'](_0x2de8c9(0x141));}catch(_0x5cd3d5){console[_0x2de8c9(0x155)](_0x5cd3d5),_0x5b1bd8[_0x2de8c9(0x126)](0x1f4)[_0x2de8c9(0x96)]({'error':_0x2de8c9(0x117)});}})[_0x454e3f(0x17a)](_0x1236cb=>{var _0x2a572d=_0x454e3f;console[_0x2a572d(0x155)](_0x1236cb),_0x5b1bd8[_0x2a572d(0x126)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x1ae8ec){console[_0x454e3f(0x75)](_0x1ae8ec);}}),router[a0_0x484e45(0x156)](a0_0x484e45(0x80),auth,async(_0x3cbabd,_0x1114c2)=>{var _0x544967=a0_0x484e45;try{const {username:_0x335887,email:_0x578334,role:_0x523580}=_0x3cbabd[_0x544967(0x9f)],_0x4a08dc=_0x3cbabd[_0x544967(0x9f)],_0x411148=await profile['findOne']({'email':_0x4a08dc[_0x544967(0x151)]}),_0x36960b=await master_shop['find'](),_0x3e7e38=_0x3cbabd[_0x544967(0xc8)]['id'],_0x1bc585=await purchases['findById'](_0x3e7e38),_0x5f2eef=await warehouse['aggregate']([{'$match':{'name':_0x1bc585[_0x544967(0x15c)],'room':_0x1bc585['room']}},{'$unwind':_0x544967(0x175)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x544967(0x14a)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x544967(0xba)},'type':{'$first':_0x544967(0x163)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x544967(0x152)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x544967(0x13a)},'storage':{'$first':_0x544967(0xbf)},'rack':{'$first':_0x544967(0x186)},'expiry_date':{'$first':_0x544967(0xe5)}}}]),_0xe47ac8=await customer[_0x544967(0x144)]({});let _0xce66ac;if(_0x4a08dc[_0x544967(0x159)]==_0x544967(0x17b)){const _0x1402df=await staff[_0x544967(0xd4)]({'email':_0x4a08dc[_0x544967(0x151)]});_0xce66ac=await warehouse[_0x544967(0xe2)]([{'$match':{'status':_0x544967(0xa8),'name':_0x1402df[_0x544967(0x160)]}},{'$group':{'_id':_0x544967(0x105),'name':{'$first':_0x544967(0x105)}}}]);}else _0xce66ac=await warehouse[_0x544967(0xe2)]([{'$match':{'status':_0x544967(0xa8)}},{'$group':{'_id':_0x544967(0x105),'name':{'$first':'$name'}}}]);const _0x3d4a3d=await product[_0x544967(0x144)]({}),_0x540525=await suppliers[_0x544967(0x144)]({}),_0x4015f1=BayBinSelected(_0x1bc585[_0x544967(0x15c)],_0x1bc585[_0x544967(0xc4)]);if(_0x36960b[0x0][_0x544967(0xc5)]==_0x544967(0x148)){var _0x24fb8d=users[_0x544967(0xaf)];console['log'](_0x24fb8d);}else{if(_0x36960b[0x0]['language']==_0x544967(0x134))var _0x24fb8d=users['Hindi'];else{if(_0x36960b[0x0][_0x544967(0xc5)]==_0x544967(0x9d))var _0x24fb8d=users[_0x544967(0x9d)];else{if(_0x36960b[0x0][_0x544967(0xc5)]==_0x544967(0x132))var _0x24fb8d=users[_0x544967(0x132)];else{if(_0x36960b[0x0][_0x544967(0xc5)]==_0x544967(0xc6))var _0x24fb8d=users[_0x544967(0xc6)];else{if(_0x36960b[0x0]['language']==_0x544967(0x93))var _0x24fb8d=users['Portuguese'];else{if(_0x36960b[0x0][_0x544967(0xc5)]==_0x544967(0xd2))var _0x24fb8d=users[_0x544967(0xd2)];else{if(_0x36960b[0x0][_0x544967(0xc5)]=='Arabic\x20(ae)')var _0x24fb8d=users[_0x544967(0xf1)];}}}}}}}_0x1114c2['render'](_0x544967(0x87),{'success':_0x3cbabd['flash']('success'),'errors':_0x3cbabd[_0x544967(0xf9)](_0x544967(0x7b)),'role':_0x4a08dc,'profile':_0x411148,'customer':_0xe47ac8,'warehouse':_0xce66ac,'product':_0x5f2eef,'user':_0x1bc585,'master_shop':_0x36960b,'unit':_0x3d4a3d,'language':_0x24fb8d,'suppliers':_0x540525,'dataSelected':_0x4015f1});}catch(_0x3d82e2){console[_0x544967(0x75)](_0x3d82e2);}}),router[a0_0x484e45(0x161)](a0_0x484e45(0x80),auth,async(_0x11f6d3,_0x369743)=>{var _0x909074=a0_0x484e45;try{const _0x11ae81=_0x11f6d3['params']['id'],{invoice:_0x1cfca6,warehouse_name:_0x58f21f,Room_name:_0x44ee3e}=_0x11f6d3['body'],_0x39746f=await warehouse[_0x909074(0xd4)]({'name':_0x58f21f,'room':_0x44ee3e}),_0x599acb=await purchases[_0x909074(0xd4)]({'invoice':_0x1cfca6});_0x599acb[_0x909074(0x99)][_0x909074(0x14e)](_0x4b00b2=>{var _0x242cc0=_0x909074,_0x291123=0x0;const _0x7c5a6d=_0x39746f[_0x242cc0(0x98)][_0x242cc0(0x149)](_0x19d12f=>{var _0x332722=_0x242cc0;_0x19d12f['product_name']==_0x4b00b2[_0x332722(0x142)]&&_0x19d12f[_0x332722(0x9c)]==_0x4b00b2[_0x332722(0x9c)]&&_0x19d12f[_0x332722(0x9a)]==_0x4b00b2[_0x332722(0x9a)]&&_0x19d12f['bin']==_0x4b00b2['bin']&&_0x19d12f[_0x332722(0x188)]==_0x4b00b2[_0x332722(0x188)]&&_0x19d12f[_0x332722(0x81)]==_0x4b00b2[_0x332722(0x81)]&&_0x19d12f[_0x332722(0x71)]==_0x4b00b2[_0x332722(0x71)]&&_0x19d12f[_0x332722(0x11f)]==_0x4b00b2['expiry_date']&&_0x19d12f[_0x332722(0xb0)]==_0x4b00b2[_0x332722(0xb0)]&&_0x19d12f[_0x332722(0x185)]==_0x4b00b2['production_date']&&_0x19d12f['delivery_date']==_0x4b00b2['delivery_date']&&_0x19d12f[_0x332722(0xe9)]==_0x4b00b2[_0x332722(0xe9)]&&(_0x19d12f[_0x332722(0xc1)]=parseInt(_0x19d12f['product_stock'])+parseInt(_0x4b00b2[_0x332722(0xfb)]),_0x291123++);});_0x291123=='0'&&(_0x39746f['product_details']=_0x39746f[_0x242cc0(0x98)]['concat']({'product_name':_0x4b00b2['product_name'],'product_stock':_0x4b00b2[_0x242cc0(0xfb)],'primary_code':_0x4b00b2[_0x242cc0(0x104)],'secondary_code':_0x4b00b2['secondary_code'],'product_code':_0x4b00b2['product_code'],'storage':_0x4b00b2[_0x242cc0(0x71)],'rack':_0x4b00b2[_0x242cc0(0x81)],'bay':_0x4b00b2[_0x242cc0(0x188)],'bin':_0x4b00b2[_0x242cc0(0xf0)],'type':_0x4b00b2[_0x242cc0(0x9a)],'floorlevel':_0x4b00b2[_0x242cc0(0x9c)],'maxProducts':_0x4b00b2['maxStocks'],'unit':_0x4b00b2['standard_unit'],'secondary_unit':_0x4b00b2['secondary_unit'],'expiry_date':_0x4b00b2[_0x242cc0(0x11f)],'maxPerUnit':_0x4b00b2[_0x242cc0(0x94)],'batch_code':_0x4b00b2['batch_code'],'alertQTY':_0x4b00b2['alertQTY'],'production_date':_0x4b00b2[_0x242cc0(0x185)],'delivery_date':_0x4b00b2['delivery_date'],'delivery_code':_0x4b00b2['delivery_code']}));}),await _0x39746f[_0x909074(0x168)](),_0x599acb[_0x909074(0xcd)]=_0x909074(0x84);const _0x8e18b1=await _0x599acb[_0x909074(0x168)]();_0x11f6d3[_0x909074(0xf9)]('success',_0x909074(0x9b)),_0x369743['redirect']('/all_purchases/view');}catch(_0x1e25f1){console['log'](_0x1e25f1);}}),router[a0_0x484e45(0x156)](a0_0x484e45(0xa1),auth,async(_0x153aca,_0x4eaf45)=>{var _0x1405bc=a0_0x484e45;try{const {username:_0x246997,email:_0x4de00e,role:_0x52ded8}=_0x153aca['user'],_0x3cf6b5=_0x153aca[_0x1405bc(0x9f)],_0x51e37d=await profile[_0x1405bc(0xd4)]({'email':_0x3cf6b5[_0x1405bc(0x151)]}),_0x1f9492=await master_shop[_0x1405bc(0x144)](),_0x5bbf52=_0x153aca['params']['id'],_0x4fab97=await purchases['findById'](_0x5bbf52),_0x2b1c60=await suppliers[_0x1405bc(0x144)]({});let _0x5afd61;if(_0x3cf6b5[_0x1405bc(0x159)]==_0x1405bc(0x17b)){const _0x4058ff=await staff[_0x1405bc(0xd4)]({'email':_0x3cf6b5['email']});_0x5afd61=await warehouse[_0x1405bc(0x144)]({'status':_0x1405bc(0xa8),'name':_0x4058ff[_0x1405bc(0x160)],'warehouse_category':_0x1405bc(0x170)});}else _0x5afd61=await warehouse[_0x1405bc(0xe2)]([{'$match':{'status':'Enabled','warehouse_category':_0x1405bc(0x170)}},{'$group':{'_id':_0x1405bc(0x105),'name':{'$first':_0x1405bc(0x105)}}}]);const _0x461f7e=await product[_0x1405bc(0x144)]({}),_0x9551ca=BayBinSelected(_0x4fab97[_0x1405bc(0x15c)],_0x4fab97[_0x1405bc(0xc4)]);let _0x16a21d=new Date(_0x4fab97['expiry_date']),_0x3ba38c=('0'+_0x16a21d['getDate']())[_0x1405bc(0xb2)](-0x2),_0x1ec11b=('0'+(_0x16a21d[_0x1405bc(0xf3)]()+0x1))[_0x1405bc(0xb2)](-0x2),_0xde9b1f=_0x16a21d[_0x1405bc(0x124)](),_0x5d2852=_0xde9b1f+'-'+_0x1ec11b+'-'+_0x3ba38c;if(_0x1f9492[0x0][_0x1405bc(0xc5)]==_0x1405bc(0x148)){var _0xb99dcb=users[_0x1405bc(0xaf)];console['log'](_0xb99dcb);}else{if(_0x1f9492[0x0]['language']=='Hindi')var _0xb99dcb=users[_0x1405bc(0x134)];else{if(_0x1f9492[0x0][_0x1405bc(0xc5)]==_0x1405bc(0x9d))var _0xb99dcb=users[_0x1405bc(0x9d)];else{if(_0x1f9492[0x0]['language']==_0x1405bc(0x132))var _0xb99dcb=users[_0x1405bc(0x132)];else{if(_0x1f9492[0x0][_0x1405bc(0xc5)]==_0x1405bc(0xc6))var _0xb99dcb=users[_0x1405bc(0xc6)];else{if(_0x1f9492[0x0][_0x1405bc(0xc5)]==_0x1405bc(0x93))var _0xb99dcb=users['Portuguese'];else{if(_0x1f9492[0x0]['language']=='Chinese')var _0xb99dcb=users[_0x1405bc(0xd2)];else{if(_0x1f9492[0x0][_0x1405bc(0xc5)]==_0x1405bc(0x7d))var _0xb99dcb=users[_0x1405bc(0xf1)];}}}}}}}_0x4eaf45[_0x1405bc(0x88)](_0x1405bc(0x13f),{'success':_0x153aca['flash'](_0x1405bc(0xda)),'errors':_0x153aca[_0x1405bc(0xf9)]('errors'),'role':_0x3cf6b5,'profile':_0x51e37d,'purchases':_0x4fab97,'suppliers':_0x2b1c60,'warehouse':_0x5afd61,'product':_0x461f7e,'master_shop':_0x1f9492,'language':_0xb99dcb,'ed_fullDate':_0x5d2852,'dataSelected':_0x9551ca});}catch(_0x54053b){console[_0x1405bc(0x75)](_0x54053b);}}),router['post'](a0_0x484e45(0xa1),auth,async(_0x57b9a0,_0x163608)=>{var _0x164eba=a0_0x484e45;try{const _0x9c26e5=_0x57b9a0[_0x164eba(0xc8)]['id'],_0x5d9ac5=await purchases[_0x164eba(0xd4)]({'_id':_0x57b9a0[_0x164eba(0xc8)]['id']}),_0x89a414=await warehouse['findOne']({'name':_0x5d9ac5[_0x164eba(0x15c)],'room':_0x5d9ac5[_0x164eba(0xc4)]});_0x5d9ac5[_0x164eba(0x99)][_0x164eba(0x14e)](_0x3fbfc2=>{var _0xee2621=_0x164eba;const _0x8d3fe=_0x89a414[_0xee2621(0x98)][_0xee2621(0x149)](_0x1ce9f4=>{var _0x34eedd=_0xee2621;_0x1ce9f4[_0x34eedd(0x142)]==_0x3fbfc2[_0x34eedd(0x142)]&&_0x1ce9f4[_0x34eedd(0x9c)]==_0x3fbfc2['floorlevel']&&_0x1ce9f4['type']==_0x3fbfc2[_0x34eedd(0x9a)]&&_0x1ce9f4[_0x34eedd(0xf0)]==_0x3fbfc2[_0x34eedd(0xf0)]&&_0x1ce9f4[_0x34eedd(0x188)]==_0x3fbfc2[_0x34eedd(0x188)]&&_0x1ce9f4[_0x34eedd(0x81)]==_0x3fbfc2[_0x34eedd(0x81)]&&_0x1ce9f4[_0x34eedd(0x71)]==_0x3fbfc2[_0x34eedd(0x71)]&&(_0x1ce9f4[_0x34eedd(0xc1)]=parseInt(_0x1ce9f4[_0x34eedd(0xc1)])-parseInt(_0x3fbfc2[_0x34eedd(0xfb)]));});}),await _0x89a414[_0x164eba(0x168)]();const {invoice:_0x1585b1,suppliers:_0x149873,date:_0x5eac1c,warehouse_name:_0x377cbd,prod_name:_0x2150f8,prod_code:_0x1d84bd,prod_qty:_0x22fc0c,prod_unit:_0x59b5e4,prod_secondunit:_0x5afce1,prod_level:_0x5d3a2f,prod_isle:_0x3dc7d2,prod_pallet:_0x40f468,note:_0x55f14a,expiry_date:_0x4f0a86,batch_code:_0x2eb7bb,paid_amount:_0x3a5a9e,due_amount:_0x54c1ec,Room_name:_0x1e0cec,primary_code:_0x2818d5,secondary_code:_0x35c3a9,PO_number:_0x1999bc,JO_number:_0x133f57}=_0x57b9a0[_0x164eba(0x153)];if(typeof _0x2150f8==_0x164eba(0x12b))var _0x5b60a0=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0x187)]],_0x3564d5=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0x7c)]],_0x40d52b=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0xab)]],_0x17d8e0=[_0x57b9a0[_0x164eba(0x153)]['prod_unit']],_0x21f861=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0xa5)]],_0x3b969c=[_0x57b9a0[_0x164eba(0x153)]['prod_level']],_0x420b7e=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0x91)]],_0x57a87a=[_0x57b9a0[_0x164eba(0x153)]['prod_pallet']],_0x46e990=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0x104)]],_0x3adbda=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0xc0)]],_0x14e1f7=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0xb7)]],_0x26433b=[_0x57b9a0['body'][_0x164eba(0xb0)]],_0xae6062=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0x11f)]],_0x2438b9=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0x71)]],_0x3808b6=[_0x57b9a0['body']['rak']],_0x1cffc7=[_0x57b9a0[_0x164eba(0x153)][_0x164eba(0x9a)]];else var _0x5b60a0=[..._0x57b9a0[_0x164eba(0x153)]['prod_name']],_0x3564d5=[..._0x57b9a0[_0x164eba(0x153)][_0x164eba(0x7c)]],_0x40d52b=[..._0x57b9a0[_0x164eba(0x153)]['prod_qty']],_0x17d8e0=[..._0x57b9a0[_0x164eba(0x153)][_0x164eba(0xca)]],_0x21f861=[..._0x57b9a0['body'][_0x164eba(0xa5)]],_0x3b969c=[..._0x57b9a0['body'][_0x164eba(0x125)]],_0x420b7e=[..._0x57b9a0[_0x164eba(0x153)]['prod_isle']],_0x57a87a=[..._0x57b9a0[_0x164eba(0x153)][_0x164eba(0x15a)]],_0x46e990=[..._0x57b9a0['body'][_0x164eba(0x104)]],_0x3adbda=[..._0x57b9a0[_0x164eba(0x153)]['secondary_code']],_0x14e1f7=[..._0x57b9a0[_0x164eba(0x153)][_0x164eba(0xb7)]],_0x26433b=[..._0x57b9a0[_0x164eba(0x153)][_0x164eba(0xb0)]],_0xae6062=[..._0x57b9a0[_0x164eba(0x153)][_0x164eba(0x11f)]],_0x2438b9=[..._0x57b9a0[_0x164eba(0x153)][_0x164eba(0x71)]],_0x3808b6=[..._0x57b9a0['body'][_0x164eba(0xa6)]],_0x1cffc7=[..._0x57b9a0['body']['type']];const _0x5bd6b6=_0x5b60a0[_0x164eba(0x149)](_0x11768d=>{return _0x11768d={'product_name':_0x11768d};});_0x3564d5[_0x164eba(0x14e)]((_0x30ec0b,_0x3be800)=>{var _0x2cbb12=_0x164eba;_0x5bd6b6[_0x3be800][_0x2cbb12(0x136)]=_0x30ec0b;}),_0x40d52b[_0x164eba(0x14e)]((_0x3b1c27,_0x14d16a)=>{var _0x5beba9=_0x164eba;_0x5bd6b6[_0x14d16a][_0x5beba9(0xfb)]=_0x3b1c27;}),_0x17d8e0['forEach']((_0x590164,_0x1cac62)=>{var _0x1d9e2c=_0x164eba;_0x5bd6b6[_0x1cac62][_0x1d9e2c(0x118)]=_0x590164;}),_0x21f861[_0x164eba(0x14e)]((_0x1c6f75,_0x51690b)=>{_0x5bd6b6[_0x51690b]['secondary_unit']=_0x1c6f75;}),_0x3b969c[_0x164eba(0x14e)]((_0x16bb37,_0x429e85)=>{var _0x27cc66=_0x164eba;_0x5bd6b6[_0x429e85][_0x27cc66(0x188)]=_0x16bb37;}),_0x420b7e['forEach']((_0x7eb9bb,_0x43275f)=>{var _0x2568cd=_0x164eba;_0x5bd6b6[_0x43275f][_0x2568cd(0xf0)]=_0x7eb9bb;}),_0x57a87a[_0x164eba(0x14e)]((_0x180c4e,_0x2bf286)=>{var _0x3fe477=_0x164eba;_0x5bd6b6[_0x2bf286][_0x3fe477(0x9c)]=_0x180c4e;}),_0x46e990['forEach']((_0x38f79e,_0x676a4)=>{var _0x4a616c=_0x164eba;_0x5bd6b6[_0x676a4][_0x4a616c(0x104)]=_0x38f79e;}),_0x3adbda[_0x164eba(0x14e)]((_0x4af62a,_0x2e2bbd)=>{var _0x34297b=_0x164eba;_0x5bd6b6[_0x2e2bbd][_0x34297b(0xc0)]=_0x4af62a;}),_0x14e1f7[_0x164eba(0x14e)]((_0x198951,_0x4622dc)=>{var _0x22cede=_0x164eba;_0x5bd6b6[_0x4622dc][_0x22cede(0x114)]=_0x198951;}),_0x26433b[_0x164eba(0x14e)]((_0x294f8b,_0x4e1e5b)=>{var _0x3dd220=_0x164eba;_0x5bd6b6[_0x4e1e5b][_0x3dd220(0xb0)]=_0x294f8b;}),_0xae6062['forEach']((_0x57710f,_0x29ca38)=>{var _0x19d3ce=_0x164eba;_0x5bd6b6[_0x29ca38][_0x19d3ce(0x11f)]=_0x57710f;}),_0x1cffc7[_0x164eba(0x14e)]((_0x20d1d4,_0x4c5f48)=>{var _0x50be24=_0x164eba;_0x5bd6b6[_0x4c5f48][_0x50be24(0x9a)]=_0x20d1d4;}),_0x2438b9[_0x164eba(0x14e)]((_0x3be8a7,_0x3e9c6f)=>{var _0x39356b=_0x164eba;_0x5bd6b6[_0x3e9c6f][_0x39356b(0x71)]=_0x3be8a7;}),_0x3808b6[_0x164eba(0x14e)]((_0x36ba65,_0x3d4b5f)=>{var _0x5fda9c=_0x164eba;_0x5bd6b6[_0x3d4b5f][_0x5fda9c(0x81)]=_0x36ba65;});const _0x3d87bf=_0x5bd6b6[_0x164eba(0x7a)](_0x40d808=>_0x40d808[_0x164eba(0xfb)]!=='0'&&_0x40d808[_0x164eba(0xfb)]!=='');_0x5d9ac5[_0x164eba(0xdf)]=_0x1585b1,_0x5d9ac5['suppliers']=_0x149873,_0x5d9ac5['date']=_0x5eac1c,_0x5d9ac5['warehouse_name']=_0x377cbd,_0x5d9ac5[_0x164eba(0x99)]=_0x3d87bf,_0x5d9ac5[_0x164eba(0xb5)]=_0x55f14a,_0x5d9ac5[_0x164eba(0x12d)]=_0x3a5a9e,_0x5d9ac5[_0x164eba(0x79)]=_0x54c1ec,_0x5d9ac5[_0x164eba(0xc4)]=_0x1e0cec,_0x5d9ac5[_0x164eba(0x8c)]=_0x1999bc,_0x5d9ac5[_0x164eba(0x135)]=_0x133f57;const _0x2df302=await _0x5d9ac5[_0x164eba(0x168)](),_0x523637=await warehouse['findOne']({'name':_0x57b9a0['body'][_0x164eba(0x15c)],'room':_0x57b9a0[_0x164eba(0x153)]['Room_name']});_0x5d9ac5[_0x164eba(0x99)]['forEach'](_0x18f8b1=>{var _0x501761=_0x164eba,_0x2df488=0x0;const _0x340e58=_0x523637['product_details'][_0x501761(0x149)](_0x26e1ee=>{var _0x58a6aa=_0x501761;_0x26e1ee[_0x58a6aa(0x142)]==_0x18f8b1[_0x58a6aa(0x142)]&&_0x26e1ee[_0x58a6aa(0x9c)]==_0x18f8b1['floorlevel']&&_0x26e1ee[_0x58a6aa(0x9a)]==_0x18f8b1['type']&&_0x26e1ee[_0x58a6aa(0xf0)]==_0x18f8b1[_0x58a6aa(0xf0)]&&_0x26e1ee[_0x58a6aa(0x188)]==_0x18f8b1['bay']&&_0x26e1ee[_0x58a6aa(0x81)]==_0x18f8b1[_0x58a6aa(0x81)]&&_0x26e1ee[_0x58a6aa(0x71)]==_0x18f8b1[_0x58a6aa(0x71)]&&(_0x26e1ee[_0x58a6aa(0xc1)]=parseInt(_0x26e1ee[_0x58a6aa(0xc1)])+parseInt(_0x18f8b1[_0x58a6aa(0xfb)]),_0x2df488++);});_0x2df488=='0'&&(_0x523637[_0x501761(0x98)]=_0x523637[_0x501761(0x98)][_0x501761(0x15e)]({'product_name':_0x18f8b1['product_name'],'product_stock':_0x18f8b1[_0x501761(0xfb)],'primary_code':_0x18f8b1[_0x501761(0x104)],'secondary_code':_0x18f8b1[_0x501761(0xc0)],'product_code':_0x18f8b1[_0x501761(0x136)],'storage':_0x18f8b1['storage'],'rack':_0x18f8b1[_0x501761(0x81)],'bay':_0x18f8b1[_0x501761(0x188)],'bin':_0x18f8b1[_0x501761(0xf0)],'type':_0x18f8b1[_0x501761(0x9a)],'floorlevel':_0x18f8b1[_0x501761(0x9c)],'maxProducts':_0x18f8b1[_0x501761(0x114)],'unit':_0x18f8b1['standard_unit'],'secondary_unit':_0x18f8b1[_0x501761(0xd9)],'expiry_date':_0x18f8b1[_0x501761(0x11f)]}));}),await _0x523637['save']();const _0x3f6cb2=await s_payment_data[_0x164eba(0xd4)]({'invoice':_0x57b9a0['body'][_0x164eba(0xdf)]});if(_0x3f6cb2===null){}else console[_0x164eba(0x75)](_0x164eba(0xdd),_0x3f6cb2,_0x57b9a0[_0x164eba(0x153)]['invoice']),_0x3f6cb2[_0x164eba(0xdd)]=_0x57b9a0[_0x164eba(0x153)][_0x164eba(0xdd)],await _0x3f6cb2['save']();_0x57b9a0[_0x164eba(0xf9)]('success',_0x164eba(0x72)),_0x163608[_0x164eba(0x16c)]('/all_purchases/view');}catch(_0x41f3e7){console[_0x164eba(0x75)](_0x41f3e7);}}),router[a0_0x484e45(0x161)]('/give_payment/:id',auth,async(_0x39fb11,_0x5c989f)=>{var _0x4fd830=a0_0x484e45;try{const _0x2d97e7=_0x39fb11['params']['id'],{invoice:_0xd8352d,suppliers:_0x5e265f,payable:_0x234e56,due_amount:_0x4d5636}=_0x39fb11[_0x4fd830(0x153)],_0x4e8218=await purchases[_0x4fd830(0x137)](_0x2d97e7);var _0x4f3b0c=_0x234e56-_0x4d5636;_0x4e8218['paid_amount']=parseFloat(_0x4e8218[_0x4fd830(0x12d)])+parseFloat(_0x4d5636),_0x4e8218[_0x4fd830(0x79)]=_0x4f3b0c;const _0x35c731=await _0x4e8218[_0x4fd830(0x168)]();console['log'](_0x35c731);const _0x4d3cb6=await s_payment_data[_0x4fd830(0xd4)]({'invoice':_0xd8352d});_0x4d3cb6[_0x4fd830(0xf4)]=_0x4f3b0c,await _0x4d3cb6[_0x4fd830(0x168)]();let _0x407d5a=new Date(),_0x520424=('0'+_0x407d5a['getDate']())[_0x4fd830(0xb2)](-0x2),_0x2c4133=('0'+(_0x407d5a[_0x4fd830(0xf3)]()+0x1))[_0x4fd830(0xb2)](-0x2),_0x204a5b=_0x407d5a[_0x4fd830(0x124)](),_0x1e2e66=_0x204a5b+'-'+_0x2c4133+'-'+_0x520424;const _0x134234=new suppliers_payment({'invoice':_0xd8352d,'date':_0x204a5b+'-'+_0x2c4133+'-'+_0x520424,'suppliers':_0x5e265f,'reason':_0x4fd830(0x121),'amount':_0x4d5636}),_0x1db992=await _0x134234[_0x4fd830(0x168)]();_0x39fb11[_0x4fd830(0xf9)](_0x4fd830(0xda),_0x4fd830(0xb1)),_0x5c989f[_0x4fd830(0x16c)](_0x4fd830(0x73));}catch(_0x11ac21){console[_0x4fd830(0x75)](_0x11ac21);}}),router['get']('/invoice/:id',auth,async(_0x319090,_0x40920b)=>{var _0x55d931=a0_0x484e45;try{const {username:_0x2f0693,email:_0x229337,role:_0x290a21}=_0x319090[_0x55d931(0x9f)],_0x4f564c=_0x319090[_0x55d931(0x9f)],_0x4426d5=await profile['findOne']({'email':_0x4f564c[_0x55d931(0x151)]}),_0x714d97=await master_shop[_0x55d931(0x144)]();console[_0x55d931(0x75)]('master',_0x714d97);const _0x4fd350=_0x319090['params']['id'],_0x961517=await purchases['findById'](_0x4fd350);console[_0x55d931(0x75)](_0x961517);const _0x33f4fa=await suppliers[_0x55d931(0xd4)]({'name':_0x961517[_0x55d931(0xdd)]});console[_0x55d931(0x75)](_0x33f4fa);if(_0x714d97[0x0][_0x55d931(0xc5)]=='English\x20(US)'){var _0x2f8828=users['English'];console[_0x55d931(0x75)](_0x2f8828);}else{if(_0x714d97[0x0][_0x55d931(0xc5)]==_0x55d931(0x134))var _0x2f8828=users[_0x55d931(0x134)];else{if(_0x714d97[0x0][_0x55d931(0xc5)]=='German')var _0x2f8828=users[_0x55d931(0x9d)];else{if(_0x714d97[0x0][_0x55d931(0xc5)]=='Spanish')var _0x2f8828=users[_0x55d931(0x132)];else{if(_0x714d97[0x0][_0x55d931(0xc5)]==_0x55d931(0xc6))var _0x2f8828=users[_0x55d931(0xc6)];else{if(_0x714d97[0x0][_0x55d931(0xc5)]==_0x55d931(0x93))var _0x2f8828=users[_0x55d931(0xbe)];else{if(_0x714d97[0x0][_0x55d931(0xc5)]==_0x55d931(0xd2))var _0x2f8828=users['Chinese'];else{if(_0x714d97[0x0][_0x55d931(0xc5)]==_0x55d931(0x7d))var _0x2f8828=users[_0x55d931(0xf1)];}}}}}}}_0x40920b['render'](_0x55d931(0xb9),{'success':_0x319090['flash']('success'),'errors':_0x319090[_0x55d931(0xf9)](_0x55d931(0x7b)),'role':_0x4f564c,'profile':_0x4426d5,'master_shop':_0x714d97,'supplier':_0x33f4fa,'purchase':_0x961517,'language':_0x2f8828});}catch(_0x15cddd){console[_0x55d931(0x75)](_0x15cddd);}}),router[a0_0x484e45(0x156)](a0_0x484e45(0xa7),auth,async(_0x8d5d91,_0x129a59)=>{var _0x326816=a0_0x484e45;try{const {username:_0x2329ef,email:_0x4ee515,role:_0x34fcaa}=_0x8d5d91[_0x326816(0x9f)],_0x51f0f2=_0x8d5d91[_0x326816(0x9f)],_0x392e66=await profile['findOne']({'email':_0x51f0f2[_0x326816(0x151)]}),_0x478026=await master_shop[_0x326816(0x144)]();console['log'](_0x326816(0xa2),_0x478026);const _0x1bf459=_0x8d5d91[_0x326816(0xc8)]['id'];console[_0x326816(0x75)](_0x1bf459);const _0x5b489f=await purchases[_0x326816(0x137)](_0x1bf459);console['log'](_0x326816(0x171),_0x5b489f);const _0x5a7feb=await product[_0x326816(0x144)]({}),_0x2e20f9=await warehouse[_0x326816(0xe2)]([{'$match':{'name':_0x5b489f[_0x326816(0x15c)],'room':_0x5b489f[_0x326816(0xc4)],'warehouse_category':_0x326816(0x170)}},{'$unwind':_0x326816(0x175)},{'$group':{'_id':_0x326816(0x166),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x326816(0xba)},'type':{'$first':_0x326816(0x163)},'floorlevel':{'$first':_0x326816(0x9e)},'primary_code':{'$first':_0x326816(0x152)},'secondary_code':{'$first':_0x326816(0x16e)},'product_code':{'$first':_0x326816(0x13a)},'storage':{'$first':_0x326816(0xbf)},'rack':{'$first':'$product_details.rack'}}}]);warehouse_data=await warehouse['aggregate']([{'$match':{'status':_0x326816(0xa8),'name':'Return\x20Goods','warehouse_category':_0x326816(0x170)}},{'$group':{'_id':'$name','name':{'$first':_0x326816(0x105)}}},{'$sort':{'name':0x1}}]),console[_0x326816(0x75)](_0x326816(0xe7),_0x2e20f9);if(_0x478026[0x0][_0x326816(0xc5)]==_0x326816(0x148)){var _0x1a4f2a=users[_0x326816(0xaf)];console[_0x326816(0x75)](_0x1a4f2a);}else{if(_0x478026[0x0]['language']==_0x326816(0x134))var _0x1a4f2a=users['Hindi'];else{if(_0x478026[0x0][_0x326816(0xc5)]=='German')var _0x1a4f2a=users[_0x326816(0x9d)];else{if(_0x478026[0x0][_0x326816(0xc5)]==_0x326816(0x132))var _0x1a4f2a=users[_0x326816(0x132)];else{if(_0x478026[0x0][_0x326816(0xc5)]==_0x326816(0xc6))var _0x1a4f2a=users[_0x326816(0xc6)];else{if(_0x478026[0x0][_0x326816(0xc5)]==_0x326816(0x93))var _0x1a4f2a=users[_0x326816(0xbe)];else{if(_0x478026[0x0]['language']==_0x326816(0xd2))var _0x1a4f2a=users[_0x326816(0xd2)];else{if(_0x478026[0x0][_0x326816(0xc5)]==_0x326816(0x7d))var _0x1a4f2a=users[_0x326816(0xf1)];}}}}}}}_0x129a59[_0x326816(0x88)](_0x326816(0x101),{'success':_0x8d5d91[_0x326816(0xf9)](_0x326816(0xda)),'errors':_0x8d5d91[_0x326816(0xf9)](_0x326816(0x7b)),'role':_0x51f0f2,'profile':_0x392e66,'user':_0x5b489f,'stock':_0x2e20f9,'master_shop':_0x478026,'product':_0x5a7feb,'language':_0x1a4f2a,'warehouse':warehouse_data});}catch(_0x54f6cc){console[_0x326816(0x75)](_0x54f6cc);}}),router[a0_0x484e45(0x161)](a0_0x484e45(0xa7),auth,async(_0x3c6434,_0x45263f)=>{var _0x34ac9f=a0_0x484e45;try{const {invoice:_0x44d8c9,date:_0x28f880,warehouse_name:_0x36612f,Room_name:_0x57ed58,product_name:_0x4c1ef7,purchase_quantity:_0x55a3b8,stocks:_0x40129e,return_qty:_0x533b09,note:_0x4e5417,level:_0x2c8277,isle:_0x2309db,pallet:_0x575157,to_warehouse_name:_0x5cdf61,to_Room_name:_0x3758cf}=_0x3c6434[_0x34ac9f(0x153)],_0xc90567=await purchases[_0x34ac9f(0xd4)]({'_id':_0x3c6434[_0x34ac9f(0xc8)]['id']}),_0x1c06b7=await warehouse[_0x34ac9f(0xd4)]({'name':_0x36612f,'room':_0x57ed58});if(typeof _0x4c1ef7=='string')var _0x217072=[_0x3c6434['body']['product_name']],_0x273ddd=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x123)]],_0x50e6d7=[_0x3c6434[_0x34ac9f(0x153)]['stocks']],_0x109134=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0xc3)]],_0x2f1909=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x176)]],_0x1bd8a8=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x92)]],_0x457714=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x12c)]],_0x585e16=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x11b)]],_0x42cf0b=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x189)]],_0x2a7ea2=[_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x17e)]],_0x594171=[_0x3c6434[_0x34ac9f(0x153)]['secondary_code_hide']];else var _0x217072=[..._0x3c6434['body'][_0x34ac9f(0x142)]],_0x273ddd=[..._0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x123)]],_0x50e6d7=[..._0x3c6434[_0x34ac9f(0x153)]['stocks']],_0x109134=[..._0x3c6434['body'][_0x34ac9f(0xc3)]],_0x2f1909=[..._0x3c6434['body']['level']],_0x1bd8a8=[..._0x3c6434['body']['isle']],_0x457714=[..._0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x12c)]],_0x585e16=[..._0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x11b)]],_0x42cf0b=[..._0x3c6434[_0x34ac9f(0x153)]['product_code_hide']],_0x2a7ea2=[..._0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0x17e)]],_0x594171=[..._0x3c6434['body'][_0x34ac9f(0x138)]];const _0x581099=_0x217072['map'](_0xf15b5a=>{return _0xf15b5a={'product_name':_0xf15b5a};});_0x273ddd[_0x34ac9f(0x14e)]((_0x37fac0,_0x2aff3a)=>{var _0xc5ca2c=_0x34ac9f;_0x581099[_0x2aff3a][_0xc5ca2c(0x123)]=_0x37fac0;}),_0x50e6d7[_0x34ac9f(0x14e)]((_0x4e7df8,_0x2af760)=>{var _0x5a752f=_0x34ac9f;_0x581099[_0x2af760][_0x5a752f(0x14f)]=_0x4e7df8;}),_0x109134[_0x34ac9f(0x14e)]((_0x43dead,_0x4668ee)=>{var _0x3c1ba9=_0x34ac9f;_0x581099[_0x4668ee][_0x3c1ba9(0xc3)]=_0x43dead;}),_0x2f1909[_0x34ac9f(0x14e)]((_0x430999,_0x1e04f1)=>{_0x581099[_0x1e04f1]['bay']=_0x430999;}),_0x1bd8a8['forEach']((_0x4078ec,_0x581816)=>{var _0x1b1573=_0x34ac9f;_0x581099[_0x581816][_0x1b1573(0xf0)]=_0x4078ec;}),_0x457714['forEach']((_0x28b36d,_0x4dce4a)=>{var _0x48d70b=_0x34ac9f;_0x581099[_0x4dce4a][_0x48d70b(0x9c)]=_0x28b36d;}),_0x585e16['forEach']((_0x343e5b,_0xb085b8)=>{var _0x1e6b6b=_0x34ac9f;_0x581099[_0xb085b8][_0x1e6b6b(0x9a)]=_0x343e5b;}),_0x42cf0b[_0x34ac9f(0x14e)]((_0x3b3ec6,_0x1b19a3)=>{var _0x2db1d5=_0x34ac9f;_0x581099[_0x1b19a3][_0x2db1d5(0x136)]=_0x3b3ec6;}),_0x2a7ea2[_0x34ac9f(0x14e)]((_0x297f09,_0x47eab1)=>{_0x581099[_0x47eab1]['primary_code']=_0x297f09;}),_0x594171[_0x34ac9f(0x14e)]((_0x335958,_0x3293fe)=>{var _0x3eb737=_0x34ac9f;_0x581099[_0x3293fe][_0x3eb737(0xc0)]=_0x335958;}),_0xc90567[_0x34ac9f(0x99)]['forEach'](_0x162e03=>{var _0x2037e9=_0x34ac9f;const _0x552130=_0x1c06b7[_0x2037e9(0x98)][_0x2037e9(0x149)](_0x4efd3e=>{var _0x344d8f=_0x2037e9;_0x4efd3e['product_name']==_0x162e03[_0x344d8f(0x142)]&&_0x4efd3e[_0x344d8f(0x9c)]==_0x162e03[_0x344d8f(0x9c)]&&_0x4efd3e['type']==_0x162e03[_0x344d8f(0x9a)]&&_0x4efd3e[_0x344d8f(0xf0)]==_0x162e03['bin']&&_0x4efd3e[_0x344d8f(0x188)]==_0x162e03['bay']&&_0x4efd3e['rack']==_0x162e03[_0x344d8f(0x81)]&&_0x4efd3e['storage']==_0x162e03[_0x344d8f(0x71)]&&(console[_0x344d8f(0x75)](parseInt(_0x4efd3e['product_stock'])+_0x344d8f(0x131)+parseInt(_0x162e03['quantity'])),_0x4efd3e['product_stock']=parseInt(_0x4efd3e['product_stock'])+parseInt(_0x162e03[_0x344d8f(0xfb)]));});}),await _0x1c06b7['save']();const _0xfa7420=_0x581099[_0x34ac9f(0x7a)](_0x134cf5=>_0x134cf5[_0x34ac9f(0xc3)]!=='0'&&_0x134cf5['return_qty']!=='');var _0x5d55fe=0x0;_0xfa7420[_0x34ac9f(0x14e)](_0x28fdaf=>{var _0x577d92=_0x34ac9f;console[_0x577d92(0x75)](_0x577d92(0x74),_0x28fdaf),(parseInt(_0x28fdaf[_0x577d92(0x123)])<parseInt(_0x28fdaf[_0x577d92(0xc3)])||parseInt(_0x28fdaf[_0x577d92(0x14f)])<parseInt(_0x28fdaf[_0x577d92(0xc3)]))&&_0x5d55fe++;});if(_0x5d55fe!=0x0)return _0x3c6434[_0x34ac9f(0xf9)](_0x34ac9f(0x7b),_0x34ac9f(0x13e)),_0x45263f[_0x34ac9f(0x16c)](_0x34ac9f(0xe3));const _0x5f52df=new purchases_return({'invoice':_0x44d8c9,'suppliers':_0x3c6434[_0x34ac9f(0x153)][_0x34ac9f(0xdd)],'date':_0x28f880,'warehouse_name':_0x36612f,'return_product':_0xfa7420,'note':_0x4e5417,'room':_0x57ed58,'to_warehouse_name':_0x5cdf61,'to_room':_0x3758cf}),_0x8ea4c0=await _0x5f52df[_0x34ac9f(0x168)]();console[_0x34ac9f(0x75)](_0x5f52df);const _0x1b2e27=await purchases_return['findOne']({'invoice':_0x44d8c9}),_0x202c2b=await warehouse[_0x34ac9f(0xd4)]({'name':_0x5cdf61,'room':_0x3758cf});_0x1b2e27[_0x34ac9f(0xe8)][_0x34ac9f(0x14e)](_0x282234=>{var _0x152df4=_0x34ac9f,_0x37efcf=0x0;const _0x5215b7=_0x202c2b['product_details'][_0x152df4(0x149)](_0x1d7fe4=>{var _0x31436c=_0x152df4;_0x1d7fe4[_0x31436c(0x142)]==_0x282234[_0x31436c(0x142)]&&_0x1d7fe4[_0x31436c(0x9c)]==_0x282234['floorlevel']&&_0x1d7fe4[_0x31436c(0x9a)]==_0x282234[_0x31436c(0x9a)]&&_0x1d7fe4[_0x31436c(0xf0)]==_0x282234['bin']&&_0x1d7fe4[_0x31436c(0x188)]==_0x282234[_0x31436c(0x188)]&&(_0x1d7fe4[_0x31436c(0xc1)]=parseInt(_0x1d7fe4[_0x31436c(0xc1)])-parseInt(_0x282234[_0x31436c(0xc3)]),_0x37efcf++);});_0x37efcf=='0'&&(_0x202c2b[_0x152df4(0x98)]=_0x202c2b[_0x152df4(0x98)][_0x152df4(0x15e)]({'product_name':_0x282234['product_name'],'product_stock':_0x282234[_0x152df4(0xc3)],'primary_code':_0x282234[_0x152df4(0x104)],'secondary_code':_0x282234[_0x152df4(0xc0)],'product_code':_0x282234[_0x152df4(0x136)],'storage':_0x282234[_0x152df4(0x71)],'rack':_0x282234[_0x152df4(0x81)],'bay':_0x282234['bay'],'bin':_0x282234[_0x152df4(0xf0)],'type':_0x282234['type'],'floorlevel':_0x282234[_0x152df4(0x9c)],'maxProducts':_0x282234[_0x152df4(0x114)],'unit':_0x282234['standard_unit'],'secondary_unit':_0x282234[_0x152df4(0xd9)],'expiry_date':_0x282234[_0x152df4(0x11f)]}));}),await _0x202c2b[_0x34ac9f(0x168)]();const _0x3842df=await purchases[_0x34ac9f(0xd4)]({'invoice':_0x44d8c9});_0x3842df[_0x34ac9f(0x16a)]='True';const _0x41fd4d=await _0x3842df[_0x34ac9f(0x168)](),_0x60aebd=new s_payment_data({'invoice':_0x44d8c9,'suppliers':_0x3c6434['body'][_0x34ac9f(0xdd)],'reason':'Purchase\x20Return'});await _0x60aebd[_0x34ac9f(0x168)]();const _0xbeb3ac=await master_shop[_0x34ac9f(0x144)]();console[_0x34ac9f(0x75)]('add\x20post',_0xbeb3ac[0x0]['image']);const _0x535eab=await email_settings[_0x34ac9f(0xd4)](),_0x184109=await suppliers['findOne']({'name':_0x3c6434[_0x34ac9f(0x153)]['suppliers']});console[_0x34ac9f(0x75)](_0x34ac9f(0x15d),_0x184109);_0xbeb3ac[0x0]['currency_placement']==0x1?(right_currency=_0xbeb3ac[0x0][_0x34ac9f(0x15b)],left_currency=''):(right_currency='',left_currency=_0xbeb3ac[0x0][_0x34ac9f(0x15b)]);var _0x25802f=_0x217072,_0x5461f6=_0x109134,_0x56bdcc='',_0x5df6d7;for(_0x5df6d7 in _0x25802f){_0x56bdcc+=_0x34ac9f(0xd5)+_0x34ac9f(0xbb)+_0x25802f[_0x5df6d7]+_0x34ac9f(0xe6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5461f6[_0x5df6d7]+_0x34ac9f(0xe6)+'</tr>';}console['log'](_0x34ac9f(0x167),_0x56bdcc);let _0x11c8c8=nodemailer[_0x34ac9f(0xcb)]({'service':'gmail','auth':{'user':_0x535eab[_0x34ac9f(0x151)],'pass':_0x535eab[_0x34ac9f(0xfe)]}}),_0x559ecc={'from':_0x535eab[_0x34ac9f(0x151)],'to':_0x184109[_0x34ac9f(0x151)],'subject':_0x34ac9f(0x12f),'attachments':[{'filename':_0x34ac9f(0xb8),'path':__dirname+_0x34ac9f(0xad)+_0x34ac9f(0xd0)+_0xbeb3ac[0x0][_0x34ac9f(0x13c)],'cid':'logo'}],'html':_0x34ac9f(0xb3)+_0x34ac9f(0x122)+_0x34ac9f(0x8f)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x34ac9f(0x130)+_0x34ac9f(0x182)+_0x34ac9f(0xd8)+'<div>'+_0x34ac9f(0x140)+_0xbeb3ac[0x0][_0x34ac9f(0xc7)]+'\x20</h2>'+'</div>'+_0x34ac9f(0xd8)+_0x34ac9f(0xcf)+_0x34ac9f(0x130)+_0x34ac9f(0x154)+_0x34ac9f(0x8a)+_0x44d8c9+'\x20'+_0x34ac9f(0x120)+_0x34ac9f(0x10c)+_0x28f880+'\x20'+_0x34ac9f(0xfd)+'</h5>'+_0x34ac9f(0xd8)+_0x34ac9f(0x85)+_0x34ac9f(0x90)+_0x34ac9f(0xd5)+_0x34ac9f(0x183)+_0x34ac9f(0x177)+_0x34ac9f(0x150)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x34ac9f(0x6f)+_0x34ac9f(0x76)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x56bdcc+'\x20'+_0x34ac9f(0xf5)+_0x34ac9f(0x129)+'<div>'+_0x34ac9f(0x7f)+_0x34ac9f(0x17c)+_0xbeb3ac[0x0]['site_title']+_0x34ac9f(0xc9)+_0x34ac9f(0xd8)+_0x34ac9f(0xd8)+_0x34ac9f(0x109)};_0x11c8c8['sendMail'](_0x559ecc,function(_0x3d84d7,_0x2a242c){var _0x49af7a=_0x34ac9f;_0x3d84d7?(console[_0x49af7a(0x75)](_0x3d84d7),console[_0x49af7a(0x75)]('Error\x20Occurs')):console[_0x49af7a(0x75)](_0x49af7a(0xd3));}),_0x3c6434[_0x34ac9f(0xf9)](_0x34ac9f(0xda),'purchases\x20item\x20return\x20successfull'),_0x45263f[_0x34ac9f(0x16c)](_0x34ac9f(0x73));}catch(_0xefccc4){console[_0x34ac9f(0x75)](_0xefccc4),_0x45263f['status'](0xc8)['json']({'message':_0xefccc4[_0x34ac9f(0xdb)]});}}),router[a0_0x484e45(0x156)](a0_0x484e45(0x12e),auth,async(_0x39deee,_0x2f97e0)=>{var _0x240e23=a0_0x484e45;try{const {username:_0x1890c3,email:_0x48de8d,role:_0xf0424c}=_0x39deee[_0x240e23(0x9f)],_0x4ecd37=_0x39deee[_0x240e23(0x9f)],_0x5e1b0b=await profile[_0x240e23(0xd4)]({'email':_0x4ecd37[_0x240e23(0x151)]}),_0x38ab14=await master_shop[_0x240e23(0x144)](),_0x14c34f=_0x39deee[_0x240e23(0xc8)]['id'],_0x2cf9cf=await purchases[_0x240e23(0x137)](_0x14c34f);if(_0x38ab14[0x0][_0x240e23(0xc5)]=='English\x20(US)')var _0x270644=users[_0x240e23(0xaf)];else{if(_0x38ab14[0x0][_0x240e23(0xc5)]==_0x240e23(0x134))var _0x270644=users[_0x240e23(0x134)];else{if(_0x38ab14[0x0][_0x240e23(0xc5)]==_0x240e23(0x9d))var _0x270644=users[_0x240e23(0x9d)];else{if(_0x38ab14[0x0]['language']=='Spanish')var _0x270644=users[_0x240e23(0x132)];else{if(_0x38ab14[0x0][_0x240e23(0xc5)]=='French')var _0x270644=users['French'];else{if(_0x38ab14[0x0][_0x240e23(0xc5)]==_0x240e23(0x93))var _0x270644=users[_0x240e23(0xbe)];else{if(_0x38ab14[0x0][_0x240e23(0xc5)]==_0x240e23(0xd2))var _0x270644=users[_0x240e23(0xd2)];else{if(_0x38ab14[0x0][_0x240e23(0xc5)]==_0x240e23(0x7d))var _0x270644=users[_0x240e23(0xf1)];}}}}}}}_0x2f97e0[_0x240e23(0x88)](_0x240e23(0x11d),{'success':_0x39deee['flash'](_0x240e23(0xda)),'errors':_0x39deee[_0x240e23(0xf9)](_0x240e23(0x7b)),'role':_0x4ecd37,'profile':_0x5e1b0b,'alldata':_0x2cf9cf,'master_shop':_0x38ab14,'language':_0x270644}),console[_0x240e23(0x75)](alldata);}catch(_0x543c90){console['log'](_0x543c90);}}),router[a0_0x484e45(0x161)](a0_0x484e45(0x16d),async(_0x5c06e7,_0x15aded)=>{var _0x44e524=a0_0x484e45;const {product_code:_0x6dd04}=_0x5c06e7[_0x44e524(0x153)];var _0x4e94fe;const _0x3ed8d0=await product[_0x44e524(0xe2)]([{'$match':{'primary_code':_0x6dd04,'product_category':_0x44e524(0x170)}},{'$group':{'_id':_0x44e524(0xb4),'name':{'$first':'$name'},'category':{'$first':_0x44e524(0xec)},'brand':{'$first':_0x44e524(0xf7)},'unit':{'$first':_0x44e524(0x14c)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x44e524(0x172)},'primary_code':{'$first':_0x44e524(0x112)},'secondary_code':{'$first':_0x44e524(0x12a)},'maxStocks':{'$first':_0x44e524(0xd1)},'maxProdPerUnit':{'$first':_0x44e524(0xef)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x2dde17=await product[_0x44e524(0xe2)]([{'$match':{'secondary_code':_0x6dd04,'product_category':_0x44e524(0x170)}},{'$group':{'_id':_0x44e524(0xb4),'name':{'$first':_0x44e524(0x105)},'category':{'$first':_0x44e524(0xec)},'brand':{'$first':_0x44e524(0xf7)},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x44e524(0xac)},'product_code':{'$first':_0x44e524(0x172)},'primary_code':{'$first':_0x44e524(0x112)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x44e524(0xef)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x3ed8d0[_0x44e524(0x169)]>0x0)_0x4e94fe=_0x3ed8d0;else _0x2dde17[_0x44e524(0x169)]>0x0&&(_0x4e94fe=_0x2dde17);_0x15aded['json'](_0x4e94fe);}),router['post']('/CheckingWarehouse',async(_0x10371d,_0x5076ee)=>{var _0x33ba71=a0_0x484e45;const {primaryCode:_0x4ffb09,secondaryCode:_0x31466a,productCode:_0x373993,bay:_0x3f8bab,bin:_0x25b823,types:_0x40b87a,pallet:_0x357e53,warehouses:_0x51dbba,room:_0x5ae689}=_0x10371d[_0x33ba71(0x153)];console[_0x33ba71(0x75)](_0x10371d[_0x33ba71(0x153)]);try{const _0x5e77ef=await warehouse[_0x33ba71(0xe2)]([{'$match':{'name':_0x51dbba,'room':_0x5ae689}},{'$unwind':_0x33ba71(0x175)},{'$match':{'product_details.bay':_0x3f8bab,'product_details.bin':_0x25b823,'product_details.type':_0x40b87a}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x33ba71(0x14a)},'product_stock':{'$first':_0x33ba71(0xfa)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x33ba71(0x15f)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x33ba71(0x11c)}}}]);_0x5076ee[_0x33ba71(0x126)](0xc8)[_0x33ba71(0x96)](_0x5e77ef);}catch(_0x41fb44){_0x5076ee[_0x33ba71(0x126)](0x194)[_0x33ba71(0x96)]({'message':_0x41fb44['message']});}}),module[a0_0x484e45(0xcc)]=router;function a0_0x1e86(){var _0x31c6fc=['invoice','prod_invoice','$suppliers_docs','aggregate','back','room_name','$product_details.expiry_date','</td>','stock_data','return_product','delivery_code','$note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$category','random','21096jXwxOd','$maxProdPerUnit','bin','Arabic','Purchase\x20data\x20added\x20successfully','getMonth','amount','</tbody>','$product.room_name','$brand','Error\x20Occurs','flash','$product_details.product_stock','quantity','/view','</span>','password','COLD\x20STORAGE','add_purchases\x20error','return_purchase','$product.type','RoomAssign','primary_code','$name','../public/language/languages.json','Rack\x20B','table\x20page','</body></html>','37766NXuJYM','logo','\x20Order\x20Date\x20:\x20','prod_cat','Shelves','../middleware/auth','$suppliers','padStart','$primary_code','floor','maxStocks','67GNYVDL','5061252FEiwsw','An\x20error\x20occurred\x20while\x20saving\x20data.','standard_unit','$finalize','Return\x20Goods','types','$product_details.maxProducts','all_purchases_barcode','then','expiry_date','<span\x20style=\x22float:\x20right;\x22>','Paid\x20For\x20Purchase','<html><head><title></title>','purchase_quantity','getFullYear','prod_level','status','Router','path','</table>','$secondary_code','string','pallet','paid_amount','/barcode/:id','Purchase\x20Return\x20Mail','<div>','\x20<>\x20','Spanish','$product.floorlevel','Hindi','JO_number','product_code','findById','secondary_code_hide','$product.quantity','$product_details.product_code','<tbody\x20style=\x22text-align:\x20center;\x22>','image','deliverycode','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','edit_purchases','<h2>\x20','/all_purchases/view/','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','find','abs','Rack\x20F','Level','English\x20(US)','map','$product_details.product_name','$product','$unit','ejs','forEach','stock_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','email','$product_details.primary_code','body','<h5\x20style=\x22text-align:\x20left;\x22>','error','get','name','actual_uom','role','prod_pallet','currency','warehouse_name','suppliers_data','concat','$product_details.isle','warehouse','post','max_product_unit','$product_details.type','add_purchases','Floor','$product_details._id','product_list','save','length','return_data','alertQTY','redirect','/barcode_scanner','$product_details.secondary_code','2947kejMDi','Raw\x20Materials','user_id','$product_code','Receiving\x20Area','50xIApLb','$product_details','level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','catch','staff','<h5>','actual_qty','primary_code_hide','prod_Qty','$expiry_date','all','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','port','production_date','$product_details.rack','prod_name','bay','product_code_hide','Rack\x20A','17347VYQKVD','</tr>','$product.bin','storage','purchase\x20data\x20update\x20successfully','/all_purchases/view','foreach\x20newproduct','log','</thead>','product_cat','$warehouse_name','due_amount','filter','errors','prod_code','Arabic\x20(ae)','$date','<strong>\x20Regards\x20</strong>','/preview/:id','rack','$invoice','/view/add_purchases','True','<table\x20style=\x22width:\x20100%\x20!important;\x22>','DRY\x20STORAGE','edit_purchases_view','render','4AfqWAY','\x20Order\x20Number\x20:\x20','Rack\x20C','POnumber','sendMail','166185lnRWCo','</head><body>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','prod_isle','isle','Portuguese\x20(BR)','maxperunit','Ambient','json','$due_amount','product_details','product','type','Sales\x20Update\x20successfully','floorlevel','German','$product_details.floorlevel','user','toString','/view/:id','master','INC-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','prod_secondunit','rak','/view/return_purchase/:id','Enabled','2688972ePmlim','push','prod_qty','$alertquantity','/../public','all_purchases','English','batch_code','payment\x20successfull','slice','<!DOCTYPE\x20html>','$_id','note','925690Fxyinb','MaxStocks_data','Logo.png','purchase_invoice','$product_details.bin','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product.bay','Rack\x20E','Portuguese','$product_details.storage','secondary_code','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','return_qty','room','language','French','site_title','params','</h5>','prod_unit','createTransport','exports','finalize','$return_data','<hr\x20class=\x22my-3\x22>','/upload/','$maxStocks','Chinese','Email\x20sent\x20successfully','findOne','<tr>','prod_primunit','suppliers_docs','</div>','secondary_unit','success','message','date','suppliers','$paid_amount'];a0_0x1e86=function(){return _0x31c6fc;};return a0_0x1e86();}