var a0_0x3b25bd=a0_0x300e;function a0_0x300e(_0x434fc2,_0x39b01a){var _0xb64d5e=a0_0xb64d();return a0_0x300e=function(_0x300e41,_0x599786){_0x300e41=_0x300e41-0x15f;var _0x1f63b2=_0xb64d5e[_0x300e41];return _0x1f63b2;},a0_0x300e(_0x434fc2,_0x39b01a);}(function(_0x2b04bd,_0x2d962d){var _0x61dd2f=a0_0x300e,_0x3312af=_0x2b04bd();while(!![]){try{var _0x19b97b=parseInt(_0x61dd2f(0x1dd))/0x1+-parseInt(_0x61dd2f(0x217))/0x2+-parseInt(_0x61dd2f(0x212))/0x3+parseInt(_0x61dd2f(0x273))/0x4+parseInt(_0x61dd2f(0x253))/0x5+-parseInt(_0x61dd2f(0x16e))/0x6*(parseInt(_0x61dd2f(0x1b1))/0x7)+parseInt(_0x61dd2f(0x276))/0x8*(parseInt(_0x61dd2f(0x199))/0x9);if(_0x19b97b===_0x2d962d)break;else _0x3312af['push'](_0x3312af['shift']());}catch(_0x2478c1){_0x3312af['push'](_0x3312af['shift']());}}}(a0_0xb64d,0x44530));const express=require(a0_0x3b25bd(0x1c2)),app=express(),router=express[a0_0x3b25bd(0x16a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x3b25bd(0x197)),auth=require(a0_0x3b25bd(0x1a8)),nodemailer=require(a0_0x3b25bd(0x20c));var ejs=require('ejs');const path=require(a0_0x3b25bd(0x174)),users=require(a0_0x3b25bd(0x23a));router[a0_0x3b25bd(0x1e7)](a0_0x3b25bd(0x243),auth,async(_0x45fa13,_0x11d91c)=>{var _0x159fb5=a0_0x3b25bd;try{const {username:_0x2b52be,email:_0x1224ec,role:_0x2d7d0b}=_0x45fa13[_0x159fb5(0x25f)],_0x4484f7=_0x45fa13[_0x159fb5(0x25f)],_0x1b9277=await profile[_0x159fb5(0x1f7)]({'email':_0x4484f7['email']}),_0x54b935=await staff[_0x159fb5(0x1f7)]({'email':_0x4484f7['email']});if(_0x4484f7[_0x159fb5(0x27e)]==_0x159fb5(0x257)){const _0x25a61f=await staff[_0x159fb5(0x1f7)]({'email':_0x4484f7[_0x159fb5(0x1e4)]});}const _0x4321a5=await master_shop['find']();let _0x1fa997;if(_0x4484f7[_0x159fb5(0x27e)]=='staff'){const _0x35d0b0=await staff[_0x159fb5(0x1f7)]({'email':_0x4484f7['email']});_0x1fa997=await purchases[_0x159fb5(0x272)]([{'$match':{'warehouse_name':_0x35d0b0['warehouse']}},{'$lookup':{'from':_0x159fb5(0x27c),'localField':'suppliers','foreignField':_0x159fb5(0x1aa),'as':_0x159fb5(0x236)}},{'$unwind':_0x159fb5(0x1b5)},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x159fb5(0x1d3)},'suppliers':{'$first':_0x159fb5(0x1bd)},'date':{'$first':_0x159fb5(0x1b0)},'warehouse_name':{'$first':_0x159fb5(0x201)},'room':{'$first':_0x159fb5(0x25b)},'product':{'$push':_0x159fb5(0x218)},'note':{'$first':_0x159fb5(0x184)},'paid_amount':{'$first':_0x159fb5(0x22d)},'due_amount':{'$first':_0x159fb5(0x238)},'return_data':{'$first':_0x159fb5(0x1d5)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0x159fb5(0x1b5)},'total_product_quantity':{'$sum':_0x159fb5(0x1c8)},'level':{'$addToSet':_0x159fb5(0x1ba)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x159fb5(0x24a)},'floorlevel':{'$addToSet':_0x159fb5(0x255)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x1fa997=await purchases[_0x159fb5(0x272)]([{'$lookup':{'from':_0x159fb5(0x27c),'localField':_0x159fb5(0x27c),'foreignField':_0x159fb5(0x1aa),'as':_0x159fb5(0x236)}},{'$unwind':_0x159fb5(0x1b5)},{'$unwind':_0x159fb5(0x218)},{'$group':{'_id':'$_id','invoice':{'$first':_0x159fb5(0x1d3)},'suppliers':{'$first':_0x159fb5(0x1bd)},'date':{'$first':_0x159fb5(0x1b0)},'warehouse_name':{'$first':_0x159fb5(0x201)},'room':{'$addToSet':_0x159fb5(0x1c3)},'product':{'$push':'$product'},'note':{'$first':_0x159fb5(0x184)},'paid_amount':{'$first':_0x159fb5(0x22d)},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':_0x159fb5(0x1d5)},'batch_code':{'$first':_0x159fb5(0x231)},'expiry_date':{'$first':_0x159fb5(0x17c)},'suppliers_docs':{'$first':_0x159fb5(0x1b5)},'total_product_quantity':{'$sum':_0x159fb5(0x1c8)},'level':{'$addToSet':_0x159fb5(0x1ba)},'isle':{'$addToSet':_0x159fb5(0x1d7)},'type':{'$addToSet':_0x159fb5(0x24a)},'floorlevel':{'$addToSet':_0x159fb5(0x255)},'finalize':{'$first':_0x159fb5(0x225)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x4321a5[0x0][_0x159fb5(0x1be)]==_0x159fb5(0x1a4)){var _0x558445=users[_0x159fb5(0x1a1)];console[_0x159fb5(0x164)](_0x558445);}else{if(_0x4321a5[0x0][_0x159fb5(0x1be)]==_0x159fb5(0x181))var _0x558445=users[_0x159fb5(0x181)];else{if(_0x4321a5[0x0][_0x159fb5(0x1be)]=='German')var _0x558445=users[_0x159fb5(0x26a)];else{if(_0x4321a5[0x0]['language']==_0x159fb5(0x229))var _0x558445=users[_0x159fb5(0x229)];else{if(_0x4321a5[0x0][_0x159fb5(0x1be)]=='French')var _0x558445=users[_0x159fb5(0x182)];else{if(_0x4321a5[0x0][_0x159fb5(0x1be)]=='Portuguese\x20(BR)')var _0x558445=users[_0x159fb5(0x275)];else{if(_0x4321a5[0x0]['language']=='Chinese')var _0x558445=users[_0x159fb5(0x177)];else{if(_0x4321a5[0x0]['language']==_0x159fb5(0x1c6))var _0x558445=users['Arabic'];}}}}}}}_0x11d91c[_0x159fb5(0x1ad)](_0x159fb5(0x1a0),{'success':_0x45fa13[_0x159fb5(0x22b)](_0x159fb5(0x268)),'errors':_0x45fa13[_0x159fb5(0x22b)](_0x159fb5(0x246)),'purchases':_0x1fa997,'role':_0x4484f7,'profile':_0x1b9277,'master_shop':_0x4321a5,'language':_0x558445});}catch(_0x595d2a){console['log'](_0x159fb5(0x186),_0x595d2a),_0x11d91c['status'](0xc8)[_0x159fb5(0x20a)]({'message':_0x595d2a[_0x159fb5(0x224)]});}});function BayBinSelected(_0x5ad42c,_0x428d39){var _0x4287eb=a0_0x3b25bd,_0x47f5c9=[],_0x5c3ad0=[],_0x5dc76f=[],_0x39125a=[],_0x3c01a1=[],_0xd49491=[];let _0xbcba77=[];if(_0x5ad42c==_0x4287eb(0x191))switch(_0x428d39){case _0x4287eb(0x1f6):_0x47f5c9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x5c3ad0=[0x1,0x2],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=[_0x4287eb(0x23e),_0x4287eb(0x18a)],_0x3c01a1=['D'],_0xd49491=['A'];break;case _0x4287eb(0x1f5):_0x47f5c9=[0x6,0x5,0x4,0x3,0x2,0x1],_0x5c3ad0=[0x1,0x2],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=[_0x4287eb(0x23e),'Floor'],_0x3c01a1=['D'],_0xd49491=['B'];break;case _0x4287eb(0x193):_0x47f5c9=[0x0],_0x5c3ad0=[0x0],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=['Floor'],_0x3c01a1=['D'],_0xd49491=['S'];break;case _0x4287eb(0x26b):_0x47f5c9=[0x0],_0x5c3ad0=[0x0],_0x39125a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5dc76f=['Floor'],_0x3c01a1=['D'],_0xd49491=['R'];break;}else{if(_0x5ad42c==_0x4287eb(0x260))switch(_0x428d39){case _0x4287eb(0x1f6):_0x47f5c9=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x5c3ad0=['B','F'],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=[_0x4287eb(0x23e),_0x4287eb(0x18a)],_0x3c01a1=['C'],_0xd49491=['A'];break;case'Rack\x20B':_0x47f5c9=[0x5,0x4,0x3,0x2,0x1],_0x5c3ad0=['F','B','S'],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=[_0x4287eb(0x23e),_0x4287eb(0x18a)],_0x3c01a1=['C'],_0xd49491=['B'];break;case _0x4287eb(0x1ac):_0x47f5c9=[0x1,0x2,0x3,0x4,0x5],_0x5c3ad0=['B','F','S'],_0x39125a=[0x5,0x4,0x3,0x2,0x1],_0x5dc76f=[_0x4287eb(0x23e),'Floor'],_0x3c01a1=['C'],_0xd49491=['C'];break;case'Rack\x20D':_0x47f5c9=[0x5,0x4,0x3,0x2,0x1],_0x5c3ad0=['F','B','S'],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=[_0x4287eb(0x23e),_0x4287eb(0x18a)],_0x3c01a1=['C'],_0xd49491=['D'];break;case _0x4287eb(0x1b8):_0x47f5c9=[0x4,0x3,0x2,0x1],_0x5c3ad0=[0x1,0x2],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=[_0x4287eb(0x23e),_0x4287eb(0x18a)],_0x3c01a1=['C'],_0xd49491=['E'];break;case _0x4287eb(0x244):_0x47f5c9=[0x1,0x2,0x3],_0x5c3ad0=[0x1,0x2],_0x39125a=[0x1,0x2,0x3,0x4,0x5],_0x5dc76f=[_0x4287eb(0x23e)],_0x3c01a1=['C'],_0xd49491=['F'];break;}}return{'levels':_0x47f5c9,'Isle':_0x5c3ad0,'rack':_0x39125a,'type':_0x5dc76f,'storage':_0x3c01a1,'rak':_0xd49491};}async function getRandom8DigitNumber(){var _0x25ee5c=a0_0x3b25bd;const _0x43d70d=0x989680,_0x3eb721=0x5f5e0ff,_0x1720d1=Math[_0x25ee5c(0x1e8)](Math[_0x25ee5c(0x189)]()*(_0x3eb721-_0x43d70d+0x1))+_0x43d70d;var _0x2b12aa;const _0x2548c8=await purchases[_0x25ee5c(0x1f7)]({'invoice':_0x25ee5c(0x226)+_0x1720d1});return _0x2548c8&&_0x2548c8[_0x25ee5c(0x21c)]>0x0?_0x2b12aa=_0x25ee5c(0x226)+_0x1720d1:_0x2b12aa=_0x25ee5c(0x226)+_0x1720d1,_0x2b12aa;}router['get'](a0_0x3b25bd(0x1ef),auth,async(_0x559d40,_0x4d4100)=>{var _0x570a5b=a0_0x3b25bd;try{const {username:_0x216197,email:_0x5ba388,role:_0x14661b}=_0x559d40['user'],_0x146f7a=_0x559d40['user'],_0x40c4a0=await profile[_0x570a5b(0x1f7)]({'email':_0x146f7a[_0x570a5b(0x1e4)]}),_0x56ab2b=await master_shop['find'](),_0x5600df=await staff[_0x570a5b(0x1f7)]({'email':_0x146f7a['email']}),_0x3f9c0a=await suppliers[_0x570a5b(0x1fe)]({});let _0x4ca8bc;if(_0x146f7a[_0x570a5b(0x27e)]=='staff'){const _0x43539b=await staff['findOne']({'email':_0x146f7a[_0x570a5b(0x1e4)]});_0x4ca8bc=await warehouse['aggregate']([{'$match':{'status':_0x570a5b(0x192),'name':_0x43539b[_0x570a5b(0x21f)],'warehouse_category':_0x570a5b(0x19d),'name':{'$ne':_0x570a5b(0x1b7)}}},{'$group':{'_id':_0x570a5b(0x162),'name':{'$first':_0x570a5b(0x162)}}}]);}else _0x4ca8bc=await warehouse[_0x570a5b(0x272)]([{'$match':{'status':'Enabled','warehouse_category':_0x570a5b(0x19d),'name':{'$ne':_0x570a5b(0x1b7)}}},{'$group':{'_id':_0x570a5b(0x162),'name':{'$first':_0x570a5b(0x162)}}}]);const _0x2d3cd0=await product['find']({}),_0x489473=await warehouse['find']({'status':_0x570a5b(0x192)}),_0x12bc40=await purchases['find']({}),_0x344680=_0x12bc40[_0x570a5b(0x21c)]+0x1,_0x22baf7=_0x570a5b(0x226)+_0x344680[_0x570a5b(0x1c5)]()[_0x570a5b(0x26d)](0x5,'0');var _0x1fe420=['Ambient',_0x570a5b(0x274)];if(_0x56ab2b[0x0][_0x570a5b(0x1be)]=='English\x20(US)')var _0x18a4f6=users['English'];else{if(_0x56ab2b[0x0]['language']=='Hindi')var _0x18a4f6=users[_0x570a5b(0x181)];else{if(_0x56ab2b[0x0][_0x570a5b(0x1be)]==_0x570a5b(0x26a))var _0x18a4f6=users['German'];else{if(_0x56ab2b[0x0][_0x570a5b(0x1be)]==_0x570a5b(0x229))var _0x18a4f6=users[_0x570a5b(0x229)];else{if(_0x56ab2b[0x0]['language']=='French')var _0x18a4f6=users[_0x570a5b(0x182)];else{if(_0x56ab2b[0x0]['language']=='Portuguese\x20(BR)')var _0x18a4f6=users[_0x570a5b(0x275)];else{if(_0x56ab2b[0x0]['language']==_0x570a5b(0x177))var _0x18a4f6=users[_0x570a5b(0x177)];else{if(_0x56ab2b[0x0][_0x570a5b(0x1be)]==_0x570a5b(0x1c6))var _0x18a4f6=users[_0x570a5b(0x271)];}}}}}}}const _0x17c18c=getRandom8DigitNumber();_0x17c18c[_0x570a5b(0x171)](_0x181edd=>{var _0xb2942c=_0x570a5b;_0x4d4100[_0xb2942c(0x1ad)](_0xb2942c(0x18b),{'success':_0x559d40['flash'](_0xb2942c(0x268)),'errors':_0x559d40[_0xb2942c(0x22b)](_0xb2942c(0x246)),'role':_0x146f7a,'profile':_0x40c4a0,'suppliers':_0x3f9c0a,'warehouse':_0x4ca8bc,'product':_0x2d3cd0,'invoice':_0x181edd,'master_shop':_0x56ab2b,'language':_0x18a4f6,'find_data':_0x489473,'rooms_data':_0x1fe420});})[_0x570a5b(0x1f3)](_0x5a12a5=>{var _0x3cfd22=_0x570a5b;_0x559d40['flash'](_0x3cfd22(0x246),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4d4100[_0x3cfd22(0x202)]('/all_purchases/view');});}catch(_0x14199d){console[_0x570a5b(0x164)](_0x14199d);}}),router[a0_0x3b25bd(0x1e7)](a0_0x3b25bd(0x21b),auth,async(_0x141cde,_0x21e914)=>{var _0x33a972=a0_0x3b25bd;try{const _0x3d072c=_0x141cde[_0x33a972(0x198)]['id'];console[_0x33a972(0x164)](_0x3d072c);const _0x4f39dc=await master_shop['find']();console[_0x33a972(0x164)](_0x33a972(0x1f4),_0x4f39dc);const _0x4c54f2=await product[_0x33a972(0x1f7)]({'name':_0x3d072c});console[_0x33a972(0x164)](_0x33a972(0x178),_0x4c54f2),_0x21e914[_0x33a972(0x1c4)](0xc8)[_0x33a972(0x20a)]({'product_data':_0x4c54f2,'master':_0x4f39dc});}catch(_0x1eafb5){console[_0x33a972(0x164)](_0x33a972(0x1a6),_0x1eafb5);}}),router[a0_0x3b25bd(0x1bf)]('/view/add_purchases',auth,async(_0x37e543,_0x5ec1c8)=>{var _0x44c450=a0_0x3b25bd;try{const {invoice:_0x2e4592,date:_0x3475e4,warehouse_name:_0x2d720a,prod_name:_0x533146,prod_code:_0xe6023e,prod_qty:_0x5388e6,prod_unit:_0xf3ab7b,prod_secondunit:_0x27c5d2,prod_level:_0x390023,prod_isle:_0x5958ba,prod_pallet:_0x11d2af,note:_0x5748fc,expiry_date:_0x27b073,batch_code:_0x13d520,payable:_0x5e5039,due_amount:_0x480b22,Room_name:_0x1d0237,primary_code:_0x3f1d1f,secondary_code:_0x86f17d,MaxStocks_data:_0x4e712d,PO_number:_0x117817,SCRN:_0x4cf1d9,JO_number:_0x2c14cb}=_0x37e543[_0x44c450(0x20d)];if(typeof _0x533146==_0x44c450(0x206))var _0x8e0f7d=[_0x37e543[_0x44c450(0x20d)]['prod_name']],_0x1da8d2=[_0x37e543[_0x44c450(0x20d)]['prod_code']],_0xc38c1a=[_0x37e543[_0x44c450(0x20d)]['prod_Qty']],_0x1dbf9b=[_0x37e543['body'][_0x44c450(0x249)]],_0x2801a6=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x1d1)]],_0x2a4891=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x1ce)]],_0x28cae9=[_0x37e543[_0x44c450(0x20d)]['primary_code']],_0x47b35e=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x1b9)]],_0x2f0010=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x16c)]],_0x530da8=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x1b3)]],_0x533255=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x18f)]],_0x1488bd=[_0x37e543['body']['max_product_unit']],_0x3c211c=[_0x37e543['body']['alertQTY']],_0x560f44=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x1a7)]],_0x46b79f=[_0x37e543['body'][_0x44c450(0x1fb)]],_0x10fff7=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x269)]],_0x5a79da=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x23d)]],_0x503320=[_0x37e543[_0x44c450(0x20d)][_0x44c450(0x1f0)]],_0x51b1e7=[_0x37e543[_0x44c450(0x20d)]['actual_qty']];else var _0x8e0f7d=[..._0x37e543['body'][_0x44c450(0x211)]],_0x1da8d2=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x18c)]],_0xc38c1a=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x190)]],_0x1dbf9b=[..._0x37e543['body'][_0x44c450(0x249)]],_0x2801a6=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x1d1)]],_0x2a4891=[..._0x37e543['body']['prod_level']],_0x28cae9=[..._0x37e543[_0x44c450(0x20d)]['primary_code']],_0x47b35e=[..._0x37e543['body']['secondary_code']],_0x2f0010=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x16c)]],_0x530da8=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x1b3)]],_0x533255=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x18f)]],_0x1488bd=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x270)]],_0x3c211c=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x26e)]],_0x560f44=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x1a7)]],_0x46b79f=[..._0x37e543['body'][_0x44c450(0x1fb)]],_0x10fff7=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x269)]],_0x5a79da=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x23d)]],_0x503320=[..._0x37e543['body'][_0x44c450(0x1f0)]],_0x51b1e7=[..._0x37e543[_0x44c450(0x20d)][_0x44c450(0x241)]];const _0x2ea021=_0x8e0f7d[_0x44c450(0x185)](_0x5cf324=>{return _0x5cf324={'product_name':_0x5cf324};});_0x51b1e7[_0x44c450(0x163)]((_0xdea186,_0x2a00ef)=>{var _0x152a75=_0x44c450;_0x2ea021[_0x2a00ef][_0x152a75(0x241)]=_0xdea186;}),_0x1da8d2[_0x44c450(0x163)]((_0xebcc6b,_0x5ee5a0)=>{var _0x5dea42=_0x44c450;_0x2ea021[_0x5ee5a0][_0x5dea42(0x1e6)]=_0xebcc6b;}),_0xc38c1a[_0x44c450(0x163)]((_0x3c02fd,_0x3fdb16)=>{var _0x499f6a=_0x44c450;_0x2ea021[_0x3fdb16][_0x499f6a(0x1ed)]=_0x3c02fd;}),_0x1dbf9b[_0x44c450(0x163)]((_0x2cb6d9,_0x4438de)=>{var _0x4981e8=_0x44c450;_0x2ea021[_0x4438de][_0x4981e8(0x1d2)]=_0x2cb6d9;}),_0x2801a6[_0x44c450(0x163)]((_0x5c733d,_0x3296e7)=>{_0x2ea021[_0x3296e7]['secondary_unit']=_0x5c733d;}),_0x2a4891[_0x44c450(0x163)]((_0x2c93dc,_0x2dc8f2)=>{_0x10fff7['forEach']((_0x4d2f93,_0x2d6d46)=>{var _0x5b9ddf=a0_0x300e;if(_0x4d2f93=='Receiving\x20Area'&&_0x2dc8f2==_0x2d6d46){console[_0x5b9ddf(0x164)](_0x4d2f93+_0x5b9ddf(0x215)+_0x2dc8f2+_0x5b9ddf(0x24f)+_0x2d6d46+_0x5b9ddf(0x24f)+_0x2c93dc);var _0x2cc658=_0x2c93dc['slice'](0x3);_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x18e)]=_0x2c93dc[0x0],_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x167)]=_0x2c93dc[0x1],_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x1e9)]=0x0,_0x2ea021[_0x2dc8f2]['bin']=0x0,_0x2ea021[_0x2dc8f2]['type']=_0x5b9ddf(0x18a),_0x2ea021[_0x2dc8f2]['floorlevel']=_0x2cc658;}else{if(_0x4d2f93==_0x5b9ddf(0x193)&&_0x2dc8f2==_0x2d6d46){var _0x2cc658=_0x2c93dc[_0x5b9ddf(0x172)](0x3);_0x2ea021[_0x2dc8f2]['storage']=_0x2c93dc[0x0],_0x2ea021[_0x2dc8f2]['rack']=_0x2c93dc[0x1],_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x1e9)]=0x0,_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x19a)]=0x0,_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x203)]='Floor',_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x19e)]=_0x2c93dc[0x5];}else{if(_0x2dc8f2==_0x2d6d46){var _0xb9385e;if(_0x2c93dc[0x4]=='L')_0xb9385e='Level';else _0x2c93dc[0x4]=='F'&&(_0xb9385e=_0x5b9ddf(0x18a));_0x2ea021[_0x2dc8f2]['storage']=_0x2c93dc[0x0],_0x2ea021[_0x2dc8f2]['rack']=_0x2c93dc[0x1],_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x1e9)]=_0x2c93dc[0x2],_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x19a)]=_0x2c93dc[0x3],_0x2ea021[_0x2dc8f2][_0x5b9ddf(0x203)]=_0xb9385e,_0x2ea021[_0x2dc8f2]['floorlevel']=_0x2c93dc[0x5];}}}});}),_0x28cae9['forEach']((_0x1ba6d1,_0x4dcf3b)=>{var _0x4c3b97=_0x44c450;_0x2ea021[_0x4dcf3b][_0x4c3b97(0x24d)]=_0x1ba6d1;}),_0x47b35e['forEach']((_0x244cc4,_0x30af0c)=>{_0x2ea021[_0x30af0c]['secondary_code']=_0x244cc4;}),_0x2f0010[_0x44c450(0x163)]((_0x15cdbe,_0x4f5377)=>{var _0x1983b5=_0x44c450;_0x2ea021[_0x4f5377][_0x1983b5(0x15f)]=_0x15cdbe;}),_0x530da8['forEach']((_0x20fba4,_0x1a5874)=>{var _0x533471=_0x44c450;_0x2ea021[_0x1a5874][_0x533471(0x1b3)]=_0x20fba4;}),_0x533255[_0x44c450(0x163)]((_0xe5ad0d,_0x32968d)=>{var _0x3a9129=_0x44c450;_0x2ea021[_0x32968d][_0x3a9129(0x18f)]=_0xe5ad0d;}),_0x1488bd[_0x44c450(0x163)]((_0x2ec206,_0x204b00)=>{var _0x55eb42=_0x44c450;_0x2ea021[_0x204b00][_0x55eb42(0x280)]=_0x2ec206;}),_0x3c211c[_0x44c450(0x163)]((_0x59701b,_0x35514e)=>{var _0x123b62=_0x44c450;_0x2ea021[_0x35514e][_0x123b62(0x26e)]=_0x59701b;}),_0x560f44[_0x44c450(0x163)]((_0x38dda6,_0x5546e5)=>{var _0x2b5c20=_0x44c450;_0x2ea021[_0x5546e5][_0x2b5c20(0x1a7)]=_0x38dda6;}),_0x46b79f[_0x44c450(0x163)]((_0x47ac1f,_0x42b2d6)=>{_0x2ea021[_0x42b2d6]['product_cat']=_0x47ac1f;}),_0x10fff7[_0x44c450(0x163)]((_0x58ee57,_0x334923)=>{var _0x54d6ef=_0x44c450;_0x2ea021[_0x334923][_0x54d6ef(0x251)]=_0x58ee57;}),_0x5a79da[_0x44c450(0x163)]((_0x5eace5,_0x6e2241)=>{_0x2ea021[_0x6e2241]['delivery_code']=_0x5eace5;}),_0x503320[_0x44c450(0x163)]((_0x3ada3c,_0x1edeed)=>{_0x2ea021[_0x1edeed]['invoice']=_0x3ada3c;});const _0x165b93=_0x10fff7[_0x44c450(0x185)](_0x530916=>{return _0x530916={'room_name':_0x530916};}),_0x384e6b=_0x2ea021[_0x44c450(0x27f)](_0x1ce3f9=>_0x1ce3f9[_0x44c450(0x1ed)]!=='0'&&_0x1ce3f9[_0x44c450(0x1ed)]!==''),_0x5dc53b=new purchases({'invoice':_0x2e4592,'suppliers':_0x37e543['body'][_0x44c450(0x27c)],'date':_0x3475e4,'warehouse_name':_0x2d720a,'product':_0x384e6b,'note':_0x5748fc,'due_amount':_0x480b22,'POnumber':_0x117817,'SCRN':_0x4cf1d9,'JO_number':_0x2c14cb,'roomList':_0x165b93}),_0x4d5e6d=await _0x5dc53b[_0x44c450(0x1c9)](),_0x1ff85c=await purchases[_0x44c450(0x1f7)]({'invoice':_0x2e4592}),_0x419be7=_0x1ff85c[_0x44c450(0x178)]['map'](async _0x2a177e=>{var _0x1f23c6=_0x44c450,_0x52092d=await warehouse[_0x1f23c6(0x1f7)]({'name':_0x2d720a,'room':_0x2a177e[_0x1f23c6(0x251)]}),_0x2f5530=0x0;return _0x52092d[_0x1f23c6(0x16f)][_0x1f23c6(0x163)](_0x1b54c8=>{var _0x5c104b=_0x1f23c6;_0x1b54c8[_0x5c104b(0x175)]==_0x2a177e['product_name']&&_0x1b54c8[_0x5c104b(0x19e)]==_0x2a177e[_0x5c104b(0x19e)]&&_0x1b54c8[_0x5c104b(0x203)]==_0x2a177e[_0x5c104b(0x203)]&&_0x1b54c8['bin']==_0x2a177e[_0x5c104b(0x19a)]&&_0x1b54c8[_0x5c104b(0x1e9)]==_0x2a177e[_0x5c104b(0x1e9)]&&_0x1b54c8[_0x5c104b(0x167)]==_0x2a177e['rack']&&_0x1b54c8[_0x5c104b(0x18e)]==_0x2a177e['storage']&&_0x1b54c8[_0x5c104b(0x18f)]==_0x2a177e[_0x5c104b(0x18f)]&&_0x1b54c8['batch_code']==_0x2a177e[_0x5c104b(0x1b3)]&&_0x1b54c8[_0x5c104b(0x1a7)]==_0x2a177e[_0x5c104b(0x1a7)]&&_0x1b54c8['invoice']==_0x1ff85c['invoice']&&(_0x1b54c8['product_stock']+=_0x2a177e[_0x5c104b(0x1ed)],_0x2f5530++);}),_0x2f5530===0x0&&_0x52092d['product_details'][_0x1f23c6(0x216)]({'product_name':_0x2a177e[_0x1f23c6(0x175)],'product_stock':_0x2a177e[_0x1f23c6(0x1ed)],'primary_code':_0x2a177e[_0x1f23c6(0x24d)],'secondary_code':_0x2a177e[_0x1f23c6(0x1b9)],'product_code':_0x2a177e[_0x1f23c6(0x1e6)],'storage':_0x2a177e[_0x1f23c6(0x18e)],'rack':_0x2a177e[_0x1f23c6(0x167)],'bay':_0x2a177e[_0x1f23c6(0x1e9)],'bin':_0x2a177e['bin'],'type':_0x2a177e['type'],'floorlevel':_0x2a177e[_0x1f23c6(0x19e)],'maxProducts':_0x2a177e[_0x1f23c6(0x15f)],'unit':_0x2a177e[_0x1f23c6(0x1d2)],'secondary_unit':_0x2a177e[_0x1f23c6(0x21e)],'expiry_date':_0x2a177e[_0x1f23c6(0x18f)],'maxPerUnit':_0x2a177e[_0x1f23c6(0x280)],'batch_code':_0x2a177e[_0x1f23c6(0x1b3)],'alertQTY':_0x2a177e[_0x1f23c6(0x26e)],'production_date':_0x2a177e[_0x1f23c6(0x1a7)],'product_cat':_0x2a177e['product_cat'],'invoice':_0x2a177e[_0x1f23c6(0x234)],'actual_qty':_0x2a177e['actual_qty']}),_0x52092d;});Promise[_0x44c450(0x20f)](_0x419be7)['then'](async _0x21f89=>{var _0xea9b28=_0x44c450;try{for(const _0x28db18 of _0x21f89){await _0x28db18[_0xea9b28(0x1c9)]();}const _0x5e968a=await master_shop[_0xea9b28(0x1fe)](),_0x2982d1=await email_settings[_0xea9b28(0x1f7)](),_0x2e9d78=await supervisor_settings[_0xea9b28(0x1fe)]();var _0x187f4e=_0x1ff85c[_0xea9b28(0x178)],_0x439a='',_0xc2ddb1;for(_0xc2ddb1 in _0x187f4e){_0x439a+=_0xea9b28(0x219)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x187f4e[_0xc2ddb1][_0xea9b28(0x175)]+_0xea9b28(0x1d8)+_0xea9b28(0x232)+_0x187f4e[_0xc2ddb1]['product_code']+_0xea9b28(0x1d8)+_0xea9b28(0x232)+_0x187f4e[_0xc2ddb1][_0xea9b28(0x1ed)]+_0xea9b28(0x1d8)+_0xea9b28(0x232)+_0x187f4e[_0xc2ddb1][_0xea9b28(0x1d2)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x187f4e[_0xc2ddb1][_0xea9b28(0x21e)]+_0xea9b28(0x1d8)+_0xea9b28(0x232)+_0x1ff85c[_0xea9b28(0x267)]+_0xea9b28(0x1d8)+_0xea9b28(0x232)+_0x187f4e[_0xc2ddb1][_0xea9b28(0x251)]+_0xea9b28(0x1d8)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x187f4e[_0xc2ddb1]['storage']+_0x187f4e[_0xc2ddb1][_0xea9b28(0x167)]+_0x187f4e[_0xc2ddb1]['bay']+_0x187f4e[_0xc2ddb1][_0xea9b28(0x19a)]+_0x187f4e[_0xc2ddb1][_0xea9b28(0x203)][0x0]+_0x187f4e[_0xc2ddb1][_0xea9b28(0x19e)]+_0xea9b28(0x1d8),_0xea9b28(0x223);}let _0x1289c0=nodemailer[_0xea9b28(0x1bb)]({'host':_0x2982d1[_0xea9b28(0x1ae)],'port':Number(_0x2982d1[_0xea9b28(0x179)]),'secure':![],'auth':{'user':_0x2982d1[_0xea9b28(0x1e4)],'pass':_0x2982d1[_0xea9b28(0x1fd)]}}),_0x4e0e10={'from':_0x2982d1['email'],'to':_0x2e9d78[0x0][_0xea9b28(0x1c1)],'subject':_0xea9b28(0x1f8),'attachments':[{'filename':'Logo.png','path':__dirname+_0xea9b28(0x22a)+_0xea9b28(0x227)+_0x5e968a[0x0][_0xea9b28(0x266)],'cid':_0xea9b28(0x21a)}],'html':_0xea9b28(0x282)+'<html><head><title></title>'+_0xea9b28(0x1a3)+_0xea9b28(0x25c)+_0xea9b28(0x1d9)+_0xea9b28(0x25c)+_0xea9b28(0x1eb)+_0xea9b28(0x207)+_0xea9b28(0x25c)+'<h2>\x20'+_0x5e968a[0x0]['site_title']+_0xea9b28(0x188)+_0xea9b28(0x207)+'</div>'+_0xea9b28(0x278)+'<div>'+_0xea9b28(0x26c)+_0xea9b28(0x19f)+_0x1ff85c[_0xea9b28(0x234)]+'\x20'+_0xea9b28(0x242)+_0xea9b28(0x20e)+_0x1ff85c[_0xea9b28(0x187)]+'\x20'+_0xea9b28(0x220)+_0xea9b28(0x1f9)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xea9b28(0x219)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0xea9b28(0x196)+_0xea9b28(0x254)+_0xea9b28(0x1af)+_0xea9b28(0x1c7)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0xea9b28(0x259)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0xea9b28(0x223)+_0xea9b28(0x194)+_0xea9b28(0x1b6)+'\x20'+_0x439a+'\x20'+_0xea9b28(0x21d)+_0xea9b28(0x19b)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0xea9b28(0x1de)+_0x5e968a[0x0][_0xea9b28(0x248)]+_0xea9b28(0x1f9)+_0xea9b28(0x207)+_0xea9b28(0x207)+_0xea9b28(0x213)};_0x1289c0[_0xea9b28(0x1ea)](_0x4e0e10,function(_0x14d9f9,_0x1456f3){var _0x542244=_0xea9b28;_0x14d9f9?(console['log'](_0x14d9f9),console[_0x542244(0x164)]('Error\x20Occurs')):console[_0x542244(0x164)](_0x542244(0x1d6));}),_0x37e543['flash'](_0xea9b28(0x268),_0xea9b28(0x245)),_0x5ec1c8[_0xea9b28(0x202)](_0xea9b28(0x1bc));}catch(_0x54c884){console[_0xea9b28(0x17f)](_0x54c884),_0x5ec1c8[_0xea9b28(0x1c4)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x44c450(0x1f3)](_0x4be71b=>{var _0x54a733=_0x44c450;console[_0x54a733(0x17f)](_0x4be71b),_0x5ec1c8['status'](0x1f4)[_0x54a733(0x20a)]({'error':'An\x20error\x20occurred.'});});}catch(_0x245029){console['log'](_0x245029);}}),router[a0_0x3b25bd(0x1e7)](a0_0x3b25bd(0x1cc),auth,async(_0x2136c1,_0x158172)=>{var _0x31e2db=a0_0x3b25bd;try{const {username:_0x4ad045,email:_0x504011,role:_0x4b4256}=_0x2136c1[_0x31e2db(0x25f)],_0x4a99b5=_0x2136c1[_0x31e2db(0x25f)],_0x4cffdb=await profile[_0x31e2db(0x1f7)]({'email':_0x4a99b5[_0x31e2db(0x1e4)]}),_0x252e37=await master_shop['find'](),_0x3a884e=_0x2136c1[_0x31e2db(0x198)]['id'],_0x3eb1c9=await purchases[_0x31e2db(0x165)](_0x3a884e),_0xa7d5e6=await warehouse[_0x31e2db(0x272)]([{'$match':{'name':_0x3eb1c9['warehouse_name'],'room':_0x3eb1c9[_0x31e2db(0x221)]}},{'$unwind':_0x31e2db(0x250)},{'$group':{'_id':_0x31e2db(0x17a),'name':{'$first':_0x31e2db(0x1dc)},'product_stock':{'$first':_0x31e2db(0x281)},'bay':{'$first':_0x31e2db(0x265)},'bin':{'$first':_0x31e2db(0x161)},'type':{'$first':_0x31e2db(0x1e2)},'floorlevel':{'$first':_0x31e2db(0x1df)},'primary_code':{'$first':_0x31e2db(0x258)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x31e2db(0x263)},'storage':{'$first':_0x31e2db(0x168)},'rack':{'$first':_0x31e2db(0x20b)},'expiry_date':{'$first':_0x31e2db(0x25e)}}}]),_0xbc4dde=await customer[_0x31e2db(0x1fe)]({});let _0x35fbe9;if(_0x4a99b5[_0x31e2db(0x27e)]==_0x31e2db(0x257)){const _0x5a8cdb=await staff[_0x31e2db(0x1f7)]({'email':_0x4a99b5[_0x31e2db(0x1e4)]});_0x35fbe9=await warehouse[_0x31e2db(0x272)]([{'$match':{'status':_0x31e2db(0x192),'name':_0x5a8cdb[_0x31e2db(0x21f)]}},{'$group':{'_id':_0x31e2db(0x162),'name':{'$first':_0x31e2db(0x162)}}}]);}else _0x35fbe9=await warehouse['aggregate']([{'$match':{'status':_0x31e2db(0x192)}},{'$group':{'_id':_0x31e2db(0x162),'name':{'$first':_0x31e2db(0x162)}}}]);const _0x376485=await product[_0x31e2db(0x1fe)]({}),_0x253321=await suppliers['find']({}),_0x7d5a7=BayBinSelected(_0x3eb1c9[_0x31e2db(0x267)],_0x3eb1c9[_0x31e2db(0x221)]);if(_0x252e37[0x0][_0x31e2db(0x1be)]==_0x31e2db(0x1a4)){var _0x526ac3=users[_0x31e2db(0x1a1)];console[_0x31e2db(0x164)](_0x526ac3);}else{if(_0x252e37[0x0][_0x31e2db(0x1be)]==_0x31e2db(0x181))var _0x526ac3=users[_0x31e2db(0x181)];else{if(_0x252e37[0x0]['language']==_0x31e2db(0x26a))var _0x526ac3=users[_0x31e2db(0x26a)];else{if(_0x252e37[0x0]['language']==_0x31e2db(0x229))var _0x526ac3=users['Spanish'];else{if(_0x252e37[0x0][_0x31e2db(0x1be)]=='French')var _0x526ac3=users[_0x31e2db(0x182)];else{if(_0x252e37[0x0][_0x31e2db(0x1be)]=='Portuguese\x20(BR)')var _0x526ac3=users['Portuguese'];else{if(_0x252e37[0x0][_0x31e2db(0x1be)]==_0x31e2db(0x177))var _0x526ac3=users[_0x31e2db(0x177)];else{if(_0x252e37[0x0][_0x31e2db(0x1be)]==_0x31e2db(0x1c6))var _0x526ac3=users[_0x31e2db(0x271)];}}}}}}}_0x158172['render'](_0x31e2db(0x169),{'success':_0x2136c1[_0x31e2db(0x22b)](_0x31e2db(0x268)),'errors':_0x2136c1[_0x31e2db(0x22b)](_0x31e2db(0x246)),'role':_0x4a99b5,'profile':_0x4cffdb,'customer':_0xbc4dde,'warehouse':_0x35fbe9,'product':_0xa7d5e6,'user':_0x3eb1c9,'master_shop':_0x252e37,'unit':_0x376485,'language':_0x526ac3,'suppliers':_0x253321,'dataSelected':_0x7d5a7});}catch(_0x33f987){console[_0x31e2db(0x164)](_0x33f987);}}),router[a0_0x3b25bd(0x1bf)](a0_0x3b25bd(0x1cc),auth,async(_0x3d981e,_0x367833)=>{var _0x4c2cfa=a0_0x3b25bd;try{const _0x36f9a4=_0x3d981e[_0x4c2cfa(0x198)]['id'],{invoice:_0x33b43c,warehouse_name:_0x71e253,Room_name:_0x57037f}=_0x3d981e['body'],_0x2d8ac3=await warehouse[_0x4c2cfa(0x1f7)]({'name':_0x71e253,'room':_0x57037f}),_0x5f0b66=await purchases[_0x4c2cfa(0x1f7)]({'invoice':_0x33b43c});_0x5f0b66[_0x4c2cfa(0x178)][_0x4c2cfa(0x163)](_0x298ac7=>{var _0x5d1c31=_0x4c2cfa,_0x459817=0x0;const _0x198352=_0x2d8ac3[_0x5d1c31(0x16f)][_0x5d1c31(0x185)](_0x2cc264=>{var _0xd7f49f=_0x5d1c31;_0x2cc264['product_name']==_0x298ac7[_0xd7f49f(0x175)]&&_0x2cc264[_0xd7f49f(0x19e)]==_0x298ac7[_0xd7f49f(0x19e)]&&_0x2cc264[_0xd7f49f(0x203)]==_0x298ac7[_0xd7f49f(0x203)]&&_0x2cc264[_0xd7f49f(0x19a)]==_0x298ac7[_0xd7f49f(0x19a)]&&_0x2cc264[_0xd7f49f(0x1e9)]==_0x298ac7[_0xd7f49f(0x1e9)]&&_0x2cc264['rack']==_0x298ac7['rack']&&_0x2cc264[_0xd7f49f(0x18e)]==_0x298ac7[_0xd7f49f(0x18e)]&&_0x2cc264[_0xd7f49f(0x18f)]==_0x298ac7[_0xd7f49f(0x18f)]&&_0x2cc264[_0xd7f49f(0x1b3)]==_0x298ac7[_0xd7f49f(0x1b3)]&&_0x2cc264[_0xd7f49f(0x1a7)]==_0x298ac7[_0xd7f49f(0x1a7)]&&_0x2cc264[_0xd7f49f(0x27a)]==_0x298ac7[_0xd7f49f(0x27a)]&&_0x2cc264[_0xd7f49f(0x256)]==_0x298ac7[_0xd7f49f(0x256)]&&(_0x2cc264[_0xd7f49f(0x23c)]=parseInt(_0x2cc264['product_stock'])+parseInt(_0x298ac7['quantity']),_0x459817++);});_0x459817=='0'&&(_0x2d8ac3[_0x5d1c31(0x16f)]=_0x2d8ac3['product_details'][_0x5d1c31(0x1a2)]({'product_name':_0x298ac7[_0x5d1c31(0x175)],'product_stock':_0x298ac7['quantity'],'primary_code':_0x298ac7[_0x5d1c31(0x24d)],'secondary_code':_0x298ac7['secondary_code'],'product_code':_0x298ac7['product_code'],'storage':_0x298ac7[_0x5d1c31(0x18e)],'rack':_0x298ac7[_0x5d1c31(0x167)],'bay':_0x298ac7[_0x5d1c31(0x1e9)],'bin':_0x298ac7[_0x5d1c31(0x19a)],'type':_0x298ac7[_0x5d1c31(0x203)],'floorlevel':_0x298ac7[_0x5d1c31(0x19e)],'maxProducts':_0x298ac7['maxStocks'],'unit':_0x298ac7[_0x5d1c31(0x1d2)],'secondary_unit':_0x298ac7['secondary_unit'],'expiry_date':_0x298ac7[_0x5d1c31(0x18f)],'maxPerUnit':_0x298ac7[_0x5d1c31(0x280)],'batch_code':_0x298ac7[_0x5d1c31(0x1b3)],'alertQTY':_0x298ac7[_0x5d1c31(0x26e)],'production_date':_0x298ac7[_0x5d1c31(0x1a7)],'delivery_date':_0x298ac7['delivery_date'],'delivery_code':_0x298ac7[_0x5d1c31(0x256)]}));}),await _0x2d8ac3[_0x4c2cfa(0x1c9)](),_0x5f0b66[_0x4c2cfa(0x180)]=_0x4c2cfa(0x23f);const _0x2deb52=await _0x5f0b66[_0x4c2cfa(0x1c9)]();_0x3d981e[_0x4c2cfa(0x22b)](_0x4c2cfa(0x268),_0x4c2cfa(0x1cb)),_0x367833[_0x4c2cfa(0x202)](_0x4c2cfa(0x1b2));}catch(_0x2caca8){console['log'](_0x2caca8);}}),router['get'](a0_0x3b25bd(0x1f2),auth,async(_0x3a4910,_0x3e972e)=>{var _0x89c0a4=a0_0x3b25bd;try{const {username:_0x1528f4,email:_0x2651a1,role:_0x3c5a56}=_0x3a4910['user'],_0x5b2372=_0x3a4910[_0x89c0a4(0x25f)],_0x2c7466=await profile[_0x89c0a4(0x1f7)]({'email':_0x5b2372[_0x89c0a4(0x1e4)]}),_0x235bf0=await master_shop[_0x89c0a4(0x1fe)](),_0x3327f5=_0x3a4910[_0x89c0a4(0x198)]['id'],_0x28cbc6=await purchases['findById'](_0x3327f5),_0x25601d=await suppliers[_0x89c0a4(0x1fe)]({});let _0x4b5851;if(_0x5b2372[_0x89c0a4(0x27e)]==_0x89c0a4(0x257)){const _0x39705e=await staff['findOne']({'email':_0x5b2372['email']});_0x4b5851=await warehouse['find']({'status':_0x89c0a4(0x192),'name':_0x39705e[_0x89c0a4(0x21f)],'warehouse_category':'Raw\x20Materials'});}else _0x4b5851=await warehouse[_0x89c0a4(0x272)]([{'$match':{'status':_0x89c0a4(0x192),'warehouse_category':_0x89c0a4(0x19d)}},{'$group':{'_id':'$name','name':{'$first':_0x89c0a4(0x162)}}}]);const _0x8c30c0=await product['find']({}),_0x13bc23=BayBinSelected(_0x28cbc6[_0x89c0a4(0x267)],_0x28cbc6[_0x89c0a4(0x221)]);let _0xa9bb17=new Date(_0x28cbc6[_0x89c0a4(0x18f)]),_0x1b0cbe=('0'+_0xa9bb17[_0x89c0a4(0x264)]())[_0x89c0a4(0x172)](-0x2),_0x4277e6=('0'+(_0xa9bb17[_0x89c0a4(0x1e1)]()+0x1))[_0x89c0a4(0x172)](-0x2),_0x15b70e=_0xa9bb17[_0x89c0a4(0x1e0)](),_0xb72afa=_0x15b70e+'-'+_0x4277e6+'-'+_0x1b0cbe;if(_0x235bf0[0x0]['language']==_0x89c0a4(0x1a4)){var _0x29b353=users[_0x89c0a4(0x1a1)];console[_0x89c0a4(0x164)](_0x29b353);}else{if(_0x235bf0[0x0]['language']=='Hindi')var _0x29b353=users[_0x89c0a4(0x181)];else{if(_0x235bf0[0x0]['language']==_0x89c0a4(0x26a))var _0x29b353=users['German'];else{if(_0x235bf0[0x0][_0x89c0a4(0x1be)]==_0x89c0a4(0x229))var _0x29b353=users[_0x89c0a4(0x229)];else{if(_0x235bf0[0x0][_0x89c0a4(0x1be)]==_0x89c0a4(0x182))var _0x29b353=users[_0x89c0a4(0x182)];else{if(_0x235bf0[0x0][_0x89c0a4(0x1be)]==_0x89c0a4(0x24c))var _0x29b353=users[_0x89c0a4(0x275)];else{if(_0x235bf0[0x0][_0x89c0a4(0x1be)]==_0x89c0a4(0x177))var _0x29b353=users[_0x89c0a4(0x177)];else{if(_0x235bf0[0x0][_0x89c0a4(0x1be)]==_0x89c0a4(0x1c6))var _0x29b353=users[_0x89c0a4(0x271)];}}}}}}}_0x3e972e['render'](_0x89c0a4(0x208),{'success':_0x3a4910[_0x89c0a4(0x22b)](_0x89c0a4(0x268)),'errors':_0x3a4910['flash'](_0x89c0a4(0x246)),'role':_0x5b2372,'profile':_0x2c7466,'purchases':_0x28cbc6,'suppliers':_0x25601d,'warehouse':_0x4b5851,'product':_0x8c30c0,'master_shop':_0x235bf0,'language':_0x29b353,'ed_fullDate':_0xb72afa,'dataSelected':_0x13bc23});}catch(_0x3b7dcd){console[_0x89c0a4(0x164)](_0x3b7dcd);}}),router[a0_0x3b25bd(0x1bf)](a0_0x3b25bd(0x1f2),auth,async(_0x46abf1,_0x2ec789)=>{var _0x519328=a0_0x3b25bd;try{const _0x284339=_0x46abf1['params']['id'],_0x5e3810=await purchases['findOne']({'_id':_0x46abf1[_0x519328(0x198)]['id']}),_0x3029f7=await warehouse[_0x519328(0x1f7)]({'name':_0x5e3810[_0x519328(0x267)],'room':_0x5e3810['room']});_0x5e3810[_0x519328(0x178)][_0x519328(0x163)](_0x10d62c=>{var _0x1955a4=_0x519328;const _0x556309=_0x3029f7[_0x1955a4(0x16f)][_0x1955a4(0x185)](_0x430840=>{var _0x254fe9=_0x1955a4;_0x430840[_0x254fe9(0x175)]==_0x10d62c[_0x254fe9(0x175)]&&_0x430840[_0x254fe9(0x19e)]==_0x10d62c['floorlevel']&&_0x430840[_0x254fe9(0x203)]==_0x10d62c['type']&&_0x430840[_0x254fe9(0x19a)]==_0x10d62c['bin']&&_0x430840[_0x254fe9(0x1e9)]==_0x10d62c[_0x254fe9(0x1e9)]&&_0x430840[_0x254fe9(0x167)]==_0x10d62c[_0x254fe9(0x167)]&&_0x430840['storage']==_0x10d62c[_0x254fe9(0x18e)]&&(_0x430840['product_stock']=parseInt(_0x430840['product_stock'])-parseInt(_0x10d62c[_0x254fe9(0x1ed)]));});}),await _0x3029f7['save']();const {invoice:_0x48c6a9,suppliers:_0x3c8348,date:_0x1784bf,warehouse_name:_0x3831c7,prod_name:_0x49007c,prod_code:_0x50a03f,prod_qty:_0x22dce8,prod_unit:_0x3f7708,prod_secondunit:_0x29d96e,prod_level:_0x15a009,prod_isle:_0x3eadd0,prod_pallet:_0x1fe6f4,note:_0x5ab188,expiry_date:_0x1c86f6,batch_code:_0x2f4d1b,paid_amount:_0x510f52,due_amount:_0x4b2b3a,Room_name:_0x4bbf28,primary_code:_0x3152be,secondary_code:_0x30e61b,PO_number:_0xd106f8,JO_number:_0xf7705c}=_0x46abf1['body'];if(typeof _0x49007c==_0x519328(0x206))var _0x2f1483=[_0x46abf1[_0x519328(0x20d)]['prod_name']],_0x10bda0=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x18c)]],_0x4e7c80=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x16d)]],_0x413c8f=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x237)]],_0x2df829=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x1d1)]],_0x28f4e4=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x1ce)]],_0x31851c=[_0x46abf1['body'][_0x519328(0x23b)]],_0x135e48=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x1cf)]],_0x1c3609=[_0x46abf1[_0x519328(0x20d)]['primary_code']],_0x211e25=[_0x46abf1[_0x519328(0x20d)]['secondary_code']],_0x1c980f=[_0x46abf1['body'][_0x519328(0x16c)]],_0x5bd5c5=[_0x46abf1['body'][_0x519328(0x1b3)]],_0x448a64=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x18f)]],_0x5f53e3=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x18e)]],_0x30d6f3=[_0x46abf1[_0x519328(0x20d)][_0x519328(0x222)]],_0x4cba9d=[_0x46abf1['body']['type']];else var _0x2f1483=[..._0x46abf1[_0x519328(0x20d)]['prod_name']],_0x10bda0=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x18c)]],_0x4e7c80=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x16d)]],_0x413c8f=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x237)]],_0x2df829=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x1d1)]],_0x28f4e4=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x1ce)]],_0x31851c=[..._0x46abf1['body'][_0x519328(0x23b)]],_0x135e48=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x1cf)]],_0x1c3609=[..._0x46abf1[_0x519328(0x20d)]['primary_code']],_0x211e25=[..._0x46abf1[_0x519328(0x20d)]['secondary_code']],_0x1c980f=[..._0x46abf1[_0x519328(0x20d)]['MaxStocks_data']],_0x5bd5c5=[..._0x46abf1[_0x519328(0x20d)]['batch_code']],_0x448a64=[..._0x46abf1['body']['expiry_date']],_0x5f53e3=[..._0x46abf1[_0x519328(0x20d)]['storage']],_0x30d6f3=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x222)]],_0x4cba9d=[..._0x46abf1[_0x519328(0x20d)][_0x519328(0x203)]];const _0x6acefc=_0x2f1483[_0x519328(0x185)](_0xd442bd=>{return _0xd442bd={'product_name':_0xd442bd};});_0x10bda0[_0x519328(0x163)]((_0x2ea137,_0x10504d)=>{_0x6acefc[_0x10504d]['product_code']=_0x2ea137;}),_0x4e7c80['forEach']((_0x2f7b20,_0x52cb6a)=>{_0x6acefc[_0x52cb6a]['quantity']=_0x2f7b20;}),_0x413c8f[_0x519328(0x163)]((_0x65ee11,_0xc79c4e)=>{_0x6acefc[_0xc79c4e]['standard_unit']=_0x65ee11;}),_0x2df829[_0x519328(0x163)]((_0x2fe33b,_0x332376)=>{var _0x471b9c=_0x519328;_0x6acefc[_0x332376][_0x471b9c(0x21e)]=_0x2fe33b;}),_0x28f4e4[_0x519328(0x163)]((_0x2f54ff,_0x3715db)=>{_0x6acefc[_0x3715db]['bay']=_0x2f54ff;}),_0x31851c['forEach']((_0x1deb4a,_0x220816)=>{_0x6acefc[_0x220816]['bin']=_0x1deb4a;}),_0x135e48[_0x519328(0x163)]((_0x302124,_0x1c16f4)=>{var _0x217b46=_0x519328;_0x6acefc[_0x1c16f4][_0x217b46(0x19e)]=_0x302124;}),_0x1c3609['forEach']((_0x237528,_0xcf3ac8)=>{_0x6acefc[_0xcf3ac8]['primary_code']=_0x237528;}),_0x211e25[_0x519328(0x163)]((_0x4ed585,_0x981f5f)=>{var _0x43c1ba=_0x519328;_0x6acefc[_0x981f5f][_0x43c1ba(0x1b9)]=_0x4ed585;}),_0x1c980f[_0x519328(0x163)]((_0x1d6dc7,_0x40799b)=>{var _0x39ce67=_0x519328;_0x6acefc[_0x40799b][_0x39ce67(0x15f)]=_0x1d6dc7;}),_0x5bd5c5['forEach']((_0x5102ab,_0x3686e4)=>{var _0x2b9385=_0x519328;_0x6acefc[_0x3686e4][_0x2b9385(0x1b3)]=_0x5102ab;}),_0x448a64[_0x519328(0x163)]((_0x43cfc3,_0x4382f3)=>{var _0x1fe171=_0x519328;_0x6acefc[_0x4382f3][_0x1fe171(0x18f)]=_0x43cfc3;}),_0x4cba9d[_0x519328(0x163)]((_0x5041eb,_0x1a3a82)=>{_0x6acefc[_0x1a3a82]['type']=_0x5041eb;}),_0x5f53e3[_0x519328(0x163)]((_0x1a9fa5,_0x499391)=>{_0x6acefc[_0x499391]['storage']=_0x1a9fa5;}),_0x30d6f3[_0x519328(0x163)]((_0x44a5c2,_0x14c874)=>{var _0x2ca280=_0x519328;_0x6acefc[_0x14c874][_0x2ca280(0x167)]=_0x44a5c2;});const _0x550787=_0x6acefc['filter'](_0x4686f8=>_0x4686f8[_0x519328(0x1ed)]!=='0'&&_0x4686f8[_0x519328(0x1ed)]!=='');_0x5e3810[_0x519328(0x234)]=_0x48c6a9,_0x5e3810['suppliers']=_0x3c8348,_0x5e3810[_0x519328(0x187)]=_0x1784bf,_0x5e3810[_0x519328(0x267)]=_0x3831c7,_0x5e3810['product']=_0x550787,_0x5e3810[_0x519328(0x240)]=_0x5ab188,_0x5e3810[_0x519328(0x19c)]=_0x510f52,_0x5e3810[_0x519328(0x27d)]=_0x4b2b3a,_0x5e3810['room']=_0x4bbf28,_0x5e3810[_0x519328(0x1e3)]=_0xd106f8,_0x5e3810['JO_number']=_0xf7705c;const _0x3a1a5b=await _0x5e3810['save'](),_0x1708cb=await warehouse['findOne']({'name':_0x46abf1['body'][_0x519328(0x267)],'room':_0x46abf1[_0x519328(0x20d)][_0x519328(0x1ca)]});_0x5e3810['product'][_0x519328(0x163)](_0x3fe892=>{var _0x1c82a5=_0x519328,_0xe7603f=0x0;const _0x213244=_0x1708cb['product_details'][_0x1c82a5(0x185)](_0x1ae719=>{var _0x11616a=_0x1c82a5;_0x1ae719[_0x11616a(0x175)]==_0x3fe892[_0x11616a(0x175)]&&_0x1ae719[_0x11616a(0x19e)]==_0x3fe892[_0x11616a(0x19e)]&&_0x1ae719[_0x11616a(0x203)]==_0x3fe892[_0x11616a(0x203)]&&_0x1ae719[_0x11616a(0x19a)]==_0x3fe892[_0x11616a(0x19a)]&&_0x1ae719[_0x11616a(0x1e9)]==_0x3fe892['bay']&&_0x1ae719['rack']==_0x3fe892[_0x11616a(0x167)]&&_0x1ae719[_0x11616a(0x18e)]==_0x3fe892[_0x11616a(0x18e)]&&(_0x1ae719[_0x11616a(0x23c)]=parseInt(_0x1ae719[_0x11616a(0x23c)])+parseInt(_0x3fe892[_0x11616a(0x1ed)]),_0xe7603f++);});_0xe7603f=='0'&&(_0x1708cb[_0x1c82a5(0x16f)]=_0x1708cb[_0x1c82a5(0x16f)]['concat']({'product_name':_0x3fe892[_0x1c82a5(0x175)],'product_stock':_0x3fe892['quantity'],'primary_code':_0x3fe892[_0x1c82a5(0x24d)],'secondary_code':_0x3fe892[_0x1c82a5(0x1b9)],'product_code':_0x3fe892[_0x1c82a5(0x1e6)],'storage':_0x3fe892['storage'],'rack':_0x3fe892['rack'],'bay':_0x3fe892[_0x1c82a5(0x1e9)],'bin':_0x3fe892[_0x1c82a5(0x19a)],'type':_0x3fe892[_0x1c82a5(0x203)],'floorlevel':_0x3fe892[_0x1c82a5(0x19e)],'maxProducts':_0x3fe892[_0x1c82a5(0x15f)],'unit':_0x3fe892[_0x1c82a5(0x1d2)],'secondary_unit':_0x3fe892[_0x1c82a5(0x21e)],'expiry_date':_0x3fe892[_0x1c82a5(0x18f)]}));}),await _0x1708cb[_0x519328(0x1c9)]();const _0xf69971=await s_payment_data[_0x519328(0x1f7)]({'invoice':_0x46abf1[_0x519328(0x20d)][_0x519328(0x234)]});if(_0xf69971===null){}else console[_0x519328(0x164)](_0x519328(0x27c),_0xf69971,_0x46abf1[_0x519328(0x20d)]['invoice']),_0xf69971[_0x519328(0x27c)]=_0x46abf1[_0x519328(0x20d)]['suppliers'],await _0xf69971[_0x519328(0x1c9)]();_0x46abf1[_0x519328(0x22b)](_0x519328(0x268),_0x519328(0x25a)),_0x2ec789[_0x519328(0x202)](_0x519328(0x1b2));}catch(_0x3a23c7){console[_0x519328(0x164)](_0x3a23c7);}}),router[a0_0x3b25bd(0x1bf)](a0_0x3b25bd(0x195),auth,async(_0x2fd4a7,_0x576fb1)=>{var _0x53a13f=a0_0x3b25bd;try{const _0x155c0f=_0x2fd4a7[_0x53a13f(0x198)]['id'],{invoice:_0x215ff8,suppliers:_0x41fbb2,payable:_0x324e33,due_amount:_0x142986}=_0x2fd4a7[_0x53a13f(0x20d)],_0x518a8a=await purchases[_0x53a13f(0x165)](_0x155c0f);var _0xe7c856=_0x324e33-_0x142986;_0x518a8a['paid_amount']=parseFloat(_0x518a8a['paid_amount'])+parseFloat(_0x142986),_0x518a8a[_0x53a13f(0x27d)]=_0xe7c856;const _0x3532ff=await _0x518a8a[_0x53a13f(0x1c9)]();console[_0x53a13f(0x164)](_0x3532ff);const _0x5f597c=await s_payment_data[_0x53a13f(0x1f7)]({'invoice':_0x215ff8});_0x5f597c['amount']=_0xe7c856,await _0x5f597c[_0x53a13f(0x1c9)]();let _0x1d2676=new Date(),_0x4fd885=('0'+_0x1d2676['getDate']())[_0x53a13f(0x172)](-0x2),_0x5169a5=('0'+(_0x1d2676[_0x53a13f(0x1e1)]()+0x1))[_0x53a13f(0x172)](-0x2),_0xf1760b=_0x1d2676['getFullYear'](),_0xd45d7a=_0xf1760b+'-'+_0x5169a5+'-'+_0x4fd885;const _0x1f93ea=new suppliers_payment({'invoice':_0x215ff8,'date':_0xf1760b+'-'+_0x5169a5+'-'+_0x4fd885,'suppliers':_0x41fbb2,'reason':_0x53a13f(0x1f1),'amount':_0x142986}),_0x5d4ff5=await _0x1f93ea[_0x53a13f(0x1c9)]();_0x2fd4a7[_0x53a13f(0x22b)](_0x53a13f(0x268),_0x53a13f(0x1fa)),_0x576fb1[_0x53a13f(0x202)](_0x53a13f(0x1b2));}catch(_0x468dfa){console[_0x53a13f(0x164)](_0x468dfa);}}),router[a0_0x3b25bd(0x1e7)](a0_0x3b25bd(0x17b),auth,async(_0x26c3aa,_0x40c93c)=>{var _0x5dd957=a0_0x3b25bd;try{const {username:_0x2c2b17,email:_0x291469,role:_0x24bcc0}=_0x26c3aa[_0x5dd957(0x25f)],_0x309744=_0x26c3aa[_0x5dd957(0x25f)],_0x514fbd=await profile[_0x5dd957(0x1f7)]({'email':_0x309744[_0x5dd957(0x1e4)]}),_0xbf0ffe=await master_shop[_0x5dd957(0x1fe)]();console[_0x5dd957(0x164)](_0x5dd957(0x1f4),_0xbf0ffe);const _0x56a3c1=_0x26c3aa['params']['id'],_0x408486=await purchases['findById'](_0x56a3c1);console[_0x5dd957(0x164)](_0x408486);const _0x27adca=await suppliers[_0x5dd957(0x1f7)]({'name':_0x408486['suppliers']});console[_0x5dd957(0x164)](_0x27adca);if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]=='English\x20(US)'){var _0x383b07=users[_0x5dd957(0x1a1)];console[_0x5dd957(0x164)](_0x383b07);}else{if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]==_0x5dd957(0x181))var _0x383b07=users['Hindi'];else{if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]=='German')var _0x383b07=users[_0x5dd957(0x26a)];else{if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]==_0x5dd957(0x229))var _0x383b07=users[_0x5dd957(0x229)];else{if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]==_0x5dd957(0x182))var _0x383b07=users[_0x5dd957(0x182)];else{if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]==_0x5dd957(0x24c))var _0x383b07=users[_0x5dd957(0x275)];else{if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]=='Chinese')var _0x383b07=users[_0x5dd957(0x177)];else{if(_0xbf0ffe[0x0][_0x5dd957(0x1be)]==_0x5dd957(0x1c6))var _0x383b07=users[_0x5dd957(0x271)];}}}}}}}_0x40c93c[_0x5dd957(0x1ad)]('purchase_invoice',{'success':_0x26c3aa['flash'](_0x5dd957(0x268)),'errors':_0x26c3aa[_0x5dd957(0x22b)]('errors'),'role':_0x309744,'profile':_0x514fbd,'master_shop':_0xbf0ffe,'supplier':_0x27adca,'purchase':_0x408486,'language':_0x383b07});}catch(_0x1d2e00){console['log'](_0x1d2e00);}}),router[a0_0x3b25bd(0x1e7)](a0_0x3b25bd(0x1c0),auth,async(_0x3412eb,_0x55e985)=>{var _0x17941c=a0_0x3b25bd;try{const {username:_0x5bd3a1,email:_0x4817b0,role:_0x30e970}=_0x3412eb[_0x17941c(0x25f)],_0x37e94f=_0x3412eb['user'],_0x230279=await profile[_0x17941c(0x1f7)]({'email':_0x37e94f[_0x17941c(0x1e4)]}),_0xed27fe=await master_shop[_0x17941c(0x1fe)]();console[_0x17941c(0x164)](_0x17941c(0x1f4),_0xed27fe);const _0x356a08=_0x3412eb[_0x17941c(0x198)]['id'];console[_0x17941c(0x164)](_0x356a08);const _0xcf6152=await purchases[_0x17941c(0x165)](_0x356a08);console[_0x17941c(0x164)]('user_id',_0xcf6152);const _0x3a4ef8=await product[_0x17941c(0x1fe)]({}),_0x5ed431=await warehouse[_0x17941c(0x272)]([{'$match':{'name':_0xcf6152[_0x17941c(0x267)],'room':_0xcf6152['room'],'warehouse_category':_0x17941c(0x19d)}},{'$unwind':_0x17941c(0x250)},{'$group':{'_id':_0x17941c(0x17a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x17941c(0x281)},'bay':{'$first':_0x17941c(0x265)},'bin':{'$first':_0x17941c(0x161)},'type':{'$first':_0x17941c(0x1e2)},'floorlevel':{'$first':_0x17941c(0x1df)},'primary_code':{'$first':_0x17941c(0x258)},'secondary_code':{'$first':_0x17941c(0x1b4)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x17941c(0x168)},'rack':{'$first':'$product_details.rack'}}}]);warehouse_data=await warehouse[_0x17941c(0x272)]([{'$match':{'status':_0x17941c(0x192),'name':_0x17941c(0x1b7),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x17941c(0x162),'name':{'$first':_0x17941c(0x162)}}},{'$sort':{'name':0x1}}]),console[_0x17941c(0x164)](_0x17941c(0x279),_0x5ed431);if(_0xed27fe[0x0]['language']==_0x17941c(0x1a4)){var _0x2e5148=users[_0x17941c(0x1a1)];console['log'](_0x2e5148);}else{if(_0xed27fe[0x0][_0x17941c(0x1be)]==_0x17941c(0x181))var _0x2e5148=users['Hindi'];else{if(_0xed27fe[0x0][_0x17941c(0x1be)]=='German')var _0x2e5148=users[_0x17941c(0x26a)];else{if(_0xed27fe[0x0][_0x17941c(0x1be)]==_0x17941c(0x229))var _0x2e5148=users['Spanish'];else{if(_0xed27fe[0x0][_0x17941c(0x1be)]==_0x17941c(0x182))var _0x2e5148=users['French'];else{if(_0xed27fe[0x0][_0x17941c(0x1be)]==_0x17941c(0x24c))var _0x2e5148=users['Portuguese'];else{if(_0xed27fe[0x0][_0x17941c(0x1be)]=='Chinese')var _0x2e5148=users['Chinese'];else{if(_0xed27fe[0x0]['language']==_0x17941c(0x1c6))var _0x2e5148=users[_0x17941c(0x271)];}}}}}}}_0x55e985[_0x17941c(0x1ad)](_0x17941c(0x210),{'success':_0x3412eb[_0x17941c(0x22b)](_0x17941c(0x268)),'errors':_0x3412eb[_0x17941c(0x22b)](_0x17941c(0x246)),'role':_0x37e94f,'profile':_0x230279,'user':_0xcf6152,'stock':_0x5ed431,'master_shop':_0xed27fe,'product':_0x3a4ef8,'language':_0x2e5148,'warehouse':warehouse_data});}catch(_0x3d204c){console[_0x17941c(0x164)](_0x3d204c);}}),router[a0_0x3b25bd(0x1bf)](a0_0x3b25bd(0x1c0),auth,async(_0x4806e8,_0x35c501)=>{var _0xdb2d7c=a0_0x3b25bd;try{const {invoice:_0x5f454f,date:_0x58a141,warehouse_name:_0x432ce9,Room_name:_0x1636d9,product_name:_0x5ca973,purchase_quantity:_0x19b1a2,stocks:_0x92223a,return_qty:_0x48a16b,note:_0xc82078,level:_0x1bbd85,isle:_0x10e469,pallet:_0x19ddb9,to_warehouse_name:_0x5dfa52,to_Room_name:_0x26540e}=_0x4806e8['body'],_0x100afc=await purchases[_0xdb2d7c(0x1f7)]({'_id':_0x4806e8['params']['id']}),_0x1db90b=await warehouse[_0xdb2d7c(0x1f7)]({'name':_0x432ce9,'room':_0x1636d9});if(typeof _0x5ca973==_0xdb2d7c(0x206))var _0x47485c=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x175)]],_0x26bf16=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x209)]],_0x5455f3=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x252)]],_0x4d9227=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x205)]],_0x50f307=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x176)]],_0x2fcf0f=[_0x4806e8['body'][_0xdb2d7c(0x1ec)]],_0x20ee65=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x24e)]],_0x2658ac=[_0x4806e8['body'][_0xdb2d7c(0x166)]],_0x3b00df=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x16b)]],_0x838e2c=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x17e)]],_0x50d4ab=[_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x1ee)]];else var _0x47485c=[..._0x4806e8['body'][_0xdb2d7c(0x175)]],_0x26bf16=[..._0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x209)]],_0x5455f3=[..._0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x252)]],_0x4d9227=[..._0x4806e8['body'][_0xdb2d7c(0x205)]],_0x50f307=[..._0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x176)]],_0x2fcf0f=[..._0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x1ec)]],_0x20ee65=[..._0x4806e8['body'][_0xdb2d7c(0x24e)]],_0x2658ac=[..._0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x166)]],_0x3b00df=[..._0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x16b)]],_0x838e2c=[..._0x4806e8[_0xdb2d7c(0x20d)]['primary_code_hide']],_0x50d4ab=[..._0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x1ee)]];const _0x15037f=_0x47485c[_0xdb2d7c(0x185)](_0x5aafec=>{return _0x5aafec={'product_name':_0x5aafec};});_0x26bf16[_0xdb2d7c(0x163)]((_0x5e4781,_0x53e902)=>{_0x15037f[_0x53e902]['purchase_quantity']=_0x5e4781;}),_0x5455f3['forEach']((_0x299562,_0x14d0a7)=>{_0x15037f[_0x14d0a7]['stock_quantity']=_0x299562;}),_0x4d9227[_0xdb2d7c(0x163)]((_0x928454,_0x38ce60)=>{var _0x4bb3a3=_0xdb2d7c;_0x15037f[_0x38ce60][_0x4bb3a3(0x205)]=_0x928454;}),_0x50f307[_0xdb2d7c(0x163)]((_0x57ea49,_0x411bae)=>{var _0x5ab803=_0xdb2d7c;_0x15037f[_0x411bae][_0x5ab803(0x1e9)]=_0x57ea49;}),_0x2fcf0f[_0xdb2d7c(0x163)]((_0x58a1ea,_0x37fa58)=>{var _0x4559d3=_0xdb2d7c;_0x15037f[_0x37fa58][_0x4559d3(0x19a)]=_0x58a1ea;}),_0x20ee65[_0xdb2d7c(0x163)]((_0x5c14d4,_0x166c20)=>{var _0x47cc4a=_0xdb2d7c;_0x15037f[_0x166c20][_0x47cc4a(0x19e)]=_0x5c14d4;}),_0x2658ac[_0xdb2d7c(0x163)]((_0x1d5ebb,_0x49162f)=>{var _0x5323c3=_0xdb2d7c;_0x15037f[_0x49162f][_0x5323c3(0x203)]=_0x1d5ebb;}),_0x3b00df['forEach']((_0x489467,_0x2bae9e)=>{_0x15037f[_0x2bae9e]['product_code']=_0x489467;}),_0x838e2c[_0xdb2d7c(0x163)]((_0x2d83d5,_0x523ae3)=>{_0x15037f[_0x523ae3]['primary_code']=_0x2d83d5;}),_0x50d4ab[_0xdb2d7c(0x163)]((_0x23349a,_0x2b0d6d)=>{var _0x56fa0c=_0xdb2d7c;_0x15037f[_0x2b0d6d][_0x56fa0c(0x1b9)]=_0x23349a;}),_0x100afc[_0xdb2d7c(0x178)][_0xdb2d7c(0x163)](_0xb8ab3e=>{var _0x4b433e=_0xdb2d7c;const _0x5c5a99=_0x1db90b['product_details'][_0x4b433e(0x185)](_0x2c736a=>{var _0x3ca888=_0x4b433e;_0x2c736a[_0x3ca888(0x175)]==_0xb8ab3e[_0x3ca888(0x175)]&&_0x2c736a[_0x3ca888(0x19e)]==_0xb8ab3e['floorlevel']&&_0x2c736a['type']==_0xb8ab3e[_0x3ca888(0x203)]&&_0x2c736a[_0x3ca888(0x19a)]==_0xb8ab3e[_0x3ca888(0x19a)]&&_0x2c736a[_0x3ca888(0x1e9)]==_0xb8ab3e[_0x3ca888(0x1e9)]&&_0x2c736a['rack']==_0xb8ab3e[_0x3ca888(0x167)]&&_0x2c736a['storage']==_0xb8ab3e[_0x3ca888(0x18e)]&&(console[_0x3ca888(0x164)](parseInt(_0x2c736a[_0x3ca888(0x23c)])+'\x20<>\x20'+parseInt(_0xb8ab3e[_0x3ca888(0x1ed)])),_0x2c736a[_0x3ca888(0x23c)]=parseInt(_0x2c736a['product_stock'])+parseInt(_0xb8ab3e['quantity']));});}),await _0x1db90b['save']();const _0x2e922f=_0x15037f['filter'](_0x364ebd=>_0x364ebd[_0xdb2d7c(0x205)]!=='0'&&_0x364ebd['return_qty']!=='');var _0xac92c4=0x0;_0x2e922f[_0xdb2d7c(0x163)](_0x478193=>{var _0x3ef6b5=_0xdb2d7c;console[_0x3ef6b5(0x164)]('foreach\x20newproduct',_0x478193),(parseInt(_0x478193['purchase_quantity'])<parseInt(_0x478193[_0x3ef6b5(0x205)])||parseInt(_0x478193[_0x3ef6b5(0x1fc)])<parseInt(_0x478193[_0x3ef6b5(0x205)]))&&_0xac92c4++;});if(_0xac92c4!=0x0)return _0x4806e8[_0xdb2d7c(0x22b)](_0xdb2d7c(0x246),_0xdb2d7c(0x1a5)),_0x35c501[_0xdb2d7c(0x202)](_0xdb2d7c(0x22e));const _0x127fd6=new purchases_return({'invoice':_0x5f454f,'suppliers':_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x27c)],'date':_0x58a141,'warehouse_name':_0x432ce9,'return_product':_0x2e922f,'note':_0xc82078,'room':_0x1636d9,'to_warehouse_name':_0x5dfa52,'to_room':_0x26540e}),_0x2b298b=await _0x127fd6[_0xdb2d7c(0x1c9)]();console['log'](_0x127fd6);const _0x47567f=await purchases_return[_0xdb2d7c(0x1f7)]({'invoice':_0x5f454f}),_0x103f65=await warehouse['findOne']({'name':_0x5dfa52,'room':_0x26540e});_0x47567f[_0xdb2d7c(0x1cd)][_0xdb2d7c(0x163)](_0x42ee20=>{var _0x30e33b=_0xdb2d7c,_0x4438b3=0x0;const _0x22fdf7=_0x103f65[_0x30e33b(0x16f)][_0x30e33b(0x185)](_0x52980b=>{var _0x5325a5=_0x30e33b;_0x52980b[_0x5325a5(0x175)]==_0x42ee20['product_name']&&_0x52980b[_0x5325a5(0x19e)]==_0x42ee20[_0x5325a5(0x19e)]&&_0x52980b['type']==_0x42ee20[_0x5325a5(0x203)]&&_0x52980b[_0x5325a5(0x19a)]==_0x42ee20[_0x5325a5(0x19a)]&&_0x52980b[_0x5325a5(0x1e9)]==_0x42ee20[_0x5325a5(0x1e9)]&&(_0x52980b['product_stock']=parseInt(_0x52980b['product_stock'])-parseInt(_0x42ee20[_0x5325a5(0x205)]),_0x4438b3++);});_0x4438b3=='0'&&(_0x103f65[_0x30e33b(0x16f)]=_0x103f65['product_details'][_0x30e33b(0x1a2)]({'product_name':_0x42ee20[_0x30e33b(0x175)],'product_stock':_0x42ee20[_0x30e33b(0x205)],'primary_code':_0x42ee20['primary_code'],'secondary_code':_0x42ee20[_0x30e33b(0x1b9)],'product_code':_0x42ee20[_0x30e33b(0x1e6)],'storage':_0x42ee20[_0x30e33b(0x18e)],'rack':_0x42ee20[_0x30e33b(0x167)],'bay':_0x42ee20['bay'],'bin':_0x42ee20['bin'],'type':_0x42ee20['type'],'floorlevel':_0x42ee20[_0x30e33b(0x19e)],'maxProducts':_0x42ee20['maxStocks'],'unit':_0x42ee20['standard_unit'],'secondary_unit':_0x42ee20['secondary_unit'],'expiry_date':_0x42ee20[_0x30e33b(0x18f)]}));}),await _0x103f65[_0xdb2d7c(0x1c9)]();const _0x281728=await purchases['findOne']({'invoice':_0x5f454f});_0x281728['return_data']=_0xdb2d7c(0x23f);const _0x42f9ed=await _0x281728[_0xdb2d7c(0x1c9)](),_0x11b861=new s_payment_data({'invoice':_0x5f454f,'suppliers':_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x27c)],'reason':_0xdb2d7c(0x1da)});await _0x11b861[_0xdb2d7c(0x1c9)]();const _0x3b9284=await master_shop[_0xdb2d7c(0x1fe)]();console[_0xdb2d7c(0x164)]('add\x20post',_0x3b9284[0x0][_0xdb2d7c(0x266)]);const _0x2c9371=await email_settings['findOne'](),_0x508f30=await suppliers[_0xdb2d7c(0x1f7)]({'name':_0x4806e8[_0xdb2d7c(0x20d)][_0xdb2d7c(0x27c)]});console['log'](_0xdb2d7c(0x1ab),_0x508f30);_0x3b9284[0x0][_0xdb2d7c(0x170)]==0x1?(right_currency=_0x3b9284[0x0][_0xdb2d7c(0x27b)],left_currency=''):(right_currency='',left_currency=_0x3b9284[0x0][_0xdb2d7c(0x27b)]);var _0x2bd789=_0x47485c,_0x3c6d23=_0x4d9227,_0x5b95ae='',_0x1bbe1b;for(_0x1bbe1b in _0x2bd789){_0x5b95ae+=_0xdb2d7c(0x219)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2bd789[_0x1bbe1b]+'</td>'+_0xdb2d7c(0x232)+_0x3c6d23[_0x1bbe1b]+_0xdb2d7c(0x1d8)+_0xdb2d7c(0x223);}console[_0xdb2d7c(0x164)](_0xdb2d7c(0x22f),_0x5b95ae);let _0x3d3a9f=nodemailer['createTransport']({'service':_0xdb2d7c(0x204),'auth':{'user':_0x2c9371[_0xdb2d7c(0x1e4)],'pass':_0x2c9371['password']}}),_0xf75931={'from':_0x2c9371[_0xdb2d7c(0x1e4)],'to':_0x508f30[_0xdb2d7c(0x1e4)],'subject':'Purchase\x20Return\x20Mail','attachments':[{'filename':_0xdb2d7c(0x261),'path':__dirname+_0xdb2d7c(0x22a)+_0xdb2d7c(0x227)+_0x3b9284[0x0][_0xdb2d7c(0x266)],'cid':_0xdb2d7c(0x21a)}],'html':_0xdb2d7c(0x282)+'<html><head><title></title>'+'</head><body>'+'<div>'+_0xdb2d7c(0x1d9)+_0xdb2d7c(0x25c)+_0xdb2d7c(0x1eb)+'</div>'+_0xdb2d7c(0x25c)+_0xdb2d7c(0x1db)+_0x3b9284[0x0][_0xdb2d7c(0x248)]+_0xdb2d7c(0x188)+_0xdb2d7c(0x207)+_0xdb2d7c(0x207)+'<hr\x20class=\x22my-3\x22>'+_0xdb2d7c(0x25c)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0xdb2d7c(0x19f)+_0x5f454f+'\x20'+_0xdb2d7c(0x242)+'\x20Order\x20Date\x20:\x20'+_0x58a141+'\x20'+_0xdb2d7c(0x220)+'</h5>'+'</div>'+_0xdb2d7c(0x277)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xdb2d7c(0x219)+_0xdb2d7c(0x233)+_0xdb2d7c(0x1ff)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>'+_0xdb2d7c(0x230)+_0xdb2d7c(0x223)+_0xdb2d7c(0x194)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x5b95ae+'\x20'+_0xdb2d7c(0x21d)+_0xdb2d7c(0x19b)+_0xdb2d7c(0x25c)+_0xdb2d7c(0x17d)+_0xdb2d7c(0x1de)+_0x3b9284[0x0]['site_title']+_0xdb2d7c(0x1f9)+_0xdb2d7c(0x207)+_0xdb2d7c(0x207)+_0xdb2d7c(0x213)};_0x3d3a9f[_0xdb2d7c(0x1ea)](_0xf75931,function(_0x42459b,_0x436a31){var _0x3a545f=_0xdb2d7c;_0x42459b?(console[_0x3a545f(0x164)](_0x42459b),console[_0x3a545f(0x164)](_0x3a545f(0x173))):console['log'](_0x3a545f(0x1d6));}),_0x4806e8[_0xdb2d7c(0x22b)]('success','purchases\x20item\x20return\x20successfull'),_0x35c501[_0xdb2d7c(0x202)](_0xdb2d7c(0x1b2));}catch(_0x5282df){console[_0xdb2d7c(0x164)](_0x5282df),_0x35c501[_0xdb2d7c(0x1c4)](0xc8)[_0xdb2d7c(0x20a)]({'message':_0x5282df['message']});}}),router[a0_0x3b25bd(0x1e7)](a0_0x3b25bd(0x26f),auth,async(_0x3c9db2,_0x247b9c)=>{var _0x2f195e=a0_0x3b25bd;try{const {username:_0x5751f0,email:_0x57867f,role:_0x19d73a}=_0x3c9db2['user'],_0x5cf118=_0x3c9db2[_0x2f195e(0x25f)],_0x171bbf=await profile[_0x2f195e(0x1f7)]({'email':_0x5cf118[_0x2f195e(0x1e4)]}),_0xe34b8c=await master_shop[_0x2f195e(0x1fe)](),_0x3dfcdb=_0x3c9db2[_0x2f195e(0x198)]['id'],_0x4a26a5=await purchases[_0x2f195e(0x165)](_0x3dfcdb);if(_0xe34b8c[0x0][_0x2f195e(0x1be)]==_0x2f195e(0x1a4))var _0x54ba43=users[_0x2f195e(0x1a1)];else{if(_0xe34b8c[0x0][_0x2f195e(0x1be)]=='Hindi')var _0x54ba43=users['Hindi'];else{if(_0xe34b8c[0x0][_0x2f195e(0x1be)]==_0x2f195e(0x26a))var _0x54ba43=users[_0x2f195e(0x26a)];else{if(_0xe34b8c[0x0][_0x2f195e(0x1be)]==_0x2f195e(0x229))var _0x54ba43=users['Spanish'];else{if(_0xe34b8c[0x0]['language']==_0x2f195e(0x182))var _0x54ba43=users[_0x2f195e(0x182)];else{if(_0xe34b8c[0x0][_0x2f195e(0x1be)]==_0x2f195e(0x24c))var _0x54ba43=users['Portuguese'];else{if(_0xe34b8c[0x0]['language']==_0x2f195e(0x177))var _0x54ba43=users[_0x2f195e(0x177)];else{if(_0xe34b8c[0x0][_0x2f195e(0x1be)]==_0x2f195e(0x1c6))var _0x54ba43=users[_0x2f195e(0x271)];}}}}}}}_0x247b9c['render'](_0x2f195e(0x25d),{'success':_0x3c9db2[_0x2f195e(0x22b)](_0x2f195e(0x268)),'errors':_0x3c9db2['flash'](_0x2f195e(0x246)),'role':_0x5cf118,'profile':_0x171bbf,'alldata':_0x4a26a5,'master_shop':_0xe34b8c,'language':_0x54ba43}),console[_0x2f195e(0x164)](alldata);}catch(_0x5ade21){console[_0x2f195e(0x164)](_0x5ade21);}}),router[a0_0x3b25bd(0x1bf)](a0_0x3b25bd(0x262),async(_0x4641b7,_0xc2c090)=>{var _0x3d0b1a=a0_0x3b25bd;const {product_code:_0x523a41}=_0x4641b7[_0x3d0b1a(0x20d)];var _0x38d1e6;const _0x241120=await product[_0x3d0b1a(0x272)]([{'$match':{'primary_code':_0x523a41,'product_category':_0x3d0b1a(0x19d)}},{'$group':{'_id':_0x3d0b1a(0x24b),'name':{'$first':_0x3d0b1a(0x162)},'category':{'$first':_0x3d0b1a(0x1d0)},'brand':{'$first':_0x3d0b1a(0x160)},'unit':{'$first':_0x3d0b1a(0x22c)},'alertquantity':{'$first':'$alertquantity'},'product_code':{'$first':_0x3d0b1a(0x183)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x3d0b1a(0x235)},'maxStocks':{'$first':_0x3d0b1a(0x200)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x3d0b1a(0x239)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x4dbfce=await product[_0x3d0b1a(0x272)]([{'$match':{'secondary_code':_0x523a41,'product_category':_0x3d0b1a(0x19d)}},{'$group':{'_id':_0x3d0b1a(0x24b),'name':{'$first':'$name'},'category':{'$first':_0x3d0b1a(0x1d0)},'brand':{'$first':_0x3d0b1a(0x160)},'unit':{'$first':_0x3d0b1a(0x22c)},'alertquantity':{'$first':_0x3d0b1a(0x18d)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x3d0b1a(0x239)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x241120['length']>0x0)_0x38d1e6=_0x241120;else _0x4dbfce[_0x3d0b1a(0x21c)]>0x0&&(_0x38d1e6=_0x4dbfce);_0xc2c090['json'](_0x38d1e6);}),router[a0_0x3b25bd(0x1bf)](a0_0x3b25bd(0x247),async(_0x50407c,_0x36e1aa)=>{var _0x37cb64=a0_0x3b25bd;const {primaryCode:_0x45a2f9,secondaryCode:_0x188f0b,productCode:_0x5751e5,bay:_0x589f69,bin:_0x38cc17,types:_0x312636,pallet:_0x3cfe40,warehouses:_0x11425d,room:_0x2ba9cd}=_0x50407c[_0x37cb64(0x20d)];console[_0x37cb64(0x164)](_0x50407c['body']);try{const _0x2b92d8=await warehouse['aggregate']([{'$match':{'name':_0x11425d,'room':_0x2ba9cd}},{'$unwind':_0x37cb64(0x250)},{'$match':{'product_details.bay':_0x589f69,'product_details.bin':_0x38cc17,'product_details.type':_0x312636}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x37cb64(0x1dc)},'product_stock':{'$first':_0x37cb64(0x281)},'level':{'$first':_0x37cb64(0x1e5)},'isle':{'$first':_0x37cb64(0x214)},'pallet':{'$first':_0x37cb64(0x1d4)},'maxProducts':{'$first':_0x37cb64(0x228)}}}]);_0x36e1aa['status'](0xc8)[_0x37cb64(0x20a)](_0x2b92d8);}catch(_0x2734c2){_0x36e1aa[_0x37cb64(0x1c4)](0x194)['json']({'message':_0x2734c2[_0x37cb64(0x224)]});}}),module[a0_0x3b25bd(0x1a9)]=router;function a0_0xb64d(){var _0x315a37=['Rack\x20B','Rack\x20A','findOne','Purchase\x20Mail','</h5>','payment\x20successfull','prod_cat','stock_quantity','password','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$maxStocks','$warehouse_name','redirect','type','gmail','return_qty','string','</div>','edit_purchases','purchase_quantity','json','$product_details.rack','nodemailer','body','\x20Order\x20Date\x20:\x20','all','return_purchase','prod_name','1220262iEeAFr','</body></html>','$product_details.isle','\x20<\x20wew\x20>\x20','push','180426IPOGUK','$product','<tr>','logo','/view/add_purchases/:id','length','</tbody>','secondary_unit','warehouse','</span>','room','rak','</tr>','message','$finalize','INC-','/upload/','$product_details.maxProducts','Spanish','/../public','flash','$unit','$paid_amount','back','product_list','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$batch_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','invoice','$secondary_code','suppliers_docs','prod_unit','$due_amount','$secondary_unit','../public/language/languages.json','prod_isle','product_stock','deliverycode','Level','True','note','actual_qty','<span\x20style=\x22float:\x20right;\x22>','/view','Rack\x20F','Purchase\x20data\x20added\x20successfully','errors','/CheckingWarehouse','site_title','prod_primunit','$product.type','$_id','Portuguese\x20(BR)','primary_code','pallet','\x20<>\x20','$product_details','room_name','stocks','347110aMlOfm','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product.floorlevel','delivery_code','staff','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','purchase\x20data\x20update\x20successfully','$room','<div>','all_purchases_barcode','$product_details.expiry_date','user','COLD\x20STORAGE','Logo.png','/barcode_scanner','$product_details.product_code','getDate','$product_details.bay','image','warehouse_name','success','RoomAssign','German','Receiving\x20Area','<h5\x20style=\x22text-align:\x20left;\x22>','padStart','alertQTY','/barcode/:id','max_product_unit','Arabic','aggregate','1128816xWTZkz','Enclosed','Portuguese','7448RWYBRw','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<hr\x20class=\x22my-3\x22>','stock_data','delivery_date','currency','suppliers','due_amount','role','filter','maxperunit','$product_details.product_stock','<!DOCTYPE\x20html>','maxStocks','$brand','$product_details.bin','$name','forEach','log','findById','types','rack','$product_details.storage','edit_purchases_view','Router','product_code_hide','MaxStocks_data','prod_qty','360sZgKdl','product_details','currency_placement','then','slice','Error\x20Occurs','path','product_name','level','Chinese','product','port','$product_details._id','/invoice/:id','$expiry_date','<strong>\x20Regards\x20</strong>','primary_code_hide','error','finalize','Hindi','French','$product_code','$note','map','table\x20page','date','\x20</h2>','random','Floor','add_purchases','prod_code','$alertquantity','storage','expiry_date','prod_Qty','DRY\x20STORAGE','Enabled','Shelves','</thead>','/give_payment/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','../models/all_models','params','2313VrXShc','bin','</table>','paid_amount','Raw\x20Materials','floorlevel','\x20Order\x20Number\x20:\x20','all_purchases','English','concat','</head><body>','English\x20(US)','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','add_purchases\x20error','production_date','../middleware/auth','exports','name','suppliers_data','Rack\x20C','render','host','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$date','30506zhJbbh','/all_purchases/view','batch_code','$product_details.secondary_code','$suppliers_docs','<tbody\x20style=\x22text-align:\x20center;\x22>','Return\x20Goods','Rack\x20E','secondary_code','$product.bay','createTransport','/all_purchases/view/','$suppliers','language','post','/view/return_purchase/:id','RMSEmail','express','$product.room_name','status','toString','Arabic\x20(ae)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product.quantity','save','Room_name','Sales\x20Update\x20successfully','/preview/:id','return_product','prod_level','prod_pallet','$category','prod_secondunit','standard_unit','$invoice','$product_details.pallet','$return_data','Email\x20sent\x20successfully','$product.bin','</td>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Purchase\x20Return','<h2>\x20','$product_details.product_name','447410CCpVvO','<h5>','$product_details.floorlevel','getFullYear','getMonth','$product_details.type','POnumber','email','$product_details.level','product_code','get','floor','bay','sendMail','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','isle','quantity','secondary_code_hide','/view/add_purchases','prod_invoice','Paid\x20For\x20Purchase','/view/:id','catch','master'];a0_0xb64d=function(){return _0x315a37;};return a0_0xb64d();}