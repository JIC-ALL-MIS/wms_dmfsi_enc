var a0_0x1b96eb=a0_0x4b96;(function(_0x163d50,_0xe95c00){var _0x2a3578=a0_0x4b96,_0x5cb532=_0x163d50();while(!![]){try{var _0x56dca6=parseInt(_0x2a3578(0x1ac))/0x1*(-parseInt(_0x2a3578(0x18c))/0x2)+parseInt(_0x2a3578(0x148))/0x3+parseInt(_0x2a3578(0x20f))/0x4*(parseInt(_0x2a3578(0x1df))/0x5)+parseInt(_0x2a3578(0x20a))/0x6+-parseInt(_0x2a3578(0x141))/0x7+parseInt(_0x2a3578(0x1b8))/0x8+-parseInt(_0x2a3578(0x1ce))/0x9*(-parseInt(_0x2a3578(0x1eb))/0xa);if(_0x56dca6===_0xe95c00)break;else _0x5cb532['push'](_0x5cb532['shift']());}catch(_0x2f33a2){_0x5cb532['push'](_0x5cb532['shift']());}}}(a0_0x4a7d,0xa1db3));const express=require(a0_0x1b96eb(0x19d)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x1b96eb(0x17b)),nodemailer=require(a0_0x1b96eb(0x154));var ejs=require(a0_0x1b96eb(0x14d));const path=require('path'),users=require(a0_0x1b96eb(0x1d0));function a0_0x4b96(_0x58cc21,_0x4f83e5){var _0x4a7d10=a0_0x4a7d();return a0_0x4b96=function(_0x4b96b9,_0x3d06cb){_0x4b96b9=_0x4b96b9-0xf8;var _0x1a40ce=_0x4a7d10[_0x4b96b9];return _0x1a40ce;},a0_0x4b96(_0x58cc21,_0x4f83e5);}router[a0_0x1b96eb(0x1db)](a0_0x1b96eb(0x1dc),auth,async(_0x3dd549,_0x1b657f)=>{var _0x4b89f1=a0_0x1b96eb;try{const {username:_0x175434,email:_0x1af4ab,role:_0x196384}=_0x3dd549[_0x4b89f1(0x144)],_0x5d1d18=_0x3dd549[_0x4b89f1(0x144)],_0x4f9c44=await profile[_0x4b89f1(0x15a)]({'email':_0x5d1d18[_0x4b89f1(0x16b)]}),_0x9b7e05=await staff[_0x4b89f1(0x15a)]({'email':_0x5d1d18['email']});if(_0x5d1d18[_0x4b89f1(0x1b7)]==_0x4b89f1(0x160)){const _0x40fb6a=await staff['findOne']({'email':_0x5d1d18[_0x4b89f1(0x16b)]});}const _0x150e10=await master_shop['find']();let _0x5aae9c;if(_0x5d1d18['role']==_0x4b89f1(0x160)){const _0x7c8255=await staff[_0x4b89f1(0x15a)]({'email':_0x5d1d18[_0x4b89f1(0x16b)]});_0x5aae9c=await purchases['aggregate']([{'$match':{'warehouse_name':_0x7c8255[_0x4b89f1(0x1f8)]}},{'$lookup':{'from':_0x4b89f1(0x165),'localField':'suppliers','foreignField':'name','as':_0x4b89f1(0x136)}},{'$unwind':'$suppliers_docs'},{'$unwind':'$product'},{'$group':{'_id':_0x4b89f1(0x20e),'invoice':{'$first':'$invoice'},'suppliers':{'$first':_0x4b89f1(0x1e5)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x4b89f1(0x125)},'room':{'$first':_0x4b89f1(0x1af)},'product':{'$push':_0x4b89f1(0x1d1)},'note':{'$first':_0x4b89f1(0x194)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x4b89f1(0x13a)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x4b89f1(0x1ed)},'expiry_date':{'$first':_0x4b89f1(0x113)},'suppliers_docs':{'$first':_0x4b89f1(0x1ae)},'total_product_quantity':{'$sum':_0x4b89f1(0x137)},'level':{'$addToSet':_0x4b89f1(0x1d9)},'isle':{'$addToSet':_0x4b89f1(0xff)},'type':{'$addToSet':_0x4b89f1(0x203)},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x5aae9c=await purchases[_0x4b89f1(0x1a6)]([{'$lookup':{'from':_0x4b89f1(0x165),'localField':'suppliers','foreignField':'name','as':_0x4b89f1(0x136)}},{'$unwind':_0x4b89f1(0x1ae)},{'$unwind':_0x4b89f1(0x1d1)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4b89f1(0x1c9)},'suppliers':{'$first':_0x4b89f1(0x1e5)},'date':{'$first':_0x4b89f1(0x124)},'warehouse_name':{'$first':_0x4b89f1(0x125)},'room':{'$addToSet':_0x4b89f1(0x114)},'product':{'$push':'$product'},'note':{'$first':_0x4b89f1(0x194)},'paid_amount':{'$first':_0x4b89f1(0x189)},'due_amount':{'$first':_0x4b89f1(0x13a)},'return_data':{'$first':_0x4b89f1(0x1cd)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x4b89f1(0x113)},'suppliers_docs':{'$first':_0x4b89f1(0x1ae)},'total_product_quantity':{'$sum':_0x4b89f1(0x137)},'level':{'$addToSet':_0x4b89f1(0x1d9)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x4b89f1(0x203)},'floorlevel':{'$addToSet':_0x4b89f1(0x10f)},'finalize':{'$first':_0x4b89f1(0x153)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x150e10[0x0]['language']=='English\x20(US)'){var _0x3b824f=users[_0x4b89f1(0x171)];console[_0x4b89f1(0x1c0)](_0x3b824f);}else{if(_0x150e10[0x0][_0x4b89f1(0x1cc)]==_0x4b89f1(0x19c))var _0x3b824f=users[_0x4b89f1(0x19c)];else{if(_0x150e10[0x0]['language']=='German')var _0x3b824f=users[_0x4b89f1(0x212)];else{if(_0x150e10[0x0][_0x4b89f1(0x1cc)]==_0x4b89f1(0x18b))var _0x3b824f=users['Spanish'];else{if(_0x150e10[0x0][_0x4b89f1(0x1cc)]==_0x4b89f1(0x201))var _0x3b824f=users[_0x4b89f1(0x201)];else{if(_0x150e10[0x0][_0x4b89f1(0x1cc)]=='Portuguese\x20(BR)')var _0x3b824f=users[_0x4b89f1(0x1ff)];else{if(_0x150e10[0x0][_0x4b89f1(0x1cc)]==_0x4b89f1(0x1fb))var _0x3b824f=users[_0x4b89f1(0x1fb)];else{if(_0x150e10[0x0][_0x4b89f1(0x1cc)]=='Arabic\x20(ae)')var _0x3b824f=users[_0x4b89f1(0x185)];}}}}}}}_0x1b657f[_0x4b89f1(0x1dd)](_0x4b89f1(0x214),{'success':_0x3dd549[_0x4b89f1(0x138)](_0x4b89f1(0x164)),'errors':_0x3dd549[_0x4b89f1(0x138)]('errors'),'purchases':_0x5aae9c,'role':_0x5d1d18,'profile':_0x4f9c44,'master_shop':_0x150e10,'language':_0x3b824f});}catch(_0x1eefb1){console['log'](_0x4b89f1(0x116),_0x1eefb1),_0x1b657f[_0x4b89f1(0x173)](0xc8)[_0x4b89f1(0x13f)]({'message':_0x1eefb1['message']});}});function BayBinSelected(_0x4e9888,_0x1e9814){var _0x36ec7d=a0_0x1b96eb,_0x36a41c=[],_0x4681b9=[],_0x5407ed=[],_0x43c855=[],_0x2bc2ff=[],_0x1d7d01=[];let _0x1fe15c=[];if(_0x4e9888=='DRY\x20STORAGE')switch(_0x1e9814){case _0x36ec7d(0x14c):_0x36a41c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4681b9=[0x1,0x2],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=[_0x36ec7d(0x1d2),_0x36ec7d(0xf9)],_0x2bc2ff=['D'],_0x1d7d01=['A'];break;case _0x36ec7d(0x11f):_0x36a41c=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4681b9=[0x1,0x2],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=[_0x36ec7d(0x1d2),_0x36ec7d(0xf9)],_0x2bc2ff=['D'],_0x1d7d01=['B'];break;case'Shelves':_0x36a41c=[0x0],_0x4681b9=[0x0],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=['Floor'],_0x2bc2ff=['D'],_0x1d7d01=['S'];break;case _0x36ec7d(0x111):_0x36a41c=[0x0],_0x4681b9=[0x0],_0x43c855=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5407ed=[_0x36ec7d(0xf9)],_0x2bc2ff=['D'],_0x1d7d01=['R'];break;}else{if(_0x4e9888==_0x36ec7d(0x14b))switch(_0x1e9814){case _0x36ec7d(0x14c):_0x36a41c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4681b9=['B','F'],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=[_0x36ec7d(0x1d2),_0x36ec7d(0xf9)],_0x2bc2ff=['C'],_0x1d7d01=['A'];break;case'Rack\x20B':_0x36a41c=[0x5,0x4,0x3,0x2,0x1],_0x4681b9=['F','B','S'],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=['Level',_0x36ec7d(0xf9)],_0x2bc2ff=['C'],_0x1d7d01=['B'];break;case _0x36ec7d(0x1a2):_0x36a41c=[0x1,0x2,0x3,0x4,0x5],_0x4681b9=['B','F','S'],_0x43c855=[0x5,0x4,0x3,0x2,0x1],_0x5407ed=['Level',_0x36ec7d(0xf9)],_0x2bc2ff=['C'],_0x1d7d01=['C'];break;case _0x36ec7d(0x183):_0x36a41c=[0x5,0x4,0x3,0x2,0x1],_0x4681b9=['F','B','S'],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=[_0x36ec7d(0x1d2),_0x36ec7d(0xf9)],_0x2bc2ff=['C'],_0x1d7d01=['D'];break;case _0x36ec7d(0x21b):_0x36a41c=[0x4,0x3,0x2,0x1],_0x4681b9=[0x1,0x2],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=['Level',_0x36ec7d(0xf9)],_0x2bc2ff=['C'],_0x1d7d01=['E'];break;case _0x36ec7d(0x1c3):_0x36a41c=[0x1,0x2,0x3],_0x4681b9=[0x1,0x2],_0x43c855=[0x1,0x2,0x3,0x4,0x5],_0x5407ed=['Level'],_0x2bc2ff=['C'],_0x1d7d01=['F'];break;}}return{'levels':_0x36a41c,'Isle':_0x4681b9,'rack':_0x43c855,'type':_0x5407ed,'storage':_0x2bc2ff,'rak':_0x1d7d01};}async function getRandom8DigitNumber(){var _0x5c45e5=a0_0x1b96eb;const _0x5e80aa=0x989680,_0x3d51e7=0x5f5e0ff,_0x3f0330=Math[_0x5c45e5(0x1cb)](Math[_0x5c45e5(0x197)]()*(_0x3d51e7-_0x5e80aa+0x1))+_0x5e80aa;var _0x4663aa;const _0x3ad6e4=await purchases[_0x5c45e5(0x15a)]({'invoice':_0x5c45e5(0x122)+_0x3f0330});return _0x3ad6e4&&_0x3ad6e4[_0x5c45e5(0x1de)]>0x0?_0x4663aa='INC-'+_0x3f0330:_0x4663aa=_0x5c45e5(0x122)+_0x3f0330,_0x4663aa;}router[a0_0x1b96eb(0x1db)](a0_0x1b96eb(0x1e1),auth,async(_0x2bcfcf,_0x21687a)=>{var _0x4513e4=a0_0x1b96eb;try{const {username:_0x2c6002,email:_0x43858b,role:_0x4d295c}=_0x2bcfcf['user'],_0x1ec058=_0x2bcfcf['user'],_0x4635e4=await profile['findOne']({'email':_0x1ec058[_0x4513e4(0x16b)]}),_0x23530f=await master_shop[_0x4513e4(0x110)](),_0x1c2b06=await staff[_0x4513e4(0x15a)]({'email':_0x1ec058[_0x4513e4(0x16b)]}),_0xc0fe3=await suppliers['find']({});let _0x3ab465;if(_0x1ec058[_0x4513e4(0x1b7)]==_0x4513e4(0x160)){const _0xb12dcf=await staff[_0x4513e4(0x15a)]({'email':_0x1ec058[_0x4513e4(0x16b)]});_0x3ab465=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0xb12dcf[_0x4513e4(0x1f8)],'warehouse_category':_0x4513e4(0x1b0),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x4513e4(0x179),'name':{'$first':_0x4513e4(0x179)}}}]);}else _0x3ab465=await warehouse[_0x4513e4(0x1a6)]([{'$match':{'status':_0x4513e4(0x14e),'warehouse_category':_0x4513e4(0x1b0),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0xda5772=await product[_0x4513e4(0x110)]({}),_0x41d7de=await warehouse[_0x4513e4(0x110)]({'status':'Enabled'}),_0x399142=await purchases[_0x4513e4(0x110)]({}),_0x1a0a2d=_0x399142[_0x4513e4(0x1de)]+0x1,_0x3ada39='INC-'+_0x1a0a2d[_0x4513e4(0x1aa)]()[_0x4513e4(0x104)](0x5,'0');var _0x58a85d=[_0x4513e4(0x1ee),_0x4513e4(0x103)];if(_0x23530f[0x0]['language']==_0x4513e4(0x213))var _0x16ebfc=users[_0x4513e4(0x171)];else{if(_0x23530f[0x0]['language']==_0x4513e4(0x19c))var _0x16ebfc=users['Hindi'];else{if(_0x23530f[0x0][_0x4513e4(0x1cc)]==_0x4513e4(0x212))var _0x16ebfc=users[_0x4513e4(0x212)];else{if(_0x23530f[0x0][_0x4513e4(0x1cc)]==_0x4513e4(0x18b))var _0x16ebfc=users[_0x4513e4(0x18b)];else{if(_0x23530f[0x0][_0x4513e4(0x1cc)]=='French')var _0x16ebfc=users['French'];else{if(_0x23530f[0x0][_0x4513e4(0x1cc)]==_0x4513e4(0x168))var _0x16ebfc=users[_0x4513e4(0x1ff)];else{if(_0x23530f[0x0][_0x4513e4(0x1cc)]==_0x4513e4(0x1fb))var _0x16ebfc=users[_0x4513e4(0x1fb)];else{if(_0x23530f[0x0]['language']==_0x4513e4(0x12d))var _0x16ebfc=users[_0x4513e4(0x185)];}}}}}}}const _0x1fcf14=getRandom8DigitNumber();_0x1fcf14['then'](_0x5ca3e6=>{var _0x55a374=_0x4513e4;_0x21687a[_0x55a374(0x1dd)](_0x55a374(0x1a1),{'success':_0x2bcfcf['flash'](_0x55a374(0x164)),'errors':_0x2bcfcf[_0x55a374(0x138)]('errors'),'role':_0x1ec058,'profile':_0x4635e4,'suppliers':_0xc0fe3,'warehouse':_0x3ab465,'product':_0xda5772,'invoice':_0x5ca3e6,'master_shop':_0x23530f,'language':_0x16ebfc,'find_data':_0x41d7de,'rooms_data':_0x58a85d});})['catch'](_0x5a8064=>{var _0x174136=_0x4513e4;_0x2bcfcf[_0x174136(0x138)](_0x174136(0x1a4),_0x174136(0x14f)),_0x21687a[_0x174136(0x1f1)](_0x174136(0x156));});}catch(_0x35e483){console['log'](_0x35e483);}}),router[a0_0x1b96eb(0x1db)](a0_0x1b96eb(0x14a),auth,async(_0x4c0f55,_0xe1132e)=>{var _0x486c3e=a0_0x1b96eb;try{const _0x115aef=_0x4c0f55[_0x486c3e(0x115)]['id'];console['log'](_0x115aef);const _0x1d8927=await master_shop[_0x486c3e(0x110)]();console['log']('master',_0x1d8927);const _0x5be6de=await product['findOne']({'name':_0x115aef});console[_0x486c3e(0x1c0)](_0x486c3e(0x142),_0x5be6de),_0xe1132e[_0x486c3e(0x173)](0xc8)[_0x486c3e(0x13f)]({'product_data':_0x5be6de,'master':_0x1d8927});}catch(_0x2659a0){console['log'](_0x486c3e(0x21a),_0x2659a0);}}),router[a0_0x1b96eb(0x206)](a0_0x1b96eb(0x1e1),auth,async(_0x26a707,_0x1ef40e)=>{var _0x3bdfdb=a0_0x1b96eb;try{const {invoice:_0x14cc95,date:_0x48c8ff,warehouse_name:_0x2d663b,prod_name:_0x164525,prod_code:_0x3247a7,prod_qty:_0x10f535,prod_unit:_0x511127,prod_secondunit:_0x3ea7af,prod_level:_0x1d7a05,prod_isle:_0x194605,prod_pallet:_0x41543c,note:_0x31f0ca,expiry_date:_0xabc2f7,batch_code:_0x44079b,payable:_0x2e9590,due_amount:_0x2e3f3f,Room_name:_0x5e34fe,primary_code:_0x24fecf,secondary_code:_0x334d3c,MaxStocks_data:_0xc0a818,PO_number:_0x1b5e6f,SCRN:_0x488876,JO_number:_0x232e3f}=_0x26a707[_0x3bdfdb(0x132)];if(typeof _0x164525==_0x3bdfdb(0x218))var _0x50aeb8=[_0x26a707['body'][_0x3bdfdb(0x1b2)]],_0x218c13=[_0x26a707['body']['prod_code']],_0x42e075=[_0x26a707['body'][_0x3bdfdb(0x1bf)]],_0x142043=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1a0)]],_0xde3f11=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x10d)]],_0x114380=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x139)]],_0x454c61=[_0x26a707['body']['primary_code']],_0x48e89d=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1d6)]],_0x4f692d=[_0x26a707[_0x3bdfdb(0x132)]['MaxStocks_data']],_0x430eca=[_0x26a707['body'][_0x3bdfdb(0x126)]],_0x1676f9=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x117)]],_0x11517b=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x159)]],_0x375c14=[_0x26a707['body'][_0x3bdfdb(0x1a5)]],_0xe54057=[_0x26a707['body'][_0x3bdfdb(0x182)]],_0x4620de=[_0x26a707['body'][_0x3bdfdb(0x1c7)]],_0x25b5d0=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1cf)]],_0x5b1074=[_0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x161)]],_0x337108=[_0x26a707['body'][_0x3bdfdb(0x11d)]],_0x559aae=[_0x26a707['body'][_0x3bdfdb(0x1e2)]];else var _0x50aeb8=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1b2)]],_0x218c13=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1b5)]],_0x42e075=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1bf)]],_0x142043=[..._0x26a707['body'][_0x3bdfdb(0x1a0)]],_0xde3f11=[..._0x26a707[_0x3bdfdb(0x132)]['prod_secondunit']],_0x114380=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x139)]],_0x454c61=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1a7)]],_0x48e89d=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x1d6)]],_0x4f692d=[..._0x26a707['body'][_0x3bdfdb(0x10b)]],_0x430eca=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x126)]],_0x1676f9=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x117)]],_0x11517b=[..._0x26a707['body']['max_product_unit']],_0x375c14=[..._0x26a707['body']['alertQTY']],_0xe54057=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x182)]],_0x4620de=[..._0x26a707['body'][_0x3bdfdb(0x1c7)]],_0x25b5d0=[..._0x26a707[_0x3bdfdb(0x132)]['RoomAssign']],_0x5b1074=[..._0x26a707['body'][_0x3bdfdb(0x161)]],_0x337108=[..._0x26a707[_0x3bdfdb(0x132)][_0x3bdfdb(0x11d)]],_0x559aae=[..._0x26a707['body'][_0x3bdfdb(0x1e2)]];const _0x40b4a4=_0x50aeb8[_0x3bdfdb(0x12e)](_0x5f26e3=>{return _0x5f26e3={'product_name':_0x5f26e3};});_0x559aae[_0x3bdfdb(0x216)]((_0x107d2a,_0x37d2a4)=>{var _0x10c83c=_0x3bdfdb;_0x40b4a4[_0x37d2a4][_0x10c83c(0x1e2)]=_0x107d2a;}),_0x218c13[_0x3bdfdb(0x216)]((_0x524823,_0x17eb1d)=>{_0x40b4a4[_0x17eb1d]['product_code']=_0x524823;}),_0x42e075[_0x3bdfdb(0x216)]((_0x4028da,_0x4a0df8)=>{var _0x370c0e=_0x3bdfdb;_0x40b4a4[_0x4a0df8][_0x370c0e(0x101)]=_0x4028da;}),_0x142043['forEach']((_0x636827,_0x4da9c9)=>{_0x40b4a4[_0x4da9c9]['standard_unit']=_0x636827;}),_0xde3f11['forEach']((_0x348ef6,_0x53f418)=>{var _0x23ae8f=_0x3bdfdb;_0x40b4a4[_0x53f418][_0x23ae8f(0x186)]=_0x348ef6;}),_0x114380[_0x3bdfdb(0x216)]((_0xe2163c,_0x19e071)=>{var _0x4da022=_0x3bdfdb;_0x25b5d0[_0x4da022(0x216)]((_0x12901d,_0x5377cc)=>{var _0x401b79=_0x4da022;if(_0x12901d==_0x401b79(0x111)&&_0x19e071==_0x5377cc){console[_0x401b79(0x1c0)](_0x12901d+_0x401b79(0xf8)+_0x19e071+_0x401b79(0x1f0)+_0x5377cc+_0x401b79(0x1f0)+_0xe2163c);var _0xf569b9=_0xe2163c[_0x401b79(0x16e)](0x3);_0x40b4a4[_0x19e071][_0x401b79(0x1f2)]=_0xe2163c[0x0],_0x40b4a4[_0x19e071][_0x401b79(0x118)]=_0xe2163c[0x1],_0x40b4a4[_0x19e071][_0x401b79(0x198)]=0x0,_0x40b4a4[_0x19e071][_0x401b79(0x119)]=0x0,_0x40b4a4[_0x19e071]['type']=_0x401b79(0xf9),_0x40b4a4[_0x19e071][_0x401b79(0x157)]=_0xf569b9;}else{if(_0x12901d==_0x401b79(0x10a)&&_0x19e071==_0x5377cc){var _0xf569b9=_0xe2163c[_0x401b79(0x16e)](0x3);_0x40b4a4[_0x19e071][_0x401b79(0x1f2)]=_0xe2163c[0x0],_0x40b4a4[_0x19e071][_0x401b79(0x118)]=_0xe2163c[0x1],_0x40b4a4[_0x19e071][_0x401b79(0x198)]=0x0,_0x40b4a4[_0x19e071]['bin']=0x0,_0x40b4a4[_0x19e071]['type']=_0x401b79(0xf9),_0x40b4a4[_0x19e071][_0x401b79(0x157)]=_0xe2163c[0x5];}else{if(_0x19e071==_0x5377cc){var _0x2e23ae;if(_0xe2163c[0x4]=='L')_0x2e23ae=_0x401b79(0x1d2);else _0xe2163c[0x4]=='F'&&(_0x2e23ae=_0x401b79(0xf9));_0x40b4a4[_0x19e071][_0x401b79(0x1f2)]=_0xe2163c[0x0],_0x40b4a4[_0x19e071][_0x401b79(0x118)]=_0xe2163c[0x1],_0x40b4a4[_0x19e071][_0x401b79(0x198)]=_0xe2163c[0x2],_0x40b4a4[_0x19e071][_0x401b79(0x119)]=_0xe2163c[0x3],_0x40b4a4[_0x19e071][_0x401b79(0x1bc)]=_0x2e23ae,_0x40b4a4[_0x19e071]['floorlevel']=_0xe2163c[0x5];}}}});}),_0x454c61[_0x3bdfdb(0x216)]((_0xf35df3,_0x2af573)=>{_0x40b4a4[_0x2af573]['primary_code']=_0xf35df3;}),_0x48e89d[_0x3bdfdb(0x216)]((_0x292747,_0x3a8780)=>{var _0x2dcf2a=_0x3bdfdb;_0x40b4a4[_0x3a8780][_0x2dcf2a(0x1d6)]=_0x292747;}),_0x4f692d[_0x3bdfdb(0x216)]((_0x17286e,_0x2bfc75)=>{var _0x25babe=_0x3bdfdb;_0x40b4a4[_0x2bfc75][_0x25babe(0x12c)]=_0x17286e;}),_0x430eca[_0x3bdfdb(0x216)]((_0x2cce43,_0x31a4e7)=>{var _0x236b83=_0x3bdfdb;_0x40b4a4[_0x31a4e7][_0x236b83(0x126)]=_0x2cce43;}),_0x1676f9[_0x3bdfdb(0x216)]((_0x3a797e,_0x1123dd)=>{_0x40b4a4[_0x1123dd]['expiry_date']=_0x3a797e;}),_0x11517b['forEach']((_0x44ccf8,_0x82421c)=>{_0x40b4a4[_0x82421c]['maxperunit']=_0x44ccf8;}),_0x375c14[_0x3bdfdb(0x216)]((_0x256c5b,_0x354c35)=>{var _0x1338cf=_0x3bdfdb;_0x40b4a4[_0x354c35][_0x1338cf(0x1a5)]=_0x256c5b;}),_0xe54057['forEach']((_0x40f23d,_0x2e6e4b)=>{var _0x4bbe13=_0x3bdfdb;_0x40b4a4[_0x2e6e4b][_0x4bbe13(0x182)]=_0x40f23d;}),_0x4620de[_0x3bdfdb(0x216)]((_0x43c810,_0x34cf42)=>{_0x40b4a4[_0x34cf42]['product_cat']=_0x43c810;}),_0x25b5d0[_0x3bdfdb(0x216)]((_0x5ec226,_0x760360)=>{var _0x1ded9e=_0x3bdfdb;_0x40b4a4[_0x760360][_0x1ded9e(0x211)]=_0x5ec226;}),_0x5b1074['forEach']((_0x10a97a,_0x28134e)=>{var _0x2ab10b=_0x3bdfdb;_0x40b4a4[_0x28134e][_0x2ab10b(0x1d4)]=_0x10a97a;}),_0x337108['forEach']((_0x35b009,_0x25ff8f)=>{var _0x19812b=_0x3bdfdb;_0x40b4a4[_0x25ff8f][_0x19812b(0x155)]=_0x35b009;});const _0x1c6173=_0x25b5d0[_0x3bdfdb(0x12e)](_0x51313a=>{return _0x51313a={'room_name':_0x51313a};}),_0x8b5129=_0x40b4a4['filter'](_0x461517=>_0x461517[_0x3bdfdb(0x101)]!=='0'&&_0x461517['quantity']!==''),_0x58cac7=new purchases({'invoice':_0x14cc95,'suppliers':_0x26a707['body'][_0x3bdfdb(0x165)],'date':_0x48c8ff,'warehouse_name':_0x2d663b,'product':_0x8b5129,'note':_0x31f0ca,'due_amount':_0x2e3f3f,'POnumber':_0x1b5e6f,'SCRN':_0x488876,'JO_number':_0x232e3f,'roomList':_0x1c6173}),_0x3ac15e=await _0x58cac7[_0x3bdfdb(0x202)](),_0xfd23f5=await purchases['findOne']({'invoice':_0x14cc95}),_0x36cec4=_0xfd23f5['product'][_0x3bdfdb(0x12e)](async _0x108952=>{var _0xd24c3b=_0x3bdfdb,_0xbcd5d3=await warehouse['findOne']({'name':_0x2d663b,'room':_0x108952[_0xd24c3b(0x211)]}),_0x52ba9a=0x0;return _0xbcd5d3[_0xd24c3b(0xfa)][_0xd24c3b(0x216)](_0x3bba6e=>{var _0x5b172e=_0xd24c3b;_0x3bba6e[_0x5b172e(0x13b)]==_0x108952[_0x5b172e(0x13b)]&&_0x3bba6e[_0x5b172e(0x157)]==_0x108952['floorlevel']&&_0x3bba6e[_0x5b172e(0x1bc)]==_0x108952[_0x5b172e(0x1bc)]&&_0x3bba6e['bin']==_0x108952['bin']&&_0x3bba6e[_0x5b172e(0x198)]==_0x108952[_0x5b172e(0x198)]&&_0x3bba6e[_0x5b172e(0x118)]==_0x108952[_0x5b172e(0x118)]&&_0x3bba6e[_0x5b172e(0x1f2)]==_0x108952[_0x5b172e(0x1f2)]&&_0x3bba6e[_0x5b172e(0x117)]==_0x108952[_0x5b172e(0x117)]&&_0x3bba6e['batch_code']==_0x108952[_0x5b172e(0x126)]&&_0x3bba6e['production_date']==_0x108952[_0x5b172e(0x182)]&&_0x3bba6e[_0x5b172e(0x155)]==_0xfd23f5[_0x5b172e(0x155)]&&(_0x3bba6e[_0x5b172e(0x195)]+=_0x108952[_0x5b172e(0x101)],_0x52ba9a++);}),_0x52ba9a===0x0&&_0xbcd5d3[_0xd24c3b(0xfa)][_0xd24c3b(0x106)]({'product_name':_0x108952[_0xd24c3b(0x13b)],'product_stock':_0x108952[_0xd24c3b(0x101)],'primary_code':_0x108952[_0xd24c3b(0x1a7)],'secondary_code':_0x108952['secondary_code'],'product_code':_0x108952['product_code'],'storage':_0x108952[_0xd24c3b(0x1f2)],'rack':_0x108952[_0xd24c3b(0x118)],'bay':_0x108952[_0xd24c3b(0x198)],'bin':_0x108952[_0xd24c3b(0x119)],'type':_0x108952[_0xd24c3b(0x1bc)],'floorlevel':_0x108952[_0xd24c3b(0x157)],'maxProducts':_0x108952[_0xd24c3b(0x12c)],'unit':_0x108952[_0xd24c3b(0x151)],'secondary_unit':_0x108952[_0xd24c3b(0x186)],'expiry_date':_0x108952[_0xd24c3b(0x117)],'maxPerUnit':_0x108952[_0xd24c3b(0x19b)],'batch_code':_0x108952[_0xd24c3b(0x126)],'alertQTY':_0x108952[_0xd24c3b(0x1a5)],'production_date':_0x108952['production_date'],'product_cat':_0x108952[_0xd24c3b(0x17d)],'invoice':_0x108952[_0xd24c3b(0x155)],'actual_qty':_0x108952[_0xd24c3b(0x1e2)]}),_0xbcd5d3;});Promise[_0x3bdfdb(0x1c2)](_0x36cec4)[_0x3bdfdb(0x11a)](async _0x1f99e6=>{var _0x56ccb8=_0x3bdfdb;try{for(const _0x20d88e of _0x1f99e6){await _0x20d88e[_0x56ccb8(0x202)]();}const _0x5b966c=await master_shop[_0x56ccb8(0x110)](),_0x39dfe6=await email_settings[_0x56ccb8(0x15a)](),_0x3d52fe=await supervisor_settings[_0x56ccb8(0x110)]();var _0x38c945=_0xfd23f5['product'],_0x537f09='',_0x1cdd4b;for(_0x1cdd4b in _0x38c945){_0x537f09+=_0x56ccb8(0x207)+_0x56ccb8(0x128)+_0x38c945[_0x1cdd4b]['product_name']+_0x56ccb8(0x166)+_0x56ccb8(0x128)+_0x38c945[_0x1cdd4b][_0x56ccb8(0x219)]+_0x56ccb8(0x166)+_0x56ccb8(0x128)+_0x38c945[_0x1cdd4b]['quantity']+_0x56ccb8(0x166)+_0x56ccb8(0x128)+_0x38c945[_0x1cdd4b][_0x56ccb8(0x151)]+'</td>'+_0x56ccb8(0x128)+_0x38c945[_0x1cdd4b][_0x56ccb8(0x186)]+_0x56ccb8(0x166)+_0x56ccb8(0x128)+_0xfd23f5[_0x56ccb8(0x143)]+_0x56ccb8(0x166)+_0x56ccb8(0x128)+_0x38c945[_0x1cdd4b][_0x56ccb8(0x211)]+_0x56ccb8(0x166)+_0x56ccb8(0x128)+_0x38c945[_0x1cdd4b][_0x56ccb8(0x1f2)]+_0x38c945[_0x1cdd4b][_0x56ccb8(0x118)]+_0x38c945[_0x1cdd4b][_0x56ccb8(0x198)]+_0x38c945[_0x1cdd4b][_0x56ccb8(0x119)]+_0x38c945[_0x1cdd4b][_0x56ccb8(0x1bc)][0x0]+_0x38c945[_0x1cdd4b][_0x56ccb8(0x157)]+_0x56ccb8(0x166),_0x56ccb8(0x162);}let _0x176028=nodemailer[_0x56ccb8(0x18d)]({'host':_0x39dfe6[_0x56ccb8(0x19a)],'port':Number(_0x39dfe6[_0x56ccb8(0x176)]),'secure':![],'auth':{'user':_0x39dfe6[_0x56ccb8(0x16b)],'pass':_0x39dfe6[_0x56ccb8(0x10c)]}}),_0xcea2fa={'from':_0x39dfe6['email'],'to':_0x3d52fe[0x0][_0x56ccb8(0x13e)],'subject':_0x56ccb8(0x15b),'attachments':[{'filename':_0x56ccb8(0x1da),'path':__dirname+_0x56ccb8(0xfd)+_0x56ccb8(0x133)+_0x5b966c[0x0][_0x56ccb8(0x108)],'cid':_0x56ccb8(0x187)}],'html':'<!DOCTYPE\x20html>'+_0x56ccb8(0x1f5)+_0x56ccb8(0x15c)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x56ccb8(0x19f)+_0x56ccb8(0x109)+_0x56ccb8(0x184)+_0x56ccb8(0x19f)+_0x56ccb8(0x1d5)+_0x5b966c[0x0][_0x56ccb8(0x1ec)]+_0x56ccb8(0x1ef)+'</div>'+_0x56ccb8(0x184)+_0x56ccb8(0x200)+_0x56ccb8(0x19f)+_0x56ccb8(0x172)+_0x56ccb8(0xfe)+_0xfd23f5[_0x56ccb8(0x155)]+'\x20'+_0x56ccb8(0x1ab)+'\x20Order\x20Date\x20:\x20'+_0xfd23f5[_0x56ccb8(0x1bb)]+'\x20'+_0x56ccb8(0x196)+_0x56ccb8(0x11e)+_0x56ccb8(0x184)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x56ccb8(0x20c)+'<tr>'+_0x56ccb8(0x190)+_0x56ccb8(0x146)+_0x56ccb8(0x163)+_0x56ccb8(0x129)+_0x56ccb8(0x1c8)+_0x56ccb8(0x107)+_0x56ccb8(0x112)+_0x56ccb8(0x16d)+_0x56ccb8(0x162)+_0x56ccb8(0x1c1)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x537f09+'\x20'+_0x56ccb8(0x130)+'</table>'+_0x56ccb8(0x19f)+_0x56ccb8(0x205)+_0x56ccb8(0x1c5)+_0x5b966c[0x0][_0x56ccb8(0x1ec)]+_0x56ccb8(0x11e)+_0x56ccb8(0x184)+_0x56ccb8(0x184)+_0x56ccb8(0x169)};_0x176028[_0x56ccb8(0x19e)](_0xcea2fa,function(_0x23ebfb,_0x271d12){var _0x4ac16d=_0x56ccb8;_0x23ebfb?(console[_0x4ac16d(0x1c0)](_0x23ebfb),console[_0x4ac16d(0x1c0)](_0x4ac16d(0x17c))):console[_0x4ac16d(0x1c0)](_0x4ac16d(0x16a));}),_0x26a707[_0x56ccb8(0x138)](_0x56ccb8(0x164),'Purchase\x20data\x20added\x20successfully'),_0x1ef40e[_0x56ccb8(0x1f1)](_0x56ccb8(0x191));}catch(_0x32eecb){console[_0x56ccb8(0x177)](_0x32eecb),_0x1ef40e[_0x56ccb8(0x173)](0x1f4)[_0x56ccb8(0x13f)]({'error':_0x56ccb8(0x12a)});}})['catch'](_0x2e2fae=>{var _0x82319c=_0x3bdfdb;console[_0x82319c(0x177)](_0x2e2fae),_0x1ef40e[_0x82319c(0x173)](0x1f4)[_0x82319c(0x13f)]({'error':'An\x20error\x20occurred.'});});}catch(_0x2a393f){console['log'](_0x2a393f);}}),router[a0_0x1b96eb(0x1db)]('/preview/:id',auth,async(_0x46a866,_0xf4e15a)=>{var _0xf7efba=a0_0x1b96eb;try{const {username:_0x4625d1,email:_0x469a86,role:_0x53641c}=_0x46a866[_0xf7efba(0x144)],_0x2ba1e3=_0x46a866[_0xf7efba(0x144)],_0x1d01d5=await profile[_0xf7efba(0x15a)]({'email':_0x2ba1e3[_0xf7efba(0x16b)]}),_0x1f61c5=await master_shop[_0xf7efba(0x110)](),_0x51ab39=_0x46a866['params']['id'],_0x3e4456=await purchases[_0xf7efba(0x12f)](_0x51ab39),_0x51bf72=await warehouse['aggregate']([{'$match':{'name':_0x3e4456[_0xf7efba(0x143)],'room':_0x3e4456[_0xf7efba(0x1a8)]}},{'$unwind':_0xf7efba(0x100)},{'$group':{'_id':_0xf7efba(0x188),'name':{'$first':_0xf7efba(0x13d)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xf7efba(0x1fc)},'bin':{'$first':_0xf7efba(0x121)},'type':{'$first':_0xf7efba(0x1ba)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xf7efba(0x17f)},'secondary_code':{'$first':_0xf7efba(0x16f)},'product_code':{'$first':_0xf7efba(0x215)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xf7efba(0x147)},'expiry_date':{'$first':'$product_details.expiry_date'}}}]),_0x3557d2=await customer[_0xf7efba(0x110)]({});let _0x34d0b2;if(_0x2ba1e3[_0xf7efba(0x1b7)]==_0xf7efba(0x160)){const _0x3ca187=await staff[_0xf7efba(0x15a)]({'email':_0x2ba1e3[_0xf7efba(0x16b)]});_0x34d0b2=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x3ca187['warehouse']}},{'$group':{'_id':_0xf7efba(0x179),'name':{'$first':_0xf7efba(0x179)}}}]);}else _0x34d0b2=await warehouse[_0xf7efba(0x1a6)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0xf7efba(0x179),'name':{'$first':'$name'}}}]);const _0x21e5fe=await product[_0xf7efba(0x110)]({}),_0x470486=await suppliers[_0xf7efba(0x110)]({}),_0x40837b=BayBinSelected(_0x3e4456['warehouse_name'],_0x3e4456[_0xf7efba(0x1a8)]);if(_0x1f61c5[0x0][_0xf7efba(0x1cc)]==_0xf7efba(0x213)){var _0x5c37da=users[_0xf7efba(0x171)];console[_0xf7efba(0x1c0)](_0x5c37da);}else{if(_0x1f61c5[0x0][_0xf7efba(0x1cc)]==_0xf7efba(0x19c))var _0x5c37da=users[_0xf7efba(0x19c)];else{if(_0x1f61c5[0x0]['language']=='German')var _0x5c37da=users[_0xf7efba(0x212)];else{if(_0x1f61c5[0x0]['language']==_0xf7efba(0x18b))var _0x5c37da=users[_0xf7efba(0x18b)];else{if(_0x1f61c5[0x0][_0xf7efba(0x1cc)]=='French')var _0x5c37da=users[_0xf7efba(0x201)];else{if(_0x1f61c5[0x0][_0xf7efba(0x1cc)]=='Portuguese\x20(BR)')var _0x5c37da=users[_0xf7efba(0x1ff)];else{if(_0x1f61c5[0x0][_0xf7efba(0x1cc)]=='Chinese')var _0x5c37da=users[_0xf7efba(0x1fb)];else{if(_0x1f61c5[0x0][_0xf7efba(0x1cc)]==_0xf7efba(0x12d))var _0x5c37da=users[_0xf7efba(0x185)];}}}}}}}_0xf4e15a['render'](_0xf7efba(0x181),{'success':_0x46a866[_0xf7efba(0x138)]('success'),'errors':_0x46a866[_0xf7efba(0x138)](_0xf7efba(0x1a4)),'role':_0x2ba1e3,'profile':_0x1d01d5,'customer':_0x3557d2,'warehouse':_0x34d0b2,'product':_0x51bf72,'user':_0x3e4456,'master_shop':_0x1f61c5,'unit':_0x21e5fe,'language':_0x5c37da,'suppliers':_0x470486,'dataSelected':_0x40837b});}catch(_0x391b39){console[_0xf7efba(0x1c0)](_0x391b39);}}),router[a0_0x1b96eb(0x206)](a0_0x1b96eb(0x193),auth,async(_0x37d7f0,_0x3d42a8)=>{var _0x1a43ad=a0_0x1b96eb;try{const _0x51def0=_0x37d7f0[_0x1a43ad(0x115)]['id'],{invoice:_0x4475cb,warehouse_name:_0x9bad1a,Room_name:_0x22d00a}=_0x37d7f0[_0x1a43ad(0x132)],_0x3b6271=await warehouse['findOne']({'name':_0x9bad1a,'room':_0x22d00a}),_0x271c16=await purchases[_0x1a43ad(0x15a)]({'invoice':_0x4475cb});_0x271c16[_0x1a43ad(0x142)][_0x1a43ad(0x216)](_0x4d236c=>{var _0x4cc6ca=_0x1a43ad,_0x1f0043=0x0;const _0x512ec5=_0x3b6271[_0x4cc6ca(0xfa)][_0x4cc6ca(0x12e)](_0x57b8cc=>{var _0x569ae2=_0x4cc6ca;_0x57b8cc[_0x569ae2(0x13b)]==_0x4d236c[_0x569ae2(0x13b)]&&_0x57b8cc[_0x569ae2(0x157)]==_0x4d236c[_0x569ae2(0x157)]&&_0x57b8cc[_0x569ae2(0x1bc)]==_0x4d236c[_0x569ae2(0x1bc)]&&_0x57b8cc[_0x569ae2(0x119)]==_0x4d236c['bin']&&_0x57b8cc['bay']==_0x4d236c['bay']&&_0x57b8cc[_0x569ae2(0x118)]==_0x4d236c[_0x569ae2(0x118)]&&_0x57b8cc[_0x569ae2(0x1f2)]==_0x4d236c['storage']&&_0x57b8cc[_0x569ae2(0x117)]==_0x4d236c[_0x569ae2(0x117)]&&_0x57b8cc['batch_code']==_0x4d236c[_0x569ae2(0x126)]&&_0x57b8cc['production_date']==_0x4d236c[_0x569ae2(0x182)]&&_0x57b8cc[_0x569ae2(0x1f3)]==_0x4d236c[_0x569ae2(0x1f3)]&&_0x57b8cc['delivery_code']==_0x4d236c[_0x569ae2(0x1d4)]&&(_0x57b8cc[_0x569ae2(0x195)]=parseInt(_0x57b8cc[_0x569ae2(0x195)])+parseInt(_0x4d236c[_0x569ae2(0x101)]),_0x1f0043++);});_0x1f0043=='0'&&(_0x3b6271[_0x4cc6ca(0xfa)]=_0x3b6271[_0x4cc6ca(0xfa)][_0x4cc6ca(0x18e)]({'product_name':_0x4d236c['product_name'],'product_stock':_0x4d236c[_0x4cc6ca(0x101)],'primary_code':_0x4d236c[_0x4cc6ca(0x1a7)],'secondary_code':_0x4d236c['secondary_code'],'product_code':_0x4d236c['product_code'],'storage':_0x4d236c['storage'],'rack':_0x4d236c[_0x4cc6ca(0x118)],'bay':_0x4d236c[_0x4cc6ca(0x198)],'bin':_0x4d236c[_0x4cc6ca(0x119)],'type':_0x4d236c[_0x4cc6ca(0x1bc)],'floorlevel':_0x4d236c[_0x4cc6ca(0x157)],'maxProducts':_0x4d236c['maxStocks'],'unit':_0x4d236c['standard_unit'],'secondary_unit':_0x4d236c[_0x4cc6ca(0x186)],'expiry_date':_0x4d236c[_0x4cc6ca(0x117)],'maxPerUnit':_0x4d236c[_0x4cc6ca(0x19b)],'batch_code':_0x4d236c[_0x4cc6ca(0x126)],'alertQTY':_0x4d236c[_0x4cc6ca(0x1a5)],'production_date':_0x4d236c[_0x4cc6ca(0x182)],'delivery_date':_0x4d236c[_0x4cc6ca(0x1f3)],'delivery_code':_0x4d236c[_0x4cc6ca(0x1d4)]}));}),await _0x3b6271[_0x1a43ad(0x202)](),_0x271c16[_0x1a43ad(0x140)]='True';const _0xf63d9e=await _0x271c16[_0x1a43ad(0x202)]();_0x37d7f0['flash'](_0x1a43ad(0x164),'Sales\x20Update\x20successfully'),_0x3d42a8[_0x1a43ad(0x1f1)]('/all_purchases/view');}catch(_0x254c2b){console[_0x1a43ad(0x1c0)](_0x254c2b);}}),router[a0_0x1b96eb(0x1db)](a0_0x1b96eb(0x1fa),auth,async(_0x2a7bcb,_0x1dc0ed)=>{var _0x2ab6a9=a0_0x1b96eb;try{const {username:_0x42727d,email:_0x3e7d65,role:_0x39f14b}=_0x2a7bcb['user'],_0x191ea7=_0x2a7bcb[_0x2ab6a9(0x144)],_0x390b92=await profile['findOne']({'email':_0x191ea7[_0x2ab6a9(0x16b)]}),_0x5985a7=await master_shop['find'](),_0x4ac56d=_0x2a7bcb[_0x2ab6a9(0x115)]['id'],_0x137aab=await purchases['findById'](_0x4ac56d),_0x89ed7f=await suppliers[_0x2ab6a9(0x110)]({});let _0x5cb15b;if(_0x191ea7[_0x2ab6a9(0x1b7)]=='staff'){const _0x36d707=await staff[_0x2ab6a9(0x15a)]({'email':_0x191ea7[_0x2ab6a9(0x16b)]});_0x5cb15b=await warehouse[_0x2ab6a9(0x110)]({'status':_0x2ab6a9(0x14e),'name':_0x36d707[_0x2ab6a9(0x1f8)],'warehouse_category':'Raw\x20Materials'});}else _0x5cb15b=await warehouse[_0x2ab6a9(0x1a6)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x2be905=await product[_0x2ab6a9(0x110)]({}),_0x12cd95=BayBinSelected(_0x137aab[_0x2ab6a9(0x143)],_0x137aab['room']);let _0x4eec3c=new Date(_0x137aab['expiry_date']),_0x254379=('0'+_0x4eec3c[_0x2ab6a9(0x1b4)]())[_0x2ab6a9(0x16e)](-0x2),_0x405ee3=('0'+(_0x4eec3c[_0x2ab6a9(0x120)]()+0x1))[_0x2ab6a9(0x16e)](-0x2),_0x3f3cc4=_0x4eec3c[_0x2ab6a9(0x21c)](),_0x3a94ec=_0x3f3cc4+'-'+_0x405ee3+'-'+_0x254379;if(_0x5985a7[0x0][_0x2ab6a9(0x1cc)]=='English\x20(US)'){var _0x2f729f=users[_0x2ab6a9(0x171)];console[_0x2ab6a9(0x1c0)](_0x2f729f);}else{if(_0x5985a7[0x0]['language']==_0x2ab6a9(0x19c))var _0x2f729f=users[_0x2ab6a9(0x19c)];else{if(_0x5985a7[0x0][_0x2ab6a9(0x1cc)]==_0x2ab6a9(0x212))var _0x2f729f=users[_0x2ab6a9(0x212)];else{if(_0x5985a7[0x0]['language']==_0x2ab6a9(0x18b))var _0x2f729f=users[_0x2ab6a9(0x18b)];else{if(_0x5985a7[0x0]['language']==_0x2ab6a9(0x201))var _0x2f729f=users[_0x2ab6a9(0x201)];else{if(_0x5985a7[0x0][_0x2ab6a9(0x1cc)]==_0x2ab6a9(0x168))var _0x2f729f=users['Portuguese'];else{if(_0x5985a7[0x0][_0x2ab6a9(0x1cc)]==_0x2ab6a9(0x1fb))var _0x2f729f=users[_0x2ab6a9(0x1fb)];else{if(_0x5985a7[0x0][_0x2ab6a9(0x1cc)]==_0x2ab6a9(0x12d))var _0x2f729f=users['Arabic'];}}}}}}}_0x1dc0ed[_0x2ab6a9(0x1dd)](_0x2ab6a9(0x18f),{'success':_0x2a7bcb[_0x2ab6a9(0x138)]('success'),'errors':_0x2a7bcb['flash']('errors'),'role':_0x191ea7,'profile':_0x390b92,'purchases':_0x137aab,'suppliers':_0x89ed7f,'warehouse':_0x5cb15b,'product':_0x2be905,'master_shop':_0x5985a7,'language':_0x2f729f,'ed_fullDate':_0x3a94ec,'dataSelected':_0x12cd95});}catch(_0x2f9976){console['log'](_0x2f9976);}}),router[a0_0x1b96eb(0x206)](a0_0x1b96eb(0x1fa),auth,async(_0x5a628a,_0x16b2f4)=>{var _0x2565fc=a0_0x1b96eb;try{const _0x27f642=_0x5a628a['params']['id'],_0x357213=await purchases[_0x2565fc(0x15a)]({'_id':_0x5a628a[_0x2565fc(0x115)]['id']}),_0x37e975=await warehouse['findOne']({'name':_0x357213[_0x2565fc(0x143)],'room':_0x357213[_0x2565fc(0x1a8)]});_0x357213[_0x2565fc(0x142)][_0x2565fc(0x216)](_0x29da15=>{var _0x4cb364=_0x2565fc;const _0xaa3e96=_0x37e975['product_details'][_0x4cb364(0x12e)](_0x433086=>{var _0x2ce092=_0x4cb364;_0x433086[_0x2ce092(0x13b)]==_0x29da15['product_name']&&_0x433086['floorlevel']==_0x29da15['floorlevel']&&_0x433086[_0x2ce092(0x1bc)]==_0x29da15['type']&&_0x433086[_0x2ce092(0x119)]==_0x29da15[_0x2ce092(0x119)]&&_0x433086[_0x2ce092(0x198)]==_0x29da15[_0x2ce092(0x198)]&&_0x433086[_0x2ce092(0x118)]==_0x29da15[_0x2ce092(0x118)]&&_0x433086['storage']==_0x29da15[_0x2ce092(0x1f2)]&&(_0x433086['product_stock']=parseInt(_0x433086[_0x2ce092(0x195)])-parseInt(_0x29da15[_0x2ce092(0x101)]));});}),await _0x37e975['save']();const {invoice:_0x1fd70c,suppliers:_0x431636,date:_0x408f2b,warehouse_name:_0x105a8d,prod_name:_0x22be2f,prod_code:_0x38764b,prod_qty:_0x1bcca3,prod_unit:_0x4445ba,prod_secondunit:_0x430842,prod_level:_0x3306d6,prod_isle:_0x137d87,prod_pallet:_0xdf5285,note:_0x4aa60c,expiry_date:_0x706e45,batch_code:_0x4c7b36,paid_amount:_0x5dd71f,due_amount:_0x40c7cf,Room_name:_0x2a8dce,primary_code:_0x4a4b6d,secondary_code:_0x41b7bd,PO_number:_0x2948d3,JO_number:_0x2517ae}=_0x5a628a[_0x2565fc(0x132)];if(typeof _0x22be2f==_0x2565fc(0x218))var _0x3ba019=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x1b2)]],_0x31fdf5=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x1b5)]],_0x38ebd1=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x135)]],_0x5dd367=[_0x5a628a[_0x2565fc(0x132)]['prod_unit']],_0x42ed1b=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x10d)]],_0x962ed7=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x139)]],_0x4a962d=[_0x5a628a[_0x2565fc(0x132)]['prod_isle']],_0x492840=[_0x5a628a['body'][_0x2565fc(0x11c)]],_0x5434e5=[_0x5a628a['body']['primary_code']],_0x1cf445=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x1d6)]],_0x22e8dd=[_0x5a628a['body'][_0x2565fc(0x10b)]],_0xf4b7e6=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x126)]],_0x4db732=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x117)]],_0x2df853=[_0x5a628a['body'][_0x2565fc(0x1f2)]],_0x25bf5a=[_0x5a628a['body']['rak']],_0x194f18=[_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x1bc)]];else var _0x3ba019=[..._0x5a628a['body']['prod_name']],_0x31fdf5=[..._0x5a628a['body']['prod_code']],_0x38ebd1=[..._0x5a628a['body'][_0x2565fc(0x135)]],_0x5dd367=[..._0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x174)]],_0x42ed1b=[..._0x5a628a[_0x2565fc(0x132)]['prod_secondunit']],_0x962ed7=[..._0x5a628a[_0x2565fc(0x132)]['prod_level']],_0x4a962d=[..._0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x178)]],_0x492840=[..._0x5a628a['body'][_0x2565fc(0x11c)]],_0x5434e5=[..._0x5a628a[_0x2565fc(0x132)]['primary_code']],_0x1cf445=[..._0x5a628a['body'][_0x2565fc(0x1d6)]],_0x22e8dd=[..._0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x10b)]],_0xf4b7e6=[..._0x5a628a['body'][_0x2565fc(0x126)]],_0x4db732=[..._0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x117)]],_0x2df853=[..._0x5a628a[_0x2565fc(0x132)]['storage']],_0x25bf5a=[..._0x5a628a[_0x2565fc(0x132)][_0x2565fc(0xfc)]],_0x194f18=[..._0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x1bc)]];const _0x32fe56=_0x3ba019[_0x2565fc(0x12e)](_0x15c755=>{return _0x15c755={'product_name':_0x15c755};});_0x31fdf5[_0x2565fc(0x216)]((_0x406ec6,_0x5dc174)=>{_0x32fe56[_0x5dc174]['product_code']=_0x406ec6;}),_0x38ebd1[_0x2565fc(0x216)]((_0x459352,_0x2a9f88)=>{_0x32fe56[_0x2a9f88]['quantity']=_0x459352;}),_0x5dd367[_0x2565fc(0x216)]((_0xb82863,_0x1e5656)=>{var _0x1a69bf=_0x2565fc;_0x32fe56[_0x1e5656][_0x1a69bf(0x151)]=_0xb82863;}),_0x42ed1b[_0x2565fc(0x216)]((_0x2dfb37,_0x55f060)=>{var _0x83a875=_0x2565fc;_0x32fe56[_0x55f060][_0x83a875(0x186)]=_0x2dfb37;}),_0x962ed7['forEach']((_0xddb2a1,_0x13ba0a)=>{var _0x517cb4=_0x2565fc;_0x32fe56[_0x13ba0a][_0x517cb4(0x198)]=_0xddb2a1;}),_0x4a962d[_0x2565fc(0x216)]((_0x2e71b2,_0x56ec4f)=>{_0x32fe56[_0x56ec4f]['bin']=_0x2e71b2;}),_0x492840[_0x2565fc(0x216)]((_0x334a1d,_0xb23011)=>{_0x32fe56[_0xb23011]['floorlevel']=_0x334a1d;}),_0x5434e5[_0x2565fc(0x216)]((_0x4dffc6,_0xb19170)=>{var _0x5b453d=_0x2565fc;_0x32fe56[_0xb19170][_0x5b453d(0x1a7)]=_0x4dffc6;}),_0x1cf445[_0x2565fc(0x216)]((_0x413596,_0x243ed5)=>{_0x32fe56[_0x243ed5]['secondary_code']=_0x413596;}),_0x22e8dd[_0x2565fc(0x216)]((_0x44a828,_0x514d6b)=>{var _0x25ce59=_0x2565fc;_0x32fe56[_0x514d6b][_0x25ce59(0x12c)]=_0x44a828;}),_0xf4b7e6[_0x2565fc(0x216)]((_0xdf8061,_0x1d6a10)=>{var _0x1a4737=_0x2565fc;_0x32fe56[_0x1d6a10][_0x1a4737(0x126)]=_0xdf8061;}),_0x4db732[_0x2565fc(0x216)]((_0x3c7fdb,_0x3cd7f8)=>{var _0x57d923=_0x2565fc;_0x32fe56[_0x3cd7f8][_0x57d923(0x117)]=_0x3c7fdb;}),_0x194f18[_0x2565fc(0x216)]((_0x59c12f,_0x26e8c6)=>{var _0x5be70a=_0x2565fc;_0x32fe56[_0x26e8c6][_0x5be70a(0x1bc)]=_0x59c12f;}),_0x2df853['forEach']((_0x3613f0,_0x3f93ce)=>{var _0x507b6a=_0x2565fc;_0x32fe56[_0x3f93ce][_0x507b6a(0x1f2)]=_0x3613f0;}),_0x25bf5a[_0x2565fc(0x216)]((_0x25757d,_0x5a4ed7)=>{var _0x28bc9c=_0x2565fc;_0x32fe56[_0x5a4ed7][_0x28bc9c(0x118)]=_0x25757d;});const _0x21567b=_0x32fe56['filter'](_0x345c08=>_0x345c08['quantity']!=='0'&&_0x345c08[_0x2565fc(0x101)]!=='');_0x357213['invoice']=_0x1fd70c,_0x357213[_0x2565fc(0x165)]=_0x431636,_0x357213['date']=_0x408f2b,_0x357213[_0x2565fc(0x143)]=_0x105a8d,_0x357213[_0x2565fc(0x142)]=_0x21567b,_0x357213[_0x2565fc(0x1f9)]=_0x4aa60c,_0x357213[_0x2565fc(0x1b6)]=_0x5dd71f,_0x357213[_0x2565fc(0x208)]=_0x40c7cf,_0x357213[_0x2565fc(0x1a8)]=_0x2a8dce,_0x357213['POnumber']=_0x2948d3,_0x357213[_0x2565fc(0x105)]=_0x2517ae;const _0x51d09a=await _0x357213[_0x2565fc(0x202)](),_0x4fdd89=await warehouse[_0x2565fc(0x15a)]({'name':_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x143)],'room':_0x5a628a[_0x2565fc(0x132)][_0x2565fc(0x180)]});_0x357213[_0x2565fc(0x142)][_0x2565fc(0x216)](_0x5b2353=>{var _0x1cfe65=_0x2565fc,_0x10a76f=0x0;const _0x4ad5a6=_0x4fdd89[_0x1cfe65(0xfa)][_0x1cfe65(0x12e)](_0x26e997=>{var _0x2a6b58=_0x1cfe65;_0x26e997['product_name']==_0x5b2353['product_name']&&_0x26e997[_0x2a6b58(0x157)]==_0x5b2353[_0x2a6b58(0x157)]&&_0x26e997[_0x2a6b58(0x1bc)]==_0x5b2353[_0x2a6b58(0x1bc)]&&_0x26e997[_0x2a6b58(0x119)]==_0x5b2353['bin']&&_0x26e997[_0x2a6b58(0x198)]==_0x5b2353[_0x2a6b58(0x198)]&&_0x26e997['rack']==_0x5b2353[_0x2a6b58(0x118)]&&_0x26e997[_0x2a6b58(0x1f2)]==_0x5b2353[_0x2a6b58(0x1f2)]&&(_0x26e997[_0x2a6b58(0x195)]=parseInt(_0x26e997[_0x2a6b58(0x195)])+parseInt(_0x5b2353[_0x2a6b58(0x101)]),_0x10a76f++);});_0x10a76f=='0'&&(_0x4fdd89[_0x1cfe65(0xfa)]=_0x4fdd89[_0x1cfe65(0xfa)][_0x1cfe65(0x18e)]({'product_name':_0x5b2353[_0x1cfe65(0x13b)],'product_stock':_0x5b2353['quantity'],'primary_code':_0x5b2353[_0x1cfe65(0x1a7)],'secondary_code':_0x5b2353[_0x1cfe65(0x1d6)],'product_code':_0x5b2353[_0x1cfe65(0x219)],'storage':_0x5b2353[_0x1cfe65(0x1f2)],'rack':_0x5b2353[_0x1cfe65(0x118)],'bay':_0x5b2353[_0x1cfe65(0x198)],'bin':_0x5b2353['bin'],'type':_0x5b2353['type'],'floorlevel':_0x5b2353[_0x1cfe65(0x157)],'maxProducts':_0x5b2353['maxStocks'],'unit':_0x5b2353[_0x1cfe65(0x151)],'secondary_unit':_0x5b2353['secondary_unit'],'expiry_date':_0x5b2353[_0x1cfe65(0x117)]}));}),await _0x4fdd89['save']();const _0x7a4a3d=await s_payment_data[_0x2565fc(0x15a)]({'invoice':_0x5a628a[_0x2565fc(0x132)]['invoice']});if(_0x7a4a3d===null){}else console['log'](_0x2565fc(0x165),_0x7a4a3d,_0x5a628a[_0x2565fc(0x132)]['invoice']),_0x7a4a3d[_0x2565fc(0x165)]=_0x5a628a[_0x2565fc(0x132)]['suppliers'],await _0x7a4a3d[_0x2565fc(0x202)]();_0x5a628a[_0x2565fc(0x138)]('success',_0x2565fc(0x16c)),_0x16b2f4[_0x2565fc(0x1f1)](_0x2565fc(0x156));}catch(_0x535432){console[_0x2565fc(0x1c0)](_0x535432);}}),router[a0_0x1b96eb(0x206)](a0_0x1b96eb(0x15f),auth,async(_0x40834a,_0xa7c433)=>{var _0x2114c5=a0_0x1b96eb;try{const _0x1a7991=_0x40834a['params']['id'],{invoice:_0x481bba,suppliers:_0x2fa28a,payable:_0x60fcc2,due_amount:_0xc40fef}=_0x40834a[_0x2114c5(0x132)],_0x3ac8aa=await purchases['findById'](_0x1a7991);var _0x5bb03c=_0x60fcc2-_0xc40fef;_0x3ac8aa[_0x2114c5(0x1b6)]=parseFloat(_0x3ac8aa[_0x2114c5(0x1b6)])+parseFloat(_0xc40fef),_0x3ac8aa[_0x2114c5(0x208)]=_0x5bb03c;const _0x328428=await _0x3ac8aa['save']();console['log'](_0x328428);const _0x312c9b=await s_payment_data['findOne']({'invoice':_0x481bba});_0x312c9b[_0x2114c5(0x123)]=_0x5bb03c,await _0x312c9b['save']();let _0x45cee7=new Date(),_0x430ef9=('0'+_0x45cee7[_0x2114c5(0x1b4)]())[_0x2114c5(0x16e)](-0x2),_0x6dc4e3=('0'+(_0x45cee7[_0x2114c5(0x120)]()+0x1))[_0x2114c5(0x16e)](-0x2),_0x30eef6=_0x45cee7['getFullYear'](),_0x3fe160=_0x30eef6+'-'+_0x6dc4e3+'-'+_0x430ef9;const _0x5e1efa=new suppliers_payment({'invoice':_0x481bba,'date':_0x30eef6+'-'+_0x6dc4e3+'-'+_0x430ef9,'suppliers':_0x2fa28a,'reason':_0x2114c5(0x20b),'amount':_0xc40fef}),_0x500a10=await _0x5e1efa[_0x2114c5(0x202)]();_0x40834a['flash']('success',_0x2114c5(0x217)),_0xa7c433[_0x2114c5(0x1f1)](_0x2114c5(0x156));}catch(_0x123e6c){console[_0x2114c5(0x1c0)](_0x123e6c);}}),router[a0_0x1b96eb(0x1db)](a0_0x1b96eb(0x1e3),auth,async(_0x49c71e,_0x2aa207)=>{var _0x43a0f7=a0_0x1b96eb;try{const {username:_0x37cd0e,email:_0x274753,role:_0x2edaa1}=_0x49c71e[_0x43a0f7(0x144)],_0x39f4f1=_0x49c71e['user'],_0x2423d0=await profile['findOne']({'email':_0x39f4f1[_0x43a0f7(0x16b)]}),_0x490768=await master_shop['find']();console[_0x43a0f7(0x1c0)](_0x43a0f7(0x145),_0x490768);const _0x46eb82=_0x49c71e['params']['id'],_0x395c70=await purchases[_0x43a0f7(0x12f)](_0x46eb82);console[_0x43a0f7(0x1c0)](_0x395c70);const _0x41d340=await suppliers[_0x43a0f7(0x15a)]({'name':_0x395c70[_0x43a0f7(0x165)]});console[_0x43a0f7(0x1c0)](_0x41d340);if(_0x490768[0x0][_0x43a0f7(0x1cc)]==_0x43a0f7(0x213)){var _0x183b26=users['English'];console[_0x43a0f7(0x1c0)](_0x183b26);}else{if(_0x490768[0x0][_0x43a0f7(0x1cc)]==_0x43a0f7(0x19c))var _0x183b26=users[_0x43a0f7(0x19c)];else{if(_0x490768[0x0][_0x43a0f7(0x1cc)]==_0x43a0f7(0x212))var _0x183b26=users[_0x43a0f7(0x212)];else{if(_0x490768[0x0]['language']=='Spanish')var _0x183b26=users[_0x43a0f7(0x18b)];else{if(_0x490768[0x0][_0x43a0f7(0x1cc)]=='French')var _0x183b26=users[_0x43a0f7(0x201)];else{if(_0x490768[0x0][_0x43a0f7(0x1cc)]==_0x43a0f7(0x168))var _0x183b26=users[_0x43a0f7(0x1ff)];else{if(_0x490768[0x0][_0x43a0f7(0x1cc)]==_0x43a0f7(0x1fb))var _0x183b26=users['Chinese'];else{if(_0x490768[0x0][_0x43a0f7(0x1cc)]==_0x43a0f7(0x12d))var _0x183b26=users[_0x43a0f7(0x185)];}}}}}}}_0x2aa207[_0x43a0f7(0x1dd)](_0x43a0f7(0x1c4),{'success':_0x49c71e['flash'](_0x43a0f7(0x164)),'errors':_0x49c71e['flash'](_0x43a0f7(0x1a4)),'role':_0x39f4f1,'profile':_0x2423d0,'master_shop':_0x490768,'supplier':_0x41d340,'purchase':_0x395c70,'language':_0x183b26});}catch(_0x541f3d){console[_0x43a0f7(0x1c0)](_0x541f3d);}}),router[a0_0x1b96eb(0x1db)]('/view/return_purchase/:id',auth,async(_0x1dd8d2,_0x2ca287)=>{var _0x26783d=a0_0x1b96eb;try{const {username:_0x329f79,email:_0x481e87,role:_0x3702a0}=_0x1dd8d2[_0x26783d(0x144)],_0x2d9441=_0x1dd8d2[_0x26783d(0x144)],_0x141cf5=await profile[_0x26783d(0x15a)]({'email':_0x2d9441[_0x26783d(0x16b)]}),_0x12517b=await master_shop[_0x26783d(0x110)]();console['log'](_0x26783d(0x145),_0x12517b);const _0x5074d3=_0x1dd8d2[_0x26783d(0x115)]['id'];console[_0x26783d(0x1c0)](_0x5074d3);const _0x5f1fd6=await purchases[_0x26783d(0x12f)](_0x5074d3);console[_0x26783d(0x1c0)]('user_id',_0x5f1fd6);const _0x28efed=await product[_0x26783d(0x110)]({}),_0x4bcab9=await warehouse[_0x26783d(0x1a6)]([{'$match':{'name':_0x5f1fd6[_0x26783d(0x143)],'room':_0x5f1fd6[_0x26783d(0x1a8)],'warehouse_category':_0x26783d(0x1b0)}},{'$unwind':_0x26783d(0x100)},{'$group':{'_id':_0x26783d(0x188),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x26783d(0x1e7)},'bay':{'$first':_0x26783d(0x1fc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x26783d(0x1ba)},'floorlevel':{'$first':_0x26783d(0x15d)},'primary_code':{'$first':_0x26783d(0x17f)},'secondary_code':{'$first':_0x26783d(0x16f)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x26783d(0x1a9)},'rack':{'$first':_0x26783d(0x147)}}}]);warehouse_data=await warehouse[_0x26783d(0x1a6)]([{'$match':{'status':'Enabled','name':'Return\x20Goods','warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x26783d(0x179)}}},{'$sort':{'name':0x1}}]),console[_0x26783d(0x1c0)]('stock_data',_0x4bcab9);if(_0x12517b[0x0][_0x26783d(0x1cc)]==_0x26783d(0x213)){var _0x5e68d3=users[_0x26783d(0x171)];console[_0x26783d(0x1c0)](_0x5e68d3);}else{if(_0x12517b[0x0][_0x26783d(0x1cc)]==_0x26783d(0x19c))var _0x5e68d3=users[_0x26783d(0x19c)];else{if(_0x12517b[0x0]['language']=='German')var _0x5e68d3=users[_0x26783d(0x212)];else{if(_0x12517b[0x0]['language']=='Spanish')var _0x5e68d3=users['Spanish'];else{if(_0x12517b[0x0][_0x26783d(0x1cc)]==_0x26783d(0x201))var _0x5e68d3=users[_0x26783d(0x201)];else{if(_0x12517b[0x0][_0x26783d(0x1cc)]==_0x26783d(0x168))var _0x5e68d3=users[_0x26783d(0x1ff)];else{if(_0x12517b[0x0][_0x26783d(0x1cc)]=='Chinese')var _0x5e68d3=users[_0x26783d(0x1fb)];else{if(_0x12517b[0x0][_0x26783d(0x1cc)]=='Arabic\x20(ae)')var _0x5e68d3=users['Arabic'];}}}}}}}_0x2ca287[_0x26783d(0x1dd)](_0x26783d(0x1ea),{'success':_0x1dd8d2[_0x26783d(0x138)]('success'),'errors':_0x1dd8d2[_0x26783d(0x138)](_0x26783d(0x1a4)),'role':_0x2d9441,'profile':_0x141cf5,'user':_0x5f1fd6,'stock':_0x4bcab9,'master_shop':_0x12517b,'product':_0x28efed,'language':_0x5e68d3,'warehouse':warehouse_data});}catch(_0x400a5d){console['log'](_0x400a5d);}}),router[a0_0x1b96eb(0x206)](a0_0x1b96eb(0xfb),auth,async(_0x580d9b,_0x25b5c1)=>{var _0x18bebf=a0_0x1b96eb;try{const {invoice:_0x47bb52,date:_0x1e2e8a,warehouse_name:_0x592dd6,Room_name:_0x3d6906,product_name:_0x5cc349,purchase_quantity:_0x486c7c,stocks:_0x2f4c55,return_qty:_0x2f04ac,note:_0x62926f,level:_0x12fbd2,isle:_0x1c6458,pallet:_0x3eced1,to_warehouse_name:_0x43b41e,to_Room_name:_0x417cbc}=_0x580d9b[_0x18bebf(0x132)],_0x3a2771=await purchases[_0x18bebf(0x15a)]({'_id':_0x580d9b[_0x18bebf(0x115)]['id']}),_0x394fba=await warehouse[_0x18bebf(0x15a)]({'name':_0x592dd6,'room':_0x3d6906});if(typeof _0x5cc349==_0x18bebf(0x218))var _0x940d5c=[_0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x13b)]],_0x1f5ee0=[_0x580d9b['body'][_0x18bebf(0x1a3)]],_0x99985c=[_0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x204)]],_0x35e6d1=[_0x580d9b['body'][_0x18bebf(0x17a)]],_0x20df15=[_0x580d9b['body'][_0x18bebf(0x1e0)]],_0x2fc637=[_0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x150)]],_0x1f05e1=[_0x580d9b[_0x18bebf(0x132)]['pallet']],_0x29b96e=[_0x580d9b['body']['types']],_0x2580a8=[_0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x20d)]],_0x32a10b=[_0x580d9b[_0x18bebf(0x132)]['primary_code_hide']],_0x56163e=[_0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x1fe)]];else var _0x940d5c=[..._0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x13b)]],_0x1f5ee0=[..._0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x1a3)]],_0x99985c=[..._0x580d9b[_0x18bebf(0x132)]['stocks']],_0x35e6d1=[..._0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x17a)]],_0x20df15=[..._0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x1e0)]],_0x2fc637=[..._0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x150)]],_0x1f05e1=[..._0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x15e)]],_0x29b96e=[..._0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x18a)]],_0x2580a8=[..._0x580d9b['body'][_0x18bebf(0x20d)]],_0x32a10b=[..._0x580d9b['body'][_0x18bebf(0x1be)]],_0x56163e=[..._0x580d9b[_0x18bebf(0x132)]['secondary_code_hide']];const _0x16a80d=_0x940d5c['map'](_0x408176=>{return _0x408176={'product_name':_0x408176};});_0x1f5ee0[_0x18bebf(0x216)]((_0x453083,_0x2cdb38)=>{var _0x24759a=_0x18bebf;_0x16a80d[_0x2cdb38][_0x24759a(0x1a3)]=_0x453083;}),_0x99985c['forEach']((_0x1b164f,_0x10a931)=>{var _0x50992c=_0x18bebf;_0x16a80d[_0x10a931][_0x50992c(0x209)]=_0x1b164f;}),_0x35e6d1[_0x18bebf(0x216)]((_0x423f3a,_0x1d0aea)=>{var _0x4c096e=_0x18bebf;_0x16a80d[_0x1d0aea][_0x4c096e(0x17a)]=_0x423f3a;}),_0x20df15['forEach']((_0x5a72ce,_0xd3f195)=>{_0x16a80d[_0xd3f195]['bay']=_0x5a72ce;}),_0x2fc637[_0x18bebf(0x216)]((_0x266218,_0x7fbb75)=>{_0x16a80d[_0x7fbb75]['bin']=_0x266218;}),_0x1f05e1[_0x18bebf(0x216)]((_0xa02a1,_0x530496)=>{var _0x1982f1=_0x18bebf;_0x16a80d[_0x530496][_0x1982f1(0x157)]=_0xa02a1;}),_0x29b96e[_0x18bebf(0x216)]((_0x401f5a,_0x1450cf)=>{var _0x4cb2aa=_0x18bebf;_0x16a80d[_0x1450cf][_0x4cb2aa(0x1bc)]=_0x401f5a;}),_0x2580a8[_0x18bebf(0x216)]((_0x363a2b,_0x54d6f3)=>{var _0x4462a6=_0x18bebf;_0x16a80d[_0x54d6f3][_0x4462a6(0x219)]=_0x363a2b;}),_0x32a10b['forEach']((_0xca5a83,_0x2c954a)=>{var _0x30ab95=_0x18bebf;_0x16a80d[_0x2c954a][_0x30ab95(0x1a7)]=_0xca5a83;}),_0x56163e[_0x18bebf(0x216)]((_0x59b2ce,_0x5da040)=>{var _0x45b8eb=_0x18bebf;_0x16a80d[_0x5da040][_0x45b8eb(0x1d6)]=_0x59b2ce;}),_0x3a2771[_0x18bebf(0x142)][_0x18bebf(0x216)](_0x254f20=>{var _0x11f436=_0x18bebf;const _0x2e4605=_0x394fba[_0x11f436(0xfa)][_0x11f436(0x12e)](_0x648cc7=>{var _0x7db63=_0x11f436;_0x648cc7[_0x7db63(0x13b)]==_0x254f20[_0x7db63(0x13b)]&&_0x648cc7['floorlevel']==_0x254f20[_0x7db63(0x157)]&&_0x648cc7[_0x7db63(0x1bc)]==_0x254f20[_0x7db63(0x1bc)]&&_0x648cc7[_0x7db63(0x119)]==_0x254f20[_0x7db63(0x119)]&&_0x648cc7[_0x7db63(0x198)]==_0x254f20[_0x7db63(0x198)]&&_0x648cc7['rack']==_0x254f20[_0x7db63(0x118)]&&_0x648cc7[_0x7db63(0x1f2)]==_0x254f20[_0x7db63(0x1f2)]&&(console['log'](parseInt(_0x648cc7[_0x7db63(0x195)])+'\x20<>\x20'+parseInt(_0x254f20[_0x7db63(0x101)])),_0x648cc7[_0x7db63(0x195)]=parseInt(_0x648cc7[_0x7db63(0x195)])+parseInt(_0x254f20[_0x7db63(0x101)]));});}),await _0x394fba[_0x18bebf(0x202)]();const _0x4b6eb2=_0x16a80d[_0x18bebf(0x1b9)](_0x3a6864=>_0x3a6864['return_qty']!=='0'&&_0x3a6864[_0x18bebf(0x17a)]!=='');var _0x21db3d=0x0;_0x4b6eb2[_0x18bebf(0x216)](_0x43a6af=>{var _0x20b9fc=_0x18bebf;console[_0x20b9fc(0x1c0)]('foreach\x20newproduct',_0x43a6af),(parseInt(_0x43a6af['purchase_quantity'])<parseInt(_0x43a6af['return_qty'])||parseInt(_0x43a6af[_0x20b9fc(0x209)])<parseInt(_0x43a6af['return_qty']))&&_0x21db3d++;});if(_0x21db3d!=0x0)return _0x580d9b[_0x18bebf(0x138)](_0x18bebf(0x1a4),_0x18bebf(0x1d8)),_0x25b5c1[_0x18bebf(0x1f1)](_0x18bebf(0x127));const _0x3e88e4=new purchases_return({'invoice':_0x47bb52,'suppliers':_0x580d9b['body'][_0x18bebf(0x165)],'date':_0x1e2e8a,'warehouse_name':_0x592dd6,'return_product':_0x4b6eb2,'note':_0x62926f,'room':_0x3d6906,'to_warehouse_name':_0x43b41e,'to_room':_0x417cbc}),_0x574581=await _0x3e88e4['save']();console[_0x18bebf(0x1c0)](_0x3e88e4);const _0x384431=await purchases_return['findOne']({'invoice':_0x47bb52}),_0x45f158=await warehouse['findOne']({'name':_0x43b41e,'room':_0x417cbc});_0x384431[_0x18bebf(0x1f7)][_0x18bebf(0x216)](_0x1b67ad=>{var _0x4cd163=_0x18bebf,_0x459fdc=0x0;const _0x1034c3=_0x45f158[_0x4cd163(0xfa)][_0x4cd163(0x12e)](_0x270f79=>{var _0x27ff5a=_0x4cd163;_0x270f79[_0x27ff5a(0x13b)]==_0x1b67ad[_0x27ff5a(0x13b)]&&_0x270f79[_0x27ff5a(0x157)]==_0x1b67ad['floorlevel']&&_0x270f79[_0x27ff5a(0x1bc)]==_0x1b67ad[_0x27ff5a(0x1bc)]&&_0x270f79['bin']==_0x1b67ad[_0x27ff5a(0x119)]&&_0x270f79['bay']==_0x1b67ad[_0x27ff5a(0x198)]&&(_0x270f79[_0x27ff5a(0x195)]=parseInt(_0x270f79[_0x27ff5a(0x195)])-parseInt(_0x1b67ad[_0x27ff5a(0x17a)]),_0x459fdc++);});_0x459fdc=='0'&&(_0x45f158[_0x4cd163(0xfa)]=_0x45f158[_0x4cd163(0xfa)][_0x4cd163(0x18e)]({'product_name':_0x1b67ad[_0x4cd163(0x13b)],'product_stock':_0x1b67ad[_0x4cd163(0x17a)],'primary_code':_0x1b67ad[_0x4cd163(0x1a7)],'secondary_code':_0x1b67ad['secondary_code'],'product_code':_0x1b67ad[_0x4cd163(0x219)],'storage':_0x1b67ad[_0x4cd163(0x1f2)],'rack':_0x1b67ad[_0x4cd163(0x118)],'bay':_0x1b67ad[_0x4cd163(0x198)],'bin':_0x1b67ad[_0x4cd163(0x119)],'type':_0x1b67ad[_0x4cd163(0x1bc)],'floorlevel':_0x1b67ad['floorlevel'],'maxProducts':_0x1b67ad['maxStocks'],'unit':_0x1b67ad[_0x4cd163(0x151)],'secondary_unit':_0x1b67ad[_0x4cd163(0x186)],'expiry_date':_0x1b67ad[_0x4cd163(0x117)]}));}),await _0x45f158[_0x18bebf(0x202)]();const _0xc3907a=await purchases[_0x18bebf(0x15a)]({'invoice':_0x47bb52});_0xc3907a['return_data']=_0x18bebf(0x10e);const _0x237ccc=await _0xc3907a[_0x18bebf(0x202)](),_0x2a64bb=new s_payment_data({'invoice':_0x47bb52,'suppliers':_0x580d9b[_0x18bebf(0x132)][_0x18bebf(0x165)],'reason':'Purchase\x20Return'});await _0x2a64bb['save']();const _0x552531=await master_shop['find']();console[_0x18bebf(0x1c0)](_0x18bebf(0x149),_0x552531[0x0][_0x18bebf(0x108)]);const _0x3ba90e=await email_settings[_0x18bebf(0x15a)](),_0x272aee=await suppliers[_0x18bebf(0x15a)]({'name':_0x580d9b[_0x18bebf(0x132)]['suppliers']});console[_0x18bebf(0x1c0)](_0x18bebf(0x152),_0x272aee);_0x552531[0x0]['currency_placement']==0x1?(right_currency=_0x552531[0x0][_0x18bebf(0x12b)],left_currency=''):(right_currency='',left_currency=_0x552531[0x0][_0x18bebf(0x12b)]);var _0x5526a4=_0x940d5c,_0x5c4e20=_0x35e6d1,_0x5ccbf2='',_0x1a2817;for(_0x1a2817 in _0x5526a4){_0x5ccbf2+=_0x18bebf(0x207)+_0x18bebf(0x128)+_0x5526a4[_0x1a2817]+_0x18bebf(0x166)+_0x18bebf(0x128)+_0x5c4e20[_0x1a2817]+_0x18bebf(0x166)+_0x18bebf(0x162);}console[_0x18bebf(0x1c0)](_0x18bebf(0x1e4),_0x5ccbf2);let _0x1e1d18=nodemailer['createTransport']({'service':_0x18bebf(0x131),'auth':{'user':_0x3ba90e[_0x18bebf(0x16b)],'pass':_0x3ba90e[_0x18bebf(0x10c)]}}),_0x393420={'from':_0x3ba90e[_0x18bebf(0x16b)],'to':_0x272aee[_0x18bebf(0x16b)],'subject':_0x18bebf(0x102),'attachments':[{'filename':_0x18bebf(0x1da),'path':__dirname+_0x18bebf(0xfd)+_0x18bebf(0x133)+_0x552531[0x0][_0x18bebf(0x108)],'cid':_0x18bebf(0x187)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x18bebf(0x15c)+_0x18bebf(0x19f)+_0x18bebf(0x1e6)+_0x18bebf(0x19f)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x18bebf(0x184)+_0x18bebf(0x19f)+_0x18bebf(0x1d5)+_0x552531[0x0][_0x18bebf(0x1ec)]+_0x18bebf(0x1ef)+_0x18bebf(0x184)+_0x18bebf(0x184)+_0x18bebf(0x200)+_0x18bebf(0x19f)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x18bebf(0xfe)+_0x47bb52+'\x20'+_0x18bebf(0x1ab)+_0x18bebf(0x134)+_0x1e2e8a+'\x20'+_0x18bebf(0x196)+_0x18bebf(0x11e)+_0x18bebf(0x184)+_0x18bebf(0x1b1)+_0x18bebf(0x20c)+'<tr>'+_0x18bebf(0x190)+_0x18bebf(0x199)+_0x18bebf(0x11b)+_0x18bebf(0x1f4)+_0x18bebf(0x162)+'</thead>'+_0x18bebf(0x1b3)+'\x20'+_0x5ccbf2+'\x20'+_0x18bebf(0x130)+_0x18bebf(0x1ad)+_0x18bebf(0x19f)+_0x18bebf(0x205)+_0x18bebf(0x1c5)+_0x552531[0x0][_0x18bebf(0x1ec)]+_0x18bebf(0x11e)+_0x18bebf(0x184)+_0x18bebf(0x184)+_0x18bebf(0x169)};_0x1e1d18['sendMail'](_0x393420,function(_0x1be143,_0x2c4300){var _0x26086d=_0x18bebf;_0x1be143?(console[_0x26086d(0x1c0)](_0x1be143),console[_0x26086d(0x1c0)]('Error\x20Occurs')):console[_0x26086d(0x1c0)](_0x26086d(0x16a));}),_0x580d9b['flash'](_0x18bebf(0x164),'purchases\x20item\x20return\x20successfull'),_0x25b5c1['redirect'](_0x18bebf(0x156));}catch(_0x10a520){console[_0x18bebf(0x1c0)](_0x10a520),_0x25b5c1[_0x18bebf(0x173)](0xc8)['json']({'message':_0x10a520['message']});}}),router[a0_0x1b96eb(0x1db)](a0_0x1b96eb(0x210),auth,async(_0x3d6035,_0x1bec35)=>{var _0x310fbc=a0_0x1b96eb;try{const {username:_0x5c5c00,email:_0x1a8bc2,role:_0x374541}=_0x3d6035['user'],_0x30b8cd=_0x3d6035[_0x310fbc(0x144)],_0x2ccb28=await profile[_0x310fbc(0x15a)]({'email':_0x30b8cd[_0x310fbc(0x16b)]}),_0x2bf16c=await master_shop[_0x310fbc(0x110)](),_0x5290cc=_0x3d6035[_0x310fbc(0x115)]['id'],_0x2e8dcd=await purchases[_0x310fbc(0x12f)](_0x5290cc);if(_0x2bf16c[0x0][_0x310fbc(0x1cc)]==_0x310fbc(0x213))var _0xd97878=users[_0x310fbc(0x171)];else{if(_0x2bf16c[0x0][_0x310fbc(0x1cc)]=='Hindi')var _0xd97878=users[_0x310fbc(0x19c)];else{if(_0x2bf16c[0x0][_0x310fbc(0x1cc)]=='German')var _0xd97878=users[_0x310fbc(0x212)];else{if(_0x2bf16c[0x0][_0x310fbc(0x1cc)]==_0x310fbc(0x18b))var _0xd97878=users['Spanish'];else{if(_0x2bf16c[0x0]['language']==_0x310fbc(0x201))var _0xd97878=users[_0x310fbc(0x201)];else{if(_0x2bf16c[0x0]['language']=='Portuguese\x20(BR)')var _0xd97878=users[_0x310fbc(0x1ff)];else{if(_0x2bf16c[0x0]['language']==_0x310fbc(0x1fb))var _0xd97878=users['Chinese'];else{if(_0x2bf16c[0x0][_0x310fbc(0x1cc)]==_0x310fbc(0x12d))var _0xd97878=users[_0x310fbc(0x185)];}}}}}}}_0x1bec35['render'](_0x310fbc(0x1bd),{'success':_0x3d6035['flash']('success'),'errors':_0x3d6035[_0x310fbc(0x138)](_0x310fbc(0x1a4)),'role':_0x30b8cd,'profile':_0x2ccb28,'alldata':_0x2e8dcd,'master_shop':_0x2bf16c,'language':_0xd97878}),console[_0x310fbc(0x1c0)](alldata);}catch(_0x2809e0){console[_0x310fbc(0x1c0)](_0x2809e0);}}),router[a0_0x1b96eb(0x206)](a0_0x1b96eb(0x167),async(_0x13549c,_0x864951)=>{var _0xdbfc49=a0_0x1b96eb;const {product_code:_0x410e01}=_0x13549c[_0xdbfc49(0x132)];var _0x5614d1;const _0xc575d7=await product['aggregate']([{'$match':{'primary_code':_0x410e01,'product_category':_0xdbfc49(0x1b0)}},{'$group':{'_id':_0xdbfc49(0x20e),'name':{'$first':_0xdbfc49(0x179)},'category':{'$first':_0xdbfc49(0x175)},'brand':{'$first':_0xdbfc49(0x1fd)},'unit':{'$first':_0xdbfc49(0x1d7)},'alertquantity':{'$first':_0xdbfc49(0x1c6)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0xdbfc49(0x1d3)},'secondary_code':{'$first':_0xdbfc49(0x13c)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0xdbfc49(0x1f6)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0xdbfc49(0x17e)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x391fa2=await product['aggregate']([{'$match':{'secondary_code':_0x410e01,'product_category':_0xdbfc49(0x1b0)}},{'$group':{'_id':_0xdbfc49(0x20e),'name':{'$first':_0xdbfc49(0x179)},'category':{'$first':_0xdbfc49(0x175)},'brand':{'$first':_0xdbfc49(0x1fd)},'unit':{'$first':_0xdbfc49(0x1d7)},'alertquantity':{'$first':_0xdbfc49(0x1c6)},'product_code':{'$first':_0xdbfc49(0x192)},'primary_code':{'$first':_0xdbfc49(0x1d3)},'secondary_code':{'$first':_0xdbfc49(0x13c)},'maxStocks':{'$first':_0xdbfc49(0x1e9)},'maxProdPerUnit':{'$first':_0xdbfc49(0x1f6)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0xdbfc49(0x17e)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0xc575d7[_0xdbfc49(0x1de)]>0x0)_0x5614d1=_0xc575d7;else _0x391fa2[_0xdbfc49(0x1de)]>0x0&&(_0x5614d1=_0x391fa2);_0x864951[_0xdbfc49(0x13f)](_0x5614d1);}),router['post']('/CheckingWarehouse',async(_0x53345a,_0x454983)=>{var _0x17589e=a0_0x1b96eb;const {primaryCode:_0x191c7c,secondaryCode:_0x111c73,productCode:_0x1d0506,bay:_0xc5d54a,bin:_0xf02a4d,types:_0x3b1fd9,pallet:_0x4829f9,warehouses:_0x2f1e86,room:_0x95bef2}=_0x53345a[_0x17589e(0x132)];console[_0x17589e(0x1c0)](_0x53345a[_0x17589e(0x132)]);try{const _0x3f8351=await warehouse['aggregate']([{'$match':{'name':_0x2f1e86,'room':_0x95bef2}},{'$unwind':_0x17589e(0x100)},{'$match':{'product_details.bay':_0xc5d54a,'product_details.bin':_0xf02a4d,'product_details.type':_0x3b1fd9}},{'$group':{'_id':_0x17589e(0x188),'name':{'$first':_0x17589e(0x13d)},'product_stock':{'$first':_0x17589e(0x1e7)},'level':{'$first':_0x17589e(0x1ca)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x17589e(0x1e8)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x454983[_0x17589e(0x173)](0xc8)['json'](_0x3f8351);}catch(_0x5cd5b4){_0x454983[_0x17589e(0x173)](0x194)[_0x17589e(0x13f)]({'message':_0x5cd5b4[_0x17589e(0x170)]});}}),module[a0_0x1b96eb(0x158)]=router;function a0_0x4a7d(){var _0x1b22bc=['Error\x20Occurs','product_cat','$secondary_unit','$product_details.primary_code','Room_name','edit_purchases_view','production_date','Rack\x20D','</div>','Arabic','secondary_unit','logo','$product_details._id','$paid_amount','types','Spanish','18lpNxfj','createTransport','concat','edit_purchases','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/all_purchases/view/','$product_code','/preview/:id','$note','product_stock','</span>','random','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','host','maxperunit','Hindi','express','sendMail','<div>','prod_primunit','add_purchases','Rack\x20C','purchase_quantity','errors','alertQTY','aggregate','primary_code','room','$product_details.storage','toString','<span\x20style=\x22float:\x20right;\x22>','129407pnKosj','</table>','$suppliers_docs','$room','Raw\x20Materials','<table\x20style=\x22width:\x20100%\x20!important;\x22>','prod_name','<tbody\x20style=\x22text-align:\x20center;\x22>','getDate','prod_code','paid_amount','role','2798056RkSZDk','filter','$product_details.type','date','type','all_purchases_barcode','primary_code_hide','prod_Qty','log','</thead>','all','Rack\x20F','purchase_invoice','<h5>','$alertquantity','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$invoice','$product_details.level','floor','language','$return_data','9VAQtVT','RoomAssign','../public/language/languages.json','$product','Level','$primary_code','delivery_code','<h2>\x20','secondary_code','$unit','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','$product.bay','Logo.png','get','/view','render','length','263155pHRhwh','level','/view/add_purchases','actual_qty','/invoice/:id','product_list','$suppliers','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.product_stock','$product_details.pallet','$maxStocks','return_purchase','12614450oPxdRQ','site_title','$batch_code','Ambient','\x20</h2>','\x20<>\x20','redirect','storage','delivery_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','<html><head><title></title>','$maxProdPerUnit','return_product','warehouse','note','/view/:id','Chinese','$product_details.bay','$brand','secondary_code_hide','Portuguese','<hr\x20class=\x22my-3\x22>','French','save','$product.type','stocks','<strong>\x20Regards\x20</strong>','post','<tr>','due_amount','stock_quantity','5163150nJSpKg','Paid\x20For\x20Purchase','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','product_code_hide','$_id','12WJanfN','/barcode/:id','room_name','German','English\x20(US)','all_purchases','$product_details.product_code','forEach','payment\x20successfull','string','product_code','add_purchases\x20error','Rack\x20E','getFullYear','\x20<\x20wew\x20>\x20','Floor','product_details','/view/return_purchase/:id','rak','/../public','\x20Order\x20Number\x20:\x20','$product.bin','$product_details','quantity','Purchase\x20Return\x20Mail','Enclosed','padStart','JO_number','push','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','image','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Shelves','MaxStocks_data','password','prod_secondunit','True','$product.floorlevel','find','Receiving\x20Area','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$expiry_date','$product.room_name','params','table\x20page','expiry_date','rack','bin','then','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','prod_pallet','prod_invoice','</h5>','Rack\x20B','getMonth','$product_details.bin','INC-','amount','$date','$warehouse_name','batch_code','back','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','An\x20error\x20occurred\x20while\x20saving\x20data.','currency','maxStocks','Arabic\x20(ae)','map','findById','</tbody>','gmail','body','/upload/','\x20Order\x20Date\x20:\x20','prod_qty','suppliers_docs','$product.quantity','flash','prod_level','$due_amount','product_name','$secondary_code','$product_details.product_name','RMSEmail','json','finalize','8219610itlfGg','product','warehouse_name','user','master','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.rack','1116708fryChy','add\x20post','/view/add_purchases/:id','COLD\x20STORAGE','Rack\x20A','ejs','Enabled','There\x27s\x20a\x20error\x20in\x20this\x20transaction','isle','standard_unit','suppliers_data','$finalize','nodemailer','invoice','/all_purchases/view','floorlevel','exports','max_product_unit','findOne','Purchase\x20Mail','</head><body>','$product_details.floorlevel','pallet','/give_payment/:id','staff','deliverycode','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','success','suppliers','</td>','/barcode_scanner','Portuguese\x20(BR)','</body></html>','Email\x20sent\x20successfully','email','purchase\x20data\x20update\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','slice','$product_details.secondary_code','message','English','<h5\x20style=\x22text-align:\x20left;\x22>','status','prod_unit','$category','port','error','prod_isle','$name','return_qty','../middleware/auth'];a0_0x4a7d=function(){return _0x1b22bc;};return a0_0x4a7d();}