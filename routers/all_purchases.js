var a0_0x842d29=a0_0x42a3;(function(_0x3bc968,_0x14ff8c){var _0x1e13d6=a0_0x42a3,_0xc43f4f=_0x3bc968();while(!![]){try{var _0x9fba72=parseInt(_0x1e13d6(0x1ed))/0x1+parseInt(_0x1e13d6(0x1d2))/0x2+-parseInt(_0x1e13d6(0x1f5))/0x3+-parseInt(_0x1e13d6(0x201))/0x4*(parseInt(_0x1e13d6(0x1de))/0x5)+-parseInt(_0x1e13d6(0x127))/0x6+-parseInt(_0x1e13d6(0x216))/0x7+parseInt(_0x1e13d6(0x1b9))/0x8;if(_0x9fba72===_0x14ff8c)break;else _0xc43f4f['push'](_0xc43f4f['shift']());}catch(_0x412640){_0xc43f4f['push'](_0xc43f4f['shift']());}}}(a0_0x5441,0xcd585));const express=require('express'),app=express(),router=express[a0_0x842d29(0x132)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x842d29(0x1be)),nodemailer=require(a0_0x842d29(0x13c));function a0_0x42a3(_0x2675cb,_0x2370b6){var _0x54412d=a0_0x5441();return a0_0x42a3=function(_0x42a377,_0x3ec4f6){_0x42a377=_0x42a377-0x11c;var _0x2769f8=_0x54412d[_0x42a377];return _0x2769f8;},a0_0x42a3(_0x2675cb,_0x2370b6);}var ejs=require('ejs');const path=require(a0_0x842d29(0x1c2)),users=require(a0_0x842d29(0x15f));router['get'](a0_0x842d29(0x204),auth,async(_0x16f7ac,_0x520553)=>{var _0xf88519=a0_0x842d29;try{const {username:_0x33244e,email:_0x103f01,role:_0x329d30}=_0x16f7ac[_0xf88519(0x16a)],_0x583efc=_0x16f7ac[_0xf88519(0x16a)],_0x232ce2=await profile['findOne']({'email':_0x583efc[_0xf88519(0x23e)]}),_0x3427fe=await staff[_0xf88519(0x165)]({'email':_0x583efc[_0xf88519(0x23e)]});if(_0x583efc[_0xf88519(0x168)]==_0xf88519(0x1a5)){const _0x2f33ac=await staff['findOne']({'email':_0x583efc[_0xf88519(0x23e)]});}const _0x1417aa=await master_shop['find']();let _0x4245c0;if(_0x583efc[_0xf88519(0x168)]==_0xf88519(0x1a5)){const _0x436c42=await staff['findOne']({'email':_0x583efc['email']});_0x4245c0=await purchases[_0xf88519(0x11e)]([{'$match':{'warehouse_name':_0x436c42[_0xf88519(0x22e)]}},{'$lookup':{'from':_0xf88519(0x224),'localField':_0xf88519(0x224),'foreignField':_0xf88519(0x1d9),'as':_0xf88519(0x157)}},{'$unwind':_0xf88519(0x1c0)},{'$unwind':_0xf88519(0x189)},{'$group':{'_id':_0xf88519(0x186),'invoice':{'$first':_0xf88519(0x225)},'suppliers':{'$first':_0xf88519(0x1c9)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$first':_0xf88519(0x20c)},'product':{'$push':_0xf88519(0x189)},'note':{'$first':_0xf88519(0x19d)},'paid_amount':{'$first':_0xf88519(0x22a)},'due_amount':{'$first':_0xf88519(0x187)},'return_data':{'$first':_0xf88519(0x121)},'batch_code':{'$first':_0xf88519(0x194)},'expiry_date':{'$first':_0xf88519(0x1cf)},'suppliers_docs':{'$first':_0xf88519(0x1c0)},'total_product_quantity':{'$sum':_0xf88519(0x207)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':_0xf88519(0x147)},'type':{'$addToSet':_0xf88519(0x138)},'floorlevel':{'$addToSet':_0xf88519(0x220)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x4245c0=await purchases['aggregate']([{'$lookup':{'from':_0xf88519(0x224),'localField':_0xf88519(0x224),'foreignField':'name','as':_0xf88519(0x157)}},{'$unwind':_0xf88519(0x1c0)},{'$unwind':_0xf88519(0x189)},{'$group':{'_id':'$_id','invoice':{'$first':_0xf88519(0x225)},'suppliers':{'$first':_0xf88519(0x1c9)},'date':{'$first':_0xf88519(0x15a)},'warehouse_name':{'$first':_0xf88519(0x1e1)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':_0xf88519(0x189)},'note':{'$first':_0xf88519(0x19d)},'paid_amount':{'$first':_0xf88519(0x22a)},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':_0xf88519(0x121)},'batch_code':{'$first':_0xf88519(0x194)},'expiry_date':{'$first':_0xf88519(0x1cf)},'suppliers_docs':{'$first':'$suppliers_docs'},'total_product_quantity':{'$sum':_0xf88519(0x207)},'level':{'$addToSet':_0xf88519(0x231)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0xf88519(0x138)},'floorlevel':{'$addToSet':'$product.floorlevel'},'finalize':{'$first':_0xf88519(0x163)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x1417aa[0x0][_0xf88519(0x14c)]==_0xf88519(0x192)){var _0x23ae51=users['English'];console[_0xf88519(0x169)](_0x23ae51);}else{if(_0x1417aa[0x0][_0xf88519(0x14c)]==_0xf88519(0x1fe))var _0x23ae51=users[_0xf88519(0x1fe)];else{if(_0x1417aa[0x0][_0xf88519(0x14c)]==_0xf88519(0x1d4))var _0x23ae51=users[_0xf88519(0x1d4)];else{if(_0x1417aa[0x0][_0xf88519(0x14c)]==_0xf88519(0x22b))var _0x23ae51=users[_0xf88519(0x22b)];else{if(_0x1417aa[0x0][_0xf88519(0x14c)]==_0xf88519(0x1eb))var _0x23ae51=users['French'];else{if(_0x1417aa[0x0][_0xf88519(0x14c)]=='Portuguese\x20(BR)')var _0x23ae51=users['Portuguese'];else{if(_0x1417aa[0x0][_0xf88519(0x14c)]==_0xf88519(0x209))var _0x23ae51=users[_0xf88519(0x209)];else{if(_0x1417aa[0x0][_0xf88519(0x14c)]==_0xf88519(0x16b))var _0x23ae51=users[_0xf88519(0x23d)];}}}}}}}_0x520553[_0xf88519(0x123)](_0xf88519(0x23a),{'success':_0x16f7ac[_0xf88519(0x1a6)](_0xf88519(0x19e)),'errors':_0x16f7ac[_0xf88519(0x1a6)]('errors'),'purchases':_0x4245c0,'role':_0x583efc,'profile':_0x232ce2,'master_shop':_0x1417aa,'language':_0x23ae51});}catch(_0x8908fa){console['log']('table\x20page',_0x8908fa),_0x520553[_0xf88519(0x211)](0xc8)[_0xf88519(0x1bd)]({'message':_0x8908fa[_0xf88519(0x196)]});}});function BayBinSelected(_0x122953,_0x2c5b21){var _0xb4262e=a0_0x842d29,_0x56c294=[],_0x4c0b8b=[],_0x1454c8=[],_0xf3bd3c=[],_0x53da49=[],_0x2d2eb6=[];let _0x3b2bb8=[];if(_0x122953==_0xb4262e(0x1e5))switch(_0x2c5b21){case'Rack\x20A':_0x56c294=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4c0b8b=[0x1,0x2],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=['Level','Floor'],_0x53da49=['D'],_0x2d2eb6=['A'];break;case _0xb4262e(0x139):_0x56c294=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4c0b8b=[0x1,0x2],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=[_0xb4262e(0x149),_0xb4262e(0x134)],_0x53da49=['D'],_0x2d2eb6=['B'];break;case _0xb4262e(0x1fc):_0x56c294=[0x0],_0x4c0b8b=[0x0],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=[_0xb4262e(0x134)],_0x53da49=['D'],_0x2d2eb6=['S'];break;case'Receiving\x20Area':_0x56c294=[0x0],_0x4c0b8b=[0x0],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x1454c8=[_0xb4262e(0x134)],_0x53da49=['D'],_0x2d2eb6=['R'];break;}else{if(_0x122953==_0xb4262e(0x232))switch(_0x2c5b21){case _0xb4262e(0x144):_0x56c294=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4c0b8b=['B','F'],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=[_0xb4262e(0x149),_0xb4262e(0x134)],_0x53da49=['C'],_0x2d2eb6=['A'];break;case'Rack\x20B':_0x56c294=[0x5,0x4,0x3,0x2,0x1],_0x4c0b8b=['F','B','S'],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=[_0xb4262e(0x149),_0xb4262e(0x134)],_0x53da49=['C'],_0x2d2eb6=['B'];break;case _0xb4262e(0x1b0):_0x56c294=[0x1,0x2,0x3,0x4,0x5],_0x4c0b8b=['B','F','S'],_0xf3bd3c=[0x5,0x4,0x3,0x2,0x1],_0x1454c8=[_0xb4262e(0x149),'Floor'],_0x53da49=['C'],_0x2d2eb6=['C'];break;case _0xb4262e(0x1c5):_0x56c294=[0x5,0x4,0x3,0x2,0x1],_0x4c0b8b=['F','B','S'],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=[_0xb4262e(0x149),_0xb4262e(0x134)],_0x53da49=['C'],_0x2d2eb6=['D'];break;case _0xb4262e(0x181):_0x56c294=[0x4,0x3,0x2,0x1],_0x4c0b8b=[0x1,0x2],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=[_0xb4262e(0x149),_0xb4262e(0x134)],_0x53da49=['C'],_0x2d2eb6=['E'];break;case _0xb4262e(0x14b):_0x56c294=[0x1,0x2,0x3],_0x4c0b8b=[0x1,0x2],_0xf3bd3c=[0x1,0x2,0x3,0x4,0x5],_0x1454c8=[_0xb4262e(0x149)],_0x53da49=['C'],_0x2d2eb6=['F'];break;}}return{'levels':_0x56c294,'Isle':_0x4c0b8b,'rack':_0xf3bd3c,'type':_0x1454c8,'storage':_0x53da49,'rak':_0x2d2eb6};}async function getRandom8DigitNumber(){var _0x13f720=a0_0x842d29;const _0x12fbb0=0x989680,_0x1931dc=0x5f5e0ff,_0x50259d=Math[_0x13f720(0x17a)](Math['random']()*(_0x1931dc-_0x12fbb0+0x1))+_0x12fbb0;var _0x479b14;const _0x272b6b=await purchases[_0x13f720(0x165)]({'invoice':_0x13f720(0x195)+_0x50259d});return _0x272b6b&&_0x272b6b['length']>0x0?_0x479b14=_0x13f720(0x195)+_0x50259d:_0x479b14=_0x13f720(0x195)+_0x50259d,_0x479b14;}function a0_0x5441(){var _0x4c15a7=['2865772aStxfr','gmail','JO_number','stock_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.product_code','secondary_unit','primary_code_hide','$product_details.product_stock','forEach','$product.floorlevel','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','purchases\x20item\x20return\x20successfull','purchase_invoice','suppliers','$invoice','<html><head><title></title>','suppliers_data','room_name','production_date','$paid_amount','Spanish','<h2>\x20','delivery_date','warehouse','return_purchase','master','$product.bay','COLD\x20STORAGE','Enclosed','currency','Paid\x20For\x20Purchase','errors','primary_code','/view/:id','/give_payment/:id','all_purchases','max_product_unit','actual_uom','Arabic','email','rack','<tbody\x20style=\x22text-align:\x20center;\x22>','return_qty','add_purchases','expiry_date','aggregate','string','$product_details','$return_data','$product_details.type','render','product','$name','find','2507658Lrntkz','$brand','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</table>','standard_unit','/barcode/:id','level','MaxStocks_data','user_id','</div>','\x20<\x20wew\x20>\x20','Router','prod_name','Floor','product_cat','</tr>','save','$product.type','Rack\x20B','prod_primunit','$product_details.floorlevel','nodemailer','due_amount','host','<div>','$maxStocks','return_product','/all_purchases/view','params','Rack\x20A','$product_details.product_name','prod_cat','$product.bin','Portuguese\x20(BR)','Level','Purchase\x20Return','Rack\x20F','language','$alertquantity','POnumber','paid_amount','English','bay','prod_Qty','True','</tbody>','$product_details.maxProducts','Portuguese','suppliers_docs','actual_qty','</body></html>','$date','/invoice/:id','concat','invoice','<strong>\x20Regards\x20</strong>','../public/language/languages.json','product_name','product_code','note','$finalize','\x20<>\x20','findOne','Purchase\x20Return\x20Mail','createTransport','role','log','user','Arabic\x20(ae)','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$maxProdPerUnit','padStart','$product_details.rack','room','$product_details.bin','<tr>','Email\x20sent\x20successfully','edit_purchases_view','maxStocks','foreach\x20newproduct','getFullYear','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','error','floor','$secondary_code','</td>','/view/add_purchases','return_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</thead>','Rack\x20E','product_details','purchase\x20data\x20update\x20successfully','</head><body>','storage','$_id','$due_amount','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product','password','prod_code','prod_pallet','$category','$product_details.secondary_code','getDate','floorlevel','filter','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$batch_code','INC-','message','</span>','types','date','type','findById','$product_details.isle','$note','success','<h5\x20style=\x22text-align:\x20left;\x22>','logo','bin','\x20</h2>','isle','secondary_code','staff','flash','Room_name','warehouse_name','/preview/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','map','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','prod_isle','Raw\x20Materials','here','Rack\x20C','product_stock','</h5>','prod_unit','Purchase\x20data\x20added\x20successfully','/upload/','catch','$product_code','<span\x20style=\x22float:\x20right;\x22>','18538104lxzbLq','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/../public','\x20Order\x20Date\x20:\x20','json','../middleware/auth','$product_details.pallet','$suppliers_docs','redirect','path','An\x20error\x20occurred.','add\x20post','Rack\x20D','/barcode_scanner','get','exports','$suppliers','RoomAssign','$product_details.bay','stocks','Logo.png','getMonth','$expiry_date','alertQTY','<!DOCTYPE\x20html>','1421088pIEgwM','finalize','German','\x20Order\x20Number\x20:\x20','$product_details._id','$primary_code','purchase_quantity','name','toString','sendMail','maxperunit','/view/add_purchases/:id','1035alagic','body','prod_qty','$warehouse_name','all','<h5>','$unit','DRY\x20STORAGE','currency_placement','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','all_purchases_barcode','site_title','$product_details.storage','French','<hr\x20class=\x22my-3\x22>','468534PVaLWB','deliverycode','then','pallet','Ambient','product_list','delivery_code','Receiving\x20Area','2799765eMpPdB','abs','edit_purchases','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','batch_code','post','Shelves','secondary_code_hide','Hindi','slice','Return\x20Goods','17288sySPBL','$product_details.expiry_date','port','/view','$product_details.level','Enabled','$product.quantity','rak','Chinese','Purchase\x20Mail','prod_secondunit','$room','image','quantity','$secondary_unit','stock_quantity','status','/view/return_purchase/:id','length','/CheckingWarehouse','prod_level'];a0_0x5441=function(){return _0x4c15a7;};return a0_0x5441();}router['get'](a0_0x842d29(0x17d),auth,async(_0xdd5246,_0x34d37d)=>{var _0x33206b=a0_0x842d29;try{const {username:_0x472519,email:_0x4dedd9,role:_0x275dc3}=_0xdd5246['user'],_0x19cb46=_0xdd5246['user'],_0x5783c7=await profile[_0x33206b(0x165)]({'email':_0x19cb46[_0x33206b(0x23e)]}),_0x2ea4c9=await master_shop[_0x33206b(0x126)](),_0x1b137f=await staff[_0x33206b(0x165)]({'email':_0x19cb46[_0x33206b(0x23e)]}),_0x3923ff=await suppliers['find']({});let _0x264d3e;if(_0x19cb46[_0x33206b(0x168)]==_0x33206b(0x1a5)){const _0x24dbe2=await staff[_0x33206b(0x165)]({'email':_0x19cb46[_0x33206b(0x23e)]});_0x264d3e=await warehouse[_0x33206b(0x11e)]([{'$match':{'status':_0x33206b(0x206),'name':_0x24dbe2['warehouse'],'warehouse_category':_0x33206b(0x1ae),'name':{'$ne':_0x33206b(0x200)}}},{'$group':{'_id':_0x33206b(0x125),'name':{'$first':_0x33206b(0x125)}}}]);}else _0x264d3e=await warehouse['aggregate']([{'$match':{'status':_0x33206b(0x206),'warehouse_category':_0x33206b(0x1ae),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x33206b(0x125),'name':{'$first':_0x33206b(0x125)}}}]);const _0x5e728e=await product[_0x33206b(0x126)]({}),_0x5987df=await warehouse[_0x33206b(0x126)]({'status':_0x33206b(0x206)}),_0x19bfc8=await purchases[_0x33206b(0x126)]({}),_0x38114f=_0x19bfc8[_0x33206b(0x213)]+0x1,_0x7741d5='INC-'+_0x38114f[_0x33206b(0x1da)]()[_0x33206b(0x16e)](0x5,'0');var _0x31eea7=[_0x33206b(0x1f1),_0x33206b(0x233)];if(_0x2ea4c9[0x0][_0x33206b(0x14c)]==_0x33206b(0x192))var _0x3dda32=users[_0x33206b(0x150)];else{if(_0x2ea4c9[0x0][_0x33206b(0x14c)]==_0x33206b(0x1fe))var _0x3dda32=users[_0x33206b(0x1fe)];else{if(_0x2ea4c9[0x0][_0x33206b(0x14c)]=='German')var _0x3dda32=users[_0x33206b(0x1d4)];else{if(_0x2ea4c9[0x0][_0x33206b(0x14c)]=='Spanish')var _0x3dda32=users['Spanish'];else{if(_0x2ea4c9[0x0]['language']==_0x33206b(0x1eb))var _0x3dda32=users[_0x33206b(0x1eb)];else{if(_0x2ea4c9[0x0][_0x33206b(0x14c)]==_0x33206b(0x148))var _0x3dda32=users[_0x33206b(0x156)];else{if(_0x2ea4c9[0x0][_0x33206b(0x14c)]==_0x33206b(0x209))var _0x3dda32=users[_0x33206b(0x209)];else{if(_0x2ea4c9[0x0][_0x33206b(0x14c)]==_0x33206b(0x16b))var _0x3dda32=users[_0x33206b(0x23d)];}}}}}}}const _0x3ecf18=getRandom8DigitNumber();_0x3ecf18['then'](_0x58d5ee=>{var _0x2c5f48=_0x33206b;_0x34d37d[_0x2c5f48(0x123)](_0x2c5f48(0x11c),{'success':_0xdd5246[_0x2c5f48(0x1a6)](_0x2c5f48(0x19e)),'errors':_0xdd5246[_0x2c5f48(0x1a6)](_0x2c5f48(0x236)),'role':_0x19cb46,'profile':_0x5783c7,'suppliers':_0x3923ff,'warehouse':_0x264d3e,'product':_0x5e728e,'invoice':_0x58d5ee,'master_shop':_0x2ea4c9,'language':_0x3dda32,'find_data':_0x5987df,'rooms_data':_0x31eea7});})[_0x33206b(0x1b6)](_0x8a88c2=>{var _0x3e695c=_0x33206b;_0xdd5246[_0x3e695c(0x1a6)](_0x3e695c(0x236),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x34d37d[_0x3e695c(0x1c1)](_0x3e695c(0x142));});}catch(_0x4ce4aa){console[_0x33206b(0x169)](_0x4ce4aa);}}),router[a0_0x842d29(0x1c7)](a0_0x842d29(0x1dd),auth,async(_0x550193,_0x21adc9)=>{var _0x325980=a0_0x842d29;try{const _0x28cf2e=_0x550193['params']['id'];console[_0x325980(0x169)](_0x28cf2e);const _0x18021b=await master_shop['find']();console['log']('master',_0x18021b);const _0x2b7d76=await product['findOne']({'name':_0x28cf2e});console[_0x325980(0x169)](_0x325980(0x124),_0x2b7d76),_0x21adc9[_0x325980(0x211)](0xc8)[_0x325980(0x1bd)]({'product_data':_0x2b7d76,'master':_0x18021b});}catch(_0x204f61){console['log']('add_purchases\x20error',_0x204f61);}}),router[a0_0x842d29(0x1fb)](a0_0x842d29(0x17d),auth,async(_0x38926f,_0x2419fc)=>{var _0x4a98ec=a0_0x842d29;try{const {invoice:_0x10b2e5,date:_0x4794a8,warehouse_name:_0x1d338c,prod_name:_0x3f09ef,prod_code:_0x520deb,prod_qty:_0xf2d87a,prod_unit:_0x47bf70,prod_secondunit:_0x2bb4f1,prod_level:_0x432915,prod_isle:_0x1ad9a1,prod_pallet:_0x317f63,note:_0x2ac0ba,expiry_date:_0x2493c6,batch_code:_0x1b48de,payable:_0x384bf7,due_amount:_0x362abc,Room_name:_0x17e29f,primary_code:_0xe0a808,secondary_code:_0x2fbe26,MaxStocks_data:_0x386fd5,PO_number:_0x2321e5,SCRN:_0x5cb381,JO_number:_0x23969d}=_0x38926f['body'];if(typeof _0x3f09ef==_0x4a98ec(0x11f))var _0x57b6e3=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x133)]],_0x20ba14=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x18b)]],_0x5690f5=[_0x38926f[_0x4a98ec(0x1df)]['prod_Qty']],_0x392282=[_0x38926f[_0x4a98ec(0x1df)]['prod_primunit']],_0x4d34cd=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x20b)]],_0x250b75=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x215)]],_0x384af1=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x237)]],_0x4a9571=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x1a4)]],_0x4a200f=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x12e)]],_0x526612=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x1fa)]],_0x599ad9=[_0x38926f['body'][_0x4a98ec(0x11d)]],_0x4c8c49=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x23b)]],_0x2d677f=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x1d0)]],_0x2721c9=[_0x38926f[_0x4a98ec(0x1df)]['production_date']],_0x3cb4c2=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x146)]],_0x335bae=[_0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x1ca)]],_0x1fbce2=[_0x38926f['body'][_0x4a98ec(0x1ee)]],_0x4566fa=[_0x38926f['body']['prod_invoice']],_0x312aee=[_0x38926f[_0x4a98ec(0x1df)]['actual_qty']],_0x15c848=[_0x38926f[_0x4a98ec(0x1df)]['actual_uom']];else var _0x57b6e3=[..._0x38926f['body'][_0x4a98ec(0x133)]],_0x20ba14=[..._0x38926f['body']['prod_code']],_0x5690f5=[..._0x38926f['body'][_0x4a98ec(0x152)]],_0x392282=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x13a)]],_0x4d34cd=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x20b)]],_0x250b75=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x215)]],_0x384af1=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x237)]],_0x4a9571=[..._0x38926f['body'][_0x4a98ec(0x1a4)]],_0x4a200f=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x12e)]],_0x526612=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x1fa)]],_0x599ad9=[..._0x38926f[_0x4a98ec(0x1df)]['expiry_date']],_0x4c8c49=[..._0x38926f['body'][_0x4a98ec(0x23b)]],_0x2d677f=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x1d0)]],_0x2721c9=[..._0x38926f['body'][_0x4a98ec(0x229)]],_0x3cb4c2=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x146)]],_0x335bae=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x1ca)]],_0x1fbce2=[..._0x38926f[_0x4a98ec(0x1df)]['deliverycode']],_0x4566fa=[..._0x38926f[_0x4a98ec(0x1df)]['prod_invoice']],_0x312aee=[..._0x38926f['body'][_0x4a98ec(0x158)]],_0x15c848=[..._0x38926f[_0x4a98ec(0x1df)][_0x4a98ec(0x23c)]];const _0x2c9503=_0x57b6e3[_0x4a98ec(0x1ab)](_0x1cef8c=>{return _0x1cef8c={'product_name':_0x1cef8c};});_0x312aee['forEach']((_0x181a00,_0x32f5b5)=>{var _0x4c3d6b=_0x4a98ec;_0x2c9503[_0x32f5b5][_0x4c3d6b(0x158)]=Math[_0x4c3d6b(0x1f6)](_0x181a00);}),_0x15c848[_0x4a98ec(0x21f)]((_0x119770,_0x135c8e)=>{var _0x5ade12=_0x4a98ec;_0x2c9503[_0x135c8e][_0x5ade12(0x23c)]=_0x119770;}),_0x20ba14[_0x4a98ec(0x21f)]((_0xfa1023,_0x1ad97c)=>{var _0x5bb9fd=_0x4a98ec;_0x2c9503[_0x1ad97c][_0x5bb9fd(0x161)]=_0xfa1023;}),_0x5690f5[_0x4a98ec(0x21f)]((_0x429cd8,_0x12aa4c)=>{_0x2c9503[_0x12aa4c]['quantity']=Math['abs'](_0x429cd8);}),_0x392282[_0x4a98ec(0x21f)]((_0x7a4104,_0x155b9a)=>{_0x2c9503[_0x155b9a]['standard_unit']=_0x7a4104;}),_0x4d34cd[_0x4a98ec(0x21f)]((_0x52ceac,_0x8066f5)=>{var _0x5d891d=_0x4a98ec;_0x2c9503[_0x8066f5][_0x5d891d(0x21c)]=_0x52ceac;}),_0x250b75[_0x4a98ec(0x21f)]((_0x4f6d34,_0x3fee57)=>{var _0x5f2477=_0x4a98ec;_0x335bae[_0x5f2477(0x21f)]((_0x2bc6c8,_0x3476a2)=>{var _0x49af52=_0x5f2477;if(_0x2bc6c8==_0x49af52(0x1f4)&&_0x3fee57==_0x3476a2){console['log'](_0x2bc6c8+_0x49af52(0x131)+_0x3fee57+'\x20<>\x20'+_0x3476a2+'\x20<>\x20'+_0x4f6d34);var _0x279901=_0x4f6d34['slice'](0x3);_0x2c9503[_0x3fee57][_0x49af52(0x185)]=_0x4f6d34[0x0],_0x2c9503[_0x3fee57][_0x49af52(0x23f)]=_0x4f6d34[0x1],_0x2c9503[_0x3fee57][_0x49af52(0x151)]=0x0,_0x2c9503[_0x3fee57][_0x49af52(0x1a1)]=0x0,_0x2c9503[_0x3fee57]['type']=_0x49af52(0x134),_0x2c9503[_0x3fee57][_0x49af52(0x190)]=_0x279901;}else{if(_0x2bc6c8==_0x49af52(0x1fc)&&_0x3fee57==_0x3476a2){var _0x279901=_0x4f6d34[_0x49af52(0x1ff)](0x3);_0x2c9503[_0x3fee57]['storage']=_0x4f6d34[0x0],_0x2c9503[_0x3fee57][_0x49af52(0x23f)]=_0x4f6d34[0x1],_0x2c9503[_0x3fee57][_0x49af52(0x151)]=0x0,_0x2c9503[_0x3fee57]['bin']=0x0,_0x2c9503[_0x3fee57]['type']=_0x49af52(0x134),_0x2c9503[_0x3fee57][_0x49af52(0x190)]=_0x4f6d34[0x5];}else{if(_0x3fee57==_0x3476a2){if(_0x4f6d34[0x0]=='A'&&_0x4f6d34[0x1]=='L'&&_0x4f6d34[0x2]=='L')console['log'](_0x2bc6c8+'\x20<>\x20'+_0x3fee57+'\x20<>\x20'+_0x3476a2+'\x20<>\x20'+_0x4f6d34+_0x49af52(0x1af)),_0x2c9503[_0x3fee57]['storage']=_0x4f6d34[0x0],_0x2c9503[_0x3fee57][_0x49af52(0x23f)]=_0x4f6d34[0x1],_0x2c9503[_0x3fee57]['bay']=0x0,_0x2c9503[_0x3fee57]['bin']=0x0,_0x2c9503[_0x3fee57]['type']=_0x49af52(0x134),_0x2c9503[_0x3fee57][_0x49af52(0x190)]=_0x4f6d34[0x3];else{var _0x44f7c5;if(_0x4f6d34[0x4]=='L')_0x44f7c5=_0x49af52(0x149);else _0x4f6d34[0x4]=='F'&&(_0x44f7c5=_0x49af52(0x134));_0x2c9503[_0x3fee57][_0x49af52(0x185)]=_0x4f6d34[0x0],_0x2c9503[_0x3fee57][_0x49af52(0x23f)]=_0x4f6d34[0x1],_0x2c9503[_0x3fee57][_0x49af52(0x151)]=_0x4f6d34[0x2],_0x2c9503[_0x3fee57][_0x49af52(0x1a1)]=_0x4f6d34[0x3],_0x2c9503[_0x3fee57]['type']=_0x44f7c5,_0x2c9503[_0x3fee57][_0x49af52(0x190)]=_0x4f6d34[0x5];}}}}});}),_0x384af1['forEach']((_0x5ba24f,_0x3a3e9a)=>{var _0x119fa5=_0x4a98ec;_0x2c9503[_0x3a3e9a][_0x119fa5(0x237)]=_0x5ba24f;}),_0x4a9571[_0x4a98ec(0x21f)]((_0x3a7d07,_0x59e2d1)=>{var _0x15d246=_0x4a98ec;_0x2c9503[_0x59e2d1][_0x15d246(0x1a4)]=_0x3a7d07;}),_0x4a200f[_0x4a98ec(0x21f)]((_0x17b753,_0x12890e)=>{_0x2c9503[_0x12890e]['maxStocks']=_0x17b753;}),_0x526612[_0x4a98ec(0x21f)]((_0x43f8d4,_0x57bcd6)=>{_0x2c9503[_0x57bcd6]['batch_code']=_0x43f8d4;}),_0x599ad9['forEach']((_0xe90b0f,_0x47cf9f)=>{var _0x1d2d35=_0x4a98ec;_0x2c9503[_0x47cf9f][_0x1d2d35(0x11d)]=_0xe90b0f;}),_0x4c8c49[_0x4a98ec(0x21f)]((_0x46223f,_0x5be1ad)=>{var _0x12a038=_0x4a98ec;_0x2c9503[_0x5be1ad][_0x12a038(0x1dc)]=_0x46223f;}),_0x2d677f[_0x4a98ec(0x21f)]((_0x41d16b,_0x3988e2)=>{var _0x56abde=_0x4a98ec;_0x2c9503[_0x3988e2][_0x56abde(0x1d0)]=_0x41d16b;}),_0x2721c9[_0x4a98ec(0x21f)]((_0x591493,_0x1ed4d8)=>{var _0x2b340f=_0x4a98ec;_0x2c9503[_0x1ed4d8][_0x2b340f(0x229)]=_0x591493;}),_0x3cb4c2[_0x4a98ec(0x21f)]((_0x197622,_0x516725)=>{_0x2c9503[_0x516725]['product_cat']=_0x197622;}),_0x335bae[_0x4a98ec(0x21f)]((_0x49434f,_0x4153ff)=>{var _0x120c2c=_0x4a98ec;_0x2c9503[_0x4153ff][_0x120c2c(0x228)]=_0x49434f;}),_0x1fbce2[_0x4a98ec(0x21f)]((_0x498b31,_0x496794)=>{var _0x4df022=_0x4a98ec;_0x2c9503[_0x496794][_0x4df022(0x1f3)]=_0x498b31;}),_0x4566fa[_0x4a98ec(0x21f)]((_0x5eabaf,_0x431c7f)=>{var _0x23c15f=_0x4a98ec;_0x2c9503[_0x431c7f][_0x23c15f(0x15d)]=_0x5eabaf;});const _0x2c5380=_0x335bae[_0x4a98ec(0x1ab)](_0x5b8a04=>{return _0x5b8a04={'room_name':_0x5b8a04};}),_0x12ca84=_0x2c9503[_0x4a98ec(0x191)](_0x5bb8c8=>_0x5bb8c8[_0x4a98ec(0x20e)]!=='0'&&_0x5bb8c8[_0x4a98ec(0x20e)]!==''),_0x2dd710=new purchases({'invoice':_0x10b2e5,'suppliers':_0x38926f['body']['suppliers'],'date':_0x4794a8,'warehouse_name':_0x1d338c,'product':_0x12ca84,'note':_0x2ac0ba,'due_amount':_0x362abc,'POnumber':_0x2321e5,'SCRN':_0x5cb381,'JO_number':_0x23969d,'roomList':_0x2c5380}),_0xc5ddb4=await _0x2dd710[_0x4a98ec(0x137)](),_0x2ca569=await purchases[_0x4a98ec(0x165)]({'invoice':_0x10b2e5}),_0xc1937d=_0x2ca569[_0x4a98ec(0x124)]['map'](async _0x2ea204=>{var _0x36c528=_0x4a98ec,_0x298244=await warehouse['findOne']({'name':_0x1d338c,'room':_0x2ea204[_0x36c528(0x228)]}),_0xd7c46f=0x0;return _0x298244[_0x36c528(0x182)][_0x36c528(0x21f)](_0xe48f6d=>{var _0x14b24b=_0x36c528;_0xe48f6d[_0x14b24b(0x160)]==_0x2ea204[_0x14b24b(0x160)]&&_0xe48f6d['floorlevel']==_0x2ea204[_0x14b24b(0x190)]&&_0xe48f6d['type']==_0x2ea204[_0x14b24b(0x19a)]&&_0xe48f6d['bin']==_0x2ea204[_0x14b24b(0x1a1)]&&_0xe48f6d[_0x14b24b(0x151)]==_0x2ea204['bay']&&_0xe48f6d[_0x14b24b(0x23f)]==_0x2ea204[_0x14b24b(0x23f)]&&_0xe48f6d['storage']==_0x2ea204[_0x14b24b(0x185)]&&_0xe48f6d[_0x14b24b(0x11d)]==_0x2ea204[_0x14b24b(0x11d)]&&_0xe48f6d[_0x14b24b(0x1fa)]==_0x2ea204[_0x14b24b(0x1fa)]&&_0xe48f6d[_0x14b24b(0x229)]==_0x2ea204['production_date']&&_0xe48f6d[_0x14b24b(0x15d)]==_0x2ca569[_0x14b24b(0x15d)]&&(_0xe48f6d['product_stock']+=Math[_0x14b24b(0x1f6)](_0x2ea204['quantity']),_0xd7c46f++);}),_0xd7c46f===0x0&&_0x298244['product_details']['push']({'product_name':_0x2ea204['product_name'],'product_stock':Math[_0x36c528(0x1f6)](_0x2ea204[_0x36c528(0x20e)]),'primary_code':_0x2ea204[_0x36c528(0x237)],'secondary_code':_0x2ea204['secondary_code'],'product_code':_0x2ea204[_0x36c528(0x161)],'storage':_0x2ea204[_0x36c528(0x185)],'rack':_0x2ea204[_0x36c528(0x23f)],'bay':_0x2ea204[_0x36c528(0x151)],'bin':_0x2ea204[_0x36c528(0x1a1)],'type':_0x2ea204['type'],'floorlevel':_0x2ea204['floorlevel'],'maxProducts':_0x2ea204[_0x36c528(0x175)],'unit':_0x2ea204['standard_unit'],'secondary_unit':_0x2ea204['secondary_unit'],'expiry_date':_0x2ea204['expiry_date'],'maxPerUnit':_0x2ea204[_0x36c528(0x1dc)],'batch_code':_0x2ea204[_0x36c528(0x1fa)],'alertQTY':_0x2ea204[_0x36c528(0x1d0)],'production_date':_0x2ea204[_0x36c528(0x229)],'product_cat':_0x2ea204[_0x36c528(0x135)],'invoice':_0x2ea204['invoice'],'actual_qty':Math[_0x36c528(0x1f6)](_0x2ea204[_0x36c528(0x158)]),'actual_uom':_0x2ea204[_0x36c528(0x23c)]}),_0x298244;});Promise[_0x4a98ec(0x1e2)](_0xc1937d)[_0x4a98ec(0x1ef)](async _0x53acec=>{var _0x22e976=_0x4a98ec;try{for(const _0x9b371 of _0x53acec){await _0x9b371[_0x22e976(0x137)]();}const _0x53705d=await master_shop['find'](),_0x1e7d3d=await email_settings[_0x22e976(0x165)](),_0x371572=await supervisor_settings[_0x22e976(0x126)]();var _0x1f56e2=_0x2ca569['product'],_0x4655ef='',_0x2f706f;for(_0x2f706f in _0x1f56e2){_0x4655ef+='<tr>'+_0x22e976(0x1e7)+_0x1f56e2[_0x2f706f][_0x22e976(0x160)]+_0x22e976(0x17c)+_0x22e976(0x1e7)+_0x1f56e2[_0x2f706f][_0x22e976(0x161)]+_0x22e976(0x17c)+_0x22e976(0x1e7)+_0x1f56e2[_0x2f706f][_0x22e976(0x20e)]+_0x22e976(0x17c)+_0x22e976(0x1e7)+_0x1f56e2[_0x2f706f][_0x22e976(0x12b)]+'</td>'+_0x22e976(0x1e7)+_0x1f56e2[_0x2f706f][_0x22e976(0x21c)]+_0x22e976(0x17c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2ca569[_0x22e976(0x1a8)]+_0x22e976(0x17c)+_0x22e976(0x1e7)+_0x1f56e2[_0x2f706f][_0x22e976(0x228)]+'</td>'+_0x22e976(0x1e7)+_0x1f56e2[_0x2f706f][_0x22e976(0x185)]+_0x1f56e2[_0x2f706f][_0x22e976(0x23f)]+_0x1f56e2[_0x2f706f][_0x22e976(0x151)]+_0x1f56e2[_0x2f706f][_0x22e976(0x1a1)]+_0x1f56e2[_0x2f706f][_0x22e976(0x19a)][0x0]+_0x1f56e2[_0x2f706f][_0x22e976(0x190)]+_0x22e976(0x17c),_0x22e976(0x136);}let _0x74cf3f=nodemailer[_0x22e976(0x167)]({'host':_0x1e7d3d[_0x22e976(0x13e)],'port':Number(_0x1e7d3d[_0x22e976(0x203)]),'secure':![],'auth':{'user':_0x1e7d3d[_0x22e976(0x23e)],'pass':_0x1e7d3d[_0x22e976(0x18a)]}}),_0x2dd266={'from':_0x1e7d3d['email'],'to':_0x371572[0x0]['RMSEmail'],'subject':_0x22e976(0x20a),'attachments':[{'filename':'Logo.png','path':__dirname+_0x22e976(0x1bb)+'/upload/'+_0x53705d[0x0][_0x22e976(0x20d)],'cid':_0x22e976(0x1a0)}],'html':_0x22e976(0x1d1)+_0x22e976(0x226)+_0x22e976(0x184)+_0x22e976(0x13f)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x22e976(0x221)+'</div>'+_0x22e976(0x13f)+_0x22e976(0x22c)+_0x53705d[0x0]['site_title']+_0x22e976(0x1a2)+_0x22e976(0x130)+_0x22e976(0x130)+_0x22e976(0x1ec)+_0x22e976(0x13f)+_0x22e976(0x19f)+_0x22e976(0x1d5)+_0x2ca569['invoice']+'\x20'+_0x22e976(0x1b8)+_0x22e976(0x1bc)+_0x2ca569['date']+'\x20'+_0x22e976(0x197)+_0x22e976(0x1b2)+'</div>'+_0x22e976(0x1ba)+_0x22e976(0x16c)+_0x22e976(0x172)+_0x22e976(0x21a)+_0x22e976(0x1f9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x22e976(0x178)+_0x22e976(0x17f)+_0x22e976(0x129)+_0x22e976(0x188)+_0x22e976(0x1aa)+_0x22e976(0x136)+_0x22e976(0x180)+_0x22e976(0x240)+'\x20'+_0x4655ef+'\x20'+_0x22e976(0x154)+_0x22e976(0x12a)+_0x22e976(0x13f)+_0x22e976(0x15e)+_0x22e976(0x1e3)+_0x53705d[0x0][_0x22e976(0x1e9)]+_0x22e976(0x1b2)+_0x22e976(0x130)+_0x22e976(0x130)+_0x22e976(0x159)};_0x74cf3f['sendMail'](_0x2dd266,function(_0x58ce91,_0xcdbbd9){var _0xbc463a=_0x22e976;_0x58ce91?(console[_0xbc463a(0x169)](_0x58ce91),console['log']('Error\x20Occurs')):console['log'](_0xbc463a(0x173));}),_0x38926f[_0x22e976(0x1a6)](_0x22e976(0x19e),_0x22e976(0x1b4)),_0x2419fc['redirect']('/all_purchases/view/');}catch(_0x33bad2){console[_0x22e976(0x179)](_0x33bad2),_0x2419fc[_0x22e976(0x211)](0x1f4)[_0x22e976(0x1bd)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x4a98ec(0x1b6)](_0x337bca=>{var _0x3e18b3=_0x4a98ec;console[_0x3e18b3(0x179)](_0x337bca),_0x2419fc['status'](0x1f4)[_0x3e18b3(0x1bd)]({'error':_0x3e18b3(0x1c3)});});}catch(_0x10216a){console['log'](_0x10216a);}}),router[a0_0x842d29(0x1c7)]('/preview/:id',auth,async(_0x5678bb,_0x324b12)=>{var _0x1078bb=a0_0x842d29;try{const {username:_0x47fba2,email:_0x55b636,role:_0x1573d3}=_0x5678bb[_0x1078bb(0x16a)],_0x373688=_0x5678bb[_0x1078bb(0x16a)],_0x4cf4e6=await profile[_0x1078bb(0x165)]({'email':_0x373688['email']}),_0x519e4f=await master_shop[_0x1078bb(0x126)](),_0x44b163=_0x5678bb[_0x1078bb(0x143)]['id'],_0x22d87b=await purchases[_0x1078bb(0x19b)](_0x44b163),_0x5e1b1d=await warehouse[_0x1078bb(0x11e)]([{'$match':{'name':_0x22d87b[_0x1078bb(0x1a8)],'room':_0x22d87b[_0x1078bb(0x170)]}},{'$unwind':_0x1078bb(0x120)},{'$group':{'_id':_0x1078bb(0x1d6),'name':{'$first':_0x1078bb(0x145)},'product_stock':{'$first':_0x1078bb(0x21e)},'bay':{'$first':_0x1078bb(0x1cb)},'bin':{'$first':_0x1078bb(0x171)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1078bb(0x13b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1078bb(0x18e)},'product_code':{'$first':_0x1078bb(0x21b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1078bb(0x16f)},'expiry_date':{'$first':_0x1078bb(0x202)}}}]),_0x9b19e5=await customer[_0x1078bb(0x126)]({});let _0x5c4b0e;if(_0x373688['role']==_0x1078bb(0x1a5)){const _0x380994=await staff[_0x1078bb(0x165)]({'email':_0x373688[_0x1078bb(0x23e)]});_0x5c4b0e=await warehouse[_0x1078bb(0x11e)]([{'$match':{'status':_0x1078bb(0x206),'name':_0x380994[_0x1078bb(0x22e)]}},{'$group':{'_id':_0x1078bb(0x125),'name':{'$first':_0x1078bb(0x125)}}}]);}else _0x5c4b0e=await warehouse['aggregate']([{'$match':{'status':_0x1078bb(0x206)}},{'$group':{'_id':'$name','name':{'$first':_0x1078bb(0x125)}}}]);const _0x249b2e=await product[_0x1078bb(0x126)]({}),_0x27521a=await suppliers['find']({}),_0x56dd97=BayBinSelected(_0x22d87b[_0x1078bb(0x1a8)],_0x22d87b[_0x1078bb(0x170)]);if(_0x519e4f[0x0][_0x1078bb(0x14c)]==_0x1078bb(0x192)){var _0x4c13f2=users[_0x1078bb(0x150)];console[_0x1078bb(0x169)](_0x4c13f2);}else{if(_0x519e4f[0x0][_0x1078bb(0x14c)]=='Hindi')var _0x4c13f2=users['Hindi'];else{if(_0x519e4f[0x0]['language']=='German')var _0x4c13f2=users[_0x1078bb(0x1d4)];else{if(_0x519e4f[0x0][_0x1078bb(0x14c)]==_0x1078bb(0x22b))var _0x4c13f2=users[_0x1078bb(0x22b)];else{if(_0x519e4f[0x0]['language']==_0x1078bb(0x1eb))var _0x4c13f2=users[_0x1078bb(0x1eb)];else{if(_0x519e4f[0x0]['language']=='Portuguese\x20(BR)')var _0x4c13f2=users[_0x1078bb(0x156)];else{if(_0x519e4f[0x0][_0x1078bb(0x14c)]==_0x1078bb(0x209))var _0x4c13f2=users['Chinese'];else{if(_0x519e4f[0x0][_0x1078bb(0x14c)]=='Arabic\x20(ae)')var _0x4c13f2=users['Arabic'];}}}}}}}_0x324b12[_0x1078bb(0x123)](_0x1078bb(0x174),{'success':_0x5678bb[_0x1078bb(0x1a6)]('success'),'errors':_0x5678bb['flash'](_0x1078bb(0x236)),'role':_0x373688,'profile':_0x4cf4e6,'customer':_0x9b19e5,'warehouse':_0x5c4b0e,'product':_0x5e1b1d,'user':_0x22d87b,'master_shop':_0x519e4f,'unit':_0x249b2e,'language':_0x4c13f2,'suppliers':_0x27521a,'dataSelected':_0x56dd97});}catch(_0x4233d7){console[_0x1078bb(0x169)](_0x4233d7);}}),router['post'](a0_0x842d29(0x1a9),auth,async(_0x5d20b5,_0x2cca14)=>{var _0x975443=a0_0x842d29;try{const _0x439079=_0x5d20b5['params']['id'],{invoice:_0x30029a,warehouse_name:_0x3ef840,Room_name:_0x148354}=_0x5d20b5[_0x975443(0x1df)],_0x4ac935=await warehouse[_0x975443(0x165)]({'name':_0x3ef840,'room':_0x148354}),_0x16adf0=await purchases[_0x975443(0x165)]({'invoice':_0x30029a});_0x16adf0['product'][_0x975443(0x21f)](_0x4039e8=>{var _0x1777e3=_0x975443,_0x179b48=0x0;const _0x4a35f9=_0x4ac935['product_details'][_0x1777e3(0x1ab)](_0x22256e=>{var _0x4e9b27=_0x1777e3;_0x22256e[_0x4e9b27(0x160)]==_0x4039e8[_0x4e9b27(0x160)]&&_0x22256e[_0x4e9b27(0x190)]==_0x4039e8['floorlevel']&&_0x22256e[_0x4e9b27(0x19a)]==_0x4039e8[_0x4e9b27(0x19a)]&&_0x22256e[_0x4e9b27(0x1a1)]==_0x4039e8['bin']&&_0x22256e[_0x4e9b27(0x151)]==_0x4039e8['bay']&&_0x22256e[_0x4e9b27(0x23f)]==_0x4039e8['rack']&&_0x22256e[_0x4e9b27(0x185)]==_0x4039e8[_0x4e9b27(0x185)]&&_0x22256e[_0x4e9b27(0x11d)]==_0x4039e8['expiry_date']&&_0x22256e[_0x4e9b27(0x1fa)]==_0x4039e8[_0x4e9b27(0x1fa)]&&_0x22256e[_0x4e9b27(0x229)]==_0x4039e8[_0x4e9b27(0x229)]&&_0x22256e['delivery_date']==_0x4039e8[_0x4e9b27(0x22d)]&&_0x22256e[_0x4e9b27(0x1f3)]==_0x4039e8[_0x4e9b27(0x1f3)]&&(_0x22256e[_0x4e9b27(0x1b1)]=parseInt(_0x22256e['product_stock'])+parseInt(_0x4039e8[_0x4e9b27(0x20e)]),_0x179b48++);});_0x179b48=='0'&&(_0x4ac935[_0x1777e3(0x182)]=_0x4ac935[_0x1777e3(0x182)][_0x1777e3(0x15c)]({'product_name':_0x4039e8[_0x1777e3(0x160)],'product_stock':_0x4039e8['quantity'],'primary_code':_0x4039e8['primary_code'],'secondary_code':_0x4039e8['secondary_code'],'product_code':_0x4039e8[_0x1777e3(0x161)],'storage':_0x4039e8[_0x1777e3(0x185)],'rack':_0x4039e8[_0x1777e3(0x23f)],'bay':_0x4039e8[_0x1777e3(0x151)],'bin':_0x4039e8[_0x1777e3(0x1a1)],'type':_0x4039e8[_0x1777e3(0x19a)],'floorlevel':_0x4039e8[_0x1777e3(0x190)],'maxProducts':_0x4039e8[_0x1777e3(0x175)],'unit':_0x4039e8[_0x1777e3(0x12b)],'secondary_unit':_0x4039e8['secondary_unit'],'expiry_date':_0x4039e8[_0x1777e3(0x11d)],'maxPerUnit':_0x4039e8[_0x1777e3(0x1dc)],'batch_code':_0x4039e8['batch_code'],'alertQTY':_0x4039e8[_0x1777e3(0x1d0)],'production_date':_0x4039e8['production_date'],'delivery_date':_0x4039e8[_0x1777e3(0x22d)],'delivery_code':_0x4039e8['delivery_code']}));}),await _0x4ac935[_0x975443(0x137)](),_0x16adf0[_0x975443(0x1d3)]='True';const _0x531f0c=await _0x16adf0[_0x975443(0x137)]();_0x5d20b5[_0x975443(0x1a6)](_0x975443(0x19e),'Sales\x20Update\x20successfully'),_0x2cca14[_0x975443(0x1c1)](_0x975443(0x142));}catch(_0x5ef7c7){console['log'](_0x5ef7c7);}}),router[a0_0x842d29(0x1c7)](a0_0x842d29(0x238),auth,async(_0x37b12e,_0x566422)=>{var _0x19b7e9=a0_0x842d29;try{const {username:_0x327119,email:_0x5eb3b4,role:_0x8e86a6}=_0x37b12e[_0x19b7e9(0x16a)],_0x13975c=_0x37b12e[_0x19b7e9(0x16a)],_0x14c0b8=await profile[_0x19b7e9(0x165)]({'email':_0x13975c['email']}),_0x57b7b7=await master_shop['find'](),_0x554dc3=_0x37b12e[_0x19b7e9(0x143)]['id'],_0x432d1b=await purchases[_0x19b7e9(0x19b)](_0x554dc3),_0x50bb4a=await suppliers[_0x19b7e9(0x126)]({});let _0x255f5c;if(_0x13975c[_0x19b7e9(0x168)]=='staff'){const _0x17b810=await staff[_0x19b7e9(0x165)]({'email':_0x13975c[_0x19b7e9(0x23e)]});_0x255f5c=await warehouse[_0x19b7e9(0x126)]({'status':_0x19b7e9(0x206),'name':_0x17b810['warehouse'],'warehouse_category':_0x19b7e9(0x1ae)});}else _0x255f5c=await warehouse[_0x19b7e9(0x11e)]([{'$match':{'status':'Enabled','warehouse_category':_0x19b7e9(0x1ae)}},{'$group':{'_id':_0x19b7e9(0x125),'name':{'$first':_0x19b7e9(0x125)}}}]);const _0x2dbc95=await product[_0x19b7e9(0x126)]({}),_0x4445e4=BayBinSelected(_0x432d1b[_0x19b7e9(0x1a8)],_0x432d1b[_0x19b7e9(0x170)]);let _0x8ceeeb=new Date(_0x432d1b[_0x19b7e9(0x11d)]),_0x5a94ec=('0'+_0x8ceeeb['getDate']())[_0x19b7e9(0x1ff)](-0x2),_0x3736ae=('0'+(_0x8ceeeb[_0x19b7e9(0x1ce)]()+0x1))[_0x19b7e9(0x1ff)](-0x2),_0x455800=_0x8ceeeb[_0x19b7e9(0x177)](),_0x47ceea=_0x455800+'-'+_0x3736ae+'-'+_0x5a94ec;if(_0x57b7b7[0x0][_0x19b7e9(0x14c)]==_0x19b7e9(0x192)){var _0x11c3ed=users['English'];console[_0x19b7e9(0x169)](_0x11c3ed);}else{if(_0x57b7b7[0x0][_0x19b7e9(0x14c)]==_0x19b7e9(0x1fe))var _0x11c3ed=users[_0x19b7e9(0x1fe)];else{if(_0x57b7b7[0x0][_0x19b7e9(0x14c)]==_0x19b7e9(0x1d4))var _0x11c3ed=users[_0x19b7e9(0x1d4)];else{if(_0x57b7b7[0x0]['language']=='Spanish')var _0x11c3ed=users[_0x19b7e9(0x22b)];else{if(_0x57b7b7[0x0][_0x19b7e9(0x14c)]==_0x19b7e9(0x1eb))var _0x11c3ed=users[_0x19b7e9(0x1eb)];else{if(_0x57b7b7[0x0][_0x19b7e9(0x14c)]==_0x19b7e9(0x148))var _0x11c3ed=users[_0x19b7e9(0x156)];else{if(_0x57b7b7[0x0]['language']=='Chinese')var _0x11c3ed=users[_0x19b7e9(0x209)];else{if(_0x57b7b7[0x0]['language']==_0x19b7e9(0x16b))var _0x11c3ed=users[_0x19b7e9(0x23d)];}}}}}}}_0x566422[_0x19b7e9(0x123)](_0x19b7e9(0x1f7),{'success':_0x37b12e[_0x19b7e9(0x1a6)](_0x19b7e9(0x19e)),'errors':_0x37b12e[_0x19b7e9(0x1a6)](_0x19b7e9(0x236)),'role':_0x13975c,'profile':_0x14c0b8,'purchases':_0x432d1b,'suppliers':_0x50bb4a,'warehouse':_0x255f5c,'product':_0x2dbc95,'master_shop':_0x57b7b7,'language':_0x11c3ed,'ed_fullDate':_0x47ceea,'dataSelected':_0x4445e4});}catch(_0x3a9411){console[_0x19b7e9(0x169)](_0x3a9411);}}),router[a0_0x842d29(0x1fb)](a0_0x842d29(0x238),auth,async(_0x274869,_0x5a2809)=>{var _0x16a2b5=a0_0x842d29;try{const _0x3dfeb0=_0x274869[_0x16a2b5(0x143)]['id'],_0x1c0cc8=await purchases[_0x16a2b5(0x165)]({'_id':_0x274869[_0x16a2b5(0x143)]['id']}),_0x2fdba6=await warehouse[_0x16a2b5(0x165)]({'name':_0x1c0cc8['warehouse_name'],'room':_0x1c0cc8[_0x16a2b5(0x170)]});_0x1c0cc8[_0x16a2b5(0x124)]['forEach'](_0x44d856=>{var _0x44f4d2=_0x16a2b5;const _0x4694fb=_0x2fdba6[_0x44f4d2(0x182)][_0x44f4d2(0x1ab)](_0x1f2041=>{var _0x44d7b3=_0x44f4d2;_0x1f2041['product_name']==_0x44d856[_0x44d7b3(0x160)]&&_0x1f2041[_0x44d7b3(0x190)]==_0x44d856['floorlevel']&&_0x1f2041[_0x44d7b3(0x19a)]==_0x44d856[_0x44d7b3(0x19a)]&&_0x1f2041[_0x44d7b3(0x1a1)]==_0x44d856[_0x44d7b3(0x1a1)]&&_0x1f2041[_0x44d7b3(0x151)]==_0x44d856[_0x44d7b3(0x151)]&&_0x1f2041[_0x44d7b3(0x23f)]==_0x44d856['rack']&&_0x1f2041['storage']==_0x44d856['storage']&&(_0x1f2041['product_stock']=parseInt(_0x1f2041[_0x44d7b3(0x1b1)])-parseInt(_0x44d856[_0x44d7b3(0x20e)]));});}),await _0x2fdba6[_0x16a2b5(0x137)]();const {invoice:_0x1d7a14,suppliers:_0x1f1fa0,date:_0x229870,warehouse_name:_0x14a5f9,prod_name:_0x18c025,prod_code:_0x7df84f,prod_qty:_0x27a4df,prod_unit:_0x106834,prod_secondunit:_0x2be799,prod_level:_0x70cce3,prod_isle:_0x3d07f9,prod_pallet:_0xc2eaf4,note:_0x1c6ed9,expiry_date:_0x4b8fb2,batch_code:_0x357d4c,paid_amount:_0xb77b11,due_amount:_0x351176,Room_name:_0xe10c42,primary_code:_0xb874,secondary_code:_0x4e3926,PO_number:_0x4b44a8,JO_number:_0x451998}=_0x274869[_0x16a2b5(0x1df)];if(typeof _0x18c025=='string')var _0x174552=[_0x274869['body']['prod_name']],_0x8151a2=[_0x274869['body']['prod_code']],_0x4c5b5b=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1e0)]],_0xf7994e=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1b3)]],_0x4a46fc=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x20b)]],_0x3c8aa1=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x215)]],_0x5c26bd=[_0x274869[_0x16a2b5(0x1df)]['prod_isle']],_0x476ae6=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x18c)]],_0x5304b2=[_0x274869['body']['primary_code']],_0x3e8f84=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1a4)]],_0x2fefb3=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x12e)]],_0x13ff28=[_0x274869[_0x16a2b5(0x1df)]['batch_code']],_0x69e4df=[_0x274869['body']['expiry_date']],_0x58a822=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x185)]],_0x2c44a2=[_0x274869[_0x16a2b5(0x1df)]['rak']],_0x25a3c8=[_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x19a)]];else var _0x174552=[..._0x274869['body'][_0x16a2b5(0x133)]],_0x8151a2=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x18b)]],_0x4c5b5b=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1e0)]],_0xf7994e=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1b3)]],_0x4a46fc=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x20b)]],_0x3c8aa1=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x215)]],_0x5c26bd=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1ad)]],_0x476ae6=[..._0x274869['body'][_0x16a2b5(0x18c)]],_0x5304b2=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x237)]],_0x3e8f84=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1a4)]],_0x2fefb3=[..._0x274869[_0x16a2b5(0x1df)]['MaxStocks_data']],_0x13ff28=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1fa)]],_0x69e4df=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x11d)]],_0x58a822=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x185)]],_0x2c44a2=[..._0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x208)]],_0x25a3c8=[..._0x274869[_0x16a2b5(0x1df)]['type']];const _0x318fe4=_0x174552[_0x16a2b5(0x1ab)](_0x30737c=>{return _0x30737c={'product_name':_0x30737c};});_0x8151a2[_0x16a2b5(0x21f)]((_0x269dba,_0x3e4984)=>{_0x318fe4[_0x3e4984]['product_code']=_0x269dba;}),_0x4c5b5b[_0x16a2b5(0x21f)]((_0x2a762d,_0x3f0b5e)=>{var _0xc5985b=_0x16a2b5;_0x318fe4[_0x3f0b5e][_0xc5985b(0x20e)]=_0x2a762d;}),_0xf7994e['forEach']((_0xd0fc6c,_0x483e16)=>{var _0x548a3d=_0x16a2b5;_0x318fe4[_0x483e16][_0x548a3d(0x12b)]=_0xd0fc6c;}),_0x4a46fc['forEach']((_0x58b22a,_0x2aae79)=>{var _0x33e2ce=_0x16a2b5;_0x318fe4[_0x2aae79][_0x33e2ce(0x21c)]=_0x58b22a;}),_0x3c8aa1[_0x16a2b5(0x21f)]((_0x26ec3b,_0x262cfb)=>{_0x318fe4[_0x262cfb]['bay']=_0x26ec3b;}),_0x5c26bd[_0x16a2b5(0x21f)]((_0x1d970b,_0x5cc0c8)=>{var _0x38b730=_0x16a2b5;_0x318fe4[_0x5cc0c8][_0x38b730(0x1a1)]=_0x1d970b;}),_0x476ae6[_0x16a2b5(0x21f)]((_0x204a8e,_0x2406f2)=>{var _0x3c2631=_0x16a2b5;_0x318fe4[_0x2406f2][_0x3c2631(0x190)]=_0x204a8e;}),_0x5304b2[_0x16a2b5(0x21f)]((_0x267ef7,_0x5aedf0)=>{var _0x3e2762=_0x16a2b5;_0x318fe4[_0x5aedf0][_0x3e2762(0x237)]=_0x267ef7;}),_0x3e8f84[_0x16a2b5(0x21f)]((_0x313a80,_0x4072c3)=>{var _0x4245a6=_0x16a2b5;_0x318fe4[_0x4072c3][_0x4245a6(0x1a4)]=_0x313a80;}),_0x2fefb3[_0x16a2b5(0x21f)]((_0x1c6aef,_0x3b28f7)=>{var _0x10eb80=_0x16a2b5;_0x318fe4[_0x3b28f7][_0x10eb80(0x175)]=_0x1c6aef;}),_0x13ff28['forEach']((_0x28f04f,_0x14789d)=>{var _0x12acc0=_0x16a2b5;_0x318fe4[_0x14789d][_0x12acc0(0x1fa)]=_0x28f04f;}),_0x69e4df[_0x16a2b5(0x21f)]((_0x2023b1,_0xe004c)=>{var _0x3ad23f=_0x16a2b5;_0x318fe4[_0xe004c][_0x3ad23f(0x11d)]=_0x2023b1;}),_0x25a3c8[_0x16a2b5(0x21f)]((_0x46c1eb,_0x162df0)=>{var _0x26287b=_0x16a2b5;_0x318fe4[_0x162df0][_0x26287b(0x19a)]=_0x46c1eb;}),_0x58a822['forEach']((_0x4b3180,_0x5c4655)=>{var _0x4a71fa=_0x16a2b5;_0x318fe4[_0x5c4655][_0x4a71fa(0x185)]=_0x4b3180;}),_0x2c44a2[_0x16a2b5(0x21f)]((_0x1f3d7f,_0x4aef83)=>{var _0x1cf44e=_0x16a2b5;_0x318fe4[_0x4aef83][_0x1cf44e(0x23f)]=_0x1f3d7f;});const _0x589de2=_0x318fe4[_0x16a2b5(0x191)](_0x18eecc=>_0x18eecc[_0x16a2b5(0x20e)]!=='0'&&_0x18eecc[_0x16a2b5(0x20e)]!=='');_0x1c0cc8['invoice']=_0x1d7a14,_0x1c0cc8[_0x16a2b5(0x224)]=_0x1f1fa0,_0x1c0cc8[_0x16a2b5(0x199)]=_0x229870,_0x1c0cc8[_0x16a2b5(0x1a8)]=_0x14a5f9,_0x1c0cc8[_0x16a2b5(0x124)]=_0x589de2,_0x1c0cc8[_0x16a2b5(0x162)]=_0x1c6ed9,_0x1c0cc8[_0x16a2b5(0x14f)]=_0xb77b11,_0x1c0cc8[_0x16a2b5(0x13d)]=_0x351176,_0x1c0cc8[_0x16a2b5(0x170)]=_0xe10c42,_0x1c0cc8[_0x16a2b5(0x14e)]=_0x4b44a8,_0x1c0cc8[_0x16a2b5(0x218)]=_0x451998;const _0x1822c4=await _0x1c0cc8['save'](),_0x5dff68=await warehouse[_0x16a2b5(0x165)]({'name':_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1a8)],'room':_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x1a7)]});_0x1c0cc8[_0x16a2b5(0x124)][_0x16a2b5(0x21f)](_0x439b86=>{var _0x3f5597=_0x16a2b5,_0x5493db=0x0;const _0xd5522f=_0x5dff68[_0x3f5597(0x182)][_0x3f5597(0x1ab)](_0x59071b=>{var _0x2f9760=_0x3f5597;_0x59071b[_0x2f9760(0x160)]==_0x439b86[_0x2f9760(0x160)]&&_0x59071b[_0x2f9760(0x190)]==_0x439b86['floorlevel']&&_0x59071b[_0x2f9760(0x19a)]==_0x439b86['type']&&_0x59071b[_0x2f9760(0x1a1)]==_0x439b86[_0x2f9760(0x1a1)]&&_0x59071b[_0x2f9760(0x151)]==_0x439b86[_0x2f9760(0x151)]&&_0x59071b[_0x2f9760(0x23f)]==_0x439b86['rack']&&_0x59071b[_0x2f9760(0x185)]==_0x439b86[_0x2f9760(0x185)]&&(_0x59071b['product_stock']=parseInt(_0x59071b[_0x2f9760(0x1b1)])+parseInt(_0x439b86[_0x2f9760(0x20e)]),_0x5493db++);});_0x5493db=='0'&&(_0x5dff68['product_details']=_0x5dff68[_0x3f5597(0x182)][_0x3f5597(0x15c)]({'product_name':_0x439b86[_0x3f5597(0x160)],'product_stock':_0x439b86[_0x3f5597(0x20e)],'primary_code':_0x439b86['primary_code'],'secondary_code':_0x439b86[_0x3f5597(0x1a4)],'product_code':_0x439b86[_0x3f5597(0x161)],'storage':_0x439b86[_0x3f5597(0x185)],'rack':_0x439b86[_0x3f5597(0x23f)],'bay':_0x439b86[_0x3f5597(0x151)],'bin':_0x439b86['bin'],'type':_0x439b86[_0x3f5597(0x19a)],'floorlevel':_0x439b86[_0x3f5597(0x190)],'maxProducts':_0x439b86[_0x3f5597(0x175)],'unit':_0x439b86[_0x3f5597(0x12b)],'secondary_unit':_0x439b86[_0x3f5597(0x21c)],'expiry_date':_0x439b86[_0x3f5597(0x11d)]}));}),await _0x5dff68[_0x16a2b5(0x137)]();const _0x3c8452=await s_payment_data[_0x16a2b5(0x165)]({'invoice':_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x15d)]});if(_0x3c8452===null){}else console[_0x16a2b5(0x169)]('suppliers',_0x3c8452,_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x15d)]),_0x3c8452[_0x16a2b5(0x224)]=_0x274869[_0x16a2b5(0x1df)][_0x16a2b5(0x224)],await _0x3c8452[_0x16a2b5(0x137)]();_0x274869[_0x16a2b5(0x1a6)](_0x16a2b5(0x19e),_0x16a2b5(0x183)),_0x5a2809[_0x16a2b5(0x1c1)]('/all_purchases/view');}catch(_0x5bfc8b){console[_0x16a2b5(0x169)](_0x5bfc8b);}}),router['post'](a0_0x842d29(0x239),auth,async(_0x4fd0a0,_0x4b9140)=>{var _0x116fed=a0_0x842d29;try{const _0x19ebcd=_0x4fd0a0[_0x116fed(0x143)]['id'],{invoice:_0x581992,suppliers:_0x10ccf0,payable:_0x17c3dd,due_amount:_0x6e3ec1}=_0x4fd0a0[_0x116fed(0x1df)],_0x389bd5=await purchases[_0x116fed(0x19b)](_0x19ebcd);var _0x285a99=_0x17c3dd-_0x6e3ec1;_0x389bd5[_0x116fed(0x14f)]=parseFloat(_0x389bd5['paid_amount'])+parseFloat(_0x6e3ec1),_0x389bd5['due_amount']=_0x285a99;const _0x4265ab=await _0x389bd5[_0x116fed(0x137)]();console[_0x116fed(0x169)](_0x4265ab);const _0x124ecc=await s_payment_data[_0x116fed(0x165)]({'invoice':_0x581992});_0x124ecc['amount']=_0x285a99,await _0x124ecc[_0x116fed(0x137)]();let _0x2313e4=new Date(),_0x1da0f1=('0'+_0x2313e4[_0x116fed(0x18f)]())[_0x116fed(0x1ff)](-0x2),_0xd072e=('0'+(_0x2313e4['getMonth']()+0x1))[_0x116fed(0x1ff)](-0x2),_0x267c09=_0x2313e4[_0x116fed(0x177)](),_0x11e898=_0x267c09+'-'+_0xd072e+'-'+_0x1da0f1;const _0x447901=new suppliers_payment({'invoice':_0x581992,'date':_0x267c09+'-'+_0xd072e+'-'+_0x1da0f1,'suppliers':_0x10ccf0,'reason':_0x116fed(0x235),'amount':_0x6e3ec1}),_0x1b77a4=await _0x447901[_0x116fed(0x137)]();_0x4fd0a0[_0x116fed(0x1a6)](_0x116fed(0x19e),'payment\x20successfull'),_0x4b9140['redirect']('/all_purchases/view');}catch(_0x2e37de){console['log'](_0x2e37de);}}),router[a0_0x842d29(0x1c7)](a0_0x842d29(0x15b),auth,async(_0x1c0dd1,_0x1f213e)=>{var _0x5ed943=a0_0x842d29;try{const {username:_0xade6b4,email:_0x3ae219,role:_0x20fd9a}=_0x1c0dd1[_0x5ed943(0x16a)],_0x49cc33=_0x1c0dd1[_0x5ed943(0x16a)],_0x14d8ea=await profile['findOne']({'email':_0x49cc33[_0x5ed943(0x23e)]}),_0xcfca00=await master_shop[_0x5ed943(0x126)]();console[_0x5ed943(0x169)](_0x5ed943(0x230),_0xcfca00);const _0x39f559=_0x1c0dd1[_0x5ed943(0x143)]['id'],_0x36f18b=await purchases[_0x5ed943(0x19b)](_0x39f559);console[_0x5ed943(0x169)](_0x36f18b);const _0x25f38c=await suppliers['findOne']({'name':_0x36f18b[_0x5ed943(0x224)]});console[_0x5ed943(0x169)](_0x25f38c);if(_0xcfca00[0x0][_0x5ed943(0x14c)]==_0x5ed943(0x192)){var _0x46700e=users[_0x5ed943(0x150)];console[_0x5ed943(0x169)](_0x46700e);}else{if(_0xcfca00[0x0][_0x5ed943(0x14c)]==_0x5ed943(0x1fe))var _0x46700e=users[_0x5ed943(0x1fe)];else{if(_0xcfca00[0x0][_0x5ed943(0x14c)]==_0x5ed943(0x1d4))var _0x46700e=users[_0x5ed943(0x1d4)];else{if(_0xcfca00[0x0][_0x5ed943(0x14c)]==_0x5ed943(0x22b))var _0x46700e=users[_0x5ed943(0x22b)];else{if(_0xcfca00[0x0][_0x5ed943(0x14c)]==_0x5ed943(0x1eb))var _0x46700e=users[_0x5ed943(0x1eb)];else{if(_0xcfca00[0x0][_0x5ed943(0x14c)]==_0x5ed943(0x148))var _0x46700e=users['Portuguese'];else{if(_0xcfca00[0x0][_0x5ed943(0x14c)]==_0x5ed943(0x209))var _0x46700e=users['Chinese'];else{if(_0xcfca00[0x0]['language']=='Arabic\x20(ae)')var _0x46700e=users[_0x5ed943(0x23d)];}}}}}}}_0x1f213e[_0x5ed943(0x123)](_0x5ed943(0x223),{'success':_0x1c0dd1[_0x5ed943(0x1a6)](_0x5ed943(0x19e)),'errors':_0x1c0dd1[_0x5ed943(0x1a6)](_0x5ed943(0x236)),'role':_0x49cc33,'profile':_0x14d8ea,'master_shop':_0xcfca00,'supplier':_0x25f38c,'purchase':_0x36f18b,'language':_0x46700e});}catch(_0x519521){console[_0x5ed943(0x169)](_0x519521);}}),router[a0_0x842d29(0x1c7)](a0_0x842d29(0x212),auth,async(_0x367bd2,_0x2f08d8)=>{var _0x30ea4f=a0_0x842d29;try{const {username:_0x5a3dfc,email:_0x55b5dd,role:_0x173035}=_0x367bd2[_0x30ea4f(0x16a)],_0x5e0991=_0x367bd2[_0x30ea4f(0x16a)],_0x223312=await profile[_0x30ea4f(0x165)]({'email':_0x5e0991[_0x30ea4f(0x23e)]}),_0x318fd6=await master_shop[_0x30ea4f(0x126)]();console[_0x30ea4f(0x169)](_0x30ea4f(0x230),_0x318fd6);const _0x14fe30=_0x367bd2[_0x30ea4f(0x143)]['id'];console[_0x30ea4f(0x169)](_0x14fe30);const _0x15f0c2=await purchases[_0x30ea4f(0x19b)](_0x14fe30);console[_0x30ea4f(0x169)](_0x30ea4f(0x12f),_0x15f0c2);const _0x530cfa=await product[_0x30ea4f(0x126)]({}),_0x3dd2d1=await warehouse[_0x30ea4f(0x11e)]([{'$match':{'name':_0x15f0c2[_0x30ea4f(0x1a8)],'room':_0x15f0c2['room'],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x30ea4f(0x21e)},'bay':{'$first':_0x30ea4f(0x1cb)},'bin':{'$first':_0x30ea4f(0x171)},'type':{'$first':_0x30ea4f(0x122)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x30ea4f(0x18e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x30ea4f(0x1ea)},'rack':{'$first':_0x30ea4f(0x16f)}}}]);warehouse_data=await warehouse[_0x30ea4f(0x11e)]([{'$match':{'status':_0x30ea4f(0x206),'name':_0x30ea4f(0x200),'warehouse_category':_0x30ea4f(0x1ae)}},{'$group':{'_id':_0x30ea4f(0x125),'name':{'$first':_0x30ea4f(0x125)}}},{'$sort':{'name':0x1}}]),console[_0x30ea4f(0x169)](_0x30ea4f(0x219),_0x3dd2d1);if(_0x318fd6[0x0]['language']=='English\x20(US)'){var _0x569254=users['English'];console['log'](_0x569254);}else{if(_0x318fd6[0x0][_0x30ea4f(0x14c)]=='Hindi')var _0x569254=users[_0x30ea4f(0x1fe)];else{if(_0x318fd6[0x0][_0x30ea4f(0x14c)]==_0x30ea4f(0x1d4))var _0x569254=users[_0x30ea4f(0x1d4)];else{if(_0x318fd6[0x0][_0x30ea4f(0x14c)]==_0x30ea4f(0x22b))var _0x569254=users[_0x30ea4f(0x22b)];else{if(_0x318fd6[0x0][_0x30ea4f(0x14c)]=='French')var _0x569254=users[_0x30ea4f(0x1eb)];else{if(_0x318fd6[0x0][_0x30ea4f(0x14c)]=='Portuguese\x20(BR)')var _0x569254=users[_0x30ea4f(0x156)];else{if(_0x318fd6[0x0][_0x30ea4f(0x14c)]=='Chinese')var _0x569254=users['Chinese'];else{if(_0x318fd6[0x0][_0x30ea4f(0x14c)]=='Arabic\x20(ae)')var _0x569254=users[_0x30ea4f(0x23d)];}}}}}}}_0x2f08d8['render'](_0x30ea4f(0x22f),{'success':_0x367bd2[_0x30ea4f(0x1a6)](_0x30ea4f(0x19e)),'errors':_0x367bd2[_0x30ea4f(0x1a6)](_0x30ea4f(0x236)),'role':_0x5e0991,'profile':_0x223312,'user':_0x15f0c2,'stock':_0x3dd2d1,'master_shop':_0x318fd6,'product':_0x530cfa,'language':_0x569254,'warehouse':warehouse_data});}catch(_0x4a66b5){console['log'](_0x4a66b5);}}),router[a0_0x842d29(0x1fb)](a0_0x842d29(0x212),auth,async(_0x34a045,_0x632ca9)=>{var _0xe3798b=a0_0x842d29;try{const {invoice:_0x282a2f,date:_0x12f5a2,warehouse_name:_0x5dace8,Room_name:_0x4ee51c,product_name:_0x187d69,purchase_quantity:_0x102bb0,stocks:_0x35d784,return_qty:_0x17fe1f,note:_0x1cf12c,level:_0x5ee2f5,isle:_0x279312,pallet:_0x4fefda,to_warehouse_name:_0x538d5b,to_Room_name:_0xd119fc}=_0x34a045[_0xe3798b(0x1df)],_0x2baf46=await purchases['findOne']({'_id':_0x34a045[_0xe3798b(0x143)]['id']}),_0x1c587e=await warehouse[_0xe3798b(0x165)]({'name':_0x5dace8,'room':_0x4ee51c});if(typeof _0x187d69==_0xe3798b(0x11f))var _0x57ffc3=[_0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x160)]],_0xd0a864=[_0x34a045['body'][_0xe3798b(0x1d8)]],_0x1acc13=[_0x34a045['body'][_0xe3798b(0x1cc)]],_0x47fa35=[_0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x241)]],_0x2a81cb=[_0x34a045[_0xe3798b(0x1df)]['level']],_0xf367cb=[_0x34a045['body']['isle']],_0xf04cf3=[_0x34a045[_0xe3798b(0x1df)]['pallet']],_0x355e82=[_0x34a045[_0xe3798b(0x1df)]['types']],_0x158285=[_0x34a045[_0xe3798b(0x1df)]['product_code_hide']],_0x1a3e9d=[_0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x21d)]],_0x5d23f0=[_0x34a045['body'][_0xe3798b(0x1fd)]];else var _0x57ffc3=[..._0x34a045['body'][_0xe3798b(0x160)]],_0xd0a864=[..._0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x1d8)]],_0x1acc13=[..._0x34a045[_0xe3798b(0x1df)]['stocks']],_0x47fa35=[..._0x34a045[_0xe3798b(0x1df)]['return_qty']],_0x2a81cb=[..._0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x12d)]],_0xf367cb=[..._0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x1a3)]],_0xf04cf3=[..._0x34a045['body'][_0xe3798b(0x1f0)]],_0x355e82=[..._0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x198)]],_0x158285=[..._0x34a045[_0xe3798b(0x1df)]['product_code_hide']],_0x1a3e9d=[..._0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x21d)]],_0x5d23f0=[..._0x34a045[_0xe3798b(0x1df)][_0xe3798b(0x1fd)]];const _0x1d39eb=_0x57ffc3[_0xe3798b(0x1ab)](_0x42ebb5=>{return _0x42ebb5={'product_name':_0x42ebb5};});_0xd0a864[_0xe3798b(0x21f)]((_0x454d9b,_0x11ff21)=>{_0x1d39eb[_0x11ff21]['purchase_quantity']=_0x454d9b;}),_0x1acc13['forEach']((_0x10b7cd,_0x3fd32f)=>{var _0x48cc6b=_0xe3798b;_0x1d39eb[_0x3fd32f][_0x48cc6b(0x210)]=_0x10b7cd;}),_0x47fa35[_0xe3798b(0x21f)]((_0x29c37f,_0x486cc4)=>{_0x1d39eb[_0x486cc4]['return_qty']=_0x29c37f;}),_0x2a81cb[_0xe3798b(0x21f)]((_0x576de9,_0x46a124)=>{var _0x106e5d=_0xe3798b;_0x1d39eb[_0x46a124][_0x106e5d(0x151)]=_0x576de9;}),_0xf367cb['forEach']((_0x131b63,_0x63f0dc)=>{_0x1d39eb[_0x63f0dc]['bin']=_0x131b63;}),_0xf04cf3['forEach']((_0x50cd7c,_0x49bf54)=>{var _0x1845d6=_0xe3798b;_0x1d39eb[_0x49bf54][_0x1845d6(0x190)]=_0x50cd7c;}),_0x355e82[_0xe3798b(0x21f)]((_0x6a8609,_0x2b8018)=>{_0x1d39eb[_0x2b8018]['type']=_0x6a8609;}),_0x158285[_0xe3798b(0x21f)]((_0xb8acbb,_0x4df5a8)=>{var _0x563fe7=_0xe3798b;_0x1d39eb[_0x4df5a8][_0x563fe7(0x161)]=_0xb8acbb;}),_0x1a3e9d[_0xe3798b(0x21f)]((_0x3e24e2,_0x531ed1)=>{var _0x29b959=_0xe3798b;_0x1d39eb[_0x531ed1][_0x29b959(0x237)]=_0x3e24e2;}),_0x5d23f0[_0xe3798b(0x21f)]((_0x5733e3,_0x2f0797)=>{_0x1d39eb[_0x2f0797]['secondary_code']=_0x5733e3;}),_0x2baf46['product'][_0xe3798b(0x21f)](_0x2731ba=>{var _0x447329=_0xe3798b;const _0x3e7c0b=_0x1c587e[_0x447329(0x182)][_0x447329(0x1ab)](_0x503c0b=>{var _0x365743=_0x447329;_0x503c0b[_0x365743(0x160)]==_0x2731ba[_0x365743(0x160)]&&_0x503c0b[_0x365743(0x190)]==_0x2731ba[_0x365743(0x190)]&&_0x503c0b[_0x365743(0x19a)]==_0x2731ba[_0x365743(0x19a)]&&_0x503c0b[_0x365743(0x1a1)]==_0x2731ba[_0x365743(0x1a1)]&&_0x503c0b[_0x365743(0x151)]==_0x2731ba[_0x365743(0x151)]&&_0x503c0b[_0x365743(0x23f)]==_0x2731ba[_0x365743(0x23f)]&&_0x503c0b[_0x365743(0x185)]==_0x2731ba[_0x365743(0x185)]&&(console['log'](parseInt(_0x503c0b[_0x365743(0x1b1)])+_0x365743(0x164)+parseInt(_0x2731ba[_0x365743(0x20e)])),_0x503c0b[_0x365743(0x1b1)]=parseInt(_0x503c0b['product_stock'])+parseInt(_0x2731ba[_0x365743(0x20e)]));});}),await _0x1c587e[_0xe3798b(0x137)]();const _0x2fcfbd=_0x1d39eb['filter'](_0x2d6a5c=>_0x2d6a5c[_0xe3798b(0x241)]!=='0'&&_0x2d6a5c[_0xe3798b(0x241)]!=='');var _0x1cd3e1=0x0;_0x2fcfbd[_0xe3798b(0x21f)](_0x55bff8=>{var _0x1196e0=_0xe3798b;console[_0x1196e0(0x169)](_0x1196e0(0x176),_0x55bff8),(parseInt(_0x55bff8[_0x1196e0(0x1d8)])<parseInt(_0x55bff8['return_qty'])||parseInt(_0x55bff8[_0x1196e0(0x210)])<parseInt(_0x55bff8['return_qty']))&&_0x1cd3e1++;});if(_0x1cd3e1!=0x0)return _0x34a045[_0xe3798b(0x1a6)]('errors','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty'),_0x632ca9[_0xe3798b(0x1c1)]('back');const _0x59209b=new purchases_return({'invoice':_0x282a2f,'suppliers':_0x34a045['body'][_0xe3798b(0x224)],'date':_0x12f5a2,'warehouse_name':_0x5dace8,'return_product':_0x2fcfbd,'note':_0x1cf12c,'room':_0x4ee51c,'to_warehouse_name':_0x538d5b,'to_room':_0xd119fc}),_0x422a6e=await _0x59209b[_0xe3798b(0x137)]();console['log'](_0x59209b);const _0xf20ddb=await purchases_return[_0xe3798b(0x165)]({'invoice':_0x282a2f}),_0x2c6286=await warehouse[_0xe3798b(0x165)]({'name':_0x538d5b,'room':_0xd119fc});_0xf20ddb[_0xe3798b(0x141)][_0xe3798b(0x21f)](_0x89db0c=>{var _0x27229b=_0xe3798b,_0x5a5647=0x0;const _0x34db94=_0x2c6286[_0x27229b(0x182)]['map'](_0x5cf8a6=>{var _0x5a2ce1=_0x27229b;_0x5cf8a6[_0x5a2ce1(0x160)]==_0x89db0c[_0x5a2ce1(0x160)]&&_0x5cf8a6[_0x5a2ce1(0x190)]==_0x89db0c[_0x5a2ce1(0x190)]&&_0x5cf8a6['type']==_0x89db0c['type']&&_0x5cf8a6['bin']==_0x89db0c[_0x5a2ce1(0x1a1)]&&_0x5cf8a6[_0x5a2ce1(0x151)]==_0x89db0c[_0x5a2ce1(0x151)]&&(_0x5cf8a6[_0x5a2ce1(0x1b1)]=parseInt(_0x5cf8a6[_0x5a2ce1(0x1b1)])-parseInt(_0x89db0c['return_qty']),_0x5a5647++);});_0x5a5647=='0'&&(_0x2c6286[_0x27229b(0x182)]=_0x2c6286[_0x27229b(0x182)][_0x27229b(0x15c)]({'product_name':_0x89db0c[_0x27229b(0x160)],'product_stock':_0x89db0c[_0x27229b(0x241)],'primary_code':_0x89db0c['primary_code'],'secondary_code':_0x89db0c[_0x27229b(0x1a4)],'product_code':_0x89db0c['product_code'],'storage':_0x89db0c[_0x27229b(0x185)],'rack':_0x89db0c[_0x27229b(0x23f)],'bay':_0x89db0c[_0x27229b(0x151)],'bin':_0x89db0c[_0x27229b(0x1a1)],'type':_0x89db0c[_0x27229b(0x19a)],'floorlevel':_0x89db0c[_0x27229b(0x190)],'maxProducts':_0x89db0c[_0x27229b(0x175)],'unit':_0x89db0c['standard_unit'],'secondary_unit':_0x89db0c[_0x27229b(0x21c)],'expiry_date':_0x89db0c[_0x27229b(0x11d)]}));}),await _0x2c6286[_0xe3798b(0x137)]();const _0x174c8b=await purchases[_0xe3798b(0x165)]({'invoice':_0x282a2f});_0x174c8b[_0xe3798b(0x17e)]=_0xe3798b(0x153);const _0x21fe61=await _0x174c8b[_0xe3798b(0x137)](),_0x270553=new s_payment_data({'invoice':_0x282a2f,'suppliers':_0x34a045['body']['suppliers'],'reason':_0xe3798b(0x14a)});await _0x270553[_0xe3798b(0x137)]();const _0x21ff50=await master_shop[_0xe3798b(0x126)]();console[_0xe3798b(0x169)](_0xe3798b(0x1c4),_0x21ff50[0x0][_0xe3798b(0x20d)]);const _0x2fbbcc=await email_settings[_0xe3798b(0x165)](),_0x350462=await suppliers[_0xe3798b(0x165)]({'name':_0x34a045['body'][_0xe3798b(0x224)]});console[_0xe3798b(0x169)](_0xe3798b(0x227),_0x350462);_0x21ff50[0x0][_0xe3798b(0x1e6)]==0x1?(right_currency=_0x21ff50[0x0][_0xe3798b(0x234)],left_currency=''):(right_currency='',left_currency=_0x21ff50[0x0][_0xe3798b(0x234)]);var _0x5c90df=_0x57ffc3,_0x5418da=_0x47fa35,_0x50e0c3='',_0x29cd74;for(_0x29cd74 in _0x5c90df){_0x50e0c3+=_0xe3798b(0x172)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5c90df[_0x29cd74]+_0xe3798b(0x17c)+_0xe3798b(0x1e7)+_0x5418da[_0x29cd74]+_0xe3798b(0x17c)+_0xe3798b(0x136);}console[_0xe3798b(0x169)](_0xe3798b(0x1f2),_0x50e0c3);let _0x4cdf8a=nodemailer[_0xe3798b(0x167)]({'service':_0xe3798b(0x217),'auth':{'user':_0x2fbbcc[_0xe3798b(0x23e)],'pass':_0x2fbbcc[_0xe3798b(0x18a)]}}),_0x144f1f={'from':_0x2fbbcc[_0xe3798b(0x23e)],'to':_0x350462['email'],'subject':_0xe3798b(0x166),'attachments':[{'filename':_0xe3798b(0x1cd),'path':__dirname+_0xe3798b(0x1bb)+_0xe3798b(0x1b5)+_0x21ff50[0x0][_0xe3798b(0x20d)],'cid':_0xe3798b(0x1a0)}],'html':_0xe3798b(0x1d1)+'<html><head><title></title>'+_0xe3798b(0x184)+_0xe3798b(0x13f)+_0xe3798b(0x1f8)+_0xe3798b(0x13f)+_0xe3798b(0x221)+_0xe3798b(0x130)+_0xe3798b(0x13f)+_0xe3798b(0x22c)+_0x21ff50[0x0][_0xe3798b(0x1e9)]+_0xe3798b(0x1a2)+'</div>'+_0xe3798b(0x130)+_0xe3798b(0x1ec)+'<div>'+_0xe3798b(0x19f)+_0xe3798b(0x1d5)+_0x282a2f+'\x20'+_0xe3798b(0x1b8)+_0xe3798b(0x1bc)+_0x12f5a2+'\x20'+_0xe3798b(0x197)+'</h5>'+'</div>'+_0xe3798b(0x1ba)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xe3798b(0x172)+_0xe3798b(0x21a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0xe3798b(0x1ac)+_0xe3798b(0x193)+_0xe3798b(0x136)+_0xe3798b(0x180)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x50e0c3+'\x20'+_0xe3798b(0x154)+'</table>'+'<div>'+_0xe3798b(0x15e)+'<h5>'+_0x21ff50[0x0][_0xe3798b(0x1e9)]+_0xe3798b(0x1b2)+_0xe3798b(0x130)+'</div>'+_0xe3798b(0x159)};_0x4cdf8a[_0xe3798b(0x1db)](_0x144f1f,function(_0x5a4ae2,_0x27968d){var _0x133376=_0xe3798b;_0x5a4ae2?(console[_0x133376(0x169)](_0x5a4ae2),console[_0x133376(0x169)]('Error\x20Occurs')):console['log'](_0x133376(0x173));}),_0x34a045[_0xe3798b(0x1a6)](_0xe3798b(0x19e),_0xe3798b(0x222)),_0x632ca9[_0xe3798b(0x1c1)](_0xe3798b(0x142));}catch(_0x3513d0){console[_0xe3798b(0x169)](_0x3513d0),_0x632ca9[_0xe3798b(0x211)](0xc8)[_0xe3798b(0x1bd)]({'message':_0x3513d0[_0xe3798b(0x196)]});}}),router['get'](a0_0x842d29(0x12c),auth,async(_0x3a73e7,_0x186f01)=>{var _0x12b921=a0_0x842d29;try{const {username:_0x31b876,email:_0xf923b9,role:_0x214d56}=_0x3a73e7[_0x12b921(0x16a)],_0xd1ab70=_0x3a73e7[_0x12b921(0x16a)],_0x43f9f1=await profile[_0x12b921(0x165)]({'email':_0xd1ab70[_0x12b921(0x23e)]}),_0x2188b3=await master_shop['find'](),_0x10779a=_0x3a73e7['params']['id'],_0x3a9f41=await purchases[_0x12b921(0x19b)](_0x10779a);if(_0x2188b3[0x0]['language']==_0x12b921(0x192))var _0x154293=users[_0x12b921(0x150)];else{if(_0x2188b3[0x0][_0x12b921(0x14c)]==_0x12b921(0x1fe))var _0x154293=users[_0x12b921(0x1fe)];else{if(_0x2188b3[0x0][_0x12b921(0x14c)]==_0x12b921(0x1d4))var _0x154293=users[_0x12b921(0x1d4)];else{if(_0x2188b3[0x0][_0x12b921(0x14c)]==_0x12b921(0x22b))var _0x154293=users[_0x12b921(0x22b)];else{if(_0x2188b3[0x0][_0x12b921(0x14c)]==_0x12b921(0x1eb))var _0x154293=users[_0x12b921(0x1eb)];else{if(_0x2188b3[0x0][_0x12b921(0x14c)]==_0x12b921(0x148))var _0x154293=users[_0x12b921(0x156)];else{if(_0x2188b3[0x0][_0x12b921(0x14c)]==_0x12b921(0x209))var _0x154293=users[_0x12b921(0x209)];else{if(_0x2188b3[0x0][_0x12b921(0x14c)]==_0x12b921(0x16b))var _0x154293=users['Arabic'];}}}}}}}_0x186f01[_0x12b921(0x123)](_0x12b921(0x1e8),{'success':_0x3a73e7['flash']('success'),'errors':_0x3a73e7['flash']('errors'),'role':_0xd1ab70,'profile':_0x43f9f1,'alldata':_0x3a9f41,'master_shop':_0x2188b3,'language':_0x154293}),console[_0x12b921(0x169)](alldata);}catch(_0x1929da){console[_0x12b921(0x169)](_0x1929da);}}),router[a0_0x842d29(0x1fb)](a0_0x842d29(0x1c6),async(_0x20d6e2,_0x171841)=>{var _0x3a1c2a=a0_0x842d29;const {product_code:_0x54c58d}=_0x20d6e2['body'];var _0x314874;const _0x4ade9e=await product[_0x3a1c2a(0x11e)]([{'$match':{'primary_code':_0x54c58d,'product_category':_0x3a1c2a(0x1ae)}},{'$group':{'_id':_0x3a1c2a(0x186),'name':{'$first':_0x3a1c2a(0x125)},'category':{'$first':_0x3a1c2a(0x18d)},'brand':{'$first':_0x3a1c2a(0x128)},'unit':{'$first':_0x3a1c2a(0x1e4)},'alertquantity':{'$first':_0x3a1c2a(0x14d)},'product_code':{'$first':_0x3a1c2a(0x1b7)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x3a1c2a(0x17b)},'maxStocks':{'$first':_0x3a1c2a(0x140)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x3a1c2a(0x20f)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x582abd=await product[_0x3a1c2a(0x11e)]([{'$match':{'secondary_code':_0x54c58d,'product_category':'Raw\x20Materials'}},{'$group':{'_id':'$_id','name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':_0x3a1c2a(0x1e4)},'alertquantity':{'$first':_0x3a1c2a(0x14d)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x3a1c2a(0x1d7)},'secondary_code':{'$first':_0x3a1c2a(0x17b)},'maxStocks':{'$first':_0x3a1c2a(0x140)},'maxProdPerUnit':{'$first':_0x3a1c2a(0x16d)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x4ade9e[_0x3a1c2a(0x213)]>0x0)_0x314874=_0x4ade9e;else _0x582abd[_0x3a1c2a(0x213)]>0x0&&(_0x314874=_0x582abd);_0x171841[_0x3a1c2a(0x1bd)](_0x314874);}),router[a0_0x842d29(0x1fb)](a0_0x842d29(0x214),async(_0x2c479a,_0x5bea80)=>{var _0x8f2cf4=a0_0x842d29;const {primaryCode:_0x203db0,secondaryCode:_0x2d7849,productCode:_0x92212f,bay:_0xca82b5,bin:_0x1d5966,types:_0x3c7d75,pallet:_0x482095,warehouses:_0x1ba21a,room:_0x2c2399}=_0x2c479a[_0x8f2cf4(0x1df)];console['log'](_0x2c479a['body']);try{const _0x18803b=await warehouse[_0x8f2cf4(0x11e)]([{'$match':{'name':_0x1ba21a,'room':_0x2c2399}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':_0xca82b5,'product_details.bin':_0x1d5966,'product_details.type':_0x3c7d75}},{'$group':{'_id':_0x8f2cf4(0x1d6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x8f2cf4(0x205)},'isle':{'$first':_0x8f2cf4(0x19c)},'pallet':{'$first':_0x8f2cf4(0x1bf)},'maxProducts':{'$first':_0x8f2cf4(0x155)}}}]);_0x5bea80[_0x8f2cf4(0x211)](0xc8)[_0x8f2cf4(0x1bd)](_0x18803b);}catch(_0x3eb8c1){_0x5bea80[_0x8f2cf4(0x211)](0x194)[_0x8f2cf4(0x1bd)]({'message':_0x3eb8c1['message']});}}),module[a0_0x842d29(0x1c8)]=router;