function a0_0x2613(){var _0x26487e=['../middleware/auth','type','$maxStocks','$product_details.maxProducts','Rack\x20C','catch','master','\x20<\x20wew\x20>\x20','room','product_code','purchase_quantity','isle','getFullYear','table\x20page','alertQTY','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','$alertquantity','log','<strong>\x20Regards\x20</strong>','$product_details.product_code','host','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','product_name','Rack\x20B','success','$secondary_code','map','prod_code','quantity','maxperunit','</body></html>','$product_details.floorlevel','rak','$category','return_product','secondary_code_hide','currency','message','string','INC-','12JeZote','bay','/upload/','suppliers_data','/view/add_purchases','$return_data','/view/return_purchase/:id','Logo.png','user','payment\x20successfull','forEach','email','<tbody\x20style=\x22text-align:\x20center;\x22>','English','types','$invoice','/all_purchases/view/','<!DOCTYPE\x20html>','slice','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</span>','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','pallet','$product','secondary_code','sendMail','product_stock','/barcode_scanner','secondary_unit','delivery_date','$product_details','$product_details.expiry_date','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','createTransport','suppliers_docs','site_title','aggregate','getDate','level','303793gircuY','$product_details.type','date','language','$suppliers_docs','prod_primunit','Chinese','suppliers','edit_purchases_view','Receiving\x20Area','$product_details.secondary_code','\x20<>\x20','$product_details.isle','actual_qty','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','express','port','get','/view/add_purchases/:id','post','<h5\x20style=\x22text-align:\x20left;\x22>','Rack\x20A','Arabic','$name','filter','prod_pallet','$warehouse_name','prod_qty','</td>','Shelves','Portuguese','product','findOne','Purchase\x20Mail','product_code_hide','Enclosed','<html><head><title></title>','gmail','/view/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','role','concat','Level','purchases\x20item\x20return\x20successfull','edit_purchases','primary_code','$product_details.product_stock','Arabic\x20(ae)','$product_details.bay','floor','Rack\x20F','then','$finalize','getMonth','Email\x20sent\x20successfully','exports','English\x20(US)','/all_purchases/view','warehouse','prod_secondunit','/../public','</h5>','Purchase\x20data\x20added\x20successfully','Purchase\x20Return','4XVXAZX','save','paid_amount','$product.type','Error\x20Occurs','</table>','render','<tr>','<h5>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','findById','flash','staff','</head><body>','$product_details.storage','$date','due_amount','\x20Order\x20Number\x20:\x20','Paid\x20For\x20Purchase','nodemailer','params','\x20Order\x20Date\x20:\x20','prod_name','3185645vUQhco','$maxProdPerUnit','2370321JfxXcm','Enabled','ejs','$expiry_date','prod_invoice','Rack\x20E','Hindi','status','$unit','<span\x20style=\x22float:\x20right;\x22>','POnumber','$product.floorlevel','room_name','</div>','product_list','floorlevel','currency_placement','padStart','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','delivery_code','An\x20error\x20occurred\x20while\x20saving\x20data.','error','1040776DEtiaP','return_purchase','maxStocks','$product.bay','bin','all_purchases_barcode','Portuguese\x20(BR)','find','warehouse_name','prod_level','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','RoomAssign','$product_details.rack','max_product_unit','Return\x20Goods','$product_details.product_name','storage','foreach\x20newproduct','Rack\x20D','rack','add_purchases','</tbody>','$primary_code','$suppliers','invoice','$note','</thead>','Spanish','json','MaxStocks_data','prod_isle','return_qty','French','/preview/:id','stock_quantity','finalize','148944kfFMhI','Raw\x20Materials','purchase_invoice','$product_details._id','German','expiry_date','deliverycode','primary_code_hide','JO_number','../public/language/languages.json','$due_amount','Sales\x20Update\x20successfully','\x20</h2>','length','An\x20error\x20occurred.','Floor','$brand','$_id','logo','body','name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','360562ebQtop','prod_Qty','random','10801650NxFQVK','production_date','</tr>','$room','password','DRY\x20STORAGE','errors','return_data','Purchase\x20Return\x20Mail','/CheckingWarehouse','prod_unit','standard_unit','prod_cat','RMSEmail','note','$product_details.bin','batch_code','path','$paid_amount','Router','redirect','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','66yprNcJ','product_cat'];a0_0x2613=function(){return _0x26487e;};return a0_0x2613();}var a0_0x362a37=a0_0x2ca2;(function(_0xacf3d5,_0x3805d3){var _0x3b254f=a0_0x2ca2,_0x2f6743=_0xacf3d5();while(!![]){try{var _0x1e2be1=parseInt(_0x3b254f(0x18a))/0x1+-parseInt(_0x3b254f(0x1a0))/0x2*(parseInt(_0x3b254f(0x1e5))/0x3)+-parseInt(_0x3b254f(0x136))/0x4*(-parseInt(_0x3b254f(0x14d))/0x5)+-parseInt(_0x3b254f(0x1ba))/0x6*(parseInt(_0x3b254f(0x20e))/0x7)+parseInt(_0x3b254f(0x165))/0x8+-parseInt(_0x3b254f(0x14f))/0x9+parseInt(_0x3b254f(0x1a3))/0xa;if(_0x1e2be1===_0x3805d3)break;else _0x2f6743['push'](_0x2f6743['shift']());}catch(_0x3edcf8){_0x2f6743['push'](_0x2f6743['shift']());}}}(a0_0x2613,0x827b5));const express=require(a0_0x362a37(0x21d)),app=express(),router=express[a0_0x362a37(0x1b6)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x362a37(0x1bc)),nodemailer=require(a0_0x362a37(0x149));var ejs=require(a0_0x362a37(0x151));const path=require(a0_0x362a37(0x1b4)),users=require(a0_0x362a37(0x193));function a0_0x2ca2(_0x41649b,_0x4e87cf){var _0x2613b7=a0_0x2613();return a0_0x2ca2=function(_0x2ca24a,_0x3c0b87){_0x2ca24a=_0x2ca24a-0x128;var _0x2acca6=_0x2613b7[_0x2ca24a];return _0x2acca6;},a0_0x2ca2(_0x41649b,_0x4e87cf);}router['get']('/view',auth,async(_0x520c09,_0x5f37bd)=>{var _0x3ad25c=a0_0x362a37;try{const {username:_0x213972,email:_0x376672,role:_0x4582a3}=_0x520c09['user'],_0x30cbff=_0x520c09[_0x3ad25c(0x1ed)],_0x3fc97a=await profile[_0x3ad25c(0x22e)]({'email':_0x30cbff[_0x3ad25c(0x1f0)]}),_0x2f3961=await staff[_0x3ad25c(0x22e)]({'email':_0x30cbff[_0x3ad25c(0x1f0)]});if(_0x30cbff[_0x3ad25c(0x237)]==_0x3ad25c(0x142)){const _0x20a9a3=await staff['findOne']({'email':_0x30cbff[_0x3ad25c(0x1f0)]});}const _0x5b9237=await master_shop[_0x3ad25c(0x16c)]();let _0x325268;if(_0x30cbff['role']==_0x3ad25c(0x142)){const _0x28cd41=await staff[_0x3ad25c(0x22e)]({'email':_0x30cbff[_0x3ad25c(0x1f0)]});_0x325268=await purchases[_0x3ad25c(0x20b)]([{'$match':{'warehouse_name':_0x28cd41[_0x3ad25c(0x130)]}},{'$lookup':{'from':_0x3ad25c(0x215),'localField':_0x3ad25c(0x215),'foreignField':_0x3ad25c(0x19e),'as':_0x3ad25c(0x209)}},{'$unwind':_0x3ad25c(0x212)},{'$unwind':_0x3ad25c(0x1fd)},{'$group':{'_id':'$_id','invoice':{'$first':_0x3ad25c(0x1f4)},'suppliers':{'$first':_0x3ad25c(0x17d)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x3ad25c(0x228)},'room':{'$first':_0x3ad25c(0x1a6)},'product':{'$push':_0x3ad25c(0x1fd)},'note':{'$first':_0x3ad25c(0x17f)},'paid_amount':{'$first':_0x3ad25c(0x1b5)},'due_amount':{'$first':_0x3ad25c(0x194)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':_0x3ad25c(0x152)},'suppliers_docs':{'$first':_0x3ad25c(0x212)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x3ad25c(0x168)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x3ad25c(0x139)},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x325268=await purchases['aggregate']([{'$lookup':{'from':'suppliers','localField':_0x3ad25c(0x215),'foreignField':'name','as':_0x3ad25c(0x209)}},{'$unwind':_0x3ad25c(0x212)},{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x3ad25c(0x1f4)},'suppliers':{'$first':_0x3ad25c(0x17d)},'date':{'$first':_0x3ad25c(0x145)},'warehouse_name':{'$first':_0x3ad25c(0x228)},'room':{'$addToSet':'$product.room_name'},'product':{'$push':'$product'},'note':{'$first':'$note'},'paid_amount':{'$first':_0x3ad25c(0x1b5)},'due_amount':{'$first':_0x3ad25c(0x194)},'return_data':{'$first':_0x3ad25c(0x1ea)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0x3ad25c(0x212)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x3ad25c(0x168)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x3ad25c(0x139)},'floorlevel':{'$addToSet':_0x3ad25c(0x15a)},'finalize':{'$first':_0x3ad25c(0x12a)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x5b9237[0x0][_0x3ad25c(0x211)]==_0x3ad25c(0x12e)){var _0x47254d=users[_0x3ad25c(0x1f2)];console['log'](_0x47254d);}else{if(_0x5b9237[0x0][_0x3ad25c(0x211)]=='Hindi')var _0x47254d=users[_0x3ad25c(0x155)];else{if(_0x5b9237[0x0][_0x3ad25c(0x211)]==_0x3ad25c(0x18e))var _0x47254d=users['German'];else{if(_0x5b9237[0x0][_0x3ad25c(0x211)]==_0x3ad25c(0x181))var _0x47254d=users[_0x3ad25c(0x181)];else{if(_0x5b9237[0x0]['language']==_0x3ad25c(0x186))var _0x47254d=users[_0x3ad25c(0x186)];else{if(_0x5b9237[0x0][_0x3ad25c(0x211)]=='Portuguese\x20(BR)')var _0x47254d=users[_0x3ad25c(0x22c)];else{if(_0x5b9237[0x0][_0x3ad25c(0x211)]==_0x3ad25c(0x214))var _0x47254d=users[_0x3ad25c(0x214)];else{if(_0x5b9237[0x0][_0x3ad25c(0x211)]==_0x3ad25c(0x23e))var _0x47254d=users[_0x3ad25c(0x224)];}}}}}}}_0x5f37bd['render']('all_purchases',{'success':_0x520c09[_0x3ad25c(0x141)](_0x3ad25c(0x1d5)),'errors':_0x520c09['flash'](_0x3ad25c(0x1a9)),'purchases':_0x325268,'role':_0x30cbff,'profile':_0x3fc97a,'master_shop':_0x5b9237,'language':_0x47254d});}catch(_0x6f8bea){console[_0x3ad25c(0x1cd)](_0x3ad25c(0x1c9),_0x6f8bea),_0x5f37bd['status'](0xc8)[_0x3ad25c(0x182)]({'message':_0x6f8bea[_0x3ad25c(0x1e2)]});}});function BayBinSelected(_0x3a6e38,_0x499282){var _0x3e29a8=a0_0x362a37,_0x155ff6=[],_0x4baab2=[],_0x5d525e=[],_0x30233c=[],_0x432633=[],_0x30596e=[];let _0x4d8fde=[];if(_0x3a6e38==_0x3e29a8(0x1a8))switch(_0x499282){case _0x3e29a8(0x223):_0x155ff6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x4baab2=[0x1,0x2],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=[_0x3e29a8(0x239),_0x3e29a8(0x199)],_0x432633=['D'],_0x30596e=['A'];break;case'Rack\x20B':_0x155ff6=[0x6,0x5,0x4,0x3,0x2,0x1],_0x4baab2=[0x1,0x2],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=[_0x3e29a8(0x239),_0x3e29a8(0x199)],_0x432633=['D'],_0x30596e=['B'];break;case _0x3e29a8(0x22b):_0x155ff6=[0x0],_0x4baab2=[0x0],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=[_0x3e29a8(0x199)],_0x432633=['D'],_0x30596e=['S'];break;case _0x3e29a8(0x217):_0x155ff6=[0x0],_0x4baab2=[0x0],_0x30233c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x5d525e=[_0x3e29a8(0x199)],_0x432633=['D'],_0x30596e=['R'];break;}else{if(_0x3a6e38=='COLD\x20STORAGE')switch(_0x499282){case _0x3e29a8(0x223):_0x155ff6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x4baab2=['B','F'],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=['Level','Floor'],_0x432633=['C'],_0x30596e=['A'];break;case _0x3e29a8(0x1d4):_0x155ff6=[0x5,0x4,0x3,0x2,0x1],_0x4baab2=['F','B','S'],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=['Level',_0x3e29a8(0x199)],_0x432633=['C'],_0x30596e=['B'];break;case _0x3e29a8(0x1c0):_0x155ff6=[0x1,0x2,0x3,0x4,0x5],_0x4baab2=['B','F','S'],_0x30233c=[0x5,0x4,0x3,0x2,0x1],_0x5d525e=[_0x3e29a8(0x239),_0x3e29a8(0x199)],_0x432633=['C'],_0x30596e=['C'];break;case _0x3e29a8(0x178):_0x155ff6=[0x5,0x4,0x3,0x2,0x1],_0x4baab2=['F','B','S'],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=['Level','Floor'],_0x432633=['C'],_0x30596e=['D'];break;case _0x3e29a8(0x154):_0x155ff6=[0x4,0x3,0x2,0x1],_0x4baab2=[0x1,0x2],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=[_0x3e29a8(0x239),_0x3e29a8(0x199)],_0x432633=['C'],_0x30596e=['E'];break;case _0x3e29a8(0x128):_0x155ff6=[0x1,0x2,0x3],_0x4baab2=[0x1,0x2],_0x30233c=[0x1,0x2,0x3,0x4,0x5],_0x5d525e=[_0x3e29a8(0x239)],_0x432633=['C'],_0x30596e=['F'];break;}}return{'levels':_0x155ff6,'Isle':_0x4baab2,'rack':_0x30233c,'type':_0x5d525e,'storage':_0x432633,'rak':_0x30596e};}async function getRandom8DigitNumber(){var _0x55f4b1=a0_0x362a37;const _0x3efc1f=0x989680,_0x2efbf3=0x5f5e0ff,_0x2041f8=Math[_0x55f4b1(0x240)](Math[_0x55f4b1(0x1a2)]()*(_0x2efbf3-_0x3efc1f+0x1))+_0x3efc1f;var _0x513258;const _0x489948=await purchases[_0x55f4b1(0x22e)]({'invoice':_0x55f4b1(0x1e4)+_0x2041f8});return _0x489948&&_0x489948[_0x55f4b1(0x197)]>0x0?_0x513258='INC-'+_0x2041f8:_0x513258=_0x55f4b1(0x1e4)+_0x2041f8,_0x513258;}router[a0_0x362a37(0x21f)](a0_0x362a37(0x1e9),auth,async(_0x21f5d1,_0x508d3f)=>{var _0xfcce62=a0_0x362a37;try{const {username:_0x1da878,email:_0xcae617,role:_0x37622a}=_0x21f5d1[_0xfcce62(0x1ed)],_0x4750a9=_0x21f5d1[_0xfcce62(0x1ed)],_0x2d3794=await profile[_0xfcce62(0x22e)]({'email':_0x4750a9[_0xfcce62(0x1f0)]}),_0x66be60=await master_shop[_0xfcce62(0x16c)](),_0x1ea449=await staff[_0xfcce62(0x22e)]({'email':_0x4750a9[_0xfcce62(0x1f0)]}),_0x193489=await suppliers[_0xfcce62(0x16c)]({});let _0x7a9575;if(_0x4750a9[_0xfcce62(0x237)]==_0xfcce62(0x142)){const _0x3503c0=await staff[_0xfcce62(0x22e)]({'email':_0x4750a9[_0xfcce62(0x1f0)]});_0x7a9575=await warehouse[_0xfcce62(0x20b)]([{'$match':{'status':_0xfcce62(0x150),'name':_0x3503c0[_0xfcce62(0x130)],'warehouse_category':_0xfcce62(0x18b),'name':{'$ne':_0xfcce62(0x174)}}},{'$group':{'_id':'$name','name':{'$first':_0xfcce62(0x225)}}}]);}else _0x7a9575=await warehouse[_0xfcce62(0x20b)]([{'$match':{'status':_0xfcce62(0x150),'warehouse_category':_0xfcce62(0x18b),'name':{'$ne':_0xfcce62(0x174)}}},{'$group':{'_id':_0xfcce62(0x225),'name':{'$first':_0xfcce62(0x225)}}}]);const _0x2e283e=await product[_0xfcce62(0x16c)]({}),_0x543a98=await warehouse['find']({'status':_0xfcce62(0x150)}),_0x20e673=await purchases['find']({}),_0x9c9d36=_0x20e673[_0xfcce62(0x197)]+0x1,_0x396074=_0xfcce62(0x1e4)+_0x9c9d36['toString']()[_0xfcce62(0x160)](0x5,'0');var _0x4c77ab=['Ambient',_0xfcce62(0x231)];if(_0x66be60[0x0][_0xfcce62(0x211)]=='English\x20(US)')var _0x425c68=users[_0xfcce62(0x1f2)];else{if(_0x66be60[0x0][_0xfcce62(0x211)]=='Hindi')var _0x425c68=users['Hindi'];else{if(_0x66be60[0x0][_0xfcce62(0x211)]=='German')var _0x425c68=users[_0xfcce62(0x18e)];else{if(_0x66be60[0x0]['language']=='Spanish')var _0x425c68=users[_0xfcce62(0x181)];else{if(_0x66be60[0x0][_0xfcce62(0x211)]==_0xfcce62(0x186))var _0x425c68=users[_0xfcce62(0x186)];else{if(_0x66be60[0x0]['language']==_0xfcce62(0x16b))var _0x425c68=users[_0xfcce62(0x22c)];else{if(_0x66be60[0x0][_0xfcce62(0x211)]==_0xfcce62(0x214))var _0x425c68=users[_0xfcce62(0x214)];else{if(_0x66be60[0x0][_0xfcce62(0x211)]==_0xfcce62(0x23e))var _0x425c68=users[_0xfcce62(0x224)];}}}}}}}const _0x55a089=getRandom8DigitNumber();_0x55a089[_0xfcce62(0x129)](_0x1a0f98=>{var _0x46a4eb=_0xfcce62;_0x508d3f[_0x46a4eb(0x13c)](_0x46a4eb(0x17a),{'success':_0x21f5d1['flash'](_0x46a4eb(0x1d5)),'errors':_0x21f5d1['flash'](_0x46a4eb(0x1a9)),'role':_0x4750a9,'profile':_0x2d3794,'suppliers':_0x193489,'warehouse':_0x7a9575,'product':_0x2e283e,'invoice':_0x1a0f98,'master_shop':_0x66be60,'language':_0x425c68,'find_data':_0x543a98,'rooms_data':_0x4c77ab});})[_0xfcce62(0x1c1)](_0x29cd9e=>{var _0x221f61=_0xfcce62;_0x21f5d1['flash'](_0x221f61(0x1a9),_0x221f61(0x13f)),_0x508d3f[_0x221f61(0x1b7)](_0x221f61(0x12f));});}catch(_0x48c820){console['log'](_0x48c820);}}),router[a0_0x362a37(0x21f)](a0_0x362a37(0x220),auth,async(_0x522281,_0x625638)=>{var _0x1dbb2e=a0_0x362a37;try{const _0x3e0a94=_0x522281['params']['id'];console['log'](_0x3e0a94);const _0x27c40b=await master_shop['find']();console['log'](_0x1dbb2e(0x1c2),_0x27c40b);const _0x3620a8=await product[_0x1dbb2e(0x22e)]({'name':_0x3e0a94});console[_0x1dbb2e(0x1cd)]('product',_0x3620a8),_0x625638[_0x1dbb2e(0x156)](0xc8)[_0x1dbb2e(0x182)]({'product_data':_0x3620a8,'master':_0x27c40b});}catch(_0x4e2c2a){console[_0x1dbb2e(0x1cd)]('add_purchases\x20error',_0x4e2c2a);}}),router[a0_0x362a37(0x221)](a0_0x362a37(0x1e9),auth,async(_0x2a2141,_0x4296c2)=>{var _0xa67378=a0_0x362a37;try{const {invoice:_0x265fd6,date:_0x1a4460,warehouse_name:_0x201d58,prod_name:_0x1cca45,prod_code:_0xdddf6,prod_qty:_0x516a6e,prod_unit:_0x2dd93c,prod_secondunit:_0x513dd2,prod_level:_0x580d1e,prod_isle:_0x35f336,prod_pallet:_0x113954,note:_0x502d9a,expiry_date:_0xf2f0c5,batch_code:_0x4c9b3c,payable:_0x1d5402,due_amount:_0x87fc36,Room_name:_0x157371,primary_code:_0x2d8ff9,secondary_code:_0x6bd619,MaxStocks_data:_0x34c68f,PO_number:_0x38622c,SCRN:_0x55fbe1,JO_number:_0x4d45fa}=_0x2a2141['body'];if(typeof _0x1cca45==_0xa67378(0x1e3))var _0x145506=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x14c)]],_0x56e060=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x1d8)]],_0x421ef3=[_0x2a2141[_0xa67378(0x19d)]['prod_Qty']],_0x3cfffa=[_0x2a2141['body']['prod_primunit']],_0x5dd03d=[_0x2a2141['body'][_0xa67378(0x131)]],_0x2483cf=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x16e)]],_0x369ed3=[_0x2a2141['body'][_0xa67378(0x23c)]],_0x8f6ec3=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x1fe)]],_0x7708fb=[_0x2a2141['body'][_0xa67378(0x183)]],_0x401ffd=[_0x2a2141['body'][_0xa67378(0x1b3)]],_0x3e4b7b=[_0x2a2141[_0xa67378(0x19d)]['expiry_date']],_0x113ed1=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x173)]],_0x161624=[_0x2a2141['body'][_0xa67378(0x1ca)]],_0x384889=[_0x2a2141[_0xa67378(0x19d)]['production_date']],_0x8dfabe=[_0x2a2141['body'][_0xa67378(0x1af)]],_0x1241d1=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x171)]],_0x265354=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x190)]],_0x16fbb7=[_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x153)]],_0x5e4279=[_0x2a2141['body'][_0xa67378(0x21b)]];else var _0x145506=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x14c)]],_0x56e060=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x1d8)]],_0x421ef3=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x1a1)]],_0x3cfffa=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x213)]],_0x5dd03d=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x131)]],_0x2483cf=[..._0x2a2141['body']['prod_level']],_0x369ed3=[..._0x2a2141['body'][_0xa67378(0x23c)]],_0x8f6ec3=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x1fe)]],_0x7708fb=[..._0x2a2141[_0xa67378(0x19d)]['MaxStocks_data']],_0x401ffd=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x1b3)]],_0x3e4b7b=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x18f)]],_0x113ed1=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x173)]],_0x161624=[..._0x2a2141['body'][_0xa67378(0x1ca)]],_0x384889=[..._0x2a2141['body'][_0xa67378(0x1a4)]],_0x8dfabe=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x1af)]],_0x1241d1=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x171)]],_0x265354=[..._0x2a2141[_0xa67378(0x19d)]['deliverycode']],_0x16fbb7=[..._0x2a2141[_0xa67378(0x19d)][_0xa67378(0x153)]],_0x5e4279=[..._0x2a2141[_0xa67378(0x19d)]['actual_qty']];const _0x2d43c5=_0x145506['map'](_0x278904=>{return _0x278904={'product_name':_0x278904};});_0x5e4279[_0xa67378(0x1ef)]((_0x3f223d,_0x79fdca)=>{var _0x19502c=_0xa67378;_0x2d43c5[_0x79fdca][_0x19502c(0x21b)]=_0x3f223d;}),_0x56e060[_0xa67378(0x1ef)]((_0x47382b,_0xec6e71)=>{var _0x5a2515=_0xa67378;_0x2d43c5[_0xec6e71][_0x5a2515(0x1c5)]=_0x47382b;}),_0x421ef3['forEach']((_0x38b6fa,_0x5643cf)=>{_0x2d43c5[_0x5643cf]['quantity']=_0x38b6fa;}),_0x3cfffa[_0xa67378(0x1ef)]((_0x519ed1,_0x141d54)=>{var _0x2e9ef4=_0xa67378;_0x2d43c5[_0x141d54][_0x2e9ef4(0x1ae)]=_0x519ed1;}),_0x5dd03d[_0xa67378(0x1ef)]((_0xff8994,_0x3a7912)=>{var _0x3e64f0=_0xa67378;_0x2d43c5[_0x3a7912][_0x3e64f0(0x202)]=_0xff8994;}),_0x2483cf[_0xa67378(0x1ef)]((_0x4dabbf,_0x29e29d)=>{var _0x2ecf2d=_0xa67378;_0x1241d1[_0x2ecf2d(0x1ef)]((_0x430ddd,_0x516288)=>{var _0xa1b593=_0x2ecf2d;if(_0x430ddd==_0xa1b593(0x217)&&_0x29e29d==_0x516288){console[_0xa1b593(0x1cd)](_0x430ddd+_0xa1b593(0x1c3)+_0x29e29d+'\x20<>\x20'+_0x516288+_0xa1b593(0x219)+_0x4dabbf);var _0x41fe1d=_0x4dabbf[_0xa1b593(0x1f7)](0x3);_0x2d43c5[_0x29e29d][_0xa1b593(0x176)]=_0x4dabbf[0x0],_0x2d43c5[_0x29e29d][_0xa1b593(0x179)]=_0x4dabbf[0x1],_0x2d43c5[_0x29e29d][_0xa1b593(0x1e6)]=0x0,_0x2d43c5[_0x29e29d][_0xa1b593(0x169)]=0x0,_0x2d43c5[_0x29e29d]['type']='Floor',_0x2d43c5[_0x29e29d]['floorlevel']=_0x41fe1d;}else{if(_0x430ddd==_0xa1b593(0x22b)&&_0x29e29d==_0x516288){var _0x41fe1d=_0x4dabbf[_0xa1b593(0x1f7)](0x3);_0x2d43c5[_0x29e29d][_0xa1b593(0x176)]=_0x4dabbf[0x0],_0x2d43c5[_0x29e29d]['rack']=_0x4dabbf[0x1],_0x2d43c5[_0x29e29d][_0xa1b593(0x1e6)]=0x0,_0x2d43c5[_0x29e29d][_0xa1b593(0x169)]=0x0,_0x2d43c5[_0x29e29d][_0xa1b593(0x1bd)]='Floor',_0x2d43c5[_0x29e29d]['floorlevel']=_0x4dabbf[0x5];}else{if(_0x29e29d==_0x516288){var _0x57637a;if(_0x4dabbf[0x4]=='L')_0x57637a='Level';else _0x4dabbf[0x4]=='F'&&(_0x57637a=_0xa1b593(0x199));_0x2d43c5[_0x29e29d][_0xa1b593(0x176)]=_0x4dabbf[0x0],_0x2d43c5[_0x29e29d]['rack']=_0x4dabbf[0x1],_0x2d43c5[_0x29e29d]['bay']=_0x4dabbf[0x2],_0x2d43c5[_0x29e29d][_0xa1b593(0x169)]=_0x4dabbf[0x3],_0x2d43c5[_0x29e29d]['type']=_0x57637a,_0x2d43c5[_0x29e29d][_0xa1b593(0x15e)]=_0x4dabbf[0x5];}}}});}),_0x369ed3['forEach']((_0x439ceb,_0xc021ea)=>{var _0x5cb2eb=_0xa67378;_0x2d43c5[_0xc021ea][_0x5cb2eb(0x23c)]=_0x439ceb;}),_0x8f6ec3[_0xa67378(0x1ef)]((_0x2a588b,_0x6e7414)=>{var _0x4cdb16=_0xa67378;_0x2d43c5[_0x6e7414][_0x4cdb16(0x1fe)]=_0x2a588b;}),_0x7708fb['forEach']((_0x35ac82,_0x228b04)=>{var _0x239c41=_0xa67378;_0x2d43c5[_0x228b04][_0x239c41(0x167)]=_0x35ac82;}),_0x401ffd[_0xa67378(0x1ef)]((_0x27542f,_0x40acb9)=>{_0x2d43c5[_0x40acb9]['batch_code']=_0x27542f;}),_0x3e4b7b[_0xa67378(0x1ef)]((_0x4ea239,_0x516cf8)=>{var _0x4c0e56=_0xa67378;_0x2d43c5[_0x516cf8][_0x4c0e56(0x18f)]=_0x4ea239;}),_0x113ed1[_0xa67378(0x1ef)]((_0x5533c5,_0x15dc8f)=>{var _0xb3fc2c=_0xa67378;_0x2d43c5[_0x15dc8f][_0xb3fc2c(0x1da)]=_0x5533c5;}),_0x161624[_0xa67378(0x1ef)]((_0x2c8ca7,_0x13cca1)=>{_0x2d43c5[_0x13cca1]['alertQTY']=_0x2c8ca7;}),_0x384889[_0xa67378(0x1ef)]((_0x2282eb,_0x5e7883)=>{_0x2d43c5[_0x5e7883]['production_date']=_0x2282eb;}),_0x8dfabe[_0xa67378(0x1ef)]((_0x1458be,_0x2252d7)=>{_0x2d43c5[_0x2252d7]['product_cat']=_0x1458be;}),_0x1241d1[_0xa67378(0x1ef)]((_0x815b04,_0x2988d6)=>{var _0x9f8b89=_0xa67378;_0x2d43c5[_0x2988d6][_0x9f8b89(0x15b)]=_0x815b04;}),_0x265354[_0xa67378(0x1ef)]((_0x3de20c,_0x5a47e4)=>{var _0x30e938=_0xa67378;_0x2d43c5[_0x5a47e4][_0x30e938(0x162)]=_0x3de20c;}),_0x16fbb7[_0xa67378(0x1ef)]((_0x333eb7,_0x4aaaec)=>{var _0xd72e2d=_0xa67378;_0x2d43c5[_0x4aaaec][_0xd72e2d(0x17e)]=_0x333eb7;});const _0x1de285=_0x1241d1[_0xa67378(0x1d7)](_0x51c362=>{return _0x51c362={'room_name':_0x51c362};}),_0x18f6c8=_0x2d43c5[_0xa67378(0x226)](_0x1e8440=>_0x1e8440[_0xa67378(0x1d9)]!=='0'&&_0x1e8440[_0xa67378(0x1d9)]!==''),_0x1b38ee=new purchases({'invoice':_0x265fd6,'suppliers':_0x2a2141[_0xa67378(0x19d)][_0xa67378(0x215)],'date':_0x1a4460,'warehouse_name':_0x201d58,'product':_0x18f6c8,'note':_0x502d9a,'due_amount':_0x87fc36,'POnumber':_0x38622c,'SCRN':_0x55fbe1,'JO_number':_0x4d45fa,'roomList':_0x1de285}),_0x2f8c02=await _0x1b38ee[_0xa67378(0x137)](),_0x3906ab=await purchases[_0xa67378(0x22e)]({'invoice':_0x265fd6}),_0x348947=_0x3906ab[_0xa67378(0x22d)][_0xa67378(0x1d7)](async _0xdc49c9=>{var _0x40c418=_0xa67378,_0x4296f7=await warehouse[_0x40c418(0x22e)]({'name':_0x201d58,'room':_0xdc49c9['room_name']}),_0x4a5aba=0x0;return _0x4296f7[_0x40c418(0x1fa)][_0x40c418(0x1ef)](_0x155890=>{var _0x2fa9ed=_0x40c418;_0x155890['product_name']==_0xdc49c9['product_name']&&_0x155890[_0x2fa9ed(0x15e)]==_0xdc49c9[_0x2fa9ed(0x15e)]&&_0x155890['type']==_0xdc49c9[_0x2fa9ed(0x1bd)]&&_0x155890[_0x2fa9ed(0x169)]==_0xdc49c9[_0x2fa9ed(0x169)]&&_0x155890[_0x2fa9ed(0x1e6)]==_0xdc49c9[_0x2fa9ed(0x1e6)]&&_0x155890[_0x2fa9ed(0x179)]==_0xdc49c9[_0x2fa9ed(0x179)]&&_0x155890[_0x2fa9ed(0x176)]==_0xdc49c9['storage']&&_0x155890[_0x2fa9ed(0x18f)]==_0xdc49c9[_0x2fa9ed(0x18f)]&&_0x155890['batch_code']==_0xdc49c9[_0x2fa9ed(0x1b3)]&&_0x155890[_0x2fa9ed(0x1a4)]==_0xdc49c9[_0x2fa9ed(0x1a4)]&&_0x155890[_0x2fa9ed(0x17e)]==_0x3906ab[_0x2fa9ed(0x17e)]&&(_0x155890[_0x2fa9ed(0x200)]+=_0xdc49c9['quantity'],_0x4a5aba++);}),_0x4a5aba===0x0&&_0x4296f7['product_details']['push']({'product_name':_0xdc49c9[_0x40c418(0x1d3)],'product_stock':_0xdc49c9[_0x40c418(0x1d9)],'primary_code':_0xdc49c9[_0x40c418(0x23c)],'secondary_code':_0xdc49c9[_0x40c418(0x1fe)],'product_code':_0xdc49c9[_0x40c418(0x1c5)],'storage':_0xdc49c9['storage'],'rack':_0xdc49c9[_0x40c418(0x179)],'bay':_0xdc49c9[_0x40c418(0x1e6)],'bin':_0xdc49c9[_0x40c418(0x169)],'type':_0xdc49c9[_0x40c418(0x1bd)],'floorlevel':_0xdc49c9[_0x40c418(0x15e)],'maxProducts':_0xdc49c9[_0x40c418(0x167)],'unit':_0xdc49c9[_0x40c418(0x1ae)],'secondary_unit':_0xdc49c9['secondary_unit'],'expiry_date':_0xdc49c9[_0x40c418(0x18f)],'maxPerUnit':_0xdc49c9[_0x40c418(0x1da)],'batch_code':_0xdc49c9['batch_code'],'alertQTY':_0xdc49c9['alertQTY'],'production_date':_0xdc49c9[_0x40c418(0x1a4)],'product_cat':_0xdc49c9[_0x40c418(0x1bb)],'invoice':_0xdc49c9[_0x40c418(0x17e)],'actual_qty':_0xdc49c9[_0x40c418(0x21b)]}),_0x4296f7;});Promise['all'](_0x348947)[_0xa67378(0x129)](async _0xcedecc=>{var _0x2c2161=_0xa67378;try{for(const _0x3516d4 of _0xcedecc){await _0x3516d4[_0x2c2161(0x137)]();}const _0x563d72=await master_shop['find'](),_0x161608=await email_settings[_0x2c2161(0x22e)](),_0xf6e177=await supervisor_settings[_0x2c2161(0x16c)]();var _0x3f489a=_0x3906ab[_0x2c2161(0x22d)],_0x1bdf8e='',_0xae84be;for(_0xae84be in _0x3f489a){_0x1bdf8e+=_0x2c2161(0x13d)+_0x2c2161(0x1f8)+_0x3f489a[_0xae84be][_0x2c2161(0x1d3)]+'</td>'+_0x2c2161(0x1f8)+_0x3f489a[_0xae84be][_0x2c2161(0x1c5)]+_0x2c2161(0x22a)+_0x2c2161(0x1f8)+_0x3f489a[_0xae84be][_0x2c2161(0x1d9)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f489a[_0xae84be][_0x2c2161(0x1ae)]+'</td>'+_0x2c2161(0x1f8)+_0x3f489a[_0xae84be][_0x2c2161(0x202)]+_0x2c2161(0x22a)+_0x2c2161(0x1f8)+_0x3906ab['warehouse_name']+_0x2c2161(0x22a)+_0x2c2161(0x1f8)+_0x3f489a[_0xae84be][_0x2c2161(0x15b)]+_0x2c2161(0x22a)+_0x2c2161(0x1f8)+_0x3f489a[_0xae84be][_0x2c2161(0x176)]+_0x3f489a[_0xae84be][_0x2c2161(0x179)]+_0x3f489a[_0xae84be][_0x2c2161(0x1e6)]+_0x3f489a[_0xae84be][_0x2c2161(0x169)]+_0x3f489a[_0xae84be][_0x2c2161(0x1bd)][0x0]+_0x3f489a[_0xae84be][_0x2c2161(0x15e)]+_0x2c2161(0x22a),_0x2c2161(0x1a5);}let _0x5bda78=nodemailer[_0x2c2161(0x208)]({'host':_0x161608[_0x2c2161(0x1d0)],'port':Number(_0x161608[_0x2c2161(0x21e)]),'secure':![],'auth':{'user':_0x161608[_0x2c2161(0x1f0)],'pass':_0x161608['password']}}),_0x5da8db={'from':_0x161608[_0x2c2161(0x1f0)],'to':_0xf6e177[0x0][_0x2c2161(0x1b0)],'subject':_0x2c2161(0x22f),'attachments':[{'filename':_0x2c2161(0x1ec),'path':__dirname+_0x2c2161(0x132)+_0x2c2161(0x1e7)+_0x563d72[0x0][_0x2c2161(0x16f)],'cid':_0x2c2161(0x19c)}],'html':_0x2c2161(0x1f6)+'<html><head><title></title>'+_0x2c2161(0x143)+_0x2c2161(0x1d1)+_0x2c2161(0x235)+_0x2c2161(0x1d1)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2c2161(0x15c)+'<div>'+'<h2>\x20'+_0x563d72[0x0][_0x2c2161(0x20a)]+_0x2c2161(0x196)+_0x2c2161(0x15c)+_0x2c2161(0x15c)+'<hr\x20class=\x22my-3\x22>'+_0x2c2161(0x1d1)+_0x2c2161(0x222)+_0x2c2161(0x147)+_0x3906ab[_0x2c2161(0x17e)]+'\x20'+_0x2c2161(0x158)+_0x2c2161(0x14b)+_0x3906ab[_0x2c2161(0x210)]+'\x20'+_0x2c2161(0x1f9)+'</h5>'+_0x2c2161(0x15c)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2c2161(0x21c)+_0x2c2161(0x13d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2c2161(0x19f)+_0x2c2161(0x1d2)+_0x2c2161(0x161)+_0x2c2161(0x170)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x2c2161(0x1fb)+_0x2c2161(0x236)+'</tr>'+_0x2c2161(0x180)+_0x2c2161(0x1f1)+'\x20'+_0x1bdf8e+'\x20'+_0x2c2161(0x17b)+_0x2c2161(0x13b)+'<div>'+_0x2c2161(0x1ce)+_0x2c2161(0x13e)+_0x563d72[0x0]['site_title']+'</h5>'+_0x2c2161(0x15c)+_0x2c2161(0x15c)+_0x2c2161(0x1db)};_0x5bda78[_0x2c2161(0x1ff)](_0x5da8db,function(_0x39ae1d,_0x240b22){var _0x263171=_0x2c2161;_0x39ae1d?(console['log'](_0x39ae1d),console[_0x263171(0x1cd)](_0x263171(0x13a))):console[_0x263171(0x1cd)]('Email\x20sent\x20successfully');}),_0x2a2141[_0x2c2161(0x141)](_0x2c2161(0x1d5),_0x2c2161(0x134)),_0x4296c2[_0x2c2161(0x1b7)](_0x2c2161(0x1f5));}catch(_0x441de8){console[_0x2c2161(0x164)](_0x441de8),_0x4296c2['status'](0x1f4)[_0x2c2161(0x182)]({'error':_0x2c2161(0x163)});}})[_0xa67378(0x1c1)](_0x4e8af1=>{var _0x1f1141=_0xa67378;console[_0x1f1141(0x164)](_0x4e8af1),_0x4296c2[_0x1f1141(0x156)](0x1f4)[_0x1f1141(0x182)]({'error':_0x1f1141(0x198)});});}catch(_0xb61c17){console[_0xa67378(0x1cd)](_0xb61c17);}}),router[a0_0x362a37(0x21f)](a0_0x362a37(0x187),auth,async(_0x43d047,_0x4f1719)=>{var _0x28cf60=a0_0x362a37;try{const {username:_0x3baa8f,email:_0x5b33e0,role:_0x29ecf5}=_0x43d047[_0x28cf60(0x1ed)],_0x434fd7=_0x43d047[_0x28cf60(0x1ed)],_0x5307db=await profile[_0x28cf60(0x22e)]({'email':_0x434fd7['email']}),_0x1811de=await master_shop['find'](),_0x1526c1=_0x43d047[_0x28cf60(0x14a)]['id'],_0x24888e=await purchases['findById'](_0x1526c1),_0x3c813d=await warehouse[_0x28cf60(0x20b)]([{'$match':{'name':_0x24888e[_0x28cf60(0x16d)],'room':_0x24888e[_0x28cf60(0x1c4)]}},{'$unwind':_0x28cf60(0x204)},{'$group':{'_id':_0x28cf60(0x18d),'name':{'$first':_0x28cf60(0x175)},'product_stock':{'$first':_0x28cf60(0x23d)},'bay':{'$first':_0x28cf60(0x23f)},'bin':{'$first':_0x28cf60(0x1b2)},'type':{'$first':_0x28cf60(0x20f)},'floorlevel':{'$first':_0x28cf60(0x1dc)},'primary_code':{'$first':_0x28cf60(0x206)},'secondary_code':{'$first':_0x28cf60(0x218)},'product_code':{'$first':_0x28cf60(0x1cf)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x28cf60(0x205)}}}]),_0x3d3b6f=await customer[_0x28cf60(0x16c)]({});let _0x1e984f;if(_0x434fd7[_0x28cf60(0x237)]==_0x28cf60(0x142)){const _0xca41e3=await staff['findOne']({'email':_0x434fd7[_0x28cf60(0x1f0)]});_0x1e984f=await warehouse['aggregate']([{'$match':{'status':_0x28cf60(0x150),'name':_0xca41e3[_0x28cf60(0x130)]}},{'$group':{'_id':_0x28cf60(0x225),'name':{'$first':_0x28cf60(0x225)}}}]);}else _0x1e984f=await warehouse[_0x28cf60(0x20b)]([{'$match':{'status':_0x28cf60(0x150)}},{'$group':{'_id':'$name','name':{'$first':_0x28cf60(0x225)}}}]);const _0xa081e6=await product[_0x28cf60(0x16c)]({}),_0x15e7a8=await suppliers['find']({}),_0x49aaab=BayBinSelected(_0x24888e['warehouse_name'],_0x24888e[_0x28cf60(0x1c4)]);if(_0x1811de[0x0][_0x28cf60(0x211)]==_0x28cf60(0x12e)){var _0x5aac93=users[_0x28cf60(0x1f2)];console[_0x28cf60(0x1cd)](_0x5aac93);}else{if(_0x1811de[0x0][_0x28cf60(0x211)]==_0x28cf60(0x155))var _0x5aac93=users[_0x28cf60(0x155)];else{if(_0x1811de[0x0][_0x28cf60(0x211)]==_0x28cf60(0x18e))var _0x5aac93=users[_0x28cf60(0x18e)];else{if(_0x1811de[0x0][_0x28cf60(0x211)]=='Spanish')var _0x5aac93=users[_0x28cf60(0x181)];else{if(_0x1811de[0x0][_0x28cf60(0x211)]==_0x28cf60(0x186))var _0x5aac93=users[_0x28cf60(0x186)];else{if(_0x1811de[0x0][_0x28cf60(0x211)]==_0x28cf60(0x16b))var _0x5aac93=users[_0x28cf60(0x22c)];else{if(_0x1811de[0x0][_0x28cf60(0x211)]==_0x28cf60(0x214))var _0x5aac93=users[_0x28cf60(0x214)];else{if(_0x1811de[0x0][_0x28cf60(0x211)]==_0x28cf60(0x23e))var _0x5aac93=users[_0x28cf60(0x224)];}}}}}}}_0x4f1719[_0x28cf60(0x13c)](_0x28cf60(0x216),{'success':_0x43d047[_0x28cf60(0x141)]('success'),'errors':_0x43d047[_0x28cf60(0x141)](_0x28cf60(0x1a9)),'role':_0x434fd7,'profile':_0x5307db,'customer':_0x3d3b6f,'warehouse':_0x1e984f,'product':_0x3c813d,'user':_0x24888e,'master_shop':_0x1811de,'unit':_0xa081e6,'language':_0x5aac93,'suppliers':_0x15e7a8,'dataSelected':_0x49aaab});}catch(_0x265a99){console[_0x28cf60(0x1cd)](_0x265a99);}}),router[a0_0x362a37(0x221)](a0_0x362a37(0x187),auth,async(_0x5b2cb4,_0x175130)=>{var _0x30f12f=a0_0x362a37;try{const _0x157319=_0x5b2cb4[_0x30f12f(0x14a)]['id'],{invoice:_0x2b529a,warehouse_name:_0x2b26fa,Room_name:_0x42db90}=_0x5b2cb4['body'],_0x3cb0fe=await warehouse['findOne']({'name':_0x2b26fa,'room':_0x42db90}),_0x163bfc=await purchases[_0x30f12f(0x22e)]({'invoice':_0x2b529a});_0x163bfc[_0x30f12f(0x22d)]['forEach'](_0x3e73b2=>{var _0xb3072e=_0x30f12f,_0x236a77=0x0;const _0x30da42=_0x3cb0fe['product_details'][_0xb3072e(0x1d7)](_0x430d49=>{var _0x172dc4=_0xb3072e;_0x430d49['product_name']==_0x3e73b2['product_name']&&_0x430d49[_0x172dc4(0x15e)]==_0x3e73b2[_0x172dc4(0x15e)]&&_0x430d49[_0x172dc4(0x1bd)]==_0x3e73b2['type']&&_0x430d49[_0x172dc4(0x169)]==_0x3e73b2['bin']&&_0x430d49['bay']==_0x3e73b2[_0x172dc4(0x1e6)]&&_0x430d49[_0x172dc4(0x179)]==_0x3e73b2['rack']&&_0x430d49[_0x172dc4(0x176)]==_0x3e73b2['storage']&&_0x430d49['expiry_date']==_0x3e73b2['expiry_date']&&_0x430d49[_0x172dc4(0x1b3)]==_0x3e73b2[_0x172dc4(0x1b3)]&&_0x430d49[_0x172dc4(0x1a4)]==_0x3e73b2[_0x172dc4(0x1a4)]&&_0x430d49[_0x172dc4(0x203)]==_0x3e73b2[_0x172dc4(0x203)]&&_0x430d49[_0x172dc4(0x162)]==_0x3e73b2[_0x172dc4(0x162)]&&(_0x430d49[_0x172dc4(0x200)]=parseInt(_0x430d49[_0x172dc4(0x200)])+parseInt(_0x3e73b2[_0x172dc4(0x1d9)]),_0x236a77++);});_0x236a77=='0'&&(_0x3cb0fe[_0xb3072e(0x1fa)]=_0x3cb0fe[_0xb3072e(0x1fa)][_0xb3072e(0x238)]({'product_name':_0x3e73b2[_0xb3072e(0x1d3)],'product_stock':_0x3e73b2['quantity'],'primary_code':_0x3e73b2['primary_code'],'secondary_code':_0x3e73b2[_0xb3072e(0x1fe)],'product_code':_0x3e73b2[_0xb3072e(0x1c5)],'storage':_0x3e73b2[_0xb3072e(0x176)],'rack':_0x3e73b2[_0xb3072e(0x179)],'bay':_0x3e73b2['bay'],'bin':_0x3e73b2[_0xb3072e(0x169)],'type':_0x3e73b2['type'],'floorlevel':_0x3e73b2[_0xb3072e(0x15e)],'maxProducts':_0x3e73b2[_0xb3072e(0x167)],'unit':_0x3e73b2['standard_unit'],'secondary_unit':_0x3e73b2[_0xb3072e(0x202)],'expiry_date':_0x3e73b2[_0xb3072e(0x18f)],'maxPerUnit':_0x3e73b2['maxperunit'],'batch_code':_0x3e73b2[_0xb3072e(0x1b3)],'alertQTY':_0x3e73b2[_0xb3072e(0x1ca)],'production_date':_0x3e73b2['production_date'],'delivery_date':_0x3e73b2[_0xb3072e(0x203)],'delivery_code':_0x3e73b2['delivery_code']}));}),await _0x3cb0fe['save'](),_0x163bfc[_0x30f12f(0x189)]=_0x30f12f(0x1b8);const _0x1bd664=await _0x163bfc[_0x30f12f(0x137)]();_0x5b2cb4[_0x30f12f(0x141)](_0x30f12f(0x1d5),_0x30f12f(0x195)),_0x175130[_0x30f12f(0x1b7)](_0x30f12f(0x12f));}catch(_0xb842d5){console[_0x30f12f(0x1cd)](_0xb842d5);}}),router[a0_0x362a37(0x21f)](a0_0x362a37(0x234),auth,async(_0x4c50a4,_0x502113)=>{var _0x37d294=a0_0x362a37;try{const {username:_0x3dd0ac,email:_0x2a1669,role:_0x564d60}=_0x4c50a4[_0x37d294(0x1ed)],_0xa80e7a=_0x4c50a4[_0x37d294(0x1ed)],_0x1a7b3f=await profile[_0x37d294(0x22e)]({'email':_0xa80e7a[_0x37d294(0x1f0)]}),_0xd22af0=await master_shop[_0x37d294(0x16c)](),_0x1f3f39=_0x4c50a4[_0x37d294(0x14a)]['id'],_0x2ca51e=await purchases[_0x37d294(0x140)](_0x1f3f39),_0x480e6f=await suppliers[_0x37d294(0x16c)]({});let _0x22c0ce;if(_0xa80e7a[_0x37d294(0x237)]==_0x37d294(0x142)){const _0x31a734=await staff[_0x37d294(0x22e)]({'email':_0xa80e7a[_0x37d294(0x1f0)]});_0x22c0ce=await warehouse[_0x37d294(0x16c)]({'status':'Enabled','name':_0x31a734[_0x37d294(0x130)],'warehouse_category':_0x37d294(0x18b)});}else _0x22c0ce=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x37d294(0x18b)}},{'$group':{'_id':'$name','name':{'$first':_0x37d294(0x225)}}}]);const _0x41852c=await product['find']({}),_0x7eacd1=BayBinSelected(_0x2ca51e[_0x37d294(0x16d)],_0x2ca51e[_0x37d294(0x1c4)]);let _0x575b31=new Date(_0x2ca51e['expiry_date']),_0x8dcf47=('0'+_0x575b31[_0x37d294(0x20c)]())[_0x37d294(0x1f7)](-0x2),_0x5e2a89=('0'+(_0x575b31[_0x37d294(0x12b)]()+0x1))[_0x37d294(0x1f7)](-0x2),_0x49e1e1=_0x575b31[_0x37d294(0x1c8)](),_0x272c08=_0x49e1e1+'-'+_0x5e2a89+'-'+_0x8dcf47;if(_0xd22af0[0x0][_0x37d294(0x211)]=='English\x20(US)'){var _0x285c81=users[_0x37d294(0x1f2)];console[_0x37d294(0x1cd)](_0x285c81);}else{if(_0xd22af0[0x0][_0x37d294(0x211)]==_0x37d294(0x155))var _0x285c81=users[_0x37d294(0x155)];else{if(_0xd22af0[0x0][_0x37d294(0x211)]==_0x37d294(0x18e))var _0x285c81=users[_0x37d294(0x18e)];else{if(_0xd22af0[0x0]['language']==_0x37d294(0x181))var _0x285c81=users[_0x37d294(0x181)];else{if(_0xd22af0[0x0]['language']==_0x37d294(0x186))var _0x285c81=users[_0x37d294(0x186)];else{if(_0xd22af0[0x0][_0x37d294(0x211)]=='Portuguese\x20(BR)')var _0x285c81=users[_0x37d294(0x22c)];else{if(_0xd22af0[0x0][_0x37d294(0x211)]==_0x37d294(0x214))var _0x285c81=users[_0x37d294(0x214)];else{if(_0xd22af0[0x0][_0x37d294(0x211)]==_0x37d294(0x23e))var _0x285c81=users[_0x37d294(0x224)];}}}}}}}_0x502113[_0x37d294(0x13c)](_0x37d294(0x23b),{'success':_0x4c50a4['flash'](_0x37d294(0x1d5)),'errors':_0x4c50a4[_0x37d294(0x141)]('errors'),'role':_0xa80e7a,'profile':_0x1a7b3f,'purchases':_0x2ca51e,'suppliers':_0x480e6f,'warehouse':_0x22c0ce,'product':_0x41852c,'master_shop':_0xd22af0,'language':_0x285c81,'ed_fullDate':_0x272c08,'dataSelected':_0x7eacd1});}catch(_0x599d0d){console[_0x37d294(0x1cd)](_0x599d0d);}}),router['post'](a0_0x362a37(0x234),auth,async(_0xbac8c9,_0x159d5d)=>{var _0x56d84b=a0_0x362a37;try{const _0x411151=_0xbac8c9[_0x56d84b(0x14a)]['id'],_0x4a8653=await purchases[_0x56d84b(0x22e)]({'_id':_0xbac8c9['params']['id']}),_0x325242=await warehouse[_0x56d84b(0x22e)]({'name':_0x4a8653[_0x56d84b(0x16d)],'room':_0x4a8653[_0x56d84b(0x1c4)]});_0x4a8653[_0x56d84b(0x22d)][_0x56d84b(0x1ef)](_0x166eb4=>{var _0x294885=_0x56d84b;const _0x584889=_0x325242[_0x294885(0x1fa)][_0x294885(0x1d7)](_0xa1eef=>{var _0xf73926=_0x294885;_0xa1eef[_0xf73926(0x1d3)]==_0x166eb4['product_name']&&_0xa1eef[_0xf73926(0x15e)]==_0x166eb4[_0xf73926(0x15e)]&&_0xa1eef['type']==_0x166eb4[_0xf73926(0x1bd)]&&_0xa1eef['bin']==_0x166eb4[_0xf73926(0x169)]&&_0xa1eef['bay']==_0x166eb4[_0xf73926(0x1e6)]&&_0xa1eef[_0xf73926(0x179)]==_0x166eb4['rack']&&_0xa1eef[_0xf73926(0x176)]==_0x166eb4[_0xf73926(0x176)]&&(_0xa1eef[_0xf73926(0x200)]=parseInt(_0xa1eef[_0xf73926(0x200)])-parseInt(_0x166eb4[_0xf73926(0x1d9)]));});}),await _0x325242[_0x56d84b(0x137)]();const {invoice:_0x3e09bd,suppliers:_0x5c11c0,date:_0x55eda3,warehouse_name:_0x2a4cc8,prod_name:_0x48d10d,prod_code:_0x4c3145,prod_qty:_0x239e03,prod_unit:_0x26e433,prod_secondunit:_0x2ffcff,prod_level:_0xc03cae,prod_isle:_0x881b71,prod_pallet:_0xb81582,note:_0x4785af,expiry_date:_0x32631d,batch_code:_0x3185eb,paid_amount:_0x34f9d3,due_amount:_0x258ff0,Room_name:_0x498837,primary_code:_0x30a5fb,secondary_code:_0x32d6bb,PO_number:_0x3ed3a7,JO_number:_0x53ccd6}=_0xbac8c9['body'];if(typeof _0x48d10d==_0x56d84b(0x1e3))var _0x52a5dd=[_0xbac8c9['body'][_0x56d84b(0x14c)]],_0x3524dc=[_0xbac8c9[_0x56d84b(0x19d)]['prod_code']],_0x39f779=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x229)]],_0x1e5add=[_0xbac8c9[_0x56d84b(0x19d)]['prod_unit']],_0x31c0fd=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x131)]],_0x310c65=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x16e)]],_0x357a9d=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x184)]],_0x3ac186=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x227)]],_0x568c26=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x23c)]],_0x186f2f=[_0xbac8c9[_0x56d84b(0x19d)]['secondary_code']],_0x4afbd3=[_0xbac8c9[_0x56d84b(0x19d)]['MaxStocks_data']],_0x1c8834=[_0xbac8c9['body'][_0x56d84b(0x1b3)]],_0x4b6d89=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x18f)]],_0x16d859=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x176)]],_0xe864d3=[_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x1dd)]],_0xfc9d8f=[_0xbac8c9['body'][_0x56d84b(0x1bd)]];else var _0x52a5dd=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x14c)]],_0x3524dc=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x1d8)]],_0x39f779=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x229)]],_0x1e5add=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x1ad)]],_0x31c0fd=[..._0xbac8c9[_0x56d84b(0x19d)]['prod_secondunit']],_0x310c65=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x16e)]],_0x357a9d=[..._0xbac8c9[_0x56d84b(0x19d)]['prod_isle']],_0x3ac186=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x227)]],_0x568c26=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x23c)]],_0x186f2f=[..._0xbac8c9[_0x56d84b(0x19d)]['secondary_code']],_0x4afbd3=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x183)]],_0x1c8834=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x1b3)]],_0x4b6d89=[..._0xbac8c9['body'][_0x56d84b(0x18f)]],_0x16d859=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x176)]],_0xe864d3=[..._0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x1dd)]],_0xfc9d8f=[..._0xbac8c9[_0x56d84b(0x19d)]['type']];const _0x7a2501=_0x52a5dd[_0x56d84b(0x1d7)](_0x59036c=>{return _0x59036c={'product_name':_0x59036c};});_0x3524dc[_0x56d84b(0x1ef)]((_0x4dd78d,_0x2413be)=>{var _0x2060e0=_0x56d84b;_0x7a2501[_0x2413be][_0x2060e0(0x1c5)]=_0x4dd78d;}),_0x39f779['forEach']((_0x2dc8fe,_0x3a0949)=>{_0x7a2501[_0x3a0949]['quantity']=_0x2dc8fe;}),_0x1e5add[_0x56d84b(0x1ef)]((_0x26dcf7,_0x1a704f)=>{var _0xda8529=_0x56d84b;_0x7a2501[_0x1a704f][_0xda8529(0x1ae)]=_0x26dcf7;}),_0x31c0fd[_0x56d84b(0x1ef)]((_0x5e23f6,_0x2f5003)=>{var _0x45c90e=_0x56d84b;_0x7a2501[_0x2f5003][_0x45c90e(0x202)]=_0x5e23f6;}),_0x310c65[_0x56d84b(0x1ef)]((_0x3615a7,_0x3f34a9)=>{var _0x6b0ec0=_0x56d84b;_0x7a2501[_0x3f34a9][_0x6b0ec0(0x1e6)]=_0x3615a7;}),_0x357a9d['forEach']((_0x3fdd64,_0x4e7911)=>{var _0x2447d0=_0x56d84b;_0x7a2501[_0x4e7911][_0x2447d0(0x169)]=_0x3fdd64;}),_0x3ac186[_0x56d84b(0x1ef)]((_0x1f6ccd,_0x46067d)=>{var _0x2e202a=_0x56d84b;_0x7a2501[_0x46067d][_0x2e202a(0x15e)]=_0x1f6ccd;}),_0x568c26[_0x56d84b(0x1ef)]((_0x4c4028,_0x2dcbff)=>{_0x7a2501[_0x2dcbff]['primary_code']=_0x4c4028;}),_0x186f2f[_0x56d84b(0x1ef)]((_0x31ef2c,_0x2835f0)=>{var _0x466c21=_0x56d84b;_0x7a2501[_0x2835f0][_0x466c21(0x1fe)]=_0x31ef2c;}),_0x4afbd3[_0x56d84b(0x1ef)]((_0xcb7ab9,_0x3c7830)=>{var _0x2fa060=_0x56d84b;_0x7a2501[_0x3c7830][_0x2fa060(0x167)]=_0xcb7ab9;}),_0x1c8834[_0x56d84b(0x1ef)]((_0x594774,_0x197888)=>{var _0x215171=_0x56d84b;_0x7a2501[_0x197888][_0x215171(0x1b3)]=_0x594774;}),_0x4b6d89[_0x56d84b(0x1ef)]((_0x17592d,_0x14f646)=>{var _0xb41e02=_0x56d84b;_0x7a2501[_0x14f646][_0xb41e02(0x18f)]=_0x17592d;}),_0xfc9d8f[_0x56d84b(0x1ef)]((_0x19563e,_0x30220e)=>{var _0x5a4ebd=_0x56d84b;_0x7a2501[_0x30220e][_0x5a4ebd(0x1bd)]=_0x19563e;}),_0x16d859['forEach']((_0x463806,_0x4483ec)=>{var _0x322013=_0x56d84b;_0x7a2501[_0x4483ec][_0x322013(0x176)]=_0x463806;}),_0xe864d3[_0x56d84b(0x1ef)]((_0x123134,_0x401fd1)=>{var _0x2c0d4a=_0x56d84b;_0x7a2501[_0x401fd1][_0x2c0d4a(0x179)]=_0x123134;});const _0x297ad9=_0x7a2501[_0x56d84b(0x226)](_0xbd8da3=>_0xbd8da3[_0x56d84b(0x1d9)]!=='0'&&_0xbd8da3[_0x56d84b(0x1d9)]!=='');_0x4a8653[_0x56d84b(0x17e)]=_0x3e09bd,_0x4a8653['suppliers']=_0x5c11c0,_0x4a8653[_0x56d84b(0x210)]=_0x55eda3,_0x4a8653[_0x56d84b(0x16d)]=_0x2a4cc8,_0x4a8653[_0x56d84b(0x22d)]=_0x297ad9,_0x4a8653[_0x56d84b(0x1b1)]=_0x4785af,_0x4a8653[_0x56d84b(0x138)]=_0x34f9d3,_0x4a8653[_0x56d84b(0x146)]=_0x258ff0,_0x4a8653[_0x56d84b(0x1c4)]=_0x498837,_0x4a8653[_0x56d84b(0x159)]=_0x3ed3a7,_0x4a8653[_0x56d84b(0x192)]=_0x53ccd6;const _0x57537b=await _0x4a8653[_0x56d84b(0x137)](),_0x267380=await warehouse['findOne']({'name':_0xbac8c9['body'][_0x56d84b(0x16d)],'room':_0xbac8c9[_0x56d84b(0x19d)]['Room_name']});_0x4a8653[_0x56d84b(0x22d)][_0x56d84b(0x1ef)](_0x4c64ad=>{var _0x6a3982=_0x56d84b,_0x38efeb=0x0;const _0x1fe9f2=_0x267380[_0x6a3982(0x1fa)][_0x6a3982(0x1d7)](_0x1f0468=>{var _0x45ffc1=_0x6a3982;_0x1f0468[_0x45ffc1(0x1d3)]==_0x4c64ad[_0x45ffc1(0x1d3)]&&_0x1f0468['floorlevel']==_0x4c64ad['floorlevel']&&_0x1f0468[_0x45ffc1(0x1bd)]==_0x4c64ad[_0x45ffc1(0x1bd)]&&_0x1f0468['bin']==_0x4c64ad[_0x45ffc1(0x169)]&&_0x1f0468['bay']==_0x4c64ad['bay']&&_0x1f0468[_0x45ffc1(0x179)]==_0x4c64ad['rack']&&_0x1f0468['storage']==_0x4c64ad[_0x45ffc1(0x176)]&&(_0x1f0468[_0x45ffc1(0x200)]=parseInt(_0x1f0468[_0x45ffc1(0x200)])+parseInt(_0x4c64ad[_0x45ffc1(0x1d9)]),_0x38efeb++);});_0x38efeb=='0'&&(_0x267380[_0x6a3982(0x1fa)]=_0x267380[_0x6a3982(0x1fa)][_0x6a3982(0x238)]({'product_name':_0x4c64ad[_0x6a3982(0x1d3)],'product_stock':_0x4c64ad[_0x6a3982(0x1d9)],'primary_code':_0x4c64ad[_0x6a3982(0x23c)],'secondary_code':_0x4c64ad[_0x6a3982(0x1fe)],'product_code':_0x4c64ad[_0x6a3982(0x1c5)],'storage':_0x4c64ad['storage'],'rack':_0x4c64ad[_0x6a3982(0x179)],'bay':_0x4c64ad[_0x6a3982(0x1e6)],'bin':_0x4c64ad[_0x6a3982(0x169)],'type':_0x4c64ad[_0x6a3982(0x1bd)],'floorlevel':_0x4c64ad['floorlevel'],'maxProducts':_0x4c64ad[_0x6a3982(0x167)],'unit':_0x4c64ad[_0x6a3982(0x1ae)],'secondary_unit':_0x4c64ad[_0x6a3982(0x202)],'expiry_date':_0x4c64ad[_0x6a3982(0x18f)]}));}),await _0x267380[_0x56d84b(0x137)]();const _0x758ea4=await s_payment_data[_0x56d84b(0x22e)]({'invoice':_0xbac8c9['body'][_0x56d84b(0x17e)]});if(_0x758ea4===null){}else console[_0x56d84b(0x1cd)](_0x56d84b(0x215),_0x758ea4,_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x17e)]),_0x758ea4['suppliers']=_0xbac8c9[_0x56d84b(0x19d)][_0x56d84b(0x215)],await _0x758ea4['save']();_0xbac8c9[_0x56d84b(0x141)]('success','purchase\x20data\x20update\x20successfully'),_0x159d5d[_0x56d84b(0x1b7)]('/all_purchases/view');}catch(_0x3bbfa8){console[_0x56d84b(0x1cd)](_0x3bbfa8);}}),router[a0_0x362a37(0x221)]('/give_payment/:id',auth,async(_0x1373d3,_0x353963)=>{var _0x26a5d9=a0_0x362a37;try{const _0x353007=_0x1373d3[_0x26a5d9(0x14a)]['id'],{invoice:_0x4d6058,suppliers:_0x5b3b9c,payable:_0x1004f3,due_amount:_0x1dd17c}=_0x1373d3['body'],_0x3353be=await purchases[_0x26a5d9(0x140)](_0x353007);var _0x5d275f=_0x1004f3-_0x1dd17c;_0x3353be[_0x26a5d9(0x138)]=parseFloat(_0x3353be[_0x26a5d9(0x138)])+parseFloat(_0x1dd17c),_0x3353be['due_amount']=_0x5d275f;const _0x1b8e9f=await _0x3353be[_0x26a5d9(0x137)]();console['log'](_0x1b8e9f);const _0x5f3d28=await s_payment_data[_0x26a5d9(0x22e)]({'invoice':_0x4d6058});_0x5f3d28['amount']=_0x5d275f,await _0x5f3d28[_0x26a5d9(0x137)]();let _0x53bb12=new Date(),_0x39947c=('0'+_0x53bb12[_0x26a5d9(0x20c)]())[_0x26a5d9(0x1f7)](-0x2),_0x4148a5=('0'+(_0x53bb12[_0x26a5d9(0x12b)]()+0x1))['slice'](-0x2),_0x1a6d8f=_0x53bb12[_0x26a5d9(0x1c8)](),_0x6f4a48=_0x1a6d8f+'-'+_0x4148a5+'-'+_0x39947c;const _0x47294a=new suppliers_payment({'invoice':_0x4d6058,'date':_0x1a6d8f+'-'+_0x4148a5+'-'+_0x39947c,'suppliers':_0x5b3b9c,'reason':_0x26a5d9(0x148),'amount':_0x1dd17c}),_0x5e0eda=await _0x47294a[_0x26a5d9(0x137)]();_0x1373d3['flash']('success',_0x26a5d9(0x1ee)),_0x353963[_0x26a5d9(0x1b7)](_0x26a5d9(0x12f));}catch(_0x29d83a){console[_0x26a5d9(0x1cd)](_0x29d83a);}}),router['get']('/invoice/:id',auth,async(_0x37269e,_0x24674c)=>{var _0x7f6fd6=a0_0x362a37;try{const {username:_0x4c716f,email:_0x1f797b,role:_0x4d30a5}=_0x37269e[_0x7f6fd6(0x1ed)],_0x1ffed1=_0x37269e[_0x7f6fd6(0x1ed)],_0x5b0e7f=await profile[_0x7f6fd6(0x22e)]({'email':_0x1ffed1[_0x7f6fd6(0x1f0)]}),_0x44182d=await master_shop['find']();console[_0x7f6fd6(0x1cd)](_0x7f6fd6(0x1c2),_0x44182d);const _0x4ec6ce=_0x37269e[_0x7f6fd6(0x14a)]['id'],_0x54103e=await purchases['findById'](_0x4ec6ce);console[_0x7f6fd6(0x1cd)](_0x54103e);const _0x55b7e6=await suppliers[_0x7f6fd6(0x22e)]({'name':_0x54103e['suppliers']});console[_0x7f6fd6(0x1cd)](_0x55b7e6);if(_0x44182d[0x0][_0x7f6fd6(0x211)]==_0x7f6fd6(0x12e)){var _0x4227ee=users[_0x7f6fd6(0x1f2)];console[_0x7f6fd6(0x1cd)](_0x4227ee);}else{if(_0x44182d[0x0][_0x7f6fd6(0x211)]==_0x7f6fd6(0x155))var _0x4227ee=users[_0x7f6fd6(0x155)];else{if(_0x44182d[0x0][_0x7f6fd6(0x211)]=='German')var _0x4227ee=users['German'];else{if(_0x44182d[0x0][_0x7f6fd6(0x211)]==_0x7f6fd6(0x181))var _0x4227ee=users[_0x7f6fd6(0x181)];else{if(_0x44182d[0x0][_0x7f6fd6(0x211)]==_0x7f6fd6(0x186))var _0x4227ee=users[_0x7f6fd6(0x186)];else{if(_0x44182d[0x0]['language']==_0x7f6fd6(0x16b))var _0x4227ee=users['Portuguese'];else{if(_0x44182d[0x0][_0x7f6fd6(0x211)]==_0x7f6fd6(0x214))var _0x4227ee=users['Chinese'];else{if(_0x44182d[0x0][_0x7f6fd6(0x211)]=='Arabic\x20(ae)')var _0x4227ee=users[_0x7f6fd6(0x224)];}}}}}}}_0x24674c[_0x7f6fd6(0x13c)](_0x7f6fd6(0x18c),{'success':_0x37269e[_0x7f6fd6(0x141)](_0x7f6fd6(0x1d5)),'errors':_0x37269e[_0x7f6fd6(0x141)](_0x7f6fd6(0x1a9)),'role':_0x1ffed1,'profile':_0x5b0e7f,'master_shop':_0x44182d,'supplier':_0x55b7e6,'purchase':_0x54103e,'language':_0x4227ee});}catch(_0x43f19b){console['log'](_0x43f19b);}}),router[a0_0x362a37(0x21f)](a0_0x362a37(0x1eb),auth,async(_0x3989ba,_0x126ed7)=>{var _0x3d5306=a0_0x362a37;try{const {username:_0x5a109d,email:_0x14595c,role:_0x324742}=_0x3989ba[_0x3d5306(0x1ed)],_0x4b8f29=_0x3989ba[_0x3d5306(0x1ed)],_0x34c7a3=await profile[_0x3d5306(0x22e)]({'email':_0x4b8f29[_0x3d5306(0x1f0)]}),_0x1be5f8=await master_shop['find']();console[_0x3d5306(0x1cd)](_0x3d5306(0x1c2),_0x1be5f8);const _0x2a3ce9=_0x3989ba[_0x3d5306(0x14a)]['id'];console[_0x3d5306(0x1cd)](_0x2a3ce9);const _0x3a92f5=await purchases[_0x3d5306(0x140)](_0x2a3ce9);console[_0x3d5306(0x1cd)]('user_id',_0x3a92f5);const _0x5af489=await product[_0x3d5306(0x16c)]({}),_0x20dec4=await warehouse[_0x3d5306(0x20b)]([{'$match':{'name':_0x3a92f5['warehouse_name'],'room':_0x3a92f5[_0x3d5306(0x1c4)],'warehouse_category':_0x3d5306(0x18b)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3d5306(0x18d),'name':{'$first':_0x3d5306(0x175)},'product_stock':{'$first':_0x3d5306(0x23d)},'bay':{'$first':_0x3d5306(0x23f)},'bin':{'$first':_0x3d5306(0x1b2)},'type':{'$first':_0x3d5306(0x20f)},'floorlevel':{'$first':_0x3d5306(0x1dc)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3d5306(0x218)},'product_code':{'$first':_0x3d5306(0x1cf)},'storage':{'$first':_0x3d5306(0x144)},'rack':{'$first':_0x3d5306(0x172)}}}]);warehouse_data=await warehouse[_0x3d5306(0x20b)]([{'$match':{'status':_0x3d5306(0x150),'name':'Return\x20Goods','warehouse_category':_0x3d5306(0x18b)}},{'$group':{'_id':_0x3d5306(0x225),'name':{'$first':_0x3d5306(0x225)}}},{'$sort':{'name':0x1}}]),console[_0x3d5306(0x1cd)]('stock_data',_0x20dec4);if(_0x1be5f8[0x0][_0x3d5306(0x211)]==_0x3d5306(0x12e)){var _0x40827c=users[_0x3d5306(0x1f2)];console[_0x3d5306(0x1cd)](_0x40827c);}else{if(_0x1be5f8[0x0][_0x3d5306(0x211)]==_0x3d5306(0x155))var _0x40827c=users['Hindi'];else{if(_0x1be5f8[0x0][_0x3d5306(0x211)]==_0x3d5306(0x18e))var _0x40827c=users[_0x3d5306(0x18e)];else{if(_0x1be5f8[0x0][_0x3d5306(0x211)]=='Spanish')var _0x40827c=users[_0x3d5306(0x181)];else{if(_0x1be5f8[0x0]['language']==_0x3d5306(0x186))var _0x40827c=users[_0x3d5306(0x186)];else{if(_0x1be5f8[0x0][_0x3d5306(0x211)]==_0x3d5306(0x16b))var _0x40827c=users[_0x3d5306(0x22c)];else{if(_0x1be5f8[0x0][_0x3d5306(0x211)]=='Chinese')var _0x40827c=users[_0x3d5306(0x214)];else{if(_0x1be5f8[0x0][_0x3d5306(0x211)]==_0x3d5306(0x23e))var _0x40827c=users[_0x3d5306(0x224)];}}}}}}}_0x126ed7['render'](_0x3d5306(0x166),{'success':_0x3989ba['flash'](_0x3d5306(0x1d5)),'errors':_0x3989ba[_0x3d5306(0x141)](_0x3d5306(0x1a9)),'role':_0x4b8f29,'profile':_0x34c7a3,'user':_0x3a92f5,'stock':_0x20dec4,'master_shop':_0x1be5f8,'product':_0x5af489,'language':_0x40827c,'warehouse':warehouse_data});}catch(_0x57b678){console['log'](_0x57b678);}}),router[a0_0x362a37(0x221)](a0_0x362a37(0x1eb),auth,async(_0xc35cf0,_0x4e3be5)=>{var _0x389e6e=a0_0x362a37;try{const {invoice:_0x287cb6,date:_0x4b7358,warehouse_name:_0x593003,Room_name:_0xee59,product_name:_0x441a27,purchase_quantity:_0x1eb7df,stocks:_0x534228,return_qty:_0x28e65b,note:_0x45c132,level:_0x2e2db8,isle:_0x1f40d1,pallet:_0x238385,to_warehouse_name:_0x227ad3,to_Room_name:_0x4b4749}=_0xc35cf0[_0x389e6e(0x19d)],_0x111e91=await purchases[_0x389e6e(0x22e)]({'_id':_0xc35cf0[_0x389e6e(0x14a)]['id']}),_0x3b03d6=await warehouse[_0x389e6e(0x22e)]({'name':_0x593003,'room':_0xee59});if(typeof _0x441a27==_0x389e6e(0x1e3))var _0x1bed44=[_0xc35cf0['body'][_0x389e6e(0x1d3)]],_0x19fc4f=[_0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x1c6)]],_0x561125=[_0xc35cf0['body']['stocks']],_0x5139ee=[_0xc35cf0[_0x389e6e(0x19d)]['return_qty']],_0x51aad6=[_0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x20d)]],_0x7e21e3=[_0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x1c7)]],_0x35b3bf=[_0xc35cf0['body'][_0x389e6e(0x1fc)]],_0x39f9dd=[_0xc35cf0['body'][_0x389e6e(0x1f3)]],_0x322e05=[_0xc35cf0['body'][_0x389e6e(0x230)]],_0x1308a8=[_0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x191)]],_0x394fc1=[_0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x1e0)]];else var _0x1bed44=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x1d3)]],_0x19fc4f=[..._0xc35cf0[_0x389e6e(0x19d)]['purchase_quantity']],_0x561125=[..._0xc35cf0[_0x389e6e(0x19d)]['stocks']],_0x5139ee=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x185)]],_0x51aad6=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x20d)]],_0x7e21e3=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x1c7)]],_0x35b3bf=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x1fc)]],_0x39f9dd=[..._0xc35cf0['body'][_0x389e6e(0x1f3)]],_0x322e05=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x230)]],_0x1308a8=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x191)]],_0x394fc1=[..._0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x1e0)]];const _0x581de6=_0x1bed44['map'](_0x2f62b4=>{return _0x2f62b4={'product_name':_0x2f62b4};});_0x19fc4f[_0x389e6e(0x1ef)]((_0x59bb23,_0x252a5d)=>{var _0x2f48f1=_0x389e6e;_0x581de6[_0x252a5d][_0x2f48f1(0x1c6)]=_0x59bb23;}),_0x561125[_0x389e6e(0x1ef)]((_0x11ae75,_0x27011b)=>{var _0x578493=_0x389e6e;_0x581de6[_0x27011b][_0x578493(0x188)]=_0x11ae75;}),_0x5139ee[_0x389e6e(0x1ef)]((_0x4c0525,_0x1459b7)=>{var _0x1fd05f=_0x389e6e;_0x581de6[_0x1459b7][_0x1fd05f(0x185)]=_0x4c0525;}),_0x51aad6[_0x389e6e(0x1ef)]((_0x2a35b7,_0x2ba909)=>{var _0xcbd79c=_0x389e6e;_0x581de6[_0x2ba909][_0xcbd79c(0x1e6)]=_0x2a35b7;}),_0x7e21e3['forEach']((_0x1af589,_0x2e3744)=>{var _0xc5f4ae=_0x389e6e;_0x581de6[_0x2e3744][_0xc5f4ae(0x169)]=_0x1af589;}),_0x35b3bf[_0x389e6e(0x1ef)]((_0x53957f,_0x2c2b0c)=>{var _0x5e9a79=_0x389e6e;_0x581de6[_0x2c2b0c][_0x5e9a79(0x15e)]=_0x53957f;}),_0x39f9dd[_0x389e6e(0x1ef)]((_0x221ec3,_0x4b3b81)=>{var _0xb822c8=_0x389e6e;_0x581de6[_0x4b3b81][_0xb822c8(0x1bd)]=_0x221ec3;}),_0x322e05['forEach']((_0x1482bd,_0x2d20f1)=>{var _0x158000=_0x389e6e;_0x581de6[_0x2d20f1][_0x158000(0x1c5)]=_0x1482bd;}),_0x1308a8[_0x389e6e(0x1ef)]((_0xa0ed36,_0x514e4e)=>{var _0x2ba836=_0x389e6e;_0x581de6[_0x514e4e][_0x2ba836(0x23c)]=_0xa0ed36;}),_0x394fc1[_0x389e6e(0x1ef)]((_0x4a4ad6,_0x557a67)=>{var _0x38e9a9=_0x389e6e;_0x581de6[_0x557a67][_0x38e9a9(0x1fe)]=_0x4a4ad6;}),_0x111e91[_0x389e6e(0x22d)][_0x389e6e(0x1ef)](_0x580766=>{var _0x56f9e3=_0x389e6e;const _0x1fe13e=_0x3b03d6[_0x56f9e3(0x1fa)]['map'](_0xcda646=>{var _0x474a22=_0x56f9e3;_0xcda646[_0x474a22(0x1d3)]==_0x580766['product_name']&&_0xcda646['floorlevel']==_0x580766[_0x474a22(0x15e)]&&_0xcda646[_0x474a22(0x1bd)]==_0x580766[_0x474a22(0x1bd)]&&_0xcda646['bin']==_0x580766['bin']&&_0xcda646[_0x474a22(0x1e6)]==_0x580766[_0x474a22(0x1e6)]&&_0xcda646[_0x474a22(0x179)]==_0x580766[_0x474a22(0x179)]&&_0xcda646[_0x474a22(0x176)]==_0x580766['storage']&&(console['log'](parseInt(_0xcda646['product_stock'])+_0x474a22(0x219)+parseInt(_0x580766[_0x474a22(0x1d9)])),_0xcda646[_0x474a22(0x200)]=parseInt(_0xcda646[_0x474a22(0x200)])+parseInt(_0x580766[_0x474a22(0x1d9)]));});}),await _0x3b03d6[_0x389e6e(0x137)]();const _0x56aaba=_0x581de6[_0x389e6e(0x226)](_0x1c0f31=>_0x1c0f31[_0x389e6e(0x185)]!=='0'&&_0x1c0f31['return_qty']!=='');var _0x3abf45=0x0;_0x56aaba[_0x389e6e(0x1ef)](_0x3652e1=>{var _0xff149d=_0x389e6e;console[_0xff149d(0x1cd)](_0xff149d(0x177),_0x3652e1),(parseInt(_0x3652e1[_0xff149d(0x1c6)])<parseInt(_0x3652e1[_0xff149d(0x185)])||parseInt(_0x3652e1[_0xff149d(0x188)])<parseInt(_0x3652e1[_0xff149d(0x185)]))&&_0x3abf45++;});if(_0x3abf45!=0x0)return _0xc35cf0['flash'](_0x389e6e(0x1a9),_0x389e6e(0x1cb)),_0x4e3be5[_0x389e6e(0x1b7)]('back');const _0x2921fc=new purchases_return({'invoice':_0x287cb6,'suppliers':_0xc35cf0['body'][_0x389e6e(0x215)],'date':_0x4b7358,'warehouse_name':_0x593003,'return_product':_0x56aaba,'note':_0x45c132,'room':_0xee59,'to_warehouse_name':_0x227ad3,'to_room':_0x4b4749}),_0x17e9df=await _0x2921fc['save']();console[_0x389e6e(0x1cd)](_0x2921fc);const _0x1730af=await purchases_return[_0x389e6e(0x22e)]({'invoice':_0x287cb6}),_0x34e52d=await warehouse[_0x389e6e(0x22e)]({'name':_0x227ad3,'room':_0x4b4749});_0x1730af[_0x389e6e(0x1df)][_0x389e6e(0x1ef)](_0x4d8e5b=>{var _0x53d62d=_0x389e6e,_0x4ce02b=0x0;const _0x390d69=_0x34e52d[_0x53d62d(0x1fa)][_0x53d62d(0x1d7)](_0x46252d=>{var _0x4bedeb=_0x53d62d;_0x46252d[_0x4bedeb(0x1d3)]==_0x4d8e5b[_0x4bedeb(0x1d3)]&&_0x46252d[_0x4bedeb(0x15e)]==_0x4d8e5b[_0x4bedeb(0x15e)]&&_0x46252d[_0x4bedeb(0x1bd)]==_0x4d8e5b[_0x4bedeb(0x1bd)]&&_0x46252d['bin']==_0x4d8e5b[_0x4bedeb(0x169)]&&_0x46252d['bay']==_0x4d8e5b[_0x4bedeb(0x1e6)]&&(_0x46252d[_0x4bedeb(0x200)]=parseInt(_0x46252d[_0x4bedeb(0x200)])-parseInt(_0x4d8e5b[_0x4bedeb(0x185)]),_0x4ce02b++);});_0x4ce02b=='0'&&(_0x34e52d['product_details']=_0x34e52d['product_details'][_0x53d62d(0x238)]({'product_name':_0x4d8e5b[_0x53d62d(0x1d3)],'product_stock':_0x4d8e5b['return_qty'],'primary_code':_0x4d8e5b[_0x53d62d(0x23c)],'secondary_code':_0x4d8e5b[_0x53d62d(0x1fe)],'product_code':_0x4d8e5b['product_code'],'storage':_0x4d8e5b['storage'],'rack':_0x4d8e5b['rack'],'bay':_0x4d8e5b['bay'],'bin':_0x4d8e5b[_0x53d62d(0x169)],'type':_0x4d8e5b[_0x53d62d(0x1bd)],'floorlevel':_0x4d8e5b['floorlevel'],'maxProducts':_0x4d8e5b['maxStocks'],'unit':_0x4d8e5b[_0x53d62d(0x1ae)],'secondary_unit':_0x4d8e5b[_0x53d62d(0x202)],'expiry_date':_0x4d8e5b[_0x53d62d(0x18f)]}));}),await _0x34e52d['save']();const _0x2f4645=await purchases[_0x389e6e(0x22e)]({'invoice':_0x287cb6});_0x2f4645[_0x389e6e(0x1aa)]='True';const _0x1cbf5c=await _0x2f4645[_0x389e6e(0x137)](),_0x4d440d=new s_payment_data({'invoice':_0x287cb6,'suppliers':_0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x215)],'reason':_0x389e6e(0x135)});await _0x4d440d[_0x389e6e(0x137)]();const _0x3c8b7f=await master_shop[_0x389e6e(0x16c)]();console[_0x389e6e(0x1cd)]('add\x20post',_0x3c8b7f[0x0][_0x389e6e(0x16f)]);const _0x5a9529=await email_settings['findOne'](),_0x5d89e7=await suppliers[_0x389e6e(0x22e)]({'name':_0xc35cf0[_0x389e6e(0x19d)][_0x389e6e(0x215)]});console[_0x389e6e(0x1cd)](_0x389e6e(0x1e8),_0x5d89e7);_0x3c8b7f[0x0][_0x389e6e(0x15f)]==0x1?(right_currency=_0x3c8b7f[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x3c8b7f[0x0][_0x389e6e(0x1e1)]);var _0x2db7c4=_0x1bed44,_0x2e6f6e=_0x5139ee,_0x108e1b='',_0x4dce52;for(_0x4dce52 in _0x2db7c4){_0x108e1b+=_0x389e6e(0x13d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2db7c4[_0x4dce52]+_0x389e6e(0x22a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2e6f6e[_0x4dce52]+_0x389e6e(0x22a)+_0x389e6e(0x1a5);}console[_0x389e6e(0x1cd)](_0x389e6e(0x15d),_0x108e1b);let _0x5ce77c=nodemailer[_0x389e6e(0x208)]({'service':_0x389e6e(0x233),'auth':{'user':_0x5a9529['email'],'pass':_0x5a9529[_0x389e6e(0x1a7)]}}),_0x3b3ff7={'from':_0x5a9529[_0x389e6e(0x1f0)],'to':_0x5d89e7[_0x389e6e(0x1f0)],'subject':_0x389e6e(0x1ab),'attachments':[{'filename':_0x389e6e(0x1ec),'path':__dirname+'/../public'+_0x389e6e(0x1e7)+_0x3c8b7f[0x0][_0x389e6e(0x16f)],'cid':'logo'}],'html':_0x389e6e(0x1f6)+_0x389e6e(0x232)+_0x389e6e(0x143)+_0x389e6e(0x1d1)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x389e6e(0x1d1)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+'<h2>\x20'+_0x3c8b7f[0x0][_0x389e6e(0x20a)]+_0x389e6e(0x196)+_0x389e6e(0x15c)+_0x389e6e(0x15c)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x389e6e(0x222)+_0x389e6e(0x147)+_0x287cb6+'\x20'+_0x389e6e(0x158)+'\x20Order\x20Date\x20:\x20'+_0x4b7358+'\x20'+_0x389e6e(0x1f9)+_0x389e6e(0x133)+_0x389e6e(0x15c)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x389e6e(0x21c)+_0x389e6e(0x13d)+_0x389e6e(0x207)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>'+_0x389e6e(0x1b9)+_0x389e6e(0x1a5)+_0x389e6e(0x180)+_0x389e6e(0x1f1)+'\x20'+_0x108e1b+'\x20'+_0x389e6e(0x17b)+'</table>'+_0x389e6e(0x1d1)+_0x389e6e(0x1ce)+_0x389e6e(0x13e)+_0x3c8b7f[0x0][_0x389e6e(0x20a)]+'</h5>'+'</div>'+'</div>'+_0x389e6e(0x1db)};_0x5ce77c['sendMail'](_0x3b3ff7,function(_0x486b6d,_0x2da2f3){var _0x15f43b=_0x389e6e;_0x486b6d?(console[_0x15f43b(0x1cd)](_0x486b6d),console[_0x15f43b(0x1cd)](_0x15f43b(0x13a))):console[_0x15f43b(0x1cd)](_0x15f43b(0x12c));}),_0xc35cf0[_0x389e6e(0x141)]('success',_0x389e6e(0x23a)),_0x4e3be5[_0x389e6e(0x1b7)](_0x389e6e(0x12f));}catch(_0x26256a){console[_0x389e6e(0x1cd)](_0x26256a),_0x4e3be5[_0x389e6e(0x156)](0xc8)[_0x389e6e(0x182)]({'message':_0x26256a[_0x389e6e(0x1e2)]});}}),router[a0_0x362a37(0x21f)]('/barcode/:id',auth,async(_0x18b377,_0x4d6656)=>{var _0x43eccc=a0_0x362a37;try{const {username:_0x113a49,email:_0x201e72,role:_0x34980e}=_0x18b377[_0x43eccc(0x1ed)],_0xf27050=_0x18b377['user'],_0x9fcc43=await profile['findOne']({'email':_0xf27050[_0x43eccc(0x1f0)]}),_0x5475dd=await master_shop[_0x43eccc(0x16c)](),_0x29ed41=_0x18b377[_0x43eccc(0x14a)]['id'],_0x599108=await purchases[_0x43eccc(0x140)](_0x29ed41);if(_0x5475dd[0x0][_0x43eccc(0x211)]=='English\x20(US)')var _0x1f9403=users[_0x43eccc(0x1f2)];else{if(_0x5475dd[0x0]['language']==_0x43eccc(0x155))var _0x1f9403=users[_0x43eccc(0x155)];else{if(_0x5475dd[0x0][_0x43eccc(0x211)]==_0x43eccc(0x18e))var _0x1f9403=users['German'];else{if(_0x5475dd[0x0]['language']=='Spanish')var _0x1f9403=users['Spanish'];else{if(_0x5475dd[0x0][_0x43eccc(0x211)]==_0x43eccc(0x186))var _0x1f9403=users[_0x43eccc(0x186)];else{if(_0x5475dd[0x0][_0x43eccc(0x211)]=='Portuguese\x20(BR)')var _0x1f9403=users[_0x43eccc(0x22c)];else{if(_0x5475dd[0x0][_0x43eccc(0x211)]==_0x43eccc(0x214))var _0x1f9403=users[_0x43eccc(0x214)];else{if(_0x5475dd[0x0][_0x43eccc(0x211)]==_0x43eccc(0x23e))var _0x1f9403=users['Arabic'];}}}}}}}_0x4d6656['render'](_0x43eccc(0x16a),{'success':_0x18b377[_0x43eccc(0x141)](_0x43eccc(0x1d5)),'errors':_0x18b377[_0x43eccc(0x141)]('errors'),'role':_0xf27050,'profile':_0x9fcc43,'alldata':_0x599108,'master_shop':_0x5475dd,'language':_0x1f9403}),console[_0x43eccc(0x1cd)](alldata);}catch(_0x586c8a){console[_0x43eccc(0x1cd)](_0x586c8a);}}),router[a0_0x362a37(0x221)](a0_0x362a37(0x201),async(_0x5c9d91,_0x2646df)=>{var _0x5406e9=a0_0x362a37;const {product_code:_0x284345}=_0x5c9d91[_0x5406e9(0x19d)];var _0x354935;const _0x35538f=await product[_0x5406e9(0x20b)]([{'$match':{'primary_code':_0x284345,'product_category':_0x5406e9(0x18b)}},{'$group':{'_id':_0x5406e9(0x19b),'name':{'$first':'$name'},'category':{'$first':_0x5406e9(0x1de)},'brand':{'$first':_0x5406e9(0x19a)},'unit':{'$first':_0x5406e9(0x157)},'alertquantity':{'$first':_0x5406e9(0x1cc)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x5406e9(0x1d6)},'maxStocks':{'$first':_0x5406e9(0x1be)},'maxProdPerUnit':{'$first':_0x5406e9(0x14e)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x3e89e5=await product[_0x5406e9(0x20b)]([{'$match':{'secondary_code':_0x284345,'product_category':_0x5406e9(0x18b)}},{'$group':{'_id':_0x5406e9(0x19b),'name':{'$first':_0x5406e9(0x225)},'category':{'$first':'$category'},'brand':{'$first':_0x5406e9(0x19a)},'unit':{'$first':_0x5406e9(0x157)},'alertquantity':{'$first':_0x5406e9(0x1cc)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x5406e9(0x17c)},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x5406e9(0x1be)},'maxProdPerUnit':{'$first':_0x5406e9(0x14e)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x35538f[_0x5406e9(0x197)]>0x0)_0x354935=_0x35538f;else _0x3e89e5[_0x5406e9(0x197)]>0x0&&(_0x354935=_0x3e89e5);_0x2646df[_0x5406e9(0x182)](_0x354935);}),router[a0_0x362a37(0x221)](a0_0x362a37(0x1ac),async(_0x146f84,_0x3f9027)=>{var _0x25f40a=a0_0x362a37;const {primaryCode:_0x57ca82,secondaryCode:_0x4326cb,productCode:_0xe2c0b9,bay:_0x4c6daa,bin:_0x65992f,types:_0x3f8b16,pallet:_0x217ae6,warehouses:_0x5bbd00,room:_0x36c04d}=_0x146f84[_0x25f40a(0x19d)];console[_0x25f40a(0x1cd)](_0x146f84[_0x25f40a(0x19d)]);try{const _0x24a663=await warehouse['aggregate']([{'$match':{'name':_0x5bbd00,'room':_0x36c04d}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':_0x4c6daa,'product_details.bin':_0x65992f,'product_details.type':_0x3f8b16}},{'$group':{'_id':_0x25f40a(0x18d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x25f40a(0x23d)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x25f40a(0x21a)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x25f40a(0x1bf)}}}]);_0x3f9027['status'](0xc8)[_0x25f40a(0x182)](_0x24a663);}catch(_0xdec856){_0x3f9027['status'](0x194)[_0x25f40a(0x182)]({'message':_0xdec856[_0x25f40a(0x1e2)]});}}),module[a0_0x362a37(0x12d)]=router;