var a0_0x6dba34=a0_0x17fb;function a0_0x17fb(_0x45f147,_0x1ed500){var _0x288739=a0_0x2887();return a0_0x17fb=function(_0x17fbbb,_0x45a651){_0x17fbbb=_0x17fbbb-0xf9;var _0x29c560=_0x288739[_0x17fbbb];return _0x29c560;},a0_0x17fb(_0x45f147,_0x1ed500);}(function(_0x1b03ff,_0x4c0155){var _0x4f63f8=a0_0x17fb,_0x2a8fe7=_0x1b03ff();while(!![]){try{var _0x26353b=-parseInt(_0x4f63f8(0x199))/0x1*(-parseInt(_0x4f63f8(0x13d))/0x2)+-parseInt(_0x4f63f8(0x109))/0x3*(parseInt(_0x4f63f8(0x1aa))/0x4)+-parseInt(_0x4f63f8(0x206))/0x5*(parseInt(_0x4f63f8(0x1e0))/0x6)+-parseInt(_0x4f63f8(0x12a))/0x7+parseInt(_0x4f63f8(0x214))/0x8*(-parseInt(_0x4f63f8(0x1d9))/0x9)+parseInt(_0x4f63f8(0x218))/0xa*(-parseInt(_0x4f63f8(0x124))/0xb)+-parseInt(_0x4f63f8(0x1af))/0xc*(-parseInt(_0x4f63f8(0x193))/0xd);if(_0x26353b===_0x4c0155)break;else _0x2a8fe7['push'](_0x2a8fe7['shift']());}catch(_0x4a9ec7){_0x2a8fe7['push'](_0x2a8fe7['shift']());}}}(a0_0x2887,0x7e687));const express=require(a0_0x6dba34(0x127)),app=express(),router=express[a0_0x6dba34(0x1c7)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require(a0_0x6dba34(0x12e)),auth=require(a0_0x6dba34(0x1a8)),nodemailer=require(a0_0x6dba34(0x1f2));var ejs=require(a0_0x6dba34(0x197));const path=require(a0_0x6dba34(0x1a2)),users=require('../public/language/languages.json');router[a0_0x6dba34(0x1b8)]('/view',auth,async(_0x28281b,_0x55e3b8)=>{var _0x59c9d4=a0_0x6dba34;try{const {username:_0x2563ff,email:_0x6db687,role:_0x1b6a14}=_0x28281b[_0x59c9d4(0x13b)],_0x2e886f=_0x28281b[_0x59c9d4(0x13b)],_0x1f0779=await profile[_0x59c9d4(0x192)]({'email':_0x2e886f[_0x59c9d4(0x1ec)]}),_0x2fc5b7=await staff['findOne']({'email':_0x2e886f['email']});if(_0x2e886f[_0x59c9d4(0x1cf)]==_0x59c9d4(0x19d)){const _0x55af5b=await staff[_0x59c9d4(0x192)]({'email':_0x2e886f[_0x59c9d4(0x1ec)]});}const _0x508f73=await master_shop[_0x59c9d4(0x1ba)]();let _0x380c5d;if(_0x2e886f[_0x59c9d4(0x1cf)]==_0x59c9d4(0x19d)){const _0x5a92a4=await staff[_0x59c9d4(0x192)]({'email':_0x2e886f[_0x59c9d4(0x1ec)]});_0x380c5d=await purchases[_0x59c9d4(0x14b)]([{'$match':{'warehouse_name':_0x5a92a4[_0x59c9d4(0x11c)]}},{'$lookup':{'from':'suppliers','localField':_0x59c9d4(0x180),'foreignField':_0x59c9d4(0x11e),'as':_0x59c9d4(0x1ae)}},{'$unwind':'$suppliers_docs'},{'$unwind':'$product'},{'$group':{'_id':_0x59c9d4(0x204),'invoice':{'$first':_0x59c9d4(0x121)},'suppliers':{'$first':_0x59c9d4(0x1be)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x59c9d4(0xfa)},'room':{'$first':_0x59c9d4(0x1c8)},'product':{'$push':_0x59c9d4(0x10f)},'note':{'$first':_0x59c9d4(0x1ac)},'paid_amount':{'$first':_0x59c9d4(0x18a)},'due_amount':{'$first':'$due_amount'},'return_data':{'$first':_0x59c9d4(0x14c)},'batch_code':{'$first':_0x59c9d4(0x133)},'expiry_date':{'$first':_0x59c9d4(0x17a)},'suppliers_docs':{'$first':_0x59c9d4(0x1e3)},'total_product_quantity':{'$sum':_0x59c9d4(0x14f)},'level':{'$addToSet':_0x59c9d4(0x108)},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':_0x59c9d4(0x11a)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x380c5d=await purchases[_0x59c9d4(0x14b)]([{'$lookup':{'from':_0x59c9d4(0x180),'localField':'suppliers','foreignField':_0x59c9d4(0x11e),'as':_0x59c9d4(0x1ae)}},{'$unwind':_0x59c9d4(0x1e3)},{'$unwind':_0x59c9d4(0x10f)},{'$group':{'_id':_0x59c9d4(0x204),'invoice':{'$first':_0x59c9d4(0x121)},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0x59c9d4(0x1d8)},'warehouse_name':{'$first':_0x59c9d4(0xfa)},'room':{'$addToSet':_0x59c9d4(0x162)},'product':{'$push':_0x59c9d4(0x10f)},'note':{'$first':_0x59c9d4(0x1ac)},'paid_amount':{'$first':_0x59c9d4(0x18a)},'due_amount':{'$first':_0x59c9d4(0x10e)},'return_data':{'$first':_0x59c9d4(0x14c)},'batch_code':{'$first':'$batch_code'},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0x59c9d4(0x1e3)},'total_product_quantity':{'$sum':_0x59c9d4(0x14f)},'level':{'$addToSet':'$product.bay'},'isle':{'$addToSet':'$product.bin'},'type':{'$addToSet':_0x59c9d4(0x12c)},'floorlevel':{'$addToSet':_0x59c9d4(0x11a)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x508f73[0x0]['language']=='English\x20(US)'){var _0x2df1b0=users[_0x59c9d4(0x1e7)];console[_0x59c9d4(0x1e9)](_0x2df1b0);}else{if(_0x508f73[0x0][_0x59c9d4(0x14d)]==_0x59c9d4(0x122))var _0x2df1b0=users['Hindi'];else{if(_0x508f73[0x0][_0x59c9d4(0x14d)]==_0x59c9d4(0x135))var _0x2df1b0=users[_0x59c9d4(0x135)];else{if(_0x508f73[0x0][_0x59c9d4(0x14d)]==_0x59c9d4(0x1e8))var _0x2df1b0=users[_0x59c9d4(0x1e8)];else{if(_0x508f73[0x0]['language']=='French')var _0x2df1b0=users[_0x59c9d4(0x179)];else{if(_0x508f73[0x0]['language']==_0x59c9d4(0x100))var _0x2df1b0=users[_0x59c9d4(0x139)];else{if(_0x508f73[0x0][_0x59c9d4(0x14d)]==_0x59c9d4(0x131))var _0x2df1b0=users[_0x59c9d4(0x131)];else{if(_0x508f73[0x0][_0x59c9d4(0x14d)]==_0x59c9d4(0x1d7))var _0x2df1b0=users[_0x59c9d4(0x146)];}}}}}}}_0x55e3b8[_0x59c9d4(0x190)](_0x59c9d4(0x10d),{'success':_0x28281b['flash']('success'),'errors':_0x28281b['flash'](_0x59c9d4(0x1eb)),'purchases':_0x380c5d,'role':_0x2e886f,'profile':_0x1f0779,'master_shop':_0x508f73,'language':_0x2df1b0});}catch(_0x383f98){console[_0x59c9d4(0x1e9)](_0x59c9d4(0x1bb),_0x383f98),_0x55e3b8['status'](0xc8)[_0x59c9d4(0x15f)]({'message':_0x383f98['message']});}});function BayBinSelected(_0x13fe51,_0x53a695){var _0x3df48b=a0_0x6dba34,_0x2a4251=[],_0x15a25e=[],_0x3c8344=[],_0xdff1d8=[],_0x2d1f97=[],_0x4b55a8=[];let _0x5a8922=[];if(_0x13fe51==_0x3df48b(0x1ff))switch(_0x53a695){case'Rack\x20A':_0x2a4251=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x15a25e=[0x1,0x2],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=[_0x3df48b(0x1a4),_0x3df48b(0x118)],_0x2d1f97=['D'],_0x4b55a8=['A'];break;case _0x3df48b(0x1e4):_0x2a4251=[0x6,0x5,0x4,0x3,0x2,0x1],_0x15a25e=[0x1,0x2],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=[_0x3df48b(0x1a4),_0x3df48b(0x118)],_0x2d1f97=['D'],_0x4b55a8=['B'];break;case _0x3df48b(0x155):_0x2a4251=[0x0],_0x15a25e=[0x0],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=[_0x3df48b(0x118)],_0x2d1f97=['D'],_0x4b55a8=['S'];break;case'Receiving\x20Area':_0x2a4251=[0x0],_0x15a25e=[0x0],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x3c8344=[_0x3df48b(0x118)],_0x2d1f97=['D'],_0x4b55a8=['R'];break;}else{if(_0x13fe51==_0x3df48b(0x1b9))switch(_0x53a695){case _0x3df48b(0x182):_0x2a4251=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x15a25e=['B','F'],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=[_0x3df48b(0x1a4),_0x3df48b(0x118)],_0x2d1f97=['C'],_0x4b55a8=['A'];break;case _0x3df48b(0x1e4):_0x2a4251=[0x5,0x4,0x3,0x2,0x1],_0x15a25e=['F','B','S'],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=[_0x3df48b(0x1a4),_0x3df48b(0x118)],_0x2d1f97=['C'],_0x4b55a8=['B'];break;case'Rack\x20C':_0x2a4251=[0x1,0x2,0x3,0x4,0x5],_0x15a25e=['B','F','S'],_0xdff1d8=[0x5,0x4,0x3,0x2,0x1],_0x3c8344=[_0x3df48b(0x1a4),_0x3df48b(0x118)],_0x2d1f97=['C'],_0x4b55a8=['C'];break;case _0x3df48b(0x207):_0x2a4251=[0x5,0x4,0x3,0x2,0x1],_0x15a25e=['F','B','S'],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=['Level',_0x3df48b(0x118)],_0x2d1f97=['C'],_0x4b55a8=['D'];break;case _0x3df48b(0x1ab):_0x2a4251=[0x4,0x3,0x2,0x1],_0x15a25e=[0x1,0x2],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=[_0x3df48b(0x1a4),_0x3df48b(0x118)],_0x2d1f97=['C'],_0x4b55a8=['E'];break;case _0x3df48b(0x115):_0x2a4251=[0x1,0x2,0x3],_0x15a25e=[0x1,0x2],_0xdff1d8=[0x1,0x2,0x3,0x4,0x5],_0x3c8344=['Level'],_0x2d1f97=['C'],_0x4b55a8=['F'];break;}}return{'levels':_0x2a4251,'Isle':_0x15a25e,'rack':_0xdff1d8,'type':_0x3c8344,'storage':_0x2d1f97,'rak':_0x4b55a8};}function a0_0x2887(){var _0xdd5b04=['82150AQcwft','back','product_name','$product_details.product_code','$warehouse_name','/upload/','prod_code','status','$product_details.primary_code','product_code','Portuguese\x20(BR)','$maxProdPerUnit','/invoice/:id','\x20Order\x20Number\x20:\x20','/view/return_purchase/:id','<h2>\x20','filter','$product_details.floorlevel','$product.bay','3FpYLDK','createTransport','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','deliverycode','all_purchases','$due_amount','$product','/view/:id','bin','</head><body>','secondary_code_hide','image','Rack\x20F','<strong>\x20Regards\x20</strong>','quantity','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product.floorlevel','then','warehouse','prod_pallet','name','pallet','primary_code_hide','$invoice','Hindi','prod_qty','1298JpVxnq','MaxStocks_data','stocks','express','$product_details.pallet','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','95025AOiVzE','body','$product.type','storage','../models/all_models','Purchase\x20Return\x20Mail','add_purchases','Chinese','user_id','$batch_code','payment\x20successfull','German','floor','types','/view/add_purchases/:id','Portuguese','/barcode/:id','user','product','9790BkHwgu','/give_payment/:id','RoomAssign','forEach','There\x27s\x20a\x20error\x20in\x20this\x20transaction','date','add_purchases\x20error','amount','$unit','Arabic','$product_details','invoice','prod_unit','return_purchase','aggregate','$return_data','language','primary_code','$product.quantity','purchase\x20data\x20update\x20successfully','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','sendMail','isle','Shelves','warehouse_name','</body></html>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Purchase\x20data\x20added\x20successfully','delivery_date','getDate','<tr>','params','Error\x20Occurs','json','redirect','\x20Order\x20Date\x20:\x20','$product.room_name','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$alertquantity','getMonth','</h5>','True','batch_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/all_purchases/view/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','delivery_code','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<h5>','concat','rak','Raw\x20Materials','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','$product_code','$product_details._id','RMSEmail','$product_details.bay','French','$expiry_date','maxStocks','standard_unit','</span>','return_product','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','suppliers','$product_details.level','Rack\x20A','length','bay','purchase_quantity','catch','floorlevel','map','expiry_date','$paid_amount','success','getFullYear','secondary_unit','save','note','render','</tbody>','findOne','3240887apRjNQ','prod_secondunit','$product_details.expiry_date','message','ejs','all','51KKqhFT','return_qty','findById','logo','staff','prod_name','toString','due_amount','/../public','path','</table>','Level','prod_level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','INC-','../middleware/auth','Ambient','1228944dxGUVb','Rack\x20E','$note','<div>','suppliers_docs','168DoaItQ','prod_invoice','/view/add_purchases','return_data','</td>','paid_amount','suppliers_data','room','password','get','COLD\x20STORAGE','find','table\x20page','foreach\x20newproduct','secondary_code','$suppliers','An\x20error\x20occurred.','room_name','$product_details.product_stock','$product_details.storage','prod_isle','Email\x20sent\x20successfully','production_date','\x20<\x20wew\x20>\x20','Router','$room','stock_quantity','</div>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','prod_cat','role','Enabled','flash','post','product_stock','<hr\x20class=\x22my-3\x22>','/all_purchases/view','max_product_unit','Arabic\x20(ae)','$date','9IzShtT','<span\x20style=\x22float:\x20right;\x22>','level','slice','$secondary_code','English\x20(US)','Return\x20Goods','24MKDWEn','prod_Qty','gmail','$suppliers_docs','Rack\x20B','push','add\x20post','English','Spanish','log','Logo.png','errors','email','alertQTY','\x20<>\x20','maxperunit','/CheckingWarehouse','string','nodemailer','port','error','\x20</h2>','/preview/:id','Purchase\x20Mail','$product_details.secondary_code','random','</thead>','$product_details.product_name','$brand','padStart','master','DRY\x20STORAGE','<html><head><title></title>','product_cat','product_details','JO_number','$_id','/barcode_scanner','1154095jKweBx','Rack\x20D','<tbody\x20style=\x22text-align:\x20center;\x22>','Paid\x20For\x20Purchase','prod_primunit','product_list','actual_qty','type','POnumber','edit_purchases_view','$secondary_unit','</tr>','$maxStocks','currency','8068856SHbDcR','$primary_code','site_title','purchase_invoice'];a0_0x2887=function(){return _0xdd5b04;};return a0_0x2887();}async function getRandom8DigitNumber(){var _0x218f8f=a0_0x6dba34;const _0x346671=0x989680,_0x4233e5=0x5f5e0ff,_0x2f6451=Math[_0x218f8f(0x136)](Math[_0x218f8f(0x1f9)]()*(_0x4233e5-_0x346671+0x1))+_0x346671;var _0x597642;const _0x2f266c=await purchases[_0x218f8f(0x192)]({'invoice':'INC-'+_0x2f6451});return _0x2f266c&&_0x2f266c[_0x218f8f(0x183)]>0x0?_0x597642='INC-'+_0x2f6451:_0x597642=_0x218f8f(0x1a7)+_0x2f6451,_0x597642;}router[a0_0x6dba34(0x1b8)](a0_0x6dba34(0x1b1),auth,async(_0x2240cf,_0xf23974)=>{var _0x1047e1=a0_0x6dba34;try{const {username:_0x5ca8c2,email:_0x21f862,role:_0x149710}=_0x2240cf[_0x1047e1(0x13b)],_0x5cb13e=_0x2240cf['user'],_0x97c32e=await profile[_0x1047e1(0x192)]({'email':_0x5cb13e[_0x1047e1(0x1ec)]}),_0x446d9b=await master_shop['find'](),_0x29e38e=await staff[_0x1047e1(0x192)]({'email':_0x5cb13e[_0x1047e1(0x1ec)]}),_0x5a8bcb=await suppliers[_0x1047e1(0x1ba)]({});let _0x4a3ffd;if(_0x5cb13e[_0x1047e1(0x1cf)]==_0x1047e1(0x19d)){const _0x29d777=await staff[_0x1047e1(0x192)]({'email':_0x5cb13e[_0x1047e1(0x1ec)]});_0x4a3ffd=await warehouse[_0x1047e1(0x14b)]([{'$match':{'status':'Enabled','name':_0x29d777[_0x1047e1(0x11c)],'warehouse_category':_0x1047e1(0x173),'name':{'$ne':_0x1047e1(0x1df)}}},{'$group':{'_id':'$name','name':{'$first':_0x1047e1(0x163)}}}]);}else _0x4a3ffd=await warehouse[_0x1047e1(0x14b)]([{'$match':{'status':_0x1047e1(0x1d0),'warehouse_category':_0x1047e1(0x173),'name':{'$ne':_0x1047e1(0x1df)}}},{'$group':{'_id':_0x1047e1(0x163),'name':{'$first':_0x1047e1(0x163)}}}]);const _0x1f334c=await product[_0x1047e1(0x1ba)]({}),_0x1ecf90=await warehouse[_0x1047e1(0x1ba)]({'status':_0x1047e1(0x1d0)}),_0x392115=await purchases[_0x1047e1(0x1ba)]({}),_0x593774=_0x392115[_0x1047e1(0x183)]+0x1,_0x55746b=_0x1047e1(0x1a7)+_0x593774[_0x1047e1(0x19f)]()[_0x1047e1(0x1fd)](0x5,'0');var _0x3f0953=[_0x1047e1(0x1a9),'Enclosed'];if(_0x446d9b[0x0][_0x1047e1(0x14d)]==_0x1047e1(0x1de))var _0x1e59b4=users[_0x1047e1(0x1e7)];else{if(_0x446d9b[0x0][_0x1047e1(0x14d)]==_0x1047e1(0x122))var _0x1e59b4=users[_0x1047e1(0x122)];else{if(_0x446d9b[0x0][_0x1047e1(0x14d)]=='German')var _0x1e59b4=users[_0x1047e1(0x135)];else{if(_0x446d9b[0x0]['language']==_0x1047e1(0x1e8))var _0x1e59b4=users[_0x1047e1(0x1e8)];else{if(_0x446d9b[0x0][_0x1047e1(0x14d)]==_0x1047e1(0x179))var _0x1e59b4=users['French'];else{if(_0x446d9b[0x0][_0x1047e1(0x14d)]==_0x1047e1(0x100))var _0x1e59b4=users[_0x1047e1(0x139)];else{if(_0x446d9b[0x0][_0x1047e1(0x14d)]==_0x1047e1(0x131))var _0x1e59b4=users[_0x1047e1(0x131)];else{if(_0x446d9b[0x0]['language']==_0x1047e1(0x1d7))var _0x1e59b4=users[_0x1047e1(0x146)];}}}}}}}const _0x473ae6=getRandom8DigitNumber();_0x473ae6[_0x1047e1(0x11b)](_0x28a460=>{var _0x212a37=_0x1047e1;_0xf23974['render'](_0x212a37(0x130),{'success':_0x2240cf[_0x212a37(0x1d1)](_0x212a37(0x18b)),'errors':_0x2240cf['flash'](_0x212a37(0x1eb)),'role':_0x5cb13e,'profile':_0x97c32e,'suppliers':_0x5a8bcb,'warehouse':_0x4a3ffd,'product':_0x1f334c,'invoice':_0x28a460,'master_shop':_0x446d9b,'language':_0x1e59b4,'find_data':_0x1ecf90,'rooms_data':_0x3f0953});})['catch'](_0x405103=>{var _0x15e1c3=_0x1047e1;_0x2240cf[_0x15e1c3(0x1d1)](_0x15e1c3(0x1eb),_0x15e1c3(0x141)),_0xf23974[_0x15e1c3(0x160)]('/all_purchases/view');});}catch(_0x589707){console[_0x1047e1(0x1e9)](_0x589707);}}),router[a0_0x6dba34(0x1b8)](a0_0x6dba34(0x138),auth,async(_0x1cf397,_0x293fc1)=>{var _0x50a129=a0_0x6dba34;try{const _0x281409=_0x1cf397['params']['id'];console[_0x50a129(0x1e9)](_0x281409);const _0x40ad0b=await master_shop[_0x50a129(0x1ba)]();console[_0x50a129(0x1e9)](_0x50a129(0x1fe),_0x40ad0b);const _0x5602b6=await product[_0x50a129(0x192)]({'name':_0x281409});console[_0x50a129(0x1e9)](_0x50a129(0x13c),_0x5602b6),_0x293fc1[_0x50a129(0xfd)](0xc8)['json']({'product_data':_0x5602b6,'master':_0x40ad0b});}catch(_0x1df69f){console['log'](_0x50a129(0x143),_0x1df69f);}}),router[a0_0x6dba34(0x1d2)](a0_0x6dba34(0x1b1),auth,async(_0x5ec62c,_0xfd8d9a)=>{var _0x505798=a0_0x6dba34;try{const {invoice:_0x29e864,date:_0x1c889a,warehouse_name:_0x25e348,prod_name:_0x516c5c,prod_code:_0x29486d,prod_qty:_0x7c4a1a,prod_unit:_0x21b119,prod_secondunit:_0x45b806,prod_level:_0x197efe,prod_isle:_0x40c483,prod_pallet:_0x266b15,note:_0x40cd7c,expiry_date:_0x51f59d,batch_code:_0x3f7cf4,payable:_0x102c9e,due_amount:_0x26b30d,Room_name:_0xa003e0,primary_code:_0x343c5e,secondary_code:_0x5d2f12,MaxStocks_data:_0x5e4486,PO_number:_0xc63dcd,SCRN:_0x48f4ce,JO_number:_0x209a02}=_0x5ec62c[_0x505798(0x12b)];if(typeof _0x516c5c=='string')var _0xf118f8=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x19e)]],_0x7da49b=[_0x5ec62c[_0x505798(0x12b)]['prod_code']],_0x3df030=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x1e1)]],_0xbe9c72=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x20a)]],_0x2e6a8a=[_0x5ec62c['body']['prod_secondunit']],_0x5f0461=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x1a5)]],_0x35d226=[_0x5ec62c[_0x505798(0x12b)]['primary_code']],_0x31bf7a=[_0x5ec62c['body']['secondary_code']],_0x2ece5b=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x125)]],_0x13e855=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x169)]],_0x181aa4=[_0x5ec62c[_0x505798(0x12b)]['expiry_date']],_0x4ba2f2=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x1d6)]],_0x3bd819=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x1ed)]],_0x52bf55=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x1c5)]],_0x564a87=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x1ce)]],_0x35e473=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x13f)]],_0x2f5a3d=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x10c)]],_0x9d1a8d=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x1b0)]],_0x102bd0=[_0x5ec62c[_0x505798(0x12b)][_0x505798(0x20c)]];else var _0xf118f8=[..._0x5ec62c[_0x505798(0x12b)]['prod_name']],_0x7da49b=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0xfc)]],_0x3df030=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x1e1)]],_0xbe9c72=[..._0x5ec62c[_0x505798(0x12b)]['prod_primunit']],_0x2e6a8a=[..._0x5ec62c['body'][_0x505798(0x194)]],_0x5f0461=[..._0x5ec62c[_0x505798(0x12b)]['prod_level']],_0x35d226=[..._0x5ec62c['body']['primary_code']],_0x31bf7a=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x1bd)]],_0x2ece5b=[..._0x5ec62c['body']['MaxStocks_data']],_0x13e855=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x169)]],_0x181aa4=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x189)]],_0x4ba2f2=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x1d6)]],_0x3bd819=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x1ed)]],_0x52bf55=[..._0x5ec62c[_0x505798(0x12b)]['production_date']],_0x564a87=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x1ce)]],_0x35e473=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x13f)]],_0x2f5a3d=[..._0x5ec62c['body'][_0x505798(0x10c)]],_0x9d1a8d=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x1b0)]],_0x102bd0=[..._0x5ec62c[_0x505798(0x12b)][_0x505798(0x20c)]];const _0x2e5786=_0xf118f8[_0x505798(0x188)](_0x210c9e=>{return _0x210c9e={'product_name':_0x210c9e};});_0x102bd0[_0x505798(0x140)]((_0x586ce1,_0x404fb5)=>{var _0x3afb30=_0x505798;_0x2e5786[_0x404fb5][_0x3afb30(0x20c)]=_0x586ce1;}),_0x7da49b[_0x505798(0x140)]((_0x515858,_0x467828)=>{var _0x4b49ef=_0x505798;_0x2e5786[_0x467828][_0x4b49ef(0xff)]=_0x515858;}),_0x3df030['forEach']((_0x41f96c,_0x225125)=>{var _0x3dc664=_0x505798;_0x2e5786[_0x225125][_0x3dc664(0x117)]=_0x41f96c;}),_0xbe9c72[_0x505798(0x140)]((_0x52dfa7,_0x59a0ca)=>{_0x2e5786[_0x59a0ca]['standard_unit']=_0x52dfa7;}),_0x2e6a8a['forEach']((_0x1d9f8d,_0x1c4aaf)=>{_0x2e5786[_0x1c4aaf]['secondary_unit']=_0x1d9f8d;}),_0x5f0461['forEach']((_0x121295,_0x3eeedc)=>{var _0x3a686c=_0x505798;_0x35e473[_0x3a686c(0x140)]((_0x228ea4,_0x3e4bd3)=>{var _0x75ad6d=_0x3a686c;if(_0x228ea4=='Receiving\x20Area'&&_0x3eeedc==_0x3e4bd3){console[_0x75ad6d(0x1e9)](_0x228ea4+_0x75ad6d(0x1c6)+_0x3eeedc+'\x20<>\x20'+_0x3e4bd3+'\x20<>\x20'+_0x121295);var _0x3fdf8c=_0x121295[_0x75ad6d(0x1dc)](0x3);_0x2e5786[_0x3eeedc][_0x75ad6d(0x12d)]=_0x121295[0x0],_0x2e5786[_0x3eeedc]['rack']=_0x121295[0x1],_0x2e5786[_0x3eeedc][_0x75ad6d(0x184)]=0x0,_0x2e5786[_0x3eeedc][_0x75ad6d(0x111)]=0x0,_0x2e5786[_0x3eeedc][_0x75ad6d(0x20d)]='Floor',_0x2e5786[_0x3eeedc][_0x75ad6d(0x187)]=_0x3fdf8c;}else{if(_0x228ea4=='Shelves'&&_0x3eeedc==_0x3e4bd3){var _0x3fdf8c=_0x121295[_0x75ad6d(0x1dc)](0x3);_0x2e5786[_0x3eeedc][_0x75ad6d(0x12d)]=_0x121295[0x0],_0x2e5786[_0x3eeedc][_0x75ad6d(0x151)]=_0x121295[0x1],_0x2e5786[_0x3eeedc]['bay']=0x0,_0x2e5786[_0x3eeedc][_0x75ad6d(0x111)]=0x0,_0x2e5786[_0x3eeedc][_0x75ad6d(0x20d)]=_0x75ad6d(0x118),_0x2e5786[_0x3eeedc][_0x75ad6d(0x187)]=_0x121295[0x5];}else{if(_0x3eeedc==_0x3e4bd3){var _0x5f200e;if(_0x121295[0x4]=='L')_0x5f200e=_0x75ad6d(0x1a4);else _0x121295[0x4]=='F'&&(_0x5f200e=_0x75ad6d(0x118));_0x2e5786[_0x3eeedc]['storage']=_0x121295[0x0],_0x2e5786[_0x3eeedc][_0x75ad6d(0x151)]=_0x121295[0x1],_0x2e5786[_0x3eeedc][_0x75ad6d(0x184)]=_0x121295[0x2],_0x2e5786[_0x3eeedc][_0x75ad6d(0x111)]=_0x121295[0x3],_0x2e5786[_0x3eeedc][_0x75ad6d(0x20d)]=_0x5f200e,_0x2e5786[_0x3eeedc][_0x75ad6d(0x187)]=_0x121295[0x5];}}}});}),_0x35d226[_0x505798(0x140)]((_0x203dac,_0x4ff570)=>{var _0x1f971b=_0x505798;_0x2e5786[_0x4ff570][_0x1f971b(0x14e)]=_0x203dac;}),_0x31bf7a['forEach']((_0x421c63,_0x4d14bb)=>{var _0x9413ef=_0x505798;_0x2e5786[_0x4d14bb][_0x9413ef(0x1bd)]=_0x421c63;}),_0x2ece5b['forEach']((_0x3a9069,_0x2ca817)=>{var _0x1d3ec9=_0x505798;_0x2e5786[_0x2ca817][_0x1d3ec9(0x17b)]=_0x3a9069;}),_0x13e855[_0x505798(0x140)]((_0x29135d,_0x47f0d1)=>{_0x2e5786[_0x47f0d1]['batch_code']=_0x29135d;}),_0x181aa4[_0x505798(0x140)]((_0x4330ad,_0x261c35)=>{_0x2e5786[_0x261c35]['expiry_date']=_0x4330ad;}),_0x4ba2f2[_0x505798(0x140)]((_0xb82888,_0x558105)=>{var _0x65132c=_0x505798;_0x2e5786[_0x558105][_0x65132c(0x1ef)]=_0xb82888;}),_0x3bd819[_0x505798(0x140)]((_0x7e43bf,_0x36ec49)=>{var _0x154ad9=_0x505798;_0x2e5786[_0x36ec49][_0x154ad9(0x1ed)]=_0x7e43bf;}),_0x52bf55[_0x505798(0x140)]((_0x11e31e,_0x1d20c9)=>{var _0x4ebea3=_0x505798;_0x2e5786[_0x1d20c9][_0x4ebea3(0x1c5)]=_0x11e31e;}),_0x564a87['forEach']((_0x1534ff,_0x55e91a)=>{var _0x419d91=_0x505798;_0x2e5786[_0x55e91a][_0x419d91(0x201)]=_0x1534ff;}),_0x35e473[_0x505798(0x140)]((_0x390803,_0x4ff432)=>{_0x2e5786[_0x4ff432]['room_name']=_0x390803;}),_0x2f5a3d[_0x505798(0x140)]((_0x37052c,_0x487667)=>{_0x2e5786[_0x487667]['delivery_code']=_0x37052c;}),_0x9d1a8d[_0x505798(0x140)]((_0x435440,_0x349e3f)=>{var _0x5982a8=_0x505798;_0x2e5786[_0x349e3f][_0x5982a8(0x148)]=_0x435440;});const _0x2d7f24=_0x35e473[_0x505798(0x188)](_0x34c518=>{return _0x34c518={'room_name':_0x34c518};}),_0x570967=_0x2e5786[_0x505798(0x106)](_0x26aa46=>_0x26aa46[_0x505798(0x117)]!=='0'&&_0x26aa46['quantity']!==''),_0x42f2d5=new purchases({'invoice':_0x29e864,'suppliers':_0x5ec62c[_0x505798(0x12b)][_0x505798(0x180)],'date':_0x1c889a,'warehouse_name':_0x25e348,'product':_0x570967,'note':_0x40cd7c,'due_amount':_0x26b30d,'POnumber':_0xc63dcd,'SCRN':_0x48f4ce,'JO_number':_0x209a02,'roomList':_0x2d7f24}),_0x5bebf5=await _0x42f2d5['save'](),_0x2cd91f=await purchases['findOne']({'invoice':_0x29e864}),_0x384bfb=_0x2cd91f[_0x505798(0x13c)][_0x505798(0x188)](async _0x5e0e5b=>{var _0x1ec17f=_0x505798,_0x5e2e2b=await warehouse[_0x1ec17f(0x192)]({'name':_0x25e348,'room':_0x5e0e5b[_0x1ec17f(0x1c0)]}),_0x1b3353=0x0;return _0x5e2e2b[_0x1ec17f(0x202)][_0x1ec17f(0x140)](_0x429594=>{var _0x4fe70f=_0x1ec17f;_0x429594[_0x4fe70f(0x21a)]==_0x5e0e5b[_0x4fe70f(0x21a)]&&_0x429594[_0x4fe70f(0x187)]==_0x5e0e5b['floorlevel']&&_0x429594[_0x4fe70f(0x20d)]==_0x5e0e5b['type']&&_0x429594[_0x4fe70f(0x111)]==_0x5e0e5b['bin']&&_0x429594[_0x4fe70f(0x184)]==_0x5e0e5b['bay']&&_0x429594['rack']==_0x5e0e5b[_0x4fe70f(0x151)]&&_0x429594[_0x4fe70f(0x12d)]==_0x5e0e5b[_0x4fe70f(0x12d)]&&_0x429594['expiry_date']==_0x5e0e5b[_0x4fe70f(0x189)]&&_0x429594[_0x4fe70f(0x169)]==_0x5e0e5b[_0x4fe70f(0x169)]&&_0x429594[_0x4fe70f(0x1c5)]==_0x5e0e5b[_0x4fe70f(0x1c5)]&&_0x429594[_0x4fe70f(0x148)]==_0x2cd91f[_0x4fe70f(0x148)]&&(_0x429594['product_stock']+=_0x5e0e5b['quantity'],_0x1b3353++);}),_0x1b3353===0x0&&_0x5e2e2b[_0x1ec17f(0x202)][_0x1ec17f(0x1e5)]({'product_name':_0x5e0e5b[_0x1ec17f(0x21a)],'product_stock':_0x5e0e5b[_0x1ec17f(0x117)],'primary_code':_0x5e0e5b[_0x1ec17f(0x14e)],'secondary_code':_0x5e0e5b[_0x1ec17f(0x1bd)],'product_code':_0x5e0e5b[_0x1ec17f(0xff)],'storage':_0x5e0e5b['storage'],'rack':_0x5e0e5b['rack'],'bay':_0x5e0e5b[_0x1ec17f(0x184)],'bin':_0x5e0e5b[_0x1ec17f(0x111)],'type':_0x5e0e5b[_0x1ec17f(0x20d)],'floorlevel':_0x5e0e5b[_0x1ec17f(0x187)],'maxProducts':_0x5e0e5b[_0x1ec17f(0x17b)],'unit':_0x5e0e5b['standard_unit'],'secondary_unit':_0x5e0e5b[_0x1ec17f(0x18d)],'expiry_date':_0x5e0e5b[_0x1ec17f(0x189)],'maxPerUnit':_0x5e0e5b[_0x1ec17f(0x1ef)],'batch_code':_0x5e0e5b[_0x1ec17f(0x169)],'alertQTY':_0x5e0e5b[_0x1ec17f(0x1ed)],'production_date':_0x5e0e5b[_0x1ec17f(0x1c5)],'product_cat':_0x5e0e5b[_0x1ec17f(0x201)],'invoice':_0x5e0e5b['invoice'],'actual_qty':_0x5e0e5b[_0x1ec17f(0x20c)]}),_0x5e2e2b;});Promise[_0x505798(0x198)](_0x384bfb)[_0x505798(0x11b)](async _0x7b3379=>{var _0x41a8c1=_0x505798;try{for(const _0x16b70d of _0x7b3379){await _0x16b70d[_0x41a8c1(0x18e)]();}const _0x51a15c=await master_shop[_0x41a8c1(0x1ba)](),_0x1dc547=await email_settings[_0x41a8c1(0x192)](),_0x25c187=await supervisor_settings[_0x41a8c1(0x1ba)]();var _0x4df2fa=_0x2cd91f[_0x41a8c1(0x13c)],_0x1f92cf='',_0x3397c5;for(_0x3397c5 in _0x4df2fa){_0x1f92cf+=_0x41a8c1(0x15c)+_0x41a8c1(0x1cb)+_0x4df2fa[_0x3397c5][_0x41a8c1(0x21a)]+'</td>'+_0x41a8c1(0x1cb)+_0x4df2fa[_0x3397c5]['product_code']+'</td>'+_0x41a8c1(0x1cb)+_0x4df2fa[_0x3397c5][_0x41a8c1(0x117)]+_0x41a8c1(0x1b3)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4df2fa[_0x3397c5][_0x41a8c1(0x17c)]+_0x41a8c1(0x1b3)+_0x41a8c1(0x1cb)+_0x4df2fa[_0x3397c5][_0x41a8c1(0x18d)]+'</td>'+_0x41a8c1(0x1cb)+_0x2cd91f[_0x41a8c1(0x156)]+_0x41a8c1(0x1b3)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4df2fa[_0x3397c5][_0x41a8c1(0x1c0)]+'</td>'+_0x41a8c1(0x1cb)+_0x4df2fa[_0x3397c5][_0x41a8c1(0x12d)]+_0x4df2fa[_0x3397c5]['rack']+_0x4df2fa[_0x3397c5]['bay']+_0x4df2fa[_0x3397c5][_0x41a8c1(0x111)]+_0x4df2fa[_0x3397c5][_0x41a8c1(0x20d)][0x0]+_0x4df2fa[_0x3397c5][_0x41a8c1(0x187)]+_0x41a8c1(0x1b3),_0x41a8c1(0x211);}let _0x1d1c93=nodemailer[_0x41a8c1(0x10a)]({'host':_0x1dc547['host'],'port':Number(_0x1dc547[_0x41a8c1(0x1f3)]),'secure':![],'auth':{'user':_0x1dc547['email'],'pass':_0x1dc547['password']}}),_0xe8b698={'from':_0x1dc547[_0x41a8c1(0x1ec)],'to':_0x25c187[0x0][_0x41a8c1(0x177)],'subject':_0x41a8c1(0x1f7),'attachments':[{'filename':_0x41a8c1(0x1ea),'path':__dirname+_0x41a8c1(0x1a1)+_0x41a8c1(0xfb)+_0x51a15c[0x0][_0x41a8c1(0x114)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x41a8c1(0x200)+_0x41a8c1(0x112)+_0x41a8c1(0x1ad)+_0x41a8c1(0x1cd)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x41a8c1(0x1ad)+'<h2>\x20'+_0x51a15c[0x0][_0x41a8c1(0x216)]+_0x41a8c1(0x1f5)+_0x41a8c1(0x1ca)+_0x41a8c1(0x1ca)+_0x41a8c1(0x1d4)+_0x41a8c1(0x1ad)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x2cd91f['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x41a8c1(0x161)+_0x2cd91f[_0x41a8c1(0x142)]+'\x20'+_0x41a8c1(0x17d)+'</h5>'+_0x41a8c1(0x1ca)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x41a8c1(0x10b)+_0x41a8c1(0x15c)+_0x41a8c1(0x16f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x41a8c1(0x152)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x41a8c1(0x1a6)+_0x41a8c1(0x164)+_0x41a8c1(0x129)+_0x41a8c1(0x119)+_0x41a8c1(0x211)+_0x41a8c1(0x1fa)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1f92cf+'\x20'+_0x41a8c1(0x191)+_0x41a8c1(0x1a3)+_0x41a8c1(0x1ad)+_0x41a8c1(0x116)+'<h5>'+_0x51a15c[0x0][_0x41a8c1(0x216)]+_0x41a8c1(0x167)+_0x41a8c1(0x1ca)+_0x41a8c1(0x1ca)+'</body></html>'};_0x1d1c93[_0x41a8c1(0x153)](_0xe8b698,function(_0x35d26f,_0x2d0446){var _0x27a981=_0x41a8c1;_0x35d26f?(console[_0x27a981(0x1e9)](_0x35d26f),console[_0x27a981(0x1e9)]('Error\x20Occurs')):console[_0x27a981(0x1e9)](_0x27a981(0x1c4));}),_0x5ec62c[_0x41a8c1(0x1d1)]('success',_0x41a8c1(0x159)),_0xfd8d9a['redirect'](_0x41a8c1(0x16b));}catch(_0x37451d){console[_0x41a8c1(0x1f4)](_0x37451d),_0xfd8d9a[_0x41a8c1(0xfd)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x505798(0x186)](_0x5e3c90=>{var _0x14cde2=_0x505798;console['error'](_0x5e3c90),_0xfd8d9a[_0x14cde2(0xfd)](0x1f4)['json']({'error':_0x14cde2(0x1bf)});});}catch(_0x6f476){console[_0x505798(0x1e9)](_0x6f476);}}),router[a0_0x6dba34(0x1b8)](a0_0x6dba34(0x1f6),auth,async(_0x474e1c,_0x1b8f47)=>{var _0x38c1ad=a0_0x6dba34;try{const {username:_0x1c6320,email:_0x4f4aaf,role:_0x3337fc}=_0x474e1c[_0x38c1ad(0x13b)],_0x1e566b=_0x474e1c[_0x38c1ad(0x13b)],_0x18455c=await profile[_0x38c1ad(0x192)]({'email':_0x1e566b[_0x38c1ad(0x1ec)]}),_0xa36572=await master_shop[_0x38c1ad(0x1ba)](),_0xdcea21=_0x474e1c[_0x38c1ad(0x15d)]['id'],_0x3f3c25=await purchases['findById'](_0xdcea21),_0x254283=await warehouse[_0x38c1ad(0x14b)]([{'$match':{'name':_0x3f3c25[_0x38c1ad(0x156)],'room':_0x3f3c25[_0x38c1ad(0x1b6)]}},{'$unwind':_0x38c1ad(0x147)},{'$group':{'_id':_0x38c1ad(0x176),'name':{'$first':_0x38c1ad(0x1fb)},'product_stock':{'$first':_0x38c1ad(0x1c1)},'bay':{'$first':_0x38c1ad(0x178)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x38c1ad(0x16e)},'floorlevel':{'$first':_0x38c1ad(0x107)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x38c1ad(0xf9)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x38c1ad(0x195)}}}]),_0x4766cd=await customer['find']({});let _0x511ab6;if(_0x1e566b[_0x38c1ad(0x1cf)]==_0x38c1ad(0x19d)){const _0x456b52=await staff['findOne']({'email':_0x1e566b['email']});_0x511ab6=await warehouse[_0x38c1ad(0x14b)]([{'$match':{'status':_0x38c1ad(0x1d0),'name':_0x456b52['warehouse']}},{'$group':{'_id':_0x38c1ad(0x163),'name':{'$first':'$name'}}}]);}else _0x511ab6=await warehouse[_0x38c1ad(0x14b)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x38c1ad(0x163),'name':{'$first':_0x38c1ad(0x163)}}}]);const _0x32278a=await product['find']({}),_0x1650c4=await suppliers[_0x38c1ad(0x1ba)]({}),_0x4bd671=BayBinSelected(_0x3f3c25[_0x38c1ad(0x156)],_0x3f3c25[_0x38c1ad(0x1b6)]);if(_0xa36572[0x0][_0x38c1ad(0x14d)]==_0x38c1ad(0x1de)){var _0x29bbc1=users[_0x38c1ad(0x1e7)];console['log'](_0x29bbc1);}else{if(_0xa36572[0x0]['language']==_0x38c1ad(0x122))var _0x29bbc1=users[_0x38c1ad(0x122)];else{if(_0xa36572[0x0]['language']==_0x38c1ad(0x135))var _0x29bbc1=users['German'];else{if(_0xa36572[0x0][_0x38c1ad(0x14d)]==_0x38c1ad(0x1e8))var _0x29bbc1=users[_0x38c1ad(0x1e8)];else{if(_0xa36572[0x0][_0x38c1ad(0x14d)]==_0x38c1ad(0x179))var _0x29bbc1=users['French'];else{if(_0xa36572[0x0]['language']==_0x38c1ad(0x100))var _0x29bbc1=users[_0x38c1ad(0x139)];else{if(_0xa36572[0x0][_0x38c1ad(0x14d)]==_0x38c1ad(0x131))var _0x29bbc1=users[_0x38c1ad(0x131)];else{if(_0xa36572[0x0][_0x38c1ad(0x14d)]==_0x38c1ad(0x1d7))var _0x29bbc1=users[_0x38c1ad(0x146)];}}}}}}}_0x1b8f47[_0x38c1ad(0x190)](_0x38c1ad(0x20f),{'success':_0x474e1c['flash']('success'),'errors':_0x474e1c[_0x38c1ad(0x1d1)](_0x38c1ad(0x1eb)),'role':_0x1e566b,'profile':_0x18455c,'customer':_0x4766cd,'warehouse':_0x511ab6,'product':_0x254283,'user':_0x3f3c25,'master_shop':_0xa36572,'unit':_0x32278a,'language':_0x29bbc1,'suppliers':_0x1650c4,'dataSelected':_0x4bd671});}catch(_0x884ddf){console['log'](_0x884ddf);}}),router[a0_0x6dba34(0x1d2)](a0_0x6dba34(0x1f6),auth,async(_0x2ffb4b,_0x2fa402)=>{var _0xda05c5=a0_0x6dba34;try{const _0x44c38e=_0x2ffb4b[_0xda05c5(0x15d)]['id'],{invoice:_0x5a766a,warehouse_name:_0x375779,Room_name:_0x1a1cfb}=_0x2ffb4b[_0xda05c5(0x12b)],_0x3bfd88=await warehouse[_0xda05c5(0x192)]({'name':_0x375779,'room':_0x1a1cfb}),_0x27dfcd=await purchases[_0xda05c5(0x192)]({'invoice':_0x5a766a});_0x27dfcd[_0xda05c5(0x13c)][_0xda05c5(0x140)](_0x39c6e2=>{var _0xea8cb1=_0xda05c5,_0x14e318=0x0;const _0x5293a0=_0x3bfd88[_0xea8cb1(0x202)][_0xea8cb1(0x188)](_0x27039e=>{var _0x2bac13=_0xea8cb1;_0x27039e[_0x2bac13(0x21a)]==_0x39c6e2['product_name']&&_0x27039e[_0x2bac13(0x187)]==_0x39c6e2[_0x2bac13(0x187)]&&_0x27039e[_0x2bac13(0x20d)]==_0x39c6e2['type']&&_0x27039e[_0x2bac13(0x111)]==_0x39c6e2[_0x2bac13(0x111)]&&_0x27039e['bay']==_0x39c6e2[_0x2bac13(0x184)]&&_0x27039e[_0x2bac13(0x151)]==_0x39c6e2[_0x2bac13(0x151)]&&_0x27039e[_0x2bac13(0x12d)]==_0x39c6e2[_0x2bac13(0x12d)]&&_0x27039e[_0x2bac13(0x189)]==_0x39c6e2[_0x2bac13(0x189)]&&_0x27039e['batch_code']==_0x39c6e2['batch_code']&&_0x27039e[_0x2bac13(0x1c5)]==_0x39c6e2[_0x2bac13(0x1c5)]&&_0x27039e['delivery_date']==_0x39c6e2[_0x2bac13(0x15a)]&&_0x27039e[_0x2bac13(0x16d)]==_0x39c6e2[_0x2bac13(0x16d)]&&(_0x27039e['product_stock']=parseInt(_0x27039e[_0x2bac13(0x1d3)])+parseInt(_0x39c6e2[_0x2bac13(0x117)]),_0x14e318++);});_0x14e318=='0'&&(_0x3bfd88[_0xea8cb1(0x202)]=_0x3bfd88['product_details'][_0xea8cb1(0x171)]({'product_name':_0x39c6e2[_0xea8cb1(0x21a)],'product_stock':_0x39c6e2[_0xea8cb1(0x117)],'primary_code':_0x39c6e2[_0xea8cb1(0x14e)],'secondary_code':_0x39c6e2[_0xea8cb1(0x1bd)],'product_code':_0x39c6e2[_0xea8cb1(0xff)],'storage':_0x39c6e2[_0xea8cb1(0x12d)],'rack':_0x39c6e2[_0xea8cb1(0x151)],'bay':_0x39c6e2['bay'],'bin':_0x39c6e2[_0xea8cb1(0x111)],'type':_0x39c6e2[_0xea8cb1(0x20d)],'floorlevel':_0x39c6e2[_0xea8cb1(0x187)],'maxProducts':_0x39c6e2['maxStocks'],'unit':_0x39c6e2[_0xea8cb1(0x17c)],'secondary_unit':_0x39c6e2[_0xea8cb1(0x18d)],'expiry_date':_0x39c6e2[_0xea8cb1(0x189)],'maxPerUnit':_0x39c6e2[_0xea8cb1(0x1ef)],'batch_code':_0x39c6e2[_0xea8cb1(0x169)],'alertQTY':_0x39c6e2['alertQTY'],'production_date':_0x39c6e2['production_date'],'delivery_date':_0x39c6e2[_0xea8cb1(0x15a)],'delivery_code':_0x39c6e2[_0xea8cb1(0x16d)]}));}),await _0x3bfd88['save'](),_0x27dfcd['finalize']=_0xda05c5(0x168);const _0x1bb32f=await _0x27dfcd[_0xda05c5(0x18e)]();_0x2ffb4b[_0xda05c5(0x1d1)](_0xda05c5(0x18b),'Sales\x20Update\x20successfully'),_0x2fa402['redirect'](_0xda05c5(0x1d5));}catch(_0xa66bc9){console[_0xda05c5(0x1e9)](_0xa66bc9);}}),router['get'](a0_0x6dba34(0x110),auth,async(_0x591e6c,_0x4a3c1b)=>{var _0x197d16=a0_0x6dba34;try{const {username:_0x3c63d0,email:_0x4aef94,role:_0x5891ed}=_0x591e6c[_0x197d16(0x13b)],_0x3fbd26=_0x591e6c[_0x197d16(0x13b)],_0x51a562=await profile[_0x197d16(0x192)]({'email':_0x3fbd26['email']}),_0x17a947=await master_shop[_0x197d16(0x1ba)](),_0x533988=_0x591e6c['params']['id'],_0x61191f=await purchases[_0x197d16(0x19b)](_0x533988),_0x195e73=await suppliers[_0x197d16(0x1ba)]({});let _0x2d8f44;if(_0x3fbd26[_0x197d16(0x1cf)]=='staff'){const _0x39f265=await staff['findOne']({'email':_0x3fbd26[_0x197d16(0x1ec)]});_0x2d8f44=await warehouse['find']({'status':_0x197d16(0x1d0),'name':_0x39f265[_0x197d16(0x11c)],'warehouse_category':_0x197d16(0x173)});}else _0x2d8f44=await warehouse[_0x197d16(0x14b)]([{'$match':{'status':'Enabled','warehouse_category':_0x197d16(0x173)}},{'$group':{'_id':_0x197d16(0x163),'name':{'$first':_0x197d16(0x163)}}}]);const _0x17153a=await product[_0x197d16(0x1ba)]({}),_0x34c6a0=BayBinSelected(_0x61191f[_0x197d16(0x156)],_0x61191f[_0x197d16(0x1b6)]);let _0x251b48=new Date(_0x61191f['expiry_date']),_0x2ed82c=('0'+_0x251b48[_0x197d16(0x15b)]())[_0x197d16(0x1dc)](-0x2),_0x51e4f5=('0'+(_0x251b48[_0x197d16(0x166)]()+0x1))[_0x197d16(0x1dc)](-0x2),_0x3ff292=_0x251b48['getFullYear'](),_0x53155b=_0x3ff292+'-'+_0x51e4f5+'-'+_0x2ed82c;if(_0x17a947[0x0][_0x197d16(0x14d)]=='English\x20(US)'){var _0xe6b50a=users['English'];console[_0x197d16(0x1e9)](_0xe6b50a);}else{if(_0x17a947[0x0][_0x197d16(0x14d)]==_0x197d16(0x122))var _0xe6b50a=users[_0x197d16(0x122)];else{if(_0x17a947[0x0][_0x197d16(0x14d)]==_0x197d16(0x135))var _0xe6b50a=users[_0x197d16(0x135)];else{if(_0x17a947[0x0][_0x197d16(0x14d)]==_0x197d16(0x1e8))var _0xe6b50a=users['Spanish'];else{if(_0x17a947[0x0][_0x197d16(0x14d)]=='French')var _0xe6b50a=users[_0x197d16(0x179)];else{if(_0x17a947[0x0][_0x197d16(0x14d)]==_0x197d16(0x100))var _0xe6b50a=users[_0x197d16(0x139)];else{if(_0x17a947[0x0][_0x197d16(0x14d)]==_0x197d16(0x131))var _0xe6b50a=users[_0x197d16(0x131)];else{if(_0x17a947[0x0][_0x197d16(0x14d)]==_0x197d16(0x1d7))var _0xe6b50a=users['Arabic'];}}}}}}}_0x4a3c1b[_0x197d16(0x190)]('edit_purchases',{'success':_0x591e6c['flash']('success'),'errors':_0x591e6c[_0x197d16(0x1d1)](_0x197d16(0x1eb)),'role':_0x3fbd26,'profile':_0x51a562,'purchases':_0x61191f,'suppliers':_0x195e73,'warehouse':_0x2d8f44,'product':_0x17153a,'master_shop':_0x17a947,'language':_0xe6b50a,'ed_fullDate':_0x53155b,'dataSelected':_0x34c6a0});}catch(_0x43afd4){console['log'](_0x43afd4);}}),router[a0_0x6dba34(0x1d2)](a0_0x6dba34(0x110),auth,async(_0x4c0bcf,_0x1af41c)=>{var _0x5630ec=a0_0x6dba34;try{const _0x46dd9a=_0x4c0bcf['params']['id'],_0x1a5829=await purchases[_0x5630ec(0x192)]({'_id':_0x4c0bcf[_0x5630ec(0x15d)]['id']}),_0x61923c=await warehouse[_0x5630ec(0x192)]({'name':_0x1a5829[_0x5630ec(0x156)],'room':_0x1a5829[_0x5630ec(0x1b6)]});_0x1a5829[_0x5630ec(0x13c)]['forEach'](_0x39c5d0=>{var _0x48ed04=_0x5630ec;const _0x20c685=_0x61923c[_0x48ed04(0x202)]['map'](_0x5c256b=>{var _0x1ff469=_0x48ed04;_0x5c256b['product_name']==_0x39c5d0[_0x1ff469(0x21a)]&&_0x5c256b[_0x1ff469(0x187)]==_0x39c5d0[_0x1ff469(0x187)]&&_0x5c256b['type']==_0x39c5d0['type']&&_0x5c256b[_0x1ff469(0x111)]==_0x39c5d0['bin']&&_0x5c256b[_0x1ff469(0x184)]==_0x39c5d0[_0x1ff469(0x184)]&&_0x5c256b['rack']==_0x39c5d0[_0x1ff469(0x151)]&&_0x5c256b['storage']==_0x39c5d0[_0x1ff469(0x12d)]&&(_0x5c256b[_0x1ff469(0x1d3)]=parseInt(_0x5c256b[_0x1ff469(0x1d3)])-parseInt(_0x39c5d0['quantity']));});}),await _0x61923c[_0x5630ec(0x18e)]();const {invoice:_0x210369,suppliers:_0x5c4ec0,date:_0x1854bc,warehouse_name:_0x3d65df,prod_name:_0x372215,prod_code:_0x2350dd,prod_qty:_0xc65fd9,prod_unit:_0x103811,prod_secondunit:_0x374041,prod_level:_0x4a8fdc,prod_isle:_0x296e4c,prod_pallet:_0x500c4d,note:_0x1f799b,expiry_date:_0x3893b0,batch_code:_0x1c9904,paid_amount:_0x21f1e8,due_amount:_0x12fcd8,Room_name:_0x40385c,primary_code:_0x2753f3,secondary_code:_0x4c817d,PO_number:_0xb833de,JO_number:_0x3b457b}=_0x4c0bcf['body'];if(typeof _0x372215==_0x5630ec(0x1f1))var _0x2c9f82=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x19e)]],_0x1222ad=[_0x4c0bcf['body'][_0x5630ec(0xfc)]],_0x1b92ff=[_0x4c0bcf['body'][_0x5630ec(0x123)]],_0x15b923=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x149)]],_0x301a16=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x194)]],_0x56cf06=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x1a5)]],_0x2e50a9=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x1c3)]],_0x36386c=[_0x4c0bcf['body'][_0x5630ec(0x11d)]],_0x9823b4=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x14e)]],_0x1db97a=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x1bd)]],_0x4163b9=[_0x4c0bcf['body'][_0x5630ec(0x125)]],_0x43ad18=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x169)]],_0x30241f=[_0x4c0bcf['body'][_0x5630ec(0x189)]],_0x3c2a44=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x12d)]],_0x4d6e48=[_0x4c0bcf[_0x5630ec(0x12b)]['rak']],_0x398640=[_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x20d)]];else var _0x2c9f82=[..._0x4c0bcf[_0x5630ec(0x12b)]['prod_name']],_0x1222ad=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0xfc)]],_0x1b92ff=[..._0x4c0bcf['body']['prod_qty']],_0x15b923=[..._0x4c0bcf[_0x5630ec(0x12b)]['prod_unit']],_0x301a16=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x194)]],_0x56cf06=[..._0x4c0bcf[_0x5630ec(0x12b)]['prod_level']],_0x2e50a9=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x1c3)]],_0x36386c=[..._0x4c0bcf['body']['prod_pallet']],_0x9823b4=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x14e)]],_0x1db97a=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x1bd)]],_0x4163b9=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x125)]],_0x43ad18=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x169)]],_0x30241f=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x189)]],_0x3c2a44=[..._0x4c0bcf['body'][_0x5630ec(0x12d)]],_0x4d6e48=[..._0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x172)]],_0x398640=[..._0x4c0bcf['body']['type']];const _0x5167ec=_0x2c9f82['map'](_0x1a355b=>{return _0x1a355b={'product_name':_0x1a355b};});_0x1222ad[_0x5630ec(0x140)]((_0x24882d,_0x327019)=>{var _0x4f9d26=_0x5630ec;_0x5167ec[_0x327019][_0x4f9d26(0xff)]=_0x24882d;}),_0x1b92ff[_0x5630ec(0x140)]((_0x45bd61,_0x3e611a)=>{var _0x5c5f4a=_0x5630ec;_0x5167ec[_0x3e611a][_0x5c5f4a(0x117)]=_0x45bd61;}),_0x15b923[_0x5630ec(0x140)]((_0x10c69e,_0x4a82c8)=>{var _0x27c97a=_0x5630ec;_0x5167ec[_0x4a82c8][_0x27c97a(0x17c)]=_0x10c69e;}),_0x301a16['forEach']((_0x364d7e,_0x1347db)=>{_0x5167ec[_0x1347db]['secondary_unit']=_0x364d7e;}),_0x56cf06[_0x5630ec(0x140)]((_0x6e8ddc,_0x38a9da)=>{_0x5167ec[_0x38a9da]['bay']=_0x6e8ddc;}),_0x2e50a9['forEach']((_0x4263fb,_0x417ea0)=>{var _0x4d4d01=_0x5630ec;_0x5167ec[_0x417ea0][_0x4d4d01(0x111)]=_0x4263fb;}),_0x36386c[_0x5630ec(0x140)]((_0xe2269b,_0x948d08)=>{var _0x3c23aa=_0x5630ec;_0x5167ec[_0x948d08][_0x3c23aa(0x187)]=_0xe2269b;}),_0x9823b4['forEach']((_0x2a5adb,_0x584fa4)=>{var _0x2c0e87=_0x5630ec;_0x5167ec[_0x584fa4][_0x2c0e87(0x14e)]=_0x2a5adb;}),_0x1db97a[_0x5630ec(0x140)]((_0x57a3ff,_0x473d75)=>{_0x5167ec[_0x473d75]['secondary_code']=_0x57a3ff;}),_0x4163b9['forEach']((_0x4dacfd,_0x2959de)=>{var _0x4c63a0=_0x5630ec;_0x5167ec[_0x2959de][_0x4c63a0(0x17b)]=_0x4dacfd;}),_0x43ad18['forEach']((_0x1c6778,_0x5574a2)=>{_0x5167ec[_0x5574a2]['batch_code']=_0x1c6778;}),_0x30241f[_0x5630ec(0x140)]((_0x300e9f,_0x23b18c)=>{var _0x102e0d=_0x5630ec;_0x5167ec[_0x23b18c][_0x102e0d(0x189)]=_0x300e9f;}),_0x398640[_0x5630ec(0x140)]((_0x4d0aea,_0x17de4b)=>{var _0x440482=_0x5630ec;_0x5167ec[_0x17de4b][_0x440482(0x20d)]=_0x4d0aea;}),_0x3c2a44['forEach']((_0x1fe8fc,_0x2198a6)=>{_0x5167ec[_0x2198a6]['storage']=_0x1fe8fc;}),_0x4d6e48[_0x5630ec(0x140)]((_0x1b4ae9,_0x5f3ffb)=>{_0x5167ec[_0x5f3ffb]['rack']=_0x1b4ae9;});const _0xc3ddcf=_0x5167ec[_0x5630ec(0x106)](_0x233c14=>_0x233c14[_0x5630ec(0x117)]!=='0'&&_0x233c14[_0x5630ec(0x117)]!=='');_0x1a5829[_0x5630ec(0x148)]=_0x210369,_0x1a5829['suppliers']=_0x5c4ec0,_0x1a5829['date']=_0x1854bc,_0x1a5829[_0x5630ec(0x156)]=_0x3d65df,_0x1a5829[_0x5630ec(0x13c)]=_0xc3ddcf,_0x1a5829[_0x5630ec(0x18f)]=_0x1f799b,_0x1a5829[_0x5630ec(0x1b4)]=_0x21f1e8,_0x1a5829[_0x5630ec(0x1a0)]=_0x12fcd8,_0x1a5829[_0x5630ec(0x1b6)]=_0x40385c,_0x1a5829[_0x5630ec(0x20e)]=_0xb833de,_0x1a5829[_0x5630ec(0x203)]=_0x3b457b;const _0x3ccef9=await _0x1a5829[_0x5630ec(0x18e)](),_0x24dd5f=await warehouse[_0x5630ec(0x192)]({'name':_0x4c0bcf['body'][_0x5630ec(0x156)],'room':_0x4c0bcf[_0x5630ec(0x12b)]['Room_name']});_0x1a5829[_0x5630ec(0x13c)][_0x5630ec(0x140)](_0x2e59c9=>{var _0x1505bb=_0x5630ec,_0x18a8d0=0x0;const _0x56cee3=_0x24dd5f[_0x1505bb(0x202)]['map'](_0x12b51f=>{var _0x3bb542=_0x1505bb;_0x12b51f[_0x3bb542(0x21a)]==_0x2e59c9[_0x3bb542(0x21a)]&&_0x12b51f[_0x3bb542(0x187)]==_0x2e59c9[_0x3bb542(0x187)]&&_0x12b51f[_0x3bb542(0x20d)]==_0x2e59c9[_0x3bb542(0x20d)]&&_0x12b51f['bin']==_0x2e59c9[_0x3bb542(0x111)]&&_0x12b51f[_0x3bb542(0x184)]==_0x2e59c9['bay']&&_0x12b51f[_0x3bb542(0x151)]==_0x2e59c9[_0x3bb542(0x151)]&&_0x12b51f[_0x3bb542(0x12d)]==_0x2e59c9[_0x3bb542(0x12d)]&&(_0x12b51f[_0x3bb542(0x1d3)]=parseInt(_0x12b51f[_0x3bb542(0x1d3)])+parseInt(_0x2e59c9[_0x3bb542(0x117)]),_0x18a8d0++);});_0x18a8d0=='0'&&(_0x24dd5f[_0x1505bb(0x202)]=_0x24dd5f[_0x1505bb(0x202)]['concat']({'product_name':_0x2e59c9[_0x1505bb(0x21a)],'product_stock':_0x2e59c9[_0x1505bb(0x117)],'primary_code':_0x2e59c9[_0x1505bb(0x14e)],'secondary_code':_0x2e59c9['secondary_code'],'product_code':_0x2e59c9[_0x1505bb(0xff)],'storage':_0x2e59c9[_0x1505bb(0x12d)],'rack':_0x2e59c9[_0x1505bb(0x151)],'bay':_0x2e59c9[_0x1505bb(0x184)],'bin':_0x2e59c9[_0x1505bb(0x111)],'type':_0x2e59c9[_0x1505bb(0x20d)],'floorlevel':_0x2e59c9['floorlevel'],'maxProducts':_0x2e59c9[_0x1505bb(0x17b)],'unit':_0x2e59c9[_0x1505bb(0x17c)],'secondary_unit':_0x2e59c9['secondary_unit'],'expiry_date':_0x2e59c9[_0x1505bb(0x189)]}));}),await _0x24dd5f[_0x5630ec(0x18e)]();const _0x2f0cb4=await s_payment_data['findOne']({'invoice':_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x148)]});if(_0x2f0cb4===null){}else console[_0x5630ec(0x1e9)](_0x5630ec(0x180),_0x2f0cb4,_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x148)]),_0x2f0cb4[_0x5630ec(0x180)]=_0x4c0bcf[_0x5630ec(0x12b)][_0x5630ec(0x180)],await _0x2f0cb4[_0x5630ec(0x18e)]();_0x4c0bcf[_0x5630ec(0x1d1)]('success',_0x5630ec(0x150)),_0x1af41c[_0x5630ec(0x160)](_0x5630ec(0x1d5));}catch(_0xb6798a){console[_0x5630ec(0x1e9)](_0xb6798a);}}),router['post'](a0_0x6dba34(0x13e),auth,async(_0x4952ab,_0x406201)=>{var _0x545d3c=a0_0x6dba34;try{const _0x106edc=_0x4952ab['params']['id'],{invoice:_0x554d60,suppliers:_0x34ec4f,payable:_0x3b38d0,due_amount:_0x20802b}=_0x4952ab[_0x545d3c(0x12b)],_0x1184d4=await purchases[_0x545d3c(0x19b)](_0x106edc);var _0x2ecf23=_0x3b38d0-_0x20802b;_0x1184d4[_0x545d3c(0x1b4)]=parseFloat(_0x1184d4[_0x545d3c(0x1b4)])+parseFloat(_0x20802b),_0x1184d4[_0x545d3c(0x1a0)]=_0x2ecf23;const _0x2fa7d1=await _0x1184d4[_0x545d3c(0x18e)]();console[_0x545d3c(0x1e9)](_0x2fa7d1);const _0x3355a2=await s_payment_data[_0x545d3c(0x192)]({'invoice':_0x554d60});_0x3355a2[_0x545d3c(0x144)]=_0x2ecf23,await _0x3355a2[_0x545d3c(0x18e)]();let _0x3d037b=new Date(),_0x44acdc=('0'+_0x3d037b['getDate']())['slice'](-0x2),_0x5ab65d=('0'+(_0x3d037b['getMonth']()+0x1))[_0x545d3c(0x1dc)](-0x2),_0x471847=_0x3d037b[_0x545d3c(0x18c)](),_0x1c3039=_0x471847+'-'+_0x5ab65d+'-'+_0x44acdc;const _0x55edc6=new suppliers_payment({'invoice':_0x554d60,'date':_0x471847+'-'+_0x5ab65d+'-'+_0x44acdc,'suppliers':_0x34ec4f,'reason':_0x545d3c(0x209),'amount':_0x20802b}),_0x1a4858=await _0x55edc6[_0x545d3c(0x18e)]();_0x4952ab[_0x545d3c(0x1d1)](_0x545d3c(0x18b),_0x545d3c(0x134)),_0x406201[_0x545d3c(0x160)](_0x545d3c(0x1d5));}catch(_0x4fa755){console[_0x545d3c(0x1e9)](_0x4fa755);}}),router[a0_0x6dba34(0x1b8)](a0_0x6dba34(0x102),auth,async(_0x1adca4,_0x5c20e8)=>{var _0x192624=a0_0x6dba34;try{const {username:_0x4270a4,email:_0x4ac47d,role:_0x263687}=_0x1adca4[_0x192624(0x13b)],_0x24fe4f=_0x1adca4[_0x192624(0x13b)],_0x90ccd6=await profile['findOne']({'email':_0x24fe4f['email']}),_0x30c9bf=await master_shop[_0x192624(0x1ba)]();console[_0x192624(0x1e9)](_0x192624(0x1fe),_0x30c9bf);const _0x18050a=_0x1adca4['params']['id'],_0x1055b0=await purchases[_0x192624(0x19b)](_0x18050a);console[_0x192624(0x1e9)](_0x1055b0);const _0x188e50=await suppliers['findOne']({'name':_0x1055b0['suppliers']});console[_0x192624(0x1e9)](_0x188e50);if(_0x30c9bf[0x0][_0x192624(0x14d)]=='English\x20(US)'){var _0x1a4273=users['English'];console['log'](_0x1a4273);}else{if(_0x30c9bf[0x0]['language']==_0x192624(0x122))var _0x1a4273=users[_0x192624(0x122)];else{if(_0x30c9bf[0x0]['language']==_0x192624(0x135))var _0x1a4273=users[_0x192624(0x135)];else{if(_0x30c9bf[0x0][_0x192624(0x14d)]==_0x192624(0x1e8))var _0x1a4273=users[_0x192624(0x1e8)];else{if(_0x30c9bf[0x0][_0x192624(0x14d)]=='French')var _0x1a4273=users[_0x192624(0x179)];else{if(_0x30c9bf[0x0][_0x192624(0x14d)]==_0x192624(0x100))var _0x1a4273=users[_0x192624(0x139)];else{if(_0x30c9bf[0x0]['language']==_0x192624(0x131))var _0x1a4273=users[_0x192624(0x131)];else{if(_0x30c9bf[0x0]['language']==_0x192624(0x1d7))var _0x1a4273=users[_0x192624(0x146)];}}}}}}}_0x5c20e8[_0x192624(0x190)](_0x192624(0x217),{'success':_0x1adca4['flash'](_0x192624(0x18b)),'errors':_0x1adca4['flash'](_0x192624(0x1eb)),'role':_0x24fe4f,'profile':_0x90ccd6,'master_shop':_0x30c9bf,'supplier':_0x188e50,'purchase':_0x1055b0,'language':_0x1a4273});}catch(_0x54483e){console[_0x192624(0x1e9)](_0x54483e);}}),router[a0_0x6dba34(0x1b8)](a0_0x6dba34(0x104),auth,async(_0x2a36c8,_0x49b4cb)=>{var _0x301716=a0_0x6dba34;try{const {username:_0x4f2c0a,email:_0x454402,role:_0x2d1ecc}=_0x2a36c8['user'],_0x6f5d8a=_0x2a36c8[_0x301716(0x13b)],_0x5bdbb6=await profile[_0x301716(0x192)]({'email':_0x6f5d8a[_0x301716(0x1ec)]}),_0x276864=await master_shop[_0x301716(0x1ba)]();console[_0x301716(0x1e9)](_0x301716(0x1fe),_0x276864);const _0xc6bf1f=_0x2a36c8['params']['id'];console[_0x301716(0x1e9)](_0xc6bf1f);const _0x3b399b=await purchases[_0x301716(0x19b)](_0xc6bf1f);console[_0x301716(0x1e9)](_0x301716(0x132),_0x3b399b);const _0x32ddbd=await product['find']({}),_0x451c64=await warehouse['aggregate']([{'$match':{'name':_0x3b399b['warehouse_name'],'room':_0x3b399b[_0x301716(0x1b6)],'warehouse_category':_0x301716(0x173)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x301716(0x176),'name':{'$first':_0x301716(0x1fb)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x301716(0x178)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x301716(0x16e)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x301716(0xfe)},'secondary_code':{'$first':_0x301716(0x1f8)},'product_code':{'$first':_0x301716(0xf9)},'storage':{'$first':_0x301716(0x1c2)},'rack':{'$first':'$product_details.rack'}}}]);warehouse_data=await warehouse['aggregate']([{'$match':{'status':_0x301716(0x1d0),'name':'Return\x20Goods','warehouse_category':_0x301716(0x173)}},{'$group':{'_id':_0x301716(0x163),'name':{'$first':_0x301716(0x163)}}},{'$sort':{'name':0x1}}]),console[_0x301716(0x1e9)]('stock_data',_0x451c64);if(_0x276864[0x0]['language']==_0x301716(0x1de)){var _0x4c2ee9=users[_0x301716(0x1e7)];console[_0x301716(0x1e9)](_0x4c2ee9);}else{if(_0x276864[0x0][_0x301716(0x14d)]=='Hindi')var _0x4c2ee9=users[_0x301716(0x122)];else{if(_0x276864[0x0][_0x301716(0x14d)]==_0x301716(0x135))var _0x4c2ee9=users[_0x301716(0x135)];else{if(_0x276864[0x0][_0x301716(0x14d)]==_0x301716(0x1e8))var _0x4c2ee9=users[_0x301716(0x1e8)];else{if(_0x276864[0x0]['language']=='French')var _0x4c2ee9=users['French'];else{if(_0x276864[0x0][_0x301716(0x14d)]==_0x301716(0x100))var _0x4c2ee9=users[_0x301716(0x139)];else{if(_0x276864[0x0]['language']==_0x301716(0x131))var _0x4c2ee9=users[_0x301716(0x131)];else{if(_0x276864[0x0]['language']==_0x301716(0x1d7))var _0x4c2ee9=users[_0x301716(0x146)];}}}}}}}_0x49b4cb[_0x301716(0x190)](_0x301716(0x14a),{'success':_0x2a36c8[_0x301716(0x1d1)](_0x301716(0x18b)),'errors':_0x2a36c8[_0x301716(0x1d1)]('errors'),'role':_0x6f5d8a,'profile':_0x5bdbb6,'user':_0x3b399b,'stock':_0x451c64,'master_shop':_0x276864,'product':_0x32ddbd,'language':_0x4c2ee9,'warehouse':warehouse_data});}catch(_0x3d3e35){console[_0x301716(0x1e9)](_0x3d3e35);}}),router['post'](a0_0x6dba34(0x104),auth,async(_0x53daeb,_0x39b60b)=>{var _0x1896ed=a0_0x6dba34;try{const {invoice:_0x516bf0,date:_0x5dc93b,warehouse_name:_0x4fdcfa,Room_name:_0x4e65c6,product_name:_0x656e9a,purchase_quantity:_0x669e02,stocks:_0x5d1627,return_qty:_0xa162b9,note:_0x57a5ac,level:_0x24d49f,isle:_0x184ce8,pallet:_0x47a0a3,to_warehouse_name:_0x211d05,to_Room_name:_0x1cf436}=_0x53daeb['body'],_0x372bad=await purchases[_0x1896ed(0x192)]({'_id':_0x53daeb[_0x1896ed(0x15d)]['id']}),_0x45ddf3=await warehouse[_0x1896ed(0x192)]({'name':_0x4fdcfa,'room':_0x4e65c6});if(typeof _0x656e9a==_0x1896ed(0x1f1))var _0x194951=[_0x53daeb[_0x1896ed(0x12b)]['product_name']],_0x211a51=[_0x53daeb[_0x1896ed(0x12b)][_0x1896ed(0x185)]],_0x5831cf=[_0x53daeb[_0x1896ed(0x12b)][_0x1896ed(0x126)]],_0xd01e8e=[_0x53daeb[_0x1896ed(0x12b)]['return_qty']],_0x5e27e4=[_0x53daeb[_0x1896ed(0x12b)]['level']],_0x5b0bdb=[_0x53daeb[_0x1896ed(0x12b)]['isle']],_0x1800fd=[_0x53daeb['body'][_0x1896ed(0x11f)]],_0x52809e=[_0x53daeb[_0x1896ed(0x12b)][_0x1896ed(0x137)]],_0x4e4ef1=[_0x53daeb[_0x1896ed(0x12b)]['product_code_hide']],_0x485c2e=[_0x53daeb['body'][_0x1896ed(0x120)]],_0x2c0497=[_0x53daeb[_0x1896ed(0x12b)][_0x1896ed(0x113)]];else var _0x194951=[..._0x53daeb[_0x1896ed(0x12b)][_0x1896ed(0x21a)]],_0x211a51=[..._0x53daeb['body'][_0x1896ed(0x185)]],_0x5831cf=[..._0x53daeb[_0x1896ed(0x12b)][_0x1896ed(0x126)]],_0xd01e8e=[..._0x53daeb['body'][_0x1896ed(0x19a)]],_0x5e27e4=[..._0x53daeb['body'][_0x1896ed(0x1db)]],_0x5b0bdb=[..._0x53daeb[_0x1896ed(0x12b)][_0x1896ed(0x154)]],_0x1800fd=[..._0x53daeb[_0x1896ed(0x12b)]['pallet']],_0x52809e=[..._0x53daeb[_0x1896ed(0x12b)]['types']],_0x4e4ef1=[..._0x53daeb['body']['product_code_hide']],_0x485c2e=[..._0x53daeb[_0x1896ed(0x12b)]['primary_code_hide']],_0x2c0497=[..._0x53daeb[_0x1896ed(0x12b)]['secondary_code_hide']];const _0x3b1c38=_0x194951[_0x1896ed(0x188)](_0x3b2e7d=>{return _0x3b2e7d={'product_name':_0x3b2e7d};});_0x211a51['forEach']((_0x405c15,_0xf4b44a)=>{_0x3b1c38[_0xf4b44a]['purchase_quantity']=_0x405c15;}),_0x5831cf['forEach']((_0x2c5241,_0x4c3be2)=>{_0x3b1c38[_0x4c3be2]['stock_quantity']=_0x2c5241;}),_0xd01e8e[_0x1896ed(0x140)]((_0x59ebea,_0x14203a)=>{var _0x4a195b=_0x1896ed;_0x3b1c38[_0x14203a][_0x4a195b(0x19a)]=_0x59ebea;}),_0x5e27e4[_0x1896ed(0x140)]((_0x211e56,_0x10666c)=>{_0x3b1c38[_0x10666c]['bay']=_0x211e56;}),_0x5b0bdb[_0x1896ed(0x140)]((_0x21be08,_0x35f522)=>{var _0x22f9ae=_0x1896ed;_0x3b1c38[_0x35f522][_0x22f9ae(0x111)]=_0x21be08;}),_0x1800fd[_0x1896ed(0x140)]((_0x1d2c94,_0x3179a7)=>{var _0x1f07ee=_0x1896ed;_0x3b1c38[_0x3179a7][_0x1f07ee(0x187)]=_0x1d2c94;}),_0x52809e['forEach']((_0x4062c4,_0x6a1692)=>{_0x3b1c38[_0x6a1692]['type']=_0x4062c4;}),_0x4e4ef1[_0x1896ed(0x140)]((_0x273824,_0x1f9ee4)=>{_0x3b1c38[_0x1f9ee4]['product_code']=_0x273824;}),_0x485c2e[_0x1896ed(0x140)]((_0x5c2019,_0x51972f)=>{var _0x1ed80d=_0x1896ed;_0x3b1c38[_0x51972f][_0x1ed80d(0x14e)]=_0x5c2019;}),_0x2c0497[_0x1896ed(0x140)]((_0x311088,_0x212816)=>{var _0x52f9a4=_0x1896ed;_0x3b1c38[_0x212816][_0x52f9a4(0x1bd)]=_0x311088;}),_0x372bad[_0x1896ed(0x13c)]['forEach'](_0x51b5f7=>{var _0x941ac0=_0x1896ed;const _0x558d8b=_0x45ddf3['product_details'][_0x941ac0(0x188)](_0x144b01=>{var _0x2dd8dd=_0x941ac0;_0x144b01[_0x2dd8dd(0x21a)]==_0x51b5f7[_0x2dd8dd(0x21a)]&&_0x144b01['floorlevel']==_0x51b5f7[_0x2dd8dd(0x187)]&&_0x144b01[_0x2dd8dd(0x20d)]==_0x51b5f7[_0x2dd8dd(0x20d)]&&_0x144b01['bin']==_0x51b5f7[_0x2dd8dd(0x111)]&&_0x144b01[_0x2dd8dd(0x184)]==_0x51b5f7['bay']&&_0x144b01[_0x2dd8dd(0x151)]==_0x51b5f7['rack']&&_0x144b01['storage']==_0x51b5f7['storage']&&(console[_0x2dd8dd(0x1e9)](parseInt(_0x144b01['product_stock'])+_0x2dd8dd(0x1ee)+parseInt(_0x51b5f7[_0x2dd8dd(0x117)])),_0x144b01['product_stock']=parseInt(_0x144b01[_0x2dd8dd(0x1d3)])+parseInt(_0x51b5f7[_0x2dd8dd(0x117)]));});}),await _0x45ddf3[_0x1896ed(0x18e)]();const _0x1cae36=_0x3b1c38[_0x1896ed(0x106)](_0x1f73c6=>_0x1f73c6[_0x1896ed(0x19a)]!=='0'&&_0x1f73c6['return_qty']!=='');var _0x47467d=0x0;_0x1cae36[_0x1896ed(0x140)](_0x408915=>{var _0x5c48c0=_0x1896ed;console[_0x5c48c0(0x1e9)](_0x5c48c0(0x1bc),_0x408915),(parseInt(_0x408915['purchase_quantity'])<parseInt(_0x408915['return_qty'])||parseInt(_0x408915[_0x5c48c0(0x1c9)])<parseInt(_0x408915[_0x5c48c0(0x19a)]))&&_0x47467d++;});if(_0x47467d!=0x0)return _0x53daeb[_0x1896ed(0x1d1)]('errors',_0x1896ed(0x17f)),_0x39b60b[_0x1896ed(0x160)](_0x1896ed(0x219));const _0x42c186=new purchases_return({'invoice':_0x516bf0,'suppliers':_0x53daeb['body']['suppliers'],'date':_0x5dc93b,'warehouse_name':_0x4fdcfa,'return_product':_0x1cae36,'note':_0x57a5ac,'room':_0x4e65c6,'to_warehouse_name':_0x211d05,'to_room':_0x1cf436}),_0x2dee3e=await _0x42c186[_0x1896ed(0x18e)]();console[_0x1896ed(0x1e9)](_0x42c186);const _0x419d03=await purchases_return[_0x1896ed(0x192)]({'invoice':_0x516bf0}),_0x34c75c=await warehouse[_0x1896ed(0x192)]({'name':_0x211d05,'room':_0x1cf436});_0x419d03[_0x1896ed(0x17e)][_0x1896ed(0x140)](_0x2e445c=>{var _0x587852=_0x1896ed,_0x3bfb61=0x0;const _0x2ce01e=_0x34c75c['product_details'][_0x587852(0x188)](_0x266b40=>{var _0x3d4954=_0x587852;_0x266b40[_0x3d4954(0x21a)]==_0x2e445c[_0x3d4954(0x21a)]&&_0x266b40[_0x3d4954(0x187)]==_0x2e445c['floorlevel']&&_0x266b40[_0x3d4954(0x20d)]==_0x2e445c[_0x3d4954(0x20d)]&&_0x266b40[_0x3d4954(0x111)]==_0x2e445c['bin']&&_0x266b40['bay']==_0x2e445c[_0x3d4954(0x184)]&&(_0x266b40[_0x3d4954(0x1d3)]=parseInt(_0x266b40[_0x3d4954(0x1d3)])-parseInt(_0x2e445c[_0x3d4954(0x19a)]),_0x3bfb61++);});_0x3bfb61=='0'&&(_0x34c75c[_0x587852(0x202)]=_0x34c75c[_0x587852(0x202)][_0x587852(0x171)]({'product_name':_0x2e445c['product_name'],'product_stock':_0x2e445c[_0x587852(0x19a)],'primary_code':_0x2e445c[_0x587852(0x14e)],'secondary_code':_0x2e445c[_0x587852(0x1bd)],'product_code':_0x2e445c[_0x587852(0xff)],'storage':_0x2e445c[_0x587852(0x12d)],'rack':_0x2e445c[_0x587852(0x151)],'bay':_0x2e445c[_0x587852(0x184)],'bin':_0x2e445c[_0x587852(0x111)],'type':_0x2e445c[_0x587852(0x20d)],'floorlevel':_0x2e445c[_0x587852(0x187)],'maxProducts':_0x2e445c['maxStocks'],'unit':_0x2e445c['standard_unit'],'secondary_unit':_0x2e445c['secondary_unit'],'expiry_date':_0x2e445c[_0x587852(0x189)]}));}),await _0x34c75c[_0x1896ed(0x18e)]();const _0x3d33f8=await purchases['findOne']({'invoice':_0x516bf0});_0x3d33f8[_0x1896ed(0x1b2)]=_0x1896ed(0x168);const _0x33d153=await _0x3d33f8['save'](),_0xdb1289=new s_payment_data({'invoice':_0x516bf0,'suppliers':_0x53daeb['body']['suppliers'],'reason':'Purchase\x20Return'});await _0xdb1289['save']();const _0x481fc8=await master_shop['find']();console[_0x1896ed(0x1e9)](_0x1896ed(0x1e6),_0x481fc8[0x0][_0x1896ed(0x114)]);const _0x49374f=await email_settings['findOne'](),_0x4d6a62=await suppliers[_0x1896ed(0x192)]({'name':_0x53daeb['body'][_0x1896ed(0x180)]});console[_0x1896ed(0x1e9)](_0x1896ed(0x1b5),_0x4d6a62);_0x481fc8[0x0]['currency_placement']==0x1?(right_currency=_0x481fc8[0x0][_0x1896ed(0x213)],left_currency=''):(right_currency='',left_currency=_0x481fc8[0x0]['currency']);var _0xd4c1ee=_0x194951,_0x446202=_0xd01e8e,_0x139b1a='',_0xf5bfec;for(_0xf5bfec in _0xd4c1ee){_0x139b1a+='<tr>'+_0x1896ed(0x1cb)+_0xd4c1ee[_0xf5bfec]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x446202[_0xf5bfec]+_0x1896ed(0x1b3)+_0x1896ed(0x211);}console['log'](_0x1896ed(0x20b),_0x139b1a);let _0x3a6424=nodemailer[_0x1896ed(0x10a)]({'service':_0x1896ed(0x1e2),'auth':{'user':_0x49374f['email'],'pass':_0x49374f[_0x1896ed(0x1b7)]}}),_0x15c702={'from':_0x49374f['email'],'to':_0x4d6a62[_0x1896ed(0x1ec)],'subject':_0x1896ed(0x12f),'attachments':[{'filename':_0x1896ed(0x1ea),'path':__dirname+'/../public'+_0x1896ed(0xfb)+_0x481fc8[0x0][_0x1896ed(0x114)],'cid':_0x1896ed(0x19c)}],'html':'<!DOCTYPE\x20html>'+_0x1896ed(0x200)+_0x1896ed(0x112)+_0x1896ed(0x1ad)+_0x1896ed(0x1cd)+_0x1896ed(0x1ad)+_0x1896ed(0x158)+_0x1896ed(0x1ca)+_0x1896ed(0x1ad)+_0x1896ed(0x105)+_0x481fc8[0x0][_0x1896ed(0x216)]+'\x20</h2>'+_0x1896ed(0x1ca)+_0x1896ed(0x1ca)+'<hr\x20class=\x22my-3\x22>'+_0x1896ed(0x1ad)+_0x1896ed(0x1cc)+_0x1896ed(0x103)+_0x516bf0+'\x20'+_0x1896ed(0x1da)+_0x1896ed(0x161)+_0x5dc93b+'\x20'+_0x1896ed(0x17d)+_0x1896ed(0x167)+_0x1896ed(0x1ca)+_0x1896ed(0x16a)+_0x1896ed(0x10b)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x1896ed(0x16c)+_0x1896ed(0x174)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x1896ed(0x211)+_0x1896ed(0x1fa)+_0x1896ed(0x208)+'\x20'+_0x139b1a+'\x20'+'</tbody>'+'</table>'+_0x1896ed(0x1ad)+_0x1896ed(0x116)+_0x1896ed(0x170)+_0x481fc8[0x0][_0x1896ed(0x216)]+'</h5>'+'</div>'+'</div>'+_0x1896ed(0x157)};_0x3a6424['sendMail'](_0x15c702,function(_0x156c42,_0x514b03){var _0x326f09=_0x1896ed;_0x156c42?(console[_0x326f09(0x1e9)](_0x156c42),console[_0x326f09(0x1e9)](_0x326f09(0x15e))):console[_0x326f09(0x1e9)]('Email\x20sent\x20successfully');}),_0x53daeb[_0x1896ed(0x1d1)](_0x1896ed(0x18b),'purchases\x20item\x20return\x20successfull'),_0x39b60b[_0x1896ed(0x160)](_0x1896ed(0x1d5));}catch(_0x30ea75){console[_0x1896ed(0x1e9)](_0x30ea75),_0x39b60b[_0x1896ed(0xfd)](0xc8)['json']({'message':_0x30ea75[_0x1896ed(0x196)]});}}),router[a0_0x6dba34(0x1b8)](a0_0x6dba34(0x13a),auth,async(_0x3ae2c2,_0xae478f)=>{var _0xd237c5=a0_0x6dba34;try{const {username:_0x22f748,email:_0x48df05,role:_0x2d612a}=_0x3ae2c2[_0xd237c5(0x13b)],_0x578039=_0x3ae2c2[_0xd237c5(0x13b)],_0x3fba79=await profile[_0xd237c5(0x192)]({'email':_0x578039[_0xd237c5(0x1ec)]}),_0x42d548=await master_shop[_0xd237c5(0x1ba)](),_0x55f8aa=_0x3ae2c2[_0xd237c5(0x15d)]['id'],_0x5a9e0f=await purchases[_0xd237c5(0x19b)](_0x55f8aa);if(_0x42d548[0x0][_0xd237c5(0x14d)]==_0xd237c5(0x1de))var _0x368b4c=users['English'];else{if(_0x42d548[0x0][_0xd237c5(0x14d)]==_0xd237c5(0x122))var _0x368b4c=users['Hindi'];else{if(_0x42d548[0x0]['language']=='German')var _0x368b4c=users[_0xd237c5(0x135)];else{if(_0x42d548[0x0][_0xd237c5(0x14d)]=='Spanish')var _0x368b4c=users[_0xd237c5(0x1e8)];else{if(_0x42d548[0x0][_0xd237c5(0x14d)]==_0xd237c5(0x179))var _0x368b4c=users[_0xd237c5(0x179)];else{if(_0x42d548[0x0][_0xd237c5(0x14d)]==_0xd237c5(0x100))var _0x368b4c=users[_0xd237c5(0x139)];else{if(_0x42d548[0x0][_0xd237c5(0x14d)]=='Chinese')var _0x368b4c=users[_0xd237c5(0x131)];else{if(_0x42d548[0x0]['language']=='Arabic\x20(ae)')var _0x368b4c=users[_0xd237c5(0x146)];}}}}}}}_0xae478f['render']('all_purchases_barcode',{'success':_0x3ae2c2[_0xd237c5(0x1d1)]('success'),'errors':_0x3ae2c2[_0xd237c5(0x1d1)]('errors'),'role':_0x578039,'profile':_0x3fba79,'alldata':_0x5a9e0f,'master_shop':_0x42d548,'language':_0x368b4c}),console['log'](alldata);}catch(_0x252714){console[_0xd237c5(0x1e9)](_0x252714);}}),router[a0_0x6dba34(0x1d2)](a0_0x6dba34(0x205),async(_0x493979,_0x338c27)=>{var _0x4a5497=a0_0x6dba34;const {product_code:_0x5566bc}=_0x493979[_0x4a5497(0x12b)];var _0x316b10;const _0x3321a8=await product['aggregate']([{'$match':{'primary_code':_0x5566bc,'product_category':_0x4a5497(0x173)}},{'$group':{'_id':_0x4a5497(0x204),'name':{'$first':'$name'},'category':{'$first':'$category'},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x4a5497(0x165)},'product_code':{'$first':_0x4a5497(0x175)},'primary_code':{'$first':_0x4a5497(0x215)},'secondary_code':{'$first':_0x4a5497(0x1dd)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x4a5497(0x101)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x4a5497(0x210)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x25453e=await product['aggregate']([{'$match':{'secondary_code':_0x5566bc,'product_category':_0x4a5497(0x173)}},{'$group':{'_id':_0x4a5497(0x204),'name':{'$first':_0x4a5497(0x163)},'category':{'$first':'$category'},'brand':{'$first':_0x4a5497(0x1fc)},'unit':{'$first':_0x4a5497(0x145)},'alertquantity':{'$first':_0x4a5497(0x165)},'product_code':{'$first':_0x4a5497(0x175)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':'$secondary_code'},'maxStocks':{'$first':_0x4a5497(0x212)},'maxProdPerUnit':{'$first':_0x4a5497(0x101)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x4a5497(0x210)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x3321a8[_0x4a5497(0x183)]>0x0)_0x316b10=_0x3321a8;else _0x25453e['length']>0x0&&(_0x316b10=_0x25453e);_0x338c27[_0x4a5497(0x15f)](_0x316b10);}),router[a0_0x6dba34(0x1d2)](a0_0x6dba34(0x1f0),async(_0x19437e,_0x493d30)=>{var _0x4bb2db=a0_0x6dba34;const {primaryCode:_0x2c57c5,secondaryCode:_0x881d2e,productCode:_0x1b38d4,bay:_0x9fa53f,bin:_0x1b55a5,types:_0x154a53,pallet:_0x260a4f,warehouses:_0x554bf7,room:_0xfc826}=_0x19437e[_0x4bb2db(0x12b)];console['log'](_0x19437e[_0x4bb2db(0x12b)]);try{const _0x388602=await warehouse[_0x4bb2db(0x14b)]([{'$match':{'name':_0x554bf7,'room':_0xfc826}},{'$unwind':_0x4bb2db(0x147)},{'$match':{'product_details.bay':_0x9fa53f,'product_details.bin':_0x1b55a5,'product_details.type':_0x154a53}},{'$group':{'_id':_0x4bb2db(0x176),'name':{'$first':_0x4bb2db(0x1fb)},'product_stock':{'$first':_0x4bb2db(0x1c1)},'level':{'$first':_0x4bb2db(0x181)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x4bb2db(0x128)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x493d30[_0x4bb2db(0xfd)](0xc8)[_0x4bb2db(0x15f)](_0x388602);}catch(_0x31c5f8){_0x493d30[_0x4bb2db(0xfd)](0x194)[_0x4bb2db(0x15f)]({'message':_0x31c5f8[_0x4bb2db(0x196)]});}}),module['exports']=router;