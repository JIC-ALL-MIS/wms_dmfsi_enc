var a0_0x5698bf=a0_0x2b0a;(function(_0x6de66e,_0x1ce43f){var _0xbc9a44=a0_0x2b0a,_0x4552fb=_0x6de66e();while(!![]){try{var _0x41915b=-parseInt(_0xbc9a44(0x188))/0x1+-parseInt(_0xbc9a44(0x1fa))/0x2*(-parseInt(_0xbc9a44(0x1ac))/0x3)+parseInt(_0xbc9a44(0x229))/0x4*(parseInt(_0xbc9a44(0x178))/0x5)+parseInt(_0xbc9a44(0x1d4))/0x6*(-parseInt(_0xbc9a44(0x23b))/0x7)+-parseInt(_0xbc9a44(0x182))/0x8+-parseInt(_0xbc9a44(0x247))/0x9*(parseInt(_0xbc9a44(0x1fb))/0xa)+parseInt(_0xbc9a44(0x24b))/0xb;if(_0x41915b===_0x1ce43f)break;else _0x4552fb['push'](_0x4552fb['shift']());}catch(_0x5d6c9e){_0x4552fb['push'](_0x4552fb['shift']());}}}(a0_0x3fc6,0xc9f29));const express=require(a0_0x5698bf(0x1ee)),app=express(),router=express[a0_0x5698bf(0x144)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),nodemailer=require(a0_0x5698bf(0x1e3));function a0_0x2b0a(_0x47955a,_0x3624de){var _0x3fc6c4=a0_0x3fc6();return a0_0x2b0a=function(_0x2b0a21,_0x36e410){_0x2b0a21=_0x2b0a21-0x13a;var _0x351e26=_0x3fc6c4[_0x2b0a21];return _0x351e26;},a0_0x2b0a(_0x47955a,_0x3624de);}var ejs=require(a0_0x5698bf(0x211));const path=require(a0_0x5698bf(0x1da)),users=require(a0_0x5698bf(0x1bd));router['get'](a0_0x5698bf(0x198),auth,async(_0x597d89,_0x2f11b4)=>{var _0x5433c6=a0_0x5698bf;try{const {username:_0x514d8a,email:_0x503fac,role:_0x3d9b0d}=_0x597d89[_0x5433c6(0x1aa)],_0x23d6d9=_0x597d89['user'],_0x44a8e8=await profile[_0x5433c6(0x1c5)]({'email':_0x23d6d9['email']}),_0x5197b9=await staff['findOne']({'email':_0x23d6d9[_0x5433c6(0x240)]});if(_0x23d6d9['role']==_0x5433c6(0x158)){const _0xd465b8=await staff[_0x5433c6(0x1c5)]({'email':_0x23d6d9[_0x5433c6(0x240)]});}const _0x40bae3=await master_shop[_0x5433c6(0x1ef)]();let _0x475ae4;if(_0x23d6d9[_0x5433c6(0x20e)]==_0x5433c6(0x158)){const _0x56c0d5=await staff['findOne']({'email':_0x23d6d9[_0x5433c6(0x240)]});_0x475ae4=await purchases['aggregate']([{'$match':{'warehouse_name':_0x56c0d5[_0x5433c6(0x1d3)]}},{'$lookup':{'from':_0x5433c6(0x196),'localField':_0x5433c6(0x196),'foreignField':'name','as':_0x5433c6(0x170)}},{'$unwind':_0x5433c6(0x25c)},{'$unwind':_0x5433c6(0x1d6)},{'$group':{'_id':'$_id','invoice':{'$first':_0x5433c6(0x14a)},'suppliers':{'$first':_0x5433c6(0x18c)},'date':{'$first':_0x5433c6(0x239)},'warehouse_name':{'$first':_0x5433c6(0x157)},'room':{'$first':_0x5433c6(0x21a)},'product':{'$push':_0x5433c6(0x1d6)},'note':{'$first':_0x5433c6(0x25d)},'paid_amount':{'$first':_0x5433c6(0x23c)},'due_amount':{'$first':_0x5433c6(0x1b9)},'return_data':{'$first':_0x5433c6(0x233)},'batch_code':{'$first':_0x5433c6(0x17d)},'expiry_date':{'$first':_0x5433c6(0x168)},'suppliers_docs':{'$first':_0x5433c6(0x25c)},'total_product_quantity':{'$sum':_0x5433c6(0x222)},'level':{'$addToSet':_0x5433c6(0x1db)},'isle':{'$addToSet':_0x5433c6(0x228)},'type':{'$addToSet':_0x5433c6(0x13e)},'floorlevel':{'$addToSet':_0x5433c6(0x24d)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x475ae4=await purchases[_0x5433c6(0x1a4)]([{'$lookup':{'from':_0x5433c6(0x196),'localField':_0x5433c6(0x196),'foreignField':_0x5433c6(0x203),'as':_0x5433c6(0x170)}},{'$unwind':_0x5433c6(0x25c)},{'$unwind':_0x5433c6(0x1d6)},{'$group':{'_id':_0x5433c6(0x206),'invoice':{'$first':_0x5433c6(0x14a)},'suppliers':{'$first':'$suppliers'},'date':{'$first':_0x5433c6(0x239)},'warehouse_name':{'$first':_0x5433c6(0x157)},'room':{'$addToSet':_0x5433c6(0x19c)},'product':{'$push':_0x5433c6(0x1d6)},'note':{'$first':_0x5433c6(0x25d)},'paid_amount':{'$first':_0x5433c6(0x23c)},'due_amount':{'$first':_0x5433c6(0x1b9)},'return_data':{'$first':_0x5433c6(0x233)},'batch_code':{'$first':_0x5433c6(0x17d)},'expiry_date':{'$first':'$expiry_date'},'suppliers_docs':{'$first':_0x5433c6(0x25c)},'total_product_quantity':{'$sum':_0x5433c6(0x222)},'level':{'$addToSet':_0x5433c6(0x1db)},'isle':{'$addToSet':_0x5433c6(0x228)},'type':{'$addToSet':_0x5433c6(0x13e)},'floorlevel':{'$addToSet':_0x5433c6(0x24d)},'finalize':{'$first':_0x5433c6(0x1b7)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1,'finalize':0x1}}]);if(_0x40bae3[0x0][_0x5433c6(0x1e6)]==_0x5433c6(0x1c1)){var _0x54bee6=users[_0x5433c6(0x245)];console[_0x5433c6(0x197)](_0x54bee6);}else{if(_0x40bae3[0x0][_0x5433c6(0x1e6)]==_0x5433c6(0x192))var _0x54bee6=users['Hindi'];else{if(_0x40bae3[0x0]['language']==_0x5433c6(0x215))var _0x54bee6=users['German'];else{if(_0x40bae3[0x0][_0x5433c6(0x1e6)]=='Spanish')var _0x54bee6=users[_0x5433c6(0x1bc)];else{if(_0x40bae3[0x0][_0x5433c6(0x1e6)]==_0x5433c6(0x237))var _0x54bee6=users[_0x5433c6(0x237)];else{if(_0x40bae3[0x0][_0x5433c6(0x1e6)]==_0x5433c6(0x1ea))var _0x54bee6=users[_0x5433c6(0x13a)];else{if(_0x40bae3[0x0][_0x5433c6(0x1e6)]==_0x5433c6(0x1ed))var _0x54bee6=users[_0x5433c6(0x1ed)];else{if(_0x40bae3[0x0]['language']=='Arabic\x20(ae)')var _0x54bee6=users[_0x5433c6(0x230)];}}}}}}}_0x2f11b4[_0x5433c6(0x232)](_0x5433c6(0x195),{'success':_0x597d89['flash']('success'),'errors':_0x597d89[_0x5433c6(0x1a2)]('errors'),'purchases':_0x475ae4,'role':_0x23d6d9,'profile':_0x44a8e8,'master_shop':_0x40bae3,'language':_0x54bee6});}catch(_0x5c3248){console[_0x5433c6(0x197)](_0x5433c6(0x1c2),_0x5c3248),_0x2f11b4['status'](0xc8)[_0x5433c6(0x231)]({'message':_0x5c3248[_0x5433c6(0x177)]});}});function BayBinSelected(_0x14335c,_0x35b62d){var _0x48c0ad=a0_0x5698bf,_0x3f106f=[],_0x1ad14d=[],_0x2eab49=[],_0x4ba6b5=[],_0x56b439=[],_0x2bd81c=[];let _0x53cc7b=[];if(_0x14335c==_0x48c0ad(0x1f7))switch(_0x35b62d){case _0x48c0ad(0x1b3):_0x3f106f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x1ad14d=[0x1,0x2],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=[_0x48c0ad(0x187),_0x48c0ad(0x25e)],_0x56b439=['D'],_0x2bd81c=['A'];break;case _0x48c0ad(0x146):_0x3f106f=[0x6,0x5,0x4,0x3,0x2,0x1],_0x1ad14d=[0x1,0x2],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=['Level',_0x48c0ad(0x25e)],_0x56b439=['D'],_0x2bd81c=['B'];break;case _0x48c0ad(0x216):_0x3f106f=[0x0],_0x1ad14d=[0x0],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=[_0x48c0ad(0x25e)],_0x56b439=['D'],_0x2bd81c=['S'];break;case _0x48c0ad(0x236):_0x3f106f=[0x0],_0x1ad14d=[0x0],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x2eab49=[_0x48c0ad(0x25e)],_0x56b439=['D'],_0x2bd81c=['R'];break;}else{if(_0x14335c==_0x48c0ad(0x149))switch(_0x35b62d){case _0x48c0ad(0x1b3):_0x3f106f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x1ad14d=['B','F'],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=['Level','Floor'],_0x56b439=['C'],_0x2bd81c=['A'];break;case _0x48c0ad(0x146):_0x3f106f=[0x5,0x4,0x3,0x2,0x1],_0x1ad14d=['F','B','S'],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=[_0x48c0ad(0x187),_0x48c0ad(0x25e)],_0x56b439=['C'],_0x2bd81c=['B'];break;case _0x48c0ad(0x1c8):_0x3f106f=[0x1,0x2,0x3,0x4,0x5],_0x1ad14d=['B','F','S'],_0x4ba6b5=[0x5,0x4,0x3,0x2,0x1],_0x2eab49=[_0x48c0ad(0x187),_0x48c0ad(0x25e)],_0x56b439=['C'],_0x2bd81c=['C'];break;case _0x48c0ad(0x249):_0x3f106f=[0x5,0x4,0x3,0x2,0x1],_0x1ad14d=['F','B','S'],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=['Level',_0x48c0ad(0x25e)],_0x56b439=['C'],_0x2bd81c=['D'];break;case'Rack\x20E':_0x3f106f=[0x4,0x3,0x2,0x1],_0x1ad14d=[0x1,0x2],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=[_0x48c0ad(0x187),'Floor'],_0x56b439=['C'],_0x2bd81c=['E'];break;case'Rack\x20F':_0x3f106f=[0x1,0x2,0x3],_0x1ad14d=[0x1,0x2],_0x4ba6b5=[0x1,0x2,0x3,0x4,0x5],_0x2eab49=['Level'],_0x56b439=['C'],_0x2bd81c=['F'];break;}}return{'levels':_0x3f106f,'Isle':_0x1ad14d,'rack':_0x4ba6b5,'type':_0x2eab49,'storage':_0x56b439,'rak':_0x2bd81c};}async function getRandom8DigitNumber(){var _0x2d5da2=a0_0x5698bf;const _0x545106=0x989680,_0x5c389b=0x5f5e0ff,_0x19fa2b=Math[_0x2d5da2(0x140)](Math[_0x2d5da2(0x156)]()*(_0x5c389b-_0x545106+0x1))+_0x545106;var _0x4ec90b;const _0x10134b=await purchases[_0x2d5da2(0x1c5)]({'invoice':'INC-'+_0x19fa2b});return _0x10134b&&_0x10134b[_0x2d5da2(0x1fe)]>0x0?_0x4ec90b=_0x2d5da2(0x151)+_0x19fa2b:_0x4ec90b=_0x2d5da2(0x151)+_0x19fa2b,_0x4ec90b;}router[a0_0x5698bf(0x21c)](a0_0x5698bf(0x234),auth,async(_0x29dc74,_0x58263a)=>{var _0x59ad40=a0_0x5698bf;try{const {username:_0x24a3e2,email:_0x309eb6,role:_0x3956d9}=_0x29dc74[_0x59ad40(0x1aa)],_0x2a1161=_0x29dc74[_0x59ad40(0x1aa)],_0x355a5c=await profile['findOne']({'email':_0x2a1161[_0x59ad40(0x240)]}),_0x4a6a71=await master_shop[_0x59ad40(0x1ef)](),_0x54e767=await staff[_0x59ad40(0x1c5)]({'email':_0x2a1161[_0x59ad40(0x240)]}),_0x3cd2bd=await suppliers[_0x59ad40(0x1ef)]({});let _0x566a38;if(_0x2a1161[_0x59ad40(0x20e)]==_0x59ad40(0x158)){const _0x13b058=await staff['findOne']({'email':_0x2a1161[_0x59ad40(0x240)]});_0x566a38=await warehouse[_0x59ad40(0x1a4)]([{'$match':{'status':_0x59ad40(0x19b),'name':_0x13b058[_0x59ad40(0x1d3)],'warehouse_category':_0x59ad40(0x176),'name':{'$ne':_0x59ad40(0x13c)}}},{'$group':{'_id':_0x59ad40(0x15e),'name':{'$first':_0x59ad40(0x15e)}}}]);}else _0x566a38=await warehouse['aggregate']([{'$match':{'status':_0x59ad40(0x19b),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x59ad40(0x13c)}}},{'$group':{'_id':'$name','name':{'$first':_0x59ad40(0x15e)}}}]);const _0x1f428f=await product[_0x59ad40(0x1ef)]({}),_0x580d1f=await warehouse[_0x59ad40(0x1ef)]({'status':_0x59ad40(0x19b)}),_0x345a30=await purchases[_0x59ad40(0x1ef)]({}),_0x56fd88=_0x345a30[_0x59ad40(0x1fe)]+0x1,_0x3ed175=_0x59ad40(0x151)+_0x56fd88[_0x59ad40(0x1a5)]()['padStart'](0x5,'0');var _0x2c8d79=[_0x59ad40(0x17b),_0x59ad40(0x1c3)];if(_0x4a6a71[0x0]['language']==_0x59ad40(0x1c1))var _0x3badbf=users['English'];else{if(_0x4a6a71[0x0][_0x59ad40(0x1e6)]==_0x59ad40(0x192))var _0x3badbf=users[_0x59ad40(0x192)];else{if(_0x4a6a71[0x0][_0x59ad40(0x1e6)]==_0x59ad40(0x215))var _0x3badbf=users[_0x59ad40(0x215)];else{if(_0x4a6a71[0x0]['language']==_0x59ad40(0x1bc))var _0x3badbf=users[_0x59ad40(0x1bc)];else{if(_0x4a6a71[0x0][_0x59ad40(0x1e6)]==_0x59ad40(0x237))var _0x3badbf=users[_0x59ad40(0x237)];else{if(_0x4a6a71[0x0][_0x59ad40(0x1e6)]==_0x59ad40(0x1ea))var _0x3badbf=users[_0x59ad40(0x13a)];else{if(_0x4a6a71[0x0][_0x59ad40(0x1e6)]==_0x59ad40(0x1ed))var _0x3badbf=users[_0x59ad40(0x1ed)];else{if(_0x4a6a71[0x0][_0x59ad40(0x1e6)]==_0x59ad40(0x19f))var _0x3badbf=users[_0x59ad40(0x230)];}}}}}}}const _0x8af670=getRandom8DigitNumber();_0x8af670['then'](_0x161b88=>{var _0x34261e=_0x59ad40;_0x58263a['render'](_0x34261e(0x13b),{'success':_0x29dc74[_0x34261e(0x1a2)](_0x34261e(0x1cd)),'errors':_0x29dc74['flash'](_0x34261e(0x19a)),'role':_0x2a1161,'profile':_0x355a5c,'suppliers':_0x3cd2bd,'warehouse':_0x566a38,'product':_0x1f428f,'invoice':_0x161b88,'master_shop':_0x4a6a71,'language':_0x3badbf,'find_data':_0x580d1f,'rooms_data':_0x2c8d79});})[_0x59ad40(0x258)](_0x28de2c=>{var _0x942ce8=_0x59ad40;_0x29dc74['flash'](_0x942ce8(0x19a),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x58263a[_0x942ce8(0x17a)]('/all_purchases/view');});}catch(_0x5d0cb5){console[_0x59ad40(0x197)](_0x5d0cb5);}}),router[a0_0x5698bf(0x21c)](a0_0x5698bf(0x1e2),auth,async(_0x5bcdc9,_0x31d64f)=>{var _0x17b530=a0_0x5698bf;try{const _0x41a6ea=_0x5bcdc9[_0x17b530(0x163)]['id'];console['log'](_0x41a6ea);const _0x5bca05=await master_shop[_0x17b530(0x1ef)]();console[_0x17b530(0x197)](_0x17b530(0x190),_0x5bca05);const _0x3a2219=await product[_0x17b530(0x1c5)]({'name':_0x41a6ea});console[_0x17b530(0x197)]('product',_0x3a2219),_0x31d64f[_0x17b530(0x1ad)](0xc8)[_0x17b530(0x231)]({'product_data':_0x3a2219,'master':_0x5bca05});}catch(_0x339324){console['log'](_0x17b530(0x226),_0x339324);}}),router['post'](a0_0x5698bf(0x234),auth,async(_0xbf62b7,_0x40ddf6)=>{var _0x580241=a0_0x5698bf;try{const {invoice:_0x1e08e9,date:_0x144380,warehouse_name:_0x58ac5e,prod_name:_0x4b0ac2,prod_code:_0x434a49,prod_qty:_0x79a257,prod_unit:_0x13f5fd,prod_secondunit:_0x5c725d,prod_level:_0x904d06,prod_isle:_0x507ca0,prod_pallet:_0x5dd046,note:_0x1ea735,expiry_date:_0x29b29d,batch_code:_0x1fdb14,payable:_0x258ca6,due_amount:_0xf8124a,Room_name:_0x157932,primary_code:_0x58c43e,secondary_code:_0x5884f9,MaxStocks_data:_0x353e28,PO_number:_0x18a83f,SCRN:_0x4b61ad,JO_number:_0x52a564}=_0xbf62b7[_0x580241(0x23d)];if(typeof _0x4b0ac2=='string')var _0x24f057=[_0xbf62b7['body']['prod_name']],_0x597982=[_0xbf62b7[_0x580241(0x23d)][_0x580241(0x18b)]],_0x4f5782=[_0xbf62b7['body'][_0x580241(0x1f3)]],_0x4dee05=[_0xbf62b7['body'][_0x580241(0x164)]],_0x24a4bd=[_0xbf62b7['body'][_0x580241(0x169)]],_0x28ca76=[_0xbf62b7[_0x580241(0x23d)]['prod_level']],_0x55e897=[_0xbf62b7[_0x580241(0x23d)][_0x580241(0x154)]],_0x26e87c=[_0xbf62b7['body']['secondary_code']],_0x2c8f40=[_0xbf62b7[_0x580241(0x23d)]['MaxStocks_data']],_0x486716=[_0xbf62b7[_0x580241(0x23d)][_0x580241(0x255)]],_0xfb7fc9=[_0xbf62b7['body'][_0x580241(0x1ae)]],_0xddf2f4=[_0xbf62b7[_0x580241(0x23d)][_0x580241(0x186)]],_0x24afd7=[_0xbf62b7['body']['alertQTY']],_0x52972e=[_0xbf62b7['body'][_0x580241(0x1e7)]],_0x5b6b96=[_0xbf62b7['body']['prod_cat']],_0xe7333e=[_0xbf62b7[_0x580241(0x23d)][_0x580241(0x18a)]],_0x13ac38=[_0xbf62b7[_0x580241(0x23d)]['deliverycode']],_0x4ee771=[_0xbf62b7[_0x580241(0x23d)][_0x580241(0x1be)]],_0x406f98=[_0xbf62b7['body']['actual_qty']],_0x2ed015=[_0xbf62b7[_0x580241(0x23d)][_0x580241(0x183)]];else var _0x24f057=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x15a)]],_0x597982=[..._0xbf62b7[_0x580241(0x23d)]['prod_code']],_0x4f5782=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x1f3)]],_0x4dee05=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x164)]],_0x24a4bd=[..._0xbf62b7[_0x580241(0x23d)]['prod_secondunit']],_0x28ca76=[..._0xbf62b7[_0x580241(0x23d)]['prod_level']],_0x55e897=[..._0xbf62b7['body'][_0x580241(0x154)]],_0x26e87c=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x189)]],_0x2c8f40=[..._0xbf62b7[_0x580241(0x23d)]['MaxStocks_data']],_0x486716=[..._0xbf62b7['body'][_0x580241(0x255)]],_0xfb7fc9=[..._0xbf62b7[_0x580241(0x23d)]['expiry_date']],_0xddf2f4=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x186)]],_0x24afd7=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x23e)]],_0x52972e=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x1e7)]],_0x5b6b96=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x17e)]],_0xe7333e=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x18a)]],_0x13ac38=[..._0xbf62b7['body'][_0x580241(0x16b)]],_0x4ee771=[..._0xbf62b7[_0x580241(0x23d)][_0x580241(0x1be)]],_0x406f98=[..._0xbf62b7['body']['actual_qty']],_0x2ed015=[..._0xbf62b7['body'][_0x580241(0x183)]];const _0xd645e7=_0x24f057[_0x580241(0x13d)](_0x3c95f4=>{return _0x3c95f4={'product_name':_0x3c95f4};});_0x406f98[_0x580241(0x1b5)]((_0x2dcbf0,_0x29e465)=>{_0xd645e7[_0x29e465]['actual_qty']=Math['abs'](_0x2dcbf0);}),_0x2ed015[_0x580241(0x1b5)]((_0x397350,_0x533e9a)=>{var _0x16a1b5=_0x580241;_0xd645e7[_0x533e9a][_0x16a1b5(0x183)]=_0x397350;}),_0x597982[_0x580241(0x1b5)]((_0xff7c89,_0x256681)=>{var _0x328750=_0x580241;_0xd645e7[_0x256681][_0x328750(0x20a)]=_0xff7c89;}),_0x4f5782['forEach']((_0x478d55,_0x4bce66)=>{var _0x3cd305=_0x580241;_0xd645e7[_0x4bce66][_0x3cd305(0x155)]=Math[_0x3cd305(0x1df)](_0x478d55);}),_0x4dee05['forEach']((_0x182b98,_0x27b9b6)=>{var _0x2f2dc0=_0x580241;_0xd645e7[_0x27b9b6][_0x2f2dc0(0x160)]=_0x182b98;}),_0x24a4bd[_0x580241(0x1b5)]((_0x4b3197,_0x161715)=>{var _0x572866=_0x580241;_0xd645e7[_0x161715][_0x572866(0x1f2)]=_0x4b3197;}),_0x28ca76['forEach']((_0x419bdf,_0x14e29a)=>{var _0x27df80=_0x580241;_0xe7333e[_0x27df80(0x1b5)]((_0x4f3176,_0xd33ed5)=>{var _0x13130e=_0x27df80;if(_0x4f3176==_0x13130e(0x236)&&_0x14e29a==_0xd33ed5){console[_0x13130e(0x197)](_0x4f3176+_0x13130e(0x15c)+_0x14e29a+'\x20<>\x20'+_0xd33ed5+'\x20<>\x20'+_0x419bdf);var _0x5648b3=_0x419bdf[_0x13130e(0x212)](0x3);_0xd645e7[_0x14e29a][_0x13130e(0x19e)]=_0x419bdf[0x0],_0xd645e7[_0x14e29a][_0x13130e(0x23f)]=_0x419bdf[0x1],_0xd645e7[_0x14e29a][_0x13130e(0x1e5)]=0x0,_0xd645e7[_0x14e29a]['bin']=0x0,_0xd645e7[_0x14e29a][_0x13130e(0x250)]='Floor',_0xd645e7[_0x14e29a][_0x13130e(0x252)]=_0x5648b3;}else{if(_0x4f3176=='Shelves'&&_0x14e29a==_0xd33ed5){var _0x5648b3=_0x419bdf['slice'](0x3);_0xd645e7[_0x14e29a][_0x13130e(0x19e)]=_0x419bdf[0x0],_0xd645e7[_0x14e29a][_0x13130e(0x23f)]=_0x419bdf[0x1],_0xd645e7[_0x14e29a][_0x13130e(0x1e5)]=0x0,_0xd645e7[_0x14e29a][_0x13130e(0x220)]=0x0,_0xd645e7[_0x14e29a][_0x13130e(0x250)]=_0x13130e(0x25e),_0xd645e7[_0x14e29a][_0x13130e(0x252)]=_0x419bdf[0x5];}else{if(_0x14e29a==_0xd33ed5){if(_0x419bdf[0x0]=='A'&&_0x419bdf[0x1]=='L'&&_0x419bdf[0x2]=='L')console[_0x13130e(0x197)](_0x4f3176+_0x13130e(0x257)+_0x14e29a+'\x20<>\x20'+_0xd33ed5+_0x13130e(0x257)+_0x419bdf+'here'),_0xd645e7[_0x14e29a][_0x13130e(0x19e)]=_0x419bdf[0x0],_0xd645e7[_0x14e29a][_0x13130e(0x23f)]=_0x419bdf[0x1],_0xd645e7[_0x14e29a][_0x13130e(0x1e5)]=0x0,_0xd645e7[_0x14e29a]['bin']=0x0,_0xd645e7[_0x14e29a]['type']='Floor',_0xd645e7[_0x14e29a][_0x13130e(0x252)]=_0x419bdf[0x3];else{var _0x4e9c49;if(_0x419bdf[0x4]=='L')_0x4e9c49=_0x13130e(0x187);else _0x419bdf[0x4]=='F'&&(_0x4e9c49=_0x13130e(0x25e));_0xd645e7[_0x14e29a]['storage']=_0x419bdf[0x0],_0xd645e7[_0x14e29a][_0x13130e(0x23f)]=_0x419bdf[0x1],_0xd645e7[_0x14e29a][_0x13130e(0x1e5)]=_0x419bdf[0x2],_0xd645e7[_0x14e29a][_0x13130e(0x220)]=_0x419bdf[0x3],_0xd645e7[_0x14e29a][_0x13130e(0x250)]=_0x4e9c49,_0xd645e7[_0x14e29a][_0x13130e(0x252)]=_0x419bdf[0x5];}}}}});}),_0x55e897[_0x580241(0x1b5)]((_0x4a67fd,_0x5d078f)=>{_0xd645e7[_0x5d078f]['primary_code']=_0x4a67fd;}),_0x26e87c['forEach']((_0x15961c,_0x38f096)=>{var _0x41daa8=_0x580241;_0xd645e7[_0x38f096][_0x41daa8(0x189)]=_0x15961c;}),_0x2c8f40[_0x580241(0x1b5)]((_0x112319,_0x4dddbd)=>{var _0x370461=_0x580241;_0xd645e7[_0x4dddbd][_0x370461(0x210)]=_0x112319;}),_0x486716[_0x580241(0x1b5)]((_0x43a6b2,_0x361073)=>{_0xd645e7[_0x361073]['batch_code']=_0x43a6b2;}),_0xfb7fc9[_0x580241(0x1b5)]((_0xdedec9,_0x5af4bd)=>{var _0x35e726=_0x580241;_0xd645e7[_0x5af4bd][_0x35e726(0x1ae)]=_0xdedec9;}),_0xddf2f4[_0x580241(0x1b5)]((_0x2c69e8,_0x599a47)=>{_0xd645e7[_0x599a47]['maxperunit']=_0x2c69e8;}),_0x24afd7['forEach']((_0x1246fe,_0x38ff5e)=>{var _0x4de1e8=_0x580241;_0xd645e7[_0x38ff5e][_0x4de1e8(0x23e)]=_0x1246fe;}),_0x52972e[_0x580241(0x1b5)]((_0x4908f0,_0x74db7c)=>{_0xd645e7[_0x74db7c]['production_date']=_0x4908f0;}),_0x5b6b96[_0x580241(0x1b5)]((_0x4ca3ae,_0xded367)=>{var _0xf9a74a=_0x580241;_0xd645e7[_0xded367][_0xf9a74a(0x1e0)]=_0x4ca3ae;}),_0xe7333e['forEach']((_0x3fc2b3,_0x8fb0c4)=>{_0xd645e7[_0x8fb0c4]['room_name']=_0x3fc2b3;}),_0x13ac38[_0x580241(0x1b5)]((_0x27c2f9,_0x2ef7fb)=>{var _0x59ae78=_0x580241;_0xd645e7[_0x2ef7fb][_0x59ae78(0x201)]=_0x27c2f9;}),_0x4ee771['forEach']((_0x45657d,_0x257f64)=>{var _0x1c184e=_0x580241;_0xd645e7[_0x257f64][_0x1c184e(0x1af)]=_0x45657d;});const _0x112686=_0xe7333e[_0x580241(0x13d)](_0x2c8dd4=>{return _0x2c8dd4={'room_name':_0x2c8dd4};}),_0x421bee=_0xd645e7[_0x580241(0x1d9)](_0x437849=>_0x437849[_0x580241(0x155)]!=='0'&&_0x437849[_0x580241(0x155)]!==''),_0x289079=new purchases({'invoice':_0x1e08e9,'suppliers':_0xbf62b7[_0x580241(0x23d)][_0x580241(0x196)],'date':_0x144380,'warehouse_name':_0x58ac5e,'product':_0x421bee,'note':_0x1ea735,'due_amount':_0xf8124a,'POnumber':_0x18a83f,'SCRN':_0x4b61ad,'JO_number':_0x52a564,'roomList':_0x112686}),_0x3d4789=await _0x289079[_0x580241(0x1d7)](),_0x35d64a=await purchases['findOne']({'invoice':_0x1e08e9}),_0x2898a4=_0x35d64a['product'][_0x580241(0x13d)](async _0x3f6e71=>{var _0x1dd746=_0x580241,_0x4fe194=await warehouse[_0x1dd746(0x1c5)]({'name':_0x58ac5e,'room':_0x3f6e71['room_name']}),_0x5ac443=0x0;return _0x4fe194[_0x1dd746(0x24c)][_0x1dd746(0x1b5)](_0x298885=>{var _0x16f491=_0x1dd746;_0x298885[_0x16f491(0x14f)]==_0x3f6e71[_0x16f491(0x14f)]&&_0x298885[_0x16f491(0x252)]==_0x3f6e71['floorlevel']&&_0x298885[_0x16f491(0x250)]==_0x3f6e71[_0x16f491(0x250)]&&_0x298885[_0x16f491(0x220)]==_0x3f6e71[_0x16f491(0x220)]&&_0x298885[_0x16f491(0x1e5)]==_0x3f6e71[_0x16f491(0x1e5)]&&_0x298885[_0x16f491(0x23f)]==_0x3f6e71['rack']&&_0x298885[_0x16f491(0x19e)]==_0x3f6e71[_0x16f491(0x19e)]&&_0x298885['expiry_date']==_0x3f6e71[_0x16f491(0x1ae)]&&_0x298885['batch_code']==_0x3f6e71[_0x16f491(0x255)]&&_0x298885[_0x16f491(0x1e7)]==_0x3f6e71[_0x16f491(0x1e7)]&&_0x298885[_0x16f491(0x1af)]==_0x35d64a['invoice']&&(_0x298885[_0x16f491(0x235)]+=Math[_0x16f491(0x1df)](_0x3f6e71[_0x16f491(0x155)]),_0x5ac443++);}),_0x5ac443===0x0&&_0x4fe194['product_details'][_0x1dd746(0x1e1)]({'product_name':_0x3f6e71[_0x1dd746(0x14f)],'product_stock':Math['abs'](_0x3f6e71[_0x1dd746(0x155)]),'primary_code':_0x3f6e71['primary_code'],'secondary_code':_0x3f6e71['secondary_code'],'product_code':_0x3f6e71[_0x1dd746(0x20a)],'storage':_0x3f6e71['storage'],'rack':_0x3f6e71[_0x1dd746(0x23f)],'bay':_0x3f6e71[_0x1dd746(0x1e5)],'bin':_0x3f6e71[_0x1dd746(0x220)],'type':_0x3f6e71[_0x1dd746(0x250)],'floorlevel':_0x3f6e71[_0x1dd746(0x252)],'maxProducts':_0x3f6e71[_0x1dd746(0x210)],'unit':_0x3f6e71[_0x1dd746(0x160)],'secondary_unit':_0x3f6e71[_0x1dd746(0x1f2)],'expiry_date':_0x3f6e71[_0x1dd746(0x1ae)],'maxPerUnit':_0x3f6e71[_0x1dd746(0x161)],'batch_code':_0x3f6e71[_0x1dd746(0x255)],'alertQTY':_0x3f6e71['alertQTY'],'production_date':_0x3f6e71[_0x1dd746(0x1e7)],'product_cat':_0x3f6e71[_0x1dd746(0x1e0)],'invoice':_0x3f6e71[_0x1dd746(0x1af)],'actual_qty':Math[_0x1dd746(0x1df)](_0x3f6e71[_0x1dd746(0x1dc)]),'actual_uom':_0x3f6e71[_0x1dd746(0x183)]}),_0x4fe194;});Promise[_0x580241(0x208)](_0x2898a4)[_0x580241(0x1cc)](async _0x104292=>{var _0x2e5cb5=_0x580241;try{for(const _0xa48d24 of _0x104292){await _0xa48d24[_0x2e5cb5(0x1d7)]();}const _0xba9825=await master_shop['find'](),_0x52e014=await email_settings[_0x2e5cb5(0x1c5)](),_0x4a1ae1=await supervisor_settings['find']();var _0x17cff1=_0x35d64a[_0x2e5cb5(0x213)],_0x6d6527='',_0x144881;for(_0x144881 in _0x17cff1){_0x6d6527+=_0x2e5cb5(0x1fd)+_0x2e5cb5(0x23a)+_0x17cff1[_0x144881]['product_name']+'</td>'+_0x2e5cb5(0x23a)+_0x17cff1[_0x144881]['product_code']+_0x2e5cb5(0x20b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x17cff1[_0x144881][_0x2e5cb5(0x155)]+_0x2e5cb5(0x20b)+_0x2e5cb5(0x23a)+_0x17cff1[_0x144881]['standard_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x17cff1[_0x144881][_0x2e5cb5(0x1f2)]+_0x2e5cb5(0x20b)+_0x2e5cb5(0x23a)+_0x35d64a[_0x2e5cb5(0x153)]+_0x2e5cb5(0x20b)+_0x2e5cb5(0x23a)+_0x17cff1[_0x144881][_0x2e5cb5(0x159)]+_0x2e5cb5(0x20b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x17cff1[_0x144881][_0x2e5cb5(0x19e)]+_0x17cff1[_0x144881][_0x2e5cb5(0x23f)]+_0x17cff1[_0x144881][_0x2e5cb5(0x1e5)]+_0x17cff1[_0x144881][_0x2e5cb5(0x220)]+_0x17cff1[_0x144881]['type'][0x0]+_0x17cff1[_0x144881][_0x2e5cb5(0x252)]+_0x2e5cb5(0x20b),_0x2e5cb5(0x166);}let _0x416ae1=nodemailer[_0x2e5cb5(0x16f)]({'host':_0x52e014[_0x2e5cb5(0x1d5)],'port':Number(_0x52e014[_0x2e5cb5(0x1d2)]),'secure':![],'auth':{'user':_0x52e014[_0x2e5cb5(0x240)],'pass':_0x52e014[_0x2e5cb5(0x173)]}}),_0x40d083={'from':_0x52e014[_0x2e5cb5(0x240)],'to':_0x4a1ae1[0x0][_0x2e5cb5(0x241)],'subject':'Purchase\x20Mail','attachments':[{'filename':_0x2e5cb5(0x221),'path':__dirname+_0x2e5cb5(0x1b0)+_0x2e5cb5(0x142)+_0xba9825[0x0][_0x2e5cb5(0x21d)],'cid':_0x2e5cb5(0x1e8)}],'html':'<!DOCTYPE\x20html>'+_0x2e5cb5(0x16c)+_0x2e5cb5(0x1a1)+_0x2e5cb5(0x171)+_0x2e5cb5(0x22b)+_0x2e5cb5(0x171)+_0x2e5cb5(0x21b)+_0x2e5cb5(0x162)+'<div>'+_0x2e5cb5(0x145)+_0xba9825[0x0]['site_title']+_0x2e5cb5(0x20f)+_0x2e5cb5(0x162)+_0x2e5cb5(0x162)+_0x2e5cb5(0x251)+_0x2e5cb5(0x171)+_0x2e5cb5(0x1a3)+_0x2e5cb5(0x1a9)+_0x35d64a['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2e5cb5(0x217)+_0x35d64a['date']+'\x20'+_0x2e5cb5(0x180)+'</h5>'+_0x2e5cb5(0x162)+_0x2e5cb5(0x1ab)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x2e5cb5(0x167)+_0x2e5cb5(0x204)+_0x2e5cb5(0x1eb)+_0x2e5cb5(0x22e)+_0x2e5cb5(0x24a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2e5cb5(0x166)+_0x2e5cb5(0x20c)+_0x2e5cb5(0x253)+'\x20'+_0x6d6527+'\x20'+_0x2e5cb5(0x1c7)+_0x2e5cb5(0x184)+_0x2e5cb5(0x171)+_0x2e5cb5(0x15d)+_0x2e5cb5(0x207)+_0xba9825[0x0][_0x2e5cb5(0x1a8)]+'</h5>'+'</div>'+'</div>'+'</body></html>'};_0x416ae1[_0x2e5cb5(0x225)](_0x40d083,function(_0x3f0527,_0x2eb394){var _0x4ad0c6=_0x2e5cb5;_0x3f0527?(console[_0x4ad0c6(0x197)](_0x3f0527),console[_0x4ad0c6(0x197)](_0x4ad0c6(0x1b2))):console[_0x4ad0c6(0x197)](_0x4ad0c6(0x238));}),_0xbf62b7['flash'](_0x2e5cb5(0x1cd),_0x2e5cb5(0x254)),_0x40ddf6[_0x2e5cb5(0x17a)]('/all_purchases/view/');}catch(_0x48689d){console[_0x2e5cb5(0x22f)](_0x48689d),_0x40ddf6[_0x2e5cb5(0x1ad)](0x1f4)[_0x2e5cb5(0x231)]({'error':_0x2e5cb5(0x193)});}})[_0x580241(0x258)](_0x100dab=>{var _0x4fcb4e=_0x580241;console[_0x4fcb4e(0x22f)](_0x100dab),_0x40ddf6[_0x4fcb4e(0x1ad)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x29ecc9){console['log'](_0x29ecc9);}}),router[a0_0x5698bf(0x21c)](a0_0x5698bf(0x1b4),auth,async(_0x3d9d11,_0xe4be58)=>{var _0x382140=a0_0x5698bf;try{const {username:_0x1ad3a7,email:_0x57b68a,role:_0x55d9c9}=_0x3d9d11['user'],_0x536d0a=_0x3d9d11[_0x382140(0x1aa)],_0x261b98=await profile[_0x382140(0x1c5)]({'email':_0x536d0a[_0x382140(0x240)]}),_0x334697=await master_shop['find'](),_0x119968=_0x3d9d11[_0x382140(0x163)]['id'],_0x1394a4=await purchases[_0x382140(0x1dd)](_0x119968),_0x17302e=await warehouse[_0x382140(0x1a4)]([{'$match':{'name':_0x1394a4['warehouse_name'],'room':_0x1394a4[_0x382140(0x19d)]}},{'$unwind':_0x382140(0x22d)},{'$group':{'_id':_0x382140(0x1e9),'name':{'$first':_0x382140(0x150)},'product_stock':{'$first':_0x382140(0x1b8)},'bay':{'$first':_0x382140(0x1ff)},'bin':{'$first':_0x382140(0x191)},'type':{'$first':_0x382140(0x15f)},'floorlevel':{'$first':_0x382140(0x14b)},'primary_code':{'$first':_0x382140(0x259)},'secondary_code':{'$first':_0x382140(0x185)},'product_code':{'$first':_0x382140(0x1c0)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x382140(0x1ec)},'expiry_date':{'$first':_0x382140(0x246)}}}]),_0x5bc37b=await customer[_0x382140(0x1ef)]({});let _0x535a38;if(_0x536d0a[_0x382140(0x20e)]==_0x382140(0x158)){const _0x5ea4d7=await staff[_0x382140(0x1c5)]({'email':_0x536d0a[_0x382140(0x240)]});_0x535a38=await warehouse[_0x382140(0x1a4)]([{'$match':{'status':_0x382140(0x19b),'name':_0x5ea4d7['warehouse']}},{'$group':{'_id':_0x382140(0x15e),'name':{'$first':_0x382140(0x15e)}}}]);}else _0x535a38=await warehouse[_0x382140(0x1a4)]([{'$match':{'status':_0x382140(0x19b)}},{'$group':{'_id':_0x382140(0x15e),'name':{'$first':'$name'}}}]);const _0x4f7e19=await product[_0x382140(0x1ef)]({}),_0x421c2d=await suppliers['find']({}),_0xe971f4=BayBinSelected(_0x1394a4['warehouse_name'],_0x1394a4[_0x382140(0x19d)]);if(_0x334697[0x0][_0x382140(0x1e6)]==_0x382140(0x1c1)){var _0x2aa9f5=users['English'];console[_0x382140(0x197)](_0x2aa9f5);}else{if(_0x334697[0x0]['language']==_0x382140(0x192))var _0x2aa9f5=users[_0x382140(0x192)];else{if(_0x334697[0x0][_0x382140(0x1e6)]==_0x382140(0x215))var _0x2aa9f5=users[_0x382140(0x215)];else{if(_0x334697[0x0]['language']==_0x382140(0x1bc))var _0x2aa9f5=users[_0x382140(0x1bc)];else{if(_0x334697[0x0][_0x382140(0x1e6)]==_0x382140(0x237))var _0x2aa9f5=users[_0x382140(0x237)];else{if(_0x334697[0x0][_0x382140(0x1e6)]==_0x382140(0x1ea))var _0x2aa9f5=users[_0x382140(0x13a)];else{if(_0x334697[0x0]['language']=='Chinese')var _0x2aa9f5=users['Chinese'];else{if(_0x334697[0x0]['language']==_0x382140(0x19f))var _0x2aa9f5=users[_0x382140(0x230)];}}}}}}}_0xe4be58[_0x382140(0x232)](_0x382140(0x199),{'success':_0x3d9d11[_0x382140(0x1a2)](_0x382140(0x1cd)),'errors':_0x3d9d11[_0x382140(0x1a2)](_0x382140(0x19a)),'role':_0x536d0a,'profile':_0x261b98,'customer':_0x5bc37b,'warehouse':_0x535a38,'product':_0x17302e,'user':_0x1394a4,'master_shop':_0x334697,'unit':_0x4f7e19,'language':_0x2aa9f5,'suppliers':_0x421c2d,'dataSelected':_0xe971f4});}catch(_0x585db){console[_0x382140(0x197)](_0x585db);}}),router[a0_0x5698bf(0x227)]('/preview/:id',auth,async(_0x321d61,_0x20540a)=>{var _0x3b1210=a0_0x5698bf;try{const _0x5663d5=_0x321d61['params']['id'],{invoice:_0x2dc7f4,warehouse_name:_0x1f405e,Room_name:_0x32bb5f}=_0x321d61['body'],_0x176f6f=await warehouse['findOne']({'name':_0x1f405e,'room':_0x32bb5f}),_0x159b92=await purchases['findOne']({'invoice':_0x2dc7f4});_0x159b92[_0x3b1210(0x213)][_0x3b1210(0x1b5)](_0x4c3f4b=>{var _0x16554a=_0x3b1210,_0x3a03df=0x0;const _0x25260f=_0x176f6f[_0x16554a(0x24c)][_0x16554a(0x13d)](_0x28b6dd=>{var _0x2916c2=_0x16554a;_0x28b6dd['product_name']==_0x4c3f4b[_0x2916c2(0x14f)]&&_0x28b6dd[_0x2916c2(0x252)]==_0x4c3f4b[_0x2916c2(0x252)]&&_0x28b6dd[_0x2916c2(0x250)]==_0x4c3f4b['type']&&_0x28b6dd[_0x2916c2(0x220)]==_0x4c3f4b['bin']&&_0x28b6dd['bay']==_0x4c3f4b['bay']&&_0x28b6dd[_0x2916c2(0x23f)]==_0x4c3f4b[_0x2916c2(0x23f)]&&_0x28b6dd['storage']==_0x4c3f4b['storage']&&_0x28b6dd[_0x2916c2(0x1ae)]==_0x4c3f4b[_0x2916c2(0x1ae)]&&_0x28b6dd[_0x2916c2(0x255)]==_0x4c3f4b[_0x2916c2(0x255)]&&_0x28b6dd[_0x2916c2(0x1e7)]==_0x4c3f4b[_0x2916c2(0x1e7)]&&_0x28b6dd['delivery_date']==_0x4c3f4b[_0x2916c2(0x24e)]&&_0x28b6dd['delivery_code']==_0x4c3f4b['delivery_code']&&(_0x28b6dd[_0x2916c2(0x235)]=parseInt(_0x28b6dd[_0x2916c2(0x235)])+parseInt(_0x4c3f4b['quantity']),_0x3a03df++);});_0x3a03df=='0'&&(_0x176f6f[_0x16554a(0x24c)]=_0x176f6f['product_details'][_0x16554a(0x18e)]({'product_name':_0x4c3f4b[_0x16554a(0x14f)],'product_stock':_0x4c3f4b[_0x16554a(0x155)],'primary_code':_0x4c3f4b[_0x16554a(0x154)],'secondary_code':_0x4c3f4b[_0x16554a(0x189)],'product_code':_0x4c3f4b[_0x16554a(0x20a)],'storage':_0x4c3f4b[_0x16554a(0x19e)],'rack':_0x4c3f4b[_0x16554a(0x23f)],'bay':_0x4c3f4b[_0x16554a(0x1e5)],'bin':_0x4c3f4b[_0x16554a(0x220)],'type':_0x4c3f4b[_0x16554a(0x250)],'floorlevel':_0x4c3f4b[_0x16554a(0x252)],'maxProducts':_0x4c3f4b['maxStocks'],'unit':_0x4c3f4b[_0x16554a(0x160)],'secondary_unit':_0x4c3f4b[_0x16554a(0x1f2)],'expiry_date':_0x4c3f4b[_0x16554a(0x1ae)],'maxPerUnit':_0x4c3f4b[_0x16554a(0x161)],'batch_code':_0x4c3f4b[_0x16554a(0x255)],'alertQTY':_0x4c3f4b[_0x16554a(0x23e)],'production_date':_0x4c3f4b[_0x16554a(0x1e7)],'delivery_date':_0x4c3f4b[_0x16554a(0x24e)],'delivery_code':_0x4c3f4b[_0x16554a(0x201)]}));}),await _0x176f6f[_0x3b1210(0x1d7)](),_0x159b92[_0x3b1210(0x181)]=_0x3b1210(0x1f6);const _0x1f2835=await _0x159b92['save']();_0x321d61[_0x3b1210(0x1a2)](_0x3b1210(0x1cd),'Sales\x20Update\x20successfully'),_0x20540a[_0x3b1210(0x17a)](_0x3b1210(0x25f));}catch(_0x260d27){console[_0x3b1210(0x197)](_0x260d27);}}),router[a0_0x5698bf(0x21c)](a0_0x5698bf(0x24f),auth,async(_0x149f9d,_0x2ba5cc)=>{var _0x4b4e97=a0_0x5698bf;try{const {username:_0x5c1763,email:_0xc4ba5,role:_0x4ec502}=_0x149f9d[_0x4b4e97(0x1aa)],_0x5015b6=_0x149f9d[_0x4b4e97(0x1aa)],_0x2c9f69=await profile[_0x4b4e97(0x1c5)]({'email':_0x5015b6[_0x4b4e97(0x240)]}),_0x2692ed=await master_shop[_0x4b4e97(0x1ef)](),_0x39763a=_0x149f9d['params']['id'],_0xca217d=await purchases[_0x4b4e97(0x1dd)](_0x39763a),_0x881d84=await suppliers[_0x4b4e97(0x1ef)]({});let _0x3a2466;if(_0x5015b6[_0x4b4e97(0x20e)]=='staff'){const _0x3b950e=await staff[_0x4b4e97(0x1c5)]({'email':_0x5015b6['email']});_0x3a2466=await warehouse['find']({'status':_0x4b4e97(0x19b),'name':_0x3b950e[_0x4b4e97(0x1d3)],'warehouse_category':'Raw\x20Materials'});}else _0x3a2466=await warehouse[_0x4b4e97(0x1a4)]([{'$match':{'status':_0x4b4e97(0x19b),'warehouse_category':_0x4b4e97(0x176)}},{'$group':{'_id':_0x4b4e97(0x15e),'name':{'$first':'$name'}}}]);const _0x12111a=await product['find']({}),_0x4a6a65=BayBinSelected(_0xca217d['warehouse_name'],_0xca217d[_0x4b4e97(0x19d)]);let _0x4f02db=new Date(_0xca217d['expiry_date']),_0x31ebfa=('0'+_0x4f02db[_0x4b4e97(0x205)]())[_0x4b4e97(0x212)](-0x2),_0x49afa3=('0'+(_0x4f02db[_0x4b4e97(0x1de)]()+0x1))['slice'](-0x2),_0x5b4fab=_0x4f02db[_0x4b4e97(0x1c4)](),_0xdf5aea=_0x5b4fab+'-'+_0x49afa3+'-'+_0x31ebfa;if(_0x2692ed[0x0][_0x4b4e97(0x1e6)]==_0x4b4e97(0x1c1)){var _0x38ebe3=users['English'];console[_0x4b4e97(0x197)](_0x38ebe3);}else{if(_0x2692ed[0x0][_0x4b4e97(0x1e6)]==_0x4b4e97(0x192))var _0x38ebe3=users['Hindi'];else{if(_0x2692ed[0x0][_0x4b4e97(0x1e6)]==_0x4b4e97(0x215))var _0x38ebe3=users[_0x4b4e97(0x215)];else{if(_0x2692ed[0x0][_0x4b4e97(0x1e6)]==_0x4b4e97(0x1bc))var _0x38ebe3=users[_0x4b4e97(0x1bc)];else{if(_0x2692ed[0x0]['language']==_0x4b4e97(0x237))var _0x38ebe3=users[_0x4b4e97(0x237)];else{if(_0x2692ed[0x0]['language']=='Portuguese\x20(BR)')var _0x38ebe3=users[_0x4b4e97(0x13a)];else{if(_0x2692ed[0x0][_0x4b4e97(0x1e6)]==_0x4b4e97(0x1ed))var _0x38ebe3=users[_0x4b4e97(0x1ed)];else{if(_0x2692ed[0x0][_0x4b4e97(0x1e6)]==_0x4b4e97(0x19f))var _0x38ebe3=users['Arabic'];}}}}}}}_0x2ba5cc[_0x4b4e97(0x232)](_0x4b4e97(0x22c),{'success':_0x149f9d[_0x4b4e97(0x1a2)](_0x4b4e97(0x1cd)),'errors':_0x149f9d[_0x4b4e97(0x1a2)](_0x4b4e97(0x19a)),'role':_0x5015b6,'profile':_0x2c9f69,'purchases':_0xca217d,'suppliers':_0x881d84,'warehouse':_0x3a2466,'product':_0x12111a,'master_shop':_0x2692ed,'language':_0x38ebe3,'ed_fullDate':_0xdf5aea,'dataSelected':_0x4a6a65});}catch(_0x547213){console[_0x4b4e97(0x197)](_0x547213);}}),router[a0_0x5698bf(0x227)]('/view/:id',auth,async(_0x345977,_0x1f9259)=>{var _0x17a716=a0_0x5698bf;try{const _0x2441ad=_0x345977[_0x17a716(0x163)]['id'],_0x8f08b6=await purchases[_0x17a716(0x1c5)]({'_id':_0x345977[_0x17a716(0x163)]['id']}),_0x3d1961=await warehouse['findOne']({'name':_0x8f08b6[_0x17a716(0x153)],'room':_0x8f08b6[_0x17a716(0x19d)]});_0x8f08b6[_0x17a716(0x213)]['forEach'](_0xfc5440=>{var _0x43782b=_0x17a716;const _0x2909c0=_0x3d1961[_0x43782b(0x24c)]['map'](_0x5a483e=>{var _0x4134cb=_0x43782b;_0x5a483e[_0x4134cb(0x14f)]==_0xfc5440[_0x4134cb(0x14f)]&&_0x5a483e['floorlevel']==_0xfc5440[_0x4134cb(0x252)]&&_0x5a483e[_0x4134cb(0x250)]==_0xfc5440[_0x4134cb(0x250)]&&_0x5a483e['bin']==_0xfc5440['bin']&&_0x5a483e[_0x4134cb(0x1e5)]==_0xfc5440[_0x4134cb(0x1e5)]&&_0x5a483e[_0x4134cb(0x23f)]==_0xfc5440[_0x4134cb(0x23f)]&&_0x5a483e[_0x4134cb(0x19e)]==_0xfc5440[_0x4134cb(0x19e)]&&(_0x5a483e['product_stock']=parseInt(_0x5a483e[_0x4134cb(0x235)])-parseInt(_0xfc5440[_0x4134cb(0x155)]));});}),await _0x3d1961[_0x17a716(0x1d7)]();const {invoice:_0xc1e71,suppliers:_0x3ae809,date:_0x1f515c,warehouse_name:_0x19fae7,prod_name:_0x25bebe,prod_code:_0x1721fd,prod_qty:_0x424311,prod_unit:_0x20130e,prod_secondunit:_0x1c85da,prod_level:_0xeb2958,prod_isle:_0x46c1d9,prod_pallet:_0x3f04f4,note:_0x2b384,expiry_date:_0x439a1b,batch_code:_0xff076e,paid_amount:_0x1bbc26,due_amount:_0x18f93f,Room_name:_0x376570,primary_code:_0x4b01c0,secondary_code:_0x4dfd8e,PO_number:_0x55db7e,JO_number:_0x32d3bb}=_0x345977['body'];if(typeof _0x25bebe==_0x17a716(0x16a))var _0x30f3db=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x15a)]],_0x3d06cc=[_0x345977['body'][_0x17a716(0x18b)]],_0x29fa49=[_0x345977[_0x17a716(0x23d)]['prod_qty']],_0x58a99d=[_0x345977[_0x17a716(0x23d)]['prod_unit']],_0x5f258f=[_0x345977[_0x17a716(0x23d)]['prod_secondunit']],_0x5d9b4c=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x223)]],_0x4d9b01=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x248)]],_0x5d53aa=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x148)]],_0x3a30f4=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x154)]],_0x3c7f80=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x189)]],_0x230560=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x21e)]],_0x53c931=[_0x345977['body']['batch_code']],_0x10eb88=[_0x345977['body']['expiry_date']],_0x5e425e=[_0x345977['body'][_0x17a716(0x19e)]],_0x4c4166=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x16e)]],_0x328ea4=[_0x345977[_0x17a716(0x23d)][_0x17a716(0x250)]];else var _0x30f3db=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x15a)]],_0x3d06cc=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x18b)]],_0x29fa49=[..._0x345977['body']['prod_qty']],_0x58a99d=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x1b1)]],_0x5f258f=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x169)]],_0x5d9b4c=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x223)]],_0x4d9b01=[..._0x345977['body'][_0x17a716(0x248)]],_0x5d53aa=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x148)]],_0x3a30f4=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x154)]],_0x3c7f80=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x189)]],_0x230560=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x21e)]],_0x53c931=[..._0x345977[_0x17a716(0x23d)]['batch_code']],_0x10eb88=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x1ae)]],_0x5e425e=[..._0x345977[_0x17a716(0x23d)][_0x17a716(0x19e)]],_0x4c4166=[..._0x345977['body'][_0x17a716(0x16e)]],_0x328ea4=[..._0x345977[_0x17a716(0x23d)]['type']];const _0x366f69=_0x30f3db[_0x17a716(0x13d)](_0x2ade37=>{return _0x2ade37={'product_name':_0x2ade37};});_0x3d06cc[_0x17a716(0x1b5)]((_0xc88426,_0x190bff)=>{var _0x51687e=_0x17a716;_0x366f69[_0x190bff][_0x51687e(0x20a)]=_0xc88426;}),_0x29fa49[_0x17a716(0x1b5)]((_0x146325,_0x11628a)=>{var _0x2477f3=_0x17a716;_0x366f69[_0x11628a][_0x2477f3(0x155)]=_0x146325;}),_0x58a99d[_0x17a716(0x1b5)]((_0x267d9b,_0x3e8722)=>{var _0x2680e5=_0x17a716;_0x366f69[_0x3e8722][_0x2680e5(0x160)]=_0x267d9b;}),_0x5f258f['forEach']((_0x4305ee,_0x39ca44)=>{var _0x73a718=_0x17a716;_0x366f69[_0x39ca44][_0x73a718(0x1f2)]=_0x4305ee;}),_0x5d9b4c['forEach']((_0x40d50c,_0x3e4732)=>{_0x366f69[_0x3e4732]['bay']=_0x40d50c;}),_0x4d9b01[_0x17a716(0x1b5)]((_0x44f8e1,_0x19fa08)=>{_0x366f69[_0x19fa08]['bin']=_0x44f8e1;}),_0x5d53aa['forEach']((_0x53c261,_0x320836)=>{var _0x2b467b=_0x17a716;_0x366f69[_0x320836][_0x2b467b(0x252)]=_0x53c261;}),_0x3a30f4[_0x17a716(0x1b5)]((_0x3cb32f,_0x58f874)=>{var _0x1929c4=_0x17a716;_0x366f69[_0x58f874][_0x1929c4(0x154)]=_0x3cb32f;}),_0x3c7f80[_0x17a716(0x1b5)]((_0x5ca63c,_0x3a55ed)=>{var _0xcfb4c3=_0x17a716;_0x366f69[_0x3a55ed][_0xcfb4c3(0x189)]=_0x5ca63c;}),_0x230560['forEach']((_0x3ade29,_0x3cd746)=>{var _0x539fcb=_0x17a716;_0x366f69[_0x3cd746][_0x539fcb(0x210)]=_0x3ade29;}),_0x53c931['forEach']((_0x1fcef4,_0x5e65f9)=>{var _0xb41998=_0x17a716;_0x366f69[_0x5e65f9][_0xb41998(0x255)]=_0x1fcef4;}),_0x10eb88['forEach']((_0x1e7955,_0x1e220f)=>{var _0x9b2d8=_0x17a716;_0x366f69[_0x1e220f][_0x9b2d8(0x1ae)]=_0x1e7955;}),_0x328ea4[_0x17a716(0x1b5)]((_0x39c2a2,_0x49697b)=>{var _0x1ddb74=_0x17a716;_0x366f69[_0x49697b][_0x1ddb74(0x250)]=_0x39c2a2;}),_0x5e425e[_0x17a716(0x1b5)]((_0x4edf7d,_0x51c663)=>{var _0x5bb659=_0x17a716;_0x366f69[_0x51c663][_0x5bb659(0x19e)]=_0x4edf7d;}),_0x4c4166['forEach']((_0x6be45f,_0xe72fd9)=>{var _0xbb9d22=_0x17a716;_0x366f69[_0xe72fd9][_0xbb9d22(0x23f)]=_0x6be45f;});const _0x55cf67=_0x366f69[_0x17a716(0x1d9)](_0x596eb9=>_0x596eb9[_0x17a716(0x155)]!=='0'&&_0x596eb9['quantity']!=='');_0x8f08b6[_0x17a716(0x1af)]=_0xc1e71,_0x8f08b6[_0x17a716(0x196)]=_0x3ae809,_0x8f08b6[_0x17a716(0x242)]=_0x1f515c,_0x8f08b6[_0x17a716(0x153)]=_0x19fae7,_0x8f08b6[_0x17a716(0x213)]=_0x55cf67,_0x8f08b6[_0x17a716(0x1cf)]=_0x2b384,_0x8f08b6[_0x17a716(0x175)]=_0x1bbc26,_0x8f08b6[_0x17a716(0x1c6)]=_0x18f93f,_0x8f08b6[_0x17a716(0x19d)]=_0x376570,_0x8f08b6[_0x17a716(0x1a6)]=_0x55db7e,_0x8f08b6[_0x17a716(0x1f5)]=_0x32d3bb;const _0x201100=await _0x8f08b6[_0x17a716(0x1d7)](),_0x38fda6=await warehouse[_0x17a716(0x1c5)]({'name':_0x345977['body']['warehouse_name'],'room':_0x345977[_0x17a716(0x23d)][_0x17a716(0x1ce)]});_0x8f08b6['product'][_0x17a716(0x1b5)](_0x3fd454=>{var _0x8e65c8=_0x17a716,_0x3502a9=0x0;const _0x5500d6=_0x38fda6[_0x8e65c8(0x24c)]['map'](_0x3c57fd=>{var _0x1df333=_0x8e65c8;_0x3c57fd[_0x1df333(0x14f)]==_0x3fd454[_0x1df333(0x14f)]&&_0x3c57fd[_0x1df333(0x252)]==_0x3fd454[_0x1df333(0x252)]&&_0x3c57fd[_0x1df333(0x250)]==_0x3fd454[_0x1df333(0x250)]&&_0x3c57fd[_0x1df333(0x220)]==_0x3fd454[_0x1df333(0x220)]&&_0x3c57fd[_0x1df333(0x1e5)]==_0x3fd454['bay']&&_0x3c57fd['rack']==_0x3fd454[_0x1df333(0x23f)]&&_0x3c57fd[_0x1df333(0x19e)]==_0x3fd454[_0x1df333(0x19e)]&&(_0x3c57fd[_0x1df333(0x235)]=parseInt(_0x3c57fd[_0x1df333(0x235)])+parseInt(_0x3fd454[_0x1df333(0x155)]),_0x3502a9++);});_0x3502a9=='0'&&(_0x38fda6['product_details']=_0x38fda6[_0x8e65c8(0x24c)][_0x8e65c8(0x18e)]({'product_name':_0x3fd454['product_name'],'product_stock':_0x3fd454[_0x8e65c8(0x155)],'primary_code':_0x3fd454[_0x8e65c8(0x154)],'secondary_code':_0x3fd454[_0x8e65c8(0x189)],'product_code':_0x3fd454[_0x8e65c8(0x20a)],'storage':_0x3fd454[_0x8e65c8(0x19e)],'rack':_0x3fd454[_0x8e65c8(0x23f)],'bay':_0x3fd454[_0x8e65c8(0x1e5)],'bin':_0x3fd454[_0x8e65c8(0x220)],'type':_0x3fd454[_0x8e65c8(0x250)],'floorlevel':_0x3fd454[_0x8e65c8(0x252)],'maxProducts':_0x3fd454[_0x8e65c8(0x210)],'unit':_0x3fd454[_0x8e65c8(0x160)],'secondary_unit':_0x3fd454['secondary_unit'],'expiry_date':_0x3fd454[_0x8e65c8(0x1ae)]}));}),await _0x38fda6['save']();const _0x5005c7=await s_payment_data[_0x17a716(0x1c5)]({'invoice':_0x345977['body'][_0x17a716(0x1af)]});if(_0x5005c7===null){}else console['log'](_0x17a716(0x196),_0x5005c7,_0x345977[_0x17a716(0x23d)][_0x17a716(0x1af)]),_0x5005c7['suppliers']=_0x345977[_0x17a716(0x23d)][_0x17a716(0x196)],await _0x5005c7[_0x17a716(0x1d7)]();_0x345977['flash'](_0x17a716(0x1cd),'purchase\x20data\x20update\x20successfully'),_0x1f9259[_0x17a716(0x17a)]('/all_purchases/view');}catch(_0x38cf4f){console['log'](_0x38cf4f);}}),router['post'](a0_0x5698bf(0x244),auth,async(_0x426b56,_0x269d68)=>{var _0x32df01=a0_0x5698bf;try{const _0x500806=_0x426b56['params']['id'],{invoice:_0x32f25f,suppliers:_0x4c4b28,payable:_0xb2d0be,due_amount:_0x1b0127}=_0x426b56[_0x32df01(0x23d)],_0xc09b7d=await purchases['findById'](_0x500806);var _0x707827=_0xb2d0be-_0x1b0127;_0xc09b7d[_0x32df01(0x175)]=parseFloat(_0xc09b7d['paid_amount'])+parseFloat(_0x1b0127),_0xc09b7d[_0x32df01(0x1c6)]=_0x707827;const _0x4d7b51=await _0xc09b7d['save']();console[_0x32df01(0x197)](_0x4d7b51);const _0x2c16de=await s_payment_data[_0x32df01(0x1c5)]({'invoice':_0x32f25f});_0x2c16de[_0x32df01(0x224)]=_0x707827,await _0x2c16de[_0x32df01(0x1d7)]();let _0x583c9e=new Date(),_0x44b3b3=('0'+_0x583c9e['getDate']())['slice'](-0x2),_0x2585b7=('0'+(_0x583c9e[_0x32df01(0x1de)]()+0x1))['slice'](-0x2),_0x495479=_0x583c9e[_0x32df01(0x1c4)](),_0x189579=_0x495479+'-'+_0x2585b7+'-'+_0x44b3b3;const _0x143af5=new suppliers_payment({'invoice':_0x32f25f,'date':_0x495479+'-'+_0x2585b7+'-'+_0x44b3b3,'suppliers':_0x4c4b28,'reason':'Paid\x20For\x20Purchase','amount':_0x1b0127}),_0x33ea8f=await _0x143af5[_0x32df01(0x1d7)]();_0x426b56[_0x32df01(0x1a2)](_0x32df01(0x1cd),_0x32df01(0x172)),_0x269d68[_0x32df01(0x17a)](_0x32df01(0x25f));}catch(_0x514deb){console['log'](_0x514deb);}}),router[a0_0x5698bf(0x21c)]('/invoice/:id',auth,async(_0x3df5d6,_0x31bee1)=>{var _0x55e85d=a0_0x5698bf;try{const {username:_0x3ac1c6,email:_0x152759,role:_0x293b1a}=_0x3df5d6[_0x55e85d(0x1aa)],_0x35861=_0x3df5d6[_0x55e85d(0x1aa)],_0x15805f=await profile['findOne']({'email':_0x35861[_0x55e85d(0x240)]}),_0x3ca94e=await master_shop['find']();console[_0x55e85d(0x197)](_0x55e85d(0x190),_0x3ca94e);const _0x1badb8=_0x3df5d6[_0x55e85d(0x163)]['id'],_0x240285=await purchases[_0x55e85d(0x1dd)](_0x1badb8);console[_0x55e85d(0x197)](_0x240285);const _0x24f8bb=await suppliers['findOne']({'name':_0x240285[_0x55e85d(0x196)]});console[_0x55e85d(0x197)](_0x24f8bb);if(_0x3ca94e[0x0][_0x55e85d(0x1e6)]==_0x55e85d(0x1c1)){var _0x394c19=users[_0x55e85d(0x245)];console[_0x55e85d(0x197)](_0x394c19);}else{if(_0x3ca94e[0x0]['language']==_0x55e85d(0x192))var _0x394c19=users[_0x55e85d(0x192)];else{if(_0x3ca94e[0x0][_0x55e85d(0x1e6)]=='German')var _0x394c19=users['German'];else{if(_0x3ca94e[0x0]['language']==_0x55e85d(0x1bc))var _0x394c19=users[_0x55e85d(0x1bc)];else{if(_0x3ca94e[0x0][_0x55e85d(0x1e6)]==_0x55e85d(0x237))var _0x394c19=users[_0x55e85d(0x237)];else{if(_0x3ca94e[0x0][_0x55e85d(0x1e6)]==_0x55e85d(0x1ea))var _0x394c19=users[_0x55e85d(0x13a)];else{if(_0x3ca94e[0x0][_0x55e85d(0x1e6)]==_0x55e85d(0x1ed))var _0x394c19=users[_0x55e85d(0x1ed)];else{if(_0x3ca94e[0x0]['language']=='Arabic\x20(ae)')var _0x394c19=users[_0x55e85d(0x230)];}}}}}}}_0x31bee1[_0x55e85d(0x232)](_0x55e85d(0x1cb),{'success':_0x3df5d6[_0x55e85d(0x1a2)](_0x55e85d(0x1cd)),'errors':_0x3df5d6['flash'](_0x55e85d(0x19a)),'role':_0x35861,'profile':_0x15805f,'master_shop':_0x3ca94e,'supplier':_0x24f8bb,'purchase':_0x240285,'language':_0x394c19});}catch(_0xcf0ebe){console[_0x55e85d(0x197)](_0xcf0ebe);}}),router[a0_0x5698bf(0x21c)]('/view/return_purchase/:id',auth,async(_0x484116,_0xd818d4)=>{var _0xb925f=a0_0x5698bf;try{const {username:_0x2c7235,email:_0x499593,role:_0xff3dc0}=_0x484116[_0xb925f(0x1aa)],_0x320f36=_0x484116[_0xb925f(0x1aa)],_0x5a21d6=await profile[_0xb925f(0x1c5)]({'email':_0x320f36['email']}),_0x465532=await master_shop[_0xb925f(0x1ef)]();console[_0xb925f(0x197)]('master',_0x465532);const _0x22ccdb=_0x484116[_0xb925f(0x163)]['id'];console[_0xb925f(0x197)](_0x22ccdb);const _0x44d2ee=await purchases['findById'](_0x22ccdb);console['log'](_0xb925f(0x1f8),_0x44d2ee);const _0x24cb9e=await product['find']({}),_0x51f9a2=await warehouse[_0xb925f(0x1a4)]([{'$match':{'name':_0x44d2ee[_0xb925f(0x153)],'room':_0x44d2ee[_0xb925f(0x19d)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0xb925f(0x22d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0xb925f(0x150)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xb925f(0x1ff)},'bin':{'$first':_0xb925f(0x191)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xb925f(0x14b)},'primary_code':{'$first':_0xb925f(0x259)},'secondary_code':{'$first':_0xb925f(0x185)},'product_code':{'$first':_0xb925f(0x1c0)},'storage':{'$first':_0xb925f(0x1f9)},'rack':{'$first':_0xb925f(0x1ec)}}}]);warehouse_data=await warehouse[_0xb925f(0x1a4)]([{'$match':{'status':_0xb925f(0x19b),'name':_0xb925f(0x13c),'warehouse_category':_0xb925f(0x176)}},{'$group':{'_id':'$name','name':{'$first':_0xb925f(0x15e)}}},{'$sort':{'name':0x1}}]),console[_0xb925f(0x197)](_0xb925f(0x1f1),_0x51f9a2);if(_0x465532[0x0]['language']==_0xb925f(0x1c1)){var _0x2e603d=users[_0xb925f(0x245)];console['log'](_0x2e603d);}else{if(_0x465532[0x0][_0xb925f(0x1e6)]==_0xb925f(0x192))var _0x2e603d=users[_0xb925f(0x192)];else{if(_0x465532[0x0][_0xb925f(0x1e6)]==_0xb925f(0x215))var _0x2e603d=users['German'];else{if(_0x465532[0x0][_0xb925f(0x1e6)]=='Spanish')var _0x2e603d=users[_0xb925f(0x1bc)];else{if(_0x465532[0x0][_0xb925f(0x1e6)]==_0xb925f(0x237))var _0x2e603d=users[_0xb925f(0x237)];else{if(_0x465532[0x0]['language']==_0xb925f(0x1ea))var _0x2e603d=users[_0xb925f(0x13a)];else{if(_0x465532[0x0][_0xb925f(0x1e6)]==_0xb925f(0x1ed))var _0x2e603d=users['Chinese'];else{if(_0x465532[0x0][_0xb925f(0x1e6)]==_0xb925f(0x19f))var _0x2e603d=users[_0xb925f(0x230)];}}}}}}}_0xd818d4[_0xb925f(0x232)]('return_purchase',{'success':_0x484116[_0xb925f(0x1a2)]('success'),'errors':_0x484116[_0xb925f(0x1a2)](_0xb925f(0x19a)),'role':_0x320f36,'profile':_0x5a21d6,'user':_0x44d2ee,'stock':_0x51f9a2,'master_shop':_0x465532,'product':_0x24cb9e,'language':_0x2e603d,'warehouse':warehouse_data});}catch(_0x3dae1e){console[_0xb925f(0x197)](_0x3dae1e);}}),router[a0_0x5698bf(0x227)](a0_0x5698bf(0x194),auth,async(_0x2c5284,_0x31a024)=>{var _0x213621=a0_0x5698bf;try{const {invoice:_0x4566d0,date:_0x580186,warehouse_name:_0x815493,Room_name:_0x455ba0,product_name:_0x17d299,purchase_quantity:_0x7695e1,stocks:_0x4734e7,return_qty:_0x142518,note:_0x1257f2,level:_0x5d9f80,isle:_0x4fbaea,pallet:_0x35140c,to_warehouse_name:_0x5be57b,to_Room_name:_0x53c3ef}=_0x2c5284['body'],_0x345f56=await purchases['findOne']({'_id':_0x2c5284[_0x213621(0x163)]['id']}),_0x1dbb02=await warehouse['findOne']({'name':_0x815493,'room':_0x455ba0});if(typeof _0x17d299==_0x213621(0x16a))var _0x49fed4=[_0x2c5284[_0x213621(0x23d)]['product_name']],_0x45e5bd=[_0x2c5284[_0x213621(0x23d)][_0x213621(0x14c)]],_0x365690=[_0x2c5284[_0x213621(0x23d)][_0x213621(0x16d)]],_0x5b6692=[_0x2c5284[_0x213621(0x23d)][_0x213621(0x17c)]],_0x5e282b=[_0x2c5284['body'][_0x213621(0x1f4)]],_0xad0021=[_0x2c5284[_0x213621(0x23d)][_0x213621(0x1a0)]],_0x36d69b=[_0x2c5284[_0x213621(0x23d)][_0x213621(0x25a)]],_0x30405c=[_0x2c5284['body'][_0x213621(0x147)]],_0x5ecdfe=[_0x2c5284['body'][_0x213621(0x1d0)]],_0x135f0b=[_0x2c5284[_0x213621(0x23d)][_0x213621(0x15b)]],_0x5744e6=[_0x2c5284[_0x213621(0x23d)]['secondary_code_hide']];else var _0x49fed4=[..._0x2c5284[_0x213621(0x23d)][_0x213621(0x14f)]],_0x45e5bd=[..._0x2c5284['body'][_0x213621(0x14c)]],_0x365690=[..._0x2c5284[_0x213621(0x23d)][_0x213621(0x16d)]],_0x5b6692=[..._0x2c5284[_0x213621(0x23d)][_0x213621(0x17c)]],_0x5e282b=[..._0x2c5284[_0x213621(0x23d)]['level']],_0xad0021=[..._0x2c5284[_0x213621(0x23d)][_0x213621(0x1a0)]],_0x36d69b=[..._0x2c5284['body']['pallet']],_0x30405c=[..._0x2c5284[_0x213621(0x23d)]['types']],_0x5ecdfe=[..._0x2c5284['body'][_0x213621(0x1d0)]],_0x135f0b=[..._0x2c5284[_0x213621(0x23d)][_0x213621(0x15b)]],_0x5744e6=[..._0x2c5284[_0x213621(0x23d)][_0x213621(0x14e)]];const _0x9f50a=_0x49fed4[_0x213621(0x13d)](_0x21461f=>{return _0x21461f={'product_name':_0x21461f};});_0x45e5bd[_0x213621(0x1b5)]((_0x1cf1b5,_0x4f5fcc)=>{var _0x2429d9=_0x213621;_0x9f50a[_0x4f5fcc][_0x2429d9(0x14c)]=_0x1cf1b5;}),_0x365690['forEach']((_0x232155,_0x54fb29)=>{_0x9f50a[_0x54fb29]['stock_quantity']=_0x232155;}),_0x5b6692['forEach']((_0xa9360e,_0x28a374)=>{var _0x255825=_0x213621;_0x9f50a[_0x28a374][_0x255825(0x17c)]=_0xa9360e;}),_0x5e282b['forEach']((_0x940764,_0x5fe6dd)=>{var _0x36dbab=_0x213621;_0x9f50a[_0x5fe6dd][_0x36dbab(0x1e5)]=_0x940764;}),_0xad0021[_0x213621(0x1b5)]((_0x2c7a17,_0x11e594)=>{var _0x198c34=_0x213621;_0x9f50a[_0x11e594][_0x198c34(0x220)]=_0x2c7a17;}),_0x36d69b[_0x213621(0x1b5)]((_0x258167,_0x15f5d0)=>{var _0x25b87b=_0x213621;_0x9f50a[_0x15f5d0][_0x25b87b(0x252)]=_0x258167;}),_0x30405c[_0x213621(0x1b5)]((_0x33095e,_0x578485)=>{var _0x331157=_0x213621;_0x9f50a[_0x578485][_0x331157(0x250)]=_0x33095e;}),_0x5ecdfe[_0x213621(0x1b5)]((_0x2b3fea,_0x1bcbd0)=>{var _0x1ab7cc=_0x213621;_0x9f50a[_0x1bcbd0][_0x1ab7cc(0x20a)]=_0x2b3fea;}),_0x135f0b[_0x213621(0x1b5)]((_0x3318b1,_0x33006b)=>{var _0x164f6d=_0x213621;_0x9f50a[_0x33006b][_0x164f6d(0x154)]=_0x3318b1;}),_0x5744e6[_0x213621(0x1b5)]((_0xadec64,_0x31f957)=>{_0x9f50a[_0x31f957]['secondary_code']=_0xadec64;}),_0x345f56['product'][_0x213621(0x1b5)](_0x40807e=>{var _0x20ca29=_0x213621;const _0x15d2f0=_0x1dbb02[_0x20ca29(0x24c)]['map'](_0x5c8a1f=>{var _0x1ca76f=_0x20ca29;_0x5c8a1f[_0x1ca76f(0x14f)]==_0x40807e['product_name']&&_0x5c8a1f[_0x1ca76f(0x252)]==_0x40807e['floorlevel']&&_0x5c8a1f[_0x1ca76f(0x250)]==_0x40807e[_0x1ca76f(0x250)]&&_0x5c8a1f[_0x1ca76f(0x220)]==_0x40807e[_0x1ca76f(0x220)]&&_0x5c8a1f['bay']==_0x40807e[_0x1ca76f(0x1e5)]&&_0x5c8a1f['rack']==_0x40807e[_0x1ca76f(0x23f)]&&_0x5c8a1f[_0x1ca76f(0x19e)]==_0x40807e[_0x1ca76f(0x19e)]&&(console['log'](parseInt(_0x5c8a1f[_0x1ca76f(0x235)])+'\x20<>\x20'+parseInt(_0x40807e[_0x1ca76f(0x155)])),_0x5c8a1f[_0x1ca76f(0x235)]=parseInt(_0x5c8a1f[_0x1ca76f(0x235)])+parseInt(_0x40807e[_0x1ca76f(0x155)]));});}),await _0x1dbb02[_0x213621(0x1d7)]();const _0x10f907=_0x9f50a['filter'](_0x25b4fb=>_0x25b4fb[_0x213621(0x17c)]!=='0'&&_0x25b4fb[_0x213621(0x17c)]!=='');var _0x11f572=0x0;_0x10f907[_0x213621(0x1b5)](_0xf7917b=>{var _0x4c84e6=_0x213621;console['log'](_0x4c84e6(0x256),_0xf7917b),(parseInt(_0xf7917b['purchase_quantity'])<parseInt(_0xf7917b[_0x4c84e6(0x17c)])||parseInt(_0xf7917b[_0x4c84e6(0x1ca)])<parseInt(_0xf7917b['return_qty']))&&_0x11f572++;});if(_0x11f572!=0x0)return _0x2c5284[_0x213621(0x1a2)](_0x213621(0x19a),_0x213621(0x165)),_0x31a024[_0x213621(0x17a)](_0x213621(0x18f));const _0x344931=new purchases_return({'invoice':_0x4566d0,'suppliers':_0x2c5284[_0x213621(0x23d)][_0x213621(0x196)],'date':_0x580186,'warehouse_name':_0x815493,'return_product':_0x10f907,'note':_0x1257f2,'room':_0x455ba0,'to_warehouse_name':_0x5be57b,'to_room':_0x53c3ef}),_0x2e5290=await _0x344931[_0x213621(0x1d7)]();console['log'](_0x344931);const _0x3fda7e=await purchases_return['findOne']({'invoice':_0x4566d0}),_0x5ccaca=await warehouse['findOne']({'name':_0x5be57b,'room':_0x53c3ef});_0x3fda7e[_0x213621(0x243)][_0x213621(0x1b5)](_0x4939a7=>{var _0x11b7be=_0x213621,_0x458a3c=0x0;const _0x263047=_0x5ccaca[_0x11b7be(0x24c)]['map'](_0x25705d=>{var _0x5aaca1=_0x11b7be;_0x25705d['product_name']==_0x4939a7[_0x5aaca1(0x14f)]&&_0x25705d[_0x5aaca1(0x252)]==_0x4939a7[_0x5aaca1(0x252)]&&_0x25705d[_0x5aaca1(0x250)]==_0x4939a7[_0x5aaca1(0x250)]&&_0x25705d[_0x5aaca1(0x220)]==_0x4939a7[_0x5aaca1(0x220)]&&_0x25705d[_0x5aaca1(0x1e5)]==_0x4939a7['bay']&&(_0x25705d['product_stock']=parseInt(_0x25705d[_0x5aaca1(0x235)])-parseInt(_0x4939a7['return_qty']),_0x458a3c++);});_0x458a3c=='0'&&(_0x5ccaca[_0x11b7be(0x24c)]=_0x5ccaca[_0x11b7be(0x24c)][_0x11b7be(0x18e)]({'product_name':_0x4939a7['product_name'],'product_stock':_0x4939a7[_0x11b7be(0x17c)],'primary_code':_0x4939a7[_0x11b7be(0x154)],'secondary_code':_0x4939a7[_0x11b7be(0x189)],'product_code':_0x4939a7[_0x11b7be(0x20a)],'storage':_0x4939a7['storage'],'rack':_0x4939a7['rack'],'bay':_0x4939a7['bay'],'bin':_0x4939a7[_0x11b7be(0x220)],'type':_0x4939a7['type'],'floorlevel':_0x4939a7[_0x11b7be(0x252)],'maxProducts':_0x4939a7[_0x11b7be(0x210)],'unit':_0x4939a7['standard_unit'],'secondary_unit':_0x4939a7['secondary_unit'],'expiry_date':_0x4939a7[_0x11b7be(0x1ae)]}));}),await _0x5ccaca[_0x213621(0x1d7)]();const _0x3f10e8=await purchases[_0x213621(0x1c5)]({'invoice':_0x4566d0});_0x3f10e8[_0x213621(0x1c9)]=_0x213621(0x1f6);const _0x4bb860=await _0x3f10e8[_0x213621(0x1d7)](),_0x31b143=new s_payment_data({'invoice':_0x4566d0,'suppliers':_0x2c5284[_0x213621(0x23d)][_0x213621(0x196)],'reason':_0x213621(0x179)});await _0x31b143['save']();const _0xce9a45=await master_shop[_0x213621(0x1ef)]();console[_0x213621(0x197)]('add\x20post',_0xce9a45[0x0]['image']);const _0x20b5c5=await email_settings['findOne'](),_0xa74188=await suppliers[_0x213621(0x1c5)]({'name':_0x2c5284[_0x213621(0x23d)]['suppliers']});console['log'](_0x213621(0x13f),_0xa74188);_0xce9a45[0x0]['currency_placement']==0x1?(right_currency=_0xce9a45[0x0][_0x213621(0x1fc)],left_currency=''):(right_currency='',left_currency=_0xce9a45[0x0]['currency']);var _0x13aa20=_0x49fed4,_0x438aa3=_0x5b6692,_0x18bfa6='',_0x3af4ad;for(_0x3af4ad in _0x13aa20){_0x18bfa6+=_0x213621(0x1fd)+_0x213621(0x23a)+_0x13aa20[_0x3af4ad]+_0x213621(0x20b)+_0x213621(0x23a)+_0x438aa3[_0x3af4ad]+_0x213621(0x20b)+_0x213621(0x166);}console['log'](_0x213621(0x219),_0x18bfa6);let _0x215902=nodemailer[_0x213621(0x16f)]({'service':_0x213621(0x20d),'auth':{'user':_0x20b5c5[_0x213621(0x240)],'pass':_0x20b5c5[_0x213621(0x173)]}}),_0x3d625e={'from':_0x20b5c5[_0x213621(0x240)],'to':_0xa74188['email'],'subject':_0x213621(0x202),'attachments':[{'filename':_0x213621(0x221),'path':__dirname+_0x213621(0x1b0)+_0x213621(0x142)+_0xce9a45[0x0]['image'],'cid':_0x213621(0x1e8)}],'html':_0x213621(0x218)+_0x213621(0x16c)+_0x213621(0x1a1)+_0x213621(0x171)+_0x213621(0x22b)+'<div>'+_0x213621(0x21b)+_0x213621(0x162)+_0x213621(0x171)+'<h2>\x20'+_0xce9a45[0x0][_0x213621(0x1a8)]+_0x213621(0x20f)+_0x213621(0x162)+'</div>'+_0x213621(0x251)+_0x213621(0x171)+_0x213621(0x1a3)+_0x213621(0x1a9)+_0x4566d0+'\x20'+_0x213621(0x1e4)+_0x213621(0x217)+_0x580186+'\x20'+_0x213621(0x180)+'</h5>'+'</div>'+_0x213621(0x1ab)+_0x213621(0x141)+_0x213621(0x1fd)+_0x213621(0x167)+_0x213621(0x209)+_0x213621(0x1ba)+_0x213621(0x143)+_0x213621(0x166)+_0x213621(0x20c)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x18bfa6+'\x20'+'</tbody>'+_0x213621(0x184)+_0x213621(0x171)+'<strong>\x20Regards\x20</strong>'+_0x213621(0x207)+_0xce9a45[0x0]['site_title']+_0x213621(0x200)+_0x213621(0x162)+_0x213621(0x162)+'</body></html>'};_0x215902[_0x213621(0x225)](_0x3d625e,function(_0x197a43,_0x6ef9df){var _0x3d09a8=_0x213621;_0x197a43?(console[_0x3d09a8(0x197)](_0x197a43),console[_0x3d09a8(0x197)]('Error\x20Occurs')):console[_0x3d09a8(0x197)]('Email\x20sent\x20successfully');}),_0x2c5284[_0x213621(0x1a2)](_0x213621(0x1cd),'purchases\x20item\x20return\x20successfull'),_0x31a024[_0x213621(0x17a)](_0x213621(0x25f));}catch(_0x1c9c00){console['log'](_0x1c9c00),_0x31a024[_0x213621(0x1ad)](0xc8)[_0x213621(0x231)]({'message':_0x1c9c00[_0x213621(0x177)]});}}),router[a0_0x5698bf(0x21c)](a0_0x5698bf(0x1bb),auth,async(_0x417d04,_0x112eae)=>{var _0x22ac87=a0_0x5698bf;try{const {username:_0x3a4026,email:_0x481b3d,role:_0x39c85b}=_0x417d04[_0x22ac87(0x1aa)],_0x17ee19=_0x417d04[_0x22ac87(0x1aa)],_0x56678a=await profile[_0x22ac87(0x1c5)]({'email':_0x17ee19['email']}),_0x3d5ec6=await master_shop[_0x22ac87(0x1ef)](),_0x6638e2=_0x417d04[_0x22ac87(0x163)]['id'],_0xf6dd88=await purchases[_0x22ac87(0x1dd)](_0x6638e2);if(_0x3d5ec6[0x0][_0x22ac87(0x1e6)]==_0x22ac87(0x1c1))var _0x135f22=users['English'];else{if(_0x3d5ec6[0x0][_0x22ac87(0x1e6)]==_0x22ac87(0x192))var _0x135f22=users[_0x22ac87(0x192)];else{if(_0x3d5ec6[0x0][_0x22ac87(0x1e6)]=='German')var _0x135f22=users[_0x22ac87(0x215)];else{if(_0x3d5ec6[0x0][_0x22ac87(0x1e6)]==_0x22ac87(0x1bc))var _0x135f22=users['Spanish'];else{if(_0x3d5ec6[0x0][_0x22ac87(0x1e6)]==_0x22ac87(0x237))var _0x135f22=users[_0x22ac87(0x237)];else{if(_0x3d5ec6[0x0][_0x22ac87(0x1e6)]=='Portuguese\x20(BR)')var _0x135f22=users[_0x22ac87(0x13a)];else{if(_0x3d5ec6[0x0]['language']==_0x22ac87(0x1ed))var _0x135f22=users[_0x22ac87(0x1ed)];else{if(_0x3d5ec6[0x0]['language']==_0x22ac87(0x19f))var _0x135f22=users[_0x22ac87(0x230)];}}}}}}}_0x112eae[_0x22ac87(0x232)](_0x22ac87(0x1b6),{'success':_0x417d04['flash'](_0x22ac87(0x1cd)),'errors':_0x417d04[_0x22ac87(0x1a2)](_0x22ac87(0x19a)),'role':_0x17ee19,'profile':_0x56678a,'alldata':_0xf6dd88,'master_shop':_0x3d5ec6,'language':_0x135f22}),console[_0x22ac87(0x197)](alldata);}catch(_0x3a1f6a){console['log'](_0x3a1f6a);}}),router[a0_0x5698bf(0x227)]('/barcode_scanner',async(_0x259428,_0x4250e1)=>{var _0x3a1e34=a0_0x5698bf;const {product_code:_0x4c1358}=_0x259428[_0x3a1e34(0x23d)];var _0x2335b9;const _0x2c9e3e=await product['aggregate']([{'$match':{'primary_code':_0x4c1358,'product_category':_0x3a1e34(0x176)}},{'$group':{'_id':_0x3a1e34(0x206),'name':{'$first':_0x3a1e34(0x15e)},'category':{'$first':_0x3a1e34(0x1a7)},'brand':{'$first':_0x3a1e34(0x21f)},'unit':{'$first':_0x3a1e34(0x152)},'alertquantity':{'$first':_0x3a1e34(0x18d)},'product_code':{'$first':_0x3a1e34(0x22a)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x3a1e34(0x1d1)},'maxStocks':{'$first':_0x3a1e34(0x25b)},'maxProdPerUnit':{'$first':'$maxProdPerUnit'},'product_cat':{'$first':'P'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x1a94c8=await product['aggregate']([{'$match':{'secondary_code':_0x4c1358,'product_category':_0x3a1e34(0x176)}},{'$group':{'_id':'$_id','name':{'$first':_0x3a1e34(0x15e)},'category':{'$first':'$category'},'brand':{'$first':_0x3a1e34(0x21f)},'unit':{'$first':_0x3a1e34(0x152)},'alertquantity':{'$first':_0x3a1e34(0x18d)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x3a1e34(0x1bf)},'secondary_code':{'$first':_0x3a1e34(0x1d1)},'maxStocks':{'$first':_0x3a1e34(0x25b)},'maxProdPerUnit':{'$first':_0x3a1e34(0x1d8)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':'$secondary_unit'}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x2c9e3e[_0x3a1e34(0x1fe)]>0x0)_0x2335b9=_0x2c9e3e;else _0x1a94c8['length']>0x0&&(_0x2335b9=_0x1a94c8);_0x4250e1[_0x3a1e34(0x231)](_0x2335b9);}),router[a0_0x5698bf(0x227)](a0_0x5698bf(0x14d),async(_0x55d5a6,_0x2c573a)=>{var _0x459069=a0_0x5698bf;const {primaryCode:_0x44c6bc,secondaryCode:_0x551f85,productCode:_0x25a274,bay:_0x2fab71,bin:_0x344198,types:_0x1603a4,pallet:_0xdc0dfd,warehouses:_0x398425,room:_0x145642}=_0x55d5a6['body'];console[_0x459069(0x197)](_0x55d5a6[_0x459069(0x23d)]);try{const _0xc4e61f=await warehouse['aggregate']([{'$match':{'name':_0x398425,'room':_0x145642}},{'$unwind':_0x459069(0x22d)},{'$match':{'product_details.bay':_0x2fab71,'product_details.bin':_0x344198,'product_details.type':_0x1603a4}},{'$group':{'_id':_0x459069(0x1e9),'name':{'$first':_0x459069(0x150)},'product_stock':{'$first':_0x459069(0x1b8)},'level':{'$first':_0x459069(0x214)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x459069(0x17f)},'maxProducts':{'$first':_0x459069(0x174)}}}]);_0x2c573a[_0x459069(0x1ad)](0xc8)[_0x459069(0x231)](_0xc4e61f);}catch(_0x5a64c6){_0x2c573a[_0x459069(0x1ad)](0x194)[_0x459069(0x231)]({'message':_0x5a64c6['message']});}}),module[a0_0x5698bf(0x1f0)]=router;function a0_0x3fc6(){var _0x424c34=['RoomAssign','prod_code','$suppliers','$alertquantity','concat','back','master','$product_details.bin','Hindi','An\x20error\x20occurred\x20while\x20saving\x20data.','/view/return_purchase/:id','all_purchases','suppliers','log','/view','edit_purchases_view','errors','Enabled','$product.room_name','room','storage','Arabic\x20(ae)','isle','</head><body>','flash','<h5\x20style=\x22text-align:\x20left;\x22>','aggregate','toString','POnumber','$category','site_title','\x20Order\x20Number\x20:\x20','user','<table\x20style=\x22width:\x20100%\x20!important;\x22>','30180lgnEUb','status','expiry_date','invoice','/../public','prod_unit','Error\x20Occurs','Rack\x20A','/preview/:id','forEach','all_purchases_barcode','$finalize','$product_details.product_stock','$due_amount','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','/barcode/:id','Spanish','../public/language/languages.json','prod_invoice','$primary_code','$product_details.product_code','English\x20(US)','table\x20page','Enclosed','getFullYear','findOne','due_amount','</tbody>','Rack\x20C','return_data','stock_quantity','purchase_invoice','then','success','Room_name','note','product_code_hide','$secondary_code','port','warehouse','208662dRNqmm','host','$product','save','$maxProdPerUnit','filter','path','$product.bay','actual_qty','findById','getMonth','abs','product_cat','push','/view/add_purchases/:id','nodemailer','<span\x20style=\x22float:\x20right;\x22>','bay','language','production_date','logo','$product_details._id','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.rack','Chinese','express','find','exports','stock_data','secondary_unit','prod_Qty','level','JO_number','True','DRY\x20STORAGE','user_id','$product_details.storage','116AJCGpM','307170CFrDCo','currency','<tr>','length','$product_details.bay','</h5>','delivery_code','Purchase\x20Return\x20Mail','name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','getDate','$_id','<h5>','all','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','product_code','</td>','</thead>','gmail','role','\x20</h2>','maxStocks','ejs','slice','product','$product_details.level','German','Shelves','\x20Order\x20Date\x20:\x20','<!DOCTYPE\x20html>','product_list','$room','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','get','image','MaxStocks_data','$brand','bin','Logo.png','$product.quantity','prod_level','amount','sendMail','add_purchases\x20error','post','$product.bin','149920lFTzZf','$product_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','edit_purchases','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','error','Arabic','json','render','$return_data','/view/add_purchases','product_stock','Receiving\x20Area','French','Email\x20sent\x20successfully','$date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','161yHXqvf','$paid_amount','body','alertQTY','rack','email','RMSEmail','date','return_product','/give_payment/:id','English','$product_details.expiry_date','54doHenC','prod_isle','Rack\x20D','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','35998600DYUIJS','product_details','$product.floorlevel','delivery_date','/view/:id','type','<hr\x20class=\x22my-3\x22>','floorlevel','<tbody\x20style=\x22text-align:\x20center;\x22>','Purchase\x20data\x20added\x20successfully','batch_code','foreach\x20newproduct','\x20<>\x20','catch','$product_details.primary_code','pallet','$maxStocks','$suppliers_docs','$note','Floor','/all_purchases/view','Portuguese','add_purchases','Return\x20Goods','map','$product.type','suppliers_data','floor','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/upload/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','Router','<h2>\x20','Rack\x20B','types','prod_pallet','COLD\x20STORAGE','$invoice','$product_details.floorlevel','purchase_quantity','/CheckingWarehouse','secondary_code_hide','product_name','$product_details.product_name','INC-','$unit','warehouse_name','primary_code','quantity','random','$warehouse_name','staff','room_name','prod_name','primary_code_hide','\x20<\x20wew\x20>\x20','<strong>\x20Regards\x20</strong>','$name','$product_details.type','standard_unit','maxperunit','</div>','params','prod_primunit','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$expiry_date','prod_secondunit','string','deliverycode','<html><head><title></title>','stocks','rak','createTransport','suppliers_docs','<div>','payment\x20successfull','password','$product_details.maxProducts','paid_amount','Raw\x20Materials','message','20sHlUwI','Purchase\x20Return','redirect','Ambient','return_qty','$batch_code','prod_cat','$product_details.pallet','</span>','finalize','7063968rlDpdk','actual_uom','</table>','$product_details.secondary_code','max_product_unit','Level','1311654DCxAtL','secondary_code'];a0_0x3fc6=function(){return _0x424c34;};return a0_0x3fc6();}