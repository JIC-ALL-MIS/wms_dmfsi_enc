var a0_0x36666b=a0_0x8dd2;(function(_0x2ec52b,_0x408ab9){var _0x23056c=a0_0x8dd2,_0x3ebe8f=_0x2ec52b();while(!![]){try{var _0x57493a=-parseInt(_0x23056c(0x167))/0x1*(parseInt(_0x23056c(0xcb))/0x2)+parseInt(_0x23056c(0xee))/0x3+parseInt(_0x23056c(0x122))/0x4+-parseInt(_0x23056c(0xd7))/0x5*(parseInt(_0x23056c(0x13f))/0x6)+parseInt(_0x23056c(0x1e4))/0x7+-parseInt(_0x23056c(0x108))/0x8+parseInt(_0x23056c(0x1d1))/0x9;if(_0x57493a===_0x408ab9)break;else _0x3ebe8f['push'](_0x3ebe8f['shift']());}catch(_0x2f74e0){_0x3ebe8f['push'](_0x3ebe8f['shift']());}}}(a0_0x3ab5,0x9cf24));const express=require(a0_0x36666b(0x1ed)),app=express(),router=express[a0_0x36666b(0x182)](),{profile,master_shop,purchases_spmx,invoice_for_incoming,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,suppliers_payment,s_payment_data,email_settings,purchases_finished,purchases_return_finished,supervisor_settings}=require(a0_0x36666b(0x1e1)),auth=require('../middleware/auth'),nodemailer=require(a0_0x36666b(0x11f));function a0_0x8dd2(_0x5a5879,_0x1274d9){var _0x3ab5bd=a0_0x3ab5();return a0_0x8dd2=function(_0x8dd25d,_0x3d9f07){_0x8dd25d=_0x8dd25d-0xcb;var _0x418628=_0x3ab5bd[_0x8dd25d];return _0x418628;},a0_0x8dd2(_0x5a5879,_0x1274d9);}var ejs=require('ejs');const path=require(a0_0x36666b(0xd5)),users=require(a0_0x36666b(0x1b1)),e=require(a0_0x36666b(0x1c9));router[a0_0x36666b(0xde)](a0_0x36666b(0x124),auth,async(_0x29db63,_0x294d3f)=>{var _0x3feb16=a0_0x36666b;try{const {username:_0x1cf5dc,email:_0x370a64,role:_0x2189a2}=_0x29db63[_0x3feb16(0x1eb)],_0x57112d=_0x29db63[_0x3feb16(0x1eb)],_0x10afa0=await profile[_0x3feb16(0x10c)]({'email':_0x57112d[_0x3feb16(0x13c)]}),_0x282cd6=await staff[_0x3feb16(0x10c)]({'email':_0x57112d[_0x3feb16(0x13c)]});if(_0x57112d[_0x3feb16(0x11b)]==_0x3feb16(0xd8)){const _0x445645=await staff[_0x3feb16(0x10c)]({'email':_0x57112d[_0x3feb16(0x13c)]});}const _0xfda8f9=await master_shop[_0x3feb16(0x14b)](),_0x106bc3=await purchases_spmx[_0x3feb16(0x16e)]([{'$unwind':_0x3feb16(0x1ba)},{'$group':{'_id':_0x3feb16(0xfc),'invoice':{'$first':_0x3feb16(0x135)},'date':{'$first':_0x3feb16(0x113)},'warehouse_name':{'$first':'$warehouse_name'},'room_spmx':{'$addToSet':_0x3feb16(0x1da)},'product':{'$push':'$product'},'note':{'$first':_0x3feb16(0x110)},'spicemix_spmx_qty':{'$sum':'$product.spicemix_spmx_qty'},'extenders_spmx_qty':{'$sum':_0x3feb16(0x162)},'curing_spmx_qty':{'$sum':_0x3feb16(0x18b)},'spicemix_spmx':{'$addToSet':_0x3feb16(0x1ee)},'extenders_spmx':{'$addToSet':_0x3feb16(0x1c2)},'curing_spmx':{'$addToSet':_0x3feb16(0x1e7)},'product_code':{'$addToSet':_0x3feb16(0x19e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'warehouse_name':0x1,'room_spmx':0x1,'product':0x1,'note':0x1,'spicemix_spmx_qty':0x1,'extenders_spmx_qty':0x1,'curing_spmx_qty':0x1,'spicemix_spmx':0x1,'extenders_spmx':0x1,'curing_spmx':0x1,'product_code':0x1}}]);if(_0xfda8f9[0x0][_0x3feb16(0xe9)]=='English\x20(US)')var _0x5850b8=users[_0x3feb16(0x1b0)];else{if(_0xfda8f9[0x0][_0x3feb16(0xe9)]==_0x3feb16(0x131))var _0x5850b8=users[_0x3feb16(0x131)];else{if(_0xfda8f9[0x0]['language']==_0x3feb16(0x143))var _0x5850b8=users[_0x3feb16(0x143)];else{if(_0xfda8f9[0x0][_0x3feb16(0xe9)]==_0x3feb16(0x13e))var _0x5850b8=users[_0x3feb16(0x13e)];else{if(_0xfda8f9[0x0][_0x3feb16(0xe9)]==_0x3feb16(0x192))var _0x5850b8=users[_0x3feb16(0x192)];else{if(_0xfda8f9[0x0][_0x3feb16(0xe9)]==_0x3feb16(0x1e5))var _0x5850b8=users[_0x3feb16(0x112)];else{if(_0xfda8f9[0x0]['language']==_0x3feb16(0x1cd))var _0x5850b8=users[_0x3feb16(0x1cd)];else{if(_0xfda8f9[0x0]['language']==_0x3feb16(0x190))var _0x5850b8=users[_0x3feb16(0x147)];}}}}}}}_0x294d3f['render'](_0x3feb16(0x163),{'success':_0x29db63['flash'](_0x3feb16(0x115)),'errors':_0x29db63[_0x3feb16(0x1cb)](_0x3feb16(0x174)),'purchases':_0x106bc3,'role':_0x57112d,'profile':_0x10afa0,'master_shop':_0xfda8f9,'language':_0x5850b8});}catch(_0x10413e){console[_0x3feb16(0xfb)]('table\x20page',_0x10413e),_0x294d3f[_0x3feb16(0x114)](0xc8)[_0x3feb16(0x186)]({'message':_0x10413e[_0x3feb16(0x19c)]});}}),router['get'](a0_0x36666b(0xdf),auth,async(_0x34eca5,_0x29ecd2)=>{var _0x50abf8=a0_0x36666b;try{const {username:_0x55082f,email:_0xe96ada,role:_0x370504}=_0x34eca5[_0x50abf8(0x1eb)],_0x189955=_0x34eca5[_0x50abf8(0x1eb)],_0x215fbd=await profile[_0x50abf8(0x10c)]({'email':_0x189955[_0x50abf8(0x13c)]}),_0xb13f7d=await master_shop[_0x50abf8(0x14b)](),_0xdbaf28=await staff[_0x50abf8(0x10c)]({'email':_0x189955[_0x50abf8(0x13c)]}),_0xce3cc=await suppliers['find']({}),_0x58de46=await warehouse[_0x50abf8(0x16e)]([{'$match':{'status':_0x50abf8(0x169),'warehouse_category':_0x50abf8(0x18a),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x50abf8(0x1de),'name':{'$first':'$name'}}}]),_0xe63ca6=await product[_0x50abf8(0x14b)]({}),_0x3b606d=await warehouse[_0x50abf8(0x14b)]({'status':_0x50abf8(0x169)}),_0x9aaeec=await purchases_finished[_0x50abf8(0x14b)]({}),_0x1cc145=_0x9aaeec[_0x50abf8(0x101)]+0x1,_0xcb9fec=_0x50abf8(0x166)+_0x1cc145[_0x50abf8(0xfa)]()['padStart'](0x5,'0');var _0x2f2f8d=['Ambient',_0x50abf8(0x1c7)];if(_0xb13f7d[0x0][_0x50abf8(0xe9)]==_0x50abf8(0x15a))var _0x324876=users[_0x50abf8(0x1b0)];else{if(_0xb13f7d[0x0][_0x50abf8(0xe9)]=='Hindi')var _0x324876=users['Hindi'];else{if(_0xb13f7d[0x0]['language']==_0x50abf8(0x143))var _0x324876=users[_0x50abf8(0x143)];else{if(_0xb13f7d[0x0]['language']==_0x50abf8(0x13e))var _0x324876=users[_0x50abf8(0x13e)];else{if(_0xb13f7d[0x0][_0x50abf8(0xe9)]==_0x50abf8(0x192))var _0x324876=users[_0x50abf8(0x192)];else{if(_0xb13f7d[0x0][_0x50abf8(0xe9)]==_0x50abf8(0x1e5))var _0x324876=users[_0x50abf8(0x112)];else{if(_0xb13f7d[0x0][_0x50abf8(0xe9)]==_0x50abf8(0x1cd))var _0x324876=users['Chinese'];else{if(_0xb13f7d[0x0][_0x50abf8(0xe9)]=='Arabic\x20(ae)')var _0x324876=users[_0x50abf8(0x147)];}}}}}}}const _0x46f572=getRandom8DigitNumber();_0x46f572[_0x50abf8(0xe0)](_0x27b649=>{var _0x26fb87=_0x50abf8;_0x29ecd2['render'](_0x26fb87(0x160),{'success':_0x34eca5['flash'](_0x26fb87(0x115)),'errors':_0x34eca5[_0x26fb87(0x1cb)]('errors'),'role':_0x189955,'profile':_0x215fbd,'suppliers':_0xce3cc,'warehouse':_0x58de46,'product':_0xe63ca6,'invoice':_0x27b649,'master_shop':_0xb13f7d,'language':_0x324876,'find_data':_0x3b606d,'rooms_data':_0x2f2f8d});})[_0x50abf8(0x183)](_0x139202=>{var _0x478960=_0x50abf8;_0x34eca5['flash'](_0x478960(0x174),_0x478960(0x136)),_0x29ecd2[_0x478960(0x100)](_0x478960(0x1d9));});}catch(_0x2fc5d8){console[_0x50abf8(0xfb)](_0x2fc5d8);}}),router[a0_0x36666b(0xcd)](a0_0x36666b(0xdf),auth,async(_0xbb0d84,_0x45d55c)=>{var _0x1bb906=a0_0x36666b;try{const {date:_0x52edb1,warehouse_name:_0x1e2db1,room_name:_0x751ac,SCRN:_0x4c6bb6,PO_number:_0x20ce06,prod_code:_0x4d8736,note:_0x523cb8}=_0xbb0d84[_0x1bb906(0xea)];if(typeof _0x4d8736==_0x1bb906(0x1ce))var _0x1dcdc1=[_0xbb0d84['body'][_0x1bb906(0x1a5)]],_0xfb193b=[_0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x193)]],_0x30ba78=[_0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x158)]],_0x28b594=[_0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x105)]],_0x3f26cd=[_0xbb0d84[_0x1bb906(0xea)]['extender_spmx_qty']],_0x29b5eb=[_0xbb0d84['body'][_0x1bb906(0x12a)]],_0x26af9c=[_0xbb0d84['body']['curing_spmx_qty']],_0x1eede0=[_0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x15f)]],_0x124017=[_0xbb0d84['body'][_0x1bb906(0x120)]],_0x165f23=[_0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0xd6)]],_0xdc59d5=[_0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x185)]];else var _0x1dcdc1=[..._0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x1a5)]],_0xfb193b=[..._0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x193)]],_0x30ba78=[..._0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x158)]],_0x28b594=[..._0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x11a)]],_0x3f26cd=[..._0xbb0d84[_0x1bb906(0xea)]['extenders_spmx_qty']],_0x29b5eb=[..._0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x12a)]],_0x26af9c=[..._0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0x137)]],_0x1eede0=[..._0xbb0d84['body'][_0x1bb906(0x15f)]],_0x124017=[..._0xbb0d84['body'][_0x1bb906(0x120)]],_0x165f23=[..._0xbb0d84[_0x1bb906(0xea)][_0x1bb906(0xd6)]],_0xdc59d5=[..._0xbb0d84['body'][_0x1bb906(0x185)]];const _0x25954b=_0x1dcdc1[_0x1bb906(0x1ac)](_0x33c564=>{return _0x33c564={'product_code':_0x33c564};});_0xfb193b[_0x1bb906(0x188)]((_0xff933c,_0xd67645)=>{var _0x3830f7=_0x1bb906;_0x25954b[_0xd67645][_0x3830f7(0x193)]=_0xff933c;}),_0x30ba78[_0x1bb906(0x188)]((_0x6f7980,_0x316fa0)=>{var _0x4927a1=_0x1bb906;_0x25954b[_0x316fa0][_0x4927a1(0x158)]=_0x6f7980;}),_0x28b594['forEach']((_0x38672b,_0x40604c)=>{var _0x1c7479=_0x1bb906;_0x25954b[_0x40604c][_0x1c7479(0x11a)]=_0x38672b;}),_0x3f26cd[_0x1bb906(0x188)]((_0x43ecfd,_0x29c25d)=>{var _0x3bf493=_0x1bb906;_0x25954b[_0x29c25d][_0x3bf493(0x18e)]=_0x43ecfd;}),_0x29b5eb[_0x1bb906(0x188)]((_0xbdbbc6,_0x255c73)=>{var _0x647c95=_0x1bb906;_0x25954b[_0x255c73][_0x647c95(0x12a)]=_0xbdbbc6;}),_0x26af9c[_0x1bb906(0x188)]((_0x12b2ef,_0x10c93a)=>{var _0x56e624=_0x1bb906;_0x25954b[_0x10c93a][_0x56e624(0x137)]=_0x12b2ef;}),_0x1eede0[_0x1bb906(0x188)]((_0x7cc94c,_0x2f3444)=>{_0x25954b[_0x2f3444]['unit_spmx']=_0x7cc94c;}),_0x124017['forEach']((_0x25cff9,_0x5a7303)=>{var _0x2a03c4=_0x1bb906;_0x25954b[_0x5a7303][_0x2a03c4(0x120)]=_0x25cff9;}),_0x165f23[_0x1bb906(0x188)]((_0x10728,_0x2c15a3)=>{var _0x146578=_0x1bb906;_0x25954b[_0x2c15a3][_0x146578(0xd6)]=_0x10728;}),_0xdc59d5[_0x1bb906(0x188)]((_0x15b132,_0x44f882)=>{var _0x3315fd=_0x1bb906;_0x25954b[_0x44f882][_0x3315fd(0x185)]=_0x15b132;});const _0x56659a=new invoice_for_incoming();await _0x56659a['save']();const _0x385c50=new purchases_spmx({'invoice':'INC-'+_0x56659a[_0x1bb906(0x151)]['toString']()[_0x1bb906(0x139)](0x8,'0'),'date':_0x52edb1,'warehouse_name':_0x1e2db1,'product':_0x25954b,'note':_0x523cb8,'room':_0x751ac,'POnumber':_0x20ce06,'SCRN':_0x4c6bb6}),_0x3544a7=await _0x385c50['save'](),_0xf22e71=await purchases_spmx[_0x1bb906(0x1c1)](_0x3544a7[_0x1bb906(0x142)]);_0xf22e71['product'][_0x1bb906(0x188)](async _0x547889=>{var _0x10d15b=_0x1bb906;const _0x40006c=_0x547889['product_code'],_0x1720c4=_0x547889['spicemix_spmx'],_0xb7d6ed=_0x547889[_0x10d15b(0x158)],_0x2c7934=_0x547889[_0x10d15b(0x11a)],_0x44b20f=_0x547889[_0x10d15b(0x18e)],_0x52139e=_0x547889[_0x10d15b(0x12a)],_0x2e5f55=_0x547889[_0x10d15b(0x137)],_0x39fef6=_0x547889[_0x10d15b(0x15f)],_0x4b0865=_0x547889[_0x10d15b(0x120)],_0x362343=_0x547889[_0x10d15b(0xd6)],_0x2de2a7=_0x547889[_0x10d15b(0x185)],_0x30b747=_0xf22e71['invoice'],_0x1be0ca=_0xf22e71[_0x10d15b(0x142)][_0x10d15b(0xfa)]()+'~'+_0x547889[_0x10d15b(0x142)]['toString']();await warehouse[_0x10d15b(0x16a)]({'name':_0x1e2db1,'room':_0x2de2a7},{'$push':{'product_details_spmx':{'product_code':_0x40006c,'spicemix_spmx':_0x1720c4,'spicemix_spmx_qty':_0xb7d6ed,'extenders_spmx':_0x2c7934,'extenders_spmx_qty':_0x44b20f,'curing_spmx':_0x52139e,'curing_spmx_qty':_0x2e5f55,'unit_spmx':_0x39fef6,'brand_spmx':_0x4b0865,'category_spmx':_0x362343,'inv_incoming':_0x30b747,'id_incoming':_0x1be0ca}}});}),_0xbb0d84[_0x1bb906(0x1cb)]('success',_0x1bb906(0x156)),_0x45d55c[_0x1bb906(0x100)]('/all_purchases_finished/view_purchases_spmx/'+_0x3544a7[_0x1bb906(0x142)]);}catch(_0x4a9cc6){console[_0x1bb906(0xfb)](_0x4a9cc6);}}),router[a0_0x36666b(0xde)](a0_0x36666b(0x171),auth,async(_0x478807,_0x4ecdd6)=>{var _0x9ec196=a0_0x36666b;try{const _0x5c0565=_0x478807[_0x9ec196(0x197)]['id'],_0x15709f=await purchases_spmx[_0x9ec196(0x1c1)](_0x5c0565),_0xa093ca=await master_shop[_0x9ec196(0x14b)](),_0xbc89a4=_0x478807['user'],_0x6c7fdf=await profile['findOne']({'email':_0xbc89a4[_0x9ec196(0x13c)]}),_0x3a0239=await staff[_0x9ec196(0x10c)]({'email':_0xbc89a4['email']});if(_0xa093ca[0x0][_0x9ec196(0xe9)]=='English\x20(US)')var _0x2ad0fd=users[_0x9ec196(0x1b0)];else{if(_0xa093ca[0x0][_0x9ec196(0xe9)]==_0x9ec196(0x131))var _0x2ad0fd=users[_0x9ec196(0x131)];else{if(_0xa093ca[0x0][_0x9ec196(0xe9)]=='German')var _0x2ad0fd=users[_0x9ec196(0x143)];else{if(_0xa093ca[0x0][_0x9ec196(0xe9)]==_0x9ec196(0x13e))var _0x2ad0fd=users[_0x9ec196(0x13e)];else{if(_0xa093ca[0x0][_0x9ec196(0xe9)]=='French')var _0x2ad0fd=users[_0x9ec196(0x192)];else{if(_0xa093ca[0x0]['language']=='Portuguese\x20(BR)')var _0x2ad0fd=users['Portuguese'];else{if(_0xa093ca[0x0]['language']==_0x9ec196(0x1cd))var _0x2ad0fd=users[_0x9ec196(0x1cd)];else{if(_0xa093ca[0x0][_0x9ec196(0xe9)]==_0x9ec196(0x190))var _0x2ad0fd=users[_0x9ec196(0x147)];}}}}}}}_0x4ecdd6[_0x9ec196(0x177)](_0x9ec196(0x1c8),{'success':_0x478807[_0x9ec196(0x1cb)](_0x9ec196(0x115)),'errors':_0x478807['flash'](_0x9ec196(0x174)),'role':_0xbc89a4,'profile':_0x6c7fdf,'master_shop':_0xa093ca,'language':_0x2ad0fd,'data':_0x15709f});}catch(_0x268869){console['log'](_0x268869);}}),router[a0_0x36666b(0xde)](a0_0x36666b(0x1dc),auth,async(_0x2e60af,_0x4a5af6)=>{var _0x11ef39=a0_0x36666b;try{const {username:_0x1f54fe,email:_0x3853a2,role:_0x4a02c6}=_0x2e60af[_0x11ef39(0x1eb)],_0x1ad908=_0x2e60af['user'],_0x5c22cd=await profile['findOne']({'email':_0x1ad908[_0x11ef39(0x13c)]}),_0x431036=await staff[_0x11ef39(0x10c)]({'email':_0x1ad908[_0x11ef39(0x13c)]});if(_0x1ad908[_0x11ef39(0x11b)]=='staff'){const _0x3cda51=await staff[_0x11ef39(0x10c)]({'email':_0x1ad908[_0x11ef39(0x13c)]});}const _0x47bed8=await master_shop[_0x11ef39(0x14b)]();let _0x5a0033;if(_0x1ad908['role']==_0x11ef39(0xd8)){const _0x58f41a=await staff['findOne']({'email':_0x1ad908[_0x11ef39(0x13c)]});_0x5a0033=await purchases_finished[_0x11ef39(0x16e)]([{'$unwind':_0x11ef39(0x1ba)},{'$group':{'_id':'$_id','invoice':{'$first':_0x11ef39(0x135)},'suppliers':{'$first':'$suppliers'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x11ef39(0x13d)},'room':{'$first':_0x11ef39(0xf3)},'product':{'$push':_0x11ef39(0x1ba)},'note':{'$first':_0x11ef39(0x110)},'paid_amount':{'$first':'$paid_amount'},'due_amount':{'$first':_0x11ef39(0x12c)},'return_data':{'$first':_0x11ef39(0x16b)},'batch_code':{'$first':_0x11ef39(0x17a)},'expiry_date':{'$first':_0x11ef39(0x1b5)},'suppliers_docs':{'$first':_0x11ef39(0x19a)},'total_product_quantity':{'$sum':'$product.quantity'},'level':{'$addToSet':_0x11ef39(0xe1)},'isle':{'$addToSet':_0x11ef39(0x1c5)},'type':{'$addToSet':_0x11ef39(0x195)},'floorlevel':{'$addToSet':_0x11ef39(0x1bb)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);}else _0x5a0033=await purchases_finished[_0x11ef39(0x16e)]([{'$unwind':_0x11ef39(0x1ba)},{'$group':{'_id':_0x11ef39(0xfc),'invoice':{'$first':_0x11ef39(0x135)},'suppliers':{'$first':_0x11ef39(0x14e)},'date':{'$first':_0x11ef39(0x113)},'warehouse_name':{'$first':_0x11ef39(0x13d)},'room':{'$addToSet':_0x11ef39(0x11c)},'product':{'$push':'$product'},'note':{'$first':'$note'},'paid_amount':{'$first':_0x11ef39(0x1b4)},'due_amount':{'$first':_0x11ef39(0x12c)},'return_data':{'$first':'$return_data'},'batch_code':{'$first':_0x11ef39(0x17a)},'expiry_date':{'$first':_0x11ef39(0x1b5)},'suppliers_docs':{'$first':_0x11ef39(0x19a)},'total_product_quantity':{'$sum':_0x11ef39(0x155)},'level':{'$addToSet':_0x11ef39(0xe1)},'isle':{'$addToSet':_0x11ef39(0x1c5)},'type':{'$addToSet':'$product.type'},'floorlevel':{'$addToSet':'$product.floorlevel'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'product':0x1,'note':0x1,'paid_amount':0x1,'due_amount':0x1,'return_data':0x1,'batch_code':0x1,'expiry_date':0x1,'suppliers_docs':0x1,'total_product_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'floorlevel':0x1}}]);if(_0x47bed8[0x0][_0x11ef39(0xe9)]==_0x11ef39(0x15a))var _0x1fc54e=users[_0x11ef39(0x1b0)];else{if(_0x47bed8[0x0][_0x11ef39(0xe9)]==_0x11ef39(0x131))var _0x1fc54e=users['Hindi'];else{if(_0x47bed8[0x0]['language']==_0x11ef39(0x143))var _0x1fc54e=users[_0x11ef39(0x143)];else{if(_0x47bed8[0x0][_0x11ef39(0xe9)]=='Spanish')var _0x1fc54e=users[_0x11ef39(0x13e)];else{if(_0x47bed8[0x0][_0x11ef39(0xe9)]=='French')var _0x1fc54e=users[_0x11ef39(0x192)];else{if(_0x47bed8[0x0][_0x11ef39(0xe9)]==_0x11ef39(0x1e5))var _0x1fc54e=users['Portuguese'];else{if(_0x47bed8[0x0][_0x11ef39(0xe9)]==_0x11ef39(0x1cd))var _0x1fc54e=users[_0x11ef39(0x1cd)];else{if(_0x47bed8[0x0][_0x11ef39(0xe9)]=='Arabic\x20(ae)')var _0x1fc54e=users['Arabic'];}}}}}}}_0x4a5af6[_0x11ef39(0x177)](_0x11ef39(0x184),{'success':_0x2e60af[_0x11ef39(0x1cb)](_0x11ef39(0x115)),'errors':_0x2e60af[_0x11ef39(0x1cb)](_0x11ef39(0x174)),'purchases':_0x5a0033,'role':_0x1ad908,'profile':_0x5c22cd,'master_shop':_0x47bed8,'language':_0x1fc54e});}catch(_0x3c829f){console[_0x11ef39(0xfb)](_0x11ef39(0xe2),_0x3c829f),_0x4a5af6[_0x11ef39(0x114)](0xc8)[_0x11ef39(0x186)]({'message':_0x3c829f[_0x11ef39(0x19c)]});}});function a0_0x3ab5(){var _0x48bfff=['$product_details.maxProducts','slice','aggregate','edit_purchases_finished','\x20Order\x20Date\x20:\x20','/view_purchases_spmx/:id','$product_details','invoice','errors','$product_details.storage','$product_code','render','/../public','save','$batch_code','/view/add_purchases','</td>','<tr>','warehouse','production_date','$product_details.floorlevel','prod_level','Router','catch','all_purchases_finished','room_spmx','json','MaxStocks_data','forEach','<table\x20style=\x22width:\x20100%\x20!important;\x22>','SPMX','$product.curing_spmx_qty','Ambient','random','extenders_spmx_qty','/barcode/:id','Arabic\x20(ae)','product_date','French','spicemix_spmx','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product.type','secondary_unit','params','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/barcode_scanner','$suppliers_docs','<tbody\x20style=\x22text-align:\x20center;\x22>','message','$maxProdPerUnit','$product.product_code','$product_details.bay','<span\x20style=\x22float:\x20right;\x22>','$secondary_unit','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','payment\x20successfull','prod_cat','prod_code','gmail','note','$product_details.product_name','<hr\x20class=\x22my-3\x22>','</tbody>','</span>','map','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','room','prod_secondunit','English','../public/language/languages.json','/all_purchases/view','purchase\x20data\x20update\x20successfully','$paid_amount','$expiry_date','purchase_invoice','suppliers','/invoice/:id','<h2>\x20','$product','$product.floorlevel','batch_code','prod_unit','Rack\x201','$brand','</div>','findById','$product.extenders_spmx','return_purchase_finished','Purchase\x20Return','$product.bin','product_code_hide','Enclosed','view_purchases_finished_spmx','connect-flash','stocks','flash','/view/return_purchase/:id','Chinese','string','getMonth','</tr>','1854648wdCLbw','</body></html>','Purchase\x20Return\x20Mail','DRY\x20GOODS','error','<strong>\x20Regards\x20</strong>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Paid\x20For\x20Purchase','/all_purchases_finished/view','$product.room_spmx','Logo.png','/view','</thead>','$name','/CheckingWarehouse','/upload/','../models/all_models','logo','getFullYear','8183385nXJRdn','Portuguese\x20(BR)','Purchase\x20Mail','$product.curing_spmx','getDate','expiry_date','product_name','user','Email\x20sent\x20successfully','express','$product.spicemix_spmx','user_id','106nkjSJW','all','post','<html><head><title></title>','warehouse_name','<div>','/view/add_purchases/:id','True','Rack\x202','return_product','path','category_spmx','597245uimpyi','staff','FGSEmail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','site_title','level','prod_name','get','/view/add_purchases_spmx','then','$product.bay','table\x20page','primary_code','max_product_unit','/give_payment/:id','back','abs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','language','body','RoomAssign','secondary_code','Return\x20Goods','1925457mkWTIc','$product_details.product_code','filter','FROZEN\x20GOODS','maxperunit','$room','$primary_code','$alertquantity','\x20</h2>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','primary_code_hide','prod_invoice','toString','log','$_id','product_code','quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','redirect','length','date_data','prod_Qty','createTransport','extender_spmx','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Must\x20not\x20be\x20greater\x20than\x20Purchase/Stock\x20Qty','10061800qtzJep','$product_details._id','room_name','due_amount','findOne','return_data','</h5>','currency_placement','$note','purchase\x20data\x20add\x20successfully','Portuguese','$date','status','success','</table>','$category','An\x20error\x20occurred\x20while\x20saving\x20data.','image','extenders_spmx','role','$product.room_name','product_stock','prod_qty','nodemailer','brand_spmx','purchase_quantity','4014988iiSqOf','sendMail','/view_spmx','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_details','maxStocks','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_code_spmx','curing_spmx','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Price\x20</th>','$due_amount','edit_purchases_finished_view','$maxStocks','bay','secondary_code_hide','Hindi','currency','$secondary_code','all_purchases_barcode','$invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','curing_spmx_qty','amount','padStart','prod_primunit','JO_number','email','$warehouse_name','Spanish','18ozqSCa','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$unit','_id','German','port','<h5\x20style=\x22text-align:\x20left;\x22>','purchases\x20item\x20return\x20successfull','Arabic','master','/view/:id','product_cat','find','/barcode_scanner_spmx','<!DOCTYPE\x20html>','$suppliers','\x20<>\x20','</head><body>','invoice_init','Error\x20Occurs','standard_unit','Finished\x20Goods','$product.quantity','Incoming\x20Successfully\x20Added','product','spicemix_spmx_qty','$product_details.product_stock','English\x20(US)','\x20Order\x20Number\x20:\x20','stock_quantity','<h5>','Room_name','unit_spmx','add_purchases_finished_spmx','return_qty','$product.extenders_spmx_qty','all_purchases_finished_spmx','paid_amount','$product_details.secondary_code','INCF-','14373EwONCU','password','Enabled','updateOne','$return_data'];a0_0x3ab5=function(){return _0x48bfff;};return a0_0x3ab5();}function BayBinSelected(_0xdcd72b,_0x17e369){var _0x5027e4=a0_0x36666b,_0x57802c=[],_0x517376=[];if(_0xdcd72b==_0x5027e4(0x1d4)){switch(_0x17e369){case _0x5027e4(0x1be):_0x57802c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x5027e4(0xd3):_0x57802c=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x517376=['DG'];}else{if(_0xdcd72b==_0x5027e4(0xf1)){switch(_0x17e369){case _0x5027e4(0x1be):_0x57802c=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x57802c=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x517376=['FG'];}}return{'levels':_0x57802c,'identify':_0x517376};}async function getRandom8DigitNumber(){var _0x1d9341=a0_0x36666b;const _0x31e518=0x989680,_0x411f2d=0x5f5e0ff,_0x3f6a57=Math['floor'](Math[_0x1d9341(0x18d)]()*(_0x411f2d-_0x31e518+0x1))+_0x31e518;var _0x2abfdd;const _0x56e5cf=await purchases_finished[_0x1d9341(0x10c)]({'invoice':_0x1d9341(0x166)+_0x3f6a57});return _0x56e5cf&&_0x56e5cf[_0x1d9341(0x101)]>0x0?_0x2abfdd='INCF-'+_0x3f6a57:_0x2abfdd=_0x1d9341(0x166)+_0x3f6a57,_0x2abfdd;}router['get'](a0_0x36666b(0x17b),auth,async(_0x348743,_0x28797a)=>{var _0x22db0d=a0_0x36666b;try{const {username:_0x4c3a1e,email:_0xc9b45d,role:_0x2f025f}=_0x348743['user'],_0x4351e2=_0x348743[_0x22db0d(0x1eb)],_0x162582=await profile[_0x22db0d(0x10c)]({'email':_0x4351e2[_0x22db0d(0x13c)]}),_0x37558a=await master_shop[_0x22db0d(0x14b)](),_0x155b3a=await staff['findOne']({'email':_0x4351e2['email']}),_0x584c14=await suppliers[_0x22db0d(0x14b)]({});let _0x9779a6;if(_0x4351e2['role']==_0x22db0d(0xd8)){const _0x796803=await staff[_0x22db0d(0x10c)]({'email':_0x4351e2[_0x22db0d(0x13c)]});_0x9779a6=await warehouse[_0x22db0d(0x16e)]([{'$match':{'status':'Enabled','name':_0x796803['warehouse'],'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x22db0d(0x1de),'name':{'$first':_0x22db0d(0x1de)}}}]);}else _0x9779a6=await warehouse[_0x22db0d(0x16e)]([{'$match':{'status':_0x22db0d(0x169),'warehouse_category':_0x22db0d(0x154),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x22db0d(0x1de),'name':{'$first':_0x22db0d(0x1de)}}}]);const _0x751150=await product[_0x22db0d(0x14b)]({}),_0x2e56ad=await warehouse[_0x22db0d(0x14b)]({'status':_0x22db0d(0x169)}),_0x33df3b=await purchases_finished[_0x22db0d(0x14b)]({}),_0x5480a3=_0x33df3b[_0x22db0d(0x101)]+0x1,_0x116e18='INCF-'+_0x5480a3[_0x22db0d(0xfa)]()['padStart'](0x5,'0');var _0x3ea065=[_0x22db0d(0x18c),_0x22db0d(0x1c7)];if(_0x37558a[0x0]['language']==_0x22db0d(0x15a))var _0x250c31=users['English'];else{if(_0x37558a[0x0][_0x22db0d(0xe9)]=='Hindi')var _0x250c31=users[_0x22db0d(0x131)];else{if(_0x37558a[0x0][_0x22db0d(0xe9)]==_0x22db0d(0x143))var _0x250c31=users[_0x22db0d(0x143)];else{if(_0x37558a[0x0][_0x22db0d(0xe9)]=='Spanish')var _0x250c31=users[_0x22db0d(0x13e)];else{if(_0x37558a[0x0][_0x22db0d(0xe9)]=='French')var _0x250c31=users['French'];else{if(_0x37558a[0x0][_0x22db0d(0xe9)]==_0x22db0d(0x1e5))var _0x250c31=users[_0x22db0d(0x112)];else{if(_0x37558a[0x0][_0x22db0d(0xe9)]==_0x22db0d(0x1cd))var _0x250c31=users[_0x22db0d(0x1cd)];else{if(_0x37558a[0x0]['language']==_0x22db0d(0x190))var _0x250c31=users[_0x22db0d(0x147)];}}}}}}}const _0x112199=getRandom8DigitNumber();_0x112199['then'](_0x26065c=>{var _0x4d306e=_0x22db0d;_0x28797a[_0x4d306e(0x177)]('add_purchases_finished',{'success':_0x348743[_0x4d306e(0x1cb)](_0x4d306e(0x115)),'errors':_0x348743[_0x4d306e(0x1cb)](_0x4d306e(0x174)),'role':_0x4351e2,'profile':_0x162582,'suppliers':_0x584c14,'warehouse':_0x9779a6,'product':_0x751150,'invoice':_0x26065c,'master_shop':_0x37558a,'language':_0x250c31,'find_data':_0x2e56ad,'rooms_data':_0x3ea065});})[_0x22db0d(0x183)](_0x55b8bb=>{var _0x3dfdb5=_0x22db0d;_0x348743[_0x3dfdb5(0x1cb)](_0x3dfdb5(0x174),_0x3dfdb5(0x136)),_0x28797a[_0x3dfdb5(0x100)](_0x3dfdb5(0x1d9));});}catch(_0x254245){console[_0x22db0d(0xfb)](_0x254245);}}),router['get'](a0_0x36666b(0xd1),auth,async(_0x280609,_0x3e0425)=>{var _0x53df20=a0_0x36666b;try{const _0x51adbc=_0x280609[_0x53df20(0x197)]['id'];console[_0x53df20(0xfb)](_0x51adbc);const _0x5d9849=await master_shop[_0x53df20(0x14b)]();console[_0x53df20(0xfb)](_0x53df20(0x148),_0x5d9849);const _0x3ed226=await product[_0x53df20(0x10c)]({'name':_0x51adbc});console[_0x53df20(0xfb)]('product',_0x3ed226),_0x3e0425[_0x53df20(0x114)](0xc8)[_0x53df20(0x186)]({'product_data':_0x3ed226,'master':_0x5d9849});}catch(_0x3b6dd9){console[_0x53df20(0xfb)]('add_purchases\x20error',_0x3b6dd9);}}),router[a0_0x36666b(0xcd)]('/view/add_purchases',auth,async(_0x5c55aa,_0x26eb3a)=>{var _0x554786=a0_0x36666b;try{const {invoice:_0x5d914d,date:_0x197bbb,warehouse_name:_0x3cb3f6,prod_name:_0x58b504,prod_code:_0x537fe4,prod_qty:_0x1a89db,prod_unit:_0x10e94e,prod_secondunit:_0x10b162,prod_level:_0x19012c,prod_isle:_0x2e07ab,prod_pallet:_0x5ddf20,note:_0x2dca59,expiry_date:_0x46714c,batch_code:_0x5a45c9,payable:_0xf27cb2,due_amount:_0x536f8b,Room_name:_0x4949b6,primary_code:_0x451cc4,secondary_code:_0xdd0456,MaxStocks_data:_0x37e96d,PO_number:_0x59137a,SCRN:_0x331912,JO_number:_0x283580}=_0x5c55aa[_0x554786(0xea)];if(typeof _0x58b504==_0x554786(0x1ce))var _0x9da39a=[_0x5c55aa['body'][_0x554786(0xdd)]],_0x5d5413=[_0x5c55aa[_0x554786(0xea)][_0x554786(0x1a5)]],_0x1a7271=[_0x5c55aa[_0x554786(0xea)][_0x554786(0x103)]],_0x57b8db=[_0x5c55aa['body']['prod_primunit']],_0x5f42ad=[_0x5c55aa[_0x554786(0xea)]['prod_secondunit']],_0x586fee=[_0x5c55aa[_0x554786(0xea)][_0x554786(0x181)]],_0x42d9ed=[_0x5c55aa[_0x554786(0xea)][_0x554786(0xe3)]],_0x53a5e7=[_0x5c55aa['body'][_0x554786(0xec)]],_0x297069=[_0x5c55aa['body'][_0x554786(0x187)]],_0x452ac2=[_0x5c55aa[_0x554786(0xea)]['batch_code']],_0x58c65d=[_0x5c55aa[_0x554786(0xea)]['expiry_date']],_0x465f23=[_0x5c55aa[_0x554786(0xea)][_0x554786(0x191)]],_0x12722a=[_0x5c55aa[_0x554786(0xea)]['max_product_unit']],_0x3257ae=[_0x5c55aa[_0x554786(0xea)][_0x554786(0x1a4)]],_0x599f0d=[_0x5c55aa[_0x554786(0xea)]['RoomAssign']],_0x10c64a=[_0x5c55aa[_0x554786(0xea)][_0x554786(0xf9)]];else var _0x9da39a=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0xdd)]],_0x5d5413=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0x1a5)]],_0x1a7271=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0x103)]],_0x57b8db=[..._0x5c55aa['body'][_0x554786(0x13a)]],_0x5f42ad=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0x1af)]],_0x586fee=[..._0x5c55aa['body']['prod_level']],_0x42d9ed=[..._0x5c55aa['body'][_0x554786(0xe3)]],_0x53a5e7=[..._0x5c55aa['body'][_0x554786(0xec)]],_0x297069=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0x187)]],_0x452ac2=[..._0x5c55aa['body']['batch_code']],_0x58c65d=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0x1e9)]],_0x465f23=[..._0x5c55aa[_0x554786(0xea)]['product_date']],_0x12722a=[..._0x5c55aa['body'][_0x554786(0xe4)]],_0x3257ae=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0x1a4)]],_0x599f0d=[..._0x5c55aa[_0x554786(0xea)][_0x554786(0xeb)]],_0x10c64a=[..._0x5c55aa['body'][_0x554786(0xf9)]];const _0x466020=_0x9da39a[_0x554786(0x1ac)](_0x606265=>{return _0x606265={'product_name':_0x606265};});_0x5d5413[_0x554786(0x188)]((_0x1dc9fd,_0x32778c)=>{var _0x253e1d=_0x554786;_0x466020[_0x32778c][_0x253e1d(0xfd)]=_0x1dc9fd,_0x466020[_0x32778c][_0x253e1d(0x102)]=_0x197bbb;}),_0x1a7271[_0x554786(0x188)]((_0x3e0445,_0x1657f5)=>{var _0x527f82=_0x554786;_0x466020[_0x1657f5][_0x527f82(0xfe)]=Math[_0x527f82(0xe7)](_0x3e0445);}),_0x57b8db['forEach']((_0x1d0c07,_0x4d0640)=>{var _0x3b6c1e=_0x554786;_0x466020[_0x4d0640][_0x3b6c1e(0x153)]=_0x1d0c07;}),_0x5f42ad[_0x554786(0x188)]((_0x5dc5fa,_0x56784a)=>{var _0x38c04c=_0x554786;_0x466020[_0x56784a][_0x38c04c(0x196)]=_0x5dc5fa;}),_0x586fee[_0x554786(0x188)]((_0x5f505e,_0x1a0f5c)=>{_0x466020[_0x1a0f5c]['bay']=_0x5f505e;}),_0x42d9ed[_0x554786(0x188)]((_0x306fe7,_0x42a642)=>{var _0x1608e5=_0x554786;_0x466020[_0x42a642][_0x1608e5(0xe3)]=_0x306fe7;}),_0x53a5e7['forEach']((_0x527225,_0x124dd6)=>{var _0x26f587=_0x554786;_0x466020[_0x124dd6][_0x26f587(0xec)]=_0x527225;}),_0x297069[_0x554786(0x188)]((_0x1a3d0c,_0x5c711e)=>{_0x466020[_0x5c711e]['maxStocks']=_0x1a3d0c;}),_0x452ac2[_0x554786(0x188)]((_0x43a174,_0x39e7ea)=>{var _0x3480df=_0x554786;_0x466020[_0x39e7ea][_0x3480df(0x1bc)]=_0x43a174;}),_0x58c65d[_0x554786(0x188)]((_0x4c609e,_0x503669)=>{var _0x6ba299=_0x554786;_0x466020[_0x503669][_0x6ba299(0x1e9)]=_0x4c609e;}),_0x465f23[_0x554786(0x188)]((_0x2b6ecd,_0x437ec6)=>{_0x466020[_0x437ec6]['production_date']=_0x2b6ecd;}),_0x12722a[_0x554786(0x188)]((_0xec9b9c,_0x3af2dc)=>{var _0x55a060=_0x554786;_0x466020[_0x3af2dc][_0x55a060(0xf2)]=_0xec9b9c;}),_0x3257ae[_0x554786(0x188)]((_0x46fc1f,_0x3130bb)=>{var _0x24af67=_0x554786;_0x466020[_0x3130bb][_0x24af67(0x14a)]=_0x46fc1f;}),_0x599f0d[_0x554786(0x188)]((_0x1ac70f,_0x3d782d)=>{var _0x475da1=_0x554786;_0x466020[_0x3d782d][_0x475da1(0x10a)]=_0x1ac70f;}),_0x10c64a[_0x554786(0x188)]((_0x260783,_0x458bb8)=>{var _0x1937bd=_0x554786;_0x466020[_0x458bb8][_0x1937bd(0x173)]=_0x260783;});const _0x3e27ea=_0x466020[_0x554786(0xf0)](_0xce18eb=>_0xce18eb[_0x554786(0xfe)]!=='0'&&_0xce18eb[_0x554786(0xfe)]!==''),_0x12906c=new purchases_finished({'invoice':_0x5d914d,'suppliers':_0x5c55aa[_0x554786(0xea)][_0x554786(0x1b7)],'date':_0x197bbb,'warehouse_name':_0x3cb3f6,'product':_0x3e27ea,'note':_0x2dca59,'due_amount':_0x536f8b,'room':_0x4949b6,'POnumber':_0x59137a,'SCRN':_0x331912,'JO_number':_0x283580}),_0x134b4e=await _0x12906c[_0x554786(0x179)](),_0x41a4f6=await purchases_finished[_0x554786(0x10c)]({'invoice':_0x5d914d}),_0x59a3f3=_0x41a4f6[_0x554786(0x157)][_0x554786(0x1ac)](async _0x411639=>{var _0x348790=_0x554786;try{var _0x3ab053=await warehouse[_0x348790(0x10c)]({'name':_0x3cb3f6,'room':_0x411639[_0x348790(0x10a)]}),_0x1cca8c=0x0;const _0x525efa=_0x3ab053[_0x348790(0x126)][_0x348790(0x1ac)](_0x118b94=>{var _0x40d25e=_0x348790;console['log'](_0x118b94[_0x40d25e(0x1ea)]+'=='+_0x411639['product_name']+'&&'+_0x118b94['bay']+'=='+_0x411639[_0x40d25e(0x12f)]+'&&'+_0x118b94['expiry_date']+'=='+_0x411639[_0x40d25e(0x1e9)]+'&&'+_0x118b94[_0x40d25e(0x17f)]+'=='+_0x411639[_0x40d25e(0x17f)]+'&&'+_0x118b94[_0x40d25e(0x1bc)]+'=='+_0x411639[_0x40d25e(0x1bc)]+'&&'+_0x118b94[_0x40d25e(0x173)]+'=='+_0x41a4f6[_0x40d25e(0x173)]),_0x118b94[_0x40d25e(0x1ea)]==_0x411639[_0x40d25e(0x1ea)]&&_0x118b94['bay']==_0x411639[_0x40d25e(0x12f)]&&_0x118b94[_0x40d25e(0x1e9)]==_0x411639[_0x40d25e(0x1e9)]&&_0x118b94['production_date']==_0x411639['production_date']&&_0x118b94[_0x40d25e(0x1bc)]==_0x411639[_0x40d25e(0x1bc)]&&_0x118b94[_0x40d25e(0x173)]==_0x41a4f6[_0x40d25e(0x173)]&&(_0x118b94['product_stock']=Math[_0x40d25e(0xe7)](_0x118b94[_0x40d25e(0x11d)])+Math['abs'](_0x411639['quantity']),_0x1cca8c++);});return _0x1cca8c==0x0&&(_0x3ab053['product_details']=_0x3ab053['product_details']['concat']({'product_name':_0x411639[_0x348790(0x1ea)],'product_stock':Math[_0x348790(0xe7)](_0x411639[_0x348790(0xfe)]),'primary_code':_0x411639[_0x348790(0xe3)],'secondary_code':_0x411639[_0x348790(0xec)],'product_code':_0x411639['product_code'],'bay':_0x411639[_0x348790(0x12f)],'maxProducts':_0x411639[_0x348790(0x127)],'unit':_0x411639[_0x348790(0x153)],'secondary_unit':_0x411639['secondary_unit'],'expiry_date':_0x411639[_0x348790(0x1e9)],'production_date':_0x411639[_0x348790(0x17f)],'maxProducts':_0x411639[_0x348790(0x127)],'maxPerUnit':_0x411639[_0x348790(0xf2)],'batch_code':_0x411639[_0x348790(0x1bc)],'product_cat':_0x411639[_0x348790(0x14a)],'invoice':_0x411639['invoice'],'id_incoming':_0x411639['_id'],'date_data':_0x411639[_0x348790(0x102)]})),_0x3ab053;}catch(_0x690b0e){return console[_0x348790(0x1d5)]('Error\x20occurred\x20while\x20processing\x20product:',_0x690b0e),null;}});Promise[_0x554786(0xcc)](_0x59a3f3)[_0x554786(0xe0)](async _0x317266=>{var _0x171a20=_0x554786;try{for(const _0x11b53d of _0x317266){await warehouse['updateOne']({'_id':_0x11b53d[_0x171a20(0x142)]},{'$addToSet':{'product_details':{'$each':_0x11b53d[_0x171a20(0x126)]}}});}const _0x265988=await master_shop[_0x171a20(0x14b)](),_0x5d3bb2=await email_settings[_0x171a20(0x10c)](),_0x3a19ea=await supervisor_settings[_0x171a20(0x14b)]();var _0x28bc4f=_0x41a4f6[_0x171a20(0x157)],_0x408526='',_0x2b026f;for(_0x2b026f in _0x28bc4f){var _0x3dd232='FG';_0x41a4f6[_0x171a20(0xcf)]==_0x171a20(0x1d4)&&(_0x3dd232='DG'),_0x408526+=_0x171a20(0x17d)+_0x171a20(0x106)+_0x28bc4f[_0x2b026f]['product_name']+_0x171a20(0x17c)+_0x171a20(0x106)+_0x28bc4f[_0x2b026f][_0x171a20(0xfd)]+'</td>'+_0x171a20(0x106)+_0x28bc4f[_0x2b026f][_0x171a20(0xfe)]+_0x171a20(0x17c)+_0x171a20(0x106)+_0x28bc4f[_0x2b026f][_0x171a20(0x153)]+_0x171a20(0x17c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x28bc4f[_0x2b026f][_0x171a20(0x196)]+_0x171a20(0x17c)+_0x171a20(0x106)+_0x41a4f6[_0x171a20(0xcf)]+_0x171a20(0x17c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x28bc4f[_0x2b026f][_0x171a20(0x10a)]+_0x171a20(0x17c)+_0x171a20(0x106)+_0x3dd232+_0x28bc4f[_0x2b026f][_0x171a20(0x12f)]+'</td>',_0x171a20(0x1d0);}let _0x5abb0b=nodemailer[_0x171a20(0x104)]({'host':_0x5d3bb2['host'],'port':Number(_0x5d3bb2[_0x171a20(0x144)]),'secure':![],'auth':{'user':_0x5d3bb2[_0x171a20(0x13c)],'pass':_0x5d3bb2[_0x171a20(0x168)]}}),_0x567bc3={'from':_0x5d3bb2[_0x171a20(0x13c)],'to':_0x3a19ea[0x0][_0x171a20(0xd9)],'subject':_0x171a20(0x1e6),'attachments':[{'filename':_0x171a20(0x1db),'path':__dirname+_0x171a20(0x178)+_0x171a20(0x1e0)+_0x265988[0x0][_0x171a20(0x119)],'cid':_0x171a20(0x1e2)}],'html':_0x171a20(0x14d)+_0x171a20(0xce)+_0x171a20(0x150)+'<div>'+_0x171a20(0x1d7)+_0x171a20(0xd0)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x171a20(0x1c0)+_0x171a20(0xd0)+_0x171a20(0x1b9)+_0x265988[0x0][_0x171a20(0xdb)]+'\x20</h2>'+'</div>'+'</div>'+_0x171a20(0x1a9)+_0x171a20(0xd0)+_0x171a20(0x145)+_0x171a20(0x15b)+_0x41a4f6[_0x171a20(0x173)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x171a20(0x170)+_0x41a4f6['date']+'\x20'+_0x171a20(0x1ab)+_0x171a20(0x10e)+_0x171a20(0x1c0)+_0x171a20(0x189)+_0x171a20(0x194)+'<tr>'+_0x171a20(0x198)+_0x171a20(0xda)+_0x171a20(0xe8)+_0x171a20(0x125)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x171a20(0x128)+_0x171a20(0xf7)+_0x171a20(0x140)+'</tr>'+_0x171a20(0x1dd)+_0x171a20(0x19b)+'\x20'+_0x408526+'\x20'+_0x171a20(0x1aa)+'</table>'+'<div>'+_0x171a20(0x1d6)+'<h5>'+_0x265988[0x0][_0x171a20(0xdb)]+_0x171a20(0x10e)+_0x171a20(0x1c0)+_0x171a20(0x1c0)+_0x171a20(0x1d2)};_0x5abb0b[_0x171a20(0x123)](_0x567bc3,function(_0x11c684,_0x3b855d){var _0x15b989=_0x171a20;_0x11c684?(console['log'](_0x11c684),console[_0x15b989(0xfb)]('Error\x20Occurs')):console[_0x15b989(0xfb)](_0x15b989(0x1ec));});}catch(_0x51111f){console['error'](_0x51111f),_0x26eb3a[_0x171a20(0x114)](0x1f4)[_0x171a20(0x186)]({'error':_0x171a20(0x118),'message':_0x51111f[_0x171a20(0x19c)]});}})['catch'](_0x5add9c=>{var _0x542567=_0x554786;console[_0x542567(0x1d5)](_0x5add9c);}),_0x5c55aa[_0x554786(0x1cb)](_0x554786(0x115),_0x554786(0x111)),_0x26eb3a[_0x554786(0x100)](_0x554786(0x1d9));}catch(_0x376d14){console[_0x554786(0xfb)](_0x376d14);}}),router[a0_0x36666b(0xde)]('/preview/:id',auth,async(_0x52c50d,_0x3a5758)=>{var _0x36c2f3=a0_0x36666b;try{const {username:_0x1b6ca8,email:_0x5b5b7a,role:_0x23b71d}=_0x52c50d[_0x36c2f3(0x1eb)],_0x3050d0=_0x52c50d[_0x36c2f3(0x1eb)],_0x23dff8=await profile[_0x36c2f3(0x10c)]({'email':_0x3050d0['email']}),_0x22bf9d=await master_shop[_0x36c2f3(0x14b)](),_0x54cf9d=_0x52c50d['params']['id'],_0x4f2e76=await purchases_finished['findById'](_0x54cf9d),_0x2cb6bb=await suppliers[_0x36c2f3(0x14b)]({});let _0x7b05ae;if(_0x3050d0[_0x36c2f3(0x11b)]==_0x36c2f3(0xd8)){const _0x4313c9=await staff[_0x36c2f3(0x10c)]({'email':_0x3050d0[_0x36c2f3(0x13c)]});_0x7b05ae=await warehouse[_0x36c2f3(0x14b)]({'status':_0x36c2f3(0x169),'name':_0x4313c9['warehouse'],'warehouse_category':_0x36c2f3(0x154)});}else _0x7b05ae=await warehouse[_0x36c2f3(0x16e)]([{'$match':{'status':_0x36c2f3(0x169),'warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x36c2f3(0x1de),'name':{'$first':'$name'}}}]);const _0x14f0c7=await product[_0x36c2f3(0x14b)]({}),_0x105329=BayBinSelected(_0x4f2e76[_0x36c2f3(0xcf)],_0x4f2e76[_0x36c2f3(0x1ae)]);let _0x3c7b2a=new Date(_0x4f2e76[_0x36c2f3(0x1e9)]),_0x21ff40=('0'+_0x3c7b2a[_0x36c2f3(0x1e8)]())[_0x36c2f3(0x16d)](-0x2),_0x4dcc88=('0'+(_0x3c7b2a[_0x36c2f3(0x1cf)]()+0x1))[_0x36c2f3(0x16d)](-0x2),_0x449f07=_0x3c7b2a[_0x36c2f3(0x1e3)](),_0x2660b6=_0x449f07+'-'+_0x4dcc88+'-'+_0x21ff40;if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]==_0x36c2f3(0x15a)){var _0x338090=users[_0x36c2f3(0x1b0)];console[_0x36c2f3(0xfb)](_0x338090);}else{if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]==_0x36c2f3(0x131))var _0x338090=users['Hindi'];else{if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]==_0x36c2f3(0x143))var _0x338090=users[_0x36c2f3(0x143)];else{if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]==_0x36c2f3(0x13e))var _0x338090=users[_0x36c2f3(0x13e)];else{if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]=='French')var _0x338090=users[_0x36c2f3(0x192)];else{if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]=='Portuguese\x20(BR)')var _0x338090=users['Portuguese'];else{if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]=='Chinese')var _0x338090=users[_0x36c2f3(0x1cd)];else{if(_0x22bf9d[0x0][_0x36c2f3(0xe9)]==_0x36c2f3(0x190))var _0x338090=users[_0x36c2f3(0x147)];}}}}}}}_0x3a5758[_0x36c2f3(0x177)](_0x36c2f3(0x12d),{'success':_0x52c50d[_0x36c2f3(0x1cb)](_0x36c2f3(0x115)),'errors':_0x52c50d[_0x36c2f3(0x1cb)]('errors'),'role':_0x3050d0,'profile':_0x23dff8,'purchases':_0x4f2e76,'suppliers':_0x2cb6bb,'warehouse':_0x7b05ae,'product':_0x14f0c7,'master_shop':_0x22bf9d,'language':_0x338090,'ed_fullDate':_0x2660b6,'dataSelected':_0x105329});}catch(_0x2a9833){console[_0x36c2f3(0xfb)](_0x2a9833);}}),router[a0_0x36666b(0xde)]('/view/:id',auth,async(_0x43c9e7,_0x94c5ba)=>{var _0x3bd591=a0_0x36666b;try{const {username:_0x1e6886,email:_0x58565c,role:_0x25b05e}=_0x43c9e7[_0x3bd591(0x1eb)],_0x31b72d=_0x43c9e7['user'],_0x62e88f=await profile[_0x3bd591(0x10c)]({'email':_0x31b72d[_0x3bd591(0x13c)]}),_0x305313=await master_shop[_0x3bd591(0x14b)](),_0x3d38cb=_0x43c9e7[_0x3bd591(0x197)]['id'],_0x9112c2=await purchases_finished[_0x3bd591(0x1c1)](_0x3d38cb),_0x276fbd=await suppliers[_0x3bd591(0x14b)]({});let _0x1acc03;if(_0x31b72d[_0x3bd591(0x11b)]==_0x3bd591(0xd8)){const _0x2c8d32=await staff['findOne']({'email':_0x31b72d[_0x3bd591(0x13c)]});_0x1acc03=await warehouse[_0x3bd591(0x14b)]({'status':_0x3bd591(0x169),'name':_0x2c8d32[_0x3bd591(0x17e)],'warehouse_category':_0x3bd591(0x154)});}else _0x1acc03=await warehouse['aggregate']([{'$match':{'status':_0x3bd591(0x169),'warehouse_category':_0x3bd591(0x154)}},{'$group':{'_id':_0x3bd591(0x1de),'name':{'$first':'$name'}}}]);const _0xce98cd=await product[_0x3bd591(0x14b)]({}),_0x53b726=BayBinSelected(_0x9112c2[_0x3bd591(0xcf)],_0x9112c2['room']);let _0x5057ba=new Date(_0x9112c2[_0x3bd591(0x1e9)]),_0x3f5bf0=('0'+_0x5057ba[_0x3bd591(0x1e8)]())[_0x3bd591(0x16d)](-0x2),_0x511a7f=('0'+(_0x5057ba[_0x3bd591(0x1cf)]()+0x1))[_0x3bd591(0x16d)](-0x2),_0x364f62=_0x5057ba[_0x3bd591(0x1e3)](),_0x6548e9=_0x364f62+'-'+_0x511a7f+'-'+_0x3f5bf0;if(_0x305313[0x0][_0x3bd591(0xe9)]==_0x3bd591(0x15a)){var _0x43feb4=users[_0x3bd591(0x1b0)];console[_0x3bd591(0xfb)](_0x43feb4);}else{if(_0x305313[0x0][_0x3bd591(0xe9)]==_0x3bd591(0x131))var _0x43feb4=users[_0x3bd591(0x131)];else{if(_0x305313[0x0][_0x3bd591(0xe9)]=='German')var _0x43feb4=users[_0x3bd591(0x143)];else{if(_0x305313[0x0][_0x3bd591(0xe9)]=='Spanish')var _0x43feb4=users[_0x3bd591(0x13e)];else{if(_0x305313[0x0][_0x3bd591(0xe9)]==_0x3bd591(0x192))var _0x43feb4=users[_0x3bd591(0x192)];else{if(_0x305313[0x0][_0x3bd591(0xe9)]==_0x3bd591(0x1e5))var _0x43feb4=users[_0x3bd591(0x112)];else{if(_0x305313[0x0]['language']==_0x3bd591(0x1cd))var _0x43feb4=users[_0x3bd591(0x1cd)];else{if(_0x305313[0x0][_0x3bd591(0xe9)]=='Arabic\x20(ae)')var _0x43feb4=users[_0x3bd591(0x147)];}}}}}}}_0x94c5ba[_0x3bd591(0x177)](_0x3bd591(0x16f),{'success':_0x43c9e7['flash'](_0x3bd591(0x115)),'errors':_0x43c9e7['flash'](_0x3bd591(0x174)),'role':_0x31b72d,'profile':_0x62e88f,'purchases':_0x9112c2,'suppliers':_0x276fbd,'warehouse':_0x1acc03,'product':_0xce98cd,'master_shop':_0x305313,'language':_0x43feb4,'ed_fullDate':_0x6548e9,'dataSelected':_0x53b726});}catch(_0x3ebc35){console[_0x3bd591(0xfb)](_0x3ebc35);}}),router['post'](a0_0x36666b(0x149),auth,async(_0x5ea7ec,_0x4ef386)=>{var _0x932d04=a0_0x36666b;try{const _0x2c55a3=_0x5ea7ec['params']['id'],_0x2901d3=await purchases_finished[_0x932d04(0x10c)]({'_id':_0x5ea7ec[_0x932d04(0x197)]['id']}),_0x48c85f=await warehouse[_0x932d04(0x10c)]({'name':_0x2901d3[_0x932d04(0xcf)],'room':_0x2901d3['room']});_0x2901d3[_0x932d04(0x157)][_0x932d04(0x188)](_0x25a1df=>{var _0x2ea109=_0x932d04;const _0x2c143f=_0x48c85f[_0x2ea109(0x126)][_0x2ea109(0x1ac)](_0x2d6bee=>{var _0x4cfda1=_0x2ea109;_0x2d6bee[_0x4cfda1(0x1ea)]==_0x25a1df[_0x4cfda1(0x1ea)]&&_0x2d6bee[_0x4cfda1(0x12f)]==_0x25a1df[_0x4cfda1(0x12f)]&&(_0x2d6bee[_0x4cfda1(0x11d)]=parseInt(_0x2d6bee[_0x4cfda1(0x11d)])-parseInt(_0x25a1df[_0x4cfda1(0xfe)]));});}),await _0x48c85f[_0x932d04(0x179)]();const {invoice:_0x397f59,suppliers:_0x334fe9,date:_0x139d67,warehouse_name:_0x13c67c,prod_name:_0x1a1787,prod_code:_0x38b460,prod_qty:_0x26405e,prod_unit:_0x2144f2,prod_secondunit:_0xc4334f,prod_level:_0x29dd48,prod_isle:_0x5ba410,prod_pallet:_0x48ab8c,note:_0x187a40,expiry_date:_0x38bd6f,batch_code:_0x36f180,paid_amount:_0x598eb5,due_amount:_0x28afbd,Room_name:_0x576b82,primary_code:_0x18b9b2,secondary_code:_0x297c1b,PO_number:_0x279a9b,JO_number:_0x42156e}=_0x5ea7ec['body'];if(typeof _0x1a1787==_0x932d04(0x1ce))var _0x335826=[_0x5ea7ec['body'][_0x932d04(0xdd)]],_0x5a8580=[_0x5ea7ec['body'][_0x932d04(0x1a5)]],_0x43025a=[_0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x11e)]],_0xa7134=[_0x5ea7ec['body'][_0x932d04(0x1bd)]],_0x297672=[_0x5ea7ec['body']['prod_secondunit']],_0x2aafb5=[_0x5ea7ec['body'][_0x932d04(0x181)]],_0x33e91a=[_0x5ea7ec[_0x932d04(0xea)][_0x932d04(0xe3)]],_0x44ac14=[_0x5ea7ec['body']['secondary_code']],_0x4802ae=[_0x5ea7ec['body'][_0x932d04(0x187)]],_0x77f9b8=[_0x5ea7ec['body'][_0x932d04(0x1bc)]],_0x47f6b4=[_0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x1e9)]];else var _0x335826=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0xdd)]],_0x5a8580=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x1a5)]],_0x43025a=[..._0x5ea7ec['body']['prod_qty']],_0xa7134=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x1bd)]],_0x297672=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x1af)]],_0x2aafb5=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x181)]],_0x33e91a=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0xe3)]],_0x44ac14=[..._0x5ea7ec[_0x932d04(0xea)]['secondary_code']],_0x4802ae=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x187)]],_0x77f9b8=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x1bc)]],_0x47f6b4=[..._0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x1e9)]];const _0x374754=_0x335826[_0x932d04(0x1ac)](_0x5c31b5=>{return _0x5c31b5={'product_name':_0x5c31b5};});_0x5a8580['forEach']((_0x2a3062,_0xa1c4f3)=>{var _0x1ba1c8=_0x932d04;_0x374754[_0xa1c4f3][_0x1ba1c8(0xfd)]=_0x2a3062;}),_0x43025a[_0x932d04(0x188)]((_0x534ef8,_0x3e719d)=>{var _0x436f16=_0x932d04;_0x374754[_0x3e719d][_0x436f16(0xfe)]=_0x534ef8;}),_0xa7134[_0x932d04(0x188)]((_0x15d898,_0x479dc7)=>{var _0x560c45=_0x932d04;_0x374754[_0x479dc7][_0x560c45(0x153)]=_0x15d898;}),_0x297672[_0x932d04(0x188)]((_0x22afc1,_0x2a624d)=>{_0x374754[_0x2a624d]['secondary_unit']=_0x22afc1;}),_0x2aafb5[_0x932d04(0x188)]((_0x3738a9,_0x56dbd2)=>{_0x374754[_0x56dbd2]['bay']=_0x3738a9;}),_0x33e91a[_0x932d04(0x188)]((_0x521a0,_0x1fee2f)=>{var _0x3cf1f0=_0x932d04;_0x374754[_0x1fee2f][_0x3cf1f0(0xe3)]=_0x521a0;}),_0x44ac14[_0x932d04(0x188)]((_0x2f5b52,_0x5d22eb)=>{var _0x112b56=_0x932d04;_0x374754[_0x5d22eb][_0x112b56(0xec)]=_0x2f5b52;}),_0x4802ae[_0x932d04(0x188)]((_0x5be09d,_0xf49d83)=>{var _0x24c40e=_0x932d04;_0x374754[_0xf49d83][_0x24c40e(0x127)]=_0x5be09d;}),_0x77f9b8['forEach']((_0x76773a,_0x4fab27)=>{_0x374754[_0x4fab27]['batch_code']=_0x76773a;}),_0x47f6b4[_0x932d04(0x188)]((_0x4b0fc2,_0x1333fb)=>{var _0x16467d=_0x932d04;_0x374754[_0x1333fb][_0x16467d(0x1e9)]=_0x4b0fc2;});const _0x470db5=_0x374754[_0x932d04(0xf0)](_0x3af325=>_0x3af325[_0x932d04(0xfe)]!=='0'&&_0x3af325[_0x932d04(0xfe)]!=='');_0x2901d3['invoice']=_0x397f59,_0x2901d3['suppliers']=_0x334fe9,_0x2901d3['date']=_0x139d67,_0x2901d3[_0x932d04(0xcf)]=_0x13c67c,_0x2901d3[_0x932d04(0x157)]=_0x470db5,_0x2901d3[_0x932d04(0x1a7)]=_0x187a40,_0x2901d3['paid_amount']=_0x598eb5,_0x2901d3[_0x932d04(0x10b)]=_0x28afbd,_0x2901d3[_0x932d04(0x1ae)]=_0x576b82,_0x2901d3['POnumber']=_0x279a9b,_0x2901d3[_0x932d04(0x13b)]=_0x42156e;const _0x881f6f=await _0x2901d3[_0x932d04(0x179)](),_0x9bbf57=await warehouse[_0x932d04(0x10c)]({'name':_0x5ea7ec[_0x932d04(0xea)][_0x932d04(0xcf)],'room':_0x5ea7ec['body'][_0x932d04(0x15e)]});_0x2901d3[_0x932d04(0x157)][_0x932d04(0x188)](_0x23745b=>{var _0x2cbc0c=_0x932d04,_0x58dcb6=0x0;const _0x32fc52=_0x9bbf57[_0x2cbc0c(0x126)][_0x2cbc0c(0x1ac)](_0x2b2627=>{var _0x19313d=_0x2cbc0c;_0x2b2627['product_name']==_0x23745b[_0x19313d(0x1ea)]&&_0x2b2627['bay']==_0x23745b['bay']&&(_0x2b2627[_0x19313d(0x11d)]=parseInt(_0x2b2627[_0x19313d(0x11d)])+parseInt(_0x23745b[_0x19313d(0xfe)]),_0x58dcb6++);});_0x58dcb6=='0'&&(_0x9bbf57['product_details']=_0x9bbf57[_0x2cbc0c(0x126)]['concat']({'product_name':_0x23745b[_0x2cbc0c(0x1ea)],'product_stock':_0x23745b[_0x2cbc0c(0xfe)],'primary_code':_0x23745b[_0x2cbc0c(0xe3)],'secondary_code':_0x23745b['secondary_code'],'product_code':_0x23745b[_0x2cbc0c(0xfd)],'bay':_0x23745b[_0x2cbc0c(0x12f)],'maxProducts':_0x23745b['maxStocks'],'unit':_0x23745b[_0x2cbc0c(0x153)],'secondary_unit':_0x23745b[_0x2cbc0c(0x196)],'expiry_date':_0x23745b[_0x2cbc0c(0x1e9)]}));}),await _0x9bbf57[_0x932d04(0x179)]();const _0x1a1ac1=await s_payment_data[_0x932d04(0x10c)]({'invoice':_0x5ea7ec['body'][_0x932d04(0x173)]});if(_0x1a1ac1===null){}else console[_0x932d04(0xfb)](_0x932d04(0x1b7),_0x1a1ac1,_0x5ea7ec['body'][_0x932d04(0x173)]),_0x1a1ac1[_0x932d04(0x1b7)]=_0x5ea7ec[_0x932d04(0xea)][_0x932d04(0x1b7)],await _0x1a1ac1[_0x932d04(0x179)]();_0x5ea7ec[_0x932d04(0x1cb)](_0x932d04(0x115),_0x932d04(0x1b3)),_0x4ef386[_0x932d04(0x100)](_0x932d04(0x1d9));}catch(_0x105982){console[_0x932d04(0xfb)](_0x105982);}}),router['post'](a0_0x36666b(0xe5),auth,async(_0x13db7e,_0x5e02f0)=>{var _0x555159=a0_0x36666b;try{const _0x1aeeb9=_0x13db7e[_0x555159(0x197)]['id'],{invoice:_0x1a0527,suppliers:_0xf43a85,payable:_0x502dfc,due_amount:_0x2e6ab2}=_0x13db7e[_0x555159(0xea)],_0x3ced4d=await purchases[_0x555159(0x1c1)](_0x1aeeb9);var _0x2af0e8=_0x502dfc-_0x2e6ab2;_0x3ced4d[_0x555159(0x164)]=parseFloat(_0x3ced4d[_0x555159(0x164)])+parseFloat(_0x2e6ab2),_0x3ced4d['due_amount']=_0x2af0e8;const _0x84fbf2=await _0x3ced4d[_0x555159(0x179)]();console[_0x555159(0xfb)](_0x84fbf2);const _0xa3ad6=await s_payment_data[_0x555159(0x10c)]({'invoice':_0x1a0527});_0xa3ad6[_0x555159(0x138)]=_0x2af0e8,await _0xa3ad6['save']();let _0x12df10=new Date(),_0x4ea05d=('0'+_0x12df10['getDate']())['slice'](-0x2),_0x9af188=('0'+(_0x12df10[_0x555159(0x1cf)]()+0x1))[_0x555159(0x16d)](-0x2),_0x4d3023=_0x12df10[_0x555159(0x1e3)](),_0x2cef33=_0x4d3023+'-'+_0x9af188+'-'+_0x4ea05d;const _0x4f40a7=new suppliers_payment({'invoice':_0x1a0527,'date':_0x4d3023+'-'+_0x9af188+'-'+_0x4ea05d,'suppliers':_0xf43a85,'reason':_0x555159(0x1d8),'amount':_0x2e6ab2}),_0x16123c=await _0x4f40a7[_0x555159(0x179)]();_0x13db7e[_0x555159(0x1cb)]('success',_0x555159(0x1a3)),_0x5e02f0['redirect'](_0x555159(0x1b2));}catch(_0x2abc4f){console[_0x555159(0xfb)](_0x2abc4f);}}),router[a0_0x36666b(0xde)](a0_0x36666b(0x1b8),auth,async(_0x5944a0,_0x52d174)=>{var _0x3b9a26=a0_0x36666b;try{const {username:_0xa03390,email:_0x648a5f,role:_0x1438ae}=_0x5944a0['user'],_0x56e311=_0x5944a0['user'],_0x314a43=await profile['findOne']({'email':_0x56e311[_0x3b9a26(0x13c)]}),_0xe3513=await master_shop[_0x3b9a26(0x14b)]();console['log'](_0x3b9a26(0x148),_0xe3513);const _0x3bfaf5=_0x5944a0[_0x3b9a26(0x197)]['id'],_0x2f80f9=await purchases['findById'](_0x3bfaf5);console[_0x3b9a26(0xfb)](_0x2f80f9);const _0x125820=await suppliers[_0x3b9a26(0x10c)]({'name':_0x2f80f9['suppliers']});console['log'](_0x125820);if(_0xe3513[0x0][_0x3b9a26(0xe9)]==_0x3b9a26(0x15a)){var _0x384342=users[_0x3b9a26(0x1b0)];console[_0x3b9a26(0xfb)](_0x384342);}else{if(_0xe3513[0x0][_0x3b9a26(0xe9)]==_0x3b9a26(0x131))var _0x384342=users[_0x3b9a26(0x131)];else{if(_0xe3513[0x0][_0x3b9a26(0xe9)]=='German')var _0x384342=users[_0x3b9a26(0x143)];else{if(_0xe3513[0x0]['language']==_0x3b9a26(0x13e))var _0x384342=users[_0x3b9a26(0x13e)];else{if(_0xe3513[0x0][_0x3b9a26(0xe9)]==_0x3b9a26(0x192))var _0x384342=users['French'];else{if(_0xe3513[0x0][_0x3b9a26(0xe9)]==_0x3b9a26(0x1e5))var _0x384342=users[_0x3b9a26(0x112)];else{if(_0xe3513[0x0][_0x3b9a26(0xe9)]==_0x3b9a26(0x1cd))var _0x384342=users[_0x3b9a26(0x1cd)];else{if(_0xe3513[0x0][_0x3b9a26(0xe9)]==_0x3b9a26(0x190))var _0x384342=users[_0x3b9a26(0x147)];}}}}}}}_0x52d174[_0x3b9a26(0x177)](_0x3b9a26(0x1b6),{'success':_0x5944a0[_0x3b9a26(0x1cb)]('success'),'errors':_0x5944a0[_0x3b9a26(0x1cb)](_0x3b9a26(0x174)),'role':_0x56e311,'profile':_0x314a43,'master_shop':_0xe3513,'supplier':_0x125820,'purchase':_0x2f80f9,'language':_0x384342});}catch(_0x199a6d){console[_0x3b9a26(0xfb)](_0x199a6d);}}),router['get'](a0_0x36666b(0x1cc),auth,async(_0x2ee9b8,_0x1b5bc8)=>{var _0x364ca4=a0_0x36666b;try{const {username:_0x54e451,email:_0xa64a8f,role:_0x4a09d6}=_0x2ee9b8[_0x364ca4(0x1eb)],_0xed4f5=_0x2ee9b8[_0x364ca4(0x1eb)],_0x2f343c=await profile[_0x364ca4(0x10c)]({'email':_0xed4f5[_0x364ca4(0x13c)]}),_0x50435f=await master_shop[_0x364ca4(0x14b)]();console['log'](_0x364ca4(0x148),_0x50435f);const _0x5919b2=_0x2ee9b8[_0x364ca4(0x197)]['id'];console[_0x364ca4(0xfb)](_0x5919b2);const _0x4b8528=await purchases_finished[_0x364ca4(0x1c1)](_0x5919b2);console[_0x364ca4(0xfb)](_0x364ca4(0x1ef),_0x4b8528);const _0x1db96c=await product[_0x364ca4(0x14b)]({}),_0x3afb7e=await warehouse[_0x364ca4(0x16e)]([{'$match':{'name':_0x4b8528['warehouse_name'],'room':_0x4b8528[_0x364ca4(0x1ae)]}},{'$unwind':_0x364ca4(0x172)},{'$group':{'_id':_0x364ca4(0x109),'name':{'$first':_0x364ca4(0x1a8)},'product_stock':{'$first':_0x364ca4(0x159)},'bay':{'$first':_0x364ca4(0x19f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x364ca4(0x180)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x364ca4(0x165)},'product_code':{'$first':_0x364ca4(0xef)},'storage':{'$first':_0x364ca4(0x175)},'rack':{'$first':'$product_details.rack'}}}]);console['log']('stock_data',_0x3afb7e);let _0xe1b8c3;if(_0xed4f5[_0x364ca4(0x11b)]==_0x364ca4(0xd8)){const _0x291f1d=await staff['findOne']({'email':_0xed4f5[_0x364ca4(0x13c)]});_0xe1b8c3=await warehouse[_0x364ca4(0x14b)]({'status':_0x364ca4(0x169),'name':_0x291f1d[_0x364ca4(0x17e)],'warehouse_category':_0x364ca4(0x154),'name':_0x364ca4(0xed)});}else _0xe1b8c3=await warehouse[_0x364ca4(0x16e)]([{'$match':{'status':_0x364ca4(0x169),'warehouse_category':_0x364ca4(0x154),'name':'Return\x20Goods'}},{'$group':{'_id':_0x364ca4(0x1de),'name':{'$first':_0x364ca4(0x1de)}}}]);if(_0x50435f[0x0][_0x364ca4(0xe9)]==_0x364ca4(0x15a)){var _0x199692=users[_0x364ca4(0x1b0)];console[_0x364ca4(0xfb)](_0x199692);}else{if(_0x50435f[0x0]['language']==_0x364ca4(0x131))var _0x199692=users[_0x364ca4(0x131)];else{if(_0x50435f[0x0][_0x364ca4(0xe9)]==_0x364ca4(0x143))var _0x199692=users['German'];else{if(_0x50435f[0x0][_0x364ca4(0xe9)]==_0x364ca4(0x13e))var _0x199692=users[_0x364ca4(0x13e)];else{if(_0x50435f[0x0]['language']==_0x364ca4(0x192))var _0x199692=users[_0x364ca4(0x192)];else{if(_0x50435f[0x0][_0x364ca4(0xe9)]==_0x364ca4(0x1e5))var _0x199692=users[_0x364ca4(0x112)];else{if(_0x50435f[0x0]['language']==_0x364ca4(0x1cd))var _0x199692=users[_0x364ca4(0x1cd)];else{if(_0x50435f[0x0][_0x364ca4(0xe9)]=='Arabic\x20(ae)')var _0x199692=users['Arabic'];}}}}}}}_0x1b5bc8['render'](_0x364ca4(0x1c3),{'success':_0x2ee9b8[_0x364ca4(0x1cb)](_0x364ca4(0x115)),'errors':_0x2ee9b8[_0x364ca4(0x1cb)]('errors'),'role':_0xed4f5,'profile':_0x2f343c,'user':_0x4b8528,'stock':_0x3afb7e,'master_shop':_0x50435f,'product':_0x1db96c,'language':_0x199692,'warehouse':_0xe1b8c3});}catch(_0x233b80){console[_0x364ca4(0xfb)](_0x233b80);}}),router[a0_0x36666b(0xcd)](a0_0x36666b(0x1cc),auth,async(_0x32a023,_0x497627)=>{var _0x4e3795=a0_0x36666b;try{const {invoice:_0x3a8d69,date:_0x1d8180,warehouse_name:_0x3af567,Room_name:_0x1a0985,product_name:_0x1f3096,purchase_quantity:_0x547604,stocks:_0x51dd22,return_qty:_0x1c44e6,note:_0x4dfb5a,level:_0x3d5ca3,isle:_0x390a54,pallet:_0x4385e9,to_warehouse_name:_0x42d0d2,to_Room_name:_0x121d96}=_0x32a023['body'],_0x5015da=await purchases_finished[_0x4e3795(0x10c)]({'_id':_0x32a023[_0x4e3795(0x197)]['id']}),_0x32ffdc=await warehouse[_0x4e3795(0x10c)]({'name':_0x3af567,'room':_0x1a0985,'warehouse_category':_0x4e3795(0x154)});if(typeof _0x1f3096==_0x4e3795(0x1ce))var _0x210189=[_0x32a023[_0x4e3795(0xea)][_0x4e3795(0x1ea)]],_0x46ef32=[_0x32a023[_0x4e3795(0xea)][_0x4e3795(0x121)]],_0x7cdcad=[_0x32a023[_0x4e3795(0xea)][_0x4e3795(0x1ca)]],_0x25e2f6=[_0x32a023['body'][_0x4e3795(0x161)]],_0x3126dc=[_0x32a023[_0x4e3795(0xea)][_0x4e3795(0xdc)]],_0x3a8fbb=[_0x32a023['body'][_0x4e3795(0x1c6)]],_0x3d7c5c=[_0x32a023[_0x4e3795(0xea)][_0x4e3795(0xf8)]],_0xf82e6=[_0x32a023[_0x4e3795(0xea)][_0x4e3795(0x130)]];else var _0x210189=[..._0x32a023[_0x4e3795(0xea)][_0x4e3795(0x1ea)]],_0x46ef32=[..._0x32a023['body'][_0x4e3795(0x121)]],_0x7cdcad=[..._0x32a023[_0x4e3795(0xea)]['stocks']],_0x25e2f6=[..._0x32a023[_0x4e3795(0xea)][_0x4e3795(0x161)]],_0x3126dc=[..._0x32a023[_0x4e3795(0xea)]['level']],_0x3a8fbb=[..._0x32a023[_0x4e3795(0xea)][_0x4e3795(0x1c6)]],_0x3d7c5c=[..._0x32a023[_0x4e3795(0xea)]['primary_code_hide']],_0xf82e6=[..._0x32a023[_0x4e3795(0xea)][_0x4e3795(0x130)]];const _0x5a1e65=_0x210189[_0x4e3795(0x1ac)](_0x1f66b3=>{return _0x1f66b3={'product_name':_0x1f66b3};});_0x46ef32['forEach']((_0x2fc815,_0x425624)=>{var _0x1a237c=_0x4e3795;_0x5a1e65[_0x425624][_0x1a237c(0x121)]=_0x2fc815;}),_0x7cdcad['forEach']((_0x3c2e2a,_0x2058ee)=>{var _0x208046=_0x4e3795;_0x5a1e65[_0x2058ee][_0x208046(0x15c)]=_0x3c2e2a;}),_0x25e2f6[_0x4e3795(0x188)]((_0xb9e4cf,_0x2739b9)=>{_0x5a1e65[_0x2739b9]['return_qty']=_0xb9e4cf;}),_0x3126dc[_0x4e3795(0x188)]((_0xb72760,_0x35e5f6)=>{var _0x39f270=_0x4e3795;_0x5a1e65[_0x35e5f6][_0x39f270(0x12f)]=_0xb72760;}),_0x3a8fbb[_0x4e3795(0x188)]((_0x465f76,_0x53e617)=>{_0x5a1e65[_0x53e617]['product_code']=_0x465f76;}),_0x3d7c5c['forEach']((_0x345b68,_0xb2b972)=>{var _0x2b4dda=_0x4e3795;_0x5a1e65[_0xb2b972][_0x2b4dda(0xe3)]=_0x345b68;}),_0xf82e6[_0x4e3795(0x188)]((_0x34549e,_0x2b9dcb)=>{var _0x4c3e20=_0x4e3795;_0x5a1e65[_0x2b9dcb][_0x4c3e20(0xec)]=_0x34549e;}),_0x5a1e65[_0x4e3795(0x188)](_0x3eb984=>{var _0x789b85=_0x4e3795;console[_0x789b85(0xfb)](_0x3eb984);const _0x3cee70=_0x32ffdc[_0x789b85(0x126)]['map'](_0x3ce276=>{var _0x321e82=_0x789b85;_0x3ce276[_0x321e82(0x1ea)]==_0x3eb984['product_name']&&_0x3ce276[_0x321e82(0x12f)]==_0x3eb984[_0x321e82(0x12f)]&&(console[_0x321e82(0xfb)](parseInt(_0x3ce276[_0x321e82(0x11d)])+_0x321e82(0x14f)+parseInt(_0x3eb984[_0x321e82(0x161)])),_0x3ce276[_0x321e82(0x11d)]=parseInt(_0x3ce276[_0x321e82(0x11d)])-parseInt(_0x3eb984[_0x321e82(0x161)]));});}),await _0x32ffdc[_0x4e3795(0x179)]();var _0x80ccdf=0x0;_0x5a1e65[_0x4e3795(0x188)](_0x24fdfe=>{var _0x5c60e4=_0x4e3795;(parseInt(_0x24fdfe[_0x5c60e4(0x121)])<parseInt(_0x24fdfe[_0x5c60e4(0x161)])||parseInt(_0x24fdfe['stock_quantity'])<parseInt(_0x24fdfe['return_qty']))&&_0x80ccdf++;});if(_0x80ccdf!=0x0)return _0x32a023[_0x4e3795(0x1cb)]('errors',_0x4e3795(0x107)),_0x497627['redirect'](_0x4e3795(0xe6));const _0x20340e=new purchases_return_finished({'invoice':_0x3a8d69,'suppliers':_0x32a023[_0x4e3795(0xea)][_0x4e3795(0x1b7)],'date':_0x1d8180,'warehouse_name':_0x3af567,'return_product':_0x5a1e65,'note':_0x4dfb5a,'room':_0x1a0985,'to_warehouse_name':_0x42d0d2,'to_room':_0x121d96}),_0x26c344=await _0x20340e[_0x4e3795(0x179)](),_0x536e15=await purchases_return_finished[_0x4e3795(0x10c)]({'invoice':_0x3a8d69}),_0x2b7060=await warehouse[_0x4e3795(0x10c)]({'name':_0x42d0d2,'room':_0x121d96,'warehouse_category':_0x4e3795(0x154)});_0x536e15[_0x4e3795(0xd4)][_0x4e3795(0x188)](_0x2678b4=>{var _0x35f7a=_0x4e3795,_0x14eb37=0x0;const _0x5699d9=_0x2b7060[_0x35f7a(0x126)]['map'](_0x5df7e1=>{var _0x542a02=_0x35f7a;console['log'](_0x5df7e1[_0x542a02(0x1ea)]+'=='+_0x2678b4['product_name']+'&&'+_0x5df7e1[_0x542a02(0x12f)]+'=='+_0x2678b4[_0x542a02(0x12f)]),_0x5df7e1[_0x542a02(0x1ea)]==_0x2678b4[_0x542a02(0x1ea)]&&_0x5df7e1[_0x542a02(0x12f)]==_0x2678b4[_0x542a02(0x12f)]&&(_0x5df7e1['product_stock']=parseInt(_0x5df7e1[_0x542a02(0x11d)])-parseInt(_0x2678b4['return_qty']),_0x14eb37++);});_0x14eb37=='0'&&(_0x2b7060['product_details']=_0x2b7060[_0x35f7a(0x126)]['concat']({'product_name':_0x2678b4[_0x35f7a(0x1ea)],'product_stock':_0x2678b4['return_qty'],'primary_code':_0x2678b4[_0x35f7a(0xe3)],'secondary_code':_0x2678b4[_0x35f7a(0xec)],'product_code':_0x2678b4['product_code'],'bay':_0x2678b4[_0x35f7a(0x12f)],'maxProducts':0xf423f}));}),await _0x2b7060[_0x4e3795(0x179)]();const _0xa2ac1e=await purchases_finished[_0x4e3795(0x10c)]({'invoice':_0x3a8d69});_0xa2ac1e[_0x4e3795(0x10d)]=_0x4e3795(0xd2);const _0x503b6e=await _0xa2ac1e[_0x4e3795(0x179)](),_0xd88e1=new s_payment_data({'invoice':_0x3a8d69,'suppliers':_0x32a023[_0x4e3795(0xea)]['suppliers'],'reason':_0x4e3795(0x1c4)});await _0xd88e1['save']();const _0x232046=await master_shop[_0x4e3795(0x14b)](),_0x35cff5=await email_settings[_0x4e3795(0x10c)](),_0x377f87=await suppliers[_0x4e3795(0x10c)]({'name':_0x32a023[_0x4e3795(0xea)][_0x4e3795(0x1b7)]});_0x232046[0x0][_0x4e3795(0x10f)]==0x1?(right_currency=_0x232046[0x0][_0x4e3795(0x132)],left_currency=''):(right_currency='',left_currency=_0x232046[0x0]['currency']);var _0x83c653=_0x210189,_0x4f1e26=_0x25e2f6,_0x17b527='',_0x56b4e6;for(_0x56b4e6 in _0x83c653){_0x17b527+=_0x4e3795(0x17d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x83c653[_0x56b4e6]+_0x4e3795(0x17c)+_0x4e3795(0x106)+_0x4f1e26[_0x56b4e6]+_0x4e3795(0x17c)+'</tr>';}let _0x42160b=nodemailer[_0x4e3795(0x104)]({'service':_0x4e3795(0x1a6),'auth':{'user':_0x35cff5[_0x4e3795(0x13c)],'pass':_0x35cff5[_0x4e3795(0x168)]}}),_0x26d0b5={'from':_0x35cff5[_0x4e3795(0x13c)],'to':_0x377f87['email'],'subject':_0x4e3795(0x1d3),'attachments':[{'filename':_0x4e3795(0x1db),'path':__dirname+_0x4e3795(0x178)+_0x4e3795(0x1e0)+_0x232046[0x0]['image'],'cid':_0x4e3795(0x1e2)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x4e3795(0x150)+_0x4e3795(0xd0)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x4e3795(0xd0)+_0x4e3795(0x1a2)+_0x4e3795(0x1c0)+_0x4e3795(0xd0)+_0x4e3795(0x1b9)+_0x232046[0x0]['site_title']+_0x4e3795(0xf6)+_0x4e3795(0x1c0)+_0x4e3795(0x1c0)+_0x4e3795(0x1a9)+_0x4e3795(0xd0)+_0x4e3795(0x145)+'\x20Order\x20Number\x20:\x20'+_0x3a8d69+'\x20'+_0x4e3795(0x1a0)+_0x4e3795(0x170)+_0x1d8180+'\x20'+_0x4e3795(0x1ab)+_0x4e3795(0x10e)+_0x4e3795(0x1c0)+_0x4e3795(0x189)+_0x4e3795(0x194)+'<tr>'+_0x4e3795(0x198)+_0x4e3795(0xff)+_0x4e3795(0x12b)+_0x4e3795(0x1ad)+_0x4e3795(0x1d0)+_0x4e3795(0x1dd)+_0x4e3795(0x19b)+'\x20'+_0x17b527+'\x20'+_0x4e3795(0x1aa)+_0x4e3795(0x116)+_0x4e3795(0xd0)+_0x4e3795(0x1d6)+_0x4e3795(0x15d)+_0x232046[0x0][_0x4e3795(0xdb)]+_0x4e3795(0x10e)+_0x4e3795(0x1c0)+_0x4e3795(0x1c0)+_0x4e3795(0x1d2)};_0x42160b[_0x4e3795(0x123)](_0x26d0b5,function(_0x2af6ca,_0xb5737f){var _0x5d6207=_0x4e3795;_0x2af6ca?console[_0x5d6207(0xfb)](_0x5d6207(0x152)):console[_0x5d6207(0xfb)](_0x5d6207(0x1ec));}),_0x32a023['flash'](_0x4e3795(0x115),_0x4e3795(0x146)),_0x497627['redirect'](_0x4e3795(0x1d9));}catch(_0x294ff4){_0x497627[_0x4e3795(0x114)](0xc8)[_0x4e3795(0x186)]({'message':_0x294ff4[_0x4e3795(0x19c)]});}}),router[a0_0x36666b(0xde)](a0_0x36666b(0x18f),auth,async(_0x49c603,_0x55fc39)=>{var _0x227ce9=a0_0x36666b;try{const {username:_0x29b367,email:_0x5cbbae,role:_0x5b18f6}=_0x49c603[_0x227ce9(0x1eb)],_0x3a9a08=_0x49c603[_0x227ce9(0x1eb)],_0x42036e=await profile[_0x227ce9(0x10c)]({'email':_0x3a9a08[_0x227ce9(0x13c)]}),_0x40619c=await master_shop[_0x227ce9(0x14b)](),_0x241b83=_0x49c603[_0x227ce9(0x197)]['id'],_0x46cc76=await purchases_finished[_0x227ce9(0x1c1)](_0x241b83);if(_0x40619c[0x0][_0x227ce9(0xe9)]==_0x227ce9(0x15a))var _0x1e3528=users[_0x227ce9(0x1b0)];else{if(_0x40619c[0x0][_0x227ce9(0xe9)]==_0x227ce9(0x131))var _0x1e3528=users[_0x227ce9(0x131)];else{if(_0x40619c[0x0][_0x227ce9(0xe9)]==_0x227ce9(0x143))var _0x1e3528=users['German'];else{if(_0x40619c[0x0][_0x227ce9(0xe9)]==_0x227ce9(0x13e))var _0x1e3528=users[_0x227ce9(0x13e)];else{if(_0x40619c[0x0][_0x227ce9(0xe9)]==_0x227ce9(0x192))var _0x1e3528=users[_0x227ce9(0x192)];else{if(_0x40619c[0x0]['language']=='Portuguese\x20(BR)')var _0x1e3528=users[_0x227ce9(0x112)];else{if(_0x40619c[0x0]['language']==_0x227ce9(0x1cd))var _0x1e3528=users['Chinese'];else{if(_0x40619c[0x0][_0x227ce9(0xe9)]==_0x227ce9(0x190))var _0x1e3528=users[_0x227ce9(0x147)];}}}}}}}_0x55fc39[_0x227ce9(0x177)](_0x227ce9(0x134),{'success':_0x49c603[_0x227ce9(0x1cb)](_0x227ce9(0x115)),'errors':_0x49c603[_0x227ce9(0x1cb)](_0x227ce9(0x174)),'role':_0x3a9a08,'profile':_0x42036e,'alldata':_0x46cc76,'master_shop':_0x40619c,'language':_0x1e3528}),console[_0x227ce9(0xfb)](alldata);}catch(_0x17ec40){console['log'](_0x17ec40);}}),router[a0_0x36666b(0xcd)](a0_0x36666b(0x199),async(_0x41c565,_0xe32dcc)=>{var _0x2a6ced=a0_0x36666b;const {product_code:_0x8e50db}=_0x41c565['body'];var _0x5200ba;const _0x2e4d22=await product[_0x2a6ced(0x16e)]([{'$match':{'primary_code':_0x8e50db,'product_category':_0x2a6ced(0x154)}},{'$group':{'_id':_0x2a6ced(0xfc),'name':{'$first':_0x2a6ced(0x1de)},'category':{'$first':_0x2a6ced(0x117)},'brand':{'$first':'$brand'},'unit':{'$first':'$unit'},'alertquantity':{'$first':_0x2a6ced(0xf5)},'product_code':{'$first':_0x2a6ced(0x176)},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x2a6ced(0x133)},'maxStocks':{'$first':_0x2a6ced(0x12e)},'maxProdPerUnit':{'$first':_0x2a6ced(0x19d)},'product_cat':{'$first':'P'},'secondary_unit':{'$first':_0x2a6ced(0x1a1)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]),_0x2e5309=await product[_0x2a6ced(0x16e)]([{'$match':{'secondary_code':_0x8e50db}},{'$group':{'_id':_0x2a6ced(0xfc),'name':{'$first':_0x2a6ced(0x1de)},'category':{'$first':_0x2a6ced(0x117)},'brand':{'$first':_0x2a6ced(0x1bf)},'unit':{'$first':_0x2a6ced(0x141)},'alertquantity':{'$first':_0x2a6ced(0xf5)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':'$primary_code'},'secondary_code':{'$first':_0x2a6ced(0x133)},'maxStocks':{'$first':'$maxStocks'},'maxProdPerUnit':{'$first':_0x2a6ced(0x19d)},'product_cat':{'$first':'S'},'secondary_unit':{'$first':_0x2a6ced(0x1a1)}}},{'$project':{'_id':0x1,'name':0x1,'category':0x1,'brand':0x1,'unit':0x1,'alertquantity':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'maxStocks':0x1,'maxProdPerUnit':0x1,'product_cat':0x1,'secondary_unit':0x1}}]);if(_0x2e4d22[_0x2a6ced(0x101)]>0x0)_0x5200ba=_0x2e4d22;else _0x2e5309[_0x2a6ced(0x101)]>0x0&&(_0x5200ba=_0x2e5309);_0xe32dcc['json'](_0x5200ba);}),router[a0_0x36666b(0xcd)](a0_0x36666b(0x14c),async(_0x75e3d4,_0xd7ac4f)=>{var _0x2bb3ea=a0_0x36666b;const {product_code:_0x328ebd}=_0x75e3d4[_0x2bb3ea(0xea)];var _0x18815c;const _0x4d48b9=await product[_0x2bb3ea(0x16e)]([{'$match':{'product_code_spmx':_0x328ebd,'product_category':_0x2bb3ea(0x18a)}},{'$group':{'_id':_0x2bb3ea(0xfc),'category':{'$first':_0x2bb3ea(0x117)},'brand':{'$first':_0x2bb3ea(0x1bf)},'unit':{'$first':_0x2bb3ea(0x141)},'product_code_spmx':{'$first':_0x2bb3ea(0x129)},'product_code':{'$first':'$product_code'},'primary_code':{'$first':_0x2bb3ea(0xf4)},'secondary_code':{'$first':'$secondary_code'},'product_cat':{'$first':_0x2bb3ea(0x18a)}}},{'$project':{'_id':0x1,'category':0x1,'brand':0x1,'unit':0x1,'product_code_spmx':0x1,'product_code':0x1,'primary_code':0x1,'secondary_code':0x1,'product_cat':0x1}}]);_0x18815c=_0x4d48b9,_0xd7ac4f[_0x2bb3ea(0x186)](_0x18815c);}),router[a0_0x36666b(0xcd)](a0_0x36666b(0x1df),async(_0x259dcd,_0x3088b8)=>{var _0x2a5a1c=a0_0x36666b;const {productCode:_0x25de9f,bay:_0x20b2dd,warehouses:_0x40dd40,room:_0x177e61}=_0x259dcd[_0x2a5a1c(0xea)];console[_0x2a5a1c(0xfb)](_0x259dcd[_0x2a5a1c(0xea)]);try{const _0x2a6d2f=await warehouse[_0x2a5a1c(0x16e)]([{'$match':{'name':_0x40dd40,'room':_0x177e61}},{'$unwind':_0x2a5a1c(0x172)},{'$match':{'product_details.bay':parseInt(_0x20b2dd)}},{'$group':{'_id':_0x2a5a1c(0x109),'name':{'$first':_0x2a5a1c(0x1a8)},'product_stock':{'$first':_0x2a5a1c(0x159)},'bay':{'$first':_0x2a5a1c(0x19f)},'maxProducts':{'$first':_0x2a5a1c(0x16c)}}}]);_0x3088b8[_0x2a5a1c(0x114)](0xc8)[_0x2a5a1c(0x186)](_0x2a6d2f);}catch(_0x145225){_0x3088b8[_0x2a5a1c(0x114)](0x194)[_0x2a5a1c(0x186)]({'message':_0x145225[_0x2a5a1c(0x19c)]});}}),module['exports']=router;