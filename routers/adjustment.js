var a0_0x159ac9=a0_0x5b42;(function(_0x2bd118,_0x3abd55){var _0x4cda11=a0_0x5b42,_0x282875=_0x2bd118();while(!![]){try{var _0x4f32a9=parseInt(_0x4cda11(0x210))/0x1*(parseInt(_0x4cda11(0x244))/0x2)+parseInt(_0x4cda11(0x1f7))/0x3+-parseInt(_0x4cda11(0x204))/0x4+parseInt(_0x4cda11(0x1ca))/0x5+-parseInt(_0x4cda11(0x255))/0x6+parseInt(_0x4cda11(0x1d7))/0x7*(-parseInt(_0x4cda11(0x20f))/0x8)+-parseInt(_0x4cda11(0x1cf))/0x9;if(_0x4f32a9===_0x3abd55)break;else _0x282875['push'](_0x282875['shift']());}catch(_0x45634c){_0x282875['push'](_0x282875['shift']());}}}(a0_0x5097,0xc2b66));const express=require(a0_0x159ac9(0x1ff)),app=express(),router=express['Router'](),auth=require(a0_0x159ac9(0x1e1)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x159ac9(0x22b)),users=require(a0_0x159ac9(0x226)),nodemailer=require(a0_0x159ac9(0x213));function a0_0x5b42(_0xd85cc6,_0x3546f2){var _0x5097be=a0_0x5097();return a0_0x5b42=function(_0x5b4211,_0x1f4572){_0x5b4211=_0x5b4211-0x1a3;var _0x3e0463=_0x5097be[_0x5b4211];return _0x3e0463;},a0_0x5b42(_0xd85cc6,_0x3546f2);}router['get'](a0_0x159ac9(0x1b2),auth,async(_0x3dce84,_0x2239c7)=>{var _0x3bcc5f=a0_0x159ac9;try{const {username:_0x12c714,email:_0x64a386,role:_0x24655d}=_0x3dce84[_0x3bcc5f(0x1f9)],_0x2e8ec0=_0x3dce84[_0x3bcc5f(0x1f9)],_0x28714d=await profile[_0x3bcc5f(0x1e6)]({'email':_0x2e8ec0['email']}),_0x486363=await master_shop[_0x3bcc5f(0x25e)]();console[_0x3bcc5f(0x245)]('master',_0x486363);let _0x50d124;if(_0x2e8ec0[_0x3bcc5f(0x23d)]==_0x3bcc5f(0x1e0)){const _0x9f7c79=await staff[_0x3bcc5f(0x1e6)]({'email':_0x2e8ec0[_0x3bcc5f(0x1c5)]});_0x50d124=await warehouse['find']({'status':_0x3bcc5f(0x246),'name':_0x9f7c79[_0x3bcc5f(0x205)]});}else _0x50d124=await warehouse[_0x3bcc5f(0x25e)]({'status':_0x3bcc5f(0x246)});const _0x59927a=await product[_0x3bcc5f(0x25e)]();let _0x22b4c0;if(_0x2e8ec0[_0x3bcc5f(0x23d)]==_0x3bcc5f(0x1e0)){const _0x439e1a=await staff[_0x3bcc5f(0x1e6)]({'email':_0x2e8ec0[_0x3bcc5f(0x1c5)]});_0x22b4c0=await adjustment['find']({'warehouse_name':_0x439e1a[_0x3bcc5f(0x205)]});}else _0x22b4c0=await adjustment[_0x3bcc5f(0x1d4)]([{'$unwind':_0x3bcc5f(0x1e8)},{'$group':{'_id':'$_id','invoice':{'$first':_0x3bcc5f(0x26c)},'date':{'$first':_0x3bcc5f(0x217)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x3bcc5f(0x1bb)},'finalize':{'$first':_0x3bcc5f(0x1ef)},'isAllowEdit':{'$first':_0x3bcc5f(0x208)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x486363[0x0][_0x3bcc5f(0x1d2)]==_0x3bcc5f(0x1ee)){var _0x561177=users['English'];console[_0x3bcc5f(0x245)](_0x561177);}else{if(_0x486363[0x0][_0x3bcc5f(0x1d2)]=='Hindi')var _0x561177=users[_0x3bcc5f(0x1a4)];else{if(_0x486363[0x0][_0x3bcc5f(0x1d2)]==_0x3bcc5f(0x1bd))var _0x561177=users['German'];else{if(_0x486363[0x0]['language']==_0x3bcc5f(0x1e2))var _0x561177=users[_0x3bcc5f(0x1e2)];else{if(_0x486363[0x0][_0x3bcc5f(0x1d2)]==_0x3bcc5f(0x24a))var _0x561177=users[_0x3bcc5f(0x24a)];else{if(_0x486363[0x0][_0x3bcc5f(0x1d2)]==_0x3bcc5f(0x22d))var _0x561177=users['Portuguese'];else{if(_0x486363[0x0]['language']==_0x3bcc5f(0x225))var _0x561177=users[_0x3bcc5f(0x225)];else{if(_0x486363[0x0][_0x3bcc5f(0x1d2)]=='Arabic\x20(ae)')var _0x561177=users['Arabic'];}}}}}}}_0x2239c7[_0x3bcc5f(0x1e5)](_0x3bcc5f(0x270),{'success':_0x3dce84['flash'](_0x3bcc5f(0x1c7)),'errors':_0x3dce84[_0x3bcc5f(0x25a)](_0x3bcc5f(0x230)),'role':_0x2e8ec0,'profile':_0x28714d,'warehouse':_0x50d124,'product':_0x59927a,'adjustment':_0x22b4c0,'master_shop':_0x486363,'language':_0x561177});}catch(_0x3cd604){console[_0x3bcc5f(0x245)](_0x3cd604);}});function a0_0x5097(){var _0x26e8cc=['$finalize','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','English','$product_details.secondary_unit','$product_details.secondary_code','$product_details.product_name','get','type','4530573hXmNsT','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','user','An\x20error\x20occurred\x20while\x20saving\x20data.','forEach','id_transaction_from','Secondary_units','\x20Order\x20Date\x20:\x20','express','$product_details.floorlevel','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','batch_code','<tr>','1899972pHOgQB','warehouse','\x20</h2>','Floor','$isAllowEdit','push','prod_code','\x20Order\x20Number\x20:\x20','Return\x20Goods','primary_code','$product_details.batch_code','8iKbXxl','384567DvnCTd','$product_details.bin','password','nodemailer','status','map','post','$date','$product_details.maxPerUnit','</div>','save','</span>','/CheckingWarehouse','Arabic','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','back','True','floor','</body></html>','all','production_date','Chinese','../public/language/languages.json','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details._id','../models/all_models','product','Portuguese\x20(BR)','<h2>\x20','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','errors','_id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','error','message','False','$product.product_name','rack','room','padStart','note','product_details','role','$product_details.bay','json','/adjustment/preview/','$room','</td>','redirect','6FQZdQN','log','Enabled','$product_details','invoice','prime1','French','maxperunit','Shelves','/upload/','minus','stockBefore','createTransport','findById','$product_details.production_date','expiry_date','split','4133238QVJwOm','$product_details.product_code','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Email\x20sent\x20successfully','flash','stock','</table>','prod_name','find','$product_details.product_stock','second1','toString','bin','port','<strong>\x20Regards\x20</strong>','catch','</h5>','bay','params','</tr>','Arabic\x20(ae)','<div>','$invoice','adjust_qty','storage','finalize','adjustment','logo','<h5\x20style=\x22text-align:\x20left;\x22>','random','product_code','Hindi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','/barcode_scanner','Portuguese','level','</tbody>','Primary_Units','adjustment\x20data\x20update\x20successfully','New_Qty_Converted_adj','/view/:id','add_adjustment','$product_details.invoice','Level','Logo.png','/view','Enclosed','New_Qty_Converted','product_stock','/../public','$product_details.rack','/picking_list/PDF_adjustment_rm/','/adjustment/view','floorlevel','$product.room_names','edit_adjustment_view','German','body','room_names','site_title','warehouse_name','$product_details.expiry_date','RMSEmail','image','email','filter','success','</head><body>','secondary_unit','2647335EFtAVb','$product_details.product_cat','secondary_code','<hr\x20class=\x22my-3\x22>','string','9107775WEyxuR','types','ADJ-','language','adjustment\x20add\x20successfull','aggregate','prod_cat','max_per_unit','1539832ZociCS','Rooms','Adjustment\x20Mail','product_name','$product_details.type','$product_details.storage','date','Raw\x20Materials','$product_details.primary_code','staff','../middleware/auth','Spanish','foreach\x20newproduct','unit','render','findOne','Receiving\x20Area','$product','edit_adjustment','slice','then','id_transaction','/preview/:id','English\x20(US)'];a0_0x5097=function(){return _0x26e8cc;};return a0_0x5097();}async function getRandom8DigitNumber(){var _0x16f47e=a0_0x159ac9;const _0x31e8ab=0x989680,_0x43d73a=0x5f5e0ff,_0x27489b=Math[_0x16f47e(0x221)](Math[_0x16f47e(0x273)]()*(_0x43d73a-_0x31e8ab+0x1))+_0x31e8ab;var _0x18ef42;const _0x1e967c=await adjustment[_0x16f47e(0x1e6)]({'invoice':_0x16f47e(0x1d1)+_0x27489b});return _0x1e967c&&_0x1e967c['length']>0x0?_0x18ef42=_0x16f47e(0x1d1)+_0x27489b:_0x18ef42=_0x16f47e(0x1d1)+_0x27489b,_0x18ef42;}router['get']('/view/add_adjustment',auth,async(_0x20d011,_0x5eabdc)=>{var _0x9f5a80=a0_0x159ac9;try{const {username:_0x43b91e,email:_0x5a2fd5,role:_0x174da2}=_0x20d011[_0x9f5a80(0x1f9)],_0x38e64c=_0x20d011[_0x9f5a80(0x1f9)],_0x1a3f89=await profile[_0x9f5a80(0x1e6)]({'email':_0x38e64c['email']}),_0x26b2ee=await master_shop[_0x9f5a80(0x25e)]();let _0x56712a;if(_0x38e64c[_0x9f5a80(0x23d)]==_0x9f5a80(0x1e0)){const _0x2386c9=await staff[_0x9f5a80(0x1e6)]({'email':_0x38e64c[_0x9f5a80(0x1c5)]});_0x56712a=await warehouse[_0x9f5a80(0x1d4)]([{'$match':{'status':_0x9f5a80(0x246),'name':_0x2386c9[_0x9f5a80(0x205)],'warehouse_category':_0x9f5a80(0x1de),'name':{'$ne':_0x9f5a80(0x20c)}}},{'$group':{'_id':'$name','name':{'$first':_0x9f5a80(0x228)}}}]);}else _0x56712a=await warehouse[_0x9f5a80(0x1d4)]([{'$match':{'status':_0x9f5a80(0x246),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x9f5a80(0x20c)}}},{'$group':{'_id':'$name','name':{'$first':_0x9f5a80(0x228)}}}]);const _0x4ce9a5=await product[_0x9f5a80(0x25e)]({}),_0x1e47e1=await adjustment[_0x9f5a80(0x25e)]({}),_0xa7fde4=_0x1e47e1['length']+0x1,_0x42d342=_0x9f5a80(0x1d1)+_0xa7fde4[_0x9f5a80(0x261)]()[_0x9f5a80(0x23a)](0x5,'0');var _0xe30cf0=['Ambient',_0x9f5a80(0x1b3),'Return\x20Rooms'];if(_0x26b2ee[0x0][_0x9f5a80(0x1d2)]=='English\x20(US)')var _0x48edfa=users[_0x9f5a80(0x1f1)];else{if(_0x26b2ee[0x0][_0x9f5a80(0x1d2)]=='Hindi')var _0x48edfa=users[_0x9f5a80(0x1a4)];else{if(_0x26b2ee[0x0]['language']==_0x9f5a80(0x1bd))var _0x48edfa=users[_0x9f5a80(0x1bd)];else{if(_0x26b2ee[0x0][_0x9f5a80(0x1d2)]==_0x9f5a80(0x1e2))var _0x48edfa=users[_0x9f5a80(0x1e2)];else{if(_0x26b2ee[0x0][_0x9f5a80(0x1d2)]==_0x9f5a80(0x24a))var _0x48edfa=users[_0x9f5a80(0x24a)];else{if(_0x26b2ee[0x0][_0x9f5a80(0x1d2)]==_0x9f5a80(0x22d))var _0x48edfa=users[_0x9f5a80(0x1a7)];else{if(_0x26b2ee[0x0][_0x9f5a80(0x1d2)]==_0x9f5a80(0x225))var _0x48edfa=users[_0x9f5a80(0x225)];else{if(_0x26b2ee[0x0][_0x9f5a80(0x1d2)]==_0x9f5a80(0x26a))var _0x48edfa=users[_0x9f5a80(0x21d)];}}}}}}}const _0x368225=getRandom8DigitNumber();_0x368225[_0x9f5a80(0x1eb)](_0x1fc464=>{var _0x482b36=_0x9f5a80;_0x5eabdc['render'](_0x482b36(0x1ae),{'success':_0x20d011[_0x482b36(0x25a)](_0x482b36(0x1c7)),'errors':_0x20d011[_0x482b36(0x25a)]('errors'),'role':_0x38e64c,'profile':_0x1a3f89,'warehouse':_0x56712a,'product':_0x4ce9a5,'master_shop':_0x26b2ee,'language':_0x48edfa,'rooms_data':_0xe30cf0,'invoice_no':_0x1fc464});})[_0x9f5a80(0x265)](_0x3548cc=>{var _0x5d3f3b=_0x9f5a80;_0x20d011[_0x5d3f3b(0x25a)]('errors',_0x5d3f3b(0x229)),_0x5eabdc[_0x5d3f3b(0x243)](_0x5d3f3b(0x1b9));});}catch(_0x331947){console['log'](_0x331947);}}),router[a0_0x159ac9(0x216)]('/view/add_adjustment',auth,async(_0x170132,_0x5f31df)=>{var _0x280192=a0_0x159ac9;try{const {warehouse_name:_0x44e9b4,date:_0x46293f,prod_name:_0x2ce0ae,level:_0x2e9876,isle:_0x17cb3a,pallet:_0x2db2fc,stock:_0x3111a5,types:_0x2d0070,adjust_qty:_0xe2a8de,new_adjust_qty:_0x367f19,note:_0x1c9802,Room_name:_0x2fc785,invoice:_0x27ddaf,JO_number:_0x4b104a,expiry_date:_0x5297f3}=_0x170132[_0x280192(0x1be)];if(typeof _0x2ce0ae==_0x280192(0x1ce))var _0x40dc34=[_0x170132[_0x280192(0x1be)][_0x280192(0x25d)]],_0x2f3736=[_0x170132[_0x280192(0x1be)][_0x280192(0x1a8)]],_0x45d2f4=[_0x170132['body'][_0x280192(0x25b)]],_0x3593cc=[_0x170132[_0x280192(0x1be)]['types']],_0x35f77b=[_0x170132[_0x280192(0x1be)][_0x280192(0x1ac)]],_0xd1025a=[_0x170132[_0x280192(0x1be)][_0x280192(0x1b4)]],_0x55ac32=[_0x170132[_0x280192(0x1be)]['Primary_Units']],_0x4c137b=[_0x170132[_0x280192(0x1be)][_0x280192(0x1fd)]],_0x375baf=[_0x170132[_0x280192(0x1be)][_0x280192(0x20a)]],_0x343c27=[_0x170132[_0x280192(0x1be)]['batch_code']],_0x3c0974=[_0x170132[_0x280192(0x1be)][_0x280192(0x253)]],_0x1128bd=[_0x170132[_0x280192(0x1be)][_0x280192(0x1d6)]],_0x4d9a6f=[_0x170132[_0x280192(0x1be)][_0x280192(0x224)]],_0x1340f5=[_0x170132[_0x280192(0x1be)][_0x280192(0x1d5)]],_0x5af0c3=[_0x170132[_0x280192(0x1be)][_0x280192(0x1d8)]],_0x4ae795=[_0x170132[_0x280192(0x1be)][_0x280192(0x249)]],_0x5ac99d=[_0x170132[_0x280192(0x1be)]['second1']],_0x4965cb=[_0x170132['body']['prod_invoice']],_0x56ae29=[_0x170132['body']['id_transaction']];else var _0x40dc34=[..._0x170132['body']['prod_name']],_0x2f3736=[..._0x170132[_0x280192(0x1be)][_0x280192(0x1a8)]],_0x45d2f4=[..._0x170132[_0x280192(0x1be)][_0x280192(0x25b)]],_0x3593cc=[..._0x170132[_0x280192(0x1be)][_0x280192(0x1d0)]],_0x35f77b=[..._0x170132[_0x280192(0x1be)][_0x280192(0x1ac)]],_0xd1025a=[..._0x170132['body']['New_Qty_Converted']],_0x55ac32=[..._0x170132[_0x280192(0x1be)]['unit']],_0x4c137b=[..._0x170132[_0x280192(0x1be)][_0x280192(0x1fd)]],_0x375baf=[..._0x170132['body'][_0x280192(0x20a)]],_0x343c27=[..._0x170132[_0x280192(0x1be)][_0x280192(0x202)]],_0x3c0974=[..._0x170132[_0x280192(0x1be)]['expiry_date']],_0x1128bd=[..._0x170132[_0x280192(0x1be)]['max_per_unit']],_0x4d9a6f=[..._0x170132[_0x280192(0x1be)]['production_date']],_0x1340f5=[..._0x170132['body']['prod_cat']],_0x5af0c3=[..._0x170132[_0x280192(0x1be)][_0x280192(0x1d8)]],_0x4ae795=[..._0x170132[_0x280192(0x1be)][_0x280192(0x249)]],_0x5ac99d=[..._0x170132['body'][_0x280192(0x260)]],_0x4965cb=[..._0x170132[_0x280192(0x1be)]['prod_invoice']],_0x56ae29=[..._0x170132[_0x280192(0x1be)][_0x280192(0x1ec)]];const _0x3dc8de=_0x40dc34[_0x280192(0x215)](_0x332526=>{return _0x332526={'product_name':_0x332526};});_0x2f3736[_0x280192(0x1fb)]((_0x18a0f3,_0x72bc53)=>{var _0x2eab7c=_0x280192;_0x5af0c3[_0x2eab7c(0x1fb)]((_0x20d024,_0x39d7be)=>{var _0x399c7a=_0x2eab7c;if(_0x20d024==_0x399c7a(0x1e7)&&_0x72bc53==_0x39d7be){var _0x262dc7=_0x18a0f3[_0x399c7a(0x1ea)](0x3);_0x3dc8de[_0x72bc53]['storage']=_0x18a0f3[0x0],_0x3dc8de[_0x72bc53][_0x399c7a(0x238)]=_0x18a0f3[0x1],_0x3dc8de[_0x72bc53][_0x399c7a(0x267)]=0x0,_0x3dc8de[_0x72bc53]['bin']=0x0,_0x3dc8de[_0x72bc53][_0x399c7a(0x1f6)]=_0x399c7a(0x207),_0x3dc8de[_0x72bc53][_0x399c7a(0x1ba)]=_0x262dc7;}else{if(_0x20d024==_0x399c7a(0x24c)&&_0x72bc53==_0x39d7be){var _0x262dc7=_0x18a0f3['slice'](0x3);_0x3dc8de[_0x72bc53][_0x399c7a(0x26e)]=_0x18a0f3[0x0],_0x3dc8de[_0x72bc53]['rack']=_0x18a0f3[0x1],_0x3dc8de[_0x72bc53][_0x399c7a(0x267)]=0x0,_0x3dc8de[_0x72bc53][_0x399c7a(0x262)]=0x0,_0x3dc8de[_0x72bc53][_0x399c7a(0x1f6)]='Floor',_0x3dc8de[_0x72bc53]['floorlevel']=_0x18a0f3[0x5];}else{if(_0x72bc53==_0x39d7be){var _0x59c765;if(_0x18a0f3[0x4]=='L')_0x59c765=_0x399c7a(0x1b0);else _0x18a0f3[0x4]=='F'&&(_0x59c765=_0x399c7a(0x207));_0x3dc8de[_0x72bc53][_0x399c7a(0x26e)]=_0x18a0f3[0x0],_0x3dc8de[_0x72bc53][_0x399c7a(0x238)]=_0x18a0f3[0x1],_0x3dc8de[_0x72bc53][_0x399c7a(0x267)]=_0x18a0f3[0x2],_0x3dc8de[_0x72bc53]['bin']=_0x18a0f3[0x3],_0x3dc8de[_0x72bc53][_0x399c7a(0x1f6)]=_0x59c765,_0x3dc8de[_0x72bc53][_0x399c7a(0x1ba)]=_0x18a0f3[0x5];}}}});}),_0x45d2f4[_0x280192(0x1fb)]((_0x1ab51e,_0x2626e9)=>{_0x3dc8de[_0x2626e9]['stockBefore']=_0x1ab51e;}),_0x56ae29[_0x280192(0x1fb)]((_0x3107dc,_0x334721)=>{var _0x278c3a=_0x280192;_0x3dc8de[_0x334721][_0x278c3a(0x1fc)]=_0x3107dc;}),_0x3593cc[_0x280192(0x1fb)]((_0x2714b1,_0x1ab896)=>{var _0x38da83=_0x280192;_0x3dc8de[_0x1ab896][_0x38da83(0x1d0)]=_0x2714b1;}),_0x35f77b[_0x280192(0x1fb)]((_0x275e60,_0x3ddb69)=>{_0x3dc8de[_0x3ddb69]['adjust_qty']=_0x275e60;}),_0xd1025a['forEach']((_0x555cd7,_0x3b4476)=>{_0x3dc8de[_0x3b4476]['new_adjust_qty']=_0x555cd7;}),_0x55ac32[_0x280192(0x1fb)]((_0x44e718,_0x143e4b)=>{_0x3dc8de[_0x143e4b]['unit']=_0x44e718;}),_0x4c137b[_0x280192(0x1fb)]((_0x45c2c9,_0x342bc0)=>{var _0x4be7ee=_0x280192;_0x3dc8de[_0x342bc0][_0x4be7ee(0x1c9)]=_0x45c2c9;}),_0x375baf[_0x280192(0x1fb)]((_0x2d3a3c,_0x501155)=>{var _0x26eafd=_0x280192;_0x3dc8de[_0x501155][_0x26eafd(0x1a3)]=_0x2d3a3c;}),_0x343c27['forEach']((_0x357b2e,_0x4afb25)=>{var _0x1ceedd=_0x280192;_0x3dc8de[_0x4afb25][_0x1ceedd(0x202)]=_0x357b2e;}),_0x3c0974['forEach']((_0x17f06c,_0x509dad)=>{var _0x36b41b=_0x280192;_0x3dc8de[_0x509dad][_0x36b41b(0x253)]=_0x17f06c;}),_0x1128bd[_0x280192(0x1fb)]((_0x499797,_0x3f72fe)=>{_0x3dc8de[_0x3f72fe]['maxperunit']=_0x499797;}),_0x4d9a6f[_0x280192(0x1fb)]((_0xe065ff,_0x8c408e)=>{_0x3dc8de[_0x8c408e]['production_date']=_0xe065ff;}),_0x1340f5['forEach']((_0x578923,_0x50dd45)=>{var _0x12a2a3=_0x280192;_0x3dc8de[_0x50dd45][_0x12a2a3(0x1d5)]=_0x578923;}),_0x5af0c3[_0x280192(0x1fb)]((_0x491e82,_0x2703d4)=>{_0x3dc8de[_0x2703d4]['room_names']=_0x491e82;}),_0x4ae795[_0x280192(0x1fb)]((_0x3b3e58,_0x3508e6)=>{_0x3dc8de[_0x3508e6]['primary_code']=_0x3b3e58;}),_0x5ac99d['forEach']((_0xb4a0dd,_0x13803d)=>{var _0x129144=_0x280192;_0x3dc8de[_0x13803d][_0x129144(0x1cc)]=_0xb4a0dd;}),_0x4965cb['forEach']((_0x1f42de,_0x5c8581)=>{var _0x1ddde2=_0x280192;_0x3dc8de[_0x5c8581][_0x1ddde2(0x248)]=_0x1f42de;});const _0x524d5c=_0x3dc8de['filter'](_0x3bdbfc=>_0x3bdbfc['adjust_qty']!=='0'&&_0x3bdbfc['adjust_qty']!=='');var _0x50ae48=0x0;_0x524d5c[_0x280192(0x1fb)](_0x5c9387=>{var _0x419986=_0x280192;console['log'](_0x419986(0x1e3),_0x5c9387),parseInt(_0x5c9387['adjust_qty'])<=0x0&&_0x50ae48++;});if(_0x50ae48!=0x0)return _0x170132[_0x280192(0x25a)](_0x280192(0x230),_0x280192(0x201)),_0x5f31df[_0x280192(0x243)](_0x280192(0x21f));const _0x525ef9=new adjustment({'warehouse_name':_0x44e9b4,'date':_0x46293f,'product':_0x524d5c,'note':_0x1c9802,'room':_0x2fc785,'invoice':_0x27ddaf,'JO_number':_0x4b104a,'expiry_date':_0x5297f3}),_0x3a5132=await _0x525ef9[_0x280192(0x21a)]();_0x170132[_0x280192(0x25a)](_0x280192(0x1c7),_0x280192(0x1d3)),_0x5f31df[_0x280192(0x243)](_0x280192(0x240)+_0x3a5132[_0x280192(0x231)]);}catch(_0x1d5110){console[_0x280192(0x245)](_0x1d5110),_0x5f31df[_0x280192(0x214)](0xc8)['json']({'message':_0x1d5110[_0x280192(0x235)]});}}),router[a0_0x159ac9(0x1f5)](a0_0x159ac9(0x1ed),auth,async(_0x3f0cb5,_0x57eee1)=>{var _0xcebf7=a0_0x159ac9;try{const {username:_0x539339,email:_0x405cc6,role:_0x32f6bb}=_0x3f0cb5[_0xcebf7(0x1f9)],_0x16867b=_0x3f0cb5[_0xcebf7(0x1f9)],_0x553a8b=await profile[_0xcebf7(0x1e6)]({'email':_0x16867b[_0xcebf7(0x1c5)]}),_0x517008=await master_shop['find'](),_0x2d2745=_0x3f0cb5['params']['id'],_0x4f3331=await adjustment[_0xcebf7(0x251)]({'_id':_0x2d2745}),_0x4cb059=await purchases[_0xcebf7(0x1d4)]([{'$match':{'warehouse_name':_0x4f3331['warehouse_name']}},{'$unwind':_0xcebf7(0x1e8)},{'$group':{'_id':_0xcebf7(0x237)}}]),_0x2f0e95=await product[_0xcebf7(0x25e)]({}),_0x3cc321=await warehouse[_0xcebf7(0x1d4)]([{'$match':{'name':_0x4f3331[_0xcebf7(0x1c1)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0xcebf7(0x1f4)},'product_stock':{'$first':_0xcebf7(0x25f)},'bay':{'$first':_0xcebf7(0x23e)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xcebf7(0x1db)},'floorlevel':{'$first':_0xcebf7(0x200)},'primary_code':{'$first':_0xcebf7(0x1df)},'secondary_code':{'$first':_0xcebf7(0x1f3)},'product_code':{'$first':_0xcebf7(0x256)},'storage':{'$first':_0xcebf7(0x1dc)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xcebf7(0x252)},'batch_code':{'$first':_0xcebf7(0x20e)},'room':{'$first':_0xcebf7(0x241)}}}]);if(_0x517008[0x0][_0xcebf7(0x1d2)]==_0xcebf7(0x1ee)){var _0x5a81ef=users[_0xcebf7(0x1f1)];console[_0xcebf7(0x245)](_0x5a81ef);}else{if(_0x517008[0x0][_0xcebf7(0x1d2)]==_0xcebf7(0x1a4))var _0x5a81ef=users[_0xcebf7(0x1a4)];else{if(_0x517008[0x0][_0xcebf7(0x1d2)]==_0xcebf7(0x1bd))var _0x5a81ef=users[_0xcebf7(0x1bd)];else{if(_0x517008[0x0][_0xcebf7(0x1d2)]==_0xcebf7(0x1e2))var _0x5a81ef=users[_0xcebf7(0x1e2)];else{if(_0x517008[0x0][_0xcebf7(0x1d2)]==_0xcebf7(0x24a))var _0x5a81ef=users[_0xcebf7(0x24a)];else{if(_0x517008[0x0]['language']==_0xcebf7(0x22d))var _0x5a81ef=users[_0xcebf7(0x1a7)];else{if(_0x517008[0x0][_0xcebf7(0x1d2)]==_0xcebf7(0x225))var _0x5a81ef=users['Chinese'];else{if(_0x517008[0x0][_0xcebf7(0x1d2)]==_0xcebf7(0x26a))var _0x5a81ef=users[_0xcebf7(0x21d)];}}}}}}}_0x57eee1[_0xcebf7(0x1e5)](_0xcebf7(0x1bc),{'success':_0x3f0cb5[_0xcebf7(0x25a)](_0xcebf7(0x1c7)),'errors':_0x3f0cb5[_0xcebf7(0x25a)](_0xcebf7(0x230)),'role':_0x16867b,'profile':_0x553a8b,'adjustment':_0x4f3331,'stock':_0x3cc321,'master_shop':_0x517008,'warehouse_name':_0x4cb059,'unit':_0x2f0e95,'language':_0x5a81ef});}catch(_0x16c412){console[_0xcebf7(0x245)](_0x16c412),_0x57eee1[_0xcebf7(0x214)](0xc8)[_0xcebf7(0x23f)]({'message':_0x16c412[_0xcebf7(0x235)]});}}),router['post'](a0_0x159ac9(0x1ed),auth,async(_0x30b95c,_0x2805c8)=>{var _0x14561b=a0_0x159ac9;try{const _0x187d65=_0x30b95c['params']['id'],{warehouse_name:_0x3243fc,Room_name:_0x1baea1}=_0x30b95c['body'],_0x252567=await adjustment[_0x14561b(0x251)]({'_id':_0x187d65}),_0xc6616e=_0x252567['product'][_0x14561b(0x215)](async _0x374c17=>{var _0x201884=_0x14561b;if(_0x374c17[_0x201884(0x26d)]>0x0){var _0x25fd8d=await warehouse[_0x201884(0x1e6)]({'name':_0x3243fc,'room':_0x374c17[_0x201884(0x1bf)],'warehouse_category':_0x201884(0x1de)});const _0x5de43e=_0x25fd8d[_0x201884(0x23c)]['map'](_0x2d5344=>{var _0x4af604=_0x201884;console[_0x4af604(0x245)](_0x374c17[_0x4af604(0x1d0)]+'\x20<>\x20');if(_0x374c17[_0x4af604(0x1d0)]==_0x4af604(0x24e)){if(_0x2d5344[_0x4af604(0x1da)]==_0x374c17[_0x4af604(0x1da)]&&_0x2d5344[_0x4af604(0x1ba)]==_0x374c17[_0x4af604(0x1ba)]&&_0x2d5344[_0x4af604(0x1f6)]==_0x374c17[_0x4af604(0x1f6)]&&_0x2d5344['bin']==_0x374c17['bin']&&_0x2d5344[_0x4af604(0x267)]==_0x374c17[_0x4af604(0x267)]&&_0x2d5344['rack']==_0x374c17[_0x4af604(0x238)]&&_0x2d5344[_0x4af604(0x26e)]==_0x374c17[_0x4af604(0x26e)]&&_0x2d5344['expiry_date']==_0x374c17[_0x4af604(0x253)]&&_0x2d5344[_0x4af604(0x202)]==_0x374c17['batch_code']&&_0x2d5344[_0x4af604(0x224)]==_0x374c17[_0x4af604(0x224)]&&_0x2d5344['invoice']==_0x374c17['invoice']&&_0x2d5344[_0x4af604(0x231)]==_0x374c17[_0x4af604(0x1fc)]){var _0x5bf593;_0x5bf593=_0x374c17[_0x4af604(0x26d)],_0x374c17[_0x4af604(0x1d5)]=='S'&&(_0x5bf593=_0x374c17[_0x4af604(0x26d)]),_0x2d5344['product_stock']=_0x2d5344[_0x4af604(0x1b5)]-_0x5bf593;}}else{if(_0x2d5344['product_name']==_0x374c17[_0x4af604(0x1da)]&&_0x2d5344[_0x4af604(0x1ba)]==_0x374c17[_0x4af604(0x1ba)]&&_0x2d5344[_0x4af604(0x1f6)]==_0x374c17['type']&&_0x2d5344[_0x4af604(0x262)]==_0x374c17[_0x4af604(0x262)]&&_0x2d5344['bay']==_0x374c17[_0x4af604(0x267)]&&_0x2d5344[_0x4af604(0x238)]==_0x374c17[_0x4af604(0x238)]&&_0x2d5344[_0x4af604(0x26e)]==_0x374c17[_0x4af604(0x26e)]&&_0x2d5344[_0x4af604(0x253)]==_0x374c17[_0x4af604(0x253)]&&_0x2d5344[_0x4af604(0x202)]==_0x374c17['batch_code']&&_0x2d5344[_0x4af604(0x224)]==_0x374c17[_0x4af604(0x224)]&&_0x2d5344['invoice']==_0x374c17[_0x4af604(0x248)]&&_0x2d5344[_0x4af604(0x231)]==_0x374c17[_0x4af604(0x1fc)]){console[_0x4af604(0x245)](_0x374c17);var _0x5bf593;_0x5bf593=_0x374c17[_0x4af604(0x26d)],_0x374c17[_0x4af604(0x1d5)]=='S'&&(_0x5bf593=_0x374c17[_0x4af604(0x26d)]),_0x2d5344[_0x4af604(0x1b5)]=_0x2d5344[_0x4af604(0x1b5)]+_0x5bf593;}}});}return _0x25fd8d;});Promise[_0x14561b(0x223)](_0xc6616e)[_0x14561b(0x1eb)](async _0x1cfc4f=>{var _0x121d5e=_0x14561b;try{for(const _0x330395 of _0x1cfc4f){await _0x330395[_0x121d5e(0x21a)]();}_0x252567[_0x121d5e(0x26f)]=_0x121d5e(0x220);const _0x5c6ff6=await _0x252567[_0x121d5e(0x21a)](),_0x1cdde8=await master_shop[_0x121d5e(0x25e)](),_0x434832=await email_settings[_0x121d5e(0x1e6)](),_0x5d13f4=await supervisor_settings[_0x121d5e(0x25e)]();var _0x11c127=_0x252567[_0x121d5e(0x22c)],_0x188236='',_0x398131;for(_0x398131 in _0x11c127){_0x188236+=_0x121d5e(0x203)+_0x121d5e(0x21e)+_0x11c127[_0x398131][_0x121d5e(0x1da)]+_0x121d5e(0x242)+_0x121d5e(0x21e)+_0x11c127[_0x398131][_0x121d5e(0x1a3)]+_0x121d5e(0x242)+_0x121d5e(0x21e)+_0x11c127[_0x398131]['adjust_qty']+_0x121d5e(0x242)+_0x121d5e(0x21e)+_0x11c127[_0x398131][_0x121d5e(0x1e4)]+'</td>'+_0x121d5e(0x21e)+_0x11c127[_0x398131][_0x121d5e(0x1c9)]+'</td>'+_0x121d5e(0x21e)+_0x252567['warehouse_name']+_0x121d5e(0x242)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x11c127[_0x398131][_0x121d5e(0x1bf)]+_0x121d5e(0x242)+_0x121d5e(0x21e)+_0x11c127[_0x398131]['storage']+_0x11c127[_0x398131][_0x121d5e(0x238)]+_0x11c127[_0x398131]['bay']+_0x11c127[_0x398131][_0x121d5e(0x262)]+_0x11c127[_0x398131]['type'][0x0]+_0x11c127[_0x398131][_0x121d5e(0x1ba)]+_0x121d5e(0x242),'</tr>';}let _0x1c28e3=nodemailer[_0x121d5e(0x250)]({'host':_0x434832['host'],'port':Number(_0x434832[_0x121d5e(0x263)]),'secure':![],'auth':{'user':_0x434832[_0x121d5e(0x1c5)],'pass':_0x434832[_0x121d5e(0x212)]}}),_0x8762c7={'from':_0x434832[_0x121d5e(0x1c5)],'to':_0x5d13f4[0x0][_0x121d5e(0x1c3)],'subject':_0x121d5e(0x1d9),'attachments':[{'filename':_0x121d5e(0x1b1),'path':__dirname+_0x121d5e(0x1b6)+_0x121d5e(0x24d)+_0x1cdde8[0x0][_0x121d5e(0x1c4)],'cid':_0x121d5e(0x271)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x121d5e(0x1c8)+_0x121d5e(0x26b)+_0x121d5e(0x232)+_0x121d5e(0x26b)+_0x121d5e(0x22f)+_0x121d5e(0x219)+_0x121d5e(0x26b)+_0x121d5e(0x22e)+_0x1cdde8[0x0][_0x121d5e(0x1c0)]+_0x121d5e(0x206)+'</div>'+'</div>'+_0x121d5e(0x1cd)+_0x121d5e(0x26b)+_0x121d5e(0x272)+_0x121d5e(0x20b)+_0x252567[_0x121d5e(0x248)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x121d5e(0x1fe)+_0x252567[_0x121d5e(0x1dd)]+'\x20'+_0x121d5e(0x21b)+'</h5>'+'</div>'+_0x121d5e(0x227)+_0x121d5e(0x1f0)+_0x121d5e(0x203)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x121d5e(0x233)+_0x121d5e(0x1f8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x121d5e(0x1a5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x121d5e(0x258)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x121d5e(0x269)+'</thead>'+_0x121d5e(0x257)+'\x20'+_0x188236+'\x20'+_0x121d5e(0x1a9)+_0x121d5e(0x25c)+'<div>'+_0x121d5e(0x264)+'<h5>'+_0x1cdde8[0x0][_0x121d5e(0x1c0)]+_0x121d5e(0x266)+'</div>'+_0x121d5e(0x219)+_0x121d5e(0x222)};_0x1c28e3['sendMail'](_0x8762c7,function(_0x4d85f2,_0x51c6ba){var _0x11f5f6=_0x121d5e;_0x4d85f2?(console[_0x11f5f6(0x245)](_0x4d85f2),console[_0x11f5f6(0x245)]('Error\x20Occurs')):console[_0x11f5f6(0x245)](_0x11f5f6(0x259));}),_0x30b95c['flash'](_0x121d5e(0x1c7),'adjustment\x20Finalized\x20successfully'),_0x2805c8[_0x121d5e(0x243)](_0x121d5e(0x1b8)+_0x5c6ff6[_0x121d5e(0x231)]);}catch(_0x4bd71f){console[_0x121d5e(0x234)](_0x4bd71f),_0x2805c8[_0x121d5e(0x214)](0x1f4)[_0x121d5e(0x23f)]({'error':_0x121d5e(0x1fa)});}})[_0x14561b(0x265)](_0xb583bd=>{var _0x434751=_0x14561b;console['error'](_0xb583bd),_0x2805c8[_0x434751(0x214)](0x1f4)[_0x434751(0x23f)]({'error':'An\x20error\x20occurred.'});});}catch(_0x4daedb){console[_0x14561b(0x245)](_0x4daedb),_0x2805c8[_0x14561b(0x214)](0xc8)[_0x14561b(0x23f)]({'message':_0x4daedb[_0x14561b(0x235)]});}}),router[a0_0x159ac9(0x1f5)](a0_0x159ac9(0x1ad),auth,async(_0x4f1d8d,_0x3834a7)=>{var _0x3a15fb=a0_0x159ac9;try{const {username:_0x3069ca,email:_0x12a6a5,role:_0x4138ee}=_0x4f1d8d['user'],_0x6dc8a0=_0x4f1d8d[_0x3a15fb(0x1f9)],_0x5b0c54=await profile[_0x3a15fb(0x1e6)]({'email':_0x6dc8a0['email']}),_0xf48779=await master_shop[_0x3a15fb(0x25e)](),_0x1cdd29=_0x4f1d8d[_0x3a15fb(0x268)]['id'],_0x111843=await adjustment[_0x3a15fb(0x251)]({'_id':_0x1cdd29}),_0x2a8a1c=await purchases['aggregate']([{'$match':{'warehouse_name':_0x111843[_0x3a15fb(0x1c1)]}},{'$unwind':'$product'},{'$group':{'_id':_0x3a15fb(0x237)}}]),_0x408377=await product[_0x3a15fb(0x25e)]({}),_0x54d13e=await warehouse[_0x3a15fb(0x1d4)]([{'$match':{'name':_0x111843[_0x3a15fb(0x1c1)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3a15fb(0x22a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3a15fb(0x25f)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3a15fb(0x211)},'type':{'$first':_0x3a15fb(0x1db)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3a15fb(0x1f3)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3a15fb(0x1dc)},'rack':{'$first':_0x3a15fb(0x1b7)},'maxPerUnit':{'$first':_0x3a15fb(0x218)},'expiry_date':{'$first':_0x3a15fb(0x1c2)},'production_date':{'$first':_0x3a15fb(0x252)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);let _0x242ac5;if(_0x6dc8a0[_0x3a15fb(0x23d)]=='staff'){const _0x3500de=await staff[_0x3a15fb(0x1e6)]({'email':_0x6dc8a0['email']});_0x242ac5=await warehouse[_0x3a15fb(0x1d4)]([{'$match':{'status':_0x3a15fb(0x246),'name':_0x3500de[_0x3a15fb(0x205)],'warehouse_category':_0x3a15fb(0x1de),'name':{'$ne':_0x3a15fb(0x20c)}}},{'$group':{'_id':_0x3a15fb(0x228),'name':{'$first':'$name'}}}]);}else _0x242ac5=await warehouse[_0x3a15fb(0x1d4)]([{'$match':{'status':_0x3a15fb(0x246),'warehouse_category':_0x3a15fb(0x1de),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0xf48779[0x0][_0x3a15fb(0x1d2)]=='English\x20(US)'){var _0xe07f0f=users['English'];console[_0x3a15fb(0x245)](_0xe07f0f);}else{if(_0xf48779[0x0][_0x3a15fb(0x1d2)]==_0x3a15fb(0x1a4))var _0xe07f0f=users['Hindi'];else{if(_0xf48779[0x0][_0x3a15fb(0x1d2)]=='German')var _0xe07f0f=users[_0x3a15fb(0x1bd)];else{if(_0xf48779[0x0]['language']==_0x3a15fb(0x1e2))var _0xe07f0f=users['Spanish'];else{if(_0xf48779[0x0][_0x3a15fb(0x1d2)]==_0x3a15fb(0x24a))var _0xe07f0f=users['French'];else{if(_0xf48779[0x0][_0x3a15fb(0x1d2)]==_0x3a15fb(0x22d))var _0xe07f0f=users[_0x3a15fb(0x1a7)];else{if(_0xf48779[0x0][_0x3a15fb(0x1d2)]==_0x3a15fb(0x225))var _0xe07f0f=users[_0x3a15fb(0x225)];else{if(_0xf48779[0x0]['language']==_0x3a15fb(0x26a))var _0xe07f0f=users[_0x3a15fb(0x21d)];}}}}}}}_0x3834a7[_0x3a15fb(0x1e5)](_0x3a15fb(0x1e9),{'success':_0x4f1d8d['flash'](_0x3a15fb(0x1c7)),'errors':_0x4f1d8d[_0x3a15fb(0x25a)]('errors'),'role':_0x6dc8a0,'profile':_0x5b0c54,'adjustment':_0x111843,'stock':_0x54d13e,'master_shop':_0xf48779,'warehouse_name':_0x2a8a1c,'unit':_0x408377,'language':_0xe07f0f,'warehouse':_0x242ac5});}catch(_0x15c40d){console[_0x3a15fb(0x245)](_0x15c40d),_0x3834a7[_0x3a15fb(0x214)](0xc8)[_0x3a15fb(0x23f)]({'message':_0x15c40d[_0x3a15fb(0x235)]});}}),router[a0_0x159ac9(0x216)](a0_0x159ac9(0x1ad),auth,async(_0x1d0086,_0x1cff7e)=>{var _0x3aa8b8=a0_0x159ac9;try{const _0x36b25a=_0x1d0086[_0x3aa8b8(0x268)]['id'],_0x2d91ca=await adjustment['findById']({'_id':_0x36b25a}),_0x57af5a=await warehouse[_0x3aa8b8(0x1e6)]({'name':_0x2d91ca[_0x3aa8b8(0x1c1)],'room':_0x2d91ca[_0x3aa8b8(0x239)]}),{warehouse_name:_0x52f1f2,date:_0x1b7f7b,prod_name:_0x34acf6,level:_0x1f8958,isle:_0x282378,pallet:_0x5a5133,stock:_0x27f814,types:_0x414dfc,adjust_qty:_0x8b3d3f,new_adjust_qty:_0x5c284d,note:_0x232921,Room_name:_0x43a69b,invoice:_0x86cd6,JO_number:_0x191676,expiry_date:_0x55df08}=_0x1d0086['body'];if(typeof _0x34acf6=='string')var _0x556d02=[_0x1d0086['body'][_0x3aa8b8(0x25d)]],_0x2991fb=[_0x1d0086[_0x3aa8b8(0x1be)]['level']],_0x2f1769=[_0x1d0086['body'][_0x3aa8b8(0x25b)]],_0x561902=[_0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1d0)]],_0x5a0022=[_0x1d0086[_0x3aa8b8(0x1be)]['New_Qty_Converted_adj']],_0x45ab07=[_0x1d0086['body']['New_Qty_Converted']],_0x15678c=[_0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1aa)]],_0x219987=[_0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1fd)]],_0x46fde5=[_0x1d0086['body'][_0x3aa8b8(0x20a)]],_0xd359cb=[_0x1d0086['body'][_0x3aa8b8(0x202)]],_0x47f65f=[_0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x253)]],_0x217629=[_0x1d0086['body'][_0x3aa8b8(0x1d6)]],_0x39dd70=[_0x1d0086[_0x3aa8b8(0x1be)]['production_date']],_0x204e1d=[_0x1d0086['body'][_0x3aa8b8(0x1d5)]],_0x3a738e=[_0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1d8)]],_0x2b8322=[_0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x249)]],_0x4aaea4=[_0x1d0086['body'][_0x3aa8b8(0x260)]];else var _0x556d02=[..._0x1d0086['body'][_0x3aa8b8(0x25d)]],_0x2991fb=[..._0x1d0086['body']['level']],_0x2f1769=[..._0x1d0086['body'][_0x3aa8b8(0x25b)]],_0x561902=[..._0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1d0)]],_0x5a0022=[..._0x1d0086[_0x3aa8b8(0x1be)]['New_Qty_Converted_adj']],_0x45ab07=[..._0x1d0086['body'][_0x3aa8b8(0x1b4)]],_0x15678c=[..._0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1e4)]],_0x219987=[..._0x1d0086[_0x3aa8b8(0x1be)]['Secondary_units']],_0x46fde5=[..._0x1d0086['body'][_0x3aa8b8(0x20a)]],_0xd359cb=[..._0x1d0086['body'][_0x3aa8b8(0x202)]],_0x47f65f=[..._0x1d0086['body'][_0x3aa8b8(0x253)]],_0x217629=[..._0x1d0086['body'][_0x3aa8b8(0x1d6)]],_0x39dd70=[..._0x1d0086['body'][_0x3aa8b8(0x224)]],_0x204e1d=[..._0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1d5)]],_0x3a738e=[..._0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x1d8)]],_0x2b8322=[..._0x1d0086[_0x3aa8b8(0x1be)][_0x3aa8b8(0x249)]],_0x4aaea4=[..._0x1d0086['body'][_0x3aa8b8(0x260)]];const _0x56300=_0x556d02['map'](_0x5e8a2c=>{return _0x5e8a2c={'product_name':_0x5e8a2c};});_0x2991fb[_0x3aa8b8(0x1fb)]((_0x45394e,_0x2b86e2)=>{var _0x5969ba=_0x3aa8b8;_0x3a738e[_0x5969ba(0x1fb)]((_0x24f201,_0x322df5)=>{var _0x59b097=_0x5969ba;if(_0x24f201=='Receiving\x20Area'&&_0x2b86e2==_0x322df5){var _0x1510d1=_0x45394e[_0x59b097(0x1ea)](0x3);_0x56300[_0x2b86e2][_0x59b097(0x26e)]=_0x45394e[0x0],_0x56300[_0x2b86e2][_0x59b097(0x238)]=_0x45394e[0x1],_0x56300[_0x2b86e2][_0x59b097(0x267)]=0x0,_0x56300[_0x2b86e2]['bin']=0x0,_0x56300[_0x2b86e2][_0x59b097(0x1f6)]=_0x59b097(0x207),_0x56300[_0x2b86e2][_0x59b097(0x1ba)]=_0x1510d1;}else{if(_0x24f201==_0x59b097(0x24c)&&_0x2b86e2==_0x322df5){var _0x1510d1=_0x45394e['slice'](0x3);_0x56300[_0x2b86e2][_0x59b097(0x26e)]=_0x45394e[0x0],_0x56300[_0x2b86e2]['rack']=_0x45394e[0x1],_0x56300[_0x2b86e2][_0x59b097(0x267)]=0x0,_0x56300[_0x2b86e2][_0x59b097(0x262)]=0x0,_0x56300[_0x2b86e2][_0x59b097(0x1f6)]='Floor',_0x56300[_0x2b86e2]['floorlevel']=_0x45394e[0x5];}else{if(_0x2b86e2==_0x322df5){var _0x50ee38;if(_0x45394e[0x4]=='L')_0x50ee38=_0x59b097(0x1b0);else _0x45394e[0x4]=='F'&&(_0x50ee38=_0x59b097(0x207));_0x56300[_0x2b86e2][_0x59b097(0x26e)]=_0x45394e[0x0],_0x56300[_0x2b86e2][_0x59b097(0x238)]=_0x45394e[0x1],_0x56300[_0x2b86e2]['bay']=_0x45394e[0x2],_0x56300[_0x2b86e2][_0x59b097(0x262)]=_0x45394e[0x3],_0x56300[_0x2b86e2]['type']=_0x50ee38,_0x56300[_0x2b86e2]['floorlevel']=_0x45394e[0x5];}}}});}),_0x2f1769[_0x3aa8b8(0x1fb)]((_0x4c24c1,_0x99a2b9)=>{var _0x446ccc=_0x3aa8b8;_0x56300[_0x99a2b9][_0x446ccc(0x24f)]=_0x4c24c1;}),_0x561902[_0x3aa8b8(0x1fb)]((_0x4211fe,_0x83b9cf)=>{var _0x147b4c=_0x3aa8b8;_0x56300[_0x83b9cf][_0x147b4c(0x1d0)]=_0x4211fe;}),_0x5a0022['forEach']((_0x3310fa,_0x5c67ac)=>{var _0x19aa7d=_0x3aa8b8;_0x56300[_0x5c67ac][_0x19aa7d(0x26d)]=_0x3310fa;}),_0x45ab07[_0x3aa8b8(0x1fb)]((_0x149a2f,_0x1bd8bf)=>{_0x56300[_0x1bd8bf]['new_adjust_qty']=_0x149a2f;}),_0x15678c[_0x3aa8b8(0x1fb)]((_0xff14b3,_0x291a49)=>{var _0x18f9ee=_0x3aa8b8;_0x56300[_0x291a49][_0x18f9ee(0x1e4)]=_0xff14b3;}),_0x219987[_0x3aa8b8(0x1fb)]((_0x43968e,_0xa3cb0)=>{_0x56300[_0xa3cb0]['secondary_unit']=_0x43968e;}),_0x46fde5['forEach']((_0x207838,_0x582698)=>{var _0x1b90ab=_0x3aa8b8;_0x56300[_0x582698][_0x1b90ab(0x1a3)]=_0x207838;}),_0xd359cb[_0x3aa8b8(0x1fb)]((_0x268a8d,_0x2efd8b)=>{var _0x11030c=_0x3aa8b8;_0x56300[_0x2efd8b][_0x11030c(0x202)]=_0x268a8d;}),_0x47f65f[_0x3aa8b8(0x1fb)]((_0x5b8178,_0x1c2f85)=>{var _0x2e8726=_0x3aa8b8;_0x56300[_0x1c2f85][_0x2e8726(0x253)]=_0x5b8178;}),_0x217629[_0x3aa8b8(0x1fb)]((_0x5428e5,_0x4d2690)=>{var _0x49b7af=_0x3aa8b8;_0x56300[_0x4d2690][_0x49b7af(0x24b)]=_0x5428e5;}),_0x39dd70[_0x3aa8b8(0x1fb)]((_0x22ba69,_0x1a8437)=>{var _0x494fca=_0x3aa8b8;_0x56300[_0x1a8437][_0x494fca(0x224)]=_0x22ba69;}),_0x204e1d[_0x3aa8b8(0x1fb)]((_0x469a0b,_0x33ad7f)=>{var _0x38a244=_0x3aa8b8;_0x56300[_0x33ad7f][_0x38a244(0x1d5)]=_0x469a0b;}),_0x3a738e['forEach']((_0x2d518a,_0x508010)=>{_0x56300[_0x508010]['room_names']=_0x2d518a;}),_0x2b8322[_0x3aa8b8(0x1fb)]((_0x17006f,_0x3d6e23)=>{var _0x18bf26=_0x3aa8b8;_0x56300[_0x3d6e23][_0x18bf26(0x20d)]=_0x17006f;}),_0x4aaea4[_0x3aa8b8(0x1fb)]((_0x4899e6,_0x73860f)=>{var _0x543c15=_0x3aa8b8;_0x56300[_0x73860f][_0x543c15(0x1cc)]=_0x4899e6;});const _0xb63cba=_0x56300[_0x3aa8b8(0x1c6)](_0x42016f=>_0x42016f[_0x3aa8b8(0x26d)]!=='0'&&_0x42016f[_0x3aa8b8(0x26d)]!=='');var _0x47c23b=0x0;_0xb63cba[_0x3aa8b8(0x1fb)](_0x798f39=>{var _0x1b4235=_0x3aa8b8;console['log'](_0x1b4235(0x1e3),_0x798f39),parseInt(_0x798f39[_0x1b4235(0x26d)])<=0x0&&_0x47c23b++;});if(_0x47c23b!=0x0)return _0x1d0086['flash']('errors',_0x3aa8b8(0x201)),_0x1cff7e[_0x3aa8b8(0x243)]('back');_0x2d91ca['warehouse_name']=_0x52f1f2,_0x2d91ca[_0x3aa8b8(0x1dd)]=_0x1b7f7b,_0x2d91ca[_0x3aa8b8(0x22c)]=_0xb63cba,_0x2d91ca[_0x3aa8b8(0x23b)]=_0x232921,_0x2d91ca[_0x3aa8b8(0x248)]=_0x86cd6,_0x2d91ca['isAllowEdit']=_0x3aa8b8(0x236);const _0x24418e=await _0x2d91ca[_0x3aa8b8(0x21a)]();_0x1d0086[_0x3aa8b8(0x25a)](_0x3aa8b8(0x1c7),_0x3aa8b8(0x1ab)),_0x1cff7e[_0x3aa8b8(0x243)](_0x3aa8b8(0x1b9));}catch(_0x328703){console['log'](_0x328703);}}),router[a0_0x159ac9(0x216)](a0_0x159ac9(0x1a6),async(_0x160426,_0x442649)=>{var _0x2852fb=a0_0x159ac9;const {primary_code:_0x21b393,warehouse_data:_0x1cbc33,rooms_data:_0x1da415,Roomslist:_0x51e9fe}=_0x160426['body'],_0x16a63d=_0x51e9fe[_0x2852fb(0x254)](','),_0x5285a3=[];async function _0x1ca50c(_0x350697){var _0x5c4b03=_0x2852fb;const _0x30869b=await warehouse[_0x5c4b03(0x1d4)]([{'$match':{'name':_0x1cbc33,'room':_0x350697}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x21b393}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5c4b03(0x1f4)},'product_stock':{'$first':_0x5c4b03(0x25f)},'primary_code':{'$first':_0x5c4b03(0x1df)},'secondary_code':{'$first':_0x5c4b03(0x1f3)},'product_code':{'$first':_0x5c4b03(0x256)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5c4b03(0x211)},'type':{'$first':_0x5c4b03(0x1db)},'pallet':{'$first':_0x5c4b03(0x200)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5c4b03(0x1f2)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5c4b03(0x1c2)},'production_date':{'$first':_0x5c4b03(0x252)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x5c4b03(0x20e)},'product_cat':{'$first':_0x5c4b03(0x1cb)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x5c4b03(0x1af)}}}]),_0x430fde=await warehouse[_0x5c4b03(0x1d4)]([{'$match':{'name':_0x1cbc33,'room':_0x350697}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x21b393}},{'$group':{'_id':_0x5c4b03(0x22a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5c4b03(0x25f)},'primary_code':{'$first':_0x5c4b03(0x1df)},'secondary_code':{'$first':_0x5c4b03(0x1f3)},'product_code':{'$first':_0x5c4b03(0x256)},'level':{'$first':_0x5c4b03(0x23e)},'isle':{'$first':_0x5c4b03(0x211)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x5c4b03(0x200)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5c4b03(0x1f2)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5c4b03(0x1b7)},'expiry_date':{'$first':_0x5c4b03(0x1c2)},'production_date':{'$first':_0x5c4b03(0x252)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x5c4b03(0x20e)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5c4b03(0x241)}}}]);if(_0x30869b['length']>0x0)_0x5285a3[_0x5c4b03(0x209)](_0x30869b);else _0x430fde['length']>0x0&&_0x5285a3['push'](_0x430fde);}const _0x102f49=_0x16a63d[_0x2852fb(0x215)](_0x285019=>_0x1ca50c(_0x285019));await Promise[_0x2852fb(0x223)](_0x102f49),_0x442649[_0x2852fb(0x23f)](_0x5285a3);}),router[a0_0x159ac9(0x216)](a0_0x159ac9(0x21c),async(_0x2aa7e1,_0xcbb7be)=>{var _0x1653a2=a0_0x159ac9;const {primaryCode:_0x51f352,secondaryCode:_0x483c27,productCode:_0x12ab1b,level:_0x43fe7f,isle:_0x3bc936,pallet:_0x1ee4ea,warehouses:_0x86653c,room:_0x1576a2}=_0x2aa7e1[_0x1653a2(0x1be)];try{const _0x5effd3=await warehouse[_0x1653a2(0x1d4)]([{'$match':{'name':_0x86653c,'room':_0x1576a2}},{'$unwind':_0x1653a2(0x247)},{'$match':{'product_details.level':parseInt(_0x43fe7f),'product_details.isle':_0x3bc936,'product_details.pallet':parseInt(_0x1ee4ea)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1653a2(0x1f4)},'product_stock':{'$first':_0x1653a2(0x25f)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0xcbb7be['status'](0xc8)[_0x1653a2(0x23f)](_0x5effd3);}catch(_0x27e597){_0xcbb7be[_0x1653a2(0x214)](0x194)[_0x1653a2(0x23f)]({'message':_0x27e597['message']});}}),module['exports']=router;