function a0_0x5dfe(_0x154a00,_0x38f750){var _0x19a88b=a0_0x19a8();return a0_0x5dfe=function(_0x5dfed3,_0x2b8d5d){_0x5dfed3=_0x5dfed3-0x1d7;var _0x85ce31=_0x19a88b[_0x5dfed3];return _0x85ce31;},a0_0x5dfe(_0x154a00,_0x38f750);}var a0_0x2cd596=a0_0x5dfe;(function(_0x424fc7,_0x441e9b){var _0x2da4ae=a0_0x5dfe,_0x4cc9d0=_0x424fc7();while(!![]){try{var _0x22d8d=parseInt(_0x2da4ae(0x28c))/0x1*(-parseInt(_0x2da4ae(0x1f0))/0x2)+-parseInt(_0x2da4ae(0x1ec))/0x3+parseInt(_0x2da4ae(0x1f7))/0x4+parseInt(_0x2da4ae(0x26c))/0x5*(parseInt(_0x2da4ae(0x25c))/0x6)+-parseInt(_0x2da4ae(0x286))/0x7*(-parseInt(_0x2da4ae(0x291))/0x8)+-parseInt(_0x2da4ae(0x219))/0x9+-parseInt(_0x2da4ae(0x22d))/0xa*(-parseInt(_0x2da4ae(0x261))/0xb);if(_0x22d8d===_0x441e9b)break;else _0x4cc9d0['push'](_0x4cc9d0['shift']());}catch(_0x123d21){_0x4cc9d0['push'](_0x4cc9d0['shift']());}}}(a0_0x19a8,0x1884c));const express=require(a0_0x2cd596(0x27c)),app=express(),router=express['Router'](),auth=require(a0_0x2cd596(0x1e5)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x2cd596(0x250)),users=require(a0_0x2cd596(0x28f)),nodemailer=require(a0_0x2cd596(0x2a8));function a0_0x19a8(){var _0x81634f=['Arabic','</head><body>','</thead>','$name','10ShhSvS','status','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</body></html>','$product_details.product_stock','length','/adjustment/view','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','save','$product_details.maxPerUnit','$product_details.rack','$product_details.product_cat','expiry_date','\x20</h2>','exports','English\x20(US)','toString','port','logo','map','Receiving\x20Area','split','Return\x20Goods','$product_details','Hindi','stockBefore','unit','string','$product','$product_details.type','product_name','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','minus','$product_details.secondary_code','../models/all_models','edit_adjustment_view','$room','then','language','error','<h5>','<h5\x20style=\x22text-align:\x20left;\x22>','<tr>','edit_adjustment','product','json','68112DipkwS','email','Enclosed','$product_details.floorlevel','French','1551605DvlovR','message','RMSEmail','Spanish','type','$product_details.expiry_date','find','<tbody\x20style=\x22text-align:\x20center;\x22>','/upload/','primary_code','findOne','45sdAiQV','adjustment\x20data\x20update\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.primary_code','<h2>\x20','catch','$product_details.isle','storage','level','$product_details.bay','$product_details.secondary_unit','<strong>\x20Regards\x20</strong>','</td>','aggregate','$product_details.product_code','floor','express','</table>','$product_details.bin','Adjustment\x20Mail','foreach\x20newproduct','warehouse_name','Enabled','production_date','types','/adjustment/preview/','476Fzcasg','forEach','Raw\x20Materials','new_adjust_qty','<div>','site_title','1419hcZZTr','Return\x20Rooms','</tbody>','../public/language/languages.json','prod_code','8696TFuIZP','Secondary_units','slice','maxperunit','False','floorlevel','$warehouse_name','prod_name','staff','redirect','An\x20error\x20occurred\x20while\x20saving\x20data.','Chinese','all','<hr\x20class=\x22my-3\x22>','</h5>','Logo.png','product_code','$date','finalize','second1','$product_details.storage','\x20Order\x20Date\x20:\x20','invoice','nodemailer','bin','$product_details.unit','Email\x20sent\x20successfully','adjustment\x20add\x20successfull','Shelves','$_id','push','<!DOCTYPE\x20html>','adjust_qty','Primary_Units','prime1','batch_code','flash','Floor','</div>','secondary_code','body','$product_details.level','Portuguese','warehouse','$product_details.production_date','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','image','New_Qty_Converted','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','user','product_details','/preview/:id','add_adjustment','secondary_unit','527559fGAdUQ','filter','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','ADJ-','236VdkEBm','$product_details.batch_code','$product.room_names','_id','get','English','back','761124SnNPcg','New_Qty_Converted_adj','max_per_unit','</span>','<html><head><title></title>','post','/CheckingWarehouse','Ambient','stock','$product.product_name','Arabic\x20(ae)','$product_details.maxProducts','$finalize','random','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','params','padStart','render','note','prod_invoice','German','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details._id','prod_cat','room_names','/barcode_scanner','$product_details.product_name','\x20<>\x20','findById','Rooms','</tr>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','maxPerUnit','log','573273yevzPt','/view/:id','$invoice','/view/add_adjustment','adjustment','Portuguese\x20(BR)','room','role','bay','success','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','errors','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_stock','host'];a0_0x19a8=function(){return _0x81634f;};return a0_0x19a8();}router[a0_0x2cd596(0x1f4)]('/view',auth,async(_0x298f7e,_0xaea945)=>{var _0x3ec19b=a0_0x2cd596;try{const {username:_0x34fb56,email:_0x50087e,role:_0x494c05}=_0x298f7e['user'],_0x403221=_0x298f7e[_0x3ec19b(0x1e7)],_0x2b89ab=await profile[_0x3ec19b(0x26b)]({'email':_0x403221[_0x3ec19b(0x25d)]}),_0x508582=await master_shop['find']();console[_0x3ec19b(0x218)]('master',_0x508582);let _0x1599e5;if(_0x403221[_0x3ec19b(0x220)]=='staff'){const _0x224ee3=await staff['findOne']({'email':_0x403221[_0x3ec19b(0x25d)]});_0x1599e5=await warehouse[_0x3ec19b(0x267)]({'status':_0x3ec19b(0x282),'name':_0x224ee3[_0x3ec19b(0x1df)]});}else _0x1599e5=await warehouse[_0x3ec19b(0x267)]({'status':_0x3ec19b(0x282)});const _0x1a7610=await product[_0x3ec19b(0x267)]();let _0x22dbce;if(_0x403221[_0x3ec19b(0x220)]==_0x3ec19b(0x299)){const _0x1926b3=await staff[_0x3ec19b(0x26b)]({'email':_0x403221[_0x3ec19b(0x25d)]});_0x22dbce=await adjustment[_0x3ec19b(0x267)]({'warehouse_name':_0x1926b3[_0x3ec19b(0x1df)]});}else _0x22dbce=await adjustment[_0x3ec19b(0x279)]([{'$unwind':'$product'},{'$group':{'_id':_0x3ec19b(0x2ae),'invoice':{'$first':_0x3ec19b(0x21b)},'date':{'$first':_0x3ec19b(0x2a2)},'warehouse_name':{'$first':_0x3ec19b(0x297)},'room':{'$addToSet':_0x3ec19b(0x1f2)},'finalize':{'$first':_0x3ec19b(0x203)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x508582[0x0][_0x3ec19b(0x254)]==_0x3ec19b(0x23c)){var _0x5aa621=users['English'];console['log'](_0x5aa621);}else{if(_0x508582[0x0][_0x3ec19b(0x254)]=='Hindi')var _0x5aa621=users[_0x3ec19b(0x245)];else{if(_0x508582[0x0]['language']==_0x3ec19b(0x20b))var _0x5aa621=users[_0x3ec19b(0x20b)];else{if(_0x508582[0x0]['language']==_0x3ec19b(0x264))var _0x5aa621=users[_0x3ec19b(0x264)];else{if(_0x508582[0x0][_0x3ec19b(0x254)]=='French')var _0x5aa621=users[_0x3ec19b(0x260)];else{if(_0x508582[0x0]['language']==_0x3ec19b(0x21e))var _0x5aa621=users[_0x3ec19b(0x1de)];else{if(_0x508582[0x0][_0x3ec19b(0x254)]=='Chinese')var _0x5aa621=users['Chinese'];else{if(_0x508582[0x0]['language']=='Arabic\x20(ae)')var _0x5aa621=users[_0x3ec19b(0x229)];}}}}}}}_0xaea945['render'](_0x3ec19b(0x21d),{'success':_0x298f7e['flash']('success'),'errors':_0x298f7e['flash'](_0x3ec19b(0x224)),'role':_0x403221,'profile':_0x2b89ab,'warehouse':_0x1599e5,'product':_0x1a7610,'adjustment':_0x22dbce,'master_shop':_0x508582,'language':_0x5aa621});}catch(_0x25384e){console[_0x3ec19b(0x218)](_0x25384e);}});async function getRandom8DigitNumber(){var _0x1e9299=a0_0x2cd596;const _0x4a41c5=0x989680,_0x34e81b=0x5f5e0ff,_0x30d291=Math[_0x1e9299(0x27b)](Math[_0x1e9299(0x204)]()*(_0x34e81b-_0x4a41c5+0x1))+_0x4a41c5;var _0x2fb644;const _0x6ddb95=await adjustment[_0x1e9299(0x26b)]({'invoice':'ADJ-'+_0x30d291});return _0x6ddb95&&_0x6ddb95[_0x1e9299(0x232)]>0x0?_0x2fb644=_0x1e9299(0x1ef)+_0x30d291:_0x2fb644=_0x1e9299(0x1ef)+_0x30d291,_0x2fb644;}router['get'](a0_0x2cd596(0x21c),auth,async(_0x15a2df,_0x3299e9)=>{var _0xbff6c2=a0_0x2cd596;try{const {username:_0x56da32,email:_0x185836,role:_0x597df6}=_0x15a2df['user'],_0x3063b8=_0x15a2df[_0xbff6c2(0x1e7)],_0x3450e7=await profile[_0xbff6c2(0x26b)]({'email':_0x3063b8[_0xbff6c2(0x25d)]}),_0x3d7747=await master_shop[_0xbff6c2(0x267)]();let _0x6781fa;if(_0x3063b8[_0xbff6c2(0x220)]==_0xbff6c2(0x299)){const _0x234ede=await staff[_0xbff6c2(0x26b)]({'email':_0x3063b8['email']});_0x6781fa=await warehouse['aggregate']([{'$match':{'status':_0xbff6c2(0x282),'name':_0x234ede[_0xbff6c2(0x1df)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0xbff6c2(0x22c),'name':{'$first':'$name'}}}]);}else _0x6781fa=await warehouse[_0xbff6c2(0x279)]([{'$match':{'status':_0xbff6c2(0x282),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xbff6c2(0x243)}}},{'$group':{'_id':_0xbff6c2(0x22c),'name':{'$first':'$name'}}}]);const _0x1e189f=await product[_0xbff6c2(0x267)]({}),_0x58680b=await adjustment['find']({}),_0x464ab6=_0x58680b[_0xbff6c2(0x232)]+0x1,_0x38c6ea=_0xbff6c2(0x1ef)+_0x464ab6[_0xbff6c2(0x23d)]()[_0xbff6c2(0x207)](0x5,'0');var _0x404812=[_0xbff6c2(0x1fe),_0xbff6c2(0x25e),_0xbff6c2(0x28d)];if(_0x3d7747[0x0][_0xbff6c2(0x254)]==_0xbff6c2(0x23c))var _0x20abf3=users['English'];else{if(_0x3d7747[0x0][_0xbff6c2(0x254)]=='Hindi')var _0x20abf3=users['Hindi'];else{if(_0x3d7747[0x0]['language']=='German')var _0x20abf3=users[_0xbff6c2(0x20b)];else{if(_0x3d7747[0x0][_0xbff6c2(0x254)]==_0xbff6c2(0x264))var _0x20abf3=users[_0xbff6c2(0x264)];else{if(_0x3d7747[0x0][_0xbff6c2(0x254)]==_0xbff6c2(0x260))var _0x20abf3=users[_0xbff6c2(0x260)];else{if(_0x3d7747[0x0][_0xbff6c2(0x254)]=='Portuguese\x20(BR)')var _0x20abf3=users[_0xbff6c2(0x1de)];else{if(_0x3d7747[0x0][_0xbff6c2(0x254)]=='Chinese')var _0x20abf3=users[_0xbff6c2(0x29c)];else{if(_0x3d7747[0x0][_0xbff6c2(0x254)]==_0xbff6c2(0x201))var _0x20abf3=users[_0xbff6c2(0x229)];}}}}}}}const _0x277491=getRandom8DigitNumber();_0x277491[_0xbff6c2(0x253)](_0x2f97d7=>{var _0xc9e551=_0xbff6c2;_0x3299e9[_0xc9e551(0x208)](_0xc9e551(0x1ea),{'success':_0x15a2df['flash'](_0xc9e551(0x222)),'errors':_0x15a2df['flash'](_0xc9e551(0x224)),'role':_0x3063b8,'profile':_0x3450e7,'warehouse':_0x6781fa,'product':_0x1e189f,'master_shop':_0x3d7747,'language':_0x20abf3,'rooms_data':_0x404812,'invoice_no':_0x2f97d7});})['catch'](_0x1e35ad=>{var _0x5f18ce=_0xbff6c2;_0x15a2df['flash'](_0x5f18ce(0x224),_0x5f18ce(0x216)),_0x3299e9[_0x5f18ce(0x29a)](_0x5f18ce(0x233));});}catch(_0x2c925f){console['log'](_0x2c925f);}}),router['post'](a0_0x2cd596(0x21c),auth,async(_0x15e469,_0x2a9a61)=>{var _0x45d511=a0_0x2cd596;try{const {warehouse_name:_0x423892,date:_0x1550cc,prod_name:_0x52cd74,level:_0x5910d1,isle:_0x945fa9,pallet:_0x3b5f9f,stock:_0x4ebfbe,types:_0x224bb0,adjust_qty:_0x57dd52,new_adjust_qty:_0x49ab7f,note:_0x4dd5b1,Room_name:_0x2723db,invoice:_0x60b6d8,JO_number:_0x12bdc3,expiry_date:_0x3aa139}=_0x15e469[_0x45d511(0x1dc)];if(typeof _0x52cd74==_0x45d511(0x248))var _0x44d29e=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x298)]],_0x404627=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x274)]],_0x2f5c3e=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x1ff)]],_0x30978e=[_0x15e469['body'][_0x45d511(0x284)]],_0x1d766a=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x1f8)]],_0x4eb137=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x1e4)]],_0x14d635=[_0x15e469['body'][_0x45d511(0x2b2)]],_0x306993=[_0x15e469['body']['Secondary_units']],_0x566dfe=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x290)]],_0xdfe99f=[_0x15e469[_0x45d511(0x1dc)]['batch_code']],_0x353a60=[_0x15e469['body'][_0x45d511(0x239)]],_0xe168e1=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x1f9)]],_0x5b1817=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x283)]],_0x12aa70=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x20e)]],_0x20815a=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x214)]],_0x4eb41a=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x2b3)]],_0x1e9233=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x2a4)]],_0x2a2edc=[_0x15e469[_0x45d511(0x1dc)][_0x45d511(0x20a)]];else var _0x44d29e=[..._0x15e469[_0x45d511(0x1dc)]['prod_name']],_0x404627=[..._0x15e469['body'][_0x45d511(0x274)]],_0x2f5c3e=[..._0x15e469[_0x45d511(0x1dc)]['stock']],_0x30978e=[..._0x15e469[_0x45d511(0x1dc)]['types']],_0x1d766a=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x1f8)]],_0x4eb137=[..._0x15e469[_0x45d511(0x1dc)]['New_Qty_Converted']],_0x14d635=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x247)]],_0x306993=[..._0x15e469['body']['Secondary_units']],_0x566dfe=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x290)]],_0xdfe99f=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x1d7)]],_0x353a60=[..._0x15e469['body'][_0x45d511(0x239)]],_0xe168e1=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x1f9)]],_0x5b1817=[..._0x15e469['body'][_0x45d511(0x283)]],_0x12aa70=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x20e)]],_0x20815a=[..._0x15e469['body'][_0x45d511(0x214)]],_0x4eb41a=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x2b3)]],_0x1e9233=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x2a4)]],_0x2a2edc=[..._0x15e469[_0x45d511(0x1dc)][_0x45d511(0x20a)]];const _0x47dc64=_0x44d29e['map'](_0x12e3c3=>{return _0x12e3c3={'product_name':_0x12e3c3};});_0x404627[_0x45d511(0x287)]((_0x82334e,_0x1f529c)=>{_0x20815a['forEach']((_0x59330c,_0x335e16)=>{var _0x552d51=a0_0x5dfe;if(_0x59330c=='Receiving\x20Area'&&_0x1f529c==_0x335e16){var _0x5d3ff0=_0x82334e['slice'](0x3);_0x47dc64[_0x1f529c][_0x552d51(0x273)]=_0x82334e[0x0],_0x47dc64[_0x1f529c][_0x552d51(0x24c)]=_0x82334e[0x1],_0x47dc64[_0x1f529c][_0x552d51(0x221)]=0x0,_0x47dc64[_0x1f529c][_0x552d51(0x2a9)]=0x0,_0x47dc64[_0x1f529c][_0x552d51(0x265)]='Floor',_0x47dc64[_0x1f529c][_0x552d51(0x296)]=_0x5d3ff0;}else{if(_0x59330c==_0x552d51(0x2ad)&&_0x1f529c==_0x335e16){var _0x5d3ff0=_0x82334e[_0x552d51(0x293)](0x3);_0x47dc64[_0x1f529c][_0x552d51(0x273)]=_0x82334e[0x0],_0x47dc64[_0x1f529c][_0x552d51(0x24c)]=_0x82334e[0x1],_0x47dc64[_0x1f529c][_0x552d51(0x221)]=0x0,_0x47dc64[_0x1f529c][_0x552d51(0x2a9)]=0x0,_0x47dc64[_0x1f529c][_0x552d51(0x265)]=_0x552d51(0x1d9),_0x47dc64[_0x1f529c][_0x552d51(0x296)]=_0x82334e[0x5];}else{if(_0x1f529c==_0x335e16){var _0x4dd6f6;if(_0x82334e[0x4]=='L')_0x4dd6f6='Level';else _0x82334e[0x4]=='F'&&(_0x4dd6f6=_0x552d51(0x1d9));_0x47dc64[_0x1f529c][_0x552d51(0x273)]=_0x82334e[0x0],_0x47dc64[_0x1f529c][_0x552d51(0x24c)]=_0x82334e[0x1],_0x47dc64[_0x1f529c][_0x552d51(0x221)]=_0x82334e[0x2],_0x47dc64[_0x1f529c]['bin']=_0x82334e[0x3],_0x47dc64[_0x1f529c]['type']=_0x4dd6f6,_0x47dc64[_0x1f529c][_0x552d51(0x296)]=_0x82334e[0x5];}}}});}),_0x2f5c3e[_0x45d511(0x287)]((_0x57def0,_0x3e7264)=>{var _0x37c2e7=_0x45d511;_0x47dc64[_0x3e7264][_0x37c2e7(0x246)]=_0x57def0;}),_0x30978e[_0x45d511(0x287)]((_0x5d1a8c,_0x2b0c42)=>{var _0xcfc31b=_0x45d511;_0x47dc64[_0x2b0c42][_0xcfc31b(0x284)]=_0x5d1a8c;}),_0x1d766a[_0x45d511(0x287)]((_0x25950d,_0x23bcbb)=>{var _0x4d04e3=_0x45d511;_0x47dc64[_0x23bcbb][_0x4d04e3(0x2b1)]=_0x25950d;}),_0x4eb137[_0x45d511(0x287)]((_0x54bf70,_0x1afe3c)=>{var _0xfd2fd7=_0x45d511;_0x47dc64[_0x1afe3c][_0xfd2fd7(0x289)]=_0x54bf70;}),_0x14d635[_0x45d511(0x287)]((_0x40d8f3,_0x292820)=>{var _0x58f72e=_0x45d511;_0x47dc64[_0x292820][_0x58f72e(0x247)]=_0x40d8f3;}),_0x306993[_0x45d511(0x287)]((_0x58aad4,_0x36a9cb)=>{var _0x3b8035=_0x45d511;_0x47dc64[_0x36a9cb][_0x3b8035(0x1eb)]=_0x58aad4;}),_0x566dfe[_0x45d511(0x287)]((_0x2e9fb0,_0x59ac83)=>{var _0x517248=_0x45d511;_0x47dc64[_0x59ac83][_0x517248(0x2a1)]=_0x2e9fb0;}),_0xdfe99f[_0x45d511(0x287)]((_0x2af5ec,_0x456318)=>{var _0x589893=_0x45d511;_0x47dc64[_0x456318][_0x589893(0x1d7)]=_0x2af5ec;}),_0x353a60[_0x45d511(0x287)]((_0x2831e4,_0x435bc0)=>{_0x47dc64[_0x435bc0]['expiry_date']=_0x2831e4;}),_0xe168e1[_0x45d511(0x287)]((_0x4fd038,_0x15205a)=>{_0x47dc64[_0x15205a]['maxperunit']=_0x4fd038;}),_0x5b1817[_0x45d511(0x287)]((_0x15ddf6,_0x3ea6d0)=>{var _0x5e36de=_0x45d511;_0x47dc64[_0x3ea6d0][_0x5e36de(0x283)]=_0x15ddf6;}),_0x12aa70['forEach']((_0x389a9d,_0x2cda91)=>{var _0x38f445=_0x45d511;_0x47dc64[_0x2cda91][_0x38f445(0x20e)]=_0x389a9d;}),_0x20815a['forEach']((_0x264e66,_0x1369bd)=>{_0x47dc64[_0x1369bd]['room_names']=_0x264e66;}),_0x4eb41a[_0x45d511(0x287)]((_0x2c4260,_0x420000)=>{var _0x106cfe=_0x45d511;_0x47dc64[_0x420000][_0x106cfe(0x26a)]=_0x2c4260;}),_0x1e9233[_0x45d511(0x287)]((_0x9ce486,_0x3bc65e)=>{var _0x2a2806=_0x45d511;_0x47dc64[_0x3bc65e][_0x2a2806(0x1db)]=_0x9ce486;}),_0x2a2edc['forEach']((_0x8eec01,_0x5dcdba)=>{var _0x564fb1=_0x45d511;_0x47dc64[_0x5dcdba][_0x564fb1(0x2a7)]=_0x8eec01;});const _0x33fd90=_0x47dc64[_0x45d511(0x1ed)](_0x3bb417=>_0x3bb417[_0x45d511(0x2b1)]!=='0'&&_0x3bb417['adjust_qty']!=='');var _0x289435=0x0;_0x33fd90[_0x45d511(0x287)](_0x51d99a=>{var _0x159452=_0x45d511;console[_0x159452(0x218)](_0x159452(0x280),_0x51d99a),parseInt(_0x51d99a['adjust_qty'])<=0x0&&_0x289435++;});if(_0x289435!=0x0)return _0x15e469['flash']('errors',_0x45d511(0x1ee)),_0x2a9a61[_0x45d511(0x29a)]('back');const _0x4a4a1a=new adjustment({'warehouse_name':_0x423892,'date':_0x1550cc,'product':_0x33fd90,'note':_0x4dd5b1,'room':_0x2723db,'invoice':_0x60b6d8,'JO_number':_0x12bdc3,'expiry_date':_0x3aa139}),_0x56a2ff=await _0x4a4a1a[_0x45d511(0x235)]();_0x15e469[_0x45d511(0x1d8)](_0x45d511(0x222),_0x45d511(0x2ac)),_0x2a9a61[_0x45d511(0x29a)](_0x45d511(0x285)+_0x56a2ff[_0x45d511(0x1f3)]);}catch(_0x3fe819){console['log'](_0x3fe819),_0x2a9a61[_0x45d511(0x22e)](0xc8)['json']({'message':_0x3fe819['message']});}}),router['get'](a0_0x2cd596(0x1e9),auth,async(_0x1b4a2f,_0x1ef023)=>{var _0x2a71bd=a0_0x2cd596;try{const {username:_0x2f5207,email:_0x1a145b,role:_0x58704f}=_0x1b4a2f[_0x2a71bd(0x1e7)],_0x402e46=_0x1b4a2f[_0x2a71bd(0x1e7)],_0x2b1552=await profile[_0x2a71bd(0x26b)]({'email':_0x402e46[_0x2a71bd(0x25d)]}),_0x15c8ce=await master_shop['find'](),_0x5d1505=_0x1b4a2f[_0x2a71bd(0x206)]['id'],_0x404780=await adjustment[_0x2a71bd(0x213)]({'_id':_0x5d1505}),_0x5e68d2=await purchases['aggregate']([{'$match':{'warehouse_name':_0x404780[_0x2a71bd(0x281)]}},{'$unwind':_0x2a71bd(0x249)},{'$group':{'_id':_0x2a71bd(0x200)}}]),_0x388c85=await product['find']({}),_0x51b63c=await warehouse[_0x2a71bd(0x279)]([{'$match':{'name':_0x404780[_0x2a71bd(0x281)]}},{'$unwind':_0x2a71bd(0x244)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2a71bd(0x231)},'bay':{'$first':_0x2a71bd(0x275)},'bin':{'$first':_0x2a71bd(0x27e)},'type':{'$first':_0x2a71bd(0x24a)},'floorlevel':{'$first':_0x2a71bd(0x25f)},'primary_code':{'$first':_0x2a71bd(0x26f)},'secondary_code':{'$first':_0x2a71bd(0x24f)},'product_code':{'$first':_0x2a71bd(0x27a)},'storage':{'$first':_0x2a71bd(0x2a5)},'rack':{'$first':_0x2a71bd(0x237)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2a71bd(0x1f1)},'room':{'$first':_0x2a71bd(0x252)}}}]);if(_0x15c8ce[0x0][_0x2a71bd(0x254)]=='English\x20(US)'){var _0x33eec4=users['English'];console[_0x2a71bd(0x218)](_0x33eec4);}else{if(_0x15c8ce[0x0][_0x2a71bd(0x254)]==_0x2a71bd(0x245))var _0x33eec4=users[_0x2a71bd(0x245)];else{if(_0x15c8ce[0x0]['language']==_0x2a71bd(0x20b))var _0x33eec4=users[_0x2a71bd(0x20b)];else{if(_0x15c8ce[0x0]['language']==_0x2a71bd(0x264))var _0x33eec4=users[_0x2a71bd(0x264)];else{if(_0x15c8ce[0x0][_0x2a71bd(0x254)]=='French')var _0x33eec4=users[_0x2a71bd(0x260)];else{if(_0x15c8ce[0x0][_0x2a71bd(0x254)]==_0x2a71bd(0x21e))var _0x33eec4=users[_0x2a71bd(0x1de)];else{if(_0x15c8ce[0x0]['language']==_0x2a71bd(0x29c))var _0x33eec4=users[_0x2a71bd(0x29c)];else{if(_0x15c8ce[0x0][_0x2a71bd(0x254)]==_0x2a71bd(0x201))var _0x33eec4=users[_0x2a71bd(0x229)];}}}}}}}_0x1ef023[_0x2a71bd(0x208)](_0x2a71bd(0x251),{'success':_0x1b4a2f[_0x2a71bd(0x1d8)](_0x2a71bd(0x222)),'errors':_0x1b4a2f[_0x2a71bd(0x1d8)](_0x2a71bd(0x224)),'role':_0x402e46,'profile':_0x2b1552,'adjustment':_0x404780,'stock':_0x51b63c,'master_shop':_0x15c8ce,'warehouse_name':_0x5e68d2,'unit':_0x388c85,'language':_0x33eec4});}catch(_0x257d0c){console[_0x2a71bd(0x218)](_0x257d0c),_0x1ef023[_0x2a71bd(0x22e)](0xc8)[_0x2a71bd(0x25b)]({'message':_0x257d0c[_0x2a71bd(0x262)]});}}),router['post'](a0_0x2cd596(0x1e9),auth,async(_0x485abb,_0x2ea244)=>{var _0x23054f=a0_0x2cd596;try{const _0x318e2f=_0x485abb[_0x23054f(0x206)]['id'],{warehouse_name:_0x171dfa,Room_name:_0x231420}=_0x485abb[_0x23054f(0x1dc)],_0x23158d=await adjustment[_0x23054f(0x213)]({'_id':_0x318e2f}),_0x5aa99e=_0x23158d[_0x23054f(0x25a)][_0x23054f(0x240)](async _0x596d0a=>{var _0x3856f5=_0x23054f;if(_0x596d0a[_0x3856f5(0x2b1)]>0x0){var _0x5727d0=await warehouse[_0x3856f5(0x26b)]({'name':_0x171dfa,'room':_0x596d0a[_0x3856f5(0x20f)],'warehouse_category':_0x3856f5(0x288)});const _0x199c16=_0x5727d0[_0x3856f5(0x1e8)][_0x3856f5(0x240)](_0x3b5883=>{var _0x199099=_0x3856f5;if(_0x596d0a[_0x199099(0x265)]==_0x199099(0x24e)){if(_0x3b5883[_0x199099(0x24b)]==_0x596d0a[_0x199099(0x24b)]&&_0x3b5883['floorlevel']==_0x596d0a[_0x199099(0x296)]&&_0x3b5883['type']==_0x596d0a[_0x199099(0x265)]&&_0x3b5883[_0x199099(0x2a9)]==_0x596d0a['bin']&&_0x3b5883[_0x199099(0x221)]==_0x596d0a['bay']&&_0x3b5883[_0x199099(0x24c)]==_0x596d0a[_0x199099(0x24c)]&&_0x3b5883['storage']==_0x596d0a['storage']&&_0x3b5883['expiry_date']==_0x596d0a[_0x199099(0x239)]&&_0x3b5883[_0x199099(0x1d7)]==_0x596d0a['batch_code']&&_0x3b5883[_0x199099(0x283)]==_0x596d0a[_0x199099(0x283)]&&_0x3b5883[_0x199099(0x2a7)]==_0x596d0a[_0x199099(0x2a7)]){var _0x3e603f;_0x3e603f=_0x596d0a['adjust_qty'],_0x596d0a['prod_cat']=='S'&&(_0x3e603f=_0x596d0a['adjust_qty']),_0x3b5883[_0x199099(0x227)]=_0x3b5883[_0x199099(0x227)]-_0x3e603f;}}else{if(_0x3b5883[_0x199099(0x24b)]==_0x596d0a[_0x199099(0x24b)]&&_0x3b5883[_0x199099(0x296)]==_0x596d0a['floorlevel']&&_0x3b5883[_0x199099(0x265)]==_0x596d0a[_0x199099(0x265)]&&_0x3b5883[_0x199099(0x2a9)]==_0x596d0a[_0x199099(0x2a9)]&&_0x3b5883[_0x199099(0x221)]==_0x596d0a[_0x199099(0x221)]&&_0x3b5883[_0x199099(0x24c)]==_0x596d0a[_0x199099(0x24c)]&&_0x3b5883[_0x199099(0x273)]==_0x596d0a[_0x199099(0x273)]&&_0x3b5883[_0x199099(0x239)]==_0x596d0a[_0x199099(0x239)]&&_0x3b5883['batch_code']==_0x596d0a[_0x199099(0x1d7)]&&_0x3b5883[_0x199099(0x283)]==_0x596d0a['production_date']&&_0x3b5883[_0x199099(0x2a7)]==_0x596d0a[_0x199099(0x2a7)]){console[_0x199099(0x218)](_0x596d0a);var _0x3e603f;_0x3e603f=_0x596d0a[_0x199099(0x2b1)],_0x596d0a[_0x199099(0x20e)]=='S'&&(_0x3e603f=_0x596d0a[_0x199099(0x2b1)]),console[_0x199099(0x218)](_0x3e603f+'\x20<>\x20'+_0x596d0a[_0x199099(0x2b1)]+_0x199099(0x212)+_0x3b5883[_0x199099(0x217)]+_0x199099(0x212)+_0x596d0a['prod_cat']),_0x3b5883[_0x199099(0x227)]=_0x3b5883[_0x199099(0x227)]+_0x3e603f;}}});}return _0x5727d0;});Promise[_0x23054f(0x29d)](_0x5aa99e)['then'](async _0x2284b7=>{var _0x475829=_0x23054f;try{for(const _0x25f5a4 of _0x2284b7){await _0x25f5a4[_0x475829(0x235)]();}_0x23158d[_0x475829(0x2a3)]='True';const _0x3ee5ed=await _0x23158d['save'](),_0x1862fd=await master_shop[_0x475829(0x267)](),_0x2d0f0d=await email_settings['findOne'](),_0x4c7eb0=await supervisor_settings['find']();var _0x14d02e=_0x23158d['product'],_0x5e5719='',_0x327335;for(_0x327335 in _0x14d02e){_0x5e5719+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x14d02e[_0x327335][_0x475829(0x24b)]+'</td>'+_0x475829(0x226)+_0x14d02e[_0x327335][_0x475829(0x2a1)]+_0x475829(0x278)+_0x475829(0x226)+_0x14d02e[_0x327335][_0x475829(0x2b1)]+_0x475829(0x278)+_0x475829(0x226)+_0x14d02e[_0x327335][_0x475829(0x247)]+'</td>'+_0x475829(0x226)+_0x14d02e[_0x327335]['secondary_unit']+_0x475829(0x278)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x23158d['warehouse_name']+'</td>'+_0x475829(0x226)+_0x14d02e[_0x327335][_0x475829(0x20f)]+'</td>'+_0x475829(0x226)+_0x14d02e[_0x327335][_0x475829(0x273)]+_0x14d02e[_0x327335][_0x475829(0x24c)]+_0x14d02e[_0x327335]['bay']+_0x14d02e[_0x327335][_0x475829(0x2a9)]+_0x14d02e[_0x327335][_0x475829(0x265)][0x0]+_0x14d02e[_0x327335][_0x475829(0x296)]+_0x475829(0x278),_0x475829(0x215);}let _0x2958a9=nodemailer['createTransport']({'host':_0x2d0f0d[_0x475829(0x228)],'port':Number(_0x2d0f0d[_0x475829(0x23e)]),'secure':![],'auth':{'user':_0x2d0f0d['email'],'pass':_0x2d0f0d['password']}}),_0x56007c={'from':_0x2d0f0d[_0x475829(0x25d)],'to':_0x4c7eb0[0x0][_0x475829(0x263)],'subject':_0x475829(0x27f),'attachments':[{'filename':_0x475829(0x2a0),'path':__dirname+'/../public'+_0x475829(0x269)+_0x1862fd[0x0][_0x475829(0x1e3)],'cid':_0x475829(0x23f)}],'html':_0x475829(0x2b0)+_0x475829(0x1fb)+_0x475829(0x22a)+'<div>'+_0x475829(0x234)+_0x475829(0x28a)+_0x475829(0x22f)+_0x475829(0x1da)+_0x475829(0x28a)+_0x475829(0x270)+_0x1862fd[0x0][_0x475829(0x28b)]+_0x475829(0x23a)+_0x475829(0x1da)+_0x475829(0x1da)+_0x475829(0x29e)+_0x475829(0x28a)+_0x475829(0x257)+'\x20Order\x20Number\x20:\x20'+_0x23158d[_0x475829(0x2a7)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x475829(0x2a6)+_0x23158d['date']+'\x20'+_0x475829(0x1fa)+_0x475829(0x29f)+'</div>'+_0x475829(0x1e1)+_0x475829(0x223)+_0x475829(0x258)+_0x475829(0x225)+_0x475829(0x20c)+_0x475829(0x205)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x475829(0x1e2)+_0x475829(0x24d)+_0x475829(0x1e6)+_0x475829(0x26e)+_0x475829(0x215)+_0x475829(0x22b)+_0x475829(0x268)+'\x20'+_0x5e5719+'\x20'+_0x475829(0x28e)+_0x475829(0x27d)+_0x475829(0x28a)+_0x475829(0x277)+_0x475829(0x256)+_0x1862fd[0x0][_0x475829(0x28b)]+'</h5>'+_0x475829(0x1da)+_0x475829(0x1da)+_0x475829(0x230)};_0x2958a9['sendMail'](_0x56007c,function(_0x1a3244,_0x3c2ecb){var _0x57c9cf=_0x475829;_0x1a3244?(console[_0x57c9cf(0x218)](_0x1a3244),console[_0x57c9cf(0x218)]('Error\x20Occurs')):console[_0x57c9cf(0x218)](_0x57c9cf(0x2ab));}),_0x485abb[_0x475829(0x1d8)]('success','adjustment\x20Finalized\x20successfully'),_0x2ea244[_0x475829(0x29a)]('/picking_list/PDF_adjustment_rm/'+_0x3ee5ed['_id']);}catch(_0x999f7b){console[_0x475829(0x255)](_0x999f7b),_0x2ea244[_0x475829(0x22e)](0x1f4)['json']({'error':_0x475829(0x29b)});}})[_0x23054f(0x271)](_0x2414f6=>{var _0x2f6ae0=_0x23054f;console[_0x2f6ae0(0x255)](_0x2414f6),_0x2ea244['status'](0x1f4)[_0x2f6ae0(0x25b)]({'error':'An\x20error\x20occurred.'});});}catch(_0x80908d){console[_0x23054f(0x218)](_0x80908d),_0x2ea244[_0x23054f(0x22e)](0xc8)[_0x23054f(0x25b)]({'message':_0x80908d[_0x23054f(0x262)]});}}),router[a0_0x2cd596(0x1f4)](a0_0x2cd596(0x21a),auth,async(_0x9e372c,_0x2661be)=>{var _0x33fe2d=a0_0x2cd596;try{const {username:_0x2b11e4,email:_0x3e47c1,role:_0x59eb1d}=_0x9e372c[_0x33fe2d(0x1e7)],_0x206e40=_0x9e372c[_0x33fe2d(0x1e7)],_0x20abdc=await profile[_0x33fe2d(0x26b)]({'email':_0x206e40[_0x33fe2d(0x25d)]}),_0x4ee82b=await master_shop[_0x33fe2d(0x267)](),_0x4e6c89=_0x9e372c[_0x33fe2d(0x206)]['id'],_0x32d97c=await adjustment['findById']({'_id':_0x4e6c89}),_0x2dd869=await purchases[_0x33fe2d(0x279)]([{'$match':{'warehouse_name':_0x32d97c['warehouse_name']}},{'$unwind':_0x33fe2d(0x249)},{'$group':{'_id':_0x33fe2d(0x200)}}]),_0x4a8035=await product['find']({}),_0x225cb7=await warehouse[_0x33fe2d(0x279)]([{'$match':{'name':_0x32d97c['warehouse_name']}},{'$unwind':_0x33fe2d(0x244)},{'$group':{'_id':_0x33fe2d(0x20d),'name':{'$first':_0x33fe2d(0x211)},'product_stock':{'$first':_0x33fe2d(0x231)},'bay':{'$first':_0x33fe2d(0x275)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x33fe2d(0x25f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x33fe2d(0x24f)},'product_code':{'$first':_0x33fe2d(0x27a)},'storage':{'$first':_0x33fe2d(0x2a5)},'rack':{'$first':_0x33fe2d(0x237)},'maxPerUnit':{'$first':_0x33fe2d(0x236)},'expiry_date':{'$first':_0x33fe2d(0x266)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x33fe2d(0x1f1)},'room':{'$first':_0x33fe2d(0x252)}}}]);let _0x2571f4;if(_0x206e40[_0x33fe2d(0x220)]==_0x33fe2d(0x299)){const _0x55d1fc=await staff[_0x33fe2d(0x26b)]({'email':_0x206e40[_0x33fe2d(0x25d)]});_0x2571f4=await warehouse[_0x33fe2d(0x279)]([{'$match':{'status':_0x33fe2d(0x282),'name':_0x55d1fc[_0x33fe2d(0x1df)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x33fe2d(0x22c)}}}]);}else _0x2571f4=await warehouse['aggregate']([{'$match':{'status':_0x33fe2d(0x282),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x33fe2d(0x243)}}},{'$group':{'_id':_0x33fe2d(0x22c),'name':{'$first':_0x33fe2d(0x22c)}}}]);if(_0x4ee82b[0x0][_0x33fe2d(0x254)]=='English\x20(US)'){var _0x4de247=users[_0x33fe2d(0x1f5)];console['log'](_0x4de247);}else{if(_0x4ee82b[0x0][_0x33fe2d(0x254)]==_0x33fe2d(0x245))var _0x4de247=users['Hindi'];else{if(_0x4ee82b[0x0]['language']==_0x33fe2d(0x20b))var _0x4de247=users[_0x33fe2d(0x20b)];else{if(_0x4ee82b[0x0]['language']==_0x33fe2d(0x264))var _0x4de247=users[_0x33fe2d(0x264)];else{if(_0x4ee82b[0x0][_0x33fe2d(0x254)]==_0x33fe2d(0x260))var _0x4de247=users[_0x33fe2d(0x260)];else{if(_0x4ee82b[0x0][_0x33fe2d(0x254)]==_0x33fe2d(0x21e))var _0x4de247=users[_0x33fe2d(0x1de)];else{if(_0x4ee82b[0x0][_0x33fe2d(0x254)]==_0x33fe2d(0x29c))var _0x4de247=users[_0x33fe2d(0x29c)];else{if(_0x4ee82b[0x0][_0x33fe2d(0x254)]==_0x33fe2d(0x201))var _0x4de247=users[_0x33fe2d(0x229)];}}}}}}}_0x2661be['render'](_0x33fe2d(0x259),{'success':_0x9e372c[_0x33fe2d(0x1d8)](_0x33fe2d(0x222)),'errors':_0x9e372c[_0x33fe2d(0x1d8)](_0x33fe2d(0x224)),'role':_0x206e40,'profile':_0x20abdc,'adjustment':_0x32d97c,'stock':_0x225cb7,'master_shop':_0x4ee82b,'warehouse_name':_0x2dd869,'unit':_0x4a8035,'language':_0x4de247,'warehouse':_0x2571f4});}catch(_0x37cce0){console[_0x33fe2d(0x218)](_0x37cce0),_0x2661be['status'](0xc8)['json']({'message':_0x37cce0[_0x33fe2d(0x262)]});}}),router['post']('/view/:id',auth,async(_0x532f61,_0xe3f8af)=>{var _0x1d4aeb=a0_0x2cd596;try{const _0x29b037=_0x532f61[_0x1d4aeb(0x206)]['id'],_0xf0040e=await adjustment[_0x1d4aeb(0x213)]({'_id':_0x29b037}),_0x18fdd2=await warehouse[_0x1d4aeb(0x26b)]({'name':_0xf0040e[_0x1d4aeb(0x281)],'room':_0xf0040e[_0x1d4aeb(0x21f)]}),{warehouse_name:_0x9897b5,date:_0x5b3d62,prod_name:_0x558f26,level:_0x4e2a55,isle:_0x47d2e2,pallet:_0x357b43,stock:_0x1d093d,types:_0x46610e,adjust_qty:_0xe38792,new_adjust_qty:_0x2649a5,note:_0x4a2ae3,Room_name:_0x4cd003,invoice:_0x4bf9a5,JO_number:_0x134136,expiry_date:_0x728f42}=_0x532f61['body'];if(typeof _0x558f26=='string')var _0x459d5c=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x298)]],_0x373724=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x274)]],_0x1df211=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x1ff)]],_0x3ff5c6=[_0x532f61[_0x1d4aeb(0x1dc)]['types']],_0x25be14=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x1f8)]],_0x1465e7=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x1e4)]],_0x272463=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x2b2)]],_0xfc0330=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x292)]],_0x100b0f=[_0x532f61['body'][_0x1d4aeb(0x290)]],_0x2577a7=[_0x532f61[_0x1d4aeb(0x1dc)]['batch_code']],_0x2561e6=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x239)]],_0x3fccdd=[_0x532f61['body']['max_per_unit']],_0x4cb6ba=[_0x532f61[_0x1d4aeb(0x1dc)]['production_date']],_0x48a8ea=[_0x532f61['body'][_0x1d4aeb(0x20e)]],_0x5d8d09=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x214)]],_0x361232=[_0x532f61['body'][_0x1d4aeb(0x2b3)]],_0x4bbacd=[_0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x2a4)]];else var _0x459d5c=[..._0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x298)]],_0x373724=[..._0x532f61['body'][_0x1d4aeb(0x274)]],_0x1df211=[..._0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x1ff)]],_0x3ff5c6=[..._0x532f61['body'][_0x1d4aeb(0x284)]],_0x25be14=[..._0x532f61['body'][_0x1d4aeb(0x1f8)]],_0x1465e7=[..._0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x1e4)]],_0x272463=[..._0x532f61[_0x1d4aeb(0x1dc)]['unit']],_0xfc0330=[..._0x532f61[_0x1d4aeb(0x1dc)]['Secondary_units']],_0x100b0f=[..._0x532f61[_0x1d4aeb(0x1dc)]['prod_code']],_0x2577a7=[..._0x532f61['body'][_0x1d4aeb(0x1d7)]],_0x2561e6=[..._0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x239)]],_0x3fccdd=[..._0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x1f9)]],_0x4cb6ba=[..._0x532f61[_0x1d4aeb(0x1dc)]['production_date']],_0x48a8ea=[..._0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x20e)]],_0x5d8d09=[..._0x532f61[_0x1d4aeb(0x1dc)]['Rooms']],_0x361232=[..._0x532f61[_0x1d4aeb(0x1dc)][_0x1d4aeb(0x2b3)]],_0x4bbacd=[..._0x532f61['body'][_0x1d4aeb(0x2a4)]];const _0x63a388=_0x459d5c[_0x1d4aeb(0x240)](_0x2139ef=>{return _0x2139ef={'product_name':_0x2139ef};});_0x373724[_0x1d4aeb(0x287)]((_0x2c7b1e,_0x300da8)=>{var _0x510637=_0x1d4aeb;_0x5d8d09[_0x510637(0x287)]((_0x51212f,_0x2512a5)=>{var _0x3bdb57=_0x510637;if(_0x51212f==_0x3bdb57(0x241)&&_0x300da8==_0x2512a5){var _0x28c63e=_0x2c7b1e[_0x3bdb57(0x293)](0x3);_0x63a388[_0x300da8]['storage']=_0x2c7b1e[0x0],_0x63a388[_0x300da8][_0x3bdb57(0x24c)]=_0x2c7b1e[0x1],_0x63a388[_0x300da8][_0x3bdb57(0x221)]=0x0,_0x63a388[_0x300da8][_0x3bdb57(0x2a9)]=0x0,_0x63a388[_0x300da8][_0x3bdb57(0x265)]=_0x3bdb57(0x1d9),_0x63a388[_0x300da8]['floorlevel']=_0x28c63e;}else{if(_0x51212f=='Shelves'&&_0x300da8==_0x2512a5){var _0x28c63e=_0x2c7b1e[_0x3bdb57(0x293)](0x3);_0x63a388[_0x300da8][_0x3bdb57(0x273)]=_0x2c7b1e[0x0],_0x63a388[_0x300da8]['rack']=_0x2c7b1e[0x1],_0x63a388[_0x300da8][_0x3bdb57(0x221)]=0x0,_0x63a388[_0x300da8]['bin']=0x0,_0x63a388[_0x300da8][_0x3bdb57(0x265)]=_0x3bdb57(0x1d9),_0x63a388[_0x300da8][_0x3bdb57(0x296)]=_0x2c7b1e[0x5];}else{if(_0x300da8==_0x2512a5){var _0x11fe4f;if(_0x2c7b1e[0x4]=='L')_0x11fe4f='Level';else _0x2c7b1e[0x4]=='F'&&(_0x11fe4f=_0x3bdb57(0x1d9));_0x63a388[_0x300da8][_0x3bdb57(0x273)]=_0x2c7b1e[0x0],_0x63a388[_0x300da8][_0x3bdb57(0x24c)]=_0x2c7b1e[0x1],_0x63a388[_0x300da8][_0x3bdb57(0x221)]=_0x2c7b1e[0x2],_0x63a388[_0x300da8][_0x3bdb57(0x2a9)]=_0x2c7b1e[0x3],_0x63a388[_0x300da8]['type']=_0x11fe4f,_0x63a388[_0x300da8][_0x3bdb57(0x296)]=_0x2c7b1e[0x5];}}}});}),_0x1df211[_0x1d4aeb(0x287)]((_0x33a8f1,_0x5301f8)=>{var _0x50b155=_0x1d4aeb;_0x63a388[_0x5301f8][_0x50b155(0x246)]=_0x33a8f1;}),_0x3ff5c6[_0x1d4aeb(0x287)]((_0x4cf7c4,_0x137539)=>{var _0x41e786=_0x1d4aeb;_0x63a388[_0x137539][_0x41e786(0x284)]=_0x4cf7c4;}),_0x25be14[_0x1d4aeb(0x287)]((_0x562f9d,_0x8c87a3)=>{var _0x38d0e7=_0x1d4aeb;_0x63a388[_0x8c87a3][_0x38d0e7(0x2b1)]=_0x562f9d;}),_0x1465e7['forEach']((_0x599690,_0x3214eb)=>{var _0x31e6e7=_0x1d4aeb;_0x63a388[_0x3214eb][_0x31e6e7(0x289)]=_0x599690;}),_0x272463[_0x1d4aeb(0x287)]((_0x4e6f5e,_0x41911f)=>{var _0x2e1186=_0x1d4aeb;_0x63a388[_0x41911f][_0x2e1186(0x247)]=_0x4e6f5e;}),_0xfc0330[_0x1d4aeb(0x287)]((_0x269561,_0x116f0d)=>{_0x63a388[_0x116f0d]['secondary_unit']=_0x269561;}),_0x100b0f['forEach']((_0x5e376b,_0x50d110)=>{var _0x1a6709=_0x1d4aeb;_0x63a388[_0x50d110][_0x1a6709(0x2a1)]=_0x5e376b;}),_0x2577a7[_0x1d4aeb(0x287)]((_0x3bcce0,_0x54327c)=>{var _0x11b1a5=_0x1d4aeb;_0x63a388[_0x54327c][_0x11b1a5(0x1d7)]=_0x3bcce0;}),_0x2561e6[_0x1d4aeb(0x287)]((_0x112950,_0x212624)=>{var _0xa487d5=_0x1d4aeb;_0x63a388[_0x212624][_0xa487d5(0x239)]=_0x112950;}),_0x3fccdd[_0x1d4aeb(0x287)]((_0xf8bee0,_0x4972f3)=>{var _0x204263=_0x1d4aeb;_0x63a388[_0x4972f3][_0x204263(0x294)]=_0xf8bee0;}),_0x4cb6ba['forEach']((_0x4d63fe,_0x22b973)=>{_0x63a388[_0x22b973]['production_date']=_0x4d63fe;}),_0x48a8ea[_0x1d4aeb(0x287)]((_0x23e75e,_0x19629d)=>{var _0x101a2f=_0x1d4aeb;_0x63a388[_0x19629d][_0x101a2f(0x20e)]=_0x23e75e;}),_0x5d8d09[_0x1d4aeb(0x287)]((_0x2499a6,_0x23f558)=>{var _0x550696=_0x1d4aeb;_0x63a388[_0x23f558][_0x550696(0x20f)]=_0x2499a6;}),_0x361232[_0x1d4aeb(0x287)]((_0xbf02b,_0x367f16)=>{var _0x59b26e=_0x1d4aeb;_0x63a388[_0x367f16][_0x59b26e(0x26a)]=_0xbf02b;}),_0x4bbacd[_0x1d4aeb(0x287)]((_0xf86834,_0x2c4f16)=>{var _0x39e105=_0x1d4aeb;_0x63a388[_0x2c4f16][_0x39e105(0x1db)]=_0xf86834;});const _0x3f88f3=_0x63a388[_0x1d4aeb(0x1ed)](_0x6eb2f7=>_0x6eb2f7['adjust_qty']!=='0'&&_0x6eb2f7[_0x1d4aeb(0x2b1)]!=='');var _0x778357=0x0;_0x3f88f3['forEach'](_0x1f6f7a=>{var _0x3e6589=_0x1d4aeb;console['log']('foreach\x20newproduct',_0x1f6f7a),parseInt(_0x1f6f7a[_0x3e6589(0x2b1)])<=0x0&&_0x778357++;});if(_0x778357!=0x0)return _0x532f61[_0x1d4aeb(0x1d8)](_0x1d4aeb(0x224),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0xe3f8af[_0x1d4aeb(0x29a)](_0x1d4aeb(0x1f6));_0xf0040e[_0x1d4aeb(0x281)]=_0x9897b5,_0xf0040e['date']=_0x5b3d62,_0xf0040e['product']=_0x3f88f3,_0xf0040e[_0x1d4aeb(0x209)]=_0x4a2ae3,_0xf0040e[_0x1d4aeb(0x2a7)]=_0x4bf9a5,_0xf0040e['isAllowEdit']=_0x1d4aeb(0x295);const _0x53faec=await _0xf0040e[_0x1d4aeb(0x235)]();_0x532f61[_0x1d4aeb(0x1d8)](_0x1d4aeb(0x222),_0x1d4aeb(0x26d)),_0xe3f8af[_0x1d4aeb(0x29a)](_0x1d4aeb(0x233));}catch(_0xd3830a){console[_0x1d4aeb(0x218)](_0xd3830a);}}),router['post'](a0_0x2cd596(0x210),async(_0x45e89c,_0x2e8ad1)=>{var _0x4bc1a9=a0_0x2cd596;const {primary_code:_0xee0c32,warehouse_data:_0x217f3e,rooms_data:_0x1c0aa0,Roomslist:_0x20e375}=_0x45e89c[_0x4bc1a9(0x1dc)],_0x7d9228=_0x20e375[_0x4bc1a9(0x242)](','),_0x194235=[];async function _0x45ba7f(_0x1cf398){var _0xf3b260=_0x4bc1a9;const _0x565a07=await warehouse[_0xf3b260(0x279)]([{'$match':{'name':_0x217f3e,'room':_0x1cf398}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0xee0c32}},{'$group':{'_id':_0xf3b260(0x20d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xf3b260(0x231)},'primary_code':{'$first':_0xf3b260(0x26f)},'secondary_code':{'$first':_0xf3b260(0x24f)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xf3b260(0x24a)},'pallet':{'$first':_0xf3b260(0x25f)},'unit':{'$first':_0xf3b260(0x2aa)},'secondary_unit':{'$first':_0xf3b260(0x276)},'storage':{'$first':_0xf3b260(0x2a5)},'rack':{'$first':_0xf3b260(0x237)},'expiry_date':{'$first':_0xf3b260(0x266)},'production_date':{'$first':_0xf3b260(0x1e0)},'maxPerUnit':{'$first':_0xf3b260(0x236)},'batch_code':{'$first':_0xf3b260(0x1f1)},'product_cat':{'$first':_0xf3b260(0x238)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0xf3b260(0x252)}}}]),_0xb496f2=await warehouse[_0xf3b260(0x279)]([{'$match':{'name':_0x217f3e,'room':_0x1cf398}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0xee0c32}},{'$group':{'_id':_0xf3b260(0x20d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xf3b260(0x231)},'primary_code':{'$first':_0xf3b260(0x26f)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xf3b260(0x27a)},'level':{'$first':_0xf3b260(0x275)},'isle':{'$first':_0xf3b260(0x27e)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0xf3b260(0x25f)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xf3b260(0x2a5)},'rack':{'$first':_0xf3b260(0x237)},'expiry_date':{'$first':_0xf3b260(0x266)},'production_date':{'$first':_0xf3b260(0x1e0)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0xf3b260(0x1f1)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0xf3b260(0x252)}}}]);if(_0x565a07[_0xf3b260(0x232)]>0x0)_0x194235[_0xf3b260(0x2af)](_0x565a07);else _0xb496f2[_0xf3b260(0x232)]>0x0&&_0x194235[_0xf3b260(0x2af)](_0xb496f2);}const _0x10245a=_0x7d9228[_0x4bc1a9(0x240)](_0x2c8996=>_0x45ba7f(_0x2c8996));await Promise[_0x4bc1a9(0x29d)](_0x10245a),_0x2e8ad1['json'](_0x194235);}),router[a0_0x2cd596(0x1fc)](a0_0x2cd596(0x1fd),async(_0x3e6dbd,_0x55159b)=>{var _0x360f6d=a0_0x2cd596;const {primaryCode:_0x3b81a3,secondaryCode:_0x5e4e55,productCode:_0x317326,level:_0x243b04,isle:_0x1a079f,pallet:_0x3653aa,warehouses:_0x5081b5,room:_0x5c4ae0}=_0x3e6dbd['body'];try{const _0x53f6b3=await warehouse[_0x360f6d(0x279)]([{'$match':{'name':_0x5081b5,'room':_0x5c4ae0}},{'$unwind':_0x360f6d(0x244)},{'$match':{'product_details.level':parseInt(_0x243b04),'product_details.isle':_0x1a079f,'product_details.pallet':parseInt(_0x3653aa)}},{'$group':{'_id':_0x360f6d(0x20d),'name':{'$first':_0x360f6d(0x211)},'product_stock':{'$first':_0x360f6d(0x231)},'level':{'$first':_0x360f6d(0x1dd)},'isle':{'$first':_0x360f6d(0x272)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x360f6d(0x202)}}}]);_0x55159b[_0x360f6d(0x22e)](0xc8)[_0x360f6d(0x25b)](_0x53f6b3);}catch(_0x32beb9){_0x55159b[_0x360f6d(0x22e)](0x194)[_0x360f6d(0x25b)]({'message':_0x32beb9[_0x360f6d(0x262)]});}}),module[a0_0x2cd596(0x23b)]=router;