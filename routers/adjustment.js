var a0_0xc61750=a0_0x4cd5;(function(_0x4a810e,_0x803a2f){var _0xc4fbbd=a0_0x4cd5,_0x84a391=_0x4a810e();while(!![]){try{var _0x36c854=parseInt(_0xc4fbbd(0x106))/0x1*(parseInt(_0xc4fbbd(0xdc))/0x2)+-parseInt(_0xc4fbbd(0xb6))/0x3*(parseInt(_0xc4fbbd(0xd3))/0x4)+parseInt(_0xc4fbbd(0xa2))/0x5+-parseInt(_0xc4fbbd(0x152))/0x6*(parseInt(_0xc4fbbd(0x167))/0x7)+parseInt(_0xc4fbbd(0x13e))/0x8+parseInt(_0xc4fbbd(0xd8))/0x9+-parseInt(_0xc4fbbd(0x12c))/0xa;if(_0x36c854===_0x803a2f)break;else _0x84a391['push'](_0x84a391['shift']());}catch(_0x25f399){_0x84a391['push'](_0x84a391['shift']());}}}(a0_0x1569,0x81fe5));const express=require(a0_0xc61750(0xa8)),app=express(),router=express[a0_0xc61750(0x103)](),auth=require(a0_0xc61750(0xe5)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xc61750(0x11f)),users=require(a0_0xc61750(0xbf)),nodemailer=require(a0_0xc61750(0xd1));router[a0_0xc61750(0x16d)]('/view',auth,async(_0x471b80,_0x173ff7)=>{var _0x931f71=a0_0xc61750;try{const {username:_0x25261f,email:_0x5f1ef4,role:_0x1f4dde}=_0x471b80[_0x931f71(0x154)],_0x580cd8=_0x471b80[_0x931f71(0x154)],_0x5f4c25=await profile['findOne']({'email':_0x580cd8[_0x931f71(0x101)]}),_0x4a26fb=await master_shop[_0x931f71(0xe0)]();console[_0x931f71(0xcd)]('master',_0x4a26fb);let _0x474ef1;if(_0x580cd8[_0x931f71(0xcb)]==_0x931f71(0xc0)){const _0x4a3dea=await staff[_0x931f71(0x11a)]({'email':_0x580cd8[_0x931f71(0x101)]});_0x474ef1=await warehouse[_0x931f71(0xe0)]({'status':'Enabled','name':_0x4a3dea[_0x931f71(0x15e)]});}else _0x474ef1=await warehouse[_0x931f71(0xe0)]({'status':'Enabled'});const _0x1cf7f9=await product[_0x931f71(0xe0)]();let _0xf7423f;if(_0x580cd8[_0x931f71(0xcb)]==_0x931f71(0xc0)){const _0x9e5508=await staff['findOne']({'email':_0x580cd8[_0x931f71(0x101)]});_0xf7423f=await adjustment[_0x931f71(0xe0)]({'warehouse_name':_0x9e5508[_0x931f71(0x15e)]});}else _0xf7423f=await adjustment[_0x931f71(0x137)]([{'$unwind':'$product'},{'$group':{'_id':_0x931f71(0x163),'invoice':{'$first':_0x931f71(0x107)},'date':{'$first':_0x931f71(0x153)},'warehouse_name':{'$first':_0x931f71(0xa3)},'room':{'$addToSet':_0x931f71(0xba)},'finalize':{'$first':_0x931f71(0x12d)},'isAllowEdit':{'$first':_0x931f71(0xf0)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4a26fb[0x0][_0x931f71(0xe2)]==_0x931f71(0x12f)){var _0x2f41cf=users[_0x931f71(0xa6)];console['log'](_0x2f41cf);}else{if(_0x4a26fb[0x0][_0x931f71(0xe2)]=='Hindi')var _0x2f41cf=users['Hindi'];else{if(_0x4a26fb[0x0][_0x931f71(0xe2)]==_0x931f71(0x14a))var _0x2f41cf=users[_0x931f71(0x14a)];else{if(_0x4a26fb[0x0][_0x931f71(0xe2)]==_0x931f71(0x159))var _0x2f41cf=users['Spanish'];else{if(_0x4a26fb[0x0][_0x931f71(0xe2)]=='French')var _0x2f41cf=users[_0x931f71(0x168)];else{if(_0x4a26fb[0x0]['language']==_0x931f71(0xaf))var _0x2f41cf=users[_0x931f71(0x11b)];else{if(_0x4a26fb[0x0][_0x931f71(0xe2)]==_0x931f71(0xfd))var _0x2f41cf=users[_0x931f71(0xfd)];else{if(_0x4a26fb[0x0][_0x931f71(0xe2)]==_0x931f71(0xb9))var _0x2f41cf=users[_0x931f71(0xad)];}}}}}}}_0x173ff7[_0x931f71(0x13a)]('adjustment',{'success':_0x471b80[_0x931f71(0xf2)](_0x931f71(0x161)),'errors':_0x471b80[_0x931f71(0xf2)](_0x931f71(0xd0)),'role':_0x580cd8,'profile':_0x5f4c25,'warehouse':_0x474ef1,'product':_0x1cf7f9,'adjustment':_0xf7423f,'master_shop':_0x4a26fb,'language':_0x2f41cf});}catch(_0xa2321f){console[_0x931f71(0xcd)](_0xa2321f);}});async function getRandom8DigitNumber(){var _0x1bac1f=a0_0xc61750;const _0x3a5959=0x989680,_0x2a2059=0x5f5e0ff,_0x3de306=Math['floor'](Math['random']()*(_0x2a2059-_0x3a5959+0x1))+_0x3a5959;var _0x349577;const _0x43e0ce=await adjustment[_0x1bac1f(0x11a)]({'invoice':_0x1bac1f(0xf9)+_0x3de306});return _0x43e0ce&&_0x43e0ce['length']>0x0?_0x349577=_0x1bac1f(0xf9)+_0x3de306:_0x349577=_0x1bac1f(0xf9)+_0x3de306,_0x349577;}function a0_0x4cd5(_0x5bc26c,_0x1a5115){var _0x15696c=a0_0x1569();return a0_0x4cd5=function(_0x4cd52f,_0x547987){_0x4cd52f=_0x4cd52f-0xa2;var _0x4ad1a6=_0x15696c[_0x4cd52f];return _0x4ad1a6;},a0_0x4cd5(_0x5bc26c,_0x1a5115);}function a0_0x1569(){var _0x41e31b=['</table>','$product_details.rack','success','then','$_id','save','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','70UxROmr','French','prime1','New_Qty_Converted','prod_invoice','Return\x20Goods','get','</body></html>','redirect','$product_details.bay','/view/add_adjustment','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.storage','3966390KVPrzq','$warehouse_name','primary_code','prod_code','English','site_title','express','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</head><body>','stockBefore','/preview/:id','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Portuguese\x20(BR)','$product_details','Enabled','product_stock','port','slice','length','287826vCXNXR','/adjustment/view','all','Arabic\x20(ae)','$product.room_names','/view/:id','$room','\x20<>\x20','/adjustment/preview/','../public/language/languages.json','staff','createTransport','host','False','<strong>\x20Regards\x20</strong>','$product.product_name','status','Receiving\x20Area','unit','id_transaction','\x20Order\x20Number\x20:\x20','role','new_adjust_qty','log','logo','$product_details.secondary_unit','errors','nodemailer','room','4rkboya','$name','$product_details.product_cat','isAllowEdit','product_code','4969710xSJDSG','$product_details.production_date','$product_details.product_name','maxperunit','4GBERua','bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','error','find','product_name','language','adjustment\x20data\x20update\x20successfully','Secondary_units','../middleware/auth','$product_details.primary_code','Logo.png','batch_code','post','<!DOCTYPE\x20html>','storage','catch','<html><head><title></title>','second1','Hindi','$isAllowEdit','/picking_list/PDF_adjustment_rm/','flash','Level','$product_details.product_stock','findById','/CheckingWarehouse','$product_details.product_code','</div>','ADJ-','secondary_unit','<h5>','$product_details.invoice','Chinese','date','sendMail','$product_details.expiry_date','email','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Router','<tbody\x20style=\x22text-align:\x20center;\x22>','level','422237bncXJg','$invoice','push','product','forEach','$product_details.maxPerUnit','finalize','$product_details.floorlevel','\x20Order\x20Date\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','</tr>','$product_details._id','An\x20error\x20occurred.','production_date','stock','max_per_unit','json','rack','id_transaction_from','adjustment\x20add\x20successfull','findOne','Portuguese','params','$product_details.bin','Error\x20Occurs','../models/all_models','image','add_adjustment','Adjustment\x20Mail','split','room_names','<tr>','$product_details.unit','adjust_qty','floorlevel','<h2>\x20','$product_details.type','$product_details.isle','17373580bfkcpx','$finalize','Rooms','English\x20(US)','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Primary_Units','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','foreach\x20newproduct','<div>','exports','map','aggregate','$product_details.maxProducts','warehouse_name','render','prod_name','secondary_code','filter','2164488pYMxXw','types','RMSEmail','back','$product_details.batch_code','prod_cat','type','Shelves','\x20</h2>','</h5>','$product_details.secondary_code','</td>','German','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Raw\x20Materials','message','minus','New_Qty_Converted_adj','An\x20error\x20occurred\x20while\x20saving\x20data.','56850awNSaJ','$date','user','body','string','adjustment\x20Finalized\x20successfully','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Spanish','invoice','_id','note','expiry_date','warehouse'];a0_0x1569=function(){return _0x41e31b;};return a0_0x1569();}router[a0_0xc61750(0x16d)](a0_0xc61750(0x171),auth,async(_0x4295aa,_0xd047a7)=>{var _0x1b909c=a0_0xc61750;try{const {username:_0x319f97,email:_0x31c1ef,role:_0x1e6b98}=_0x4295aa[_0x1b909c(0x154)],_0x5e3d2c=_0x4295aa['user'],_0x5d1235=await profile[_0x1b909c(0x11a)]({'email':_0x5e3d2c[_0x1b909c(0x101)]}),_0x1185b5=await master_shop[_0x1b909c(0xe0)]();let _0x44e959;if(_0x5e3d2c['role']==_0x1b909c(0xc0)){const _0x362db8=await staff[_0x1b909c(0x11a)]({'email':_0x5e3d2c[_0x1b909c(0x101)]});_0x44e959=await warehouse[_0x1b909c(0x137)]([{'$match':{'status':_0x1b909c(0xb1),'name':_0x362db8[_0x1b909c(0x15e)],'warehouse_category':_0x1b909c(0x14d),'name':{'$ne':_0x1b909c(0x16c)}}},{'$group':{'_id':_0x1b909c(0xd4),'name':{'$first':_0x1b909c(0xd4)}}}]);}else _0x44e959=await warehouse[_0x1b909c(0x137)]([{'$match':{'status':'Enabled','warehouse_category':_0x1b909c(0x14d),'name':{'$ne':_0x1b909c(0x16c)}}},{'$group':{'_id':_0x1b909c(0xd4),'name':{'$first':'$name'}}}]);const _0x1375a4=await product[_0x1b909c(0xe0)]({}),_0x16d5b6=await adjustment[_0x1b909c(0xe0)]({}),_0x26e395=_0x16d5b6[_0x1b909c(0xb5)]+0x1,_0x4b7b94=_0x1b909c(0xf9)+_0x26e395['toString']()['padStart'](0x5,'0');var _0x5906c5=['Ambient','Enclosed','Return\x20Rooms'];if(_0x1185b5[0x0][_0x1b909c(0xe2)]=='English\x20(US)')var _0x5f5805=users[_0x1b909c(0xa6)];else{if(_0x1185b5[0x0][_0x1b909c(0xe2)]==_0x1b909c(0xef))var _0x5f5805=users['Hindi'];else{if(_0x1185b5[0x0]['language']==_0x1b909c(0x14a))var _0x5f5805=users[_0x1b909c(0x14a)];else{if(_0x1185b5[0x0][_0x1b909c(0xe2)]==_0x1b909c(0x159))var _0x5f5805=users[_0x1b909c(0x159)];else{if(_0x1185b5[0x0][_0x1b909c(0xe2)]==_0x1b909c(0x168))var _0x5f5805=users[_0x1b909c(0x168)];else{if(_0x1185b5[0x0][_0x1b909c(0xe2)]=='Portuguese\x20(BR)')var _0x5f5805=users[_0x1b909c(0x11b)];else{if(_0x1185b5[0x0][_0x1b909c(0xe2)]==_0x1b909c(0xfd))var _0x5f5805=users['Chinese'];else{if(_0x1185b5[0x0][_0x1b909c(0xe2)]==_0x1b909c(0xb9))var _0x5f5805=users['Arabic'];}}}}}}}const _0x4cc944=getRandom8DigitNumber();_0x4cc944[_0x1b909c(0x162)](_0x243977=>{var _0x345ab8=_0x1b909c;_0xd047a7[_0x345ab8(0x13a)](_0x345ab8(0x121),{'success':_0x4295aa['flash']('success'),'errors':_0x4295aa[_0x345ab8(0xf2)](_0x345ab8(0xd0)),'role':_0x5e3d2c,'profile':_0x5d1235,'warehouse':_0x44e959,'product':_0x1375a4,'master_shop':_0x1185b5,'language':_0x5f5805,'rooms_data':_0x5906c5,'invoice_no':_0x243977});})['catch'](_0x1c0f70=>{var _0x15d9a6=_0x1b909c;_0x4295aa[_0x15d9a6(0xf2)]('errors',_0x15d9a6(0x172)),_0xd047a7['redirect'](_0x15d9a6(0xb7));});}catch(_0x300635){console['log'](_0x300635);}}),router['post'](a0_0xc61750(0x171),auth,async(_0x1e7a23,_0x22c978)=>{var _0x4e3455=a0_0xc61750;try{const {warehouse_name:_0x3051c6,date:_0x2a9067,prod_name:_0x38f206,level:_0x529544,isle:_0x404c6c,pallet:_0xe2d1e2,stock:_0x36017b,types:_0x27fe8c,adjust_qty:_0x2ea2fa,new_adjust_qty:_0x11595b,note:_0x391cc7,Room_name:_0x2901f0,invoice:_0x393924,JO_number:_0x53f43b,expiry_date:_0xa5293c}=_0x1e7a23['body'];if(typeof _0x38f206==_0x4e3455(0x156))var _0x4dd411=[_0x1e7a23['body'][_0x4e3455(0x13b)]],_0x13256b=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x105)]],_0x3393c5=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x114)]],_0x190c04=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x13f)]],_0x44298e=[_0x1e7a23[_0x4e3455(0x155)]['New_Qty_Converted_adj']],_0x371711=[_0x1e7a23['body'][_0x4e3455(0x16a)]],_0x1ce9f1=[_0x1e7a23[_0x4e3455(0x155)]['Primary_Units']],_0x37b85c=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0xe4)]],_0x3570b1=[_0x1e7a23[_0x4e3455(0x155)]['prod_code']],_0x1926f0=[_0x1e7a23['body'][_0x4e3455(0xe8)]],_0x502b35=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x15d)]],_0x1160de=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x115)]],_0x5ded04=[_0x1e7a23['body'][_0x4e3455(0x113)]],_0x5b38ac=[_0x1e7a23[_0x4e3455(0x155)]['prod_cat']],_0x177370=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x12e)]],_0x1e41e1=[_0x1e7a23['body'][_0x4e3455(0x169)]],_0x2de4d4=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0xee)]],_0x45ae54=[_0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x16b)]],_0x78b6a4=[_0x1e7a23[_0x4e3455(0x155)]['id_transaction']];else var _0x4dd411=[..._0x1e7a23[_0x4e3455(0x155)]['prod_name']],_0x13256b=[..._0x1e7a23['body'][_0x4e3455(0x105)]],_0x3393c5=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x114)]],_0x190c04=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x13f)]],_0x44298e=[..._0x1e7a23[_0x4e3455(0x155)]['New_Qty_Converted_adj']],_0x371711=[..._0x1e7a23['body'][_0x4e3455(0x16a)]],_0x1ce9f1=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0xc8)]],_0x37b85c=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0xe4)]],_0x3570b1=[..._0x1e7a23[_0x4e3455(0x155)]['prod_code']],_0x1926f0=[..._0x1e7a23['body']['batch_code']],_0x502b35=[..._0x1e7a23['body'][_0x4e3455(0x15d)]],_0x1160de=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x115)]],_0x5ded04=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x113)]],_0x5b38ac=[..._0x1e7a23[_0x4e3455(0x155)]['prod_cat']],_0x177370=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0x12e)]],_0x1e41e1=[..._0x1e7a23['body']['prime1']],_0x2de4d4=[..._0x1e7a23[_0x4e3455(0x155)][_0x4e3455(0xee)]],_0x45ae54=[..._0x1e7a23['body']['prod_invoice']],_0x78b6a4=[..._0x1e7a23['body'][_0x4e3455(0xc9)]];const _0x327f89=_0x4dd411[_0x4e3455(0x136)](_0x551624=>{return _0x551624={'product_name':_0x551624};});_0x13256b['forEach']((_0x2e729a,_0x3ec67d)=>{_0x177370['forEach']((_0x124d5d,_0x2a5c9e)=>{var _0x4706d9=a0_0x4cd5;if(_0x124d5d==_0x4706d9(0xc7)&&_0x3ec67d==_0x2a5c9e){var _0x87a24b=_0x2e729a[_0x4706d9(0xb4)](0x3);_0x327f89[_0x3ec67d][_0x4706d9(0xeb)]=_0x2e729a[0x0],_0x327f89[_0x3ec67d][_0x4706d9(0x117)]=_0x2e729a[0x1],_0x327f89[_0x3ec67d][_0x4706d9(0x14b)]=0x0,_0x327f89[_0x3ec67d][_0x4706d9(0xdd)]=0x0,_0x327f89[_0x3ec67d]['type']=_0x4706d9(0x165),_0x327f89[_0x3ec67d][_0x4706d9(0x128)]=_0x87a24b;}else{if(_0x124d5d==_0x4706d9(0x145)&&_0x3ec67d==_0x2a5c9e){var _0x87a24b=_0x2e729a[_0x4706d9(0xb4)](0x3);_0x327f89[_0x3ec67d][_0x4706d9(0xeb)]=_0x2e729a[0x0],_0x327f89[_0x3ec67d]['rack']=_0x2e729a[0x1],_0x327f89[_0x3ec67d][_0x4706d9(0x14b)]=0x0,_0x327f89[_0x3ec67d][_0x4706d9(0xdd)]=0x0,_0x327f89[_0x3ec67d]['type']='Floor',_0x327f89[_0x3ec67d]['floorlevel']=_0x2e729a[0x5];}else{if(_0x3ec67d==_0x2a5c9e){var _0x3f38af;if(_0x2e729a[0x4]=='L')_0x3f38af='Level';else _0x2e729a[0x4]=='F'&&(_0x3f38af='Floor');_0x327f89[_0x3ec67d][_0x4706d9(0xeb)]=_0x2e729a[0x0],_0x327f89[_0x3ec67d]['rack']=_0x2e729a[0x1],_0x327f89[_0x3ec67d][_0x4706d9(0x14b)]=_0x2e729a[0x2],_0x327f89[_0x3ec67d][_0x4706d9(0xdd)]=_0x2e729a[0x3],_0x327f89[_0x3ec67d]['type']=_0x3f38af,_0x327f89[_0x3ec67d][_0x4706d9(0x128)]=_0x2e729a[0x5];}}}});}),_0x3393c5[_0x4e3455(0x10a)]((_0x201d24,_0x482480)=>{var _0xf63537=_0x4e3455;_0x327f89[_0x482480][_0xf63537(0xab)]=_0x201d24;}),_0x78b6a4[_0x4e3455(0x10a)]((_0x5d7704,_0x430696)=>{var _0x3f1b3f=_0x4e3455;_0x327f89[_0x430696][_0x3f1b3f(0x118)]=_0x5d7704;}),_0x190c04[_0x4e3455(0x10a)]((_0xf109c4,_0x1b7a9b)=>{_0x327f89[_0x1b7a9b]['types']=_0xf109c4;}),_0x44298e['forEach']((_0x5e5093,_0x5a2301)=>{var _0x13461e=_0x4e3455;_0x327f89[_0x5a2301][_0x13461e(0x127)]=_0x5e5093;}),_0x371711[_0x4e3455(0x10a)]((_0x549a88,_0x4fcd44)=>{var _0x395a24=_0x4e3455;_0x327f89[_0x4fcd44][_0x395a24(0xcc)]=_0x549a88;}),_0x1ce9f1['forEach']((_0x1e71a2,_0x29d2f7)=>{var _0x4efc1a=_0x4e3455;_0x327f89[_0x29d2f7][_0x4efc1a(0xc8)]=_0x1e71a2;}),_0x37b85c[_0x4e3455(0x10a)]((_0x4d7c87,_0x500eca)=>{var _0x24eeca=_0x4e3455;_0x327f89[_0x500eca][_0x24eeca(0xfa)]=_0x4d7c87;}),_0x3570b1[_0x4e3455(0x10a)]((_0x5a9d1b,_0x3ae47d)=>{var _0x29205f=_0x4e3455;_0x327f89[_0x3ae47d][_0x29205f(0xd7)]=_0x5a9d1b;}),_0x1926f0[_0x4e3455(0x10a)]((_0x2f0237,_0x41e309)=>{var _0x4acae0=_0x4e3455;_0x327f89[_0x41e309][_0x4acae0(0xe8)]=_0x2f0237;}),_0x502b35[_0x4e3455(0x10a)]((_0x254298,_0x48f311)=>{var _0x270e77=_0x4e3455;_0x327f89[_0x48f311][_0x270e77(0x15d)]=_0x254298;}),_0x1160de['forEach']((_0x5003ff,_0x19f654)=>{var _0x558d3e=_0x4e3455;_0x327f89[_0x19f654][_0x558d3e(0xdb)]=_0x5003ff;}),_0x5ded04[_0x4e3455(0x10a)]((_0x3ffbe5,_0x13a15d)=>{var _0x32056e=_0x4e3455;_0x327f89[_0x13a15d][_0x32056e(0x113)]=_0x3ffbe5;}),_0x5b38ac[_0x4e3455(0x10a)]((_0x2e5364,_0x16a14c)=>{var _0x1990d2=_0x4e3455;_0x327f89[_0x16a14c][_0x1990d2(0x143)]=_0x2e5364;}),_0x177370['forEach']((_0x57c5a2,_0x489e4a)=>{var _0x3576b1=_0x4e3455;_0x327f89[_0x489e4a][_0x3576b1(0x124)]=_0x57c5a2;}),_0x1e41e1[_0x4e3455(0x10a)]((_0x4317c2,_0x509bb9)=>{var _0x14bdea=_0x4e3455;_0x327f89[_0x509bb9][_0x14bdea(0xa4)]=_0x4317c2;}),_0x2de4d4[_0x4e3455(0x10a)]((_0x5ad71a,_0x3a6577)=>{var _0x8662eb=_0x4e3455;_0x327f89[_0x3a6577][_0x8662eb(0x13c)]=_0x5ad71a;}),_0x45ae54[_0x4e3455(0x10a)]((_0x2b5e1a,_0x5dbc01)=>{var _0x2e5489=_0x4e3455;_0x327f89[_0x5dbc01][_0x2e5489(0x15a)]=_0x2b5e1a;});const _0x381311=_0x327f89[_0x4e3455(0x13d)](_0x5965ce=>_0x5965ce[_0x4e3455(0x127)]!=='0'&&_0x5965ce[_0x4e3455(0x127)]!=='');var _0x26078b=0x0;_0x381311[_0x4e3455(0x10a)](_0x233c52=>{var _0x26597f=_0x4e3455;console[_0x26597f(0xcd)](_0x26597f(0x133),_0x233c52),parseInt(_0x233c52[_0x26597f(0x127)])<=0x0&&_0x26078b++;});if(_0x26078b!=0x0)return _0x1e7a23[_0x4e3455(0xf2)](_0x4e3455(0xd0),_0x4e3455(0x158)),_0x22c978[_0x4e3455(0x16f)](_0x4e3455(0x141));const _0x19a626=new adjustment({'warehouse_name':_0x3051c6,'date':_0x2a9067,'product':_0x381311,'note':_0x391cc7,'room':_0x2901f0,'invoice':_0x393924,'JO_number':_0x53f43b,'expiry_date':_0xa5293c}),_0x6ec5c5=await _0x19a626[_0x4e3455(0x164)]();_0x1e7a23[_0x4e3455(0xf2)](_0x4e3455(0x161),_0x4e3455(0x119)),_0x22c978[_0x4e3455(0x16f)](_0x4e3455(0xbe)+_0x6ec5c5[_0x4e3455(0x15b)]);}catch(_0x37218e){console[_0x4e3455(0xcd)](_0x37218e),_0x22c978['status'](0xc8)[_0x4e3455(0x116)]({'message':_0x37218e[_0x4e3455(0x14e)]});}}),router[a0_0xc61750(0x16d)](a0_0xc61750(0xac),auth,async(_0x45b17e,_0xa6ec4a)=>{var _0x425c94=a0_0xc61750;try{const {username:_0xe7aa13,email:_0x1c3012,role:_0x17585a}=_0x45b17e[_0x425c94(0x154)],_0xab8e5=_0x45b17e['user'],_0x4e5ef7=await profile[_0x425c94(0x11a)]({'email':_0xab8e5['email']}),_0x20b974=await master_shop['find'](),_0x34a47b=_0x45b17e[_0x425c94(0x11c)]['id'],_0x4a3f18=await adjustment[_0x425c94(0xf5)]({'_id':_0x34a47b}),_0x11aedf=await purchases[_0x425c94(0x137)]([{'$match':{'warehouse_name':_0x4a3f18[_0x425c94(0x139)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x4f07f5=await product['find']({}),_0x51fc1d=await warehouse[_0x425c94(0x137)]([{'$match':{'name':_0x4a3f18['warehouse_name']}},{'$unwind':_0x425c94(0xb0)},{'$group':{'_id':_0x425c94(0x111),'name':{'$first':_0x425c94(0xda)},'product_stock':{'$first':_0x425c94(0xf4)},'bay':{'$first':_0x425c94(0x170)},'bin':{'$first':_0x425c94(0x11d)},'type':{'$first':_0x425c94(0x12a)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x425c94(0xe6)},'secondary_code':{'$first':_0x425c94(0x148)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x425c94(0x173)},'rack':{'$first':_0x425c94(0x160)},'maxPerUnit':{'$first':_0x425c94(0x10b)},'expiry_date':{'$first':_0x425c94(0x100)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);if(_0x20b974[0x0]['language']=='English\x20(US)'){var _0x2f37ca=users['English'];console[_0x425c94(0xcd)](_0x2f37ca);}else{if(_0x20b974[0x0][_0x425c94(0xe2)]==_0x425c94(0xef))var _0x2f37ca=users[_0x425c94(0xef)];else{if(_0x20b974[0x0]['language']==_0x425c94(0x14a))var _0x2f37ca=users[_0x425c94(0x14a)];else{if(_0x20b974[0x0][_0x425c94(0xe2)]=='Spanish')var _0x2f37ca=users[_0x425c94(0x159)];else{if(_0x20b974[0x0][_0x425c94(0xe2)]==_0x425c94(0x168))var _0x2f37ca=users[_0x425c94(0x168)];else{if(_0x20b974[0x0][_0x425c94(0xe2)]==_0x425c94(0xaf))var _0x2f37ca=users[_0x425c94(0x11b)];else{if(_0x20b974[0x0][_0x425c94(0xe2)]==_0x425c94(0xfd))var _0x2f37ca=users['Chinese'];else{if(_0x20b974[0x0]['language']==_0x425c94(0xb9))var _0x2f37ca=users[_0x425c94(0xad)];}}}}}}}_0xa6ec4a[_0x425c94(0x13a)]('edit_adjustment_view',{'success':_0x45b17e[_0x425c94(0xf2)]('success'),'errors':_0x45b17e[_0x425c94(0xf2)](_0x425c94(0xd0)),'role':_0xab8e5,'profile':_0x4e5ef7,'adjustment':_0x4a3f18,'stock':_0x51fc1d,'master_shop':_0x20b974,'warehouse_name':_0x11aedf,'unit':_0x4f07f5,'language':_0x2f37ca});}catch(_0x28ace0){console[_0x425c94(0xcd)](_0x28ace0),_0xa6ec4a[_0x425c94(0xc6)](0xc8)[_0x425c94(0x116)]({'message':_0x28ace0[_0x425c94(0x14e)]});}}),router[a0_0xc61750(0xe9)](a0_0xc61750(0xac),auth,async(_0x4161de,_0x542fc8)=>{var _0x4f35c4=a0_0xc61750;try{const _0x381f59=_0x4161de[_0x4f35c4(0x11c)]['id'],{warehouse_name:_0x5665bd,Room_name:_0x152d69}=_0x4161de[_0x4f35c4(0x155)],_0x39dda9=await adjustment[_0x4f35c4(0xf5)]({'_id':_0x381f59}),_0x2f9169=_0x39dda9[_0x4f35c4(0x109)][_0x4f35c4(0x136)](async _0x4de2e8=>{var _0x333186=_0x4f35c4;if(_0x4de2e8[_0x333186(0x127)]>0x0){var _0x1c9298=await warehouse['findOne']({'name':_0x5665bd,'room':_0x4de2e8[_0x333186(0x124)],'warehouse_category':_0x333186(0x14d)});const _0x3858e1=_0x1c9298['product_details'][_0x333186(0x136)](_0x5c5865=>{var _0x5cedda=_0x333186;console[_0x5cedda(0xcd)](_0x4de2e8['types']+_0x5cedda(0xbd));if(_0x4de2e8['types']==_0x5cedda(0x14f)){if(_0x5c5865[_0x5cedda(0xe1)]==_0x4de2e8[_0x5cedda(0xe1)]&&_0x5c5865[_0x5cedda(0x128)]==_0x4de2e8[_0x5cedda(0x128)]&&_0x5c5865[_0x5cedda(0x144)]==_0x4de2e8[_0x5cedda(0x144)]&&_0x5c5865[_0x5cedda(0xdd)]==_0x4de2e8[_0x5cedda(0xdd)]&&_0x5c5865[_0x5cedda(0x14b)]==_0x4de2e8['bay']&&_0x5c5865[_0x5cedda(0x117)]==_0x4de2e8[_0x5cedda(0x117)]&&_0x5c5865[_0x5cedda(0xeb)]==_0x4de2e8[_0x5cedda(0xeb)]&&_0x5c5865[_0x5cedda(0x15d)]==_0x4de2e8[_0x5cedda(0x15d)]&&_0x5c5865[_0x5cedda(0xe8)]==_0x4de2e8[_0x5cedda(0xe8)]&&_0x5c5865[_0x5cedda(0x113)]==_0x4de2e8[_0x5cedda(0x113)]&&_0x5c5865[_0x5cedda(0x15a)]==_0x4de2e8[_0x5cedda(0x15a)]&&_0x5c5865[_0x5cedda(0x15b)]==_0x4de2e8[_0x5cedda(0x118)]){var _0x1977ec;_0x1977ec=_0x4de2e8['adjust_qty'],_0x4de2e8[_0x5cedda(0x143)]=='S'&&(_0x1977ec=_0x4de2e8[_0x5cedda(0x127)]),_0x5c5865[_0x5cedda(0xb2)]=_0x5c5865['product_stock']-_0x1977ec;}}else{if(_0x5c5865[_0x5cedda(0xe1)]==_0x4de2e8[_0x5cedda(0xe1)]&&_0x5c5865[_0x5cedda(0x128)]==_0x4de2e8[_0x5cedda(0x128)]&&_0x5c5865[_0x5cedda(0x144)]==_0x4de2e8[_0x5cedda(0x144)]&&_0x5c5865[_0x5cedda(0xdd)]==_0x4de2e8[_0x5cedda(0xdd)]&&_0x5c5865[_0x5cedda(0x14b)]==_0x4de2e8[_0x5cedda(0x14b)]&&_0x5c5865['rack']==_0x4de2e8[_0x5cedda(0x117)]&&_0x5c5865[_0x5cedda(0xeb)]==_0x4de2e8[_0x5cedda(0xeb)]&&_0x5c5865[_0x5cedda(0x15d)]==_0x4de2e8[_0x5cedda(0x15d)]&&_0x5c5865[_0x5cedda(0xe8)]==_0x4de2e8[_0x5cedda(0xe8)]&&_0x5c5865['production_date']==_0x4de2e8[_0x5cedda(0x113)]&&_0x5c5865[_0x5cedda(0x15a)]==_0x4de2e8[_0x5cedda(0x15a)]&&_0x5c5865[_0x5cedda(0x15b)]==_0x4de2e8[_0x5cedda(0x118)]){console[_0x5cedda(0xcd)](_0x4de2e8);var _0x1977ec;_0x1977ec=_0x4de2e8[_0x5cedda(0x127)],_0x4de2e8[_0x5cedda(0x143)]=='S'&&(_0x1977ec=_0x4de2e8[_0x5cedda(0x127)]),_0x5c5865[_0x5cedda(0xb2)]=_0x5c5865['product_stock']+_0x1977ec;}}});}return _0x1c9298;});Promise[_0x4f35c4(0xb8)](_0x2f9169)[_0x4f35c4(0x162)](async _0x1efe9f=>{var _0x3609fd=_0x4f35c4;try{for(const _0x1ce928 of _0x1efe9f){await _0x1ce928['save']();}_0x39dda9[_0x3609fd(0x10c)]='True';const _0x47f97a=await _0x39dda9[_0x3609fd(0x164)](),_0x44a6bb=await master_shop[_0x3609fd(0xe0)](),_0x211232=await email_settings[_0x3609fd(0x11a)](),_0x2a7528=await supervisor_settings[_0x3609fd(0xe0)]();var _0x47961b=_0x39dda9[_0x3609fd(0x109)],_0x42df10='',_0x24eaf7;for(_0x24eaf7 in _0x47961b){_0x42df10+=_0x3609fd(0x125)+_0x3609fd(0x132)+_0x47961b[_0x24eaf7]['product_name']+_0x3609fd(0x149)+_0x3609fd(0x132)+_0x47961b[_0x24eaf7][_0x3609fd(0xd7)]+_0x3609fd(0x149)+_0x3609fd(0x132)+_0x47961b[_0x24eaf7]['adjust_qty']+_0x3609fd(0x149)+_0x3609fd(0x132)+_0x47961b[_0x24eaf7]['unit']+_0x3609fd(0x149)+_0x3609fd(0x132)+_0x47961b[_0x24eaf7][_0x3609fd(0xfa)]+_0x3609fd(0x149)+_0x3609fd(0x132)+_0x39dda9['warehouse_name']+_0x3609fd(0x149)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x47961b[_0x24eaf7][_0x3609fd(0x124)]+_0x3609fd(0x149)+_0x3609fd(0x132)+_0x47961b[_0x24eaf7][_0x3609fd(0xeb)]+_0x47961b[_0x24eaf7][_0x3609fd(0x117)]+_0x47961b[_0x24eaf7][_0x3609fd(0x14b)]+_0x47961b[_0x24eaf7][_0x3609fd(0xdd)]+_0x47961b[_0x24eaf7][_0x3609fd(0x144)][0x0]+_0x47961b[_0x24eaf7][_0x3609fd(0x128)]+'</td>',_0x3609fd(0x110);}let _0x3a2475=nodemailer[_0x3609fd(0xc1)]({'host':_0x211232[_0x3609fd(0xc2)],'port':Number(_0x211232[_0x3609fd(0xb3)]),'secure':![],'auth':{'user':_0x211232[_0x3609fd(0x101)],'pass':_0x211232['password']}}),_0x59fadd={'from':_0x211232[_0x3609fd(0x101)],'to':_0x2a7528[0x0][_0x3609fd(0x140)],'subject':_0x3609fd(0x122),'attachments':[{'filename':_0x3609fd(0xe7),'path':__dirname+'/../public'+'/upload/'+_0x44a6bb[0x0][_0x3609fd(0x120)],'cid':_0x3609fd(0xce)}],'html':_0x3609fd(0xea)+_0x3609fd(0xed)+_0x3609fd(0xaa)+_0x3609fd(0x134)+_0x3609fd(0x102)+'<div>'+_0x3609fd(0x130)+_0x3609fd(0xf8)+_0x3609fd(0x134)+_0x3609fd(0x129)+_0x44a6bb[0x0][_0x3609fd(0xa7)]+_0x3609fd(0x146)+'</div>'+_0x3609fd(0xf8)+'<hr\x20class=\x22my-3\x22>'+_0x3609fd(0x134)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3609fd(0xca)+_0x39dda9[_0x3609fd(0x15a)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x3609fd(0x10e)+_0x39dda9[_0x3609fd(0xfe)]+'\x20'+'</span>'+_0x3609fd(0x147)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3609fd(0xa9)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x3609fd(0xae)+_0x3609fd(0xde)+_0x3609fd(0x166)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x3609fd(0x10f)+_0x3609fd(0x14c)+'</tr>'+'</thead>'+_0x3609fd(0x104)+'\x20'+_0x42df10+'\x20'+'</tbody>'+_0x3609fd(0x15f)+_0x3609fd(0x134)+_0x3609fd(0xc4)+_0x3609fd(0xfb)+_0x44a6bb[0x0][_0x3609fd(0xa7)]+_0x3609fd(0x147)+'</div>'+'</div>'+_0x3609fd(0x16e)};_0x3a2475[_0x3609fd(0xff)](_0x59fadd,function(_0x3c8ef1,_0x4d1374){var _0x115d0a=_0x3609fd;_0x3c8ef1?(console[_0x115d0a(0xcd)](_0x3c8ef1),console[_0x115d0a(0xcd)](_0x115d0a(0x11e))):console['log']('Email\x20sent\x20successfully');}),_0x4161de[_0x3609fd(0xf2)](_0x3609fd(0x161),_0x3609fd(0x157)),_0x542fc8[_0x3609fd(0x16f)](_0x3609fd(0xf1)+_0x47f97a[_0x3609fd(0x15b)]);}catch(_0x2910db){console[_0x3609fd(0xdf)](_0x2910db),_0x542fc8[_0x3609fd(0xc6)](0x1f4)['json']({'error':_0x3609fd(0x151)});}})[_0x4f35c4(0xec)](_0x1054ed=>{var _0x27bf9d=_0x4f35c4;console['error'](_0x1054ed),_0x542fc8['status'](0x1f4)['json']({'error':_0x27bf9d(0x112)});});}catch(_0x347d42){console[_0x4f35c4(0xcd)](_0x347d42),_0x542fc8[_0x4f35c4(0xc6)](0xc8)[_0x4f35c4(0x116)]({'message':_0x347d42[_0x4f35c4(0x14e)]});}}),router[a0_0xc61750(0x16d)](a0_0xc61750(0xbb),auth,async(_0xdf1844,_0x531426)=>{var _0x284f65=a0_0xc61750;try{const {username:_0x57b386,email:_0x582b35,role:_0x1fe3f0}=_0xdf1844[_0x284f65(0x154)],_0x2cd607=_0xdf1844[_0x284f65(0x154)],_0x4e9001=await profile['findOne']({'email':_0x2cd607['email']}),_0x1899b0=await master_shop['find'](),_0x1827be=_0xdf1844[_0x284f65(0x11c)]['id'],_0x2c217f=await adjustment['findById']({'_id':_0x1827be}),_0x2041d4=await purchases[_0x284f65(0x137)]([{'$match':{'warehouse_name':_0x2c217f[_0x284f65(0x139)]}},{'$unwind':'$product'},{'$group':{'_id':_0x284f65(0xc5)}}]),_0x2cd7cc=await product[_0x284f65(0xe0)]({}),_0x5d6497=await warehouse[_0x284f65(0x137)]([{'$match':{'name':_0x2c217f[_0x284f65(0x139)]}},{'$unwind':_0x284f65(0xb0)},{'$group':{'_id':_0x284f65(0x111),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x284f65(0x170)},'bin':{'$first':_0x284f65(0x11d)},'type':{'$first':_0x284f65(0x12a)},'floorlevel':{'$first':_0x284f65(0x10d)},'primary_code':{'$first':_0x284f65(0xe6)},'secondary_code':{'$first':_0x284f65(0x148)},'product_code':{'$first':_0x284f65(0xf7)},'storage':{'$first':_0x284f65(0x173)},'rack':{'$first':_0x284f65(0x160)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x284f65(0x100)},'production_date':{'$first':_0x284f65(0xd9)},'batch_code':{'$first':_0x284f65(0x142)},'room':{'$first':_0x284f65(0xbc)}}}]);let _0xdbad17;if(_0x2cd607[_0x284f65(0xcb)]=='staff'){const _0x57f300=await staff[_0x284f65(0x11a)]({'email':_0x2cd607[_0x284f65(0x101)]});_0xdbad17=await warehouse[_0x284f65(0x137)]([{'$match':{'status':_0x284f65(0xb1),'name':_0x57f300[_0x284f65(0x15e)],'warehouse_category':_0x284f65(0x14d),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x284f65(0xd4),'name':{'$first':_0x284f65(0xd4)}}}]);}else _0xdbad17=await warehouse['aggregate']([{'$match':{'status':_0x284f65(0xb1),'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x284f65(0xd4),'name':{'$first':_0x284f65(0xd4)}}}]);if(_0x1899b0[0x0]['language']==_0x284f65(0x12f)){var _0x3f4a6a=users[_0x284f65(0xa6)];console[_0x284f65(0xcd)](_0x3f4a6a);}else{if(_0x1899b0[0x0]['language']=='Hindi')var _0x3f4a6a=users[_0x284f65(0xef)];else{if(_0x1899b0[0x0][_0x284f65(0xe2)]==_0x284f65(0x14a))var _0x3f4a6a=users[_0x284f65(0x14a)];else{if(_0x1899b0[0x0][_0x284f65(0xe2)]==_0x284f65(0x159))var _0x3f4a6a=users[_0x284f65(0x159)];else{if(_0x1899b0[0x0][_0x284f65(0xe2)]=='French')var _0x3f4a6a=users[_0x284f65(0x168)];else{if(_0x1899b0[0x0][_0x284f65(0xe2)]=='Portuguese\x20(BR)')var _0x3f4a6a=users[_0x284f65(0x11b)];else{if(_0x1899b0[0x0][_0x284f65(0xe2)]==_0x284f65(0xfd))var _0x3f4a6a=users[_0x284f65(0xfd)];else{if(_0x1899b0[0x0][_0x284f65(0xe2)]==_0x284f65(0xb9))var _0x3f4a6a=users['Arabic'];}}}}}}}_0x531426['render']('edit_adjustment',{'success':_0xdf1844[_0x284f65(0xf2)](_0x284f65(0x161)),'errors':_0xdf1844[_0x284f65(0xf2)](_0x284f65(0xd0)),'role':_0x2cd607,'profile':_0x4e9001,'adjustment':_0x2c217f,'stock':_0x5d6497,'master_shop':_0x1899b0,'warehouse_name':_0x2041d4,'unit':_0x2cd7cc,'language':_0x3f4a6a,'warehouse':_0xdbad17});}catch(_0x1f3d24){console[_0x284f65(0xcd)](_0x1f3d24),_0x531426['status'](0xc8)[_0x284f65(0x116)]({'message':_0x1f3d24[_0x284f65(0x14e)]});}}),router[a0_0xc61750(0xe9)]('/view/:id',auth,async(_0x4cc9e5,_0x26e93b)=>{var _0x527c97=a0_0xc61750;try{const _0x4b3678=_0x4cc9e5['params']['id'],_0x13844f=await adjustment[_0x527c97(0xf5)]({'_id':_0x4b3678}),_0x53b1ac=await warehouse[_0x527c97(0x11a)]({'name':_0x13844f[_0x527c97(0x139)],'room':_0x13844f[_0x527c97(0xd2)]}),{warehouse_name:_0x443683,date:_0x266737,prod_name:_0x55f460,level:_0x566e28,isle:_0x121484,pallet:_0x282f40,stock:_0x5324ac,types:_0x435a91,adjust_qty:_0x3ee1df,new_adjust_qty:_0x450229,note:_0x474c44,Room_name:_0x36b196,invoice:_0x1c58b6,JO_number:_0x3a31f0,expiry_date:_0x3ed718}=_0x4cc9e5[_0x527c97(0x155)];if(typeof _0x55f460==_0x527c97(0x156))var _0x982b36=[_0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x13b)]],_0xbf3ee2=[_0x4cc9e5['body']['level']],_0x1fa61d=[_0x4cc9e5['body'][_0x527c97(0x114)]],_0x27c212=[_0x4cc9e5[_0x527c97(0x155)]['types']],_0x1e001b=[_0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x150)]],_0x41d509=[_0x4cc9e5['body'][_0x527c97(0x16a)]],_0x33a5f1=[_0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x131)]],_0x3e25a5=[_0x4cc9e5[_0x527c97(0x155)][_0x527c97(0xe4)]],_0x6846f6=[_0x4cc9e5[_0x527c97(0x155)][_0x527c97(0xa5)]],_0x55798c=[_0x4cc9e5['body'][_0x527c97(0xe8)]],_0x291325=[_0x4cc9e5['body']['expiry_date']],_0x28f762=[_0x4cc9e5['body'][_0x527c97(0x115)]],_0x504cf8=[_0x4cc9e5[_0x527c97(0x155)]['production_date']],_0x4a5631=[_0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x143)]],_0x5be7ae=[_0x4cc9e5[_0x527c97(0x155)]['Rooms']],_0x553f30=[_0x4cc9e5['body'][_0x527c97(0x169)]],_0x5b966e=[_0x4cc9e5['body'][_0x527c97(0xee)]];else var _0x982b36=[..._0x4cc9e5[_0x527c97(0x155)]['prod_name']],_0xbf3ee2=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x105)]],_0x1fa61d=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x114)]],_0x27c212=[..._0x4cc9e5[_0x527c97(0x155)]['types']],_0x1e001b=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x150)]],_0x41d509=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x16a)]],_0x33a5f1=[..._0x4cc9e5['body'][_0x527c97(0xc8)]],_0x3e25a5=[..._0x4cc9e5[_0x527c97(0x155)]['Secondary_units']],_0x6846f6=[..._0x4cc9e5['body'][_0x527c97(0xa5)]],_0x55798c=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0xe8)]],_0x291325=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x15d)]],_0x28f762=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x115)]],_0x504cf8=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x113)]],_0x4a5631=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x143)]],_0x5be7ae=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x12e)]],_0x553f30=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0x169)]],_0x5b966e=[..._0x4cc9e5[_0x527c97(0x155)][_0x527c97(0xee)]];const _0x593831=_0x982b36[_0x527c97(0x136)](_0x453ea8=>{return _0x453ea8={'product_name':_0x453ea8};});_0xbf3ee2['forEach']((_0x381e75,_0x2abc79)=>{var _0x1167c3=_0x527c97;_0x5be7ae[_0x1167c3(0x10a)]((_0x296375,_0x11c2cc)=>{var _0x5e70e2=_0x1167c3;if(_0x296375==_0x5e70e2(0xc7)&&_0x2abc79==_0x11c2cc){var _0x3b9310=_0x381e75['slice'](0x3);_0x593831[_0x2abc79][_0x5e70e2(0xeb)]=_0x381e75[0x0],_0x593831[_0x2abc79]['rack']=_0x381e75[0x1],_0x593831[_0x2abc79]['bay']=0x0,_0x593831[_0x2abc79]['bin']=0x0,_0x593831[_0x2abc79]['type']='Floor',_0x593831[_0x2abc79]['floorlevel']=_0x3b9310;}else{if(_0x296375==_0x5e70e2(0x145)&&_0x2abc79==_0x11c2cc){var _0x3b9310=_0x381e75['slice'](0x3);_0x593831[_0x2abc79]['storage']=_0x381e75[0x0],_0x593831[_0x2abc79][_0x5e70e2(0x117)]=_0x381e75[0x1],_0x593831[_0x2abc79][_0x5e70e2(0x14b)]=0x0,_0x593831[_0x2abc79][_0x5e70e2(0xdd)]=0x0,_0x593831[_0x2abc79][_0x5e70e2(0x144)]=_0x5e70e2(0x165),_0x593831[_0x2abc79][_0x5e70e2(0x128)]=_0x381e75[0x5];}else{if(_0x2abc79==_0x11c2cc){var _0xd79943;if(_0x381e75[0x4]=='L')_0xd79943=_0x5e70e2(0xf3);else _0x381e75[0x4]=='F'&&(_0xd79943=_0x5e70e2(0x165));_0x593831[_0x2abc79]['storage']=_0x381e75[0x0],_0x593831[_0x2abc79][_0x5e70e2(0x117)]=_0x381e75[0x1],_0x593831[_0x2abc79][_0x5e70e2(0x14b)]=_0x381e75[0x2],_0x593831[_0x2abc79]['bin']=_0x381e75[0x3],_0x593831[_0x2abc79][_0x5e70e2(0x144)]=_0xd79943,_0x593831[_0x2abc79][_0x5e70e2(0x128)]=_0x381e75[0x5];}}}});}),_0x1fa61d[_0x527c97(0x10a)]((_0x5e9ad7,_0x2cc6e9)=>{var _0x298fef=_0x527c97;_0x593831[_0x2cc6e9][_0x298fef(0xab)]=_0x5e9ad7;}),_0x27c212[_0x527c97(0x10a)]((_0xc0ce0b,_0x2eff9a)=>{var _0x12cb70=_0x527c97;_0x593831[_0x2eff9a][_0x12cb70(0x13f)]=_0xc0ce0b;}),_0x1e001b[_0x527c97(0x10a)]((_0x2c1588,_0x37d4dc)=>{var _0x282240=_0x527c97;_0x593831[_0x37d4dc][_0x282240(0x127)]=_0x2c1588;}),_0x41d509[_0x527c97(0x10a)]((_0x589507,_0x5ed462)=>{var _0x4a2bd4=_0x527c97;_0x593831[_0x5ed462][_0x4a2bd4(0xcc)]=_0x589507;}),_0x33a5f1['forEach']((_0x435eca,_0x19f851)=>{_0x593831[_0x19f851]['unit']=_0x435eca;}),_0x3e25a5[_0x527c97(0x10a)]((_0x5e9788,_0x499ddf)=>{var _0x33b569=_0x527c97;_0x593831[_0x499ddf][_0x33b569(0xfa)]=_0x5e9788;}),_0x6846f6[_0x527c97(0x10a)]((_0x234507,_0x30c562)=>{var _0x12eed1=_0x527c97;_0x593831[_0x30c562][_0x12eed1(0xd7)]=_0x234507;}),_0x55798c[_0x527c97(0x10a)]((_0x108a6b,_0x452788)=>{var _0x2e7e5c=_0x527c97;_0x593831[_0x452788][_0x2e7e5c(0xe8)]=_0x108a6b;}),_0x291325[_0x527c97(0x10a)]((_0x37e09b,_0xfb55b1)=>{var _0x24e794=_0x527c97;_0x593831[_0xfb55b1][_0x24e794(0x15d)]=_0x37e09b;}),_0x28f762[_0x527c97(0x10a)]((_0x32d32d,_0xcc51ab)=>{var _0x290897=_0x527c97;_0x593831[_0xcc51ab][_0x290897(0xdb)]=_0x32d32d;}),_0x504cf8[_0x527c97(0x10a)]((_0x7529c,_0x1c5ede)=>{var _0xed5c38=_0x527c97;_0x593831[_0x1c5ede][_0xed5c38(0x113)]=_0x7529c;}),_0x4a5631[_0x527c97(0x10a)]((_0x5c0627,_0x460a1c)=>{var _0x5d6828=_0x527c97;_0x593831[_0x460a1c][_0x5d6828(0x143)]=_0x5c0627;}),_0x5be7ae[_0x527c97(0x10a)]((_0x40580f,_0x2c69e1)=>{var _0x15f7ba=_0x527c97;_0x593831[_0x2c69e1][_0x15f7ba(0x124)]=_0x40580f;}),_0x553f30[_0x527c97(0x10a)]((_0x3257e9,_0x245f6e)=>{var _0x5c581f=_0x527c97;_0x593831[_0x245f6e][_0x5c581f(0xa4)]=_0x3257e9;}),_0x5b966e[_0x527c97(0x10a)]((_0x315fa2,_0x5ee0db)=>{var _0x185214=_0x527c97;_0x593831[_0x5ee0db][_0x185214(0x13c)]=_0x315fa2;});const _0x486934=_0x593831[_0x527c97(0x13d)](_0x90033b=>_0x90033b[_0x527c97(0x127)]!=='0'&&_0x90033b[_0x527c97(0x127)]!=='');var _0x37df9f=0x0;_0x486934['forEach'](_0x1371bc=>{var _0x56fc10=_0x527c97;console['log']('foreach\x20newproduct',_0x1371bc),parseInt(_0x1371bc[_0x56fc10(0x127)])<=0x0&&_0x37df9f++;});if(_0x37df9f!=0x0)return _0x4cc9e5[_0x527c97(0xf2)]('errors',_0x527c97(0x158)),_0x26e93b[_0x527c97(0x16f)](_0x527c97(0x141));_0x13844f[_0x527c97(0x139)]=_0x443683,_0x13844f[_0x527c97(0xfe)]=_0x266737,_0x13844f[_0x527c97(0x109)]=_0x486934,_0x13844f[_0x527c97(0x15c)]=_0x474c44,_0x13844f[_0x527c97(0x15a)]=_0x1c58b6,_0x13844f[_0x527c97(0xd6)]=_0x527c97(0xc3);const _0x3e53af=await _0x13844f[_0x527c97(0x164)]();_0x4cc9e5['flash'](_0x527c97(0x161),_0x527c97(0xe3)),_0x26e93b[_0x527c97(0x16f)](_0x527c97(0xb7));}catch(_0x11a796){console[_0x527c97(0xcd)](_0x11a796);}}),router[a0_0xc61750(0xe9)]('/barcode_scanner',async(_0x59deb8,_0x1b1b5e)=>{var _0x1abb3d=a0_0xc61750;const {primary_code:_0x2cd861,warehouse_data:_0x9548b1,rooms_data:_0x1f02d8,Roomslist:_0x3d6f79}=_0x59deb8[_0x1abb3d(0x155)],_0x323296=_0x3d6f79[_0x1abb3d(0x123)](','),_0xf1b9d7=[];async function _0x15702e(_0x3480e6){var _0x2daafc=_0x1abb3d;const _0x2a5146=await warehouse[_0x2daafc(0x137)]([{'$match':{'name':_0x9548b1,'room':_0x3480e6}},{'$unwind':_0x2daafc(0xb0)},{'$match':{'product_details.primary_code':_0x2cd861}},{'$group':{'_id':_0x2daafc(0x111),'name':{'$first':_0x2daafc(0xda)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2daafc(0xe6)},'secondary_code':{'$first':_0x2daafc(0x148)},'product_code':{'$first':_0x2daafc(0xf7)},'level':{'$first':_0x2daafc(0x170)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2daafc(0x126)},'secondary_unit':{'$first':_0x2daafc(0xcf)},'storage':{'$first':_0x2daafc(0x173)},'rack':{'$first':_0x2daafc(0x160)},'expiry_date':{'$first':_0x2daafc(0x100)},'production_date':{'$first':_0x2daafc(0xd9)},'maxPerUnit':{'$first':_0x2daafc(0x10b)},'batch_code':{'$first':_0x2daafc(0x142)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2daafc(0xbc)},'invoice':{'$first':_0x2daafc(0xfc)}}}]),_0x16343b=await warehouse[_0x2daafc(0x137)]([{'$match':{'name':_0x9548b1,'room':_0x3480e6}},{'$unwind':_0x2daafc(0xb0)},{'$match':{'product_details.secondary_code':_0x2cd861}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2daafc(0xe6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2daafc(0xf7)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x2daafc(0x11d)},'type':{'$first':_0x2daafc(0x12a)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2daafc(0x126)},'secondary_unit':{'$first':_0x2daafc(0xcf)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2daafc(0x160)},'expiry_date':{'$first':_0x2daafc(0x100)},'production_date':{'$first':_0x2daafc(0xd9)},'maxPerUnit':{'$first':_0x2daafc(0x10b)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x2daafc(0xd5)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2daafc(0xbc)}}}]);if(_0x2a5146[_0x2daafc(0xb5)]>0x0)_0xf1b9d7[_0x2daafc(0x108)](_0x2a5146);else _0x16343b[_0x2daafc(0xb5)]>0x0&&_0xf1b9d7[_0x2daafc(0x108)](_0x16343b);}const _0x971880=_0x323296[_0x1abb3d(0x136)](_0x22465f=>_0x15702e(_0x22465f));await Promise['all'](_0x971880),_0x1b1b5e['json'](_0xf1b9d7);}),router['post'](a0_0xc61750(0xf6),async(_0xe33c0e,_0x57d1e3)=>{var _0x548d42=a0_0xc61750;const {primaryCode:_0x15bb72,secondaryCode:_0x2adfac,productCode:_0x653a1f,level:_0x4d62ed,isle:_0x47d9fb,pallet:_0x1049a5,warehouses:_0x12d05b,room:_0x56323c}=_0xe33c0e[_0x548d42(0x155)];try{const _0x4d49ad=await warehouse[_0x548d42(0x137)]([{'$match':{'name':_0x12d05b,'room':_0x56323c}},{'$unwind':_0x548d42(0xb0)},{'$match':{'product_details.level':parseInt(_0x4d62ed),'product_details.isle':_0x47d9fb,'product_details.pallet':parseInt(_0x1049a5)}},{'$group':{'_id':_0x548d42(0x111),'name':{'$first':_0x548d42(0xda)},'product_stock':{'$first':_0x548d42(0xf4)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x548d42(0x12b)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x548d42(0x138)}}}]);_0x57d1e3['status'](0xc8)[_0x548d42(0x116)](_0x4d49ad);}catch(_0x3b0837){_0x57d1e3[_0x548d42(0xc6)](0x194)[_0x548d42(0x116)]({'message':_0x3b0837['message']});}}),module[a0_0xc61750(0x135)]=router;