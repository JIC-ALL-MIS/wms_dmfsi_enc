var a0_0x448212=a0_0x3570;(function(_0x4ab252,_0x1d3303){var _0x43c81e=a0_0x3570,_0x30078b=_0x4ab252();while(!![]){try{var _0x5f1198=parseInt(_0x43c81e(0x1bb))/0x1*(-parseInt(_0x43c81e(0x237))/0x2)+-parseInt(_0x43c81e(0x1a5))/0x3*(parseInt(_0x43c81e(0x20e))/0x4)+-parseInt(_0x43c81e(0x209))/0x5+parseInt(_0x43c81e(0x1a7))/0x6+-parseInt(_0x43c81e(0x218))/0x7+-parseInt(_0x43c81e(0x1f6))/0x8+parseInt(_0x43c81e(0x204))/0x9*(parseInt(_0x43c81e(0x1c1))/0xa);if(_0x5f1198===_0x1d3303)break;else _0x30078b['push'](_0x30078b['shift']());}catch(_0x45682a){_0x30078b['push'](_0x30078b['shift']());}}}(a0_0x15bc,0x42405));function a0_0x15bc(){var _0x5daba6=['product_stock','prod_code','adjustment\x20Finalized\x20successfully','log','<strong>\x20Regards\x20</strong>','$product_details.product_name','find','/view','all','</tr>','/preview/:id','$product_details.production_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','sendMail','$product_details.product_code','$product_details.secondary_unit','$_id','2822HbSdfH','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Floor','secondary_code','toString','50gcQInX','warehouse','then','</span>','<h2>\x20','$name','$product_details.product_stock','$room','password','staff','success','message','English\x20(US)','secondary_unit','prime1','New_Qty_Converted_adj','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','findOne','bay','split','<table\x20style=\x22width:\x20100%\x20!important;\x22>','filter','$product_details.level','product_name','redirect','post','types','$product_details.bay','../models/all_models','$warehouse_name','edit_adjustment_view','$product_details.expiry_date','createTransport','$product.room_names','exports','Portuguese','$product_details.unit','push','/upload/','New_Qty_Converted','level','$product_details.secondary_code','minus','$product_details.bin','/view/:id','<tr>','product_code','Chinese','maxPerUnit','$product_details.maxProducts','</body></html>','Primary_Units','expiry_date','3643032iTAJIF','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','stock','</div>','Shelves','</tbody>','finalize','port','ADJ-','slice','room','findById','room_names','$product_details.isle','2783457uSxLnt','German','Return\x20Goods','Level','$invoice','480455DPEcTZ','Logo.png','max_per_unit','/picking_list/PDF_adjustment_rm/','edit_adjustment','60OsecPS','bin','Secondary_units','Arabic\x20(ae)','unit','Rooms','English','/../public','../public/language/languages.json','string','2031512lWITTb','error','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Router','</thead>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','\x20<>\x20','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Enabled','params','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','\x20</h2>','<html><head><title></title>','adjustment','Enclosed','$product_details.rack','RMSEmail','json','$product_details.pallet','map','email','Receiving\x20Area','logo','flash','type','</h5>','date','prod_invoice','$isAllowEdit','floorlevel','210IkNKXR','save','language','/adjustment/view','$finalize','$product_details.storage','storage','<h5\x20style=\x22text-align:\x20left;\x22>','Adjustment\x20Mail','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product','add_adjustment','$product_details.floorlevel','primary_code','<h5>','forEach','<div>','prod_name','Return\x20Rooms','warehouse_name','$product','get','back','$product_details.primary_code','errors','/adjustment/preview/','express','Spanish','$product_details.product_cat','second1','An\x20error\x20occurred.','new_adjust_qty','Hindi','</table>','</td>','Raw\x20Materials','maxperunit','batch_code','adjust_qty','../middleware/auth','\x20Order\x20Number\x20:\x20','adjustment\x20data\x20update\x20successfully','body','French','$product.product_name','image','<hr\x20class=\x22my-3\x22>','Error\x20Occurs','stockBefore','$product_details._id','user','_id','rack','role','$product_details.batch_code','floor','Portuguese\x20(BR)','status','prod_cat','render','$product_details','/view/add_adjustment','aggregate','product_details','True','host','catch','invoice','foreach\x20newproduct','length','<!DOCTYPE\x20html>','90093cMmwFR','master','1880766aiosyY','$product_details.type','$product_details.maxPerUnit'];a0_0x15bc=function(){return _0x5daba6;};return a0_0x15bc();}const express=require(a0_0x448212(0x251)),app=express(),router=express[a0_0x448212(0x21b)](),auth=require(a0_0x448212(0x185)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x448212(0x1dd)),users=require(a0_0x448212(0x216)),nodemailer=require('nodemailer');function a0_0x3570(_0x52b8c3,_0x144b49){var _0x15bc50=a0_0x15bc();return a0_0x3570=function(_0x357011,_0x37807a){_0x357011=_0x357011-0x180;var _0x4c4b25=_0x15bc50[_0x357011];return _0x4c4b25;},a0_0x3570(_0x52b8c3,_0x144b49);}router[a0_0x448212(0x24c)](a0_0x448212(0x1b1),auth,async(_0x15e7ce,_0x16783a)=>{var _0x1630a7=a0_0x448212;try{const {username:_0x3884ea,email:_0x173cc1,role:_0x65bad7}=_0x15e7ce['user'],_0x15cbb2=_0x15e7ce['user'],_0x3c8857=await profile[_0x1630a7(0x1d2)]({'email':_0x15cbb2[_0x1630a7(0x22d)]}),_0x1622b4=await master_shop[_0x1630a7(0x1b0)]();console[_0x1630a7(0x1ad)](_0x1630a7(0x1a6),_0x1622b4);let _0x32d185;if(_0x15cbb2[_0x1630a7(0x193)]=='staff'){const _0x1fa3d3=await staff[_0x1630a7(0x1d2)]({'email':_0x15cbb2['email']});_0x32d185=await warehouse[_0x1630a7(0x1b0)]({'status':'Enabled','name':_0x1fa3d3['warehouse']});}else _0x32d185=await warehouse[_0x1630a7(0x1b0)]({'status':_0x1630a7(0x221)});const _0x4ceae2=await product[_0x1630a7(0x1b0)]();let _0x4dcfdd;if(_0x15cbb2[_0x1630a7(0x193)]==_0x1630a7(0x1ca)){const _0x5ecf23=await staff[_0x1630a7(0x1d2)]({'email':_0x15cbb2['email']});_0x4dcfdd=await adjustment[_0x1630a7(0x1b0)]({'warehouse_name':_0x5ecf23['warehouse']});}else _0x4dcfdd=await adjustment[_0x1630a7(0x19c)]([{'$unwind':_0x1630a7(0x24b)},{'$group':{'_id':_0x1630a7(0x1ba),'invoice':{'$first':_0x1630a7(0x208)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x1630a7(0x1de)},'room':{'$addToSet':_0x1630a7(0x1e2)},'finalize':{'$first':_0x1630a7(0x23b)},'isAllowEdit':{'$first':_0x1630a7(0x235)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1622b4[0x0][_0x1630a7(0x239)]==_0x1630a7(0x1cd)){var _0x406b06=users[_0x1630a7(0x214)];console[_0x1630a7(0x1ad)](_0x406b06);}else{if(_0x1622b4[0x0][_0x1630a7(0x239)]=='Hindi')var _0x406b06=users[_0x1630a7(0x257)];else{if(_0x1622b4[0x0][_0x1630a7(0x239)]==_0x1630a7(0x205))var _0x406b06=users[_0x1630a7(0x205)];else{if(_0x1622b4[0x0]['language']=='Spanish')var _0x406b06=users[_0x1630a7(0x252)];else{if(_0x1622b4[0x0][_0x1630a7(0x239)]==_0x1630a7(0x189))var _0x406b06=users[_0x1630a7(0x189)];else{if(_0x1622b4[0x0][_0x1630a7(0x239)]==_0x1630a7(0x196))var _0x406b06=users[_0x1630a7(0x1e4)];else{if(_0x1622b4[0x0][_0x1630a7(0x239)]=='Chinese')var _0x406b06=users['Chinese'];else{if(_0x1622b4[0x0][_0x1630a7(0x239)]==_0x1630a7(0x211))var _0x406b06=users[_0x1630a7(0x21f)];}}}}}}}_0x16783a[_0x1630a7(0x199)](_0x1630a7(0x226),{'success':_0x15e7ce['flash'](_0x1630a7(0x1cb)),'errors':_0x15e7ce[_0x1630a7(0x230)](_0x1630a7(0x24f)),'role':_0x15cbb2,'profile':_0x3c8857,'warehouse':_0x32d185,'product':_0x4ceae2,'adjustment':_0x4dcfdd,'master_shop':_0x1622b4,'language':_0x406b06});}catch(_0x2c0eaa){console[_0x1630a7(0x1ad)](_0x2c0eaa);}});async function getRandom8DigitNumber(){var _0x5a5df1=a0_0x448212;const _0x5c93a9=0x989680,_0x4d4192=0x5f5e0ff,_0x2c516a=Math[_0x5a5df1(0x195)](Math['random']()*(_0x4d4192-_0x5c93a9+0x1))+_0x5c93a9;var _0xd1517c;const _0x1e27a2=await adjustment['findOne']({'invoice':_0x5a5df1(0x1fe)+_0x2c516a});return _0x1e27a2&&_0x1e27a2[_0x5a5df1(0x1a3)]>0x0?_0xd1517c='ADJ-'+_0x2c516a:_0xd1517c='ADJ-'+_0x2c516a,_0xd1517c;}router['get'](a0_0x448212(0x19b),auth,async(_0x4c6b25,_0x425d84)=>{var _0xdeb22c=a0_0x448212;try{const {username:_0x8203f8,email:_0x310183,role:_0x10bf08}=_0x4c6b25[_0xdeb22c(0x190)],_0x595461=_0x4c6b25[_0xdeb22c(0x190)],_0x8789dc=await profile[_0xdeb22c(0x1d2)]({'email':_0x595461['email']}),_0x4fe083=await master_shop[_0xdeb22c(0x1b0)]();let _0x32f83c;if(_0x595461['role']==_0xdeb22c(0x1ca)){const _0x19be52=await staff[_0xdeb22c(0x1d2)]({'email':_0x595461[_0xdeb22c(0x22d)]});_0x32f83c=await warehouse[_0xdeb22c(0x19c)]([{'$match':{'status':'Enabled','name':_0x19be52[_0xdeb22c(0x1c2)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xdeb22c(0x206)}}},{'$group':{'_id':'$name','name':{'$first':_0xdeb22c(0x1c6)}}}]);}else _0x32f83c=await warehouse['aggregate']([{'$match':{'status':_0xdeb22c(0x221),'warehouse_category':_0xdeb22c(0x181),'name':{'$ne':_0xdeb22c(0x206)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x8db753=await product[_0xdeb22c(0x1b0)]({}),_0x20c98f=await adjustment[_0xdeb22c(0x1b0)]({}),_0x3afa97=_0x20c98f[_0xdeb22c(0x1a3)]+0x1,_0x54613a='ADJ-'+_0x3afa97[_0xdeb22c(0x1c0)]()['padStart'](0x5,'0');var _0x268d3b=['Ambient',_0xdeb22c(0x227),_0xdeb22c(0x249)];if(_0x4fe083[0x0][_0xdeb22c(0x239)]=='English\x20(US)')var _0x4578e2=users[_0xdeb22c(0x214)];else{if(_0x4fe083[0x0][_0xdeb22c(0x239)]=='Hindi')var _0x4578e2=users[_0xdeb22c(0x257)];else{if(_0x4fe083[0x0][_0xdeb22c(0x239)]==_0xdeb22c(0x205))var _0x4578e2=users['German'];else{if(_0x4fe083[0x0][_0xdeb22c(0x239)]==_0xdeb22c(0x252))var _0x4578e2=users[_0xdeb22c(0x252)];else{if(_0x4fe083[0x0][_0xdeb22c(0x239)]=='French')var _0x4578e2=users['French'];else{if(_0x4fe083[0x0][_0xdeb22c(0x239)]==_0xdeb22c(0x196))var _0x4578e2=users[_0xdeb22c(0x1e4)];else{if(_0x4fe083[0x0][_0xdeb22c(0x239)]==_0xdeb22c(0x1f0))var _0x4578e2=users[_0xdeb22c(0x1f0)];else{if(_0x4fe083[0x0][_0xdeb22c(0x239)]==_0xdeb22c(0x211))var _0x4578e2=users[_0xdeb22c(0x21f)];}}}}}}}const _0x1ccd25=getRandom8DigitNumber();_0x1ccd25[_0xdeb22c(0x1c3)](_0x22c003=>{var _0x50d7d6=_0xdeb22c;_0x425d84[_0x50d7d6(0x199)](_0x50d7d6(0x242),{'success':_0x4c6b25['flash'](_0x50d7d6(0x1cb)),'errors':_0x4c6b25[_0x50d7d6(0x230)](_0x50d7d6(0x24f)),'role':_0x595461,'profile':_0x8789dc,'warehouse':_0x32f83c,'product':_0x8db753,'master_shop':_0x4fe083,'language':_0x4578e2,'rooms_data':_0x268d3b,'invoice_no':_0x22c003});})[_0xdeb22c(0x1a0)](_0x3ca9d2=>{var _0x2eb33b=_0xdeb22c;_0x4c6b25[_0x2eb33b(0x230)](_0x2eb33b(0x24f),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x425d84[_0x2eb33b(0x1d9)]('/adjustment/view');});}catch(_0x45982c){console[_0xdeb22c(0x1ad)](_0x45982c);}}),router[a0_0x448212(0x1da)](a0_0x448212(0x19b),auth,async(_0x119813,_0x37a8f0)=>{var _0x4ed0a4=a0_0x448212;try{const {warehouse_name:_0x249c77,date:_0x408a92,prod_name:_0x2cedde,level:_0x2c8018,isle:_0x4eb529,pallet:_0x4ff21f,stock:_0x4606b4,types:_0x52074b,adjust_qty:_0x5a39f6,new_adjust_qty:_0x4f6d0d,note:_0x4e37b6,Room_name:_0x524c85,invoice:_0x1db1a3,JO_number:_0x33a538,expiry_date:_0x499d2a}=_0x119813[_0x4ed0a4(0x188)];if(typeof _0x2cedde==_0x4ed0a4(0x217))var _0x10465d=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x248)]],_0x5b8c95=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1e9)]],_0x302001=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1f8)]],_0x436b95=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1db)]],_0x4fd0a2=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1d0)]],_0x156daf=[_0x119813[_0x4ed0a4(0x188)]['New_Qty_Converted']],_0x34b654=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1f4)]],_0x151b5c=[_0x119813[_0x4ed0a4(0x188)]['Secondary_units']],_0x1f368e=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1ab)]],_0x108968=[_0x119813['body']['batch_code']],_0x1e0546=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1f5)]],_0x362fab=[_0x119813['body']['max_per_unit']],_0x2545b6=[_0x119813['body'][_0x4ed0a4(0x1bc)]],_0x1d4cd8=[_0x119813['body']['prod_cat']],_0x2db4f0=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x213)]],_0x44ce42=[_0x119813['body'][_0x4ed0a4(0x1cf)]],_0x19129d=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x254)]],_0x4cfe64=[_0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x234)]];else var _0x10465d=[..._0x119813['body'][_0x4ed0a4(0x248)]],_0x5b8c95=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1e9)]],_0x302001=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1f8)]],_0x436b95=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1db)]],_0x4fd0a2=[..._0x119813['body'][_0x4ed0a4(0x1d0)]],_0x156daf=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1e8)]],_0x34b654=[..._0x119813['body'][_0x4ed0a4(0x212)]],_0x151b5c=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x210)]],_0x1f368e=[..._0x119813[_0x4ed0a4(0x188)]['prod_code']],_0x108968=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x183)]],_0x1e0546=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1f5)]],_0x362fab=[..._0x119813[_0x4ed0a4(0x188)]['max_per_unit']],_0x2545b6=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1bc)]],_0x1d4cd8=[..._0x119813[_0x4ed0a4(0x188)]['prod_cat']],_0x2db4f0=[..._0x119813['body'][_0x4ed0a4(0x213)]],_0x44ce42=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x1cf)]],_0x19129d=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x254)]],_0x4cfe64=[..._0x119813[_0x4ed0a4(0x188)][_0x4ed0a4(0x234)]];const _0x5c1e33=_0x10465d['map'](_0xb7acc2=>{return _0xb7acc2={'product_name':_0xb7acc2};});_0x5b8c95[_0x4ed0a4(0x246)]((_0x2221c2,_0x2b0aa5)=>{var _0xbc94e9=_0x4ed0a4;_0x2db4f0[_0xbc94e9(0x246)]((_0x553f12,_0x919593)=>{var _0x5e1522=_0xbc94e9;if(_0x553f12==_0x5e1522(0x22e)&&_0x2b0aa5==_0x919593){var _0x5a8d08=_0x2221c2[_0x5e1522(0x1ff)](0x3);_0x5c1e33[_0x2b0aa5][_0x5e1522(0x23d)]=_0x2221c2[0x0],_0x5c1e33[_0x2b0aa5][_0x5e1522(0x192)]=_0x2221c2[0x1],_0x5c1e33[_0x2b0aa5]['bay']=0x0,_0x5c1e33[_0x2b0aa5][_0x5e1522(0x20f)]=0x0,_0x5c1e33[_0x2b0aa5][_0x5e1522(0x231)]=_0x5e1522(0x1be),_0x5c1e33[_0x2b0aa5][_0x5e1522(0x236)]=_0x5a8d08;}else{if(_0x553f12==_0x5e1522(0x1fa)&&_0x2b0aa5==_0x919593){var _0x5a8d08=_0x2221c2[_0x5e1522(0x1ff)](0x3);_0x5c1e33[_0x2b0aa5]['storage']=_0x2221c2[0x0],_0x5c1e33[_0x2b0aa5][_0x5e1522(0x192)]=_0x2221c2[0x1],_0x5c1e33[_0x2b0aa5]['bay']=0x0,_0x5c1e33[_0x2b0aa5][_0x5e1522(0x20f)]=0x0,_0x5c1e33[_0x2b0aa5]['type']='Floor',_0x5c1e33[_0x2b0aa5][_0x5e1522(0x236)]=_0x2221c2[0x5];}else{if(_0x2b0aa5==_0x919593){var _0x5a3a37;if(_0x2221c2[0x4]=='L')_0x5a3a37=_0x5e1522(0x207);else _0x2221c2[0x4]=='F'&&(_0x5a3a37=_0x5e1522(0x1be));_0x5c1e33[_0x2b0aa5][_0x5e1522(0x23d)]=_0x2221c2[0x0],_0x5c1e33[_0x2b0aa5][_0x5e1522(0x192)]=_0x2221c2[0x1],_0x5c1e33[_0x2b0aa5][_0x5e1522(0x1d3)]=_0x2221c2[0x2],_0x5c1e33[_0x2b0aa5][_0x5e1522(0x20f)]=_0x2221c2[0x3],_0x5c1e33[_0x2b0aa5][_0x5e1522(0x231)]=_0x5a3a37,_0x5c1e33[_0x2b0aa5][_0x5e1522(0x236)]=_0x2221c2[0x5];}}}});}),_0x302001[_0x4ed0a4(0x246)]((_0x1f209a,_0x18ee0a)=>{var _0x5c7ea9=_0x4ed0a4;_0x5c1e33[_0x18ee0a][_0x5c7ea9(0x18e)]=_0x1f209a;}),_0x436b95[_0x4ed0a4(0x246)]((_0x4eb174,_0x424e56)=>{var _0xcbbe4=_0x4ed0a4;_0x5c1e33[_0x424e56][_0xcbbe4(0x1db)]=_0x4eb174;}),_0x4fd0a2[_0x4ed0a4(0x246)]((_0x12239e,_0x4ff680)=>{_0x5c1e33[_0x4ff680]['adjust_qty']=_0x12239e;}),_0x156daf[_0x4ed0a4(0x246)]((_0x2af27e,_0x260d2c)=>{var _0x4bec0e=_0x4ed0a4;_0x5c1e33[_0x260d2c][_0x4bec0e(0x256)]=_0x2af27e;}),_0x34b654[_0x4ed0a4(0x246)]((_0x2104f4,_0x2f3b72)=>{var _0x373a78=_0x4ed0a4;_0x5c1e33[_0x2f3b72][_0x373a78(0x212)]=_0x2104f4;}),_0x151b5c[_0x4ed0a4(0x246)]((_0x2b7b52,_0x3b7d9f)=>{var _0x16ceb4=_0x4ed0a4;_0x5c1e33[_0x3b7d9f][_0x16ceb4(0x1ce)]=_0x2b7b52;}),_0x1f368e[_0x4ed0a4(0x246)]((_0x1bfaaf,_0x3ba7f6)=>{var _0x3422df=_0x4ed0a4;_0x5c1e33[_0x3ba7f6][_0x3422df(0x1ef)]=_0x1bfaaf;}),_0x108968[_0x4ed0a4(0x246)]((_0x34f154,_0x8ec0e7)=>{var _0x25587c=_0x4ed0a4;_0x5c1e33[_0x8ec0e7][_0x25587c(0x183)]=_0x34f154;}),_0x1e0546[_0x4ed0a4(0x246)]((_0x100e8c,_0x1a031d)=>{var _0x4c3c97=_0x4ed0a4;_0x5c1e33[_0x1a031d][_0x4c3c97(0x1f5)]=_0x100e8c;}),_0x362fab[_0x4ed0a4(0x246)]((_0x22904a,_0x41d901)=>{var _0x1dab9f=_0x4ed0a4;_0x5c1e33[_0x41d901][_0x1dab9f(0x182)]=_0x22904a;}),_0x2545b6[_0x4ed0a4(0x246)]((_0x2ed391,_0x46731b)=>{_0x5c1e33[_0x46731b]['production_date']=_0x2ed391;}),_0x1d4cd8['forEach']((_0x31bf01,_0xbb9dbf)=>{_0x5c1e33[_0xbb9dbf]['prod_cat']=_0x31bf01;}),_0x2db4f0[_0x4ed0a4(0x246)]((_0x487043,_0x6dc5b7)=>{var _0x5773b5=_0x4ed0a4;_0x5c1e33[_0x6dc5b7][_0x5773b5(0x202)]=_0x487043;}),_0x44ce42[_0x4ed0a4(0x246)]((_0x307a79,_0x5bd2ca)=>{var _0x5342e2=_0x4ed0a4;_0x5c1e33[_0x5bd2ca][_0x5342e2(0x244)]=_0x307a79;}),_0x19129d[_0x4ed0a4(0x246)]((_0x4e1dc5,_0x393f8c)=>{_0x5c1e33[_0x393f8c]['secondary_code']=_0x4e1dc5;}),_0x4cfe64[_0x4ed0a4(0x246)]((_0x17e0f1,_0x47bcb2)=>{var _0x5e7308=_0x4ed0a4;_0x5c1e33[_0x47bcb2][_0x5e7308(0x1a1)]=_0x17e0f1;});const _0x1a05d6=_0x5c1e33[_0x4ed0a4(0x1d6)](_0x57d871=>_0x57d871[_0x4ed0a4(0x184)]!=='0'&&_0x57d871[_0x4ed0a4(0x184)]!=='');var _0x3471bf=0x0;_0x1a05d6[_0x4ed0a4(0x246)](_0x3353da=>{var _0x565074=_0x4ed0a4;console[_0x565074(0x1ad)](_0x565074(0x1a2),_0x3353da),parseInt(_0x3353da[_0x565074(0x184)])<=0x0&&_0x3471bf++;});if(_0x3471bf!=0x0)return _0x119813[_0x4ed0a4(0x230)](_0x4ed0a4(0x24f),_0x4ed0a4(0x21d)),_0x37a8f0[_0x4ed0a4(0x1d9)]('back');const _0xa2288=new adjustment({'warehouse_name':_0x249c77,'date':_0x408a92,'product':_0x1a05d6,'note':_0x4e37b6,'room':_0x524c85,'invoice':_0x1db1a3,'JO_number':_0x33a538,'expiry_date':_0x499d2a}),_0x58b0db=await _0xa2288[_0x4ed0a4(0x238)]();_0x119813[_0x4ed0a4(0x230)](_0x4ed0a4(0x1cb),'adjustment\x20add\x20successfull'),_0x37a8f0['redirect'](_0x4ed0a4(0x250)+_0x58b0db[_0x4ed0a4(0x191)]);}catch(_0x2b65e1){console['log'](_0x2b65e1),_0x37a8f0['status'](0xc8)[_0x4ed0a4(0x22a)]({'message':_0x2b65e1[_0x4ed0a4(0x1cc)]});}}),router[a0_0x448212(0x24c)](a0_0x448212(0x1b4),auth,async(_0xeb0b0a,_0x1057d4)=>{var _0xffa6a4=a0_0x448212;try{const {username:_0x42b900,email:_0x4dbca9,role:_0x5e1a87}=_0xeb0b0a['user'],_0x4a6a27=_0xeb0b0a[_0xffa6a4(0x190)],_0x6c47d9=await profile[_0xffa6a4(0x1d2)]({'email':_0x4a6a27['email']}),_0x18d840=await master_shop[_0xffa6a4(0x1b0)](),_0x4310d7=_0xeb0b0a['params']['id'],_0x36c46d=await adjustment[_0xffa6a4(0x201)]({'_id':_0x4310d7}),_0x29bd15=await purchases[_0xffa6a4(0x19c)]([{'$match':{'warehouse_name':_0x36c46d[_0xffa6a4(0x24a)]}},{'$unwind':_0xffa6a4(0x24b)},{'$group':{'_id':_0xffa6a4(0x18a)}}]),_0x1d0c5c=await product[_0xffa6a4(0x1b0)]({}),_0x562167=await warehouse[_0xffa6a4(0x19c)]([{'$match':{'name':_0x36c46d[_0xffa6a4(0x24a)]}},{'$unwind':_0xffa6a4(0x19a)},{'$group':{'_id':_0xffa6a4(0x18f),'name':{'$first':_0xffa6a4(0x1af)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xffa6a4(0x1dc)},'bin':{'$first':_0xffa6a4(0x1ec)},'type':{'$first':_0xffa6a4(0x1a8)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xffa6a4(0x24e)},'secondary_code':{'$first':_0xffa6a4(0x1ea)},'product_code':{'$first':_0xffa6a4(0x1b8)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0xffa6a4(0x1a9)},'expiry_date':{'$first':_0xffa6a4(0x1e0)},'production_date':{'$first':_0xffa6a4(0x1b5)},'batch_code':{'$first':_0xffa6a4(0x194)},'room':{'$first':_0xffa6a4(0x1c8)}}}]);if(_0x18d840[0x0][_0xffa6a4(0x239)]==_0xffa6a4(0x1cd)){var _0x5381d6=users[_0xffa6a4(0x214)];console[_0xffa6a4(0x1ad)](_0x5381d6);}else{if(_0x18d840[0x0][_0xffa6a4(0x239)]==_0xffa6a4(0x257))var _0x5381d6=users[_0xffa6a4(0x257)];else{if(_0x18d840[0x0][_0xffa6a4(0x239)]==_0xffa6a4(0x205))var _0x5381d6=users[_0xffa6a4(0x205)];else{if(_0x18d840[0x0][_0xffa6a4(0x239)]==_0xffa6a4(0x252))var _0x5381d6=users[_0xffa6a4(0x252)];else{if(_0x18d840[0x0][_0xffa6a4(0x239)]==_0xffa6a4(0x189))var _0x5381d6=users[_0xffa6a4(0x189)];else{if(_0x18d840[0x0][_0xffa6a4(0x239)]==_0xffa6a4(0x196))var _0x5381d6=users['Portuguese'];else{if(_0x18d840[0x0][_0xffa6a4(0x239)]==_0xffa6a4(0x1f0))var _0x5381d6=users[_0xffa6a4(0x1f0)];else{if(_0x18d840[0x0]['language']==_0xffa6a4(0x211))var _0x5381d6=users[_0xffa6a4(0x21f)];}}}}}}}_0x1057d4['render'](_0xffa6a4(0x1df),{'success':_0xeb0b0a[_0xffa6a4(0x230)](_0xffa6a4(0x1cb)),'errors':_0xeb0b0a['flash'](_0xffa6a4(0x24f)),'role':_0x4a6a27,'profile':_0x6c47d9,'adjustment':_0x36c46d,'stock':_0x562167,'master_shop':_0x18d840,'warehouse_name':_0x29bd15,'unit':_0x1d0c5c,'language':_0x5381d6});}catch(_0xd7b839){console[_0xffa6a4(0x1ad)](_0xd7b839),_0x1057d4[_0xffa6a4(0x197)](0xc8)[_0xffa6a4(0x22a)]({'message':_0xd7b839[_0xffa6a4(0x1cc)]});}}),router[a0_0x448212(0x1da)]('/preview/:id',auth,async(_0x76da8c,_0xe878c6)=>{var _0x4bd153=a0_0x448212;try{const _0x4935f7=_0x76da8c[_0x4bd153(0x222)]['id'],{warehouse_name:_0x43b5c4,Room_name:_0x119ca3}=_0x76da8c['body'],_0x5a9b4f=await adjustment[_0x4bd153(0x201)]({'_id':_0x4935f7}),_0x33e021=_0x5a9b4f['product'][_0x4bd153(0x22c)](async _0x2148a4=>{var _0xdb0fc2=_0x4bd153;if(_0x2148a4['adjust_qty']>0x0){var _0x49ffa9=await warehouse[_0xdb0fc2(0x1d2)]({'name':_0x43b5c4,'room':_0x2148a4[_0xdb0fc2(0x202)],'warehouse_category':_0xdb0fc2(0x181)});const _0x3f6dab=_0x49ffa9[_0xdb0fc2(0x19d)]['map'](_0x2d2b2e=>{var _0x4d35b2=_0xdb0fc2;if(_0x2148a4[_0x4d35b2(0x231)]==_0x4d35b2(0x1eb)){if(_0x2d2b2e[_0x4d35b2(0x1d8)]==_0x2148a4['product_name']&&_0x2d2b2e['floorlevel']==_0x2148a4[_0x4d35b2(0x236)]&&_0x2d2b2e[_0x4d35b2(0x231)]==_0x2148a4[_0x4d35b2(0x231)]&&_0x2d2b2e['bin']==_0x2148a4[_0x4d35b2(0x20f)]&&_0x2d2b2e[_0x4d35b2(0x1d3)]==_0x2148a4['bay']&&_0x2d2b2e['rack']==_0x2148a4[_0x4d35b2(0x192)]&&_0x2d2b2e['storage']==_0x2148a4[_0x4d35b2(0x23d)]&&_0x2d2b2e[_0x4d35b2(0x1f5)]==_0x2148a4['expiry_date']&&_0x2d2b2e[_0x4d35b2(0x183)]==_0x2148a4[_0x4d35b2(0x183)]&&_0x2d2b2e[_0x4d35b2(0x1bc)]==_0x2148a4[_0x4d35b2(0x1bc)]&&_0x2d2b2e['invoice']==_0x2148a4['invoice']){var _0xf14c7;_0xf14c7=_0x2148a4['adjust_qty'],_0x2148a4['prod_cat']=='S'&&(_0xf14c7=_0x2148a4[_0x4d35b2(0x184)]),_0x2d2b2e[_0x4d35b2(0x1aa)]=_0x2d2b2e[_0x4d35b2(0x1aa)]-_0xf14c7;}}else{if(_0x2d2b2e['product_name']==_0x2148a4['product_name']&&_0x2d2b2e[_0x4d35b2(0x236)]==_0x2148a4[_0x4d35b2(0x236)]&&_0x2d2b2e[_0x4d35b2(0x231)]==_0x2148a4[_0x4d35b2(0x231)]&&_0x2d2b2e[_0x4d35b2(0x20f)]==_0x2148a4[_0x4d35b2(0x20f)]&&_0x2d2b2e[_0x4d35b2(0x1d3)]==_0x2148a4[_0x4d35b2(0x1d3)]&&_0x2d2b2e[_0x4d35b2(0x192)]==_0x2148a4[_0x4d35b2(0x192)]&&_0x2d2b2e[_0x4d35b2(0x23d)]==_0x2148a4[_0x4d35b2(0x23d)]&&_0x2d2b2e['expiry_date']==_0x2148a4[_0x4d35b2(0x1f5)]&&_0x2d2b2e[_0x4d35b2(0x183)]==_0x2148a4[_0x4d35b2(0x183)]&&_0x2d2b2e[_0x4d35b2(0x1bc)]==_0x2148a4[_0x4d35b2(0x1bc)]&&_0x2d2b2e[_0x4d35b2(0x1a1)]==_0x2148a4[_0x4d35b2(0x1a1)]){console[_0x4d35b2(0x1ad)](_0x2148a4);var _0xf14c7;_0xf14c7=_0x2148a4['adjust_qty'],_0x2148a4[_0x4d35b2(0x198)]=='S'&&(_0xf14c7=_0x2148a4[_0x4d35b2(0x184)]),console[_0x4d35b2(0x1ad)](_0xf14c7+'\x20<>\x20'+_0x2148a4[_0x4d35b2(0x184)]+_0x4d35b2(0x21e)+_0x2d2b2e[_0x4d35b2(0x1f1)]+_0x4d35b2(0x21e)+_0x2148a4[_0x4d35b2(0x198)]),_0x2d2b2e[_0x4d35b2(0x1aa)]=_0x2d2b2e[_0x4d35b2(0x1aa)]+_0xf14c7;}}});}return _0x49ffa9;});Promise['all'](_0x33e021)[_0x4bd153(0x1c3)](async _0x29b70d=>{var _0x389c02=_0x4bd153;try{for(const _0x340279 of _0x29b70d){await _0x340279[_0x389c02(0x238)]();}_0x5a9b4f[_0x389c02(0x1fc)]=_0x389c02(0x19e);const _0x349d32=await _0x5a9b4f[_0x389c02(0x238)](),_0x20552f=await master_shop[_0x389c02(0x1b0)](),_0x576b76=await email_settings['findOne'](),_0x2d8534=await supervisor_settings[_0x389c02(0x1b0)]();var _0x1808fb=_0x5a9b4f[_0x389c02(0x241)],_0x17f293='',_0x4dee3d;for(_0x4dee3d in _0x1808fb){_0x17f293+=_0x389c02(0x1ee)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1808fb[_0x4dee3d]['product_name']+_0x389c02(0x180)+_0x389c02(0x1b6)+_0x1808fb[_0x4dee3d][_0x389c02(0x1ef)]+_0x389c02(0x180)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1808fb[_0x4dee3d][_0x389c02(0x184)]+_0x389c02(0x180)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1808fb[_0x4dee3d][_0x389c02(0x212)]+_0x389c02(0x180)+_0x389c02(0x1b6)+_0x1808fb[_0x4dee3d]['secondary_unit']+_0x389c02(0x180)+_0x389c02(0x1b6)+_0x5a9b4f[_0x389c02(0x24a)]+_0x389c02(0x180)+_0x389c02(0x1b6)+_0x1808fb[_0x4dee3d]['room_names']+_0x389c02(0x180)+_0x389c02(0x1b6)+_0x1808fb[_0x4dee3d][_0x389c02(0x23d)]+_0x1808fb[_0x4dee3d][_0x389c02(0x192)]+_0x1808fb[_0x4dee3d][_0x389c02(0x1d3)]+_0x1808fb[_0x4dee3d][_0x389c02(0x20f)]+_0x1808fb[_0x4dee3d]['type'][0x0]+_0x1808fb[_0x4dee3d][_0x389c02(0x236)]+_0x389c02(0x180),_0x389c02(0x1b3);}let _0x1be81e=nodemailer[_0x389c02(0x1e1)]({'host':_0x576b76[_0x389c02(0x19f)],'port':Number(_0x576b76[_0x389c02(0x1fd)]),'secure':![],'auth':{'user':_0x576b76[_0x389c02(0x22d)],'pass':_0x576b76[_0x389c02(0x1c9)]}}),_0x1b5d17={'from':_0x576b76[_0x389c02(0x22d)],'to':_0x2d8534[0x0][_0x389c02(0x229)],'subject':_0x389c02(0x23f),'attachments':[{'filename':_0x389c02(0x20a),'path':__dirname+_0x389c02(0x215)+_0x389c02(0x1e7)+_0x20552f[0x0][_0x389c02(0x18b)],'cid':_0x389c02(0x22f)}],'html':_0x389c02(0x1a4)+_0x389c02(0x225)+'</head><body>'+'<div>'+_0x389c02(0x240)+_0x389c02(0x247)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x389c02(0x247)+_0x389c02(0x1c5)+_0x20552f[0x0]['site_title']+_0x389c02(0x224)+_0x389c02(0x1f9)+_0x389c02(0x1f9)+_0x389c02(0x18c)+_0x389c02(0x247)+_0x389c02(0x23e)+_0x389c02(0x186)+_0x5a9b4f[_0x389c02(0x1a1)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x5a9b4f['date']+'\x20'+_0x389c02(0x1c4)+_0x389c02(0x232)+_0x389c02(0x1f9)+_0x389c02(0x1d5)+_0x389c02(0x21a)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x389c02(0x223)+_0x389c02(0x1d1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x389c02(0x1bd)+_0x389c02(0x220)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x389c02(0x1f7)+_0x389c02(0x1b3)+_0x389c02(0x21c)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x17f293+'\x20'+_0x389c02(0x1fb)+_0x389c02(0x258)+_0x389c02(0x247)+_0x389c02(0x1ae)+_0x389c02(0x245)+_0x20552f[0x0]['site_title']+_0x389c02(0x232)+_0x389c02(0x1f9)+_0x389c02(0x1f9)+_0x389c02(0x1f3)};_0x1be81e[_0x389c02(0x1b7)](_0x1b5d17,function(_0x191009,_0xaf25db){var _0x4d9a76=_0x389c02;_0x191009?(console[_0x4d9a76(0x1ad)](_0x191009),console[_0x4d9a76(0x1ad)](_0x4d9a76(0x18d))):console[_0x4d9a76(0x1ad)]('Email\x20sent\x20successfully');}),_0x76da8c[_0x389c02(0x230)](_0x389c02(0x1cb),_0x389c02(0x1ac)),_0xe878c6['redirect'](_0x389c02(0x20c)+_0x349d32[_0x389c02(0x191)]);}catch(_0x2fbf9b){console['error'](_0x2fbf9b),_0xe878c6[_0x389c02(0x197)](0x1f4)[_0x389c02(0x22a)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x5b62a6=>{var _0x250855=_0x4bd153;console[_0x250855(0x219)](_0x5b62a6),_0xe878c6[_0x250855(0x197)](0x1f4)[_0x250855(0x22a)]({'error':_0x250855(0x255)});});}catch(_0x5c2d44){console[_0x4bd153(0x1ad)](_0x5c2d44),_0xe878c6['status'](0xc8)[_0x4bd153(0x22a)]({'message':_0x5c2d44[_0x4bd153(0x1cc)]});}}),router[a0_0x448212(0x24c)](a0_0x448212(0x1ed),auth,async(_0x354d07,_0x3ae34a)=>{var _0x10cc66=a0_0x448212;try{const {username:_0x46e6b5,email:_0xb41fa,role:_0x3eb73d}=_0x354d07[_0x10cc66(0x190)],_0x419459=_0x354d07['user'],_0x22598b=await profile[_0x10cc66(0x1d2)]({'email':_0x419459[_0x10cc66(0x22d)]}),_0x4c5f25=await master_shop[_0x10cc66(0x1b0)](),_0x3d1055=_0x354d07[_0x10cc66(0x222)]['id'],_0x57b7d6=await adjustment[_0x10cc66(0x201)]({'_id':_0x3d1055}),_0x31337b=await purchases[_0x10cc66(0x19c)]([{'$match':{'warehouse_name':_0x57b7d6[_0x10cc66(0x24a)]}},{'$unwind':_0x10cc66(0x24b)},{'$group':{'_id':'$product.product_name'}}]),_0x9c987b=await product[_0x10cc66(0x1b0)]({}),_0x25428e=await warehouse[_0x10cc66(0x19c)]([{'$match':{'name':_0x57b7d6['warehouse_name']}},{'$unwind':_0x10cc66(0x19a)},{'$group':{'_id':_0x10cc66(0x18f),'name':{'$first':_0x10cc66(0x1af)},'product_stock':{'$first':_0x10cc66(0x1c7)},'bay':{'$first':_0x10cc66(0x1dc)},'bin':{'$first':_0x10cc66(0x1ec)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x10cc66(0x243)},'primary_code':{'$first':_0x10cc66(0x24e)},'secondary_code':{'$first':_0x10cc66(0x1ea)},'product_code':{'$first':_0x10cc66(0x1b8)},'storage':{'$first':_0x10cc66(0x23c)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x10cc66(0x1a9)},'expiry_date':{'$first':_0x10cc66(0x1e0)},'production_date':{'$first':_0x10cc66(0x1b5)},'batch_code':{'$first':_0x10cc66(0x194)},'room':{'$first':_0x10cc66(0x1c8)}}}]);let _0x4069e7;if(_0x419459[_0x10cc66(0x193)]==_0x10cc66(0x1ca)){const _0x2d84a4=await staff[_0x10cc66(0x1d2)]({'email':_0x419459[_0x10cc66(0x22d)]});_0x4069e7=await warehouse['aggregate']([{'$match':{'status':_0x10cc66(0x221),'name':_0x2d84a4[_0x10cc66(0x1c2)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x10cc66(0x206)}}},{'$group':{'_id':'$name','name':{'$first':_0x10cc66(0x1c6)}}}]);}else _0x4069e7=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x10cc66(0x206)}}},{'$group':{'_id':'$name','name':{'$first':_0x10cc66(0x1c6)}}}]);if(_0x4c5f25[0x0][_0x10cc66(0x239)]==_0x10cc66(0x1cd)){var _0x356b3d=users[_0x10cc66(0x214)];console['log'](_0x356b3d);}else{if(_0x4c5f25[0x0]['language']==_0x10cc66(0x257))var _0x356b3d=users[_0x10cc66(0x257)];else{if(_0x4c5f25[0x0][_0x10cc66(0x239)]==_0x10cc66(0x205))var _0x356b3d=users['German'];else{if(_0x4c5f25[0x0][_0x10cc66(0x239)]==_0x10cc66(0x252))var _0x356b3d=users['Spanish'];else{if(_0x4c5f25[0x0]['language']=='French')var _0x356b3d=users['French'];else{if(_0x4c5f25[0x0][_0x10cc66(0x239)]=='Portuguese\x20(BR)')var _0x356b3d=users['Portuguese'];else{if(_0x4c5f25[0x0][_0x10cc66(0x239)]==_0x10cc66(0x1f0))var _0x356b3d=users['Chinese'];else{if(_0x4c5f25[0x0][_0x10cc66(0x239)]=='Arabic\x20(ae)')var _0x356b3d=users[_0x10cc66(0x21f)];}}}}}}}_0x3ae34a['render'](_0x10cc66(0x20d),{'success':_0x354d07[_0x10cc66(0x230)]('success'),'errors':_0x354d07['flash'](_0x10cc66(0x24f)),'role':_0x419459,'profile':_0x22598b,'adjustment':_0x57b7d6,'stock':_0x25428e,'master_shop':_0x4c5f25,'warehouse_name':_0x31337b,'unit':_0x9c987b,'language':_0x356b3d,'warehouse':_0x4069e7});}catch(_0x1df005){console[_0x10cc66(0x1ad)](_0x1df005),_0x3ae34a['status'](0xc8)[_0x10cc66(0x22a)]({'message':_0x1df005[_0x10cc66(0x1cc)]});}}),router[a0_0x448212(0x1da)]('/view/:id',auth,async(_0x210390,_0x570ab4)=>{var _0x7792e9=a0_0x448212;try{const _0x1217ce=_0x210390[_0x7792e9(0x222)]['id'],_0x36e25e=await adjustment[_0x7792e9(0x201)]({'_id':_0x1217ce}),_0x3f46ce=await warehouse[_0x7792e9(0x1d2)]({'name':_0x36e25e['warehouse_name'],'room':_0x36e25e[_0x7792e9(0x200)]}),{warehouse_name:_0x29cbf6,date:_0x295f93,prod_name:_0x185601,level:_0xc8c2d9,isle:_0x4f39f9,pallet:_0x51fb0f,stock:_0x314c22,types:_0x44e1fb,adjust_qty:_0x1c4d9d,new_adjust_qty:_0x6587e1,note:_0x583c3f,Room_name:_0x223704,invoice:_0x36a63f,JO_number:_0x28d601,expiry_date:_0x2c47f0}=_0x210390[_0x7792e9(0x188)];if(typeof _0x185601==_0x7792e9(0x217))var _0x1a31cb=[_0x210390['body']['prod_name']],_0x34f36a=[_0x210390['body'][_0x7792e9(0x1e9)]],_0x331105=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x1f8)]],_0x389391=[_0x210390['body']['types']],_0x3bdcd1=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x1d0)]],_0x18c9df=[_0x210390[_0x7792e9(0x188)]['New_Qty_Converted']],_0x197e0f=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x1f4)]],_0x30f4ce=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x210)]],_0x37c5f7=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x1ab)]],_0x19284f=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x183)]],_0x3ba768=[_0x210390['body'][_0x7792e9(0x1f5)]],_0x139dd1=[_0x210390[_0x7792e9(0x188)]['max_per_unit']],_0x4a40d5=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x1bc)]],_0x2ecb4f=[_0x210390['body'][_0x7792e9(0x198)]],_0x24edb8=[_0x210390[_0x7792e9(0x188)][_0x7792e9(0x213)]],_0x5412c6=[_0x210390[_0x7792e9(0x188)]['prime1']],_0xe4de05=[_0x210390[_0x7792e9(0x188)]['second1']];else var _0x1a31cb=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x248)]],_0x34f36a=[..._0x210390['body'][_0x7792e9(0x1e9)]],_0x331105=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x1f8)]],_0x389391=[..._0x210390[_0x7792e9(0x188)]['types']],_0x3bdcd1=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x1d0)]],_0x18c9df=[..._0x210390['body']['New_Qty_Converted']],_0x197e0f=[..._0x210390['body']['unit']],_0x30f4ce=[..._0x210390['body']['Secondary_units']],_0x37c5f7=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x1ab)]],_0x19284f=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x183)]],_0x3ba768=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x1f5)]],_0x139dd1=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x20b)]],_0x4a40d5=[..._0x210390[_0x7792e9(0x188)]['production_date']],_0x2ecb4f=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x198)]],_0x24edb8=[..._0x210390[_0x7792e9(0x188)]['Rooms']],_0x5412c6=[..._0x210390[_0x7792e9(0x188)]['prime1']],_0xe4de05=[..._0x210390[_0x7792e9(0x188)][_0x7792e9(0x254)]];const _0x19bcc1=_0x1a31cb[_0x7792e9(0x22c)](_0xa36edd=>{return _0xa36edd={'product_name':_0xa36edd};});_0x34f36a[_0x7792e9(0x246)]((_0x4f736b,_0x277395)=>{var _0x3baae8=_0x7792e9;_0x24edb8[_0x3baae8(0x246)]((_0xb87b69,_0xa62349)=>{var _0x461290=_0x3baae8;if(_0xb87b69=='Receiving\x20Area'&&_0x277395==_0xa62349){var _0x5370cf=_0x4f736b['slice'](0x3);_0x19bcc1[_0x277395][_0x461290(0x23d)]=_0x4f736b[0x0],_0x19bcc1[_0x277395][_0x461290(0x192)]=_0x4f736b[0x1],_0x19bcc1[_0x277395][_0x461290(0x1d3)]=0x0,_0x19bcc1[_0x277395][_0x461290(0x20f)]=0x0,_0x19bcc1[_0x277395][_0x461290(0x231)]=_0x461290(0x1be),_0x19bcc1[_0x277395][_0x461290(0x236)]=_0x5370cf;}else{if(_0xb87b69==_0x461290(0x1fa)&&_0x277395==_0xa62349){var _0x5370cf=_0x4f736b[_0x461290(0x1ff)](0x3);_0x19bcc1[_0x277395][_0x461290(0x23d)]=_0x4f736b[0x0],_0x19bcc1[_0x277395][_0x461290(0x192)]=_0x4f736b[0x1],_0x19bcc1[_0x277395][_0x461290(0x1d3)]=0x0,_0x19bcc1[_0x277395][_0x461290(0x20f)]=0x0,_0x19bcc1[_0x277395][_0x461290(0x231)]=_0x461290(0x1be),_0x19bcc1[_0x277395][_0x461290(0x236)]=_0x4f736b[0x5];}else{if(_0x277395==_0xa62349){var _0xab7764;if(_0x4f736b[0x4]=='L')_0xab7764=_0x461290(0x207);else _0x4f736b[0x4]=='F'&&(_0xab7764=_0x461290(0x1be));_0x19bcc1[_0x277395][_0x461290(0x23d)]=_0x4f736b[0x0],_0x19bcc1[_0x277395][_0x461290(0x192)]=_0x4f736b[0x1],_0x19bcc1[_0x277395][_0x461290(0x1d3)]=_0x4f736b[0x2],_0x19bcc1[_0x277395][_0x461290(0x20f)]=_0x4f736b[0x3],_0x19bcc1[_0x277395]['type']=_0xab7764,_0x19bcc1[_0x277395][_0x461290(0x236)]=_0x4f736b[0x5];}}}});}),_0x331105[_0x7792e9(0x246)]((_0x4ff0a8,_0x2d7d52)=>{_0x19bcc1[_0x2d7d52]['stockBefore']=_0x4ff0a8;}),_0x389391[_0x7792e9(0x246)]((_0x3a1216,_0x261f21)=>{var _0x42d135=_0x7792e9;_0x19bcc1[_0x261f21][_0x42d135(0x1db)]=_0x3a1216;}),_0x3bdcd1['forEach']((_0x26ff16,_0x30aa87)=>{var _0x7f0927=_0x7792e9;_0x19bcc1[_0x30aa87][_0x7f0927(0x184)]=_0x26ff16;}),_0x18c9df[_0x7792e9(0x246)]((_0x7b333,_0x596cee)=>{var _0x2ea0eb=_0x7792e9;_0x19bcc1[_0x596cee][_0x2ea0eb(0x256)]=_0x7b333;}),_0x197e0f[_0x7792e9(0x246)]((_0x3b11c5,_0xcd27eb)=>{_0x19bcc1[_0xcd27eb]['unit']=_0x3b11c5;}),_0x30f4ce[_0x7792e9(0x246)]((_0x7c7f8d,_0x3ec419)=>{var _0x4306de=_0x7792e9;_0x19bcc1[_0x3ec419][_0x4306de(0x1ce)]=_0x7c7f8d;}),_0x37c5f7['forEach']((_0x599981,_0x2307ef)=>{var _0x3e6f78=_0x7792e9;_0x19bcc1[_0x2307ef][_0x3e6f78(0x1ef)]=_0x599981;}),_0x19284f[_0x7792e9(0x246)]((_0x5898b2,_0x82b578)=>{var _0x5a269a=_0x7792e9;_0x19bcc1[_0x82b578][_0x5a269a(0x183)]=_0x5898b2;}),_0x3ba768[_0x7792e9(0x246)]((_0x1d58f5,_0x84d716)=>{var _0x24a785=_0x7792e9;_0x19bcc1[_0x84d716][_0x24a785(0x1f5)]=_0x1d58f5;}),_0x139dd1[_0x7792e9(0x246)]((_0x4b5be4,_0x5e2a4b)=>{_0x19bcc1[_0x5e2a4b]['maxperunit']=_0x4b5be4;}),_0x4a40d5[_0x7792e9(0x246)]((_0x3eaf68,_0x413697)=>{var _0x4829d4=_0x7792e9;_0x19bcc1[_0x413697][_0x4829d4(0x1bc)]=_0x3eaf68;}),_0x2ecb4f['forEach']((_0x44a388,_0x2c2663)=>{var _0x4eb0e3=_0x7792e9;_0x19bcc1[_0x2c2663][_0x4eb0e3(0x198)]=_0x44a388;}),_0x24edb8[_0x7792e9(0x246)]((_0x49eca1,_0x4930c8)=>{var _0x281d0b=_0x7792e9;_0x19bcc1[_0x4930c8][_0x281d0b(0x202)]=_0x49eca1;}),_0x5412c6[_0x7792e9(0x246)]((_0x3310d2,_0x49546e)=>{var _0x978380=_0x7792e9;_0x19bcc1[_0x49546e][_0x978380(0x244)]=_0x3310d2;}),_0xe4de05[_0x7792e9(0x246)]((_0x43b062,_0x81d276)=>{var _0x34f7cd=_0x7792e9;_0x19bcc1[_0x81d276][_0x34f7cd(0x1bf)]=_0x43b062;});const _0x23fbb6=_0x19bcc1['filter'](_0x369b9e=>_0x369b9e[_0x7792e9(0x184)]!=='0'&&_0x369b9e[_0x7792e9(0x184)]!=='');var _0x5b6370=0x0;_0x23fbb6['forEach'](_0xf1614a=>{var _0x2b08fc=_0x7792e9;console[_0x2b08fc(0x1ad)](_0x2b08fc(0x1a2),_0xf1614a),parseInt(_0xf1614a[_0x2b08fc(0x184)])<=0x0&&_0x5b6370++;});if(_0x5b6370!=0x0)return _0x210390[_0x7792e9(0x230)](_0x7792e9(0x24f),_0x7792e9(0x21d)),_0x570ab4[_0x7792e9(0x1d9)](_0x7792e9(0x24d));_0x36e25e[_0x7792e9(0x24a)]=_0x29cbf6,_0x36e25e[_0x7792e9(0x233)]=_0x295f93,_0x36e25e['product']=_0x23fbb6,_0x36e25e['note']=_0x583c3f,_0x36e25e[_0x7792e9(0x1a1)]=_0x36a63f,_0x36e25e['isAllowEdit']='False';const _0x2cbf93=await _0x36e25e[_0x7792e9(0x238)]();_0x210390[_0x7792e9(0x230)]('success',_0x7792e9(0x187)),_0x570ab4[_0x7792e9(0x1d9)](_0x7792e9(0x23a));}catch(_0x155fdf){console['log'](_0x155fdf);}}),router[a0_0x448212(0x1da)]('/barcode_scanner',async(_0x3f7c42,_0xa77adb)=>{var _0x39efb8=a0_0x448212;const {primary_code:_0x384b1f,warehouse_data:_0x364d36,rooms_data:_0x1233e4,Roomslist:_0x49f31e}=_0x3f7c42['body'],_0x21e6b7=_0x49f31e[_0x39efb8(0x1d4)](','),_0x16aaa9=[];async function _0x4ca108(_0x3290d3){var _0x416c6a=_0x39efb8;const _0x5d0603=await warehouse[_0x416c6a(0x19c)]([{'$match':{'name':_0x364d36,'room':_0x3290d3}},{'$unwind':_0x416c6a(0x19a)},{'$match':{'product_details.primary_code':_0x384b1f}},{'$group':{'_id':_0x416c6a(0x18f),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x416c6a(0x1c7)},'primary_code':{'$first':_0x416c6a(0x24e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x416c6a(0x1b8)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x416c6a(0x1ec)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x416c6a(0x243)},'unit':{'$first':_0x416c6a(0x1e5)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x416c6a(0x23c)},'rack':{'$first':_0x416c6a(0x228)},'expiry_date':{'$first':_0x416c6a(0x1e0)},'production_date':{'$first':_0x416c6a(0x1b5)},'maxPerUnit':{'$first':_0x416c6a(0x1a9)},'batch_code':{'$first':_0x416c6a(0x194)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x3f0393=await warehouse[_0x416c6a(0x19c)]([{'$match':{'name':_0x364d36,'room':_0x3290d3}},{'$unwind':_0x416c6a(0x19a)},{'$match':{'product_details.secondary_code':_0x384b1f}},{'$group':{'_id':_0x416c6a(0x18f),'name':{'$first':_0x416c6a(0x1af)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x416c6a(0x1ea)},'product_code':{'$first':_0x416c6a(0x1b8)},'level':{'$first':_0x416c6a(0x1dc)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x416c6a(0x1e5)},'secondary_unit':{'$first':_0x416c6a(0x1b9)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x416c6a(0x228)},'expiry_date':{'$first':_0x416c6a(0x1e0)},'production_date':{'$first':_0x416c6a(0x1b5)},'maxPerUnit':{'$first':_0x416c6a(0x1a9)},'batch_code':{'$first':_0x416c6a(0x194)},'product_cat':{'$first':_0x416c6a(0x253)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x5d0603[_0x416c6a(0x1a3)]>0x0)_0x16aaa9[_0x416c6a(0x1e6)](_0x5d0603);else _0x3f0393[_0x416c6a(0x1a3)]>0x0&&_0x16aaa9[_0x416c6a(0x1e6)](_0x3f0393);}const _0x4330b9=_0x21e6b7[_0x39efb8(0x22c)](_0x312036=>_0x4ca108(_0x312036));await Promise[_0x39efb8(0x1b2)](_0x4330b9),_0xa77adb[_0x39efb8(0x22a)](_0x16aaa9);}),router['post']('/CheckingWarehouse',async(_0x3c666c,_0x454621)=>{var _0x222a8e=a0_0x448212;const {primaryCode:_0x1c3c16,secondaryCode:_0x383b74,productCode:_0x2e979a,level:_0x3124a8,isle:_0x4f1ca4,pallet:_0x66fda5,warehouses:_0x58a3f4,room:_0x2ac44a}=_0x3c666c[_0x222a8e(0x188)];try{const _0x1085cb=await warehouse[_0x222a8e(0x19c)]([{'$match':{'name':_0x58a3f4,'room':_0x2ac44a}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x3124a8),'product_details.isle':_0x4f1ca4,'product_details.pallet':parseInt(_0x66fda5)}},{'$group':{'_id':_0x222a8e(0x18f),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x222a8e(0x1d7)},'isle':{'$first':_0x222a8e(0x203)},'pallet':{'$first':_0x222a8e(0x22b)},'maxProducts':{'$first':_0x222a8e(0x1f2)}}}]);_0x454621['status'](0xc8)[_0x222a8e(0x22a)](_0x1085cb);}catch(_0x11f5fe){_0x454621[_0x222a8e(0x197)](0x194)['json']({'message':_0x11f5fe['message']});}}),module[a0_0x448212(0x1e3)]=router;