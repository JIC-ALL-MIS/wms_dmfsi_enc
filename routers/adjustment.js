var a0_0x476f49=a0_0xd6fd;(function(_0x590691,_0x3de34f){var _0x7a597=a0_0xd6fd,_0x1285fe=_0x590691();while(!![]){try{var _0x400535=-parseInt(_0x7a597(0x170))/0x1+parseInt(_0x7a597(0x1cb))/0x2*(parseInt(_0x7a597(0x130))/0x3)+-parseInt(_0x7a597(0x160))/0x4+parseInt(_0x7a597(0x198))/0x5*(-parseInt(_0x7a597(0x125))/0x6)+-parseInt(_0x7a597(0x1e6))/0x7*(-parseInt(_0x7a597(0x1e4))/0x8)+parseInt(_0x7a597(0x172))/0x9+parseInt(_0x7a597(0x15e))/0xa*(-parseInt(_0x7a597(0x127))/0xb);if(_0x400535===_0x3de34f)break;else _0x1285fe['push'](_0x1285fe['shift']());}catch(_0x2496bb){_0x1285fe['push'](_0x1285fe['shift']());}}}(a0_0x1efd,0x6e4cb));const express=require(a0_0x476f49(0x12c)),app=express(),router=express['Router'](),auth=require(a0_0x476f49(0x1be)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x476f49(0x1f1)),users=require(a0_0x476f49(0x1e8)),nodemailer=require(a0_0x476f49(0x157));router[a0_0x476f49(0x1a5)](a0_0x476f49(0x16d),auth,async(_0x1a8e35,_0x46673d)=>{var _0x3e33c3=a0_0x476f49;try{const {username:_0x56bbd9,email:_0x440632,role:_0x479f90}=_0x1a8e35['user'],_0x1854fe=_0x1a8e35[_0x3e33c3(0x15a)],_0x5d7ba3=await profile[_0x3e33c3(0x138)]({'email':_0x1854fe[_0x3e33c3(0x180)]}),_0x37eab9=await master_shop[_0x3e33c3(0x140)]();console[_0x3e33c3(0x1df)]('master',_0x37eab9);let _0x13b4ea;if(_0x1854fe[_0x3e33c3(0x1ba)]=='staff'){const _0x272158=await staff[_0x3e33c3(0x138)]({'email':_0x1854fe[_0x3e33c3(0x180)]});_0x13b4ea=await warehouse[_0x3e33c3(0x140)]({'status':_0x3e33c3(0x16e),'name':_0x272158['warehouse']});}else _0x13b4ea=await warehouse['find']({'status':_0x3e33c3(0x16e)});const _0x49a969=await product[_0x3e33c3(0x140)]();let _0x42df90;if(_0x1854fe['role']==_0x3e33c3(0x191)){const _0x396028=await staff['findOne']({'email':_0x1854fe[_0x3e33c3(0x180)]});_0x42df90=await adjustment['find']({'warehouse_name':_0x396028[_0x3e33c3(0x1e9)]});}else _0x42df90=await adjustment['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x3e33c3(0x16c),'invoice':{'$first':'$invoice'},'date':{'$first':_0x3e33c3(0x1c2)},'warehouse_name':{'$first':_0x3e33c3(0x137)},'room':{'$addToSet':_0x3e33c3(0x133)},'finalize':{'$first':_0x3e33c3(0x16b)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x37eab9[0x0][_0x3e33c3(0x1e5)]==_0x3e33c3(0x129)){var _0x49b98c=users[_0x3e33c3(0x1aa)];console['log'](_0x49b98c);}else{if(_0x37eab9[0x0][_0x3e33c3(0x1e5)]==_0x3e33c3(0x124))var _0x49b98c=users['Hindi'];else{if(_0x37eab9[0x0]['language']=='German')var _0x49b98c=users[_0x3e33c3(0x1c6)];else{if(_0x37eab9[0x0]['language']==_0x3e33c3(0x1f0))var _0x49b98c=users[_0x3e33c3(0x1f0)];else{if(_0x37eab9[0x0]['language']==_0x3e33c3(0x1b8))var _0x49b98c=users[_0x3e33c3(0x1b8)];else{if(_0x37eab9[0x0][_0x3e33c3(0x1e5)]==_0x3e33c3(0x19f))var _0x49b98c=users[_0x3e33c3(0x1d2)];else{if(_0x37eab9[0x0]['language']=='Chinese')var _0x49b98c=users[_0x3e33c3(0x166)];else{if(_0x37eab9[0x0]['language']=='Arabic\x20(ae)')var _0x49b98c=users['Arabic'];}}}}}}}_0x46673d[_0x3e33c3(0x18e)](_0x3e33c3(0x14d),{'success':_0x1a8e35[_0x3e33c3(0x1bf)](_0x3e33c3(0x15f)),'errors':_0x1a8e35[_0x3e33c3(0x1bf)](_0x3e33c3(0x12d)),'role':_0x1854fe,'profile':_0x5d7ba3,'warehouse':_0x13b4ea,'product':_0x49a969,'adjustment':_0x42df90,'master_shop':_0x37eab9,'language':_0x49b98c});}catch(_0x2e9891){console[_0x3e33c3(0x1df)](_0x2e9891);}});async function getRandom8DigitNumber(){var _0x965a7e=a0_0x476f49;const _0x246b48=0x989680,_0x2ef6af=0x5f5e0ff,_0x560876=Math[_0x965a7e(0x1ea)](Math['random']()*(_0x2ef6af-_0x246b48+0x1))+_0x246b48;var _0x41faa2;const _0x322e8a=await adjustment[_0x965a7e(0x138)]({'invoice':'ADJ-'+_0x560876});return _0x322e8a&&_0x322e8a[_0x965a7e(0x13f)]>0x0?_0x41faa2=_0x965a7e(0x1cf)+_0x560876:_0x41faa2=_0x965a7e(0x1cf)+_0x560876,_0x41faa2;}function a0_0x1efd(){var _0x12ecd7=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','id_transaction_from','isAllowEdit','Ambient','</head><body>','adjust_qty','/preview/:id','secondary_code','then','$product_details.product_name','post','/view/:id','French','redirect','role','bin','max_per_unit','logo','../middleware/auth','flash','$product_details.product_cat','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$date','product_code','</div>','/adjustment/view','German','$product_details.secondary_code','Email\x20sent\x20successfully','/barcode_scanner','type','978alSfvg','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','storage','Shelves','ADJ-','edit_adjustment','$product_details._id','Portuguese','Arabic','$product_details.batch_code','batch_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','room','$product_details.maxPerUnit','save','</td>','stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.pallet','$name','log','Level','$product_details','Error\x20Occurs','invoice','168iDvtUp','language','55531gOtRtl','all','../public/language/languages.json','warehouse','floor','/../public','createTransport','room_names','catch','$product_details.bay','Spanish','../models/all_models','host','</h5>','Rooms','Hindi','87102PYPkxo','Arabic\x20(ae)','238634FUtEDZ','new_adjust_qty','English\x20(US)','slice','<span\x20style=\x22float:\x20right;\x22>','express','errors','product','floorlevel','2823GkKSWa','image','maxperunit','$product.room_names','adjustment\x20add\x20successfull','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/upload/','$warehouse_name','findOne','$product_details.expiry_date','toString','product_details','padStart','</tr>','$product_details.bin','length','find','production_date','string','second1','<hr\x20class=\x22my-3\x22>','<!DOCTYPE\x20html>','Secondary_units','stockBefore','port','<tbody\x20style=\x22text-align:\x20center;\x22>','<html><head><title></title>','$product_details.type','level','adjustment','$product_details.rack','warehouse_name','$product_details.product_code','</table>','Return\x20Rooms','New_Qty_Converted','$product','types','$product.product_name','nodemailer','<div>','add_adjustment','user','$product_details.storage','$product_details.secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','310IhysAp','success','359812nTHJKJ','primary_code','<h5\x20style=\x22text-align:\x20left;\x22>','<strong>\x20Regards\x20</strong>','body','back','Chinese','New_Qty_Converted_adj','Receiving\x20Area','findById','minus','$finalize','$_id','/view','Enabled','rack','126704qFGOnl','$product_details.isle','7473168LvzNis','status','/CheckingWarehouse','product_name','There\x27s\x20a\x20error\x20in\x20this\x20transaction','prod_code','Enclosed','_id','date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','aggregate','Primary_Units','params','forEach','email','push','product_stock','message','\x20Order\x20Date\x20:\x20','$room','$product_details.product_stock','adjustment\x20Finalized\x20successfully','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','map','$product_details.floorlevel','</tbody>','prod_invoice','render','json','Return\x20Goods','staff','/view/add_adjustment','$product_details.unit','Floor','prod_name','$product_details.invoice','exports','40cdPMle','site_title','expiry_date','True','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.production_date','$product_details.primary_code','Portuguese\x20(BR)','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','unit','id_transaction','prime1','get','secondary_unit','foreach\x20newproduct','error','Raw\x20Materials','English'];a0_0x1efd=function(){return _0x12ecd7;};return a0_0x1efd();}function a0_0xd6fd(_0x1eea37,_0x4edf15){var _0x1efdcc=a0_0x1efd();return a0_0xd6fd=function(_0xd6fd17,_0x1b4e08){_0xd6fd17=_0xd6fd17-0x122;var _0x3a6805=_0x1efdcc[_0xd6fd17];return _0x3a6805;},a0_0xd6fd(_0x1eea37,_0x4edf15);}router[a0_0x476f49(0x1a5)]('/view/add_adjustment',auth,async(_0x2e467e,_0x3d1e78)=>{var _0x62f662=a0_0x476f49;try{const {username:_0x83deae,email:_0x325ca2,role:_0x45c252}=_0x2e467e['user'],_0x3d11bf=_0x2e467e[_0x62f662(0x15a)],_0x459c89=await profile[_0x62f662(0x138)]({'email':_0x3d11bf[_0x62f662(0x180)]}),_0x228458=await master_shop[_0x62f662(0x140)]();let _0x76187f;if(_0x3d11bf['role']=='staff'){const _0x45ba86=await staff[_0x62f662(0x138)]({'email':_0x3d11bf[_0x62f662(0x180)]});_0x76187f=await warehouse[_0x62f662(0x17c)]([{'$match':{'status':_0x62f662(0x16e),'name':_0x45ba86[_0x62f662(0x1e9)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x62f662(0x190)}}},{'$group':{'_id':'$name','name':{'$first':_0x62f662(0x1de)}}}]);}else _0x76187f=await warehouse[_0x62f662(0x17c)]([{'$match':{'status':_0x62f662(0x16e),'warehouse_category':_0x62f662(0x1a9),'name':{'$ne':_0x62f662(0x190)}}},{'$group':{'_id':_0x62f662(0x1de),'name':{'$first':_0x62f662(0x1de)}}}]);const _0x2beebf=await product[_0x62f662(0x140)]({}),_0x17515d=await adjustment[_0x62f662(0x140)]({}),_0x8cd349=_0x17515d[_0x62f662(0x13f)]+0x1,_0x3d1f27=_0x62f662(0x1cf)+_0x8cd349[_0x62f662(0x13a)]()[_0x62f662(0x13c)](0x5,'0');var _0x271893=[_0x62f662(0x1af),_0x62f662(0x178),_0x62f662(0x152)];if(_0x228458[0x0][_0x62f662(0x1e5)]==_0x62f662(0x129))var _0x52b30b=users[_0x62f662(0x1aa)];else{if(_0x228458[0x0]['language']==_0x62f662(0x124))var _0x52b30b=users['Hindi'];else{if(_0x228458[0x0]['language']==_0x62f662(0x1c6))var _0x52b30b=users[_0x62f662(0x1c6)];else{if(_0x228458[0x0][_0x62f662(0x1e5)]==_0x62f662(0x1f0))var _0x52b30b=users['Spanish'];else{if(_0x228458[0x0][_0x62f662(0x1e5)]==_0x62f662(0x1b8))var _0x52b30b=users[_0x62f662(0x1b8)];else{if(_0x228458[0x0][_0x62f662(0x1e5)]==_0x62f662(0x19f))var _0x52b30b=users[_0x62f662(0x1d2)];else{if(_0x228458[0x0]['language']==_0x62f662(0x166))var _0x52b30b=users[_0x62f662(0x166)];else{if(_0x228458[0x0]['language']==_0x62f662(0x126))var _0x52b30b=users['Arabic'];}}}}}}}const _0x5d94e8=getRandom8DigitNumber();_0x5d94e8[_0x62f662(0x1b4)](_0x4106ea=>{var _0x1e2c7e=_0x62f662;_0x3d1e78[_0x1e2c7e(0x18e)](_0x1e2c7e(0x159),{'success':_0x2e467e['flash'](_0x1e2c7e(0x15f)),'errors':_0x2e467e['flash'](_0x1e2c7e(0x12d)),'role':_0x3d11bf,'profile':_0x459c89,'warehouse':_0x76187f,'product':_0x2beebf,'master_shop':_0x228458,'language':_0x52b30b,'rooms_data':_0x271893,'invoice_no':_0x4106ea});})[_0x62f662(0x1ee)](_0x2ed02f=>{var _0x4567f5=_0x62f662;_0x2e467e[_0x4567f5(0x1bf)]('errors',_0x4567f5(0x176)),_0x3d1e78[_0x4567f5(0x1b9)](_0x4567f5(0x1c5));});}catch(_0x12e93c){console['log'](_0x12e93c);}}),router[a0_0x476f49(0x1b6)](a0_0x476f49(0x192),auth,async(_0x45df3f,_0x3f38c8)=>{var _0x5a858d=a0_0x476f49;try{const {warehouse_name:_0x24aaad,date:_0x2bb65d,prod_name:_0x1f1749,level:_0x4f030e,isle:_0x193cfb,pallet:_0x2faebe,stock:_0x52f18c,types:_0x3ed5f2,adjust_qty:_0x2d5963,new_adjust_qty:_0x5ecdfc,note:_0x3f5d8e,Room_name:_0x345722,invoice:_0x2475f2,JO_number:_0x1bd36d,expiry_date:_0x51a1b0}=_0x45df3f[_0x5a858d(0x164)];if(typeof _0x1f1749=='string')var _0x30a2e9=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x195)]],_0xe92302=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x14c)]],_0x340fab=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x1db)]],_0x196586=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x155)]],_0x4f38a6=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x167)]],_0x5b2ada=[_0x45df3f['body'][_0x5a858d(0x153)]],_0x39a6a3=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x17d)]],_0x318826=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x146)]],_0x5ad8a9=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x177)]],_0x2c5e30=[_0x45df3f[_0x5a858d(0x164)]['batch_code']],_0x20b6b5=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x19a)]],_0x56591b=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x1bc)]],_0x185169=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x141)]],_0x409891=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x188)]],_0x1e4107=[_0x45df3f['body'][_0x5a858d(0x123)]],_0x2f066c=[_0x45df3f[_0x5a858d(0x164)]['prime1']],_0x340e48=[_0x45df3f[_0x5a858d(0x164)]['second1']],_0x2cc577=[_0x45df3f['body'][_0x5a858d(0x18d)]],_0x4d17b5=[_0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x1a3)]];else var _0x30a2e9=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x195)]],_0xe92302=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x14c)]],_0x340fab=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x1db)]],_0x196586=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x155)]],_0x4f38a6=[..._0x45df3f[_0x5a858d(0x164)]['New_Qty_Converted_adj']],_0x5b2ada=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x153)]],_0x39a6a3=[..._0x45df3f[_0x5a858d(0x164)]['unit']],_0x318826=[..._0x45df3f[_0x5a858d(0x164)]['Secondary_units']],_0x5ad8a9=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x177)]],_0x2c5e30=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x1d5)]],_0x20b6b5=[..._0x45df3f[_0x5a858d(0x164)]['expiry_date']],_0x56591b=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x1bc)]],_0x185169=[..._0x45df3f[_0x5a858d(0x164)]['production_date']],_0x409891=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x188)]],_0x1e4107=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x123)]],_0x2f066c=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x1a4)]],_0x340e48=[..._0x45df3f[_0x5a858d(0x164)][_0x5a858d(0x143)]],_0x2cc577=[..._0x45df3f['body'][_0x5a858d(0x18d)]],_0x4d17b5=[..._0x45df3f['body']['id_transaction']];const _0xdb089=_0x30a2e9[_0x5a858d(0x18a)](_0x5aadd7=>{return _0x5aadd7={'product_name':_0x5aadd7};});_0xe92302[_0x5a858d(0x17f)]((_0x4af10a,_0x1081a1)=>{_0x1e4107['forEach']((_0x135c53,_0x3cd873)=>{var _0x2495fe=a0_0xd6fd;if(_0x135c53==_0x2495fe(0x168)&&_0x1081a1==_0x3cd873){var _0x5db8aa=_0x4af10a[_0x2495fe(0x12a)](0x3);_0xdb089[_0x1081a1][_0x2495fe(0x1cd)]=_0x4af10a[0x0],_0xdb089[_0x1081a1][_0x2495fe(0x16f)]=_0x4af10a[0x1],_0xdb089[_0x1081a1][_0x2495fe(0x1a0)]=0x0,_0xdb089[_0x1081a1][_0x2495fe(0x1bb)]=0x0,_0xdb089[_0x1081a1][_0x2495fe(0x1ca)]='Floor',_0xdb089[_0x1081a1][_0x2495fe(0x12f)]=_0x5db8aa;}else{if(_0x135c53==_0x2495fe(0x1ce)&&_0x1081a1==_0x3cd873){var _0x5db8aa=_0x4af10a[_0x2495fe(0x12a)](0x3);_0xdb089[_0x1081a1]['storage']=_0x4af10a[0x0],_0xdb089[_0x1081a1][_0x2495fe(0x16f)]=_0x4af10a[0x1],_0xdb089[_0x1081a1][_0x2495fe(0x1a0)]=0x0,_0xdb089[_0x1081a1]['bin']=0x0,_0xdb089[_0x1081a1][_0x2495fe(0x1ca)]=_0x2495fe(0x194),_0xdb089[_0x1081a1][_0x2495fe(0x12f)]=_0x4af10a[0x5];}else{if(_0x1081a1==_0x3cd873){var _0x350d9c;if(_0x4af10a[0x4]=='L')_0x350d9c=_0x2495fe(0x1e0);else _0x4af10a[0x4]=='F'&&(_0x350d9c='Floor');_0xdb089[_0x1081a1][_0x2495fe(0x1cd)]=_0x4af10a[0x0],_0xdb089[_0x1081a1][_0x2495fe(0x16f)]=_0x4af10a[0x1],_0xdb089[_0x1081a1][_0x2495fe(0x1a0)]=_0x4af10a[0x2],_0xdb089[_0x1081a1][_0x2495fe(0x1bb)]=_0x4af10a[0x3],_0xdb089[_0x1081a1]['type']=_0x350d9c,_0xdb089[_0x1081a1][_0x2495fe(0x12f)]=_0x4af10a[0x5];}}}});}),_0x340fab[_0x5a858d(0x17f)]((_0x52eb34,_0x2036ec)=>{var _0x3a941c=_0x5a858d;_0xdb089[_0x2036ec][_0x3a941c(0x147)]=_0x52eb34;}),_0x4d17b5[_0x5a858d(0x17f)]((_0x59b0b3,_0x258ea5)=>{var _0x11fb27=_0x5a858d;_0xdb089[_0x258ea5][_0x11fb27(0x1ad)]=_0x59b0b3;}),_0x196586[_0x5a858d(0x17f)]((_0x4fd86a,_0x50d0c0)=>{var _0x3dd040=_0x5a858d;_0xdb089[_0x50d0c0][_0x3dd040(0x155)]=_0x4fd86a;}),_0x4f38a6[_0x5a858d(0x17f)]((_0x144494,_0x5a00d6)=>{var _0x33910b=_0x5a858d;_0xdb089[_0x5a00d6][_0x33910b(0x1b1)]=_0x144494;}),_0x5b2ada['forEach']((_0x57dc14,_0x382486)=>{_0xdb089[_0x382486]['new_adjust_qty']=_0x57dc14;}),_0x39a6a3[_0x5a858d(0x17f)]((_0xf16b27,_0x24d81e)=>{var _0x181987=_0x5a858d;_0xdb089[_0x24d81e][_0x181987(0x1a2)]=_0xf16b27;}),_0x318826[_0x5a858d(0x17f)]((_0xedc4f9,_0x6af510)=>{_0xdb089[_0x6af510]['secondary_unit']=_0xedc4f9;}),_0x5ad8a9['forEach']((_0x314ed5,_0x5950b6)=>{var _0x3ee915=_0x5a858d;_0xdb089[_0x5950b6][_0x3ee915(0x1c3)]=_0x314ed5;}),_0x2c5e30[_0x5a858d(0x17f)]((_0x512221,_0x354b73)=>{var _0x31a912=_0x5a858d;_0xdb089[_0x354b73][_0x31a912(0x1d5)]=_0x512221;}),_0x20b6b5[_0x5a858d(0x17f)]((_0x3e646e,_0x354e2a)=>{var _0x1f19cf=_0x5a858d;_0xdb089[_0x354e2a][_0x1f19cf(0x19a)]=_0x3e646e;}),_0x56591b[_0x5a858d(0x17f)]((_0x4a40f3,_0x56a269)=>{var _0x376855=_0x5a858d;_0xdb089[_0x56a269][_0x376855(0x132)]=_0x4a40f3;}),_0x185169[_0x5a858d(0x17f)]((_0xd8a9ff,_0x301cf7)=>{var _0x214ee3=_0x5a858d;_0xdb089[_0x301cf7][_0x214ee3(0x141)]=_0xd8a9ff;}),_0x409891[_0x5a858d(0x17f)]((_0x153c85,_0x345480)=>{var _0x46ce53=_0x5a858d;_0xdb089[_0x345480][_0x46ce53(0x188)]=_0x153c85;}),_0x1e4107[_0x5a858d(0x17f)]((_0x3f84f8,_0x811d39)=>{_0xdb089[_0x811d39]['room_names']=_0x3f84f8;}),_0x2f066c[_0x5a858d(0x17f)]((_0x15ec03,_0x50aa15)=>{var _0x42004f=_0x5a858d;_0xdb089[_0x50aa15][_0x42004f(0x161)]=_0x15ec03;}),_0x340e48[_0x5a858d(0x17f)]((_0x4fcde8,_0x12e24f)=>{var _0x5816ad=_0x5a858d;_0xdb089[_0x12e24f][_0x5816ad(0x1b3)]=_0x4fcde8;}),_0x2cc577[_0x5a858d(0x17f)]((_0x1f4ca5,_0x5a75d6)=>{var _0x1645c0=_0x5a858d;_0xdb089[_0x5a75d6][_0x1645c0(0x1e3)]=_0x1f4ca5;});const _0x4ceab7=_0xdb089['filter'](_0x4f86f5=>_0x4f86f5[_0x5a858d(0x1b1)]!=='0'&&_0x4f86f5[_0x5a858d(0x1b1)]!=='');var _0x15e66c=0x0;_0x4ceab7[_0x5a858d(0x17f)](_0x2ef31d=>{var _0x153d46=_0x5a858d;console[_0x153d46(0x1df)](_0x153d46(0x1a7),_0x2ef31d),parseInt(_0x2ef31d[_0x153d46(0x1b1)])<=0x0&&_0x15e66c++;});if(_0x15e66c!=0x0)return _0x45df3f[_0x5a858d(0x1bf)](_0x5a858d(0x12d),_0x5a858d(0x1c1)),_0x3f38c8['redirect'](_0x5a858d(0x165));const _0x42dba4=new adjustment({'warehouse_name':_0x24aaad,'date':_0x2bb65d,'product':_0x4ceab7,'note':_0x3f5d8e,'room':_0x345722,'invoice':_0x2475f2,'JO_number':_0x1bd36d,'expiry_date':_0x51a1b0}),_0x367a0b=await _0x42dba4[_0x5a858d(0x1d9)]();_0x45df3f['flash'](_0x5a858d(0x15f),_0x5a858d(0x134)),_0x3f38c8[_0x5a858d(0x1b9)]('/adjustment/preview/'+_0x367a0b[_0x5a858d(0x179)]);}catch(_0x1adee1){console[_0x5a858d(0x1df)](_0x1adee1),_0x3f38c8['status'](0xc8)['json']({'message':_0x1adee1[_0x5a858d(0x183)]});}}),router[a0_0x476f49(0x1a5)](a0_0x476f49(0x1b2),auth,async(_0x37b063,_0x58a6cf)=>{var _0x3213dc=a0_0x476f49;try{const {username:_0x361f44,email:_0x5b908a,role:_0x2cdada}=_0x37b063[_0x3213dc(0x15a)],_0x3513ff=_0x37b063[_0x3213dc(0x15a)],_0x47a444=await profile[_0x3213dc(0x138)]({'email':_0x3513ff[_0x3213dc(0x180)]}),_0x2637db=await master_shop['find'](),_0x364364=_0x37b063[_0x3213dc(0x17e)]['id'],_0x5cf58b=await adjustment[_0x3213dc(0x169)]({'_id':_0x364364}),_0x539022=await purchases['aggregate']([{'$match':{'warehouse_name':_0x5cf58b['warehouse_name']}},{'$unwind':_0x3213dc(0x154)},{'$group':{'_id':_0x3213dc(0x156)}}]),_0x211671=await product[_0x3213dc(0x140)]({}),_0xa10c9c=await warehouse[_0x3213dc(0x17c)]([{'$match':{'name':_0x5cf58b[_0x3213dc(0x14f)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3213dc(0x186)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3213dc(0x18b)},'primary_code':{'$first':_0x3213dc(0x19e)},'secondary_code':{'$first':_0x3213dc(0x1c7)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x3213dc(0x139)},'production_date':{'$first':_0x3213dc(0x19d)},'batch_code':{'$first':_0x3213dc(0x1d4)},'room':{'$first':_0x3213dc(0x185)}}}]);if(_0x2637db[0x0][_0x3213dc(0x1e5)]==_0x3213dc(0x129)){var _0x22928e=users[_0x3213dc(0x1aa)];console[_0x3213dc(0x1df)](_0x22928e);}else{if(_0x2637db[0x0][_0x3213dc(0x1e5)]==_0x3213dc(0x124))var _0x22928e=users['Hindi'];else{if(_0x2637db[0x0][_0x3213dc(0x1e5)]==_0x3213dc(0x1c6))var _0x22928e=users[_0x3213dc(0x1c6)];else{if(_0x2637db[0x0][_0x3213dc(0x1e5)]=='Spanish')var _0x22928e=users['Spanish'];else{if(_0x2637db[0x0][_0x3213dc(0x1e5)]==_0x3213dc(0x1b8))var _0x22928e=users[_0x3213dc(0x1b8)];else{if(_0x2637db[0x0]['language']=='Portuguese\x20(BR)')var _0x22928e=users[_0x3213dc(0x1d2)];else{if(_0x2637db[0x0]['language']==_0x3213dc(0x166))var _0x22928e=users['Chinese'];else{if(_0x2637db[0x0][_0x3213dc(0x1e5)]==_0x3213dc(0x126))var _0x22928e=users['Arabic'];}}}}}}}_0x58a6cf[_0x3213dc(0x18e)]('edit_adjustment_view',{'success':_0x37b063[_0x3213dc(0x1bf)](_0x3213dc(0x15f)),'errors':_0x37b063[_0x3213dc(0x1bf)]('errors'),'role':_0x3513ff,'profile':_0x47a444,'adjustment':_0x5cf58b,'stock':_0xa10c9c,'master_shop':_0x2637db,'warehouse_name':_0x539022,'unit':_0x211671,'language':_0x22928e});}catch(_0x2c014e){console['log'](_0x2c014e),_0x58a6cf['status'](0xc8)[_0x3213dc(0x18f)]({'message':_0x2c014e[_0x3213dc(0x183)]});}}),router['post'](a0_0x476f49(0x1b2),auth,async(_0x3ff581,_0x389ba9)=>{var _0x138752=a0_0x476f49;try{const _0x389b1d=_0x3ff581[_0x138752(0x17e)]['id'],{warehouse_name:_0x2a0fe0,Room_name:_0x417880}=_0x3ff581[_0x138752(0x164)],_0x46cda4=await adjustment['findById']({'_id':_0x389b1d}),_0x443796=_0x46cda4[_0x138752(0x12e)][_0x138752(0x18a)](async _0x374a7a=>{var _0x29ee89=_0x138752;if(_0x374a7a['adjust_qty']>0x0){var _0x31c454=await warehouse['findOne']({'name':_0x2a0fe0,'room':_0x374a7a[_0x29ee89(0x1ed)],'warehouse_category':'Raw\x20Materials'});const _0x40a5b7=_0x31c454[_0x29ee89(0x13b)][_0x29ee89(0x18a)](_0x33745a=>{var _0x33d49f=_0x29ee89;console[_0x33d49f(0x1df)](_0x374a7a[_0x33d49f(0x155)]+'\x20<>\x20');if(_0x374a7a['types']==_0x33d49f(0x16a)){if(_0x33745a['product_name']==_0x374a7a[_0x33d49f(0x175)]&&_0x33745a[_0x33d49f(0x12f)]==_0x374a7a[_0x33d49f(0x12f)]&&_0x33745a[_0x33d49f(0x1ca)]==_0x374a7a[_0x33d49f(0x1ca)]&&_0x33745a['bin']==_0x374a7a[_0x33d49f(0x1bb)]&&_0x33745a['bay']==_0x374a7a[_0x33d49f(0x1a0)]&&_0x33745a[_0x33d49f(0x16f)]==_0x374a7a[_0x33d49f(0x16f)]&&_0x33745a[_0x33d49f(0x1cd)]==_0x374a7a['storage']&&_0x33745a['expiry_date']==_0x374a7a[_0x33d49f(0x19a)]&&_0x33745a[_0x33d49f(0x1d5)]==_0x374a7a[_0x33d49f(0x1d5)]&&_0x33745a[_0x33d49f(0x141)]==_0x374a7a[_0x33d49f(0x141)]&&_0x33745a['invoice']==_0x374a7a['invoice']&&_0x33745a[_0x33d49f(0x179)]==_0x374a7a[_0x33d49f(0x1ad)]){var _0x1175d7;_0x1175d7=_0x374a7a[_0x33d49f(0x1b1)],_0x374a7a['prod_cat']=='S'&&(_0x1175d7=_0x374a7a[_0x33d49f(0x1b1)]),_0x33745a[_0x33d49f(0x182)]=_0x33745a[_0x33d49f(0x182)]-_0x1175d7;}}else{if(_0x33745a['product_name']==_0x374a7a['product_name']&&_0x33745a[_0x33d49f(0x12f)]==_0x374a7a[_0x33d49f(0x12f)]&&_0x33745a[_0x33d49f(0x1ca)]==_0x374a7a['type']&&_0x33745a['bin']==_0x374a7a[_0x33d49f(0x1bb)]&&_0x33745a[_0x33d49f(0x1a0)]==_0x374a7a['bay']&&_0x33745a['rack']==_0x374a7a[_0x33d49f(0x16f)]&&_0x33745a['storage']==_0x374a7a[_0x33d49f(0x1cd)]&&_0x33745a['expiry_date']==_0x374a7a[_0x33d49f(0x19a)]&&_0x33745a[_0x33d49f(0x1d5)]==_0x374a7a[_0x33d49f(0x1d5)]&&_0x33745a[_0x33d49f(0x141)]==_0x374a7a[_0x33d49f(0x141)]&&_0x33745a[_0x33d49f(0x1e3)]==_0x374a7a[_0x33d49f(0x1e3)]&&_0x33745a[_0x33d49f(0x179)]==_0x374a7a['id_transaction_from']){console[_0x33d49f(0x1df)](_0x374a7a);var _0x1175d7;_0x1175d7=_0x374a7a['adjust_qty'],_0x374a7a['prod_cat']=='S'&&(_0x1175d7=_0x374a7a[_0x33d49f(0x1b1)]),_0x33745a[_0x33d49f(0x182)]=_0x33745a[_0x33d49f(0x182)]+_0x1175d7;}}});}return _0x31c454;});Promise['all'](_0x443796)[_0x138752(0x1b4)](async _0x5c81a8=>{var _0x10ab0a=_0x138752;try{for(const _0x177961 of _0x5c81a8){await _0x177961[_0x10ab0a(0x1d9)]();}_0x46cda4['finalize']=_0x10ab0a(0x19b);const _0x4125b0=await _0x46cda4['save'](),_0x30d246=await master_shop[_0x10ab0a(0x140)](),_0x597bf9=await email_settings['findOne'](),_0x5c6ff6=await supervisor_settings[_0x10ab0a(0x140)]();var _0x3a44a6=_0x46cda4['product'],_0x590b1f='',_0x30ea9c;for(_0x30ea9c in _0x3a44a6){_0x590b1f+='<tr>'+_0x10ab0a(0x17b)+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x175)]+'</td>'+_0x10ab0a(0x17b)+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1c3)]+_0x10ab0a(0x1da)+_0x10ab0a(0x17b)+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1b1)]+'</td>'+_0x10ab0a(0x17b)+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1a2)]+_0x10ab0a(0x1da)+_0x10ab0a(0x17b)+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1a6)]+'</td>'+_0x10ab0a(0x17b)+_0x46cda4['warehouse_name']+_0x10ab0a(0x1da)+_0x10ab0a(0x17b)+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1ed)]+_0x10ab0a(0x1da)+_0x10ab0a(0x17b)+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1cd)]+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x16f)]+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1a0)]+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1bb)]+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x1ca)][0x0]+_0x3a44a6[_0x30ea9c][_0x10ab0a(0x12f)]+_0x10ab0a(0x1da),_0x10ab0a(0x13d);}let _0x3c6c3f=nodemailer[_0x10ab0a(0x1ec)]({'host':_0x597bf9[_0x10ab0a(0x1f2)],'port':Number(_0x597bf9[_0x10ab0a(0x148)]),'secure':![],'auth':{'user':_0x597bf9[_0x10ab0a(0x180)],'pass':_0x597bf9['password']}}),_0x2da7ca={'from':_0x597bf9[_0x10ab0a(0x180)],'to':_0x5c6ff6[0x0]['RMSEmail'],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x10ab0a(0x1eb)+_0x10ab0a(0x136)+_0x30d246[0x0][_0x10ab0a(0x131)],'cid':_0x10ab0a(0x1bd)}],'html':_0x10ab0a(0x145)+_0x10ab0a(0x14a)+_0x10ab0a(0x1b0)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x10ab0a(0x135)+_0x10ab0a(0x1c4)+_0x10ab0a(0x158)+'<h2>\x20'+_0x30d246[0x0][_0x10ab0a(0x199)]+'\x20</h2>'+_0x10ab0a(0x1c4)+_0x10ab0a(0x1c4)+_0x10ab0a(0x144)+_0x10ab0a(0x158)+_0x10ab0a(0x162)+'\x20Order\x20Number\x20:\x20'+_0x46cda4[_0x10ab0a(0x1e3)]+'\x20'+_0x10ab0a(0x12b)+_0x10ab0a(0x184)+_0x46cda4[_0x10ab0a(0x17a)]+'\x20'+'</span>'+_0x10ab0a(0x122)+'</div>'+_0x10ab0a(0x1d6)+_0x10ab0a(0x1ac)+'<tr>'+_0x10ab0a(0x189)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x10ab0a(0x1dc)+_0x10ab0a(0x1a1)+_0x10ab0a(0x15d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x10ab0a(0x1cc)+_0x10ab0a(0x1ab)+_0x10ab0a(0x13d)+'</thead>'+_0x10ab0a(0x149)+'\x20'+_0x590b1f+'\x20'+_0x10ab0a(0x18c)+_0x10ab0a(0x151)+'<div>'+_0x10ab0a(0x163)+'<h5>'+_0x30d246[0x0][_0x10ab0a(0x199)]+_0x10ab0a(0x122)+_0x10ab0a(0x1c4)+'</div>'+'</body></html>'};_0x3c6c3f['sendMail'](_0x2da7ca,function(_0x351909,_0x2a3708){var _0x44cc18=_0x10ab0a;_0x351909?(console[_0x44cc18(0x1df)](_0x351909),console[_0x44cc18(0x1df)](_0x44cc18(0x1e2))):console[_0x44cc18(0x1df)](_0x44cc18(0x1c8));}),_0x3ff581['flash']('success',_0x10ab0a(0x187)),_0x389ba9[_0x10ab0a(0x1b9)]('/picking_list/PDF_adjustment_rm/'+_0x4125b0[_0x10ab0a(0x179)]);}catch(_0xd10a9a){console[_0x10ab0a(0x1a8)](_0xd10a9a),_0x389ba9[_0x10ab0a(0x173)](0x1f4)[_0x10ab0a(0x18f)]({'error':_0x10ab0a(0x19c)});}})['catch'](_0x175eb5=>{var _0x468a47=_0x138752;console['error'](_0x175eb5),_0x389ba9[_0x468a47(0x173)](0x1f4)[_0x468a47(0x18f)]({'error':'An\x20error\x20occurred.'});});}catch(_0x2ef0bd){console[_0x138752(0x1df)](_0x2ef0bd),_0x389ba9[_0x138752(0x173)](0xc8)['json']({'message':_0x2ef0bd['message']});}}),router['get'](a0_0x476f49(0x1b7),auth,async(_0x282e21,_0x28721e)=>{var _0x5ab4a5=a0_0x476f49;try{const {username:_0x5dae31,email:_0x142dea,role:_0x2e3490}=_0x282e21[_0x5ab4a5(0x15a)],_0x34d46f=_0x282e21[_0x5ab4a5(0x15a)],_0x9394b2=await profile['findOne']({'email':_0x34d46f[_0x5ab4a5(0x180)]}),_0x394522=await master_shop[_0x5ab4a5(0x140)](),_0xd7de82=_0x282e21[_0x5ab4a5(0x17e)]['id'],_0x10b0ea=await adjustment[_0x5ab4a5(0x169)]({'_id':_0xd7de82}),_0x4d513a=await purchases[_0x5ab4a5(0x17c)]([{'$match':{'warehouse_name':_0x10b0ea[_0x5ab4a5(0x14f)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5ab4a5(0x156)}}]),_0x126175=await product['find']({}),_0x218576=await warehouse[_0x5ab4a5(0x17c)]([{'$match':{'name':_0x10b0ea[_0x5ab4a5(0x14f)]}},{'$unwind':_0x5ab4a5(0x1e1)},{'$group':{'_id':_0x5ab4a5(0x1d1),'name':{'$first':_0x5ab4a5(0x1b5)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5ab4a5(0x1ef)},'bin':{'$first':_0x5ab4a5(0x13e)},'type':{'$first':_0x5ab4a5(0x14b)},'floorlevel':{'$first':_0x5ab4a5(0x18b)},'primary_code':{'$first':_0x5ab4a5(0x19e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5ab4a5(0x150)},'storage':{'$first':_0x5ab4a5(0x15b)},'rack':{'$first':_0x5ab4a5(0x14e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5ab4a5(0x19d)},'batch_code':{'$first':_0x5ab4a5(0x1d4)},'room':{'$first':_0x5ab4a5(0x185)}}}]);let _0x296f41;if(_0x34d46f[_0x5ab4a5(0x1ba)]==_0x5ab4a5(0x191)){const _0x9c47d9=await staff['findOne']({'email':_0x34d46f[_0x5ab4a5(0x180)]});_0x296f41=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x9c47d9[_0x5ab4a5(0x1e9)],'warehouse_category':_0x5ab4a5(0x1a9),'name':{'$ne':_0x5ab4a5(0x190)}}},{'$group':{'_id':_0x5ab4a5(0x1de),'name':{'$first':_0x5ab4a5(0x1de)}}}]);}else _0x296f41=await warehouse[_0x5ab4a5(0x17c)]([{'$match':{'status':'Enabled','warehouse_category':_0x5ab4a5(0x1a9),'name':{'$ne':_0x5ab4a5(0x190)}}},{'$group':{'_id':'$name','name':{'$first':_0x5ab4a5(0x1de)}}}]);if(_0x394522[0x0][_0x5ab4a5(0x1e5)]==_0x5ab4a5(0x129)){var _0x5f4ef8=users[_0x5ab4a5(0x1aa)];console[_0x5ab4a5(0x1df)](_0x5f4ef8);}else{if(_0x394522[0x0][_0x5ab4a5(0x1e5)]==_0x5ab4a5(0x124))var _0x5f4ef8=users[_0x5ab4a5(0x124)];else{if(_0x394522[0x0][_0x5ab4a5(0x1e5)]==_0x5ab4a5(0x1c6))var _0x5f4ef8=users[_0x5ab4a5(0x1c6)];else{if(_0x394522[0x0]['language']==_0x5ab4a5(0x1f0))var _0x5f4ef8=users[_0x5ab4a5(0x1f0)];else{if(_0x394522[0x0][_0x5ab4a5(0x1e5)]==_0x5ab4a5(0x1b8))var _0x5f4ef8=users[_0x5ab4a5(0x1b8)];else{if(_0x394522[0x0]['language']=='Portuguese\x20(BR)')var _0x5f4ef8=users[_0x5ab4a5(0x1d2)];else{if(_0x394522[0x0]['language']==_0x5ab4a5(0x166))var _0x5f4ef8=users[_0x5ab4a5(0x166)];else{if(_0x394522[0x0][_0x5ab4a5(0x1e5)]==_0x5ab4a5(0x126))var _0x5f4ef8=users[_0x5ab4a5(0x1d3)];}}}}}}}_0x28721e[_0x5ab4a5(0x18e)](_0x5ab4a5(0x1d0),{'success':_0x282e21[_0x5ab4a5(0x1bf)](_0x5ab4a5(0x15f)),'errors':_0x282e21[_0x5ab4a5(0x1bf)]('errors'),'role':_0x34d46f,'profile':_0x9394b2,'adjustment':_0x10b0ea,'stock':_0x218576,'master_shop':_0x394522,'warehouse_name':_0x4d513a,'unit':_0x126175,'language':_0x5f4ef8,'warehouse':_0x296f41});}catch(_0x47ddfd){console[_0x5ab4a5(0x1df)](_0x47ddfd),_0x28721e[_0x5ab4a5(0x173)](0xc8)['json']({'message':_0x47ddfd['message']});}}),router[a0_0x476f49(0x1b6)](a0_0x476f49(0x1b7),auth,async(_0x51aee0,_0x2bcced)=>{var _0x47fe55=a0_0x476f49;try{const _0x477b7a=_0x51aee0[_0x47fe55(0x17e)]['id'],_0x32ac0f=await adjustment[_0x47fe55(0x169)]({'_id':_0x477b7a}),_0x42f7cd=await warehouse[_0x47fe55(0x138)]({'name':_0x32ac0f['warehouse_name'],'room':_0x32ac0f[_0x47fe55(0x1d7)]}),{warehouse_name:_0x5c328f,date:_0x227a7b,prod_name:_0x3e8966,level:_0x2bb4a6,isle:_0x19cb3f,pallet:_0x3e0245,stock:_0x2eb1a1,types:_0x2d137d,adjust_qty:_0x3450f3,new_adjust_qty:_0x3a9bb4,note:_0x157abb,Room_name:_0x45b589,invoice:_0x3923a0,JO_number:_0x1a607a,expiry_date:_0x149ebe}=_0x51aee0[_0x47fe55(0x164)];if(typeof _0x3e8966==_0x47fe55(0x142))var _0x15ee85=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x195)]],_0x22653d=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x14c)]],_0x107fec=[_0x51aee0[_0x47fe55(0x164)]['stock']],_0x3741cd=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x155)]],_0x35c1d2=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x167)]],_0x15153e=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x153)]],_0x12a948=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x17d)]],_0x3a1630=[_0x51aee0['body'][_0x47fe55(0x146)]],_0x455cd3=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x177)]],_0xc3548e=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x1d5)]],_0x2a7532=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x19a)]],_0x39ce36=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x1bc)]],_0x180927=[_0x51aee0[_0x47fe55(0x164)]['production_date']],_0x98d7e6=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x188)]],_0x4ba472=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x123)]],_0x39967c=[_0x51aee0['body']['prime1']],_0x363d79=[_0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x143)]];else var _0x15ee85=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x195)]],_0x22653d=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x14c)]],_0x107fec=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x1db)]],_0x3741cd=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x155)]],_0x35c1d2=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x167)]],_0x15153e=[..._0x51aee0[_0x47fe55(0x164)]['New_Qty_Converted']],_0x12a948=[..._0x51aee0['body'][_0x47fe55(0x1a2)]],_0x3a1630=[..._0x51aee0['body'][_0x47fe55(0x146)]],_0x455cd3=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x177)]],_0xc3548e=[..._0x51aee0['body'][_0x47fe55(0x1d5)]],_0x2a7532=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x19a)]],_0x39ce36=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x1bc)]],_0x180927=[..._0x51aee0['body'][_0x47fe55(0x141)]],_0x98d7e6=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x188)]],_0x4ba472=[..._0x51aee0[_0x47fe55(0x164)]['Rooms']],_0x39967c=[..._0x51aee0['body']['prime1']],_0x363d79=[..._0x51aee0[_0x47fe55(0x164)][_0x47fe55(0x143)]];const _0x5e121f=_0x15ee85[_0x47fe55(0x18a)](_0x14188b=>{return _0x14188b={'product_name':_0x14188b};});_0x22653d[_0x47fe55(0x17f)]((_0x3717f3,_0x1bacfb)=>{var _0x23100d=_0x47fe55;_0x4ba472[_0x23100d(0x17f)]((_0x302af4,_0x16a7e9)=>{var _0x4411b3=_0x23100d;if(_0x302af4==_0x4411b3(0x168)&&_0x1bacfb==_0x16a7e9){var _0x51be89=_0x3717f3['slice'](0x3);_0x5e121f[_0x1bacfb][_0x4411b3(0x1cd)]=_0x3717f3[0x0],_0x5e121f[_0x1bacfb][_0x4411b3(0x16f)]=_0x3717f3[0x1],_0x5e121f[_0x1bacfb][_0x4411b3(0x1a0)]=0x0,_0x5e121f[_0x1bacfb][_0x4411b3(0x1bb)]=0x0,_0x5e121f[_0x1bacfb]['type']=_0x4411b3(0x194),_0x5e121f[_0x1bacfb][_0x4411b3(0x12f)]=_0x51be89;}else{if(_0x302af4==_0x4411b3(0x1ce)&&_0x1bacfb==_0x16a7e9){var _0x51be89=_0x3717f3[_0x4411b3(0x12a)](0x3);_0x5e121f[_0x1bacfb][_0x4411b3(0x1cd)]=_0x3717f3[0x0],_0x5e121f[_0x1bacfb][_0x4411b3(0x16f)]=_0x3717f3[0x1],_0x5e121f[_0x1bacfb][_0x4411b3(0x1a0)]=0x0,_0x5e121f[_0x1bacfb]['bin']=0x0,_0x5e121f[_0x1bacfb]['type']=_0x4411b3(0x194),_0x5e121f[_0x1bacfb][_0x4411b3(0x12f)]=_0x3717f3[0x5];}else{if(_0x1bacfb==_0x16a7e9){var _0x317e96;if(_0x3717f3[0x4]=='L')_0x317e96=_0x4411b3(0x1e0);else _0x3717f3[0x4]=='F'&&(_0x317e96='Floor');_0x5e121f[_0x1bacfb][_0x4411b3(0x1cd)]=_0x3717f3[0x0],_0x5e121f[_0x1bacfb]['rack']=_0x3717f3[0x1],_0x5e121f[_0x1bacfb][_0x4411b3(0x1a0)]=_0x3717f3[0x2],_0x5e121f[_0x1bacfb]['bin']=_0x3717f3[0x3],_0x5e121f[_0x1bacfb][_0x4411b3(0x1ca)]=_0x317e96,_0x5e121f[_0x1bacfb]['floorlevel']=_0x3717f3[0x5];}}}});}),_0x107fec[_0x47fe55(0x17f)]((_0x2efc41,_0x55ba72)=>{_0x5e121f[_0x55ba72]['stockBefore']=_0x2efc41;}),_0x3741cd['forEach']((_0x1c3cf7,_0x14c350)=>{_0x5e121f[_0x14c350]['types']=_0x1c3cf7;}),_0x35c1d2['forEach']((_0x24ed6a,_0x5f1a41)=>{var _0x378c89=_0x47fe55;_0x5e121f[_0x5f1a41][_0x378c89(0x1b1)]=_0x24ed6a;}),_0x15153e[_0x47fe55(0x17f)]((_0x52b4b1,_0x1f2318)=>{var _0x1c3903=_0x47fe55;_0x5e121f[_0x1f2318][_0x1c3903(0x128)]=_0x52b4b1;}),_0x12a948['forEach']((_0x4e8b8a,_0x1fa0a0)=>{_0x5e121f[_0x1fa0a0]['unit']=_0x4e8b8a;}),_0x3a1630['forEach']((_0x231f6c,_0x2211d8)=>{var _0x344839=_0x47fe55;_0x5e121f[_0x2211d8][_0x344839(0x1a6)]=_0x231f6c;}),_0x455cd3[_0x47fe55(0x17f)]((_0x21a76e,_0x14de42)=>{_0x5e121f[_0x14de42]['product_code']=_0x21a76e;}),_0xc3548e['forEach']((_0x37ae7c,_0x1702ca)=>{var _0x5b155b=_0x47fe55;_0x5e121f[_0x1702ca][_0x5b155b(0x1d5)]=_0x37ae7c;}),_0x2a7532[_0x47fe55(0x17f)]((_0x1db2b2,_0x2c08b6)=>{_0x5e121f[_0x2c08b6]['expiry_date']=_0x1db2b2;}),_0x39ce36[_0x47fe55(0x17f)]((_0x554ab1,_0x2164de)=>{_0x5e121f[_0x2164de]['maxperunit']=_0x554ab1;}),_0x180927[_0x47fe55(0x17f)]((_0x3cf6db,_0x7fc129)=>{var _0x1d3c37=_0x47fe55;_0x5e121f[_0x7fc129][_0x1d3c37(0x141)]=_0x3cf6db;}),_0x98d7e6[_0x47fe55(0x17f)]((_0x7cc470,_0x56389b)=>{var _0x12d423=_0x47fe55;_0x5e121f[_0x56389b][_0x12d423(0x188)]=_0x7cc470;}),_0x4ba472[_0x47fe55(0x17f)]((_0x5af586,_0x52bae6)=>{var _0x3e3336=_0x47fe55;_0x5e121f[_0x52bae6][_0x3e3336(0x1ed)]=_0x5af586;}),_0x39967c[_0x47fe55(0x17f)]((_0xad0e73,_0x5d193e)=>{_0x5e121f[_0x5d193e]['primary_code']=_0xad0e73;}),_0x363d79[_0x47fe55(0x17f)]((_0x2bbd97,_0x2a219c)=>{var _0x9b770f=_0x47fe55;_0x5e121f[_0x2a219c][_0x9b770f(0x1b3)]=_0x2bbd97;});const _0x52fcf9=_0x5e121f['filter'](_0x23f228=>_0x23f228[_0x47fe55(0x1b1)]!=='0'&&_0x23f228[_0x47fe55(0x1b1)]!=='');var _0x59cf5b=0x0;_0x52fcf9['forEach'](_0x1d29ca=>{var _0x3f178e=_0x47fe55;console[_0x3f178e(0x1df)](_0x3f178e(0x1a7),_0x1d29ca),parseInt(_0x1d29ca[_0x3f178e(0x1b1)])<=0x0&&_0x59cf5b++;});if(_0x59cf5b!=0x0)return _0x51aee0[_0x47fe55(0x1bf)](_0x47fe55(0x12d),_0x47fe55(0x1c1)),_0x2bcced[_0x47fe55(0x1b9)]('back');_0x32ac0f[_0x47fe55(0x14f)]=_0x5c328f,_0x32ac0f[_0x47fe55(0x17a)]=_0x227a7b,_0x32ac0f[_0x47fe55(0x12e)]=_0x52fcf9,_0x32ac0f['note']=_0x157abb,_0x32ac0f[_0x47fe55(0x1e3)]=_0x3923a0,_0x32ac0f[_0x47fe55(0x1ae)]='False';const _0x266664=await _0x32ac0f[_0x47fe55(0x1d9)]();_0x51aee0[_0x47fe55(0x1bf)](_0x47fe55(0x15f),'adjustment\x20data\x20update\x20successfully'),_0x2bcced['redirect'](_0x47fe55(0x1c5));}catch(_0xb836bf){console['log'](_0xb836bf);}}),router['post'](a0_0x476f49(0x1c9),async(_0x5dac91,_0x1dc2c4)=>{var _0x219c08=a0_0x476f49;const {primary_code:_0x45791a,warehouse_data:_0x56fde8,rooms_data:_0x8e25da,Roomslist:_0x1a0771}=_0x5dac91['body'],_0x12c46a=_0x1a0771['split'](','),_0x4c85f=[];async function _0x47cc73(_0x396b6a){var _0xad9602=a0_0xd6fd;const _0x1a4aa0=await warehouse[_0xad9602(0x17c)]([{'$match':{'name':_0x56fde8,'room':_0x396b6a}},{'$unwind':_0xad9602(0x1e1)},{'$match':{'product_details.primary_code':_0x45791a}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xad9602(0x1b5)},'product_stock':{'$first':_0xad9602(0x186)},'primary_code':{'$first':_0xad9602(0x19e)},'secondary_code':{'$first':_0xad9602(0x1c7)},'product_code':{'$first':_0xad9602(0x150)},'level':{'$first':_0xad9602(0x1ef)},'isle':{'$first':_0xad9602(0x13e)},'type':{'$first':_0xad9602(0x14b)},'pallet':{'$first':_0xad9602(0x18b)},'unit':{'$first':_0xad9602(0x193)},'secondary_unit':{'$first':_0xad9602(0x15c)},'storage':{'$first':_0xad9602(0x15b)},'rack':{'$first':_0xad9602(0x14e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0xad9602(0x1d8)},'batch_code':{'$first':_0xad9602(0x1d4)},'product_cat':{'$first':_0xad9602(0x1c0)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0xad9602(0x185)},'invoice':{'$first':_0xad9602(0x196)}}}]),_0x388407=await warehouse[_0xad9602(0x17c)]([{'$match':{'name':_0x56fde8,'room':_0x396b6a}},{'$unwind':_0xad9602(0x1e1)},{'$match':{'product_details.secondary_code':_0x45791a}},{'$group':{'_id':_0xad9602(0x1d1),'name':{'$first':_0xad9602(0x1b5)},'product_stock':{'$first':_0xad9602(0x186)},'primary_code':{'$first':_0xad9602(0x19e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xad9602(0x150)},'level':{'$first':_0xad9602(0x1ef)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0xad9602(0x18b)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xad9602(0x15b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xad9602(0x139)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0xad9602(0x1d8)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0xad9602(0x1c0)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0xad9602(0x185)}}}]);if(_0x1a4aa0['length']>0x0)_0x4c85f[_0xad9602(0x181)](_0x1a4aa0);else _0x388407[_0xad9602(0x13f)]>0x0&&_0x4c85f[_0xad9602(0x181)](_0x388407);}const _0x11d45f=_0x12c46a[_0x219c08(0x18a)](_0xef0f32=>_0x47cc73(_0xef0f32));await Promise[_0x219c08(0x1e7)](_0x11d45f),_0x1dc2c4[_0x219c08(0x18f)](_0x4c85f);}),router[a0_0x476f49(0x1b6)](a0_0x476f49(0x174),async(_0x59550b,_0x2faef3)=>{var _0x49e6f2=a0_0x476f49;const {primaryCode:_0x1a0b18,secondaryCode:_0x1b1b16,productCode:_0x447b11,level:_0x2a674b,isle:_0x3b8663,pallet:_0x459eca,warehouses:_0x4e228d,room:_0x429a66}=_0x59550b[_0x49e6f2(0x164)];try{const _0x9e7083=await warehouse[_0x49e6f2(0x17c)]([{'$match':{'name':_0x4e228d,'room':_0x429a66}},{'$unwind':_0x49e6f2(0x1e1)},{'$match':{'product_details.level':parseInt(_0x2a674b),'product_details.isle':_0x3b8663,'product_details.pallet':parseInt(_0x459eca)}},{'$group':{'_id':_0x49e6f2(0x1d1),'name':{'$first':_0x49e6f2(0x1b5)},'product_stock':{'$first':_0x49e6f2(0x186)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x49e6f2(0x171)},'pallet':{'$first':_0x49e6f2(0x1dd)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2faef3[_0x49e6f2(0x173)](0xc8)[_0x49e6f2(0x18f)](_0x9e7083);}catch(_0x31947c){_0x2faef3[_0x49e6f2(0x173)](0x194)[_0x49e6f2(0x18f)]({'message':_0x31947c[_0x49e6f2(0x183)]});}}),module[a0_0x476f49(0x197)]=router;