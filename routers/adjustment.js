var a0_0x22c6d6=a0_0xb31d;(function(_0x434a02,_0x47b407){var _0x4ee2b6=a0_0xb31d,_0x2f9cc9=_0x434a02();while(!![]){try{var _0x16c04b=-parseInt(_0x4ee2b6(0x9f))/0x1*(-parseInt(_0x4ee2b6(0x8f))/0x2)+-parseInt(_0x4ee2b6(0xd5))/0x3+parseInt(_0x4ee2b6(0x11e))/0x4*(-parseInt(_0x4ee2b6(0x117))/0x5)+parseInt(_0x4ee2b6(0x98))/0x6*(parseInt(_0x4ee2b6(0x133))/0x7)+-parseInt(_0x4ee2b6(0x10b))/0x8+parseInt(_0x4ee2b6(0x143))/0x9*(-parseInt(_0x4ee2b6(0xba))/0xa)+-parseInt(_0x4ee2b6(0x14d))/0xb*(-parseInt(_0x4ee2b6(0x91))/0xc);if(_0x16c04b===_0x47b407)break;else _0x2f9cc9['push'](_0x2f9cc9['shift']());}catch(_0x1540da){_0x2f9cc9['push'](_0x2f9cc9['shift']());}}}(a0_0x5dc7,0x3b384));const express=require(a0_0x22c6d6(0x84)),app=express(),router=express[a0_0x22c6d6(0x13d)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x22c6d6(0x154)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x22c6d6(0x109)](a0_0x22c6d6(0x93),auth,async(_0x1f7cae,_0x293d9f)=>{var _0x1b5061=a0_0x22c6d6;try{const {username:_0xcd9399,email:_0x498edb,role:_0x693123}=_0x1f7cae[_0x1b5061(0x146)],_0x18cbb2=_0x1f7cae['user'],_0x3d177=await profile['findOne']({'email':_0x18cbb2[_0x1b5061(0x156)]}),_0x5364d9=await master_shop[_0x1b5061(0x110)]();console[_0x1b5061(0x11b)](_0x1b5061(0x13e),_0x5364d9);let _0x1f6603;if(_0x18cbb2[_0x1b5061(0xd0)]==_0x1b5061(0xd9)){const _0x264690=await staff[_0x1b5061(0x114)]({'email':_0x18cbb2['email']});_0x1f6603=await warehouse[_0x1b5061(0x110)]({'status':_0x1b5061(0xf9),'name':_0x264690[_0x1b5061(0xef)]});}else _0x1f6603=await warehouse[_0x1b5061(0x110)]({'status':_0x1b5061(0xf9)});const _0x2dc7d5=await product['find']();let _0x150591;if(_0x18cbb2['role']==_0x1b5061(0xd9)){const _0x579e35=await staff[_0x1b5061(0x114)]({'email':_0x18cbb2[_0x1b5061(0x156)]});_0x150591=await adjustment[_0x1b5061(0x110)]({'warehouse_name':_0x579e35[_0x1b5061(0xef)]});}else _0x150591=await adjustment[_0x1b5061(0x118)]([{'$unwind':_0x1b5061(0xab)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x1b5061(0x125)},'warehouse_name':{'$first':_0x1b5061(0xdb)},'room':{'$addToSet':_0x1b5061(0x9d)},'finalize':{'$first':_0x1b5061(0x99)},'isAllowEdit':{'$first':_0x1b5061(0xf5)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x5364d9[0x0][_0x1b5061(0x158)]==_0x1b5061(0xb2)){var _0x4cc616=users['English'];console['log'](_0x4cc616);}else{if(_0x5364d9[0x0]['language']==_0x1b5061(0x136))var _0x4cc616=users['Hindi'];else{if(_0x5364d9[0x0][_0x1b5061(0x158)]==_0x1b5061(0x116))var _0x4cc616=users[_0x1b5061(0x116)];else{if(_0x5364d9[0x0][_0x1b5061(0x158)]=='Spanish')var _0x4cc616=users['Spanish'];else{if(_0x5364d9[0x0][_0x1b5061(0x158)]=='French')var _0x4cc616=users[_0x1b5061(0x11a)];else{if(_0x5364d9[0x0][_0x1b5061(0x158)]==_0x1b5061(0x153))var _0x4cc616=users[_0x1b5061(0x106)];else{if(_0x5364d9[0x0][_0x1b5061(0x158)]=='Chinese')var _0x4cc616=users[_0x1b5061(0x14b)];else{if(_0x5364d9[0x0][_0x1b5061(0x158)]=='Arabic\x20(ae)')var _0x4cc616=users[_0x1b5061(0xf3)];}}}}}}}_0x293d9f[_0x1b5061(0x144)]('adjustment',{'success':_0x1f7cae[_0x1b5061(0xd4)](_0x1b5061(0xac)),'errors':_0x1f7cae[_0x1b5061(0xd4)]('errors'),'role':_0x18cbb2,'profile':_0x3d177,'warehouse':_0x1f6603,'product':_0x2dc7d5,'adjustment':_0x150591,'master_shop':_0x5364d9,'language':_0x4cc616});}catch(_0x53f0cd){console['log'](_0x53f0cd);}});function a0_0xb31d(_0x2f70a7,_0x5d6a1f){var _0x5dc787=a0_0x5dc7();return a0_0xb31d=function(_0xb31de8,_0x1d9751){_0xb31de8=_0xb31de8-0x83;var _0x2be0f8=_0x5dc787[_0xb31de8];return _0x2be0f8;},a0_0xb31d(_0x2f70a7,_0x5d6a1f);}async function getRandom8DigitNumber(){var _0x1e021d=a0_0x22c6d6;const _0x3e7639=0x989680,_0x3b751b=0x5f5e0ff,_0x151bee=Math[_0x1e021d(0x119)](Math['random']()*(_0x3b751b-_0x3e7639+0x1))+_0x3e7639;var _0x31382f;const _0x5ac7cc=await adjustment['findOne']({'invoice':_0x1e021d(0x121)+_0x151bee});return _0x5ac7cc&&_0x5ac7cc[_0x1e021d(0xa6)]>0x0?_0x31382f=_0x1e021d(0x121)+_0x151bee:_0x31382f=_0x1e021d(0x121)+_0x151bee,_0x31382f;}function a0_0x5dc7(){var _0x2002e2=['$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<h5\x20style=\x22text-align:\x20left;\x22>','/view/:id','30KuWwUn','$finalize','<html><head><title></title>','production_date','$product_details.secondary_unit','$product.room_names','$product_details.secondary_code','4UQVXYJ','$product_details.floorlevel','$product.product_name','Rooms','$product_details.isle','_id','</table>','length','finalize','$product_details','createTransport','$product_details.bay','$product','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','False','<table\x20style=\x22width:\x20100%\x20!important;\x22>','padStart','new_adjust_qty','English\x20(US)','$product_details.maxPerUnit','Shelves','exports','string','English','/../public','push','156540RFGutG','</thead>','adjustment\x20data\x20update\x20successfully','Return\x20Goods','secondary_unit','Arabic\x20(ae)','Secondary_units','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','max_per_unit','Floor','</div>','error','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','\x20</h2>','\x20<>\x20','edit_adjustment','prod_invoice','prime1','then','json','save','role','types','$product_details.maxProducts','sendMail','flash','1171029BxxzxF','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.production_date','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','staff','password','$warehouse_name','stock','message','id_transaction','RMSEmail','findById','$room','<tr>','\x20Order\x20Number\x20:\x20','</tr>','room_names','</td>','all','Error\x20Occurs','Email\x20sent\x20successfully','True','level','product_name','prod_cat','$product_details.bin','warehouse','slice','Adjustment\x20Mail','redirect','Arabic','prod_code','$isAllowEdit','back','map','/preview/:id','Enabled','storage','bay','/barcode_scanner','rack','Receiving\x20Area','</h5>','params','<span\x20style=\x22float:\x20right;\x22>','expiry_date','$product_details.rack','$product_details.expiry_date','adjustment\x20Finalized\x20successfully','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<h2>\x20','get','floorlevel','3590208kaBHyl','New_Qty_Converted','primary_code','status','invoice','find','product','$product_details.product_stock','</tbody>','findOne','$product_details.product_cat','German','386605iOpZLg','aggregate','floor','French','log','An\x20error\x20occurred.','$product_details.product_name','16qHcbLp','batch_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','ADJ-','errors','<hr\x20class=\x22my-3\x22>','/view/add_adjustment','$date','</span>','$product_details.invoice','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','post','$product_details.batch_code','$product_details.product_code','</head><body>','add_adjustment','foreach\x20newproduct','/picking_list/PDF_adjustment_rm/','warehouse_name','maxperunit','68453lQeiLv','type','<div>','Hindi','$product_details.type','product_details','date','filter','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','unit','Router','master','edit_adjustment_view','forEach','split','site_title','270pCVKyH','render','second1','user','adjust_qty','Level','adjustment\x20add\x20successfull','Raw\x20Materials','Chinese','Enclosed','16379ruvdFE','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','toString','Ambient','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Portuguese\x20(BR)','../models/all_models','\x20Order\x20Date\x20:\x20','email','stockBefore','language','$product_details.unit','secondary_code','Primary_Units','express','Spanish','bin','$product_details.primary_code','room','New_Qty_Converted_adj','<h5>','body','port','</body></html>','prod_name','167302hAiOqJ','id_transaction_from','11904CxlQMM','$product_details._id','/view'];a0_0x5dc7=function(){return _0x2002e2;};return a0_0x5dc7();}router[a0_0x22c6d6(0x109)](a0_0x22c6d6(0x124),auth,async(_0xc6ed3,_0x35e594)=>{var _0x4be253=a0_0x22c6d6;try{const {username:_0x5b2237,email:_0x184000,role:_0x54fb93}=_0xc6ed3[_0x4be253(0x146)],_0x552fb9=_0xc6ed3['user'],_0x5a5b16=await profile[_0x4be253(0x114)]({'email':_0x552fb9[_0x4be253(0x156)]}),_0x5db256=await master_shop['find']();let _0xcdcb46;if(_0x552fb9[_0x4be253(0xd0)]==_0x4be253(0xd9)){const _0x456961=await staff[_0x4be253(0x114)]({'email':_0x552fb9['email']});_0xcdcb46=await warehouse[_0x4be253(0x118)]([{'$match':{'status':_0x4be253(0xf9),'name':_0x456961[_0x4be253(0xef)],'warehouse_category':_0x4be253(0x14a),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x4be253(0x94),'name':{'$first':_0x4be253(0x94)}}}]);}else _0xcdcb46=await warehouse[_0x4be253(0x118)]([{'$match':{'status':_0x4be253(0xf9),'warehouse_category':_0x4be253(0x14a),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x4be253(0x94),'name':{'$first':_0x4be253(0x94)}}}]);const _0x4b0fc6=await product[_0x4be253(0x110)]({}),_0x2d0f05=await adjustment[_0x4be253(0x110)]({}),_0x1fddad=_0x2d0f05['length']+0x1,_0x3e7df8=_0x4be253(0x121)+_0x1fddad[_0x4be253(0x150)]()[_0x4be253(0xb0)](0x5,'0');var _0x271bd2=[_0x4be253(0x151),_0x4be253(0x14c),'Return\x20Rooms'];if(_0x5db256[0x0][_0x4be253(0x158)]==_0x4be253(0xb2))var _0x3631ce=users['English'];else{if(_0x5db256[0x0][_0x4be253(0x158)]==_0x4be253(0x136))var _0x3631ce=users[_0x4be253(0x136)];else{if(_0x5db256[0x0][_0x4be253(0x158)]==_0x4be253(0x116))var _0x3631ce=users[_0x4be253(0x116)];else{if(_0x5db256[0x0][_0x4be253(0x158)]==_0x4be253(0x85))var _0x3631ce=users[_0x4be253(0x85)];else{if(_0x5db256[0x0][_0x4be253(0x158)]==_0x4be253(0x11a))var _0x3631ce=users['French'];else{if(_0x5db256[0x0][_0x4be253(0x158)]==_0x4be253(0x153))var _0x3631ce=users[_0x4be253(0x106)];else{if(_0x5db256[0x0][_0x4be253(0x158)]==_0x4be253(0x14b))var _0x3631ce=users[_0x4be253(0x14b)];else{if(_0x5db256[0x0]['language']==_0x4be253(0xbf))var _0x3631ce=users[_0x4be253(0xf3)];}}}}}}}const _0x29a77b=getRandom8DigitNumber();_0x29a77b['then'](_0x1f98ec=>{var _0x2114f5=_0x4be253;_0x35e594[_0x2114f5(0x144)](_0x2114f5(0x12e),{'success':_0xc6ed3[_0x2114f5(0xd4)](_0x2114f5(0xac)),'errors':_0xc6ed3[_0x2114f5(0xd4)]('errors'),'role':_0x552fb9,'profile':_0x5a5b16,'warehouse':_0xcdcb46,'product':_0x4b0fc6,'master_shop':_0x5db256,'language':_0x3631ce,'rooms_data':_0x271bd2,'invoice_no':_0x1f98ec});})['catch'](_0x455011=>{var _0x35339b=_0x4be253;_0xc6ed3[_0x35339b(0xd4)]('errors',_0x35339b(0x120)),_0x35e594[_0x35339b(0xf2)]('/adjustment/view');});}catch(_0x264577){console[_0x4be253(0x11b)](_0x264577);}}),router[a0_0x22c6d6(0x12a)]('/view/add_adjustment',auth,async(_0x394048,_0x2e5e30)=>{var _0xbe4f4a=a0_0x22c6d6;try{const {warehouse_name:_0x1475f0,date:_0x2e6476,prod_name:_0x5d199a,level:_0x308693,isle:_0x1027c9,pallet:_0x503ebc,stock:_0x1d3655,types:_0xe38da7,adjust_qty:_0x1c9d99,new_adjust_qty:_0x14807f,note:_0x4fd93e,Room_name:_0x4c48c3,invoice:_0x56adb5,JO_number:_0x5baaab,expiry_date:_0x498351}=_0x394048[_0xbe4f4a(0x8b)];if(typeof _0x5d199a==_0xbe4f4a(0xb6))var _0x4d5f27=[_0x394048['body'][_0xbe4f4a(0x8e)]],_0x4a61de=[_0x394048['body'][_0xbe4f4a(0xeb)]],_0x47e959=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xdc)]],_0x28cb07=[_0x394048['body'][_0xbe4f4a(0xd1)]],_0x140c37=[_0x394048[_0xbe4f4a(0x8b)]['New_Qty_Converted_adj']],_0x19ea45=[_0x394048[_0xbe4f4a(0x8b)]['New_Qty_Converted']],_0x4586b3=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0x83)]],_0x5f0f66=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xc0)]],_0x257e5e=[_0x394048['body']['prod_code']],_0x54bdff=[_0x394048['body'][_0xbe4f4a(0x11f)]],_0x3b1402=[_0x394048[_0xbe4f4a(0x8b)]['expiry_date']],_0x2ca9d1=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xc3)]],_0x2720eb=[_0x394048['body']['production_date']],_0x35ca3a=[_0x394048[_0xbe4f4a(0x8b)]['prod_cat']],_0x5c86d8=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xa2)]],_0x2e4a69=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xcc)]],_0x148656=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0x145)]],_0x28d301=[_0x394048[_0xbe4f4a(0x8b)]['prod_invoice']],_0x135798=[_0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xde)]];else var _0x4d5f27=[..._0x394048[_0xbe4f4a(0x8b)]['prod_name']],_0x4a61de=[..._0x394048['body'][_0xbe4f4a(0xeb)]],_0x47e959=[..._0x394048['body'][_0xbe4f4a(0xdc)]],_0x28cb07=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xd1)]],_0x140c37=[..._0x394048['body'][_0xbe4f4a(0x89)]],_0x19ea45=[..._0x394048['body'][_0xbe4f4a(0x10c)]],_0x4586b3=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0x13c)]],_0x5f0f66=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xc0)]],_0x257e5e=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xf4)]],_0x54bdff=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0x11f)]],_0x3b1402=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0x102)]],_0x2ca9d1=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xc3)]],_0x2720eb=[..._0x394048[_0xbe4f4a(0x8b)]['production_date']],_0x35ca3a=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xed)]],_0x5c86d8=[..._0x394048['body'][_0xbe4f4a(0xa2)]],_0x2e4a69=[..._0x394048['body'][_0xbe4f4a(0xcc)]],_0x148656=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0x145)]],_0x28d301=[..._0x394048['body'][_0xbe4f4a(0xcb)]],_0x135798=[..._0x394048[_0xbe4f4a(0x8b)][_0xbe4f4a(0xde)]];const _0x1d6db8=_0x4d5f27[_0xbe4f4a(0xf7)](_0x29a16a=>{return _0x29a16a={'product_name':_0x29a16a};});_0x4a61de[_0xbe4f4a(0x140)]((_0x591f94,_0x2b07f9)=>{var _0x189cc2=_0xbe4f4a;_0x5c86d8[_0x189cc2(0x140)]((_0x2dadb1,_0x140a30)=>{var _0x3b2d45=_0x189cc2;if(_0x2dadb1==_0x3b2d45(0xfe)&&_0x2b07f9==_0x140a30){var _0x3b659e=_0x591f94[_0x3b2d45(0xf0)](0x3);_0x1d6db8[_0x2b07f9]['storage']=_0x591f94[0x0],_0x1d6db8[_0x2b07f9]['rack']=_0x591f94[0x1],_0x1d6db8[_0x2b07f9][_0x3b2d45(0xfb)]=0x0,_0x1d6db8[_0x2b07f9][_0x3b2d45(0x86)]=0x0,_0x1d6db8[_0x2b07f9][_0x3b2d45(0x134)]='Floor',_0x1d6db8[_0x2b07f9]['floorlevel']=_0x3b659e;}else{if(_0x2dadb1==_0x3b2d45(0xb4)&&_0x2b07f9==_0x140a30){var _0x3b659e=_0x591f94[_0x3b2d45(0xf0)](0x3);_0x1d6db8[_0x2b07f9][_0x3b2d45(0xfa)]=_0x591f94[0x0],_0x1d6db8[_0x2b07f9][_0x3b2d45(0xfd)]=_0x591f94[0x1],_0x1d6db8[_0x2b07f9][_0x3b2d45(0xfb)]=0x0,_0x1d6db8[_0x2b07f9][_0x3b2d45(0x86)]=0x0,_0x1d6db8[_0x2b07f9][_0x3b2d45(0x134)]=_0x3b2d45(0xc4),_0x1d6db8[_0x2b07f9][_0x3b2d45(0x10a)]=_0x591f94[0x5];}else{if(_0x2b07f9==_0x140a30){var _0x54a875;if(_0x591f94[0x4]=='L')_0x54a875=_0x3b2d45(0x148);else _0x591f94[0x4]=='F'&&(_0x54a875=_0x3b2d45(0xc4));_0x1d6db8[_0x2b07f9]['storage']=_0x591f94[0x0],_0x1d6db8[_0x2b07f9][_0x3b2d45(0xfd)]=_0x591f94[0x1],_0x1d6db8[_0x2b07f9][_0x3b2d45(0xfb)]=_0x591f94[0x2],_0x1d6db8[_0x2b07f9][_0x3b2d45(0x86)]=_0x591f94[0x3],_0x1d6db8[_0x2b07f9][_0x3b2d45(0x134)]=_0x54a875,_0x1d6db8[_0x2b07f9]['floorlevel']=_0x591f94[0x5];}}}});}),_0x47e959['forEach']((_0x1a5841,_0x58cc8a)=>{var _0x394f75=_0xbe4f4a;_0x1d6db8[_0x58cc8a][_0x394f75(0x157)]=_0x1a5841;}),_0x135798[_0xbe4f4a(0x140)]((_0x4514d0,_0x31af81)=>{var _0x463821=_0xbe4f4a;_0x1d6db8[_0x31af81][_0x463821(0x90)]=_0x4514d0;}),_0x28cb07[_0xbe4f4a(0x140)]((_0x25f15b,_0x2d50dd)=>{var _0x3dd039=_0xbe4f4a;_0x1d6db8[_0x2d50dd][_0x3dd039(0xd1)]=_0x25f15b;}),_0x140c37[_0xbe4f4a(0x140)]((_0x2f452d,_0x39d924)=>{var _0x43495a=_0xbe4f4a;_0x1d6db8[_0x39d924][_0x43495a(0x147)]=_0x2f452d;}),_0x19ea45['forEach']((_0x45eb01,_0x335707)=>{_0x1d6db8[_0x335707]['new_adjust_qty']=_0x45eb01;}),_0x4586b3[_0xbe4f4a(0x140)]((_0x4f6c05,_0x5d28fa)=>{var _0x50a99d=_0xbe4f4a;_0x1d6db8[_0x5d28fa][_0x50a99d(0x13c)]=_0x4f6c05;}),_0x5f0f66[_0xbe4f4a(0x140)]((_0x3ec2d4,_0x4b98af)=>{_0x1d6db8[_0x4b98af]['secondary_unit']=_0x3ec2d4;}),_0x257e5e[_0xbe4f4a(0x140)]((_0x19e5eb,_0x4beb14)=>{var _0x3fac4e=_0xbe4f4a;_0x1d6db8[_0x4beb14][_0x3fac4e(0xc1)]=_0x19e5eb;}),_0x54bdff[_0xbe4f4a(0x140)]((_0x4681fc,_0x1cafc4)=>{var _0xe1861d=_0xbe4f4a;_0x1d6db8[_0x1cafc4][_0xe1861d(0x11f)]=_0x4681fc;}),_0x3b1402[_0xbe4f4a(0x140)]((_0x3dc12f,_0x3edcf2)=>{var _0x4c9aea=_0xbe4f4a;_0x1d6db8[_0x3edcf2][_0x4c9aea(0x102)]=_0x3dc12f;}),_0x2ca9d1[_0xbe4f4a(0x140)]((_0x450b01,_0x3a535f)=>{_0x1d6db8[_0x3a535f]['maxperunit']=_0x450b01;}),_0x2720eb[_0xbe4f4a(0x140)]((_0xea90c7,_0x36dbc8)=>{_0x1d6db8[_0x36dbc8]['production_date']=_0xea90c7;}),_0x35ca3a[_0xbe4f4a(0x140)]((_0x514714,_0x2bda4c)=>{_0x1d6db8[_0x2bda4c]['prod_cat']=_0x514714;}),_0x5c86d8['forEach']((_0x142ceb,_0x360679)=>{var _0x1c0847=_0xbe4f4a;_0x1d6db8[_0x360679][_0x1c0847(0xe5)]=_0x142ceb;}),_0x2e4a69[_0xbe4f4a(0x140)]((_0x3dc9a9,_0x16276d)=>{_0x1d6db8[_0x16276d]['primary_code']=_0x3dc9a9;}),_0x148656['forEach']((_0x4630b3,_0x31e504)=>{var _0x22fabe=_0xbe4f4a;_0x1d6db8[_0x31e504][_0x22fabe(0x15a)]=_0x4630b3;}),_0x28d301[_0xbe4f4a(0x140)]((_0x127c67,_0x3b2064)=>{var _0x1d1a3f=_0xbe4f4a;_0x1d6db8[_0x3b2064][_0x1d1a3f(0x10f)]=_0x127c67;});const _0x274607=_0x1d6db8[_0xbe4f4a(0x13a)](_0xb9ecd5=>_0xb9ecd5[_0xbe4f4a(0x147)]!=='0'&&_0xb9ecd5[_0xbe4f4a(0x147)]!=='');var _0x42f45d=0x0;_0x274607[_0xbe4f4a(0x140)](_0x10c08b=>{var _0x8cfe7c=_0xbe4f4a;console[_0x8cfe7c(0x11b)]('foreach\x20newproduct',_0x10c08b),parseInt(_0x10c08b[_0x8cfe7c(0x147)])<=0x0&&_0x42f45d++;});if(_0x42f45d!=0x0)return _0x394048['flash'](_0xbe4f4a(0x122),_0xbe4f4a(0xd8)),_0x2e5e30['redirect'](_0xbe4f4a(0xf6));const _0x237b2d=new adjustment({'warehouse_name':_0x1475f0,'date':_0x2e6476,'product':_0x274607,'note':_0x4fd93e,'room':_0x4c48c3,'invoice':_0x56adb5,'JO_number':_0x5baaab,'expiry_date':_0x498351}),_0x8ee1b3=await _0x237b2d['save']();_0x394048[_0xbe4f4a(0xd4)](_0xbe4f4a(0xac),_0xbe4f4a(0x149)),_0x2e5e30[_0xbe4f4a(0xf2)]('/adjustment/preview/'+_0x8ee1b3['_id']);}catch(_0x2402e2){console['log'](_0x2402e2),_0x2e5e30['status'](0xc8)[_0xbe4f4a(0xce)]({'message':_0x2402e2[_0xbe4f4a(0xdd)]});}}),router[a0_0x22c6d6(0x109)](a0_0x22c6d6(0xf8),auth,async(_0x3aeb3f,_0x273e3f)=>{var _0x268f50=a0_0x22c6d6;try{const {username:_0x37d11e,email:_0x2cfd41,role:_0x783b31}=_0x3aeb3f[_0x268f50(0x146)],_0x45b0b9=_0x3aeb3f[_0x268f50(0x146)],_0x5aa6af=await profile['findOne']({'email':_0x45b0b9[_0x268f50(0x156)]}),_0x53c6a3=await master_shop[_0x268f50(0x110)](),_0x46f89f=_0x3aeb3f[_0x268f50(0x100)]['id'],_0x44de5e=await adjustment['findById']({'_id':_0x46f89f}),_0x5ff111=await purchases[_0x268f50(0x118)]([{'$match':{'warehouse_name':_0x44de5e['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x1b6a3e=await product['find']({}),_0x5e9aef=await warehouse[_0x268f50(0x118)]([{'$match':{'name':_0x44de5e[_0x268f50(0x131)]}},{'$unwind':_0x268f50(0xa8)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x268f50(0x112)},'bay':{'$first':_0x268f50(0xaa)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x268f50(0x137)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x268f50(0x9e)},'product_code':{'$first':_0x268f50(0x12c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x268f50(0x104)},'production_date':{'$first':_0x268f50(0xd7)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);if(_0x53c6a3[0x0][_0x268f50(0x158)]==_0x268f50(0xb2)){var _0x4a9c7e=users[_0x268f50(0xb7)];console['log'](_0x4a9c7e);}else{if(_0x53c6a3[0x0]['language']=='Hindi')var _0x4a9c7e=users[_0x268f50(0x136)];else{if(_0x53c6a3[0x0][_0x268f50(0x158)]==_0x268f50(0x116))var _0x4a9c7e=users[_0x268f50(0x116)];else{if(_0x53c6a3[0x0]['language']==_0x268f50(0x85))var _0x4a9c7e=users[_0x268f50(0x85)];else{if(_0x53c6a3[0x0]['language']==_0x268f50(0x11a))var _0x4a9c7e=users[_0x268f50(0x11a)];else{if(_0x53c6a3[0x0][_0x268f50(0x158)]==_0x268f50(0x153))var _0x4a9c7e=users['Portuguese'];else{if(_0x53c6a3[0x0][_0x268f50(0x158)]=='Chinese')var _0x4a9c7e=users[_0x268f50(0x14b)];else{if(_0x53c6a3[0x0][_0x268f50(0x158)]==_0x268f50(0xbf))var _0x4a9c7e=users[_0x268f50(0xf3)];}}}}}}}_0x273e3f[_0x268f50(0x144)](_0x268f50(0x13f),{'success':_0x3aeb3f[_0x268f50(0xd4)](_0x268f50(0xac)),'errors':_0x3aeb3f[_0x268f50(0xd4)](_0x268f50(0x122)),'role':_0x45b0b9,'profile':_0x5aa6af,'adjustment':_0x44de5e,'stock':_0x5e9aef,'master_shop':_0x53c6a3,'warehouse_name':_0x5ff111,'unit':_0x1b6a3e,'language':_0x4a9c7e});}catch(_0x3448a4){console['log'](_0x3448a4),_0x273e3f[_0x268f50(0x10e)](0xc8)[_0x268f50(0xce)]({'message':_0x3448a4[_0x268f50(0xdd)]});}}),router[a0_0x22c6d6(0x12a)](a0_0x22c6d6(0xf8),auth,async(_0x54eee2,_0x10d1ba)=>{var _0x475b8b=a0_0x22c6d6;try{const _0x436cc4=_0x54eee2[_0x475b8b(0x100)]['id'],{warehouse_name:_0x55554e,Room_name:_0x57e01c}=_0x54eee2[_0x475b8b(0x8b)],_0x1f664c=await adjustment['findById']({'_id':_0x436cc4}),_0x43a3da=_0x1f664c['product'][_0x475b8b(0xf7)](async _0x360d94=>{var _0x1784a0=_0x475b8b;if(_0x360d94[_0x1784a0(0x147)]>0x0){var _0x482610=await warehouse['findOne']({'name':_0x55554e,'room':_0x360d94[_0x1784a0(0xe5)],'warehouse_category':_0x1784a0(0x14a)});const _0x752568=_0x482610[_0x1784a0(0x138)][_0x1784a0(0xf7)](_0x119a23=>{var _0xb0eea9=_0x1784a0;console[_0xb0eea9(0x11b)](_0x360d94[_0xb0eea9(0xd1)]+_0xb0eea9(0xc9));if(_0x360d94[_0xb0eea9(0xd1)]=='minus'){if(_0x119a23[_0xb0eea9(0xec)]==_0x360d94['product_name']&&_0x119a23['floorlevel']==_0x360d94[_0xb0eea9(0x10a)]&&_0x119a23[_0xb0eea9(0x134)]==_0x360d94[_0xb0eea9(0x134)]&&_0x119a23[_0xb0eea9(0x86)]==_0x360d94[_0xb0eea9(0x86)]&&_0x119a23[_0xb0eea9(0xfb)]==_0x360d94[_0xb0eea9(0xfb)]&&_0x119a23[_0xb0eea9(0xfd)]==_0x360d94[_0xb0eea9(0xfd)]&&_0x119a23[_0xb0eea9(0xfa)]==_0x360d94[_0xb0eea9(0xfa)]&&_0x119a23[_0xb0eea9(0x102)]==_0x360d94[_0xb0eea9(0x102)]&&_0x119a23[_0xb0eea9(0x11f)]==_0x360d94[_0xb0eea9(0x11f)]&&_0x119a23[_0xb0eea9(0x9b)]==_0x360d94[_0xb0eea9(0x9b)]&&_0x119a23[_0xb0eea9(0x10f)]==_0x360d94[_0xb0eea9(0x10f)]&&_0x119a23[_0xb0eea9(0xa4)]==_0x360d94[_0xb0eea9(0x90)]){var _0x34f6db;_0x34f6db=_0x360d94[_0xb0eea9(0x147)],_0x360d94['prod_cat']=='S'&&(_0x34f6db=_0x360d94[_0xb0eea9(0x147)]),_0x119a23[_0xb0eea9(0x14e)]=_0x119a23[_0xb0eea9(0x14e)]-_0x34f6db;}}else{if(_0x119a23[_0xb0eea9(0xec)]==_0x360d94['product_name']&&_0x119a23[_0xb0eea9(0x10a)]==_0x360d94[_0xb0eea9(0x10a)]&&_0x119a23[_0xb0eea9(0x134)]==_0x360d94['type']&&_0x119a23[_0xb0eea9(0x86)]==_0x360d94[_0xb0eea9(0x86)]&&_0x119a23[_0xb0eea9(0xfb)]==_0x360d94[_0xb0eea9(0xfb)]&&_0x119a23[_0xb0eea9(0xfd)]==_0x360d94[_0xb0eea9(0xfd)]&&_0x119a23['storage']==_0x360d94[_0xb0eea9(0xfa)]&&_0x119a23[_0xb0eea9(0x102)]==_0x360d94['expiry_date']&&_0x119a23[_0xb0eea9(0x11f)]==_0x360d94[_0xb0eea9(0x11f)]&&_0x119a23['production_date']==_0x360d94['production_date']&&_0x119a23[_0xb0eea9(0x10f)]==_0x360d94[_0xb0eea9(0x10f)]&&_0x119a23[_0xb0eea9(0xa4)]==_0x360d94[_0xb0eea9(0x90)]){console[_0xb0eea9(0x11b)](_0x360d94);var _0x34f6db;_0x34f6db=_0x360d94[_0xb0eea9(0x147)],_0x360d94[_0xb0eea9(0xed)]=='S'&&(_0x34f6db=_0x360d94['adjust_qty']),_0x119a23[_0xb0eea9(0x14e)]=_0x119a23[_0xb0eea9(0x14e)]+_0x34f6db;}}});}return _0x482610;});Promise['all'](_0x43a3da)[_0x475b8b(0xcd)](async _0x3f2271=>{var _0x4fe21a=_0x475b8b;try{for(const _0x1651bb of _0x3f2271){await _0x1651bb['save']();}_0x1f664c[_0x4fe21a(0xa7)]=_0x4fe21a(0xea);const _0x3c4290=await _0x1f664c[_0x4fe21a(0xcf)](),_0x5165ea=await master_shop[_0x4fe21a(0x110)](),_0x8ef44f=await email_settings['findOne'](),_0x3adb0c=await supervisor_settings[_0x4fe21a(0x110)]();var _0x9b716b=_0x1f664c[_0x4fe21a(0x111)],_0x2cf887='',_0x43169b;for(_0x43169b in _0x9b716b){_0x2cf887+=_0x4fe21a(0xe2)+_0x4fe21a(0xc7)+_0x9b716b[_0x43169b]['product_name']+_0x4fe21a(0xe6)+_0x4fe21a(0xc7)+_0x9b716b[_0x43169b][_0x4fe21a(0xc1)]+_0x4fe21a(0xe6)+_0x4fe21a(0xc7)+_0x9b716b[_0x43169b]['adjust_qty']+_0x4fe21a(0xe6)+_0x4fe21a(0xc7)+_0x9b716b[_0x43169b][_0x4fe21a(0x13c)]+'</td>'+_0x4fe21a(0xc7)+_0x9b716b[_0x43169b][_0x4fe21a(0xbe)]+_0x4fe21a(0xe6)+_0x4fe21a(0xc7)+_0x1f664c[_0x4fe21a(0x131)]+'</td>'+_0x4fe21a(0xc7)+_0x9b716b[_0x43169b][_0x4fe21a(0xe5)]+_0x4fe21a(0xe6)+_0x4fe21a(0xc7)+_0x9b716b[_0x43169b][_0x4fe21a(0xfa)]+_0x9b716b[_0x43169b]['rack']+_0x9b716b[_0x43169b][_0x4fe21a(0xfb)]+_0x9b716b[_0x43169b][_0x4fe21a(0x86)]+_0x9b716b[_0x43169b]['type'][0x0]+_0x9b716b[_0x43169b][_0x4fe21a(0x10a)]+_0x4fe21a(0xe6),_0x4fe21a(0xe4);}let _0x2cafed=nodemailer[_0x4fe21a(0xa9)]({'host':_0x8ef44f['host'],'port':Number(_0x8ef44f[_0x4fe21a(0x8c)]),'secure':![],'auth':{'user':_0x8ef44f[_0x4fe21a(0x156)],'pass':_0x8ef44f[_0x4fe21a(0xda)]}}),_0x3e5857={'from':_0x8ef44f['email'],'to':_0x3adb0c[0x0][_0x4fe21a(0xdf)],'subject':_0x4fe21a(0xf1),'attachments':[{'filename':'Logo.png','path':__dirname+_0x4fe21a(0xb8)+'/upload/'+_0x5165ea[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x4fe21a(0x9a)+_0x4fe21a(0x12d)+'<div>'+_0x4fe21a(0x13b)+_0x4fe21a(0x135)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x4fe21a(0xc5)+_0x4fe21a(0x135)+_0x4fe21a(0x108)+_0x5165ea[0x0][_0x4fe21a(0x142)]+_0x4fe21a(0xc8)+_0x4fe21a(0xc5)+_0x4fe21a(0xc5)+_0x4fe21a(0x123)+_0x4fe21a(0x135)+_0x4fe21a(0x96)+_0x4fe21a(0xe3)+_0x1f664c[_0x4fe21a(0x10f)]+'\x20'+_0x4fe21a(0x101)+_0x4fe21a(0x155)+_0x1f664c[_0x4fe21a(0x139)]+'\x20'+_0x4fe21a(0x126)+_0x4fe21a(0xff)+_0x4fe21a(0xc5)+_0x4fe21a(0xaf)+_0x4fe21a(0xd6)+_0x4fe21a(0xe2)+_0x4fe21a(0x129)+_0x4fe21a(0x95)+_0x4fe21a(0xad)+_0x4fe21a(0xc2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x4fe21a(0x14f)+_0x4fe21a(0x152)+_0x4fe21a(0x107)+_0x4fe21a(0xe4)+_0x4fe21a(0xbb)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x2cf887+'\x20'+_0x4fe21a(0x113)+_0x4fe21a(0xa5)+_0x4fe21a(0x135)+'<strong>\x20Regards\x20</strong>'+_0x4fe21a(0x8a)+_0x5165ea[0x0][_0x4fe21a(0x142)]+_0x4fe21a(0xff)+_0x4fe21a(0xc5)+'</div>'+_0x4fe21a(0x8d)};_0x2cafed[_0x4fe21a(0xd3)](_0x3e5857,function(_0x1e77bc,_0x412ac7){var _0x322afb=_0x4fe21a;_0x1e77bc?(console[_0x322afb(0x11b)](_0x1e77bc),console['log'](_0x322afb(0xe8))):console[_0x322afb(0x11b)](_0x322afb(0xe9));}),_0x54eee2[_0x4fe21a(0xd4)]('success',_0x4fe21a(0x105)),_0x10d1ba[_0x4fe21a(0xf2)](_0x4fe21a(0x130)+_0x3c4290['_id']);}catch(_0x4f4c49){console[_0x4fe21a(0xc6)](_0x4f4c49),_0x10d1ba[_0x4fe21a(0x10e)](0x1f4)[_0x4fe21a(0xce)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0xd6c489=>{var _0x50a8aa=_0x475b8b;console[_0x50a8aa(0xc6)](_0xd6c489),_0x10d1ba[_0x50a8aa(0x10e)](0x1f4)['json']({'error':_0x50a8aa(0x11c)});});}catch(_0x21e109){console['log'](_0x21e109),_0x10d1ba[_0x475b8b(0x10e)](0xc8)[_0x475b8b(0xce)]({'message':_0x21e109['message']});}}),router[a0_0x22c6d6(0x109)](a0_0x22c6d6(0x97),auth,async(_0x45f4f7,_0x274f12)=>{var _0x5d1a8f=a0_0x22c6d6;try{const {username:_0x1330d5,email:_0x4832d6,role:_0x25939c}=_0x45f4f7[_0x5d1a8f(0x146)],_0x44c1e0=_0x45f4f7[_0x5d1a8f(0x146)],_0x5ad8ab=await profile[_0x5d1a8f(0x114)]({'email':_0x44c1e0['email']}),_0x21662e=await master_shop[_0x5d1a8f(0x110)](),_0x43ac1c=_0x45f4f7[_0x5d1a8f(0x100)]['id'],_0xc23c4a=await adjustment[_0x5d1a8f(0xe0)]({'_id':_0x43ac1c}),_0x4a8482=await purchases[_0x5d1a8f(0x118)]([{'$match':{'warehouse_name':_0xc23c4a[_0x5d1a8f(0x131)]}},{'$unwind':_0x5d1a8f(0xab)},{'$group':{'_id':_0x5d1a8f(0xa1)}}]),_0xcc2c01=await product[_0x5d1a8f(0x110)]({}),_0x327cb5=await warehouse[_0x5d1a8f(0x118)]([{'$match':{'name':_0xc23c4a['warehouse_name']}},{'$unwind':_0x5d1a8f(0xa8)},{'$group':{'_id':_0x5d1a8f(0x92),'name':{'$first':_0x5d1a8f(0x11d)},'product_stock':{'$first':_0x5d1a8f(0x112)},'bay':{'$first':_0x5d1a8f(0xaa)},'bin':{'$first':_0x5d1a8f(0xee)},'type':{'$first':_0x5d1a8f(0x137)},'floorlevel':{'$first':_0x5d1a8f(0xa0)},'primary_code':{'$first':_0x5d1a8f(0x87)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5d1a8f(0x128)},'rack':{'$first':_0x5d1a8f(0x103)},'maxPerUnit':{'$first':_0x5d1a8f(0xb3)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5d1a8f(0xd7)},'batch_code':{'$first':_0x5d1a8f(0x12b)},'room':{'$first':_0x5d1a8f(0xe1)}}}]);let _0x1ca70e;if(_0x44c1e0[_0x5d1a8f(0xd0)]==_0x5d1a8f(0xd9)){const _0xda649d=await staff[_0x5d1a8f(0x114)]({'email':_0x44c1e0['email']});_0x1ca70e=await warehouse[_0x5d1a8f(0x118)]([{'$match':{'status':_0x5d1a8f(0xf9),'name':_0xda649d['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5d1a8f(0xbd)}}},{'$group':{'_id':_0x5d1a8f(0x94),'name':{'$first':_0x5d1a8f(0x94)}}}]);}else _0x1ca70e=await warehouse['aggregate']([{'$match':{'status':_0x5d1a8f(0xf9),'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x5d1a8f(0x94),'name':{'$first':_0x5d1a8f(0x94)}}}]);if(_0x21662e[0x0][_0x5d1a8f(0x158)]==_0x5d1a8f(0xb2)){var _0x2acfbd=users['English'];console['log'](_0x2acfbd);}else{if(_0x21662e[0x0][_0x5d1a8f(0x158)]==_0x5d1a8f(0x136))var _0x2acfbd=users['Hindi'];else{if(_0x21662e[0x0]['language']==_0x5d1a8f(0x116))var _0x2acfbd=users[_0x5d1a8f(0x116)];else{if(_0x21662e[0x0][_0x5d1a8f(0x158)]==_0x5d1a8f(0x85))var _0x2acfbd=users[_0x5d1a8f(0x85)];else{if(_0x21662e[0x0][_0x5d1a8f(0x158)]==_0x5d1a8f(0x11a))var _0x2acfbd=users[_0x5d1a8f(0x11a)];else{if(_0x21662e[0x0][_0x5d1a8f(0x158)]=='Portuguese\x20(BR)')var _0x2acfbd=users[_0x5d1a8f(0x106)];else{if(_0x21662e[0x0][_0x5d1a8f(0x158)]=='Chinese')var _0x2acfbd=users[_0x5d1a8f(0x14b)];else{if(_0x21662e[0x0][_0x5d1a8f(0x158)]==_0x5d1a8f(0xbf))var _0x2acfbd=users[_0x5d1a8f(0xf3)];}}}}}}}_0x274f12['render'](_0x5d1a8f(0xca),{'success':_0x45f4f7[_0x5d1a8f(0xd4)]('success'),'errors':_0x45f4f7['flash']('errors'),'role':_0x44c1e0,'profile':_0x5ad8ab,'adjustment':_0xc23c4a,'stock':_0x327cb5,'master_shop':_0x21662e,'warehouse_name':_0x4a8482,'unit':_0xcc2c01,'language':_0x2acfbd,'warehouse':_0x1ca70e});}catch(_0x2318dc){console[_0x5d1a8f(0x11b)](_0x2318dc),_0x274f12[_0x5d1a8f(0x10e)](0xc8)[_0x5d1a8f(0xce)]({'message':_0x2318dc[_0x5d1a8f(0xdd)]});}}),router[a0_0x22c6d6(0x12a)](a0_0x22c6d6(0x97),auth,async(_0xec9993,_0x4d453e)=>{var _0x57ebc0=a0_0x22c6d6;try{const _0x1704a1=_0xec9993[_0x57ebc0(0x100)]['id'],_0x96c92a=await adjustment[_0x57ebc0(0xe0)]({'_id':_0x1704a1}),_0x194451=await warehouse[_0x57ebc0(0x114)]({'name':_0x96c92a[_0x57ebc0(0x131)],'room':_0x96c92a[_0x57ebc0(0x88)]}),{warehouse_name:_0x16d9bf,date:_0x44e3e5,prod_name:_0x596a62,level:_0x53e489,isle:_0x5e1e8e,pallet:_0x1f87c8,stock:_0x42c06c,types:_0x4dee29,adjust_qty:_0x484e9f,new_adjust_qty:_0x5a6014,note:_0x4ba061,Room_name:_0x4d34c0,invoice:_0x1faee0,JO_number:_0x1c472f,expiry_date:_0x1ca0dd}=_0xec9993['body'];if(typeof _0x596a62==_0x57ebc0(0xb6))var _0x24ee18=[_0xec9993['body'][_0x57ebc0(0x8e)]],_0x5a25fb=[_0xec9993[_0x57ebc0(0x8b)]['level']],_0x539616=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xdc)]],_0x4e79c8=[_0xec9993['body'][_0x57ebc0(0xd1)]],_0x18359e=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x89)]],_0x336d10=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x10c)]],_0x5a0e18=[_0xec9993['body'][_0x57ebc0(0x83)]],_0x113187=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xc0)]],_0x3e77cd=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xf4)]],_0x78ae81=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x11f)]],_0x4f37af=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x102)]],_0xf091dc=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xc3)]],_0x514626=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x9b)]],_0x2ba7cb=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xed)]],_0x42bec7=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xa2)]],_0x36e5e0=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xcc)]],_0x53f09c=[_0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x145)]];else var _0x24ee18=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x8e)]],_0x5a25fb=[..._0xec9993['body']['level']],_0x539616=[..._0xec9993[_0x57ebc0(0x8b)]['stock']],_0x4e79c8=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xd1)]],_0x18359e=[..._0xec9993['body'][_0x57ebc0(0x89)]],_0x336d10=[..._0xec9993['body']['New_Qty_Converted']],_0x5a0e18=[..._0xec9993['body'][_0x57ebc0(0x13c)]],_0x113187=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xc0)]],_0x3e77cd=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xf4)]],_0x78ae81=[..._0xec9993[_0x57ebc0(0x8b)]['batch_code']],_0x4f37af=[..._0xec9993[_0x57ebc0(0x8b)]['expiry_date']],_0xf091dc=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xc3)]],_0x514626=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0x9b)]],_0x2ba7cb=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xed)]],_0x42bec7=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xa2)]],_0x36e5e0=[..._0xec9993[_0x57ebc0(0x8b)][_0x57ebc0(0xcc)]],_0x53f09c=[..._0xec9993[_0x57ebc0(0x8b)]['second1']];const _0x1a747=_0x24ee18[_0x57ebc0(0xf7)](_0x41fb69=>{return _0x41fb69={'product_name':_0x41fb69};});_0x5a25fb[_0x57ebc0(0x140)]((_0x58bee6,_0x5d1d98)=>{var _0x1854e8=_0x57ebc0;_0x42bec7[_0x1854e8(0x140)]((_0x4bd760,_0x443d6e)=>{var _0x1aeb7b=_0x1854e8;if(_0x4bd760==_0x1aeb7b(0xfe)&&_0x5d1d98==_0x443d6e){var _0x52b1d6=_0x58bee6[_0x1aeb7b(0xf0)](0x3);_0x1a747[_0x5d1d98][_0x1aeb7b(0xfa)]=_0x58bee6[0x0],_0x1a747[_0x5d1d98][_0x1aeb7b(0xfd)]=_0x58bee6[0x1],_0x1a747[_0x5d1d98][_0x1aeb7b(0xfb)]=0x0,_0x1a747[_0x5d1d98][_0x1aeb7b(0x86)]=0x0,_0x1a747[_0x5d1d98][_0x1aeb7b(0x134)]=_0x1aeb7b(0xc4),_0x1a747[_0x5d1d98][_0x1aeb7b(0x10a)]=_0x52b1d6;}else{if(_0x4bd760==_0x1aeb7b(0xb4)&&_0x5d1d98==_0x443d6e){var _0x52b1d6=_0x58bee6[_0x1aeb7b(0xf0)](0x3);_0x1a747[_0x5d1d98][_0x1aeb7b(0xfa)]=_0x58bee6[0x0],_0x1a747[_0x5d1d98][_0x1aeb7b(0xfd)]=_0x58bee6[0x1],_0x1a747[_0x5d1d98][_0x1aeb7b(0xfb)]=0x0,_0x1a747[_0x5d1d98]['bin']=0x0,_0x1a747[_0x5d1d98][_0x1aeb7b(0x134)]=_0x1aeb7b(0xc4),_0x1a747[_0x5d1d98][_0x1aeb7b(0x10a)]=_0x58bee6[0x5];}else{if(_0x5d1d98==_0x443d6e){var _0x54be85;if(_0x58bee6[0x4]=='L')_0x54be85='Level';else _0x58bee6[0x4]=='F'&&(_0x54be85=_0x1aeb7b(0xc4));_0x1a747[_0x5d1d98]['storage']=_0x58bee6[0x0],_0x1a747[_0x5d1d98][_0x1aeb7b(0xfd)]=_0x58bee6[0x1],_0x1a747[_0x5d1d98][_0x1aeb7b(0xfb)]=_0x58bee6[0x2],_0x1a747[_0x5d1d98][_0x1aeb7b(0x86)]=_0x58bee6[0x3],_0x1a747[_0x5d1d98]['type']=_0x54be85,_0x1a747[_0x5d1d98][_0x1aeb7b(0x10a)]=_0x58bee6[0x5];}}}});}),_0x539616['forEach']((_0x51df6e,_0x2b66e3)=>{var _0x57b228=_0x57ebc0;_0x1a747[_0x2b66e3][_0x57b228(0x157)]=_0x51df6e;}),_0x4e79c8[_0x57ebc0(0x140)]((_0x3ebc5d,_0x23b136)=>{var _0x44e7ec=_0x57ebc0;_0x1a747[_0x23b136][_0x44e7ec(0xd1)]=_0x3ebc5d;}),_0x18359e[_0x57ebc0(0x140)]((_0x546feb,_0x209cbb)=>{var _0x5f22ad=_0x57ebc0;_0x1a747[_0x209cbb][_0x5f22ad(0x147)]=_0x546feb;}),_0x336d10[_0x57ebc0(0x140)]((_0x242c82,_0x2f5564)=>{var _0x372dd8=_0x57ebc0;_0x1a747[_0x2f5564][_0x372dd8(0xb1)]=_0x242c82;}),_0x5a0e18[_0x57ebc0(0x140)]((_0x3e5a73,_0x14ef4b)=>{var _0x1b527b=_0x57ebc0;_0x1a747[_0x14ef4b][_0x1b527b(0x13c)]=_0x3e5a73;}),_0x113187[_0x57ebc0(0x140)]((_0x589513,_0x47a270)=>{_0x1a747[_0x47a270]['secondary_unit']=_0x589513;}),_0x3e77cd[_0x57ebc0(0x140)]((_0x1501ee,_0x58f0e3)=>{var _0x6e20f2=_0x57ebc0;_0x1a747[_0x58f0e3][_0x6e20f2(0xc1)]=_0x1501ee;}),_0x78ae81[_0x57ebc0(0x140)]((_0x4703dc,_0x598a6d)=>{var _0x8d439f=_0x57ebc0;_0x1a747[_0x598a6d][_0x8d439f(0x11f)]=_0x4703dc;}),_0x4f37af[_0x57ebc0(0x140)]((_0x199efc,_0x465b2c)=>{var _0xb197bd=_0x57ebc0;_0x1a747[_0x465b2c][_0xb197bd(0x102)]=_0x199efc;}),_0xf091dc[_0x57ebc0(0x140)]((_0x5a464e,_0x19e5af)=>{var _0x37f622=_0x57ebc0;_0x1a747[_0x19e5af][_0x37f622(0x132)]=_0x5a464e;}),_0x514626[_0x57ebc0(0x140)]((_0x92144,_0x57f154)=>{var _0x9f31f1=_0x57ebc0;_0x1a747[_0x57f154][_0x9f31f1(0x9b)]=_0x92144;}),_0x2ba7cb['forEach']((_0x1d514e,_0x469c0b)=>{var _0x229406=_0x57ebc0;_0x1a747[_0x469c0b][_0x229406(0xed)]=_0x1d514e;}),_0x42bec7[_0x57ebc0(0x140)]((_0x53fefd,_0xaec591)=>{var _0x8f20f9=_0x57ebc0;_0x1a747[_0xaec591][_0x8f20f9(0xe5)]=_0x53fefd;}),_0x36e5e0[_0x57ebc0(0x140)]((_0x5d0c18,_0x215d60)=>{var _0x2a6379=_0x57ebc0;_0x1a747[_0x215d60][_0x2a6379(0x10d)]=_0x5d0c18;}),_0x53f09c['forEach']((_0x3cba75,_0x11c0e5)=>{var _0xe1da97=_0x57ebc0;_0x1a747[_0x11c0e5][_0xe1da97(0x15a)]=_0x3cba75;});const _0x36fe7a=_0x1a747['filter'](_0x48423c=>_0x48423c[_0x57ebc0(0x147)]!=='0'&&_0x48423c[_0x57ebc0(0x147)]!=='');var _0x5816f5=0x0;_0x36fe7a[_0x57ebc0(0x140)](_0x19e061=>{var _0x4c1eb9=_0x57ebc0;console['log'](_0x4c1eb9(0x12f),_0x19e061),parseInt(_0x19e061[_0x4c1eb9(0x147)])<=0x0&&_0x5816f5++;});if(_0x5816f5!=0x0)return _0xec9993['flash'](_0x57ebc0(0x122),_0x57ebc0(0xd8)),_0x4d453e[_0x57ebc0(0xf2)](_0x57ebc0(0xf6));_0x96c92a[_0x57ebc0(0x131)]=_0x16d9bf,_0x96c92a[_0x57ebc0(0x139)]=_0x44e3e5,_0x96c92a[_0x57ebc0(0x111)]=_0x36fe7a,_0x96c92a['note']=_0x4ba061,_0x96c92a[_0x57ebc0(0x10f)]=_0x1faee0,_0x96c92a['isAllowEdit']=_0x57ebc0(0xae);const _0xd6a546=await _0x96c92a[_0x57ebc0(0xcf)]();_0xec9993['flash'](_0x57ebc0(0xac),_0x57ebc0(0xbc)),_0x4d453e['redirect']('/adjustment/view');}catch(_0x59f818){console[_0x57ebc0(0x11b)](_0x59f818);}}),router['post'](a0_0x22c6d6(0xfc),async(_0x3b9bfb,_0x1e9aae)=>{var _0x35be07=a0_0x22c6d6;const {primary_code:_0x3e28c8,warehouse_data:_0x3750da,rooms_data:_0x1a81e7,Roomslist:_0x24ae8e}=_0x3b9bfb[_0x35be07(0x8b)],_0xeb0ed=_0x24ae8e[_0x35be07(0x141)](','),_0x35b943=[];async function _0x15f999(_0x2d928d){var _0x293e69=_0x35be07;const _0x2e55b1=await warehouse['aggregate']([{'$match':{'name':_0x3750da,'room':_0x2d928d}},{'$unwind':_0x293e69(0xa8)},{'$match':{'product_details.primary_code':_0x3e28c8}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x293e69(0x9e)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x293e69(0xaa)},'isle':{'$first':_0x293e69(0xee)},'type':{'$first':_0x293e69(0x137)},'pallet':{'$first':_0x293e69(0xa0)},'unit':{'$first':_0x293e69(0x159)},'secondary_unit':{'$first':_0x293e69(0x9c)},'storage':{'$first':_0x293e69(0x128)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x293e69(0xd7)},'maxPerUnit':{'$first':_0x293e69(0xb3)},'batch_code':{'$first':_0x293e69(0x12b)},'product_cat':{'$first':_0x293e69(0x115)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x293e69(0xe1)},'invoice':{'$first':_0x293e69(0x127)}}}]),_0x45c10a=await warehouse[_0x293e69(0x118)]([{'$match':{'name':_0x3750da,'room':_0x2d928d}},{'$unwind':_0x293e69(0xa8)},{'$match':{'product_details.secondary_code':_0x3e28c8}},{'$group':{'_id':_0x293e69(0x92),'name':{'$first':_0x293e69(0x11d)},'product_stock':{'$first':_0x293e69(0x112)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x293e69(0x9e)},'product_code':{'$first':_0x293e69(0x12c)},'level':{'$first':_0x293e69(0xaa)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x293e69(0x137)},'pallet':{'$first':_0x293e69(0xa0)},'unit':{'$first':_0x293e69(0x159)},'secondary_unit':{'$first':_0x293e69(0x9c)},'storage':{'$first':_0x293e69(0x128)},'rack':{'$first':_0x293e69(0x103)},'expiry_date':{'$first':_0x293e69(0x104)},'production_date':{'$first':_0x293e69(0xd7)},'maxPerUnit':{'$first':_0x293e69(0xb3)},'batch_code':{'$first':_0x293e69(0x12b)},'product_cat':{'$first':_0x293e69(0x115)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x293e69(0xe1)}}}]);if(_0x2e55b1[_0x293e69(0xa6)]>0x0)_0x35b943[_0x293e69(0xb9)](_0x2e55b1);else _0x45c10a['length']>0x0&&_0x35b943[_0x293e69(0xb9)](_0x45c10a);}const _0x5483ff=_0xeb0ed[_0x35be07(0xf7)](_0x5e35ac=>_0x15f999(_0x5e35ac));await Promise[_0x35be07(0xe7)](_0x5483ff),_0x1e9aae[_0x35be07(0xce)](_0x35b943);}),router[a0_0x22c6d6(0x12a)]('/CheckingWarehouse',async(_0x23a321,_0x3a52b2)=>{var _0x106e5c=a0_0x22c6d6;const {primaryCode:_0x5122de,secondaryCode:_0xdb8679,productCode:_0x15f7be,level:_0x5c4335,isle:_0xbc0221,pallet:_0x2e0929,warehouses:_0x38d56b,room:_0x3aec5b}=_0x23a321['body'];try{const _0x564892=await warehouse[_0x106e5c(0x118)]([{'$match':{'name':_0x38d56b,'room':_0x3aec5b}},{'$unwind':_0x106e5c(0xa8)},{'$match':{'product_details.level':parseInt(_0x5c4335),'product_details.isle':_0xbc0221,'product_details.pallet':parseInt(_0x2e0929)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x106e5c(0x11d)},'product_stock':{'$first':_0x106e5c(0x112)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x106e5c(0xa3)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x106e5c(0xd2)}}}]);_0x3a52b2[_0x106e5c(0x10e)](0xc8)[_0x106e5c(0xce)](_0x564892);}catch(_0x205cdd){_0x3a52b2[_0x106e5c(0x10e)](0x194)['json']({'message':_0x205cdd['message']});}}),module[a0_0x22c6d6(0xb5)]=router;