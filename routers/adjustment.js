var a0_0x4c185e=a0_0x912b;function a0_0xed19(){var _0x4bb3dc=['$product_details.secondary_code','772390NdTLEC','An\x20error\x20occurred\x20while\x20saving\x20data.','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','success','<div>','id_transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<!DOCTYPE\x20html>','sendMail','<hr\x20class=\x22my-3\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','rack','level','createTransport','\x20</h2>','$product_details.storage','/barcode_scanner','message','Shelves','\x20Order\x20Number\x20:\x20','</head><body>','product','length','German','$product_details.bin','redirect','$product_details.unit','types','stockBefore','$product_details.expiry_date','/view','nodemailer','bin','new_adjust_qty','catch','split','Email\x20sent\x20successfully','params','note','host','error','primary_code','../public/language/languages.json','<h2>\x20','$isAllowEdit','35Wxlhne','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.product_stock','Raw\x20Materials','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Arabic\x20(ae)','_id','map','$product.product_name','add_adjustment','807732ooIyzp','796888UjrwKJ','<table\x20style=\x22width:\x20100%\x20!important;\x22>','expiry_date','role','site_title','warehouse','back','$product_details.isle','New_Qty_Converted','7259544FmESpK','forEach','</tr>','secondary_code','Adjustment\x20Mail','Portuguese','</table>','stock','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','RMSEmail','/preview/:id','/adjustment/preview/','type','product_name','floorlevel','$product_details.product_name','Floor','string','storage','secondary_unit','$_id','$product_details._id','$product_details.type','prod_cat','findById','Level','English\x20(US)','$warehouse_name','language','aggregate','ADJ-','password','/picking_list/PDF_adjustment_rm/','render','/CheckingWarehouse','maxperunit','bay','staff','production_date','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<strong>\x20Regards\x20</strong>','user','$product_details.maxPerUnit','277893XTgbnU','/upload/','True','unit','edit_adjustment','flash','save','prod_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','prime1','</h5>','prod_invoice','45639sxyuyK','$product_details','prod_name','</div>','</td>','max_per_unit','product_stock','../models/all_models','adjust_qty','/adjustment/view','Hindi','</thead>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','findOne','$product_details.production_date','Secondary_units','Enabled','get','17550zkRsnO','id_transaction_from','Spanish','logo','Chinese','product_code','$product','post','New_Qty_Converted_adj','/view/:id','all','$name','status','$product_details.floorlevel','second1','adjustment\x20data\x20update\x20successfully','warehouse_name','<h5>','</body></html>','push','foreach\x20newproduct','batch_code','email','errors','minus','Error\x20Occurs','random','slice','46pclLXW','log','\x20<>\x20','Primary_Units','/view/add_adjustment','Portuguese\x20(BR)','then','body','toString','$product_details.level','$product_details.product_cat','$product_details.secondary_unit','json','$product_details.batch_code','Enclosed','English','date','Arabic','Return\x20Goods','Logo.png','French','$room','adjustment\x20Finalized\x20successfully','<span\x20style=\x22float:\x20right;\x22>','room','$product_details.rack','$product_details.product_code','room_names','$product.room_names','$invoice','invoice','Rooms','$product_details.primary_code','$finalize','filter','\x20Order\x20Date\x20:\x20','port','<h5\x20style=\x22text-align:\x20left;\x22>','Receiving\x20Area','find'];a0_0xed19=function(){return _0x4bb3dc;};return a0_0xed19();}(function(_0x2d7420,_0x4ca260){var _0x622fcc=a0_0x912b,_0x153f0a=_0x2d7420();while(!![]){try{var _0x162fc0=parseInt(_0x622fcc(0x289))/0x1+parseInt(_0x622fcc(0x1ef))/0x2*(-parseInt(_0x622fcc(0x297))/0x3)+-parseInt(_0x622fcc(0x250))/0x4+-parseInt(_0x622fcc(0x218))/0x5+parseInt(_0x622fcc(0x1d3))/0x6*(-parseInt(_0x622fcc(0x245))/0x7)+-parseInt(_0x622fcc(0x251))/0x8+parseInt(_0x622fcc(0x25a))/0x9;if(_0x162fc0===_0x4ca260)break;else _0x153f0a['push'](_0x153f0a['shift']());}catch(_0x42e023){_0x153f0a['push'](_0x153f0a['shift']());}}}(a0_0xed19,0x4071b));function a0_0x912b(_0x44a718,_0x3093b2){var _0xed19df=a0_0xed19();return a0_0x912b=function(_0x912b35,_0x3afef9){_0x912b35=_0x912b35-0x1d3;var _0x4ff859=_0xed19df[_0x912b35];return _0x4ff859;},a0_0x912b(_0x44a718,_0x3093b2);}const express=require('express'),app=express(),router=express['Router'](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x4c185e(0x29e)),users=require(a0_0x4c185e(0x242)),nodemailer=require(a0_0x4c185e(0x237));router[a0_0x4c185e(0x2a8)](a0_0x4c185e(0x236),auth,async(_0x8a0763,_0x26b79e)=>{var _0x48631d=a0_0x4c185e;try{const {username:_0x31c3c6,email:_0x18c1da,role:_0x476745}=_0x8a0763[_0x48631d(0x287)],_0x1f7ac0=_0x8a0763[_0x48631d(0x287)],_0x54a6ca=await profile['findOne']({'email':_0x1f7ac0[_0x48631d(0x1e9)]}),_0x121ce2=await master_shop[_0x48631d(0x216)]();console['log']('master',_0x121ce2);let _0x35ca2e;if(_0x1f7ac0[_0x48631d(0x254)]==_0x48631d(0x282)){const _0x4196b4=await staff[_0x48631d(0x2a4)]({'email':_0x1f7ac0[_0x48631d(0x1e9)]});_0x35ca2e=await warehouse['find']({'status':_0x48631d(0x2a7),'name':_0x4196b4['warehouse']});}else _0x35ca2e=await warehouse[_0x48631d(0x216)]({'status':'Enabled'});const _0xe0e8df=await product[_0x48631d(0x216)]();let _0x52953f;if(_0x1f7ac0[_0x48631d(0x254)]==_0x48631d(0x282)){const _0x362a88=await staff[_0x48631d(0x2a4)]({'email':_0x1f7ac0['email']});_0x52953f=await adjustment[_0x48631d(0x216)]({'warehouse_name':_0x362a88[_0x48631d(0x256)]});}else _0x52953f=await adjustment['aggregate']([{'$unwind':_0x48631d(0x1d9)},{'$group':{'_id':_0x48631d(0x271),'invoice':{'$first':_0x48631d(0x20c)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x48631d(0x278)},'room':{'$addToSet':_0x48631d(0x20b)},'finalize':{'$first':_0x48631d(0x210)},'isAllowEdit':{'$first':_0x48631d(0x244)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x121ce2[0x0][_0x48631d(0x279)]==_0x48631d(0x277)){var _0xa1a897=users[_0x48631d(0x1fe)];console[_0x48631d(0x1f0)](_0xa1a897);}else{if(_0x121ce2[0x0][_0x48631d(0x279)]==_0x48631d(0x2a1))var _0xa1a897=users['Hindi'];else{if(_0x121ce2[0x0][_0x48631d(0x279)]==_0x48631d(0x22f))var _0xa1a897=users['German'];else{if(_0x121ce2[0x0][_0x48631d(0x279)]==_0x48631d(0x1d5))var _0xa1a897=users['Spanish'];else{if(_0x121ce2[0x0]['language']=='French')var _0xa1a897=users[_0x48631d(0x203)];else{if(_0x121ce2[0x0][_0x48631d(0x279)]=='Portuguese\x20(BR)')var _0xa1a897=users[_0x48631d(0x25f)];else{if(_0x121ce2[0x0][_0x48631d(0x279)]==_0x48631d(0x1d7))var _0xa1a897=users[_0x48631d(0x1d7)];else{if(_0x121ce2[0x0][_0x48631d(0x279)]==_0x48631d(0x24b))var _0xa1a897=users[_0x48631d(0x200)];}}}}}}}_0x26b79e[_0x48631d(0x27e)]('adjustment',{'success':_0x8a0763[_0x48631d(0x28e)](_0x48631d(0x21b)),'errors':_0x8a0763[_0x48631d(0x28e)]('errors'),'role':_0x1f7ac0,'profile':_0x54a6ca,'warehouse':_0x35ca2e,'product':_0xe0e8df,'adjustment':_0x52953f,'master_shop':_0x121ce2,'language':_0xa1a897});}catch(_0x47bd84){console[_0x48631d(0x1f0)](_0x47bd84);}});async function getRandom8DigitNumber(){var _0x37bc48=a0_0x4c185e;const _0x1fbcb3=0x989680,_0x4dd1bf=0x5f5e0ff,_0x19041a=Math['floor'](Math[_0x37bc48(0x1ed)]()*(_0x4dd1bf-_0x1fbcb3+0x1))+_0x1fbcb3;var _0x1e00b0;const _0x56077e=await adjustment['findOne']({'invoice':'ADJ-'+_0x19041a});return _0x56077e&&_0x56077e[_0x37bc48(0x22e)]>0x0?_0x1e00b0='ADJ-'+_0x19041a:_0x1e00b0=_0x37bc48(0x27b)+_0x19041a,_0x1e00b0;}router['get'](a0_0x4c185e(0x1f3),auth,async(_0x891869,_0x35287c)=>{var _0x117ba5=a0_0x4c185e;try{const {username:_0x52f5d8,email:_0x59d8d0,role:_0x3eb50e}=_0x891869['user'],_0x717371=_0x891869['user'],_0x5e3357=await profile[_0x117ba5(0x2a4)]({'email':_0x717371['email']}),_0x2fdc6f=await master_shop[_0x117ba5(0x216)]();let _0x3109c3;if(_0x717371['role']==_0x117ba5(0x282)){const _0x36053b=await staff['findOne']({'email':_0x717371[_0x117ba5(0x1e9)]});_0x3109c3=await warehouse[_0x117ba5(0x27a)]([{'$match':{'status':'Enabled','name':_0x36053b[_0x117ba5(0x256)],'warehouse_category':_0x117ba5(0x248),'name':{'$ne':_0x117ba5(0x201)}}},{'$group':{'_id':'$name','name':{'$first':_0x117ba5(0x1de)}}}]);}else _0x3109c3=await warehouse[_0x117ba5(0x27a)]([{'$match':{'status':_0x117ba5(0x2a7),'warehouse_category':_0x117ba5(0x248),'name':{'$ne':_0x117ba5(0x201)}}},{'$group':{'_id':'$name','name':{'$first':_0x117ba5(0x1de)}}}]);const _0x5ab2b1=await product[_0x117ba5(0x216)]({}),_0x1ea4a2=await adjustment[_0x117ba5(0x216)]({}),_0x372d5d=_0x1ea4a2[_0x117ba5(0x22e)]+0x1,_0x459920='ADJ-'+_0x372d5d[_0x117ba5(0x1f7)]()['padStart'](0x5,'0');var _0x4fc115=['Ambient',_0x117ba5(0x1fd),'Return\x20Rooms'];if(_0x2fdc6f[0x0][_0x117ba5(0x279)]==_0x117ba5(0x277))var _0x182b83=users['English'];else{if(_0x2fdc6f[0x0][_0x117ba5(0x279)]=='Hindi')var _0x182b83=users[_0x117ba5(0x2a1)];else{if(_0x2fdc6f[0x0]['language']==_0x117ba5(0x22f))var _0x182b83=users[_0x117ba5(0x22f)];else{if(_0x2fdc6f[0x0]['language']==_0x117ba5(0x1d5))var _0x182b83=users[_0x117ba5(0x1d5)];else{if(_0x2fdc6f[0x0][_0x117ba5(0x279)]==_0x117ba5(0x203))var _0x182b83=users['French'];else{if(_0x2fdc6f[0x0][_0x117ba5(0x279)]==_0x117ba5(0x1f4))var _0x182b83=users[_0x117ba5(0x25f)];else{if(_0x2fdc6f[0x0][_0x117ba5(0x279)]==_0x117ba5(0x1d7))var _0x182b83=users[_0x117ba5(0x1d7)];else{if(_0x2fdc6f[0x0]['language']==_0x117ba5(0x24b))var _0x182b83=users[_0x117ba5(0x200)];}}}}}}}const _0x41328c=getRandom8DigitNumber();_0x41328c[_0x117ba5(0x1f5)](_0x41255d=>{var _0x45d528=_0x117ba5;_0x35287c[_0x45d528(0x27e)](_0x45d528(0x24f),{'success':_0x891869[_0x45d528(0x28e)](_0x45d528(0x21b)),'errors':_0x891869[_0x45d528(0x28e)](_0x45d528(0x1ea)),'role':_0x717371,'profile':_0x5e3357,'warehouse':_0x3109c3,'product':_0x5ab2b1,'master_shop':_0x2fdc6f,'language':_0x182b83,'rooms_data':_0x4fc115,'invoice_no':_0x41255d});})[_0x117ba5(0x23a)](_0x5f5436=>{var _0x3012fd=_0x117ba5;_0x891869['flash'](_0x3012fd(0x1ea),_0x3012fd(0x265)),_0x35287c['redirect'](_0x3012fd(0x2a0));});}catch(_0x47aecc){console['log'](_0x47aecc);}}),router['post']('/view/add_adjustment',auth,async(_0xa062f5,_0x5749d8)=>{var _0x5a8a8f=a0_0x4c185e;try{const {warehouse_name:_0x423aa2,date:_0x3cf8ba,prod_name:_0x40a5b7,level:_0x1bd4d1,isle:_0x1013c1,pallet:_0xed577c,stock:_0x1f85f7,types:_0x123829,adjust_qty:_0x4ea214,new_adjust_qty:_0x2ff4d3,note:_0x5cef92,Room_name:_0xac13d,invoice:_0x2df445,JO_number:_0x4f9537,expiry_date:_0x3e065b}=_0xa062f5[_0x5a8a8f(0x1f6)];if(typeof _0x40a5b7=='string')var _0x2120ec=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x299)]],_0x59da89=[_0xa062f5[_0x5a8a8f(0x1f6)]['level']],_0x33a14a=[_0xa062f5['body'][_0x5a8a8f(0x261)]],_0x9c71c4=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x233)]],_0x283f0c=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x1db)]],_0x3aa7db=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x259)]],_0x1895b6=[_0xa062f5['body'][_0x5a8a8f(0x1f2)]],_0x382f8c=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x2a6)]],_0x3f40d4=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x290)]],_0x300aa3=[_0xa062f5['body'][_0x5a8a8f(0x1e8)]],_0x3ae9c0=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x253)]],_0x156d89=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x29c)]],_0x26f14d=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x283)]],_0x258d5e=[_0xa062f5['body'][_0x5a8a8f(0x274)]],_0x2ec464=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x20e)]],_0x32ef01=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x294)]],_0x4cb9bf=[_0xa062f5['body'][_0x5a8a8f(0x1e1)]],_0x31b460=[_0xa062f5['body'][_0x5a8a8f(0x296)]],_0x44f03f=[_0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x21d)]];else var _0x2120ec=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x299)]],_0x59da89=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x224)]],_0x33a14a=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x261)]],_0x9c71c4=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x233)]],_0x283f0c=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x1db)]],_0x3aa7db=[..._0xa062f5[_0x5a8a8f(0x1f6)]['New_Qty_Converted']],_0x1895b6=[..._0xa062f5['body'][_0x5a8a8f(0x28c)]],_0x382f8c=[..._0xa062f5['body'][_0x5a8a8f(0x2a6)]],_0x3f40d4=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x290)]],_0x300aa3=[..._0xa062f5[_0x5a8a8f(0x1f6)]['batch_code']],_0x3ae9c0=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x253)]],_0x156d89=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x29c)]],_0x26f14d=[..._0xa062f5[_0x5a8a8f(0x1f6)]['production_date']],_0x258d5e=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x274)]],_0x2ec464=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x20e)]],_0x32ef01=[..._0xa062f5['body']['prime1']],_0x4cb9bf=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x1e1)]],_0x31b460=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x296)]],_0x44f03f=[..._0xa062f5[_0x5a8a8f(0x1f6)][_0x5a8a8f(0x21d)]];const _0x4c0c20=_0x2120ec[_0x5a8a8f(0x24d)](_0x2d5d3f=>{return _0x2d5d3f={'product_name':_0x2d5d3f};});_0x59da89[_0x5a8a8f(0x25b)]((_0x2a0b1c,_0x110da0)=>{var _0x7683fd=_0x5a8a8f;_0x2ec464[_0x7683fd(0x25b)]((_0x3f8869,_0x3ffaea)=>{var _0x9373b0=_0x7683fd;if(_0x3f8869=='Receiving\x20Area'&&_0x110da0==_0x3ffaea){var _0x5845f3=_0x2a0b1c[_0x9373b0(0x1ee)](0x3);_0x4c0c20[_0x110da0]['storage']=_0x2a0b1c[0x0],_0x4c0c20[_0x110da0][_0x9373b0(0x223)]=_0x2a0b1c[0x1],_0x4c0c20[_0x110da0][_0x9373b0(0x281)]=0x0,_0x4c0c20[_0x110da0][_0x9373b0(0x238)]=0x0,_0x4c0c20[_0x110da0][_0x9373b0(0x269)]=_0x9373b0(0x26d),_0x4c0c20[_0x110da0][_0x9373b0(0x26b)]=_0x5845f3;}else{if(_0x3f8869=='Shelves'&&_0x110da0==_0x3ffaea){var _0x5845f3=_0x2a0b1c[_0x9373b0(0x1ee)](0x3);_0x4c0c20[_0x110da0][_0x9373b0(0x26f)]=_0x2a0b1c[0x0],_0x4c0c20[_0x110da0][_0x9373b0(0x223)]=_0x2a0b1c[0x1],_0x4c0c20[_0x110da0][_0x9373b0(0x281)]=0x0,_0x4c0c20[_0x110da0]['bin']=0x0,_0x4c0c20[_0x110da0][_0x9373b0(0x269)]=_0x9373b0(0x26d),_0x4c0c20[_0x110da0][_0x9373b0(0x26b)]=_0x2a0b1c[0x5];}else{if(_0x110da0==_0x3ffaea){var _0x17e5e7;if(_0x2a0b1c[0x4]=='L')_0x17e5e7='Level';else _0x2a0b1c[0x4]=='F'&&(_0x17e5e7=_0x9373b0(0x26d));_0x4c0c20[_0x110da0][_0x9373b0(0x26f)]=_0x2a0b1c[0x0],_0x4c0c20[_0x110da0]['rack']=_0x2a0b1c[0x1],_0x4c0c20[_0x110da0][_0x9373b0(0x281)]=_0x2a0b1c[0x2],_0x4c0c20[_0x110da0][_0x9373b0(0x238)]=_0x2a0b1c[0x3],_0x4c0c20[_0x110da0]['type']=_0x17e5e7,_0x4c0c20[_0x110da0][_0x9373b0(0x26b)]=_0x2a0b1c[0x5];}}}});}),_0x33a14a[_0x5a8a8f(0x25b)]((_0x1b8031,_0x5c5fea)=>{var _0xa9e3ec=_0x5a8a8f;_0x4c0c20[_0x5c5fea][_0xa9e3ec(0x234)]=_0x1b8031;}),_0x44f03f[_0x5a8a8f(0x25b)]((_0x2945a3,_0x1f3e64)=>{var _0x28dcc9=_0x5a8a8f;_0x4c0c20[_0x1f3e64][_0x28dcc9(0x1d4)]=_0x2945a3;}),_0x9c71c4[_0x5a8a8f(0x25b)]((_0x54496a,_0x2983fd)=>{var _0x359291=_0x5a8a8f;_0x4c0c20[_0x2983fd][_0x359291(0x233)]=_0x54496a;}),_0x283f0c[_0x5a8a8f(0x25b)]((_0x166aab,_0x1e0039)=>{var _0x39a3c8=_0x5a8a8f;_0x4c0c20[_0x1e0039][_0x39a3c8(0x29f)]=_0x166aab;}),_0x3aa7db[_0x5a8a8f(0x25b)]((_0x501a0e,_0x33ded6)=>{var _0x402f51=_0x5a8a8f;_0x4c0c20[_0x33ded6][_0x402f51(0x239)]=_0x501a0e;}),_0x1895b6[_0x5a8a8f(0x25b)]((_0x26974d,_0x523aba)=>{var _0x406708=_0x5a8a8f;_0x4c0c20[_0x523aba][_0x406708(0x28c)]=_0x26974d;}),_0x382f8c[_0x5a8a8f(0x25b)]((_0x2373b1,_0x2f522a)=>{_0x4c0c20[_0x2f522a]['secondary_unit']=_0x2373b1;}),_0x3f40d4[_0x5a8a8f(0x25b)]((_0x4d096f,_0x2a8d48)=>{var _0x36e07a=_0x5a8a8f;_0x4c0c20[_0x2a8d48][_0x36e07a(0x1d8)]=_0x4d096f;}),_0x300aa3['forEach']((_0x271e31,_0x401a37)=>{_0x4c0c20[_0x401a37]['batch_code']=_0x271e31;}),_0x3ae9c0[_0x5a8a8f(0x25b)]((_0x5a5580,_0xe25f73)=>{var _0x2007a4=_0x5a8a8f;_0x4c0c20[_0xe25f73][_0x2007a4(0x253)]=_0x5a5580;}),_0x156d89['forEach']((_0x3d63ea,_0x13f686)=>{var _0x3abaa3=_0x5a8a8f;_0x4c0c20[_0x13f686][_0x3abaa3(0x280)]=_0x3d63ea;}),_0x26f14d[_0x5a8a8f(0x25b)]((_0x4225ac,_0x4963c4)=>{_0x4c0c20[_0x4963c4]['production_date']=_0x4225ac;}),_0x258d5e[_0x5a8a8f(0x25b)]((_0x3d7134,_0x4542dd)=>{var _0x5204ed=_0x5a8a8f;_0x4c0c20[_0x4542dd][_0x5204ed(0x274)]=_0x3d7134;}),_0x2ec464[_0x5a8a8f(0x25b)]((_0x254dbb,_0x1548fe)=>{var _0x414456=_0x5a8a8f;_0x4c0c20[_0x1548fe][_0x414456(0x20a)]=_0x254dbb;}),_0x32ef01[_0x5a8a8f(0x25b)]((_0x480c10,_0x29a387)=>{var _0x4ff562=_0x5a8a8f;_0x4c0c20[_0x29a387][_0x4ff562(0x241)]=_0x480c10;}),_0x4cb9bf[_0x5a8a8f(0x25b)]((_0x31b00e,_0x25ab16)=>{var _0x402cfc=_0x5a8a8f;_0x4c0c20[_0x25ab16][_0x402cfc(0x25d)]=_0x31b00e;}),_0x31b460[_0x5a8a8f(0x25b)]((_0x2a9148,_0x59c9ee)=>{_0x4c0c20[_0x59c9ee]['invoice']=_0x2a9148;});const _0x4e27c0=_0x4c0c20[_0x5a8a8f(0x211)](_0x2b5cc1=>_0x2b5cc1[_0x5a8a8f(0x29f)]!=='0'&&_0x2b5cc1[_0x5a8a8f(0x29f)]!=='');var _0x410fbe=0x0;_0x4e27c0[_0x5a8a8f(0x25b)](_0x3e80fa=>{var _0x3165c0=_0x5a8a8f;console[_0x3165c0(0x1f0)](_0x3165c0(0x1e7),_0x3e80fa),parseInt(_0x3e80fa[_0x3165c0(0x29f)])<=0x0&&_0x410fbe++;});if(_0x410fbe!=0x0)return _0xa062f5[_0x5a8a8f(0x28e)](_0x5a8a8f(0x1ea),_0x5a8a8f(0x246)),_0x5749d8[_0x5a8a8f(0x231)](_0x5a8a8f(0x257));const _0x4b9b81=new adjustment({'warehouse_name':_0x423aa2,'date':_0x3cf8ba,'product':_0x4e27c0,'note':_0x5cef92,'room':_0xac13d,'invoice':_0x2df445,'JO_number':_0x4f9537,'expiry_date':_0x3e065b}),_0x335f9a=await _0x4b9b81[_0x5a8a8f(0x28f)]();_0xa062f5[_0x5a8a8f(0x28e)](_0x5a8a8f(0x21b),'adjustment\x20add\x20successfull'),_0x5749d8[_0x5a8a8f(0x231)](_0x5a8a8f(0x268)+_0x335f9a[_0x5a8a8f(0x24c)]);}catch(_0x80a014){console['log'](_0x80a014),_0x5749d8[_0x5a8a8f(0x1df)](0xc8)[_0x5a8a8f(0x1fb)]({'message':_0x80a014['message']});}}),router[a0_0x4c185e(0x2a8)](a0_0x4c185e(0x267),auth,async(_0x18b935,_0x3d6893)=>{var _0x30c873=a0_0x4c185e;try{const {username:_0x44372d,email:_0x4a6450,role:_0xcbb40b}=_0x18b935[_0x30c873(0x287)],_0x44c2eb=_0x18b935[_0x30c873(0x287)],_0x942ffc=await profile[_0x30c873(0x2a4)]({'email':_0x44c2eb[_0x30c873(0x1e9)]}),_0x455c03=await master_shop[_0x30c873(0x216)](),_0x3b07d0=_0x18b935['params']['id'],_0x5de547=await adjustment[_0x30c873(0x275)]({'_id':_0x3b07d0}),_0x20bea7=await purchases[_0x30c873(0x27a)]([{'$match':{'warehouse_name':_0x5de547[_0x30c873(0x1e3)]}},{'$unwind':'$product'},{'$group':{'_id':_0x30c873(0x24e)}}]),_0x4b21f1=await product[_0x30c873(0x216)]({}),_0x23a10e=await warehouse[_0x30c873(0x27a)]([{'$match':{'name':_0x5de547[_0x30c873(0x1e3)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x30c873(0x26c)},'product_stock':{'$first':_0x30c873(0x247)},'bay':{'$first':_0x30c873(0x249)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x30c873(0x273)},'floorlevel':{'$first':_0x30c873(0x1e0)},'primary_code':{'$first':_0x30c873(0x20f)},'secondary_code':{'$first':_0x30c873(0x217)},'product_code':{'$first':_0x30c873(0x209)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x30c873(0x208)},'maxPerUnit':{'$first':_0x30c873(0x288)},'expiry_date':{'$first':_0x30c873(0x235)},'production_date':{'$first':_0x30c873(0x2a5)},'batch_code':{'$first':_0x30c873(0x1fc)},'room':{'$first':_0x30c873(0x204)}}}]);if(_0x455c03[0x0][_0x30c873(0x279)]=='English\x20(US)'){var _0xaf125c=users[_0x30c873(0x1fe)];console[_0x30c873(0x1f0)](_0xaf125c);}else{if(_0x455c03[0x0][_0x30c873(0x279)]=='Hindi')var _0xaf125c=users[_0x30c873(0x2a1)];else{if(_0x455c03[0x0][_0x30c873(0x279)]==_0x30c873(0x22f))var _0xaf125c=users['German'];else{if(_0x455c03[0x0][_0x30c873(0x279)]==_0x30c873(0x1d5))var _0xaf125c=users['Spanish'];else{if(_0x455c03[0x0][_0x30c873(0x279)]==_0x30c873(0x203))var _0xaf125c=users[_0x30c873(0x203)];else{if(_0x455c03[0x0]['language']==_0x30c873(0x1f4))var _0xaf125c=users[_0x30c873(0x25f)];else{if(_0x455c03[0x0][_0x30c873(0x279)]==_0x30c873(0x1d7))var _0xaf125c=users[_0x30c873(0x1d7)];else{if(_0x455c03[0x0][_0x30c873(0x279)]==_0x30c873(0x24b))var _0xaf125c=users[_0x30c873(0x200)];}}}}}}}_0x3d6893[_0x30c873(0x27e)]('edit_adjustment_view',{'success':_0x18b935[_0x30c873(0x28e)](_0x30c873(0x21b)),'errors':_0x18b935[_0x30c873(0x28e)](_0x30c873(0x1ea)),'role':_0x44c2eb,'profile':_0x942ffc,'adjustment':_0x5de547,'stock':_0x23a10e,'master_shop':_0x455c03,'warehouse_name':_0x20bea7,'unit':_0x4b21f1,'language':_0xaf125c});}catch(_0x507e66){console[_0x30c873(0x1f0)](_0x507e66),_0x3d6893[_0x30c873(0x1df)](0xc8)[_0x30c873(0x1fb)]({'message':_0x507e66[_0x30c873(0x229)]});}}),router[a0_0x4c185e(0x1da)](a0_0x4c185e(0x267),auth,async(_0x56d30d,_0x158c48)=>{var _0x3e4fa1=a0_0x4c185e;try{const _0x316b2a=_0x56d30d[_0x3e4fa1(0x23d)]['id'],{warehouse_name:_0x3dd283,Room_name:_0x18ed98}=_0x56d30d['body'],_0x37301a=await adjustment[_0x3e4fa1(0x275)]({'_id':_0x316b2a}),_0x299ae7=_0x37301a['product'][_0x3e4fa1(0x24d)](async _0x1d5566=>{var _0x3199f7=_0x3e4fa1;if(_0x1d5566['adjust_qty']>0x0){var _0x5dbac5=await warehouse['findOne']({'name':_0x3dd283,'room':_0x1d5566[_0x3199f7(0x20a)],'warehouse_category':'Raw\x20Materials'});const _0x388a00=_0x5dbac5[_0x3199f7(0x292)][_0x3199f7(0x24d)](_0x269a74=>{var _0x3cc1f4=_0x3199f7;if(_0x1d5566[_0x3cc1f4(0x269)]==_0x3cc1f4(0x1eb)){if(_0x269a74[_0x3cc1f4(0x26a)]==_0x1d5566['product_name']&&_0x269a74[_0x3cc1f4(0x26b)]==_0x1d5566[_0x3cc1f4(0x26b)]&&_0x269a74[_0x3cc1f4(0x269)]==_0x1d5566[_0x3cc1f4(0x269)]&&_0x269a74[_0x3cc1f4(0x238)]==_0x1d5566[_0x3cc1f4(0x238)]&&_0x269a74['bay']==_0x1d5566[_0x3cc1f4(0x281)]&&_0x269a74[_0x3cc1f4(0x223)]==_0x1d5566[_0x3cc1f4(0x223)]&&_0x269a74[_0x3cc1f4(0x26f)]==_0x1d5566[_0x3cc1f4(0x26f)]&&_0x269a74['expiry_date']==_0x1d5566[_0x3cc1f4(0x253)]&&_0x269a74['batch_code']==_0x1d5566[_0x3cc1f4(0x1e8)]&&_0x269a74[_0x3cc1f4(0x283)]==_0x1d5566[_0x3cc1f4(0x283)]&&_0x269a74['invoice']==_0x1d5566[_0x3cc1f4(0x20d)]&&_0x269a74[_0x3cc1f4(0x24c)]==_0x1d5566[_0x3cc1f4(0x1d4)]){var _0x276652;_0x276652=_0x1d5566['adjust_qty'],_0x1d5566[_0x3cc1f4(0x274)]=='S'&&(_0x276652=_0x1d5566[_0x3cc1f4(0x29f)]),_0x269a74['product_stock']=_0x269a74[_0x3cc1f4(0x29d)]-_0x276652;}}else{if(_0x269a74['product_name']==_0x1d5566[_0x3cc1f4(0x26a)]&&_0x269a74[_0x3cc1f4(0x26b)]==_0x1d5566['floorlevel']&&_0x269a74[_0x3cc1f4(0x269)]==_0x1d5566[_0x3cc1f4(0x269)]&&_0x269a74['bin']==_0x1d5566[_0x3cc1f4(0x238)]&&_0x269a74[_0x3cc1f4(0x281)]==_0x1d5566['bay']&&_0x269a74[_0x3cc1f4(0x223)]==_0x1d5566[_0x3cc1f4(0x223)]&&_0x269a74[_0x3cc1f4(0x26f)]==_0x1d5566[_0x3cc1f4(0x26f)]&&_0x269a74['expiry_date']==_0x1d5566['expiry_date']&&_0x269a74[_0x3cc1f4(0x1e8)]==_0x1d5566[_0x3cc1f4(0x1e8)]&&_0x269a74[_0x3cc1f4(0x283)]==_0x1d5566[_0x3cc1f4(0x283)]&&_0x269a74[_0x3cc1f4(0x20d)]==_0x1d5566[_0x3cc1f4(0x20d)]&&_0x269a74['_id']==_0x1d5566[_0x3cc1f4(0x1d4)]){console[_0x3cc1f4(0x1f0)](_0x1d5566);var _0x276652;_0x276652=_0x1d5566[_0x3cc1f4(0x29f)],_0x1d5566['prod_cat']=='S'&&(_0x276652=_0x1d5566[_0x3cc1f4(0x29f)]),console[_0x3cc1f4(0x1f0)](_0x276652+_0x3cc1f4(0x1f1)+_0x1d5566[_0x3cc1f4(0x29f)]+_0x3cc1f4(0x1f1)+_0x269a74['maxPerUnit']+'\x20<>\x20'+_0x1d5566[_0x3cc1f4(0x274)]),_0x269a74[_0x3cc1f4(0x29d)]=_0x269a74[_0x3cc1f4(0x29d)]+_0x276652;}}});}return _0x5dbac5;});Promise[_0x3e4fa1(0x1dd)](_0x299ae7)[_0x3e4fa1(0x1f5)](async _0x107bfc=>{var _0x2f4219=_0x3e4fa1;try{for(const _0xd0eb43 of _0x107bfc){await _0xd0eb43[_0x2f4219(0x28f)]();}_0x37301a['finalize']=_0x2f4219(0x28b);const _0x3f4fe4=await _0x37301a[_0x2f4219(0x28f)](),_0x26ba0e=await master_shop[_0x2f4219(0x216)](),_0x37b9e5=await email_settings[_0x2f4219(0x2a4)](),_0x4fc573=await supervisor_settings[_0x2f4219(0x216)]();var _0x4a34d5=_0x37301a[_0x2f4219(0x22d)],_0x431d37='',_0x57d097;for(_0x57d097 in _0x4a34d5){_0x431d37+='<tr>'+_0x2f4219(0x21a)+_0x4a34d5[_0x57d097]['product_name']+_0x2f4219(0x29b)+_0x2f4219(0x21a)+_0x4a34d5[_0x57d097]['product_code']+_0x2f4219(0x29b)+_0x2f4219(0x21a)+_0x4a34d5[_0x57d097][_0x2f4219(0x29f)]+_0x2f4219(0x29b)+_0x2f4219(0x21a)+_0x4a34d5[_0x57d097][_0x2f4219(0x28c)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4a34d5[_0x57d097]['secondary_unit']+_0x2f4219(0x29b)+_0x2f4219(0x21a)+_0x37301a[_0x2f4219(0x1e3)]+_0x2f4219(0x29b)+_0x2f4219(0x21a)+_0x4a34d5[_0x57d097][_0x2f4219(0x20a)]+_0x2f4219(0x29b)+_0x2f4219(0x21a)+_0x4a34d5[_0x57d097][_0x2f4219(0x26f)]+_0x4a34d5[_0x57d097][_0x2f4219(0x223)]+_0x4a34d5[_0x57d097][_0x2f4219(0x281)]+_0x4a34d5[_0x57d097][_0x2f4219(0x238)]+_0x4a34d5[_0x57d097]['type'][0x0]+_0x4a34d5[_0x57d097][_0x2f4219(0x26b)]+_0x2f4219(0x29b),_0x2f4219(0x25c);}let _0x5b71ea=nodemailer[_0x2f4219(0x225)]({'host':_0x37b9e5[_0x2f4219(0x23f)],'port':Number(_0x37b9e5[_0x2f4219(0x213)]),'secure':![],'auth':{'user':_0x37b9e5[_0x2f4219(0x1e9)],'pass':_0x37b9e5[_0x2f4219(0x27c)]}}),_0xaf82e={'from':_0x37b9e5[_0x2f4219(0x1e9)],'to':_0x4fc573[0x0][_0x2f4219(0x266)],'subject':_0x2f4219(0x25e),'attachments':[{'filename':_0x2f4219(0x202),'path':__dirname+'/../public'+_0x2f4219(0x28a)+_0x26ba0e[0x0][_0x2f4219(0x262)],'cid':_0x2f4219(0x1d6)}],'html':_0x2f4219(0x21f)+'<html><head><title></title>'+_0x2f4219(0x22c)+_0x2f4219(0x21c)+_0x2f4219(0x2a3)+_0x2f4219(0x21c)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2f4219(0x29a)+_0x2f4219(0x21c)+_0x2f4219(0x243)+_0x26ba0e[0x0][_0x2f4219(0x255)]+_0x2f4219(0x226)+_0x2f4219(0x29a)+_0x2f4219(0x29a)+_0x2f4219(0x221)+_0x2f4219(0x21c)+_0x2f4219(0x214)+_0x2f4219(0x22b)+_0x37301a[_0x2f4219(0x20d)]+'\x20'+_0x2f4219(0x206)+_0x2f4219(0x212)+_0x37301a[_0x2f4219(0x1ff)]+'\x20'+'</span>'+_0x2f4219(0x295)+_0x2f4219(0x29a)+_0x2f4219(0x252)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2f4219(0x284)+_0x2f4219(0x291)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x2f4219(0x222)+_0x2f4219(0x21e)+_0x2f4219(0x263)+_0x2f4219(0x24a)+_0x2f4219(0x293)+_0x2f4219(0x285)+'</tr>'+_0x2f4219(0x2a2)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x431d37+'\x20'+'</tbody>'+_0x2f4219(0x260)+'<div>'+_0x2f4219(0x286)+_0x2f4219(0x1e4)+_0x26ba0e[0x0][_0x2f4219(0x255)]+_0x2f4219(0x295)+_0x2f4219(0x29a)+_0x2f4219(0x29a)+_0x2f4219(0x1e5)};_0x5b71ea[_0x2f4219(0x220)](_0xaf82e,function(_0x4ddbbc,_0x57a836){var _0x460ab5=_0x2f4219;_0x4ddbbc?(console['log'](_0x4ddbbc),console[_0x460ab5(0x1f0)](_0x460ab5(0x1ec))):console[_0x460ab5(0x1f0)](_0x460ab5(0x23c));}),_0x56d30d['flash'](_0x2f4219(0x21b),_0x2f4219(0x205)),_0x158c48[_0x2f4219(0x231)](_0x2f4219(0x27d)+_0x3f4fe4[_0x2f4219(0x24c)]);}catch(_0x4fb244){console[_0x2f4219(0x240)](_0x4fb244),_0x158c48['status'](0x1f4)[_0x2f4219(0x1fb)]({'error':_0x2f4219(0x219)});}})[_0x3e4fa1(0x23a)](_0x1bc44f=>{var _0x598685=_0x3e4fa1;console['error'](_0x1bc44f),_0x158c48[_0x598685(0x1df)](0x1f4)[_0x598685(0x1fb)]({'error':'An\x20error\x20occurred.'});});}catch(_0x47c7b7){console[_0x3e4fa1(0x1f0)](_0x47c7b7),_0x158c48[_0x3e4fa1(0x1df)](0xc8)[_0x3e4fa1(0x1fb)]({'message':_0x47c7b7[_0x3e4fa1(0x229)]});}}),router[a0_0x4c185e(0x2a8)](a0_0x4c185e(0x1dc),auth,async(_0x409315,_0x19a761)=>{var _0x20b50c=a0_0x4c185e;try{const {username:_0x3200da,email:_0x5315af,role:_0x2508ba}=_0x409315[_0x20b50c(0x287)],_0x369a3b=_0x409315['user'],_0x1afaf3=await profile['findOne']({'email':_0x369a3b[_0x20b50c(0x1e9)]}),_0x58b2d7=await master_shop[_0x20b50c(0x216)](),_0x4fd780=_0x409315[_0x20b50c(0x23d)]['id'],_0x55780b=await adjustment['findById']({'_id':_0x4fd780}),_0x55d911=await purchases[_0x20b50c(0x27a)]([{'$match':{'warehouse_name':_0x55780b[_0x20b50c(0x1e3)]}},{'$unwind':_0x20b50c(0x1d9)},{'$group':{'_id':_0x20b50c(0x24e)}}]),_0x29863f=await product[_0x20b50c(0x216)]({}),_0x5ef2f5=await warehouse[_0x20b50c(0x27a)]([{'$match':{'name':_0x55780b[_0x20b50c(0x1e3)]}},{'$unwind':_0x20b50c(0x298)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x20b50c(0x247)},'bay':{'$first':_0x20b50c(0x249)},'bin':{'$first':_0x20b50c(0x230)},'type':{'$first':_0x20b50c(0x273)},'floorlevel':{'$first':_0x20b50c(0x1e0)},'primary_code':{'$first':_0x20b50c(0x20f)},'secondary_code':{'$first':_0x20b50c(0x217)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x20b50c(0x227)},'rack':{'$first':_0x20b50c(0x208)},'maxPerUnit':{'$first':_0x20b50c(0x288)},'expiry_date':{'$first':_0x20b50c(0x235)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x20b50c(0x204)}}}]);let _0x3ed18c;if(_0x369a3b[_0x20b50c(0x254)]=='staff'){const _0x10b4ee=await staff['findOne']({'email':_0x369a3b[_0x20b50c(0x1e9)]});_0x3ed18c=await warehouse[_0x20b50c(0x27a)]([{'$match':{'status':_0x20b50c(0x2a7),'name':_0x10b4ee[_0x20b50c(0x256)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x20b50c(0x201)}}},{'$group':{'_id':_0x20b50c(0x1de),'name':{'$first':_0x20b50c(0x1de)}}}]);}else _0x3ed18c=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x20b50c(0x201)}}},{'$group':{'_id':_0x20b50c(0x1de),'name':{'$first':_0x20b50c(0x1de)}}}]);if(_0x58b2d7[0x0][_0x20b50c(0x279)]==_0x20b50c(0x277)){var _0x5b462e=users[_0x20b50c(0x1fe)];console[_0x20b50c(0x1f0)](_0x5b462e);}else{if(_0x58b2d7[0x0]['language']==_0x20b50c(0x2a1))var _0x5b462e=users[_0x20b50c(0x2a1)];else{if(_0x58b2d7[0x0]['language']==_0x20b50c(0x22f))var _0x5b462e=users[_0x20b50c(0x22f)];else{if(_0x58b2d7[0x0][_0x20b50c(0x279)]=='Spanish')var _0x5b462e=users[_0x20b50c(0x1d5)];else{if(_0x58b2d7[0x0][_0x20b50c(0x279)]==_0x20b50c(0x203))var _0x5b462e=users[_0x20b50c(0x203)];else{if(_0x58b2d7[0x0][_0x20b50c(0x279)]==_0x20b50c(0x1f4))var _0x5b462e=users['Portuguese'];else{if(_0x58b2d7[0x0][_0x20b50c(0x279)]=='Chinese')var _0x5b462e=users[_0x20b50c(0x1d7)];else{if(_0x58b2d7[0x0]['language']==_0x20b50c(0x24b))var _0x5b462e=users['Arabic'];}}}}}}}_0x19a761[_0x20b50c(0x27e)](_0x20b50c(0x28d),{'success':_0x409315[_0x20b50c(0x28e)](_0x20b50c(0x21b)),'errors':_0x409315[_0x20b50c(0x28e)]('errors'),'role':_0x369a3b,'profile':_0x1afaf3,'adjustment':_0x55780b,'stock':_0x5ef2f5,'master_shop':_0x58b2d7,'warehouse_name':_0x55d911,'unit':_0x29863f,'language':_0x5b462e,'warehouse':_0x3ed18c});}catch(_0x368197){console[_0x20b50c(0x1f0)](_0x368197),_0x19a761['status'](0xc8)[_0x20b50c(0x1fb)]({'message':_0x368197[_0x20b50c(0x229)]});}}),router[a0_0x4c185e(0x1da)](a0_0x4c185e(0x1dc),auth,async(_0x2df84b,_0x5c0b69)=>{var _0x1fd49f=a0_0x4c185e;try{const _0x564d39=_0x2df84b['params']['id'],_0x2bd2b7=await adjustment['findById']({'_id':_0x564d39}),_0x425aea=await warehouse[_0x1fd49f(0x2a4)]({'name':_0x2bd2b7[_0x1fd49f(0x1e3)],'room':_0x2bd2b7[_0x1fd49f(0x207)]}),{warehouse_name:_0x36a785,date:_0x47eaae,prod_name:_0x282224,level:_0x401c03,isle:_0x5971df,pallet:_0x43ffe9,stock:_0x19c13f,types:_0x48b615,adjust_qty:_0x431500,new_adjust_qty:_0x3e8fe4,note:_0xd6a2f1,Room_name:_0x2f3c5d,invoice:_0x1b318a,JO_number:_0x279303,expiry_date:_0x30961d}=_0x2df84b[_0x1fd49f(0x1f6)];if(typeof _0x282224==_0x1fd49f(0x26e))var _0xb58a06=[_0x2df84b['body']['prod_name']],_0x72931e=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x224)]],_0x2f2928=[_0x2df84b[_0x1fd49f(0x1f6)]['stock']],_0x46f6b1=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x233)]],_0x573efa=[_0x2df84b['body'][_0x1fd49f(0x1db)]],_0x1645eb=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x259)]],_0x500075=[_0x2df84b[_0x1fd49f(0x1f6)]['Primary_Units']],_0xfce710=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x2a6)]],_0x46fa76=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x290)]],_0x292c16=[_0x2df84b['body'][_0x1fd49f(0x1e8)]],_0x5adbed=[_0x2df84b[_0x1fd49f(0x1f6)]['expiry_date']],_0x2901fb=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x29c)]],_0x52a750=[_0x2df84b[_0x1fd49f(0x1f6)]['production_date']],_0x196cde=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x274)]],_0x34232b=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x20e)]],_0x47ca5c=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x294)]],_0x51c75c=[_0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x1e1)]];else var _0xb58a06=[..._0x2df84b[_0x1fd49f(0x1f6)]['prod_name']],_0x72931e=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x224)]],_0x2f2928=[..._0x2df84b['body'][_0x1fd49f(0x261)]],_0x46f6b1=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x233)]],_0x573efa=[..._0x2df84b['body'][_0x1fd49f(0x1db)]],_0x1645eb=[..._0x2df84b[_0x1fd49f(0x1f6)]['New_Qty_Converted']],_0x500075=[..._0x2df84b['body'][_0x1fd49f(0x28c)]],_0xfce710=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x2a6)]],_0x46fa76=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x290)]],_0x292c16=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x1e8)]],_0x5adbed=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x253)]],_0x2901fb=[..._0x2df84b['body'][_0x1fd49f(0x29c)]],_0x52a750=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x283)]],_0x196cde=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x274)]],_0x34232b=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x20e)]],_0x47ca5c=[..._0x2df84b[_0x1fd49f(0x1f6)][_0x1fd49f(0x294)]],_0x51c75c=[..._0x2df84b[_0x1fd49f(0x1f6)]['second1']];const _0x59dc50=_0xb58a06['map'](_0x4c8f64=>{return _0x4c8f64={'product_name':_0x4c8f64};});_0x72931e[_0x1fd49f(0x25b)]((_0x423997,_0x5c8dff)=>{_0x34232b['forEach']((_0x3898b2,_0x5d6e8f)=>{var _0x2c4999=a0_0x912b;if(_0x3898b2==_0x2c4999(0x215)&&_0x5c8dff==_0x5d6e8f){var _0x1c29e5=_0x423997[_0x2c4999(0x1ee)](0x3);_0x59dc50[_0x5c8dff][_0x2c4999(0x26f)]=_0x423997[0x0],_0x59dc50[_0x5c8dff]['rack']=_0x423997[0x1],_0x59dc50[_0x5c8dff][_0x2c4999(0x281)]=0x0,_0x59dc50[_0x5c8dff]['bin']=0x0,_0x59dc50[_0x5c8dff][_0x2c4999(0x269)]=_0x2c4999(0x26d),_0x59dc50[_0x5c8dff][_0x2c4999(0x26b)]=_0x1c29e5;}else{if(_0x3898b2==_0x2c4999(0x22a)&&_0x5c8dff==_0x5d6e8f){var _0x1c29e5=_0x423997[_0x2c4999(0x1ee)](0x3);_0x59dc50[_0x5c8dff][_0x2c4999(0x26f)]=_0x423997[0x0],_0x59dc50[_0x5c8dff]['rack']=_0x423997[0x1],_0x59dc50[_0x5c8dff][_0x2c4999(0x281)]=0x0,_0x59dc50[_0x5c8dff][_0x2c4999(0x238)]=0x0,_0x59dc50[_0x5c8dff][_0x2c4999(0x269)]=_0x2c4999(0x26d),_0x59dc50[_0x5c8dff]['floorlevel']=_0x423997[0x5];}else{if(_0x5c8dff==_0x5d6e8f){var _0x19c729;if(_0x423997[0x4]=='L')_0x19c729=_0x2c4999(0x276);else _0x423997[0x4]=='F'&&(_0x19c729=_0x2c4999(0x26d));_0x59dc50[_0x5c8dff][_0x2c4999(0x26f)]=_0x423997[0x0],_0x59dc50[_0x5c8dff][_0x2c4999(0x223)]=_0x423997[0x1],_0x59dc50[_0x5c8dff][_0x2c4999(0x281)]=_0x423997[0x2],_0x59dc50[_0x5c8dff][_0x2c4999(0x238)]=_0x423997[0x3],_0x59dc50[_0x5c8dff]['type']=_0x19c729,_0x59dc50[_0x5c8dff][_0x2c4999(0x26b)]=_0x423997[0x5];}}}});}),_0x2f2928[_0x1fd49f(0x25b)]((_0x25488f,_0x54f57a)=>{var _0x240f88=_0x1fd49f;_0x59dc50[_0x54f57a][_0x240f88(0x234)]=_0x25488f;}),_0x46f6b1[_0x1fd49f(0x25b)]((_0x39be1e,_0x104d03)=>{_0x59dc50[_0x104d03]['types']=_0x39be1e;}),_0x573efa[_0x1fd49f(0x25b)]((_0x312200,_0x5e8a5f)=>{var _0x1d1a3f=_0x1fd49f;_0x59dc50[_0x5e8a5f][_0x1d1a3f(0x29f)]=_0x312200;}),_0x1645eb[_0x1fd49f(0x25b)]((_0x4adecd,_0x3953cd)=>{var _0x2ae1a1=_0x1fd49f;_0x59dc50[_0x3953cd][_0x2ae1a1(0x239)]=_0x4adecd;}),_0x500075[_0x1fd49f(0x25b)]((_0x1aa792,_0x21368b)=>{var _0xac2995=_0x1fd49f;_0x59dc50[_0x21368b][_0xac2995(0x28c)]=_0x1aa792;}),_0xfce710[_0x1fd49f(0x25b)]((_0x5180cc,_0x318bf6)=>{var _0x30f638=_0x1fd49f;_0x59dc50[_0x318bf6][_0x30f638(0x270)]=_0x5180cc;}),_0x46fa76['forEach']((_0x979dfe,_0x3463bd)=>{_0x59dc50[_0x3463bd]['product_code']=_0x979dfe;}),_0x292c16[_0x1fd49f(0x25b)]((_0x590c85,_0x192c73)=>{var _0x5671ef=_0x1fd49f;_0x59dc50[_0x192c73][_0x5671ef(0x1e8)]=_0x590c85;}),_0x5adbed[_0x1fd49f(0x25b)]((_0x10f010,_0x3fadc2)=>{var _0x11f902=_0x1fd49f;_0x59dc50[_0x3fadc2][_0x11f902(0x253)]=_0x10f010;}),_0x2901fb[_0x1fd49f(0x25b)]((_0x282647,_0x183b70)=>{var _0x566cf0=_0x1fd49f;_0x59dc50[_0x183b70][_0x566cf0(0x280)]=_0x282647;}),_0x52a750[_0x1fd49f(0x25b)]((_0x352380,_0x364b07)=>{var _0x445ffe=_0x1fd49f;_0x59dc50[_0x364b07][_0x445ffe(0x283)]=_0x352380;}),_0x196cde[_0x1fd49f(0x25b)]((_0x13adc7,_0x2d9caa)=>{_0x59dc50[_0x2d9caa]['prod_cat']=_0x13adc7;}),_0x34232b[_0x1fd49f(0x25b)]((_0x19b1b0,_0xf8b295)=>{var _0x589292=_0x1fd49f;_0x59dc50[_0xf8b295][_0x589292(0x20a)]=_0x19b1b0;}),_0x47ca5c[_0x1fd49f(0x25b)]((_0xfe4bbe,_0x37e636)=>{var _0x3b2f04=_0x1fd49f;_0x59dc50[_0x37e636][_0x3b2f04(0x241)]=_0xfe4bbe;}),_0x51c75c['forEach']((_0x1c5dac,_0x56f4bc)=>{var _0x1f17c0=_0x1fd49f;_0x59dc50[_0x56f4bc][_0x1f17c0(0x25d)]=_0x1c5dac;});const _0x2d7cdd=_0x59dc50['filter'](_0x2c2774=>_0x2c2774[_0x1fd49f(0x29f)]!=='0'&&_0x2c2774[_0x1fd49f(0x29f)]!=='');var _0x184f56=0x0;_0x2d7cdd[_0x1fd49f(0x25b)](_0xec1450=>{var _0x15dc9a=_0x1fd49f;console['log'](_0x15dc9a(0x1e7),_0xec1450),parseInt(_0xec1450[_0x15dc9a(0x29f)])<=0x0&&_0x184f56++;});if(_0x184f56!=0x0)return _0x2df84b[_0x1fd49f(0x28e)](_0x1fd49f(0x1ea),_0x1fd49f(0x246)),_0x5c0b69[_0x1fd49f(0x231)](_0x1fd49f(0x257));_0x2bd2b7[_0x1fd49f(0x1e3)]=_0x36a785,_0x2bd2b7['date']=_0x47eaae,_0x2bd2b7[_0x1fd49f(0x22d)]=_0x2d7cdd,_0x2bd2b7[_0x1fd49f(0x23e)]=_0xd6a2f1,_0x2bd2b7[_0x1fd49f(0x20d)]=_0x1b318a,_0x2bd2b7['isAllowEdit']='False';const _0x598dd5=await _0x2bd2b7[_0x1fd49f(0x28f)]();_0x2df84b['flash']('success',_0x1fd49f(0x1e2)),_0x5c0b69[_0x1fd49f(0x231)]('/adjustment/view');}catch(_0x1cc4cd){console['log'](_0x1cc4cd);}}),router[a0_0x4c185e(0x1da)](a0_0x4c185e(0x228),async(_0x4d4ea5,_0x129423)=>{var _0x31a35f=a0_0x4c185e;const {primary_code:_0x26bfdd,warehouse_data:_0x382256,rooms_data:_0x5ab1f6,Roomslist:_0x4de11c}=_0x4d4ea5[_0x31a35f(0x1f6)],_0xed3d15=_0x4de11c[_0x31a35f(0x23b)](','),_0x5aa689=[];async function _0x450fc7(_0x57d499){var _0x2ee9fb=_0x31a35f;const _0x837033=await warehouse['aggregate']([{'$match':{'name':_0x382256,'room':_0x57d499}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x26bfdd}},{'$group':{'_id':_0x2ee9fb(0x272),'name':{'$first':_0x2ee9fb(0x26c)},'product_stock':{'$first':_0x2ee9fb(0x247)},'primary_code':{'$first':_0x2ee9fb(0x20f)},'secondary_code':{'$first':_0x2ee9fb(0x217)},'product_code':{'$first':_0x2ee9fb(0x209)},'level':{'$first':_0x2ee9fb(0x249)},'isle':{'$first':_0x2ee9fb(0x230)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2ee9fb(0x1e0)},'unit':{'$first':_0x2ee9fb(0x232)},'secondary_unit':{'$first':_0x2ee9fb(0x1fa)},'storage':{'$first':_0x2ee9fb(0x227)},'rack':{'$first':_0x2ee9fb(0x208)},'expiry_date':{'$first':_0x2ee9fb(0x235)},'production_date':{'$first':_0x2ee9fb(0x2a5)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x2ee9fb(0x264)}}}]),_0x283a5a=await warehouse['aggregate']([{'$match':{'name':_0x382256,'room':_0x57d499}},{'$unwind':_0x2ee9fb(0x298)},{'$match':{'product_details.secondary_code':_0x26bfdd}},{'$group':{'_id':_0x2ee9fb(0x272),'name':{'$first':_0x2ee9fb(0x26c)},'product_stock':{'$first':_0x2ee9fb(0x247)},'primary_code':{'$first':_0x2ee9fb(0x20f)},'secondary_code':{'$first':_0x2ee9fb(0x217)},'product_code':{'$first':_0x2ee9fb(0x209)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x2ee9fb(0x230)},'type':{'$first':_0x2ee9fb(0x273)},'pallet':{'$first':_0x2ee9fb(0x1e0)},'unit':{'$first':_0x2ee9fb(0x232)},'secondary_unit':{'$first':_0x2ee9fb(0x1fa)},'storage':{'$first':_0x2ee9fb(0x227)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2ee9fb(0x235)},'production_date':{'$first':_0x2ee9fb(0x2a5)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2ee9fb(0x1fc)},'product_cat':{'$first':_0x2ee9fb(0x1f9)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x837033[_0x2ee9fb(0x22e)]>0x0)_0x5aa689[_0x2ee9fb(0x1e6)](_0x837033);else _0x283a5a['length']>0x0&&_0x5aa689[_0x2ee9fb(0x1e6)](_0x283a5a);}const _0x260e8a=_0xed3d15['map'](_0x8cee04=>_0x450fc7(_0x8cee04));await Promise[_0x31a35f(0x1dd)](_0x260e8a),_0x129423[_0x31a35f(0x1fb)](_0x5aa689);}),router[a0_0x4c185e(0x1da)](a0_0x4c185e(0x27f),async(_0x55a873,_0x43f6bc)=>{var _0x133134=a0_0x4c185e;const {primaryCode:_0xfe074e,secondaryCode:_0x3cc6b1,productCode:_0x467d78,level:_0x23b707,isle:_0x187c90,pallet:_0x70685b,warehouses:_0x23461b,room:_0x85bb5}=_0x55a873['body'];try{const _0x574097=await warehouse[_0x133134(0x27a)]([{'$match':{'name':_0x23461b,'room':_0x85bb5}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x23b707),'product_details.isle':_0x187c90,'product_details.pallet':parseInt(_0x70685b)}},{'$group':{'_id':_0x133134(0x272),'name':{'$first':_0x133134(0x26c)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x133134(0x1f8)},'isle':{'$first':_0x133134(0x258)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x43f6bc[_0x133134(0x1df)](0xc8)[_0x133134(0x1fb)](_0x574097);}catch(_0x293be9){_0x43f6bc['status'](0x194)[_0x133134(0x1fb)]({'message':_0x293be9['message']});}}),module['exports']=router;