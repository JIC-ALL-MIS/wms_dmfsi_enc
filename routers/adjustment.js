var a0_0xc1e590=a0_0x5772;(function(_0x32436e,_0x2adb09){var _0x30e936=a0_0x5772,_0x16d0a4=_0x32436e();while(!![]){try{var _0x220337=-parseInt(_0x30e936(0x12c))/0x1+-parseInt(_0x30e936(0x1ca))/0x2*(-parseInt(_0x30e936(0x1bc))/0x3)+-parseInt(_0x30e936(0x13f))/0x4+parseInt(_0x30e936(0x1a7))/0x5*(-parseInt(_0x30e936(0x186))/0x6)+-parseInt(_0x30e936(0x1cc))/0x7+parseInt(_0x30e936(0x1eb))/0x8+parseInt(_0x30e936(0x141))/0x9*(parseInt(_0x30e936(0x172))/0xa);if(_0x220337===_0x2adb09)break;else _0x16d0a4['push'](_0x16d0a4['shift']());}catch(_0x335112){_0x16d0a4['push'](_0x16d0a4['shift']());}}}(a0_0x321e,0x96ad5));function a0_0x5772(_0x354536,_0x33af73){var _0x321e58=a0_0x321e();return a0_0x5772=function(_0x577288,_0x79eff2){_0x577288=_0x577288-0x10f;var _0x145ae8=_0x321e58[_0x577288];return _0x145ae8;},a0_0x5772(_0x354536,_0x33af73);}const express=require('express'),app=express(),router=express['Router'](),auth=require(a0_0xc1e590(0x173)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xc1e590(0x16d)),users=require(a0_0xc1e590(0x13c)),nodemailer=require(a0_0xc1e590(0x195)),mongoose=require(a0_0xc1e590(0x113));function a0_0x321e(){var _0x77ea69=['staff','_id','/CheckingWarehouse','$product_details.expiry_date','Spanish','Types','<strong>\x20Regards\x20</strong>','$finalize','\x20<>\x20','$product_details.bay','\x20Order\x20Number\x20:\x20','$product_details.invoice','user','447378DQmqEG','Enclosed','633199oyEtpD','prime1','/adjustment/view','maxperunit','False','$product_details.floorlevel','$product.room_names','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','ADJ-','forEach','<tr>','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','secondary_unit','finalize','status','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.product_name','map','$product_details.secondary_code','logo','level','role','Adjustment\x20Mail','Error\x20Occurs','Floor','$product_details.type','$product_details.isle','unit','French','1808352mmRhOg','body','German','$product_details.batch_code','New_Qty_Converted','id_transaction','string','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','mongoose','message','<!DOCTYPE\x20html>','<span\x20style=\x22float:\x20right;\x22>','prod_name','back','Enabled','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$room','Portuguese','stock','Raw\x20Materials','</tbody>','edit_adjustment_view','/view','render','$date','expiry_date','valueOf','updateOne','<div>','RMSEmail','production_date','<h2>\x20','</thead>','244322LfiPFq','rack','random','params','English\x20(US)','bay','adjust_qty','push','$product_details.maxProducts','Primary_Units','edit_adjustment','prod_code','Arabic\x20(ae)','$product_details.storage','/view/add_adjustment','$product.product_name','../public/language/languages.json','/preview/:id','product','415972hDjebd','slice','234LSiwne','</body></html>','max_per_unit','find','isAllowEdit','language','</span>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','product_stock','findById','save','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Return\x20Goods','log','foreach\x20newproduct','site_title','stockBefore','primary_code','$product_details.level','sendMail','redirect','floorlevel','id_transaction_from','</h5>','toString','warehouse','new_adjust_qty','</head><body>','/picking_list/PDF_adjustment_rm/','</div>','createTransport','$product_details.unit','types','$product_details.product_code','$product_details.pallet','Logo.png','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','master','warehouse_name','/adjustment/preview/','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Arabic','../models/all_models','date','$_id','Level','$product_details.product_stock','475670tSOOwO','../middleware/auth','get','product_name','json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details._id','floor','Hindi','Receiving\x20Area','storage','minus','New_Qty_Converted_adj','secondary_code','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','second1','prod_invoice','findOne','Portuguese\x20(BR)','email','60Tmgcvy','catch','room_names','$product_details.maxPerUnit','\x20</h2>','Secondary_units','host','product_details','$product_details.bin','note','</table>','adjustment\x20data\x20update\x20successfully','port','adjustment','$product','nodemailer','$product_details.production_date','$product_details','post','adjustment\x20add\x20successfull','filter','Ambient','Rooms','bin','English','Chinese','<html><head><title></title>','prod_cat','add_adjustment','<h5\x20style=\x22text-align:\x20left;\x22>','$isAllowEdit','$name','flash','315265lfuWjs','/../public','Return\x20Rooms','type','/view/:id','errors','<tbody\x20style=\x22text-align:\x20center;\x22>','ObjectId','image','success','invoice','product_code','all','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','length','$product_details.secondary_unit','$product_details.rack','Shelves','batch_code','$product_details.product_cat','</tr>','3DVOCQt'];a0_0x321e=function(){return _0x77ea69;};return a0_0x321e();}router['get'](a0_0xc1e590(0x121),auth,async(_0x5db528,_0x5209e1)=>{var _0x55fb63=a0_0xc1e590;try{const {username:_0x3f583b,email:_0x2f32de,role:_0x3dc47a}=_0x5db528[_0x55fb63(0x1c9)],_0xca87c=_0x5db528[_0x55fb63(0x1c9)],_0x4aa083=await profile[_0x55fb63(0x183)]({'email':_0xca87c['email']}),_0x2534e7=await master_shop[_0x55fb63(0x144)]();console[_0x55fb63(0x14f)](_0x55fb63(0x168),_0x2534e7);let _0x57df64;if(_0xca87c[_0x55fb63(0x1e3)]=='staff'){const _0x418535=await staff[_0x55fb63(0x183)]({'email':_0xca87c['email']});_0x57df64=await warehouse[_0x55fb63(0x144)]({'status':'Enabled','name':_0x418535[_0x55fb63(0x15b)]});}else _0x57df64=await warehouse[_0x55fb63(0x144)]({'status':_0x55fb63(0x119)});const _0x2588e8=await product['find']();let _0x641694;if(_0xca87c[_0x55fb63(0x1e3)]==_0x55fb63(0x1bd)){const _0x63451d=await staff[_0x55fb63(0x183)]({'email':_0xca87c[_0x55fb63(0x185)]});_0x641694=await adjustment['find']({'warehouse_name':_0x63451d[_0x55fb63(0x15b)]});}else _0x641694=await adjustment[_0x55fb63(0x1d8)]([{'$unwind':_0x55fb63(0x194)},{'$group':{'_id':_0x55fb63(0x16f),'invoice':{'$first':'$invoice'},'date':{'$first':_0x55fb63(0x123)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x55fb63(0x1d2)},'finalize':{'$first':_0x55fb63(0x1c4)},'isAllowEdit':{'$first':_0x55fb63(0x1a4)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2534e7[0x0]['language']=='English\x20(US)'){var _0x3fe2bf=users['English'];console[_0x55fb63(0x14f)](_0x3fe2bf);}else{if(_0x2534e7[0x0][_0x55fb63(0x146)]=='Hindi')var _0x3fe2bf=users['Hindi'];else{if(_0x2534e7[0x0][_0x55fb63(0x146)]=='German')var _0x3fe2bf=users['German'];else{if(_0x2534e7[0x0][_0x55fb63(0x146)]==_0x55fb63(0x1c1))var _0x3fe2bf=users[_0x55fb63(0x1c1)];else{if(_0x2534e7[0x0][_0x55fb63(0x146)]==_0x55fb63(0x1ea))var _0x3fe2bf=users[_0x55fb63(0x1ea)];else{if(_0x2534e7[0x0][_0x55fb63(0x146)]==_0x55fb63(0x184))var _0x3fe2bf=users[_0x55fb63(0x11c)];else{if(_0x2534e7[0x0][_0x55fb63(0x146)]==_0x55fb63(0x19f))var _0x3fe2bf=users[_0x55fb63(0x19f)];else{if(_0x2534e7[0x0]['language']==_0x55fb63(0x138))var _0x3fe2bf=users[_0x55fb63(0x16c)];}}}}}}}_0x5209e1['render'](_0x55fb63(0x193),{'success':_0x5db528[_0x55fb63(0x1a6)](_0x55fb63(0x1b0)),'errors':_0x5db528['flash']('errors'),'role':_0xca87c,'profile':_0x4aa083,'warehouse':_0x57df64,'product':_0x2588e8,'adjustment':_0x641694,'master_shop':_0x2534e7,'language':_0x3fe2bf});}catch(_0x2a407b){console['log'](_0x2a407b);}});async function getRandom8DigitNumber(){var _0x23909b=a0_0xc1e590;const _0x39c828=0x989680,_0x196a28=0x5f5e0ff,_0x5a2d57=Math[_0x23909b(0x179)](Math[_0x23909b(0x12e)]()*(_0x196a28-_0x39c828+0x1))+_0x39c828;var _0x2db1a7;const _0x500604=await adjustment[_0x23909b(0x183)]({'invoice':'ADJ-'+_0x5a2d57});return _0x500604&&_0x500604['length']>0x0?_0x2db1a7=_0x23909b(0x1d5)+_0x5a2d57:_0x2db1a7=_0x23909b(0x1d5)+_0x5a2d57,_0x2db1a7;}router[a0_0xc1e590(0x174)]('/view/add_adjustment',auth,async(_0x56d8a2,_0x511caa)=>{var _0x3d1fcf=a0_0xc1e590;try{const {username:_0x6041d5,email:_0x270037,role:_0xa70aaf}=_0x56d8a2[_0x3d1fcf(0x1c9)],_0x974175=_0x56d8a2['user'],_0x374767=await profile[_0x3d1fcf(0x183)]({'email':_0x974175[_0x3d1fcf(0x185)]}),_0x3e7d98=await master_shop['find']();let _0x4ac637;if(_0x974175[_0x3d1fcf(0x1e3)]==_0x3d1fcf(0x1bd)){const _0x36425f=await staff['findOne']({'email':_0x974175[_0x3d1fcf(0x185)]});_0x4ac637=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x36425f[_0x3d1fcf(0x15b)],'warehouse_category':_0x3d1fcf(0x11e),'name':{'$ne':_0x3d1fcf(0x14e)}}},{'$group':{'_id':'$name','name':{'$first':_0x3d1fcf(0x1a5)}}}]);}else _0x4ac637=await warehouse['aggregate']([{'$match':{'status':_0x3d1fcf(0x119),'warehouse_category':_0x3d1fcf(0x11e),'name':{'$ne':_0x3d1fcf(0x14e)}}},{'$group':{'_id':'$name','name':{'$first':_0x3d1fcf(0x1a5)}}}]);const _0x187105=await product[_0x3d1fcf(0x144)]({}),_0x59743b=await adjustment[_0x3d1fcf(0x144)]({}),_0x1c5d9b=_0x59743b[_0x3d1fcf(0x1b5)]+0x1,_0x6add10=_0x3d1fcf(0x1d5)+_0x1c5d9b[_0x3d1fcf(0x15a)]()['padStart'](0x5,'0');var _0x264b15=[_0x3d1fcf(0x19b),_0x3d1fcf(0x1cb),_0x3d1fcf(0x1a9)];if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]=='English\x20(US)')var _0x2e17ea=users[_0x3d1fcf(0x19e)];else{if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]==_0x3d1fcf(0x17a))var _0x2e17ea=users[_0x3d1fcf(0x17a)];else{if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]=='German')var _0x2e17ea=users[_0x3d1fcf(0x1ed)];else{if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]==_0x3d1fcf(0x1c1))var _0x2e17ea=users[_0x3d1fcf(0x1c1)];else{if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]==_0x3d1fcf(0x1ea))var _0x2e17ea=users[_0x3d1fcf(0x1ea)];else{if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]=='Portuguese\x20(BR)')var _0x2e17ea=users[_0x3d1fcf(0x11c)];else{if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]==_0x3d1fcf(0x19f))var _0x2e17ea=users['Chinese'];else{if(_0x3e7d98[0x0][_0x3d1fcf(0x146)]==_0x3d1fcf(0x138))var _0x2e17ea=users[_0x3d1fcf(0x16c)];}}}}}}}const _0x3d711e=getRandom8DigitNumber();_0x3d711e['then'](_0x4d7458=>{var _0x246016=_0x3d1fcf;_0x511caa['render'](_0x246016(0x1a2),{'success':_0x56d8a2[_0x246016(0x1a6)]('success'),'errors':_0x56d8a2[_0x246016(0x1a6)]('errors'),'role':_0x974175,'profile':_0x374767,'warehouse':_0x4ac637,'product':_0x187105,'master_shop':_0x3e7d98,'language':_0x2e17ea,'rooms_data':_0x264b15,'invoice_no':_0x4d7458});})[_0x3d1fcf(0x187)](_0x4e3047=>{var _0x56309f=_0x3d1fcf;_0x56d8a2[_0x56309f(0x1a6)](_0x56309f(0x1ac),_0x56309f(0x1dd)),_0x511caa[_0x56309f(0x156)](_0x56309f(0x1ce));});}catch(_0x9faebe){console[_0x3d1fcf(0x14f)](_0x9faebe);}}),router['post'](a0_0xc1e590(0x13a),auth,async(_0x2f5d8c,_0x324e59)=>{var _0x54199f=a0_0xc1e590;try{const {warehouse_name:_0x104dc6,date:_0x1ca3a0,prod_name:_0x55e572,level:_0x1868ba,isle:_0x23e7db,pallet:_0x406472,stock:_0x20952c,types:_0x551ce7,adjust_qty:_0x443572,new_adjust_qty:_0x15a4ab,note:_0xf89b48,Room_name:_0x3c7f82,invoice:_0x482cc9,JO_number:_0x19372e,expiry_date:_0xc575d3}=_0x2f5d8c[_0x54199f(0x1ec)];if(typeof _0x55e572=='string')var _0x21cdf2=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x117)]],_0x3aa750=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x1e2)]],_0x1d8b54=[_0x2f5d8c['body'][_0x54199f(0x11d)]],_0x2516db=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x162)]],_0x47446a=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x17e)]],_0x4de8fd=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x10f)]],_0xb66ced=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x135)]],_0x190de9=[_0x2f5d8c['body'][_0x54199f(0x18b)]],_0x1f8597=[_0x2f5d8c['body'][_0x54199f(0x137)]],_0xc72e50=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x1b9)]],_0x2f55bb=[_0x2f5d8c['body'][_0x54199f(0x124)]],_0x318d24=[_0x2f5d8c[_0x54199f(0x1ec)]['max_per_unit']],_0x1f913b=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x129)]],_0x1d569c=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x1a1)]],_0x5679f1=[_0x2f5d8c['body'][_0x54199f(0x19c)]],_0x4c67c9=[_0x2f5d8c['body'][_0x54199f(0x1cd)]],_0x35c35e=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x181)]],_0x3b7e0f=[_0x2f5d8c['body']['prod_invoice']],_0xe4523e=[_0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x110)]];else var _0x21cdf2=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x117)]],_0x3aa750=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x1e2)]],_0x1d8b54=[..._0x2f5d8c[_0x54199f(0x1ec)]['stock']],_0x2516db=[..._0x2f5d8c['body'][_0x54199f(0x162)]],_0x47446a=[..._0x2f5d8c['body'][_0x54199f(0x17e)]],_0x4de8fd=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x10f)]],_0xb66ced=[..._0x2f5d8c[_0x54199f(0x1ec)]['unit']],_0x190de9=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x18b)]],_0x1f8597=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x137)]],_0xc72e50=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x1b9)]],_0x2f55bb=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x124)]],_0x318d24=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x143)]],_0x1f913b=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x129)]],_0x1d569c=[..._0x2f5d8c[_0x54199f(0x1ec)]['prod_cat']],_0x5679f1=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x19c)]],_0x4c67c9=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x1cd)]],_0x35c35e=[..._0x2f5d8c[_0x54199f(0x1ec)]['second1']],_0x3b7e0f=[..._0x2f5d8c[_0x54199f(0x1ec)][_0x54199f(0x182)]],_0xe4523e=[..._0x2f5d8c['body']['id_transaction']];const _0x390171=_0x21cdf2['map'](_0x36d044=>{return _0x36d044={'product_name':_0x36d044};});_0x3aa750[_0x54199f(0x1d6)]((_0xaad022,_0x4501d7)=>{_0x5679f1['forEach']((_0x437cb0,_0x204303)=>{var _0x46af9c=a0_0x5772;if(_0x437cb0==_0x46af9c(0x17b)&&_0x4501d7==_0x204303){var _0x1d10c2=_0xaad022['slice'](0x3);_0x390171[_0x4501d7][_0x46af9c(0x17c)]=_0xaad022[0x0],_0x390171[_0x4501d7][_0x46af9c(0x12d)]=_0xaad022[0x1],_0x390171[_0x4501d7]['bay']=0x0,_0x390171[_0x4501d7][_0x46af9c(0x19d)]=0x0,_0x390171[_0x4501d7][_0x46af9c(0x1aa)]=_0x46af9c(0x1e6),_0x390171[_0x4501d7][_0x46af9c(0x157)]=_0x1d10c2;}else{if(_0x437cb0==_0x46af9c(0x1b8)&&_0x4501d7==_0x204303){var _0x1d10c2=_0xaad022[_0x46af9c(0x140)](0x3);_0x390171[_0x4501d7][_0x46af9c(0x17c)]=_0xaad022[0x0],_0x390171[_0x4501d7][_0x46af9c(0x12d)]=_0xaad022[0x1],_0x390171[_0x4501d7][_0x46af9c(0x131)]=0x0,_0x390171[_0x4501d7][_0x46af9c(0x19d)]=0x0,_0x390171[_0x4501d7]['type']='Floor',_0x390171[_0x4501d7][_0x46af9c(0x157)]=_0xaad022[0x5];}else{if(_0x4501d7==_0x204303){var _0x4fd0af;if(_0xaad022[0x4]=='L')_0x4fd0af='Level';else _0xaad022[0x4]=='F'&&(_0x4fd0af=_0x46af9c(0x1e6));_0x390171[_0x4501d7][_0x46af9c(0x17c)]=_0xaad022[0x0],_0x390171[_0x4501d7]['rack']=_0xaad022[0x1],_0x390171[_0x4501d7]['bay']=_0xaad022[0x2],_0x390171[_0x4501d7][_0x46af9c(0x19d)]=_0xaad022[0x3],_0x390171[_0x4501d7]['type']=_0x4fd0af,_0x390171[_0x4501d7][_0x46af9c(0x157)]=_0xaad022[0x5];}}}});}),_0x1d8b54[_0x54199f(0x1d6)]((_0x5b4bc7,_0xdf0b91)=>{var _0x350a49=_0x54199f;_0x390171[_0xdf0b91][_0x350a49(0x152)]=_0x5b4bc7;}),_0xe4523e['forEach']((_0x22eab1,_0x3ab66b)=>{var _0x268882=_0x54199f;_0x390171[_0x3ab66b][_0x268882(0x158)]=_0x22eab1;}),_0x2516db[_0x54199f(0x1d6)]((_0x3314fb,_0x3c39d5)=>{var _0x5837cd=_0x54199f;_0x390171[_0x3c39d5][_0x5837cd(0x162)]=_0x3314fb;}),_0x47446a[_0x54199f(0x1d6)]((_0x2ebbf9,_0x3a3f7b)=>{var _0x52c341=_0x54199f;_0x390171[_0x3a3f7b][_0x52c341(0x132)]=_0x2ebbf9;}),_0x4de8fd[_0x54199f(0x1d6)]((_0x2fed1c,_0x81cca6)=>{_0x390171[_0x81cca6]['new_adjust_qty']=_0x2fed1c;}),_0xb66ced[_0x54199f(0x1d6)]((_0x3f8dd0,_0x353e9d)=>{_0x390171[_0x353e9d]['unit']=_0x3f8dd0;}),_0x190de9[_0x54199f(0x1d6)]((_0x430427,_0x57edce)=>{var _0x1d1529=_0x54199f;_0x390171[_0x57edce][_0x1d1529(0x1da)]=_0x430427;}),_0x1f8597['forEach']((_0x45e0d5,_0x19d240)=>{var _0x5e0d64=_0x54199f;_0x390171[_0x19d240][_0x5e0d64(0x1b2)]=_0x45e0d5;}),_0xc72e50[_0x54199f(0x1d6)]((_0x2984cb,_0x239091)=>{var _0x4017e3=_0x54199f;_0x390171[_0x239091][_0x4017e3(0x1b9)]=_0x2984cb;}),_0x2f55bb[_0x54199f(0x1d6)]((_0x914b2d,_0x536fda)=>{var _0x553ea7=_0x54199f;_0x390171[_0x536fda][_0x553ea7(0x124)]=_0x914b2d;}),_0x318d24[_0x54199f(0x1d6)]((_0x1ec022,_0x7ea17)=>{var _0x5e37a7=_0x54199f;_0x390171[_0x7ea17][_0x5e37a7(0x1cf)]=_0x1ec022;}),_0x1f913b[_0x54199f(0x1d6)]((_0x5b66f7,_0x4c3a5c)=>{var _0x42203f=_0x54199f;_0x390171[_0x4c3a5c][_0x42203f(0x129)]=_0x5b66f7;}),_0x1d569c[_0x54199f(0x1d6)]((_0x455448,_0x15aeec)=>{var _0x13ce1e=_0x54199f;_0x390171[_0x15aeec][_0x13ce1e(0x1a1)]=_0x455448;}),_0x5679f1['forEach']((_0x240c3d,_0x131396)=>{_0x390171[_0x131396]['room_names']=_0x240c3d;}),_0x4c67c9[_0x54199f(0x1d6)]((_0x32eb42,_0x5b6fbb)=>{var _0x2e372d=_0x54199f;_0x390171[_0x5b6fbb][_0x2e372d(0x153)]=_0x32eb42;}),_0x35c35e[_0x54199f(0x1d6)]((_0x1336ca,_0x5a8ecc)=>{var _0x43ca53=_0x54199f;_0x390171[_0x5a8ecc][_0x43ca53(0x17f)]=_0x1336ca;}),_0x3b7e0f[_0x54199f(0x1d6)]((_0x3209c1,_0x53a71c)=>{var _0x1711da=_0x54199f;_0x390171[_0x53a71c][_0x1711da(0x1b1)]=_0x3209c1;});const _0x441d64=_0x390171[_0x54199f(0x19a)](_0x2fa9fc=>_0x2fa9fc[_0x54199f(0x132)]!=='0'&&_0x2fa9fc['adjust_qty']!=='');var _0x36a9ca=0x0;_0x441d64[_0x54199f(0x1d6)](_0x3202fb=>{var _0x125ade=_0x54199f;console[_0x125ade(0x14f)](_0x125ade(0x150),_0x3202fb),parseInt(_0x3202fb[_0x125ade(0x132)])<=0x0&&_0x36a9ca++;});if(_0x36a9ca!=0x0)return _0x2f5d8c[_0x54199f(0x1a6)](_0x54199f(0x1ac),_0x54199f(0x180)),_0x324e59[_0x54199f(0x156)](_0x54199f(0x118));const _0x2524a6=new adjustment({'warehouse_name':_0x104dc6,'date':_0x1ca3a0,'product':_0x441d64,'note':_0xf89b48,'room':_0x3c7f82,'invoice':_0x482cc9,'JO_number':_0x19372e,'expiry_date':_0xc575d3}),_0x50d9e9=await _0x2524a6['save']();_0x2f5d8c['flash'](_0x54199f(0x1b0),_0x54199f(0x199)),_0x324e59[_0x54199f(0x156)](_0x54199f(0x16a)+_0x50d9e9[_0x54199f(0x1be)]);}catch(_0x2602a3){console[_0x54199f(0x14f)](_0x2602a3),_0x324e59['status'](0xc8)['json']({'message':_0x2602a3[_0x54199f(0x114)]});}}),router[a0_0xc1e590(0x174)](a0_0xc1e590(0x13d),auth,async(_0x206bfe,_0x51b0e9)=>{var _0x131f61=a0_0xc1e590;try{const {username:_0x348877,email:_0x42afb2,role:_0x2136fc}=_0x206bfe[_0x131f61(0x1c9)],_0x2f62c7=_0x206bfe['user'],_0x5d0f56=await profile[_0x131f61(0x183)]({'email':_0x2f62c7[_0x131f61(0x185)]}),_0x265865=await master_shop[_0x131f61(0x144)](),_0x15b2aa=_0x206bfe[_0x131f61(0x12f)]['id'],_0x1910ee=await adjustment[_0x131f61(0x14a)]({'_id':_0x15b2aa}),_0xdf3c58=await purchases[_0x131f61(0x1d8)]([{'$match':{'warehouse_name':_0x1910ee[_0x131f61(0x169)]}},{'$unwind':_0x131f61(0x194)},{'$group':{'_id':_0x131f61(0x13b)}}]),_0x299725=await product[_0x131f61(0x144)]({}),_0xd3f488=await warehouse['aggregate']([{'$match':{'name':_0x1910ee['warehouse_name']}},{'$unwind':_0x131f61(0x197)},{'$group':{'_id':_0x131f61(0x178),'name':{'$first':_0x131f61(0x1de)},'product_stock':{'$first':_0x131f61(0x171)},'bay':{'$first':_0x131f61(0x1c6)},'bin':{'$first':_0x131f61(0x18e)},'type':{'$first':_0x131f61(0x1e7)},'floorlevel':{'$first':_0x131f61(0x1d1)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x131f61(0x163)},'storage':{'$first':_0x131f61(0x139)},'rack':{'$first':_0x131f61(0x1b7)},'maxPerUnit':{'$first':_0x131f61(0x189)},'expiry_date':{'$first':_0x131f61(0x1c0)},'production_date':{'$first':_0x131f61(0x196)},'batch_code':{'$first':_0x131f61(0x1ee)},'room':{'$first':_0x131f61(0x11b)}}}]);if(_0x265865[0x0][_0x131f61(0x146)]==_0x131f61(0x130)){var _0x17f6ea=users[_0x131f61(0x19e)];console[_0x131f61(0x14f)](_0x17f6ea);}else{if(_0x265865[0x0][_0x131f61(0x146)]=='Hindi')var _0x17f6ea=users[_0x131f61(0x17a)];else{if(_0x265865[0x0][_0x131f61(0x146)]==_0x131f61(0x1ed))var _0x17f6ea=users[_0x131f61(0x1ed)];else{if(_0x265865[0x0]['language']=='Spanish')var _0x17f6ea=users[_0x131f61(0x1c1)];else{if(_0x265865[0x0][_0x131f61(0x146)]==_0x131f61(0x1ea))var _0x17f6ea=users[_0x131f61(0x1ea)];else{if(_0x265865[0x0]['language']==_0x131f61(0x184))var _0x17f6ea=users[_0x131f61(0x11c)];else{if(_0x265865[0x0][_0x131f61(0x146)]=='Chinese')var _0x17f6ea=users[_0x131f61(0x19f)];else{if(_0x265865[0x0][_0x131f61(0x146)]=='Arabic\x20(ae)')var _0x17f6ea=users['Arabic'];}}}}}}}_0x51b0e9['render'](_0x131f61(0x120),{'success':_0x206bfe['flash'](_0x131f61(0x1b0)),'errors':_0x206bfe['flash'](_0x131f61(0x1ac)),'role':_0x2f62c7,'profile':_0x5d0f56,'adjustment':_0x1910ee,'master_shop':_0x265865,'warehouse_name':_0xdf3c58,'unit':_0x299725,'language':_0x17f6ea});}catch(_0x11e8c3){console[_0x131f61(0x14f)](_0x11e8c3),_0x51b0e9[_0x131f61(0x1dc)](0xc8)['json']({'message':_0x11e8c3[_0x131f61(0x114)]});}}),router['post'](a0_0xc1e590(0x13d),auth,async(_0x3c2bc4,_0x3fb752)=>{var _0x268ea7=a0_0xc1e590;try{const _0x1a5861=_0x3c2bc4[_0x268ea7(0x12f)]['id'],{warehouse_name:_0x390cd3,Room_name:_0x8f6787}=_0x3c2bc4[_0x268ea7(0x1ec)],_0x54e5f2=await adjustment['findById']({'_id':_0x1a5861}),_0x1a6399=_0x54e5f2[_0x268ea7(0x13e)]['map'](async _0x31eb65=>{var _0x406f91=_0x268ea7;if(_0x31eb65[_0x406f91(0x132)]>0x0){const _0x4ec97b=mongoose[_0x406f91(0x1c2)][_0x406f91(0x1ae)];var _0x49c028=await warehouse[_0x406f91(0x1d8)]([{'$match':{'name':_0x390cd3,'room':_0x31eb65[_0x406f91(0x188)],'warehouse_category':_0x406f91(0x11e)}},{'$unwind':_0x406f91(0x197)},{'$match':{'product_details._id':_0x4ec97b(_0x31eb65[_0x406f91(0x158)])}}]),_0x4862fd=0x0;for(let _0x23c863=0x0;_0x23c863<=_0x49c028['length']-0x1;_0x23c863++){const _0x1a4266=_0x49c028[_0x23c863];_0x31eb65[_0x406f91(0x162)]==_0x406f91(0x17d)?(console['log']('-'),_0x4862fd=parseFloat(_0x49c028[_0x23c863][_0x406f91(0x18d)][_0x406f91(0x149)])-parseFloat(_0x31eb65[_0x406f91(0x132)])):(console['log']('+'),_0x4862fd=parseFloat(_0x49c028[_0x23c863]['product_details'][_0x406f91(0x149)])+parseFloat(_0x31eb65[_0x406f91(0x132)])),await warehouse[_0x406f91(0x126)]({'_id':_0x4ec97b(_0x1a4266['_id'][_0x406f91(0x125)]()),'product_details._id':_0x4ec97b(_0x1a4266[_0x406f91(0x18d)][_0x406f91(0x1be)])},{'$set':{'product_details.$.product_stock':_0x4862fd,'product_details.$.adj_invoice':_0x54e5f2[_0x406f91(0x1b1)]}}),console[_0x406f91(0x14f)](_0x1a4266[_0x406f91(0x1be)][_0x406f91(0x125)]()+_0x406f91(0x1c5)+_0x1a4266[_0x406f91(0x18d)][_0x406f91(0x1be)]+_0x406f91(0x1c5)+_0x4862fd);}}});_0x54e5f2[_0x268ea7(0x1db)]='True';const _0x10107e=await _0x54e5f2[_0x268ea7(0x14b)](),_0xb6e213=await master_shop[_0x268ea7(0x144)](),_0x2169f6=await email_settings['findOne'](),_0xaae879=await supervisor_settings[_0x268ea7(0x144)]();var _0x2ad59b=_0x54e5f2['product'],_0x15ab37='',_0x109147;for(_0x109147 in _0x2ad59b){_0x15ab37+=_0x268ea7(0x1d7)+_0x268ea7(0x16b)+_0x2ad59b[_0x109147][_0x268ea7(0x175)]+_0x268ea7(0x14c)+_0x268ea7(0x16b)+_0x2ad59b[_0x109147][_0x268ea7(0x1b2)]+_0x268ea7(0x14c)+_0x268ea7(0x16b)+_0x2ad59b[_0x109147][_0x268ea7(0x132)]+_0x268ea7(0x14c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2ad59b[_0x109147]['unit']+_0x268ea7(0x14c)+_0x268ea7(0x16b)+_0x2ad59b[_0x109147]['secondary_unit']+_0x268ea7(0x14c)+_0x268ea7(0x16b)+_0x54e5f2['warehouse_name']+_0x268ea7(0x14c)+_0x268ea7(0x16b)+_0x2ad59b[_0x109147]['room_names']+'</td>'+_0x268ea7(0x16b)+_0x2ad59b[_0x109147][_0x268ea7(0x17c)]+_0x2ad59b[_0x109147][_0x268ea7(0x12d)]+_0x2ad59b[_0x109147][_0x268ea7(0x131)]+_0x2ad59b[_0x109147][_0x268ea7(0x19d)]+_0x2ad59b[_0x109147][_0x268ea7(0x1aa)][0x0]+_0x2ad59b[_0x109147][_0x268ea7(0x157)]+'</td>',_0x268ea7(0x1bb);}let _0x262bf1=nodemailer[_0x268ea7(0x160)]({'host':_0x2169f6[_0x268ea7(0x18c)],'port':Number(_0x2169f6[_0x268ea7(0x192)]),'secure':![],'auth':{'user':_0x2169f6[_0x268ea7(0x185)],'pass':_0x2169f6['password']}}),_0x210498={'from':_0x2169f6[_0x268ea7(0x185)],'to':_0xaae879[0x0][_0x268ea7(0x128)],'subject':_0x268ea7(0x1e4),'attachments':[{'filename':_0x268ea7(0x165),'path':__dirname+_0x268ea7(0x1a8)+'/upload/'+_0xb6e213[0x0][_0x268ea7(0x1af)],'cid':_0x268ea7(0x1e1)}],'html':_0x268ea7(0x115)+_0x268ea7(0x1a0)+_0x268ea7(0x15d)+_0x268ea7(0x127)+_0x268ea7(0x112)+'<div>'+_0x268ea7(0x11a)+_0x268ea7(0x15f)+_0x268ea7(0x127)+_0x268ea7(0x12a)+_0xb6e213[0x0][_0x268ea7(0x151)]+_0x268ea7(0x18a)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x268ea7(0x1a3)+_0x268ea7(0x1c7)+_0x54e5f2[_0x268ea7(0x1b1)]+'\x20'+_0x268ea7(0x116)+'\x20Order\x20Date\x20:\x20'+_0x54e5f2[_0x268ea7(0x16e)]+'\x20'+_0x268ea7(0x147)+_0x268ea7(0x159)+_0x268ea7(0x15f)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x268ea7(0x1b4)+_0x268ea7(0x1d7)+_0x268ea7(0x148)+_0x268ea7(0x14d)+_0x268ea7(0x166)+_0x268ea7(0x1d9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x268ea7(0x177)+_0x268ea7(0x167)+_0x268ea7(0x1d4)+'</tr>'+_0x268ea7(0x12b)+_0x268ea7(0x1ad)+'\x20'+_0x15ab37+'\x20'+_0x268ea7(0x11f)+_0x268ea7(0x190)+'<div>'+_0x268ea7(0x1c3)+'<h5>'+_0xb6e213[0x0][_0x268ea7(0x151)]+'</h5>'+'</div>'+_0x268ea7(0x15f)+_0x268ea7(0x142)};_0x262bf1[_0x268ea7(0x155)](_0x210498,function(_0x7d0633,_0x2a89c4){var _0x94af8d=_0x268ea7;_0x7d0633?(console[_0x94af8d(0x14f)](_0x7d0633),console[_0x94af8d(0x14f)](_0x94af8d(0x1e5))):console[_0x94af8d(0x14f)]('Email\x20sent\x20successfully');}),_0x3c2bc4['flash'](_0x268ea7(0x1b0),'adjustment\x20Finalized\x20successfully'),_0x3fb752['redirect'](_0x268ea7(0x15e)+_0x10107e[_0x268ea7(0x1be)]);}catch(_0x4151e9){console['log'](_0x4151e9),_0x3fb752['status'](0xc8)['json']({'message':_0x4151e9[_0x268ea7(0x114)]});}}),router[a0_0xc1e590(0x174)](a0_0xc1e590(0x1ab),auth,async(_0x54f2ee,_0x3a7489)=>{var _0x37ed24=a0_0xc1e590;try{const {username:_0x5365e4,email:_0x4179dc,role:_0x18dc41}=_0x54f2ee[_0x37ed24(0x1c9)],_0x314cf5=_0x54f2ee[_0x37ed24(0x1c9)],_0x1c8e3c=await profile[_0x37ed24(0x183)]({'email':_0x314cf5[_0x37ed24(0x185)]}),_0x3da553=await master_shop[_0x37ed24(0x144)](),_0xcd6a8c=_0x54f2ee[_0x37ed24(0x12f)]['id'],_0x30ecb0=await adjustment['findById']({'_id':_0xcd6a8c}),_0x381348=await purchases[_0x37ed24(0x1d8)]([{'$match':{'warehouse_name':_0x30ecb0[_0x37ed24(0x169)]}},{'$unwind':_0x37ed24(0x194)},{'$group':{'_id':_0x37ed24(0x13b)}}]),_0x3af013=await product[_0x37ed24(0x144)]({}),_0x2e93a8=await warehouse['aggregate']([{'$match':{'name':_0x30ecb0['warehouse_name']}},{'$unwind':_0x37ed24(0x197)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x37ed24(0x1de)},'product_stock':{'$first':_0x37ed24(0x171)},'bay':{'$first':_0x37ed24(0x1c6)},'bin':{'$first':_0x37ed24(0x18e)},'type':{'$first':_0x37ed24(0x1e7)},'floorlevel':{'$first':_0x37ed24(0x1d1)},'primary_code':{'$first':_0x37ed24(0x1d3)},'secondary_code':{'$first':_0x37ed24(0x1e0)},'product_code':{'$first':_0x37ed24(0x163)},'storage':{'$first':_0x37ed24(0x139)},'rack':{'$first':_0x37ed24(0x1b7)},'maxPerUnit':{'$first':_0x37ed24(0x189)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x37ed24(0x196)},'batch_code':{'$first':_0x37ed24(0x1ee)},'room':{'$first':_0x37ed24(0x11b)}}}]);let _0x189210;if(_0x314cf5[_0x37ed24(0x1e3)]==_0x37ed24(0x1bd)){const _0x2d39f0=await staff[_0x37ed24(0x183)]({'email':_0x314cf5['email']});_0x189210=await warehouse['aggregate']([{'$match':{'status':_0x37ed24(0x119),'name':_0x2d39f0['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x37ed24(0x14e)}}},{'$group':{'_id':_0x37ed24(0x1a5),'name':{'$first':_0x37ed24(0x1a5)}}}]);}else _0x189210=await warehouse[_0x37ed24(0x1d8)]([{'$match':{'status':'Enabled','warehouse_category':_0x37ed24(0x11e),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x37ed24(0x1a5),'name':{'$first':_0x37ed24(0x1a5)}}}]);if(_0x3da553[0x0][_0x37ed24(0x146)]==_0x37ed24(0x130)){var _0x3c7360=users[_0x37ed24(0x19e)];console[_0x37ed24(0x14f)](_0x3c7360);}else{if(_0x3da553[0x0][_0x37ed24(0x146)]==_0x37ed24(0x17a))var _0x3c7360=users[_0x37ed24(0x17a)];else{if(_0x3da553[0x0][_0x37ed24(0x146)]==_0x37ed24(0x1ed))var _0x3c7360=users[_0x37ed24(0x1ed)];else{if(_0x3da553[0x0][_0x37ed24(0x146)]=='Spanish')var _0x3c7360=users[_0x37ed24(0x1c1)];else{if(_0x3da553[0x0][_0x37ed24(0x146)]==_0x37ed24(0x1ea))var _0x3c7360=users[_0x37ed24(0x1ea)];else{if(_0x3da553[0x0][_0x37ed24(0x146)]=='Portuguese\x20(BR)')var _0x3c7360=users[_0x37ed24(0x11c)];else{if(_0x3da553[0x0][_0x37ed24(0x146)]==_0x37ed24(0x19f))var _0x3c7360=users[_0x37ed24(0x19f)];else{if(_0x3da553[0x0]['language']==_0x37ed24(0x138))var _0x3c7360=users[_0x37ed24(0x16c)];}}}}}}}_0x3a7489[_0x37ed24(0x122)](_0x37ed24(0x136),{'success':_0x54f2ee[_0x37ed24(0x1a6)]('success'),'errors':_0x54f2ee[_0x37ed24(0x1a6)](_0x37ed24(0x1ac)),'role':_0x314cf5,'profile':_0x1c8e3c,'adjustment':_0x30ecb0,'stock':_0x2e93a8,'master_shop':_0x3da553,'warehouse_name':_0x381348,'unit':_0x3af013,'language':_0x3c7360,'warehouse':_0x189210});}catch(_0x112d2b){console['log'](_0x112d2b),_0x3a7489['status'](0xc8)[_0x37ed24(0x176)]({'message':_0x112d2b['message']});}}),router[a0_0xc1e590(0x198)](a0_0xc1e590(0x1ab),auth,async(_0x12a34c,_0x47a224)=>{var _0x4f7de6=a0_0xc1e590;try{const _0x59fc2f=_0x12a34c[_0x4f7de6(0x12f)]['id'],_0x488c94=await adjustment[_0x4f7de6(0x14a)]({'_id':_0x59fc2f}),_0x20b4c8=await warehouse['findOne']({'name':_0x488c94['warehouse_name'],'room':_0x488c94['room']}),{warehouse_name:_0x5bc734,date:_0x591024,prod_name:_0x5721e5,level:_0x370c63,isle:_0x5e2d20,pallet:_0x4945aa,stock:_0x46660a,types:_0x4e3616,adjust_qty:_0x2c675d,new_adjust_qty:_0x4335a9,note:_0x3c9afa,Room_name:_0x5d3d04,invoice:_0x10ae45,JO_number:_0x105020,expiry_date:_0x100324}=_0x12a34c[_0x4f7de6(0x1ec)];if(typeof _0x5721e5==_0x4f7de6(0x111))var _0x5791cb=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x117)]],_0x14f124=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x1e2)]],_0x530012=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x11d)]],_0x430a64=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x162)]],_0x3a34ab=[_0x12a34c['body']['New_Qty_Converted_adj']],_0x32efb6=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x10f)]],_0x39f90d=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x135)]],_0x683e7c=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x18b)]],_0x3dc29c=[_0x12a34c['body'][_0x4f7de6(0x137)]],_0x18cff8=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x1b9)]],_0x35a108=[_0x12a34c[_0x4f7de6(0x1ec)]['expiry_date']],_0xc93b28=[_0x12a34c['body'][_0x4f7de6(0x143)]],_0x4304d5=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x129)]],_0x3caee1=[_0x12a34c['body']['prod_cat']],_0x597fb5=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x19c)]],_0x73a8f7=[_0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x1cd)]],_0x5f1235=[_0x12a34c['body'][_0x4f7de6(0x181)]];else var _0x5791cb=[..._0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x117)]],_0x14f124=[..._0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x1e2)]],_0x530012=[..._0x12a34c['body']['stock']],_0x430a64=[..._0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x162)]],_0x3a34ab=[..._0x12a34c['body']['New_Qty_Converted_adj']],_0x32efb6=[..._0x12a34c['body'][_0x4f7de6(0x10f)]],_0x39f90d=[..._0x12a34c['body']['unit']],_0x683e7c=[..._0x12a34c['body'][_0x4f7de6(0x18b)]],_0x3dc29c=[..._0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x137)]],_0x18cff8=[..._0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x1b9)]],_0x35a108=[..._0x12a34c['body'][_0x4f7de6(0x124)]],_0xc93b28=[..._0x12a34c['body'][_0x4f7de6(0x143)]],_0x4304d5=[..._0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x129)]],_0x3caee1=[..._0x12a34c[_0x4f7de6(0x1ec)][_0x4f7de6(0x1a1)]],_0x597fb5=[..._0x12a34c[_0x4f7de6(0x1ec)]['Rooms']],_0x73a8f7=[..._0x12a34c['body'][_0x4f7de6(0x1cd)]],_0x5f1235=[..._0x12a34c[_0x4f7de6(0x1ec)]['second1']];const _0x1691ff=_0x5791cb[_0x4f7de6(0x1df)](_0xdfc320=>{return _0xdfc320={'product_name':_0xdfc320};});_0x14f124[_0x4f7de6(0x1d6)]((_0x2201a1,_0x4a534a)=>{var _0x12b862=_0x4f7de6;_0x597fb5[_0x12b862(0x1d6)]((_0x3f0584,_0x10018a)=>{var _0x1cee6f=_0x12b862;if(_0x3f0584==_0x1cee6f(0x17b)&&_0x4a534a==_0x10018a){var _0x343fc0=_0x2201a1[_0x1cee6f(0x140)](0x3);_0x1691ff[_0x4a534a][_0x1cee6f(0x17c)]=_0x2201a1[0x0],_0x1691ff[_0x4a534a][_0x1cee6f(0x12d)]=_0x2201a1[0x1],_0x1691ff[_0x4a534a][_0x1cee6f(0x131)]=0x0,_0x1691ff[_0x4a534a][_0x1cee6f(0x19d)]=0x0,_0x1691ff[_0x4a534a]['type']='Floor',_0x1691ff[_0x4a534a]['floorlevel']=_0x343fc0;}else{if(_0x3f0584==_0x1cee6f(0x1b8)&&_0x4a534a==_0x10018a){var _0x343fc0=_0x2201a1[_0x1cee6f(0x140)](0x3);_0x1691ff[_0x4a534a][_0x1cee6f(0x17c)]=_0x2201a1[0x0],_0x1691ff[_0x4a534a][_0x1cee6f(0x12d)]=_0x2201a1[0x1],_0x1691ff[_0x4a534a][_0x1cee6f(0x131)]=0x0,_0x1691ff[_0x4a534a][_0x1cee6f(0x19d)]=0x0,_0x1691ff[_0x4a534a][_0x1cee6f(0x1aa)]=_0x1cee6f(0x1e6),_0x1691ff[_0x4a534a]['floorlevel']=_0x2201a1[0x5];}else{if(_0x4a534a==_0x10018a){var _0x4f533c;if(_0x2201a1[0x4]=='L')_0x4f533c=_0x1cee6f(0x170);else _0x2201a1[0x4]=='F'&&(_0x4f533c=_0x1cee6f(0x1e6));_0x1691ff[_0x4a534a][_0x1cee6f(0x17c)]=_0x2201a1[0x0],_0x1691ff[_0x4a534a][_0x1cee6f(0x12d)]=_0x2201a1[0x1],_0x1691ff[_0x4a534a][_0x1cee6f(0x131)]=_0x2201a1[0x2],_0x1691ff[_0x4a534a][_0x1cee6f(0x19d)]=_0x2201a1[0x3],_0x1691ff[_0x4a534a]['type']=_0x4f533c,_0x1691ff[_0x4a534a][_0x1cee6f(0x157)]=_0x2201a1[0x5];}}}});}),_0x530012[_0x4f7de6(0x1d6)]((_0x41c23c,_0x108633)=>{var _0x48bb2a=_0x4f7de6;_0x1691ff[_0x108633][_0x48bb2a(0x152)]=_0x41c23c;}),_0x430a64['forEach']((_0x238a29,_0x72e533)=>{_0x1691ff[_0x72e533]['types']=_0x238a29;}),_0x3a34ab[_0x4f7de6(0x1d6)]((_0x13ca07,_0x11d374)=>{var _0xe25650=_0x4f7de6;_0x1691ff[_0x11d374][_0xe25650(0x132)]=_0x13ca07;}),_0x32efb6['forEach']((_0x19a02c,_0x9a7b76)=>{var _0x39d548=_0x4f7de6;_0x1691ff[_0x9a7b76][_0x39d548(0x15c)]=_0x19a02c;}),_0x39f90d[_0x4f7de6(0x1d6)]((_0xceb19e,_0x352254)=>{var _0x4f3164=_0x4f7de6;_0x1691ff[_0x352254][_0x4f3164(0x1e9)]=_0xceb19e;}),_0x683e7c['forEach']((_0x1eed95,_0x385c7f)=>{var _0x2de305=_0x4f7de6;_0x1691ff[_0x385c7f][_0x2de305(0x1da)]=_0x1eed95;}),_0x3dc29c[_0x4f7de6(0x1d6)]((_0x4fdf0b,_0x1e0c2a)=>{var _0x175483=_0x4f7de6;_0x1691ff[_0x1e0c2a][_0x175483(0x1b2)]=_0x4fdf0b;}),_0x18cff8['forEach']((_0x591ebe,_0x34faa5)=>{var _0x576ec2=_0x4f7de6;_0x1691ff[_0x34faa5][_0x576ec2(0x1b9)]=_0x591ebe;}),_0x35a108[_0x4f7de6(0x1d6)]((_0x58e698,_0x294aae)=>{var _0xe0d247=_0x4f7de6;_0x1691ff[_0x294aae][_0xe0d247(0x124)]=_0x58e698;}),_0xc93b28[_0x4f7de6(0x1d6)]((_0x2b9dfe,_0x4c9582)=>{var _0x2ebe93=_0x4f7de6;_0x1691ff[_0x4c9582][_0x2ebe93(0x1cf)]=_0x2b9dfe;}),_0x4304d5[_0x4f7de6(0x1d6)]((_0x2ded48,_0x20f90e)=>{var _0x5ee365=_0x4f7de6;_0x1691ff[_0x20f90e][_0x5ee365(0x129)]=_0x2ded48;}),_0x3caee1[_0x4f7de6(0x1d6)]((_0x1969dc,_0x16e200)=>{var _0xa8867e=_0x4f7de6;_0x1691ff[_0x16e200][_0xa8867e(0x1a1)]=_0x1969dc;}),_0x597fb5[_0x4f7de6(0x1d6)]((_0x54c899,_0x393d6c)=>{var _0x4a3293=_0x4f7de6;_0x1691ff[_0x393d6c][_0x4a3293(0x188)]=_0x54c899;}),_0x73a8f7[_0x4f7de6(0x1d6)]((_0xad5562,_0xfe6a5)=>{var _0xc1b22c=_0x4f7de6;_0x1691ff[_0xfe6a5][_0xc1b22c(0x153)]=_0xad5562;}),_0x5f1235[_0x4f7de6(0x1d6)]((_0xe7d8fa,_0x237fd7)=>{var _0x3b2fca=_0x4f7de6;_0x1691ff[_0x237fd7][_0x3b2fca(0x17f)]=_0xe7d8fa;});const _0x3cd0b0=_0x1691ff[_0x4f7de6(0x19a)](_0x4e21c0=>_0x4e21c0[_0x4f7de6(0x132)]!=='0'&&_0x4e21c0['adjust_qty']!=='');var _0x1e20bd=0x0;_0x3cd0b0[_0x4f7de6(0x1d6)](_0x148b78=>{var _0x4feae0=_0x4f7de6;console[_0x4feae0(0x14f)](_0x4feae0(0x150),_0x148b78),parseInt(_0x148b78[_0x4feae0(0x132)])<=0x0&&_0x1e20bd++;});if(_0x1e20bd!=0x0)return _0x12a34c[_0x4f7de6(0x1a6)](_0x4f7de6(0x1ac),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x47a224[_0x4f7de6(0x156)]('back');_0x488c94[_0x4f7de6(0x169)]=_0x5bc734,_0x488c94[_0x4f7de6(0x16e)]=_0x591024,_0x488c94['product']=_0x3cd0b0,_0x488c94[_0x4f7de6(0x18f)]=_0x3c9afa,_0x488c94[_0x4f7de6(0x1b1)]=_0x10ae45,_0x488c94[_0x4f7de6(0x145)]=_0x4f7de6(0x1d0);const _0x26c3f4=await _0x488c94[_0x4f7de6(0x14b)]();_0x12a34c[_0x4f7de6(0x1a6)](_0x4f7de6(0x1b0),_0x4f7de6(0x191)),_0x47a224[_0x4f7de6(0x156)](_0x4f7de6(0x1ce));}catch(_0x5b59c9){console['log'](_0x5b59c9);}}),router[a0_0xc1e590(0x198)]('/barcode_scanner',async(_0x4a3183,_0x1c4608)=>{var _0x109322=a0_0xc1e590;const {primary_code:_0x2e8468,warehouse_data:_0xc3e63f,rooms_data:_0x5df8bd,Roomslist:_0xb00051}=_0x4a3183['body'],_0x307473=_0xb00051['split'](','),_0x5c3e3c=[];async function _0x256bfe(_0x587ecc){var _0x5e648f=a0_0x5772;const _0x19ceba=await warehouse[_0x5e648f(0x1d8)]([{'$match':{'name':_0xc3e63f,'room':_0x587ecc}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2e8468}},{'$group':{'_id':_0x5e648f(0x178),'name':{'$first':_0x5e648f(0x1de)},'product_stock':{'$first':_0x5e648f(0x171)},'primary_code':{'$first':_0x5e648f(0x1d3)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5e648f(0x1c6)},'isle':{'$first':_0x5e648f(0x18e)},'type':{'$first':_0x5e648f(0x1e7)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5e648f(0x161)},'secondary_unit':{'$first':_0x5e648f(0x1b6)},'storage':{'$first':_0x5e648f(0x139)},'rack':{'$first':_0x5e648f(0x1b7)},'expiry_date':{'$first':_0x5e648f(0x1c0)},'production_date':{'$first':_0x5e648f(0x196)},'maxPerUnit':{'$first':_0x5e648f(0x189)},'batch_code':{'$first':_0x5e648f(0x1ee)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x5e648f(0x1c8)}}}]),_0x1edf8d=await warehouse['aggregate']([{'$match':{'name':_0xc3e63f,'room':_0x587ecc}},{'$unwind':_0x5e648f(0x197)},{'$match':{'product_details.secondary_code':_0x2e8468}},{'$group':{'_id':_0x5e648f(0x178),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5e648f(0x1d3)},'secondary_code':{'$first':_0x5e648f(0x1e0)},'product_code':{'$first':_0x5e648f(0x163)},'level':{'$first':_0x5e648f(0x1c6)},'isle':{'$first':_0x5e648f(0x18e)},'type':{'$first':_0x5e648f(0x1e7)},'pallet':{'$first':_0x5e648f(0x1d1)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5e648f(0x1b6)},'storage':{'$first':_0x5e648f(0x139)},'rack':{'$first':_0x5e648f(0x1b7)},'expiry_date':{'$first':_0x5e648f(0x1c0)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x5e648f(0x189)},'batch_code':{'$first':_0x5e648f(0x1ee)},'product_cat':{'$first':_0x5e648f(0x1ba)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5e648f(0x11b)}}}]);if(_0x19ceba[_0x5e648f(0x1b5)]>0x0)_0x5c3e3c['push'](_0x19ceba);else _0x1edf8d[_0x5e648f(0x1b5)]>0x0&&_0x5c3e3c[_0x5e648f(0x133)](_0x1edf8d);}const _0x581e49=_0x307473[_0x109322(0x1df)](_0x23e20e=>_0x256bfe(_0x23e20e));await Promise[_0x109322(0x1b3)](_0x581e49),_0x1c4608['json'](_0x5c3e3c);}),router['post'](a0_0xc1e590(0x1bf),async(_0x3d52b7,_0x7a056f)=>{var _0x220861=a0_0xc1e590;const {primaryCode:_0x499e9c,secondaryCode:_0x17db83,productCode:_0x4d90c1,level:_0x9ac67a,isle:_0x98caee,pallet:_0x567b9f,warehouses:_0x595f7b,room:_0x5225ac}=_0x3d52b7[_0x220861(0x1ec)];try{const _0x2221d2=await warehouse[_0x220861(0x1d8)]([{'$match':{'name':_0x595f7b,'room':_0x5225ac}},{'$unwind':_0x220861(0x197)},{'$match':{'product_details.level':parseInt(_0x9ac67a),'product_details.isle':_0x98caee,'product_details.pallet':parseInt(_0x567b9f)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x220861(0x1de)},'product_stock':{'$first':_0x220861(0x171)},'level':{'$first':_0x220861(0x154)},'isle':{'$first':_0x220861(0x1e8)},'pallet':{'$first':_0x220861(0x164)},'maxProducts':{'$first':_0x220861(0x134)}}}]);_0x7a056f['status'](0xc8)['json'](_0x2221d2);}catch(_0x5e0a84){_0x7a056f[_0x220861(0x1dc)](0x194)[_0x220861(0x176)]({'message':_0x5e0a84[_0x220861(0x114)]});}}),module['exports']=router;