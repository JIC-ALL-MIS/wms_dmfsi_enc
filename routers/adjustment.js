var a0_0xc39c79=a0_0x5120;(function(_0x27fe68,_0x445121){var _0x58904a=a0_0x5120,_0x53bd48=_0x27fe68();while(!![]){try{var _0x44f32b=parseInt(_0x58904a(0x221))/0x1*(parseInt(_0x58904a(0x283))/0x2)+-parseInt(_0x58904a(0x208))/0x3+-parseInt(_0x58904a(0x240))/0x4+parseInt(_0x58904a(0x24a))/0x5+parseInt(_0x58904a(0x1f6))/0x6*(parseInt(_0x58904a(0x2b7))/0x7)+-parseInt(_0x58904a(0x290))/0x8*(parseInt(_0x58904a(0x1f8))/0x9)+-parseInt(_0x58904a(0x295))/0xa*(-parseInt(_0x58904a(0x21a))/0xb);if(_0x44f32b===_0x445121)break;else _0x53bd48['push'](_0x53bd48['shift']());}catch(_0xf4ad9f){_0x53bd48['push'](_0x53bd48['shift']());}}}(a0_0x1990,0xc0a19));function a0_0x1990(){var _0x2994a3=['isAllowEdit','level','adjustment\x20Finalized\x20successfully','32669UvlXDY','storage','<strong>\x20Regards\x20</strong>','$isAllowEdit','findById','product','<!DOCTYPE\x20html>','bay','render','/adjustment/view','message','Arabic','image','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Email\x20sent\x20successfully','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','back','room_names','522fHhbnK','$product_details.production_date','189846Xmgzkb','$warehouse_name','$name','$product_details','Arabic\x20(ae)','prod_name','site_title','find','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','New_Qty_Converted','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','</tbody>','stockBefore','Receiving\x20Area','length','958893LiSJtL','production_date','port','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','save','edit_adjustment_view','params','$product_details.bay','An\x20error\x20occurred\x20while\x20saving\x20data.','/upload/','id_transaction','stock','language','/view/add_adjustment','$product','French','$product_details._id','30316uCiMsb','bin','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product.product_name','$product_details.primary_code','adjustment','exports','8AWMHke','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','json','$room','$product_details.floorlevel','<html><head><title></title>','$product_details.unit','Enclosed','id_transaction_from','staff','</tr>','errors','email','log','True','new_adjust_qty','rack','Raw\x20Materials','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','An\x20error\x20occurred.','../models/all_models','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','redirect','express','prime1','\x20Order\x20Date\x20:\x20','Return\x20Goods','</table>','role','$product_details.maxPerUnit','Portuguese\x20(BR)','4171840zQSrkF','$product_details.invoice','English\x20(US)','$product_details.secondary_code','room','toString','invoice','user','Enabled','product_details','5324015NIXsCT','ADJ-','New_Qty_Converted_adj','batch_code','Spanish','</h5>','foreach\x20newproduct','aggregate','../middleware/auth','$product_details.secondary_unit','product_name','forEach','adjustment\x20add\x20successfull','adjust_qty','False','</body></html>','$product_details.rack','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','password','secondary_code','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','minus','host','all','<span\x20style=\x22float:\x20right;\x22>','date','string','<h5>','$product_details.storage','$product_details.product_name','warehouse_name','post','findOne','$invoice','product_stock','error','English','<div>','prod_code','then','</thead>','status','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','split','warehouse','types','$product_details.maxProducts','slice','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','German','nodemailer','Secondary_units','filter','padStart','push','43630BXfGXu','/barcode_scanner','prod_invoice','/view/:id','$product_details.product_stock','$product_details.batch_code','$product_details.type','\x20<>\x20','success','floorlevel','type','<tr>','$product_details.product_cat','16pRynDf','expiry_date','Return\x20Rooms','secondary_unit','floor','1990UPktVn','body','prod_cat','Floor','Chinese','$product.room_names','second1','maxperunit','unit','Hindi','map','get','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Logo.png','/CheckingWarehouse','logo','max_per_unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','</div>','flash','primary_code','product_code','/adjustment/preview/','</span>','Portuguese','master','Adjustment\x20Mail','createTransport','Level','$date','Rooms'];a0_0x1990=function(){return _0x2994a3;};return a0_0x1990();}const express=require(a0_0xc39c79(0x238)),app=express(),router=express['Router'](),auth=require(a0_0xc39c79(0x252)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xc39c79(0x235)),users=require('../public/language/languages.json'),nodemailer=require(a0_0xc39c79(0x27e));router[a0_0xc39c79(0x2a0)]('/view',auth,async(_0x402eb8,_0x2c099c)=>{var _0x5dc535=a0_0xc39c79;try{const {username:_0x3d22e0,email:_0xb2875f,role:_0x3d1b9c}=_0x402eb8['user'],_0x110314=_0x402eb8[_0x5dc535(0x247)],_0x262799=await profile[_0x5dc535(0x26a)]({'email':_0x110314[_0x5dc535(0x22d)]}),_0xfb53a5=await master_shop['find']();console[_0x5dc535(0x22e)](_0x5dc535(0x2ae),_0xfb53a5);let _0x1766ae;if(_0x110314[_0x5dc535(0x23d)]==_0x5dc535(0x22a)){const _0x1c2e9b=await staff[_0x5dc535(0x26a)]({'email':_0x110314[_0x5dc535(0x22d)]});_0x1766ae=await warehouse['find']({'status':'Enabled','name':_0x1c2e9b[_0x5dc535(0x278)]});}else _0x1766ae=await warehouse[_0x5dc535(0x1ff)]({'status':_0x5dc535(0x248)});const _0x423222=await product[_0x5dc535(0x1ff)]();let _0x15e013;if(_0x110314[_0x5dc535(0x23d)]==_0x5dc535(0x22a)){const _0x589bd0=await staff[_0x5dc535(0x26a)]({'email':_0x110314[_0x5dc535(0x22d)]});_0x15e013=await adjustment[_0x5dc535(0x1ff)]({'warehouse_name':_0x589bd0['warehouse']});}else _0x15e013=await adjustment[_0x5dc535(0x251)]([{'$unwind':_0x5dc535(0x217)},{'$group':{'_id':'$_id','invoice':{'$first':_0x5dc535(0x26b)},'date':{'$first':_0x5dc535(0x2b2)},'warehouse_name':{'$first':_0x5dc535(0x1f9)},'room':{'$addToSet':_0x5dc535(0x29a)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x5dc535(0x2ba)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xfb53a5[0x0]['language']==_0x5dc535(0x242)){var _0xfd729b=users['English'];console['log'](_0xfd729b);}else{if(_0xfb53a5[0x0][_0x5dc535(0x215)]==_0x5dc535(0x29e))var _0xfd729b=users[_0x5dc535(0x29e)];else{if(_0xfb53a5[0x0][_0x5dc535(0x215)]=='German')var _0xfd729b=users['German'];else{if(_0xfb53a5[0x0][_0x5dc535(0x215)]==_0x5dc535(0x24e))var _0xfd729b=users['Spanish'];else{if(_0xfb53a5[0x0][_0x5dc535(0x215)]==_0x5dc535(0x218))var _0xfd729b=users[_0x5dc535(0x218)];else{if(_0xfb53a5[0x0][_0x5dc535(0x215)]==_0x5dc535(0x23f))var _0xfd729b=users['Portuguese'];else{if(_0xfb53a5[0x0]['language']==_0x5dc535(0x299))var _0xfd729b=users[_0x5dc535(0x299)];else{if(_0xfb53a5[0x0][_0x5dc535(0x215)]==_0x5dc535(0x1fc))var _0xfd729b=users[_0x5dc535(0x1ee)];}}}}}}}_0x2c099c[_0x5dc535(0x2bf)](_0x5dc535(0x21f),{'success':_0x402eb8[_0x5dc535(0x2a8)](_0x5dc535(0x28b)),'errors':_0x402eb8[_0x5dc535(0x2a8)](_0x5dc535(0x22c)),'role':_0x110314,'profile':_0x262799,'warehouse':_0x1766ae,'product':_0x423222,'adjustment':_0x15e013,'master_shop':_0xfb53a5,'language':_0xfd729b});}catch(_0x7db4d0){console[_0x5dc535(0x22e)](_0x7db4d0);}});async function getRandom8DigitNumber(){var _0x28bc4e=a0_0xc39c79;const _0x14d00e=0x989680,_0x2c4ec9=0x5f5e0ff,_0x165331=Math[_0x28bc4e(0x294)](Math['random']()*(_0x2c4ec9-_0x14d00e+0x1))+_0x14d00e;var _0x2e9099;const _0x1d0abd=await adjustment[_0x28bc4e(0x26a)]({'invoice':_0x28bc4e(0x24b)+_0x165331});return _0x1d0abd&&_0x1d0abd[_0x28bc4e(0x207)]>0x0?_0x2e9099=_0x28bc4e(0x24b)+_0x165331:_0x2e9099=_0x28bc4e(0x24b)+_0x165331,_0x2e9099;}function a0_0x5120(_0x4349d8,_0x3f88d4){var _0x199050=a0_0x1990();return a0_0x5120=function(_0x5120b6,_0x44560b){_0x5120b6=_0x5120b6-0x1ed;var _0x323a49=_0x199050[_0x5120b6];return _0x323a49;},a0_0x5120(_0x4349d8,_0x3f88d4);}router[a0_0xc39c79(0x2a0)](a0_0xc39c79(0x216),auth,async(_0x1928a0,_0x301c09)=>{var _0x5694b8=a0_0xc39c79;try{const {username:_0x454711,email:_0x1d40e8,role:_0x5e2829}=_0x1928a0['user'],_0x1b7d89=_0x1928a0[_0x5694b8(0x247)],_0x31c143=await profile[_0x5694b8(0x26a)]({'email':_0x1b7d89[_0x5694b8(0x22d)]}),_0x2b1470=await master_shop[_0x5694b8(0x1ff)]();let _0x185a47;if(_0x1b7d89['role']=='staff'){const _0x44bf01=await staff['findOne']({'email':_0x1b7d89[_0x5694b8(0x22d)]});_0x185a47=await warehouse[_0x5694b8(0x251)]([{'$match':{'status':'Enabled','name':_0x44bf01['warehouse'],'warehouse_category':_0x5694b8(0x232),'name':{'$ne':_0x5694b8(0x23b)}}},{'$group':{'_id':_0x5694b8(0x1fa),'name':{'$first':'$name'}}}]);}else _0x185a47=await warehouse[_0x5694b8(0x251)]([{'$match':{'status':'Enabled','warehouse_category':_0x5694b8(0x232),'name':{'$ne':_0x5694b8(0x23b)}}},{'$group':{'_id':_0x5694b8(0x1fa),'name':{'$first':'$name'}}}]);const _0xc2e2f8=await product[_0x5694b8(0x1ff)]({}),_0x2fd60d=await adjustment['find']({}),_0x49ba44=_0x2fd60d[_0x5694b8(0x207)]+0x1,_0x37024a=_0x5694b8(0x24b)+_0x49ba44[_0x5694b8(0x245)]()[_0x5694b8(0x281)](0x5,'0');var _0x518e97=['Ambient',_0x5694b8(0x228),_0x5694b8(0x292)];if(_0x2b1470[0x0][_0x5694b8(0x215)]==_0x5694b8(0x242))var _0x10ca3a=users[_0x5694b8(0x26e)];else{if(_0x2b1470[0x0][_0x5694b8(0x215)]==_0x5694b8(0x29e))var _0x10ca3a=users[_0x5694b8(0x29e)];else{if(_0x2b1470[0x0][_0x5694b8(0x215)]==_0x5694b8(0x27d))var _0x10ca3a=users[_0x5694b8(0x27d)];else{if(_0x2b1470[0x0]['language']=='Spanish')var _0x10ca3a=users[_0x5694b8(0x24e)];else{if(_0x2b1470[0x0][_0x5694b8(0x215)]=='French')var _0x10ca3a=users['French'];else{if(_0x2b1470[0x0][_0x5694b8(0x215)]==_0x5694b8(0x23f))var _0x10ca3a=users[_0x5694b8(0x2ad)];else{if(_0x2b1470[0x0][_0x5694b8(0x215)]==_0x5694b8(0x299))var _0x10ca3a=users[_0x5694b8(0x299)];else{if(_0x2b1470[0x0][_0x5694b8(0x215)]==_0x5694b8(0x1fc))var _0x10ca3a=users['Arabic'];}}}}}}}const _0x293f7c=getRandom8DigitNumber();_0x293f7c[_0x5694b8(0x271)](_0x3fe978=>{var _0x52ed73=_0x5694b8;_0x301c09['render']('add_adjustment',{'success':_0x1928a0[_0x52ed73(0x2a8)](_0x52ed73(0x28b)),'errors':_0x1928a0[_0x52ed73(0x2a8)](_0x52ed73(0x22c)),'role':_0x1b7d89,'profile':_0x31c143,'warehouse':_0x185a47,'product':_0xc2e2f8,'master_shop':_0x2b1470,'language':_0x10ca3a,'rooms_data':_0x518e97,'invoice_no':_0x3fe978});})['catch'](_0x5b0f3f=>{var _0x287254=_0x5694b8;_0x1928a0[_0x287254(0x2a8)](_0x287254(0x22c),_0x287254(0x2a6)),_0x301c09['redirect'](_0x287254(0x2c0));});}catch(_0x5445af){console[_0x5694b8(0x22e)](_0x5445af);}}),router[a0_0xc39c79(0x269)](a0_0xc39c79(0x216),auth,async(_0x6a1f33,_0x583b48)=>{var _0xcfad25=a0_0xc39c79;try{const {warehouse_name:_0x312149,date:_0x2a88e4,prod_name:_0x50c024,level:_0x31ec00,isle:_0x4f1ba1,pallet:_0x2cc7f2,stock:_0x120820,types:_0x3c4e14,adjust_qty:_0x26451a,new_adjust_qty:_0x499b72,note:_0x40783d,Room_name:_0x27e80f,invoice:_0x8f9ae1,JO_number:_0x52bffc,expiry_date:_0x10375f}=_0x6a1f33[_0xcfad25(0x296)];if(typeof _0x50c024=='string')var _0x43c529=[_0x6a1f33['body'][_0xcfad25(0x1fd)]],_0x101692=[_0x6a1f33['body'][_0xcfad25(0x2b5)]],_0xa9bc70=[_0x6a1f33[_0xcfad25(0x296)]['stock']],_0x55864a=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x279)]],_0x252cae=[_0x6a1f33['body']['New_Qty_Converted_adj']],_0x5771ab=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x201)]],_0x2bfdc6=[_0x6a1f33[_0xcfad25(0x296)]['Primary_Units']],_0x3668be=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x27f)]],_0x4c45f7=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x270)]],_0x4d5189=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x24d)]],_0x46471e=[_0x6a1f33['body'][_0xcfad25(0x291)]],_0x9ba52d=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x2a5)]],_0x66e37e=[_0x6a1f33[_0xcfad25(0x296)]['production_date']],_0x21fb5b=[_0x6a1f33['body'][_0xcfad25(0x297)]],_0x18b9cc=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x2b3)]],_0x53f441=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x239)]],_0x178bf6=[_0x6a1f33[_0xcfad25(0x296)]['second1']],_0x27e962=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x285)]],_0xf2bb33=[_0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x213)]];else var _0x43c529=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x1fd)]],_0x101692=[..._0x6a1f33['body']['level']],_0xa9bc70=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x214)]],_0x55864a=[..._0x6a1f33['body']['types']],_0x252cae=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x24c)]],_0x5771ab=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x201)]],_0x2bfdc6=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x29d)]],_0x3668be=[..._0x6a1f33['body'][_0xcfad25(0x27f)]],_0x4c45f7=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x270)]],_0x4d5189=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x24d)]],_0x46471e=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x291)]],_0x9ba52d=[..._0x6a1f33['body'][_0xcfad25(0x2a5)]],_0x66e37e=[..._0x6a1f33['body']['production_date']],_0x21fb5b=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x297)]],_0x18b9cc=[..._0x6a1f33['body']['Rooms']],_0x53f441=[..._0x6a1f33[_0xcfad25(0x296)]['prime1']],_0x178bf6=[..._0x6a1f33[_0xcfad25(0x296)]['second1']],_0x27e962=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x285)]],_0xf2bb33=[..._0x6a1f33[_0xcfad25(0x296)][_0xcfad25(0x213)]];const _0x101789=_0x43c529[_0xcfad25(0x29f)](_0x26a2ec=>{return _0x26a2ec={'product_name':_0x26a2ec};});_0x101692[_0xcfad25(0x255)]((_0x411240,_0x1ed9ce)=>{var _0x111d55=_0xcfad25;_0x18b9cc[_0x111d55(0x255)]((_0x6e84c4,_0x29bc85)=>{var _0x331f8d=_0x111d55;if(_0x6e84c4==_0x331f8d(0x206)&&_0x1ed9ce==_0x29bc85){var _0x59443a=_0x411240['slice'](0x3);_0x101789[_0x1ed9ce][_0x331f8d(0x2b8)]=_0x411240[0x0],_0x101789[_0x1ed9ce][_0x331f8d(0x231)]=_0x411240[0x1],_0x101789[_0x1ed9ce][_0x331f8d(0x2be)]=0x0,_0x101789[_0x1ed9ce][_0x331f8d(0x21b)]=0x0,_0x101789[_0x1ed9ce][_0x331f8d(0x28d)]=_0x331f8d(0x298),_0x101789[_0x1ed9ce][_0x331f8d(0x28c)]=_0x59443a;}else{if(_0x6e84c4=='Shelves'&&_0x1ed9ce==_0x29bc85){var _0x59443a=_0x411240[_0x331f8d(0x27b)](0x3);_0x101789[_0x1ed9ce][_0x331f8d(0x2b8)]=_0x411240[0x0],_0x101789[_0x1ed9ce][_0x331f8d(0x231)]=_0x411240[0x1],_0x101789[_0x1ed9ce][_0x331f8d(0x2be)]=0x0,_0x101789[_0x1ed9ce][_0x331f8d(0x21b)]=0x0,_0x101789[_0x1ed9ce][_0x331f8d(0x28d)]=_0x331f8d(0x298),_0x101789[_0x1ed9ce][_0x331f8d(0x28c)]=_0x411240[0x5];}else{if(_0x1ed9ce==_0x29bc85){var _0x4b3dab;if(_0x411240[0x4]=='L')_0x4b3dab='Level';else _0x411240[0x4]=='F'&&(_0x4b3dab='Floor');_0x101789[_0x1ed9ce][_0x331f8d(0x2b8)]=_0x411240[0x0],_0x101789[_0x1ed9ce]['rack']=_0x411240[0x1],_0x101789[_0x1ed9ce][_0x331f8d(0x2be)]=_0x411240[0x2],_0x101789[_0x1ed9ce][_0x331f8d(0x21b)]=_0x411240[0x3],_0x101789[_0x1ed9ce][_0x331f8d(0x28d)]=_0x4b3dab,_0x101789[_0x1ed9ce][_0x331f8d(0x28c)]=_0x411240[0x5];}}}});}),_0xa9bc70[_0xcfad25(0x255)]((_0x4e90a2,_0x494df6)=>{var _0x3a5d94=_0xcfad25;_0x101789[_0x494df6][_0x3a5d94(0x205)]=_0x4e90a2;}),_0xf2bb33[_0xcfad25(0x255)]((_0x1c2549,_0x48724d)=>{var _0x33d438=_0xcfad25;_0x101789[_0x48724d][_0x33d438(0x229)]=_0x1c2549;}),_0x55864a[_0xcfad25(0x255)]((_0x49de5d,_0x2856a1)=>{var _0x1a5c55=_0xcfad25;_0x101789[_0x2856a1][_0x1a5c55(0x279)]=_0x49de5d;}),_0x252cae[_0xcfad25(0x255)]((_0x116cc0,_0x37936c)=>{var _0x48ab12=_0xcfad25;_0x101789[_0x37936c][_0x48ab12(0x257)]=_0x116cc0;}),_0x5771ab['forEach']((_0x4131ee,_0x36d885)=>{_0x101789[_0x36d885]['new_adjust_qty']=_0x4131ee;}),_0x2bfdc6[_0xcfad25(0x255)]((_0x2752f3,_0x4708af)=>{_0x101789[_0x4708af]['unit']=_0x2752f3;}),_0x3668be[_0xcfad25(0x255)]((_0x153c6c,_0xafdf9)=>{var _0x5673a3=_0xcfad25;_0x101789[_0xafdf9][_0x5673a3(0x293)]=_0x153c6c;}),_0x4c45f7[_0xcfad25(0x255)]((_0x1c0887,_0x18e68d)=>{var _0x4a47ba=_0xcfad25;_0x101789[_0x18e68d][_0x4a47ba(0x2aa)]=_0x1c0887;}),_0x4d5189[_0xcfad25(0x255)]((_0x221e46,_0x1d22e4)=>{var _0xa2ec7=_0xcfad25;_0x101789[_0x1d22e4][_0xa2ec7(0x24d)]=_0x221e46;}),_0x46471e[_0xcfad25(0x255)]((_0x423ce0,_0x11ed2f)=>{var _0x3d95db=_0xcfad25;_0x101789[_0x11ed2f][_0x3d95db(0x291)]=_0x423ce0;}),_0x9ba52d[_0xcfad25(0x255)]((_0x24d8fa,_0x25dae7)=>{_0x101789[_0x25dae7]['maxperunit']=_0x24d8fa;}),_0x66e37e['forEach']((_0x52db5f,_0x20b41e)=>{var _0x1d76ff=_0xcfad25;_0x101789[_0x20b41e][_0x1d76ff(0x209)]=_0x52db5f;}),_0x21fb5b[_0xcfad25(0x255)]((_0x18519f,_0x2ab496)=>{var _0x19c27c=_0xcfad25;_0x101789[_0x2ab496][_0x19c27c(0x297)]=_0x18519f;}),_0x18b9cc[_0xcfad25(0x255)]((_0x4bb7c0,_0x2eebf6)=>{var _0x4c3c23=_0xcfad25;_0x101789[_0x2eebf6][_0x4c3c23(0x1f5)]=_0x4bb7c0;}),_0x53f441['forEach']((_0x5c042c,_0x259bd8)=>{var _0x398e4d=_0xcfad25;_0x101789[_0x259bd8][_0x398e4d(0x2a9)]=_0x5c042c;}),_0x178bf6[_0xcfad25(0x255)]((_0x19daf7,_0x12edf5)=>{var _0x3c01b8=_0xcfad25;_0x101789[_0x12edf5][_0x3c01b8(0x25d)]=_0x19daf7;}),_0x27e962[_0xcfad25(0x255)]((_0x24e383,_0x11edfc)=>{var _0xa02480=_0xcfad25;_0x101789[_0x11edfc][_0xa02480(0x246)]=_0x24e383;});const _0x2fc4f7=_0x101789[_0xcfad25(0x280)](_0x40f2ef=>_0x40f2ef[_0xcfad25(0x257)]!=='0'&&_0x40f2ef[_0xcfad25(0x257)]!=='');var _0x2df8b0=0x0;_0x2fc4f7[_0xcfad25(0x255)](_0x43af70=>{var _0x358035=_0xcfad25;console[_0x358035(0x22e)](_0x358035(0x250),_0x43af70),parseInt(_0x43af70[_0x358035(0x257)])<=0x0&&_0x2df8b0++;});if(_0x2df8b0!=0x0)return _0x6a1f33['flash'](_0xcfad25(0x22c),_0xcfad25(0x25e)),_0x583b48[_0xcfad25(0x237)](_0xcfad25(0x1f4));const _0x30895d=new adjustment({'warehouse_name':_0x312149,'date':_0x2a88e4,'product':_0x2fc4f7,'note':_0x40783d,'room':_0x27e80f,'invoice':_0x8f9ae1,'JO_number':_0x52bffc,'expiry_date':_0x10375f}),_0x35a764=await _0x30895d['save']();_0x6a1f33[_0xcfad25(0x2a8)](_0xcfad25(0x28b),_0xcfad25(0x256)),_0x583b48[_0xcfad25(0x237)](_0xcfad25(0x2ab)+_0x35a764['_id']);}catch(_0x1ee6c7){console[_0xcfad25(0x22e)](_0x1ee6c7),_0x583b48[_0xcfad25(0x273)](0xc8)['json']({'message':_0x1ee6c7[_0xcfad25(0x1ed)]});}}),router[a0_0xc39c79(0x2a0)]('/preview/:id',auth,async(_0x29d6a6,_0x19c45b)=>{var _0x3533a6=a0_0xc39c79;try{const {username:_0x133a2a,email:_0x1eae49,role:_0x1b93c6}=_0x29d6a6[_0x3533a6(0x247)],_0x2f9f9d=_0x29d6a6['user'],_0x17a68b=await profile['findOne']({'email':_0x2f9f9d[_0x3533a6(0x22d)]}),_0x36b7f7=await master_shop[_0x3533a6(0x1ff)](),_0x53ce1a=_0x29d6a6['params']['id'],_0x4a092a=await adjustment[_0x3533a6(0x2bb)]({'_id':_0x53ce1a}),_0x638259=await purchases[_0x3533a6(0x251)]([{'$match':{'warehouse_name':_0x4a092a[_0x3533a6(0x268)]}},{'$unwind':_0x3533a6(0x217)},{'$group':{'_id':_0x3533a6(0x21d)}}]),_0x275fa6=await product['find']({}),_0x596be9=await warehouse[_0x3533a6(0x251)]([{'$match':{'name':_0x4a092a[_0x3533a6(0x268)]}},{'$unwind':_0x3533a6(0x1fb)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3533a6(0x267)},'product_stock':{'$first':_0x3533a6(0x287)},'bay':{'$first':_0x3533a6(0x210)},'bin':{'$first':_0x3533a6(0x275)},'type':{'$first':_0x3533a6(0x289)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x3533a6(0x21e)},'secondary_code':{'$first':_0x3533a6(0x243)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3533a6(0x266)},'rack':{'$first':_0x3533a6(0x25a)},'maxPerUnit':{'$first':_0x3533a6(0x23e)},'expiry_date':{'$first':_0x3533a6(0x202)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x3533a6(0x288)},'room':{'$first':'$room'}}}]);if(_0x36b7f7[0x0][_0x3533a6(0x215)]=='English\x20(US)'){var _0x2b5684=users[_0x3533a6(0x26e)];console[_0x3533a6(0x22e)](_0x2b5684);}else{if(_0x36b7f7[0x0]['language']==_0x3533a6(0x29e))var _0x2b5684=users[_0x3533a6(0x29e)];else{if(_0x36b7f7[0x0][_0x3533a6(0x215)]==_0x3533a6(0x27d))var _0x2b5684=users[_0x3533a6(0x27d)];else{if(_0x36b7f7[0x0]['language']==_0x3533a6(0x24e))var _0x2b5684=users[_0x3533a6(0x24e)];else{if(_0x36b7f7[0x0][_0x3533a6(0x215)]==_0x3533a6(0x218))var _0x2b5684=users[_0x3533a6(0x218)];else{if(_0x36b7f7[0x0][_0x3533a6(0x215)]==_0x3533a6(0x23f))var _0x2b5684=users[_0x3533a6(0x2ad)];else{if(_0x36b7f7[0x0][_0x3533a6(0x215)]==_0x3533a6(0x299))var _0x2b5684=users[_0x3533a6(0x299)];else{if(_0x36b7f7[0x0]['language']==_0x3533a6(0x1fc))var _0x2b5684=users[_0x3533a6(0x1ee)];}}}}}}}_0x19c45b['render'](_0x3533a6(0x20e),{'success':_0x29d6a6['flash'](_0x3533a6(0x28b)),'errors':_0x29d6a6[_0x3533a6(0x2a8)](_0x3533a6(0x22c)),'role':_0x2f9f9d,'profile':_0x17a68b,'adjustment':_0x4a092a,'stock':_0x596be9,'master_shop':_0x36b7f7,'warehouse_name':_0x638259,'unit':_0x275fa6,'language':_0x2b5684});}catch(_0x106805){console[_0x3533a6(0x22e)](_0x106805),_0x19c45b[_0x3533a6(0x273)](0xc8)[_0x3533a6(0x223)]({'message':_0x106805[_0x3533a6(0x1ed)]});}}),router['post']('/preview/:id',auth,async(_0x59ec94,_0x2e40bb)=>{var _0xf6c5af=a0_0xc39c79;try{const _0x266245=_0x59ec94[_0xf6c5af(0x20f)]['id'],{warehouse_name:_0x48d670,Room_name:_0x46f8bd}=_0x59ec94['body'],_0x190a8a=await adjustment[_0xf6c5af(0x2bb)]({'_id':_0x266245}),_0x5d2c04=_0x190a8a['product']['map'](async _0x5528e3=>{var _0xae553=_0xf6c5af;if(_0x5528e3[_0xae553(0x257)]>0x0){var _0x4b667c=await warehouse[_0xae553(0x26a)]({'name':_0x48d670,'room':_0x5528e3[_0xae553(0x1f5)],'warehouse_category':'Raw\x20Materials'});const _0x729215=_0x4b667c[_0xae553(0x249)][_0xae553(0x29f)](_0x3726d7=>{var _0x56a029=_0xae553;console[_0x56a029(0x22e)](_0x5528e3[_0x56a029(0x279)]+_0x56a029(0x28a));if(_0x5528e3[_0x56a029(0x279)]==_0x56a029(0x25f)){if(_0x3726d7[_0x56a029(0x254)]==_0x5528e3[_0x56a029(0x254)]&&_0x3726d7[_0x56a029(0x28c)]==_0x5528e3[_0x56a029(0x28c)]&&_0x3726d7[_0x56a029(0x28d)]==_0x5528e3[_0x56a029(0x28d)]&&_0x3726d7[_0x56a029(0x21b)]==_0x5528e3[_0x56a029(0x21b)]&&_0x3726d7['bay']==_0x5528e3[_0x56a029(0x2be)]&&_0x3726d7['rack']==_0x5528e3[_0x56a029(0x231)]&&_0x3726d7['storage']==_0x5528e3['storage']&&_0x3726d7['expiry_date']==_0x5528e3[_0x56a029(0x291)]&&_0x3726d7[_0x56a029(0x24d)]==_0x5528e3['batch_code']&&_0x3726d7[_0x56a029(0x209)]==_0x5528e3[_0x56a029(0x209)]&&_0x3726d7[_0x56a029(0x246)]==_0x5528e3['invoice']&&_0x3726d7['_id']==_0x5528e3[_0x56a029(0x229)]){var _0x569d3b;_0x569d3b=_0x5528e3[_0x56a029(0x257)],_0x5528e3[_0x56a029(0x297)]=='S'&&(_0x569d3b=_0x5528e3[_0x56a029(0x257)]),_0x3726d7['product_stock']=_0x3726d7[_0x56a029(0x26c)]-_0x569d3b;}}else{if(_0x3726d7[_0x56a029(0x254)]==_0x5528e3[_0x56a029(0x254)]&&_0x3726d7[_0x56a029(0x28c)]==_0x5528e3['floorlevel']&&_0x3726d7[_0x56a029(0x28d)]==_0x5528e3[_0x56a029(0x28d)]&&_0x3726d7[_0x56a029(0x21b)]==_0x5528e3['bin']&&_0x3726d7[_0x56a029(0x2be)]==_0x5528e3[_0x56a029(0x2be)]&&_0x3726d7[_0x56a029(0x231)]==_0x5528e3[_0x56a029(0x231)]&&_0x3726d7[_0x56a029(0x2b8)]==_0x5528e3[_0x56a029(0x2b8)]&&_0x3726d7[_0x56a029(0x291)]==_0x5528e3[_0x56a029(0x291)]&&_0x3726d7[_0x56a029(0x24d)]==_0x5528e3[_0x56a029(0x24d)]&&_0x3726d7[_0x56a029(0x209)]==_0x5528e3[_0x56a029(0x209)]&&_0x3726d7[_0x56a029(0x246)]==_0x5528e3[_0x56a029(0x246)]&&_0x3726d7['_id']==_0x5528e3[_0x56a029(0x229)]){console['log'](_0x5528e3);var _0x569d3b;_0x569d3b=_0x5528e3[_0x56a029(0x257)],_0x5528e3[_0x56a029(0x297)]=='S'&&(_0x569d3b=_0x5528e3[_0x56a029(0x257)]),_0x3726d7[_0x56a029(0x26c)]=_0x3726d7[_0x56a029(0x26c)]+_0x569d3b;}}});}return _0x4b667c;});Promise[_0xf6c5af(0x261)](_0x5d2c04)['then'](async _0x18be59=>{var _0x2bc303=_0xf6c5af;try{for(const _0x3f94bc of _0x18be59){await _0x3f94bc[_0x2bc303(0x20d)]();}_0x190a8a['finalize']=_0x2bc303(0x22f);const _0x11beb6=await _0x190a8a[_0x2bc303(0x20d)](),_0x2fd25a=await master_shop['find'](),_0x2998de=await email_settings[_0x2bc303(0x26a)](),_0x20d667=await supervisor_settings[_0x2bc303(0x1ff)]();var _0x59c3a0=_0x190a8a[_0x2bc303(0x2bc)],_0x2f7d32='',_0x194eac;for(_0x194eac in _0x59c3a0){_0x2f7d32+=_0x2bc303(0x28e)+_0x2bc303(0x25b)+_0x59c3a0[_0x194eac][_0x2bc303(0x254)]+_0x2bc303(0x20b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x59c3a0[_0x194eac][_0x2bc303(0x2aa)]+_0x2bc303(0x20b)+_0x2bc303(0x25b)+_0x59c3a0[_0x194eac]['adjust_qty']+_0x2bc303(0x20b)+_0x2bc303(0x25b)+_0x59c3a0[_0x194eac]['unit']+'</td>'+_0x2bc303(0x25b)+_0x59c3a0[_0x194eac]['secondary_unit']+'</td>'+_0x2bc303(0x25b)+_0x190a8a['warehouse_name']+_0x2bc303(0x20b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x59c3a0[_0x194eac][_0x2bc303(0x1f5)]+'</td>'+_0x2bc303(0x25b)+_0x59c3a0[_0x194eac]['storage']+_0x59c3a0[_0x194eac][_0x2bc303(0x231)]+_0x59c3a0[_0x194eac][_0x2bc303(0x2be)]+_0x59c3a0[_0x194eac]['bin']+_0x59c3a0[_0x194eac][_0x2bc303(0x28d)][0x0]+_0x59c3a0[_0x194eac][_0x2bc303(0x28c)]+_0x2bc303(0x20b),_0x2bc303(0x22b);}let _0x4faaea=nodemailer[_0x2bc303(0x2b0)]({'host':_0x2998de[_0x2bc303(0x260)],'port':Number(_0x2998de[_0x2bc303(0x20a)]),'secure':![],'auth':{'user':_0x2998de[_0x2bc303(0x22d)],'pass':_0x2998de[_0x2bc303(0x25c)]}}),_0x170c9b={'from':_0x2998de[_0x2bc303(0x22d)],'to':_0x20d667[0x0]['RMSEmail'],'subject':_0x2bc303(0x2af),'attachments':[{'filename':_0x2bc303(0x2a2),'path':__dirname+'/../public'+_0x2bc303(0x212)+_0x2fd25a[0x0][_0x2bc303(0x1ef)],'cid':_0x2bc303(0x2a4)}],'html':_0x2bc303(0x2bd)+_0x2bc303(0x226)+'</head><body>'+_0x2bc303(0x26f)+_0x2bc303(0x27c)+_0x2bc303(0x26f)+_0x2bc303(0x21c)+'</div>'+_0x2bc303(0x26f)+'<h2>\x20'+_0x2fd25a[0x0][_0x2bc303(0x1fe)]+'\x20</h2>'+_0x2bc303(0x2a7)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x2bc303(0x26f)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x190a8a['invoice']+'\x20'+_0x2bc303(0x262)+_0x2bc303(0x23a)+_0x190a8a['date']+'\x20'+_0x2bc303(0x2ac)+_0x2bc303(0x24f)+'</div>'+_0x2bc303(0x1f0)+_0x2bc303(0x200)+_0x2bc303(0x28e)+_0x2bc303(0x1f3)+_0x2bc303(0x222)+_0x2bc303(0x276)+_0x2bc303(0x236)+_0x2bc303(0x2a1)+_0x2bc303(0x20c)+_0x2bc303(0x203)+_0x2bc303(0x233)+_0x2bc303(0x22b)+_0x2bc303(0x272)+_0x2bc303(0x274)+'\x20'+_0x2f7d32+'\x20'+_0x2bc303(0x204)+_0x2bc303(0x23c)+_0x2bc303(0x26f)+_0x2bc303(0x2b9)+_0x2bc303(0x265)+_0x2fd25a[0x0][_0x2bc303(0x1fe)]+_0x2bc303(0x24f)+_0x2bc303(0x2a7)+'</div>'+_0x2bc303(0x259)};_0x4faaea['sendMail'](_0x170c9b,function(_0x3baccd,_0x2282cd){var _0x2b00cc=_0x2bc303;_0x3baccd?(console[_0x2b00cc(0x22e)](_0x3baccd),console[_0x2b00cc(0x22e)]('Error\x20Occurs')):console[_0x2b00cc(0x22e)](_0x2b00cc(0x1f1));}),_0x59ec94['flash'](_0x2bc303(0x28b),_0x2bc303(0x2b6)),_0x2e40bb['redirect']('/picking_list/PDF_adjustment_rm/'+_0x11beb6['_id']);}catch(_0x557188){console[_0x2bc303(0x26d)](_0x557188),_0x2e40bb[_0x2bc303(0x273)](0x1f4)[_0x2bc303(0x223)]({'error':_0x2bc303(0x211)});}})['catch'](_0x49dc86=>{var _0x160578=_0xf6c5af;console[_0x160578(0x26d)](_0x49dc86),_0x2e40bb['status'](0x1f4)[_0x160578(0x223)]({'error':_0x160578(0x234)});});}catch(_0x522b9c){console['log'](_0x522b9c),_0x2e40bb[_0xf6c5af(0x273)](0xc8)[_0xf6c5af(0x223)]({'message':_0x522b9c[_0xf6c5af(0x1ed)]});}}),router[a0_0xc39c79(0x2a0)]('/view/:id',auth,async(_0x812133,_0x29c123)=>{var _0x42cc70=a0_0xc39c79;try{const {username:_0x17670d,email:_0x36b86d,role:_0x31ca42}=_0x812133[_0x42cc70(0x247)],_0x2c543b=_0x812133['user'],_0x141c79=await profile[_0x42cc70(0x26a)]({'email':_0x2c543b[_0x42cc70(0x22d)]}),_0x4aa5e0=await master_shop[_0x42cc70(0x1ff)](),_0x59fd5e=_0x812133[_0x42cc70(0x20f)]['id'],_0xcf95df=await adjustment[_0x42cc70(0x2bb)]({'_id':_0x59fd5e}),_0x4e1531=await purchases['aggregate']([{'$match':{'warehouse_name':_0xcf95df[_0x42cc70(0x268)]}},{'$unwind':_0x42cc70(0x217)},{'$group':{'_id':_0x42cc70(0x21d)}}]),_0x3b3fd8=await product[_0x42cc70(0x1ff)]({}),_0xde79e=await warehouse[_0x42cc70(0x251)]([{'$match':{'name':_0xcf95df[_0x42cc70(0x268)]}},{'$unwind':_0x42cc70(0x1fb)},{'$group':{'_id':_0x42cc70(0x219),'name':{'$first':_0x42cc70(0x267)},'product_stock':{'$first':_0x42cc70(0x287)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x42cc70(0x275)},'type':{'$first':_0x42cc70(0x289)},'floorlevel':{'$first':_0x42cc70(0x225)},'primary_code':{'$first':_0x42cc70(0x21e)},'secondary_code':{'$first':_0x42cc70(0x243)},'product_code':{'$first':_0x42cc70(0x1f2)},'storage':{'$first':_0x42cc70(0x266)},'rack':{'$first':_0x42cc70(0x25a)},'maxPerUnit':{'$first':_0x42cc70(0x23e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x42cc70(0x1f7)},'batch_code':{'$first':_0x42cc70(0x288)},'room':{'$first':_0x42cc70(0x224)}}}]);let _0x1a0faa;if(_0x2c543b[_0x42cc70(0x23d)]==_0x42cc70(0x22a)){const _0x3772cd=await staff[_0x42cc70(0x26a)]({'email':_0x2c543b['email']});_0x1a0faa=await warehouse[_0x42cc70(0x251)]([{'$match':{'status':_0x42cc70(0x248),'name':_0x3772cd[_0x42cc70(0x278)],'warehouse_category':_0x42cc70(0x232),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x42cc70(0x1fa),'name':{'$first':'$name'}}}]);}else _0x1a0faa=await warehouse[_0x42cc70(0x251)]([{'$match':{'status':_0x42cc70(0x248),'warehouse_category':_0x42cc70(0x232),'name':{'$ne':_0x42cc70(0x23b)}}},{'$group':{'_id':_0x42cc70(0x1fa),'name':{'$first':_0x42cc70(0x1fa)}}}]);if(_0x4aa5e0[0x0][_0x42cc70(0x215)]==_0x42cc70(0x242)){var _0x129ab2=users[_0x42cc70(0x26e)];console[_0x42cc70(0x22e)](_0x129ab2);}else{if(_0x4aa5e0[0x0][_0x42cc70(0x215)]==_0x42cc70(0x29e))var _0x129ab2=users['Hindi'];else{if(_0x4aa5e0[0x0]['language']==_0x42cc70(0x27d))var _0x129ab2=users[_0x42cc70(0x27d)];else{if(_0x4aa5e0[0x0][_0x42cc70(0x215)]==_0x42cc70(0x24e))var _0x129ab2=users[_0x42cc70(0x24e)];else{if(_0x4aa5e0[0x0]['language']==_0x42cc70(0x218))var _0x129ab2=users[_0x42cc70(0x218)];else{if(_0x4aa5e0[0x0]['language']==_0x42cc70(0x23f))var _0x129ab2=users['Portuguese'];else{if(_0x4aa5e0[0x0][_0x42cc70(0x215)]==_0x42cc70(0x299))var _0x129ab2=users[_0x42cc70(0x299)];else{if(_0x4aa5e0[0x0][_0x42cc70(0x215)]==_0x42cc70(0x1fc))var _0x129ab2=users[_0x42cc70(0x1ee)];}}}}}}}_0x29c123[_0x42cc70(0x2bf)]('edit_adjustment',{'success':_0x812133[_0x42cc70(0x2a8)](_0x42cc70(0x28b)),'errors':_0x812133[_0x42cc70(0x2a8)](_0x42cc70(0x22c)),'role':_0x2c543b,'profile':_0x141c79,'adjustment':_0xcf95df,'stock':_0xde79e,'master_shop':_0x4aa5e0,'warehouse_name':_0x4e1531,'unit':_0x3b3fd8,'language':_0x129ab2,'warehouse':_0x1a0faa});}catch(_0x5c1746){console['log'](_0x5c1746),_0x29c123[_0x42cc70(0x273)](0xc8)['json']({'message':_0x5c1746[_0x42cc70(0x1ed)]});}}),router[a0_0xc39c79(0x269)](a0_0xc39c79(0x286),auth,async(_0x5c7a05,_0xa6dbbf)=>{var _0xcd4d0=a0_0xc39c79;try{const _0xf50785=_0x5c7a05['params']['id'],_0x3e2ac9=await adjustment['findById']({'_id':_0xf50785}),_0x29343d=await warehouse[_0xcd4d0(0x26a)]({'name':_0x3e2ac9['warehouse_name'],'room':_0x3e2ac9[_0xcd4d0(0x244)]}),{warehouse_name:_0x19f8cb,date:_0x1834b9,prod_name:_0x227a28,level:_0x8d0721,isle:_0x367287,pallet:_0x3b9707,stock:_0x20a0b0,types:_0x33d8a0,adjust_qty:_0x423e57,new_adjust_qty:_0x378778,note:_0x4372c0,Room_name:_0x2914f1,invoice:_0x419a63,JO_number:_0x5dc297,expiry_date:_0x124356}=_0x5c7a05['body'];if(typeof _0x227a28==_0xcd4d0(0x264))var _0x30bfc8=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x1fd)]],_0x20b81b=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x2b5)]],_0x7120f0=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x214)]],_0x2a6cee=[_0x5c7a05['body']['types']],_0x46101e=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x24c)]],_0x621c28=[_0x5c7a05['body'][_0xcd4d0(0x201)]],_0x3f0b34=[_0x5c7a05[_0xcd4d0(0x296)]['Primary_Units']],_0x54c3b0=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x27f)]],_0x125df4=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x270)]],_0x192333=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x24d)]],_0x5d6c9b=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x291)]],_0x45e1a7=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x2a5)]],_0x31adcd=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x209)]],_0x38b1c9=[_0x5c7a05['body'][_0xcd4d0(0x297)]],_0x31a804=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x2b3)]],_0x219ab8=[_0x5c7a05['body']['prime1']],_0x2f044a=[_0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x29b)]];else var _0x30bfc8=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x1fd)]],_0x20b81b=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x2b5)]],_0x7120f0=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x214)]],_0x2a6cee=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x279)]],_0x46101e=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x24c)]],_0x621c28=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x201)]],_0x3f0b34=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x29d)]],_0x54c3b0=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x27f)]],_0x125df4=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x270)]],_0x192333=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x24d)]],_0x5d6c9b=[..._0x5c7a05['body']['expiry_date']],_0x45e1a7=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x2a5)]],_0x31adcd=[..._0x5c7a05[_0xcd4d0(0x296)]['production_date']],_0x38b1c9=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x297)]],_0x31a804=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x2b3)]],_0x219ab8=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x239)]],_0x2f044a=[..._0x5c7a05[_0xcd4d0(0x296)][_0xcd4d0(0x29b)]];const _0x53c23d=_0x30bfc8[_0xcd4d0(0x29f)](_0x486cbc=>{return _0x486cbc={'product_name':_0x486cbc};});_0x20b81b[_0xcd4d0(0x255)]((_0x4113e9,_0x253afd)=>{var _0x374df3=_0xcd4d0;_0x31a804[_0x374df3(0x255)]((_0x20221f,_0x4c5112)=>{var _0x4a19f1=_0x374df3;if(_0x20221f==_0x4a19f1(0x206)&&_0x253afd==_0x4c5112){var _0x37f1c0=_0x4113e9['slice'](0x3);_0x53c23d[_0x253afd][_0x4a19f1(0x2b8)]=_0x4113e9[0x0],_0x53c23d[_0x253afd][_0x4a19f1(0x231)]=_0x4113e9[0x1],_0x53c23d[_0x253afd][_0x4a19f1(0x2be)]=0x0,_0x53c23d[_0x253afd][_0x4a19f1(0x21b)]=0x0,_0x53c23d[_0x253afd][_0x4a19f1(0x28d)]=_0x4a19f1(0x298),_0x53c23d[_0x253afd]['floorlevel']=_0x37f1c0;}else{if(_0x20221f=='Shelves'&&_0x253afd==_0x4c5112){var _0x37f1c0=_0x4113e9['slice'](0x3);_0x53c23d[_0x253afd]['storage']=_0x4113e9[0x0],_0x53c23d[_0x253afd][_0x4a19f1(0x231)]=_0x4113e9[0x1],_0x53c23d[_0x253afd][_0x4a19f1(0x2be)]=0x0,_0x53c23d[_0x253afd][_0x4a19f1(0x21b)]=0x0,_0x53c23d[_0x253afd]['type']='Floor',_0x53c23d[_0x253afd][_0x4a19f1(0x28c)]=_0x4113e9[0x5];}else{if(_0x253afd==_0x4c5112){var _0x103d62;if(_0x4113e9[0x4]=='L')_0x103d62=_0x4a19f1(0x2b1);else _0x4113e9[0x4]=='F'&&(_0x103d62=_0x4a19f1(0x298));_0x53c23d[_0x253afd][_0x4a19f1(0x2b8)]=_0x4113e9[0x0],_0x53c23d[_0x253afd][_0x4a19f1(0x231)]=_0x4113e9[0x1],_0x53c23d[_0x253afd][_0x4a19f1(0x2be)]=_0x4113e9[0x2],_0x53c23d[_0x253afd][_0x4a19f1(0x21b)]=_0x4113e9[0x3],_0x53c23d[_0x253afd]['type']=_0x103d62,_0x53c23d[_0x253afd][_0x4a19f1(0x28c)]=_0x4113e9[0x5];}}}});}),_0x7120f0[_0xcd4d0(0x255)]((_0x4297bf,_0xb6eba8)=>{var _0x1c583c=_0xcd4d0;_0x53c23d[_0xb6eba8][_0x1c583c(0x205)]=_0x4297bf;}),_0x2a6cee['forEach']((_0x3834cc,_0x5706a5)=>{var _0x5739aa=_0xcd4d0;_0x53c23d[_0x5706a5][_0x5739aa(0x279)]=_0x3834cc;}),_0x46101e[_0xcd4d0(0x255)]((_0x2b4b35,_0x261a32)=>{var _0x4b8a22=_0xcd4d0;_0x53c23d[_0x261a32][_0x4b8a22(0x257)]=_0x2b4b35;}),_0x621c28[_0xcd4d0(0x255)]((_0x3b4df0,_0x47d76d)=>{var _0x114e43=_0xcd4d0;_0x53c23d[_0x47d76d][_0x114e43(0x230)]=_0x3b4df0;}),_0x3f0b34[_0xcd4d0(0x255)]((_0x4ef7e6,_0x5c41e1)=>{_0x53c23d[_0x5c41e1]['unit']=_0x4ef7e6;}),_0x54c3b0[_0xcd4d0(0x255)]((_0x49cbe9,_0x5cd716)=>{var _0x41dccf=_0xcd4d0;_0x53c23d[_0x5cd716][_0x41dccf(0x293)]=_0x49cbe9;}),_0x125df4[_0xcd4d0(0x255)]((_0x52493d,_0x4d9505)=>{var _0x12151e=_0xcd4d0;_0x53c23d[_0x4d9505][_0x12151e(0x2aa)]=_0x52493d;}),_0x192333['forEach']((_0x2ea0c7,_0x31a5df)=>{_0x53c23d[_0x31a5df]['batch_code']=_0x2ea0c7;}),_0x5d6c9b[_0xcd4d0(0x255)]((_0x1f13c4,_0x532e0f)=>{_0x53c23d[_0x532e0f]['expiry_date']=_0x1f13c4;}),_0x45e1a7[_0xcd4d0(0x255)]((_0x547817,_0xf77dbc)=>{var _0x4d5eac=_0xcd4d0;_0x53c23d[_0xf77dbc][_0x4d5eac(0x29c)]=_0x547817;}),_0x31adcd[_0xcd4d0(0x255)]((_0x56d012,_0x3a36dd)=>{var _0x1b4468=_0xcd4d0;_0x53c23d[_0x3a36dd][_0x1b4468(0x209)]=_0x56d012;}),_0x38b1c9[_0xcd4d0(0x255)]((_0x4c0ad9,_0x4c88bf)=>{var _0x2dda81=_0xcd4d0;_0x53c23d[_0x4c88bf][_0x2dda81(0x297)]=_0x4c0ad9;}),_0x31a804[_0xcd4d0(0x255)]((_0x41cf02,_0x34e793)=>{var _0x43bec2=_0xcd4d0;_0x53c23d[_0x34e793][_0x43bec2(0x1f5)]=_0x41cf02;}),_0x219ab8[_0xcd4d0(0x255)]((_0x50e27f,_0x4e78a1)=>{var _0x170fd7=_0xcd4d0;_0x53c23d[_0x4e78a1][_0x170fd7(0x2a9)]=_0x50e27f;}),_0x2f044a['forEach']((_0x4f4c5c,_0x1f150f)=>{var _0x508dc9=_0xcd4d0;_0x53c23d[_0x1f150f][_0x508dc9(0x25d)]=_0x4f4c5c;});const _0x40ac77=_0x53c23d[_0xcd4d0(0x280)](_0x3e6682=>_0x3e6682[_0xcd4d0(0x257)]!=='0'&&_0x3e6682[_0xcd4d0(0x257)]!=='');var _0x4f136a=0x0;_0x40ac77[_0xcd4d0(0x255)](_0x3a6ff7=>{var _0x174e36=_0xcd4d0;console[_0x174e36(0x22e)](_0x174e36(0x250),_0x3a6ff7),parseInt(_0x3a6ff7['adjust_qty'])<=0x0&&_0x4f136a++;});if(_0x4f136a!=0x0)return _0x5c7a05[_0xcd4d0(0x2a8)](_0xcd4d0(0x22c),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0xa6dbbf[_0xcd4d0(0x237)]('back');_0x3e2ac9[_0xcd4d0(0x268)]=_0x19f8cb,_0x3e2ac9[_0xcd4d0(0x263)]=_0x1834b9,_0x3e2ac9[_0xcd4d0(0x2bc)]=_0x40ac77,_0x3e2ac9['note']=_0x4372c0,_0x3e2ac9[_0xcd4d0(0x246)]=_0x419a63,_0x3e2ac9[_0xcd4d0(0x2b4)]=_0xcd4d0(0x258);const _0x530695=await _0x3e2ac9[_0xcd4d0(0x20d)]();_0x5c7a05[_0xcd4d0(0x2a8)](_0xcd4d0(0x28b),'adjustment\x20data\x20update\x20successfully'),_0xa6dbbf[_0xcd4d0(0x237)](_0xcd4d0(0x2c0));}catch(_0x488b91){console['log'](_0x488b91);}}),router['post'](a0_0xc39c79(0x284),async(_0x1c3064,_0x359188)=>{var _0x24d3a2=a0_0xc39c79;const {primary_code:_0x17f41e,warehouse_data:_0x1be197,rooms_data:_0x34258e,Roomslist:_0x3c57c9}=_0x1c3064[_0x24d3a2(0x296)],_0x72834f=_0x3c57c9[_0x24d3a2(0x277)](','),_0x2346d8=[];async function _0x58a111(_0x196d98){var _0x4eb84c=_0x24d3a2;const _0x34bd76=await warehouse[_0x4eb84c(0x251)]([{'$match':{'name':_0x1be197,'room':_0x196d98}},{'$unwind':_0x4eb84c(0x1fb)},{'$match':{'product_details.primary_code':_0x17f41e}},{'$group':{'_id':_0x4eb84c(0x219),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4eb84c(0x287)},'primary_code':{'$first':_0x4eb84c(0x21e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4eb84c(0x1f2)},'level':{'$first':_0x4eb84c(0x210)},'isle':{'$first':_0x4eb84c(0x275)},'type':{'$first':_0x4eb84c(0x289)},'pallet':{'$first':_0x4eb84c(0x225)},'unit':{'$first':_0x4eb84c(0x227)},'secondary_unit':{'$first':_0x4eb84c(0x253)},'storage':{'$first':_0x4eb84c(0x266)},'rack':{'$first':_0x4eb84c(0x25a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4eb84c(0x288)},'product_cat':{'$first':_0x4eb84c(0x28f)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x4eb84c(0x241)}}}]),_0x1f75c5=await warehouse[_0x4eb84c(0x251)]([{'$match':{'name':_0x1be197,'room':_0x196d98}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x17f41e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4eb84c(0x267)},'product_stock':{'$first':_0x4eb84c(0x287)},'primary_code':{'$first':_0x4eb84c(0x21e)},'secondary_code':{'$first':_0x4eb84c(0x243)},'product_code':{'$first':_0x4eb84c(0x1f2)},'level':{'$first':_0x4eb84c(0x210)},'isle':{'$first':_0x4eb84c(0x275)},'type':{'$first':_0x4eb84c(0x289)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x4eb84c(0x227)},'secondary_unit':{'$first':_0x4eb84c(0x253)},'storage':{'$first':_0x4eb84c(0x266)},'rack':{'$first':_0x4eb84c(0x25a)},'expiry_date':{'$first':_0x4eb84c(0x202)},'production_date':{'$first':_0x4eb84c(0x1f7)},'maxPerUnit':{'$first':_0x4eb84c(0x23e)},'batch_code':{'$first':_0x4eb84c(0x288)},'product_cat':{'$first':_0x4eb84c(0x28f)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x4eb84c(0x224)}}}]);if(_0x34bd76[_0x4eb84c(0x207)]>0x0)_0x2346d8[_0x4eb84c(0x282)](_0x34bd76);else _0x1f75c5[_0x4eb84c(0x207)]>0x0&&_0x2346d8[_0x4eb84c(0x282)](_0x1f75c5);}const _0x34b2b6=_0x72834f['map'](_0x38e9f3=>_0x58a111(_0x38e9f3));await Promise[_0x24d3a2(0x261)](_0x34b2b6),_0x359188['json'](_0x2346d8);}),router['post'](a0_0xc39c79(0x2a3),async(_0x3aa1f0,_0x53ea56)=>{var _0x55615c=a0_0xc39c79;const {primaryCode:_0x15d5af,secondaryCode:_0x2d4975,productCode:_0x5b5836,level:_0x46f76f,isle:_0x51e130,pallet:_0x8143cc,warehouses:_0x2a1439,room:_0x134d18}=_0x3aa1f0[_0x55615c(0x296)];try{const _0xc32b85=await warehouse[_0x55615c(0x251)]([{'$match':{'name':_0x2a1439,'room':_0x134d18}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x46f76f),'product_details.isle':_0x51e130,'product_details.pallet':parseInt(_0x8143cc)}},{'$group':{'_id':_0x55615c(0x219),'name':{'$first':_0x55615c(0x267)},'product_stock':{'$first':_0x55615c(0x287)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x55615c(0x27a)}}}]);_0x53ea56[_0x55615c(0x273)](0xc8)[_0x55615c(0x223)](_0xc32b85);}catch(_0x50eab6){_0x53ea56[_0x55615c(0x273)](0x194)[_0x55615c(0x223)]({'message':_0x50eab6[_0x55615c(0x1ed)]});}}),module[a0_0xc39c79(0x220)]=router;