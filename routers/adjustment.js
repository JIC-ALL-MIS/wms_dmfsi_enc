var a0_0x325923=a0_0x4955;function a0_0x4955(_0x5ed48d,_0x299cc5){var _0x595bf6=a0_0x595b();return a0_0x4955=function(_0x495585,_0x57b56e){_0x495585=_0x495585-0xfd;var _0x54d2ae=_0x595bf6[_0x495585];return _0x54d2ae;},a0_0x4955(_0x5ed48d,_0x299cc5);}(function(_0x11e66c,_0xae86df){var _0x27774b=a0_0x4955,_0x910cf3=_0x11e66c();while(!![]){try{var _0x18628e=parseInt(_0x27774b(0x1cb))/0x1*(-parseInt(_0x27774b(0x162))/0x2)+-parseInt(_0x27774b(0xfe))/0x3*(parseInt(_0x27774b(0x15f))/0x4)+parseInt(_0x27774b(0x1a4))/0x5+parseInt(_0x27774b(0x1ba))/0x6*(-parseInt(_0x27774b(0x11e))/0x7)+-parseInt(_0x27774b(0x16b))/0x8+parseInt(_0x27774b(0x185))/0x9*(parseInt(_0x27774b(0x181))/0xa)+parseInt(_0x27774b(0x111))/0xb;if(_0x18628e===_0xae86df)break;else _0x910cf3['push'](_0x910cf3['shift']());}catch(_0x5d8d0b){_0x910cf3['push'](_0x910cf3['shift']());}}}(a0_0x595b,0xa376d));const express=require(a0_0x325923(0x150)),app=express(),router=express['Router'](),auth=require(a0_0x325923(0x1a1)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x325923(0x140));router['get'](a0_0x325923(0x1c1),auth,async(_0xb54eab,_0x1c4d89)=>{var _0x448040=a0_0x325923;try{const {username:_0x4a5fd0,email:_0x9cb07b,role:_0x59d698}=_0xb54eab[_0x448040(0x194)],_0x799704=_0xb54eab['user'],_0x1cf141=await profile[_0x448040(0x10f)]({'email':_0x799704[_0x448040(0x121)]}),_0x2c733d=await master_shop['find']();console[_0x448040(0x18e)](_0x448040(0x148),_0x2c733d);let _0x56346c;if(_0x799704[_0x448040(0x133)]==_0x448040(0x119)){const _0x462828=await staff[_0x448040(0x10f)]({'email':_0x799704[_0x448040(0x121)]});_0x56346c=await warehouse['find']({'status':_0x448040(0x1b6),'name':_0x462828[_0x448040(0x188)]});}else _0x56346c=await warehouse[_0x448040(0x180)]({'status':'Enabled'});const _0x4c2a88=await product[_0x448040(0x180)]();let _0x1a3a1c;if(_0x799704['role']=='staff'){const _0x1a4938=await staff['findOne']({'email':_0x799704['email']});_0x1a3a1c=await adjustment[_0x448040(0x180)]({'warehouse_name':_0x1a4938[_0x448040(0x188)]});}else _0x1a3a1c=await adjustment[_0x448040(0x14a)]([{'$unwind':_0x448040(0x1b9)},{'$group':{'_id':_0x448040(0x161),'invoice':{'$first':_0x448040(0x16e)},'date':{'$first':_0x448040(0x11d)},'warehouse_name':{'$first':_0x448040(0xfd)},'room':{'$addToSet':_0x448040(0x171)},'finalize':{'$first':_0x448040(0x103)},'isAllowEdit':{'$first':_0x448040(0x14c)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2c733d[0x0][_0x448040(0x183)]==_0x448040(0x127)){var _0x4d1378=users[_0x448040(0xff)];console['log'](_0x4d1378);}else{if(_0x2c733d[0x0][_0x448040(0x183)]==_0x448040(0x146))var _0x4d1378=users[_0x448040(0x146)];else{if(_0x2c733d[0x0]['language']=='German')var _0x4d1378=users[_0x448040(0x1c3)];else{if(_0x2c733d[0x0][_0x448040(0x183)]==_0x448040(0x145))var _0x4d1378=users['Spanish'];else{if(_0x2c733d[0x0][_0x448040(0x183)]==_0x448040(0x17f))var _0x4d1378=users['French'];else{if(_0x2c733d[0x0]['language']=='Portuguese\x20(BR)')var _0x4d1378=users[_0x448040(0x147)];else{if(_0x2c733d[0x0][_0x448040(0x183)]==_0x448040(0x186))var _0x4d1378=users[_0x448040(0x186)];else{if(_0x2c733d[0x0][_0x448040(0x183)]==_0x448040(0x15a))var _0x4d1378=users['Arabic'];}}}}}}}_0x1c4d89[_0x448040(0x136)](_0x448040(0x1ab),{'success':_0xb54eab[_0x448040(0x144)]('success'),'errors':_0xb54eab[_0x448040(0x144)]('errors'),'role':_0x799704,'profile':_0x1cf141,'warehouse':_0x56346c,'product':_0x4c2a88,'adjustment':_0x1a3a1c,'master_shop':_0x2c733d,'language':_0x4d1378});}catch(_0x2d149a){console[_0x448040(0x18e)](_0x2d149a);}});async function getRandom8DigitNumber(){var _0x1324ac=a0_0x325923;const _0x13babb=0x989680,_0x5b5b1f=0x5f5e0ff,_0x21c83a=Math[_0x1324ac(0x15b)](Math[_0x1324ac(0x11f)]()*(_0x5b5b1f-_0x13babb+0x1))+_0x13babb;var _0x521a30;const _0x1f379d=await adjustment[_0x1324ac(0x10f)]({'invoice':_0x1324ac(0x16d)+_0x21c83a});return _0x1f379d&&_0x1f379d[_0x1324ac(0x143)]>0x0?_0x521a30=_0x1324ac(0x16d)+_0x21c83a:_0x521a30=_0x1324ac(0x16d)+_0x21c83a,_0x521a30;}router[a0_0x325923(0x13b)]('/view/add_adjustment',auth,async(_0x27db7e,_0x5469ac)=>{var _0x37d07b=a0_0x325923;try{const {username:_0x1a5b23,email:_0x1f72aa,role:_0x4012bf}=_0x27db7e['user'],_0x54f577=_0x27db7e[_0x37d07b(0x194)],_0x2c6aed=await profile[_0x37d07b(0x10f)]({'email':_0x54f577['email']}),_0x3e7340=await master_shop[_0x37d07b(0x180)]();let _0x16c0bd;if(_0x54f577[_0x37d07b(0x133)]==_0x37d07b(0x119)){const _0x5c3e9c=await staff[_0x37d07b(0x10f)]({'email':_0x54f577[_0x37d07b(0x121)]});_0x16c0bd=await warehouse[_0x37d07b(0x14a)]([{'$match':{'status':_0x37d07b(0x1b6),'name':_0x5c3e9c[_0x37d07b(0x188)],'warehouse_category':_0x37d07b(0x1a8),'name':{'$ne':_0x37d07b(0x10e)}}},{'$group':{'_id':_0x37d07b(0x1a5),'name':{'$first':'$name'}}}]);}else _0x16c0bd=await warehouse['aggregate']([{'$match':{'status':_0x37d07b(0x1b6),'warehouse_category':_0x37d07b(0x1a8),'name':{'$ne':_0x37d07b(0x10e)}}},{'$group':{'_id':_0x37d07b(0x1a5),'name':{'$first':_0x37d07b(0x1a5)}}}]);const _0x274cb4=await product[_0x37d07b(0x180)]({}),_0x18ba7d=await adjustment[_0x37d07b(0x180)]({}),_0x565337=_0x18ba7d[_0x37d07b(0x143)]+0x1,_0x5e682a=_0x37d07b(0x16d)+_0x565337[_0x37d07b(0x102)]()[_0x37d07b(0x125)](0x5,'0');var _0x21f894=['Ambient',_0x37d07b(0x128),_0x37d07b(0x166)];if(_0x3e7340[0x0][_0x37d07b(0x183)]==_0x37d07b(0x127))var _0x3b4a2d=users[_0x37d07b(0xff)];else{if(_0x3e7340[0x0][_0x37d07b(0x183)]=='Hindi')var _0x3b4a2d=users[_0x37d07b(0x146)];else{if(_0x3e7340[0x0][_0x37d07b(0x183)]==_0x37d07b(0x1c3))var _0x3b4a2d=users[_0x37d07b(0x1c3)];else{if(_0x3e7340[0x0][_0x37d07b(0x183)]==_0x37d07b(0x145))var _0x3b4a2d=users['Spanish'];else{if(_0x3e7340[0x0]['language']==_0x37d07b(0x17f))var _0x3b4a2d=users[_0x37d07b(0x17f)];else{if(_0x3e7340[0x0][_0x37d07b(0x183)]==_0x37d07b(0x17d))var _0x3b4a2d=users[_0x37d07b(0x147)];else{if(_0x3e7340[0x0]['language']==_0x37d07b(0x186))var _0x3b4a2d=users[_0x37d07b(0x186)];else{if(_0x3e7340[0x0][_0x37d07b(0x183)]==_0x37d07b(0x15a))var _0x3b4a2d=users[_0x37d07b(0x18f)];}}}}}}}const _0x3856a0=getRandom8DigitNumber();_0x3856a0[_0x37d07b(0x13a)](_0x4beccc=>{var _0x16ca4e=_0x37d07b;_0x5469ac['render'](_0x16ca4e(0x105),{'success':_0x27db7e['flash'](_0x16ca4e(0x14f)),'errors':_0x27db7e[_0x16ca4e(0x144)](_0x16ca4e(0x1bc)),'role':_0x54f577,'profile':_0x2c6aed,'warehouse':_0x16c0bd,'product':_0x274cb4,'master_shop':_0x3e7340,'language':_0x3b4a2d,'rooms_data':_0x21f894,'invoice_no':_0x4beccc});})[_0x37d07b(0x115)](_0x2e7cd6=>{var _0x732e6d=_0x37d07b;_0x27db7e[_0x732e6d(0x144)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x5469ac['redirect'](_0x732e6d(0x196));});}catch(_0x12c79b){console[_0x37d07b(0x18e)](_0x12c79b);}}),router[a0_0x325923(0x14b)]('/view/add_adjustment',auth,async(_0x53e17c,_0x5390f2)=>{var _0x407982=a0_0x325923;try{const {warehouse_name:_0x1f5339,date:_0x4d4e64,prod_name:_0x2e7594,level:_0xf22290,isle:_0x528893,pallet:_0x24e4bf,stock:_0x349583,types:_0x4ed70e,adjust_qty:_0xd33675,new_adjust_qty:_0x56dcc4,note:_0x2f4ddf,Room_name:_0x136d55,invoice:_0x5e04b1,JO_number:_0x4af0bb,expiry_date:_0x41e090}=_0x53e17c[_0x407982(0x106)];if(typeof _0x2e7594=='string')var _0x3aa989=[_0x53e17c['body'][_0x407982(0x1b2)]],_0x1ad88d=[_0x53e17c[_0x407982(0x106)][_0x407982(0x13e)]],_0x2cd222=[_0x53e17c[_0x407982(0x106)][_0x407982(0x19b)]],_0x2f9cb8=[_0x53e17c[_0x407982(0x106)]['types']],_0x5c3fa3=[_0x53e17c['body'][_0x407982(0x1c5)]],_0xa43bea=[_0x53e17c[_0x407982(0x106)][_0x407982(0x120)]],_0x366313=[_0x53e17c[_0x407982(0x106)]['Primary_Units']],_0x28a36b=[_0x53e17c['body'][_0x407982(0x108)]],_0x4de430=[_0x53e17c['body'][_0x407982(0x12b)]],_0x5eec86=[_0x53e17c['body'][_0x407982(0x107)]],_0x428429=[_0x53e17c[_0x407982(0x106)][_0x407982(0x129)]],_0xca1db4=[_0x53e17c[_0x407982(0x106)]['max_per_unit']],_0x4b4e94=[_0x53e17c[_0x407982(0x106)][_0x407982(0x1b0)]],_0x1715c1=[_0x53e17c[_0x407982(0x106)]['prod_cat']],_0x375f0f=[_0x53e17c[_0x407982(0x106)][_0x407982(0x19c)]],_0x4477a8=[_0x53e17c[_0x407982(0x106)][_0x407982(0x16f)]],_0x190f62=[_0x53e17c[_0x407982(0x106)][_0x407982(0x170)]],_0x36222d=[_0x53e17c[_0x407982(0x106)][_0x407982(0x17c)]],_0x1b65d6=[_0x53e17c[_0x407982(0x106)][_0x407982(0x159)]];else var _0x3aa989=[..._0x53e17c[_0x407982(0x106)]['prod_name']],_0x1ad88d=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x13e)]],_0x2cd222=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x19b)]],_0x2f9cb8=[..._0x53e17c['body'][_0x407982(0x141)]],_0x5c3fa3=[..._0x53e17c['body'][_0x407982(0x1c5)]],_0xa43bea=[..._0x53e17c['body']['New_Qty_Converted']],_0x366313=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x1d1)]],_0x28a36b=[..._0x53e17c[_0x407982(0x106)]['Secondary_units']],_0x4de430=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x12b)]],_0x5eec86=[..._0x53e17c[_0x407982(0x106)]['batch_code']],_0x428429=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x129)]],_0xca1db4=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x193)]],_0x4b4e94=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x1b0)]],_0x1715c1=[..._0x53e17c[_0x407982(0x106)]['prod_cat']],_0x375f0f=[..._0x53e17c['body'][_0x407982(0x19c)]],_0x4477a8=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x16f)]],_0x190f62=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x170)]],_0x36222d=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x17c)]],_0x1b65d6=[..._0x53e17c[_0x407982(0x106)][_0x407982(0x159)]];const _0xe480e=_0x3aa989[_0x407982(0x10d)](_0x330050=>{return _0x330050={'product_name':_0x330050};});_0x1ad88d['forEach']((_0x167b05,_0x301b54)=>{var _0x4d055e=_0x407982;_0x375f0f[_0x4d055e(0x177)]((_0x118f53,_0x480e5c)=>{var _0x372551=_0x4d055e;if(_0x118f53==_0x372551(0x1af)&&_0x301b54==_0x480e5c){var _0xa32549=_0x167b05[_0x372551(0x156)](0x3);_0xe480e[_0x301b54][_0x372551(0x1d2)]=_0x167b05[0x0],_0xe480e[_0x301b54][_0x372551(0x1d0)]=_0x167b05[0x1],_0xe480e[_0x301b54][_0x372551(0x174)]=0x0,_0xe480e[_0x301b54]['bin']=0x0,_0xe480e[_0x301b54][_0x372551(0x173)]='Floor',_0xe480e[_0x301b54][_0x372551(0x1d5)]=_0xa32549;}else{if(_0x118f53==_0x372551(0x130)&&_0x301b54==_0x480e5c){var _0xa32549=_0x167b05[_0x372551(0x156)](0x3);_0xe480e[_0x301b54]['storage']=_0x167b05[0x0],_0xe480e[_0x301b54][_0x372551(0x1d0)]=_0x167b05[0x1],_0xe480e[_0x301b54][_0x372551(0x174)]=0x0,_0xe480e[_0x301b54][_0x372551(0x17b)]=0x0,_0xe480e[_0x301b54][_0x372551(0x173)]=_0x372551(0x123),_0xe480e[_0x301b54][_0x372551(0x1d5)]=_0x167b05[0x5];}else{if(_0x301b54==_0x480e5c){var _0x454d54;if(_0x167b05[0x4]=='L')_0x454d54='Level';else _0x167b05[0x4]=='F'&&(_0x454d54=_0x372551(0x123));_0xe480e[_0x301b54]['storage']=_0x167b05[0x0],_0xe480e[_0x301b54][_0x372551(0x1d0)]=_0x167b05[0x1],_0xe480e[_0x301b54][_0x372551(0x174)]=_0x167b05[0x2],_0xe480e[_0x301b54][_0x372551(0x17b)]=_0x167b05[0x3],_0xe480e[_0x301b54][_0x372551(0x173)]=_0x454d54,_0xe480e[_0x301b54][_0x372551(0x1d5)]=_0x167b05[0x5];}}}});}),_0x2cd222[_0x407982(0x177)]((_0xbea5bc,_0x446943)=>{var _0x54c69b=_0x407982;_0xe480e[_0x446943][_0x54c69b(0x15c)]=_0xbea5bc;}),_0x1b65d6[_0x407982(0x177)]((_0x5c84cc,_0x58982a)=>{var _0x503a0c=_0x407982;_0xe480e[_0x58982a][_0x503a0c(0x19f)]=_0x5c84cc;}),_0x2f9cb8['forEach']((_0x4a0931,_0x4174b4)=>{var _0x55e40e=_0x407982;_0xe480e[_0x4174b4][_0x55e40e(0x141)]=_0x4a0931;}),_0x5c3fa3[_0x407982(0x177)]((_0x291b5d,_0x4e70db)=>{var _0x3982cd=_0x407982;_0xe480e[_0x4e70db][_0x3982cd(0x15d)]=_0x291b5d;}),_0xa43bea[_0x407982(0x177)]((_0x4723a8,_0x5ae08b)=>{_0xe480e[_0x5ae08b]['new_adjust_qty']=_0x4723a8;}),_0x366313['forEach']((_0x112824,_0x3c2810)=>{var _0x3c6383=_0x407982;_0xe480e[_0x3c2810][_0x3c6383(0x1d1)]=_0x112824;}),_0x28a36b[_0x407982(0x177)]((_0x337b76,_0x2ffa56)=>{var _0x3e4814=_0x407982;_0xe480e[_0x2ffa56][_0x3e4814(0x189)]=_0x337b76;}),_0x4de430[_0x407982(0x177)]((_0x26b83b,_0x58c9ef)=>{var _0x9575aa=_0x407982;_0xe480e[_0x58c9ef][_0x9575aa(0x110)]=_0x26b83b;}),_0x5eec86[_0x407982(0x177)]((_0x52dd5d,_0x52c629)=>{var _0xad0413=_0x407982;_0xe480e[_0x52c629][_0xad0413(0x107)]=_0x52dd5d;}),_0x428429[_0x407982(0x177)]((_0x58103c,_0x3ef20d)=>{var _0x56f051=_0x407982;_0xe480e[_0x3ef20d][_0x56f051(0x129)]=_0x58103c;}),_0xca1db4[_0x407982(0x177)]((_0x1b0870,_0x34917c)=>{_0xe480e[_0x34917c]['maxperunit']=_0x1b0870;}),_0x4b4e94[_0x407982(0x177)]((_0x2de24d,_0x5b6295)=>{var _0x1d2581=_0x407982;_0xe480e[_0x5b6295][_0x1d2581(0x1b0)]=_0x2de24d;}),_0x1715c1[_0x407982(0x177)]((_0xe34397,_0x2ef50a)=>{var _0x2b5618=_0x407982;_0xe480e[_0x2ef50a][_0x2b5618(0x17a)]=_0xe34397;}),_0x375f0f[_0x407982(0x177)]((_0xf66788,_0x28bc0c)=>{var _0x1cb690=_0x407982;_0xe480e[_0x28bc0c][_0x1cb690(0x12c)]=_0xf66788;}),_0x4477a8[_0x407982(0x177)]((_0x5b422e,_0x21230c)=>{_0xe480e[_0x21230c]['primary_code']=_0x5b422e;}),_0x190f62['forEach']((_0x1035b6,_0x54a7ae)=>{var _0x4bb806=_0x407982;_0xe480e[_0x54a7ae][_0x4bb806(0x1c0)]=_0x1035b6;}),_0x36222d[_0x407982(0x177)]((_0x13b674,_0x15d4ab)=>{var _0x5d4947=_0x407982;_0xe480e[_0x15d4ab][_0x5d4947(0x11a)]=_0x13b674;});const _0x2bfc14=_0xe480e[_0x407982(0x11b)](_0x41ad0b=>_0x41ad0b[_0x407982(0x15d)]!=='0'&&_0x41ad0b[_0x407982(0x15d)]!=='');var _0x518ed4=0x0;_0x2bfc14[_0x407982(0x177)](_0x45b969=>{var _0x864a69=_0x407982;console[_0x864a69(0x18e)]('foreach\x20newproduct',_0x45b969),parseInt(_0x45b969[_0x864a69(0x15d)])<=0x0&&_0x518ed4++;});if(_0x518ed4!=0x0)return _0x53e17c[_0x407982(0x144)](_0x407982(0x1bc),_0x407982(0x1a3)),_0x5390f2[_0x407982(0x1b5)](_0x407982(0x1bb));const _0x32ebea=new adjustment({'warehouse_name':_0x1f5339,'date':_0x4d4e64,'product':_0x2bfc14,'note':_0x2f4ddf,'room':_0x136d55,'invoice':_0x5e04b1,'JO_number':_0x4af0bb,'expiry_date':_0x41e090}),_0x335266=await _0x32ebea[_0x407982(0x1c2)]();_0x53e17c[_0x407982(0x144)]('success','adjustment\x20add\x20successfull'),_0x5390f2[_0x407982(0x1b5)](_0x407982(0x100)+_0x335266[_0x407982(0x157)]);}catch(_0x47b735){console[_0x407982(0x18e)](_0x47b735),_0x5390f2[_0x407982(0x1bd)](0xc8)[_0x407982(0x113)]({'message':_0x47b735[_0x407982(0x195)]});}}),router[a0_0x325923(0x13b)](a0_0x325923(0x116),auth,async(_0x127dad,_0x4902d6)=>{var _0x40449e=a0_0x325923;try{const {username:_0x1acc6c,email:_0x385900,role:_0x8e8ee4}=_0x127dad[_0x40449e(0x194)],_0x575b27=_0x127dad[_0x40449e(0x194)],_0x4cd6fa=await profile['findOne']({'email':_0x575b27[_0x40449e(0x121)]}),_0x590245=await master_shop[_0x40449e(0x180)](),_0xec5898=_0x127dad[_0x40449e(0x184)]['id'],_0x2bba30=await adjustment[_0x40449e(0x191)]({'_id':_0xec5898}),_0xc57eac=await purchases[_0x40449e(0x14a)]([{'$match':{'warehouse_name':_0x2bba30['warehouse_name']}},{'$unwind':_0x40449e(0x1b9)},{'$group':{'_id':_0x40449e(0x1ce)}}]),_0x318407=await product[_0x40449e(0x180)]({}),_0x8b6c54=await warehouse[_0x40449e(0x14a)]([{'$match':{'name':_0x2bba30[_0x40449e(0x1a7)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x40449e(0x138),'name':{'$first':_0x40449e(0x139)},'product_stock':{'$first':_0x40449e(0x18a)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x40449e(0x17e)},'type':{'$first':_0x40449e(0x169)},'floorlevel':{'$first':_0x40449e(0x131)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x40449e(0x112)},'product_code':{'$first':_0x40449e(0x104)},'storage':{'$first':_0x40449e(0x16c)},'rack':{'$first':_0x40449e(0x182)},'maxPerUnit':{'$first':_0x40449e(0x1c7)},'expiry_date':{'$first':_0x40449e(0x114)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x40449e(0x192)},'room':{'$first':_0x40449e(0x134)}}}]);if(_0x590245[0x0][_0x40449e(0x183)]==_0x40449e(0x127)){var _0x1279ab=users['English'];console[_0x40449e(0x18e)](_0x1279ab);}else{if(_0x590245[0x0][_0x40449e(0x183)]==_0x40449e(0x146))var _0x1279ab=users[_0x40449e(0x146)];else{if(_0x590245[0x0][_0x40449e(0x183)]=='German')var _0x1279ab=users['German'];else{if(_0x590245[0x0][_0x40449e(0x183)]=='Spanish')var _0x1279ab=users[_0x40449e(0x145)];else{if(_0x590245[0x0]['language']==_0x40449e(0x17f))var _0x1279ab=users[_0x40449e(0x17f)];else{if(_0x590245[0x0][_0x40449e(0x183)]==_0x40449e(0x17d))var _0x1279ab=users['Portuguese'];else{if(_0x590245[0x0][_0x40449e(0x183)]=='Chinese')var _0x1279ab=users[_0x40449e(0x186)];else{if(_0x590245[0x0][_0x40449e(0x183)]==_0x40449e(0x15a))var _0x1279ab=users['Arabic'];}}}}}}}_0x4902d6[_0x40449e(0x136)]('edit_adjustment_view',{'success':_0x127dad[_0x40449e(0x144)](_0x40449e(0x14f)),'errors':_0x127dad[_0x40449e(0x144)]('errors'),'role':_0x575b27,'profile':_0x4cd6fa,'adjustment':_0x2bba30,'stock':_0x8b6c54,'master_shop':_0x590245,'warehouse_name':_0xc57eac,'unit':_0x318407,'language':_0x1279ab});}catch(_0x525fed){console['log'](_0x525fed),_0x4902d6[_0x40449e(0x1bd)](0xc8)[_0x40449e(0x113)]({'message':_0x525fed['message']});}}),router[a0_0x325923(0x14b)]('/preview/:id',auth,async(_0x430631,_0x3c60e0)=>{var _0x39b8d9=a0_0x325923;try{const _0x228cb4=_0x430631[_0x39b8d9(0x184)]['id'],{warehouse_name:_0x121d86,Room_name:_0x1178f5}=_0x430631[_0x39b8d9(0x106)],_0x1dac93=await adjustment[_0x39b8d9(0x191)]({'_id':_0x228cb4}),_0x462a03=_0x1dac93[_0x39b8d9(0x163)]['map'](async _0x15a652=>{var _0xf8aa78=_0x39b8d9;if(_0x15a652['adjust_qty']>0x0){var _0x56d9ec=await warehouse[_0xf8aa78(0x10f)]({'name':_0x121d86,'room':_0x15a652['room_names'],'warehouse_category':_0xf8aa78(0x1a8)});const _0x45bf22=_0x56d9ec['product_details'][_0xf8aa78(0x10d)](_0x5864c2=>{var _0x4771f7=_0xf8aa78;console[_0x4771f7(0x18e)](_0x15a652[_0x4771f7(0x141)]+_0x4771f7(0x1b8));if(_0x15a652[_0x4771f7(0x141)]==_0x4771f7(0x1b7)){if(_0x5864c2[_0x4771f7(0x1c9)]==_0x15a652['product_name']&&_0x5864c2[_0x4771f7(0x1d5)]==_0x15a652[_0x4771f7(0x1d5)]&&_0x5864c2['type']==_0x15a652[_0x4771f7(0x173)]&&_0x5864c2[_0x4771f7(0x17b)]==_0x15a652[_0x4771f7(0x17b)]&&_0x5864c2[_0x4771f7(0x174)]==_0x15a652['bay']&&_0x5864c2[_0x4771f7(0x1d0)]==_0x15a652[_0x4771f7(0x1d0)]&&_0x5864c2[_0x4771f7(0x1d2)]==_0x15a652[_0x4771f7(0x1d2)]&&_0x5864c2[_0x4771f7(0x129)]==_0x15a652[_0x4771f7(0x129)]&&_0x5864c2[_0x4771f7(0x107)]==_0x15a652[_0x4771f7(0x107)]&&_0x5864c2[_0x4771f7(0x1b0)]==_0x15a652[_0x4771f7(0x1b0)]&&_0x5864c2[_0x4771f7(0x11a)]==_0x15a652[_0x4771f7(0x11a)]&&_0x5864c2[_0x4771f7(0x157)]==_0x15a652[_0x4771f7(0x19f)]){var _0x1af71b;_0x1af71b=_0x15a652[_0x4771f7(0x15d)],_0x15a652[_0x4771f7(0x17a)]=='S'&&(_0x1af71b=_0x15a652[_0x4771f7(0x15d)]),_0x5864c2[_0x4771f7(0x1ae)]=_0x5864c2[_0x4771f7(0x1ae)]-_0x1af71b;}}else{if(_0x5864c2['product_name']==_0x15a652['product_name']&&_0x5864c2['floorlevel']==_0x15a652['floorlevel']&&_0x5864c2[_0x4771f7(0x173)]==_0x15a652[_0x4771f7(0x173)]&&_0x5864c2['bin']==_0x15a652[_0x4771f7(0x17b)]&&_0x5864c2['bay']==_0x15a652[_0x4771f7(0x174)]&&_0x5864c2[_0x4771f7(0x1d0)]==_0x15a652['rack']&&_0x5864c2['storage']==_0x15a652[_0x4771f7(0x1d2)]&&_0x5864c2[_0x4771f7(0x129)]==_0x15a652[_0x4771f7(0x129)]&&_0x5864c2[_0x4771f7(0x107)]==_0x15a652[_0x4771f7(0x107)]&&_0x5864c2['production_date']==_0x15a652[_0x4771f7(0x1b0)]&&_0x5864c2['invoice']==_0x15a652[_0x4771f7(0x11a)]&&_0x5864c2[_0x4771f7(0x157)]==_0x15a652[_0x4771f7(0x19f)]){console['log'](_0x15a652);var _0x1af71b;_0x1af71b=_0x15a652['adjust_qty'],_0x15a652['prod_cat']=='S'&&(_0x1af71b=_0x15a652[_0x4771f7(0x15d)]),_0x5864c2[_0x4771f7(0x1ae)]=_0x5864c2[_0x4771f7(0x1ae)]+_0x1af71b;}}});}return _0x56d9ec;});Promise[_0x39b8d9(0x10a)](_0x462a03)[_0x39b8d9(0x13a)](async _0x5dacf6=>{var _0x50d638=_0x39b8d9;try{for(const _0x3cf6ce of _0x5dacf6){await _0x3cf6ce[_0x50d638(0x1c2)]();}_0x1dac93['finalize']=_0x50d638(0x117);const _0x3073b0=await _0x1dac93['save'](),_0x28ec7e=await master_shop[_0x50d638(0x180)](),_0x2e7ab6=await email_settings[_0x50d638(0x10f)](),_0x18e2fb=await supervisor_settings[_0x50d638(0x180)]();var _0x25d5ce=_0x1dac93[_0x50d638(0x163)],_0x19edf8='',_0x2c36ed;for(_0x2c36ed in _0x25d5ce){_0x19edf8+=_0x50d638(0x165)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25d5ce[_0x2c36ed][_0x50d638(0x1c9)]+_0x50d638(0x14e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25d5ce[_0x2c36ed][_0x50d638(0x110)]+'</td>'+_0x50d638(0x198)+_0x25d5ce[_0x2c36ed][_0x50d638(0x15d)]+'</td>'+_0x50d638(0x198)+_0x25d5ce[_0x2c36ed][_0x50d638(0x1d1)]+_0x50d638(0x14e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25d5ce[_0x2c36ed]['secondary_unit']+'</td>'+_0x50d638(0x198)+_0x1dac93[_0x50d638(0x1a7)]+_0x50d638(0x14e)+_0x50d638(0x198)+_0x25d5ce[_0x2c36ed][_0x50d638(0x12c)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25d5ce[_0x2c36ed][_0x50d638(0x1d2)]+_0x25d5ce[_0x2c36ed]['rack']+_0x25d5ce[_0x2c36ed]['bay']+_0x25d5ce[_0x2c36ed]['bin']+_0x25d5ce[_0x2c36ed][_0x50d638(0x173)][0x0]+_0x25d5ce[_0x2c36ed]['floorlevel']+'</td>',_0x50d638(0x154);}let _0x1af647=nodemailer[_0x50d638(0x164)]({'host':_0x2e7ab6['host'],'port':Number(_0x2e7ab6[_0x50d638(0x109)]),'secure':![],'auth':{'user':_0x2e7ab6['email'],'pass':_0x2e7ab6[_0x50d638(0x1bf)]}}),_0x4c21ba={'from':_0x2e7ab6[_0x50d638(0x121)],'to':_0x18e2fb[0x0][_0x50d638(0x13c)],'subject':_0x50d638(0x12d),'attachments':[{'filename':'Logo.png','path':__dirname+_0x50d638(0x175)+'/upload/'+_0x28ec7e[0x0][_0x50d638(0x1a2)],'cid':'logo'}],'html':_0x50d638(0x16a)+_0x50d638(0x1ca)+_0x50d638(0x178)+_0x50d638(0x15e)+_0x50d638(0x18d)+_0x50d638(0x15e)+_0x50d638(0x167)+'</div>'+'<div>'+_0x50d638(0x1ad)+_0x28ec7e[0x0][_0x50d638(0x18b)]+_0x50d638(0x1a0)+_0x50d638(0x12f)+_0x50d638(0x12f)+_0x50d638(0x14d)+_0x50d638(0x15e)+_0x50d638(0x1be)+_0x50d638(0x18c)+_0x1dac93[_0x50d638(0x11a)]+'\x20'+_0x50d638(0x118)+_0x50d638(0x1ac)+_0x1dac93[_0x50d638(0x190)]+'\x20'+_0x50d638(0x13d)+_0x50d638(0x1cd)+_0x50d638(0x12f)+_0x50d638(0x135)+_0x50d638(0x1aa)+_0x50d638(0x165)+_0x50d638(0x122)+_0x50d638(0x1b4)+_0x50d638(0x1cc)+_0x50d638(0x155)+_0x50d638(0x168)+_0x50d638(0x151)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x50d638(0x149)+_0x50d638(0x154)+_0x50d638(0x11c)+_0x50d638(0x1cf)+'\x20'+_0x19edf8+'\x20'+'</tbody>'+_0x50d638(0x176)+_0x50d638(0x15e)+_0x50d638(0x13f)+'<h5>'+_0x28ec7e[0x0]['site_title']+_0x50d638(0x1cd)+_0x50d638(0x12f)+'</div>'+_0x50d638(0x137)};_0x1af647[_0x50d638(0x1d3)](_0x4c21ba,function(_0x258ee4,_0x4fe05f){var _0x3c4d8f=_0x50d638;_0x258ee4?(console[_0x3c4d8f(0x18e)](_0x258ee4),console[_0x3c4d8f(0x18e)](_0x3c4d8f(0x197))):console['log'](_0x3c4d8f(0x1c4));}),_0x430631['flash'](_0x50d638(0x14f),_0x50d638(0x10b)),_0x3c60e0[_0x50d638(0x1b5)](_0x50d638(0x10c)+_0x3073b0[_0x50d638(0x157)]);}catch(_0x223883){console[_0x50d638(0x158)](_0x223883),_0x3c60e0[_0x50d638(0x1bd)](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x39b8d9(0x115)](_0x25073a=>{var _0x5386f3=_0x39b8d9;console['error'](_0x25073a),_0x3c60e0[_0x5386f3(0x1bd)](0x1f4)[_0x5386f3(0x113)]({'error':_0x5386f3(0x179)});});}catch(_0x2b0ea9){console['log'](_0x2b0ea9),_0x3c60e0[_0x39b8d9(0x1bd)](0xc8)[_0x39b8d9(0x113)]({'message':_0x2b0ea9['message']});}}),router[a0_0x325923(0x13b)](a0_0x325923(0x1c8),auth,async(_0x3b55a9,_0x78a76)=>{var _0x5bcc15=a0_0x325923;try{const {username:_0x206d2f,email:_0x40cd04,role:_0x1fb699}=_0x3b55a9[_0x5bcc15(0x194)],_0x32e7a7=_0x3b55a9['user'],_0x156a64=await profile[_0x5bcc15(0x10f)]({'email':_0x32e7a7[_0x5bcc15(0x121)]}),_0x11d92f=await master_shop['find'](),_0x294fc9=_0x3b55a9[_0x5bcc15(0x184)]['id'],_0x3e8382=await adjustment['findById']({'_id':_0x294fc9}),_0x100bac=await purchases[_0x5bcc15(0x14a)]([{'$match':{'warehouse_name':_0x3e8382[_0x5bcc15(0x1a7)]}},{'$unwind':_0x5bcc15(0x1b9)},{'$group':{'_id':_0x5bcc15(0x1ce)}}]),_0x329ab7=await product['find']({}),_0x269b55=await warehouse[_0x5bcc15(0x14a)]([{'$match':{'name':_0x3e8382[_0x5bcc15(0x1a7)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5bcc15(0x138),'name':{'$first':_0x5bcc15(0x139)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5bcc15(0x142)},'bin':{'$first':_0x5bcc15(0x17e)},'type':{'$first':_0x5bcc15(0x169)},'floorlevel':{'$first':_0x5bcc15(0x131)},'primary_code':{'$first':_0x5bcc15(0x199)},'secondary_code':{'$first':_0x5bcc15(0x112)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5bcc15(0x16c)},'rack':{'$first':_0x5bcc15(0x182)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x5bcc15(0x114)},'production_date':{'$first':_0x5bcc15(0x19e)},'batch_code':{'$first':_0x5bcc15(0x192)},'room':{'$first':_0x5bcc15(0x134)}}}]);let _0x1639ab;if(_0x32e7a7[_0x5bcc15(0x133)]==_0x5bcc15(0x119)){const _0x43c7e8=await staff[_0x5bcc15(0x10f)]({'email':_0x32e7a7[_0x5bcc15(0x121)]});_0x1639ab=await warehouse[_0x5bcc15(0x14a)]([{'$match':{'status':'Enabled','name':_0x43c7e8[_0x5bcc15(0x188)],'warehouse_category':_0x5bcc15(0x1a8),'name':{'$ne':_0x5bcc15(0x10e)}}},{'$group':{'_id':_0x5bcc15(0x1a5),'name':{'$first':_0x5bcc15(0x1a5)}}}]);}else _0x1639ab=await warehouse[_0x5bcc15(0x14a)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5bcc15(0x10e)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x11d92f[0x0][_0x5bcc15(0x183)]==_0x5bcc15(0x127)){var _0x3aa120=users[_0x5bcc15(0xff)];console[_0x5bcc15(0x18e)](_0x3aa120);}else{if(_0x11d92f[0x0][_0x5bcc15(0x183)]==_0x5bcc15(0x146))var _0x3aa120=users[_0x5bcc15(0x146)];else{if(_0x11d92f[0x0]['language']==_0x5bcc15(0x1c3))var _0x3aa120=users[_0x5bcc15(0x1c3)];else{if(_0x11d92f[0x0]['language']=='Spanish')var _0x3aa120=users['Spanish'];else{if(_0x11d92f[0x0][_0x5bcc15(0x183)]=='French')var _0x3aa120=users[_0x5bcc15(0x17f)];else{if(_0x11d92f[0x0][_0x5bcc15(0x183)]==_0x5bcc15(0x17d))var _0x3aa120=users[_0x5bcc15(0x147)];else{if(_0x11d92f[0x0][_0x5bcc15(0x183)]==_0x5bcc15(0x186))var _0x3aa120=users[_0x5bcc15(0x186)];else{if(_0x11d92f[0x0][_0x5bcc15(0x183)]=='Arabic\x20(ae)')var _0x3aa120=users[_0x5bcc15(0x18f)];}}}}}}}_0x78a76[_0x5bcc15(0x136)]('edit_adjustment',{'success':_0x3b55a9[_0x5bcc15(0x144)](_0x5bcc15(0x14f)),'errors':_0x3b55a9[_0x5bcc15(0x144)](_0x5bcc15(0x1bc)),'role':_0x32e7a7,'profile':_0x156a64,'adjustment':_0x3e8382,'stock':_0x269b55,'master_shop':_0x11d92f,'warehouse_name':_0x100bac,'unit':_0x329ab7,'language':_0x3aa120,'warehouse':_0x1639ab});}catch(_0x1558c6){console[_0x5bcc15(0x18e)](_0x1558c6),_0x78a76[_0x5bcc15(0x1bd)](0xc8)['json']({'message':_0x1558c6[_0x5bcc15(0x195)]});}}),router[a0_0x325923(0x14b)](a0_0x325923(0x1c8),auth,async(_0x3a1453,_0x58a559)=>{var _0x4115a3=a0_0x325923;try{const _0x27cecb=_0x3a1453[_0x4115a3(0x184)]['id'],_0x4b283c=await adjustment['findById']({'_id':_0x27cecb}),_0x5142c8=await warehouse['findOne']({'name':_0x4b283c[_0x4115a3(0x1a7)],'room':_0x4b283c[_0x4115a3(0x187)]}),{warehouse_name:_0x30df6e,date:_0x2896c0,prod_name:_0x33df54,level:_0x3d5045,isle:_0x59d157,pallet:_0x3742e0,stock:_0x2528b9,types:_0x1f3ead,adjust_qty:_0x5528e3,new_adjust_qty:_0x2ac70d,note:_0x3f488b,Room_name:_0x50b993,invoice:_0x159e91,JO_number:_0x4b80c9,expiry_date:_0x114fc3}=_0x3a1453[_0x4115a3(0x106)];if(typeof _0x33df54=='string')var _0x393a59=[_0x3a1453[_0x4115a3(0x106)]['prod_name']],_0x3917fe=[_0x3a1453['body']['level']],_0x1a18a1=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x19b)]],_0x2bc3b3=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x141)]],_0x5d1c5b=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x1c5)]],_0x11e6cd=[_0x3a1453[_0x4115a3(0x106)]['New_Qty_Converted']],_0x1cd3e1=[_0x3a1453['body'][_0x4115a3(0x172)]],_0x1b38f2=[_0x3a1453[_0x4115a3(0x106)]['Secondary_units']],_0x54875a=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x12b)]],_0x3d3d42=[_0x3a1453[_0x4115a3(0x106)]['batch_code']],_0x490e09=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x129)]],_0x29bac5=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x193)]],_0x17ff36=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x1b0)]],_0x372772=[_0x3a1453[_0x4115a3(0x106)]['prod_cat']],_0xbe60a8=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x19c)]],_0x256435=[_0x3a1453[_0x4115a3(0x106)]['prime1']],_0x508277=[_0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x170)]];else var _0x393a59=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x1b2)]],_0x3917fe=[..._0x3a1453[_0x4115a3(0x106)]['level']],_0x1a18a1=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x19b)]],_0x2bc3b3=[..._0x3a1453['body']['types']],_0x5d1c5b=[..._0x3a1453['body'][_0x4115a3(0x1c5)]],_0x11e6cd=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x120)]],_0x1cd3e1=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x1d1)]],_0x1b38f2=[..._0x3a1453['body']['Secondary_units']],_0x54875a=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x12b)]],_0x3d3d42=[..._0x3a1453[_0x4115a3(0x106)]['batch_code']],_0x490e09=[..._0x3a1453[_0x4115a3(0x106)]['expiry_date']],_0x29bac5=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x193)]],_0x17ff36=[..._0x3a1453[_0x4115a3(0x106)]['production_date']],_0x372772=[..._0x3a1453['body'][_0x4115a3(0x17a)]],_0xbe60a8=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x19c)]],_0x256435=[..._0x3a1453[_0x4115a3(0x106)]['prime1']],_0x508277=[..._0x3a1453[_0x4115a3(0x106)][_0x4115a3(0x170)]];const _0x410373=_0x393a59[_0x4115a3(0x10d)](_0x5ee74f=>{return _0x5ee74f={'product_name':_0x5ee74f};});_0x3917fe['forEach']((_0x269625,_0x268685)=>{var _0x2089ac=_0x4115a3;_0xbe60a8[_0x2089ac(0x177)]((_0x1174b9,_0x43eafc)=>{var _0x543f4a=_0x2089ac;if(_0x1174b9==_0x543f4a(0x1af)&&_0x268685==_0x43eafc){var _0x475607=_0x269625[_0x543f4a(0x156)](0x3);_0x410373[_0x268685][_0x543f4a(0x1d2)]=_0x269625[0x0],_0x410373[_0x268685][_0x543f4a(0x1d0)]=_0x269625[0x1],_0x410373[_0x268685]['bay']=0x0,_0x410373[_0x268685][_0x543f4a(0x17b)]=0x0,_0x410373[_0x268685][_0x543f4a(0x173)]=_0x543f4a(0x123),_0x410373[_0x268685][_0x543f4a(0x1d5)]=_0x475607;}else{if(_0x1174b9==_0x543f4a(0x130)&&_0x268685==_0x43eafc){var _0x475607=_0x269625['slice'](0x3);_0x410373[_0x268685]['storage']=_0x269625[0x0],_0x410373[_0x268685]['rack']=_0x269625[0x1],_0x410373[_0x268685]['bay']=0x0,_0x410373[_0x268685][_0x543f4a(0x17b)]=0x0,_0x410373[_0x268685][_0x543f4a(0x173)]=_0x543f4a(0x123),_0x410373[_0x268685][_0x543f4a(0x1d5)]=_0x269625[0x5];}else{if(_0x268685==_0x43eafc){var _0x48dc54;if(_0x269625[0x4]=='L')_0x48dc54='Level';else _0x269625[0x4]=='F'&&(_0x48dc54='Floor');_0x410373[_0x268685][_0x543f4a(0x1d2)]=_0x269625[0x0],_0x410373[_0x268685]['rack']=_0x269625[0x1],_0x410373[_0x268685][_0x543f4a(0x174)]=_0x269625[0x2],_0x410373[_0x268685]['bin']=_0x269625[0x3],_0x410373[_0x268685][_0x543f4a(0x173)]=_0x48dc54,_0x410373[_0x268685][_0x543f4a(0x1d5)]=_0x269625[0x5];}}}});}),_0x1a18a1['forEach']((_0x131a4c,_0x37b0b7)=>{var _0x5ba702=_0x4115a3;_0x410373[_0x37b0b7][_0x5ba702(0x15c)]=_0x131a4c;}),_0x2bc3b3[_0x4115a3(0x177)]((_0x23ce13,_0x1b9214)=>{var _0x43b52f=_0x4115a3;_0x410373[_0x1b9214][_0x43b52f(0x141)]=_0x23ce13;}),_0x5d1c5b['forEach']((_0x1a2e17,_0x42abe2)=>{var _0x3afb16=_0x4115a3;_0x410373[_0x42abe2][_0x3afb16(0x15d)]=_0x1a2e17;}),_0x11e6cd[_0x4115a3(0x177)]((_0x259d46,_0x5d7317)=>{_0x410373[_0x5d7317]['new_adjust_qty']=_0x259d46;}),_0x1cd3e1[_0x4115a3(0x177)]((_0xf7ab8a,_0x1ff457)=>{var _0x5e12dd=_0x4115a3;_0x410373[_0x1ff457][_0x5e12dd(0x1d1)]=_0xf7ab8a;}),_0x1b38f2[_0x4115a3(0x177)]((_0x4ce6d3,_0x4662f4)=>{var _0x561995=_0x4115a3;_0x410373[_0x4662f4][_0x561995(0x189)]=_0x4ce6d3;}),_0x54875a[_0x4115a3(0x177)]((_0x50fca2,_0x11ca97)=>{_0x410373[_0x11ca97]['product_code']=_0x50fca2;}),_0x3d3d42[_0x4115a3(0x177)]((_0x1e335f,_0x2ee042)=>{var _0x1b13c4=_0x4115a3;_0x410373[_0x2ee042][_0x1b13c4(0x107)]=_0x1e335f;}),_0x490e09['forEach']((_0x283b1b,_0x24b2b6)=>{var _0x2f2b70=_0x4115a3;_0x410373[_0x24b2b6][_0x2f2b70(0x129)]=_0x283b1b;}),_0x29bac5[_0x4115a3(0x177)]((_0x3fb70e,_0x3eb987)=>{var _0x2e53a0=_0x4115a3;_0x410373[_0x3eb987][_0x2e53a0(0x132)]=_0x3fb70e;}),_0x17ff36[_0x4115a3(0x177)]((_0x442e5b,_0x344892)=>{_0x410373[_0x344892]['production_date']=_0x442e5b;}),_0x372772['forEach']((_0x372598,_0x1159ba)=>{var _0x1ac3f0=_0x4115a3;_0x410373[_0x1159ba][_0x1ac3f0(0x17a)]=_0x372598;}),_0xbe60a8[_0x4115a3(0x177)]((_0x149bf4,_0x1a1077)=>{_0x410373[_0x1a1077]['room_names']=_0x149bf4;}),_0x256435[_0x4115a3(0x177)]((_0x5b6744,_0x17debe)=>{_0x410373[_0x17debe]['primary_code']=_0x5b6744;}),_0x508277['forEach']((_0x5008c7,_0xf0dfa9)=>{var _0x11a0c6=_0x4115a3;_0x410373[_0xf0dfa9][_0x11a0c6(0x1c0)]=_0x5008c7;});const _0x2d0f29=_0x410373['filter'](_0x4aaefb=>_0x4aaefb[_0x4115a3(0x15d)]!=='0'&&_0x4aaefb['adjust_qty']!=='');var _0x173a57=0x0;_0x2d0f29[_0x4115a3(0x177)](_0x261783=>{var _0x555967=_0x4115a3;console[_0x555967(0x18e)](_0x555967(0x152),_0x261783),parseInt(_0x261783[_0x555967(0x15d)])<=0x0&&_0x173a57++;});if(_0x173a57!=0x0)return _0x3a1453[_0x4115a3(0x144)]('errors',_0x4115a3(0x1a3)),_0x58a559['redirect']('back');_0x4b283c[_0x4115a3(0x1a7)]=_0x30df6e,_0x4b283c[_0x4115a3(0x190)]=_0x2896c0,_0x4b283c[_0x4115a3(0x163)]=_0x2d0f29,_0x4b283c[_0x4115a3(0x153)]=_0x3f488b,_0x4b283c[_0x4115a3(0x11a)]=_0x159e91,_0x4b283c[_0x4115a3(0x101)]=_0x4115a3(0x1b3);const _0x3fce7a=await _0x4b283c[_0x4115a3(0x1c2)]();_0x3a1453[_0x4115a3(0x144)](_0x4115a3(0x14f),_0x4115a3(0x124)),_0x58a559[_0x4115a3(0x1b5)]('/adjustment/view');}catch(_0x529d93){console[_0x4115a3(0x18e)](_0x529d93);}}),router['post'](a0_0x325923(0x19d),async(_0x7a1c56,_0x814d83)=>{var _0x13b5a2=a0_0x325923;const {primary_code:_0x54bf48,warehouse_data:_0x2bed49,rooms_data:_0x1b2388,Roomslist:_0x101864}=_0x7a1c56[_0x13b5a2(0x106)],_0x11b9d=_0x101864[_0x13b5a2(0x1d4)](','),_0x40f089=[];async function _0x1504cb(_0x49a249){var _0xfa26d2=_0x13b5a2;const _0x34ec74=await warehouse[_0xfa26d2(0x14a)]([{'$match':{'name':_0x2bed49,'room':_0x49a249}},{'$unwind':_0xfa26d2(0x19a)},{'$match':{'product_details.primary_code':_0x54bf48}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xfa26d2(0x18a)},'primary_code':{'$first':_0xfa26d2(0x199)},'secondary_code':{'$first':_0xfa26d2(0x112)},'product_code':{'$first':_0xfa26d2(0x104)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xfa26d2(0x169)},'pallet':{'$first':_0xfa26d2(0x131)},'unit':{'$first':_0xfa26d2(0x1a6)},'secondary_unit':{'$first':_0xfa26d2(0x1a9)},'storage':{'$first':_0xfa26d2(0x16c)},'rack':{'$first':_0xfa26d2(0x182)},'expiry_date':{'$first':_0xfa26d2(0x114)},'production_date':{'$first':_0xfa26d2(0x19e)},'maxPerUnit':{'$first':_0xfa26d2(0x1c7)},'batch_code':{'$first':_0xfa26d2(0x192)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0xfa26d2(0x134)},'invoice':{'$first':_0xfa26d2(0x160)}}}]),_0x4f602e=await warehouse[_0xfa26d2(0x14a)]([{'$match':{'name':_0x2bed49,'room':_0x49a249}},{'$unwind':_0xfa26d2(0x19a)},{'$match':{'product_details.secondary_code':_0x54bf48}},{'$group':{'_id':_0xfa26d2(0x138),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xfa26d2(0x199)},'secondary_code':{'$first':_0xfa26d2(0x112)},'product_code':{'$first':_0xfa26d2(0x104)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0xfa26d2(0x17e)},'type':{'$first':_0xfa26d2(0x169)},'pallet':{'$first':_0xfa26d2(0x131)},'unit':{'$first':_0xfa26d2(0x1a6)},'secondary_unit':{'$first':_0xfa26d2(0x1a9)},'storage':{'$first':_0xfa26d2(0x16c)},'rack':{'$first':_0xfa26d2(0x182)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xfa26d2(0x19e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0xfa26d2(0x192)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0xfa26d2(0x134)}}}]);if(_0x34ec74[_0xfa26d2(0x143)]>0x0)_0x40f089[_0xfa26d2(0x1b1)](_0x34ec74);else _0x4f602e['length']>0x0&&_0x40f089['push'](_0x4f602e);}const _0x460e26=_0x11b9d[_0x13b5a2(0x10d)](_0x370f21=>_0x1504cb(_0x370f21));await Promise['all'](_0x460e26),_0x814d83[_0x13b5a2(0x113)](_0x40f089);}),router['post'](a0_0x325923(0x1c6),async(_0xcc6eb5,_0x2658ac)=>{var _0xe4233b=a0_0x325923;const {primaryCode:_0x14c0c5,secondaryCode:_0x59e20c,productCode:_0x5a97f2,level:_0x210667,isle:_0x124137,pallet:_0x519e51,warehouses:_0x41b652,room:_0x48e05b}=_0xcc6eb5[_0xe4233b(0x106)];try{const _0x4b175f=await warehouse[_0xe4233b(0x14a)]([{'$match':{'name':_0x41b652,'room':_0x48e05b}},{'$unwind':_0xe4233b(0x19a)},{'$match':{'product_details.level':parseInt(_0x210667),'product_details.isle':_0x124137,'product_details.pallet':parseInt(_0x519e51)}},{'$group':{'_id':_0xe4233b(0x138),'name':{'$first':_0xe4233b(0x139)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0xe4233b(0x12a)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xe4233b(0x12e)},'maxProducts':{'$first':_0xe4233b(0x126)}}}]);_0x2658ac[_0xe4233b(0x1bd)](0xc8)['json'](_0x4b175f);}catch(_0x2b0a4c){_0x2658ac[_0xe4233b(0x1bd)](0x194)[_0xe4233b(0x113)]({'message':_0x2b0a4c['message']});}}),module['exports']=router;function a0_0x595b(){var _0x168fdd=['Error\x20Occurs','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.primary_code','$product_details','stock','Rooms','/barcode_scanner','$product_details.production_date','id_transaction_from','\x20</h2>','../middleware/auth','image','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','3481325jkAFtc','$name','$product_details.unit','warehouse_name','Raw\x20Materials','$product_details.secondary_unit','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','adjustment','\x20Order\x20Date\x20:\x20','<h2>\x20','product_stock','Receiving\x20Area','production_date','push','prod_name','False','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','redirect','Enabled','minus','\x20<>\x20','$product','1011624oBlNKx','back','errors','status','<h5\x20style=\x22text-align:\x20left;\x22>','password','secondary_code','/view','save','German','Email\x20sent\x20successfully','New_Qty_Converted_adj','/CheckingWarehouse','$product_details.maxPerUnit','/view/:id','product_name','<html><head><title></title>','2zjbeAp','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','</h5>','$product.product_name','<tbody\x20style=\x22text-align:\x20center;\x22>','rack','unit','storage','sendMail','split','floorlevel','$warehouse_name','6243QPcOgL','English','/adjustment/preview/','isAllowEdit','toString','$finalize','$product_details.product_code','add_adjustment','body','batch_code','Secondary_units','port','all','adjustment\x20Finalized\x20successfully','/picking_list/PDF_adjustment_rm/','map','Return\x20Goods','findOne','product_code','15973287QEWlTb','$product_details.secondary_code','json','$product_details.expiry_date','catch','/preview/:id','True','<span\x20style=\x22float:\x20right;\x22>','staff','invoice','filter','</thead>','$date','7RNsrRQ','random','New_Qty_Converted','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Floor','adjustment\x20data\x20update\x20successfully','padStart','$product_details.maxProducts','English\x20(US)','Enclosed','expiry_date','$product_details.level','prod_code','room_names','Adjustment\x20Mail','$product_details.pallet','</div>','Shelves','$product_details.floorlevel','maxperunit','role','$room','<table\x20style=\x22width:\x20100%\x20!important;\x22>','render','</body></html>','$product_details._id','$product_details.product_name','then','get','RMSEmail','</span>','level','<strong>\x20Regards\x20</strong>','nodemailer','types','$product_details.bay','length','flash','Spanish','Hindi','Portuguese','master','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','aggregate','post','$isAllowEdit','<hr\x20class=\x22my-3\x22>','</td>','success','express','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','foreach\x20newproduct','note','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','slice','_id','error','id_transaction','Arabic\x20(ae)','floor','stockBefore','adjust_qty','<div>','1916HRNWiD','$product_details.invoice','$_id','409572irwvid','product','createTransport','<tr>','Return\x20Rooms','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.type','<!DOCTYPE\x20html>','4850024BNbGMm','$product_details.storage','ADJ-','$invoice','prime1','second1','$product.room_names','Primary_Units','type','bay','/../public','</table>','forEach','</head><body>','An\x20error\x20occurred.','prod_cat','bin','prod_invoice','Portuguese\x20(BR)','$product_details.bin','French','find','10YGYlFW','$product_details.rack','language','params','6321555SeVXnv','Chinese','room','warehouse','secondary_unit','$product_details.product_stock','site_title','\x20Order\x20Number\x20:\x20','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','log','Arabic','date','findById','$product_details.batch_code','max_per_unit','user','message','/adjustment/view'];a0_0x595b=function(){return _0x168fdd;};return a0_0x595b();}