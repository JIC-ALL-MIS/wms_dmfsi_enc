var a0_0x3ed064=a0_0xdbdb;(function(_0x3702eb,_0x57051c){var _0x2ec07b=a0_0xdbdb,_0x4ac0db=_0x3702eb();while(!![]){try{var _0x1ca850=-parseInt(_0x2ec07b(0x22e))/0x1+parseInt(_0x2ec07b(0x254))/0x2*(parseInt(_0x2ec07b(0x1bf))/0x3)+parseInt(_0x2ec07b(0x283))/0x4*(-parseInt(_0x2ec07b(0x24b))/0x5)+parseInt(_0x2ec07b(0x1e1))/0x6+-parseInt(_0x2ec07b(0x219))/0x7*(-parseInt(_0x2ec07b(0x262))/0x8)+-parseInt(_0x2ec07b(0x24d))/0x9*(parseInt(_0x2ec07b(0x1c1))/0xa)+parseInt(_0x2ec07b(0x25a))/0xb;if(_0x1ca850===_0x57051c)break;else _0x4ac0db['push'](_0x4ac0db['shift']());}catch(_0x2fa592){_0x4ac0db['push'](_0x4ac0db['shift']());}}}(a0_0x21ac,0xd204b));function a0_0xdbdb(_0x581260,_0x2b1955){var _0x21ac22=a0_0x21ac();return a0_0xdbdb=function(_0xdbdb2d,_0x57c02f){_0xdbdb2d=_0xdbdb2d-0x1be;var _0x3e8ca9=_0x21ac22[_0xdbdb2d];return _0x3e8ca9;},a0_0xdbdb(_0x581260,_0x2b1955);}function a0_0x21ac(){var _0x2d9ccb=['/view/:id','$product','$product_details.floorlevel','RMSEmail','floorlevel','918078bTQzLv','max_per_unit','\x20Order\x20Date\x20:\x20','Arabic\x20(ae)','</head><body>','</div>','prod_code','bin','success','$product_details.maxProducts','batch_code','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','map','<h2>\x20','findOne','<span\x20style=\x22float:\x20right;\x22>','add_adjustment','get','$product_details.primary_code','\x20<>\x20','True','logo','save','site_title','$date','/upload/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.batch_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','primary_code','$product_details.level','Portuguese\x20(BR)','types','adjustment\x20add\x20successfull','slice','length','invoice','secondary_unit','product_name','nodemailer','adjustment\x20Finalized\x20successfully','$product_details.secondary_code','</tr>','$product_details.production_date','New_Qty_Converted','storage','<!DOCTYPE\x20html>','$product_details.secondary_unit','</thead>','</h5>','Secondary_units','redirect','Hindi','isAllowEdit','7nqcYxy','_id','log','<tr>','Spanish','$product_details.unit','<html><head><title></title>','language','product_code','</table>','/view/add_adjustment','id_transaction_from','error','aggregate','<h5\x20style=\x22text-align:\x20left;\x22>','second1','/barcode_scanner','stock','push','/CheckingWarehouse','toString','1547068CHuGdv','$product_details.rack','Enabled','minus','prod_cat','<div>','Rooms','exports','string','$product_details.bay','secondary_code','image','Return\x20Goods','$finalize','$name','Ambient','user','$product_details.product_stock','Arabic','type','</tbody>','Level','$product_details.expiry_date','$product_details.bin','edit_adjustment_view','warehouse_name','id_transaction','prod_name','/adjustment/view','67655YmYOPP','<strong>\x20Regards\x20</strong>','413460XYytIu','json','Raw\x20Materials','product','staff','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$isAllowEdit','6ATGWWD','adjustment\x20data\x20update\x20successfully','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.product_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','24659382ZfaQxA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','status','ADJ-','foreach\x20newproduct','expiry_date','<h5>','finalize','9249848fpdVij','</body></html>','all','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','date','Router','find','render','prime1','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','\x20Order\x20Number\x20:\x20','message','German','$product_details._id','port','warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','English','There\x27s\x20a\x20error\x20in\x20this\x20transaction','role','$product_details.product_name','email','$warehouse_name','back','$product.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.product_cat','rack','/adjustment/preview/','$product.room_names','Floor','Shelves','English\x20(US)','300IrwINj','room_names','then','Primary_Units','bay','maxperunit','../middleware/auth','random','adjust_qty','flash','New_Qty_Converted_adj','errors','/../public','stockBefore','findById','1019622JnHUlt','Receiving\x20Area','250xjLQEs','new_adjust_qty','catch','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<tbody\x20style=\x22text-align:\x20center;\x22>','/preview/:id','unit','$product_details.type','production_date','product_stock','host','body','level','post','French','forEach','$room','params','prod_invoice','</td>','Portuguese','adjustment','$product_details','master','$product_details.storage','$product_details.maxPerUnit'];a0_0x21ac=function(){return _0x2d9ccb;};return a0_0x21ac();}const express=require('express'),app=express(),router=express[a0_0x3ed064(0x267)](),auth=require(a0_0x3ed064(0x289)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x3ed064(0x20a));router[a0_0x3ed064(0x1f4)]('/view',auth,async(_0x53f4e4,_0x3f95ca)=>{var _0x255302=a0_0x3ed064;try{const {username:_0x1a638c,email:_0x2c31bc,role:_0x531473}=_0x53f4e4[_0x255302(0x23e)],_0x52a4fd=_0x53f4e4[_0x255302(0x23e)],_0x24ef88=await profile['findOne']({'email':_0x52a4fd['email']}),_0x20f008=await master_shop[_0x255302(0x268)]();console[_0x255302(0x21b)](_0x255302(0x1d9),_0x20f008);let _0x4a1815;if(_0x52a4fd[_0x255302(0x275)]==_0x255302(0x251)){const _0x43f92c=await staff[_0x255302(0x1f1)]({'email':_0x52a4fd[_0x255302(0x277)]});_0x4a1815=await warehouse[_0x255302(0x268)]({'status':_0x255302(0x230),'name':_0x43f92c['warehouse']});}else _0x4a1815=await warehouse[_0x255302(0x268)]({'status':_0x255302(0x230)});const _0xeeecbf=await product[_0x255302(0x268)]();let _0x15b032;if(_0x52a4fd[_0x255302(0x275)]=='staff'){const _0x3f9de6=await staff['findOne']({'email':_0x52a4fd['email']});_0x15b032=await adjustment['find']({'warehouse_name':_0x3f9de6['warehouse']});}else _0x15b032=await adjustment[_0x255302(0x226)]([{'$unwind':_0x255302(0x1dd)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x255302(0x1fb)},'warehouse_name':{'$first':_0x255302(0x278)},'room':{'$addToSet':_0x255302(0x27f)},'finalize':{'$first':_0x255302(0x23b)},'isAllowEdit':{'$first':_0x255302(0x253)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x20f008[0x0][_0x255302(0x220)]==_0x255302(0x282)){var _0x28993d=users[_0x255302(0x273)];console[_0x255302(0x21b)](_0x28993d);}else{if(_0x20f008[0x0]['language']=='Hindi')var _0x28993d=users[_0x255302(0x217)];else{if(_0x20f008[0x0][_0x255302(0x220)]=='German')var _0x28993d=users[_0x255302(0x26e)];else{if(_0x20f008[0x0][_0x255302(0x220)]==_0x255302(0x21d))var _0x28993d=users[_0x255302(0x21d)];else{if(_0x20f008[0x0][_0x255302(0x220)]==_0x255302(0x1d0))var _0x28993d=users[_0x255302(0x1d0)];else{if(_0x20f008[0x0]['language']==_0x255302(0x202))var _0x28993d=users[_0x255302(0x1d6)];else{if(_0x20f008[0x0][_0x255302(0x220)]==_0x255302(0x1c4))var _0x28993d=users[_0x255302(0x1c4)];else{if(_0x20f008[0x0][_0x255302(0x220)]=='Arabic\x20(ae)')var _0x28993d=users[_0x255302(0x240)];}}}}}}}_0x3f95ca['render'](_0x255302(0x1d7),{'success':_0x53f4e4[_0x255302(0x28c)](_0x255302(0x1e9)),'errors':_0x53f4e4[_0x255302(0x28c)](_0x255302(0x28e)),'role':_0x52a4fd,'profile':_0x24ef88,'warehouse':_0x4a1815,'product':_0xeeecbf,'adjustment':_0x15b032,'master_shop':_0x20f008,'language':_0x28993d});}catch(_0x25bcad){console[_0x255302(0x21b)](_0x25bcad);}});async function getRandom8DigitNumber(){var _0x3355fc=a0_0x3ed064;const _0x27b220=0x989680,_0x1a6e3a=0x5f5e0ff,_0xf87418=Math['floor'](Math[_0x3355fc(0x28a)]()*(_0x1a6e3a-_0x27b220+0x1))+_0x27b220;var _0x19ed90;const _0x33158c=await adjustment['findOne']({'invoice':'ADJ-'+_0xf87418});return _0x33158c&&_0x33158c[_0x3355fc(0x206)]>0x0?_0x19ed90=_0x3355fc(0x25d)+_0xf87418:_0x19ed90='ADJ-'+_0xf87418,_0x19ed90;}router[a0_0x3ed064(0x1f4)](a0_0x3ed064(0x223),auth,async(_0x14a0fe,_0x492bf9)=>{var _0x24b2f9=a0_0x3ed064;try{const {username:_0x38bd8a,email:_0x1b4863,role:_0x5d865c}=_0x14a0fe[_0x24b2f9(0x23e)],_0x511de1=_0x14a0fe['user'],_0x3cb51d=await profile[_0x24b2f9(0x1f1)]({'email':_0x511de1[_0x24b2f9(0x277)]}),_0x141ebc=await master_shop[_0x24b2f9(0x268)]();let _0x53514a;if(_0x511de1[_0x24b2f9(0x275)]==_0x24b2f9(0x251)){const _0x45af03=await staff[_0x24b2f9(0x1f1)]({'email':_0x511de1[_0x24b2f9(0x277)]});_0x53514a=await warehouse[_0x24b2f9(0x226)]([{'$match':{'status':_0x24b2f9(0x230),'name':_0x45af03[_0x24b2f9(0x271)],'warehouse_category':_0x24b2f9(0x24f),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x24b2f9(0x23c),'name':{'$first':_0x24b2f9(0x23c)}}}]);}else _0x53514a=await warehouse[_0x24b2f9(0x226)]([{'$match':{'status':_0x24b2f9(0x230),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x24b2f9(0x23a)}}},{'$group':{'_id':_0x24b2f9(0x23c),'name':{'$first':'$name'}}}]);const _0x11cf04=await product[_0x24b2f9(0x268)]({}),_0x50e406=await adjustment[_0x24b2f9(0x268)]({}),_0x354057=_0x50e406[_0x24b2f9(0x206)]+0x1,_0x41cb2a=_0x24b2f9(0x25d)+_0x354057[_0x24b2f9(0x22d)]()['padStart'](0x5,'0');var _0xbb7515=[_0x24b2f9(0x23d),'Enclosed','Return\x20Rooms'];if(_0x141ebc[0x0][_0x24b2f9(0x220)]==_0x24b2f9(0x282))var _0x21c421=users[_0x24b2f9(0x273)];else{if(_0x141ebc[0x0][_0x24b2f9(0x220)]=='Hindi')var _0x21c421=users[_0x24b2f9(0x217)];else{if(_0x141ebc[0x0]['language']==_0x24b2f9(0x26e))var _0x21c421=users[_0x24b2f9(0x26e)];else{if(_0x141ebc[0x0]['language']==_0x24b2f9(0x21d))var _0x21c421=users['Spanish'];else{if(_0x141ebc[0x0][_0x24b2f9(0x220)]=='French')var _0x21c421=users[_0x24b2f9(0x1d0)];else{if(_0x141ebc[0x0][_0x24b2f9(0x220)]=='Portuguese\x20(BR)')var _0x21c421=users[_0x24b2f9(0x1d6)];else{if(_0x141ebc[0x0][_0x24b2f9(0x220)]==_0x24b2f9(0x1c4))var _0x21c421=users[_0x24b2f9(0x1c4)];else{if(_0x141ebc[0x0][_0x24b2f9(0x220)]==_0x24b2f9(0x1e4))var _0x21c421=users['Arabic'];}}}}}}}const _0x2780d8=getRandom8DigitNumber();_0x2780d8[_0x24b2f9(0x285)](_0x32b176=>{var _0xb964fc=_0x24b2f9;_0x492bf9[_0xb964fc(0x269)](_0xb964fc(0x1f3),{'success':_0x14a0fe[_0xb964fc(0x28c)](_0xb964fc(0x1e9)),'errors':_0x14a0fe[_0xb964fc(0x28c)](_0xb964fc(0x28e)),'role':_0x511de1,'profile':_0x3cb51d,'warehouse':_0x53514a,'product':_0x11cf04,'master_shop':_0x141ebc,'language':_0x21c421,'rooms_data':_0xbb7515,'invoice_no':_0x32b176});})[_0x24b2f9(0x1c3)](_0xe3dac0=>{var _0x50b855=_0x24b2f9;_0x14a0fe['flash']('errors',_0x50b855(0x274)),_0x492bf9['redirect'](_0x50b855(0x24a));});}catch(_0x2d7a06){console['log'](_0x2d7a06);}}),router[a0_0x3ed064(0x1cf)](a0_0x3ed064(0x223),auth,async(_0x4c8c6e,_0x143e57)=>{var _0x4c66e5=a0_0x3ed064;try{const {warehouse_name:_0x2aaaef,date:_0x521f25,prod_name:_0x215105,level:_0x4b3c82,isle:_0xc015a5,pallet:_0x395cce,stock:_0x3be3a6,types:_0x478737,adjust_qty:_0x4ed87f,new_adjust_qty:_0x2e5a96,note:_0x71780c,Room_name:_0x183a5b,invoice:_0x43425a,JO_number:_0x1e2848,expiry_date:_0x186376}=_0x4c8c6e[_0x4c66e5(0x1cd)];if(typeof _0x215105==_0x4c66e5(0x236))var _0x3e825f=[_0x4c8c6e['body'][_0x4c66e5(0x249)]],_0x2ec8dd=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x1ce)]],_0x5a9f8c=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x22a)]],_0x594107=[_0x4c8c6e['body'][_0x4c66e5(0x203)]],_0x5ce27d=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x28d)]],_0x27588e=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x20f)]],_0x181dab=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x286)]],_0x42857e=[_0x4c8c6e['body'][_0x4c66e5(0x215)]],_0xd19562=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x1e7)]],_0xe8d10a=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x1eb)]],_0x204947=[_0x4c8c6e['body'][_0x4c66e5(0x25f)]],_0x46ee71=[_0x4c8c6e[_0x4c66e5(0x1cd)]['max_per_unit']],_0x3281bd=[_0x4c8c6e[_0x4c66e5(0x1cd)]['production_date']],_0x1e97ed=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x232)]],_0x3177f5=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x234)]],_0x436e74=[_0x4c8c6e[_0x4c66e5(0x1cd)]['prime1']],_0x44ab70=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x228)]],_0x2c5bf8=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x1d4)]],_0x184127=[_0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x248)]];else var _0x3e825f=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x249)]],_0x2ec8dd=[..._0x4c8c6e['body'][_0x4c66e5(0x1ce)]],_0x5a9f8c=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x22a)]],_0x594107=[..._0x4c8c6e[_0x4c66e5(0x1cd)]['types']],_0x5ce27d=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x28d)]],_0x27588e=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x20f)]],_0x181dab=[..._0x4c8c6e[_0x4c66e5(0x1cd)]['unit']],_0x42857e=[..._0x4c8c6e[_0x4c66e5(0x1cd)]['Secondary_units']],_0xd19562=[..._0x4c8c6e[_0x4c66e5(0x1cd)]['prod_code']],_0xe8d10a=[..._0x4c8c6e['body'][_0x4c66e5(0x1eb)]],_0x204947=[..._0x4c8c6e['body'][_0x4c66e5(0x25f)]],_0x46ee71=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x1e2)]],_0x3281bd=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x1ca)]],_0x1e97ed=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x232)]],_0x3177f5=[..._0x4c8c6e['body'][_0x4c66e5(0x234)]],_0x436e74=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x26a)]],_0x44ab70=[..._0x4c8c6e[_0x4c66e5(0x1cd)][_0x4c66e5(0x228)]],_0x2c5bf8=[..._0x4c8c6e['body'][_0x4c66e5(0x1d4)]],_0x184127=[..._0x4c8c6e['body'][_0x4c66e5(0x248)]];const _0x1d2d0=_0x3e825f[_0x4c66e5(0x1ef)](_0x128b69=>{return _0x128b69={'product_name':_0x128b69};});_0x2ec8dd[_0x4c66e5(0x1d1)]((_0x1e9310,_0x555cbe)=>{var _0x64a473=_0x4c66e5;_0x3177f5[_0x64a473(0x1d1)]((_0x2b304f,_0x379290)=>{var _0x585b0a=_0x64a473;if(_0x2b304f==_0x585b0a(0x1c0)&&_0x555cbe==_0x379290){var _0x4a6718=_0x1e9310['slice'](0x3);_0x1d2d0[_0x555cbe]['storage']=_0x1e9310[0x0],_0x1d2d0[_0x555cbe][_0x585b0a(0x27d)]=_0x1e9310[0x1],_0x1d2d0[_0x555cbe][_0x585b0a(0x287)]=0x0,_0x1d2d0[_0x555cbe]['bin']=0x0,_0x1d2d0[_0x555cbe][_0x585b0a(0x241)]=_0x585b0a(0x280),_0x1d2d0[_0x555cbe][_0x585b0a(0x1e0)]=_0x4a6718;}else{if(_0x2b304f==_0x585b0a(0x281)&&_0x555cbe==_0x379290){var _0x4a6718=_0x1e9310[_0x585b0a(0x205)](0x3);_0x1d2d0[_0x555cbe]['storage']=_0x1e9310[0x0],_0x1d2d0[_0x555cbe]['rack']=_0x1e9310[0x1],_0x1d2d0[_0x555cbe][_0x585b0a(0x287)]=0x0,_0x1d2d0[_0x555cbe][_0x585b0a(0x1e8)]=0x0,_0x1d2d0[_0x555cbe][_0x585b0a(0x241)]='Floor',_0x1d2d0[_0x555cbe][_0x585b0a(0x1e0)]=_0x1e9310[0x5];}else{if(_0x555cbe==_0x379290){var _0x17e145;if(_0x1e9310[0x4]=='L')_0x17e145=_0x585b0a(0x243);else _0x1e9310[0x4]=='F'&&(_0x17e145='Floor');_0x1d2d0[_0x555cbe]['storage']=_0x1e9310[0x0],_0x1d2d0[_0x555cbe][_0x585b0a(0x27d)]=_0x1e9310[0x1],_0x1d2d0[_0x555cbe][_0x585b0a(0x287)]=_0x1e9310[0x2],_0x1d2d0[_0x555cbe][_0x585b0a(0x1e8)]=_0x1e9310[0x3],_0x1d2d0[_0x555cbe][_0x585b0a(0x241)]=_0x17e145,_0x1d2d0[_0x555cbe][_0x585b0a(0x1e0)]=_0x1e9310[0x5];}}}});}),_0x5a9f8c[_0x4c66e5(0x1d1)]((_0x244fa0,_0x1e91d2)=>{var _0x27a436=_0x4c66e5;_0x1d2d0[_0x1e91d2][_0x27a436(0x290)]=_0x244fa0;}),_0x184127[_0x4c66e5(0x1d1)]((_0x2bfd77,_0x259e5a)=>{var _0x57ee1a=_0x4c66e5;_0x1d2d0[_0x259e5a][_0x57ee1a(0x224)]=_0x2bfd77;}),_0x594107[_0x4c66e5(0x1d1)]((_0x2980e7,_0x2445ff)=>{var _0x43d0ba=_0x4c66e5;_0x1d2d0[_0x2445ff][_0x43d0ba(0x203)]=_0x2980e7;}),_0x5ce27d['forEach']((_0x3243b2,_0x490fd8)=>{var _0x3d00c4=_0x4c66e5;_0x1d2d0[_0x490fd8][_0x3d00c4(0x28b)]=_0x3243b2;}),_0x27588e[_0x4c66e5(0x1d1)]((_0x1d883d,_0x58ea61)=>{var _0x1d4a92=_0x4c66e5;_0x1d2d0[_0x58ea61][_0x1d4a92(0x1c2)]=_0x1d883d;}),_0x181dab[_0x4c66e5(0x1d1)]((_0x3e8024,_0x5d2da9)=>{var _0x1ab978=_0x4c66e5;_0x1d2d0[_0x5d2da9][_0x1ab978(0x1c8)]=_0x3e8024;}),_0x42857e[_0x4c66e5(0x1d1)]((_0x1604c5,_0x3fc0fa)=>{_0x1d2d0[_0x3fc0fa]['secondary_unit']=_0x1604c5;}),_0xd19562['forEach']((_0x345d26,_0x5a29e1)=>{var _0xcb447=_0x4c66e5;_0x1d2d0[_0x5a29e1][_0xcb447(0x221)]=_0x345d26;}),_0xe8d10a['forEach']((_0x5c4325,_0x5a10e7)=>{var _0x26a183=_0x4c66e5;_0x1d2d0[_0x5a10e7][_0x26a183(0x1eb)]=_0x5c4325;}),_0x204947[_0x4c66e5(0x1d1)]((_0x73452,_0x14341a)=>{var _0x3afaf3=_0x4c66e5;_0x1d2d0[_0x14341a][_0x3afaf3(0x25f)]=_0x73452;}),_0x46ee71['forEach']((_0xce2801,_0x334ce9)=>{var _0x4d9f65=_0x4c66e5;_0x1d2d0[_0x334ce9][_0x4d9f65(0x288)]=_0xce2801;}),_0x3281bd[_0x4c66e5(0x1d1)]((_0x1dc103,_0x18353d)=>{var _0x451303=_0x4c66e5;_0x1d2d0[_0x18353d][_0x451303(0x1ca)]=_0x1dc103;}),_0x1e97ed[_0x4c66e5(0x1d1)]((_0x4d3db0,_0x85632b)=>{var _0x7b9887=_0x4c66e5;_0x1d2d0[_0x85632b][_0x7b9887(0x232)]=_0x4d3db0;}),_0x3177f5[_0x4c66e5(0x1d1)]((_0x101c57,_0x20d7d1)=>{var _0x2773c4=_0x4c66e5;_0x1d2d0[_0x20d7d1][_0x2773c4(0x284)]=_0x101c57;}),_0x436e74[_0x4c66e5(0x1d1)]((_0xc4f99f,_0x4dd110)=>{var _0x34ef89=_0x4c66e5;_0x1d2d0[_0x4dd110][_0x34ef89(0x200)]=_0xc4f99f;}),_0x44ab70[_0x4c66e5(0x1d1)]((_0x39f0a4,_0x2971d6)=>{var _0x1e8ddc=_0x4c66e5;_0x1d2d0[_0x2971d6][_0x1e8ddc(0x238)]=_0x39f0a4;}),_0x2c5bf8[_0x4c66e5(0x1d1)]((_0x4be7c,_0x343142)=>{var _0x1ad19e=_0x4c66e5;_0x1d2d0[_0x343142][_0x1ad19e(0x207)]=_0x4be7c;});const _0x5bf8fc=_0x1d2d0['filter'](_0xc1f7bf=>_0xc1f7bf[_0x4c66e5(0x28b)]!=='0'&&_0xc1f7bf[_0x4c66e5(0x28b)]!=='');var _0x5d694c=0x0;_0x5bf8fc[_0x4c66e5(0x1d1)](_0x5588a1=>{var _0x55926f=_0x4c66e5;console['log'](_0x55926f(0x25e),_0x5588a1),parseInt(_0x5588a1['adjust_qty'])<=0x0&&_0x5d694c++;});if(_0x5d694c!=0x0)return _0x4c8c6e[_0x4c66e5(0x28c)](_0x4c66e5(0x28e),_0x4c66e5(0x252)),_0x143e57[_0x4c66e5(0x216)](_0x4c66e5(0x279));const _0x4d37f6=new adjustment({'warehouse_name':_0x2aaaef,'date':_0x521f25,'product':_0x5bf8fc,'note':_0x71780c,'room':_0x183a5b,'invoice':_0x43425a,'JO_number':_0x1e2848,'expiry_date':_0x186376}),_0x517a87=await _0x4d37f6[_0x4c66e5(0x1f9)]();_0x4c8c6e[_0x4c66e5(0x28c)](_0x4c66e5(0x1e9),_0x4c66e5(0x204)),_0x143e57[_0x4c66e5(0x216)](_0x4c66e5(0x27e)+_0x517a87[_0x4c66e5(0x21a)]);}catch(_0x3b5528){console[_0x4c66e5(0x21b)](_0x3b5528),_0x143e57[_0x4c66e5(0x25c)](0xc8)['json']({'message':_0x3b5528[_0x4c66e5(0x26d)]});}}),router[a0_0x3ed064(0x1f4)](a0_0x3ed064(0x1c7),auth,async(_0x480fdc,_0x24a61c)=>{var _0x1dbc2d=a0_0x3ed064;try{const {username:_0x3df73f,email:_0x43a148,role:_0x1e9bca}=_0x480fdc[_0x1dbc2d(0x23e)],_0x35216a=_0x480fdc[_0x1dbc2d(0x23e)],_0x3d1ead=await profile[_0x1dbc2d(0x1f1)]({'email':_0x35216a['email']}),_0x3de81d=await master_shop[_0x1dbc2d(0x268)](),_0x5cd003=_0x480fdc[_0x1dbc2d(0x1d3)]['id'],_0x454223=await adjustment[_0x1dbc2d(0x1be)]({'_id':_0x5cd003}),_0x2d8a34=await purchases[_0x1dbc2d(0x226)]([{'$match':{'warehouse_name':_0x454223[_0x1dbc2d(0x247)]}},{'$unwind':'$product'},{'$group':{'_id':_0x1dbc2d(0x27a)}}]),_0x55eecf=await product[_0x1dbc2d(0x268)]({}),_0xad317c=await warehouse['aggregate']([{'$match':{'name':_0x454223[_0x1dbc2d(0x247)]}},{'$unwind':_0x1dbc2d(0x1d8)},{'$group':{'_id':_0x1dbc2d(0x26f),'name':{'$first':_0x1dbc2d(0x276)},'product_stock':{'$first':_0x1dbc2d(0x23f)},'bay':{'$first':_0x1dbc2d(0x237)},'bin':{'$first':_0x1dbc2d(0x245)},'type':{'$first':_0x1dbc2d(0x1c9)},'floorlevel':{'$first':_0x1dbc2d(0x1de)},'primary_code':{'$first':_0x1dbc2d(0x1f5)},'secondary_code':{'$first':_0x1dbc2d(0x20c)},'product_code':{'$first':_0x1dbc2d(0x258)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1dbc2d(0x22f)},'maxPerUnit':{'$first':_0x1dbc2d(0x1db)},'expiry_date':{'$first':_0x1dbc2d(0x244)},'production_date':{'$first':_0x1dbc2d(0x20e)},'batch_code':{'$first':_0x1dbc2d(0x1fe)},'room':{'$first':_0x1dbc2d(0x1d2)}}}]);if(_0x3de81d[0x0]['language']==_0x1dbc2d(0x282)){var _0x3fa84c=users[_0x1dbc2d(0x273)];console['log'](_0x3fa84c);}else{if(_0x3de81d[0x0][_0x1dbc2d(0x220)]=='Hindi')var _0x3fa84c=users[_0x1dbc2d(0x217)];else{if(_0x3de81d[0x0][_0x1dbc2d(0x220)]==_0x1dbc2d(0x26e))var _0x3fa84c=users[_0x1dbc2d(0x26e)];else{if(_0x3de81d[0x0][_0x1dbc2d(0x220)]==_0x1dbc2d(0x21d))var _0x3fa84c=users[_0x1dbc2d(0x21d)];else{if(_0x3de81d[0x0][_0x1dbc2d(0x220)]==_0x1dbc2d(0x1d0))var _0x3fa84c=users[_0x1dbc2d(0x1d0)];else{if(_0x3de81d[0x0]['language']==_0x1dbc2d(0x202))var _0x3fa84c=users[_0x1dbc2d(0x1d6)];else{if(_0x3de81d[0x0][_0x1dbc2d(0x220)]==_0x1dbc2d(0x1c4))var _0x3fa84c=users[_0x1dbc2d(0x1c4)];else{if(_0x3de81d[0x0][_0x1dbc2d(0x220)]==_0x1dbc2d(0x1e4))var _0x3fa84c=users[_0x1dbc2d(0x240)];}}}}}}}_0x24a61c[_0x1dbc2d(0x269)](_0x1dbc2d(0x246),{'success':_0x480fdc[_0x1dbc2d(0x28c)](_0x1dbc2d(0x1e9)),'errors':_0x480fdc[_0x1dbc2d(0x28c)](_0x1dbc2d(0x28e)),'role':_0x35216a,'profile':_0x3d1ead,'adjustment':_0x454223,'stock':_0xad317c,'master_shop':_0x3de81d,'warehouse_name':_0x2d8a34,'unit':_0x55eecf,'language':_0x3fa84c});}catch(_0x26c54b){console[_0x1dbc2d(0x21b)](_0x26c54b),_0x24a61c[_0x1dbc2d(0x25c)](0xc8)[_0x1dbc2d(0x24e)]({'message':_0x26c54b['message']});}}),router[a0_0x3ed064(0x1cf)](a0_0x3ed064(0x1c7),auth,async(_0x176961,_0x41e71e)=>{var _0x32717c=a0_0x3ed064;try{const _0x2ac3d2=_0x176961[_0x32717c(0x1d3)]['id'],{warehouse_name:_0x437abd,Room_name:_0x4ce326}=_0x176961[_0x32717c(0x1cd)],_0x50bf83=await adjustment['findById']({'_id':_0x2ac3d2}),_0x3c0227=_0x50bf83[_0x32717c(0x250)][_0x32717c(0x1ef)](async _0xe74010=>{var _0x482f9d=_0x32717c;if(_0xe74010[_0x482f9d(0x28b)]>0x0){var _0x4fd3c5=await warehouse['findOne']({'name':_0x437abd,'room':_0xe74010[_0x482f9d(0x284)],'warehouse_category':_0x482f9d(0x24f)});const _0x570c9d=_0x4fd3c5[_0x482f9d(0x256)][_0x482f9d(0x1ef)](_0x50f7af=>{var _0x3a2e06=_0x482f9d;console['log'](_0xe74010['types']+_0x3a2e06(0x1f6));if(_0xe74010[_0x3a2e06(0x203)]==_0x3a2e06(0x231)){if(_0x50f7af['product_name']==_0xe74010[_0x3a2e06(0x209)]&&_0x50f7af['floorlevel']==_0xe74010[_0x3a2e06(0x1e0)]&&_0x50f7af[_0x3a2e06(0x241)]==_0xe74010[_0x3a2e06(0x241)]&&_0x50f7af[_0x3a2e06(0x1e8)]==_0xe74010[_0x3a2e06(0x1e8)]&&_0x50f7af[_0x3a2e06(0x287)]==_0xe74010[_0x3a2e06(0x287)]&&_0x50f7af['rack']==_0xe74010[_0x3a2e06(0x27d)]&&_0x50f7af[_0x3a2e06(0x210)]==_0xe74010[_0x3a2e06(0x210)]&&_0x50f7af['expiry_date']==_0xe74010['expiry_date']&&_0x50f7af[_0x3a2e06(0x1eb)]==_0xe74010['batch_code']&&_0x50f7af[_0x3a2e06(0x1ca)]==_0xe74010[_0x3a2e06(0x1ca)]&&_0x50f7af['invoice']==_0xe74010[_0x3a2e06(0x207)]&&_0x50f7af[_0x3a2e06(0x21a)]==_0xe74010[_0x3a2e06(0x224)]){var _0x38c0e3;_0x38c0e3=_0xe74010[_0x3a2e06(0x28b)],_0xe74010['prod_cat']=='S'&&(_0x38c0e3=_0xe74010['adjust_qty']),_0x50f7af[_0x3a2e06(0x1cb)]=_0x50f7af['product_stock']-_0x38c0e3;}}else{if(_0x50f7af[_0x3a2e06(0x209)]==_0xe74010[_0x3a2e06(0x209)]&&_0x50f7af[_0x3a2e06(0x1e0)]==_0xe74010['floorlevel']&&_0x50f7af[_0x3a2e06(0x241)]==_0xe74010[_0x3a2e06(0x241)]&&_0x50f7af[_0x3a2e06(0x1e8)]==_0xe74010[_0x3a2e06(0x1e8)]&&_0x50f7af['bay']==_0xe74010[_0x3a2e06(0x287)]&&_0x50f7af['rack']==_0xe74010[_0x3a2e06(0x27d)]&&_0x50f7af[_0x3a2e06(0x210)]==_0xe74010[_0x3a2e06(0x210)]&&_0x50f7af[_0x3a2e06(0x25f)]==_0xe74010[_0x3a2e06(0x25f)]&&_0x50f7af['batch_code']==_0xe74010['batch_code']&&_0x50f7af['production_date']==_0xe74010[_0x3a2e06(0x1ca)]&&_0x50f7af[_0x3a2e06(0x207)]==_0xe74010[_0x3a2e06(0x207)]&&_0x50f7af['_id']==_0xe74010[_0x3a2e06(0x224)]){console[_0x3a2e06(0x21b)](_0xe74010);var _0x38c0e3;_0x38c0e3=_0xe74010[_0x3a2e06(0x28b)],_0xe74010[_0x3a2e06(0x232)]=='S'&&(_0x38c0e3=_0xe74010[_0x3a2e06(0x28b)]),_0x50f7af[_0x3a2e06(0x1cb)]=_0x50f7af[_0x3a2e06(0x1cb)]+_0x38c0e3;}}});}return _0x4fd3c5;});Promise['all'](_0x3c0227)[_0x32717c(0x285)](async _0x1ecf22=>{var _0x22ca60=_0x32717c;try{for(const _0x17aa64 of _0x1ecf22){await _0x17aa64[_0x22ca60(0x1f9)]();}_0x50bf83[_0x22ca60(0x261)]=_0x22ca60(0x1f7);const _0x16bb17=await _0x50bf83[_0x22ca60(0x1f9)](),_0x5c42a5=await master_shop[_0x22ca60(0x268)](),_0x1161a6=await email_settings[_0x22ca60(0x1f1)](),_0x39efb7=await supervisor_settings['find']();var _0x4e75ea=_0x50bf83['product'],_0x4c644e='',_0x43f3e3;for(_0x43f3e3 in _0x4e75ea){_0x4c644e+=_0x22ca60(0x21c)+_0x22ca60(0x26b)+_0x4e75ea[_0x43f3e3][_0x22ca60(0x209)]+'</td>'+_0x22ca60(0x26b)+_0x4e75ea[_0x43f3e3][_0x22ca60(0x221)]+_0x22ca60(0x1d5)+_0x22ca60(0x26b)+_0x4e75ea[_0x43f3e3][_0x22ca60(0x28b)]+'</td>'+_0x22ca60(0x26b)+_0x4e75ea[_0x43f3e3][_0x22ca60(0x1c8)]+_0x22ca60(0x1d5)+_0x22ca60(0x26b)+_0x4e75ea[_0x43f3e3][_0x22ca60(0x208)]+_0x22ca60(0x1d5)+_0x22ca60(0x26b)+_0x50bf83['warehouse_name']+_0x22ca60(0x1d5)+_0x22ca60(0x26b)+_0x4e75ea[_0x43f3e3][_0x22ca60(0x284)]+_0x22ca60(0x1d5)+_0x22ca60(0x26b)+_0x4e75ea[_0x43f3e3][_0x22ca60(0x210)]+_0x4e75ea[_0x43f3e3]['rack']+_0x4e75ea[_0x43f3e3][_0x22ca60(0x287)]+_0x4e75ea[_0x43f3e3][_0x22ca60(0x1e8)]+_0x4e75ea[_0x43f3e3][_0x22ca60(0x241)][0x0]+_0x4e75ea[_0x43f3e3]['floorlevel']+'</td>','</tr>';}let _0x416d28=nodemailer['createTransport']({'host':_0x1161a6[_0x22ca60(0x1cc)],'port':Number(_0x1161a6[_0x22ca60(0x270)]),'secure':![],'auth':{'user':_0x1161a6[_0x22ca60(0x277)],'pass':_0x1161a6['password']}}),_0x16baee={'from':_0x1161a6['email'],'to':_0x39efb7[0x0][_0x22ca60(0x1df)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x22ca60(0x28f)+_0x22ca60(0x1fc)+_0x5c42a5[0x0][_0x22ca60(0x239)],'cid':_0x22ca60(0x1f8)}],'html':_0x22ca60(0x211)+_0x22ca60(0x21f)+_0x22ca60(0x1e5)+_0x22ca60(0x233)+_0x22ca60(0x259)+'<div>'+_0x22ca60(0x1ee)+'</div>'+_0x22ca60(0x233)+_0x22ca60(0x1f0)+_0x5c42a5[0x0][_0x22ca60(0x1fa)]+'\x20</h2>'+_0x22ca60(0x1e6)+_0x22ca60(0x1e6)+'<hr\x20class=\x22my-3\x22>'+_0x22ca60(0x233)+_0x22ca60(0x227)+_0x22ca60(0x26c)+_0x50bf83[_0x22ca60(0x207)]+'\x20'+_0x22ca60(0x1f2)+_0x22ca60(0x1e3)+_0x50bf83[_0x22ca60(0x266)]+'\x20'+'</span>'+_0x22ca60(0x214)+_0x22ca60(0x1e6)+_0x22ca60(0x1ff)+_0x22ca60(0x265)+_0x22ca60(0x21c)+_0x22ca60(0x257)+_0x22ca60(0x1ed)+_0x22ca60(0x1fd)+_0x22ca60(0x27b)+_0x22ca60(0x272)+_0x22ca60(0x25b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x22ca60(0x1c5)+_0x22ca60(0x20d)+_0x22ca60(0x213)+_0x22ca60(0x1c6)+'\x20'+_0x4c644e+'\x20'+_0x22ca60(0x242)+_0x22ca60(0x222)+_0x22ca60(0x233)+_0x22ca60(0x24c)+_0x22ca60(0x260)+_0x5c42a5[0x0][_0x22ca60(0x1fa)]+_0x22ca60(0x214)+'</div>'+_0x22ca60(0x1e6)+_0x22ca60(0x263)};_0x416d28['sendMail'](_0x16baee,function(_0x4c2147,_0x14fe8f){var _0x46d9ac=_0x22ca60;_0x4c2147?(console[_0x46d9ac(0x21b)](_0x4c2147),console[_0x46d9ac(0x21b)]('Error\x20Occurs')):console[_0x46d9ac(0x21b)]('Email\x20sent\x20successfully');}),_0x176961[_0x22ca60(0x28c)](_0x22ca60(0x1e9),_0x22ca60(0x20b)),_0x41e71e[_0x22ca60(0x216)]('/picking_list/PDF_adjustment_rm/'+_0x16bb17[_0x22ca60(0x21a)]);}catch(_0x263175){console[_0x22ca60(0x225)](_0x263175),_0x41e71e[_0x22ca60(0x25c)](0x1f4)[_0x22ca60(0x24e)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x32717c(0x1c3)](_0x27d22c=>{var _0x42a56b=_0x32717c;console[_0x42a56b(0x225)](_0x27d22c),_0x41e71e[_0x42a56b(0x25c)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x2a1ce7){console['log'](_0x2a1ce7),_0x41e71e[_0x32717c(0x25c)](0xc8)[_0x32717c(0x24e)]({'message':_0x2a1ce7['message']});}}),router[a0_0x3ed064(0x1f4)](a0_0x3ed064(0x1dc),auth,async(_0x883cbf,_0xc26dc7)=>{var _0x4561c6=a0_0x3ed064;try{const {username:_0x389d83,email:_0x13b47a,role:_0x13458d}=_0x883cbf[_0x4561c6(0x23e)],_0x3313e8=_0x883cbf[_0x4561c6(0x23e)],_0x3721b2=await profile[_0x4561c6(0x1f1)]({'email':_0x3313e8[_0x4561c6(0x277)]}),_0x2e5c58=await master_shop['find'](),_0x513e03=_0x883cbf[_0x4561c6(0x1d3)]['id'],_0x4ac395=await adjustment['findById']({'_id':_0x513e03}),_0x5c7e5d=await purchases['aggregate']([{'$match':{'warehouse_name':_0x4ac395[_0x4561c6(0x247)]}},{'$unwind':_0x4561c6(0x1dd)},{'$group':{'_id':'$product.product_name'}}]),_0x4709f2=await product[_0x4561c6(0x268)]({}),_0x1f0bb9=await warehouse[_0x4561c6(0x226)]([{'$match':{'name':_0x4ac395[_0x4561c6(0x247)]}},{'$unwind':_0x4561c6(0x1d8)},{'$group':{'_id':_0x4561c6(0x26f),'name':{'$first':_0x4561c6(0x276)},'product_stock':{'$first':_0x4561c6(0x23f)},'bay':{'$first':_0x4561c6(0x237)},'bin':{'$first':_0x4561c6(0x245)},'type':{'$first':_0x4561c6(0x1c9)},'floorlevel':{'$first':_0x4561c6(0x1de)},'primary_code':{'$first':_0x4561c6(0x1f5)},'secondary_code':{'$first':_0x4561c6(0x20c)},'product_code':{'$first':_0x4561c6(0x258)},'storage':{'$first':_0x4561c6(0x1da)},'rack':{'$first':_0x4561c6(0x22f)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x4561c6(0x244)},'production_date':{'$first':_0x4561c6(0x20e)},'batch_code':{'$first':_0x4561c6(0x1fe)},'room':{'$first':_0x4561c6(0x1d2)}}}]);let _0x93cffb;if(_0x3313e8[_0x4561c6(0x275)]=='staff'){const _0x12f272=await staff[_0x4561c6(0x1f1)]({'email':_0x3313e8[_0x4561c6(0x277)]});_0x93cffb=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x12f272[_0x4561c6(0x271)],'warehouse_category':_0x4561c6(0x24f),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x4561c6(0x23c),'name':{'$first':_0x4561c6(0x23c)}}}]);}else _0x93cffb=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x4561c6(0x24f),'name':{'$ne':_0x4561c6(0x23a)}}},{'$group':{'_id':_0x4561c6(0x23c),'name':{'$first':_0x4561c6(0x23c)}}}]);if(_0x2e5c58[0x0][_0x4561c6(0x220)]==_0x4561c6(0x282)){var _0x42d09c=users[_0x4561c6(0x273)];console[_0x4561c6(0x21b)](_0x42d09c);}else{if(_0x2e5c58[0x0][_0x4561c6(0x220)]==_0x4561c6(0x217))var _0x42d09c=users['Hindi'];else{if(_0x2e5c58[0x0]['language']==_0x4561c6(0x26e))var _0x42d09c=users[_0x4561c6(0x26e)];else{if(_0x2e5c58[0x0][_0x4561c6(0x220)]==_0x4561c6(0x21d))var _0x42d09c=users[_0x4561c6(0x21d)];else{if(_0x2e5c58[0x0][_0x4561c6(0x220)]=='French')var _0x42d09c=users[_0x4561c6(0x1d0)];else{if(_0x2e5c58[0x0][_0x4561c6(0x220)]==_0x4561c6(0x202))var _0x42d09c=users['Portuguese'];else{if(_0x2e5c58[0x0][_0x4561c6(0x220)]==_0x4561c6(0x1c4))var _0x42d09c=users['Chinese'];else{if(_0x2e5c58[0x0]['language']==_0x4561c6(0x1e4))var _0x42d09c=users['Arabic'];}}}}}}}_0xc26dc7[_0x4561c6(0x269)]('edit_adjustment',{'success':_0x883cbf[_0x4561c6(0x28c)]('success'),'errors':_0x883cbf[_0x4561c6(0x28c)](_0x4561c6(0x28e)),'role':_0x3313e8,'profile':_0x3721b2,'adjustment':_0x4ac395,'stock':_0x1f0bb9,'master_shop':_0x2e5c58,'warehouse_name':_0x5c7e5d,'unit':_0x4709f2,'language':_0x42d09c,'warehouse':_0x93cffb});}catch(_0x39e795){console[_0x4561c6(0x21b)](_0x39e795),_0xc26dc7[_0x4561c6(0x25c)](0xc8)[_0x4561c6(0x24e)]({'message':_0x39e795[_0x4561c6(0x26d)]});}}),router[a0_0x3ed064(0x1cf)](a0_0x3ed064(0x1dc),auth,async(_0x4617bd,_0x4bef85)=>{var _0x3fb865=a0_0x3ed064;try{const _0x3213ef=_0x4617bd['params']['id'],_0x4bd63b=await adjustment['findById']({'_id':_0x3213ef}),_0x492a5a=await warehouse[_0x3fb865(0x1f1)]({'name':_0x4bd63b[_0x3fb865(0x247)],'room':_0x4bd63b['room']}),{warehouse_name:_0x51e3f7,date:_0x493aee,prod_name:_0x231df6,level:_0x57957e,isle:_0x5d8158,pallet:_0x3266db,stock:_0x47342b,types:_0x18c3a6,adjust_qty:_0x424745,new_adjust_qty:_0x13532e,note:_0x5357ce,Room_name:_0x9c1046,invoice:_0x13f86c,JO_number:_0x504407,expiry_date:_0xe4e8d0}=_0x4617bd['body'];if(typeof _0x231df6=='string')var _0x2fc690=[_0x4617bd[_0x3fb865(0x1cd)]['prod_name']],_0x20b4cd=[_0x4617bd['body'][_0x3fb865(0x1ce)]],_0x18c931=[_0x4617bd['body'][_0x3fb865(0x22a)]],_0x93e72d=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x203)]],_0x5df950=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x28d)]],_0x10d8dd=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x20f)]],_0x2eb233=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x286)]],_0x32b962=[_0x4617bd['body'][_0x3fb865(0x215)]],_0x3619f2=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x1e7)]],_0x4af9c3=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x1eb)]],_0x50ee03=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x25f)]],_0x47ead=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x1e2)]],_0x132628=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x1ca)]],_0xd05234=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x232)]],_0x53c1cb=[_0x4617bd[_0x3fb865(0x1cd)]['Rooms']],_0x575a26=[_0x4617bd['body'][_0x3fb865(0x26a)]],_0x583bcb=[_0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x228)]];else var _0x2fc690=[..._0x4617bd['body'][_0x3fb865(0x249)]],_0x20b4cd=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x1ce)]],_0x18c931=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x22a)]],_0x93e72d=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x203)]],_0x5df950=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x28d)]],_0x10d8dd=[..._0x4617bd[_0x3fb865(0x1cd)]['New_Qty_Converted']],_0x2eb233=[..._0x4617bd['body'][_0x3fb865(0x1c8)]],_0x32b962=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x215)]],_0x3619f2=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x1e7)]],_0x4af9c3=[..._0x4617bd[_0x3fb865(0x1cd)]['batch_code']],_0x50ee03=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x25f)]],_0x47ead=[..._0x4617bd[_0x3fb865(0x1cd)]['max_per_unit']],_0x132628=[..._0x4617bd['body'][_0x3fb865(0x1ca)]],_0xd05234=[..._0x4617bd[_0x3fb865(0x1cd)]['prod_cat']],_0x53c1cb=[..._0x4617bd['body']['Rooms']],_0x575a26=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x26a)]],_0x583bcb=[..._0x4617bd[_0x3fb865(0x1cd)][_0x3fb865(0x228)]];const _0x1029ff=_0x2fc690[_0x3fb865(0x1ef)](_0xd5eee5=>{return _0xd5eee5={'product_name':_0xd5eee5};});_0x20b4cd['forEach']((_0x3a0981,_0x211995)=>{_0x53c1cb['forEach']((_0x177fe6,_0xac83e5)=>{var _0x2c301d=a0_0xdbdb;if(_0x177fe6==_0x2c301d(0x1c0)&&_0x211995==_0xac83e5){var _0x427791=_0x3a0981['slice'](0x3);_0x1029ff[_0x211995]['storage']=_0x3a0981[0x0],_0x1029ff[_0x211995][_0x2c301d(0x27d)]=_0x3a0981[0x1],_0x1029ff[_0x211995][_0x2c301d(0x287)]=0x0,_0x1029ff[_0x211995][_0x2c301d(0x1e8)]=0x0,_0x1029ff[_0x211995][_0x2c301d(0x241)]=_0x2c301d(0x280),_0x1029ff[_0x211995][_0x2c301d(0x1e0)]=_0x427791;}else{if(_0x177fe6==_0x2c301d(0x281)&&_0x211995==_0xac83e5){var _0x427791=_0x3a0981['slice'](0x3);_0x1029ff[_0x211995][_0x2c301d(0x210)]=_0x3a0981[0x0],_0x1029ff[_0x211995][_0x2c301d(0x27d)]=_0x3a0981[0x1],_0x1029ff[_0x211995][_0x2c301d(0x287)]=0x0,_0x1029ff[_0x211995][_0x2c301d(0x1e8)]=0x0,_0x1029ff[_0x211995]['type']=_0x2c301d(0x280),_0x1029ff[_0x211995][_0x2c301d(0x1e0)]=_0x3a0981[0x5];}else{if(_0x211995==_0xac83e5){var _0xaf79ee;if(_0x3a0981[0x4]=='L')_0xaf79ee=_0x2c301d(0x243);else _0x3a0981[0x4]=='F'&&(_0xaf79ee=_0x2c301d(0x280));_0x1029ff[_0x211995][_0x2c301d(0x210)]=_0x3a0981[0x0],_0x1029ff[_0x211995][_0x2c301d(0x27d)]=_0x3a0981[0x1],_0x1029ff[_0x211995][_0x2c301d(0x287)]=_0x3a0981[0x2],_0x1029ff[_0x211995][_0x2c301d(0x1e8)]=_0x3a0981[0x3],_0x1029ff[_0x211995]['type']=_0xaf79ee,_0x1029ff[_0x211995]['floorlevel']=_0x3a0981[0x5];}}}});}),_0x18c931[_0x3fb865(0x1d1)]((_0x517e1a,_0x2ab2fc)=>{var _0xc3158e=_0x3fb865;_0x1029ff[_0x2ab2fc][_0xc3158e(0x290)]=_0x517e1a;}),_0x93e72d[_0x3fb865(0x1d1)]((_0x3e056a,_0x2f08c9)=>{var _0x2a5bc7=_0x3fb865;_0x1029ff[_0x2f08c9][_0x2a5bc7(0x203)]=_0x3e056a;}),_0x5df950[_0x3fb865(0x1d1)]((_0x20bcda,_0x127cbf)=>{var _0x2779d9=_0x3fb865;_0x1029ff[_0x127cbf][_0x2779d9(0x28b)]=_0x20bcda;}),_0x10d8dd['forEach']((_0x2f45a2,_0xf866a5)=>{_0x1029ff[_0xf866a5]['new_adjust_qty']=_0x2f45a2;}),_0x2eb233[_0x3fb865(0x1d1)]((_0x550303,_0x5a133c)=>{var _0x519708=_0x3fb865;_0x1029ff[_0x5a133c][_0x519708(0x1c8)]=_0x550303;}),_0x32b962[_0x3fb865(0x1d1)]((_0x594f8f,_0x4e78f7)=>{var _0x5527ba=_0x3fb865;_0x1029ff[_0x4e78f7][_0x5527ba(0x208)]=_0x594f8f;}),_0x3619f2[_0x3fb865(0x1d1)]((_0x49bc64,_0x5ab22d)=>{var _0x54a8a4=_0x3fb865;_0x1029ff[_0x5ab22d][_0x54a8a4(0x221)]=_0x49bc64;}),_0x4af9c3[_0x3fb865(0x1d1)]((_0xe98593,_0x4c7ce6)=>{var _0x4b52d9=_0x3fb865;_0x1029ff[_0x4c7ce6][_0x4b52d9(0x1eb)]=_0xe98593;}),_0x50ee03[_0x3fb865(0x1d1)]((_0xe218b,_0x460ad3)=>{_0x1029ff[_0x460ad3]['expiry_date']=_0xe218b;}),_0x47ead[_0x3fb865(0x1d1)]((_0x5b6bfe,_0x2f192f)=>{_0x1029ff[_0x2f192f]['maxperunit']=_0x5b6bfe;}),_0x132628['forEach']((_0x116516,_0x1df1ae)=>{_0x1029ff[_0x1df1ae]['production_date']=_0x116516;}),_0xd05234['forEach']((_0x10ff19,_0x21c9e9)=>{_0x1029ff[_0x21c9e9]['prod_cat']=_0x10ff19;}),_0x53c1cb[_0x3fb865(0x1d1)]((_0x22f257,_0x181a88)=>{_0x1029ff[_0x181a88]['room_names']=_0x22f257;}),_0x575a26[_0x3fb865(0x1d1)]((_0xa5cdcc,_0x217f61)=>{_0x1029ff[_0x217f61]['primary_code']=_0xa5cdcc;}),_0x583bcb[_0x3fb865(0x1d1)]((_0x296f15,_0x1102bf)=>{var _0x329e52=_0x3fb865;_0x1029ff[_0x1102bf][_0x329e52(0x238)]=_0x296f15;});const _0x48261e=_0x1029ff['filter'](_0x43fb85=>_0x43fb85[_0x3fb865(0x28b)]!=='0'&&_0x43fb85[_0x3fb865(0x28b)]!=='');var _0x56af3d=0x0;_0x48261e['forEach'](_0x33100e=>{var _0x54b376=_0x3fb865;console['log'](_0x54b376(0x25e),_0x33100e),parseInt(_0x33100e[_0x54b376(0x28b)])<=0x0&&_0x56af3d++;});if(_0x56af3d!=0x0)return _0x4617bd[_0x3fb865(0x28c)](_0x3fb865(0x28e),_0x3fb865(0x252)),_0x4bef85[_0x3fb865(0x216)](_0x3fb865(0x279));_0x4bd63b[_0x3fb865(0x247)]=_0x51e3f7,_0x4bd63b[_0x3fb865(0x266)]=_0x493aee,_0x4bd63b[_0x3fb865(0x250)]=_0x48261e,_0x4bd63b['note']=_0x5357ce,_0x4bd63b[_0x3fb865(0x207)]=_0x13f86c,_0x4bd63b[_0x3fb865(0x218)]='False';const _0x447efc=await _0x4bd63b[_0x3fb865(0x1f9)]();_0x4617bd[_0x3fb865(0x28c)](_0x3fb865(0x1e9),_0x3fb865(0x255)),_0x4bef85[_0x3fb865(0x216)](_0x3fb865(0x24a));}catch(_0x27c21b){console['log'](_0x27c21b);}}),router[a0_0x3ed064(0x1cf)](a0_0x3ed064(0x229),async(_0x38ccb9,_0x502243)=>{var _0x19bbd3=a0_0x3ed064;const {primary_code:_0x2ae563,warehouse_data:_0x18930d,rooms_data:_0x1b2084,Roomslist:_0x29fff1}=_0x38ccb9['body'],_0x45bede=_0x29fff1['split'](','),_0x20328d=[];async function _0x3df75a(_0x40b7a6){var _0x2ebbe8=a0_0xdbdb;const _0x227ce2=await warehouse['aggregate']([{'$match':{'name':_0x18930d,'room':_0x40b7a6}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2ae563}},{'$group':{'_id':_0x2ebbe8(0x26f),'name':{'$first':_0x2ebbe8(0x276)},'product_stock':{'$first':_0x2ebbe8(0x23f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2ebbe8(0x20c)},'product_code':{'$first':_0x2ebbe8(0x258)},'level':{'$first':_0x2ebbe8(0x237)},'isle':{'$first':_0x2ebbe8(0x245)},'type':{'$first':_0x2ebbe8(0x1c9)},'pallet':{'$first':_0x2ebbe8(0x1de)},'unit':{'$first':_0x2ebbe8(0x21e)},'secondary_unit':{'$first':_0x2ebbe8(0x212)},'storage':{'$first':_0x2ebbe8(0x1da)},'rack':{'$first':_0x2ebbe8(0x22f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2ebbe8(0x1fe)},'product_cat':{'$first':_0x2ebbe8(0x27c)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2ebbe8(0x1d2)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x503200=await warehouse[_0x2ebbe8(0x226)]([{'$match':{'name':_0x18930d,'room':_0x40b7a6}},{'$unwind':_0x2ebbe8(0x1d8)},{'$match':{'product_details.secondary_code':_0x2ae563}},{'$group':{'_id':_0x2ebbe8(0x26f),'name':{'$first':_0x2ebbe8(0x276)},'product_stock':{'$first':_0x2ebbe8(0x23f)},'primary_code':{'$first':_0x2ebbe8(0x1f5)},'secondary_code':{'$first':_0x2ebbe8(0x20c)},'product_code':{'$first':_0x2ebbe8(0x258)},'level':{'$first':_0x2ebbe8(0x237)},'isle':{'$first':_0x2ebbe8(0x245)},'type':{'$first':_0x2ebbe8(0x1c9)},'pallet':{'$first':_0x2ebbe8(0x1de)},'unit':{'$first':_0x2ebbe8(0x21e)},'secondary_unit':{'$first':_0x2ebbe8(0x212)},'storage':{'$first':_0x2ebbe8(0x1da)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2ebbe8(0x244)},'production_date':{'$first':_0x2ebbe8(0x20e)},'maxPerUnit':{'$first':_0x2ebbe8(0x1db)},'batch_code':{'$first':_0x2ebbe8(0x1fe)},'product_cat':{'$first':_0x2ebbe8(0x27c)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2ebbe8(0x1d2)}}}]);if(_0x227ce2[_0x2ebbe8(0x206)]>0x0)_0x20328d[_0x2ebbe8(0x22b)](_0x227ce2);else _0x503200[_0x2ebbe8(0x206)]>0x0&&_0x20328d[_0x2ebbe8(0x22b)](_0x503200);}const _0x23db29=_0x45bede[_0x19bbd3(0x1ef)](_0x566b66=>_0x3df75a(_0x566b66));await Promise[_0x19bbd3(0x264)](_0x23db29),_0x502243[_0x19bbd3(0x24e)](_0x20328d);}),router[a0_0x3ed064(0x1cf)](a0_0x3ed064(0x22c),async(_0x214a8b,_0x137808)=>{var _0x50940f=a0_0x3ed064;const {primaryCode:_0xcf52b2,secondaryCode:_0x115940,productCode:_0x33a153,level:_0x5a8d4f,isle:_0x2ef803,pallet:_0x2ac37b,warehouses:_0x13bd57,room:_0x49b30f}=_0x214a8b[_0x50940f(0x1cd)];try{const _0x2f6c95=await warehouse['aggregate']([{'$match':{'name':_0x13bd57,'room':_0x49b30f}},{'$unwind':_0x50940f(0x1d8)},{'$match':{'product_details.level':parseInt(_0x5a8d4f),'product_details.isle':_0x2ef803,'product_details.pallet':parseInt(_0x2ac37b)}},{'$group':{'_id':_0x50940f(0x26f),'name':{'$first':_0x50940f(0x276)},'product_stock':{'$first':_0x50940f(0x23f)},'level':{'$first':_0x50940f(0x201)},'isle':{'$first':_0x50940f(0x1ec)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x50940f(0x1ea)}}}]);_0x137808['status'](0xc8)[_0x50940f(0x24e)](_0x2f6c95);}catch(_0x3bd082){_0x137808[_0x50940f(0x25c)](0x194)['json']({'message':_0x3bd082[_0x50940f(0x26d)]});}}),module[a0_0x3ed064(0x235)]=router;