var a0_0x1446cf=a0_0x2f1c;function a0_0x343d(){var _0x2c4688=['adjustment\x20Finalized\x20successfully','findOne','body','$product_details.product_name','</div>','/view','RMSEmail','secondary_unit','host','$product_details.maxProducts','prod_code','</span>','<!DOCTYPE\x20html>','unit','types','date','An\x20error\x20occurred.','createTransport','$product.room_names','/view/:id','$product_details.storage','/adjustment/preview/','adjustment','Enabled','$product_details._id','product_code','prod_name','status','storage','product_name','all','room','../models/all_models','room_names','secondary_code','$product_details.product_cat','$product_details.floorlevel','Return\x20Rooms','</tr>','$product_details.bay','Arabic','<h2>\x20','\x20Order\x20Number\x20:\x20','product_details','Rooms','</td>','$room','/picking_list/PDF_adjustment_rm/','$product_details.secondary_unit','5711031GJvhIh','exports','/barcode_scanner','Logo.png','<hr\x20class=\x22my-3\x22>','adjust_qty','Return\x20Goods','../middleware/auth','/adjustment/view','$warehouse_name','Portuguese','finalize','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','332AzaRlP','max_per_unit','second1','foreach\x20newproduct','Raw\x20Materials','floorlevel','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','warehouse_name','</h5>','Secondary_units','There\x27s\x20a\x20error\x20in\x20this\x20transaction','logo','flash','product_stock','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','save','warehouse','language','<tbody\x20style=\x22text-align:\x20center;\x22>','Shelves','An\x20error\x20occurred\x20while\x20saving\x20data.','nodemailer','string','6142740dzHxqZ','find','</body></html>','params','True','$date','7777656ghhXCT','New_Qty_Converted','role','log','Portuguese\x20(BR)','Receiving\x20Area','error','batch_code','image','adjustment\x20data\x20update\x20successfully','Arabic\x20(ae)','findById','$product_details.bin','$name','$product_details.expiry_date','$invoice','stockBefore','English\x20(US)','ADJ-','prod_cat','<h5>','131695JSgdyI','\x20<>\x20','master','Primary_Units','39606QNAGCq','/view/add_adjustment','Router','\x20</h2>','Chinese','padStart','Level','back','/CheckingWarehouse','map','$product_details.product_code','filter','catch','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Email\x20sent\x20successfully','site_title','slice','$finalize','<strong>\x20Regards\x20</strong>','Floor','Enclosed','minus','$product_details.rack','json','sendMail','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','render','user','2250927eeibQS','</tbody>','../public/language/languages.json','expiry_date','maxperunit','11257520kKeiLs','$product_details.unit','primary_code','<span\x20style=\x22float:\x20right;\x22>','staff','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','New_Qty_Converted_adj','add_adjustment','bin','prime1','success','then','English','$product_details.type','$product_details.product_stock','length','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details','stock','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product.product_name','24sUdKlx','Spanish','errors','production_date','_id','$product_details.batch_code','<h5\x20style=\x22text-align:\x20left;\x22>','prod_invoice','$product_details.production_date','German','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','message','$product','push','<html><head><title></title>','get','express','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.level','toString','Error\x20Occurs','</thead>','$product_details.primary_code','edit_adjustment','French','Ambient','new_adjust_qty','redirect','bay','aggregate','18lJbhER','$product_details.pallet','random','/upload/','\x20Order\x20Date\x20:\x20','$product_details.secondary_code','$product_details.maxPerUnit','False','Hindi','product','Adjustment\x20Mail','invoice','forEach','level','<div>','type','post'];a0_0x343d=function(){return _0x2c4688;};return a0_0x343d();}(function(_0x1e6159,_0x1c4df2){var _0xb37666=a0_0x2f1c,_0x504302=_0x1e6159();while(!![]){try{var _0x21d3d7=-parseInt(_0xb37666(0x191))/0x1*(-parseInt(_0xb37666(0x10f))/0x2)+parseInt(_0xb37666(0x195))/0x3*(parseInt(_0xb37666(0x15e))/0x4)+parseInt(_0xb37666(0x176))/0x5+-parseInt(_0xb37666(0x17c))/0x6+parseInt(_0xb37666(0x1b2))/0x7*(-parseInt(_0xb37666(0xf1))/0x8)+parseInt(_0xb37666(0x151))/0x9+-parseInt(_0xb37666(0x1b7))/0xa;if(_0x21d3d7===_0x1c4df2)break;else _0x504302['push'](_0x504302['shift']());}catch(_0x56829b){_0x504302['push'](_0x504302['shift']());}}}(a0_0x343d,0xb8ea9));const express=require(a0_0x1446cf(0x101)),app=express(),router=express[a0_0x1446cf(0x197)](),auth=require(a0_0x1446cf(0x158)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1446cf(0x140)),users=require(a0_0x1446cf(0x1b4)),nodemailer=require(a0_0x1446cf(0x174));router['get'](a0_0x1446cf(0x125),auth,async(_0x34402c,_0x489f6f)=>{var _0x42727a=a0_0x1446cf;try{const {username:_0xef7918,email:_0x5849d7,role:_0x55de6b}=_0x34402c[_0x42727a(0x1b1)],_0xf9b8=_0x34402c[_0x42727a(0x1b1)],_0x105e57=await profile['findOne']({'email':_0xf9b8[_0x42727a(0x1ae)]}),_0x18a49e=await master_shop[_0x42727a(0x177)]();console[_0x42727a(0x17f)](_0x42727a(0x193),_0x18a49e);let _0x22b30c;if(_0xf9b8[_0x42727a(0x17e)]=='staff'){const _0x2c3d7f=await staff[_0x42727a(0x121)]({'email':_0xf9b8[_0x42727a(0x1ae)]});_0x22b30c=await warehouse[_0x42727a(0x177)]({'status':'Enabled','name':_0x2c3d7f[_0x42727a(0x16f)]});}else _0x22b30c=await warehouse['find']({'status':_0x42727a(0x137)});const _0x3caa86=await product[_0x42727a(0x177)]();let _0x20dc76;if(_0xf9b8['role']==_0x42727a(0x1bb)){const _0x4dcb21=await staff[_0x42727a(0x121)]({'email':_0xf9b8[_0x42727a(0x1ae)]});_0x20dc76=await adjustment[_0x42727a(0x177)]({'warehouse_name':_0x4dcb21[_0x42727a(0x16f)]});}else _0x20dc76=await adjustment[_0x42727a(0x10e)]([{'$unwind':_0x42727a(0xfd)},{'$group':{'_id':'$_id','invoice':{'$first':_0x42727a(0x18b)},'date':{'$first':_0x42727a(0x17b)},'warehouse_name':{'$first':_0x42727a(0x15a)},'room':{'$addToSet':_0x42727a(0x132)},'finalize':{'$first':_0x42727a(0x1a6)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x18a49e[0x0][_0x42727a(0x170)]==_0x42727a(0x18d)){var _0xee3d8c=users[_0x42727a(0x1c4)];console['log'](_0xee3d8c);}else{if(_0x18a49e[0x0]['language']==_0x42727a(0x117))var _0xee3d8c=users[_0x42727a(0x117)];else{if(_0x18a49e[0x0][_0x42727a(0x170)]==_0x42727a(0xfa))var _0xee3d8c=users['German'];else{if(_0x18a49e[0x0][_0x42727a(0x170)]==_0x42727a(0xf2))var _0xee3d8c=users[_0x42727a(0xf2)];else{if(_0x18a49e[0x0]['language']=='French')var _0xee3d8c=users[_0x42727a(0x109)];else{if(_0x18a49e[0x0][_0x42727a(0x170)]==_0x42727a(0x180))var _0xee3d8c=users[_0x42727a(0x15b)];else{if(_0x18a49e[0x0][_0x42727a(0x170)]==_0x42727a(0x199))var _0xee3d8c=users[_0x42727a(0x199)];else{if(_0x18a49e[0x0]['language']==_0x42727a(0x186))var _0xee3d8c=users[_0x42727a(0x148)];}}}}}}}_0x489f6f['render'](_0x42727a(0x136),{'success':_0x34402c[_0x42727a(0x16b)]('success'),'errors':_0x34402c[_0x42727a(0x16b)]('errors'),'role':_0xf9b8,'profile':_0x105e57,'warehouse':_0x22b30c,'product':_0x3caa86,'adjustment':_0x20dc76,'master_shop':_0x18a49e,'language':_0xee3d8c});}catch(_0x42ed99){console['log'](_0x42ed99);}});function a0_0x2f1c(_0x47ca5c,_0x412af9){var _0x343d3f=a0_0x343d();return a0_0x2f1c=function(_0x2f1c8d,_0x12c4b2){_0x2f1c8d=_0x2f1c8d-0xec;var _0x2cb2ff=_0x343d3f[_0x2f1c8d];return _0x2cb2ff;},a0_0x2f1c(_0x47ca5c,_0x412af9);}async function getRandom8DigitNumber(){var _0x1f097f=a0_0x1446cf;const _0x5c5ac6=0x989680,_0x1ad44f=0x5f5e0ff,_0x3210c6=Math['floor'](Math[_0x1f097f(0x111)]()*(_0x1ad44f-_0x5c5ac6+0x1))+_0x5c5ac6;var _0x315d92;const _0x38a486=await adjustment[_0x1f097f(0x121)]({'invoice':'ADJ-'+_0x3210c6});return _0x38a486&&_0x38a486[_0x1f097f(0x1c7)]>0x0?_0x315d92=_0x1f097f(0x18e)+_0x3210c6:_0x315d92=_0x1f097f(0x18e)+_0x3210c6,_0x315d92;}router[a0_0x1446cf(0x100)]('/view/add_adjustment',auth,async(_0x9cb850,_0x35a62b)=>{var _0xce0c59=a0_0x1446cf;try{const {username:_0x13546e,email:_0x3e602e,role:_0x12f22a}=_0x9cb850['user'],_0x141f79=_0x9cb850[_0xce0c59(0x1b1)],_0x1b2a60=await profile[_0xce0c59(0x121)]({'email':_0x141f79[_0xce0c59(0x1ae)]}),_0x140ed3=await master_shop[_0xce0c59(0x177)]();let _0x4a1d50;if(_0x141f79[_0xce0c59(0x17e)]==_0xce0c59(0x1bb)){const _0x51c982=await staff[_0xce0c59(0x121)]({'email':_0x141f79['email']});_0x4a1d50=await warehouse[_0xce0c59(0x10e)]([{'$match':{'status':'Enabled','name':_0x51c982['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xce0c59(0x157)}}},{'$group':{'_id':'$name','name':{'$first':_0xce0c59(0x189)}}}]);}else _0x4a1d50=await warehouse['aggregate']([{'$match':{'status':_0xce0c59(0x137),'warehouse_category':_0xce0c59(0x162),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0xce0c59(0x189),'name':{'$first':_0xce0c59(0x189)}}}]);const _0x367218=await product[_0xce0c59(0x177)]({}),_0x469c4b=await adjustment['find']({}),_0x1cbda9=_0x469c4b['length']+0x1,_0x64907=_0xce0c59(0x18e)+_0x1cbda9[_0xce0c59(0x104)]()[_0xce0c59(0x19a)](0x5,'0');var _0x4139d3=[_0xce0c59(0x10a),_0xce0c59(0x1a9),_0xce0c59(0x145)];if(_0x140ed3[0x0]['language']=='English\x20(US)')var _0x1d334a=users[_0xce0c59(0x1c4)];else{if(_0x140ed3[0x0][_0xce0c59(0x170)]==_0xce0c59(0x117))var _0x1d334a=users['Hindi'];else{if(_0x140ed3[0x0]['language']==_0xce0c59(0xfa))var _0x1d334a=users[_0xce0c59(0xfa)];else{if(_0x140ed3[0x0]['language']==_0xce0c59(0xf2))var _0x1d334a=users['Spanish'];else{if(_0x140ed3[0x0][_0xce0c59(0x170)]==_0xce0c59(0x109))var _0x1d334a=users['French'];else{if(_0x140ed3[0x0][_0xce0c59(0x170)]==_0xce0c59(0x180))var _0x1d334a=users[_0xce0c59(0x15b)];else{if(_0x140ed3[0x0][_0xce0c59(0x170)]==_0xce0c59(0x199))var _0x1d334a=users[_0xce0c59(0x199)];else{if(_0x140ed3[0x0]['language']=='Arabic\x20(ae)')var _0x1d334a=users[_0xce0c59(0x148)];}}}}}}}const _0x420e91=getRandom8DigitNumber();_0x420e91[_0xce0c59(0x1c3)](_0x40c29d=>{var _0x5bc244=_0xce0c59;_0x35a62b[_0x5bc244(0x1b0)](_0x5bc244(0x1bf),{'success':_0x9cb850[_0x5bc244(0x16b)](_0x5bc244(0x1c2)),'errors':_0x9cb850['flash']('errors'),'role':_0x141f79,'profile':_0x1b2a60,'warehouse':_0x4a1d50,'product':_0x367218,'master_shop':_0x140ed3,'language':_0x1d334a,'rooms_data':_0x4139d3,'invoice_no':_0x40c29d});})[_0xce0c59(0x1a1)](_0x142945=>{var _0x4349e1=_0xce0c59;_0x9cb850[_0x4349e1(0x16b)](_0x4349e1(0xf3),_0x4349e1(0x169)),_0x35a62b['redirect']('/adjustment/view');});}catch(_0x397bb4){console[_0xce0c59(0x17f)](_0x397bb4);}}),router[a0_0x1446cf(0x11f)](a0_0x1446cf(0x196),auth,async(_0x3a4144,_0x2069d8)=>{var _0x424aba=a0_0x1446cf;try{const {warehouse_name:_0x302f90,date:_0x53e56e,prod_name:_0x45da34,level:_0x4995ae,isle:_0x2ff1e8,pallet:_0x15ea36,stock:_0x36333f,types:_0x172d9b,adjust_qty:_0x5bc232,new_adjust_qty:_0x2c1523,note:_0x5c922f,Room_name:_0x4d67c3,invoice:_0x2fac03,JO_number:_0x50c779,expiry_date:_0x2959cf}=_0x3a4144[_0x424aba(0x122)];if(typeof _0x45da34=='string')var _0x452790=[_0x3a4144['body'][_0x424aba(0x13a)]],_0xcd32fb=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x11c)]],_0xc48dc4=[_0x3a4144['body'][_0x424aba(0xed)]],_0x2a7cbf=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x12e)]],_0x36ac85=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x1be)]],_0x23d951=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x17d)]],_0x3660f2=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x194)]],_0x229834=[_0x3a4144['body'][_0x424aba(0x168)]],_0x3cee2c=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x12a)]],_0x1fd208=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x183)]],_0x41ffe5=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x1b5)]],_0x5de916=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x15f)]],_0x32b7fb=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0xf4)]],_0x13a494=[_0x3a4144['body'][_0x424aba(0x18f)]],_0x1c579e=[_0x3a4144[_0x424aba(0x122)]['Rooms']],_0x21d523=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x1c1)]],_0x14ad59=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0x160)]],_0x1132ae=[_0x3a4144[_0x424aba(0x122)][_0x424aba(0xf8)]];else var _0x452790=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x13a)]],_0xcd32fb=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x11c)]],_0xc48dc4=[..._0x3a4144[_0x424aba(0x122)]['stock']],_0x2a7cbf=[..._0x3a4144['body']['types']],_0x36ac85=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x1be)]],_0x23d951=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x17d)]],_0x3660f2=[..._0x3a4144['body'][_0x424aba(0x12d)]],_0x229834=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x168)]],_0x3cee2c=[..._0x3a4144['body'][_0x424aba(0x12a)]],_0x1fd208=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x183)]],_0x41ffe5=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x1b5)]],_0x5de916=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x15f)]],_0x32b7fb=[..._0x3a4144['body'][_0x424aba(0xf4)]],_0x13a494=[..._0x3a4144['body']['prod_cat']],_0x1c579e=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x14c)]],_0x21d523=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x1c1)]],_0x14ad59=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0x160)]],_0x1132ae=[..._0x3a4144[_0x424aba(0x122)][_0x424aba(0xf8)]];const _0x2e01a1=_0x452790[_0x424aba(0x19e)](_0x56a104=>{return _0x56a104={'product_name':_0x56a104};});_0xcd32fb[_0x424aba(0x11b)]((_0x2afbb1,_0x52a8f1)=>{var _0x71a074=_0x424aba;_0x1c579e[_0x71a074(0x11b)]((_0x247ea9,_0x5cbb1b)=>{var _0x429b3c=_0x71a074;if(_0x247ea9==_0x429b3c(0x181)&&_0x52a8f1==_0x5cbb1b){var _0x2ea404=_0x2afbb1['slice'](0x3);_0x2e01a1[_0x52a8f1][_0x429b3c(0x13c)]=_0x2afbb1[0x0],_0x2e01a1[_0x52a8f1][_0x429b3c(0x164)]=_0x2afbb1[0x1],_0x2e01a1[_0x52a8f1]['bay']=0x0,_0x2e01a1[_0x52a8f1][_0x429b3c(0x1c0)]=0x0,_0x2e01a1[_0x52a8f1][_0x429b3c(0x11e)]=_0x429b3c(0x1a8),_0x2e01a1[_0x52a8f1]['floorlevel']=_0x2ea404;}else{if(_0x247ea9==_0x429b3c(0x172)&&_0x52a8f1==_0x5cbb1b){var _0x2ea404=_0x2afbb1[_0x429b3c(0x1a5)](0x3);_0x2e01a1[_0x52a8f1][_0x429b3c(0x13c)]=_0x2afbb1[0x0],_0x2e01a1[_0x52a8f1][_0x429b3c(0x164)]=_0x2afbb1[0x1],_0x2e01a1[_0x52a8f1]['bay']=0x0,_0x2e01a1[_0x52a8f1][_0x429b3c(0x1c0)]=0x0,_0x2e01a1[_0x52a8f1][_0x429b3c(0x11e)]=_0x429b3c(0x1a8),_0x2e01a1[_0x52a8f1][_0x429b3c(0x163)]=_0x2afbb1[0x5];}else{if(_0x52a8f1==_0x5cbb1b){var _0x5ea22a;if(_0x2afbb1[0x4]=='L')_0x5ea22a='Level';else _0x2afbb1[0x4]=='F'&&(_0x5ea22a=_0x429b3c(0x1a8));_0x2e01a1[_0x52a8f1]['storage']=_0x2afbb1[0x0],_0x2e01a1[_0x52a8f1][_0x429b3c(0x164)]=_0x2afbb1[0x1],_0x2e01a1[_0x52a8f1][_0x429b3c(0x10d)]=_0x2afbb1[0x2],_0x2e01a1[_0x52a8f1][_0x429b3c(0x1c0)]=_0x2afbb1[0x3],_0x2e01a1[_0x52a8f1]['type']=_0x5ea22a,_0x2e01a1[_0x52a8f1][_0x429b3c(0x163)]=_0x2afbb1[0x5];}}}});}),_0xc48dc4[_0x424aba(0x11b)]((_0x3fb177,_0x25cf09)=>{var _0x5e2446=_0x424aba;_0x2e01a1[_0x25cf09][_0x5e2446(0x18c)]=_0x3fb177;}),_0x2a7cbf[_0x424aba(0x11b)]((_0x309367,_0x1d27a7)=>{var _0x554073=_0x424aba;_0x2e01a1[_0x1d27a7][_0x554073(0x12e)]=_0x309367;}),_0x36ac85[_0x424aba(0x11b)]((_0x337a85,_0x24fadf)=>{var _0x39b7f7=_0x424aba;_0x2e01a1[_0x24fadf][_0x39b7f7(0x156)]=_0x337a85;}),_0x23d951[_0x424aba(0x11b)]((_0x13254d,_0x17f3dc)=>{var _0x1808ac=_0x424aba;_0x2e01a1[_0x17f3dc][_0x1808ac(0x10b)]=_0x13254d;}),_0x3660f2[_0x424aba(0x11b)]((_0x18ecbc,_0x1f481e)=>{var _0x48d64a=_0x424aba;_0x2e01a1[_0x1f481e][_0x48d64a(0x12d)]=_0x18ecbc;}),_0x229834['forEach']((_0xd8cdde,_0x1f5358)=>{var _0x2e21df=_0x424aba;_0x2e01a1[_0x1f5358][_0x2e21df(0x127)]=_0xd8cdde;}),_0x3cee2c['forEach']((_0x1d3b77,_0x3a23f6)=>{var _0x42aa67=_0x424aba;_0x2e01a1[_0x3a23f6][_0x42aa67(0x139)]=_0x1d3b77;}),_0x1fd208[_0x424aba(0x11b)]((_0x2f8a31,_0x1a06b6)=>{var _0x11e6d5=_0x424aba;_0x2e01a1[_0x1a06b6][_0x11e6d5(0x183)]=_0x2f8a31;}),_0x41ffe5[_0x424aba(0x11b)]((_0x18aa72,_0x6887e3)=>{_0x2e01a1[_0x6887e3]['expiry_date']=_0x18aa72;}),_0x5de916[_0x424aba(0x11b)]((_0x41bcd7,_0x4f2978)=>{var _0x368d79=_0x424aba;_0x2e01a1[_0x4f2978][_0x368d79(0x1b6)]=_0x41bcd7;}),_0x32b7fb[_0x424aba(0x11b)]((_0x4edc41,_0x5ba440)=>{var _0x2b59c8=_0x424aba;_0x2e01a1[_0x5ba440][_0x2b59c8(0xf4)]=_0x4edc41;}),_0x13a494[_0x424aba(0x11b)]((_0x107ac3,_0x1013bf)=>{var _0x435a55=_0x424aba;_0x2e01a1[_0x1013bf][_0x435a55(0x18f)]=_0x107ac3;}),_0x1c579e['forEach']((_0x2c5afc,_0x6abf07)=>{var _0x46440b=_0x424aba;_0x2e01a1[_0x6abf07][_0x46440b(0x141)]=_0x2c5afc;}),_0x21d523[_0x424aba(0x11b)]((_0xca0b12,_0x659dcd)=>{var _0x40d4a1=_0x424aba;_0x2e01a1[_0x659dcd][_0x40d4a1(0x1b9)]=_0xca0b12;}),_0x14ad59[_0x424aba(0x11b)]((_0x212d35,_0xcecef0)=>{var _0x4c70be=_0x424aba;_0x2e01a1[_0xcecef0][_0x4c70be(0x142)]=_0x212d35;}),_0x1132ae[_0x424aba(0x11b)]((_0x5449da,_0x3c3bf3)=>{_0x2e01a1[_0x3c3bf3]['invoice']=_0x5449da;});const _0x1f3bd0=_0x2e01a1[_0x424aba(0x1a0)](_0x5b34c1=>_0x5b34c1['adjust_qty']!=='0'&&_0x5b34c1[_0x424aba(0x156)]!=='');var _0x4c3067=0x0;_0x1f3bd0['forEach'](_0x35b7b8=>{var _0x231ae0=_0x424aba;console[_0x231ae0(0x17f)](_0x231ae0(0x161),_0x35b7b8),parseInt(_0x35b7b8[_0x231ae0(0x156)])<=0x0&&_0x4c3067++;});if(_0x4c3067!=0x0)return _0x3a4144[_0x424aba(0x16b)](_0x424aba(0xf3),_0x424aba(0x16d)),_0x2069d8[_0x424aba(0x10c)](_0x424aba(0x19c));const _0x28f6d0=new adjustment({'warehouse_name':_0x302f90,'date':_0x53e56e,'product':_0x1f3bd0,'note':_0x5c922f,'room':_0x4d67c3,'invoice':_0x2fac03,'JO_number':_0x50c779,'expiry_date':_0x2959cf}),_0x2d63c9=await _0x28f6d0[_0x424aba(0x16e)]();_0x3a4144['flash'](_0x424aba(0x1c2),'adjustment\x20add\x20successfull'),_0x2069d8[_0x424aba(0x10c)](_0x424aba(0x135)+_0x2d63c9[_0x424aba(0xf5)]);}catch(_0x373dc5){console[_0x424aba(0x17f)](_0x373dc5),_0x2069d8[_0x424aba(0x13b)](0xc8)[_0x424aba(0x1ac)]({'message':_0x373dc5['message']});}}),router[a0_0x1446cf(0x100)]('/preview/:id',auth,async(_0x5da7ab,_0x18d6ba)=>{var _0x1f951a=a0_0x1446cf;try{const {username:_0x24b7fb,email:_0x4e6027,role:_0x217c47}=_0x5da7ab[_0x1f951a(0x1b1)],_0x3cb9c9=_0x5da7ab[_0x1f951a(0x1b1)],_0x4aaea5=await profile['findOne']({'email':_0x3cb9c9[_0x1f951a(0x1ae)]}),_0x15f17e=await master_shop['find'](),_0x2313f6=_0x5da7ab['params']['id'],_0x2a36e0=await adjustment[_0x1f951a(0x187)]({'_id':_0x2313f6}),_0x3e5e83=await purchases[_0x1f951a(0x10e)]([{'$match':{'warehouse_name':_0x2a36e0[_0x1f951a(0x166)]}},{'$unwind':_0x1f951a(0xfd)},{'$group':{'_id':_0x1f951a(0xf0)}}]),_0x361b2b=await product[_0x1f951a(0x177)]({}),_0x715d31=await warehouse[_0x1f951a(0x10e)]([{'$match':{'name':_0x2a36e0[_0x1f951a(0x166)]}},{'$unwind':_0x1f951a(0xec)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1f951a(0x123)},'product_stock':{'$first':_0x1f951a(0x1c6)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1f951a(0x188)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1f951a(0x144)},'primary_code':{'$first':_0x1f951a(0x107)},'secondary_code':{'$first':_0x1f951a(0x114)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1f951a(0x134)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x1f951a(0x115)},'expiry_date':{'$first':_0x1f951a(0x18a)},'production_date':{'$first':_0x1f951a(0xf9)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x1f951a(0x14e)}}}]);if(_0x15f17e[0x0]['language']==_0x1f951a(0x18d)){var _0xfc91a3=users[_0x1f951a(0x1c4)];console[_0x1f951a(0x17f)](_0xfc91a3);}else{if(_0x15f17e[0x0][_0x1f951a(0x170)]==_0x1f951a(0x117))var _0xfc91a3=users[_0x1f951a(0x117)];else{if(_0x15f17e[0x0][_0x1f951a(0x170)]==_0x1f951a(0xfa))var _0xfc91a3=users['German'];else{if(_0x15f17e[0x0][_0x1f951a(0x170)]=='Spanish')var _0xfc91a3=users[_0x1f951a(0xf2)];else{if(_0x15f17e[0x0][_0x1f951a(0x170)]==_0x1f951a(0x109))var _0xfc91a3=users['French'];else{if(_0x15f17e[0x0]['language']==_0x1f951a(0x180))var _0xfc91a3=users[_0x1f951a(0x15b)];else{if(_0x15f17e[0x0][_0x1f951a(0x170)]==_0x1f951a(0x199))var _0xfc91a3=users['Chinese'];else{if(_0x15f17e[0x0][_0x1f951a(0x170)]==_0x1f951a(0x186))var _0xfc91a3=users[_0x1f951a(0x148)];}}}}}}}_0x18d6ba[_0x1f951a(0x1b0)]('edit_adjustment_view',{'success':_0x5da7ab['flash'](_0x1f951a(0x1c2)),'errors':_0x5da7ab[_0x1f951a(0x16b)]('errors'),'role':_0x3cb9c9,'profile':_0x4aaea5,'adjustment':_0x2a36e0,'stock':_0x715d31,'master_shop':_0x15f17e,'warehouse_name':_0x3e5e83,'unit':_0x361b2b,'language':_0xfc91a3});}catch(_0x23bc48){console[_0x1f951a(0x17f)](_0x23bc48),_0x18d6ba[_0x1f951a(0x13b)](0xc8)[_0x1f951a(0x1ac)]({'message':_0x23bc48[_0x1f951a(0xfc)]});}}),router[a0_0x1446cf(0x11f)]('/preview/:id',auth,async(_0x5e49f1,_0x866967)=>{var _0xf7f015=a0_0x1446cf;try{const _0x48f396=_0x5e49f1[_0xf7f015(0x179)]['id'],{warehouse_name:_0xf87a61,Room_name:_0x302195}=_0x5e49f1['body'],_0x493755=await adjustment['findById']({'_id':_0x48f396}),_0x7ebba6=_0x493755[_0xf7f015(0x118)]['map'](async _0x732182=>{var _0x1d6ff9=_0xf7f015;if(_0x732182[_0x1d6ff9(0x156)]>0x0){var _0x37e5f8=await warehouse[_0x1d6ff9(0x121)]({'name':_0xf87a61,'room':_0x732182[_0x1d6ff9(0x141)],'warehouse_category':_0x1d6ff9(0x162)});const _0x4f7c1c=_0x37e5f8[_0x1d6ff9(0x14b)][_0x1d6ff9(0x19e)](_0x5c0855=>{var _0x24f261=_0x1d6ff9;if(_0x732182['type']==_0x24f261(0x1aa)){if(_0x5c0855[_0x24f261(0x13d)]==_0x732182[_0x24f261(0x13d)]&&_0x5c0855[_0x24f261(0x163)]==_0x732182[_0x24f261(0x163)]&&_0x5c0855[_0x24f261(0x11e)]==_0x732182[_0x24f261(0x11e)]&&_0x5c0855[_0x24f261(0x1c0)]==_0x732182[_0x24f261(0x1c0)]&&_0x5c0855[_0x24f261(0x10d)]==_0x732182[_0x24f261(0x10d)]&&_0x5c0855[_0x24f261(0x164)]==_0x732182[_0x24f261(0x164)]&&_0x5c0855['storage']==_0x732182[_0x24f261(0x13c)]&&_0x5c0855[_0x24f261(0x1b5)]==_0x732182[_0x24f261(0x1b5)]&&_0x5c0855[_0x24f261(0x183)]==_0x732182[_0x24f261(0x183)]&&_0x5c0855[_0x24f261(0xf4)]==_0x732182[_0x24f261(0xf4)]&&_0x5c0855['invoice']==_0x732182[_0x24f261(0x11a)]){var _0x24b11c;_0x24b11c=_0x732182[_0x24f261(0x156)],_0x732182[_0x24f261(0x18f)]=='S'&&(_0x24b11c=_0x732182['adjust_qty']),_0x5c0855['product_stock']=_0x5c0855['product_stock']-_0x24b11c;}}else{if(_0x5c0855['product_name']==_0x732182['product_name']&&_0x5c0855[_0x24f261(0x163)]==_0x732182[_0x24f261(0x163)]&&_0x5c0855[_0x24f261(0x11e)]==_0x732182[_0x24f261(0x11e)]&&_0x5c0855['bin']==_0x732182[_0x24f261(0x1c0)]&&_0x5c0855[_0x24f261(0x10d)]==_0x732182[_0x24f261(0x10d)]&&_0x5c0855[_0x24f261(0x164)]==_0x732182['rack']&&_0x5c0855['storage']==_0x732182['storage']&&_0x5c0855['expiry_date']==_0x732182[_0x24f261(0x1b5)]&&_0x5c0855['batch_code']==_0x732182[_0x24f261(0x183)]&&_0x5c0855[_0x24f261(0xf4)]==_0x732182['production_date']&&_0x5c0855[_0x24f261(0x11a)]==_0x732182['invoice']){console[_0x24f261(0x17f)](_0x732182);var _0x24b11c;_0x24b11c=_0x732182['adjust_qty'],_0x732182[_0x24f261(0x18f)]=='S'&&(_0x24b11c=_0x732182[_0x24f261(0x156)]),console['log'](_0x24b11c+'\x20<>\x20'+_0x732182[_0x24f261(0x156)]+'\x20<>\x20'+_0x5c0855['maxPerUnit']+_0x24f261(0x192)+_0x732182['prod_cat']),_0x5c0855[_0x24f261(0x16c)]=_0x5c0855['product_stock']+_0x24b11c;}}});}return _0x37e5f8;});Promise[_0xf7f015(0x13e)](_0x7ebba6)['then'](async _0x554056=>{var _0x2f9f2f=_0xf7f015;try{for(const _0x48c93b of _0x554056){await _0x48c93b['save']();}_0x493755[_0x2f9f2f(0x15c)]=_0x2f9f2f(0x17a);const _0x410781=await _0x493755[_0x2f9f2f(0x16e)](),_0x24849d=await master_shop[_0x2f9f2f(0x177)](),_0x401dd9=await email_settings[_0x2f9f2f(0x121)](),_0x15d0c2=await supervisor_settings[_0x2f9f2f(0x177)]();var _0x11782c=_0x493755[_0x2f9f2f(0x118)],_0x493f81='',_0x5c7035;for(_0x5c7035 in _0x11782c){_0x493f81+='<tr>'+_0x2f9f2f(0xfb)+_0x11782c[_0x5c7035][_0x2f9f2f(0x13d)]+_0x2f9f2f(0x14d)+_0x2f9f2f(0xfb)+_0x11782c[_0x5c7035][_0x2f9f2f(0x139)]+_0x2f9f2f(0x14d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x11782c[_0x5c7035][_0x2f9f2f(0x156)]+_0x2f9f2f(0x14d)+_0x2f9f2f(0xfb)+_0x11782c[_0x5c7035]['unit']+_0x2f9f2f(0x14d)+_0x2f9f2f(0xfb)+_0x11782c[_0x5c7035]['secondary_unit']+'</td>'+_0x2f9f2f(0xfb)+_0x493755['warehouse_name']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x11782c[_0x5c7035][_0x2f9f2f(0x141)]+_0x2f9f2f(0x14d)+_0x2f9f2f(0xfb)+_0x11782c[_0x5c7035]['storage']+_0x11782c[_0x5c7035][_0x2f9f2f(0x164)]+_0x11782c[_0x5c7035]['bay']+_0x11782c[_0x5c7035]['bin']+_0x11782c[_0x5c7035]['type'][0x0]+_0x11782c[_0x5c7035][_0x2f9f2f(0x163)]+_0x2f9f2f(0x14d),_0x2f9f2f(0x146);}let _0x380c5f=nodemailer[_0x2f9f2f(0x131)]({'host':_0x401dd9[_0x2f9f2f(0x128)],'port':Number(_0x401dd9['port']),'secure':![],'auth':{'user':_0x401dd9[_0x2f9f2f(0x1ae)],'pass':_0x401dd9['password']}}),_0x40072={'from':_0x401dd9[_0x2f9f2f(0x1ae)],'to':_0x15d0c2[0x0][_0x2f9f2f(0x126)],'subject':_0x2f9f2f(0x119),'attachments':[{'filename':_0x2f9f2f(0x154),'path':__dirname+'/../public'+_0x2f9f2f(0x112)+_0x24849d[0x0][_0x2f9f2f(0x184)],'cid':_0x2f9f2f(0x16a)}],'html':_0x2f9f2f(0x12c)+_0x2f9f2f(0xff)+_0x2f9f2f(0xee)+_0x2f9f2f(0x11d)+_0x2f9f2f(0x15d)+_0x2f9f2f(0x11d)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x2f9f2f(0x11d)+_0x2f9f2f(0x149)+_0x24849d[0x0][_0x2f9f2f(0x1a4)]+_0x2f9f2f(0x198)+'</div>'+'</div>'+_0x2f9f2f(0x155)+'<div>'+_0x2f9f2f(0xf7)+_0x2f9f2f(0x14a)+_0x493755[_0x2f9f2f(0x11a)]+'\x20'+_0x2f9f2f(0x1ba)+_0x2f9f2f(0x113)+_0x493755[_0x2f9f2f(0x12f)]+'\x20'+_0x2f9f2f(0x12b)+_0x2f9f2f(0x167)+_0x2f9f2f(0x124)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2f9f2f(0x1c8)+'<tr>'+_0x2f9f2f(0x102)+_0x2f9f2f(0xef)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x2f9f2f(0x1bd)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x2f9f2f(0x1a2)+_0x2f9f2f(0x1af)+_0x2f9f2f(0x165)+_0x2f9f2f(0x146)+_0x2f9f2f(0x106)+_0x2f9f2f(0x171)+'\x20'+_0x493f81+'\x20'+_0x2f9f2f(0x1b3)+'</table>'+_0x2f9f2f(0x11d)+_0x2f9f2f(0x1a7)+_0x2f9f2f(0x190)+_0x24849d[0x0][_0x2f9f2f(0x1a4)]+_0x2f9f2f(0x167)+'</div>'+_0x2f9f2f(0x124)+_0x2f9f2f(0x178)};_0x380c5f[_0x2f9f2f(0x1ad)](_0x40072,function(_0xa102ee,_0x4c8ec1){var _0x50b3e1=_0x2f9f2f;_0xa102ee?(console[_0x50b3e1(0x17f)](_0xa102ee),console[_0x50b3e1(0x17f)](_0x50b3e1(0x105))):console[_0x50b3e1(0x17f)](_0x50b3e1(0x1a3));}),_0x5e49f1[_0x2f9f2f(0x16b)](_0x2f9f2f(0x1c2),_0x2f9f2f(0x120)),_0x866967[_0x2f9f2f(0x10c)](_0x2f9f2f(0x14f)+_0x410781['_id']);}catch(_0x17568a){console['error'](_0x17568a),_0x866967['status'](0x1f4)[_0x2f9f2f(0x1ac)]({'error':_0x2f9f2f(0x173)});}})[_0xf7f015(0x1a1)](_0x590368=>{var _0x17d341=_0xf7f015;console[_0x17d341(0x182)](_0x590368),_0x866967[_0x17d341(0x13b)](0x1f4)[_0x17d341(0x1ac)]({'error':_0x17d341(0x130)});});}catch(_0x297406){console['log'](_0x297406),_0x866967[_0xf7f015(0x13b)](0xc8)[_0xf7f015(0x1ac)]({'message':_0x297406[_0xf7f015(0xfc)]});}}),router['get'](a0_0x1446cf(0x133),auth,async(_0x174659,_0xa4a130)=>{var _0x57f493=a0_0x1446cf;try{const {username:_0x17fcec,email:_0x451555,role:_0x37a0e2}=_0x174659['user'],_0x2389e5=_0x174659[_0x57f493(0x1b1)],_0x38819e=await profile[_0x57f493(0x121)]({'email':_0x2389e5[_0x57f493(0x1ae)]}),_0x21df1a=await master_shop[_0x57f493(0x177)](),_0x127d2f=_0x174659[_0x57f493(0x179)]['id'],_0x302609=await adjustment['findById']({'_id':_0x127d2f}),_0x31dd5b=await purchases[_0x57f493(0x10e)]([{'$match':{'warehouse_name':_0x302609[_0x57f493(0x166)]}},{'$unwind':_0x57f493(0xfd)},{'$group':{'_id':'$product.product_name'}}]),_0x10a9e3=await product[_0x57f493(0x177)]({}),_0x5b6d21=await warehouse['aggregate']([{'$match':{'name':_0x302609[_0x57f493(0x166)]}},{'$unwind':_0x57f493(0xec)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x57f493(0x123)},'product_stock':{'$first':_0x57f493(0x1c6)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x57f493(0x188)},'type':{'$first':_0x57f493(0x1c5)},'floorlevel':{'$first':_0x57f493(0x144)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x57f493(0x114)},'product_code':{'$first':_0x57f493(0x19f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x57f493(0x1ab)},'maxPerUnit':{'$first':_0x57f493(0x115)},'expiry_date':{'$first':_0x57f493(0x18a)},'production_date':{'$first':_0x57f493(0xf9)},'batch_code':{'$first':_0x57f493(0xf6)},'room':{'$first':_0x57f493(0x14e)}}}]);let _0x8715e;if(_0x2389e5[_0x57f493(0x17e)]=='staff'){const _0x684018=await staff[_0x57f493(0x121)]({'email':_0x2389e5[_0x57f493(0x1ae)]});_0x8715e=await warehouse[_0x57f493(0x10e)]([{'$match':{'status':_0x57f493(0x137),'name':_0x684018[_0x57f493(0x16f)],'warehouse_category':_0x57f493(0x162),'name':{'$ne':_0x57f493(0x157)}}},{'$group':{'_id':_0x57f493(0x189),'name':{'$first':'$name'}}}]);}else _0x8715e=await warehouse[_0x57f493(0x10e)]([{'$match':{'status':_0x57f493(0x137),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x57f493(0x157)}}},{'$group':{'_id':_0x57f493(0x189),'name':{'$first':'$name'}}}]);if(_0x21df1a[0x0][_0x57f493(0x170)]=='English\x20(US)'){var _0x4213e2=users[_0x57f493(0x1c4)];console[_0x57f493(0x17f)](_0x4213e2);}else{if(_0x21df1a[0x0]['language']==_0x57f493(0x117))var _0x4213e2=users[_0x57f493(0x117)];else{if(_0x21df1a[0x0][_0x57f493(0x170)]==_0x57f493(0xfa))var _0x4213e2=users['German'];else{if(_0x21df1a[0x0][_0x57f493(0x170)]==_0x57f493(0xf2))var _0x4213e2=users['Spanish'];else{if(_0x21df1a[0x0][_0x57f493(0x170)]==_0x57f493(0x109))var _0x4213e2=users[_0x57f493(0x109)];else{if(_0x21df1a[0x0][_0x57f493(0x170)]=='Portuguese\x20(BR)')var _0x4213e2=users[_0x57f493(0x15b)];else{if(_0x21df1a[0x0][_0x57f493(0x170)]==_0x57f493(0x199))var _0x4213e2=users['Chinese'];else{if(_0x21df1a[0x0][_0x57f493(0x170)]==_0x57f493(0x186))var _0x4213e2=users['Arabic'];}}}}}}}_0xa4a130[_0x57f493(0x1b0)](_0x57f493(0x108),{'success':_0x174659['flash'](_0x57f493(0x1c2)),'errors':_0x174659[_0x57f493(0x16b)](_0x57f493(0xf3)),'role':_0x2389e5,'profile':_0x38819e,'adjustment':_0x302609,'stock':_0x5b6d21,'master_shop':_0x21df1a,'warehouse_name':_0x31dd5b,'unit':_0x10a9e3,'language':_0x4213e2,'warehouse':_0x8715e});}catch(_0x1192bf){console[_0x57f493(0x17f)](_0x1192bf),_0xa4a130[_0x57f493(0x13b)](0xc8)['json']({'message':_0x1192bf[_0x57f493(0xfc)]});}}),router[a0_0x1446cf(0x11f)](a0_0x1446cf(0x133),auth,async(_0x1f9a32,_0x56e3fb)=>{var _0x3605a6=a0_0x1446cf;try{const _0x127221=_0x1f9a32[_0x3605a6(0x179)]['id'],_0x47d6bf=await adjustment[_0x3605a6(0x187)]({'_id':_0x127221}),_0x2ea7bc=await warehouse[_0x3605a6(0x121)]({'name':_0x47d6bf[_0x3605a6(0x166)],'room':_0x47d6bf[_0x3605a6(0x13f)]}),{warehouse_name:_0x1b327e,date:_0xe982da,prod_name:_0x1c76a2,level:_0x4d56ec,isle:_0x1b1882,pallet:_0x7f399c,stock:_0x124c8b,types:_0xd62ecb,adjust_qty:_0x58bbd2,new_adjust_qty:_0x33f875,note:_0xb84cde,Room_name:_0x48d8c8,invoice:_0x10dfc3,JO_number:_0x389bb2,expiry_date:_0xcdca78}=_0x1f9a32[_0x3605a6(0x122)];if(typeof _0x1c76a2==_0x3605a6(0x175))var _0x592620=[_0x1f9a32['body'][_0x3605a6(0x13a)]],_0x502ddd=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x11c)]],_0x1d400a=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0xed)]],_0x184fb1=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x12e)]],_0x3bb14c=[_0x1f9a32['body']['New_Qty_Converted_adj']],_0x2972ed=[_0x1f9a32['body']['New_Qty_Converted']],_0x23a1a3=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x194)]],_0x1a6589=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x168)]],_0x282d1a=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x12a)]],_0x4c9824=[_0x1f9a32['body'][_0x3605a6(0x183)]],_0x23f5da=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x1b5)]],_0x53a548=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x15f)]],_0x2f5431=[_0x1f9a32[_0x3605a6(0x122)]['production_date']],_0x1eee41=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x18f)]],_0x1ed267=[_0x1f9a32[_0x3605a6(0x122)]['Rooms']],_0x32b9a7=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x1c1)]],_0x41666d=[_0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x160)]];else var _0x592620=[..._0x1f9a32['body']['prod_name']],_0x502ddd=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x11c)]],_0x1d400a=[..._0x1f9a32[_0x3605a6(0x122)]['stock']],_0x184fb1=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x12e)]],_0x3bb14c=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x1be)]],_0x2972ed=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x17d)]],_0x23a1a3=[..._0x1f9a32['body'][_0x3605a6(0x12d)]],_0x1a6589=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x168)]],_0x282d1a=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x12a)]],_0x4c9824=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x183)]],_0x23f5da=[..._0x1f9a32[_0x3605a6(0x122)]['expiry_date']],_0x53a548=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x15f)]],_0x2f5431=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0xf4)]],_0x1eee41=[..._0x1f9a32['body'][_0x3605a6(0x18f)]],_0x1ed267=[..._0x1f9a32[_0x3605a6(0x122)]['Rooms']],_0x32b9a7=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x1c1)]],_0x41666d=[..._0x1f9a32[_0x3605a6(0x122)][_0x3605a6(0x160)]];const _0x4902be=_0x592620['map'](_0x2ac4b0=>{return _0x2ac4b0={'product_name':_0x2ac4b0};});_0x502ddd[_0x3605a6(0x11b)]((_0x5b8543,_0x40a373)=>{_0x1ed267['forEach']((_0x393b35,_0xf45c1d)=>{var _0x53c56a=a0_0x2f1c;if(_0x393b35=='Receiving\x20Area'&&_0x40a373==_0xf45c1d){var _0x25304d=_0x5b8543[_0x53c56a(0x1a5)](0x3);_0x4902be[_0x40a373][_0x53c56a(0x13c)]=_0x5b8543[0x0],_0x4902be[_0x40a373][_0x53c56a(0x164)]=_0x5b8543[0x1],_0x4902be[_0x40a373][_0x53c56a(0x10d)]=0x0,_0x4902be[_0x40a373][_0x53c56a(0x1c0)]=0x0,_0x4902be[_0x40a373][_0x53c56a(0x11e)]=_0x53c56a(0x1a8),_0x4902be[_0x40a373]['floorlevel']=_0x25304d;}else{if(_0x393b35=='Shelves'&&_0x40a373==_0xf45c1d){var _0x25304d=_0x5b8543[_0x53c56a(0x1a5)](0x3);_0x4902be[_0x40a373][_0x53c56a(0x13c)]=_0x5b8543[0x0],_0x4902be[_0x40a373][_0x53c56a(0x164)]=_0x5b8543[0x1],_0x4902be[_0x40a373]['bay']=0x0,_0x4902be[_0x40a373][_0x53c56a(0x1c0)]=0x0,_0x4902be[_0x40a373][_0x53c56a(0x11e)]=_0x53c56a(0x1a8),_0x4902be[_0x40a373][_0x53c56a(0x163)]=_0x5b8543[0x5];}else{if(_0x40a373==_0xf45c1d){var _0x341088;if(_0x5b8543[0x4]=='L')_0x341088=_0x53c56a(0x19b);else _0x5b8543[0x4]=='F'&&(_0x341088=_0x53c56a(0x1a8));_0x4902be[_0x40a373][_0x53c56a(0x13c)]=_0x5b8543[0x0],_0x4902be[_0x40a373][_0x53c56a(0x164)]=_0x5b8543[0x1],_0x4902be[_0x40a373]['bay']=_0x5b8543[0x2],_0x4902be[_0x40a373][_0x53c56a(0x1c0)]=_0x5b8543[0x3],_0x4902be[_0x40a373][_0x53c56a(0x11e)]=_0x341088,_0x4902be[_0x40a373]['floorlevel']=_0x5b8543[0x5];}}}});}),_0x1d400a[_0x3605a6(0x11b)]((_0xe5039,_0x579d9b)=>{var _0x26587b=_0x3605a6;_0x4902be[_0x579d9b][_0x26587b(0x18c)]=_0xe5039;}),_0x184fb1[_0x3605a6(0x11b)]((_0x2767f8,_0x519c82)=>{_0x4902be[_0x519c82]['types']=_0x2767f8;}),_0x3bb14c[_0x3605a6(0x11b)]((_0x4d3ee2,_0x2a8d5e)=>{var _0x1a82a2=_0x3605a6;_0x4902be[_0x2a8d5e][_0x1a82a2(0x156)]=_0x4d3ee2;}),_0x2972ed[_0x3605a6(0x11b)]((_0x148c37,_0x1a3c6d)=>{_0x4902be[_0x1a3c6d]['new_adjust_qty']=_0x148c37;}),_0x23a1a3[_0x3605a6(0x11b)]((_0x57c6c2,_0x4b0a89)=>{var _0xdb2418=_0x3605a6;_0x4902be[_0x4b0a89][_0xdb2418(0x12d)]=_0x57c6c2;}),_0x1a6589[_0x3605a6(0x11b)]((_0x4ca45f,_0x2b489f)=>{var _0x19c624=_0x3605a6;_0x4902be[_0x2b489f][_0x19c624(0x127)]=_0x4ca45f;}),_0x282d1a[_0x3605a6(0x11b)]((_0x2f7e0d,_0x54eedf)=>{var _0x1fd0e6=_0x3605a6;_0x4902be[_0x54eedf][_0x1fd0e6(0x139)]=_0x2f7e0d;}),_0x4c9824[_0x3605a6(0x11b)]((_0x1ed2ee,_0xf71c97)=>{_0x4902be[_0xf71c97]['batch_code']=_0x1ed2ee;}),_0x23f5da[_0x3605a6(0x11b)]((_0x5cd68f,_0x19536b)=>{var _0x400c63=_0x3605a6;_0x4902be[_0x19536b][_0x400c63(0x1b5)]=_0x5cd68f;}),_0x53a548['forEach']((_0x5da2ed,_0x4cefda)=>{_0x4902be[_0x4cefda]['maxperunit']=_0x5da2ed;}),_0x2f5431[_0x3605a6(0x11b)]((_0x27fecf,_0x24a2b5)=>{var _0x1e61c6=_0x3605a6;_0x4902be[_0x24a2b5][_0x1e61c6(0xf4)]=_0x27fecf;}),_0x1eee41[_0x3605a6(0x11b)]((_0x4582e7,_0x101e82)=>{_0x4902be[_0x101e82]['prod_cat']=_0x4582e7;}),_0x1ed267[_0x3605a6(0x11b)]((_0x37bbd2,_0x5c4afe)=>{var _0x4c82f8=_0x3605a6;_0x4902be[_0x5c4afe][_0x4c82f8(0x141)]=_0x37bbd2;}),_0x32b9a7[_0x3605a6(0x11b)]((_0x394101,_0x352c81)=>{var _0x3dd0d5=_0x3605a6;_0x4902be[_0x352c81][_0x3dd0d5(0x1b9)]=_0x394101;}),_0x41666d['forEach']((_0x2c2b0c,_0x43699a)=>{var _0x2f5f3f=_0x3605a6;_0x4902be[_0x43699a][_0x2f5f3f(0x142)]=_0x2c2b0c;});const _0x3827dd=_0x4902be['filter'](_0x4b64e4=>_0x4b64e4['adjust_qty']!=='0'&&_0x4b64e4['adjust_qty']!=='');var _0x538a33=0x0;_0x3827dd[_0x3605a6(0x11b)](_0xacb26e=>{var _0x4ce202=_0x3605a6;console[_0x4ce202(0x17f)](_0x4ce202(0x161),_0xacb26e),parseInt(_0xacb26e[_0x4ce202(0x156)])<=0x0&&_0x538a33++;});if(_0x538a33!=0x0)return _0x1f9a32[_0x3605a6(0x16b)](_0x3605a6(0xf3),_0x3605a6(0x16d)),_0x56e3fb['redirect']('back');_0x47d6bf['warehouse_name']=_0x1b327e,_0x47d6bf[_0x3605a6(0x12f)]=_0xe982da,_0x47d6bf['product']=_0x3827dd,_0x47d6bf['note']=_0xb84cde,_0x47d6bf[_0x3605a6(0x11a)]=_0x10dfc3,_0x47d6bf['isAllowEdit']=_0x3605a6(0x116);const _0x2bd008=await _0x47d6bf['save']();_0x1f9a32[_0x3605a6(0x16b)](_0x3605a6(0x1c2),_0x3605a6(0x185)),_0x56e3fb[_0x3605a6(0x10c)](_0x3605a6(0x159));}catch(_0xa917e6){console[_0x3605a6(0x17f)](_0xa917e6);}}),router[a0_0x1446cf(0x11f)](a0_0x1446cf(0x153),async(_0x33c756,_0x5efea5)=>{var _0x14fe02=a0_0x1446cf;const {primary_code:_0x2e8444,warehouse_data:_0x31a763,rooms_data:_0x58e762,Roomslist:_0x58c80a}=_0x33c756[_0x14fe02(0x122)],_0x3bb837=_0x58c80a['split'](','),_0x14e7b9=[];async function _0x3b8a53(_0x487a17){var _0x1e09a3=_0x14fe02;const _0x4bdc55=await warehouse[_0x1e09a3(0x10e)]([{'$match':{'name':_0x31a763,'room':_0x487a17}},{'$unwind':_0x1e09a3(0xec)},{'$match':{'product_details.primary_code':_0x2e8444}},{'$group':{'_id':_0x1e09a3(0x138),'name':{'$first':_0x1e09a3(0x123)},'product_stock':{'$first':_0x1e09a3(0x1c6)},'primary_code':{'$first':_0x1e09a3(0x107)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1e09a3(0x19f)},'level':{'$first':_0x1e09a3(0x147)},'isle':{'$first':_0x1e09a3(0x188)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1e09a3(0x144)},'unit':{'$first':_0x1e09a3(0x1b8)},'secondary_unit':{'$first':_0x1e09a3(0x150)},'storage':{'$first':_0x1e09a3(0x134)},'rack':{'$first':_0x1e09a3(0x1ab)},'expiry_date':{'$first':_0x1e09a3(0x18a)},'production_date':{'$first':_0x1e09a3(0xf9)},'maxPerUnit':{'$first':_0x1e09a3(0x115)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x1e09a3(0x143)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1e09a3(0x14e)}}}]),_0x395915=await warehouse[_0x1e09a3(0x10e)]([{'$match':{'name':_0x31a763,'room':_0x487a17}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2e8444}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1e09a3(0x123)},'product_stock':{'$first':_0x1e09a3(0x1c6)},'primary_code':{'$first':_0x1e09a3(0x107)},'secondary_code':{'$first':_0x1e09a3(0x114)},'product_code':{'$first':_0x1e09a3(0x19f)},'level':{'$first':_0x1e09a3(0x147)},'isle':{'$first':_0x1e09a3(0x188)},'type':{'$first':_0x1e09a3(0x1c5)},'pallet':{'$first':_0x1e09a3(0x144)},'unit':{'$first':_0x1e09a3(0x1b8)},'secondary_unit':{'$first':_0x1e09a3(0x150)},'storage':{'$first':_0x1e09a3(0x134)},'rack':{'$first':_0x1e09a3(0x1ab)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x1e09a3(0xf6)},'product_cat':{'$first':_0x1e09a3(0x143)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1e09a3(0x14e)}}}]);if(_0x4bdc55[_0x1e09a3(0x1c7)]>0x0)_0x14e7b9[_0x1e09a3(0xfe)](_0x4bdc55);else _0x395915[_0x1e09a3(0x1c7)]>0x0&&_0x14e7b9[_0x1e09a3(0xfe)](_0x395915);}const _0x2e8fd5=_0x3bb837[_0x14fe02(0x19e)](_0x24ed6e=>_0x3b8a53(_0x24ed6e));await Promise[_0x14fe02(0x13e)](_0x2e8fd5),_0x5efea5['json'](_0x14e7b9);}),router[a0_0x1446cf(0x11f)](a0_0x1446cf(0x19d),async(_0x3eb359,_0x4080ad)=>{var _0x5cfad2=a0_0x1446cf;const {primaryCode:_0x483458,secondaryCode:_0x3daae8,productCode:_0x52e655,level:_0x258f4f,isle:_0x1c68cc,pallet:_0x259172,warehouses:_0x18b7fd,room:_0x5e8bd8}=_0x3eb359['body'];try{const _0x4fcb12=await warehouse['aggregate']([{'$match':{'name':_0x18b7fd,'room':_0x5e8bd8}},{'$unwind':_0x5cfad2(0xec)},{'$match':{'product_details.level':parseInt(_0x258f4f),'product_details.isle':_0x1c68cc,'product_details.pallet':parseInt(_0x259172)}},{'$group':{'_id':_0x5cfad2(0x138),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5cfad2(0x1c6)},'level':{'$first':_0x5cfad2(0x103)},'isle':{'$first':_0x5cfad2(0x1bc)},'pallet':{'$first':_0x5cfad2(0x110)},'maxProducts':{'$first':_0x5cfad2(0x129)}}}]);_0x4080ad[_0x5cfad2(0x13b)](0xc8)[_0x5cfad2(0x1ac)](_0x4fcb12);}catch(_0x4fddb4){_0x4080ad['status'](0x194)[_0x5cfad2(0x1ac)]({'message':_0x4fddb4[_0x5cfad2(0xfc)]});}}),module[a0_0x1446cf(0x152)]=router;