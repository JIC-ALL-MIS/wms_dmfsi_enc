var a0_0x1dc58c=a0_0x5a31;(function(_0x4d0432,_0x29d629){var _0x3ca0c8=a0_0x5a31,_0x460123=_0x4d0432();while(!![]){try{var _0x391566=-parseInt(_0x3ca0c8(0xd1))/0x1+-parseInt(_0x3ca0c8(0xd0))/0x2+parseInt(_0x3ca0c8(0xe9))/0x3+-parseInt(_0x3ca0c8(0xe8))/0x4*(-parseInt(_0x3ca0c8(0x101))/0x5)+-parseInt(_0x3ca0c8(0x126))/0x6*(parseInt(_0x3ca0c8(0x137))/0x7)+parseInt(_0x3ca0c8(0x123))/0x8+-parseInt(_0x3ca0c8(0x152))/0x9;if(_0x391566===_0x29d629)break;else _0x460123['push'](_0x460123['shift']());}catch(_0x2b7ec7){_0x460123['push'](_0x460123['shift']());}}}(a0_0x2803,0xbefe6));function a0_0x5a31(_0x3ed184,_0x1ba217){var _0x2803e4=a0_0x2803();return a0_0x5a31=function(_0x5a3154,_0x59752e){_0x5a3154=_0x5a3154-0xbf;var _0x21e4a4=_0x2803e4[_0x5a3154];return _0x21e4a4;},a0_0x5a31(_0x3ed184,_0x1ba217);}const express=require(a0_0x1dc58c(0x13d)),app=express(),router=express[a0_0x1dc58c(0xc3)](),auth=require(a0_0x1dc58c(0xce)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1dc58c(0x124)),users=require(a0_0x1dc58c(0x135)),nodemailer=require(a0_0x1dc58c(0x119));router[a0_0x1dc58c(0x17b)](a0_0x1dc58c(0xe4),auth,async(_0x48a5a4,_0x39067d)=>{var _0x306c35=a0_0x1dc58c;try{const {username:_0x2895e7,email:_0xbd62b1,role:_0x251d49}=_0x48a5a4[_0x306c35(0x12e)],_0x1027a9=_0x48a5a4[_0x306c35(0x12e)],_0x421f67=await profile[_0x306c35(0x139)]({'email':_0x1027a9['email']}),_0x172161=await master_shop[_0x306c35(0x15f)]();console[_0x306c35(0x192)](_0x306c35(0x14d),_0x172161);let _0x367498;if(_0x1027a9[_0x306c35(0xdd)]==_0x306c35(0xf6)){const _0x3dc7c4=await staff[_0x306c35(0x139)]({'email':_0x1027a9[_0x306c35(0xde)]});_0x367498=await warehouse[_0x306c35(0x15f)]({'status':_0x306c35(0x160),'name':_0x3dc7c4[_0x306c35(0x15e)]});}else _0x367498=await warehouse[_0x306c35(0x15f)]({'status':_0x306c35(0x160)});const _0x596f80=await product[_0x306c35(0x15f)]();let _0x1fc920;if(_0x1027a9[_0x306c35(0xdd)]==_0x306c35(0xf6)){const _0x3ecffa=await staff[_0x306c35(0x139)]({'email':_0x1027a9[_0x306c35(0xde)]});_0x1fc920=await adjustment[_0x306c35(0x15f)]({'warehouse_name':_0x3ecffa['warehouse']});}else _0x1fc920=await adjustment[_0x306c35(0x148)]([{'$unwind':'$product'},{'$group':{'_id':_0x306c35(0xec),'invoice':{'$first':'$invoice'},'date':{'$first':_0x306c35(0x11f)},'warehouse_name':{'$first':_0x306c35(0x157)},'room':{'$addToSet':_0x306c35(0x183)},'finalize':{'$first':_0x306c35(0xf0)},'isAllowEdit':{'$first':_0x306c35(0x187)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x172161[0x0]['language']=='English\x20(US)'){var _0x57518b=users['English'];console[_0x306c35(0x192)](_0x57518b);}else{if(_0x172161[0x0]['language']==_0x306c35(0x188))var _0x57518b=users[_0x306c35(0x188)];else{if(_0x172161[0x0][_0x306c35(0x151)]=='German')var _0x57518b=users[_0x306c35(0x145)];else{if(_0x172161[0x0][_0x306c35(0x151)]==_0x306c35(0x16f))var _0x57518b=users[_0x306c35(0x16f)];else{if(_0x172161[0x0][_0x306c35(0x151)]==_0x306c35(0xbf))var _0x57518b=users[_0x306c35(0xbf)];else{if(_0x172161[0x0][_0x306c35(0x151)]=='Portuguese\x20(BR)')var _0x57518b=users[_0x306c35(0x115)];else{if(_0x172161[0x0][_0x306c35(0x151)]==_0x306c35(0x12b))var _0x57518b=users['Chinese'];else{if(_0x172161[0x0]['language']==_0x306c35(0x100))var _0x57518b=users[_0x306c35(0x182)];}}}}}}}_0x39067d[_0x306c35(0x14e)](_0x306c35(0xcc),{'success':_0x48a5a4[_0x306c35(0xd4)](_0x306c35(0x155)),'errors':_0x48a5a4['flash'](_0x306c35(0x150)),'role':_0x1027a9,'profile':_0x421f67,'warehouse':_0x367498,'product':_0x596f80,'adjustment':_0x1fc920,'master_shop':_0x172161,'language':_0x57518b});}catch(_0x4d8a33){console[_0x306c35(0x192)](_0x4d8a33);}});async function getRandom8DigitNumber(){var _0x43cab8=a0_0x1dc58c;const _0x586e83=0x989680,_0x566b4c=0x5f5e0ff,_0x2a1859=Math[_0x43cab8(0xf1)](Math[_0x43cab8(0x11c)]()*(_0x566b4c-_0x586e83+0x1))+_0x586e83;var _0x4c6dde;const _0x1e1e7f=await adjustment[_0x43cab8(0x139)]({'invoice':_0x43cab8(0x118)+_0x2a1859});return _0x1e1e7f&&_0x1e1e7f[_0x43cab8(0xdb)]>0x0?_0x4c6dde=_0x43cab8(0x118)+_0x2a1859:_0x4c6dde=_0x43cab8(0x118)+_0x2a1859,_0x4c6dde;}function a0_0x2803(){var _0x1378b2=['secondary_code','\x20Order\x20Number\x20:\x20','<h2>\x20','$product_details.primary_code','English','<h5>','product_stock','invoice','finalize','primary_code','Raw\x20Materials','/upload/','$product_details.secondary_unit','$product_details.product_code','</tr>','$product_details.storage','Portuguese','Level','createTransport','ADJ-','nodemailer','findById','adjustment\x20data\x20update\x20successfully','random','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$date','unit','logo','prime1','9346728jUIJOv','../models/all_models','storage','306132ADtKOp','room_names','$room','Logo.png','$product_details.pallet','Chinese','</h5>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','user','back','product_name','/preview/:id','expiry_date','bin','$product_details','../public/language/languages.json','isAllowEdit','35OopSGZ','/adjustment/preview/','findOne','$product_details.production_date','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.batch_code','express','password','prod_code','Return\x20Goods','floorlevel','/barcode_scanner','<html><head><title></title>','body','German','add_adjustment','</td>','aggregate','prod_cat','</head><body>','New_Qty_Converted','</div>','master','render','split','errors','language','9250389PZbaqu','$product_details.secondary_code','type','success','$product_details.maxPerUnit','$warehouse_name','\x20Order\x20Date\x20:\x20','date','new_adjust_qty','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.bay','warehouse','find','Enabled','image','<strong>\x20Regards\x20</strong>','bay','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','json','slice','Return\x20Rooms','warehouse_name','<hr\x20class=\x22my-3\x22>','/CheckingWarehouse','site_title','Spanish','\x20<>\x20','$product_details.unit','params','</tbody>','$product_details.maxProducts','$product_details.isle','foreach\x20newproduct','message','<tr>','False','Email\x20sent\x20successfully','get','maxperunit','stockBefore','production_date','$product_details.type','$name','forEach','Arabic','$product.room_names','$product','save','batch_code','$isAllowEdit','Hindi','$product_details.product_stock','host','Receiving\x20Area','adjustment\x20add\x20successfull','$product_details.bin','rack','level','RMSEmail','push','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','minus','note','French','error','$product.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Router','</table>','English\x20(US)','$product_details.floorlevel','product','/view/:id','sendMail','redirect','types','adjustment','second1','../middleware/auth','stock','322754BECxYt','378027VsErYN','Shelves','max_per_unit','flash','Ambient','product_code','$product_details.expiry_date','maxPerUnit','$product_details.rack','</body></html>','length','Portuguese\x20(BR)','role','email','edit_adjustment_view','$product_details._id','Secondary_units','edit_adjustment','port','/view','prod_invoice','all','string','24224xWdiEq','3909216xDdaem','post','map','$_id','status','Adjustment\x20Mail','adjust_qty','$finalize','floor','Floor','Rooms','prod_name','_id','staff','/adjustment/view','Error\x20Occurs','New_Qty_Converted_adj','$product_details.level','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Primary_Units','<!DOCTYPE\x20html>','then','<span\x20style=\x22float:\x20right;\x22>','Arabic\x20(ae)','110XPvUPo','$product_details.product_name','<div>','exports'];a0_0x2803=function(){return _0x1378b2;};return a0_0x2803();}router[a0_0x1dc58c(0x17b)]('/view/add_adjustment',auth,async(_0x1cbb39,_0x588265)=>{var _0x2de940=a0_0x1dc58c;try{const {username:_0x3e2754,email:_0x4e73a1,role:_0x2ae7c1}=_0x1cbb39[_0x2de940(0x12e)],_0x2143ed=_0x1cbb39['user'],_0x13b056=await profile[_0x2de940(0x139)]({'email':_0x2143ed[_0x2de940(0xde)]}),_0xa83872=await master_shop[_0x2de940(0x15f)]();let _0x1b6d27;if(_0x2143ed[_0x2de940(0xdd)]==_0x2de940(0xf6)){const _0x169161=await staff[_0x2de940(0x139)]({'email':_0x2143ed[_0x2de940(0xde)]});_0x1b6d27=await warehouse[_0x2de940(0x148)]([{'$match':{'status':_0x2de940(0x160),'name':_0x169161[_0x2de940(0x15e)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x2de940(0x140)}}},{'$group':{'_id':_0x2de940(0x180),'name':{'$first':_0x2de940(0x180)}}}]);}else _0x1b6d27=await warehouse[_0x2de940(0x148)]([{'$match':{'status':_0x2de940(0x160),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x2de940(0x140)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x37efd2=await product['find']({}),_0xf8864e=await adjustment[_0x2de940(0x15f)]({}),_0x7ef00d=_0xf8864e['length']+0x1,_0xc12f02='ADJ-'+_0x7ef00d['toString']()['padStart'](0x5,'0');var _0x380be3=[_0x2de940(0xd5),'Enclosed',_0x2de940(0x16a)];if(_0xa83872[0x0][_0x2de940(0x151)]==_0x2de940(0xc5))var _0x12dd9a=users[_0x2de940(0x109)];else{if(_0xa83872[0x0][_0x2de940(0x151)]=='Hindi')var _0x12dd9a=users[_0x2de940(0x188)];else{if(_0xa83872[0x0][_0x2de940(0x151)]==_0x2de940(0x145))var _0x12dd9a=users[_0x2de940(0x145)];else{if(_0xa83872[0x0][_0x2de940(0x151)]==_0x2de940(0x16f))var _0x12dd9a=users[_0x2de940(0x16f)];else{if(_0xa83872[0x0][_0x2de940(0x151)]=='French')var _0x12dd9a=users[_0x2de940(0xbf)];else{if(_0xa83872[0x0][_0x2de940(0x151)]==_0x2de940(0xdc))var _0x12dd9a=users[_0x2de940(0x115)];else{if(_0xa83872[0x0]['language']==_0x2de940(0x12b))var _0x12dd9a=users[_0x2de940(0x12b)];else{if(_0xa83872[0x0][_0x2de940(0x151)]==_0x2de940(0x100))var _0x12dd9a=users[_0x2de940(0x182)];}}}}}}}const _0x417c3c=getRandom8DigitNumber();_0x417c3c['then'](_0x1a0c29=>{var _0x190f75=_0x2de940;_0x588265[_0x190f75(0x14e)](_0x190f75(0x146),{'success':_0x1cbb39[_0x190f75(0xd4)](_0x190f75(0x155)),'errors':_0x1cbb39[_0x190f75(0xd4)]('errors'),'role':_0x2143ed,'profile':_0x13b056,'warehouse':_0x1b6d27,'product':_0x37efd2,'master_shop':_0xa83872,'language':_0x12dd9a,'rooms_data':_0x380be3,'invoice_no':_0x1a0c29});})['catch'](_0x24cde7=>{var _0x5df94b=_0x2de940;_0x1cbb39['flash'](_0x5df94b(0x150),_0x5df94b(0xfb)),_0x588265[_0x5df94b(0xca)](_0x5df94b(0xf7));});}catch(_0x28bed5){console[_0x2de940(0x192)](_0x28bed5);}}),router[a0_0x1dc58c(0xea)]('/view/add_adjustment',auth,async(_0x14491b,_0x4f1f10)=>{var _0x5d23ac=a0_0x1dc58c;try{const {warehouse_name:_0x3cea26,date:_0x41affc,prod_name:_0x5e3e3e,level:_0x2d7f25,isle:_0x2a0900,pallet:_0x3ccf01,stock:_0x2dadc8,types:_0x1acdf5,adjust_qty:_0x1be01c,new_adjust_qty:_0x5e0484,note:_0x466797,Room_name:_0x2eb75c,invoice:_0x21704a,JO_number:_0x561d83,expiry_date:_0x3a289a}=_0x14491b[_0x5d23ac(0x144)];if(typeof _0x5e3e3e=='string')var _0x1e4d84=[_0x14491b[_0x5d23ac(0x144)]['prod_name']],_0x310f23=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x18f)]],_0xbb55a5=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xcf)]],_0x4b8c64=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xcb)]],_0x28a15a=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xf9)]],_0xea500b=[_0x14491b[_0x5d23ac(0x144)]['New_Qty_Converted']],_0x5eac52=[_0x14491b['body'][_0x5d23ac(0xfc)]],_0x17ec38=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xe1)]],_0x57bfc0=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x13f)]],_0x26da61=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x186)]],_0x51dd75=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x132)]],_0x43a9ae=[_0x14491b['body'][_0x5d23ac(0xd3)]],_0x47d49f=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x17e)]],_0x208e0e=[_0x14491b[_0x5d23ac(0x144)]['prod_cat']],_0x5a047b=[_0x14491b[_0x5d23ac(0x144)]['Rooms']],_0x5e0c23=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x122)]],_0x5b5612=[_0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xcd)]],_0x2f8a3d=[_0x14491b[_0x5d23ac(0x144)]['prod_invoice']];else var _0x1e4d84=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xf4)]],_0x310f23=[..._0x14491b['body'][_0x5d23ac(0x18f)]],_0xbb55a5=[..._0x14491b['body'][_0x5d23ac(0xcf)]],_0x4b8c64=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xcb)]],_0x28a15a=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xf9)]],_0xea500b=[..._0x14491b['body'][_0x5d23ac(0x14b)]],_0x5eac52=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x120)]],_0x17ec38=[..._0x14491b[_0x5d23ac(0x144)]['Secondary_units']],_0x57bfc0=[..._0x14491b['body'][_0x5d23ac(0x13f)]],_0x26da61=[..._0x14491b[_0x5d23ac(0x144)]['batch_code']],_0x51dd75=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x132)]],_0x43a9ae=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xd3)]],_0x47d49f=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x17e)]],_0x208e0e=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0x149)]],_0x5a047b=[..._0x14491b['body'][_0x5d23ac(0xf3)]],_0x5e0c23=[..._0x14491b[_0x5d23ac(0x144)]['prime1']],_0x5b5612=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xcd)]],_0x2f8a3d=[..._0x14491b[_0x5d23ac(0x144)][_0x5d23ac(0xe5)]];const _0x41075b=_0x1e4d84['map'](_0x5ab0c9=>{return _0x5ab0c9={'product_name':_0x5ab0c9};});_0x310f23[_0x5d23ac(0x181)]((_0x1da9a0,_0x251f22)=>{var _0x28ae74=_0x5d23ac;_0x5a047b[_0x28ae74(0x181)]((_0x6fd3c1,_0x52d853)=>{var _0x1e3cc2=_0x28ae74;if(_0x6fd3c1==_0x1e3cc2(0x18b)&&_0x251f22==_0x52d853){var _0x2e0a7d=_0x1da9a0[_0x1e3cc2(0x169)](0x3);_0x41075b[_0x251f22][_0x1e3cc2(0x125)]=_0x1da9a0[0x0],_0x41075b[_0x251f22][_0x1e3cc2(0x18e)]=_0x1da9a0[0x1],_0x41075b[_0x251f22]['bay']=0x0,_0x41075b[_0x251f22][_0x1e3cc2(0x133)]=0x0,_0x41075b[_0x251f22][_0x1e3cc2(0x154)]=_0x1e3cc2(0xf2),_0x41075b[_0x251f22][_0x1e3cc2(0x141)]=_0x2e0a7d;}else{if(_0x6fd3c1==_0x1e3cc2(0xd2)&&_0x251f22==_0x52d853){var _0x2e0a7d=_0x1da9a0[_0x1e3cc2(0x169)](0x3);_0x41075b[_0x251f22]['storage']=_0x1da9a0[0x0],_0x41075b[_0x251f22][_0x1e3cc2(0x18e)]=_0x1da9a0[0x1],_0x41075b[_0x251f22][_0x1e3cc2(0x163)]=0x0,_0x41075b[_0x251f22][_0x1e3cc2(0x133)]=0x0,_0x41075b[_0x251f22][_0x1e3cc2(0x154)]=_0x1e3cc2(0xf2),_0x41075b[_0x251f22]['floorlevel']=_0x1da9a0[0x5];}else{if(_0x251f22==_0x52d853){var _0x11ed3d;if(_0x1da9a0[0x4]=='L')_0x11ed3d=_0x1e3cc2(0x116);else _0x1da9a0[0x4]=='F'&&(_0x11ed3d='Floor');_0x41075b[_0x251f22][_0x1e3cc2(0x125)]=_0x1da9a0[0x0],_0x41075b[_0x251f22]['rack']=_0x1da9a0[0x1],_0x41075b[_0x251f22]['bay']=_0x1da9a0[0x2],_0x41075b[_0x251f22][_0x1e3cc2(0x133)]=_0x1da9a0[0x3],_0x41075b[_0x251f22][_0x1e3cc2(0x154)]=_0x11ed3d,_0x41075b[_0x251f22][_0x1e3cc2(0x141)]=_0x1da9a0[0x5];}}}});}),_0xbb55a5[_0x5d23ac(0x181)]((_0x1f3120,_0x518154)=>{var _0x14be4f=_0x5d23ac;_0x41075b[_0x518154][_0x14be4f(0x17d)]=_0x1f3120;}),_0x4b8c64['forEach']((_0x116e08,_0x159dbf)=>{var _0xe43b30=_0x5d23ac;_0x41075b[_0x159dbf][_0xe43b30(0xcb)]=_0x116e08;}),_0x28a15a[_0x5d23ac(0x181)]((_0x363f90,_0x306ba3)=>{var _0x3bfb5e=_0x5d23ac;_0x41075b[_0x306ba3][_0x3bfb5e(0xef)]=_0x363f90;}),_0xea500b[_0x5d23ac(0x181)]((_0x22f377,_0x54d9a8)=>{var _0x57017f=_0x5d23ac;_0x41075b[_0x54d9a8][_0x57017f(0x15a)]=_0x22f377;}),_0x5eac52['forEach']((_0x46d522,_0x469342)=>{var _0x2eb9d1=_0x5d23ac;_0x41075b[_0x469342][_0x2eb9d1(0x120)]=_0x46d522;}),_0x17ec38['forEach']((_0x548965,_0x273fa5)=>{var _0x55919e=_0x5d23ac;_0x41075b[_0x273fa5][_0x55919e(0x164)]=_0x548965;}),_0x57bfc0[_0x5d23ac(0x181)]((_0x1180a3,_0x14e0a0)=>{var _0x358f5f=_0x5d23ac;_0x41075b[_0x14e0a0][_0x358f5f(0xd6)]=_0x1180a3;}),_0x26da61[_0x5d23ac(0x181)]((_0x91ca34,_0x1c8c84)=>{var _0xf78168=_0x5d23ac;_0x41075b[_0x1c8c84][_0xf78168(0x186)]=_0x91ca34;}),_0x51dd75[_0x5d23ac(0x181)]((_0x55220d,_0x4c2b49)=>{_0x41075b[_0x4c2b49]['expiry_date']=_0x55220d;}),_0x43a9ae[_0x5d23ac(0x181)]((_0xe85a7a,_0x3f2d4d)=>{var _0x4cf4e4=_0x5d23ac;_0x41075b[_0x3f2d4d][_0x4cf4e4(0x17c)]=_0xe85a7a;}),_0x47d49f[_0x5d23ac(0x181)]((_0x490f8e,_0x5c37c3)=>{_0x41075b[_0x5c37c3]['production_date']=_0x490f8e;}),_0x208e0e[_0x5d23ac(0x181)]((_0x483c29,_0x4b412f)=>{var _0x1aa8aa=_0x5d23ac;_0x41075b[_0x4b412f][_0x1aa8aa(0x149)]=_0x483c29;}),_0x5a047b[_0x5d23ac(0x181)]((_0x3085ea,_0xbdd784)=>{var _0x2a084f=_0x5d23ac;_0x41075b[_0xbdd784][_0x2a084f(0x127)]=_0x3085ea;}),_0x5e0c23[_0x5d23ac(0x181)]((_0x4d35b2,_0x4707c2)=>{var _0x4f92c9=_0x5d23ac;_0x41075b[_0x4707c2][_0x4f92c9(0x10e)]=_0x4d35b2;}),_0x5b5612[_0x5d23ac(0x181)]((_0x1976d1,_0x426531)=>{var _0x5de2c8=_0x5d23ac;_0x41075b[_0x426531][_0x5de2c8(0x105)]=_0x1976d1;}),_0x2f8a3d[_0x5d23ac(0x181)]((_0xc2537b,_0x29a0b1)=>{_0x41075b[_0x29a0b1]['invoice']=_0xc2537b;});const _0x67d945=_0x41075b['filter'](_0x17aedf=>_0x17aedf['adjust_qty']!=='0'&&_0x17aedf[_0x5d23ac(0xef)]!=='');var _0x57486b=0x0;_0x67d945[_0x5d23ac(0x181)](_0x201a0f=>{var _0x109ec0=_0x5d23ac;console['log'](_0x109ec0(0x176),_0x201a0f),parseInt(_0x201a0f[_0x109ec0(0xef)])<=0x0&&_0x57486b++;});if(_0x57486b!=0x0)return _0x14491b[_0x5d23ac(0xd4)](_0x5d23ac(0x150),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x4f1f10[_0x5d23ac(0xca)]('back');const _0x1d6990=new adjustment({'warehouse_name':_0x3cea26,'date':_0x41affc,'product':_0x67d945,'note':_0x466797,'room':_0x2eb75c,'invoice':_0x21704a,'JO_number':_0x561d83,'expiry_date':_0x3a289a}),_0x2e19c4=await _0x1d6990[_0x5d23ac(0x185)]();_0x14491b[_0x5d23ac(0xd4)](_0x5d23ac(0x155),_0x5d23ac(0x18c)),_0x4f1f10[_0x5d23ac(0xca)](_0x5d23ac(0x138)+_0x2e19c4[_0x5d23ac(0xf5)]);}catch(_0x15728e){console['log'](_0x15728e),_0x4f1f10[_0x5d23ac(0xed)](0xc8)[_0x5d23ac(0x168)]({'message':_0x15728e['message']});}}),router['get'](a0_0x1dc58c(0x131),auth,async(_0x177720,_0xd40571)=>{var _0x1f1f72=a0_0x1dc58c;try{const {username:_0x3df25c,email:_0xe12837,role:_0x3f8545}=_0x177720[_0x1f1f72(0x12e)],_0x5634fd=_0x177720[_0x1f1f72(0x12e)],_0x3db803=await profile[_0x1f1f72(0x139)]({'email':_0x5634fd[_0x1f1f72(0xde)]}),_0x231967=await master_shop[_0x1f1f72(0x15f)](),_0x1b3d96=_0x177720['params']['id'],_0x14b87a=await adjustment['findById']({'_id':_0x1b3d96}),_0x30a624=await purchases[_0x1f1f72(0x148)]([{'$match':{'warehouse_name':_0x14b87a[_0x1f1f72(0x16b)]}},{'$unwind':_0x1f1f72(0x184)},{'$group':{'_id':_0x1f1f72(0xc1)}}]),_0x57c201=await product[_0x1f1f72(0x15f)]({}),_0x3dd135=await warehouse[_0x1f1f72(0x148)]([{'$match':{'name':_0x14b87a['warehouse_name']}},{'$unwind':_0x1f1f72(0x134)},{'$group':{'_id':_0x1f1f72(0xe0),'name':{'$first':_0x1f1f72(0x102)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1f1f72(0x15d)},'bin':{'$first':_0x1f1f72(0x18d)},'type':{'$first':_0x1f1f72(0x17f)},'floorlevel':{'$first':_0x1f1f72(0xc6)},'primary_code':{'$first':_0x1f1f72(0x108)},'secondary_code':{'$first':_0x1f1f72(0x153)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x1f1f72(0x156)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1f1f72(0x13a)},'batch_code':{'$first':_0x1f1f72(0x13c)},'room':{'$first':'$room'}}}]);if(_0x231967[0x0][_0x1f1f72(0x151)]=='English\x20(US)'){var _0x3623b0=users[_0x1f1f72(0x109)];console[_0x1f1f72(0x192)](_0x3623b0);}else{if(_0x231967[0x0][_0x1f1f72(0x151)]==_0x1f1f72(0x188))var _0x3623b0=users[_0x1f1f72(0x188)];else{if(_0x231967[0x0][_0x1f1f72(0x151)]=='German')var _0x3623b0=users['German'];else{if(_0x231967[0x0][_0x1f1f72(0x151)]==_0x1f1f72(0x16f))var _0x3623b0=users[_0x1f1f72(0x16f)];else{if(_0x231967[0x0][_0x1f1f72(0x151)]==_0x1f1f72(0xbf))var _0x3623b0=users['French'];else{if(_0x231967[0x0][_0x1f1f72(0x151)]==_0x1f1f72(0xdc))var _0x3623b0=users['Portuguese'];else{if(_0x231967[0x0]['language']==_0x1f1f72(0x12b))var _0x3623b0=users['Chinese'];else{if(_0x231967[0x0][_0x1f1f72(0x151)]=='Arabic\x20(ae)')var _0x3623b0=users['Arabic'];}}}}}}}_0xd40571[_0x1f1f72(0x14e)](_0x1f1f72(0xdf),{'success':_0x177720[_0x1f1f72(0xd4)](_0x1f1f72(0x155)),'errors':_0x177720[_0x1f1f72(0xd4)](_0x1f1f72(0x150)),'role':_0x5634fd,'profile':_0x3db803,'adjustment':_0x14b87a,'stock':_0x3dd135,'master_shop':_0x231967,'warehouse_name':_0x30a624,'unit':_0x57c201,'language':_0x3623b0});}catch(_0x5b676f){console[_0x1f1f72(0x192)](_0x5b676f),_0xd40571['status'](0xc8)[_0x1f1f72(0x168)]({'message':_0x5b676f[_0x1f1f72(0x177)]});}}),router[a0_0x1dc58c(0xea)](a0_0x1dc58c(0x131),auth,async(_0x56405e,_0x53c9e8)=>{var _0x5addaf=a0_0x1dc58c;try{const _0x58e944=_0x56405e['params']['id'],{warehouse_name:_0x11be7c,Room_name:_0x9206b}=_0x56405e['body'],_0x349d37=await adjustment[_0x5addaf(0x11a)]({'_id':_0x58e944}),_0x597ee6=_0x349d37[_0x5addaf(0xc7)][_0x5addaf(0xeb)](async _0x4587c9=>{var _0x534edc=_0x5addaf;if(_0x4587c9[_0x534edc(0xef)]>0x0){var _0x191927=await warehouse[_0x534edc(0x139)]({'name':_0x11be7c,'room':_0x4587c9[_0x534edc(0x127)],'warehouse_category':_0x534edc(0x10f)});const _0x55f639=_0x191927[_0x534edc(0x11d)][_0x534edc(0xeb)](_0x20ffbb=>{var _0x1a2d23=_0x534edc;if(_0x4587c9[_0x1a2d23(0x154)]==_0x1a2d23(0x194)){if(_0x20ffbb[_0x1a2d23(0x130)]==_0x4587c9[_0x1a2d23(0x130)]&&_0x20ffbb[_0x1a2d23(0x141)]==_0x4587c9[_0x1a2d23(0x141)]&&_0x20ffbb[_0x1a2d23(0x154)]==_0x4587c9[_0x1a2d23(0x154)]&&_0x20ffbb['bin']==_0x4587c9[_0x1a2d23(0x133)]&&_0x20ffbb[_0x1a2d23(0x163)]==_0x4587c9[_0x1a2d23(0x163)]&&_0x20ffbb[_0x1a2d23(0x18e)]==_0x4587c9[_0x1a2d23(0x18e)]&&_0x20ffbb[_0x1a2d23(0x125)]==_0x4587c9[_0x1a2d23(0x125)]&&_0x20ffbb[_0x1a2d23(0x132)]==_0x4587c9[_0x1a2d23(0x132)]&&_0x20ffbb['batch_code']==_0x4587c9[_0x1a2d23(0x186)]&&_0x20ffbb['production_date']==_0x4587c9[_0x1a2d23(0x17e)]&&_0x20ffbb[_0x1a2d23(0x10c)]==_0x4587c9[_0x1a2d23(0x10c)]){var _0x32f2a0;_0x32f2a0=_0x4587c9[_0x1a2d23(0xef)],_0x4587c9[_0x1a2d23(0x149)]=='S'&&(_0x32f2a0=_0x4587c9['adjust_qty']),_0x20ffbb[_0x1a2d23(0x10b)]=_0x20ffbb[_0x1a2d23(0x10b)]-_0x32f2a0;}}else{if(_0x20ffbb['product_name']==_0x4587c9[_0x1a2d23(0x130)]&&_0x20ffbb[_0x1a2d23(0x141)]==_0x4587c9['floorlevel']&&_0x20ffbb[_0x1a2d23(0x154)]==_0x4587c9[_0x1a2d23(0x154)]&&_0x20ffbb[_0x1a2d23(0x133)]==_0x4587c9['bin']&&_0x20ffbb[_0x1a2d23(0x163)]==_0x4587c9['bay']&&_0x20ffbb[_0x1a2d23(0x18e)]==_0x4587c9['rack']&&_0x20ffbb[_0x1a2d23(0x125)]==_0x4587c9[_0x1a2d23(0x125)]&&_0x20ffbb[_0x1a2d23(0x132)]==_0x4587c9[_0x1a2d23(0x132)]&&_0x20ffbb[_0x1a2d23(0x186)]==_0x4587c9[_0x1a2d23(0x186)]&&_0x20ffbb['production_date']==_0x4587c9[_0x1a2d23(0x17e)]&&_0x20ffbb[_0x1a2d23(0x10c)]==_0x4587c9[_0x1a2d23(0x10c)]){console[_0x1a2d23(0x192)](_0x4587c9);var _0x32f2a0;_0x32f2a0=_0x4587c9[_0x1a2d23(0xef)],_0x4587c9[_0x1a2d23(0x149)]=='S'&&(_0x32f2a0=_0x4587c9[_0x1a2d23(0xef)]),console['log'](_0x32f2a0+_0x1a2d23(0x170)+_0x4587c9['adjust_qty']+_0x1a2d23(0x170)+_0x20ffbb[_0x1a2d23(0xd8)]+'\x20<>\x20'+_0x4587c9[_0x1a2d23(0x149)]),_0x20ffbb[_0x1a2d23(0x10b)]=_0x20ffbb[_0x1a2d23(0x10b)]+_0x32f2a0;}}});}return _0x191927;});Promise[_0x5addaf(0xe6)](_0x597ee6)[_0x5addaf(0xfe)](async _0x31bb99=>{var _0xfb76ec=_0x5addaf;try{for(const _0x29fcaa of _0x31bb99){await _0x29fcaa[_0xfb76ec(0x185)]();}_0x349d37[_0xfb76ec(0x10d)]='True';const _0x2716e1=await _0x349d37[_0xfb76ec(0x185)](),_0xa41db7=await master_shop[_0xfb76ec(0x15f)](),_0x4f6dcb=await email_settings[_0xfb76ec(0x139)](),_0x270861=await supervisor_settings[_0xfb76ec(0x15f)]();var _0x530e5b=_0x349d37[_0xfb76ec(0xc7)],_0x184fbd='',_0x3f1bba;for(_0x3f1bba in _0x530e5b){_0x184fbd+=_0xfb76ec(0x178)+_0xfb76ec(0x15b)+_0x530e5b[_0x3f1bba][_0xfb76ec(0x130)]+_0xfb76ec(0x147)+_0xfb76ec(0x15b)+_0x530e5b[_0x3f1bba]['product_code']+_0xfb76ec(0x147)+_0xfb76ec(0x15b)+_0x530e5b[_0x3f1bba][_0xfb76ec(0xef)]+_0xfb76ec(0x147)+_0xfb76ec(0x15b)+_0x530e5b[_0x3f1bba][_0xfb76ec(0x120)]+_0xfb76ec(0x147)+_0xfb76ec(0x15b)+_0x530e5b[_0x3f1bba]['secondary_unit']+'</td>'+_0xfb76ec(0x15b)+_0x349d37[_0xfb76ec(0x16b)]+_0xfb76ec(0x147)+_0xfb76ec(0x15b)+_0x530e5b[_0x3f1bba][_0xfb76ec(0x127)]+_0xfb76ec(0x147)+_0xfb76ec(0x15b)+_0x530e5b[_0x3f1bba]['storage']+_0x530e5b[_0x3f1bba][_0xfb76ec(0x18e)]+_0x530e5b[_0x3f1bba][_0xfb76ec(0x163)]+_0x530e5b[_0x3f1bba]['bin']+_0x530e5b[_0x3f1bba][_0xfb76ec(0x154)][0x0]+_0x530e5b[_0x3f1bba][_0xfb76ec(0x141)]+_0xfb76ec(0x147),_0xfb76ec(0x113);}let _0x483259=nodemailer[_0xfb76ec(0x117)]({'host':_0x4f6dcb[_0xfb76ec(0x18a)],'port':Number(_0x4f6dcb[_0xfb76ec(0xe3)]),'secure':![],'auth':{'user':_0x4f6dcb['email'],'pass':_0x4f6dcb[_0xfb76ec(0x13e)]}}),_0x2c63f2={'from':_0x4f6dcb[_0xfb76ec(0xde)],'to':_0x270861[0x0][_0xfb76ec(0x190)],'subject':_0xfb76ec(0xee),'attachments':[{'filename':_0xfb76ec(0x129),'path':__dirname+'/../public'+_0xfb76ec(0x110)+_0xa41db7[0x0][_0xfb76ec(0x161)],'cid':_0xfb76ec(0x121)}],'html':_0xfb76ec(0xfd)+_0xfb76ec(0x143)+_0xfb76ec(0x14a)+_0xfb76ec(0x103)+_0xfb76ec(0x15c)+_0xfb76ec(0x103)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0xfb76ec(0x14c)+_0xfb76ec(0x103)+_0xfb76ec(0x107)+_0xa41db7[0x0]['site_title']+'\x20</h2>'+_0xfb76ec(0x14c)+_0xfb76ec(0x14c)+_0xfb76ec(0x16c)+_0xfb76ec(0x103)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0xfb76ec(0x106)+_0x349d37[_0xfb76ec(0x10c)]+'\x20'+_0xfb76ec(0xff)+_0xfb76ec(0x158)+_0x349d37[_0xfb76ec(0x159)]+'\x20'+'</span>'+_0xfb76ec(0x12c)+_0xfb76ec(0x14c)+_0xfb76ec(0x12d)+_0xfb76ec(0x13b)+_0xfb76ec(0x178)+_0xfb76ec(0x166)+_0xfb76ec(0x193)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0xfb76ec(0x165)+_0xfb76ec(0xc2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0xfb76ec(0x11e)+_0xfb76ec(0x113)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x184fbd+'\x20'+_0xfb76ec(0x173)+_0xfb76ec(0xc4)+_0xfb76ec(0x103)+_0xfb76ec(0x162)+_0xfb76ec(0x10a)+_0xa41db7[0x0][_0xfb76ec(0x16e)]+_0xfb76ec(0x12c)+_0xfb76ec(0x14c)+_0xfb76ec(0x14c)+_0xfb76ec(0xda)};_0x483259[_0xfb76ec(0xc9)](_0x2c63f2,function(_0x462868,_0x59c5ae){var _0x56e728=_0xfb76ec;_0x462868?(console[_0x56e728(0x192)](_0x462868),console[_0x56e728(0x192)](_0x56e728(0xf8))):console[_0x56e728(0x192)](_0x56e728(0x17a));}),_0x56405e[_0xfb76ec(0xd4)](_0xfb76ec(0x155),'adjustment\x20Finalized\x20successfully'),_0x53c9e8['redirect']('/picking_list/PDF_adjustment_rm/'+_0x2716e1[_0xfb76ec(0xf5)]);}catch(_0xf510ba){console[_0xfb76ec(0xc0)](_0xf510ba),_0x53c9e8[_0xfb76ec(0xed)](0x1f4)[_0xfb76ec(0x168)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x13eb4b=>{var _0x464925=_0x5addaf;console['error'](_0x13eb4b),_0x53c9e8['status'](0x1f4)[_0x464925(0x168)]({'error':'An\x20error\x20occurred.'});});}catch(_0xbef481){console[_0x5addaf(0x192)](_0xbef481),_0x53c9e8[_0x5addaf(0xed)](0xc8)[_0x5addaf(0x168)]({'message':_0xbef481[_0x5addaf(0x177)]});}}),router[a0_0x1dc58c(0x17b)]('/view/:id',auth,async(_0x805da8,_0x4ad706)=>{var _0x44f0e7=a0_0x1dc58c;try{const {username:_0x3a265b,email:_0x1ceda0,role:_0x3b9c86}=_0x805da8['user'],_0x30b0ef=_0x805da8[_0x44f0e7(0x12e)],_0x46cb5b=await profile[_0x44f0e7(0x139)]({'email':_0x30b0ef[_0x44f0e7(0xde)]}),_0x5e602c=await master_shop[_0x44f0e7(0x15f)](),_0x176cdb=_0x805da8[_0x44f0e7(0x172)]['id'],_0x4e6b95=await adjustment[_0x44f0e7(0x11a)]({'_id':_0x176cdb}),_0x27a428=await purchases[_0x44f0e7(0x148)]([{'$match':{'warehouse_name':_0x4e6b95[_0x44f0e7(0x16b)]}},{'$unwind':_0x44f0e7(0x184)},{'$group':{'_id':_0x44f0e7(0xc1)}}]),_0x4e9784=await product[_0x44f0e7(0x15f)]({}),_0x3a23b0=await warehouse[_0x44f0e7(0x148)]([{'$match':{'name':_0x4e6b95[_0x44f0e7(0x16b)]}},{'$unwind':_0x44f0e7(0x134)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x44f0e7(0x102)},'product_stock':{'$first':_0x44f0e7(0x189)},'bay':{'$first':_0x44f0e7(0x15d)},'bin':{'$first':_0x44f0e7(0x18d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x44f0e7(0xc6)},'primary_code':{'$first':_0x44f0e7(0x108)},'secondary_code':{'$first':_0x44f0e7(0x153)},'product_code':{'$first':_0x44f0e7(0x112)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x44f0e7(0xd9)},'maxPerUnit':{'$first':_0x44f0e7(0x156)},'expiry_date':{'$first':_0x44f0e7(0xd7)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x44f0e7(0x128)}}}]);let _0x1f1178;if(_0x30b0ef[_0x44f0e7(0xdd)]==_0x44f0e7(0xf6)){const _0x56d0c8=await staff[_0x44f0e7(0x139)]({'email':_0x30b0ef[_0x44f0e7(0xde)]});_0x1f1178=await warehouse[_0x44f0e7(0x148)]([{'$match':{'status':_0x44f0e7(0x160),'name':_0x56d0c8[_0x44f0e7(0x15e)],'warehouse_category':_0x44f0e7(0x10f),'name':{'$ne':_0x44f0e7(0x140)}}},{'$group':{'_id':'$name','name':{'$first':_0x44f0e7(0x180)}}}]);}else _0x1f1178=await warehouse[_0x44f0e7(0x148)]([{'$match':{'status':_0x44f0e7(0x160),'warehouse_category':_0x44f0e7(0x10f),'name':{'$ne':_0x44f0e7(0x140)}}},{'$group':{'_id':_0x44f0e7(0x180),'name':{'$first':_0x44f0e7(0x180)}}}]);if(_0x5e602c[0x0]['language']==_0x44f0e7(0xc5)){var _0x168c73=users[_0x44f0e7(0x109)];console[_0x44f0e7(0x192)](_0x168c73);}else{if(_0x5e602c[0x0][_0x44f0e7(0x151)]==_0x44f0e7(0x188))var _0x168c73=users[_0x44f0e7(0x188)];else{if(_0x5e602c[0x0][_0x44f0e7(0x151)]==_0x44f0e7(0x145))var _0x168c73=users[_0x44f0e7(0x145)];else{if(_0x5e602c[0x0][_0x44f0e7(0x151)]==_0x44f0e7(0x16f))var _0x168c73=users[_0x44f0e7(0x16f)];else{if(_0x5e602c[0x0][_0x44f0e7(0x151)]==_0x44f0e7(0xbf))var _0x168c73=users[_0x44f0e7(0xbf)];else{if(_0x5e602c[0x0]['language']=='Portuguese\x20(BR)')var _0x168c73=users['Portuguese'];else{if(_0x5e602c[0x0][_0x44f0e7(0x151)]==_0x44f0e7(0x12b))var _0x168c73=users[_0x44f0e7(0x12b)];else{if(_0x5e602c[0x0][_0x44f0e7(0x151)]==_0x44f0e7(0x100))var _0x168c73=users[_0x44f0e7(0x182)];}}}}}}}_0x4ad706[_0x44f0e7(0x14e)](_0x44f0e7(0xe2),{'success':_0x805da8[_0x44f0e7(0xd4)](_0x44f0e7(0x155)),'errors':_0x805da8[_0x44f0e7(0xd4)](_0x44f0e7(0x150)),'role':_0x30b0ef,'profile':_0x46cb5b,'adjustment':_0x4e6b95,'stock':_0x3a23b0,'master_shop':_0x5e602c,'warehouse_name':_0x27a428,'unit':_0x4e9784,'language':_0x168c73,'warehouse':_0x1f1178});}catch(_0x338fe1){console[_0x44f0e7(0x192)](_0x338fe1),_0x4ad706[_0x44f0e7(0xed)](0xc8)[_0x44f0e7(0x168)]({'message':_0x338fe1[_0x44f0e7(0x177)]});}}),router['post'](a0_0x1dc58c(0xc8),auth,async(_0x408591,_0x1ac567)=>{var _0x334d81=a0_0x1dc58c;try{const _0x47a8c9=_0x408591[_0x334d81(0x172)]['id'],_0x442426=await adjustment[_0x334d81(0x11a)]({'_id':_0x47a8c9}),_0x4fecd5=await warehouse[_0x334d81(0x139)]({'name':_0x442426['warehouse_name'],'room':_0x442426['room']}),{warehouse_name:_0x4589ff,date:_0x30ed88,prod_name:_0x429763,level:_0x31d3c6,isle:_0x18c7af,pallet:_0x116396,stock:_0x386d4b,types:_0x4e9653,adjust_qty:_0x5b7a79,new_adjust_qty:_0x3d159f,note:_0x3cec84,Room_name:_0x1de3de,invoice:_0x3c1235,JO_number:_0x1b04c8,expiry_date:_0x1cc525}=_0x408591[_0x334d81(0x144)];if(typeof _0x429763==_0x334d81(0xe7))var _0x41a200=[_0x408591[_0x334d81(0x144)]['prod_name']],_0x10e9f9=[_0x408591['body'][_0x334d81(0x18f)]],_0x547b75=[_0x408591[_0x334d81(0x144)]['stock']],_0x2c40de=[_0x408591[_0x334d81(0x144)][_0x334d81(0xcb)]],_0x3c8a3e=[_0x408591['body'][_0x334d81(0xf9)]],_0x193fed=[_0x408591[_0x334d81(0x144)][_0x334d81(0x14b)]],_0x439b27=[_0x408591['body'][_0x334d81(0xfc)]],_0x4a1e5b=[_0x408591[_0x334d81(0x144)][_0x334d81(0xe1)]],_0xdf51b2=[_0x408591[_0x334d81(0x144)][_0x334d81(0x13f)]],_0x904420=[_0x408591[_0x334d81(0x144)][_0x334d81(0x186)]],_0x1c263e=[_0x408591[_0x334d81(0x144)]['expiry_date']],_0x150b01=[_0x408591[_0x334d81(0x144)][_0x334d81(0xd3)]],_0xe9c279=[_0x408591['body'][_0x334d81(0x17e)]],_0x5c50c6=[_0x408591[_0x334d81(0x144)]['prod_cat']],_0x28fffc=[_0x408591['body'][_0x334d81(0xf3)]],_0x2312bc=[_0x408591['body'][_0x334d81(0x122)]],_0x213c9e=[_0x408591[_0x334d81(0x144)][_0x334d81(0xcd)]];else var _0x41a200=[..._0x408591['body']['prod_name']],_0x10e9f9=[..._0x408591[_0x334d81(0x144)][_0x334d81(0x18f)]],_0x547b75=[..._0x408591[_0x334d81(0x144)]['stock']],_0x2c40de=[..._0x408591['body'][_0x334d81(0xcb)]],_0x3c8a3e=[..._0x408591['body'][_0x334d81(0xf9)]],_0x193fed=[..._0x408591[_0x334d81(0x144)][_0x334d81(0x14b)]],_0x439b27=[..._0x408591[_0x334d81(0x144)]['unit']],_0x4a1e5b=[..._0x408591[_0x334d81(0x144)]['Secondary_units']],_0xdf51b2=[..._0x408591[_0x334d81(0x144)][_0x334d81(0x13f)]],_0x904420=[..._0x408591[_0x334d81(0x144)][_0x334d81(0x186)]],_0x1c263e=[..._0x408591['body'][_0x334d81(0x132)]],_0x150b01=[..._0x408591[_0x334d81(0x144)][_0x334d81(0xd3)]],_0xe9c279=[..._0x408591['body'][_0x334d81(0x17e)]],_0x5c50c6=[..._0x408591[_0x334d81(0x144)][_0x334d81(0x149)]],_0x28fffc=[..._0x408591['body'][_0x334d81(0xf3)]],_0x2312bc=[..._0x408591['body'][_0x334d81(0x122)]],_0x213c9e=[..._0x408591['body']['second1']];const _0x353dd6=_0x41a200[_0x334d81(0xeb)](_0x23cab4=>{return _0x23cab4={'product_name':_0x23cab4};});_0x10e9f9[_0x334d81(0x181)]((_0x3bdcb1,_0x29ee16)=>{var _0x1bdc76=_0x334d81;_0x28fffc[_0x1bdc76(0x181)]((_0x33a6d5,_0x599845)=>{var _0x22da36=_0x1bdc76;if(_0x33a6d5==_0x22da36(0x18b)&&_0x29ee16==_0x599845){var _0x2e7230=_0x3bdcb1['slice'](0x3);_0x353dd6[_0x29ee16][_0x22da36(0x125)]=_0x3bdcb1[0x0],_0x353dd6[_0x29ee16][_0x22da36(0x18e)]=_0x3bdcb1[0x1],_0x353dd6[_0x29ee16][_0x22da36(0x163)]=0x0,_0x353dd6[_0x29ee16][_0x22da36(0x133)]=0x0,_0x353dd6[_0x29ee16][_0x22da36(0x154)]=_0x22da36(0xf2),_0x353dd6[_0x29ee16][_0x22da36(0x141)]=_0x2e7230;}else{if(_0x33a6d5==_0x22da36(0xd2)&&_0x29ee16==_0x599845){var _0x2e7230=_0x3bdcb1[_0x22da36(0x169)](0x3);_0x353dd6[_0x29ee16][_0x22da36(0x125)]=_0x3bdcb1[0x0],_0x353dd6[_0x29ee16]['rack']=_0x3bdcb1[0x1],_0x353dd6[_0x29ee16][_0x22da36(0x163)]=0x0,_0x353dd6[_0x29ee16][_0x22da36(0x133)]=0x0,_0x353dd6[_0x29ee16][_0x22da36(0x154)]=_0x22da36(0xf2),_0x353dd6[_0x29ee16]['floorlevel']=_0x3bdcb1[0x5];}else{if(_0x29ee16==_0x599845){var _0x335793;if(_0x3bdcb1[0x4]=='L')_0x335793=_0x22da36(0x116);else _0x3bdcb1[0x4]=='F'&&(_0x335793=_0x22da36(0xf2));_0x353dd6[_0x29ee16]['storage']=_0x3bdcb1[0x0],_0x353dd6[_0x29ee16][_0x22da36(0x18e)]=_0x3bdcb1[0x1],_0x353dd6[_0x29ee16]['bay']=_0x3bdcb1[0x2],_0x353dd6[_0x29ee16][_0x22da36(0x133)]=_0x3bdcb1[0x3],_0x353dd6[_0x29ee16][_0x22da36(0x154)]=_0x335793,_0x353dd6[_0x29ee16]['floorlevel']=_0x3bdcb1[0x5];}}}});}),_0x547b75['forEach']((_0x2316c3,_0x10c043)=>{var _0x15d174=_0x334d81;_0x353dd6[_0x10c043][_0x15d174(0x17d)]=_0x2316c3;}),_0x2c40de[_0x334d81(0x181)]((_0x1f4902,_0xe22820)=>{_0x353dd6[_0xe22820]['types']=_0x1f4902;}),_0x3c8a3e['forEach']((_0x34665e,_0x54eb4a)=>{var _0x44b9a1=_0x334d81;_0x353dd6[_0x54eb4a][_0x44b9a1(0xef)]=_0x34665e;}),_0x193fed[_0x334d81(0x181)]((_0x45ccf6,_0x35a28f)=>{_0x353dd6[_0x35a28f]['new_adjust_qty']=_0x45ccf6;}),_0x439b27[_0x334d81(0x181)]((_0x4bfddd,_0x3def2e)=>{var _0x2a044a=_0x334d81;_0x353dd6[_0x3def2e][_0x2a044a(0x120)]=_0x4bfddd;}),_0x4a1e5b['forEach']((_0x215e7c,_0x10ec79)=>{_0x353dd6[_0x10ec79]['secondary_unit']=_0x215e7c;}),_0xdf51b2[_0x334d81(0x181)]((_0x4e5e99,_0x20049d)=>{var _0x47483d=_0x334d81;_0x353dd6[_0x20049d][_0x47483d(0xd6)]=_0x4e5e99;}),_0x904420[_0x334d81(0x181)]((_0x2ae283,_0x33257a)=>{var _0x4f69dd=_0x334d81;_0x353dd6[_0x33257a][_0x4f69dd(0x186)]=_0x2ae283;}),_0x1c263e[_0x334d81(0x181)]((_0x3a8dbe,_0x294db9)=>{var _0x10d815=_0x334d81;_0x353dd6[_0x294db9][_0x10d815(0x132)]=_0x3a8dbe;}),_0x150b01['forEach']((_0x4efa0a,_0x25ae5a)=>{var _0x4ec4ac=_0x334d81;_0x353dd6[_0x25ae5a][_0x4ec4ac(0x17c)]=_0x4efa0a;}),_0xe9c279[_0x334d81(0x181)]((_0xadcded,_0xac65fd)=>{var _0x1ae6b3=_0x334d81;_0x353dd6[_0xac65fd][_0x1ae6b3(0x17e)]=_0xadcded;}),_0x5c50c6[_0x334d81(0x181)]((_0x30c7d4,_0x19b74e)=>{var _0x23e802=_0x334d81;_0x353dd6[_0x19b74e][_0x23e802(0x149)]=_0x30c7d4;}),_0x28fffc[_0x334d81(0x181)]((_0x847a7,_0x59abf8)=>{var _0x1204e8=_0x334d81;_0x353dd6[_0x59abf8][_0x1204e8(0x127)]=_0x847a7;}),_0x2312bc[_0x334d81(0x181)]((_0x1b0aad,_0x359abb)=>{var _0x427ee9=_0x334d81;_0x353dd6[_0x359abb][_0x427ee9(0x10e)]=_0x1b0aad;}),_0x213c9e['forEach']((_0x1717f0,_0x448710)=>{var _0x32dfd0=_0x334d81;_0x353dd6[_0x448710][_0x32dfd0(0x105)]=_0x1717f0;});const _0x51293a=_0x353dd6['filter'](_0x6f7378=>_0x6f7378[_0x334d81(0xef)]!=='0'&&_0x6f7378[_0x334d81(0xef)]!=='');var _0x4604a2=0x0;_0x51293a[_0x334d81(0x181)](_0x3c5408=>{var _0x3f30ac=_0x334d81;console[_0x3f30ac(0x192)]('foreach\x20newproduct',_0x3c5408),parseInt(_0x3c5408[_0x3f30ac(0xef)])<=0x0&&_0x4604a2++;});if(_0x4604a2!=0x0)return _0x408591[_0x334d81(0xd4)](_0x334d81(0x150),_0x334d81(0x167)),_0x1ac567[_0x334d81(0xca)](_0x334d81(0x12f));_0x442426[_0x334d81(0x16b)]=_0x4589ff,_0x442426[_0x334d81(0x159)]=_0x30ed88,_0x442426['product']=_0x51293a,_0x442426[_0x334d81(0x195)]=_0x3cec84,_0x442426[_0x334d81(0x10c)]=_0x3c1235,_0x442426[_0x334d81(0x136)]=_0x334d81(0x179);const _0x28a561=await _0x442426[_0x334d81(0x185)]();_0x408591[_0x334d81(0xd4)](_0x334d81(0x155),_0x334d81(0x11b)),_0x1ac567[_0x334d81(0xca)]('/adjustment/view');}catch(_0x21543e){console[_0x334d81(0x192)](_0x21543e);}}),router[a0_0x1dc58c(0xea)](a0_0x1dc58c(0x142),async(_0x4e6e30,_0xb497cc)=>{var _0x5f481d=a0_0x1dc58c;const {primary_code:_0x2f489b,warehouse_data:_0x2ec552,rooms_data:_0x31d67f,Roomslist:_0x4e880e}=_0x4e6e30[_0x5f481d(0x144)],_0x5cd5a6=_0x4e880e[_0x5f481d(0x14f)](','),_0x54b047=[];async function _0x441c72(_0x5a0510){var _0x18ec69=_0x5f481d;const _0x3126e0=await warehouse[_0x18ec69(0x148)]([{'$match':{'name':_0x2ec552,'room':_0x5a0510}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2f489b}},{'$group':{'_id':_0x18ec69(0xe0),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x18ec69(0x189)},'primary_code':{'$first':_0x18ec69(0x108)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x18ec69(0x112)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x18ec69(0x17f)},'pallet':{'$first':_0x18ec69(0xc6)},'unit':{'$first':_0x18ec69(0x171)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x18ec69(0x114)},'rack':{'$first':_0x18ec69(0xd9)},'expiry_date':{'$first':_0x18ec69(0xd7)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x18ec69(0x156)},'batch_code':{'$first':_0x18ec69(0x13c)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0xad05c5=await warehouse[_0x18ec69(0x148)]([{'$match':{'name':_0x2ec552,'room':_0x5a0510}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2f489b}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x18ec69(0x102)},'product_stock':{'$first':_0x18ec69(0x189)},'primary_code':{'$first':_0x18ec69(0x108)},'secondary_code':{'$first':_0x18ec69(0x153)},'product_code':{'$first':_0x18ec69(0x112)},'level':{'$first':_0x18ec69(0x15d)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x18ec69(0x17f)},'pallet':{'$first':_0x18ec69(0xc6)},'unit':{'$first':_0x18ec69(0x171)},'secondary_unit':{'$first':_0x18ec69(0x111)},'storage':{'$first':_0x18ec69(0x114)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x18ec69(0xd7)},'production_date':{'$first':_0x18ec69(0x13a)},'maxPerUnit':{'$first':_0x18ec69(0x156)},'batch_code':{'$first':_0x18ec69(0x13c)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x18ec69(0x128)}}}]);if(_0x3126e0[_0x18ec69(0xdb)]>0x0)_0x54b047[_0x18ec69(0x191)](_0x3126e0);else _0xad05c5[_0x18ec69(0xdb)]>0x0&&_0x54b047[_0x18ec69(0x191)](_0xad05c5);}const _0xa9b13a=_0x5cd5a6[_0x5f481d(0xeb)](_0x2589ed=>_0x441c72(_0x2589ed));await Promise[_0x5f481d(0xe6)](_0xa9b13a),_0xb497cc[_0x5f481d(0x168)](_0x54b047);}),router[a0_0x1dc58c(0xea)](a0_0x1dc58c(0x16d),async(_0x137809,_0x3bf61b)=>{var _0x81d8a8=a0_0x1dc58c;const {primaryCode:_0x69986e,secondaryCode:_0x9c3848,productCode:_0x27e314,level:_0x322d21,isle:_0x292650,pallet:_0x5dd496,warehouses:_0x5ce4d7,room:_0x5b321c}=_0x137809[_0x81d8a8(0x144)];try{const _0x11d05d=await warehouse['aggregate']([{'$match':{'name':_0x5ce4d7,'room':_0x5b321c}},{'$unwind':_0x81d8a8(0x134)},{'$match':{'product_details.level':parseInt(_0x322d21),'product_details.isle':_0x292650,'product_details.pallet':parseInt(_0x5dd496)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x81d8a8(0x189)},'level':{'$first':_0x81d8a8(0xfa)},'isle':{'$first':_0x81d8a8(0x175)},'pallet':{'$first':_0x81d8a8(0x12a)},'maxProducts':{'$first':_0x81d8a8(0x174)}}}]);_0x3bf61b[_0x81d8a8(0xed)](0xc8)['json'](_0x11d05d);}catch(_0x49047b){_0x3bf61b[_0x81d8a8(0xed)](0x194)['json']({'message':_0x49047b[_0x81d8a8(0x177)]});}}),module[a0_0x1dc58c(0x104)]=router;