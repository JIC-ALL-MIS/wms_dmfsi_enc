var a0_0x4e1c3a=a0_0x575d;function a0_0x4e4c(){var _0x3a5938=['$invoice','11862IkOsxK','map','adjust_qty','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Receiving\x20Area','floorlevel','$product_details.expiry_date','warehouse','stock','date','exports','Floor','Hindi','114004QFCziZ','back','Level','product_stock','$isAllowEdit','prod_cat','Return\x20Rooms','Ambient','product','adjustment\x20add\x20successfull','Enabled','$_id','Return\x20Goods','/upload/','</td>','English','storage','ADJ-','Portuguese','New_Qty_Converted_adj','adjustment\x20Finalized\x20successfully','adjustment\x20data\x20update\x20successfully','production_date','slice','password','floor','product_code','</table>','$product_details.pallet','prime1','logo','1347280fQeoVn','new_adjust_qty','</span>','site_title','$date','maxperunit','length','$product_details.product_cat','room','$product_details.secondary_code','$product_details.rack','createTransport','$product_details.product_code','<div>','host','user','/barcode_scanner','$warehouse_name','<h2>\x20','flash','<tr>','/CheckingWarehouse','An\x20error\x20occurred\x20while\x20saving\x20data.','prod_code','Shelves','$product_details','$product_details.floorlevel','isAllowEdit','product_details','role','360GXAxdb','English\x20(US)','RMSEmail','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','\x20Order\x20Number\x20:\x20','425586DAYwvA','batch_code','<hr\x20class=\x22my-3\x22>','unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/preview/:id','type','stockBefore','foreach\x20newproduct','$product_details.maxPerUnit','</tr>','express','$product_details._id','$finalize','secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','False','<h5\x20style=\x22text-align:\x20left;\x22>','/view/add_adjustment','\x20</h2>','Router','1376808XNJqMF','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','toString','$product_details.product_name','<tbody\x20style=\x22text-align:\x20center;\x22>','secondary_unit','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','expiry_date','$product_details.primary_code','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','primary_code','$product_details.batch_code','$product','Raw\x20Materials','then','../models/all_models','maxPerUnit','$product_details.product_stock','email','815445anDvwq','params','second1','\x20<>\x20','$product_details.maxProducts','invoice','status','$name','German','note','rack','Rooms','<h5>','Chinese','Secondary_units','/view','forEach','log','$product_details.bay','string','</div>','level','language','</thead>','True','bin','Spanish','Adjustment\x20Mail','$product_details.isle','Email\x20sent\x20successfully','<!DOCTYPE\x20html>','../public/language/languages.json','findById','$product.product_name','New_Qty_Converted','errors','post','prod_invoice','\x20Order\x20Date\x20:\x20','Portuguese\x20(BR)','Logo.png','$product_details.secondary_unit','body','aggregate','render','sendMail','finalize','json','</h5>','image','add_adjustment','/adjustment/view','all','error','Arabic\x20(ae)','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/view/:id','<html><head><title></title>','$product.room_names','edit_adjustment_view','$product_details.production_date','random','/../public','port','max_per_unit','filter','</tbody>','redirect','Arabic','find','warehouse_name','/picking_list/PDF_adjustment_rm/','message','$product_details.type','44tmpCDu','6qMBfbv','split','types','_id','French','bay','</head><body>','product_name','$product_details.storage','$product_details.unit','prod_name','Primary_Units','1385uvKCdN','room_names','<strong>\x20Regards\x20</strong>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','findOne','save','success','20YHszjC','get','$product_details.bin','$room','218qkqkyS'];a0_0x4e4c=function(){return _0x3a5938;};return a0_0x4e4c();}function a0_0x575d(_0x31254e,_0x4c5fa0){var _0x4e4ce0=a0_0x4e4c();return a0_0x575d=function(_0x575da6,_0xabdd2f){_0x575da6=_0x575da6-0x151;var _0x3bec7f=_0x4e4ce0[_0x575da6];return _0x3bec7f;},a0_0x575d(_0x31254e,_0x4c5fa0);}(function(_0x1f8fbe,_0x119fcb){var _0x4d221c=a0_0x575d,_0x25e121=_0x1f8fbe();while(!![]){try{var _0x5eb878=parseInt(_0x4d221c(0x1f1))/0x1*(-parseInt(_0x4d221c(0x1fc))/0x2)+-parseInt(_0x4d221c(0x1e5))/0x3*(parseInt(_0x4d221c(0x20c))/0x4)+-parseInt(_0x4d221c(0x16b))/0x5*(-parseInt(_0x4d221c(0x1fe))/0x6)+parseInt(_0x4d221c(0x170))/0x7+-parseInt(_0x4d221c(0x22b))/0x8+-parseInt(_0x4d221c(0x19a))/0x9*(parseInt(_0x4d221c(0x1f8))/0xa)+parseInt(_0x4d221c(0x1e4))/0xb*(parseInt(_0x4d221c(0x185))/0xc);if(_0x5eb878===_0x119fcb)break;else _0x25e121['push'](_0x25e121['shift']());}catch(_0x231ca5){_0x25e121['push'](_0x25e121['shift']());}}}(a0_0x4e4c,0x1982b));const express=require(a0_0x4e1c3a(0x17b)),app=express(),router=express[a0_0x4e1c3a(0x184)](),auth=require(a0_0x4e1c3a(0x201)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x4e1c3a(0x196)),users=require(a0_0x4e1c3a(0x1b9)),nodemailer=require('nodemailer');router['get'](a0_0x4e1c3a(0x1a9),auth,async(_0x340ca9,_0x5b994c)=>{var _0x2ce4a9=a0_0x4e1c3a;try{const {username:_0x5a6191,email:_0xd9157,role:_0x45b211}=_0x340ca9[_0x2ce4a9(0x15c)],_0x3f336d=_0x340ca9[_0x2ce4a9(0x15c)],_0x561b7e=await profile[_0x2ce4a9(0x1f5)]({'email':_0x3f336d[_0x2ce4a9(0x199)]}),_0x3219f1=await master_shop[_0x2ce4a9(0x1df)]();console['log']('master',_0x3219f1);let _0x514735;if(_0x3f336d[_0x2ce4a9(0x16a)]==_0x2ce4a9(0x18b)){const _0x49a863=await staff[_0x2ce4a9(0x1f5)]({'email':_0x3f336d[_0x2ce4a9(0x199)]});_0x514735=await warehouse[_0x2ce4a9(0x1df)]({'status':_0x2ce4a9(0x216),'name':_0x49a863['warehouse']});}else _0x514735=await warehouse[_0x2ce4a9(0x1df)]({'status':_0x2ce4a9(0x216)});const _0x3617bc=await product['find']();let _0x5657c0;if(_0x3f336d[_0x2ce4a9(0x16a)]=='staff'){const _0x19fd70=await staff[_0x2ce4a9(0x1f5)]({'email':_0x3f336d[_0x2ce4a9(0x199)]});_0x5657c0=await adjustment['find']({'warehouse_name':_0x19fd70['warehouse']});}else _0x5657c0=await adjustment[_0x2ce4a9(0x1c5)]([{'$unwind':_0x2ce4a9(0x193)},{'$group':{'_id':_0x2ce4a9(0x217),'invoice':{'$first':_0x2ce4a9(0x1fd)},'date':{'$first':_0x2ce4a9(0x151)},'warehouse_name':{'$first':_0x2ce4a9(0x15e)},'room':{'$addToSet':_0x2ce4a9(0x1d4)},'finalize':{'$first':_0x2ce4a9(0x17d)},'isAllowEdit':{'$first':_0x2ce4a9(0x210)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3219f1[0x0][_0x2ce4a9(0x1b0)]==_0x2ce4a9(0x16c)){var _0x1328f0=users['English'];console[_0x2ce4a9(0x1ab)](_0x1328f0);}else{if(_0x3219f1[0x0][_0x2ce4a9(0x1b0)]=='Hindi')var _0x1328f0=users[_0x2ce4a9(0x20b)];else{if(_0x3219f1[0x0][_0x2ce4a9(0x1b0)]==_0x2ce4a9(0x1a2))var _0x1328f0=users[_0x2ce4a9(0x1a2)];else{if(_0x3219f1[0x0][_0x2ce4a9(0x1b0)]==_0x2ce4a9(0x1b4))var _0x1328f0=users[_0x2ce4a9(0x1b4)];else{if(_0x3219f1[0x0]['language']==_0x2ce4a9(0x1e9))var _0x1328f0=users[_0x2ce4a9(0x1e9)];else{if(_0x3219f1[0x0][_0x2ce4a9(0x1b0)]==_0x2ce4a9(0x1c1))var _0x1328f0=users[_0x2ce4a9(0x21e)];else{if(_0x3219f1[0x0][_0x2ce4a9(0x1b0)]==_0x2ce4a9(0x1a7))var _0x1328f0=users[_0x2ce4a9(0x1a7)];else{if(_0x3219f1[0x0][_0x2ce4a9(0x1b0)]==_0x2ce4a9(0x1d0))var _0x1328f0=users['Arabic'];}}}}}}}_0x5b994c[_0x2ce4a9(0x1c6)]('adjustment',{'success':_0x340ca9[_0x2ce4a9(0x160)]('success'),'errors':_0x340ca9[_0x2ce4a9(0x160)](_0x2ce4a9(0x1bd)),'role':_0x3f336d,'profile':_0x561b7e,'warehouse':_0x514735,'product':_0x3617bc,'adjustment':_0x5657c0,'master_shop':_0x3219f1,'language':_0x1328f0});}catch(_0x32bb3a){console[_0x2ce4a9(0x1ab)](_0x32bb3a);}});async function getRandom8DigitNumber(){var _0x7d2831=a0_0x4e1c3a;const _0x1a5a40=0x989680,_0xada4ca=0x5f5e0ff,_0x4836e0=Math[_0x7d2831(0x225)](Math[_0x7d2831(0x1d7)]()*(_0xada4ca-_0x1a5a40+0x1))+_0x1a5a40;var _0x131fe2;const _0x3894d5=await adjustment[_0x7d2831(0x1f5)]({'invoice':_0x7d2831(0x21d)+_0x4836e0});return _0x3894d5&&_0x3894d5['length']>0x0?_0x131fe2=_0x7d2831(0x21d)+_0x4836e0:_0x131fe2=_0x7d2831(0x21d)+_0x4836e0,_0x131fe2;}router[a0_0x4e1c3a(0x1f9)]('/view/add_adjustment',auth,async(_0x13d2d2,_0x463dc3)=>{var _0x595c77=a0_0x4e1c3a;try{const {username:_0x2fb80d,email:_0x326aff,role:_0x43b8ca}=_0x13d2d2['user'],_0x41c453=_0x13d2d2[_0x595c77(0x15c)],_0x2f57ff=await profile[_0x595c77(0x1f5)]({'email':_0x41c453['email']}),_0x100ce5=await master_shop['find']();let _0x105d17;if(_0x41c453[_0x595c77(0x16a)]==_0x595c77(0x18b)){const _0x3fa4df=await staff['findOne']({'email':_0x41c453[_0x595c77(0x199)]});_0x105d17=await warehouse[_0x595c77(0x1c5)]([{'$match':{'status':_0x595c77(0x216),'name':_0x3fa4df['warehouse'],'warehouse_category':_0x595c77(0x194),'name':{'$ne':_0x595c77(0x218)}}},{'$group':{'_id':_0x595c77(0x1a1),'name':{'$first':_0x595c77(0x1a1)}}}]);}else _0x105d17=await warehouse[_0x595c77(0x1c5)]([{'$match':{'status':_0x595c77(0x216),'warehouse_category':_0x595c77(0x194),'name':{'$ne':_0x595c77(0x218)}}},{'$group':{'_id':_0x595c77(0x1a1),'name':{'$first':_0x595c77(0x1a1)}}}]);const _0x5394a6=await product[_0x595c77(0x1df)]({}),_0x4ef547=await adjustment[_0x595c77(0x1df)]({}),_0x2e7488=_0x4ef547[_0x595c77(0x153)]+0x1,_0x3c1520=_0x595c77(0x21d)+_0x2e7488[_0x595c77(0x187)]()['padStart'](0x5,'0');var _0x56f062=[_0x595c77(0x213),'Enclosed',_0x595c77(0x212)];if(_0x100ce5[0x0][_0x595c77(0x1b0)]=='English\x20(US)')var _0x4caa9f=users[_0x595c77(0x21b)];else{if(_0x100ce5[0x0][_0x595c77(0x1b0)]=='Hindi')var _0x4caa9f=users['Hindi'];else{if(_0x100ce5[0x0][_0x595c77(0x1b0)]==_0x595c77(0x1a2))var _0x4caa9f=users[_0x595c77(0x1a2)];else{if(_0x100ce5[0x0][_0x595c77(0x1b0)]=='Spanish')var _0x4caa9f=users[_0x595c77(0x1b4)];else{if(_0x100ce5[0x0][_0x595c77(0x1b0)]==_0x595c77(0x1e9))var _0x4caa9f=users[_0x595c77(0x1e9)];else{if(_0x100ce5[0x0][_0x595c77(0x1b0)]==_0x595c77(0x1c1))var _0x4caa9f=users[_0x595c77(0x21e)];else{if(_0x100ce5[0x0]['language']=='Chinese')var _0x4caa9f=users[_0x595c77(0x1a7)];else{if(_0x100ce5[0x0][_0x595c77(0x1b0)]==_0x595c77(0x1d0))var _0x4caa9f=users['Arabic'];}}}}}}}const _0xe0ee12=getRandom8DigitNumber();_0xe0ee12[_0x595c77(0x195)](_0x3ed747=>{var _0x49a5b2=_0x595c77;_0x463dc3[_0x49a5b2(0x1c6)](_0x49a5b2(0x1cc),{'success':_0x13d2d2[_0x49a5b2(0x160)](_0x49a5b2(0x1f7)),'errors':_0x13d2d2[_0x49a5b2(0x160)]('errors'),'role':_0x41c453,'profile':_0x2f57ff,'warehouse':_0x105d17,'product':_0x5394a6,'master_shop':_0x100ce5,'language':_0x4caa9f,'rooms_data':_0x56f062,'invoice_no':_0x3ed747});})['catch'](_0x30114d=>{var _0x9574a3=_0x595c77;_0x13d2d2[_0x9574a3(0x160)](_0x9574a3(0x1bd),_0x9574a3(0x174)),_0x463dc3['redirect'](_0x9574a3(0x1cd));});}catch(_0x480948){console[_0x595c77(0x1ab)](_0x480948);}}),router[a0_0x4e1c3a(0x1be)](a0_0x4e1c3a(0x182),auth,async(_0x54bbd1,_0xe5c833)=>{var _0x44c2ab=a0_0x4e1c3a;try{const {warehouse_name:_0x2b85e5,date:_0x19d1d2,prod_name:_0x3ab367,level:_0x338d46,isle:_0xad4c84,pallet:_0x533c63,stock:_0x508f1a,types:_0x395ca0,adjust_qty:_0x473adb,new_adjust_qty:_0x5993a6,note:_0x129692,Room_name:_0x260626,invoice:_0x3fcd93,JO_number:_0x2a3535,expiry_date:_0x54091e}=_0x54bbd1['body'];if(typeof _0x3ab367==_0x44c2ab(0x1ad))var _0x3970e3=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1ef)]],_0x385d79=[_0x54bbd1[_0x44c2ab(0x1c4)]['level']],_0x2298cb=[_0x54bbd1['body'][_0x44c2ab(0x207)]],_0x518dcf=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1e7)]],_0x4ed3f6=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x21f)]],_0x13b291=[_0x54bbd1['body'][_0x44c2ab(0x1bc)]],_0x57eced=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1f0)]],_0x13cc2f=[_0x54bbd1[_0x44c2ab(0x1c4)]['Secondary_units']],_0x53081c=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x164)]],_0x1b33a8=[_0x54bbd1['body'][_0x44c2ab(0x171)]],_0x1e2c3e=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x18d)]],_0x249523=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1da)]],_0x4af372=[_0x54bbd1['body'][_0x44c2ab(0x222)]],_0x537359=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x211)]],_0xb0ab34=[_0x54bbd1['body'][_0x44c2ab(0x1a5)]],_0xa95b56=[_0x54bbd1[_0x44c2ab(0x1c4)]['prime1']],_0x297f96=[_0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x19c)]],_0x5da935=[_0x54bbd1[_0x44c2ab(0x1c4)]['prod_invoice']];else var _0x3970e3=[..._0x54bbd1['body'][_0x44c2ab(0x1ef)]],_0x385d79=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1af)]],_0x2298cb=[..._0x54bbd1['body']['stock']],_0x518dcf=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1e7)]],_0x4ed3f6=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x21f)]],_0x13b291=[..._0x54bbd1[_0x44c2ab(0x1c4)]['New_Qty_Converted']],_0x57eced=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x173)]],_0x13cc2f=[..._0x54bbd1['body'][_0x44c2ab(0x1a8)]],_0x53081c=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x164)]],_0x1b33a8=[..._0x54bbd1[_0x44c2ab(0x1c4)]['batch_code']],_0x1e2c3e=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x18d)]],_0x249523=[..._0x54bbd1[_0x44c2ab(0x1c4)]['max_per_unit']],_0x4af372=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x222)]],_0x537359=[..._0x54bbd1[_0x44c2ab(0x1c4)]['prod_cat']],_0xb0ab34=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1a5)]],_0xa95b56=[..._0x54bbd1[_0x44c2ab(0x1c4)]['prime1']],_0x297f96=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x19c)]],_0x5da935=[..._0x54bbd1[_0x44c2ab(0x1c4)][_0x44c2ab(0x1bf)]];const _0x1e44d2=_0x3970e3[_0x44c2ab(0x1ff)](_0x59278a=>{return _0x59278a={'product_name':_0x59278a};});_0x385d79[_0x44c2ab(0x1aa)]((_0x22557c,_0x52c1ef)=>{_0xb0ab34['forEach']((_0x361121,_0x492e0e)=>{var _0x2c2f61=a0_0x575d;if(_0x361121==_0x2c2f61(0x203)&&_0x52c1ef==_0x492e0e){var _0x545ff7=_0x22557c['slice'](0x3);_0x1e44d2[_0x52c1ef][_0x2c2f61(0x21c)]=_0x22557c[0x0],_0x1e44d2[_0x52c1ef][_0x2c2f61(0x1a4)]=_0x22557c[0x1],_0x1e44d2[_0x52c1ef][_0x2c2f61(0x1ea)]=0x0,_0x1e44d2[_0x52c1ef][_0x2c2f61(0x1b3)]=0x0,_0x1e44d2[_0x52c1ef][_0x2c2f61(0x176)]=_0x2c2f61(0x20a),_0x1e44d2[_0x52c1ef][_0x2c2f61(0x204)]=_0x545ff7;}else{if(_0x361121=='Shelves'&&_0x52c1ef==_0x492e0e){var _0x545ff7=_0x22557c[_0x2c2f61(0x223)](0x3);_0x1e44d2[_0x52c1ef]['storage']=_0x22557c[0x0],_0x1e44d2[_0x52c1ef][_0x2c2f61(0x1a4)]=_0x22557c[0x1],_0x1e44d2[_0x52c1ef][_0x2c2f61(0x1ea)]=0x0,_0x1e44d2[_0x52c1ef]['bin']=0x0,_0x1e44d2[_0x52c1ef][_0x2c2f61(0x176)]='Floor',_0x1e44d2[_0x52c1ef]['floorlevel']=_0x22557c[0x5];}else{if(_0x52c1ef==_0x492e0e){var _0x5b1cc7;if(_0x22557c[0x4]=='L')_0x5b1cc7=_0x2c2f61(0x20e);else _0x22557c[0x4]=='F'&&(_0x5b1cc7=_0x2c2f61(0x20a));_0x1e44d2[_0x52c1ef][_0x2c2f61(0x21c)]=_0x22557c[0x0],_0x1e44d2[_0x52c1ef][_0x2c2f61(0x1a4)]=_0x22557c[0x1],_0x1e44d2[_0x52c1ef][_0x2c2f61(0x1ea)]=_0x22557c[0x2],_0x1e44d2[_0x52c1ef]['bin']=_0x22557c[0x3],_0x1e44d2[_0x52c1ef][_0x2c2f61(0x176)]=_0x5b1cc7,_0x1e44d2[_0x52c1ef][_0x2c2f61(0x204)]=_0x22557c[0x5];}}}});}),_0x2298cb[_0x44c2ab(0x1aa)]((_0x4bd556,_0x27e799)=>{_0x1e44d2[_0x27e799]['stockBefore']=_0x4bd556;}),_0x518dcf[_0x44c2ab(0x1aa)]((_0x6f8643,_0xa6c9e)=>{var _0x3a0bca=_0x44c2ab;_0x1e44d2[_0xa6c9e][_0x3a0bca(0x1e7)]=_0x6f8643;}),_0x4ed3f6[_0x44c2ab(0x1aa)]((_0x504868,_0x5dca9f)=>{_0x1e44d2[_0x5dca9f]['adjust_qty']=_0x504868;}),_0x13b291[_0x44c2ab(0x1aa)]((_0x41f901,_0x183787)=>{var _0x2e0ee7=_0x44c2ab;_0x1e44d2[_0x183787][_0x2e0ee7(0x22c)]=_0x41f901;}),_0x57eced[_0x44c2ab(0x1aa)]((_0x453875,_0x271fc4)=>{var _0x1deccf=_0x44c2ab;_0x1e44d2[_0x271fc4][_0x1deccf(0x173)]=_0x453875;}),_0x13cc2f[_0x44c2ab(0x1aa)]((_0x3b7348,_0x4e639a)=>{var _0x181f92=_0x44c2ab;_0x1e44d2[_0x4e639a][_0x181f92(0x18a)]=_0x3b7348;}),_0x53081c['forEach']((_0x2c10d4,_0x432a25)=>{var _0x4cf6a5=_0x44c2ab;_0x1e44d2[_0x432a25][_0x4cf6a5(0x226)]=_0x2c10d4;}),_0x1b33a8[_0x44c2ab(0x1aa)]((_0xa74a28,_0x30cb68)=>{var _0xb5180d=_0x44c2ab;_0x1e44d2[_0x30cb68][_0xb5180d(0x171)]=_0xa74a28;}),_0x1e2c3e[_0x44c2ab(0x1aa)]((_0x45787e,_0x399ccb)=>{var _0x4ec0bb=_0x44c2ab;_0x1e44d2[_0x399ccb][_0x4ec0bb(0x18d)]=_0x45787e;}),_0x249523[_0x44c2ab(0x1aa)]((_0x143d9d,_0x39f9ca)=>{var _0x30d815=_0x44c2ab;_0x1e44d2[_0x39f9ca][_0x30d815(0x152)]=_0x143d9d;}),_0x4af372[_0x44c2ab(0x1aa)]((_0x322ea3,_0x12b21f)=>{var _0x1f7904=_0x44c2ab;_0x1e44d2[_0x12b21f][_0x1f7904(0x222)]=_0x322ea3;}),_0x537359[_0x44c2ab(0x1aa)]((_0x35f15e,_0x3bbae7)=>{var _0x57f86b=_0x44c2ab;_0x1e44d2[_0x3bbae7][_0x57f86b(0x211)]=_0x35f15e;}),_0xb0ab34[_0x44c2ab(0x1aa)]((_0x1a7542,_0x219e26)=>{var _0x4ca760=_0x44c2ab;_0x1e44d2[_0x219e26][_0x4ca760(0x1f2)]=_0x1a7542;}),_0xa95b56[_0x44c2ab(0x1aa)]((_0x4e7b68,_0x3ae4a3)=>{_0x1e44d2[_0x3ae4a3]['primary_code']=_0x4e7b68;}),_0x297f96[_0x44c2ab(0x1aa)]((_0x1b2fa9,_0x1a6b4b)=>{var _0x5663a2=_0x44c2ab;_0x1e44d2[_0x1a6b4b][_0x5663a2(0x17e)]=_0x1b2fa9;}),_0x5da935['forEach']((_0x195e53,_0x549e42)=>{var _0xe3341f=_0x44c2ab;_0x1e44d2[_0x549e42][_0xe3341f(0x19f)]=_0x195e53;});const _0x513b09=_0x1e44d2[_0x44c2ab(0x1db)](_0x34be09=>_0x34be09[_0x44c2ab(0x200)]!=='0'&&_0x34be09[_0x44c2ab(0x200)]!=='');var _0x307b36=0x0;_0x513b09[_0x44c2ab(0x1aa)](_0x3b70ed=>{var _0x5c0dae=_0x44c2ab;console[_0x5c0dae(0x1ab)](_0x5c0dae(0x178),_0x3b70ed),parseInt(_0x3b70ed['adjust_qty'])<=0x0&&_0x307b36++;});if(_0x307b36!=0x0)return _0x54bbd1[_0x44c2ab(0x160)]('errors',_0x44c2ab(0x18f)),_0xe5c833['redirect'](_0x44c2ab(0x20d));const _0xc7ce93=new adjustment({'warehouse_name':_0x2b85e5,'date':_0x19d1d2,'product':_0x513b09,'note':_0x129692,'room':_0x260626,'invoice':_0x3fcd93,'JO_number':_0x2a3535,'expiry_date':_0x54091e}),_0x1eff28=await _0xc7ce93['save']();_0x54bbd1[_0x44c2ab(0x160)](_0x44c2ab(0x1f7),_0x44c2ab(0x215)),_0xe5c833[_0x44c2ab(0x1dd)]('/adjustment/preview/'+_0x1eff28[_0x44c2ab(0x1e8)]);}catch(_0x1a64ef){console['log'](_0x1a64ef),_0xe5c833[_0x44c2ab(0x1a0)](0xc8)[_0x44c2ab(0x1c9)]({'message':_0x1a64ef[_0x44c2ab(0x1e2)]});}}),router[a0_0x4e1c3a(0x1f9)](a0_0x4e1c3a(0x175),auth,async(_0x1ec707,_0x469d85)=>{var _0x1e437=a0_0x4e1c3a;try{const {username:_0x60d958,email:_0x256419,role:_0x1c3030}=_0x1ec707[_0x1e437(0x15c)],_0x291ad6=_0x1ec707[_0x1e437(0x15c)],_0x42c72b=await profile['findOne']({'email':_0x291ad6['email']}),_0x3fb2c5=await master_shop[_0x1e437(0x1df)](),_0x59f64d=_0x1ec707['params']['id'],_0x4813f3=await adjustment[_0x1e437(0x1ba)]({'_id':_0x59f64d}),_0x2a189c=await purchases[_0x1e437(0x1c5)]([{'$match':{'warehouse_name':_0x4813f3['warehouse_name']}},{'$unwind':_0x1e437(0x193)},{'$group':{'_id':_0x1e437(0x1bb)}}]),_0x225eea=await product[_0x1e437(0x1df)]({}),_0x1dfbc6=await warehouse['aggregate']([{'$match':{'name':_0x4813f3['warehouse_name']}},{'$unwind':_0x1e437(0x166)},{'$group':{'_id':_0x1e437(0x17c),'name':{'$first':_0x1e437(0x188)},'product_stock':{'$first':_0x1e437(0x198)},'bay':{'$first':_0x1e437(0x1ac)},'bin':{'$first':_0x1e437(0x1fa)},'type':{'$first':_0x1e437(0x1e3)},'floorlevel':{'$first':_0x1e437(0x167)},'primary_code':{'$first':_0x1e437(0x18e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1e437(0x159)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1e437(0x157)},'maxPerUnit':{'$first':_0x1e437(0x179)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1e437(0x1d6)},'batch_code':{'$first':_0x1e437(0x192)},'room':{'$first':'$room'}}}]);if(_0x3fb2c5[0x0]['language']==_0x1e437(0x16c)){var _0x300706=users[_0x1e437(0x21b)];console[_0x1e437(0x1ab)](_0x300706);}else{if(_0x3fb2c5[0x0][_0x1e437(0x1b0)]==_0x1e437(0x20b))var _0x300706=users[_0x1e437(0x20b)];else{if(_0x3fb2c5[0x0][_0x1e437(0x1b0)]==_0x1e437(0x1a2))var _0x300706=users[_0x1e437(0x1a2)];else{if(_0x3fb2c5[0x0][_0x1e437(0x1b0)]==_0x1e437(0x1b4))var _0x300706=users[_0x1e437(0x1b4)];else{if(_0x3fb2c5[0x0]['language']==_0x1e437(0x1e9))var _0x300706=users[_0x1e437(0x1e9)];else{if(_0x3fb2c5[0x0][_0x1e437(0x1b0)]==_0x1e437(0x1c1))var _0x300706=users['Portuguese'];else{if(_0x3fb2c5[0x0][_0x1e437(0x1b0)]==_0x1e437(0x1a7))var _0x300706=users[_0x1e437(0x1a7)];else{if(_0x3fb2c5[0x0]['language']==_0x1e437(0x1d0))var _0x300706=users[_0x1e437(0x1de)];}}}}}}}_0x469d85['render'](_0x1e437(0x1d5),{'success':_0x1ec707['flash'](_0x1e437(0x1f7)),'errors':_0x1ec707[_0x1e437(0x160)](_0x1e437(0x1bd)),'role':_0x291ad6,'profile':_0x42c72b,'adjustment':_0x4813f3,'stock':_0x1dfbc6,'master_shop':_0x3fb2c5,'warehouse_name':_0x2a189c,'unit':_0x225eea,'language':_0x300706});}catch(_0x28c386){console[_0x1e437(0x1ab)](_0x28c386),_0x469d85[_0x1e437(0x1a0)](0xc8)[_0x1e437(0x1c9)]({'message':_0x28c386['message']});}}),router[a0_0x4e1c3a(0x1be)](a0_0x4e1c3a(0x175),auth,async(_0x4f197a,_0x3141b7)=>{var _0x585e13=a0_0x4e1c3a;try{const _0x494083=_0x4f197a[_0x585e13(0x19b)]['id'],{warehouse_name:_0x543e9a,Room_name:_0x185c5e}=_0x4f197a['body'],_0x50ae9a=await adjustment['findById']({'_id':_0x494083}),_0x20782e=_0x50ae9a[_0x585e13(0x214)][_0x585e13(0x1ff)](async _0x196abf=>{var _0x2e8569=_0x585e13;if(_0x196abf['adjust_qty']>0x0){var _0x378969=await warehouse[_0x2e8569(0x1f5)]({'name':_0x543e9a,'room':_0x196abf[_0x2e8569(0x1f2)],'warehouse_category':_0x2e8569(0x194)});const _0x44ca47=_0x378969[_0x2e8569(0x169)][_0x2e8569(0x1ff)](_0x1909e6=>{var _0x1e9fdb=_0x2e8569;if(_0x196abf[_0x1e9fdb(0x176)]=='minus'){if(_0x1909e6['product_name']==_0x196abf[_0x1e9fdb(0x1ec)]&&_0x1909e6[_0x1e9fdb(0x204)]==_0x196abf[_0x1e9fdb(0x204)]&&_0x1909e6['type']==_0x196abf[_0x1e9fdb(0x176)]&&_0x1909e6[_0x1e9fdb(0x1b3)]==_0x196abf['bin']&&_0x1909e6[_0x1e9fdb(0x1ea)]==_0x196abf[_0x1e9fdb(0x1ea)]&&_0x1909e6[_0x1e9fdb(0x1a4)]==_0x196abf[_0x1e9fdb(0x1a4)]&&_0x1909e6[_0x1e9fdb(0x21c)]==_0x196abf[_0x1e9fdb(0x21c)]&&_0x1909e6[_0x1e9fdb(0x18d)]==_0x196abf[_0x1e9fdb(0x18d)]&&_0x1909e6[_0x1e9fdb(0x171)]==_0x196abf[_0x1e9fdb(0x171)]&&_0x1909e6[_0x1e9fdb(0x222)]==_0x196abf[_0x1e9fdb(0x222)]&&_0x1909e6[_0x1e9fdb(0x19f)]==_0x196abf[_0x1e9fdb(0x19f)]){var _0x409c4a;_0x409c4a=_0x196abf[_0x1e9fdb(0x200)],_0x196abf['prod_cat']=='S'&&(_0x409c4a=_0x196abf[_0x1e9fdb(0x200)]),_0x1909e6[_0x1e9fdb(0x20f)]=_0x1909e6['product_stock']-_0x409c4a;}}else{if(_0x1909e6[_0x1e9fdb(0x1ec)]==_0x196abf[_0x1e9fdb(0x1ec)]&&_0x1909e6[_0x1e9fdb(0x204)]==_0x196abf['floorlevel']&&_0x1909e6[_0x1e9fdb(0x176)]==_0x196abf[_0x1e9fdb(0x176)]&&_0x1909e6[_0x1e9fdb(0x1b3)]==_0x196abf[_0x1e9fdb(0x1b3)]&&_0x1909e6[_0x1e9fdb(0x1ea)]==_0x196abf['bay']&&_0x1909e6[_0x1e9fdb(0x1a4)]==_0x196abf[_0x1e9fdb(0x1a4)]&&_0x1909e6[_0x1e9fdb(0x21c)]==_0x196abf['storage']&&_0x1909e6['expiry_date']==_0x196abf[_0x1e9fdb(0x18d)]&&_0x1909e6[_0x1e9fdb(0x171)]==_0x196abf[_0x1e9fdb(0x171)]&&_0x1909e6[_0x1e9fdb(0x222)]==_0x196abf[_0x1e9fdb(0x222)]&&_0x1909e6['invoice']==_0x196abf[_0x1e9fdb(0x19f)]){console[_0x1e9fdb(0x1ab)](_0x196abf);var _0x409c4a;_0x409c4a=_0x196abf[_0x1e9fdb(0x200)],_0x196abf[_0x1e9fdb(0x211)]=='S'&&(_0x409c4a=_0x196abf['adjust_qty']),console[_0x1e9fdb(0x1ab)](_0x409c4a+_0x1e9fdb(0x19d)+_0x196abf[_0x1e9fdb(0x200)]+'\x20<>\x20'+_0x1909e6[_0x1e9fdb(0x197)]+'\x20<>\x20'+_0x196abf[_0x1e9fdb(0x211)]),_0x1909e6['product_stock']=_0x1909e6[_0x1e9fdb(0x20f)]+_0x409c4a;}}});}return _0x378969;});Promise['all'](_0x20782e)[_0x585e13(0x195)](async _0x14869b=>{var _0x426245=_0x585e13;try{for(const _0x2956fd of _0x14869b){await _0x2956fd[_0x426245(0x1f6)]();}_0x50ae9a[_0x426245(0x1c8)]=_0x426245(0x1b2);const _0x412408=await _0x50ae9a[_0x426245(0x1f6)](),_0x19caaa=await master_shop[_0x426245(0x1df)](),_0x19fe27=await email_settings[_0x426245(0x1f5)](),_0x1fc1f8=await supervisor_settings[_0x426245(0x1df)]();var _0x4f113a=_0x50ae9a[_0x426245(0x214)],_0xb04f44='',_0x427e47;for(_0x427e47 in _0x4f113a){_0xb04f44+=_0x426245(0x161)+_0x426245(0x1f4)+_0x4f113a[_0x427e47][_0x426245(0x1ec)]+_0x426245(0x21a)+_0x426245(0x1f4)+_0x4f113a[_0x427e47]['product_code']+_0x426245(0x21a)+_0x426245(0x1f4)+_0x4f113a[_0x427e47][_0x426245(0x200)]+_0x426245(0x21a)+_0x426245(0x1f4)+_0x4f113a[_0x427e47][_0x426245(0x173)]+'</td>'+_0x426245(0x1f4)+_0x4f113a[_0x427e47]['secondary_unit']+_0x426245(0x21a)+_0x426245(0x1f4)+_0x50ae9a['warehouse_name']+_0x426245(0x21a)+_0x426245(0x1f4)+_0x4f113a[_0x427e47]['room_names']+_0x426245(0x21a)+_0x426245(0x1f4)+_0x4f113a[_0x427e47]['storage']+_0x4f113a[_0x427e47][_0x426245(0x1a4)]+_0x4f113a[_0x427e47][_0x426245(0x1ea)]+_0x4f113a[_0x427e47][_0x426245(0x1b3)]+_0x4f113a[_0x427e47][_0x426245(0x176)][0x0]+_0x4f113a[_0x427e47][_0x426245(0x204)]+'</td>',_0x426245(0x17a);}let _0x17e91c=nodemailer[_0x426245(0x158)]({'host':_0x19fe27[_0x426245(0x15b)],'port':Number(_0x19fe27[_0x426245(0x1d9)]),'secure':![],'auth':{'user':_0x19fe27[_0x426245(0x199)],'pass':_0x19fe27[_0x426245(0x224)]}}),_0x3105a8={'from':_0x19fe27['email'],'to':_0x1fc1f8[0x0][_0x426245(0x16d)],'subject':_0x426245(0x1b5),'attachments':[{'filename':_0x426245(0x1c2),'path':__dirname+_0x426245(0x1d8)+_0x426245(0x219)+_0x19caaa[0x0][_0x426245(0x1cb)],'cid':_0x426245(0x22a)}],'html':_0x426245(0x1b8)+_0x426245(0x1d3)+_0x426245(0x1eb)+_0x426245(0x15a)+_0x426245(0x1d1)+_0x426245(0x15a)+_0x426245(0x16e)+_0x426245(0x1ae)+_0x426245(0x15a)+_0x426245(0x15f)+_0x19caaa[0x0][_0x426245(0x22e)]+_0x426245(0x183)+'</div>'+'</div>'+_0x426245(0x172)+'<div>'+_0x426245(0x181)+_0x426245(0x16f)+_0x50ae9a['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x426245(0x1c0)+_0x50ae9a['date']+'\x20'+_0x426245(0x22d)+_0x426245(0x1ca)+_0x426245(0x1ae)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x426245(0x202)+_0x426245(0x17f)+_0x426245(0x186)+_0x426245(0x18c)+_0x426245(0x190)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+_0x426245(0x1b1)+_0x426245(0x189)+'\x20'+_0xb04f44+'\x20'+_0x426245(0x1dc)+_0x426245(0x227)+_0x426245(0x15a)+_0x426245(0x1f3)+_0x426245(0x1a6)+_0x19caaa[0x0]['site_title']+_0x426245(0x1ca)+_0x426245(0x1ae)+_0x426245(0x1ae)+'</body></html>'};_0x17e91c[_0x426245(0x1c7)](_0x3105a8,function(_0x16ebe2,_0x39ccc8){var _0x56da12=_0x426245;_0x16ebe2?(console[_0x56da12(0x1ab)](_0x16ebe2),console[_0x56da12(0x1ab)]('Error\x20Occurs')):console[_0x56da12(0x1ab)](_0x56da12(0x1b7));}),_0x4f197a[_0x426245(0x160)](_0x426245(0x1f7),_0x426245(0x220)),_0x3141b7[_0x426245(0x1dd)](_0x426245(0x1e1)+_0x412408['_id']);}catch(_0x4f76ec){console[_0x426245(0x1cf)](_0x4f76ec),_0x3141b7[_0x426245(0x1a0)](0x1f4)[_0x426245(0x1c9)]({'error':_0x426245(0x163)});}})['catch'](_0x3a9d01=>{var _0x127a44=_0x585e13;console[_0x127a44(0x1cf)](_0x3a9d01),_0x3141b7[_0x127a44(0x1a0)](0x1f4)[_0x127a44(0x1c9)]({'error':'An\x20error\x20occurred.'});});}catch(_0x10d6e0){console[_0x585e13(0x1ab)](_0x10d6e0),_0x3141b7[_0x585e13(0x1a0)](0xc8)['json']({'message':_0x10d6e0[_0x585e13(0x1e2)]});}}),router[a0_0x4e1c3a(0x1f9)](a0_0x4e1c3a(0x1d2),auth,async(_0x48a785,_0x411746)=>{var _0x40aa04=a0_0x4e1c3a;try{const {username:_0x1a6173,email:_0x35f8b5,role:_0x12f69e}=_0x48a785[_0x40aa04(0x15c)],_0x34138b=_0x48a785['user'],_0x4e1acc=await profile[_0x40aa04(0x1f5)]({'email':_0x34138b[_0x40aa04(0x199)]}),_0x4c945c=await master_shop[_0x40aa04(0x1df)](),_0x5c0152=_0x48a785[_0x40aa04(0x19b)]['id'],_0x598a86=await adjustment[_0x40aa04(0x1ba)]({'_id':_0x5c0152}),_0x5f2d7c=await purchases[_0x40aa04(0x1c5)]([{'$match':{'warehouse_name':_0x598a86[_0x40aa04(0x1e0)]}},{'$unwind':_0x40aa04(0x193)},{'$group':{'_id':_0x40aa04(0x1bb)}}]),_0x9eb4e3=await product['find']({}),_0x30f627=await warehouse[_0x40aa04(0x1c5)]([{'$match':{'name':_0x598a86[_0x40aa04(0x1e0)]}},{'$unwind':_0x40aa04(0x166)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x40aa04(0x188)},'product_stock':{'$first':_0x40aa04(0x198)},'bay':{'$first':_0x40aa04(0x1ac)},'bin':{'$first':_0x40aa04(0x1fa)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x40aa04(0x167)},'primary_code':{'$first':_0x40aa04(0x18e)},'secondary_code':{'$first':_0x40aa04(0x156)},'product_code':{'$first':_0x40aa04(0x159)},'storage':{'$first':_0x40aa04(0x1ed)},'rack':{'$first':_0x40aa04(0x157)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x40aa04(0x205)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x40aa04(0x192)},'room':{'$first':_0x40aa04(0x1fb)}}}]);let _0x2f7b12;if(_0x34138b[_0x40aa04(0x16a)]=='staff'){const _0x5e966c=await staff[_0x40aa04(0x1f5)]({'email':_0x34138b[_0x40aa04(0x199)]});_0x2f7b12=await warehouse[_0x40aa04(0x1c5)]([{'$match':{'status':_0x40aa04(0x216),'name':_0x5e966c[_0x40aa04(0x206)],'warehouse_category':_0x40aa04(0x194),'name':{'$ne':_0x40aa04(0x218)}}},{'$group':{'_id':_0x40aa04(0x1a1),'name':{'$first':'$name'}}}]);}else _0x2f7b12=await warehouse['aggregate']([{'$match':{'status':_0x40aa04(0x216),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x40aa04(0x218)}}},{'$group':{'_id':_0x40aa04(0x1a1),'name':{'$first':_0x40aa04(0x1a1)}}}]);if(_0x4c945c[0x0]['language']=='English\x20(US)'){var _0x495b58=users['English'];console[_0x40aa04(0x1ab)](_0x495b58);}else{if(_0x4c945c[0x0][_0x40aa04(0x1b0)]==_0x40aa04(0x20b))var _0x495b58=users['Hindi'];else{if(_0x4c945c[0x0]['language']==_0x40aa04(0x1a2))var _0x495b58=users['German'];else{if(_0x4c945c[0x0][_0x40aa04(0x1b0)]==_0x40aa04(0x1b4))var _0x495b58=users[_0x40aa04(0x1b4)];else{if(_0x4c945c[0x0][_0x40aa04(0x1b0)]==_0x40aa04(0x1e9))var _0x495b58=users['French'];else{if(_0x4c945c[0x0]['language']==_0x40aa04(0x1c1))var _0x495b58=users[_0x40aa04(0x21e)];else{if(_0x4c945c[0x0][_0x40aa04(0x1b0)]==_0x40aa04(0x1a7))var _0x495b58=users[_0x40aa04(0x1a7)];else{if(_0x4c945c[0x0]['language']==_0x40aa04(0x1d0))var _0x495b58=users[_0x40aa04(0x1de)];}}}}}}}_0x411746[_0x40aa04(0x1c6)]('edit_adjustment',{'success':_0x48a785[_0x40aa04(0x160)]('success'),'errors':_0x48a785[_0x40aa04(0x160)]('errors'),'role':_0x34138b,'profile':_0x4e1acc,'adjustment':_0x598a86,'stock':_0x30f627,'master_shop':_0x4c945c,'warehouse_name':_0x5f2d7c,'unit':_0x9eb4e3,'language':_0x495b58,'warehouse':_0x2f7b12});}catch(_0x470961){console['log'](_0x470961),_0x411746[_0x40aa04(0x1a0)](0xc8)[_0x40aa04(0x1c9)]({'message':_0x470961[_0x40aa04(0x1e2)]});}}),router['post'](a0_0x4e1c3a(0x1d2),auth,async(_0x42d34b,_0x17a519)=>{var _0x5e1b56=a0_0x4e1c3a;try{const _0x2280cb=_0x42d34b[_0x5e1b56(0x19b)]['id'],_0x3f274c=await adjustment[_0x5e1b56(0x1ba)]({'_id':_0x2280cb}),_0x196228=await warehouse[_0x5e1b56(0x1f5)]({'name':_0x3f274c[_0x5e1b56(0x1e0)],'room':_0x3f274c[_0x5e1b56(0x155)]}),{warehouse_name:_0x498d78,date:_0x57a4e0,prod_name:_0x3d36e1,level:_0x1e6759,isle:_0x11db07,pallet:_0x5088e0,stock:_0x401e2a,types:_0x1c3304,adjust_qty:_0x34aefc,new_adjust_qty:_0x898e8b,note:_0x3aed30,Room_name:_0x4fe636,invoice:_0x407982,JO_number:_0x347848,expiry_date:_0x3084ac}=_0x42d34b[_0x5e1b56(0x1c4)];if(typeof _0x3d36e1==_0x5e1b56(0x1ad))var _0x591451=[_0x42d34b['body'][_0x5e1b56(0x1ef)]],_0xae84af=[_0x42d34b[_0x5e1b56(0x1c4)]['level']],_0x200449=[_0x42d34b[_0x5e1b56(0x1c4)]['stock']],_0x3664c4=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1e7)]],_0x2d1eb0=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x21f)]],_0x409ded=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1bc)]],_0x50a0ad=[_0x42d34b['body'][_0x5e1b56(0x1f0)]],_0x3a75d0=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1a8)]],_0x40d707=[_0x42d34b['body'][_0x5e1b56(0x164)]],_0x4ec997=[_0x42d34b['body'][_0x5e1b56(0x171)]],_0x299468=[_0x42d34b['body'][_0x5e1b56(0x18d)]],_0x154c18=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1da)]],_0x7eef17=[_0x42d34b['body'][_0x5e1b56(0x222)]],_0x1033d1=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x211)]],_0x1c6ffa=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1a5)]],_0x5a20c4=[_0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x229)]],_0x3fd8f5=[_0x42d34b['body']['second1']];else var _0x591451=[..._0x42d34b['body'][_0x5e1b56(0x1ef)]],_0xae84af=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1af)]],_0x200449=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x207)]],_0x3664c4=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1e7)]],_0x2d1eb0=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x21f)]],_0x409ded=[..._0x42d34b['body'][_0x5e1b56(0x1bc)]],_0x50a0ad=[..._0x42d34b['body']['unit']],_0x3a75d0=[..._0x42d34b['body']['Secondary_units']],_0x40d707=[..._0x42d34b[_0x5e1b56(0x1c4)]['prod_code']],_0x4ec997=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x171)]],_0x299468=[..._0x42d34b['body'][_0x5e1b56(0x18d)]],_0x154c18=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1da)]],_0x7eef17=[..._0x42d34b['body'][_0x5e1b56(0x222)]],_0x1033d1=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x211)]],_0x1c6ffa=[..._0x42d34b[_0x5e1b56(0x1c4)][_0x5e1b56(0x1a5)]],_0x5a20c4=[..._0x42d34b[_0x5e1b56(0x1c4)]['prime1']],_0x3fd8f5=[..._0x42d34b['body']['second1']];const _0x55c768=_0x591451[_0x5e1b56(0x1ff)](_0xa318fa=>{return _0xa318fa={'product_name':_0xa318fa};});_0xae84af[_0x5e1b56(0x1aa)]((_0x24fe98,_0x5c5a05)=>{var _0x275090=_0x5e1b56;_0x1c6ffa[_0x275090(0x1aa)]((_0x1ec738,_0x41f67b)=>{var _0x3e814e=_0x275090;if(_0x1ec738==_0x3e814e(0x203)&&_0x5c5a05==_0x41f67b){var _0x35782c=_0x24fe98['slice'](0x3);_0x55c768[_0x5c5a05][_0x3e814e(0x21c)]=_0x24fe98[0x0],_0x55c768[_0x5c5a05][_0x3e814e(0x1a4)]=_0x24fe98[0x1],_0x55c768[_0x5c5a05][_0x3e814e(0x1ea)]=0x0,_0x55c768[_0x5c5a05]['bin']=0x0,_0x55c768[_0x5c5a05][_0x3e814e(0x176)]=_0x3e814e(0x20a),_0x55c768[_0x5c5a05][_0x3e814e(0x204)]=_0x35782c;}else{if(_0x1ec738==_0x3e814e(0x165)&&_0x5c5a05==_0x41f67b){var _0x35782c=_0x24fe98[_0x3e814e(0x223)](0x3);_0x55c768[_0x5c5a05][_0x3e814e(0x21c)]=_0x24fe98[0x0],_0x55c768[_0x5c5a05][_0x3e814e(0x1a4)]=_0x24fe98[0x1],_0x55c768[_0x5c5a05][_0x3e814e(0x1ea)]=0x0,_0x55c768[_0x5c5a05]['bin']=0x0,_0x55c768[_0x5c5a05][_0x3e814e(0x176)]='Floor',_0x55c768[_0x5c5a05][_0x3e814e(0x204)]=_0x24fe98[0x5];}else{if(_0x5c5a05==_0x41f67b){var _0xde15c4;if(_0x24fe98[0x4]=='L')_0xde15c4='Level';else _0x24fe98[0x4]=='F'&&(_0xde15c4='Floor');_0x55c768[_0x5c5a05][_0x3e814e(0x21c)]=_0x24fe98[0x0],_0x55c768[_0x5c5a05][_0x3e814e(0x1a4)]=_0x24fe98[0x1],_0x55c768[_0x5c5a05][_0x3e814e(0x1ea)]=_0x24fe98[0x2],_0x55c768[_0x5c5a05]['bin']=_0x24fe98[0x3],_0x55c768[_0x5c5a05]['type']=_0xde15c4,_0x55c768[_0x5c5a05][_0x3e814e(0x204)]=_0x24fe98[0x5];}}}});}),_0x200449[_0x5e1b56(0x1aa)]((_0x4c159d,_0x153937)=>{var _0x3a35d6=_0x5e1b56;_0x55c768[_0x153937][_0x3a35d6(0x177)]=_0x4c159d;}),_0x3664c4[_0x5e1b56(0x1aa)]((_0x4822c8,_0x6acb1b)=>{var _0xbf1324=_0x5e1b56;_0x55c768[_0x6acb1b][_0xbf1324(0x1e7)]=_0x4822c8;}),_0x2d1eb0[_0x5e1b56(0x1aa)]((_0x4b2631,_0x4b51f5)=>{var _0x11dacb=_0x5e1b56;_0x55c768[_0x4b51f5][_0x11dacb(0x200)]=_0x4b2631;}),_0x409ded[_0x5e1b56(0x1aa)]((_0x2f24ef,_0x1e19e7)=>{var _0x251fdd=_0x5e1b56;_0x55c768[_0x1e19e7][_0x251fdd(0x22c)]=_0x2f24ef;}),_0x50a0ad[_0x5e1b56(0x1aa)]((_0x3e063e,_0x529aa7)=>{var _0x207957=_0x5e1b56;_0x55c768[_0x529aa7][_0x207957(0x173)]=_0x3e063e;}),_0x3a75d0['forEach']((_0x278c2f,_0x5e4e1d)=>{_0x55c768[_0x5e4e1d]['secondary_unit']=_0x278c2f;}),_0x40d707[_0x5e1b56(0x1aa)]((_0x281ced,_0x1746c1)=>{var _0x20d463=_0x5e1b56;_0x55c768[_0x1746c1][_0x20d463(0x226)]=_0x281ced;}),_0x4ec997[_0x5e1b56(0x1aa)]((_0x1918e2,_0x229498)=>{_0x55c768[_0x229498]['batch_code']=_0x1918e2;}),_0x299468[_0x5e1b56(0x1aa)]((_0x34329b,_0x47b654)=>{var _0x129ec5=_0x5e1b56;_0x55c768[_0x47b654][_0x129ec5(0x18d)]=_0x34329b;}),_0x154c18[_0x5e1b56(0x1aa)]((_0x51853a,_0x1fa09e)=>{_0x55c768[_0x1fa09e]['maxperunit']=_0x51853a;}),_0x7eef17[_0x5e1b56(0x1aa)]((_0x3bdc82,_0x62a7fa)=>{_0x55c768[_0x62a7fa]['production_date']=_0x3bdc82;}),_0x1033d1['forEach']((_0x8943b4,_0x3eb5a7)=>{_0x55c768[_0x3eb5a7]['prod_cat']=_0x8943b4;}),_0x1c6ffa['forEach']((_0x7894b3,_0x5aa74a)=>{var _0x43a73d=_0x5e1b56;_0x55c768[_0x5aa74a][_0x43a73d(0x1f2)]=_0x7894b3;}),_0x5a20c4['forEach']((_0x2ef25a,_0x10891b)=>{var _0x5b1d17=_0x5e1b56;_0x55c768[_0x10891b][_0x5b1d17(0x191)]=_0x2ef25a;}),_0x3fd8f5['forEach']((_0x4a75ed,_0x18ef92)=>{var _0x549764=_0x5e1b56;_0x55c768[_0x18ef92][_0x549764(0x17e)]=_0x4a75ed;});const _0x283dde=_0x55c768['filter'](_0x43adca=>_0x43adca[_0x5e1b56(0x200)]!=='0'&&_0x43adca[_0x5e1b56(0x200)]!=='');var _0x419afe=0x0;_0x283dde[_0x5e1b56(0x1aa)](_0x4872d5=>{var _0x48ac51=_0x5e1b56;console[_0x48ac51(0x1ab)](_0x48ac51(0x178),_0x4872d5),parseInt(_0x4872d5['adjust_qty'])<=0x0&&_0x419afe++;});if(_0x419afe!=0x0)return _0x42d34b[_0x5e1b56(0x160)]('errors',_0x5e1b56(0x18f)),_0x17a519[_0x5e1b56(0x1dd)](_0x5e1b56(0x20d));_0x3f274c[_0x5e1b56(0x1e0)]=_0x498d78,_0x3f274c[_0x5e1b56(0x208)]=_0x57a4e0,_0x3f274c[_0x5e1b56(0x214)]=_0x283dde,_0x3f274c[_0x5e1b56(0x1a3)]=_0x3aed30,_0x3f274c[_0x5e1b56(0x19f)]=_0x407982,_0x3f274c[_0x5e1b56(0x168)]=_0x5e1b56(0x180);const _0x3064f4=await _0x3f274c['save']();_0x42d34b[_0x5e1b56(0x160)](_0x5e1b56(0x1f7),_0x5e1b56(0x221)),_0x17a519[_0x5e1b56(0x1dd)](_0x5e1b56(0x1cd));}catch(_0x104909){console[_0x5e1b56(0x1ab)](_0x104909);}}),router[a0_0x4e1c3a(0x1be)](a0_0x4e1c3a(0x15d),async(_0x240963,_0x203f1a)=>{var _0x1e26ee=a0_0x4e1c3a;const {primary_code:_0x3a43d2,warehouse_data:_0x31378a,rooms_data:_0x3ac38e,Roomslist:_0x10fa1d}=_0x240963[_0x1e26ee(0x1c4)],_0x2bf6a4=_0x10fa1d[_0x1e26ee(0x1e6)](','),_0x4ba863=[];async function _0x490038(_0x365a91){var _0x3dbbcd=_0x1e26ee;const _0x160bc2=await warehouse[_0x3dbbcd(0x1c5)]([{'$match':{'name':_0x31378a,'room':_0x365a91}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x3a43d2}},{'$group':{'_id':_0x3dbbcd(0x17c),'name':{'$first':_0x3dbbcd(0x188)},'product_stock':{'$first':_0x3dbbcd(0x198)},'primary_code':{'$first':_0x3dbbcd(0x18e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3dbbcd(0x159)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3dbbcd(0x1fa)},'type':{'$first':_0x3dbbcd(0x1e3)},'pallet':{'$first':_0x3dbbcd(0x167)},'unit':{'$first':_0x3dbbcd(0x1ee)},'secondary_unit':{'$first':_0x3dbbcd(0x1c3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3dbbcd(0x1d6)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3dbbcd(0x154)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3dbbcd(0x1fb)}}}]),_0x4cd73e=await warehouse[_0x3dbbcd(0x1c5)]([{'$match':{'name':_0x31378a,'room':_0x365a91}},{'$unwind':_0x3dbbcd(0x166)},{'$match':{'product_details.secondary_code':_0x3a43d2}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3dbbcd(0x188)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3dbbcd(0x156)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3dbbcd(0x1ac)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3dbbcd(0x1ee)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3dbbcd(0x1ed)},'rack':{'$first':_0x3dbbcd(0x157)},'expiry_date':{'$first':_0x3dbbcd(0x205)},'production_date':{'$first':_0x3dbbcd(0x1d6)},'maxPerUnit':{'$first':_0x3dbbcd(0x179)},'batch_code':{'$first':_0x3dbbcd(0x192)},'product_cat':{'$first':_0x3dbbcd(0x154)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x160bc2[_0x3dbbcd(0x153)]>0x0)_0x4ba863['push'](_0x160bc2);else _0x4cd73e['length']>0x0&&_0x4ba863['push'](_0x4cd73e);}const _0x1eb144=_0x2bf6a4['map'](_0xcddaba=>_0x490038(_0xcddaba));await Promise[_0x1e26ee(0x1ce)](_0x1eb144),_0x203f1a[_0x1e26ee(0x1c9)](_0x4ba863);}),router['post'](a0_0x4e1c3a(0x162),async(_0x2ef359,_0x5ad968)=>{var _0x575f8c=a0_0x4e1c3a;const {primaryCode:_0x1588df,secondaryCode:_0x4b5c20,productCode:_0x1a6b4d,level:_0x32d8eb,isle:_0x50c248,pallet:_0x1f9b2a,warehouses:_0x471168,room:_0x647699}=_0x2ef359[_0x575f8c(0x1c4)];try{const _0x365d6a=await warehouse[_0x575f8c(0x1c5)]([{'$match':{'name':_0x471168,'room':_0x647699}},{'$unwind':_0x575f8c(0x166)},{'$match':{'product_details.level':parseInt(_0x32d8eb),'product_details.isle':_0x50c248,'product_details.pallet':parseInt(_0x1f9b2a)}},{'$group':{'_id':_0x575f8c(0x17c),'name':{'$first':_0x575f8c(0x188)},'product_stock':{'$first':_0x575f8c(0x198)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x575f8c(0x1b6)},'pallet':{'$first':_0x575f8c(0x228)},'maxProducts':{'$first':_0x575f8c(0x19e)}}}]);_0x5ad968[_0x575f8c(0x1a0)](0xc8)[_0x575f8c(0x1c9)](_0x365d6a);}catch(_0x23dda0){_0x5ad968[_0x575f8c(0x1a0)](0x194)[_0x575f8c(0x1c9)]({'message':_0x23dda0[_0x575f8c(0x1e2)]});}}),module[a0_0x4e1c3a(0x209)]=router;