var a0_0x2d8a71=a0_0x5eb2;(function(_0x18adf7,_0xce16f7){var _0x1a4607=a0_0x5eb2,_0x46f7fe=_0x18adf7();while(!![]){try{var _0x458fa5=parseInt(_0x1a4607(0xbb))/0x1*(-parseInt(_0x1a4607(0x119))/0x2)+parseInt(_0x1a4607(0xe6))/0x3+-parseInt(_0x1a4607(0xca))/0x4+-parseInt(_0x1a4607(0xd7))/0x5*(parseInt(_0x1a4607(0xac))/0x6)+parseInt(_0x1a4607(0xd1))/0x7+-parseInt(_0x1a4607(0xc3))/0x8*(parseInt(_0x1a4607(0xe9))/0x9)+parseInt(_0x1a4607(0xcc))/0xa*(parseInt(_0x1a4607(0xdf))/0xb);if(_0x458fa5===_0xce16f7)break;else _0x46f7fe['push'](_0x46f7fe['shift']());}catch(_0x123fa3){_0x46f7fe['push'](_0x46f7fe['shift']());}}}(a0_0x426d,0xe792b));const express=require(a0_0x2d8a71(0x16a)),app=express(),router=express[a0_0x2d8a71(0x107)](),auth=require(a0_0x2d8a71(0x158)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x2d8a71(0x147)),users=require(a0_0x2d8a71(0x14e)),nodemailer=require(a0_0x2d8a71(0x161));router['get'](a0_0x2d8a71(0xce),auth,async(_0x59b64b,_0xdb3c0d)=>{var _0x20d109=a0_0x2d8a71;try{const {username:_0x23af75,email:_0x3c0099,role:_0xc34a}=_0x59b64b[_0x20d109(0x11d)],_0x1c9076=_0x59b64b[_0x20d109(0x11d)],_0x561d10=await profile[_0x20d109(0x103)]({'email':_0x1c9076[_0x20d109(0x121)]}),_0x57e1f4=await master_shop[_0x20d109(0xd3)]();console[_0x20d109(0xdc)](_0x20d109(0x168),_0x57e1f4);let _0x53217d;if(_0x1c9076['role']==_0x20d109(0xb7)){const _0x56e276=await staff['findOne']({'email':_0x1c9076['email']});_0x53217d=await warehouse['find']({'status':_0x20d109(0xab),'name':_0x56e276['warehouse']});}else _0x53217d=await warehouse[_0x20d109(0xd3)]({'status':_0x20d109(0xab)});const _0x51a99d=await product[_0x20d109(0xd3)]();let _0x60b88;if(_0x1c9076[_0x20d109(0xc9)]==_0x20d109(0xb7)){const _0x1efc5c=await staff[_0x20d109(0x103)]({'email':_0x1c9076['email']});_0x60b88=await adjustment[_0x20d109(0xd3)]({'warehouse_name':_0x1efc5c[_0x20d109(0xc2)]});}else _0x60b88=await adjustment['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x20d109(0x10b),'invoice':{'$first':_0x20d109(0x12d)},'date':{'$first':_0x20d109(0x11c)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x20d109(0xb6)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x20d109(0xa7)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x57e1f4[0x0][_0x20d109(0x15a)]==_0x20d109(0xed)){var _0x8f4cdd=users[_0x20d109(0x16b)];console[_0x20d109(0xdc)](_0x8f4cdd);}else{if(_0x57e1f4[0x0][_0x20d109(0x15a)]==_0x20d109(0x120))var _0x8f4cdd=users[_0x20d109(0x120)];else{if(_0x57e1f4[0x0]['language']==_0x20d109(0x150))var _0x8f4cdd=users[_0x20d109(0x150)];else{if(_0x57e1f4[0x0][_0x20d109(0x15a)]==_0x20d109(0x10f))var _0x8f4cdd=users['Spanish'];else{if(_0x57e1f4[0x0]['language']==_0x20d109(0x11a))var _0x8f4cdd=users[_0x20d109(0x11a)];else{if(_0x57e1f4[0x0][_0x20d109(0x15a)]=='Portuguese\x20(BR)')var _0x8f4cdd=users[_0x20d109(0xc4)];else{if(_0x57e1f4[0x0][_0x20d109(0x15a)]=='Chinese')var _0x8f4cdd=users[_0x20d109(0x127)];else{if(_0x57e1f4[0x0][_0x20d109(0x15a)]==_0x20d109(0xf4))var _0x8f4cdd=users[_0x20d109(0x11f)];}}}}}}}_0xdb3c0d[_0x20d109(0xbf)](_0x20d109(0x105),{'success':_0x59b64b[_0x20d109(0x124)]('success'),'errors':_0x59b64b[_0x20d109(0x124)]('errors'),'role':_0x1c9076,'profile':_0x561d10,'warehouse':_0x53217d,'product':_0x51a99d,'adjustment':_0x60b88,'master_shop':_0x57e1f4,'language':_0x8f4cdd});}catch(_0x2ae57c){console[_0x20d109(0xdc)](_0x2ae57c);}});async function getRandom8DigitNumber(){var _0x462f35=a0_0x2d8a71;const _0x4d13ad=0x989680,_0x45a636=0x5f5e0ff,_0x30caff=Math[_0x462f35(0x101)](Math[_0x462f35(0x100)]()*(_0x45a636-_0x4d13ad+0x1))+_0x4d13ad;var _0x3a3c60;const _0x517e2d=await adjustment[_0x462f35(0x103)]({'invoice':_0x462f35(0x15b)+_0x30caff});return _0x517e2d&&_0x517e2d[_0x462f35(0xfb)]>0x0?_0x3a3c60=_0x462f35(0x15b)+_0x30caff:_0x3a3c60=_0x462f35(0x15b)+_0x30caff,_0x3a3c60;}function a0_0x426d(){var _0x1ebbe7=['/preview/:id','$product_details.pallet','master','</thead>','express','English','port','New_Qty_Converted_adj','maxPerUnit','$product_details.storage','production_date','/CheckingWarehouse','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<span\x20style=\x22float:\x20right;\x22>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Level','<strong>\x20Regards\x20</strong>','createTransport','Return\x20Rooms','\x20Order\x20Number\x20:\x20','Raw\x20Materials','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','_id','status','max_per_unit','room_names','$isAllowEdit','</tbody>','json','level','Enabled','5132964uqSBJj','product','prod_name','padStart','</span>','secondary_unit','Return\x20Goods','$product_details.production_date','adjustment\x20Finalized\x20successfully','$product_details.secondary_code','$product.room_names','staff','</tr>','$product_details.maxPerUnit','product_name','82kZVcrY','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.batch_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','render','$product_details.type','/barcode_scanner','warehouse','290992GnePxr','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','batch_code','<hr\x20class=\x22my-3\x22>','back','role','7361468tVpHYC','</table>','24232140CekYBH','error','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','site_title','8272761uSnLRc','/view/:id','find','Receiving\x20Area','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','5rNCOxq','new_adjust_qty','</h5>','Adjustment\x20Mail','<html><head><title></title>','log','$product','<tbody\x20style=\x22text-align:\x20center;\x22>','11FEmIFq','filter','True','warehouse_name','prod_cat','forEach','</td>','1970811hnePTi','Secondary_units','$product_details','9CeDMRB','isAllowEdit','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.product_cat','English\x20(US)','$product_details.isle','save','$product_details.rack','<h5\x20style=\x22text-align:\x20left;\x22>','adjust_qty','/adjustment/preview/','Arabic\x20(ae)','$product_details.maxProducts','primary_code','body','slice','catch','rack','length','errors','\x20</h2>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','prod_invoice','random','floor','</head><body>','findOne','unit','adjustment','$product_details.expiry_date','Router','$product_details.bin','Enclosed','date','$_id','type','host','prime1','Spanish','adjustment\x20data\x20update\x20successfully','redirect','bin','Ambient','note','stockBefore','Floor','image','floorlevel','14176bSymkz','French','types','$date','user','second1','Arabic','Hindi','email','foreach\x20newproduct','success','flash','aggregate','Portuguese\x20(BR)','Chinese','message','finalize','prod_code','$product_details.product_stock','$product_details.product_code','$invoice','/view/add_adjustment','</div>','product_code','params','$product_details._id','exports','findById','then','/picking_list/PDF_adjustment_rm/','$product_details.level','$product.product_name','Logo.png','<h2>\x20','sendMail','Shelves','product_stock','\x20<>\x20','stock','all','$product_details.product_name','expiry_date','Rooms','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$name','logo','../models/all_models','$product_details.unit','/../public','New_Qty_Converted','storage','edit_adjustment','$room','../public/language/languages.json','bay','German','False','/adjustment/view','$product_details.floorlevel','post','secondary_code','string','$product_details.secondary_unit','../middleware/auth','$product_details.bay','language','ADJ-','toString','edit_adjustment_view','product_details','invoice','<tr>','nodemailer','adjustment\x20add\x20successfull','map','get','Primary_Units'];a0_0x426d=function(){return _0x1ebbe7;};return a0_0x426d();}function a0_0x5eb2(_0xb2bd4a,_0x53d84e){var _0x426da6=a0_0x426d();return a0_0x5eb2=function(_0x5eb26a,_0x241d7a){_0x5eb26a=_0x5eb26a-0xa3;var _0x2f646d=_0x426da6[_0x5eb26a];return _0x2f646d;},a0_0x5eb2(_0xb2bd4a,_0x53d84e);}router[a0_0x2d8a71(0x164)](a0_0x2d8a71(0x12e),auth,async(_0x140afc,_0x3ad0fe)=>{var _0x49e4ec=a0_0x2d8a71;try{const {username:_0x4e0099,email:_0x50966c,role:_0x1c7409}=_0x140afc[_0x49e4ec(0x11d)],_0x357bff=_0x140afc['user'],_0xe1a35f=await profile[_0x49e4ec(0x103)]({'email':_0x357bff[_0x49e4ec(0x121)]}),_0xa0d826=await master_shop[_0x49e4ec(0xd3)]();let _0x6a608c;if(_0x357bff[_0x49e4ec(0xc9)]==_0x49e4ec(0xb7)){const _0x225732=await staff[_0x49e4ec(0x103)]({'email':_0x357bff['email']});_0x6a608c=await warehouse[_0x49e4ec(0x125)]([{'$match':{'status':'Enabled','name':_0x225732[_0x49e4ec(0xc2)],'warehouse_category':_0x49e4ec(0x17c),'name':{'$ne':_0x49e4ec(0xb2)}}},{'$group':{'_id':_0x49e4ec(0x145),'name':{'$first':_0x49e4ec(0x145)}}}]);}else _0x6a608c=await warehouse[_0x49e4ec(0x125)]([{'$match':{'status':_0x49e4ec(0xab),'warehouse_category':_0x49e4ec(0x17c),'name':{'$ne':_0x49e4ec(0xb2)}}},{'$group':{'_id':'$name','name':{'$first':_0x49e4ec(0x145)}}}]);const _0x3149c2=await product[_0x49e4ec(0xd3)]({}),_0x5a8c2b=await adjustment['find']({}),_0x2a339a=_0x5a8c2b[_0x49e4ec(0xfb)]+0x1,_0x47a30d=_0x49e4ec(0x15b)+_0x2a339a[_0x49e4ec(0x15c)]()[_0x49e4ec(0xaf)](0x5,'0');var _0x1a0cb1=[_0x49e4ec(0x113),_0x49e4ec(0x109),_0x49e4ec(0x17a)];if(_0xa0d826[0x0][_0x49e4ec(0x15a)]==_0x49e4ec(0xed))var _0xd1ed79=users[_0x49e4ec(0x16b)];else{if(_0xa0d826[0x0]['language']=='Hindi')var _0xd1ed79=users[_0x49e4ec(0x120)];else{if(_0xa0d826[0x0][_0x49e4ec(0x15a)]==_0x49e4ec(0x150))var _0xd1ed79=users[_0x49e4ec(0x150)];else{if(_0xa0d826[0x0][_0x49e4ec(0x15a)]==_0x49e4ec(0x10f))var _0xd1ed79=users[_0x49e4ec(0x10f)];else{if(_0xa0d826[0x0]['language']==_0x49e4ec(0x11a))var _0xd1ed79=users[_0x49e4ec(0x11a)];else{if(_0xa0d826[0x0]['language']=='Portuguese\x20(BR)')var _0xd1ed79=users[_0x49e4ec(0xc4)];else{if(_0xa0d826[0x0][_0x49e4ec(0x15a)]=='Chinese')var _0xd1ed79=users['Chinese'];else{if(_0xa0d826[0x0][_0x49e4ec(0x15a)]==_0x49e4ec(0xf4))var _0xd1ed79=users[_0x49e4ec(0x11f)];}}}}}}}const _0x146690=getRandom8DigitNumber();_0x146690[_0x49e4ec(0x135)](_0x4e6a8e=>{var _0x309c8a=_0x49e4ec;_0x3ad0fe[_0x309c8a(0xbf)]('add_adjustment',{'success':_0x140afc[_0x309c8a(0x124)](_0x309c8a(0x123)),'errors':_0x140afc[_0x309c8a(0x124)](_0x309c8a(0xfc)),'role':_0x357bff,'profile':_0xe1a35f,'warehouse':_0x6a608c,'product':_0x3149c2,'master_shop':_0xa0d826,'language':_0xd1ed79,'rooms_data':_0x1a0cb1,'invoice_no':_0x4e6a8e});})['catch'](_0x244384=>{var _0x47d8ac=_0x49e4ec;_0x140afc[_0x47d8ac(0x124)](_0x47d8ac(0xfc),_0x47d8ac(0x144)),_0x3ad0fe[_0x47d8ac(0x111)](_0x47d8ac(0x152));});}catch(_0x4d2541){console[_0x49e4ec(0xdc)](_0x4d2541);}}),router['post'](a0_0x2d8a71(0x12e),auth,async(_0x2689bc,_0x2ca64c)=>{var _0x443873=a0_0x2d8a71;try{const {warehouse_name:_0x1123a0,date:_0x17616a,prod_name:_0x5368a3,level:_0x13471d,isle:_0x3c8791,pallet:_0x1c372c,stock:_0x9cc136,types:_0x4473fc,adjust_qty:_0x2a6471,new_adjust_qty:_0x25a6b9,note:_0x181c3c,Room_name:_0x4d91f7,invoice:_0x3a80db,JO_number:_0xf125b0,expiry_date:_0x399374}=_0x2689bc[_0x443873(0xf7)];if(typeof _0x5368a3==_0x443873(0x156))var _0x20e105=[_0x2689bc['body']['prod_name']],_0x4e1c3e=[_0x2689bc[_0x443873(0xf7)][_0x443873(0xaa)]],_0x3d9b6d=[_0x2689bc['body'][_0x443873(0x13f)]],_0x46fb03=[_0x2689bc[_0x443873(0xf7)][_0x443873(0x11b)]],_0x24d927=[_0x2689bc[_0x443873(0xf7)]['New_Qty_Converted_adj']],_0x5bc9ae=[_0x2689bc[_0x443873(0xf7)]['New_Qty_Converted']],_0x251cc1=[_0x2689bc[_0x443873(0xf7)][_0x443873(0x165)]],_0x5c8142=[_0x2689bc[_0x443873(0xf7)][_0x443873(0xe7)]],_0x3768e0=[_0x2689bc['body'][_0x443873(0x12a)]],_0x344885=[_0x2689bc[_0x443873(0xf7)][_0x443873(0xc6)]],_0xa0dea7=[_0x2689bc[_0x443873(0xf7)][_0x443873(0x142)]],_0x4d7a27=[_0x2689bc[_0x443873(0xf7)][_0x443873(0xa5)]],_0x4c4982=[_0x2689bc['body'][_0x443873(0x170)]],_0x31fe19=[_0x2689bc[_0x443873(0xf7)][_0x443873(0xe3)]],_0x4e05a6=[_0x2689bc[_0x443873(0xf7)][_0x443873(0x143)]],_0x14de22=[_0x2689bc[_0x443873(0xf7)][_0x443873(0x10e)]],_0x228e73=[_0x2689bc[_0x443873(0xf7)][_0x443873(0x11e)]],_0x4517cb=[_0x2689bc[_0x443873(0xf7)][_0x443873(0xff)]];else var _0x20e105=[..._0x2689bc['body'][_0x443873(0xae)]],_0x4e1c3e=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0xaa)]],_0x3d9b6d=[..._0x2689bc['body'][_0x443873(0x13f)]],_0x46fb03=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0x11b)]],_0x24d927=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0x16d)]],_0x5bc9ae=[..._0x2689bc['body'][_0x443873(0x14a)]],_0x251cc1=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0x104)]],_0x5c8142=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0xe7)]],_0x3768e0=[..._0x2689bc['body'][_0x443873(0x12a)]],_0x344885=[..._0x2689bc[_0x443873(0xf7)]['batch_code']],_0xa0dea7=[..._0x2689bc[_0x443873(0xf7)]['expiry_date']],_0x4d7a27=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0xa5)]],_0x4c4982=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0x170)]],_0x31fe19=[..._0x2689bc[_0x443873(0xf7)]['prod_cat']],_0x4e05a6=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0x143)]],_0x14de22=[..._0x2689bc[_0x443873(0xf7)][_0x443873(0x10e)]],_0x228e73=[..._0x2689bc['body'][_0x443873(0x11e)]],_0x4517cb=[..._0x2689bc[_0x443873(0xf7)]['prod_invoice']];const _0x2a3c12=_0x20e105[_0x443873(0x163)](_0x442472=>{return _0x442472={'product_name':_0x442472};});_0x4e1c3e['forEach']((_0x3b58cb,_0x54cff3)=>{var _0x352720=_0x443873;_0x4e05a6[_0x352720(0xe4)]((_0x208c47,_0x55213f)=>{var _0x305f6f=_0x352720;if(_0x208c47==_0x305f6f(0xd4)&&_0x54cff3==_0x55213f){var _0x3aca7c=_0x3b58cb[_0x305f6f(0xf8)](0x3);_0x2a3c12[_0x54cff3][_0x305f6f(0x14b)]=_0x3b58cb[0x0],_0x2a3c12[_0x54cff3]['rack']=_0x3b58cb[0x1],_0x2a3c12[_0x54cff3]['bay']=0x0,_0x2a3c12[_0x54cff3][_0x305f6f(0x112)]=0x0,_0x2a3c12[_0x54cff3][_0x305f6f(0x10c)]=_0x305f6f(0x116),_0x2a3c12[_0x54cff3][_0x305f6f(0x118)]=_0x3aca7c;}else{if(_0x208c47==_0x305f6f(0x13c)&&_0x54cff3==_0x55213f){var _0x3aca7c=_0x3b58cb['slice'](0x3);_0x2a3c12[_0x54cff3][_0x305f6f(0x14b)]=_0x3b58cb[0x0],_0x2a3c12[_0x54cff3][_0x305f6f(0xfa)]=_0x3b58cb[0x1],_0x2a3c12[_0x54cff3][_0x305f6f(0x14f)]=0x0,_0x2a3c12[_0x54cff3][_0x305f6f(0x112)]=0x0,_0x2a3c12[_0x54cff3][_0x305f6f(0x10c)]='Floor',_0x2a3c12[_0x54cff3][_0x305f6f(0x118)]=_0x3b58cb[0x5];}else{if(_0x54cff3==_0x55213f){var _0x593423;if(_0x3b58cb[0x4]=='L')_0x593423=_0x305f6f(0x177);else _0x3b58cb[0x4]=='F'&&(_0x593423=_0x305f6f(0x116));_0x2a3c12[_0x54cff3]['storage']=_0x3b58cb[0x0],_0x2a3c12[_0x54cff3][_0x305f6f(0xfa)]=_0x3b58cb[0x1],_0x2a3c12[_0x54cff3][_0x305f6f(0x14f)]=_0x3b58cb[0x2],_0x2a3c12[_0x54cff3][_0x305f6f(0x112)]=_0x3b58cb[0x3],_0x2a3c12[_0x54cff3][_0x305f6f(0x10c)]=_0x593423,_0x2a3c12[_0x54cff3][_0x305f6f(0x118)]=_0x3b58cb[0x5];}}}});}),_0x3d9b6d[_0x443873(0xe4)]((_0x361e2c,_0x5af725)=>{var _0x2dff0e=_0x443873;_0x2a3c12[_0x5af725][_0x2dff0e(0x115)]=_0x361e2c;}),_0x46fb03[_0x443873(0xe4)]((_0x4bf585,_0x3681da)=>{var _0x394e92=_0x443873;_0x2a3c12[_0x3681da][_0x394e92(0x11b)]=_0x4bf585;}),_0x24d927['forEach']((_0x2e9359,_0x1c68bf)=>{var _0x3f5634=_0x443873;_0x2a3c12[_0x1c68bf][_0x3f5634(0xf2)]=_0x2e9359;}),_0x5bc9ae[_0x443873(0xe4)]((_0x2458c8,_0x4c27ad)=>{var _0x5abde1=_0x443873;_0x2a3c12[_0x4c27ad][_0x5abde1(0xd8)]=_0x2458c8;}),_0x251cc1[_0x443873(0xe4)]((_0xa9d479,_0x1d5d27)=>{var _0x4e44d9=_0x443873;_0x2a3c12[_0x1d5d27][_0x4e44d9(0x104)]=_0xa9d479;}),_0x5c8142[_0x443873(0xe4)]((_0x15acba,_0x5df94a)=>{_0x2a3c12[_0x5df94a]['secondary_unit']=_0x15acba;}),_0x3768e0[_0x443873(0xe4)]((_0x2625d2,_0x37e044)=>{var _0x27249d=_0x443873;_0x2a3c12[_0x37e044][_0x27249d(0x130)]=_0x2625d2;}),_0x344885[_0x443873(0xe4)]((_0x379861,_0x2bb42a)=>{var _0x18611b=_0x443873;_0x2a3c12[_0x2bb42a][_0x18611b(0xc6)]=_0x379861;}),_0xa0dea7['forEach']((_0x4a9069,_0x4e4027)=>{var _0x56aee3=_0x443873;_0x2a3c12[_0x4e4027][_0x56aee3(0x142)]=_0x4a9069;}),_0x4d7a27[_0x443873(0xe4)]((_0x11b0ab,_0x1afffb)=>{_0x2a3c12[_0x1afffb]['maxperunit']=_0x11b0ab;}),_0x4c4982[_0x443873(0xe4)]((_0x3bd31d,_0x36c457)=>{var _0x11f275=_0x443873;_0x2a3c12[_0x36c457][_0x11f275(0x170)]=_0x3bd31d;}),_0x31fe19[_0x443873(0xe4)]((_0x2cf333,_0x1316bb)=>{var _0x4e2e09=_0x443873;_0x2a3c12[_0x1316bb][_0x4e2e09(0xe3)]=_0x2cf333;}),_0x4e05a6[_0x443873(0xe4)]((_0xe0d02d,_0x24464c)=>{var _0x36d404=_0x443873;_0x2a3c12[_0x24464c][_0x36d404(0xa6)]=_0xe0d02d;}),_0x14de22[_0x443873(0xe4)]((_0x17e7ba,_0x1ca3d3)=>{var _0x4834a8=_0x443873;_0x2a3c12[_0x1ca3d3][_0x4834a8(0xf6)]=_0x17e7ba;}),_0x228e73['forEach']((_0x1b7ef0,_0x3bf61d)=>{_0x2a3c12[_0x3bf61d]['secondary_code']=_0x1b7ef0;}),_0x4517cb['forEach']((_0x12c195,_0x4a69ab)=>{var _0x3a017d=_0x443873;_0x2a3c12[_0x4a69ab][_0x3a017d(0x15f)]=_0x12c195;});const _0x1e3b83=_0x2a3c12[_0x443873(0xe0)](_0x1230a6=>_0x1230a6[_0x443873(0xf2)]!=='0'&&_0x1230a6[_0x443873(0xf2)]!=='');var _0x418d3a=0x0;_0x1e3b83[_0x443873(0xe4)](_0x509780=>{var _0x244e29=_0x443873;console[_0x244e29(0xdc)](_0x244e29(0x122),_0x509780),parseInt(_0x509780[_0x244e29(0xf2)])<=0x0&&_0x418d3a++;});if(_0x418d3a!=0x0)return _0x2689bc[_0x443873(0x124)](_0x443873(0xfc),_0x443873(0x17d)),_0x2ca64c[_0x443873(0x111)](_0x443873(0xc8));const _0x3c632c=new adjustment({'warehouse_name':_0x1123a0,'date':_0x17616a,'product':_0x1e3b83,'note':_0x181c3c,'room':_0x4d91f7,'invoice':_0x3a80db,'JO_number':_0xf125b0,'expiry_date':_0x399374}),_0x4d77f3=await _0x3c632c[_0x443873(0xef)]();_0x2689bc[_0x443873(0x124)](_0x443873(0x123),_0x443873(0x162)),_0x2ca64c[_0x443873(0x111)](_0x443873(0xf3)+_0x4d77f3['_id']);}catch(_0x1a6390){console[_0x443873(0xdc)](_0x1a6390),_0x2ca64c[_0x443873(0xa4)](0xc8)[_0x443873(0xa9)]({'message':_0x1a6390['message']});}}),router[a0_0x2d8a71(0x164)](a0_0x2d8a71(0x166),auth,async(_0x49e8b3,_0x977bab)=>{var _0x3d0a88=a0_0x2d8a71;try{const {username:_0x4183bf,email:_0x58ab2d,role:_0x9ca1c1}=_0x49e8b3[_0x3d0a88(0x11d)],_0x349beb=_0x49e8b3['user'],_0x2002db=await profile[_0x3d0a88(0x103)]({'email':_0x349beb[_0x3d0a88(0x121)]}),_0x49767b=await master_shop[_0x3d0a88(0xd3)](),_0x206447=_0x49e8b3[_0x3d0a88(0x131)]['id'],_0x4e1a81=await adjustment[_0x3d0a88(0x134)]({'_id':_0x206447}),_0x4b2a13=await purchases['aggregate']([{'$match':{'warehouse_name':_0x4e1a81[_0x3d0a88(0xe2)]}},{'$unwind':_0x3d0a88(0xdd)},{'$group':{'_id':_0x3d0a88(0x138)}}]),_0x544e00=await product[_0x3d0a88(0xd3)]({}),_0x1479e9=await warehouse[_0x3d0a88(0x125)]([{'$match':{'name':_0x4e1a81[_0x3d0a88(0xe2)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3d0a88(0x132),'name':{'$first':_0x3d0a88(0x141)},'product_stock':{'$first':_0x3d0a88(0x12b)},'bay':{'$first':_0x3d0a88(0x159)},'bin':{'$first':_0x3d0a88(0x108)},'type':{'$first':_0x3d0a88(0xc0)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3d0a88(0x12c)},'storage':{'$first':_0x3d0a88(0x16f)},'rack':{'$first':_0x3d0a88(0xf0)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3d0a88(0xb3)},'batch_code':{'$first':_0x3d0a88(0xbd)},'room':{'$first':_0x3d0a88(0x14d)}}}]);if(_0x49767b[0x0][_0x3d0a88(0x15a)]==_0x3d0a88(0xed)){var _0xba30ef=users['English'];console['log'](_0xba30ef);}else{if(_0x49767b[0x0][_0x3d0a88(0x15a)]==_0x3d0a88(0x120))var _0xba30ef=users[_0x3d0a88(0x120)];else{if(_0x49767b[0x0][_0x3d0a88(0x15a)]==_0x3d0a88(0x150))var _0xba30ef=users[_0x3d0a88(0x150)];else{if(_0x49767b[0x0][_0x3d0a88(0x15a)]=='Spanish')var _0xba30ef=users[_0x3d0a88(0x10f)];else{if(_0x49767b[0x0][_0x3d0a88(0x15a)]=='French')var _0xba30ef=users['French'];else{if(_0x49767b[0x0][_0x3d0a88(0x15a)]==_0x3d0a88(0x126))var _0xba30ef=users[_0x3d0a88(0xc4)];else{if(_0x49767b[0x0]['language']==_0x3d0a88(0x127))var _0xba30ef=users[_0x3d0a88(0x127)];else{if(_0x49767b[0x0]['language']=='Arabic\x20(ae)')var _0xba30ef=users['Arabic'];}}}}}}}_0x977bab['render'](_0x3d0a88(0x15d),{'success':_0x49e8b3[_0x3d0a88(0x124)](_0x3d0a88(0x123)),'errors':_0x49e8b3[_0x3d0a88(0x124)](_0x3d0a88(0xfc)),'role':_0x349beb,'profile':_0x2002db,'adjustment':_0x4e1a81,'stock':_0x1479e9,'master_shop':_0x49767b,'warehouse_name':_0x4b2a13,'unit':_0x544e00,'language':_0xba30ef});}catch(_0x127323){console['log'](_0x127323),_0x977bab[_0x3d0a88(0xa4)](0xc8)['json']({'message':_0x127323[_0x3d0a88(0x128)]});}}),router[a0_0x2d8a71(0x154)]('/preview/:id',auth,async(_0x290b1e,_0x2997c4)=>{var _0xc113c=a0_0x2d8a71;try{const _0x56f2a7=_0x290b1e[_0xc113c(0x131)]['id'],{warehouse_name:_0x59e396,Room_name:_0x5af6b0}=_0x290b1e[_0xc113c(0xf7)],_0x48887c=await adjustment[_0xc113c(0x134)]({'_id':_0x56f2a7}),_0x49a9df=_0x48887c[_0xc113c(0xad)][_0xc113c(0x163)](async _0x4187f4=>{var _0x4d8d77=_0xc113c;if(_0x4187f4['adjust_qty']>0x0){var _0x411141=await warehouse['findOne']({'name':_0x59e396,'room':_0x4187f4[_0x4d8d77(0xa6)],'warehouse_category':_0x4d8d77(0x17c)});const _0x4037a8=_0x411141[_0x4d8d77(0x15e)][_0x4d8d77(0x163)](_0x5ea4af=>{var _0x26f4ec=_0x4d8d77;if(_0x4187f4[_0x26f4ec(0x10c)]=='minus'){if(_0x5ea4af[_0x26f4ec(0xba)]==_0x4187f4[_0x26f4ec(0xba)]&&_0x5ea4af[_0x26f4ec(0x118)]==_0x4187f4[_0x26f4ec(0x118)]&&_0x5ea4af[_0x26f4ec(0x10c)]==_0x4187f4['type']&&_0x5ea4af[_0x26f4ec(0x112)]==_0x4187f4[_0x26f4ec(0x112)]&&_0x5ea4af[_0x26f4ec(0x14f)]==_0x4187f4[_0x26f4ec(0x14f)]&&_0x5ea4af[_0x26f4ec(0xfa)]==_0x4187f4[_0x26f4ec(0xfa)]&&_0x5ea4af['storage']==_0x4187f4[_0x26f4ec(0x14b)]&&_0x5ea4af[_0x26f4ec(0x142)]==_0x4187f4[_0x26f4ec(0x142)]&&_0x5ea4af[_0x26f4ec(0xc6)]==_0x4187f4[_0x26f4ec(0xc6)]&&_0x5ea4af['production_date']==_0x4187f4[_0x26f4ec(0x170)]&&_0x5ea4af[_0x26f4ec(0x15f)]==_0x4187f4['invoice']){var _0x3d5206;_0x3d5206=_0x4187f4[_0x26f4ec(0xf2)],_0x4187f4[_0x26f4ec(0xe3)]=='S'&&(_0x3d5206=_0x4187f4[_0x26f4ec(0xf2)]),_0x5ea4af['product_stock']=_0x5ea4af[_0x26f4ec(0x13d)]-_0x3d5206;}}else{if(_0x5ea4af[_0x26f4ec(0xba)]==_0x4187f4[_0x26f4ec(0xba)]&&_0x5ea4af[_0x26f4ec(0x118)]==_0x4187f4[_0x26f4ec(0x118)]&&_0x5ea4af[_0x26f4ec(0x10c)]==_0x4187f4[_0x26f4ec(0x10c)]&&_0x5ea4af[_0x26f4ec(0x112)]==_0x4187f4[_0x26f4ec(0x112)]&&_0x5ea4af[_0x26f4ec(0x14f)]==_0x4187f4[_0x26f4ec(0x14f)]&&_0x5ea4af[_0x26f4ec(0xfa)]==_0x4187f4[_0x26f4ec(0xfa)]&&_0x5ea4af[_0x26f4ec(0x14b)]==_0x4187f4[_0x26f4ec(0x14b)]&&_0x5ea4af['expiry_date']==_0x4187f4[_0x26f4ec(0x142)]&&_0x5ea4af['batch_code']==_0x4187f4['batch_code']&&_0x5ea4af[_0x26f4ec(0x170)]==_0x4187f4['production_date']&&_0x5ea4af[_0x26f4ec(0x15f)]==_0x4187f4[_0x26f4ec(0x15f)]){console[_0x26f4ec(0xdc)](_0x4187f4);var _0x3d5206;_0x3d5206=_0x4187f4[_0x26f4ec(0xf2)],_0x4187f4['prod_cat']=='S'&&(_0x3d5206=_0x4187f4[_0x26f4ec(0xf2)]),console[_0x26f4ec(0xdc)](_0x3d5206+_0x26f4ec(0x13e)+_0x4187f4[_0x26f4ec(0xf2)]+_0x26f4ec(0x13e)+_0x5ea4af[_0x26f4ec(0x16e)]+_0x26f4ec(0x13e)+_0x4187f4[_0x26f4ec(0xe3)]),_0x5ea4af[_0x26f4ec(0x13d)]=_0x5ea4af[_0x26f4ec(0x13d)]+_0x3d5206;}}});}return _0x411141;});Promise[_0xc113c(0x140)](_0x49a9df)[_0xc113c(0x135)](async _0x5d1cb5=>{var _0x3aedaa=_0xc113c;try{for(const _0x1e7944 of _0x5d1cb5){await _0x1e7944[_0x3aedaa(0xef)]();}_0x48887c[_0x3aedaa(0x129)]=_0x3aedaa(0xe1);const _0x30cc76=await _0x48887c[_0x3aedaa(0xef)](),_0x1c5340=await master_shop[_0x3aedaa(0xd3)](),_0x1a48e3=await email_settings[_0x3aedaa(0x103)](),_0x12e1fb=await supervisor_settings['find']();var _0x485164=_0x48887c[_0x3aedaa(0xad)],_0x54291f='',_0xadcc08;for(_0xadcc08 in _0x485164){_0x54291f+=_0x3aedaa(0x160)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x485164[_0xadcc08][_0x3aedaa(0xba)]+_0x3aedaa(0xe5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x485164[_0xadcc08]['product_code']+_0x3aedaa(0xe5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x485164[_0xadcc08][_0x3aedaa(0xf2)]+_0x3aedaa(0xe5)+_0x3aedaa(0x172)+_0x485164[_0xadcc08][_0x3aedaa(0x104)]+'</td>'+_0x3aedaa(0x172)+_0x485164[_0xadcc08][_0x3aedaa(0xb1)]+_0x3aedaa(0xe5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x48887c[_0x3aedaa(0xe2)]+_0x3aedaa(0xe5)+_0x3aedaa(0x172)+_0x485164[_0xadcc08]['room_names']+_0x3aedaa(0xe5)+_0x3aedaa(0x172)+_0x485164[_0xadcc08]['storage']+_0x485164[_0xadcc08]['rack']+_0x485164[_0xadcc08][_0x3aedaa(0x14f)]+_0x485164[_0xadcc08][_0x3aedaa(0x112)]+_0x485164[_0xadcc08]['type'][0x0]+_0x485164[_0xadcc08][_0x3aedaa(0x118)]+_0x3aedaa(0xe5),_0x3aedaa(0xb8);}let _0x20cb30=nodemailer[_0x3aedaa(0x179)]({'host':_0x1a48e3[_0x3aedaa(0x10d)],'port':Number(_0x1a48e3[_0x3aedaa(0x16c)]),'secure':![],'auth':{'user':_0x1a48e3[_0x3aedaa(0x121)],'pass':_0x1a48e3['password']}}),_0x4d0d23={'from':_0x1a48e3['email'],'to':_0x12e1fb[0x0]['RMSEmail'],'subject':_0x3aedaa(0xda),'attachments':[{'filename':_0x3aedaa(0x139),'path':__dirname+_0x3aedaa(0x149)+'/upload/'+_0x1c5340[0x0][_0x3aedaa(0x117)],'cid':_0x3aedaa(0x146)}],'html':'<!DOCTYPE\x20html>'+_0x3aedaa(0xdb)+_0x3aedaa(0x102)+_0x3aedaa(0x175)+_0x3aedaa(0xbc)+_0x3aedaa(0x175)+_0x3aedaa(0xbe)+_0x3aedaa(0x12f)+_0x3aedaa(0x175)+_0x3aedaa(0x13a)+_0x1c5340[0x0][_0x3aedaa(0xd0)]+_0x3aedaa(0xfd)+_0x3aedaa(0x12f)+_0x3aedaa(0x12f)+_0x3aedaa(0xc7)+'<div>'+_0x3aedaa(0xf1)+_0x3aedaa(0x17b)+_0x48887c[_0x3aedaa(0x15f)]+'\x20'+_0x3aedaa(0x173)+'\x20Order\x20Date\x20:\x20'+_0x48887c['date']+'\x20'+_0x3aedaa(0xb0)+_0x3aedaa(0xd9)+_0x3aedaa(0x12f)+_0x3aedaa(0xeb)+_0x3aedaa(0x174)+_0x3aedaa(0x160)+_0x3aedaa(0x176)+_0x3aedaa(0xd6)+_0x3aedaa(0xfe)+_0x3aedaa(0xcf)+_0x3aedaa(0xc5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3aedaa(0xd5)+_0x3aedaa(0xb8)+_0x3aedaa(0x169)+_0x3aedaa(0xde)+'\x20'+_0x54291f+'\x20'+_0x3aedaa(0xa8)+_0x3aedaa(0xcb)+_0x3aedaa(0x175)+_0x3aedaa(0x178)+'<h5>'+_0x1c5340[0x0][_0x3aedaa(0xd0)]+_0x3aedaa(0xd9)+_0x3aedaa(0x12f)+_0x3aedaa(0x12f)+'</body></html>'};_0x20cb30[_0x3aedaa(0x13b)](_0x4d0d23,function(_0x4340cd,_0x264306){var _0x33ff94=_0x3aedaa;_0x4340cd?(console[_0x33ff94(0xdc)](_0x4340cd),console['log']('Error\x20Occurs')):console[_0x33ff94(0xdc)]('Email\x20sent\x20successfully');}),_0x290b1e[_0x3aedaa(0x124)](_0x3aedaa(0x123),_0x3aedaa(0xb4)),_0x2997c4[_0x3aedaa(0x111)](_0x3aedaa(0x136)+_0x30cc76[_0x3aedaa(0xa3)]);}catch(_0x29415a){console[_0x3aedaa(0xcd)](_0x29415a),_0x2997c4['status'](0x1f4)[_0x3aedaa(0xa9)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0xc113c(0xf9)](_0x413926=>{var _0x2485d2=_0xc113c;console[_0x2485d2(0xcd)](_0x413926),_0x2997c4[_0x2485d2(0xa4)](0x1f4)[_0x2485d2(0xa9)]({'error':'An\x20error\x20occurred.'});});}catch(_0x305e5f){console[_0xc113c(0xdc)](_0x305e5f),_0x2997c4[_0xc113c(0xa4)](0xc8)['json']({'message':_0x305e5f[_0xc113c(0x128)]});}}),router[a0_0x2d8a71(0x164)](a0_0x2d8a71(0xd2),auth,async(_0x32d059,_0xfbcbdb)=>{var _0x536b36=a0_0x2d8a71;try{const {username:_0x2f2ff6,email:_0x22d0c9,role:_0x1069eb}=_0x32d059[_0x536b36(0x11d)],_0x3c221e=_0x32d059['user'],_0x1b8bc8=await profile[_0x536b36(0x103)]({'email':_0x3c221e['email']}),_0x1ea923=await master_shop[_0x536b36(0xd3)](),_0x39cd08=_0x32d059[_0x536b36(0x131)]['id'],_0x2e15e8=await adjustment[_0x536b36(0x134)]({'_id':_0x39cd08}),_0x3464cd=await purchases[_0x536b36(0x125)]([{'$match':{'warehouse_name':_0x2e15e8[_0x536b36(0xe2)]}},{'$unwind':_0x536b36(0xdd)},{'$group':{'_id':'$product.product_name'}}]),_0x1fbaf8=await product[_0x536b36(0xd3)]({}),_0xcc89a0=await warehouse[_0x536b36(0x125)]([{'$match':{'name':_0x2e15e8[_0x536b36(0xe2)]}},{'$unwind':_0x536b36(0xe8)},{'$group':{'_id':_0x536b36(0x132),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x536b36(0x12b)},'bay':{'$first':_0x536b36(0x159)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x536b36(0x153)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x536b36(0xb5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x536b36(0x16f)},'rack':{'$first':_0x536b36(0xf0)},'maxPerUnit':{'$first':_0x536b36(0xb9)},'expiry_date':{'$first':_0x536b36(0x106)},'production_date':{'$first':_0x536b36(0xb3)},'batch_code':{'$first':_0x536b36(0xbd)},'room':{'$first':'$room'}}}]);let _0x47db16;if(_0x3c221e['role']==_0x536b36(0xb7)){const _0x56c81c=await staff[_0x536b36(0x103)]({'email':_0x3c221e[_0x536b36(0x121)]});_0x47db16=await warehouse[_0x536b36(0x125)]([{'$match':{'status':_0x536b36(0xab),'name':_0x56c81c[_0x536b36(0xc2)],'warehouse_category':_0x536b36(0x17c),'name':{'$ne':_0x536b36(0xb2)}}},{'$group':{'_id':_0x536b36(0x145),'name':{'$first':_0x536b36(0x145)}}}]);}else _0x47db16=await warehouse[_0x536b36(0x125)]([{'$match':{'status':_0x536b36(0xab),'warehouse_category':_0x536b36(0x17c),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x536b36(0x145),'name':{'$first':_0x536b36(0x145)}}}]);if(_0x1ea923[0x0][_0x536b36(0x15a)]==_0x536b36(0xed)){var _0x3c16a1=users[_0x536b36(0x16b)];console[_0x536b36(0xdc)](_0x3c16a1);}else{if(_0x1ea923[0x0][_0x536b36(0x15a)]=='Hindi')var _0x3c16a1=users[_0x536b36(0x120)];else{if(_0x1ea923[0x0][_0x536b36(0x15a)]=='German')var _0x3c16a1=users[_0x536b36(0x150)];else{if(_0x1ea923[0x0][_0x536b36(0x15a)]=='Spanish')var _0x3c16a1=users[_0x536b36(0x10f)];else{if(_0x1ea923[0x0][_0x536b36(0x15a)]==_0x536b36(0x11a))var _0x3c16a1=users[_0x536b36(0x11a)];else{if(_0x1ea923[0x0][_0x536b36(0x15a)]=='Portuguese\x20(BR)')var _0x3c16a1=users[_0x536b36(0xc4)];else{if(_0x1ea923[0x0][_0x536b36(0x15a)]==_0x536b36(0x127))var _0x3c16a1=users['Chinese'];else{if(_0x1ea923[0x0]['language']==_0x536b36(0xf4))var _0x3c16a1=users[_0x536b36(0x11f)];}}}}}}}_0xfbcbdb[_0x536b36(0xbf)](_0x536b36(0x14c),{'success':_0x32d059[_0x536b36(0x124)](_0x536b36(0x123)),'errors':_0x32d059[_0x536b36(0x124)](_0x536b36(0xfc)),'role':_0x3c221e,'profile':_0x1b8bc8,'adjustment':_0x2e15e8,'stock':_0xcc89a0,'master_shop':_0x1ea923,'warehouse_name':_0x3464cd,'unit':_0x1fbaf8,'language':_0x3c16a1,'warehouse':_0x47db16});}catch(_0x22cb71){console[_0x536b36(0xdc)](_0x22cb71),_0xfbcbdb['status'](0xc8)[_0x536b36(0xa9)]({'message':_0x22cb71[_0x536b36(0x128)]});}}),router[a0_0x2d8a71(0x154)](a0_0x2d8a71(0xd2),auth,async(_0x51bb23,_0x594acd)=>{var _0x5496f5=a0_0x2d8a71;try{const _0x5eb60b=_0x51bb23[_0x5496f5(0x131)]['id'],_0x34bf0f=await adjustment['findById']({'_id':_0x5eb60b}),_0x88cebb=await warehouse[_0x5496f5(0x103)]({'name':_0x34bf0f['warehouse_name'],'room':_0x34bf0f['room']}),{warehouse_name:_0x3b5a45,date:_0x287c76,prod_name:_0x51f12e,level:_0x50811d,isle:_0x2824ea,pallet:_0x460755,stock:_0x48ef48,types:_0x3cc393,adjust_qty:_0x5ef1f1,new_adjust_qty:_0x3361f0,note:_0x4f4796,Room_name:_0x125905,invoice:_0x11c4df,JO_number:_0x1a2e99,expiry_date:_0x20ea03}=_0x51bb23[_0x5496f5(0xf7)];if(typeof _0x51f12e=='string')var _0x258e1e=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0xae)]],_0x20e782=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0xaa)]],_0x58e4c4=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x13f)]],_0x4ccbbf=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x11b)]],_0x2d199e=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x16d)]],_0x25096d=[_0x51bb23[_0x5496f5(0xf7)]['New_Qty_Converted']],_0x5ee6a7=[_0x51bb23['body'][_0x5496f5(0x165)]],_0x40a6a0=[_0x51bb23[_0x5496f5(0xf7)]['Secondary_units']],_0x3d085f=[_0x51bb23['body'][_0x5496f5(0x12a)]],_0x258ada=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0xc6)]],_0x24999e=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x142)]],_0xf430f8=[_0x51bb23[_0x5496f5(0xf7)]['max_per_unit']],_0x3637aa=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x170)]],_0x3be4ab=[_0x51bb23['body'][_0x5496f5(0xe3)]],_0x4d48da=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x143)]],_0x7dfd00=[_0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x10e)]],_0x1a780a=[_0x51bb23['body'][_0x5496f5(0x11e)]];else var _0x258e1e=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0xae)]],_0x20e782=[..._0x51bb23['body'][_0x5496f5(0xaa)]],_0x58e4c4=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x13f)]],_0x4ccbbf=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x11b)]],_0x2d199e=[..._0x51bb23[_0x5496f5(0xf7)]['New_Qty_Converted_adj']],_0x25096d=[..._0x51bb23['body'][_0x5496f5(0x14a)]],_0x5ee6a7=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x104)]],_0x40a6a0=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0xe7)]],_0x3d085f=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x12a)]],_0x258ada=[..._0x51bb23['body'][_0x5496f5(0xc6)]],_0x24999e=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x142)]],_0xf430f8=[..._0x51bb23['body']['max_per_unit']],_0x3637aa=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x170)]],_0x3be4ab=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0xe3)]],_0x4d48da=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x143)]],_0x7dfd00=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x10e)]],_0x1a780a=[..._0x51bb23[_0x5496f5(0xf7)][_0x5496f5(0x11e)]];const _0x4d1dfc=_0x258e1e[_0x5496f5(0x163)](_0x14cd65=>{return _0x14cd65={'product_name':_0x14cd65};});_0x20e782[_0x5496f5(0xe4)]((_0x29ac69,_0x3f79cc)=>{var _0x2e3e1e=_0x5496f5;_0x4d48da[_0x2e3e1e(0xe4)]((_0x467fd5,_0x1ca9b6)=>{var _0x47bf8a=_0x2e3e1e;if(_0x467fd5=='Receiving\x20Area'&&_0x3f79cc==_0x1ca9b6){var _0x5e6e55=_0x29ac69[_0x47bf8a(0xf8)](0x3);_0x4d1dfc[_0x3f79cc]['storage']=_0x29ac69[0x0],_0x4d1dfc[_0x3f79cc]['rack']=_0x29ac69[0x1],_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x14f)]=0x0,_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x112)]=0x0,_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x10c)]=_0x47bf8a(0x116),_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x118)]=_0x5e6e55;}else{if(_0x467fd5==_0x47bf8a(0x13c)&&_0x3f79cc==_0x1ca9b6){var _0x5e6e55=_0x29ac69[_0x47bf8a(0xf8)](0x3);_0x4d1dfc[_0x3f79cc]['storage']=_0x29ac69[0x0],_0x4d1dfc[_0x3f79cc][_0x47bf8a(0xfa)]=_0x29ac69[0x1],_0x4d1dfc[_0x3f79cc]['bay']=0x0,_0x4d1dfc[_0x3f79cc]['bin']=0x0,_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x10c)]=_0x47bf8a(0x116),_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x118)]=_0x29ac69[0x5];}else{if(_0x3f79cc==_0x1ca9b6){var _0x530810;if(_0x29ac69[0x4]=='L')_0x530810='Level';else _0x29ac69[0x4]=='F'&&(_0x530810=_0x47bf8a(0x116));_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x14b)]=_0x29ac69[0x0],_0x4d1dfc[_0x3f79cc]['rack']=_0x29ac69[0x1],_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x14f)]=_0x29ac69[0x2],_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x112)]=_0x29ac69[0x3],_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x10c)]=_0x530810,_0x4d1dfc[_0x3f79cc][_0x47bf8a(0x118)]=_0x29ac69[0x5];}}}});}),_0x58e4c4[_0x5496f5(0xe4)]((_0x5940cd,_0x552c06)=>{var _0x3fe552=_0x5496f5;_0x4d1dfc[_0x552c06][_0x3fe552(0x115)]=_0x5940cd;}),_0x4ccbbf[_0x5496f5(0xe4)]((_0x254d92,_0x36c278)=>{_0x4d1dfc[_0x36c278]['types']=_0x254d92;}),_0x2d199e['forEach']((_0xaf9134,_0x4b4842)=>{var _0x14416e=_0x5496f5;_0x4d1dfc[_0x4b4842][_0x14416e(0xf2)]=_0xaf9134;}),_0x25096d[_0x5496f5(0xe4)]((_0xc33a83,_0xeb3674)=>{var _0x2ed576=_0x5496f5;_0x4d1dfc[_0xeb3674][_0x2ed576(0xd8)]=_0xc33a83;}),_0x5ee6a7[_0x5496f5(0xe4)]((_0x2bd610,_0x5ebf9c)=>{var _0x1b93d9=_0x5496f5;_0x4d1dfc[_0x5ebf9c][_0x1b93d9(0x104)]=_0x2bd610;}),_0x40a6a0[_0x5496f5(0xe4)]((_0x45849f,_0x1f864a)=>{var _0x41dcd2=_0x5496f5;_0x4d1dfc[_0x1f864a][_0x41dcd2(0xb1)]=_0x45849f;}),_0x3d085f[_0x5496f5(0xe4)]((_0x568c5e,_0x5606f6)=>{var _0x2e66ea=_0x5496f5;_0x4d1dfc[_0x5606f6][_0x2e66ea(0x130)]=_0x568c5e;}),_0x258ada[_0x5496f5(0xe4)]((_0xdb4194,_0x31822a)=>{_0x4d1dfc[_0x31822a]['batch_code']=_0xdb4194;}),_0x24999e[_0x5496f5(0xe4)]((_0x3b888c,_0x1b47d6)=>{var _0x2fb85e=_0x5496f5;_0x4d1dfc[_0x1b47d6][_0x2fb85e(0x142)]=_0x3b888c;}),_0xf430f8[_0x5496f5(0xe4)]((_0x4f4c44,_0x18edfc)=>{_0x4d1dfc[_0x18edfc]['maxperunit']=_0x4f4c44;}),_0x3637aa[_0x5496f5(0xe4)]((_0x240162,_0x565748)=>{_0x4d1dfc[_0x565748]['production_date']=_0x240162;}),_0x3be4ab['forEach']((_0x5b9c7e,_0x4d5084)=>{_0x4d1dfc[_0x4d5084]['prod_cat']=_0x5b9c7e;}),_0x4d48da['forEach']((_0x5ec617,_0x137c2e)=>{var _0x50f34f=_0x5496f5;_0x4d1dfc[_0x137c2e][_0x50f34f(0xa6)]=_0x5ec617;}),_0x7dfd00['forEach']((_0x50b699,_0x19d470)=>{var _0xe0bee8=_0x5496f5;_0x4d1dfc[_0x19d470][_0xe0bee8(0xf6)]=_0x50b699;}),_0x1a780a[_0x5496f5(0xe4)]((_0x172870,_0x32ce7a)=>{var _0x3bafdb=_0x5496f5;_0x4d1dfc[_0x32ce7a][_0x3bafdb(0x155)]=_0x172870;});const _0x1de964=_0x4d1dfc[_0x5496f5(0xe0)](_0x44957e=>_0x44957e[_0x5496f5(0xf2)]!=='0'&&_0x44957e['adjust_qty']!=='');var _0x12f04c=0x0;_0x1de964['forEach'](_0x43a25f=>{var _0x221277=_0x5496f5;console[_0x221277(0xdc)](_0x221277(0x122),_0x43a25f),parseInt(_0x43a25f['adjust_qty'])<=0x0&&_0x12f04c++;});if(_0x12f04c!=0x0)return _0x51bb23[_0x5496f5(0x124)](_0x5496f5(0xfc),_0x5496f5(0x17d)),_0x594acd[_0x5496f5(0x111)](_0x5496f5(0xc8));_0x34bf0f[_0x5496f5(0xe2)]=_0x3b5a45,_0x34bf0f[_0x5496f5(0x10a)]=_0x287c76,_0x34bf0f[_0x5496f5(0xad)]=_0x1de964,_0x34bf0f[_0x5496f5(0x114)]=_0x4f4796,_0x34bf0f[_0x5496f5(0x15f)]=_0x11c4df,_0x34bf0f[_0x5496f5(0xea)]=_0x5496f5(0x151);const _0x423e8e=await _0x34bf0f[_0x5496f5(0xef)]();_0x51bb23[_0x5496f5(0x124)](_0x5496f5(0x123),_0x5496f5(0x110)),_0x594acd[_0x5496f5(0x111)](_0x5496f5(0x152));}catch(_0x321a4f){console[_0x5496f5(0xdc)](_0x321a4f);}}),router[a0_0x2d8a71(0x154)](a0_0x2d8a71(0xc1),async(_0x5e95b4,_0x5a273f)=>{var _0x30f782=a0_0x2d8a71;const {primary_code:_0x540cd2,warehouse_data:_0x1eba4c,rooms_data:_0x6b1d68,Roomslist:_0x2a410f}=_0x5e95b4[_0x30f782(0xf7)],_0x7ff322=_0x2a410f['split'](','),_0xea5b01=[];async function _0x390dd7(_0x1babe8){var _0x4f196c=_0x30f782;const _0x2b4fa7=await warehouse[_0x4f196c(0x125)]([{'$match':{'name':_0x1eba4c,'room':_0x1babe8}},{'$unwind':_0x4f196c(0xe8)},{'$match':{'product_details.primary_code':_0x540cd2}},{'$group':{'_id':_0x4f196c(0x132),'name':{'$first':_0x4f196c(0x141)},'product_stock':{'$first':_0x4f196c(0x12b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4f196c(0xb5)},'product_code':{'$first':_0x4f196c(0x12c)},'level':{'$first':_0x4f196c(0x159)},'isle':{'$first':_0x4f196c(0x108)},'type':{'$first':_0x4f196c(0xc0)},'pallet':{'$first':_0x4f196c(0x153)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4f196c(0x157)},'storage':{'$first':_0x4f196c(0x16f)},'rack':{'$first':_0x4f196c(0xf0)},'expiry_date':{'$first':_0x4f196c(0x106)},'production_date':{'$first':_0x4f196c(0xb3)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4f196c(0xbd)},'product_cat':{'$first':_0x4f196c(0xec)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x362121=await warehouse[_0x4f196c(0x125)]([{'$match':{'name':_0x1eba4c,'room':_0x1babe8}},{'$unwind':_0x4f196c(0xe8)},{'$match':{'product_details.secondary_code':_0x540cd2}},{'$group':{'_id':_0x4f196c(0x132),'name':{'$first':_0x4f196c(0x141)},'product_stock':{'$first':_0x4f196c(0x12b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4f196c(0xb5)},'product_code':{'$first':_0x4f196c(0x12c)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4f196c(0x108)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x4f196c(0x148)},'secondary_unit':{'$first':_0x4f196c(0x157)},'storage':{'$first':_0x4f196c(0x16f)},'rack':{'$first':_0x4f196c(0xf0)},'expiry_date':{'$first':_0x4f196c(0x106)},'production_date':{'$first':_0x4f196c(0xb3)},'maxPerUnit':{'$first':_0x4f196c(0xb9)},'batch_code':{'$first':_0x4f196c(0xbd)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x4f196c(0x14d)}}}]);if(_0x2b4fa7[_0x4f196c(0xfb)]>0x0)_0xea5b01['push'](_0x2b4fa7);else _0x362121[_0x4f196c(0xfb)]>0x0&&_0xea5b01['push'](_0x362121);}const _0x3a39c9=_0x7ff322[_0x30f782(0x163)](_0x13c496=>_0x390dd7(_0x13c496));await Promise[_0x30f782(0x140)](_0x3a39c9),_0x5a273f['json'](_0xea5b01);}),router['post'](a0_0x2d8a71(0x171),async(_0x54c4f3,_0x4da682)=>{var _0x256af1=a0_0x2d8a71;const {primaryCode:_0x66db18,secondaryCode:_0x4372c4,productCode:_0x1df8f2,level:_0x4c8ba9,isle:_0x3619bd,pallet:_0x37cdf9,warehouses:_0x9e7c8d,room:_0x5281ac}=_0x54c4f3[_0x256af1(0xf7)];try{const _0x210b99=await warehouse[_0x256af1(0x125)]([{'$match':{'name':_0x9e7c8d,'room':_0x5281ac}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x4c8ba9),'product_details.isle':_0x3619bd,'product_details.pallet':parseInt(_0x37cdf9)}},{'$group':{'_id':_0x256af1(0x132),'name':{'$first':_0x256af1(0x141)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x256af1(0x137)},'isle':{'$first':_0x256af1(0xee)},'pallet':{'$first':_0x256af1(0x167)},'maxProducts':{'$first':_0x256af1(0xf5)}}}]);_0x4da682[_0x256af1(0xa4)](0xc8)[_0x256af1(0xa9)](_0x210b99);}catch(_0x310a19){_0x4da682[_0x256af1(0xa4)](0x194)[_0x256af1(0xa9)]({'message':_0x310a19[_0x256af1(0x128)]});}}),module[a0_0x2d8a71(0x133)]=router;