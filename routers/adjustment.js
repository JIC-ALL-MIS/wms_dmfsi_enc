function a0_0x12cb(_0x340eba,_0x49a80a){var _0xbec5e6=a0_0xbec5();return a0_0x12cb=function(_0x12cb24,_0x525825){_0x12cb24=_0x12cb24-0xbd;var _0x2f340a=_0xbec5e6[_0x12cb24];return _0x2f340a;},a0_0x12cb(_0x340eba,_0x49a80a);}function a0_0xbec5(){var _0x37ba57=['role','<h5\x20style=\x22text-align:\x20left;\x22>','/view','rack','product_details','body','isAllowEdit','warehouse_name','\x20Order\x20Date\x20:\x20','New_Qty_Converted_adj','batch_code','/adjustment/view','invoice','$product_details.maxProducts','$product_details.expiry_date','length','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Raw\x20Materials','user','<div>','RMSEmail','success','save','maxperunit','prod_code','production_date','Portuguese\x20(BR)','6127632XoSycP','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','render','$invoice','floorlevel','room','$warehouse_name','findById','message','$product_details.product_name','Arabic','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details','Floor','$product_details.storage','Logo.png','primary_code','secondary_unit','filter','</span>','Shelves','$product_details.unit','Secondary_units','<tbody\x20style=\x22text-align:\x20center;\x22>','log','floor','maxPerUnit','host','stockBefore','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','post','ADJ-','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','edit_adjustment','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','New_Qty_Converted','email','Chinese','new_adjust_qty','1221180MXjsdN','edit_adjustment_view','add_adjustment','Enabled','$product_details.batch_code','push','prod_name','$product_details.pallet','$product_details.primary_code','params','English\x20(US)','$product_details.production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.floorlevel','/barcode_scanner','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Primary_Units','$product_details.maxPerUnit','port','$product_details.bay','prime1','Enclosed','Level','Return\x20Goods','finalize','storage','True','product_stock','$product_details.product_cat','password','$product_details.secondary_unit','$product.room_names','Arabic\x20(ae)','/adjustment/preview/','Adjustment\x20Mail','$product_details.product_code','$product_details.bin','Error\x20Occurs','$name','</h5>','/CheckingWarehouse','bin','types','Spanish','language','adjustment\x20data\x20update\x20successfully','/../public','</head><body>','<h5>','$_id','French','product_name','</td>','Receiving\x20Area','findOne','$product_details.secondary_code','<tr>','German','prod_cat','product','559532IUlxnL','<strong>\x20Regards\x20</strong>','padStart','Hindi','image','1391248kofOIC','minus','An\x20error\x20occurred.','max_per_unit','level','../models/all_models','forEach','random','redirect','</thead>','room_names','913790vdEiNk','createTransport','Return\x20Rooms','unit','adjustment\x20Finalized\x20successfully','warehouse','site_title','type','\x20<>\x20','sendMail','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','2967900kWotnw','/picking_list/PDF_adjustment_rm/','Portuguese','product_code','flash','13122xiGszb','<h2>\x20','json','$isAllowEdit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','error','foreach\x20newproduct','adjustment','express','split','map','<hr\x20class=\x22my-3\x22>','$room','prod_invoice','_id','stock','errors','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','logo','$product_details.product_stock','\x20Order\x20Number\x20:\x20','slice','adjust_qty','$product_details._id','False','staff','Email\x20sent\x20successfully','find','expiry_date','</div>','\x20</h2>','Rooms','get','$date','back','/preview/:id','$product','secondary_code','all','catch','second1','status','bay','$product_details.rack','$product.product_name','</tr>','string','../middleware/auth','/upload/','$finalize','toString'];a0_0xbec5=function(){return _0x37ba57;};return a0_0xbec5();}var a0_0x1df23d=a0_0x12cb;(function(_0x37e806,_0x52efc3){var _0x34bb5e=a0_0x12cb,_0x2e4474=_0x37e806();while(!![]){try{var _0x448547=parseInt(_0x34bb5e(0x132))/0x1+-parseInt(_0x34bb5e(0x142))/0x2+-parseInt(_0x34bb5e(0x152))/0x3+parseInt(_0x34bb5e(0x137))/0x4+parseInt(_0x34bb5e(0xf6))/0x5+parseInt(_0x34bb5e(0x14d))/0x6+-parseInt(_0x34bb5e(0xcb))/0x7;if(_0x448547===_0x52efc3)break;else _0x2e4474['push'](_0x2e4474['shift']());}catch(_0x34dd13){_0x2e4474['push'](_0x2e4474['shift']());}}}(a0_0xbec5,0x4b951));const express=require(a0_0x1df23d(0x15a)),app=express(),router=express['Router'](),auth=require(a0_0x1df23d(0x181)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1df23d(0x13c)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router['get'](a0_0x1df23d(0x187),auth,async(_0x10dc45,_0x449191)=>{var _0x6d337a=a0_0x1df23d;try{const {username:_0x398930,email:_0x3ab0a2,role:_0x4e3eff}=_0x10dc45[_0x6d337a(0xc2)],_0x125689=_0x10dc45['user'],_0x57362c=await profile[_0x6d337a(0x12c)]({'email':_0x125689[_0x6d337a(0xf3)]}),_0x4e5883=await master_shop['find']();console[_0x6d337a(0xe3)]('master',_0x4e5883);let _0xd8b114;if(_0x125689['role']==_0x6d337a(0x16b)){const _0x280e6a=await staff[_0x6d337a(0x12c)]({'email':_0x125689[_0x6d337a(0xf3)]});_0xd8b114=await warehouse['find']({'status':_0x6d337a(0xf9),'name':_0x280e6a[_0x6d337a(0x147)]});}else _0xd8b114=await warehouse[_0x6d337a(0x16d)]({'status':_0x6d337a(0xf9)});const _0x38e3f8=await product[_0x6d337a(0x16d)]();let _0x303a0f;if(_0x125689[_0x6d337a(0x185)]==_0x6d337a(0x16b)){const _0x1e5dea=await staff[_0x6d337a(0x12c)]({'email':_0x125689['email']});_0x303a0f=await adjustment['find']({'warehouse_name':_0x1e5dea[_0x6d337a(0x147)]});}else _0x303a0f=await adjustment[_0x6d337a(0xeb)]([{'$unwind':_0x6d337a(0x176)},{'$group':{'_id':_0x6d337a(0x127),'invoice':{'$first':_0x6d337a(0xce)},'date':{'$first':_0x6d337a(0x173)},'warehouse_name':{'$first':_0x6d337a(0xd1)},'room':{'$addToSet':_0x6d337a(0x115)},'finalize':{'$first':_0x6d337a(0x183)},'isAllowEdit':{'$first':_0x6d337a(0x155)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4e5883[0x0][_0x6d337a(0x122)]==_0x6d337a(0x100)){var _0x5a41fa=users['English'];console[_0x6d337a(0xe3)](_0x5a41fa);}else{if(_0x4e5883[0x0][_0x6d337a(0x122)]=='Hindi')var _0x5a41fa=users[_0x6d337a(0x135)];else{if(_0x4e5883[0x0]['language']==_0x6d337a(0x12f))var _0x5a41fa=users[_0x6d337a(0x12f)];else{if(_0x4e5883[0x0]['language']=='Spanish')var _0x5a41fa=users[_0x6d337a(0x121)];else{if(_0x4e5883[0x0][_0x6d337a(0x122)]==_0x6d337a(0x128))var _0x5a41fa=users['French'];else{if(_0x4e5883[0x0][_0x6d337a(0x122)]==_0x6d337a(0xca))var _0x5a41fa=users[_0x6d337a(0x14f)];else{if(_0x4e5883[0x0][_0x6d337a(0x122)]==_0x6d337a(0xf4))var _0x5a41fa=users[_0x6d337a(0xf4)];else{if(_0x4e5883[0x0]['language']=='Arabic\x20(ae)')var _0x5a41fa=users[_0x6d337a(0xd5)];}}}}}}}_0x449191[_0x6d337a(0xcd)](_0x6d337a(0x159),{'success':_0x10dc45[_0x6d337a(0x151)](_0x6d337a(0xc5)),'errors':_0x10dc45['flash'](_0x6d337a(0x162)),'role':_0x125689,'profile':_0x57362c,'warehouse':_0xd8b114,'product':_0x38e3f8,'adjustment':_0x303a0f,'master_shop':_0x4e5883,'language':_0x5a41fa});}catch(_0x3cd8ed){console[_0x6d337a(0xe3)](_0x3cd8ed);}});async function getRandom8DigitNumber(){var _0x3b7d97=a0_0x1df23d;const _0xdbc7af=0x989680,_0x3d5132=0x5f5e0ff,_0x8c26e8=Math[_0x3b7d97(0xe4)](Math[_0x3b7d97(0x13e)]()*(_0x3d5132-_0xdbc7af+0x1))+_0xdbc7af;var _0x39272d;const _0x2d7804=await adjustment[_0x3b7d97(0x12c)]({'invoice':'ADJ-'+_0x8c26e8});return _0x2d7804&&_0x2d7804[_0x3b7d97(0xbf)]>0x0?_0x39272d='ADJ-'+_0x8c26e8:_0x39272d=_0x3b7d97(0xea)+_0x8c26e8,_0x39272d;}router[a0_0x1df23d(0x172)]('/view/add_adjustment',auth,async(_0x1260a4,_0x240b29)=>{var _0x1e2702=a0_0x1df23d;try{const {username:_0x22be59,email:_0x127b23,role:_0x47f074}=_0x1260a4[_0x1e2702(0xc2)],_0x46bf91=_0x1260a4[_0x1e2702(0xc2)],_0xa47fa0=await profile['findOne']({'email':_0x46bf91['email']}),_0x4cb6f2=await master_shop[_0x1e2702(0x16d)]();let _0xeee5c8;if(_0x46bf91['role']=='staff'){const _0x49e4d9=await staff[_0x1e2702(0x12c)]({'email':_0x46bf91[_0x1e2702(0xf3)]});_0xeee5c8=await warehouse[_0x1e2702(0xeb)]([{'$match':{'status':_0x1e2702(0xf9),'name':_0x49e4d9[_0x1e2702(0x147)],'warehouse_category':_0x1e2702(0xc1),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x1e2702(0x11c),'name':{'$first':_0x1e2702(0x11c)}}}]);}else _0xeee5c8=await warehouse['aggregate']([{'$match':{'status':_0x1e2702(0xf9),'warehouse_category':_0x1e2702(0xc1),'name':{'$ne':_0x1e2702(0x10d)}}},{'$group':{'_id':_0x1e2702(0x11c),'name':{'$first':_0x1e2702(0x11c)}}}]);const _0x45b8c6=await product['find']({}),_0x5d016d=await adjustment[_0x1e2702(0x16d)]({}),_0x5d4d38=_0x5d016d[_0x1e2702(0xbf)]+0x1,_0x5c2723='ADJ-'+_0x5d4d38[_0x1e2702(0x184)]()[_0x1e2702(0x134)](0x5,'0');var _0x382abd=['Ambient',_0x1e2702(0x10b),_0x1e2702(0x144)];if(_0x4cb6f2[0x0][_0x1e2702(0x122)]==_0x1e2702(0x100))var _0x2c51bc=users[_0x1e2702(0xee)];else{if(_0x4cb6f2[0x0][_0x1e2702(0x122)]=='Hindi')var _0x2c51bc=users[_0x1e2702(0x135)];else{if(_0x4cb6f2[0x0][_0x1e2702(0x122)]=='German')var _0x2c51bc=users[_0x1e2702(0x12f)];else{if(_0x4cb6f2[0x0][_0x1e2702(0x122)]=='Spanish')var _0x2c51bc=users[_0x1e2702(0x121)];else{if(_0x4cb6f2[0x0]['language']==_0x1e2702(0x128))var _0x2c51bc=users[_0x1e2702(0x128)];else{if(_0x4cb6f2[0x0][_0x1e2702(0x122)]==_0x1e2702(0xca))var _0x2c51bc=users['Portuguese'];else{if(_0x4cb6f2[0x0][_0x1e2702(0x122)]==_0x1e2702(0xf4))var _0x2c51bc=users['Chinese'];else{if(_0x4cb6f2[0x0][_0x1e2702(0x122)]=='Arabic\x20(ae)')var _0x2c51bc=users[_0x1e2702(0xd5)];}}}}}}}const _0x7197c5=getRandom8DigitNumber();_0x7197c5['then'](_0x27e3ef=>{var _0x39b728=_0x1e2702;_0x240b29[_0x39b728(0xcd)](_0x39b728(0xf8),{'success':_0x1260a4['flash'](_0x39b728(0xc5)),'errors':_0x1260a4[_0x39b728(0x151)](_0x39b728(0x162)),'role':_0x46bf91,'profile':_0xa47fa0,'warehouse':_0xeee5c8,'product':_0x45b8c6,'master_shop':_0x4cb6f2,'language':_0x2c51bc,'rooms_data':_0x382abd,'invoice_no':_0x27e3ef});})[_0x1e2702(0x179)](_0x32a8d0=>{var _0x59a78a=_0x1e2702;_0x1260a4[_0x59a78a(0x151)](_0x59a78a(0x162),_0x59a78a(0x105)),_0x240b29[_0x59a78a(0x13f)]('/adjustment/view');});}catch(_0x2e7697){console['log'](_0x2e7697);}}),router[a0_0x1df23d(0xe9)]('/view/add_adjustment',auth,async(_0x1f2517,_0x15bf32)=>{var _0x19af23=a0_0x1df23d;try{const {warehouse_name:_0x59c97d,date:_0x288b01,prod_name:_0x22c116,level:_0x21ee49,isle:_0x15f0de,pallet:_0x101e08,stock:_0x3b5714,types:_0x539bfd,adjust_qty:_0x593a32,new_adjust_qty:_0x1d3f32,note:_0x48ec00,Room_name:_0x1522c1,invoice:_0x5091cf,JO_number:_0x2e8023,expiry_date:_0x41bf01}=_0x1f2517[_0x19af23(0x18a)];if(typeof _0x22c116==_0x19af23(0x180))var _0x6bd695=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0xfc)]],_0x21912c=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x13b)]],_0x4cf1bb=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x161)]],_0x3f67dd=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x120)]],_0x5f453d=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x18e)]],_0x3e78d6=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0xf2)]],_0x484ed0=[_0x1f2517['body']['Primary_Units']],_0x3169aa=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0xe1)]],_0x38e21e=[_0x1f2517[_0x19af23(0x18a)]['prod_code']],_0x50b816=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x18f)]],_0x23684e=[_0x1f2517[_0x19af23(0x18a)]['expiry_date']],_0x189e7d=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x13a)]],_0x77e102=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0xc9)]],_0x2e1515=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x130)]],_0x44f6b2=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x171)]],_0x5cfd62=[_0x1f2517[_0x19af23(0x18a)]['prime1']],_0x1c07ff=[_0x1f2517['body'][_0x19af23(0x17a)]],_0x48f87b=[_0x1f2517[_0x19af23(0x18a)][_0x19af23(0x15f)]];else var _0x6bd695=[..._0x1f2517['body'][_0x19af23(0xfc)]],_0x21912c=[..._0x1f2517[_0x19af23(0x18a)][_0x19af23(0x13b)]],_0x4cf1bb=[..._0x1f2517[_0x19af23(0x18a)]['stock']],_0x3f67dd=[..._0x1f2517['body']['types']],_0x5f453d=[..._0x1f2517['body'][_0x19af23(0x18e)]],_0x3e78d6=[..._0x1f2517['body'][_0x19af23(0xf2)]],_0x484ed0=[..._0x1f2517['body'][_0x19af23(0x145)]],_0x3169aa=[..._0x1f2517[_0x19af23(0x18a)][_0x19af23(0xe1)]],_0x38e21e=[..._0x1f2517[_0x19af23(0x18a)]['prod_code']],_0x50b816=[..._0x1f2517[_0x19af23(0x18a)]['batch_code']],_0x23684e=[..._0x1f2517['body'][_0x19af23(0x16e)]],_0x189e7d=[..._0x1f2517['body'][_0x19af23(0x13a)]],_0x77e102=[..._0x1f2517[_0x19af23(0x18a)]['production_date']],_0x2e1515=[..._0x1f2517[_0x19af23(0x18a)]['prod_cat']],_0x44f6b2=[..._0x1f2517[_0x19af23(0x18a)][_0x19af23(0x171)]],_0x5cfd62=[..._0x1f2517['body']['prime1']],_0x1c07ff=[..._0x1f2517[_0x19af23(0x18a)][_0x19af23(0x17a)]],_0x48f87b=[..._0x1f2517[_0x19af23(0x18a)][_0x19af23(0x15f)]];const _0x3e13ea=_0x6bd695[_0x19af23(0x15c)](_0x41b3de=>{return _0x41b3de={'product_name':_0x41b3de};});_0x21912c[_0x19af23(0x13d)]((_0x16cd6a,_0xcc0104)=>{var _0x447607=_0x19af23;_0x44f6b2[_0x447607(0x13d)]((_0x1b11d7,_0x4e65bf)=>{var _0x7cdb19=_0x447607;if(_0x1b11d7==_0x7cdb19(0x12b)&&_0xcc0104==_0x4e65bf){var _0x360da9=_0x16cd6a[_0x7cdb19(0x167)](0x3);_0x3e13ea[_0xcc0104][_0x7cdb19(0x10f)]=_0x16cd6a[0x0],_0x3e13ea[_0xcc0104][_0x7cdb19(0x188)]=_0x16cd6a[0x1],_0x3e13ea[_0xcc0104][_0x7cdb19(0x17c)]=0x0,_0x3e13ea[_0xcc0104][_0x7cdb19(0x11f)]=0x0,_0x3e13ea[_0xcc0104][_0x7cdb19(0x149)]=_0x7cdb19(0xd8),_0x3e13ea[_0xcc0104][_0x7cdb19(0xcf)]=_0x360da9;}else{if(_0x1b11d7=='Shelves'&&_0xcc0104==_0x4e65bf){var _0x360da9=_0x16cd6a[_0x7cdb19(0x167)](0x3);_0x3e13ea[_0xcc0104][_0x7cdb19(0x10f)]=_0x16cd6a[0x0],_0x3e13ea[_0xcc0104][_0x7cdb19(0x188)]=_0x16cd6a[0x1],_0x3e13ea[_0xcc0104][_0x7cdb19(0x17c)]=0x0,_0x3e13ea[_0xcc0104][_0x7cdb19(0x11f)]=0x0,_0x3e13ea[_0xcc0104][_0x7cdb19(0x149)]=_0x7cdb19(0xd8),_0x3e13ea[_0xcc0104][_0x7cdb19(0xcf)]=_0x16cd6a[0x5];}else{if(_0xcc0104==_0x4e65bf){var _0x404dda;if(_0x16cd6a[0x4]=='L')_0x404dda=_0x7cdb19(0x10c);else _0x16cd6a[0x4]=='F'&&(_0x404dda=_0x7cdb19(0xd8));_0x3e13ea[_0xcc0104][_0x7cdb19(0x10f)]=_0x16cd6a[0x0],_0x3e13ea[_0xcc0104][_0x7cdb19(0x188)]=_0x16cd6a[0x1],_0x3e13ea[_0xcc0104][_0x7cdb19(0x17c)]=_0x16cd6a[0x2],_0x3e13ea[_0xcc0104][_0x7cdb19(0x11f)]=_0x16cd6a[0x3],_0x3e13ea[_0xcc0104]['type']=_0x404dda,_0x3e13ea[_0xcc0104][_0x7cdb19(0xcf)]=_0x16cd6a[0x5];}}}});}),_0x4cf1bb['forEach']((_0x14402f,_0x416f3c)=>{_0x3e13ea[_0x416f3c]['stockBefore']=_0x14402f;}),_0x3f67dd[_0x19af23(0x13d)]((_0xad7792,_0x4a8d9f)=>{var _0x2b1e6d=_0x19af23;_0x3e13ea[_0x4a8d9f][_0x2b1e6d(0x120)]=_0xad7792;}),_0x5f453d['forEach']((_0xde9983,_0x2f7dce)=>{var _0xd9523e=_0x19af23;_0x3e13ea[_0x2f7dce][_0xd9523e(0x168)]=_0xde9983;}),_0x3e78d6[_0x19af23(0x13d)]((_0x474171,_0x4b6e69)=>{var _0x10ca5b=_0x19af23;_0x3e13ea[_0x4b6e69][_0x10ca5b(0xf5)]=_0x474171;}),_0x484ed0[_0x19af23(0x13d)]((_0x1aacbb,_0x5b4613)=>{var _0x528eb4=_0x19af23;_0x3e13ea[_0x5b4613][_0x528eb4(0x145)]=_0x1aacbb;}),_0x3169aa[_0x19af23(0x13d)]((_0x2a9552,_0x2a116c)=>{var _0x420103=_0x19af23;_0x3e13ea[_0x2a116c][_0x420103(0xdc)]=_0x2a9552;}),_0x38e21e['forEach']((_0x1de507,_0x625342)=>{var _0x4007f3=_0x19af23;_0x3e13ea[_0x625342][_0x4007f3(0x150)]=_0x1de507;}),_0x50b816[_0x19af23(0x13d)]((_0x5b9728,_0xf2326b)=>{var _0x607602=_0x19af23;_0x3e13ea[_0xf2326b][_0x607602(0x18f)]=_0x5b9728;}),_0x23684e[_0x19af23(0x13d)]((_0x3a136e,_0x1c667c)=>{_0x3e13ea[_0x1c667c]['expiry_date']=_0x3a136e;}),_0x189e7d[_0x19af23(0x13d)]((_0xc710ae,_0x39840f)=>{var _0x57da12=_0x19af23;_0x3e13ea[_0x39840f][_0x57da12(0xc7)]=_0xc710ae;}),_0x77e102[_0x19af23(0x13d)]((_0x501a4,_0x144675)=>{_0x3e13ea[_0x144675]['production_date']=_0x501a4;}),_0x2e1515[_0x19af23(0x13d)]((_0x450764,_0x573d5d)=>{var _0x1ba94f=_0x19af23;_0x3e13ea[_0x573d5d][_0x1ba94f(0x130)]=_0x450764;}),_0x44f6b2[_0x19af23(0x13d)]((_0x1cb257,_0x1c52bb)=>{var _0x1ff1f7=_0x19af23;_0x3e13ea[_0x1c52bb][_0x1ff1f7(0x141)]=_0x1cb257;}),_0x5cfd62[_0x19af23(0x13d)]((_0x31b958,_0x150e60)=>{var _0x3d8ba7=_0x19af23;_0x3e13ea[_0x150e60][_0x3d8ba7(0xdb)]=_0x31b958;}),_0x1c07ff[_0x19af23(0x13d)]((_0x5d985e,_0x1ed65b)=>{var _0x523bb3=_0x19af23;_0x3e13ea[_0x1ed65b][_0x523bb3(0x177)]=_0x5d985e;}),_0x48f87b[_0x19af23(0x13d)]((_0x81f727,_0xd57553)=>{var _0x5b36e6=_0x19af23;_0x3e13ea[_0xd57553][_0x5b36e6(0x191)]=_0x81f727;});const _0x5e1228=_0x3e13ea[_0x19af23(0xdd)](_0x4bd158=>_0x4bd158['adjust_qty']!=='0'&&_0x4bd158['adjust_qty']!=='');var _0x445271=0x0;_0x5e1228[_0x19af23(0x13d)](_0x5bebe8=>{var _0x55d25b=_0x19af23;console[_0x55d25b(0xe3)](_0x55d25b(0x158),_0x5bebe8),parseInt(_0x5bebe8[_0x55d25b(0x168)])<=0x0&&_0x445271++;});if(_0x445271!=0x0)return _0x1f2517[_0x19af23(0x151)](_0x19af23(0x162),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x15bf32[_0x19af23(0x13f)]('back');const _0x11f3b8=new adjustment({'warehouse_name':_0x59c97d,'date':_0x288b01,'product':_0x5e1228,'note':_0x48ec00,'room':_0x1522c1,'invoice':_0x5091cf,'JO_number':_0x2e8023,'expiry_date':_0x41bf01}),_0x2293a1=await _0x11f3b8['save']();_0x1f2517['flash'](_0x19af23(0xc5),'adjustment\x20add\x20successfull'),_0x15bf32['redirect'](_0x19af23(0x117)+_0x2293a1[_0x19af23(0x160)]);}catch(_0x4e0c55){console[_0x19af23(0xe3)](_0x4e0c55),_0x15bf32[_0x19af23(0x17b)](0xc8)['json']({'message':_0x4e0c55['message']});}}),router[a0_0x1df23d(0x172)]('/preview/:id',auth,async(_0x126870,_0x2fa0dc)=>{var _0x4c4b87=a0_0x1df23d;try{const {username:_0x151db1,email:_0x457d25,role:_0x54ddd0}=_0x126870[_0x4c4b87(0xc2)],_0x5d656d=_0x126870[_0x4c4b87(0xc2)],_0xfdea6a=await profile[_0x4c4b87(0x12c)]({'email':_0x5d656d['email']}),_0x6e3f44=await master_shop['find'](),_0x3d0543=_0x126870['params']['id'],_0x5e1af2=await adjustment[_0x4c4b87(0xd2)]({'_id':_0x3d0543}),_0xb1e4f9=await purchases[_0x4c4b87(0xeb)]([{'$match':{'warehouse_name':_0x5e1af2[_0x4c4b87(0x18c)]}},{'$unwind':'$product'},{'$group':{'_id':_0x4c4b87(0x17e)}}]),_0x637966=await product[_0x4c4b87(0x16d)]({}),_0x382a02=await warehouse[_0x4c4b87(0xeb)]([{'$match':{'name':_0x5e1af2['warehouse_name']}},{'$unwind':_0x4c4b87(0xd7)},{'$group':{'_id':_0x4c4b87(0x169),'name':{'$first':_0x4c4b87(0xd4)},'product_stock':{'$first':_0x4c4b87(0x165)},'bay':{'$first':_0x4c4b87(0x109)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4c4b87(0xf0)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4c4b87(0xfe)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4c4b87(0x119)},'storage':{'$first':_0x4c4b87(0xd9)},'rack':{'$first':_0x4c4b87(0x17d)},'maxPerUnit':{'$first':_0x4c4b87(0x107)},'expiry_date':{'$first':_0x4c4b87(0xbe)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4c4b87(0xfa)},'room':{'$first':'$room'}}}]);if(_0x6e3f44[0x0][_0x4c4b87(0x122)]==_0x4c4b87(0x100)){var _0x28d4b0=users[_0x4c4b87(0xee)];console[_0x4c4b87(0xe3)](_0x28d4b0);}else{if(_0x6e3f44[0x0][_0x4c4b87(0x122)]==_0x4c4b87(0x135))var _0x28d4b0=users[_0x4c4b87(0x135)];else{if(_0x6e3f44[0x0][_0x4c4b87(0x122)]==_0x4c4b87(0x12f))var _0x28d4b0=users['German'];else{if(_0x6e3f44[0x0][_0x4c4b87(0x122)]==_0x4c4b87(0x121))var _0x28d4b0=users[_0x4c4b87(0x121)];else{if(_0x6e3f44[0x0][_0x4c4b87(0x122)]==_0x4c4b87(0x128))var _0x28d4b0=users[_0x4c4b87(0x128)];else{if(_0x6e3f44[0x0][_0x4c4b87(0x122)]==_0x4c4b87(0xca))var _0x28d4b0=users['Portuguese'];else{if(_0x6e3f44[0x0]['language']=='Chinese')var _0x28d4b0=users[_0x4c4b87(0xf4)];else{if(_0x6e3f44[0x0]['language']==_0x4c4b87(0x116))var _0x28d4b0=users[_0x4c4b87(0xd5)];}}}}}}}_0x2fa0dc[_0x4c4b87(0xcd)](_0x4c4b87(0xf7),{'success':_0x126870[_0x4c4b87(0x151)](_0x4c4b87(0xc5)),'errors':_0x126870[_0x4c4b87(0x151)](_0x4c4b87(0x162)),'role':_0x5d656d,'profile':_0xfdea6a,'adjustment':_0x5e1af2,'stock':_0x382a02,'master_shop':_0x6e3f44,'warehouse_name':_0xb1e4f9,'unit':_0x637966,'language':_0x28d4b0});}catch(_0x49f336){console[_0x4c4b87(0xe3)](_0x49f336),_0x2fa0dc[_0x4c4b87(0x17b)](0xc8)[_0x4c4b87(0x154)]({'message':_0x49f336[_0x4c4b87(0xd3)]});}}),router[a0_0x1df23d(0xe9)](a0_0x1df23d(0x175),auth,async(_0x160d79,_0x30094e)=>{var _0x2069fe=a0_0x1df23d;try{const _0x408112=_0x160d79[_0x2069fe(0xff)]['id'],{warehouse_name:_0x236a5c,Room_name:_0x40a295}=_0x160d79[_0x2069fe(0x18a)],_0x2d56b3=await adjustment[_0x2069fe(0xd2)]({'_id':_0x408112}),_0x4c220e=_0x2d56b3[_0x2069fe(0x131)][_0x2069fe(0x15c)](async _0x4b0fba=>{var _0xf2def3=_0x2069fe;if(_0x4b0fba['adjust_qty']>0x0){var _0x294b13=await warehouse[_0xf2def3(0x12c)]({'name':_0x236a5c,'room':_0x4b0fba[_0xf2def3(0x141)],'warehouse_category':'Raw\x20Materials'});const _0x208618=_0x294b13[_0xf2def3(0x189)][_0xf2def3(0x15c)](_0x120752=>{var _0xa92091=_0xf2def3;if(_0x4b0fba[_0xa92091(0x149)]==_0xa92091(0x138)){if(_0x120752[_0xa92091(0x129)]==_0x4b0fba[_0xa92091(0x129)]&&_0x120752[_0xa92091(0xcf)]==_0x4b0fba['floorlevel']&&_0x120752[_0xa92091(0x149)]==_0x4b0fba['type']&&_0x120752[_0xa92091(0x11f)]==_0x4b0fba['bin']&&_0x120752[_0xa92091(0x17c)]==_0x4b0fba[_0xa92091(0x17c)]&&_0x120752['rack']==_0x4b0fba['rack']&&_0x120752[_0xa92091(0x10f)]==_0x4b0fba[_0xa92091(0x10f)]&&_0x120752[_0xa92091(0x16e)]==_0x4b0fba['expiry_date']&&_0x120752[_0xa92091(0x18f)]==_0x4b0fba[_0xa92091(0x18f)]&&_0x120752[_0xa92091(0xc9)]==_0x4b0fba['production_date']&&_0x120752[_0xa92091(0x191)]==_0x4b0fba[_0xa92091(0x191)]){var _0x51c1d0;_0x51c1d0=_0x4b0fba['adjust_qty'],_0x4b0fba['prod_cat']=='S'&&(_0x51c1d0=_0x4b0fba[_0xa92091(0x168)]),_0x120752[_0xa92091(0x111)]=_0x120752['product_stock']-_0x51c1d0;}}else{if(_0x120752[_0xa92091(0x129)]==_0x4b0fba[_0xa92091(0x129)]&&_0x120752[_0xa92091(0xcf)]==_0x4b0fba[_0xa92091(0xcf)]&&_0x120752['type']==_0x4b0fba[_0xa92091(0x149)]&&_0x120752['bin']==_0x4b0fba['bin']&&_0x120752[_0xa92091(0x17c)]==_0x4b0fba[_0xa92091(0x17c)]&&_0x120752['rack']==_0x4b0fba[_0xa92091(0x188)]&&_0x120752[_0xa92091(0x10f)]==_0x4b0fba[_0xa92091(0x10f)]&&_0x120752['expiry_date']==_0x4b0fba[_0xa92091(0x16e)]&&_0x120752[_0xa92091(0x18f)]==_0x4b0fba[_0xa92091(0x18f)]&&_0x120752[_0xa92091(0xc9)]==_0x4b0fba[_0xa92091(0xc9)]&&_0x120752['invoice']==_0x4b0fba[_0xa92091(0x191)]){console[_0xa92091(0xe3)](_0x4b0fba);var _0x51c1d0;_0x51c1d0=_0x4b0fba[_0xa92091(0x168)],_0x4b0fba[_0xa92091(0x130)]=='S'&&(_0x51c1d0=_0x4b0fba[_0xa92091(0x168)]),console[_0xa92091(0xe3)](_0x51c1d0+_0xa92091(0x14a)+_0x4b0fba[_0xa92091(0x168)]+_0xa92091(0x14a)+_0x120752[_0xa92091(0xe5)]+_0xa92091(0x14a)+_0x4b0fba[_0xa92091(0x130)]),_0x120752['product_stock']=_0x120752[_0xa92091(0x111)]+_0x51c1d0;}}});}return _0x294b13;});Promise[_0x2069fe(0x178)](_0x4c220e)['then'](async _0x50554d=>{var _0x1651eb=_0x2069fe;try{for(const _0x2ee793 of _0x50554d){await _0x2ee793[_0x1651eb(0xc6)]();}_0x2d56b3[_0x1651eb(0x10e)]=_0x1651eb(0x110);const _0x5b182a=await _0x2d56b3['save'](),_0x469871=await master_shop['find'](),_0x3ec90d=await email_settings[_0x1651eb(0x12c)](),_0x73070d=await supervisor_settings[_0x1651eb(0x16d)]();var _0xe47ec=_0x2d56b3[_0x1651eb(0x131)],_0x2d74bf='',_0xf32fbd;for(_0xf32fbd in _0xe47ec){_0x2d74bf+=_0x1651eb(0x12e)+_0x1651eb(0xcc)+_0xe47ec[_0xf32fbd][_0x1651eb(0x129)]+_0x1651eb(0x12a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xe47ec[_0xf32fbd][_0x1651eb(0x150)]+_0x1651eb(0x12a)+_0x1651eb(0xcc)+_0xe47ec[_0xf32fbd][_0x1651eb(0x168)]+_0x1651eb(0x12a)+_0x1651eb(0xcc)+_0xe47ec[_0xf32fbd][_0x1651eb(0x145)]+_0x1651eb(0x12a)+_0x1651eb(0xcc)+_0xe47ec[_0xf32fbd]['secondary_unit']+_0x1651eb(0x12a)+_0x1651eb(0xcc)+_0x2d56b3['warehouse_name']+_0x1651eb(0x12a)+_0x1651eb(0xcc)+_0xe47ec[_0xf32fbd][_0x1651eb(0x141)]+_0x1651eb(0x12a)+_0x1651eb(0xcc)+_0xe47ec[_0xf32fbd][_0x1651eb(0x10f)]+_0xe47ec[_0xf32fbd][_0x1651eb(0x188)]+_0xe47ec[_0xf32fbd][_0x1651eb(0x17c)]+_0xe47ec[_0xf32fbd]['bin']+_0xe47ec[_0xf32fbd][_0x1651eb(0x149)][0x0]+_0xe47ec[_0xf32fbd]['floorlevel']+_0x1651eb(0x12a),_0x1651eb(0x17f);}let _0x18bacd=nodemailer[_0x1651eb(0x143)]({'host':_0x3ec90d[_0x1651eb(0xe6)],'port':Number(_0x3ec90d[_0x1651eb(0x108)]),'secure':![],'auth':{'user':_0x3ec90d[_0x1651eb(0xf3)],'pass':_0x3ec90d[_0x1651eb(0x113)]}}),_0x21b6f9={'from':_0x3ec90d['email'],'to':_0x73070d[0x0][_0x1651eb(0xc4)],'subject':_0x1651eb(0x118),'attachments':[{'filename':_0x1651eb(0xda),'path':__dirname+_0x1651eb(0x124)+_0x1651eb(0x182)+_0x469871[0x0][_0x1651eb(0x136)],'cid':_0x1651eb(0x164)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x1651eb(0x125)+_0x1651eb(0xc3)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x1651eb(0xc0)+_0x1651eb(0x16f)+_0x1651eb(0xc3)+_0x1651eb(0x153)+_0x469871[0x0][_0x1651eb(0x148)]+_0x1651eb(0x170)+_0x1651eb(0x16f)+_0x1651eb(0x16f)+_0x1651eb(0x15d)+_0x1651eb(0xc3)+_0x1651eb(0x186)+_0x1651eb(0x166)+_0x2d56b3[_0x1651eb(0x191)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x1651eb(0x18d)+_0x2d56b3['date']+'\x20'+_0x1651eb(0xde)+_0x1651eb(0x11d)+_0x1651eb(0x16f)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1651eb(0x14c)+'<tr>'+_0x1651eb(0xec)+_0x1651eb(0xef)+_0x1651eb(0x156)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x1651eb(0x102)+_0x1651eb(0xe8)+_0x1651eb(0x163)+_0x1651eb(0xf1)+_0x1651eb(0x17f)+_0x1651eb(0x140)+_0x1651eb(0xe2)+'\x20'+_0x2d74bf+'\x20'+'</tbody>'+'</table>'+_0x1651eb(0xc3)+_0x1651eb(0x133)+_0x1651eb(0x126)+_0x469871[0x0][_0x1651eb(0x148)]+_0x1651eb(0x11d)+'</div>'+'</div>'+'</body></html>'};_0x18bacd[_0x1651eb(0x14b)](_0x21b6f9,function(_0x766101,_0x176c78){var _0x1cd475=_0x1651eb;_0x766101?(console['log'](_0x766101),console[_0x1cd475(0xe3)](_0x1cd475(0x11b))):console[_0x1cd475(0xe3)](_0x1cd475(0x16c));}),_0x160d79[_0x1651eb(0x151)](_0x1651eb(0xc5),_0x1651eb(0x146)),_0x30094e[_0x1651eb(0x13f)](_0x1651eb(0x14e)+_0x5b182a[_0x1651eb(0x160)]);}catch(_0x3ffd68){console[_0x1651eb(0x157)](_0x3ffd68),_0x30094e[_0x1651eb(0x17b)](0x1f4)[_0x1651eb(0x154)]({'error':_0x1651eb(0xd6)});}})[_0x2069fe(0x179)](_0x3d2d05=>{var _0x2c5fbf=_0x2069fe;console['error'](_0x3d2d05),_0x30094e[_0x2c5fbf(0x17b)](0x1f4)['json']({'error':_0x2c5fbf(0x139)});});}catch(_0x43a9f4){console[_0x2069fe(0xe3)](_0x43a9f4),_0x30094e['status'](0xc8)[_0x2069fe(0x154)]({'message':_0x43a9f4[_0x2069fe(0xd3)]});}}),router[a0_0x1df23d(0x172)]('/view/:id',auth,async(_0x38da40,_0x19d1a8)=>{var _0x3ee305=a0_0x1df23d;try{const {username:_0x4af254,email:_0x21f52c,role:_0x596c60}=_0x38da40[_0x3ee305(0xc2)],_0x48c5d1=_0x38da40[_0x3ee305(0xc2)],_0x57d4dd=await profile['findOne']({'email':_0x48c5d1[_0x3ee305(0xf3)]}),_0x24bf4b=await master_shop[_0x3ee305(0x16d)](),_0x452319=_0x38da40[_0x3ee305(0xff)]['id'],_0x2f72be=await adjustment[_0x3ee305(0xd2)]({'_id':_0x452319}),_0x1c652d=await purchases[_0x3ee305(0xeb)]([{'$match':{'warehouse_name':_0x2f72be['warehouse_name']}},{'$unwind':_0x3ee305(0x176)},{'$group':{'_id':_0x3ee305(0x17e)}}]),_0x2080bc=await product[_0x3ee305(0x16d)]({}),_0x8742cc=await warehouse['aggregate']([{'$match':{'name':_0x2f72be['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3ee305(0x169),'name':{'$first':_0x3ee305(0xd4)},'product_stock':{'$first':_0x3ee305(0x165)},'bay':{'$first':_0x3ee305(0x109)},'bin':{'$first':_0x3ee305(0x11a)},'type':{'$first':_0x3ee305(0xf0)},'floorlevel':{'$first':_0x3ee305(0x103)},'primary_code':{'$first':_0x3ee305(0xfe)},'secondary_code':{'$first':_0x3ee305(0x12d)},'product_code':{'$first':_0x3ee305(0x119)},'storage':{'$first':_0x3ee305(0xd9)},'rack':{'$first':_0x3ee305(0x17d)},'maxPerUnit':{'$first':_0x3ee305(0x107)},'expiry_date':{'$first':_0x3ee305(0xbe)},'production_date':{'$first':_0x3ee305(0x101)},'batch_code':{'$first':_0x3ee305(0xfa)},'room':{'$first':_0x3ee305(0x15e)}}}]);let _0x2e2849;if(_0x48c5d1['role']==_0x3ee305(0x16b)){const _0x40016a=await staff[_0x3ee305(0x12c)]({'email':_0x48c5d1[_0x3ee305(0xf3)]});_0x2e2849=await warehouse[_0x3ee305(0xeb)]([{'$match':{'status':_0x3ee305(0xf9),'name':_0x40016a[_0x3ee305(0x147)],'warehouse_category':_0x3ee305(0xc1),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3ee305(0x11c),'name':{'$first':_0x3ee305(0x11c)}}}]);}else _0x2e2849=await warehouse[_0x3ee305(0xeb)]([{'$match':{'status':_0x3ee305(0xf9),'warehouse_category':_0x3ee305(0xc1),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x3ee305(0x11c)}}}]);if(_0x24bf4b[0x0]['language']=='English\x20(US)'){var _0x5a81a7=users[_0x3ee305(0xee)];console[_0x3ee305(0xe3)](_0x5a81a7);}else{if(_0x24bf4b[0x0]['language']==_0x3ee305(0x135))var _0x5a81a7=users[_0x3ee305(0x135)];else{if(_0x24bf4b[0x0][_0x3ee305(0x122)]=='German')var _0x5a81a7=users[_0x3ee305(0x12f)];else{if(_0x24bf4b[0x0][_0x3ee305(0x122)]==_0x3ee305(0x121))var _0x5a81a7=users[_0x3ee305(0x121)];else{if(_0x24bf4b[0x0]['language']==_0x3ee305(0x128))var _0x5a81a7=users[_0x3ee305(0x128)];else{if(_0x24bf4b[0x0][_0x3ee305(0x122)]==_0x3ee305(0xca))var _0x5a81a7=users[_0x3ee305(0x14f)];else{if(_0x24bf4b[0x0]['language']==_0x3ee305(0xf4))var _0x5a81a7=users[_0x3ee305(0xf4)];else{if(_0x24bf4b[0x0]['language']=='Arabic\x20(ae)')var _0x5a81a7=users[_0x3ee305(0xd5)];}}}}}}}_0x19d1a8[_0x3ee305(0xcd)](_0x3ee305(0xed),{'success':_0x38da40['flash'](_0x3ee305(0xc5)),'errors':_0x38da40[_0x3ee305(0x151)](_0x3ee305(0x162)),'role':_0x48c5d1,'profile':_0x57d4dd,'adjustment':_0x2f72be,'stock':_0x8742cc,'master_shop':_0x24bf4b,'warehouse_name':_0x1c652d,'unit':_0x2080bc,'language':_0x5a81a7,'warehouse':_0x2e2849});}catch(_0x4a31d4){console[_0x3ee305(0xe3)](_0x4a31d4),_0x19d1a8[_0x3ee305(0x17b)](0xc8)[_0x3ee305(0x154)]({'message':_0x4a31d4[_0x3ee305(0xd3)]});}}),router[a0_0x1df23d(0xe9)]('/view/:id',auth,async(_0x1fb80e,_0x3af898)=>{var _0x40d86b=a0_0x1df23d;try{const _0x5bb28=_0x1fb80e[_0x40d86b(0xff)]['id'],_0x1ae308=await adjustment[_0x40d86b(0xd2)]({'_id':_0x5bb28}),_0x3656dd=await warehouse[_0x40d86b(0x12c)]({'name':_0x1ae308[_0x40d86b(0x18c)],'room':_0x1ae308[_0x40d86b(0xd0)]}),{warehouse_name:_0x53e427,date:_0xe43a1a,prod_name:_0x31df35,level:_0x420b9c,isle:_0x237c75,pallet:_0x548672,stock:_0x40b0e9,types:_0x2eefba,adjust_qty:_0x4bea57,new_adjust_qty:_0xd7b460,note:_0x26a762,Room_name:_0x4021dc,invoice:_0xd6e03f,JO_number:_0x442392,expiry_date:_0x382765}=_0x1fb80e[_0x40d86b(0x18a)];if(typeof _0x31df35==_0x40d86b(0x180))var _0x5429c5=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0xfc)]],_0x6a6036=[_0x1fb80e[_0x40d86b(0x18a)]['level']],_0xb60961=[_0x1fb80e[_0x40d86b(0x18a)]['stock']],_0x2fb565=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x120)]],_0x17048d=[_0x1fb80e[_0x40d86b(0x18a)]['New_Qty_Converted_adj']],_0x59a48f=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0xf2)]],_0x556ce1=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x106)]],_0x240e4d=[_0x1fb80e[_0x40d86b(0x18a)]['Secondary_units']],_0x1686ff=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0xc8)]],_0xbec35f=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x18f)]],_0x3ba112=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x16e)]],_0x411af0=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x13a)]],_0x4877a6=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0xc9)]],_0x4931e2=[_0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x130)]],_0x11bf0c=[_0x1fb80e['body'][_0x40d86b(0x171)]],_0xfbcb2c=[_0x1fb80e[_0x40d86b(0x18a)]['prime1']],_0x259451=[_0x1fb80e['body']['second1']];else var _0x5429c5=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0xfc)]],_0x6a6036=[..._0x1fb80e['body'][_0x40d86b(0x13b)]],_0xb60961=[..._0x1fb80e['body'][_0x40d86b(0x161)]],_0x2fb565=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x120)]],_0x17048d=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x18e)]],_0x59a48f=[..._0x1fb80e['body']['New_Qty_Converted']],_0x556ce1=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x145)]],_0x240e4d=[..._0x1fb80e[_0x40d86b(0x18a)]['Secondary_units']],_0x1686ff=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0xc8)]],_0xbec35f=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x18f)]],_0x3ba112=[..._0x1fb80e['body']['expiry_date']],_0x411af0=[..._0x1fb80e[_0x40d86b(0x18a)]['max_per_unit']],_0x4877a6=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0xc9)]],_0x4931e2=[..._0x1fb80e['body'][_0x40d86b(0x130)]],_0x11bf0c=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x171)]],_0xfbcb2c=[..._0x1fb80e[_0x40d86b(0x18a)][_0x40d86b(0x10a)]],_0x259451=[..._0x1fb80e[_0x40d86b(0x18a)]['second1']];const _0x52c87a=_0x5429c5[_0x40d86b(0x15c)](_0x4d11a6=>{return _0x4d11a6={'product_name':_0x4d11a6};});_0x6a6036[_0x40d86b(0x13d)]((_0x3c3127,_0x1d5a99)=>{var _0xc1e2eb=_0x40d86b;_0x11bf0c[_0xc1e2eb(0x13d)]((_0x741de,_0x1933e7)=>{var _0x3d3d4b=_0xc1e2eb;if(_0x741de==_0x3d3d4b(0x12b)&&_0x1d5a99==_0x1933e7){var _0xc18d6e=_0x3c3127['slice'](0x3);_0x52c87a[_0x1d5a99][_0x3d3d4b(0x10f)]=_0x3c3127[0x0],_0x52c87a[_0x1d5a99][_0x3d3d4b(0x188)]=_0x3c3127[0x1],_0x52c87a[_0x1d5a99][_0x3d3d4b(0x17c)]=0x0,_0x52c87a[_0x1d5a99][_0x3d3d4b(0x11f)]=0x0,_0x52c87a[_0x1d5a99][_0x3d3d4b(0x149)]='Floor',_0x52c87a[_0x1d5a99][_0x3d3d4b(0xcf)]=_0xc18d6e;}else{if(_0x741de==_0x3d3d4b(0xdf)&&_0x1d5a99==_0x1933e7){var _0xc18d6e=_0x3c3127['slice'](0x3);_0x52c87a[_0x1d5a99][_0x3d3d4b(0x10f)]=_0x3c3127[0x0],_0x52c87a[_0x1d5a99][_0x3d3d4b(0x188)]=_0x3c3127[0x1],_0x52c87a[_0x1d5a99]['bay']=0x0,_0x52c87a[_0x1d5a99][_0x3d3d4b(0x11f)]=0x0,_0x52c87a[_0x1d5a99][_0x3d3d4b(0x149)]=_0x3d3d4b(0xd8),_0x52c87a[_0x1d5a99][_0x3d3d4b(0xcf)]=_0x3c3127[0x5];}else{if(_0x1d5a99==_0x1933e7){var _0x115d2d;if(_0x3c3127[0x4]=='L')_0x115d2d=_0x3d3d4b(0x10c);else _0x3c3127[0x4]=='F'&&(_0x115d2d=_0x3d3d4b(0xd8));_0x52c87a[_0x1d5a99][_0x3d3d4b(0x10f)]=_0x3c3127[0x0],_0x52c87a[_0x1d5a99][_0x3d3d4b(0x188)]=_0x3c3127[0x1],_0x52c87a[_0x1d5a99][_0x3d3d4b(0x17c)]=_0x3c3127[0x2],_0x52c87a[_0x1d5a99][_0x3d3d4b(0x11f)]=_0x3c3127[0x3],_0x52c87a[_0x1d5a99][_0x3d3d4b(0x149)]=_0x115d2d,_0x52c87a[_0x1d5a99][_0x3d3d4b(0xcf)]=_0x3c3127[0x5];}}}});}),_0xb60961[_0x40d86b(0x13d)]((_0x19de62,_0x2d75ad)=>{var _0x1a5df6=_0x40d86b;_0x52c87a[_0x2d75ad][_0x1a5df6(0xe7)]=_0x19de62;}),_0x2fb565[_0x40d86b(0x13d)]((_0x30e380,_0x277f55)=>{var _0xfc7f5e=_0x40d86b;_0x52c87a[_0x277f55][_0xfc7f5e(0x120)]=_0x30e380;}),_0x17048d['forEach']((_0x15b396,_0x2cc503)=>{var _0x4b6420=_0x40d86b;_0x52c87a[_0x2cc503][_0x4b6420(0x168)]=_0x15b396;}),_0x59a48f[_0x40d86b(0x13d)]((_0x4d3afa,_0x543cc4)=>{var _0x4e85d9=_0x40d86b;_0x52c87a[_0x543cc4][_0x4e85d9(0xf5)]=_0x4d3afa;}),_0x556ce1[_0x40d86b(0x13d)]((_0x4919ad,_0x33b903)=>{var _0x5d9b5f=_0x40d86b;_0x52c87a[_0x33b903][_0x5d9b5f(0x145)]=_0x4919ad;}),_0x240e4d[_0x40d86b(0x13d)]((_0x4f3e61,_0x2f2a18)=>{var _0x256c14=_0x40d86b;_0x52c87a[_0x2f2a18][_0x256c14(0xdc)]=_0x4f3e61;}),_0x1686ff['forEach']((_0x242873,_0x571789)=>{var _0x55c989=_0x40d86b;_0x52c87a[_0x571789][_0x55c989(0x150)]=_0x242873;}),_0xbec35f[_0x40d86b(0x13d)]((_0x475e5b,_0x84c928)=>{var _0xdc095d=_0x40d86b;_0x52c87a[_0x84c928][_0xdc095d(0x18f)]=_0x475e5b;}),_0x3ba112[_0x40d86b(0x13d)]((_0x4f1167,_0x2ce83c)=>{var _0x297f83=_0x40d86b;_0x52c87a[_0x2ce83c][_0x297f83(0x16e)]=_0x4f1167;}),_0x411af0[_0x40d86b(0x13d)]((_0xcbbeab,_0x1a97de)=>{_0x52c87a[_0x1a97de]['maxperunit']=_0xcbbeab;}),_0x4877a6[_0x40d86b(0x13d)]((_0x4a383d,_0x44ef0c)=>{var _0x2e97ef=_0x40d86b;_0x52c87a[_0x44ef0c][_0x2e97ef(0xc9)]=_0x4a383d;}),_0x4931e2[_0x40d86b(0x13d)]((_0x141061,_0x24b51d)=>{var _0x232abf=_0x40d86b;_0x52c87a[_0x24b51d][_0x232abf(0x130)]=_0x141061;}),_0x11bf0c[_0x40d86b(0x13d)]((_0x4fa8f4,_0x100856)=>{_0x52c87a[_0x100856]['room_names']=_0x4fa8f4;}),_0xfbcb2c[_0x40d86b(0x13d)]((_0x543531,_0x5eece4)=>{_0x52c87a[_0x5eece4]['primary_code']=_0x543531;}),_0x259451[_0x40d86b(0x13d)]((_0x20c674,_0x3f7bf5)=>{var _0x54aa38=_0x40d86b;_0x52c87a[_0x3f7bf5][_0x54aa38(0x177)]=_0x20c674;});const _0x4fad1e=_0x52c87a[_0x40d86b(0xdd)](_0x1ef7db=>_0x1ef7db[_0x40d86b(0x168)]!=='0'&&_0x1ef7db[_0x40d86b(0x168)]!=='');var _0x41aea2=0x0;_0x4fad1e[_0x40d86b(0x13d)](_0x2f689b=>{var _0x4f40de=_0x40d86b;console[_0x4f40de(0xe3)](_0x4f40de(0x158),_0x2f689b),parseInt(_0x2f689b[_0x4f40de(0x168)])<=0x0&&_0x41aea2++;});if(_0x41aea2!=0x0)return _0x1fb80e[_0x40d86b(0x151)](_0x40d86b(0x162),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x3af898[_0x40d86b(0x13f)](_0x40d86b(0x174));_0x1ae308[_0x40d86b(0x18c)]=_0x53e427,_0x1ae308['date']=_0xe43a1a,_0x1ae308[_0x40d86b(0x131)]=_0x4fad1e,_0x1ae308['note']=_0x26a762,_0x1ae308['invoice']=_0xd6e03f,_0x1ae308[_0x40d86b(0x18b)]=_0x40d86b(0x16a);const _0x7adc42=await _0x1ae308[_0x40d86b(0xc6)]();_0x1fb80e[_0x40d86b(0x151)](_0x40d86b(0xc5),_0x40d86b(0x123)),_0x3af898[_0x40d86b(0x13f)](_0x40d86b(0x190));}catch(_0x1346ad){console[_0x40d86b(0xe3)](_0x1346ad);}}),router['post'](a0_0x1df23d(0x104),async(_0x4facc8,_0x2e305)=>{var _0x58ed7f=a0_0x1df23d;const {primary_code:_0x38f7b7,warehouse_data:_0x442b7c,rooms_data:_0x2a4ef1,Roomslist:_0x5e8d25}=_0x4facc8['body'],_0x8dde6d=_0x5e8d25[_0x58ed7f(0x15b)](','),_0x1b5b88=[];async function _0xe318b(_0x693634){var _0x13b08b=_0x58ed7f;const _0x302d03=await warehouse[_0x13b08b(0xeb)]([{'$match':{'name':_0x442b7c,'room':_0x693634}},{'$unwind':_0x13b08b(0xd7)},{'$match':{'product_details.primary_code':_0x38f7b7}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x13b08b(0x165)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x13b08b(0x12d)},'product_code':{'$first':_0x13b08b(0x119)},'level':{'$first':_0x13b08b(0x109)},'isle':{'$first':_0x13b08b(0x11a)},'type':{'$first':_0x13b08b(0xf0)},'pallet':{'$first':_0x13b08b(0x103)},'unit':{'$first':_0x13b08b(0xe0)},'secondary_unit':{'$first':_0x13b08b(0x114)},'storage':{'$first':_0x13b08b(0xd9)},'rack':{'$first':_0x13b08b(0x17d)},'expiry_date':{'$first':_0x13b08b(0xbe)},'production_date':{'$first':_0x13b08b(0x101)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x13b08b(0xfa)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x13b08b(0x15e)}}}]),_0x593fad=await warehouse[_0x13b08b(0xeb)]([{'$match':{'name':_0x442b7c,'room':_0x693634}},{'$unwind':_0x13b08b(0xd7)},{'$match':{'product_details.secondary_code':_0x38f7b7}},{'$group':{'_id':_0x13b08b(0x169),'name':{'$first':_0x13b08b(0xd4)},'product_stock':{'$first':_0x13b08b(0x165)},'primary_code':{'$first':_0x13b08b(0xfe)},'secondary_code':{'$first':_0x13b08b(0x12d)},'product_code':{'$first':_0x13b08b(0x119)},'level':{'$first':_0x13b08b(0x109)},'isle':{'$first':_0x13b08b(0x11a)},'type':{'$first':_0x13b08b(0xf0)},'pallet':{'$first':_0x13b08b(0x103)},'unit':{'$first':_0x13b08b(0xe0)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x13b08b(0x17d)},'expiry_date':{'$first':_0x13b08b(0xbe)},'production_date':{'$first':_0x13b08b(0x101)},'maxPerUnit':{'$first':_0x13b08b(0x107)},'batch_code':{'$first':_0x13b08b(0xfa)},'product_cat':{'$first':_0x13b08b(0x112)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x13b08b(0x15e)}}}]);if(_0x302d03['length']>0x0)_0x1b5b88[_0x13b08b(0xfb)](_0x302d03);else _0x593fad[_0x13b08b(0xbf)]>0x0&&_0x1b5b88[_0x13b08b(0xfb)](_0x593fad);}const _0x13c82a=_0x8dde6d[_0x58ed7f(0x15c)](_0x3c09ff=>_0xe318b(_0x3c09ff));await Promise[_0x58ed7f(0x178)](_0x13c82a),_0x2e305[_0x58ed7f(0x154)](_0x1b5b88);}),router[a0_0x1df23d(0xe9)](a0_0x1df23d(0x11e),async(_0x55970d,_0x502770)=>{var _0x3b2a74=a0_0x1df23d;const {primaryCode:_0x5c31cb,secondaryCode:_0x34fe89,productCode:_0x22f525,level:_0x107cde,isle:_0x4b61b7,pallet:_0xc5eebf,warehouses:_0x3275ef,room:_0x3546be}=_0x55970d[_0x3b2a74(0x18a)];try{const _0x4a19d2=await warehouse[_0x3b2a74(0xeb)]([{'$match':{'name':_0x3275ef,'room':_0x3546be}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x107cde),'product_details.isle':_0x4b61b7,'product_details.pallet':parseInt(_0xc5eebf)}},{'$group':{'_id':_0x3b2a74(0x169),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3b2a74(0x165)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x3b2a74(0xfd)},'maxProducts':{'$first':_0x3b2a74(0xbd)}}}]);_0x502770['status'](0xc8)['json'](_0x4a19d2);}catch(_0x14606b){_0x502770[_0x3b2a74(0x17b)](0x194)[_0x3b2a74(0x154)]({'message':_0x14606b[_0x3b2a74(0xd3)]});}}),module['exports']=router;