function a0_0x460f(_0x2311f2,_0x37b9f4){var _0x28b8b4=a0_0x28b8();return a0_0x460f=function(_0x460f02,_0x1e7e14){_0x460f02=_0x460f02-0xfb;var _0x3aa7b3=_0x28b8b4[_0x460f02];return _0x3aa7b3;},a0_0x460f(_0x2311f2,_0x37b9f4);}var a0_0x30b406=a0_0x460f;(function(_0x458d3f,_0x1b8fba){var _0x2c5703=a0_0x460f,_0x5eb855=_0x458d3f();while(!![]){try{var _0x2934d9=-parseInt(_0x2c5703(0x1ca))/0x1*(parseInt(_0x2c5703(0x10a))/0x2)+-parseInt(_0x2c5703(0x193))/0x3+parseInt(_0x2c5703(0x1cc))/0x4*(parseInt(_0x2c5703(0x178))/0x5)+parseInt(_0x2c5703(0x14d))/0x6*(parseInt(_0x2c5703(0x15c))/0x7)+parseInt(_0x2c5703(0x111))/0x8*(-parseInt(_0x2c5703(0x1cf))/0x9)+-parseInt(_0x2c5703(0x101))/0xa+parseInt(_0x2c5703(0x17f))/0xb*(parseInt(_0x2c5703(0x151))/0xc);if(_0x2934d9===_0x1b8fba)break;else _0x5eb855['push'](_0x5eb855['shift']());}catch(_0x20ee01){_0x5eb855['push'](_0x5eb855['shift']());}}}(a0_0x28b8,0xad404));const express=require(a0_0x30b406(0x13a)),app=express(),router=express[a0_0x30b406(0x183)](),auth=require(a0_0x30b406(0x15f)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x30b406(0x15e)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x30b406(0x194)](a0_0x30b406(0x124),auth,async(_0x1d793b,_0x3c339a)=>{var _0x1d29c4=a0_0x30b406;try{const {username:_0x1dae72,email:_0xb59e33,role:_0x4bfd97}=_0x1d793b[_0x1d29c4(0x199)],_0x16362e=_0x1d793b[_0x1d29c4(0x199)],_0x39deb4=await profile[_0x1d29c4(0x126)]({'email':_0x16362e['email']}),_0x20251a=await master_shop[_0x1d29c4(0x1cd)]();console[_0x1d29c4(0x132)](_0x1d29c4(0x180),_0x20251a);let _0x6b4fea;if(_0x16362e[_0x1d29c4(0x159)]==_0x1d29c4(0x147)){const _0x31a20f=await staff[_0x1d29c4(0x126)]({'email':_0x16362e[_0x1d29c4(0x148)]});_0x6b4fea=await warehouse[_0x1d29c4(0x1cd)]({'status':'Enabled','name':_0x31a20f[_0x1d29c4(0x16d)]});}else _0x6b4fea=await warehouse['find']({'status':_0x1d29c4(0x163)});const _0x6cae0=await product[_0x1d29c4(0x1cd)]();let _0x45a3a8;if(_0x16362e[_0x1d29c4(0x159)]==_0x1d29c4(0x147)){const _0x50d49e=await staff['findOne']({'email':_0x16362e[_0x1d29c4(0x148)]});_0x45a3a8=await adjustment[_0x1d29c4(0x1cd)]({'warehouse_name':_0x50d49e[_0x1d29c4(0x16d)]});}else _0x45a3a8=await adjustment[_0x1d29c4(0x18b)]([{'$unwind':'$product'},{'$group':{'_id':_0x1d29c4(0x197),'invoice':{'$first':_0x1d29c4(0x16f)},'date':{'$first':_0x1d29c4(0x12f)},'warehouse_name':{'$first':_0x1d29c4(0xfc)},'room':{'$addToSet':_0x1d29c4(0x1ba)},'finalize':{'$first':_0x1d29c4(0x17c)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x20251a[0x0][_0x1d29c4(0x154)]==_0x1d29c4(0x184)){var _0x18843b=users[_0x1d29c4(0x1aa)];console['log'](_0x18843b);}else{if(_0x20251a[0x0]['language']==_0x1d29c4(0x1cb))var _0x18843b=users['Hindi'];else{if(_0x20251a[0x0]['language']==_0x1d29c4(0x1ad))var _0x18843b=users[_0x1d29c4(0x1ad)];else{if(_0x20251a[0x0]['language']==_0x1d29c4(0x1c0))var _0x18843b=users['Spanish'];else{if(_0x20251a[0x0][_0x1d29c4(0x154)]==_0x1d29c4(0x17d))var _0x18843b=users['French'];else{if(_0x20251a[0x0][_0x1d29c4(0x154)]=='Portuguese\x20(BR)')var _0x18843b=users['Portuguese'];else{if(_0x20251a[0x0][_0x1d29c4(0x154)]==_0x1d29c4(0x192))var _0x18843b=users[_0x1d29c4(0x192)];else{if(_0x20251a[0x0][_0x1d29c4(0x154)]==_0x1d29c4(0x104))var _0x18843b=users['Arabic'];}}}}}}}_0x3c339a[_0x1d29c4(0x1c3)](_0x1d29c4(0x12d),{'success':_0x1d793b[_0x1d29c4(0x122)](_0x1d29c4(0x11d)),'errors':_0x1d793b[_0x1d29c4(0x122)](_0x1d29c4(0x15b)),'role':_0x16362e,'profile':_0x39deb4,'warehouse':_0x6b4fea,'product':_0x6cae0,'adjustment':_0x45a3a8,'master_shop':_0x20251a,'language':_0x18843b});}catch(_0x2b5fe1){console['log'](_0x2b5fe1);}});function a0_0x28b8(){var _0x1bae3f=['room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','</td>','<tbody\x20style=\x22text-align:\x20center;\x22>','staff','email','</tr>','$product_details.rack','prod_code','$product_details.product_cat','676308APKAcQ','adjustment\x20Finalized\x20successfully','</table>','prime1','14441928WUzvll','product_stock','split','language','error','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','then','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','role','message','errors','7OLSssY','body','../models/all_models','../middleware/auth','sendMail','json','prod_invoice','Enabled','<hr\x20class=\x22my-3\x22>','second1','/../public','add_adjustment','post','level','adjustment\x20add\x20successfull','rack','Level','warehouse','bin','$invoice','id_transaction','id_transaction_from','stockBefore','invoice','max_per_unit','<h2>\x20','Arabic','back','5Eemzlx','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Adjustment\x20Mail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$finalize','French','unit','33DWhAeO','master','New_Qty_Converted','<tr>','Router','English\x20(US)','</div>','padStart','production_date','</thead>','\x20Order\x20Number\x20:\x20','params','aggregate','logo','type','/adjustment/view','$product_details.maxPerUnit','stock','ADJ-','Chinese','2144544geugrW','get','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$_id','An\x20error\x20occurred\x20while\x20saving\x20data.','user','/view/:id','$product_details._id','<span\x20style=\x22float:\x20right;\x22>','$product_details','$product_details.product_name','adjust_qty','Primary_Units','warehouse_name','$product_details.secondary_code','floor','Secondary_units','push','/barcode_scanner','$product_details.production_date','$name','redirect','English','Portuguese','batch_code','German','Return\x20Rooms','False','product_details','maxperunit','</h5>','product','$product_details.isle','room_names','foreach\x20newproduct','Error\x20Occurs','$product_details.bay','filter','$product.room_names','bay','$product_details.batch_code','Logo.png','all','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Spanish','$product','</body></html>','render','save','string','Raw\x20Materials','catch','toString','prod_cat','104046zoHnqA','Hindi','2185916LwOgMD','find','$product_details.unit','9zdQSKX','An\x20error\x20occurred.','floorlevel','$product_details.product_code','$product_details.pallet','$warehouse_name','/CheckingWarehouse','site_title','$product_details.floorlevel','secondary_unit','5891320OBToYp','forEach','New_Qty_Converted_adj','Arabic\x20(ae)','new_adjust_qty','prod_name','Portuguese\x20(BR)','/adjustment/preview/','$room','22ilmHlV','$product_details.product_stock','primary_code','Rooms','secondary_code','/upload/','\x20</h2>','8892456QxtJWD','host','findById','$product_details.storage','$product_details.type','\x20Order\x20Date\x20:\x20','Shelves','$product_details.primary_code','<html><head><title></title>','finalize','types','note','success','date','Receiving\x20Area','length','$product_details.expiry_date','flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','/view','Floor','findOne','</span>','status','Enclosed','$product_details.bin','isAllowEdit','<strong>\x20Regards\x20</strong>','adjustment','map','$date','expiry_date','$product_details.secondary_unit','log','/preview/:id','$product.product_name','storage','</head><body>','slice','edit_adjustment_view','product_code','express','\x20<>\x20','product_name','<div>','Return\x20Goods','port','password','_id','edit_adjustment'];a0_0x28b8=function(){return _0x1bae3f;};return a0_0x28b8();}async function getRandom8DigitNumber(){var _0xbb0ed1=a0_0x30b406;const _0x29f343=0x989680,_0x239d36=0x5f5e0ff,_0x2da0b9=Math[_0xbb0ed1(0x1a3)](Math['random']()*(_0x239d36-_0x29f343+0x1))+_0x29f343;var _0x4954dd;const _0x42e5d8=await adjustment[_0xbb0ed1(0x126)]({'invoice':'ADJ-'+_0x2da0b9});return _0x42e5d8&&_0x42e5d8['length']>0x0?_0x4954dd=_0xbb0ed1(0x191)+_0x2da0b9:_0x4954dd=_0xbb0ed1(0x191)+_0x2da0b9,_0x4954dd;}router[a0_0x30b406(0x194)]('/view/add_adjustment',auth,async(_0x13109e,_0x3b1bd9)=>{var _0x3417c0=a0_0x30b406;try{const {username:_0x4a33a8,email:_0x5d9889,role:_0x410dae}=_0x13109e[_0x3417c0(0x199)],_0x347e99=_0x13109e[_0x3417c0(0x199)],_0x2a4acf=await profile[_0x3417c0(0x126)]({'email':_0x347e99[_0x3417c0(0x148)]}),_0x348ff6=await master_shop[_0x3417c0(0x1cd)]();let _0x368382;if(_0x347e99[_0x3417c0(0x159)]==_0x3417c0(0x147)){const _0x192d26=await staff[_0x3417c0(0x126)]({'email':_0x347e99[_0x3417c0(0x148)]});_0x368382=await warehouse[_0x3417c0(0x18b)]([{'$match':{'status':_0x3417c0(0x163),'name':_0x192d26[_0x3417c0(0x16d)],'warehouse_category':_0x3417c0(0x1c6),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3417c0(0x1a8),'name':{'$first':'$name'}}}]);}else _0x368382=await warehouse[_0x3417c0(0x18b)]([{'$match':{'status':_0x3417c0(0x163),'warehouse_category':_0x3417c0(0x1c6),'name':{'$ne':_0x3417c0(0x13e)}}},{'$group':{'_id':_0x3417c0(0x1a8),'name':{'$first':'$name'}}}]);const _0x44a032=await product[_0x3417c0(0x1cd)]({}),_0x5f10be=await adjustment['find']({}),_0x4f45b3=_0x5f10be[_0x3417c0(0x120)]+0x1,_0x16c502=_0x3417c0(0x191)+_0x4f45b3[_0x3417c0(0x1c8)]()[_0x3417c0(0x186)](0x5,'0');var _0x2b792e=['Ambient',_0x3417c0(0x129),_0x3417c0(0x1ae)];if(_0x348ff6[0x0]['language']==_0x3417c0(0x184))var _0x16d505=users[_0x3417c0(0x1aa)];else{if(_0x348ff6[0x0]['language']==_0x3417c0(0x1cb))var _0x16d505=users['Hindi'];else{if(_0x348ff6[0x0][_0x3417c0(0x154)]=='German')var _0x16d505=users[_0x3417c0(0x1ad)];else{if(_0x348ff6[0x0][_0x3417c0(0x154)]==_0x3417c0(0x1c0))var _0x16d505=users['Spanish'];else{if(_0x348ff6[0x0]['language']==_0x3417c0(0x17d))var _0x16d505=users[_0x3417c0(0x17d)];else{if(_0x348ff6[0x0][_0x3417c0(0x154)]==_0x3417c0(0x107))var _0x16d505=users[_0x3417c0(0x1ab)];else{if(_0x348ff6[0x0][_0x3417c0(0x154)]=='Chinese')var _0x16d505=users['Chinese'];else{if(_0x348ff6[0x0][_0x3417c0(0x154)]==_0x3417c0(0x104))var _0x16d505=users[_0x3417c0(0x176)];}}}}}}}const _0x2d0726=getRandom8DigitNumber();_0x2d0726[_0x3417c0(0x157)](_0x4f3977=>{var _0x5cdfd9=_0x3417c0;_0x3b1bd9[_0x5cdfd9(0x1c3)](_0x5cdfd9(0x167),{'success':_0x13109e[_0x5cdfd9(0x122)](_0x5cdfd9(0x11d)),'errors':_0x13109e['flash'](_0x5cdfd9(0x15b)),'role':_0x347e99,'profile':_0x2a4acf,'warehouse':_0x368382,'product':_0x44a032,'master_shop':_0x348ff6,'language':_0x16d505,'rooms_data':_0x2b792e,'invoice_no':_0x4f3977});})[_0x3417c0(0x1c7)](_0x3c4f8a=>{var _0x2b1059=_0x3417c0;_0x13109e[_0x2b1059(0x122)]('errors',_0x2b1059(0x196)),_0x3b1bd9[_0x2b1059(0x1a9)](_0x2b1059(0x18e));});}catch(_0x308bbc){console['log'](_0x308bbc);}}),router['post']('/view/add_adjustment',auth,async(_0x12b10c,_0x10df76)=>{var _0x5b127a=a0_0x30b406;try{const {warehouse_name:_0x1fc1a2,date:_0x332499,prod_name:_0x4e0cba,level:_0x294731,isle:_0x381d5b,pallet:_0x2ed3ba,stock:_0x7946f0,types:_0x49a1b9,adjust_qty:_0x3ea4fe,new_adjust_qty:_0x329518,note:_0xeb064f,Room_name:_0x2753cb,invoice:_0xf7f584,JO_number:_0x367224,expiry_date:_0x29de5f}=_0x12b10c['body'];if(typeof _0x4e0cba==_0x5b127a(0x1c5))var _0x41b002=[_0x12b10c['body'][_0x5b127a(0x106)]],_0x55db09=[_0x12b10c['body'][_0x5b127a(0x169)]],_0xaa3ab1=[_0x12b10c['body']['stock']],_0x182369=[_0x12b10c['body'][_0x5b127a(0x11b)]],_0x17bb56=[_0x12b10c['body'][_0x5b127a(0x103)]],_0x459f81=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x181)]],_0x4644e2=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x1a0)]],_0x54f1cd=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x1a4)]],_0x4ce86b=[_0x12b10c['body']['prod_code']],_0x1fbd01=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x1ac)]],_0x31f9c4=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x130)]],_0x557d8f=[_0x12b10c['body'][_0x5b127a(0x174)]],_0x5ecb71=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x187)]],_0x379503=[_0x12b10c['body'][_0x5b127a(0x1c9)]],_0x477853=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x10d)]],_0x120f2b=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x150)]],_0x3f62c7=[_0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x165)]],_0x5a845b=[_0x12b10c['body']['prod_invoice']],_0x6b57b8=[_0x12b10c['body'][_0x5b127a(0x170)]];else var _0x41b002=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x106)]],_0x55db09=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x169)]],_0xaa3ab1=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x190)]],_0x182369=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x11b)]],_0x17bb56=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x103)]],_0x459f81=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x181)]],_0x4644e2=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x17e)]],_0x54f1cd=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x1a4)]],_0x4ce86b=[..._0x12b10c['body']['prod_code']],_0x1fbd01=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x1ac)]],_0x31f9c4=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x130)]],_0x557d8f=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x174)]],_0x5ecb71=[..._0x12b10c['body'][_0x5b127a(0x187)]],_0x379503=[..._0x12b10c[_0x5b127a(0x15d)]['prod_cat']],_0x477853=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x10d)]],_0x120f2b=[..._0x12b10c[_0x5b127a(0x15d)][_0x5b127a(0x150)]],_0x3f62c7=[..._0x12b10c['body'][_0x5b127a(0x165)]],_0x5a845b=[..._0x12b10c['body'][_0x5b127a(0x162)]],_0x6b57b8=[..._0x12b10c['body'][_0x5b127a(0x170)]];const _0x71df2=_0x41b002[_0x5b127a(0x12e)](_0x53666c=>{return _0x53666c={'product_name':_0x53666c};});_0x55db09['forEach']((_0x2d9206,_0xf1c116)=>{_0x477853['forEach']((_0x18a69d,_0x5afc93)=>{var _0x12e473=a0_0x460f;if(_0x18a69d==_0x12e473(0x11f)&&_0xf1c116==_0x5afc93){var _0x452b56=_0x2d9206[_0x12e473(0x137)](0x3);_0x71df2[_0xf1c116][_0x12e473(0x135)]=_0x2d9206[0x0],_0x71df2[_0xf1c116][_0x12e473(0x16b)]=_0x2d9206[0x1],_0x71df2[_0xf1c116]['bay']=0x0,_0x71df2[_0xf1c116][_0x12e473(0x16e)]=0x0,_0x71df2[_0xf1c116][_0x12e473(0x18d)]=_0x12e473(0x125),_0x71df2[_0xf1c116][_0x12e473(0x1d1)]=_0x452b56;}else{if(_0x18a69d==_0x12e473(0x117)&&_0xf1c116==_0x5afc93){var _0x452b56=_0x2d9206['slice'](0x3);_0x71df2[_0xf1c116][_0x12e473(0x135)]=_0x2d9206[0x0],_0x71df2[_0xf1c116][_0x12e473(0x16b)]=_0x2d9206[0x1],_0x71df2[_0xf1c116][_0x12e473(0x1bb)]=0x0,_0x71df2[_0xf1c116][_0x12e473(0x16e)]=0x0,_0x71df2[_0xf1c116]['type']=_0x12e473(0x125),_0x71df2[_0xf1c116][_0x12e473(0x1d1)]=_0x2d9206[0x5];}else{if(_0xf1c116==_0x5afc93){var _0x5a15d2;if(_0x2d9206[0x4]=='L')_0x5a15d2=_0x12e473(0x16c);else _0x2d9206[0x4]=='F'&&(_0x5a15d2=_0x12e473(0x125));_0x71df2[_0xf1c116]['storage']=_0x2d9206[0x0],_0x71df2[_0xf1c116][_0x12e473(0x16b)]=_0x2d9206[0x1],_0x71df2[_0xf1c116][_0x12e473(0x1bb)]=_0x2d9206[0x2],_0x71df2[_0xf1c116][_0x12e473(0x16e)]=_0x2d9206[0x3],_0x71df2[_0xf1c116][_0x12e473(0x18d)]=_0x5a15d2,_0x71df2[_0xf1c116][_0x12e473(0x1d1)]=_0x2d9206[0x5];}}}});}),_0xaa3ab1['forEach']((_0x151f58,_0x582120)=>{var _0x3d6422=_0x5b127a;_0x71df2[_0x582120][_0x3d6422(0x172)]=_0x151f58;}),_0x6b57b8[_0x5b127a(0x102)]((_0x299649,_0xeb87d7)=>{_0x71df2[_0xeb87d7]['id_transaction_from']=_0x299649;}),_0x182369[_0x5b127a(0x102)]((_0x3a86f7,_0x3177d9)=>{var _0x421bb5=_0x5b127a;_0x71df2[_0x3177d9][_0x421bb5(0x11b)]=_0x3a86f7;}),_0x17bb56[_0x5b127a(0x102)]((_0x2c0623,_0x113d0b)=>{var _0x578a95=_0x5b127a;_0x71df2[_0x113d0b][_0x578a95(0x19f)]=_0x2c0623;}),_0x459f81['forEach']((_0x56e2ca,_0x1ef123)=>{var _0x2a227e=_0x5b127a;_0x71df2[_0x1ef123][_0x2a227e(0x105)]=_0x56e2ca;}),_0x4644e2['forEach']((_0x441fbc,_0x5cdafc)=>{var _0x403b51=_0x5b127a;_0x71df2[_0x5cdafc][_0x403b51(0x17e)]=_0x441fbc;}),_0x54f1cd['forEach']((_0x134f9a,_0x415c47)=>{var _0x4a5e29=_0x5b127a;_0x71df2[_0x415c47][_0x4a5e29(0x100)]=_0x134f9a;}),_0x4ce86b[_0x5b127a(0x102)]((_0x30c581,_0x15d505)=>{_0x71df2[_0x15d505]['product_code']=_0x30c581;}),_0x1fbd01[_0x5b127a(0x102)]((_0x2a6110,_0x810d71)=>{var _0x2a5e08=_0x5b127a;_0x71df2[_0x810d71][_0x2a5e08(0x1ac)]=_0x2a6110;}),_0x31f9c4['forEach']((_0x8291a6,_0x1aab8a)=>{var _0x43c4fc=_0x5b127a;_0x71df2[_0x1aab8a][_0x43c4fc(0x130)]=_0x8291a6;}),_0x557d8f[_0x5b127a(0x102)]((_0x39d2a7,_0x377927)=>{var _0x2c2a70=_0x5b127a;_0x71df2[_0x377927][_0x2c2a70(0x1b1)]=_0x39d2a7;}),_0x5ecb71[_0x5b127a(0x102)]((_0x27da28,_0x68f282)=>{var _0x1535a6=_0x5b127a;_0x71df2[_0x68f282][_0x1535a6(0x187)]=_0x27da28;}),_0x379503[_0x5b127a(0x102)]((_0x35a391,_0x4e0857)=>{_0x71df2[_0x4e0857]['prod_cat']=_0x35a391;}),_0x477853[_0x5b127a(0x102)]((_0x35ac11,_0x57aa22)=>{var _0x3d657b=_0x5b127a;_0x71df2[_0x57aa22][_0x3d657b(0x1b5)]=_0x35ac11;}),_0x120f2b[_0x5b127a(0x102)]((_0x20662f,_0x214930)=>{var _0x542c6c=_0x5b127a;_0x71df2[_0x214930][_0x542c6c(0x10c)]=_0x20662f;}),_0x3f62c7[_0x5b127a(0x102)]((_0x57a93a,_0x5cb2e6)=>{var _0x31ce6d=_0x5b127a;_0x71df2[_0x5cb2e6][_0x31ce6d(0x10e)]=_0x57a93a;}),_0x5a845b[_0x5b127a(0x102)]((_0x9ced01,_0x4f9b6a)=>{var _0x482ed6=_0x5b127a;_0x71df2[_0x4f9b6a][_0x482ed6(0x173)]=_0x9ced01;});const _0x565744=_0x71df2[_0x5b127a(0x1b9)](_0x453d7f=>_0x453d7f['adjust_qty']!=='0'&&_0x453d7f[_0x5b127a(0x19f)]!=='');var _0x2e1a1e=0x0;_0x565744[_0x5b127a(0x102)](_0x590248=>{var _0x1fcef5=_0x5b127a;console[_0x1fcef5(0x132)](_0x1fcef5(0x1b6),_0x590248),parseInt(_0x590248['adjust_qty'])<=0x0&&_0x2e1a1e++;});if(_0x2e1a1e!=0x0)return _0x12b10c[_0x5b127a(0x122)](_0x5b127a(0x15b),_0x5b127a(0x156)),_0x10df76[_0x5b127a(0x1a9)](_0x5b127a(0x177));const _0x54dea1=new adjustment({'warehouse_name':_0x1fc1a2,'date':_0x332499,'product':_0x565744,'note':_0xeb064f,'room':_0x2753cb,'invoice':_0xf7f584,'JO_number':_0x367224,'expiry_date':_0x29de5f}),_0x468957=await _0x54dea1[_0x5b127a(0x1c4)]();_0x12b10c['flash'](_0x5b127a(0x11d),_0x5b127a(0x16a)),_0x10df76[_0x5b127a(0x1a9)](_0x5b127a(0x108)+_0x468957[_0x5b127a(0x141)]);}catch(_0x32b5ca){console[_0x5b127a(0x132)](_0x32b5ca),_0x10df76[_0x5b127a(0x128)](0xc8)[_0x5b127a(0x161)]({'message':_0x32b5ca[_0x5b127a(0x15a)]});}}),router['get'](a0_0x30b406(0x133),auth,async(_0x3b999a,_0x2b90f7)=>{var _0x1d5d1c=a0_0x30b406;try{const {username:_0x3cf232,email:_0x2d178c,role:_0x970c08}=_0x3b999a['user'],_0x37992b=_0x3b999a['user'],_0x2f7ea0=await profile[_0x1d5d1c(0x126)]({'email':_0x37992b[_0x1d5d1c(0x148)]}),_0x17d160=await master_shop[_0x1d5d1c(0x1cd)](),_0x1941d9=_0x3b999a[_0x1d5d1c(0x18a)]['id'],_0x7ece1=await adjustment[_0x1d5d1c(0x113)]({'_id':_0x1941d9}),_0x124b58=await purchases['aggregate']([{'$match':{'warehouse_name':_0x7ece1['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x1a94f1=await product[_0x1d5d1c(0x1cd)]({}),_0x44ad2d=await warehouse['aggregate']([{'$match':{'name':_0x7ece1[_0x1d5d1c(0x1a1)]}},{'$unwind':_0x1d5d1c(0x19d)},{'$group':{'_id':_0x1d5d1c(0x19b),'name':{'$first':_0x1d5d1c(0x19e)},'product_stock':{'$first':_0x1d5d1c(0x10b)},'bay':{'$first':_0x1d5d1c(0x1b8)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1d5d1c(0x115)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1d5d1c(0x118)},'secondary_code':{'$first':_0x1d5d1c(0x1a2)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x1d5d1c(0x114)},'rack':{'$first':_0x1d5d1c(0x14a)},'maxPerUnit':{'$first':_0x1d5d1c(0x18f)},'expiry_date':{'$first':_0x1d5d1c(0x121)},'production_date':{'$first':_0x1d5d1c(0x1a7)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x1d5d1c(0x109)}}}]);if(_0x17d160[0x0][_0x1d5d1c(0x154)]==_0x1d5d1c(0x184)){var _0x50d869=users[_0x1d5d1c(0x1aa)];console[_0x1d5d1c(0x132)](_0x50d869);}else{if(_0x17d160[0x0][_0x1d5d1c(0x154)]==_0x1d5d1c(0x1cb))var _0x50d869=users[_0x1d5d1c(0x1cb)];else{if(_0x17d160[0x0][_0x1d5d1c(0x154)]=='German')var _0x50d869=users['German'];else{if(_0x17d160[0x0][_0x1d5d1c(0x154)]==_0x1d5d1c(0x1c0))var _0x50d869=users[_0x1d5d1c(0x1c0)];else{if(_0x17d160[0x0][_0x1d5d1c(0x154)]==_0x1d5d1c(0x17d))var _0x50d869=users['French'];else{if(_0x17d160[0x0][_0x1d5d1c(0x154)]==_0x1d5d1c(0x107))var _0x50d869=users[_0x1d5d1c(0x1ab)];else{if(_0x17d160[0x0][_0x1d5d1c(0x154)]==_0x1d5d1c(0x192))var _0x50d869=users['Chinese'];else{if(_0x17d160[0x0][_0x1d5d1c(0x154)]==_0x1d5d1c(0x104))var _0x50d869=users[_0x1d5d1c(0x176)];}}}}}}}_0x2b90f7[_0x1d5d1c(0x1c3)](_0x1d5d1c(0x138),{'success':_0x3b999a[_0x1d5d1c(0x122)](_0x1d5d1c(0x11d)),'errors':_0x3b999a['flash']('errors'),'role':_0x37992b,'profile':_0x2f7ea0,'adjustment':_0x7ece1,'stock':_0x44ad2d,'master_shop':_0x17d160,'warehouse_name':_0x124b58,'unit':_0x1a94f1,'language':_0x50d869});}catch(_0x16549d){console[_0x1d5d1c(0x132)](_0x16549d),_0x2b90f7[_0x1d5d1c(0x128)](0xc8)['json']({'message':_0x16549d['message']});}}),router['post'](a0_0x30b406(0x133),auth,async(_0x33cc61,_0x5649d9)=>{var _0x4c1924=a0_0x30b406;try{const _0x3fd19d=_0x33cc61[_0x4c1924(0x18a)]['id'],{warehouse_name:_0x487001,Room_name:_0x546671}=_0x33cc61['body'],_0x361f31=await adjustment[_0x4c1924(0x113)]({'_id':_0x3fd19d}),_0x288180=_0x361f31[_0x4c1924(0x1b3)][_0x4c1924(0x12e)](async _0x46c7fc=>{var _0x43d947=_0x4c1924;if(_0x46c7fc[_0x43d947(0x19f)]>0x0){var _0x46493b=await warehouse[_0x43d947(0x126)]({'name':_0x487001,'room':_0x46c7fc[_0x43d947(0x1b5)],'warehouse_category':'Raw\x20Materials'});const _0x46d182=_0x46493b[_0x43d947(0x1b0)][_0x43d947(0x12e)](_0x1b291e=>{var _0x4125cc=_0x43d947;console[_0x4125cc(0x132)](_0x46c7fc[_0x4125cc(0x11b)]+_0x4125cc(0x13b));if(_0x46c7fc[_0x4125cc(0x11b)]=='minus'){if(_0x1b291e[_0x4125cc(0x13c)]==_0x46c7fc[_0x4125cc(0x13c)]&&_0x1b291e[_0x4125cc(0x1d1)]==_0x46c7fc[_0x4125cc(0x1d1)]&&_0x1b291e[_0x4125cc(0x18d)]==_0x46c7fc[_0x4125cc(0x18d)]&&_0x1b291e[_0x4125cc(0x16e)]==_0x46c7fc['bin']&&_0x1b291e[_0x4125cc(0x1bb)]==_0x46c7fc[_0x4125cc(0x1bb)]&&_0x1b291e[_0x4125cc(0x16b)]==_0x46c7fc[_0x4125cc(0x16b)]&&_0x1b291e[_0x4125cc(0x135)]==_0x46c7fc[_0x4125cc(0x135)]&&_0x1b291e[_0x4125cc(0x130)]==_0x46c7fc[_0x4125cc(0x130)]&&_0x1b291e[_0x4125cc(0x1ac)]==_0x46c7fc['batch_code']&&_0x1b291e['production_date']==_0x46c7fc[_0x4125cc(0x187)]&&_0x1b291e[_0x4125cc(0x173)]==_0x46c7fc[_0x4125cc(0x173)]&&_0x1b291e[_0x4125cc(0x141)]==_0x46c7fc[_0x4125cc(0x171)]){var _0x563830;_0x563830=_0x46c7fc[_0x4125cc(0x19f)],_0x46c7fc['prod_cat']=='S'&&(_0x563830=_0x46c7fc[_0x4125cc(0x19f)]),_0x1b291e[_0x4125cc(0x152)]=_0x1b291e['product_stock']-_0x563830;}}else{if(_0x1b291e['product_name']==_0x46c7fc[_0x4125cc(0x13c)]&&_0x1b291e[_0x4125cc(0x1d1)]==_0x46c7fc[_0x4125cc(0x1d1)]&&_0x1b291e[_0x4125cc(0x18d)]==_0x46c7fc['type']&&_0x1b291e[_0x4125cc(0x16e)]==_0x46c7fc['bin']&&_0x1b291e[_0x4125cc(0x1bb)]==_0x46c7fc[_0x4125cc(0x1bb)]&&_0x1b291e[_0x4125cc(0x16b)]==_0x46c7fc[_0x4125cc(0x16b)]&&_0x1b291e['storage']==_0x46c7fc[_0x4125cc(0x135)]&&_0x1b291e[_0x4125cc(0x130)]==_0x46c7fc['expiry_date']&&_0x1b291e[_0x4125cc(0x1ac)]==_0x46c7fc[_0x4125cc(0x1ac)]&&_0x1b291e['production_date']==_0x46c7fc[_0x4125cc(0x187)]&&_0x1b291e[_0x4125cc(0x173)]==_0x46c7fc[_0x4125cc(0x173)]&&_0x1b291e[_0x4125cc(0x141)]==_0x46c7fc[_0x4125cc(0x171)]){console['log'](_0x46c7fc);var _0x563830;_0x563830=_0x46c7fc[_0x4125cc(0x19f)],_0x46c7fc[_0x4125cc(0x1c9)]=='S'&&(_0x563830=_0x46c7fc[_0x4125cc(0x19f)]),_0x1b291e[_0x4125cc(0x152)]=_0x1b291e[_0x4125cc(0x152)]+_0x563830;}}});}return _0x46493b;});Promise[_0x4c1924(0x1be)](_0x288180)['then'](async _0x2f211a=>{var _0x5170f9=_0x4c1924;try{for(const _0x439617 of _0x2f211a){await _0x439617[_0x5170f9(0x1c4)]();}_0x361f31[_0x5170f9(0x11a)]='True';const _0x7740d9=await _0x361f31[_0x5170f9(0x1c4)](),_0x1ef230=await master_shop[_0x5170f9(0x1cd)](),_0x21c0e7=await email_settings[_0x5170f9(0x126)](),_0x35a705=await supervisor_settings[_0x5170f9(0x1cd)]();var _0x370db3=_0x361f31[_0x5170f9(0x1b3)],_0x5602b3='',_0x3adc31;for(_0x3adc31 in _0x370db3){_0x5602b3+=_0x5170f9(0x182)+_0x5170f9(0x1bf)+_0x370db3[_0x3adc31][_0x5170f9(0x13c)]+_0x5170f9(0x145)+_0x5170f9(0x1bf)+_0x370db3[_0x3adc31]['product_code']+_0x5170f9(0x145)+_0x5170f9(0x1bf)+_0x370db3[_0x3adc31]['adjust_qty']+_0x5170f9(0x145)+_0x5170f9(0x1bf)+_0x370db3[_0x3adc31][_0x5170f9(0x17e)]+_0x5170f9(0x145)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x370db3[_0x3adc31]['secondary_unit']+'</td>'+_0x5170f9(0x1bf)+_0x361f31[_0x5170f9(0x1a1)]+_0x5170f9(0x145)+_0x5170f9(0x1bf)+_0x370db3[_0x3adc31]['room_names']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x370db3[_0x3adc31][_0x5170f9(0x135)]+_0x370db3[_0x3adc31][_0x5170f9(0x16b)]+_0x370db3[_0x3adc31][_0x5170f9(0x1bb)]+_0x370db3[_0x3adc31][_0x5170f9(0x16e)]+_0x370db3[_0x3adc31][_0x5170f9(0x18d)][0x0]+_0x370db3[_0x3adc31][_0x5170f9(0x1d1)]+_0x5170f9(0x145),_0x5170f9(0x149);}let _0x9636fa=nodemailer['createTransport']({'host':_0x21c0e7[_0x5170f9(0x112)],'port':Number(_0x21c0e7[_0x5170f9(0x13f)]),'secure':![],'auth':{'user':_0x21c0e7['email'],'pass':_0x21c0e7[_0x5170f9(0x140)]}}),_0x337697={'from':_0x21c0e7['email'],'to':_0x35a705[0x0]['RMSEmail'],'subject':_0x5170f9(0x17a),'attachments':[{'filename':_0x5170f9(0x1bd),'path':__dirname+_0x5170f9(0x166)+_0x5170f9(0x10f)+_0x1ef230[0x0]['image'],'cid':_0x5170f9(0x18c)}],'html':'<!DOCTYPE\x20html>'+_0x5170f9(0x119)+_0x5170f9(0x136)+_0x5170f9(0x13d)+_0x5170f9(0x195)+_0x5170f9(0x13d)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x5170f9(0x13d)+_0x5170f9(0x175)+_0x1ef230[0x0][_0x5170f9(0xfe)]+_0x5170f9(0x110)+'</div>'+_0x5170f9(0x185)+_0x5170f9(0x164)+_0x5170f9(0x13d)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x5170f9(0x189)+_0x361f31[_0x5170f9(0x173)]+'\x20'+_0x5170f9(0x19c)+_0x5170f9(0x116)+_0x361f31[_0x5170f9(0x11e)]+'\x20'+_0x5170f9(0x127)+_0x5170f9(0x1b2)+_0x5170f9(0x185)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5170f9(0x158)+_0x5170f9(0x182)+_0x5170f9(0x179)+_0x5170f9(0x123)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x5170f9(0x17b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x5170f9(0x144)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x5170f9(0x149)+_0x5170f9(0x188)+_0x5170f9(0x146)+'\x20'+_0x5602b3+'\x20'+'</tbody>'+_0x5170f9(0x14f)+_0x5170f9(0x13d)+_0x5170f9(0x12c)+'<h5>'+_0x1ef230[0x0]['site_title']+_0x5170f9(0x1b2)+_0x5170f9(0x185)+'</div>'+_0x5170f9(0x1c2)};_0x9636fa[_0x5170f9(0x160)](_0x337697,function(_0x196352,_0x20259c){var _0x24ad43=_0x5170f9;_0x196352?(console['log'](_0x196352),console[_0x24ad43(0x132)](_0x24ad43(0x1b7))):console[_0x24ad43(0x132)]('Email\x20sent\x20successfully');}),_0x33cc61[_0x5170f9(0x122)]('success',_0x5170f9(0x14e)),_0x5649d9[_0x5170f9(0x1a9)]('/picking_list/PDF_adjustment_rm/'+_0x7740d9[_0x5170f9(0x141)]);}catch(_0x40f96f){console[_0x5170f9(0x155)](_0x40f96f),_0x5649d9[_0x5170f9(0x128)](0x1f4)[_0x5170f9(0x161)]({'error':_0x5170f9(0x198)});}})[_0x4c1924(0x1c7)](_0x182e67=>{var _0x5e8350=_0x4c1924;console['error'](_0x182e67),_0x5649d9[_0x5e8350(0x128)](0x1f4)[_0x5e8350(0x161)]({'error':_0x5e8350(0x1d0)});});}catch(_0x3f2405){console['log'](_0x3f2405),_0x5649d9[_0x4c1924(0x128)](0xc8)['json']({'message':_0x3f2405[_0x4c1924(0x15a)]});}}),router[a0_0x30b406(0x194)](a0_0x30b406(0x19a),auth,async(_0x159514,_0x54f470)=>{var _0x41ca13=a0_0x30b406;try{const {username:_0x149dd6,email:_0x318fd4,role:_0x3f1047}=_0x159514[_0x41ca13(0x199)],_0x1176d8=_0x159514[_0x41ca13(0x199)],_0x16e9c5=await profile[_0x41ca13(0x126)]({'email':_0x1176d8[_0x41ca13(0x148)]}),_0x3a06d9=await master_shop[_0x41ca13(0x1cd)](),_0xd18fbd=_0x159514[_0x41ca13(0x18a)]['id'],_0x1f7bee=await adjustment['findById']({'_id':_0xd18fbd}),_0x2e04e2=await purchases[_0x41ca13(0x18b)]([{'$match':{'warehouse_name':_0x1f7bee[_0x41ca13(0x1a1)]}},{'$unwind':_0x41ca13(0x1c1)},{'$group':{'_id':_0x41ca13(0x134)}}]),_0x295f1a=await product[_0x41ca13(0x1cd)]({}),_0x366b4a=await warehouse[_0x41ca13(0x18b)]([{'$match':{'name':_0x1f7bee[_0x41ca13(0x1a1)]}},{'$unwind':_0x41ca13(0x19d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x41ca13(0x19e)},'product_stock':{'$first':_0x41ca13(0x10b)},'bay':{'$first':_0x41ca13(0x1b8)},'bin':{'$first':_0x41ca13(0x12a)},'type':{'$first':_0x41ca13(0x115)},'floorlevel':{'$first':_0x41ca13(0xff)},'primary_code':{'$first':_0x41ca13(0x118)},'secondary_code':{'$first':_0x41ca13(0x1a2)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x41ca13(0x114)},'rack':{'$first':_0x41ca13(0x14a)},'maxPerUnit':{'$first':_0x41ca13(0x18f)},'expiry_date':{'$first':_0x41ca13(0x121)},'production_date':{'$first':_0x41ca13(0x1a7)},'batch_code':{'$first':_0x41ca13(0x1bc)},'room':{'$first':_0x41ca13(0x109)}}}]);let _0x38e179;if(_0x1176d8['role']=='staff'){const _0x3a01e2=await staff['findOne']({'email':_0x1176d8[_0x41ca13(0x148)]});_0x38e179=await warehouse[_0x41ca13(0x18b)]([{'$match':{'status':_0x41ca13(0x163),'name':_0x3a01e2[_0x41ca13(0x16d)],'warehouse_category':_0x41ca13(0x1c6),'name':{'$ne':_0x41ca13(0x13e)}}},{'$group':{'_id':_0x41ca13(0x1a8),'name':{'$first':'$name'}}}]);}else _0x38e179=await warehouse[_0x41ca13(0x18b)]([{'$match':{'status':'Enabled','warehouse_category':_0x41ca13(0x1c6),'name':{'$ne':_0x41ca13(0x13e)}}},{'$group':{'_id':_0x41ca13(0x1a8),'name':{'$first':'$name'}}}]);if(_0x3a06d9[0x0]['language']==_0x41ca13(0x184)){var _0x498017=users[_0x41ca13(0x1aa)];console['log'](_0x498017);}else{if(_0x3a06d9[0x0]['language']==_0x41ca13(0x1cb))var _0x498017=users[_0x41ca13(0x1cb)];else{if(_0x3a06d9[0x0]['language']==_0x41ca13(0x1ad))var _0x498017=users[_0x41ca13(0x1ad)];else{if(_0x3a06d9[0x0][_0x41ca13(0x154)]==_0x41ca13(0x1c0))var _0x498017=users['Spanish'];else{if(_0x3a06d9[0x0][_0x41ca13(0x154)]==_0x41ca13(0x17d))var _0x498017=users[_0x41ca13(0x17d)];else{if(_0x3a06d9[0x0]['language']==_0x41ca13(0x107))var _0x498017=users[_0x41ca13(0x1ab)];else{if(_0x3a06d9[0x0]['language']=='Chinese')var _0x498017=users[_0x41ca13(0x192)];else{if(_0x3a06d9[0x0][_0x41ca13(0x154)]==_0x41ca13(0x104))var _0x498017=users[_0x41ca13(0x176)];}}}}}}}_0x54f470[_0x41ca13(0x1c3)](_0x41ca13(0x142),{'success':_0x159514['flash'](_0x41ca13(0x11d)),'errors':_0x159514[_0x41ca13(0x122)]('errors'),'role':_0x1176d8,'profile':_0x16e9c5,'adjustment':_0x1f7bee,'stock':_0x366b4a,'master_shop':_0x3a06d9,'warehouse_name':_0x2e04e2,'unit':_0x295f1a,'language':_0x498017,'warehouse':_0x38e179});}catch(_0x2c2b54){console[_0x41ca13(0x132)](_0x2c2b54),_0x54f470['status'](0xc8)[_0x41ca13(0x161)]({'message':_0x2c2b54['message']});}}),router[a0_0x30b406(0x168)](a0_0x30b406(0x19a),auth,async(_0x35f4b3,_0x48c022)=>{var _0x5f4164=a0_0x30b406;try{const _0x16b95b=_0x35f4b3[_0x5f4164(0x18a)]['id'],_0x162843=await adjustment[_0x5f4164(0x113)]({'_id':_0x16b95b}),_0x492a9d=await warehouse[_0x5f4164(0x126)]({'name':_0x162843[_0x5f4164(0x1a1)],'room':_0x162843[_0x5f4164(0x143)]}),{warehouse_name:_0x3fcbd3,date:_0x3c8ebd,prod_name:_0x58c690,level:_0x260cbb,isle:_0x1c7918,pallet:_0x468b6a,stock:_0xbb5d0b,types:_0x1e9231,adjust_qty:_0x2819c1,new_adjust_qty:_0x4a829c,note:_0x337a80,Room_name:_0x2e8cb4,invoice:_0x116075,JO_number:_0x3f0285,expiry_date:_0x2aa697}=_0x35f4b3[_0x5f4164(0x15d)];if(typeof _0x58c690==_0x5f4164(0x1c5))var _0xd9f781=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x106)]],_0x2e342d=[_0x35f4b3['body'][_0x5f4164(0x169)]],_0x5460b6=[_0x35f4b3['body']['stock']],_0x35874e=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x11b)]],_0x1376a8=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x103)]],_0x4bd025=[_0x35f4b3['body'][_0x5f4164(0x181)]],_0x560eb5=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x1a0)]],_0x3cd636=[_0x35f4b3['body']['Secondary_units']],_0x3c7e92=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x14b)]],_0x24ae82=[_0x35f4b3['body']['batch_code']],_0x3a586f=[_0x35f4b3[_0x5f4164(0x15d)]['expiry_date']],_0x2da7d1=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x174)]],_0xef2074=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x187)]],_0x3ec1a1=[_0x35f4b3[_0x5f4164(0x15d)]['prod_cat']],_0x1623df=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x10d)]],_0x4a0b4a=[_0x35f4b3[_0x5f4164(0x15d)]['prime1']],_0x4e4b04=[_0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x165)]];else var _0xd9f781=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x106)]],_0x2e342d=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x169)]],_0x5460b6=[..._0x35f4b3['body'][_0x5f4164(0x190)]],_0x35874e=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x11b)]],_0x1376a8=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x103)]],_0x4bd025=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x181)]],_0x560eb5=[..._0x35f4b3['body'][_0x5f4164(0x17e)]],_0x3cd636=[..._0x35f4b3['body'][_0x5f4164(0x1a4)]],_0x3c7e92=[..._0x35f4b3['body'][_0x5f4164(0x14b)]],_0x24ae82=[..._0x35f4b3[_0x5f4164(0x15d)]['batch_code']],_0x3a586f=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x130)]],_0x2da7d1=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x174)]],_0xef2074=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x187)]],_0x3ec1a1=[..._0x35f4b3['body'][_0x5f4164(0x1c9)]],_0x1623df=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x10d)]],_0x4a0b4a=[..._0x35f4b3['body'][_0x5f4164(0x150)]],_0x4e4b04=[..._0x35f4b3[_0x5f4164(0x15d)][_0x5f4164(0x165)]];const _0x577bb1=_0xd9f781[_0x5f4164(0x12e)](_0x405252=>{return _0x405252={'product_name':_0x405252};});_0x2e342d[_0x5f4164(0x102)]((_0xc9f3e3,_0x240c77)=>{var _0x4b7e70=_0x5f4164;_0x1623df[_0x4b7e70(0x102)]((_0x3466d5,_0x38547a)=>{var _0x5c7e7d=_0x4b7e70;if(_0x3466d5=='Receiving\x20Area'&&_0x240c77==_0x38547a){var _0x1ec1c1=_0xc9f3e3[_0x5c7e7d(0x137)](0x3);_0x577bb1[_0x240c77][_0x5c7e7d(0x135)]=_0xc9f3e3[0x0],_0x577bb1[_0x240c77]['rack']=_0xc9f3e3[0x1],_0x577bb1[_0x240c77][_0x5c7e7d(0x1bb)]=0x0,_0x577bb1[_0x240c77][_0x5c7e7d(0x16e)]=0x0,_0x577bb1[_0x240c77][_0x5c7e7d(0x18d)]=_0x5c7e7d(0x125),_0x577bb1[_0x240c77][_0x5c7e7d(0x1d1)]=_0x1ec1c1;}else{if(_0x3466d5==_0x5c7e7d(0x117)&&_0x240c77==_0x38547a){var _0x1ec1c1=_0xc9f3e3[_0x5c7e7d(0x137)](0x3);_0x577bb1[_0x240c77][_0x5c7e7d(0x135)]=_0xc9f3e3[0x0],_0x577bb1[_0x240c77][_0x5c7e7d(0x16b)]=_0xc9f3e3[0x1],_0x577bb1[_0x240c77][_0x5c7e7d(0x1bb)]=0x0,_0x577bb1[_0x240c77][_0x5c7e7d(0x16e)]=0x0,_0x577bb1[_0x240c77]['type']=_0x5c7e7d(0x125),_0x577bb1[_0x240c77][_0x5c7e7d(0x1d1)]=_0xc9f3e3[0x5];}else{if(_0x240c77==_0x38547a){var _0x3044e6;if(_0xc9f3e3[0x4]=='L')_0x3044e6='Level';else _0xc9f3e3[0x4]=='F'&&(_0x3044e6=_0x5c7e7d(0x125));_0x577bb1[_0x240c77]['storage']=_0xc9f3e3[0x0],_0x577bb1[_0x240c77][_0x5c7e7d(0x16b)]=_0xc9f3e3[0x1],_0x577bb1[_0x240c77][_0x5c7e7d(0x1bb)]=_0xc9f3e3[0x2],_0x577bb1[_0x240c77][_0x5c7e7d(0x16e)]=_0xc9f3e3[0x3],_0x577bb1[_0x240c77]['type']=_0x3044e6,_0x577bb1[_0x240c77][_0x5c7e7d(0x1d1)]=_0xc9f3e3[0x5];}}}});}),_0x5460b6[_0x5f4164(0x102)]((_0x5c4035,_0x250577)=>{var _0x12e44e=_0x5f4164;_0x577bb1[_0x250577][_0x12e44e(0x172)]=_0x5c4035;}),_0x35874e[_0x5f4164(0x102)]((_0x4ca991,_0x54b141)=>{var _0x1cfa6f=_0x5f4164;_0x577bb1[_0x54b141][_0x1cfa6f(0x11b)]=_0x4ca991;}),_0x1376a8[_0x5f4164(0x102)]((_0x2cb7f5,_0x27a7f5)=>{_0x577bb1[_0x27a7f5]['adjust_qty']=_0x2cb7f5;}),_0x4bd025['forEach']((_0x38240d,_0x1f31c9)=>{var _0x3f7d5c=_0x5f4164;_0x577bb1[_0x1f31c9][_0x3f7d5c(0x105)]=_0x38240d;}),_0x560eb5[_0x5f4164(0x102)]((_0x1c492c,_0x1cc7c9)=>{var _0x11c44c=_0x5f4164;_0x577bb1[_0x1cc7c9][_0x11c44c(0x17e)]=_0x1c492c;}),_0x3cd636[_0x5f4164(0x102)]((_0x68623d,_0x30fdf3)=>{_0x577bb1[_0x30fdf3]['secondary_unit']=_0x68623d;}),_0x3c7e92['forEach']((_0x379b8a,_0x219e88)=>{var _0x166b59=_0x5f4164;_0x577bb1[_0x219e88][_0x166b59(0x139)]=_0x379b8a;}),_0x24ae82['forEach']((_0x3d5f0e,_0x43a11a)=>{var _0x2b9cb6=_0x5f4164;_0x577bb1[_0x43a11a][_0x2b9cb6(0x1ac)]=_0x3d5f0e;}),_0x3a586f[_0x5f4164(0x102)]((_0x177ad0,_0x454d01)=>{var _0x1de6da=_0x5f4164;_0x577bb1[_0x454d01][_0x1de6da(0x130)]=_0x177ad0;}),_0x2da7d1['forEach']((_0x1f69c0,_0x13d180)=>{var _0x3ee827=_0x5f4164;_0x577bb1[_0x13d180][_0x3ee827(0x1b1)]=_0x1f69c0;}),_0xef2074[_0x5f4164(0x102)]((_0x36e597,_0x4a8717)=>{var _0x4cabcc=_0x5f4164;_0x577bb1[_0x4a8717][_0x4cabcc(0x187)]=_0x36e597;}),_0x3ec1a1[_0x5f4164(0x102)]((_0x3e6027,_0x43bb1d)=>{var _0x379111=_0x5f4164;_0x577bb1[_0x43bb1d][_0x379111(0x1c9)]=_0x3e6027;}),_0x1623df[_0x5f4164(0x102)]((_0xf758cb,_0x454c97)=>{var _0x199a1c=_0x5f4164;_0x577bb1[_0x454c97][_0x199a1c(0x1b5)]=_0xf758cb;}),_0x4a0b4a[_0x5f4164(0x102)]((_0x2c6875,_0x42e1c5)=>{var _0x34ac46=_0x5f4164;_0x577bb1[_0x42e1c5][_0x34ac46(0x10c)]=_0x2c6875;}),_0x4e4b04[_0x5f4164(0x102)]((_0x5dd8e9,_0x15bb8e)=>{var _0x187ac8=_0x5f4164;_0x577bb1[_0x15bb8e][_0x187ac8(0x10e)]=_0x5dd8e9;});const _0x4b6161=_0x577bb1['filter'](_0x3eb2d9=>_0x3eb2d9['adjust_qty']!=='0'&&_0x3eb2d9[_0x5f4164(0x19f)]!=='');var _0x1e9e98=0x0;_0x4b6161[_0x5f4164(0x102)](_0x40b67c=>{var _0x1938a7=_0x5f4164;console[_0x1938a7(0x132)](_0x1938a7(0x1b6),_0x40b67c),parseInt(_0x40b67c[_0x1938a7(0x19f)])<=0x0&&_0x1e9e98++;});if(_0x1e9e98!=0x0)return _0x35f4b3[_0x5f4164(0x122)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x48c022[_0x5f4164(0x1a9)](_0x5f4164(0x177));_0x162843[_0x5f4164(0x1a1)]=_0x3fcbd3,_0x162843['date']=_0x3c8ebd,_0x162843[_0x5f4164(0x1b3)]=_0x4b6161,_0x162843[_0x5f4164(0x11c)]=_0x337a80,_0x162843[_0x5f4164(0x173)]=_0x116075,_0x162843[_0x5f4164(0x12b)]=_0x5f4164(0x1af);const _0x3bf380=await _0x162843[_0x5f4164(0x1c4)]();_0x35f4b3['flash'](_0x5f4164(0x11d),'adjustment\x20data\x20update\x20successfully'),_0x48c022['redirect'](_0x5f4164(0x18e));}catch(_0x5b01e9){console[_0x5f4164(0x132)](_0x5b01e9);}}),router[a0_0x30b406(0x168)](a0_0x30b406(0x1a6),async(_0x411d16,_0x2d8c5e)=>{var _0x29eb9a=a0_0x30b406;const {primary_code:_0x274e8a,warehouse_data:_0x1536d7,rooms_data:_0x56d047,Roomslist:_0x412982}=_0x411d16[_0x29eb9a(0x15d)],_0x5aa8d8=_0x412982[_0x29eb9a(0x153)](','),_0x3bb109=[];async function _0x855dea(_0x54b826){var _0x2f0f0e=_0x29eb9a;const _0x50610e=await warehouse[_0x2f0f0e(0x18b)]([{'$match':{'name':_0x1536d7,'room':_0x54b826}},{'$unwind':_0x2f0f0e(0x19d)},{'$match':{'product_details.primary_code':_0x274e8a}},{'$group':{'_id':_0x2f0f0e(0x19b),'name':{'$first':_0x2f0f0e(0x19e)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2f0f0e(0x1a2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2f0f0e(0x1b8)},'isle':{'$first':_0x2f0f0e(0x12a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2f0f0e(0xff)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2f0f0e(0x131)},'storage':{'$first':_0x2f0f0e(0x114)},'rack':{'$first':_0x2f0f0e(0x14a)},'expiry_date':{'$first':_0x2f0f0e(0x121)},'production_date':{'$first':_0x2f0f0e(0x1a7)},'maxPerUnit':{'$first':_0x2f0f0e(0x18f)},'batch_code':{'$first':_0x2f0f0e(0x1bc)},'product_cat':{'$first':_0x2f0f0e(0x14c)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2f0f0e(0x109)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x1557bc=await warehouse[_0x2f0f0e(0x18b)]([{'$match':{'name':_0x1536d7,'room':_0x54b826}},{'$unwind':_0x2f0f0e(0x19d)},{'$match':{'product_details.secondary_code':_0x274e8a}},{'$group':{'_id':_0x2f0f0e(0x19b),'name':{'$first':_0x2f0f0e(0x19e)},'product_stock':{'$first':_0x2f0f0e(0x10b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2f0f0e(0x1a2)},'product_code':{'$first':_0x2f0f0e(0x1d2)},'level':{'$first':_0x2f0f0e(0x1b8)},'isle':{'$first':_0x2f0f0e(0x12a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2f0f0e(0xff)},'unit':{'$first':_0x2f0f0e(0x1ce)},'secondary_unit':{'$first':_0x2f0f0e(0x131)},'storage':{'$first':_0x2f0f0e(0x114)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2f0f0e(0x121)},'production_date':{'$first':_0x2f0f0e(0x1a7)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2f0f0e(0x1bc)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2f0f0e(0x109)}}}]);if(_0x50610e[_0x2f0f0e(0x120)]>0x0)_0x3bb109[_0x2f0f0e(0x1a5)](_0x50610e);else _0x1557bc[_0x2f0f0e(0x120)]>0x0&&_0x3bb109['push'](_0x1557bc);}const _0x493d1c=_0x5aa8d8[_0x29eb9a(0x12e)](_0x2745d6=>_0x855dea(_0x2745d6));await Promise[_0x29eb9a(0x1be)](_0x493d1c),_0x2d8c5e['json'](_0x3bb109);}),router['post'](a0_0x30b406(0xfd),async(_0x3f3ea1,_0x2d319c)=>{var _0x23f4e5=a0_0x30b406;const {primaryCode:_0x538154,secondaryCode:_0x26d87b,productCode:_0x543a48,level:_0x5ab5b5,isle:_0x3bca13,pallet:_0x5413c8,warehouses:_0x7d4cb3,room:_0x482826}=_0x3f3ea1['body'];try{const _0x5863dd=await warehouse[_0x23f4e5(0x18b)]([{'$match':{'name':_0x7d4cb3,'room':_0x482826}},{'$unwind':_0x23f4e5(0x19d)},{'$match':{'product_details.level':parseInt(_0x5ab5b5),'product_details.isle':_0x3bca13,'product_details.pallet':parseInt(_0x5413c8)}},{'$group':{'_id':_0x23f4e5(0x19b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x23f4e5(0x1b4)},'pallet':{'$first':_0x23f4e5(0xfb)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2d319c[_0x23f4e5(0x128)](0xc8)['json'](_0x5863dd);}catch(_0x4b0392){_0x2d319c[_0x23f4e5(0x128)](0x194)[_0x23f4e5(0x161)]({'message':_0x4b0392[_0x23f4e5(0x15a)]});}}),module['exports']=router;