var a0_0x2dc917=a0_0x18a0;(function(_0x24ed97,_0x74e39d){var _0x1e5220=a0_0x18a0,_0x16f48a=_0x24ed97();while(!![]){try{var _0x37fe75=-parseInt(_0x1e5220(0x284))/0x1+-parseInt(_0x1e5220(0x232))/0x2+-parseInt(_0x1e5220(0x1fb))/0x3*(-parseInt(_0x1e5220(0x1cb))/0x4)+parseInt(_0x1e5220(0x235))/0x5*(parseInt(_0x1e5220(0x246))/0x6)+-parseInt(_0x1e5220(0x1df))/0x7*(-parseInt(_0x1e5220(0x1c0))/0x8)+-parseInt(_0x1e5220(0x26d))/0x9+-parseInt(_0x1e5220(0x207))/0xa*(-parseInt(_0x1e5220(0x219))/0xb);if(_0x37fe75===_0x74e39d)break;else _0x16f48a['push'](_0x16f48a['shift']());}catch(_0x312986){_0x16f48a['push'](_0x16f48a['shift']());}}}(a0_0x3ea6,0xd9a72));const express=require(a0_0x2dc917(0x1f1)),app=express(),router=express[a0_0x2dc917(0x20b)](),auth=require(a0_0x2dc917(0x27d)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x2dc917(0x1d5)),users=require(a0_0x2dc917(0x1ea)),nodemailer=require(a0_0x2dc917(0x25f));router[a0_0x2dc917(0x1c8)](a0_0x2dc917(0x27a),auth,async(_0x7c2dc7,_0x303f9b)=>{var _0x30e23b=a0_0x2dc917;try{const {username:_0x2b09f1,email:_0xb3732e,role:_0x4e88da}=_0x7c2dc7[_0x30e23b(0x220)],_0x2dd2e3=_0x7c2dc7[_0x30e23b(0x220)],_0x43bd1f=await profile[_0x30e23b(0x24d)]({'email':_0x2dd2e3[_0x30e23b(0x212)]}),_0x2e4f91=await master_shop['find']();console['log']('master',_0x2e4f91);let _0x400edf;if(_0x2dd2e3[_0x30e23b(0x244)]==_0x30e23b(0x1f8)){const _0x34ec6a=await staff[_0x30e23b(0x24d)]({'email':_0x2dd2e3[_0x30e23b(0x212)]});_0x400edf=await warehouse[_0x30e23b(0x265)]({'status':_0x30e23b(0x1c7),'name':_0x34ec6a['warehouse']});}else _0x400edf=await warehouse[_0x30e23b(0x265)]({'status':_0x30e23b(0x1c7)});const _0xd0255b=await product[_0x30e23b(0x265)]();let _0x271e61;if(_0x2dd2e3[_0x30e23b(0x244)]==_0x30e23b(0x1f8)){const _0x148ebc=await staff[_0x30e23b(0x24d)]({'email':_0x2dd2e3[_0x30e23b(0x212)]});_0x271e61=await adjustment[_0x30e23b(0x265)]({'warehouse_name':_0x148ebc['warehouse']});}else _0x271e61=await adjustment[_0x30e23b(0x1fe)]([{'$unwind':'$product'},{'$group':{'_id':_0x30e23b(0x21b),'invoice':{'$first':'$invoice'},'date':{'$first':_0x30e23b(0x1bd)},'warehouse_name':{'$first':_0x30e23b(0x257)},'room':{'$addToSet':_0x30e23b(0x1d2)},'finalize':{'$first':_0x30e23b(0x226)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2e4f91[0x0][_0x30e23b(0x23b)]=='English\x20(US)'){var _0x10521b=users[_0x30e23b(0x1c3)];console['log'](_0x10521b);}else{if(_0x2e4f91[0x0][_0x30e23b(0x23b)]=='Hindi')var _0x10521b=users[_0x30e23b(0x1ee)];else{if(_0x2e4f91[0x0][_0x30e23b(0x23b)]==_0x30e23b(0x1d1))var _0x10521b=users[_0x30e23b(0x1d1)];else{if(_0x2e4f91[0x0][_0x30e23b(0x23b)]==_0x30e23b(0x263))var _0x10521b=users[_0x30e23b(0x263)];else{if(_0x2e4f91[0x0][_0x30e23b(0x23b)]==_0x30e23b(0x281))var _0x10521b=users[_0x30e23b(0x281)];else{if(_0x2e4f91[0x0][_0x30e23b(0x23b)]==_0x30e23b(0x24c))var _0x10521b=users[_0x30e23b(0x1f3)];else{if(_0x2e4f91[0x0][_0x30e23b(0x23b)]==_0x30e23b(0x1ff))var _0x10521b=users['Chinese'];else{if(_0x2e4f91[0x0][_0x30e23b(0x23b)]==_0x30e23b(0x1dc))var _0x10521b=users['Arabic'];}}}}}}}_0x303f9b['render'](_0x30e23b(0x26f),{'success':_0x7c2dc7['flash'](_0x30e23b(0x260)),'errors':_0x7c2dc7[_0x30e23b(0x279)](_0x30e23b(0x285)),'role':_0x2dd2e3,'profile':_0x43bd1f,'warehouse':_0x400edf,'product':_0xd0255b,'adjustment':_0x271e61,'master_shop':_0x2e4f91,'language':_0x10521b});}catch(_0xc6ebb6){console[_0x30e23b(0x1bf)](_0xc6ebb6);}});function a0_0x3ea6(){var _0x51fba6=['$product','1568203BPJMkZ','errors','$product_details.secondary_code','$name','\x20<>\x20','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Email\x20sent\x20successfully','English\x20(US)','stockBefore','stock','<div>','new_adjust_qty','$date','Ambient','log','8366368Tfmidj','forEach','$product_details.maxPerUnit','English','prod_name','split','Raw\x20Materials','Enabled','get','$product_details.rack','</tr>','3390004zSFhUt','$room','</span>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','ADJ-','<h2>\x20','German','$product.room_names','$product_details._id','prod_invoice','../models/all_models','False','level','minus','<h5>','$product_details.product_code','params','Arabic\x20(ae)','batch_code','expiry_date','7utznUh','add_adjustment','sendMail','prod_code','$product_details.floorlevel','warehouse_name','New_Qty_Converted','<tr>','$product_details.storage','_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','../public/language/languages.json','invoice','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.bin','Hindi','<span\x20style=\x22float:\x20right;\x22>','host','express','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Portuguese','Return\x20Goods','$product_details.isle','Floor','$product_details.product_name','staff','room_names','</h5>','3rHDvqp','redirect','padStart','aggregate','Chinese','push','/CheckingWarehouse','product_details','post','types','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','835320hTIhSW','$product_details.batch_code','</table>','Secondary_units','Router','Arabic','edit_adjustment_view','foreach\x20newproduct','error','</body></html>','edit_adjustment','email','/preview/:id','$product_details.pallet','catch','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','floorlevel','Shelves','88OFoaTL','$product_details.product_stock','$_id','$product_details.production_date','filter','/../public','map','user','createTransport','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.unit','bin','adjustment\x20data\x20update\x20successfully','$finalize','$product_details.bay','product','message','$product.product_name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','slice','string','json','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','</div>','note','1376122gEDslk','Level','body','666735GzSBMM','/view/:id','type','</thead>','room','/view/add_adjustment','language','image','Rooms','max_per_unit','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','date','<h5\x20style=\x22text-align:\x20left;\x22>','adjust_qty','role','$product_details','30tncfez','secondary_unit','product_name','isAllowEdit','Primary_Units','back','Portuguese\x20(BR)','findOne','<strong>\x20Regards\x20</strong>','\x20Order\x20Date\x20:\x20','\x20Order\x20Number\x20:\x20','second1','maxPerUnit','prime1','True','$product_details.primary_code','then','$warehouse_name','rack','<!DOCTYPE\x20html>','storage','exports','bay','port','An\x20error\x20occurred.','nodemailer','success','Return\x20Rooms','save','Spanish','</td>','find','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.type','Error\x20Occurs','render','length','floor','product_stock','724662nWtUbD','findById','adjustment','New_Qty_Converted_adj','toString','/upload/','maxperunit','production_date','RMSEmail','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.level','finalize','flash','/view','unit','secondary_code','../middleware/auth','warehouse','prod_cat','/adjustment/view','French','all'];a0_0x3ea6=function(){return _0x51fba6;};return a0_0x3ea6();}async function getRandom8DigitNumber(){var _0x93e782=a0_0x2dc917;const _0xe2e667=0x989680,_0x1c26ae=0x5f5e0ff,_0x4ba6a2=Math[_0x93e782(0x26b)](Math['random']()*(_0x1c26ae-_0xe2e667+0x1))+_0xe2e667;var _0x596760;const _0x1f9281=await adjustment[_0x93e782(0x24d)]({'invoice':_0x93e782(0x1cf)+_0x4ba6a2});return _0x1f9281&&_0x1f9281[_0x93e782(0x26a)]>0x0?_0x596760='ADJ-'+_0x4ba6a2:_0x596760=_0x93e782(0x1cf)+_0x4ba6a2,_0x596760;}function a0_0x18a0(_0x4f319c,_0x3fa779){var _0x3ea688=a0_0x3ea6();return a0_0x18a0=function(_0x18a05e,_0xeba6b8){_0x18a05e=_0x18a05e-0x1bb;var _0x3bfbb5=_0x3ea688[_0x18a05e];return _0x3bfbb5;},a0_0x18a0(_0x4f319c,_0x3fa779);}router[a0_0x2dc917(0x1c8)](a0_0x2dc917(0x23a),auth,async(_0x4f72cc,_0x1025f6)=>{var _0x607a13=a0_0x2dc917;try{const {username:_0x34244d,email:_0x195ea8,role:_0x4a1b55}=_0x4f72cc[_0x607a13(0x220)],_0x315e2a=_0x4f72cc[_0x607a13(0x220)],_0x4d0815=await profile[_0x607a13(0x24d)]({'email':_0x315e2a[_0x607a13(0x212)]}),_0x5e59d5=await master_shop[_0x607a13(0x265)]();let _0x804488;if(_0x315e2a[_0x607a13(0x244)]==_0x607a13(0x1f8)){const _0x2ef98e=await staff[_0x607a13(0x24d)]({'email':_0x315e2a['email']});_0x804488=await warehouse[_0x607a13(0x1fe)]([{'$match':{'status':_0x607a13(0x1c7),'name':_0x2ef98e['warehouse'],'warehouse_category':_0x607a13(0x1c6),'name':{'$ne':_0x607a13(0x1f4)}}},{'$group':{'_id':_0x607a13(0x287),'name':{'$first':_0x607a13(0x287)}}}]);}else _0x804488=await warehouse[_0x607a13(0x1fe)]([{'$match':{'status':_0x607a13(0x1c7),'warehouse_category':_0x607a13(0x1c6),'name':{'$ne':_0x607a13(0x1f4)}}},{'$group':{'_id':'$name','name':{'$first':_0x607a13(0x287)}}}]);const _0x5b3261=await product['find']({}),_0x339e3e=await adjustment[_0x607a13(0x265)]({}),_0x199ff5=_0x339e3e[_0x607a13(0x26a)]+0x1,_0x65265f='ADJ-'+_0x199ff5[_0x607a13(0x271)]()[_0x607a13(0x1fd)](0x5,'0');var _0x346252=[_0x607a13(0x1be),'Enclosed',_0x607a13(0x261)];if(_0x5e59d5[0x0][_0x607a13(0x23b)]==_0x607a13(0x28d))var _0x4b7936=users['English'];else{if(_0x5e59d5[0x0][_0x607a13(0x23b)]==_0x607a13(0x1ee))var _0x4b7936=users['Hindi'];else{if(_0x5e59d5[0x0][_0x607a13(0x23b)]==_0x607a13(0x1d1))var _0x4b7936=users['German'];else{if(_0x5e59d5[0x0][_0x607a13(0x23b)]==_0x607a13(0x263))var _0x4b7936=users[_0x607a13(0x263)];else{if(_0x5e59d5[0x0][_0x607a13(0x23b)]==_0x607a13(0x281))var _0x4b7936=users[_0x607a13(0x281)];else{if(_0x5e59d5[0x0][_0x607a13(0x23b)]==_0x607a13(0x24c))var _0x4b7936=users[_0x607a13(0x1f3)];else{if(_0x5e59d5[0x0][_0x607a13(0x23b)]==_0x607a13(0x1ff))var _0x4b7936=users[_0x607a13(0x1ff)];else{if(_0x5e59d5[0x0]['language']==_0x607a13(0x1dc))var _0x4b7936=users[_0x607a13(0x20c)];}}}}}}}const _0x206bea=getRandom8DigitNumber();_0x206bea['then'](_0x203a31=>{var _0x16f934=_0x607a13;_0x1025f6['render'](_0x16f934(0x1e0),{'success':_0x4f72cc['flash'](_0x16f934(0x260)),'errors':_0x4f72cc[_0x16f934(0x279)]('errors'),'role':_0x315e2a,'profile':_0x4d0815,'warehouse':_0x804488,'product':_0x5b3261,'master_shop':_0x5e59d5,'language':_0x4b7936,'rooms_data':_0x346252,'invoice_no':_0x203a31});})[_0x607a13(0x215)](_0x3e06de=>{var _0x4a634f=_0x607a13;_0x4f72cc['flash'](_0x4a634f(0x285),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x1025f6[_0x4a634f(0x1fc)](_0x4a634f(0x280));});}catch(_0x48b73c){console['log'](_0x48b73c);}}),router[a0_0x2dc917(0x203)](a0_0x2dc917(0x23a),auth,async(_0x2d4be9,_0x163945)=>{var _0x50f6ca=a0_0x2dc917;try{const {warehouse_name:_0x421968,date:_0x3209a1,prod_name:_0x3109bc,level:_0x3631ae,isle:_0x4d868f,pallet:_0x5a02a5,stock:_0x4945fa,types:_0x1822ee,adjust_qty:_0x1c71ef,new_adjust_qty:_0x543768,note:_0x53ef08,Room_name:_0xd618c1,invoice:_0x21ad88,JO_number:_0x677075,expiry_date:_0x1a4c58}=_0x2d4be9[_0x50f6ca(0x234)];if(typeof _0x3109bc==_0x50f6ca(0x22d))var _0x7b230c=[_0x2d4be9['body']['prod_name']],_0x174dc2=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x1d7)]],_0x5f4d5b=[_0x2d4be9[_0x50f6ca(0x234)]['stock']],_0x415202=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x204)]],_0x4dda23=[_0x2d4be9['body'][_0x50f6ca(0x270)]],_0x18cd36=[_0x2d4be9['body']['New_Qty_Converted']],_0x297648=[_0x2d4be9[_0x50f6ca(0x234)]['Primary_Units']],_0xc21d2f=[_0x2d4be9[_0x50f6ca(0x234)]['Secondary_units']],_0x7eb2c3=[_0x2d4be9['body'][_0x50f6ca(0x1e2)]],_0x419b0e=[_0x2d4be9[_0x50f6ca(0x234)]['batch_code']],_0x584d6c=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x1de)]],_0x42e5e6=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x23e)]],_0x2518e4=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x274)]],_0x32297b=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x27f)]],_0x4c3d73=[_0x2d4be9['body']['Rooms']],_0x2b08e7=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x253)]],_0x13b460=[_0x2d4be9[_0x50f6ca(0x234)]['second1']],_0x875650=[_0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x1d4)]];else var _0x7b230c=[..._0x2d4be9['body'][_0x50f6ca(0x1c4)]],_0x174dc2=[..._0x2d4be9['body'][_0x50f6ca(0x1d7)]],_0x5f4d5b=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x28f)]],_0x415202=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x204)]],_0x4dda23=[..._0x2d4be9['body'][_0x50f6ca(0x270)]],_0x18cd36=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x1e5)]],_0x297648=[..._0x2d4be9['body'][_0x50f6ca(0x27b)]],_0xc21d2f=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x20a)]],_0x7eb2c3=[..._0x2d4be9[_0x50f6ca(0x234)]['prod_code']],_0x419b0e=[..._0x2d4be9['body'][_0x50f6ca(0x1dd)]],_0x584d6c=[..._0x2d4be9['body']['expiry_date']],_0x42e5e6=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x23e)]],_0x2518e4=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x274)]],_0x32297b=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x27f)]],_0x4c3d73=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x23d)]],_0x2b08e7=[..._0x2d4be9['body'][_0x50f6ca(0x253)]],_0x13b460=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x251)]],_0x875650=[..._0x2d4be9[_0x50f6ca(0x234)][_0x50f6ca(0x1d4)]];const _0x2d5421=_0x7b230c[_0x50f6ca(0x21f)](_0x2f52c7=>{return _0x2f52c7={'product_name':_0x2f52c7};});_0x174dc2[_0x50f6ca(0x1c1)]((_0x28abe9,_0x2679e2)=>{var _0x40472b=_0x50f6ca;_0x4c3d73[_0x40472b(0x1c1)]((_0x18b885,_0x103589)=>{var _0x515e03=_0x40472b;if(_0x18b885=='Receiving\x20Area'&&_0x2679e2==_0x103589){var _0x1a2991=_0x28abe9['slice'](0x3);_0x2d5421[_0x2679e2][_0x515e03(0x25a)]=_0x28abe9[0x0],_0x2d5421[_0x2679e2][_0x515e03(0x258)]=_0x28abe9[0x1],_0x2d5421[_0x2679e2][_0x515e03(0x25c)]=0x0,_0x2d5421[_0x2679e2][_0x515e03(0x224)]=0x0,_0x2d5421[_0x2679e2][_0x515e03(0x237)]='Floor',_0x2d5421[_0x2679e2][_0x515e03(0x217)]=_0x1a2991;}else{if(_0x18b885==_0x515e03(0x218)&&_0x2679e2==_0x103589){var _0x1a2991=_0x28abe9[_0x515e03(0x22c)](0x3);_0x2d5421[_0x2679e2]['storage']=_0x28abe9[0x0],_0x2d5421[_0x2679e2]['rack']=_0x28abe9[0x1],_0x2d5421[_0x2679e2][_0x515e03(0x25c)]=0x0,_0x2d5421[_0x2679e2]['bin']=0x0,_0x2d5421[_0x2679e2]['type']=_0x515e03(0x1f6),_0x2d5421[_0x2679e2][_0x515e03(0x217)]=_0x28abe9[0x5];}else{if(_0x2679e2==_0x103589){var _0x939ad9;if(_0x28abe9[0x4]=='L')_0x939ad9=_0x515e03(0x233);else _0x28abe9[0x4]=='F'&&(_0x939ad9=_0x515e03(0x1f6));_0x2d5421[_0x2679e2]['storage']=_0x28abe9[0x0],_0x2d5421[_0x2679e2][_0x515e03(0x258)]=_0x28abe9[0x1],_0x2d5421[_0x2679e2][_0x515e03(0x25c)]=_0x28abe9[0x2],_0x2d5421[_0x2679e2]['bin']=_0x28abe9[0x3],_0x2d5421[_0x2679e2][_0x515e03(0x237)]=_0x939ad9,_0x2d5421[_0x2679e2][_0x515e03(0x217)]=_0x28abe9[0x5];}}}});}),_0x5f4d5b['forEach']((_0x2a5ed8,_0x3a17fa)=>{var _0x4b438c=_0x50f6ca;_0x2d5421[_0x3a17fa][_0x4b438c(0x28e)]=_0x2a5ed8;}),_0x415202[_0x50f6ca(0x1c1)]((_0x546f30,_0x35626b)=>{var _0xc4322f=_0x50f6ca;_0x2d5421[_0x35626b][_0xc4322f(0x204)]=_0x546f30;}),_0x4dda23[_0x50f6ca(0x1c1)]((_0x3b2ad4,_0x54a365)=>{var _0x24947e=_0x50f6ca;_0x2d5421[_0x54a365][_0x24947e(0x243)]=_0x3b2ad4;}),_0x18cd36[_0x50f6ca(0x1c1)]((_0x4780e3,_0x134987)=>{var _0x4102e3=_0x50f6ca;_0x2d5421[_0x134987][_0x4102e3(0x1bc)]=_0x4780e3;}),_0x297648['forEach']((_0xf9557f,_0x290ce2)=>{var _0x567317=_0x50f6ca;_0x2d5421[_0x290ce2][_0x567317(0x27b)]=_0xf9557f;}),_0xc21d2f[_0x50f6ca(0x1c1)]((_0x23af26,_0x4cec57)=>{var _0x1cbff9=_0x50f6ca;_0x2d5421[_0x4cec57][_0x1cbff9(0x247)]=_0x23af26;}),_0x7eb2c3[_0x50f6ca(0x1c1)]((_0x29d781,_0x1d7a7c)=>{var _0x1917ed=_0x50f6ca;_0x2d5421[_0x1d7a7c][_0x1917ed(0x289)]=_0x29d781;}),_0x419b0e[_0x50f6ca(0x1c1)]((_0x1e521b,_0x7f5638)=>{_0x2d5421[_0x7f5638]['batch_code']=_0x1e521b;}),_0x584d6c['forEach']((_0x1abacd,_0x227867)=>{_0x2d5421[_0x227867]['expiry_date']=_0x1abacd;}),_0x42e5e6[_0x50f6ca(0x1c1)]((_0x41d502,_0x5006af)=>{var _0x2cf0d5=_0x50f6ca;_0x2d5421[_0x5006af][_0x2cf0d5(0x273)]=_0x41d502;}),_0x2518e4[_0x50f6ca(0x1c1)]((_0x5c98b4,_0x60fbad)=>{var _0xfa9a3f=_0x50f6ca;_0x2d5421[_0x60fbad][_0xfa9a3f(0x274)]=_0x5c98b4;}),_0x32297b[_0x50f6ca(0x1c1)]((_0x164745,_0x1bd04c)=>{var _0x373d1c=_0x50f6ca;_0x2d5421[_0x1bd04c][_0x373d1c(0x27f)]=_0x164745;}),_0x4c3d73['forEach']((_0x5e85e0,_0x42e130)=>{_0x2d5421[_0x42e130]['room_names']=_0x5e85e0;}),_0x2b08e7[_0x50f6ca(0x1c1)]((_0x4219b2,_0x174680)=>{_0x2d5421[_0x174680]['primary_code']=_0x4219b2;}),_0x13b460[_0x50f6ca(0x1c1)]((_0x44ce6a,_0x1aa660)=>{var _0x340b5f=_0x50f6ca;_0x2d5421[_0x1aa660][_0x340b5f(0x27c)]=_0x44ce6a;}),_0x875650[_0x50f6ca(0x1c1)]((_0x24cbc2,_0x76eba7)=>{var _0x2c9bdb=_0x50f6ca;_0x2d5421[_0x76eba7][_0x2c9bdb(0x1eb)]=_0x24cbc2;});const _0x988800=_0x2d5421['filter'](_0x2558eb=>_0x2558eb[_0x50f6ca(0x243)]!=='0'&&_0x2558eb[_0x50f6ca(0x243)]!=='');var _0x5585bc=0x0;_0x988800['forEach'](_0x5b91a9=>{var _0x3b9bcf=_0x50f6ca;console[_0x3b9bcf(0x1bf)]('foreach\x20newproduct',_0x5b91a9),parseInt(_0x5b91a9[_0x3b9bcf(0x243)])<=0x0&&_0x5585bc++;});if(_0x5585bc!=0x0)return _0x2d4be9[_0x50f6ca(0x279)](_0x50f6ca(0x285),_0x50f6ca(0x22f)),_0x163945[_0x50f6ca(0x1fc)](_0x50f6ca(0x24b));const _0x5ae5be=new adjustment({'warehouse_name':_0x421968,'date':_0x3209a1,'product':_0x988800,'note':_0x53ef08,'room':_0xd618c1,'invoice':_0x21ad88,'JO_number':_0x677075,'expiry_date':_0x1a4c58}),_0x3faebf=await _0x5ae5be['save']();_0x2d4be9[_0x50f6ca(0x279)](_0x50f6ca(0x260),'adjustment\x20add\x20successfull'),_0x163945[_0x50f6ca(0x1fc)]('/adjustment/preview/'+_0x3faebf[_0x50f6ca(0x1e8)]);}catch(_0x294b0d){console[_0x50f6ca(0x1bf)](_0x294b0d),_0x163945[_0x50f6ca(0x23f)](0xc8)[_0x50f6ca(0x22e)]({'message':_0x294b0d['message']});}}),router[a0_0x2dc917(0x1c8)]('/preview/:id',auth,async(_0x1e39cf,_0x5f4cde)=>{var _0x4b56f7=a0_0x2dc917;try{const {username:_0x7affe8,email:_0x27434c,role:_0x3d6a3e}=_0x1e39cf[_0x4b56f7(0x220)],_0xdbfea3=_0x1e39cf[_0x4b56f7(0x220)],_0x180cd8=await profile['findOne']({'email':_0xdbfea3[_0x4b56f7(0x212)]}),_0x186314=await master_shop[_0x4b56f7(0x265)](),_0x49f0ba=_0x1e39cf[_0x4b56f7(0x1db)]['id'],_0xedfe04=await adjustment[_0x4b56f7(0x26e)]({'_id':_0x49f0ba}),_0xf355d9=await purchases[_0x4b56f7(0x1fe)]([{'$match':{'warehouse_name':_0xedfe04[_0x4b56f7(0x1e4)]}},{'$unwind':_0x4b56f7(0x283)},{'$group':{'_id':_0x4b56f7(0x22a)}}]),_0x4d4869=await product[_0x4b56f7(0x265)]({}),_0x13123d=await warehouse[_0x4b56f7(0x1fe)]([{'$match':{'name':_0xedfe04[_0x4b56f7(0x1e4)]}},{'$unwind':_0x4b56f7(0x245)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4b56f7(0x21a)},'bay':{'$first':_0x4b56f7(0x227)},'bin':{'$first':_0x4b56f7(0x1ed)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4b56f7(0x1e3)},'primary_code':{'$first':_0x4b56f7(0x255)},'secondary_code':{'$first':_0x4b56f7(0x286)},'product_code':{'$first':_0x4b56f7(0x1da)},'storage':{'$first':_0x4b56f7(0x1e7)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x4b56f7(0x205)},'production_date':{'$first':_0x4b56f7(0x21c)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x4b56f7(0x1cc)}}}]);if(_0x186314[0x0][_0x4b56f7(0x23b)]==_0x4b56f7(0x28d)){var _0x51dd09=users['English'];console[_0x4b56f7(0x1bf)](_0x51dd09);}else{if(_0x186314[0x0][_0x4b56f7(0x23b)]=='Hindi')var _0x51dd09=users['Hindi'];else{if(_0x186314[0x0][_0x4b56f7(0x23b)]==_0x4b56f7(0x1d1))var _0x51dd09=users[_0x4b56f7(0x1d1)];else{if(_0x186314[0x0]['language']=='Spanish')var _0x51dd09=users[_0x4b56f7(0x263)];else{if(_0x186314[0x0][_0x4b56f7(0x23b)]==_0x4b56f7(0x281))var _0x51dd09=users[_0x4b56f7(0x281)];else{if(_0x186314[0x0]['language']==_0x4b56f7(0x24c))var _0x51dd09=users[_0x4b56f7(0x1f3)];else{if(_0x186314[0x0][_0x4b56f7(0x23b)]==_0x4b56f7(0x1ff))var _0x51dd09=users[_0x4b56f7(0x1ff)];else{if(_0x186314[0x0][_0x4b56f7(0x23b)]==_0x4b56f7(0x1dc))var _0x51dd09=users[_0x4b56f7(0x20c)];}}}}}}}_0x5f4cde[_0x4b56f7(0x269)](_0x4b56f7(0x20d),{'success':_0x1e39cf[_0x4b56f7(0x279)]('success'),'errors':_0x1e39cf[_0x4b56f7(0x279)](_0x4b56f7(0x285)),'role':_0xdbfea3,'profile':_0x180cd8,'adjustment':_0xedfe04,'stock':_0x13123d,'master_shop':_0x186314,'warehouse_name':_0xf355d9,'unit':_0x4d4869,'language':_0x51dd09});}catch(_0x176fc2){console[_0x4b56f7(0x1bf)](_0x176fc2),_0x5f4cde[_0x4b56f7(0x23f)](0xc8)['json']({'message':_0x176fc2[_0x4b56f7(0x229)]});}}),router['post'](a0_0x2dc917(0x213),auth,async(_0x5ca064,_0x4e29a7)=>{var _0x432c20=a0_0x2dc917;try{const _0x3532ee=_0x5ca064[_0x432c20(0x1db)]['id'],{warehouse_name:_0x43bc0f,Room_name:_0x519de0}=_0x5ca064[_0x432c20(0x234)],_0x2b5ab5=await adjustment[_0x432c20(0x26e)]({'_id':_0x3532ee}),_0x40225f=_0x2b5ab5['product'][_0x432c20(0x21f)](async _0x13b88b=>{var _0x186cb8=_0x432c20;if(_0x13b88b[_0x186cb8(0x243)]>0x0){var _0x50ba06=await warehouse[_0x186cb8(0x24d)]({'name':_0x43bc0f,'room':_0x13b88b['room_names'],'warehouse_category':_0x186cb8(0x1c6)});const _0x1f8bf9=_0x50ba06[_0x186cb8(0x202)]['map'](_0x598aa1=>{var _0x384617=_0x186cb8;if(_0x13b88b[_0x384617(0x237)]==_0x384617(0x1d8)){if(_0x598aa1['product_name']==_0x13b88b[_0x384617(0x248)]&&_0x598aa1[_0x384617(0x217)]==_0x13b88b['floorlevel']&&_0x598aa1[_0x384617(0x237)]==_0x13b88b[_0x384617(0x237)]&&_0x598aa1[_0x384617(0x224)]==_0x13b88b[_0x384617(0x224)]&&_0x598aa1[_0x384617(0x25c)]==_0x13b88b[_0x384617(0x25c)]&&_0x598aa1[_0x384617(0x258)]==_0x13b88b[_0x384617(0x258)]&&_0x598aa1[_0x384617(0x25a)]==_0x13b88b['storage']&&_0x598aa1[_0x384617(0x1de)]==_0x13b88b[_0x384617(0x1de)]&&_0x598aa1[_0x384617(0x1dd)]==_0x13b88b[_0x384617(0x1dd)]&&_0x598aa1['production_date']==_0x13b88b[_0x384617(0x274)]&&_0x598aa1[_0x384617(0x1eb)]==_0x13b88b['invoice']){var _0x3a661e;_0x3a661e=_0x13b88b[_0x384617(0x243)],_0x13b88b[_0x384617(0x27f)]=='S'&&(_0x3a661e=_0x13b88b['adjust_qty']),_0x598aa1[_0x384617(0x26c)]=_0x598aa1[_0x384617(0x26c)]-_0x3a661e;}}else{if(_0x598aa1['product_name']==_0x13b88b['product_name']&&_0x598aa1[_0x384617(0x217)]==_0x13b88b[_0x384617(0x217)]&&_0x598aa1[_0x384617(0x237)]==_0x13b88b['type']&&_0x598aa1[_0x384617(0x224)]==_0x13b88b['bin']&&_0x598aa1['bay']==_0x13b88b['bay']&&_0x598aa1[_0x384617(0x258)]==_0x13b88b['rack']&&_0x598aa1[_0x384617(0x25a)]==_0x13b88b[_0x384617(0x25a)]&&_0x598aa1['expiry_date']==_0x13b88b[_0x384617(0x1de)]&&_0x598aa1[_0x384617(0x1dd)]==_0x13b88b[_0x384617(0x1dd)]&&_0x598aa1[_0x384617(0x274)]==_0x13b88b[_0x384617(0x274)]&&_0x598aa1[_0x384617(0x1eb)]==_0x13b88b[_0x384617(0x1eb)]){console[_0x384617(0x1bf)](_0x13b88b);var _0x3a661e;_0x3a661e=_0x13b88b['adjust_qty'],_0x13b88b[_0x384617(0x27f)]=='S'&&(_0x3a661e=_0x13b88b['adjust_qty']),console[_0x384617(0x1bf)](_0x3a661e+_0x384617(0x288)+_0x13b88b['adjust_qty']+_0x384617(0x288)+_0x598aa1[_0x384617(0x252)]+_0x384617(0x288)+_0x13b88b[_0x384617(0x27f)]),_0x598aa1[_0x384617(0x26c)]=_0x598aa1['product_stock']+_0x3a661e;}}});}return _0x50ba06;});Promise[_0x432c20(0x282)](_0x40225f)[_0x432c20(0x256)](async _0x420ecb=>{var _0x10897c=_0x432c20;try{for(const _0x1356e1 of _0x420ecb){await _0x1356e1[_0x10897c(0x262)]();}_0x2b5ab5[_0x10897c(0x278)]=_0x10897c(0x254);const _0x2321b8=await _0x2b5ab5['save'](),_0x26cb92=await master_shop[_0x10897c(0x265)](),_0x2d80df=await email_settings['findOne'](),_0x224bdb=await supervisor_settings[_0x10897c(0x265)]();var _0x15aa64=_0x2b5ab5['product'],_0x4dce38='',_0x42ce6a;for(_0x42ce6a in _0x15aa64){_0x4dce38+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15aa64[_0x42ce6a][_0x10897c(0x248)]+_0x10897c(0x264)+_0x10897c(0x22b)+_0x15aa64[_0x42ce6a][_0x10897c(0x289)]+_0x10897c(0x264)+_0x10897c(0x22b)+_0x15aa64[_0x42ce6a]['adjust_qty']+_0x10897c(0x264)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15aa64[_0x42ce6a][_0x10897c(0x27b)]+_0x10897c(0x264)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15aa64[_0x42ce6a][_0x10897c(0x247)]+_0x10897c(0x264)+_0x10897c(0x22b)+_0x2b5ab5[_0x10897c(0x1e4)]+'</td>'+_0x10897c(0x22b)+_0x15aa64[_0x42ce6a]['room_names']+_0x10897c(0x264)+_0x10897c(0x22b)+_0x15aa64[_0x42ce6a][_0x10897c(0x25a)]+_0x15aa64[_0x42ce6a][_0x10897c(0x258)]+_0x15aa64[_0x42ce6a][_0x10897c(0x25c)]+_0x15aa64[_0x42ce6a][_0x10897c(0x224)]+_0x15aa64[_0x42ce6a][_0x10897c(0x237)][0x0]+_0x15aa64[_0x42ce6a][_0x10897c(0x217)]+_0x10897c(0x264),'</tr>';}let _0x57e1a2=nodemailer[_0x10897c(0x221)]({'host':_0x2d80df[_0x10897c(0x1f0)],'port':Number(_0x2d80df[_0x10897c(0x25d)]),'secure':![],'auth':{'user':_0x2d80df[_0x10897c(0x212)],'pass':_0x2d80df['password']}}),_0x9a8d43={'from':_0x2d80df['email'],'to':_0x224bdb[0x0][_0x10897c(0x275)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x10897c(0x21e)+_0x10897c(0x272)+_0x26cb92[0x0][_0x10897c(0x23c)],'cid':'logo'}],'html':_0x10897c(0x259)+'<html><head><title></title>'+'</head><body>'+_0x10897c(0x1bb)+_0x10897c(0x1ec)+'<div>'+_0x10897c(0x276)+_0x10897c(0x230)+_0x10897c(0x1bb)+_0x10897c(0x1d0)+_0x26cb92[0x0]['site_title']+'\x20</h2>'+_0x10897c(0x230)+_0x10897c(0x230)+'<hr\x20class=\x22my-3\x22>'+_0x10897c(0x1bb)+_0x10897c(0x242)+_0x10897c(0x250)+_0x2b5ab5[_0x10897c(0x1eb)]+'\x20'+_0x10897c(0x1ef)+_0x10897c(0x24f)+_0x2b5ab5[_0x10897c(0x241)]+'\x20'+_0x10897c(0x1cd)+_0x10897c(0x1fa)+_0x10897c(0x230)+_0x10897c(0x266)+_0x10897c(0x1f2)+_0x10897c(0x1e6)+_0x10897c(0x206)+_0x10897c(0x216)+_0x10897c(0x28b)+_0x10897c(0x28a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x10897c(0x1ce)+_0x10897c(0x1e9)+_0x10897c(0x240)+_0x10897c(0x1ca)+_0x10897c(0x238)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4dce38+'\x20'+'</tbody>'+_0x10897c(0x209)+'<div>'+_0x10897c(0x24e)+_0x10897c(0x1d9)+_0x26cb92[0x0]['site_title']+_0x10897c(0x1fa)+_0x10897c(0x230)+_0x10897c(0x230)+_0x10897c(0x210)};_0x57e1a2[_0x10897c(0x1e1)](_0x9a8d43,function(_0x5eb8e5,_0x3fcdf7){var _0x491bbf=_0x10897c;_0x5eb8e5?(console[_0x491bbf(0x1bf)](_0x5eb8e5),console[_0x491bbf(0x1bf)](_0x491bbf(0x268))):console['log'](_0x491bbf(0x28c));}),_0x5ca064['flash'](_0x10897c(0x260),'adjustment\x20Finalized\x20successfully'),_0x4e29a7['redirect']('/picking_list/PDF_adjustment_rm/'+_0x2321b8[_0x10897c(0x1e8)]);}catch(_0x2d2c9b){console[_0x10897c(0x20f)](_0x2d2c9b),_0x4e29a7[_0x10897c(0x23f)](0x1f4)[_0x10897c(0x22e)]({'error':_0x10897c(0x222)});}})[_0x432c20(0x215)](_0x15f22a=>{var _0x278c23=_0x432c20;console[_0x278c23(0x20f)](_0x15f22a),_0x4e29a7[_0x278c23(0x23f)](0x1f4)[_0x278c23(0x22e)]({'error':_0x278c23(0x25e)});});}catch(_0x56871d){console[_0x432c20(0x1bf)](_0x56871d),_0x4e29a7['status'](0xc8)[_0x432c20(0x22e)]({'message':_0x56871d[_0x432c20(0x229)]});}}),router['get']('/view/:id',auth,async(_0x1bbc64,_0x47fdb0)=>{var _0x2a5582=a0_0x2dc917;try{const {username:_0x338746,email:_0x3f618f,role:_0x2f1bce}=_0x1bbc64['user'],_0x251ec8=_0x1bbc64[_0x2a5582(0x220)],_0x3a3c1b=await profile[_0x2a5582(0x24d)]({'email':_0x251ec8[_0x2a5582(0x212)]}),_0x3c8b7f=await master_shop[_0x2a5582(0x265)](),_0x46ca1f=_0x1bbc64[_0x2a5582(0x1db)]['id'],_0x3a913d=await adjustment['findById']({'_id':_0x46ca1f}),_0x14b884=await purchases[_0x2a5582(0x1fe)]([{'$match':{'warehouse_name':_0x3a913d[_0x2a5582(0x1e4)]}},{'$unwind':'$product'},{'$group':{'_id':_0x2a5582(0x22a)}}]),_0x40475b=await product[_0x2a5582(0x265)]({}),_0x2def46=await warehouse['aggregate']([{'$match':{'name':_0x3a913d['warehouse_name']}},{'$unwind':_0x2a5582(0x245)},{'$group':{'_id':_0x2a5582(0x1d3),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2a5582(0x21a)},'bay':{'$first':_0x2a5582(0x227)},'bin':{'$first':_0x2a5582(0x1ed)},'type':{'$first':_0x2a5582(0x267)},'floorlevel':{'$first':_0x2a5582(0x1e3)},'primary_code':{'$first':_0x2a5582(0x255)},'secondary_code':{'$first':_0x2a5582(0x286)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2a5582(0x1e7)},'rack':{'$first':_0x2a5582(0x1c9)},'maxPerUnit':{'$first':_0x2a5582(0x1c2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2a5582(0x21c)},'batch_code':{'$first':_0x2a5582(0x208)},'room':{'$first':_0x2a5582(0x1cc)}}}]);let _0xce4387;if(_0x251ec8['role']==_0x2a5582(0x1f8)){const _0x31be08=await staff[_0x2a5582(0x24d)]({'email':_0x251ec8[_0x2a5582(0x212)]});_0xce4387=await warehouse[_0x2a5582(0x1fe)]([{'$match':{'status':_0x2a5582(0x1c7),'name':_0x31be08[_0x2a5582(0x27e)],'warehouse_category':_0x2a5582(0x1c6),'name':{'$ne':_0x2a5582(0x1f4)}}},{'$group':{'_id':_0x2a5582(0x287),'name':{'$first':'$name'}}}]);}else _0xce4387=await warehouse['aggregate']([{'$match':{'status':_0x2a5582(0x1c7),'warehouse_category':_0x2a5582(0x1c6),'name':{'$ne':_0x2a5582(0x1f4)}}},{'$group':{'_id':_0x2a5582(0x287),'name':{'$first':'$name'}}}]);if(_0x3c8b7f[0x0][_0x2a5582(0x23b)]==_0x2a5582(0x28d)){var _0xec3537=users[_0x2a5582(0x1c3)];console[_0x2a5582(0x1bf)](_0xec3537);}else{if(_0x3c8b7f[0x0][_0x2a5582(0x23b)]==_0x2a5582(0x1ee))var _0xec3537=users[_0x2a5582(0x1ee)];else{if(_0x3c8b7f[0x0]['language']=='German')var _0xec3537=users['German'];else{if(_0x3c8b7f[0x0][_0x2a5582(0x23b)]==_0x2a5582(0x263))var _0xec3537=users[_0x2a5582(0x263)];else{if(_0x3c8b7f[0x0]['language']==_0x2a5582(0x281))var _0xec3537=users['French'];else{if(_0x3c8b7f[0x0][_0x2a5582(0x23b)]=='Portuguese\x20(BR)')var _0xec3537=users[_0x2a5582(0x1f3)];else{if(_0x3c8b7f[0x0][_0x2a5582(0x23b)]=='Chinese')var _0xec3537=users[_0x2a5582(0x1ff)];else{if(_0x3c8b7f[0x0][_0x2a5582(0x23b)]==_0x2a5582(0x1dc))var _0xec3537=users[_0x2a5582(0x20c)];}}}}}}}_0x47fdb0[_0x2a5582(0x269)](_0x2a5582(0x211),{'success':_0x1bbc64[_0x2a5582(0x279)]('success'),'errors':_0x1bbc64[_0x2a5582(0x279)](_0x2a5582(0x285)),'role':_0x251ec8,'profile':_0x3a3c1b,'adjustment':_0x3a913d,'stock':_0x2def46,'master_shop':_0x3c8b7f,'warehouse_name':_0x14b884,'unit':_0x40475b,'language':_0xec3537,'warehouse':_0xce4387});}catch(_0x45b4e6){console[_0x2a5582(0x1bf)](_0x45b4e6),_0x47fdb0[_0x2a5582(0x23f)](0xc8)[_0x2a5582(0x22e)]({'message':_0x45b4e6[_0x2a5582(0x229)]});}}),router[a0_0x2dc917(0x203)](a0_0x2dc917(0x236),auth,async(_0xf2a61a,_0x636540)=>{var _0x3306eb=a0_0x2dc917;try{const _0x1fbbb9=_0xf2a61a['params']['id'],_0x35bca0=await adjustment['findById']({'_id':_0x1fbbb9}),_0x234e1f=await warehouse[_0x3306eb(0x24d)]({'name':_0x35bca0['warehouse_name'],'room':_0x35bca0[_0x3306eb(0x239)]}),{warehouse_name:_0x4dab7a,date:_0x49e529,prod_name:_0x9a5718,level:_0x19ec44,isle:_0x508f68,pallet:_0x467c4c,stock:_0x30f446,types:_0x4132e7,adjust_qty:_0x58c760,new_adjust_qty:_0x1ec580,note:_0x1ddfa4,Room_name:_0x325386,invoice:_0x3b40ce,JO_number:_0x303f32,expiry_date:_0xb41d14}=_0xf2a61a[_0x3306eb(0x234)];if(typeof _0x9a5718==_0x3306eb(0x22d))var _0x2220f3=[_0xf2a61a[_0x3306eb(0x234)]['prod_name']],_0x5261dc=[_0xf2a61a[_0x3306eb(0x234)]['level']],_0x49a905=[_0xf2a61a[_0x3306eb(0x234)]['stock']],_0x3f9fab=[_0xf2a61a[_0x3306eb(0x234)]['types']],_0x3c5ed9=[_0xf2a61a['body'][_0x3306eb(0x270)]],_0x111a83=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1e5)]],_0x141dce=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x24a)]],_0x3edc29=[_0xf2a61a[_0x3306eb(0x234)]['Secondary_units']],_0x2f6a2e=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1e2)]],_0x31a95d=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1dd)]],_0x285ddc=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1de)]],_0x2344de=[_0xf2a61a[_0x3306eb(0x234)]['max_per_unit']],_0x3c6965=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x274)]],_0x298bd6=[_0xf2a61a['body']['prod_cat']],_0x4a1727=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x23d)]],_0x1e082a=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x253)]],_0x8cf143=[_0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x251)]];else var _0x2220f3=[..._0xf2a61a['body'][_0x3306eb(0x1c4)]],_0x5261dc=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1d7)]],_0x49a905=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x28f)]],_0x3f9fab=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x204)]],_0x3c5ed9=[..._0xf2a61a[_0x3306eb(0x234)]['New_Qty_Converted_adj']],_0x111a83=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1e5)]],_0x141dce=[..._0xf2a61a['body'][_0x3306eb(0x27b)]],_0x3edc29=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x20a)]],_0x2f6a2e=[..._0xf2a61a[_0x3306eb(0x234)]['prod_code']],_0x31a95d=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1dd)]],_0x285ddc=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x1de)]],_0x2344de=[..._0xf2a61a[_0x3306eb(0x234)]['max_per_unit']],_0x3c6965=[..._0xf2a61a[_0x3306eb(0x234)]['production_date']],_0x298bd6=[..._0xf2a61a['body'][_0x3306eb(0x27f)]],_0x4a1727=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x23d)]],_0x1e082a=[..._0xf2a61a[_0x3306eb(0x234)][_0x3306eb(0x253)]],_0x8cf143=[..._0xf2a61a['body'][_0x3306eb(0x251)]];const _0x49d990=_0x2220f3[_0x3306eb(0x21f)](_0x29386c=>{return _0x29386c={'product_name':_0x29386c};});_0x5261dc[_0x3306eb(0x1c1)]((_0x10b473,_0x217a7)=>{var _0x342abf=_0x3306eb;_0x4a1727[_0x342abf(0x1c1)]((_0x20e1b5,_0x59052b)=>{var _0x21cb64=_0x342abf;if(_0x20e1b5=='Receiving\x20Area'&&_0x217a7==_0x59052b){var _0x5a51ba=_0x10b473[_0x21cb64(0x22c)](0x3);_0x49d990[_0x217a7][_0x21cb64(0x25a)]=_0x10b473[0x0],_0x49d990[_0x217a7]['rack']=_0x10b473[0x1],_0x49d990[_0x217a7][_0x21cb64(0x25c)]=0x0,_0x49d990[_0x217a7][_0x21cb64(0x224)]=0x0,_0x49d990[_0x217a7]['type']=_0x21cb64(0x1f6),_0x49d990[_0x217a7][_0x21cb64(0x217)]=_0x5a51ba;}else{if(_0x20e1b5==_0x21cb64(0x218)&&_0x217a7==_0x59052b){var _0x5a51ba=_0x10b473[_0x21cb64(0x22c)](0x3);_0x49d990[_0x217a7]['storage']=_0x10b473[0x0],_0x49d990[_0x217a7][_0x21cb64(0x258)]=_0x10b473[0x1],_0x49d990[_0x217a7][_0x21cb64(0x25c)]=0x0,_0x49d990[_0x217a7][_0x21cb64(0x224)]=0x0,_0x49d990[_0x217a7]['type']='Floor',_0x49d990[_0x217a7][_0x21cb64(0x217)]=_0x10b473[0x5];}else{if(_0x217a7==_0x59052b){var _0x28930c;if(_0x10b473[0x4]=='L')_0x28930c='Level';else _0x10b473[0x4]=='F'&&(_0x28930c=_0x21cb64(0x1f6));_0x49d990[_0x217a7]['storage']=_0x10b473[0x0],_0x49d990[_0x217a7][_0x21cb64(0x258)]=_0x10b473[0x1],_0x49d990[_0x217a7]['bay']=_0x10b473[0x2],_0x49d990[_0x217a7][_0x21cb64(0x224)]=_0x10b473[0x3],_0x49d990[_0x217a7]['type']=_0x28930c,_0x49d990[_0x217a7]['floorlevel']=_0x10b473[0x5];}}}});}),_0x49a905[_0x3306eb(0x1c1)]((_0x2ceb76,_0xa1e689)=>{var _0x4a4c70=_0x3306eb;_0x49d990[_0xa1e689][_0x4a4c70(0x28e)]=_0x2ceb76;}),_0x3f9fab[_0x3306eb(0x1c1)]((_0x2b0e24,_0xa1a56a)=>{var _0xd15c3f=_0x3306eb;_0x49d990[_0xa1a56a][_0xd15c3f(0x204)]=_0x2b0e24;}),_0x3c5ed9['forEach']((_0xdd9ffb,_0x2a8224)=>{var _0x380cf0=_0x3306eb;_0x49d990[_0x2a8224][_0x380cf0(0x243)]=_0xdd9ffb;}),_0x111a83[_0x3306eb(0x1c1)]((_0x271fd4,_0x37fef6)=>{var _0x599f21=_0x3306eb;_0x49d990[_0x37fef6][_0x599f21(0x1bc)]=_0x271fd4;}),_0x141dce['forEach']((_0x376856,_0x679f63)=>{var _0xa8606f=_0x3306eb;_0x49d990[_0x679f63][_0xa8606f(0x27b)]=_0x376856;}),_0x3edc29['forEach']((_0x4ee0d1,_0x48e92a)=>{var _0x2614a4=_0x3306eb;_0x49d990[_0x48e92a][_0x2614a4(0x247)]=_0x4ee0d1;}),_0x2f6a2e[_0x3306eb(0x1c1)]((_0x4a5c4c,_0x4b4e36)=>{var _0x1cf802=_0x3306eb;_0x49d990[_0x4b4e36][_0x1cf802(0x289)]=_0x4a5c4c;}),_0x31a95d['forEach']((_0x69d14,_0x4311c1)=>{_0x49d990[_0x4311c1]['batch_code']=_0x69d14;}),_0x285ddc[_0x3306eb(0x1c1)]((_0x2478de,_0x11f5e7)=>{var _0x6886b9=_0x3306eb;_0x49d990[_0x11f5e7][_0x6886b9(0x1de)]=_0x2478de;}),_0x2344de['forEach']((_0x10a858,_0x455632)=>{_0x49d990[_0x455632]['maxperunit']=_0x10a858;}),_0x3c6965[_0x3306eb(0x1c1)]((_0x5f54ef,_0x5ac46b)=>{var _0x386973=_0x3306eb;_0x49d990[_0x5ac46b][_0x386973(0x274)]=_0x5f54ef;}),_0x298bd6[_0x3306eb(0x1c1)]((_0x4b2b47,_0x38a565)=>{_0x49d990[_0x38a565]['prod_cat']=_0x4b2b47;}),_0x4a1727['forEach']((_0x419713,_0x5b53eb)=>{var _0x16d53c=_0x3306eb;_0x49d990[_0x5b53eb][_0x16d53c(0x1f9)]=_0x419713;}),_0x1e082a['forEach']((_0x4a1d26,_0x29ae3b)=>{_0x49d990[_0x29ae3b]['primary_code']=_0x4a1d26;}),_0x8cf143[_0x3306eb(0x1c1)]((_0x566832,_0x5ad9eb)=>{_0x49d990[_0x5ad9eb]['secondary_code']=_0x566832;});const _0x546eb0=_0x49d990[_0x3306eb(0x21d)](_0x1f549f=>_0x1f549f[_0x3306eb(0x243)]!=='0'&&_0x1f549f[_0x3306eb(0x243)]!=='');var _0x54060c=0x0;_0x546eb0['forEach'](_0x4361b3=>{var _0x4d6506=_0x3306eb;console['log'](_0x4d6506(0x20e),_0x4361b3),parseInt(_0x4361b3[_0x4d6506(0x243)])<=0x0&&_0x54060c++;});if(_0x54060c!=0x0)return _0xf2a61a[_0x3306eb(0x279)](_0x3306eb(0x285),_0x3306eb(0x22f)),_0x636540[_0x3306eb(0x1fc)](_0x3306eb(0x24b));_0x35bca0[_0x3306eb(0x1e4)]=_0x4dab7a,_0x35bca0['date']=_0x49e529,_0x35bca0[_0x3306eb(0x228)]=_0x546eb0,_0x35bca0[_0x3306eb(0x231)]=_0x1ddfa4,_0x35bca0[_0x3306eb(0x1eb)]=_0x3b40ce,_0x35bca0[_0x3306eb(0x249)]=_0x3306eb(0x1d6);const _0x19a25b=await _0x35bca0[_0x3306eb(0x262)]();_0xf2a61a['flash']('success',_0x3306eb(0x225)),_0x636540[_0x3306eb(0x1fc)](_0x3306eb(0x280));}catch(_0x24ae06){console[_0x3306eb(0x1bf)](_0x24ae06);}}),router['post']('/barcode_scanner',async(_0x3d368d,_0x471d39)=>{var _0x15d3e7=a0_0x2dc917;const {primary_code:_0x131f8e,warehouse_data:_0x838450,rooms_data:_0x5df6fb,Roomslist:_0x260a15}=_0x3d368d[_0x15d3e7(0x234)],_0x2efcb2=_0x260a15[_0x15d3e7(0x1c5)](','),_0x25c3cf=[];async function _0x224138(_0x1d85ac){var _0x418c07=_0x15d3e7;const _0x2ea484=await warehouse[_0x418c07(0x1fe)]([{'$match':{'name':_0x838450,'room':_0x1d85ac}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x131f8e}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x418c07(0x1f7)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x418c07(0x255)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x418c07(0x1da)},'level':{'$first':_0x418c07(0x227)},'isle':{'$first':_0x418c07(0x1ed)},'type':{'$first':_0x418c07(0x267)},'pallet':{'$first':_0x418c07(0x1e3)},'unit':{'$first':_0x418c07(0x223)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x418c07(0x1e7)},'rack':{'$first':_0x418c07(0x1c9)},'expiry_date':{'$first':_0x418c07(0x205)},'production_date':{'$first':_0x418c07(0x21c)},'maxPerUnit':{'$first':_0x418c07(0x1c2)},'batch_code':{'$first':_0x418c07(0x208)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x418c07(0x1cc)}}}]),_0x10e8ff=await warehouse['aggregate']([{'$match':{'name':_0x838450,'room':_0x1d85ac}},{'$unwind':_0x418c07(0x245)},{'$match':{'product_details.secondary_code':_0x131f8e}},{'$group':{'_id':_0x418c07(0x1d3),'name':{'$first':_0x418c07(0x1f7)},'product_stock':{'$first':_0x418c07(0x21a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x418c07(0x286)},'product_code':{'$first':_0x418c07(0x1da)},'level':{'$first':_0x418c07(0x227)},'isle':{'$first':_0x418c07(0x1ed)},'type':{'$first':_0x418c07(0x267)},'pallet':{'$first':_0x418c07(0x1e3)},'unit':{'$first':_0x418c07(0x223)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x418c07(0x1e7)},'rack':{'$first':_0x418c07(0x1c9)},'expiry_date':{'$first':_0x418c07(0x205)},'production_date':{'$first':_0x418c07(0x21c)},'maxPerUnit':{'$first':_0x418c07(0x1c2)},'batch_code':{'$first':_0x418c07(0x208)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x418c07(0x1cc)}}}]);if(_0x2ea484[_0x418c07(0x26a)]>0x0)_0x25c3cf['push'](_0x2ea484);else _0x10e8ff[_0x418c07(0x26a)]>0x0&&_0x25c3cf[_0x418c07(0x200)](_0x10e8ff);}const _0x5e9d2d=_0x2efcb2[_0x15d3e7(0x21f)](_0x1b26f2=>_0x224138(_0x1b26f2));await Promise[_0x15d3e7(0x282)](_0x5e9d2d),_0x471d39['json'](_0x25c3cf);}),router[a0_0x2dc917(0x203)](a0_0x2dc917(0x201),async(_0x461c2b,_0x197757)=>{var _0x5dc9b6=a0_0x2dc917;const {primaryCode:_0x44a8ce,secondaryCode:_0x48c360,productCode:_0x324120,level:_0x4eab30,isle:_0x5875bc,pallet:_0x29b677,warehouses:_0x25c3fd,room:_0x293e31}=_0x461c2b[_0x5dc9b6(0x234)];try{const _0x1c492e=await warehouse[_0x5dc9b6(0x1fe)]([{'$match':{'name':_0x25c3fd,'room':_0x293e31}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x4eab30),'product_details.isle':_0x5875bc,'product_details.pallet':parseInt(_0x29b677)}},{'$group':{'_id':_0x5dc9b6(0x1d3),'name':{'$first':_0x5dc9b6(0x1f7)},'product_stock':{'$first':_0x5dc9b6(0x21a)},'level':{'$first':_0x5dc9b6(0x277)},'isle':{'$first':_0x5dc9b6(0x1f5)},'pallet':{'$first':_0x5dc9b6(0x214)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x197757[_0x5dc9b6(0x23f)](0xc8)[_0x5dc9b6(0x22e)](_0x1c492e);}catch(_0x57bf50){_0x197757[_0x5dc9b6(0x23f)](0x194)[_0x5dc9b6(0x22e)]({'message':_0x57bf50[_0x5dc9b6(0x229)]});}}),module[a0_0x2dc917(0x25b)]=router;