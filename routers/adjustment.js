var a0_0x3a7b0a=a0_0x3495;(function(_0x1c5712,_0x334db9){var _0x4b1371=a0_0x3495,_0x192f58=_0x1c5712();while(!![]){try{var _0x3a9072=-parseInt(_0x4b1371(0x190))/0x1+-parseInt(_0x4b1371(0x142))/0x2+parseInt(_0x4b1371(0x10d))/0x3*(-parseInt(_0x4b1371(0x1c2))/0x4)+parseInt(_0x4b1371(0x172))/0x5+-parseInt(_0x4b1371(0x1d5))/0x6*(-parseInt(_0x4b1371(0x1af))/0x7)+parseInt(_0x4b1371(0x157))/0x8*(-parseInt(_0x4b1371(0x169))/0x9)+parseInt(_0x4b1371(0x188))/0xa*(parseInt(_0x4b1371(0x180))/0xb);if(_0x3a9072===_0x334db9)break;else _0x192f58['push'](_0x192f58['shift']());}catch(_0x4ae1e8){_0x192f58['push'](_0x192f58['shift']());}}}(a0_0x4a7a,0x8829c));const express=require(a0_0x3a7b0a(0x185)),app=express(),router=express[a0_0x3a7b0a(0x1c3)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x3a7b0a(0x128)),users=require(a0_0x3a7b0a(0x127)),nodemailer=require(a0_0x3a7b0a(0x1c5));function a0_0x4a7a(){var _0x54c233=['findById','$warehouse_name','Arabic\x20(ae)','/../public','expiry_date','314250vaXAJW','adjustment\x20data\x20update\x20successfully','</span>','product_stock','render','adjustment\x20add\x20successfull','/barcode_scanner','$product_details.secondary_unit','Chinese','params','user','product_code','$product_details.storage','/adjustment/view','Level','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','json','maxPerUnit','<h2>\x20','prod_invoice','$product_details.bay','room','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','German','../public/language/languages.json','../models/all_models','adjustment\x20Finalized\x20successfully','_id','$product_details.level','flash','Portuguese\x20(BR)','/adjustment/preview/','toString','password','New_Qty_Converted','/view/:id','warehouse','invoice','$product_details.primary_code','$product_details.maxPerUnit','$product_details._id','catch','Return\x20Goods','prime1','Arabic','production_date','Raw\x20Materials','note','isAllowEdit','Enabled','forEach','1918718RHSGlJ','$product.room_names','Ambient','True','finalize','date','push','$product_details.product_name','role','$product','product_name','bay','/view/add_adjustment','length','Rooms','image','floor','French','$product_details.product_cat','logo','message','733112vYheWg','Enclosed','<h5\x20style=\x22text-align:\x20left;\x22>','findOne','Primary_Units','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','\x20</h2>','$product_details.product_stock','redirect','string','types','host','An\x20error\x20occurred.','maxperunit','email','padStart','stock','$product_details.pallet','9yPpPqe','</table>','room_names','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','</h5>','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','split','1506665AMdeyD','product','error','storage','second1','find','prod_cat','English','back','prod_name','Adjustment\x20Mail','$product_details.production_date','$product_details.rack','<h5>','2265274kiBwkp','body','$product_details.product_code','$product_details.bin','</tbody>','express','site_title','language','80bQfHaO','<div>','warehouse_name','<strong>\x20Regards\x20</strong>','<hr\x20class=\x22my-3\x22>','bin','port','all','1070287Obshfz','primary_code','post','edit_adjustment_view','max_per_unit','$product_details.secondary_code','floorlevel','Spanish','$invoice','$product_details.type','$product_details.expiry_date','Error\x20Occurs','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.batch_code','$product_details.maxProducts','</body></html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','errors','English\x20(US)','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','New_Qty_Converted_adj','$isAllowEdit','random','$product.product_name','<!DOCTYPE\x20html>','filter','$room','type','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<tr>','7TVwOgI','stockBefore','rack','Logo.png','unit','/view','level','$product_details.floorlevel','aggregate','Secondary_units','staff','Return\x20Rooms','$product_details.isle','log','add_adjustment','then','Shelves','save','Hindi','12ZcAKEf','Router','/preview/:id','nodemailer','$name','Email\x20sent\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','map','Portuguese','</tr>','batch_code','/upload/','Receiving\x20Area','secondary_unit','slice','ADJ-','</td>','RMSEmail','get','6266724IrLTGC','new_adjust_qty','secondary_code','Floor','prod_code','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/picking_list/PDF_adjustment_rm/','\x20<>\x20','foreach\x20newproduct','edit_adjustment','adjust_qty','success','/CheckingWarehouse','status'];a0_0x4a7a=function(){return _0x54c233;};return a0_0x4a7a();}router[a0_0x3a7b0a(0x1d4)](a0_0x3a7b0a(0x1b4),auth,async(_0x2288b0,_0x5e7c33)=>{var _0x192ae6=a0_0x3a7b0a;try{const {username:_0x5e98d0,email:_0x2e11f5,role:_0x5b8db6}=_0x2288b0['user'],_0x4deab0=_0x2288b0['user'],_0x53c5d9=await profile[_0x192ae6(0x15a)]({'email':_0x4deab0[_0x192ae6(0x165)]}),_0x554293=await master_shop[_0x192ae6(0x177)]();console['log']('master',_0x554293);let _0x449f44;if(_0x4deab0[_0x192ae6(0x14a)]==_0x192ae6(0x1b9)){const _0x5e9196=await staff[_0x192ae6(0x15a)]({'email':_0x4deab0['email']});_0x449f44=await warehouse[_0x192ae6(0x177)]({'status':_0x192ae6(0x140),'name':_0x5e9196[_0x192ae6(0x133)]});}else _0x449f44=await warehouse[_0x192ae6(0x177)]({'status':_0x192ae6(0x140)});const _0x14f52d=await product[_0x192ae6(0x177)]();let _0x513aa7;if(_0x4deab0[_0x192ae6(0x14a)]==_0x192ae6(0x1b9)){const _0x5bc49f=await staff[_0x192ae6(0x15a)]({'email':_0x4deab0[_0x192ae6(0x165)]});_0x513aa7=await adjustment[_0x192ae6(0x177)]({'warehouse_name':_0x5bc49f[_0x192ae6(0x133)]});}else _0x513aa7=await adjustment['aggregate']([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x192ae6(0x198)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x192ae6(0x109)},'room':{'$addToSet':_0x192ae6(0x143)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x192ae6(0x1a6)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x554293[0x0]['language']==_0x192ae6(0x1a3)){var _0x1a7728=users[_0x192ae6(0x179)];console[_0x192ae6(0x1bc)](_0x1a7728);}else{if(_0x554293[0x0]['language']==_0x192ae6(0x1c1))var _0x1a7728=users[_0x192ae6(0x1c1)];else{if(_0x554293[0x0][_0x192ae6(0x187)]==_0x192ae6(0x126))var _0x1a7728=users[_0x192ae6(0x126)];else{if(_0x554293[0x0][_0x192ae6(0x187)]==_0x192ae6(0x197))var _0x1a7728=users[_0x192ae6(0x197)];else{if(_0x554293[0x0]['language']==_0x192ae6(0x153))var _0x1a7728=users[_0x192ae6(0x153)];else{if(_0x554293[0x0][_0x192ae6(0x187)]==_0x192ae6(0x12d))var _0x1a7728=users[_0x192ae6(0x1ca)];else{if(_0x554293[0x0]['language']=='Chinese')var _0x1a7728=users[_0x192ae6(0x115)];else{if(_0x554293[0x0][_0x192ae6(0x187)]=='Arabic\x20(ae)')var _0x1a7728=users['Arabic'];}}}}}}}_0x5e7c33[_0x192ae6(0x111)]('adjustment',{'success':_0x2288b0['flash'](_0x192ae6(0x1e1)),'errors':_0x2288b0[_0x192ae6(0x12c)](_0x192ae6(0x1a2)),'role':_0x4deab0,'profile':_0x53c5d9,'warehouse':_0x449f44,'product':_0x14f52d,'adjustment':_0x513aa7,'master_shop':_0x554293,'language':_0x1a7728});}catch(_0x2f2be9){console[_0x192ae6(0x1bc)](_0x2f2be9);}});async function getRandom8DigitNumber(){var _0x2f4b14=a0_0x3a7b0a;const _0x41319b=0x989680,_0x3acd66=0x5f5e0ff,_0x4f4aca=Math[_0x2f4b14(0x152)](Math[_0x2f4b14(0x1a7)]()*(_0x3acd66-_0x41319b+0x1))+_0x41319b;var _0x405d8f;const _0x285d1a=await adjustment[_0x2f4b14(0x15a)]({'invoice':_0x2f4b14(0x1d1)+_0x4f4aca});return _0x285d1a&&_0x285d1a[_0x2f4b14(0x14f)]>0x0?_0x405d8f=_0x2f4b14(0x1d1)+_0x4f4aca:_0x405d8f=_0x2f4b14(0x1d1)+_0x4f4aca,_0x405d8f;}function a0_0x3495(_0x558023,_0x17a8c4){var _0x4a7ae5=a0_0x4a7a();return a0_0x3495=function(_0x349530,_0x443e70){_0x349530=_0x349530-0x109;var _0x7445b9=_0x4a7ae5[_0x349530];return _0x7445b9;},a0_0x3495(_0x558023,_0x17a8c4);}router['get'](a0_0x3a7b0a(0x14e),auth,async(_0xe51d38,_0x14207c)=>{var _0x5d655a=a0_0x3a7b0a;try{const {username:_0x345ee1,email:_0x16f715,role:_0x577289}=_0xe51d38[_0x5d655a(0x117)],_0x357362=_0xe51d38[_0x5d655a(0x117)],_0x166de2=await profile[_0x5d655a(0x15a)]({'email':_0x357362['email']}),_0x7e7306=await master_shop[_0x5d655a(0x177)]();let _0x580191;if(_0x357362[_0x5d655a(0x14a)]==_0x5d655a(0x1b9)){const _0x4928c3=await staff['findOne']({'email':_0x357362[_0x5d655a(0x165)]});_0x580191=await warehouse[_0x5d655a(0x1b7)]([{'$match':{'status':_0x5d655a(0x140),'name':_0x4928c3[_0x5d655a(0x133)],'warehouse_category':_0x5d655a(0x13d),'name':{'$ne':_0x5d655a(0x139)}}},{'$group':{'_id':_0x5d655a(0x1c6),'name':{'$first':_0x5d655a(0x1c6)}}}]);}else _0x580191=await warehouse[_0x5d655a(0x1b7)]([{'$match':{'status':_0x5d655a(0x140),'warehouse_category':_0x5d655a(0x13d),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x5d655a(0x1c6),'name':{'$first':_0x5d655a(0x1c6)}}}]);const _0x211d45=await product[_0x5d655a(0x177)]({}),_0x38b0b7=await adjustment[_0x5d655a(0x177)]({}),_0x319960=_0x38b0b7[_0x5d655a(0x14f)]+0x1,_0x48d3c3=_0x5d655a(0x1d1)+_0x319960[_0x5d655a(0x12f)]()[_0x5d655a(0x166)](0x5,'0');var _0x3bbb47=[_0x5d655a(0x144),_0x5d655a(0x158),_0x5d655a(0x1ba)];if(_0x7e7306[0x0][_0x5d655a(0x187)]=='English\x20(US)')var _0x32b38a=users['English'];else{if(_0x7e7306[0x0][_0x5d655a(0x187)]==_0x5d655a(0x1c1))var _0x32b38a=users[_0x5d655a(0x1c1)];else{if(_0x7e7306[0x0][_0x5d655a(0x187)]==_0x5d655a(0x126))var _0x32b38a=users[_0x5d655a(0x126)];else{if(_0x7e7306[0x0]['language']==_0x5d655a(0x197))var _0x32b38a=users[_0x5d655a(0x197)];else{if(_0x7e7306[0x0][_0x5d655a(0x187)]==_0x5d655a(0x153))var _0x32b38a=users[_0x5d655a(0x153)];else{if(_0x7e7306[0x0][_0x5d655a(0x187)]==_0x5d655a(0x12d))var _0x32b38a=users[_0x5d655a(0x1ca)];else{if(_0x7e7306[0x0][_0x5d655a(0x187)]==_0x5d655a(0x115))var _0x32b38a=users[_0x5d655a(0x115)];else{if(_0x7e7306[0x0][_0x5d655a(0x187)]==_0x5d655a(0x10a))var _0x32b38a=users[_0x5d655a(0x13b)];}}}}}}}const _0x390c17=getRandom8DigitNumber();_0x390c17[_0x5d655a(0x1be)](_0x2b1ad9=>{var _0x289a64=_0x5d655a;_0x14207c[_0x289a64(0x111)](_0x289a64(0x1bd),{'success':_0xe51d38[_0x289a64(0x12c)]('success'),'errors':_0xe51d38['flash']('errors'),'role':_0x357362,'profile':_0x166de2,'warehouse':_0x580191,'product':_0x211d45,'master_shop':_0x7e7306,'language':_0x32b38a,'rooms_data':_0x3bbb47,'invoice_no':_0x2b1ad9});})['catch'](_0x4e9e05=>{var _0xa586d9=_0x5d655a;_0xe51d38[_0xa586d9(0x12c)](_0xa586d9(0x1a2),_0xa586d9(0x1ad)),_0x14207c[_0xa586d9(0x15f)]('/adjustment/view');});}catch(_0x56319a){console['log'](_0x56319a);}}),router['post']('/view/add_adjustment',auth,async(_0x1069bc,_0x56119c)=>{var _0x13acef=a0_0x3a7b0a;try{const {warehouse_name:_0x569a61,date:_0x5bc6e1,prod_name:_0x23fd54,level:_0x21da3b,isle:_0x9d079d,pallet:_0x2126d5,stock:_0x33e563,types:_0x52011c,adjust_qty:_0x551881,new_adjust_qty:_0x7ed3f7,note:_0x5b816f,Room_name:_0x1c8461,invoice:_0x28bc10,JO_number:_0x1e6177,expiry_date:_0x5d000b}=_0x1069bc[_0x13acef(0x181)];if(typeof _0x23fd54==_0x13acef(0x160))var _0x27dd99=[_0x1069bc['body'][_0x13acef(0x17b)]],_0x3e31a3=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x1b5)]],_0x5a918c=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x167)]],_0x5b8974=[_0x1069bc[_0x13acef(0x181)]['types']],_0x289239=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x1a5)]],_0x31f307=[_0x1069bc['body'][_0x13acef(0x131)]],_0x88cb11=[_0x1069bc[_0x13acef(0x181)]['Primary_Units']],_0x2bfaf4=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x1b8)]],_0x46eb32=[_0x1069bc['body']['prod_code']],_0x1fd68a=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x1cc)]],_0x1a0ec7=[_0x1069bc['body']['expiry_date']],_0x695696=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x194)]],_0x185e4b=[_0x1069bc[_0x13acef(0x181)]['production_date']],_0x4ec9b1=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x178)]],_0x26c589=[_0x1069bc['body']['Rooms']],_0x3f96ae=[_0x1069bc['body'][_0x13acef(0x13a)]],_0x401f1e=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x176)]],_0x22fe18=[_0x1069bc[_0x13acef(0x181)][_0x13acef(0x120)]];else var _0x27dd99=[..._0x1069bc['body']['prod_name']],_0x3e31a3=[..._0x1069bc['body'][_0x13acef(0x1b5)]],_0x5a918c=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x167)]],_0x5b8974=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x161)]],_0x289239=[..._0x1069bc[_0x13acef(0x181)]['New_Qty_Converted_adj']],_0x31f307=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x131)]],_0x88cb11=[..._0x1069bc[_0x13acef(0x181)]['unit']],_0x2bfaf4=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x1b8)]],_0x46eb32=[..._0x1069bc['body'][_0x13acef(0x1d9)]],_0x1fd68a=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x1cc)]],_0x1a0ec7=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x10c)]],_0x695696=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x194)]],_0x185e4b=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x13c)]],_0x4ec9b1=[..._0x1069bc['body']['prod_cat']],_0x26c589=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x150)]],_0x3f96ae=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x13a)]],_0x401f1e=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x176)]],_0x22fe18=[..._0x1069bc[_0x13acef(0x181)][_0x13acef(0x120)]];const _0x3b4a68=_0x27dd99[_0x13acef(0x1c9)](_0x4d7d62=>{return _0x4d7d62={'product_name':_0x4d7d62};});_0x3e31a3[_0x13acef(0x141)]((_0x5e56d2,_0x1393a4)=>{var _0x1044e3=_0x13acef;_0x26c589[_0x1044e3(0x141)]((_0x4ed24b,_0x9c2a06)=>{var _0xb53b76=_0x1044e3;if(_0x4ed24b==_0xb53b76(0x1ce)&&_0x1393a4==_0x9c2a06){var _0x59aafd=_0x5e56d2[_0xb53b76(0x1d0)](0x3);_0x3b4a68[_0x1393a4][_0xb53b76(0x175)]=_0x5e56d2[0x0],_0x3b4a68[_0x1393a4][_0xb53b76(0x1b1)]=_0x5e56d2[0x1],_0x3b4a68[_0x1393a4][_0xb53b76(0x14d)]=0x0,_0x3b4a68[_0x1393a4][_0xb53b76(0x18d)]=0x0,_0x3b4a68[_0x1393a4][_0xb53b76(0x1ac)]=_0xb53b76(0x1d8),_0x3b4a68[_0x1393a4][_0xb53b76(0x196)]=_0x59aafd;}else{if(_0x4ed24b==_0xb53b76(0x1bf)&&_0x1393a4==_0x9c2a06){var _0x59aafd=_0x5e56d2[_0xb53b76(0x1d0)](0x3);_0x3b4a68[_0x1393a4][_0xb53b76(0x175)]=_0x5e56d2[0x0],_0x3b4a68[_0x1393a4][_0xb53b76(0x1b1)]=_0x5e56d2[0x1],_0x3b4a68[_0x1393a4][_0xb53b76(0x14d)]=0x0,_0x3b4a68[_0x1393a4]['bin']=0x0,_0x3b4a68[_0x1393a4][_0xb53b76(0x1ac)]='Floor',_0x3b4a68[_0x1393a4][_0xb53b76(0x196)]=_0x5e56d2[0x5];}else{if(_0x1393a4==_0x9c2a06){var _0x989809;if(_0x5e56d2[0x4]=='L')_0x989809=_0xb53b76(0x11b);else _0x5e56d2[0x4]=='F'&&(_0x989809=_0xb53b76(0x1d8));_0x3b4a68[_0x1393a4][_0xb53b76(0x175)]=_0x5e56d2[0x0],_0x3b4a68[_0x1393a4][_0xb53b76(0x1b1)]=_0x5e56d2[0x1],_0x3b4a68[_0x1393a4][_0xb53b76(0x14d)]=_0x5e56d2[0x2],_0x3b4a68[_0x1393a4][_0xb53b76(0x18d)]=_0x5e56d2[0x3],_0x3b4a68[_0x1393a4][_0xb53b76(0x1ac)]=_0x989809,_0x3b4a68[_0x1393a4][_0xb53b76(0x196)]=_0x5e56d2[0x5];}}}});}),_0x5a918c[_0x13acef(0x141)]((_0x383eaf,_0x1716ea)=>{var _0x53af57=_0x13acef;_0x3b4a68[_0x1716ea][_0x53af57(0x1b0)]=_0x383eaf;}),_0x5b8974[_0x13acef(0x141)]((_0x5d6ec9,_0x2f8591)=>{var _0x5104fd=_0x13acef;_0x3b4a68[_0x2f8591][_0x5104fd(0x161)]=_0x5d6ec9;}),_0x289239['forEach']((_0x1a920f,_0x4b0f64)=>{var _0x7ef43f=_0x13acef;_0x3b4a68[_0x4b0f64][_0x7ef43f(0x1e0)]=_0x1a920f;}),_0x31f307['forEach']((_0x5bf48d,_0x6b9e6f)=>{var _0x5a27a3=_0x13acef;_0x3b4a68[_0x6b9e6f][_0x5a27a3(0x1d6)]=_0x5bf48d;}),_0x88cb11[_0x13acef(0x141)]((_0x33cd5e,_0xdc23df)=>{_0x3b4a68[_0xdc23df]['unit']=_0x33cd5e;}),_0x2bfaf4[_0x13acef(0x141)]((_0x2d63f9,_0x4a9b70)=>{var _0xea4553=_0x13acef;_0x3b4a68[_0x4a9b70][_0xea4553(0x1cf)]=_0x2d63f9;}),_0x46eb32[_0x13acef(0x141)]((_0x1be4da,_0x1d4e24)=>{var _0x5b6686=_0x13acef;_0x3b4a68[_0x1d4e24][_0x5b6686(0x118)]=_0x1be4da;}),_0x1fd68a[_0x13acef(0x141)]((_0x17a447,_0x822934)=>{var _0x15e77b=_0x13acef;_0x3b4a68[_0x822934][_0x15e77b(0x1cc)]=_0x17a447;}),_0x1a0ec7[_0x13acef(0x141)]((_0xb7ac79,_0x4ce2c2)=>{var _0xb2ea5=_0x13acef;_0x3b4a68[_0x4ce2c2][_0xb2ea5(0x10c)]=_0xb7ac79;}),_0x695696['forEach']((_0x4533aa,_0x122b5c)=>{_0x3b4a68[_0x122b5c]['maxperunit']=_0x4533aa;}),_0x185e4b[_0x13acef(0x141)]((_0x139713,_0x2c02c9)=>{var _0x1e2e37=_0x13acef;_0x3b4a68[_0x2c02c9][_0x1e2e37(0x13c)]=_0x139713;}),_0x4ec9b1['forEach']((_0x4aeed9,_0x588477)=>{_0x3b4a68[_0x588477]['prod_cat']=_0x4aeed9;}),_0x26c589[_0x13acef(0x141)]((_0x116b1a,_0x3557c0)=>{var _0x1eac6a=_0x13acef;_0x3b4a68[_0x3557c0][_0x1eac6a(0x16b)]=_0x116b1a;}),_0x3f96ae[_0x13acef(0x141)]((_0x26f5f1,_0x471033)=>{var _0xf1884e=_0x13acef;_0x3b4a68[_0x471033][_0xf1884e(0x191)]=_0x26f5f1;}),_0x401f1e['forEach']((_0x41681c,_0x4a0ae2)=>{var _0x3a5773=_0x13acef;_0x3b4a68[_0x4a0ae2][_0x3a5773(0x1d7)]=_0x41681c;}),_0x22fe18['forEach']((_0x2b7422,_0x219922)=>{_0x3b4a68[_0x219922]['invoice']=_0x2b7422;});const _0x1eb5f9=_0x3b4a68[_0x13acef(0x1aa)](_0x1352e7=>_0x1352e7[_0x13acef(0x1e0)]!=='0'&&_0x1352e7['adjust_qty']!=='');var _0x5ba253=0x0;_0x1eb5f9[_0x13acef(0x141)](_0x1aca90=>{console['log']('foreach\x20newproduct',_0x1aca90),parseInt(_0x1aca90['adjust_qty'])<=0x0&&_0x5ba253++;});if(_0x5ba253!=0x0)return _0x1069bc['flash'](_0x13acef(0x1a2),_0x13acef(0x11c)),_0x56119c[_0x13acef(0x15f)](_0x13acef(0x17a));const _0x40c8f5=new adjustment({'warehouse_name':_0x569a61,'date':_0x5bc6e1,'product':_0x1eb5f9,'note':_0x5b816f,'room':_0x1c8461,'invoice':_0x28bc10,'JO_number':_0x1e6177,'expiry_date':_0x5d000b}),_0x11528f=await _0x40c8f5[_0x13acef(0x1c0)]();_0x1069bc[_0x13acef(0x12c)](_0x13acef(0x1e1),_0x13acef(0x112)),_0x56119c[_0x13acef(0x15f)](_0x13acef(0x12e)+_0x11528f[_0x13acef(0x12a)]);}catch(_0x4555b8){console[_0x13acef(0x1bc)](_0x4555b8),_0x56119c[_0x13acef(0x1e3)](0xc8)['json']({'message':_0x4555b8[_0x13acef(0x156)]});}}),router[a0_0x3a7b0a(0x1d4)](a0_0x3a7b0a(0x1c4),auth,async(_0x3d2d87,_0x5463dc)=>{var _0x26bde9=a0_0x3a7b0a;try{const {username:_0x3f7099,email:_0x3d07a2,role:_0x410b67}=_0x3d2d87[_0x26bde9(0x117)],_0x47a886=_0x3d2d87[_0x26bde9(0x117)],_0x136d72=await profile[_0x26bde9(0x15a)]({'email':_0x47a886[_0x26bde9(0x165)]}),_0x5c6ebb=await master_shop[_0x26bde9(0x177)](),_0x1a8678=_0x3d2d87[_0x26bde9(0x116)]['id'],_0x482c4d=await adjustment[_0x26bde9(0x1e4)]({'_id':_0x1a8678}),_0x1813c6=await purchases['aggregate']([{'$match':{'warehouse_name':_0x482c4d['warehouse_name']}},{'$unwind':_0x26bde9(0x14b)},{'$group':{'_id':_0x26bde9(0x1a8)}}]),_0x5bd226=await product['find']({}),_0x3dab04=await warehouse[_0x26bde9(0x1b7)]([{'$match':{'name':_0x482c4d[_0x26bde9(0x18a)]}},{'$unwind':_0x26bde9(0x16c)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x26bde9(0x15e)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x26bde9(0x183)},'type':{'$first':_0x26bde9(0x199)},'floorlevel':{'$first':_0x26bde9(0x1b6)},'primary_code':{'$first':_0x26bde9(0x135)},'secondary_code':{'$first':_0x26bde9(0x195)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x26bde9(0x119)},'rack':{'$first':_0x26bde9(0x17e)},'maxPerUnit':{'$first':_0x26bde9(0x136)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x26bde9(0x19e)},'room':{'$first':_0x26bde9(0x1ab)}}}]);if(_0x5c6ebb[0x0]['language']==_0x26bde9(0x1a3)){var _0x297e69=users[_0x26bde9(0x179)];console['log'](_0x297e69);}else{if(_0x5c6ebb[0x0]['language']==_0x26bde9(0x1c1))var _0x297e69=users[_0x26bde9(0x1c1)];else{if(_0x5c6ebb[0x0][_0x26bde9(0x187)]==_0x26bde9(0x126))var _0x297e69=users['German'];else{if(_0x5c6ebb[0x0][_0x26bde9(0x187)]==_0x26bde9(0x197))var _0x297e69=users[_0x26bde9(0x197)];else{if(_0x5c6ebb[0x0][_0x26bde9(0x187)]==_0x26bde9(0x153))var _0x297e69=users[_0x26bde9(0x153)];else{if(_0x5c6ebb[0x0][_0x26bde9(0x187)]==_0x26bde9(0x12d))var _0x297e69=users[_0x26bde9(0x1ca)];else{if(_0x5c6ebb[0x0]['language']==_0x26bde9(0x115))var _0x297e69=users[_0x26bde9(0x115)];else{if(_0x5c6ebb[0x0][_0x26bde9(0x187)]==_0x26bde9(0x10a))var _0x297e69=users['Arabic'];}}}}}}}_0x5463dc[_0x26bde9(0x111)](_0x26bde9(0x193),{'success':_0x3d2d87[_0x26bde9(0x12c)](_0x26bde9(0x1e1)),'errors':_0x3d2d87[_0x26bde9(0x12c)]('errors'),'role':_0x47a886,'profile':_0x136d72,'adjustment':_0x482c4d,'stock':_0x3dab04,'master_shop':_0x5c6ebb,'warehouse_name':_0x1813c6,'unit':_0x5bd226,'language':_0x297e69});}catch(_0x2b5232){console['log'](_0x2b5232),_0x5463dc[_0x26bde9(0x1e3)](0xc8)[_0x26bde9(0x11d)]({'message':_0x2b5232['message']});}}),router[a0_0x3a7b0a(0x192)](a0_0x3a7b0a(0x1c4),auth,async(_0x2ec993,_0x173e40)=>{var _0x3e63ae=a0_0x3a7b0a;try{const _0x5d2020=_0x2ec993[_0x3e63ae(0x116)]['id'],{warehouse_name:_0x7bdde8,Room_name:_0x5b2f5c}=_0x2ec993['body'],_0x251f69=await adjustment['findById']({'_id':_0x5d2020}),_0x3d8bc8=_0x251f69[_0x3e63ae(0x173)][_0x3e63ae(0x1c9)](async _0x358762=>{var _0x153eab=_0x3e63ae;if(_0x358762['adjust_qty']>0x0){var _0x5511d2=await warehouse[_0x153eab(0x15a)]({'name':_0x7bdde8,'room':_0x358762[_0x153eab(0x16b)],'warehouse_category':_0x153eab(0x13d)});const _0x2ebc98=_0x5511d2[_0x153eab(0x16f)][_0x153eab(0x1c9)](_0x3fb5dd=>{var _0x486f29=_0x153eab;if(_0x358762[_0x486f29(0x1ac)]=='minus'){if(_0x3fb5dd['product_name']==_0x358762['product_name']&&_0x3fb5dd[_0x486f29(0x196)]==_0x358762[_0x486f29(0x196)]&&_0x3fb5dd['type']==_0x358762[_0x486f29(0x1ac)]&&_0x3fb5dd['bin']==_0x358762['bin']&&_0x3fb5dd[_0x486f29(0x14d)]==_0x358762[_0x486f29(0x14d)]&&_0x3fb5dd['rack']==_0x358762[_0x486f29(0x1b1)]&&_0x3fb5dd[_0x486f29(0x175)]==_0x358762[_0x486f29(0x175)]&&_0x3fb5dd[_0x486f29(0x10c)]==_0x358762['expiry_date']&&_0x3fb5dd[_0x486f29(0x1cc)]==_0x358762[_0x486f29(0x1cc)]&&_0x3fb5dd[_0x486f29(0x13c)]==_0x358762[_0x486f29(0x13c)]&&_0x3fb5dd[_0x486f29(0x134)]==_0x358762[_0x486f29(0x134)]){var _0x5a01ee;_0x5a01ee=_0x358762['adjust_qty'],_0x358762[_0x486f29(0x178)]=='S'&&(_0x5a01ee=_0x358762[_0x486f29(0x1e0)]),_0x3fb5dd['product_stock']=_0x3fb5dd[_0x486f29(0x110)]-_0x5a01ee;}}else{if(_0x3fb5dd[_0x486f29(0x14c)]==_0x358762[_0x486f29(0x14c)]&&_0x3fb5dd[_0x486f29(0x196)]==_0x358762[_0x486f29(0x196)]&&_0x3fb5dd['type']==_0x358762[_0x486f29(0x1ac)]&&_0x3fb5dd[_0x486f29(0x18d)]==_0x358762[_0x486f29(0x18d)]&&_0x3fb5dd[_0x486f29(0x14d)]==_0x358762[_0x486f29(0x14d)]&&_0x3fb5dd['rack']==_0x358762['rack']&&_0x3fb5dd[_0x486f29(0x175)]==_0x358762['storage']&&_0x3fb5dd[_0x486f29(0x10c)]==_0x358762['expiry_date']&&_0x3fb5dd['batch_code']==_0x358762[_0x486f29(0x1cc)]&&_0x3fb5dd[_0x486f29(0x13c)]==_0x358762[_0x486f29(0x13c)]&&_0x3fb5dd[_0x486f29(0x134)]==_0x358762['invoice']){console['log'](_0x358762);var _0x5a01ee;_0x5a01ee=_0x358762[_0x486f29(0x1e0)],_0x358762[_0x486f29(0x178)]=='S'&&(_0x5a01ee=_0x358762[_0x486f29(0x1e0)]),console[_0x486f29(0x1bc)](_0x5a01ee+_0x486f29(0x1dd)+_0x358762[_0x486f29(0x1e0)]+'\x20<>\x20'+_0x3fb5dd[_0x486f29(0x11e)]+'\x20<>\x20'+_0x358762[_0x486f29(0x178)]),_0x3fb5dd[_0x486f29(0x110)]=_0x3fb5dd[_0x486f29(0x110)]+_0x5a01ee;}}});}return _0x5511d2;});Promise[_0x3e63ae(0x18f)](_0x3d8bc8)[_0x3e63ae(0x1be)](async _0x5a442a=>{var _0x49b768=_0x3e63ae;try{for(const _0x1d4f22 of _0x5a442a){await _0x1d4f22[_0x49b768(0x1c0)]();}_0x251f69[_0x49b768(0x146)]=_0x49b768(0x145);const _0x399637=await _0x251f69['save'](),_0x27fca9=await master_shop['find'](),_0x278d08=await email_settings['findOne'](),_0x2c0f41=await supervisor_settings[_0x49b768(0x177)]();var _0x56a82d=_0x251f69['product'],_0x65791a='',_0x47670e;for(_0x47670e in _0x56a82d){_0x65791a+=_0x49b768(0x1ae)+_0x49b768(0x125)+_0x56a82d[_0x47670e]['product_name']+'</td>'+_0x49b768(0x125)+_0x56a82d[_0x47670e][_0x49b768(0x118)]+_0x49b768(0x1d2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x56a82d[_0x47670e][_0x49b768(0x1e0)]+_0x49b768(0x1d2)+_0x49b768(0x125)+_0x56a82d[_0x47670e][_0x49b768(0x1b3)]+_0x49b768(0x1d2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x56a82d[_0x47670e][_0x49b768(0x1cf)]+_0x49b768(0x1d2)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x251f69[_0x49b768(0x18a)]+'</td>'+_0x49b768(0x125)+_0x56a82d[_0x47670e]['room_names']+_0x49b768(0x1d2)+_0x49b768(0x125)+_0x56a82d[_0x47670e][_0x49b768(0x175)]+_0x56a82d[_0x47670e][_0x49b768(0x1b1)]+_0x56a82d[_0x47670e]['bay']+_0x56a82d[_0x47670e][_0x49b768(0x18d)]+_0x56a82d[_0x47670e]['type'][0x0]+_0x56a82d[_0x47670e]['floorlevel']+_0x49b768(0x1d2),'</tr>';}let _0x11b588=nodemailer['createTransport']({'host':_0x278d08[_0x49b768(0x162)],'port':Number(_0x278d08[_0x49b768(0x18e)]),'secure':![],'auth':{'user':_0x278d08[_0x49b768(0x165)],'pass':_0x278d08[_0x49b768(0x130)]}}),_0x31c451={'from':_0x278d08['email'],'to':_0x2c0f41[0x0][_0x49b768(0x1d3)],'subject':_0x49b768(0x17c),'attachments':[{'filename':_0x49b768(0x1b2),'path':__dirname+_0x49b768(0x10b)+_0x49b768(0x1cd)+_0x27fca9[0x0][_0x49b768(0x151)],'cid':_0x49b768(0x155)}],'html':_0x49b768(0x1a9)+'<html><head><title></title>'+'</head><body>'+'<div>'+_0x49b768(0x1a4)+_0x49b768(0x189)+_0x49b768(0x15c)+_0x49b768(0x1da)+_0x49b768(0x189)+_0x49b768(0x11f)+_0x27fca9[0x0][_0x49b768(0x186)]+_0x49b768(0x15d)+'</div>'+_0x49b768(0x1da)+_0x49b768(0x18c)+_0x49b768(0x189)+_0x49b768(0x159)+'\x20Order\x20Number\x20:\x20'+_0x251f69[_0x49b768(0x134)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x251f69['date']+'\x20'+_0x49b768(0x10f)+'</h5>'+'</div>'+_0x49b768(0x19c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x49b768(0x1ae)+_0x49b768(0x1a1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x49b768(0x1db)+_0x49b768(0x170)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x49b768(0x1c8)+_0x49b768(0x16d)+_0x49b768(0x19d)+_0x49b768(0x1cb)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x65791a+'\x20'+_0x49b768(0x184)+_0x49b768(0x16a)+'<div>'+_0x49b768(0x18b)+_0x49b768(0x17f)+_0x27fca9[0x0][_0x49b768(0x186)]+_0x49b768(0x16e)+_0x49b768(0x1da)+_0x49b768(0x1da)+_0x49b768(0x1a0)};_0x11b588['sendMail'](_0x31c451,function(_0x4dc5cb,_0x1e55f8){var _0x50d9b0=_0x49b768;_0x4dc5cb?(console[_0x50d9b0(0x1bc)](_0x4dc5cb),console[_0x50d9b0(0x1bc)](_0x50d9b0(0x19b))):console[_0x50d9b0(0x1bc)](_0x50d9b0(0x1c7));}),_0x2ec993[_0x49b768(0x12c)]('success',_0x49b768(0x129)),_0x173e40[_0x49b768(0x15f)](_0x49b768(0x1dc)+_0x399637[_0x49b768(0x12a)]);}catch(_0x34cc43){console[_0x49b768(0x174)](_0x34cc43),_0x173e40[_0x49b768(0x1e3)](0x1f4)[_0x49b768(0x11d)]({'error':_0x49b768(0x123)});}})[_0x3e63ae(0x138)](_0x239e67=>{var _0x4a1eed=_0x3e63ae;console[_0x4a1eed(0x174)](_0x239e67),_0x173e40['status'](0x1f4)['json']({'error':_0x4a1eed(0x163)});});}catch(_0x12eb01){console[_0x3e63ae(0x1bc)](_0x12eb01),_0x173e40[_0x3e63ae(0x1e3)](0xc8)['json']({'message':_0x12eb01['message']});}}),router['get']('/view/:id',auth,async(_0x3fc6f9,_0x591e33)=>{var _0x21b06c=a0_0x3a7b0a;try{const {username:_0x453adf,email:_0x23a1ef,role:_0x5a94b4}=_0x3fc6f9[_0x21b06c(0x117)],_0x3e9902=_0x3fc6f9[_0x21b06c(0x117)],_0x5e5598=await profile[_0x21b06c(0x15a)]({'email':_0x3e9902[_0x21b06c(0x165)]}),_0x5c1edb=await master_shop[_0x21b06c(0x177)](),_0x163328=_0x3fc6f9['params']['id'],_0x1e5072=await adjustment[_0x21b06c(0x1e4)]({'_id':_0x163328}),_0x3a8029=await purchases[_0x21b06c(0x1b7)]([{'$match':{'warehouse_name':_0x1e5072[_0x21b06c(0x18a)]}},{'$unwind':_0x21b06c(0x14b)},{'$group':{'_id':'$product.product_name'}}]),_0x48b73a=await product[_0x21b06c(0x177)]({}),_0x175904=await warehouse[_0x21b06c(0x1b7)]([{'$match':{'name':_0x1e5072['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x21b06c(0x149)},'product_stock':{'$first':_0x21b06c(0x15e)},'bay':{'$first':_0x21b06c(0x121)},'bin':{'$first':_0x21b06c(0x183)},'type':{'$first':_0x21b06c(0x199)},'floorlevel':{'$first':_0x21b06c(0x1b6)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x21b06c(0x195)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x21b06c(0x119)},'rack':{'$first':_0x21b06c(0x17e)},'maxPerUnit':{'$first':_0x21b06c(0x136)},'expiry_date':{'$first':_0x21b06c(0x19a)},'production_date':{'$first':_0x21b06c(0x17d)},'batch_code':{'$first':_0x21b06c(0x19e)},'room':{'$first':'$room'}}}]);let _0x1f6aee;if(_0x3e9902[_0x21b06c(0x14a)]==_0x21b06c(0x1b9)){const _0x3b385f=await staff['findOne']({'email':_0x3e9902['email']});_0x1f6aee=await warehouse[_0x21b06c(0x1b7)]([{'$match':{'status':_0x21b06c(0x140),'name':_0x3b385f['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x21b06c(0x139)}}},{'$group':{'_id':_0x21b06c(0x1c6),'name':{'$first':'$name'}}}]);}else _0x1f6aee=await warehouse[_0x21b06c(0x1b7)]([{'$match':{'status':_0x21b06c(0x140),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x21b06c(0x139)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x5c1edb[0x0]['language']==_0x21b06c(0x1a3)){var _0x3daa88=users[_0x21b06c(0x179)];console[_0x21b06c(0x1bc)](_0x3daa88);}else{if(_0x5c1edb[0x0][_0x21b06c(0x187)]==_0x21b06c(0x1c1))var _0x3daa88=users[_0x21b06c(0x1c1)];else{if(_0x5c1edb[0x0][_0x21b06c(0x187)]==_0x21b06c(0x126))var _0x3daa88=users[_0x21b06c(0x126)];else{if(_0x5c1edb[0x0][_0x21b06c(0x187)]==_0x21b06c(0x197))var _0x3daa88=users['Spanish'];else{if(_0x5c1edb[0x0][_0x21b06c(0x187)]==_0x21b06c(0x153))var _0x3daa88=users[_0x21b06c(0x153)];else{if(_0x5c1edb[0x0][_0x21b06c(0x187)]=='Portuguese\x20(BR)')var _0x3daa88=users[_0x21b06c(0x1ca)];else{if(_0x5c1edb[0x0]['language']=='Chinese')var _0x3daa88=users[_0x21b06c(0x115)];else{if(_0x5c1edb[0x0][_0x21b06c(0x187)]==_0x21b06c(0x10a))var _0x3daa88=users['Arabic'];}}}}}}}_0x591e33[_0x21b06c(0x111)](_0x21b06c(0x1df),{'success':_0x3fc6f9[_0x21b06c(0x12c)](_0x21b06c(0x1e1)),'errors':_0x3fc6f9[_0x21b06c(0x12c)](_0x21b06c(0x1a2)),'role':_0x3e9902,'profile':_0x5e5598,'adjustment':_0x1e5072,'stock':_0x175904,'master_shop':_0x5c1edb,'warehouse_name':_0x3a8029,'unit':_0x48b73a,'language':_0x3daa88,'warehouse':_0x1f6aee});}catch(_0x876232){console['log'](_0x876232),_0x591e33[_0x21b06c(0x1e3)](0xc8)[_0x21b06c(0x11d)]({'message':_0x876232[_0x21b06c(0x156)]});}}),router[a0_0x3a7b0a(0x192)](a0_0x3a7b0a(0x132),auth,async(_0x2a7363,_0x3df751)=>{var _0x278014=a0_0x3a7b0a;try{const _0x4173d0=_0x2a7363[_0x278014(0x116)]['id'],_0x37c239=await adjustment[_0x278014(0x1e4)]({'_id':_0x4173d0}),_0x102ca6=await warehouse[_0x278014(0x15a)]({'name':_0x37c239[_0x278014(0x18a)],'room':_0x37c239[_0x278014(0x122)]}),{warehouse_name:_0x97dcf3,date:_0x31c01d,prod_name:_0xe6ce25,level:_0x1e3010,isle:_0x191559,pallet:_0x506fef,stock:_0x3364fa,types:_0x2afafe,adjust_qty:_0x3f9639,new_adjust_qty:_0x19ce33,note:_0x5a879c,Room_name:_0x259be1,invoice:_0xdcf1d1,JO_number:_0x62627,expiry_date:_0xe9c213}=_0x2a7363[_0x278014(0x181)];if(typeof _0xe6ce25==_0x278014(0x160))var _0x87fe01=[_0x2a7363[_0x278014(0x181)]['prod_name']],_0x381f70=[_0x2a7363['body'][_0x278014(0x1b5)]],_0x3ca26b=[_0x2a7363[_0x278014(0x181)][_0x278014(0x167)]],_0x229dfa=[_0x2a7363[_0x278014(0x181)][_0x278014(0x161)]],_0x58fe53=[_0x2a7363[_0x278014(0x181)][_0x278014(0x1a5)]],_0x54b476=[_0x2a7363[_0x278014(0x181)][_0x278014(0x131)]],_0x461de1=[_0x2a7363['body'][_0x278014(0x15b)]],_0x18107c=[_0x2a7363[_0x278014(0x181)][_0x278014(0x1b8)]],_0x1cdd5f=[_0x2a7363[_0x278014(0x181)]['prod_code']],_0x138098=[_0x2a7363[_0x278014(0x181)][_0x278014(0x1cc)]],_0x335b04=[_0x2a7363[_0x278014(0x181)][_0x278014(0x10c)]],_0x4987f2=[_0x2a7363[_0x278014(0x181)]['max_per_unit']],_0x2e8ac2=[_0x2a7363[_0x278014(0x181)][_0x278014(0x13c)]],_0x35a8f7=[_0x2a7363[_0x278014(0x181)]['prod_cat']],_0x1ed199=[_0x2a7363['body'][_0x278014(0x150)]],_0x4993b6=[_0x2a7363[_0x278014(0x181)][_0x278014(0x13a)]],_0x529810=[_0x2a7363[_0x278014(0x181)][_0x278014(0x176)]];else var _0x87fe01=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x17b)]],_0x381f70=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x1b5)]],_0x3ca26b=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x167)]],_0x229dfa=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x161)]],_0x58fe53=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x1a5)]],_0x54b476=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x131)]],_0x461de1=[..._0x2a7363['body'][_0x278014(0x1b3)]],_0x18107c=[..._0x2a7363['body'][_0x278014(0x1b8)]],_0x1cdd5f=[..._0x2a7363['body']['prod_code']],_0x138098=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x1cc)]],_0x335b04=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x10c)]],_0x4987f2=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x194)]],_0x2e8ac2=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x13c)]],_0x35a8f7=[..._0x2a7363['body']['prod_cat']],_0x1ed199=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x150)]],_0x4993b6=[..._0x2a7363[_0x278014(0x181)]['prime1']],_0x529810=[..._0x2a7363[_0x278014(0x181)][_0x278014(0x176)]];const _0x1c14de=_0x87fe01[_0x278014(0x1c9)](_0x1f4485=>{return _0x1f4485={'product_name':_0x1f4485};});_0x381f70[_0x278014(0x141)]((_0x4e71fe,_0x18fbbf)=>{var _0x54a691=_0x278014;_0x1ed199[_0x54a691(0x141)]((_0x390904,_0x30d4d6)=>{var _0x207564=_0x54a691;if(_0x390904==_0x207564(0x1ce)&&_0x18fbbf==_0x30d4d6){var _0xe9823c=_0x4e71fe[_0x207564(0x1d0)](0x3);_0x1c14de[_0x18fbbf][_0x207564(0x175)]=_0x4e71fe[0x0],_0x1c14de[_0x18fbbf][_0x207564(0x1b1)]=_0x4e71fe[0x1],_0x1c14de[_0x18fbbf][_0x207564(0x14d)]=0x0,_0x1c14de[_0x18fbbf][_0x207564(0x18d)]=0x0,_0x1c14de[_0x18fbbf][_0x207564(0x1ac)]=_0x207564(0x1d8),_0x1c14de[_0x18fbbf][_0x207564(0x196)]=_0xe9823c;}else{if(_0x390904==_0x207564(0x1bf)&&_0x18fbbf==_0x30d4d6){var _0xe9823c=_0x4e71fe[_0x207564(0x1d0)](0x3);_0x1c14de[_0x18fbbf][_0x207564(0x175)]=_0x4e71fe[0x0],_0x1c14de[_0x18fbbf][_0x207564(0x1b1)]=_0x4e71fe[0x1],_0x1c14de[_0x18fbbf][_0x207564(0x14d)]=0x0,_0x1c14de[_0x18fbbf][_0x207564(0x18d)]=0x0,_0x1c14de[_0x18fbbf]['type']='Floor',_0x1c14de[_0x18fbbf]['floorlevel']=_0x4e71fe[0x5];}else{if(_0x18fbbf==_0x30d4d6){var _0x2d66be;if(_0x4e71fe[0x4]=='L')_0x2d66be=_0x207564(0x11b);else _0x4e71fe[0x4]=='F'&&(_0x2d66be=_0x207564(0x1d8));_0x1c14de[_0x18fbbf][_0x207564(0x175)]=_0x4e71fe[0x0],_0x1c14de[_0x18fbbf][_0x207564(0x1b1)]=_0x4e71fe[0x1],_0x1c14de[_0x18fbbf][_0x207564(0x14d)]=_0x4e71fe[0x2],_0x1c14de[_0x18fbbf][_0x207564(0x18d)]=_0x4e71fe[0x3],_0x1c14de[_0x18fbbf]['type']=_0x2d66be,_0x1c14de[_0x18fbbf][_0x207564(0x196)]=_0x4e71fe[0x5];}}}});}),_0x3ca26b['forEach']((_0x20d8c2,_0x78e4b3)=>{var _0x721437=_0x278014;_0x1c14de[_0x78e4b3][_0x721437(0x1b0)]=_0x20d8c2;}),_0x229dfa['forEach']((_0x368181,_0x2b07af)=>{var _0x5be1d8=_0x278014;_0x1c14de[_0x2b07af][_0x5be1d8(0x161)]=_0x368181;}),_0x58fe53[_0x278014(0x141)]((_0xf9e18,_0x10870b)=>{var _0x54a1de=_0x278014;_0x1c14de[_0x10870b][_0x54a1de(0x1e0)]=_0xf9e18;}),_0x54b476[_0x278014(0x141)]((_0xc3fde3,_0x1025a9)=>{var _0x12bcba=_0x278014;_0x1c14de[_0x1025a9][_0x12bcba(0x1d6)]=_0xc3fde3;}),_0x461de1[_0x278014(0x141)]((_0x8e646a,_0x16b8bd)=>{var _0x3b9503=_0x278014;_0x1c14de[_0x16b8bd][_0x3b9503(0x1b3)]=_0x8e646a;}),_0x18107c[_0x278014(0x141)]((_0x1998b4,_0x1498be)=>{var _0x461b9c=_0x278014;_0x1c14de[_0x1498be][_0x461b9c(0x1cf)]=_0x1998b4;}),_0x1cdd5f['forEach']((_0x9430e0,_0x479993)=>{var _0x13e7aa=_0x278014;_0x1c14de[_0x479993][_0x13e7aa(0x118)]=_0x9430e0;}),_0x138098[_0x278014(0x141)]((_0x1f2ba7,_0x32c4dc)=>{var _0x500527=_0x278014;_0x1c14de[_0x32c4dc][_0x500527(0x1cc)]=_0x1f2ba7;}),_0x335b04[_0x278014(0x141)]((_0x51b6b3,_0x71490b)=>{_0x1c14de[_0x71490b]['expiry_date']=_0x51b6b3;}),_0x4987f2['forEach']((_0x364f23,_0x3846f1)=>{var _0x576bf5=_0x278014;_0x1c14de[_0x3846f1][_0x576bf5(0x164)]=_0x364f23;}),_0x2e8ac2[_0x278014(0x141)]((_0x56d9ac,_0x1bb712)=>{var _0x4e785f=_0x278014;_0x1c14de[_0x1bb712][_0x4e785f(0x13c)]=_0x56d9ac;}),_0x35a8f7[_0x278014(0x141)]((_0x33082f,_0x44fc2e)=>{var _0x53c068=_0x278014;_0x1c14de[_0x44fc2e][_0x53c068(0x178)]=_0x33082f;}),_0x1ed199['forEach']((_0x5bb61f,_0x128d0b)=>{_0x1c14de[_0x128d0b]['room_names']=_0x5bb61f;}),_0x4993b6[_0x278014(0x141)]((_0x22dcd5,_0x2f4b06)=>{_0x1c14de[_0x2f4b06]['primary_code']=_0x22dcd5;}),_0x529810[_0x278014(0x141)]((_0xc85c16,_0x3a3ffe)=>{var _0x4e1af7=_0x278014;_0x1c14de[_0x3a3ffe][_0x4e1af7(0x1d7)]=_0xc85c16;});const _0x12842a=_0x1c14de[_0x278014(0x1aa)](_0x12fa1a=>_0x12fa1a[_0x278014(0x1e0)]!=='0'&&_0x12fa1a[_0x278014(0x1e0)]!=='');var _0x1e66af=0x0;_0x12842a['forEach'](_0x9b5b36=>{var _0x19e151=_0x278014;console[_0x19e151(0x1bc)](_0x19e151(0x1de),_0x9b5b36),parseInt(_0x9b5b36[_0x19e151(0x1e0)])<=0x0&&_0x1e66af++;});if(_0x1e66af!=0x0)return _0x2a7363[_0x278014(0x12c)](_0x278014(0x1a2),_0x278014(0x11c)),_0x3df751[_0x278014(0x15f)](_0x278014(0x17a));_0x37c239[_0x278014(0x18a)]=_0x97dcf3,_0x37c239[_0x278014(0x147)]=_0x31c01d,_0x37c239[_0x278014(0x173)]=_0x12842a,_0x37c239[_0x278014(0x13e)]=_0x5a879c,_0x37c239[_0x278014(0x134)]=_0xdcf1d1,_0x37c239[_0x278014(0x13f)]='False';const _0x2cb8f1=await _0x37c239[_0x278014(0x1c0)]();_0x2a7363[_0x278014(0x12c)](_0x278014(0x1e1),_0x278014(0x10e)),_0x3df751[_0x278014(0x15f)](_0x278014(0x11a));}catch(_0x26c49d){console[_0x278014(0x1bc)](_0x26c49d);}}),router['post'](a0_0x3a7b0a(0x113),async(_0x29f231,_0x47d381)=>{var _0x569288=a0_0x3a7b0a;const {primary_code:_0x58fc86,warehouse_data:_0x5c060a,rooms_data:_0x35b1cf,Roomslist:_0x240c8b}=_0x29f231[_0x569288(0x181)],_0x54eff2=_0x240c8b[_0x569288(0x171)](','),_0x116250=[];async function _0x290e95(_0x508f17){var _0x323254=_0x569288;const _0x4c166e=await warehouse[_0x323254(0x1b7)]([{'$match':{'name':_0x5c060a,'room':_0x508f17}},{'$unwind':_0x323254(0x16c)},{'$match':{'product_details.primary_code':_0x58fc86}},{'$group':{'_id':_0x323254(0x137),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x323254(0x15e)},'primary_code':{'$first':_0x323254(0x135)},'secondary_code':{'$first':_0x323254(0x195)},'product_code':{'$first':_0x323254(0x182)},'level':{'$first':_0x323254(0x121)},'isle':{'$first':_0x323254(0x183)},'type':{'$first':_0x323254(0x199)},'pallet':{'$first':_0x323254(0x1b6)},'unit':{'$first':_0x323254(0x124)},'secondary_unit':{'$first':_0x323254(0x114)},'storage':{'$first':_0x323254(0x119)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x323254(0x19a)},'production_date':{'$first':_0x323254(0x17d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x323254(0x19e)},'product_cat':{'$first':_0x323254(0x154)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x709cf4=await warehouse[_0x323254(0x1b7)]([{'$match':{'name':_0x5c060a,'room':_0x508f17}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x58fc86}},{'$group':{'_id':_0x323254(0x137),'name':{'$first':_0x323254(0x149)},'product_stock':{'$first':_0x323254(0x15e)},'primary_code':{'$first':_0x323254(0x135)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x323254(0x121)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x323254(0x1b6)},'unit':{'$first':_0x323254(0x124)},'secondary_unit':{'$first':_0x323254(0x114)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x323254(0x17e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x323254(0x17d)},'maxPerUnit':{'$first':_0x323254(0x136)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x323254(0x154)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x4c166e[_0x323254(0x14f)]>0x0)_0x116250[_0x323254(0x148)](_0x4c166e);else _0x709cf4['length']>0x0&&_0x116250['push'](_0x709cf4);}const _0xb61f3e=_0x54eff2[_0x569288(0x1c9)](_0x5eb87e=>_0x290e95(_0x5eb87e));await Promise[_0x569288(0x18f)](_0xb61f3e),_0x47d381[_0x569288(0x11d)](_0x116250);}),router[a0_0x3a7b0a(0x192)](a0_0x3a7b0a(0x1e2),async(_0x12787f,_0x56aba2)=>{var _0x99174e=a0_0x3a7b0a;const {primaryCode:_0x8c3ec5,secondaryCode:_0x49479d,productCode:_0x5777d2,level:_0x435d3c,isle:_0xd02248,pallet:_0x256147,warehouses:_0x1d10a4,room:_0x5d46c4}=_0x12787f['body'];try{const _0x3263ad=await warehouse[_0x99174e(0x1b7)]([{'$match':{'name':_0x1d10a4,'room':_0x5d46c4}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x435d3c),'product_details.isle':_0xd02248,'product_details.pallet':parseInt(_0x256147)}},{'$group':{'_id':_0x99174e(0x137),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x99174e(0x15e)},'level':{'$first':_0x99174e(0x12b)},'isle':{'$first':_0x99174e(0x1bb)},'pallet':{'$first':_0x99174e(0x168)},'maxProducts':{'$first':_0x99174e(0x19f)}}}]);_0x56aba2[_0x99174e(0x1e3)](0xc8)[_0x99174e(0x11d)](_0x3263ad);}catch(_0x1a60a7){_0x56aba2['status'](0x194)[_0x99174e(0x11d)]({'message':_0x1a60a7[_0x99174e(0x156)]});}}),module['exports']=router;