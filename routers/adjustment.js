var a0_0xab85ff=a0_0x9616;function a0_0x9616(_0x5e5db3,_0x4655db){var _0x5a936b=a0_0x5a93();return a0_0x9616=function(_0x9616c8,_0x303122){_0x9616c8=_0x9616c8-0x149;var _0x3a9412=_0x5a936b[_0x9616c8];return _0x3a9412;},a0_0x9616(_0x5e5db3,_0x4655db);}(function(_0xb00f0c,_0x239f14){var _0xa4ca9f=a0_0x9616,_0x1cf1d1=_0xb00f0c();while(!![]){try{var _0x511ca3=-parseInt(_0xa4ca9f(0x1fa))/0x1+-parseInt(_0xa4ca9f(0x1af))/0x2+-parseInt(_0xa4ca9f(0x21e))/0x3*(parseInt(_0xa4ca9f(0x15d))/0x4)+parseInt(_0xa4ca9f(0x1e6))/0x5+-parseInt(_0xa4ca9f(0x190))/0x6+-parseInt(_0xa4ca9f(0x164))/0x7*(-parseInt(_0xa4ca9f(0x1e5))/0x8)+parseInt(_0xa4ca9f(0x1ab))/0x9;if(_0x511ca3===_0x239f14)break;else _0x1cf1d1['push'](_0x1cf1d1['shift']());}catch(_0x465cc7){_0x1cf1d1['push'](_0x1cf1d1['shift']());}}}(a0_0x5a93,0x7e22e));const express=require('express'),app=express(),router=express[a0_0xab85ff(0x16c)](),auth=require(a0_0xab85ff(0x1fd)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xab85ff(0x20e)),users=require(a0_0xab85ff(0x1b8)),nodemailer=require(a0_0xab85ff(0x185)),mongoose=require('mongoose');function a0_0x5a93(){var _0x47c063=['56JNEvFD','$name','logo','product_code','new_adjust_qty','host','room','28iAyxBR','Return\x20Goods','prod_cat','json','stock','room_names','Hindi','New_Qty_Converted_adj','Router','<div>','Floor','/preview/:id','There\x27s\x20a\x20error\x20in\x20this\x20transaction','second1','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','/../public','<h5\x20style=\x22text-align:\x20left;\x22>','push','then','max_per_unit','$product_details.product_code','body','production_date','German','port','Portuguese','exports','product_details','render','status','$product_details.product_cat','edit_adjustment','nodemailer','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','image','$product_details','prod_code','$product_details.maxProducts','rack','length','$room','message','user','1655802dKOMOp','level','$product_details.secondary_unit','</head><body>','filter','$product_details.production_date','<h5>','email','random','False','adjust_qty','minus','</h5>','<tr>','_id','/view/add_adjustment','$date','$product','$product_details.pallet','back','\x20<>\x20','note','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/picking_list/PDF_adjustment_rm/','prod_invoice','staff','10657467idcuxP','<tbody\x20style=\x22text-align:\x20center;\x22>','Rooms','/CheckingWarehouse','840838SdSAmA','Portuguese\x20(BR)','site_title','Arabic','type','/adjustment/preview/','$_id','padStart','$product_details.bay','../public/language/languages.json','adjustment\x20Finalized\x20successfully','$product_details.type','/adjustment/view','$product_details.primary_code','\x20</h2>','Receiving\x20Area','flash','params','</table>','id_transaction','sendMail','findById','warehouse','errors','find','$product_details.storage','Level','$product_details.maxPerUnit','adjustment\x20data\x20update\x20successfully','primary_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','English','$product.room_names','$product_details.isle','$product_details.secondary_code','log','<h2>\x20','date','get','map','/upload/','<hr\x20class=\x22my-3\x22>','/view/:id','prime1','RMSEmail','\x20Order\x20Number\x20:\x20','master','Raw\x20Materials','</td>','edit_adjustment_view','ObjectId','floorlevel','types','invoice','1803336NCxEJt','2427335jNbtPS','maxperunit','prod_name','valueOf','role','True','Error\x20Occurs','Chinese','$finalize','$product_details.product_name','storage','$product_details.expiry_date','unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Primary_Units','Spanish','$product_details.batch_code','isAllowEdit','id_transaction_from','foreach\x20newproduct','811684OcHRsj','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Shelves','../middleware/auth','Arabic\x20(ae)','all','save','</div>','stockBefore','</body></html>','toString','$product_details.bin','/barcode_scanner','Enabled','slice','bin','Ambient','post','add_adjustment','secondary_code','../models/all_models','warehouse_name','adjustment','aggregate','Secondary_units','$product_details.rack','success','$product_details.unit','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Enclosed','product_stock','$product_details.invoice','</tr>','$product_details.product_stock','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','117123aLoHQK','</tbody>','New_Qty_Converted','language','catch','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.floorlevel','secondary_unit','expiry_date','redirect','$product_details.level','French','forEach','findOne','$product.product_name','<span\x20style=\x22float:\x20right;\x22>','$product_details._id','batch_code','product','</thead>','$isAllowEdit','\x20Order\x20Date\x20:\x20','ADJ-'];a0_0x5a93=function(){return _0x47c063;};return a0_0x5a93();}router[a0_0xab85ff(0x1d5)]('/view',auth,async(_0x3d1879,_0x11c1b6)=>{var _0xa681df=a0_0xab85ff;try{const {username:_0x311b0b,email:_0x328830,role:_0x232582}=_0x3d1879[_0xa681df(0x18f)],_0x3b5d43=_0x3d1879[_0xa681df(0x18f)],_0x4a1897=await profile[_0xa681df(0x153)]({'email':_0x3b5d43[_0xa681df(0x197)]}),_0x1bb5ee=await master_shop[_0xa681df(0x1c7)]();console[_0xa681df(0x1d2)](_0xa681df(0x1dd),_0x1bb5ee);let _0x1f04ba;if(_0x3b5d43[_0xa681df(0x1ea)]==_0xa681df(0x1aa)){const _0xd519cc=await staff[_0xa681df(0x153)]({'email':_0x3b5d43[_0xa681df(0x197)]});_0x1f04ba=await warehouse[_0xa681df(0x1c7)]({'status':_0xa681df(0x207),'name':_0xd519cc[_0xa681df(0x1c5)]});}else _0x1f04ba=await warehouse['find']({'status':_0xa681df(0x207)});const _0x4103e4=await product[_0xa681df(0x1c7)]();let _0x29250c;if(_0x3b5d43[_0xa681df(0x1ea)]=='staff'){const _0x6fc258=await staff['findOne']({'email':_0x3b5d43[_0xa681df(0x197)]});_0x29250c=await adjustment[_0xa681df(0x1c7)]({'warehouse_name':_0x6fc258[_0xa681df(0x1c5)]});}else _0x29250c=await adjustment[_0xa681df(0x211)]([{'$unwind':_0xa681df(0x1a1)},{'$group':{'_id':_0xa681df(0x1b5),'invoice':{'$first':'$invoice'},'date':{'$first':_0xa681df(0x1a0)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0xa681df(0x1cf)},'finalize':{'$first':_0xa681df(0x1ee)},'isAllowEdit':{'$first':_0xa681df(0x15a)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x1a6)){var _0x3c5f05=users['English'];console[_0xa681df(0x1d2)](_0x3c5f05);}else{if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x16a))var _0x3c5f05=users['Hindi'];else{if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x17c))var _0x3c5f05=users['German'];else{if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x1f5))var _0x3c5f05=users[_0xa681df(0x1f5)];else{if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x151))var _0x3c5f05=users[_0xa681df(0x151)];else{if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x1b0))var _0x3c5f05=users['Portuguese'];else{if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x1ed))var _0x3c5f05=users[_0xa681df(0x1ed)];else{if(_0x1bb5ee[0x0][_0xa681df(0x221)]==_0xa681df(0x1fe))var _0x3c5f05=users['Arabic'];}}}}}}}_0x11c1b6[_0xa681df(0x181)](_0xa681df(0x210),{'success':_0x3d1879[_0xa681df(0x1bf)](_0xa681df(0x214)),'errors':_0x3d1879[_0xa681df(0x1bf)](_0xa681df(0x1c6)),'role':_0x3b5d43,'profile':_0x4a1897,'warehouse':_0x1f04ba,'product':_0x4103e4,'adjustment':_0x29250c,'master_shop':_0x1bb5ee,'language':_0x3c5f05});}catch(_0x267756){console[_0xa681df(0x1d2)](_0x267756);}});async function getRandom8DigitNumber(){var _0x6b45ee=a0_0xab85ff;const _0x5ca4d0=0x989680,_0x4e63e9=0x5f5e0ff,_0x196f0d=Math['floor'](Math[_0x6b45ee(0x198)]()*(_0x4e63e9-_0x5ca4d0+0x1))+_0x5ca4d0;var _0xb41517;const _0x127102=await adjustment[_0x6b45ee(0x153)]({'invoice':_0x6b45ee(0x15c)+_0x196f0d});return _0x127102&&_0x127102[_0x6b45ee(0x18c)]>0x0?_0xb41517=_0x6b45ee(0x15c)+_0x196f0d:_0xb41517=_0x6b45ee(0x15c)+_0x196f0d,_0xb41517;}router['get']('/view/add_adjustment',auth,async(_0x5adcc1,_0x1221e7)=>{var _0x343104=a0_0xab85ff;try{const {username:_0x3ea816,email:_0x2b67e5,role:_0x55d71f}=_0x5adcc1[_0x343104(0x18f)],_0x12192c=_0x5adcc1[_0x343104(0x18f)],_0x278ac7=await profile[_0x343104(0x153)]({'email':_0x12192c[_0x343104(0x197)]}),_0x36d110=await master_shop['find']();let _0x1dee6e;if(_0x12192c[_0x343104(0x1ea)]==_0x343104(0x1aa)){const _0x3c13ab=await staff[_0x343104(0x153)]({'email':_0x12192c[_0x343104(0x197)]});_0x1dee6e=await warehouse['aggregate']([{'$match':{'status':_0x343104(0x207),'name':_0x3c13ab[_0x343104(0x1c5)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x343104(0x165)}}},{'$group':{'_id':'$name','name':{'$first':_0x343104(0x15e)}}}]);}else _0x1dee6e=await warehouse[_0x343104(0x211)]([{'$match':{'status':_0x343104(0x207),'warehouse_category':_0x343104(0x1de),'name':{'$ne':_0x343104(0x165)}}},{'$group':{'_id':_0x343104(0x15e),'name':{'$first':_0x343104(0x15e)}}}]);const _0x130cf4=await product[_0x343104(0x1c7)]({}),_0x302157=await adjustment[_0x343104(0x1c7)]({}),_0x52abe6=_0x302157[_0x343104(0x18c)]+0x1,_0x29daa6='ADJ-'+_0x52abe6[_0x343104(0x204)]()[_0x343104(0x1b6)](0x5,'0');var _0x492a0a=[_0x343104(0x20a),_0x343104(0x217),'Return\x20Rooms'];if(_0x36d110[0x0][_0x343104(0x221)]==_0x343104(0x1a6))var _0x2349b5=users[_0x343104(0x1ce)];else{if(_0x36d110[0x0][_0x343104(0x221)]==_0x343104(0x16a))var _0x2349b5=users[_0x343104(0x16a)];else{if(_0x36d110[0x0][_0x343104(0x221)]==_0x343104(0x17c))var _0x2349b5=users[_0x343104(0x17c)];else{if(_0x36d110[0x0][_0x343104(0x221)]=='Spanish')var _0x2349b5=users[_0x343104(0x1f5)];else{if(_0x36d110[0x0][_0x343104(0x221)]==_0x343104(0x151))var _0x2349b5=users[_0x343104(0x151)];else{if(_0x36d110[0x0][_0x343104(0x221)]==_0x343104(0x1b0))var _0x2349b5=users[_0x343104(0x17e)];else{if(_0x36d110[0x0][_0x343104(0x221)]==_0x343104(0x1ed))var _0x2349b5=users[_0x343104(0x1ed)];else{if(_0x36d110[0x0][_0x343104(0x221)]=='Arabic\x20(ae)')var _0x2349b5=users[_0x343104(0x1b2)];}}}}}}}const _0x9556c2=getRandom8DigitNumber();_0x9556c2[_0x343104(0x177)](_0x2f61a5=>{var _0x5b9547=_0x343104;_0x1221e7['render'](_0x5b9547(0x20c),{'success':_0x5adcc1['flash'](_0x5b9547(0x214)),'errors':_0x5adcc1['flash'](_0x5b9547(0x1c6)),'role':_0x12192c,'profile':_0x278ac7,'warehouse':_0x1dee6e,'product':_0x130cf4,'master_shop':_0x36d110,'language':_0x2349b5,'rooms_data':_0x492a0a,'invoice_no':_0x2f61a5});})[_0x343104(0x149)](_0x42cfc0=>{var _0x1d9e67=_0x343104;_0x5adcc1['flash'](_0x1d9e67(0x1c6),_0x1d9e67(0x170)),_0x1221e7[_0x1d9e67(0x14f)](_0x1d9e67(0x1bb));});}catch(_0x551154){console[_0x343104(0x1d2)](_0x551154);}}),router[a0_0xab85ff(0x20b)](a0_0xab85ff(0x19f),auth,async(_0x17aaa0,_0x5f61d4)=>{var _0x3c7b64=a0_0xab85ff;try{const {warehouse_name:_0x48c819,date:_0x32bf47,prod_name:_0xe8548d,level:_0x2d25cb,isle:_0x1c74c5,pallet:_0x4e05c2,stock:_0x15ed93,types:_0x13944a,adjust_qty:_0x367060,new_adjust_qty:_0x363467,note:_0x25af01,Room_name:_0x64e10b,invoice:_0x59005c,JO_number:_0x5b4060,expiry_date:_0x506865}=_0x17aaa0[_0x3c7b64(0x17a)];if(typeof _0xe8548d=='string')var _0x2ff090=[_0x17aaa0['body'][_0x3c7b64(0x1e8)]],_0x1ff5ba=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x191)]],_0x57d7af=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x168)]],_0xb76b29=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1e3)]],_0x19f20c=[_0x17aaa0['body'][_0x3c7b64(0x16b)]],_0xfe7373=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x220)]],_0x10e48d=[_0x17aaa0['body'][_0x3c7b64(0x1f4)]],_0x5659fa=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x212)]],_0x59cd3b=[_0x17aaa0['body'][_0x3c7b64(0x189)]],_0x5dc7df=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x157)]],_0x1104be=[_0x17aaa0[_0x3c7b64(0x17a)]['expiry_date']],_0xa3118e=[_0x17aaa0[_0x3c7b64(0x17a)]['max_per_unit']],_0x1ed1ac=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x17b)]],_0x28cd3f=[_0x17aaa0['body'][_0x3c7b64(0x166)]],_0x266415=[_0x17aaa0[_0x3c7b64(0x17a)]['Rooms']],_0x48c3c4=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1da)]],_0x236d91=[_0x17aaa0[_0x3c7b64(0x17a)]['second1']],_0x4cd2fd=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1a9)]],_0x12551a=[_0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1c2)]];else var _0x2ff090=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1e8)]],_0x1ff5ba=[..._0x17aaa0['body']['level']],_0x57d7af=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x168)]],_0xb76b29=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1e3)]],_0x19f20c=[..._0x17aaa0['body']['New_Qty_Converted_adj']],_0xfe7373=[..._0x17aaa0['body'][_0x3c7b64(0x220)]],_0x10e48d=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1f2)]],_0x5659fa=[..._0x17aaa0[_0x3c7b64(0x17a)]['Secondary_units']],_0x59cd3b=[..._0x17aaa0['body'][_0x3c7b64(0x189)]],_0x5dc7df=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x157)]],_0x1104be=[..._0x17aaa0['body']['expiry_date']],_0xa3118e=[..._0x17aaa0['body'][_0x3c7b64(0x178)]],_0x1ed1ac=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x17b)]],_0x28cd3f=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x166)]],_0x266415=[..._0x17aaa0['body'][_0x3c7b64(0x1ad)]],_0x48c3c4=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1da)]],_0x236d91=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x171)]],_0x4cd2fd=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1a9)]],_0x12551a=[..._0x17aaa0[_0x3c7b64(0x17a)][_0x3c7b64(0x1c2)]];const _0x84d7d8=_0x2ff090['map'](_0x212189=>{return _0x212189={'product_name':_0x212189};});_0x1ff5ba[_0x3c7b64(0x152)]((_0x1c314a,_0x3c494e)=>{var _0x438b63=_0x3c7b64;_0x266415[_0x438b63(0x152)]((_0x5ab7c9,_0x1e39ee)=>{var _0x28b8aa=_0x438b63;if(_0x5ab7c9==_0x28b8aa(0x1be)&&_0x3c494e==_0x1e39ee){var _0x4adaaa=_0x1c314a[_0x28b8aa(0x208)](0x3);_0x84d7d8[_0x3c494e][_0x28b8aa(0x1f0)]=_0x1c314a[0x0],_0x84d7d8[_0x3c494e][_0x28b8aa(0x18b)]=_0x1c314a[0x1],_0x84d7d8[_0x3c494e][_0x28b8aa(0x172)]=0x0,_0x84d7d8[_0x3c494e]['bin']=0x0,_0x84d7d8[_0x3c494e][_0x28b8aa(0x1b3)]=_0x28b8aa(0x16e),_0x84d7d8[_0x3c494e][_0x28b8aa(0x1e2)]=_0x4adaaa;}else{if(_0x5ab7c9==_0x28b8aa(0x1fc)&&_0x3c494e==_0x1e39ee){var _0x4adaaa=_0x1c314a['slice'](0x3);_0x84d7d8[_0x3c494e][_0x28b8aa(0x1f0)]=_0x1c314a[0x0],_0x84d7d8[_0x3c494e]['rack']=_0x1c314a[0x1],_0x84d7d8[_0x3c494e][_0x28b8aa(0x172)]=0x0,_0x84d7d8[_0x3c494e][_0x28b8aa(0x209)]=0x0,_0x84d7d8[_0x3c494e]['type']=_0x28b8aa(0x16e),_0x84d7d8[_0x3c494e][_0x28b8aa(0x1e2)]=_0x1c314a[0x5];}else{if(_0x3c494e==_0x1e39ee){var _0x8e173e;if(_0x1c314a[0x4]=='L')_0x8e173e='Level';else _0x1c314a[0x4]=='F'&&(_0x8e173e=_0x28b8aa(0x16e));_0x84d7d8[_0x3c494e][_0x28b8aa(0x1f0)]=_0x1c314a[0x0],_0x84d7d8[_0x3c494e]['rack']=_0x1c314a[0x1],_0x84d7d8[_0x3c494e][_0x28b8aa(0x172)]=_0x1c314a[0x2],_0x84d7d8[_0x3c494e][_0x28b8aa(0x209)]=_0x1c314a[0x3],_0x84d7d8[_0x3c494e]['type']=_0x8e173e,_0x84d7d8[_0x3c494e][_0x28b8aa(0x1e2)]=_0x1c314a[0x5];}}}});}),_0x57d7af[_0x3c7b64(0x152)]((_0x181787,_0x13aadf)=>{var _0x16136c=_0x3c7b64;_0x84d7d8[_0x13aadf][_0x16136c(0x202)]=_0x181787;}),_0x12551a['forEach']((_0xb2ca63,_0x4fb930)=>{var _0x2e6282=_0x3c7b64;_0x84d7d8[_0x4fb930][_0x2e6282(0x1f8)]=_0xb2ca63;}),_0xb76b29[_0x3c7b64(0x152)]((_0x5db955,_0x444fc9)=>{var _0x586ca7=_0x3c7b64;_0x84d7d8[_0x444fc9][_0x586ca7(0x1e3)]=_0x5db955;}),_0x19f20c[_0x3c7b64(0x152)]((_0x4b2474,_0x58d1bc)=>{var _0x40a876=_0x3c7b64;_0x84d7d8[_0x58d1bc][_0x40a876(0x19a)]=_0x4b2474;}),_0xfe7373['forEach']((_0x270140,_0x688c52)=>{_0x84d7d8[_0x688c52]['new_adjust_qty']=_0x270140;}),_0x10e48d[_0x3c7b64(0x152)]((_0x56ce38,_0x30bd60)=>{var _0x14b7ee=_0x3c7b64;_0x84d7d8[_0x30bd60][_0x14b7ee(0x1f2)]=_0x56ce38;}),_0x5659fa[_0x3c7b64(0x152)]((_0x276319,_0x132917)=>{var _0x409232=_0x3c7b64;_0x84d7d8[_0x132917][_0x409232(0x14d)]=_0x276319;}),_0x59cd3b['forEach']((_0x38028e,_0x2ba58f)=>{_0x84d7d8[_0x2ba58f]['product_code']=_0x38028e;}),_0x5dc7df['forEach']((_0x89eb01,_0x5b53d2)=>{var _0x26f14e=_0x3c7b64;_0x84d7d8[_0x5b53d2][_0x26f14e(0x157)]=_0x89eb01;}),_0x1104be[_0x3c7b64(0x152)]((_0x3e61fe,_0x11f817)=>{var _0x121295=_0x3c7b64;_0x84d7d8[_0x11f817][_0x121295(0x14e)]=_0x3e61fe;}),_0xa3118e[_0x3c7b64(0x152)]((_0x2ce79e,_0x357e4d)=>{var _0x51d34c=_0x3c7b64;_0x84d7d8[_0x357e4d][_0x51d34c(0x1e7)]=_0x2ce79e;}),_0x1ed1ac[_0x3c7b64(0x152)]((_0x5bc2d1,_0x5bd691)=>{_0x84d7d8[_0x5bd691]['production_date']=_0x5bc2d1;}),_0x28cd3f[_0x3c7b64(0x152)]((_0x26ebe0,_0x2d7860)=>{var _0x54a156=_0x3c7b64;_0x84d7d8[_0x2d7860][_0x54a156(0x166)]=_0x26ebe0;}),_0x266415['forEach']((_0x1d6840,_0x416ae6)=>{var _0x3dde11=_0x3c7b64;_0x84d7d8[_0x416ae6][_0x3dde11(0x169)]=_0x1d6840;}),_0x48c3c4[_0x3c7b64(0x152)]((_0x2ac08a,_0x3ad69f)=>{var _0x2dfcfa=_0x3c7b64;_0x84d7d8[_0x3ad69f][_0x2dfcfa(0x1cc)]=_0x2ac08a;}),_0x236d91[_0x3c7b64(0x152)]((_0x2e6ead,_0x5d3e27)=>{var _0x2bdd85=_0x3c7b64;_0x84d7d8[_0x5d3e27][_0x2bdd85(0x20d)]=_0x2e6ead;}),_0x4cd2fd[_0x3c7b64(0x152)]((_0x18d8a2,_0xdbcf7)=>{var _0x11cfc3=_0x3c7b64;_0x84d7d8[_0xdbcf7][_0x11cfc3(0x1e4)]=_0x18d8a2;});const _0xb36f08=_0x84d7d8[_0x3c7b64(0x194)](_0xc09f50=>_0xc09f50['adjust_qty']!=='0'&&_0xc09f50[_0x3c7b64(0x19a)]!=='');var _0x1062f5=0x0;_0xb36f08['forEach'](_0x1b8e6d=>{var _0x4cb456=_0x3c7b64;console[_0x4cb456(0x1d2)](_0x4cb456(0x1f9),_0x1b8e6d),parseInt(_0x1b8e6d[_0x4cb456(0x19a)])<=0x0&&_0x1062f5++;});if(_0x1062f5!=0x0)return _0x17aaa0[_0x3c7b64(0x1bf)]('errors',_0x3c7b64(0x21c)),_0x5f61d4[_0x3c7b64(0x14f)]('back');const _0xe0cee8=new adjustment({'warehouse_name':_0x48c819,'date':_0x32bf47,'product':_0xb36f08,'note':_0x25af01,'room':_0x64e10b,'invoice':_0x59005c,'JO_number':_0x5b4060,'expiry_date':_0x506865}),_0x57ad8f=await _0xe0cee8[_0x3c7b64(0x200)]();_0x17aaa0[_0x3c7b64(0x1bf)](_0x3c7b64(0x214),'adjustment\x20add\x20successfull'),_0x5f61d4[_0x3c7b64(0x14f)](_0x3c7b64(0x1b4)+_0x57ad8f['_id']);}catch(_0x336251){console[_0x3c7b64(0x1d2)](_0x336251),_0x5f61d4[_0x3c7b64(0x182)](0xc8)[_0x3c7b64(0x167)]({'message':_0x336251[_0x3c7b64(0x18e)]});}}),router[a0_0xab85ff(0x1d5)](a0_0xab85ff(0x16f),auth,async(_0x2bfb1d,_0x436cfb)=>{var _0x1d6ac8=a0_0xab85ff;try{const {username:_0x1e399f,email:_0x4f7ceb,role:_0x1ff7e7}=_0x2bfb1d[_0x1d6ac8(0x18f)],_0x279a96=_0x2bfb1d[_0x1d6ac8(0x18f)],_0x4a098c=await profile[_0x1d6ac8(0x153)]({'email':_0x279a96[_0x1d6ac8(0x197)]}),_0x5a6844=await master_shop[_0x1d6ac8(0x1c7)](),_0x27a699=_0x2bfb1d[_0x1d6ac8(0x1c0)]['id'],_0x59b8a4=await adjustment['findById']({'_id':_0x27a699}),_0x424a0f=await purchases['aggregate']([{'$match':{'warehouse_name':_0x59b8a4[_0x1d6ac8(0x20f)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x27ff7e=await product[_0x1d6ac8(0x1c7)]({}),_0x44d593=await warehouse[_0x1d6ac8(0x211)]([{'$match':{'name':_0x59b8a4[_0x1d6ac8(0x20f)]}},{'$unwind':_0x1d6ac8(0x188)},{'$group':{'_id':_0x1d6ac8(0x156),'name':{'$first':_0x1d6ac8(0x1ef)},'product_stock':{'$first':_0x1d6ac8(0x21b)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1d6ac8(0x205)},'type':{'$first':_0x1d6ac8(0x1ba)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1d6ac8(0x1bc)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1d6ac8(0x179)},'storage':{'$first':_0x1d6ac8(0x1c8)},'rack':{'$first':_0x1d6ac8(0x213)},'maxPerUnit':{'$first':_0x1d6ac8(0x1ca)},'expiry_date':{'$first':_0x1d6ac8(0x1f1)},'production_date':{'$first':_0x1d6ac8(0x195)},'batch_code':{'$first':_0x1d6ac8(0x1f6)},'room':{'$first':_0x1d6ac8(0x18d)}}}]);if(_0x5a6844[0x0][_0x1d6ac8(0x221)]==_0x1d6ac8(0x1a6)){var _0x2820c6=users['English'];console[_0x1d6ac8(0x1d2)](_0x2820c6);}else{if(_0x5a6844[0x0]['language']=='Hindi')var _0x2820c6=users['Hindi'];else{if(_0x5a6844[0x0]['language']==_0x1d6ac8(0x17c))var _0x2820c6=users['German'];else{if(_0x5a6844[0x0][_0x1d6ac8(0x221)]==_0x1d6ac8(0x1f5))var _0x2820c6=users[_0x1d6ac8(0x1f5)];else{if(_0x5a6844[0x0]['language']==_0x1d6ac8(0x151))var _0x2820c6=users['French'];else{if(_0x5a6844[0x0][_0x1d6ac8(0x221)]=='Portuguese\x20(BR)')var _0x2820c6=users['Portuguese'];else{if(_0x5a6844[0x0]['language']=='Chinese')var _0x2820c6=users[_0x1d6ac8(0x1ed)];else{if(_0x5a6844[0x0][_0x1d6ac8(0x221)]=='Arabic\x20(ae)')var _0x2820c6=users[_0x1d6ac8(0x1b2)];}}}}}}}_0x436cfb[_0x1d6ac8(0x181)](_0x1d6ac8(0x1e0),{'success':_0x2bfb1d[_0x1d6ac8(0x1bf)](_0x1d6ac8(0x214)),'errors':_0x2bfb1d[_0x1d6ac8(0x1bf)](_0x1d6ac8(0x1c6)),'role':_0x279a96,'profile':_0x4a098c,'adjustment':_0x59b8a4,'master_shop':_0x5a6844,'warehouse_name':_0x424a0f,'unit':_0x27ff7e,'language':_0x2820c6});}catch(_0x2c54eb){console[_0x1d6ac8(0x1d2)](_0x2c54eb),_0x436cfb['status'](0xc8)[_0x1d6ac8(0x167)]({'message':_0x2c54eb['message']});}}),router[a0_0xab85ff(0x20b)](a0_0xab85ff(0x16f),auth,async(_0x4ab30b,_0x40611f)=>{var _0x232596=a0_0xab85ff;try{const _0x57c720=_0x4ab30b['params']['id'],{warehouse_name:_0x3334c9,Room_name:_0x4abe31}=_0x4ab30b['body'],_0xc01c40=await adjustment[_0x232596(0x1c4)]({'_id':_0x57c720}),_0x22b597=_0xc01c40[_0x232596(0x158)][_0x232596(0x1d6)](async _0x251394=>{var _0x15064d=_0x232596;if(_0x251394[_0x15064d(0x19a)]>0x0){const _0x2a8ee7=mongoose['Types'][_0x15064d(0x1e1)];var _0x35c094=await warehouse[_0x15064d(0x211)]([{'$match':{'name':_0x3334c9,'room':_0x251394[_0x15064d(0x169)],'warehouse_category':_0x15064d(0x1de)}},{'$unwind':_0x15064d(0x188)},{'$match':{'product_details._id':_0x2a8ee7(_0x251394[_0x15064d(0x1f8)])}}]),_0x3ce890=0x0;for(let _0x55bf03=0x0;_0x55bf03<=_0x35c094[_0x15064d(0x18c)]-0x1;_0x55bf03++){const _0x2cbfb9=_0x35c094[_0x55bf03];_0x251394[_0x15064d(0x1e3)]==_0x15064d(0x19b)?(console['log']('-'),_0x3ce890=parseFloat(_0x35c094[_0x55bf03][_0x15064d(0x180)][_0x15064d(0x218)])-parseFloat(_0x251394['adjust_qty'])):(console[_0x15064d(0x1d2)]('+'),_0x3ce890=parseFloat(_0x35c094[_0x55bf03][_0x15064d(0x180)][_0x15064d(0x218)])+parseFloat(_0x251394[_0x15064d(0x19a)])),await warehouse['updateOne']({'_id':_0x2a8ee7(_0x2cbfb9[_0x15064d(0x19e)]['valueOf']()),'product_details._id':_0x2a8ee7(_0x2cbfb9['product_details']['_id'])},{'$set':{'product_details.$.product_stock':_0x3ce890,'product_details.$.adj_invoice':_0xc01c40[_0x15064d(0x1e4)]}}),console['log'](_0x2cbfb9[_0x15064d(0x19e)][_0x15064d(0x1e9)]()+'\x20<>\x20'+_0x2cbfb9[_0x15064d(0x180)][_0x15064d(0x19e)]+_0x15064d(0x1a4)+_0x3ce890);}}});_0xc01c40['finalize']=_0x232596(0x1eb);const _0x4a9def=await _0xc01c40[_0x232596(0x200)](),_0x1e7623=await master_shop[_0x232596(0x1c7)](),_0x595209=await email_settings[_0x232596(0x153)](),_0x595d9b=await supervisor_settings['find']();var _0x3b8dbe=_0xc01c40[_0x232596(0x158)],_0x3ded37='',_0x6a69e7;for(_0x6a69e7 in _0x3b8dbe){_0x3ded37+=_0x232596(0x19d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3b8dbe[_0x6a69e7]['product_name']+_0x232596(0x1df)+_0x232596(0x1f3)+_0x3b8dbe[_0x6a69e7][_0x232596(0x160)]+_0x232596(0x1df)+_0x232596(0x1f3)+_0x3b8dbe[_0x6a69e7][_0x232596(0x19a)]+'</td>'+_0x232596(0x1f3)+_0x3b8dbe[_0x6a69e7][_0x232596(0x1f2)]+'</td>'+_0x232596(0x1f3)+_0x3b8dbe[_0x6a69e7]['secondary_unit']+_0x232596(0x1df)+_0x232596(0x1f3)+_0xc01c40[_0x232596(0x20f)]+_0x232596(0x1df)+_0x232596(0x1f3)+_0x3b8dbe[_0x6a69e7][_0x232596(0x169)]+_0x232596(0x1df)+_0x232596(0x1f3)+_0x3b8dbe[_0x6a69e7]['storage']+_0x3b8dbe[_0x6a69e7][_0x232596(0x18b)]+_0x3b8dbe[_0x6a69e7][_0x232596(0x172)]+_0x3b8dbe[_0x6a69e7]['bin']+_0x3b8dbe[_0x6a69e7][_0x232596(0x1b3)][0x0]+_0x3b8dbe[_0x6a69e7][_0x232596(0x1e2)]+_0x232596(0x1df),_0x232596(0x21a);}let _0x5a59cc=nodemailer['createTransport']({'host':_0x595209[_0x232596(0x162)],'port':Number(_0x595209[_0x232596(0x17d)]),'secure':![],'auth':{'user':_0x595209[_0x232596(0x197)],'pass':_0x595209['password']}}),_0x4bde76={'from':_0x595209[_0x232596(0x197)],'to':_0x595d9b[0x0][_0x232596(0x1db)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x232596(0x174)+_0x232596(0x1d7)+_0x1e7623[0x0][_0x232596(0x187)],'cid':_0x232596(0x15f)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x232596(0x193)+'<div>'+_0x232596(0x14b)+'<div>'+_0x232596(0x1fb)+'</div>'+'<div>'+_0x232596(0x1d3)+_0x1e7623[0x0][_0x232596(0x1b1)]+_0x232596(0x1bd)+_0x232596(0x201)+_0x232596(0x201)+_0x232596(0x1d8)+'<div>'+_0x232596(0x175)+_0x232596(0x1dc)+_0xc01c40[_0x232596(0x1e4)]+'\x20'+_0x232596(0x155)+_0x232596(0x15b)+_0xc01c40[_0x232596(0x1d4)]+'\x20'+'</span>'+_0x232596(0x19c)+'</div>'+_0x232596(0x1cd)+_0x232596(0x216)+_0x232596(0x19d)+_0x232596(0x14a)+_0x232596(0x173)+_0x232596(0x1a7)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x232596(0x21d)+_0x232596(0x186)+_0x232596(0x21a)+_0x232596(0x159)+_0x232596(0x1ac)+'\x20'+_0x3ded37+'\x20'+_0x232596(0x21f)+_0x232596(0x1c1)+_0x232596(0x16d)+'<strong>\x20Regards\x20</strong>'+_0x232596(0x196)+_0x1e7623[0x0]['site_title']+_0x232596(0x19c)+'</div>'+_0x232596(0x201)+_0x232596(0x203)};_0x5a59cc[_0x232596(0x1c3)](_0x4bde76,function(_0x50de9a,_0xf5a01a){var _0x5d94bc=_0x232596;_0x50de9a?(console[_0x5d94bc(0x1d2)](_0x50de9a),console[_0x5d94bc(0x1d2)](_0x5d94bc(0x1ec))):console[_0x5d94bc(0x1d2)]('Email\x20sent\x20successfully');}),_0x4ab30b[_0x232596(0x1bf)](_0x232596(0x214),_0x232596(0x1b9)),_0x40611f[_0x232596(0x14f)](_0x232596(0x1a8)+_0x4a9def['_id']);}catch(_0x3e5755){console[_0x232596(0x1d2)](_0x3e5755),_0x40611f[_0x232596(0x182)](0xc8)[_0x232596(0x167)]({'message':_0x3e5755[_0x232596(0x18e)]});}}),router['get'](a0_0xab85ff(0x1d9),auth,async(_0x1b5f02,_0xc3fd8f)=>{var _0x59dec0=a0_0xab85ff;try{const {username:_0x1c9d50,email:_0x2cc41f,role:_0x5b81b4}=_0x1b5f02[_0x59dec0(0x18f)],_0x575a0b=_0x1b5f02[_0x59dec0(0x18f)],_0x34dca4=await profile[_0x59dec0(0x153)]({'email':_0x575a0b['email']}),_0x3f013c=await master_shop[_0x59dec0(0x1c7)](),_0x9d2297=_0x1b5f02[_0x59dec0(0x1c0)]['id'],_0x49761c=await adjustment[_0x59dec0(0x1c4)]({'_id':_0x9d2297}),_0x13f084=await purchases[_0x59dec0(0x211)]([{'$match':{'warehouse_name':_0x49761c[_0x59dec0(0x20f)]}},{'$unwind':_0x59dec0(0x1a1)},{'$group':{'_id':_0x59dec0(0x154)}}]),_0x46cae1=await product[_0x59dec0(0x1c7)]({}),_0x337773=await warehouse[_0x59dec0(0x211)]([{'$match':{'name':_0x49761c[_0x59dec0(0x20f)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x59dec0(0x1ef)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x59dec0(0x1b7)},'bin':{'$first':_0x59dec0(0x205)},'type':{'$first':_0x59dec0(0x1ba)},'floorlevel':{'$first':_0x59dec0(0x14c)},'primary_code':{'$first':_0x59dec0(0x1bc)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x59dec0(0x179)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x59dec0(0x213)},'maxPerUnit':{'$first':_0x59dec0(0x1ca)},'expiry_date':{'$first':_0x59dec0(0x1f1)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x59dec0(0x1f6)},'room':{'$first':'$room'}}}]);let _0x37c2d1;if(_0x575a0b['role']==_0x59dec0(0x1aa)){const _0xed9470=await staff[_0x59dec0(0x153)]({'email':_0x575a0b['email']});_0x37c2d1=await warehouse[_0x59dec0(0x211)]([{'$match':{'status':_0x59dec0(0x207),'name':_0xed9470[_0x59dec0(0x1c5)],'warehouse_category':_0x59dec0(0x1de),'name':{'$ne':_0x59dec0(0x165)}}},{'$group':{'_id':_0x59dec0(0x15e),'name':{'$first':_0x59dec0(0x15e)}}}]);}else _0x37c2d1=await warehouse[_0x59dec0(0x211)]([{'$match':{'status':'Enabled','warehouse_category':_0x59dec0(0x1de),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x59dec0(0x15e),'name':{'$first':_0x59dec0(0x15e)}}}]);if(_0x3f013c[0x0][_0x59dec0(0x221)]==_0x59dec0(0x1a6)){var _0x3f2970=users[_0x59dec0(0x1ce)];console[_0x59dec0(0x1d2)](_0x3f2970);}else{if(_0x3f013c[0x0][_0x59dec0(0x221)]==_0x59dec0(0x16a))var _0x3f2970=users[_0x59dec0(0x16a)];else{if(_0x3f013c[0x0][_0x59dec0(0x221)]==_0x59dec0(0x17c))var _0x3f2970=users[_0x59dec0(0x17c)];else{if(_0x3f013c[0x0][_0x59dec0(0x221)]==_0x59dec0(0x1f5))var _0x3f2970=users[_0x59dec0(0x1f5)];else{if(_0x3f013c[0x0][_0x59dec0(0x221)]==_0x59dec0(0x151))var _0x3f2970=users[_0x59dec0(0x151)];else{if(_0x3f013c[0x0][_0x59dec0(0x221)]==_0x59dec0(0x1b0))var _0x3f2970=users[_0x59dec0(0x17e)];else{if(_0x3f013c[0x0][_0x59dec0(0x221)]=='Chinese')var _0x3f2970=users[_0x59dec0(0x1ed)];else{if(_0x3f013c[0x0][_0x59dec0(0x221)]==_0x59dec0(0x1fe))var _0x3f2970=users['Arabic'];}}}}}}}_0xc3fd8f[_0x59dec0(0x181)](_0x59dec0(0x184),{'success':_0x1b5f02[_0x59dec0(0x1bf)](_0x59dec0(0x214)),'errors':_0x1b5f02['flash'](_0x59dec0(0x1c6)),'role':_0x575a0b,'profile':_0x34dca4,'adjustment':_0x49761c,'stock':_0x337773,'master_shop':_0x3f013c,'warehouse_name':_0x13f084,'unit':_0x46cae1,'language':_0x3f2970,'warehouse':_0x37c2d1});}catch(_0x29b16f){console['log'](_0x29b16f),_0xc3fd8f['status'](0xc8)['json']({'message':_0x29b16f[_0x59dec0(0x18e)]});}}),router[a0_0xab85ff(0x20b)](a0_0xab85ff(0x1d9),auth,async(_0x5c2a2b,_0x3a2f95)=>{var _0x50260e=a0_0xab85ff;try{const _0x4152f5=_0x5c2a2b[_0x50260e(0x1c0)]['id'],_0x594d78=await adjustment[_0x50260e(0x1c4)]({'_id':_0x4152f5}),_0x4caaa1=await warehouse[_0x50260e(0x153)]({'name':_0x594d78[_0x50260e(0x20f)],'room':_0x594d78[_0x50260e(0x163)]}),{warehouse_name:_0x34b25e,date:_0x17a156,prod_name:_0x1a726f,level:_0x17c283,isle:_0x934c47,pallet:_0x4139db,stock:_0x5b940c,types:_0x412336,adjust_qty:_0x36af1d,new_adjust_qty:_0x42ad40,note:_0x539656,Room_name:_0x30e4ef,invoice:_0x5053f9,JO_number:_0x5916f1,expiry_date:_0x534196}=_0x5c2a2b[_0x50260e(0x17a)];if(typeof _0x1a726f=='string')var _0x180fdc=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x1e8)]],_0x1f6d6d=[_0x5c2a2b['body'][_0x50260e(0x191)]],_0x395330=[_0x5c2a2b[_0x50260e(0x17a)]['stock']],_0x49dd0a=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x1e3)]],_0x547b81=[_0x5c2a2b['body'][_0x50260e(0x16b)]],_0xe07d47=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x220)]],_0x3a9e74=[_0x5c2a2b[_0x50260e(0x17a)]['Primary_Units']],_0x130b1e=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x212)]],_0x17f6ba=[_0x5c2a2b[_0x50260e(0x17a)]['prod_code']],_0x4fac5d=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x157)]],_0x55dd54=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x14e)]],_0x4b5673=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x178)]],_0x259954=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x17b)]],_0x455d42=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x166)]],_0x411150=[_0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x1ad)]],_0x219c34=[_0x5c2a2b[_0x50260e(0x17a)]['prime1']],_0x2622b1=[_0x5c2a2b['body'][_0x50260e(0x171)]];else var _0x180fdc=[..._0x5c2a2b[_0x50260e(0x17a)]['prod_name']],_0x1f6d6d=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x191)]],_0x395330=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x168)]],_0x49dd0a=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x1e3)]],_0x547b81=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x16b)]],_0xe07d47=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x220)]],_0x3a9e74=[..._0x5c2a2b[_0x50260e(0x17a)]['unit']],_0x130b1e=[..._0x5c2a2b['body'][_0x50260e(0x212)]],_0x17f6ba=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x189)]],_0x4fac5d=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x157)]],_0x55dd54=[..._0x5c2a2b['body'][_0x50260e(0x14e)]],_0x4b5673=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x178)]],_0x259954=[..._0x5c2a2b['body'][_0x50260e(0x17b)]],_0x455d42=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x166)]],_0x411150=[..._0x5c2a2b['body'][_0x50260e(0x1ad)]],_0x219c34=[..._0x5c2a2b[_0x50260e(0x17a)]['prime1']],_0x2622b1=[..._0x5c2a2b[_0x50260e(0x17a)][_0x50260e(0x171)]];const _0x25e6e0=_0x180fdc[_0x50260e(0x1d6)](_0xbf67a=>{return _0xbf67a={'product_name':_0xbf67a};});_0x1f6d6d['forEach']((_0x157f22,_0x43388)=>{var _0x4767ea=_0x50260e;_0x411150[_0x4767ea(0x152)]((_0x126c78,_0x35d53f)=>{var _0x2d0965=_0x4767ea;if(_0x126c78==_0x2d0965(0x1be)&&_0x43388==_0x35d53f){var _0xec940=_0x157f22['slice'](0x3);_0x25e6e0[_0x43388][_0x2d0965(0x1f0)]=_0x157f22[0x0],_0x25e6e0[_0x43388][_0x2d0965(0x18b)]=_0x157f22[0x1],_0x25e6e0[_0x43388][_0x2d0965(0x172)]=0x0,_0x25e6e0[_0x43388]['bin']=0x0,_0x25e6e0[_0x43388][_0x2d0965(0x1b3)]=_0x2d0965(0x16e),_0x25e6e0[_0x43388][_0x2d0965(0x1e2)]=_0xec940;}else{if(_0x126c78=='Shelves'&&_0x43388==_0x35d53f){var _0xec940=_0x157f22[_0x2d0965(0x208)](0x3);_0x25e6e0[_0x43388]['storage']=_0x157f22[0x0],_0x25e6e0[_0x43388][_0x2d0965(0x18b)]=_0x157f22[0x1],_0x25e6e0[_0x43388]['bay']=0x0,_0x25e6e0[_0x43388][_0x2d0965(0x209)]=0x0,_0x25e6e0[_0x43388][_0x2d0965(0x1b3)]=_0x2d0965(0x16e),_0x25e6e0[_0x43388][_0x2d0965(0x1e2)]=_0x157f22[0x5];}else{if(_0x43388==_0x35d53f){var _0xfea0c1;if(_0x157f22[0x4]=='L')_0xfea0c1=_0x2d0965(0x1c9);else _0x157f22[0x4]=='F'&&(_0xfea0c1='Floor');_0x25e6e0[_0x43388][_0x2d0965(0x1f0)]=_0x157f22[0x0],_0x25e6e0[_0x43388][_0x2d0965(0x18b)]=_0x157f22[0x1],_0x25e6e0[_0x43388][_0x2d0965(0x172)]=_0x157f22[0x2],_0x25e6e0[_0x43388][_0x2d0965(0x209)]=_0x157f22[0x3],_0x25e6e0[_0x43388][_0x2d0965(0x1b3)]=_0xfea0c1,_0x25e6e0[_0x43388]['floorlevel']=_0x157f22[0x5];}}}});}),_0x395330[_0x50260e(0x152)]((_0x1ab3a2,_0x2c6c84)=>{_0x25e6e0[_0x2c6c84]['stockBefore']=_0x1ab3a2;}),_0x49dd0a['forEach']((_0x1ec4a9,_0x545a58)=>{var _0x41ac3c=_0x50260e;_0x25e6e0[_0x545a58][_0x41ac3c(0x1e3)]=_0x1ec4a9;}),_0x547b81['forEach']((_0x43c687,_0x1c9462)=>{_0x25e6e0[_0x1c9462]['adjust_qty']=_0x43c687;}),_0xe07d47['forEach']((_0x498c85,_0x54ccdb)=>{var _0x2c2c1b=_0x50260e;_0x25e6e0[_0x54ccdb][_0x2c2c1b(0x161)]=_0x498c85;}),_0x3a9e74[_0x50260e(0x152)]((_0x12afca,_0x481b5b)=>{var _0x1dbd71=_0x50260e;_0x25e6e0[_0x481b5b][_0x1dbd71(0x1f2)]=_0x12afca;}),_0x130b1e[_0x50260e(0x152)]((_0x468c98,_0x5e71c0)=>{var _0x4bef65=_0x50260e;_0x25e6e0[_0x5e71c0][_0x4bef65(0x14d)]=_0x468c98;}),_0x17f6ba[_0x50260e(0x152)]((_0x2f5cf0,_0x426df0)=>{var _0x210279=_0x50260e;_0x25e6e0[_0x426df0][_0x210279(0x160)]=_0x2f5cf0;}),_0x4fac5d[_0x50260e(0x152)]((_0x279da8,_0xda0b88)=>{var _0x1ede65=_0x50260e;_0x25e6e0[_0xda0b88][_0x1ede65(0x157)]=_0x279da8;}),_0x55dd54['forEach']((_0x616e7d,_0x43b62b)=>{var _0x5e361f=_0x50260e;_0x25e6e0[_0x43b62b][_0x5e361f(0x14e)]=_0x616e7d;}),_0x4b5673[_0x50260e(0x152)]((_0x546145,_0x5dbba9)=>{var _0x468eb6=_0x50260e;_0x25e6e0[_0x5dbba9][_0x468eb6(0x1e7)]=_0x546145;}),_0x259954[_0x50260e(0x152)]((_0x22de99,_0x4df56a)=>{var _0x443ac2=_0x50260e;_0x25e6e0[_0x4df56a][_0x443ac2(0x17b)]=_0x22de99;}),_0x455d42[_0x50260e(0x152)]((_0x460e8a,_0x1542e8)=>{var _0x485464=_0x50260e;_0x25e6e0[_0x1542e8][_0x485464(0x166)]=_0x460e8a;}),_0x411150[_0x50260e(0x152)]((_0x4d49fb,_0xc09824)=>{var _0x7a8fa9=_0x50260e;_0x25e6e0[_0xc09824][_0x7a8fa9(0x169)]=_0x4d49fb;}),_0x219c34[_0x50260e(0x152)]((_0x571b5e,_0x32e3ba)=>{var _0x360818=_0x50260e;_0x25e6e0[_0x32e3ba][_0x360818(0x1cc)]=_0x571b5e;}),_0x2622b1[_0x50260e(0x152)]((_0x19f25f,_0x5cd1dd)=>{var _0x130bec=_0x50260e;_0x25e6e0[_0x5cd1dd][_0x130bec(0x20d)]=_0x19f25f;});const _0x46f551=_0x25e6e0[_0x50260e(0x194)](_0x320693=>_0x320693['adjust_qty']!=='0'&&_0x320693[_0x50260e(0x19a)]!=='');var _0x1beec9=0x0;_0x46f551['forEach'](_0x265b98=>{var _0x409caa=_0x50260e;console['log'](_0x409caa(0x1f9),_0x265b98),parseInt(_0x265b98[_0x409caa(0x19a)])<=0x0&&_0x1beec9++;});if(_0x1beec9!=0x0)return _0x5c2a2b['flash'](_0x50260e(0x1c6),_0x50260e(0x21c)),_0x3a2f95[_0x50260e(0x14f)](_0x50260e(0x1a3));_0x594d78['warehouse_name']=_0x34b25e,_0x594d78[_0x50260e(0x1d4)]=_0x17a156,_0x594d78[_0x50260e(0x158)]=_0x46f551,_0x594d78[_0x50260e(0x1a5)]=_0x539656,_0x594d78[_0x50260e(0x1e4)]=_0x5053f9,_0x594d78[_0x50260e(0x1f7)]=_0x50260e(0x199);const _0x548e4b=await _0x594d78['save']();_0x5c2a2b[_0x50260e(0x1bf)](_0x50260e(0x214),_0x50260e(0x1cb)),_0x3a2f95[_0x50260e(0x14f)](_0x50260e(0x1bb));}catch(_0x444354){console['log'](_0x444354);}}),router[a0_0xab85ff(0x20b)](a0_0xab85ff(0x206),async(_0x5aa580,_0x36782e)=>{var _0x3c2666=a0_0xab85ff;const {primary_code:_0x261091,warehouse_data:_0x223793,rooms_data:_0x487ba5,Roomslist:_0x36774f}=_0x5aa580['body'],_0x162277=_0x36774f['split'](','),_0x563b71=[];async function _0x3942a6(_0x353000){var _0x30d513=a0_0x9616;const _0x48d87d=await warehouse[_0x30d513(0x211)]([{'$match':{'name':_0x223793,'room':_0x353000}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x261091}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x30d513(0x1ef)},'product_stock':{'$first':_0x30d513(0x21b)},'primary_code':{'$first':_0x30d513(0x1bc)},'secondary_code':{'$first':_0x30d513(0x1d1)},'product_code':{'$first':_0x30d513(0x179)},'level':{'$first':_0x30d513(0x1b7)},'isle':{'$first':_0x30d513(0x205)},'type':{'$first':_0x30d513(0x1ba)},'pallet':{'$first':_0x30d513(0x14c)},'unit':{'$first':_0x30d513(0x215)},'secondary_unit':{'$first':_0x30d513(0x192)},'storage':{'$first':_0x30d513(0x1c8)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x30d513(0x1f1)},'production_date':{'$first':_0x30d513(0x195)},'maxPerUnit':{'$first':_0x30d513(0x1ca)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x30d513(0x183)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x30d513(0x219)}}}]),_0x47d383=await warehouse['aggregate']([{'$match':{'name':_0x223793,'room':_0x353000}},{'$unwind':_0x30d513(0x188)},{'$match':{'product_details.secondary_code':_0x261091}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x30d513(0x1d1)},'product_code':{'$first':_0x30d513(0x179)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x30d513(0x205)},'type':{'$first':_0x30d513(0x1ba)},'pallet':{'$first':_0x30d513(0x14c)},'unit':{'$first':_0x30d513(0x215)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x30d513(0x1c8)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x30d513(0x1f1)},'production_date':{'$first':_0x30d513(0x195)},'maxPerUnit':{'$first':_0x30d513(0x1ca)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x30d513(0x183)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x30d513(0x18d)}}}]);if(_0x48d87d[_0x30d513(0x18c)]>0x0)_0x563b71[_0x30d513(0x176)](_0x48d87d);else _0x47d383[_0x30d513(0x18c)]>0x0&&_0x563b71[_0x30d513(0x176)](_0x47d383);}const _0xd9a37a=_0x162277[_0x3c2666(0x1d6)](_0x3d0799=>_0x3942a6(_0x3d0799));await Promise[_0x3c2666(0x1ff)](_0xd9a37a),_0x36782e[_0x3c2666(0x167)](_0x563b71);}),router[a0_0xab85ff(0x20b)](a0_0xab85ff(0x1ae),async(_0x357035,_0x1f268e)=>{var _0x1bd08a=a0_0xab85ff;const {primaryCode:_0x5e28a4,secondaryCode:_0x27db2a,productCode:_0x4ad3bb,level:_0x87da6c,isle:_0x3ceb4c,pallet:_0x5e5a13,warehouses:_0x142372,room:_0x14b531}=_0x357035[_0x1bd08a(0x17a)];try{const _0x5c0ae1=await warehouse[_0x1bd08a(0x211)]([{'$match':{'name':_0x142372,'room':_0x14b531}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x87da6c),'product_details.isle':_0x3ceb4c,'product_details.pallet':parseInt(_0x5e5a13)}},{'$group':{'_id':_0x1bd08a(0x156),'name':{'$first':_0x1bd08a(0x1ef)},'product_stock':{'$first':_0x1bd08a(0x21b)},'level':{'$first':_0x1bd08a(0x150)},'isle':{'$first':_0x1bd08a(0x1d0)},'pallet':{'$first':_0x1bd08a(0x1a2)},'maxProducts':{'$first':_0x1bd08a(0x18a)}}}]);_0x1f268e[_0x1bd08a(0x182)](0xc8)[_0x1bd08a(0x167)](_0x5c0ae1);}catch(_0x51f140){_0x1f268e[_0x1bd08a(0x182)](0x194)[_0x1bd08a(0x167)]({'message':_0x51f140[_0x1bd08a(0x18e)]});}}),module[a0_0xab85ff(0x17f)]=router;