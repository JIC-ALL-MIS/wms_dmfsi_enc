function a0_0x12eb(){var _0xad8415=['$product_details.primary_code','</table>','../middleware/auth','/view/add_adjustment','max_per_unit','\x20Order\x20Number\x20:\x20','level','findOne','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','message','random','redirect','string','host','German','toString','prod_invoice','floorlevel','site_title','master','split','aggregate','$product_details.storage','flash','$product_details.product_code','$product_details.invoice','/view/:id','map','11ZDPmvq','secondary_code','$product_details.maxProducts','expiry_date','$invoice','</td>','$product_details.level','id_transaction','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','post','$product_details.product_cat','Chinese','<h2>\x20','/picking_list/PDF_adjustment_rm/','Rooms','$product_details.batch_code','type','prime1','adjustment\x20Finalized\x20successfully','rack','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<!DOCTYPE\x20html>','email','room','id_transaction_from','$product_details.rack','Shelves','Hindi','error','product_code','findById','<h5>','$product_details.secondary_unit','$product_details._id','invoice','errors','/preview/:id','55vYbzeW','ADJ-','../models/all_models','unit','catch','status','27qQEijQ','product','Error\x20Occurs','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Level','RMSEmail','$product_details.secondary_code','second1','then','$product_details.maxPerUnit','password','slice','params','room_names','product_name','secondary_unit','body','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','save','Arabic','</head><body>','prod_code','product_stock','$product','Secondary_units','$product_details.bin','English','New_Qty_Converted','2502924nSkSuY','back','There\x27s\x20a\x20error\x20in\x20this\x20transaction','adjustment','$room','<tbody\x20style=\x22text-align:\x20center;\x22>','$warehouse_name','541616vYcGYn','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','render','Portuguese\x20(BR)','Raw\x20Materials','get','logo','role','log','date','Adjustment\x20Mail','push','warehouse','183316FnZXhr','</h5>','foreach\x20newproduct','sendMail','</div>','Return\x20Goods','bay','698652plJSRL','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','user','$product_details.expiry_date','stockBefore','<hr\x20class=\x22my-3\x22>','$_id','language','</tr>','2496776rnxAFa','</thead>','<span\x20style=\x22float:\x20right;\x22>','all','New_Qty_Converted_adj','</tbody>','edit_adjustment_view','../public/language/languages.json','/CheckingWarehouse','_id','Spanish','1WCnYQn','find','Enclosed','stock','$product_details.production_date','bin','$product_details.product_stock','maxperunit','<table\x20style=\x22width:\x20100%\x20!important;\x22>','storage','$name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','French','production_date','length','Receiving\x20Area','padStart','minus','image','$finalize','json','batch_code','success','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$isAllowEdit','$product_details.unit','</body></html>','primary_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','warehouse_name','edit_adjustment','prod_name','\x20</h2>','forEach','$product_details.floorlevel','$product.product_name','/adjustment/view','/barcode_scanner','Floor','Portuguese','$product_details.isle','product_details','staff','types','adjust_qty','An\x20error\x20occurred\x20while\x20saving\x20data.','True','/../public','Arabic\x20(ae)','Enabled','port','English\x20(US)','adjustment\x20data\x20update\x20successfully','$product_details.product_name','filter','$product_details.pallet','False','$product_details.type','5686464ZFedYj','$product_details','prod_cat','28293830kKiyAL','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'];a0_0x12eb=function(){return _0xad8415;};return a0_0x12eb();}var a0_0x55c68b=a0_0x542a;(function(_0x31f6b2,_0x5b6e5c){var _0x584e84=a0_0x542a,_0x444af7=_0x31f6b2();while(!![]){try{var _0x31b895=parseInt(_0x584e84(0x14b))/0x1*(parseInt(_0x584e84(0x140))/0x2)+parseInt(_0x584e84(0x11c))/0x3+parseInt(_0x584e84(0x130))/0x4*(parseInt(_0x584e84(0x1cd))/0x5)+-parseInt(_0x584e84(0x137))/0x6+parseInt(_0x584e84(0x185))/0x7+-parseInt(_0x584e84(0x123))/0x8*(-parseInt(_0x584e84(0xff))/0x9)+parseInt(_0x584e84(0x188))/0xa*(-parseInt(_0x584e84(0x1a7))/0xb);if(_0x31b895===_0x5b6e5c)break;else _0x444af7['push'](_0x444af7['shift']());}catch(_0x38a05e){_0x444af7['push'](_0x444af7['shift']());}}}(a0_0x12eb,0xa0440));function a0_0x542a(_0x333253,_0x490005){var _0x12eb1a=a0_0x12eb();return a0_0x542a=function(_0x542a02,_0x43baab){_0x542a02=_0x542a02-0xfe;var _0x3735e1=_0x12eb1a[_0x542a02];return _0x3735e1;},a0_0x542a(_0x333253,_0x490005);}const express=require('express'),app=express(),router=express['Router'](),auth=require(a0_0x55c68b(0x18c)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x55c68b(0x1cf)),users=require(a0_0x55c68b(0x147)),nodemailer=require('nodemailer');router['get']('/view',auth,async(_0x413905,_0x416400)=>{var _0x3a2381=a0_0x55c68b;try{const {username:_0x3286ae,email:_0x5979a2,role:_0x2cfef2}=_0x413905[_0x3a2381(0x139)],_0x6d7549=_0x413905['user'],_0x1a905c=await profile[_0x3a2381(0x191)]({'email':_0x6d7549[_0x3a2381(0x1be)]}),_0x29ed48=await master_shop[_0x3a2381(0x14c)]();console[_0x3a2381(0x12b)](_0x3a2381(0x19e),_0x29ed48);let _0x44e181;if(_0x6d7549[_0x3a2381(0x12a)]==_0x3a2381(0x175)){const _0x184400=await staff[_0x3a2381(0x191)]({'email':_0x6d7549[_0x3a2381(0x1be)]});_0x44e181=await warehouse[_0x3a2381(0x14c)]({'status':'Enabled','name':_0x184400[_0x3a2381(0x12f)]});}else _0x44e181=await warehouse[_0x3a2381(0x14c)]({'status':'Enabled'});const _0x2cbc6a=await product[_0x3a2381(0x14c)]();let _0x40cb61;if(_0x6d7549['role']==_0x3a2381(0x175)){const _0x1d8949=await staff[_0x3a2381(0x191)]({'email':_0x6d7549[_0x3a2381(0x1be)]});_0x40cb61=await adjustment[_0x3a2381(0x14c)]({'warehouse_name':_0x1d8949[_0x3a2381(0x12f)]});}else _0x40cb61=await adjustment[_0x3a2381(0x1a0)]([{'$unwind':_0x3a2381(0x117)},{'$group':{'_id':_0x3a2381(0x13d),'invoice':{'$first':_0x3a2381(0x1ab)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x3a2381(0x122)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x3a2381(0x15e)},'isAllowEdit':{'$first':_0x3a2381(0x163)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x29ed48[0x0][_0x3a2381(0x13e)]==_0x3a2381(0x17e)){var _0x55baaa=users[_0x3a2381(0x11a)];console[_0x3a2381(0x12b)](_0x55baaa);}else{if(_0x29ed48[0x0]['language']==_0x3a2381(0x1c3))var _0x55baaa=users['Hindi'];else{if(_0x29ed48[0x0]['language']==_0x3a2381(0x199))var _0x55baaa=users[_0x3a2381(0x199)];else{if(_0x29ed48[0x0][_0x3a2381(0x13e)]==_0x3a2381(0x14a))var _0x55baaa=users[_0x3a2381(0x14a)];else{if(_0x29ed48[0x0][_0x3a2381(0x13e)]==_0x3a2381(0x157))var _0x55baaa=users[_0x3a2381(0x157)];else{if(_0x29ed48[0x0][_0x3a2381(0x13e)]==_0x3a2381(0x126))var _0x55baaa=users[_0x3a2381(0x172)];else{if(_0x29ed48[0x0][_0x3a2381(0x13e)]=='Chinese')var _0x55baaa=users[_0x3a2381(0x1b3)];else{if(_0x29ed48[0x0][_0x3a2381(0x13e)]==_0x3a2381(0x17b))var _0x55baaa=users['Arabic'];}}}}}}}_0x416400[_0x3a2381(0x125)](_0x3a2381(0x11f),{'success':_0x413905[_0x3a2381(0x1a2)](_0x3a2381(0x161)),'errors':_0x413905[_0x3a2381(0x1a2)](_0x3a2381(0x1cb)),'role':_0x6d7549,'profile':_0x1a905c,'warehouse':_0x44e181,'product':_0x2cbc6a,'adjustment':_0x40cb61,'master_shop':_0x29ed48,'language':_0x55baaa});}catch(_0x565e3c){console[_0x3a2381(0x12b)](_0x565e3c);}});async function getRandom8DigitNumber(){var _0x2f1b28=a0_0x55c68b;const _0x4ffa1c=0x989680,_0x18100c=0x5f5e0ff,_0x55266d=Math['floor'](Math[_0x2f1b28(0x195)]()*(_0x18100c-_0x4ffa1c+0x1))+_0x4ffa1c;var _0x1ecddc;const _0xec3ef6=await adjustment[_0x2f1b28(0x191)]({'invoice':_0x2f1b28(0x1ce)+_0x55266d});return _0xec3ef6&&_0xec3ef6[_0x2f1b28(0x159)]>0x0?_0x1ecddc=_0x2f1b28(0x1ce)+_0x55266d:_0x1ecddc=_0x2f1b28(0x1ce)+_0x55266d,_0x1ecddc;}router[a0_0x55c68b(0x128)](a0_0x55c68b(0x18d),auth,async(_0x25bea9,_0x5a46e5)=>{var _0xf50785=a0_0x55c68b;try{const {username:_0x5b7a7d,email:_0x3bc06e,role:_0x5db809}=_0x25bea9[_0xf50785(0x139)],_0x581e2b=_0x25bea9['user'],_0x260ebc=await profile[_0xf50785(0x191)]({'email':_0x581e2b[_0xf50785(0x1be)]}),_0x5667e8=await master_shop['find']();let _0x2de3ec;if(_0x581e2b['role']==_0xf50785(0x175)){const _0x1edc6a=await staff[_0xf50785(0x191)]({'email':_0x581e2b[_0xf50785(0x1be)]});_0x2de3ec=await warehouse['aggregate']([{'$match':{'status':_0xf50785(0x17c),'name':_0x1edc6a[_0xf50785(0x12f)],'warehouse_category':_0xf50785(0x127),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0xf50785(0x155)}}}]);}else _0x2de3ec=await warehouse[_0xf50785(0x1a0)]([{'$match':{'status':_0xf50785(0x17c),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xf50785(0x135)}}},{'$group':{'_id':'$name','name':{'$first':_0xf50785(0x155)}}}]);const _0x2c59fc=await product[_0xf50785(0x14c)]({}),_0x19a46f=await adjustment[_0xf50785(0x14c)]({}),_0x76dd35=_0x19a46f[_0xf50785(0x159)]+0x1,_0x11d338='ADJ-'+_0x76dd35[_0xf50785(0x19a)]()[_0xf50785(0x15b)](0x5,'0');var _0x192b77=['Ambient',_0xf50785(0x14d),'Return\x20Rooms'];if(_0x5667e8[0x0][_0xf50785(0x13e)]=='English\x20(US)')var _0x254b35=users[_0xf50785(0x11a)];else{if(_0x5667e8[0x0][_0xf50785(0x13e)]==_0xf50785(0x1c3))var _0x254b35=users['Hindi'];else{if(_0x5667e8[0x0][_0xf50785(0x13e)]=='German')var _0x254b35=users[_0xf50785(0x199)];else{if(_0x5667e8[0x0][_0xf50785(0x13e)]==_0xf50785(0x14a))var _0x254b35=users[_0xf50785(0x14a)];else{if(_0x5667e8[0x0][_0xf50785(0x13e)]==_0xf50785(0x157))var _0x254b35=users['French'];else{if(_0x5667e8[0x0][_0xf50785(0x13e)]==_0xf50785(0x126))var _0x254b35=users[_0xf50785(0x172)];else{if(_0x5667e8[0x0][_0xf50785(0x13e)]==_0xf50785(0x1b3))var _0x254b35=users[_0xf50785(0x1b3)];else{if(_0x5667e8[0x0]['language']==_0xf50785(0x17b))var _0x254b35=users['Arabic'];}}}}}}}const _0x2b58b1=getRandom8DigitNumber();_0x2b58b1[_0xf50785(0x108)](_0x57161b=>{var _0x2e7243=_0xf50785;_0x5a46e5['render']('add_adjustment',{'success':_0x25bea9['flash'](_0x2e7243(0x161)),'errors':_0x25bea9[_0x2e7243(0x1a2)](_0x2e7243(0x1cb)),'role':_0x581e2b,'profile':_0x260ebc,'warehouse':_0x2de3ec,'product':_0x2c59fc,'master_shop':_0x5667e8,'language':_0x254b35,'rooms_data':_0x192b77,'invoice_no':_0x57161b});})[_0xf50785(0x1d1)](_0xfb3797=>{var _0x2e08da=_0xf50785;_0x25bea9[_0x2e08da(0x1a2)](_0x2e08da(0x1cb),_0x2e08da(0x11e)),_0x5a46e5[_0x2e08da(0x196)](_0x2e08da(0x16f));});}catch(_0x245b6d){console['log'](_0x245b6d);}}),router[a0_0x55c68b(0x1b1)](a0_0x55c68b(0x18d),auth,async(_0x3c26a8,_0x5f0d77)=>{var _0x30936a=a0_0x55c68b;try{const {warehouse_name:_0x1b06fe,date:_0x33a4e0,prod_name:_0x16690c,level:_0x3ddadf,isle:_0x5da098,pallet:_0x50d785,stock:_0x27aa88,types:_0x2bd9c7,adjust_qty:_0x3b3573,new_adjust_qty:_0xffaf24,note:_0x56acfe,Room_name:_0x3825fe,invoice:_0x31c98a,JO_number:_0x2b4698,expiry_date:_0x52a6fd}=_0x3c26a8[_0x30936a(0x110)];if(typeof _0x16690c==_0x30936a(0x197))var _0x179357=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x16a)]],_0xe93b95=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x190)]],_0x33fd6c=[_0x3c26a8['body'][_0x30936a(0x14e)]],_0x5e1bd5=[_0x3c26a8[_0x30936a(0x110)]['types']],_0x28c0dc=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x144)]],_0x5d6067=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x11b)]],_0x21c72e=[_0x3c26a8[_0x30936a(0x110)]['Primary_Units']],_0x4879b7=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x118)]],_0xfffe57=[_0x3c26a8[_0x30936a(0x110)]['prod_code']],_0x4d6162=[_0x3c26a8['body']['batch_code']],_0xaa4477=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x1aa)]],_0x2c2f29=[_0x3c26a8[_0x30936a(0x110)]['max_per_unit']],_0x2db27a=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x158)]],_0x1f9c0b=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x187)]],_0x15163f=[_0x3c26a8['body']['Rooms']],_0x225804=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x1b9)]],_0x4c3694=[_0x3c26a8['body'][_0x30936a(0x107)]],_0x1b394d=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x19b)]],_0x3bf907=[_0x3c26a8[_0x30936a(0x110)][_0x30936a(0x1ae)]];else var _0x179357=[..._0x3c26a8[_0x30936a(0x110)]['prod_name']],_0xe93b95=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x190)]],_0x33fd6c=[..._0x3c26a8['body'][_0x30936a(0x14e)]],_0x5e1bd5=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x176)]],_0x28c0dc=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x144)]],_0x5d6067=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x11b)]],_0x21c72e=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x1d0)]],_0x4879b7=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x118)]],_0xfffe57=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x115)]],_0x4d6162=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x160)]],_0xaa4477=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x1aa)]],_0x2c2f29=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x18e)]],_0x2db27a=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x158)]],_0x1f9c0b=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x187)]],_0x15163f=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x1b6)]],_0x225804=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x1b9)]],_0x4c3694=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x107)]],_0x1b394d=[..._0x3c26a8[_0x30936a(0x110)][_0x30936a(0x19b)]],_0x3bf907=[..._0x3c26a8['body'][_0x30936a(0x1ae)]];const _0x3ee2b9=_0x179357[_0x30936a(0x1a6)](_0x11197e=>{return _0x11197e={'product_name':_0x11197e};});_0xe93b95[_0x30936a(0x16c)]((_0x30eb6c,_0x3a81b0)=>{var _0x568d8d=_0x30936a;_0x15163f[_0x568d8d(0x16c)]((_0x308ba2,_0x59861e)=>{var _0x3b37ab=_0x568d8d;if(_0x308ba2==_0x3b37ab(0x15a)&&_0x3a81b0==_0x59861e){var _0x5292f7=_0x30eb6c[_0x3b37ab(0x10b)](0x3);_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x154)]=_0x30eb6c[0x0],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x1bb)]=_0x30eb6c[0x1],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x136)]=0x0,_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x150)]=0x0,_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x1b8)]='Floor',_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x19c)]=_0x5292f7;}else{if(_0x308ba2==_0x3b37ab(0x1c2)&&_0x3a81b0==_0x59861e){var _0x5292f7=_0x30eb6c['slice'](0x3);_0x3ee2b9[_0x3a81b0]['storage']=_0x30eb6c[0x0],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x1bb)]=_0x30eb6c[0x1],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x136)]=0x0,_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x150)]=0x0,_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x1b8)]=_0x3b37ab(0x171),_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x19c)]=_0x30eb6c[0x5];}else{if(_0x3a81b0==_0x59861e){var _0x137f28;if(_0x30eb6c[0x4]=='L')_0x137f28='Level';else _0x30eb6c[0x4]=='F'&&(_0x137f28='Floor');_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x154)]=_0x30eb6c[0x0],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x1bb)]=_0x30eb6c[0x1],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x136)]=_0x30eb6c[0x2],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x150)]=_0x30eb6c[0x3],_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x1b8)]=_0x137f28,_0x3ee2b9[_0x3a81b0][_0x3b37ab(0x19c)]=_0x30eb6c[0x5];}}}});}),_0x33fd6c[_0x30936a(0x16c)]((_0x5d5c65,_0x5e93e5)=>{var _0x5dda37=_0x30936a;_0x3ee2b9[_0x5e93e5][_0x5dda37(0x13b)]=_0x5d5c65;}),_0x3bf907[_0x30936a(0x16c)]((_0x3db9ee,_0x3af057)=>{var _0x255363=_0x30936a;_0x3ee2b9[_0x3af057][_0x255363(0x1c0)]=_0x3db9ee;}),_0x5e1bd5['forEach']((_0x142b0f,_0x36f0c9)=>{_0x3ee2b9[_0x36f0c9]['types']=_0x142b0f;}),_0x28c0dc['forEach']((_0x361807,_0x5e90e8)=>{var _0x21faea=_0x30936a;_0x3ee2b9[_0x5e90e8][_0x21faea(0x177)]=_0x361807;}),_0x5d6067['forEach']((_0x3e9e06,_0x1af09d)=>{_0x3ee2b9[_0x1af09d]['new_adjust_qty']=_0x3e9e06;}),_0x21c72e[_0x30936a(0x16c)]((_0x47b399,_0x208cc7)=>{_0x3ee2b9[_0x208cc7]['unit']=_0x47b399;}),_0x4879b7[_0x30936a(0x16c)]((_0x2538df,_0x3b31e1)=>{var _0x5d0c50=_0x30936a;_0x3ee2b9[_0x3b31e1][_0x5d0c50(0x10f)]=_0x2538df;}),_0xfffe57[_0x30936a(0x16c)]((_0x12d27b,_0x1777fb)=>{var _0x30ee21=_0x30936a;_0x3ee2b9[_0x1777fb][_0x30ee21(0x1c5)]=_0x12d27b;}),_0x4d6162['forEach']((_0x2652e3,_0x41186e)=>{var _0x54ec37=_0x30936a;_0x3ee2b9[_0x41186e][_0x54ec37(0x160)]=_0x2652e3;}),_0xaa4477[_0x30936a(0x16c)]((_0x5c2cab,_0x240fbd)=>{var _0x5bab88=_0x30936a;_0x3ee2b9[_0x240fbd][_0x5bab88(0x1aa)]=_0x5c2cab;}),_0x2c2f29[_0x30936a(0x16c)]((_0x15314c,_0x406e5c)=>{var _0x4d785b=_0x30936a;_0x3ee2b9[_0x406e5c][_0x4d785b(0x152)]=_0x15314c;}),_0x2db27a['forEach']((_0x5322a8,_0x287ba4)=>{var _0x23e43b=_0x30936a;_0x3ee2b9[_0x287ba4][_0x23e43b(0x158)]=_0x5322a8;}),_0x1f9c0b[_0x30936a(0x16c)]((_0x3fd831,_0xc038e2)=>{var _0xc97187=_0x30936a;_0x3ee2b9[_0xc038e2][_0xc97187(0x187)]=_0x3fd831;}),_0x15163f[_0x30936a(0x16c)]((_0x534461,_0x330872)=>{var _0x4e0508=_0x30936a;_0x3ee2b9[_0x330872][_0x4e0508(0x10d)]=_0x534461;}),_0x225804[_0x30936a(0x16c)]((_0x228d62,_0x436f0e)=>{var _0x545909=_0x30936a;_0x3ee2b9[_0x436f0e][_0x545909(0x166)]=_0x228d62;}),_0x4c3694[_0x30936a(0x16c)]((_0x26121d,_0x55c210)=>{var _0x3d124d=_0x30936a;_0x3ee2b9[_0x55c210][_0x3d124d(0x1a8)]=_0x26121d;}),_0x1b394d[_0x30936a(0x16c)]((_0x33a070,_0x427b81)=>{var _0xa2bc61=_0x30936a;_0x3ee2b9[_0x427b81][_0xa2bc61(0x1ca)]=_0x33a070;});const _0x573d21=_0x3ee2b9['filter'](_0x562348=>_0x562348[_0x30936a(0x177)]!=='0'&&_0x562348[_0x30936a(0x177)]!=='');var _0x32f2b1=0x0;_0x573d21['forEach'](_0x5dcc7a=>{var _0x25b7ab=_0x30936a;console[_0x25b7ab(0x12b)]('foreach\x20newproduct',_0x5dcc7a),parseInt(_0x5dcc7a[_0x25b7ab(0x177)])<=0x0&&_0x32f2b1++;});if(_0x32f2b1!=0x0)return _0x3c26a8['flash'](_0x30936a(0x1cb),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x5f0d77[_0x30936a(0x196)](_0x30936a(0x11d));const _0x179391=new adjustment({'warehouse_name':_0x1b06fe,'date':_0x33a4e0,'product':_0x573d21,'note':_0x56acfe,'room':_0x3825fe,'invoice':_0x31c98a,'JO_number':_0x2b4698,'expiry_date':_0x52a6fd}),_0xe4d4ff=await _0x179391[_0x30936a(0x112)]();_0x3c26a8[_0x30936a(0x1a2)](_0x30936a(0x161),'adjustment\x20add\x20successfull'),_0x5f0d77['redirect']('/adjustment/preview/'+_0xe4d4ff[_0x30936a(0x149)]);}catch(_0x4eb442){console[_0x30936a(0x12b)](_0x4eb442),_0x5f0d77['status'](0xc8)['json']({'message':_0x4eb442[_0x30936a(0x194)]});}}),router['get'](a0_0x55c68b(0x1cc),auth,async(_0x2d34cb,_0x5f414c)=>{var _0x7d499=a0_0x55c68b;try{const {username:_0x3456de,email:_0x27751e,role:_0x5377c8}=_0x2d34cb['user'],_0x5ac491=_0x2d34cb[_0x7d499(0x139)],_0x417aba=await profile['findOne']({'email':_0x5ac491['email']}),_0xf01b01=await master_shop[_0x7d499(0x14c)](),_0x50aabb=_0x2d34cb[_0x7d499(0x10c)]['id'],_0x206bf6=await adjustment['findById']({'_id':_0x50aabb}),_0x59f5db=await purchases[_0x7d499(0x1a0)]([{'$match':{'warehouse_name':_0x206bf6[_0x7d499(0x168)]}},{'$unwind':'$product'},{'$group':{'_id':_0x7d499(0x16e)}}]),_0x3b7e1e=await product['find']({}),_0x1daf5d=await warehouse[_0x7d499(0x1a0)]([{'$match':{'name':_0x206bf6[_0x7d499(0x168)]}},{'$unwind':_0x7d499(0x186)},{'$group':{'_id':_0x7d499(0x1c9),'name':{'$first':_0x7d499(0x180)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x7d499(0x102)},'bin':{'$first':_0x7d499(0x119)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x7d499(0x18a)},'secondary_code':{'$first':_0x7d499(0x106)},'product_code':{'$first':_0x7d499(0x1a3)},'storage':{'$first':_0x7d499(0x1a1)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x7d499(0x109)},'expiry_date':{'$first':_0x7d499(0x13a)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x7d499(0x1b7)},'room':{'$first':_0x7d499(0x120)}}}]);if(_0xf01b01[0x0]['language']==_0x7d499(0x17e)){var _0x13918=users[_0x7d499(0x11a)];console[_0x7d499(0x12b)](_0x13918);}else{if(_0xf01b01[0x0][_0x7d499(0x13e)]==_0x7d499(0x1c3))var _0x13918=users[_0x7d499(0x1c3)];else{if(_0xf01b01[0x0]['language']==_0x7d499(0x199))var _0x13918=users[_0x7d499(0x199)];else{if(_0xf01b01[0x0][_0x7d499(0x13e)]==_0x7d499(0x14a))var _0x13918=users['Spanish'];else{if(_0xf01b01[0x0][_0x7d499(0x13e)]==_0x7d499(0x157))var _0x13918=users[_0x7d499(0x157)];else{if(_0xf01b01[0x0][_0x7d499(0x13e)]==_0x7d499(0x126))var _0x13918=users[_0x7d499(0x172)];else{if(_0xf01b01[0x0][_0x7d499(0x13e)]=='Chinese')var _0x13918=users[_0x7d499(0x1b3)];else{if(_0xf01b01[0x0][_0x7d499(0x13e)]=='Arabic\x20(ae)')var _0x13918=users['Arabic'];}}}}}}}_0x5f414c[_0x7d499(0x125)](_0x7d499(0x146),{'success':_0x2d34cb['flash'](_0x7d499(0x161)),'errors':_0x2d34cb['flash'](_0x7d499(0x1cb)),'role':_0x5ac491,'profile':_0x417aba,'adjustment':_0x206bf6,'stock':_0x1daf5d,'master_shop':_0xf01b01,'warehouse_name':_0x59f5db,'unit':_0x3b7e1e,'language':_0x13918});}catch(_0x503abf){console[_0x7d499(0x12b)](_0x503abf),_0x5f414c['status'](0xc8)[_0x7d499(0x15f)]({'message':_0x503abf[_0x7d499(0x194)]});}}),router[a0_0x55c68b(0x1b1)](a0_0x55c68b(0x1cc),auth,async(_0x42f205,_0x204c6d)=>{var _0x554b04=a0_0x55c68b;try{const _0x3b5dc4=_0x42f205[_0x554b04(0x10c)]['id'],{warehouse_name:_0x5439fe,Room_name:_0x582b30}=_0x42f205[_0x554b04(0x110)],_0x22ece7=await adjustment['findById']({'_id':_0x3b5dc4}),_0x4dcad9=_0x22ece7[_0x554b04(0x100)][_0x554b04(0x1a6)](async _0x63843d=>{var _0x3215f5=_0x554b04;if(_0x63843d[_0x3215f5(0x177)]>0x0){var _0x189952=await warehouse[_0x3215f5(0x191)]({'name':_0x5439fe,'room':_0x63843d[_0x3215f5(0x10d)],'warehouse_category':_0x3215f5(0x127)});const _0x1f430a=_0x189952[_0x3215f5(0x174)][_0x3215f5(0x1a6)](_0x12d304=>{var _0x3db4e4=_0x3215f5;console[_0x3db4e4(0x12b)](_0x63843d[_0x3db4e4(0x176)]+'\x20<>\x20');if(_0x63843d['types']==_0x3db4e4(0x15c)){if(_0x12d304[_0x3db4e4(0x10e)]==_0x63843d[_0x3db4e4(0x10e)]&&_0x12d304[_0x3db4e4(0x19c)]==_0x63843d['floorlevel']&&_0x12d304['type']==_0x63843d[_0x3db4e4(0x1b8)]&&_0x12d304[_0x3db4e4(0x150)]==_0x63843d['bin']&&_0x12d304[_0x3db4e4(0x136)]==_0x63843d[_0x3db4e4(0x136)]&&_0x12d304[_0x3db4e4(0x1bb)]==_0x63843d[_0x3db4e4(0x1bb)]&&_0x12d304['storage']==_0x63843d['storage']&&_0x12d304[_0x3db4e4(0x1aa)]==_0x63843d[_0x3db4e4(0x1aa)]&&_0x12d304[_0x3db4e4(0x160)]==_0x63843d[_0x3db4e4(0x160)]&&_0x12d304['production_date']==_0x63843d[_0x3db4e4(0x158)]&&_0x12d304[_0x3db4e4(0x1ca)]==_0x63843d[_0x3db4e4(0x1ca)]&&_0x12d304[_0x3db4e4(0x149)]==_0x63843d['id_transaction_from']){var _0x51ce47;_0x51ce47=_0x63843d[_0x3db4e4(0x177)],_0x63843d['prod_cat']=='S'&&(_0x51ce47=_0x63843d[_0x3db4e4(0x177)]),_0x12d304[_0x3db4e4(0x116)]=_0x12d304[_0x3db4e4(0x116)]-_0x51ce47;}}else{if(_0x12d304['product_name']==_0x63843d['product_name']&&_0x12d304[_0x3db4e4(0x19c)]==_0x63843d[_0x3db4e4(0x19c)]&&_0x12d304[_0x3db4e4(0x1b8)]==_0x63843d[_0x3db4e4(0x1b8)]&&_0x12d304[_0x3db4e4(0x150)]==_0x63843d['bin']&&_0x12d304[_0x3db4e4(0x136)]==_0x63843d[_0x3db4e4(0x136)]&&_0x12d304['rack']==_0x63843d['rack']&&_0x12d304[_0x3db4e4(0x154)]==_0x63843d['storage']&&_0x12d304['expiry_date']==_0x63843d['expiry_date']&&_0x12d304[_0x3db4e4(0x160)]==_0x63843d['batch_code']&&_0x12d304[_0x3db4e4(0x158)]==_0x63843d[_0x3db4e4(0x158)]&&_0x12d304[_0x3db4e4(0x1ca)]==_0x63843d[_0x3db4e4(0x1ca)]&&_0x12d304[_0x3db4e4(0x149)]==_0x63843d[_0x3db4e4(0x1c0)]){console[_0x3db4e4(0x12b)](_0x63843d);var _0x51ce47;_0x51ce47=_0x63843d['adjust_qty'],_0x63843d[_0x3db4e4(0x187)]=='S'&&(_0x51ce47=_0x63843d[_0x3db4e4(0x177)]),_0x12d304[_0x3db4e4(0x116)]=_0x12d304['product_stock']+_0x51ce47;}}});}return _0x189952;});Promise[_0x554b04(0x143)](_0x4dcad9)[_0x554b04(0x108)](async _0x7e8fd2=>{var _0x17b28f=_0x554b04;try{for(const _0x2fd72c of _0x7e8fd2){await _0x2fd72c['save']();}_0x22ece7['finalize']=_0x17b28f(0x179);const _0x3bf8ed=await _0x22ece7[_0x17b28f(0x112)](),_0x4e20b6=await master_shop['find'](),_0x8b8193=await email_settings[_0x17b28f(0x191)](),_0x3a937b=await supervisor_settings[_0x17b28f(0x14c)]();var _0x487eb2=_0x22ece7['product'],_0x4d6fbb='',_0x2f0092;for(_0x2f0092 in _0x487eb2){_0x4d6fbb+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x487eb2[_0x2f0092][_0x17b28f(0x10e)]+_0x17b28f(0x1ac)+_0x17b28f(0x156)+_0x487eb2[_0x2f0092]['product_code']+_0x17b28f(0x1ac)+_0x17b28f(0x156)+_0x487eb2[_0x2f0092]['adjust_qty']+_0x17b28f(0x1ac)+_0x17b28f(0x156)+_0x487eb2[_0x2f0092][_0x17b28f(0x1d0)]+'</td>'+_0x17b28f(0x156)+_0x487eb2[_0x2f0092]['secondary_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x22ece7[_0x17b28f(0x168)]+_0x17b28f(0x1ac)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x487eb2[_0x2f0092]['room_names']+_0x17b28f(0x1ac)+_0x17b28f(0x156)+_0x487eb2[_0x2f0092][_0x17b28f(0x154)]+_0x487eb2[_0x2f0092][_0x17b28f(0x1bb)]+_0x487eb2[_0x2f0092]['bay']+_0x487eb2[_0x2f0092]['bin']+_0x487eb2[_0x2f0092]['type'][0x0]+_0x487eb2[_0x2f0092][_0x17b28f(0x19c)]+_0x17b28f(0x1ac),_0x17b28f(0x13f);}let _0x132c5a=nodemailer['createTransport']({'host':_0x8b8193[_0x17b28f(0x198)],'port':Number(_0x8b8193[_0x17b28f(0x17d)]),'secure':![],'auth':{'user':_0x8b8193[_0x17b28f(0x1be)],'pass':_0x8b8193[_0x17b28f(0x10a)]}}),_0x48748b={'from':_0x8b8193[_0x17b28f(0x1be)],'to':_0x3a937b[0x0][_0x17b28f(0x105)],'subject':_0x17b28f(0x12d),'attachments':[{'filename':'Logo.png','path':__dirname+_0x17b28f(0x17a)+'/upload/'+_0x4e20b6[0x0][_0x17b28f(0x15d)],'cid':_0x17b28f(0x129)}],'html':_0x17b28f(0x1bd)+_0x17b28f(0x1af)+_0x17b28f(0x114)+_0x17b28f(0x192)+_0x17b28f(0x138)+_0x17b28f(0x192)+_0x17b28f(0x162)+'</div>'+'<div>'+_0x17b28f(0x1b4)+_0x4e20b6[0x0][_0x17b28f(0x19d)]+_0x17b28f(0x16b)+'</div>'+_0x17b28f(0x134)+_0x17b28f(0x13c)+_0x17b28f(0x192)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x17b28f(0x18f)+_0x22ece7[_0x17b28f(0x1ca)]+'\x20'+_0x17b28f(0x142)+'\x20Order\x20Date\x20:\x20'+_0x22ece7[_0x17b28f(0x12c)]+'\x20'+'</span>'+'</h5>'+_0x17b28f(0x134)+_0x17b28f(0x153)+_0x17b28f(0x167)+'<tr>'+_0x17b28f(0x1b0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x17b28f(0x193)+_0x17b28f(0x103)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x17b28f(0x124)+_0x17b28f(0x189)+_0x17b28f(0x111)+'</tr>'+_0x17b28f(0x141)+_0x17b28f(0x121)+'\x20'+_0x4d6fbb+'\x20'+_0x17b28f(0x145)+_0x17b28f(0x18b)+_0x17b28f(0x192)+'<strong>\x20Regards\x20</strong>'+_0x17b28f(0x1c7)+_0x4e20b6[0x0][_0x17b28f(0x19d)]+_0x17b28f(0x131)+_0x17b28f(0x134)+_0x17b28f(0x134)+_0x17b28f(0x165)};_0x132c5a[_0x17b28f(0x133)](_0x48748b,function(_0x2ba2c9,_0x4834db){var _0x9f59e6=_0x17b28f;_0x2ba2c9?(console[_0x9f59e6(0x12b)](_0x2ba2c9),console[_0x9f59e6(0x12b)](_0x9f59e6(0x101))):console[_0x9f59e6(0x12b)]('Email\x20sent\x20successfully');}),_0x42f205[_0x17b28f(0x1a2)]('success',_0x17b28f(0x1ba)),_0x204c6d['redirect'](_0x17b28f(0x1b5)+_0x3bf8ed[_0x17b28f(0x149)]);}catch(_0x140d9a){console[_0x17b28f(0x1c4)](_0x140d9a),_0x204c6d[_0x17b28f(0xfe)](0x1f4)[_0x17b28f(0x15f)]({'error':_0x17b28f(0x178)});}})[_0x554b04(0x1d1)](_0x2c1c1f=>{var _0x3a688c=_0x554b04;console[_0x3a688c(0x1c4)](_0x2c1c1f),_0x204c6d['status'](0x1f4)[_0x3a688c(0x15f)]({'error':'An\x20error\x20occurred.'});});}catch(_0x57b2a1){console[_0x554b04(0x12b)](_0x57b2a1),_0x204c6d[_0x554b04(0xfe)](0xc8)[_0x554b04(0x15f)]({'message':_0x57b2a1[_0x554b04(0x194)]});}}),router[a0_0x55c68b(0x128)]('/view/:id',auth,async(_0x31fb21,_0x523949)=>{var _0x2d4f78=a0_0x55c68b;try{const {username:_0x54b7b8,email:_0x102622,role:_0x2f3cd7}=_0x31fb21[_0x2d4f78(0x139)],_0x38b5f4=_0x31fb21[_0x2d4f78(0x139)],_0x44b63f=await profile[_0x2d4f78(0x191)]({'email':_0x38b5f4[_0x2d4f78(0x1be)]}),_0x330c78=await master_shop['find'](),_0x59d83d=_0x31fb21[_0x2d4f78(0x10c)]['id'],_0x53a920=await adjustment[_0x2d4f78(0x1c6)]({'_id':_0x59d83d}),_0x5717bd=await purchases[_0x2d4f78(0x1a0)]([{'$match':{'warehouse_name':_0x53a920[_0x2d4f78(0x168)]}},{'$unwind':_0x2d4f78(0x117)},{'$group':{'_id':'$product.product_name'}}]),_0x4a2e1e=await product[_0x2d4f78(0x14c)]({}),_0x46cc5d=await warehouse[_0x2d4f78(0x1a0)]([{'$match':{'name':_0x53a920['warehouse_name']}},{'$unwind':_0x2d4f78(0x186)},{'$group':{'_id':_0x2d4f78(0x1c9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2d4f78(0x151)},'bay':{'$first':_0x2d4f78(0x102)},'bin':{'$first':_0x2d4f78(0x119)},'type':{'$first':_0x2d4f78(0x184)},'floorlevel':{'$first':_0x2d4f78(0x16d)},'primary_code':{'$first':_0x2d4f78(0x18a)},'secondary_code':{'$first':_0x2d4f78(0x106)},'product_code':{'$first':_0x2d4f78(0x1a3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2d4f78(0x1c1)},'maxPerUnit':{'$first':_0x2d4f78(0x109)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2d4f78(0x14f)},'batch_code':{'$first':_0x2d4f78(0x1b7)},'room':{'$first':'$room'}}}]);let _0x19f438;if(_0x38b5f4['role']==_0x2d4f78(0x175)){const _0x158ad8=await staff[_0x2d4f78(0x191)]({'email':_0x38b5f4['email']});_0x19f438=await warehouse[_0x2d4f78(0x1a0)]([{'$match':{'status':_0x2d4f78(0x17c),'name':_0x158ad8[_0x2d4f78(0x12f)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x2d4f78(0x135)}}},{'$group':{'_id':'$name','name':{'$first':_0x2d4f78(0x155)}}}]);}else _0x19f438=await warehouse[_0x2d4f78(0x1a0)]([{'$match':{'status':_0x2d4f78(0x17c),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x2d4f78(0x135)}}},{'$group':{'_id':'$name','name':{'$first':_0x2d4f78(0x155)}}}]);if(_0x330c78[0x0][_0x2d4f78(0x13e)]==_0x2d4f78(0x17e)){var _0x136337=users[_0x2d4f78(0x11a)];console['log'](_0x136337);}else{if(_0x330c78[0x0]['language']=='Hindi')var _0x136337=users[_0x2d4f78(0x1c3)];else{if(_0x330c78[0x0][_0x2d4f78(0x13e)]==_0x2d4f78(0x199))var _0x136337=users[_0x2d4f78(0x199)];else{if(_0x330c78[0x0][_0x2d4f78(0x13e)]==_0x2d4f78(0x14a))var _0x136337=users[_0x2d4f78(0x14a)];else{if(_0x330c78[0x0][_0x2d4f78(0x13e)]==_0x2d4f78(0x157))var _0x136337=users[_0x2d4f78(0x157)];else{if(_0x330c78[0x0]['language']==_0x2d4f78(0x126))var _0x136337=users['Portuguese'];else{if(_0x330c78[0x0][_0x2d4f78(0x13e)]==_0x2d4f78(0x1b3))var _0x136337=users[_0x2d4f78(0x1b3)];else{if(_0x330c78[0x0]['language']=='Arabic\x20(ae)')var _0x136337=users[_0x2d4f78(0x113)];}}}}}}}_0x523949[_0x2d4f78(0x125)](_0x2d4f78(0x169),{'success':_0x31fb21['flash']('success'),'errors':_0x31fb21[_0x2d4f78(0x1a2)](_0x2d4f78(0x1cb)),'role':_0x38b5f4,'profile':_0x44b63f,'adjustment':_0x53a920,'stock':_0x46cc5d,'master_shop':_0x330c78,'warehouse_name':_0x5717bd,'unit':_0x4a2e1e,'language':_0x136337,'warehouse':_0x19f438});}catch(_0x1922f1){console[_0x2d4f78(0x12b)](_0x1922f1),_0x523949[_0x2d4f78(0xfe)](0xc8)[_0x2d4f78(0x15f)]({'message':_0x1922f1[_0x2d4f78(0x194)]});}}),router[a0_0x55c68b(0x1b1)](a0_0x55c68b(0x1a5),auth,async(_0x5f50b5,_0x1fd174)=>{var _0xe4b281=a0_0x55c68b;try{const _0xd253e1=_0x5f50b5[_0xe4b281(0x10c)]['id'],_0x42239f=await adjustment[_0xe4b281(0x1c6)]({'_id':_0xd253e1}),_0x42ca54=await warehouse[_0xe4b281(0x191)]({'name':_0x42239f[_0xe4b281(0x168)],'room':_0x42239f[_0xe4b281(0x1bf)]}),{warehouse_name:_0x4ee2cc,date:_0x3c256c,prod_name:_0x5a5ca,level:_0x1d2015,isle:_0x31a73d,pallet:_0x51a6e9,stock:_0x4cf956,types:_0x148a36,adjust_qty:_0xb03679,new_adjust_qty:_0x188da9,note:_0x4b910b,Room_name:_0x283edb,invoice:_0xf9a770,JO_number:_0xd5fa67,expiry_date:_0x1d4e50}=_0x5f50b5[_0xe4b281(0x110)];if(typeof _0x5a5ca==_0xe4b281(0x197))var _0x250bfa=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x16a)]],_0x434358=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x190)]],_0x309fff=[_0x5f50b5['body'][_0xe4b281(0x14e)]],_0x25f95d=[_0x5f50b5['body'][_0xe4b281(0x176)]],_0x4ed721=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x144)]],_0x1f8bb2=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x11b)]],_0x4cf2b8=[_0x5f50b5[_0xe4b281(0x110)]['Primary_Units']],_0x1d1e7a=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x118)]],_0x57c356=[_0x5f50b5[_0xe4b281(0x110)]['prod_code']],_0x4d7aac=[_0x5f50b5[_0xe4b281(0x110)]['batch_code']],_0x2fcfef=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x1aa)]],_0x54d33f=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x18e)]],_0x4316ee=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x158)]],_0x2fc3b8=[_0x5f50b5[_0xe4b281(0x110)]['prod_cat']],_0x2d9e44=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x1b6)]],_0x44b463=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x1b9)]],_0x245ce9=[_0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x107)]];else var _0x250bfa=[..._0x5f50b5[_0xe4b281(0x110)]['prod_name']],_0x434358=[..._0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x190)]],_0x309fff=[..._0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x14e)]],_0x25f95d=[..._0x5f50b5['body'][_0xe4b281(0x176)]],_0x4ed721=[..._0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x144)]],_0x1f8bb2=[..._0x5f50b5[_0xe4b281(0x110)]['New_Qty_Converted']],_0x4cf2b8=[..._0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x1d0)]],_0x1d1e7a=[..._0x5f50b5['body']['Secondary_units']],_0x57c356=[..._0x5f50b5['body'][_0xe4b281(0x115)]],_0x4d7aac=[..._0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x160)]],_0x2fcfef=[..._0x5f50b5[_0xe4b281(0x110)]['expiry_date']],_0x54d33f=[..._0x5f50b5['body'][_0xe4b281(0x18e)]],_0x4316ee=[..._0x5f50b5['body'][_0xe4b281(0x158)]],_0x2fc3b8=[..._0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x187)]],_0x2d9e44=[..._0x5f50b5['body'][_0xe4b281(0x1b6)]],_0x44b463=[..._0x5f50b5['body'][_0xe4b281(0x1b9)]],_0x245ce9=[..._0x5f50b5[_0xe4b281(0x110)][_0xe4b281(0x107)]];const _0xaead69=_0x250bfa['map'](_0x15aace=>{return _0x15aace={'product_name':_0x15aace};});_0x434358[_0xe4b281(0x16c)]((_0x5577e4,_0x3fb2a8)=>{var _0x300d2f=_0xe4b281;_0x2d9e44[_0x300d2f(0x16c)]((_0x39f7a1,_0x557f17)=>{var _0x5ac08a=_0x300d2f;if(_0x39f7a1=='Receiving\x20Area'&&_0x3fb2a8==_0x557f17){var _0x2a370d=_0x5577e4[_0x5ac08a(0x10b)](0x3);_0xaead69[_0x3fb2a8]['storage']=_0x5577e4[0x0],_0xaead69[_0x3fb2a8][_0x5ac08a(0x1bb)]=_0x5577e4[0x1],_0xaead69[_0x3fb2a8]['bay']=0x0,_0xaead69[_0x3fb2a8][_0x5ac08a(0x150)]=0x0,_0xaead69[_0x3fb2a8][_0x5ac08a(0x1b8)]=_0x5ac08a(0x171),_0xaead69[_0x3fb2a8][_0x5ac08a(0x19c)]=_0x2a370d;}else{if(_0x39f7a1==_0x5ac08a(0x1c2)&&_0x3fb2a8==_0x557f17){var _0x2a370d=_0x5577e4[_0x5ac08a(0x10b)](0x3);_0xaead69[_0x3fb2a8][_0x5ac08a(0x154)]=_0x5577e4[0x0],_0xaead69[_0x3fb2a8]['rack']=_0x5577e4[0x1],_0xaead69[_0x3fb2a8]['bay']=0x0,_0xaead69[_0x3fb2a8][_0x5ac08a(0x150)]=0x0,_0xaead69[_0x3fb2a8][_0x5ac08a(0x1b8)]=_0x5ac08a(0x171),_0xaead69[_0x3fb2a8]['floorlevel']=_0x5577e4[0x5];}else{if(_0x3fb2a8==_0x557f17){var _0x3a875e;if(_0x5577e4[0x4]=='L')_0x3a875e=_0x5ac08a(0x104);else _0x5577e4[0x4]=='F'&&(_0x3a875e=_0x5ac08a(0x171));_0xaead69[_0x3fb2a8][_0x5ac08a(0x154)]=_0x5577e4[0x0],_0xaead69[_0x3fb2a8]['rack']=_0x5577e4[0x1],_0xaead69[_0x3fb2a8][_0x5ac08a(0x136)]=_0x5577e4[0x2],_0xaead69[_0x3fb2a8]['bin']=_0x5577e4[0x3],_0xaead69[_0x3fb2a8]['type']=_0x3a875e,_0xaead69[_0x3fb2a8][_0x5ac08a(0x19c)]=_0x5577e4[0x5];}}}});}),_0x309fff[_0xe4b281(0x16c)]((_0x3b9e3b,_0x40a092)=>{var _0x576c68=_0xe4b281;_0xaead69[_0x40a092][_0x576c68(0x13b)]=_0x3b9e3b;}),_0x25f95d[_0xe4b281(0x16c)]((_0x1828e3,_0x8b4130)=>{_0xaead69[_0x8b4130]['types']=_0x1828e3;}),_0x4ed721[_0xe4b281(0x16c)]((_0x206935,_0x34cdff)=>{_0xaead69[_0x34cdff]['adjust_qty']=_0x206935;}),_0x1f8bb2[_0xe4b281(0x16c)]((_0x2948d9,_0x13fe6e)=>{_0xaead69[_0x13fe6e]['new_adjust_qty']=_0x2948d9;}),_0x4cf2b8[_0xe4b281(0x16c)]((_0x362ddc,_0x582045)=>{var _0x11d49c=_0xe4b281;_0xaead69[_0x582045][_0x11d49c(0x1d0)]=_0x362ddc;}),_0x1d1e7a[_0xe4b281(0x16c)]((_0x44362b,_0x1148f2)=>{_0xaead69[_0x1148f2]['secondary_unit']=_0x44362b;}),_0x57c356[_0xe4b281(0x16c)]((_0x560612,_0x44c623)=>{var _0x1e911a=_0xe4b281;_0xaead69[_0x44c623][_0x1e911a(0x1c5)]=_0x560612;}),_0x4d7aac[_0xe4b281(0x16c)]((_0x331e16,_0x5537b7)=>{var _0x38f9e9=_0xe4b281;_0xaead69[_0x5537b7][_0x38f9e9(0x160)]=_0x331e16;}),_0x2fcfef[_0xe4b281(0x16c)]((_0x1b504e,_0x556e21)=>{_0xaead69[_0x556e21]['expiry_date']=_0x1b504e;}),_0x54d33f[_0xe4b281(0x16c)]((_0x56ed38,_0x1d788d)=>{var _0x240350=_0xe4b281;_0xaead69[_0x1d788d][_0x240350(0x152)]=_0x56ed38;}),_0x4316ee[_0xe4b281(0x16c)]((_0x4cb078,_0x6a1fbc)=>{var _0x5b8c2d=_0xe4b281;_0xaead69[_0x6a1fbc][_0x5b8c2d(0x158)]=_0x4cb078;}),_0x2fc3b8[_0xe4b281(0x16c)]((_0x4b5642,_0x4682c7)=>{var _0x57b729=_0xe4b281;_0xaead69[_0x4682c7][_0x57b729(0x187)]=_0x4b5642;}),_0x2d9e44[_0xe4b281(0x16c)]((_0x53524d,_0x2d8c25)=>{_0xaead69[_0x2d8c25]['room_names']=_0x53524d;}),_0x44b463[_0xe4b281(0x16c)]((_0x156fbb,_0x6c192b)=>{var _0x439c5a=_0xe4b281;_0xaead69[_0x6c192b][_0x439c5a(0x166)]=_0x156fbb;}),_0x245ce9[_0xe4b281(0x16c)]((_0x1ef424,_0x4b7e24)=>{_0xaead69[_0x4b7e24]['secondary_code']=_0x1ef424;});const _0x25750c=_0xaead69[_0xe4b281(0x181)](_0x12ff1c=>_0x12ff1c['adjust_qty']!=='0'&&_0x12ff1c[_0xe4b281(0x177)]!=='');var _0x2327c2=0x0;_0x25750c[_0xe4b281(0x16c)](_0x57318b=>{var _0xfb6aa4=_0xe4b281;console[_0xfb6aa4(0x12b)](_0xfb6aa4(0x132),_0x57318b),parseInt(_0x57318b[_0xfb6aa4(0x177)])<=0x0&&_0x2327c2++;});if(_0x2327c2!=0x0)return _0x5f50b5['flash']('errors',_0xe4b281(0x1bc)),_0x1fd174[_0xe4b281(0x196)](_0xe4b281(0x11d));_0x42239f[_0xe4b281(0x168)]=_0x4ee2cc,_0x42239f[_0xe4b281(0x12c)]=_0x3c256c,_0x42239f['product']=_0x25750c,_0x42239f['note']=_0x4b910b,_0x42239f[_0xe4b281(0x1ca)]=_0xf9a770,_0x42239f['isAllowEdit']=_0xe4b281(0x183);const _0x460cb6=await _0x42239f[_0xe4b281(0x112)]();_0x5f50b5[_0xe4b281(0x1a2)](_0xe4b281(0x161),_0xe4b281(0x17f)),_0x1fd174[_0xe4b281(0x196)](_0xe4b281(0x16f));}catch(_0x1577bd){console[_0xe4b281(0x12b)](_0x1577bd);}}),router['post'](a0_0x55c68b(0x170),async(_0x46e9b9,_0x179de0)=>{var _0x3f0c70=a0_0x55c68b;const {primary_code:_0x3ebff9,warehouse_data:_0x509a7c,rooms_data:_0x2e31fc,Roomslist:_0x27890d}=_0x46e9b9['body'],_0x1818ba=_0x27890d[_0x3f0c70(0x19f)](','),_0x35fc60=[];async function _0x10a996(_0x260aa4){var _0x1153c7=_0x3f0c70;const _0x4fbffc=await warehouse['aggregate']([{'$match':{'name':_0x509a7c,'room':_0x260aa4}},{'$unwind':_0x1153c7(0x186)},{'$match':{'product_details.primary_code':_0x3ebff9}},{'$group':{'_id':_0x1153c7(0x1c9),'name':{'$first':_0x1153c7(0x180)},'product_stock':{'$first':_0x1153c7(0x151)},'primary_code':{'$first':_0x1153c7(0x18a)},'secondary_code':{'$first':_0x1153c7(0x106)},'product_code':{'$first':_0x1153c7(0x1a3)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1153c7(0x184)},'pallet':{'$first':_0x1153c7(0x16d)},'unit':{'$first':_0x1153c7(0x164)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1153c7(0x1c1)},'expiry_date':{'$first':_0x1153c7(0x13a)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x1153c7(0x109)},'batch_code':{'$first':_0x1153c7(0x1b7)},'product_cat':{'$first':_0x1153c7(0x1b2)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1153c7(0x120)},'invoice':{'$first':_0x1153c7(0x1a4)}}}]),_0xdea96e=await warehouse['aggregate']([{'$match':{'name':_0x509a7c,'room':_0x260aa4}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3ebff9}},{'$group':{'_id':_0x1153c7(0x1c9),'name':{'$first':_0x1153c7(0x180)},'product_stock':{'$first':_0x1153c7(0x151)},'primary_code':{'$first':_0x1153c7(0x18a)},'secondary_code':{'$first':_0x1153c7(0x106)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1153c7(0x102)},'isle':{'$first':_0x1153c7(0x119)},'type':{'$first':_0x1153c7(0x184)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1153c7(0x164)},'secondary_unit':{'$first':_0x1153c7(0x1c8)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1153c7(0x1c1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1153c7(0x14f)},'maxPerUnit':{'$first':_0x1153c7(0x109)},'batch_code':{'$first':_0x1153c7(0x1b7)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1153c7(0x120)}}}]);if(_0x4fbffc['length']>0x0)_0x35fc60[_0x1153c7(0x12e)](_0x4fbffc);else _0xdea96e[_0x1153c7(0x159)]>0x0&&_0x35fc60[_0x1153c7(0x12e)](_0xdea96e);}const _0x550200=_0x1818ba[_0x3f0c70(0x1a6)](_0x58d0bd=>_0x10a996(_0x58d0bd));await Promise['all'](_0x550200),_0x179de0[_0x3f0c70(0x15f)](_0x35fc60);}),router[a0_0x55c68b(0x1b1)](a0_0x55c68b(0x148),async(_0x40483e,_0x5cb863)=>{var _0x31fab9=a0_0x55c68b;const {primaryCode:_0x5a3aaf,secondaryCode:_0x472b56,productCode:_0x5d53d3,level:_0x1ad784,isle:_0x6ffa16,pallet:_0x3a4562,warehouses:_0xb615e5,room:_0x4f589b}=_0x40483e[_0x31fab9(0x110)];try{const _0x422607=await warehouse[_0x31fab9(0x1a0)]([{'$match':{'name':_0xb615e5,'room':_0x4f589b}},{'$unwind':_0x31fab9(0x186)},{'$match':{'product_details.level':parseInt(_0x1ad784),'product_details.isle':_0x6ffa16,'product_details.pallet':parseInt(_0x3a4562)}},{'$group':{'_id':_0x31fab9(0x1c9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x31fab9(0x151)},'level':{'$first':_0x31fab9(0x1ad)},'isle':{'$first':_0x31fab9(0x173)},'pallet':{'$first':_0x31fab9(0x182)},'maxProducts':{'$first':_0x31fab9(0x1a9)}}}]);_0x5cb863['status'](0xc8)[_0x31fab9(0x15f)](_0x422607);}catch(_0x3812e9){_0x5cb863[_0x31fab9(0xfe)](0x194)[_0x31fab9(0x15f)]({'message':_0x3812e9[_0x31fab9(0x194)]});}}),module['exports']=router;