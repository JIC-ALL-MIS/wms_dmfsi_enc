var a0_0xd75606=a0_0x577e;(function(_0x4865e7,_0x3dafa6){var _0x1392ab=a0_0x577e,_0x899d3d=_0x4865e7();while(!![]){try{var _0x26d848=-parseInt(_0x1392ab(0x211))/0x1+-parseInt(_0x1392ab(0x17c))/0x2*(parseInt(_0x1392ab(0x21a))/0x3)+parseInt(_0x1392ab(0x1a5))/0x4*(parseInt(_0x1392ab(0x1f3))/0x5)+-parseInt(_0x1392ab(0x226))/0x6+parseInt(_0x1392ab(0x204))/0x7*(parseInt(_0x1392ab(0x1c6))/0x8)+parseInt(_0x1392ab(0x189))/0x9+-parseInt(_0x1392ab(0x219))/0xa;if(_0x26d848===_0x3dafa6)break;else _0x899d3d['push'](_0x899d3d['shift']());}catch(_0x4cfee8){_0x899d3d['push'](_0x899d3d['shift']());}}}(a0_0x3db8,0x6fd9b));function a0_0x3db8(){var _0x2532c1=['German','$product_details.product_code','Portuguese','Logo.png','601585skmhcI','Return\x20Rooms','_id','<tbody\x20style=\x22text-align:\x20center;\x22>','Return\x20Goods','Spanish','/adjustment/view','$product_details.secondary_code','edit_adjustment','rack','secondary_unit','all','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<h5\x20style=\x22text-align:\x20left;\x22>','minus','/adjustment/preview/','product','7RZDxOb','redirect','express','$product_details.bay','save','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','level','bay','filter','invoice','Rooms','20488AFeGPN','Hindi','date','json','note','French','</td>','$product_details','1696140LleBnI','5142THMcwe','add_adjustment','floor','findOne','<tr>','body','An\x20error\x20occurred\x20while\x20saving\x20data.','Email\x20sent\x20successfully','then','length','English','room_names','4169652sSnLAw','Enabled','render','catch','adjust_qty','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view/add_adjustment','<hr\x20class=\x22my-3\x22>','host','../models/all_models','$product_details.maxPerUnit','<div>','product_stock','\x20</h2>','production_date','prod_code','batch_code','$product_details.production_date','secondary_code','site_title','success','Receiving\x20Area','$name','</table>','True','/../public','back','$product_details.type','map','New_Qty_Converted_adj','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</thead>','Primary_Units','</div>','$product_details.product_stock','$product_details.primary_code','English\x20(US)','flash','$product','logo','96JqAgAZ','Adjustment\x20Mail','push','floorlevel','Raw\x20Materials','product_code','\x20<>\x20','Arabic','staff','get','/upload/','storage','$product_details.product_cat','483066UZlDly','slice','Floor','master','$product_details.batch_code','Level','$product_details.bin','/barcode_scanner','$invoice','password','expiry_date','params','</tr>','/CheckingWarehouse','<!DOCTYPE\x20html>','$product_details.expiry_date','warehouse_name','room','foreach\x20newproduct','ADJ-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','user','$product_details.rack','adjustment\x20add\x20successfull','</head><body>','post','maxperunit','False','24baUnBR','$product_details.secondary_unit','new_adjust_qty','adjustment\x20data\x20update\x20successfully','email','aggregate','$product_details.pallet','find','prod_name','Arabic\x20(ae)','string','types','$room','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','forEach','/preview/:id','findById','primary_code','Portuguese\x20(BR)','Router','$isAllowEdit','$product.room_names','createTransport','$product_details.floorlevel','</h5>','$product_details.maxProducts','There\x27s\x20a\x20error\x20in\x20this\x20transaction','exports','language','prime1','errors','second1','log','5199032DEBHLJ','type','prod_cat','max_per_unit','<span\x20style=\x22float:\x20right;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','message','Ambient','<html><head><title></title>','product_name','$product_details._id','role','</span>','\x20Order\x20Date\x20:\x20','toString','New_Qty_Converted','$product_details.product_name','$product_details.storage','../middleware/auth','bin','error','maxPerUnit','warehouse','stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product.product_name','product_details','unit','image','prod_invoice','$_id','Chinese','</tbody>','An\x20error\x20occurred.','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/view','/picking_list/PDF_adjustment_rm/','status','/view/:id','nodemailer','Secondary_units'];a0_0x3db8=function(){return _0x2532c1;};return a0_0x3db8();}const express=require(a0_0xd75606(0x206)),app=express(),router=express[a0_0xd75606(0x1b8)](),auth=require(a0_0xd75606(0x1d8)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xd75606(0x22f)),users=require('../public/language/languages.json'),nodemailer=require(a0_0xd75606(0x1ed));router[a0_0xd75606(0x185)](a0_0xd75606(0x1e9),auth,async(_0x3e600c,_0x182531)=>{var _0x3efd5d=a0_0xd75606;try{const {username:_0x392b56,email:_0x16649e,role:_0x32a8c6}=_0x3e600c['user'],_0x233485=_0x3e600c[_0x3efd5d(0x19e)],_0x35d92e=await profile['findOne']({'email':_0x233485[_0x3efd5d(0x1a9)]}),_0x5c0ea6=await master_shop[_0x3efd5d(0x1ac)]();console[_0x3efd5d(0x1c5)](_0x3efd5d(0x18c),_0x5c0ea6);let _0xd82b2b;if(_0x233485[_0x3efd5d(0x1d1)]=='staff'){const _0x513b16=await staff[_0x3efd5d(0x21d)]({'email':_0x233485[_0x3efd5d(0x1a9)]});_0xd82b2b=await warehouse[_0x3efd5d(0x1ac)]({'status':'Enabled','name':_0x513b16[_0x3efd5d(0x1dc)]});}else _0xd82b2b=await warehouse[_0x3efd5d(0x1ac)]({'status':_0x3efd5d(0x227)});const _0x2d0e90=await product[_0x3efd5d(0x1ac)]();let _0x54d881;if(_0x233485[_0x3efd5d(0x1d1)]==_0x3efd5d(0x184)){const _0xeac066=await staff[_0x3efd5d(0x21d)]({'email':_0x233485[_0x3efd5d(0x1a9)]});_0x54d881=await adjustment[_0x3efd5d(0x1ac)]({'warehouse_name':_0xeac066[_0x3efd5d(0x1dc)]});}else _0x54d881=await adjustment[_0x3efd5d(0x1aa)]([{'$unwind':_0x3efd5d(0x17a)},{'$group':{'_id':_0x3efd5d(0x1e4),'invoice':{'$first':_0x3efd5d(0x191)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x3efd5d(0x1ba)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x3efd5d(0x1b9)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x5c0ea6[0x0]['language']==_0x3efd5d(0x178)){var _0x45aeaf=users['English'];console[_0x3efd5d(0x1c5)](_0x45aeaf);}else{if(_0x5c0ea6[0x0][_0x3efd5d(0x1c1)]=='Hindi')var _0x45aeaf=users['Hindi'];else{if(_0x5c0ea6[0x0][_0x3efd5d(0x1c1)]==_0x3efd5d(0x1ef))var _0x45aeaf=users[_0x3efd5d(0x1ef)];else{if(_0x5c0ea6[0x0][_0x3efd5d(0x1c1)]==_0x3efd5d(0x1f8))var _0x45aeaf=users[_0x3efd5d(0x1f8)];else{if(_0x5c0ea6[0x0][_0x3efd5d(0x1c1)]==_0x3efd5d(0x216))var _0x45aeaf=users[_0x3efd5d(0x216)];else{if(_0x5c0ea6[0x0][_0x3efd5d(0x1c1)]==_0x3efd5d(0x1b7))var _0x45aeaf=users['Portuguese'];else{if(_0x5c0ea6[0x0][_0x3efd5d(0x1c1)]==_0x3efd5d(0x1e5))var _0x45aeaf=users[_0x3efd5d(0x1e5)];else{if(_0x5c0ea6[0x0][_0x3efd5d(0x1c1)]=='Arabic\x20(ae)')var _0x45aeaf=users[_0x3efd5d(0x183)];}}}}}}}_0x182531['render']('adjustment',{'success':_0x3e600c[_0x3efd5d(0x179)](_0x3efd5d(0x23a)),'errors':_0x3e600c[_0x3efd5d(0x179)](_0x3efd5d(0x1c3)),'role':_0x233485,'profile':_0x35d92e,'warehouse':_0xd82b2b,'product':_0x2d0e90,'adjustment':_0x54d881,'master_shop':_0x5c0ea6,'language':_0x45aeaf});}catch(_0x246be3){console[_0x3efd5d(0x1c5)](_0x246be3);}});async function getRandom8DigitNumber(){var _0x4e77b8=a0_0xd75606;const _0x4714de=0x989680,_0x2afee8=0x5f5e0ff,_0x5773b8=Math[_0x4e77b8(0x21c)](Math['random']()*(_0x2afee8-_0x4714de+0x1))+_0x4714de;var _0x4078f5;const _0x1a5fbf=await adjustment['findOne']({'invoice':'ADJ-'+_0x5773b8});return _0x1a5fbf&&_0x1a5fbf[_0x4e77b8(0x223)]>0x0?_0x4078f5=_0x4e77b8(0x19c)+_0x5773b8:_0x4078f5=_0x4e77b8(0x19c)+_0x5773b8,_0x4078f5;}function a0_0x577e(_0x1fdc95,_0xc2cb4b){var _0x3db897=a0_0x3db8();return a0_0x577e=function(_0x577e67,_0x1a7382){_0x577e67=_0x577e67-0x171;var _0x51168b=_0x3db897[_0x577e67];return _0x51168b;},a0_0x577e(_0x1fdc95,_0xc2cb4b);}router[a0_0xd75606(0x185)]('/view/add_adjustment',auth,async(_0x8b96dc,_0x4797d9)=>{var _0xfe92de=a0_0xd75606;try{const {username:_0x57e684,email:_0x5b5355,role:_0x55da9b}=_0x8b96dc['user'],_0x5623da=_0x8b96dc[_0xfe92de(0x19e)],_0x46fd4b=await profile[_0xfe92de(0x21d)]({'email':_0x5623da[_0xfe92de(0x1a9)]}),_0x5a28cd=await master_shop[_0xfe92de(0x1ac)]();let _0x1ed6d7;if(_0x5623da[_0xfe92de(0x1d1)]==_0xfe92de(0x184)){const _0x1f6bc5=await staff[_0xfe92de(0x21d)]({'email':_0x5623da[_0xfe92de(0x1a9)]});_0x1ed6d7=await warehouse['aggregate']([{'$match':{'status':_0xfe92de(0x227),'name':_0x1f6bc5[_0xfe92de(0x1dc)],'warehouse_category':_0xfe92de(0x180),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0xfe92de(0x23c),'name':{'$first':_0xfe92de(0x23c)}}}]);}else _0x1ed6d7=await warehouse['aggregate']([{'$match':{'status':_0xfe92de(0x227),'warehouse_category':_0xfe92de(0x180),'name':{'$ne':_0xfe92de(0x1f7)}}},{'$group':{'_id':_0xfe92de(0x23c),'name':{'$first':_0xfe92de(0x23c)}}}]);const _0x57770f=await product[_0xfe92de(0x1ac)]({}),_0x3a6590=await adjustment[_0xfe92de(0x1ac)]({}),_0x5a3927=_0x3a6590[_0xfe92de(0x223)]+0x1,_0x576c32=_0xfe92de(0x19c)+_0x5a3927[_0xfe92de(0x1d4)]()['padStart'](0x5,'0');var _0x1df97a=[_0xfe92de(0x1cd),'Enclosed',_0xfe92de(0x1f4)];if(_0x5a28cd[0x0]['language']=='English\x20(US)')var _0x3a2f23=users[_0xfe92de(0x224)];else{if(_0x5a28cd[0x0][_0xfe92de(0x1c1)]==_0xfe92de(0x212))var _0x3a2f23=users[_0xfe92de(0x212)];else{if(_0x5a28cd[0x0][_0xfe92de(0x1c1)]==_0xfe92de(0x1ef))var _0x3a2f23=users[_0xfe92de(0x1ef)];else{if(_0x5a28cd[0x0]['language']==_0xfe92de(0x1f8))var _0x3a2f23=users[_0xfe92de(0x1f8)];else{if(_0x5a28cd[0x0][_0xfe92de(0x1c1)]==_0xfe92de(0x216))var _0x3a2f23=users[_0xfe92de(0x216)];else{if(_0x5a28cd[0x0][_0xfe92de(0x1c1)]=='Portuguese\x20(BR)')var _0x3a2f23=users[_0xfe92de(0x1f1)];else{if(_0x5a28cd[0x0]['language']==_0xfe92de(0x1e5))var _0x3a2f23=users['Chinese'];else{if(_0x5a28cd[0x0][_0xfe92de(0x1c1)]==_0xfe92de(0x1ae))var _0x3a2f23=users['Arabic'];}}}}}}}const _0x337238=getRandom8DigitNumber();_0x337238[_0xfe92de(0x222)](_0x4e7108=>{var _0x4a43b1=_0xfe92de;_0x4797d9[_0x4a43b1(0x228)](_0x4a43b1(0x21b),{'success':_0x8b96dc[_0x4a43b1(0x179)](_0x4a43b1(0x23a)),'errors':_0x8b96dc[_0x4a43b1(0x179)](_0x4a43b1(0x1c3)),'role':_0x5623da,'profile':_0x46fd4b,'warehouse':_0x1ed6d7,'product':_0x57770f,'master_shop':_0x5a28cd,'language':_0x3a2f23,'rooms_data':_0x1df97a,'invoice_no':_0x4e7108});})[_0xfe92de(0x229)](_0x18d8eb=>{var _0x2fac82=_0xfe92de;_0x8b96dc[_0x2fac82(0x179)](_0x2fac82(0x1c3),_0x2fac82(0x1bf)),_0x4797d9['redirect'](_0x2fac82(0x1f9));});}catch(_0x3e9af9){console[_0xfe92de(0x1c5)](_0x3e9af9);}}),router[a0_0xd75606(0x1a2)](a0_0xd75606(0x22c),auth,async(_0x1f4d61,_0x4ff608)=>{var _0x9f0aef=a0_0xd75606;try{const {warehouse_name:_0x3ccca7,date:_0x3d5c03,prod_name:_0x3afbae,level:_0x4e162e,isle:_0x2c2ca6,pallet:_0x4316da,stock:_0x37c641,types:_0x282425,adjust_qty:_0x829bb7,new_adjust_qty:_0x38bb7d,note:_0x208d60,Room_name:_0x154e27,invoice:_0x54f83b,JO_number:_0xc0cf28,expiry_date:_0x491604}=_0x1f4d61[_0x9f0aef(0x21f)];if(typeof _0x3afbae==_0x9f0aef(0x1af))var _0x49709d=[_0x1f4d61[_0x9f0aef(0x21f)]['prod_name']],_0x136a60=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x20c)]],_0x1aab45=[_0x1f4d61[_0x9f0aef(0x21f)]['stock']],_0x53ae3b=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1b0)]],_0xd94f13=[_0x1f4d61[_0x9f0aef(0x21f)]['New_Qty_Converted_adj']],_0x20a392=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1d5)]],_0x5507c0=[_0x1f4d61['body']['Primary_Units']],_0x47e160=[_0x1f4d61['body'][_0x9f0aef(0x1ee)]],_0xf50449=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x235)]],_0x47a153=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x236)]],_0x5d8110=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x193)]],_0x360346=[_0x1f4d61['body'][_0x9f0aef(0x1c9)]],_0x4cb07c=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x234)]],_0x15230e=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1c8)]],_0x1d5e07=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x210)]],_0x11eb69=[_0x1f4d61['body']['prime1']],_0x266726=[_0x1f4d61[_0x9f0aef(0x21f)]['second1']],_0x35c723=[_0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1e3)]];else var _0x49709d=[..._0x1f4d61['body'][_0x9f0aef(0x1ad)]],_0x136a60=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x20c)]],_0x1aab45=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1dd)]],_0x53ae3b=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1b0)]],_0xd94f13=[..._0x1f4d61['body']['New_Qty_Converted_adj']],_0x20a392=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1d5)]],_0x5507c0=[..._0x1f4d61['body']['unit']],_0x47e160=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1ee)]],_0xf50449=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x235)]],_0x47a153=[..._0x1f4d61[_0x9f0aef(0x21f)]['batch_code']],_0x5d8110=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x193)]],_0x360346=[..._0x1f4d61['body'][_0x9f0aef(0x1c9)]],_0x4cb07c=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x234)]],_0x15230e=[..._0x1f4d61[_0x9f0aef(0x21f)][_0x9f0aef(0x1c8)]],_0x1d5e07=[..._0x1f4d61[_0x9f0aef(0x21f)]['Rooms']],_0x11eb69=[..._0x1f4d61['body'][_0x9f0aef(0x1c2)]],_0x266726=[..._0x1f4d61['body'][_0x9f0aef(0x1c4)]],_0x35c723=[..._0x1f4d61['body']['prod_invoice']];const _0x1a3730=_0x49709d[_0x9f0aef(0x242)](_0x179b36=>{return _0x179b36={'product_name':_0x179b36};});_0x136a60[_0x9f0aef(0x1b3)]((_0x13c8b3,_0x35a265)=>{var _0x127926=_0x9f0aef;_0x1d5e07[_0x127926(0x1b3)]((_0x3fac7f,_0x1e3d4d)=>{var _0x2464eb=_0x127926;if(_0x3fac7f==_0x2464eb(0x23b)&&_0x35a265==_0x1e3d4d){var _0x5df08e=_0x13c8b3[_0x2464eb(0x18a)](0x3);_0x1a3730[_0x35a265][_0x2464eb(0x187)]=_0x13c8b3[0x0],_0x1a3730[_0x35a265][_0x2464eb(0x1fc)]=_0x13c8b3[0x1],_0x1a3730[_0x35a265][_0x2464eb(0x20d)]=0x0,_0x1a3730[_0x35a265][_0x2464eb(0x1d9)]=0x0,_0x1a3730[_0x35a265][_0x2464eb(0x1c7)]=_0x2464eb(0x18b),_0x1a3730[_0x35a265][_0x2464eb(0x17f)]=_0x5df08e;}else{if(_0x3fac7f=='Shelves'&&_0x35a265==_0x1e3d4d){var _0x5df08e=_0x13c8b3[_0x2464eb(0x18a)](0x3);_0x1a3730[_0x35a265][_0x2464eb(0x187)]=_0x13c8b3[0x0],_0x1a3730[_0x35a265][_0x2464eb(0x1fc)]=_0x13c8b3[0x1],_0x1a3730[_0x35a265][_0x2464eb(0x20d)]=0x0,_0x1a3730[_0x35a265][_0x2464eb(0x1d9)]=0x0,_0x1a3730[_0x35a265][_0x2464eb(0x1c7)]=_0x2464eb(0x18b),_0x1a3730[_0x35a265]['floorlevel']=_0x13c8b3[0x5];}else{if(_0x35a265==_0x1e3d4d){var _0x226d92;if(_0x13c8b3[0x4]=='L')_0x226d92='Level';else _0x13c8b3[0x4]=='F'&&(_0x226d92=_0x2464eb(0x18b));_0x1a3730[_0x35a265][_0x2464eb(0x187)]=_0x13c8b3[0x0],_0x1a3730[_0x35a265][_0x2464eb(0x1fc)]=_0x13c8b3[0x1],_0x1a3730[_0x35a265][_0x2464eb(0x20d)]=_0x13c8b3[0x2],_0x1a3730[_0x35a265][_0x2464eb(0x1d9)]=_0x13c8b3[0x3],_0x1a3730[_0x35a265]['type']=_0x226d92,_0x1a3730[_0x35a265][_0x2464eb(0x17f)]=_0x13c8b3[0x5];}}}});}),_0x1aab45[_0x9f0aef(0x1b3)]((_0xa4adda,_0x1317d2)=>{_0x1a3730[_0x1317d2]['stockBefore']=_0xa4adda;}),_0x53ae3b[_0x9f0aef(0x1b3)]((_0x11e4c6,_0x11e5be)=>{var _0x331b2b=_0x9f0aef;_0x1a3730[_0x11e5be][_0x331b2b(0x1b0)]=_0x11e4c6;}),_0xd94f13[_0x9f0aef(0x1b3)]((_0x41d179,_0x4987e8)=>{var _0x221a08=_0x9f0aef;_0x1a3730[_0x4987e8][_0x221a08(0x22a)]=_0x41d179;}),_0x20a392[_0x9f0aef(0x1b3)]((_0x778661,_0x2a2a7b)=>{var _0x42a28a=_0x9f0aef;_0x1a3730[_0x2a2a7b][_0x42a28a(0x1a7)]=_0x778661;}),_0x5507c0[_0x9f0aef(0x1b3)]((_0x4dea04,_0x5e2221)=>{var _0x385c23=_0x9f0aef;_0x1a3730[_0x5e2221][_0x385c23(0x1e1)]=_0x4dea04;}),_0x47e160[_0x9f0aef(0x1b3)]((_0x5bc0f2,_0x31087c)=>{var _0x320f99=_0x9f0aef;_0x1a3730[_0x31087c][_0x320f99(0x1fd)]=_0x5bc0f2;}),_0xf50449[_0x9f0aef(0x1b3)]((_0x1255e8,_0x41cfa0)=>{var _0x1d3523=_0x9f0aef;_0x1a3730[_0x41cfa0][_0x1d3523(0x181)]=_0x1255e8;}),_0x47a153[_0x9f0aef(0x1b3)]((_0x3abde6,_0x5d906c)=>{var _0x22042c=_0x9f0aef;_0x1a3730[_0x5d906c][_0x22042c(0x236)]=_0x3abde6;}),_0x5d8110[_0x9f0aef(0x1b3)]((_0x241058,_0x1ed191)=>{var _0xb527c5=_0x9f0aef;_0x1a3730[_0x1ed191][_0xb527c5(0x193)]=_0x241058;}),_0x360346[_0x9f0aef(0x1b3)]((_0x39d287,_0x1b8e07)=>{var _0x6e5f09=_0x9f0aef;_0x1a3730[_0x1b8e07][_0x6e5f09(0x1a3)]=_0x39d287;}),_0x4cb07c[_0x9f0aef(0x1b3)]((_0x21ea91,_0x3a6a30)=>{var _0x4df8cf=_0x9f0aef;_0x1a3730[_0x3a6a30][_0x4df8cf(0x234)]=_0x21ea91;}),_0x15230e[_0x9f0aef(0x1b3)]((_0x2947e9,_0x2d6c13)=>{var _0x5b43d5=_0x9f0aef;_0x1a3730[_0x2d6c13][_0x5b43d5(0x1c8)]=_0x2947e9;}),_0x1d5e07['forEach']((_0x36d02e,_0x4f9d81)=>{var _0x7ceb78=_0x9f0aef;_0x1a3730[_0x4f9d81][_0x7ceb78(0x225)]=_0x36d02e;}),_0x11eb69['forEach']((_0x447497,_0x1b7da3)=>{var _0x62971b=_0x9f0aef;_0x1a3730[_0x1b7da3][_0x62971b(0x1b6)]=_0x447497;}),_0x266726[_0x9f0aef(0x1b3)]((_0x27880e,_0x3abf65)=>{_0x1a3730[_0x3abf65]['secondary_code']=_0x27880e;}),_0x35c723[_0x9f0aef(0x1b3)]((_0x518e15,_0x21cf79)=>{var _0x56642f=_0x9f0aef;_0x1a3730[_0x21cf79][_0x56642f(0x20f)]=_0x518e15;});const _0x3d875c=_0x1a3730[_0x9f0aef(0x20e)](_0x26d36d=>_0x26d36d['adjust_qty']!=='0'&&_0x26d36d[_0x9f0aef(0x22a)]!=='');var _0x1f18ef=0x0;_0x3d875c[_0x9f0aef(0x1b3)](_0x3118ad=>{var _0x441de9=_0x9f0aef;console['log'](_0x441de9(0x19b),_0x3118ad),parseInt(_0x3118ad[_0x441de9(0x22a)])<=0x0&&_0x1f18ef++;});if(_0x1f18ef!=0x0)return _0x1f4d61[_0x9f0aef(0x179)](_0x9f0aef(0x1c3),_0x9f0aef(0x1ff)),_0x4ff608[_0x9f0aef(0x205)](_0x9f0aef(0x240));const _0x24e302=new adjustment({'warehouse_name':_0x3ccca7,'date':_0x3d5c03,'product':_0x3d875c,'note':_0x208d60,'room':_0x154e27,'invoice':_0x54f83b,'JO_number':_0xc0cf28,'expiry_date':_0x491604}),_0x4678cb=await _0x24e302[_0x9f0aef(0x208)]();_0x1f4d61['flash'](_0x9f0aef(0x23a),_0x9f0aef(0x1a0)),_0x4ff608[_0x9f0aef(0x205)](_0x9f0aef(0x202)+_0x4678cb['_id']);}catch(_0x11eb01){console[_0x9f0aef(0x1c5)](_0x11eb01),_0x4ff608[_0x9f0aef(0x1eb)](0xc8)[_0x9f0aef(0x214)]({'message':_0x11eb01[_0x9f0aef(0x1cc)]});}}),router[a0_0xd75606(0x185)](a0_0xd75606(0x1b4),auth,async(_0x3e1252,_0x4b351e)=>{var _0x575b28=a0_0xd75606;try{const {username:_0x6bf8c9,email:_0x28fa11,role:_0x5ac021}=_0x3e1252[_0x575b28(0x19e)],_0x106b8f=_0x3e1252[_0x575b28(0x19e)],_0x1808e3=await profile['findOne']({'email':_0x106b8f[_0x575b28(0x1a9)]}),_0x2006e4=await master_shop[_0x575b28(0x1ac)](),_0x4b7c0f=_0x3e1252['params']['id'],_0x39bd3a=await adjustment[_0x575b28(0x1b5)]({'_id':_0x4b7c0f}),_0x1662e2=await purchases[_0x575b28(0x1aa)]([{'$match':{'warehouse_name':_0x39bd3a[_0x575b28(0x199)]}},{'$unwind':_0x575b28(0x17a)},{'$group':{'_id':_0x575b28(0x1df)}}]),_0x4ecb77=await product['find']({}),_0x32dc0d=await warehouse[_0x575b28(0x1aa)]([{'$match':{'name':_0x39bd3a[_0x575b28(0x199)]}},{'$unwind':_0x575b28(0x218)},{'$group':{'_id':_0x575b28(0x1d0),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x575b28(0x176)},'bay':{'$first':_0x575b28(0x207)},'bin':{'$first':_0x575b28(0x18f)},'type':{'$first':_0x575b28(0x241)},'floorlevel':{'$first':_0x575b28(0x1bc)},'primary_code':{'$first':_0x575b28(0x177)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x575b28(0x1f0)},'storage':{'$first':_0x575b28(0x1d7)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x575b28(0x198)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x575b28(0x18d)},'room':{'$first':'$room'}}}]);if(_0x2006e4[0x0][_0x575b28(0x1c1)]==_0x575b28(0x178)){var _0x46bbaa=users['English'];console[_0x575b28(0x1c5)](_0x46bbaa);}else{if(_0x2006e4[0x0][_0x575b28(0x1c1)]==_0x575b28(0x212))var _0x46bbaa=users['Hindi'];else{if(_0x2006e4[0x0][_0x575b28(0x1c1)]==_0x575b28(0x1ef))var _0x46bbaa=users[_0x575b28(0x1ef)];else{if(_0x2006e4[0x0]['language']=='Spanish')var _0x46bbaa=users[_0x575b28(0x1f8)];else{if(_0x2006e4[0x0]['language']=='French')var _0x46bbaa=users['French'];else{if(_0x2006e4[0x0][_0x575b28(0x1c1)]==_0x575b28(0x1b7))var _0x46bbaa=users['Portuguese'];else{if(_0x2006e4[0x0]['language']==_0x575b28(0x1e5))var _0x46bbaa=users[_0x575b28(0x1e5)];else{if(_0x2006e4[0x0]['language']==_0x575b28(0x1ae))var _0x46bbaa=users['Arabic'];}}}}}}}_0x4b351e[_0x575b28(0x228)]('edit_adjustment_view',{'success':_0x3e1252[_0x575b28(0x179)]('success'),'errors':_0x3e1252[_0x575b28(0x179)](_0x575b28(0x1c3)),'role':_0x106b8f,'profile':_0x1808e3,'adjustment':_0x39bd3a,'stock':_0x32dc0d,'master_shop':_0x2006e4,'warehouse_name':_0x1662e2,'unit':_0x4ecb77,'language':_0x46bbaa});}catch(_0x26ef53){console['log'](_0x26ef53),_0x4b351e[_0x575b28(0x1eb)](0xc8)['json']({'message':_0x26ef53[_0x575b28(0x1cc)]});}}),router[a0_0xd75606(0x1a2)](a0_0xd75606(0x1b4),auth,async(_0x2ad37a,_0x127917)=>{var _0x7206d3=a0_0xd75606;try{const _0x1f34bb=_0x2ad37a[_0x7206d3(0x194)]['id'],{warehouse_name:_0xcf65e5,Room_name:_0x366387}=_0x2ad37a[_0x7206d3(0x21f)],_0x3f41ae=await adjustment['findById']({'_id':_0x1f34bb}),_0x215fe0=_0x3f41ae[_0x7206d3(0x203)][_0x7206d3(0x242)](async _0x16cff=>{var _0x244d95=_0x7206d3;if(_0x16cff['adjust_qty']>0x0){var _0x55867b=await warehouse[_0x244d95(0x21d)]({'name':_0xcf65e5,'room':_0x16cff[_0x244d95(0x225)],'warehouse_category':'Raw\x20Materials'});const _0x9048ed=_0x55867b[_0x244d95(0x1e0)][_0x244d95(0x242)](_0x560aff=>{var _0x13d84c=_0x244d95;if(_0x16cff['type']==_0x13d84c(0x201)){if(_0x560aff[_0x13d84c(0x1cf)]==_0x16cff[_0x13d84c(0x1cf)]&&_0x560aff[_0x13d84c(0x17f)]==_0x16cff[_0x13d84c(0x17f)]&&_0x560aff[_0x13d84c(0x1c7)]==_0x16cff[_0x13d84c(0x1c7)]&&_0x560aff['bin']==_0x16cff[_0x13d84c(0x1d9)]&&_0x560aff[_0x13d84c(0x20d)]==_0x16cff[_0x13d84c(0x20d)]&&_0x560aff[_0x13d84c(0x1fc)]==_0x16cff['rack']&&_0x560aff['storage']==_0x16cff[_0x13d84c(0x187)]&&_0x560aff[_0x13d84c(0x193)]==_0x16cff[_0x13d84c(0x193)]&&_0x560aff[_0x13d84c(0x236)]==_0x16cff['batch_code']&&_0x560aff['production_date']==_0x16cff[_0x13d84c(0x234)]&&_0x560aff['invoice']==_0x16cff[_0x13d84c(0x20f)]){var _0x324b13;_0x324b13=_0x16cff['adjust_qty'],_0x16cff[_0x13d84c(0x1c8)]=='S'&&(_0x324b13=_0x16cff[_0x13d84c(0x22a)]),_0x560aff[_0x13d84c(0x232)]=_0x560aff['product_stock']-_0x324b13;}}else{if(_0x560aff[_0x13d84c(0x1cf)]==_0x16cff[_0x13d84c(0x1cf)]&&_0x560aff[_0x13d84c(0x17f)]==_0x16cff[_0x13d84c(0x17f)]&&_0x560aff[_0x13d84c(0x1c7)]==_0x16cff[_0x13d84c(0x1c7)]&&_0x560aff['bin']==_0x16cff[_0x13d84c(0x1d9)]&&_0x560aff['bay']==_0x16cff[_0x13d84c(0x20d)]&&_0x560aff[_0x13d84c(0x1fc)]==_0x16cff[_0x13d84c(0x1fc)]&&_0x560aff['storage']==_0x16cff['storage']&&_0x560aff[_0x13d84c(0x193)]==_0x16cff[_0x13d84c(0x193)]&&_0x560aff[_0x13d84c(0x236)]==_0x16cff['batch_code']&&_0x560aff[_0x13d84c(0x234)]==_0x16cff['production_date']&&_0x560aff[_0x13d84c(0x20f)]==_0x16cff[_0x13d84c(0x20f)]){console['log'](_0x16cff);var _0x324b13;_0x324b13=_0x16cff[_0x13d84c(0x22a)],_0x16cff[_0x13d84c(0x1c8)]=='S'&&(_0x324b13=_0x16cff[_0x13d84c(0x22a)]),console[_0x13d84c(0x1c5)](_0x324b13+_0x13d84c(0x182)+_0x16cff[_0x13d84c(0x22a)]+_0x13d84c(0x182)+_0x560aff[_0x13d84c(0x1db)]+_0x13d84c(0x182)+_0x16cff[_0x13d84c(0x1c8)]),_0x560aff['product_stock']=_0x560aff['product_stock']+_0x324b13;}}});}return _0x55867b;});Promise[_0x7206d3(0x1fe)](_0x215fe0)[_0x7206d3(0x222)](async _0x5c3fe8=>{var _0x2c3b8b=_0x7206d3;try{for(const _0x41cc81 of _0x5c3fe8){await _0x41cc81[_0x2c3b8b(0x208)]();}_0x3f41ae['finalize']=_0x2c3b8b(0x23e);const _0x51808d=await _0x3f41ae[_0x2c3b8b(0x208)](),_0x410d1=await master_shop['find'](),_0x261cfa=await email_settings['findOne'](),_0x531388=await supervisor_settings[_0x2c3b8b(0x1ac)]();var _0x96c8da=_0x3f41ae['product'],_0x39be9c='',_0x1bee0e;for(_0x1bee0e in _0x96c8da){_0x39be9c+='<tr>'+_0x2c3b8b(0x1b2)+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x1cf)]+_0x2c3b8b(0x217)+_0x2c3b8b(0x1b2)+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x181)]+_0x2c3b8b(0x217)+_0x2c3b8b(0x1b2)+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x22a)]+_0x2c3b8b(0x217)+_0x2c3b8b(0x1b2)+_0x96c8da[_0x1bee0e]['unit']+_0x2c3b8b(0x217)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x96c8da[_0x1bee0e]['secondary_unit']+_0x2c3b8b(0x217)+_0x2c3b8b(0x1b2)+_0x3f41ae[_0x2c3b8b(0x199)]+'</td>'+_0x2c3b8b(0x1b2)+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x225)]+_0x2c3b8b(0x217)+_0x2c3b8b(0x1b2)+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x187)]+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x1fc)]+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x20d)]+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x1d9)]+_0x96c8da[_0x1bee0e][_0x2c3b8b(0x1c7)][0x0]+_0x96c8da[_0x1bee0e]['floorlevel']+'</td>','</tr>';}let _0x446086=nodemailer[_0x2c3b8b(0x1bb)]({'host':_0x261cfa[_0x2c3b8b(0x22e)],'port':Number(_0x261cfa['port']),'secure':![],'auth':{'user':_0x261cfa[_0x2c3b8b(0x1a9)],'pass':_0x261cfa[_0x2c3b8b(0x192)]}}),_0x4e9c02={'from':_0x261cfa[_0x2c3b8b(0x1a9)],'to':_0x531388[0x0]['RMSEmail'],'subject':_0x2c3b8b(0x17d),'attachments':[{'filename':_0x2c3b8b(0x1f2),'path':__dirname+_0x2c3b8b(0x23f)+_0x2c3b8b(0x186)+_0x410d1[0x0][_0x2c3b8b(0x1e2)],'cid':_0x2c3b8b(0x17b)}],'html':_0x2c3b8b(0x197)+_0x2c3b8b(0x1ce)+_0x2c3b8b(0x1a1)+_0x2c3b8b(0x231)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2c3b8b(0x231)+_0x2c3b8b(0x22b)+_0x2c3b8b(0x175)+_0x2c3b8b(0x231)+'<h2>\x20'+_0x410d1[0x0][_0x2c3b8b(0x239)]+_0x2c3b8b(0x233)+_0x2c3b8b(0x175)+_0x2c3b8b(0x175)+_0x2c3b8b(0x22d)+'<div>'+_0x2c3b8b(0x200)+'\x20Order\x20Number\x20:\x20'+_0x3f41ae[_0x2c3b8b(0x20f)]+'\x20'+_0x2c3b8b(0x1ca)+_0x2c3b8b(0x1d3)+_0x3f41ae[_0x2c3b8b(0x213)]+'\x20'+_0x2c3b8b(0x1d2)+_0x2c3b8b(0x1bd)+_0x2c3b8b(0x175)+_0x2c3b8b(0x209)+_0x2c3b8b(0x1e8)+_0x2c3b8b(0x21e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2c3b8b(0x1cb)+_0x2c3b8b(0x1de)+_0x2c3b8b(0x172)+_0x2c3b8b(0x19d)+_0x2c3b8b(0x20b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x2c3b8b(0x195)+_0x2c3b8b(0x173)+_0x2c3b8b(0x1f6)+'\x20'+_0x39be9c+'\x20'+_0x2c3b8b(0x1e6)+_0x2c3b8b(0x23d)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x410d1[0x0][_0x2c3b8b(0x239)]+'</h5>'+_0x2c3b8b(0x175)+_0x2c3b8b(0x175)+'</body></html>'};_0x446086['sendMail'](_0x4e9c02,function(_0x14fffe,_0x18f016){var _0x3c8bf8=_0x2c3b8b;_0x14fffe?(console[_0x3c8bf8(0x1c5)](_0x14fffe),console['log']('Error\x20Occurs')):console[_0x3c8bf8(0x1c5)](_0x3c8bf8(0x221));}),_0x2ad37a['flash'](_0x2c3b8b(0x23a),'adjustment\x20Finalized\x20successfully'),_0x127917[_0x2c3b8b(0x205)](_0x2c3b8b(0x1ea)+_0x51808d[_0x2c3b8b(0x1f5)]);}catch(_0x27c09a){console['error'](_0x27c09a),_0x127917[_0x2c3b8b(0x1eb)](0x1f4)['json']({'error':_0x2c3b8b(0x220)});}})['catch'](_0x5d3b03=>{var _0x990924=_0x7206d3;console[_0x990924(0x1da)](_0x5d3b03),_0x127917[_0x990924(0x1eb)](0x1f4)[_0x990924(0x214)]({'error':_0x990924(0x1e7)});});}catch(_0x57031e){console[_0x7206d3(0x1c5)](_0x57031e),_0x127917[_0x7206d3(0x1eb)](0xc8)[_0x7206d3(0x214)]({'message':_0x57031e[_0x7206d3(0x1cc)]});}}),router[a0_0xd75606(0x185)]('/view/:id',auth,async(_0x25d1f5,_0xcf2c76)=>{var _0x4166c7=a0_0xd75606;try{const {username:_0x2f9604,email:_0x880582,role:_0x28ace3}=_0x25d1f5['user'],_0x1afb1a=_0x25d1f5[_0x4166c7(0x19e)],_0x5799dc=await profile[_0x4166c7(0x21d)]({'email':_0x1afb1a[_0x4166c7(0x1a9)]}),_0x4058a4=await master_shop['find'](),_0x288d8e=_0x25d1f5[_0x4166c7(0x194)]['id'],_0x59f9f6=await adjustment[_0x4166c7(0x1b5)]({'_id':_0x288d8e}),_0x595027=await purchases[_0x4166c7(0x1aa)]([{'$match':{'warehouse_name':_0x59f9f6[_0x4166c7(0x199)]}},{'$unwind':_0x4166c7(0x17a)},{'$group':{'_id':_0x4166c7(0x1df)}}]),_0x5e1199=await product[_0x4166c7(0x1ac)]({}),_0x12d430=await warehouse['aggregate']([{'$match':{'name':_0x59f9f6[_0x4166c7(0x199)]}},{'$unwind':_0x4166c7(0x218)},{'$group':{'_id':_0x4166c7(0x1d0),'name':{'$first':_0x4166c7(0x1d6)},'product_stock':{'$first':_0x4166c7(0x176)},'bay':{'$first':_0x4166c7(0x207)},'bin':{'$first':_0x4166c7(0x18f)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4166c7(0x1bc)},'primary_code':{'$first':_0x4166c7(0x177)},'secondary_code':{'$first':_0x4166c7(0x1fa)},'product_code':{'$first':_0x4166c7(0x1f0)},'storage':{'$first':_0x4166c7(0x1d7)},'rack':{'$first':_0x4166c7(0x19f)},'maxPerUnit':{'$first':_0x4166c7(0x230)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4166c7(0x237)},'batch_code':{'$first':_0x4166c7(0x18d)},'room':{'$first':_0x4166c7(0x1b1)}}}]);let _0x543a44;if(_0x1afb1a[_0x4166c7(0x1d1)]==_0x4166c7(0x184)){const _0x1c863f=await staff[_0x4166c7(0x21d)]({'email':_0x1afb1a[_0x4166c7(0x1a9)]});_0x543a44=await warehouse[_0x4166c7(0x1aa)]([{'$match':{'status':'Enabled','name':_0x1c863f[_0x4166c7(0x1dc)],'warehouse_category':_0x4166c7(0x180),'name':{'$ne':_0x4166c7(0x1f7)}}},{'$group':{'_id':_0x4166c7(0x23c),'name':{'$first':_0x4166c7(0x23c)}}}]);}else _0x543a44=await warehouse['aggregate']([{'$match':{'status':_0x4166c7(0x227),'warehouse_category':_0x4166c7(0x180),'name':{'$ne':_0x4166c7(0x1f7)}}},{'$group':{'_id':'$name','name':{'$first':_0x4166c7(0x23c)}}}]);if(_0x4058a4[0x0][_0x4166c7(0x1c1)]==_0x4166c7(0x178)){var _0xc6b1d2=users[_0x4166c7(0x224)];console[_0x4166c7(0x1c5)](_0xc6b1d2);}else{if(_0x4058a4[0x0][_0x4166c7(0x1c1)]==_0x4166c7(0x212))var _0xc6b1d2=users['Hindi'];else{if(_0x4058a4[0x0]['language']=='German')var _0xc6b1d2=users[_0x4166c7(0x1ef)];else{if(_0x4058a4[0x0][_0x4166c7(0x1c1)]==_0x4166c7(0x1f8))var _0xc6b1d2=users['Spanish'];else{if(_0x4058a4[0x0][_0x4166c7(0x1c1)]=='French')var _0xc6b1d2=users[_0x4166c7(0x216)];else{if(_0x4058a4[0x0]['language']==_0x4166c7(0x1b7))var _0xc6b1d2=users['Portuguese'];else{if(_0x4058a4[0x0]['language']==_0x4166c7(0x1e5))var _0xc6b1d2=users['Chinese'];else{if(_0x4058a4[0x0]['language']==_0x4166c7(0x1ae))var _0xc6b1d2=users[_0x4166c7(0x183)];}}}}}}}_0xcf2c76[_0x4166c7(0x228)](_0x4166c7(0x1fb),{'success':_0x25d1f5[_0x4166c7(0x179)]('success'),'errors':_0x25d1f5[_0x4166c7(0x179)](_0x4166c7(0x1c3)),'role':_0x1afb1a,'profile':_0x5799dc,'adjustment':_0x59f9f6,'stock':_0x12d430,'master_shop':_0x4058a4,'warehouse_name':_0x595027,'unit':_0x5e1199,'language':_0xc6b1d2,'warehouse':_0x543a44});}catch(_0x513ebe){console['log'](_0x513ebe),_0xcf2c76[_0x4166c7(0x1eb)](0xc8)['json']({'message':_0x513ebe['message']});}}),router[a0_0xd75606(0x1a2)](a0_0xd75606(0x1ec),auth,async(_0x56b981,_0x2b883f)=>{var _0x4dc540=a0_0xd75606;try{const _0x3f888c=_0x56b981[_0x4dc540(0x194)]['id'],_0x307a1e=await adjustment[_0x4dc540(0x1b5)]({'_id':_0x3f888c}),_0x3ab0c6=await warehouse[_0x4dc540(0x21d)]({'name':_0x307a1e[_0x4dc540(0x199)],'room':_0x307a1e[_0x4dc540(0x19a)]}),{warehouse_name:_0x2b2bbb,date:_0x253192,prod_name:_0x251310,level:_0x2879b7,isle:_0x5eae30,pallet:_0xe6a99a,stock:_0x185440,types:_0x4aae0f,adjust_qty:_0x52333f,new_adjust_qty:_0x5bf643,note:_0x2724a3,Room_name:_0x5e9fd4,invoice:_0x630c5d,JO_number:_0xcd792a,expiry_date:_0x590d4d}=_0x56b981[_0x4dc540(0x21f)];if(typeof _0x251310==_0x4dc540(0x1af))var _0x32d04d=[_0x56b981['body'][_0x4dc540(0x1ad)]],_0x5b67af=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x20c)]],_0x4ea0ed=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1dd)]],_0x3b80f0=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1b0)]],_0x12f724=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x171)]],_0x223bcf=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1d5)]],_0xa6ec3b=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x174)]],_0x1d7854=[_0x56b981['body'][_0x4dc540(0x1ee)]],_0x4d98bb=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x235)]],_0x3210e1=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x236)]],_0x55c934=[_0x56b981[_0x4dc540(0x21f)]['expiry_date']],_0x50acb8=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1c9)]],_0x2199fc=[_0x56b981['body']['production_date']],_0x399583=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1c8)]],_0x39b585=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x210)]],_0x46432=[_0x56b981['body'][_0x4dc540(0x1c2)]],_0x54ec2d=[_0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1c4)]];else var _0x32d04d=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1ad)]],_0x5b67af=[..._0x56b981[_0x4dc540(0x21f)]['level']],_0x4ea0ed=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1dd)]],_0x3b80f0=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1b0)]],_0x12f724=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x171)]],_0x223bcf=[..._0x56b981['body']['New_Qty_Converted']],_0xa6ec3b=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1e1)]],_0x1d7854=[..._0x56b981[_0x4dc540(0x21f)]['Secondary_units']],_0x4d98bb=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x235)]],_0x3210e1=[..._0x56b981['body']['batch_code']],_0x55c934=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x193)]],_0x50acb8=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1c9)]],_0x2199fc=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x234)]],_0x399583=[..._0x56b981[_0x4dc540(0x21f)]['prod_cat']],_0x39b585=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x210)]],_0x46432=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1c2)]],_0x54ec2d=[..._0x56b981[_0x4dc540(0x21f)][_0x4dc540(0x1c4)]];const _0x400fc4=_0x32d04d[_0x4dc540(0x242)](_0x594bac=>{return _0x594bac={'product_name':_0x594bac};});_0x5b67af[_0x4dc540(0x1b3)]((_0x428cfc,_0x3cd582)=>{var _0x40fd15=_0x4dc540;_0x39b585[_0x40fd15(0x1b3)]((_0x561e88,_0x2bf7a4)=>{var _0x4f36f7=_0x40fd15;if(_0x561e88==_0x4f36f7(0x23b)&&_0x3cd582==_0x2bf7a4){var _0x4ac48c=_0x428cfc[_0x4f36f7(0x18a)](0x3);_0x400fc4[_0x3cd582][_0x4f36f7(0x187)]=_0x428cfc[0x0],_0x400fc4[_0x3cd582][_0x4f36f7(0x1fc)]=_0x428cfc[0x1],_0x400fc4[_0x3cd582][_0x4f36f7(0x20d)]=0x0,_0x400fc4[_0x3cd582][_0x4f36f7(0x1d9)]=0x0,_0x400fc4[_0x3cd582][_0x4f36f7(0x1c7)]='Floor',_0x400fc4[_0x3cd582][_0x4f36f7(0x17f)]=_0x4ac48c;}else{if(_0x561e88=='Shelves'&&_0x3cd582==_0x2bf7a4){var _0x4ac48c=_0x428cfc[_0x4f36f7(0x18a)](0x3);_0x400fc4[_0x3cd582][_0x4f36f7(0x187)]=_0x428cfc[0x0],_0x400fc4[_0x3cd582][_0x4f36f7(0x1fc)]=_0x428cfc[0x1],_0x400fc4[_0x3cd582][_0x4f36f7(0x20d)]=0x0,_0x400fc4[_0x3cd582]['bin']=0x0,_0x400fc4[_0x3cd582][_0x4f36f7(0x1c7)]=_0x4f36f7(0x18b),_0x400fc4[_0x3cd582][_0x4f36f7(0x17f)]=_0x428cfc[0x5];}else{if(_0x3cd582==_0x2bf7a4){var _0x43c60b;if(_0x428cfc[0x4]=='L')_0x43c60b=_0x4f36f7(0x18e);else _0x428cfc[0x4]=='F'&&(_0x43c60b=_0x4f36f7(0x18b));_0x400fc4[_0x3cd582][_0x4f36f7(0x187)]=_0x428cfc[0x0],_0x400fc4[_0x3cd582][_0x4f36f7(0x1fc)]=_0x428cfc[0x1],_0x400fc4[_0x3cd582][_0x4f36f7(0x20d)]=_0x428cfc[0x2],_0x400fc4[_0x3cd582][_0x4f36f7(0x1d9)]=_0x428cfc[0x3],_0x400fc4[_0x3cd582][_0x4f36f7(0x1c7)]=_0x43c60b,_0x400fc4[_0x3cd582][_0x4f36f7(0x17f)]=_0x428cfc[0x5];}}}});}),_0x4ea0ed['forEach']((_0x3524b9,_0xb5f18c)=>{_0x400fc4[_0xb5f18c]['stockBefore']=_0x3524b9;}),_0x3b80f0['forEach']((_0x469cf5,_0x16a08d)=>{var _0x2d75ba=_0x4dc540;_0x400fc4[_0x16a08d][_0x2d75ba(0x1b0)]=_0x469cf5;}),_0x12f724[_0x4dc540(0x1b3)]((_0xdd5df3,_0x4b53c2)=>{_0x400fc4[_0x4b53c2]['adjust_qty']=_0xdd5df3;}),_0x223bcf[_0x4dc540(0x1b3)]((_0x358fbc,_0x194ccd)=>{_0x400fc4[_0x194ccd]['new_adjust_qty']=_0x358fbc;}),_0xa6ec3b[_0x4dc540(0x1b3)]((_0x16d1d8,_0x3e1b33)=>{var _0x3a1133=_0x4dc540;_0x400fc4[_0x3e1b33][_0x3a1133(0x1e1)]=_0x16d1d8;}),_0x1d7854[_0x4dc540(0x1b3)]((_0x5748d4,_0x2fda92)=>{_0x400fc4[_0x2fda92]['secondary_unit']=_0x5748d4;}),_0x4d98bb[_0x4dc540(0x1b3)]((_0x17e94d,_0x219fc0)=>{var _0x234bc9=_0x4dc540;_0x400fc4[_0x219fc0][_0x234bc9(0x181)]=_0x17e94d;}),_0x3210e1[_0x4dc540(0x1b3)]((_0x301ca2,_0x166e85)=>{var _0x34aea2=_0x4dc540;_0x400fc4[_0x166e85][_0x34aea2(0x236)]=_0x301ca2;}),_0x55c934[_0x4dc540(0x1b3)]((_0x5cdd68,_0x502e95)=>{var _0x271ace=_0x4dc540;_0x400fc4[_0x502e95][_0x271ace(0x193)]=_0x5cdd68;}),_0x50acb8[_0x4dc540(0x1b3)]((_0x5423f9,_0x2cdc14)=>{var _0x1fbbfd=_0x4dc540;_0x400fc4[_0x2cdc14][_0x1fbbfd(0x1a3)]=_0x5423f9;}),_0x2199fc['forEach']((_0x212ab8,_0x38d71e)=>{var _0x140e5f=_0x4dc540;_0x400fc4[_0x38d71e][_0x140e5f(0x234)]=_0x212ab8;}),_0x399583['forEach']((_0x4edf11,_0x575623)=>{var _0x38a796=_0x4dc540;_0x400fc4[_0x575623][_0x38a796(0x1c8)]=_0x4edf11;}),_0x39b585[_0x4dc540(0x1b3)]((_0x571168,_0x5acfd3)=>{_0x400fc4[_0x5acfd3]['room_names']=_0x571168;}),_0x46432[_0x4dc540(0x1b3)]((_0x6c05cd,_0x5275d9)=>{var _0x5ce091=_0x4dc540;_0x400fc4[_0x5275d9][_0x5ce091(0x1b6)]=_0x6c05cd;}),_0x54ec2d[_0x4dc540(0x1b3)]((_0x129154,_0x3cc030)=>{var _0x49845b=_0x4dc540;_0x400fc4[_0x3cc030][_0x49845b(0x238)]=_0x129154;});const _0x480167=_0x400fc4['filter'](_0x162cc3=>_0x162cc3['adjust_qty']!=='0'&&_0x162cc3['adjust_qty']!=='');var _0x37650c=0x0;_0x480167['forEach'](_0x31ac4c=>{var _0x37ee67=_0x4dc540;console[_0x37ee67(0x1c5)](_0x37ee67(0x19b),_0x31ac4c),parseInt(_0x31ac4c[_0x37ee67(0x22a)])<=0x0&&_0x37650c++;});if(_0x37650c!=0x0)return _0x56b981[_0x4dc540(0x179)](_0x4dc540(0x1c3),_0x4dc540(0x1ff)),_0x2b883f[_0x4dc540(0x205)](_0x4dc540(0x240));_0x307a1e['warehouse_name']=_0x2b2bbb,_0x307a1e[_0x4dc540(0x213)]=_0x253192,_0x307a1e[_0x4dc540(0x203)]=_0x480167,_0x307a1e[_0x4dc540(0x215)]=_0x2724a3,_0x307a1e[_0x4dc540(0x20f)]=_0x630c5d,_0x307a1e['isAllowEdit']=_0x4dc540(0x1a4);const _0x28a418=await _0x307a1e[_0x4dc540(0x208)]();_0x56b981[_0x4dc540(0x179)](_0x4dc540(0x23a),_0x4dc540(0x1a8)),_0x2b883f[_0x4dc540(0x205)]('/adjustment/view');}catch(_0x344fee){console['log'](_0x344fee);}}),router[a0_0xd75606(0x1a2)](a0_0xd75606(0x190),async(_0xb1bd9b,_0x2281c6)=>{var _0x7b6b39=a0_0xd75606;const {primary_code:_0x3c189a,warehouse_data:_0x4c9e03,rooms_data:_0x3acf9f,Roomslist:_0x182fba}=_0xb1bd9b[_0x7b6b39(0x21f)],_0x55ef3e=_0x182fba['split'](','),_0x45ab3b=[];async function _0x879587(_0x8f7aaf){var _0x159cdf=_0x7b6b39;const _0x389c0a=await warehouse['aggregate']([{'$match':{'name':_0x4c9e03,'room':_0x8f7aaf}},{'$unwind':_0x159cdf(0x218)},{'$match':{'product_details.primary_code':_0x3c189a}},{'$group':{'_id':_0x159cdf(0x1d0),'name':{'$first':_0x159cdf(0x1d6)},'product_stock':{'$first':_0x159cdf(0x176)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x159cdf(0x1fa)},'product_code':{'$first':_0x159cdf(0x1f0)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x159cdf(0x18f)},'type':{'$first':_0x159cdf(0x241)},'pallet':{'$first':_0x159cdf(0x1bc)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x159cdf(0x1a6)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x159cdf(0x19f)},'expiry_date':{'$first':_0x159cdf(0x198)},'production_date':{'$first':_0x159cdf(0x237)},'maxPerUnit':{'$first':_0x159cdf(0x230)},'batch_code':{'$first':_0x159cdf(0x18d)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x159cdf(0x1b1)}}}]),_0x5ba02a=await warehouse['aggregate']([{'$match':{'name':_0x4c9e03,'room':_0x8f7aaf}},{'$unwind':_0x159cdf(0x218)},{'$match':{'product_details.secondary_code':_0x3c189a}},{'$group':{'_id':_0x159cdf(0x1d0),'name':{'$first':_0x159cdf(0x1d6)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x159cdf(0x177)},'secondary_code':{'$first':_0x159cdf(0x1fa)},'product_code':{'$first':_0x159cdf(0x1f0)},'level':{'$first':_0x159cdf(0x207)},'isle':{'$first':_0x159cdf(0x18f)},'type':{'$first':_0x159cdf(0x241)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x159cdf(0x20a)},'secondary_unit':{'$first':_0x159cdf(0x1a6)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x159cdf(0x230)},'batch_code':{'$first':_0x159cdf(0x18d)},'product_cat':{'$first':_0x159cdf(0x188)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x159cdf(0x1b1)}}}]);if(_0x389c0a[_0x159cdf(0x223)]>0x0)_0x45ab3b[_0x159cdf(0x17e)](_0x389c0a);else _0x5ba02a[_0x159cdf(0x223)]>0x0&&_0x45ab3b[_0x159cdf(0x17e)](_0x5ba02a);}const _0x182944=_0x55ef3e[_0x7b6b39(0x242)](_0x203e69=>_0x879587(_0x203e69));await Promise[_0x7b6b39(0x1fe)](_0x182944),_0x2281c6['json'](_0x45ab3b);}),router[a0_0xd75606(0x1a2)](a0_0xd75606(0x196),async(_0xcac3ba,_0xc0bf17)=>{var _0x34c54d=a0_0xd75606;const {primaryCode:_0x51b556,secondaryCode:_0x1834a5,productCode:_0x22cf59,level:_0x56b27e,isle:_0x3f285b,pallet:_0x127f9f,warehouses:_0xd3d9e9,room:_0x3c190f}=_0xcac3ba[_0x34c54d(0x21f)];try{const _0xc64ad1=await warehouse['aggregate']([{'$match':{'name':_0xd3d9e9,'room':_0x3c190f}},{'$unwind':_0x34c54d(0x218)},{'$match':{'product_details.level':parseInt(_0x56b27e),'product_details.isle':_0x3f285b,'product_details.pallet':parseInt(_0x127f9f)}},{'$group':{'_id':_0x34c54d(0x1d0),'name':{'$first':_0x34c54d(0x1d6)},'product_stock':{'$first':_0x34c54d(0x176)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x34c54d(0x1ab)},'maxProducts':{'$first':_0x34c54d(0x1be)}}}]);_0xc0bf17[_0x34c54d(0x1eb)](0xc8)[_0x34c54d(0x214)](_0xc64ad1);}catch(_0x513858){_0xc0bf17[_0x34c54d(0x1eb)](0x194)[_0x34c54d(0x214)]({'message':_0x513858[_0x34c54d(0x1cc)]});}}),module[a0_0xd75606(0x1c0)]=router;