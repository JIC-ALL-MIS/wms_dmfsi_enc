var a0_0x543938=a0_0x3853;(function(_0x4b8698,_0x11f850){var _0x328978=a0_0x3853,_0x1e669c=_0x4b8698();while(!![]){try{var _0x4f4016=-parseInt(_0x328978(0x12b))/0x1+-parseInt(_0x328978(0xc3))/0x2+-parseInt(_0x328978(0x9f))/0x3+-parseInt(_0x328978(0xe7))/0x4*(-parseInt(_0x328978(0x131))/0x5)+parseInt(_0x328978(0x144))/0x6*(-parseInt(_0x328978(0x88))/0x7)+-parseInt(_0x328978(0x12c))/0x8+parseInt(_0x328978(0xa8))/0x9*(parseInt(_0x328978(0xc8))/0xa);if(_0x4f4016===_0x11f850)break;else _0x1e669c['push'](_0x1e669c['shift']());}catch(_0x5b2d42){_0x1e669c['push'](_0x1e669c['shift']());}}}(a0_0x13f9,0xdb2c9));function a0_0x13f9(){var _0xf7183b=['render','French','Router','adjustment','site_title','$product_details.pallet','push','500EustfZ','$product_details.primary_code','secondary_unit','body','$product_details.expiry_date','/CheckingWarehouse','exports','stock','/adjustment/preview/','user','Portuguese\x20(BR)','room','success','Floor','_id','$product_details.unit','prod_name','$product_details','$_id','edit_adjustment','catch','image','filter','$product_details.secondary_code','$product.room_names','type','$product_details.product_stock','$product_details.maxProducts','adjust_qty','Email\x20sent\x20successfully','$product_details.bay','$product_details.isle','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','forEach','log','new_adjust_qty','floorlevel','Secondary_units','There\x27s\x20a\x20error\x20in\x20this\x20transaction','status','product_stock','</tr>','prod_invoice','batch_code','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','bin','adjustment\x20Finalized\x20successfully','stockBefore','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.type','<h5>','/barcode_scanner','all','Spanish','invoice','Adjustment\x20Mail','<!DOCTYPE\x20html>','</body></html>','createTransport','rack','$name','split','floor','</div>','<div>','1702902vXHHlb','4993280YpUVMG','post','room_names','$product_details.production_date','Raw\x20Materials','13780DxXOAs','$product_details.floorlevel','Error\x20Occurs','types','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Return\x20Rooms','production_date','$finalize','find','$product_details.product_cat','$product_details.product_code','Enabled','message','Primary_Units','$product_details.bin','aggregate','findById','port','then','522rQUFlT','/../public','foreach\x20newproduct','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$warehouse_name','expiry_date','New_Qty_Converted_adj','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','English\x20(US)','Arabic\x20(ae)','save','/view/add_adjustment','Shelves','findOne','Ambient','Logo.png','/adjustment/view','/picking_list/PDF_adjustment_rm/','Receiving\x20Area','$isAllowEdit','staff','isAllowEdit','warehouse_name','\x20Order\x20Date\x20:\x20','maxperunit','/view','nodemailer','map','../models/all_models','3059plGdCR','Portuguese','</h5>','$product_details.storage','</head><body>','maxPerUnit','$product_details.maxPerUnit','/upload/','email','English','\x20</h2>','product_name','$product_details.batch_code','<h5\x20style=\x22text-align:\x20left;\x22>','language','prod_code','<tbody\x20style=\x22text-align:\x20center;\x22>','flash','prime1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','back','Chinese','$product_details._id','3958353oWcxgi','Rooms','Arabic','New_Qty_Converted','product','Hindi','../public/language/languages.json','password','json','45bCSaxH','</td>','$room','storage','error','primary_code','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<h2>\x20','/view/:id','<hr\x20class=\x22my-3\x22>','logo','Return\x20Goods','unit','get','/preview/:id','date','$product_details.product_name','host','False','product_details','\x20<>\x20','toString','padStart','warehouse','adjustment\x20data\x20update\x20successfully','product_code','edit_adjustment_view','892412Ztzxex','German','second1','slice','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','9367950GzyKLG','$product_details.rack','minus','</span>','add_adjustment','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.secondary_unit','ADJ-','max_per_unit','adjustment\x20add\x20successfull','length','params','master','$product_details.level','redirect','string','role','express','../middleware/auth','$product','level','$product.product_name','errors','bay'];a0_0x13f9=function(){return _0xf7183b;};return a0_0x13f9();}const express=require(a0_0x543938(0xd9)),app=express(),router=express[a0_0x543938(0xe2)](),auth=require(a0_0x543938(0xda)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x543938(0x87)),users=require(a0_0x543938(0xa5)),nodemailer=require(a0_0x543938(0x85));function a0_0x3853(_0x19a814,_0x2391e8){var _0x13f948=a0_0x13f9();return a0_0x3853=function(_0x3853f1,_0x37ebad){_0x3853f1=_0x3853f1-0x7d;var _0x319d50=_0x13f948[_0x3853f1];return _0x319d50;},a0_0x3853(_0x19a814,_0x2391e8);}router[a0_0x543938(0xb5)](a0_0x543938(0x84),auth,async(_0x3b9e52,_0x3cfab2)=>{var _0x15e4ff=a0_0x543938;try{const {username:_0x1721f0,email:_0x1433ea,role:_0x8bc8af}=_0x3b9e52[_0x15e4ff(0xf0)],_0x51ca90=_0x3b9e52['user'],_0x5df7d8=await profile[_0x15e4ff(0x152)]({'email':_0x51ca90[_0x15e4ff(0x90)]}),_0x1fcc7f=await master_shop[_0x15e4ff(0x139)]();console['log'](_0x15e4ff(0xd4),_0x1fcc7f);let _0x4152bf;if(_0x51ca90['role']==_0x15e4ff(0x7f)){const _0x40d092=await staff[_0x15e4ff(0x152)]({'email':_0x51ca90[_0x15e4ff(0x90)]});_0x4152bf=await warehouse[_0x15e4ff(0x139)]({'status':_0x15e4ff(0x13c),'name':_0x40d092[_0x15e4ff(0xbf)]});}else _0x4152bf=await warehouse['find']({'status':_0x15e4ff(0x13c)});const _0x1a2ca1=await product[_0x15e4ff(0x139)]();let _0x4e9472;if(_0x51ca90[_0x15e4ff(0xd8)]=='staff'){const _0x467f7a=await staff['findOne']({'email':_0x51ca90['email']});_0x4e9472=await adjustment['find']({'warehouse_name':_0x467f7a[_0x15e4ff(0xbf)]});}else _0x4e9472=await adjustment['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x15e4ff(0xf9),'invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x15e4ff(0x148)},'room':{'$addToSet':_0x15e4ff(0xff)},'finalize':{'$first':_0x15e4ff(0x138)},'isAllowEdit':{'$first':_0x15e4ff(0x7e)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1fcc7f[0x0][_0x15e4ff(0x96)]=='English\x20(US)'){var _0x4742f8=users[_0x15e4ff(0x91)];console[_0x15e4ff(0x10a)](_0x4742f8);}else{if(_0x1fcc7f[0x0]['language']=='Hindi')var _0x4742f8=users[_0x15e4ff(0xa4)];else{if(_0x1fcc7f[0x0][_0x15e4ff(0x96)]==_0x15e4ff(0xc4))var _0x4742f8=users[_0x15e4ff(0xc4)];else{if(_0x1fcc7f[0x0][_0x15e4ff(0x96)]==_0x15e4ff(0x11f))var _0x4742f8=users[_0x15e4ff(0x11f)];else{if(_0x1fcc7f[0x0][_0x15e4ff(0x96)]==_0x15e4ff(0xe1))var _0x4742f8=users['French'];else{if(_0x1fcc7f[0x0][_0x15e4ff(0x96)]==_0x15e4ff(0xf1))var _0x4742f8=users[_0x15e4ff(0x89)];else{if(_0x1fcc7f[0x0]['language']=='Chinese')var _0x4742f8=users[_0x15e4ff(0x9d)];else{if(_0x1fcc7f[0x0][_0x15e4ff(0x96)]==_0x15e4ff(0x14e))var _0x4742f8=users['Arabic'];}}}}}}}_0x3cfab2[_0x15e4ff(0xe0)](_0x15e4ff(0xe3),{'success':_0x3b9e52[_0x15e4ff(0x99)](_0x15e4ff(0xf3)),'errors':_0x3b9e52[_0x15e4ff(0x99)](_0x15e4ff(0xde)),'role':_0x51ca90,'profile':_0x5df7d8,'warehouse':_0x4152bf,'product':_0x1a2ca1,'adjustment':_0x4e9472,'master_shop':_0x1fcc7f,'language':_0x4742f8});}catch(_0x4e5fe1){console[_0x15e4ff(0x10a)](_0x4e5fe1);}});async function getRandom8DigitNumber(){var _0x5a5b12=a0_0x543938;const _0x189171=0x989680,_0x28285c=0x5f5e0ff,_0x303951=Math[_0x5a5b12(0x128)](Math['random']()*(_0x28285c-_0x189171+0x1))+_0x189171;var _0x5d09d9;const _0x2c39c0=await adjustment['findOne']({'invoice':_0x5a5b12(0xcf)+_0x303951});return _0x2c39c0&&_0x2c39c0[_0x5a5b12(0xd2)]>0x0?_0x5d09d9=_0x5a5b12(0xcf)+_0x303951:_0x5d09d9=_0x5a5b12(0xcf)+_0x303951,_0x5d09d9;}router[a0_0x543938(0xb5)](a0_0x543938(0x150),auth,async(_0x2b8845,_0x3f87ac)=>{var _0x58b8a9=a0_0x543938;try{const {username:_0x577491,email:_0x564310,role:_0x1da37c}=_0x2b8845[_0x58b8a9(0xf0)],_0x48c13a=_0x2b8845['user'],_0x4fc8f0=await profile[_0x58b8a9(0x152)]({'email':_0x48c13a['email']}),_0x489a84=await master_shop[_0x58b8a9(0x139)]();let _0x35adba;if(_0x48c13a[_0x58b8a9(0xd8)]==_0x58b8a9(0x7f)){const _0x48cb78=await staff[_0x58b8a9(0x152)]({'email':_0x48c13a[_0x58b8a9(0x90)]});_0x35adba=await warehouse[_0x58b8a9(0x140)]([{'$match':{'status':_0x58b8a9(0x13c),'name':_0x48cb78[_0x58b8a9(0xbf)],'warehouse_category':_0x58b8a9(0x130),'name':{'$ne':_0x58b8a9(0xb3)}}},{'$group':{'_id':_0x58b8a9(0x126),'name':{'$first':_0x58b8a9(0x126)}}}]);}else _0x35adba=await warehouse['aggregate']([{'$match':{'status':_0x58b8a9(0x13c),'warehouse_category':_0x58b8a9(0x130),'name':{'$ne':_0x58b8a9(0xb3)}}},{'$group':{'_id':_0x58b8a9(0x126),'name':{'$first':_0x58b8a9(0x126)}}}]);const _0xb56d61=await product['find']({}),_0x138a8b=await adjustment[_0x58b8a9(0x139)]({}),_0x5074cc=_0x138a8b[_0x58b8a9(0xd2)]+0x1,_0x404445=_0x58b8a9(0xcf)+_0x5074cc[_0x58b8a9(0xbd)]()[_0x58b8a9(0xbe)](0x5,'0');var _0x41e27a=[_0x58b8a9(0x153),'Enclosed',_0x58b8a9(0x136)];if(_0x489a84[0x0][_0x58b8a9(0x96)]=='English\x20(US)')var _0x1b7a18=users[_0x58b8a9(0x91)];else{if(_0x489a84[0x0]['language']=='Hindi')var _0x1b7a18=users[_0x58b8a9(0xa4)];else{if(_0x489a84[0x0][_0x58b8a9(0x96)]==_0x58b8a9(0xc4))var _0x1b7a18=users['German'];else{if(_0x489a84[0x0][_0x58b8a9(0x96)]=='Spanish')var _0x1b7a18=users[_0x58b8a9(0x11f)];else{if(_0x489a84[0x0][_0x58b8a9(0x96)]=='French')var _0x1b7a18=users['French'];else{if(_0x489a84[0x0][_0x58b8a9(0x96)]=='Portuguese\x20(BR)')var _0x1b7a18=users[_0x58b8a9(0x89)];else{if(_0x489a84[0x0][_0x58b8a9(0x96)]==_0x58b8a9(0x9d))var _0x1b7a18=users['Chinese'];else{if(_0x489a84[0x0][_0x58b8a9(0x96)]==_0x58b8a9(0x14e))var _0x1b7a18=users[_0x58b8a9(0xa1)];}}}}}}}const _0x5d7486=getRandom8DigitNumber();_0x5d7486[_0x58b8a9(0x143)](_0x743933=>{var _0x397bfd=_0x58b8a9;_0x3f87ac[_0x397bfd(0xe0)](_0x397bfd(0xcc),{'success':_0x2b8845[_0x397bfd(0x99)](_0x397bfd(0xf3)),'errors':_0x2b8845[_0x397bfd(0x99)](_0x397bfd(0xde)),'role':_0x48c13a,'profile':_0x4fc8f0,'warehouse':_0x35adba,'product':_0xb56d61,'master_shop':_0x489a84,'language':_0x1b7a18,'rooms_data':_0x41e27a,'invoice_no':_0x743933});})[_0x58b8a9(0xfb)](_0x4a3f11=>{var _0x37d383=_0x58b8a9;_0x2b8845[_0x37d383(0x99)](_0x37d383(0xde),_0x37d383(0x10e)),_0x3f87ac[_0x37d383(0xd6)](_0x37d383(0x155));});}catch(_0x2731c5){console[_0x58b8a9(0x10a)](_0x2731c5);}}),router[a0_0x543938(0x12d)]('/view/add_adjustment',auth,async(_0x477d7b,_0x3a172a)=>{var _0x1e6090=a0_0x543938;try{const {warehouse_name:_0x46bea4,date:_0x50eb19,prod_name:_0x4a5c53,level:_0x268734,isle:_0x437bcf,pallet:_0x42d3f6,stock:_0x42fdc8,types:_0xc7441d,adjust_qty:_0xd3bbad,new_adjust_qty:_0x58be45,note:_0x2d9e9d,Room_name:_0x2fd6ec,invoice:_0x4b1589,JO_number:_0x1ac24e,expiry_date:_0x468487}=_0x477d7b['body'];if(typeof _0x4a5c53==_0x1e6090(0xd7))var _0x153ff3=[_0x477d7b[_0x1e6090(0xea)]['prod_name']],_0x46b895=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xdc)]],_0x2290be=[_0x477d7b[_0x1e6090(0xea)]['stock']],_0x241812=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x134)]],_0x4817d8=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x14a)]],_0x4a4bc7=[_0x477d7b['body'][_0x1e6090(0xa2)]],_0x168a87=[_0x477d7b[_0x1e6090(0xea)]['Primary_Units']],_0x4ae954=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x10d)]],_0x294bf2=[_0x477d7b[_0x1e6090(0xea)]['prod_code']],_0x54c53a=[_0x477d7b['body'][_0x1e6090(0x113)]],_0x1bd2d4=[_0x477d7b[_0x1e6090(0xea)]['expiry_date']],_0x378d39=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xd0)]],_0x23f053=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x137)]],_0x4079bf=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x14b)]],_0xab3e86=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xa0)]],_0x3377b7=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x9a)]],_0x18f0fb=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xc5)]],_0x9a2d78=[_0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x112)]];else var _0x153ff3=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xf7)]],_0x46b895=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xdc)]],_0x2290be=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xee)]],_0x241812=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x134)]],_0x4817d8=[..._0x477d7b['body'][_0x1e6090(0x14a)]],_0x4a4bc7=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xa2)]],_0x168a87=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xb4)]],_0x4ae954=[..._0x477d7b['body'][_0x1e6090(0x10d)]],_0x294bf2=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x97)]],_0x54c53a=[..._0x477d7b[_0x1e6090(0xea)]['batch_code']],_0x1bd2d4=[..._0x477d7b[_0x1e6090(0xea)]['expiry_date']],_0x378d39=[..._0x477d7b['body'][_0x1e6090(0xd0)]],_0x23f053=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x137)]],_0x4079bf=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x14b)]],_0xab3e86=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xa0)]],_0x3377b7=[..._0x477d7b['body'][_0x1e6090(0x9a)]],_0x18f0fb=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0xc5)]],_0x9a2d78=[..._0x477d7b[_0x1e6090(0xea)][_0x1e6090(0x112)]];const _0x46a4c6=_0x153ff3['map'](_0x31d327=>{return _0x31d327={'product_name':_0x31d327};});_0x46b895[_0x1e6090(0x109)]((_0x3df58e,_0x5e46c6)=>{_0xab3e86['forEach']((_0xa0ab32,_0x293ffe)=>{var _0x3aa8b9=a0_0x3853;if(_0xa0ab32==_0x3aa8b9(0x7d)&&_0x5e46c6==_0x293ffe){var _0x552b75=_0x3df58e['slice'](0x3);_0x46a4c6[_0x5e46c6][_0x3aa8b9(0xab)]=_0x3df58e[0x0],_0x46a4c6[_0x5e46c6][_0x3aa8b9(0x125)]=_0x3df58e[0x1],_0x46a4c6[_0x5e46c6][_0x3aa8b9(0xdf)]=0x0,_0x46a4c6[_0x5e46c6][_0x3aa8b9(0x117)]=0x0,_0x46a4c6[_0x5e46c6][_0x3aa8b9(0x100)]=_0x3aa8b9(0xf4),_0x46a4c6[_0x5e46c6][_0x3aa8b9(0x10c)]=_0x552b75;}else{if(_0xa0ab32==_0x3aa8b9(0x151)&&_0x5e46c6==_0x293ffe){var _0x552b75=_0x3df58e[_0x3aa8b9(0xc6)](0x3);_0x46a4c6[_0x5e46c6][_0x3aa8b9(0xab)]=_0x3df58e[0x0],_0x46a4c6[_0x5e46c6][_0x3aa8b9(0x125)]=_0x3df58e[0x1],_0x46a4c6[_0x5e46c6][_0x3aa8b9(0xdf)]=0x0,_0x46a4c6[_0x5e46c6][_0x3aa8b9(0x117)]=0x0,_0x46a4c6[_0x5e46c6]['type']=_0x3aa8b9(0xf4),_0x46a4c6[_0x5e46c6]['floorlevel']=_0x3df58e[0x5];}else{if(_0x5e46c6==_0x293ffe){var _0x5eb23e;if(_0x3df58e[0x4]=='L')_0x5eb23e='Level';else _0x3df58e[0x4]=='F'&&(_0x5eb23e=_0x3aa8b9(0xf4));_0x46a4c6[_0x5e46c6][_0x3aa8b9(0xab)]=_0x3df58e[0x0],_0x46a4c6[_0x5e46c6][_0x3aa8b9(0x125)]=_0x3df58e[0x1],_0x46a4c6[_0x5e46c6][_0x3aa8b9(0xdf)]=_0x3df58e[0x2],_0x46a4c6[_0x5e46c6]['bin']=_0x3df58e[0x3],_0x46a4c6[_0x5e46c6]['type']=_0x5eb23e,_0x46a4c6[_0x5e46c6]['floorlevel']=_0x3df58e[0x5];}}}});}),_0x2290be[_0x1e6090(0x109)]((_0x4a9785,_0xd2e2db)=>{var _0x1d99af=_0x1e6090;_0x46a4c6[_0xd2e2db][_0x1d99af(0x119)]=_0x4a9785;}),_0x241812[_0x1e6090(0x109)]((_0x5095e,_0x4b2cb3)=>{_0x46a4c6[_0x4b2cb3]['types']=_0x5095e;}),_0x4817d8[_0x1e6090(0x109)]((_0x3ccd5a,_0x4f772c)=>{var _0x57e14e=_0x1e6090;_0x46a4c6[_0x4f772c][_0x57e14e(0x103)]=_0x3ccd5a;}),_0x4a4bc7['forEach']((_0x5e4d8a,_0xbce618)=>{var _0x3c44b6=_0x1e6090;_0x46a4c6[_0xbce618][_0x3c44b6(0x10b)]=_0x5e4d8a;}),_0x168a87[_0x1e6090(0x109)]((_0x575bcb,_0x3a148e)=>{var _0x4f1103=_0x1e6090;_0x46a4c6[_0x3a148e][_0x4f1103(0xb4)]=_0x575bcb;}),_0x4ae954[_0x1e6090(0x109)]((_0x46d020,_0x4bf134)=>{var _0x38ec53=_0x1e6090;_0x46a4c6[_0x4bf134][_0x38ec53(0xe9)]=_0x46d020;}),_0x294bf2[_0x1e6090(0x109)]((_0x585973,_0x2d9353)=>{var _0xdf8f7d=_0x1e6090;_0x46a4c6[_0x2d9353][_0xdf8f7d(0xc1)]=_0x585973;}),_0x54c53a[_0x1e6090(0x109)]((_0x317105,_0x44bafb)=>{_0x46a4c6[_0x44bafb]['batch_code']=_0x317105;}),_0x1bd2d4[_0x1e6090(0x109)]((_0xb93baa,_0x30c44d)=>{var _0x8c455d=_0x1e6090;_0x46a4c6[_0x30c44d][_0x8c455d(0x149)]=_0xb93baa;}),_0x378d39[_0x1e6090(0x109)]((_0x2d40fc,_0x4d7e0c)=>{var _0x3e5314=_0x1e6090;_0x46a4c6[_0x4d7e0c][_0x3e5314(0x83)]=_0x2d40fc;}),_0x23f053[_0x1e6090(0x109)]((_0x182074,_0x232c56)=>{var _0x2306b7=_0x1e6090;_0x46a4c6[_0x232c56][_0x2306b7(0x137)]=_0x182074;}),_0x4079bf[_0x1e6090(0x109)]((_0xd48681,_0x262bb0)=>{var _0x3cda47=_0x1e6090;_0x46a4c6[_0x262bb0][_0x3cda47(0x14b)]=_0xd48681;}),_0xab3e86['forEach']((_0x438b45,_0xe1e686)=>{var _0x285344=_0x1e6090;_0x46a4c6[_0xe1e686][_0x285344(0x12e)]=_0x438b45;}),_0x3377b7['forEach']((_0x612336,_0x245810)=>{_0x46a4c6[_0x245810]['primary_code']=_0x612336;}),_0x18f0fb[_0x1e6090(0x109)]((_0x5e7baf,_0x5b645d)=>{_0x46a4c6[_0x5b645d]['secondary_code']=_0x5e7baf;}),_0x9a2d78[_0x1e6090(0x109)]((_0x333c77,_0x54e058)=>{_0x46a4c6[_0x54e058]['invoice']=_0x333c77;});const _0x564d15=_0x46a4c6[_0x1e6090(0xfd)](_0x386266=>_0x386266[_0x1e6090(0x103)]!=='0'&&_0x386266[_0x1e6090(0x103)]!=='');var _0x3e285c=0x0;_0x564d15[_0x1e6090(0x109)](_0x2ba77f=>{var _0x3a4e7b=_0x1e6090;console[_0x3a4e7b(0x10a)]('foreach\x20newproduct',_0x2ba77f),parseInt(_0x2ba77f[_0x3a4e7b(0x103)])<=0x0&&_0x3e285c++;});if(_0x3e285c!=0x0)return _0x477d7b[_0x1e6090(0x99)](_0x1e6090(0xde),_0x1e6090(0xae)),_0x3a172a['redirect'](_0x1e6090(0x9c));const _0x1afa0a=new adjustment({'warehouse_name':_0x46bea4,'date':_0x50eb19,'product':_0x564d15,'note':_0x2d9e9d,'room':_0x2fd6ec,'invoice':_0x4b1589,'JO_number':_0x1ac24e,'expiry_date':_0x468487}),_0x3c1fc4=await _0x1afa0a['save']();_0x477d7b['flash'](_0x1e6090(0xf3),_0x1e6090(0xd1)),_0x3a172a[_0x1e6090(0xd6)](_0x1e6090(0xef)+_0x3c1fc4['_id']);}catch(_0xabe758){console[_0x1e6090(0x10a)](_0xabe758),_0x3a172a[_0x1e6090(0x10f)](0xc8)[_0x1e6090(0xa7)]({'message':_0xabe758[_0x1e6090(0x13d)]});}}),router[a0_0x543938(0xb5)](a0_0x543938(0xb6),auth,async(_0x24fbfd,_0x431d7e)=>{var _0x2b144f=a0_0x543938;try{const {username:_0x3f89bc,email:_0x4c5960,role:_0x1ee574}=_0x24fbfd[_0x2b144f(0xf0)],_0xc90ab9=_0x24fbfd['user'],_0x302f8a=await profile[_0x2b144f(0x152)]({'email':_0xc90ab9[_0x2b144f(0x90)]}),_0x13b708=await master_shop['find'](),_0x147adc=_0x24fbfd[_0x2b144f(0xd3)]['id'],_0x38770c=await adjustment[_0x2b144f(0x141)]({'_id':_0x147adc}),_0x111950=await purchases[_0x2b144f(0x140)]([{'$match':{'warehouse_name':_0x38770c[_0x2b144f(0x81)]}},{'$unwind':_0x2b144f(0xdb)},{'$group':{'_id':_0x2b144f(0xdd)}}]),_0x515a21=await product[_0x2b144f(0x139)]({}),_0x5a1f98=await warehouse['aggregate']([{'$match':{'name':_0x38770c[_0x2b144f(0x81)]}},{'$unwind':_0x2b144f(0xf8)},{'$group':{'_id':_0x2b144f(0x9e),'name':{'$first':_0x2b144f(0xb8)},'product_stock':{'$first':_0x2b144f(0x101)},'bay':{'$first':_0x2b144f(0x105)},'bin':{'$first':_0x2b144f(0x13f)},'type':{'$first':_0x2b144f(0x11b)},'floorlevel':{'$first':_0x2b144f(0x132)},'primary_code':{'$first':_0x2b144f(0xe8)},'secondary_code':{'$first':_0x2b144f(0xfe)},'product_code':{'$first':_0x2b144f(0x13b)},'storage':{'$first':_0x2b144f(0x8b)},'rack':{'$first':_0x2b144f(0xc9)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x2b144f(0xeb)},'production_date':{'$first':_0x2b144f(0x12f)},'batch_code':{'$first':_0x2b144f(0x94)},'room':{'$first':'$room'}}}]);if(_0x13b708[0x0][_0x2b144f(0x96)]==_0x2b144f(0x14d)){var _0x4afd3b=users[_0x2b144f(0x91)];console[_0x2b144f(0x10a)](_0x4afd3b);}else{if(_0x13b708[0x0][_0x2b144f(0x96)]=='Hindi')var _0x4afd3b=users['Hindi'];else{if(_0x13b708[0x0][_0x2b144f(0x96)]=='German')var _0x4afd3b=users[_0x2b144f(0xc4)];else{if(_0x13b708[0x0]['language']==_0x2b144f(0x11f))var _0x4afd3b=users[_0x2b144f(0x11f)];else{if(_0x13b708[0x0][_0x2b144f(0x96)]==_0x2b144f(0xe1))var _0x4afd3b=users[_0x2b144f(0xe1)];else{if(_0x13b708[0x0][_0x2b144f(0x96)]==_0x2b144f(0xf1))var _0x4afd3b=users[_0x2b144f(0x89)];else{if(_0x13b708[0x0][_0x2b144f(0x96)]==_0x2b144f(0x9d))var _0x4afd3b=users[_0x2b144f(0x9d)];else{if(_0x13b708[0x0][_0x2b144f(0x96)]=='Arabic\x20(ae)')var _0x4afd3b=users[_0x2b144f(0xa1)];}}}}}}}_0x431d7e[_0x2b144f(0xe0)](_0x2b144f(0xc2),{'success':_0x24fbfd[_0x2b144f(0x99)](_0x2b144f(0xf3)),'errors':_0x24fbfd[_0x2b144f(0x99)](_0x2b144f(0xde)),'role':_0xc90ab9,'profile':_0x302f8a,'adjustment':_0x38770c,'stock':_0x5a1f98,'master_shop':_0x13b708,'warehouse_name':_0x111950,'unit':_0x515a21,'language':_0x4afd3b});}catch(_0x561c4f){console[_0x2b144f(0x10a)](_0x561c4f),_0x431d7e[_0x2b144f(0x10f)](0xc8)[_0x2b144f(0xa7)]({'message':_0x561c4f[_0x2b144f(0x13d)]});}}),router['post']('/preview/:id',auth,async(_0x4eaa70,_0x1e2738)=>{var _0x40f428=a0_0x543938;try{const _0x403b91=_0x4eaa70['params']['id'],{warehouse_name:_0x4b7d79,Room_name:_0x444f15}=_0x4eaa70[_0x40f428(0xea)],_0x197cb0=await adjustment['findById']({'_id':_0x403b91}),_0x1f8747=_0x197cb0[_0x40f428(0xa3)][_0x40f428(0x86)](async _0x3ce4d4=>{var _0x40fe8d=_0x40f428;if(_0x3ce4d4[_0x40fe8d(0x103)]>0x0){var _0x10ef8e=await warehouse['findOne']({'name':_0x4b7d79,'room':_0x3ce4d4[_0x40fe8d(0x12e)],'warehouse_category':_0x40fe8d(0x130)});const _0x12a301=_0x10ef8e[_0x40fe8d(0xbb)]['map'](_0xf45ecb=>{var _0xff51cb=_0x40fe8d;if(_0x3ce4d4['type']==_0xff51cb(0xca)){if(_0xf45ecb['product_name']==_0x3ce4d4['product_name']&&_0xf45ecb[_0xff51cb(0x10c)]==_0x3ce4d4[_0xff51cb(0x10c)]&&_0xf45ecb['type']==_0x3ce4d4[_0xff51cb(0x100)]&&_0xf45ecb[_0xff51cb(0x117)]==_0x3ce4d4[_0xff51cb(0x117)]&&_0xf45ecb[_0xff51cb(0xdf)]==_0x3ce4d4[_0xff51cb(0xdf)]&&_0xf45ecb[_0xff51cb(0x125)]==_0x3ce4d4['rack']&&_0xf45ecb['storage']==_0x3ce4d4['storage']&&_0xf45ecb[_0xff51cb(0x149)]==_0x3ce4d4[_0xff51cb(0x149)]&&_0xf45ecb[_0xff51cb(0x113)]==_0x3ce4d4['batch_code']&&_0xf45ecb[_0xff51cb(0x137)]==_0x3ce4d4[_0xff51cb(0x137)]&&_0xf45ecb[_0xff51cb(0x120)]==_0x3ce4d4[_0xff51cb(0x120)]){var _0x100594;_0x100594=_0x3ce4d4[_0xff51cb(0x103)],_0x3ce4d4[_0xff51cb(0x14b)]=='S'&&(_0x100594=_0x3ce4d4['adjust_qty']),_0xf45ecb[_0xff51cb(0x110)]=_0xf45ecb[_0xff51cb(0x110)]-_0x100594;}}else{if(_0xf45ecb[_0xff51cb(0x93)]==_0x3ce4d4[_0xff51cb(0x93)]&&_0xf45ecb[_0xff51cb(0x10c)]==_0x3ce4d4[_0xff51cb(0x10c)]&&_0xf45ecb[_0xff51cb(0x100)]==_0x3ce4d4[_0xff51cb(0x100)]&&_0xf45ecb[_0xff51cb(0x117)]==_0x3ce4d4[_0xff51cb(0x117)]&&_0xf45ecb[_0xff51cb(0xdf)]==_0x3ce4d4['bay']&&_0xf45ecb[_0xff51cb(0x125)]==_0x3ce4d4[_0xff51cb(0x125)]&&_0xf45ecb[_0xff51cb(0xab)]==_0x3ce4d4[_0xff51cb(0xab)]&&_0xf45ecb[_0xff51cb(0x149)]==_0x3ce4d4['expiry_date']&&_0xf45ecb[_0xff51cb(0x113)]==_0x3ce4d4[_0xff51cb(0x113)]&&_0xf45ecb[_0xff51cb(0x137)]==_0x3ce4d4[_0xff51cb(0x137)]&&_0xf45ecb[_0xff51cb(0x120)]==_0x3ce4d4[_0xff51cb(0x120)]){console[_0xff51cb(0x10a)](_0x3ce4d4);var _0x100594;_0x100594=_0x3ce4d4[_0xff51cb(0x103)],_0x3ce4d4[_0xff51cb(0x14b)]=='S'&&(_0x100594=_0x3ce4d4[_0xff51cb(0x103)]),console[_0xff51cb(0x10a)](_0x100594+_0xff51cb(0xbc)+_0x3ce4d4[_0xff51cb(0x103)]+_0xff51cb(0xbc)+_0xf45ecb[_0xff51cb(0x8d)]+_0xff51cb(0xbc)+_0x3ce4d4[_0xff51cb(0x14b)]),_0xf45ecb[_0xff51cb(0x110)]=_0xf45ecb['product_stock']+_0x100594;}}});}return _0x10ef8e;});Promise[_0x40f428(0x11e)](_0x1f8747)['then'](async _0x1ad84a=>{var _0x335c5e=_0x40f428;try{for(const _0x2eed60 of _0x1ad84a){await _0x2eed60[_0x335c5e(0x14f)]();}_0x197cb0['finalize']='True';const _0x16c82e=await _0x197cb0[_0x335c5e(0x14f)](),_0x49a4bf=await master_shop[_0x335c5e(0x139)](),_0x5858e3=await email_settings['findOne'](),_0x2ed6cd=await supervisor_settings['find']();var _0x266643=_0x197cb0[_0x335c5e(0xa3)],_0x5c1dae='',_0x2d459c;for(_0x2d459c in _0x266643){_0x5c1dae+=_0x335c5e(0x114)+_0x335c5e(0x11a)+_0x266643[_0x2d459c][_0x335c5e(0x93)]+_0x335c5e(0xa9)+_0x335c5e(0x11a)+_0x266643[_0x2d459c]['product_code']+_0x335c5e(0xa9)+_0x335c5e(0x11a)+_0x266643[_0x2d459c][_0x335c5e(0x103)]+_0x335c5e(0xa9)+_0x335c5e(0x11a)+_0x266643[_0x2d459c][_0x335c5e(0xb4)]+_0x335c5e(0xa9)+_0x335c5e(0x11a)+_0x266643[_0x2d459c][_0x335c5e(0xe9)]+'</td>'+_0x335c5e(0x11a)+_0x197cb0[_0x335c5e(0x81)]+'</td>'+_0x335c5e(0x11a)+_0x266643[_0x2d459c][_0x335c5e(0x12e)]+_0x335c5e(0xa9)+_0x335c5e(0x11a)+_0x266643[_0x2d459c]['storage']+_0x266643[_0x2d459c]['rack']+_0x266643[_0x2d459c]['bay']+_0x266643[_0x2d459c]['bin']+_0x266643[_0x2d459c][_0x335c5e(0x100)][0x0]+_0x266643[_0x2d459c]['floorlevel']+_0x335c5e(0xa9),_0x335c5e(0x111);}let _0x3c0907=nodemailer[_0x335c5e(0x124)]({'host':_0x5858e3[_0x335c5e(0xb9)],'port':Number(_0x5858e3[_0x335c5e(0x142)]),'secure':![],'auth':{'user':_0x5858e3[_0x335c5e(0x90)],'pass':_0x5858e3[_0x335c5e(0xa6)]}}),_0xf3a3a6={'from':_0x5858e3[_0x335c5e(0x90)],'to':_0x2ed6cd[0x0]['RMSEmail'],'subject':_0x335c5e(0x121),'attachments':[{'filename':_0x335c5e(0x154),'path':__dirname+_0x335c5e(0x145)+_0x335c5e(0x8f)+_0x49a4bf[0x0][_0x335c5e(0xfc)],'cid':_0x335c5e(0xb2)}],'html':_0x335c5e(0x122)+'<html><head><title></title>'+_0x335c5e(0x8c)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x335c5e(0xc7)+_0x335c5e(0x129)+_0x335c5e(0x12a)+_0x335c5e(0xaf)+_0x49a4bf[0x0]['site_title']+_0x335c5e(0x92)+_0x335c5e(0x129)+_0x335c5e(0x129)+_0x335c5e(0xb1)+_0x335c5e(0x12a)+_0x335c5e(0x95)+'\x20Order\x20Number\x20:\x20'+_0x197cb0[_0x335c5e(0x120)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x335c5e(0x82)+_0x197cb0[_0x335c5e(0xb7)]+'\x20'+_0x335c5e(0xcb)+_0x335c5e(0x8a)+_0x335c5e(0x129)+_0x335c5e(0x107)+_0x335c5e(0x147)+_0x335c5e(0x114)+_0x335c5e(0x9b)+_0x335c5e(0x14c)+_0x335c5e(0x135)+_0x335c5e(0x115)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x335c5e(0xcd)+_0x335c5e(0x108)+_0x335c5e(0x116)+_0x335c5e(0x111)+'</thead>'+_0x335c5e(0x98)+'\x20'+_0x5c1dae+'\x20'+'</tbody>'+'</table>'+_0x335c5e(0x12a)+'<strong>\x20Regards\x20</strong>'+_0x335c5e(0x11c)+_0x49a4bf[0x0][_0x335c5e(0xe4)]+_0x335c5e(0x8a)+'</div>'+_0x335c5e(0x129)+_0x335c5e(0x123)};_0x3c0907['sendMail'](_0xf3a3a6,function(_0x48c7be,_0xd99482){var _0x54db18=_0x335c5e;_0x48c7be?(console[_0x54db18(0x10a)](_0x48c7be),console[_0x54db18(0x10a)](_0x54db18(0x133))):console[_0x54db18(0x10a)](_0x54db18(0x104));}),_0x4eaa70['flash']('success',_0x335c5e(0x118)),_0x1e2738[_0x335c5e(0xd6)](_0x335c5e(0x156)+_0x16c82e[_0x335c5e(0xf5)]);}catch(_0x41c944){console[_0x335c5e(0xac)](_0x41c944),_0x1e2738[_0x335c5e(0x10f)](0x1f4)[_0x335c5e(0xa7)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x40f428(0xfb)](_0xdc1a9d=>{var _0x18a710=_0x40f428;console[_0x18a710(0xac)](_0xdc1a9d),_0x1e2738['status'](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x2c6eae){console['log'](_0x2c6eae),_0x1e2738[_0x40f428(0x10f)](0xc8)[_0x40f428(0xa7)]({'message':_0x2c6eae[_0x40f428(0x13d)]});}}),router['get']('/view/:id',auth,async(_0x2bfde3,_0x3642e0)=>{var _0x1b2dd1=a0_0x543938;try{const {username:_0x413625,email:_0x5ca12a,role:_0x852e39}=_0x2bfde3[_0x1b2dd1(0xf0)],_0x569b4b=_0x2bfde3[_0x1b2dd1(0xf0)],_0x3f8a99=await profile['findOne']({'email':_0x569b4b[_0x1b2dd1(0x90)]}),_0x1e009a=await master_shop[_0x1b2dd1(0x139)](),_0x5e6cdc=_0x2bfde3[_0x1b2dd1(0xd3)]['id'],_0x4a0a32=await adjustment[_0x1b2dd1(0x141)]({'_id':_0x5e6cdc}),_0x299162=await purchases[_0x1b2dd1(0x140)]([{'$match':{'warehouse_name':_0x4a0a32[_0x1b2dd1(0x81)]}},{'$unwind':'$product'},{'$group':{'_id':_0x1b2dd1(0xdd)}}]),_0x379b22=await product['find']({}),_0x1b7aba=await warehouse[_0x1b2dd1(0x140)]([{'$match':{'name':_0x4a0a32[_0x1b2dd1(0x81)]}},{'$unwind':_0x1b2dd1(0xf8)},{'$group':{'_id':_0x1b2dd1(0x9e),'name':{'$first':_0x1b2dd1(0xb8)},'product_stock':{'$first':_0x1b2dd1(0x101)},'bay':{'$first':_0x1b2dd1(0x105)},'bin':{'$first':_0x1b2dd1(0x13f)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1b2dd1(0x132)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1b2dd1(0xfe)},'product_code':{'$first':_0x1b2dd1(0x13b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1b2dd1(0xc9)},'maxPerUnit':{'$first':_0x1b2dd1(0x8e)},'expiry_date':{'$first':_0x1b2dd1(0xeb)},'production_date':{'$first':_0x1b2dd1(0x12f)},'batch_code':{'$first':_0x1b2dd1(0x94)},'room':{'$first':_0x1b2dd1(0xaa)}}}]);let _0x408a0a;if(_0x569b4b[_0x1b2dd1(0xd8)]=='staff'){const _0x3c8062=await staff[_0x1b2dd1(0x152)]({'email':_0x569b4b['email']});_0x408a0a=await warehouse[_0x1b2dd1(0x140)]([{'$match':{'status':'Enabled','name':_0x3c8062[_0x1b2dd1(0xbf)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x1b2dd1(0xb3)}}},{'$group':{'_id':'$name','name':{'$first':_0x1b2dd1(0x126)}}}]);}else _0x408a0a=await warehouse[_0x1b2dd1(0x140)]([{'$match':{'status':_0x1b2dd1(0x13c),'warehouse_category':_0x1b2dd1(0x130),'name':{'$ne':_0x1b2dd1(0xb3)}}},{'$group':{'_id':_0x1b2dd1(0x126),'name':{'$first':_0x1b2dd1(0x126)}}}]);if(_0x1e009a[0x0][_0x1b2dd1(0x96)]=='English\x20(US)'){var _0x40fa5a=users[_0x1b2dd1(0x91)];console['log'](_0x40fa5a);}else{if(_0x1e009a[0x0][_0x1b2dd1(0x96)]=='Hindi')var _0x40fa5a=users[_0x1b2dd1(0xa4)];else{if(_0x1e009a[0x0]['language']=='German')var _0x40fa5a=users[_0x1b2dd1(0xc4)];else{if(_0x1e009a[0x0][_0x1b2dd1(0x96)]==_0x1b2dd1(0x11f))var _0x40fa5a=users[_0x1b2dd1(0x11f)];else{if(_0x1e009a[0x0][_0x1b2dd1(0x96)]==_0x1b2dd1(0xe1))var _0x40fa5a=users[_0x1b2dd1(0xe1)];else{if(_0x1e009a[0x0][_0x1b2dd1(0x96)]==_0x1b2dd1(0xf1))var _0x40fa5a=users[_0x1b2dd1(0x89)];else{if(_0x1e009a[0x0][_0x1b2dd1(0x96)]==_0x1b2dd1(0x9d))var _0x40fa5a=users[_0x1b2dd1(0x9d)];else{if(_0x1e009a[0x0]['language']==_0x1b2dd1(0x14e))var _0x40fa5a=users['Arabic'];}}}}}}}_0x3642e0[_0x1b2dd1(0xe0)](_0x1b2dd1(0xfa),{'success':_0x2bfde3[_0x1b2dd1(0x99)](_0x1b2dd1(0xf3)),'errors':_0x2bfde3['flash'](_0x1b2dd1(0xde)),'role':_0x569b4b,'profile':_0x3f8a99,'adjustment':_0x4a0a32,'stock':_0x1b7aba,'master_shop':_0x1e009a,'warehouse_name':_0x299162,'unit':_0x379b22,'language':_0x40fa5a,'warehouse':_0x408a0a});}catch(_0x2d10a2){console[_0x1b2dd1(0x10a)](_0x2d10a2),_0x3642e0[_0x1b2dd1(0x10f)](0xc8)[_0x1b2dd1(0xa7)]({'message':_0x2d10a2[_0x1b2dd1(0x13d)]});}}),router[a0_0x543938(0x12d)](a0_0x543938(0xb0),auth,async(_0x12c5d8,_0x404556)=>{var _0x1f91d4=a0_0x543938;try{const _0x4b59c0=_0x12c5d8[_0x1f91d4(0xd3)]['id'],_0x563665=await adjustment[_0x1f91d4(0x141)]({'_id':_0x4b59c0}),_0x4a17dd=await warehouse[_0x1f91d4(0x152)]({'name':_0x563665[_0x1f91d4(0x81)],'room':_0x563665[_0x1f91d4(0xf2)]}),{warehouse_name:_0x3f597f,date:_0x3d075b,prod_name:_0x655ee4,level:_0x3e3d81,isle:_0x497ca6,pallet:_0x5ec68b,stock:_0x1ca721,types:_0x453a64,adjust_qty:_0x20d8fc,new_adjust_qty:_0x94a562,note:_0x1606ec,Room_name:_0x1bffd2,invoice:_0x13624,JO_number:_0x5034f7,expiry_date:_0x47a1e0}=_0x12c5d8['body'];if(typeof _0x655ee4==_0x1f91d4(0xd7))var _0x246885=[_0x12c5d8['body'][_0x1f91d4(0xf7)]],_0x244185=[_0x12c5d8['body'][_0x1f91d4(0xdc)]],_0x25f0ee=[_0x12c5d8['body']['stock']],_0x5cb0e3=[_0x12c5d8[_0x1f91d4(0xea)]['types']],_0x41b487=[_0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x14a)]],_0x548cd7=[_0x12c5d8[_0x1f91d4(0xea)]['New_Qty_Converted']],_0x31865f=[_0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x13e)]],_0x1eacbc=[_0x12c5d8['body'][_0x1f91d4(0x10d)]],_0x224f33=[_0x12c5d8['body'][_0x1f91d4(0x97)]],_0x4ca722=[_0x12c5d8['body']['batch_code']],_0x51b8a6=[_0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x149)]],_0x5a43b3=[_0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0xd0)]],_0x7dc3c2=[_0x12c5d8[_0x1f91d4(0xea)]['production_date']],_0x5964bd=[_0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x14b)]],_0x3a1833=[_0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0xa0)]],_0x5d7c58=[_0x12c5d8[_0x1f91d4(0xea)]['prime1']],_0x4d2a4c=[_0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0xc5)]];else var _0x246885=[..._0x12c5d8['body'][_0x1f91d4(0xf7)]],_0x244185=[..._0x12c5d8['body'][_0x1f91d4(0xdc)]],_0x25f0ee=[..._0x12c5d8[_0x1f91d4(0xea)]['stock']],_0x5cb0e3=[..._0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x134)]],_0x41b487=[..._0x12c5d8[_0x1f91d4(0xea)]['New_Qty_Converted_adj']],_0x548cd7=[..._0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0xa2)]],_0x31865f=[..._0x12c5d8['body']['unit']],_0x1eacbc=[..._0x12c5d8['body'][_0x1f91d4(0x10d)]],_0x224f33=[..._0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x97)]],_0x4ca722=[..._0x12c5d8['body']['batch_code']],_0x51b8a6=[..._0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x149)]],_0x5a43b3=[..._0x12c5d8['body'][_0x1f91d4(0xd0)]],_0x7dc3c2=[..._0x12c5d8[_0x1f91d4(0xea)]['production_date']],_0x5964bd=[..._0x12c5d8[_0x1f91d4(0xea)]['prod_cat']],_0x3a1833=[..._0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0xa0)]],_0x5d7c58=[..._0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0x9a)]],_0x4d2a4c=[..._0x12c5d8[_0x1f91d4(0xea)][_0x1f91d4(0xc5)]];const _0x3f648c=_0x246885[_0x1f91d4(0x86)](_0xdf8a87=>{return _0xdf8a87={'product_name':_0xdf8a87};});_0x244185[_0x1f91d4(0x109)]((_0x13682c,_0x1e953f)=>{var _0x2f4d53=_0x1f91d4;_0x3a1833[_0x2f4d53(0x109)]((_0x29a186,_0x1c997e)=>{var _0x40826a=_0x2f4d53;if(_0x29a186==_0x40826a(0x7d)&&_0x1e953f==_0x1c997e){var _0x406d9a=_0x13682c['slice'](0x3);_0x3f648c[_0x1e953f][_0x40826a(0xab)]=_0x13682c[0x0],_0x3f648c[_0x1e953f][_0x40826a(0x125)]=_0x13682c[0x1],_0x3f648c[_0x1e953f][_0x40826a(0xdf)]=0x0,_0x3f648c[_0x1e953f][_0x40826a(0x117)]=0x0,_0x3f648c[_0x1e953f][_0x40826a(0x100)]='Floor',_0x3f648c[_0x1e953f][_0x40826a(0x10c)]=_0x406d9a;}else{if(_0x29a186==_0x40826a(0x151)&&_0x1e953f==_0x1c997e){var _0x406d9a=_0x13682c['slice'](0x3);_0x3f648c[_0x1e953f][_0x40826a(0xab)]=_0x13682c[0x0],_0x3f648c[_0x1e953f][_0x40826a(0x125)]=_0x13682c[0x1],_0x3f648c[_0x1e953f][_0x40826a(0xdf)]=0x0,_0x3f648c[_0x1e953f][_0x40826a(0x117)]=0x0,_0x3f648c[_0x1e953f]['type']=_0x40826a(0xf4),_0x3f648c[_0x1e953f][_0x40826a(0x10c)]=_0x13682c[0x5];}else{if(_0x1e953f==_0x1c997e){var _0x160791;if(_0x13682c[0x4]=='L')_0x160791='Level';else _0x13682c[0x4]=='F'&&(_0x160791=_0x40826a(0xf4));_0x3f648c[_0x1e953f][_0x40826a(0xab)]=_0x13682c[0x0],_0x3f648c[_0x1e953f][_0x40826a(0x125)]=_0x13682c[0x1],_0x3f648c[_0x1e953f][_0x40826a(0xdf)]=_0x13682c[0x2],_0x3f648c[_0x1e953f][_0x40826a(0x117)]=_0x13682c[0x3],_0x3f648c[_0x1e953f]['type']=_0x160791,_0x3f648c[_0x1e953f][_0x40826a(0x10c)]=_0x13682c[0x5];}}}});}),_0x25f0ee[_0x1f91d4(0x109)]((_0x270f58,_0x177e54)=>{var _0x1daaad=_0x1f91d4;_0x3f648c[_0x177e54][_0x1daaad(0x119)]=_0x270f58;}),_0x5cb0e3[_0x1f91d4(0x109)]((_0x33ce6b,_0x1a04d1)=>{var _0x1a0b92=_0x1f91d4;_0x3f648c[_0x1a04d1][_0x1a0b92(0x134)]=_0x33ce6b;}),_0x41b487[_0x1f91d4(0x109)]((_0x4c3d77,_0x5a9360)=>{_0x3f648c[_0x5a9360]['adjust_qty']=_0x4c3d77;}),_0x548cd7[_0x1f91d4(0x109)]((_0x11f05e,_0x2ebd3b)=>{var _0x32a32b=_0x1f91d4;_0x3f648c[_0x2ebd3b][_0x32a32b(0x10b)]=_0x11f05e;}),_0x31865f['forEach']((_0x19f104,_0x2a45ba)=>{_0x3f648c[_0x2a45ba]['unit']=_0x19f104;}),_0x1eacbc[_0x1f91d4(0x109)]((_0x3b1236,_0x34bc1f)=>{var _0x1462b1=_0x1f91d4;_0x3f648c[_0x34bc1f][_0x1462b1(0xe9)]=_0x3b1236;}),_0x224f33[_0x1f91d4(0x109)]((_0x557b39,_0xe2608)=>{_0x3f648c[_0xe2608]['product_code']=_0x557b39;}),_0x4ca722[_0x1f91d4(0x109)]((_0x1ba705,_0x26876d)=>{var _0x2116d7=_0x1f91d4;_0x3f648c[_0x26876d][_0x2116d7(0x113)]=_0x1ba705;}),_0x51b8a6['forEach']((_0x24b9da,_0x4c1a59)=>{_0x3f648c[_0x4c1a59]['expiry_date']=_0x24b9da;}),_0x5a43b3['forEach']((_0x67c87e,_0x4bf063)=>{var _0x453357=_0x1f91d4;_0x3f648c[_0x4bf063][_0x453357(0x83)]=_0x67c87e;}),_0x7dc3c2[_0x1f91d4(0x109)]((_0x5296e9,_0x5ed7b8)=>{var _0x49ad17=_0x1f91d4;_0x3f648c[_0x5ed7b8][_0x49ad17(0x137)]=_0x5296e9;}),_0x5964bd[_0x1f91d4(0x109)]((_0x3455d5,_0x40150b)=>{_0x3f648c[_0x40150b]['prod_cat']=_0x3455d5;}),_0x3a1833[_0x1f91d4(0x109)]((_0x227506,_0x31c0ec)=>{_0x3f648c[_0x31c0ec]['room_names']=_0x227506;}),_0x5d7c58[_0x1f91d4(0x109)]((_0xdce2fb,_0x436a20)=>{var _0x590638=_0x1f91d4;_0x3f648c[_0x436a20][_0x590638(0xad)]=_0xdce2fb;}),_0x4d2a4c['forEach']((_0x4d685e,_0x46df89)=>{_0x3f648c[_0x46df89]['secondary_code']=_0x4d685e;});const _0x5dd69f=_0x3f648c[_0x1f91d4(0xfd)](_0x22a58b=>_0x22a58b['adjust_qty']!=='0'&&_0x22a58b[_0x1f91d4(0x103)]!=='');var _0x4241e3=0x0;_0x5dd69f[_0x1f91d4(0x109)](_0x4d2cb2=>{var _0x361144=_0x1f91d4;console[_0x361144(0x10a)](_0x361144(0x146),_0x4d2cb2),parseInt(_0x4d2cb2['adjust_qty'])<=0x0&&_0x4241e3++;});if(_0x4241e3!=0x0)return _0x12c5d8[_0x1f91d4(0x99)](_0x1f91d4(0xde),_0x1f91d4(0xae)),_0x404556[_0x1f91d4(0xd6)](_0x1f91d4(0x9c));_0x563665[_0x1f91d4(0x81)]=_0x3f597f,_0x563665[_0x1f91d4(0xb7)]=_0x3d075b,_0x563665[_0x1f91d4(0xa3)]=_0x5dd69f,_0x563665['note']=_0x1606ec,_0x563665[_0x1f91d4(0x120)]=_0x13624,_0x563665[_0x1f91d4(0x80)]=_0x1f91d4(0xba);const _0x505104=await _0x563665[_0x1f91d4(0x14f)]();_0x12c5d8[_0x1f91d4(0x99)]('success',_0x1f91d4(0xc0)),_0x404556[_0x1f91d4(0xd6)](_0x1f91d4(0x155));}catch(_0x1241af){console[_0x1f91d4(0x10a)](_0x1241af);}}),router['post'](a0_0x543938(0x11d),async(_0x1d154b,_0xa70fed)=>{var _0x234533=a0_0x543938;const {primary_code:_0x19a7d0,warehouse_data:_0x344c58,rooms_data:_0x26012f,Roomslist:_0x589b89}=_0x1d154b[_0x234533(0xea)],_0xbd0513=_0x589b89[_0x234533(0x127)](','),_0x59161a=[];async function _0x2182ad(_0x504258){var _0x38036d=_0x234533;const _0x5cd287=await warehouse[_0x38036d(0x140)]([{'$match':{'name':_0x344c58,'room':_0x504258}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x19a7d0}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x38036d(0xe8)},'secondary_code':{'$first':_0x38036d(0xfe)},'product_code':{'$first':_0x38036d(0x13b)},'level':{'$first':_0x38036d(0x105)},'isle':{'$first':_0x38036d(0x13f)},'type':{'$first':_0x38036d(0x11b)},'pallet':{'$first':_0x38036d(0x132)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x38036d(0xce)},'storage':{'$first':_0x38036d(0x8b)},'rack':{'$first':_0x38036d(0xc9)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x38036d(0x12f)},'maxPerUnit':{'$first':_0x38036d(0x8e)},'batch_code':{'$first':_0x38036d(0x94)},'product_cat':{'$first':_0x38036d(0x13a)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x38036d(0xaa)}}}]),_0x195fed=await warehouse['aggregate']([{'$match':{'name':_0x344c58,'room':_0x504258}},{'$unwind':_0x38036d(0xf8)},{'$match':{'product_details.secondary_code':_0x19a7d0}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x38036d(0xe8)},'secondary_code':{'$first':_0x38036d(0xfe)},'product_code':{'$first':_0x38036d(0x13b)},'level':{'$first':_0x38036d(0x105)},'isle':{'$first':_0x38036d(0x13f)},'type':{'$first':_0x38036d(0x11b)},'pallet':{'$first':_0x38036d(0x132)},'unit':{'$first':_0x38036d(0xf6)},'secondary_unit':{'$first':_0x38036d(0xce)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x38036d(0xc9)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x38036d(0x12f)},'maxPerUnit':{'$first':_0x38036d(0x8e)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x38036d(0x13a)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x38036d(0xaa)}}}]);if(_0x5cd287[_0x38036d(0xd2)]>0x0)_0x59161a[_0x38036d(0xe6)](_0x5cd287);else _0x195fed[_0x38036d(0xd2)]>0x0&&_0x59161a[_0x38036d(0xe6)](_0x195fed);}const _0x335b09=_0xbd0513[_0x234533(0x86)](_0x4e66a6=>_0x2182ad(_0x4e66a6));await Promise[_0x234533(0x11e)](_0x335b09),_0xa70fed[_0x234533(0xa7)](_0x59161a);}),router['post'](a0_0x543938(0xec),async(_0x864b8f,_0x50dd93)=>{var _0x30ef85=a0_0x543938;const {primaryCode:_0x523986,secondaryCode:_0x2648bd,productCode:_0x41db16,level:_0x1d6edc,isle:_0x41a4ff,pallet:_0x28f7db,warehouses:_0x26d6c4,room:_0x1cca3f}=_0x864b8f['body'];try{const _0x4529de=await warehouse[_0x30ef85(0x140)]([{'$match':{'name':_0x26d6c4,'room':_0x1cca3f}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x1d6edc),'product_details.isle':_0x41a4ff,'product_details.pallet':parseInt(_0x28f7db)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x30ef85(0xb8)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x30ef85(0xd5)},'isle':{'$first':_0x30ef85(0x106)},'pallet':{'$first':_0x30ef85(0xe5)},'maxProducts':{'$first':_0x30ef85(0x102)}}}]);_0x50dd93[_0x30ef85(0x10f)](0xc8)[_0x30ef85(0xa7)](_0x4529de);}catch(_0x4d6a8b){_0x50dd93[_0x30ef85(0x10f)](0x194)[_0x30ef85(0xa7)]({'message':_0x4d6a8b[_0x30ef85(0x13d)]});}}),module[a0_0x543938(0xed)]=router;