function a0_0x9c5e(){var _0x2c13e6=['mongoose','$name','$finalize','production_date','\x20</h2>','4348QLveSc','id_transaction','render','</tr>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','French','json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','adjustment\x20add\x20successfull','product_stock','Portuguese\x20(BR)','bin','all','email','10910RbswJq','$product_details.isle','$product_details.maxPerUnit','Hindi','batch_code','Primary_Units','forEach','site_title','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product.product_name','<h5>','message','$product_details','$product_details.bin','warehouse_name','$room','floorlevel','\x20<>\x20','New_Qty_Converted_adj','346158GomBxJ','language','Router','product','$product_details.floorlevel','body','/adjustment/preview/','finalize','ObjectId','</table>','back','aggregate','$product_details.storage','$product_details.primary_code','Level','</span>','<h5\x20style=\x22text-align:\x20left;\x22>','</div>','</body></html>','Arabic\x20(ae)','invoice','$product_details.product_cat','Floor','second1','/view/:id','$product_details.type','id_transaction_from','errors','Chinese','$date','$product_details.product_stock','$warehouse_name','/../public','../models/all_models','params','</td>','False','note','Logo.png','warehouse','adjustment\x20data\x20update\x20successfully','rack','maxperunit','$product_details.rack','edit_adjustment_view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','English\x20(US)','/view/add_adjustment','adjustment','24dVoYQR','flash','$product_details.level','<span\x20style=\x22float:\x20right;\x22>','/view','isAllowEdit','staff','$product_details.product_name','Portuguese','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Return\x20Goods','3879081ubLsCE','<strong>\x20Regards\x20</strong>','Email\x20sent\x20successfully','$product_details.bay','Raw\x20Materials','2965jqrawZ','type','bay','prime1','get','$product_details.production_date','1395296CrDzZJ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<tbody\x20style=\x22text-align:\x20center;\x22>','/CheckingWarehouse','minus','filter','</thead>','$product_details.maxProducts','prod_invoice','<tr>','$product_details.expiry_date','status','user','logo','prod_code','findById','Adjustment\x20Mail','max_per_unit','createTransport','product_details','/upload/','German','$product.room_names','primary_code','ADJ-','$product_details.unit','redirect','/barcode_scanner','adjustment\x20Finalized\x20successfully','$product_details.secondary_code','Enabled','English','post','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','push','<!DOCTYPE\x20html>','Arabic','Enclosed','Receiving\x20Area','slice','expiry_date','secondary_code','Secondary_units','\x20Order\x20Date\x20:\x20','role','new_adjust_qty','Ambient','map','catch','unit','adjust_qty','stock','product_code','valueOf','1657948Pmyhwg','prod_cat','Rooms','833180IheNqE','level','save','25993hUGLlu','product_name','find','$product_details.secondary_unit','nodemailer','/adjustment/view','then','length','Shelves','New_Qty_Converted','add_adjustment','$product_details.pallet','storage','/preview/:id','$product','success','date','Spanish','$product_details.invoice','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','host','room_names','<div>','$product_details._id','image','</tbody>','log','updateOne','24LfAqdO','_id','types','findOne','foreach\x20newproduct','</h5>','secondary_unit','$product_details.batch_code','prod_name','sendMail'];a0_0x9c5e=function(){return _0x2c13e6;};return a0_0x9c5e();}var a0_0x33e10e=a0_0x4d79;(function(_0x3ea231,_0x20a349){var _0xdabf2=a0_0x4d79,_0x4435dc=_0x3ea231();while(!![]){try{var _0x24ea10=-parseInt(_0xdabf2(0x8d))/0x1+-parseInt(_0xdabf2(0x8a))/0x2+-parseInt(_0xdabf2(0xde))/0x3+-parseInt(_0xdabf2(0xbd))/0x4*(-parseInt(_0xdabf2(0x11f))/0x5)+-parseInt(_0xdabf2(0xae))/0x6*(-parseInt(_0xdabf2(0x125))/0x7)+-parseInt(_0xdabf2(0x10f))/0x8*(parseInt(_0xdabf2(0x11a))/0x9)+-parseInt(_0xdabf2(0xcb))/0xa*(-parseInt(_0xdabf2(0x90))/0xb);if(_0x24ea10===_0x20a349)break;else _0x4435dc['push'](_0x4435dc['shift']());}catch(_0x2897fe){_0x4435dc['push'](_0x4435dc['shift']());}}}(a0_0x9c5e,0xe7c79));const express=require('express'),app=express(),router=express[a0_0x33e10e(0xe0)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x33e10e(0xff)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x33e10e(0x94)),mongoose=require(a0_0x33e10e(0xb8));router[a0_0x33e10e(0x123)](a0_0x33e10e(0x113),auth,async(_0x91c5f7,_0x345434)=>{var _0x3007c9=a0_0x33e10e;try{const {username:_0x3dd98c,email:_0x1f904d,role:_0x3d0ec4}=_0x91c5f7[_0x3007c9(0x132)],_0x5037b9=_0x91c5f7[_0x3007c9(0x132)],_0x40318f=await profile[_0x3007c9(0xb1)]({'email':_0x5037b9[_0x3007c9(0xca)]}),_0x347208=await master_shop[_0x3007c9(0x92)]();console['log']('master',_0x347208);let _0x57f78f;if(_0x5037b9['role']==_0x3007c9(0x115)){const _0x42c18d=await staff[_0x3007c9(0xb1)]({'email':_0x5037b9[_0x3007c9(0xca)]});_0x57f78f=await warehouse[_0x3007c9(0x92)]({'status':_0x3007c9(0x144),'name':_0x42c18d[_0x3007c9(0x105)]});}else _0x57f78f=await warehouse[_0x3007c9(0x92)]({'status':'Enabled'});const _0x39058f=await product[_0x3007c9(0x92)]();let _0x14373d;if(_0x5037b9[_0x3007c9(0x80)]==_0x3007c9(0x115)){const _0x4e53b5=await staff[_0x3007c9(0xb1)]({'email':_0x5037b9['email']});_0x14373d=await adjustment[_0x3007c9(0x92)]({'warehouse_name':_0x4e53b5[_0x3007c9(0x105)]});}else _0x14373d=await adjustment[_0x3007c9(0xe9)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x3007c9(0xfb)},'warehouse_name':{'$first':_0x3007c9(0xfd)},'room':{'$addToSet':_0x3007c9(0x13c)},'finalize':{'$first':_0x3007c9(0xba)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x347208[0x0][_0x3007c9(0xdf)]==_0x3007c9(0x10c)){var _0x518d1c=users[_0x3007c9(0x145)];console[_0x3007c9(0xac)](_0x518d1c);}else{if(_0x347208[0x0]['language']=='Hindi')var _0x518d1c=users[_0x3007c9(0xce)];else{if(_0x347208[0x0]['language']==_0x3007c9(0x13b))var _0x518d1c=users[_0x3007c9(0x13b)];else{if(_0x347208[0x0][_0x3007c9(0xdf)]==_0x3007c9(0xa1))var _0x518d1c=users[_0x3007c9(0xa1)];else{if(_0x347208[0x0][_0x3007c9(0xdf)]==_0x3007c9(0xc2))var _0x518d1c=users['French'];else{if(_0x347208[0x0][_0x3007c9(0xdf)]=='Portuguese\x20(BR)')var _0x518d1c=users[_0x3007c9(0x117)];else{if(_0x347208[0x0][_0x3007c9(0xdf)]==_0x3007c9(0xfa))var _0x518d1c=users['Chinese'];else{if(_0x347208[0x0][_0x3007c9(0xdf)]==_0x3007c9(0xf1))var _0x518d1c=users[_0x3007c9(0x78)];}}}}}}}_0x345434[_0x3007c9(0xbf)](_0x3007c9(0x10e),{'success':_0x91c5f7[_0x3007c9(0x110)](_0x3007c9(0x9f)),'errors':_0x91c5f7[_0x3007c9(0x110)](_0x3007c9(0xf9)),'role':_0x5037b9,'profile':_0x40318f,'warehouse':_0x57f78f,'product':_0x39058f,'adjustment':_0x14373d,'master_shop':_0x347208,'language':_0x518d1c});}catch(_0x587df7){console[_0x3007c9(0xac)](_0x587df7);}});async function getRandom8DigitNumber(){var _0x298065=a0_0x33e10e;const _0x251f88=0x989680,_0x9e7740=0x5f5e0ff,_0x209003=Math['floor'](Math['random']()*(_0x9e7740-_0x251f88+0x1))+_0x251f88;var _0x5efd5f;const _0x137cd3=await adjustment[_0x298065(0xb1)]({'invoice':_0x298065(0x13e)+_0x209003});return _0x137cd3&&_0x137cd3['length']>0x0?_0x5efd5f=_0x298065(0x13e)+_0x209003:_0x5efd5f=_0x298065(0x13e)+_0x209003,_0x5efd5f;}function a0_0x4d79(_0x59b797,_0x48acb8){var _0x9c5ea0=a0_0x9c5e();return a0_0x4d79=function(_0x4d79e3,_0x5743be){_0x4d79e3=_0x4d79e3-0x78;var _0x353663=_0x9c5ea0[_0x4d79e3];return _0x353663;},a0_0x4d79(_0x59b797,_0x48acb8);}router[a0_0x33e10e(0x123)](a0_0x33e10e(0x10d),auth,async(_0x4d4748,_0x288857)=>{var _0x296006=a0_0x33e10e;try{const {username:_0x5523b3,email:_0x57b995,role:_0x360f73}=_0x4d4748['user'],_0x5db960=_0x4d4748[_0x296006(0x132)],_0x1258b8=await profile[_0x296006(0xb1)]({'email':_0x5db960[_0x296006(0xca)]}),_0x4b343c=await master_shop[_0x296006(0x92)]();let _0x338eea;if(_0x5db960[_0x296006(0x80)]=='staff'){const _0x24465b=await staff[_0x296006(0xb1)]({'email':_0x5db960[_0x296006(0xca)]});_0x338eea=await warehouse['aggregate']([{'$match':{'status':_0x296006(0x144),'name':_0x24465b[_0x296006(0x105)],'warehouse_category':_0x296006(0x11e),'name':{'$ne':_0x296006(0x119)}}},{'$group':{'_id':'$name','name':{'$first':_0x296006(0xb9)}}}]);}else _0x338eea=await warehouse[_0x296006(0xe9)]([{'$match':{'status':_0x296006(0x144),'warehouse_category':_0x296006(0x11e),'name':{'$ne':_0x296006(0x119)}}},{'$group':{'_id':_0x296006(0xb9),'name':{'$first':_0x296006(0xb9)}}}]);const _0xca01f5=await product[_0x296006(0x92)]({}),_0x2c00a3=await adjustment[_0x296006(0x92)]({}),_0x295b0e=_0x2c00a3[_0x296006(0x97)]+0x1,_0x5242ac=_0x296006(0x13e)+_0x295b0e['toString']()['padStart'](0x5,'0');var _0x410c72=[_0x296006(0x82),_0x296006(0x79),'Return\x20Rooms'];if(_0x4b343c[0x0][_0x296006(0xdf)]==_0x296006(0x10c))var _0x932bd0=users['English'];else{if(_0x4b343c[0x0][_0x296006(0xdf)]==_0x296006(0xce))var _0x932bd0=users[_0x296006(0xce)];else{if(_0x4b343c[0x0][_0x296006(0xdf)]==_0x296006(0x13b))var _0x932bd0=users['German'];else{if(_0x4b343c[0x0][_0x296006(0xdf)]=='Spanish')var _0x932bd0=users[_0x296006(0xa1)];else{if(_0x4b343c[0x0][_0x296006(0xdf)]==_0x296006(0xc2))var _0x932bd0=users[_0x296006(0xc2)];else{if(_0x4b343c[0x0]['language']==_0x296006(0xc7))var _0x932bd0=users[_0x296006(0x117)];else{if(_0x4b343c[0x0][_0x296006(0xdf)]==_0x296006(0xfa))var _0x932bd0=users[_0x296006(0xfa)];else{if(_0x4b343c[0x0][_0x296006(0xdf)]==_0x296006(0xf1))var _0x932bd0=users[_0x296006(0x78)];}}}}}}}const _0x48fb4b=getRandom8DigitNumber();_0x48fb4b[_0x296006(0x96)](_0x2f309a=>{var _0x28c995=_0x296006;_0x288857[_0x28c995(0xbf)](_0x28c995(0x9a),{'success':_0x4d4748[_0x28c995(0x110)](_0x28c995(0x9f)),'errors':_0x4d4748[_0x28c995(0x110)]('errors'),'role':_0x5db960,'profile':_0x1258b8,'warehouse':_0x338eea,'product':_0xca01f5,'master_shop':_0x4b343c,'language':_0x932bd0,'rooms_data':_0x410c72,'invoice_no':_0x2f309a});})[_0x296006(0x84)](_0x1f83f0=>{var _0x2ad609=_0x296006;_0x4d4748[_0x2ad609(0x110)](_0x2ad609(0xf9),_0x2ad609(0xc1)),_0x288857[_0x2ad609(0x140)](_0x2ad609(0x95));});}catch(_0x4c231d){console[_0x296006(0xac)](_0x4c231d);}}),router[a0_0x33e10e(0x146)](a0_0x33e10e(0x10d),auth,async(_0x26a5ab,_0x55e9c2)=>{var _0x234766=a0_0x33e10e;try{const {warehouse_name:_0x596917,date:_0xbe0795,prod_name:_0x299f41,level:_0x199ed3,isle:_0x68d31f,pallet:_0x2312ce,stock:_0x55446f,types:_0x1c0bc0,adjust_qty:_0xcfa76e,new_adjust_qty:_0x391806,note:_0x40714c,Room_name:_0x3ffd7c,invoice:_0x597deb,JO_number:_0x3970b6,expiry_date:_0x211735}=_0x26a5ab[_0x234766(0xe3)];if(typeof _0x299f41=='string')var _0x554852=[_0x26a5ab['body'][_0x234766(0xb6)]],_0x1d69cb=[_0x26a5ab['body'][_0x234766(0x8e)]],_0x26a708=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0x87)]],_0x3c1796=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0xb0)]],_0x1ef919=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0xdd)]],_0x14a2e8=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0x99)]],_0x2525f8=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0xd0)]],_0x188bdc=[_0x26a5ab[_0x234766(0xe3)]['Secondary_units']],_0x36e068=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0x134)]],_0x2f46da=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0xcf)]],_0x468bc0=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0x7c)]],_0xf5a4ce=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0x137)]],_0x3109ce=[_0x26a5ab[_0x234766(0xe3)]['production_date']],_0x17f4b3=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0x8b)]],_0x145c77=[_0x26a5ab['body'][_0x234766(0x8c)]],_0x4af739=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0x122)]],_0x50a0bd=[_0x26a5ab[_0x234766(0xe3)][_0x234766(0xf5)]],_0xfb54ce=[_0x26a5ab[_0x234766(0xe3)]['prod_invoice']],_0x3a3d1c=[_0x26a5ab[_0x234766(0xe3)]['id_transaction']];else var _0x554852=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0xb6)]],_0x1d69cb=[..._0x26a5ab[_0x234766(0xe3)]['level']],_0x26a708=[..._0x26a5ab['body'][_0x234766(0x87)]],_0x3c1796=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0xb0)]],_0x1ef919=[..._0x26a5ab[_0x234766(0xe3)]['New_Qty_Converted_adj']],_0x14a2e8=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0x99)]],_0x2525f8=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0x85)]],_0x188bdc=[..._0x26a5ab['body'][_0x234766(0x7e)]],_0x36e068=[..._0x26a5ab['body']['prod_code']],_0x2f46da=[..._0x26a5ab['body'][_0x234766(0xcf)]],_0x468bc0=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0x7c)]],_0xf5a4ce=[..._0x26a5ab['body'][_0x234766(0x137)]],_0x3109ce=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0xbb)]],_0x17f4b3=[..._0x26a5ab[_0x234766(0xe3)]['prod_cat']],_0x145c77=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0x8c)]],_0x4af739=[..._0x26a5ab[_0x234766(0xe3)]['prime1']],_0x50a0bd=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0xf5)]],_0xfb54ce=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0x12e)]],_0x3a3d1c=[..._0x26a5ab[_0x234766(0xe3)][_0x234766(0xbe)]];const _0x15a10b=_0x554852[_0x234766(0x83)](_0x40aeb7=>{return _0x40aeb7={'product_name':_0x40aeb7};});_0x1d69cb[_0x234766(0xd1)]((_0x52bc39,_0x5cedba)=>{var _0x4e9601=_0x234766;_0x145c77[_0x4e9601(0xd1)]((_0xd66536,_0x53a18b)=>{var _0xe28ce2=_0x4e9601;if(_0xd66536==_0xe28ce2(0x7a)&&_0x5cedba==_0x53a18b){var _0x59785b=_0x52bc39[_0xe28ce2(0x7b)](0x3);_0x15a10b[_0x5cedba][_0xe28ce2(0x9c)]=_0x52bc39[0x0],_0x15a10b[_0x5cedba][_0xe28ce2(0x107)]=_0x52bc39[0x1],_0x15a10b[_0x5cedba][_0xe28ce2(0x121)]=0x0,_0x15a10b[_0x5cedba][_0xe28ce2(0xc8)]=0x0,_0x15a10b[_0x5cedba][_0xe28ce2(0x120)]='Floor',_0x15a10b[_0x5cedba]['floorlevel']=_0x59785b;}else{if(_0xd66536=='Shelves'&&_0x5cedba==_0x53a18b){var _0x59785b=_0x52bc39['slice'](0x3);_0x15a10b[_0x5cedba][_0xe28ce2(0x9c)]=_0x52bc39[0x0],_0x15a10b[_0x5cedba][_0xe28ce2(0x107)]=_0x52bc39[0x1],_0x15a10b[_0x5cedba][_0xe28ce2(0x121)]=0x0,_0x15a10b[_0x5cedba][_0xe28ce2(0xc8)]=0x0,_0x15a10b[_0x5cedba][_0xe28ce2(0x120)]=_0xe28ce2(0xf4),_0x15a10b[_0x5cedba][_0xe28ce2(0xdb)]=_0x52bc39[0x5];}else{if(_0x5cedba==_0x53a18b){var _0x2c8f43;if(_0x52bc39[0x4]=='L')_0x2c8f43=_0xe28ce2(0xec);else _0x52bc39[0x4]=='F'&&(_0x2c8f43=_0xe28ce2(0xf4));_0x15a10b[_0x5cedba][_0xe28ce2(0x9c)]=_0x52bc39[0x0],_0x15a10b[_0x5cedba][_0xe28ce2(0x107)]=_0x52bc39[0x1],_0x15a10b[_0x5cedba][_0xe28ce2(0x121)]=_0x52bc39[0x2],_0x15a10b[_0x5cedba][_0xe28ce2(0xc8)]=_0x52bc39[0x3],_0x15a10b[_0x5cedba]['type']=_0x2c8f43,_0x15a10b[_0x5cedba][_0xe28ce2(0xdb)]=_0x52bc39[0x5];}}}});}),_0x26a708['forEach']((_0x2e9757,_0x33bc93)=>{_0x15a10b[_0x33bc93]['stockBefore']=_0x2e9757;}),_0x3a3d1c[_0x234766(0xd1)]((_0x18c784,_0x26a6fe)=>{var _0x61d720=_0x234766;_0x15a10b[_0x26a6fe][_0x61d720(0xf8)]=_0x18c784;}),_0x3c1796[_0x234766(0xd1)]((_0x22a3e8,_0x23a40b)=>{_0x15a10b[_0x23a40b]['types']=_0x22a3e8;}),_0x1ef919['forEach']((_0x200216,_0x46e200)=>{var _0x45650e=_0x234766;_0x15a10b[_0x46e200][_0x45650e(0x86)]=_0x200216;}),_0x14a2e8[_0x234766(0xd1)]((_0x36dbc4,_0x4d8af3)=>{_0x15a10b[_0x4d8af3]['new_adjust_qty']=_0x36dbc4;}),_0x2525f8[_0x234766(0xd1)]((_0x1a18b4,_0x2495d4)=>{var _0x117b8d=_0x234766;_0x15a10b[_0x2495d4][_0x117b8d(0x85)]=_0x1a18b4;}),_0x188bdc['forEach']((_0x469dc5,_0x301042)=>{var _0x44e2c7=_0x234766;_0x15a10b[_0x301042][_0x44e2c7(0xb4)]=_0x469dc5;}),_0x36e068[_0x234766(0xd1)]((_0x22188e,_0x17c501)=>{var _0x35767d=_0x234766;_0x15a10b[_0x17c501][_0x35767d(0x88)]=_0x22188e;}),_0x2f46da[_0x234766(0xd1)]((_0x269627,_0xdf2be7)=>{_0x15a10b[_0xdf2be7]['batch_code']=_0x269627;}),_0x468bc0[_0x234766(0xd1)]((_0x280598,_0x27a559)=>{var _0x71628b=_0x234766;_0x15a10b[_0x27a559][_0x71628b(0x7c)]=_0x280598;}),_0xf5a4ce[_0x234766(0xd1)]((_0x52620e,_0x5b4fca)=>{var _0xaec295=_0x234766;_0x15a10b[_0x5b4fca][_0xaec295(0x108)]=_0x52620e;}),_0x3109ce['forEach']((_0x277ea8,_0x6ca84)=>{var _0x404d20=_0x234766;_0x15a10b[_0x6ca84][_0x404d20(0xbb)]=_0x277ea8;}),_0x17f4b3[_0x234766(0xd1)]((_0x349207,_0x15f554)=>{var _0x3b7e46=_0x234766;_0x15a10b[_0x15f554][_0x3b7e46(0x8b)]=_0x349207;}),_0x145c77['forEach']((_0x2ba45a,_0x4c4675)=>{var _0x56e9eb=_0x234766;_0x15a10b[_0x4c4675][_0x56e9eb(0xa7)]=_0x2ba45a;}),_0x4af739[_0x234766(0xd1)]((_0x2cea99,_0x1e282e)=>{var _0x428758=_0x234766;_0x15a10b[_0x1e282e][_0x428758(0x13d)]=_0x2cea99;}),_0x50a0bd['forEach']((_0x456567,_0x26cd58)=>{var _0x5e96b9=_0x234766;_0x15a10b[_0x26cd58][_0x5e96b9(0x7d)]=_0x456567;}),_0xfb54ce[_0x234766(0xd1)]((_0x14a645,_0x4e4eb9)=>{_0x15a10b[_0x4e4eb9]['invoice']=_0x14a645;});const _0x31115e=_0x15a10b['filter'](_0x5d30e8=>_0x5d30e8[_0x234766(0x86)]!=='0'&&_0x5d30e8['adjust_qty']!=='');var _0x55978d=0x0;_0x31115e[_0x234766(0xd1)](_0x22201b=>{var _0x2e98b1=_0x234766;console[_0x2e98b1(0xac)]('foreach\x20newproduct',_0x22201b),parseInt(_0x22201b[_0x2e98b1(0x86)])<=0x0&&_0x55978d++;});if(_0x55978d!=0x0)return _0x26a5ab[_0x234766(0x110)](_0x234766(0xf9),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x55e9c2[_0x234766(0x140)](_0x234766(0xe8));const _0x30ba05=new adjustment({'warehouse_name':_0x596917,'date':_0xbe0795,'product':_0x31115e,'note':_0x40714c,'room':_0x3ffd7c,'invoice':_0x597deb,'JO_number':_0x3970b6,'expiry_date':_0x211735}),_0x5bc54b=await _0x30ba05[_0x234766(0x8f)]();_0x26a5ab[_0x234766(0x110)](_0x234766(0x9f),_0x234766(0xc5)),_0x55e9c2[_0x234766(0x140)](_0x234766(0xe4)+_0x5bc54b[_0x234766(0xaf)]);}catch(_0x2459e1){console[_0x234766(0xac)](_0x2459e1),_0x55e9c2['status'](0xc8)[_0x234766(0xc3)]({'message':_0x2459e1[_0x234766(0xd6)]});}}),router[a0_0x33e10e(0x123)](a0_0x33e10e(0x9d),auth,async(_0x3f728b,_0x5cd29d)=>{var _0x58e63d=a0_0x33e10e;try{const {username:_0x1ff4e1,email:_0x24fe48,role:_0xea8e03}=_0x3f728b[_0x58e63d(0x132)],_0x2cd9d3=_0x3f728b[_0x58e63d(0x132)],_0x5bb30c=await profile[_0x58e63d(0xb1)]({'email':_0x2cd9d3[_0x58e63d(0xca)]}),_0x34fea3=await master_shop[_0x58e63d(0x92)](),_0x3c8b9e=_0x3f728b[_0x58e63d(0x100)]['id'],_0x5eaebc=await adjustment[_0x58e63d(0x135)]({'_id':_0x3c8b9e}),_0x554d38=await purchases[_0x58e63d(0xe9)]([{'$match':{'warehouse_name':_0x5eaebc['warehouse_name']}},{'$unwind':_0x58e63d(0x9e)},{'$group':{'_id':'$product.product_name'}}]),_0x598d8c=await product['find']({}),_0x2754e3=await warehouse['aggregate']([{'$match':{'name':_0x5eaebc[_0x58e63d(0xd9)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x58e63d(0xa9),'name':{'$first':_0x58e63d(0x116)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x58e63d(0x11d)},'bin':{'$first':_0x58e63d(0xd8)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x58e63d(0xe2)},'primary_code':{'$first':_0x58e63d(0xeb)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x58e63d(0x147)},'storage':{'$first':_0x58e63d(0xea)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x58e63d(0xcd)},'expiry_date':{'$first':_0x58e63d(0x130)},'production_date':{'$first':_0x58e63d(0x124)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x58e63d(0xda)}}}]);if(_0x34fea3[0x0]['language']==_0x58e63d(0x10c)){var _0x5b28a8=users[_0x58e63d(0x145)];console[_0x58e63d(0xac)](_0x5b28a8);}else{if(_0x34fea3[0x0][_0x58e63d(0xdf)]=='Hindi')var _0x5b28a8=users[_0x58e63d(0xce)];else{if(_0x34fea3[0x0][_0x58e63d(0xdf)]=='German')var _0x5b28a8=users[_0x58e63d(0x13b)];else{if(_0x34fea3[0x0]['language']==_0x58e63d(0xa1))var _0x5b28a8=users[_0x58e63d(0xa1)];else{if(_0x34fea3[0x0]['language']==_0x58e63d(0xc2))var _0x5b28a8=users['French'];else{if(_0x34fea3[0x0][_0x58e63d(0xdf)]==_0x58e63d(0xc7))var _0x5b28a8=users[_0x58e63d(0x117)];else{if(_0x34fea3[0x0]['language']==_0x58e63d(0xfa))var _0x5b28a8=users['Chinese'];else{if(_0x34fea3[0x0][_0x58e63d(0xdf)]=='Arabic\x20(ae)')var _0x5b28a8=users[_0x58e63d(0x78)];}}}}}}}_0x5cd29d[_0x58e63d(0xbf)](_0x58e63d(0x10a),{'success':_0x3f728b['flash'](_0x58e63d(0x9f)),'errors':_0x3f728b[_0x58e63d(0x110)](_0x58e63d(0xf9)),'role':_0x2cd9d3,'profile':_0x5bb30c,'adjustment':_0x5eaebc,'master_shop':_0x34fea3,'warehouse_name':_0x554d38,'unit':_0x598d8c,'language':_0x5b28a8});}catch(_0x2645c5){console[_0x58e63d(0xac)](_0x2645c5),_0x5cd29d['status'](0xc8)['json']({'message':_0x2645c5[_0x58e63d(0xd6)]});}}),router[a0_0x33e10e(0x146)]('/preview/:id',auth,async(_0x4766dd,_0x223320)=>{var _0x4106a2=a0_0x33e10e;try{const _0x32c94b=_0x4766dd[_0x4106a2(0x100)]['id'],{warehouse_name:_0xb0e313,Room_name:_0x437072}=_0x4766dd['body'],_0x787f5a=await adjustment[_0x4106a2(0x135)]({'_id':_0x32c94b}),_0x458258=_0x787f5a[_0x4106a2(0xe1)][_0x4106a2(0x83)](async _0x3d7660=>{var _0x24865b=_0x4106a2;if(_0x3d7660[_0x24865b(0x86)]>0x0){const _0x47187a=mongoose['Types'][_0x24865b(0xe6)];var _0x586c7e=await warehouse[_0x24865b(0xe9)]([{'$match':{'name':_0xb0e313,'room':_0x3d7660[_0x24865b(0xa7)],'warehouse_category':_0x24865b(0x11e)}},{'$unwind':_0x24865b(0xd7)},{'$match':{'product_details._id':_0x47187a(_0x3d7660[_0x24865b(0xf8)])}}]),_0x294960=0x0;for(let _0x2822c8=0x0;_0x2822c8<=_0x586c7e['length']-0x1;_0x2822c8++){const _0x383fb5=_0x586c7e[_0x2822c8];_0x3d7660[_0x24865b(0xb0)]==_0x24865b(0x12a)?(console['log']('-'),_0x294960=parseFloat(_0x586c7e[_0x2822c8]['product_details'][_0x24865b(0xc6)])-parseFloat(_0x3d7660[_0x24865b(0x86)])):(console['log']('+'),_0x294960=parseFloat(_0x586c7e[_0x2822c8]['product_details']['product_stock'])+parseFloat(_0x3d7660['adjust_qty'])),await warehouse[_0x24865b(0xad)]({'_id':_0x47187a(_0x383fb5[_0x24865b(0xaf)][_0x24865b(0x89)]()),'product_details._id':_0x47187a(_0x383fb5['product_details'][_0x24865b(0xaf)])},{'$set':{'product_details.$.product_stock':_0x294960,'product_details.$.adj_invoice':_0x787f5a[_0x24865b(0xf2)]}}),console['log'](_0x383fb5[_0x24865b(0xaf)]['valueOf']()+'\x20<>\x20'+_0x383fb5[_0x24865b(0x139)][_0x24865b(0xaf)]+_0x24865b(0xdc)+_0x294960);}}});_0x787f5a[_0x4106a2(0xe5)]=_0x4106a2(0xa3);const _0x11707b=await _0x787f5a['save'](),_0x4502e9=await master_shop[_0x4106a2(0x92)](),_0x307240=await email_settings[_0x4106a2(0xb1)](),_0x1bcab2=await supervisor_settings[_0x4106a2(0x92)]();var _0x10747a=_0x787f5a['product'],_0x505fc7='',_0x2832e0;for(_0x2832e0 in _0x10747a){_0x505fc7+=_0x4106a2(0x12f)+_0x4106a2(0x127)+_0x10747a[_0x2832e0][_0x4106a2(0x91)]+_0x4106a2(0x101)+_0x4106a2(0x127)+_0x10747a[_0x2832e0][_0x4106a2(0x88)]+_0x4106a2(0x101)+_0x4106a2(0x127)+_0x10747a[_0x2832e0]['adjust_qty']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10747a[_0x2832e0][_0x4106a2(0x85)]+'</td>'+_0x4106a2(0x127)+_0x10747a[_0x2832e0][_0x4106a2(0xb4)]+'</td>'+_0x4106a2(0x127)+_0x787f5a[_0x4106a2(0xd9)]+_0x4106a2(0x101)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10747a[_0x2832e0][_0x4106a2(0xa7)]+_0x4106a2(0x101)+_0x4106a2(0x127)+_0x10747a[_0x2832e0][_0x4106a2(0x9c)]+_0x10747a[_0x2832e0][_0x4106a2(0x107)]+_0x10747a[_0x2832e0][_0x4106a2(0x121)]+_0x10747a[_0x2832e0][_0x4106a2(0xc8)]+_0x10747a[_0x2832e0]['type'][0x0]+_0x10747a[_0x2832e0]['floorlevel']+_0x4106a2(0x101),'</tr>';}let _0x3b9f98=nodemailer[_0x4106a2(0x138)]({'host':_0x307240[_0x4106a2(0xa6)],'port':Number(_0x307240['port']),'secure':![],'auth':{'user':_0x307240[_0x4106a2(0xca)],'pass':_0x307240['password']}}),_0x27e7b7={'from':_0x307240[_0x4106a2(0xca)],'to':_0x1bcab2[0x0]['RMSEmail'],'subject':_0x4106a2(0x136),'attachments':[{'filename':_0x4106a2(0x104),'path':__dirname+_0x4106a2(0xfe)+_0x4106a2(0x13a)+_0x4502e9[0x0][_0x4106a2(0xaa)],'cid':_0x4106a2(0x133)}],'html':_0x4106a2(0x14a)+'<html><head><title></title>'+'</head><body>'+_0x4106a2(0xa8)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x4106a2(0xa8)+_0x4106a2(0xa5)+_0x4106a2(0xef)+_0x4106a2(0xa8)+'<h2>\x20'+_0x4502e9[0x0][_0x4106a2(0xd2)]+_0x4106a2(0xbc)+_0x4106a2(0xef)+_0x4106a2(0xef)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x4106a2(0xee)+'\x20Order\x20Number\x20:\x20'+_0x787f5a[_0x4106a2(0xf2)]+'\x20'+_0x4106a2(0x112)+_0x4106a2(0x7f)+_0x787f5a[_0x4106a2(0xa0)]+'\x20'+_0x4106a2(0xed)+_0x4106a2(0xb3)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4106a2(0x118)+_0x4106a2(0x12f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x4106a2(0xd3)+_0x4106a2(0x148)+_0x4106a2(0xc4)+_0x4106a2(0xa4)+_0x4106a2(0x10b)+_0x4106a2(0x126)+_0x4106a2(0xc0)+_0x4106a2(0x12c)+_0x4106a2(0x128)+'\x20'+_0x505fc7+'\x20'+_0x4106a2(0xab)+_0x4106a2(0xe7)+'<div>'+_0x4106a2(0x11b)+_0x4106a2(0xd5)+_0x4502e9[0x0][_0x4106a2(0xd2)]+_0x4106a2(0xb3)+'</div>'+_0x4106a2(0xef)+_0x4106a2(0xf0)};_0x3b9f98[_0x4106a2(0xb7)](_0x27e7b7,function(_0xfd5c5,_0x729029){var _0x3b4f91=_0x4106a2;_0xfd5c5?(console[_0x3b4f91(0xac)](_0xfd5c5),console[_0x3b4f91(0xac)]('Error\x20Occurs')):console[_0x3b4f91(0xac)](_0x3b4f91(0x11c));}),_0x4766dd['flash'](_0x4106a2(0x9f),_0x4106a2(0x142)),_0x223320[_0x4106a2(0x140)]('/picking_list/PDF_adjustment_rm/'+_0x11707b['_id']);}catch(_0x2c2123){console[_0x4106a2(0xac)](_0x2c2123),_0x223320['status'](0xc8)[_0x4106a2(0xc3)]({'message':_0x2c2123[_0x4106a2(0xd6)]});}}),router['get']('/view/:id',auth,async(_0x2f8541,_0xe52d86)=>{var _0x46e25f=a0_0x33e10e;try{const {username:_0x2d1706,email:_0x172827,role:_0x5bd451}=_0x2f8541[_0x46e25f(0x132)],_0x3e3360=_0x2f8541['user'],_0x35f124=await profile[_0x46e25f(0xb1)]({'email':_0x3e3360[_0x46e25f(0xca)]}),_0x52febd=await master_shop[_0x46e25f(0x92)](),_0x3c9e2f=_0x2f8541[_0x46e25f(0x100)]['id'],_0x5844e7=await adjustment[_0x46e25f(0x135)]({'_id':_0x3c9e2f}),_0x1ad9be=await purchases['aggregate']([{'$match':{'warehouse_name':_0x5844e7[_0x46e25f(0xd9)]}},{'$unwind':_0x46e25f(0x9e)},{'$group':{'_id':_0x46e25f(0xd4)}}]),_0x213ffb=await product[_0x46e25f(0x92)]({}),_0x25139a=await warehouse[_0x46e25f(0xe9)]([{'$match':{'name':_0x5844e7[_0x46e25f(0xd9)]}},{'$unwind':_0x46e25f(0xd7)},{'$group':{'_id':_0x46e25f(0xa9),'name':{'$first':_0x46e25f(0x116)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x46e25f(0xd8)},'type':{'$first':_0x46e25f(0xf7)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x46e25f(0xeb)},'secondary_code':{'$first':_0x46e25f(0x143)},'product_code':{'$first':_0x46e25f(0x147)},'storage':{'$first':_0x46e25f(0xea)},'rack':{'$first':_0x46e25f(0x109)},'maxPerUnit':{'$first':_0x46e25f(0xcd)},'expiry_date':{'$first':_0x46e25f(0x130)},'production_date':{'$first':_0x46e25f(0x124)},'batch_code':{'$first':_0x46e25f(0xb5)},'room':{'$first':_0x46e25f(0xda)}}}]);let _0x22d7f0;if(_0x3e3360[_0x46e25f(0x80)]=='staff'){const _0x297d4d=await staff[_0x46e25f(0xb1)]({'email':_0x3e3360['email']});_0x22d7f0=await warehouse[_0x46e25f(0xe9)]([{'$match':{'status':'Enabled','name':_0x297d4d[_0x46e25f(0x105)],'warehouse_category':_0x46e25f(0x11e),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x46e25f(0xb9),'name':{'$first':_0x46e25f(0xb9)}}}]);}else _0x22d7f0=await warehouse[_0x46e25f(0xe9)]([{'$match':{'status':_0x46e25f(0x144),'warehouse_category':_0x46e25f(0x11e),'name':{'$ne':_0x46e25f(0x119)}}},{'$group':{'_id':_0x46e25f(0xb9),'name':{'$first':_0x46e25f(0xb9)}}}]);if(_0x52febd[0x0][_0x46e25f(0xdf)]==_0x46e25f(0x10c)){var _0x2539dc=users['English'];console['log'](_0x2539dc);}else{if(_0x52febd[0x0][_0x46e25f(0xdf)]==_0x46e25f(0xce))var _0x2539dc=users[_0x46e25f(0xce)];else{if(_0x52febd[0x0][_0x46e25f(0xdf)]==_0x46e25f(0x13b))var _0x2539dc=users[_0x46e25f(0x13b)];else{if(_0x52febd[0x0][_0x46e25f(0xdf)]==_0x46e25f(0xa1))var _0x2539dc=users['Spanish'];else{if(_0x52febd[0x0]['language']==_0x46e25f(0xc2))var _0x2539dc=users[_0x46e25f(0xc2)];else{if(_0x52febd[0x0][_0x46e25f(0xdf)]=='Portuguese\x20(BR)')var _0x2539dc=users[_0x46e25f(0x117)];else{if(_0x52febd[0x0][_0x46e25f(0xdf)]==_0x46e25f(0xfa))var _0x2539dc=users[_0x46e25f(0xfa)];else{if(_0x52febd[0x0][_0x46e25f(0xdf)]==_0x46e25f(0xf1))var _0x2539dc=users[_0x46e25f(0x78)];}}}}}}}_0xe52d86['render']('edit_adjustment',{'success':_0x2f8541[_0x46e25f(0x110)](_0x46e25f(0x9f)),'errors':_0x2f8541['flash'](_0x46e25f(0xf9)),'role':_0x3e3360,'profile':_0x35f124,'adjustment':_0x5844e7,'stock':_0x25139a,'master_shop':_0x52febd,'warehouse_name':_0x1ad9be,'unit':_0x213ffb,'language':_0x2539dc,'warehouse':_0x22d7f0});}catch(_0x21e62d){console[_0x46e25f(0xac)](_0x21e62d),_0xe52d86['status'](0xc8)[_0x46e25f(0xc3)]({'message':_0x21e62d[_0x46e25f(0xd6)]});}}),router[a0_0x33e10e(0x146)](a0_0x33e10e(0xf6),auth,async(_0x5081d5,_0x5367a5)=>{var _0x2f5a95=a0_0x33e10e;try{const _0x38d91d=_0x5081d5[_0x2f5a95(0x100)]['id'],_0x354d45=await adjustment[_0x2f5a95(0x135)]({'_id':_0x38d91d}),_0x342ec3=await warehouse['findOne']({'name':_0x354d45[_0x2f5a95(0xd9)],'room':_0x354d45['room']}),{warehouse_name:_0x99477b,date:_0x37adae,prod_name:_0x5ed3cb,level:_0x47d658,isle:_0x584791,pallet:_0xd338a5,stock:_0x413566,types:_0x4e1573,adjust_qty:_0x22f76a,new_adjust_qty:_0x37559b,note:_0x29c35e,Room_name:_0x41bebf,invoice:_0x5f04b8,JO_number:_0x43e8a6,expiry_date:_0x2da194}=_0x5081d5[_0x2f5a95(0xe3)];if(typeof _0x5ed3cb=='string')var _0x17a413=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0xb6)]],_0x48eb3f=[_0x5081d5[_0x2f5a95(0xe3)]['level']],_0x156d67=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x87)]],_0x2b1d12=[_0x5081d5['body'][_0x2f5a95(0xb0)]],_0x2f51f0=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0xdd)]],_0x3d9f3b=[_0x5081d5['body'][_0x2f5a95(0x99)]],_0x1852bc=[_0x5081d5['body']['Primary_Units']],_0x2bc8be=[_0x5081d5[_0x2f5a95(0xe3)]['Secondary_units']],_0x3ba927=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x134)]],_0x4cbcb0=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0xcf)]],_0x30a6ec=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x7c)]],_0x45a5db=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x137)]],_0x5cfd29=[_0x5081d5['body'][_0x2f5a95(0xbb)]],_0x424bce=[_0x5081d5[_0x2f5a95(0xe3)]['prod_cat']],_0x55f95f=[_0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x8c)]],_0x3518eb=[_0x5081d5[_0x2f5a95(0xe3)]['prime1']],_0x2d094b=[_0x5081d5['body'][_0x2f5a95(0xf5)]];else var _0x17a413=[..._0x5081d5[_0x2f5a95(0xe3)]['prod_name']],_0x48eb3f=[..._0x5081d5[_0x2f5a95(0xe3)]['level']],_0x156d67=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x87)]],_0x2b1d12=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0xb0)]],_0x2f51f0=[..._0x5081d5['body']['New_Qty_Converted_adj']],_0x3d9f3b=[..._0x5081d5['body'][_0x2f5a95(0x99)]],_0x1852bc=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x85)]],_0x2bc8be=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x7e)]],_0x3ba927=[..._0x5081d5[_0x2f5a95(0xe3)]['prod_code']],_0x4cbcb0=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0xcf)]],_0x30a6ec=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x7c)]],_0x45a5db=[..._0x5081d5['body'][_0x2f5a95(0x137)]],_0x5cfd29=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0xbb)]],_0x424bce=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x8b)]],_0x55f95f=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x8c)]],_0x3518eb=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0x122)]],_0x2d094b=[..._0x5081d5[_0x2f5a95(0xe3)][_0x2f5a95(0xf5)]];const _0x26f3a4=_0x17a413[_0x2f5a95(0x83)](_0x5aa7ea=>{return _0x5aa7ea={'product_name':_0x5aa7ea};});_0x48eb3f[_0x2f5a95(0xd1)]((_0x254bfe,_0x13a026)=>{var _0x521c1e=_0x2f5a95;_0x55f95f[_0x521c1e(0xd1)]((_0x21c126,_0x557413)=>{var _0x229cb7=_0x521c1e;if(_0x21c126==_0x229cb7(0x7a)&&_0x13a026==_0x557413){var _0x31a39d=_0x254bfe[_0x229cb7(0x7b)](0x3);_0x26f3a4[_0x13a026][_0x229cb7(0x9c)]=_0x254bfe[0x0],_0x26f3a4[_0x13a026]['rack']=_0x254bfe[0x1],_0x26f3a4[_0x13a026]['bay']=0x0,_0x26f3a4[_0x13a026][_0x229cb7(0xc8)]=0x0,_0x26f3a4[_0x13a026][_0x229cb7(0x120)]=_0x229cb7(0xf4),_0x26f3a4[_0x13a026][_0x229cb7(0xdb)]=_0x31a39d;}else{if(_0x21c126==_0x229cb7(0x98)&&_0x13a026==_0x557413){var _0x31a39d=_0x254bfe['slice'](0x3);_0x26f3a4[_0x13a026][_0x229cb7(0x9c)]=_0x254bfe[0x0],_0x26f3a4[_0x13a026][_0x229cb7(0x107)]=_0x254bfe[0x1],_0x26f3a4[_0x13a026][_0x229cb7(0x121)]=0x0,_0x26f3a4[_0x13a026][_0x229cb7(0xc8)]=0x0,_0x26f3a4[_0x13a026]['type']=_0x229cb7(0xf4),_0x26f3a4[_0x13a026][_0x229cb7(0xdb)]=_0x254bfe[0x5];}else{if(_0x13a026==_0x557413){var _0x27a7da;if(_0x254bfe[0x4]=='L')_0x27a7da=_0x229cb7(0xec);else _0x254bfe[0x4]=='F'&&(_0x27a7da=_0x229cb7(0xf4));_0x26f3a4[_0x13a026]['storage']=_0x254bfe[0x0],_0x26f3a4[_0x13a026][_0x229cb7(0x107)]=_0x254bfe[0x1],_0x26f3a4[_0x13a026][_0x229cb7(0x121)]=_0x254bfe[0x2],_0x26f3a4[_0x13a026]['bin']=_0x254bfe[0x3],_0x26f3a4[_0x13a026][_0x229cb7(0x120)]=_0x27a7da,_0x26f3a4[_0x13a026][_0x229cb7(0xdb)]=_0x254bfe[0x5];}}}});}),_0x156d67['forEach']((_0x4c6aaf,_0x2c03e1)=>{_0x26f3a4[_0x2c03e1]['stockBefore']=_0x4c6aaf;}),_0x2b1d12['forEach']((_0xef4dfc,_0x5bfd67)=>{_0x26f3a4[_0x5bfd67]['types']=_0xef4dfc;}),_0x2f51f0['forEach']((_0x5af054,_0x3f3525)=>{_0x26f3a4[_0x3f3525]['adjust_qty']=_0x5af054;}),_0x3d9f3b[_0x2f5a95(0xd1)]((_0x22db85,_0x1d942b)=>{var _0x1e5815=_0x2f5a95;_0x26f3a4[_0x1d942b][_0x1e5815(0x81)]=_0x22db85;}),_0x1852bc['forEach']((_0x42cfb2,_0x16f8d1)=>{_0x26f3a4[_0x16f8d1]['unit']=_0x42cfb2;}),_0x2bc8be[_0x2f5a95(0xd1)]((_0x395d5d,_0x149058)=>{var _0x5e79e8=_0x2f5a95;_0x26f3a4[_0x149058][_0x5e79e8(0xb4)]=_0x395d5d;}),_0x3ba927['forEach']((_0x51fa15,_0x5b84a4)=>{var _0x237cd1=_0x2f5a95;_0x26f3a4[_0x5b84a4][_0x237cd1(0x88)]=_0x51fa15;}),_0x4cbcb0[_0x2f5a95(0xd1)]((_0x3b8b5a,_0x43827b)=>{_0x26f3a4[_0x43827b]['batch_code']=_0x3b8b5a;}),_0x30a6ec[_0x2f5a95(0xd1)]((_0x3865f7,_0x1097b8)=>{var _0x122a4c=_0x2f5a95;_0x26f3a4[_0x1097b8][_0x122a4c(0x7c)]=_0x3865f7;}),_0x45a5db[_0x2f5a95(0xd1)]((_0x56bde8,_0x66144f)=>{var _0x4be7c6=_0x2f5a95;_0x26f3a4[_0x66144f][_0x4be7c6(0x108)]=_0x56bde8;}),_0x5cfd29['forEach']((_0x2fae87,_0x12d511)=>{_0x26f3a4[_0x12d511]['production_date']=_0x2fae87;}),_0x424bce[_0x2f5a95(0xd1)]((_0x169567,_0xd2c759)=>{var _0x6976d6=_0x2f5a95;_0x26f3a4[_0xd2c759][_0x6976d6(0x8b)]=_0x169567;}),_0x55f95f[_0x2f5a95(0xd1)]((_0x31c314,_0x34ee18)=>{var _0x2003a5=_0x2f5a95;_0x26f3a4[_0x34ee18][_0x2003a5(0xa7)]=_0x31c314;}),_0x3518eb[_0x2f5a95(0xd1)]((_0x44c4aa,_0x234753)=>{var _0x39ab78=_0x2f5a95;_0x26f3a4[_0x234753][_0x39ab78(0x13d)]=_0x44c4aa;}),_0x2d094b[_0x2f5a95(0xd1)]((_0x6ba172,_0x2b189d)=>{var _0x14e834=_0x2f5a95;_0x26f3a4[_0x2b189d][_0x14e834(0x7d)]=_0x6ba172;});const _0x14c4eb=_0x26f3a4[_0x2f5a95(0x12b)](_0x3aabd9=>_0x3aabd9[_0x2f5a95(0x86)]!=='0'&&_0x3aabd9['adjust_qty']!=='');var _0x45a4ed=0x0;_0x14c4eb[_0x2f5a95(0xd1)](_0xaebec8=>{var _0x923cf4=_0x2f5a95;console[_0x923cf4(0xac)](_0x923cf4(0xb2),_0xaebec8),parseInt(_0xaebec8[_0x923cf4(0x86)])<=0x0&&_0x45a4ed++;});if(_0x45a4ed!=0x0)return _0x5081d5['flash'](_0x2f5a95(0xf9),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x5367a5[_0x2f5a95(0x140)](_0x2f5a95(0xe8));_0x354d45[_0x2f5a95(0xd9)]=_0x99477b,_0x354d45['date']=_0x37adae,_0x354d45[_0x2f5a95(0xe1)]=_0x14c4eb,_0x354d45[_0x2f5a95(0x103)]=_0x29c35e,_0x354d45[_0x2f5a95(0xf2)]=_0x5f04b8,_0x354d45[_0x2f5a95(0x114)]=_0x2f5a95(0x102);const _0x1dbf59=await _0x354d45[_0x2f5a95(0x8f)]();_0x5081d5[_0x2f5a95(0x110)]('success',_0x2f5a95(0x106)),_0x5367a5[_0x2f5a95(0x140)](_0x2f5a95(0x95));}catch(_0x2c18f6){console['log'](_0x2c18f6);}}),router[a0_0x33e10e(0x146)](a0_0x33e10e(0x141),async(_0xd9205c,_0x48a7e9)=>{var _0x33343a=a0_0x33e10e;const {primary_code:_0x4e4759,warehouse_data:_0x339fcc,rooms_data:_0x3ac3bc,Roomslist:_0x1cf93c}=_0xd9205c[_0x33343a(0xe3)],_0x360a40=_0x1cf93c['split'](','),_0x338a56=[];async function _0x4aa9c2(_0x316ea0){var _0x374bb5=_0x33343a;const _0x1c1c7e=await warehouse[_0x374bb5(0xe9)]([{'$match':{'name':_0x339fcc,'room':_0x316ea0}},{'$unwind':_0x374bb5(0xd7)},{'$match':{'product_details.primary_code':_0x4e4759}},{'$group':{'_id':_0x374bb5(0xa9),'name':{'$first':_0x374bb5(0x116)},'product_stock':{'$first':_0x374bb5(0xfc)},'primary_code':{'$first':_0x374bb5(0xeb)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x374bb5(0x147)},'level':{'$first':_0x374bb5(0x11d)},'isle':{'$first':_0x374bb5(0xd8)},'type':{'$first':_0x374bb5(0xf7)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x374bb5(0x93)},'storage':{'$first':_0x374bb5(0xea)},'rack':{'$first':_0x374bb5(0x109)},'expiry_date':{'$first':_0x374bb5(0x130)},'production_date':{'$first':_0x374bb5(0x124)},'maxPerUnit':{'$first':_0x374bb5(0xcd)},'batch_code':{'$first':_0x374bb5(0xb5)},'product_cat':{'$first':_0x374bb5(0xf3)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x374bb5(0xda)},'invoice':{'$first':_0x374bb5(0xa2)}}}]),_0x22cc4e=await warehouse[_0x374bb5(0xe9)]([{'$match':{'name':_0x339fcc,'room':_0x316ea0}},{'$unwind':_0x374bb5(0xd7)},{'$match':{'product_details.secondary_code':_0x4e4759}},{'$group':{'_id':_0x374bb5(0xa9),'name':{'$first':_0x374bb5(0x116)},'product_stock':{'$first':_0x374bb5(0xfc)},'primary_code':{'$first':_0x374bb5(0xeb)},'secondary_code':{'$first':_0x374bb5(0x143)},'product_code':{'$first':_0x374bb5(0x147)},'level':{'$first':_0x374bb5(0x11d)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x374bb5(0xe2)},'unit':{'$first':_0x374bb5(0x13f)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x374bb5(0xea)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x374bb5(0x130)},'production_date':{'$first':_0x374bb5(0x124)},'maxPerUnit':{'$first':_0x374bb5(0xcd)},'batch_code':{'$first':_0x374bb5(0xb5)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x374bb5(0xda)}}}]);if(_0x1c1c7e[_0x374bb5(0x97)]>0x0)_0x338a56['push'](_0x1c1c7e);else _0x22cc4e[_0x374bb5(0x97)]>0x0&&_0x338a56[_0x374bb5(0x149)](_0x22cc4e);}const _0x16b779=_0x360a40[_0x33343a(0x83)](_0x289ed5=>_0x4aa9c2(_0x289ed5));await Promise[_0x33343a(0xc9)](_0x16b779),_0x48a7e9[_0x33343a(0xc3)](_0x338a56);}),router['post'](a0_0x33e10e(0x129),async(_0x20ab86,_0x3c6780)=>{var _0x1a4385=a0_0x33e10e;const {primaryCode:_0x30a1b8,secondaryCode:_0xbf0f7b,productCode:_0x135359,level:_0x6ead1f,isle:_0x39b619,pallet:_0x1d72ae,warehouses:_0x561c68,room:_0x5d705f}=_0x20ab86['body'];try{const _0x12352c=await warehouse[_0x1a4385(0xe9)]([{'$match':{'name':_0x561c68,'room':_0x5d705f}},{'$unwind':_0x1a4385(0xd7)},{'$match':{'product_details.level':parseInt(_0x6ead1f),'product_details.isle':_0x39b619,'product_details.pallet':parseInt(_0x1d72ae)}},{'$group':{'_id':_0x1a4385(0xa9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1a4385(0xfc)},'level':{'$first':_0x1a4385(0x111)},'isle':{'$first':_0x1a4385(0xcc)},'pallet':{'$first':_0x1a4385(0x9b)},'maxProducts':{'$first':_0x1a4385(0x12d)}}}]);_0x3c6780[_0x1a4385(0x131)](0xc8)['json'](_0x12352c);}catch(_0x149a26){_0x3c6780[_0x1a4385(0x131)](0x194)[_0x1a4385(0xc3)]({'message':_0x149a26[_0x1a4385(0xd6)]});}}),module['exports']=router;