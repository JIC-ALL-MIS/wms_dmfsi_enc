var a0_0x110fa0=a0_0x2ee7;(function(_0x58e170,_0xcc9ad){var _0x309fd1=a0_0x2ee7,_0x1a49fb=_0x58e170();while(!![]){try{var _0x2dbace=parseInt(_0x309fd1(0x1a8))/0x1+parseInt(_0x309fd1(0x1cc))/0x2+-parseInt(_0x309fd1(0x184))/0x3+-parseInt(_0x309fd1(0x16a))/0x4+parseInt(_0x309fd1(0x109))/0x5+parseInt(_0x309fd1(0x13c))/0x6*(parseInt(_0x309fd1(0x193))/0x7)+-parseInt(_0x309fd1(0x17e))/0x8*(parseInt(_0x309fd1(0x186))/0x9);if(_0x2dbace===_0xcc9ad)break;else _0x1a49fb['push'](_0x1a49fb['shift']());}catch(_0x14c491){_0x1a49fb['push'](_0x1a49fb['shift']());}}}(a0_0x29cf,0x7cb67));function a0_0x2ee7(_0x5133e7,_0x374132){var _0x29cff3=a0_0x29cf();return a0_0x2ee7=function(_0x2ee793,_0x241f57){_0x2ee793=_0x2ee793-0x101;var _0x50b582=_0x29cff3[_0x2ee793];return _0x50b582;},a0_0x2ee7(_0x5133e7,_0x374132);}function a0_0x29cf(){var _0x3581a8=['$product','$date','adjustment','_id','/view/:id','<div>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Error\x20Occurs','filter','status','language','$product_details.maxPerUnit','</td>','/upload/','new_adjust_qty','user','slice','json','adjust_qty','English\x20(US)','$product.room_names','<tbody\x20style=\x22text-align:\x20center;\x22>','room','$product_details','Secondary_units','port','$product.product_name','stockBefore','$product_details.product_stock','False','$product_details.batch_code','Level','$isAllowEdit','edit_adjustment_view','string','production_date','Raw\x20Materials','isAllowEdit','prime1','$product_details.primary_code','3233060MbkgTX','../models/all_models','rack','ADJ-','second1','French','toString','Return\x20Rooms','padStart','<!DOCTYPE\x20html>','German','$product_details.bay','sendMail','types','/preview/:id','length','<h5>','Portuguese','batch_code','Enabled','123344OTLWYS','<span\x20style=\x22float:\x20right;\x22>','staff','body','stock','\x20Order\x20Number\x20:\x20','163302fNNxRC','all','540fsDXqf','Return\x20Goods','Router','primary_code','Primary_Units','Shelves','$product_details.production_date','$product_details.product_name','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','site_title','express','product_name','logo','8407gjSfcT','adjustment\x20Finalized\x20successfully','$product_details._id','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.secondary_unit','split','invoice','foreach\x20newproduct','message','forEach','Adjustment\x20Mail','storage','errors','True','Logo.png','expiry_date','warehouse_name','/adjustment/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','floor','unit','957075wAbLpM','</span>','<h2>\x20','post','Chinese','render','email','Arabic\x20(ae)','get','product_stock','push','nodemailer','New_Qty_Converted','type','</table>','flash','prod_invoice','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','random','An\x20error\x20occurred.','$product_details.bin','</head><body>','$product_details.product_cat','New_Qty_Converted_adj','host','/view','$product_details.isle','log','Receiving\x20Area','$product_details.floorlevel','warehouse','minus','prod_code','date','</div>','Floor','278326ihLAgS','bin','product_code','Portuguese\x20(BR)','level','prod_cat','exports','/picking_list/PDF_adjustment_rm/','floorlevel','$name','secondary_unit','Ambient','<tr>','\x20</h2>','then','1670205eJQaxF','</tr>','Enclosed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','max_per_unit','$room','password','redirect','role','add_adjustment','edit_adjustment','save','$product_details.secondary_code','English','aggregate','$product_details.pallet','map','adjustment\x20add\x20successfull','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','\x20<>\x20','Email\x20sent\x20successfully','$product_details.type','Arabic','Spanish','product','room_names','catch','$product_details.storage','image','params','<h5\x20style=\x22text-align:\x20left;\x22>','</tbody>','$product_details.rack','error','secondary_code','</body></html>','findOne','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','findById','$product_details.expiry_date','Hindi','success','/CheckingWarehouse','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','adjustment\x20data\x20update\x20successfully','bay','maxperunit','prod_name','back','4338YbhcrW','$product_details.unit','find','Rooms','$product_details.product_code'];a0_0x29cf=function(){return _0x3581a8;};return a0_0x29cf();}const express=require(a0_0x110fa0(0x190)),app=express(),router=express[a0_0x110fa0(0x188)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x110fa0(0x16b)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x110fa0(0x1b3));router[a0_0x110fa0(0x1b0)](a0_0x110fa0(0x1c1),auth,async(_0x1ed9be,_0x537ca8)=>{var _0x5dacbb=a0_0x110fa0;try{const {username:_0x2de3b3,email:_0x4130e3,role:_0x2a86cd}=_0x1ed9be['user'],_0x5c83a3=_0x1ed9be[_0x5dacbb(0x151)],_0x5e57f8=await profile['findOne']({'email':_0x5c83a3[_0x5dacbb(0x1ae)]}),_0x27c054=await master_shop[_0x5dacbb(0x13e)]();console['log']('master',_0x27c054);let _0x3323a7;if(_0x5c83a3[_0x5dacbb(0x112)]==_0x5dacbb(0x180)){const _0x2d0fa5=await staff[_0x5dacbb(0x12e)]({'email':_0x5c83a3[_0x5dacbb(0x1ae)]});_0x3323a7=await warehouse[_0x5dacbb(0x13e)]({'status':'Enabled','name':_0x2d0fa5['warehouse']});}else _0x3323a7=await warehouse[_0x5dacbb(0x13e)]({'status':_0x5dacbb(0x17d)});const _0x1aada3=await product[_0x5dacbb(0x13e)]();let _0x27948f;if(_0x5c83a3[_0x5dacbb(0x112)]==_0x5dacbb(0x180)){const _0x395ec3=await staff['findOne']({'email':_0x5c83a3['email']});_0x27948f=await adjustment[_0x5dacbb(0x13e)]({'warehouse_name':_0x395ec3['warehouse']});}else _0x27948f=await adjustment[_0x5dacbb(0x118)]([{'$unwind':_0x5dacbb(0x141)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x5dacbb(0x142)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x5dacbb(0x156)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x5dacbb(0x162)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x27c054[0x0][_0x5dacbb(0x14c)]==_0x5dacbb(0x155)){var _0xec8e42=users[_0x5dacbb(0x117)];console[_0x5dacbb(0x1c3)](_0xec8e42);}else{if(_0x27c054[0x0][_0x5dacbb(0x14c)]==_0x5dacbb(0x133))var _0xec8e42=users['Hindi'];else{if(_0x27c054[0x0][_0x5dacbb(0x14c)]==_0x5dacbb(0x174))var _0xec8e42=users[_0x5dacbb(0x174)];else{if(_0x27c054[0x0][_0x5dacbb(0x14c)]==_0x5dacbb(0x121))var _0xec8e42=users[_0x5dacbb(0x121)];else{if(_0x27c054[0x0][_0x5dacbb(0x14c)]=='French')var _0xec8e42=users[_0x5dacbb(0x16f)];else{if(_0x27c054[0x0]['language']==_0x5dacbb(0x1cf))var _0xec8e42=users[_0x5dacbb(0x17b)];else{if(_0x27c054[0x0][_0x5dacbb(0x14c)]==_0x5dacbb(0x1ac))var _0xec8e42=users['Chinese'];else{if(_0x27c054[0x0][_0x5dacbb(0x14c)]=='Arabic\x20(ae)')var _0xec8e42=users[_0x5dacbb(0x120)];}}}}}}}_0x537ca8['render'](_0x5dacbb(0x143),{'success':_0x1ed9be[_0x5dacbb(0x1b7)](_0x5dacbb(0x134)),'errors':_0x1ed9be['flash'](_0x5dacbb(0x19f)),'role':_0x5c83a3,'profile':_0x5e57f8,'warehouse':_0x3323a7,'product':_0x1aada3,'adjustment':_0x27948f,'master_shop':_0x27c054,'language':_0xec8e42});}catch(_0x5efb81){console[_0x5dacbb(0x1c3)](_0x5efb81);}});async function getRandom8DigitNumber(){var _0xad4752=a0_0x110fa0;const _0x3d7626=0x989680,_0x4049f1=0x5f5e0ff,_0x348aad=Math[_0xad4752(0x1a6)](Math[_0xad4752(0x1ba)]()*(_0x4049f1-_0x3d7626+0x1))+_0x3d7626;var _0xf5d7c7;const _0x5d8a1e=await adjustment[_0xad4752(0x12e)]({'invoice':_0xad4752(0x16d)+_0x348aad});return _0x5d8a1e&&_0x5d8a1e[_0xad4752(0x179)]>0x0?_0xf5d7c7=_0xad4752(0x16d)+_0x348aad:_0xf5d7c7=_0xad4752(0x16d)+_0x348aad,_0xf5d7c7;}router[a0_0x110fa0(0x1b0)]('/view/add_adjustment',auth,async(_0x521b54,_0x2f5c1d)=>{var _0x4f6713=a0_0x110fa0;try{const {username:_0x48a95d,email:_0x104931,role:_0xc45d35}=_0x521b54[_0x4f6713(0x151)],_0x23b2d6=_0x521b54[_0x4f6713(0x151)],_0x37e59c=await profile[_0x4f6713(0x12e)]({'email':_0x23b2d6[_0x4f6713(0x1ae)]}),_0x15572b=await master_shop[_0x4f6713(0x13e)]();let _0x131797;if(_0x23b2d6['role']=='staff'){const _0x117779=await staff[_0x4f6713(0x12e)]({'email':_0x23b2d6[_0x4f6713(0x1ae)]});_0x131797=await warehouse[_0x4f6713(0x118)]([{'$match':{'status':'Enabled','name':_0x117779[_0x4f6713(0x1c6)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x4f6713(0x187)}}},{'$group':{'_id':_0x4f6713(0x103),'name':{'$first':'$name'}}}]);}else _0x131797=await warehouse[_0x4f6713(0x118)]([{'$match':{'status':_0x4f6713(0x17d),'warehouse_category':_0x4f6713(0x166),'name':{'$ne':_0x4f6713(0x187)}}},{'$group':{'_id':_0x4f6713(0x103),'name':{'$first':_0x4f6713(0x103)}}}]);const _0x5dd941=await product[_0x4f6713(0x13e)]({}),_0x489991=await adjustment['find']({}),_0x11d7b9=_0x489991['length']+0x1,_0x3bea41='ADJ-'+_0x11d7b9[_0x4f6713(0x170)]()[_0x4f6713(0x172)](0x5,'0');var _0x5a0137=[_0x4f6713(0x105),_0x4f6713(0x10b),_0x4f6713(0x171)];if(_0x15572b[0x0][_0x4f6713(0x14c)]=='English\x20(US)')var _0x3edb60=users[_0x4f6713(0x117)];else{if(_0x15572b[0x0]['language']==_0x4f6713(0x133))var _0x3edb60=users[_0x4f6713(0x133)];else{if(_0x15572b[0x0][_0x4f6713(0x14c)]==_0x4f6713(0x174))var _0x3edb60=users['German'];else{if(_0x15572b[0x0][_0x4f6713(0x14c)]=='Spanish')var _0x3edb60=users['Spanish'];else{if(_0x15572b[0x0][_0x4f6713(0x14c)]==_0x4f6713(0x16f))var _0x3edb60=users['French'];else{if(_0x15572b[0x0][_0x4f6713(0x14c)]==_0x4f6713(0x1cf))var _0x3edb60=users[_0x4f6713(0x17b)];else{if(_0x15572b[0x0][_0x4f6713(0x14c)]==_0x4f6713(0x1ac))var _0x3edb60=users[_0x4f6713(0x1ac)];else{if(_0x15572b[0x0]['language']==_0x4f6713(0x1af))var _0x3edb60=users[_0x4f6713(0x120)];}}}}}}}const _0x33fcb7=getRandom8DigitNumber();_0x33fcb7['then'](_0x33af5d=>{var _0x21f26c=_0x4f6713;_0x2f5c1d['render'](_0x21f26c(0x113),{'success':_0x521b54[_0x21f26c(0x1b7)](_0x21f26c(0x134)),'errors':_0x521b54[_0x21f26c(0x1b7)](_0x21f26c(0x19f)),'role':_0x23b2d6,'profile':_0x37e59c,'warehouse':_0x131797,'product':_0x5dd941,'master_shop':_0x15572b,'language':_0x3edb60,'rooms_data':_0x5a0137,'invoice_no':_0x33af5d});})[_0x4f6713(0x124)](_0x320b73=>{var _0x1b72bd=_0x4f6713;_0x521b54[_0x1b72bd(0x1b7)](_0x1b72bd(0x19f),_0x1b72bd(0x196)),_0x2f5c1d['redirect']('/adjustment/view');});}catch(_0x4e513b){console[_0x4f6713(0x1c3)](_0x4e513b);}}),router[a0_0x110fa0(0x1ab)]('/view/add_adjustment',auth,async(_0x131005,_0x4cb5ed)=>{var _0x5d45e1=a0_0x110fa0;try{const {warehouse_name:_0x3c101c,date:_0x4cf5a3,prod_name:_0x4047b4,level:_0x32b13e,isle:_0xc3c943,pallet:_0x2009b7,stock:_0x21e4da,types:_0x529552,adjust_qty:_0x19c129,new_adjust_qty:_0xed8d02,note:_0x2d239f,Room_name:_0x226280,invoice:_0x2f21bd,JO_number:_0x6b9663,expiry_date:_0x2f5dcc}=_0x131005[_0x5d45e1(0x181)];if(typeof _0x4047b4==_0x5d45e1(0x164))var _0x18c486=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x13a)]],_0x5f2c0b=[_0x131005['body'][_0x5d45e1(0x1d0)]],_0xb0ebe4=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x182)]],_0x4e4692=[_0x131005['body']['types']],_0xc53863=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1bf)]],_0x59eb01=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1b4)]],_0xac00f5=[_0x131005[_0x5d45e1(0x181)]['Primary_Units']],_0x4078c7=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x15a)]],_0x4cbd90=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1c8)]],_0x14d19e=[_0x131005['body'][_0x5d45e1(0x17c)]],_0x2e3617=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1a2)]],_0x308342=[_0x131005['body'][_0x5d45e1(0x10e)]],_0x245c82=[_0x131005['body']['production_date']],_0x57a6f9=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1d1)]],_0x51516b=[_0x131005[_0x5d45e1(0x181)]['Rooms']],_0x18d4f4=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x168)]],_0x37b7e7=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x16e)]],_0x573c6e=[_0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1b8)]];else var _0x18c486=[..._0x131005[_0x5d45e1(0x181)]['prod_name']],_0x5f2c0b=[..._0x131005['body'][_0x5d45e1(0x1d0)]],_0xb0ebe4=[..._0x131005['body'][_0x5d45e1(0x182)]],_0x4e4692=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x177)]],_0xc53863=[..._0x131005[_0x5d45e1(0x181)]['New_Qty_Converted_adj']],_0x59eb01=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1b4)]],_0xac00f5=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1a7)]],_0x4078c7=[..._0x131005['body'][_0x5d45e1(0x15a)]],_0x4cbd90=[..._0x131005[_0x5d45e1(0x181)]['prod_code']],_0x14d19e=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x17c)]],_0x2e3617=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1a2)]],_0x308342=[..._0x131005['body'][_0x5d45e1(0x10e)]],_0x245c82=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x165)]],_0x57a6f9=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1d1)]],_0x51516b=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x13f)]],_0x18d4f4=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x168)]],_0x37b7e7=[..._0x131005['body']['second1']],_0x573c6e=[..._0x131005[_0x5d45e1(0x181)][_0x5d45e1(0x1b8)]];const _0x181fb8=_0x18c486[_0x5d45e1(0x11a)](_0x515b9f=>{return _0x515b9f={'product_name':_0x515b9f};});_0x5f2c0b[_0x5d45e1(0x19c)]((_0x4b284a,_0x4ef4e8)=>{var _0x3f9f6f=_0x5d45e1;_0x51516b[_0x3f9f6f(0x19c)]((_0x555169,_0x22e254)=>{var _0x1221bd=_0x3f9f6f;if(_0x555169==_0x1221bd(0x1c4)&&_0x4ef4e8==_0x22e254){var _0x1ad0eb=_0x4b284a[_0x1221bd(0x152)](0x3);_0x181fb8[_0x4ef4e8][_0x1221bd(0x19e)]=_0x4b284a[0x0],_0x181fb8[_0x4ef4e8][_0x1221bd(0x16c)]=_0x4b284a[0x1],_0x181fb8[_0x4ef4e8][_0x1221bd(0x138)]=0x0,_0x181fb8[_0x4ef4e8][_0x1221bd(0x1cd)]=0x0,_0x181fb8[_0x4ef4e8]['type']=_0x1221bd(0x1cb),_0x181fb8[_0x4ef4e8][_0x1221bd(0x102)]=_0x1ad0eb;}else{if(_0x555169=='Shelves'&&_0x4ef4e8==_0x22e254){var _0x1ad0eb=_0x4b284a['slice'](0x3);_0x181fb8[_0x4ef4e8]['storage']=_0x4b284a[0x0],_0x181fb8[_0x4ef4e8][_0x1221bd(0x16c)]=_0x4b284a[0x1],_0x181fb8[_0x4ef4e8][_0x1221bd(0x138)]=0x0,_0x181fb8[_0x4ef4e8][_0x1221bd(0x1cd)]=0x0,_0x181fb8[_0x4ef4e8][_0x1221bd(0x1b5)]=_0x1221bd(0x1cb),_0x181fb8[_0x4ef4e8][_0x1221bd(0x102)]=_0x4b284a[0x5];}else{if(_0x4ef4e8==_0x22e254){var _0x39f174;if(_0x4b284a[0x4]=='L')_0x39f174=_0x1221bd(0x161);else _0x4b284a[0x4]=='F'&&(_0x39f174=_0x1221bd(0x1cb));_0x181fb8[_0x4ef4e8]['storage']=_0x4b284a[0x0],_0x181fb8[_0x4ef4e8][_0x1221bd(0x16c)]=_0x4b284a[0x1],_0x181fb8[_0x4ef4e8][_0x1221bd(0x138)]=_0x4b284a[0x2],_0x181fb8[_0x4ef4e8][_0x1221bd(0x1cd)]=_0x4b284a[0x3],_0x181fb8[_0x4ef4e8][_0x1221bd(0x1b5)]=_0x39f174,_0x181fb8[_0x4ef4e8][_0x1221bd(0x102)]=_0x4b284a[0x5];}}}});}),_0xb0ebe4[_0x5d45e1(0x19c)]((_0x217259,_0x44b4b5)=>{var _0x5266b4=_0x5d45e1;_0x181fb8[_0x44b4b5][_0x5266b4(0x15d)]=_0x217259;}),_0x4e4692['forEach']((_0x1b809e,_0x21ccd0)=>{var _0x4ebc42=_0x5d45e1;_0x181fb8[_0x21ccd0][_0x4ebc42(0x177)]=_0x1b809e;}),_0xc53863['forEach']((_0x5e1196,_0x5b645e)=>{var _0x52a207=_0x5d45e1;_0x181fb8[_0x5b645e][_0x52a207(0x154)]=_0x5e1196;}),_0x59eb01[_0x5d45e1(0x19c)]((_0x53c872,_0x9f3176)=>{var _0x11dc19=_0x5d45e1;_0x181fb8[_0x9f3176][_0x11dc19(0x150)]=_0x53c872;}),_0xac00f5[_0x5d45e1(0x19c)]((_0x4acc8e,_0x42f354)=>{var _0x12127b=_0x5d45e1;_0x181fb8[_0x42f354][_0x12127b(0x1a7)]=_0x4acc8e;}),_0x4078c7[_0x5d45e1(0x19c)]((_0xdac37e,_0x52f662)=>{_0x181fb8[_0x52f662]['secondary_unit']=_0xdac37e;}),_0x4cbd90[_0x5d45e1(0x19c)]((_0x12c3ec,_0x329b46)=>{_0x181fb8[_0x329b46]['product_code']=_0x12c3ec;}),_0x14d19e[_0x5d45e1(0x19c)]((_0x2e9c13,_0x285585)=>{_0x181fb8[_0x285585]['batch_code']=_0x2e9c13;}),_0x2e3617[_0x5d45e1(0x19c)]((_0x3fde60,_0x262605)=>{var _0x34d9a8=_0x5d45e1;_0x181fb8[_0x262605][_0x34d9a8(0x1a2)]=_0x3fde60;}),_0x308342[_0x5d45e1(0x19c)]((_0x720c2,_0x451dcf)=>{var _0x45fe8d=_0x5d45e1;_0x181fb8[_0x451dcf][_0x45fe8d(0x139)]=_0x720c2;}),_0x245c82[_0x5d45e1(0x19c)]((_0x5bfffd,_0x5e8eb7)=>{var _0x213d54=_0x5d45e1;_0x181fb8[_0x5e8eb7][_0x213d54(0x165)]=_0x5bfffd;}),_0x57a6f9['forEach']((_0x509dae,_0x4ff93d)=>{_0x181fb8[_0x4ff93d]['prod_cat']=_0x509dae;}),_0x51516b[_0x5d45e1(0x19c)]((_0x3a811f,_0x7864a9)=>{var _0x35daa6=_0x5d45e1;_0x181fb8[_0x7864a9][_0x35daa6(0x123)]=_0x3a811f;}),_0x18d4f4['forEach']((_0x5858dd,_0x3c84d6)=>{_0x181fb8[_0x3c84d6]['primary_code']=_0x5858dd;}),_0x37b7e7[_0x5d45e1(0x19c)]((_0x209835,_0x56009f)=>{_0x181fb8[_0x56009f]['secondary_code']=_0x209835;}),_0x573c6e[_0x5d45e1(0x19c)]((_0x5a7349,_0x16c47d)=>{_0x181fb8[_0x16c47d]['invoice']=_0x5a7349;});const _0x4243bc=_0x181fb8[_0x5d45e1(0x14a)](_0x27da47=>_0x27da47[_0x5d45e1(0x154)]!=='0'&&_0x27da47['adjust_qty']!=='');var _0x25cf67=0x0;_0x4243bc[_0x5d45e1(0x19c)](_0x3c7960=>{var _0x21f917=_0x5d45e1;console[_0x21f917(0x1c3)](_0x21f917(0x19a),_0x3c7960),parseInt(_0x3c7960[_0x21f917(0x154)])<=0x0&&_0x25cf67++;});if(_0x25cf67!=0x0)return _0x131005[_0x5d45e1(0x1b7)](_0x5d45e1(0x19f),_0x5d45e1(0x18e)),_0x4cb5ed['redirect'](_0x5d45e1(0x13b));const _0x46c7d0=new adjustment({'warehouse_name':_0x3c101c,'date':_0x4cf5a3,'product':_0x4243bc,'note':_0x2d239f,'room':_0x226280,'invoice':_0x2f21bd,'JO_number':_0x6b9663,'expiry_date':_0x2f5dcc}),_0xe6fc9=await _0x46c7d0['save']();_0x131005['flash'](_0x5d45e1(0x134),_0x5d45e1(0x11b)),_0x4cb5ed[_0x5d45e1(0x111)]('/adjustment/preview/'+_0xe6fc9[_0x5d45e1(0x144)]);}catch(_0x46194d){console[_0x5d45e1(0x1c3)](_0x46194d),_0x4cb5ed[_0x5d45e1(0x14b)](0xc8)[_0x5d45e1(0x153)]({'message':_0x46194d[_0x5d45e1(0x19b)]});}}),router['get'](a0_0x110fa0(0x178),auth,async(_0x4ce7f8,_0x122e74)=>{var _0x5e9dd2=a0_0x110fa0;try{const {username:_0x5ddcd6,email:_0x5e0fa5,role:_0x23d65d}=_0x4ce7f8[_0x5e9dd2(0x151)],_0x5480b3=_0x4ce7f8['user'],_0xf0063=await profile['findOne']({'email':_0x5480b3[_0x5e9dd2(0x1ae)]}),_0x54a7a6=await master_shop[_0x5e9dd2(0x13e)](),_0x43177b=_0x4ce7f8['params']['id'],_0x4244a1=await adjustment[_0x5e9dd2(0x131)]({'_id':_0x43177b}),_0x5af2dc=await purchases[_0x5e9dd2(0x118)]([{'$match':{'warehouse_name':_0x4244a1[_0x5e9dd2(0x1a3)]}},{'$unwind':_0x5e9dd2(0x141)},{'$group':{'_id':_0x5e9dd2(0x15c)}}]),_0x336bae=await product['find']({}),_0x13f272=await warehouse[_0x5e9dd2(0x118)]([{'$match':{'name':_0x4244a1[_0x5e9dd2(0x1a3)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5e9dd2(0x195),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5e9dd2(0x15e)},'bay':{'$first':_0x5e9dd2(0x175)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5e9dd2(0x11f)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x5e9dd2(0x169)},'secondary_code':{'$first':_0x5e9dd2(0x116)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5e9dd2(0x125)},'rack':{'$first':_0x5e9dd2(0x12a)},'maxPerUnit':{'$first':_0x5e9dd2(0x14d)},'expiry_date':{'$first':_0x5e9dd2(0x132)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x5e9dd2(0x10f)}}}]);if(_0x54a7a6[0x0][_0x5e9dd2(0x14c)]==_0x5e9dd2(0x155)){var _0x3ad1a7=users['English'];console[_0x5e9dd2(0x1c3)](_0x3ad1a7);}else{if(_0x54a7a6[0x0]['language']=='Hindi')var _0x3ad1a7=users[_0x5e9dd2(0x133)];else{if(_0x54a7a6[0x0]['language']=='German')var _0x3ad1a7=users[_0x5e9dd2(0x174)];else{if(_0x54a7a6[0x0][_0x5e9dd2(0x14c)]==_0x5e9dd2(0x121))var _0x3ad1a7=users[_0x5e9dd2(0x121)];else{if(_0x54a7a6[0x0][_0x5e9dd2(0x14c)]==_0x5e9dd2(0x16f))var _0x3ad1a7=users[_0x5e9dd2(0x16f)];else{if(_0x54a7a6[0x0][_0x5e9dd2(0x14c)]=='Portuguese\x20(BR)')var _0x3ad1a7=users['Portuguese'];else{if(_0x54a7a6[0x0][_0x5e9dd2(0x14c)]==_0x5e9dd2(0x1ac))var _0x3ad1a7=users[_0x5e9dd2(0x1ac)];else{if(_0x54a7a6[0x0][_0x5e9dd2(0x14c)]==_0x5e9dd2(0x1af))var _0x3ad1a7=users[_0x5e9dd2(0x120)];}}}}}}}_0x122e74[_0x5e9dd2(0x1ad)](_0x5e9dd2(0x163),{'success':_0x4ce7f8['flash']('success'),'errors':_0x4ce7f8[_0x5e9dd2(0x1b7)](_0x5e9dd2(0x19f)),'role':_0x5480b3,'profile':_0xf0063,'adjustment':_0x4244a1,'stock':_0x13f272,'master_shop':_0x54a7a6,'warehouse_name':_0x5af2dc,'unit':_0x336bae,'language':_0x3ad1a7});}catch(_0x4cdce1){console[_0x5e9dd2(0x1c3)](_0x4cdce1),_0x122e74[_0x5e9dd2(0x14b)](0xc8)[_0x5e9dd2(0x153)]({'message':_0x4cdce1[_0x5e9dd2(0x19b)]});}}),router['post'](a0_0x110fa0(0x178),auth,async(_0x1f1b59,_0x50b6bd)=>{var _0x3579a0=a0_0x110fa0;try{const _0x1a41ae=_0x1f1b59['params']['id'],{warehouse_name:_0x36c294,Room_name:_0x524e78}=_0x1f1b59[_0x3579a0(0x181)],_0x59d2ac=await adjustment[_0x3579a0(0x131)]({'_id':_0x1a41ae}),_0x4e53cb=_0x59d2ac[_0x3579a0(0x122)][_0x3579a0(0x11a)](async _0x237ac4=>{var _0x3f3ecc=_0x3579a0;if(_0x237ac4[_0x3f3ecc(0x154)]>0x0){var _0x430ce7=await warehouse[_0x3f3ecc(0x12e)]({'name':_0x36c294,'room':_0x237ac4[_0x3f3ecc(0x123)],'warehouse_category':'Raw\x20Materials'});const _0x199eae=_0x430ce7[_0x3f3ecc(0x12f)][_0x3f3ecc(0x11a)](_0x32da76=>{var _0x340370=_0x3f3ecc;if(_0x237ac4[_0x340370(0x1b5)]==_0x340370(0x1c7)){if(_0x32da76['product_name']==_0x237ac4['product_name']&&_0x32da76[_0x340370(0x102)]==_0x237ac4[_0x340370(0x102)]&&_0x32da76['type']==_0x237ac4[_0x340370(0x1b5)]&&_0x32da76['bin']==_0x237ac4[_0x340370(0x1cd)]&&_0x32da76[_0x340370(0x138)]==_0x237ac4[_0x340370(0x138)]&&_0x32da76[_0x340370(0x16c)]==_0x237ac4['rack']&&_0x32da76['storage']==_0x237ac4[_0x340370(0x19e)]&&_0x32da76[_0x340370(0x1a2)]==_0x237ac4[_0x340370(0x1a2)]&&_0x32da76[_0x340370(0x17c)]==_0x237ac4[_0x340370(0x17c)]&&_0x32da76['production_date']==_0x237ac4[_0x340370(0x165)]&&_0x32da76[_0x340370(0x199)]==_0x237ac4[_0x340370(0x199)]){var _0x3db381;_0x3db381=_0x237ac4[_0x340370(0x154)],_0x237ac4['prod_cat']=='S'&&(_0x3db381=_0x237ac4[_0x340370(0x154)]),_0x32da76[_0x340370(0x1b1)]=_0x32da76[_0x340370(0x1b1)]-_0x3db381;}}else{if(_0x32da76[_0x340370(0x191)]==_0x237ac4[_0x340370(0x191)]&&_0x32da76[_0x340370(0x102)]==_0x237ac4[_0x340370(0x102)]&&_0x32da76[_0x340370(0x1b5)]==_0x237ac4[_0x340370(0x1b5)]&&_0x32da76[_0x340370(0x1cd)]==_0x237ac4[_0x340370(0x1cd)]&&_0x32da76['bay']==_0x237ac4[_0x340370(0x138)]&&_0x32da76[_0x340370(0x16c)]==_0x237ac4[_0x340370(0x16c)]&&_0x32da76[_0x340370(0x19e)]==_0x237ac4[_0x340370(0x19e)]&&_0x32da76[_0x340370(0x1a2)]==_0x237ac4[_0x340370(0x1a2)]&&_0x32da76[_0x340370(0x17c)]==_0x237ac4[_0x340370(0x17c)]&&_0x32da76['production_date']==_0x237ac4[_0x340370(0x165)]&&_0x32da76['invoice']==_0x237ac4[_0x340370(0x199)]){console[_0x340370(0x1c3)](_0x237ac4);var _0x3db381;_0x3db381=_0x237ac4['adjust_qty'],_0x237ac4['prod_cat']=='S'&&(_0x3db381=_0x237ac4[_0x340370(0x154)]),console['log'](_0x3db381+_0x340370(0x11d)+_0x237ac4['adjust_qty']+_0x340370(0x11d)+_0x32da76['maxPerUnit']+_0x340370(0x11d)+_0x237ac4[_0x340370(0x1d1)]),_0x32da76[_0x340370(0x1b1)]=_0x32da76[_0x340370(0x1b1)]+_0x3db381;}}});}return _0x430ce7;});Promise[_0x3579a0(0x185)](_0x4e53cb)[_0x3579a0(0x108)](async _0x8c370c=>{var _0x1258c9=_0x3579a0;try{for(const _0x89d0d9 of _0x8c370c){await _0x89d0d9[_0x1258c9(0x115)]();}_0x59d2ac['finalize']=_0x1258c9(0x1a0);const _0x553442=await _0x59d2ac[_0x1258c9(0x115)](),_0x10da00=await master_shop[_0x1258c9(0x13e)](),_0x52a247=await email_settings[_0x1258c9(0x12e)](),_0x1ca257=await supervisor_settings[_0x1258c9(0x13e)]();var _0x125910=_0x59d2ac[_0x1258c9(0x122)],_0x304e98='',_0x5c3f4e;for(_0x5c3f4e in _0x125910){_0x304e98+=_0x1258c9(0x106)+_0x1258c9(0x10d)+_0x125910[_0x5c3f4e][_0x1258c9(0x191)]+'</td>'+_0x1258c9(0x10d)+_0x125910[_0x5c3f4e][_0x1258c9(0x1ce)]+_0x1258c9(0x14e)+_0x1258c9(0x10d)+_0x125910[_0x5c3f4e][_0x1258c9(0x154)]+_0x1258c9(0x14e)+_0x1258c9(0x10d)+_0x125910[_0x5c3f4e][_0x1258c9(0x1a7)]+_0x1258c9(0x14e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x125910[_0x5c3f4e][_0x1258c9(0x104)]+_0x1258c9(0x14e)+_0x1258c9(0x10d)+_0x59d2ac['warehouse_name']+'</td>'+_0x1258c9(0x10d)+_0x125910[_0x5c3f4e][_0x1258c9(0x123)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x125910[_0x5c3f4e][_0x1258c9(0x19e)]+_0x125910[_0x5c3f4e][_0x1258c9(0x16c)]+_0x125910[_0x5c3f4e][_0x1258c9(0x138)]+_0x125910[_0x5c3f4e][_0x1258c9(0x1cd)]+_0x125910[_0x5c3f4e][_0x1258c9(0x1b5)][0x0]+_0x125910[_0x5c3f4e]['floorlevel']+'</td>',_0x1258c9(0x10a);}let _0x42a0e7=nodemailer['createTransport']({'host':_0x52a247[_0x1258c9(0x1c0)],'port':Number(_0x52a247[_0x1258c9(0x15b)]),'secure':![],'auth':{'user':_0x52a247[_0x1258c9(0x1ae)],'pass':_0x52a247[_0x1258c9(0x110)]}}),_0x3de9d2={'from':_0x52a247['email'],'to':_0x1ca257[0x0]['RMSEmail'],'subject':_0x1258c9(0x19d),'attachments':[{'filename':_0x1258c9(0x1a1),'path':__dirname+'/../public'+_0x1258c9(0x14f)+_0x10da00[0x0][_0x1258c9(0x126)],'cid':_0x1258c9(0x192)}],'html':_0x1258c9(0x173)+'<html><head><title></title>'+_0x1258c9(0x1bd)+'<div>'+_0x1258c9(0x136)+_0x1258c9(0x146)+_0x1258c9(0x148)+_0x1258c9(0x1ca)+_0x1258c9(0x146)+_0x1258c9(0x1aa)+_0x10da00[0x0][_0x1258c9(0x18f)]+_0x1258c9(0x107)+_0x1258c9(0x1ca)+_0x1258c9(0x1ca)+'<hr\x20class=\x22my-3\x22>'+_0x1258c9(0x146)+_0x1258c9(0x128)+_0x1258c9(0x183)+_0x59d2ac[_0x1258c9(0x199)]+'\x20'+_0x1258c9(0x17f)+'\x20Order\x20Date\x20:\x20'+_0x59d2ac[_0x1258c9(0x1c9)]+'\x20'+_0x1258c9(0x1a9)+'</h5>'+_0x1258c9(0x1ca)+_0x1258c9(0x147)+_0x1258c9(0x1b9)+_0x1258c9(0x106)+_0x1258c9(0x130)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x1258c9(0x11c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x1258c9(0x1a5)+_0x1258c9(0x10c)+_0x1258c9(0x10a)+'</thead>'+_0x1258c9(0x157)+'\x20'+_0x304e98+'\x20'+_0x1258c9(0x129)+_0x1258c9(0x1b6)+_0x1258c9(0x146)+'<strong>\x20Regards\x20</strong>'+_0x1258c9(0x17a)+_0x10da00[0x0][_0x1258c9(0x18f)]+'</h5>'+_0x1258c9(0x1ca)+_0x1258c9(0x1ca)+_0x1258c9(0x12d)};_0x42a0e7[_0x1258c9(0x176)](_0x3de9d2,function(_0x5933bb,_0x3cb542){var _0x160f81=_0x1258c9;_0x5933bb?(console[_0x160f81(0x1c3)](_0x5933bb),console[_0x160f81(0x1c3)](_0x160f81(0x149))):console[_0x160f81(0x1c3)](_0x160f81(0x11e));}),_0x1f1b59[_0x1258c9(0x1b7)]('success',_0x1258c9(0x194)),_0x50b6bd[_0x1258c9(0x111)](_0x1258c9(0x101)+_0x553442[_0x1258c9(0x144)]);}catch(_0xbbded5){console[_0x1258c9(0x12b)](_0xbbded5),_0x50b6bd['status'](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x3579a0(0x124)](_0x1b4c6d=>{var _0xc3da84=_0x3579a0;console[_0xc3da84(0x12b)](_0x1b4c6d),_0x50b6bd[_0xc3da84(0x14b)](0x1f4)[_0xc3da84(0x153)]({'error':_0xc3da84(0x1bb)});});}catch(_0x1e023c){console[_0x3579a0(0x1c3)](_0x1e023c),_0x50b6bd['status'](0xc8)['json']({'message':_0x1e023c[_0x3579a0(0x19b)]});}}),router['get']('/view/:id',auth,async(_0x5ad4b4,_0x50100e)=>{var _0x1d05a3=a0_0x110fa0;try{const {username:_0x5c4b10,email:_0x2e5e97,role:_0x24e649}=_0x5ad4b4[_0x1d05a3(0x151)],_0x1f2b2e=_0x5ad4b4[_0x1d05a3(0x151)],_0x12827a=await profile[_0x1d05a3(0x12e)]({'email':_0x1f2b2e[_0x1d05a3(0x1ae)]}),_0x5e988f=await master_shop[_0x1d05a3(0x13e)](),_0x4563d7=_0x5ad4b4[_0x1d05a3(0x127)]['id'],_0x47f29b=await adjustment[_0x1d05a3(0x131)]({'_id':_0x4563d7}),_0x536b8a=await purchases['aggregate']([{'$match':{'warehouse_name':_0x47f29b[_0x1d05a3(0x1a3)]}},{'$unwind':_0x1d05a3(0x141)},{'$group':{'_id':_0x1d05a3(0x15c)}}]),_0x46124f=await product['find']({}),_0xa69456=await warehouse['aggregate']([{'$match':{'name':_0x47f29b[_0x1d05a3(0x1a3)]}},{'$unwind':_0x1d05a3(0x159)},{'$group':{'_id':_0x1d05a3(0x195),'name':{'$first':_0x1d05a3(0x18d)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1d05a3(0x175)},'bin':{'$first':_0x1d05a3(0x1bc)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1d05a3(0x169)},'secondary_code':{'$first':_0x1d05a3(0x116)},'product_code':{'$first':_0x1d05a3(0x140)},'storage':{'$first':_0x1d05a3(0x125)},'rack':{'$first':_0x1d05a3(0x12a)},'maxPerUnit':{'$first':_0x1d05a3(0x14d)},'expiry_date':{'$first':_0x1d05a3(0x132)},'production_date':{'$first':_0x1d05a3(0x18c)},'batch_code':{'$first':_0x1d05a3(0x160)},'room':{'$first':_0x1d05a3(0x10f)}}}]);let _0xa568e4;if(_0x1f2b2e[_0x1d05a3(0x112)]==_0x1d05a3(0x180)){const _0x1193c0=await staff[_0x1d05a3(0x12e)]({'email':_0x1f2b2e[_0x1d05a3(0x1ae)]});_0xa568e4=await warehouse['aggregate']([{'$match':{'status':_0x1d05a3(0x17d),'name':_0x1193c0[_0x1d05a3(0x1c6)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x1d05a3(0x103),'name':{'$first':_0x1d05a3(0x103)}}}]);}else _0xa568e4=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x1d05a3(0x166),'name':{'$ne':_0x1d05a3(0x187)}}},{'$group':{'_id':_0x1d05a3(0x103),'name':{'$first':_0x1d05a3(0x103)}}}]);if(_0x5e988f[0x0][_0x1d05a3(0x14c)]=='English\x20(US)'){var _0x1e32d8=users[_0x1d05a3(0x117)];console[_0x1d05a3(0x1c3)](_0x1e32d8);}else{if(_0x5e988f[0x0][_0x1d05a3(0x14c)]==_0x1d05a3(0x133))var _0x1e32d8=users[_0x1d05a3(0x133)];else{if(_0x5e988f[0x0][_0x1d05a3(0x14c)]==_0x1d05a3(0x174))var _0x1e32d8=users[_0x1d05a3(0x174)];else{if(_0x5e988f[0x0][_0x1d05a3(0x14c)]=='Spanish')var _0x1e32d8=users[_0x1d05a3(0x121)];else{if(_0x5e988f[0x0][_0x1d05a3(0x14c)]=='French')var _0x1e32d8=users['French'];else{if(_0x5e988f[0x0]['language']==_0x1d05a3(0x1cf))var _0x1e32d8=users['Portuguese'];else{if(_0x5e988f[0x0]['language']==_0x1d05a3(0x1ac))var _0x1e32d8=users[_0x1d05a3(0x1ac)];else{if(_0x5e988f[0x0][_0x1d05a3(0x14c)]=='Arabic\x20(ae)')var _0x1e32d8=users[_0x1d05a3(0x120)];}}}}}}}_0x50100e[_0x1d05a3(0x1ad)](_0x1d05a3(0x114),{'success':_0x5ad4b4[_0x1d05a3(0x1b7)](_0x1d05a3(0x134)),'errors':_0x5ad4b4['flash']('errors'),'role':_0x1f2b2e,'profile':_0x12827a,'adjustment':_0x47f29b,'stock':_0xa69456,'master_shop':_0x5e988f,'warehouse_name':_0x536b8a,'unit':_0x46124f,'language':_0x1e32d8,'warehouse':_0xa568e4});}catch(_0x131401){console[_0x1d05a3(0x1c3)](_0x131401),_0x50100e[_0x1d05a3(0x14b)](0xc8)[_0x1d05a3(0x153)]({'message':_0x131401[_0x1d05a3(0x19b)]});}}),router[a0_0x110fa0(0x1ab)](a0_0x110fa0(0x145),auth,async(_0x443269,_0x317af8)=>{var _0x1cc6cc=a0_0x110fa0;try{const _0x1145a3=_0x443269['params']['id'],_0x550c01=await adjustment['findById']({'_id':_0x1145a3}),_0x19070b=await warehouse[_0x1cc6cc(0x12e)]({'name':_0x550c01[_0x1cc6cc(0x1a3)],'room':_0x550c01[_0x1cc6cc(0x158)]}),{warehouse_name:_0x194ac3,date:_0x11055c,prod_name:_0x272af7,level:_0x1b4c86,isle:_0x58afc6,pallet:_0x1e1e0e,stock:_0x4ae003,types:_0x11b036,adjust_qty:_0x34f3cd,new_adjust_qty:_0x36717a,note:_0x26d3b8,Room_name:_0x31d6c3,invoice:_0x4c8c7a,JO_number:_0x16190d,expiry_date:_0x1a2a9a}=_0x443269['body'];if(typeof _0x272af7==_0x1cc6cc(0x164))var _0x273dc2=[_0x443269['body'][_0x1cc6cc(0x13a)]],_0x6ce007=[_0x443269['body']['level']],_0x3c0ab1=[_0x443269[_0x1cc6cc(0x181)]['stock']],_0x4c1e7e=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x177)]],_0x20acc1=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1bf)]],_0x333131=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1b4)]],_0x17c94f=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x18a)]],_0x4c5ad0=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x15a)]],_0x3089f7=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1c8)]],_0x101ab1=[_0x443269[_0x1cc6cc(0x181)]['batch_code']],_0x5f4c29=[_0x443269['body']['expiry_date']],_0x350c4f=[_0x443269['body'][_0x1cc6cc(0x10e)]],_0x49956b=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x165)]],_0x5b6d0d=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1d1)]],_0x297cc1=[_0x443269['body']['Rooms']],_0x220fa7=[_0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x168)]],_0x42057f=[_0x443269['body'][_0x1cc6cc(0x16e)]];else var _0x273dc2=[..._0x443269['body'][_0x1cc6cc(0x13a)]],_0x6ce007=[..._0x443269[_0x1cc6cc(0x181)]['level']],_0x3c0ab1=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x182)]],_0x4c1e7e=[..._0x443269['body'][_0x1cc6cc(0x177)]],_0x20acc1=[..._0x443269['body'][_0x1cc6cc(0x1bf)]],_0x333131=[..._0x443269[_0x1cc6cc(0x181)]['New_Qty_Converted']],_0x17c94f=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1a7)]],_0x4c5ad0=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x15a)]],_0x3089f7=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1c8)]],_0x101ab1=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x17c)]],_0x5f4c29=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1a2)]],_0x350c4f=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x10e)]],_0x49956b=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x165)]],_0x5b6d0d=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x1d1)]],_0x297cc1=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x13f)]],_0x220fa7=[..._0x443269[_0x1cc6cc(0x181)]['prime1']],_0x42057f=[..._0x443269[_0x1cc6cc(0x181)][_0x1cc6cc(0x16e)]];const _0x5583e9=_0x273dc2[_0x1cc6cc(0x11a)](_0x149386=>{return _0x149386={'product_name':_0x149386};});_0x6ce007[_0x1cc6cc(0x19c)]((_0x53c04c,_0x4fd791)=>{var _0xfbddc7=_0x1cc6cc;_0x297cc1[_0xfbddc7(0x19c)]((_0x3ee2a0,_0x8c3782)=>{var _0x2f9c79=_0xfbddc7;if(_0x3ee2a0==_0x2f9c79(0x1c4)&&_0x4fd791==_0x8c3782){var _0x5d8881=_0x53c04c[_0x2f9c79(0x152)](0x3);_0x5583e9[_0x4fd791][_0x2f9c79(0x19e)]=_0x53c04c[0x0],_0x5583e9[_0x4fd791][_0x2f9c79(0x16c)]=_0x53c04c[0x1],_0x5583e9[_0x4fd791][_0x2f9c79(0x138)]=0x0,_0x5583e9[_0x4fd791][_0x2f9c79(0x1cd)]=0x0,_0x5583e9[_0x4fd791][_0x2f9c79(0x1b5)]='Floor',_0x5583e9[_0x4fd791][_0x2f9c79(0x102)]=_0x5d8881;}else{if(_0x3ee2a0==_0x2f9c79(0x18b)&&_0x4fd791==_0x8c3782){var _0x5d8881=_0x53c04c[_0x2f9c79(0x152)](0x3);_0x5583e9[_0x4fd791][_0x2f9c79(0x19e)]=_0x53c04c[0x0],_0x5583e9[_0x4fd791]['rack']=_0x53c04c[0x1],_0x5583e9[_0x4fd791][_0x2f9c79(0x138)]=0x0,_0x5583e9[_0x4fd791][_0x2f9c79(0x1cd)]=0x0,_0x5583e9[_0x4fd791][_0x2f9c79(0x1b5)]=_0x2f9c79(0x1cb),_0x5583e9[_0x4fd791][_0x2f9c79(0x102)]=_0x53c04c[0x5];}else{if(_0x4fd791==_0x8c3782){var _0x4f03f7;if(_0x53c04c[0x4]=='L')_0x4f03f7=_0x2f9c79(0x161);else _0x53c04c[0x4]=='F'&&(_0x4f03f7=_0x2f9c79(0x1cb));_0x5583e9[_0x4fd791][_0x2f9c79(0x19e)]=_0x53c04c[0x0],_0x5583e9[_0x4fd791][_0x2f9c79(0x16c)]=_0x53c04c[0x1],_0x5583e9[_0x4fd791][_0x2f9c79(0x138)]=_0x53c04c[0x2],_0x5583e9[_0x4fd791][_0x2f9c79(0x1cd)]=_0x53c04c[0x3],_0x5583e9[_0x4fd791][_0x2f9c79(0x1b5)]=_0x4f03f7,_0x5583e9[_0x4fd791]['floorlevel']=_0x53c04c[0x5];}}}});}),_0x3c0ab1['forEach']((_0x44334b,_0x5b0f2b)=>{var _0x25819e=_0x1cc6cc;_0x5583e9[_0x5b0f2b][_0x25819e(0x15d)]=_0x44334b;}),_0x4c1e7e[_0x1cc6cc(0x19c)]((_0x498958,_0x82a5a6)=>{var _0x639b51=_0x1cc6cc;_0x5583e9[_0x82a5a6][_0x639b51(0x177)]=_0x498958;}),_0x20acc1[_0x1cc6cc(0x19c)]((_0x22da60,_0x52d8b8)=>{var _0xad9041=_0x1cc6cc;_0x5583e9[_0x52d8b8][_0xad9041(0x154)]=_0x22da60;}),_0x333131[_0x1cc6cc(0x19c)]((_0x525861,_0x4bfcfe)=>{var _0x5e6bcc=_0x1cc6cc;_0x5583e9[_0x4bfcfe][_0x5e6bcc(0x150)]=_0x525861;}),_0x17c94f[_0x1cc6cc(0x19c)]((_0x5e54b7,_0x434df3)=>{var _0x3216ef=_0x1cc6cc;_0x5583e9[_0x434df3][_0x3216ef(0x1a7)]=_0x5e54b7;}),_0x4c5ad0[_0x1cc6cc(0x19c)]((_0x2f5f7c,_0x26e62c)=>{var _0x1022ef=_0x1cc6cc;_0x5583e9[_0x26e62c][_0x1022ef(0x104)]=_0x2f5f7c;}),_0x3089f7['forEach']((_0x1f33c3,_0x5039df)=>{var _0x3bff3a=_0x1cc6cc;_0x5583e9[_0x5039df][_0x3bff3a(0x1ce)]=_0x1f33c3;}),_0x101ab1[_0x1cc6cc(0x19c)]((_0x451e00,_0x2ba9f4)=>{var _0x4cefc5=_0x1cc6cc;_0x5583e9[_0x2ba9f4][_0x4cefc5(0x17c)]=_0x451e00;}),_0x5f4c29[_0x1cc6cc(0x19c)]((_0x5af0a4,_0x47eeec)=>{_0x5583e9[_0x47eeec]['expiry_date']=_0x5af0a4;}),_0x350c4f[_0x1cc6cc(0x19c)]((_0x778719,_0x3b705f)=>{_0x5583e9[_0x3b705f]['maxperunit']=_0x778719;}),_0x49956b[_0x1cc6cc(0x19c)]((_0x14a6ec,_0x4bbc18)=>{var _0x30ea06=_0x1cc6cc;_0x5583e9[_0x4bbc18][_0x30ea06(0x165)]=_0x14a6ec;}),_0x5b6d0d[_0x1cc6cc(0x19c)]((_0x1063ca,_0x3eb0dc)=>{var _0x4ce293=_0x1cc6cc;_0x5583e9[_0x3eb0dc][_0x4ce293(0x1d1)]=_0x1063ca;}),_0x297cc1['forEach']((_0x483f5f,_0x2d4285)=>{var _0xaee355=_0x1cc6cc;_0x5583e9[_0x2d4285][_0xaee355(0x123)]=_0x483f5f;}),_0x220fa7[_0x1cc6cc(0x19c)]((_0x29d61c,_0x1ae894)=>{var _0x552b73=_0x1cc6cc;_0x5583e9[_0x1ae894][_0x552b73(0x189)]=_0x29d61c;}),_0x42057f[_0x1cc6cc(0x19c)]((_0x2fb318,_0x2bd0eb)=>{var _0x577fe8=_0x1cc6cc;_0x5583e9[_0x2bd0eb][_0x577fe8(0x12c)]=_0x2fb318;});const _0x31a515=_0x5583e9[_0x1cc6cc(0x14a)](_0x1cc467=>_0x1cc467[_0x1cc6cc(0x154)]!=='0'&&_0x1cc467[_0x1cc6cc(0x154)]!=='');var _0x3cbf72=0x0;_0x31a515[_0x1cc6cc(0x19c)](_0x5ac1b3=>{var _0x21b407=_0x1cc6cc;console[_0x21b407(0x1c3)](_0x21b407(0x19a),_0x5ac1b3),parseInt(_0x5ac1b3['adjust_qty'])<=0x0&&_0x3cbf72++;});if(_0x3cbf72!=0x0)return _0x443269[_0x1cc6cc(0x1b7)](_0x1cc6cc(0x19f),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x317af8[_0x1cc6cc(0x111)]('back');_0x550c01[_0x1cc6cc(0x1a3)]=_0x194ac3,_0x550c01[_0x1cc6cc(0x1c9)]=_0x11055c,_0x550c01[_0x1cc6cc(0x122)]=_0x31a515,_0x550c01['note']=_0x26d3b8,_0x550c01[_0x1cc6cc(0x199)]=_0x4c8c7a,_0x550c01[_0x1cc6cc(0x167)]=_0x1cc6cc(0x15f);const _0x44beec=await _0x550c01[_0x1cc6cc(0x115)]();_0x443269[_0x1cc6cc(0x1b7)]('success',_0x1cc6cc(0x137)),_0x317af8[_0x1cc6cc(0x111)](_0x1cc6cc(0x1a4));}catch(_0x30cf74){console['log'](_0x30cf74);}}),router['post']('/barcode_scanner',async(_0x465718,_0xc37158)=>{var _0x13065f=a0_0x110fa0;const {primary_code:_0xe0391e,warehouse_data:_0xb3697f,rooms_data:_0x3c9189,Roomslist:_0x3d5acd}=_0x465718[_0x13065f(0x181)],_0x31deb5=_0x3d5acd[_0x13065f(0x198)](','),_0x4854b0=[];async function _0x12ffba(_0x9c5fa0){var _0x32536a=_0x13065f;const _0x5d8053=await warehouse[_0x32536a(0x118)]([{'$match':{'name':_0xb3697f,'room':_0x9c5fa0}},{'$unwind':_0x32536a(0x159)},{'$match':{'product_details.primary_code':_0xe0391e}},{'$group':{'_id':_0x32536a(0x195),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x32536a(0x15e)},'primary_code':{'$first':_0x32536a(0x169)},'secondary_code':{'$first':_0x32536a(0x116)},'product_code':{'$first':_0x32536a(0x140)},'level':{'$first':_0x32536a(0x175)},'isle':{'$first':_0x32536a(0x1bc)},'type':{'$first':_0x32536a(0x11f)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x32536a(0x197)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x32536a(0x12a)},'expiry_date':{'$first':_0x32536a(0x132)},'production_date':{'$first':_0x32536a(0x18c)},'maxPerUnit':{'$first':_0x32536a(0x14d)},'batch_code':{'$first':_0x32536a(0x160)},'product_cat':{'$first':_0x32536a(0x1be)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x32536a(0x10f)}}}]),_0x21681d=await warehouse['aggregate']([{'$match':{'name':_0xb3697f,'room':_0x9c5fa0}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0xe0391e}},{'$group':{'_id':_0x32536a(0x195),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x32536a(0x15e)},'primary_code':{'$first':_0x32536a(0x169)},'secondary_code':{'$first':_0x32536a(0x116)},'product_code':{'$first':_0x32536a(0x140)},'level':{'$first':_0x32536a(0x175)},'isle':{'$first':_0x32536a(0x1bc)},'type':{'$first':_0x32536a(0x11f)},'pallet':{'$first':_0x32536a(0x1c5)},'unit':{'$first':_0x32536a(0x13d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x32536a(0x125)},'rack':{'$first':_0x32536a(0x12a)},'expiry_date':{'$first':_0x32536a(0x132)},'production_date':{'$first':_0x32536a(0x18c)},'maxPerUnit':{'$first':_0x32536a(0x14d)},'batch_code':{'$first':_0x32536a(0x160)},'product_cat':{'$first':_0x32536a(0x1be)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x32536a(0x10f)}}}]);if(_0x5d8053[_0x32536a(0x179)]>0x0)_0x4854b0[_0x32536a(0x1b2)](_0x5d8053);else _0x21681d[_0x32536a(0x179)]>0x0&&_0x4854b0[_0x32536a(0x1b2)](_0x21681d);}const _0x59e5f6=_0x31deb5[_0x13065f(0x11a)](_0x4197b2=>_0x12ffba(_0x4197b2));await Promise[_0x13065f(0x185)](_0x59e5f6),_0xc37158['json'](_0x4854b0);}),router[a0_0x110fa0(0x1ab)](a0_0x110fa0(0x135),async(_0x29c8af,_0x2af35f)=>{var _0x333f10=a0_0x110fa0;const {primaryCode:_0x186d2c,secondaryCode:_0x3d5113,productCode:_0x5c8cee,level:_0x17b624,isle:_0x5fa1fb,pallet:_0x2fb90c,warehouses:_0x531007,room:_0x2916e1}=_0x29c8af['body'];try{const _0xf2387c=await warehouse[_0x333f10(0x118)]([{'$match':{'name':_0x531007,'room':_0x2916e1}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x17b624),'product_details.isle':_0x5fa1fb,'product_details.pallet':parseInt(_0x2fb90c)}},{'$group':{'_id':_0x333f10(0x195),'name':{'$first':_0x333f10(0x18d)},'product_stock':{'$first':_0x333f10(0x15e)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x333f10(0x1c2)},'pallet':{'$first':_0x333f10(0x119)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2af35f[_0x333f10(0x14b)](0xc8)['json'](_0xf2387c);}catch(_0x530032){_0x2af35f[_0x333f10(0x14b)](0x194)['json']({'message':_0x530032[_0x333f10(0x19b)]});}}),module[a0_0x110fa0(0x1d2)]=router;