var a0_0x14e883=a0_0x2152;(function(_0x5d8c1c,_0x43670a){var _0x73c95f=a0_0x2152,_0x3f5d80=_0x5d8c1c();while(!![]){try{var _0x113060=parseInt(_0x73c95f(0x21f))/0x1*(-parseInt(_0x73c95f(0x245))/0x2)+parseInt(_0x73c95f(0x1df))/0x3+parseInt(_0x73c95f(0x247))/0x4+parseInt(_0x73c95f(0x1b5))/0x5*(parseInt(_0x73c95f(0x231))/0x6)+parseInt(_0x73c95f(0x213))/0x7*(parseInt(_0x73c95f(0x1da))/0x8)+-parseInt(_0x73c95f(0x216))/0x9+-parseInt(_0x73c95f(0x1f5))/0xa*(parseInt(_0x73c95f(0x254))/0xb);if(_0x113060===_0x43670a)break;else _0x3f5d80['push'](_0x3f5d80['shift']());}catch(_0xa67612){_0x3f5d80['push'](_0x3f5d80['shift']());}}}(a0_0xa355,0x6b035));const express=require(a0_0x14e883(0x1fa)),app=express(),router=express[a0_0x14e883(0x18d)](),auth=require(a0_0x14e883(0x242)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x14e883(0x238)),nodemailer=require(a0_0x14e883(0x229));function a0_0xa355(){var _0x3e82ee=['back','<html><head><title></title>','sendMail','/view/add_adjustment','$product_details.type','<h2>\x20','/preview/:id','catch','max_per_unit','save','Error\x20Occurs','stockBefore','</thead>','English','$product_details.floorlevel','padStart','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','error','Rooms','Primary_Units','$product_details.expiry_date','$product_details.primary_code','status','prod_code','Enabled','/adjustment/preview/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','forEach','Chinese','755hDIfwp','maxperunit','$product_details.unit','host','<span\x20style=\x22float:\x20right;\x22>','</div>','<h5\x20style=\x22text-align:\x20left;\x22>','prod_name','Hindi','<tr>','expiry_date','params','success','secondary_code','minus','New_Qty_Converted_adj','$product_details.secondary_code','Receiving\x20Area','$name','</table>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details._id','bin','second1','log','date','finalize','get','/view/:id','id_transaction','foreach\x20newproduct','<hr\x20class=\x22my-3\x22>','\x20</h2>','prod_cat','New_Qty_Converted','Enclosed','port','148768StwlxZ','room','$product_details.rack','$date','<tbody\x20style=\x22text-align:\x20center;\x22>','389658QXuirn','product','Shelves','new_adjust_qty','/../public','redirect','An\x20error\x20occurred\x20while\x20saving\x20data.','all','<h5>','product_details','True','note','then','bay','$product_details.storage','Arabic','map','<div>','$product_details.maxPerUnit','primary_code','$finalize','</tr>','20xMVIHL','</body></html>','unit','German','$product.product_name','express','adjust_qty','product_stock','$product_details.bin','</head><body>','post','warehouse_name','$product_details','Adjustment\x20Mail','level','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','site_title','aggregate','Floor','secondary_unit','product_code','Level','Return\x20Rooms','Spanish','$product_details.isle','_id','Ambient','adjustment\x20Finalized\x20successfully','add_adjustment','259juMSlS','id_transaction_from','staff','7629732CRmJSw','types','ADJ-','type','email','/upload/','prod_invoice','random','/barcode_scanner','9XCrvnl','adjustment\x20add\x20successfull','Raw\x20Materials','$product_details.invoice','Portuguese\x20(BR)','logo','\x20Order\x20Number\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','findById','English\x20(US)','nodemailer','prime1','$product_details.level','render','floor','body','False','master','16620fDGGtD','$room','findOne','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','\x20Order\x20Date\x20:\x20','slice','$product_details.maxProducts','../public/language/languages.json','production_date','$product_details.product_code','rack','Arabic\x20(ae)','warehouse','$product_details.production_date','batch_code','French','An\x20error\x20occurred.','../middleware/auth','Logo.png','json','132428brjTSr','$product_details.product_name','3203140LZsAHn','product_name','$isAllowEdit','<strong>\x20Regards\x20</strong>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','push','Return\x20Goods','Portuguese','adjustment','invoice','$product_details.product_stock','room_names','isAllowEdit','852467KHjnGi','$product_details.product_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','edit_adjustment_view','floorlevel','string','</td>','user','/adjustment/view','length','find','language','$product','role','$product_details.secondary_unit','storage','message','stock','Router','filter','$product_details.batch_code','Secondary_units','flash','/view','$_id','image','errors','<!DOCTYPE\x20html>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>'];a0_0xa355=function(){return _0x3e82ee;};return a0_0xa355();}router['get'](a0_0x14e883(0x192),auth,async(_0x16a619,_0x39a763)=>{var _0x13349e=a0_0x14e883;try{const {username:_0x119f25,email:_0x54d680,role:_0x5c4eeb}=_0x16a619[_0x13349e(0x182)],_0x3d9469=_0x16a619['user'],_0x2eb5af=await profile['findOne']({'email':_0x3d9469[_0x13349e(0x21a)]}),_0x3168b8=await master_shop[_0x13349e(0x185)]();console[_0x13349e(0x1cd)](_0x13349e(0x230),_0x3168b8);let _0x1df6f5;if(_0x3d9469[_0x13349e(0x188)]==_0x13349e(0x215)){const _0x5bc088=await staff[_0x13349e(0x233)]({'email':_0x3d9469[_0x13349e(0x21a)]});_0x1df6f5=await warehouse[_0x13349e(0x185)]({'status':_0x13349e(0x1b0),'name':_0x5bc088[_0x13349e(0x23d)]});}else _0x1df6f5=await warehouse[_0x13349e(0x185)]({'status':_0x13349e(0x1b0)});const _0x442715=await product[_0x13349e(0x185)]();let _0x4b072b;if(_0x3d9469[_0x13349e(0x188)]==_0x13349e(0x215)){const _0x2ce86c=await staff[_0x13349e(0x233)]({'email':_0x3d9469['email']});_0x4b072b=await adjustment[_0x13349e(0x185)]({'warehouse_name':_0x2ce86c[_0x13349e(0x23d)]});}else _0x4b072b=await adjustment[_0x13349e(0x207)]([{'$unwind':_0x13349e(0x187)},{'$group':{'_id':_0x13349e(0x193),'invoice':{'$first':'$invoice'},'date':{'$first':_0x13349e(0x1dd)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x13349e(0x1f3)},'isAllowEdit':{'$first':_0x13349e(0x249)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3168b8[0x0]['language']==_0x13349e(0x228)){var _0x2e6311=users[_0x13349e(0x1a5)];console[_0x13349e(0x1cd)](_0x2e6311);}else{if(_0x3168b8[0x0]['language']==_0x13349e(0x1bd))var _0x2e6311=users[_0x13349e(0x1bd)];else{if(_0x3168b8[0x0]['language']==_0x13349e(0x1f8))var _0x2e6311=users['German'];else{if(_0x3168b8[0x0][_0x13349e(0x186)]==_0x13349e(0x20d))var _0x2e6311=users[_0x13349e(0x20d)];else{if(_0x3168b8[0x0][_0x13349e(0x186)]=='French')var _0x2e6311=users[_0x13349e(0x240)];else{if(_0x3168b8[0x0][_0x13349e(0x186)]=='Portuguese\x20(BR)')var _0x2e6311=users['Portuguese'];else{if(_0x3168b8[0x0][_0x13349e(0x186)]==_0x13349e(0x1b4))var _0x2e6311=users[_0x13349e(0x1b4)];else{if(_0x3168b8[0x0]['language']=='Arabic\x20(ae)')var _0x2e6311=users[_0x13349e(0x1ee)];}}}}}}}_0x39a763[_0x13349e(0x22c)](_0x13349e(0x24f),{'success':_0x16a619[_0x13349e(0x191)](_0x13349e(0x1c1)),'errors':_0x16a619[_0x13349e(0x191)](_0x13349e(0x195)),'role':_0x3d9469,'profile':_0x2eb5af,'warehouse':_0x1df6f5,'product':_0x442715,'adjustment':_0x4b072b,'master_shop':_0x3168b8,'language':_0x2e6311});}catch(_0x4ce195){console[_0x13349e(0x1cd)](_0x4ce195);}});function a0_0x2152(_0x11880e,_0x3426b4){var _0xa355dd=a0_0xa355();return a0_0x2152=function(_0x2152c1,_0x202f43){_0x2152c1=_0x2152c1-0x181;var _0xa2762b=_0xa355dd[_0x2152c1];return _0xa2762b;},a0_0x2152(_0x11880e,_0x3426b4);}async function getRandom8DigitNumber(){var _0x1c78c1=a0_0x14e883;const _0x3a148c=0x989680,_0x13b13c=0x5f5e0ff,_0x48077c=Math[_0x1c78c1(0x22d)](Math[_0x1c78c1(0x21d)]()*(_0x13b13c-_0x3a148c+0x1))+_0x3a148c;var _0x5bac04;const _0x2ef348=await adjustment['findOne']({'invoice':_0x1c78c1(0x218)+_0x48077c});return _0x2ef348&&_0x2ef348['length']>0x0?_0x5bac04=_0x1c78c1(0x218)+_0x48077c:_0x5bac04=_0x1c78c1(0x218)+_0x48077c,_0x5bac04;}router[a0_0x14e883(0x1d0)](a0_0x14e883(0x19b),auth,async(_0x74f05e,_0x2d3540)=>{var _0x2cb2b8=a0_0x14e883;try{const {username:_0x51b819,email:_0x153e48,role:_0x1de2ee}=_0x74f05e[_0x2cb2b8(0x182)],_0x2089dd=_0x74f05e[_0x2cb2b8(0x182)],_0x4a26c9=await profile[_0x2cb2b8(0x233)]({'email':_0x2089dd[_0x2cb2b8(0x21a)]}),_0x17bd27=await master_shop['find']();let _0x467a70;if(_0x2089dd[_0x2cb2b8(0x188)]==_0x2cb2b8(0x215)){const _0x33d67a=await staff[_0x2cb2b8(0x233)]({'email':_0x2089dd[_0x2cb2b8(0x21a)]});_0x467a70=await warehouse[_0x2cb2b8(0x207)]([{'$match':{'status':_0x2cb2b8(0x1b0),'name':_0x33d67a[_0x2cb2b8(0x23d)],'warehouse_category':_0x2cb2b8(0x221),'name':{'$ne':_0x2cb2b8(0x24d)}}},{'$group':{'_id':_0x2cb2b8(0x1c7),'name':{'$first':_0x2cb2b8(0x1c7)}}}]);}else _0x467a70=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x2cb2b8(0x221),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x2cb2b8(0x1c7)}}}]);const _0x14d3f4=await product[_0x2cb2b8(0x185)]({}),_0x5e3378=await adjustment[_0x2cb2b8(0x185)]({}),_0x2ca66b=_0x5e3378[_0x2cb2b8(0x184)]+0x1,_0x55ff41='ADJ-'+_0x2ca66b['toString']()[_0x2cb2b8(0x1a7)](0x5,'0');var _0x59918e=[_0x2cb2b8(0x210),_0x2cb2b8(0x1d8),_0x2cb2b8(0x20c)];if(_0x17bd27[0x0][_0x2cb2b8(0x186)]=='English\x20(US)')var _0x387262=users[_0x2cb2b8(0x1a5)];else{if(_0x17bd27[0x0]['language']==_0x2cb2b8(0x1bd))var _0x387262=users[_0x2cb2b8(0x1bd)];else{if(_0x17bd27[0x0][_0x2cb2b8(0x186)]=='German')var _0x387262=users[_0x2cb2b8(0x1f8)];else{if(_0x17bd27[0x0][_0x2cb2b8(0x186)]==_0x2cb2b8(0x20d))var _0x387262=users['Spanish'];else{if(_0x17bd27[0x0][_0x2cb2b8(0x186)]==_0x2cb2b8(0x240))var _0x387262=users[_0x2cb2b8(0x240)];else{if(_0x17bd27[0x0][_0x2cb2b8(0x186)]==_0x2cb2b8(0x223))var _0x387262=users[_0x2cb2b8(0x24e)];else{if(_0x17bd27[0x0][_0x2cb2b8(0x186)]==_0x2cb2b8(0x1b4))var _0x387262=users['Chinese'];else{if(_0x17bd27[0x0][_0x2cb2b8(0x186)]==_0x2cb2b8(0x23c))var _0x387262=users['Arabic'];}}}}}}}const _0xfee029=getRandom8DigitNumber();_0xfee029[_0x2cb2b8(0x1eb)](_0x394953=>{var _0x4301c8=_0x2cb2b8;_0x2d3540[_0x4301c8(0x22c)](_0x4301c8(0x212),{'success':_0x74f05e[_0x4301c8(0x191)](_0x4301c8(0x1c1)),'errors':_0x74f05e[_0x4301c8(0x191)]('errors'),'role':_0x2089dd,'profile':_0x4a26c9,'warehouse':_0x467a70,'product':_0x14d3f4,'master_shop':_0x17bd27,'language':_0x387262,'rooms_data':_0x59918e,'invoice_no':_0x394953});})[_0x2cb2b8(0x19f)](_0x3832cb=>{var _0x1aacf4=_0x2cb2b8;_0x74f05e['flash'](_0x1aacf4(0x195),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2d3540[_0x1aacf4(0x1e4)]('/adjustment/view');});}catch(_0x31ab4b){console['log'](_0x31ab4b);}}),router[a0_0x14e883(0x1ff)](a0_0x14e883(0x19b),auth,async(_0x4e6b6f,_0x2c60bd)=>{var _0x33199b=a0_0x14e883;try{const {warehouse_name:_0x26be0a,date:_0x1b7e69,prod_name:_0x47cccb,level:_0x4470a0,isle:_0x218197,pallet:_0x4a60c4,stock:_0x494784,types:_0x1616bd,adjust_qty:_0x259fc0,new_adjust_qty:_0xf2f42d,note:_0x5a6160,Room_name:_0x111365,invoice:_0x226ee3,JO_number:_0x53930f,expiry_date:_0x19ca0a}=_0x4e6b6f['body'];if(typeof _0x47cccb==_0x33199b(0x259))var _0x1eec6b=[_0x4e6b6f['body'][_0x33199b(0x1bc)]],_0xe75af3=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x203)]],_0xacf95d=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x18c)]],_0x2ac60a=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x217)]],_0x589561=[_0x4e6b6f['body'][_0x33199b(0x1c4)]],_0x498430=[_0x4e6b6f[_0x33199b(0x22e)]['New_Qty_Converted']],_0x5119fb=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1ab)]],_0x4a299d=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x190)]],_0x2c14ee=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1af)]],_0x2f7825=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x23f)]],_0x5c013b=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1bf)]],_0x56b21b=[_0x4e6b6f['body'][_0x33199b(0x1a0)]],_0x13e01d=[_0x4e6b6f['body'][_0x33199b(0x239)]],_0xe30ce1=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1d6)]],_0x1cc076=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1aa)]],_0x3502ae=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x22a)]],_0x14d122=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1cc)]],_0x380329=[_0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x21c)]],_0x1f19ad=[_0x4e6b6f[_0x33199b(0x22e)]['id_transaction']];else var _0x1eec6b=[..._0x4e6b6f['body'][_0x33199b(0x1bc)]],_0xe75af3=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x203)]],_0xacf95d=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x18c)]],_0x2ac60a=[..._0x4e6b6f['body'][_0x33199b(0x217)]],_0x589561=[..._0x4e6b6f['body'][_0x33199b(0x1c4)]],_0x498430=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1d7)]],_0x5119fb=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1f7)]],_0x4a299d=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x190)]],_0x2c14ee=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1af)]],_0x2f7825=[..._0x4e6b6f[_0x33199b(0x22e)]['batch_code']],_0x5c013b=[..._0x4e6b6f['body'][_0x33199b(0x1bf)]],_0x56b21b=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1a0)]],_0x13e01d=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x239)]],_0xe30ce1=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1d6)]],_0x1cc076=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1aa)]],_0x3502ae=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x22a)]],_0x14d122=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1cc)]],_0x380329=[..._0x4e6b6f[_0x33199b(0x22e)]['prod_invoice']],_0x1f19ad=[..._0x4e6b6f[_0x33199b(0x22e)][_0x33199b(0x1d2)]];const _0x2986fa=_0x1eec6b['map'](_0x249dab=>{return _0x249dab={'product_name':_0x249dab};});_0xe75af3[_0x33199b(0x1b3)]((_0x4ea855,_0x5306b5)=>{var _0x19fb38=_0x33199b;_0x1cc076[_0x19fb38(0x1b3)]((_0x37716b,_0x3ef532)=>{var _0xfb0833=_0x19fb38;if(_0x37716b==_0xfb0833(0x1c6)&&_0x5306b5==_0x3ef532){var _0x5d9bed=_0x4ea855[_0xfb0833(0x236)](0x3);_0x2986fa[_0x5306b5]['storage']=_0x4ea855[0x0],_0x2986fa[_0x5306b5][_0xfb0833(0x23b)]=_0x4ea855[0x1],_0x2986fa[_0x5306b5][_0xfb0833(0x1ec)]=0x0,_0x2986fa[_0x5306b5][_0xfb0833(0x1cb)]=0x0,_0x2986fa[_0x5306b5][_0xfb0833(0x219)]='Floor',_0x2986fa[_0x5306b5][_0xfb0833(0x258)]=_0x5d9bed;}else{if(_0x37716b=='Shelves'&&_0x5306b5==_0x3ef532){var _0x5d9bed=_0x4ea855['slice'](0x3);_0x2986fa[_0x5306b5][_0xfb0833(0x18a)]=_0x4ea855[0x0],_0x2986fa[_0x5306b5][_0xfb0833(0x23b)]=_0x4ea855[0x1],_0x2986fa[_0x5306b5][_0xfb0833(0x1ec)]=0x0,_0x2986fa[_0x5306b5][_0xfb0833(0x1cb)]=0x0,_0x2986fa[_0x5306b5][_0xfb0833(0x219)]=_0xfb0833(0x208),_0x2986fa[_0x5306b5][_0xfb0833(0x258)]=_0x4ea855[0x5];}else{if(_0x5306b5==_0x3ef532){var _0x23b95f;if(_0x4ea855[0x4]=='L')_0x23b95f=_0xfb0833(0x20b);else _0x4ea855[0x4]=='F'&&(_0x23b95f=_0xfb0833(0x208));_0x2986fa[_0x5306b5]['storage']=_0x4ea855[0x0],_0x2986fa[_0x5306b5]['rack']=_0x4ea855[0x1],_0x2986fa[_0x5306b5][_0xfb0833(0x1ec)]=_0x4ea855[0x2],_0x2986fa[_0x5306b5]['bin']=_0x4ea855[0x3],_0x2986fa[_0x5306b5]['type']=_0x23b95f,_0x2986fa[_0x5306b5][_0xfb0833(0x258)]=_0x4ea855[0x5];}}}});}),_0xacf95d[_0x33199b(0x1b3)]((_0x1be3ec,_0x12fcfe)=>{var _0x174fea=_0x33199b;_0x2986fa[_0x12fcfe][_0x174fea(0x1a3)]=_0x1be3ec;}),_0x1f19ad[_0x33199b(0x1b3)]((_0x6c5f2e,_0x51b167)=>{var _0x4dd5e1=_0x33199b;_0x2986fa[_0x51b167][_0x4dd5e1(0x214)]=_0x6c5f2e;}),_0x2ac60a[_0x33199b(0x1b3)]((_0x21dd03,_0x1cc380)=>{var _0x524be5=_0x33199b;_0x2986fa[_0x1cc380][_0x524be5(0x217)]=_0x21dd03;}),_0x589561[_0x33199b(0x1b3)]((_0x58b084,_0x5c37a9)=>{var _0x297ee9=_0x33199b;_0x2986fa[_0x5c37a9][_0x297ee9(0x1fb)]=_0x58b084;}),_0x498430[_0x33199b(0x1b3)]((_0x9e3619,_0x59af6d)=>{_0x2986fa[_0x59af6d]['new_adjust_qty']=_0x9e3619;}),_0x5119fb['forEach']((_0x2259af,_0x1bf4ed)=>{var _0x545bf0=_0x33199b;_0x2986fa[_0x1bf4ed][_0x545bf0(0x1f7)]=_0x2259af;}),_0x4a299d[_0x33199b(0x1b3)]((_0x55d3e0,_0x4b9cc7)=>{var _0x9b0f62=_0x33199b;_0x2986fa[_0x4b9cc7][_0x9b0f62(0x209)]=_0x55d3e0;}),_0x2c14ee[_0x33199b(0x1b3)]((_0x77fd46,_0x42664e)=>{var _0xf3f0f0=_0x33199b;_0x2986fa[_0x42664e][_0xf3f0f0(0x20a)]=_0x77fd46;}),_0x2f7825[_0x33199b(0x1b3)]((_0x34c486,_0x40502a)=>{_0x2986fa[_0x40502a]['batch_code']=_0x34c486;}),_0x5c013b[_0x33199b(0x1b3)]((_0x156804,_0x319676)=>{_0x2986fa[_0x319676]['expiry_date']=_0x156804;}),_0x56b21b[_0x33199b(0x1b3)]((_0x254888,_0x4b37ac)=>{var _0xf0dc89=_0x33199b;_0x2986fa[_0x4b37ac][_0xf0dc89(0x1b6)]=_0x254888;}),_0x13e01d[_0x33199b(0x1b3)]((_0x49f11a,_0x49e55c)=>{var _0x2191d2=_0x33199b;_0x2986fa[_0x49e55c][_0x2191d2(0x239)]=_0x49f11a;}),_0xe30ce1[_0x33199b(0x1b3)]((_0xe8ab14,_0x531253)=>{var _0x9c2ea4=_0x33199b;_0x2986fa[_0x531253][_0x9c2ea4(0x1d6)]=_0xe8ab14;}),_0x1cc076[_0x33199b(0x1b3)]((_0x42854f,_0x27a097)=>{var _0x418c96=_0x33199b;_0x2986fa[_0x27a097][_0x418c96(0x252)]=_0x42854f;}),_0x3502ae[_0x33199b(0x1b3)]((_0x152a0b,_0x21a98f)=>{_0x2986fa[_0x21a98f]['primary_code']=_0x152a0b;}),_0x14d122[_0x33199b(0x1b3)]((_0x36eb2f,_0x36ae6b)=>{var _0xbb3890=_0x33199b;_0x2986fa[_0x36ae6b][_0xbb3890(0x1c2)]=_0x36eb2f;}),_0x380329[_0x33199b(0x1b3)]((_0x182392,_0x2994a9)=>{var _0x2cf542=_0x33199b;_0x2986fa[_0x2994a9][_0x2cf542(0x250)]=_0x182392;});const _0x1f54c1=_0x2986fa[_0x33199b(0x18e)](_0x421d4b=>_0x421d4b[_0x33199b(0x1fb)]!=='0'&&_0x421d4b[_0x33199b(0x1fb)]!=='');var _0x2ca35d=0x0;_0x1f54c1[_0x33199b(0x1b3)](_0x17a45e=>{var _0x51a741=_0x33199b;console['log'](_0x51a741(0x1d3),_0x17a45e),parseInt(_0x17a45e[_0x51a741(0x1fb)])<=0x0&&_0x2ca35d++;});if(_0x2ca35d!=0x0)return _0x4e6b6f[_0x33199b(0x191)](_0x33199b(0x195),_0x33199b(0x234)),_0x2c60bd[_0x33199b(0x1e4)]('back');const _0x2d9513=new adjustment({'warehouse_name':_0x26be0a,'date':_0x1b7e69,'product':_0x1f54c1,'note':_0x5a6160,'room':_0x111365,'invoice':_0x226ee3,'JO_number':_0x53930f,'expiry_date':_0x19ca0a}),_0x671526=await _0x2d9513[_0x33199b(0x1a1)]();_0x4e6b6f[_0x33199b(0x191)](_0x33199b(0x1c1),_0x33199b(0x220)),_0x2c60bd[_0x33199b(0x1e4)](_0x33199b(0x1b1)+_0x671526['_id']);}catch(_0x2c4457){console[_0x33199b(0x1cd)](_0x2c4457),_0x2c60bd['status'](0xc8)[_0x33199b(0x244)]({'message':_0x2c4457[_0x33199b(0x18b)]});}}),router[a0_0x14e883(0x1d0)](a0_0x14e883(0x19e),auth,async(_0x19ed87,_0x4de957)=>{var _0x51ebfb=a0_0x14e883;try{const {username:_0x554485,email:_0x62fd50,role:_0x2e6cab}=_0x19ed87[_0x51ebfb(0x182)],_0x9fc3b9=_0x19ed87['user'],_0x5d748c=await profile['findOne']({'email':_0x9fc3b9['email']}),_0xa9d4a3=await master_shop[_0x51ebfb(0x185)](),_0x63462e=_0x19ed87[_0x51ebfb(0x1c0)]['id'],_0x10439a=await adjustment[_0x51ebfb(0x227)]({'_id':_0x63462e}),_0xd639ba=await purchases['aggregate']([{'$match':{'warehouse_name':_0x10439a[_0x51ebfb(0x200)]}},{'$unwind':_0x51ebfb(0x187)},{'$group':{'_id':_0x51ebfb(0x1f9)}}]),_0xfebf89=await product[_0x51ebfb(0x185)]({}),_0x422aa2=await warehouse['aggregate']([{'$match':{'name':_0x10439a[_0x51ebfb(0x200)]}},{'$unwind':_0x51ebfb(0x201)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x51ebfb(0x246)},'product_stock':{'$first':_0x51ebfb(0x251)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x51ebfb(0x19c)},'floorlevel':{'$first':_0x51ebfb(0x1a6)},'primary_code':{'$first':_0x51ebfb(0x1ad)},'secondary_code':{'$first':_0x51ebfb(0x1c5)},'product_code':{'$first':_0x51ebfb(0x23a)},'storage':{'$first':_0x51ebfb(0x1ed)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x51ebfb(0x1f1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x51ebfb(0x23e)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);if(_0xa9d4a3[0x0][_0x51ebfb(0x186)]==_0x51ebfb(0x228)){var _0x2537ff=users[_0x51ebfb(0x1a5)];console['log'](_0x2537ff);}else{if(_0xa9d4a3[0x0][_0x51ebfb(0x186)]=='Hindi')var _0x2537ff=users[_0x51ebfb(0x1bd)];else{if(_0xa9d4a3[0x0]['language']=='German')var _0x2537ff=users['German'];else{if(_0xa9d4a3[0x0][_0x51ebfb(0x186)]==_0x51ebfb(0x20d))var _0x2537ff=users[_0x51ebfb(0x20d)];else{if(_0xa9d4a3[0x0][_0x51ebfb(0x186)]==_0x51ebfb(0x240))var _0x2537ff=users[_0x51ebfb(0x240)];else{if(_0xa9d4a3[0x0][_0x51ebfb(0x186)]==_0x51ebfb(0x223))var _0x2537ff=users['Portuguese'];else{if(_0xa9d4a3[0x0][_0x51ebfb(0x186)]==_0x51ebfb(0x1b4))var _0x2537ff=users[_0x51ebfb(0x1b4)];else{if(_0xa9d4a3[0x0][_0x51ebfb(0x186)]==_0x51ebfb(0x23c))var _0x2537ff=users[_0x51ebfb(0x1ee)];}}}}}}}_0x4de957[_0x51ebfb(0x22c)](_0x51ebfb(0x257),{'success':_0x19ed87[_0x51ebfb(0x191)]('success'),'errors':_0x19ed87['flash']('errors'),'role':_0x9fc3b9,'profile':_0x5d748c,'adjustment':_0x10439a,'master_shop':_0xa9d4a3,'warehouse_name':_0xd639ba,'unit':_0xfebf89,'language':_0x2537ff});}catch(_0x565265){console[_0x51ebfb(0x1cd)](_0x565265),_0x4de957[_0x51ebfb(0x1ae)](0xc8)['json']({'message':_0x565265['message']});}}),router[a0_0x14e883(0x1ff)](a0_0x14e883(0x19e),auth,async(_0x4ed467,_0x20380c)=>{var _0x2a2964=a0_0x14e883;try{const _0xaa1139=_0x4ed467['params']['id'],{warehouse_name:_0x49dc24,Room_name:_0x3dfbbe}=_0x4ed467[_0x2a2964(0x22e)],_0x3b6b1f=await adjustment[_0x2a2964(0x227)]({'_id':_0xaa1139}),_0x44f9b6=_0x3b6b1f[_0x2a2964(0x1e0)][_0x2a2964(0x1ef)](async _0x53285b=>{var _0xb28961=_0x2a2964;if(_0x53285b['adjust_qty']>0x0){var _0x29b4f7=await warehouse[_0xb28961(0x233)]({'name':_0x49dc24,'room':_0x53285b[_0xb28961(0x252)],'warehouse_category':_0xb28961(0x221)});const _0x2092a0=_0x29b4f7[_0xb28961(0x1e8)][_0xb28961(0x1ef)](_0x2bf066=>{var _0x2d9104=_0xb28961;console[_0x2d9104(0x1cd)](_0x53285b['types']+'\x20<>\x20');if(_0x53285b[_0x2d9104(0x217)]==_0x2d9104(0x1c3)){if(_0x2bf066[_0x2d9104(0x248)]==_0x53285b[_0x2d9104(0x248)]&&_0x2bf066['floorlevel']==_0x53285b[_0x2d9104(0x258)]&&_0x2bf066[_0x2d9104(0x219)]==_0x53285b[_0x2d9104(0x219)]&&_0x2bf066[_0x2d9104(0x1cb)]==_0x53285b['bin']&&_0x2bf066['bay']==_0x53285b[_0x2d9104(0x1ec)]&&_0x2bf066[_0x2d9104(0x23b)]==_0x53285b[_0x2d9104(0x23b)]&&_0x2bf066[_0x2d9104(0x18a)]==_0x53285b[_0x2d9104(0x18a)]&&_0x2bf066[_0x2d9104(0x1bf)]==_0x53285b[_0x2d9104(0x1bf)]&&_0x2bf066[_0x2d9104(0x23f)]==_0x53285b['batch_code']&&_0x2bf066[_0x2d9104(0x239)]==_0x53285b['production_date']&&_0x2bf066[_0x2d9104(0x250)]==_0x53285b[_0x2d9104(0x250)]&&_0x2bf066[_0x2d9104(0x20f)]==_0x53285b[_0x2d9104(0x214)]){var _0x505fda;_0x505fda=_0x53285b['adjust_qty'],_0x53285b[_0x2d9104(0x1d6)]=='S'&&(_0x505fda=_0x53285b['adjust_qty']),_0x2bf066[_0x2d9104(0x1fc)]=_0x2bf066[_0x2d9104(0x1fc)]-_0x505fda;}}else{if(_0x2bf066[_0x2d9104(0x248)]==_0x53285b['product_name']&&_0x2bf066[_0x2d9104(0x258)]==_0x53285b[_0x2d9104(0x258)]&&_0x2bf066[_0x2d9104(0x219)]==_0x53285b[_0x2d9104(0x219)]&&_0x2bf066[_0x2d9104(0x1cb)]==_0x53285b[_0x2d9104(0x1cb)]&&_0x2bf066[_0x2d9104(0x1ec)]==_0x53285b[_0x2d9104(0x1ec)]&&_0x2bf066['rack']==_0x53285b['rack']&&_0x2bf066[_0x2d9104(0x18a)]==_0x53285b[_0x2d9104(0x18a)]&&_0x2bf066[_0x2d9104(0x1bf)]==_0x53285b[_0x2d9104(0x1bf)]&&_0x2bf066[_0x2d9104(0x23f)]==_0x53285b[_0x2d9104(0x23f)]&&_0x2bf066['production_date']==_0x53285b['production_date']&&_0x2bf066['invoice']==_0x53285b['invoice']&&_0x2bf066[_0x2d9104(0x20f)]==_0x53285b[_0x2d9104(0x214)]){console['log'](_0x53285b);var _0x505fda;_0x505fda=_0x53285b[_0x2d9104(0x1fb)],_0x53285b[_0x2d9104(0x1d6)]=='S'&&(_0x505fda=_0x53285b[_0x2d9104(0x1fb)]),_0x2bf066[_0x2d9104(0x1fc)]=_0x2bf066[_0x2d9104(0x1fc)]+_0x505fda;}}});}return _0x29b4f7;});Promise[_0x2a2964(0x1e6)](_0x44f9b6)[_0x2a2964(0x1eb)](async _0xf8542a=>{var _0x496d91=_0x2a2964;try{for(const _0x5d0adf of _0xf8542a){await _0x5d0adf[_0x496d91(0x1a1)]();}_0x3b6b1f[_0x496d91(0x1cf)]=_0x496d91(0x1e9);const _0x4a661b=await _0x3b6b1f[_0x496d91(0x1a1)](),_0x129905=await master_shop[_0x496d91(0x185)](),_0x54c375=await email_settings[_0x496d91(0x233)](),_0x2352b2=await supervisor_settings['find']();var _0x5b3bd2=_0x3b6b1f['product'],_0x559717='',_0x1cb94c;for(_0x1cb94c in _0x5b3bd2){_0x559717+=_0x496d91(0x1be)+_0x496d91(0x1a8)+_0x5b3bd2[_0x1cb94c][_0x496d91(0x248)]+'</td>'+_0x496d91(0x1a8)+_0x5b3bd2[_0x1cb94c][_0x496d91(0x20a)]+_0x496d91(0x181)+_0x496d91(0x1a8)+_0x5b3bd2[_0x1cb94c][_0x496d91(0x1fb)]+_0x496d91(0x181)+_0x496d91(0x1a8)+_0x5b3bd2[_0x1cb94c][_0x496d91(0x1f7)]+'</td>'+_0x496d91(0x1a8)+_0x5b3bd2[_0x1cb94c][_0x496d91(0x209)]+'</td>'+_0x496d91(0x1a8)+_0x3b6b1f[_0x496d91(0x200)]+_0x496d91(0x181)+_0x496d91(0x1a8)+_0x5b3bd2[_0x1cb94c][_0x496d91(0x252)]+'</td>'+_0x496d91(0x1a8)+_0x5b3bd2[_0x1cb94c][_0x496d91(0x18a)]+_0x5b3bd2[_0x1cb94c]['rack']+_0x5b3bd2[_0x1cb94c][_0x496d91(0x1ec)]+_0x5b3bd2[_0x1cb94c][_0x496d91(0x1cb)]+_0x5b3bd2[_0x1cb94c][_0x496d91(0x219)][0x0]+_0x5b3bd2[_0x1cb94c][_0x496d91(0x258)]+_0x496d91(0x181),_0x496d91(0x1f4);}let _0x497f9e=nodemailer['createTransport']({'host':_0x54c375[_0x496d91(0x1b8)],'port':Number(_0x54c375[_0x496d91(0x1d9)]),'secure':![],'auth':{'user':_0x54c375[_0x496d91(0x21a)],'pass':_0x54c375['password']}}),_0x4788ed={'from':_0x54c375[_0x496d91(0x21a)],'to':_0x2352b2[0x0]['RMSEmail'],'subject':_0x496d91(0x202),'attachments':[{'filename':_0x496d91(0x243),'path':__dirname+_0x496d91(0x1e3)+_0x496d91(0x21b)+_0x129905[0x0][_0x496d91(0x194)],'cid':_0x496d91(0x224)}],'html':_0x496d91(0x196)+_0x496d91(0x199)+_0x496d91(0x1fe)+_0x496d91(0x1f0)+_0x496d91(0x1c9)+_0x496d91(0x1f0)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x496d91(0x1ba)+'<div>'+_0x496d91(0x19d)+_0x129905[0x0][_0x496d91(0x206)]+_0x496d91(0x1d5)+_0x496d91(0x1ba)+_0x496d91(0x1ba)+_0x496d91(0x1d4)+_0x496d91(0x1f0)+_0x496d91(0x1bb)+_0x496d91(0x225)+_0x3b6b1f['invoice']+'\x20'+_0x496d91(0x1b9)+_0x496d91(0x235)+_0x3b6b1f[_0x496d91(0x1ce)]+'\x20'+'</span>'+'</h5>'+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x496d91(0x197)+_0x496d91(0x1be)+_0x496d91(0x1b2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x496d91(0x24b)+_0x496d91(0x205)+_0x496d91(0x226)+_0x496d91(0x256)+_0x496d91(0x1f4)+_0x496d91(0x1a4)+_0x496d91(0x1de)+'\x20'+_0x559717+'\x20'+'</tbody>'+_0x496d91(0x1c8)+'<div>'+_0x496d91(0x24a)+_0x496d91(0x1e7)+_0x129905[0x0][_0x496d91(0x206)]+'</h5>'+_0x496d91(0x1ba)+_0x496d91(0x1ba)+_0x496d91(0x1f6)};_0x497f9e[_0x496d91(0x19a)](_0x4788ed,function(_0x2b8fd9,_0x4b6637){var _0x500d7b=_0x496d91;_0x2b8fd9?(console[_0x500d7b(0x1cd)](_0x2b8fd9),console[_0x500d7b(0x1cd)](_0x500d7b(0x1a2))):console[_0x500d7b(0x1cd)]('Email\x20sent\x20successfully');}),_0x4ed467[_0x496d91(0x191)](_0x496d91(0x1c1),_0x496d91(0x211)),_0x20380c[_0x496d91(0x1e4)]('/picking_list/PDF_adjustment_rm/'+_0x4a661b['_id']);}catch(_0x438b9a){console[_0x496d91(0x1a9)](_0x438b9a),_0x20380c[_0x496d91(0x1ae)](0x1f4)[_0x496d91(0x244)]({'error':_0x496d91(0x1e5)});}})[_0x2a2964(0x19f)](_0x42dad9=>{var _0x499160=_0x2a2964;console[_0x499160(0x1a9)](_0x42dad9),_0x20380c['status'](0x1f4)['json']({'error':_0x499160(0x241)});});}catch(_0x53f54c){console[_0x2a2964(0x1cd)](_0x53f54c),_0x20380c['status'](0xc8)[_0x2a2964(0x244)]({'message':_0x53f54c[_0x2a2964(0x18b)]});}}),router['get'](a0_0x14e883(0x1d1),auth,async(_0x4b9db2,_0x1b9920)=>{var _0x5d2380=a0_0x14e883;try{const {username:_0x513e21,email:_0x45101b,role:_0x12350d}=_0x4b9db2['user'],_0x5046df=_0x4b9db2[_0x5d2380(0x182)],_0x5f3f10=await profile[_0x5d2380(0x233)]({'email':_0x5046df[_0x5d2380(0x21a)]}),_0x18a04d=await master_shop[_0x5d2380(0x185)](),_0x3e7753=_0x4b9db2[_0x5d2380(0x1c0)]['id'],_0x39405c=await adjustment['findById']({'_id':_0x3e7753}),_0x12b7bd=await purchases[_0x5d2380(0x207)]([{'$match':{'warehouse_name':_0x39405c[_0x5d2380(0x200)]}},{'$unwind':_0x5d2380(0x187)},{'$group':{'_id':_0x5d2380(0x1f9)}}]),_0x37a5ae=await product[_0x5d2380(0x185)]({}),_0x4ce051=await warehouse[_0x5d2380(0x207)]([{'$match':{'name':_0x39405c[_0x5d2380(0x200)]}},{'$unwind':_0x5d2380(0x201)},{'$group':{'_id':_0x5d2380(0x1ca),'name':{'$first':_0x5d2380(0x246)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5d2380(0x204)},'bin':{'$first':_0x5d2380(0x1fd)},'type':{'$first':_0x5d2380(0x19c)},'floorlevel':{'$first':_0x5d2380(0x1a6)},'primary_code':{'$first':_0x5d2380(0x1ad)},'secondary_code':{'$first':_0x5d2380(0x1c5)},'product_code':{'$first':_0x5d2380(0x23a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x5d2380(0x1f1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5d2380(0x18f)},'room':{'$first':_0x5d2380(0x232)}}}]);let _0x15caf9;if(_0x5046df['role']==_0x5d2380(0x215)){const _0x2d3b3e=await staff['findOne']({'email':_0x5046df[_0x5d2380(0x21a)]});_0x15caf9=await warehouse[_0x5d2380(0x207)]([{'$match':{'status':'Enabled','name':_0x2d3b3e['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5d2380(0x24d)}}},{'$group':{'_id':'$name','name':{'$first':_0x5d2380(0x1c7)}}}]);}else _0x15caf9=await warehouse[_0x5d2380(0x207)]([{'$match':{'status':_0x5d2380(0x1b0),'warehouse_category':_0x5d2380(0x221),'name':{'$ne':_0x5d2380(0x24d)}}},{'$group':{'_id':_0x5d2380(0x1c7),'name':{'$first':_0x5d2380(0x1c7)}}}]);if(_0x18a04d[0x0][_0x5d2380(0x186)]==_0x5d2380(0x228)){var _0x49db0a=users[_0x5d2380(0x1a5)];console[_0x5d2380(0x1cd)](_0x49db0a);}else{if(_0x18a04d[0x0][_0x5d2380(0x186)]==_0x5d2380(0x1bd))var _0x49db0a=users[_0x5d2380(0x1bd)];else{if(_0x18a04d[0x0][_0x5d2380(0x186)]==_0x5d2380(0x1f8))var _0x49db0a=users[_0x5d2380(0x1f8)];else{if(_0x18a04d[0x0][_0x5d2380(0x186)]==_0x5d2380(0x20d))var _0x49db0a=users['Spanish'];else{if(_0x18a04d[0x0][_0x5d2380(0x186)]==_0x5d2380(0x240))var _0x49db0a=users[_0x5d2380(0x240)];else{if(_0x18a04d[0x0][_0x5d2380(0x186)]=='Portuguese\x20(BR)')var _0x49db0a=users['Portuguese'];else{if(_0x18a04d[0x0][_0x5d2380(0x186)]=='Chinese')var _0x49db0a=users[_0x5d2380(0x1b4)];else{if(_0x18a04d[0x0][_0x5d2380(0x186)]==_0x5d2380(0x23c))var _0x49db0a=users[_0x5d2380(0x1ee)];}}}}}}}_0x1b9920['render']('edit_adjustment',{'success':_0x4b9db2[_0x5d2380(0x191)]('success'),'errors':_0x4b9db2[_0x5d2380(0x191)](_0x5d2380(0x195)),'role':_0x5046df,'profile':_0x5f3f10,'adjustment':_0x39405c,'stock':_0x4ce051,'master_shop':_0x18a04d,'warehouse_name':_0x12b7bd,'unit':_0x37a5ae,'language':_0x49db0a,'warehouse':_0x15caf9});}catch(_0x58df6e){console[_0x5d2380(0x1cd)](_0x58df6e),_0x1b9920[_0x5d2380(0x1ae)](0xc8)[_0x5d2380(0x244)]({'message':_0x58df6e['message']});}}),router[a0_0x14e883(0x1ff)]('/view/:id',auth,async(_0x331b2e,_0x47247a)=>{var _0x101390=a0_0x14e883;try{const _0x28c9d5=_0x331b2e[_0x101390(0x1c0)]['id'],_0x11b8eb=await adjustment[_0x101390(0x227)]({'_id':_0x28c9d5}),_0x2fdeee=await warehouse[_0x101390(0x233)]({'name':_0x11b8eb[_0x101390(0x200)],'room':_0x11b8eb[_0x101390(0x1db)]}),{warehouse_name:_0x1b3a14,date:_0xa5ea0b,prod_name:_0x3e9fc7,level:_0x369bf0,isle:_0x26ae44,pallet:_0x4f85e8,stock:_0x385d66,types:_0x266c2c,adjust_qty:_0x44374a,new_adjust_qty:_0x26c9c1,note:_0x2bebb3,Room_name:_0x48f483,invoice:_0x49b26f,JO_number:_0x545090,expiry_date:_0x25f186}=_0x331b2e['body'];if(typeof _0x3e9fc7==_0x101390(0x259))var _0x1eefcb=[_0x331b2e[_0x101390(0x22e)]['prod_name']],_0x18ebc2=[_0x331b2e['body'][_0x101390(0x203)]],_0x31dd75=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x18c)]],_0x13b215=[_0x331b2e['body']['types']],_0x2f5521=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x1c4)]],_0x13f02f=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x1d7)]],_0xdde35e=[_0x331b2e[_0x101390(0x22e)]['Primary_Units']],_0xafd88=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x190)]],_0x33a4b3=[_0x331b2e[_0x101390(0x22e)]['prod_code']],_0x1c4123=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x23f)]],_0xc705e6=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x1bf)]],_0x4bd11e=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x1a0)]],_0x5278ee=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x239)]],_0x35ba19=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x1d6)]],_0x494514=[_0x331b2e['body'][_0x101390(0x1aa)]],_0x3f8581=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x22a)]],_0x22cab5=[_0x331b2e[_0x101390(0x22e)][_0x101390(0x1cc)]];else var _0x1eefcb=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x1bc)]],_0x18ebc2=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x203)]],_0x31dd75=[..._0x331b2e['body'][_0x101390(0x18c)]],_0x13b215=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x217)]],_0x2f5521=[..._0x331b2e[_0x101390(0x22e)]['New_Qty_Converted_adj']],_0x13f02f=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x1d7)]],_0xdde35e=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x1f7)]],_0xafd88=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x190)]],_0x33a4b3=[..._0x331b2e['body'][_0x101390(0x1af)]],_0x1c4123=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x23f)]],_0xc705e6=[..._0x331b2e['body']['expiry_date']],_0x4bd11e=[..._0x331b2e['body'][_0x101390(0x1a0)]],_0x5278ee=[..._0x331b2e[_0x101390(0x22e)]['production_date']],_0x35ba19=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x1d6)]],_0x494514=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x1aa)]],_0x3f8581=[..._0x331b2e[_0x101390(0x22e)][_0x101390(0x22a)]],_0x22cab5=[..._0x331b2e['body'][_0x101390(0x1cc)]];const _0x2fe4bc=_0x1eefcb[_0x101390(0x1ef)](_0x194091=>{return _0x194091={'product_name':_0x194091};});_0x18ebc2[_0x101390(0x1b3)]((_0x5d4324,_0x2fb839)=>{_0x494514['forEach']((_0x2b382f,_0x55391e)=>{var _0x418af2=a0_0x2152;if(_0x2b382f==_0x418af2(0x1c6)&&_0x2fb839==_0x55391e){var _0x19ee6e=_0x5d4324['slice'](0x3);_0x2fe4bc[_0x2fb839][_0x418af2(0x18a)]=_0x5d4324[0x0],_0x2fe4bc[_0x2fb839][_0x418af2(0x23b)]=_0x5d4324[0x1],_0x2fe4bc[_0x2fb839][_0x418af2(0x1ec)]=0x0,_0x2fe4bc[_0x2fb839][_0x418af2(0x1cb)]=0x0,_0x2fe4bc[_0x2fb839][_0x418af2(0x219)]='Floor',_0x2fe4bc[_0x2fb839][_0x418af2(0x258)]=_0x19ee6e;}else{if(_0x2b382f==_0x418af2(0x1e1)&&_0x2fb839==_0x55391e){var _0x19ee6e=_0x5d4324['slice'](0x3);_0x2fe4bc[_0x2fb839][_0x418af2(0x18a)]=_0x5d4324[0x0],_0x2fe4bc[_0x2fb839]['rack']=_0x5d4324[0x1],_0x2fe4bc[_0x2fb839][_0x418af2(0x1ec)]=0x0,_0x2fe4bc[_0x2fb839][_0x418af2(0x1cb)]=0x0,_0x2fe4bc[_0x2fb839]['type']='Floor',_0x2fe4bc[_0x2fb839][_0x418af2(0x258)]=_0x5d4324[0x5];}else{if(_0x2fb839==_0x55391e){var _0x4fa0e4;if(_0x5d4324[0x4]=='L')_0x4fa0e4=_0x418af2(0x20b);else _0x5d4324[0x4]=='F'&&(_0x4fa0e4=_0x418af2(0x208));_0x2fe4bc[_0x2fb839]['storage']=_0x5d4324[0x0],_0x2fe4bc[_0x2fb839][_0x418af2(0x23b)]=_0x5d4324[0x1],_0x2fe4bc[_0x2fb839]['bay']=_0x5d4324[0x2],_0x2fe4bc[_0x2fb839][_0x418af2(0x1cb)]=_0x5d4324[0x3],_0x2fe4bc[_0x2fb839][_0x418af2(0x219)]=_0x4fa0e4,_0x2fe4bc[_0x2fb839][_0x418af2(0x258)]=_0x5d4324[0x5];}}}});}),_0x31dd75[_0x101390(0x1b3)]((_0x1d7218,_0x5e169a)=>{_0x2fe4bc[_0x5e169a]['stockBefore']=_0x1d7218;}),_0x13b215[_0x101390(0x1b3)]((_0x16ef0e,_0x3e7d60)=>{var _0x347251=_0x101390;_0x2fe4bc[_0x3e7d60][_0x347251(0x217)]=_0x16ef0e;}),_0x2f5521[_0x101390(0x1b3)]((_0x4b9cb0,_0x5e60cd)=>{var _0x3f06f9=_0x101390;_0x2fe4bc[_0x5e60cd][_0x3f06f9(0x1fb)]=_0x4b9cb0;}),_0x13f02f[_0x101390(0x1b3)]((_0x52e487,_0x181e82)=>{var _0x4394d3=_0x101390;_0x2fe4bc[_0x181e82][_0x4394d3(0x1e2)]=_0x52e487;}),_0xdde35e[_0x101390(0x1b3)]((_0x4a307c,_0x10e108)=>{var _0x52531b=_0x101390;_0x2fe4bc[_0x10e108][_0x52531b(0x1f7)]=_0x4a307c;}),_0xafd88[_0x101390(0x1b3)]((_0x3c69ae,_0xe2f369)=>{_0x2fe4bc[_0xe2f369]['secondary_unit']=_0x3c69ae;}),_0x33a4b3[_0x101390(0x1b3)]((_0x36cffe,_0x4a54fa)=>{var _0x5e27f0=_0x101390;_0x2fe4bc[_0x4a54fa][_0x5e27f0(0x20a)]=_0x36cffe;}),_0x1c4123[_0x101390(0x1b3)]((_0x38ee1c,_0x451863)=>{var _0x3f6194=_0x101390;_0x2fe4bc[_0x451863][_0x3f6194(0x23f)]=_0x38ee1c;}),_0xc705e6['forEach']((_0x5a9154,_0x28f9cd)=>{_0x2fe4bc[_0x28f9cd]['expiry_date']=_0x5a9154;}),_0x4bd11e[_0x101390(0x1b3)]((_0x153a4e,_0x3fc453)=>{var _0x48759d=_0x101390;_0x2fe4bc[_0x3fc453][_0x48759d(0x1b6)]=_0x153a4e;}),_0x5278ee[_0x101390(0x1b3)]((_0x4c946c,_0x4d4ad6)=>{_0x2fe4bc[_0x4d4ad6]['production_date']=_0x4c946c;}),_0x35ba19['forEach']((_0x1fc6f3,_0xd63d28)=>{var _0x33cf5e=_0x101390;_0x2fe4bc[_0xd63d28][_0x33cf5e(0x1d6)]=_0x1fc6f3;}),_0x494514[_0x101390(0x1b3)]((_0x39052f,_0x2edcc8)=>{_0x2fe4bc[_0x2edcc8]['room_names']=_0x39052f;}),_0x3f8581[_0x101390(0x1b3)]((_0x2bdfe1,_0x4020e4)=>{var _0xe6efc=_0x101390;_0x2fe4bc[_0x4020e4][_0xe6efc(0x1f2)]=_0x2bdfe1;}),_0x22cab5['forEach']((_0x3e764e,_0x30eb5f)=>{var _0x1344d9=_0x101390;_0x2fe4bc[_0x30eb5f][_0x1344d9(0x1c2)]=_0x3e764e;});const _0x269590=_0x2fe4bc[_0x101390(0x18e)](_0xac8e6c=>_0xac8e6c['adjust_qty']!=='0'&&_0xac8e6c['adjust_qty']!=='');var _0x17f641=0x0;_0x269590[_0x101390(0x1b3)](_0x18780c=>{var _0x46dc8f=_0x101390;console[_0x46dc8f(0x1cd)](_0x46dc8f(0x1d3),_0x18780c),parseInt(_0x18780c['adjust_qty'])<=0x0&&_0x17f641++;});if(_0x17f641!=0x0)return _0x331b2e[_0x101390(0x191)](_0x101390(0x195),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x47247a[_0x101390(0x1e4)](_0x101390(0x198));_0x11b8eb[_0x101390(0x200)]=_0x1b3a14,_0x11b8eb[_0x101390(0x1ce)]=_0xa5ea0b,_0x11b8eb[_0x101390(0x1e0)]=_0x269590,_0x11b8eb[_0x101390(0x1ea)]=_0x2bebb3,_0x11b8eb[_0x101390(0x250)]=_0x49b26f,_0x11b8eb[_0x101390(0x253)]=_0x101390(0x22f);const _0x1ae550=await _0x11b8eb[_0x101390(0x1a1)]();_0x331b2e[_0x101390(0x191)](_0x101390(0x1c1),'adjustment\x20data\x20update\x20successfully'),_0x47247a[_0x101390(0x1e4)](_0x101390(0x183));}catch(_0x3d2ae8){console[_0x101390(0x1cd)](_0x3d2ae8);}}),router['post'](a0_0x14e883(0x21e),async(_0x18af3d,_0x2f563e)=>{var _0x24874c=a0_0x14e883;const {primary_code:_0x47f60e,warehouse_data:_0x34c3bb,rooms_data:_0x3095af,Roomslist:_0xf27813}=_0x18af3d[_0x24874c(0x22e)],_0xa89aae=_0xf27813['split'](','),_0x5696b2=[];async function _0x21206b(_0x4cb703){var _0xb8dea8=_0x24874c;const _0x4e529c=await warehouse[_0xb8dea8(0x207)]([{'$match':{'name':_0x34c3bb,'room':_0x4cb703}},{'$unwind':_0xb8dea8(0x201)},{'$match':{'product_details.primary_code':_0x47f60e}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xb8dea8(0x1ad)},'secondary_code':{'$first':_0xb8dea8(0x1c5)},'product_code':{'$first':_0xb8dea8(0x23a)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0xb8dea8(0x1fd)},'type':{'$first':_0xb8dea8(0x19c)},'pallet':{'$first':_0xb8dea8(0x1a6)},'unit':{'$first':_0xb8dea8(0x1b7)},'secondary_unit':{'$first':_0xb8dea8(0x189)},'storage':{'$first':_0xb8dea8(0x1ed)},'rack':{'$first':_0xb8dea8(0x1dc)},'expiry_date':{'$first':_0xb8dea8(0x1ac)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0xb8dea8(0x1f1)},'batch_code':{'$first':_0xb8dea8(0x18f)},'product_cat':{'$first':_0xb8dea8(0x255)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0xb8dea8(0x222)}}}]),_0x273187=await warehouse['aggregate']([{'$match':{'name':_0x34c3bb,'room':_0x4cb703}},{'$unwind':_0xb8dea8(0x201)},{'$match':{'product_details.secondary_code':_0x47f60e}},{'$group':{'_id':_0xb8dea8(0x1ca),'name':{'$first':_0xb8dea8(0x246)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xb8dea8(0x1ad)},'secondary_code':{'$first':_0xb8dea8(0x1c5)},'product_code':{'$first':_0xb8dea8(0x23a)},'level':{'$first':_0xb8dea8(0x204)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0xb8dea8(0x1a6)},'unit':{'$first':_0xb8dea8(0x1b7)},'secondary_unit':{'$first':_0xb8dea8(0x189)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xb8dea8(0x1dc)},'expiry_date':{'$first':_0xb8dea8(0x1ac)},'production_date':{'$first':_0xb8dea8(0x23e)},'maxPerUnit':{'$first':_0xb8dea8(0x1f1)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0xb8dea8(0x255)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0xb8dea8(0x232)}}}]);if(_0x4e529c[_0xb8dea8(0x184)]>0x0)_0x5696b2[_0xb8dea8(0x24c)](_0x4e529c);else _0x273187[_0xb8dea8(0x184)]>0x0&&_0x5696b2[_0xb8dea8(0x24c)](_0x273187);}const _0x314dc8=_0xa89aae[_0x24874c(0x1ef)](_0x8d84d8=>_0x21206b(_0x8d84d8));await Promise['all'](_0x314dc8),_0x2f563e['json'](_0x5696b2);}),router['post']('/CheckingWarehouse',async(_0xe6606d,_0x26493c)=>{var _0x44b95f=a0_0x14e883;const {primaryCode:_0x33d06a,secondaryCode:_0x516331,productCode:_0x40b6f7,level:_0x1cba6b,isle:_0x3714b5,pallet:_0x4f9f4a,warehouses:_0x30cc32,room:_0x156529}=_0xe6606d[_0x44b95f(0x22e)];try{const _0x3ed8ea=await warehouse['aggregate']([{'$match':{'name':_0x30cc32,'room':_0x156529}},{'$unwind':_0x44b95f(0x201)},{'$match':{'product_details.level':parseInt(_0x1cba6b),'product_details.isle':_0x3714b5,'product_details.pallet':parseInt(_0x4f9f4a)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x44b95f(0x246)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x44b95f(0x22b)},'isle':{'$first':_0x44b95f(0x20e)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x44b95f(0x237)}}}]);_0x26493c[_0x44b95f(0x1ae)](0xc8)[_0x44b95f(0x244)](_0x3ed8ea);}catch(_0x3e58aa){_0x26493c[_0x44b95f(0x1ae)](0x194)[_0x44b95f(0x244)]({'message':_0x3e58aa[_0x44b95f(0x18b)]});}}),module['exports']=router;