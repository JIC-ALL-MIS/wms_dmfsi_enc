var a0_0x250c1d=a0_0x1cac;(function(_0x541f39,_0x3e94fe){var _0x412910=a0_0x1cac,_0x301abf=_0x541f39();while(!![]){try{var _0x2e5cdd=-parseInt(_0x412910(0x117))/0x1*(-parseInt(_0x412910(0x10f))/0x2)+-parseInt(_0x412910(0x1d9))/0x3+-parseInt(_0x412910(0x170))/0x4*(-parseInt(_0x412910(0x1d3))/0x5)+parseInt(_0x412910(0x13c))/0x6+-parseInt(_0x412910(0x141))/0x7*(parseInt(_0x412910(0x127))/0x8)+-parseInt(_0x412910(0x119))/0x9+parseInt(_0x412910(0x1d6))/0xa;if(_0x2e5cdd===_0x3e94fe)break;else _0x301abf['push'](_0x301abf['shift']());}catch(_0x317a09){_0x301abf['push'](_0x301abf['shift']());}}}(a0_0x43bb,0xade68));const express=require(a0_0x250c1d(0x169)),app=express(),router=express[a0_0x250c1d(0x174)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x250c1d(0x192)),nodemailer=require(a0_0x250c1d(0x11d));function a0_0x43bb(){var _0x1a6a7e=['$product_details.product_code','/picking_list/PDF_adjustment_rm/','params','English\x20(US)','stock','RMSEmail','secondary_code','date','English','find','catch','</tr>','prime1','$product_details.expiry_date','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','success','adjustment\x20add\x20successfull','production_date','redirect','True','adjustment\x20data\x20update\x20successfully','aggregate','findById','4925010KdeZvW','</span>','$product_details.product_stock','16791980BULQSi','types','image','3106728bDZpPy','padStart','user','/view/:id','error','/view/add_adjustment','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Shelves','floorlevel','warehouse','Arabic\x20(ae)','Hindi','site_title','34QHjlLn','$product_details.maxPerUnit','/upload/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','forEach','prod_cat','27673VqstwL','$product_details.secondary_code','1647324EmNghp','<h2>\x20','finalize','then','nodemailer','$product_details.production_date','map','$product_details.storage','$product_details.level','adjustment\x20Finalized\x20successfully','$product_details.pallet','unit','staff','prod_invoice','16mWoIOZ','$product_details.secondary_unit','Arabic','push','json','Return\x20Goods','$room','product_details','New_Qty_Converted','product_name','$product_details.rack','False','</head><body>','</h5>','expiry_date','/adjustment/preview/','foreach\x20newproduct','$product','/view','Chinese','errors','41526HnasXy','add_adjustment','maxperunit','host','<tbody\x20style=\x22text-align:\x20center;\x22>','4237289ctuTvc','adjustment','get','room','prod_name','log','post','string','</div>','port','findOne','max_per_unit','$isAllowEdit','$product_details.primary_code','language','<div>','Portuguese','Raw\x20Materials','minus','</thead>','back','bin','status','length','note','Adjustment\x20Mail','$name','$product_details.isle','$product.room_names','$product_details.batch_code','Secondary_units','Level','Rooms','Primary_Units','<strong>\x20Regards\x20</strong>','An\x20error\x20occurred\x20while\x20saving\x20data.','Email\x20sent\x20successfully','$product_details.maxProducts','slice','secondary_unit','express','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','_id','stockBefore','Ambient','batch_code','4qMRYYH','<!DOCTYPE\x20html>','invoice','$product_details.bin','Router','\x20<>\x20','$_id','product_stock','Error\x20Occurs','An\x20error\x20occurred.','/preview/:id','second1','$product_details.product_cat','role','$product_details','logo','/CheckingWarehouse','$product_details.product_name','$product_details.floorlevel','ADJ-','edit_adjustment','</tbody>','Enclosed','filter','Enabled','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','German','level','French','all','prod_code','$finalize','Spanish','../public/language/languages.json','Return\x20Rooms','type','<h5>','flash','render','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.type','</table>','<span\x20style=\x22float:\x20right;\x22>','product','Portuguese\x20(BR)','password','maxPerUnit','random','warehouse_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','rack','save','createTransport','$product.product_name','</td>','sendMail','product_code','new_adjust_qty','New_Qty_Converted_adj','floor','$date','/barcode_scanner','adjust_qty','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','room_names','storage','/adjustment/view','exports','message','$product_details.bay','body','email','<h5\x20style=\x22text-align:\x20left;\x22>'];a0_0x43bb=function(){return _0x1a6a7e;};return a0_0x43bb();}router['get'](a0_0x250c1d(0x139),auth,async(_0x34cc56,_0x867de6)=>{var _0x4a3774=a0_0x250c1d;try{const {username:_0x34bf82,email:_0x2fc850,role:_0x2f5be7}=_0x34cc56['user'],_0x44e73b=_0x34cc56[_0x4a3774(0x1db)],_0x1e8044=await profile[_0x4a3774(0x14b)]({'email':_0x44e73b['email']}),_0x40241f=await master_shop[_0x4a3774(0x1c5)]();console[_0x4a3774(0x146)]('master',_0x40241f);let _0x2ef843;if(_0x44e73b[_0x4a3774(0x17d)]==_0x4a3774(0x125)){const _0x5133b0=await staff[_0x4a3774(0x14b)]({'email':_0x44e73b[_0x4a3774(0x1ba)]});_0x2ef843=await warehouse[_0x4a3774(0x1c5)]({'status':_0x4a3774(0x188),'name':_0x5133b0[_0x4a3774(0x10b)]});}else _0x2ef843=await warehouse[_0x4a3774(0x1c5)]({'status':_0x4a3774(0x188)});const _0x32b3e4=await product[_0x4a3774(0x1c5)]();let _0x4f5bcf;if(_0x44e73b['role']==_0x4a3774(0x125)){const _0x21662d=await staff[_0x4a3774(0x14b)]({'email':_0x44e73b[_0x4a3774(0x1ba)]});_0x4f5bcf=await adjustment['find']({'warehouse_name':_0x21662d['warehouse']});}else _0x4f5bcf=await adjustment[_0x4a3774(0x1d1)]([{'$unwind':_0x4a3774(0x138)},{'$group':{'_id':_0x4a3774(0x176),'invoice':{'$first':'$invoice'},'date':{'$first':_0x4a3774(0x1ae)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x4a3774(0x15d)},'finalize':{'$first':_0x4a3774(0x190)},'isAllowEdit':{'$first':_0x4a3774(0x14d)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x40241f[0x0][_0x4a3774(0x14f)]==_0x4a3774(0x1bf)){var _0x11aeb5=users[_0x4a3774(0x1c4)];console['log'](_0x11aeb5);}else{if(_0x40241f[0x0][_0x4a3774(0x14f)]==_0x4a3774(0x10d))var _0x11aeb5=users[_0x4a3774(0x10d)];else{if(_0x40241f[0x0][_0x4a3774(0x14f)]==_0x4a3774(0x18b))var _0x11aeb5=users['German'];else{if(_0x40241f[0x0]['language']==_0x4a3774(0x191))var _0x11aeb5=users[_0x4a3774(0x191)];else{if(_0x40241f[0x0]['language']==_0x4a3774(0x18d))var _0x11aeb5=users[_0x4a3774(0x18d)];else{if(_0x40241f[0x0][_0x4a3774(0x14f)]==_0x4a3774(0x19e))var _0x11aeb5=users[_0x4a3774(0x151)];else{if(_0x40241f[0x0][_0x4a3774(0x14f)]==_0x4a3774(0x13a))var _0x11aeb5=users[_0x4a3774(0x13a)];else{if(_0x40241f[0x0]['language']==_0x4a3774(0x10c))var _0x11aeb5=users[_0x4a3774(0x129)];}}}}}}}_0x867de6['render'](_0x4a3774(0x142),{'success':_0x34cc56['flash']('success'),'errors':_0x34cc56[_0x4a3774(0x196)](_0x4a3774(0x13b)),'role':_0x44e73b,'profile':_0x1e8044,'warehouse':_0x2ef843,'product':_0x32b3e4,'adjustment':_0x4f5bcf,'master_shop':_0x40241f,'language':_0x11aeb5});}catch(_0x2c6b1e){console[_0x4a3774(0x146)](_0x2c6b1e);}});async function getRandom8DigitNumber(){var _0x38932f=a0_0x250c1d;const _0x4885ce=0x989680,_0x541431=0x5f5e0ff,_0x475e71=Math[_0x38932f(0x1ad)](Math[_0x38932f(0x1a1)]()*(_0x541431-_0x4885ce+0x1))+_0x4885ce;var _0x12d1fe;const _0xe84c6=await adjustment[_0x38932f(0x14b)]({'invoice':'ADJ-'+_0x475e71});return _0xe84c6&&_0xe84c6['length']>0x0?_0x12d1fe='ADJ-'+_0x475e71:_0x12d1fe=_0x38932f(0x183)+_0x475e71,_0x12d1fe;}function a0_0x1cac(_0x3d71be,_0x4976c0){var _0x43bb0d=a0_0x43bb();return a0_0x1cac=function(_0x1cac6a,_0x22e02d){_0x1cac6a=_0x1cac6a-0x10a;var _0x2ed511=_0x43bb0d[_0x1cac6a];return _0x2ed511;},a0_0x1cac(_0x3d71be,_0x4976c0);}router[a0_0x250c1d(0x143)](a0_0x250c1d(0x1de),auth,async(_0x3691a9,_0x5baad2)=>{var _0x4e096b=a0_0x250c1d;try{const {username:_0xc54288,email:_0x56734b,role:_0x37094a}=_0x3691a9[_0x4e096b(0x1db)],_0x56c6ed=_0x3691a9[_0x4e096b(0x1db)],_0x2475bb=await profile[_0x4e096b(0x14b)]({'email':_0x56c6ed[_0x4e096b(0x1ba)]}),_0x2606ac=await master_shop['find']();let _0x503f97;if(_0x56c6ed[_0x4e096b(0x17d)]==_0x4e096b(0x125)){const _0x127cbd=await staff[_0x4e096b(0x14b)]({'email':_0x56c6ed[_0x4e096b(0x1ba)]});_0x503f97=await warehouse[_0x4e096b(0x1d1)]([{'$match':{'status':'Enabled','name':_0x127cbd[_0x4e096b(0x10b)],'warehouse_category':_0x4e096b(0x152),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x4e096b(0x15b),'name':{'$first':_0x4e096b(0x15b)}}}]);}else _0x503f97=await warehouse['aggregate']([{'$match':{'status':_0x4e096b(0x188),'warehouse_category':_0x4e096b(0x152),'name':{'$ne':_0x4e096b(0x12c)}}},{'$group':{'_id':_0x4e096b(0x15b),'name':{'$first':_0x4e096b(0x15b)}}}]);const _0x4b2875=await product[_0x4e096b(0x1c5)]({}),_0x36ad03=await adjustment[_0x4e096b(0x1c5)]({}),_0x2215ef=_0x36ad03[_0x4e096b(0x158)]+0x1,_0x34ec15=_0x4e096b(0x183)+_0x2215ef['toString']()[_0x4e096b(0x1da)](0x5,'0');var _0x4aec9a=[_0x4e096b(0x16e),_0x4e096b(0x186),_0x4e096b(0x193)];if(_0x2606ac[0x0]['language']==_0x4e096b(0x1bf))var _0x358ec4=users[_0x4e096b(0x1c4)];else{if(_0x2606ac[0x0]['language']=='Hindi')var _0x358ec4=users[_0x4e096b(0x10d)];else{if(_0x2606ac[0x0][_0x4e096b(0x14f)]=='German')var _0x358ec4=users[_0x4e096b(0x18b)];else{if(_0x2606ac[0x0][_0x4e096b(0x14f)]==_0x4e096b(0x191))var _0x358ec4=users[_0x4e096b(0x191)];else{if(_0x2606ac[0x0][_0x4e096b(0x14f)]==_0x4e096b(0x18d))var _0x358ec4=users[_0x4e096b(0x18d)];else{if(_0x2606ac[0x0]['language']==_0x4e096b(0x19e))var _0x358ec4=users[_0x4e096b(0x151)];else{if(_0x2606ac[0x0]['language']==_0x4e096b(0x13a))var _0x358ec4=users['Chinese'];else{if(_0x2606ac[0x0]['language']==_0x4e096b(0x10c))var _0x358ec4=users['Arabic'];}}}}}}}const _0x16e37e=getRandom8DigitNumber();_0x16e37e[_0x4e096b(0x11c)](_0x339aee=>{var _0x5a4bfe=_0x4e096b;_0x5baad2[_0x5a4bfe(0x197)](_0x5a4bfe(0x13d),{'success':_0x3691a9[_0x5a4bfe(0x196)](_0x5a4bfe(0x1cb)),'errors':_0x3691a9[_0x5a4bfe(0x196)](_0x5a4bfe(0x13b)),'role':_0x56c6ed,'profile':_0x2475bb,'warehouse':_0x503f97,'product':_0x4b2875,'master_shop':_0x2606ac,'language':_0x358ec4,'rooms_data':_0x4aec9a,'invoice_no':_0x339aee});})[_0x4e096b(0x1c6)](_0x533625=>{var _0xb7e431=_0x4e096b;_0x3691a9['flash']('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x5baad2[_0xb7e431(0x1ce)](_0xb7e431(0x1b5));});}catch(_0x23dfda){console[_0x4e096b(0x146)](_0x23dfda);}}),router[a0_0x250c1d(0x147)]('/view/add_adjustment',auth,async(_0x27b2c3,_0x5a5a18)=>{var _0x1ebe00=a0_0x250c1d;try{const {warehouse_name:_0x11a6fb,date:_0x1f802f,prod_name:_0x35f3af,level:_0x2b0f37,isle:_0x10b6a2,pallet:_0x162637,stock:_0xd273ea,types:_0xefde6c,adjust_qty:_0x2ab825,new_adjust_qty:_0x35e37f,note:_0x2e9ce2,Room_name:_0xfabbca,invoice:_0x3ccb96,JO_number:_0x230298,expiry_date:_0x4af019}=_0x27b2c3[_0x1ebe00(0x1b9)];if(typeof _0x35f3af==_0x1ebe00(0x148))var _0x1e82c2=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x145)]],_0x2f396e=[_0x27b2c3[_0x1ebe00(0x1b9)]['level']],_0x9d7b19=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x1c0)]],_0x505783=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x1d7)]],_0x36c013=[_0x27b2c3[_0x1ebe00(0x1b9)]['New_Qty_Converted_adj']],_0x538fa3=[_0x27b2c3['body'][_0x1ebe00(0x12f)]],_0x31b67e=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x162)]],_0x13b1aa=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x15f)]],_0x269876=[_0x27b2c3[_0x1ebe00(0x1b9)]['prod_code']],_0x24a0ab=[_0x27b2c3['body'][_0x1ebe00(0x16f)]],_0x29394e=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x135)]],_0x5564d0=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x14c)]],_0x21ba3a=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x1cd)]],_0x5bae0d=[_0x27b2c3['body'][_0x1ebe00(0x116)]],_0x6730f3=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x161)]],_0xbc157b=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x1c8)]],_0x16f211=[_0x27b2c3[_0x1ebe00(0x1b9)]['second1']],_0x56e5da=[_0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x126)]];else var _0x1e82c2=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x145)]],_0x2f396e=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x18c)]],_0x9d7b19=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x1c0)]],_0x505783=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x1d7)]],_0x36c013=[..._0x27b2c3['body'][_0x1ebe00(0x1ac)]],_0x538fa3=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x12f)]],_0x31b67e=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x124)]],_0x13b1aa=[..._0x27b2c3['body']['Secondary_units']],_0x269876=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x18f)]],_0x24a0ab=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x16f)]],_0x29394e=[..._0x27b2c3['body'][_0x1ebe00(0x135)]],_0x5564d0=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x14c)]],_0x21ba3a=[..._0x27b2c3['body'][_0x1ebe00(0x1cd)]],_0x5bae0d=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x116)]],_0x6730f3=[..._0x27b2c3['body'][_0x1ebe00(0x161)]],_0xbc157b=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x1c8)]],_0x16f211=[..._0x27b2c3[_0x1ebe00(0x1b9)]['second1']],_0x56e5da=[..._0x27b2c3[_0x1ebe00(0x1b9)][_0x1ebe00(0x126)]];const _0xfd6ca2=_0x1e82c2['map'](_0x3e6476=>{return _0x3e6476={'product_name':_0x3e6476};});_0x2f396e[_0x1ebe00(0x115)]((_0x2536b8,_0xc21038)=>{var _0x5612ed=_0x1ebe00;_0x6730f3[_0x5612ed(0x115)]((_0x1b948e,_0x5280fe)=>{var _0x2fa23b=_0x5612ed;if(_0x1b948e=='Receiving\x20Area'&&_0xc21038==_0x5280fe){var _0xe6b267=_0x2536b8['slice'](0x3);_0xfd6ca2[_0xc21038][_0x2fa23b(0x1b4)]=_0x2536b8[0x0],_0xfd6ca2[_0xc21038][_0x2fa23b(0x1a4)]=_0x2536b8[0x1],_0xfd6ca2[_0xc21038][_0x2fa23b(0x189)]=0x0,_0xfd6ca2[_0xc21038][_0x2fa23b(0x156)]=0x0,_0xfd6ca2[_0xc21038]['type']=_0x2fa23b(0x1b1),_0xfd6ca2[_0xc21038]['floorlevel']=_0xe6b267;}else{if(_0x1b948e=='Shelves'&&_0xc21038==_0x5280fe){var _0xe6b267=_0x2536b8[_0x2fa23b(0x167)](0x3);_0xfd6ca2[_0xc21038][_0x2fa23b(0x1b4)]=_0x2536b8[0x0],_0xfd6ca2[_0xc21038][_0x2fa23b(0x1a4)]=_0x2536b8[0x1],_0xfd6ca2[_0xc21038][_0x2fa23b(0x189)]=0x0,_0xfd6ca2[_0xc21038]['bin']=0x0,_0xfd6ca2[_0xc21038]['type']='Floor',_0xfd6ca2[_0xc21038][_0x2fa23b(0x10a)]=_0x2536b8[0x5];}else{if(_0xc21038==_0x5280fe){var _0x30520d;if(_0x2536b8[0x4]=='L')_0x30520d=_0x2fa23b(0x160);else _0x2536b8[0x4]=='F'&&(_0x30520d=_0x2fa23b(0x1b1));_0xfd6ca2[_0xc21038][_0x2fa23b(0x1b4)]=_0x2536b8[0x0],_0xfd6ca2[_0xc21038][_0x2fa23b(0x1a4)]=_0x2536b8[0x1],_0xfd6ca2[_0xc21038][_0x2fa23b(0x189)]=_0x2536b8[0x2],_0xfd6ca2[_0xc21038][_0x2fa23b(0x156)]=_0x2536b8[0x3],_0xfd6ca2[_0xc21038]['type']=_0x30520d,_0xfd6ca2[_0xc21038][_0x2fa23b(0x10a)]=_0x2536b8[0x5];}}}});}),_0x9d7b19[_0x1ebe00(0x115)]((_0x1d6e6b,_0x3ece0b)=>{var _0x7f7682=_0x1ebe00;_0xfd6ca2[_0x3ece0b][_0x7f7682(0x16d)]=_0x1d6e6b;}),_0x505783[_0x1ebe00(0x115)]((_0x462d91,_0x4a8937)=>{var _0x4499c9=_0x1ebe00;_0xfd6ca2[_0x4a8937][_0x4499c9(0x1d7)]=_0x462d91;}),_0x36c013[_0x1ebe00(0x115)]((_0x1dafb0,_0xc0553d)=>{var _0x8aba56=_0x1ebe00;_0xfd6ca2[_0xc0553d][_0x8aba56(0x1b0)]=_0x1dafb0;}),_0x538fa3[_0x1ebe00(0x115)]((_0x1d267e,_0x4c3e04)=>{var _0x529fcb=_0x1ebe00;_0xfd6ca2[_0x4c3e04][_0x529fcb(0x1ab)]=_0x1d267e;}),_0x31b67e[_0x1ebe00(0x115)]((_0x2c03a6,_0x43f713)=>{var _0x33af25=_0x1ebe00;_0xfd6ca2[_0x43f713][_0x33af25(0x124)]=_0x2c03a6;}),_0x13b1aa[_0x1ebe00(0x115)]((_0x1e8fdc,_0xd23a8a)=>{_0xfd6ca2[_0xd23a8a]['secondary_unit']=_0x1e8fdc;}),_0x269876[_0x1ebe00(0x115)]((_0x12accd,_0x10638d)=>{var _0xa5d5ca=_0x1ebe00;_0xfd6ca2[_0x10638d][_0xa5d5ca(0x1aa)]=_0x12accd;}),_0x24a0ab['forEach']((_0x2ba063,_0x3d79c1)=>{var _0x3bec77=_0x1ebe00;_0xfd6ca2[_0x3d79c1][_0x3bec77(0x16f)]=_0x2ba063;}),_0x29394e[_0x1ebe00(0x115)]((_0x5e6244,_0x29515a)=>{var _0x4db54d=_0x1ebe00;_0xfd6ca2[_0x29515a][_0x4db54d(0x135)]=_0x5e6244;}),_0x5564d0[_0x1ebe00(0x115)]((_0x105a50,_0x3268ab)=>{var _0xbcf4e1=_0x1ebe00;_0xfd6ca2[_0x3268ab][_0xbcf4e1(0x13e)]=_0x105a50;}),_0x21ba3a[_0x1ebe00(0x115)]((_0x7b137f,_0x6aecd)=>{var _0x5642a6=_0x1ebe00;_0xfd6ca2[_0x6aecd][_0x5642a6(0x1cd)]=_0x7b137f;}),_0x5bae0d['forEach']((_0x358dac,_0x3f9e36)=>{var _0x328fc9=_0x1ebe00;_0xfd6ca2[_0x3f9e36][_0x328fc9(0x116)]=_0x358dac;}),_0x6730f3[_0x1ebe00(0x115)]((_0x3a0bd9,_0x30eccb)=>{var _0xbe9cf9=_0x1ebe00;_0xfd6ca2[_0x30eccb][_0xbe9cf9(0x1b3)]=_0x3a0bd9;}),_0xbc157b['forEach']((_0x2abccb,_0x563ac0)=>{_0xfd6ca2[_0x563ac0]['primary_code']=_0x2abccb;}),_0x16f211[_0x1ebe00(0x115)]((_0x6de801,_0x54266c)=>{var _0x592482=_0x1ebe00;_0xfd6ca2[_0x54266c][_0x592482(0x1c2)]=_0x6de801;}),_0x56e5da[_0x1ebe00(0x115)]((_0x5b7d0a,_0x36df1f)=>{var _0x1d0211=_0x1ebe00;_0xfd6ca2[_0x36df1f][_0x1d0211(0x172)]=_0x5b7d0a;});const _0x2a46ff=_0xfd6ca2[_0x1ebe00(0x187)](_0x3e98d6=>_0x3e98d6['adjust_qty']!=='0'&&_0x3e98d6[_0x1ebe00(0x1b0)]!=='');var _0x1273db=0x0;_0x2a46ff[_0x1ebe00(0x115)](_0x2a76a8=>{var _0xcd2720=_0x1ebe00;console['log'](_0xcd2720(0x137),_0x2a76a8),parseInt(_0x2a76a8[_0xcd2720(0x1b0)])<=0x0&&_0x1273db++;});if(_0x1273db!=0x0)return _0x27b2c3[_0x1ebe00(0x196)](_0x1ebe00(0x13b),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x5a5a18[_0x1ebe00(0x1ce)](_0x1ebe00(0x155));const _0x4a0238=new adjustment({'warehouse_name':_0x11a6fb,'date':_0x1f802f,'product':_0x2a46ff,'note':_0x2e9ce2,'room':_0xfabbca,'invoice':_0x3ccb96,'JO_number':_0x230298,'expiry_date':_0x4af019}),_0x1be96b=await _0x4a0238[_0x1ebe00(0x1a5)]();_0x27b2c3['flash'](_0x1ebe00(0x1cb),_0x1ebe00(0x1cc)),_0x5a5a18[_0x1ebe00(0x1ce)](_0x1ebe00(0x136)+_0x1be96b['_id']);}catch(_0x181985){console[_0x1ebe00(0x146)](_0x181985),_0x5a5a18[_0x1ebe00(0x157)](0xc8)[_0x1ebe00(0x12b)]({'message':_0x181985['message']});}}),router['get'](a0_0x250c1d(0x17a),auth,async(_0x1f7680,_0x558d81)=>{var _0x49be78=a0_0x250c1d;try{const {username:_0xdec590,email:_0x1ed97a,role:_0x3d3eea}=_0x1f7680['user'],_0x6bbb91=_0x1f7680['user'],_0x105169=await profile[_0x49be78(0x14b)]({'email':_0x6bbb91[_0x49be78(0x1ba)]}),_0xa7b173=await master_shop[_0x49be78(0x1c5)](),_0x2f4c82=_0x1f7680['params']['id'],_0x302200=await adjustment[_0x49be78(0x1d2)]({'_id':_0x2f4c82}),_0x47edda=await purchases['aggregate']([{'$match':{'warehouse_name':_0x302200[_0x49be78(0x1a2)]}},{'$unwind':_0x49be78(0x138)},{'$group':{'_id':_0x49be78(0x1a7)}}]),_0x56b42a=await product[_0x49be78(0x1c5)]({}),_0x3a105d=await warehouse[_0x49be78(0x1d1)]([{'$match':{'name':_0x302200['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x49be78(0x198),'name':{'$first':_0x49be78(0x181)},'product_stock':{'$first':_0x49be78(0x1d5)},'bay':{'$first':_0x49be78(0x1b8)},'bin':{'$first':_0x49be78(0x173)},'type':{'$first':_0x49be78(0x19a)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x49be78(0x14e)},'secondary_code':{'$first':_0x49be78(0x118)},'product_code':{'$first':_0x49be78(0x1bc)},'storage':{'$first':_0x49be78(0x120)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x49be78(0x110)},'expiry_date':{'$first':_0x49be78(0x1c9)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x49be78(0x15e)},'room':{'$first':_0x49be78(0x12d)}}}]);if(_0xa7b173[0x0][_0x49be78(0x14f)]==_0x49be78(0x1bf)){var _0x62b47b=users['English'];console['log'](_0x62b47b);}else{if(_0xa7b173[0x0][_0x49be78(0x14f)]==_0x49be78(0x10d))var _0x62b47b=users[_0x49be78(0x10d)];else{if(_0xa7b173[0x0][_0x49be78(0x14f)]==_0x49be78(0x18b))var _0x62b47b=users[_0x49be78(0x18b)];else{if(_0xa7b173[0x0][_0x49be78(0x14f)]==_0x49be78(0x191))var _0x62b47b=users[_0x49be78(0x191)];else{if(_0xa7b173[0x0]['language']==_0x49be78(0x18d))var _0x62b47b=users[_0x49be78(0x18d)];else{if(_0xa7b173[0x0]['language']==_0x49be78(0x19e))var _0x62b47b=users[_0x49be78(0x151)];else{if(_0xa7b173[0x0][_0x49be78(0x14f)]=='Chinese')var _0x62b47b=users[_0x49be78(0x13a)];else{if(_0xa7b173[0x0][_0x49be78(0x14f)]=='Arabic\x20(ae)')var _0x62b47b=users[_0x49be78(0x129)];}}}}}}}_0x558d81[_0x49be78(0x197)]('edit_adjustment_view',{'success':_0x1f7680[_0x49be78(0x196)](_0x49be78(0x1cb)),'errors':_0x1f7680['flash'](_0x49be78(0x13b)),'role':_0x6bbb91,'profile':_0x105169,'adjustment':_0x302200,'stock':_0x3a105d,'master_shop':_0xa7b173,'warehouse_name':_0x47edda,'unit':_0x56b42a,'language':_0x62b47b});}catch(_0x4c3a29){console[_0x49be78(0x146)](_0x4c3a29),_0x558d81[_0x49be78(0x157)](0xc8)[_0x49be78(0x12b)]({'message':_0x4c3a29['message']});}}),router[a0_0x250c1d(0x147)]('/preview/:id',auth,async(_0x25c0c0,_0x638a85)=>{var _0x2f6f59=a0_0x250c1d;try{const _0x2a12b8=_0x25c0c0[_0x2f6f59(0x1be)]['id'],{warehouse_name:_0x58714e,Room_name:_0x230f51}=_0x25c0c0['body'],_0x17d9c7=await adjustment['findById']({'_id':_0x2a12b8}),_0x8bcd83=_0x17d9c7['product'][_0x2f6f59(0x11f)](async _0x5d5ff6=>{var _0x4be35f=_0x2f6f59;if(_0x5d5ff6[_0x4be35f(0x1b0)]>0x0){var _0x3680ad=await warehouse[_0x4be35f(0x14b)]({'name':_0x58714e,'room':_0x5d5ff6[_0x4be35f(0x1b3)],'warehouse_category':_0x4be35f(0x152)});const _0x2578d8=_0x3680ad[_0x4be35f(0x12e)][_0x4be35f(0x11f)](_0xf5eb56=>{var _0x4dd7a1=_0x4be35f;if(_0x5d5ff6[_0x4dd7a1(0x194)]==_0x4dd7a1(0x153)){if(_0xf5eb56[_0x4dd7a1(0x130)]==_0x5d5ff6[_0x4dd7a1(0x130)]&&_0xf5eb56[_0x4dd7a1(0x10a)]==_0x5d5ff6['floorlevel']&&_0xf5eb56['type']==_0x5d5ff6['type']&&_0xf5eb56[_0x4dd7a1(0x156)]==_0x5d5ff6['bin']&&_0xf5eb56[_0x4dd7a1(0x189)]==_0x5d5ff6[_0x4dd7a1(0x189)]&&_0xf5eb56[_0x4dd7a1(0x1a4)]==_0x5d5ff6['rack']&&_0xf5eb56['storage']==_0x5d5ff6[_0x4dd7a1(0x1b4)]&&_0xf5eb56[_0x4dd7a1(0x135)]==_0x5d5ff6['expiry_date']&&_0xf5eb56[_0x4dd7a1(0x16f)]==_0x5d5ff6[_0x4dd7a1(0x16f)]&&_0xf5eb56['production_date']==_0x5d5ff6[_0x4dd7a1(0x1cd)]&&_0xf5eb56[_0x4dd7a1(0x172)]==_0x5d5ff6[_0x4dd7a1(0x172)]){var _0x3cd7d2;_0x3cd7d2=_0x5d5ff6[_0x4dd7a1(0x1b0)],_0x5d5ff6[_0x4dd7a1(0x116)]=='S'&&(_0x3cd7d2=_0x5d5ff6[_0x4dd7a1(0x1b0)]),_0xf5eb56[_0x4dd7a1(0x177)]=_0xf5eb56[_0x4dd7a1(0x177)]-_0x3cd7d2;}}else{if(_0xf5eb56[_0x4dd7a1(0x130)]==_0x5d5ff6[_0x4dd7a1(0x130)]&&_0xf5eb56[_0x4dd7a1(0x10a)]==_0x5d5ff6['floorlevel']&&_0xf5eb56[_0x4dd7a1(0x194)]==_0x5d5ff6[_0x4dd7a1(0x194)]&&_0xf5eb56[_0x4dd7a1(0x156)]==_0x5d5ff6['bin']&&_0xf5eb56[_0x4dd7a1(0x189)]==_0x5d5ff6[_0x4dd7a1(0x189)]&&_0xf5eb56[_0x4dd7a1(0x1a4)]==_0x5d5ff6['rack']&&_0xf5eb56[_0x4dd7a1(0x1b4)]==_0x5d5ff6[_0x4dd7a1(0x1b4)]&&_0xf5eb56[_0x4dd7a1(0x135)]==_0x5d5ff6['expiry_date']&&_0xf5eb56['batch_code']==_0x5d5ff6[_0x4dd7a1(0x16f)]&&_0xf5eb56[_0x4dd7a1(0x1cd)]==_0x5d5ff6[_0x4dd7a1(0x1cd)]&&_0xf5eb56[_0x4dd7a1(0x172)]==_0x5d5ff6[_0x4dd7a1(0x172)]){console['log'](_0x5d5ff6);var _0x3cd7d2;_0x3cd7d2=_0x5d5ff6[_0x4dd7a1(0x1b0)],_0x5d5ff6[_0x4dd7a1(0x116)]=='S'&&(_0x3cd7d2=_0x5d5ff6[_0x4dd7a1(0x1b0)]),console[_0x4dd7a1(0x146)](_0x3cd7d2+_0x4dd7a1(0x175)+_0x5d5ff6[_0x4dd7a1(0x1b0)]+_0x4dd7a1(0x175)+_0xf5eb56[_0x4dd7a1(0x1a0)]+_0x4dd7a1(0x175)+_0x5d5ff6[_0x4dd7a1(0x116)]),_0xf5eb56[_0x4dd7a1(0x177)]=_0xf5eb56[_0x4dd7a1(0x177)]+_0x3cd7d2;}}});}return _0x3680ad;});Promise[_0x2f6f59(0x18e)](_0x8bcd83)['then'](async _0x528e3e=>{var _0x485a65=_0x2f6f59;try{for(const _0x4c80f8 of _0x528e3e){await _0x4c80f8['save']();}_0x17d9c7[_0x485a65(0x11b)]=_0x485a65(0x1cf);const _0x14871d=await _0x17d9c7[_0x485a65(0x1a5)](),_0x311003=await master_shop['find'](),_0x5d48f1=await email_settings[_0x485a65(0x14b)](),_0x522269=await supervisor_settings[_0x485a65(0x1c5)]();var _0x1ce94f=_0x17d9c7['product'],_0x105e00='',_0x437353;for(_0x437353 in _0x1ce94f){_0x105e00+='<tr>'+_0x485a65(0x16b)+_0x1ce94f[_0x437353][_0x485a65(0x130)]+_0x485a65(0x1a8)+_0x485a65(0x16b)+_0x1ce94f[_0x437353][_0x485a65(0x1aa)]+_0x485a65(0x1a8)+_0x485a65(0x16b)+_0x1ce94f[_0x437353][_0x485a65(0x1b0)]+_0x485a65(0x1a8)+_0x485a65(0x16b)+_0x1ce94f[_0x437353]['unit']+'</td>'+_0x485a65(0x16b)+_0x1ce94f[_0x437353][_0x485a65(0x168)]+_0x485a65(0x1a8)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x17d9c7['warehouse_name']+_0x485a65(0x1a8)+_0x485a65(0x16b)+_0x1ce94f[_0x437353][_0x485a65(0x1b3)]+_0x485a65(0x1a8)+_0x485a65(0x16b)+_0x1ce94f[_0x437353][_0x485a65(0x1b4)]+_0x1ce94f[_0x437353][_0x485a65(0x1a4)]+_0x1ce94f[_0x437353]['bay']+_0x1ce94f[_0x437353][_0x485a65(0x156)]+_0x1ce94f[_0x437353]['type'][0x0]+_0x1ce94f[_0x437353][_0x485a65(0x10a)]+_0x485a65(0x1a8),'</tr>';}let _0x176877=nodemailer[_0x485a65(0x1a6)]({'host':_0x5d48f1[_0x485a65(0x13f)],'port':Number(_0x5d48f1[_0x485a65(0x14a)]),'secure':![],'auth':{'user':_0x5d48f1[_0x485a65(0x1ba)],'pass':_0x5d48f1[_0x485a65(0x19f)]}}),_0x22dd5b={'from':_0x5d48f1['email'],'to':_0x522269[0x0][_0x485a65(0x1c1)],'subject':_0x485a65(0x15a),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x485a65(0x111)+_0x311003[0x0][_0x485a65(0x1d8)],'cid':_0x485a65(0x17f)}],'html':_0x485a65(0x171)+'<html><head><title></title>'+_0x485a65(0x133)+_0x485a65(0x150)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x485a65(0x1df)+_0x485a65(0x149)+_0x485a65(0x150)+_0x485a65(0x11a)+_0x311003[0x0][_0x485a65(0x10e)]+'\x20</h2>'+_0x485a65(0x149)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x485a65(0x150)+_0x485a65(0x1bb)+'\x20Order\x20Number\x20:\x20'+_0x17d9c7[_0x485a65(0x172)]+'\x20'+_0x485a65(0x19c)+'\x20Order\x20Date\x20:\x20'+_0x17d9c7['date']+'\x20'+_0x485a65(0x1d4)+_0x485a65(0x134)+_0x485a65(0x149)+_0x485a65(0x16a)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x485a65(0x113)+_0x485a65(0x112)+_0x485a65(0x18a)+_0x485a65(0x114)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x485a65(0x1b2)+_0x485a65(0x1a3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x485a65(0x199)+_0x485a65(0x1c7)+_0x485a65(0x154)+_0x485a65(0x140)+'\x20'+_0x105e00+'\x20'+_0x485a65(0x185)+_0x485a65(0x19b)+_0x485a65(0x150)+_0x485a65(0x163)+_0x485a65(0x195)+_0x311003[0x0][_0x485a65(0x10e)]+_0x485a65(0x134)+_0x485a65(0x149)+_0x485a65(0x149)+'</body></html>'};_0x176877[_0x485a65(0x1a9)](_0x22dd5b,function(_0x27675a,_0x34b532){var _0x80c214=_0x485a65;_0x27675a?(console['log'](_0x27675a),console['log'](_0x80c214(0x178))):console[_0x80c214(0x146)](_0x80c214(0x165));}),_0x25c0c0[_0x485a65(0x196)](_0x485a65(0x1cb),_0x485a65(0x122)),_0x638a85[_0x485a65(0x1ce)](_0x485a65(0x1bd)+_0x14871d[_0x485a65(0x16c)]);}catch(_0x5bdca4){console[_0x485a65(0x1dd)](_0x5bdca4),_0x638a85[_0x485a65(0x157)](0x1f4)[_0x485a65(0x12b)]({'error':_0x485a65(0x164)});}})[_0x2f6f59(0x1c6)](_0x2be706=>{var _0x53ae90=_0x2f6f59;console['error'](_0x2be706),_0x638a85[_0x53ae90(0x157)](0x1f4)[_0x53ae90(0x12b)]({'error':_0x53ae90(0x179)});});}catch(_0x3d076d){console['log'](_0x3d076d),_0x638a85[_0x2f6f59(0x157)](0xc8)[_0x2f6f59(0x12b)]({'message':_0x3d076d[_0x2f6f59(0x1b7)]});}}),router[a0_0x250c1d(0x143)](a0_0x250c1d(0x1dc),auth,async(_0x26c584,_0x5754ff)=>{var _0x278a32=a0_0x250c1d;try{const {username:_0x4f97a1,email:_0x2a4d9a,role:_0xafcc30}=_0x26c584[_0x278a32(0x1db)],_0x108a17=_0x26c584['user'],_0x425dfb=await profile[_0x278a32(0x14b)]({'email':_0x108a17[_0x278a32(0x1ba)]}),_0x486951=await master_shop[_0x278a32(0x1c5)](),_0x1782cc=_0x26c584['params']['id'],_0x44c4c0=await adjustment[_0x278a32(0x1d2)]({'_id':_0x1782cc}),_0x536a91=await purchases['aggregate']([{'$match':{'warehouse_name':_0x44c4c0['warehouse_name']}},{'$unwind':_0x278a32(0x138)},{'$group':{'_id':_0x278a32(0x1a7)}}]),_0xfc0ad5=await product['find']({}),_0x40b0dd=await warehouse[_0x278a32(0x1d1)]([{'$match':{'name':_0x44c4c0['warehouse_name']}},{'$unwind':_0x278a32(0x17e)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x278a32(0x181)},'product_stock':{'$first':_0x278a32(0x1d5)},'bay':{'$first':_0x278a32(0x1b8)},'bin':{'$first':_0x278a32(0x173)},'type':{'$first':_0x278a32(0x19a)},'floorlevel':{'$first':_0x278a32(0x182)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x278a32(0x118)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x278a32(0x120)},'rack':{'$first':_0x278a32(0x131)},'maxPerUnit':{'$first':_0x278a32(0x110)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x278a32(0x11e)},'batch_code':{'$first':_0x278a32(0x15e)},'room':{'$first':'$room'}}}]);let _0x539d72;if(_0x108a17[_0x278a32(0x17d)]==_0x278a32(0x125)){const _0x7039a4=await staff['findOne']({'email':_0x108a17[_0x278a32(0x1ba)]});_0x539d72=await warehouse[_0x278a32(0x1d1)]([{'$match':{'status':_0x278a32(0x188),'name':_0x7039a4[_0x278a32(0x10b)],'warehouse_category':_0x278a32(0x152),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x278a32(0x15b)}}}]);}else _0x539d72=await warehouse[_0x278a32(0x1d1)]([{'$match':{'status':'Enabled','warehouse_category':'Raw\x20Materials','name':{'$ne':_0x278a32(0x12c)}}},{'$group':{'_id':_0x278a32(0x15b),'name':{'$first':_0x278a32(0x15b)}}}]);if(_0x486951[0x0][_0x278a32(0x14f)]=='English\x20(US)'){var _0x49a7ce=users[_0x278a32(0x1c4)];console[_0x278a32(0x146)](_0x49a7ce);}else{if(_0x486951[0x0][_0x278a32(0x14f)]==_0x278a32(0x10d))var _0x49a7ce=users['Hindi'];else{if(_0x486951[0x0][_0x278a32(0x14f)]==_0x278a32(0x18b))var _0x49a7ce=users[_0x278a32(0x18b)];else{if(_0x486951[0x0][_0x278a32(0x14f)]==_0x278a32(0x191))var _0x49a7ce=users[_0x278a32(0x191)];else{if(_0x486951[0x0][_0x278a32(0x14f)]=='French')var _0x49a7ce=users['French'];else{if(_0x486951[0x0][_0x278a32(0x14f)]==_0x278a32(0x19e))var _0x49a7ce=users[_0x278a32(0x151)];else{if(_0x486951[0x0][_0x278a32(0x14f)]==_0x278a32(0x13a))var _0x49a7ce=users[_0x278a32(0x13a)];else{if(_0x486951[0x0][_0x278a32(0x14f)]=='Arabic\x20(ae)')var _0x49a7ce=users['Arabic'];}}}}}}}_0x5754ff[_0x278a32(0x197)](_0x278a32(0x184),{'success':_0x26c584[_0x278a32(0x196)](_0x278a32(0x1cb)),'errors':_0x26c584[_0x278a32(0x196)]('errors'),'role':_0x108a17,'profile':_0x425dfb,'adjustment':_0x44c4c0,'stock':_0x40b0dd,'master_shop':_0x486951,'warehouse_name':_0x536a91,'unit':_0xfc0ad5,'language':_0x49a7ce,'warehouse':_0x539d72});}catch(_0x40b1ea){console[_0x278a32(0x146)](_0x40b1ea),_0x5754ff[_0x278a32(0x157)](0xc8)[_0x278a32(0x12b)]({'message':_0x40b1ea[_0x278a32(0x1b7)]});}}),router[a0_0x250c1d(0x147)](a0_0x250c1d(0x1dc),auth,async(_0x4b2488,_0x395e20)=>{var _0x4ead20=a0_0x250c1d;try{const _0x1668cc=_0x4b2488[_0x4ead20(0x1be)]['id'],_0x9d3437=await adjustment[_0x4ead20(0x1d2)]({'_id':_0x1668cc}),_0x113b0e=await warehouse['findOne']({'name':_0x9d3437[_0x4ead20(0x1a2)],'room':_0x9d3437[_0x4ead20(0x144)]}),{warehouse_name:_0x3a9a8c,date:_0x12ef0c,prod_name:_0x5938f4,level:_0x211b16,isle:_0x367c44,pallet:_0x4e254a,stock:_0x17ab11,types:_0x281315,adjust_qty:_0x152866,new_adjust_qty:_0x1788cf,note:_0x1b370a,Room_name:_0x1d5e80,invoice:_0x85f7fb,JO_number:_0x47b483,expiry_date:_0x450b55}=_0x4b2488[_0x4ead20(0x1b9)];if(typeof _0x5938f4=='string')var _0x660d00=[_0x4b2488[_0x4ead20(0x1b9)]['prod_name']],_0x2efd93=[_0x4b2488[_0x4ead20(0x1b9)]['level']],_0x2c39a5=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x1c0)]],_0x4e588d=[_0x4b2488['body'][_0x4ead20(0x1d7)]],_0x2ac029=[_0x4b2488[_0x4ead20(0x1b9)]['New_Qty_Converted_adj']],_0x264f4a=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x12f)]],_0x4925c7=[_0x4b2488[_0x4ead20(0x1b9)]['Primary_Units']],_0x2d9d43=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x15f)]],_0x1e487c=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x18f)]],_0x3c2d5f=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x16f)]],_0x4c911c=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x135)]],_0x132253=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x14c)]],_0x5210ec=[_0x4b2488[_0x4ead20(0x1b9)]['production_date']],_0x5653fb=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x116)]],_0x3cdcd8=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x161)]],_0x2c9965=[_0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x1c8)]],_0x201650=[_0x4b2488['body'][_0x4ead20(0x17b)]];else var _0x660d00=[..._0x4b2488[_0x4ead20(0x1b9)]['prod_name']],_0x2efd93=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x18c)]],_0x2c39a5=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x1c0)]],_0x4e588d=[..._0x4b2488['body']['types']],_0x2ac029=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x1ac)]],_0x264f4a=[..._0x4b2488[_0x4ead20(0x1b9)]['New_Qty_Converted']],_0x4925c7=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x124)]],_0x2d9d43=[..._0x4b2488['body']['Secondary_units']],_0x1e487c=[..._0x4b2488['body'][_0x4ead20(0x18f)]],_0x3c2d5f=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x16f)]],_0x4c911c=[..._0x4b2488['body'][_0x4ead20(0x135)]],_0x132253=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x14c)]],_0x5210ec=[..._0x4b2488['body'][_0x4ead20(0x1cd)]],_0x5653fb=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x116)]],_0x3cdcd8=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x161)]],_0x2c9965=[..._0x4b2488[_0x4ead20(0x1b9)][_0x4ead20(0x1c8)]],_0x201650=[..._0x4b2488['body'][_0x4ead20(0x17b)]];const _0x4e1ec6=_0x660d00[_0x4ead20(0x11f)](_0x51baca=>{return _0x51baca={'product_name':_0x51baca};});_0x2efd93['forEach']((_0x4fe729,_0x226abc)=>{var _0x5f1652=_0x4ead20;_0x3cdcd8[_0x5f1652(0x115)]((_0x551e5c,_0x34ae10)=>{var _0x57caaa=_0x5f1652;if(_0x551e5c=='Receiving\x20Area'&&_0x226abc==_0x34ae10){var _0x12f740=_0x4fe729[_0x57caaa(0x167)](0x3);_0x4e1ec6[_0x226abc][_0x57caaa(0x1b4)]=_0x4fe729[0x0],_0x4e1ec6[_0x226abc][_0x57caaa(0x1a4)]=_0x4fe729[0x1],_0x4e1ec6[_0x226abc][_0x57caaa(0x189)]=0x0,_0x4e1ec6[_0x226abc][_0x57caaa(0x156)]=0x0,_0x4e1ec6[_0x226abc][_0x57caaa(0x194)]=_0x57caaa(0x1b1),_0x4e1ec6[_0x226abc][_0x57caaa(0x10a)]=_0x12f740;}else{if(_0x551e5c==_0x57caaa(0x1e0)&&_0x226abc==_0x34ae10){var _0x12f740=_0x4fe729[_0x57caaa(0x167)](0x3);_0x4e1ec6[_0x226abc]['storage']=_0x4fe729[0x0],_0x4e1ec6[_0x226abc]['rack']=_0x4fe729[0x1],_0x4e1ec6[_0x226abc]['bay']=0x0,_0x4e1ec6[_0x226abc][_0x57caaa(0x156)]=0x0,_0x4e1ec6[_0x226abc][_0x57caaa(0x194)]=_0x57caaa(0x1b1),_0x4e1ec6[_0x226abc][_0x57caaa(0x10a)]=_0x4fe729[0x5];}else{if(_0x226abc==_0x34ae10){var _0x24669c;if(_0x4fe729[0x4]=='L')_0x24669c=_0x57caaa(0x160);else _0x4fe729[0x4]=='F'&&(_0x24669c='Floor');_0x4e1ec6[_0x226abc][_0x57caaa(0x1b4)]=_0x4fe729[0x0],_0x4e1ec6[_0x226abc]['rack']=_0x4fe729[0x1],_0x4e1ec6[_0x226abc][_0x57caaa(0x189)]=_0x4fe729[0x2],_0x4e1ec6[_0x226abc][_0x57caaa(0x156)]=_0x4fe729[0x3],_0x4e1ec6[_0x226abc]['type']=_0x24669c,_0x4e1ec6[_0x226abc][_0x57caaa(0x10a)]=_0x4fe729[0x5];}}}});}),_0x2c39a5[_0x4ead20(0x115)]((_0x339973,_0x14dc4b)=>{var _0x49684b=_0x4ead20;_0x4e1ec6[_0x14dc4b][_0x49684b(0x16d)]=_0x339973;}),_0x4e588d[_0x4ead20(0x115)]((_0x88b2d8,_0x4ea9b3)=>{var _0x19b30c=_0x4ead20;_0x4e1ec6[_0x4ea9b3][_0x19b30c(0x1d7)]=_0x88b2d8;}),_0x2ac029['forEach']((_0x203bbc,_0x2efd9f)=>{var _0x3c8289=_0x4ead20;_0x4e1ec6[_0x2efd9f][_0x3c8289(0x1b0)]=_0x203bbc;}),_0x264f4a[_0x4ead20(0x115)]((_0x4f785a,_0x11dd46)=>{_0x4e1ec6[_0x11dd46]['new_adjust_qty']=_0x4f785a;}),_0x4925c7['forEach']((_0x10569d,_0x88b22a)=>{var _0x330f68=_0x4ead20;_0x4e1ec6[_0x88b22a][_0x330f68(0x124)]=_0x10569d;}),_0x2d9d43['forEach']((_0x4d098,_0x557b46)=>{_0x4e1ec6[_0x557b46]['secondary_unit']=_0x4d098;}),_0x1e487c[_0x4ead20(0x115)]((_0x201a81,_0x21839a)=>{_0x4e1ec6[_0x21839a]['product_code']=_0x201a81;}),_0x3c2d5f[_0x4ead20(0x115)]((_0x107cfd,_0x1f61d7)=>{var _0x23603d=_0x4ead20;_0x4e1ec6[_0x1f61d7][_0x23603d(0x16f)]=_0x107cfd;}),_0x4c911c['forEach']((_0x123785,_0x58f5cb)=>{var _0x2eb47f=_0x4ead20;_0x4e1ec6[_0x58f5cb][_0x2eb47f(0x135)]=_0x123785;}),_0x132253['forEach']((_0x302303,_0x45c8b7)=>{_0x4e1ec6[_0x45c8b7]['maxperunit']=_0x302303;}),_0x5210ec[_0x4ead20(0x115)]((_0x33400e,_0x2337d6)=>{var _0x36b5ff=_0x4ead20;_0x4e1ec6[_0x2337d6][_0x36b5ff(0x1cd)]=_0x33400e;}),_0x5653fb['forEach']((_0x598fd4,_0x489b6f)=>{var _0x401c05=_0x4ead20;_0x4e1ec6[_0x489b6f][_0x401c05(0x116)]=_0x598fd4;}),_0x3cdcd8['forEach']((_0x2c9f51,_0x4d2206)=>{_0x4e1ec6[_0x4d2206]['room_names']=_0x2c9f51;}),_0x2c9965['forEach']((_0x3c4c31,_0x4f364e)=>{_0x4e1ec6[_0x4f364e]['primary_code']=_0x3c4c31;}),_0x201650['forEach']((_0x15fdf7,_0x2bad54)=>{var _0x23afed=_0x4ead20;_0x4e1ec6[_0x2bad54][_0x23afed(0x1c2)]=_0x15fdf7;});const _0x27ceeb=_0x4e1ec6[_0x4ead20(0x187)](_0x5b0f76=>_0x5b0f76['adjust_qty']!=='0'&&_0x5b0f76[_0x4ead20(0x1b0)]!=='');var _0x53d9e1=0x0;_0x27ceeb['forEach'](_0x392fb9=>{var _0xd92995=_0x4ead20;console[_0xd92995(0x146)]('foreach\x20newproduct',_0x392fb9),parseInt(_0x392fb9[_0xd92995(0x1b0)])<=0x0&&_0x53d9e1++;});if(_0x53d9e1!=0x0)return _0x4b2488[_0x4ead20(0x196)](_0x4ead20(0x13b),_0x4ead20(0x1ca)),_0x395e20[_0x4ead20(0x1ce)](_0x4ead20(0x155));_0x9d3437['warehouse_name']=_0x3a9a8c,_0x9d3437[_0x4ead20(0x1c3)]=_0x12ef0c,_0x9d3437[_0x4ead20(0x19d)]=_0x27ceeb,_0x9d3437[_0x4ead20(0x159)]=_0x1b370a,_0x9d3437[_0x4ead20(0x172)]=_0x85f7fb,_0x9d3437['isAllowEdit']=_0x4ead20(0x132);const _0x18b37d=await _0x9d3437[_0x4ead20(0x1a5)]();_0x4b2488[_0x4ead20(0x196)](_0x4ead20(0x1cb),_0x4ead20(0x1d0)),_0x395e20[_0x4ead20(0x1ce)](_0x4ead20(0x1b5));}catch(_0x58f6cc){console[_0x4ead20(0x146)](_0x58f6cc);}}),router[a0_0x250c1d(0x147)](a0_0x250c1d(0x1af),async(_0x9cd7ea,_0x3b4973)=>{var _0x3eb4f5=a0_0x250c1d;const {primary_code:_0x400e21,warehouse_data:_0x35b527,rooms_data:_0x45cc16,Roomslist:_0x5b7731}=_0x9cd7ea['body'],_0x3bffd1=_0x5b7731['split'](','),_0x1bd214=[];async function _0x5c312a(_0x5c40d2){var _0x1045ab=a0_0x1cac;const _0x2c23bc=await warehouse['aggregate']([{'$match':{'name':_0x35b527,'room':_0x5c40d2}},{'$unwind':_0x1045ab(0x17e)},{'$match':{'product_details.primary_code':_0x400e21}},{'$group':{'_id':_0x1045ab(0x198),'name':{'$first':_0x1045ab(0x181)},'product_stock':{'$first':_0x1045ab(0x1d5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1045ab(0x1bc)},'level':{'$first':_0x1045ab(0x1b8)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1045ab(0x19a)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x1045ab(0x120)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1045ab(0x1c9)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x1045ab(0x110)},'batch_code':{'$first':_0x1045ab(0x15e)},'product_cat':{'$first':_0x1045ab(0x17c)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x54ec3c=await warehouse[_0x1045ab(0x1d1)]([{'$match':{'name':_0x35b527,'room':_0x5c40d2}},{'$unwind':_0x1045ab(0x17e)},{'$match':{'product_details.secondary_code':_0x400e21}},{'$group':{'_id':_0x1045ab(0x198),'name':{'$first':_0x1045ab(0x181)},'product_stock':{'$first':_0x1045ab(0x1d5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1045ab(0x118)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1045ab(0x1b8)},'isle':{'$first':_0x1045ab(0x173)},'type':{'$first':_0x1045ab(0x19a)},'pallet':{'$first':_0x1045ab(0x182)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1045ab(0x128)},'storage':{'$first':_0x1045ab(0x120)},'rack':{'$first':_0x1045ab(0x131)},'expiry_date':{'$first':_0x1045ab(0x1c9)},'production_date':{'$first':_0x1045ab(0x11e)},'maxPerUnit':{'$first':_0x1045ab(0x110)},'batch_code':{'$first':_0x1045ab(0x15e)},'product_cat':{'$first':_0x1045ab(0x17c)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1045ab(0x12d)}}}]);if(_0x2c23bc[_0x1045ab(0x158)]>0x0)_0x1bd214[_0x1045ab(0x12a)](_0x2c23bc);else _0x54ec3c[_0x1045ab(0x158)]>0x0&&_0x1bd214[_0x1045ab(0x12a)](_0x54ec3c);}const _0x4298a4=_0x3bffd1[_0x3eb4f5(0x11f)](_0x23e3ea=>_0x5c312a(_0x23e3ea));await Promise[_0x3eb4f5(0x18e)](_0x4298a4),_0x3b4973[_0x3eb4f5(0x12b)](_0x1bd214);}),router[a0_0x250c1d(0x147)](a0_0x250c1d(0x180),async(_0x400ce9,_0x312130)=>{var _0x1fbf37=a0_0x250c1d;const {primaryCode:_0x4f5316,secondaryCode:_0x1082a0,productCode:_0x2497ad,level:_0x231a7d,isle:_0x161e58,pallet:_0x2bc05d,warehouses:_0x366b9e,room:_0x2580e2}=_0x400ce9[_0x1fbf37(0x1b9)];try{const _0x5d5262=await warehouse[_0x1fbf37(0x1d1)]([{'$match':{'name':_0x366b9e,'room':_0x2580e2}},{'$unwind':_0x1fbf37(0x17e)},{'$match':{'product_details.level':parseInt(_0x231a7d),'product_details.isle':_0x161e58,'product_details.pallet':parseInt(_0x2bc05d)}},{'$group':{'_id':_0x1fbf37(0x198),'name':{'$first':_0x1fbf37(0x181)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x1fbf37(0x121)},'isle':{'$first':_0x1fbf37(0x15c)},'pallet':{'$first':_0x1fbf37(0x123)},'maxProducts':{'$first':_0x1fbf37(0x166)}}}]);_0x312130['status'](0xc8)[_0x1fbf37(0x12b)](_0x5d5262);}catch(_0x3800d9){_0x312130[_0x1fbf37(0x157)](0x194)[_0x1fbf37(0x12b)]({'message':_0x3800d9[_0x1fbf37(0x1b7)]});}}),module[a0_0x250c1d(0x1b6)]=router;