function a0_0xb99a(){var _0x2024bf=['room','slice','post','host','Return\x20Rooms','second1','$name','edit_adjustment_view','$product_details.primary_code','password','success','invoice','</h5>','primary_code','floorlevel','</body></html>','exports','\x20<>\x20','$product','adjustment\x20Finalized\x20successfully','556cjexCS','Ambient','$product_details.floorlevel','message','get','foreach\x20newproduct','/view','prod_invoice','max_per_unit','edit_adjustment','findOne','Enabled','site_title','$product_details.storage','storage','502950aPGILp','production_date','stockBefore','$product_details.product_code','user','</span>','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Floor','prod_name','then','render','$product_details.product_cat','finalize','logo','$product_details.bin','$product_details.expiry_date','$product_details.secondary_code','aggregate','$product_details.unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/adjustment/view','<!DOCTYPE\x20html>','filter','$product_details','/../public','back','An\x20error\x20occurred\x20while\x20saving\x20data.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','types','An\x20error\x20occurred.','adjustment\x20data\x20update\x20successfully','forEach','</table>','save','nodemailer','30708PPzXTo','adjust_qty','New_Qty_Converted_adj','createTransport','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<span\x20style=\x22float:\x20right;\x22>','Spanish','/view/add_adjustment','isAllowEdit','adjustment\x20add\x20successfull','product','sendMail','$product_details.product_stock','There\x27s\x20a\x20error\x20in\x20this\x20transaction','room_names','product_code','/adjustment/preview/','New_Qty_Converted','$warehouse_name','$product_details.product_name','date','prod_cat','string','$product_details.production_date','Email\x20sent\x20successfully','expiry_date','language','product_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','length','secondary_code','warehouse','</tr>','$product_details.type','rack','</td>','../middleware/auth','Arabic','/preview/:id','catch','30UCqBnG','\x20Order\x20Number\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</thead>','Portuguese','English\x20(US)','status','$product_details.maxPerUnit','push','<tr>','<h5>','../models/all_models','$product_details.isle','$product_details.rack','Hindi','find','role','$date','unit','<h2>\x20','redirect','$isAllowEdit','<html><head><title></title>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/CheckingWarehouse','Chinese','\x20</h2>','prime1','$product_details.batch_code','random','$product.room_names','bin','Router','28304xHNqQF','$room','id_transaction','Return\x20Goods','level','params','log','\x20Order\x20Date\x20:\x20','findById','$product_details.bay','map','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Portuguese\x20(BR)','minus','note','Arabic\x20(ae)','id_transaction_from','/upload/','Rooms','French','bay','$product_details.secondary_unit','40cLzbIF','$_id','warehouse_name','errors','_id','/view/:id','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<div>','staff','flash','$invoice','Error\x20Occurs','2695nVkxba','express','batch_code','type','ADJ-','all','$product_details._id','509481gKtrHg','Shelves','</tbody>','65MqiLSM','prod_code','Secondary_units','1047120yHSHHY','Primary_Units','../public/language/languages.json','product_stock','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','511857NNPfju','Raw\x20Materials','24ydVSAM','</div>','new_adjust_qty','maxperunit','True','Receiving\x20Area','stock','/barcode_scanner','error','json','German','body','master'];a0_0xb99a=function(){return _0x2024bf;};return a0_0xb99a();}var a0_0x24d463=a0_0x3188;(function(_0x4d53b1,_0x288ed4){var _0x2782d1=a0_0x3188,_0x240f78=_0x4d53b1();while(!![]){try{var _0x5ea747=-parseInt(_0x2782d1(0x102))/0x1*(-parseInt(_0x2782d1(0x195))/0x2)+-parseInt(_0x2782d1(0xd9))/0x3+-parseInt(_0x2782d1(0x17e))/0x4*(-parseInt(_0x2782d1(0xd6))/0x5)+-parseInt(_0x2782d1(0x15d))/0x6*(parseInt(_0x2782d1(0xd3))/0x7)+parseInt(_0x2782d1(0xe1))/0x8*(parseInt(_0x2782d1(0xdf))/0x9)+parseInt(_0x2782d1(0x111))/0xa+parseInt(_0x2782d1(0x1a1))/0xb*(parseInt(_0x2782d1(0x135))/0xc);if(_0x5ea747===_0x288ed4)break;else _0x240f78['push'](_0x240f78['shift']());}catch(_0x20388c){_0x240f78['push'](_0x240f78['shift']());}}}(a0_0xb99a,0x3a1c6));const express=require(a0_0x24d463(0x1a2)),app=express(),router=express[a0_0x24d463(0x17d)](),auth=require(a0_0x24d463(0x159)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x24d463(0x168)),users=require(a0_0x24d463(0xdb)),nodemailer=require(a0_0x24d463(0x134));function a0_0x3188(_0x40ecd8,_0x3ac652){var _0xb99a9f=a0_0xb99a();return a0_0x3188=function(_0x318854,_0x630b6b){_0x318854=_0x318854-0xce;var _0x579d0e=_0xb99a9f[_0x318854];return _0x579d0e;},a0_0x3188(_0x40ecd8,_0x3ac652);}router[a0_0x24d463(0x106)](a0_0x24d463(0x108),auth,async(_0x440437,_0x377e20)=>{var _0x48e02f=a0_0x24d463;try{const {username:_0x3c3c54,email:_0x25dc5e,role:_0x4ff6a8}=_0x440437[_0x48e02f(0x115)],_0x7fd5f7=_0x440437['user'],_0x127f8e=await profile[_0x48e02f(0x10c)]({'email':_0x7fd5f7[_0x48e02f(0xdd)]}),_0x515fc7=await master_shop[_0x48e02f(0x16c)]();console[_0x48e02f(0x184)](_0x48e02f(0xed),_0x515fc7);let _0x26c088;if(_0x7fd5f7[_0x48e02f(0x16d)]==_0x48e02f(0x19d)){const _0x49a41f=await staff[_0x48e02f(0x10c)]({'email':_0x7fd5f7['email']});_0x26c088=await warehouse['find']({'status':_0x48e02f(0x10d),'name':_0x49a41f[_0x48e02f(0x154)]});}else _0x26c088=await warehouse[_0x48e02f(0x16c)]({'status':_0x48e02f(0x10d)});const _0x1e780f=await product[_0x48e02f(0x16c)]();let _0x38c420;if(_0x7fd5f7[_0x48e02f(0x16d)]=='staff'){const _0x7550d3=await staff[_0x48e02f(0x10c)]({'email':_0x7fd5f7[_0x48e02f(0xdd)]});_0x38c420=await adjustment['find']({'warehouse_name':_0x7550d3[_0x48e02f(0x154)]});}else _0x38c420=await adjustment[_0x48e02f(0x123)]([{'$unwind':_0x48e02f(0x100)},{'$group':{'_id':_0x48e02f(0x196),'invoice':{'$first':_0x48e02f(0x19f)},'date':{'$first':_0x48e02f(0x16e)},'warehouse_name':{'$first':_0x48e02f(0x147)},'room':{'$addToSet':_0x48e02f(0x17b)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x48e02f(0x172)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x515fc7[0x0][_0x48e02f(0x14f)]==_0x48e02f(0x162)){var _0x5c4c8c=users[_0x48e02f(0x189)];console[_0x48e02f(0x184)](_0x5c4c8c);}else{if(_0x515fc7[0x0][_0x48e02f(0x14f)]==_0x48e02f(0x16b))var _0x5c4c8c=users[_0x48e02f(0x16b)];else{if(_0x515fc7[0x0][_0x48e02f(0x14f)]==_0x48e02f(0xeb))var _0x5c4c8c=users['German'];else{if(_0x515fc7[0x0][_0x48e02f(0x14f)]==_0x48e02f(0x13b))var _0x5c4c8c=users['Spanish'];else{if(_0x515fc7[0x0]['language']=='French')var _0x5c4c8c=users[_0x48e02f(0x192)];else{if(_0x515fc7[0x0]['language']==_0x48e02f(0x18b))var _0x5c4c8c=users[_0x48e02f(0x161)];else{if(_0x515fc7[0x0][_0x48e02f(0x14f)]==_0x48e02f(0x176))var _0x5c4c8c=users[_0x48e02f(0x176)];else{if(_0x515fc7[0x0][_0x48e02f(0x14f)]==_0x48e02f(0x18e))var _0x5c4c8c=users['Arabic'];}}}}}}}_0x377e20[_0x48e02f(0x11c)]('adjustment',{'success':_0x440437[_0x48e02f(0x19e)]('success'),'errors':_0x440437[_0x48e02f(0x19e)]('errors'),'role':_0x7fd5f7,'profile':_0x127f8e,'warehouse':_0x26c088,'product':_0x1e780f,'adjustment':_0x38c420,'master_shop':_0x515fc7,'language':_0x5c4c8c});}catch(_0x76cb2c){console[_0x48e02f(0x184)](_0x76cb2c);}});async function getRandom8DigitNumber(){var _0x114ddf=a0_0x24d463;const _0x198a93=0x989680,_0x45eab9=0x5f5e0ff,_0x5ee2b5=Math['floor'](Math[_0x114ddf(0x17a)]()*(_0x45eab9-_0x198a93+0x1))+_0x198a93;var _0x5c31a5;const _0x46adfd=await adjustment[_0x114ddf(0x10c)]({'invoice':'ADJ-'+_0x5ee2b5});return _0x46adfd&&_0x46adfd['length']>0x0?_0x5c31a5=_0x114ddf(0xd0)+_0x5ee2b5:_0x5c31a5=_0x114ddf(0xd0)+_0x5ee2b5,_0x5c31a5;}router[a0_0x24d463(0x106)]('/view/add_adjustment',auth,async(_0x510964,_0x30cfc4)=>{var _0x5ee124=a0_0x24d463;try{const {username:_0x165138,email:_0x7c775e,role:_0x2d5ef6}=_0x510964[_0x5ee124(0x115)],_0x230e72=_0x510964[_0x5ee124(0x115)],_0x5b7d30=await profile['findOne']({'email':_0x230e72[_0x5ee124(0xdd)]}),_0x588f78=await master_shop[_0x5ee124(0x16c)]();let _0x231c39;if(_0x230e72[_0x5ee124(0x16d)]=='staff'){const _0x40703b=await staff[_0x5ee124(0x10c)]({'email':_0x230e72[_0x5ee124(0xdd)]});_0x231c39=await warehouse['aggregate']([{'$match':{'status':_0x5ee124(0x10d),'name':_0x40703b[_0x5ee124(0x154)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5ee124(0x181)}}},{'$group':{'_id':_0x5ee124(0xf4),'name':{'$first':_0x5ee124(0xf4)}}}]);}else _0x231c39=await warehouse['aggregate']([{'$match':{'status':_0x5ee124(0x10d),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5ee124(0x181)}}},{'$group':{'_id':_0x5ee124(0xf4),'name':{'$first':'$name'}}}]);const _0x4ec193=await product[_0x5ee124(0x16c)]({}),_0x39d854=await adjustment[_0x5ee124(0x16c)]({}),_0x3a5151=_0x39d854[_0x5ee124(0x152)]+0x1,_0x43aadb='ADJ-'+_0x3a5151['toString']()['padStart'](0x5,'0');var _0x12dd53=[_0x5ee124(0x103),'Enclosed',_0x5ee124(0xf2)];if(_0x588f78[0x0][_0x5ee124(0x14f)]=='English\x20(US)')var _0xdb6123=users[_0x5ee124(0x189)];else{if(_0x588f78[0x0][_0x5ee124(0x14f)]==_0x5ee124(0x16b))var _0xdb6123=users[_0x5ee124(0x16b)];else{if(_0x588f78[0x0][_0x5ee124(0x14f)]==_0x5ee124(0xeb))var _0xdb6123=users[_0x5ee124(0xeb)];else{if(_0x588f78[0x0][_0x5ee124(0x14f)]=='Spanish')var _0xdb6123=users['Spanish'];else{if(_0x588f78[0x0][_0x5ee124(0x14f)]=='French')var _0xdb6123=users[_0x5ee124(0x192)];else{if(_0x588f78[0x0][_0x5ee124(0x14f)]=='Portuguese\x20(BR)')var _0xdb6123=users[_0x5ee124(0x161)];else{if(_0x588f78[0x0][_0x5ee124(0x14f)]=='Chinese')var _0xdb6123=users[_0x5ee124(0x176)];else{if(_0x588f78[0x0][_0x5ee124(0x14f)]=='Arabic\x20(ae)')var _0xdb6123=users[_0x5ee124(0x15a)];}}}}}}}const _0x46a5ae=getRandom8DigitNumber();_0x46a5ae[_0x5ee124(0x11b)](_0x185453=>{var _0x3858b4=_0x5ee124;_0x30cfc4[_0x3858b4(0x11c)]('add_adjustment',{'success':_0x510964[_0x3858b4(0x19e)](_0x3858b4(0xf8)),'errors':_0x510964[_0x3858b4(0x19e)](_0x3858b4(0x198)),'role':_0x230e72,'profile':_0x5b7d30,'warehouse':_0x231c39,'product':_0x4ec193,'master_shop':_0x588f78,'language':_0xdb6123,'rooms_data':_0x12dd53,'invoice_no':_0x185453});})[_0x5ee124(0x15c)](_0x38048f=>{var _0x1b3c6d=_0x5ee124;_0x510964['flash']('errors',_0x1b3c6d(0x142)),_0x30cfc4[_0x1b3c6d(0x171)](_0x1b3c6d(0x126));});}catch(_0x240e52){console[_0x5ee124(0x184)](_0x240e52);}}),router['post'](a0_0x24d463(0x13c),auth,async(_0xa2fe7d,_0x81bfc0)=>{var _0x5d9716=a0_0x24d463;try{const {warehouse_name:_0x294efe,date:_0x56b5e2,prod_name:_0x323320,level:_0x1bc8b3,isle:_0x1c251e,pallet:_0x3fcc27,stock:_0x3db2f3,types:_0x222ae5,adjust_qty:_0x2602d3,new_adjust_qty:_0x3ad954,note:_0x4d7781,Room_name:_0x26bcc2,invoice:_0x580e14,JO_number:_0x314999,expiry_date:_0x1ed412}=_0xa2fe7d['body'];if(typeof _0x323320==_0x5d9716(0x14b))var _0x314d8a=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x11a)]],_0x38f225=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x182)]],_0x4f946e=[_0xa2fe7d[_0x5d9716(0xec)]['stock']],_0x97a312=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x12e)]],_0x566449=[_0xa2fe7d['body'][_0x5d9716(0x137)]],_0x31257a=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x146)]],_0x182a5c=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0xda)]],_0x36030f=[_0xa2fe7d[_0x5d9716(0xec)]['Secondary_units']],_0x51b4c0=[_0xa2fe7d['body'][_0x5d9716(0xd7)]],_0x208dea=[_0xa2fe7d['body'][_0x5d9716(0xce)]],_0x2d8421=[_0xa2fe7d[_0x5d9716(0xec)]['expiry_date']],_0x471779=[_0xa2fe7d['body']['max_per_unit']],_0x54082d=[_0xa2fe7d[_0x5d9716(0xec)]['production_date']],_0x5cfb33=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x14a)]],_0x3df360=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x191)]],_0x543146=[_0xa2fe7d['body'][_0x5d9716(0x178)]],_0x41361c=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0xf3)]],_0x294a76=[_0xa2fe7d[_0x5d9716(0xec)]['prod_invoice']],_0x6f63e=[_0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x180)]];else var _0x314d8a=[..._0xa2fe7d['body'][_0x5d9716(0x11a)]],_0x38f225=[..._0xa2fe7d['body'][_0x5d9716(0x182)]],_0x4f946e=[..._0xa2fe7d['body'][_0x5d9716(0xe7)]],_0x97a312=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x12e)]],_0x566449=[..._0xa2fe7d[_0x5d9716(0xec)]['New_Qty_Converted_adj']],_0x31257a=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x146)]],_0x182a5c=[..._0xa2fe7d[_0x5d9716(0xec)]['unit']],_0x36030f=[..._0xa2fe7d['body'][_0x5d9716(0xd8)]],_0x51b4c0=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0xd7)]],_0x208dea=[..._0xa2fe7d['body'][_0x5d9716(0xce)]],_0x2d8421=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x14e)]],_0x471779=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x10a)]],_0x54082d=[..._0xa2fe7d[_0x5d9716(0xec)]['production_date']],_0x5cfb33=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x14a)]],_0x3df360=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x191)]],_0x543146=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x178)]],_0x41361c=[..._0xa2fe7d['body'][_0x5d9716(0xf3)]],_0x294a76=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x109)]],_0x6f63e=[..._0xa2fe7d[_0x5d9716(0xec)][_0x5d9716(0x180)]];const _0x7c5b48=_0x314d8a[_0x5d9716(0x188)](_0x22871f=>{return _0x22871f={'product_name':_0x22871f};});_0x38f225[_0x5d9716(0x131)]((_0x3e694a,_0x391d49)=>{var _0x4ada05=_0x5d9716;_0x3df360[_0x4ada05(0x131)]((_0x3f4df7,_0x52c55a)=>{var _0x24de02=_0x4ada05;if(_0x3f4df7=='Receiving\x20Area'&&_0x391d49==_0x52c55a){var _0x1fa55a=_0x3e694a[_0x24de02(0xef)](0x3);_0x7c5b48[_0x391d49]['storage']=_0x3e694a[0x0],_0x7c5b48[_0x391d49][_0x24de02(0x157)]=_0x3e694a[0x1],_0x7c5b48[_0x391d49]['bay']=0x0,_0x7c5b48[_0x391d49]['bin']=0x0,_0x7c5b48[_0x391d49][_0x24de02(0xcf)]=_0x24de02(0x119),_0x7c5b48[_0x391d49][_0x24de02(0xfc)]=_0x1fa55a;}else{if(_0x3f4df7==_0x24de02(0xd4)&&_0x391d49==_0x52c55a){var _0x1fa55a=_0x3e694a[_0x24de02(0xef)](0x3);_0x7c5b48[_0x391d49][_0x24de02(0x110)]=_0x3e694a[0x0],_0x7c5b48[_0x391d49][_0x24de02(0x157)]=_0x3e694a[0x1],_0x7c5b48[_0x391d49][_0x24de02(0x193)]=0x0,_0x7c5b48[_0x391d49][_0x24de02(0x17c)]=0x0,_0x7c5b48[_0x391d49][_0x24de02(0xcf)]='Floor',_0x7c5b48[_0x391d49][_0x24de02(0xfc)]=_0x3e694a[0x5];}else{if(_0x391d49==_0x52c55a){var _0x5ee633;if(_0x3e694a[0x4]=='L')_0x5ee633='Level';else _0x3e694a[0x4]=='F'&&(_0x5ee633='Floor');_0x7c5b48[_0x391d49][_0x24de02(0x110)]=_0x3e694a[0x0],_0x7c5b48[_0x391d49]['rack']=_0x3e694a[0x1],_0x7c5b48[_0x391d49][_0x24de02(0x193)]=_0x3e694a[0x2],_0x7c5b48[_0x391d49][_0x24de02(0x17c)]=_0x3e694a[0x3],_0x7c5b48[_0x391d49]['type']=_0x5ee633,_0x7c5b48[_0x391d49][_0x24de02(0xfc)]=_0x3e694a[0x5];}}}});}),_0x4f946e[_0x5d9716(0x131)]((_0x3e6db3,_0xdaaa06)=>{var _0x20f7fd=_0x5d9716;_0x7c5b48[_0xdaaa06][_0x20f7fd(0x113)]=_0x3e6db3;}),_0x6f63e['forEach']((_0x16f13e,_0x2f15b5)=>{var _0x23dca0=_0x5d9716;_0x7c5b48[_0x2f15b5][_0x23dca0(0x18f)]=_0x16f13e;}),_0x97a312[_0x5d9716(0x131)]((_0x385d9d,_0x3eef44)=>{var _0x4d862a=_0x5d9716;_0x7c5b48[_0x3eef44][_0x4d862a(0x12e)]=_0x385d9d;}),_0x566449['forEach']((_0x48612b,_0x561a15)=>{var _0x28823e=_0x5d9716;_0x7c5b48[_0x561a15][_0x28823e(0x136)]=_0x48612b;}),_0x31257a[_0x5d9716(0x131)]((_0x2bba95,_0x2dd308)=>{var _0x5d6e7a=_0x5d9716;_0x7c5b48[_0x2dd308][_0x5d6e7a(0xe3)]=_0x2bba95;}),_0x182a5c['forEach']((_0x1e265a,_0x4a1c66)=>{var _0x5caf7b=_0x5d9716;_0x7c5b48[_0x4a1c66][_0x5caf7b(0x16f)]=_0x1e265a;}),_0x36030f['forEach']((_0x216ad7,_0xec1a51)=>{var _0x55b9f8=_0x5d9716;_0x7c5b48[_0xec1a51][_0x55b9f8(0x117)]=_0x216ad7;}),_0x51b4c0['forEach']((_0xf6a22b,_0xac37b)=>{var _0x2c60b5=_0x5d9716;_0x7c5b48[_0xac37b][_0x2c60b5(0x144)]=_0xf6a22b;}),_0x208dea['forEach']((_0xe21ee0,_0x5c7aab)=>{_0x7c5b48[_0x5c7aab]['batch_code']=_0xe21ee0;}),_0x2d8421['forEach']((_0x39aa70,_0x2a2546)=>{_0x7c5b48[_0x2a2546]['expiry_date']=_0x39aa70;}),_0x471779['forEach']((_0x1244f8,_0x6ed7a9)=>{_0x7c5b48[_0x6ed7a9]['maxperunit']=_0x1244f8;}),_0x54082d['forEach']((_0x4fde09,_0x2678db)=>{var _0x3d1a79=_0x5d9716;_0x7c5b48[_0x2678db][_0x3d1a79(0x112)]=_0x4fde09;}),_0x5cfb33[_0x5d9716(0x131)]((_0x230f64,_0x466e3a)=>{var _0x3eba41=_0x5d9716;_0x7c5b48[_0x466e3a][_0x3eba41(0x14a)]=_0x230f64;}),_0x3df360[_0x5d9716(0x131)]((_0x2ab381,_0x5d6633)=>{var _0x4c68f6=_0x5d9716;_0x7c5b48[_0x5d6633][_0x4c68f6(0x143)]=_0x2ab381;}),_0x543146[_0x5d9716(0x131)]((_0xf3348a,_0x442319)=>{var _0x4fb448=_0x5d9716;_0x7c5b48[_0x442319][_0x4fb448(0xfb)]=_0xf3348a;}),_0x41361c['forEach']((_0x5205d1,_0x34b00b)=>{var _0xd93dc6=_0x5d9716;_0x7c5b48[_0x34b00b][_0xd93dc6(0x153)]=_0x5205d1;}),_0x294a76[_0x5d9716(0x131)]((_0xef4f2b,_0x12c534)=>{var _0xa8545e=_0x5d9716;_0x7c5b48[_0x12c534][_0xa8545e(0xf9)]=_0xef4f2b;});const _0x28119d=_0x7c5b48[_0x5d9716(0x128)](_0x1aa0b3=>_0x1aa0b3[_0x5d9716(0x136)]!=='0'&&_0x1aa0b3[_0x5d9716(0x136)]!=='');var _0x24fa9f=0x0;_0x28119d[_0x5d9716(0x131)](_0x3e4c97=>{var _0x15cde7=_0x5d9716;console[_0x15cde7(0x184)](_0x15cde7(0x107),_0x3e4c97),parseInt(_0x3e4c97['adjust_qty'])<=0x0&&_0x24fa9f++;});if(_0x24fa9f!=0x0)return _0xa2fe7d[_0x5d9716(0x19e)](_0x5d9716(0x198),_0x5d9716(0x19b)),_0x81bfc0['redirect'](_0x5d9716(0x12b));const _0x1e66fd=new adjustment({'warehouse_name':_0x294efe,'date':_0x56b5e2,'product':_0x28119d,'note':_0x4d7781,'room':_0x26bcc2,'invoice':_0x580e14,'JO_number':_0x314999,'expiry_date':_0x1ed412}),_0x11c6ba=await _0x1e66fd[_0x5d9716(0x133)]();_0xa2fe7d[_0x5d9716(0x19e)](_0x5d9716(0xf8),_0x5d9716(0x13e)),_0x81bfc0[_0x5d9716(0x171)](_0x5d9716(0x145)+_0x11c6ba['_id']);}catch(_0x11681d){console['log'](_0x11681d),_0x81bfc0['status'](0xc8)[_0x5d9716(0xea)]({'message':_0x11681d[_0x5d9716(0x105)]});}}),router['get'](a0_0x24d463(0x15b),auth,async(_0x2632fc,_0x4fe7f4)=>{var _0x3b0712=a0_0x24d463;try{const {username:_0x525423,email:_0x378533,role:_0x5ea5dc}=_0x2632fc['user'],_0x38033b=_0x2632fc[_0x3b0712(0x115)],_0x522c5d=await profile[_0x3b0712(0x10c)]({'email':_0x38033b['email']}),_0x389bbc=await master_shop[_0x3b0712(0x16c)](),_0x1dfad6=_0x2632fc['params']['id'],_0x4b6d2f=await adjustment[_0x3b0712(0x186)]({'_id':_0x1dfad6}),_0x36b030=await purchases['aggregate']([{'$match':{'warehouse_name':_0x4b6d2f['warehouse_name']}},{'$unwind':_0x3b0712(0x100)},{'$group':{'_id':'$product.product_name'}}]),_0x4b29ff=await product[_0x3b0712(0x16c)]({}),_0x4e93a0=await warehouse[_0x3b0712(0x123)]([{'$match':{'name':_0x4b6d2f[_0x3b0712(0x197)]}},{'$unwind':_0x3b0712(0x129)},{'$group':{'_id':_0x3b0712(0xd2),'name':{'$first':_0x3b0712(0x148)},'product_stock':{'$first':_0x3b0712(0x141)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3b0712(0x120)},'type':{'$first':_0x3b0712(0x156)},'floorlevel':{'$first':_0x3b0712(0x104)},'primary_code':{'$first':_0x3b0712(0xf6)},'secondary_code':{'$first':_0x3b0712(0x122)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3b0712(0x10f)},'rack':{'$first':_0x3b0712(0x16a)},'maxPerUnit':{'$first':_0x3b0712(0x164)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x3b0712(0x179)},'room':{'$first':'$room'}}}]);if(_0x389bbc[0x0][_0x3b0712(0x14f)]==_0x3b0712(0x162)){var _0x328d26=users['English'];console[_0x3b0712(0x184)](_0x328d26);}else{if(_0x389bbc[0x0][_0x3b0712(0x14f)]=='Hindi')var _0x328d26=users['Hindi'];else{if(_0x389bbc[0x0][_0x3b0712(0x14f)]==_0x3b0712(0xeb))var _0x328d26=users['German'];else{if(_0x389bbc[0x0][_0x3b0712(0x14f)]==_0x3b0712(0x13b))var _0x328d26=users[_0x3b0712(0x13b)];else{if(_0x389bbc[0x0][_0x3b0712(0x14f)]==_0x3b0712(0x192))var _0x328d26=users[_0x3b0712(0x192)];else{if(_0x389bbc[0x0]['language']==_0x3b0712(0x18b))var _0x328d26=users[_0x3b0712(0x161)];else{if(_0x389bbc[0x0][_0x3b0712(0x14f)]=='Chinese')var _0x328d26=users[_0x3b0712(0x176)];else{if(_0x389bbc[0x0]['language']==_0x3b0712(0x18e))var _0x328d26=users[_0x3b0712(0x15a)];}}}}}}}_0x4fe7f4['render'](_0x3b0712(0xf5),{'success':_0x2632fc['flash'](_0x3b0712(0xf8)),'errors':_0x2632fc[_0x3b0712(0x19e)](_0x3b0712(0x198)),'role':_0x38033b,'profile':_0x522c5d,'adjustment':_0x4b6d2f,'stock':_0x4e93a0,'master_shop':_0x389bbc,'warehouse_name':_0x36b030,'unit':_0x4b29ff,'language':_0x328d26});}catch(_0x3d8105){console['log'](_0x3d8105),_0x4fe7f4[_0x3b0712(0x163)](0xc8)[_0x3b0712(0xea)]({'message':_0x3d8105[_0x3b0712(0x105)]});}}),router[a0_0x24d463(0xf0)]('/preview/:id',auth,async(_0x560563,_0x491bd0)=>{var _0x3a5960=a0_0x24d463;try{const _0x1b3374=_0x560563[_0x3a5960(0x183)]['id'],{warehouse_name:_0x24ae2e,Room_name:_0x3bdc52}=_0x560563[_0x3a5960(0xec)],_0x45c172=await adjustment[_0x3a5960(0x186)]({'_id':_0x1b3374}),_0x11514b=_0x45c172[_0x3a5960(0x13f)][_0x3a5960(0x188)](async _0x353bcf=>{var _0x1e0ea0=_0x3a5960;if(_0x353bcf[_0x1e0ea0(0x136)]>0x0){var _0x489f6b=await warehouse[_0x1e0ea0(0x10c)]({'name':_0x24ae2e,'room':_0x353bcf['room_names'],'warehouse_category':_0x1e0ea0(0xe0)});const _0x510a9b=_0x489f6b['product_details'][_0x1e0ea0(0x188)](_0x55c0ca=>{var _0x3e259b=_0x1e0ea0;if(_0x353bcf[_0x3e259b(0xcf)]==_0x3e259b(0x18c)){if(_0x55c0ca[_0x3e259b(0x150)]==_0x353bcf['product_name']&&_0x55c0ca[_0x3e259b(0xfc)]==_0x353bcf[_0x3e259b(0xfc)]&&_0x55c0ca[_0x3e259b(0xcf)]==_0x353bcf[_0x3e259b(0xcf)]&&_0x55c0ca[_0x3e259b(0x17c)]==_0x353bcf['bin']&&_0x55c0ca[_0x3e259b(0x193)]==_0x353bcf[_0x3e259b(0x193)]&&_0x55c0ca['rack']==_0x353bcf[_0x3e259b(0x157)]&&_0x55c0ca[_0x3e259b(0x110)]==_0x353bcf[_0x3e259b(0x110)]&&_0x55c0ca[_0x3e259b(0x14e)]==_0x353bcf[_0x3e259b(0x14e)]&&_0x55c0ca[_0x3e259b(0xce)]==_0x353bcf[_0x3e259b(0xce)]&&_0x55c0ca[_0x3e259b(0x112)]==_0x353bcf[_0x3e259b(0x112)]&&_0x55c0ca[_0x3e259b(0xf9)]==_0x353bcf['invoice']&&_0x55c0ca[_0x3e259b(0x199)]==_0x353bcf[_0x3e259b(0x18f)]){var _0x20732a;_0x20732a=_0x353bcf['adjust_qty'],_0x353bcf[_0x3e259b(0x14a)]=='S'&&(_0x20732a=_0x353bcf[_0x3e259b(0x136)]),_0x55c0ca['product_stock']=_0x55c0ca[_0x3e259b(0xdc)]-_0x20732a;}}else{if(_0x55c0ca[_0x3e259b(0x150)]==_0x353bcf[_0x3e259b(0x150)]&&_0x55c0ca[_0x3e259b(0xfc)]==_0x353bcf[_0x3e259b(0xfc)]&&_0x55c0ca[_0x3e259b(0xcf)]==_0x353bcf[_0x3e259b(0xcf)]&&_0x55c0ca['bin']==_0x353bcf[_0x3e259b(0x17c)]&&_0x55c0ca[_0x3e259b(0x193)]==_0x353bcf[_0x3e259b(0x193)]&&_0x55c0ca[_0x3e259b(0x157)]==_0x353bcf['rack']&&_0x55c0ca[_0x3e259b(0x110)]==_0x353bcf[_0x3e259b(0x110)]&&_0x55c0ca['expiry_date']==_0x353bcf[_0x3e259b(0x14e)]&&_0x55c0ca[_0x3e259b(0xce)]==_0x353bcf['batch_code']&&_0x55c0ca['production_date']==_0x353bcf[_0x3e259b(0x112)]&&_0x55c0ca['invoice']==_0x353bcf[_0x3e259b(0xf9)]&&_0x55c0ca[_0x3e259b(0x199)]==_0x353bcf[_0x3e259b(0x18f)]){console[_0x3e259b(0x184)](_0x353bcf);var _0x20732a;_0x20732a=_0x353bcf['adjust_qty'],_0x353bcf[_0x3e259b(0x14a)]=='S'&&(_0x20732a=_0x353bcf['adjust_qty']),console[_0x3e259b(0x184)](_0x20732a+'\x20<>\x20'+_0x353bcf[_0x3e259b(0x136)]+_0x3e259b(0xff)+_0x55c0ca['maxPerUnit']+_0x3e259b(0xff)+_0x353bcf[_0x3e259b(0x14a)]),_0x55c0ca[_0x3e259b(0xdc)]=_0x55c0ca[_0x3e259b(0xdc)]+_0x20732a;}}});}return _0x489f6b;});Promise[_0x3a5960(0xd1)](_0x11514b)[_0x3a5960(0x11b)](async _0x3692e4=>{var _0x4302aa=_0x3a5960;try{for(const _0x1dd7c0 of _0x3692e4){await _0x1dd7c0['save']();}_0x45c172[_0x4302aa(0x11e)]=_0x4302aa(0xe5);const _0x3954b5=await _0x45c172[_0x4302aa(0x133)](),_0x17308d=await master_shop[_0x4302aa(0x16c)](),_0x5bfcc8=await email_settings[_0x4302aa(0x10c)](),_0x317d1f=await supervisor_settings[_0x4302aa(0x16c)]();var _0x45b37e=_0x45c172[_0x4302aa(0x13f)],_0x1badfe='',_0x5139ce;for(_0x5139ce in _0x45b37e){_0x1badfe+=_0x4302aa(0x166)+_0x4302aa(0x125)+_0x45b37e[_0x5139ce][_0x4302aa(0x150)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x45b37e[_0x5139ce][_0x4302aa(0x144)]+_0x4302aa(0x158)+_0x4302aa(0x125)+_0x45b37e[_0x5139ce][_0x4302aa(0x136)]+_0x4302aa(0x158)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x45b37e[_0x5139ce][_0x4302aa(0x16f)]+_0x4302aa(0x158)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x45b37e[_0x5139ce][_0x4302aa(0x117)]+_0x4302aa(0x158)+_0x4302aa(0x125)+_0x45c172[_0x4302aa(0x197)]+_0x4302aa(0x158)+_0x4302aa(0x125)+_0x45b37e[_0x5139ce][_0x4302aa(0x143)]+_0x4302aa(0x158)+_0x4302aa(0x125)+_0x45b37e[_0x5139ce][_0x4302aa(0x110)]+_0x45b37e[_0x5139ce][_0x4302aa(0x157)]+_0x45b37e[_0x5139ce][_0x4302aa(0x193)]+_0x45b37e[_0x5139ce][_0x4302aa(0x17c)]+_0x45b37e[_0x5139ce]['type'][0x0]+_0x45b37e[_0x5139ce][_0x4302aa(0xfc)]+'</td>',_0x4302aa(0x155);}let _0x1d52c2=nodemailer[_0x4302aa(0x138)]({'host':_0x5bfcc8[_0x4302aa(0xf1)],'port':Number(_0x5bfcc8['port']),'secure':![],'auth':{'user':_0x5bfcc8[_0x4302aa(0xdd)],'pass':_0x5bfcc8[_0x4302aa(0xf7)]}}),_0xd77bb={'from':_0x5bfcc8[_0x4302aa(0xdd)],'to':_0x317d1f[0x0]['RMSEmail'],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x4302aa(0x12a)+_0x4302aa(0x190)+_0x17308d[0x0]['image'],'cid':_0x4302aa(0x11f)}],'html':_0x4302aa(0x127)+_0x4302aa(0x173)+'</head><body>'+_0x4302aa(0x19c)+_0x4302aa(0x174)+_0x4302aa(0x19c)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x4302aa(0xe2)+_0x4302aa(0x19c)+_0x4302aa(0x170)+_0x17308d[0x0]['site_title']+_0x4302aa(0x177)+'</div>'+_0x4302aa(0xe2)+'<hr\x20class=\x22my-3\x22>'+_0x4302aa(0x19c)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x4302aa(0x15e)+_0x45c172[_0x4302aa(0xf9)]+'\x20'+_0x4302aa(0x13a)+_0x4302aa(0x185)+_0x45c172[_0x4302aa(0x149)]+'\x20'+_0x4302aa(0x116)+_0x4302aa(0xfa)+_0x4302aa(0xe2)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4302aa(0x151)+_0x4302aa(0x166)+_0x4302aa(0xde)+_0x4302aa(0x12d)+_0x4302aa(0x139)+_0x4302aa(0x118)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x4302aa(0x15f)+_0x4302aa(0x18a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x4302aa(0x155)+_0x4302aa(0x160)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1badfe+'\x20'+_0x4302aa(0xd5)+_0x4302aa(0x132)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x4302aa(0x167)+_0x17308d[0x0][_0x4302aa(0x10e)]+'</h5>'+_0x4302aa(0xe2)+_0x4302aa(0xe2)+_0x4302aa(0xfd)};_0x1d52c2[_0x4302aa(0x140)](_0xd77bb,function(_0x52342b,_0x4d4a52){var _0x5720db=_0x4302aa;_0x52342b?(console[_0x5720db(0x184)](_0x52342b),console[_0x5720db(0x184)](_0x5720db(0x1a0))):console[_0x5720db(0x184)](_0x5720db(0x14d));}),_0x560563[_0x4302aa(0x19e)]('success',_0x4302aa(0x101)),_0x491bd0[_0x4302aa(0x171)]('/picking_list/PDF_adjustment_rm/'+_0x3954b5[_0x4302aa(0x199)]);}catch(_0x35209b){console[_0x4302aa(0xe9)](_0x35209b),_0x491bd0[_0x4302aa(0x163)](0x1f4)['json']({'error':_0x4302aa(0x12c)});}})[_0x3a5960(0x15c)](_0x1ace18=>{var _0x30eea3=_0x3a5960;console['error'](_0x1ace18),_0x491bd0['status'](0x1f4)[_0x30eea3(0xea)]({'error':_0x30eea3(0x12f)});});}catch(_0x174acd){console['log'](_0x174acd),_0x491bd0[_0x3a5960(0x163)](0xc8)[_0x3a5960(0xea)]({'message':_0x174acd[_0x3a5960(0x105)]});}}),router[a0_0x24d463(0x106)](a0_0x24d463(0x19a),auth,async(_0x52b4d1,_0x281745)=>{var _0x53113c=a0_0x24d463;try{const {username:_0x4497b1,email:_0x262b7b,role:_0x5ae6c3}=_0x52b4d1['user'],_0x8c5429=_0x52b4d1[_0x53113c(0x115)],_0xf86532=await profile[_0x53113c(0x10c)]({'email':_0x8c5429[_0x53113c(0xdd)]}),_0x142bd6=await master_shop[_0x53113c(0x16c)](),_0x58213e=_0x52b4d1[_0x53113c(0x183)]['id'],_0x38b720=await adjustment[_0x53113c(0x186)]({'_id':_0x58213e}),_0x13ad50=await purchases[_0x53113c(0x123)]([{'$match':{'warehouse_name':_0x38b720[_0x53113c(0x197)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x58c806=await product[_0x53113c(0x16c)]({}),_0xa90d40=await warehouse[_0x53113c(0x123)]([{'$match':{'name':_0x38b720['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x53113c(0xd2),'name':{'$first':_0x53113c(0x148)},'product_stock':{'$first':_0x53113c(0x141)},'bay':{'$first':_0x53113c(0x187)},'bin':{'$first':_0x53113c(0x120)},'type':{'$first':_0x53113c(0x156)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x53113c(0xf6)},'secondary_code':{'$first':_0x53113c(0x122)},'product_code':{'$first':_0x53113c(0x114)},'storage':{'$first':_0x53113c(0x10f)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x53113c(0x121)},'production_date':{'$first':_0x53113c(0x14c)},'batch_code':{'$first':_0x53113c(0x179)},'room':{'$first':'$room'}}}]);let _0x2e7275;if(_0x8c5429[_0x53113c(0x16d)]=='staff'){const _0x4fc9a7=await staff[_0x53113c(0x10c)]({'email':_0x8c5429[_0x53113c(0xdd)]});_0x2e7275=await warehouse[_0x53113c(0x123)]([{'$match':{'status':_0x53113c(0x10d),'name':_0x4fc9a7[_0x53113c(0x154)],'warehouse_category':_0x53113c(0xe0),'name':{'$ne':_0x53113c(0x181)}}},{'$group':{'_id':_0x53113c(0xf4),'name':{'$first':'$name'}}}]);}else _0x2e7275=await warehouse[_0x53113c(0x123)]([{'$match':{'status':_0x53113c(0x10d),'warehouse_category':_0x53113c(0xe0),'name':{'$ne':_0x53113c(0x181)}}},{'$group':{'_id':'$name','name':{'$first':_0x53113c(0xf4)}}}]);if(_0x142bd6[0x0]['language']==_0x53113c(0x162)){var _0x487631=users[_0x53113c(0x189)];console['log'](_0x487631);}else{if(_0x142bd6[0x0][_0x53113c(0x14f)]=='Hindi')var _0x487631=users[_0x53113c(0x16b)];else{if(_0x142bd6[0x0][_0x53113c(0x14f)]=='German')var _0x487631=users['German'];else{if(_0x142bd6[0x0][_0x53113c(0x14f)]==_0x53113c(0x13b))var _0x487631=users['Spanish'];else{if(_0x142bd6[0x0][_0x53113c(0x14f)]==_0x53113c(0x192))var _0x487631=users[_0x53113c(0x192)];else{if(_0x142bd6[0x0][_0x53113c(0x14f)]==_0x53113c(0x18b))var _0x487631=users['Portuguese'];else{if(_0x142bd6[0x0][_0x53113c(0x14f)]==_0x53113c(0x176))var _0x487631=users[_0x53113c(0x176)];else{if(_0x142bd6[0x0][_0x53113c(0x14f)]==_0x53113c(0x18e))var _0x487631=users[_0x53113c(0x15a)];}}}}}}}_0x281745[_0x53113c(0x11c)](_0x53113c(0x10b),{'success':_0x52b4d1[_0x53113c(0x19e)](_0x53113c(0xf8)),'errors':_0x52b4d1[_0x53113c(0x19e)]('errors'),'role':_0x8c5429,'profile':_0xf86532,'adjustment':_0x38b720,'stock':_0xa90d40,'master_shop':_0x142bd6,'warehouse_name':_0x13ad50,'unit':_0x58c806,'language':_0x487631,'warehouse':_0x2e7275});}catch(_0xdb7ab3){console[_0x53113c(0x184)](_0xdb7ab3),_0x281745['status'](0xc8)['json']({'message':_0xdb7ab3[_0x53113c(0x105)]});}}),router['post']('/view/:id',auth,async(_0x53e248,_0x30df60)=>{var _0x46a604=a0_0x24d463;try{const _0x346c3f=_0x53e248[_0x46a604(0x183)]['id'],_0x2ceeca=await adjustment[_0x46a604(0x186)]({'_id':_0x346c3f}),_0x3d78d7=await warehouse[_0x46a604(0x10c)]({'name':_0x2ceeca[_0x46a604(0x197)],'room':_0x2ceeca[_0x46a604(0xee)]}),{warehouse_name:_0x40ab2b,date:_0x564477,prod_name:_0x15ffb6,level:_0x455f35,isle:_0x35a039,pallet:_0x528bef,stock:_0x4dc359,types:_0x3dcff5,adjust_qty:_0x4e73ba,new_adjust_qty:_0x30e3c8,note:_0xfe20fd,Room_name:_0x2d4c10,invoice:_0x4e8f3c,JO_number:_0x206934,expiry_date:_0x2784ea}=_0x53e248['body'];if(typeof _0x15ffb6==_0x46a604(0x14b))var _0xe8a07e=[_0x53e248[_0x46a604(0xec)][_0x46a604(0x11a)]],_0x51fcf9=[_0x53e248[_0x46a604(0xec)][_0x46a604(0x182)]],_0x5b83ae=[_0x53e248[_0x46a604(0xec)][_0x46a604(0xe7)]],_0x23dbce=[_0x53e248['body'][_0x46a604(0x12e)]],_0x4c83d3=[_0x53e248['body'][_0x46a604(0x137)]],_0x592f80=[_0x53e248[_0x46a604(0xec)][_0x46a604(0x146)]],_0x350126=[_0x53e248[_0x46a604(0xec)][_0x46a604(0xda)]],_0x3ffc41=[_0x53e248[_0x46a604(0xec)][_0x46a604(0xd8)]],_0x4cbb73=[_0x53e248[_0x46a604(0xec)][_0x46a604(0xd7)]],_0xd9cdab=[_0x53e248[_0x46a604(0xec)][_0x46a604(0xce)]],_0x2b509f=[_0x53e248['body'][_0x46a604(0x14e)]],_0x368983=[_0x53e248[_0x46a604(0xec)]['max_per_unit']],_0x41ea7f=[_0x53e248[_0x46a604(0xec)][_0x46a604(0x112)]],_0x56e0c7=[_0x53e248[_0x46a604(0xec)][_0x46a604(0x14a)]],_0x4b1cbd=[_0x53e248[_0x46a604(0xec)]['Rooms']],_0xf33978=[_0x53e248['body'][_0x46a604(0x178)]],_0x27809d=[_0x53e248['body']['second1']];else var _0xe8a07e=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x11a)]],_0x51fcf9=[..._0x53e248['body'][_0x46a604(0x182)]],_0x5b83ae=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0xe7)]],_0x23dbce=[..._0x53e248['body'][_0x46a604(0x12e)]],_0x4c83d3=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x137)]],_0x592f80=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x146)]],_0x350126=[..._0x53e248[_0x46a604(0xec)]['unit']],_0x3ffc41=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0xd8)]],_0x4cbb73=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0xd7)]],_0xd9cdab=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0xce)]],_0x2b509f=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x14e)]],_0x368983=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x10a)]],_0x41ea7f=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x112)]],_0x56e0c7=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x14a)]],_0x4b1cbd=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x191)]],_0xf33978=[..._0x53e248[_0x46a604(0xec)][_0x46a604(0x178)]],_0x27809d=[..._0x53e248[_0x46a604(0xec)]['second1']];const _0x2736f5=_0xe8a07e['map'](_0x15f252=>{return _0x15f252={'product_name':_0x15f252};});_0x51fcf9[_0x46a604(0x131)]((_0x4837e8,_0x18c466)=>{var _0x554b87=_0x46a604;_0x4b1cbd[_0x554b87(0x131)]((_0x530d6d,_0x34b55e)=>{var _0x29a260=_0x554b87;if(_0x530d6d==_0x29a260(0xe6)&&_0x18c466==_0x34b55e){var _0x259ad7=_0x4837e8['slice'](0x3);_0x2736f5[_0x18c466]['storage']=_0x4837e8[0x0],_0x2736f5[_0x18c466]['rack']=_0x4837e8[0x1],_0x2736f5[_0x18c466][_0x29a260(0x193)]=0x0,_0x2736f5[_0x18c466][_0x29a260(0x17c)]=0x0,_0x2736f5[_0x18c466]['type']=_0x29a260(0x119),_0x2736f5[_0x18c466][_0x29a260(0xfc)]=_0x259ad7;}else{if(_0x530d6d==_0x29a260(0xd4)&&_0x18c466==_0x34b55e){var _0x259ad7=_0x4837e8['slice'](0x3);_0x2736f5[_0x18c466][_0x29a260(0x110)]=_0x4837e8[0x0],_0x2736f5[_0x18c466][_0x29a260(0x157)]=_0x4837e8[0x1],_0x2736f5[_0x18c466][_0x29a260(0x193)]=0x0,_0x2736f5[_0x18c466]['bin']=0x0,_0x2736f5[_0x18c466]['type']=_0x29a260(0x119),_0x2736f5[_0x18c466][_0x29a260(0xfc)]=_0x4837e8[0x5];}else{if(_0x18c466==_0x34b55e){var _0x1ed75f;if(_0x4837e8[0x4]=='L')_0x1ed75f='Level';else _0x4837e8[0x4]=='F'&&(_0x1ed75f=_0x29a260(0x119));_0x2736f5[_0x18c466][_0x29a260(0x110)]=_0x4837e8[0x0],_0x2736f5[_0x18c466]['rack']=_0x4837e8[0x1],_0x2736f5[_0x18c466][_0x29a260(0x193)]=_0x4837e8[0x2],_0x2736f5[_0x18c466][_0x29a260(0x17c)]=_0x4837e8[0x3],_0x2736f5[_0x18c466][_0x29a260(0xcf)]=_0x1ed75f,_0x2736f5[_0x18c466][_0x29a260(0xfc)]=_0x4837e8[0x5];}}}});}),_0x5b83ae[_0x46a604(0x131)]((_0x4f1065,_0x4dbd24)=>{var _0x557edb=_0x46a604;_0x2736f5[_0x4dbd24][_0x557edb(0x113)]=_0x4f1065;}),_0x23dbce['forEach']((_0x73e177,_0x1db6c8)=>{_0x2736f5[_0x1db6c8]['types']=_0x73e177;}),_0x4c83d3['forEach']((_0x3692e2,_0x47a975)=>{var _0x1fa795=_0x46a604;_0x2736f5[_0x47a975][_0x1fa795(0x136)]=_0x3692e2;}),_0x592f80[_0x46a604(0x131)]((_0x39f408,_0x17cb5b)=>{var _0x4249c2=_0x46a604;_0x2736f5[_0x17cb5b][_0x4249c2(0xe3)]=_0x39f408;}),_0x350126[_0x46a604(0x131)]((_0xd55cad,_0x909612)=>{var _0x460a3a=_0x46a604;_0x2736f5[_0x909612][_0x460a3a(0x16f)]=_0xd55cad;}),_0x3ffc41[_0x46a604(0x131)]((_0x386f02,_0x260828)=>{var _0x4c20a8=_0x46a604;_0x2736f5[_0x260828][_0x4c20a8(0x117)]=_0x386f02;}),_0x4cbb73[_0x46a604(0x131)]((_0x346830,_0x457ade)=>{_0x2736f5[_0x457ade]['product_code']=_0x346830;}),_0xd9cdab[_0x46a604(0x131)]((_0x425706,_0x5d72bc)=>{var _0x55199e=_0x46a604;_0x2736f5[_0x5d72bc][_0x55199e(0xce)]=_0x425706;}),_0x2b509f[_0x46a604(0x131)]((_0x267d6e,_0x4b7eec)=>{var _0x225ecd=_0x46a604;_0x2736f5[_0x4b7eec][_0x225ecd(0x14e)]=_0x267d6e;}),_0x368983[_0x46a604(0x131)]((_0x2445b2,_0x19ef82)=>{var _0x2ed3a4=_0x46a604;_0x2736f5[_0x19ef82][_0x2ed3a4(0xe4)]=_0x2445b2;}),_0x41ea7f[_0x46a604(0x131)]((_0x4710f2,_0x4f9f07)=>{var _0x385bba=_0x46a604;_0x2736f5[_0x4f9f07][_0x385bba(0x112)]=_0x4710f2;}),_0x56e0c7[_0x46a604(0x131)]((_0x5cd822,_0x409010)=>{var _0x3cacb6=_0x46a604;_0x2736f5[_0x409010][_0x3cacb6(0x14a)]=_0x5cd822;}),_0x4b1cbd[_0x46a604(0x131)]((_0x1aed93,_0x4c65df)=>{var _0x314ed1=_0x46a604;_0x2736f5[_0x4c65df][_0x314ed1(0x143)]=_0x1aed93;}),_0xf33978[_0x46a604(0x131)]((_0x16a1d5,_0xcb50af)=>{_0x2736f5[_0xcb50af]['primary_code']=_0x16a1d5;}),_0x27809d['forEach']((_0x93db30,_0x192ffb)=>{var _0x3a2583=_0x46a604;_0x2736f5[_0x192ffb][_0x3a2583(0x153)]=_0x93db30;});const _0x51371f=_0x2736f5['filter'](_0x3f635b=>_0x3f635b[_0x46a604(0x136)]!=='0'&&_0x3f635b[_0x46a604(0x136)]!=='');var _0x3400fc=0x0;_0x51371f['forEach'](_0x494d39=>{var _0x49f434=_0x46a604;console[_0x49f434(0x184)](_0x49f434(0x107),_0x494d39),parseInt(_0x494d39['adjust_qty'])<=0x0&&_0x3400fc++;});if(_0x3400fc!=0x0)return _0x53e248['flash'](_0x46a604(0x198),_0x46a604(0x19b)),_0x30df60[_0x46a604(0x171)](_0x46a604(0x12b));_0x2ceeca[_0x46a604(0x197)]=_0x40ab2b,_0x2ceeca['date']=_0x564477,_0x2ceeca['product']=_0x51371f,_0x2ceeca[_0x46a604(0x18d)]=_0xfe20fd,_0x2ceeca[_0x46a604(0xf9)]=_0x4e8f3c,_0x2ceeca[_0x46a604(0x13d)]='False';const _0x5b801e=await _0x2ceeca['save']();_0x53e248[_0x46a604(0x19e)](_0x46a604(0xf8),_0x46a604(0x130)),_0x30df60[_0x46a604(0x171)](_0x46a604(0x126));}catch(_0x4f758f){console[_0x46a604(0x184)](_0x4f758f);}}),router[a0_0x24d463(0xf0)](a0_0x24d463(0xe8),async(_0x3630d9,_0x15a33b)=>{var _0x527671=a0_0x24d463;const {primary_code:_0x541e88,warehouse_data:_0x10bd75,rooms_data:_0xfefdb1,Roomslist:_0x3ebe71}=_0x3630d9[_0x527671(0xec)],_0x1d7def=_0x3ebe71['split'](','),_0x395c77=[];async function _0x3e7968(_0x289159){var _0x1ccd85=_0x527671;const _0xd308b1=await warehouse[_0x1ccd85(0x123)]([{'$match':{'name':_0x10bd75,'room':_0x289159}},{'$unwind':_0x1ccd85(0x129)},{'$match':{'product_details.primary_code':_0x541e88}},{'$group':{'_id':_0x1ccd85(0xd2),'name':{'$first':_0x1ccd85(0x148)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1ccd85(0xf6)},'secondary_code':{'$first':_0x1ccd85(0x122)},'product_code':{'$first':_0x1ccd85(0x114)},'level':{'$first':_0x1ccd85(0x187)},'isle':{'$first':_0x1ccd85(0x120)},'type':{'$first':_0x1ccd85(0x156)},'pallet':{'$first':_0x1ccd85(0x104)},'unit':{'$first':_0x1ccd85(0x124)},'secondary_unit':{'$first':_0x1ccd85(0x194)},'storage':{'$first':_0x1ccd85(0x10f)},'rack':{'$first':_0x1ccd85(0x16a)},'expiry_date':{'$first':_0x1ccd85(0x121)},'production_date':{'$first':_0x1ccd85(0x14c)},'maxPerUnit':{'$first':_0x1ccd85(0x164)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x1ccd85(0x11d)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x2c7cc7=await warehouse[_0x1ccd85(0x123)]([{'$match':{'name':_0x10bd75,'room':_0x289159}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x541e88}},{'$group':{'_id':_0x1ccd85(0xd2),'name':{'$first':_0x1ccd85(0x148)},'product_stock':{'$first':_0x1ccd85(0x141)},'primary_code':{'$first':_0x1ccd85(0xf6)},'secondary_code':{'$first':_0x1ccd85(0x122)},'product_code':{'$first':_0x1ccd85(0x114)},'level':{'$first':_0x1ccd85(0x187)},'isle':{'$first':_0x1ccd85(0x120)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1ccd85(0x104)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x1ccd85(0x10f)},'rack':{'$first':_0x1ccd85(0x16a)},'expiry_date':{'$first':_0x1ccd85(0x121)},'production_date':{'$first':_0x1ccd85(0x14c)},'maxPerUnit':{'$first':_0x1ccd85(0x164)},'batch_code':{'$first':_0x1ccd85(0x179)},'product_cat':{'$first':_0x1ccd85(0x11d)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1ccd85(0x17f)}}}]);if(_0xd308b1[_0x1ccd85(0x152)]>0x0)_0x395c77[_0x1ccd85(0x165)](_0xd308b1);else _0x2c7cc7[_0x1ccd85(0x152)]>0x0&&_0x395c77[_0x1ccd85(0x165)](_0x2c7cc7);}const _0x4d2b23=_0x1d7def[_0x527671(0x188)](_0x56480a=>_0x3e7968(_0x56480a));await Promise[_0x527671(0xd1)](_0x4d2b23),_0x15a33b[_0x527671(0xea)](_0x395c77);}),router['post'](a0_0x24d463(0x175),async(_0x2b5e01,_0x4c2855)=>{var _0x218a56=a0_0x24d463;const {primaryCode:_0x441d94,secondaryCode:_0x27cc3e,productCode:_0x2afb91,level:_0x1ff9a8,isle:_0x4f508f,pallet:_0x3e40cd,warehouses:_0x5cd92c,room:_0x1f50a5}=_0x2b5e01[_0x218a56(0xec)];try{const _0xe42ae7=await warehouse[_0x218a56(0x123)]([{'$match':{'name':_0x5cd92c,'room':_0x1f50a5}},{'$unwind':_0x218a56(0x129)},{'$match':{'product_details.level':parseInt(_0x1ff9a8),'product_details.isle':_0x4f508f,'product_details.pallet':parseInt(_0x3e40cd)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x218a56(0x148)},'product_stock':{'$first':_0x218a56(0x141)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x218a56(0x169)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x4c2855[_0x218a56(0x163)](0xc8)['json'](_0xe42ae7);}catch(_0x397e10){_0x4c2855['status'](0x194)[_0x218a56(0xea)]({'message':_0x397e10[_0x218a56(0x105)]});}}),module[a0_0x24d463(0xfe)]=router;