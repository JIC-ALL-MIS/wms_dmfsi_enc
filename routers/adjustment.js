var a0_0x275e12=a0_0x2f4c;(function(_0xab8f30,_0x5067d4){var _0x289eb7=a0_0x2f4c,_0x115c99=_0xab8f30();while(!![]){try{var _0x88a572=-parseInt(_0x289eb7(0x1f5))/0x1*(parseInt(_0x289eb7(0x21a))/0x2)+parseInt(_0x289eb7(0x1df))/0x3+parseInt(_0x289eb7(0x1e0))/0x4+parseInt(_0x289eb7(0x194))/0x5*(-parseInt(_0x289eb7(0x1bc))/0x6)+parseInt(_0x289eb7(0x1ff))/0x7*(-parseInt(_0x289eb7(0x1e9))/0x8)+-parseInt(_0x289eb7(0x1bf))/0x9*(-parseInt(_0x289eb7(0x1ea))/0xa)+parseInt(_0x289eb7(0x16d))/0xb*(parseInt(_0x289eb7(0x168))/0xc);if(_0x88a572===_0x5067d4)break;else _0x115c99['push'](_0x115c99['shift']());}catch(_0x2376d3){_0x115c99['push'](_0x115c99['shift']());}}}(a0_0x25ac,0x2d3b1));function a0_0x25ac(){var _0x10a62e=['Return\x20Rooms','master','second1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.unit','\x20Order\x20Number\x20:\x20','</tbody>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','slice','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product.product_name','</h5>','message','<!DOCTYPE\x20html>','/barcode_scanner','forEach','string','Receiving\x20Area','/preview/:id','bay','<h2>\x20','130053ZumoZM','588376pXvfky','prod_invoice','$product_details.pallet','expiry_date','</div>','/../public','Secondary_units','bin','<span\x20style=\x22float:\x20right;\x22>','48dVGNLO','2790690tGDSys','type','$product_details.bin','Portuguese\x20(BR)','floorlevel','$product','$product.room_names','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/view/:id','unit','isAllowEdit','1105oZSzlN','\x20<>\x20','room','stock','/picking_list/PDF_adjustment_rm/','catch','$product_details.maxPerUnit','error','product_stock','findOne','242655ABvTxs','False','note','$product_details.secondary_unit','findById','Logo.png','edit_adjustment_view','$product_details.secondary_code','adjust_qty','$product_details.storage','$room','Floor','production_date','$name','../models/all_models','save','Primary_Units','$product_details.product_name','Return\x20Goods','Raw\x20Materials','$product_details.invoice','host','staff','toString','flash','prime1','rack','396WZnpLw','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','prod_code','room_names','logo','</tr>','$product_details.type','storage','warehouse_name','New_Qty_Converted','user','English\x20(US)','<div>','adjustment\x20add\x20successfull','status','prod_cat','sendMail','date','\x20</h2>','/CheckingWarehouse','aggregate','new_adjust_qty','$product_details.bay','invoice','level','$product_details.expiry_date','<h5>','push','map','$product_details.primary_code','foreach\x20newproduct','An\x20error\x20occurred\x20while\x20saving\x20data.','$finalize','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','email','product','</td>','floor','product_details','French','warehouse','<html><head><title></title>','Spanish','60OXjrMC','New_Qty_Converted_adj','product_code','random','primary_code','753071FAIcvz','$date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','errors','secondary_unit','Portuguese','edit_adjustment','port','$warehouse_name','site_title','padStart','language','True','$product_details','</thead>','body','maxperunit','Level','Arabic','types','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','role','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.level','German','Chinese','back','express','password','Hindi','then','length','Router','id_transaction','finalize','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.batch_code','8465jILxoS','$product_details.floorlevel','id_transaction_from','batch_code','Enabled','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','log','all','filter','nodemailer','Error\x20Occurs','/view/add_adjustment','Arabic\x20(ae)','Shelves','$product_details.rack','/upload/','$product_details.product_code','../public/language/languages.json','$product_details.product_cat','Adjustment\x20Mail','post','Rooms','/adjustment/view','$product_details.production_date','redirect','get','render','</table>','Enclosed','/view','$_id','$product_details._id','product_name','adjustment','$product_details.maxProducts','json','createTransport','add_adjustment','708LSGUam','ADJ-','max_per_unit','9IlgGlm','adjustment\x20data\x20update\x20successfully','minus','prod_name','<tbody\x20style=\x22text-align:\x20center;\x22>','image','find','params','<tr>','success'];a0_0x25ac=function(){return _0x10a62e;};return a0_0x25ac();}const express=require(a0_0x275e12(0x18a)),app=express(),router=express[a0_0x275e12(0x18f)](),auth=require(a0_0x275e12(0x21b)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x275e12(0x20d)),users=require(a0_0x275e12(0x1a7)),nodemailer=require(a0_0x275e12(0x19f));router[a0_0x275e12(0x1af)](a0_0x275e12(0x1b3),auth,async(_0x25c076,_0x5c16f3)=>{var _0x16c192=a0_0x275e12;try{const {username:_0x51c50d,email:_0x29da01,role:_0xc5f089}=_0x25c076['user'],_0x21f944=_0x25c076[_0x16c192(0x225)],_0x351c7a=await profile[_0x16c192(0x1fe)]({'email':_0x21f944[_0x16c192(0x15f)]}),_0xe19228=await master_shop[_0x16c192(0x1c5)]();console[_0x16c192(0x19c)](_0x16c192(0x1ca),_0xe19228);let _0x1f60d3;if(_0x21f944[_0x16c192(0x183)]==_0x16c192(0x215)){const _0x3ac6fc=await staff[_0x16c192(0x1fe)]({'email':_0x21f944[_0x16c192(0x15f)]});_0x1f60d3=await warehouse[_0x16c192(0x1c5)]({'status':_0x16c192(0x198),'name':_0x3ac6fc[_0x16c192(0x165)]});}else _0x1f60d3=await warehouse[_0x16c192(0x1c5)]({'status':'Enabled'});const _0xd4bd8a=await product[_0x16c192(0x1c5)]();let _0x1895b2;if(_0x21f944[_0x16c192(0x183)]==_0x16c192(0x215)){const _0xeaa62a=await staff[_0x16c192(0x1fe)]({'email':_0x21f944[_0x16c192(0x15f)]});_0x1895b2=await adjustment[_0x16c192(0x1c5)]({'warehouse_name':_0xeaa62a[_0x16c192(0x165)]});}else _0x1895b2=await adjustment['aggregate']([{'$unwind':_0x16c192(0x1ef)},{'$group':{'_id':_0x16c192(0x1b4),'invoice':{'$first':'$invoice'},'date':{'$first':_0x16c192(0x16e)},'warehouse_name':{'$first':_0x16c192(0x175)},'room':{'$addToSet':_0x16c192(0x1f0)},'finalize':{'$first':_0x16c192(0x15d)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xe19228[0x0]['language']=='English\x20(US)'){var _0x4ebdfb=users[_0x16c192(0x184)];console[_0x16c192(0x19c)](_0x4ebdfb);}else{if(_0xe19228[0x0][_0x16c192(0x178)]==_0x16c192(0x18c))var _0x4ebdfb=users[_0x16c192(0x18c)];else{if(_0xe19228[0x0][_0x16c192(0x178)]==_0x16c192(0x187))var _0x4ebdfb=users[_0x16c192(0x187)];else{if(_0xe19228[0x0][_0x16c192(0x178)]==_0x16c192(0x167))var _0x4ebdfb=users[_0x16c192(0x167)];else{if(_0xe19228[0x0][_0x16c192(0x178)]==_0x16c192(0x164))var _0x4ebdfb=users['French'];else{if(_0xe19228[0x0][_0x16c192(0x178)]==_0x16c192(0x1ed))var _0x4ebdfb=users[_0x16c192(0x172)];else{if(_0xe19228[0x0]['language']==_0x16c192(0x188))var _0x4ebdfb=users[_0x16c192(0x188)];else{if(_0xe19228[0x0][_0x16c192(0x178)]==_0x16c192(0x1a2))var _0x4ebdfb=users[_0x16c192(0x17f)];}}}}}}}_0x5c16f3[_0x16c192(0x1b0)](_0x16c192(0x1b7),{'success':_0x25c076[_0x16c192(0x217)]('success'),'errors':_0x25c076[_0x16c192(0x217)](_0x16c192(0x170)),'role':_0x21f944,'profile':_0x351c7a,'warehouse':_0x1f60d3,'product':_0xd4bd8a,'adjustment':_0x1895b2,'master_shop':_0xe19228,'language':_0x4ebdfb});}catch(_0x15ff1f){console[_0x16c192(0x19c)](_0x15ff1f);}});async function getRandom8DigitNumber(){var _0x10b8e4=a0_0x275e12;const _0x45b848=0x989680,_0x2933d4=0x5f5e0ff,_0x2d7af1=Math[_0x10b8e4(0x162)](Math[_0x10b8e4(0x16b)]()*(_0x2933d4-_0x45b848+0x1))+_0x45b848;var _0x2eb382;const _0x3a6d53=await adjustment[_0x10b8e4(0x1fe)]({'invoice':_0x10b8e4(0x1bd)+_0x2d7af1});return _0x3a6d53&&_0x3a6d53[_0x10b8e4(0x18e)]>0x0?_0x2eb382=_0x10b8e4(0x1bd)+_0x2d7af1:_0x2eb382=_0x10b8e4(0x1bd)+_0x2d7af1,_0x2eb382;}function a0_0x2f4c(_0x977596,_0x509361){var _0x25aca3=a0_0x25ac();return a0_0x2f4c=function(_0x2f4c2b,_0x3b4670){_0x2f4c2b=_0x2f4c2b-0x149;var _0x14b9b2=_0x25aca3[_0x2f4c2b];return _0x14b9b2;},a0_0x2f4c(_0x977596,_0x509361);}router['get'](a0_0x275e12(0x1a1),auth,async(_0x520269,_0x2a2096)=>{var _0x368f99=a0_0x275e12;try{const {username:_0x5336f2,email:_0x540ca7,role:_0x5ed80b}=_0x520269[_0x368f99(0x225)],_0x34223d=_0x520269[_0x368f99(0x225)],_0x18848c=await profile[_0x368f99(0x1fe)]({'email':_0x34223d[_0x368f99(0x15f)]}),_0x4412c9=await master_shop[_0x368f99(0x1c5)]();let _0x459184;if(_0x34223d[_0x368f99(0x183)]==_0x368f99(0x215)){const _0xd80d73=await staff['findOne']({'email':_0x34223d[_0x368f99(0x15f)]});_0x459184=await warehouse[_0x368f99(0x151)]([{'$match':{'status':'Enabled','name':_0xd80d73[_0x368f99(0x165)],'warehouse_category':_0x368f99(0x212),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x368f99(0x20c),'name':{'$first':_0x368f99(0x20c)}}}]);}else _0x459184=await warehouse[_0x368f99(0x151)]([{'$match':{'status':'Enabled','warehouse_category':_0x368f99(0x212),'name':{'$ne':_0x368f99(0x211)}}},{'$group':{'_id':_0x368f99(0x20c),'name':{'$first':_0x368f99(0x20c)}}}]);const _0x580744=await product[_0x368f99(0x1c5)]({}),_0x2ea60f=await adjustment[_0x368f99(0x1c5)]({}),_0x380186=_0x2ea60f[_0x368f99(0x18e)]+0x1,_0x4636ea='ADJ-'+_0x380186[_0x368f99(0x216)]()[_0x368f99(0x177)](0x5,'0');var _0x23f183=['Ambient',_0x368f99(0x1b2),_0x368f99(0x1c9)];if(_0x4412c9[0x0][_0x368f99(0x178)]==_0x368f99(0x226))var _0x3ff04f=users[_0x368f99(0x184)];else{if(_0x4412c9[0x0][_0x368f99(0x178)]=='Hindi')var _0x3ff04f=users[_0x368f99(0x18c)];else{if(_0x4412c9[0x0][_0x368f99(0x178)]==_0x368f99(0x187))var _0x3ff04f=users[_0x368f99(0x187)];else{if(_0x4412c9[0x0][_0x368f99(0x178)]==_0x368f99(0x167))var _0x3ff04f=users[_0x368f99(0x167)];else{if(_0x4412c9[0x0][_0x368f99(0x178)]=='French')var _0x3ff04f=users[_0x368f99(0x164)];else{if(_0x4412c9[0x0][_0x368f99(0x178)]=='Portuguese\x20(BR)')var _0x3ff04f=users['Portuguese'];else{if(_0x4412c9[0x0][_0x368f99(0x178)]=='Chinese')var _0x3ff04f=users[_0x368f99(0x188)];else{if(_0x4412c9[0x0][_0x368f99(0x178)]==_0x368f99(0x1a2))var _0x3ff04f=users[_0x368f99(0x17f)];}}}}}}}const _0x3cc65e=getRandom8DigitNumber();_0x3cc65e['then'](_0x39dd4a=>{var _0x4d1ccc=_0x368f99;_0x2a2096['render'](_0x4d1ccc(0x1bb),{'success':_0x520269[_0x4d1ccc(0x217)](_0x4d1ccc(0x1c8)),'errors':_0x520269[_0x4d1ccc(0x217)](_0x4d1ccc(0x170)),'role':_0x34223d,'profile':_0x18848c,'warehouse':_0x459184,'product':_0x580744,'master_shop':_0x4412c9,'language':_0x3ff04f,'rooms_data':_0x23f183,'invoice_no':_0x39dd4a});})[_0x368f99(0x1fa)](_0x341912=>{var _0x5ac13a=_0x368f99;_0x520269[_0x5ac13a(0x217)](_0x5ac13a(0x170),_0x5ac13a(0x181)),_0x2a2096[_0x5ac13a(0x1ae)](_0x5ac13a(0x1ac));});}catch(_0x4037d2){console[_0x368f99(0x19c)](_0x4037d2);}}),router['post'](a0_0x275e12(0x1a1),auth,async(_0x25a3cc,_0x4b162d)=>{var _0x468577=a0_0x275e12;try{const {warehouse_name:_0x57f659,date:_0x2296c1,prod_name:_0x523f54,level:_0x55d821,isle:_0x3cc7b7,pallet:_0x26821e,stock:_0x3b7efb,types:_0x57fb78,adjust_qty:_0x332c22,new_adjust_qty:_0x1808da,note:_0x327675,Room_name:_0x59301f,invoice:_0x415f4,JO_number:_0x3b2930,expiry_date:_0x42f82a}=_0x25a3cc[_0x468577(0x17c)];if(typeof _0x523f54==_0x468577(0x1da))var _0x4b5936=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x1c2)]],_0x4cdc96=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x155)]],_0x288825=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x1f8)]],_0x114dbe=[_0x25a3cc['body'][_0x468577(0x180)]],_0x271f5f=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x169)]],_0x262149=[_0x25a3cc['body'][_0x468577(0x224)]],_0x59cb70=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x20f)]],_0x50b58=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x1e6)]],_0x5d14d2=[_0x25a3cc['body'][_0x468577(0x21d)]],_0x3adc27=[_0x25a3cc['body']['batch_code']],_0x435958=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x1e3)]],_0x2ff0af=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x1be)]],_0x263764=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x20b)]],_0x20a49e=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x14c)]],_0x50f07c=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x1ab)]],_0x43253d=[_0x25a3cc[_0x468577(0x17c)]['prime1']],_0x4f3f12=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x1cb)]],_0x2bb47a=[_0x25a3cc[_0x468577(0x17c)]['prod_invoice']],_0x473d9b=[_0x25a3cc[_0x468577(0x17c)][_0x468577(0x190)]];else var _0x4b5936=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x1c2)]],_0x4cdc96=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x155)]],_0x288825=[..._0x25a3cc['body'][_0x468577(0x1f8)]],_0x114dbe=[..._0x25a3cc[_0x468577(0x17c)]['types']],_0x271f5f=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x169)]],_0x262149=[..._0x25a3cc['body'][_0x468577(0x224)]],_0x59cb70=[..._0x25a3cc['body'][_0x468577(0x1f3)]],_0x50b58=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x1e6)]],_0x5d14d2=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x21d)]],_0x3adc27=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x197)]],_0x435958=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x1e3)]],_0x2ff0af=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x1be)]],_0x263764=[..._0x25a3cc[_0x468577(0x17c)]['production_date']],_0x20a49e=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x14c)]],_0x50f07c=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x1ab)]],_0x43253d=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x218)]],_0x4f3f12=[..._0x25a3cc['body'][_0x468577(0x1cb)]],_0x2bb47a=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x1e1)]],_0x473d9b=[..._0x25a3cc[_0x468577(0x17c)][_0x468577(0x190)]];const _0x5ed837=_0x4b5936[_0x468577(0x159)](_0x152cad=>{return _0x152cad={'product_name':_0x152cad};});_0x4cdc96[_0x468577(0x1d9)]((_0x42c970,_0x499ece)=>{var _0xeb904c=_0x468577;_0x50f07c[_0xeb904c(0x1d9)]((_0x440181,_0x32a642)=>{var _0xdf71dc=_0xeb904c;if(_0x440181==_0xdf71dc(0x1db)&&_0x499ece==_0x32a642){var _0x2d6eb7=_0x42c970[_0xdf71dc(0x1d1)](0x3);_0x5ed837[_0x499ece][_0xdf71dc(0x222)]=_0x42c970[0x0],_0x5ed837[_0x499ece][_0xdf71dc(0x219)]=_0x42c970[0x1],_0x5ed837[_0x499ece][_0xdf71dc(0x1dd)]=0x0,_0x5ed837[_0x499ece]['bin']=0x0,_0x5ed837[_0x499ece][_0xdf71dc(0x1eb)]=_0xdf71dc(0x20a),_0x5ed837[_0x499ece][_0xdf71dc(0x1ee)]=_0x2d6eb7;}else{if(_0x440181==_0xdf71dc(0x1a3)&&_0x499ece==_0x32a642){var _0x2d6eb7=_0x42c970[_0xdf71dc(0x1d1)](0x3);_0x5ed837[_0x499ece][_0xdf71dc(0x222)]=_0x42c970[0x0],_0x5ed837[_0x499ece][_0xdf71dc(0x219)]=_0x42c970[0x1],_0x5ed837[_0x499ece][_0xdf71dc(0x1dd)]=0x0,_0x5ed837[_0x499ece][_0xdf71dc(0x1e7)]=0x0,_0x5ed837[_0x499ece]['type']=_0xdf71dc(0x20a),_0x5ed837[_0x499ece][_0xdf71dc(0x1ee)]=_0x42c970[0x5];}else{if(_0x499ece==_0x32a642){var _0x147268;if(_0x42c970[0x4]=='L')_0x147268=_0xdf71dc(0x17e);else _0x42c970[0x4]=='F'&&(_0x147268='Floor');_0x5ed837[_0x499ece]['storage']=_0x42c970[0x0],_0x5ed837[_0x499ece][_0xdf71dc(0x219)]=_0x42c970[0x1],_0x5ed837[_0x499ece][_0xdf71dc(0x1dd)]=_0x42c970[0x2],_0x5ed837[_0x499ece][_0xdf71dc(0x1e7)]=_0x42c970[0x3],_0x5ed837[_0x499ece]['type']=_0x147268,_0x5ed837[_0x499ece][_0xdf71dc(0x1ee)]=_0x42c970[0x5];}}}});}),_0x288825[_0x468577(0x1d9)]((_0x2c883e,_0x170436)=>{_0x5ed837[_0x170436]['stockBefore']=_0x2c883e;}),_0x473d9b[_0x468577(0x1d9)]((_0x17de91,_0x367641)=>{_0x5ed837[_0x367641]['id_transaction_from']=_0x17de91;}),_0x114dbe[_0x468577(0x1d9)]((_0x4bff0a,_0x265f21)=>{var _0x3ffcd8=_0x468577;_0x5ed837[_0x265f21][_0x3ffcd8(0x180)]=_0x4bff0a;}),_0x271f5f[_0x468577(0x1d9)]((_0x42074d,_0x404175)=>{var _0x5e9d7e=_0x468577;_0x5ed837[_0x404175][_0x5e9d7e(0x207)]=_0x42074d;}),_0x262149[_0x468577(0x1d9)]((_0x5456b1,_0x189532)=>{_0x5ed837[_0x189532]['new_adjust_qty']=_0x5456b1;}),_0x59cb70[_0x468577(0x1d9)]((_0x4548bb,_0x461104)=>{var _0x16c2fe=_0x468577;_0x5ed837[_0x461104][_0x16c2fe(0x1f3)]=_0x4548bb;}),_0x50b58['forEach']((_0x5cc83f,_0x5d0aff)=>{var _0x435601=_0x468577;_0x5ed837[_0x5d0aff][_0x435601(0x171)]=_0x5cc83f;}),_0x5d14d2[_0x468577(0x1d9)]((_0x210ea5,_0x1e9a3a)=>{var _0x4edc60=_0x468577;_0x5ed837[_0x1e9a3a][_0x4edc60(0x16a)]=_0x210ea5;}),_0x3adc27['forEach']((_0x4fcfd9,_0x4081e0)=>{_0x5ed837[_0x4081e0]['batch_code']=_0x4fcfd9;}),_0x435958[_0x468577(0x1d9)]((_0x217ae5,_0x2667c1)=>{_0x5ed837[_0x2667c1]['expiry_date']=_0x217ae5;}),_0x2ff0af[_0x468577(0x1d9)]((_0x51f7a0,_0x23c190)=>{var _0x5da17c=_0x468577;_0x5ed837[_0x23c190][_0x5da17c(0x17d)]=_0x51f7a0;}),_0x263764[_0x468577(0x1d9)]((_0x4c926a,_0x5b1a35)=>{var _0x320ad7=_0x468577;_0x5ed837[_0x5b1a35][_0x320ad7(0x20b)]=_0x4c926a;}),_0x20a49e[_0x468577(0x1d9)]((_0x3ac132,_0x164fc9)=>{var _0x24b01e=_0x468577;_0x5ed837[_0x164fc9][_0x24b01e(0x14c)]=_0x3ac132;}),_0x50f07c[_0x468577(0x1d9)]((_0x4c9542,_0x1c03d3)=>{var _0x583714=_0x468577;_0x5ed837[_0x1c03d3][_0x583714(0x21e)]=_0x4c9542;}),_0x43253d[_0x468577(0x1d9)]((_0xcc85e0,_0x219960)=>{var _0x170b76=_0x468577;_0x5ed837[_0x219960][_0x170b76(0x16c)]=_0xcc85e0;}),_0x4f3f12[_0x468577(0x1d9)]((_0x3c3987,_0x5823ac)=>{_0x5ed837[_0x5823ac]['secondary_code']=_0x3c3987;}),_0x2bb47a[_0x468577(0x1d9)]((_0x268941,_0x29a60e)=>{var _0xb09ab6=_0x468577;_0x5ed837[_0x29a60e][_0xb09ab6(0x154)]=_0x268941;});const _0x2bf013=_0x5ed837['filter'](_0x414f82=>_0x414f82[_0x468577(0x207)]!=='0'&&_0x414f82['adjust_qty']!=='');var _0x39ec68=0x0;_0x2bf013['forEach'](_0x47165b=>{var _0x4241a8=_0x468577;console['log'](_0x4241a8(0x15b),_0x47165b),parseInt(_0x47165b['adjust_qty'])<=0x0&&_0x39ec68++;});if(_0x39ec68!=0x0)return _0x25a3cc[_0x468577(0x217)](_0x468577(0x170),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x4b162d['redirect'](_0x468577(0x189));const _0x56bb16=new adjustment({'warehouse_name':_0x57f659,'date':_0x2296c1,'product':_0x2bf013,'note':_0x327675,'room':_0x59301f,'invoice':_0x415f4,'JO_number':_0x3b2930,'expiry_date':_0x42f82a}),_0x3cfd53=await _0x56bb16['save']();_0x25a3cc[_0x468577(0x217)](_0x468577(0x1c8),_0x468577(0x14a)),_0x4b162d[_0x468577(0x1ae)]('/adjustment/preview/'+_0x3cfd53[_0x468577(0x19a)]);}catch(_0x4e3a06){console[_0x468577(0x19c)](_0x4e3a06),_0x4b162d[_0x468577(0x14b)](0xc8)['json']({'message':_0x4e3a06['message']});}}),router['get'](a0_0x275e12(0x1dc),auth,async(_0xd1d089,_0x44ad41)=>{var _0x49f8a0=a0_0x275e12;try{const {username:_0x17ea02,email:_0x497c37,role:_0x3cbf48}=_0xd1d089[_0x49f8a0(0x225)],_0x1ad003=_0xd1d089[_0x49f8a0(0x225)],_0x42fb95=await profile[_0x49f8a0(0x1fe)]({'email':_0x1ad003[_0x49f8a0(0x15f)]}),_0x4529fe=await master_shop['find'](),_0x2e17b9=_0xd1d089[_0x49f8a0(0x1c6)]['id'],_0x4b3496=await adjustment[_0x49f8a0(0x203)]({'_id':_0x2e17b9}),_0x2b7832=await purchases['aggregate']([{'$match':{'warehouse_name':_0x4b3496[_0x49f8a0(0x223)]}},{'$unwind':_0x49f8a0(0x1ef)},{'$group':{'_id':_0x49f8a0(0x1d4)}}]),_0x3da677=await product[_0x49f8a0(0x1c5)]({}),_0x200109=await warehouse['aggregate']([{'$match':{'name':_0x4b3496['warehouse_name']}},{'$unwind':_0x49f8a0(0x17a)},{'$group':{'_id':_0x49f8a0(0x1b5),'name':{'$first':_0x49f8a0(0x210)},'product_stock':{'$first':_0x49f8a0(0x1d2)},'bay':{'$first':_0x49f8a0(0x153)},'bin':{'$first':_0x49f8a0(0x1ec)},'type':{'$first':_0x49f8a0(0x221)},'floorlevel':{'$first':_0x49f8a0(0x195)},'primary_code':{'$first':_0x49f8a0(0x15a)},'secondary_code':{'$first':_0x49f8a0(0x206)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x49f8a0(0x1a4)},'maxPerUnit':{'$first':_0x49f8a0(0x1fb)},'expiry_date':{'$first':_0x49f8a0(0x156)},'production_date':{'$first':_0x49f8a0(0x1ad)},'batch_code':{'$first':_0x49f8a0(0x193)},'room':{'$first':_0x49f8a0(0x209)}}}]);if(_0x4529fe[0x0][_0x49f8a0(0x178)]==_0x49f8a0(0x226)){var _0x4b2c7b=users[_0x49f8a0(0x184)];console[_0x49f8a0(0x19c)](_0x4b2c7b);}else{if(_0x4529fe[0x0][_0x49f8a0(0x178)]==_0x49f8a0(0x18c))var _0x4b2c7b=users[_0x49f8a0(0x18c)];else{if(_0x4529fe[0x0][_0x49f8a0(0x178)]==_0x49f8a0(0x187))var _0x4b2c7b=users[_0x49f8a0(0x187)];else{if(_0x4529fe[0x0][_0x49f8a0(0x178)]==_0x49f8a0(0x167))var _0x4b2c7b=users[_0x49f8a0(0x167)];else{if(_0x4529fe[0x0]['language']==_0x49f8a0(0x164))var _0x4b2c7b=users[_0x49f8a0(0x164)];else{if(_0x4529fe[0x0][_0x49f8a0(0x178)]==_0x49f8a0(0x1ed))var _0x4b2c7b=users['Portuguese'];else{if(_0x4529fe[0x0][_0x49f8a0(0x178)]==_0x49f8a0(0x188))var _0x4b2c7b=users['Chinese'];else{if(_0x4529fe[0x0]['language']==_0x49f8a0(0x1a2))var _0x4b2c7b=users[_0x49f8a0(0x17f)];}}}}}}}_0x44ad41['render'](_0x49f8a0(0x205),{'success':_0xd1d089[_0x49f8a0(0x217)](_0x49f8a0(0x1c8)),'errors':_0xd1d089['flash'](_0x49f8a0(0x170)),'role':_0x1ad003,'profile':_0x42fb95,'adjustment':_0x4b3496,'stock':_0x200109,'master_shop':_0x4529fe,'warehouse_name':_0x2b7832,'unit':_0x3da677,'language':_0x4b2c7b});}catch(_0x37d35b){console[_0x49f8a0(0x19c)](_0x37d35b),_0x44ad41[_0x49f8a0(0x14b)](0xc8)[_0x49f8a0(0x1b9)]({'message':_0x37d35b['message']});}}),router[a0_0x275e12(0x1aa)](a0_0x275e12(0x1dc),auth,async(_0x2f1180,_0x32a98d)=>{var _0xc94af2=a0_0x275e12;try{const _0x5292ce=_0x2f1180[_0xc94af2(0x1c6)]['id'],{warehouse_name:_0x535f66,Room_name:_0x5566bf}=_0x2f1180[_0xc94af2(0x17c)],_0x3b40b9=await adjustment[_0xc94af2(0x203)]({'_id':_0x5292ce}),_0xaeeabd=_0x3b40b9[_0xc94af2(0x160)][_0xc94af2(0x159)](async _0x1a4dcc=>{var _0x403f9e=_0xc94af2;if(_0x1a4dcc[_0x403f9e(0x207)]>0x0){var _0x504a7e=await warehouse[_0x403f9e(0x1fe)]({'name':_0x535f66,'room':_0x1a4dcc[_0x403f9e(0x21e)],'warehouse_category':_0x403f9e(0x212)});const _0x2b3d9b=_0x504a7e[_0x403f9e(0x163)][_0x403f9e(0x159)](_0x4014b0=>{var _0x16c461=_0x403f9e;console[_0x16c461(0x19c)](_0x1a4dcc[_0x16c461(0x180)]+_0x16c461(0x1f6));if(_0x1a4dcc[_0x16c461(0x180)]==_0x16c461(0x1c1)){if(_0x4014b0[_0x16c461(0x1b6)]==_0x1a4dcc[_0x16c461(0x1b6)]&&_0x4014b0[_0x16c461(0x1ee)]==_0x1a4dcc[_0x16c461(0x1ee)]&&_0x4014b0['type']==_0x1a4dcc[_0x16c461(0x1eb)]&&_0x4014b0[_0x16c461(0x1e7)]==_0x1a4dcc[_0x16c461(0x1e7)]&&_0x4014b0['bay']==_0x1a4dcc[_0x16c461(0x1dd)]&&_0x4014b0['rack']==_0x1a4dcc['rack']&&_0x4014b0[_0x16c461(0x222)]==_0x1a4dcc[_0x16c461(0x222)]&&_0x4014b0[_0x16c461(0x1e3)]==_0x1a4dcc[_0x16c461(0x1e3)]&&_0x4014b0[_0x16c461(0x197)]==_0x1a4dcc['batch_code']&&_0x4014b0[_0x16c461(0x20b)]==_0x1a4dcc[_0x16c461(0x20b)]&&_0x4014b0[_0x16c461(0x154)]==_0x1a4dcc[_0x16c461(0x154)]&&_0x4014b0[_0x16c461(0x19a)]==_0x1a4dcc[_0x16c461(0x196)]){var _0x412864;_0x412864=_0x1a4dcc[_0x16c461(0x207)],_0x1a4dcc[_0x16c461(0x14c)]=='S'&&(_0x412864=_0x1a4dcc[_0x16c461(0x207)]),_0x4014b0[_0x16c461(0x1fd)]=_0x4014b0[_0x16c461(0x1fd)]-_0x412864;}}else{if(_0x4014b0[_0x16c461(0x1b6)]==_0x1a4dcc[_0x16c461(0x1b6)]&&_0x4014b0['floorlevel']==_0x1a4dcc['floorlevel']&&_0x4014b0['type']==_0x1a4dcc[_0x16c461(0x1eb)]&&_0x4014b0[_0x16c461(0x1e7)]==_0x1a4dcc[_0x16c461(0x1e7)]&&_0x4014b0[_0x16c461(0x1dd)]==_0x1a4dcc[_0x16c461(0x1dd)]&&_0x4014b0[_0x16c461(0x219)]==_0x1a4dcc[_0x16c461(0x219)]&&_0x4014b0[_0x16c461(0x222)]==_0x1a4dcc['storage']&&_0x4014b0[_0x16c461(0x1e3)]==_0x1a4dcc[_0x16c461(0x1e3)]&&_0x4014b0[_0x16c461(0x197)]==_0x1a4dcc[_0x16c461(0x197)]&&_0x4014b0[_0x16c461(0x20b)]==_0x1a4dcc[_0x16c461(0x20b)]&&_0x4014b0[_0x16c461(0x154)]==_0x1a4dcc[_0x16c461(0x154)]&&_0x4014b0[_0x16c461(0x19a)]==_0x1a4dcc[_0x16c461(0x196)]){console[_0x16c461(0x19c)](_0x1a4dcc);var _0x412864;_0x412864=_0x1a4dcc[_0x16c461(0x207)],_0x1a4dcc[_0x16c461(0x14c)]=='S'&&(_0x412864=_0x1a4dcc[_0x16c461(0x207)]),_0x4014b0['product_stock']=_0x4014b0[_0x16c461(0x1fd)]+_0x412864;}}});}return _0x504a7e;});Promise[_0xc94af2(0x19d)](_0xaeeabd)[_0xc94af2(0x18d)](async _0xa1d8af=>{var _0x3c1f85=_0xc94af2;try{for(const _0x42509a of _0xa1d8af){await _0x42509a[_0x3c1f85(0x20e)]();}_0x3b40b9[_0x3c1f85(0x191)]=_0x3c1f85(0x179);const _0xb9bd33=await _0x3b40b9[_0x3c1f85(0x20e)](),_0xa2982d=await master_shop[_0x3c1f85(0x1c5)](),_0x3446a4=await email_settings[_0x3c1f85(0x1fe)](),_0x2869cd=await supervisor_settings[_0x3c1f85(0x1c5)]();var _0x4535a1=_0x3b40b9[_0x3c1f85(0x160)],_0x43e81b='',_0x3c4163;for(_0x3c4163 in _0x4535a1){_0x43e81b+=_0x3c1f85(0x1c7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4535a1[_0x3c4163]['product_name']+_0x3c1f85(0x161)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4535a1[_0x3c4163][_0x3c1f85(0x16a)]+_0x3c1f85(0x161)+_0x3c1f85(0x182)+_0x4535a1[_0x3c4163][_0x3c1f85(0x207)]+_0x3c1f85(0x161)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4535a1[_0x3c4163]['unit']+_0x3c1f85(0x161)+_0x3c1f85(0x182)+_0x4535a1[_0x3c4163][_0x3c1f85(0x171)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3b40b9[_0x3c1f85(0x223)]+_0x3c1f85(0x161)+_0x3c1f85(0x182)+_0x4535a1[_0x3c4163][_0x3c1f85(0x21e)]+_0x3c1f85(0x161)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4535a1[_0x3c4163][_0x3c1f85(0x222)]+_0x4535a1[_0x3c4163]['rack']+_0x4535a1[_0x3c4163]['bay']+_0x4535a1[_0x3c4163][_0x3c1f85(0x1e7)]+_0x4535a1[_0x3c4163][_0x3c1f85(0x1eb)][0x0]+_0x4535a1[_0x3c4163]['floorlevel']+_0x3c1f85(0x161),_0x3c1f85(0x220);}let _0xd3a1e3=nodemailer[_0x3c1f85(0x1ba)]({'host':_0x3446a4[_0x3c1f85(0x214)],'port':Number(_0x3446a4[_0x3c1f85(0x174)]),'secure':![],'auth':{'user':_0x3446a4['email'],'pass':_0x3446a4[_0x3c1f85(0x18b)]}}),_0x4d4fd9={'from':_0x3446a4[_0x3c1f85(0x15f)],'to':_0x2869cd[0x0]['RMSEmail'],'subject':_0x3c1f85(0x1a9),'attachments':[{'filename':_0x3c1f85(0x204),'path':__dirname+_0x3c1f85(0x1e5)+_0x3c1f85(0x1a5)+_0xa2982d[0x0][_0x3c1f85(0x1c4)],'cid':_0x3c1f85(0x21f)}],'html':_0x3c1f85(0x1d7)+_0x3c1f85(0x166)+'</head><body>'+_0x3c1f85(0x149)+_0x3c1f85(0x15e)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x3c1f85(0x149)+_0x3c1f85(0x1de)+_0xa2982d[0x0][_0x3c1f85(0x176)]+_0x3c1f85(0x14f)+_0x3c1f85(0x1e4)+_0x3c1f85(0x1e4)+'<hr\x20class=\x22my-3\x22>'+_0x3c1f85(0x149)+_0x3c1f85(0x192)+_0x3c1f85(0x1ce)+_0x3b40b9[_0x3c1f85(0x154)]+'\x20'+_0x3c1f85(0x1e8)+'\x20Order\x20Date\x20:\x20'+_0x3b40b9[_0x3c1f85(0x14e)]+'\x20'+'</span>'+_0x3c1f85(0x1d5)+_0x3c1f85(0x1e4)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3c1f85(0x1c7)+_0x3c1f85(0x1cc)+_0x3c1f85(0x19b)+_0x3c1f85(0x1d0)+_0x3c1f85(0x1f1)+_0x3c1f85(0x185)+_0x3c1f85(0x1d3)+_0x3c1f85(0x21c)+_0x3c1f85(0x16f)+_0x3c1f85(0x220)+_0x3c1f85(0x17b)+_0x3c1f85(0x1c3)+'\x20'+_0x43e81b+'\x20'+_0x3c1f85(0x1cf)+_0x3c1f85(0x1b1)+_0x3c1f85(0x149)+'<strong>\x20Regards\x20</strong>'+_0x3c1f85(0x157)+_0xa2982d[0x0][_0x3c1f85(0x176)]+'</h5>'+_0x3c1f85(0x1e4)+'</div>'+'</body></html>'};_0xd3a1e3[_0x3c1f85(0x14d)](_0x4d4fd9,function(_0x286a3b,_0x31048c){var _0x492174=_0x3c1f85;_0x286a3b?(console['log'](_0x286a3b),console[_0x492174(0x19c)](_0x492174(0x1a0))):console[_0x492174(0x19c)]('Email\x20sent\x20successfully');}),_0x2f1180[_0x3c1f85(0x217)](_0x3c1f85(0x1c8),'adjustment\x20Finalized\x20successfully'),_0x32a98d[_0x3c1f85(0x1ae)](_0x3c1f85(0x1f9)+_0xb9bd33['_id']);}catch(_0x4ec470){console['error'](_0x4ec470),_0x32a98d[_0x3c1f85(0x14b)](0x1f4)['json']({'error':_0x3c1f85(0x15c)});}})[_0xc94af2(0x1fa)](_0x427778=>{var _0x3db172=_0xc94af2;console[_0x3db172(0x1fc)](_0x427778),_0x32a98d['status'](0x1f4)[_0x3db172(0x1b9)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3b3a71){console['log'](_0x3b3a71),_0x32a98d[_0xc94af2(0x14b)](0xc8)[_0xc94af2(0x1b9)]({'message':_0x3b3a71['message']});}}),router[a0_0x275e12(0x1af)](a0_0x275e12(0x1f2),auth,async(_0x4562a4,_0x477d29)=>{var _0x260e3a=a0_0x275e12;try{const {username:_0x42d769,email:_0x34e418,role:_0xaea2a3}=_0x4562a4[_0x260e3a(0x225)],_0x49334e=_0x4562a4[_0x260e3a(0x225)],_0x13ac94=await profile['findOne']({'email':_0x49334e[_0x260e3a(0x15f)]}),_0x3aa0c9=await master_shop[_0x260e3a(0x1c5)](),_0x2d1252=_0x4562a4[_0x260e3a(0x1c6)]['id'],_0x1ffc29=await adjustment[_0x260e3a(0x203)]({'_id':_0x2d1252}),_0xeb81bd=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1ffc29[_0x260e3a(0x223)]}},{'$unwind':_0x260e3a(0x1ef)},{'$group':{'_id':_0x260e3a(0x1d4)}}]),_0x2500f4=await product[_0x260e3a(0x1c5)]({}),_0x2c616d=await warehouse[_0x260e3a(0x151)]([{'$match':{'name':_0x1ffc29[_0x260e3a(0x223)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x260e3a(0x1b5),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x260e3a(0x1d2)},'bay':{'$first':_0x260e3a(0x153)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x260e3a(0x195)},'primary_code':{'$first':_0x260e3a(0x15a)},'secondary_code':{'$first':_0x260e3a(0x206)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x260e3a(0x1a4)},'maxPerUnit':{'$first':_0x260e3a(0x1fb)},'expiry_date':{'$first':_0x260e3a(0x156)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x260e3a(0x193)},'room':{'$first':_0x260e3a(0x209)}}}]);let _0x41c271;if(_0x49334e[_0x260e3a(0x183)]==_0x260e3a(0x215)){const _0x1c00b8=await staff[_0x260e3a(0x1fe)]({'email':_0x49334e['email']});_0x41c271=await warehouse[_0x260e3a(0x151)]([{'$match':{'status':_0x260e3a(0x198),'name':_0x1c00b8[_0x260e3a(0x165)],'warehouse_category':_0x260e3a(0x212),'name':{'$ne':_0x260e3a(0x211)}}},{'$group':{'_id':_0x260e3a(0x20c),'name':{'$first':_0x260e3a(0x20c)}}}]);}else _0x41c271=await warehouse[_0x260e3a(0x151)]([{'$match':{'status':_0x260e3a(0x198),'warehouse_category':_0x260e3a(0x212),'name':{'$ne':_0x260e3a(0x211)}}},{'$group':{'_id':'$name','name':{'$first':_0x260e3a(0x20c)}}}]);if(_0x3aa0c9[0x0][_0x260e3a(0x178)]==_0x260e3a(0x226)){var _0x11d65a=users['English'];console[_0x260e3a(0x19c)](_0x11d65a);}else{if(_0x3aa0c9[0x0][_0x260e3a(0x178)]==_0x260e3a(0x18c))var _0x11d65a=users[_0x260e3a(0x18c)];else{if(_0x3aa0c9[0x0][_0x260e3a(0x178)]=='German')var _0x11d65a=users[_0x260e3a(0x187)];else{if(_0x3aa0c9[0x0][_0x260e3a(0x178)]==_0x260e3a(0x167))var _0x11d65a=users[_0x260e3a(0x167)];else{if(_0x3aa0c9[0x0]['language']==_0x260e3a(0x164))var _0x11d65a=users['French'];else{if(_0x3aa0c9[0x0]['language']=='Portuguese\x20(BR)')var _0x11d65a=users[_0x260e3a(0x172)];else{if(_0x3aa0c9[0x0][_0x260e3a(0x178)]=='Chinese')var _0x11d65a=users[_0x260e3a(0x188)];else{if(_0x3aa0c9[0x0][_0x260e3a(0x178)]==_0x260e3a(0x1a2))var _0x11d65a=users['Arabic'];}}}}}}}_0x477d29['render'](_0x260e3a(0x173),{'success':_0x4562a4[_0x260e3a(0x217)](_0x260e3a(0x1c8)),'errors':_0x4562a4[_0x260e3a(0x217)](_0x260e3a(0x170)),'role':_0x49334e,'profile':_0x13ac94,'adjustment':_0x1ffc29,'stock':_0x2c616d,'master_shop':_0x3aa0c9,'warehouse_name':_0xeb81bd,'unit':_0x2500f4,'language':_0x11d65a,'warehouse':_0x41c271});}catch(_0x872e42){console[_0x260e3a(0x19c)](_0x872e42),_0x477d29[_0x260e3a(0x14b)](0xc8)[_0x260e3a(0x1b9)]({'message':_0x872e42['message']});}}),router[a0_0x275e12(0x1aa)](a0_0x275e12(0x1f2),auth,async(_0x174335,_0x3a3990)=>{var _0x1936ff=a0_0x275e12;try{const _0x513b34=_0x174335[_0x1936ff(0x1c6)]['id'],_0x2c3833=await adjustment[_0x1936ff(0x203)]({'_id':_0x513b34}),_0x1b4098=await warehouse[_0x1936ff(0x1fe)]({'name':_0x2c3833[_0x1936ff(0x223)],'room':_0x2c3833[_0x1936ff(0x1f7)]}),{warehouse_name:_0xdf7b37,date:_0x2b6ba4,prod_name:_0x5749b3,level:_0x2a3c71,isle:_0x20a542,pallet:_0x3e2a1b,stock:_0xf68dab,types:_0x37528f,adjust_qty:_0xb773b8,new_adjust_qty:_0x59cbf5,note:_0x49ce8f,Room_name:_0x4b70e2,invoice:_0x3aa9dc,JO_number:_0x4c5f1c,expiry_date:_0x572c75}=_0x174335['body'];if(typeof _0x5749b3==_0x1936ff(0x1da))var _0x319d79=[_0x174335[_0x1936ff(0x17c)]['prod_name']],_0x4c1f86=[_0x174335['body'][_0x1936ff(0x155)]],_0x159fa6=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x1f8)]],_0x3d55ca=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x180)]],_0x6713a7=[_0x174335['body']['New_Qty_Converted_adj']],_0x42f5e3=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x224)]],_0x77ce12=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x20f)]],_0x10547b=[_0x174335['body'][_0x1936ff(0x1e6)]],_0x3411de=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x21d)]],_0x465fb4=[_0x174335['body'][_0x1936ff(0x197)]],_0x52b473=[_0x174335['body'][_0x1936ff(0x1e3)]],_0x3587aa=[_0x174335[_0x1936ff(0x17c)]['max_per_unit']],_0x3285ac=[_0x174335['body'][_0x1936ff(0x20b)]],_0x5cb8f4=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x14c)]],_0x1ea5e0=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x1ab)]],_0x4261d7=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x218)]],_0x60cd2f=[_0x174335[_0x1936ff(0x17c)][_0x1936ff(0x1cb)]];else var _0x319d79=[..._0x174335['body'][_0x1936ff(0x1c2)]],_0x4c1f86=[..._0x174335['body']['level']],_0x159fa6=[..._0x174335[_0x1936ff(0x17c)][_0x1936ff(0x1f8)]],_0x3d55ca=[..._0x174335[_0x1936ff(0x17c)]['types']],_0x6713a7=[..._0x174335[_0x1936ff(0x17c)][_0x1936ff(0x169)]],_0x42f5e3=[..._0x174335[_0x1936ff(0x17c)]['New_Qty_Converted']],_0x77ce12=[..._0x174335[_0x1936ff(0x17c)]['unit']],_0x10547b=[..._0x174335[_0x1936ff(0x17c)][_0x1936ff(0x1e6)]],_0x3411de=[..._0x174335[_0x1936ff(0x17c)][_0x1936ff(0x21d)]],_0x465fb4=[..._0x174335['body'][_0x1936ff(0x197)]],_0x52b473=[..._0x174335[_0x1936ff(0x17c)][_0x1936ff(0x1e3)]],_0x3587aa=[..._0x174335['body'][_0x1936ff(0x1be)]],_0x3285ac=[..._0x174335[_0x1936ff(0x17c)][_0x1936ff(0x20b)]],_0x5cb8f4=[..._0x174335[_0x1936ff(0x17c)][_0x1936ff(0x14c)]],_0x1ea5e0=[..._0x174335[_0x1936ff(0x17c)]['Rooms']],_0x4261d7=[..._0x174335['body']['prime1']],_0x60cd2f=[..._0x174335['body'][_0x1936ff(0x1cb)]];const _0x21f703=_0x319d79[_0x1936ff(0x159)](_0x3c7c68=>{return _0x3c7c68={'product_name':_0x3c7c68};});_0x4c1f86[_0x1936ff(0x1d9)]((_0x5b0558,_0x561ae7)=>{var _0x4dd6b1=_0x1936ff;_0x1ea5e0[_0x4dd6b1(0x1d9)]((_0x555aab,_0x1595d3)=>{var _0x2e1c0a=_0x4dd6b1;if(_0x555aab=='Receiving\x20Area'&&_0x561ae7==_0x1595d3){var _0xa67758=_0x5b0558[_0x2e1c0a(0x1d1)](0x3);_0x21f703[_0x561ae7][_0x2e1c0a(0x222)]=_0x5b0558[0x0],_0x21f703[_0x561ae7][_0x2e1c0a(0x219)]=_0x5b0558[0x1],_0x21f703[_0x561ae7][_0x2e1c0a(0x1dd)]=0x0,_0x21f703[_0x561ae7]['bin']=0x0,_0x21f703[_0x561ae7][_0x2e1c0a(0x1eb)]=_0x2e1c0a(0x20a),_0x21f703[_0x561ae7][_0x2e1c0a(0x1ee)]=_0xa67758;}else{if(_0x555aab=='Shelves'&&_0x561ae7==_0x1595d3){var _0xa67758=_0x5b0558[_0x2e1c0a(0x1d1)](0x3);_0x21f703[_0x561ae7]['storage']=_0x5b0558[0x0],_0x21f703[_0x561ae7]['rack']=_0x5b0558[0x1],_0x21f703[_0x561ae7][_0x2e1c0a(0x1dd)]=0x0,_0x21f703[_0x561ae7][_0x2e1c0a(0x1e7)]=0x0,_0x21f703[_0x561ae7][_0x2e1c0a(0x1eb)]=_0x2e1c0a(0x20a),_0x21f703[_0x561ae7][_0x2e1c0a(0x1ee)]=_0x5b0558[0x5];}else{if(_0x561ae7==_0x1595d3){var _0x2ec235;if(_0x5b0558[0x4]=='L')_0x2ec235=_0x2e1c0a(0x17e);else _0x5b0558[0x4]=='F'&&(_0x2ec235=_0x2e1c0a(0x20a));_0x21f703[_0x561ae7][_0x2e1c0a(0x222)]=_0x5b0558[0x0],_0x21f703[_0x561ae7]['rack']=_0x5b0558[0x1],_0x21f703[_0x561ae7][_0x2e1c0a(0x1dd)]=_0x5b0558[0x2],_0x21f703[_0x561ae7]['bin']=_0x5b0558[0x3],_0x21f703[_0x561ae7][_0x2e1c0a(0x1eb)]=_0x2ec235,_0x21f703[_0x561ae7][_0x2e1c0a(0x1ee)]=_0x5b0558[0x5];}}}});}),_0x159fa6[_0x1936ff(0x1d9)]((_0x4185bb,_0x341fbc)=>{_0x21f703[_0x341fbc]['stockBefore']=_0x4185bb;}),_0x3d55ca[_0x1936ff(0x1d9)]((_0x44d384,_0xa1a041)=>{var _0x55de63=_0x1936ff;_0x21f703[_0xa1a041][_0x55de63(0x180)]=_0x44d384;}),_0x6713a7['forEach']((_0x524226,_0x31e4d2)=>{var _0x4e2c87=_0x1936ff;_0x21f703[_0x31e4d2][_0x4e2c87(0x207)]=_0x524226;}),_0x42f5e3[_0x1936ff(0x1d9)]((_0x105144,_0x5dec32)=>{var _0x2844a0=_0x1936ff;_0x21f703[_0x5dec32][_0x2844a0(0x152)]=_0x105144;}),_0x77ce12[_0x1936ff(0x1d9)]((_0x1b22b9,_0x14d511)=>{var _0x5c3d4e=_0x1936ff;_0x21f703[_0x14d511][_0x5c3d4e(0x1f3)]=_0x1b22b9;}),_0x10547b[_0x1936ff(0x1d9)]((_0x208db6,_0x1e137d)=>{var _0x508e29=_0x1936ff;_0x21f703[_0x1e137d][_0x508e29(0x171)]=_0x208db6;}),_0x3411de[_0x1936ff(0x1d9)]((_0x1a1ffc,_0x92a7a0)=>{var _0x1a7c41=_0x1936ff;_0x21f703[_0x92a7a0][_0x1a7c41(0x16a)]=_0x1a1ffc;}),_0x465fb4[_0x1936ff(0x1d9)]((_0x566742,_0x419259)=>{var _0x5c8627=_0x1936ff;_0x21f703[_0x419259][_0x5c8627(0x197)]=_0x566742;}),_0x52b473[_0x1936ff(0x1d9)]((_0x145fa9,_0x4a657d)=>{var _0x2265ae=_0x1936ff;_0x21f703[_0x4a657d][_0x2265ae(0x1e3)]=_0x145fa9;}),_0x3587aa[_0x1936ff(0x1d9)]((_0x1a438a,_0x496aa4)=>{_0x21f703[_0x496aa4]['maxperunit']=_0x1a438a;}),_0x3285ac[_0x1936ff(0x1d9)]((_0xf89e45,_0x4e33ee)=>{var _0x13936e=_0x1936ff;_0x21f703[_0x4e33ee][_0x13936e(0x20b)]=_0xf89e45;}),_0x5cb8f4[_0x1936ff(0x1d9)]((_0x3a6070,_0x2510c1)=>{var _0x3e2ef0=_0x1936ff;_0x21f703[_0x2510c1][_0x3e2ef0(0x14c)]=_0x3a6070;}),_0x1ea5e0[_0x1936ff(0x1d9)]((_0x341538,_0x425fa5)=>{var _0x1dd129=_0x1936ff;_0x21f703[_0x425fa5][_0x1dd129(0x21e)]=_0x341538;}),_0x4261d7['forEach']((_0x16d305,_0x217cfb)=>{var _0x55b482=_0x1936ff;_0x21f703[_0x217cfb][_0x55b482(0x16c)]=_0x16d305;}),_0x60cd2f[_0x1936ff(0x1d9)]((_0x49b358,_0x2017c2)=>{_0x21f703[_0x2017c2]['secondary_code']=_0x49b358;});const _0x1c2fae=_0x21f703[_0x1936ff(0x19e)](_0x5d2902=>_0x5d2902['adjust_qty']!=='0'&&_0x5d2902['adjust_qty']!=='');var _0x363aea=0x0;_0x1c2fae[_0x1936ff(0x1d9)](_0x3a1629=>{var _0x46bd47=_0x1936ff;console[_0x46bd47(0x19c)]('foreach\x20newproduct',_0x3a1629),parseInt(_0x3a1629[_0x46bd47(0x207)])<=0x0&&_0x363aea++;});if(_0x363aea!=0x0)return _0x174335[_0x1936ff(0x217)]('errors',_0x1936ff(0x199)),_0x3a3990[_0x1936ff(0x1ae)](_0x1936ff(0x189));_0x2c3833[_0x1936ff(0x223)]=_0xdf7b37,_0x2c3833['date']=_0x2b6ba4,_0x2c3833[_0x1936ff(0x160)]=_0x1c2fae,_0x2c3833[_0x1936ff(0x201)]=_0x49ce8f,_0x2c3833[_0x1936ff(0x154)]=_0x3aa9dc,_0x2c3833[_0x1936ff(0x1f4)]=_0x1936ff(0x200);const _0x246d88=await _0x2c3833[_0x1936ff(0x20e)]();_0x174335[_0x1936ff(0x217)]('success',_0x1936ff(0x1c0)),_0x3a3990[_0x1936ff(0x1ae)](_0x1936ff(0x1ac));}catch(_0x8fc167){console['log'](_0x8fc167);}}),router[a0_0x275e12(0x1aa)](a0_0x275e12(0x1d8),async(_0x430d62,_0x8e7250)=>{var _0x292fc3=a0_0x275e12;const {primary_code:_0x2b15b3,warehouse_data:_0x460446,rooms_data:_0x1f3485,Roomslist:_0x58e53a}=_0x430d62['body'],_0x78c450=_0x58e53a['split'](','),_0xc55035=[];async function _0x463cea(_0xf938b6){var _0x589d97=a0_0x2f4c;const _0x5f2461=await warehouse[_0x589d97(0x151)]([{'$match':{'name':_0x460446,'room':_0xf938b6}},{'$unwind':_0x589d97(0x17a)},{'$match':{'product_details.primary_code':_0x2b15b3}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x589d97(0x15a)},'secondary_code':{'$first':_0x589d97(0x206)},'product_code':{'$first':_0x589d97(0x1a6)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x589d97(0x221)},'pallet':{'$first':_0x589d97(0x195)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x589d97(0x202)},'storage':{'$first':_0x589d97(0x208)},'rack':{'$first':_0x589d97(0x1a4)},'expiry_date':{'$first':_0x589d97(0x156)},'production_date':{'$first':_0x589d97(0x1ad)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x589d97(0x193)},'product_cat':{'$first':_0x589d97(0x1a8)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x589d97(0x209)},'invoice':{'$first':_0x589d97(0x213)}}}]),_0x3935af=await warehouse[_0x589d97(0x151)]([{'$match':{'name':_0x460446,'room':_0xf938b6}},{'$unwind':_0x589d97(0x17a)},{'$match':{'product_details.secondary_code':_0x2b15b3}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x589d97(0x1d2)},'primary_code':{'$first':_0x589d97(0x15a)},'secondary_code':{'$first':_0x589d97(0x206)},'product_code':{'$first':_0x589d97(0x1a6)},'level':{'$first':_0x589d97(0x153)},'isle':{'$first':_0x589d97(0x1ec)},'type':{'$first':_0x589d97(0x221)},'pallet':{'$first':_0x589d97(0x195)},'unit':{'$first':_0x589d97(0x1cd)},'secondary_unit':{'$first':_0x589d97(0x202)},'storage':{'$first':_0x589d97(0x208)},'rack':{'$first':_0x589d97(0x1a4)},'expiry_date':{'$first':_0x589d97(0x156)},'production_date':{'$first':_0x589d97(0x1ad)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x589d97(0x1a8)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x5f2461[_0x589d97(0x18e)]>0x0)_0xc55035['push'](_0x5f2461);else _0x3935af['length']>0x0&&_0xc55035[_0x589d97(0x158)](_0x3935af);}const _0x21c114=_0x78c450[_0x292fc3(0x159)](_0x32c711=>_0x463cea(_0x32c711));await Promise[_0x292fc3(0x19d)](_0x21c114),_0x8e7250[_0x292fc3(0x1b9)](_0xc55035);}),router['post'](a0_0x275e12(0x150),async(_0x1a41da,_0x199e8a)=>{var _0x30fc2c=a0_0x275e12;const {primaryCode:_0x308e15,secondaryCode:_0x136788,productCode:_0x1405c5,level:_0x9a3014,isle:_0xdcf108,pallet:_0x472854,warehouses:_0x322261,room:_0x1c7006}=_0x1a41da[_0x30fc2c(0x17c)];try{const _0x50d14d=await warehouse[_0x30fc2c(0x151)]([{'$match':{'name':_0x322261,'room':_0x1c7006}},{'$unwind':_0x30fc2c(0x17a)},{'$match':{'product_details.level':parseInt(_0x9a3014),'product_details.isle':_0xdcf108,'product_details.pallet':parseInt(_0x472854)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x30fc2c(0x210)},'product_stock':{'$first':_0x30fc2c(0x1d2)},'level':{'$first':_0x30fc2c(0x186)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x30fc2c(0x1e2)},'maxProducts':{'$first':_0x30fc2c(0x1b8)}}}]);_0x199e8a[_0x30fc2c(0x14b)](0xc8)['json'](_0x50d14d);}catch(_0x38f714){_0x199e8a[_0x30fc2c(0x14b)](0x194)[_0x30fc2c(0x1b9)]({'message':_0x38f714[_0x30fc2c(0x1d6)]});}}),module['exports']=router;