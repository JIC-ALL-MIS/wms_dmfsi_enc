var a0_0x5ba8f6=a0_0x46f2;function a0_0x46f2(_0x36a6af,_0x3f98ba){var _0x2f412a=a0_0x2f41();return a0_0x46f2=function(_0x46f2f2,_0xd3323){_0x46f2f2=_0x46f2f2-0x191;var _0x569ba9=_0x2f412a[_0x46f2f2];return _0x569ba9;},a0_0x46f2(_0x36a6af,_0x3f98ba);}(function(_0x14c93c,_0x376919){var _0x20c754=a0_0x46f2,_0x5049c9=_0x14c93c();while(!![]){try{var _0x17b489=parseInt(_0x20c754(0x1d8))/0x1*(parseInt(_0x20c754(0x19e))/0x2)+parseInt(_0x20c754(0x20a))/0x3+-parseInt(_0x20c754(0x196))/0x4+parseInt(_0x20c754(0x233))/0x5*(-parseInt(_0x20c754(0x1d1))/0x6)+-parseInt(_0x20c754(0x1ff))/0x7+-parseInt(_0x20c754(0x19d))/0x8*(parseInt(_0x20c754(0x193))/0x9)+parseInt(_0x20c754(0x1cf))/0xa;if(_0x17b489===_0x376919)break;else _0x5049c9['push'](_0x5049c9['shift']());}catch(_0x105a87){_0x5049c9['push'](_0x5049c9['shift']());}}}(a0_0x2f41,0xbca05));function a0_0x2f41(){var _0x1736b3=['$invoice','prod_cat','<h2>\x20','$product_details.maxPerUnit','/upload/','Adjustment\x20Mail','render','user','$product_details.isle','message','$product_details.level','room_names','date','/view','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Enclosed','27154160xaNwMW','$product_details.product_name','66rtPdvw','save','Return\x20Goods','Portuguese\x20(BR)','invoice','stockBefore','$name','1yTPjpD','flash','staff','An\x20error\x20occurred.','$product_details.batch_code','Floor','RMSEmail','prod_name','adjust_qty','product_stock','floorlevel','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','finalize','slice','string','rack','warehouse_name','/barcode_scanner','$product_details.type','find','adjustment\x20add\x20successfull','unit','<html><head><title></title>','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<span\x20style=\x22float:\x20right;\x22>','Arabic','prod_invoice','/../public','$product_details._id','$product_details.maxProducts','$product.product_name','</head><body>','Level','random','email','secondary_unit','Arabic\x20(ae)','3330089ruUwoR','../public/language/languages.json','secondary_code','floor','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','type','$room','length','note','exports','$product_details.bin','4579149ewAHFg','$date','$product_details.rack','image','$product_details.storage','split','express','sendMail','Raw\x20Materials','French','$product_details.bay','There\x27s\x20a\x20error\x20in\x20this\x20transaction','log','/adjustment/view','</thead>','forEach','findOne','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view/:id','Secondary_units','$product_details.floorlevel','room','max_per_unit','New_Qty_Converted_adj','English','Shelves','$product_details','body','json','</tr>','<div>','map','new_adjust_qty','batch_code','level','Error\x20Occurs','$product_details.product_stock','master','warehouse','adjustment','errors','597105MuvAQv','redirect','<tr>','/preview/:id','push','status','$finalize','/view/add_adjustment','then','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','filter','port','catch','aggregate','toString','foreach\x20newproduct','site_title','product_code','$_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.production_date','$product','\x20Order\x20Number\x20:\x20','createTransport','prod_code','False','../middleware/auth','expiry_date','role','../models/all_models','ADJ-','types','bin','post','</h5>','\x20<>\x20','_id','True','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.secondary_code','findById','stock','Return\x20Rooms','error','/CheckingWarehouse','Rooms','\x20Order\x20Date\x20:\x20','Receiving\x20Area','success','second1','$isAllowEdit','storage','German','all','$product_details.secondary_unit','18UYgben','Portuguese','host','1927228klRGzB','product_details','$product_details.product_code','English\x20(US)','minus','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','5236496LXdPTa','222206qWGloR','Ambient','Spanish','language','An\x20error\x20occurred\x20while\x20saving\x20data.','password','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$warehouse_name','<tbody\x20style=\x22text-align:\x20center;\x22>','adjustment\x20data\x20update\x20successfully','prime1','$product_details.primary_code','Enabled','</span>','production_date','$product_details.pallet','<!DOCTYPE\x20html>','isAllowEdit','Email\x20sent\x20successfully','</td>','back','get','$product_details.expiry_date','New_Qty_Converted','primary_code','$product_details.product_cat','Hindi','params','Chinese','Primary_Units','$product_details.unit','\x20</h2>','bay'];a0_0x2f41=function(){return _0x1736b3;};return a0_0x2f41();}const express=require(a0_0x5ba8f6(0x210)),app=express(),router=express['Router'](),auth=require(a0_0x5ba8f6(0x24d)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x5ba8f6(0x250)),users=require(a0_0x5ba8f6(0x200)),nodemailer=require('nodemailer');router['get'](a0_0x5ba8f6(0x1cc),auth,async(_0x7ca1af,_0x315ace)=>{var _0x2b6106=a0_0x5ba8f6;try{const {username:_0x4f6e0c,email:_0x47b10f,role:_0x55759f}=_0x7ca1af[_0x2b6106(0x1c6)],_0x2f9705=_0x7ca1af['user'],_0x1433fa=await profile[_0x2b6106(0x21a)]({'email':_0x2f9705[_0x2b6106(0x1fc)]}),_0x414834=await master_shop[_0x2b6106(0x1ec)]();console[_0x2b6106(0x216)](_0x2b6106(0x22f),_0x414834);let _0x7ac37c;if(_0x2f9705[_0x2b6106(0x24f)]==_0x2b6106(0x1da)){const _0xf12a7e=await staff[_0x2b6106(0x21a)]({'email':_0x2f9705[_0x2b6106(0x1fc)]});_0x7ac37c=await warehouse[_0x2b6106(0x1ec)]({'status':'Enabled','name':_0xf12a7e[_0x2b6106(0x230)]});}else _0x7ac37c=await warehouse[_0x2b6106(0x1ec)]({'status':_0x2b6106(0x1aa)});const _0x3aebc9=await product[_0x2b6106(0x1ec)]();let _0x94d8a9;if(_0x2f9705['role']=='staff'){const _0x268282=await staff[_0x2b6106(0x21a)]({'email':_0x2f9705['email']});_0x94d8a9=await adjustment[_0x2b6106(0x1ec)]({'warehouse_name':_0x268282[_0x2b6106(0x230)]});}else _0x94d8a9=await adjustment[_0x2b6106(0x240)]([{'$unwind':_0x2b6106(0x248)},{'$group':{'_id':_0x2b6106(0x245),'invoice':{'$first':_0x2b6106(0x1bf)},'date':{'$first':_0x2b6106(0x20b)},'warehouse_name':{'$first':_0x2b6106(0x1a5)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x2b6106(0x239)},'isAllowEdit':{'$first':_0x2b6106(0x265)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x414834[0x0]['language']==_0x2b6106(0x199)){var _0x595ef5=users['English'];console['log'](_0x595ef5);}else{if(_0x414834[0x0][_0x2b6106(0x1a1)]==_0x2b6106(0x1b8))var _0x595ef5=users['Hindi'];else{if(_0x414834[0x0][_0x2b6106(0x1a1)]==_0x2b6106(0x267))var _0x595ef5=users[_0x2b6106(0x267)];else{if(_0x414834[0x0][_0x2b6106(0x1a1)]=='Spanish')var _0x595ef5=users[_0x2b6106(0x1a0)];else{if(_0x414834[0x0][_0x2b6106(0x1a1)]==_0x2b6106(0x213))var _0x595ef5=users[_0x2b6106(0x213)];else{if(_0x414834[0x0]['language']=='Portuguese\x20(BR)')var _0x595ef5=users[_0x2b6106(0x194)];else{if(_0x414834[0x0][_0x2b6106(0x1a1)]==_0x2b6106(0x1ba))var _0x595ef5=users[_0x2b6106(0x1ba)];else{if(_0x414834[0x0][_0x2b6106(0x1a1)]==_0x2b6106(0x1fe))var _0x595ef5=users[_0x2b6106(0x1f3)];}}}}}}}_0x315ace[_0x2b6106(0x1c5)](_0x2b6106(0x231),{'success':_0x7ca1af[_0x2b6106(0x1d9)](_0x2b6106(0x263)),'errors':_0x7ca1af['flash']('errors'),'role':_0x2f9705,'profile':_0x1433fa,'warehouse':_0x7ac37c,'product':_0x3aebc9,'adjustment':_0x94d8a9,'master_shop':_0x414834,'language':_0x595ef5});}catch(_0x310ad3){console[_0x2b6106(0x216)](_0x310ad3);}});async function getRandom8DigitNumber(){var _0x4abfeb=a0_0x5ba8f6;const _0x31cd41=0x989680,_0x215662=0x5f5e0ff,_0x99ba0c=Math[_0x4abfeb(0x202)](Math[_0x4abfeb(0x1fb)]()*(_0x215662-_0x31cd41+0x1))+_0x31cd41;var _0x1bfeb6;const _0x18262a=await adjustment[_0x4abfeb(0x21a)]({'invoice':_0x4abfeb(0x251)+_0x99ba0c});return _0x18262a&&_0x18262a[_0x4abfeb(0x206)]>0x0?_0x1bfeb6=_0x4abfeb(0x251)+_0x99ba0c:_0x1bfeb6=_0x4abfeb(0x251)+_0x99ba0c,_0x1bfeb6;}router[a0_0x5ba8f6(0x1b3)](a0_0x5ba8f6(0x23a),auth,async(_0x344280,_0x1afb9f)=>{var _0x260c6e=a0_0x5ba8f6;try{const {username:_0x4fb7c4,email:_0x369efc,role:_0xe8525}=_0x344280[_0x260c6e(0x1c6)],_0x237efc=_0x344280['user'],_0x29f3ba=await profile[_0x260c6e(0x21a)]({'email':_0x237efc[_0x260c6e(0x1fc)]}),_0x37bf46=await master_shop['find']();let _0x31bb55;if(_0x237efc[_0x260c6e(0x24f)]==_0x260c6e(0x1da)){const _0x5e0ed1=await staff['findOne']({'email':_0x237efc[_0x260c6e(0x1fc)]});_0x31bb55=await warehouse[_0x260c6e(0x240)]([{'$match':{'status':_0x260c6e(0x1aa),'name':_0x5e0ed1[_0x260c6e(0x230)],'warehouse_category':_0x260c6e(0x212),'name':{'$ne':_0x260c6e(0x1d3)}}},{'$group':{'_id':'$name','name':{'$first':_0x260c6e(0x1d7)}}}]);}else _0x31bb55=await warehouse[_0x260c6e(0x240)]([{'$match':{'status':_0x260c6e(0x1aa),'warehouse_category':_0x260c6e(0x212),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x260c6e(0x1d7),'name':{'$first':_0x260c6e(0x1d7)}}}]);const _0x5a5349=await product[_0x260c6e(0x1ec)]({}),_0x2b671c=await adjustment[_0x260c6e(0x1ec)]({}),_0x1ea82e=_0x2b671c[_0x260c6e(0x206)]+0x1,_0x15a829=_0x260c6e(0x251)+_0x1ea82e[_0x260c6e(0x241)]()['padStart'](0x5,'0');var _0x59ac2d=[_0x260c6e(0x19f),_0x260c6e(0x1ce),_0x260c6e(0x25d)];if(_0x37bf46[0x0][_0x260c6e(0x1a1)]==_0x260c6e(0x199))var _0x12ddab=users[_0x260c6e(0x222)];else{if(_0x37bf46[0x0][_0x260c6e(0x1a1)]==_0x260c6e(0x1b8))var _0x12ddab=users['Hindi'];else{if(_0x37bf46[0x0][_0x260c6e(0x1a1)]=='German')var _0x12ddab=users['German'];else{if(_0x37bf46[0x0][_0x260c6e(0x1a1)]==_0x260c6e(0x1a0))var _0x12ddab=users['Spanish'];else{if(_0x37bf46[0x0]['language']==_0x260c6e(0x213))var _0x12ddab=users[_0x260c6e(0x213)];else{if(_0x37bf46[0x0][_0x260c6e(0x1a1)]=='Portuguese\x20(BR)')var _0x12ddab=users[_0x260c6e(0x194)];else{if(_0x37bf46[0x0][_0x260c6e(0x1a1)]=='Chinese')var _0x12ddab=users[_0x260c6e(0x1ba)];else{if(_0x37bf46[0x0][_0x260c6e(0x1a1)]==_0x260c6e(0x1fe))var _0x12ddab=users['Arabic'];}}}}}}}const _0x182ae5=getRandom8DigitNumber();_0x182ae5[_0x260c6e(0x23b)](_0x2f7ec7=>{var _0x2f4d7f=_0x260c6e;_0x1afb9f[_0x2f4d7f(0x1c5)]('add_adjustment',{'success':_0x344280[_0x2f4d7f(0x1d9)](_0x2f4d7f(0x263)),'errors':_0x344280[_0x2f4d7f(0x1d9)](_0x2f4d7f(0x232)),'role':_0x237efc,'profile':_0x29f3ba,'warehouse':_0x31bb55,'product':_0x5a5349,'master_shop':_0x37bf46,'language':_0x12ddab,'rooms_data':_0x59ac2d,'invoice_no':_0x2f7ec7});})['catch'](_0x147273=>{var _0x9368e0=_0x260c6e;_0x344280[_0x9368e0(0x1d9)]('errors',_0x9368e0(0x215)),_0x1afb9f[_0x9368e0(0x234)](_0x9368e0(0x217));});}catch(_0xf03107){console[_0x260c6e(0x216)](_0xf03107);}}),router['post'](a0_0x5ba8f6(0x23a),auth,async(_0x31dad8,_0x52110f)=>{var _0x11ba4c=a0_0x5ba8f6;try{const {warehouse_name:_0x45254c,date:_0x36a05e,prod_name:_0x42a768,level:_0x472831,isle:_0x5089d3,pallet:_0x23318c,stock:_0x4fab24,types:_0x4bf431,adjust_qty:_0x192a50,new_adjust_qty:_0x583be3,note:_0x3c1ed0,Room_name:_0x586f63,invoice:_0x4941bd,JO_number:_0xb18ad6,expiry_date:_0xa9444c}=_0x31dad8[_0x11ba4c(0x225)];if(typeof _0x42a768==_0x11ba4c(0x1e7))var _0x3cd9e7=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1df)]],_0x4f8b8f=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x22c)]],_0x53e1ee=[_0x31dad8['body']['stock']],_0x3a4e32=[_0x31dad8[_0x11ba4c(0x225)]['types']],_0x1ae8ab=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x221)]],_0x201a72=[_0x31dad8['body']['New_Qty_Converted']],_0x167a4f=[_0x31dad8['body'][_0x11ba4c(0x1bb)]],_0x544d8e=[_0x31dad8['body'][_0x11ba4c(0x21d)]],_0x1183e2=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x24b)]],_0x225df1=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x22b)]],_0x11269e=[_0x31dad8['body'][_0x11ba4c(0x24e)]],_0x42fcb4=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x220)]],_0xf5fbb9=[_0x31dad8['body'][_0x11ba4c(0x1ac)]],_0x35d87b=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1c0)]],_0x30c63f=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x260)]],_0x42e229=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1a8)]],_0x11f395=[_0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x264)]],_0x4e3b09=[_0x31dad8[_0x11ba4c(0x225)]['prod_invoice']];else var _0x3cd9e7=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1df)]],_0x4f8b8f=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x22c)]],_0x53e1ee=[..._0x31dad8[_0x11ba4c(0x225)]['stock']],_0x3a4e32=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x252)]],_0x1ae8ab=[..._0x31dad8[_0x11ba4c(0x225)]['New_Qty_Converted_adj']],_0x201a72=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1b5)]],_0x167a4f=[..._0x31dad8[_0x11ba4c(0x225)]['unit']],_0x544d8e=[..._0x31dad8['body'][_0x11ba4c(0x21d)]],_0x1183e2=[..._0x31dad8['body'][_0x11ba4c(0x24b)]],_0x225df1=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x22b)]],_0x11269e=[..._0x31dad8[_0x11ba4c(0x225)]['expiry_date']],_0x42fcb4=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x220)]],_0xf5fbb9=[..._0x31dad8['body'][_0x11ba4c(0x1ac)]],_0x35d87b=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1c0)]],_0x30c63f=[..._0x31dad8['body'][_0x11ba4c(0x260)]],_0x42e229=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1a8)]],_0x11f395=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x264)]],_0x4e3b09=[..._0x31dad8[_0x11ba4c(0x225)][_0x11ba4c(0x1f4)]];const _0x5bcbd8=_0x3cd9e7[_0x11ba4c(0x229)](_0xf3376a=>{return _0xf3376a={'product_name':_0xf3376a};});_0x4f8b8f[_0x11ba4c(0x219)]((_0x1bdc0c,_0x5697ee)=>{var _0x49541e=_0x11ba4c;_0x30c63f[_0x49541e(0x219)]((_0x4a8e6d,_0x48a079)=>{var _0x4d75e2=_0x49541e;if(_0x4a8e6d==_0x4d75e2(0x262)&&_0x5697ee==_0x48a079){var _0x33d628=_0x1bdc0c[_0x4d75e2(0x1e6)](0x3);_0x5bcbd8[_0x5697ee][_0x4d75e2(0x266)]=_0x1bdc0c[0x0],_0x5bcbd8[_0x5697ee][_0x4d75e2(0x1e8)]=_0x1bdc0c[0x1],_0x5bcbd8[_0x5697ee][_0x4d75e2(0x1be)]=0x0,_0x5bcbd8[_0x5697ee][_0x4d75e2(0x253)]=0x0,_0x5bcbd8[_0x5697ee][_0x4d75e2(0x204)]=_0x4d75e2(0x1dd),_0x5bcbd8[_0x5697ee]['floorlevel']=_0x33d628;}else{if(_0x4a8e6d=='Shelves'&&_0x5697ee==_0x48a079){var _0x33d628=_0x1bdc0c[_0x4d75e2(0x1e6)](0x3);_0x5bcbd8[_0x5697ee][_0x4d75e2(0x266)]=_0x1bdc0c[0x0],_0x5bcbd8[_0x5697ee][_0x4d75e2(0x1e8)]=_0x1bdc0c[0x1],_0x5bcbd8[_0x5697ee]['bay']=0x0,_0x5bcbd8[_0x5697ee]['bin']=0x0,_0x5bcbd8[_0x5697ee][_0x4d75e2(0x204)]=_0x4d75e2(0x1dd),_0x5bcbd8[_0x5697ee]['floorlevel']=_0x1bdc0c[0x5];}else{if(_0x5697ee==_0x48a079){var _0x42ac59;if(_0x1bdc0c[0x4]=='L')_0x42ac59=_0x4d75e2(0x1fa);else _0x1bdc0c[0x4]=='F'&&(_0x42ac59=_0x4d75e2(0x1dd));_0x5bcbd8[_0x5697ee][_0x4d75e2(0x266)]=_0x1bdc0c[0x0],_0x5bcbd8[_0x5697ee]['rack']=_0x1bdc0c[0x1],_0x5bcbd8[_0x5697ee]['bay']=_0x1bdc0c[0x2],_0x5bcbd8[_0x5697ee][_0x4d75e2(0x253)]=_0x1bdc0c[0x3],_0x5bcbd8[_0x5697ee][_0x4d75e2(0x204)]=_0x42ac59,_0x5bcbd8[_0x5697ee]['floorlevel']=_0x1bdc0c[0x5];}}}});}),_0x53e1ee[_0x11ba4c(0x219)]((_0x46a804,_0x464a9c)=>{var _0x137033=_0x11ba4c;_0x5bcbd8[_0x464a9c][_0x137033(0x1d6)]=_0x46a804;}),_0x3a4e32['forEach']((_0x1e4d33,_0x1e309a)=>{var _0x229fab=_0x11ba4c;_0x5bcbd8[_0x1e309a][_0x229fab(0x252)]=_0x1e4d33;}),_0x1ae8ab[_0x11ba4c(0x219)]((_0x5d40b3,_0x45f572)=>{var _0x9de3f=_0x11ba4c;_0x5bcbd8[_0x45f572][_0x9de3f(0x1e0)]=_0x5d40b3;}),_0x201a72[_0x11ba4c(0x219)]((_0x351ee9,_0x356d16)=>{_0x5bcbd8[_0x356d16]['new_adjust_qty']=_0x351ee9;}),_0x167a4f['forEach']((_0x4a0f93,_0x46bb41)=>{_0x5bcbd8[_0x46bb41]['unit']=_0x4a0f93;}),_0x544d8e[_0x11ba4c(0x219)]((_0x331a2a,_0x4f37ad)=>{_0x5bcbd8[_0x4f37ad]['secondary_unit']=_0x331a2a;}),_0x1183e2['forEach']((_0x1f6679,_0x40a0b2)=>{_0x5bcbd8[_0x40a0b2]['product_code']=_0x1f6679;}),_0x225df1[_0x11ba4c(0x219)]((_0x59cd38,_0x3237eb)=>{var _0x1f1fb9=_0x11ba4c;_0x5bcbd8[_0x3237eb][_0x1f1fb9(0x22b)]=_0x59cd38;}),_0x11269e[_0x11ba4c(0x219)]((_0x34bbb6,_0x469514)=>{var _0x33ebc4=_0x11ba4c;_0x5bcbd8[_0x469514][_0x33ebc4(0x24e)]=_0x34bbb6;}),_0x42fcb4[_0x11ba4c(0x219)]((_0x38123d,_0x2f2c81)=>{_0x5bcbd8[_0x2f2c81]['maxperunit']=_0x38123d;}),_0xf5fbb9[_0x11ba4c(0x219)]((_0x506e0d,_0x1ee197)=>{var _0x2e72fa=_0x11ba4c;_0x5bcbd8[_0x1ee197][_0x2e72fa(0x1ac)]=_0x506e0d;}),_0x35d87b[_0x11ba4c(0x219)]((_0x1bd115,_0x3678fa)=>{var _0x1ea3c1=_0x11ba4c;_0x5bcbd8[_0x3678fa][_0x1ea3c1(0x1c0)]=_0x1bd115;}),_0x30c63f['forEach']((_0x1bec74,_0x523760)=>{_0x5bcbd8[_0x523760]['room_names']=_0x1bec74;}),_0x42e229[_0x11ba4c(0x219)]((_0x472952,_0x315ee3)=>{var _0x36b61e=_0x11ba4c;_0x5bcbd8[_0x315ee3][_0x36b61e(0x1b6)]=_0x472952;}),_0x11f395[_0x11ba4c(0x219)]((_0x1aaf68,_0x3d16cc)=>{_0x5bcbd8[_0x3d16cc]['secondary_code']=_0x1aaf68;}),_0x4e3b09['forEach']((_0x1387f0,_0x29235d)=>{var _0x161ee5=_0x11ba4c;_0x5bcbd8[_0x29235d][_0x161ee5(0x1d5)]=_0x1387f0;});const _0x57cdf0=_0x5bcbd8['filter'](_0x565773=>_0x565773[_0x11ba4c(0x1e0)]!=='0'&&_0x565773[_0x11ba4c(0x1e0)]!=='');var _0xad973c=0x0;_0x57cdf0[_0x11ba4c(0x219)](_0x7c19b4=>{var _0x4f84bb=_0x11ba4c;console[_0x4f84bb(0x216)](_0x4f84bb(0x242),_0x7c19b4),parseInt(_0x7c19b4['adjust_qty'])<=0x0&&_0xad973c++;});if(_0xad973c!=0x0)return _0x31dad8[_0x11ba4c(0x1d9)](_0x11ba4c(0x232),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x52110f[_0x11ba4c(0x234)](_0x11ba4c(0x1b2));const _0x486f2b=new adjustment({'warehouse_name':_0x45254c,'date':_0x36a05e,'product':_0x57cdf0,'note':_0x3c1ed0,'room':_0x586f63,'invoice':_0x4941bd,'JO_number':_0xb18ad6,'expiry_date':_0xa9444c}),_0x238463=await _0x486f2b[_0x11ba4c(0x1d2)]();_0x31dad8[_0x11ba4c(0x1d9)](_0x11ba4c(0x263),_0x11ba4c(0x1ed)),_0x52110f[_0x11ba4c(0x234)]('/adjustment/preview/'+_0x238463[_0x11ba4c(0x257)]);}catch(_0x3bf4a8){console[_0x11ba4c(0x216)](_0x3bf4a8),_0x52110f[_0x11ba4c(0x238)](0xc8)[_0x11ba4c(0x226)]({'message':_0x3bf4a8[_0x11ba4c(0x1c8)]});}}),router[a0_0x5ba8f6(0x1b3)](a0_0x5ba8f6(0x236),auth,async(_0x10a226,_0x46881a)=>{var _0x49f1bf=a0_0x5ba8f6;try{const {username:_0x46c00c,email:_0x593d74,role:_0x5c371e}=_0x10a226[_0x49f1bf(0x1c6)],_0x3adc77=_0x10a226[_0x49f1bf(0x1c6)],_0x4f09aa=await profile[_0x49f1bf(0x21a)]({'email':_0x3adc77[_0x49f1bf(0x1fc)]}),_0x18ded6=await master_shop[_0x49f1bf(0x1ec)](),_0x24ccd9=_0x10a226['params']['id'],_0x4d57eb=await adjustment[_0x49f1bf(0x25b)]({'_id':_0x24ccd9}),_0x564a83=await purchases[_0x49f1bf(0x240)]([{'$match':{'warehouse_name':_0x4d57eb['warehouse_name']}},{'$unwind':_0x49f1bf(0x248)},{'$group':{'_id':_0x49f1bf(0x1f8)}}]),_0x5c7508=await product[_0x49f1bf(0x1ec)]({}),_0x3dad47=await warehouse[_0x49f1bf(0x240)]([{'$match':{'name':_0x4d57eb['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x49f1bf(0x1d0)},'product_stock':{'$first':_0x49f1bf(0x22e)},'bay':{'$first':_0x49f1bf(0x214)},'bin':{'$first':_0x49f1bf(0x209)},'type':{'$first':_0x49f1bf(0x1eb)},'floorlevel':{'$first':_0x49f1bf(0x21e)},'primary_code':{'$first':_0x49f1bf(0x1a9)},'secondary_code':{'$first':_0x49f1bf(0x25a)},'product_code':{'$first':_0x49f1bf(0x198)},'storage':{'$first':_0x49f1bf(0x20e)},'rack':{'$first':_0x49f1bf(0x20c)},'maxPerUnit':{'$first':_0x49f1bf(0x1c2)},'expiry_date':{'$first':_0x49f1bf(0x1b4)},'production_date':{'$first':_0x49f1bf(0x247)},'batch_code':{'$first':_0x49f1bf(0x1dc)},'room':{'$first':'$room'}}}]);if(_0x18ded6[0x0]['language']=='English\x20(US)'){var _0xf2d071=users[_0x49f1bf(0x222)];console[_0x49f1bf(0x216)](_0xf2d071);}else{if(_0x18ded6[0x0][_0x49f1bf(0x1a1)]=='Hindi')var _0xf2d071=users[_0x49f1bf(0x1b8)];else{if(_0x18ded6[0x0][_0x49f1bf(0x1a1)]==_0x49f1bf(0x267))var _0xf2d071=users[_0x49f1bf(0x267)];else{if(_0x18ded6[0x0][_0x49f1bf(0x1a1)]==_0x49f1bf(0x1a0))var _0xf2d071=users[_0x49f1bf(0x1a0)];else{if(_0x18ded6[0x0]['language']==_0x49f1bf(0x213))var _0xf2d071=users[_0x49f1bf(0x213)];else{if(_0x18ded6[0x0]['language']=='Portuguese\x20(BR)')var _0xf2d071=users[_0x49f1bf(0x194)];else{if(_0x18ded6[0x0][_0x49f1bf(0x1a1)]==_0x49f1bf(0x1ba))var _0xf2d071=users[_0x49f1bf(0x1ba)];else{if(_0x18ded6[0x0][_0x49f1bf(0x1a1)]==_0x49f1bf(0x1fe))var _0xf2d071=users[_0x49f1bf(0x1f3)];}}}}}}}_0x46881a[_0x49f1bf(0x1c5)]('edit_adjustment_view',{'success':_0x10a226['flash'](_0x49f1bf(0x263)),'errors':_0x10a226[_0x49f1bf(0x1d9)](_0x49f1bf(0x232)),'role':_0x3adc77,'profile':_0x4f09aa,'adjustment':_0x4d57eb,'stock':_0x3dad47,'master_shop':_0x18ded6,'warehouse_name':_0x564a83,'unit':_0x5c7508,'language':_0xf2d071});}catch(_0x5c1471){console[_0x49f1bf(0x216)](_0x5c1471),_0x46881a[_0x49f1bf(0x238)](0xc8)['json']({'message':_0x5c1471[_0x49f1bf(0x1c8)]});}}),router['post'](a0_0x5ba8f6(0x236),auth,async(_0x49fe38,_0xe62988)=>{var _0x4ac453=a0_0x5ba8f6;try{const _0x502ab2=_0x49fe38['params']['id'],{warehouse_name:_0x4f9cb9,Room_name:_0x324fe9}=_0x49fe38[_0x4ac453(0x225)],_0x359e9d=await adjustment[_0x4ac453(0x25b)]({'_id':_0x502ab2}),_0x3a9f22=_0x359e9d[_0x4ac453(0x19b)][_0x4ac453(0x229)](async _0x53881f=>{var _0x81b632=_0x4ac453;if(_0x53881f[_0x81b632(0x1e0)]>0x0){var _0x2b1034=await warehouse[_0x81b632(0x21a)]({'name':_0x4f9cb9,'room':_0x53881f[_0x81b632(0x1ca)],'warehouse_category':_0x81b632(0x212)});const _0x1a43b7=_0x2b1034[_0x81b632(0x197)]['map'](_0x5c69f1=>{var _0x21ecfc=_0x81b632;if(_0x53881f[_0x21ecfc(0x204)]==_0x21ecfc(0x19a)){if(_0x5c69f1[_0x21ecfc(0x1f0)]==_0x53881f['product_name']&&_0x5c69f1[_0x21ecfc(0x1e2)]==_0x53881f['floorlevel']&&_0x5c69f1[_0x21ecfc(0x204)]==_0x53881f[_0x21ecfc(0x204)]&&_0x5c69f1[_0x21ecfc(0x253)]==_0x53881f[_0x21ecfc(0x253)]&&_0x5c69f1[_0x21ecfc(0x1be)]==_0x53881f[_0x21ecfc(0x1be)]&&_0x5c69f1[_0x21ecfc(0x1e8)]==_0x53881f[_0x21ecfc(0x1e8)]&&_0x5c69f1[_0x21ecfc(0x266)]==_0x53881f['storage']&&_0x5c69f1[_0x21ecfc(0x24e)]==_0x53881f[_0x21ecfc(0x24e)]&&_0x5c69f1[_0x21ecfc(0x22b)]==_0x53881f[_0x21ecfc(0x22b)]&&_0x5c69f1[_0x21ecfc(0x1ac)]==_0x53881f[_0x21ecfc(0x1ac)]&&_0x5c69f1[_0x21ecfc(0x1d5)]==_0x53881f[_0x21ecfc(0x1d5)]){var _0x4c8884;_0x4c8884=_0x53881f['adjust_qty'],_0x53881f[_0x21ecfc(0x1c0)]=='S'&&(_0x4c8884=_0x53881f['adjust_qty']),_0x5c69f1['product_stock']=_0x5c69f1[_0x21ecfc(0x1e1)]-_0x4c8884;}}else{if(_0x5c69f1[_0x21ecfc(0x1f0)]==_0x53881f[_0x21ecfc(0x1f0)]&&_0x5c69f1[_0x21ecfc(0x1e2)]==_0x53881f[_0x21ecfc(0x1e2)]&&_0x5c69f1[_0x21ecfc(0x204)]==_0x53881f[_0x21ecfc(0x204)]&&_0x5c69f1['bin']==_0x53881f[_0x21ecfc(0x253)]&&_0x5c69f1[_0x21ecfc(0x1be)]==_0x53881f[_0x21ecfc(0x1be)]&&_0x5c69f1[_0x21ecfc(0x1e8)]==_0x53881f[_0x21ecfc(0x1e8)]&&_0x5c69f1['storage']==_0x53881f[_0x21ecfc(0x266)]&&_0x5c69f1[_0x21ecfc(0x24e)]==_0x53881f[_0x21ecfc(0x24e)]&&_0x5c69f1[_0x21ecfc(0x22b)]==_0x53881f[_0x21ecfc(0x22b)]&&_0x5c69f1['production_date']==_0x53881f[_0x21ecfc(0x1ac)]&&_0x5c69f1[_0x21ecfc(0x1d5)]==_0x53881f['invoice']){console['log'](_0x53881f);var _0x4c8884;_0x4c8884=_0x53881f[_0x21ecfc(0x1e0)],_0x53881f['prod_cat']=='S'&&(_0x4c8884=_0x53881f['adjust_qty']),console[_0x21ecfc(0x216)](_0x4c8884+_0x21ecfc(0x256)+_0x53881f[_0x21ecfc(0x1e0)]+_0x21ecfc(0x256)+_0x5c69f1['maxPerUnit']+_0x21ecfc(0x256)+_0x53881f[_0x21ecfc(0x1c0)]),_0x5c69f1[_0x21ecfc(0x1e1)]=_0x5c69f1[_0x21ecfc(0x1e1)]+_0x4c8884;}}});}return _0x2b1034;});Promise['all'](_0x3a9f22)[_0x4ac453(0x23b)](async _0x4b3c5b=>{var _0x3961c9=_0x4ac453;try{for(const _0x4bd51c of _0x4b3c5b){await _0x4bd51c[_0x3961c9(0x1d2)]();}_0x359e9d[_0x3961c9(0x1e5)]=_0x3961c9(0x258);const _0x5c9823=await _0x359e9d['save'](),_0x3c65f7=await master_shop['find'](),_0xc22f5c=await email_settings[_0x3961c9(0x21a)](),_0x5cd132=await supervisor_settings[_0x3961c9(0x1ec)]();var _0x3f245d=_0x359e9d[_0x3961c9(0x19b)],_0x5c8fab='',_0x551edb;for(_0x551edb in _0x3f245d){_0x5c8fab+=_0x3961c9(0x235)+_0x3961c9(0x1cd)+_0x3f245d[_0x551edb][_0x3961c9(0x1f0)]+'</td>'+_0x3961c9(0x1cd)+_0x3f245d[_0x551edb][_0x3961c9(0x244)]+_0x3961c9(0x1b1)+_0x3961c9(0x1cd)+_0x3f245d[_0x551edb][_0x3961c9(0x1e0)]+'</td>'+_0x3961c9(0x1cd)+_0x3f245d[_0x551edb][_0x3961c9(0x1ee)]+_0x3961c9(0x1b1)+_0x3961c9(0x1cd)+_0x3f245d[_0x551edb][_0x3961c9(0x1fd)]+'</td>'+_0x3961c9(0x1cd)+_0x359e9d[_0x3961c9(0x1e9)]+_0x3961c9(0x1b1)+_0x3961c9(0x1cd)+_0x3f245d[_0x551edb][_0x3961c9(0x1ca)]+_0x3961c9(0x1b1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f245d[_0x551edb]['storage']+_0x3f245d[_0x551edb][_0x3961c9(0x1e8)]+_0x3f245d[_0x551edb][_0x3961c9(0x1be)]+_0x3f245d[_0x551edb][_0x3961c9(0x253)]+_0x3f245d[_0x551edb][_0x3961c9(0x204)][0x0]+_0x3f245d[_0x551edb]['floorlevel']+_0x3961c9(0x1b1),_0x3961c9(0x227);}let _0x4ff0b3=nodemailer[_0x3961c9(0x24a)]({'host':_0xc22f5c[_0x3961c9(0x195)],'port':Number(_0xc22f5c[_0x3961c9(0x23e)]),'secure':![],'auth':{'user':_0xc22f5c[_0x3961c9(0x1fc)],'pass':_0xc22f5c[_0x3961c9(0x1a3)]}}),_0x1a48d1={'from':_0xc22f5c[_0x3961c9(0x1fc)],'to':_0x5cd132[0x0][_0x3961c9(0x1de)],'subject':_0x3961c9(0x1c4),'attachments':[{'filename':'Logo.png','path':__dirname+_0x3961c9(0x1f5)+_0x3961c9(0x1c3)+_0x3c65f7[0x0][_0x3961c9(0x20d)],'cid':'logo'}],'html':_0x3961c9(0x1ae)+_0x3961c9(0x1ef)+_0x3961c9(0x1f9)+_0x3961c9(0x228)+_0x3961c9(0x203)+_0x3961c9(0x228)+_0x3961c9(0x21b)+_0x3961c9(0x1e3)+_0x3961c9(0x228)+_0x3961c9(0x1c1)+_0x3c65f7[0x0][_0x3961c9(0x243)]+_0x3961c9(0x1bd)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x3961c9(0x228)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3961c9(0x249)+_0x359e9d['invoice']+'\x20'+_0x3961c9(0x1f2)+_0x3961c9(0x261)+_0x359e9d[_0x3961c9(0x1cb)]+'\x20'+_0x3961c9(0x1ab)+_0x3961c9(0x255)+_0x3961c9(0x1e3)+_0x3961c9(0x259)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3961c9(0x235)+_0x3961c9(0x19c)+_0x3961c9(0x1f1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x3961c9(0x246)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3961c9(0x23c)+_0x3961c9(0x1e4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x3961c9(0x227)+_0x3961c9(0x218)+_0x3961c9(0x1a6)+'\x20'+_0x5c8fab+'\x20'+'</tbody>'+'</table>'+_0x3961c9(0x228)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x3c65f7[0x0]['site_title']+_0x3961c9(0x255)+_0x3961c9(0x1e3)+_0x3961c9(0x1e3)+'</body></html>'};_0x4ff0b3[_0x3961c9(0x211)](_0x1a48d1,function(_0x48777f,_0x14c6d5){var _0x48310c=_0x3961c9;_0x48777f?(console[_0x48310c(0x216)](_0x48777f),console['log'](_0x48310c(0x22d))):console[_0x48310c(0x216)](_0x48310c(0x1b0));}),_0x49fe38[_0x3961c9(0x1d9)]('success','adjustment\x20Finalized\x20successfully'),_0xe62988[_0x3961c9(0x234)]('/picking_list/PDF_adjustment_rm/'+_0x5c9823[_0x3961c9(0x257)]);}catch(_0x2f70b8){console[_0x3961c9(0x25e)](_0x2f70b8),_0xe62988['status'](0x1f4)[_0x3961c9(0x226)]({'error':_0x3961c9(0x1a2)});}})[_0x4ac453(0x23f)](_0x2e7ac8=>{var _0x465377=_0x4ac453;console['error'](_0x2e7ac8),_0xe62988[_0x465377(0x238)](0x1f4)[_0x465377(0x226)]({'error':_0x465377(0x1db)});});}catch(_0x9f0d5e){console['log'](_0x9f0d5e),_0xe62988['status'](0xc8)[_0x4ac453(0x226)]({'message':_0x9f0d5e[_0x4ac453(0x1c8)]});}}),router['get']('/view/:id',auth,async(_0x2b5c27,_0x5c6c7d)=>{var _0x57ba80=a0_0x5ba8f6;try{const {username:_0x461255,email:_0x5e6681,role:_0x235d16}=_0x2b5c27['user'],_0x143810=_0x2b5c27[_0x57ba80(0x1c6)],_0x3d9b00=await profile['findOne']({'email':_0x143810[_0x57ba80(0x1fc)]}),_0x122e67=await master_shop[_0x57ba80(0x1ec)](),_0x50878f=_0x2b5c27['params']['id'],_0x1ae7d6=await adjustment[_0x57ba80(0x25b)]({'_id':_0x50878f}),_0x8d09b2=await purchases[_0x57ba80(0x240)]([{'$match':{'warehouse_name':_0x1ae7d6['warehouse_name']}},{'$unwind':_0x57ba80(0x248)},{'$group':{'_id':_0x57ba80(0x1f8)}}]),_0x373862=await product[_0x57ba80(0x1ec)]({}),_0x23ea40=await warehouse[_0x57ba80(0x240)]([{'$match':{'name':_0x1ae7d6[_0x57ba80(0x1e9)]}},{'$unwind':_0x57ba80(0x224)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x57ba80(0x22e)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x57ba80(0x209)},'type':{'$first':_0x57ba80(0x1eb)},'floorlevel':{'$first':_0x57ba80(0x21e)},'primary_code':{'$first':_0x57ba80(0x1a9)},'secondary_code':{'$first':_0x57ba80(0x25a)},'product_code':{'$first':_0x57ba80(0x198)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x57ba80(0x1c2)},'expiry_date':{'$first':_0x57ba80(0x1b4)},'production_date':{'$first':_0x57ba80(0x247)},'batch_code':{'$first':_0x57ba80(0x1dc)},'room':{'$first':_0x57ba80(0x205)}}}]);let _0x2f3bb4;if(_0x143810['role']==_0x57ba80(0x1da)){const _0x3dec9a=await staff['findOne']({'email':_0x143810[_0x57ba80(0x1fc)]});_0x2f3bb4=await warehouse[_0x57ba80(0x240)]([{'$match':{'status':_0x57ba80(0x1aa),'name':_0x3dec9a[_0x57ba80(0x230)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x57ba80(0x1d3)}}},{'$group':{'_id':_0x57ba80(0x1d7),'name':{'$first':_0x57ba80(0x1d7)}}}]);}else _0x2f3bb4=await warehouse[_0x57ba80(0x240)]([{'$match':{'status':_0x57ba80(0x1aa),'warehouse_category':_0x57ba80(0x212),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x57ba80(0x1d7),'name':{'$first':'$name'}}}]);if(_0x122e67[0x0][_0x57ba80(0x1a1)]=='English\x20(US)'){var _0x5d6b52=users['English'];console[_0x57ba80(0x216)](_0x5d6b52);}else{if(_0x122e67[0x0][_0x57ba80(0x1a1)]=='Hindi')var _0x5d6b52=users[_0x57ba80(0x1b8)];else{if(_0x122e67[0x0][_0x57ba80(0x1a1)]==_0x57ba80(0x267))var _0x5d6b52=users[_0x57ba80(0x267)];else{if(_0x122e67[0x0][_0x57ba80(0x1a1)]==_0x57ba80(0x1a0))var _0x5d6b52=users[_0x57ba80(0x1a0)];else{if(_0x122e67[0x0][_0x57ba80(0x1a1)]=='French')var _0x5d6b52=users[_0x57ba80(0x213)];else{if(_0x122e67[0x0][_0x57ba80(0x1a1)]==_0x57ba80(0x1d4))var _0x5d6b52=users[_0x57ba80(0x194)];else{if(_0x122e67[0x0]['language']==_0x57ba80(0x1ba))var _0x5d6b52=users[_0x57ba80(0x1ba)];else{if(_0x122e67[0x0]['language']==_0x57ba80(0x1fe))var _0x5d6b52=users[_0x57ba80(0x1f3)];}}}}}}}_0x5c6c7d[_0x57ba80(0x1c5)]('edit_adjustment',{'success':_0x2b5c27['flash'](_0x57ba80(0x263)),'errors':_0x2b5c27[_0x57ba80(0x1d9)](_0x57ba80(0x232)),'role':_0x143810,'profile':_0x3d9b00,'adjustment':_0x1ae7d6,'stock':_0x23ea40,'master_shop':_0x122e67,'warehouse_name':_0x8d09b2,'unit':_0x373862,'language':_0x5d6b52,'warehouse':_0x2f3bb4});}catch(_0x134406){console['log'](_0x134406),_0x5c6c7d[_0x57ba80(0x238)](0xc8)[_0x57ba80(0x226)]({'message':_0x134406[_0x57ba80(0x1c8)]});}}),router[a0_0x5ba8f6(0x254)](a0_0x5ba8f6(0x21c),auth,async(_0x47fd92,_0x5aaa14)=>{var _0x14adfa=a0_0x5ba8f6;try{const _0x4c88e6=_0x47fd92[_0x14adfa(0x1b9)]['id'],_0x5cb351=await adjustment[_0x14adfa(0x25b)]({'_id':_0x4c88e6}),_0x19e2fd=await warehouse[_0x14adfa(0x21a)]({'name':_0x5cb351[_0x14adfa(0x1e9)],'room':_0x5cb351[_0x14adfa(0x21f)]}),{warehouse_name:_0x5943be,date:_0x117adb,prod_name:_0xb55088,level:_0x39f8f3,isle:_0x5bdf24,pallet:_0x5a3651,stock:_0x1377c1,types:_0x38fa7e,adjust_qty:_0x2dc12d,new_adjust_qty:_0x587afd,note:_0x256bc4,Room_name:_0x224fc5,invoice:_0x4331c5,JO_number:_0x5abc44,expiry_date:_0x2018e5}=_0x47fd92[_0x14adfa(0x225)];if(typeof _0xb55088==_0x14adfa(0x1e7))var _0x1b6391=[_0x47fd92['body'][_0x14adfa(0x1df)]],_0x15e648=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x22c)]],_0x243ba2=[_0x47fd92[_0x14adfa(0x225)]['stock']],_0x46bf2e=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x252)]],_0x42cd73=[_0x47fd92[_0x14adfa(0x225)]['New_Qty_Converted_adj']],_0xbe07fa=[_0x47fd92[_0x14adfa(0x225)]['New_Qty_Converted']],_0x1aeb10=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x1bb)]],_0xb29cc8=[_0x47fd92[_0x14adfa(0x225)]['Secondary_units']],_0x25bc5f=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x24b)]],_0x466f53=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x22b)]],_0x211267=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x24e)]],_0x5cbaa8=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x220)]],_0x9d7be=[_0x47fd92[_0x14adfa(0x225)]['production_date']],_0x26a478=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x1c0)]],_0x37c52a=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x260)]],_0x5a89f1=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x1a8)]],_0x526f4c=[_0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x264)]];else var _0x1b6391=[..._0x47fd92['body'][_0x14adfa(0x1df)]],_0x15e648=[..._0x47fd92['body'][_0x14adfa(0x22c)]],_0x243ba2=[..._0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x25c)]],_0x46bf2e=[..._0x47fd92['body'][_0x14adfa(0x252)]],_0x42cd73=[..._0x47fd92[_0x14adfa(0x225)]['New_Qty_Converted_adj']],_0xbe07fa=[..._0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x1b5)]],_0x1aeb10=[..._0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x1ee)]],_0xb29cc8=[..._0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x21d)]],_0x25bc5f=[..._0x47fd92['body'][_0x14adfa(0x24b)]],_0x466f53=[..._0x47fd92['body'][_0x14adfa(0x22b)]],_0x211267=[..._0x47fd92[_0x14adfa(0x225)]['expiry_date']],_0x5cbaa8=[..._0x47fd92[_0x14adfa(0x225)]['max_per_unit']],_0x9d7be=[..._0x47fd92['body']['production_date']],_0x26a478=[..._0x47fd92['body'][_0x14adfa(0x1c0)]],_0x37c52a=[..._0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x260)]],_0x5a89f1=[..._0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x1a8)]],_0x526f4c=[..._0x47fd92[_0x14adfa(0x225)][_0x14adfa(0x264)]];const _0x1724f2=_0x1b6391[_0x14adfa(0x229)](_0x5cdb0e=>{return _0x5cdb0e={'product_name':_0x5cdb0e};});_0x15e648['forEach']((_0x291c6f,_0x53a242)=>{var _0x15c4fe=_0x14adfa;_0x37c52a[_0x15c4fe(0x219)]((_0x2a760e,_0x3e96c4)=>{var _0x25e982=_0x15c4fe;if(_0x2a760e==_0x25e982(0x262)&&_0x53a242==_0x3e96c4){var _0x5b8aa7=_0x291c6f[_0x25e982(0x1e6)](0x3);_0x1724f2[_0x53a242][_0x25e982(0x266)]=_0x291c6f[0x0],_0x1724f2[_0x53a242]['rack']=_0x291c6f[0x1],_0x1724f2[_0x53a242][_0x25e982(0x1be)]=0x0,_0x1724f2[_0x53a242][_0x25e982(0x253)]=0x0,_0x1724f2[_0x53a242]['type']='Floor',_0x1724f2[_0x53a242][_0x25e982(0x1e2)]=_0x5b8aa7;}else{if(_0x2a760e==_0x25e982(0x223)&&_0x53a242==_0x3e96c4){var _0x5b8aa7=_0x291c6f[_0x25e982(0x1e6)](0x3);_0x1724f2[_0x53a242]['storage']=_0x291c6f[0x0],_0x1724f2[_0x53a242]['rack']=_0x291c6f[0x1],_0x1724f2[_0x53a242][_0x25e982(0x1be)]=0x0,_0x1724f2[_0x53a242][_0x25e982(0x253)]=0x0,_0x1724f2[_0x53a242]['type']=_0x25e982(0x1dd),_0x1724f2[_0x53a242][_0x25e982(0x1e2)]=_0x291c6f[0x5];}else{if(_0x53a242==_0x3e96c4){var _0x103b43;if(_0x291c6f[0x4]=='L')_0x103b43='Level';else _0x291c6f[0x4]=='F'&&(_0x103b43=_0x25e982(0x1dd));_0x1724f2[_0x53a242][_0x25e982(0x266)]=_0x291c6f[0x0],_0x1724f2[_0x53a242]['rack']=_0x291c6f[0x1],_0x1724f2[_0x53a242][_0x25e982(0x1be)]=_0x291c6f[0x2],_0x1724f2[_0x53a242][_0x25e982(0x253)]=_0x291c6f[0x3],_0x1724f2[_0x53a242][_0x25e982(0x204)]=_0x103b43,_0x1724f2[_0x53a242][_0x25e982(0x1e2)]=_0x291c6f[0x5];}}}});}),_0x243ba2[_0x14adfa(0x219)]((_0x2c4d4d,_0x41db1a)=>{var _0x18566f=_0x14adfa;_0x1724f2[_0x41db1a][_0x18566f(0x1d6)]=_0x2c4d4d;}),_0x46bf2e['forEach']((_0x1ba40f,_0x5a5e23)=>{var _0x576a20=_0x14adfa;_0x1724f2[_0x5a5e23][_0x576a20(0x252)]=_0x1ba40f;}),_0x42cd73[_0x14adfa(0x219)]((_0x1c5cc9,_0x362e47)=>{var _0x50f8ee=_0x14adfa;_0x1724f2[_0x362e47][_0x50f8ee(0x1e0)]=_0x1c5cc9;}),_0xbe07fa[_0x14adfa(0x219)]((_0x1292f1,_0x3b7d17)=>{var _0xb87ffc=_0x14adfa;_0x1724f2[_0x3b7d17][_0xb87ffc(0x22a)]=_0x1292f1;}),_0x1aeb10['forEach']((_0x191437,_0x255983)=>{var _0x1a23b0=_0x14adfa;_0x1724f2[_0x255983][_0x1a23b0(0x1ee)]=_0x191437;}),_0xb29cc8['forEach']((_0x4066d1,_0x212abc)=>{var _0x61ad42=_0x14adfa;_0x1724f2[_0x212abc][_0x61ad42(0x1fd)]=_0x4066d1;}),_0x25bc5f[_0x14adfa(0x219)]((_0x463ec0,_0x16f180)=>{var _0x28d0c7=_0x14adfa;_0x1724f2[_0x16f180][_0x28d0c7(0x244)]=_0x463ec0;}),_0x466f53['forEach']((_0x3a8b2f,_0x13095a)=>{var _0x2fa2e3=_0x14adfa;_0x1724f2[_0x13095a][_0x2fa2e3(0x22b)]=_0x3a8b2f;}),_0x211267['forEach']((_0x2a9998,_0x2b446e)=>{_0x1724f2[_0x2b446e]['expiry_date']=_0x2a9998;}),_0x5cbaa8[_0x14adfa(0x219)]((_0x40da61,_0x337913)=>{_0x1724f2[_0x337913]['maxperunit']=_0x40da61;}),_0x9d7be[_0x14adfa(0x219)]((_0x552010,_0x276cd1)=>{_0x1724f2[_0x276cd1]['production_date']=_0x552010;}),_0x26a478[_0x14adfa(0x219)]((_0x17663d,_0x364764)=>{_0x1724f2[_0x364764]['prod_cat']=_0x17663d;}),_0x37c52a[_0x14adfa(0x219)]((_0xdbccfe,_0x2ca48b)=>{var _0x26ec23=_0x14adfa;_0x1724f2[_0x2ca48b][_0x26ec23(0x1ca)]=_0xdbccfe;}),_0x5a89f1['forEach']((_0x515f5a,_0x3bafed)=>{var _0x1ed2e4=_0x14adfa;_0x1724f2[_0x3bafed][_0x1ed2e4(0x1b6)]=_0x515f5a;}),_0x526f4c[_0x14adfa(0x219)]((_0x2598e1,_0x5cddfb)=>{var _0x3b0274=_0x14adfa;_0x1724f2[_0x5cddfb][_0x3b0274(0x201)]=_0x2598e1;});const _0xf15e3c=_0x1724f2[_0x14adfa(0x23d)](_0x4fb4ca=>_0x4fb4ca[_0x14adfa(0x1e0)]!=='0'&&_0x4fb4ca[_0x14adfa(0x1e0)]!=='');var _0x50a609=0x0;_0xf15e3c[_0x14adfa(0x219)](_0x442cf9=>{var _0x1336f8=_0x14adfa;console[_0x1336f8(0x216)]('foreach\x20newproduct',_0x442cf9),parseInt(_0x442cf9[_0x1336f8(0x1e0)])<=0x0&&_0x50a609++;});if(_0x50a609!=0x0)return _0x47fd92['flash'](_0x14adfa(0x232),_0x14adfa(0x1a4)),_0x5aaa14[_0x14adfa(0x234)]('back');_0x5cb351[_0x14adfa(0x1e9)]=_0x5943be,_0x5cb351[_0x14adfa(0x1cb)]=_0x117adb,_0x5cb351[_0x14adfa(0x19b)]=_0xf15e3c,_0x5cb351[_0x14adfa(0x207)]=_0x256bc4,_0x5cb351[_0x14adfa(0x1d5)]=_0x4331c5,_0x5cb351[_0x14adfa(0x1af)]=_0x14adfa(0x24c);const _0x46057a=await _0x5cb351[_0x14adfa(0x1d2)]();_0x47fd92[_0x14adfa(0x1d9)](_0x14adfa(0x263),_0x14adfa(0x1a7)),_0x5aaa14[_0x14adfa(0x234)](_0x14adfa(0x217));}catch(_0x479daf){console['log'](_0x479daf);}}),router[a0_0x5ba8f6(0x254)](a0_0x5ba8f6(0x1ea),async(_0x4bbe70,_0x4843c8)=>{var _0x133c96=a0_0x5ba8f6;const {primary_code:_0x6f92f7,warehouse_data:_0x367ac1,rooms_data:_0x276655,Roomslist:_0x2b9965}=_0x4bbe70[_0x133c96(0x225)],_0x386f6b=_0x2b9965[_0x133c96(0x20f)](','),_0x115eab=[];async function _0x26535b(_0x1567fa){var _0x3d8e81=_0x133c96;const _0x4a814e=await warehouse['aggregate']([{'$match':{'name':_0x367ac1,'room':_0x1567fa}},{'$unwind':_0x3d8e81(0x224)},{'$match':{'product_details.primary_code':_0x6f92f7}},{'$group':{'_id':_0x3d8e81(0x1f6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3d8e81(0x22e)},'primary_code':{'$first':_0x3d8e81(0x1a9)},'secondary_code':{'$first':_0x3d8e81(0x25a)},'product_code':{'$first':_0x3d8e81(0x198)},'level':{'$first':_0x3d8e81(0x214)},'isle':{'$first':_0x3d8e81(0x209)},'type':{'$first':_0x3d8e81(0x1eb)},'pallet':{'$first':_0x3d8e81(0x21e)},'unit':{'$first':_0x3d8e81(0x1bc)},'secondary_unit':{'$first':_0x3d8e81(0x192)},'storage':{'$first':_0x3d8e81(0x20e)},'rack':{'$first':_0x3d8e81(0x20c)},'expiry_date':{'$first':_0x3d8e81(0x1b4)},'production_date':{'$first':_0x3d8e81(0x247)},'maxPerUnit':{'$first':_0x3d8e81(0x1c2)},'batch_code':{'$first':_0x3d8e81(0x1dc)},'product_cat':{'$first':_0x3d8e81(0x1b7)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x20fec5=await warehouse[_0x3d8e81(0x240)]([{'$match':{'name':_0x367ac1,'room':_0x1567fa}},{'$unwind':_0x3d8e81(0x224)},{'$match':{'product_details.secondary_code':_0x6f92f7}},{'$group':{'_id':_0x3d8e81(0x1f6),'name':{'$first':_0x3d8e81(0x1d0)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x3d8e81(0x1a9)},'secondary_code':{'$first':_0x3d8e81(0x25a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3d8e81(0x214)},'isle':{'$first':_0x3d8e81(0x209)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3d8e81(0x21e)},'unit':{'$first':_0x3d8e81(0x1bc)},'secondary_unit':{'$first':_0x3d8e81(0x192)},'storage':{'$first':_0x3d8e81(0x20e)},'rack':{'$first':_0x3d8e81(0x20c)},'expiry_date':{'$first':_0x3d8e81(0x1b4)},'production_date':{'$first':_0x3d8e81(0x247)},'maxPerUnit':{'$first':_0x3d8e81(0x1c2)},'batch_code':{'$first':_0x3d8e81(0x1dc)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x4a814e[_0x3d8e81(0x206)]>0x0)_0x115eab[_0x3d8e81(0x237)](_0x4a814e);else _0x20fec5['length']>0x0&&_0x115eab[_0x3d8e81(0x237)](_0x20fec5);}const _0xe8c3db=_0x386f6b[_0x133c96(0x229)](_0x5d7516=>_0x26535b(_0x5d7516));await Promise[_0x133c96(0x191)](_0xe8c3db),_0x4843c8[_0x133c96(0x226)](_0x115eab);}),router['post'](a0_0x5ba8f6(0x25f),async(_0x206900,_0x2ab87c)=>{var _0x399c5c=a0_0x5ba8f6;const {primaryCode:_0x3502a1,secondaryCode:_0x4cb872,productCode:_0x2105bd,level:_0x50f326,isle:_0x443edb,pallet:_0x32bfc0,warehouses:_0x3b873d,room:_0x5d0997}=_0x206900[_0x399c5c(0x225)];try{const _0x47423c=await warehouse['aggregate']([{'$match':{'name':_0x3b873d,'room':_0x5d0997}},{'$unwind':_0x399c5c(0x224)},{'$match':{'product_details.level':parseInt(_0x50f326),'product_details.isle':_0x443edb,'product_details.pallet':parseInt(_0x32bfc0)}},{'$group':{'_id':_0x399c5c(0x1f6),'name':{'$first':_0x399c5c(0x1d0)},'product_stock':{'$first':_0x399c5c(0x22e)},'level':{'$first':_0x399c5c(0x1c9)},'isle':{'$first':_0x399c5c(0x1c7)},'pallet':{'$first':_0x399c5c(0x1ad)},'maxProducts':{'$first':_0x399c5c(0x1f7)}}}]);_0x2ab87c['status'](0xc8)[_0x399c5c(0x226)](_0x47423c);}catch(_0x8a641d){_0x2ab87c['status'](0x194)[_0x399c5c(0x226)]({'message':_0x8a641d[_0x399c5c(0x1c8)]});}}),module[a0_0x5ba8f6(0x208)]=router;