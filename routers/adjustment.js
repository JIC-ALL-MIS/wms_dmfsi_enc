var a0_0x3a0373=a0_0x1338;(function(_0x396767,_0x5934c5){var _0x5ed68b=a0_0x1338,_0x525110=_0x396767();while(!![]){try{var _0x4a4b6a=parseInt(_0x5ed68b(0x255))/0x1*(-parseInt(_0x5ed68b(0x2a8))/0x2)+-parseInt(_0x5ed68b(0x217))/0x3+-parseInt(_0x5ed68b(0x208))/0x4+-parseInt(_0x5ed68b(0x250))/0x5+parseInt(_0x5ed68b(0x203))/0x6*(-parseInt(_0x5ed68b(0x25a))/0x7)+parseInt(_0x5ed68b(0x21d))/0x8+parseInt(_0x5ed68b(0x268))/0x9*(parseInt(_0x5ed68b(0x230))/0xa);if(_0x4a4b6a===_0x5934c5)break;else _0x525110['push'](_0x525110['shift']());}catch(_0x491c50){_0x525110['push'](_0x525110['shift']());}}}(a0_0x22f2,0x98d99));function a0_0x22f2(){var _0x592c61=['Raw\x20Materials','$product_details','warehouse','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<html><head><title></title>','product','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.secondary_code','exports','floorlevel','$product','level','$name','types','$product_details.bin','<tbody\x20style=\x22text-align:\x20center;\x22>','padStart','params','$product_details.isle','master','$product_details.rack','\x20Order\x20Number\x20:\x20','message','find','</head><body>','German','Return\x20Goods','Return\x20Rooms','port','product_code','second1','/view/add_adjustment','flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$isAllowEdit','/adjustment/view','/barcode_scanner','json','map','Adjustment\x20Mail','/CheckingWarehouse','<hr\x20class=\x22my-3\x22>','Primary_Units','render','Router','post','storage','Arabic','then','</table>','push','$product_details.unit','$product.room_names','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Chinese','random','$product_details.expiry_date','14fcJIzS','floor','body','$product_details.maxPerUnit','expiry_date','$product_details.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','\x20Order\x20Date\x20:\x20','prime1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','aggregate','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','language','Secondary_units','sendMail','English\x20(US)','$product_details.batch_code','Enclosed','host','stock','bin','/adjustment/preview/','product_details','Portuguese\x20(BR)','New_Qty_Converted','French','prod_name','stockBefore','foreach\x20newproduct','$product_details.storage','</tbody>','../public/language/languages.json','Hindi','Ambient','$product_details.maxProducts','$product_details._id','catch','Floor','$product_details.product_code','staff','../models/all_models','product_stock','findById','$product_details.bay','get','status','\x20</h2>','2547390auvgQa','</span>','add_adjustment','adjust_qty','$product.product_name','3715608uDqlxd','<tr>','secondary_unit','date','room_names','room','Error\x20Occurs','An\x20error\x20occurred\x20while\x20saving\x20data.','split','Spanish','createTransport','Rooms','prod_cat','success','$product_details.floorlevel','3602700CywQki','$product_details.production_date','</tr>','role','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','log','944304gPVdzf','_id','finalize','back','$warehouse_name','secondary_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','errors','redirect','user','<h2>\x20','$product_details.product_stock','email','English','forEach','type','$product_details.type','/view','save','139790ncfFyK','Enabled','$product_details.primary_code','logo','new_adjust_qty','site_title','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$room','</thead>','/view/:id','$finalize','all','<div>','rack','$_id','Logo.png','\x20<>\x20','error','bay','batch_code','<h5\x20style=\x22text-align:\x20left;\x22>','invoice','Arabic\x20(ae)','</div>','maxPerUnit','toString','Portuguese','max_per_unit','note','product_name','Level','maxperunit','3840410lkhaPr','findOne','adjustment\x20Finalized\x20successfully','unit','warehouse_name','105807wdKmeB','ADJ-','length','prod_invoice','<strong>\x20Regards\x20</strong>','7VQvIah','$product_details.pallet','New_Qty_Converted_adj','</td>','</body></html>','<!DOCTYPE\x20html>','slice','$invoice','/preview/:id','$product_details.product_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','isAllowEdit','filter','$product_details.level','2943YiDMcV','RMSEmail','production_date','<span\x20style=\x22float:\x20right;\x22>','prod_code','nodemailer'];a0_0x22f2=function(){return _0x592c61;};return a0_0x22f2();}const express=require('express'),app=express(),router=express[a0_0x3a0373(0x29a)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x3a0373(0x1fc)),users=require(a0_0x3a0373(0x1f3)),nodemailer=require(a0_0x3a0373(0x26d));function a0_0x1338(_0x3f8db8,_0xcc8592){var _0x22f262=a0_0x22f2();return a0_0x1338=function(_0x1338a0,_0x8d0cb9){_0x1338a0=_0x1338a0-0x1d5;var _0x2797b7=_0x22f262[_0x1338a0];return _0x2797b7;},a0_0x1338(_0x3f8db8,_0xcc8592);}router[a0_0x3a0373(0x200)](a0_0x3a0373(0x22e),auth,async(_0x2ffb1d,_0xac5413)=>{var _0x307305=a0_0x3a0373;try{const {username:_0x4bdb81,email:_0xb86ec3,role:_0x1ad7b9}=_0x2ffb1d['user'],_0x5112ad=_0x2ffb1d['user'],_0x10096c=await profile[_0x307305(0x251)]({'email':_0x5112ad[_0x307305(0x229)]}),_0xac35e3=await master_shop[_0x307305(0x285)]();console[_0x307305(0x21c)](_0x307305(0x281),_0xac35e3);let _0x4319d3;if(_0x5112ad[_0x307305(0x21a)]==_0x307305(0x1fb)){const _0x1040fc=await staff[_0x307305(0x251)]({'email':_0x5112ad[_0x307305(0x229)]});_0x4319d3=await warehouse[_0x307305(0x285)]({'status':_0x307305(0x231),'name':_0x1040fc['warehouse']});}else _0x4319d3=await warehouse[_0x307305(0x285)]({'status':_0x307305(0x231)});const _0xc649ac=await product[_0x307305(0x285)]();let _0x5f33fd;if(_0x5112ad[_0x307305(0x21a)]=='staff'){const _0x1acdb0=await staff[_0x307305(0x251)]({'email':_0x5112ad[_0x307305(0x229)]});_0x5f33fd=await adjustment['find']({'warehouse_name':_0x1acdb0[_0x307305(0x270)]});}else _0x5f33fd=await adjustment[_0x307305(0x1de)]([{'$unwind':'$product'},{'$group':{'_id':_0x307305(0x23e),'invoice':{'$first':_0x307305(0x261)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x307305(0x221)},'room':{'$addToSet':_0x307305(0x2a2)},'finalize':{'$first':_0x307305(0x23a)},'isAllowEdit':{'$first':_0x307305(0x290)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xac35e3[0x0]['language']==_0x307305(0x1e3)){var _0x65053=users[_0x307305(0x22a)];console['log'](_0x65053);}else{if(_0xac35e3[0x0]['language']==_0x307305(0x1f4))var _0x65053=users[_0x307305(0x1f4)];else{if(_0xac35e3[0x0]['language']==_0x307305(0x287))var _0x65053=users[_0x307305(0x287)];else{if(_0xac35e3[0x0]['language']==_0x307305(0x211))var _0x65053=users[_0x307305(0x211)];else{if(_0xac35e3[0x0]['language']==_0x307305(0x1ed))var _0x65053=users[_0x307305(0x1ed)];else{if(_0xac35e3[0x0]['language']==_0x307305(0x1eb))var _0x65053=users[_0x307305(0x24a)];else{if(_0xac35e3[0x0]['language']==_0x307305(0x2a5))var _0x65053=users[_0x307305(0x2a5)];else{if(_0xac35e3[0x0][_0x307305(0x1e0)]=='Arabic\x20(ae)')var _0x65053=users[_0x307305(0x29d)];}}}}}}}_0xac5413[_0x307305(0x299)]('adjustment',{'success':_0x2ffb1d['flash'](_0x307305(0x215)),'errors':_0x2ffb1d[_0x307305(0x28e)](_0x307305(0x224)),'role':_0x5112ad,'profile':_0x10096c,'warehouse':_0x4319d3,'product':_0xc649ac,'adjustment':_0x5f33fd,'master_shop':_0xac35e3,'language':_0x65053});}catch(_0x4fcfa9){console[_0x307305(0x21c)](_0x4fcfa9);}});async function getRandom8DigitNumber(){var _0x1d3f2b=a0_0x3a0373;const _0x29b39b=0x989680,_0x2e115a=0x5f5e0ff,_0x529dac=Math[_0x1d3f2b(0x1d5)](Math[_0x1d3f2b(0x2a6)]()*(_0x2e115a-_0x29b39b+0x1))+_0x29b39b;var _0x101379;const _0x34093a=await adjustment['findOne']({'invoice':'ADJ-'+_0x529dac});return _0x34093a&&_0x34093a[_0x1d3f2b(0x257)]>0x0?_0x101379=_0x1d3f2b(0x256)+_0x529dac:_0x101379=_0x1d3f2b(0x256)+_0x529dac,_0x101379;}router[a0_0x3a0373(0x200)](a0_0x3a0373(0x28d),auth,async(_0x3927f6,_0x2b6b0b)=>{var _0x14ff90=a0_0x3a0373;try{const {username:_0x2ecacc,email:_0x59e2b0,role:_0x51ffe6}=_0x3927f6[_0x14ff90(0x226)],_0x4166a4=_0x3927f6[_0x14ff90(0x226)],_0x2074d8=await profile[_0x14ff90(0x251)]({'email':_0x4166a4['email']}),_0x14f490=await master_shop[_0x14ff90(0x285)]();let _0x2b3d8b;if(_0x4166a4[_0x14ff90(0x21a)]=='staff'){const _0x45bbf8=await staff['findOne']({'email':_0x4166a4[_0x14ff90(0x229)]});_0x2b3d8b=await warehouse[_0x14ff90(0x1de)]([{'$match':{'status':_0x14ff90(0x231),'name':_0x45bbf8[_0x14ff90(0x270)],'warehouse_category':_0x14ff90(0x26e),'name':{'$ne':_0x14ff90(0x288)}}},{'$group':{'_id':_0x14ff90(0x27a),'name':{'$first':_0x14ff90(0x27a)}}}]);}else _0x2b3d8b=await warehouse['aggregate']([{'$match':{'status':_0x14ff90(0x231),'warehouse_category':_0x14ff90(0x26e),'name':{'$ne':_0x14ff90(0x288)}}},{'$group':{'_id':_0x14ff90(0x27a),'name':{'$first':_0x14ff90(0x27a)}}}]);const _0x41b925=await product[_0x14ff90(0x285)]({}),_0x3eff2a=await adjustment[_0x14ff90(0x285)]({}),_0x4ee603=_0x3eff2a[_0x14ff90(0x257)]+0x1,_0x157864='ADJ-'+_0x4ee603[_0x14ff90(0x249)]()[_0x14ff90(0x27e)](0x5,'0');var _0x1ff699=[_0x14ff90(0x1f5),_0x14ff90(0x1e5),_0x14ff90(0x289)];if(_0x14f490[0x0][_0x14ff90(0x1e0)]==_0x14ff90(0x1e3))var _0x563f2a=users[_0x14ff90(0x22a)];else{if(_0x14f490[0x0][_0x14ff90(0x1e0)]==_0x14ff90(0x1f4))var _0x563f2a=users['Hindi'];else{if(_0x14f490[0x0]['language']==_0x14ff90(0x287))var _0x563f2a=users[_0x14ff90(0x287)];else{if(_0x14f490[0x0][_0x14ff90(0x1e0)]==_0x14ff90(0x211))var _0x563f2a=users['Spanish'];else{if(_0x14f490[0x0][_0x14ff90(0x1e0)]=='French')var _0x563f2a=users['French'];else{if(_0x14f490[0x0][_0x14ff90(0x1e0)]==_0x14ff90(0x1eb))var _0x563f2a=users[_0x14ff90(0x24a)];else{if(_0x14f490[0x0]['language']==_0x14ff90(0x2a5))var _0x563f2a=users[_0x14ff90(0x2a5)];else{if(_0x14f490[0x0][_0x14ff90(0x1e0)]=='Arabic\x20(ae)')var _0x563f2a=users[_0x14ff90(0x29d)];}}}}}}}const _0x5c9d0c=getRandom8DigitNumber();_0x5c9d0c[_0x14ff90(0x29e)](_0xa4c2d5=>{var _0x72bb88=_0x14ff90;_0x2b6b0b[_0x72bb88(0x299)](_0x72bb88(0x205),{'success':_0x3927f6[_0x72bb88(0x28e)](_0x72bb88(0x215)),'errors':_0x3927f6['flash'](_0x72bb88(0x224)),'role':_0x4166a4,'profile':_0x2074d8,'warehouse':_0x2b3d8b,'product':_0x41b925,'master_shop':_0x14f490,'language':_0x563f2a,'rooms_data':_0x1ff699,'invoice_no':_0xa4c2d5});})[_0x14ff90(0x1f8)](_0x5dd508=>{var _0x2f7ab8=_0x14ff90;_0x3927f6[_0x2f7ab8(0x28e)]('errors',_0x2f7ab8(0x274)),_0x2b6b0b[_0x2f7ab8(0x225)](_0x2f7ab8(0x291));});}catch(_0x1c2f03){console[_0x14ff90(0x21c)](_0x1c2f03);}}),router['post'](a0_0x3a0373(0x28d),auth,async(_0x1e4944,_0xc80526)=>{var _0x275947=a0_0x3a0373;try{const {warehouse_name:_0x4b45b8,date:_0x20bccc,prod_name:_0x52e7da,level:_0x170a10,isle:_0x56d4f8,pallet:_0x23e16f,stock:_0x104936,types:_0x2fc968,adjust_qty:_0x115089,new_adjust_qty:_0x139d2f,note:_0xadccfa,Room_name:_0x37b20a,invoice:_0x5c871d,JO_number:_0x184aaa,expiry_date:_0x3cd4c0}=_0x1e4944[_0x275947(0x1d6)];if(typeof _0x52e7da=='string')var _0x2d3f5d=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x1ee)]],_0xb1c205=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x279)]],_0x2c2f07=[_0x1e4944['body'][_0x275947(0x1e7)]],_0x49ecd4=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x27b)]],_0x4c6ae9=[_0x1e4944[_0x275947(0x1d6)]['New_Qty_Converted_adj']],_0x47b5c9=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x1ec)]],_0x784a=[_0x1e4944['body']['Primary_Units']],_0x185b6e=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x1e1)]],_0x122e30=[_0x1e4944[_0x275947(0x1d6)]['prod_code']],_0x67e558=[_0x1e4944[_0x275947(0x1d6)]['batch_code']],_0x4f6572=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x1d8)]],_0x1c6400=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x24b)]],_0x52150a=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x26a)]],_0x3d98dc=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x214)]],_0x13d517=[_0x1e4944[_0x275947(0x1d6)]['Rooms']],_0x5d8432=[_0x1e4944['body'][_0x275947(0x1dc)]],_0x2452bd=[_0x1e4944[_0x275947(0x1d6)][_0x275947(0x28c)]],_0x31c4e4=[_0x1e4944[_0x275947(0x1d6)]['prod_invoice']];else var _0x2d3f5d=[..._0x1e4944[_0x275947(0x1d6)][_0x275947(0x1ee)]],_0xb1c205=[..._0x1e4944[_0x275947(0x1d6)]['level']],_0x2c2f07=[..._0x1e4944['body']['stock']],_0x49ecd4=[..._0x1e4944[_0x275947(0x1d6)][_0x275947(0x27b)]],_0x4c6ae9=[..._0x1e4944[_0x275947(0x1d6)]['New_Qty_Converted_adj']],_0x47b5c9=[..._0x1e4944[_0x275947(0x1d6)]['New_Qty_Converted']],_0x784a=[..._0x1e4944[_0x275947(0x1d6)][_0x275947(0x253)]],_0x185b6e=[..._0x1e4944[_0x275947(0x1d6)][_0x275947(0x1e1)]],_0x122e30=[..._0x1e4944[_0x275947(0x1d6)]['prod_code']],_0x67e558=[..._0x1e4944[_0x275947(0x1d6)]['batch_code']],_0x4f6572=[..._0x1e4944['body']['expiry_date']],_0x1c6400=[..._0x1e4944['body']['max_per_unit']],_0x52150a=[..._0x1e4944[_0x275947(0x1d6)][_0x275947(0x26a)]],_0x3d98dc=[..._0x1e4944[_0x275947(0x1d6)]['prod_cat']],_0x13d517=[..._0x1e4944[_0x275947(0x1d6)][_0x275947(0x213)]],_0x5d8432=[..._0x1e4944[_0x275947(0x1d6)][_0x275947(0x1dc)]],_0x2452bd=[..._0x1e4944['body'][_0x275947(0x28c)]],_0x31c4e4=[..._0x1e4944['body'][_0x275947(0x258)]];const _0x15fe77=_0x2d3f5d[_0x275947(0x294)](_0x5f4beb=>{return _0x5f4beb={'product_name':_0x5f4beb};});_0xb1c205['forEach']((_0x57b4dd,_0x2f8731)=>{_0x13d517['forEach']((_0x27876a,_0x151669)=>{var _0xecbe9e=a0_0x1338;if(_0x27876a=='Receiving\x20Area'&&_0x2f8731==_0x151669){var _0x50febe=_0x57b4dd[_0xecbe9e(0x260)](0x3);_0x15fe77[_0x2f8731]['storage']=_0x57b4dd[0x0],_0x15fe77[_0x2f8731]['rack']=_0x57b4dd[0x1],_0x15fe77[_0x2f8731][_0xecbe9e(0x242)]=0x0,_0x15fe77[_0x2f8731]['bin']=0x0,_0x15fe77[_0x2f8731][_0xecbe9e(0x22c)]=_0xecbe9e(0x1f9),_0x15fe77[_0x2f8731][_0xecbe9e(0x277)]=_0x50febe;}else{if(_0x27876a=='Shelves'&&_0x2f8731==_0x151669){var _0x50febe=_0x57b4dd['slice'](0x3);_0x15fe77[_0x2f8731][_0xecbe9e(0x29c)]=_0x57b4dd[0x0],_0x15fe77[_0x2f8731][_0xecbe9e(0x23d)]=_0x57b4dd[0x1],_0x15fe77[_0x2f8731]['bay']=0x0,_0x15fe77[_0x2f8731][_0xecbe9e(0x1e8)]=0x0,_0x15fe77[_0x2f8731][_0xecbe9e(0x22c)]=_0xecbe9e(0x1f9),_0x15fe77[_0x2f8731][_0xecbe9e(0x277)]=_0x57b4dd[0x5];}else{if(_0x2f8731==_0x151669){var _0x49d53b;if(_0x57b4dd[0x4]=='L')_0x49d53b=_0xecbe9e(0x24e);else _0x57b4dd[0x4]=='F'&&(_0x49d53b=_0xecbe9e(0x1f9));_0x15fe77[_0x2f8731][_0xecbe9e(0x29c)]=_0x57b4dd[0x0],_0x15fe77[_0x2f8731][_0xecbe9e(0x23d)]=_0x57b4dd[0x1],_0x15fe77[_0x2f8731][_0xecbe9e(0x242)]=_0x57b4dd[0x2],_0x15fe77[_0x2f8731]['bin']=_0x57b4dd[0x3],_0x15fe77[_0x2f8731][_0xecbe9e(0x22c)]=_0x49d53b,_0x15fe77[_0x2f8731][_0xecbe9e(0x277)]=_0x57b4dd[0x5];}}}});}),_0x2c2f07[_0x275947(0x22b)]((_0x2d1ee3,_0x4e3bfe)=>{var _0x55a421=_0x275947;_0x15fe77[_0x4e3bfe][_0x55a421(0x1ef)]=_0x2d1ee3;}),_0x49ecd4[_0x275947(0x22b)]((_0x67593f,_0x4c1394)=>{var _0x5bb918=_0x275947;_0x15fe77[_0x4c1394][_0x5bb918(0x27b)]=_0x67593f;}),_0x4c6ae9[_0x275947(0x22b)]((_0xaf4dd1,_0x33ed86)=>{var _0x32fbc1=_0x275947;_0x15fe77[_0x33ed86][_0x32fbc1(0x206)]=_0xaf4dd1;}),_0x47b5c9[_0x275947(0x22b)]((_0x4a5c7f,_0x1187b5)=>{var _0x48fd3e=_0x275947;_0x15fe77[_0x1187b5][_0x48fd3e(0x234)]=_0x4a5c7f;}),_0x784a['forEach']((_0x46e8dc,_0x2ab0ee)=>{_0x15fe77[_0x2ab0ee]['unit']=_0x46e8dc;}),_0x185b6e[_0x275947(0x22b)]((_0x5ec74b,_0x252d90)=>{_0x15fe77[_0x252d90]['secondary_unit']=_0x5ec74b;}),_0x122e30[_0x275947(0x22b)]((_0x58b6b4,_0x18751e)=>{var _0x56ecda=_0x275947;_0x15fe77[_0x18751e][_0x56ecda(0x28b)]=_0x58b6b4;}),_0x67e558['forEach']((_0x5916ea,_0x4a26e1)=>{var _0x52a692=_0x275947;_0x15fe77[_0x4a26e1][_0x52a692(0x243)]=_0x5916ea;}),_0x4f6572[_0x275947(0x22b)]((_0x3894d5,_0x3e5274)=>{var _0x4da22a=_0x275947;_0x15fe77[_0x3e5274][_0x4da22a(0x1d8)]=_0x3894d5;}),_0x1c6400['forEach']((_0x24ebee,_0x2644e9)=>{var _0x1c93db=_0x275947;_0x15fe77[_0x2644e9][_0x1c93db(0x24f)]=_0x24ebee;}),_0x52150a[_0x275947(0x22b)]((_0x3818e1,_0x146997)=>{var _0x36100c=_0x275947;_0x15fe77[_0x146997][_0x36100c(0x26a)]=_0x3818e1;}),_0x3d98dc[_0x275947(0x22b)]((_0x575a0e,_0x454d0b)=>{var _0x481ab0=_0x275947;_0x15fe77[_0x454d0b][_0x481ab0(0x214)]=_0x575a0e;}),_0x13d517[_0x275947(0x22b)]((_0x102ae3,_0x2797aa)=>{var _0x3754de=_0x275947;_0x15fe77[_0x2797aa][_0x3754de(0x20c)]=_0x102ae3;}),_0x5d8432[_0x275947(0x22b)]((_0x285d51,_0x2adf33)=>{_0x15fe77[_0x2adf33]['primary_code']=_0x285d51;}),_0x2452bd['forEach']((_0x1a84c4,_0x5c792c)=>{_0x15fe77[_0x5c792c]['secondary_code']=_0x1a84c4;}),_0x31c4e4[_0x275947(0x22b)]((_0x1073d2,_0x362def)=>{var _0x25678c=_0x275947;_0x15fe77[_0x362def][_0x25678c(0x245)]=_0x1073d2;});const _0x1c0e59=_0x15fe77[_0x275947(0x266)](_0x3023fd=>_0x3023fd[_0x275947(0x206)]!=='0'&&_0x3023fd[_0x275947(0x206)]!=='');var _0x3fc199=0x0;_0x1c0e59[_0x275947(0x22b)](_0xf9385d=>{var _0xeab53b=_0x275947;console['log'](_0xeab53b(0x1f0),_0xf9385d),parseInt(_0xf9385d['adjust_qty'])<=0x0&&_0x3fc199++;});if(_0x3fc199!=0x0)return _0x1e4944['flash'](_0x275947(0x224),_0x275947(0x1df)),_0xc80526['redirect'](_0x275947(0x220));const _0x49cfd2=new adjustment({'warehouse_name':_0x4b45b8,'date':_0x20bccc,'product':_0x1c0e59,'note':_0xadccfa,'room':_0x37b20a,'invoice':_0x5c871d,'JO_number':_0x184aaa,'expiry_date':_0x3cd4c0}),_0x4e0558=await _0x49cfd2[_0x275947(0x22f)]();_0x1e4944['flash'](_0x275947(0x215),'adjustment\x20add\x20successfull'),_0xc80526[_0x275947(0x225)](_0x275947(0x1e9)+_0x4e0558['_id']);}catch(_0x39662f){console['log'](_0x39662f),_0xc80526[_0x275947(0x201)](0xc8)[_0x275947(0x293)]({'message':_0x39662f[_0x275947(0x284)]});}}),router[a0_0x3a0373(0x200)](a0_0x3a0373(0x262),auth,async(_0x417b23,_0x2c26db)=>{var _0x16d3fa=a0_0x3a0373;try{const {username:_0x5e0311,email:_0x566a54,role:_0x5b8ca7}=_0x417b23[_0x16d3fa(0x226)],_0x9bd1ae=_0x417b23[_0x16d3fa(0x226)],_0x4105ba=await profile[_0x16d3fa(0x251)]({'email':_0x9bd1ae[_0x16d3fa(0x229)]}),_0x11c463=await master_shop[_0x16d3fa(0x285)](),_0x16b6ec=_0x417b23[_0x16d3fa(0x27f)]['id'],_0xc0a49d=await adjustment[_0x16d3fa(0x1fe)]({'_id':_0x16b6ec}),_0x4995ce=await purchases[_0x16d3fa(0x1de)]([{'$match':{'warehouse_name':_0xc0a49d[_0x16d3fa(0x254)]}},{'$unwind':_0x16d3fa(0x278)},{'$group':{'_id':_0x16d3fa(0x207)}}]),_0x3a2dd3=await product[_0x16d3fa(0x285)]({}),_0x1f7d28=await warehouse[_0x16d3fa(0x1de)]([{'$match':{'name':_0xc0a49d['warehouse_name']}},{'$unwind':_0x16d3fa(0x26f)},{'$group':{'_id':_0x16d3fa(0x1f7),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x16d3fa(0x228)},'bay':{'$first':_0x16d3fa(0x1ff)},'bin':{'$first':_0x16d3fa(0x27c)},'type':{'$first':_0x16d3fa(0x22d)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x16d3fa(0x275)},'product_code':{'$first':_0x16d3fa(0x1fa)},'storage':{'$first':_0x16d3fa(0x1f1)},'rack':{'$first':_0x16d3fa(0x282)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x16d3fa(0x218)},'batch_code':{'$first':_0x16d3fa(0x1e4)},'room':{'$first':_0x16d3fa(0x237)}}}]);if(_0x11c463[0x0][_0x16d3fa(0x1e0)]=='English\x20(US)'){var _0x2ab79d=users[_0x16d3fa(0x22a)];console['log'](_0x2ab79d);}else{if(_0x11c463[0x0][_0x16d3fa(0x1e0)]==_0x16d3fa(0x1f4))var _0x2ab79d=users['Hindi'];else{if(_0x11c463[0x0][_0x16d3fa(0x1e0)]==_0x16d3fa(0x287))var _0x2ab79d=users['German'];else{if(_0x11c463[0x0][_0x16d3fa(0x1e0)]==_0x16d3fa(0x211))var _0x2ab79d=users[_0x16d3fa(0x211)];else{if(_0x11c463[0x0][_0x16d3fa(0x1e0)]==_0x16d3fa(0x1ed))var _0x2ab79d=users[_0x16d3fa(0x1ed)];else{if(_0x11c463[0x0][_0x16d3fa(0x1e0)]=='Portuguese\x20(BR)')var _0x2ab79d=users[_0x16d3fa(0x24a)];else{if(_0x11c463[0x0]['language']==_0x16d3fa(0x2a5))var _0x2ab79d=users['Chinese'];else{if(_0x11c463[0x0][_0x16d3fa(0x1e0)]==_0x16d3fa(0x246))var _0x2ab79d=users['Arabic'];}}}}}}}_0x2c26db[_0x16d3fa(0x299)]('edit_adjustment_view',{'success':_0x417b23[_0x16d3fa(0x28e)](_0x16d3fa(0x215)),'errors':_0x417b23[_0x16d3fa(0x28e)]('errors'),'role':_0x9bd1ae,'profile':_0x4105ba,'adjustment':_0xc0a49d,'stock':_0x1f7d28,'master_shop':_0x11c463,'warehouse_name':_0x4995ce,'unit':_0x3a2dd3,'language':_0x2ab79d});}catch(_0x112215){console[_0x16d3fa(0x21c)](_0x112215),_0x2c26db[_0x16d3fa(0x201)](0xc8)[_0x16d3fa(0x293)]({'message':_0x112215[_0x16d3fa(0x284)]});}}),router['post'](a0_0x3a0373(0x262),auth,async(_0x2ff342,_0x47a49c)=>{var _0x31dcbf=a0_0x3a0373;try{const _0x580d9a=_0x2ff342[_0x31dcbf(0x27f)]['id'],{warehouse_name:_0x414b43,Room_name:_0x43c93c}=_0x2ff342[_0x31dcbf(0x1d6)],_0x170fdf=await adjustment[_0x31dcbf(0x1fe)]({'_id':_0x580d9a}),_0xc0a667=_0x170fdf[_0x31dcbf(0x273)]['map'](async _0x4443a6=>{var _0x19d0d9=_0x31dcbf;if(_0x4443a6['adjust_qty']>0x0){var _0x48e466=await warehouse[_0x19d0d9(0x251)]({'name':_0x414b43,'room':_0x4443a6['room_names'],'warehouse_category':'Raw\x20Materials'});const _0x4994a7=_0x48e466[_0x19d0d9(0x1ea)][_0x19d0d9(0x294)](_0x372926=>{var _0x48af82=_0x19d0d9;if(_0x4443a6[_0x48af82(0x22c)]=='minus'){if(_0x372926['product_name']==_0x4443a6[_0x48af82(0x24d)]&&_0x372926[_0x48af82(0x277)]==_0x4443a6[_0x48af82(0x277)]&&_0x372926[_0x48af82(0x22c)]==_0x4443a6['type']&&_0x372926['bin']==_0x4443a6[_0x48af82(0x1e8)]&&_0x372926['bay']==_0x4443a6[_0x48af82(0x242)]&&_0x372926[_0x48af82(0x23d)]==_0x4443a6[_0x48af82(0x23d)]&&_0x372926['storage']==_0x4443a6['storage']&&_0x372926['expiry_date']==_0x4443a6[_0x48af82(0x1d8)]&&_0x372926[_0x48af82(0x243)]==_0x4443a6[_0x48af82(0x243)]&&_0x372926[_0x48af82(0x26a)]==_0x4443a6['production_date']&&_0x372926['invoice']==_0x4443a6['invoice']){var _0x50918f;_0x50918f=_0x4443a6[_0x48af82(0x206)],_0x4443a6[_0x48af82(0x214)]=='S'&&(_0x50918f=_0x4443a6[_0x48af82(0x206)]),_0x372926[_0x48af82(0x1fd)]=_0x372926[_0x48af82(0x1fd)]-_0x50918f;}}else{if(_0x372926[_0x48af82(0x24d)]==_0x4443a6[_0x48af82(0x24d)]&&_0x372926[_0x48af82(0x277)]==_0x4443a6[_0x48af82(0x277)]&&_0x372926[_0x48af82(0x22c)]==_0x4443a6[_0x48af82(0x22c)]&&_0x372926[_0x48af82(0x1e8)]==_0x4443a6[_0x48af82(0x1e8)]&&_0x372926['bay']==_0x4443a6[_0x48af82(0x242)]&&_0x372926['rack']==_0x4443a6['rack']&&_0x372926[_0x48af82(0x29c)]==_0x4443a6[_0x48af82(0x29c)]&&_0x372926[_0x48af82(0x1d8)]==_0x4443a6[_0x48af82(0x1d8)]&&_0x372926[_0x48af82(0x243)]==_0x4443a6['batch_code']&&_0x372926['production_date']==_0x4443a6['production_date']&&_0x372926[_0x48af82(0x245)]==_0x4443a6[_0x48af82(0x245)]){console['log'](_0x4443a6);var _0x50918f;_0x50918f=_0x4443a6[_0x48af82(0x206)],_0x4443a6['prod_cat']=='S'&&(_0x50918f=_0x4443a6[_0x48af82(0x206)]),console[_0x48af82(0x21c)](_0x50918f+_0x48af82(0x240)+_0x4443a6[_0x48af82(0x206)]+'\x20<>\x20'+_0x372926[_0x48af82(0x248)]+'\x20<>\x20'+_0x4443a6[_0x48af82(0x214)]),_0x372926[_0x48af82(0x1fd)]=_0x372926[_0x48af82(0x1fd)]+_0x50918f;}}});}return _0x48e466;});Promise[_0x31dcbf(0x23b)](_0xc0a667)[_0x31dcbf(0x29e)](async _0x2b0fa9=>{var _0x123078=_0x31dcbf;try{for(const _0x2fce3b of _0x2b0fa9){await _0x2fce3b[_0x123078(0x22f)]();}_0x170fdf[_0x123078(0x21f)]='True';const _0x293e6e=await _0x170fdf[_0x123078(0x22f)](),_0x1107a2=await master_shop['find'](),_0x5c3d9c=await email_settings[_0x123078(0x251)](),_0x5d87e8=await supervisor_settings[_0x123078(0x285)]();var _0x4cfff4=_0x170fdf['product'],_0x5c3bc3='',_0x431730;for(_0x431730 in _0x4cfff4){_0x5c3bc3+=_0x123078(0x209)+_0x123078(0x271)+_0x4cfff4[_0x431730][_0x123078(0x24d)]+_0x123078(0x25d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4cfff4[_0x431730][_0x123078(0x28b)]+'</td>'+_0x123078(0x271)+_0x4cfff4[_0x431730]['adjust_qty']+'</td>'+_0x123078(0x271)+_0x4cfff4[_0x431730][_0x123078(0x253)]+_0x123078(0x25d)+_0x123078(0x271)+_0x4cfff4[_0x431730]['secondary_unit']+_0x123078(0x25d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x170fdf[_0x123078(0x254)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4cfff4[_0x431730][_0x123078(0x20c)]+_0x123078(0x25d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4cfff4[_0x431730]['storage']+_0x4cfff4[_0x431730][_0x123078(0x23d)]+_0x4cfff4[_0x431730][_0x123078(0x242)]+_0x4cfff4[_0x431730][_0x123078(0x1e8)]+_0x4cfff4[_0x431730]['type'][0x0]+_0x4cfff4[_0x431730][_0x123078(0x277)]+_0x123078(0x25d),_0x123078(0x219);}let _0x4f9064=nodemailer[_0x123078(0x212)]({'host':_0x5c3d9c[_0x123078(0x1e6)],'port':Number(_0x5c3d9c[_0x123078(0x28a)]),'secure':![],'auth':{'user':_0x5c3d9c[_0x123078(0x229)],'pass':_0x5c3d9c['password']}}),_0x133bcb={'from':_0x5c3d9c[_0x123078(0x229)],'to':_0x5d87e8[0x0][_0x123078(0x269)],'subject':_0x123078(0x295),'attachments':[{'filename':_0x123078(0x23f),'path':__dirname+'/../public'+'/upload/'+_0x1107a2[0x0]['image'],'cid':_0x123078(0x233)}],'html':_0x123078(0x25f)+_0x123078(0x272)+_0x123078(0x286)+_0x123078(0x23c)+_0x123078(0x223)+_0x123078(0x23c)+_0x123078(0x2a4)+_0x123078(0x247)+'<div>'+_0x123078(0x227)+_0x1107a2[0x0]['site_title']+_0x123078(0x202)+_0x123078(0x247)+_0x123078(0x247)+_0x123078(0x297)+_0x123078(0x23c)+_0x123078(0x244)+_0x123078(0x283)+_0x170fdf[_0x123078(0x245)]+'\x20'+_0x123078(0x26b)+_0x123078(0x1db)+_0x170fdf[_0x123078(0x20b)]+'\x20'+_0x123078(0x204)+'</h5>'+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x123078(0x21b)+_0x123078(0x209)+_0x123078(0x28f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x123078(0x264)+_0x123078(0x2a3)+_0x123078(0x236)+_0x123078(0x1dd)+_0x123078(0x1da)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+_0x123078(0x238)+_0x123078(0x27d)+'\x20'+_0x5c3bc3+'\x20'+_0x123078(0x1f2)+_0x123078(0x29f)+'<div>'+_0x123078(0x259)+'<h5>'+_0x1107a2[0x0][_0x123078(0x235)]+'</h5>'+_0x123078(0x247)+_0x123078(0x247)+_0x123078(0x25e)};_0x4f9064[_0x123078(0x1e2)](_0x133bcb,function(_0x5bb931,_0x5412b9){var _0x1f0b81=_0x123078;_0x5bb931?(console['log'](_0x5bb931),console['log'](_0x1f0b81(0x20e))):console[_0x1f0b81(0x21c)]('Email\x20sent\x20successfully');}),_0x2ff342[_0x123078(0x28e)]('success',_0x123078(0x252)),_0x47a49c['redirect']('/picking_list/PDF_adjustment_rm/'+_0x293e6e[_0x123078(0x21e)]);}catch(_0x146b12){console[_0x123078(0x241)](_0x146b12),_0x47a49c[_0x123078(0x201)](0x1f4)[_0x123078(0x293)]({'error':_0x123078(0x20f)});}})[_0x31dcbf(0x1f8)](_0x142670=>{var _0x4bd269=_0x31dcbf;console['error'](_0x142670),_0x47a49c[_0x4bd269(0x201)](0x1f4)[_0x4bd269(0x293)]({'error':'An\x20error\x20occurred.'});});}catch(_0x44309a){console['log'](_0x44309a),_0x47a49c['status'](0xc8)['json']({'message':_0x44309a[_0x31dcbf(0x284)]});}}),router[a0_0x3a0373(0x200)]('/view/:id',auth,async(_0x13500b,_0x553bc2)=>{var _0x5c1c36=a0_0x3a0373;try{const {username:_0x15477c,email:_0x469344,role:_0xcd36cf}=_0x13500b['user'],_0x2fa5e5=_0x13500b['user'],_0xd5c22a=await profile['findOne']({'email':_0x2fa5e5[_0x5c1c36(0x229)]}),_0x3c8249=await master_shop['find'](),_0x319ddd=_0x13500b[_0x5c1c36(0x27f)]['id'],_0x1bf187=await adjustment[_0x5c1c36(0x1fe)]({'_id':_0x319ddd}),_0x97246e=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1bf187[_0x5c1c36(0x254)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5c1c36(0x207)}}]),_0x5435d8=await product[_0x5c1c36(0x285)]({}),_0x2b19ca=await warehouse[_0x5c1c36(0x1de)]([{'$match':{'name':_0x1bf187['warehouse_name']}},{'$unwind':_0x5c1c36(0x26f)},{'$group':{'_id':_0x5c1c36(0x1f7),'name':{'$first':_0x5c1c36(0x1d9)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5c1c36(0x1ff)},'bin':{'$first':_0x5c1c36(0x27c)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5c1c36(0x216)},'primary_code':{'$first':_0x5c1c36(0x232)},'secondary_code':{'$first':_0x5c1c36(0x275)},'product_code':{'$first':_0x5c1c36(0x1fa)},'storage':{'$first':_0x5c1c36(0x1f1)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x5c1c36(0x1d7)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5c1c36(0x218)},'batch_code':{'$first':_0x5c1c36(0x1e4)},'room':{'$first':_0x5c1c36(0x237)}}}]);let _0x502d5e;if(_0x2fa5e5['role']=='staff'){const _0x376004=await staff[_0x5c1c36(0x251)]({'email':_0x2fa5e5[_0x5c1c36(0x229)]});_0x502d5e=await warehouse[_0x5c1c36(0x1de)]([{'$match':{'status':_0x5c1c36(0x231),'name':_0x376004[_0x5c1c36(0x270)],'warehouse_category':_0x5c1c36(0x26e),'name':{'$ne':_0x5c1c36(0x288)}}},{'$group':{'_id':'$name','name':{'$first':_0x5c1c36(0x27a)}}}]);}else _0x502d5e=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x5c1c36(0x26e),'name':{'$ne':_0x5c1c36(0x288)}}},{'$group':{'_id':_0x5c1c36(0x27a),'name':{'$first':_0x5c1c36(0x27a)}}}]);if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]==_0x5c1c36(0x1e3)){var _0x199cbc=users[_0x5c1c36(0x22a)];console[_0x5c1c36(0x21c)](_0x199cbc);}else{if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]=='Hindi')var _0x199cbc=users['Hindi'];else{if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]==_0x5c1c36(0x287))var _0x199cbc=users[_0x5c1c36(0x287)];else{if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]==_0x5c1c36(0x211))var _0x199cbc=users[_0x5c1c36(0x211)];else{if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]==_0x5c1c36(0x1ed))var _0x199cbc=users[_0x5c1c36(0x1ed)];else{if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]==_0x5c1c36(0x1eb))var _0x199cbc=users['Portuguese'];else{if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]==_0x5c1c36(0x2a5))var _0x199cbc=users['Chinese'];else{if(_0x3c8249[0x0][_0x5c1c36(0x1e0)]==_0x5c1c36(0x246))var _0x199cbc=users[_0x5c1c36(0x29d)];}}}}}}}_0x553bc2['render']('edit_adjustment',{'success':_0x13500b[_0x5c1c36(0x28e)](_0x5c1c36(0x215)),'errors':_0x13500b[_0x5c1c36(0x28e)](_0x5c1c36(0x224)),'role':_0x2fa5e5,'profile':_0xd5c22a,'adjustment':_0x1bf187,'stock':_0x2b19ca,'master_shop':_0x3c8249,'warehouse_name':_0x97246e,'unit':_0x5435d8,'language':_0x199cbc,'warehouse':_0x502d5e});}catch(_0x4e6120){console[_0x5c1c36(0x21c)](_0x4e6120),_0x553bc2[_0x5c1c36(0x201)](0xc8)[_0x5c1c36(0x293)]({'message':_0x4e6120[_0x5c1c36(0x284)]});}}),router[a0_0x3a0373(0x29b)](a0_0x3a0373(0x239),auth,async(_0x4c240d,_0xdd2713)=>{var _0x150b59=a0_0x3a0373;try{const _0x58e916=_0x4c240d[_0x150b59(0x27f)]['id'],_0x4ee236=await adjustment[_0x150b59(0x1fe)]({'_id':_0x58e916}),_0x48ee1f=await warehouse[_0x150b59(0x251)]({'name':_0x4ee236[_0x150b59(0x254)],'room':_0x4ee236[_0x150b59(0x20d)]}),{warehouse_name:_0x4a9260,date:_0x2a09fb,prod_name:_0x11ca95,level:_0x12d77e,isle:_0x290771,pallet:_0x47ec04,stock:_0x3b629b,types:_0x258c07,adjust_qty:_0x4de6c8,new_adjust_qty:_0xff37eb,note:_0xd7b73,Room_name:_0x31d4bf,invoice:_0x33ff65,JO_number:_0x3a495f,expiry_date:_0x208fce}=_0x4c240d[_0x150b59(0x1d6)];if(typeof _0x11ca95=='string')var _0x129ca9=[_0x4c240d['body'][_0x150b59(0x1ee)]],_0x5d1329=[_0x4c240d[_0x150b59(0x1d6)]['level']],_0x6e3063=[_0x4c240d['body'][_0x150b59(0x1e7)]],_0x27368c=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x27b)]],_0x3697ee=[_0x4c240d['body'][_0x150b59(0x25c)]],_0x297174=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x1ec)]],_0x19a147=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x298)]],_0x4f7dc9=[_0x4c240d[_0x150b59(0x1d6)]['Secondary_units']],_0x312ca6=[_0x4c240d['body'][_0x150b59(0x26c)]],_0x1274d8=[_0x4c240d['body']['batch_code']],_0x42fdf9=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x1d8)]],_0x3dbaa7=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x24b)]],_0x34e1be=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x26a)]],_0x37e8e8=[_0x4c240d['body'][_0x150b59(0x214)]],_0x443779=[_0x4c240d[_0x150b59(0x1d6)]['Rooms']],_0x59d06d=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x1dc)]],_0x3934c1=[_0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x28c)]];else var _0x129ca9=[..._0x4c240d['body'][_0x150b59(0x1ee)]],_0x5d1329=[..._0x4c240d['body'][_0x150b59(0x279)]],_0x6e3063=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x1e7)]],_0x27368c=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x27b)]],_0x3697ee=[..._0x4c240d['body'][_0x150b59(0x25c)]],_0x297174=[..._0x4c240d[_0x150b59(0x1d6)]['New_Qty_Converted']],_0x19a147=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x253)]],_0x4f7dc9=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x1e1)]],_0x312ca6=[..._0x4c240d[_0x150b59(0x1d6)]['prod_code']],_0x1274d8=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x243)]],_0x42fdf9=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x1d8)]],_0x3dbaa7=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x24b)]],_0x34e1be=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x26a)]],_0x37e8e8=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x214)]],_0x443779=[..._0x4c240d['body']['Rooms']],_0x59d06d=[..._0x4c240d['body']['prime1']],_0x3934c1=[..._0x4c240d[_0x150b59(0x1d6)][_0x150b59(0x28c)]];const _0x3175aa=_0x129ca9['map'](_0x519d21=>{return _0x519d21={'product_name':_0x519d21};});_0x5d1329['forEach']((_0x3bb347,_0x45268d)=>{var _0x41be4b=_0x150b59;_0x443779[_0x41be4b(0x22b)]((_0x10cd6b,_0x44047a)=>{var _0x356c5e=_0x41be4b;if(_0x10cd6b=='Receiving\x20Area'&&_0x45268d==_0x44047a){var _0x29747d=_0x3bb347[_0x356c5e(0x260)](0x3);_0x3175aa[_0x45268d]['storage']=_0x3bb347[0x0],_0x3175aa[_0x45268d][_0x356c5e(0x23d)]=_0x3bb347[0x1],_0x3175aa[_0x45268d][_0x356c5e(0x242)]=0x0,_0x3175aa[_0x45268d][_0x356c5e(0x1e8)]=0x0,_0x3175aa[_0x45268d][_0x356c5e(0x22c)]='Floor',_0x3175aa[_0x45268d][_0x356c5e(0x277)]=_0x29747d;}else{if(_0x10cd6b=='Shelves'&&_0x45268d==_0x44047a){var _0x29747d=_0x3bb347[_0x356c5e(0x260)](0x3);_0x3175aa[_0x45268d][_0x356c5e(0x29c)]=_0x3bb347[0x0],_0x3175aa[_0x45268d]['rack']=_0x3bb347[0x1],_0x3175aa[_0x45268d][_0x356c5e(0x242)]=0x0,_0x3175aa[_0x45268d][_0x356c5e(0x1e8)]=0x0,_0x3175aa[_0x45268d]['type']=_0x356c5e(0x1f9),_0x3175aa[_0x45268d]['floorlevel']=_0x3bb347[0x5];}else{if(_0x45268d==_0x44047a){var _0x37044f;if(_0x3bb347[0x4]=='L')_0x37044f=_0x356c5e(0x24e);else _0x3bb347[0x4]=='F'&&(_0x37044f=_0x356c5e(0x1f9));_0x3175aa[_0x45268d][_0x356c5e(0x29c)]=_0x3bb347[0x0],_0x3175aa[_0x45268d][_0x356c5e(0x23d)]=_0x3bb347[0x1],_0x3175aa[_0x45268d][_0x356c5e(0x242)]=_0x3bb347[0x2],_0x3175aa[_0x45268d][_0x356c5e(0x1e8)]=_0x3bb347[0x3],_0x3175aa[_0x45268d]['type']=_0x37044f,_0x3175aa[_0x45268d][_0x356c5e(0x277)]=_0x3bb347[0x5];}}}});}),_0x6e3063[_0x150b59(0x22b)]((_0x48e8cf,_0xf9e5ef)=>{var _0x5be51b=_0x150b59;_0x3175aa[_0xf9e5ef][_0x5be51b(0x1ef)]=_0x48e8cf;}),_0x27368c[_0x150b59(0x22b)]((_0x54d6f5,_0x1faa3d)=>{var _0xbd416b=_0x150b59;_0x3175aa[_0x1faa3d][_0xbd416b(0x27b)]=_0x54d6f5;}),_0x3697ee[_0x150b59(0x22b)]((_0x3b91fe,_0x57d3d6)=>{var _0x7e169e=_0x150b59;_0x3175aa[_0x57d3d6][_0x7e169e(0x206)]=_0x3b91fe;}),_0x297174[_0x150b59(0x22b)]((_0x324553,_0x5d13d6)=>{var _0x591710=_0x150b59;_0x3175aa[_0x5d13d6][_0x591710(0x234)]=_0x324553;}),_0x19a147[_0x150b59(0x22b)]((_0x35673a,_0xc31594)=>{var _0x38747d=_0x150b59;_0x3175aa[_0xc31594][_0x38747d(0x253)]=_0x35673a;}),_0x4f7dc9['forEach']((_0x4e2106,_0x321444)=>{var _0x42122a=_0x150b59;_0x3175aa[_0x321444][_0x42122a(0x20a)]=_0x4e2106;}),_0x312ca6[_0x150b59(0x22b)]((_0xa21206,_0xbd88ca)=>{var _0x25f8ba=_0x150b59;_0x3175aa[_0xbd88ca][_0x25f8ba(0x28b)]=_0xa21206;}),_0x1274d8[_0x150b59(0x22b)]((_0x287321,_0x58d1ad)=>{var _0x4a030c=_0x150b59;_0x3175aa[_0x58d1ad][_0x4a030c(0x243)]=_0x287321;}),_0x42fdf9['forEach']((_0x17d840,_0x283183)=>{var _0x10b3c5=_0x150b59;_0x3175aa[_0x283183][_0x10b3c5(0x1d8)]=_0x17d840;}),_0x3dbaa7[_0x150b59(0x22b)]((_0x567244,_0x6a8eae)=>{var _0x2db33b=_0x150b59;_0x3175aa[_0x6a8eae][_0x2db33b(0x24f)]=_0x567244;}),_0x34e1be[_0x150b59(0x22b)]((_0xb0d9dd,_0xa8a2dc)=>{_0x3175aa[_0xa8a2dc]['production_date']=_0xb0d9dd;}),_0x37e8e8[_0x150b59(0x22b)]((_0x463680,_0x3f629c)=>{var _0x1cb3ea=_0x150b59;_0x3175aa[_0x3f629c][_0x1cb3ea(0x214)]=_0x463680;}),_0x443779[_0x150b59(0x22b)]((_0x1f2f86,_0x19404c)=>{var _0x37e486=_0x150b59;_0x3175aa[_0x19404c][_0x37e486(0x20c)]=_0x1f2f86;}),_0x59d06d[_0x150b59(0x22b)]((_0x37a1d1,_0x240453)=>{_0x3175aa[_0x240453]['primary_code']=_0x37a1d1;}),_0x3934c1[_0x150b59(0x22b)]((_0x47da5b,_0x48a363)=>{var _0x4d54b9=_0x150b59;_0x3175aa[_0x48a363][_0x4d54b9(0x222)]=_0x47da5b;});const _0x228d33=_0x3175aa['filter'](_0x1872cc=>_0x1872cc[_0x150b59(0x206)]!=='0'&&_0x1872cc['adjust_qty']!=='');var _0x53fccd=0x0;_0x228d33[_0x150b59(0x22b)](_0x1083f0=>{var _0x5c6597=_0x150b59;console[_0x5c6597(0x21c)](_0x5c6597(0x1f0),_0x1083f0),parseInt(_0x1083f0[_0x5c6597(0x206)])<=0x0&&_0x53fccd++;});if(_0x53fccd!=0x0)return _0x4c240d[_0x150b59(0x28e)](_0x150b59(0x224),_0x150b59(0x1df)),_0xdd2713[_0x150b59(0x225)](_0x150b59(0x220));_0x4ee236[_0x150b59(0x254)]=_0x4a9260,_0x4ee236[_0x150b59(0x20b)]=_0x2a09fb,_0x4ee236['product']=_0x228d33,_0x4ee236[_0x150b59(0x24c)]=_0xd7b73,_0x4ee236[_0x150b59(0x245)]=_0x33ff65,_0x4ee236[_0x150b59(0x265)]='False';const _0x169524=await _0x4ee236[_0x150b59(0x22f)]();_0x4c240d[_0x150b59(0x28e)](_0x150b59(0x215),'adjustment\x20data\x20update\x20successfully'),_0xdd2713[_0x150b59(0x225)](_0x150b59(0x291));}catch(_0x5eec79){console[_0x150b59(0x21c)](_0x5eec79);}}),router[a0_0x3a0373(0x29b)](a0_0x3a0373(0x292),async(_0x4e738f,_0x54d471)=>{var _0x4b0b20=a0_0x3a0373;const {primary_code:_0x33999c,warehouse_data:_0x51345e,rooms_data:_0x3123ab,Roomslist:_0x4adc9a}=_0x4e738f['body'],_0x539a2c=_0x4adc9a[_0x4b0b20(0x210)](','),_0x3ea9de=[];async function _0x5a38d8(_0x9deb8){var _0x58d8d9=_0x4b0b20;const _0x163e1c=await warehouse[_0x58d8d9(0x1de)]([{'$match':{'name':_0x51345e,'room':_0x9deb8}},{'$unwind':_0x58d8d9(0x26f)},{'$match':{'product_details.primary_code':_0x33999c}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x58d8d9(0x1d9)},'product_stock':{'$first':_0x58d8d9(0x228)},'primary_code':{'$first':_0x58d8d9(0x232)},'secondary_code':{'$first':_0x58d8d9(0x275)},'product_code':{'$first':_0x58d8d9(0x1fa)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x58d8d9(0x27c)},'type':{'$first':_0x58d8d9(0x22d)},'pallet':{'$first':_0x58d8d9(0x216)},'unit':{'$first':_0x58d8d9(0x2a1)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x58d8d9(0x1f1)},'rack':{'$first':_0x58d8d9(0x282)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x58d8d9(0x218)},'maxPerUnit':{'$first':_0x58d8d9(0x1d7)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x58d8d9(0x263)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x58d8d9(0x237)}}}]),_0x36929f=await warehouse[_0x58d8d9(0x1de)]([{'$match':{'name':_0x51345e,'room':_0x9deb8}},{'$unwind':_0x58d8d9(0x26f)},{'$match':{'product_details.secondary_code':_0x33999c}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x58d8d9(0x1d9)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x58d8d9(0x232)},'secondary_code':{'$first':_0x58d8d9(0x275)},'product_code':{'$first':_0x58d8d9(0x1fa)},'level':{'$first':_0x58d8d9(0x1ff)},'isle':{'$first':_0x58d8d9(0x27c)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x58d8d9(0x216)},'unit':{'$first':_0x58d8d9(0x2a1)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x58d8d9(0x1f1)},'rack':{'$first':_0x58d8d9(0x282)},'expiry_date':{'$first':_0x58d8d9(0x2a7)},'production_date':{'$first':_0x58d8d9(0x218)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x58d8d9(0x1e4)},'product_cat':{'$first':_0x58d8d9(0x263)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x58d8d9(0x237)}}}]);if(_0x163e1c[_0x58d8d9(0x257)]>0x0)_0x3ea9de[_0x58d8d9(0x2a0)](_0x163e1c);else _0x36929f['length']>0x0&&_0x3ea9de[_0x58d8d9(0x2a0)](_0x36929f);}const _0x55d8ff=_0x539a2c[_0x4b0b20(0x294)](_0x297e34=>_0x5a38d8(_0x297e34));await Promise[_0x4b0b20(0x23b)](_0x55d8ff),_0x54d471[_0x4b0b20(0x293)](_0x3ea9de);}),router[a0_0x3a0373(0x29b)](a0_0x3a0373(0x296),async(_0x23f836,_0x1f2c80)=>{var _0x359cf5=a0_0x3a0373;const {primaryCode:_0x21c9e4,secondaryCode:_0x3f2234,productCode:_0x30bd0e,level:_0x529fb4,isle:_0x3b261e,pallet:_0x12e13f,warehouses:_0x3d4e81,room:_0x13fd9b}=_0x23f836[_0x359cf5(0x1d6)];try{const _0x185e96=await warehouse[_0x359cf5(0x1de)]([{'$match':{'name':_0x3d4e81,'room':_0x13fd9b}},{'$unwind':_0x359cf5(0x26f)},{'$match':{'product_details.level':parseInt(_0x529fb4),'product_details.isle':_0x3b261e,'product_details.pallet':parseInt(_0x12e13f)}},{'$group':{'_id':_0x359cf5(0x1f7),'name':{'$first':_0x359cf5(0x1d9)},'product_stock':{'$first':_0x359cf5(0x228)},'level':{'$first':_0x359cf5(0x267)},'isle':{'$first':_0x359cf5(0x280)},'pallet':{'$first':_0x359cf5(0x25b)},'maxProducts':{'$first':_0x359cf5(0x1f6)}}}]);_0x1f2c80[_0x359cf5(0x201)](0xc8)[_0x359cf5(0x293)](_0x185e96);}catch(_0x2afca0){_0x1f2c80[_0x359cf5(0x201)](0x194)[_0x359cf5(0x293)]({'message':_0x2afca0[_0x359cf5(0x284)]});}}),module[a0_0x3a0373(0x276)]=router;