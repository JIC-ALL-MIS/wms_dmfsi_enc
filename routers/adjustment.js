function a0_0x3076(_0x391fae,_0x3a95ed){var _0x2b2ee0=a0_0x2b2e();return a0_0x3076=function(_0x307656,_0x17916b){_0x307656=_0x307656-0x173;var _0x140bca=_0x2b2ee0[_0x307656];return _0x140bca;},a0_0x3076(_0x391fae,_0x3a95ed);}var a0_0x340bf0=a0_0x3076;(function(_0x563f0e,_0x52ae9f){var _0x7d91f4=a0_0x3076,_0x8715a9=_0x563f0e();while(!![]){try{var _0x3a17c2=parseInt(_0x7d91f4(0x215))/0x1+-parseInt(_0x7d91f4(0x1df))/0x2+parseInt(_0x7d91f4(0x241))/0x3+parseInt(_0x7d91f4(0x19b))/0x4*(-parseInt(_0x7d91f4(0x204))/0x5)+parseInt(_0x7d91f4(0x1a7))/0x6*(parseInt(_0x7d91f4(0x23c))/0x7)+parseInt(_0x7d91f4(0x1d6))/0x8+parseInt(_0x7d91f4(0x1e6))/0x9*(-parseInt(_0x7d91f4(0x1bb))/0xa);if(_0x3a17c2===_0x52ae9f)break;else _0x8715a9['push'](_0x8715a9['shift']());}catch(_0x5151ea){_0x8715a9['push'](_0x8715a9['shift']());}}}(a0_0x2b2e,0x8b8bd));const express=require(a0_0x340bf0(0x1f5)),app=express(),router=express[a0_0x340bf0(0x23b)](),auth=require(a0_0x340bf0(0x17c)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x340bf0(0x17f)),users=require(a0_0x340bf0(0x242)),nodemailer=require(a0_0x340bf0(0x1ea));function a0_0x2b2e(){var _0x20b18d=['$product_details.product_stock','prod_name','$product_details.floorlevel','<h5\x20style=\x22text-align:\x20left;\x22>','New_Qty_Converted_adj','Floor','Shelves','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','6PORikq','An\x20error\x20occurred.','findOne','</tbody>','Enabled','flash','maxperunit','Enclosed','floorlevel','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<tr>','<h5>','RMSEmail','$_id','Portuguese','$name','error','unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','1060isUabq','all','host','padStart','$isAllowEdit','Receiving\x20Area','bay','Arabic\x20(ae)','primary_code','True','finalize','_id','secondary_unit','date','prime1','</h5>','logo','add_adjustment','/../public','random','prod_cat','push','/barcode_scanner','/adjustment/preview/','An\x20error\x20occurred\x20while\x20saving\x20data.','Ambient','foreach\x20newproduct','2572216ZBYWdQ','new_adjust_qty','<strong>\x20Regards\x20</strong>','image','floor','English\x20(US)','</div>','language','$date','307826nVuOOd','</span>','rack','Email\x20sent\x20successfully','Raw\x20Materials','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','length','11916cSWtfM','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.primary_code','nodemailer','product_stock','$product_details.bin','<html><head><title></title>','email','$product','id_transaction_from','$product_details.storage','get','batch_code','/picking_list/PDF_adjustment_rm/','express','<!DOCTYPE\x20html>','New_Qty_Converted','save','catch','$product_details.product_name','\x20Order\x20Date\x20:\x20','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','storage','<hr\x20class=\x22my-3\x22>','</tr>','Logo.png','findById','edit_adjustment_view','Hindi','311380Isydoh','product','\x20Order\x20Number\x20:\x20','Return\x20Goods','adjustment\x20Finalized\x20successfully','$product_details._id','back','$room','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.expiry_date','prod_code','aggregate','False','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','adjustment\x20data\x20update\x20successfully','632889SulLJu','max_per_unit','French','stockBefore','type','forEach','log','password','exports','bin','Error\x20Occurs','types','adjustment','/view/add_adjustment','secondary_code','message','$product_details.batch_code','product_code','stock','site_title','id_transaction','redirect','\x20</h2>','\x20<>\x20','find','sendMail','success','Chinese','Return\x20Rooms','</head><body>','English','Spanish','string','staff','product_name','room_names','json','$product.product_name','Router','3630823Cnbomf','post','$product_details.maxPerUnit','$product_details.product_cat','$product_details.secondary_code','233307fDNMAe','../public/language/languages.json','$invoice','adjust_qty','$product_details.production_date','</thead>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','status','room','slice','warehouse','note','invoice','edit_adjustment','Rooms','errors','Primary_Units','Level','<h2>\x20','user','$product_details.product_code','/preview/:id','German','../middleware/auth','prod_invoice','second1','../models/all_models','<div>','render','/view/:id','$warehouse_name','$product_details','Secondary_units','$product_details.level','split','body','master','production_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.rack','/upload/','filter','$product_details.secondary_unit','params','expiry_date','warehouse_name','$product_details.isle','then','ADJ-','role','createTransport','level','isAllowEdit','$product_details.type','44aQFveZ','Adjustment\x20Mail','map'];a0_0x2b2e=function(){return _0x20b18d;};return a0_0x2b2e();}router[a0_0x340bf0(0x1f2)]('/view',auth,async(_0x2d1bbe,_0x5eb49)=>{var _0x27cfe1=a0_0x340bf0;try{const {username:_0x4c5d29,email:_0x245ac5,role:_0x1fbaf9}=_0x2d1bbe[_0x27cfe1(0x178)],_0x1ba717=_0x2d1bbe[_0x27cfe1(0x178)],_0x789e0=await profile[_0x27cfe1(0x1a9)]({'email':_0x1ba717['email']}),_0x20c2a2=await master_shop[_0x27cfe1(0x22d)]();console[_0x27cfe1(0x21b)](_0x27cfe1(0x189),_0x20c2a2);let _0x531132;if(_0x1ba717[_0x27cfe1(0x196)]==_0x27cfe1(0x236)){const _0x2b57ef=await staff[_0x27cfe1(0x1a9)]({'email':_0x1ba717['email']});_0x531132=await warehouse[_0x27cfe1(0x22d)]({'status':_0x27cfe1(0x1ab),'name':_0x2b57ef['warehouse']});}else _0x531132=await warehouse[_0x27cfe1(0x22d)]({'status':_0x27cfe1(0x1ab)});const _0x4c9cbb=await product[_0x27cfe1(0x22d)]();let _0x24f847;if(_0x1ba717[_0x27cfe1(0x196)]==_0x27cfe1(0x236)){const _0x3537ac=await staff[_0x27cfe1(0x1a9)]({'email':_0x1ba717['email']});_0x24f847=await adjustment[_0x27cfe1(0x22d)]({'warehouse_name':_0x3537ac[_0x27cfe1(0x24b)]});}else _0x24f847=await adjustment[_0x27cfe1(0x210)]([{'$unwind':_0x27cfe1(0x1ef)},{'$group':{'_id':_0x27cfe1(0x1b5),'invoice':{'$first':_0x27cfe1(0x243)},'date':{'$first':_0x27cfe1(0x1de)},'warehouse_name':{'$first':_0x27cfe1(0x183)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x27cfe1(0x1bf)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x20c2a2[0x0]['language']=='English\x20(US)'){var _0x295e9c=users[_0x27cfe1(0x233)];console['log'](_0x295e9c);}else{if(_0x20c2a2[0x0][_0x27cfe1(0x1dd)]==_0x27cfe1(0x203))var _0x295e9c=users[_0x27cfe1(0x203)];else{if(_0x20c2a2[0x0]['language']==_0x27cfe1(0x17b))var _0x295e9c=users['German'];else{if(_0x20c2a2[0x0][_0x27cfe1(0x1dd)]=='Spanish')var _0x295e9c=users['Spanish'];else{if(_0x20c2a2[0x0]['language']==_0x27cfe1(0x217))var _0x295e9c=users[_0x27cfe1(0x217)];else{if(_0x20c2a2[0x0]['language']==_0x27cfe1(0x1a5))var _0x295e9c=users[_0x27cfe1(0x1b6)];else{if(_0x20c2a2[0x0][_0x27cfe1(0x1dd)]==_0x27cfe1(0x230))var _0x295e9c=users[_0x27cfe1(0x230)];else{if(_0x20c2a2[0x0][_0x27cfe1(0x1dd)]=='Arabic\x20(ae)')var _0x295e9c=users[_0x27cfe1(0x20c)];}}}}}}}_0x5eb49['render'](_0x27cfe1(0x221),{'success':_0x2d1bbe['flash'](_0x27cfe1(0x22f)),'errors':_0x2d1bbe['flash']('errors'),'role':_0x1ba717,'profile':_0x789e0,'warehouse':_0x531132,'product':_0x4c9cbb,'adjustment':_0x24f847,'master_shop':_0x20c2a2,'language':_0x295e9c});}catch(_0x359a08){console[_0x27cfe1(0x21b)](_0x359a08);}});async function getRandom8DigitNumber(){var _0x1cc69d=a0_0x340bf0;const _0x11e0bb=0x989680,_0x4946a6=0x5f5e0ff,_0x3fddf0=Math[_0x1cc69d(0x1da)](Math[_0x1cc69d(0x1ce)]()*(_0x4946a6-_0x11e0bb+0x1))+_0x11e0bb;var _0x85e635;const _0x44c2b4=await adjustment[_0x1cc69d(0x1a9)]({'invoice':_0x1cc69d(0x195)+_0x3fddf0});return _0x44c2b4&&_0x44c2b4['length']>0x0?_0x85e635=_0x1cc69d(0x195)+_0x3fddf0:_0x85e635='ADJ-'+_0x3fddf0,_0x85e635;}router['get'](a0_0x340bf0(0x222),auth,async(_0x384b41,_0x2d255a)=>{var _0x1a9154=a0_0x340bf0;try{const {username:_0x3e105b,email:_0xd6c25c,role:_0x1f3472}=_0x384b41['user'],_0x5590de=_0x384b41[_0x1a9154(0x178)],_0x2014bc=await profile[_0x1a9154(0x1a9)]({'email':_0x5590de[_0x1a9154(0x1ee)]}),_0x49a6f5=await master_shop[_0x1a9154(0x22d)]();let _0x3635dd;if(_0x5590de[_0x1a9154(0x196)]==_0x1a9154(0x236)){const _0x16d8f9=await staff[_0x1a9154(0x1a9)]({'email':_0x5590de[_0x1a9154(0x1ee)]});_0x3635dd=await warehouse[_0x1a9154(0x210)]([{'$match':{'status':_0x1a9154(0x1ab),'name':_0x16d8f9[_0x1a9154(0x24b)],'warehouse_category':_0x1a9154(0x1e3),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x1a9154(0x1b7)}}}]);}else _0x3635dd=await warehouse[_0x1a9154(0x210)]([{'$match':{'status':_0x1a9154(0x1ab),'warehouse_category':_0x1a9154(0x1e3),'name':{'$ne':_0x1a9154(0x207)}}},{'$group':{'_id':_0x1a9154(0x1b7),'name':{'$first':_0x1a9154(0x1b7)}}}]);const _0x52b879=await product[_0x1a9154(0x22d)]({}),_0x541e62=await adjustment[_0x1a9154(0x22d)]({}),_0x381a8e=_0x541e62[_0x1a9154(0x1e5)]+0x1,_0x3053b5=_0x1a9154(0x195)+_0x381a8e['toString']()[_0x1a9154(0x1be)](0x5,'0');var _0x59c6bc=[_0x1a9154(0x1d4),_0x1a9154(0x1ae),_0x1a9154(0x231)];if(_0x49a6f5[0x0]['language']==_0x1a9154(0x1db))var _0x445334=users[_0x1a9154(0x233)];else{if(_0x49a6f5[0x0][_0x1a9154(0x1dd)]=='Hindi')var _0x445334=users['Hindi'];else{if(_0x49a6f5[0x0]['language']==_0x1a9154(0x17b))var _0x445334=users[_0x1a9154(0x17b)];else{if(_0x49a6f5[0x0][_0x1a9154(0x1dd)]==_0x1a9154(0x234))var _0x445334=users[_0x1a9154(0x234)];else{if(_0x49a6f5[0x0]['language']==_0x1a9154(0x217))var _0x445334=users[_0x1a9154(0x217)];else{if(_0x49a6f5[0x0][_0x1a9154(0x1dd)]==_0x1a9154(0x1a5))var _0x445334=users[_0x1a9154(0x1b6)];else{if(_0x49a6f5[0x0][_0x1a9154(0x1dd)]==_0x1a9154(0x230))var _0x445334=users[_0x1a9154(0x230)];else{if(_0x49a6f5[0x0][_0x1a9154(0x1dd)]==_0x1a9154(0x1c2))var _0x445334=users[_0x1a9154(0x20c)];}}}}}}}const _0x3c71ed=getRandom8DigitNumber();_0x3c71ed['then'](_0x29d0a6=>{var _0x44504d=_0x1a9154;_0x2d255a[_0x44504d(0x181)](_0x44504d(0x1cc),{'success':_0x384b41['flash'](_0x44504d(0x22f)),'errors':_0x384b41[_0x44504d(0x1ac)]('errors'),'role':_0x5590de,'profile':_0x2014bc,'warehouse':_0x3635dd,'product':_0x52b879,'master_shop':_0x49a6f5,'language':_0x445334,'rooms_data':_0x59c6bc,'invoice_no':_0x29d0a6});})['catch'](_0x548006=>{var _0xab133c=_0x1a9154;_0x384b41[_0xab133c(0x1ac)](_0xab133c(0x174),_0xab133c(0x1ba)),_0x2d255a[_0xab133c(0x22a)]('/adjustment/view');});}catch(_0x42fcdd){console[_0x1a9154(0x21b)](_0x42fcdd);}}),router['post'](a0_0x340bf0(0x222),auth,async(_0x283694,_0x4cee16)=>{var _0x597d3d=a0_0x340bf0;try{const {warehouse_name:_0x32ff85,date:_0x489de2,prod_name:_0x132645,level:_0x5e90f7,isle:_0x3baaba,pallet:_0x34f57b,stock:_0x167ea8,types:_0x369a74,adjust_qty:_0x34307c,new_adjust_qty:_0x163fb1,note:_0x409615,Room_name:_0x585469,invoice:_0x4d1e74,JO_number:_0x98247a,expiry_date:_0x1cbfed}=_0x283694[_0x597d3d(0x188)];if(typeof _0x132645==_0x597d3d(0x235))var _0x27d4f3=[_0x283694[_0x597d3d(0x188)]['prod_name']],_0x37379e=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x198)]],_0x7275fc=[_0x283694['body'][_0x597d3d(0x227)]],_0x3946c5=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x220)]],_0x34c69a=[_0x283694['body'][_0x597d3d(0x1a2)]],_0x1126fd=[_0x283694[_0x597d3d(0x188)]['New_Qty_Converted']],_0x45d26f=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x175)]],_0x531c60=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x185)]],_0x28b4cc=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x20f)]],_0x423f99=[_0x283694[_0x597d3d(0x188)]['batch_code']],_0x47ff90=[_0x283694['body'][_0x597d3d(0x191)]],_0x5474ec=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x216)]],_0x4baca2=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x18a)]],_0xdf2dcb=[_0x283694[_0x597d3d(0x188)]['prod_cat']],_0x3a781a=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x173)]],_0x568fc2=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x1c9)]],_0x453ce0=[_0x283694['body'][_0x597d3d(0x17e)]],_0x12543c=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x17d)]],_0x4f17c7=[_0x283694[_0x597d3d(0x188)][_0x597d3d(0x229)]];else var _0x27d4f3=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x19f)]],_0x37379e=[..._0x283694['body']['level']],_0x7275fc=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x227)]],_0x3946c5=[..._0x283694['body'][_0x597d3d(0x220)]],_0x34c69a=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x1a2)]],_0x1126fd=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x1f7)]],_0x45d26f=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x1b9)]],_0x531c60=[..._0x283694[_0x597d3d(0x188)]['Secondary_units']],_0x28b4cc=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x20f)]],_0x423f99=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x1f3)]],_0x47ff90=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x191)]],_0x5474ec=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x216)]],_0x4baca2=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x18a)]],_0xdf2dcb=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x1cf)]],_0x3a781a=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x173)]],_0x568fc2=[..._0x283694['body'][_0x597d3d(0x1c9)]],_0x453ce0=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x17e)]],_0x12543c=[..._0x283694[_0x597d3d(0x188)][_0x597d3d(0x17d)]],_0x4f17c7=[..._0x283694['body'][_0x597d3d(0x229)]];const _0x360b80=_0x27d4f3['map'](_0x358cc2=>{return _0x358cc2={'product_name':_0x358cc2};});_0x37379e[_0x597d3d(0x21a)]((_0x19d5a9,_0x5633b5)=>{var _0x3d7a8d=_0x597d3d;_0x3a781a[_0x3d7a8d(0x21a)]((_0x1977fa,_0xd67461)=>{var _0x1a5f30=_0x3d7a8d;if(_0x1977fa=='Receiving\x20Area'&&_0x5633b5==_0xd67461){var _0x1b44e5=_0x19d5a9[_0x1a5f30(0x24a)](0x3);_0x360b80[_0x5633b5][_0x1a5f30(0x1fd)]=_0x19d5a9[0x0],_0x360b80[_0x5633b5][_0x1a5f30(0x1e1)]=_0x19d5a9[0x1],_0x360b80[_0x5633b5][_0x1a5f30(0x1c1)]=0x0,_0x360b80[_0x5633b5]['bin']=0x0,_0x360b80[_0x5633b5][_0x1a5f30(0x219)]=_0x1a5f30(0x1a3),_0x360b80[_0x5633b5][_0x1a5f30(0x1af)]=_0x1b44e5;}else{if(_0x1977fa==_0x1a5f30(0x1a4)&&_0x5633b5==_0xd67461){var _0x1b44e5=_0x19d5a9['slice'](0x3);_0x360b80[_0x5633b5][_0x1a5f30(0x1fd)]=_0x19d5a9[0x0],_0x360b80[_0x5633b5][_0x1a5f30(0x1e1)]=_0x19d5a9[0x1],_0x360b80[_0x5633b5][_0x1a5f30(0x1c1)]=0x0,_0x360b80[_0x5633b5][_0x1a5f30(0x21e)]=0x0,_0x360b80[_0x5633b5][_0x1a5f30(0x219)]=_0x1a5f30(0x1a3),_0x360b80[_0x5633b5][_0x1a5f30(0x1af)]=_0x19d5a9[0x5];}else{if(_0x5633b5==_0xd67461){var _0x591287;if(_0x19d5a9[0x4]=='L')_0x591287=_0x1a5f30(0x176);else _0x19d5a9[0x4]=='F'&&(_0x591287=_0x1a5f30(0x1a3));_0x360b80[_0x5633b5][_0x1a5f30(0x1fd)]=_0x19d5a9[0x0],_0x360b80[_0x5633b5]['rack']=_0x19d5a9[0x1],_0x360b80[_0x5633b5][_0x1a5f30(0x1c1)]=_0x19d5a9[0x2],_0x360b80[_0x5633b5][_0x1a5f30(0x21e)]=_0x19d5a9[0x3],_0x360b80[_0x5633b5][_0x1a5f30(0x219)]=_0x591287,_0x360b80[_0x5633b5][_0x1a5f30(0x1af)]=_0x19d5a9[0x5];}}}});}),_0x7275fc[_0x597d3d(0x21a)]((_0x5d70ef,_0x22aee0)=>{var _0x3e8b08=_0x597d3d;_0x360b80[_0x22aee0][_0x3e8b08(0x218)]=_0x5d70ef;}),_0x4f17c7[_0x597d3d(0x21a)]((_0x5f9939,_0x1b8909)=>{_0x360b80[_0x1b8909]['id_transaction_from']=_0x5f9939;}),_0x3946c5[_0x597d3d(0x21a)]((_0x4c9cb5,_0x357fb7)=>{var _0x2ddf71=_0x597d3d;_0x360b80[_0x357fb7][_0x2ddf71(0x220)]=_0x4c9cb5;}),_0x34c69a['forEach']((_0x1d60cd,_0x17f364)=>{var _0x413552=_0x597d3d;_0x360b80[_0x17f364][_0x413552(0x244)]=_0x1d60cd;}),_0x1126fd['forEach']((_0x518337,_0x1fafb6)=>{_0x360b80[_0x1fafb6]['new_adjust_qty']=_0x518337;}),_0x45d26f[_0x597d3d(0x21a)]((_0x82c0be,_0x1a5603)=>{var _0x393b22=_0x597d3d;_0x360b80[_0x1a5603][_0x393b22(0x1b9)]=_0x82c0be;}),_0x531c60[_0x597d3d(0x21a)]((_0x1a4c61,_0x501df6)=>{var _0x22dd1c=_0x597d3d;_0x360b80[_0x501df6][_0x22dd1c(0x1c7)]=_0x1a4c61;}),_0x28b4cc[_0x597d3d(0x21a)]((_0x24a342,_0xde4f5d)=>{_0x360b80[_0xde4f5d]['product_code']=_0x24a342;}),_0x423f99[_0x597d3d(0x21a)]((_0x19c779,_0x8c9cc2)=>{var _0x48b0db=_0x597d3d;_0x360b80[_0x8c9cc2][_0x48b0db(0x1f3)]=_0x19c779;}),_0x47ff90['forEach']((_0x343420,_0xd73da0)=>{var _0x5a92a7=_0x597d3d;_0x360b80[_0xd73da0][_0x5a92a7(0x191)]=_0x343420;}),_0x5474ec[_0x597d3d(0x21a)]((_0x2af071,_0x679458)=>{var _0x2a33e1=_0x597d3d;_0x360b80[_0x679458][_0x2a33e1(0x1ad)]=_0x2af071;}),_0x4baca2[_0x597d3d(0x21a)]((_0x1bd687,_0x19771f)=>{var _0x32d1c2=_0x597d3d;_0x360b80[_0x19771f][_0x32d1c2(0x18a)]=_0x1bd687;}),_0xdf2dcb[_0x597d3d(0x21a)]((_0x3ae8ac,_0x5b5630)=>{_0x360b80[_0x5b5630]['prod_cat']=_0x3ae8ac;}),_0x3a781a[_0x597d3d(0x21a)]((_0x38b775,_0x575dd8)=>{var _0x4bb55b=_0x597d3d;_0x360b80[_0x575dd8][_0x4bb55b(0x238)]=_0x38b775;}),_0x568fc2[_0x597d3d(0x21a)]((_0xcb382f,_0x3adb83)=>{var _0x565a24=_0x597d3d;_0x360b80[_0x3adb83][_0x565a24(0x1c3)]=_0xcb382f;}),_0x453ce0[_0x597d3d(0x21a)]((_0x31c2c3,_0x5cfdda)=>{var _0x2e1181=_0x597d3d;_0x360b80[_0x5cfdda][_0x2e1181(0x223)]=_0x31c2c3;}),_0x12543c[_0x597d3d(0x21a)]((_0x2ef3fc,_0x4f8987)=>{_0x360b80[_0x4f8987]['invoice']=_0x2ef3fc;});const _0x277aa8=_0x360b80[_0x597d3d(0x18e)](_0x127202=>_0x127202[_0x597d3d(0x244)]!=='0'&&_0x127202[_0x597d3d(0x244)]!=='');var _0x3f8ed1=0x0;_0x277aa8[_0x597d3d(0x21a)](_0x377491=>{var _0x5a4fb8=_0x597d3d;console['log'](_0x5a4fb8(0x1d5),_0x377491),parseInt(_0x377491[_0x5a4fb8(0x244)])<=0x0&&_0x3f8ed1++;});if(_0x3f8ed1!=0x0)return _0x283694[_0x597d3d(0x1ac)](_0x597d3d(0x174),_0x597d3d(0x1e4)),_0x4cee16[_0x597d3d(0x22a)](_0x597d3d(0x20a));const _0x488b5b=new adjustment({'warehouse_name':_0x32ff85,'date':_0x489de2,'product':_0x277aa8,'note':_0x409615,'room':_0x585469,'invoice':_0x4d1e74,'JO_number':_0x98247a,'expiry_date':_0x1cbfed}),_0x2b657d=await _0x488b5b[_0x597d3d(0x1f8)]();_0x283694[_0x597d3d(0x1ac)]('success','adjustment\x20add\x20successfull'),_0x4cee16[_0x597d3d(0x22a)](_0x597d3d(0x1d2)+_0x2b657d[_0x597d3d(0x1c6)]);}catch(_0x34fa25){console['log'](_0x34fa25),_0x4cee16[_0x597d3d(0x248)](0xc8)['json']({'message':_0x34fa25[_0x597d3d(0x224)]});}}),router[a0_0x340bf0(0x1f2)](a0_0x340bf0(0x17a),auth,async(_0x5cc013,_0x4c3377)=>{var _0x1ecc63=a0_0x340bf0;try{const {username:_0x58b703,email:_0x242a36,role:_0x378f74}=_0x5cc013[_0x1ecc63(0x178)],_0x5558c7=_0x5cc013['user'],_0x5a7786=await profile['findOne']({'email':_0x5558c7['email']}),_0x3a2f29=await master_shop['find'](),_0x40dac8=_0x5cc013['params']['id'],_0x1f448f=await adjustment[_0x1ecc63(0x201)]({'_id':_0x40dac8}),_0x19954f=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1f448f[_0x1ecc63(0x192)]}},{'$unwind':_0x1ecc63(0x1ef)},{'$group':{'_id':'$product.product_name'}}]),_0x570fc5=await product[_0x1ecc63(0x22d)]({}),_0x2b2cf7=await warehouse[_0x1ecc63(0x210)]([{'$match':{'name':_0x1f448f[_0x1ecc63(0x192)]}},{'$unwind':_0x1ecc63(0x184)},{'$group':{'_id':_0x1ecc63(0x209),'name':{'$first':_0x1ecc63(0x1fa)},'product_stock':{'$first':_0x1ecc63(0x19e)},'bay':{'$first':_0x1ecc63(0x212)},'bin':{'$first':_0x1ecc63(0x1ec)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1ecc63(0x1e9)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1ecc63(0x179)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x1ecc63(0x23e)},'expiry_date':{'$first':_0x1ecc63(0x20e)},'production_date':{'$first':_0x1ecc63(0x245)},'batch_code':{'$first':_0x1ecc63(0x225)},'room':{'$first':'$room'}}}]);if(_0x3a2f29[0x0][_0x1ecc63(0x1dd)]==_0x1ecc63(0x1db)){var _0x4f28c3=users[_0x1ecc63(0x233)];console['log'](_0x4f28c3);}else{if(_0x3a2f29[0x0][_0x1ecc63(0x1dd)]==_0x1ecc63(0x203))var _0x4f28c3=users[_0x1ecc63(0x203)];else{if(_0x3a2f29[0x0][_0x1ecc63(0x1dd)]==_0x1ecc63(0x17b))var _0x4f28c3=users[_0x1ecc63(0x17b)];else{if(_0x3a2f29[0x0][_0x1ecc63(0x1dd)]=='Spanish')var _0x4f28c3=users['Spanish'];else{if(_0x3a2f29[0x0][_0x1ecc63(0x1dd)]==_0x1ecc63(0x217))var _0x4f28c3=users[_0x1ecc63(0x217)];else{if(_0x3a2f29[0x0]['language']==_0x1ecc63(0x1a5))var _0x4f28c3=users[_0x1ecc63(0x1b6)];else{if(_0x3a2f29[0x0][_0x1ecc63(0x1dd)]==_0x1ecc63(0x230))var _0x4f28c3=users[_0x1ecc63(0x230)];else{if(_0x3a2f29[0x0][_0x1ecc63(0x1dd)]==_0x1ecc63(0x1c2))var _0x4f28c3=users['Arabic'];}}}}}}}_0x4c3377[_0x1ecc63(0x181)](_0x1ecc63(0x202),{'success':_0x5cc013['flash'](_0x1ecc63(0x22f)),'errors':_0x5cc013['flash'](_0x1ecc63(0x174)),'role':_0x5558c7,'profile':_0x5a7786,'adjustment':_0x1f448f,'stock':_0x2b2cf7,'master_shop':_0x3a2f29,'warehouse_name':_0x19954f,'unit':_0x570fc5,'language':_0x4f28c3});}catch(_0x33ea05){console[_0x1ecc63(0x21b)](_0x33ea05),_0x4c3377[_0x1ecc63(0x248)](0xc8)[_0x1ecc63(0x239)]({'message':_0x33ea05['message']});}}),router[a0_0x340bf0(0x23d)](a0_0x340bf0(0x17a),auth,async(_0x3f6fb1,_0x5e0026)=>{var _0x8fb4d9=a0_0x340bf0;try{const _0x2f5fde=_0x3f6fb1['params']['id'],{warehouse_name:_0x3b8c21,Room_name:_0x59fce6}=_0x3f6fb1[_0x8fb4d9(0x188)],_0xfd5d2e=await adjustment[_0x8fb4d9(0x201)]({'_id':_0x2f5fde}),_0x23db00=_0xfd5d2e[_0x8fb4d9(0x205)][_0x8fb4d9(0x19d)](async _0x1afdb9=>{var _0x51affb=_0x8fb4d9;if(_0x1afdb9['adjust_qty']>0x0){var _0x4cd51c=await warehouse['findOne']({'name':_0x3b8c21,'room':_0x1afdb9[_0x51affb(0x238)],'warehouse_category':_0x51affb(0x1e3)});const _0x406864=_0x4cd51c[_0x51affb(0x1e7)][_0x51affb(0x19d)](_0x45f21e=>{var _0x1a6dcf=_0x51affb;if(_0x1afdb9[_0x1a6dcf(0x219)]=='minus'){if(_0x45f21e[_0x1a6dcf(0x237)]==_0x1afdb9[_0x1a6dcf(0x237)]&&_0x45f21e['floorlevel']==_0x1afdb9['floorlevel']&&_0x45f21e[_0x1a6dcf(0x219)]==_0x1afdb9['type']&&_0x45f21e['bin']==_0x1afdb9[_0x1a6dcf(0x21e)]&&_0x45f21e[_0x1a6dcf(0x1c1)]==_0x1afdb9[_0x1a6dcf(0x1c1)]&&_0x45f21e[_0x1a6dcf(0x1e1)]==_0x1afdb9[_0x1a6dcf(0x1e1)]&&_0x45f21e['storage']==_0x1afdb9[_0x1a6dcf(0x1fd)]&&_0x45f21e[_0x1a6dcf(0x191)]==_0x1afdb9['expiry_date']&&_0x45f21e[_0x1a6dcf(0x1f3)]==_0x1afdb9[_0x1a6dcf(0x1f3)]&&_0x45f21e[_0x1a6dcf(0x18a)]==_0x1afdb9[_0x1a6dcf(0x18a)]&&_0x45f21e['invoice']==_0x1afdb9[_0x1a6dcf(0x24d)]&&_0x45f21e[_0x1a6dcf(0x1c6)]==_0x1afdb9[_0x1a6dcf(0x1f0)]){var _0x191c1f;_0x191c1f=_0x1afdb9['adjust_qty'],_0x1afdb9[_0x1a6dcf(0x1cf)]=='S'&&(_0x191c1f=_0x1afdb9[_0x1a6dcf(0x244)]),_0x45f21e[_0x1a6dcf(0x1eb)]=_0x45f21e['product_stock']-_0x191c1f;}}else{if(_0x45f21e[_0x1a6dcf(0x237)]==_0x1afdb9[_0x1a6dcf(0x237)]&&_0x45f21e[_0x1a6dcf(0x1af)]==_0x1afdb9[_0x1a6dcf(0x1af)]&&_0x45f21e[_0x1a6dcf(0x219)]==_0x1afdb9[_0x1a6dcf(0x219)]&&_0x45f21e[_0x1a6dcf(0x21e)]==_0x1afdb9[_0x1a6dcf(0x21e)]&&_0x45f21e[_0x1a6dcf(0x1c1)]==_0x1afdb9[_0x1a6dcf(0x1c1)]&&_0x45f21e[_0x1a6dcf(0x1e1)]==_0x1afdb9[_0x1a6dcf(0x1e1)]&&_0x45f21e['storage']==_0x1afdb9[_0x1a6dcf(0x1fd)]&&_0x45f21e[_0x1a6dcf(0x191)]==_0x1afdb9[_0x1a6dcf(0x191)]&&_0x45f21e[_0x1a6dcf(0x1f3)]==_0x1afdb9['batch_code']&&_0x45f21e[_0x1a6dcf(0x18a)]==_0x1afdb9[_0x1a6dcf(0x18a)]&&_0x45f21e[_0x1a6dcf(0x24d)]==_0x1afdb9[_0x1a6dcf(0x24d)]&&_0x45f21e[_0x1a6dcf(0x1c6)]==_0x1afdb9['id_transaction_from']){console[_0x1a6dcf(0x21b)](_0x1afdb9);var _0x191c1f;_0x191c1f=_0x1afdb9[_0x1a6dcf(0x244)],_0x1afdb9[_0x1a6dcf(0x1cf)]=='S'&&(_0x191c1f=_0x1afdb9[_0x1a6dcf(0x244)]),console[_0x1a6dcf(0x21b)](_0x191c1f+_0x1a6dcf(0x22c)+_0x1afdb9[_0x1a6dcf(0x244)]+_0x1a6dcf(0x22c)+_0x45f21e['maxPerUnit']+_0x1a6dcf(0x22c)+_0x1afdb9[_0x1a6dcf(0x1cf)]),_0x45f21e[_0x1a6dcf(0x1eb)]=_0x45f21e[_0x1a6dcf(0x1eb)]+_0x191c1f;}}});}return _0x4cd51c;});Promise[_0x8fb4d9(0x1bc)](_0x23db00)[_0x8fb4d9(0x194)](async _0x59b017=>{var _0x37d191=_0x8fb4d9;try{for(const _0x26b424 of _0x59b017){await _0x26b424[_0x37d191(0x1f8)]();}_0xfd5d2e[_0x37d191(0x1c5)]=_0x37d191(0x1c4);const _0x2b0282=await _0xfd5d2e['save'](),_0x201371=await master_shop[_0x37d191(0x22d)](),_0x46cb9c=await email_settings[_0x37d191(0x1a9)](),_0x31f011=await supervisor_settings['find']();var _0x8afbf4=_0xfd5d2e[_0x37d191(0x205)],_0x5de6b6='',_0x28a748;for(_0x28a748 in _0x8afbf4){_0x5de6b6+=_0x37d191(0x1b2)+_0x37d191(0x1fc)+_0x8afbf4[_0x28a748][_0x37d191(0x237)]+_0x37d191(0x1b0)+_0x37d191(0x1fc)+_0x8afbf4[_0x28a748][_0x37d191(0x226)]+_0x37d191(0x1b0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8afbf4[_0x28a748]['adjust_qty']+_0x37d191(0x1b0)+_0x37d191(0x1fc)+_0x8afbf4[_0x28a748][_0x37d191(0x1b9)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8afbf4[_0x28a748][_0x37d191(0x1c7)]+_0x37d191(0x1b0)+_0x37d191(0x1fc)+_0xfd5d2e[_0x37d191(0x192)]+_0x37d191(0x1b0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8afbf4[_0x28a748][_0x37d191(0x238)]+_0x37d191(0x1b0)+_0x37d191(0x1fc)+_0x8afbf4[_0x28a748]['storage']+_0x8afbf4[_0x28a748][_0x37d191(0x1e1)]+_0x8afbf4[_0x28a748][_0x37d191(0x1c1)]+_0x8afbf4[_0x28a748][_0x37d191(0x21e)]+_0x8afbf4[_0x28a748][_0x37d191(0x219)][0x0]+_0x8afbf4[_0x28a748][_0x37d191(0x1af)]+_0x37d191(0x1b0),'</tr>';}let _0x5d96d1=nodemailer[_0x37d191(0x197)]({'host':_0x46cb9c[_0x37d191(0x1bd)],'port':Number(_0x46cb9c['port']),'secure':![],'auth':{'user':_0x46cb9c[_0x37d191(0x1ee)],'pass':_0x46cb9c[_0x37d191(0x21c)]}}),_0x1cdb06={'from':_0x46cb9c[_0x37d191(0x1ee)],'to':_0x31f011[0x0][_0x37d191(0x1b4)],'subject':_0x37d191(0x19c),'attachments':[{'filename':_0x37d191(0x200),'path':__dirname+_0x37d191(0x1cd)+_0x37d191(0x18d)+_0x201371[0x0][_0x37d191(0x1d9)],'cid':_0x37d191(0x1cb)}],'html':_0x37d191(0x1f6)+_0x37d191(0x1ed)+_0x37d191(0x232)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x37d191(0x180)+_0x37d191(0x18b)+'</div>'+_0x37d191(0x180)+_0x37d191(0x177)+_0x201371[0x0][_0x37d191(0x228)]+_0x37d191(0x22b)+'</div>'+'</div>'+_0x37d191(0x1fe)+'<div>'+_0x37d191(0x1a1)+_0x37d191(0x206)+_0xfd5d2e[_0x37d191(0x24d)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x37d191(0x1fb)+_0xfd5d2e['date']+'\x20'+_0x37d191(0x1e0)+'</h5>'+'</div>'+_0x37d191(0x247)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x37d191(0x1b2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x37d191(0x1a6)+_0x37d191(0x213)+_0x37d191(0x20d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x37d191(0x1b1)+_0x37d191(0x1e8)+_0x37d191(0x1ff)+_0x37d191(0x246)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x5de6b6+'\x20'+_0x37d191(0x1aa)+'</table>'+_0x37d191(0x180)+_0x37d191(0x1d8)+_0x37d191(0x1b3)+_0x201371[0x0][_0x37d191(0x228)]+_0x37d191(0x1ca)+'</div>'+_0x37d191(0x1dc)+'</body></html>'};_0x5d96d1[_0x37d191(0x22e)](_0x1cdb06,function(_0x3b48a7,_0x2e9011){var _0x2f17c5=_0x37d191;_0x3b48a7?(console[_0x2f17c5(0x21b)](_0x3b48a7),console[_0x2f17c5(0x21b)](_0x2f17c5(0x21f))):console['log'](_0x2f17c5(0x1e2));}),_0x3f6fb1['flash'](_0x37d191(0x22f),_0x37d191(0x208)),_0x5e0026[_0x37d191(0x22a)](_0x37d191(0x1f4)+_0x2b0282[_0x37d191(0x1c6)]);}catch(_0x3a48c2){console[_0x37d191(0x1b8)](_0x3a48c2),_0x5e0026[_0x37d191(0x248)](0x1f4)[_0x37d191(0x239)]({'error':_0x37d191(0x1d3)});}})[_0x8fb4d9(0x1f9)](_0x18632a=>{var _0x5213a5=_0x8fb4d9;console[_0x5213a5(0x1b8)](_0x18632a),_0x5e0026[_0x5213a5(0x248)](0x1f4)['json']({'error':_0x5213a5(0x1a8)});});}catch(_0x2b4f80){console['log'](_0x2b4f80),_0x5e0026[_0x8fb4d9(0x248)](0xc8)['json']({'message':_0x2b4f80[_0x8fb4d9(0x224)]});}}),router[a0_0x340bf0(0x1f2)](a0_0x340bf0(0x182),auth,async(_0x1fd1ea,_0x53fcd5)=>{var _0x444c68=a0_0x340bf0;try{const {username:_0x274d44,email:_0x38b0ec,role:_0x143dd3}=_0x1fd1ea[_0x444c68(0x178)],_0x457c10=_0x1fd1ea[_0x444c68(0x178)],_0x5bf876=await profile[_0x444c68(0x1a9)]({'email':_0x457c10[_0x444c68(0x1ee)]}),_0x206261=await master_shop[_0x444c68(0x22d)](),_0x57d35e=_0x1fd1ea['params']['id'],_0x54fddd=await adjustment['findById']({'_id':_0x57d35e}),_0x518468=await purchases[_0x444c68(0x210)]([{'$match':{'warehouse_name':_0x54fddd[_0x444c68(0x192)]}},{'$unwind':_0x444c68(0x1ef)},{'$group':{'_id':_0x444c68(0x23a)}}]),_0x1e894f=await product['find']({}),_0x43817d=await warehouse['aggregate']([{'$match':{'name':_0x54fddd['warehouse_name']}},{'$unwind':_0x444c68(0x184)},{'$group':{'_id':_0x444c68(0x209),'name':{'$first':_0x444c68(0x1fa)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x444c68(0x212)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x444c68(0x19a)},'floorlevel':{'$first':_0x444c68(0x1a0)},'primary_code':{'$first':_0x444c68(0x1e9)},'secondary_code':{'$first':_0x444c68(0x240)},'product_code':{'$first':_0x444c68(0x179)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x444c68(0x18c)},'maxPerUnit':{'$first':_0x444c68(0x23e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x444c68(0x245)},'batch_code':{'$first':_0x444c68(0x225)},'room':{'$first':_0x444c68(0x20b)}}}]);let _0x4f7515;if(_0x457c10[_0x444c68(0x196)]==_0x444c68(0x236)){const _0x1fb40c=await staff[_0x444c68(0x1a9)]({'email':_0x457c10[_0x444c68(0x1ee)]});_0x4f7515=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x1fb40c[_0x444c68(0x24b)],'warehouse_category':_0x444c68(0x1e3),'name':{'$ne':_0x444c68(0x207)}}},{'$group':{'_id':_0x444c68(0x1b7),'name':{'$first':'$name'}}}]);}else _0x4f7515=await warehouse['aggregate']([{'$match':{'status':_0x444c68(0x1ab),'warehouse_category':_0x444c68(0x1e3),'name':{'$ne':_0x444c68(0x207)}}},{'$group':{'_id':'$name','name':{'$first':_0x444c68(0x1b7)}}}]);if(_0x206261[0x0][_0x444c68(0x1dd)]=='English\x20(US)'){var _0x488745=users[_0x444c68(0x233)];console[_0x444c68(0x21b)](_0x488745);}else{if(_0x206261[0x0][_0x444c68(0x1dd)]==_0x444c68(0x203))var _0x488745=users[_0x444c68(0x203)];else{if(_0x206261[0x0][_0x444c68(0x1dd)]==_0x444c68(0x17b))var _0x488745=users['German'];else{if(_0x206261[0x0][_0x444c68(0x1dd)]==_0x444c68(0x234))var _0x488745=users[_0x444c68(0x234)];else{if(_0x206261[0x0]['language']==_0x444c68(0x217))var _0x488745=users[_0x444c68(0x217)];else{if(_0x206261[0x0]['language']=='Portuguese\x20(BR)')var _0x488745=users[_0x444c68(0x1b6)];else{if(_0x206261[0x0][_0x444c68(0x1dd)]==_0x444c68(0x230))var _0x488745=users[_0x444c68(0x230)];else{if(_0x206261[0x0][_0x444c68(0x1dd)]=='Arabic\x20(ae)')var _0x488745=users[_0x444c68(0x20c)];}}}}}}}_0x53fcd5[_0x444c68(0x181)](_0x444c68(0x24e),{'success':_0x1fd1ea[_0x444c68(0x1ac)](_0x444c68(0x22f)),'errors':_0x1fd1ea[_0x444c68(0x1ac)]('errors'),'role':_0x457c10,'profile':_0x5bf876,'adjustment':_0x54fddd,'stock':_0x43817d,'master_shop':_0x206261,'warehouse_name':_0x518468,'unit':_0x1e894f,'language':_0x488745,'warehouse':_0x4f7515});}catch(_0x59efb2){console['log'](_0x59efb2),_0x53fcd5[_0x444c68(0x248)](0xc8)['json']({'message':_0x59efb2['message']});}}),router['post'](a0_0x340bf0(0x182),auth,async(_0x4a247f,_0x1e9044)=>{var _0x15f268=a0_0x340bf0;try{const _0x2df1b6=_0x4a247f[_0x15f268(0x190)]['id'],_0x54a8a3=await adjustment['findById']({'_id':_0x2df1b6}),_0x43042b=await warehouse[_0x15f268(0x1a9)]({'name':_0x54a8a3[_0x15f268(0x192)],'room':_0x54a8a3[_0x15f268(0x249)]}),{warehouse_name:_0x2ffa65,date:_0x1c00e7,prod_name:_0x15df00,level:_0x4c836f,isle:_0xb0da00,pallet:_0x369616,stock:_0x2693c8,types:_0x367e54,adjust_qty:_0x26fa35,new_adjust_qty:_0x5f0071,note:_0x564195,Room_name:_0x2c0b65,invoice:_0x2aecaa,JO_number:_0x1dc7bd,expiry_date:_0x2d846c}=_0x4a247f[_0x15f268(0x188)];if(typeof _0x15df00==_0x15f268(0x235))var _0x15d2f6=[_0x4a247f[_0x15f268(0x188)]['prod_name']],_0x4a2cbc=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x198)]],_0x2d9c3e=[_0x4a247f[_0x15f268(0x188)]['stock']],_0x1ab0d5=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x220)]],_0x427202=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x1a2)]],_0x1d7013=[_0x4a247f['body'][_0x15f268(0x1f7)]],_0xbbf330=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x175)]],_0x4bc0e3=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x185)]],_0x2a0c32=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x20f)]],_0x4d7b44=[_0x4a247f[_0x15f268(0x188)]['batch_code']],_0x1aab5c=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x191)]],_0x37f3ba=[_0x4a247f[_0x15f268(0x188)]['max_per_unit']],_0x3192ee=[_0x4a247f[_0x15f268(0x188)]['production_date']],_0x4804d8=[_0x4a247f[_0x15f268(0x188)]['prod_cat']],_0x29806b=[_0x4a247f['body'][_0x15f268(0x173)]],_0x25ccad=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x1c9)]],_0xad93cc=[_0x4a247f[_0x15f268(0x188)][_0x15f268(0x17e)]];else var _0x15d2f6=[..._0x4a247f[_0x15f268(0x188)]['prod_name']],_0x4a2cbc=[..._0x4a247f['body'][_0x15f268(0x198)]],_0x2d9c3e=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x227)]],_0x1ab0d5=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x220)]],_0x427202=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x1a2)]],_0x1d7013=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x1f7)]],_0xbbf330=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x1b9)]],_0x4bc0e3=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x185)]],_0x2a0c32=[..._0x4a247f['body'][_0x15f268(0x20f)]],_0x4d7b44=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x1f3)]],_0x1aab5c=[..._0x4a247f[_0x15f268(0x188)]['expiry_date']],_0x37f3ba=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x216)]],_0x3192ee=[..._0x4a247f[_0x15f268(0x188)]['production_date']],_0x4804d8=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x1cf)]],_0x29806b=[..._0x4a247f[_0x15f268(0x188)]['Rooms']],_0x25ccad=[..._0x4a247f[_0x15f268(0x188)][_0x15f268(0x1c9)]],_0xad93cc=[..._0x4a247f[_0x15f268(0x188)]['second1']];const _0x1b142e=_0x15d2f6[_0x15f268(0x19d)](_0x147ddd=>{return _0x147ddd={'product_name':_0x147ddd};});_0x4a2cbc[_0x15f268(0x21a)]((_0x1fdb80,_0x3a50fe)=>{var _0x5a20ad=_0x15f268;_0x29806b[_0x5a20ad(0x21a)]((_0x5e9d1d,_0x2d014d)=>{var _0x47184c=_0x5a20ad;if(_0x5e9d1d==_0x47184c(0x1c0)&&_0x3a50fe==_0x2d014d){var _0x33b9b3=_0x1fdb80[_0x47184c(0x24a)](0x3);_0x1b142e[_0x3a50fe][_0x47184c(0x1fd)]=_0x1fdb80[0x0],_0x1b142e[_0x3a50fe]['rack']=_0x1fdb80[0x1],_0x1b142e[_0x3a50fe][_0x47184c(0x1c1)]=0x0,_0x1b142e[_0x3a50fe]['bin']=0x0,_0x1b142e[_0x3a50fe]['type']=_0x47184c(0x1a3),_0x1b142e[_0x3a50fe][_0x47184c(0x1af)]=_0x33b9b3;}else{if(_0x5e9d1d==_0x47184c(0x1a4)&&_0x3a50fe==_0x2d014d){var _0x33b9b3=_0x1fdb80[_0x47184c(0x24a)](0x3);_0x1b142e[_0x3a50fe][_0x47184c(0x1fd)]=_0x1fdb80[0x0],_0x1b142e[_0x3a50fe]['rack']=_0x1fdb80[0x1],_0x1b142e[_0x3a50fe][_0x47184c(0x1c1)]=0x0,_0x1b142e[_0x3a50fe][_0x47184c(0x21e)]=0x0,_0x1b142e[_0x3a50fe][_0x47184c(0x219)]=_0x47184c(0x1a3),_0x1b142e[_0x3a50fe][_0x47184c(0x1af)]=_0x1fdb80[0x5];}else{if(_0x3a50fe==_0x2d014d){var _0x4ccdb7;if(_0x1fdb80[0x4]=='L')_0x4ccdb7='Level';else _0x1fdb80[0x4]=='F'&&(_0x4ccdb7='Floor');_0x1b142e[_0x3a50fe]['storage']=_0x1fdb80[0x0],_0x1b142e[_0x3a50fe][_0x47184c(0x1e1)]=_0x1fdb80[0x1],_0x1b142e[_0x3a50fe]['bay']=_0x1fdb80[0x2],_0x1b142e[_0x3a50fe][_0x47184c(0x21e)]=_0x1fdb80[0x3],_0x1b142e[_0x3a50fe][_0x47184c(0x219)]=_0x4ccdb7,_0x1b142e[_0x3a50fe][_0x47184c(0x1af)]=_0x1fdb80[0x5];}}}});}),_0x2d9c3e['forEach']((_0x9ed3f0,_0x484631)=>{_0x1b142e[_0x484631]['stockBefore']=_0x9ed3f0;}),_0x1ab0d5[_0x15f268(0x21a)]((_0x263054,_0xb6cbaa)=>{var _0x429365=_0x15f268;_0x1b142e[_0xb6cbaa][_0x429365(0x220)]=_0x263054;}),_0x427202['forEach']((_0x3bbdd7,_0xa6ed2d)=>{var _0x5ef1f4=_0x15f268;_0x1b142e[_0xa6ed2d][_0x5ef1f4(0x244)]=_0x3bbdd7;}),_0x1d7013[_0x15f268(0x21a)]((_0xf7b51b,_0x3a378d)=>{var _0x2dc962=_0x15f268;_0x1b142e[_0x3a378d][_0x2dc962(0x1d7)]=_0xf7b51b;}),_0xbbf330[_0x15f268(0x21a)]((_0x50d2c9,_0x2711cf)=>{var _0x41edfb=_0x15f268;_0x1b142e[_0x2711cf][_0x41edfb(0x1b9)]=_0x50d2c9;}),_0x4bc0e3[_0x15f268(0x21a)]((_0x11a1ff,_0x3251bd)=>{_0x1b142e[_0x3251bd]['secondary_unit']=_0x11a1ff;}),_0x2a0c32[_0x15f268(0x21a)]((_0x4f2b93,_0x383cc6)=>{_0x1b142e[_0x383cc6]['product_code']=_0x4f2b93;}),_0x4d7b44[_0x15f268(0x21a)]((_0x2ff331,_0x530f37)=>{var _0x4538b1=_0x15f268;_0x1b142e[_0x530f37][_0x4538b1(0x1f3)]=_0x2ff331;}),_0x1aab5c[_0x15f268(0x21a)]((_0x44e2a2,_0x527686)=>{var _0x188014=_0x15f268;_0x1b142e[_0x527686][_0x188014(0x191)]=_0x44e2a2;}),_0x37f3ba[_0x15f268(0x21a)]((_0x43a6de,_0x112853)=>{var _0xdd9926=_0x15f268;_0x1b142e[_0x112853][_0xdd9926(0x1ad)]=_0x43a6de;}),_0x3192ee['forEach']((_0x1fe0b3,_0x1c4e6d)=>{var _0x3d133b=_0x15f268;_0x1b142e[_0x1c4e6d][_0x3d133b(0x18a)]=_0x1fe0b3;}),_0x4804d8[_0x15f268(0x21a)]((_0x490848,_0x8e9141)=>{_0x1b142e[_0x8e9141]['prod_cat']=_0x490848;}),_0x29806b[_0x15f268(0x21a)]((_0x4e145a,_0x535cc5)=>{var _0x2c1aba=_0x15f268;_0x1b142e[_0x535cc5][_0x2c1aba(0x238)]=_0x4e145a;}),_0x25ccad[_0x15f268(0x21a)]((_0xf4d2bd,_0x5b11bd)=>{var _0x10b01c=_0x15f268;_0x1b142e[_0x5b11bd][_0x10b01c(0x1c3)]=_0xf4d2bd;}),_0xad93cc[_0x15f268(0x21a)]((_0x349cb2,_0xeb19e)=>{var _0x4a3766=_0x15f268;_0x1b142e[_0xeb19e][_0x4a3766(0x223)]=_0x349cb2;});const _0x116304=_0x1b142e['filter'](_0x4628d1=>_0x4628d1[_0x15f268(0x244)]!=='0'&&_0x4628d1['adjust_qty']!=='');var _0x5b640b=0x0;_0x116304[_0x15f268(0x21a)](_0x42c942=>{var _0x2e32c4=_0x15f268;console['log'](_0x2e32c4(0x1d5),_0x42c942),parseInt(_0x42c942[_0x2e32c4(0x244)])<=0x0&&_0x5b640b++;});if(_0x5b640b!=0x0)return _0x4a247f[_0x15f268(0x1ac)]('errors',_0x15f268(0x1e4)),_0x1e9044['redirect']('back');_0x54a8a3[_0x15f268(0x192)]=_0x2ffa65,_0x54a8a3[_0x15f268(0x1c8)]=_0x1c00e7,_0x54a8a3[_0x15f268(0x205)]=_0x116304,_0x54a8a3[_0x15f268(0x24c)]=_0x564195,_0x54a8a3['invoice']=_0x2aecaa,_0x54a8a3[_0x15f268(0x199)]=_0x15f268(0x211);const _0x3d3c2f=await _0x54a8a3['save']();_0x4a247f[_0x15f268(0x1ac)](_0x15f268(0x22f),_0x15f268(0x214)),_0x1e9044[_0x15f268(0x22a)]('/adjustment/view');}catch(_0x4d5c24){console['log'](_0x4d5c24);}}),router['post'](a0_0x340bf0(0x1d1),async(_0x1d47b4,_0x4ea446)=>{var _0x333614=a0_0x340bf0;const {primary_code:_0x3022ee,warehouse_data:_0x1a0d26,rooms_data:_0x1a8082,Roomslist:_0x433179}=_0x1d47b4['body'],_0x56550d=_0x433179[_0x333614(0x187)](','),_0x10f34d=[];async function _0x4547d7(_0x46167e){var _0x2da3a5=_0x333614;const _0x1fc215=await warehouse['aggregate']([{'$match':{'name':_0x1a0d26,'room':_0x46167e}},{'$unwind':_0x2da3a5(0x184)},{'$match':{'product_details.primary_code':_0x3022ee}},{'$group':{'_id':_0x2da3a5(0x209),'name':{'$first':_0x2da3a5(0x1fa)},'product_stock':{'$first':_0x2da3a5(0x19e)},'primary_code':{'$first':_0x2da3a5(0x1e9)},'secondary_code':{'$first':_0x2da3a5(0x240)},'product_code':{'$first':_0x2da3a5(0x179)},'level':{'$first':_0x2da3a5(0x212)},'isle':{'$first':_0x2da3a5(0x1ec)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2da3a5(0x1a0)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2da3a5(0x18f)},'storage':{'$first':_0x2da3a5(0x1f1)},'rack':{'$first':_0x2da3a5(0x18c)},'expiry_date':{'$first':_0x2da3a5(0x20e)},'production_date':{'$first':_0x2da3a5(0x245)},'maxPerUnit':{'$first':_0x2da3a5(0x23e)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x2da3a5(0x23f)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2da3a5(0x20b)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x167e83=await warehouse[_0x2da3a5(0x210)]([{'$match':{'name':_0x1a0d26,'room':_0x46167e}},{'$unwind':_0x2da3a5(0x184)},{'$match':{'product_details.secondary_code':_0x3022ee}},{'$group':{'_id':_0x2da3a5(0x209),'name':{'$first':_0x2da3a5(0x1fa)},'product_stock':{'$first':_0x2da3a5(0x19e)},'primary_code':{'$first':_0x2da3a5(0x1e9)},'secondary_code':{'$first':_0x2da3a5(0x240)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2da3a5(0x212)},'isle':{'$first':_0x2da3a5(0x1ec)},'type':{'$first':_0x2da3a5(0x19a)},'pallet':{'$first':_0x2da3a5(0x1a0)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2da3a5(0x18f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2da3a5(0x18c)},'expiry_date':{'$first':_0x2da3a5(0x20e)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x2da3a5(0x23e)},'batch_code':{'$first':_0x2da3a5(0x225)},'product_cat':{'$first':_0x2da3a5(0x23f)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2da3a5(0x20b)}}}]);if(_0x1fc215[_0x2da3a5(0x1e5)]>0x0)_0x10f34d[_0x2da3a5(0x1d0)](_0x1fc215);else _0x167e83[_0x2da3a5(0x1e5)]>0x0&&_0x10f34d[_0x2da3a5(0x1d0)](_0x167e83);}const _0x3e7826=_0x56550d[_0x333614(0x19d)](_0x379734=>_0x4547d7(_0x379734));await Promise['all'](_0x3e7826),_0x4ea446['json'](_0x10f34d);}),router[a0_0x340bf0(0x23d)]('/CheckingWarehouse',async(_0x274c10,_0x16e39f)=>{var _0x2a3636=a0_0x340bf0;const {primaryCode:_0x28c375,secondaryCode:_0x929a12,productCode:_0x454581,level:_0x75145f,isle:_0x4bd67f,pallet:_0x2f7753,warehouses:_0x4126f4,room:_0x1f3d18}=_0x274c10[_0x2a3636(0x188)];try{const _0x1d8452=await warehouse['aggregate']([{'$match':{'name':_0x4126f4,'room':_0x1f3d18}},{'$unwind':_0x2a3636(0x184)},{'$match':{'product_details.level':parseInt(_0x75145f),'product_details.isle':_0x4bd67f,'product_details.pallet':parseInt(_0x2f7753)}},{'$group':{'_id':_0x2a3636(0x209),'name':{'$first':_0x2a3636(0x1fa)},'product_stock':{'$first':_0x2a3636(0x19e)},'level':{'$first':_0x2a3636(0x186)},'isle':{'$first':_0x2a3636(0x193)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x16e39f[_0x2a3636(0x248)](0xc8)[_0x2a3636(0x239)](_0x1d8452);}catch(_0x29e40d){_0x16e39f['status'](0x194)[_0x2a3636(0x239)]({'message':_0x29e40d[_0x2a3636(0x224)]});}}),module[a0_0x340bf0(0x21d)]=router;