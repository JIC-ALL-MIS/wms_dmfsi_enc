var a0_0x289ae8=a0_0x29b9;function a0_0x54c0(){var _0x4cedbb=['$name','1009190ETaKDF','Chinese','/CheckingWarehouse','$date','stockBefore','express','\x20Order\x20Number\x20:\x20','port','product','image','findById','level','types','$product_details.level','$product_details.secondary_unit','Logo.png','1015112Aqwalb','4RQHWCg','new_adjust_qty','$product_details.expiry_date','json','nodemailer','<tbody\x20style=\x22text-align:\x20center;\x22>','Email\x20sent\x20successfully','secondary_unit','rack','New_Qty_Converted','error','language','Return\x20Rooms','<!DOCTYPE\x20html>','</td>','$product_details.bay','$room','1471060wjMZuR','Return\x20Goods','push','slice','invoice','$product_details._id','\x20</h2>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Arabic\x20(ae)','status','render','Secondary_units','aggregate','Hindi','primary_code','French','Error\x20Occurs','/barcode_scanner','An\x20error\x20occurred\x20while\x20saving\x20data.','email','Raw\x20Materials','</h5>','$product_details.maxProducts','floorlevel','split','second1','bay','product_code','errors','adjust_qty','True','$product_details.storage','production_date','type','<div>','</tr>','length','457964FzrcUt','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<html><head><title></title>','sendMail','back','/view/:id','maxPerUnit','flash','$product.room_names','/view/add_adjustment','$product_details.product_name','Primary_Units','prime1','foreach\x20newproduct','Enclosed','find','Rooms','<h5>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','staff','$product_details.type','$product_details.pallet','prod_cat','prod_code','New_Qty_Converted_adj','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','product_name','then','warehouse','RMSEmail','master','params','expiry_date','Floor','/preview/:id','$product','batch_code','$product.product_name','adjustment\x20add\x20successfull','</thead>','1619094JEdpVJ','Shelves','</body></html>','note','storage','/adjustment/preview/','/../public','$product_details.product_cat','Arabic','maxperunit','$product_details.bin','<span\x20style=\x22float:\x20right;\x22>','Receiving\x20Area','<tr>','../models/all_models','Spanish','string','get','floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details','$product_details.maxPerUnit','product_stock','room_names','<hr\x20class=\x22my-3\x22>','max_per_unit','success','/adjustment/view','127043BjMbtz','_id','$invoice','/picking_list/PDF_adjustment_rm/','edit_adjustment','message','random','logo','Portuguese\x20(BR)','$product_details.floorlevel','redirect','$product_details.product_stock','findOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.rack','An\x20error\x20occurred.','product_details','</div>','German','log','stock','</span>','Adjustment\x20Mail','191043rkuDbh','$warehouse_name','</tbody>','filter','unit','$product_details.production_date','$product_details.batch_code','$product_details.isle','adjustment\x20Finalized\x20successfully','English\x20(US)','English','$product_details.secondary_code','secondary_code','minus','ADJ-','\x20Order\x20Date\x20:\x20','forEach','Portuguese','map','role','add_adjustment','$isAllowEdit','warehouse_name','prod_name','date','padStart','\x20<>\x20','exports','user','body','all','catch','createTransport','$product_details.product_code','$product_details.primary_code','bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Enabled','post','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','save'];a0_0x54c0=function(){return _0x4cedbb;};return a0_0x54c0();}(function(_0x41558e,_0x192132){var _0x5c63fe=a0_0x29b9,_0x353119=_0x41558e();while(!![]){try{var _0x4b7230=-parseInt(_0x5c63fe(0xf5))/0x1+parseInt(_0x5c63fe(0x17e))/0x2+-parseInt(_0x5c63fe(0x10c))/0x3*(-parseInt(_0x5c63fe(0x148))/0x4)+parseInt(_0x5c63fe(0x159))/0x5+-parseInt(_0x5c63fe(0xd9))/0x6+-parseInt(_0x5c63fe(0x137))/0x7+parseInt(_0x5c63fe(0x147))/0x8;if(_0x4b7230===_0x192132)break;else _0x353119['push'](_0x353119['shift']());}catch(_0x5ac33){_0x353119['push'](_0x353119['shift']());}}}(a0_0x54c0,0x2a29e));const express=require(a0_0x289ae8(0x13c)),app=express(),router=express['Router'](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x289ae8(0xe7)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x289ae8(0x14c));router[a0_0x289ae8(0xea)]('/view',auth,async(_0x6332d5,_0x37609c)=>{var _0x4602ab=a0_0x289ae8;try{const {username:_0x5d439a,email:_0x252a36,role:_0x256f84}=_0x6332d5[_0x4602ab(0x128)],_0x22bf54=_0x6332d5[_0x4602ab(0x128)],_0xed338a=await profile[_0x4602ab(0x101)]({'email':_0x22bf54[_0x4602ab(0x16c)]}),_0x280703=await master_shop[_0x4602ab(0x18d)]();console[_0x4602ab(0x108)](_0x4602ab(0x19e),_0x280703);let _0xaaf9d3;if(_0x22bf54[_0x4602ab(0x11f)]==_0x4602ab(0x192)){const _0xf3b8da=await staff[_0x4602ab(0x101)]({'email':_0x22bf54[_0x4602ab(0x16c)]});_0xaaf9d3=await warehouse[_0x4602ab(0x18d)]({'status':_0x4602ab(0x132),'name':_0xf3b8da['warehouse']});}else _0xaaf9d3=await warehouse[_0x4602ab(0x18d)]({'status':_0x4602ab(0x132)});const _0x25580e=await product[_0x4602ab(0x18d)]();let _0x327cae;if(_0x22bf54[_0x4602ab(0x11f)]==_0x4602ab(0x192)){const _0x11c596=await staff['findOne']({'email':_0x22bf54['email']});_0x327cae=await adjustment[_0x4602ab(0x18d)]({'warehouse_name':_0x11c596[_0x4602ab(0x19c)]});}else _0x327cae=await adjustment[_0x4602ab(0x165)]([{'$unwind':_0x4602ab(0xd4)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4602ab(0xf7)},'date':{'$first':_0x4602ab(0x13a)},'warehouse_name':{'$first':_0x4602ab(0x10d)},'room':{'$addToSet':_0x4602ab(0x186)},'finalize':{'$first':_0x4602ab(0x198)},'isAllowEdit':{'$first':_0x4602ab(0x121)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x280703[0x0][_0x4602ab(0x153)]==_0x4602ab(0x115)){var _0x490449=users['English'];console[_0x4602ab(0x108)](_0x490449);}else{if(_0x280703[0x0]['language']==_0x4602ab(0x166))var _0x490449=users[_0x4602ab(0x166)];else{if(_0x280703[0x0][_0x4602ab(0x153)]==_0x4602ab(0x107))var _0x490449=users[_0x4602ab(0x107)];else{if(_0x280703[0x0]['language']==_0x4602ab(0xe8))var _0x490449=users[_0x4602ab(0xe8)];else{if(_0x280703[0x0][_0x4602ab(0x153)]==_0x4602ab(0x168))var _0x490449=users[_0x4602ab(0x168)];else{if(_0x280703[0x0][_0x4602ab(0x153)]==_0x4602ab(0xfd))var _0x490449=users['Portuguese'];else{if(_0x280703[0x0][_0x4602ab(0x153)]==_0x4602ab(0x138))var _0x490449=users[_0x4602ab(0x138)];else{if(_0x280703[0x0][_0x4602ab(0x153)]==_0x4602ab(0x161))var _0x490449=users[_0x4602ab(0xe1)];}}}}}}}_0x37609c['render']('adjustment',{'success':_0x6332d5['flash'](_0x4602ab(0xf3)),'errors':_0x6332d5['flash']('errors'),'role':_0x22bf54,'profile':_0xed338a,'warehouse':_0xaaf9d3,'product':_0x25580e,'adjustment':_0x327cae,'master_shop':_0x280703,'language':_0x490449});}catch(_0x2502d5){console[_0x4602ab(0x108)](_0x2502d5);}});function a0_0x29b9(_0x141389,_0x35f127){var _0x54c0f8=a0_0x54c0();return a0_0x29b9=function(_0x29b93b,_0x3ea381){_0x29b93b=_0x29b93b-0xd4;var _0x388760=_0x54c0f8[_0x29b93b];return _0x388760;},a0_0x29b9(_0x141389,_0x35f127);}async function getRandom8DigitNumber(){var _0x26b9b6=a0_0x289ae8;const _0x36313e=0x989680,_0x20aa4a=0x5f5e0ff,_0x4a2c25=Math[_0x26b9b6(0xeb)](Math[_0x26b9b6(0xfb)]()*(_0x20aa4a-_0x36313e+0x1))+_0x36313e;var _0x11bbe5;const _0x5d3546=await adjustment['findOne']({'invoice':_0x26b9b6(0x11a)+_0x4a2c25});return _0x5d3546&&_0x5d3546[_0x26b9b6(0x17d)]>0x0?_0x11bbe5=_0x26b9b6(0x11a)+_0x4a2c25:_0x11bbe5=_0x26b9b6(0x11a)+_0x4a2c25,_0x11bbe5;}router[a0_0x289ae8(0xea)](a0_0x289ae8(0x187),auth,async(_0x1537a0,_0x4deb03)=>{var _0x170d0d=a0_0x289ae8;try{const {username:_0x13ca03,email:_0x379def,role:_0x2e9429}=_0x1537a0[_0x170d0d(0x128)],_0x3fc918=_0x1537a0[_0x170d0d(0x128)],_0x711035=await profile[_0x170d0d(0x101)]({'email':_0x3fc918[_0x170d0d(0x16c)]}),_0x7a08be=await master_shop[_0x170d0d(0x18d)]();let _0x301608;if(_0x3fc918['role']=='staff'){const _0x441f5e=await staff[_0x170d0d(0x101)]({'email':_0x3fc918[_0x170d0d(0x16c)]});_0x301608=await warehouse[_0x170d0d(0x165)]([{'$match':{'status':_0x170d0d(0x132),'name':_0x441f5e[_0x170d0d(0x19c)],'warehouse_category':_0x170d0d(0x16d),'name':{'$ne':_0x170d0d(0x15a)}}},{'$group':{'_id':_0x170d0d(0x136),'name':{'$first':_0x170d0d(0x136)}}}]);}else _0x301608=await warehouse[_0x170d0d(0x165)]([{'$match':{'status':'Enabled','warehouse_category':_0x170d0d(0x16d),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x170d0d(0x136)}}}]);const _0x14327a=await product[_0x170d0d(0x18d)]({}),_0x40a8bb=await adjustment[_0x170d0d(0x18d)]({}),_0x312074=_0x40a8bb[_0x170d0d(0x17d)]+0x1,_0x35787d=_0x170d0d(0x11a)+_0x312074['toString']()[_0x170d0d(0x125)](0x5,'0');var _0x28dda2=['Ambient',_0x170d0d(0x18c),_0x170d0d(0x154)];if(_0x7a08be[0x0][_0x170d0d(0x153)]==_0x170d0d(0x115))var _0x214bed=users[_0x170d0d(0x116)];else{if(_0x7a08be[0x0][_0x170d0d(0x153)]==_0x170d0d(0x166))var _0x214bed=users[_0x170d0d(0x166)];else{if(_0x7a08be[0x0]['language']=='German')var _0x214bed=users[_0x170d0d(0x107)];else{if(_0x7a08be[0x0][_0x170d0d(0x153)]==_0x170d0d(0xe8))var _0x214bed=users[_0x170d0d(0xe8)];else{if(_0x7a08be[0x0][_0x170d0d(0x153)]=='French')var _0x214bed=users[_0x170d0d(0x168)];else{if(_0x7a08be[0x0][_0x170d0d(0x153)]=='Portuguese\x20(BR)')var _0x214bed=users[_0x170d0d(0x11d)];else{if(_0x7a08be[0x0]['language']==_0x170d0d(0x138))var _0x214bed=users[_0x170d0d(0x138)];else{if(_0x7a08be[0x0][_0x170d0d(0x153)]=='Arabic\x20(ae)')var _0x214bed=users['Arabic'];}}}}}}}const _0xbd7186=getRandom8DigitNumber();_0xbd7186[_0x170d0d(0x19b)](_0x29a6b9=>{var _0x4ca23d=_0x170d0d;_0x4deb03[_0x4ca23d(0x163)](_0x4ca23d(0x120),{'success':_0x1537a0['flash'](_0x4ca23d(0xf3)),'errors':_0x1537a0[_0x4ca23d(0x185)](_0x4ca23d(0x175)),'role':_0x3fc918,'profile':_0x711035,'warehouse':_0x301608,'product':_0x14327a,'master_shop':_0x7a08be,'language':_0x214bed,'rooms_data':_0x28dda2,'invoice_no':_0x29a6b9});})[_0x170d0d(0x12b)](_0x58b225=>{var _0x5207e1=_0x170d0d;_0x1537a0['flash'](_0x5207e1(0x175),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4deb03['redirect'](_0x5207e1(0xf4));});}catch(_0x23d808){console[_0x170d0d(0x108)](_0x23d808);}}),router['post'](a0_0x289ae8(0x187),auth,async(_0x2df1f8,_0x261d99)=>{var _0x1148da=a0_0x289ae8;try{const {warehouse_name:_0x239030,date:_0x472585,prod_name:_0x3708b6,level:_0x4f7375,isle:_0x43feb3,pallet:_0x2c8172,stock:_0x14e691,types:_0x4b2694,adjust_qty:_0x1fc83c,new_adjust_qty:_0x2f8adc,note:_0xf48e49,Room_name:_0x97ae9b,invoice:_0x2b0f3b,JO_number:_0x4561c4,expiry_date:_0xa8cc1e}=_0x2df1f8[_0x1148da(0x129)];if(typeof _0x3708b6==_0x1148da(0xe9))var _0x48d44e=[_0x2df1f8[_0x1148da(0x129)]['prod_name']],_0x16ed22=[_0x2df1f8['body'][_0x1148da(0x142)]],_0x3f4419=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x109)]],_0x16c4d3=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x143)]],_0x158a82=[_0x2df1f8['body']['New_Qty_Converted_adj']],_0x56ae0e=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x151)]],_0x584a62=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x189)]],_0x30bcee=[_0x2df1f8[_0x1148da(0x129)]['Secondary_units']],_0x48a2b2=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x196)]],_0x213e6a=[_0x2df1f8['body'][_0x1148da(0xd5)]],_0xb514ab=[_0x2df1f8['body']['expiry_date']],_0x14051e=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0xf2)]],_0x160ab2=[_0x2df1f8[_0x1148da(0x129)]['production_date']],_0x408d8e=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x195)]],_0x33a018=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x18e)]],_0x57a46a=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x18a)]],_0x1db892=[_0x2df1f8[_0x1148da(0x129)][_0x1148da(0x172)]],_0x3789a7=[_0x2df1f8[_0x1148da(0x129)]['prod_invoice']];else var _0x48d44e=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x123)]],_0x16ed22=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x142)]],_0x3f4419=[..._0x2df1f8['body'][_0x1148da(0x109)]],_0x16c4d3=[..._0x2df1f8['body'][_0x1148da(0x143)]],_0x158a82=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x197)]],_0x56ae0e=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x151)]],_0x584a62=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x110)]],_0x30bcee=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x164)]],_0x48a2b2=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x196)]],_0x213e6a=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0xd5)]],_0xb514ab=[..._0x2df1f8[_0x1148da(0x129)]['expiry_date']],_0x14051e=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0xf2)]],_0x160ab2=[..._0x2df1f8[_0x1148da(0x129)]['production_date']],_0x408d8e=[..._0x2df1f8['body'][_0x1148da(0x195)]],_0x33a018=[..._0x2df1f8['body']['Rooms']],_0x57a46a=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x18a)]],_0x1db892=[..._0x2df1f8[_0x1148da(0x129)][_0x1148da(0x172)]],_0x3789a7=[..._0x2df1f8[_0x1148da(0x129)]['prod_invoice']];const _0x409154=_0x48d44e[_0x1148da(0x11e)](_0x2841d1=>{return _0x2841d1={'product_name':_0x2841d1};});_0x16ed22[_0x1148da(0x11c)]((_0x46af88,_0x158398)=>{var _0x5f285a=_0x1148da;_0x33a018[_0x5f285a(0x11c)]((_0x187c11,_0x149d11)=>{var _0x1b1808=_0x5f285a;if(_0x187c11=='Receiving\x20Area'&&_0x158398==_0x149d11){var _0x4e90ca=_0x46af88[_0x1b1808(0x15c)](0x3);_0x409154[_0x158398][_0x1b1808(0xdd)]=_0x46af88[0x0],_0x409154[_0x158398]['rack']=_0x46af88[0x1],_0x409154[_0x158398][_0x1b1808(0x173)]=0x0,_0x409154[_0x158398]['bin']=0x0,_0x409154[_0x158398]['type']=_0x1b1808(0x1a1),_0x409154[_0x158398][_0x1b1808(0x170)]=_0x4e90ca;}else{if(_0x187c11==_0x1b1808(0xda)&&_0x158398==_0x149d11){var _0x4e90ca=_0x46af88[_0x1b1808(0x15c)](0x3);_0x409154[_0x158398][_0x1b1808(0xdd)]=_0x46af88[0x0],_0x409154[_0x158398][_0x1b1808(0x150)]=_0x46af88[0x1],_0x409154[_0x158398][_0x1b1808(0x173)]=0x0,_0x409154[_0x158398][_0x1b1808(0x12f)]=0x0,_0x409154[_0x158398][_0x1b1808(0x17a)]=_0x1b1808(0x1a1),_0x409154[_0x158398]['floorlevel']=_0x46af88[0x5];}else{if(_0x158398==_0x149d11){var _0x1a84ec;if(_0x46af88[0x4]=='L')_0x1a84ec='Level';else _0x46af88[0x4]=='F'&&(_0x1a84ec=_0x1b1808(0x1a1));_0x409154[_0x158398][_0x1b1808(0xdd)]=_0x46af88[0x0],_0x409154[_0x158398][_0x1b1808(0x150)]=_0x46af88[0x1],_0x409154[_0x158398]['bay']=_0x46af88[0x2],_0x409154[_0x158398][_0x1b1808(0x12f)]=_0x46af88[0x3],_0x409154[_0x158398][_0x1b1808(0x17a)]=_0x1a84ec,_0x409154[_0x158398][_0x1b1808(0x170)]=_0x46af88[0x5];}}}});}),_0x3f4419[_0x1148da(0x11c)]((_0x9409a1,_0x5a610c)=>{var _0x44d528=_0x1148da;_0x409154[_0x5a610c][_0x44d528(0x13b)]=_0x9409a1;}),_0x16c4d3[_0x1148da(0x11c)]((_0x5234fb,_0x1b99dd)=>{var _0xa4f376=_0x1148da;_0x409154[_0x1b99dd][_0xa4f376(0x143)]=_0x5234fb;}),_0x158a82[_0x1148da(0x11c)]((_0xaaa50,_0x39e4c3)=>{var _0x513ef3=_0x1148da;_0x409154[_0x39e4c3][_0x513ef3(0x176)]=_0xaaa50;}),_0x56ae0e[_0x1148da(0x11c)]((_0x562fda,_0x14143e)=>{var _0x19c9e3=_0x1148da;_0x409154[_0x14143e][_0x19c9e3(0x149)]=_0x562fda;}),_0x584a62[_0x1148da(0x11c)]((_0x4b2376,_0x57d481)=>{var _0x6db6b5=_0x1148da;_0x409154[_0x57d481][_0x6db6b5(0x110)]=_0x4b2376;}),_0x30bcee['forEach']((_0x1226e1,_0x17413a)=>{var _0xc6430c=_0x1148da;_0x409154[_0x17413a][_0xc6430c(0x14f)]=_0x1226e1;}),_0x48a2b2[_0x1148da(0x11c)]((_0x5253b0,_0x2257bc)=>{var _0x1dd72f=_0x1148da;_0x409154[_0x2257bc][_0x1dd72f(0x174)]=_0x5253b0;}),_0x213e6a[_0x1148da(0x11c)]((_0x59442b,_0x4da264)=>{var _0x335c17=_0x1148da;_0x409154[_0x4da264][_0x335c17(0xd5)]=_0x59442b;}),_0xb514ab[_0x1148da(0x11c)]((_0x5c4d8f,_0x47b724)=>{var _0x99ecf6=_0x1148da;_0x409154[_0x47b724][_0x99ecf6(0x1a0)]=_0x5c4d8f;}),_0x14051e['forEach']((_0x21f833,_0x6e808b)=>{var _0x356f4c=_0x1148da;_0x409154[_0x6e808b][_0x356f4c(0xe2)]=_0x21f833;}),_0x160ab2[_0x1148da(0x11c)]((_0x7da322,_0x2271c6)=>{var _0x57edb8=_0x1148da;_0x409154[_0x2271c6][_0x57edb8(0x179)]=_0x7da322;}),_0x408d8e['forEach']((_0xb795f5,_0x26e127)=>{var _0x515928=_0x1148da;_0x409154[_0x26e127][_0x515928(0x195)]=_0xb795f5;}),_0x33a018[_0x1148da(0x11c)]((_0x4e5dbd,_0x4bf585)=>{var _0x43eaf1=_0x1148da;_0x409154[_0x4bf585][_0x43eaf1(0xf0)]=_0x4e5dbd;}),_0x57a46a[_0x1148da(0x11c)]((_0x3199a0,_0x29e18c)=>{var _0x2ae79a=_0x1148da;_0x409154[_0x29e18c][_0x2ae79a(0x167)]=_0x3199a0;}),_0x1db892[_0x1148da(0x11c)]((_0x31bcf5,_0x254f0b)=>{var _0x40c38b=_0x1148da;_0x409154[_0x254f0b][_0x40c38b(0x118)]=_0x31bcf5;}),_0x3789a7['forEach']((_0x5d435a,_0x2b4cd3)=>{_0x409154[_0x2b4cd3]['invoice']=_0x5d435a;});const _0x32f9d7=_0x409154['filter'](_0x440ea2=>_0x440ea2[_0x1148da(0x176)]!=='0'&&_0x440ea2['adjust_qty']!=='');var _0x2b30d6=0x0;_0x32f9d7['forEach'](_0x5bc6f0=>{var _0xc2cb9=_0x1148da;console[_0xc2cb9(0x108)](_0xc2cb9(0x18b),_0x5bc6f0),parseInt(_0x5bc6f0['adjust_qty'])<=0x0&&_0x2b30d6++;});if(_0x2b30d6!=0x0)return _0x2df1f8[_0x1148da(0x185)](_0x1148da(0x175),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x261d99[_0x1148da(0xff)](_0x1148da(0x182));const _0x42bf09=new adjustment({'warehouse_name':_0x239030,'date':_0x472585,'product':_0x32f9d7,'note':_0xf48e49,'room':_0x97ae9b,'invoice':_0x2b0f3b,'JO_number':_0x4561c4,'expiry_date':_0xa8cc1e}),_0x590f9d=await _0x42bf09[_0x1148da(0x135)]();_0x2df1f8[_0x1148da(0x185)](_0x1148da(0xf3),_0x1148da(0xd7)),_0x261d99[_0x1148da(0xff)](_0x1148da(0xde)+_0x590f9d[_0x1148da(0xf6)]);}catch(_0x3c1dad){console[_0x1148da(0x108)](_0x3c1dad),_0x261d99[_0x1148da(0x162)](0xc8)[_0x1148da(0x14b)]({'message':_0x3c1dad[_0x1148da(0xfa)]});}}),router['get'](a0_0x289ae8(0x1a2),auth,async(_0x1725b5,_0x343c73)=>{var _0x1d7f84=a0_0x289ae8;try{const {username:_0x47a1d2,email:_0x746217,role:_0x5ac93c}=_0x1725b5['user'],_0x569dad=_0x1725b5[_0x1d7f84(0x128)],_0x310f57=await profile[_0x1d7f84(0x101)]({'email':_0x569dad[_0x1d7f84(0x16c)]}),_0x1ae1bf=await master_shop[_0x1d7f84(0x18d)](),_0xd0470f=_0x1725b5['params']['id'],_0x5de6bb=await adjustment[_0x1d7f84(0x141)]({'_id':_0xd0470f}),_0x551462=await purchases[_0x1d7f84(0x165)]([{'$match':{'warehouse_name':_0x5de6bb[_0x1d7f84(0x122)]}},{'$unwind':_0x1d7f84(0xd4)},{'$group':{'_id':'$product.product_name'}}]),_0x25ae5e=await product['find']({}),_0x5f4f42=await warehouse[_0x1d7f84(0x165)]([{'$match':{'name':_0x5de6bb[_0x1d7f84(0x122)]}},{'$unwind':_0x1d7f84(0xed)},{'$group':{'_id':_0x1d7f84(0x15e),'name':{'$first':_0x1d7f84(0x188)},'product_stock':{'$first':_0x1d7f84(0x100)},'bay':{'$first':_0x1d7f84(0x157)},'bin':{'$first':_0x1d7f84(0xe3)},'type':{'$first':_0x1d7f84(0x193)},'floorlevel':{'$first':_0x1d7f84(0xfe)},'primary_code':{'$first':_0x1d7f84(0x12e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1d7f84(0x12d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1d7f84(0x103)},'maxPerUnit':{'$first':_0x1d7f84(0xee)},'expiry_date':{'$first':_0x1d7f84(0x14a)},'production_date':{'$first':_0x1d7f84(0x111)},'batch_code':{'$first':_0x1d7f84(0x112)},'room':{'$first':_0x1d7f84(0x158)}}}]);if(_0x1ae1bf[0x0]['language']==_0x1d7f84(0x115)){var _0x3be060=users[_0x1d7f84(0x116)];console[_0x1d7f84(0x108)](_0x3be060);}else{if(_0x1ae1bf[0x0]['language']==_0x1d7f84(0x166))var _0x3be060=users[_0x1d7f84(0x166)];else{if(_0x1ae1bf[0x0]['language']==_0x1d7f84(0x107))var _0x3be060=users['German'];else{if(_0x1ae1bf[0x0][_0x1d7f84(0x153)]==_0x1d7f84(0xe8))var _0x3be060=users['Spanish'];else{if(_0x1ae1bf[0x0]['language']==_0x1d7f84(0x168))var _0x3be060=users[_0x1d7f84(0x168)];else{if(_0x1ae1bf[0x0]['language']=='Portuguese\x20(BR)')var _0x3be060=users[_0x1d7f84(0x11d)];else{if(_0x1ae1bf[0x0][_0x1d7f84(0x153)]==_0x1d7f84(0x138))var _0x3be060=users[_0x1d7f84(0x138)];else{if(_0x1ae1bf[0x0]['language']==_0x1d7f84(0x161))var _0x3be060=users['Arabic'];}}}}}}}_0x343c73[_0x1d7f84(0x163)]('edit_adjustment_view',{'success':_0x1725b5[_0x1d7f84(0x185)]('success'),'errors':_0x1725b5[_0x1d7f84(0x185)]('errors'),'role':_0x569dad,'profile':_0x310f57,'adjustment':_0x5de6bb,'stock':_0x5f4f42,'master_shop':_0x1ae1bf,'warehouse_name':_0x551462,'unit':_0x25ae5e,'language':_0x3be060});}catch(_0x52211e){console[_0x1d7f84(0x108)](_0x52211e),_0x343c73['status'](0xc8)[_0x1d7f84(0x14b)]({'message':_0x52211e[_0x1d7f84(0xfa)]});}}),router[a0_0x289ae8(0x133)](a0_0x289ae8(0x1a2),auth,async(_0x37b666,_0x51a6da)=>{var _0x7b4c5c=a0_0x289ae8;try{const _0x52b655=_0x37b666[_0x7b4c5c(0x19f)]['id'],{warehouse_name:_0x555919,Room_name:_0x7e4dbf}=_0x37b666[_0x7b4c5c(0x129)],_0x3c52ec=await adjustment[_0x7b4c5c(0x141)]({'_id':_0x52b655}),_0x6f9ec2=_0x3c52ec[_0x7b4c5c(0x13f)][_0x7b4c5c(0x11e)](async _0x98dd93=>{var _0x2d0278=_0x7b4c5c;if(_0x98dd93['adjust_qty']>0x0){var _0x30effe=await warehouse['findOne']({'name':_0x555919,'room':_0x98dd93[_0x2d0278(0xf0)],'warehouse_category':'Raw\x20Materials'});const _0x15ebfb=_0x30effe[_0x2d0278(0x105)][_0x2d0278(0x11e)](_0x4ec74d=>{var _0x57db5d=_0x2d0278;if(_0x98dd93[_0x57db5d(0x17a)]==_0x57db5d(0x119)){if(_0x4ec74d[_0x57db5d(0x19a)]==_0x98dd93['product_name']&&_0x4ec74d[_0x57db5d(0x170)]==_0x98dd93[_0x57db5d(0x170)]&&_0x4ec74d[_0x57db5d(0x17a)]==_0x98dd93[_0x57db5d(0x17a)]&&_0x4ec74d[_0x57db5d(0x12f)]==_0x98dd93[_0x57db5d(0x12f)]&&_0x4ec74d[_0x57db5d(0x173)]==_0x98dd93['bay']&&_0x4ec74d[_0x57db5d(0x150)]==_0x98dd93[_0x57db5d(0x150)]&&_0x4ec74d['storage']==_0x98dd93[_0x57db5d(0xdd)]&&_0x4ec74d[_0x57db5d(0x1a0)]==_0x98dd93[_0x57db5d(0x1a0)]&&_0x4ec74d[_0x57db5d(0xd5)]==_0x98dd93[_0x57db5d(0xd5)]&&_0x4ec74d[_0x57db5d(0x179)]==_0x98dd93[_0x57db5d(0x179)]&&_0x4ec74d['invoice']==_0x98dd93[_0x57db5d(0x15d)]){var _0x18d34b;_0x18d34b=_0x98dd93[_0x57db5d(0x176)],_0x98dd93[_0x57db5d(0x195)]=='S'&&(_0x18d34b=_0x98dd93['adjust_qty']),_0x4ec74d[_0x57db5d(0xef)]=_0x4ec74d[_0x57db5d(0xef)]-_0x18d34b;}}else{if(_0x4ec74d[_0x57db5d(0x19a)]==_0x98dd93[_0x57db5d(0x19a)]&&_0x4ec74d[_0x57db5d(0x170)]==_0x98dd93[_0x57db5d(0x170)]&&_0x4ec74d[_0x57db5d(0x17a)]==_0x98dd93[_0x57db5d(0x17a)]&&_0x4ec74d['bin']==_0x98dd93[_0x57db5d(0x12f)]&&_0x4ec74d[_0x57db5d(0x173)]==_0x98dd93['bay']&&_0x4ec74d[_0x57db5d(0x150)]==_0x98dd93[_0x57db5d(0x150)]&&_0x4ec74d[_0x57db5d(0xdd)]==_0x98dd93[_0x57db5d(0xdd)]&&_0x4ec74d[_0x57db5d(0x1a0)]==_0x98dd93[_0x57db5d(0x1a0)]&&_0x4ec74d[_0x57db5d(0xd5)]==_0x98dd93['batch_code']&&_0x4ec74d[_0x57db5d(0x179)]==_0x98dd93[_0x57db5d(0x179)]&&_0x4ec74d['invoice']==_0x98dd93[_0x57db5d(0x15d)]){console[_0x57db5d(0x108)](_0x98dd93);var _0x18d34b;_0x18d34b=_0x98dd93[_0x57db5d(0x176)],_0x98dd93['prod_cat']=='S'&&(_0x18d34b=_0x98dd93[_0x57db5d(0x176)]),console[_0x57db5d(0x108)](_0x18d34b+_0x57db5d(0x126)+_0x98dd93[_0x57db5d(0x176)]+_0x57db5d(0x126)+_0x4ec74d[_0x57db5d(0x184)]+'\x20<>\x20'+_0x98dd93[_0x57db5d(0x195)]),_0x4ec74d[_0x57db5d(0xef)]=_0x4ec74d[_0x57db5d(0xef)]+_0x18d34b;}}});}return _0x30effe;});Promise['all'](_0x6f9ec2)['then'](async _0x546ded=>{var _0x344e11=_0x7b4c5c;try{for(const _0x1b1980 of _0x546ded){await _0x1b1980[_0x344e11(0x135)]();}_0x3c52ec['finalize']=_0x344e11(0x177);const _0x5b94c1=await _0x3c52ec[_0x344e11(0x135)](),_0x1f8858=await master_shop[_0x344e11(0x18d)](),_0x12d598=await email_settings['findOne'](),_0x2cedc9=await supervisor_settings[_0x344e11(0x18d)]();var _0x5c2d50=_0x3c52ec[_0x344e11(0x13f)],_0x1470c3='',_0x25fd14;for(_0x25fd14 in _0x5c2d50){_0x1470c3+=_0x344e11(0xe6)+_0x344e11(0x134)+_0x5c2d50[_0x25fd14][_0x344e11(0x19a)]+_0x344e11(0x156)+_0x344e11(0x134)+_0x5c2d50[_0x25fd14]['product_code']+_0x344e11(0x156)+_0x344e11(0x134)+_0x5c2d50[_0x25fd14][_0x344e11(0x176)]+'</td>'+_0x344e11(0x134)+_0x5c2d50[_0x25fd14][_0x344e11(0x110)]+'</td>'+_0x344e11(0x134)+_0x5c2d50[_0x25fd14][_0x344e11(0x14f)]+_0x344e11(0x156)+_0x344e11(0x134)+_0x3c52ec[_0x344e11(0x122)]+_0x344e11(0x156)+_0x344e11(0x134)+_0x5c2d50[_0x25fd14][_0x344e11(0xf0)]+_0x344e11(0x156)+_0x344e11(0x134)+_0x5c2d50[_0x25fd14][_0x344e11(0xdd)]+_0x5c2d50[_0x25fd14][_0x344e11(0x150)]+_0x5c2d50[_0x25fd14]['bay']+_0x5c2d50[_0x25fd14]['bin']+_0x5c2d50[_0x25fd14][_0x344e11(0x17a)][0x0]+_0x5c2d50[_0x25fd14][_0x344e11(0x170)]+_0x344e11(0x156),'</tr>';}let _0x2dccfe=nodemailer[_0x344e11(0x12c)]({'host':_0x12d598['host'],'port':Number(_0x12d598[_0x344e11(0x13e)]),'secure':![],'auth':{'user':_0x12d598['email'],'pass':_0x12d598['password']}}),_0x375dcd={'from':_0x12d598[_0x344e11(0x16c)],'to':_0x2cedc9[0x0][_0x344e11(0x19d)],'subject':_0x344e11(0x10b),'attachments':[{'filename':_0x344e11(0x146),'path':__dirname+_0x344e11(0xdf)+'/upload/'+_0x1f8858[0x0][_0x344e11(0x140)],'cid':_0x344e11(0xfc)}],'html':_0x344e11(0x155)+_0x344e11(0x180)+'</head><body>'+_0x344e11(0x17b)+_0x344e11(0x190)+'<div>'+_0x344e11(0x131)+_0x344e11(0x106)+_0x344e11(0x17b)+'<h2>\x20'+_0x1f8858[0x0]['site_title']+_0x344e11(0x15f)+_0x344e11(0x106)+'</div>'+_0x344e11(0xf1)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x344e11(0x13d)+_0x3c52ec[_0x344e11(0x15d)]+'\x20'+_0x344e11(0xe4)+_0x344e11(0x11b)+_0x3c52ec[_0x344e11(0x124)]+'\x20'+_0x344e11(0x10a)+'</h5>'+_0x344e11(0x106)+_0x344e11(0x160)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x344e11(0x130)+_0x344e11(0x17f)+_0x344e11(0x102)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x344e11(0x199)+_0x344e11(0xec)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x344e11(0x17c)+_0x344e11(0xd8)+_0x344e11(0x14d)+'\x20'+_0x1470c3+'\x20'+_0x344e11(0x10e)+'</table>'+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x344e11(0x18f)+_0x1f8858[0x0]['site_title']+_0x344e11(0x16e)+_0x344e11(0x106)+'</div>'+_0x344e11(0xdb)};_0x2dccfe[_0x344e11(0x181)](_0x375dcd,function(_0x3f6de3,_0x4c8a73){var _0xf2c5ce=_0x344e11;_0x3f6de3?(console[_0xf2c5ce(0x108)](_0x3f6de3),console[_0xf2c5ce(0x108)](_0xf2c5ce(0x169))):console[_0xf2c5ce(0x108)](_0xf2c5ce(0x14e));}),_0x37b666['flash'](_0x344e11(0xf3),_0x344e11(0x114)),_0x51a6da[_0x344e11(0xff)](_0x344e11(0xf8)+_0x5b94c1[_0x344e11(0xf6)]);}catch(_0x15b777){console[_0x344e11(0x152)](_0x15b777),_0x51a6da['status'](0x1f4)[_0x344e11(0x14b)]({'error':_0x344e11(0x16b)});}})['catch'](_0x3ff6e3=>{var _0x458273=_0x7b4c5c;console[_0x458273(0x152)](_0x3ff6e3),_0x51a6da[_0x458273(0x162)](0x1f4)[_0x458273(0x14b)]({'error':_0x458273(0x104)});});}catch(_0x520a25){console[_0x7b4c5c(0x108)](_0x520a25),_0x51a6da['status'](0xc8)[_0x7b4c5c(0x14b)]({'message':_0x520a25[_0x7b4c5c(0xfa)]});}}),router[a0_0x289ae8(0xea)](a0_0x289ae8(0x183),auth,async(_0x59e237,_0x122b90)=>{var _0x5b567f=a0_0x289ae8;try{const {username:_0x45dc4d,email:_0x5b0207,role:_0x6814b2}=_0x59e237[_0x5b567f(0x128)],_0x3ef33b=_0x59e237[_0x5b567f(0x128)],_0x5cf45e=await profile['findOne']({'email':_0x3ef33b[_0x5b567f(0x16c)]}),_0x1f15a7=await master_shop[_0x5b567f(0x18d)](),_0x337494=_0x59e237[_0x5b567f(0x19f)]['id'],_0x10aef5=await adjustment[_0x5b567f(0x141)]({'_id':_0x337494}),_0x31517b=await purchases[_0x5b567f(0x165)]([{'$match':{'warehouse_name':_0x10aef5[_0x5b567f(0x122)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5b567f(0xd6)}}]),_0x47cd52=await product[_0x5b567f(0x18d)]({}),_0x36e3bc=await warehouse[_0x5b567f(0x165)]([{'$match':{'name':_0x10aef5[_0x5b567f(0x122)]}},{'$unwind':_0x5b567f(0xed)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5b567f(0x188)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5b567f(0x157)},'bin':{'$first':_0x5b567f(0xe3)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5b567f(0x117)},'product_code':{'$first':_0x5b567f(0x12d)},'storage':{'$first':_0x5b567f(0x178)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x5b567f(0xee)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x5b567f(0x112)},'room':{'$first':_0x5b567f(0x158)}}}]);let _0x108929;if(_0x3ef33b[_0x5b567f(0x11f)]==_0x5b567f(0x192)){const _0x18b662=await staff['findOne']({'email':_0x3ef33b[_0x5b567f(0x16c)]});_0x108929=await warehouse[_0x5b567f(0x165)]([{'$match':{'status':_0x5b567f(0x132),'name':_0x18b662['warehouse'],'warehouse_category':_0x5b567f(0x16d),'name':{'$ne':_0x5b567f(0x15a)}}},{'$group':{'_id':'$name','name':{'$first':_0x5b567f(0x136)}}}]);}else _0x108929=await warehouse[_0x5b567f(0x165)]([{'$match':{'status':_0x5b567f(0x132),'warehouse_category':_0x5b567f(0x16d),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x5b567f(0x136),'name':{'$first':'$name'}}}]);if(_0x1f15a7[0x0][_0x5b567f(0x153)]==_0x5b567f(0x115)){var _0x2db1e1=users['English'];console[_0x5b567f(0x108)](_0x2db1e1);}else{if(_0x1f15a7[0x0]['language']=='Hindi')var _0x2db1e1=users[_0x5b567f(0x166)];else{if(_0x1f15a7[0x0][_0x5b567f(0x153)]==_0x5b567f(0x107))var _0x2db1e1=users['German'];else{if(_0x1f15a7[0x0][_0x5b567f(0x153)]==_0x5b567f(0xe8))var _0x2db1e1=users['Spanish'];else{if(_0x1f15a7[0x0]['language']==_0x5b567f(0x168))var _0x2db1e1=users['French'];else{if(_0x1f15a7[0x0][_0x5b567f(0x153)]==_0x5b567f(0xfd))var _0x2db1e1=users[_0x5b567f(0x11d)];else{if(_0x1f15a7[0x0][_0x5b567f(0x153)]==_0x5b567f(0x138))var _0x2db1e1=users['Chinese'];else{if(_0x1f15a7[0x0][_0x5b567f(0x153)]==_0x5b567f(0x161))var _0x2db1e1=users[_0x5b567f(0xe1)];}}}}}}}_0x122b90[_0x5b567f(0x163)](_0x5b567f(0xf9),{'success':_0x59e237[_0x5b567f(0x185)](_0x5b567f(0xf3)),'errors':_0x59e237['flash'](_0x5b567f(0x175)),'role':_0x3ef33b,'profile':_0x5cf45e,'adjustment':_0x10aef5,'stock':_0x36e3bc,'master_shop':_0x1f15a7,'warehouse_name':_0x31517b,'unit':_0x47cd52,'language':_0x2db1e1,'warehouse':_0x108929});}catch(_0x42314a){console[_0x5b567f(0x108)](_0x42314a),_0x122b90[_0x5b567f(0x162)](0xc8)[_0x5b567f(0x14b)]({'message':_0x42314a['message']});}}),router[a0_0x289ae8(0x133)](a0_0x289ae8(0x183),auth,async(_0x1a17e8,_0x49c354)=>{var _0x2425da=a0_0x289ae8;try{const _0x559ce6=_0x1a17e8['params']['id'],_0x1e6023=await adjustment[_0x2425da(0x141)]({'_id':_0x559ce6}),_0xf13d28=await warehouse['findOne']({'name':_0x1e6023[_0x2425da(0x122)],'room':_0x1e6023['room']}),{warehouse_name:_0x2cd421,date:_0x212205,prod_name:_0x53ab6e,level:_0x5a7e2a,isle:_0x4a5c3a,pallet:_0xf4b34,stock:_0xb696c3,types:_0x5ecccd,adjust_qty:_0x4bcdb9,new_adjust_qty:_0x2087c6,note:_0x31caa0,Room_name:_0xd1f4d3,invoice:_0x22a01b,JO_number:_0x563adb,expiry_date:_0x4b489e}=_0x1a17e8['body'];if(typeof _0x53ab6e==_0x2425da(0xe9))var _0x2de022=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x123)]],_0x48479d=[_0x1a17e8['body'][_0x2425da(0x142)]],_0x226725=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x109)]],_0x1e4090=[_0x1a17e8['body']['types']],_0x58887c=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x197)]],_0x39269d=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x151)]],_0x495237=[_0x1a17e8[_0x2425da(0x129)]['Primary_Units']],_0x3e92c9=[_0x1a17e8[_0x2425da(0x129)]['Secondary_units']],_0x3b5fc9=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x196)]],_0x1b5879=[_0x1a17e8['body'][_0x2425da(0xd5)]],_0xd1803a=[_0x1a17e8['body'][_0x2425da(0x1a0)]],_0x56958d=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0xf2)]],_0x23bf60=[_0x1a17e8['body'][_0x2425da(0x179)]],_0x42f4ec=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x195)]],_0x31fcb7=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x18e)]],_0x2f2efd=[_0x1a17e8['body']['prime1']],_0x48c338=[_0x1a17e8[_0x2425da(0x129)][_0x2425da(0x172)]];else var _0x2de022=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0x123)]],_0x48479d=[..._0x1a17e8['body'][_0x2425da(0x142)]],_0x226725=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0x109)]],_0x1e4090=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0x143)]],_0x58887c=[..._0x1a17e8[_0x2425da(0x129)]['New_Qty_Converted_adj']],_0x39269d=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0x151)]],_0x495237=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0x110)]],_0x3e92c9=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0x164)]],_0x3b5fc9=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0x196)]],_0x1b5879=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0xd5)]],_0xd1803a=[..._0x1a17e8[_0x2425da(0x129)]['expiry_date']],_0x56958d=[..._0x1a17e8[_0x2425da(0x129)][_0x2425da(0xf2)]],_0x23bf60=[..._0x1a17e8['body'][_0x2425da(0x179)]],_0x42f4ec=[..._0x1a17e8['body'][_0x2425da(0x195)]],_0x31fcb7=[..._0x1a17e8[_0x2425da(0x129)]['Rooms']],_0x2f2efd=[..._0x1a17e8[_0x2425da(0x129)]['prime1']],_0x48c338=[..._0x1a17e8['body'][_0x2425da(0x172)]];const _0x112fdf=_0x2de022[_0x2425da(0x11e)](_0x3e3055=>{return _0x3e3055={'product_name':_0x3e3055};});_0x48479d['forEach']((_0x1345f5,_0x47d35f)=>{var _0x350252=_0x2425da;_0x31fcb7[_0x350252(0x11c)]((_0x3c4789,_0xe8437)=>{var _0x387f7d=_0x350252;if(_0x3c4789==_0x387f7d(0xe5)&&_0x47d35f==_0xe8437){var _0x1ba554=_0x1345f5[_0x387f7d(0x15c)](0x3);_0x112fdf[_0x47d35f][_0x387f7d(0xdd)]=_0x1345f5[0x0],_0x112fdf[_0x47d35f][_0x387f7d(0x150)]=_0x1345f5[0x1],_0x112fdf[_0x47d35f]['bay']=0x0,_0x112fdf[_0x47d35f]['bin']=0x0,_0x112fdf[_0x47d35f]['type']='Floor',_0x112fdf[_0x47d35f]['floorlevel']=_0x1ba554;}else{if(_0x3c4789==_0x387f7d(0xda)&&_0x47d35f==_0xe8437){var _0x1ba554=_0x1345f5['slice'](0x3);_0x112fdf[_0x47d35f]['storage']=_0x1345f5[0x0],_0x112fdf[_0x47d35f][_0x387f7d(0x150)]=_0x1345f5[0x1],_0x112fdf[_0x47d35f][_0x387f7d(0x173)]=0x0,_0x112fdf[_0x47d35f][_0x387f7d(0x12f)]=0x0,_0x112fdf[_0x47d35f][_0x387f7d(0x17a)]=_0x387f7d(0x1a1),_0x112fdf[_0x47d35f]['floorlevel']=_0x1345f5[0x5];}else{if(_0x47d35f==_0xe8437){var _0xce79d5;if(_0x1345f5[0x4]=='L')_0xce79d5='Level';else _0x1345f5[0x4]=='F'&&(_0xce79d5=_0x387f7d(0x1a1));_0x112fdf[_0x47d35f][_0x387f7d(0xdd)]=_0x1345f5[0x0],_0x112fdf[_0x47d35f][_0x387f7d(0x150)]=_0x1345f5[0x1],_0x112fdf[_0x47d35f][_0x387f7d(0x173)]=_0x1345f5[0x2],_0x112fdf[_0x47d35f][_0x387f7d(0x12f)]=_0x1345f5[0x3],_0x112fdf[_0x47d35f][_0x387f7d(0x17a)]=_0xce79d5,_0x112fdf[_0x47d35f][_0x387f7d(0x170)]=_0x1345f5[0x5];}}}});}),_0x226725['forEach']((_0x4ff47c,_0x4d038f)=>{_0x112fdf[_0x4d038f]['stockBefore']=_0x4ff47c;}),_0x1e4090[_0x2425da(0x11c)]((_0x875a7e,_0x147bba)=>{var _0x3afabf=_0x2425da;_0x112fdf[_0x147bba][_0x3afabf(0x143)]=_0x875a7e;}),_0x58887c[_0x2425da(0x11c)]((_0x55cf98,_0x45f7d1)=>{var _0x3220f1=_0x2425da;_0x112fdf[_0x45f7d1][_0x3220f1(0x176)]=_0x55cf98;}),_0x39269d[_0x2425da(0x11c)]((_0x243214,_0x9143a9)=>{var _0xd3af02=_0x2425da;_0x112fdf[_0x9143a9][_0xd3af02(0x149)]=_0x243214;}),_0x495237['forEach']((_0x8484c6,_0x43c52d)=>{var _0x170895=_0x2425da;_0x112fdf[_0x43c52d][_0x170895(0x110)]=_0x8484c6;}),_0x3e92c9[_0x2425da(0x11c)]((_0x2ff114,_0x8bfb3d)=>{var _0x5e6b6b=_0x2425da;_0x112fdf[_0x8bfb3d][_0x5e6b6b(0x14f)]=_0x2ff114;}),_0x3b5fc9['forEach']((_0x37874e,_0x5cb944)=>{_0x112fdf[_0x5cb944]['product_code']=_0x37874e;}),_0x1b5879[_0x2425da(0x11c)]((_0x367316,_0x19cc2e)=>{var _0x3e3b24=_0x2425da;_0x112fdf[_0x19cc2e][_0x3e3b24(0xd5)]=_0x367316;}),_0xd1803a[_0x2425da(0x11c)]((_0xa94081,_0x368067)=>{var _0x2c9e69=_0x2425da;_0x112fdf[_0x368067][_0x2c9e69(0x1a0)]=_0xa94081;}),_0x56958d[_0x2425da(0x11c)]((_0x5f051f,_0x356c66)=>{_0x112fdf[_0x356c66]['maxperunit']=_0x5f051f;}),_0x23bf60['forEach']((_0x2394c0,_0x41cf88)=>{var _0xea7539=_0x2425da;_0x112fdf[_0x41cf88][_0xea7539(0x179)]=_0x2394c0;}),_0x42f4ec['forEach']((_0x142816,_0x5409de)=>{var _0x14ccbf=_0x2425da;_0x112fdf[_0x5409de][_0x14ccbf(0x195)]=_0x142816;}),_0x31fcb7[_0x2425da(0x11c)]((_0x168af4,_0x279fc7)=>{var _0xf08b18=_0x2425da;_0x112fdf[_0x279fc7][_0xf08b18(0xf0)]=_0x168af4;}),_0x2f2efd[_0x2425da(0x11c)]((_0x55da47,_0x95fd17)=>{var _0x31d3dc=_0x2425da;_0x112fdf[_0x95fd17][_0x31d3dc(0x167)]=_0x55da47;}),_0x48c338[_0x2425da(0x11c)]((_0x15d4d4,_0x5d3a84)=>{var _0x5d4477=_0x2425da;_0x112fdf[_0x5d3a84][_0x5d4477(0x118)]=_0x15d4d4;});const _0x224728=_0x112fdf[_0x2425da(0x10f)](_0x11d584=>_0x11d584[_0x2425da(0x176)]!=='0'&&_0x11d584[_0x2425da(0x176)]!=='');var _0x2c06a8=0x0;_0x224728[_0x2425da(0x11c)](_0x1c12a0=>{var _0x39b5b2=_0x2425da;console[_0x39b5b2(0x108)](_0x39b5b2(0x18b),_0x1c12a0),parseInt(_0x1c12a0[_0x39b5b2(0x176)])<=0x0&&_0x2c06a8++;});if(_0x2c06a8!=0x0)return _0x1a17e8['flash']('errors',_0x2425da(0x191)),_0x49c354[_0x2425da(0xff)](_0x2425da(0x182));_0x1e6023['warehouse_name']=_0x2cd421,_0x1e6023[_0x2425da(0x124)]=_0x212205,_0x1e6023[_0x2425da(0x13f)]=_0x224728,_0x1e6023[_0x2425da(0xdc)]=_0x31caa0,_0x1e6023[_0x2425da(0x15d)]=_0x22a01b,_0x1e6023['isAllowEdit']='False';const _0xdce028=await _0x1e6023[_0x2425da(0x135)]();_0x1a17e8['flash'](_0x2425da(0xf3),'adjustment\x20data\x20update\x20successfully'),_0x49c354[_0x2425da(0xff)](_0x2425da(0xf4));}catch(_0x1b4dd3){console[_0x2425da(0x108)](_0x1b4dd3);}}),router[a0_0x289ae8(0x133)](a0_0x289ae8(0x16a),async(_0x25c0a1,_0x14d4de)=>{var _0x371a55=a0_0x289ae8;const {primary_code:_0x375399,warehouse_data:_0x5b28bc,rooms_data:_0x2c7a72,Roomslist:_0x2606f6}=_0x25c0a1['body'],_0x40be78=_0x2606f6[_0x371a55(0x171)](','),_0x1ceec9=[];async function _0x1e386e(_0x2dd7f3){var _0x1c486e=_0x371a55;const _0x188320=await warehouse[_0x1c486e(0x165)]([{'$match':{'name':_0x5b28bc,'room':_0x2dd7f3}},{'$unwind':_0x1c486e(0xed)},{'$match':{'product_details.primary_code':_0x375399}},{'$group':{'_id':_0x1c486e(0x15e),'name':{'$first':_0x1c486e(0x188)},'product_stock':{'$first':_0x1c486e(0x100)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1c486e(0x117)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x1c486e(0x157)},'isle':{'$first':_0x1c486e(0xe3)},'type':{'$first':_0x1c486e(0x193)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x1c486e(0x178)},'rack':{'$first':_0x1c486e(0x103)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1c486e(0x111)},'maxPerUnit':{'$first':_0x1c486e(0xee)},'batch_code':{'$first':_0x1c486e(0x112)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1c486e(0x158)}}}]),_0x565d2f=await warehouse[_0x1c486e(0x165)]([{'$match':{'name':_0x5b28bc,'room':_0x2dd7f3}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x375399}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1c486e(0x188)},'product_stock':{'$first':_0x1c486e(0x100)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1c486e(0xe3)},'type':{'$first':_0x1c486e(0x193)},'pallet':{'$first':_0x1c486e(0xfe)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1c486e(0x145)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1c486e(0x103)},'expiry_date':{'$first':_0x1c486e(0x14a)},'production_date':{'$first':_0x1c486e(0x111)},'maxPerUnit':{'$first':_0x1c486e(0xee)},'batch_code':{'$first':_0x1c486e(0x112)},'product_cat':{'$first':_0x1c486e(0xe0)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x188320[_0x1c486e(0x17d)]>0x0)_0x1ceec9[_0x1c486e(0x15b)](_0x188320);else _0x565d2f[_0x1c486e(0x17d)]>0x0&&_0x1ceec9[_0x1c486e(0x15b)](_0x565d2f);}const _0x465131=_0x40be78[_0x371a55(0x11e)](_0x222e46=>_0x1e386e(_0x222e46));await Promise[_0x371a55(0x12a)](_0x465131),_0x14d4de['json'](_0x1ceec9);}),router[a0_0x289ae8(0x133)](a0_0x289ae8(0x139),async(_0x294509,_0x55fef8)=>{var _0x5268ee=a0_0x289ae8;const {primaryCode:_0x3f77c5,secondaryCode:_0x5caf2c,productCode:_0xeba422,level:_0x590475,isle:_0x448755,pallet:_0x5ab1e1,warehouses:_0x61fc47,room:_0x5757f4}=_0x294509[_0x5268ee(0x129)];try{const _0x38cf7c=await warehouse[_0x5268ee(0x165)]([{'$match':{'name':_0x61fc47,'room':_0x5757f4}},{'$unwind':_0x5268ee(0xed)},{'$match':{'product_details.level':parseInt(_0x590475),'product_details.isle':_0x448755,'product_details.pallet':parseInt(_0x5ab1e1)}},{'$group':{'_id':_0x5268ee(0x15e),'name':{'$first':_0x5268ee(0x188)},'product_stock':{'$first':_0x5268ee(0x100)},'level':{'$first':_0x5268ee(0x144)},'isle':{'$first':_0x5268ee(0x113)},'pallet':{'$first':_0x5268ee(0x194)},'maxProducts':{'$first':_0x5268ee(0x16f)}}}]);_0x55fef8[_0x5268ee(0x162)](0xc8)['json'](_0x38cf7c);}catch(_0x534ddd){_0x55fef8[_0x5268ee(0x162)](0x194)[_0x5268ee(0x14b)]({'message':_0x534ddd[_0x5268ee(0xfa)]});}}),module[a0_0x289ae8(0x127)]=router;