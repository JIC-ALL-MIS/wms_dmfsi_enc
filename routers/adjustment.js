var a0_0x1facd3=a0_0x49f4;(function(_0x23468a,_0x13270e){var _0xbc069c=a0_0x49f4,_0x18224d=_0x23468a();while(!![]){try{var _0x3855c2=-parseInt(_0xbc069c(0x223))/0x1+-parseInt(_0xbc069c(0x1c7))/0x2+-parseInt(_0xbc069c(0x1d3))/0x3*(-parseInt(_0xbc069c(0x252))/0x4)+-parseInt(_0xbc069c(0x1e5))/0x5+parseInt(_0xbc069c(0x216))/0x6*(-parseInt(_0xbc069c(0x1f6))/0x7)+parseInt(_0xbc069c(0x22d))/0x8+parseInt(_0xbc069c(0x206))/0x9*(parseInt(_0xbc069c(0x1bf))/0xa);if(_0x3855c2===_0x13270e)break;else _0x18224d['push'](_0x18224d['shift']());}catch(_0x4be659){_0x18224d['push'](_0x18224d['shift']());}}}(a0_0x398e,0x2abd5));const express=require('express'),app=express(),router=express[a0_0x1facd3(0x283)](),auth=require(a0_0x1facd3(0x1d7)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1facd3(0x259)),users=require(a0_0x1facd3(0x20c)),nodemailer=require(a0_0x1facd3(0x27c));router['get'](a0_0x1facd3(0x25f),auth,async(_0x35a09d,_0x2544a9)=>{var _0x12a546=a0_0x1facd3;try{const {username:_0x583069,email:_0xa9e24f,role:_0x1401da}=_0x35a09d[_0x12a546(0x20f)],_0x940c22=_0x35a09d[_0x12a546(0x20f)],_0x32f8f7=await profile[_0x12a546(0x20b)]({'email':_0x940c22['email']}),_0x1e160b=await master_shop[_0x12a546(0x250)]();console[_0x12a546(0x1e9)](_0x12a546(0x1de),_0x1e160b);let _0x16adf3;if(_0x940c22[_0x12a546(0x1c6)]==_0x12a546(0x248)){const _0x37f999=await staff[_0x12a546(0x20b)]({'email':_0x940c22[_0x12a546(0x261)]});_0x16adf3=await warehouse[_0x12a546(0x250)]({'status':'Enabled','name':_0x37f999[_0x12a546(0x26a)]});}else _0x16adf3=await warehouse['find']({'status':_0x12a546(0x1f4)});const _0x20e5fd=await product['find']();let _0x4f1407;if(_0x940c22[_0x12a546(0x1c6)]==_0x12a546(0x248)){const _0x3be346=await staff[_0x12a546(0x20b)]({'email':_0x940c22[_0x12a546(0x261)]});_0x4f1407=await adjustment[_0x12a546(0x250)]({'warehouse_name':_0x3be346['warehouse']});}else _0x4f1407=await adjustment[_0x12a546(0x215)]([{'$unwind':_0x12a546(0x1d1)},{'$group':{'_id':_0x12a546(0x1f1),'invoice':{'$first':_0x12a546(0x270)},'date':{'$first':_0x12a546(0x20d)},'warehouse_name':{'$first':_0x12a546(0x231)},'room':{'$addToSet':_0x12a546(0x247)},'finalize':{'$first':_0x12a546(0x211)},'isAllowEdit':{'$first':_0x12a546(0x242)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1e160b[0x0][_0x12a546(0x275)]=='English\x20(US)'){var _0x38ed19=users['English'];console[_0x12a546(0x1e9)](_0x38ed19);}else{if(_0x1e160b[0x0]['language']==_0x12a546(0x1f7))var _0x38ed19=users[_0x12a546(0x1f7)];else{if(_0x1e160b[0x0][_0x12a546(0x275)]==_0x12a546(0x267))var _0x38ed19=users[_0x12a546(0x267)];else{if(_0x1e160b[0x0][_0x12a546(0x275)]==_0x12a546(0x1f3))var _0x38ed19=users[_0x12a546(0x1f3)];else{if(_0x1e160b[0x0][_0x12a546(0x275)]==_0x12a546(0x23d))var _0x38ed19=users[_0x12a546(0x23d)];else{if(_0x1e160b[0x0][_0x12a546(0x275)]==_0x12a546(0x1fd))var _0x38ed19=users[_0x12a546(0x200)];else{if(_0x1e160b[0x0][_0x12a546(0x275)]==_0x12a546(0x26f))var _0x38ed19=users[_0x12a546(0x26f)];else{if(_0x1e160b[0x0][_0x12a546(0x275)]==_0x12a546(0x257))var _0x38ed19=users['Arabic'];}}}}}}}_0x2544a9[_0x12a546(0x227)](_0x12a546(0x21d),{'success':_0x35a09d['flash'](_0x12a546(0x220)),'errors':_0x35a09d[_0x12a546(0x21a)](_0x12a546(0x219)),'role':_0x940c22,'profile':_0x32f8f7,'warehouse':_0x16adf3,'product':_0x20e5fd,'adjustment':_0x4f1407,'master_shop':_0x1e160b,'language':_0x38ed19});}catch(_0x26e0b2){console[_0x12a546(0x1e9)](_0x26e0b2);}});async function getRandom8DigitNumber(){var _0x4e16fe=a0_0x1facd3;const _0x587ad4=0x989680,_0x207ab6=0x5f5e0ff,_0x4a3bc2=Math['floor'](Math[_0x4e16fe(0x243)]()*(_0x207ab6-_0x587ad4+0x1))+_0x587ad4;var _0x4ba87f;const _0x4e3ba8=await adjustment['findOne']({'invoice':_0x4e16fe(0x1d8)+_0x4a3bc2});return _0x4e3ba8&&_0x4e3ba8[_0x4e16fe(0x28a)]>0x0?_0x4ba87f='ADJ-'+_0x4a3bc2:_0x4ba87f=_0x4e16fe(0x1d8)+_0x4a3bc2,_0x4ba87f;}router[a0_0x1facd3(0x263)](a0_0x1facd3(0x264),auth,async(_0x52b77c,_0x2a6320)=>{var _0x2ee95a=a0_0x1facd3;try{const {username:_0x282e12,email:_0x5ae02a,role:_0x37d942}=_0x52b77c['user'],_0x3bc007=_0x52b77c['user'],_0x40bacb=await profile[_0x2ee95a(0x20b)]({'email':_0x3bc007[_0x2ee95a(0x261)]}),_0x2e6801=await master_shop[_0x2ee95a(0x250)]();let _0xc40954;if(_0x3bc007[_0x2ee95a(0x1c6)]==_0x2ee95a(0x248)){const _0x847cb3=await staff[_0x2ee95a(0x20b)]({'email':_0x3bc007[_0x2ee95a(0x261)]});_0xc40954=await warehouse[_0x2ee95a(0x215)]([{'$match':{'status':'Enabled','name':_0x847cb3['warehouse'],'warehouse_category':_0x2ee95a(0x26e),'name':{'$ne':_0x2ee95a(0x253)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0xc40954=await warehouse[_0x2ee95a(0x215)]([{'$match':{'status':_0x2ee95a(0x1f4),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x2ee95a(0x253)}}},{'$group':{'_id':_0x2ee95a(0x27a),'name':{'$first':_0x2ee95a(0x27a)}}}]);const _0x1b0c0e=await product['find']({}),_0x161544=await adjustment[_0x2ee95a(0x250)]({}),_0x118dcc=_0x161544[_0x2ee95a(0x28a)]+0x1,_0x4f5b32='ADJ-'+_0x118dcc[_0x2ee95a(0x1cd)]()[_0x2ee95a(0x1ff)](0x5,'0');var _0x53df32=[_0x2ee95a(0x278),_0x2ee95a(0x287),_0x2ee95a(0x1c8)];if(_0x2e6801[0x0]['language']==_0x2ee95a(0x1d9))var _0x18891d=users[_0x2ee95a(0x28c)];else{if(_0x2e6801[0x0][_0x2ee95a(0x275)]==_0x2ee95a(0x1f7))var _0x18891d=users[_0x2ee95a(0x1f7)];else{if(_0x2e6801[0x0][_0x2ee95a(0x275)]==_0x2ee95a(0x267))var _0x18891d=users[_0x2ee95a(0x267)];else{if(_0x2e6801[0x0]['language']=='Spanish')var _0x18891d=users[_0x2ee95a(0x1f3)];else{if(_0x2e6801[0x0]['language']=='French')var _0x18891d=users[_0x2ee95a(0x23d)];else{if(_0x2e6801[0x0][_0x2ee95a(0x275)]==_0x2ee95a(0x1fd))var _0x18891d=users[_0x2ee95a(0x200)];else{if(_0x2e6801[0x0]['language']=='Chinese')var _0x18891d=users[_0x2ee95a(0x26f)];else{if(_0x2e6801[0x0][_0x2ee95a(0x275)]==_0x2ee95a(0x257))var _0x18891d=users[_0x2ee95a(0x1db)];}}}}}}}const _0xf9d438=getRandom8DigitNumber();_0xf9d438['then'](_0x583367=>{var _0x2697b6=_0x2ee95a;_0x2a6320[_0x2697b6(0x227)]('add_adjustment',{'success':_0x52b77c[_0x2697b6(0x21a)](_0x2697b6(0x220)),'errors':_0x52b77c[_0x2697b6(0x21a)]('errors'),'role':_0x3bc007,'profile':_0x40bacb,'warehouse':_0xc40954,'product':_0x1b0c0e,'master_shop':_0x2e6801,'language':_0x18891d,'rooms_data':_0x53df32,'invoice_no':_0x583367});})[_0x2ee95a(0x1e2)](_0x4cda82=>{var _0x516571=_0x2ee95a;_0x52b77c[_0x516571(0x21a)](_0x516571(0x219),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x2a6320[_0x516571(0x207)]('/adjustment/view');});}catch(_0x2011b9){console['log'](_0x2011b9);}}),router[a0_0x1facd3(0x1d0)](a0_0x1facd3(0x264),auth,async(_0x4b66a9,_0x119c55)=>{var _0x35a44c=a0_0x1facd3;try{const {warehouse_name:_0x16d173,date:_0x5cdd89,prod_name:_0x382049,level:_0x8d3b05,isle:_0x123774,pallet:_0x240df7,stock:_0x548304,types:_0x5dc705,adjust_qty:_0x8d13f2,new_adjust_qty:_0x3a563c,note:_0x1a7eb8,Room_name:_0x194259,invoice:_0xcb9cd7,JO_number:_0xef2bed,expiry_date:_0x490ec1}=_0x4b66a9[_0x35a44c(0x1ea)];if(typeof _0x382049==_0x35a44c(0x23b))var _0x2d1af6=[_0x4b66a9['body'][_0x35a44c(0x24a)]],_0xcd1c00=[_0x4b66a9[_0x35a44c(0x1ea)]['level']],_0x196642=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x1ee)]],_0x2ad959=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x1c0)]],_0x322d57=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x238)]],_0x29fc1a=[_0x4b66a9['body'][_0x35a44c(0x24b)]],_0x59cbef=[_0x4b66a9['body']['Primary_Units']],_0x3bd905=[_0x4b66a9[_0x35a44c(0x1ea)]['Secondary_units']],_0x1c7e6d=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x1d6)]],_0x19d48a=[_0x4b66a9['body'][_0x35a44c(0x1c5)]],_0x423f73=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x236)]],_0x2dec37=[_0x4b66a9[_0x35a44c(0x1ea)]['max_per_unit']],_0x28a873=[_0x4b66a9[_0x35a44c(0x1ea)]['production_date']],_0x8f7a7b=[_0x4b66a9[_0x35a44c(0x1ea)]['prod_cat']],_0x45e858=[_0x4b66a9[_0x35a44c(0x1ea)]['Rooms']],_0x12ebd4=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x213)]],_0x58e497=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x1d2)]],_0x145e0f=[_0x4b66a9[_0x35a44c(0x1ea)]['prod_invoice']],_0x2b3007=[_0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x26d)]];else var _0x2d1af6=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x24a)]],_0xcd1c00=[..._0x4b66a9[_0x35a44c(0x1ea)]['level']],_0x196642=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x1ee)]],_0x2ad959=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x1c0)]],_0x322d57=[..._0x4b66a9['body']['New_Qty_Converted_adj']],_0x29fc1a=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x24b)]],_0x59cbef=[..._0x4b66a9['body'][_0x35a44c(0x1e4)]],_0x3bd905=[..._0x4b66a9['body'][_0x35a44c(0x244)]],_0x1c7e6d=[..._0x4b66a9[_0x35a44c(0x1ea)]['prod_code']],_0x19d48a=[..._0x4b66a9[_0x35a44c(0x1ea)]['batch_code']],_0x423f73=[..._0x4b66a9['body'][_0x35a44c(0x236)]],_0x2dec37=[..._0x4b66a9[_0x35a44c(0x1ea)]['max_per_unit']],_0x28a873=[..._0x4b66a9[_0x35a44c(0x1ea)]['production_date']],_0x8f7a7b=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x246)]],_0x45e858=[..._0x4b66a9['body'][_0x35a44c(0x21e)]],_0x12ebd4=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x213)]],_0x58e497=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x1d2)]],_0x145e0f=[..._0x4b66a9[_0x35a44c(0x1ea)]['prod_invoice']],_0x2b3007=[..._0x4b66a9[_0x35a44c(0x1ea)][_0x35a44c(0x26d)]];const _0x19e3aa=_0x2d1af6[_0x35a44c(0x1cf)](_0x2cc892=>{return _0x2cc892={'product_name':_0x2cc892};});_0xcd1c00[_0x35a44c(0x1ef)]((_0xd2b448,_0x3a613f)=>{var _0x2c59d7=_0x35a44c;_0x45e858[_0x2c59d7(0x1ef)]((_0x444f33,_0x28d7fa)=>{var _0x5c7fcd=_0x2c59d7;if(_0x444f33=='Receiving\x20Area'&&_0x3a613f==_0x28d7fa){var _0x4f147c=_0xd2b448[_0x5c7fcd(0x274)](0x3);_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1d4)]=_0xd2b448[0x0],_0x19e3aa[_0x3a613f]['rack']=_0xd2b448[0x1],_0x19e3aa[_0x3a613f][_0x5c7fcd(0x284)]=0x0,_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1fe)]=0x0,_0x19e3aa[_0x3a613f][_0x5c7fcd(0x239)]='Floor',_0x19e3aa[_0x3a613f][_0x5c7fcd(0x228)]=_0x4f147c;}else{if(_0x444f33==_0x5c7fcd(0x1f5)&&_0x3a613f==_0x28d7fa){var _0x4f147c=_0xd2b448[_0x5c7fcd(0x274)](0x3);_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1d4)]=_0xd2b448[0x0],_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1cb)]=_0xd2b448[0x1],_0x19e3aa[_0x3a613f][_0x5c7fcd(0x284)]=0x0,_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1fe)]=0x0,_0x19e3aa[_0x3a613f][_0x5c7fcd(0x239)]=_0x5c7fcd(0x254),_0x19e3aa[_0x3a613f]['floorlevel']=_0xd2b448[0x5];}else{if(_0x3a613f==_0x28d7fa){var _0x218c60;if(_0xd2b448[0x4]=='L')_0x218c60=_0x5c7fcd(0x1c3);else _0xd2b448[0x4]=='F'&&(_0x218c60=_0x5c7fcd(0x254));_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1d4)]=_0xd2b448[0x0],_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1cb)]=_0xd2b448[0x1],_0x19e3aa[_0x3a613f][_0x5c7fcd(0x284)]=_0xd2b448[0x2],_0x19e3aa[_0x3a613f][_0x5c7fcd(0x1fe)]=_0xd2b448[0x3],_0x19e3aa[_0x3a613f][_0x5c7fcd(0x239)]=_0x218c60,_0x19e3aa[_0x3a613f]['floorlevel']=_0xd2b448[0x5];}}}});}),_0x196642[_0x35a44c(0x1ef)]((_0x5f5226,_0x5d0a2c)=>{var _0x2e066e=_0x35a44c;_0x19e3aa[_0x5d0a2c][_0x2e066e(0x22a)]=_0x5f5226;}),_0x2b3007[_0x35a44c(0x1ef)]((_0x1cdbac,_0x48d158)=>{var _0x2e76fe=_0x35a44c;_0x19e3aa[_0x48d158][_0x2e76fe(0x235)]=_0x1cdbac;}),_0x2ad959[_0x35a44c(0x1ef)]((_0x4d1abb,_0x37535d)=>{var _0x147c07=_0x35a44c;_0x19e3aa[_0x37535d][_0x147c07(0x1c0)]=_0x4d1abb;}),_0x322d57[_0x35a44c(0x1ef)]((_0x1125f8,_0x45b295)=>{var _0x190952=_0x35a44c;_0x19e3aa[_0x45b295][_0x190952(0x1cc)]=_0x1125f8;}),_0x29fc1a['forEach']((_0x2e201e,_0x27ac17)=>{var _0x2ececf=_0x35a44c;_0x19e3aa[_0x27ac17][_0x2ececf(0x24e)]=_0x2e201e;}),_0x59cbef[_0x35a44c(0x1ef)]((_0x5c1808,_0x2cc460)=>{var _0x3474b8=_0x35a44c;_0x19e3aa[_0x2cc460][_0x3474b8(0x1e4)]=_0x5c1808;}),_0x3bd905[_0x35a44c(0x1ef)]((_0x1ce42a,_0x22baa4)=>{var _0x524115=_0x35a44c;_0x19e3aa[_0x22baa4][_0x524115(0x21f)]=_0x1ce42a;}),_0x1c7e6d[_0x35a44c(0x1ef)]((_0x1f163a,_0xd6b8d1)=>{var _0x2280ff=_0x35a44c;_0x19e3aa[_0xd6b8d1][_0x2280ff(0x289)]=_0x1f163a;}),_0x19d48a[_0x35a44c(0x1ef)]((_0x50a8c0,_0x19d826)=>{var _0x579425=_0x35a44c;_0x19e3aa[_0x19d826][_0x579425(0x1c5)]=_0x50a8c0;}),_0x423f73[_0x35a44c(0x1ef)]((_0x560026,_0x37f708)=>{var _0x55959f=_0x35a44c;_0x19e3aa[_0x37f708][_0x55959f(0x236)]=_0x560026;}),_0x2dec37[_0x35a44c(0x1ef)]((_0x5ecf3c,_0x56f3fc)=>{var _0x4b6f57=_0x35a44c;_0x19e3aa[_0x56f3fc][_0x4b6f57(0x20e)]=_0x5ecf3c;}),_0x28a873[_0x35a44c(0x1ef)]((_0x82cf0a,_0x4af4a1)=>{_0x19e3aa[_0x4af4a1]['production_date']=_0x82cf0a;}),_0x8f7a7b['forEach']((_0x1ecb05,_0x5be11c)=>{var _0x5298d9=_0x35a44c;_0x19e3aa[_0x5be11c][_0x5298d9(0x246)]=_0x1ecb05;}),_0x45e858['forEach']((_0x1dfc42,_0x594e8b)=>{_0x19e3aa[_0x594e8b]['room_names']=_0x1dfc42;}),_0x12ebd4[_0x35a44c(0x1ef)]((_0x395f0c,_0x9a165a)=>{_0x19e3aa[_0x9a165a]['primary_code']=_0x395f0c;}),_0x58e497[_0x35a44c(0x1ef)]((_0x13c6ca,_0x1577ba)=>{var _0x48bbf7=_0x35a44c;_0x19e3aa[_0x1577ba][_0x48bbf7(0x265)]=_0x13c6ca;}),_0x145e0f[_0x35a44c(0x1ef)]((_0x167596,_0x1446a5)=>{_0x19e3aa[_0x1446a5]['invoice']=_0x167596;});const _0x43d775=_0x19e3aa[_0x35a44c(0x23c)](_0x294165=>_0x294165[_0x35a44c(0x1cc)]!=='0'&&_0x294165['adjust_qty']!=='');var _0x1d43e8=0x0;_0x43d775[_0x35a44c(0x1ef)](_0xc4740e=>{var _0x4bfcc5=_0x35a44c;console[_0x4bfcc5(0x1e9)]('foreach\x20newproduct',_0xc4740e),parseInt(_0xc4740e[_0x4bfcc5(0x1cc)])<=0x0&&_0x1d43e8++;});if(_0x1d43e8!=0x0)return _0x4b66a9['flash'](_0x35a44c(0x219),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x119c55['redirect'](_0x35a44c(0x209));const _0x510991=new adjustment({'warehouse_name':_0x16d173,'date':_0x5cdd89,'product':_0x43d775,'note':_0x1a7eb8,'room':_0x194259,'invoice':_0xcb9cd7,'JO_number':_0xef2bed,'expiry_date':_0x490ec1}),_0x3b191c=await _0x510991['save']();_0x4b66a9[_0x35a44c(0x21a)]('success',_0x35a44c(0x212)),_0x119c55['redirect'](_0x35a44c(0x28b)+_0x3b191c[_0x35a44c(0x27e)]);}catch(_0x50548b){console[_0x35a44c(0x1e9)](_0x50548b),_0x119c55['status'](0xc8)[_0x35a44c(0x1ca)]({'message':_0x50548b[_0x35a44c(0x225)]});}}),router[a0_0x1facd3(0x263)](a0_0x1facd3(0x277),auth,async(_0x3c05d5,_0x39d33a)=>{var _0x5e3c61=a0_0x1facd3;try{const {username:_0x22c147,email:_0x28a091,role:_0xf101b1}=_0x3c05d5['user'],_0x431596=_0x3c05d5[_0x5e3c61(0x20f)],_0x5d809a=await profile[_0x5e3c61(0x20b)]({'email':_0x431596['email']}),_0x57baca=await master_shop['find'](),_0x8b4b4=_0x3c05d5[_0x5e3c61(0x1c1)]['id'],_0x2a798a=await adjustment[_0x5e3c61(0x1e0)]({'_id':_0x8b4b4}),_0x525fc9=await purchases[_0x5e3c61(0x215)]([{'$match':{'warehouse_name':_0x2a798a[_0x5e3c61(0x260)]}},{'$unwind':_0x5e3c61(0x1d1)},{'$group':{'_id':_0x5e3c61(0x1f2)}}]),_0x2498f5=await product[_0x5e3c61(0x250)]({}),_0x21a86e=await warehouse[_0x5e3c61(0x215)]([{'$match':{'name':_0x2a798a[_0x5e3c61(0x260)]}},{'$unwind':_0x5e3c61(0x1d5)},{'$group':{'_id':_0x5e3c61(0x241),'name':{'$first':_0x5e3c61(0x226)},'product_stock':{'$first':_0x5e3c61(0x22e)},'bay':{'$first':_0x5e3c61(0x258)},'bin':{'$first':_0x5e3c61(0x233)},'type':{'$first':_0x5e3c61(0x1ba)},'floorlevel':{'$first':_0x5e3c61(0x286)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5e3c61(0x234)},'maxPerUnit':{'$first':_0x5e3c61(0x24c)},'expiry_date':{'$first':_0x5e3c61(0x281)},'production_date':{'$first':_0x5e3c61(0x25a)},'batch_code':{'$first':_0x5e3c61(0x28e)},'room':{'$first':_0x5e3c61(0x1bd)}}}]);if(_0x57baca[0x0][_0x5e3c61(0x275)]==_0x5e3c61(0x1d9)){var _0x1d0ef8=users['English'];console[_0x5e3c61(0x1e9)](_0x1d0ef8);}else{if(_0x57baca[0x0]['language']==_0x5e3c61(0x1f7))var _0x1d0ef8=users[_0x5e3c61(0x1f7)];else{if(_0x57baca[0x0][_0x5e3c61(0x275)]==_0x5e3c61(0x267))var _0x1d0ef8=users[_0x5e3c61(0x267)];else{if(_0x57baca[0x0]['language']==_0x5e3c61(0x1f3))var _0x1d0ef8=users[_0x5e3c61(0x1f3)];else{if(_0x57baca[0x0]['language']==_0x5e3c61(0x23d))var _0x1d0ef8=users[_0x5e3c61(0x23d)];else{if(_0x57baca[0x0]['language']==_0x5e3c61(0x1fd))var _0x1d0ef8=users['Portuguese'];else{if(_0x57baca[0x0][_0x5e3c61(0x275)]==_0x5e3c61(0x26f))var _0x1d0ef8=users[_0x5e3c61(0x26f)];else{if(_0x57baca[0x0]['language']=='Arabic\x20(ae)')var _0x1d0ef8=users[_0x5e3c61(0x1db)];}}}}}}}_0x39d33a[_0x5e3c61(0x227)](_0x5e3c61(0x224),{'success':_0x3c05d5['flash']('success'),'errors':_0x3c05d5[_0x5e3c61(0x21a)]('errors'),'role':_0x431596,'profile':_0x5d809a,'adjustment':_0x2a798a,'stock':_0x21a86e,'master_shop':_0x57baca,'warehouse_name':_0x525fc9,'unit':_0x2498f5,'language':_0x1d0ef8});}catch(_0x3801dd){console[_0x5e3c61(0x1e9)](_0x3801dd),_0x39d33a[_0x5e3c61(0x1e7)](0xc8)[_0x5e3c61(0x1ca)]({'message':_0x3801dd[_0x5e3c61(0x225)]});}}),router['post'](a0_0x1facd3(0x277),auth,async(_0x3ac2b0,_0x1677ea)=>{var _0x4da070=a0_0x1facd3;try{const _0x4d6683=_0x3ac2b0[_0x4da070(0x1c1)]['id'],{warehouse_name:_0x4c0b6f,Room_name:_0x1f22f8}=_0x3ac2b0[_0x4da070(0x1ea)],_0x24ff15=await adjustment['findById']({'_id':_0x4d6683}),_0x3f8d1c=_0x24ff15[_0x4da070(0x256)][_0x4da070(0x1cf)](async _0x785e75=>{var _0x1108c4=_0x4da070;if(_0x785e75[_0x1108c4(0x1cc)]>0x0){var _0x280e36=await warehouse[_0x1108c4(0x20b)]({'name':_0x4c0b6f,'room':_0x785e75[_0x1108c4(0x1df)],'warehouse_category':'Raw\x20Materials'});const _0x1585b4=_0x280e36['product_details'][_0x1108c4(0x1cf)](_0x246537=>{var _0x382abe=_0x1108c4;console[_0x382abe(0x1e9)](_0x785e75[_0x382abe(0x1c0)]+'\x20<>\x20');if(_0x785e75['types']==_0x382abe(0x255)){if(_0x246537[_0x382abe(0x25d)]==_0x785e75[_0x382abe(0x25d)]&&_0x246537[_0x382abe(0x228)]==_0x785e75[_0x382abe(0x228)]&&_0x246537['type']==_0x785e75[_0x382abe(0x239)]&&_0x246537['bin']==_0x785e75[_0x382abe(0x1fe)]&&_0x246537[_0x382abe(0x284)]==_0x785e75['bay']&&_0x246537[_0x382abe(0x1cb)]==_0x785e75[_0x382abe(0x1cb)]&&_0x246537['storage']==_0x785e75[_0x382abe(0x1d4)]&&_0x246537[_0x382abe(0x236)]==_0x785e75[_0x382abe(0x236)]&&_0x246537['batch_code']==_0x785e75[_0x382abe(0x1c5)]&&_0x246537[_0x382abe(0x1dd)]==_0x785e75[_0x382abe(0x1dd)]&&_0x246537['invoice']==_0x785e75['invoice']&&_0x246537[_0x382abe(0x27e)]==_0x785e75[_0x382abe(0x235)]){var _0x56a4fe;_0x56a4fe=_0x785e75[_0x382abe(0x1cc)],_0x785e75[_0x382abe(0x246)]=='S'&&(_0x56a4fe=_0x785e75[_0x382abe(0x1cc)]),_0x246537['product_stock']=_0x246537[_0x382abe(0x237)]-_0x56a4fe;}}else{if(_0x246537[_0x382abe(0x25d)]==_0x785e75['product_name']&&_0x246537[_0x382abe(0x228)]==_0x785e75[_0x382abe(0x228)]&&_0x246537[_0x382abe(0x239)]==_0x785e75[_0x382abe(0x239)]&&_0x246537[_0x382abe(0x1fe)]==_0x785e75[_0x382abe(0x1fe)]&&_0x246537[_0x382abe(0x284)]==_0x785e75[_0x382abe(0x284)]&&_0x246537['rack']==_0x785e75[_0x382abe(0x1cb)]&&_0x246537[_0x382abe(0x1d4)]==_0x785e75[_0x382abe(0x1d4)]&&_0x246537[_0x382abe(0x236)]==_0x785e75[_0x382abe(0x236)]&&_0x246537['batch_code']==_0x785e75['batch_code']&&_0x246537[_0x382abe(0x1dd)]==_0x785e75[_0x382abe(0x1dd)]&&_0x246537[_0x382abe(0x1c9)]==_0x785e75['invoice']&&_0x246537[_0x382abe(0x27e)]==_0x785e75['id_transaction_from']){console[_0x382abe(0x1e9)](_0x785e75);var _0x56a4fe;_0x56a4fe=_0x785e75[_0x382abe(0x1cc)],_0x785e75[_0x382abe(0x246)]=='S'&&(_0x56a4fe=_0x785e75[_0x382abe(0x1cc)]),_0x246537['product_stock']=_0x246537[_0x382abe(0x237)]+_0x56a4fe;}}});}return _0x280e36;});Promise['all'](_0x3f8d1c)[_0x4da070(0x266)](async _0x519f4f=>{var _0x578f5=_0x4da070;try{for(const _0x39d49d of _0x519f4f){await _0x39d49d[_0x578f5(0x23f)]();}_0x24ff15[_0x578f5(0x203)]=_0x578f5(0x1bb);const _0x3666de=await _0x24ff15['save'](),_0x1c1310=await master_shop[_0x578f5(0x250)](),_0x439bd5=await email_settings['findOne'](),_0x584e60=await supervisor_settings['find']();var _0x36f6a9=_0x24ff15['product'],_0x18e6a1='',_0x11ea1e;for(_0x11ea1e in _0x36f6a9){_0x18e6a1+='<tr>'+_0x578f5(0x208)+_0x36f6a9[_0x11ea1e][_0x578f5(0x25d)]+_0x578f5(0x269)+_0x578f5(0x208)+_0x36f6a9[_0x11ea1e][_0x578f5(0x289)]+_0x578f5(0x269)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36f6a9[_0x11ea1e][_0x578f5(0x1cc)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36f6a9[_0x11ea1e][_0x578f5(0x1e4)]+'</td>'+_0x578f5(0x208)+_0x36f6a9[_0x11ea1e][_0x578f5(0x21f)]+_0x578f5(0x269)+_0x578f5(0x208)+_0x24ff15[_0x578f5(0x260)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36f6a9[_0x11ea1e][_0x578f5(0x1df)]+_0x578f5(0x269)+_0x578f5(0x208)+_0x36f6a9[_0x11ea1e][_0x578f5(0x1d4)]+_0x36f6a9[_0x11ea1e][_0x578f5(0x1cb)]+_0x36f6a9[_0x11ea1e]['bay']+_0x36f6a9[_0x11ea1e][_0x578f5(0x1fe)]+_0x36f6a9[_0x11ea1e][_0x578f5(0x239)][0x0]+_0x36f6a9[_0x11ea1e][_0x578f5(0x228)]+_0x578f5(0x269),_0x578f5(0x271);}let _0x5b83d6=nodemailer[_0x578f5(0x24d)]({'host':_0x439bd5['host'],'port':Number(_0x439bd5[_0x578f5(0x22b)]),'secure':![],'auth':{'user':_0x439bd5[_0x578f5(0x261)],'pass':_0x439bd5['password']}}),_0x5c6dd8={'from':_0x439bd5[_0x578f5(0x261)],'to':_0x584e60[0x0][_0x578f5(0x218)],'subject':_0x578f5(0x1ec),'attachments':[{'filename':_0x578f5(0x1da),'path':__dirname+_0x578f5(0x268)+'/upload/'+_0x1c1310[0x0][_0x578f5(0x210)],'cid':_0x578f5(0x22c)}],'html':_0x578f5(0x1be)+_0x578f5(0x1fa)+_0x578f5(0x21c)+_0x578f5(0x26b)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x578f5(0x26b)+_0x578f5(0x1e8)+_0x578f5(0x1ed)+_0x578f5(0x26b)+_0x578f5(0x232)+_0x1c1310[0x0][_0x578f5(0x1c2)]+_0x578f5(0x28d)+_0x578f5(0x1ed)+'</div>'+_0x578f5(0x26c)+_0x578f5(0x26b)+_0x578f5(0x201)+_0x578f5(0x214)+_0x24ff15[_0x578f5(0x1c9)]+'\x20'+_0x578f5(0x1f8)+_0x578f5(0x1ce)+_0x24ff15[_0x578f5(0x20a)]+'\x20'+_0x578f5(0x230)+_0x578f5(0x1e6)+_0x578f5(0x1ed)+_0x578f5(0x1fb)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x578f5(0x1e3)+_0x578f5(0x25e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x578f5(0x272)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x578f5(0x21b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x578f5(0x221)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x578f5(0x271)+'</thead>'+_0x578f5(0x1bc)+'\x20'+_0x18e6a1+'\x20'+_0x578f5(0x1f0)+'</table>'+_0x578f5(0x26b)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x1c1310[0x0][_0x578f5(0x1c2)]+'</h5>'+'</div>'+_0x578f5(0x1ed)+'</body></html>'};_0x5b83d6[_0x578f5(0x23a)](_0x5c6dd8,function(_0x43f945,_0x2c1e3b){var _0x2ed886=_0x578f5;_0x43f945?(console[_0x2ed886(0x1e9)](_0x43f945),console[_0x2ed886(0x1e9)](_0x2ed886(0x245))):console['log'](_0x2ed886(0x285));}),_0x3ac2b0['flash']('success',_0x578f5(0x1f9)),_0x1677ea[_0x578f5(0x207)](_0x578f5(0x1dc)+_0x3666de[_0x578f5(0x27e)]);}catch(_0x1dc968){console['error'](_0x1dc968),_0x1677ea[_0x578f5(0x1e7)](0x1f4)[_0x578f5(0x1ca)]({'error':_0x578f5(0x1fc)});}})['catch'](_0x4fed97=>{var _0x1646d9=_0x4da070;console['error'](_0x4fed97),_0x1677ea[_0x1646d9(0x1e7)](0x1f4)['json']({'error':_0x1646d9(0x205)});});}catch(_0x50494c){console['log'](_0x50494c),_0x1677ea[_0x4da070(0x1e7)](0xc8)['json']({'message':_0x50494c[_0x4da070(0x225)]});}}),router[a0_0x1facd3(0x263)](a0_0x1facd3(0x288),auth,async(_0x2a1da9,_0x9518c4)=>{var _0x12559b=a0_0x1facd3;try{const {username:_0xa5c950,email:_0x5ecb1f,role:_0x4a1a35}=_0x2a1da9['user'],_0x16794c=_0x2a1da9['user'],_0x31c1c7=await profile[_0x12559b(0x20b)]({'email':_0x16794c[_0x12559b(0x261)]}),_0x5684c3=await master_shop[_0x12559b(0x250)](),_0x369a87=_0x2a1da9[_0x12559b(0x1c1)]['id'],_0x1ef179=await adjustment[_0x12559b(0x1e0)]({'_id':_0x369a87}),_0x1bff20=await purchases[_0x12559b(0x215)]([{'$match':{'warehouse_name':_0x1ef179[_0x12559b(0x260)]}},{'$unwind':_0x12559b(0x1d1)},{'$group':{'_id':_0x12559b(0x1f2)}}]),_0x26a81f=await product['find']({}),_0xee205d=await warehouse['aggregate']([{'$match':{'name':_0x1ef179['warehouse_name']}},{'$unwind':_0x12559b(0x1d5)},{'$group':{'_id':_0x12559b(0x241),'name':{'$first':_0x12559b(0x226)},'product_stock':{'$first':_0x12559b(0x22e)},'bay':{'$first':_0x12559b(0x258)},'bin':{'$first':_0x12559b(0x233)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x12559b(0x204)},'product_code':{'$first':_0x12559b(0x217)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x12559b(0x234)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x12559b(0x281)},'production_date':{'$first':_0x12559b(0x25a)},'batch_code':{'$first':_0x12559b(0x28e)},'room':{'$first':_0x12559b(0x1bd)}}}]);let _0x263839;if(_0x16794c['role']=='staff'){const _0x519a3d=await staff[_0x12559b(0x20b)]({'email':_0x16794c[_0x12559b(0x261)]});_0x263839=await warehouse['aggregate']([{'$match':{'status':_0x12559b(0x1f4),'name':_0x519a3d['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x12559b(0x253)}}},{'$group':{'_id':_0x12559b(0x27a),'name':{'$first':_0x12559b(0x27a)}}}]);}else _0x263839=await warehouse[_0x12559b(0x215)]([{'$match':{'status':_0x12559b(0x1f4),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x12559b(0x253)}}},{'$group':{'_id':_0x12559b(0x27a),'name':{'$first':_0x12559b(0x27a)}}}]);if(_0x5684c3[0x0][_0x12559b(0x275)]==_0x12559b(0x1d9)){var _0x3dfe82=users['English'];console[_0x12559b(0x1e9)](_0x3dfe82);}else{if(_0x5684c3[0x0]['language']==_0x12559b(0x1f7))var _0x3dfe82=users[_0x12559b(0x1f7)];else{if(_0x5684c3[0x0][_0x12559b(0x275)]==_0x12559b(0x267))var _0x3dfe82=users[_0x12559b(0x267)];else{if(_0x5684c3[0x0]['language']==_0x12559b(0x1f3))var _0x3dfe82=users[_0x12559b(0x1f3)];else{if(_0x5684c3[0x0][_0x12559b(0x275)]==_0x12559b(0x23d))var _0x3dfe82=users['French'];else{if(_0x5684c3[0x0][_0x12559b(0x275)]==_0x12559b(0x1fd))var _0x3dfe82=users[_0x12559b(0x200)];else{if(_0x5684c3[0x0][_0x12559b(0x275)]=='Chinese')var _0x3dfe82=users['Chinese'];else{if(_0x5684c3[0x0][_0x12559b(0x275)]==_0x12559b(0x257))var _0x3dfe82=users[_0x12559b(0x1db)];}}}}}}}_0x9518c4[_0x12559b(0x227)](_0x12559b(0x1c4),{'success':_0x2a1da9['flash'](_0x12559b(0x220)),'errors':_0x2a1da9[_0x12559b(0x21a)]('errors'),'role':_0x16794c,'profile':_0x31c1c7,'adjustment':_0x1ef179,'stock':_0xee205d,'master_shop':_0x5684c3,'warehouse_name':_0x1bff20,'unit':_0x26a81f,'language':_0x3dfe82,'warehouse':_0x263839});}catch(_0x1c59cf){console[_0x12559b(0x1e9)](_0x1c59cf),_0x9518c4['status'](0xc8)[_0x12559b(0x1ca)]({'message':_0x1c59cf[_0x12559b(0x225)]});}}),router['post'](a0_0x1facd3(0x288),auth,async(_0x2c39ec,_0xcf3562)=>{var _0x7839df=a0_0x1facd3;try{const _0x4243ca=_0x2c39ec['params']['id'],_0x4c564b=await adjustment[_0x7839df(0x1e0)]({'_id':_0x4243ca}),_0x2c1b1e=await warehouse[_0x7839df(0x20b)]({'name':_0x4c564b[_0x7839df(0x260)],'room':_0x4c564b['room']}),{warehouse_name:_0x55ced7,date:_0x362780,prod_name:_0x5a0a0f,level:_0x3e73af,isle:_0x3c8cbb,pallet:_0x454cf2,stock:_0x1b57ef,types:_0x72bd8d,adjust_qty:_0x2814be,new_adjust_qty:_0x2a01cd,note:_0xbd1080,Room_name:_0x22523c,invoice:_0x46ae6e,JO_number:_0x623591,expiry_date:_0x5a1e9a}=_0x2c39ec[_0x7839df(0x1ea)];if(typeof _0x5a0a0f==_0x7839df(0x23b))var _0x12aef5=[_0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x24a)]],_0x2e758c=[_0x2c39ec['body'][_0x7839df(0x25c)]],_0x2d2b6a=[_0x2c39ec['body'][_0x7839df(0x1ee)]],_0x426df2=[_0x2c39ec[_0x7839df(0x1ea)]['types']],_0x5aa7bd=[_0x2c39ec['body'][_0x7839df(0x238)]],_0x3cdfbd=[_0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x24b)]],_0x556a56=[_0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x27f)]],_0x4850c3=[_0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x244)]],_0x40f560=[_0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x1d6)]],_0x19365e=[_0x2c39ec['body']['batch_code']],_0x5a5220=[_0x2c39ec[_0x7839df(0x1ea)]['expiry_date']],_0xe76275=[_0x2c39ec[_0x7839df(0x1ea)]['max_per_unit']],_0x3e6ca7=[_0x2c39ec[_0x7839df(0x1ea)]['production_date']],_0xa81194=[_0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x246)]],_0x35cdb1=[_0x2c39ec['body']['Rooms']],_0x2ea1f2=[_0x2c39ec[_0x7839df(0x1ea)]['prime1']],_0x2452c6=[_0x2c39ec['body'][_0x7839df(0x1d2)]];else var _0x12aef5=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x24a)]],_0x2e758c=[..._0x2c39ec[_0x7839df(0x1ea)]['level']],_0x2d2b6a=[..._0x2c39ec['body'][_0x7839df(0x1ee)]],_0x426df2=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x1c0)]],_0x5aa7bd=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x238)]],_0x3cdfbd=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x24b)]],_0x556a56=[..._0x2c39ec['body'][_0x7839df(0x1e4)]],_0x4850c3=[..._0x2c39ec[_0x7839df(0x1ea)]['Secondary_units']],_0x40f560=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x1d6)]],_0x19365e=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x1c5)]],_0x5a5220=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x236)]],_0xe76275=[..._0x2c39ec[_0x7839df(0x1ea)]['max_per_unit']],_0x3e6ca7=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x1dd)]],_0xa81194=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x246)]],_0x35cdb1=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x21e)]],_0x2ea1f2=[..._0x2c39ec[_0x7839df(0x1ea)][_0x7839df(0x213)]],_0x2452c6=[..._0x2c39ec['body']['second1']];const _0x431271=_0x12aef5[_0x7839df(0x1cf)](_0x12735d=>{return _0x12735d={'product_name':_0x12735d};});_0x2e758c[_0x7839df(0x1ef)]((_0x3a7b1d,_0x10e94e)=>{var _0x38728b=_0x7839df;_0x35cdb1[_0x38728b(0x1ef)]((_0x132fb7,_0x290699)=>{var _0x1e49a6=_0x38728b;if(_0x132fb7==_0x1e49a6(0x279)&&_0x10e94e==_0x290699){var _0x5e04c7=_0x3a7b1d[_0x1e49a6(0x274)](0x3);_0x431271[_0x10e94e][_0x1e49a6(0x1d4)]=_0x3a7b1d[0x0],_0x431271[_0x10e94e]['rack']=_0x3a7b1d[0x1],_0x431271[_0x10e94e]['bay']=0x0,_0x431271[_0x10e94e][_0x1e49a6(0x1fe)]=0x0,_0x431271[_0x10e94e][_0x1e49a6(0x239)]='Floor',_0x431271[_0x10e94e][_0x1e49a6(0x228)]=_0x5e04c7;}else{if(_0x132fb7==_0x1e49a6(0x1f5)&&_0x10e94e==_0x290699){var _0x5e04c7=_0x3a7b1d[_0x1e49a6(0x274)](0x3);_0x431271[_0x10e94e][_0x1e49a6(0x1d4)]=_0x3a7b1d[0x0],_0x431271[_0x10e94e][_0x1e49a6(0x1cb)]=_0x3a7b1d[0x1],_0x431271[_0x10e94e][_0x1e49a6(0x284)]=0x0,_0x431271[_0x10e94e][_0x1e49a6(0x1fe)]=0x0,_0x431271[_0x10e94e][_0x1e49a6(0x239)]=_0x1e49a6(0x254),_0x431271[_0x10e94e][_0x1e49a6(0x228)]=_0x3a7b1d[0x5];}else{if(_0x10e94e==_0x290699){var _0x41db1c;if(_0x3a7b1d[0x4]=='L')_0x41db1c=_0x1e49a6(0x1c3);else _0x3a7b1d[0x4]=='F'&&(_0x41db1c=_0x1e49a6(0x254));_0x431271[_0x10e94e][_0x1e49a6(0x1d4)]=_0x3a7b1d[0x0],_0x431271[_0x10e94e][_0x1e49a6(0x1cb)]=_0x3a7b1d[0x1],_0x431271[_0x10e94e][_0x1e49a6(0x284)]=_0x3a7b1d[0x2],_0x431271[_0x10e94e][_0x1e49a6(0x1fe)]=_0x3a7b1d[0x3],_0x431271[_0x10e94e][_0x1e49a6(0x239)]=_0x41db1c,_0x431271[_0x10e94e][_0x1e49a6(0x228)]=_0x3a7b1d[0x5];}}}});}),_0x2d2b6a[_0x7839df(0x1ef)]((_0x225a70,_0x2deb75)=>{var _0x326f69=_0x7839df;_0x431271[_0x2deb75][_0x326f69(0x22a)]=_0x225a70;}),_0x426df2[_0x7839df(0x1ef)]((_0x2288a0,_0x3bdfe6)=>{var _0x3fab25=_0x7839df;_0x431271[_0x3bdfe6][_0x3fab25(0x1c0)]=_0x2288a0;}),_0x5aa7bd[_0x7839df(0x1ef)]((_0x5781ad,_0x5d81c8)=>{var _0xb7765c=_0x7839df;_0x431271[_0x5d81c8][_0xb7765c(0x1cc)]=_0x5781ad;}),_0x3cdfbd[_0x7839df(0x1ef)]((_0x582695,_0x5cfefe)=>{var _0x3e8f58=_0x7839df;_0x431271[_0x5cfefe][_0x3e8f58(0x24e)]=_0x582695;}),_0x556a56['forEach']((_0x3a0e4b,_0x468869)=>{var _0x5f45d2=_0x7839df;_0x431271[_0x468869][_0x5f45d2(0x1e4)]=_0x3a0e4b;}),_0x4850c3[_0x7839df(0x1ef)]((_0x3562e5,_0x78a556)=>{_0x431271[_0x78a556]['secondary_unit']=_0x3562e5;}),_0x40f560[_0x7839df(0x1ef)]((_0x32cda4,_0x41a6de)=>{_0x431271[_0x41a6de]['product_code']=_0x32cda4;}),_0x19365e['forEach']((_0x21ce98,_0xe2642e)=>{var _0x1d8f59=_0x7839df;_0x431271[_0xe2642e][_0x1d8f59(0x1c5)]=_0x21ce98;}),_0x5a5220[_0x7839df(0x1ef)]((_0x4168f8,_0x1f677f)=>{var _0x130782=_0x7839df;_0x431271[_0x1f677f][_0x130782(0x236)]=_0x4168f8;}),_0xe76275[_0x7839df(0x1ef)]((_0x125bfa,_0x549db6)=>{var _0x229da8=_0x7839df;_0x431271[_0x549db6][_0x229da8(0x20e)]=_0x125bfa;}),_0x3e6ca7['forEach']((_0x32f2c0,_0xe68de4)=>{_0x431271[_0xe68de4]['production_date']=_0x32f2c0;}),_0xa81194[_0x7839df(0x1ef)]((_0x1eeff0,_0x2d781b)=>{var _0x5052cb=_0x7839df;_0x431271[_0x2d781b][_0x5052cb(0x246)]=_0x1eeff0;}),_0x35cdb1['forEach']((_0x4a4a67,_0xe11e)=>{var _0x859da4=_0x7839df;_0x431271[_0xe11e][_0x859da4(0x1df)]=_0x4a4a67;}),_0x2ea1f2[_0x7839df(0x1ef)]((_0x364d2f,_0x2ee292)=>{_0x431271[_0x2ee292]['primary_code']=_0x364d2f;}),_0x2452c6[_0x7839df(0x1ef)]((_0x3f3fb7,_0x339789)=>{_0x431271[_0x339789]['secondary_code']=_0x3f3fb7;});const _0x2b3976=_0x431271[_0x7839df(0x23c)](_0x3eaae4=>_0x3eaae4['adjust_qty']!=='0'&&_0x3eaae4[_0x7839df(0x1cc)]!=='');var _0x2f5764=0x0;_0x2b3976[_0x7839df(0x1ef)](_0x4b4a61=>{var _0x42ee70=_0x7839df;console['log'](_0x42ee70(0x273),_0x4b4a61),parseInt(_0x4b4a61[_0x42ee70(0x1cc)])<=0x0&&_0x2f5764++;});if(_0x2f5764!=0x0)return _0x2c39ec[_0x7839df(0x21a)](_0x7839df(0x219),_0x7839df(0x25b)),_0xcf3562['redirect'](_0x7839df(0x209));_0x4c564b[_0x7839df(0x260)]=_0x55ced7,_0x4c564b['date']=_0x362780,_0x4c564b[_0x7839df(0x256)]=_0x2b3976,_0x4c564b[_0x7839df(0x22f)]=_0xbd1080,_0x4c564b[_0x7839df(0x1c9)]=_0x46ae6e,_0x4c564b['isAllowEdit']=_0x7839df(0x276);const _0x5eb1ea=await _0x4c564b[_0x7839df(0x23f)]();_0x2c39ec[_0x7839df(0x21a)](_0x7839df(0x220),'adjustment\x20data\x20update\x20successfully'),_0xcf3562[_0x7839df(0x207)](_0x7839df(0x222));}catch(_0x516c77){console[_0x7839df(0x1e9)](_0x516c77);}}),router[a0_0x1facd3(0x1d0)](a0_0x1facd3(0x249),async(_0x25d941,_0x5ecf5f)=>{var _0x499173=a0_0x1facd3;const {primary_code:_0xbde44f,warehouse_data:_0x2b35b0,rooms_data:_0x42740d,Roomslist:_0x4cf971}=_0x25d941['body'],_0x32ec27=_0x4cf971[_0x499173(0x280)](','),_0x1f7d12=[];async function _0xfd128(_0x1d746d){var _0x1103bb=_0x499173;const _0xa35feb=await warehouse[_0x1103bb(0x215)]([{'$match':{'name':_0x2b35b0,'room':_0x1d746d}},{'$unwind':_0x1103bb(0x1d5)},{'$match':{'product_details.primary_code':_0xbde44f}},{'$group':{'_id':_0x1103bb(0x241),'name':{'$first':_0x1103bb(0x226)},'product_stock':{'$first':_0x1103bb(0x22e)},'primary_code':{'$first':_0x1103bb(0x202)},'secondary_code':{'$first':_0x1103bb(0x204)},'product_code':{'$first':_0x1103bb(0x217)},'level':{'$first':_0x1103bb(0x258)},'isle':{'$first':_0x1103bb(0x233)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1103bb(0x286)},'unit':{'$first':_0x1103bb(0x262)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x1103bb(0x1eb)},'rack':{'$first':_0x1103bb(0x234)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1103bb(0x25a)},'maxPerUnit':{'$first':_0x1103bb(0x24c)},'batch_code':{'$first':_0x1103bb(0x28e)},'product_cat':{'$first':_0x1103bb(0x23e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1103bb(0x1bd)},'invoice':{'$first':'$product_details.invoice'}}}]),_0xbfae62=await warehouse[_0x1103bb(0x215)]([{'$match':{'name':_0x2b35b0,'room':_0x1d746d}},{'$unwind':_0x1103bb(0x1d5)},{'$match':{'product_details.secondary_code':_0xbde44f}},{'$group':{'_id':_0x1103bb(0x241),'name':{'$first':_0x1103bb(0x226)},'product_stock':{'$first':_0x1103bb(0x22e)},'primary_code':{'$first':_0x1103bb(0x202)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1103bb(0x217)},'level':{'$first':_0x1103bb(0x258)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1103bb(0x1ba)},'pallet':{'$first':_0x1103bb(0x286)},'unit':{'$first':_0x1103bb(0x262)},'secondary_unit':{'$first':_0x1103bb(0x24f)},'storage':{'$first':_0x1103bb(0x1eb)},'rack':{'$first':_0x1103bb(0x234)},'expiry_date':{'$first':_0x1103bb(0x281)},'production_date':{'$first':_0x1103bb(0x25a)},'maxPerUnit':{'$first':_0x1103bb(0x24c)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x1103bb(0x23e)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1103bb(0x1bd)}}}]);if(_0xa35feb[_0x1103bb(0x28a)]>0x0)_0x1f7d12[_0x1103bb(0x282)](_0xa35feb);else _0xbfae62[_0x1103bb(0x28a)]>0x0&&_0x1f7d12[_0x1103bb(0x282)](_0xbfae62);}const _0x16800b=_0x32ec27[_0x499173(0x1cf)](_0x29f5cc=>_0xfd128(_0x29f5cc));await Promise[_0x499173(0x1e1)](_0x16800b),_0x5ecf5f[_0x499173(0x1ca)](_0x1f7d12);}),router[a0_0x1facd3(0x1d0)](a0_0x1facd3(0x27b),async(_0x174dec,_0x1fd66e)=>{var _0xf4518d=a0_0x1facd3;const {primaryCode:_0x527e9f,secondaryCode:_0x321a75,productCode:_0x551e01,level:_0x4fec50,isle:_0x1657a9,pallet:_0x422b18,warehouses:_0x3d02ca,room:_0x379388}=_0x174dec['body'];try{const _0x123348=await warehouse[_0xf4518d(0x215)]([{'$match':{'name':_0x3d02ca,'room':_0x379388}},{'$unwind':_0xf4518d(0x1d5)},{'$match':{'product_details.level':parseInt(_0x4fec50),'product_details.isle':_0x1657a9,'product_details.pallet':parseInt(_0x422b18)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xf4518d(0x226)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0xf4518d(0x229)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xf4518d(0x251)},'maxProducts':{'$first':_0xf4518d(0x240)}}}]);_0x1fd66e[_0xf4518d(0x1e7)](0xc8)[_0xf4518d(0x1ca)](_0x123348);}catch(_0x11c7c9){_0x1fd66e[_0xf4518d(0x1e7)](0x194)[_0xf4518d(0x1ca)]({'message':_0x11c7c9[_0xf4518d(0x225)]});}}),module[a0_0x1facd3(0x27d)]=router;function a0_0x49f4(_0x9463db,_0x2f2799){var _0x398e77=a0_0x398e();return a0_0x49f4=function(_0x49f4b9,_0x4e5324){_0x49f4b9=_0x49f4b9-0x1ba;var _0x835685=_0x398e77[_0x49f4b9];return _0x835685;},a0_0x49f4(_0x9463db,_0x2f2799);}function a0_0x398e(){var _0x52dd10=['</h5>','status','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','log','body','$product_details.storage','Adjustment\x20Mail','</div>','stock','forEach','</tbody>','$_id','$product.product_name','Spanish','Enabled','Shelves','63sLsVLt','Hindi','<span\x20style=\x22float:\x20right;\x22>','adjustment\x20Finalized\x20successfully','<html><head><title></title>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','Portuguese\x20(BR)','bin','padStart','Portuguese','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.primary_code','finalize','$product_details.secondary_code','An\x20error\x20occurred.','9ncUvtB','redirect','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','back','date','findOne','../public/language/languages.json','$date','maxperunit','user','image','$finalize','adjustment\x20add\x20successfull','prime1','\x20Order\x20Number\x20:\x20','aggregate','210348ZnUMzi','$product_details.product_code','RMSEmail','errors','flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</head><body>','adjustment','Rooms','secondary_unit','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','/adjustment/view','313025HTvDqn','edit_adjustment_view','message','$product_details.product_name','render','floorlevel','$product_details.level','stockBefore','port','logo','1364856gVPWkl','$product_details.product_stock','note','</span>','$warehouse_name','<h2>\x20','$product_details.bin','$product_details.rack','id_transaction_from','expiry_date','product_stock','New_Qty_Converted_adj','type','sendMail','string','filter','French','$product_details.product_cat','save','$product_details.maxProducts','$product_details._id','$isAllowEdit','random','Secondary_units','Error\x20Occurs','prod_cat','$product.room_names','staff','/barcode_scanner','prod_name','New_Qty_Converted','$product_details.maxPerUnit','createTransport','new_adjust_qty','$product_details.secondary_unit','find','$product_details.pallet','61716OGAzHg','Return\x20Goods','Floor','minus','product','Arabic\x20(ae)','$product_details.bay','../models/all_models','$product_details.production_date','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','level','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view','warehouse_name','email','$product_details.unit','get','/view/add_adjustment','secondary_code','then','German','/../public','</td>','warehouse','<div>','<hr\x20class=\x22my-3\x22>','id_transaction','Raw\x20Materials','Chinese','$invoice','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','foreach\x20newproduct','slice','language','False','/preview/:id','Ambient','Receiving\x20Area','$name','/CheckingWarehouse','nodemailer','exports','_id','Primary_Units','split','$product_details.expiry_date','push','Router','bay','Email\x20sent\x20successfully','$product_details.floorlevel','Enclosed','/view/:id','product_code','length','/adjustment/preview/','English','\x20</h2>','$product_details.batch_code','$product_details.type','True','<tbody\x20style=\x22text-align:\x20center;\x22>','$room','<!DOCTYPE\x20html>','8632610yHfpWc','types','params','site_title','Level','edit_adjustment','batch_code','role','187936UfMkiO','Return\x20Rooms','invoice','json','rack','adjust_qty','toString','\x20Order\x20Date\x20:\x20','map','post','$product','second1','3SDxvjR','storage','$product_details','prod_code','../middleware/auth','ADJ-','English\x20(US)','Logo.png','Arabic','/picking_list/PDF_adjustment_rm/','production_date','master','room_names','findById','all','catch','<tr>','unit','758605ZKkonm'];a0_0x398e=function(){return _0x52dd10;};return a0_0x398e();}