var a0_0x238190=a0_0x2581;(function(_0x2f438a,_0x1b4622){var _0x12b6d5=a0_0x2581,_0x5662c1=_0x2f438a();while(!![]){try{var _0x5500a6=parseInt(_0x12b6d5(0x156))/0x1*(parseInt(_0x12b6d5(0x118))/0x2)+-parseInt(_0x12b6d5(0xfb))/0x3+parseInt(_0x12b6d5(0x194))/0x4*(parseInt(_0x12b6d5(0xce))/0x5)+parseInt(_0x12b6d5(0x101))/0x6+-parseInt(_0x12b6d5(0xeb))/0x7+parseInt(_0x12b6d5(0x10c))/0x8*(-parseInt(_0x12b6d5(0x12c))/0x9)+-parseInt(_0x12b6d5(0x14b))/0xa;if(_0x5500a6===_0x1b4622)break;else _0x5662c1['push'](_0x5662c1['shift']());}catch(_0x3b9fd6){_0x5662c1['push'](_0x5662c1['shift']());}}}(a0_0x573a,0xb6195));const express=require(a0_0x238190(0x143)),app=express(),router=express[a0_0x238190(0xdb)](),auth=require(a0_0x238190(0xec)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x238190(0x166)),users=require(a0_0x238190(0x161)),nodemailer=require('nodemailer');function a0_0x2581(_0x5dc474,_0x1ceb87){var _0x573a22=a0_0x573a();return a0_0x2581=function(_0x25816b,_0x142c73){_0x25816b=_0x25816b-0xc8;var _0x559bff=_0x573a22[_0x25816b];return _0x559bff;},a0_0x2581(_0x5dc474,_0x1ceb87);}router[a0_0x238190(0x11e)](a0_0x238190(0x151),auth,async(_0x32bb48,_0xa1ff55)=>{var _0xd935d8=a0_0x238190;try{const {username:_0xa7d07b,email:_0x2afd71,role:_0x202502}=_0x32bb48[_0xd935d8(0xdd)],_0x50b560=_0x32bb48['user'],_0x5c9a7b=await profile[_0xd935d8(0xe2)]({'email':_0x50b560[_0xd935d8(0x167)]}),_0x48427d=await master_shop[_0xd935d8(0x105)]();console[_0xd935d8(0xc8)](_0xd935d8(0x13f),_0x48427d);let _0x2c4f55;if(_0x50b560['role']==_0xd935d8(0x137)){const _0x5547e0=await staff[_0xd935d8(0xe2)]({'email':_0x50b560['email']});_0x2c4f55=await warehouse['find']({'status':_0xd935d8(0x123),'name':_0x5547e0[_0xd935d8(0x195)]});}else _0x2c4f55=await warehouse['find']({'status':_0xd935d8(0x123)});const _0x2acc9b=await product[_0xd935d8(0x105)]();let _0x36302d;if(_0x50b560[_0xd935d8(0x122)]==_0xd935d8(0x137)){const _0x15b6cb=await staff['findOne']({'email':_0x50b560['email']});_0x36302d=await adjustment[_0xd935d8(0x105)]({'warehouse_name':_0x15b6cb[_0xd935d8(0x195)]});}else _0x36302d=await adjustment[_0xd935d8(0x159)]([{'$unwind':_0xd935d8(0x189)},{'$group':{'_id':'$_id','invoice':{'$first':_0xd935d8(0x172)},'date':{'$first':_0xd935d8(0xe5)},'warehouse_name':{'$first':_0xd935d8(0xd9)},'room':{'$addToSet':_0xd935d8(0x140)},'finalize':{'$first':_0xd935d8(0x126)},'isAllowEdit':{'$first':_0xd935d8(0xf2)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x48427d[0x0]['language']=='English\x20(US)'){var _0x1ed4d4=users[_0xd935d8(0xcb)];console[_0xd935d8(0xc8)](_0x1ed4d4);}else{if(_0x48427d[0x0][_0xd935d8(0x16c)]==_0xd935d8(0x12a))var _0x1ed4d4=users[_0xd935d8(0x12a)];else{if(_0x48427d[0x0][_0xd935d8(0x16c)]==_0xd935d8(0xf7))var _0x1ed4d4=users[_0xd935d8(0xf7)];else{if(_0x48427d[0x0][_0xd935d8(0x16c)]==_0xd935d8(0x155))var _0x1ed4d4=users['Spanish'];else{if(_0x48427d[0x0]['language']=='French')var _0x1ed4d4=users['French'];else{if(_0x48427d[0x0][_0xd935d8(0x16c)]==_0xd935d8(0xdc))var _0x1ed4d4=users['Portuguese'];else{if(_0x48427d[0x0]['language']==_0xd935d8(0x187))var _0x1ed4d4=users[_0xd935d8(0x187)];else{if(_0x48427d[0x0][_0xd935d8(0x16c)]=='Arabic\x20(ae)')var _0x1ed4d4=users[_0xd935d8(0x162)];}}}}}}}_0xa1ff55[_0xd935d8(0x165)](_0xd935d8(0x115),{'success':_0x32bb48[_0xd935d8(0x112)](_0xd935d8(0x15c)),'errors':_0x32bb48[_0xd935d8(0x112)]('errors'),'role':_0x50b560,'profile':_0x5c9a7b,'warehouse':_0x2c4f55,'product':_0x2acc9b,'adjustment':_0x36302d,'master_shop':_0x48427d,'language':_0x1ed4d4});}catch(_0x363044){console['log'](_0x363044);}});function a0_0x573a(){var _0x33ee5c=['findOne','</span>','unit','$date','ADJ-','English\x20(US)','Logo.png','site_title','</div>','1103732yrGyHC','../middleware/auth','filter','secondary_code','bin','status','$name','$isAllowEdit','note','errors','prod_invoice','product','German','Error\x20Occurs','$product_details.batch_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','600453DyOHLm','$room','\x20<>\x20','maxperunit','$product_details.product_name','$product_details.maxProducts','4327536CWrGcy','bay','$product_details.bay','length','find','message','New_Qty_Converted_adj','$product_details.product_stock','product_name','$product.product_name','True','424MkLAwE','New_Qty_Converted','Return\x20Goods','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.production_date','createTransport','flash','prod_cat','floor','adjustment','error','random','26AYOWKi','product_code','body','$product_details.storage','RMSEmail','/adjustment/preview/','get','<h2>\x20','<table\x20style=\x22width:\x20100%\x20!important;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','role','Enabled','maxPerUnit','</h5>','$finalize','date','types','False','Hindi','primary_code','157959zkhCOL','product_details','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','</tbody>','\x20Order\x20Date\x20:\x20','An\x20error\x20occurred.','post','Return\x20Rooms','<!DOCTYPE\x20html>','staff','batch_code','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.rack','</thead>','foreach\x20newproduct','forEach','master','$product.room_names','$product_details.floorlevel','new_adjust_qty','express','$product_details','$product_details.product_code','\x20Order\x20Number\x20:\x20','isAllowEdit','catch','</head><body>','$product_details.maxPerUnit','715250PPisJV','French','/view/:id','production_date','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','/view','sendMail','An\x20error\x20occurred\x20while\x20saving\x20data.','Primary_Units','Spanish','48277XCMePD','Ambient','$product_details.unit','aggregate','save','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','success','stock','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','max_per_unit','params','../public/language/languages.json','Arabic','$product_details.primary_code','json','render','../models/all_models','email','slice','Enclosed','$product_details.bin','second1','language','floorlevel','Level','Adjustment\x20Mail','adjustment\x20data\x20update\x20successfully','rack','$invoice','room_names','prod_name','<tr>','/preview/:id','adjust_qty','Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.secondary_code','padStart','storage','prime1','image','host','warehouse_name','/adjustment/view','type','minus','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','back','Receiving\x20Area','Chinese','findById','$product','push','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','password','$product_details.level','all','<hr\x20class=\x22my-3\x22>','string','Email\x20sent\x20successfully','_id','logo','100QyUrfS','warehouse','stockBefore','expiry_date','port','$product_details._id','prod_code','<tbody\x20style=\x22text-align:\x20center;\x22>','exports','<html><head><title></title>','</table>','edit_adjustment','level','<div>','then','Floor','secondary_unit','log','$product_details.product_cat','$product_details.expiry_date','English','invoice','Arabic\x20(ae)','151315TNImOo','Portuguese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','redirect','/../public','$product_details.type','map','Secondary_units','<span\x20style=\x22float:\x20right;\x22>','toString','product_stock','$warehouse_name','/CheckingWarehouse','Router','Portuguese\x20(BR)','user','Raw\x20Materials','/view/add_adjustment','$product_details.isle','room'];a0_0x573a=function(){return _0x33ee5c;};return a0_0x573a();}async function getRandom8DigitNumber(){var _0x3d070f=a0_0x238190;const _0x3f8dd3=0x989680,_0x1eba1b=0x5f5e0ff,_0xfa699=Math[_0x3d070f(0x114)](Math[_0x3d070f(0x117)]()*(_0x1eba1b-_0x3f8dd3+0x1))+_0x3f8dd3;var _0x5383fe;const _0x4d3018=await adjustment[_0x3d070f(0xe2)]({'invoice':_0x3d070f(0xe6)+_0xfa699});return _0x4d3018&&_0x4d3018['length']>0x0?_0x5383fe=_0x3d070f(0xe6)+_0xfa699:_0x5383fe=_0x3d070f(0xe6)+_0xfa699,_0x5383fe;}router[a0_0x238190(0x11e)](a0_0x238190(0xdf),auth,async(_0x2710aa,_0x6fe550)=>{var _0x149c6f=a0_0x238190;try{const {username:_0x4f0405,email:_0x21bae1,role:_0x25d128}=_0x2710aa['user'],_0x1d266b=_0x2710aa[_0x149c6f(0xdd)],_0x3a6d83=await profile[_0x149c6f(0xe2)]({'email':_0x1d266b['email']}),_0x39760a=await master_shop[_0x149c6f(0x105)]();let _0x2f54d5;if(_0x1d266b[_0x149c6f(0x122)]==_0x149c6f(0x137)){const _0xab16d9=await staff[_0x149c6f(0xe2)]({'email':_0x1d266b[_0x149c6f(0x167)]});_0x2f54d5=await warehouse[_0x149c6f(0x159)]([{'$match':{'status':_0x149c6f(0x123),'name':_0xab16d9['warehouse'],'warehouse_category':_0x149c6f(0xde),'name':{'$ne':_0x149c6f(0x10e)}}},{'$group':{'_id':_0x149c6f(0xf1),'name':{'$first':'$name'}}}]);}else _0x2f54d5=await warehouse[_0x149c6f(0x159)]([{'$match':{'status':_0x149c6f(0x123),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x149c6f(0x10e)}}},{'$group':{'_id':'$name','name':{'$first':_0x149c6f(0xf1)}}}]);const _0x307cfd=await product[_0x149c6f(0x105)]({}),_0x3df57d=await adjustment[_0x149c6f(0x105)]({}),_0x2193dc=_0x3df57d[_0x149c6f(0x104)]+0x1,_0x2835ce=_0x149c6f(0xe6)+_0x2193dc[_0x149c6f(0xd7)]()[_0x149c6f(0x17b)](0x5,'0');var _0xa136d3=[_0x149c6f(0x157),_0x149c6f(0x169),_0x149c6f(0x135)];if(_0x39760a[0x0][_0x149c6f(0x16c)]==_0x149c6f(0xe7))var _0x478c09=users[_0x149c6f(0xcb)];else{if(_0x39760a[0x0][_0x149c6f(0x16c)]==_0x149c6f(0x12a))var _0x478c09=users[_0x149c6f(0x12a)];else{if(_0x39760a[0x0][_0x149c6f(0x16c)]=='German')var _0x478c09=users[_0x149c6f(0xf7)];else{if(_0x39760a[0x0][_0x149c6f(0x16c)]==_0x149c6f(0x155))var _0x478c09=users['Spanish'];else{if(_0x39760a[0x0][_0x149c6f(0x16c)]==_0x149c6f(0x14c))var _0x478c09=users[_0x149c6f(0x14c)];else{if(_0x39760a[0x0][_0x149c6f(0x16c)]==_0x149c6f(0xdc))var _0x478c09=users[_0x149c6f(0xcf)];else{if(_0x39760a[0x0][_0x149c6f(0x16c)]==_0x149c6f(0x187))var _0x478c09=users[_0x149c6f(0x187)];else{if(_0x39760a[0x0][_0x149c6f(0x16c)]==_0x149c6f(0xcd))var _0x478c09=users['Arabic'];}}}}}}}const _0x384884=getRandom8DigitNumber();_0x384884[_0x149c6f(0x1a2)](_0x590f68=>{var _0x461c9f=_0x149c6f;_0x6fe550[_0x461c9f(0x165)]('add_adjustment',{'success':_0x2710aa[_0x461c9f(0x112)](_0x461c9f(0x15c)),'errors':_0x2710aa['flash'](_0x461c9f(0xf4)),'role':_0x1d266b,'profile':_0x3a6d83,'warehouse':_0x2f54d5,'product':_0x307cfd,'master_shop':_0x39760a,'language':_0x478c09,'rooms_data':_0xa136d3,'invoice_no':_0x590f68});})['catch'](_0x1a5253=>{var _0x9821b8=_0x149c6f;_0x2710aa[_0x9821b8(0x112)](_0x9821b8(0xf4),_0x9821b8(0x121)),_0x6fe550[_0x9821b8(0xd1)](_0x9821b8(0x181));});}catch(_0x2cff07){console[_0x149c6f(0xc8)](_0x2cff07);}}),router['post'](a0_0x238190(0xdf),auth,async(_0x12f3c2,_0x3b2450)=>{var _0x2672e9=a0_0x238190;try{const {warehouse_name:_0x2bc7b5,date:_0x1670ae,prod_name:_0x26c007,level:_0x3bf4fd,isle:_0x410bb,pallet:_0x583c24,stock:_0x157dbf,types:_0x5968e4,adjust_qty:_0x13b81e,new_adjust_qty:_0x53734d,note:_0x14fbc9,Room_name:_0x5bd9f8,invoice:_0x364651,JO_number:_0x5ab2cb,expiry_date:_0x456e68}=_0x12f3c2['body'];if(typeof _0x26c007=='string')var _0x525179=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x174)]],_0x30d70b=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x1a0)]],_0x5324f1=[_0x12f3c2['body'][_0x2672e9(0x15d)]],_0x5b24f5=[_0x12f3c2[_0x2672e9(0x11a)]['types']],_0x139650=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x107)]],_0x41f6c0=[_0x12f3c2[_0x2672e9(0x11a)]['New_Qty_Converted']],_0x309aed=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x154)]],_0xf33118=[_0x12f3c2[_0x2672e9(0x11a)]['Secondary_units']],_0x2ca299=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x19a)]],_0x1ee465=[_0x12f3c2[_0x2672e9(0x11a)]['batch_code']],_0x10b203=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x197)]],_0x46e5a4=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x15f)]],_0x422724=[_0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x14e)]],_0x4101a3=[_0x12f3c2[_0x2672e9(0x11a)]['prod_cat']],_0x1ef2ae=[_0x12f3c2['body'][_0x2672e9(0x178)]],_0x10508a=[_0x12f3c2[_0x2672e9(0x11a)]['prime1']],_0x4f3a43=[_0x12f3c2['body'][_0x2672e9(0x16b)]],_0x394ca9=[_0x12f3c2['body']['prod_invoice']];else var _0x525179=[..._0x12f3c2['body'][_0x2672e9(0x174)]],_0x30d70b=[..._0x12f3c2[_0x2672e9(0x11a)]['level']],_0x5324f1=[..._0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x15d)]],_0x5b24f5=[..._0x12f3c2['body'][_0x2672e9(0x128)]],_0x139650=[..._0x12f3c2['body'][_0x2672e9(0x107)]],_0x41f6c0=[..._0x12f3c2['body'][_0x2672e9(0x10d)]],_0x309aed=[..._0x12f3c2['body'][_0x2672e9(0xe4)]],_0xf33118=[..._0x12f3c2[_0x2672e9(0x11a)]['Secondary_units']],_0x2ca299=[..._0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x19a)]],_0x1ee465=[..._0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x138)]],_0x10b203=[..._0x12f3c2[_0x2672e9(0x11a)]['expiry_date']],_0x46e5a4=[..._0x12f3c2[_0x2672e9(0x11a)]['max_per_unit']],_0x422724=[..._0x12f3c2['body'][_0x2672e9(0x14e)]],_0x4101a3=[..._0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0x113)]],_0x1ef2ae=[..._0x12f3c2['body'][_0x2672e9(0x178)]],_0x10508a=[..._0x12f3c2[_0x2672e9(0x11a)]['prime1']],_0x4f3a43=[..._0x12f3c2[_0x2672e9(0x11a)]['second1']],_0x394ca9=[..._0x12f3c2[_0x2672e9(0x11a)][_0x2672e9(0xf5)]];const _0x27a1f9=_0x525179[_0x2672e9(0xd4)](_0xd81812=>{return _0xd81812={'product_name':_0xd81812};});_0x30d70b[_0x2672e9(0x13e)]((_0x4982cd,_0x1b2acc)=>{var _0x316dc3=_0x2672e9;_0x1ef2ae[_0x316dc3(0x13e)]((_0x557089,_0x55e934)=>{var _0x5bbd95=_0x316dc3;if(_0x557089==_0x5bbd95(0x186)&&_0x1b2acc==_0x55e934){var _0x4812d8=_0x4982cd[_0x5bbd95(0x168)](0x3);_0x27a1f9[_0x1b2acc][_0x5bbd95(0x17c)]=_0x4982cd[0x0],_0x27a1f9[_0x1b2acc][_0x5bbd95(0x171)]=_0x4982cd[0x1],_0x27a1f9[_0x1b2acc][_0x5bbd95(0x102)]=0x0,_0x27a1f9[_0x1b2acc][_0x5bbd95(0xef)]=0x0,_0x27a1f9[_0x1b2acc]['type']=_0x5bbd95(0x1a3),_0x27a1f9[_0x1b2acc][_0x5bbd95(0x16d)]=_0x4812d8;}else{if(_0x557089=='Shelves'&&_0x1b2acc==_0x55e934){var _0x4812d8=_0x4982cd[_0x5bbd95(0x168)](0x3);_0x27a1f9[_0x1b2acc][_0x5bbd95(0x17c)]=_0x4982cd[0x0],_0x27a1f9[_0x1b2acc][_0x5bbd95(0x171)]=_0x4982cd[0x1],_0x27a1f9[_0x1b2acc][_0x5bbd95(0x102)]=0x0,_0x27a1f9[_0x1b2acc][_0x5bbd95(0xef)]=0x0,_0x27a1f9[_0x1b2acc][_0x5bbd95(0x182)]=_0x5bbd95(0x1a3),_0x27a1f9[_0x1b2acc]['floorlevel']=_0x4982cd[0x5];}else{if(_0x1b2acc==_0x55e934){var _0x447929;if(_0x4982cd[0x4]=='L')_0x447929=_0x5bbd95(0x16e);else _0x4982cd[0x4]=='F'&&(_0x447929=_0x5bbd95(0x1a3));_0x27a1f9[_0x1b2acc][_0x5bbd95(0x17c)]=_0x4982cd[0x0],_0x27a1f9[_0x1b2acc]['rack']=_0x4982cd[0x1],_0x27a1f9[_0x1b2acc][_0x5bbd95(0x102)]=_0x4982cd[0x2],_0x27a1f9[_0x1b2acc][_0x5bbd95(0xef)]=_0x4982cd[0x3],_0x27a1f9[_0x1b2acc][_0x5bbd95(0x182)]=_0x447929,_0x27a1f9[_0x1b2acc][_0x5bbd95(0x16d)]=_0x4982cd[0x5];}}}});}),_0x5324f1[_0x2672e9(0x13e)]((_0x102244,_0x2c0cd2)=>{var _0x15e6d4=_0x2672e9;_0x27a1f9[_0x2c0cd2][_0x15e6d4(0x196)]=_0x102244;}),_0x5b24f5[_0x2672e9(0x13e)]((_0x19dd90,_0x57ca3a)=>{var _0x3839c9=_0x2672e9;_0x27a1f9[_0x57ca3a][_0x3839c9(0x128)]=_0x19dd90;}),_0x139650[_0x2672e9(0x13e)]((_0x5e943f,_0x437464)=>{var _0x385916=_0x2672e9;_0x27a1f9[_0x437464][_0x385916(0x177)]=_0x5e943f;}),_0x41f6c0[_0x2672e9(0x13e)]((_0x5a12fd,_0x321ea8)=>{var _0x1fdd1b=_0x2672e9;_0x27a1f9[_0x321ea8][_0x1fdd1b(0x142)]=_0x5a12fd;}),_0x309aed[_0x2672e9(0x13e)]((_0x4c8b56,_0x19df2c)=>{var _0x20b7e5=_0x2672e9;_0x27a1f9[_0x19df2c][_0x20b7e5(0xe4)]=_0x4c8b56;}),_0xf33118[_0x2672e9(0x13e)]((_0x1392e9,_0x1d5a76)=>{_0x27a1f9[_0x1d5a76]['secondary_unit']=_0x1392e9;}),_0x2ca299['forEach']((_0x2db0dc,_0x4caec9)=>{_0x27a1f9[_0x4caec9]['product_code']=_0x2db0dc;}),_0x1ee465['forEach']((_0x514604,_0x4cab11)=>{_0x27a1f9[_0x4cab11]['batch_code']=_0x514604;}),_0x10b203[_0x2672e9(0x13e)]((_0x4c3e9d,_0x1448b4)=>{var _0x22818e=_0x2672e9;_0x27a1f9[_0x1448b4][_0x22818e(0x197)]=_0x4c3e9d;}),_0x46e5a4[_0x2672e9(0x13e)]((_0x322c13,_0x3f035d)=>{var _0x47982d=_0x2672e9;_0x27a1f9[_0x3f035d][_0x47982d(0xfe)]=_0x322c13;}),_0x422724[_0x2672e9(0x13e)]((_0x216051,_0x35a0a4)=>{var _0x40f78b=_0x2672e9;_0x27a1f9[_0x35a0a4][_0x40f78b(0x14e)]=_0x216051;}),_0x4101a3[_0x2672e9(0x13e)]((_0x3541a6,_0x3b3d29)=>{var _0x50b400=_0x2672e9;_0x27a1f9[_0x3b3d29][_0x50b400(0x113)]=_0x3541a6;}),_0x1ef2ae[_0x2672e9(0x13e)]((_0x3a07f6,_0x438b75)=>{var _0xe0ed2e=_0x2672e9;_0x27a1f9[_0x438b75][_0xe0ed2e(0x173)]=_0x3a07f6;}),_0x10508a[_0x2672e9(0x13e)]((_0x69b25e,_0x1dbbd5)=>{var _0x4dadde=_0x2672e9;_0x27a1f9[_0x1dbbd5][_0x4dadde(0x12b)]=_0x69b25e;}),_0x4f3a43[_0x2672e9(0x13e)]((_0x29c5e7,_0x5791f8)=>{var _0x44c9eb=_0x2672e9;_0x27a1f9[_0x5791f8][_0x44c9eb(0xee)]=_0x29c5e7;}),_0x394ca9[_0x2672e9(0x13e)]((_0x554707,_0x57a36a)=>{var _0x36547d=_0x2672e9;_0x27a1f9[_0x57a36a][_0x36547d(0xcc)]=_0x554707;});const _0x3c3fb2=_0x27a1f9[_0x2672e9(0xed)](_0x4f9044=>_0x4f9044[_0x2672e9(0x177)]!=='0'&&_0x4f9044['adjust_qty']!=='');var _0x1f4bef=0x0;_0x3c3fb2['forEach'](_0x30cbd0=>{var _0x4d7635=_0x2672e9;console['log'](_0x4d7635(0x13d),_0x30cbd0),parseInt(_0x30cbd0[_0x4d7635(0x177)])<=0x0&&_0x1f4bef++;});if(_0x1f4bef!=0x0)return _0x12f3c2[_0x2672e9(0x112)](_0x2672e9(0xf4),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x3b2450['redirect'](_0x2672e9(0x185));const _0x372bac=new adjustment({'warehouse_name':_0x2bc7b5,'date':_0x1670ae,'product':_0x3c3fb2,'note':_0x14fbc9,'room':_0x5bd9f8,'invoice':_0x364651,'JO_number':_0x5ab2cb,'expiry_date':_0x456e68}),_0x17f30e=await _0x372bac['save']();_0x12f3c2[_0x2672e9(0x112)](_0x2672e9(0x15c),'adjustment\x20add\x20successfull'),_0x3b2450[_0x2672e9(0xd1)](_0x2672e9(0x11d)+_0x17f30e[_0x2672e9(0x192)]);}catch(_0x5bd3c8){console[_0x2672e9(0xc8)](_0x5bd3c8),_0x3b2450[_0x2672e9(0xf0)](0xc8)[_0x2672e9(0x164)]({'message':_0x5bd3c8[_0x2672e9(0x106)]});}}),router[a0_0x238190(0x11e)]('/preview/:id',auth,async(_0x15023d,_0x2a6894)=>{var _0x2a3a25=a0_0x238190;try{const {username:_0x10ad0a,email:_0x34dbd8,role:_0x5a4f1b}=_0x15023d[_0x2a3a25(0xdd)],_0x3124d8=_0x15023d[_0x2a3a25(0xdd)],_0x238b09=await profile[_0x2a3a25(0xe2)]({'email':_0x3124d8[_0x2a3a25(0x167)]}),_0x3ce057=await master_shop['find'](),_0x5d0af2=_0x15023d['params']['id'],_0x23561c=await adjustment['findById']({'_id':_0x5d0af2}),_0x518a94=await purchases[_0x2a3a25(0x159)]([{'$match':{'warehouse_name':_0x23561c[_0x2a3a25(0x180)]}},{'$unwind':_0x2a3a25(0x189)},{'$group':{'_id':_0x2a3a25(0x10a)}}]),_0x3acc59=await product['find']({}),_0x7e710d=await warehouse['aggregate']([{'$match':{'name':_0x23561c[_0x2a3a25(0x180)]}},{'$unwind':_0x2a3a25(0x144)},{'$group':{'_id':_0x2a3a25(0x199),'name':{'$first':_0x2a3a25(0xff)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2a3a25(0x103)},'bin':{'$first':_0x2a3a25(0x16a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x2a3a25(0x141)},'primary_code':{'$first':_0x2a3a25(0x163)},'secondary_code':{'$first':_0x2a3a25(0x17a)},'product_code':{'$first':_0x2a3a25(0x145)},'storage':{'$first':_0x2a3a25(0x11b)},'rack':{'$first':_0x2a3a25(0x13b)},'maxPerUnit':{'$first':_0x2a3a25(0x14a)},'expiry_date':{'$first':_0x2a3a25(0xca)},'production_date':{'$first':_0x2a3a25(0x110)},'batch_code':{'$first':_0x2a3a25(0xf9)},'room':{'$first':_0x2a3a25(0xfc)}}}]);if(_0x3ce057[0x0][_0x2a3a25(0x16c)]=='English\x20(US)'){var _0xc50ba8=users[_0x2a3a25(0xcb)];console[_0x2a3a25(0xc8)](_0xc50ba8);}else{if(_0x3ce057[0x0][_0x2a3a25(0x16c)]=='Hindi')var _0xc50ba8=users[_0x2a3a25(0x12a)];else{if(_0x3ce057[0x0][_0x2a3a25(0x16c)]==_0x2a3a25(0xf7))var _0xc50ba8=users[_0x2a3a25(0xf7)];else{if(_0x3ce057[0x0][_0x2a3a25(0x16c)]==_0x2a3a25(0x155))var _0xc50ba8=users[_0x2a3a25(0x155)];else{if(_0x3ce057[0x0][_0x2a3a25(0x16c)]==_0x2a3a25(0x14c))var _0xc50ba8=users['French'];else{if(_0x3ce057[0x0][_0x2a3a25(0x16c)]==_0x2a3a25(0xdc))var _0xc50ba8=users['Portuguese'];else{if(_0x3ce057[0x0][_0x2a3a25(0x16c)]==_0x2a3a25(0x187))var _0xc50ba8=users['Chinese'];else{if(_0x3ce057[0x0][_0x2a3a25(0x16c)]==_0x2a3a25(0xcd))var _0xc50ba8=users[_0x2a3a25(0x162)];}}}}}}}_0x2a6894[_0x2a3a25(0x165)]('edit_adjustment_view',{'success':_0x15023d[_0x2a3a25(0x112)]('success'),'errors':_0x15023d['flash']('errors'),'role':_0x3124d8,'profile':_0x238b09,'adjustment':_0x23561c,'stock':_0x7e710d,'master_shop':_0x3ce057,'warehouse_name':_0x518a94,'unit':_0x3acc59,'language':_0xc50ba8});}catch(_0x142bc4){console[_0x2a3a25(0xc8)](_0x142bc4),_0x2a6894[_0x2a3a25(0xf0)](0xc8)[_0x2a3a25(0x164)]({'message':_0x142bc4[_0x2a3a25(0x106)]});}}),router[a0_0x238190(0x134)](a0_0x238190(0x176),auth,async(_0x2217ed,_0x2a860b)=>{var _0x38017a=a0_0x238190;try{const _0x5eed7c=_0x2217ed[_0x38017a(0x160)]['id'],{warehouse_name:_0x33370d,Room_name:_0x21446e}=_0x2217ed[_0x38017a(0x11a)],_0x3d9801=await adjustment[_0x38017a(0x188)]({'_id':_0x5eed7c}),_0x376b43=_0x3d9801[_0x38017a(0xf6)]['map'](async _0x1163c8=>{var _0x3dc193=_0x38017a;if(_0x1163c8[_0x3dc193(0x177)]>0x0){var _0x2d1743=await warehouse[_0x3dc193(0xe2)]({'name':_0x33370d,'room':_0x1163c8[_0x3dc193(0x173)],'warehouse_category':_0x3dc193(0xde)});const _0x1f3678=_0x2d1743[_0x3dc193(0x12d)][_0x3dc193(0xd4)](_0x34718c=>{var _0x1ad5af=_0x3dc193;if(_0x1163c8['type']==_0x1ad5af(0x183)){if(_0x34718c[_0x1ad5af(0x109)]==_0x1163c8[_0x1ad5af(0x109)]&&_0x34718c[_0x1ad5af(0x16d)]==_0x1163c8[_0x1ad5af(0x16d)]&&_0x34718c['type']==_0x1163c8['type']&&_0x34718c['bin']==_0x1163c8[_0x1ad5af(0xef)]&&_0x34718c[_0x1ad5af(0x102)]==_0x1163c8[_0x1ad5af(0x102)]&&_0x34718c[_0x1ad5af(0x171)]==_0x1163c8[_0x1ad5af(0x171)]&&_0x34718c[_0x1ad5af(0x17c)]==_0x1163c8['storage']&&_0x34718c[_0x1ad5af(0x197)]==_0x1163c8['expiry_date']&&_0x34718c[_0x1ad5af(0x138)]==_0x1163c8[_0x1ad5af(0x138)]&&_0x34718c[_0x1ad5af(0x14e)]==_0x1163c8['production_date']&&_0x34718c[_0x1ad5af(0xcc)]==_0x1163c8[_0x1ad5af(0xcc)]){var _0x5b1cb1;_0x5b1cb1=_0x1163c8[_0x1ad5af(0x177)],_0x1163c8['prod_cat']=='S'&&(_0x5b1cb1=_0x1163c8[_0x1ad5af(0x177)]),_0x34718c[_0x1ad5af(0xd8)]=_0x34718c['product_stock']-_0x5b1cb1;}}else{if(_0x34718c[_0x1ad5af(0x109)]==_0x1163c8['product_name']&&_0x34718c[_0x1ad5af(0x16d)]==_0x1163c8[_0x1ad5af(0x16d)]&&_0x34718c[_0x1ad5af(0x182)]==_0x1163c8[_0x1ad5af(0x182)]&&_0x34718c[_0x1ad5af(0xef)]==_0x1163c8[_0x1ad5af(0xef)]&&_0x34718c[_0x1ad5af(0x102)]==_0x1163c8[_0x1ad5af(0x102)]&&_0x34718c[_0x1ad5af(0x171)]==_0x1163c8[_0x1ad5af(0x171)]&&_0x34718c[_0x1ad5af(0x17c)]==_0x1163c8['storage']&&_0x34718c[_0x1ad5af(0x197)]==_0x1163c8[_0x1ad5af(0x197)]&&_0x34718c['batch_code']==_0x1163c8[_0x1ad5af(0x138)]&&_0x34718c[_0x1ad5af(0x14e)]==_0x1163c8['production_date']&&_0x34718c[_0x1ad5af(0xcc)]==_0x1163c8[_0x1ad5af(0xcc)]){console[_0x1ad5af(0xc8)](_0x1163c8);var _0x5b1cb1;_0x5b1cb1=_0x1163c8[_0x1ad5af(0x177)],_0x1163c8[_0x1ad5af(0x113)]=='S'&&(_0x5b1cb1=_0x1163c8[_0x1ad5af(0x177)]),console[_0x1ad5af(0xc8)](_0x5b1cb1+_0x1ad5af(0xfd)+_0x1163c8[_0x1ad5af(0x177)]+_0x1ad5af(0xfd)+_0x34718c[_0x1ad5af(0x124)]+_0x1ad5af(0xfd)+_0x1163c8[_0x1ad5af(0x113)]),_0x34718c['product_stock']=_0x34718c['product_stock']+_0x5b1cb1;}}});}return _0x2d1743;});Promise[_0x38017a(0x18e)](_0x376b43)[_0x38017a(0x1a2)](async _0x45b633=>{var _0x3f1908=_0x38017a;try{for(const _0x2a0611 of _0x45b633){await _0x2a0611[_0x3f1908(0x15a)]();}_0x3d9801['finalize']=_0x3f1908(0x10b);const _0x4d86ab=await _0x3d9801[_0x3f1908(0x15a)](),_0x5055c3=await master_shop[_0x3f1908(0x105)](),_0x399b88=await email_settings[_0x3f1908(0xe2)](),_0x45f3df=await supervisor_settings[_0x3f1908(0x105)]();var _0x428df0=_0x3d9801[_0x3f1908(0xf6)],_0x252db9='',_0x2b6914;for(_0x2b6914 in _0x428df0){_0x252db9+='<tr>'+_0x3f1908(0x15b)+_0x428df0[_0x2b6914]['product_name']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x428df0[_0x2b6914][_0x3f1908(0x119)]+_0x3f1908(0x12e)+_0x3f1908(0x15b)+_0x428df0[_0x2b6914]['adjust_qty']+'</td>'+_0x3f1908(0x15b)+_0x428df0[_0x2b6914][_0x3f1908(0xe4)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x428df0[_0x2b6914][_0x3f1908(0x1a4)]+'</td>'+_0x3f1908(0x15b)+_0x3d9801[_0x3f1908(0x180)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x428df0[_0x2b6914]['room_names']+_0x3f1908(0x12e)+_0x3f1908(0x15b)+_0x428df0[_0x2b6914][_0x3f1908(0x17c)]+_0x428df0[_0x2b6914]['rack']+_0x428df0[_0x2b6914][_0x3f1908(0x102)]+_0x428df0[_0x2b6914]['bin']+_0x428df0[_0x2b6914][_0x3f1908(0x182)][0x0]+_0x428df0[_0x2b6914][_0x3f1908(0x16d)]+_0x3f1908(0x12e),'</tr>';}let _0x7c2aea=nodemailer[_0x3f1908(0x111)]({'host':_0x399b88[_0x3f1908(0x17f)],'port':Number(_0x399b88[_0x3f1908(0x198)]),'secure':![],'auth':{'user':_0x399b88[_0x3f1908(0x167)],'pass':_0x399b88[_0x3f1908(0x18c)]}}),_0x11eeb2={'from':_0x399b88[_0x3f1908(0x167)],'to':_0x45f3df[0x0][_0x3f1908(0x11c)],'subject':_0x3f1908(0x16f),'attachments':[{'filename':_0x3f1908(0xe8),'path':__dirname+_0x3f1908(0xd2)+'/upload/'+_0x5055c3[0x0][_0x3f1908(0x17e)],'cid':_0x3f1908(0x193)}],'html':_0x3f1908(0x136)+_0x3f1908(0x19d)+_0x3f1908(0x149)+_0x3f1908(0x1a1)+_0x3f1908(0x18b)+_0x3f1908(0x1a1)+_0x3f1908(0xfa)+_0x3f1908(0xea)+'<div>'+_0x3f1908(0x11f)+_0x5055c3[0x0][_0x3f1908(0xe9)]+'\x20</h2>'+_0x3f1908(0xea)+_0x3f1908(0xea)+_0x3f1908(0x18f)+_0x3f1908(0x1a1)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3f1908(0x146)+_0x3d9801[_0x3f1908(0xcc)]+'\x20'+_0x3f1908(0xd6)+_0x3f1908(0x132)+_0x3d9801[_0x3f1908(0x127)]+'\x20'+_0x3f1908(0xe3)+_0x3f1908(0x125)+_0x3f1908(0xea)+_0x3f1908(0x120)+_0x3f1908(0x15e)+_0x3f1908(0x175)+_0x3f1908(0x10f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x3f1908(0x184)+_0x3f1908(0x13a)+_0x3f1908(0x150)+_0x3f1908(0x179)+_0x3f1908(0xd0)+_0x3f1908(0x12f)+_0x3f1908(0x14f)+_0x3f1908(0x13c)+_0x3f1908(0x19b)+'\x20'+_0x252db9+'\x20'+_0x3f1908(0x131)+_0x3f1908(0x19e)+_0x3f1908(0x1a1)+'<strong>\x20Regards\x20</strong>'+_0x3f1908(0x139)+_0x5055c3[0x0][_0x3f1908(0xe9)]+'</h5>'+_0x3f1908(0xea)+'</div>'+'</body></html>'};_0x7c2aea[_0x3f1908(0x152)](_0x11eeb2,function(_0x4fcc3d,_0x38c11e){var _0x336fd8=_0x3f1908;_0x4fcc3d?(console[_0x336fd8(0xc8)](_0x4fcc3d),console['log'](_0x336fd8(0xf8))):console[_0x336fd8(0xc8)](_0x336fd8(0x191));}),_0x2217ed[_0x3f1908(0x112)](_0x3f1908(0x15c),'adjustment\x20Finalized\x20successfully'),_0x2a860b['redirect']('/picking_list/PDF_adjustment_rm/'+_0x4d86ab[_0x3f1908(0x192)]);}catch(_0x31eb80){console['error'](_0x31eb80),_0x2a860b[_0x3f1908(0xf0)](0x1f4)[_0x3f1908(0x164)]({'error':_0x3f1908(0x153)});}})[_0x38017a(0x148)](_0x33c067=>{var _0x525b77=_0x38017a;console[_0x525b77(0x116)](_0x33c067),_0x2a860b[_0x525b77(0xf0)](0x1f4)[_0x525b77(0x164)]({'error':_0x525b77(0x133)});});}catch(_0x583be){console['log'](_0x583be),_0x2a860b[_0x38017a(0xf0)](0xc8)[_0x38017a(0x164)]({'message':_0x583be[_0x38017a(0x106)]});}}),router[a0_0x238190(0x11e)](a0_0x238190(0x14d),auth,async(_0x2f5e03,_0x84d73c)=>{var _0x6cbbb4=a0_0x238190;try{const {username:_0x218a2d,email:_0x38c054,role:_0x54a912}=_0x2f5e03[_0x6cbbb4(0xdd)],_0x5d4fc8=_0x2f5e03[_0x6cbbb4(0xdd)],_0x8ca7dc=await profile[_0x6cbbb4(0xe2)]({'email':_0x5d4fc8[_0x6cbbb4(0x167)]}),_0x3a7acd=await master_shop['find'](),_0x3f3d87=_0x2f5e03['params']['id'],_0x44252e=await adjustment[_0x6cbbb4(0x188)]({'_id':_0x3f3d87}),_0x20b305=await purchases['aggregate']([{'$match':{'warehouse_name':_0x44252e['warehouse_name']}},{'$unwind':_0x6cbbb4(0x189)},{'$group':{'_id':_0x6cbbb4(0x10a)}}]),_0x4211d2=await product[_0x6cbbb4(0x105)]({}),_0x364be5=await warehouse[_0x6cbbb4(0x159)]([{'$match':{'name':_0x44252e[_0x6cbbb4(0x180)]}},{'$unwind':_0x6cbbb4(0x144)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x6cbbb4(0xff)},'product_stock':{'$first':_0x6cbbb4(0x108)},'bay':{'$first':_0x6cbbb4(0x103)},'bin':{'$first':_0x6cbbb4(0x16a)},'type':{'$first':_0x6cbbb4(0xd3)},'floorlevel':{'$first':_0x6cbbb4(0x141)},'primary_code':{'$first':_0x6cbbb4(0x163)},'secondary_code':{'$first':_0x6cbbb4(0x17a)},'product_code':{'$first':_0x6cbbb4(0x145)},'storage':{'$first':_0x6cbbb4(0x11b)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x6cbbb4(0xca)},'production_date':{'$first':_0x6cbbb4(0x110)},'batch_code':{'$first':_0x6cbbb4(0xf9)},'room':{'$first':'$room'}}}]);let _0x29ed5a;if(_0x5d4fc8[_0x6cbbb4(0x122)]=='staff'){const _0x2ebc29=await staff['findOne']({'email':_0x5d4fc8[_0x6cbbb4(0x167)]});_0x29ed5a=await warehouse[_0x6cbbb4(0x159)]([{'$match':{'status':'Enabled','name':_0x2ebc29[_0x6cbbb4(0x195)],'warehouse_category':_0x6cbbb4(0xde),'name':{'$ne':_0x6cbbb4(0x10e)}}},{'$group':{'_id':_0x6cbbb4(0xf1),'name':{'$first':_0x6cbbb4(0xf1)}}}]);}else _0x29ed5a=await warehouse[_0x6cbbb4(0x159)]([{'$match':{'status':_0x6cbbb4(0x123),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x6cbbb4(0x10e)}}},{'$group':{'_id':_0x6cbbb4(0xf1),'name':{'$first':_0x6cbbb4(0xf1)}}}]);if(_0x3a7acd[0x0][_0x6cbbb4(0x16c)]==_0x6cbbb4(0xe7)){var _0x2ad1b9=users[_0x6cbbb4(0xcb)];console['log'](_0x2ad1b9);}else{if(_0x3a7acd[0x0][_0x6cbbb4(0x16c)]==_0x6cbbb4(0x12a))var _0x2ad1b9=users[_0x6cbbb4(0x12a)];else{if(_0x3a7acd[0x0][_0x6cbbb4(0x16c)]==_0x6cbbb4(0xf7))var _0x2ad1b9=users[_0x6cbbb4(0xf7)];else{if(_0x3a7acd[0x0]['language']=='Spanish')var _0x2ad1b9=users[_0x6cbbb4(0x155)];else{if(_0x3a7acd[0x0][_0x6cbbb4(0x16c)]==_0x6cbbb4(0x14c))var _0x2ad1b9=users[_0x6cbbb4(0x14c)];else{if(_0x3a7acd[0x0]['language']==_0x6cbbb4(0xdc))var _0x2ad1b9=users[_0x6cbbb4(0xcf)];else{if(_0x3a7acd[0x0][_0x6cbbb4(0x16c)]=='Chinese')var _0x2ad1b9=users[_0x6cbbb4(0x187)];else{if(_0x3a7acd[0x0][_0x6cbbb4(0x16c)]==_0x6cbbb4(0xcd))var _0x2ad1b9=users[_0x6cbbb4(0x162)];}}}}}}}_0x84d73c[_0x6cbbb4(0x165)](_0x6cbbb4(0x19f),{'success':_0x2f5e03['flash']('success'),'errors':_0x2f5e03[_0x6cbbb4(0x112)]('errors'),'role':_0x5d4fc8,'profile':_0x8ca7dc,'adjustment':_0x44252e,'stock':_0x364be5,'master_shop':_0x3a7acd,'warehouse_name':_0x20b305,'unit':_0x4211d2,'language':_0x2ad1b9,'warehouse':_0x29ed5a});}catch(_0xeaa0cd){console[_0x6cbbb4(0xc8)](_0xeaa0cd),_0x84d73c[_0x6cbbb4(0xf0)](0xc8)[_0x6cbbb4(0x164)]({'message':_0xeaa0cd[_0x6cbbb4(0x106)]});}}),router[a0_0x238190(0x134)](a0_0x238190(0x14d),auth,async(_0x55dac2,_0x1053ec)=>{var _0x4348be=a0_0x238190;try{const _0x279288=_0x55dac2['params']['id'],_0x5231d4=await adjustment['findById']({'_id':_0x279288}),_0x4fcfd0=await warehouse[_0x4348be(0xe2)]({'name':_0x5231d4[_0x4348be(0x180)],'room':_0x5231d4[_0x4348be(0xe1)]}),{warehouse_name:_0x18ac38,date:_0x1a1d8f,prod_name:_0x59b3d8,level:_0x4c5afc,isle:_0x59e229,pallet:_0x4de9f4,stock:_0x359635,types:_0x34c5f3,adjust_qty:_0x1e378c,new_adjust_qty:_0x33dc17,note:_0x3bfe98,Room_name:_0x2cd43e,invoice:_0x45b188,JO_number:_0x5492b0,expiry_date:_0x295ac6}=_0x55dac2['body'];if(typeof _0x59b3d8==_0x4348be(0x190))var _0xa5dff0=[_0x55dac2['body'][_0x4348be(0x174)]],_0x867caf=[_0x55dac2['body']['level']],_0x38a96d=[_0x55dac2[_0x4348be(0x11a)]['stock']],_0x21dd63=[_0x55dac2[_0x4348be(0x11a)]['types']],_0x4f2ac9=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x107)]],_0x59af9c=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x10d)]],_0x4039b0=[_0x55dac2['body'][_0x4348be(0x154)]],_0x583b87=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0xd5)]],_0x4acce2=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x19a)]],_0x3d149a=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x138)]],_0x2dbdc1=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x197)]],_0x267499=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x15f)]],_0x492a5a=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x14e)]],_0x6b8b2f=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x113)]],_0x570a65=[_0x55dac2[_0x4348be(0x11a)]['Rooms']],_0x546455=[_0x55dac2['body']['prime1']],_0x5d3430=[_0x55dac2[_0x4348be(0x11a)][_0x4348be(0x16b)]];else var _0xa5dff0=[..._0x55dac2['body'][_0x4348be(0x174)]],_0x867caf=[..._0x55dac2[_0x4348be(0x11a)]['level']],_0x38a96d=[..._0x55dac2['body']['stock']],_0x21dd63=[..._0x55dac2[_0x4348be(0x11a)][_0x4348be(0x128)]],_0x4f2ac9=[..._0x55dac2[_0x4348be(0x11a)][_0x4348be(0x107)]],_0x59af9c=[..._0x55dac2[_0x4348be(0x11a)][_0x4348be(0x10d)]],_0x4039b0=[..._0x55dac2[_0x4348be(0x11a)]['unit']],_0x583b87=[..._0x55dac2[_0x4348be(0x11a)]['Secondary_units']],_0x4acce2=[..._0x55dac2[_0x4348be(0x11a)][_0x4348be(0x19a)]],_0x3d149a=[..._0x55dac2['body'][_0x4348be(0x138)]],_0x2dbdc1=[..._0x55dac2['body']['expiry_date']],_0x267499=[..._0x55dac2['body'][_0x4348be(0x15f)]],_0x492a5a=[..._0x55dac2[_0x4348be(0x11a)][_0x4348be(0x14e)]],_0x6b8b2f=[..._0x55dac2['body'][_0x4348be(0x113)]],_0x570a65=[..._0x55dac2[_0x4348be(0x11a)]['Rooms']],_0x546455=[..._0x55dac2['body'][_0x4348be(0x17d)]],_0x5d3430=[..._0x55dac2[_0x4348be(0x11a)]['second1']];const _0x47c5c4=_0xa5dff0[_0x4348be(0xd4)](_0x12eb29=>{return _0x12eb29={'product_name':_0x12eb29};});_0x867caf['forEach']((_0x199ee1,_0x5e6d5e)=>{var _0x2ec1ea=_0x4348be;_0x570a65[_0x2ec1ea(0x13e)]((_0x315cd1,_0x1bb0fc)=>{var _0x3ecf3b=_0x2ec1ea;if(_0x315cd1==_0x3ecf3b(0x186)&&_0x5e6d5e==_0x1bb0fc){var _0x5b7eaa=_0x199ee1[_0x3ecf3b(0x168)](0x3);_0x47c5c4[_0x5e6d5e]['storage']=_0x199ee1[0x0],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x171)]=_0x199ee1[0x1],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x102)]=0x0,_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0xef)]=0x0,_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x182)]=_0x3ecf3b(0x1a3),_0x47c5c4[_0x5e6d5e]['floorlevel']=_0x5b7eaa;}else{if(_0x315cd1=='Shelves'&&_0x5e6d5e==_0x1bb0fc){var _0x5b7eaa=_0x199ee1[_0x3ecf3b(0x168)](0x3);_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x17c)]=_0x199ee1[0x0],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x171)]=_0x199ee1[0x1],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x102)]=0x0,_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0xef)]=0x0,_0x47c5c4[_0x5e6d5e]['type']=_0x3ecf3b(0x1a3),_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x16d)]=_0x199ee1[0x5];}else{if(_0x5e6d5e==_0x1bb0fc){var _0x9ee5c0;if(_0x199ee1[0x4]=='L')_0x9ee5c0=_0x3ecf3b(0x16e);else _0x199ee1[0x4]=='F'&&(_0x9ee5c0=_0x3ecf3b(0x1a3));_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x17c)]=_0x199ee1[0x0],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x171)]=_0x199ee1[0x1],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x102)]=_0x199ee1[0x2],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0xef)]=_0x199ee1[0x3],_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x182)]=_0x9ee5c0,_0x47c5c4[_0x5e6d5e][_0x3ecf3b(0x16d)]=_0x199ee1[0x5];}}}});}),_0x38a96d[_0x4348be(0x13e)]((_0x4cb59a,_0x172532)=>{var _0x468946=_0x4348be;_0x47c5c4[_0x172532][_0x468946(0x196)]=_0x4cb59a;}),_0x21dd63[_0x4348be(0x13e)]((_0x10f186,_0x3a2260)=>{var _0x50b3d7=_0x4348be;_0x47c5c4[_0x3a2260][_0x50b3d7(0x128)]=_0x10f186;}),_0x4f2ac9['forEach']((_0x28aaba,_0x5230ec)=>{var _0x2176d9=_0x4348be;_0x47c5c4[_0x5230ec][_0x2176d9(0x177)]=_0x28aaba;}),_0x59af9c[_0x4348be(0x13e)]((_0x222146,_0x4afa2e)=>{_0x47c5c4[_0x4afa2e]['new_adjust_qty']=_0x222146;}),_0x4039b0[_0x4348be(0x13e)]((_0x5c1f65,_0x13e499)=>{var _0x42483c=_0x4348be;_0x47c5c4[_0x13e499][_0x42483c(0xe4)]=_0x5c1f65;}),_0x583b87['forEach']((_0x4c7066,_0x3a2bed)=>{_0x47c5c4[_0x3a2bed]['secondary_unit']=_0x4c7066;}),_0x4acce2[_0x4348be(0x13e)]((_0x2af845,_0x3be74c)=>{var _0x5ec4e4=_0x4348be;_0x47c5c4[_0x3be74c][_0x5ec4e4(0x119)]=_0x2af845;}),_0x3d149a[_0x4348be(0x13e)]((_0x5d92e7,_0x113b23)=>{_0x47c5c4[_0x113b23]['batch_code']=_0x5d92e7;}),_0x2dbdc1[_0x4348be(0x13e)]((_0x4bfc30,_0x1e568a)=>{var _0x367396=_0x4348be;_0x47c5c4[_0x1e568a][_0x367396(0x197)]=_0x4bfc30;}),_0x267499[_0x4348be(0x13e)]((_0x39101a,_0x20e9f2)=>{var _0x4af56c=_0x4348be;_0x47c5c4[_0x20e9f2][_0x4af56c(0xfe)]=_0x39101a;}),_0x492a5a[_0x4348be(0x13e)]((_0x17d29a,_0xa0e319)=>{_0x47c5c4[_0xa0e319]['production_date']=_0x17d29a;}),_0x6b8b2f[_0x4348be(0x13e)]((_0x265b66,_0x44d8d1)=>{var _0x2913d2=_0x4348be;_0x47c5c4[_0x44d8d1][_0x2913d2(0x113)]=_0x265b66;}),_0x570a65[_0x4348be(0x13e)]((_0x2ae6d3,_0x5da4cf)=>{var _0x1917f2=_0x4348be;_0x47c5c4[_0x5da4cf][_0x1917f2(0x173)]=_0x2ae6d3;}),_0x546455[_0x4348be(0x13e)]((_0x19990b,_0x1493ad)=>{_0x47c5c4[_0x1493ad]['primary_code']=_0x19990b;}),_0x5d3430['forEach']((_0x5cea35,_0x23a597)=>{var _0x9c6c80=_0x4348be;_0x47c5c4[_0x23a597][_0x9c6c80(0xee)]=_0x5cea35;});const _0x421191=_0x47c5c4[_0x4348be(0xed)](_0x1f54ef=>_0x1f54ef[_0x4348be(0x177)]!=='0'&&_0x1f54ef[_0x4348be(0x177)]!=='');var _0x333b6b=0x0;_0x421191['forEach'](_0x1d3918=>{var _0x155fbc=_0x4348be;console['log'](_0x155fbc(0x13d),_0x1d3918),parseInt(_0x1d3918[_0x155fbc(0x177)])<=0x0&&_0x333b6b++;});if(_0x333b6b!=0x0)return _0x55dac2['flash']('errors',_0x4348be(0x130)),_0x1053ec['redirect']('back');_0x5231d4['warehouse_name']=_0x18ac38,_0x5231d4[_0x4348be(0x127)]=_0x1a1d8f,_0x5231d4[_0x4348be(0xf6)]=_0x421191,_0x5231d4[_0x4348be(0xf3)]=_0x3bfe98,_0x5231d4[_0x4348be(0xcc)]=_0x45b188,_0x5231d4[_0x4348be(0x147)]=_0x4348be(0x129);const _0x51dccc=await _0x5231d4['save']();_0x55dac2['flash']('success',_0x4348be(0x170)),_0x1053ec[_0x4348be(0xd1)](_0x4348be(0x181));}catch(_0xfa5a22){console[_0x4348be(0xc8)](_0xfa5a22);}}),router[a0_0x238190(0x134)]('/barcode_scanner',async(_0x627be0,_0x5a6f7f)=>{var _0x46b63a=a0_0x238190;const {primary_code:_0x546160,warehouse_data:_0x440613,rooms_data:_0x5bc121,Roomslist:_0x11b490}=_0x627be0[_0x46b63a(0x11a)],_0x2f0efb=_0x11b490['split'](','),_0x22a14a=[];async function _0x366d0a(_0x24fe8a){var _0x39a7ea=_0x46b63a;const _0x462617=await warehouse[_0x39a7ea(0x159)]([{'$match':{'name':_0x440613,'room':_0x24fe8a}},{'$unwind':_0x39a7ea(0x144)},{'$match':{'product_details.primary_code':_0x546160}},{'$group':{'_id':_0x39a7ea(0x199),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x39a7ea(0x108)},'primary_code':{'$first':_0x39a7ea(0x163)},'secondary_code':{'$first':_0x39a7ea(0x17a)},'product_code':{'$first':_0x39a7ea(0x145)},'level':{'$first':_0x39a7ea(0x103)},'isle':{'$first':_0x39a7ea(0x16a)},'type':{'$first':_0x39a7ea(0xd3)},'pallet':{'$first':_0x39a7ea(0x141)},'unit':{'$first':_0x39a7ea(0x158)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x39a7ea(0x13b)},'expiry_date':{'$first':_0x39a7ea(0xca)},'production_date':{'$first':_0x39a7ea(0x110)},'maxPerUnit':{'$first':_0x39a7ea(0x14a)},'batch_code':{'$first':_0x39a7ea(0xf9)},'product_cat':{'$first':_0x39a7ea(0xc9)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x39a7ea(0xfc)}}}]),_0x4c9fcb=await warehouse['aggregate']([{'$match':{'name':_0x440613,'room':_0x24fe8a}},{'$unwind':_0x39a7ea(0x144)},{'$match':{'product_details.secondary_code':_0x546160}},{'$group':{'_id':_0x39a7ea(0x199),'name':{'$first':_0x39a7ea(0xff)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x39a7ea(0x163)},'secondary_code':{'$first':_0x39a7ea(0x17a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x39a7ea(0x103)},'isle':{'$first':_0x39a7ea(0x16a)},'type':{'$first':_0x39a7ea(0xd3)},'pallet':{'$first':_0x39a7ea(0x141)},'unit':{'$first':_0x39a7ea(0x158)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x39a7ea(0x11b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x39a7ea(0xca)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x39a7ea(0xf9)},'product_cat':{'$first':_0x39a7ea(0xc9)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x39a7ea(0xfc)}}}]);if(_0x462617[_0x39a7ea(0x104)]>0x0)_0x22a14a['push'](_0x462617);else _0x4c9fcb[_0x39a7ea(0x104)]>0x0&&_0x22a14a[_0x39a7ea(0x18a)](_0x4c9fcb);}const _0x4326ea=_0x2f0efb['map'](_0x1e38cd=>_0x366d0a(_0x1e38cd));await Promise[_0x46b63a(0x18e)](_0x4326ea),_0x5a6f7f[_0x46b63a(0x164)](_0x22a14a);}),router[a0_0x238190(0x134)](a0_0x238190(0xda),async(_0x2c29b3,_0x558a5a)=>{var _0x221de8=a0_0x238190;const {primaryCode:_0x441682,secondaryCode:_0x47a30f,productCode:_0x4ff531,level:_0x1f1efd,isle:_0x2ed68d,pallet:_0x442c2d,warehouses:_0x43b88e,room:_0x5d0db6}=_0x2c29b3[_0x221de8(0x11a)];try{const _0x242671=await warehouse['aggregate']([{'$match':{'name':_0x43b88e,'room':_0x5d0db6}},{'$unwind':_0x221de8(0x144)},{'$match':{'product_details.level':parseInt(_0x1f1efd),'product_details.isle':_0x2ed68d,'product_details.pallet':parseInt(_0x442c2d)}},{'$group':{'_id':_0x221de8(0x199),'name':{'$first':_0x221de8(0xff)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x221de8(0x18d)},'isle':{'$first':_0x221de8(0xe0)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x221de8(0x100)}}}]);_0x558a5a[_0x221de8(0xf0)](0xc8)[_0x221de8(0x164)](_0x242671);}catch(_0x44bf23){_0x558a5a[_0x221de8(0xf0)](0x194)[_0x221de8(0x164)]({'message':_0x44bf23[_0x221de8(0x106)]});}}),module[a0_0x238190(0x19c)]=router;