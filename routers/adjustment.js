function a0_0x4b4f(){var _0x18e13b=['Arabic','redirect','prod_invoice','$product_details.rack','$product_details.product_stock','findById','RMSEmail','18vwlOId','product','Receiving\x20Area','</h5>','length','error','ADJ-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Spanish','second1','bin','exports','5979355ldoObC','adjust_qty','email','Logo.png','split','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','sendMail','/adjustment/view','/../public','aggregate','\x20Order\x20Number\x20:\x20','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.type','product_stock','site_title','rack','$product_details.product_cat','$product_details.primary_code','<html><head><title></title>','master','$isAllowEdit','body','adjustment\x20data\x20update\x20successfully','Error\x20Occurs','/view','note','Portuguese','slice','$product_details.batch_code','$product','Return\x20Goods','<span\x20style=\x22float:\x20right;\x22>','product_details','<tbody\x20style=\x22text-align:\x20center;\x22>','\x20<>\x20','errors','product_name','date','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','/CheckingWarehouse','<h5\x20style=\x22text-align:\x20left;\x22>','500751pXMIYd','1318219Dxauzg','all','flash','$product_details.secondary_code','$product_details.secondary_unit','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/view/:id','Adjustment\x20Mail','French','map','post','image','$invoice','createTransport','Secondary_units','Arabic\x20(ae)','expiry_date','back','$product_details.bay','</body></html>','Floor','</tr>','$product_details.pallet','level','adjustment\x20Finalized\x20successfully','<tr>','Ambient','$finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','unit','success','status','English','minus','room_names','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','types','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','maxPerUnit','get','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Level','<hr\x20class=\x22my-3\x22>','render','</div>','nodemailer','new_adjust_qty','Primary_Units','Shelves','/barcode_scanner','New_Qty_Converted_adj','New_Qty_Converted','../middleware/auth','$product_details.unit','Enabled','../models/all_models','findOne','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Hindi','forEach','warehouse_name','params','2880315tKrvSN','Chinese','</table>','$room','product_code','_id','</span>','$product_details.maxPerUnit','Email\x20sent\x20successfully','role','$product.room_names','Rooms','<strong>\x20Regards\x20</strong>','/upload/','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.production_date','storage','log','type','/picking_list/PDF_adjustment_rm/','prod_cat','15164850RXnYSg','$product_details.level','adjustment','3892400eleLWx','edit_adjustment_view','2khcUDJ','warehouse','</head><body>','$product_details._id','Router','batch_code','16hQmPOF','maxperunit','prod_name','find','random','German','staff','production_date','$product_details.expiry_date','<div>','Raw\x20Materials','filter','finalize','An\x20error\x20occurred.','stockBefore','express','json','$product_details.bin','floorlevel','isAllowEdit','stock','English\x20(US)','3276981qxJjxV','/preview/:id','push','bay','prime1','host','invoice','$product_details.floorlevel','catch','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','user','secondary_unit','max_per_unit','$warehouse_name','primary_code','$product_details.product_name','message','prod_code','$name','$product_details.product_code','then','$product_details.isle','logo','language','$product_details','$product_details.storage','Enclosed','foreach\x20newproduct','toString','save'];a0_0x4b4f=function(){return _0x18e13b;};return a0_0x4b4f();}var a0_0x4445d6=a0_0x3cb3;(function(_0x251462,_0x4ab8aa){var _0x1da81e=a0_0x3cb3,_0x3583d1=_0x251462();while(!![]){try{var _0x43b740=-parseInt(_0x1da81e(0x1a7))/0x1*(-parseInt(_0x1da81e(0x204))/0x2)+-parseInt(_0x1da81e(0x220))/0x3+parseInt(_0x1da81e(0x202))/0x4+-parseInt(_0x1da81e(0x17d))/0x5+parseInt(_0x1da81e(0x245))/0x6*(parseInt(_0x1da81e(0x1a8))/0x7)+parseInt(_0x1da81e(0x20a))/0x8*(-parseInt(_0x1da81e(0x1ea))/0x9)+parseInt(_0x1da81e(0x1ff))/0xa;if(_0x43b740===_0x4ab8aa)break;else _0x3583d1['push'](_0x3583d1['shift']());}catch(_0x3c300e){_0x3583d1['push'](_0x3583d1['shift']());}}}(a0_0x4b4f,0x9914b));const express=require(a0_0x4445d6(0x219)),app=express(),router=express[a0_0x4445d6(0x208)](),auth=require(a0_0x4445d6(0x1e0)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x4445d6(0x1e3)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4445d6(0x1d9));router[a0_0x4445d6(0x1d2)](a0_0x4445d6(0x196),auth,async(_0x5230a9,_0x3b591e)=>{var _0x1604cb=a0_0x4445d6;try{const {username:_0x7c2704,email:_0x1b2025,role:_0x2f01b5}=_0x5230a9[_0x1604cb(0x22a)],_0x290878=_0x5230a9[_0x1604cb(0x22a)],_0xa4dd26=await profile[_0x1604cb(0x1e4)]({'email':_0x290878[_0x1604cb(0x17f)]}),_0x550e0c=await master_shop['find']();console['log'](_0x1604cb(0x191),_0x550e0c);let _0x221b02;if(_0x290878['role']=='staff'){const _0x8c4cc7=await staff[_0x1604cb(0x1e4)]({'email':_0x290878['email']});_0x221b02=await warehouse[_0x1604cb(0x20d)]({'status':_0x1604cb(0x1e2),'name':_0x8c4cc7[_0x1604cb(0x205)]});}else _0x221b02=await warehouse[_0x1604cb(0x20d)]({'status':_0x1604cb(0x1e2)});const _0x56a611=await product[_0x1604cb(0x20d)]();let _0x89e1b3;if(_0x290878[_0x1604cb(0x1f3)]==_0x1604cb(0x210)){const _0x4bfb54=await staff[_0x1604cb(0x1e4)]({'email':_0x290878[_0x1604cb(0x17f)]});_0x89e1b3=await adjustment[_0x1604cb(0x20d)]({'warehouse_name':_0x4bfb54[_0x1604cb(0x205)]});}else _0x89e1b3=await adjustment[_0x1604cb(0x187)]([{'$unwind':_0x1604cb(0x19b)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1604cb(0x1b5)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x1604cb(0x22d)},'room':{'$addToSet':_0x1604cb(0x1f4)},'finalize':{'$first':_0x1604cb(0x1c4)},'isAllowEdit':{'$first':_0x1604cb(0x192)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x550e0c[0x0][_0x1604cb(0x237)]==_0x1604cb(0x21f)){var _0x40bc9c=users[_0x1604cb(0x1c9)];console[_0x1604cb(0x1fb)](_0x40bc9c);}else{if(_0x550e0c[0x0]['language']=='Hindi')var _0x40bc9c=users['Hindi'];else{if(_0x550e0c[0x0][_0x1604cb(0x237)]==_0x1604cb(0x20f))var _0x40bc9c=users[_0x1604cb(0x20f)];else{if(_0x550e0c[0x0][_0x1604cb(0x237)]==_0x1604cb(0x179))var _0x40bc9c=users[_0x1604cb(0x179)];else{if(_0x550e0c[0x0][_0x1604cb(0x237)]==_0x1604cb(0x1b1))var _0x40bc9c=users[_0x1604cb(0x1b1)];else{if(_0x550e0c[0x0][_0x1604cb(0x237)]==_0x1604cb(0x1d3))var _0x40bc9c=users['Portuguese'];else{if(_0x550e0c[0x0][_0x1604cb(0x237)]==_0x1604cb(0x1eb))var _0x40bc9c=users[_0x1604cb(0x1eb)];else{if(_0x550e0c[0x0][_0x1604cb(0x237)]=='Arabic\x20(ae)')var _0x40bc9c=users[_0x1604cb(0x23e)];}}}}}}}_0x3b591e['render'](_0x1604cb(0x201),{'success':_0x5230a9[_0x1604cb(0x1aa)](_0x1604cb(0x1c7)),'errors':_0x5230a9[_0x1604cb(0x1aa)](_0x1604cb(0x1a1)),'role':_0x290878,'profile':_0xa4dd26,'warehouse':_0x221b02,'product':_0x56a611,'adjustment':_0x89e1b3,'master_shop':_0x550e0c,'language':_0x40bc9c});}catch(_0x167759){console[_0x1604cb(0x1fb)](_0x167759);}});function a0_0x3cb3(_0x45d8ca,_0x32c2fa){var _0x4b4faa=a0_0x4b4f();return a0_0x3cb3=function(_0x3cb305,_0x2aab0e){_0x3cb305=_0x3cb305-0x175;var _0x1369c9=_0x4b4faa[_0x3cb305];return _0x1369c9;},a0_0x3cb3(_0x45d8ca,_0x32c2fa);}async function getRandom8DigitNumber(){var _0x1202d9=a0_0x4445d6;const _0x44bb5a=0x989680,_0x3fdc35=0x5f5e0ff,_0x2a34bb=Math['floor'](Math[_0x1202d9(0x20e)]()*(_0x3fdc35-_0x44bb5a+0x1))+_0x44bb5a;var _0x22e2d9;const _0x5c3d25=await adjustment['findOne']({'invoice':'ADJ-'+_0x2a34bb});return _0x5c3d25&&_0x5c3d25[_0x1202d9(0x175)]>0x0?_0x22e2d9=_0x1202d9(0x177)+_0x2a34bb:_0x22e2d9=_0x1202d9(0x177)+_0x2a34bb,_0x22e2d9;}router[a0_0x4445d6(0x1d2)]('/view/add_adjustment',auth,async(_0xd2376e,_0x1ff5c7)=>{var _0x29981b=a0_0x4445d6;try{const {username:_0x328ea3,email:_0x5c8030,role:_0x450706}=_0xd2376e[_0x29981b(0x22a)],_0xb87551=_0xd2376e[_0x29981b(0x22a)],_0x25c94b=await profile['findOne']({'email':_0xb87551[_0x29981b(0x17f)]}),_0x20aee2=await master_shop['find']();let _0x4cca01;if(_0xb87551['role']==_0x29981b(0x210)){const _0x3d9a7b=await staff[_0x29981b(0x1e4)]({'email':_0xb87551['email']});_0x4cca01=await warehouse[_0x29981b(0x187)]([{'$match':{'status':_0x29981b(0x1e2),'name':_0x3d9a7b['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x29981b(0x19c)}}},{'$group':{'_id':_0x29981b(0x232),'name':{'$first':_0x29981b(0x232)}}}]);}else _0x4cca01=await warehouse['aggregate']([{'$match':{'status':_0x29981b(0x1e2),'warehouse_category':_0x29981b(0x214),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x29981b(0x232)}}}]);const _0x2ecdb7=await product[_0x29981b(0x20d)]({}),_0x479b94=await adjustment[_0x29981b(0x20d)]({}),_0x8d4357=_0x479b94['length']+0x1,_0x585943=_0x29981b(0x177)+_0x8d4357[_0x29981b(0x23c)]()['padStart'](0x5,'0');var _0xed75fb=[_0x29981b(0x1c3),_0x29981b(0x23a),'Return\x20Rooms'];if(_0x20aee2[0x0][_0x29981b(0x237)]==_0x29981b(0x21f))var _0x2c27e7=users[_0x29981b(0x1c9)];else{if(_0x20aee2[0x0][_0x29981b(0x237)]==_0x29981b(0x1e6))var _0x2c27e7=users[_0x29981b(0x1e6)];else{if(_0x20aee2[0x0][_0x29981b(0x237)]=='German')var _0x2c27e7=users['German'];else{if(_0x20aee2[0x0][_0x29981b(0x237)]==_0x29981b(0x179))var _0x2c27e7=users['Spanish'];else{if(_0x20aee2[0x0][_0x29981b(0x237)]==_0x29981b(0x1b1))var _0x2c27e7=users[_0x29981b(0x1b1)];else{if(_0x20aee2[0x0]['language']=='Portuguese\x20(BR)')var _0x2c27e7=users[_0x29981b(0x198)];else{if(_0x20aee2[0x0][_0x29981b(0x237)]==_0x29981b(0x1eb))var _0x2c27e7=users['Chinese'];else{if(_0x20aee2[0x0][_0x29981b(0x237)]=='Arabic\x20(ae)')var _0x2c27e7=users[_0x29981b(0x23e)];}}}}}}}const _0x2e6fc3=getRandom8DigitNumber();_0x2e6fc3['then'](_0x17d8dc=>{var _0x5c26ef=_0x29981b;_0x1ff5c7['render']('add_adjustment',{'success':_0xd2376e[_0x5c26ef(0x1aa)](_0x5c26ef(0x1c7)),'errors':_0xd2376e[_0x5c26ef(0x1aa)]('errors'),'role':_0xb87551,'profile':_0x25c94b,'warehouse':_0x4cca01,'product':_0x2ecdb7,'master_shop':_0x20aee2,'language':_0x2c27e7,'rooms_data':_0xed75fb,'invoice_no':_0x17d8dc});})[_0x29981b(0x228)](_0x2a99d9=>{var _0x456ee3=_0x29981b;_0xd2376e[_0x456ee3(0x1aa)](_0x456ee3(0x1a1),_0x456ee3(0x1cc)),_0x1ff5c7[_0x456ee3(0x23f)](_0x456ee3(0x185));});}catch(_0x5c6cb5){console[_0x29981b(0x1fb)](_0x5c6cb5);}}),router['post']('/view/add_adjustment',auth,async(_0x465662,_0xfce68d)=>{var _0x34c2c8=a0_0x4445d6;try{const {warehouse_name:_0x5dddab,date:_0x2f1577,prod_name:_0x45971e,level:_0x659fdd,isle:_0x5e9988,pallet:_0x18de6d,stock:_0x363e6c,types:_0x506b78,adjust_qty:_0x117bdb,new_adjust_qty:_0x5083f7,note:_0x19110f,Room_name:_0x577027,invoice:_0x10032c,JO_number:_0x43366d,expiry_date:_0x1e48bd}=_0x465662[_0x34c2c8(0x193)];if(typeof _0x45971e=='string')var _0x409024=[_0x465662[_0x34c2c8(0x193)]['prod_name']],_0x22acef=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1c0)]],_0xb44c25=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x21e)]],_0x3ec5ca=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1cf)]],_0x3b92d3=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1de)]],_0x4e5f9b=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1df)]],_0x1100a7=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1db)]],_0x5b9183=[_0x465662[_0x34c2c8(0x193)]['Secondary_units']],_0x539f56=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x231)]],_0x467e7b=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x209)]],_0x4a0f08=[_0x465662[_0x34c2c8(0x193)]['expiry_date']],_0x15c509=[_0x465662[_0x34c2c8(0x193)]['max_per_unit']],_0x1cc527=[_0x465662['body']['production_date']],_0x270c83=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1fe)]],_0x583729=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1f5)]],_0x1805a9=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x224)]],_0x2a1cdf=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x17a)]],_0x145efc=[_0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x240)]];else var _0x409024=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x20c)]],_0x22acef=[..._0x465662[_0x34c2c8(0x193)]['level']],_0xb44c25=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x21e)]],_0x3ec5ca=[..._0x465662[_0x34c2c8(0x193)]['types']],_0x3b92d3=[..._0x465662['body']['New_Qty_Converted_adj']],_0x4e5f9b=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1df)]],_0x1100a7=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1c6)]],_0x5b9183=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1b7)]],_0x539f56=[..._0x465662['body'][_0x34c2c8(0x231)]],_0x467e7b=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x209)]],_0x4a0f08=[..._0x465662['body'][_0x34c2c8(0x1b9)]],_0x15c509=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x22c)]],_0x1cc527=[..._0x465662[_0x34c2c8(0x193)]['production_date']],_0x270c83=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x1fe)]],_0x583729=[..._0x465662[_0x34c2c8(0x193)]['Rooms']],_0x1805a9=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x224)]],_0x2a1cdf=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x17a)]],_0x145efc=[..._0x465662[_0x34c2c8(0x193)][_0x34c2c8(0x240)]];const _0x1ed115=_0x409024[_0x34c2c8(0x1b2)](_0x48994b=>{return _0x48994b={'product_name':_0x48994b};});_0x22acef[_0x34c2c8(0x1e7)]((_0x12e5fa,_0x3dc0d1)=>{var _0x5c968c=_0x34c2c8;_0x583729[_0x5c968c(0x1e7)]((_0x860c76,_0x50a717)=>{var _0x489fcf=_0x5c968c;if(_0x860c76==_0x489fcf(0x247)&&_0x3dc0d1==_0x50a717){var _0x32243d=_0x12e5fa['slice'](0x3);_0x1ed115[_0x3dc0d1]['storage']=_0x12e5fa[0x0],_0x1ed115[_0x3dc0d1][_0x489fcf(0x18d)]=_0x12e5fa[0x1],_0x1ed115[_0x3dc0d1]['bay']=0x0,_0x1ed115[_0x3dc0d1][_0x489fcf(0x17b)]=0x0,_0x1ed115[_0x3dc0d1]['type']='Floor',_0x1ed115[_0x3dc0d1][_0x489fcf(0x21c)]=_0x32243d;}else{if(_0x860c76==_0x489fcf(0x1dc)&&_0x3dc0d1==_0x50a717){var _0x32243d=_0x12e5fa[_0x489fcf(0x199)](0x3);_0x1ed115[_0x3dc0d1][_0x489fcf(0x1fa)]=_0x12e5fa[0x0],_0x1ed115[_0x3dc0d1][_0x489fcf(0x18d)]=_0x12e5fa[0x1],_0x1ed115[_0x3dc0d1][_0x489fcf(0x223)]=0x0,_0x1ed115[_0x3dc0d1][_0x489fcf(0x17b)]=0x0,_0x1ed115[_0x3dc0d1][_0x489fcf(0x1fc)]=_0x489fcf(0x1bd),_0x1ed115[_0x3dc0d1][_0x489fcf(0x21c)]=_0x12e5fa[0x5];}else{if(_0x3dc0d1==_0x50a717){var _0x3ebae2;if(_0x12e5fa[0x4]=='L')_0x3ebae2=_0x489fcf(0x1d5);else _0x12e5fa[0x4]=='F'&&(_0x3ebae2=_0x489fcf(0x1bd));_0x1ed115[_0x3dc0d1][_0x489fcf(0x1fa)]=_0x12e5fa[0x0],_0x1ed115[_0x3dc0d1][_0x489fcf(0x18d)]=_0x12e5fa[0x1],_0x1ed115[_0x3dc0d1][_0x489fcf(0x223)]=_0x12e5fa[0x2],_0x1ed115[_0x3dc0d1][_0x489fcf(0x17b)]=_0x12e5fa[0x3],_0x1ed115[_0x3dc0d1][_0x489fcf(0x1fc)]=_0x3ebae2,_0x1ed115[_0x3dc0d1][_0x489fcf(0x21c)]=_0x12e5fa[0x5];}}}});}),_0xb44c25[_0x34c2c8(0x1e7)]((_0x2e76ba,_0x35a502)=>{var _0x4dbe27=_0x34c2c8;_0x1ed115[_0x35a502][_0x4dbe27(0x218)]=_0x2e76ba;}),_0x3ec5ca['forEach']((_0x3a51e6,_0x402cb3)=>{var _0x590e79=_0x34c2c8;_0x1ed115[_0x402cb3][_0x590e79(0x1cf)]=_0x3a51e6;}),_0x3b92d3[_0x34c2c8(0x1e7)]((_0x26c36d,_0x452991)=>{_0x1ed115[_0x452991]['adjust_qty']=_0x26c36d;}),_0x4e5f9b[_0x34c2c8(0x1e7)]((_0xa30ea9,_0x5dcd47)=>{var _0xe1df00=_0x34c2c8;_0x1ed115[_0x5dcd47][_0xe1df00(0x1da)]=_0xa30ea9;}),_0x1100a7[_0x34c2c8(0x1e7)]((_0xd982c0,_0x56337c)=>{var _0x20cb18=_0x34c2c8;_0x1ed115[_0x56337c][_0x20cb18(0x1c6)]=_0xd982c0;}),_0x5b9183[_0x34c2c8(0x1e7)]((_0x3f3c48,_0x48e635)=>{var _0x352720=_0x34c2c8;_0x1ed115[_0x48e635][_0x352720(0x22b)]=_0x3f3c48;}),_0x539f56[_0x34c2c8(0x1e7)]((_0x1e4784,_0x52a486)=>{var _0x1dce62=_0x34c2c8;_0x1ed115[_0x52a486][_0x1dce62(0x1ee)]=_0x1e4784;}),_0x467e7b[_0x34c2c8(0x1e7)]((_0x2fe279,_0x35548d)=>{var _0xc08d93=_0x34c2c8;_0x1ed115[_0x35548d][_0xc08d93(0x209)]=_0x2fe279;}),_0x4a0f08[_0x34c2c8(0x1e7)]((_0x4fc89f,_0x4cadca)=>{var _0x46dc2b=_0x34c2c8;_0x1ed115[_0x4cadca][_0x46dc2b(0x1b9)]=_0x4fc89f;}),_0x15c509[_0x34c2c8(0x1e7)]((_0x2edd5c,_0x3d1950)=>{_0x1ed115[_0x3d1950]['maxperunit']=_0x2edd5c;}),_0x1cc527[_0x34c2c8(0x1e7)]((_0x12e89d,_0x3a5c59)=>{var _0x1ef5f9=_0x34c2c8;_0x1ed115[_0x3a5c59][_0x1ef5f9(0x211)]=_0x12e89d;}),_0x270c83['forEach']((_0x426eca,_0x372d9d)=>{var _0x4ce4d9=_0x34c2c8;_0x1ed115[_0x372d9d][_0x4ce4d9(0x1fe)]=_0x426eca;}),_0x583729[_0x34c2c8(0x1e7)]((_0xe69787,_0x2a6322)=>{var _0xa73b6d=_0x34c2c8;_0x1ed115[_0x2a6322][_0xa73b6d(0x1cb)]=_0xe69787;}),_0x1805a9[_0x34c2c8(0x1e7)]((_0x5b6caf,_0x36c6cb)=>{_0x1ed115[_0x36c6cb]['primary_code']=_0x5b6caf;}),_0x2a1cdf[_0x34c2c8(0x1e7)]((_0x12d6cc,_0x549312)=>{_0x1ed115[_0x549312]['secondary_code']=_0x12d6cc;}),_0x145efc[_0x34c2c8(0x1e7)]((_0x547a05,_0x21476f)=>{_0x1ed115[_0x21476f]['invoice']=_0x547a05;});const _0x567f84=_0x1ed115[_0x34c2c8(0x215)](_0x33cf76=>_0x33cf76[_0x34c2c8(0x17e)]!=='0'&&_0x33cf76[_0x34c2c8(0x17e)]!=='');var _0x28647b=0x0;_0x567f84[_0x34c2c8(0x1e7)](_0x46eedc=>{var _0x91cf4a=_0x34c2c8;console[_0x91cf4a(0x1fb)](_0x91cf4a(0x23b),_0x46eedc),parseInt(_0x46eedc['adjust_qty'])<=0x0&&_0x28647b++;});if(_0x28647b!=0x0)return _0x465662[_0x34c2c8(0x1aa)](_0x34c2c8(0x1a1),_0x34c2c8(0x1a4)),_0xfce68d[_0x34c2c8(0x23f)](_0x34c2c8(0x1ba));const _0x2a4818=new adjustment({'warehouse_name':_0x5dddab,'date':_0x2f1577,'product':_0x567f84,'note':_0x19110f,'room':_0x577027,'invoice':_0x10032c,'JO_number':_0x43366d,'expiry_date':_0x1e48bd}),_0x1b2ab8=await _0x2a4818[_0x34c2c8(0x23d)]();_0x465662['flash'](_0x34c2c8(0x1c7),'adjustment\x20add\x20successfull'),_0xfce68d[_0x34c2c8(0x23f)]('/adjustment/preview/'+_0x1b2ab8[_0x34c2c8(0x1ef)]);}catch(_0x4566f4){console[_0x34c2c8(0x1fb)](_0x4566f4),_0xfce68d['status'](0xc8)[_0x34c2c8(0x21a)]({'message':_0x4566f4[_0x34c2c8(0x230)]});}}),router['get'](a0_0x4445d6(0x221),auth,async(_0x1b50dd,_0x385c68)=>{var _0x8cab90=a0_0x4445d6;try{const {username:_0x376a4a,email:_0xc7b5ce,role:_0x4ef5d1}=_0x1b50dd[_0x8cab90(0x22a)],_0x21096a=_0x1b50dd['user'],_0x5e0e08=await profile[_0x8cab90(0x1e4)]({'email':_0x21096a[_0x8cab90(0x17f)]}),_0x1a46b=await master_shop['find'](),_0xa43c34=_0x1b50dd['params']['id'],_0x111c25=await adjustment['findById']({'_id':_0xa43c34}),_0x21fc1d=await purchases[_0x8cab90(0x187)]([{'$match':{'warehouse_name':_0x111c25[_0x8cab90(0x1e8)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x4e42b0=await product[_0x8cab90(0x20d)]({}),_0x4d3ad9=await warehouse[_0x8cab90(0x187)]([{'$match':{'name':_0x111c25['warehouse_name']}},{'$unwind':_0x8cab90(0x238)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x8cab90(0x22f)},'product_stock':{'$first':_0x8cab90(0x242)},'bay':{'$first':_0x8cab90(0x1bb)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x8cab90(0x18a)},'floorlevel':{'$first':_0x8cab90(0x227)},'primary_code':{'$first':_0x8cab90(0x18f)},'secondary_code':{'$first':_0x8cab90(0x1ab)},'product_code':{'$first':_0x8cab90(0x233)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x8cab90(0x241)},'maxPerUnit':{'$first':_0x8cab90(0x1f1)},'expiry_date':{'$first':_0x8cab90(0x212)},'production_date':{'$first':_0x8cab90(0x1f9)},'batch_code':{'$first':_0x8cab90(0x19a)},'room':{'$first':_0x8cab90(0x1ed)}}}]);if(_0x1a46b[0x0][_0x8cab90(0x237)]==_0x8cab90(0x21f)){var _0x156ad9=users[_0x8cab90(0x1c9)];console[_0x8cab90(0x1fb)](_0x156ad9);}else{if(_0x1a46b[0x0]['language']==_0x8cab90(0x1e6))var _0x156ad9=users[_0x8cab90(0x1e6)];else{if(_0x1a46b[0x0][_0x8cab90(0x237)]==_0x8cab90(0x20f))var _0x156ad9=users[_0x8cab90(0x20f)];else{if(_0x1a46b[0x0][_0x8cab90(0x237)]==_0x8cab90(0x179))var _0x156ad9=users[_0x8cab90(0x179)];else{if(_0x1a46b[0x0][_0x8cab90(0x237)]==_0x8cab90(0x1b1))var _0x156ad9=users[_0x8cab90(0x1b1)];else{if(_0x1a46b[0x0][_0x8cab90(0x237)]==_0x8cab90(0x1d3))var _0x156ad9=users[_0x8cab90(0x198)];else{if(_0x1a46b[0x0][_0x8cab90(0x237)]==_0x8cab90(0x1eb))var _0x156ad9=users[_0x8cab90(0x1eb)];else{if(_0x1a46b[0x0][_0x8cab90(0x237)]==_0x8cab90(0x1b8))var _0x156ad9=users[_0x8cab90(0x23e)];}}}}}}}_0x385c68[_0x8cab90(0x1d7)](_0x8cab90(0x203),{'success':_0x1b50dd[_0x8cab90(0x1aa)](_0x8cab90(0x1c7)),'errors':_0x1b50dd['flash'](_0x8cab90(0x1a1)),'role':_0x21096a,'profile':_0x5e0e08,'adjustment':_0x111c25,'stock':_0x4d3ad9,'master_shop':_0x1a46b,'warehouse_name':_0x21fc1d,'unit':_0x4e42b0,'language':_0x156ad9});}catch(_0x4afc42){console[_0x8cab90(0x1fb)](_0x4afc42),_0x385c68[_0x8cab90(0x1c8)](0xc8)[_0x8cab90(0x21a)]({'message':_0x4afc42[_0x8cab90(0x230)]});}}),router[a0_0x4445d6(0x1b3)](a0_0x4445d6(0x221),auth,async(_0x278444,_0x37d71b)=>{var _0x20cd78=a0_0x4445d6;try{const _0x17509d=_0x278444[_0x20cd78(0x1e9)]['id'],{warehouse_name:_0x1434bc,Room_name:_0x2c0a19}=_0x278444[_0x20cd78(0x193)],_0x50336f=await adjustment[_0x20cd78(0x243)]({'_id':_0x17509d}),_0x54f61c=_0x50336f[_0x20cd78(0x246)]['map'](async _0x60ea9c=>{var _0x213ce4=_0x20cd78;if(_0x60ea9c[_0x213ce4(0x17e)]>0x0){var _0x258727=await warehouse[_0x213ce4(0x1e4)]({'name':_0x1434bc,'room':_0x60ea9c[_0x213ce4(0x1cb)],'warehouse_category':'Raw\x20Materials'});const _0x13ed28=_0x258727[_0x213ce4(0x19e)][_0x213ce4(0x1b2)](_0x2b8732=>{var _0x24c831=_0x213ce4;if(_0x60ea9c[_0x24c831(0x1fc)]==_0x24c831(0x1ca)){if(_0x2b8732[_0x24c831(0x1a2)]==_0x60ea9c['product_name']&&_0x2b8732['floorlevel']==_0x60ea9c[_0x24c831(0x21c)]&&_0x2b8732[_0x24c831(0x1fc)]==_0x60ea9c[_0x24c831(0x1fc)]&&_0x2b8732[_0x24c831(0x17b)]==_0x60ea9c[_0x24c831(0x17b)]&&_0x2b8732[_0x24c831(0x223)]==_0x60ea9c[_0x24c831(0x223)]&&_0x2b8732[_0x24c831(0x18d)]==_0x60ea9c[_0x24c831(0x18d)]&&_0x2b8732[_0x24c831(0x1fa)]==_0x60ea9c[_0x24c831(0x1fa)]&&_0x2b8732[_0x24c831(0x1b9)]==_0x60ea9c['expiry_date']&&_0x2b8732[_0x24c831(0x209)]==_0x60ea9c[_0x24c831(0x209)]&&_0x2b8732[_0x24c831(0x211)]==_0x60ea9c[_0x24c831(0x211)]&&_0x2b8732['invoice']==_0x60ea9c[_0x24c831(0x226)]){var _0xe07dce;_0xe07dce=_0x60ea9c[_0x24c831(0x17e)],_0x60ea9c[_0x24c831(0x1fe)]=='S'&&(_0xe07dce=_0x60ea9c[_0x24c831(0x17e)]),_0x2b8732['product_stock']=_0x2b8732[_0x24c831(0x18b)]-_0xe07dce;}}else{if(_0x2b8732['product_name']==_0x60ea9c['product_name']&&_0x2b8732[_0x24c831(0x21c)]==_0x60ea9c[_0x24c831(0x21c)]&&_0x2b8732[_0x24c831(0x1fc)]==_0x60ea9c['type']&&_0x2b8732[_0x24c831(0x17b)]==_0x60ea9c[_0x24c831(0x17b)]&&_0x2b8732['bay']==_0x60ea9c[_0x24c831(0x223)]&&_0x2b8732['rack']==_0x60ea9c[_0x24c831(0x18d)]&&_0x2b8732['storage']==_0x60ea9c[_0x24c831(0x1fa)]&&_0x2b8732['expiry_date']==_0x60ea9c[_0x24c831(0x1b9)]&&_0x2b8732[_0x24c831(0x209)]==_0x60ea9c[_0x24c831(0x209)]&&_0x2b8732['production_date']==_0x60ea9c['production_date']&&_0x2b8732[_0x24c831(0x226)]==_0x60ea9c['invoice']){console[_0x24c831(0x1fb)](_0x60ea9c);var _0xe07dce;_0xe07dce=_0x60ea9c[_0x24c831(0x17e)],_0x60ea9c[_0x24c831(0x1fe)]=='S'&&(_0xe07dce=_0x60ea9c['adjust_qty']),console[_0x24c831(0x1fb)](_0xe07dce+_0x24c831(0x1a0)+_0x60ea9c[_0x24c831(0x17e)]+_0x24c831(0x1a0)+_0x2b8732[_0x24c831(0x1d1)]+'\x20<>\x20'+_0x60ea9c[_0x24c831(0x1fe)]),_0x2b8732['product_stock']=_0x2b8732[_0x24c831(0x18b)]+_0xe07dce;}}});}return _0x258727;});Promise['all'](_0x54f61c)[_0x20cd78(0x234)](async _0x26722f=>{var _0x2f4c4a=_0x20cd78;try{for(const _0x6a0278 of _0x26722f){await _0x6a0278['save']();}_0x50336f[_0x2f4c4a(0x216)]=_0x2f4c4a(0x182);const _0x1ff79b=await _0x50336f[_0x2f4c4a(0x23d)](),_0x41a544=await master_shop[_0x2f4c4a(0x20d)](),_0x3487b0=await email_settings[_0x2f4c4a(0x1e4)](),_0xcac76d=await supervisor_settings['find']();var _0x3d39bf=_0x50336f['product'],_0x37bb6d='',_0x4b36f5;for(_0x4b36f5 in _0x3d39bf){_0x37bb6d+=_0x2f4c4a(0x1c2)+_0x2f4c4a(0x1d0)+_0x3d39bf[_0x4b36f5]['product_name']+_0x2f4c4a(0x1ad)+_0x2f4c4a(0x1d0)+_0x3d39bf[_0x4b36f5]['product_code']+_0x2f4c4a(0x1ad)+_0x2f4c4a(0x1d0)+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x17e)]+'</td>'+_0x2f4c4a(0x1d0)+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x1c6)]+_0x2f4c4a(0x1ad)+_0x2f4c4a(0x1d0)+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x22b)]+_0x2f4c4a(0x1ad)+_0x2f4c4a(0x1d0)+_0x50336f[_0x2f4c4a(0x1e8)]+_0x2f4c4a(0x1ad)+_0x2f4c4a(0x1d0)+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x1cb)]+'</td>'+_0x2f4c4a(0x1d0)+_0x3d39bf[_0x4b36f5]['storage']+_0x3d39bf[_0x4b36f5]['rack']+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x223)]+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x17b)]+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x1fc)][0x0]+_0x3d39bf[_0x4b36f5][_0x2f4c4a(0x21c)]+_0x2f4c4a(0x1ad),'</tr>';}let _0x58eb37=nodemailer[_0x2f4c4a(0x1b6)]({'host':_0x3487b0[_0x2f4c4a(0x225)],'port':Number(_0x3487b0['port']),'secure':![],'auth':{'user':_0x3487b0[_0x2f4c4a(0x17f)],'pass':_0x3487b0['password']}}),_0x446853={'from':_0x3487b0[_0x2f4c4a(0x17f)],'to':_0xcac76d[0x0][_0x2f4c4a(0x244)],'subject':_0x2f4c4a(0x1b0),'attachments':[{'filename':_0x2f4c4a(0x180),'path':__dirname+_0x2f4c4a(0x186)+_0x2f4c4a(0x1f7)+_0x41a544[0x0][_0x2f4c4a(0x1b4)],'cid':_0x2f4c4a(0x236)}],'html':'<!DOCTYPE\x20html>'+_0x2f4c4a(0x190)+_0x2f4c4a(0x206)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2f4c4a(0x213)+_0x2f4c4a(0x1e5)+_0x2f4c4a(0x1d8)+_0x2f4c4a(0x213)+'<h2>\x20'+_0x41a544[0x0][_0x2f4c4a(0x18c)]+'\x20</h2>'+'</div>'+'</div>'+_0x2f4c4a(0x1d6)+_0x2f4c4a(0x213)+_0x2f4c4a(0x1a6)+_0x2f4c4a(0x188)+_0x50336f['invoice']+'\x20'+_0x2f4c4a(0x19d)+'\x20Order\x20Date\x20:\x20'+_0x50336f[_0x2f4c4a(0x1a3)]+'\x20'+_0x2f4c4a(0x1f0)+'</h5>'+_0x2f4c4a(0x1d8)+_0x2f4c4a(0x1f8)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x2f4c4a(0x183)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x2f4c4a(0x1ae)+_0x2f4c4a(0x229)+_0x2f4c4a(0x178)+_0x2f4c4a(0x1c5)+_0x2f4c4a(0x1ce)+_0x2f4c4a(0x1d4)+_0x2f4c4a(0x1be)+'</thead>'+_0x2f4c4a(0x19f)+'\x20'+_0x37bb6d+'\x20'+'</tbody>'+_0x2f4c4a(0x1ec)+_0x2f4c4a(0x213)+_0x2f4c4a(0x1f6)+_0x2f4c4a(0x1cd)+_0x41a544[0x0][_0x2f4c4a(0x18c)]+_0x2f4c4a(0x248)+_0x2f4c4a(0x1d8)+_0x2f4c4a(0x1d8)+_0x2f4c4a(0x1bc)};_0x58eb37[_0x2f4c4a(0x184)](_0x446853,function(_0x377676,_0x43bd3c){var _0x3f2da4=_0x2f4c4a;_0x377676?(console[_0x3f2da4(0x1fb)](_0x377676),console[_0x3f2da4(0x1fb)](_0x3f2da4(0x195))):console[_0x3f2da4(0x1fb)](_0x3f2da4(0x1f2));}),_0x278444[_0x2f4c4a(0x1aa)](_0x2f4c4a(0x1c7),_0x2f4c4a(0x1c1)),_0x37d71b[_0x2f4c4a(0x23f)](_0x2f4c4a(0x1fd)+_0x1ff79b[_0x2f4c4a(0x1ef)]);}catch(_0x3c671d){console[_0x2f4c4a(0x176)](_0x3c671d),_0x37d71b['status'](0x1f4)[_0x2f4c4a(0x21a)]({'error':_0x2f4c4a(0x189)});}})[_0x20cd78(0x228)](_0xdf6080=>{var _0x262b1d=_0x20cd78;console[_0x262b1d(0x176)](_0xdf6080),_0x37d71b[_0x262b1d(0x1c8)](0x1f4)['json']({'error':_0x262b1d(0x217)});});}catch(_0x196f54){console[_0x20cd78(0x1fb)](_0x196f54),_0x37d71b[_0x20cd78(0x1c8)](0xc8)[_0x20cd78(0x21a)]({'message':_0x196f54['message']});}}),router[a0_0x4445d6(0x1d2)](a0_0x4445d6(0x1af),auth,async(_0x51e2df,_0x2ae3ed)=>{var _0x1cca23=a0_0x4445d6;try{const {username:_0x290999,email:_0xabfa66,role:_0x3e2354}=_0x51e2df[_0x1cca23(0x22a)],_0x26f693=_0x51e2df['user'],_0x1c184d=await profile[_0x1cca23(0x1e4)]({'email':_0x26f693[_0x1cca23(0x17f)]}),_0x2449f5=await master_shop[_0x1cca23(0x20d)](),_0x2a385e=_0x51e2df[_0x1cca23(0x1e9)]['id'],_0xee6e95=await adjustment['findById']({'_id':_0x2a385e}),_0x542597=await purchases[_0x1cca23(0x187)]([{'$match':{'warehouse_name':_0xee6e95[_0x1cca23(0x1e8)]}},{'$unwind':_0x1cca23(0x19b)},{'$group':{'_id':'$product.product_name'}}]),_0x23c6fb=await product['find']({}),_0x21c147=await warehouse[_0x1cca23(0x187)]([{'$match':{'name':_0xee6e95[_0x1cca23(0x1e8)]}},{'$unwind':_0x1cca23(0x238)},{'$group':{'_id':_0x1cca23(0x207),'name':{'$first':_0x1cca23(0x22f)},'product_stock':{'$first':_0x1cca23(0x242)},'bay':{'$first':_0x1cca23(0x1bb)},'bin':{'$first':_0x1cca23(0x21b)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1cca23(0x227)},'primary_code':{'$first':_0x1cca23(0x18f)},'secondary_code':{'$first':_0x1cca23(0x1ab)},'product_code':{'$first':_0x1cca23(0x233)},'storage':{'$first':_0x1cca23(0x239)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x1cca23(0x212)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1cca23(0x19a)},'room':{'$first':'$room'}}}]);let _0x193631;if(_0x26f693['role']==_0x1cca23(0x210)){const _0x4f4ecd=await staff[_0x1cca23(0x1e4)]({'email':_0x26f693['email']});_0x193631=await warehouse[_0x1cca23(0x187)]([{'$match':{'status':'Enabled','name':_0x4f4ecd[_0x1cca23(0x205)],'warehouse_category':_0x1cca23(0x214),'name':{'$ne':_0x1cca23(0x19c)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x193631=await warehouse[_0x1cca23(0x187)]([{'$match':{'status':_0x1cca23(0x1e2),'warehouse_category':_0x1cca23(0x214),'name':{'$ne':_0x1cca23(0x19c)}}},{'$group':{'_id':_0x1cca23(0x232),'name':{'$first':_0x1cca23(0x232)}}}]);if(_0x2449f5[0x0]['language']==_0x1cca23(0x21f)){var _0x533437=users[_0x1cca23(0x1c9)];console[_0x1cca23(0x1fb)](_0x533437);}else{if(_0x2449f5[0x0]['language']=='Hindi')var _0x533437=users['Hindi'];else{if(_0x2449f5[0x0][_0x1cca23(0x237)]==_0x1cca23(0x20f))var _0x533437=users['German'];else{if(_0x2449f5[0x0][_0x1cca23(0x237)]==_0x1cca23(0x179))var _0x533437=users[_0x1cca23(0x179)];else{if(_0x2449f5[0x0][_0x1cca23(0x237)]==_0x1cca23(0x1b1))var _0x533437=users[_0x1cca23(0x1b1)];else{if(_0x2449f5[0x0]['language']=='Portuguese\x20(BR)')var _0x533437=users[_0x1cca23(0x198)];else{if(_0x2449f5[0x0][_0x1cca23(0x237)]=='Chinese')var _0x533437=users[_0x1cca23(0x1eb)];else{if(_0x2449f5[0x0][_0x1cca23(0x237)]=='Arabic\x20(ae)')var _0x533437=users[_0x1cca23(0x23e)];}}}}}}}_0x2ae3ed[_0x1cca23(0x1d7)]('edit_adjustment',{'success':_0x51e2df[_0x1cca23(0x1aa)](_0x1cca23(0x1c7)),'errors':_0x51e2df[_0x1cca23(0x1aa)](_0x1cca23(0x1a1)),'role':_0x26f693,'profile':_0x1c184d,'adjustment':_0xee6e95,'stock':_0x21c147,'master_shop':_0x2449f5,'warehouse_name':_0x542597,'unit':_0x23c6fb,'language':_0x533437,'warehouse':_0x193631});}catch(_0x2bf25c){console[_0x1cca23(0x1fb)](_0x2bf25c),_0x2ae3ed[_0x1cca23(0x1c8)](0xc8)[_0x1cca23(0x21a)]({'message':_0x2bf25c[_0x1cca23(0x230)]});}}),router[a0_0x4445d6(0x1b3)](a0_0x4445d6(0x1af),auth,async(_0x181a7d,_0x55fdf6)=>{var _0x16ad59=a0_0x4445d6;try{const _0x5134df=_0x181a7d[_0x16ad59(0x1e9)]['id'],_0x65dbf=await adjustment[_0x16ad59(0x243)]({'_id':_0x5134df}),_0x2b56da=await warehouse[_0x16ad59(0x1e4)]({'name':_0x65dbf[_0x16ad59(0x1e8)],'room':_0x65dbf['room']}),{warehouse_name:_0x4ebe73,date:_0x23d65e,prod_name:_0x5a52af,level:_0x4d373e,isle:_0xbc2184,pallet:_0x5f431e,stock:_0x5c4e13,types:_0x13d0cb,adjust_qty:_0x4f1189,new_adjust_qty:_0x2dba89,note:_0x2ae862,Room_name:_0x2c7354,invoice:_0x2d08f7,JO_number:_0x15d341,expiry_date:_0x2be98a}=_0x181a7d[_0x16ad59(0x193)];if(typeof _0x5a52af=='string')var _0xd7219d=[_0x181a7d['body'][_0x16ad59(0x20c)]],_0x437db9=[_0x181a7d[_0x16ad59(0x193)]['level']],_0x13232b=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x21e)]],_0x45a5bb=[_0x181a7d['body'][_0x16ad59(0x1cf)]],_0x1cdb77=[_0x181a7d[_0x16ad59(0x193)]['New_Qty_Converted_adj']],_0x1b0d62=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1df)]],_0x361c11=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1db)]],_0x106633=[_0x181a7d['body'][_0x16ad59(0x1b7)]],_0x453644=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x231)]],_0x2692a0=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x209)]],_0x53f646=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1b9)]],_0x112269=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x22c)]],_0x2ef175=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x211)]],_0x9992f2=[_0x181a7d[_0x16ad59(0x193)]['prod_cat']],_0xc3a477=[_0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1f5)]],_0x4645cd=[_0x181a7d[_0x16ad59(0x193)]['prime1']],_0x3039b5=[_0x181a7d['body'][_0x16ad59(0x17a)]];else var _0xd7219d=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x20c)]],_0x437db9=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1c0)]],_0x13232b=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x21e)]],_0x45a5bb=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1cf)]],_0x1cdb77=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1de)]],_0x1b0d62=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1df)]],_0x361c11=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1c6)]],_0x106633=[..._0x181a7d['body'][_0x16ad59(0x1b7)]],_0x453644=[..._0x181a7d['body'][_0x16ad59(0x231)]],_0x2692a0=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x209)]],_0x53f646=[..._0x181a7d['body']['expiry_date']],_0x112269=[..._0x181a7d[_0x16ad59(0x193)]['max_per_unit']],_0x2ef175=[..._0x181a7d['body'][_0x16ad59(0x211)]],_0x9992f2=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x1fe)]],_0xc3a477=[..._0x181a7d[_0x16ad59(0x193)]['Rooms']],_0x4645cd=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x224)]],_0x3039b5=[..._0x181a7d[_0x16ad59(0x193)][_0x16ad59(0x17a)]];const _0x3fb78c=_0xd7219d[_0x16ad59(0x1b2)](_0x16c067=>{return _0x16c067={'product_name':_0x16c067};});_0x437db9[_0x16ad59(0x1e7)]((_0x25b6f5,_0x78ae59)=>{var _0x1e6618=_0x16ad59;_0xc3a477[_0x1e6618(0x1e7)]((_0x303dba,_0x491412)=>{var _0x5971d7=_0x1e6618;if(_0x303dba==_0x5971d7(0x247)&&_0x78ae59==_0x491412){var _0x33d105=_0x25b6f5[_0x5971d7(0x199)](0x3);_0x3fb78c[_0x78ae59][_0x5971d7(0x1fa)]=_0x25b6f5[0x0],_0x3fb78c[_0x78ae59]['rack']=_0x25b6f5[0x1],_0x3fb78c[_0x78ae59][_0x5971d7(0x223)]=0x0,_0x3fb78c[_0x78ae59][_0x5971d7(0x17b)]=0x0,_0x3fb78c[_0x78ae59][_0x5971d7(0x1fc)]=_0x5971d7(0x1bd),_0x3fb78c[_0x78ae59][_0x5971d7(0x21c)]=_0x33d105;}else{if(_0x303dba=='Shelves'&&_0x78ae59==_0x491412){var _0x33d105=_0x25b6f5[_0x5971d7(0x199)](0x3);_0x3fb78c[_0x78ae59][_0x5971d7(0x1fa)]=_0x25b6f5[0x0],_0x3fb78c[_0x78ae59][_0x5971d7(0x18d)]=_0x25b6f5[0x1],_0x3fb78c[_0x78ae59][_0x5971d7(0x223)]=0x0,_0x3fb78c[_0x78ae59][_0x5971d7(0x17b)]=0x0,_0x3fb78c[_0x78ae59][_0x5971d7(0x1fc)]=_0x5971d7(0x1bd),_0x3fb78c[_0x78ae59]['floorlevel']=_0x25b6f5[0x5];}else{if(_0x78ae59==_0x491412){var _0x13b123;if(_0x25b6f5[0x4]=='L')_0x13b123='Level';else _0x25b6f5[0x4]=='F'&&(_0x13b123='Floor');_0x3fb78c[_0x78ae59][_0x5971d7(0x1fa)]=_0x25b6f5[0x0],_0x3fb78c[_0x78ae59][_0x5971d7(0x18d)]=_0x25b6f5[0x1],_0x3fb78c[_0x78ae59][_0x5971d7(0x223)]=_0x25b6f5[0x2],_0x3fb78c[_0x78ae59]['bin']=_0x25b6f5[0x3],_0x3fb78c[_0x78ae59][_0x5971d7(0x1fc)]=_0x13b123,_0x3fb78c[_0x78ae59]['floorlevel']=_0x25b6f5[0x5];}}}});}),_0x13232b['forEach']((_0x12b185,_0x46c189)=>{var _0x1f1f8b=_0x16ad59;_0x3fb78c[_0x46c189][_0x1f1f8b(0x218)]=_0x12b185;}),_0x45a5bb[_0x16ad59(0x1e7)]((_0x26d1c0,_0x1bfdfa)=>{var _0x2d28e4=_0x16ad59;_0x3fb78c[_0x1bfdfa][_0x2d28e4(0x1cf)]=_0x26d1c0;}),_0x1cdb77['forEach']((_0xe9f2b4,_0x39b5ae)=>{var _0xd83c75=_0x16ad59;_0x3fb78c[_0x39b5ae][_0xd83c75(0x17e)]=_0xe9f2b4;}),_0x1b0d62['forEach']((_0x2b4deb,_0x345e1e)=>{_0x3fb78c[_0x345e1e]['new_adjust_qty']=_0x2b4deb;}),_0x361c11[_0x16ad59(0x1e7)]((_0x411bd0,_0x2f994c)=>{var _0xbb733=_0x16ad59;_0x3fb78c[_0x2f994c][_0xbb733(0x1c6)]=_0x411bd0;}),_0x106633[_0x16ad59(0x1e7)]((_0x1f9e27,_0x29bdfc)=>{var _0x2c8139=_0x16ad59;_0x3fb78c[_0x29bdfc][_0x2c8139(0x22b)]=_0x1f9e27;}),_0x453644[_0x16ad59(0x1e7)]((_0x2dad2d,_0x5e0fe5)=>{var _0x2d9800=_0x16ad59;_0x3fb78c[_0x5e0fe5][_0x2d9800(0x1ee)]=_0x2dad2d;}),_0x2692a0[_0x16ad59(0x1e7)]((_0x93757c,_0x4c5138)=>{var _0x26ad51=_0x16ad59;_0x3fb78c[_0x4c5138][_0x26ad51(0x209)]=_0x93757c;}),_0x53f646[_0x16ad59(0x1e7)]((_0x442650,_0x5bfe74)=>{var _0x170a5d=_0x16ad59;_0x3fb78c[_0x5bfe74][_0x170a5d(0x1b9)]=_0x442650;}),_0x112269['forEach']((_0x7d3461,_0x2ad76e)=>{var _0x4139c9=_0x16ad59;_0x3fb78c[_0x2ad76e][_0x4139c9(0x20b)]=_0x7d3461;}),_0x2ef175[_0x16ad59(0x1e7)]((_0x1e5c14,_0x4e7718)=>{var _0x4c2844=_0x16ad59;_0x3fb78c[_0x4e7718][_0x4c2844(0x211)]=_0x1e5c14;}),_0x9992f2[_0x16ad59(0x1e7)]((_0x4b88df,_0x24c354)=>{var _0x335631=_0x16ad59;_0x3fb78c[_0x24c354][_0x335631(0x1fe)]=_0x4b88df;}),_0xc3a477[_0x16ad59(0x1e7)]((_0x4723b9,_0x558f00)=>{var _0x24fbee=_0x16ad59;_0x3fb78c[_0x558f00][_0x24fbee(0x1cb)]=_0x4723b9;}),_0x4645cd[_0x16ad59(0x1e7)]((_0x5209a0,_0x25197b)=>{var _0x146f78=_0x16ad59;_0x3fb78c[_0x25197b][_0x146f78(0x22e)]=_0x5209a0;}),_0x3039b5['forEach']((_0x407a72,_0x3db71d)=>{_0x3fb78c[_0x3db71d]['secondary_code']=_0x407a72;});const _0x1bb4ea=_0x3fb78c[_0x16ad59(0x215)](_0x5ef28b=>_0x5ef28b[_0x16ad59(0x17e)]!=='0'&&_0x5ef28b[_0x16ad59(0x17e)]!=='');var _0xcd48d1=0x0;_0x1bb4ea[_0x16ad59(0x1e7)](_0x5a890e=>{var _0x1dff62=_0x16ad59;console['log']('foreach\x20newproduct',_0x5a890e),parseInt(_0x5a890e[_0x1dff62(0x17e)])<=0x0&&_0xcd48d1++;});if(_0xcd48d1!=0x0)return _0x181a7d[_0x16ad59(0x1aa)](_0x16ad59(0x1a1),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x55fdf6[_0x16ad59(0x23f)]('back');_0x65dbf[_0x16ad59(0x1e8)]=_0x4ebe73,_0x65dbf[_0x16ad59(0x1a3)]=_0x23d65e,_0x65dbf[_0x16ad59(0x246)]=_0x1bb4ea,_0x65dbf[_0x16ad59(0x197)]=_0x2ae862,_0x65dbf['invoice']=_0x2d08f7,_0x65dbf[_0x16ad59(0x21d)]='False';const _0x393a6b=await _0x65dbf['save']();_0x181a7d[_0x16ad59(0x1aa)](_0x16ad59(0x1c7),_0x16ad59(0x194)),_0x55fdf6[_0x16ad59(0x23f)](_0x16ad59(0x185));}catch(_0xa1cbe5){console[_0x16ad59(0x1fb)](_0xa1cbe5);}}),router[a0_0x4445d6(0x1b3)](a0_0x4445d6(0x1dd),async(_0x3f8afe,_0x2e809e)=>{var _0x28b935=a0_0x4445d6;const {primary_code:_0x47b636,warehouse_data:_0x170838,rooms_data:_0x5938f3,Roomslist:_0x37447c}=_0x3f8afe[_0x28b935(0x193)],_0xabb413=_0x37447c[_0x28b935(0x181)](','),_0x427929=[];async function _0x31073d(_0x2a51a3){var _0x1cf205=_0x28b935;const _0x341267=await warehouse[_0x1cf205(0x187)]([{'$match':{'name':_0x170838,'room':_0x2a51a3}},{'$unwind':_0x1cf205(0x238)},{'$match':{'product_details.primary_code':_0x47b636}},{'$group':{'_id':_0x1cf205(0x207),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1cf205(0x242)},'primary_code':{'$first':_0x1cf205(0x18f)},'secondary_code':{'$first':_0x1cf205(0x1ab)},'product_code':{'$first':_0x1cf205(0x233)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1cf205(0x21b)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1cf205(0x1e1)},'secondary_unit':{'$first':_0x1cf205(0x1ac)},'storage':{'$first':_0x1cf205(0x239)},'rack':{'$first':_0x1cf205(0x241)},'expiry_date':{'$first':_0x1cf205(0x212)},'production_date':{'$first':_0x1cf205(0x1f9)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x1cf205(0x19a)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1cf205(0x1ed)}}}]),_0x414b89=await warehouse[_0x1cf205(0x187)]([{'$match':{'name':_0x170838,'room':_0x2a51a3}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x47b636}},{'$group':{'_id':_0x1cf205(0x207),'name':{'$first':_0x1cf205(0x22f)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1cf205(0x18f)},'secondary_code':{'$first':_0x1cf205(0x1ab)},'product_code':{'$first':_0x1cf205(0x233)},'level':{'$first':_0x1cf205(0x1bb)},'isle':{'$first':_0x1cf205(0x21b)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1cf205(0x1e1)},'secondary_unit':{'$first':_0x1cf205(0x1ac)},'storage':{'$first':_0x1cf205(0x239)},'rack':{'$first':_0x1cf205(0x241)},'expiry_date':{'$first':_0x1cf205(0x212)},'production_date':{'$first':_0x1cf205(0x1f9)},'maxPerUnit':{'$first':_0x1cf205(0x1f1)},'batch_code':{'$first':_0x1cf205(0x19a)},'product_cat':{'$first':_0x1cf205(0x18e)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x341267[_0x1cf205(0x175)]>0x0)_0x427929[_0x1cf205(0x222)](_0x341267);else _0x414b89[_0x1cf205(0x175)]>0x0&&_0x427929['push'](_0x414b89);}const _0x55fce6=_0xabb413[_0x28b935(0x1b2)](_0x1ebe19=>_0x31073d(_0x1ebe19));await Promise[_0x28b935(0x1a9)](_0x55fce6),_0x2e809e[_0x28b935(0x21a)](_0x427929);}),router['post'](a0_0x4445d6(0x1a5),async(_0x298302,_0x7954b7)=>{var _0x2481b7=a0_0x4445d6;const {primaryCode:_0x42b275,secondaryCode:_0x3f8c69,productCode:_0x5aa67e,level:_0x256157,isle:_0x4f561e,pallet:_0x1cfaa0,warehouses:_0x1b6c09,room:_0x56cb4d}=_0x298302['body'];try{const _0xf01014=await warehouse['aggregate']([{'$match':{'name':_0x1b6c09,'room':_0x56cb4d}},{'$unwind':_0x2481b7(0x238)},{'$match':{'product_details.level':parseInt(_0x256157),'product_details.isle':_0x4f561e,'product_details.pallet':parseInt(_0x1cfaa0)}},{'$group':{'_id':_0x2481b7(0x207),'name':{'$first':_0x2481b7(0x22f)},'product_stock':{'$first':_0x2481b7(0x242)},'level':{'$first':_0x2481b7(0x200)},'isle':{'$first':_0x2481b7(0x235)},'pallet':{'$first':_0x2481b7(0x1bf)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x7954b7[_0x2481b7(0x1c8)](0xc8)[_0x2481b7(0x21a)](_0xf01014);}catch(_0x463eb1){_0x7954b7[_0x2481b7(0x1c8)](0x194)[_0x2481b7(0x21a)]({'message':_0x463eb1[_0x2481b7(0x230)]});}}),module[a0_0x4445d6(0x17c)]=router;