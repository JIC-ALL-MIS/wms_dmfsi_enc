function a0_0x1bbe(){var _0x18ea8f=['prod_name','$product_details.invoice','Adjustment\x20Mail','product_name','product_details','push','German','<strong>\x20Regards\x20</strong>','Return\x20Goods','$product_details.secondary_unit','</td>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Router','$product_details.secondary_code','\x20<>\x20','find','1610220fgVYIc','message','prod_code','</div>','batch_code','Raw\x20Materials','adjustment\x20add\x20successfull','Chinese','<html><head><title></title>','Portuguese','$date','/barcode_scanner','prime1','primary_code','<tbody\x20style=\x22text-align:\x20center;\x22>','stockBefore','padStart','post','language','rack','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','staff','Rooms','False','Enclosed','filter','user','3120750gnJQKV','$product_details.product_code','Receiving\x20Area','findOne','add_adjustment','warehouse','$invoice','$product_details.storage','/picking_list/PDF_adjustment_rm/','expiry_date','floorlevel','316066inrvgC','$product_details.bay','note','$product_details.rack','$product_details.level','edit_adjustment_view','\x20</h2>','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','unit','<tr>','errors','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Primary_Units','split','save','room','Floor','_id','email','Enabled','<h5\x20style=\x22text-align:\x20left;\x22>','<span\x20style=\x22float:\x20right;\x22>','$_id','get','French','catch','<!DOCTYPE\x20html>','map','adjustment','length','/adjustment/view','New_Qty_Converted','Logo.png','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','invoice','New_Qty_Converted_adj','Shelves','sendMail','forEach','secondary_unit','Arabic\x20(ae)','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','ADJ-','production_date','</h5>','$product_details','floor','bin','$room','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','slice','4746yJAuSx','error','Level','port','adjustment\x20data\x20update\x20successfully','$name','createTransport','../public/language/languages.json','second1','foreach\x20newproduct','$product_details.type','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.product_name','$product_details.maxPerUnit','express','$product_details.batch_code','$product_details.unit','Return\x20Rooms','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','prod_invoice','$product_details.production_date','English','<hr\x20class=\x22my-3\x22>','random','maxperunit','edit_adjustment','max_per_unit','$product.room_names','flash','id_transaction_from','string','/view/:id','level','then','$product_details.expiry_date','new_adjust_qty','params','all','Arabic','Hindi','image','status','Error\x20Occurs','storage','Portuguese\x20(BR)','toString','201906yKWhhc','/preview/:id','$product_details._id','../models/all_models','product','</body></html>','762VKTWLj','$product','product_code','/view','master','bay','json','success','$product_details.pallet','</tbody>','product_stock','/../public','$product_details.bin','date','type','redirect','$product.product_name','id_transaction','stock','RMSEmail','<div>','8130cYTkeH','/view/add_adjustment','</table>','Spanish','$warehouse_name','password','472xLwBOw','types','site_title','English\x20(US)','logo','render','3oSonpX','$product_details.product_cat','Secondary_units','$product_details.primary_code','\x20Order\x20Date\x20:\x20','findById','adjust_qty','body','</tr>','role','room_names','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','secondary_code','warehouse_name','prod_cat','$isAllowEdit','back','820788uJXryx','log'];a0_0x1bbe=function(){return _0x18ea8f;};return a0_0x1bbe();}var a0_0x48e799=a0_0x4639;(function(_0x2d666a,_0x7e0086){var _0x10a240=a0_0x4639,_0x17f3c7=_0x2d666a();while(!![]){try{var _0x8cbcfd=-parseInt(_0x10a240(0x1df))/0x1+-parseInt(_0x10a240(0x17c))/0x2+-parseInt(_0x10a240(0x206))/0x3*(parseInt(_0x10a240(0x219))/0x4)+-parseInt(_0x10a240(0x1fa))/0x5*(-parseInt(_0x10a240(0x1e5))/0x6)+-parseInt(_0x10a240(0x1b1))/0x7*(-parseInt(_0x10a240(0x200))/0x8)+parseInt(_0x10a240(0x247))/0x9+parseInt(_0x10a240(0x22b))/0xa;if(_0x8cbcfd===_0x7e0086)break;else _0x17f3c7['push'](_0x17f3c7['shift']());}catch(_0x2865b0){_0x17f3c7['push'](_0x17f3c7['shift']());}}}(a0_0x1bbe,0x2e2d4));const express=require(a0_0x48e799(0x1bf)),app=express(),router=express[a0_0x48e799(0x227)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x48e799(0x1e2)),users=require(a0_0x48e799(0x1b8)),nodemailer=require('nodemailer');function a0_0x4639(_0x1a67b5,_0x439f9c){var _0x1bbe65=a0_0x1bbe();return a0_0x4639=function(_0x4639de,_0x3b4266){_0x4639de=_0x4639de-0x174;var _0x399afe=_0x1bbe65[_0x4639de];return _0x399afe;},a0_0x4639(_0x1a67b5,_0x439f9c);}router[a0_0x48e799(0x194)](a0_0x48e799(0x1e8),auth,async(_0x3fbb3c,_0x199916)=>{var _0xa84128=a0_0x48e799;try{const {username:_0x193f8a,email:_0x5b7841,role:_0x57ee90}=_0x3fbb3c['user'],_0x4267b3=_0x3fbb3c[_0xa84128(0x246)],_0x30f903=await profile[_0xa84128(0x174)]({'email':_0x4267b3[_0xa84128(0x18f)]}),_0x2b797b=await master_shop[_0xa84128(0x22a)]();console['log'](_0xa84128(0x1e9),_0x2b797b);let _0xa91151;if(_0x4267b3[_0xa84128(0x20f)]==_0xa84128(0x241)){const _0x522e95=await staff[_0xa84128(0x174)]({'email':_0x4267b3[_0xa84128(0x18f)]});_0xa91151=await warehouse['find']({'status':'Enabled','name':_0x522e95['warehouse']});}else _0xa91151=await warehouse[_0xa84128(0x22a)]({'status':_0xa84128(0x190)});const _0x49f82d=await product[_0xa84128(0x22a)]();let _0x1e124d;if(_0x4267b3[_0xa84128(0x20f)]=='staff'){const _0x16f8f1=await staff[_0xa84128(0x174)]({'email':_0x4267b3[_0xa84128(0x18f)]});_0x1e124d=await adjustment[_0xa84128(0x22a)]({'warehouse_name':_0x16f8f1[_0xa84128(0x176)]});}else _0x1e124d=await adjustment[_0xa84128(0x1a6)]([{'$unwind':_0xa84128(0x1e6)},{'$group':{'_id':_0xa84128(0x193),'invoice':{'$first':_0xa84128(0x177)},'date':{'$first':_0xa84128(0x235)},'warehouse_name':{'$first':_0xa84128(0x1fe)},'room':{'$addToSet':_0xa84128(0x1cc)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0xa84128(0x217)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2b797b[0x0][_0xa84128(0x23d)]==_0xa84128(0x203)){var _0x4a2146=users['English'];console[_0xa84128(0x21a)](_0x4a2146);}else{if(_0x2b797b[0x0]['language']=='Hindi')var _0x4a2146=users[_0xa84128(0x1d8)];else{if(_0x2b797b[0x0]['language']==_0xa84128(0x221))var _0x4a2146=users['German'];else{if(_0x2b797b[0x0][_0xa84128(0x23d)]==_0xa84128(0x1fd))var _0x4a2146=users[_0xa84128(0x1fd)];else{if(_0x2b797b[0x0][_0xa84128(0x23d)]==_0xa84128(0x195))var _0x4a2146=users[_0xa84128(0x195)];else{if(_0x2b797b[0x0][_0xa84128(0x23d)]=='Portuguese\x20(BR)')var _0x4a2146=users[_0xa84128(0x234)];else{if(_0x2b797b[0x0][_0xa84128(0x23d)]==_0xa84128(0x232))var _0x4a2146=users['Chinese'];else{if(_0x2b797b[0x0][_0xa84128(0x23d)]=='Arabic\x20(ae)')var _0x4a2146=users[_0xa84128(0x1d7)];}}}}}}}_0x199916[_0xa84128(0x205)](_0xa84128(0x199),{'success':_0x3fbb3c[_0xa84128(0x1cd)](_0xa84128(0x1ec)),'errors':_0x3fbb3c['flash']('errors'),'role':_0x4267b3,'profile':_0x30f903,'warehouse':_0xa91151,'product':_0x49f82d,'adjustment':_0x1e124d,'master_shop':_0x2b797b,'language':_0x4a2146});}catch(_0x3152b8){console[_0xa84128(0x21a)](_0x3152b8);}});async function getRandom8DigitNumber(){var _0x53c3f4=a0_0x48e799;const _0x3ea88d=0x989680,_0x1987dc=0x5f5e0ff,_0x5bf1e3=Math[_0x53c3f4(0x1ac)](Math[_0x53c3f4(0x1c8)]()*(_0x1987dc-_0x3ea88d+0x1))+_0x3ea88d;var _0x29c995;const _0x3e672d=await adjustment[_0x53c3f4(0x174)]({'invoice':_0x53c3f4(0x1a8)+_0x5bf1e3});return _0x3e672d&&_0x3e672d[_0x53c3f4(0x19a)]>0x0?_0x29c995='ADJ-'+_0x5bf1e3:_0x29c995=_0x53c3f4(0x1a8)+_0x5bf1e3,_0x29c995;}router[a0_0x48e799(0x194)]('/view/add_adjustment',auth,async(_0x3ce794,_0x4e530e)=>{var _0x4e5580=a0_0x48e799;try{const {username:_0xd5fa3e,email:_0x53839c,role:_0x28aa24}=_0x3ce794[_0x4e5580(0x246)],_0x2317d2=_0x3ce794['user'],_0x5bb2eb=await profile[_0x4e5580(0x174)]({'email':_0x2317d2['email']}),_0x401e19=await master_shop[_0x4e5580(0x22a)]();let _0x551376;if(_0x2317d2[_0x4e5580(0x20f)]=='staff'){const _0x1b0b7f=await staff[_0x4e5580(0x174)]({'email':_0x2317d2['email']});_0x551376=await warehouse[_0x4e5580(0x1a6)]([{'$match':{'status':'Enabled','name':_0x1b0b7f['warehouse'],'warehouse_category':_0x4e5580(0x230),'name':{'$ne':_0x4e5580(0x223)}}},{'$group':{'_id':_0x4e5580(0x1b6),'name':{'$first':_0x4e5580(0x1b6)}}}]);}else _0x551376=await warehouse[_0x4e5580(0x1a6)]([{'$match':{'status':_0x4e5580(0x190),'warehouse_category':_0x4e5580(0x230),'name':{'$ne':_0x4e5580(0x223)}}},{'$group':{'_id':_0x4e5580(0x1b6),'name':{'$first':_0x4e5580(0x1b6)}}}]);const _0x44b9b2=await product[_0x4e5580(0x22a)]({}),_0xd41c9b=await adjustment[_0x4e5580(0x22a)]({}),_0x371bcf=_0xd41c9b[_0x4e5580(0x19a)]+0x1,_0xf847c8=_0x4e5580(0x1a8)+_0x371bcf[_0x4e5580(0x1de)]()[_0x4e5580(0x23b)](0x5,'0');var _0x40b0d6=['Ambient',_0x4e5580(0x244),_0x4e5580(0x1c2)];if(_0x401e19[0x0]['language']=='English\x20(US)')var _0xba6b49=users[_0x4e5580(0x1c6)];else{if(_0x401e19[0x0][_0x4e5580(0x23d)]==_0x4e5580(0x1d8))var _0xba6b49=users[_0x4e5580(0x1d8)];else{if(_0x401e19[0x0][_0x4e5580(0x23d)]==_0x4e5580(0x221))var _0xba6b49=users[_0x4e5580(0x221)];else{if(_0x401e19[0x0]['language']==_0x4e5580(0x1fd))var _0xba6b49=users[_0x4e5580(0x1fd)];else{if(_0x401e19[0x0][_0x4e5580(0x23d)]==_0x4e5580(0x195))var _0xba6b49=users[_0x4e5580(0x195)];else{if(_0x401e19[0x0][_0x4e5580(0x23d)]==_0x4e5580(0x1dd))var _0xba6b49=users[_0x4e5580(0x234)];else{if(_0x401e19[0x0][_0x4e5580(0x23d)]==_0x4e5580(0x232))var _0xba6b49=users[_0x4e5580(0x232)];else{if(_0x401e19[0x0][_0x4e5580(0x23d)]==_0x4e5580(0x1a5))var _0xba6b49=users[_0x4e5580(0x1d7)];}}}}}}}const _0xab295=getRandom8DigitNumber();_0xab295[_0x4e5580(0x1d2)](_0x118a73=>{var _0xfc281=_0x4e5580;_0x4e530e[_0xfc281(0x205)](_0xfc281(0x175),{'success':_0x3ce794[_0xfc281(0x1cd)](_0xfc281(0x1ec)),'errors':_0x3ce794[_0xfc281(0x1cd)]('errors'),'role':_0x2317d2,'profile':_0x5bb2eb,'warehouse':_0x551376,'product':_0x44b9b2,'master_shop':_0x401e19,'language':_0xba6b49,'rooms_data':_0x40b0d6,'invoice_no':_0x118a73});})[_0x4e5580(0x196)](_0x1efce5=>{var _0x29ff57=_0x4e5580;_0x3ce794[_0x29ff57(0x1cd)](_0x29ff57(0x187),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4e530e[_0x29ff57(0x1f4)](_0x29ff57(0x19b));});}catch(_0x5da660){console[_0x4e5580(0x21a)](_0x5da660);}}),router[a0_0x48e799(0x23c)](a0_0x48e799(0x1fb),auth,async(_0x391e1c,_0x1bc262)=>{var _0x35c635=a0_0x48e799;try{const {warehouse_name:_0x2ab8dd,date:_0x5cbd61,prod_name:_0x8934e0,level:_0x35f5d8,isle:_0x595798,pallet:_0x14b037,stock:_0x1e5c30,types:_0x5e08af,adjust_qty:_0x2cdbac,new_adjust_qty:_0x476b93,note:_0x380f2c,Room_name:_0x18ae20,invoice:_0x47aeea,JO_number:_0x669765,expiry_date:_0x5aa3aa}=_0x391e1c['body'];if(typeof _0x8934e0=='string')var _0x4e883c=[_0x391e1c[_0x35c635(0x20d)]['prod_name']],_0x4ef6f5=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1d1)]],_0x30caa8=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1f7)]],_0x4722ad=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x201)]],_0x40b14c=[_0x391e1c['body'][_0x35c635(0x1a0)]],_0x4c835b=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x19c)]],_0x134e27=[_0x391e1c['body'][_0x35c635(0x189)]],_0x100073=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x208)]],_0x1f9873=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x22d)]],_0x45db3b=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x22f)]],_0x57cc64=[_0x391e1c['body'][_0x35c635(0x17a)]],_0x3b1b4d=[_0x391e1c['body'][_0x35c635(0x1cb)]],_0xca0169=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1a9)]],_0xf4815d=[_0x391e1c['body'][_0x35c635(0x216)]],_0x5f0ad1=[_0x391e1c[_0x35c635(0x20d)]['Rooms']],_0x302543=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x237)]],_0x3dd1db=[_0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1b9)]],_0x2d8bcf=[_0x391e1c['body'][_0x35c635(0x1c4)]],_0x3ee3f0=[_0x391e1c[_0x35c635(0x20d)]['id_transaction']];else var _0x4e883c=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x21b)]],_0x4ef6f5=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1d1)]],_0x30caa8=[..._0x391e1c[_0x35c635(0x20d)]['stock']],_0x4722ad=[..._0x391e1c[_0x35c635(0x20d)]['types']],_0x40b14c=[..._0x391e1c['body'][_0x35c635(0x1a0)]],_0x4c835b=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x19c)]],_0x134e27=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x185)]],_0x100073=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x208)]],_0x1f9873=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x22d)]],_0x45db3b=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x22f)]],_0x57cc64=[..._0x391e1c['body']['expiry_date']],_0x3b1b4d=[..._0x391e1c[_0x35c635(0x20d)]['max_per_unit']],_0xca0169=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1a9)]],_0xf4815d=[..._0x391e1c['body'][_0x35c635(0x216)]],_0x5f0ad1=[..._0x391e1c['body'][_0x35c635(0x242)]],_0x302543=[..._0x391e1c['body'][_0x35c635(0x237)]],_0x3dd1db=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1b9)]],_0x2d8bcf=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1c4)]],_0x3ee3f0=[..._0x391e1c[_0x35c635(0x20d)][_0x35c635(0x1f6)]];const _0x2c9d72=_0x4e883c[_0x35c635(0x198)](_0x8e8509=>{return _0x8e8509={'product_name':_0x8e8509};});_0x4ef6f5[_0x35c635(0x1a3)]((_0x58923d,_0x2c23d0)=>{var _0x2559b0=_0x35c635;_0x5f0ad1[_0x2559b0(0x1a3)]((_0x7ef70e,_0x2c038f)=>{var _0x573286=_0x2559b0;if(_0x7ef70e=='Receiving\x20Area'&&_0x2c23d0==_0x2c038f){var _0x29889e=_0x58923d[_0x573286(0x1b0)](0x3);_0x2c9d72[_0x2c23d0][_0x573286(0x1dc)]=_0x58923d[0x0],_0x2c9d72[_0x2c23d0][_0x573286(0x23e)]=_0x58923d[0x1],_0x2c9d72[_0x2c23d0][_0x573286(0x1ea)]=0x0,_0x2c9d72[_0x2c23d0][_0x573286(0x1ad)]=0x0,_0x2c9d72[_0x2c23d0][_0x573286(0x1f3)]=_0x573286(0x18d),_0x2c9d72[_0x2c23d0][_0x573286(0x17b)]=_0x29889e;}else{if(_0x7ef70e==_0x573286(0x1a1)&&_0x2c23d0==_0x2c038f){var _0x29889e=_0x58923d[_0x573286(0x1b0)](0x3);_0x2c9d72[_0x2c23d0][_0x573286(0x1dc)]=_0x58923d[0x0],_0x2c9d72[_0x2c23d0][_0x573286(0x23e)]=_0x58923d[0x1],_0x2c9d72[_0x2c23d0][_0x573286(0x1ea)]=0x0,_0x2c9d72[_0x2c23d0][_0x573286(0x1ad)]=0x0,_0x2c9d72[_0x2c23d0][_0x573286(0x1f3)]=_0x573286(0x18d),_0x2c9d72[_0x2c23d0][_0x573286(0x17b)]=_0x58923d[0x5];}else{if(_0x2c23d0==_0x2c038f){var _0xb0b066;if(_0x58923d[0x4]=='L')_0xb0b066=_0x573286(0x1b3);else _0x58923d[0x4]=='F'&&(_0xb0b066=_0x573286(0x18d));_0x2c9d72[_0x2c23d0][_0x573286(0x1dc)]=_0x58923d[0x0],_0x2c9d72[_0x2c23d0][_0x573286(0x23e)]=_0x58923d[0x1],_0x2c9d72[_0x2c23d0][_0x573286(0x1ea)]=_0x58923d[0x2],_0x2c9d72[_0x2c23d0][_0x573286(0x1ad)]=_0x58923d[0x3],_0x2c9d72[_0x2c23d0][_0x573286(0x1f3)]=_0xb0b066,_0x2c9d72[_0x2c23d0][_0x573286(0x17b)]=_0x58923d[0x5];}}}});}),_0x30caa8['forEach']((_0x4dd46d,_0x5b9043)=>{var _0x42a03f=_0x35c635;_0x2c9d72[_0x5b9043][_0x42a03f(0x23a)]=_0x4dd46d;}),_0x3ee3f0[_0x35c635(0x1a3)]((_0x27d743,_0x151b51)=>{var _0x47859e=_0x35c635;_0x2c9d72[_0x151b51][_0x47859e(0x1ce)]=_0x27d743;}),_0x4722ad['forEach']((_0x1afad7,_0x4546c3)=>{var _0x58d189=_0x35c635;_0x2c9d72[_0x4546c3][_0x58d189(0x201)]=_0x1afad7;}),_0x40b14c[_0x35c635(0x1a3)]((_0x352600,_0x227e67)=>{var _0x5edb68=_0x35c635;_0x2c9d72[_0x227e67][_0x5edb68(0x20c)]=_0x352600;}),_0x4c835b[_0x35c635(0x1a3)]((_0x3295d8,_0x438c11)=>{var _0x375e94=_0x35c635;_0x2c9d72[_0x438c11][_0x375e94(0x1d4)]=_0x3295d8;}),_0x134e27[_0x35c635(0x1a3)]((_0x4a10b0,_0x92cef2)=>{var _0x302fff=_0x35c635;_0x2c9d72[_0x92cef2][_0x302fff(0x185)]=_0x4a10b0;}),_0x100073['forEach']((_0x3ebd87,_0x1a3f46)=>{_0x2c9d72[_0x1a3f46]['secondary_unit']=_0x3ebd87;}),_0x1f9873['forEach']((_0x340da2,_0x44124d)=>{var _0xd7a639=_0x35c635;_0x2c9d72[_0x44124d][_0xd7a639(0x1e7)]=_0x340da2;}),_0x45db3b[_0x35c635(0x1a3)]((_0x5e59cc,_0x5c8314)=>{var _0x41aae6=_0x35c635;_0x2c9d72[_0x5c8314][_0x41aae6(0x22f)]=_0x5e59cc;}),_0x57cc64[_0x35c635(0x1a3)]((_0x472cf4,_0x4bcfc0)=>{_0x2c9d72[_0x4bcfc0]['expiry_date']=_0x472cf4;}),_0x3b1b4d[_0x35c635(0x1a3)]((_0xc136be,_0x203ec5)=>{var _0x3b70c6=_0x35c635;_0x2c9d72[_0x203ec5][_0x3b70c6(0x1c9)]=_0xc136be;}),_0xca0169[_0x35c635(0x1a3)]((_0x924cb6,_0x317fbd)=>{var _0x2650f7=_0x35c635;_0x2c9d72[_0x317fbd][_0x2650f7(0x1a9)]=_0x924cb6;}),_0xf4815d[_0x35c635(0x1a3)]((_0x28cd7c,_0x18c87c)=>{var _0x30ec9d=_0x35c635;_0x2c9d72[_0x18c87c][_0x30ec9d(0x216)]=_0x28cd7c;}),_0x5f0ad1[_0x35c635(0x1a3)]((_0x16205e,_0x4e3b4c)=>{var _0x4ed022=_0x35c635;_0x2c9d72[_0x4e3b4c][_0x4ed022(0x210)]=_0x16205e;}),_0x302543[_0x35c635(0x1a3)]((_0x3e925c,_0x50c6e2)=>{var _0x1b2ea4=_0x35c635;_0x2c9d72[_0x50c6e2][_0x1b2ea4(0x238)]=_0x3e925c;}),_0x3dd1db[_0x35c635(0x1a3)]((_0x5da39b,_0x465003)=>{var _0x2b0951=_0x35c635;_0x2c9d72[_0x465003][_0x2b0951(0x214)]=_0x5da39b;}),_0x2d8bcf[_0x35c635(0x1a3)]((_0x4f2017,_0xc815f6)=>{_0x2c9d72[_0xc815f6]['invoice']=_0x4f2017;});const _0x131d03=_0x2c9d72[_0x35c635(0x245)](_0x224f71=>_0x224f71['adjust_qty']!=='0'&&_0x224f71[_0x35c635(0x20c)]!=='');var _0x3a6a42=0x0;_0x131d03[_0x35c635(0x1a3)](_0x46c18c=>{var _0x18b554=_0x35c635;console[_0x18b554(0x21a)](_0x18b554(0x1ba),_0x46c18c),parseInt(_0x46c18c[_0x18b554(0x20c)])<=0x0&&_0x3a6a42++;});if(_0x3a6a42!=0x0)return _0x391e1c[_0x35c635(0x1cd)](_0x35c635(0x187),_0x35c635(0x19e)),_0x1bc262['redirect'](_0x35c635(0x218));const _0x58c4d7=new adjustment({'warehouse_name':_0x2ab8dd,'date':_0x5cbd61,'product':_0x131d03,'note':_0x380f2c,'room':_0x18ae20,'invoice':_0x47aeea,'JO_number':_0x669765,'expiry_date':_0x5aa3aa}),_0x25d7b4=await _0x58c4d7[_0x35c635(0x18b)]();_0x391e1c['flash']('success',_0x35c635(0x231)),_0x1bc262[_0x35c635(0x1f4)]('/adjustment/preview/'+_0x25d7b4[_0x35c635(0x18e)]);}catch(_0x52d442){console['log'](_0x52d442),_0x1bc262[_0x35c635(0x1da)](0xc8)['json']({'message':_0x52d442[_0x35c635(0x22c)]});}}),router[a0_0x48e799(0x194)](a0_0x48e799(0x1e0),auth,async(_0x3c4f1c,_0x18cf8e)=>{var _0x3998ad=a0_0x48e799;try{const {username:_0x3cba70,email:_0xaa9fe,role:_0x48e924}=_0x3c4f1c[_0x3998ad(0x246)],_0x1bf4cf=_0x3c4f1c['user'],_0x1eb4c1=await profile[_0x3998ad(0x174)]({'email':_0x1bf4cf[_0x3998ad(0x18f)]}),_0x5ea185=await master_shop['find'](),_0xb09866=_0x3c4f1c[_0x3998ad(0x1d5)]['id'],_0xcdc30e=await adjustment[_0x3998ad(0x20b)]({'_id':_0xb09866}),_0x5c5e30=await purchases[_0x3998ad(0x1a6)]([{'$match':{'warehouse_name':_0xcdc30e[_0x3998ad(0x215)]}},{'$unwind':'$product'},{'$group':{'_id':_0x3998ad(0x1f5)}}]),_0x38cc00=await product[_0x3998ad(0x22a)]({}),_0x21465f=await warehouse[_0x3998ad(0x1a6)]([{'$match':{'name':_0xcdc30e[_0x3998ad(0x215)]}},{'$unwind':_0x3998ad(0x1ab)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3998ad(0x1bd)},'product_stock':{'$first':_0x3998ad(0x211)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x3998ad(0x1f1)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x3998ad(0x183)},'primary_code':{'$first':_0x3998ad(0x209)},'secondary_code':{'$first':_0x3998ad(0x228)},'product_code':{'$first':_0x3998ad(0x248)},'storage':{'$first':_0x3998ad(0x178)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x3998ad(0x1be)},'expiry_date':{'$first':_0x3998ad(0x1d3)},'production_date':{'$first':_0x3998ad(0x1c5)},'batch_code':{'$first':_0x3998ad(0x1c0)},'room':{'$first':'$room'}}}]);if(_0x5ea185[0x0][_0x3998ad(0x23d)]==_0x3998ad(0x203)){var _0x5dd498=users[_0x3998ad(0x1c6)];console['log'](_0x5dd498);}else{if(_0x5ea185[0x0][_0x3998ad(0x23d)]=='Hindi')var _0x5dd498=users['Hindi'];else{if(_0x5ea185[0x0][_0x3998ad(0x23d)]=='German')var _0x5dd498=users['German'];else{if(_0x5ea185[0x0]['language']==_0x3998ad(0x1fd))var _0x5dd498=users[_0x3998ad(0x1fd)];else{if(_0x5ea185[0x0][_0x3998ad(0x23d)]==_0x3998ad(0x195))var _0x5dd498=users[_0x3998ad(0x195)];else{if(_0x5ea185[0x0][_0x3998ad(0x23d)]==_0x3998ad(0x1dd))var _0x5dd498=users['Portuguese'];else{if(_0x5ea185[0x0][_0x3998ad(0x23d)]=='Chinese')var _0x5dd498=users[_0x3998ad(0x232)];else{if(_0x5ea185[0x0][_0x3998ad(0x23d)]==_0x3998ad(0x1a5))var _0x5dd498=users[_0x3998ad(0x1d7)];}}}}}}}_0x18cf8e['render'](_0x3998ad(0x181),{'success':_0x3c4f1c[_0x3998ad(0x1cd)](_0x3998ad(0x1ec)),'errors':_0x3c4f1c[_0x3998ad(0x1cd)]('errors'),'role':_0x1bf4cf,'profile':_0x1eb4c1,'adjustment':_0xcdc30e,'stock':_0x21465f,'master_shop':_0x5ea185,'warehouse_name':_0x5c5e30,'unit':_0x38cc00,'language':_0x5dd498});}catch(_0x4b909f){console[_0x3998ad(0x21a)](_0x4b909f),_0x18cf8e[_0x3998ad(0x1da)](0xc8)[_0x3998ad(0x1eb)]({'message':_0x4b909f[_0x3998ad(0x22c)]});}}),router[a0_0x48e799(0x23c)](a0_0x48e799(0x1e0),auth,async(_0x191b32,_0x1774fe)=>{var _0x2a3182=a0_0x48e799;try{const _0x1d3b54=_0x191b32[_0x2a3182(0x1d5)]['id'],{warehouse_name:_0x373127,Room_name:_0x5aa318}=_0x191b32[_0x2a3182(0x20d)],_0x501fb8=await adjustment['findById']({'_id':_0x1d3b54}),_0xcb33e3=_0x501fb8[_0x2a3182(0x1e3)]['map'](async _0x1fbbc5=>{var _0x42046c=_0x2a3182;if(_0x1fbbc5['adjust_qty']>0x0){var _0x264478=await warehouse['findOne']({'name':_0x373127,'room':_0x1fbbc5['room_names'],'warehouse_category':'Raw\x20Materials'});const _0x51aaa5=_0x264478[_0x42046c(0x21f)]['map'](_0x24acd5=>{var _0x3a26af=_0x42046c;if(_0x1fbbc5[_0x3a26af(0x1f3)]=='minus'){if(_0x24acd5[_0x3a26af(0x21e)]==_0x1fbbc5[_0x3a26af(0x21e)]&&_0x24acd5[_0x3a26af(0x17b)]==_0x1fbbc5[_0x3a26af(0x17b)]&&_0x24acd5['type']==_0x1fbbc5[_0x3a26af(0x1f3)]&&_0x24acd5['bin']==_0x1fbbc5[_0x3a26af(0x1ad)]&&_0x24acd5['bay']==_0x1fbbc5[_0x3a26af(0x1ea)]&&_0x24acd5[_0x3a26af(0x23e)]==_0x1fbbc5[_0x3a26af(0x23e)]&&_0x24acd5['storage']==_0x1fbbc5[_0x3a26af(0x1dc)]&&_0x24acd5['expiry_date']==_0x1fbbc5['expiry_date']&&_0x24acd5[_0x3a26af(0x22f)]==_0x1fbbc5[_0x3a26af(0x22f)]&&_0x24acd5[_0x3a26af(0x1a9)]==_0x1fbbc5[_0x3a26af(0x1a9)]&&_0x24acd5[_0x3a26af(0x19f)]==_0x1fbbc5['invoice']&&_0x24acd5['_id']==_0x1fbbc5[_0x3a26af(0x1ce)]){var _0x52422b;_0x52422b=_0x1fbbc5[_0x3a26af(0x20c)],_0x1fbbc5['prod_cat']=='S'&&(_0x52422b=_0x1fbbc5[_0x3a26af(0x20c)]),_0x24acd5[_0x3a26af(0x1ef)]=_0x24acd5[_0x3a26af(0x1ef)]-_0x52422b;}}else{if(_0x24acd5[_0x3a26af(0x21e)]==_0x1fbbc5[_0x3a26af(0x21e)]&&_0x24acd5[_0x3a26af(0x17b)]==_0x1fbbc5['floorlevel']&&_0x24acd5['type']==_0x1fbbc5[_0x3a26af(0x1f3)]&&_0x24acd5[_0x3a26af(0x1ad)]==_0x1fbbc5['bin']&&_0x24acd5['bay']==_0x1fbbc5[_0x3a26af(0x1ea)]&&_0x24acd5[_0x3a26af(0x23e)]==_0x1fbbc5[_0x3a26af(0x23e)]&&_0x24acd5[_0x3a26af(0x1dc)]==_0x1fbbc5[_0x3a26af(0x1dc)]&&_0x24acd5[_0x3a26af(0x17a)]==_0x1fbbc5[_0x3a26af(0x17a)]&&_0x24acd5[_0x3a26af(0x22f)]==_0x1fbbc5[_0x3a26af(0x22f)]&&_0x24acd5[_0x3a26af(0x1a9)]==_0x1fbbc5[_0x3a26af(0x1a9)]&&_0x24acd5[_0x3a26af(0x19f)]==_0x1fbbc5['invoice']&&_0x24acd5['_id']==_0x1fbbc5[_0x3a26af(0x1ce)]){console[_0x3a26af(0x21a)](_0x1fbbc5);var _0x52422b;_0x52422b=_0x1fbbc5['adjust_qty'],_0x1fbbc5[_0x3a26af(0x216)]=='S'&&(_0x52422b=_0x1fbbc5[_0x3a26af(0x20c)]),console['log'](_0x52422b+'\x20<>\x20'+_0x1fbbc5[_0x3a26af(0x20c)]+_0x3a26af(0x229)+_0x24acd5['maxPerUnit']+_0x3a26af(0x229)+_0x1fbbc5[_0x3a26af(0x216)]),_0x24acd5['product_stock']=_0x24acd5[_0x3a26af(0x1ef)]+_0x52422b;}}});}return _0x264478;});Promise[_0x2a3182(0x1d6)](_0xcb33e3)[_0x2a3182(0x1d2)](async _0x55f406=>{var _0x4d54f5=_0x2a3182;try{for(const _0x30d417 of _0x55f406){await _0x30d417[_0x4d54f5(0x18b)]();}_0x501fb8['finalize']='True';const _0x5a00ef=await _0x501fb8['save'](),_0x5d340c=await master_shop[_0x4d54f5(0x22a)](),_0x2a601c=await email_settings['findOne'](),_0x3b1dea=await supervisor_settings['find']();var _0x105e6c=_0x501fb8[_0x4d54f5(0x1e3)],_0x3e9c39='',_0x49b932;for(_0x49b932 in _0x105e6c){_0x3e9c39+=_0x4d54f5(0x186)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x105e6c[_0x49b932][_0x4d54f5(0x21e)]+_0x4d54f5(0x225)+_0x4d54f5(0x1c3)+_0x105e6c[_0x49b932][_0x4d54f5(0x1e7)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x105e6c[_0x49b932]['adjust_qty']+_0x4d54f5(0x225)+_0x4d54f5(0x1c3)+_0x105e6c[_0x49b932][_0x4d54f5(0x185)]+_0x4d54f5(0x225)+_0x4d54f5(0x1c3)+_0x105e6c[_0x49b932][_0x4d54f5(0x1a4)]+_0x4d54f5(0x225)+_0x4d54f5(0x1c3)+_0x501fb8['warehouse_name']+_0x4d54f5(0x225)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x105e6c[_0x49b932][_0x4d54f5(0x210)]+_0x4d54f5(0x225)+_0x4d54f5(0x1c3)+_0x105e6c[_0x49b932][_0x4d54f5(0x1dc)]+_0x105e6c[_0x49b932][_0x4d54f5(0x23e)]+_0x105e6c[_0x49b932][_0x4d54f5(0x1ea)]+_0x105e6c[_0x49b932][_0x4d54f5(0x1ad)]+_0x105e6c[_0x49b932][_0x4d54f5(0x1f3)][0x0]+_0x105e6c[_0x49b932][_0x4d54f5(0x17b)]+'</td>',_0x4d54f5(0x20e);}let _0x3245b4=nodemailer[_0x4d54f5(0x1b7)]({'host':_0x2a601c['host'],'port':Number(_0x2a601c[_0x4d54f5(0x1b4)]),'secure':![],'auth':{'user':_0x2a601c[_0x4d54f5(0x18f)],'pass':_0x2a601c[_0x4d54f5(0x1ff)]}}),_0x41e7b8={'from':_0x2a601c['email'],'to':_0x3b1dea[0x0][_0x4d54f5(0x1f8)],'subject':_0x4d54f5(0x21d),'attachments':[{'filename':_0x4d54f5(0x19d),'path':__dirname+_0x4d54f5(0x1f0)+'/upload/'+_0x5d340c[0x0][_0x4d54f5(0x1d9)],'cid':_0x4d54f5(0x204)}],'html':_0x4d54f5(0x197)+_0x4d54f5(0x233)+'</head><body>'+'<div>'+_0x4d54f5(0x1af)+_0x4d54f5(0x1f9)+_0x4d54f5(0x188)+'</div>'+_0x4d54f5(0x1f9)+'<h2>\x20'+_0x5d340c[0x0][_0x4d54f5(0x202)]+_0x4d54f5(0x182)+'</div>'+_0x4d54f5(0x22e)+_0x4d54f5(0x1c7)+_0x4d54f5(0x1f9)+_0x4d54f5(0x191)+'\x20Order\x20Number\x20:\x20'+_0x501fb8['invoice']+'\x20'+_0x4d54f5(0x192)+_0x4d54f5(0x20a)+_0x501fb8[_0x4d54f5(0x1f2)]+'\x20'+'</span>'+_0x4d54f5(0x1aa)+_0x4d54f5(0x22e)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4d54f5(0x226)+_0x4d54f5(0x186)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x4d54f5(0x1a7)+_0x4d54f5(0x213)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x4d54f5(0x184)+_0x4d54f5(0x240)+_0x4d54f5(0x212)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x4d54f5(0x20e)+'</thead>'+_0x4d54f5(0x239)+'\x20'+_0x3e9c39+'\x20'+_0x4d54f5(0x1ee)+_0x4d54f5(0x1fc)+_0x4d54f5(0x1f9)+_0x4d54f5(0x222)+'<h5>'+_0x5d340c[0x0][_0x4d54f5(0x202)]+_0x4d54f5(0x1aa)+_0x4d54f5(0x22e)+_0x4d54f5(0x22e)+_0x4d54f5(0x1e4)};_0x3245b4[_0x4d54f5(0x1a2)](_0x41e7b8,function(_0x2544b2,_0x5b2455){var _0x4ee282=_0x4d54f5;_0x2544b2?(console['log'](_0x2544b2),console[_0x4ee282(0x21a)](_0x4ee282(0x1db))):console[_0x4ee282(0x21a)]('Email\x20sent\x20successfully');}),_0x191b32['flash'](_0x4d54f5(0x1ec),'adjustment\x20Finalized\x20successfully'),_0x1774fe[_0x4d54f5(0x1f4)](_0x4d54f5(0x179)+_0x5a00ef['_id']);}catch(_0x210cbc){console[_0x4d54f5(0x1b2)](_0x210cbc),_0x1774fe[_0x4d54f5(0x1da)](0x1f4)['json']({'error':_0x4d54f5(0x1bc)});}})[_0x2a3182(0x196)](_0xe9efde=>{var _0x4f151d=_0x2a3182;console['error'](_0xe9efde),_0x1774fe['status'](0x1f4)[_0x4f151d(0x1eb)]({'error':'An\x20error\x20occurred.'});});}catch(_0x1c850f){console['log'](_0x1c850f),_0x1774fe[_0x2a3182(0x1da)](0xc8)[_0x2a3182(0x1eb)]({'message':_0x1c850f[_0x2a3182(0x22c)]});}}),router[a0_0x48e799(0x194)](a0_0x48e799(0x1d0),auth,async(_0x1f3807,_0x9a91b5)=>{var _0x5c5d10=a0_0x48e799;try{const {username:_0x4cdc52,email:_0x292579,role:_0x1f0331}=_0x1f3807[_0x5c5d10(0x246)],_0x1b4b9a=_0x1f3807[_0x5c5d10(0x246)],_0x1365a7=await profile[_0x5c5d10(0x174)]({'email':_0x1b4b9a[_0x5c5d10(0x18f)]}),_0x5baff6=await master_shop['find'](),_0x259884=_0x1f3807[_0x5c5d10(0x1d5)]['id'],_0x58847e=await adjustment[_0x5c5d10(0x20b)]({'_id':_0x259884}),_0x3c2346=await purchases[_0x5c5d10(0x1a6)]([{'$match':{'warehouse_name':_0x58847e[_0x5c5d10(0x215)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5c5d10(0x1f5)}}]),_0x5940fb=await product[_0x5c5d10(0x22a)]({}),_0x4a50d9=await warehouse['aggregate']([{'$match':{'name':_0x58847e['warehouse_name']}},{'$unwind':_0x5c5d10(0x1ab)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5c5d10(0x1bd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5c5d10(0x17d)},'bin':{'$first':_0x5c5d10(0x1f1)},'type':{'$first':_0x5c5d10(0x1bb)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x5c5d10(0x209)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5c5d10(0x248)},'storage':{'$first':_0x5c5d10(0x178)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x5c5d10(0x1d3)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);let _0x1b59c9;if(_0x1b4b9a[_0x5c5d10(0x20f)]==_0x5c5d10(0x241)){const _0x4f4db9=await staff[_0x5c5d10(0x174)]({'email':_0x1b4b9a[_0x5c5d10(0x18f)]});_0x1b59c9=await warehouse[_0x5c5d10(0x1a6)]([{'$match':{'status':'Enabled','name':_0x4f4db9[_0x5c5d10(0x176)],'warehouse_category':_0x5c5d10(0x230),'name':{'$ne':_0x5c5d10(0x223)}}},{'$group':{'_id':_0x5c5d10(0x1b6),'name':{'$first':_0x5c5d10(0x1b6)}}}]);}else _0x1b59c9=await warehouse['aggregate']([{'$match':{'status':_0x5c5d10(0x190),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x5c5d10(0x223)}}},{'$group':{'_id':_0x5c5d10(0x1b6),'name':{'$first':_0x5c5d10(0x1b6)}}}]);if(_0x5baff6[0x0][_0x5c5d10(0x23d)]==_0x5c5d10(0x203)){var _0x40e131=users[_0x5c5d10(0x1c6)];console['log'](_0x40e131);}else{if(_0x5baff6[0x0]['language']==_0x5c5d10(0x1d8))var _0x40e131=users[_0x5c5d10(0x1d8)];else{if(_0x5baff6[0x0][_0x5c5d10(0x23d)]=='German')var _0x40e131=users[_0x5c5d10(0x221)];else{if(_0x5baff6[0x0][_0x5c5d10(0x23d)]=='Spanish')var _0x40e131=users[_0x5c5d10(0x1fd)];else{if(_0x5baff6[0x0][_0x5c5d10(0x23d)]==_0x5c5d10(0x195))var _0x40e131=users['French'];else{if(_0x5baff6[0x0]['language']==_0x5c5d10(0x1dd))var _0x40e131=users[_0x5c5d10(0x234)];else{if(_0x5baff6[0x0][_0x5c5d10(0x23d)]==_0x5c5d10(0x232))var _0x40e131=users[_0x5c5d10(0x232)];else{if(_0x5baff6[0x0][_0x5c5d10(0x23d)]==_0x5c5d10(0x1a5))var _0x40e131=users[_0x5c5d10(0x1d7)];}}}}}}}_0x9a91b5['render'](_0x5c5d10(0x1ca),{'success':_0x1f3807[_0x5c5d10(0x1cd)](_0x5c5d10(0x1ec)),'errors':_0x1f3807['flash'](_0x5c5d10(0x187)),'role':_0x1b4b9a,'profile':_0x1365a7,'adjustment':_0x58847e,'stock':_0x4a50d9,'master_shop':_0x5baff6,'warehouse_name':_0x3c2346,'unit':_0x5940fb,'language':_0x40e131,'warehouse':_0x1b59c9});}catch(_0x560797){console[_0x5c5d10(0x21a)](_0x560797),_0x9a91b5[_0x5c5d10(0x1da)](0xc8)['json']({'message':_0x560797['message']});}}),router[a0_0x48e799(0x23c)](a0_0x48e799(0x1d0),auth,async(_0x2f4651,_0x151a12)=>{var _0x13a681=a0_0x48e799;try{const _0x412ea5=_0x2f4651[_0x13a681(0x1d5)]['id'],_0x58599a=await adjustment[_0x13a681(0x20b)]({'_id':_0x412ea5}),_0x383a35=await warehouse[_0x13a681(0x174)]({'name':_0x58599a[_0x13a681(0x215)],'room':_0x58599a[_0x13a681(0x18c)]}),{warehouse_name:_0x5afc71,date:_0x418378,prod_name:_0x486e1c,level:_0x49011c,isle:_0x46f8c5,pallet:_0x56fb39,stock:_0x2f5a60,types:_0x4738aa,adjust_qty:_0xc200b5,new_adjust_qty:_0x21e373,note:_0xd969c5,Room_name:_0x50ab36,invoice:_0x264239,JO_number:_0x4c0dd3,expiry_date:_0x2275a6}=_0x2f4651['body'];if(typeof _0x486e1c==_0x13a681(0x1cf))var _0x1c3618=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x21b)]],_0x1a1c6a=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1d1)]],_0xcbedfd=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1f7)]],_0x40c10d=[_0x2f4651['body']['types']],_0x2e257e=[_0x2f4651['body'][_0x13a681(0x1a0)]],_0x1eb323=[_0x2f4651['body'][_0x13a681(0x19c)]],_0x2b444d=[_0x2f4651[_0x13a681(0x20d)]['Primary_Units']],_0x562318=[_0x2f4651['body'][_0x13a681(0x208)]],_0x10cfd0=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x22d)]],_0xc018af=[_0x2f4651['body']['batch_code']],_0x10e57a=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x17a)]],_0xe92345=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1cb)]],_0x566b9e=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1a9)]],_0x5a4451=[_0x2f4651[_0x13a681(0x20d)]['prod_cat']],_0x3e5b8e=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x242)]],_0x33d2a4=[_0x2f4651[_0x13a681(0x20d)][_0x13a681(0x237)]],_0x2c721f=[_0x2f4651[_0x13a681(0x20d)]['second1']];else var _0x1c3618=[..._0x2f4651['body']['prod_name']],_0x1a1c6a=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1d1)]],_0xcbedfd=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1f7)]],_0x40c10d=[..._0x2f4651['body'][_0x13a681(0x201)]],_0x2e257e=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1a0)]],_0x1eb323=[..._0x2f4651[_0x13a681(0x20d)]['New_Qty_Converted']],_0x2b444d=[..._0x2f4651[_0x13a681(0x20d)]['unit']],_0x562318=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x208)]],_0x10cfd0=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x22d)]],_0xc018af=[..._0x2f4651['body'][_0x13a681(0x22f)]],_0x10e57a=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x17a)]],_0xe92345=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1cb)]],_0x566b9e=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1a9)]],_0x5a4451=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x216)]],_0x3e5b8e=[..._0x2f4651['body']['Rooms']],_0x33d2a4=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x237)]],_0x2c721f=[..._0x2f4651[_0x13a681(0x20d)][_0x13a681(0x1b9)]];const _0x1d9ae4=_0x1c3618[_0x13a681(0x198)](_0x33550b=>{return _0x33550b={'product_name':_0x33550b};});_0x1a1c6a[_0x13a681(0x1a3)]((_0x59d9a1,_0x26a479)=>{var _0x1a739b=_0x13a681;_0x3e5b8e[_0x1a739b(0x1a3)]((_0x50d52c,_0x2b6b68)=>{var _0x535abc=_0x1a739b;if(_0x50d52c==_0x535abc(0x249)&&_0x26a479==_0x2b6b68){var _0x15ef1f=_0x59d9a1[_0x535abc(0x1b0)](0x3);_0x1d9ae4[_0x26a479][_0x535abc(0x1dc)]=_0x59d9a1[0x0],_0x1d9ae4[_0x26a479][_0x535abc(0x23e)]=_0x59d9a1[0x1],_0x1d9ae4[_0x26a479][_0x535abc(0x1ea)]=0x0,_0x1d9ae4[_0x26a479][_0x535abc(0x1ad)]=0x0,_0x1d9ae4[_0x26a479]['type']=_0x535abc(0x18d),_0x1d9ae4[_0x26a479][_0x535abc(0x17b)]=_0x15ef1f;}else{if(_0x50d52c==_0x535abc(0x1a1)&&_0x26a479==_0x2b6b68){var _0x15ef1f=_0x59d9a1['slice'](0x3);_0x1d9ae4[_0x26a479][_0x535abc(0x1dc)]=_0x59d9a1[0x0],_0x1d9ae4[_0x26a479][_0x535abc(0x23e)]=_0x59d9a1[0x1],_0x1d9ae4[_0x26a479][_0x535abc(0x1ea)]=0x0,_0x1d9ae4[_0x26a479][_0x535abc(0x1ad)]=0x0,_0x1d9ae4[_0x26a479]['type']=_0x535abc(0x18d),_0x1d9ae4[_0x26a479][_0x535abc(0x17b)]=_0x59d9a1[0x5];}else{if(_0x26a479==_0x2b6b68){var _0x13085b;if(_0x59d9a1[0x4]=='L')_0x13085b=_0x535abc(0x1b3);else _0x59d9a1[0x4]=='F'&&(_0x13085b=_0x535abc(0x18d));_0x1d9ae4[_0x26a479][_0x535abc(0x1dc)]=_0x59d9a1[0x0],_0x1d9ae4[_0x26a479][_0x535abc(0x23e)]=_0x59d9a1[0x1],_0x1d9ae4[_0x26a479][_0x535abc(0x1ea)]=_0x59d9a1[0x2],_0x1d9ae4[_0x26a479][_0x535abc(0x1ad)]=_0x59d9a1[0x3],_0x1d9ae4[_0x26a479][_0x535abc(0x1f3)]=_0x13085b,_0x1d9ae4[_0x26a479][_0x535abc(0x17b)]=_0x59d9a1[0x5];}}}});}),_0xcbedfd['forEach']((_0x3e017e,_0x189d31)=>{var _0x59b1c3=_0x13a681;_0x1d9ae4[_0x189d31][_0x59b1c3(0x23a)]=_0x3e017e;}),_0x40c10d[_0x13a681(0x1a3)]((_0x5b486b,_0x372fcb)=>{_0x1d9ae4[_0x372fcb]['types']=_0x5b486b;}),_0x2e257e[_0x13a681(0x1a3)]((_0x413c6c,_0x267067)=>{var _0xd08b2b=_0x13a681;_0x1d9ae4[_0x267067][_0xd08b2b(0x20c)]=_0x413c6c;}),_0x1eb323['forEach']((_0x3e4491,_0x12c5aa)=>{var _0x81b8a4=_0x13a681;_0x1d9ae4[_0x12c5aa][_0x81b8a4(0x1d4)]=_0x3e4491;}),_0x2b444d[_0x13a681(0x1a3)]((_0x515f4c,_0x31f246)=>{var _0x382af8=_0x13a681;_0x1d9ae4[_0x31f246][_0x382af8(0x185)]=_0x515f4c;}),_0x562318[_0x13a681(0x1a3)]((_0x429f46,_0x292b06)=>{var _0x4921e7=_0x13a681;_0x1d9ae4[_0x292b06][_0x4921e7(0x1a4)]=_0x429f46;}),_0x10cfd0['forEach']((_0x526c7f,_0x397bc5)=>{var _0x225a0b=_0x13a681;_0x1d9ae4[_0x397bc5][_0x225a0b(0x1e7)]=_0x526c7f;}),_0xc018af[_0x13a681(0x1a3)]((_0x53fd6a,_0x47ecc8)=>{_0x1d9ae4[_0x47ecc8]['batch_code']=_0x53fd6a;}),_0x10e57a[_0x13a681(0x1a3)]((_0x49da3d,_0x37ded3)=>{_0x1d9ae4[_0x37ded3]['expiry_date']=_0x49da3d;}),_0xe92345['forEach']((_0x2f4efe,_0x2ce004)=>{var _0x378845=_0x13a681;_0x1d9ae4[_0x2ce004][_0x378845(0x1c9)]=_0x2f4efe;}),_0x566b9e[_0x13a681(0x1a3)]((_0x26c115,_0x5cf53)=>{var _0x2180f7=_0x13a681;_0x1d9ae4[_0x5cf53][_0x2180f7(0x1a9)]=_0x26c115;}),_0x5a4451[_0x13a681(0x1a3)]((_0x573670,_0x13eefd)=>{_0x1d9ae4[_0x13eefd]['prod_cat']=_0x573670;}),_0x3e5b8e[_0x13a681(0x1a3)]((_0x40a62e,_0x34cf28)=>{var _0x3b64c1=_0x13a681;_0x1d9ae4[_0x34cf28][_0x3b64c1(0x210)]=_0x40a62e;}),_0x33d2a4[_0x13a681(0x1a3)]((_0x5077b2,_0x4eb9b3)=>{var _0x1c635a=_0x13a681;_0x1d9ae4[_0x4eb9b3][_0x1c635a(0x238)]=_0x5077b2;}),_0x2c721f[_0x13a681(0x1a3)]((_0x13ec96,_0x2e821e)=>{var _0x9ad9e=_0x13a681;_0x1d9ae4[_0x2e821e][_0x9ad9e(0x214)]=_0x13ec96;});const _0x6556c=_0x1d9ae4[_0x13a681(0x245)](_0x34c520=>_0x34c520['adjust_qty']!=='0'&&_0x34c520['adjust_qty']!=='');var _0x1f15cd=0x0;_0x6556c[_0x13a681(0x1a3)](_0x445707=>{var _0x22ec4b=_0x13a681;console['log'](_0x22ec4b(0x1ba),_0x445707),parseInt(_0x445707[_0x22ec4b(0x20c)])<=0x0&&_0x1f15cd++;});if(_0x1f15cd!=0x0)return _0x2f4651[_0x13a681(0x1cd)](_0x13a681(0x187),_0x13a681(0x19e)),_0x151a12[_0x13a681(0x1f4)](_0x13a681(0x218));_0x58599a[_0x13a681(0x215)]=_0x5afc71,_0x58599a[_0x13a681(0x1f2)]=_0x418378,_0x58599a['product']=_0x6556c,_0x58599a[_0x13a681(0x17e)]=_0xd969c5,_0x58599a[_0x13a681(0x19f)]=_0x264239,_0x58599a['isAllowEdit']=_0x13a681(0x243);const _0x49bdd8=await _0x58599a[_0x13a681(0x18b)]();_0x2f4651['flash'](_0x13a681(0x1ec),_0x13a681(0x1b5)),_0x151a12[_0x13a681(0x1f4)](_0x13a681(0x19b));}catch(_0x10cb68){console[_0x13a681(0x21a)](_0x10cb68);}}),router[a0_0x48e799(0x23c)](a0_0x48e799(0x236),async(_0x57b1d6,_0x35a0f3)=>{var _0x15e560=a0_0x48e799;const {primary_code:_0x42a49d,warehouse_data:_0x344da2,rooms_data:_0x31e8fc,Roomslist:_0x56b359}=_0x57b1d6['body'],_0x12139c=_0x56b359[_0x15e560(0x18a)](','),_0x376b5f=[];async function _0x440b72(_0x15a38d){var _0x1b04a5=_0x15e560;const _0x2971c4=await warehouse[_0x1b04a5(0x1a6)]([{'$match':{'name':_0x344da2,'room':_0x15a38d}},{'$unwind':_0x1b04a5(0x1ab)},{'$match':{'product_details.primary_code':_0x42a49d}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1b04a5(0x211)},'primary_code':{'$first':_0x1b04a5(0x209)},'secondary_code':{'$first':_0x1b04a5(0x228)},'product_code':{'$first':_0x1b04a5(0x248)},'level':{'$first':_0x1b04a5(0x17d)},'isle':{'$first':_0x1b04a5(0x1f1)},'type':{'$first':_0x1b04a5(0x1bb)},'pallet':{'$first':_0x1b04a5(0x183)},'unit':{'$first':_0x1b04a5(0x1c1)},'secondary_unit':{'$first':_0x1b04a5(0x224)},'storage':{'$first':_0x1b04a5(0x178)},'rack':{'$first':_0x1b04a5(0x17f)},'expiry_date':{'$first':_0x1b04a5(0x1d3)},'production_date':{'$first':_0x1b04a5(0x1c5)},'maxPerUnit':{'$first':_0x1b04a5(0x1be)},'batch_code':{'$first':_0x1b04a5(0x1c0)},'product_cat':{'$first':_0x1b04a5(0x207)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x1b04a5(0x1ae)},'invoice':{'$first':_0x1b04a5(0x21c)}}}]),_0x4894a0=await warehouse[_0x1b04a5(0x1a6)]([{'$match':{'name':_0x344da2,'room':_0x15a38d}},{'$unwind':_0x1b04a5(0x1ab)},{'$match':{'product_details.secondary_code':_0x42a49d}},{'$group':{'_id':_0x1b04a5(0x1e1),'name':{'$first':_0x1b04a5(0x1bd)},'product_stock':{'$first':_0x1b04a5(0x211)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1b04a5(0x228)},'product_code':{'$first':_0x1b04a5(0x248)},'level':{'$first':_0x1b04a5(0x17d)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x1b04a5(0x1bb)},'pallet':{'$first':_0x1b04a5(0x183)},'unit':{'$first':_0x1b04a5(0x1c1)},'secondary_unit':{'$first':_0x1b04a5(0x224)},'storage':{'$first':_0x1b04a5(0x178)},'rack':{'$first':_0x1b04a5(0x17f)},'expiry_date':{'$first':_0x1b04a5(0x1d3)},'production_date':{'$first':_0x1b04a5(0x1c5)},'maxPerUnit':{'$first':_0x1b04a5(0x1be)},'batch_code':{'$first':_0x1b04a5(0x1c0)},'product_cat':{'$first':_0x1b04a5(0x207)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x1b04a5(0x1ae)}}}]);if(_0x2971c4[_0x1b04a5(0x19a)]>0x0)_0x376b5f['push'](_0x2971c4);else _0x4894a0[_0x1b04a5(0x19a)]>0x0&&_0x376b5f[_0x1b04a5(0x220)](_0x4894a0);}const _0x5a4a81=_0x12139c['map'](_0x234982=>_0x440b72(_0x234982));await Promise[_0x15e560(0x1d6)](_0x5a4a81),_0x35a0f3[_0x15e560(0x1eb)](_0x376b5f);}),router['post']('/CheckingWarehouse',async(_0x20a2dd,_0x368eb0)=>{var _0x42e379=a0_0x48e799;const {primaryCode:_0x1a44f3,secondaryCode:_0x41fd3b,productCode:_0x95dca7,level:_0x448c9c,isle:_0x22b2d8,pallet:_0x345a76,warehouses:_0x537d27,room:_0x778bc8}=_0x20a2dd[_0x42e379(0x20d)];try{const _0x2fd7e0=await warehouse[_0x42e379(0x1a6)]([{'$match':{'name':_0x537d27,'room':_0x778bc8}},{'$unwind':_0x42e379(0x1ab)},{'$match':{'product_details.level':parseInt(_0x448c9c),'product_details.isle':_0x22b2d8,'product_details.pallet':parseInt(_0x345a76)}},{'$group':{'_id':_0x42e379(0x1e1),'name':{'$first':_0x42e379(0x1bd)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x42e379(0x180)},'isle':{'$first':_0x42e379(0x23f)},'pallet':{'$first':_0x42e379(0x1ed)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x368eb0[_0x42e379(0x1da)](0xc8)[_0x42e379(0x1eb)](_0x2fd7e0);}catch(_0x1b5519){_0x368eb0[_0x42e379(0x1da)](0x194)[_0x42e379(0x1eb)]({'message':_0x1b5519['message']});}}),module['exports']=router;