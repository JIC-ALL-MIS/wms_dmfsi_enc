var a0_0x167066=a0_0x49b1;(function(_0x55f55a,_0x5a8548){var _0x537eb5=a0_0x49b1,_0x5aae2f=_0x55f55a();while(!![]){try{var _0x181852=parseInt(_0x537eb5(0x232))/0x1*(-parseInt(_0x537eb5(0x19f))/0x2)+parseInt(_0x537eb5(0x18c))/0x3*(-parseInt(_0x537eb5(0x1b3))/0x4)+-parseInt(_0x537eb5(0x1c3))/0x5+parseInt(_0x537eb5(0x240))/0x6*(-parseInt(_0x537eb5(0x1dd))/0x7)+-parseInt(_0x537eb5(0x1d6))/0x8+parseInt(_0x537eb5(0x1f6))/0x9+parseInt(_0x537eb5(0x1c2))/0xa*(parseInt(_0x537eb5(0x215))/0xb);if(_0x181852===_0x5a8548)break;else _0x5aae2f['push'](_0x5aae2f['shift']());}catch(_0x4d599a){_0x5aae2f['push'](_0x5aae2f['shift']());}}}(a0_0x4959,0x27216));const express=require('express'),app=express(),router=express['Router'](),auth=require(a0_0x167066(0x1a8)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x167066(0x20a)),users=require(a0_0x167066(0x1fa)),nodemailer=require(a0_0x167066(0x192));router[a0_0x167066(0x1c4)]('/view',auth,async(_0x40ca49,_0x22b6e9)=>{var _0x155468=a0_0x167066;try{const {username:_0x3d84d9,email:_0x42f47c,role:_0x42b469}=_0x40ca49[_0x155468(0x21e)],_0x439ef5=_0x40ca49[_0x155468(0x21e)],_0x4e18d6=await profile[_0x155468(0x1d7)]({'email':_0x439ef5[_0x155468(0x18d)]}),_0x21aa7e=await master_shop['find']();console[_0x155468(0x1b9)](_0x155468(0x20d),_0x21aa7e);let _0x5f5081;if(_0x439ef5['role']==_0x155468(0x225)){const _0x3b32be=await staff[_0x155468(0x1d7)]({'email':_0x439ef5['email']});_0x5f5081=await warehouse[_0x155468(0x1dc)]({'status':'Enabled','name':_0x3b32be[_0x155468(0x1cf)]});}else _0x5f5081=await warehouse['find']({'status':_0x155468(0x1bd)});const _0x2bb97a=await product[_0x155468(0x1dc)]();let _0x878157;if(_0x439ef5[_0x155468(0x1ba)]==_0x155468(0x225)){const _0x54f42d=await staff['findOne']({'email':_0x439ef5[_0x155468(0x18d)]});_0x878157=await adjustment[_0x155468(0x1dc)]({'warehouse_name':_0x54f42d[_0x155468(0x1cf)]});}else _0x878157=await adjustment[_0x155468(0x1e2)]([{'$unwind':_0x155468(0x23c)},{'$group':{'_id':_0x155468(0x18f),'invoice':{'$first':_0x155468(0x21d)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x155468(0x247)},'room':{'$addToSet':_0x155468(0x235)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x155468(0x200)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x21aa7e[0x0]['language']==_0x155468(0x22c)){var _0x51e4e7=users[_0x155468(0x24d)];console[_0x155468(0x1b9)](_0x51e4e7);}else{if(_0x21aa7e[0x0]['language']==_0x155468(0x1cd))var _0x51e4e7=users[_0x155468(0x1cd)];else{if(_0x21aa7e[0x0][_0x155468(0x182)]==_0x155468(0x1ad))var _0x51e4e7=users[_0x155468(0x1ad)];else{if(_0x21aa7e[0x0][_0x155468(0x182)]==_0x155468(0x22e))var _0x51e4e7=users[_0x155468(0x22e)];else{if(_0x21aa7e[0x0]['language']==_0x155468(0x24c))var _0x51e4e7=users[_0x155468(0x24c)];else{if(_0x21aa7e[0x0][_0x155468(0x182)]==_0x155468(0x1a5))var _0x51e4e7=users[_0x155468(0x1be)];else{if(_0x21aa7e[0x0][_0x155468(0x182)]==_0x155468(0x243))var _0x51e4e7=users['Chinese'];else{if(_0x21aa7e[0x0]['language']==_0x155468(0x20e))var _0x51e4e7=users['Arabic'];}}}}}}}_0x22b6e9[_0x155468(0x220)](_0x155468(0x18a),{'success':_0x40ca49['flash'](_0x155468(0x252)),'errors':_0x40ca49['flash'](_0x155468(0x23f)),'role':_0x439ef5,'profile':_0x4e18d6,'warehouse':_0x5f5081,'product':_0x2bb97a,'adjustment':_0x878157,'master_shop':_0x21aa7e,'language':_0x51e4e7});}catch(_0x124d02){console[_0x155468(0x1b9)](_0x124d02);}});async function getRandom8DigitNumber(){var _0x51ba20=a0_0x167066;const _0x3d78cf=0x989680,_0x4f33ed=0x5f5e0ff,_0x560bd1=Math[_0x51ba20(0x24a)](Math[_0x51ba20(0x20f)]()*(_0x4f33ed-_0x3d78cf+0x1))+_0x3d78cf;var _0x234760;const _0x2cd1d3=await adjustment[_0x51ba20(0x1d7)]({'invoice':'ADJ-'+_0x560bd1});return _0x2cd1d3&&_0x2cd1d3[_0x51ba20(0x259)]>0x0?_0x234760='ADJ-'+_0x560bd1:_0x234760=_0x51ba20(0x1b4)+_0x560bd1,_0x234760;}function a0_0x4959(){var _0x49de31=['/view/:id','$product_details.bin','248910UWHAdT','536730UQnjOB','get','product_details','save','Receiving\x20Area','room','string','second1','Adjustment\x20Mail','sendMail','Hindi','$product_details.bay','warehouse','minus','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.product_cat','</head><body>','toString','body','2514872ECCkha','findOne','invoice','adjustment\x20add\x20successfull','expiry_date','\x20Order\x20Number\x20:\x20','find','66073RFqhoO','/adjustment/preview/','message','$product_details.maxProducts','secondary_unit','aggregate','room_names','$name','/preview/:id','</td>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.maxPerUnit','$product_details','$product_details.product_name','$product_details.secondary_unit','Error\x20Occurs','/CheckingWarehouse','Rooms','date','product_name','$product_details.level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.primary_code','New_Qty_Converted_adj','production_date','1151514HhfrUF','warehouse_name','note','</div>','../public/language/languages.json','createTransport','storage','edit_adjustment','Logo.png','Return\x20Rooms','$isAllowEdit','prime1','$product_details.type','$product_details.batch_code','batch_code','Primary_Units','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<h2>\x20','prod_cat','$product_details._id','../models/all_models','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','back','master','Arabic\x20(ae)','random','Secondary_units','$product_details.storage','<tbody\x20style=\x22text-align:\x20center;\x22>','</tr>','<tr>','319MsLnLv','True','params','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.unit','<!DOCTYPE\x20html>','Return\x20Goods','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$invoice','user','split','render','$product_details.rack','Ambient','$room','$product_details.secondary_code','staff','$product_details.product_stock','then','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.isle','product','English\x20(US)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Spanish','</thead>','adjustment\x20Finalized\x20successfully','primary_code','1WpkSkp','Level','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product.room_names','bay','\x20Order\x20Date\x20:\x20','<div>','</table>','<strong>\x20Regards\x20</strong>','floorlevel','$product','\x20<>\x20','status','errors','120yDBhyr','map','level','Chinese','logo','post','</body></html>','$warehouse_name','</h5>','findById','floor','edit_adjustment_view','French','English','/../public','product_code','filter','foreach\x20newproduct','success','new_adjust_qty','/picking_list/PDF_adjustment_rm/','catch','forEach','$product_details.expiry_date','Floor','length','maxperunit','language','flash','New_Qty_Converted','<html><head><title></title>','<span\x20style=\x22float:\x20right;\x22>','redirect','rack','slice','adjustment','Raw\x20Materials','146733uEzWPp','email','\x20</h2>','$_id','max_per_unit','maxPerUnit','nodemailer','push','json','prod_invoice','padStart','Enclosed','Arabic','site_title','prod_name','_id','stock','secondary_code','unit','60222vnzzSO','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/adjustment/view','type','types','adjust_qty','Portuguese\x20(BR)','product_stock','Shelves','../middleware/auth','stockBefore','$product_details.production_date','$product_details.product_code','adjustment\x20data\x20update\x20successfully','German','all','prod_code','<h5\x20style=\x22text-align:\x20left;\x22>','error','$product.product_name','4NfmVHQ','ADJ-','add_adjustment','</tbody>','exports','/view/add_adjustment','log','role','finalize','$product_details.floorlevel','Enabled','Portuguese','bin'];a0_0x4959=function(){return _0x49de31;};return a0_0x4959();}function a0_0x49b1(_0x1fcee1,_0x43002a){var _0x4959df=a0_0x4959();return a0_0x49b1=function(_0x49b1bc,_0x2de0d6){_0x49b1bc=_0x49b1bc-0x181;var _0x2a4ef0=_0x4959df[_0x49b1bc];return _0x2a4ef0;},a0_0x49b1(_0x1fcee1,_0x43002a);}router[a0_0x167066(0x1c4)]('/view/add_adjustment',auth,async(_0x507d47,_0x334c0d)=>{var _0x2e3b32=a0_0x167066;try{const {username:_0x481a1d,email:_0x144574,role:_0xc4ff07}=_0x507d47['user'],_0x2e916a=_0x507d47[_0x2e3b32(0x21e)],_0x5777aa=await profile['findOne']({'email':_0x2e916a[_0x2e3b32(0x18d)]}),_0x37c803=await master_shop['find']();let _0x4ebf30;if(_0x2e916a[_0x2e3b32(0x1ba)]==_0x2e3b32(0x225)){const _0x10b6f9=await staff[_0x2e3b32(0x1d7)]({'email':_0x2e916a[_0x2e3b32(0x18d)]});_0x4ebf30=await warehouse['aggregate']([{'$match':{'status':_0x2e3b32(0x1bd),'name':_0x10b6f9[_0x2e3b32(0x1cf)],'warehouse_category':_0x2e3b32(0x18b),'name':{'$ne':_0x2e3b32(0x21b)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x4ebf30=await warehouse['aggregate']([{'$match':{'status':_0x2e3b32(0x1bd),'warehouse_category':_0x2e3b32(0x18b),'name':{'$ne':_0x2e3b32(0x21b)}}},{'$group':{'_id':_0x2e3b32(0x1e4),'name':{'$first':_0x2e3b32(0x1e4)}}}]);const _0x25ac0a=await product[_0x2e3b32(0x1dc)]({}),_0x37aab6=await adjustment[_0x2e3b32(0x1dc)]({}),_0x51dec8=_0x37aab6['length']+0x1,_0x2b12b7=_0x2e3b32(0x1b4)+_0x51dec8[_0x2e3b32(0x1d4)]()[_0x2e3b32(0x196)](0x5,'0');var _0xb9d408=[_0x2e3b32(0x222),_0x2e3b32(0x197),_0x2e3b32(0x1ff)];if(_0x37c803[0x0][_0x2e3b32(0x182)]==_0x2e3b32(0x22c))var _0x3bc65f=users['English'];else{if(_0x37c803[0x0][_0x2e3b32(0x182)]=='Hindi')var _0x3bc65f=users[_0x2e3b32(0x1cd)];else{if(_0x37c803[0x0][_0x2e3b32(0x182)]==_0x2e3b32(0x1ad))var _0x3bc65f=users[_0x2e3b32(0x1ad)];else{if(_0x37c803[0x0]['language']=='Spanish')var _0x3bc65f=users[_0x2e3b32(0x22e)];else{if(_0x37c803[0x0][_0x2e3b32(0x182)]=='French')var _0x3bc65f=users[_0x2e3b32(0x24c)];else{if(_0x37c803[0x0][_0x2e3b32(0x182)]==_0x2e3b32(0x1a5))var _0x3bc65f=users[_0x2e3b32(0x1be)];else{if(_0x37c803[0x0]['language']==_0x2e3b32(0x243))var _0x3bc65f=users[_0x2e3b32(0x243)];else{if(_0x37c803[0x0][_0x2e3b32(0x182)]==_0x2e3b32(0x20e))var _0x3bc65f=users[_0x2e3b32(0x198)];}}}}}}}const _0x5b321d=getRandom8DigitNumber();_0x5b321d[_0x2e3b32(0x227)](_0x16bd12=>{var _0x41cc1f=_0x2e3b32;_0x334c0d[_0x41cc1f(0x220)](_0x41cc1f(0x1b5),{'success':_0x507d47[_0x41cc1f(0x183)](_0x41cc1f(0x252)),'errors':_0x507d47[_0x41cc1f(0x183)](_0x41cc1f(0x23f)),'role':_0x2e916a,'profile':_0x5777aa,'warehouse':_0x4ebf30,'product':_0x25ac0a,'master_shop':_0x37c803,'language':_0x3bc65f,'rooms_data':_0xb9d408,'invoice_no':_0x16bd12});})[_0x2e3b32(0x255)](_0x4b23be=>{var _0xe215c0=_0x2e3b32;_0x507d47[_0xe215c0(0x183)](_0xe215c0(0x23f),_0xe215c0(0x21c)),_0x334c0d[_0xe215c0(0x187)](_0xe215c0(0x1a1));});}catch(_0x1adb52){console[_0x2e3b32(0x1b9)](_0x1adb52);}}),router['post'](a0_0x167066(0x1b8),auth,async(_0x221929,_0x49cc63)=>{var _0xcd7715=a0_0x167066;try{const {warehouse_name:_0xbebb3f,date:_0x353fe0,prod_name:_0x564f6d,level:_0x1b98a2,isle:_0x27f67a,pallet:_0x2d766a,stock:_0x52fb41,types:_0x3fc789,adjust_qty:_0x58a627,new_adjust_qty:_0x58dcec,note:_0x14d7ea,Room_name:_0x15074e,invoice:_0x2a2dff,JO_number:_0x20ea2e,expiry_date:_0x24cbec}=_0x221929[_0xcd7715(0x1d5)];if(typeof _0x564f6d==_0xcd7715(0x1c9))var _0x155416=[_0x221929['body'][_0xcd7715(0x19a)]],_0x48b246=[_0x221929[_0xcd7715(0x1d5)]['level']],_0x303e15=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x19c)]],_0x79d10a=[_0x221929['body']['types']],_0x5455e3=[_0x221929['body'][_0xcd7715(0x1f4)]],_0x5d27dc=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x184)]],_0x5d8548=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x205)]],_0x1d388e=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x210)]],_0x362972=[_0x221929[_0xcd7715(0x1d5)]['prod_code']],_0x527ae8=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x204)]],_0x25b7ee=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x1da)]],_0x441675=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x190)]],_0x5bbb81=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x1f5)]],_0x1f93df=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x208)]],_0x2a9faf=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x1ee)]],_0xacc5f6=[_0x221929[_0xcd7715(0x1d5)]['prime1']],_0x2ed2b2=[_0x221929['body'][_0xcd7715(0x1ca)]],_0x37dd2b=[_0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x195)]];else var _0x155416=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x19a)]],_0x48b246=[..._0x221929[_0xcd7715(0x1d5)]['level']],_0x303e15=[..._0x221929[_0xcd7715(0x1d5)]['stock']],_0x79d10a=[..._0x221929[_0xcd7715(0x1d5)]['types']],_0x5455e3=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x1f4)]],_0x5d27dc=[..._0x221929['body']['New_Qty_Converted']],_0x5d8548=[..._0x221929['body'][_0xcd7715(0x19e)]],_0x1d388e=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x210)]],_0x362972=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x1af)]],_0x527ae8=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x204)]],_0x25b7ee=[..._0x221929['body'][_0xcd7715(0x1da)]],_0x441675=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x190)]],_0x5bbb81=[..._0x221929['body'][_0xcd7715(0x1f5)]],_0x1f93df=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x208)]],_0x2a9faf=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x1ee)]],_0xacc5f6=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x201)]],_0x2ed2b2=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x1ca)]],_0x37dd2b=[..._0x221929[_0xcd7715(0x1d5)][_0xcd7715(0x195)]];const _0x232f97=_0x155416[_0xcd7715(0x241)](_0x1aa764=>{return _0x1aa764={'product_name':_0x1aa764};});_0x48b246[_0xcd7715(0x256)]((_0x1f559a,_0x3933e5)=>{var _0x5943e1=_0xcd7715;_0x2a9faf[_0x5943e1(0x256)]((_0x4c201c,_0xa56b1b)=>{var _0x163e9c=_0x5943e1;if(_0x4c201c==_0x163e9c(0x1c7)&&_0x3933e5==_0xa56b1b){var _0x1ba2d3=_0x1f559a[_0x163e9c(0x189)](0x3);_0x232f97[_0x3933e5][_0x163e9c(0x1fc)]=_0x1f559a[0x0],_0x232f97[_0x3933e5][_0x163e9c(0x188)]=_0x1f559a[0x1],_0x232f97[_0x3933e5][_0x163e9c(0x236)]=0x0,_0x232f97[_0x3933e5][_0x163e9c(0x1bf)]=0x0,_0x232f97[_0x3933e5][_0x163e9c(0x1a2)]=_0x163e9c(0x258),_0x232f97[_0x3933e5][_0x163e9c(0x23b)]=_0x1ba2d3;}else{if(_0x4c201c==_0x163e9c(0x1a7)&&_0x3933e5==_0xa56b1b){var _0x1ba2d3=_0x1f559a[_0x163e9c(0x189)](0x3);_0x232f97[_0x3933e5]['storage']=_0x1f559a[0x0],_0x232f97[_0x3933e5][_0x163e9c(0x188)]=_0x1f559a[0x1],_0x232f97[_0x3933e5][_0x163e9c(0x236)]=0x0,_0x232f97[_0x3933e5]['bin']=0x0,_0x232f97[_0x3933e5][_0x163e9c(0x1a2)]=_0x163e9c(0x258),_0x232f97[_0x3933e5][_0x163e9c(0x23b)]=_0x1f559a[0x5];}else{if(_0x3933e5==_0xa56b1b){var _0x54c19c;if(_0x1f559a[0x4]=='L')_0x54c19c='Level';else _0x1f559a[0x4]=='F'&&(_0x54c19c='Floor');_0x232f97[_0x3933e5]['storage']=_0x1f559a[0x0],_0x232f97[_0x3933e5][_0x163e9c(0x188)]=_0x1f559a[0x1],_0x232f97[_0x3933e5][_0x163e9c(0x236)]=_0x1f559a[0x2],_0x232f97[_0x3933e5][_0x163e9c(0x1bf)]=_0x1f559a[0x3],_0x232f97[_0x3933e5][_0x163e9c(0x1a2)]=_0x54c19c,_0x232f97[_0x3933e5][_0x163e9c(0x23b)]=_0x1f559a[0x5];}}}});}),_0x303e15[_0xcd7715(0x256)]((_0x478600,_0x437d55)=>{var _0x9dc640=_0xcd7715;_0x232f97[_0x437d55][_0x9dc640(0x1a9)]=_0x478600;}),_0x79d10a[_0xcd7715(0x256)]((_0x3cf960,_0x10fc03)=>{var _0x5ae5d9=_0xcd7715;_0x232f97[_0x10fc03][_0x5ae5d9(0x1a3)]=_0x3cf960;}),_0x5455e3['forEach']((_0x59ebdf,_0x192d39)=>{_0x232f97[_0x192d39]['adjust_qty']=_0x59ebdf;}),_0x5d27dc[_0xcd7715(0x256)]((_0x393b66,_0x1c4579)=>{var _0x2c317f=_0xcd7715;_0x232f97[_0x1c4579][_0x2c317f(0x253)]=_0x393b66;}),_0x5d8548['forEach']((_0x52cb41,_0x261d1a)=>{_0x232f97[_0x261d1a]['unit']=_0x52cb41;}),_0x1d388e[_0xcd7715(0x256)]((_0x43ab48,_0x3165a8)=>{var _0x41a340=_0xcd7715;_0x232f97[_0x3165a8][_0x41a340(0x1e1)]=_0x43ab48;}),_0x362972[_0xcd7715(0x256)]((_0x31c6ed,_0x42f46d)=>{var _0x5e2c00=_0xcd7715;_0x232f97[_0x42f46d][_0x5e2c00(0x24f)]=_0x31c6ed;}),_0x527ae8[_0xcd7715(0x256)]((_0x53aad8,_0x411a76)=>{_0x232f97[_0x411a76]['batch_code']=_0x53aad8;}),_0x25b7ee[_0xcd7715(0x256)]((_0xcc933b,_0xfcf9d)=>{var _0x18b9a8=_0xcd7715;_0x232f97[_0xfcf9d][_0x18b9a8(0x1da)]=_0xcc933b;}),_0x441675[_0xcd7715(0x256)]((_0xe3688c,_0x750681)=>{var _0x4287d9=_0xcd7715;_0x232f97[_0x750681][_0x4287d9(0x181)]=_0xe3688c;}),_0x5bbb81['forEach']((_0x18e773,_0x172ddb)=>{_0x232f97[_0x172ddb]['production_date']=_0x18e773;}),_0x1f93df[_0xcd7715(0x256)]((_0x2a8373,_0x190af4)=>{var _0x55b5ba=_0xcd7715;_0x232f97[_0x190af4][_0x55b5ba(0x208)]=_0x2a8373;}),_0x2a9faf[_0xcd7715(0x256)]((_0x455bf4,_0x10358b)=>{var _0x24b974=_0xcd7715;_0x232f97[_0x10358b][_0x24b974(0x1e3)]=_0x455bf4;}),_0xacc5f6[_0xcd7715(0x256)]((_0x59befc,_0x2f428c)=>{_0x232f97[_0x2f428c]['primary_code']=_0x59befc;}),_0x2ed2b2[_0xcd7715(0x256)]((_0x1a43a7,_0x4de172)=>{var _0x38ea32=_0xcd7715;_0x232f97[_0x4de172][_0x38ea32(0x19d)]=_0x1a43a7;}),_0x37dd2b['forEach']((_0x551925,_0x545e2e)=>{var _0x1b177d=_0xcd7715;_0x232f97[_0x545e2e][_0x1b177d(0x1d8)]=_0x551925;});const _0x10f279=_0x232f97[_0xcd7715(0x250)](_0x196b90=>_0x196b90['adjust_qty']!=='0'&&_0x196b90[_0xcd7715(0x1a4)]!=='');var _0x552137=0x0;_0x10f279[_0xcd7715(0x256)](_0x3fdf0c=>{var _0x3f509b=_0xcd7715;console[_0x3f509b(0x1b9)](_0x3f509b(0x251),_0x3fdf0c),parseInt(_0x3fdf0c[_0x3f509b(0x1a4)])<=0x0&&_0x552137++;});if(_0x552137!=0x0)return _0x221929['flash'](_0xcd7715(0x23f),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x49cc63[_0xcd7715(0x187)](_0xcd7715(0x20c));const _0x3f0890=new adjustment({'warehouse_name':_0xbebb3f,'date':_0x353fe0,'product':_0x10f279,'note':_0x14d7ea,'room':_0x15074e,'invoice':_0x2a2dff,'JO_number':_0x20ea2e,'expiry_date':_0x24cbec}),_0x5eccf9=await _0x3f0890[_0xcd7715(0x1c6)]();_0x221929[_0xcd7715(0x183)](_0xcd7715(0x252),_0xcd7715(0x1d9)),_0x49cc63['redirect'](_0xcd7715(0x1de)+_0x5eccf9[_0xcd7715(0x19b)]);}catch(_0x4fc6c6){console[_0xcd7715(0x1b9)](_0x4fc6c6),_0x49cc63[_0xcd7715(0x23e)](0xc8)[_0xcd7715(0x194)]({'message':_0x4fc6c6['message']});}}),router['get'](a0_0x167066(0x1e5),auth,async(_0x531ba,_0x17aab4)=>{var _0x26a091=a0_0x167066;try{const {username:_0x59a468,email:_0x444a2b,role:_0x1d4d2a}=_0x531ba[_0x26a091(0x21e)],_0x4462ca=_0x531ba[_0x26a091(0x21e)],_0x275624=await profile[_0x26a091(0x1d7)]({'email':_0x4462ca['email']}),_0x4871a6=await master_shop[_0x26a091(0x1dc)](),_0x24a39f=_0x531ba[_0x26a091(0x217)]['id'],_0x4f6f17=await adjustment[_0x26a091(0x249)]({'_id':_0x24a39f}),_0x23214e=await purchases[_0x26a091(0x1e2)]([{'$match':{'warehouse_name':_0x4f6f17['warehouse_name']}},{'$unwind':_0x26a091(0x23c)},{'$group':{'_id':_0x26a091(0x1b2)}}]),_0x257131=await product[_0x26a091(0x1dc)]({}),_0x4b4914=await warehouse['aggregate']([{'$match':{'name':_0x4f6f17[_0x26a091(0x1f7)]}},{'$unwind':_0x26a091(0x1e9)},{'$group':{'_id':_0x26a091(0x209),'name':{'$first':_0x26a091(0x1ea)},'product_stock':{'$first':_0x26a091(0x226)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x26a091(0x1c1)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x26a091(0x1bc)},'primary_code':{'$first':_0x26a091(0x1f3)},'secondary_code':{'$first':_0x26a091(0x224)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x26a091(0x211)},'rack':{'$first':_0x26a091(0x221)},'maxPerUnit':{'$first':_0x26a091(0x1e8)},'expiry_date':{'$first':_0x26a091(0x257)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x26a091(0x203)},'room':{'$first':_0x26a091(0x223)}}}]);if(_0x4871a6[0x0][_0x26a091(0x182)]==_0x26a091(0x22c)){var _0x2f2160=users['English'];console[_0x26a091(0x1b9)](_0x2f2160);}else{if(_0x4871a6[0x0][_0x26a091(0x182)]==_0x26a091(0x1cd))var _0x2f2160=users[_0x26a091(0x1cd)];else{if(_0x4871a6[0x0][_0x26a091(0x182)]=='German')var _0x2f2160=users['German'];else{if(_0x4871a6[0x0][_0x26a091(0x182)]=='Spanish')var _0x2f2160=users[_0x26a091(0x22e)];else{if(_0x4871a6[0x0]['language']==_0x26a091(0x24c))var _0x2f2160=users[_0x26a091(0x24c)];else{if(_0x4871a6[0x0][_0x26a091(0x182)]==_0x26a091(0x1a5))var _0x2f2160=users[_0x26a091(0x1be)];else{if(_0x4871a6[0x0][_0x26a091(0x182)]==_0x26a091(0x243))var _0x2f2160=users[_0x26a091(0x243)];else{if(_0x4871a6[0x0][_0x26a091(0x182)]==_0x26a091(0x20e))var _0x2f2160=users[_0x26a091(0x198)];}}}}}}}_0x17aab4[_0x26a091(0x220)](_0x26a091(0x24b),{'success':_0x531ba[_0x26a091(0x183)]('success'),'errors':_0x531ba[_0x26a091(0x183)](_0x26a091(0x23f)),'role':_0x4462ca,'profile':_0x275624,'adjustment':_0x4f6f17,'stock':_0x4b4914,'master_shop':_0x4871a6,'warehouse_name':_0x23214e,'unit':_0x257131,'language':_0x2f2160});}catch(_0x842e73){console[_0x26a091(0x1b9)](_0x842e73),_0x17aab4[_0x26a091(0x23e)](0xc8)[_0x26a091(0x194)]({'message':_0x842e73['message']});}}),router[a0_0x167066(0x245)](a0_0x167066(0x1e5),auth,async(_0x1327ef,_0x252489)=>{var _0x1099a7=a0_0x167066;try{const _0x3b69d9=_0x1327ef[_0x1099a7(0x217)]['id'],{warehouse_name:_0x1cbe42,Room_name:_0x212226}=_0x1327ef['body'],_0x191faa=await adjustment[_0x1099a7(0x249)]({'_id':_0x3b69d9}),_0x148606=_0x191faa[_0x1099a7(0x22b)][_0x1099a7(0x241)](async _0x416f56=>{var _0x18e4d1=_0x1099a7;if(_0x416f56[_0x18e4d1(0x1a4)]>0x0){var _0x5d6ba6=await warehouse[_0x18e4d1(0x1d7)]({'name':_0x1cbe42,'room':_0x416f56[_0x18e4d1(0x1e3)],'warehouse_category':_0x18e4d1(0x18b)});const _0x1f7e52=_0x5d6ba6[_0x18e4d1(0x1c5)][_0x18e4d1(0x241)](_0x3df280=>{var _0x3441dd=_0x18e4d1;if(_0x416f56[_0x3441dd(0x1a2)]==_0x3441dd(0x1d0)){if(_0x3df280[_0x3441dd(0x1f0)]==_0x416f56[_0x3441dd(0x1f0)]&&_0x3df280[_0x3441dd(0x23b)]==_0x416f56[_0x3441dd(0x23b)]&&_0x3df280[_0x3441dd(0x1a2)]==_0x416f56['type']&&_0x3df280[_0x3441dd(0x1bf)]==_0x416f56[_0x3441dd(0x1bf)]&&_0x3df280[_0x3441dd(0x236)]==_0x416f56[_0x3441dd(0x236)]&&_0x3df280[_0x3441dd(0x188)]==_0x416f56[_0x3441dd(0x188)]&&_0x3df280[_0x3441dd(0x1fc)]==_0x416f56[_0x3441dd(0x1fc)]&&_0x3df280['expiry_date']==_0x416f56[_0x3441dd(0x1da)]&&_0x3df280[_0x3441dd(0x204)]==_0x416f56[_0x3441dd(0x204)]&&_0x3df280['production_date']==_0x416f56[_0x3441dd(0x1f5)]&&_0x3df280['invoice']==_0x416f56[_0x3441dd(0x1d8)]){var _0xf83ce4;_0xf83ce4=_0x416f56[_0x3441dd(0x1a4)],_0x416f56[_0x3441dd(0x208)]=='S'&&(_0xf83ce4=_0x416f56[_0x3441dd(0x1a4)]),_0x3df280['product_stock']=_0x3df280[_0x3441dd(0x1a6)]-_0xf83ce4;}}else{if(_0x3df280['product_name']==_0x416f56[_0x3441dd(0x1f0)]&&_0x3df280[_0x3441dd(0x23b)]==_0x416f56['floorlevel']&&_0x3df280[_0x3441dd(0x1a2)]==_0x416f56['type']&&_0x3df280[_0x3441dd(0x1bf)]==_0x416f56['bin']&&_0x3df280['bay']==_0x416f56[_0x3441dd(0x236)]&&_0x3df280['rack']==_0x416f56[_0x3441dd(0x188)]&&_0x3df280['storage']==_0x416f56[_0x3441dd(0x1fc)]&&_0x3df280[_0x3441dd(0x1da)]==_0x416f56['expiry_date']&&_0x3df280['batch_code']==_0x416f56['batch_code']&&_0x3df280[_0x3441dd(0x1f5)]==_0x416f56[_0x3441dd(0x1f5)]&&_0x3df280[_0x3441dd(0x1d8)]==_0x416f56['invoice']){console[_0x3441dd(0x1b9)](_0x416f56);var _0xf83ce4;_0xf83ce4=_0x416f56[_0x3441dd(0x1a4)],_0x416f56[_0x3441dd(0x208)]=='S'&&(_0xf83ce4=_0x416f56[_0x3441dd(0x1a4)]),console[_0x3441dd(0x1b9)](_0xf83ce4+_0x3441dd(0x23d)+_0x416f56[_0x3441dd(0x1a4)]+_0x3441dd(0x23d)+_0x3df280[_0x3441dd(0x191)]+_0x3441dd(0x23d)+_0x416f56[_0x3441dd(0x208)]),_0x3df280[_0x3441dd(0x1a6)]=_0x3df280[_0x3441dd(0x1a6)]+_0xf83ce4;}}});}return _0x5d6ba6;});Promise[_0x1099a7(0x1ae)](_0x148606)['then'](async _0x32124b=>{var _0x4145b2=_0x1099a7;try{for(const _0x326f57 of _0x32124b){await _0x326f57[_0x4145b2(0x1c6)]();}_0x191faa[_0x4145b2(0x1bb)]=_0x4145b2(0x216);const _0x4c3985=await _0x191faa[_0x4145b2(0x1c6)](),_0x2adf3c=await master_shop[_0x4145b2(0x1dc)](),_0x530fe3=await email_settings[_0x4145b2(0x1d7)](),_0x5f7fd7=await supervisor_settings['find']();var _0x19fcfe=_0x191faa[_0x4145b2(0x22b)],_0x196974='',_0x133b6b;for(_0x133b6b in _0x19fcfe){_0x196974+=_0x4145b2(0x214)+_0x4145b2(0x218)+_0x19fcfe[_0x133b6b]['product_name']+_0x4145b2(0x1e6)+_0x4145b2(0x218)+_0x19fcfe[_0x133b6b][_0x4145b2(0x24f)]+_0x4145b2(0x1e6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19fcfe[_0x133b6b][_0x4145b2(0x1a4)]+_0x4145b2(0x1e6)+_0x4145b2(0x218)+_0x19fcfe[_0x133b6b][_0x4145b2(0x19e)]+'</td>'+_0x4145b2(0x218)+_0x19fcfe[_0x133b6b]['secondary_unit']+_0x4145b2(0x1e6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x191faa[_0x4145b2(0x1f7)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19fcfe[_0x133b6b][_0x4145b2(0x1e3)]+_0x4145b2(0x1e6)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19fcfe[_0x133b6b][_0x4145b2(0x1fc)]+_0x19fcfe[_0x133b6b][_0x4145b2(0x188)]+_0x19fcfe[_0x133b6b]['bay']+_0x19fcfe[_0x133b6b][_0x4145b2(0x1bf)]+_0x19fcfe[_0x133b6b]['type'][0x0]+_0x19fcfe[_0x133b6b]['floorlevel']+_0x4145b2(0x1e6),_0x4145b2(0x213);}let _0x14a698=nodemailer[_0x4145b2(0x1fb)]({'host':_0x530fe3['host'],'port':Number(_0x530fe3['port']),'secure':![],'auth':{'user':_0x530fe3['email'],'pass':_0x530fe3['password']}}),_0xe69f4={'from':_0x530fe3['email'],'to':_0x5f7fd7[0x0]['RMSEmail'],'subject':_0x4145b2(0x1cb),'attachments':[{'filename':_0x4145b2(0x1fe),'path':__dirname+_0x4145b2(0x24e)+'/upload/'+_0x2adf3c[0x0][_0x4145b2(0x228)],'cid':_0x4145b2(0x244)}],'html':_0x4145b2(0x21a)+_0x4145b2(0x185)+_0x4145b2(0x1d3)+_0x4145b2(0x238)+_0x4145b2(0x1d1)+_0x4145b2(0x238)+_0x4145b2(0x20b)+'</div>'+_0x4145b2(0x238)+_0x4145b2(0x207)+_0x2adf3c[0x0][_0x4145b2(0x199)]+_0x4145b2(0x18e)+_0x4145b2(0x1f9)+_0x4145b2(0x1f9)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x4145b2(0x1b0)+_0x4145b2(0x1db)+_0x191faa[_0x4145b2(0x1d8)]+'\x20'+_0x4145b2(0x186)+_0x4145b2(0x237)+_0x191faa[_0x4145b2(0x1ef)]+'\x20'+'</span>'+_0x4145b2(0x248)+_0x4145b2(0x1f9)+_0x4145b2(0x234)+_0x4145b2(0x1e7)+_0x4145b2(0x214)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x4145b2(0x229)+_0x4145b2(0x1f2)+_0x4145b2(0x1a0)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x4145b2(0x22d)+_0x4145b2(0x213)+_0x4145b2(0x22f)+_0x4145b2(0x212)+'\x20'+_0x196974+'\x20'+_0x4145b2(0x1b6)+_0x4145b2(0x239)+_0x4145b2(0x238)+_0x4145b2(0x23a)+'<h5>'+_0x2adf3c[0x0][_0x4145b2(0x199)]+_0x4145b2(0x248)+_0x4145b2(0x1f9)+'</div>'+_0x4145b2(0x246)};_0x14a698[_0x4145b2(0x1cc)](_0xe69f4,function(_0x61e177,_0x543d14){var _0x4d31c7=_0x4145b2;_0x61e177?(console[_0x4d31c7(0x1b9)](_0x61e177),console[_0x4d31c7(0x1b9)](_0x4d31c7(0x1ec))):console[_0x4d31c7(0x1b9)]('Email\x20sent\x20successfully');}),_0x1327ef[_0x4145b2(0x183)]('success',_0x4145b2(0x230)),_0x252489[_0x4145b2(0x187)](_0x4145b2(0x254)+_0x4c3985[_0x4145b2(0x19b)]);}catch(_0x3920c7){console['error'](_0x3920c7),_0x252489[_0x4145b2(0x23e)](0x1f4)[_0x4145b2(0x194)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x1099a7(0x255)](_0x4ef56a=>{var _0x41522b=_0x1099a7;console[_0x41522b(0x1b1)](_0x4ef56a),_0x252489[_0x41522b(0x23e)](0x1f4)[_0x41522b(0x194)]({'error':'An\x20error\x20occurred.'});});}catch(_0x5fb2c8){console[_0x1099a7(0x1b9)](_0x5fb2c8),_0x252489[_0x1099a7(0x23e)](0xc8)[_0x1099a7(0x194)]({'message':_0x5fb2c8[_0x1099a7(0x1df)]});}}),router[a0_0x167066(0x1c4)](a0_0x167066(0x1c0),auth,async(_0x502c35,_0x1e4b46)=>{var _0x2ae80f=a0_0x167066;try{const {username:_0x3dc969,email:_0xfb6c28,role:_0x46aae0}=_0x502c35[_0x2ae80f(0x21e)],_0xf8c718=_0x502c35[_0x2ae80f(0x21e)],_0x2ca04f=await profile[_0x2ae80f(0x1d7)]({'email':_0xf8c718['email']}),_0x353f81=await master_shop['find'](),_0x5905f6=_0x502c35[_0x2ae80f(0x217)]['id'],_0x316c1c=await adjustment[_0x2ae80f(0x249)]({'_id':_0x5905f6}),_0x1e4a23=await purchases[_0x2ae80f(0x1e2)]([{'$match':{'warehouse_name':_0x316c1c['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x2ae80f(0x1b2)}}]),_0x3e7d4f=await product[_0x2ae80f(0x1dc)]({}),_0x47f063=await warehouse['aggregate']([{'$match':{'name':_0x316c1c[_0x2ae80f(0x1f7)]}},{'$unwind':_0x2ae80f(0x1e9)},{'$group':{'_id':_0x2ae80f(0x209),'name':{'$first':_0x2ae80f(0x1ea)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2ae80f(0x1ce)},'bin':{'$first':_0x2ae80f(0x1c1)},'type':{'$first':_0x2ae80f(0x202)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2ae80f(0x1f3)},'secondary_code':{'$first':_0x2ae80f(0x224)},'product_code':{'$first':_0x2ae80f(0x1ab)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x2ae80f(0x1e8)},'expiry_date':{'$first':_0x2ae80f(0x257)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2ae80f(0x203)},'room':{'$first':_0x2ae80f(0x223)}}}]);let _0x2550a9;if(_0xf8c718[_0x2ae80f(0x1ba)]=='staff'){const _0x1f3c28=await staff['findOne']({'email':_0xf8c718[_0x2ae80f(0x18d)]});_0x2550a9=await warehouse[_0x2ae80f(0x1e2)]([{'$match':{'status':_0x2ae80f(0x1bd),'name':_0x1f3c28[_0x2ae80f(0x1cf)],'warehouse_category':_0x2ae80f(0x18b),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2ae80f(0x1e4),'name':{'$first':_0x2ae80f(0x1e4)}}}]);}else _0x2550a9=await warehouse[_0x2ae80f(0x1e2)]([{'$match':{'status':_0x2ae80f(0x1bd),'warehouse_category':_0x2ae80f(0x18b),'name':{'$ne':_0x2ae80f(0x21b)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x353f81[0x0]['language']==_0x2ae80f(0x22c)){var _0x58a22a=users[_0x2ae80f(0x24d)];console[_0x2ae80f(0x1b9)](_0x58a22a);}else{if(_0x353f81[0x0][_0x2ae80f(0x182)]==_0x2ae80f(0x1cd))var _0x58a22a=users['Hindi'];else{if(_0x353f81[0x0][_0x2ae80f(0x182)]==_0x2ae80f(0x1ad))var _0x58a22a=users['German'];else{if(_0x353f81[0x0]['language']==_0x2ae80f(0x22e))var _0x58a22a=users[_0x2ae80f(0x22e)];else{if(_0x353f81[0x0][_0x2ae80f(0x182)]==_0x2ae80f(0x24c))var _0x58a22a=users[_0x2ae80f(0x24c)];else{if(_0x353f81[0x0][_0x2ae80f(0x182)]==_0x2ae80f(0x1a5))var _0x58a22a=users[_0x2ae80f(0x1be)];else{if(_0x353f81[0x0]['language']=='Chinese')var _0x58a22a=users['Chinese'];else{if(_0x353f81[0x0][_0x2ae80f(0x182)]=='Arabic\x20(ae)')var _0x58a22a=users['Arabic'];}}}}}}}_0x1e4b46[_0x2ae80f(0x220)](_0x2ae80f(0x1fd),{'success':_0x502c35[_0x2ae80f(0x183)](_0x2ae80f(0x252)),'errors':_0x502c35[_0x2ae80f(0x183)](_0x2ae80f(0x23f)),'role':_0xf8c718,'profile':_0x2ca04f,'adjustment':_0x316c1c,'stock':_0x47f063,'master_shop':_0x353f81,'warehouse_name':_0x1e4a23,'unit':_0x3e7d4f,'language':_0x58a22a,'warehouse':_0x2550a9});}catch(_0x54dd1c){console['log'](_0x54dd1c),_0x1e4b46[_0x2ae80f(0x23e)](0xc8)['json']({'message':_0x54dd1c[_0x2ae80f(0x1df)]});}}),router[a0_0x167066(0x245)](a0_0x167066(0x1c0),auth,async(_0x514c79,_0x37eb24)=>{var _0x6c2d82=a0_0x167066;try{const _0x392285=_0x514c79['params']['id'],_0x3d693e=await adjustment[_0x6c2d82(0x249)]({'_id':_0x392285}),_0x45ee50=await warehouse[_0x6c2d82(0x1d7)]({'name':_0x3d693e[_0x6c2d82(0x1f7)],'room':_0x3d693e[_0x6c2d82(0x1c8)]}),{warehouse_name:_0x15b945,date:_0x2809c3,prod_name:_0x82e0f0,level:_0x2176a2,isle:_0xc24ae9,pallet:_0x343e23,stock:_0x3ef9ed,types:_0x493bed,adjust_qty:_0x585336,new_adjust_qty:_0x30b72f,note:_0x223eb4,Room_name:_0x335571,invoice:_0x28bd6e,JO_number:_0x5e79d6,expiry_date:_0x5a812d}=_0x514c79[_0x6c2d82(0x1d5)];if(typeof _0x82e0f0==_0x6c2d82(0x1c9))var _0x8a7781=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x19a)]],_0xa63d7c=[_0x514c79['body'][_0x6c2d82(0x242)]],_0x4a99a9=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x19c)]],_0x59999b=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1a3)]],_0x3825fd=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1f4)]],_0x5bb257=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x184)]],_0x464b56=[_0x514c79[_0x6c2d82(0x1d5)]['Primary_Units']],_0x3deb86=[_0x514c79[_0x6c2d82(0x1d5)]['Secondary_units']],_0x2815e0=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1af)]],_0x4cb0f2=[_0x514c79['body'][_0x6c2d82(0x204)]],_0x2bbf11=[_0x514c79['body'][_0x6c2d82(0x1da)]],_0x5efe10=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x190)]],_0x524864=[_0x514c79['body']['production_date']],_0x3103e7=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x208)]],_0x5edff3=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1ee)]],_0x12cb71=[_0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x201)]],_0x40dd6a=[_0x514c79['body'][_0x6c2d82(0x1ca)]];else var _0x8a7781=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x19a)]],_0xa63d7c=[..._0x514c79[_0x6c2d82(0x1d5)]['level']],_0x4a99a9=[..._0x514c79['body'][_0x6c2d82(0x19c)]],_0x59999b=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1a3)]],_0x3825fd=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1f4)]],_0x5bb257=[..._0x514c79['body']['New_Qty_Converted']],_0x464b56=[..._0x514c79['body'][_0x6c2d82(0x19e)]],_0x3deb86=[..._0x514c79[_0x6c2d82(0x1d5)]['Secondary_units']],_0x2815e0=[..._0x514c79[_0x6c2d82(0x1d5)]['prod_code']],_0x4cb0f2=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x204)]],_0x2bbf11=[..._0x514c79['body'][_0x6c2d82(0x1da)]],_0x5efe10=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x190)]],_0x524864=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1f5)]],_0x3103e7=[..._0x514c79['body']['prod_cat']],_0x5edff3=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x1ee)]],_0x12cb71=[..._0x514c79[_0x6c2d82(0x1d5)][_0x6c2d82(0x201)]],_0x40dd6a=[..._0x514c79['body'][_0x6c2d82(0x1ca)]];const _0x1d125d=_0x8a7781['map'](_0x4031e2=>{return _0x4031e2={'product_name':_0x4031e2};});_0xa63d7c[_0x6c2d82(0x256)]((_0x150709,_0x1ea005)=>{var _0xb8ef1b=_0x6c2d82;_0x5edff3[_0xb8ef1b(0x256)]((_0xd61d2f,_0x36150b)=>{var _0x5d8b91=_0xb8ef1b;if(_0xd61d2f==_0x5d8b91(0x1c7)&&_0x1ea005==_0x36150b){var _0x3e2dd1=_0x150709[_0x5d8b91(0x189)](0x3);_0x1d125d[_0x1ea005][_0x5d8b91(0x1fc)]=_0x150709[0x0],_0x1d125d[_0x1ea005]['rack']=_0x150709[0x1],_0x1d125d[_0x1ea005]['bay']=0x0,_0x1d125d[_0x1ea005][_0x5d8b91(0x1bf)]=0x0,_0x1d125d[_0x1ea005]['type']=_0x5d8b91(0x258),_0x1d125d[_0x1ea005]['floorlevel']=_0x3e2dd1;}else{if(_0xd61d2f==_0x5d8b91(0x1a7)&&_0x1ea005==_0x36150b){var _0x3e2dd1=_0x150709[_0x5d8b91(0x189)](0x3);_0x1d125d[_0x1ea005][_0x5d8b91(0x1fc)]=_0x150709[0x0],_0x1d125d[_0x1ea005]['rack']=_0x150709[0x1],_0x1d125d[_0x1ea005][_0x5d8b91(0x236)]=0x0,_0x1d125d[_0x1ea005][_0x5d8b91(0x1bf)]=0x0,_0x1d125d[_0x1ea005]['type']='Floor',_0x1d125d[_0x1ea005][_0x5d8b91(0x23b)]=_0x150709[0x5];}else{if(_0x1ea005==_0x36150b){var _0x4a3b7d;if(_0x150709[0x4]=='L')_0x4a3b7d=_0x5d8b91(0x233);else _0x150709[0x4]=='F'&&(_0x4a3b7d=_0x5d8b91(0x258));_0x1d125d[_0x1ea005][_0x5d8b91(0x1fc)]=_0x150709[0x0],_0x1d125d[_0x1ea005][_0x5d8b91(0x188)]=_0x150709[0x1],_0x1d125d[_0x1ea005][_0x5d8b91(0x236)]=_0x150709[0x2],_0x1d125d[_0x1ea005][_0x5d8b91(0x1bf)]=_0x150709[0x3],_0x1d125d[_0x1ea005]['type']=_0x4a3b7d,_0x1d125d[_0x1ea005][_0x5d8b91(0x23b)]=_0x150709[0x5];}}}});}),_0x4a99a9[_0x6c2d82(0x256)]((_0x124444,_0x553622)=>{var _0x313310=_0x6c2d82;_0x1d125d[_0x553622][_0x313310(0x1a9)]=_0x124444;}),_0x59999b[_0x6c2d82(0x256)]((_0x109c5f,_0x2769d6)=>{var _0x2c66b9=_0x6c2d82;_0x1d125d[_0x2769d6][_0x2c66b9(0x1a3)]=_0x109c5f;}),_0x3825fd[_0x6c2d82(0x256)]((_0x5965bd,_0x54c0b5)=>{var _0x1656f2=_0x6c2d82;_0x1d125d[_0x54c0b5][_0x1656f2(0x1a4)]=_0x5965bd;}),_0x5bb257['forEach']((_0xab5272,_0x423a36)=>{var _0x84044b=_0x6c2d82;_0x1d125d[_0x423a36][_0x84044b(0x253)]=_0xab5272;}),_0x464b56['forEach']((_0x3e624c,_0x3d78e3)=>{var _0x4ee1cc=_0x6c2d82;_0x1d125d[_0x3d78e3][_0x4ee1cc(0x19e)]=_0x3e624c;}),_0x3deb86[_0x6c2d82(0x256)]((_0x4aa9eb,_0x4c67e9)=>{_0x1d125d[_0x4c67e9]['secondary_unit']=_0x4aa9eb;}),_0x2815e0[_0x6c2d82(0x256)]((_0x3cec5a,_0x514011)=>{var _0x31394f=_0x6c2d82;_0x1d125d[_0x514011][_0x31394f(0x24f)]=_0x3cec5a;}),_0x4cb0f2[_0x6c2d82(0x256)]((_0x48fb75,_0x2474dc)=>{var _0x34ea3f=_0x6c2d82;_0x1d125d[_0x2474dc][_0x34ea3f(0x204)]=_0x48fb75;}),_0x2bbf11[_0x6c2d82(0x256)]((_0xc84fe0,_0x3da51c)=>{_0x1d125d[_0x3da51c]['expiry_date']=_0xc84fe0;}),_0x5efe10[_0x6c2d82(0x256)]((_0x4fc3a1,_0x47c370)=>{_0x1d125d[_0x47c370]['maxperunit']=_0x4fc3a1;}),_0x524864[_0x6c2d82(0x256)]((_0x346dda,_0x53e5a4)=>{var _0xbf31a2=_0x6c2d82;_0x1d125d[_0x53e5a4][_0xbf31a2(0x1f5)]=_0x346dda;}),_0x3103e7[_0x6c2d82(0x256)]((_0x23d23b,_0x43e405)=>{_0x1d125d[_0x43e405]['prod_cat']=_0x23d23b;}),_0x5edff3[_0x6c2d82(0x256)]((_0x57f523,_0x32102c)=>{var _0x103cb2=_0x6c2d82;_0x1d125d[_0x32102c][_0x103cb2(0x1e3)]=_0x57f523;}),_0x12cb71[_0x6c2d82(0x256)]((_0xf14418,_0x32fc1f)=>{var _0x5ef39d=_0x6c2d82;_0x1d125d[_0x32fc1f][_0x5ef39d(0x231)]=_0xf14418;}),_0x40dd6a[_0x6c2d82(0x256)]((_0x4fb215,_0x369e43)=>{var _0x587066=_0x6c2d82;_0x1d125d[_0x369e43][_0x587066(0x19d)]=_0x4fb215;});const _0x310691=_0x1d125d[_0x6c2d82(0x250)](_0x19df3f=>_0x19df3f[_0x6c2d82(0x1a4)]!=='0'&&_0x19df3f[_0x6c2d82(0x1a4)]!=='');var _0x12c5e4=0x0;_0x310691[_0x6c2d82(0x256)](_0x54668b=>{var _0x1c8b88=_0x6c2d82;console[_0x1c8b88(0x1b9)](_0x1c8b88(0x251),_0x54668b),parseInt(_0x54668b[_0x1c8b88(0x1a4)])<=0x0&&_0x12c5e4++;});if(_0x12c5e4!=0x0)return _0x514c79[_0x6c2d82(0x183)]('errors',_0x6c2d82(0x206)),_0x37eb24[_0x6c2d82(0x187)]('back');_0x3d693e[_0x6c2d82(0x1f7)]=_0x15b945,_0x3d693e['date']=_0x2809c3,_0x3d693e['product']=_0x310691,_0x3d693e[_0x6c2d82(0x1f8)]=_0x223eb4,_0x3d693e[_0x6c2d82(0x1d8)]=_0x28bd6e,_0x3d693e['isAllowEdit']='False';const _0x44f3d5=await _0x3d693e['save']();_0x514c79[_0x6c2d82(0x183)](_0x6c2d82(0x252),_0x6c2d82(0x1ac)),_0x37eb24['redirect']('/adjustment/view');}catch(_0x2a8832){console['log'](_0x2a8832);}}),router[a0_0x167066(0x245)]('/barcode_scanner',async(_0x49c14a,_0x894ab)=>{var _0xd792e=a0_0x167066;const {primary_code:_0x47c8fb,warehouse_data:_0x33a2ac,rooms_data:_0x52beda,Roomslist:_0x5d6a71}=_0x49c14a[_0xd792e(0x1d5)],_0x562650=_0x5d6a71[_0xd792e(0x21f)](','),_0x5dfd5f=[];async function _0xa1fe05(_0x299107){var _0x3ae4ad=_0xd792e;const _0x469702=await warehouse[_0x3ae4ad(0x1e2)]([{'$match':{'name':_0x33a2ac,'room':_0x299107}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x47c8fb}},{'$group':{'_id':_0x3ae4ad(0x209),'name':{'$first':_0x3ae4ad(0x1ea)},'product_stock':{'$first':_0x3ae4ad(0x226)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3ae4ad(0x1ab)},'level':{'$first':_0x3ae4ad(0x1ce)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3ae4ad(0x202)},'pallet':{'$first':_0x3ae4ad(0x1bc)},'unit':{'$first':_0x3ae4ad(0x219)},'secondary_unit':{'$first':_0x3ae4ad(0x1eb)},'storage':{'$first':_0x3ae4ad(0x211)},'rack':{'$first':_0x3ae4ad(0x221)},'expiry_date':{'$first':_0x3ae4ad(0x257)},'production_date':{'$first':_0x3ae4ad(0x1aa)},'maxPerUnit':{'$first':_0x3ae4ad(0x1e8)},'batch_code':{'$first':_0x3ae4ad(0x203)},'product_cat':{'$first':_0x3ae4ad(0x1d2)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3ae4ad(0x223)}}}]),_0x11300e=await warehouse[_0x3ae4ad(0x1e2)]([{'$match':{'name':_0x33a2ac,'room':_0x299107}},{'$unwind':_0x3ae4ad(0x1e9)},{'$match':{'product_details.secondary_code':_0x47c8fb}},{'$group':{'_id':_0x3ae4ad(0x209),'name':{'$first':_0x3ae4ad(0x1ea)},'product_stock':{'$first':_0x3ae4ad(0x226)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3ae4ad(0x1ab)},'level':{'$first':_0x3ae4ad(0x1ce)},'isle':{'$first':_0x3ae4ad(0x1c1)},'type':{'$first':_0x3ae4ad(0x202)},'pallet':{'$first':_0x3ae4ad(0x1bc)},'unit':{'$first':_0x3ae4ad(0x219)},'secondary_unit':{'$first':_0x3ae4ad(0x1eb)},'storage':{'$first':_0x3ae4ad(0x211)},'rack':{'$first':_0x3ae4ad(0x221)},'expiry_date':{'$first':_0x3ae4ad(0x257)},'production_date':{'$first':_0x3ae4ad(0x1aa)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x3ae4ad(0x203)},'product_cat':{'$first':_0x3ae4ad(0x1d2)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3ae4ad(0x223)}}}]);if(_0x469702[_0x3ae4ad(0x259)]>0x0)_0x5dfd5f['push'](_0x469702);else _0x11300e[_0x3ae4ad(0x259)]>0x0&&_0x5dfd5f[_0x3ae4ad(0x193)](_0x11300e);}const _0x401a1e=_0x562650['map'](_0x49d5d7=>_0xa1fe05(_0x49d5d7));await Promise[_0xd792e(0x1ae)](_0x401a1e),_0x894ab['json'](_0x5dfd5f);}),router[a0_0x167066(0x245)](a0_0x167066(0x1ed),async(_0x13d2fd,_0x275959)=>{var _0x38f42c=a0_0x167066;const {primaryCode:_0x5e58c7,secondaryCode:_0x552644,productCode:_0x47c558,level:_0x377a48,isle:_0x4c374c,pallet:_0x2fdfd0,warehouses:_0x1df9b1,room:_0x211e4b}=_0x13d2fd[_0x38f42c(0x1d5)];try{const _0x5ef7cf=await warehouse[_0x38f42c(0x1e2)]([{'$match':{'name':_0x1df9b1,'room':_0x211e4b}},{'$unwind':_0x38f42c(0x1e9)},{'$match':{'product_details.level':parseInt(_0x377a48),'product_details.isle':_0x4c374c,'product_details.pallet':parseInt(_0x2fdfd0)}},{'$group':{'_id':_0x38f42c(0x209),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x38f42c(0x226)},'level':{'$first':_0x38f42c(0x1f1)},'isle':{'$first':_0x38f42c(0x22a)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x38f42c(0x1e0)}}}]);_0x275959['status'](0xc8)[_0x38f42c(0x194)](_0x5ef7cf);}catch(_0x2bc0cf){_0x275959[_0x38f42c(0x23e)](0x194)[_0x38f42c(0x194)]({'message':_0x2bc0cf[_0x38f42c(0x1df)]});}}),module[a0_0x167066(0x1b7)]=router;