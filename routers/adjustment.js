var a0_0x1d2f3=a0_0x58bc;(function(_0x18a2b8,_0x26c6df){var _0xeb6ff5=a0_0x58bc,_0x3e9b25=_0x18a2b8();while(!![]){try{var _0x497ac9=parseInt(_0xeb6ff5(0x267))/0x1+parseInt(_0xeb6ff5(0x270))/0x2+-parseInt(_0xeb6ff5(0x2bf))/0x3+-parseInt(_0xeb6ff5(0x24b))/0x4+-parseInt(_0xeb6ff5(0x2c9))/0x5+parseInt(_0xeb6ff5(0x2a7))/0x6*(-parseInt(_0xeb6ff5(0x2c2))/0x7)+-parseInt(_0xeb6ff5(0x1f3))/0x8*(-parseInt(_0xeb6ff5(0x237))/0x9);if(_0x497ac9===_0x26c6df)break;else _0x3e9b25['push'](_0x3e9b25['shift']());}catch(_0x2a7c07){_0x3e9b25['push'](_0x3e9b25['shift']());}}}(a0_0x457c,0x793b4));function a0_0x457c(){var _0x49637d=['stock','Shelves','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Return\x20Goods','errors','$product_details.batch_code','$name','\x20Order\x20Date\x20:\x20','$product_details.secondary_unit','adjustment\x20add\x20successfull','prod_invoice','$product_details.level','back','valueOf','email','French','createTransport','catch','16384077wHiPOR','Rooms','split','German','False','$product_details.pallet','Enabled','render','$_id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','password','<h2>\x20','type','$isAllowEdit','image','New_Qty_Converted_adj','../models/all_models','Floor','<hr\x20class=\x22my-3\x22>','Portuguese\x20(BR)','1485524xxghMA','floor','$product_details.rack','params','new_adjust_qty','</tr>','True','$product_details.unit','Portuguese','room_names','_id','port','express','<h5\x20style=\x22text-align:\x20left;\x22>','</div>','<html><head><title></title>','<span\x20style=\x22float:\x20right;\x22>','bay','body','random','$product_details.type','Router','product_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product_name','length','findOne','types','288570eFOHNm','id_transaction_from','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','</tbody>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','then','language','/CheckingWarehouse','post','1462972WVwRow','/adjustment/view','$product_details.production_date','warehouse','$product_details.invoice','$product_details.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','RMSEmail','\x20<>\x20','$product_details.bin','$product_details.maxProducts','$finalize','</td>','Email\x20sent\x20successfully','invoice','expiry_date','logo','/upload/','isAllowEdit','second1','secondary_code','nodemailer','master','Return\x20Rooms','redirect','/view/add_adjustment','forEach','$product_details.storage','bin','primary_code','stockBefore','<!DOCTYPE\x20html>','Receiving\x20Area','</body></html>','level','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Error\x20Occurs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','log','storage','/preview/:id','\x20Order\x20Number\x20:\x20','Spanish','Ambient','Arabic\x20(ae)','$product_details','max_per_unit','</head><body>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.expiry_date','$product.room_names','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','sendMail','unit','/view/:id','804744LFsdDg','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','toString','prod_name','Primary_Units','/adjustment/preview/','English\x20(US)','edit_adjustment','product_stock','site_title','save','../public/language/languages.json','Enclosed','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','production_date','adjust_qty','id_transaction','foreach\x20newproduct','add_adjustment','$product_details.product_stock','Raw\x20Materials','<tr>','flash','updateOne','2007981HbxWqS','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','49FjMyis','New_Qty_Converted','$product_details.floorlevel','prime1','$room','role','$product_details.secondary_code','1821845YIPXTZ','findById','rack','\x20</h2>','filter','host','Types','8eWEBHA','product_details','$product_details.primary_code','user','$product_details.bay','$product_details.isle','prod_cat','$date','floorlevel','aggregate','/picking_list/PDF_adjustment_rm/','$product','<h5>','$product_details.maxPerUnit','product','/view','Hindi','$product.product_name','push','batch_code','Secondary_units','<strong>\x20Regards\x20</strong>','Chinese','padStart','<div>','status','maxperunit','slice','success','</h5>','warehouse_name','json','prod_code','ADJ-','secondary_unit','get','$product_details.product_code','finalize','adjustment','English','message','Level','$product_details._id','$product_details.product_cat','staff','find','adjustment\x20data\x20update\x20successfully','map','Arabic'];a0_0x457c=function(){return _0x49637d;};return a0_0x457c();}const express=require(a0_0x1d2f3(0x257)),app=express(),router=express[a0_0x1d2f3(0x260)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1d2f3(0x247)),users=require(a0_0x1d2f3(0x2b2)),nodemailer=require(a0_0x1d2f3(0x285)),mongoose=require('mongoose');router[a0_0x1d2f3(0x216)](a0_0x1d2f3(0x202),auth,async(_0x1f64cc,_0x41fb1f)=>{var _0x5e70f8=a0_0x1d2f3;try{const {username:_0x152b0a,email:_0x52d197,role:_0x53fe26}=_0x1f64cc[_0x5e70f8(0x1f6)],_0x57ca29=_0x1f64cc[_0x5e70f8(0x1f6)],_0xf3ca71=await profile['findOne']({'email':_0x57ca29[_0x5e70f8(0x233)]}),_0x6d1b4b=await master_shop[_0x5e70f8(0x220)]();console[_0x5e70f8(0x296)](_0x5e70f8(0x286),_0x6d1b4b);let _0x3873b1;if(_0x57ca29['role']=='staff'){const _0x5d806d=await staff['findOne']({'email':_0x57ca29[_0x5e70f8(0x233)]});_0x3873b1=await warehouse['find']({'status':_0x5e70f8(0x23d),'name':_0x5d806d['warehouse']});}else _0x3873b1=await warehouse['find']({'status':_0x5e70f8(0x23d)});const _0x2f9162=await product['find']();let _0x12d8d2;if(_0x57ca29[_0x5e70f8(0x2c7)]==_0x5e70f8(0x21f)){const _0x16705=await staff[_0x5e70f8(0x265)]({'email':_0x57ca29[_0x5e70f8(0x233)]});_0x12d8d2=await adjustment[_0x5e70f8(0x220)]({'warehouse_name':_0x16705[_0x5e70f8(0x273)]});}else _0x12d8d2=await adjustment[_0x5e70f8(0x1fc)]([{'$unwind':_0x5e70f8(0x1fe)},{'$group':{'_id':_0x5e70f8(0x23f),'invoice':{'$first':'$invoice'},'date':{'$first':_0x5e70f8(0x1fa)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x5e70f8(0x2a2)},'finalize':{'$first':_0x5e70f8(0x27b)},'isAllowEdit':{'$first':_0x5e70f8(0x244)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x6d1b4b[0x0]['language']==_0x5e70f8(0x2ad)){var _0x875616=users[_0x5e70f8(0x21a)];console[_0x5e70f8(0x296)](_0x875616);}else{if(_0x6d1b4b[0x0][_0x5e70f8(0x26d)]==_0x5e70f8(0x203))var _0x875616=users['Hindi'];else{if(_0x6d1b4b[0x0][_0x5e70f8(0x26d)]==_0x5e70f8(0x23a))var _0x875616=users[_0x5e70f8(0x23a)];else{if(_0x6d1b4b[0x0][_0x5e70f8(0x26d)]==_0x5e70f8(0x29a))var _0x875616=users[_0x5e70f8(0x29a)];else{if(_0x6d1b4b[0x0]['language']==_0x5e70f8(0x234))var _0x875616=users['French'];else{if(_0x6d1b4b[0x0]['language']==_0x5e70f8(0x24a))var _0x875616=users['Portuguese'];else{if(_0x6d1b4b[0x0]['language']==_0x5e70f8(0x209))var _0x875616=users[_0x5e70f8(0x209)];else{if(_0x6d1b4b[0x0]['language']==_0x5e70f8(0x29c))var _0x875616=users['Arabic'];}}}}}}}_0x41fb1f[_0x5e70f8(0x23e)](_0x5e70f8(0x219),{'success':_0x1f64cc[_0x5e70f8(0x2bd)](_0x5e70f8(0x20f)),'errors':_0x1f64cc['flash'](_0x5e70f8(0x229)),'role':_0x57ca29,'profile':_0xf3ca71,'warehouse':_0x3873b1,'product':_0x2f9162,'adjustment':_0x12d8d2,'master_shop':_0x6d1b4b,'language':_0x875616});}catch(_0x126502){console[_0x5e70f8(0x296)](_0x126502);}});function a0_0x58bc(_0x593343,_0x5072be){var _0x457c49=a0_0x457c();return a0_0x58bc=function(_0x58bc1e,_0x1d1dee){_0x58bc1e=_0x58bc1e-0x1f2;var _0x2c4396=_0x457c49[_0x58bc1e];return _0x2c4396;},a0_0x58bc(_0x593343,_0x5072be);}async function getRandom8DigitNumber(){var _0x15095f=a0_0x1d2f3;const _0xf4158f=0x989680,_0x1c95f8=0x5f5e0ff,_0x5a2fdf=Math[_0x15095f(0x24c)](Math[_0x15095f(0x25e)]()*(_0x1c95f8-_0xf4158f+0x1))+_0xf4158f;var _0x2c081c;const _0x80c5b4=await adjustment[_0x15095f(0x265)]({'invoice':'ADJ-'+_0x5a2fdf});return _0x80c5b4&&_0x80c5b4[_0x15095f(0x264)]>0x0?_0x2c081c=_0x15095f(0x214)+_0x5a2fdf:_0x2c081c='ADJ-'+_0x5a2fdf,_0x2c081c;}router[a0_0x1d2f3(0x216)](a0_0x1d2f3(0x289),auth,async(_0x13dc6b,_0x8373e4)=>{var _0x3ec9e2=a0_0x1d2f3;try{const {username:_0x53a6a4,email:_0x13b252,role:_0x520852}=_0x13dc6b[_0x3ec9e2(0x1f6)],_0x9bc168=_0x13dc6b[_0x3ec9e2(0x1f6)],_0x54c0dd=await profile[_0x3ec9e2(0x265)]({'email':_0x9bc168[_0x3ec9e2(0x233)]}),_0x4001b5=await master_shop[_0x3ec9e2(0x220)]();let _0x22dea0;if(_0x9bc168[_0x3ec9e2(0x2c7)]==_0x3ec9e2(0x21f)){const _0x466895=await staff[_0x3ec9e2(0x265)]({'email':_0x9bc168[_0x3ec9e2(0x233)]});_0x22dea0=await warehouse[_0x3ec9e2(0x1fc)]([{'$match':{'status':_0x3ec9e2(0x23d),'name':_0x466895[_0x3ec9e2(0x273)],'warehouse_category':_0x3ec9e2(0x2bb),'name':{'$ne':_0x3ec9e2(0x228)}}},{'$group':{'_id':_0x3ec9e2(0x22b),'name':{'$first':_0x3ec9e2(0x22b)}}}]);}else _0x22dea0=await warehouse[_0x3ec9e2(0x1fc)]([{'$match':{'status':_0x3ec9e2(0x23d),'warehouse_category':_0x3ec9e2(0x2bb),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x3ec9e2(0x22b),'name':{'$first':_0x3ec9e2(0x22b)}}}]);const _0x28cda1=await product[_0x3ec9e2(0x220)]({}),_0x423e78=await adjustment[_0x3ec9e2(0x220)]({}),_0x521f68=_0x423e78[_0x3ec9e2(0x264)]+0x1,_0x242902='ADJ-'+_0x521f68[_0x3ec9e2(0x2a9)]()[_0x3ec9e2(0x20a)](0x5,'0');var _0x4059df=[_0x3ec9e2(0x29b),_0x3ec9e2(0x2b3),_0x3ec9e2(0x287)];if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]=='English\x20(US)')var _0x3cf652=users[_0x3ec9e2(0x21a)];else{if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]==_0x3ec9e2(0x203))var _0x3cf652=users[_0x3ec9e2(0x203)];else{if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]=='German')var _0x3cf652=users[_0x3ec9e2(0x23a)];else{if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]=='Spanish')var _0x3cf652=users[_0x3ec9e2(0x29a)];else{if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]==_0x3ec9e2(0x234))var _0x3cf652=users[_0x3ec9e2(0x234)];else{if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]=='Portuguese\x20(BR)')var _0x3cf652=users[_0x3ec9e2(0x253)];else{if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]=='Chinese')var _0x3cf652=users[_0x3ec9e2(0x209)];else{if(_0x4001b5[0x0][_0x3ec9e2(0x26d)]==_0x3ec9e2(0x29c))var _0x3cf652=users[_0x3ec9e2(0x223)];}}}}}}}const _0xaba104=getRandom8DigitNumber();_0xaba104[_0x3ec9e2(0x26c)](_0x245186=>{var _0x4f4719=_0x3ec9e2;_0x8373e4[_0x4f4719(0x23e)](_0x4f4719(0x2b9),{'success':_0x13dc6b['flash'](_0x4f4719(0x20f)),'errors':_0x13dc6b[_0x4f4719(0x2bd)]('errors'),'role':_0x9bc168,'profile':_0x54c0dd,'warehouse':_0x22dea0,'product':_0x28cda1,'master_shop':_0x4001b5,'language':_0x3cf652,'rooms_data':_0x4059df,'invoice_no':_0x245186});})[_0x3ec9e2(0x236)](_0x1aec9a=>{var _0x1ee20e=_0x3ec9e2;_0x13dc6b[_0x1ee20e(0x2bd)](_0x1ee20e(0x229),_0x1ee20e(0x262)),_0x8373e4[_0x1ee20e(0x288)](_0x1ee20e(0x271));});}catch(_0x162c40){console[_0x3ec9e2(0x296)](_0x162c40);}}),router[a0_0x1d2f3(0x26f)](a0_0x1d2f3(0x289),auth,async(_0x56b496,_0x18e237)=>{var _0x5d315b=a0_0x1d2f3;try{const {warehouse_name:_0x3f7124,date:_0x4b5011,prod_name:_0x4f25a6,level:_0x2ca252,isle:_0x25b578,pallet:_0x3e911c,stock:_0xf1881f,types:_0x2f6972,adjust_qty:_0x5c1743,new_adjust_qty:_0x3852ab,note:_0x2d0cb6,Room_name:_0x240a60,invoice:_0x58439d,JO_number:_0x2032c9,expiry_date:_0x39ca16}=_0x56b496[_0x5d315b(0x25d)];if(typeof _0x4f25a6=='string')var _0x2a38dd=[_0x56b496[_0x5d315b(0x25d)]['prod_name']],_0x4383b5=[_0x56b496[_0x5d315b(0x25d)]['level']],_0x1cd720=[_0x56b496['body'][_0x5d315b(0x224)]],_0x307e07=[_0x56b496['body'][_0x5d315b(0x266)]],_0x34d40c=[_0x56b496[_0x5d315b(0x25d)]['New_Qty_Converted_adj']],_0x4cd9a2=[_0x56b496['body'][_0x5d315b(0x2c3)]],_0xc3b734=[_0x56b496['body']['Primary_Units']],_0x1773ca=[_0x56b496[_0x5d315b(0x25d)]['Secondary_units']],_0x3c2565=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x213)]],_0x93706d=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x206)]],_0x1ee763=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x27f)]],_0x3ed85e=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x29e)]],_0x233637=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x2b5)]],_0x24c557=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x1f9)]],_0x4e4c94=[_0x56b496[_0x5d315b(0x25d)]['Rooms']],_0x3fdfcd=[_0x56b496[_0x5d315b(0x25d)]['prime1']],_0x6dbc7f=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x283)]],_0x1452db=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x22f)]],_0x236207=[_0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x2b7)]];else var _0x2a38dd=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x2aa)]],_0x4383b5=[..._0x56b496['body']['level']],_0x1cd720=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x224)]],_0x307e07=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x266)]],_0x34d40c=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x246)]],_0x4cd9a2=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x2c3)]],_0xc3b734=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x2a5)]],_0x1773ca=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x207)]],_0x3c2565=[..._0x56b496['body'][_0x5d315b(0x213)]],_0x93706d=[..._0x56b496['body'][_0x5d315b(0x206)]],_0x1ee763=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x27f)]],_0x3ed85e=[..._0x56b496[_0x5d315b(0x25d)]['max_per_unit']],_0x233637=[..._0x56b496['body'][_0x5d315b(0x2b5)]],_0x24c557=[..._0x56b496[_0x5d315b(0x25d)]['prod_cat']],_0x4e4c94=[..._0x56b496['body'][_0x5d315b(0x238)]],_0x3fdfcd=[..._0x56b496[_0x5d315b(0x25d)]['prime1']],_0x6dbc7f=[..._0x56b496[_0x5d315b(0x25d)]['second1']],_0x1452db=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x22f)]],_0x236207=[..._0x56b496[_0x5d315b(0x25d)][_0x5d315b(0x2b7)]];const _0x4338d2=_0x2a38dd[_0x5d315b(0x222)](_0x2b5ac9=>{return _0x2b5ac9={'product_name':_0x2b5ac9};});_0x4383b5[_0x5d315b(0x28a)]((_0x5ebb28,_0x2cd164)=>{_0x4e4c94['forEach']((_0x2a4672,_0x45e43f)=>{var _0x5a781e=a0_0x58bc;if(_0x2a4672==_0x5a781e(0x290)&&_0x2cd164==_0x45e43f){var _0x454883=_0x5ebb28[_0x5a781e(0x20e)](0x3);_0x4338d2[_0x2cd164][_0x5a781e(0x297)]=_0x5ebb28[0x0],_0x4338d2[_0x2cd164][_0x5a781e(0x2cb)]=_0x5ebb28[0x1],_0x4338d2[_0x2cd164][_0x5a781e(0x25c)]=0x0,_0x4338d2[_0x2cd164][_0x5a781e(0x28c)]=0x0,_0x4338d2[_0x2cd164]['type']='Floor',_0x4338d2[_0x2cd164][_0x5a781e(0x1fb)]=_0x454883;}else{if(_0x2a4672==_0x5a781e(0x225)&&_0x2cd164==_0x45e43f){var _0x454883=_0x5ebb28[_0x5a781e(0x20e)](0x3);_0x4338d2[_0x2cd164][_0x5a781e(0x297)]=_0x5ebb28[0x0],_0x4338d2[_0x2cd164][_0x5a781e(0x2cb)]=_0x5ebb28[0x1],_0x4338d2[_0x2cd164][_0x5a781e(0x25c)]=0x0,_0x4338d2[_0x2cd164][_0x5a781e(0x28c)]=0x0,_0x4338d2[_0x2cd164]['type']=_0x5a781e(0x248),_0x4338d2[_0x2cd164][_0x5a781e(0x1fb)]=_0x5ebb28[0x5];}else{if(_0x2cd164==_0x45e43f){var _0x5af14b;if(_0x5ebb28[0x4]=='L')_0x5af14b=_0x5a781e(0x21c);else _0x5ebb28[0x4]=='F'&&(_0x5af14b=_0x5a781e(0x248));_0x4338d2[_0x2cd164]['storage']=_0x5ebb28[0x0],_0x4338d2[_0x2cd164][_0x5a781e(0x2cb)]=_0x5ebb28[0x1],_0x4338d2[_0x2cd164][_0x5a781e(0x25c)]=_0x5ebb28[0x2],_0x4338d2[_0x2cd164][_0x5a781e(0x28c)]=_0x5ebb28[0x3],_0x4338d2[_0x2cd164][_0x5a781e(0x243)]=_0x5af14b,_0x4338d2[_0x2cd164]['floorlevel']=_0x5ebb28[0x5];}}}});}),_0x1cd720[_0x5d315b(0x28a)]((_0x255a64,_0x5107e8)=>{var _0x450542=_0x5d315b;_0x4338d2[_0x5107e8][_0x450542(0x28e)]=_0x255a64;}),_0x236207[_0x5d315b(0x28a)]((_0x4750ad,_0x165fd9)=>{var _0x2238f6=_0x5d315b;_0x4338d2[_0x165fd9][_0x2238f6(0x268)]=_0x4750ad;}),_0x307e07[_0x5d315b(0x28a)]((_0x104d42,_0x14578b)=>{var _0xf062ea=_0x5d315b;_0x4338d2[_0x14578b][_0xf062ea(0x266)]=_0x104d42;}),_0x34d40c[_0x5d315b(0x28a)]((_0x43b497,_0x2654a8)=>{var _0x4fd183=_0x5d315b;_0x4338d2[_0x2654a8][_0x4fd183(0x2b6)]=_0x43b497;}),_0x4cd9a2[_0x5d315b(0x28a)]((_0x15bc13,_0x2c6a9d)=>{var _0x23bcd8=_0x5d315b;_0x4338d2[_0x2c6a9d][_0x23bcd8(0x24f)]=_0x15bc13;}),_0xc3b734[_0x5d315b(0x28a)]((_0x34f8fd,_0x181ae6)=>{var _0x4c3169=_0x5d315b;_0x4338d2[_0x181ae6][_0x4c3169(0x2a5)]=_0x34f8fd;}),_0x1773ca[_0x5d315b(0x28a)]((_0x3ecbbe,_0x4e8201)=>{var _0x102f25=_0x5d315b;_0x4338d2[_0x4e8201][_0x102f25(0x215)]=_0x3ecbbe;}),_0x3c2565['forEach']((_0x56b618,_0x4a2544)=>{var _0x4daca8=_0x5d315b;_0x4338d2[_0x4a2544][_0x4daca8(0x261)]=_0x56b618;}),_0x93706d[_0x5d315b(0x28a)]((_0x16d6de,_0x3d02b3)=>{var _0x2bcff6=_0x5d315b;_0x4338d2[_0x3d02b3][_0x2bcff6(0x206)]=_0x16d6de;}),_0x1ee763[_0x5d315b(0x28a)]((_0x2b62e1,_0x1e9fc2)=>{var _0x47e5b7=_0x5d315b;_0x4338d2[_0x1e9fc2][_0x47e5b7(0x27f)]=_0x2b62e1;}),_0x3ed85e[_0x5d315b(0x28a)]((_0x4eeaea,_0x1676a4)=>{_0x4338d2[_0x1676a4]['maxperunit']=_0x4eeaea;}),_0x233637[_0x5d315b(0x28a)]((_0x40e2d1,_0x1f6485)=>{var _0x2d6df0=_0x5d315b;_0x4338d2[_0x1f6485][_0x2d6df0(0x2b5)]=_0x40e2d1;}),_0x24c557['forEach']((_0x1cc41b,_0x525c83)=>{_0x4338d2[_0x525c83]['prod_cat']=_0x1cc41b;}),_0x4e4c94['forEach']((_0x558be8,_0x5dac77)=>{_0x4338d2[_0x5dac77]['room_names']=_0x558be8;}),_0x3fdfcd['forEach']((_0x58e24e,_0x5d1501)=>{var _0x20f414=_0x5d315b;_0x4338d2[_0x5d1501][_0x20f414(0x28d)]=_0x58e24e;}),_0x6dbc7f[_0x5d315b(0x28a)]((_0x2ee941,_0x10cde3)=>{_0x4338d2[_0x10cde3]['secondary_code']=_0x2ee941;}),_0x1452db[_0x5d315b(0x28a)]((_0x481600,_0x449860)=>{var _0x3c9589=_0x5d315b;_0x4338d2[_0x449860][_0x3c9589(0x27e)]=_0x481600;});const _0x14509c=_0x4338d2[_0x5d315b(0x2cd)](_0x4c8ce9=>_0x4c8ce9[_0x5d315b(0x2b6)]!=='0'&&_0x4c8ce9[_0x5d315b(0x2b6)]!=='');var _0x2fae45=0x0;_0x14509c[_0x5d315b(0x28a)](_0x55d282=>{var _0x5d35bd=_0x5d315b;console[_0x5d35bd(0x296)](_0x5d35bd(0x2b8),_0x55d282),parseInt(_0x55d282['adjust_qty'])<=0x0&&_0x2fae45++;});if(_0x2fae45!=0x0)return _0x56b496[_0x5d315b(0x2bd)]('errors',_0x5d315b(0x269)),_0x18e237[_0x5d315b(0x288)]('back');const _0x2e7b96=new adjustment({'warehouse_name':_0x3f7124,'date':_0x4b5011,'product':_0x14509c,'note':_0x2d0cb6,'room':_0x240a60,'invoice':_0x58439d,'JO_number':_0x2032c9,'expiry_date':_0x39ca16}),_0x1df0bb=await _0x2e7b96[_0x5d315b(0x2b1)]();_0x56b496[_0x5d315b(0x2bd)](_0x5d315b(0x20f),_0x5d315b(0x22e)),_0x18e237[_0x5d315b(0x288)](_0x5d315b(0x2ac)+_0x1df0bb['_id']);}catch(_0x2fef2a){console[_0x5d315b(0x296)](_0x2fef2a),_0x18e237[_0x5d315b(0x20c)](0xc8)[_0x5d315b(0x212)]({'message':_0x2fef2a[_0x5d315b(0x21b)]});}}),router[a0_0x1d2f3(0x216)](a0_0x1d2f3(0x298),auth,async(_0x6398ca,_0x40a7a8)=>{var _0x47325c=a0_0x1d2f3;try{const {username:_0x17ffd1,email:_0x4e6c87,role:_0x20ec18}=_0x6398ca[_0x47325c(0x1f6)],_0x380a46=_0x6398ca[_0x47325c(0x1f6)],_0x21f3b8=await profile[_0x47325c(0x265)]({'email':_0x380a46['email']}),_0x242f68=await master_shop[_0x47325c(0x220)](),_0x29d301=_0x6398ca[_0x47325c(0x24e)]['id'],_0x3ccd2a=await adjustment[_0x47325c(0x2ca)]({'_id':_0x29d301}),_0x5d281b=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3ccd2a[_0x47325c(0x211)]}},{'$unwind':_0x47325c(0x1fe)},{'$group':{'_id':_0x47325c(0x204)}}]),_0x17d009=await product[_0x47325c(0x220)]({}),_0x91db16=await warehouse[_0x47325c(0x1fc)]([{'$match':{'name':_0x3ccd2a['warehouse_name']}},{'$unwind':_0x47325c(0x29d)},{'$group':{'_id':_0x47325c(0x21d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x47325c(0x2ba)},'bay':{'$first':_0x47325c(0x1f7)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x47325c(0x25f)},'floorlevel':{'$first':_0x47325c(0x2c4)},'primary_code':{'$first':_0x47325c(0x1f5)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x47325c(0x28b)},'rack':{'$first':_0x47325c(0x24d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x47325c(0x2a1)},'production_date':{'$first':_0x47325c(0x272)},'batch_code':{'$first':_0x47325c(0x22a)},'room':{'$first':'$room'}}}]);if(_0x242f68[0x0][_0x47325c(0x26d)]==_0x47325c(0x2ad)){var _0x16a400=users[_0x47325c(0x21a)];console[_0x47325c(0x296)](_0x16a400);}else{if(_0x242f68[0x0]['language']=='Hindi')var _0x16a400=users['Hindi'];else{if(_0x242f68[0x0][_0x47325c(0x26d)]==_0x47325c(0x23a))var _0x16a400=users['German'];else{if(_0x242f68[0x0][_0x47325c(0x26d)]=='Spanish')var _0x16a400=users[_0x47325c(0x29a)];else{if(_0x242f68[0x0]['language']=='French')var _0x16a400=users[_0x47325c(0x234)];else{if(_0x242f68[0x0][_0x47325c(0x26d)]=='Portuguese\x20(BR)')var _0x16a400=users[_0x47325c(0x253)];else{if(_0x242f68[0x0][_0x47325c(0x26d)]==_0x47325c(0x209))var _0x16a400=users['Chinese'];else{if(_0x242f68[0x0][_0x47325c(0x26d)]==_0x47325c(0x29c))var _0x16a400=users[_0x47325c(0x223)];}}}}}}}_0x40a7a8[_0x47325c(0x23e)]('edit_adjustment_view',{'success':_0x6398ca[_0x47325c(0x2bd)]('success'),'errors':_0x6398ca['flash']('errors'),'role':_0x380a46,'profile':_0x21f3b8,'adjustment':_0x3ccd2a,'master_shop':_0x242f68,'warehouse_name':_0x5d281b,'unit':_0x17d009,'language':_0x16a400});}catch(_0x3005cf){console[_0x47325c(0x296)](_0x3005cf),_0x40a7a8[_0x47325c(0x20c)](0xc8)['json']({'message':_0x3005cf['message']});}}),router[a0_0x1d2f3(0x26f)](a0_0x1d2f3(0x298),auth,async(_0x506c02,_0x311147)=>{var _0xf271a4=a0_0x1d2f3;try{const _0x4f7c8a=_0x506c02[_0xf271a4(0x24e)]['id'],{warehouse_name:_0x43f6fe,Room_name:_0x42ce8b}=_0x506c02['body'],_0x56f615=await adjustment[_0xf271a4(0x2ca)]({'_id':_0x4f7c8a}),_0x2f5374=_0x56f615[_0xf271a4(0x201)][_0xf271a4(0x222)](async _0x260003=>{var _0x2295ee=_0xf271a4;if(_0x260003[_0x2295ee(0x2b6)]>0x0){const _0x19052b=mongoose[_0x2295ee(0x1f2)]['ObjectId'];var _0x16cf51=await warehouse[_0x2295ee(0x1fc)]([{'$match':{'name':_0x43f6fe,'room':_0x260003['room_names'],'warehouse_category':_0x2295ee(0x2bb)}},{'$unwind':_0x2295ee(0x29d)},{'$match':{'product_details._id':_0x19052b(_0x260003[_0x2295ee(0x268)])}}]),_0x1eae37=0x0;for(let _0x2899dd=0x0;_0x2899dd<=_0x16cf51[_0x2295ee(0x264)]-0x1;_0x2899dd++){const _0x393821=_0x16cf51[_0x2899dd];_0x260003[_0x2295ee(0x266)]=='minus'?(console[_0x2295ee(0x296)]('-'),_0x1eae37=parseFloat(_0x16cf51[_0x2899dd][_0x2295ee(0x1f4)]['product_stock'])-parseFloat(_0x260003[_0x2295ee(0x2b6)])):(console['log']('+'),_0x1eae37=parseFloat(_0x16cf51[_0x2899dd][_0x2295ee(0x1f4)][_0x2295ee(0x2af)])+parseFloat(_0x260003[_0x2295ee(0x2b6)])),await warehouse[_0x2295ee(0x2be)]({'_id':_0x19052b(_0x393821[_0x2295ee(0x255)]['valueOf']()),'product_details._id':_0x19052b(_0x393821['product_details'][_0x2295ee(0x255)])},{'$set':{'product_details.$.product_stock':_0x1eae37,'product_details.$.adj_invoice':_0x56f615['invoice']}}),console[_0x2295ee(0x296)](_0x393821[_0x2295ee(0x255)][_0x2295ee(0x232)]()+_0x2295ee(0x278)+_0x393821['product_details'][_0x2295ee(0x255)]+_0x2295ee(0x278)+_0x1eae37);}}});_0x56f615[_0xf271a4(0x218)]=_0xf271a4(0x251);const _0xa2b067=await _0x56f615[_0xf271a4(0x2b1)](),_0x2f4302=await master_shop[_0xf271a4(0x220)](),_0x48e90f=await email_settings[_0xf271a4(0x265)](),_0x349fc4=await supervisor_settings[_0xf271a4(0x220)]();var _0x1fb4c5=_0x56f615['product'],_0x109520='',_0x2a79b8;for(_0x2a79b8 in _0x1fb4c5){_0x109520+=_0xf271a4(0x2bc)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x263)]+_0xf271a4(0x27c)+_0xf271a4(0x240)+_0x1fb4c5[_0x2a79b8]['product_code']+_0xf271a4(0x27c)+_0xf271a4(0x240)+_0x1fb4c5[_0x2a79b8]['adjust_qty']+_0xf271a4(0x27c)+_0xf271a4(0x240)+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x2a5)]+'</td>'+_0xf271a4(0x240)+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x215)]+_0xf271a4(0x27c)+_0xf271a4(0x240)+_0x56f615[_0xf271a4(0x211)]+_0xf271a4(0x27c)+_0xf271a4(0x240)+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x254)]+_0xf271a4(0x27c)+_0xf271a4(0x240)+_0x1fb4c5[_0x2a79b8]['storage']+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x2cb)]+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x25c)]+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x28c)]+_0x1fb4c5[_0x2a79b8]['type'][0x0]+_0x1fb4c5[_0x2a79b8][_0xf271a4(0x1fb)]+_0xf271a4(0x27c),_0xf271a4(0x250);}let _0x262355=nodemailer[_0xf271a4(0x235)]({'host':_0x48e90f[_0xf271a4(0x2ce)],'port':Number(_0x48e90f[_0xf271a4(0x256)]),'secure':![],'auth':{'user':_0x48e90f[_0xf271a4(0x233)],'pass':_0x48e90f[_0xf271a4(0x241)]}}),_0xa75b77={'from':_0x48e90f['email'],'to':_0x349fc4[0x0][_0xf271a4(0x277)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0xf271a4(0x281)+_0x2f4302[0x0][_0xf271a4(0x245)],'cid':_0xf271a4(0x280)}],'html':_0xf271a4(0x28f)+_0xf271a4(0x25a)+_0xf271a4(0x29f)+_0xf271a4(0x20b)+_0xf271a4(0x293)+_0xf271a4(0x20b)+_0xf271a4(0x2a8)+'</div>'+'<div>'+_0xf271a4(0x242)+_0x2f4302[0x0][_0xf271a4(0x2b0)]+_0xf271a4(0x2cc)+_0xf271a4(0x259)+_0xf271a4(0x259)+_0xf271a4(0x249)+'<div>'+_0xf271a4(0x258)+_0xf271a4(0x299)+_0x56f615[_0xf271a4(0x27e)]+'\x20'+_0xf271a4(0x25b)+_0xf271a4(0x22c)+_0x56f615['date']+'\x20'+'</span>'+_0xf271a4(0x210)+_0xf271a4(0x259)+_0xf271a4(0x2a0)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xf271a4(0x2bc)+_0xf271a4(0x2c0)+_0xf271a4(0x2c1)+_0xf271a4(0x2b4)+_0xf271a4(0x295)+_0xf271a4(0x227)+_0xf271a4(0x276)+_0xf271a4(0x26b)+_0xf271a4(0x2a3)+'</tr>'+'</thead>'+_0xf271a4(0x226)+'\x20'+_0x109520+'\x20'+_0xf271a4(0x26a)+'</table>'+_0xf271a4(0x20b)+_0xf271a4(0x208)+_0xf271a4(0x1ff)+_0x2f4302[0x0][_0xf271a4(0x2b0)]+_0xf271a4(0x210)+_0xf271a4(0x259)+_0xf271a4(0x259)+_0xf271a4(0x291)};_0x262355[_0xf271a4(0x2a4)](_0xa75b77,function(_0x456609,_0x28a657){var _0x38b3a0=_0xf271a4;_0x456609?(console[_0x38b3a0(0x296)](_0x456609),console[_0x38b3a0(0x296)](_0x38b3a0(0x294))):console['log'](_0x38b3a0(0x27d));}),_0x506c02[_0xf271a4(0x2bd)](_0xf271a4(0x20f),'adjustment\x20Finalized\x20successfully'),_0x311147['redirect'](_0xf271a4(0x1fd)+_0xa2b067[_0xf271a4(0x255)]);}catch(_0x159521){console[_0xf271a4(0x296)](_0x159521),_0x311147[_0xf271a4(0x20c)](0xc8)[_0xf271a4(0x212)]({'message':_0x159521['message']});}}),router[a0_0x1d2f3(0x216)]('/view/:id',auth,async(_0x27c13a,_0x2c0a82)=>{var _0x44f72a=a0_0x1d2f3;try{const {username:_0x326212,email:_0x49de60,role:_0x2371c7}=_0x27c13a['user'],_0x1265be=_0x27c13a[_0x44f72a(0x1f6)],_0x87c779=await profile[_0x44f72a(0x265)]({'email':_0x1265be[_0x44f72a(0x233)]}),_0x19f27c=await master_shop[_0x44f72a(0x220)](),_0x5a349c=_0x27c13a[_0x44f72a(0x24e)]['id'],_0xac0bda=await adjustment['findById']({'_id':_0x5a349c}),_0x1f494b=await purchases[_0x44f72a(0x1fc)]([{'$match':{'warehouse_name':_0xac0bda[_0x44f72a(0x211)]}},{'$unwind':_0x44f72a(0x1fe)},{'$group':{'_id':'$product.product_name'}}]),_0x3ac448=await product[_0x44f72a(0x220)]({}),_0xa79ca0=await warehouse[_0x44f72a(0x1fc)]([{'$match':{'name':_0xac0bda[_0x44f72a(0x211)]}},{'$unwind':_0x44f72a(0x29d)},{'$group':{'_id':_0x44f72a(0x21d),'name':{'$first':_0x44f72a(0x275)},'product_stock':{'$first':_0x44f72a(0x2ba)},'bay':{'$first':_0x44f72a(0x1f7)},'bin':{'$first':_0x44f72a(0x279)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x44f72a(0x2c4)},'primary_code':{'$first':_0x44f72a(0x1f5)},'secondary_code':{'$first':_0x44f72a(0x2c8)},'product_code':{'$first':_0x44f72a(0x217)},'storage':{'$first':_0x44f72a(0x28b)},'rack':{'$first':_0x44f72a(0x24d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x44f72a(0x2a1)},'production_date':{'$first':_0x44f72a(0x272)},'batch_code':{'$first':_0x44f72a(0x22a)},'room':{'$first':_0x44f72a(0x2c6)}}}]);let _0x23ba8b;if(_0x1265be[_0x44f72a(0x2c7)]==_0x44f72a(0x21f)){const _0x567d32=await staff[_0x44f72a(0x265)]({'email':_0x1265be[_0x44f72a(0x233)]});_0x23ba8b=await warehouse[_0x44f72a(0x1fc)]([{'$match':{'status':'Enabled','name':_0x567d32[_0x44f72a(0x273)],'warehouse_category':_0x44f72a(0x2bb),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x44f72a(0x22b),'name':{'$first':_0x44f72a(0x22b)}}}]);}else _0x23ba8b=await warehouse[_0x44f72a(0x1fc)]([{'$match':{'status':_0x44f72a(0x23d),'warehouse_category':_0x44f72a(0x2bb),'name':{'$ne':_0x44f72a(0x228)}}},{'$group':{'_id':_0x44f72a(0x22b),'name':{'$first':_0x44f72a(0x22b)}}}]);if(_0x19f27c[0x0][_0x44f72a(0x26d)]==_0x44f72a(0x2ad)){var _0x49eb81=users['English'];console[_0x44f72a(0x296)](_0x49eb81);}else{if(_0x19f27c[0x0][_0x44f72a(0x26d)]=='Hindi')var _0x49eb81=users[_0x44f72a(0x203)];else{if(_0x19f27c[0x0][_0x44f72a(0x26d)]=='German')var _0x49eb81=users[_0x44f72a(0x23a)];else{if(_0x19f27c[0x0][_0x44f72a(0x26d)]==_0x44f72a(0x29a))var _0x49eb81=users[_0x44f72a(0x29a)];else{if(_0x19f27c[0x0][_0x44f72a(0x26d)]==_0x44f72a(0x234))var _0x49eb81=users[_0x44f72a(0x234)];else{if(_0x19f27c[0x0][_0x44f72a(0x26d)]==_0x44f72a(0x24a))var _0x49eb81=users[_0x44f72a(0x253)];else{if(_0x19f27c[0x0][_0x44f72a(0x26d)]=='Chinese')var _0x49eb81=users[_0x44f72a(0x209)];else{if(_0x19f27c[0x0][_0x44f72a(0x26d)]=='Arabic\x20(ae)')var _0x49eb81=users[_0x44f72a(0x223)];}}}}}}}_0x2c0a82[_0x44f72a(0x23e)](_0x44f72a(0x2ae),{'success':_0x27c13a[_0x44f72a(0x2bd)](_0x44f72a(0x20f)),'errors':_0x27c13a['flash'](_0x44f72a(0x229)),'role':_0x1265be,'profile':_0x87c779,'adjustment':_0xac0bda,'stock':_0xa79ca0,'master_shop':_0x19f27c,'warehouse_name':_0x1f494b,'unit':_0x3ac448,'language':_0x49eb81,'warehouse':_0x23ba8b});}catch(_0x3de1bb){console[_0x44f72a(0x296)](_0x3de1bb),_0x2c0a82[_0x44f72a(0x20c)](0xc8)[_0x44f72a(0x212)]({'message':_0x3de1bb[_0x44f72a(0x21b)]});}}),router['post'](a0_0x1d2f3(0x2a6),auth,async(_0x2aca44,_0x4c6f58)=>{var _0x152089=a0_0x1d2f3;try{const _0x15fbb1=_0x2aca44[_0x152089(0x24e)]['id'],_0x355f99=await adjustment[_0x152089(0x2ca)]({'_id':_0x15fbb1}),_0x49ecf5=await warehouse[_0x152089(0x265)]({'name':_0x355f99[_0x152089(0x211)],'room':_0x355f99['room']}),{warehouse_name:_0x27a598,date:_0x122307,prod_name:_0x4c51d0,level:_0x208bee,isle:_0x307ca0,pallet:_0x2e6af9,stock:_0x2a02df,types:_0x3510d7,adjust_qty:_0x53cd57,new_adjust_qty:_0x5f0610,note:_0x39f7c6,Room_name:_0x18200e,invoice:_0x291559,JO_number:_0x48efb9,expiry_date:_0x536020}=_0x2aca44[_0x152089(0x25d)];if(typeof _0x4c51d0=='string')var _0x55e6c3=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x2aa)]],_0x37a745=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x292)]],_0x6f44c7=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x224)]],_0x4f7818=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x266)]],_0x59f6b2=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x246)]],_0x417df7=[_0x2aca44[_0x152089(0x25d)]['New_Qty_Converted']],_0x3dbdc8=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x2ab)]],_0x26069a=[_0x2aca44['body'][_0x152089(0x207)]],_0x2ee616=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x213)]],_0x272fe0=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x206)]],_0x3d47fc=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x27f)]],_0x217ec9=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x29e)]],_0x373f05=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x2b5)]],_0x1649bc=[_0x2aca44[_0x152089(0x25d)]['prod_cat']],_0x1f3342=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x238)]],_0x1ad8d8=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x2c5)]],_0xc7b9ee=[_0x2aca44[_0x152089(0x25d)][_0x152089(0x283)]];else var _0x55e6c3=[..._0x2aca44['body'][_0x152089(0x2aa)]],_0x37a745=[..._0x2aca44['body'][_0x152089(0x292)]],_0x6f44c7=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x224)]],_0x4f7818=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x266)]],_0x59f6b2=[..._0x2aca44['body']['New_Qty_Converted_adj']],_0x417df7=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x2c3)]],_0x3dbdc8=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x2a5)]],_0x26069a=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x207)]],_0x2ee616=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x213)]],_0x272fe0=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x206)]],_0x3d47fc=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x27f)]],_0x217ec9=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x29e)]],_0x373f05=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x2b5)]],_0x1649bc=[..._0x2aca44[_0x152089(0x25d)][_0x152089(0x1f9)]],_0x1f3342=[..._0x2aca44[_0x152089(0x25d)]['Rooms']],_0x1ad8d8=[..._0x2aca44[_0x152089(0x25d)]['prime1']],_0xc7b9ee=[..._0x2aca44[_0x152089(0x25d)]['second1']];const _0x59c39b=_0x55e6c3[_0x152089(0x222)](_0x2ad321=>{return _0x2ad321={'product_name':_0x2ad321};});_0x37a745[_0x152089(0x28a)]((_0x4ad994,_0x3be66e)=>{_0x1f3342['forEach']((_0x4f80e4,_0x25ac11)=>{var _0x49077a=a0_0x58bc;if(_0x4f80e4=='Receiving\x20Area'&&_0x3be66e==_0x25ac11){var _0x379529=_0x4ad994[_0x49077a(0x20e)](0x3);_0x59c39b[_0x3be66e][_0x49077a(0x297)]=_0x4ad994[0x0],_0x59c39b[_0x3be66e][_0x49077a(0x2cb)]=_0x4ad994[0x1],_0x59c39b[_0x3be66e][_0x49077a(0x25c)]=0x0,_0x59c39b[_0x3be66e]['bin']=0x0,_0x59c39b[_0x3be66e][_0x49077a(0x243)]=_0x49077a(0x248),_0x59c39b[_0x3be66e][_0x49077a(0x1fb)]=_0x379529;}else{if(_0x4f80e4==_0x49077a(0x225)&&_0x3be66e==_0x25ac11){var _0x379529=_0x4ad994['slice'](0x3);_0x59c39b[_0x3be66e][_0x49077a(0x297)]=_0x4ad994[0x0],_0x59c39b[_0x3be66e][_0x49077a(0x2cb)]=_0x4ad994[0x1],_0x59c39b[_0x3be66e][_0x49077a(0x25c)]=0x0,_0x59c39b[_0x3be66e][_0x49077a(0x28c)]=0x0,_0x59c39b[_0x3be66e][_0x49077a(0x243)]=_0x49077a(0x248),_0x59c39b[_0x3be66e][_0x49077a(0x1fb)]=_0x4ad994[0x5];}else{if(_0x3be66e==_0x25ac11){var _0x1b78a2;if(_0x4ad994[0x4]=='L')_0x1b78a2=_0x49077a(0x21c);else _0x4ad994[0x4]=='F'&&(_0x1b78a2='Floor');_0x59c39b[_0x3be66e][_0x49077a(0x297)]=_0x4ad994[0x0],_0x59c39b[_0x3be66e][_0x49077a(0x2cb)]=_0x4ad994[0x1],_0x59c39b[_0x3be66e]['bay']=_0x4ad994[0x2],_0x59c39b[_0x3be66e][_0x49077a(0x28c)]=_0x4ad994[0x3],_0x59c39b[_0x3be66e][_0x49077a(0x243)]=_0x1b78a2,_0x59c39b[_0x3be66e]['floorlevel']=_0x4ad994[0x5];}}}});}),_0x6f44c7[_0x152089(0x28a)]((_0x51bddf,_0x224551)=>{var _0x2230e4=_0x152089;_0x59c39b[_0x224551][_0x2230e4(0x28e)]=_0x51bddf;}),_0x4f7818[_0x152089(0x28a)]((_0x27f4d1,_0x4d335f)=>{var _0x3cc98b=_0x152089;_0x59c39b[_0x4d335f][_0x3cc98b(0x266)]=_0x27f4d1;}),_0x59f6b2['forEach']((_0x2a3e09,_0x48772c)=>{var _0x3e19ac=_0x152089;_0x59c39b[_0x48772c][_0x3e19ac(0x2b6)]=_0x2a3e09;}),_0x417df7[_0x152089(0x28a)]((_0x4e2202,_0x527c0a)=>{var _0x3e2190=_0x152089;_0x59c39b[_0x527c0a][_0x3e2190(0x24f)]=_0x4e2202;}),_0x3dbdc8[_0x152089(0x28a)]((_0x1d3398,_0x38d400)=>{var _0x182af6=_0x152089;_0x59c39b[_0x38d400][_0x182af6(0x2a5)]=_0x1d3398;}),_0x26069a[_0x152089(0x28a)]((_0x4ad434,_0x222002)=>{var _0x24f885=_0x152089;_0x59c39b[_0x222002][_0x24f885(0x215)]=_0x4ad434;}),_0x2ee616[_0x152089(0x28a)]((_0x50daca,_0x703ea7)=>{var _0x5385ce=_0x152089;_0x59c39b[_0x703ea7][_0x5385ce(0x261)]=_0x50daca;}),_0x272fe0[_0x152089(0x28a)]((_0x320900,_0x462fba)=>{var _0x1137cd=_0x152089;_0x59c39b[_0x462fba][_0x1137cd(0x206)]=_0x320900;}),_0x3d47fc['forEach']((_0x37a132,_0xb87e13)=>{var _0x504999=_0x152089;_0x59c39b[_0xb87e13][_0x504999(0x27f)]=_0x37a132;}),_0x217ec9[_0x152089(0x28a)]((_0x3e7016,_0x268861)=>{var _0x5f3e62=_0x152089;_0x59c39b[_0x268861][_0x5f3e62(0x20d)]=_0x3e7016;}),_0x373f05[_0x152089(0x28a)]((_0x1fe0b9,_0x58a5a2)=>{var _0x31702d=_0x152089;_0x59c39b[_0x58a5a2][_0x31702d(0x2b5)]=_0x1fe0b9;}),_0x1649bc['forEach']((_0x226b60,_0x1e7d6f)=>{var _0x519347=_0x152089;_0x59c39b[_0x1e7d6f][_0x519347(0x1f9)]=_0x226b60;}),_0x1f3342[_0x152089(0x28a)]((_0xdbd030,_0x16027d)=>{var _0xf18cff=_0x152089;_0x59c39b[_0x16027d][_0xf18cff(0x254)]=_0xdbd030;}),_0x1ad8d8[_0x152089(0x28a)]((_0x398613,_0x3fff09)=>{var _0x5aa1cc=_0x152089;_0x59c39b[_0x3fff09][_0x5aa1cc(0x28d)]=_0x398613;}),_0xc7b9ee[_0x152089(0x28a)]((_0x13f1cf,_0x21655d)=>{var _0x17a78f=_0x152089;_0x59c39b[_0x21655d][_0x17a78f(0x284)]=_0x13f1cf;});const _0x5e2f25=_0x59c39b[_0x152089(0x2cd)](_0x4b9162=>_0x4b9162[_0x152089(0x2b6)]!=='0'&&_0x4b9162[_0x152089(0x2b6)]!=='');var _0x1b5e5e=0x0;_0x5e2f25[_0x152089(0x28a)](_0x4f7bbd=>{var _0x3e418e=_0x152089;console[_0x3e418e(0x296)]('foreach\x20newproduct',_0x4f7bbd),parseInt(_0x4f7bbd[_0x3e418e(0x2b6)])<=0x0&&_0x1b5e5e++;});if(_0x1b5e5e!=0x0)return _0x2aca44[_0x152089(0x2bd)]('errors',_0x152089(0x269)),_0x4c6f58[_0x152089(0x288)](_0x152089(0x231));_0x355f99[_0x152089(0x211)]=_0x27a598,_0x355f99['date']=_0x122307,_0x355f99['product']=_0x5e2f25,_0x355f99['note']=_0x39f7c6,_0x355f99['invoice']=_0x291559,_0x355f99[_0x152089(0x282)]=_0x152089(0x23b);const _0x418f4c=await _0x355f99[_0x152089(0x2b1)]();_0x2aca44[_0x152089(0x2bd)]('success',_0x152089(0x221)),_0x4c6f58[_0x152089(0x288)](_0x152089(0x271));}catch(_0x4d856f){console[_0x152089(0x296)](_0x4d856f);}}),router['post']('/barcode_scanner',async(_0x436727,_0x1e9c6c)=>{var _0x4b6a9e=a0_0x1d2f3;const {primary_code:_0x5d5a59,warehouse_data:_0x39f27b,rooms_data:_0x332845,Roomslist:_0x2ea1b1}=_0x436727['body'],_0x2df7ec=_0x2ea1b1[_0x4b6a9e(0x239)](','),_0x3034e5=[];async function _0x29ff9b(_0x1a77d9){var _0x51e0d4=_0x4b6a9e;const _0x25f022=await warehouse[_0x51e0d4(0x1fc)]([{'$match':{'name':_0x39f27b,'room':_0x1a77d9}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5d5a59}},{'$group':{'_id':_0x51e0d4(0x21d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x51e0d4(0x2ba)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x51e0d4(0x217)},'level':{'$first':_0x51e0d4(0x1f7)},'isle':{'$first':_0x51e0d4(0x279)},'type':{'$first':_0x51e0d4(0x25f)},'pallet':{'$first':_0x51e0d4(0x2c4)},'unit':{'$first':_0x51e0d4(0x252)},'secondary_unit':{'$first':_0x51e0d4(0x22d)},'storage':{'$first':_0x51e0d4(0x28b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x51e0d4(0x2a1)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x51e0d4(0x200)},'batch_code':{'$first':_0x51e0d4(0x22a)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x51e0d4(0x2c6)},'invoice':{'$first':_0x51e0d4(0x274)}}}]),_0x32d335=await warehouse[_0x51e0d4(0x1fc)]([{'$match':{'name':_0x39f27b,'room':_0x1a77d9}},{'$unwind':_0x51e0d4(0x29d)},{'$match':{'product_details.secondary_code':_0x5d5a59}},{'$group':{'_id':_0x51e0d4(0x21d),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x51e0d4(0x2ba)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x51e0d4(0x2c8)},'product_code':{'$first':_0x51e0d4(0x217)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x51e0d4(0x279)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x51e0d4(0x2c4)},'unit':{'$first':_0x51e0d4(0x252)},'secondary_unit':{'$first':_0x51e0d4(0x22d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x51e0d4(0x2a1)},'production_date':{'$first':_0x51e0d4(0x272)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x51e0d4(0x22a)},'product_cat':{'$first':_0x51e0d4(0x21e)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x51e0d4(0x2c6)}}}]);if(_0x25f022[_0x51e0d4(0x264)]>0x0)_0x3034e5[_0x51e0d4(0x205)](_0x25f022);else _0x32d335[_0x51e0d4(0x264)]>0x0&&_0x3034e5[_0x51e0d4(0x205)](_0x32d335);}const _0x1f37d6=_0x2df7ec[_0x4b6a9e(0x222)](_0xb1ea19=>_0x29ff9b(_0xb1ea19));await Promise['all'](_0x1f37d6),_0x1e9c6c[_0x4b6a9e(0x212)](_0x3034e5);}),router['post'](a0_0x1d2f3(0x26e),async(_0x2e5b2a,_0xa5dc0f)=>{var _0x40c40e=a0_0x1d2f3;const {primaryCode:_0x3fd778,secondaryCode:_0x5de631,productCode:_0x5cc0ab,level:_0x8b004,isle:_0x383242,pallet:_0x402cf0,warehouses:_0x6b248e,room:_0x47519f}=_0x2e5b2a[_0x40c40e(0x25d)];try{const _0x118b5d=await warehouse[_0x40c40e(0x1fc)]([{'$match':{'name':_0x6b248e,'room':_0x47519f}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x8b004),'product_details.isle':_0x383242,'product_details.pallet':parseInt(_0x402cf0)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x40c40e(0x275)},'product_stock':{'$first':_0x40c40e(0x2ba)},'level':{'$first':_0x40c40e(0x230)},'isle':{'$first':_0x40c40e(0x1f8)},'pallet':{'$first':_0x40c40e(0x23c)},'maxProducts':{'$first':_0x40c40e(0x27a)}}}]);_0xa5dc0f[_0x40c40e(0x20c)](0xc8)[_0x40c40e(0x212)](_0x118b5d);}catch(_0x2258ce){_0xa5dc0f[_0x40c40e(0x20c)](0x194)['json']({'message':_0x2258ce['message']});}}),module['exports']=router;