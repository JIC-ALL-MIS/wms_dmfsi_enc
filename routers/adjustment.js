var a0_0x48e576=a0_0x2fca;(function(_0x52282b,_0x48497c){var _0x4ec2de=a0_0x2fca,_0x1de71e=_0x52282b();while(!![]){try{var _0xfe59b7=-parseInt(_0x4ec2de(0x112))/0x1*(parseInt(_0x4ec2de(0x124))/0x2)+-parseInt(_0x4ec2de(0xff))/0x3+-parseInt(_0x4ec2de(0x127))/0x4+parseInt(_0x4ec2de(0xbb))/0x5*(parseInt(_0x4ec2de(0xc7))/0x6)+-parseInt(_0x4ec2de(0x105))/0x7*(parseInt(_0x4ec2de(0x6f))/0x8)+parseInt(_0x4ec2de(0xe0))/0x9+-parseInt(_0x4ec2de(0x110))/0xa*(-parseInt(_0x4ec2de(0xde))/0xb);if(_0xfe59b7===_0x48497c)break;else _0x1de71e['push'](_0x1de71e['shift']());}catch(_0x1de1e9){_0x1de71e['push'](_0x1de71e['shift']());}}}(a0_0x61b8,0x89312));function a0_0x2fca(_0x5e6e51,_0x5c7199){var _0x61b813=a0_0x61b8();return a0_0x2fca=function(_0x2fca98,_0x4f3dd0){_0x2fca98=_0x2fca98-0x6e;var _0x318fcb=_0x61b813[_0x2fca98];return _0x318fcb;},a0_0x2fca(_0x5e6e51,_0x5c7199);}function a0_0x61b8(){var _0x391004=['Enclosed','room','<div>','$product_details.product_cat','$product.room_names','20XXdhNK','role','1iIhoaN','sendMail','False','Enabled','date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.production_date','save','$product_details.invoice','adjustment\x20data\x20update\x20successfully','redirect','prod_code','map','$product_details.bay','message','English','English\x20(US)','back','534902zRVKLN','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','New_Qty_Converted','1632728NBlSEE','adjustment\x20add\x20successfull','type','German','/adjustment/view','Logo.png','post','rack','$product_details.rack','params','$product_details.floorlevel','<!DOCTYPE\x20html>','max_per_unit','master','stockBefore','room_names','Floor','bay','exports','express','<table\x20style=\x22width:\x20100%\x20!important;\x22>','add_adjustment','$room','errors','findOne','160696gjbguH','Primary_Units','all','Portuguese','product','<h2>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$invoice','../middleware/auth','_id','/preview/:id','$product_details.level','secondary_unit','Rooms','secondary_code','$product.product_name','</span>','$finalize','storage','flash','</body></html>','True','stock','Level','Arabic\x20(ae)','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','product_code','filter','$product_details','unit','production_date','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Email\x20sent\x20successfully','expiry_date','$product_details.secondary_code','push','floor','$product_details.pallet','</div>','adjustment\x20Finalized\x20successfully','Chinese','Raw\x20Materials','Portuguese\x20(BR)','bin','French','foreach\x20newproduct','</tr>','port','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','edit_adjustment','batch_code','aggregate','Spanish','prod_name','forEach','render','padStart','$product','/../public','length','$product_details.bin','log','Return\x20Goods','adjust_qty','warehouse_name','Hindi','$product_details.primary_code','prod_invoice','product_details','status','prod_cat','\x20<>\x20','</td>','json','../models/all_models','Router','24595zgeGZN','warehouse','product_stock','findById','New_Qty_Converted_adj','/view/:id','</tbody>','createTransport','/view','site_title','invoice','primary_code','162XjFkiL','random','<h5>','$product_details.isle','\x20Order\x20Date\x20:\x20','valueOf','level','<tr>','Arabic','get','email','string','language','second1','staff','slice','/barcode_scanner','/upload/','</h5>','/view/add_adjustment','ADJ-','$name','<h5\x20style=\x22text-align:\x20left;\x22>','10746714JRovJW','id_transaction','1518291sKHMbr','$date','Secondary_units','prime1','password','mongoose','$product_details.expiry_date','$product_details.batch_code','$product_details.maxPerUnit','ObjectId','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','types','$product_details.storage','$product_details.product_stock','$product_details.unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<hr\x20class=\x22my-3\x22>','image','</table>','success','minus','$product_details.product_name','floorlevel','Shelves','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','find','/picking_list/PDF_adjustment_rm/','<strong>\x20Regards\x20</strong>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','462444DIuTfT','body','new_adjust_qty','$product_details._id','\x20</h2>','id_transaction_from','301cBLqjn','$product_details.type','user','<span\x20style=\x22float:\x20right;\x22>','product_name','$product_details.product_code'];a0_0x61b8=function(){return _0x391004;};return a0_0x61b8();}const express=require(a0_0x48e576(0x13a)),app=express(),router=express[a0_0x48e576(0xba)](),auth=require(a0_0x48e576(0x77)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x48e576(0xb9)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer'),mongoose=require(a0_0x48e576(0xe5));router[a0_0x48e576(0xd0)](a0_0x48e576(0xc3),auth,async(_0x446129,_0x440e15)=>{var _0x2dd1cb=a0_0x48e576;try{const {username:_0x317c82,email:_0x237437,role:_0x1d252c}=_0x446129[_0x2dd1cb(0x107)],_0xbb256c=_0x446129[_0x2dd1cb(0x107)],_0x48e229=await profile['findOne']({'email':_0xbb256c[_0x2dd1cb(0xd1)]}),_0x32cf4c=await master_shop[_0x2dd1cb(0xfb)]();console[_0x2dd1cb(0xac)](_0x2dd1cb(0x134),_0x32cf4c);let _0x2a381d;if(_0xbb256c[_0x2dd1cb(0x111)]=='staff'){const _0x319779=await staff[_0x2dd1cb(0x6e)]({'email':_0xbb256c[_0x2dd1cb(0xd1)]});_0x2a381d=await warehouse['find']({'status':_0x2dd1cb(0x115),'name':_0x319779[_0x2dd1cb(0xbc)]});}else _0x2a381d=await warehouse[_0x2dd1cb(0xfb)]({'status':'Enabled'});const _0xf17385=await product['find']();let _0x13c7eb;if(_0xbb256c['role']==_0x2dd1cb(0xd5)){const _0xa34b6c=await staff['findOne']({'email':_0xbb256c['email']});_0x13c7eb=await adjustment[_0x2dd1cb(0xfb)]({'warehouse_name':_0xa34b6c[_0x2dd1cb(0xbc)]});}else _0x13c7eb=await adjustment[_0x2dd1cb(0xa2)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x2dd1cb(0x76)},'date':{'$first':_0x2dd1cb(0xe1)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x2dd1cb(0x10f)},'finalize':{'$first':_0x2dd1cb(0x80)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x32cf4c[0x0][_0x2dd1cb(0xd3)]==_0x2dd1cb(0x122)){var _0x461ff4=users[_0x2dd1cb(0x121)];console[_0x2dd1cb(0xac)](_0x461ff4);}else{if(_0x32cf4c[0x0][_0x2dd1cb(0xd3)]==_0x2dd1cb(0xb0))var _0x461ff4=users[_0x2dd1cb(0xb0)];else{if(_0x32cf4c[0x0]['language']==_0x2dd1cb(0x12a))var _0x461ff4=users[_0x2dd1cb(0x12a)];else{if(_0x32cf4c[0x0]['language']==_0x2dd1cb(0xa3))var _0x461ff4=users['Spanish'];else{if(_0x32cf4c[0x0][_0x2dd1cb(0xd3)]==_0x2dd1cb(0x9b))var _0x461ff4=users[_0x2dd1cb(0x9b)];else{if(_0x32cf4c[0x0]['language']==_0x2dd1cb(0x99))var _0x461ff4=users['Portuguese'];else{if(_0x32cf4c[0x0][_0x2dd1cb(0xd3)]==_0x2dd1cb(0x97))var _0x461ff4=users[_0x2dd1cb(0x97)];else{if(_0x32cf4c[0x0][_0x2dd1cb(0xd3)]==_0x2dd1cb(0x87))var _0x461ff4=users[_0x2dd1cb(0xcf)];}}}}}}}_0x440e15[_0x2dd1cb(0xa6)]('adjustment',{'success':_0x446129['flash'](_0x2dd1cb(0xf4)),'errors':_0x446129[_0x2dd1cb(0x82)](_0x2dd1cb(0x13e)),'role':_0xbb256c,'profile':_0x48e229,'warehouse':_0x2a381d,'product':_0xf17385,'adjustment':_0x13c7eb,'master_shop':_0x32cf4c,'language':_0x461ff4});}catch(_0x2d278f){console['log'](_0x2d278f);}});async function getRandom8DigitNumber(){var _0x51bf90=a0_0x48e576;const _0xfd396=0x989680,_0x33f575=0x5f5e0ff,_0x3ae584=Math[_0x51bf90(0x93)](Math[_0x51bf90(0xc8)]()*(_0x33f575-_0xfd396+0x1))+_0xfd396;var _0x4eb6fb;const _0x225df1=await adjustment[_0x51bf90(0x6e)]({'invoice':_0x51bf90(0xdb)+_0x3ae584});return _0x225df1&&_0x225df1[_0x51bf90(0xaa)]>0x0?_0x4eb6fb=_0x51bf90(0xdb)+_0x3ae584:_0x4eb6fb=_0x51bf90(0xdb)+_0x3ae584,_0x4eb6fb;}router['get'](a0_0x48e576(0xda),auth,async(_0x1aa8da,_0x256493)=>{var _0x54dd4e=a0_0x48e576;try{const {username:_0x2bc81a,email:_0x4bd477,role:_0x3746d4}=_0x1aa8da[_0x54dd4e(0x107)],_0x2b8a09=_0x1aa8da[_0x54dd4e(0x107)],_0x1cc89f=await profile[_0x54dd4e(0x6e)]({'email':_0x2b8a09[_0x54dd4e(0xd1)]}),_0x5b558b=await master_shop[_0x54dd4e(0xfb)]();let _0x297259;if(_0x2b8a09[_0x54dd4e(0x111)]==_0x54dd4e(0xd5)){const _0x467974=await staff[_0x54dd4e(0x6e)]({'email':_0x2b8a09[_0x54dd4e(0xd1)]});_0x297259=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x467974[_0x54dd4e(0xbc)],'warehouse_category':_0x54dd4e(0x98),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x54dd4e(0xdc),'name':{'$first':_0x54dd4e(0xdc)}}}]);}else _0x297259=await warehouse['aggregate']([{'$match':{'status':_0x54dd4e(0x115),'warehouse_category':_0x54dd4e(0x98),'name':{'$ne':_0x54dd4e(0xad)}}},{'$group':{'_id':_0x54dd4e(0xdc),'name':{'$first':_0x54dd4e(0xdc)}}}]);const _0x26557b=await product[_0x54dd4e(0xfb)]({}),_0x2db469=await adjustment[_0x54dd4e(0xfb)]({}),_0x4cc4cd=_0x2db469[_0x54dd4e(0xaa)]+0x1,_0xb10077=_0x54dd4e(0xdb)+_0x4cc4cd['toString']()[_0x54dd4e(0xa7)](0x5,'0');var _0x32da98=['Ambient',_0x54dd4e(0x10b),'Return\x20Rooms'];if(_0x5b558b[0x0][_0x54dd4e(0xd3)]==_0x54dd4e(0x122))var _0x3554f0=users[_0x54dd4e(0x121)];else{if(_0x5b558b[0x0][_0x54dd4e(0xd3)]==_0x54dd4e(0xb0))var _0x3554f0=users['Hindi'];else{if(_0x5b558b[0x0][_0x54dd4e(0xd3)]=='German')var _0x3554f0=users[_0x54dd4e(0x12a)];else{if(_0x5b558b[0x0][_0x54dd4e(0xd3)]==_0x54dd4e(0xa3))var _0x3554f0=users[_0x54dd4e(0xa3)];else{if(_0x5b558b[0x0][_0x54dd4e(0xd3)]=='French')var _0x3554f0=users[_0x54dd4e(0x9b)];else{if(_0x5b558b[0x0][_0x54dd4e(0xd3)]==_0x54dd4e(0x99))var _0x3554f0=users[_0x54dd4e(0x72)];else{if(_0x5b558b[0x0][_0x54dd4e(0xd3)]==_0x54dd4e(0x97))var _0x3554f0=users[_0x54dd4e(0x97)];else{if(_0x5b558b[0x0][_0x54dd4e(0xd3)]==_0x54dd4e(0x87))var _0x3554f0=users['Arabic'];}}}}}}}const _0x32774c=getRandom8DigitNumber();_0x32774c['then'](_0x561c5e=>{var _0x2b8228=_0x54dd4e;_0x256493[_0x2b8228(0xa6)](_0x2b8228(0x13c),{'success':_0x1aa8da[_0x2b8228(0x82)]('success'),'errors':_0x1aa8da[_0x2b8228(0x82)](_0x2b8228(0x13e)),'role':_0x2b8a09,'profile':_0x1cc89f,'warehouse':_0x297259,'product':_0x26557b,'master_shop':_0x5b558b,'language':_0x3554f0,'rooms_data':_0x32da98,'invoice_no':_0x561c5e});})['catch'](_0xb8edcf=>{var _0xeaf68b=_0x54dd4e;_0x1aa8da[_0xeaf68b(0x82)](_0xeaf68b(0x13e),_0xeaf68b(0x8e)),_0x256493[_0xeaf68b(0x11c)]('/adjustment/view');});}catch(_0x1d9578){console[_0x54dd4e(0xac)](_0x1d9578);}}),router[a0_0x48e576(0x12d)](a0_0x48e576(0xda),auth,async(_0x568797,_0xe56b9e)=>{var _0x38d877=a0_0x48e576;try{const {warehouse_name:_0x35ac55,date:_0x57cff4,prod_name:_0x488128,level:_0x23c556,isle:_0x4cdb3d,pallet:_0x1b81f8,stock:_0x2311c8,types:_0xe0f75,adjust_qty:_0x4968c5,new_adjust_qty:_0x5a7287,note:_0x5a3aec,Room_name:_0x101334,invoice:_0x3a2319,JO_number:_0x297ebf,expiry_date:_0x59259a}=_0x568797['body'];if(typeof _0x488128==_0x38d877(0xd2))var _0xd92af9=[_0x568797[_0x38d877(0x100)][_0x38d877(0xa4)]],_0x321251=[_0x568797[_0x38d877(0x100)][_0x38d877(0xcd)]],_0x4bbdf9=[_0x568797[_0x38d877(0x100)][_0x38d877(0x85)]],_0x3eff16=[_0x568797[_0x38d877(0x100)]['types']],_0xbda37d=[_0x568797[_0x38d877(0x100)][_0x38d877(0xbf)]],_0x4e710f=[_0x568797[_0x38d877(0x100)][_0x38d877(0x126)]],_0x551709=[_0x568797[_0x38d877(0x100)][_0x38d877(0x70)]],_0x5158ea=[_0x568797[_0x38d877(0x100)][_0x38d877(0xe2)]],_0x7397a6=[_0x568797[_0x38d877(0x100)][_0x38d877(0x11d)]],_0x5d3155=[_0x568797['body']['batch_code']],_0x42ede3=[_0x568797[_0x38d877(0x100)][_0x38d877(0x90)]],_0x1133d6=[_0x568797[_0x38d877(0x100)]['max_per_unit']],_0x52907c=[_0x568797[_0x38d877(0x100)][_0x38d877(0x8d)]],_0x1cbce8=[_0x568797['body'][_0x38d877(0xb5)]],_0xd736b9=[_0x568797['body'][_0x38d877(0x7c)]],_0x45b918=[_0x568797[_0x38d877(0x100)][_0x38d877(0xe3)]],_0x41c0ec=[_0x568797[_0x38d877(0x100)][_0x38d877(0xd4)]],_0x140a3a=[_0x568797[_0x38d877(0x100)][_0x38d877(0xb2)]],_0x3af546=[_0x568797['body'][_0x38d877(0xdf)]];else var _0xd92af9=[..._0x568797[_0x38d877(0x100)][_0x38d877(0xa4)]],_0x321251=[..._0x568797['body'][_0x38d877(0xcd)]],_0x4bbdf9=[..._0x568797[_0x38d877(0x100)][_0x38d877(0x85)]],_0x3eff16=[..._0x568797[_0x38d877(0x100)][_0x38d877(0xec)]],_0xbda37d=[..._0x568797['body']['New_Qty_Converted_adj']],_0x4e710f=[..._0x568797[_0x38d877(0x100)][_0x38d877(0x126)]],_0x551709=[..._0x568797[_0x38d877(0x100)]['unit']],_0x5158ea=[..._0x568797[_0x38d877(0x100)][_0x38d877(0xe2)]],_0x7397a6=[..._0x568797[_0x38d877(0x100)]['prod_code']],_0x5d3155=[..._0x568797[_0x38d877(0x100)][_0x38d877(0xa1)]],_0x42ede3=[..._0x568797[_0x38d877(0x100)]['expiry_date']],_0x1133d6=[..._0x568797['body'][_0x38d877(0x133)]],_0x52907c=[..._0x568797[_0x38d877(0x100)]['production_date']],_0x1cbce8=[..._0x568797[_0x38d877(0x100)][_0x38d877(0xb5)]],_0xd736b9=[..._0x568797[_0x38d877(0x100)][_0x38d877(0x7c)]],_0x45b918=[..._0x568797[_0x38d877(0x100)][_0x38d877(0xe3)]],_0x41c0ec=[..._0x568797[_0x38d877(0x100)][_0x38d877(0xd4)]],_0x140a3a=[..._0x568797[_0x38d877(0x100)]['prod_invoice']],_0x3af546=[..._0x568797['body'][_0x38d877(0xdf)]];const _0x127b04=_0xd92af9['map'](_0xbd4e8b=>{return _0xbd4e8b={'product_name':_0xbd4e8b};});_0x321251[_0x38d877(0xa5)]((_0x474cc6,_0x4e39e8)=>{var _0x18788d=_0x38d877;_0xd736b9[_0x18788d(0xa5)]((_0x3bb152,_0x36c382)=>{var _0x431b69=_0x18788d;if(_0x3bb152=='Receiving\x20Area'&&_0x4e39e8==_0x36c382){var _0x248017=_0x474cc6[_0x431b69(0xd6)](0x3);_0x127b04[_0x4e39e8][_0x431b69(0x81)]=_0x474cc6[0x0],_0x127b04[_0x4e39e8][_0x431b69(0x12e)]=_0x474cc6[0x1],_0x127b04[_0x4e39e8][_0x431b69(0x138)]=0x0,_0x127b04[_0x4e39e8][_0x431b69(0x9a)]=0x0,_0x127b04[_0x4e39e8]['type']=_0x431b69(0x137),_0x127b04[_0x4e39e8]['floorlevel']=_0x248017;}else{if(_0x3bb152==_0x431b69(0xf8)&&_0x4e39e8==_0x36c382){var _0x248017=_0x474cc6['slice'](0x3);_0x127b04[_0x4e39e8][_0x431b69(0x81)]=_0x474cc6[0x0],_0x127b04[_0x4e39e8]['rack']=_0x474cc6[0x1],_0x127b04[_0x4e39e8][_0x431b69(0x138)]=0x0,_0x127b04[_0x4e39e8][_0x431b69(0x9a)]=0x0,_0x127b04[_0x4e39e8][_0x431b69(0x129)]='Floor',_0x127b04[_0x4e39e8][_0x431b69(0xf7)]=_0x474cc6[0x5];}else{if(_0x4e39e8==_0x36c382){var _0x1d338c;if(_0x474cc6[0x4]=='L')_0x1d338c=_0x431b69(0x86);else _0x474cc6[0x4]=='F'&&(_0x1d338c=_0x431b69(0x137));_0x127b04[_0x4e39e8]['storage']=_0x474cc6[0x0],_0x127b04[_0x4e39e8]['rack']=_0x474cc6[0x1],_0x127b04[_0x4e39e8][_0x431b69(0x138)]=_0x474cc6[0x2],_0x127b04[_0x4e39e8]['bin']=_0x474cc6[0x3],_0x127b04[_0x4e39e8][_0x431b69(0x129)]=_0x1d338c,_0x127b04[_0x4e39e8][_0x431b69(0xf7)]=_0x474cc6[0x5];}}}});}),_0x4bbdf9['forEach']((_0xd199bf,_0x3f43d1)=>{var _0x19db08=_0x38d877;_0x127b04[_0x3f43d1][_0x19db08(0x135)]=_0xd199bf;}),_0x3af546[_0x38d877(0xa5)]((_0x5e02eb,_0x15fa19)=>{_0x127b04[_0x15fa19]['id_transaction_from']=_0x5e02eb;}),_0x3eff16[_0x38d877(0xa5)]((_0x4dc4d9,_0x580dea)=>{_0x127b04[_0x580dea]['types']=_0x4dc4d9;}),_0xbda37d['forEach']((_0x2f2ee6,_0x4373bd)=>{var _0x24a261=_0x38d877;_0x127b04[_0x4373bd][_0x24a261(0xae)]=_0x2f2ee6;}),_0x4e710f[_0x38d877(0xa5)]((_0x13b330,_0x5c6d1e)=>{_0x127b04[_0x5c6d1e]['new_adjust_qty']=_0x13b330;}),_0x551709[_0x38d877(0xa5)]((_0x4bb65e,_0x3f8793)=>{var _0x55d220=_0x38d877;_0x127b04[_0x3f8793][_0x55d220(0x8c)]=_0x4bb65e;}),_0x5158ea[_0x38d877(0xa5)]((_0x2ec5b6,_0x452cd5)=>{var _0x13d52c=_0x38d877;_0x127b04[_0x452cd5][_0x13d52c(0x7b)]=_0x2ec5b6;}),_0x7397a6['forEach']((_0x1ab1d9,_0x1cdb18)=>{_0x127b04[_0x1cdb18]['product_code']=_0x1ab1d9;}),_0x5d3155[_0x38d877(0xa5)]((_0x52ad76,_0x2ef72a)=>{var _0x44be8b=_0x38d877;_0x127b04[_0x2ef72a][_0x44be8b(0xa1)]=_0x52ad76;}),_0x42ede3[_0x38d877(0xa5)]((_0x22037d,_0x8e07b5)=>{var _0x22792e=_0x38d877;_0x127b04[_0x8e07b5][_0x22792e(0x90)]=_0x22037d;}),_0x1133d6[_0x38d877(0xa5)]((_0x3c5697,_0x3b481d)=>{_0x127b04[_0x3b481d]['maxperunit']=_0x3c5697;}),_0x52907c[_0x38d877(0xa5)]((_0x1e9efd,_0x1e968a)=>{_0x127b04[_0x1e968a]['production_date']=_0x1e9efd;}),_0x1cbce8[_0x38d877(0xa5)]((_0x30db1c,_0x41a28a)=>{var _0x405a69=_0x38d877;_0x127b04[_0x41a28a][_0x405a69(0xb5)]=_0x30db1c;}),_0xd736b9[_0x38d877(0xa5)]((_0x55a6e3,_0x44065f)=>{var _0x57e1ab=_0x38d877;_0x127b04[_0x44065f][_0x57e1ab(0x136)]=_0x55a6e3;}),_0x45b918[_0x38d877(0xa5)]((_0x3114bd,_0x51ddba)=>{var _0x2ac732=_0x38d877;_0x127b04[_0x51ddba][_0x2ac732(0xc6)]=_0x3114bd;}),_0x41c0ec[_0x38d877(0xa5)]((_0x16b682,_0x36cf55)=>{var _0x5c09aa=_0x38d877;_0x127b04[_0x36cf55][_0x5c09aa(0x7d)]=_0x16b682;}),_0x140a3a['forEach']((_0x186125,_0x16ca85)=>{var _0x546926=_0x38d877;_0x127b04[_0x16ca85][_0x546926(0xc5)]=_0x186125;});const _0x236073=_0x127b04[_0x38d877(0x8a)](_0x1ebe5a=>_0x1ebe5a[_0x38d877(0xae)]!=='0'&&_0x1ebe5a[_0x38d877(0xae)]!=='');var _0x1c27cb=0x0;_0x236073[_0x38d877(0xa5)](_0x97507f=>{var _0x3e1933=_0x38d877;console[_0x3e1933(0xac)](_0x3e1933(0x9c),_0x97507f),parseInt(_0x97507f[_0x3e1933(0xae)])<=0x0&&_0x1c27cb++;});if(_0x1c27cb!=0x0)return _0x568797[_0x38d877(0x82)](_0x38d877(0x13e),_0x38d877(0x88)),_0xe56b9e[_0x38d877(0x11c)](_0x38d877(0x123));const _0x49ea81=new adjustment({'warehouse_name':_0x35ac55,'date':_0x57cff4,'product':_0x236073,'note':_0x5a3aec,'room':_0x101334,'invoice':_0x3a2319,'JO_number':_0x297ebf,'expiry_date':_0x59259a}),_0x17d440=await _0x49ea81[_0x38d877(0x119)]();_0x568797[_0x38d877(0x82)](_0x38d877(0xf4),_0x38d877(0x128)),_0xe56b9e['redirect']('/adjustment/preview/'+_0x17d440[_0x38d877(0x78)]);}catch(_0x4fc18a){console[_0x38d877(0xac)](_0x4fc18a),_0xe56b9e[_0x38d877(0xb4)](0xc8)['json']({'message':_0x4fc18a[_0x38d877(0x120)]});}}),router[a0_0x48e576(0xd0)](a0_0x48e576(0x79),auth,async(_0x144a22,_0x1c0aff)=>{var _0x555ee8=a0_0x48e576;try{const {username:_0x473e71,email:_0x5f1003,role:_0x36274e}=_0x144a22[_0x555ee8(0x107)],_0x328b9f=_0x144a22[_0x555ee8(0x107)],_0x5f56c4=await profile[_0x555ee8(0x6e)]({'email':_0x328b9f[_0x555ee8(0xd1)]}),_0x594bb2=await master_shop[_0x555ee8(0xfb)](),_0x3db48f=_0x144a22['params']['id'],_0x40d266=await adjustment[_0x555ee8(0xbe)]({'_id':_0x3db48f}),_0x686d9b=await purchases[_0x555ee8(0xa2)]([{'$match':{'warehouse_name':_0x40d266[_0x555ee8(0xaf)]}},{'$unwind':_0x555ee8(0xa8)},{'$group':{'_id':_0x555ee8(0x7e)}}]),_0x55f23c=await product[_0x555ee8(0xfb)]({}),_0x1ca0d5=await warehouse[_0x555ee8(0xa2)]([{'$match':{'name':_0x40d266['warehouse_name']}},{'$unwind':_0x555ee8(0x8b)},{'$group':{'_id':_0x555ee8(0x102),'name':{'$first':_0x555ee8(0xf6)},'product_stock':{'$first':_0x555ee8(0xee)},'bay':{'$first':_0x555ee8(0x11f)},'bin':{'$first':_0x555ee8(0xab)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x555ee8(0xb1)},'secondary_code':{'$first':_0x555ee8(0x91)},'product_code':{'$first':_0x555ee8(0x10a)},'storage':{'$first':_0x555ee8(0xed)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x555ee8(0xe8)},'expiry_date':{'$first':_0x555ee8(0xe6)},'production_date':{'$first':_0x555ee8(0x118)},'batch_code':{'$first':_0x555ee8(0xe7)},'room':{'$first':'$room'}}}]);if(_0x594bb2[0x0][_0x555ee8(0xd3)]==_0x555ee8(0x122)){var _0xf4b98b=users[_0x555ee8(0x121)];console[_0x555ee8(0xac)](_0xf4b98b);}else{if(_0x594bb2[0x0][_0x555ee8(0xd3)]==_0x555ee8(0xb0))var _0xf4b98b=users[_0x555ee8(0xb0)];else{if(_0x594bb2[0x0][_0x555ee8(0xd3)]==_0x555ee8(0x12a))var _0xf4b98b=users[_0x555ee8(0x12a)];else{if(_0x594bb2[0x0][_0x555ee8(0xd3)]=='Spanish')var _0xf4b98b=users[_0x555ee8(0xa3)];else{if(_0x594bb2[0x0][_0x555ee8(0xd3)]==_0x555ee8(0x9b))var _0xf4b98b=users['French'];else{if(_0x594bb2[0x0][_0x555ee8(0xd3)]==_0x555ee8(0x99))var _0xf4b98b=users['Portuguese'];else{if(_0x594bb2[0x0][_0x555ee8(0xd3)]==_0x555ee8(0x97))var _0xf4b98b=users[_0x555ee8(0x97)];else{if(_0x594bb2[0x0]['language']==_0x555ee8(0x87))var _0xf4b98b=users[_0x555ee8(0xcf)];}}}}}}}_0x1c0aff[_0x555ee8(0xa6)]('edit_adjustment_view',{'success':_0x144a22[_0x555ee8(0x82)](_0x555ee8(0xf4)),'errors':_0x144a22['flash'](_0x555ee8(0x13e)),'role':_0x328b9f,'profile':_0x5f56c4,'adjustment':_0x40d266,'master_shop':_0x594bb2,'warehouse_name':_0x686d9b,'unit':_0x55f23c,'language':_0xf4b98b});}catch(_0x5d6496){console['log'](_0x5d6496),_0x1c0aff[_0x555ee8(0xb4)](0xc8)[_0x555ee8(0xb8)]({'message':_0x5d6496['message']});}}),router[a0_0x48e576(0x12d)]('/preview/:id',auth,async(_0x1e3271,_0x48b53f)=>{var _0x11ec3e=a0_0x48e576;try{const _0x19de1d=_0x1e3271[_0x11ec3e(0x130)]['id'],{warehouse_name:_0x146350,Room_name:_0x191a5d}=_0x1e3271['body'],_0x2b200e=await adjustment['findById']({'_id':_0x19de1d}),_0x522d67=_0x2b200e[_0x11ec3e(0x73)]['map'](async _0x17f696=>{var _0x52e165=_0x11ec3e;if(_0x17f696[_0x52e165(0xae)]>0x0){const _0x388d71=mongoose['Types'][_0x52e165(0xe9)];var _0x30109c=await warehouse[_0x52e165(0xa2)]([{'$match':{'name':_0x146350,'room':_0x17f696['room_names'],'warehouse_category':_0x52e165(0x98)}},{'$unwind':_0x52e165(0x8b)},{'$match':{'product_details._id':_0x388d71(_0x17f696[_0x52e165(0x104)])}}]),_0x5ac905=0x0;for(let _0x41c024=0x0;_0x41c024<=_0x30109c[_0x52e165(0xaa)]-0x1;_0x41c024++){const _0x2b71bb=_0x30109c[_0x41c024];_0x17f696[_0x52e165(0xec)]==_0x52e165(0xf5)?(console[_0x52e165(0xac)]('-'),_0x5ac905=parseFloat(_0x30109c[_0x41c024][_0x52e165(0xb3)][_0x52e165(0xbd)])-parseFloat(_0x17f696['adjust_qty'])):(console['log']('+'),_0x5ac905=parseFloat(_0x30109c[_0x41c024]['product_details'][_0x52e165(0xbd)])+parseFloat(_0x17f696[_0x52e165(0xae)])),await warehouse['updateOne']({'_id':_0x388d71(_0x2b71bb[_0x52e165(0x78)][_0x52e165(0xcc)]()),'product_details._id':_0x388d71(_0x2b71bb[_0x52e165(0xb3)]['_id'])},{'$set':{'product_details.$.product_stock':_0x5ac905,'product_details.$.adj_invoice':_0x2b200e[_0x52e165(0xc5)]}}),console[_0x52e165(0xac)](_0x2b71bb[_0x52e165(0x78)]['valueOf']()+_0x52e165(0xb6)+_0x2b71bb['product_details'][_0x52e165(0x78)]+_0x52e165(0xb6)+_0x5ac905);}}});_0x2b200e['finalize']=_0x11ec3e(0x84);const _0x4ecfe2=await _0x2b200e[_0x11ec3e(0x119)](),_0x37c634=await master_shop[_0x11ec3e(0xfb)](),_0x1b929e=await email_settings[_0x11ec3e(0x6e)](),_0xf1250=await supervisor_settings[_0x11ec3e(0xfb)]();var _0x3468d1=_0x2b200e[_0x11ec3e(0x73)],_0x26d324='',_0x4c5f9d;for(_0x4c5f9d in _0x3468d1){_0x26d324+=_0x11ec3e(0xce)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3468d1[_0x4c5f9d][_0x11ec3e(0x109)]+'</td>'+_0x11ec3e(0xfe)+_0x3468d1[_0x4c5f9d]['product_code']+_0x11ec3e(0xb7)+_0x11ec3e(0xfe)+_0x3468d1[_0x4c5f9d][_0x11ec3e(0xae)]+_0x11ec3e(0xb7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3468d1[_0x4c5f9d][_0x11ec3e(0x8c)]+_0x11ec3e(0xb7)+_0x11ec3e(0xfe)+_0x3468d1[_0x4c5f9d][_0x11ec3e(0x7b)]+'</td>'+_0x11ec3e(0xfe)+_0x2b200e[_0x11ec3e(0xaf)]+'</td>'+_0x11ec3e(0xfe)+_0x3468d1[_0x4c5f9d]['room_names']+_0x11ec3e(0xb7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3468d1[_0x4c5f9d][_0x11ec3e(0x81)]+_0x3468d1[_0x4c5f9d][_0x11ec3e(0x12e)]+_0x3468d1[_0x4c5f9d][_0x11ec3e(0x138)]+_0x3468d1[_0x4c5f9d]['bin']+_0x3468d1[_0x4c5f9d][_0x11ec3e(0x129)][0x0]+_0x3468d1[_0x4c5f9d][_0x11ec3e(0xf7)]+_0x11ec3e(0xb7),_0x11ec3e(0x9d);}let _0x204372=nodemailer[_0x11ec3e(0xc2)]({'host':_0x1b929e['host'],'port':Number(_0x1b929e[_0x11ec3e(0x9e)]),'secure':![],'auth':{'user':_0x1b929e[_0x11ec3e(0xd1)],'pass':_0x1b929e[_0x11ec3e(0xe4)]}}),_0x3dacb1={'from':_0x1b929e['email'],'to':_0xf1250[0x0]['RMSEmail'],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x11ec3e(0x12c),'path':__dirname+_0x11ec3e(0xa9)+_0x11ec3e(0xd8)+_0x37c634[0x0][_0x11ec3e(0xf2)],'cid':'logo'}],'html':_0x11ec3e(0x132)+_0x11ec3e(0xea)+_0x11ec3e(0xf9)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x11ec3e(0x95)+_0x11ec3e(0x10d)+_0x11ec3e(0x74)+_0x37c634[0x0][_0x11ec3e(0xc4)]+_0x11ec3e(0x103)+'</div>'+_0x11ec3e(0x95)+_0x11ec3e(0xf1)+'<div>'+_0x11ec3e(0xdd)+'\x20Order\x20Number\x20:\x20'+_0x2b200e[_0x11ec3e(0xc5)]+'\x20'+_0x11ec3e(0x108)+_0x11ec3e(0xcb)+_0x2b200e[_0x11ec3e(0x116)]+'\x20'+_0x11ec3e(0x7f)+_0x11ec3e(0xd9)+_0x11ec3e(0x95)+_0x11ec3e(0x13b)+_0x11ec3e(0x125)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x11ec3e(0xeb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x11ec3e(0x75)+_0x11ec3e(0xfa)+_0x11ec3e(0xf0)+_0x11ec3e(0x117)+_0x11ec3e(0x9f)+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x26d324+'\x20'+_0x11ec3e(0xc1)+_0x11ec3e(0xf3)+_0x11ec3e(0x10d)+_0x11ec3e(0xfd)+_0x11ec3e(0xc9)+_0x37c634[0x0][_0x11ec3e(0xc4)]+_0x11ec3e(0xd9)+_0x11ec3e(0x95)+_0x11ec3e(0x95)+_0x11ec3e(0x83)};_0x204372[_0x11ec3e(0x113)](_0x3dacb1,function(_0x4ef3f0,_0x4ce468){var _0x236cf6=_0x11ec3e;_0x4ef3f0?(console[_0x236cf6(0xac)](_0x4ef3f0),console[_0x236cf6(0xac)]('Error\x20Occurs')):console[_0x236cf6(0xac)](_0x236cf6(0x8f));}),_0x1e3271[_0x11ec3e(0x82)](_0x11ec3e(0xf4),_0x11ec3e(0x96)),_0x48b53f[_0x11ec3e(0x11c)](_0x11ec3e(0xfc)+_0x4ecfe2[_0x11ec3e(0x78)]);}catch(_0x41c168){console[_0x11ec3e(0xac)](_0x41c168),_0x48b53f[_0x11ec3e(0xb4)](0xc8)[_0x11ec3e(0xb8)]({'message':_0x41c168[_0x11ec3e(0x120)]});}}),router[a0_0x48e576(0xd0)](a0_0x48e576(0xc0),auth,async(_0x5a8c25,_0x237dde)=>{var _0xec8d0c=a0_0x48e576;try{const {username:_0x1d6c48,email:_0x45de0b,role:_0x5c4411}=_0x5a8c25['user'],_0x20ee55=_0x5a8c25[_0xec8d0c(0x107)],_0x127c23=await profile['findOne']({'email':_0x20ee55[_0xec8d0c(0xd1)]}),_0x40e41c=await master_shop[_0xec8d0c(0xfb)](),_0xa340ac=_0x5a8c25[_0xec8d0c(0x130)]['id'],_0xcd79a5=await adjustment[_0xec8d0c(0xbe)]({'_id':_0xa340ac}),_0x363b03=await purchases[_0xec8d0c(0xa2)]([{'$match':{'warehouse_name':_0xcd79a5[_0xec8d0c(0xaf)]}},{'$unwind':_0xec8d0c(0xa8)},{'$group':{'_id':'$product.product_name'}}]),_0x7f6dee=await product[_0xec8d0c(0xfb)]({}),_0x356a0d=await warehouse[_0xec8d0c(0xa2)]([{'$match':{'name':_0xcd79a5[_0xec8d0c(0xaf)]}},{'$unwind':_0xec8d0c(0x8b)},{'$group':{'_id':'$product_details._id','name':{'$first':_0xec8d0c(0xf6)},'product_stock':{'$first':_0xec8d0c(0xee)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0xec8d0c(0xab)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xec8d0c(0x131)},'primary_code':{'$first':_0xec8d0c(0xb1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xec8d0c(0x10a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xec8d0c(0x12f)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0xec8d0c(0xe6)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xec8d0c(0xe7)},'room':{'$first':_0xec8d0c(0x13d)}}}]);let _0x2c6545;if(_0x20ee55[_0xec8d0c(0x111)]==_0xec8d0c(0xd5)){const _0x569edf=await staff[_0xec8d0c(0x6e)]({'email':_0x20ee55[_0xec8d0c(0xd1)]});_0x2c6545=await warehouse[_0xec8d0c(0xa2)]([{'$match':{'status':_0xec8d0c(0x115),'name':_0x569edf['warehouse'],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xec8d0c(0xad)}}},{'$group':{'_id':_0xec8d0c(0xdc),'name':{'$first':'$name'}}}]);}else _0x2c6545=await warehouse[_0xec8d0c(0xa2)]([{'$match':{'status':_0xec8d0c(0x115),'warehouse_category':_0xec8d0c(0x98),'name':{'$ne':_0xec8d0c(0xad)}}},{'$group':{'_id':_0xec8d0c(0xdc),'name':{'$first':_0xec8d0c(0xdc)}}}]);if(_0x40e41c[0x0][_0xec8d0c(0xd3)]==_0xec8d0c(0x122)){var _0x4e6344=users['English'];console[_0xec8d0c(0xac)](_0x4e6344);}else{if(_0x40e41c[0x0][_0xec8d0c(0xd3)]==_0xec8d0c(0xb0))var _0x4e6344=users[_0xec8d0c(0xb0)];else{if(_0x40e41c[0x0][_0xec8d0c(0xd3)]==_0xec8d0c(0x12a))var _0x4e6344=users[_0xec8d0c(0x12a)];else{if(_0x40e41c[0x0]['language']=='Spanish')var _0x4e6344=users[_0xec8d0c(0xa3)];else{if(_0x40e41c[0x0][_0xec8d0c(0xd3)]==_0xec8d0c(0x9b))var _0x4e6344=users['French'];else{if(_0x40e41c[0x0][_0xec8d0c(0xd3)]=='Portuguese\x20(BR)')var _0x4e6344=users[_0xec8d0c(0x72)];else{if(_0x40e41c[0x0][_0xec8d0c(0xd3)]==_0xec8d0c(0x97))var _0x4e6344=users['Chinese'];else{if(_0x40e41c[0x0][_0xec8d0c(0xd3)]==_0xec8d0c(0x87))var _0x4e6344=users[_0xec8d0c(0xcf)];}}}}}}}_0x237dde[_0xec8d0c(0xa6)](_0xec8d0c(0xa0),{'success':_0x5a8c25[_0xec8d0c(0x82)](_0xec8d0c(0xf4)),'errors':_0x5a8c25[_0xec8d0c(0x82)](_0xec8d0c(0x13e)),'role':_0x20ee55,'profile':_0x127c23,'adjustment':_0xcd79a5,'stock':_0x356a0d,'master_shop':_0x40e41c,'warehouse_name':_0x363b03,'unit':_0x7f6dee,'language':_0x4e6344,'warehouse':_0x2c6545});}catch(_0x303a43){console['log'](_0x303a43),_0x237dde[_0xec8d0c(0xb4)](0xc8)[_0xec8d0c(0xb8)]({'message':_0x303a43[_0xec8d0c(0x120)]});}}),router[a0_0x48e576(0x12d)](a0_0x48e576(0xc0),auth,async(_0x2c9c4b,_0x345bbe)=>{var _0x18c94f=a0_0x48e576;try{const _0x4e05ae=_0x2c9c4b[_0x18c94f(0x130)]['id'],_0x4c00d4=await adjustment['findById']({'_id':_0x4e05ae}),_0x2f715a=await warehouse[_0x18c94f(0x6e)]({'name':_0x4c00d4[_0x18c94f(0xaf)],'room':_0x4c00d4[_0x18c94f(0x10c)]}),{warehouse_name:_0x144b9a,date:_0x36b081,prod_name:_0x3e237e,level:_0xca8f0a,isle:_0x20feda,pallet:_0x294e2d,stock:_0x4b1e11,types:_0x2cb738,adjust_qty:_0x4f1f47,new_adjust_qty:_0x432658,note:_0x5a64b4,Room_name:_0x15f7c3,invoice:_0xa15ab8,JO_number:_0x4373dd,expiry_date:_0x52ac9c}=_0x2c9c4b[_0x18c94f(0x100)];if(typeof _0x3e237e==_0x18c94f(0xd2))var _0x42ed17=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xa4)]],_0x465f10=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xcd)]],_0x27783d=[_0x2c9c4b[_0x18c94f(0x100)]['stock']],_0x329157=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xec)]],_0x148e82=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xbf)]],_0x5269b2=[_0x2c9c4b[_0x18c94f(0x100)]['New_Qty_Converted']],_0x11c454=[_0x2c9c4b['body'][_0x18c94f(0x70)]],_0x42449b=[_0x2c9c4b['body'][_0x18c94f(0xe2)]],_0xa28e89=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x11d)]],_0x58d9b0=[_0x2c9c4b['body'][_0x18c94f(0xa1)]],_0x18fe12=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x90)]],_0x5e0a80=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x133)]],_0x4920c7=[_0x2c9c4b[_0x18c94f(0x100)]['production_date']],_0x4c324a=[_0x2c9c4b['body']['prod_cat']],_0x51c16f=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x7c)]],_0x5a1423=[_0x2c9c4b[_0x18c94f(0x100)]['prime1']],_0x383dc5=[_0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xd4)]];else var _0x42ed17=[..._0x2c9c4b[_0x18c94f(0x100)]['prod_name']],_0x465f10=[..._0x2c9c4b['body'][_0x18c94f(0xcd)]],_0x27783d=[..._0x2c9c4b[_0x18c94f(0x100)]['stock']],_0x329157=[..._0x2c9c4b[_0x18c94f(0x100)]['types']],_0x148e82=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xbf)]],_0x5269b2=[..._0x2c9c4b['body'][_0x18c94f(0x126)]],_0x11c454=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x8c)]],_0x42449b=[..._0x2c9c4b['body'][_0x18c94f(0xe2)]],_0xa28e89=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x11d)]],_0x58d9b0=[..._0x2c9c4b['body']['batch_code']],_0x18fe12=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x90)]],_0x5e0a80=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x133)]],_0x4920c7=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x8d)]],_0x4c324a=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xb5)]],_0x51c16f=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0x7c)]],_0x5a1423=[..._0x2c9c4b['body'][_0x18c94f(0xe3)]],_0x383dc5=[..._0x2c9c4b[_0x18c94f(0x100)][_0x18c94f(0xd4)]];const _0x3178e6=_0x42ed17[_0x18c94f(0x11e)](_0xfaff08=>{return _0xfaff08={'product_name':_0xfaff08};});_0x465f10[_0x18c94f(0xa5)]((_0x7cdf07,_0x3750d3)=>{_0x51c16f['forEach']((_0x2f7d42,_0x4c5ea1)=>{var _0x310ad9=a0_0x2fca;if(_0x2f7d42=='Receiving\x20Area'&&_0x3750d3==_0x4c5ea1){var _0x5be1ec=_0x7cdf07[_0x310ad9(0xd6)](0x3);_0x3178e6[_0x3750d3][_0x310ad9(0x81)]=_0x7cdf07[0x0],_0x3178e6[_0x3750d3]['rack']=_0x7cdf07[0x1],_0x3178e6[_0x3750d3][_0x310ad9(0x138)]=0x0,_0x3178e6[_0x3750d3]['bin']=0x0,_0x3178e6[_0x3750d3][_0x310ad9(0x129)]=_0x310ad9(0x137),_0x3178e6[_0x3750d3]['floorlevel']=_0x5be1ec;}else{if(_0x2f7d42==_0x310ad9(0xf8)&&_0x3750d3==_0x4c5ea1){var _0x5be1ec=_0x7cdf07[_0x310ad9(0xd6)](0x3);_0x3178e6[_0x3750d3][_0x310ad9(0x81)]=_0x7cdf07[0x0],_0x3178e6[_0x3750d3][_0x310ad9(0x12e)]=_0x7cdf07[0x1],_0x3178e6[_0x3750d3][_0x310ad9(0x138)]=0x0,_0x3178e6[_0x3750d3][_0x310ad9(0x9a)]=0x0,_0x3178e6[_0x3750d3][_0x310ad9(0x129)]=_0x310ad9(0x137),_0x3178e6[_0x3750d3][_0x310ad9(0xf7)]=_0x7cdf07[0x5];}else{if(_0x3750d3==_0x4c5ea1){var _0x57b06b;if(_0x7cdf07[0x4]=='L')_0x57b06b=_0x310ad9(0x86);else _0x7cdf07[0x4]=='F'&&(_0x57b06b='Floor');_0x3178e6[_0x3750d3][_0x310ad9(0x81)]=_0x7cdf07[0x0],_0x3178e6[_0x3750d3][_0x310ad9(0x12e)]=_0x7cdf07[0x1],_0x3178e6[_0x3750d3]['bay']=_0x7cdf07[0x2],_0x3178e6[_0x3750d3]['bin']=_0x7cdf07[0x3],_0x3178e6[_0x3750d3]['type']=_0x57b06b,_0x3178e6[_0x3750d3]['floorlevel']=_0x7cdf07[0x5];}}}});}),_0x27783d[_0x18c94f(0xa5)]((_0x3ddf02,_0x5be254)=>{_0x3178e6[_0x5be254]['stockBefore']=_0x3ddf02;}),_0x329157['forEach']((_0x236c4d,_0x24a430)=>{_0x3178e6[_0x24a430]['types']=_0x236c4d;}),_0x148e82['forEach']((_0x5babb6,_0x30b6a6)=>{var _0x284385=_0x18c94f;_0x3178e6[_0x30b6a6][_0x284385(0xae)]=_0x5babb6;}),_0x5269b2[_0x18c94f(0xa5)]((_0x4b2efa,_0x43df6d)=>{var _0x160eea=_0x18c94f;_0x3178e6[_0x43df6d][_0x160eea(0x101)]=_0x4b2efa;}),_0x11c454[_0x18c94f(0xa5)]((_0x3f26bd,_0x969d7e)=>{_0x3178e6[_0x969d7e]['unit']=_0x3f26bd;}),_0x42449b[_0x18c94f(0xa5)]((_0x2f5d17,_0x1231c5)=>{var _0x30a3f5=_0x18c94f;_0x3178e6[_0x1231c5][_0x30a3f5(0x7b)]=_0x2f5d17;}),_0xa28e89[_0x18c94f(0xa5)]((_0x5b9283,_0x147593)=>{var _0x414a26=_0x18c94f;_0x3178e6[_0x147593][_0x414a26(0x89)]=_0x5b9283;}),_0x58d9b0['forEach']((_0x12f5ad,_0xd00c30)=>{var _0x3043b4=_0x18c94f;_0x3178e6[_0xd00c30][_0x3043b4(0xa1)]=_0x12f5ad;}),_0x18fe12[_0x18c94f(0xa5)]((_0x281d87,_0x1afd03)=>{_0x3178e6[_0x1afd03]['expiry_date']=_0x281d87;}),_0x5e0a80[_0x18c94f(0xa5)]((_0x5c22de,_0xb497c8)=>{_0x3178e6[_0xb497c8]['maxperunit']=_0x5c22de;}),_0x4920c7[_0x18c94f(0xa5)]((_0x420f14,_0x5e34f8)=>{var _0x4fbdb4=_0x18c94f;_0x3178e6[_0x5e34f8][_0x4fbdb4(0x8d)]=_0x420f14;}),_0x4c324a[_0x18c94f(0xa5)]((_0x453bdf,_0x377698)=>{_0x3178e6[_0x377698]['prod_cat']=_0x453bdf;}),_0x51c16f[_0x18c94f(0xa5)]((_0x10ac2d,_0x1030b4)=>{_0x3178e6[_0x1030b4]['room_names']=_0x10ac2d;}),_0x5a1423[_0x18c94f(0xa5)]((_0x1d0f13,_0x1f0a63)=>{var _0x186e0f=_0x18c94f;_0x3178e6[_0x1f0a63][_0x186e0f(0xc6)]=_0x1d0f13;}),_0x383dc5[_0x18c94f(0xa5)]((_0x3d3026,_0x3749a8)=>{var _0x24ee25=_0x18c94f;_0x3178e6[_0x3749a8][_0x24ee25(0x7d)]=_0x3d3026;});const _0x288973=_0x3178e6[_0x18c94f(0x8a)](_0x24b483=>_0x24b483[_0x18c94f(0xae)]!=='0'&&_0x24b483[_0x18c94f(0xae)]!=='');var _0x5e6122=0x0;_0x288973[_0x18c94f(0xa5)](_0x43e1da=>{var _0x3505f6=_0x18c94f;console[_0x3505f6(0xac)](_0x3505f6(0x9c),_0x43e1da),parseInt(_0x43e1da['adjust_qty'])<=0x0&&_0x5e6122++;});if(_0x5e6122!=0x0)return _0x2c9c4b[_0x18c94f(0x82)](_0x18c94f(0x13e),_0x18c94f(0x88)),_0x345bbe[_0x18c94f(0x11c)](_0x18c94f(0x123));_0x4c00d4['warehouse_name']=_0x144b9a,_0x4c00d4[_0x18c94f(0x116)]=_0x36b081,_0x4c00d4[_0x18c94f(0x73)]=_0x288973,_0x4c00d4['note']=_0x5a64b4,_0x4c00d4[_0x18c94f(0xc5)]=_0xa15ab8,_0x4c00d4['isAllowEdit']=_0x18c94f(0x114);const _0x478f9e=await _0x4c00d4['save']();_0x2c9c4b[_0x18c94f(0x82)](_0x18c94f(0xf4),_0x18c94f(0x11b)),_0x345bbe[_0x18c94f(0x11c)](_0x18c94f(0x12b));}catch(_0x328bb8){console[_0x18c94f(0xac)](_0x328bb8);}}),router[a0_0x48e576(0x12d)](a0_0x48e576(0xd7),async(_0xa8a0f5,_0x47e8fa)=>{var _0x2248ef=a0_0x48e576;const {primary_code:_0x4f2055,warehouse_data:_0x129694,rooms_data:_0x2eea00,Roomslist:_0x541219}=_0xa8a0f5[_0x2248ef(0x100)],_0x3731ac=_0x541219['split'](','),_0x4ba56b=[];async function _0x24fc2a(_0x2e46b9){var _0x2b6741=_0x2248ef;const _0x58e898=await warehouse[_0x2b6741(0xa2)]([{'$match':{'name':_0x129694,'room':_0x2e46b9}},{'$unwind':_0x2b6741(0x8b)},{'$match':{'product_details.primary_code':_0x4f2055}},{'$group':{'_id':_0x2b6741(0x102),'name':{'$first':_0x2b6741(0xf6)},'product_stock':{'$first':_0x2b6741(0xee)},'primary_code':{'$first':_0x2b6741(0xb1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2b6741(0x10a)},'level':{'$first':_0x2b6741(0x11f)},'isle':{'$first':_0x2b6741(0xab)},'type':{'$first':_0x2b6741(0x106)},'pallet':{'$first':_0x2b6741(0x131)},'unit':{'$first':_0x2b6741(0xef)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x2b6741(0xed)},'rack':{'$first':_0x2b6741(0x12f)},'expiry_date':{'$first':_0x2b6741(0xe6)},'production_date':{'$first':_0x2b6741(0x118)},'maxPerUnit':{'$first':_0x2b6741(0xe8)},'batch_code':{'$first':_0x2b6741(0xe7)},'product_cat':{'$first':_0x2b6741(0x10e)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2b6741(0x13d)},'invoice':{'$first':_0x2b6741(0x11a)}}}]),_0x5ea943=await warehouse[_0x2b6741(0xa2)]([{'$match':{'name':_0x129694,'room':_0x2e46b9}},{'$unwind':_0x2b6741(0x8b)},{'$match':{'product_details.secondary_code':_0x4f2055}},{'$group':{'_id':_0x2b6741(0x102),'name':{'$first':_0x2b6741(0xf6)},'product_stock':{'$first':_0x2b6741(0xee)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2b6741(0x91)},'product_code':{'$first':_0x2b6741(0x10a)},'level':{'$first':_0x2b6741(0x11f)},'isle':{'$first':_0x2b6741(0xab)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2b6741(0x131)},'unit':{'$first':_0x2b6741(0xef)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2b6741(0x12f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2b6741(0xe7)},'product_cat':{'$first':_0x2b6741(0x10e)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2b6741(0x13d)}}}]);if(_0x58e898['length']>0x0)_0x4ba56b[_0x2b6741(0x92)](_0x58e898);else _0x5ea943[_0x2b6741(0xaa)]>0x0&&_0x4ba56b[_0x2b6741(0x92)](_0x5ea943);}const _0x453a99=_0x3731ac['map'](_0x1a2328=>_0x24fc2a(_0x1a2328));await Promise[_0x2248ef(0x71)](_0x453a99),_0x47e8fa['json'](_0x4ba56b);}),router[a0_0x48e576(0x12d)]('/CheckingWarehouse',async(_0xea37ec,_0x5aea3a)=>{var _0x86ad46=a0_0x48e576;const {primaryCode:_0x3475a0,secondaryCode:_0x52e4d0,productCode:_0x4e911e,level:_0x3ece47,isle:_0x24edc4,pallet:_0x591ab5,warehouses:_0x3805c0,room:_0x573e71}=_0xea37ec['body'];try{const _0x5a1bab=await warehouse[_0x86ad46(0xa2)]([{'$match':{'name':_0x3805c0,'room':_0x573e71}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x3ece47),'product_details.isle':_0x24edc4,'product_details.pallet':parseInt(_0x591ab5)}},{'$group':{'_id':_0x86ad46(0x102),'name':{'$first':_0x86ad46(0xf6)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x86ad46(0x7a)},'isle':{'$first':_0x86ad46(0xca)},'pallet':{'$first':_0x86ad46(0x94)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x5aea3a[_0x86ad46(0xb4)](0xc8)[_0x86ad46(0xb8)](_0x5a1bab);}catch(_0xb570f){_0x5aea3a[_0x86ad46(0xb4)](0x194)['json']({'message':_0xb570f[_0x86ad46(0x120)]});}}),module[a0_0x48e576(0x139)]=router;