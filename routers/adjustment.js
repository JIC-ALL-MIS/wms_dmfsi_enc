var a0_0x202759=a0_0x4513;(function(_0xfebca1,_0x199035){var _0x493315=a0_0x4513,_0x54fb98=_0xfebca1();while(!![]){try{var _0x5aea1b=parseInt(_0x493315(0x20d))/0x1+-parseInt(_0x493315(0x276))/0x2*(parseInt(_0x493315(0x254))/0x3)+-parseInt(_0x493315(0x22f))/0x4+parseInt(_0x493315(0x291))/0x5*(-parseInt(_0x493315(0x232))/0x6)+-parseInt(_0x493315(0x26a))/0x7*(-parseInt(_0x493315(0x235))/0x8)+parseInt(_0x493315(0x23b))/0x9+parseInt(_0x493315(0x1fd))/0xa*(parseInt(_0x493315(0x200))/0xb);if(_0x5aea1b===_0x199035)break;else _0x54fb98['push'](_0x54fb98['shift']());}catch(_0x5b98e8){_0x54fb98['push'](_0x54fb98['shift']());}}}(a0_0x21db,0x8c1b7));const express=require(a0_0x202759(0x29c)),app=express(),router=express[a0_0x202759(0x28d)](),auth=require(a0_0x202759(0x1e7)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x202759(0x1cc));function a0_0x21db(){var _0x2dd446=['4764051mCPpog','$product_details.expiry_date','New_Qty_Converted','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','maxPerUnit','date','primary_code','Spanish','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','storage','$product_details.unit','Floor','expiry_date','push','batch_code','random','/../public','$product_details','message','Adjustment\x20Mail','prime1','flash','Shelves','2611677NkKuzJ','back','</thead>','<tbody\x20style=\x22text-align:\x20center;\x22>','/view','$product_details.bin','isAllowEdit','<!DOCTYPE\x20html>','createTransport','toString','$product_details.production_date','<span\x20style=\x22float:\x20right;\x22>','/barcode_scanner','unit','$product_details.storage','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','English','string','RMSEmail','product_stock','adjustment\x20Finalized\x20successfully','master','28BDSzeU','Return\x20Goods','English\x20(US)','</td>','ADJ-','/adjustment/preview/','Receiving\x20Area','Enclosed','post','floor','error','Rooms','2JBIKIc','filter','save','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product_code','An\x20error\x20occurred\x20while\x20saving\x20data.','type','catch','$product_details.product_name','user','warehouse_name','$product_details.batch_code','Arabic','bay','split','$product_details.product_stock','image','password','Hindi','foreach\x20newproduct','success','adjustment\x20data\x20update\x20successfully','Email\x20sent\x20successfully','Router','\x20Order\x20Date\x20:\x20','Raw\x20Materials','Enabled','866020xefZMW','$name','\x20</h2>','$product_details.product_cat','types','get','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Logo.png','edit_adjustment_view','status','express','add_adjustment','prod_invoice','$product','Chinese','<div>','logo','$_id','stock','German','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','/adjustment/view','level','prod_name','nodemailer','</body></html>','</tr>','$date','$product.room_names','$product_details.product_code','</tbody>','then','max_per_unit','$product_details.bay','production_date','$product_details.pallet','adjust_qty','padStart','<tr>','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','secondary_unit','staff','findById','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Arabic\x20(ae)','site_title','body','adjustment\x20add\x20successfull','note','stockBefore','../middleware/auth','all','</div>','Level','\x20Order\x20Number\x20:\x20','json','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Portuguese','room_names','forEach','$finalize','slice','log','role','product_details','/view/add_adjustment','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.type','/picking_list/PDF_adjustment_rm/','$isAllowEdit','/view/:id','2570avGMjq','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','find','39743EXNdTB','port','map','Secondary_units','rack','room','length','warehouse','New_Qty_Converted_adj','</span>','$product_details._id','French','<html><head><title></title>','823131HbXWce','<strong>\x20Regards\x20</strong>','/upload/','<hr\x20class=\x22my-3\x22>','/CheckingWarehouse','product','Return\x20Rooms','Ambient','email','floorlevel','$product_details.primary_code','Error\x20Occurs','second1','aggregate','Primary_Units','product_name','errors','maxperunit','finalize','_id','$product_details.rack','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.secondary_unit','bin','redirect','$product_details.floorlevel','params','</h5>','$product_details.level','Portuguese\x20(BR)','\x20<>\x20','findOne','prod_cat','exports','3125188zvGuOM','<h2>\x20','/preview/:id','12xjTBas','$room','prod_code','582264QaLKwH','$product_details.maxPerUnit','new_adjust_qty','$product.product_name','$invoice','secondary_code'];a0_0x21db=function(){return _0x2dd446;};return a0_0x21db();}function a0_0x4513(_0x4abc86,_0x3b3c9d){var _0x21db15=a0_0x21db();return a0_0x4513=function(_0x45138a,_0x5e0248){_0x45138a=_0x45138a-0x1c8;var _0xbaa48e=_0x21db15[_0x45138a];return _0xbaa48e;},a0_0x4513(_0x4abc86,_0x3b3c9d);}router[a0_0x202759(0x296)](a0_0x202759(0x258),auth,async(_0x4355d3,_0x3ccfb9)=>{var _0x24dd29=a0_0x202759;try{const {username:_0x183187,email:_0x3c4ed7,role:_0x1a0c81}=_0x4355d3[_0x24dd29(0x27f)],_0x547035=_0x4355d3[_0x24dd29(0x27f)],_0xda5a99=await profile[_0x24dd29(0x22c)]({'email':_0x547035[_0x24dd29(0x215)]}),_0x2a017e=await master_shop['find']();console['log'](_0x24dd29(0x269),_0x2a017e);let _0xe57d75;if(_0x547035[_0x24dd29(0x1f4)]==_0x24dd29(0x1de)){const _0x514d75=await staff['findOne']({'email':_0x547035[_0x24dd29(0x215)]});_0xe57d75=await warehouse[_0x24dd29(0x1ff)]({'status':'Enabled','name':_0x514d75[_0x24dd29(0x207)]});}else _0xe57d75=await warehouse[_0x24dd29(0x1ff)]({'status':_0x24dd29(0x290)});const _0x1e4007=await product['find']();let _0x149c5a;if(_0x547035[_0x24dd29(0x1f4)]=='staff'){const _0x134fa0=await staff[_0x24dd29(0x22c)]({'email':_0x547035[_0x24dd29(0x215)]});_0x149c5a=await adjustment[_0x24dd29(0x1ff)]({'warehouse_name':_0x134fa0[_0x24dd29(0x207)]});}else _0x149c5a=await adjustment[_0x24dd29(0x21a)]([{'$unwind':_0x24dd29(0x29f)},{'$group':{'_id':_0x24dd29(0x2a3),'invoice':{'$first':_0x24dd29(0x239)},'date':{'$first':_0x24dd29(0x1cf)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x24dd29(0x1d0)},'finalize':{'$first':_0x24dd29(0x1f1)},'isAllowEdit':{'$first':_0x24dd29(0x1fb)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2a017e[0x0][_0x24dd29(0x1f7)]==_0x24dd29(0x26c)){var _0x38086a=users['English'];console['log'](_0x38086a);}else{if(_0x2a017e[0x0][_0x24dd29(0x1f7)]==_0x24dd29(0x288))var _0x38086a=users[_0x24dd29(0x288)];else{if(_0x2a017e[0x0][_0x24dd29(0x1f7)]=='German')var _0x38086a=users[_0x24dd29(0x2a5)];else{if(_0x2a017e[0x0][_0x24dd29(0x1f7)]==_0x24dd29(0x243))var _0x38086a=users['Spanish'];else{if(_0x2a017e[0x0]['language']==_0x24dd29(0x20b))var _0x38086a=users[_0x24dd29(0x20b)];else{if(_0x2a017e[0x0]['language']==_0x24dd29(0x22a))var _0x38086a=users[_0x24dd29(0x1ee)];else{if(_0x2a017e[0x0][_0x24dd29(0x1f7)]==_0x24dd29(0x2a0))var _0x38086a=users[_0x24dd29(0x2a0)];else{if(_0x2a017e[0x0][_0x24dd29(0x1f7)]==_0x24dd29(0x1e1))var _0x38086a=users[_0x24dd29(0x282)];}}}}}}}_0x3ccfb9[_0x24dd29(0x244)]('adjustment',{'success':_0x4355d3[_0x24dd29(0x252)](_0x24dd29(0x28a)),'errors':_0x4355d3['flash'](_0x24dd29(0x21d)),'role':_0x547035,'profile':_0xda5a99,'warehouse':_0xe57d75,'product':_0x1e4007,'adjustment':_0x149c5a,'master_shop':_0x2a017e,'language':_0x38086a});}catch(_0x2ffbe1){console[_0x24dd29(0x1f3)](_0x2ffbe1);}});async function getRandom8DigitNumber(){var _0x9dc60b=a0_0x202759;const _0x101e92=0x989680,_0x5827ff=0x5f5e0ff,_0x314812=Math[_0x9dc60b(0x273)](Math[_0x9dc60b(0x24c)]()*(_0x5827ff-_0x101e92+0x1))+_0x101e92;var _0x1eef42;const _0xea1561=await adjustment[_0x9dc60b(0x22c)]({'invoice':_0x9dc60b(0x26e)+_0x314812});return _0xea1561&&_0xea1561[_0x9dc60b(0x206)]>0x0?_0x1eef42=_0x9dc60b(0x26e)+_0x314812:_0x1eef42=_0x9dc60b(0x26e)+_0x314812,_0x1eef42;}router['get']('/view/add_adjustment',auth,async(_0x5bc69d,_0x4582b7)=>{var _0x1d4efd=a0_0x202759;try{const {username:_0x81c4c5,email:_0x31c37d,role:_0x5a4e3e}=_0x5bc69d[_0x1d4efd(0x27f)],_0x1a1b48=_0x5bc69d[_0x1d4efd(0x27f)],_0x3636af=await profile[_0x1d4efd(0x22c)]({'email':_0x1a1b48[_0x1d4efd(0x215)]}),_0x447cc2=await master_shop['find']();let _0x57b1db;if(_0x1a1b48[_0x1d4efd(0x1f4)]==_0x1d4efd(0x1de)){const _0x1641fe=await staff[_0x1d4efd(0x22c)]({'email':_0x1a1b48[_0x1d4efd(0x215)]});_0x57b1db=await warehouse[_0x1d4efd(0x21a)]([{'$match':{'status':_0x1d4efd(0x290),'name':_0x1641fe[_0x1d4efd(0x207)],'warehouse_category':_0x1d4efd(0x28f),'name':{'$ne':_0x1d4efd(0x26b)}}},{'$group':{'_id':_0x1d4efd(0x292),'name':{'$first':_0x1d4efd(0x292)}}}]);}else _0x57b1db=await warehouse['aggregate']([{'$match':{'status':_0x1d4efd(0x290),'warehouse_category':_0x1d4efd(0x28f),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x1d4efd(0x292)}}}]);const _0x2a3534=await product[_0x1d4efd(0x1ff)]({}),_0x4e249b=await adjustment[_0x1d4efd(0x1ff)]({}),_0x4c6eb0=_0x4e249b['length']+0x1,_0x1b4764='ADJ-'+_0x4c6eb0[_0x1d4efd(0x25d)]()[_0x1d4efd(0x1d9)](0x5,'0');var _0x18ad29=[_0x1d4efd(0x214),_0x1d4efd(0x271),_0x1d4efd(0x213)];if(_0x447cc2[0x0]['language']==_0x1d4efd(0x26c))var _0x5e5cc2=users[_0x1d4efd(0x264)];else{if(_0x447cc2[0x0][_0x1d4efd(0x1f7)]==_0x1d4efd(0x288))var _0x5e5cc2=users['Hindi'];else{if(_0x447cc2[0x0][_0x1d4efd(0x1f7)]=='German')var _0x5e5cc2=users['German'];else{if(_0x447cc2[0x0][_0x1d4efd(0x1f7)]=='Spanish')var _0x5e5cc2=users[_0x1d4efd(0x243)];else{if(_0x447cc2[0x0][_0x1d4efd(0x1f7)]==_0x1d4efd(0x20b))var _0x5e5cc2=users[_0x1d4efd(0x20b)];else{if(_0x447cc2[0x0][_0x1d4efd(0x1f7)]==_0x1d4efd(0x22a))var _0x5e5cc2=users[_0x1d4efd(0x1ee)];else{if(_0x447cc2[0x0][_0x1d4efd(0x1f7)]==_0x1d4efd(0x2a0))var _0x5e5cc2=users['Chinese'];else{if(_0x447cc2[0x0][_0x1d4efd(0x1f7)]==_0x1d4efd(0x1e1))var _0x5e5cc2=users[_0x1d4efd(0x282)];}}}}}}}const _0x6bd455=getRandom8DigitNumber();_0x6bd455[_0x1d4efd(0x1d3)](_0x2c045d=>{var _0x3014c0=_0x1d4efd;_0x4582b7[_0x3014c0(0x244)](_0x3014c0(0x29d),{'success':_0x5bc69d[_0x3014c0(0x252)](_0x3014c0(0x28a)),'errors':_0x5bc69d[_0x3014c0(0x252)](_0x3014c0(0x21d)),'role':_0x1a1b48,'profile':_0x3636af,'warehouse':_0x57b1db,'product':_0x2a3534,'master_shop':_0x447cc2,'language':_0x5e5cc2,'rooms_data':_0x18ad29,'invoice_no':_0x2c045d});})[_0x1d4efd(0x27d)](_0x5567c3=>{var _0x5a97a3=_0x1d4efd;_0x5bc69d[_0x5a97a3(0x252)](_0x5a97a3(0x21d),_0x5a97a3(0x279)),_0x4582b7['redirect']('/adjustment/view');});}catch(_0x7af15b){console[_0x1d4efd(0x1f3)](_0x7af15b);}}),router[a0_0x202759(0x272)](a0_0x202759(0x1f6),auth,async(_0x517750,_0x10167f)=>{var _0x546cb6=a0_0x202759;try{const {warehouse_name:_0x44d307,date:_0x16d429,prod_name:_0x2c73ce,level:_0x4309b6,isle:_0x4f13cd,pallet:_0x1b69e5,stock:_0x51eb08,types:_0x5bfec9,adjust_qty:_0x4d3079,new_adjust_qty:_0x3e32f6,note:_0x40e2af,Room_name:_0x48a7c0,invoice:_0x1aaecd,JO_number:_0x219c8d,expiry_date:_0x7a13ab}=_0x517750['body'];if(typeof _0x2c73ce=='string')var _0xd4bfa8=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x1cb)]],_0x5f009b=[_0x517750[_0x546cb6(0x1e3)]['level']],_0x2c02c0=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x2a4)]],_0x384928=[_0x517750['body'][_0x546cb6(0x295)]],_0x1607eb=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x208)]],_0x5ee68d=[_0x517750['body'][_0x546cb6(0x23d)]],_0x31f2e=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x21b)]],_0x44a880=[_0x517750['body'][_0x546cb6(0x203)]],_0x1d987d=[_0x517750[_0x546cb6(0x1e3)]['prod_code']],_0x3567dc=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x24b)]],_0xfd6c81=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x249)]],_0x28081a=[_0x517750['body']['max_per_unit']],_0x5af409=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x1d6)]],_0x347f7a=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x22d)]],_0x281890=[_0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x275)]],_0x3d88b1=[_0x517750[_0x546cb6(0x1e3)]['prime1']],_0x53e0e6=[_0x517750['body']['second1']],_0x2e1f63=[_0x517750['body'][_0x546cb6(0x29e)]];else var _0xd4bfa8=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x1cb)]],_0x5f009b=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x1ca)]],_0x2c02c0=[..._0x517750['body'][_0x546cb6(0x2a4)]],_0x384928=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x295)]],_0x1607eb=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x208)]],_0x5ee68d=[..._0x517750['body'][_0x546cb6(0x23d)]],_0x31f2e=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x261)]],_0x44a880=[..._0x517750['body'][_0x546cb6(0x203)]],_0x1d987d=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x234)]],_0x3567dc=[..._0x517750['body'][_0x546cb6(0x24b)]],_0xfd6c81=[..._0x517750[_0x546cb6(0x1e3)]['expiry_date']],_0x28081a=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x1d4)]],_0x5af409=[..._0x517750[_0x546cb6(0x1e3)][_0x546cb6(0x1d6)]],_0x347f7a=[..._0x517750['body'][_0x546cb6(0x22d)]],_0x281890=[..._0x517750[_0x546cb6(0x1e3)]['Rooms']],_0x3d88b1=[..._0x517750[_0x546cb6(0x1e3)]['prime1']],_0x53e0e6=[..._0x517750['body']['second1']],_0x2e1f63=[..._0x517750[_0x546cb6(0x1e3)]['prod_invoice']];const _0x294c0e=_0xd4bfa8[_0x546cb6(0x202)](_0x73478c=>{return _0x73478c={'product_name':_0x73478c};});_0x5f009b['forEach']((_0xca10a8,_0x33ab07)=>{var _0x2d114b=_0x546cb6;_0x281890[_0x2d114b(0x1f0)]((_0x3fca7c,_0x5cb707)=>{var _0x2716bd=_0x2d114b;if(_0x3fca7c==_0x2716bd(0x270)&&_0x33ab07==_0x5cb707){var _0x24493c=_0xca10a8[_0x2716bd(0x1f2)](0x3);_0x294c0e[_0x33ab07][_0x2716bd(0x246)]=_0xca10a8[0x0],_0x294c0e[_0x33ab07][_0x2716bd(0x204)]=_0xca10a8[0x1],_0x294c0e[_0x33ab07][_0x2716bd(0x283)]=0x0,_0x294c0e[_0x33ab07]['bin']=0x0,_0x294c0e[_0x33ab07][_0x2716bd(0x27c)]=_0x2716bd(0x248),_0x294c0e[_0x33ab07][_0x2716bd(0x216)]=_0x24493c;}else{if(_0x3fca7c==_0x2716bd(0x253)&&_0x33ab07==_0x5cb707){var _0x24493c=_0xca10a8[_0x2716bd(0x1f2)](0x3);_0x294c0e[_0x33ab07][_0x2716bd(0x246)]=_0xca10a8[0x0],_0x294c0e[_0x33ab07][_0x2716bd(0x204)]=_0xca10a8[0x1],_0x294c0e[_0x33ab07][_0x2716bd(0x283)]=0x0,_0x294c0e[_0x33ab07][_0x2716bd(0x224)]=0x0,_0x294c0e[_0x33ab07][_0x2716bd(0x27c)]='Floor',_0x294c0e[_0x33ab07]['floorlevel']=_0xca10a8[0x5];}else{if(_0x33ab07==_0x5cb707){var _0x4dd163;if(_0xca10a8[0x4]=='L')_0x4dd163=_0x2716bd(0x1ea);else _0xca10a8[0x4]=='F'&&(_0x4dd163=_0x2716bd(0x248));_0x294c0e[_0x33ab07]['storage']=_0xca10a8[0x0],_0x294c0e[_0x33ab07]['rack']=_0xca10a8[0x1],_0x294c0e[_0x33ab07][_0x2716bd(0x283)]=_0xca10a8[0x2],_0x294c0e[_0x33ab07][_0x2716bd(0x224)]=_0xca10a8[0x3],_0x294c0e[_0x33ab07][_0x2716bd(0x27c)]=_0x4dd163,_0x294c0e[_0x33ab07][_0x2716bd(0x216)]=_0xca10a8[0x5];}}}});}),_0x2c02c0[_0x546cb6(0x1f0)]((_0x27e773,_0x3943e0)=>{var _0x5ac911=_0x546cb6;_0x294c0e[_0x3943e0][_0x5ac911(0x1e6)]=_0x27e773;}),_0x384928[_0x546cb6(0x1f0)]((_0x1362e7,_0x28e474)=>{var _0xd81f75=_0x546cb6;_0x294c0e[_0x28e474][_0xd81f75(0x295)]=_0x1362e7;}),_0x1607eb[_0x546cb6(0x1f0)]((_0x1a8bee,_0xcbd998)=>{var _0x2acb54=_0x546cb6;_0x294c0e[_0xcbd998][_0x2acb54(0x1d8)]=_0x1a8bee;}),_0x5ee68d[_0x546cb6(0x1f0)]((_0x1a7de5,_0x11a11c)=>{var _0x4f8b60=_0x546cb6;_0x294c0e[_0x11a11c][_0x4f8b60(0x237)]=_0x1a7de5;}),_0x31f2e[_0x546cb6(0x1f0)]((_0x2dc172,_0x2fdb5)=>{var _0x596c50=_0x546cb6;_0x294c0e[_0x2fdb5][_0x596c50(0x261)]=_0x2dc172;}),_0x44a880[_0x546cb6(0x1f0)]((_0x38638f,_0x1c7b6a)=>{_0x294c0e[_0x1c7b6a]['secondary_unit']=_0x38638f;}),_0x1d987d['forEach']((_0x382b79,_0x1df0c9)=>{_0x294c0e[_0x1df0c9]['product_code']=_0x382b79;}),_0x3567dc[_0x546cb6(0x1f0)]((_0x4c7961,_0x4b913b)=>{var _0x28974a=_0x546cb6;_0x294c0e[_0x4b913b][_0x28974a(0x24b)]=_0x4c7961;}),_0xfd6c81[_0x546cb6(0x1f0)]((_0x800f09,_0x177e7a)=>{var _0x4f2d23=_0x546cb6;_0x294c0e[_0x177e7a][_0x4f2d23(0x249)]=_0x800f09;}),_0x28081a[_0x546cb6(0x1f0)]((_0x4a6c42,_0x4d1ede)=>{var _0x2602ae=_0x546cb6;_0x294c0e[_0x4d1ede][_0x2602ae(0x21e)]=_0x4a6c42;}),_0x5af409[_0x546cb6(0x1f0)]((_0x34dab4,_0x3edae4)=>{var _0x362631=_0x546cb6;_0x294c0e[_0x3edae4][_0x362631(0x1d6)]=_0x34dab4;}),_0x347f7a[_0x546cb6(0x1f0)]((_0x49e125,_0x50a75e)=>{var _0x4772ca=_0x546cb6;_0x294c0e[_0x50a75e][_0x4772ca(0x22d)]=_0x49e125;}),_0x281890[_0x546cb6(0x1f0)]((_0xf4ad28,_0x3bde74)=>{var _0x27c73d=_0x546cb6;_0x294c0e[_0x3bde74][_0x27c73d(0x1ef)]=_0xf4ad28;}),_0x3d88b1[_0x546cb6(0x1f0)]((_0x429c1e,_0x1f03c0)=>{var _0x48ae77=_0x546cb6;_0x294c0e[_0x1f03c0][_0x48ae77(0x242)]=_0x429c1e;}),_0x53e0e6[_0x546cb6(0x1f0)]((_0x12991f,_0x14d3d4)=>{var _0x47e3b0=_0x546cb6;_0x294c0e[_0x14d3d4][_0x47e3b0(0x23a)]=_0x12991f;}),_0x2e1f63[_0x546cb6(0x1f0)]((_0x48ea96,_0x4f9836)=>{var _0x3a3f7a=_0x546cb6;_0x294c0e[_0x4f9836][_0x3a3f7a(0x1db)]=_0x48ea96;});const _0x3fea57=_0x294c0e[_0x546cb6(0x277)](_0x504d4b=>_0x504d4b[_0x546cb6(0x1d8)]!=='0'&&_0x504d4b['adjust_qty']!=='');var _0x4643e7=0x0;_0x3fea57[_0x546cb6(0x1f0)](_0x5d2b72=>{var _0x5da823=_0x546cb6;console[_0x5da823(0x1f3)](_0x5da823(0x289),_0x5d2b72),parseInt(_0x5d2b72[_0x5da823(0x1d8)])<=0x0&&_0x4643e7++;});if(_0x4643e7!=0x0)return _0x517750[_0x546cb6(0x252)](_0x546cb6(0x21d),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x10167f[_0x546cb6(0x225)](_0x546cb6(0x255));const _0x45953a=new adjustment({'warehouse_name':_0x44d307,'date':_0x16d429,'product':_0x3fea57,'note':_0x40e2af,'room':_0x48a7c0,'invoice':_0x1aaecd,'JO_number':_0x219c8d,'expiry_date':_0x7a13ab}),_0xf2f3c8=await _0x45953a[_0x546cb6(0x278)]();_0x517750['flash'](_0x546cb6(0x28a),_0x546cb6(0x1e4)),_0x10167f['redirect'](_0x546cb6(0x26f)+_0xf2f3c8[_0x546cb6(0x220)]);}catch(_0x527da0){console[_0x546cb6(0x1f3)](_0x527da0),_0x10167f[_0x546cb6(0x29b)](0xc8)[_0x546cb6(0x1ec)]({'message':_0x527da0['message']});}}),router[a0_0x202759(0x296)]('/preview/:id',auth,async(_0x59931f,_0x131f17)=>{var _0x56189d=a0_0x202759;try{const {username:_0x20e6bb,email:_0xe6ee42,role:_0x34c7ee}=_0x59931f[_0x56189d(0x27f)],_0x3e6458=_0x59931f['user'],_0x59086f=await profile[_0x56189d(0x22c)]({'email':_0x3e6458[_0x56189d(0x215)]}),_0x346a23=await master_shop['find'](),_0x4a41a6=_0x59931f[_0x56189d(0x227)]['id'],_0x123204=await adjustment[_0x56189d(0x1df)]({'_id':_0x4a41a6}),_0x40801d=await purchases[_0x56189d(0x21a)]([{'$match':{'warehouse_name':_0x123204['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x56189d(0x238)}}]),_0x510ae4=await product['find']({}),_0x309ce4=await warehouse[_0x56189d(0x21a)]([{'$match':{'name':_0x123204[_0x56189d(0x280)]}},{'$unwind':_0x56189d(0x24e)},{'$group':{'_id':_0x56189d(0x20a),'name':{'$first':_0x56189d(0x27e)},'product_stock':{'$first':_0x56189d(0x285)},'bay':{'$first':_0x56189d(0x1d5)},'bin':{'$first':_0x56189d(0x259)},'type':{'$first':_0x56189d(0x1f9)},'floorlevel':{'$first':_0x56189d(0x226)},'primary_code':{'$first':_0x56189d(0x217)},'secondary_code':{'$first':_0x56189d(0x23e)},'product_code':{'$first':_0x56189d(0x1d1)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x56189d(0x221)},'maxPerUnit':{'$first':_0x56189d(0x236)},'expiry_date':{'$first':_0x56189d(0x23c)},'production_date':{'$first':_0x56189d(0x25e)},'batch_code':{'$first':_0x56189d(0x281)},'room':{'$first':_0x56189d(0x233)}}}]);if(_0x346a23[0x0][_0x56189d(0x1f7)]==_0x56189d(0x26c)){var _0x4153be=users[_0x56189d(0x264)];console[_0x56189d(0x1f3)](_0x4153be);}else{if(_0x346a23[0x0][_0x56189d(0x1f7)]==_0x56189d(0x288))var _0x4153be=users[_0x56189d(0x288)];else{if(_0x346a23[0x0][_0x56189d(0x1f7)]==_0x56189d(0x2a5))var _0x4153be=users['German'];else{if(_0x346a23[0x0][_0x56189d(0x1f7)]==_0x56189d(0x243))var _0x4153be=users[_0x56189d(0x243)];else{if(_0x346a23[0x0]['language']=='French')var _0x4153be=users[_0x56189d(0x20b)];else{if(_0x346a23[0x0][_0x56189d(0x1f7)]==_0x56189d(0x22a))var _0x4153be=users[_0x56189d(0x1ee)];else{if(_0x346a23[0x0][_0x56189d(0x1f7)]==_0x56189d(0x2a0))var _0x4153be=users['Chinese'];else{if(_0x346a23[0x0][_0x56189d(0x1f7)]==_0x56189d(0x1e1))var _0x4153be=users[_0x56189d(0x282)];}}}}}}}_0x131f17[_0x56189d(0x244)](_0x56189d(0x29a),{'success':_0x59931f[_0x56189d(0x252)](_0x56189d(0x28a)),'errors':_0x59931f[_0x56189d(0x252)](_0x56189d(0x21d)),'role':_0x3e6458,'profile':_0x59086f,'adjustment':_0x123204,'stock':_0x309ce4,'master_shop':_0x346a23,'warehouse_name':_0x40801d,'unit':_0x510ae4,'language':_0x4153be});}catch(_0x1a8c57){console['log'](_0x1a8c57),_0x131f17[_0x56189d(0x29b)](0xc8)['json']({'message':_0x1a8c57[_0x56189d(0x24f)]});}}),router['post'](a0_0x202759(0x231),auth,async(_0x1a803d,_0x25df04)=>{var _0x1c4ee0=a0_0x202759;try{const _0x47491d=_0x1a803d[_0x1c4ee0(0x227)]['id'],{warehouse_name:_0x426207,Room_name:_0x2be6d7}=_0x1a803d[_0x1c4ee0(0x1e3)],_0x1f6f1e=await adjustment[_0x1c4ee0(0x1df)]({'_id':_0x47491d}),_0x1a60bc=_0x1f6f1e[_0x1c4ee0(0x212)][_0x1c4ee0(0x202)](async _0x5b55a7=>{var _0x26ab92=_0x1c4ee0;if(_0x5b55a7['adjust_qty']>0x0){var _0x18a5ed=await warehouse[_0x26ab92(0x22c)]({'name':_0x426207,'room':_0x5b55a7[_0x26ab92(0x1ef)],'warehouse_category':_0x26ab92(0x28f)});const _0x115bfe=_0x18a5ed[_0x26ab92(0x1f5)][_0x26ab92(0x202)](_0x2f8b01=>{var _0x581dd8=_0x26ab92;if(_0x5b55a7[_0x581dd8(0x27c)]=='minus'){if(_0x2f8b01[_0x581dd8(0x21c)]==_0x5b55a7[_0x581dd8(0x21c)]&&_0x2f8b01[_0x581dd8(0x216)]==_0x5b55a7[_0x581dd8(0x216)]&&_0x2f8b01[_0x581dd8(0x27c)]==_0x5b55a7['type']&&_0x2f8b01[_0x581dd8(0x224)]==_0x5b55a7['bin']&&_0x2f8b01[_0x581dd8(0x283)]==_0x5b55a7[_0x581dd8(0x283)]&&_0x2f8b01[_0x581dd8(0x204)]==_0x5b55a7['rack']&&_0x2f8b01[_0x581dd8(0x246)]==_0x5b55a7[_0x581dd8(0x246)]&&_0x2f8b01[_0x581dd8(0x249)]==_0x5b55a7['expiry_date']&&_0x2f8b01[_0x581dd8(0x24b)]==_0x5b55a7[_0x581dd8(0x24b)]&&_0x2f8b01[_0x581dd8(0x1d6)]==_0x5b55a7['production_date']&&_0x2f8b01[_0x581dd8(0x1db)]==_0x5b55a7[_0x581dd8(0x1db)]){var _0x529d5d;_0x529d5d=_0x5b55a7['adjust_qty'],_0x5b55a7['prod_cat']=='S'&&(_0x529d5d=_0x5b55a7[_0x581dd8(0x1d8)]),_0x2f8b01[_0x581dd8(0x267)]=_0x2f8b01[_0x581dd8(0x267)]-_0x529d5d;}}else{if(_0x2f8b01['product_name']==_0x5b55a7[_0x581dd8(0x21c)]&&_0x2f8b01[_0x581dd8(0x216)]==_0x5b55a7[_0x581dd8(0x216)]&&_0x2f8b01['type']==_0x5b55a7[_0x581dd8(0x27c)]&&_0x2f8b01[_0x581dd8(0x224)]==_0x5b55a7[_0x581dd8(0x224)]&&_0x2f8b01[_0x581dd8(0x283)]==_0x5b55a7['bay']&&_0x2f8b01[_0x581dd8(0x204)]==_0x5b55a7[_0x581dd8(0x204)]&&_0x2f8b01[_0x581dd8(0x246)]==_0x5b55a7[_0x581dd8(0x246)]&&_0x2f8b01['expiry_date']==_0x5b55a7[_0x581dd8(0x249)]&&_0x2f8b01[_0x581dd8(0x24b)]==_0x5b55a7[_0x581dd8(0x24b)]&&_0x2f8b01[_0x581dd8(0x1d6)]==_0x5b55a7[_0x581dd8(0x1d6)]&&_0x2f8b01['invoice']==_0x5b55a7[_0x581dd8(0x1db)]){console[_0x581dd8(0x1f3)](_0x5b55a7);var _0x529d5d;_0x529d5d=_0x5b55a7[_0x581dd8(0x1d8)],_0x5b55a7[_0x581dd8(0x22d)]=='S'&&(_0x529d5d=_0x5b55a7[_0x581dd8(0x1d8)]),console[_0x581dd8(0x1f3)](_0x529d5d+_0x581dd8(0x22b)+_0x5b55a7[_0x581dd8(0x1d8)]+_0x581dd8(0x22b)+_0x2f8b01[_0x581dd8(0x240)]+_0x581dd8(0x22b)+_0x5b55a7[_0x581dd8(0x22d)]),_0x2f8b01[_0x581dd8(0x267)]=_0x2f8b01[_0x581dd8(0x267)]+_0x529d5d;}}});}return _0x18a5ed;});Promise['all'](_0x1a60bc)[_0x1c4ee0(0x1d3)](async _0x371c0f=>{var _0x3799ad=_0x1c4ee0;try{for(const _0x3165b2 of _0x371c0f){await _0x3165b2[_0x3799ad(0x278)]();}_0x1f6f1e[_0x3799ad(0x21f)]='True';const _0x235541=await _0x1f6f1e['save'](),_0x54983c=await master_shop['find'](),_0x826c66=await email_settings[_0x3799ad(0x22c)](),_0xe69215=await supervisor_settings[_0x3799ad(0x1ff)]();var _0x4a7617=_0x1f6f1e[_0x3799ad(0x212)],_0x4e35a7='',_0x1efe38;for(_0x1efe38 in _0x4a7617){_0x4e35a7+=_0x3799ad(0x1da)+_0x3799ad(0x1e0)+_0x4a7617[_0x1efe38][_0x3799ad(0x21c)]+_0x3799ad(0x26d)+_0x3799ad(0x1e0)+_0x4a7617[_0x1efe38]['product_code']+'</td>'+_0x3799ad(0x1e0)+_0x4a7617[_0x1efe38]['adjust_qty']+_0x3799ad(0x26d)+_0x3799ad(0x1e0)+_0x4a7617[_0x1efe38]['unit']+_0x3799ad(0x26d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4a7617[_0x1efe38][_0x3799ad(0x1dd)]+_0x3799ad(0x26d)+_0x3799ad(0x1e0)+_0x1f6f1e[_0x3799ad(0x280)]+_0x3799ad(0x26d)+_0x3799ad(0x1e0)+_0x4a7617[_0x1efe38][_0x3799ad(0x1ef)]+_0x3799ad(0x26d)+_0x3799ad(0x1e0)+_0x4a7617[_0x1efe38][_0x3799ad(0x246)]+_0x4a7617[_0x1efe38][_0x3799ad(0x204)]+_0x4a7617[_0x1efe38][_0x3799ad(0x283)]+_0x4a7617[_0x1efe38][_0x3799ad(0x224)]+_0x4a7617[_0x1efe38]['type'][0x0]+_0x4a7617[_0x1efe38][_0x3799ad(0x216)]+_0x3799ad(0x26d),_0x3799ad(0x1ce);}let _0x540d85=nodemailer[_0x3799ad(0x25c)]({'host':_0x826c66['host'],'port':Number(_0x826c66[_0x3799ad(0x201)]),'secure':![],'auth':{'user':_0x826c66[_0x3799ad(0x215)],'pass':_0x826c66[_0x3799ad(0x287)]}}),_0x25fce2={'from':_0x826c66[_0x3799ad(0x215)],'to':_0xe69215[0x0][_0x3799ad(0x266)],'subject':_0x3799ad(0x250),'attachments':[{'filename':_0x3799ad(0x299),'path':__dirname+_0x3799ad(0x24d)+_0x3799ad(0x20f)+_0x54983c[0x0][_0x3799ad(0x286)],'cid':_0x3799ad(0x2a2)}],'html':_0x3799ad(0x25b)+_0x3799ad(0x20c)+'</head><body>'+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x3799ad(0x2a1)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x3799ad(0x1e9)+_0x3799ad(0x2a1)+_0x3799ad(0x230)+_0x54983c[0x0]['site_title']+_0x3799ad(0x293)+_0x3799ad(0x1e9)+_0x3799ad(0x1e9)+_0x3799ad(0x210)+_0x3799ad(0x2a1)+_0x3799ad(0x222)+_0x3799ad(0x1eb)+_0x1f6f1e['invoice']+'\x20'+_0x3799ad(0x25f)+_0x3799ad(0x28e)+_0x1f6f1e[_0x3799ad(0x241)]+'\x20'+_0x3799ad(0x209)+_0x3799ad(0x228)+_0x3799ad(0x1e9)+_0x3799ad(0x1ed)+_0x3799ad(0x263)+_0x3799ad(0x1da)+_0x3799ad(0x1dc)+_0x3799ad(0x1c8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x3799ad(0x1f8)+_0x3799ad(0x245)+_0x3799ad(0x298)+_0x3799ad(0x1fe)+_0x3799ad(0x23f)+_0x3799ad(0x1ce)+_0x3799ad(0x256)+_0x3799ad(0x257)+'\x20'+_0x4e35a7+'\x20'+_0x3799ad(0x1d2)+'</table>'+_0x3799ad(0x2a1)+_0x3799ad(0x20e)+'<h5>'+_0x54983c[0x0][_0x3799ad(0x1e2)]+'</h5>'+_0x3799ad(0x1e9)+_0x3799ad(0x1e9)+_0x3799ad(0x1cd)};_0x540d85['sendMail'](_0x25fce2,function(_0x4a6add,_0x56302b){var _0x20a161=_0x3799ad;_0x4a6add?(console[_0x20a161(0x1f3)](_0x4a6add),console['log'](_0x20a161(0x218))):console['log'](_0x20a161(0x28c));}),_0x1a803d[_0x3799ad(0x252)](_0x3799ad(0x28a),_0x3799ad(0x268)),_0x25df04[_0x3799ad(0x225)](_0x3799ad(0x1fa)+_0x235541[_0x3799ad(0x220)]);}catch(_0x15055c){console[_0x3799ad(0x274)](_0x15055c),_0x25df04['status'](0x1f4)[_0x3799ad(0x1ec)]({'error':_0x3799ad(0x27b)});}})[_0x1c4ee0(0x27d)](_0x161ad1=>{var _0x57aaa7=_0x1c4ee0;console['error'](_0x161ad1),_0x25df04['status'](0x1f4)[_0x57aaa7(0x1ec)]({'error':'An\x20error\x20occurred.'});});}catch(_0x4117a3){console[_0x1c4ee0(0x1f3)](_0x4117a3),_0x25df04[_0x1c4ee0(0x29b)](0xc8)['json']({'message':_0x4117a3[_0x1c4ee0(0x24f)]});}}),router['get'](a0_0x202759(0x1fc),auth,async(_0x1dfe83,_0x486e14)=>{var _0x4651b1=a0_0x202759;try{const {username:_0xa8916,email:_0x14abb8,role:_0x23dad8}=_0x1dfe83[_0x4651b1(0x27f)],_0x19dc87=_0x1dfe83[_0x4651b1(0x27f)],_0x247aa3=await profile[_0x4651b1(0x22c)]({'email':_0x19dc87[_0x4651b1(0x215)]}),_0x498f3f=await master_shop['find'](),_0x3db67d=_0x1dfe83[_0x4651b1(0x227)]['id'],_0x979597=await adjustment[_0x4651b1(0x1df)]({'_id':_0x3db67d}),_0xf7e189=await purchases[_0x4651b1(0x21a)]([{'$match':{'warehouse_name':_0x979597[_0x4651b1(0x280)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x40bb92=await product[_0x4651b1(0x1ff)]({}),_0x34e0ab=await warehouse[_0x4651b1(0x21a)]([{'$match':{'name':_0x979597[_0x4651b1(0x280)]}},{'$unwind':_0x4651b1(0x24e)},{'$group':{'_id':_0x4651b1(0x20a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4651b1(0x285)},'bay':{'$first':_0x4651b1(0x1d5)},'bin':{'$first':_0x4651b1(0x259)},'type':{'$first':_0x4651b1(0x1f9)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4651b1(0x217)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4651b1(0x1d1)},'storage':{'$first':_0x4651b1(0x262)},'rack':{'$first':_0x4651b1(0x221)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4651b1(0x25e)},'batch_code':{'$first':_0x4651b1(0x281)},'room':{'$first':_0x4651b1(0x233)}}}]);let _0x262397;if(_0x19dc87[_0x4651b1(0x1f4)]=='staff'){const _0x1525fe=await staff['findOne']({'email':_0x19dc87[_0x4651b1(0x215)]});_0x262397=await warehouse[_0x4651b1(0x21a)]([{'$match':{'status':_0x4651b1(0x290),'name':_0x1525fe['warehouse'],'warehouse_category':_0x4651b1(0x28f),'name':{'$ne':_0x4651b1(0x26b)}}},{'$group':{'_id':_0x4651b1(0x292),'name':{'$first':_0x4651b1(0x292)}}}]);}else _0x262397=await warehouse[_0x4651b1(0x21a)]([{'$match':{'status':_0x4651b1(0x290),'warehouse_category':_0x4651b1(0x28f),'name':{'$ne':_0x4651b1(0x26b)}}},{'$group':{'_id':_0x4651b1(0x292),'name':{'$first':'$name'}}}]);if(_0x498f3f[0x0]['language']==_0x4651b1(0x26c)){var _0x3e8dd9=users['English'];console['log'](_0x3e8dd9);}else{if(_0x498f3f[0x0][_0x4651b1(0x1f7)]==_0x4651b1(0x288))var _0x3e8dd9=users[_0x4651b1(0x288)];else{if(_0x498f3f[0x0]['language']==_0x4651b1(0x2a5))var _0x3e8dd9=users[_0x4651b1(0x2a5)];else{if(_0x498f3f[0x0]['language']==_0x4651b1(0x243))var _0x3e8dd9=users[_0x4651b1(0x243)];else{if(_0x498f3f[0x0][_0x4651b1(0x1f7)]==_0x4651b1(0x20b))var _0x3e8dd9=users[_0x4651b1(0x20b)];else{if(_0x498f3f[0x0][_0x4651b1(0x1f7)]==_0x4651b1(0x22a))var _0x3e8dd9=users['Portuguese'];else{if(_0x498f3f[0x0]['language']==_0x4651b1(0x2a0))var _0x3e8dd9=users[_0x4651b1(0x2a0)];else{if(_0x498f3f[0x0][_0x4651b1(0x1f7)]==_0x4651b1(0x1e1))var _0x3e8dd9=users[_0x4651b1(0x282)];}}}}}}}_0x486e14['render']('edit_adjustment',{'success':_0x1dfe83[_0x4651b1(0x252)](_0x4651b1(0x28a)),'errors':_0x1dfe83[_0x4651b1(0x252)](_0x4651b1(0x21d)),'role':_0x19dc87,'profile':_0x247aa3,'adjustment':_0x979597,'stock':_0x34e0ab,'master_shop':_0x498f3f,'warehouse_name':_0xf7e189,'unit':_0x40bb92,'language':_0x3e8dd9,'warehouse':_0x262397});}catch(_0x560406){console[_0x4651b1(0x1f3)](_0x560406),_0x486e14['status'](0xc8)['json']({'message':_0x560406[_0x4651b1(0x24f)]});}}),router[a0_0x202759(0x272)](a0_0x202759(0x1fc),auth,async(_0x4a36cb,_0x2143c9)=>{var _0x3848de=a0_0x202759;try{const _0x2a0ea3=_0x4a36cb[_0x3848de(0x227)]['id'],_0x3f4e21=await adjustment[_0x3848de(0x1df)]({'_id':_0x2a0ea3}),_0x85afe6=await warehouse[_0x3848de(0x22c)]({'name':_0x3f4e21['warehouse_name'],'room':_0x3f4e21[_0x3848de(0x205)]}),{warehouse_name:_0x2260c2,date:_0x261650,prod_name:_0x1d3b4b,level:_0x117b99,isle:_0x9e6fa0,pallet:_0x34280b,stock:_0xd62e89,types:_0x2c831d,adjust_qty:_0x1af8f4,new_adjust_qty:_0x326e23,note:_0x4f742b,Room_name:_0x1a3c4d,invoice:_0x46f76f,JO_number:_0x2d2501,expiry_date:_0x4314e1}=_0x4a36cb[_0x3848de(0x1e3)];if(typeof _0x1d3b4b==_0x3848de(0x265))var _0x8c8db5=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x1cb)]],_0x3d241a=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x1ca)]],_0x2446ee=[_0x4a36cb['body'][_0x3848de(0x2a4)]],_0x147f52=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x295)]],_0x318e8a=[_0x4a36cb[_0x3848de(0x1e3)]['New_Qty_Converted_adj']],_0x1a3e36=[_0x4a36cb['body']['New_Qty_Converted']],_0x536f1a=[_0x4a36cb['body'][_0x3848de(0x21b)]],_0x2a98d5=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x203)]],_0x3f02a5=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x234)]],_0x6c29c1=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x24b)]],_0x1135b4=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x249)]],_0x20e5de=[_0x4a36cb['body']['max_per_unit']],_0x18ba96=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x1d6)]],_0x1fdf51=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x22d)]],_0x155587=[_0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x275)]],_0xfca733=[_0x4a36cb['body'][_0x3848de(0x251)]],_0x53bccd=[_0x4a36cb['body'][_0x3848de(0x219)]];else var _0x8c8db5=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x1cb)]],_0x3d241a=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x1ca)]],_0x2446ee=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x2a4)]],_0x147f52=[..._0x4a36cb[_0x3848de(0x1e3)]['types']],_0x318e8a=[..._0x4a36cb['body']['New_Qty_Converted_adj']],_0x1a3e36=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x23d)]],_0x536f1a=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x261)]],_0x2a98d5=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x203)]],_0x3f02a5=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x234)]],_0x6c29c1=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x24b)]],_0x1135b4=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x249)]],_0x20e5de=[..._0x4a36cb[_0x3848de(0x1e3)]['max_per_unit']],_0x18ba96=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x1d6)]],_0x1fdf51=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x22d)]],_0x155587=[..._0x4a36cb['body'][_0x3848de(0x275)]],_0xfca733=[..._0x4a36cb['body'][_0x3848de(0x251)]],_0x53bccd=[..._0x4a36cb[_0x3848de(0x1e3)][_0x3848de(0x219)]];const _0x3984cc=_0x8c8db5[_0x3848de(0x202)](_0x148825=>{return _0x148825={'product_name':_0x148825};});_0x3d241a[_0x3848de(0x1f0)]((_0x32502b,_0xcd841b)=>{_0x155587['forEach']((_0x403a8a,_0x288341)=>{var _0x4e44e6=a0_0x4513;if(_0x403a8a=='Receiving\x20Area'&&_0xcd841b==_0x288341){var _0x42ee3b=_0x32502b['slice'](0x3);_0x3984cc[_0xcd841b]['storage']=_0x32502b[0x0],_0x3984cc[_0xcd841b][_0x4e44e6(0x204)]=_0x32502b[0x1],_0x3984cc[_0xcd841b][_0x4e44e6(0x283)]=0x0,_0x3984cc[_0xcd841b][_0x4e44e6(0x224)]=0x0,_0x3984cc[_0xcd841b][_0x4e44e6(0x27c)]='Floor',_0x3984cc[_0xcd841b][_0x4e44e6(0x216)]=_0x42ee3b;}else{if(_0x403a8a=='Shelves'&&_0xcd841b==_0x288341){var _0x42ee3b=_0x32502b[_0x4e44e6(0x1f2)](0x3);_0x3984cc[_0xcd841b][_0x4e44e6(0x246)]=_0x32502b[0x0],_0x3984cc[_0xcd841b][_0x4e44e6(0x204)]=_0x32502b[0x1],_0x3984cc[_0xcd841b][_0x4e44e6(0x283)]=0x0,_0x3984cc[_0xcd841b]['bin']=0x0,_0x3984cc[_0xcd841b]['type']='Floor',_0x3984cc[_0xcd841b]['floorlevel']=_0x32502b[0x5];}else{if(_0xcd841b==_0x288341){var _0x39209e;if(_0x32502b[0x4]=='L')_0x39209e='Level';else _0x32502b[0x4]=='F'&&(_0x39209e=_0x4e44e6(0x248));_0x3984cc[_0xcd841b][_0x4e44e6(0x246)]=_0x32502b[0x0],_0x3984cc[_0xcd841b][_0x4e44e6(0x204)]=_0x32502b[0x1],_0x3984cc[_0xcd841b][_0x4e44e6(0x283)]=_0x32502b[0x2],_0x3984cc[_0xcd841b][_0x4e44e6(0x224)]=_0x32502b[0x3],_0x3984cc[_0xcd841b][_0x4e44e6(0x27c)]=_0x39209e,_0x3984cc[_0xcd841b][_0x4e44e6(0x216)]=_0x32502b[0x5];}}}});}),_0x2446ee['forEach']((_0x1ab5c4,_0x2d9128)=>{var _0x292416=_0x3848de;_0x3984cc[_0x2d9128][_0x292416(0x1e6)]=_0x1ab5c4;}),_0x147f52[_0x3848de(0x1f0)]((_0x47d5c6,_0x515dea)=>{var _0x37899f=_0x3848de;_0x3984cc[_0x515dea][_0x37899f(0x295)]=_0x47d5c6;}),_0x318e8a[_0x3848de(0x1f0)]((_0x52719a,_0x540fa4)=>{var _0x2748fb=_0x3848de;_0x3984cc[_0x540fa4][_0x2748fb(0x1d8)]=_0x52719a;}),_0x1a3e36[_0x3848de(0x1f0)]((_0x36ab64,_0x54ad41)=>{var _0x4e7ebc=_0x3848de;_0x3984cc[_0x54ad41][_0x4e7ebc(0x237)]=_0x36ab64;}),_0x536f1a[_0x3848de(0x1f0)]((_0x572a93,_0x31cd3b)=>{var _0x23216d=_0x3848de;_0x3984cc[_0x31cd3b][_0x23216d(0x261)]=_0x572a93;}),_0x2a98d5[_0x3848de(0x1f0)]((_0x3b35d2,_0x1f886b)=>{var _0x129a54=_0x3848de;_0x3984cc[_0x1f886b][_0x129a54(0x1dd)]=_0x3b35d2;}),_0x3f02a5[_0x3848de(0x1f0)]((_0x58c178,_0x333d3d)=>{var _0x18be53=_0x3848de;_0x3984cc[_0x333d3d][_0x18be53(0x27a)]=_0x58c178;}),_0x6c29c1[_0x3848de(0x1f0)]((_0x3d09ff,_0x368570)=>{var _0x3dd680=_0x3848de;_0x3984cc[_0x368570][_0x3dd680(0x24b)]=_0x3d09ff;}),_0x1135b4[_0x3848de(0x1f0)]((_0x455651,_0x31e1d6)=>{var _0x2ed56c=_0x3848de;_0x3984cc[_0x31e1d6][_0x2ed56c(0x249)]=_0x455651;}),_0x20e5de[_0x3848de(0x1f0)]((_0x3f639b,_0x20f476)=>{_0x3984cc[_0x20f476]['maxperunit']=_0x3f639b;}),_0x18ba96['forEach']((_0x542ec3,_0x3786a4)=>{var _0x4ae5f7=_0x3848de;_0x3984cc[_0x3786a4][_0x4ae5f7(0x1d6)]=_0x542ec3;}),_0x1fdf51[_0x3848de(0x1f0)]((_0x594c8c,_0x328c20)=>{var _0x549c38=_0x3848de;_0x3984cc[_0x328c20][_0x549c38(0x22d)]=_0x594c8c;}),_0x155587[_0x3848de(0x1f0)]((_0x2e6f69,_0x4d5dc0)=>{var _0x3100c4=_0x3848de;_0x3984cc[_0x4d5dc0][_0x3100c4(0x1ef)]=_0x2e6f69;}),_0xfca733[_0x3848de(0x1f0)]((_0x4800cc,_0x5af661)=>{var _0x1d539a=_0x3848de;_0x3984cc[_0x5af661][_0x1d539a(0x242)]=_0x4800cc;}),_0x53bccd[_0x3848de(0x1f0)]((_0x339c76,_0x4a88df)=>{_0x3984cc[_0x4a88df]['secondary_code']=_0x339c76;});const _0x436d8b=_0x3984cc[_0x3848de(0x277)](_0x1296fa=>_0x1296fa[_0x3848de(0x1d8)]!=='0'&&_0x1296fa[_0x3848de(0x1d8)]!=='');var _0x3517ed=0x0;_0x436d8b[_0x3848de(0x1f0)](_0x3b9fb8=>{var _0x19de2e=_0x3848de;console[_0x19de2e(0x1f3)](_0x19de2e(0x289),_0x3b9fb8),parseInt(_0x3b9fb8['adjust_qty'])<=0x0&&_0x3517ed++;});if(_0x3517ed!=0x0)return _0x4a36cb[_0x3848de(0x252)](_0x3848de(0x21d),_0x3848de(0x2a6)),_0x2143c9['redirect'](_0x3848de(0x255));_0x3f4e21[_0x3848de(0x280)]=_0x2260c2,_0x3f4e21[_0x3848de(0x241)]=_0x261650,_0x3f4e21['product']=_0x436d8b,_0x3f4e21[_0x3848de(0x1e5)]=_0x4f742b,_0x3f4e21['invoice']=_0x46f76f,_0x3f4e21[_0x3848de(0x25a)]='False';const _0x147b86=await _0x3f4e21[_0x3848de(0x278)]();_0x4a36cb[_0x3848de(0x252)](_0x3848de(0x28a),_0x3848de(0x28b)),_0x2143c9[_0x3848de(0x225)](_0x3848de(0x1c9));}catch(_0xf03b39){console[_0x3848de(0x1f3)](_0xf03b39);}}),router[a0_0x202759(0x272)](a0_0x202759(0x260),async(_0x520c6c,_0x44d697)=>{var _0x57048e=a0_0x202759;const {primary_code:_0x55170d,warehouse_data:_0x32d03a,rooms_data:_0x2da969,Roomslist:_0x47799a}=_0x520c6c['body'],_0x4820db=_0x47799a[_0x57048e(0x284)](','),_0x50d358=[];async function _0x3a12eb(_0x378aca){var _0x6c9fb0=_0x57048e;const _0x4f3eeb=await warehouse[_0x6c9fb0(0x21a)]([{'$match':{'name':_0x32d03a,'room':_0x378aca}},{'$unwind':_0x6c9fb0(0x24e)},{'$match':{'product_details.primary_code':_0x55170d}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x6c9fb0(0x27e)},'product_stock':{'$first':_0x6c9fb0(0x285)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x6c9fb0(0x23e)},'product_code':{'$first':_0x6c9fb0(0x1d1)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x6c9fb0(0x259)},'type':{'$first':_0x6c9fb0(0x1f9)},'pallet':{'$first':_0x6c9fb0(0x226)},'unit':{'$first':_0x6c9fb0(0x247)},'secondary_unit':{'$first':_0x6c9fb0(0x223)},'storage':{'$first':_0x6c9fb0(0x262)},'rack':{'$first':_0x6c9fb0(0x221)},'expiry_date':{'$first':_0x6c9fb0(0x23c)},'production_date':{'$first':_0x6c9fb0(0x25e)},'maxPerUnit':{'$first':_0x6c9fb0(0x236)},'batch_code':{'$first':_0x6c9fb0(0x281)},'product_cat':{'$first':_0x6c9fb0(0x294)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x6c9fb0(0x233)}}}]),_0x3cb361=await warehouse[_0x6c9fb0(0x21a)]([{'$match':{'name':_0x32d03a,'room':_0x378aca}},{'$unwind':_0x6c9fb0(0x24e)},{'$match':{'product_details.secondary_code':_0x55170d}},{'$group':{'_id':_0x6c9fb0(0x20a),'name':{'$first':_0x6c9fb0(0x27e)},'product_stock':{'$first':_0x6c9fb0(0x285)},'primary_code':{'$first':_0x6c9fb0(0x217)},'secondary_code':{'$first':_0x6c9fb0(0x23e)},'product_code':{'$first':_0x6c9fb0(0x1d1)},'level':{'$first':_0x6c9fb0(0x1d5)},'isle':{'$first':_0x6c9fb0(0x259)},'type':{'$first':_0x6c9fb0(0x1f9)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x6c9fb0(0x262)},'rack':{'$first':_0x6c9fb0(0x221)},'expiry_date':{'$first':_0x6c9fb0(0x23c)},'production_date':{'$first':_0x6c9fb0(0x25e)},'maxPerUnit':{'$first':_0x6c9fb0(0x236)},'batch_code':{'$first':_0x6c9fb0(0x281)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x6c9fb0(0x233)}}}]);if(_0x4f3eeb[_0x6c9fb0(0x206)]>0x0)_0x50d358[_0x6c9fb0(0x24a)](_0x4f3eeb);else _0x3cb361[_0x6c9fb0(0x206)]>0x0&&_0x50d358['push'](_0x3cb361);}const _0x61d160=_0x4820db[_0x57048e(0x202)](_0x30f55c=>_0x3a12eb(_0x30f55c));await Promise[_0x57048e(0x1e8)](_0x61d160),_0x44d697[_0x57048e(0x1ec)](_0x50d358);}),router[a0_0x202759(0x272)](a0_0x202759(0x211),async(_0x310174,_0x4d9515)=>{var _0xca38e5=a0_0x202759;const {primaryCode:_0x39f1c0,secondaryCode:_0x49ebcb,productCode:_0x12ea8d,level:_0x5671d0,isle:_0x4d6bcd,pallet:_0x33f9ba,warehouses:_0xbf7688,room:_0x503d67}=_0x310174['body'];try{const _0x1ad54f=await warehouse[_0xca38e5(0x21a)]([{'$match':{'name':_0xbf7688,'room':_0x503d67}},{'$unwind':_0xca38e5(0x24e)},{'$match':{'product_details.level':parseInt(_0x5671d0),'product_details.isle':_0x4d6bcd,'product_details.pallet':parseInt(_0x33f9ba)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0xca38e5(0x229)},'isle':{'$first':_0xca38e5(0x297)},'pallet':{'$first':_0xca38e5(0x1d7)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x4d9515[_0xca38e5(0x29b)](0xc8)['json'](_0x1ad54f);}catch(_0x5f45d8){_0x4d9515[_0xca38e5(0x29b)](0x194)['json']({'message':_0x5f45d8[_0xca38e5(0x24f)]});}}),module[a0_0x202759(0x22e)]=router;