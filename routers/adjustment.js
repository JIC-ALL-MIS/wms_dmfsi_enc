var a0_0x84cd4a=a0_0x20e8;function a0_0x20e8(_0x107243,_0x38edda){var _0x21dbe8=a0_0x21db();return a0_0x20e8=function(_0x20e8e5,_0x22efc0){_0x20e8e5=_0x20e8e5-0x1aa;var _0x2d1e01=_0x21dbe8[_0x20e8e5];return _0x2d1e01;},a0_0x20e8(_0x107243,_0x38edda);}(function(_0x2e95a6,_0x156e40){var _0x48e7bb=a0_0x20e8,_0x4ea4de=_0x2e95a6();while(!![]){try{var _0x4bae57=-parseInt(_0x48e7bb(0x1c1))/0x1+-parseInt(_0x48e7bb(0x1ed))/0x2*(parseInt(_0x48e7bb(0x230))/0x3)+parseInt(_0x48e7bb(0x1b4))/0x4*(-parseInt(_0x48e7bb(0x1c9))/0x5)+-parseInt(_0x48e7bb(0x1ae))/0x6+-parseInt(_0x48e7bb(0x234))/0x7+parseInt(_0x48e7bb(0x219))/0x8*(parseInt(_0x48e7bb(0x20d))/0x9)+parseInt(_0x48e7bb(0x242))/0xa;if(_0x4bae57===_0x156e40)break;else _0x4ea4de['push'](_0x4ea4de['shift']());}catch(_0x31a4df){_0x4ea4de['push'](_0x4ea4de['shift']());}}}(a0_0x21db,0xe4dd5));const express=require(a0_0x84cd4a(0x1d0)),app=express(),router=express[a0_0x84cd4a(0x220)](),auth=require(a0_0x84cd4a(0x26b)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x84cd4a(0x1b9)),users=require(a0_0x84cd4a(0x25f)),nodemailer=require('nodemailer');function a0_0x21db(){var _0xd4bbd7=['redirect','$product_details.storage','find','/../public','/barcode_scanner','secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','An\x20error\x20occurred.','floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','</span>','warehouse','$product_details.primary_code','bay','\x20</h2>','room_names','unit','Spanish','../public/language/languages.json','filter','$product_details.product_stock','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','production_date','False','<tbody\x20style=\x22text-align:\x20center;\x22>','<div>','forEach','site_title','True','../middleware/auth','Portuguese','findById','prod_cat','map','findOne','stock','$room','types','$product_details.production_date','Logo.png','new_adjust_qty','English','sendMail','An\x20error\x20occurred\x20while\x20saving\x20data.','email','get','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product','\x20Order\x20Number\x20:\x20','port','room','edit_adjustment','then','password','/CheckingWarehouse','New_Qty_Converted','master','secondary_unit','log','body','1666416gPiLIS','/view','split','Portuguese\x20(BR)','image','aggregate','452BSNQdR','note','edit_adjustment_view','$product_details.level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','../models/all_models','prod_code','/preview/:id','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<strong>\x20Regards\x20</strong>','role','maxPerUnit','1585323LtyjBf','/adjustment/preview/','flash','user','<h5\x20style=\x22text-align:\x20left;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$_id','$product_details.secondary_unit','17230xrmLVV','slice','RMSEmail','Adjustment\x20Mail','params','Arabic','maxperunit','express','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$warehouse_name','language','$product_details.rack','all','string','floorlevel','/view/add_adjustment','staff','</h5>','Chinese','back','product_stock','French','foreach\x20newproduct','$product_details','</tbody>','$product_details._id','Primary_Units','$product.room_names','prod_invoice','save','padStart','$product_details.unit','ADJ-','stockBefore','Return\x20Goods','invoice','68IAMill','rack','Rooms','/view/:id','$isAllowEdit','$finalize','$product_details.maxPerUnit','Level','$product_details.product_code','Email\x20sent\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Raw\x20Materials','type','length','adjustment','message','_id','There\x27s\x20a\x20error\x20in\x20this\x20transaction','bin','$product_details.batch_code','adjustment\x20Finalized\x20successfully','success','$product_details.bay','<h2>\x20','$product_details.floorlevel','second1','$product_details.product_name','prod_name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_name','product_code','errors','63qLqcWL','</body></html>','/upload/','$product_details.pallet','Arabic\x20(ae)','post','Enabled','Receiving\x20Area','Floor','/picking_list/PDF_adjustment_rm/','$date','$product_details.type','1654696OKjRGC','error','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','expiry_date','toString','storage','Router','Return\x20Rooms','Enclosed','warehouse_name','Shelves','status','add_adjustment','level','random','Hindi','$product_details.secondary_code','Secondary_units','$invoice','json','</div>','product','141981bxYeyQ','product_details','adjustment\x20data\x20update\x20successfully','adjust_qty','5948936ZuPYuH','primary_code','$product_details.product_cat','</td>','catch','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','New_Qty_Converted_adj','<!DOCTYPE\x20html>','batch_code','exports','render','push','date','prime1','42009930iTpkTy','English\x20(US)','$product_details.bin','Error\x20Occurs','German','max_per_unit','\x20<>\x20','$name','$product_details.maxProducts','<h5>','/adjustment/view'];a0_0x21db=function(){return _0xd4bbd7;};return a0_0x21db();}router[a0_0x84cd4a(0x27b)](a0_0x84cd4a(0x1af),auth,async(_0x4e09e5,_0x2893e8)=>{var _0xc8ee61=a0_0x84cd4a;try{const {username:_0x3713df,email:_0x55dd20,role:_0xbeb5c9}=_0x4e09e5[_0xc8ee61(0x1c4)],_0x865b4e=_0x4e09e5['user'],_0x502d23=await profile['findOne']({'email':_0x865b4e[_0xc8ee61(0x27a)]}),_0x475b05=await master_shop[_0xc8ee61(0x24f)]();console[_0xc8ee61(0x1ac)](_0xc8ee61(0x1aa),_0x475b05);let _0x27a098;if(_0x865b4e[_0xc8ee61(0x1bf)]=='staff'){const _0x2cec7c=await staff['findOne']({'email':_0x865b4e[_0xc8ee61(0x27a)]});_0x27a098=await warehouse['find']({'status':_0xc8ee61(0x213),'name':_0x2cec7c[_0xc8ee61(0x258)]});}else _0x27a098=await warehouse[_0xc8ee61(0x24f)]({'status':_0xc8ee61(0x213)});const _0x5ab627=await product[_0xc8ee61(0x24f)]();let _0x4af054;if(_0x865b4e[_0xc8ee61(0x1bf)]==_0xc8ee61(0x1d9)){const _0x4a578a=await staff['findOne']({'email':_0x865b4e[_0xc8ee61(0x27a)]});_0x4af054=await adjustment['find']({'warehouse_name':_0x4a578a[_0xc8ee61(0x258)]});}else _0x4af054=await adjustment[_0xc8ee61(0x1b3)]([{'$unwind':_0xc8ee61(0x27d)},{'$group':{'_id':_0xc8ee61(0x1c7),'invoice':{'$first':_0xc8ee61(0x22c)},'date':{'$first':_0xc8ee61(0x217)},'warehouse_name':{'$first':_0xc8ee61(0x1d2)},'room':{'$addToSet':_0xc8ee61(0x1e4)},'finalize':{'$first':_0xc8ee61(0x1f2)},'isAllowEdit':{'$first':_0xc8ee61(0x1f1)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x475b05[0x0][_0xc8ee61(0x1d3)]==_0xc8ee61(0x243)){var _0xc0527e=users[_0xc8ee61(0x277)];console[_0xc8ee61(0x1ac)](_0xc0527e);}else{if(_0x475b05[0x0][_0xc8ee61(0x1d3)]=='Hindi')var _0xc0527e=users[_0xc8ee61(0x229)];else{if(_0x475b05[0x0][_0xc8ee61(0x1d3)]==_0xc8ee61(0x246))var _0xc0527e=users[_0xc8ee61(0x246)];else{if(_0x475b05[0x0]['language']=='Spanish')var _0xc0527e=users[_0xc8ee61(0x25e)];else{if(_0x475b05[0x0][_0xc8ee61(0x1d3)]==_0xc8ee61(0x1de))var _0xc0527e=users['French'];else{if(_0x475b05[0x0][_0xc8ee61(0x1d3)]=='Portuguese\x20(BR)')var _0xc0527e=users[_0xc8ee61(0x26c)];else{if(_0x475b05[0x0][_0xc8ee61(0x1d3)]==_0xc8ee61(0x1db))var _0xc0527e=users[_0xc8ee61(0x1db)];else{if(_0x475b05[0x0][_0xc8ee61(0x1d3)]==_0xc8ee61(0x211))var _0xc0527e=users[_0xc8ee61(0x1ce)];}}}}}}}_0x2893e8[_0xc8ee61(0x23e)](_0xc8ee61(0x1fb),{'success':_0x4e09e5['flash'](_0xc8ee61(0x202)),'errors':_0x4e09e5[_0xc8ee61(0x1c3)](_0xc8ee61(0x20c)),'role':_0x865b4e,'profile':_0x502d23,'warehouse':_0x27a098,'product':_0x5ab627,'adjustment':_0x4af054,'master_shop':_0x475b05,'language':_0xc0527e});}catch(_0x4e0b1f){console[_0xc8ee61(0x1ac)](_0x4e0b1f);}});async function getRandom8DigitNumber(){var _0x2eacd2=a0_0x84cd4a;const _0x1dcfb8=0x989680,_0x530d22=0x5f5e0ff,_0x39fc67=Math[_0x2eacd2(0x255)](Math[_0x2eacd2(0x228)]()*(_0x530d22-_0x1dcfb8+0x1))+_0x1dcfb8;var _0x479a90;const _0x1771f1=await adjustment[_0x2eacd2(0x270)]({'invoice':_0x2eacd2(0x1e9)+_0x39fc67});return _0x1771f1&&_0x1771f1[_0x2eacd2(0x1fa)]>0x0?_0x479a90=_0x2eacd2(0x1e9)+_0x39fc67:_0x479a90=_0x2eacd2(0x1e9)+_0x39fc67,_0x479a90;}router['get'](a0_0x84cd4a(0x1d8),auth,async(_0x3eb241,_0x116a85)=>{var _0x298202=a0_0x84cd4a;try{const {username:_0x19a317,email:_0xda164c,role:_0x5c29c7}=_0x3eb241[_0x298202(0x1c4)],_0x11b806=_0x3eb241[_0x298202(0x1c4)],_0x593966=await profile[_0x298202(0x270)]({'email':_0x11b806[_0x298202(0x27a)]}),_0x5ad8c7=await master_shop[_0x298202(0x24f)]();let _0x522f28;if(_0x11b806['role']==_0x298202(0x1d9)){const _0x53396d=await staff[_0x298202(0x270)]({'email':_0x11b806[_0x298202(0x27a)]});_0x522f28=await warehouse[_0x298202(0x1b3)]([{'$match':{'status':'Enabled','name':_0x53396d[_0x298202(0x258)],'warehouse_category':_0x298202(0x1f8),'name':{'$ne':_0x298202(0x1eb)}}},{'$group':{'_id':_0x298202(0x249),'name':{'$first':_0x298202(0x249)}}}]);}else _0x522f28=await warehouse[_0x298202(0x1b3)]([{'$match':{'status':_0x298202(0x213),'warehouse_category':_0x298202(0x1f8),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x298202(0x249),'name':{'$first':'$name'}}}]);const _0x47c34c=await product[_0x298202(0x24f)]({}),_0x5091f4=await adjustment[_0x298202(0x24f)]({}),_0x22bbca=_0x5091f4[_0x298202(0x1fa)]+0x1,_0x172be='ADJ-'+_0x22bbca[_0x298202(0x21e)]()[_0x298202(0x1e7)](0x5,'0');var _0x2f561d=['Ambient',_0x298202(0x222),_0x298202(0x221)];if(_0x5ad8c7[0x0][_0x298202(0x1d3)]==_0x298202(0x243))var _0xe5a7a2=users['English'];else{if(_0x5ad8c7[0x0][_0x298202(0x1d3)]==_0x298202(0x229))var _0xe5a7a2=users[_0x298202(0x229)];else{if(_0x5ad8c7[0x0][_0x298202(0x1d3)]==_0x298202(0x246))var _0xe5a7a2=users[_0x298202(0x246)];else{if(_0x5ad8c7[0x0]['language']==_0x298202(0x25e))var _0xe5a7a2=users[_0x298202(0x25e)];else{if(_0x5ad8c7[0x0][_0x298202(0x1d3)]==_0x298202(0x1de))var _0xe5a7a2=users[_0x298202(0x1de)];else{if(_0x5ad8c7[0x0][_0x298202(0x1d3)]=='Portuguese\x20(BR)')var _0xe5a7a2=users[_0x298202(0x26c)];else{if(_0x5ad8c7[0x0][_0x298202(0x1d3)]==_0x298202(0x1db))var _0xe5a7a2=users[_0x298202(0x1db)];else{if(_0x5ad8c7[0x0]['language']==_0x298202(0x211))var _0xe5a7a2=users['Arabic'];}}}}}}}const _0xfaea2c=getRandom8DigitNumber();_0xfaea2c['then'](_0x21ad2a=>{var _0x498a98=_0x298202;_0x116a85[_0x498a98(0x23e)](_0x498a98(0x226),{'success':_0x3eb241[_0x498a98(0x1c3)](_0x498a98(0x202)),'errors':_0x3eb241[_0x498a98(0x1c3)](_0x498a98(0x20c)),'role':_0x11b806,'profile':_0x593966,'warehouse':_0x522f28,'product':_0x47c34c,'master_shop':_0x5ad8c7,'language':_0xe5a7a2,'rooms_data':_0x2f561d,'invoice_no':_0x21ad2a});})[_0x298202(0x238)](_0x5f12ea=>{var _0x7ea52d=_0x298202;_0x3eb241[_0x7ea52d(0x1c3)](_0x7ea52d(0x20c),_0x7ea52d(0x1fe)),_0x116a85[_0x7ea52d(0x24d)](_0x7ea52d(0x24c));});}catch(_0x54b50e){console[_0x298202(0x1ac)](_0x54b50e);}}),router[a0_0x84cd4a(0x212)](a0_0x84cd4a(0x1d8),auth,async(_0x142aa8,_0x106c37)=>{var _0x17097d=a0_0x84cd4a;try{const {warehouse_name:_0x4fb1e9,date:_0x4d388f,prod_name:_0x474f9c,level:_0x147f1c,isle:_0x1ee87a,pallet:_0x3859b6,stock:_0x273c59,types:_0x5599c7,adjust_qty:_0x2976b9,new_adjust_qty:_0x3789d5,note:_0x449097,Room_name:_0x2651cb,invoice:_0x4dfd87,JO_number:_0x5ab77d,expiry_date:_0x194a06}=_0x142aa8[_0x17097d(0x1ad)];if(typeof _0x474f9c==_0x17097d(0x1d6))var _0x47615a=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x208)]],_0x2bdab4=[_0x142aa8['body'][_0x17097d(0x227)]],_0x361fcf=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x271)]],_0x170b03=[_0x142aa8[_0x17097d(0x1ad)]['types']],_0x553dbb=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x23a)]],_0x4126c2=[_0x142aa8[_0x17097d(0x1ad)]['New_Qty_Converted']],_0x3a0ce1=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x1e3)]],_0x2ca9cc=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x22b)]],_0x3d82e9=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x1ba)]],_0x46f1fe=[_0x142aa8[_0x17097d(0x1ad)]['batch_code']],_0x44484d=[_0x142aa8['body'][_0x17097d(0x21d)]],_0x3deef0=[_0x142aa8[_0x17097d(0x1ad)]['max_per_unit']],_0x192fd4=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x264)]],_0x366558=[_0x142aa8['body']['prod_cat']],_0x4737c7=[_0x142aa8['body'][_0x17097d(0x1ef)]],_0x2552ea=[_0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x241)]],_0x7cc908=[_0x142aa8['body']['second1']],_0x38d11d=[_0x142aa8[_0x17097d(0x1ad)]['prod_invoice']];else var _0x47615a=[..._0x142aa8[_0x17097d(0x1ad)]['prod_name']],_0x2bdab4=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x227)]],_0x361fcf=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x271)]],_0x170b03=[..._0x142aa8[_0x17097d(0x1ad)]['types']],_0x553dbb=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x23a)]],_0x4126c2=[..._0x142aa8['body'][_0x17097d(0x285)]],_0x3a0ce1=[..._0x142aa8[_0x17097d(0x1ad)]['unit']],_0x2ca9cc=[..._0x142aa8[_0x17097d(0x1ad)]['Secondary_units']],_0x3d82e9=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x1ba)]],_0x46f1fe=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x23c)]],_0x44484d=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x21d)]],_0x3deef0=[..._0x142aa8[_0x17097d(0x1ad)]['max_per_unit']],_0x192fd4=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x264)]],_0x366558=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x26e)]],_0x4737c7=[..._0x142aa8[_0x17097d(0x1ad)]['Rooms']],_0x2552ea=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x241)]],_0x7cc908=[..._0x142aa8['body']['second1']],_0x38d11d=[..._0x142aa8[_0x17097d(0x1ad)][_0x17097d(0x1e5)]];const _0x5dac7e=_0x47615a[_0x17097d(0x26f)](_0xc357a7=>{return _0xc357a7={'product_name':_0xc357a7};});_0x2bdab4[_0x17097d(0x268)]((_0x35a083,_0x55695e)=>{var _0x469889=_0x17097d;_0x4737c7[_0x469889(0x268)]((_0x45178e,_0x18ef71)=>{var _0x311161=_0x469889;if(_0x45178e==_0x311161(0x214)&&_0x55695e==_0x18ef71){var _0x4cc8b9=_0x35a083[_0x311161(0x1ca)](0x3);_0x5dac7e[_0x55695e][_0x311161(0x21f)]=_0x35a083[0x0],_0x5dac7e[_0x55695e]['rack']=_0x35a083[0x1],_0x5dac7e[_0x55695e][_0x311161(0x25a)]=0x0,_0x5dac7e[_0x55695e]['bin']=0x0,_0x5dac7e[_0x55695e][_0x311161(0x1f9)]=_0x311161(0x215),_0x5dac7e[_0x55695e]['floorlevel']=_0x4cc8b9;}else{if(_0x45178e=='Shelves'&&_0x55695e==_0x18ef71){var _0x4cc8b9=_0x35a083[_0x311161(0x1ca)](0x3);_0x5dac7e[_0x55695e]['storage']=_0x35a083[0x0],_0x5dac7e[_0x55695e][_0x311161(0x1ee)]=_0x35a083[0x1],_0x5dac7e[_0x55695e][_0x311161(0x25a)]=0x0,_0x5dac7e[_0x55695e]['bin']=0x0,_0x5dac7e[_0x55695e][_0x311161(0x1f9)]=_0x311161(0x215),_0x5dac7e[_0x55695e][_0x311161(0x1d7)]=_0x35a083[0x5];}else{if(_0x55695e==_0x18ef71){var _0x239046;if(_0x35a083[0x4]=='L')_0x239046='Level';else _0x35a083[0x4]=='F'&&(_0x239046=_0x311161(0x215));_0x5dac7e[_0x55695e][_0x311161(0x21f)]=_0x35a083[0x0],_0x5dac7e[_0x55695e]['rack']=_0x35a083[0x1],_0x5dac7e[_0x55695e][_0x311161(0x25a)]=_0x35a083[0x2],_0x5dac7e[_0x55695e][_0x311161(0x1ff)]=_0x35a083[0x3],_0x5dac7e[_0x55695e][_0x311161(0x1f9)]=_0x239046,_0x5dac7e[_0x55695e][_0x311161(0x1d7)]=_0x35a083[0x5];}}}});}),_0x361fcf[_0x17097d(0x268)]((_0x23644b,_0x406807)=>{_0x5dac7e[_0x406807]['stockBefore']=_0x23644b;}),_0x170b03['forEach']((_0x5889dc,_0x43ed76)=>{var _0xbffe3b=_0x17097d;_0x5dac7e[_0x43ed76][_0xbffe3b(0x273)]=_0x5889dc;}),_0x553dbb[_0x17097d(0x268)]((_0x2e27cb,_0x4fd28b)=>{var _0xc9fdc6=_0x17097d;_0x5dac7e[_0x4fd28b][_0xc9fdc6(0x233)]=_0x2e27cb;}),_0x4126c2[_0x17097d(0x268)]((_0x50e21b,_0x468637)=>{var _0x1b82dd=_0x17097d;_0x5dac7e[_0x468637][_0x1b82dd(0x276)]=_0x50e21b;}),_0x3a0ce1['forEach']((_0x2ac9ad,_0x597714)=>{var _0x4f85de=_0x17097d;_0x5dac7e[_0x597714][_0x4f85de(0x25d)]=_0x2ac9ad;}),_0x2ca9cc[_0x17097d(0x268)]((_0x269f4a,_0x3bd200)=>{var _0x390d07=_0x17097d;_0x5dac7e[_0x3bd200][_0x390d07(0x1ab)]=_0x269f4a;}),_0x3d82e9[_0x17097d(0x268)]((_0x2a35cd,_0x3410e8)=>{_0x5dac7e[_0x3410e8]['product_code']=_0x2a35cd;}),_0x46f1fe[_0x17097d(0x268)]((_0x4c9f6f,_0x355f9b)=>{var _0x465273=_0x17097d;_0x5dac7e[_0x355f9b][_0x465273(0x23c)]=_0x4c9f6f;}),_0x44484d[_0x17097d(0x268)]((_0xec272d,_0x29790c)=>{var _0x3f8c6e=_0x17097d;_0x5dac7e[_0x29790c][_0x3f8c6e(0x21d)]=_0xec272d;}),_0x3deef0[_0x17097d(0x268)]((_0x3bdad7,_0x575838)=>{_0x5dac7e[_0x575838]['maxperunit']=_0x3bdad7;}),_0x192fd4[_0x17097d(0x268)]((_0x23f03f,_0x18d96b)=>{var _0x2540c0=_0x17097d;_0x5dac7e[_0x18d96b][_0x2540c0(0x264)]=_0x23f03f;}),_0x366558[_0x17097d(0x268)]((_0x298cb1,_0x14220f)=>{var _0x101671=_0x17097d;_0x5dac7e[_0x14220f][_0x101671(0x26e)]=_0x298cb1;}),_0x4737c7['forEach']((_0xd2cea6,_0x10e20c)=>{var _0x24b314=_0x17097d;_0x5dac7e[_0x10e20c][_0x24b314(0x25c)]=_0xd2cea6;}),_0x2552ea[_0x17097d(0x268)]((_0x2a51ae,_0x5a5e50)=>{var _0x2c56d8=_0x17097d;_0x5dac7e[_0x5a5e50][_0x2c56d8(0x235)]=_0x2a51ae;}),_0x7cc908[_0x17097d(0x268)]((_0x1acbe,_0x5fce3e)=>{var _0x509715=_0x17097d;_0x5dac7e[_0x5fce3e][_0x509715(0x252)]=_0x1acbe;}),_0x38d11d[_0x17097d(0x268)]((_0x241726,_0x2cf8b7)=>{_0x5dac7e[_0x2cf8b7]['invoice']=_0x241726;});const _0x64d49=_0x5dac7e[_0x17097d(0x260)](_0x30fa55=>_0x30fa55[_0x17097d(0x233)]!=='0'&&_0x30fa55['adjust_qty']!=='');var _0x142f3e=0x0;_0x64d49[_0x17097d(0x268)](_0x21d7a2=>{var _0x3a6080=_0x17097d;console[_0x3a6080(0x1ac)](_0x3a6080(0x1df),_0x21d7a2),parseInt(_0x21d7a2['adjust_qty'])<=0x0&&_0x142f3e++;});if(_0x142f3e!=0x0)return _0x142aa8[_0x17097d(0x1c3)](_0x17097d(0x20c),_0x17097d(0x239)),_0x106c37[_0x17097d(0x24d)](_0x17097d(0x1dc));const _0x10e9d9=new adjustment({'warehouse_name':_0x4fb1e9,'date':_0x4d388f,'product':_0x64d49,'note':_0x449097,'room':_0x2651cb,'invoice':_0x4dfd87,'JO_number':_0x5ab77d,'expiry_date':_0x194a06}),_0x24a8f6=await _0x10e9d9[_0x17097d(0x1e6)]();_0x142aa8[_0x17097d(0x1c3)](_0x17097d(0x202),'adjustment\x20add\x20successfull'),_0x106c37[_0x17097d(0x24d)](_0x17097d(0x1c2)+_0x24a8f6[_0x17097d(0x1fd)]);}catch(_0x1c7f77){console[_0x17097d(0x1ac)](_0x1c7f77),_0x106c37[_0x17097d(0x225)](0xc8)[_0x17097d(0x22d)]({'message':_0x1c7f77['message']});}}),router[a0_0x84cd4a(0x27b)]('/preview/:id',auth,async(_0x12665a,_0x108541)=>{var _0x4b1a94=a0_0x84cd4a;try{const {username:_0x3882fc,email:_0x50d4b1,role:_0x5e5d85}=_0x12665a[_0x4b1a94(0x1c4)],_0x220660=_0x12665a[_0x4b1a94(0x1c4)],_0x1ab815=await profile[_0x4b1a94(0x270)]({'email':_0x220660[_0x4b1a94(0x27a)]}),_0x4db433=await master_shop[_0x4b1a94(0x24f)](),_0x42e700=_0x12665a['params']['id'],_0x4b8683=await adjustment['findById']({'_id':_0x42e700}),_0x5904b5=await purchases[_0x4b1a94(0x1b3)]([{'$match':{'warehouse_name':_0x4b8683[_0x4b1a94(0x223)]}},{'$unwind':_0x4b1a94(0x27d)},{'$group':{'_id':'$product.product_name'}}]),_0x9c2756=await product[_0x4b1a94(0x24f)]({}),_0x5b8dfe=await warehouse[_0x4b1a94(0x1b3)]([{'$match':{'name':_0x4b8683['warehouse_name']}},{'$unwind':_0x4b1a94(0x1e0)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4b1a94(0x207)},'product_stock':{'$first':_0x4b1a94(0x261)},'bay':{'$first':_0x4b1a94(0x203)},'bin':{'$first':_0x4b1a94(0x244)},'type':{'$first':_0x4b1a94(0x218)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4b1a94(0x259)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4b1a94(0x1f5)},'storage':{'$first':_0x4b1a94(0x24e)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x4b1a94(0x1f3)},'expiry_date':{'$first':_0x4b1a94(0x262)},'production_date':{'$first':_0x4b1a94(0x274)},'batch_code':{'$first':_0x4b1a94(0x200)},'room':{'$first':_0x4b1a94(0x272)}}}]);if(_0x4db433[0x0][_0x4b1a94(0x1d3)]==_0x4b1a94(0x243)){var _0x4447af=users[_0x4b1a94(0x277)];console[_0x4b1a94(0x1ac)](_0x4447af);}else{if(_0x4db433[0x0][_0x4b1a94(0x1d3)]==_0x4b1a94(0x229))var _0x4447af=users[_0x4b1a94(0x229)];else{if(_0x4db433[0x0]['language']==_0x4b1a94(0x246))var _0x4447af=users[_0x4b1a94(0x246)];else{if(_0x4db433[0x0]['language']==_0x4b1a94(0x25e))var _0x4447af=users[_0x4b1a94(0x25e)];else{if(_0x4db433[0x0][_0x4b1a94(0x1d3)]=='French')var _0x4447af=users[_0x4b1a94(0x1de)];else{if(_0x4db433[0x0][_0x4b1a94(0x1d3)]==_0x4b1a94(0x1b1))var _0x4447af=users[_0x4b1a94(0x26c)];else{if(_0x4db433[0x0][_0x4b1a94(0x1d3)]=='Chinese')var _0x4447af=users[_0x4b1a94(0x1db)];else{if(_0x4db433[0x0][_0x4b1a94(0x1d3)]==_0x4b1a94(0x211))var _0x4447af=users[_0x4b1a94(0x1ce)];}}}}}}}_0x108541[_0x4b1a94(0x23e)](_0x4b1a94(0x1b6),{'success':_0x12665a[_0x4b1a94(0x1c3)](_0x4b1a94(0x202)),'errors':_0x12665a['flash'](_0x4b1a94(0x20c)),'role':_0x220660,'profile':_0x1ab815,'adjustment':_0x4b8683,'stock':_0x5b8dfe,'master_shop':_0x4db433,'warehouse_name':_0x5904b5,'unit':_0x9c2756,'language':_0x4447af});}catch(_0x529e1f){console[_0x4b1a94(0x1ac)](_0x529e1f),_0x108541[_0x4b1a94(0x225)](0xc8)['json']({'message':_0x529e1f[_0x4b1a94(0x1fc)]});}}),router[a0_0x84cd4a(0x212)](a0_0x84cd4a(0x1bb),auth,async(_0x18db12,_0x228934)=>{var _0x125561=a0_0x84cd4a;try{const _0x202c44=_0x18db12[_0x125561(0x1cd)]['id'],{warehouse_name:_0xd3a2dd,Room_name:_0x399d80}=_0x18db12[_0x125561(0x1ad)],_0x580b85=await adjustment[_0x125561(0x26d)]({'_id':_0x202c44}),_0xe29771=_0x580b85[_0x125561(0x22f)][_0x125561(0x26f)](async _0x506fac=>{var _0x43c875=_0x125561;if(_0x506fac[_0x43c875(0x233)]>0x0){var _0x2c5ce4=await warehouse['findOne']({'name':_0xd3a2dd,'room':_0x506fac[_0x43c875(0x25c)],'warehouse_category':_0x43c875(0x1f8)});const _0x535e2e=_0x2c5ce4[_0x43c875(0x231)][_0x43c875(0x26f)](_0x296428=>{var _0x2e60a6=_0x43c875;if(_0x506fac[_0x2e60a6(0x1f9)]=='minus'){if(_0x296428[_0x2e60a6(0x20a)]==_0x506fac[_0x2e60a6(0x20a)]&&_0x296428[_0x2e60a6(0x1d7)]==_0x506fac[_0x2e60a6(0x1d7)]&&_0x296428['type']==_0x506fac[_0x2e60a6(0x1f9)]&&_0x296428[_0x2e60a6(0x1ff)]==_0x506fac[_0x2e60a6(0x1ff)]&&_0x296428[_0x2e60a6(0x25a)]==_0x506fac[_0x2e60a6(0x25a)]&&_0x296428[_0x2e60a6(0x1ee)]==_0x506fac[_0x2e60a6(0x1ee)]&&_0x296428[_0x2e60a6(0x21f)]==_0x506fac[_0x2e60a6(0x21f)]&&_0x296428[_0x2e60a6(0x21d)]==_0x506fac[_0x2e60a6(0x21d)]&&_0x296428['batch_code']==_0x506fac[_0x2e60a6(0x23c)]&&_0x296428[_0x2e60a6(0x264)]==_0x506fac[_0x2e60a6(0x264)]&&_0x296428[_0x2e60a6(0x1ec)]==_0x506fac[_0x2e60a6(0x1ec)]){var _0x4c748b;_0x4c748b=_0x506fac[_0x2e60a6(0x233)],_0x506fac[_0x2e60a6(0x26e)]=='S'&&(_0x4c748b=_0x506fac[_0x2e60a6(0x233)]),_0x296428[_0x2e60a6(0x1dd)]=_0x296428['product_stock']-_0x4c748b;}}else{if(_0x296428[_0x2e60a6(0x20a)]==_0x506fac[_0x2e60a6(0x20a)]&&_0x296428['floorlevel']==_0x506fac['floorlevel']&&_0x296428[_0x2e60a6(0x1f9)]==_0x506fac['type']&&_0x296428['bin']==_0x506fac[_0x2e60a6(0x1ff)]&&_0x296428['bay']==_0x506fac[_0x2e60a6(0x25a)]&&_0x296428['rack']==_0x506fac[_0x2e60a6(0x1ee)]&&_0x296428[_0x2e60a6(0x21f)]==_0x506fac[_0x2e60a6(0x21f)]&&_0x296428['expiry_date']==_0x506fac[_0x2e60a6(0x21d)]&&_0x296428[_0x2e60a6(0x23c)]==_0x506fac['batch_code']&&_0x296428[_0x2e60a6(0x264)]==_0x506fac[_0x2e60a6(0x264)]&&_0x296428[_0x2e60a6(0x1ec)]==_0x506fac[_0x2e60a6(0x1ec)]){console[_0x2e60a6(0x1ac)](_0x506fac);var _0x4c748b;_0x4c748b=_0x506fac[_0x2e60a6(0x233)],_0x506fac[_0x2e60a6(0x26e)]=='S'&&(_0x4c748b=_0x506fac[_0x2e60a6(0x233)]),console[_0x2e60a6(0x1ac)](_0x4c748b+_0x2e60a6(0x248)+_0x506fac[_0x2e60a6(0x233)]+_0x2e60a6(0x248)+_0x296428[_0x2e60a6(0x1c0)]+_0x2e60a6(0x248)+_0x506fac[_0x2e60a6(0x26e)]),_0x296428['product_stock']=_0x296428[_0x2e60a6(0x1dd)]+_0x4c748b;}}});}return _0x2c5ce4;});Promise[_0x125561(0x1d5)](_0xe29771)[_0x125561(0x282)](async _0x560190=>{var _0x4bc5f5=_0x125561;try{for(const _0x4fa2c3 of _0x560190){await _0x4fa2c3[_0x4bc5f5(0x1e6)]();}_0x580b85['finalize']=_0x4bc5f5(0x26a);const _0x334d6d=await _0x580b85['save'](),_0x1024b6=await master_shop['find'](),_0x3ee77a=await email_settings[_0x4bc5f5(0x270)](),_0x232375=await supervisor_settings[_0x4bc5f5(0x24f)]();var _0x377029=_0x580b85[_0x4bc5f5(0x22f)],_0xa2c0d3='',_0x3fdef3;for(_0x3fdef3 in _0x377029){_0xa2c0d3+=_0x4bc5f5(0x21b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x377029[_0x3fdef3][_0x4bc5f5(0x20a)]+_0x4bc5f5(0x237)+_0x4bc5f5(0x209)+_0x377029[_0x3fdef3][_0x4bc5f5(0x20b)]+_0x4bc5f5(0x237)+_0x4bc5f5(0x209)+_0x377029[_0x3fdef3][_0x4bc5f5(0x233)]+_0x4bc5f5(0x237)+_0x4bc5f5(0x209)+_0x377029[_0x3fdef3][_0x4bc5f5(0x25d)]+_0x4bc5f5(0x237)+_0x4bc5f5(0x209)+_0x377029[_0x3fdef3][_0x4bc5f5(0x1ab)]+_0x4bc5f5(0x237)+_0x4bc5f5(0x209)+_0x580b85['warehouse_name']+_0x4bc5f5(0x237)+_0x4bc5f5(0x209)+_0x377029[_0x3fdef3][_0x4bc5f5(0x25c)]+_0x4bc5f5(0x237)+_0x4bc5f5(0x209)+_0x377029[_0x3fdef3][_0x4bc5f5(0x21f)]+_0x377029[_0x3fdef3]['rack']+_0x377029[_0x3fdef3][_0x4bc5f5(0x25a)]+_0x377029[_0x3fdef3]['bin']+_0x377029[_0x3fdef3][_0x4bc5f5(0x1f9)][0x0]+_0x377029[_0x3fdef3][_0x4bc5f5(0x1d7)]+_0x4bc5f5(0x237),_0x4bc5f5(0x1bc);}let _0x2385eb=nodemailer['createTransport']({'host':_0x3ee77a['host'],'port':Number(_0x3ee77a[_0x4bc5f5(0x27f)]),'secure':![],'auth':{'user':_0x3ee77a['email'],'pass':_0x3ee77a[_0x4bc5f5(0x283)]}}),_0x486105={'from':_0x3ee77a[_0x4bc5f5(0x27a)],'to':_0x232375[0x0][_0x4bc5f5(0x1cb)],'subject':_0x4bc5f5(0x1cc),'attachments':[{'filename':_0x4bc5f5(0x275),'path':__dirname+_0x4bc5f5(0x250)+_0x4bc5f5(0x20f)+_0x1024b6[0x0][_0x4bc5f5(0x1b2)],'cid':'logo'}],'html':_0x4bc5f5(0x23b)+'<html><head><title></title>'+'</head><body>'+'<div>'+_0x4bc5f5(0x1d1)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x4bc5f5(0x22e)+'<div>'+_0x4bc5f5(0x204)+_0x1024b6[0x0]['site_title']+_0x4bc5f5(0x25b)+_0x4bc5f5(0x22e)+_0x4bc5f5(0x22e)+'<hr\x20class=\x22my-3\x22>'+_0x4bc5f5(0x267)+_0x4bc5f5(0x1c5)+_0x4bc5f5(0x27e)+_0x580b85[_0x4bc5f5(0x1ec)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x580b85[_0x4bc5f5(0x240)]+'\x20'+_0x4bc5f5(0x257)+_0x4bc5f5(0x1da)+_0x4bc5f5(0x22e)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4bc5f5(0x27c)+_0x4bc5f5(0x21b)+_0x4bc5f5(0x256)+_0x4bc5f5(0x21c)+_0x4bc5f5(0x263)+_0x4bc5f5(0x1c6)+_0x4bc5f5(0x253)+_0x4bc5f5(0x1bd)+_0x4bc5f5(0x1f7)+_0x4bc5f5(0x1b8)+_0x4bc5f5(0x1bc)+'</thead>'+_0x4bc5f5(0x266)+'\x20'+_0xa2c0d3+'\x20'+_0x4bc5f5(0x1e1)+'</table>'+_0x4bc5f5(0x267)+_0x4bc5f5(0x1be)+_0x4bc5f5(0x24b)+_0x1024b6[0x0][_0x4bc5f5(0x269)]+'</h5>'+'</div>'+_0x4bc5f5(0x22e)+_0x4bc5f5(0x20e)};_0x2385eb[_0x4bc5f5(0x278)](_0x486105,function(_0x11078e,_0x2731c7){var _0x4a63ea=_0x4bc5f5;_0x11078e?(console[_0x4a63ea(0x1ac)](_0x11078e),console['log'](_0x4a63ea(0x245))):console['log'](_0x4a63ea(0x1f6));}),_0x18db12['flash'](_0x4bc5f5(0x202),_0x4bc5f5(0x201)),_0x228934[_0x4bc5f5(0x24d)](_0x4bc5f5(0x216)+_0x334d6d[_0x4bc5f5(0x1fd)]);}catch(_0x3916b2){console[_0x4bc5f5(0x21a)](_0x3916b2),_0x228934[_0x4bc5f5(0x225)](0x1f4)[_0x4bc5f5(0x22d)]({'error':_0x4bc5f5(0x279)});}})[_0x125561(0x238)](_0x1d9a8e=>{var _0x24f982=_0x125561;console[_0x24f982(0x21a)](_0x1d9a8e),_0x228934[_0x24f982(0x225)](0x1f4)[_0x24f982(0x22d)]({'error':_0x24f982(0x254)});});}catch(_0x1e3a05){console[_0x125561(0x1ac)](_0x1e3a05),_0x228934[_0x125561(0x225)](0xc8)['json']({'message':_0x1e3a05[_0x125561(0x1fc)]});}}),router[a0_0x84cd4a(0x27b)]('/view/:id',auth,async(_0xcf1333,_0x176437)=>{var _0x5cdf0e=a0_0x84cd4a;try{const {username:_0x588246,email:_0x1392e2,role:_0x32e102}=_0xcf1333['user'],_0x521a20=_0xcf1333[_0x5cdf0e(0x1c4)],_0x3ee22a=await profile['findOne']({'email':_0x521a20[_0x5cdf0e(0x27a)]}),_0x554463=await master_shop[_0x5cdf0e(0x24f)](),_0x259807=_0xcf1333['params']['id'],_0x2457a6=await adjustment[_0x5cdf0e(0x26d)]({'_id':_0x259807}),_0x58d3aa=await purchases[_0x5cdf0e(0x1b3)]([{'$match':{'warehouse_name':_0x2457a6[_0x5cdf0e(0x223)]}},{'$unwind':_0x5cdf0e(0x27d)},{'$group':{'_id':'$product.product_name'}}]),_0x1907a9=await product[_0x5cdf0e(0x24f)]({}),_0x511306=await warehouse[_0x5cdf0e(0x1b3)]([{'$match':{'name':_0x2457a6[_0x5cdf0e(0x223)]}},{'$unwind':_0x5cdf0e(0x1e0)},{'$group':{'_id':_0x5cdf0e(0x1e2),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5cdf0e(0x261)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5cdf0e(0x244)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x5cdf0e(0x259)},'secondary_code':{'$first':_0x5cdf0e(0x22a)},'product_code':{'$first':_0x5cdf0e(0x1f5)},'storage':{'$first':_0x5cdf0e(0x24e)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x5cdf0e(0x262)},'production_date':{'$first':_0x5cdf0e(0x274)},'batch_code':{'$first':_0x5cdf0e(0x200)},'room':{'$first':'$room'}}}]);let _0x517d15;if(_0x521a20[_0x5cdf0e(0x1bf)]==_0x5cdf0e(0x1d9)){const _0x160110=await staff['findOne']({'email':_0x521a20[_0x5cdf0e(0x27a)]});_0x517d15=await warehouse['aggregate']([{'$match':{'status':_0x5cdf0e(0x213),'name':_0x160110[_0x5cdf0e(0x258)],'warehouse_category':_0x5cdf0e(0x1f8),'name':{'$ne':_0x5cdf0e(0x1eb)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x517d15=await warehouse[_0x5cdf0e(0x1b3)]([{'$match':{'status':'Enabled','warehouse_category':_0x5cdf0e(0x1f8),'name':{'$ne':_0x5cdf0e(0x1eb)}}},{'$group':{'_id':_0x5cdf0e(0x249),'name':{'$first':_0x5cdf0e(0x249)}}}]);if(_0x554463[0x0][_0x5cdf0e(0x1d3)]=='English\x20(US)'){var _0x3ec243=users[_0x5cdf0e(0x277)];console[_0x5cdf0e(0x1ac)](_0x3ec243);}else{if(_0x554463[0x0]['language']==_0x5cdf0e(0x229))var _0x3ec243=users['Hindi'];else{if(_0x554463[0x0][_0x5cdf0e(0x1d3)]==_0x5cdf0e(0x246))var _0x3ec243=users[_0x5cdf0e(0x246)];else{if(_0x554463[0x0][_0x5cdf0e(0x1d3)]=='Spanish')var _0x3ec243=users[_0x5cdf0e(0x25e)];else{if(_0x554463[0x0][_0x5cdf0e(0x1d3)]==_0x5cdf0e(0x1de))var _0x3ec243=users[_0x5cdf0e(0x1de)];else{if(_0x554463[0x0][_0x5cdf0e(0x1d3)]=='Portuguese\x20(BR)')var _0x3ec243=users[_0x5cdf0e(0x26c)];else{if(_0x554463[0x0][_0x5cdf0e(0x1d3)]=='Chinese')var _0x3ec243=users[_0x5cdf0e(0x1db)];else{if(_0x554463[0x0][_0x5cdf0e(0x1d3)]=='Arabic\x20(ae)')var _0x3ec243=users[_0x5cdf0e(0x1ce)];}}}}}}}_0x176437[_0x5cdf0e(0x23e)](_0x5cdf0e(0x281),{'success':_0xcf1333[_0x5cdf0e(0x1c3)](_0x5cdf0e(0x202)),'errors':_0xcf1333['flash'](_0x5cdf0e(0x20c)),'role':_0x521a20,'profile':_0x3ee22a,'adjustment':_0x2457a6,'stock':_0x511306,'master_shop':_0x554463,'warehouse_name':_0x58d3aa,'unit':_0x1907a9,'language':_0x3ec243,'warehouse':_0x517d15});}catch(_0x5dbc30){console[_0x5cdf0e(0x1ac)](_0x5dbc30),_0x176437[_0x5cdf0e(0x225)](0xc8)[_0x5cdf0e(0x22d)]({'message':_0x5dbc30[_0x5cdf0e(0x1fc)]});}}),router[a0_0x84cd4a(0x212)](a0_0x84cd4a(0x1f0),auth,async(_0xd70a54,_0x1a4592)=>{var _0x11aa54=a0_0x84cd4a;try{const _0x197c91=_0xd70a54['params']['id'],_0x49443c=await adjustment[_0x11aa54(0x26d)]({'_id':_0x197c91}),_0xe816c6=await warehouse[_0x11aa54(0x270)]({'name':_0x49443c[_0x11aa54(0x223)],'room':_0x49443c[_0x11aa54(0x280)]}),{warehouse_name:_0x3ff275,date:_0x5d0ae5,prod_name:_0x4a03c3,level:_0x5ea942,isle:_0x23c6b4,pallet:_0x552f68,stock:_0x399c82,types:_0x948604,adjust_qty:_0x1590e9,new_adjust_qty:_0x5758cc,note:_0x36221c,Room_name:_0x5029ca,invoice:_0x2b2fad,JO_number:_0x29d046,expiry_date:_0x2d1bee}=_0xd70a54[_0x11aa54(0x1ad)];if(typeof _0x4a03c3=='string')var _0x5e8c81=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x208)]],_0xd61b53=[_0xd70a54['body']['level']],_0x828afc=[_0xd70a54['body']['stock']],_0x13baa1=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x273)]],_0x150cec=[_0xd70a54[_0x11aa54(0x1ad)]['New_Qty_Converted_adj']],_0x565787=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x285)]],_0x1f5c5c=[_0xd70a54[_0x11aa54(0x1ad)]['Primary_Units']],_0x1b0392=[_0xd70a54['body'][_0x11aa54(0x22b)]],_0x5e13f8=[_0xd70a54['body'][_0x11aa54(0x1ba)]],_0x3af613=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x23c)]],_0x49e85f=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x21d)]],_0x529d7f=[_0xd70a54['body'][_0x11aa54(0x247)]],_0x42fc1b=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x264)]],_0x2d876a=[_0xd70a54[_0x11aa54(0x1ad)]['prod_cat']],_0x13681d=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x1ef)]],_0x279c0b=[_0xd70a54['body']['prime1']],_0x53cb6a=[_0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x206)]];else var _0x5e8c81=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x208)]],_0xd61b53=[..._0xd70a54['body'][_0x11aa54(0x227)]],_0x828afc=[..._0xd70a54[_0x11aa54(0x1ad)]['stock']],_0x13baa1=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x273)]],_0x150cec=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x23a)]],_0x565787=[..._0xd70a54['body'][_0x11aa54(0x285)]],_0x1f5c5c=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x25d)]],_0x1b0392=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x22b)]],_0x5e13f8=[..._0xd70a54['body'][_0x11aa54(0x1ba)]],_0x3af613=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x23c)]],_0x49e85f=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x21d)]],_0x529d7f=[..._0xd70a54['body'][_0x11aa54(0x247)]],_0x42fc1b=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x264)]],_0x2d876a=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x26e)]],_0x13681d=[..._0xd70a54[_0x11aa54(0x1ad)]['Rooms']],_0x279c0b=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x241)]],_0x53cb6a=[..._0xd70a54[_0x11aa54(0x1ad)][_0x11aa54(0x206)]];const _0x2255f4=_0x5e8c81[_0x11aa54(0x26f)](_0x3e82c9=>{return _0x3e82c9={'product_name':_0x3e82c9};});_0xd61b53[_0x11aa54(0x268)]((_0x5a1259,_0x1b14e)=>{var _0xf5650f=_0x11aa54;_0x13681d[_0xf5650f(0x268)]((_0x5703e,_0x25ec2f)=>{var _0x27da6f=_0xf5650f;if(_0x5703e=='Receiving\x20Area'&&_0x1b14e==_0x25ec2f){var _0x255ec8=_0x5a1259['slice'](0x3);_0x2255f4[_0x1b14e]['storage']=_0x5a1259[0x0],_0x2255f4[_0x1b14e][_0x27da6f(0x1ee)]=_0x5a1259[0x1],_0x2255f4[_0x1b14e][_0x27da6f(0x25a)]=0x0,_0x2255f4[_0x1b14e][_0x27da6f(0x1ff)]=0x0,_0x2255f4[_0x1b14e][_0x27da6f(0x1f9)]=_0x27da6f(0x215),_0x2255f4[_0x1b14e]['floorlevel']=_0x255ec8;}else{if(_0x5703e==_0x27da6f(0x224)&&_0x1b14e==_0x25ec2f){var _0x255ec8=_0x5a1259[_0x27da6f(0x1ca)](0x3);_0x2255f4[_0x1b14e][_0x27da6f(0x21f)]=_0x5a1259[0x0],_0x2255f4[_0x1b14e][_0x27da6f(0x1ee)]=_0x5a1259[0x1],_0x2255f4[_0x1b14e]['bay']=0x0,_0x2255f4[_0x1b14e]['bin']=0x0,_0x2255f4[_0x1b14e]['type']=_0x27da6f(0x215),_0x2255f4[_0x1b14e]['floorlevel']=_0x5a1259[0x5];}else{if(_0x1b14e==_0x25ec2f){var _0x220205;if(_0x5a1259[0x4]=='L')_0x220205=_0x27da6f(0x1f4);else _0x5a1259[0x4]=='F'&&(_0x220205=_0x27da6f(0x215));_0x2255f4[_0x1b14e][_0x27da6f(0x21f)]=_0x5a1259[0x0],_0x2255f4[_0x1b14e][_0x27da6f(0x1ee)]=_0x5a1259[0x1],_0x2255f4[_0x1b14e][_0x27da6f(0x25a)]=_0x5a1259[0x2],_0x2255f4[_0x1b14e][_0x27da6f(0x1ff)]=_0x5a1259[0x3],_0x2255f4[_0x1b14e]['type']=_0x220205,_0x2255f4[_0x1b14e]['floorlevel']=_0x5a1259[0x5];}}}});}),_0x828afc[_0x11aa54(0x268)]((_0xd84eb4,_0x1c9711)=>{var _0x3d2ce6=_0x11aa54;_0x2255f4[_0x1c9711][_0x3d2ce6(0x1ea)]=_0xd84eb4;}),_0x13baa1[_0x11aa54(0x268)]((_0x3cd7d0,_0x1fd6fa)=>{var _0x40fa21=_0x11aa54;_0x2255f4[_0x1fd6fa][_0x40fa21(0x273)]=_0x3cd7d0;}),_0x150cec[_0x11aa54(0x268)]((_0x3e55c1,_0x4c48ca)=>{var _0x4f35f2=_0x11aa54;_0x2255f4[_0x4c48ca][_0x4f35f2(0x233)]=_0x3e55c1;}),_0x565787['forEach']((_0x2db70d,_0x41764b)=>{var _0x1b16c0=_0x11aa54;_0x2255f4[_0x41764b][_0x1b16c0(0x276)]=_0x2db70d;}),_0x1f5c5c[_0x11aa54(0x268)]((_0x27104b,_0x54110c)=>{var _0x53b051=_0x11aa54;_0x2255f4[_0x54110c][_0x53b051(0x25d)]=_0x27104b;}),_0x1b0392[_0x11aa54(0x268)]((_0x580903,_0x46ec10)=>{_0x2255f4[_0x46ec10]['secondary_unit']=_0x580903;}),_0x5e13f8[_0x11aa54(0x268)]((_0x328fd8,_0x2e79ed)=>{var _0x19b4d0=_0x11aa54;_0x2255f4[_0x2e79ed][_0x19b4d0(0x20b)]=_0x328fd8;}),_0x3af613[_0x11aa54(0x268)]((_0x52b47b,_0x3fb25a)=>{var _0x234730=_0x11aa54;_0x2255f4[_0x3fb25a][_0x234730(0x23c)]=_0x52b47b;}),_0x49e85f[_0x11aa54(0x268)]((_0x1a398a,_0x11a9b4)=>{var _0x25cbcf=_0x11aa54;_0x2255f4[_0x11a9b4][_0x25cbcf(0x21d)]=_0x1a398a;}),_0x529d7f[_0x11aa54(0x268)]((_0x488392,_0x1cc345)=>{var _0x53ff60=_0x11aa54;_0x2255f4[_0x1cc345][_0x53ff60(0x1cf)]=_0x488392;}),_0x42fc1b[_0x11aa54(0x268)]((_0x18dc09,_0x23e4e4)=>{var _0x45f1fa=_0x11aa54;_0x2255f4[_0x23e4e4][_0x45f1fa(0x264)]=_0x18dc09;}),_0x2d876a[_0x11aa54(0x268)]((_0x150e31,_0x38035f)=>{var _0x80ba4a=_0x11aa54;_0x2255f4[_0x38035f][_0x80ba4a(0x26e)]=_0x150e31;}),_0x13681d[_0x11aa54(0x268)]((_0x59ae4b,_0x5f210d)=>{var _0x3a652d=_0x11aa54;_0x2255f4[_0x5f210d][_0x3a652d(0x25c)]=_0x59ae4b;}),_0x279c0b[_0x11aa54(0x268)]((_0x1d6e07,_0x4209ec)=>{_0x2255f4[_0x4209ec]['primary_code']=_0x1d6e07;}),_0x53cb6a[_0x11aa54(0x268)]((_0xa3f19a,_0x409e66)=>{_0x2255f4[_0x409e66]['secondary_code']=_0xa3f19a;});const _0xaf8ca7=_0x2255f4[_0x11aa54(0x260)](_0x2c0131=>_0x2c0131['adjust_qty']!=='0'&&_0x2c0131['adjust_qty']!=='');var _0x23ca01=0x0;_0xaf8ca7[_0x11aa54(0x268)](_0x19b359=>{var _0x4cc12c=_0x11aa54;console[_0x4cc12c(0x1ac)](_0x4cc12c(0x1df),_0x19b359),parseInt(_0x19b359[_0x4cc12c(0x233)])<=0x0&&_0x23ca01++;});if(_0x23ca01!=0x0)return _0xd70a54['flash']('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x1a4592[_0x11aa54(0x24d)](_0x11aa54(0x1dc));_0x49443c['warehouse_name']=_0x3ff275,_0x49443c['date']=_0x5d0ae5,_0x49443c['product']=_0xaf8ca7,_0x49443c[_0x11aa54(0x1b5)]=_0x36221c,_0x49443c[_0x11aa54(0x1ec)]=_0x2b2fad,_0x49443c['isAllowEdit']=_0x11aa54(0x265);const _0x1211ab=await _0x49443c[_0x11aa54(0x1e6)]();_0xd70a54[_0x11aa54(0x1c3)](_0x11aa54(0x202),_0x11aa54(0x232)),_0x1a4592[_0x11aa54(0x24d)]('/adjustment/view');}catch(_0x451e95){console[_0x11aa54(0x1ac)](_0x451e95);}}),router[a0_0x84cd4a(0x212)](a0_0x84cd4a(0x251),async(_0x2a6808,_0x15badc)=>{var _0x3ed23f=a0_0x84cd4a;const {primary_code:_0x140804,warehouse_data:_0x3625f7,rooms_data:_0xba33a8,Roomslist:_0xe2f9c9}=_0x2a6808[_0x3ed23f(0x1ad)],_0x5d4e69=_0xe2f9c9[_0x3ed23f(0x1b0)](','),_0x2193c9=[];async function _0x3bce3f(_0xbfd728){var _0x317b37=_0x3ed23f;const _0x372234=await warehouse[_0x317b37(0x1b3)]([{'$match':{'name':_0x3625f7,'room':_0xbfd728}},{'$unwind':_0x317b37(0x1e0)},{'$match':{'product_details.primary_code':_0x140804}},{'$group':{'_id':_0x317b37(0x1e2),'name':{'$first':_0x317b37(0x207)},'product_stock':{'$first':_0x317b37(0x261)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x317b37(0x22a)},'product_code':{'$first':_0x317b37(0x1f5)},'level':{'$first':_0x317b37(0x203)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x317b37(0x218)},'pallet':{'$first':_0x317b37(0x205)},'unit':{'$first':_0x317b37(0x1e8)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x317b37(0x24e)},'rack':{'$first':_0x317b37(0x1d4)},'expiry_date':{'$first':_0x317b37(0x262)},'production_date':{'$first':_0x317b37(0x274)},'maxPerUnit':{'$first':_0x317b37(0x1f3)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x317b37(0x272)}}}]),_0x414044=await warehouse['aggregate']([{'$match':{'name':_0x3625f7,'room':_0xbfd728}},{'$unwind':_0x317b37(0x1e0)},{'$match':{'product_details.secondary_code':_0x140804}},{'$group':{'_id':_0x317b37(0x1e2),'name':{'$first':_0x317b37(0x207)},'product_stock':{'$first':_0x317b37(0x261)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x317b37(0x22a)},'product_code':{'$first':_0x317b37(0x1f5)},'level':{'$first':_0x317b37(0x203)},'isle':{'$first':_0x317b37(0x244)},'type':{'$first':_0x317b37(0x218)},'pallet':{'$first':_0x317b37(0x205)},'unit':{'$first':_0x317b37(0x1e8)},'secondary_unit':{'$first':_0x317b37(0x1c8)},'storage':{'$first':_0x317b37(0x24e)},'rack':{'$first':_0x317b37(0x1d4)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x317b37(0x274)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x317b37(0x236)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x372234[_0x317b37(0x1fa)]>0x0)_0x2193c9[_0x317b37(0x23f)](_0x372234);else _0x414044[_0x317b37(0x1fa)]>0x0&&_0x2193c9[_0x317b37(0x23f)](_0x414044);}const _0x51a8a7=_0x5d4e69[_0x3ed23f(0x26f)](_0x5d6515=>_0x3bce3f(_0x5d6515));await Promise['all'](_0x51a8a7),_0x15badc[_0x3ed23f(0x22d)](_0x2193c9);}),router[a0_0x84cd4a(0x212)](a0_0x84cd4a(0x284),async(_0x47f356,_0x362bee)=>{var _0x379fa9=a0_0x84cd4a;const {primaryCode:_0x2392ba,secondaryCode:_0x31b8cd,productCode:_0xd5c6e2,level:_0x29e040,isle:_0x9a9a86,pallet:_0x6423b3,warehouses:_0x5b3a71,room:_0x425263}=_0x47f356[_0x379fa9(0x1ad)];try{const _0x1354be=await warehouse[_0x379fa9(0x1b3)]([{'$match':{'name':_0x5b3a71,'room':_0x425263}},{'$unwind':_0x379fa9(0x1e0)},{'$match':{'product_details.level':parseInt(_0x29e040),'product_details.isle':_0x9a9a86,'product_details.pallet':parseInt(_0x6423b3)}},{'$group':{'_id':_0x379fa9(0x1e2),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x379fa9(0x261)},'level':{'$first':_0x379fa9(0x1b7)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x379fa9(0x210)},'maxProducts':{'$first':_0x379fa9(0x24a)}}}]);_0x362bee['status'](0xc8)[_0x379fa9(0x22d)](_0x1354be);}catch(_0x5e622b){_0x362bee[_0x379fa9(0x225)](0x194)[_0x379fa9(0x22d)]({'message':_0x5e622b[_0x379fa9(0x1fc)]});}}),module[a0_0x84cd4a(0x23d)]=router;