var a0_0x5881aa=a0_0x2cec;function a0_0x2cec(_0x1965a3,_0x4ca579){var _0x3b5370=a0_0x3b53();return a0_0x2cec=function(_0x2cec3c,_0x322f83){_0x2cec3c=_0x2cec3c-0x6b;var _0x4ceb49=_0x3b5370[_0x2cec3c];return _0x4ceb49;},a0_0x2cec(_0x1965a3,_0x4ca579);}(function(_0xe8fa4f,_0x52a3ea){var _0x2b516b=a0_0x2cec,_0x5c9913=_0xe8fa4f();while(!![]){try{var _0x373060=-parseInt(_0x2b516b(0xac))/0x1+parseInt(_0x2b516b(0xb5))/0x2*(parseInt(_0x2b516b(0x7c))/0x3)+-parseInt(_0x2b516b(0xc4))/0x4*(-parseInt(_0x2b516b(0xf7))/0x5)+-parseInt(_0x2b516b(0x106))/0x6*(-parseInt(_0x2b516b(0xcd))/0x7)+-parseInt(_0x2b516b(0x71))/0x8+-parseInt(_0x2b516b(0xa3))/0x9*(parseInt(_0x2b516b(0xcb))/0xa)+-parseInt(_0x2b516b(0xab))/0xb*(-parseInt(_0x2b516b(0x100))/0xc);if(_0x373060===_0x52a3ea)break;else _0x5c9913['push'](_0x5c9913['shift']());}catch(_0x4ae3b9){_0x5c9913['push'](_0x5c9913['shift']());}}}(a0_0x3b53,0xb4eca));function a0_0x3b53(){var _0x496920=['598533hKpVXQ','$product_details.bin','/adjustment/view','English\x20(US)','New_Qty_Converted','ObjectId','/preview/:id','</div>','product','636ppJsmt','Receiving\x20Area','foreach\x20newproduct','$product_details.rack','/view/add_adjustment','length','secondary_code','id_transaction_from','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Chinese','Return\x20Rooms','/barcode_scanner','expiry_date','Level','aggregate','659484OJGUKH','Arabic','get','sendMail','$product_details.secondary_unit','maxperunit','German','30NpfWoA','language','7cdtYFC','$product','then','edit_adjustment_view','$product_details.maxPerUnit','New_Qty_Converted_adj','production_date','product_code','<h5>','<!DOCTYPE\x20html>','new_adjust_qty','mongoose','Arabic\x20(ae)','../models/all_models','Email\x20sent\x20successfully','$product_details.bay','<tbody\x20style=\x22text-align:\x20center;\x22>','toString','rack','unit','/adjustment/preview/','</h5>','Raw\x20Materials','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','string','random','$product_details.storage','date','</thead>','adjustment\x20add\x20successfull','product_stock','user','$product_details.product_code','ADJ-','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Portuguese','Return\x20Goods','push','/picking_list/PDF_adjustment_rm/','\x20Order\x20Number\x20:\x20','level','post','5HAfbwq','catch','logo','params','<hr\x20class=\x22my-3\x22>','image','findOne','$_id','prod_code','24jvGryt','warehouse_name','<h2>\x20','all','filter','success','8736540BlqzmF','split','stockBefore','Primary_Units','$product_details.type','findById','Enabled','<span\x20style=\x22float:\x20right;\x22>','Types','$finalize','bay','save','/../public','\x20</h2>','</tbody>','add_adjustment','/view/:id','types','$product.product_name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.product_stock','False','../middleware/auth','$product_details.invoice','find','updateOne','$date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','staff','Shelves','room_names','isAllowEdit','$name','primary_code','</tr>','../public/language/languages.json','$room','valueOf','prime1','English','\x20<>\x20','True','RMSEmail','email','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<strong>\x20Regards\x20</strong>','slice','<h5\x20style=\x22text-align:\x20left;\x22>','bin','$product.room_names','There\x27s\x20a\x20error\x20in\x20this\x20transaction','log','padStart','$product_details.level','$product_details.batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<tr>','max_per_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','redirect','host','status','$product_details.secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','invoice','Spanish','storage','adjustment','second1','</table>','Secondary_units','errors','7568472UrcRGn','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.expiry_date','master','Ambient','$product_details.product_name','$product_details.pallet','finalize','Rooms','floorlevel','_id','7863kfwYZn','type','<div>','warehouse','$product_details.floorlevel','$invoice','adjustment\x20Finalized\x20successfully','</span>','batch_code','edit_adjustment','$product_details.production_date','$product_details','port','floor','Portuguese\x20(BR)','prod_cat','$product_details.product_cat','Floor','$product_details.unit','map','prod_invoice','French','Enclosed','$product_details.primary_code','flash','$product_details.maxProducts','$warehouse_name','back','</td>','body','stock','adjust_qty','secondary_unit','role','message','id_transaction','product_name','express','site_title','1014111BEufcJ','forEach','Hindi','render','product_details','prod_name','$product_details._id','json','930908DQXrzp'];a0_0x3b53=function(){return _0x496920;};return a0_0x3b53();}const express=require(a0_0x5881aa(0xa1)),app=express(),router=express['Router'](),auth=require(a0_0x5881aa(0x11c)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x5881aa(0xda)),users=require(a0_0x5881aa(0x129)),nodemailer=require('nodemailer'),mongoose=require(a0_0x5881aa(0xd8));router[a0_0x5881aa(0xc6)]('/view',auth,async(_0x11b490,_0x440286)=>{var _0x192c87=a0_0x5881aa;try{const {username:_0xc190f1,email:_0x1b8d96,role:_0x39a750}=_0x11b490[_0x192c87(0xec)],_0x4a9f19=_0x11b490[_0x192c87(0xec)],_0x18f358=await profile[_0x192c87(0xfd)]({'email':_0x4a9f19[_0x192c87(0x131)]}),_0x1af5b4=await master_shop[_0x192c87(0x11e)]();console[_0x192c87(0x139)](_0x192c87(0x74),_0x1af5b4);let _0x298ee1;if(_0x4a9f19[_0x192c87(0x9d)]==_0x192c87(0x122)){const _0x1728ce=await staff[_0x192c87(0xfd)]({'email':_0x4a9f19[_0x192c87(0x131)]});_0x298ee1=await warehouse[_0x192c87(0x11e)]({'status':'Enabled','name':_0x1728ce['warehouse']});}else _0x298ee1=await warehouse[_0x192c87(0x11e)]({'status':_0x192c87(0x10c)});const _0x51820f=await product[_0x192c87(0x11e)]();let _0x8d6556;if(_0x4a9f19[_0x192c87(0x9d)]=='staff'){const _0x254677=await staff[_0x192c87(0xfd)]({'email':_0x4a9f19[_0x192c87(0x131)]});_0x8d6556=await adjustment[_0x192c87(0x11e)]({'warehouse_name':_0x254677[_0x192c87(0x7f)]});}else _0x8d6556=await adjustment[_0x192c87(0xc3)]([{'$unwind':_0x192c87(0xce)},{'$group':{'_id':_0x192c87(0xfe),'invoice':{'$first':_0x192c87(0x81)},'date':{'$first':_0x192c87(0x120)},'warehouse_name':{'$first':_0x192c87(0x96)},'room':{'$addToSet':_0x192c87(0x137)},'finalize':{'$first':_0x192c87(0x10f)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x1af5b4[0x0][_0x192c87(0xcc)]==_0x192c87(0xaf)){var _0x598189=users['English'];console[_0x192c87(0x139)](_0x598189);}else{if(_0x1af5b4[0x0]['language']==_0x192c87(0xa5))var _0x598189=users[_0x192c87(0xa5)];else{if(_0x1af5b4[0x0][_0x192c87(0xcc)]==_0x192c87(0xca))var _0x598189=users[_0x192c87(0xca)];else{if(_0x1af5b4[0x0][_0x192c87(0xcc)]==_0x192c87(0x147))var _0x598189=users['Spanish'];else{if(_0x1af5b4[0x0][_0x192c87(0xcc)]==_0x192c87(0x91))var _0x598189=users['French'];else{if(_0x1af5b4[0x0]['language']=='Portuguese\x20(BR)')var _0x598189=users[_0x192c87(0xf0)];else{if(_0x1af5b4[0x0][_0x192c87(0xcc)]=='Chinese')var _0x598189=users[_0x192c87(0xbe)];else{if(_0x1af5b4[0x0][_0x192c87(0xcc)]==_0x192c87(0xd9))var _0x598189=users['Arabic'];}}}}}}}_0x440286[_0x192c87(0xa6)](_0x192c87(0x6c),{'success':_0x11b490[_0x192c87(0x94)](_0x192c87(0x105)),'errors':_0x11b490['flash'](_0x192c87(0x70)),'role':_0x4a9f19,'profile':_0x18f358,'warehouse':_0x298ee1,'product':_0x51820f,'adjustment':_0x8d6556,'master_shop':_0x1af5b4,'language':_0x598189});}catch(_0x5a4735){console[_0x192c87(0x139)](_0x5a4735);}});async function getRandom8DigitNumber(){var _0x777a2a=a0_0x5881aa;const _0x58bd46=0x989680,_0x3345cc=0x5f5e0ff,_0x100de5=Math[_0x777a2a(0x89)](Math[_0x777a2a(0xe6)]()*(_0x3345cc-_0x58bd46+0x1))+_0x58bd46;var _0x5f16ad;const _0x554645=await adjustment[_0x777a2a(0xfd)]({'invoice':_0x777a2a(0xee)+_0x100de5});return _0x554645&&_0x554645['length']>0x0?_0x5f16ad=_0x777a2a(0xee)+_0x100de5:_0x5f16ad='ADJ-'+_0x100de5,_0x5f16ad;}router['get'](a0_0x5881aa(0xb9),auth,async(_0xb98be5,_0x15601c)=>{var _0x2a06f3=a0_0x5881aa;try{const {username:_0x43d512,email:_0x486c4f,role:_0x1454b3}=_0xb98be5['user'],_0xc281d4=_0xb98be5['user'],_0x1463d3=await profile[_0x2a06f3(0xfd)]({'email':_0xc281d4['email']}),_0x2a9276=await master_shop[_0x2a06f3(0x11e)]();let _0x312a46;if(_0xc281d4[_0x2a06f3(0x9d)]==_0x2a06f3(0x122)){const _0xc718a0=await staff[_0x2a06f3(0xfd)]({'email':_0xc281d4['email']});_0x312a46=await warehouse[_0x2a06f3(0xc3)]([{'$match':{'status':_0x2a06f3(0x10c),'name':_0xc718a0[_0x2a06f3(0x7f)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x2a06f3(0xf1)}}},{'$group':{'_id':_0x2a06f3(0x126),'name':{'$first':_0x2a06f3(0x126)}}}]);}else _0x312a46=await warehouse[_0x2a06f3(0xc3)]([{'$match':{'status':'Enabled','warehouse_category':_0x2a06f3(0xe3),'name':{'$ne':_0x2a06f3(0xf1)}}},{'$group':{'_id':_0x2a06f3(0x126),'name':{'$first':'$name'}}}]);const _0x3f685e=await product[_0x2a06f3(0x11e)]({}),_0xd302e9=await adjustment[_0x2a06f3(0x11e)]({}),_0x8a640e=_0xd302e9['length']+0x1,_0x17d43d='ADJ-'+_0x8a640e[_0x2a06f3(0xde)]()[_0x2a06f3(0x13a)](0x5,'0');var _0xc2d84f=[_0x2a06f3(0x75),_0x2a06f3(0x92),_0x2a06f3(0xbf)];if(_0x2a9276[0x0][_0x2a06f3(0xcc)]==_0x2a06f3(0xaf))var _0x288de6=users[_0x2a06f3(0x12d)];else{if(_0x2a9276[0x0][_0x2a06f3(0xcc)]==_0x2a06f3(0xa5))var _0x288de6=users[_0x2a06f3(0xa5)];else{if(_0x2a9276[0x0][_0x2a06f3(0xcc)]==_0x2a06f3(0xca))var _0x288de6=users[_0x2a06f3(0xca)];else{if(_0x2a9276[0x0][_0x2a06f3(0xcc)]=='Spanish')var _0x288de6=users[_0x2a06f3(0x147)];else{if(_0x2a9276[0x0]['language']=='French')var _0x288de6=users[_0x2a06f3(0x91)];else{if(_0x2a9276[0x0][_0x2a06f3(0xcc)]==_0x2a06f3(0x8a))var _0x288de6=users[_0x2a06f3(0xf0)];else{if(_0x2a9276[0x0]['language']==_0x2a06f3(0xbe))var _0x288de6=users[_0x2a06f3(0xbe)];else{if(_0x2a9276[0x0][_0x2a06f3(0xcc)]==_0x2a06f3(0xd9))var _0x288de6=users['Arabic'];}}}}}}}const _0x601ff5=getRandom8DigitNumber();_0x601ff5[_0x2a06f3(0xcf)](_0x234363=>{var _0x550989=_0x2a06f3;_0x15601c[_0x550989(0xa6)](_0x550989(0x115),{'success':_0xb98be5['flash'](_0x550989(0x105)),'errors':_0xb98be5[_0x550989(0x94)](_0x550989(0x70)),'role':_0xc281d4,'profile':_0x1463d3,'warehouse':_0x312a46,'product':_0x3f685e,'master_shop':_0x2a9276,'language':_0x288de6,'rooms_data':_0xc2d84f,'invoice_no':_0x234363});})[_0x2a06f3(0xf8)](_0x5e725c=>{var _0x49002e=_0x2a06f3;_0xb98be5['flash'](_0x49002e(0x70),_0x49002e(0x138)),_0x15601c[_0x49002e(0x141)]('/adjustment/view');});}catch(_0x22e196){console[_0x2a06f3(0x139)](_0x22e196);}}),router[a0_0x5881aa(0xf6)](a0_0x5881aa(0xb9),auth,async(_0x3be508,_0x28410e)=>{var _0x47c0cf=a0_0x5881aa;try{const {warehouse_name:_0x32daca,date:_0x5b58ac,prod_name:_0x320f0c,level:_0x3c87fc,isle:_0x5036b0,pallet:_0x30925e,stock:_0x3171aa,types:_0x2043e1,adjust_qty:_0x48411b,new_adjust_qty:_0x25c368,note:_0x27aee3,Room_name:_0x2c2de6,invoice:_0x4361a3,JO_number:_0x53b4b5,expiry_date:_0x4b7e66}=_0x3be508['body'];if(typeof _0x320f0c==_0x47c0cf(0xe5))var _0x3acc65=[_0x3be508[_0x47c0cf(0x99)]['prod_name']],_0x2ed7d4=[_0x3be508['body'][_0x47c0cf(0xf5)]],_0x1ed014=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x9a)]],_0x2f156f=[_0x3be508['body'][_0x47c0cf(0x117)]],_0x56b36d=[_0x3be508['body'][_0x47c0cf(0xd2)]],_0xf01214=[_0x3be508[_0x47c0cf(0x99)]['New_Qty_Converted']],_0x1f769e=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x109)]],_0x1237ee=[_0x3be508[_0x47c0cf(0x99)]['Secondary_units']],_0x4c0613=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0xff)]],_0x2acad5=[_0x3be508[_0x47c0cf(0x99)]['batch_code']],_0x2f839d=[_0x3be508[_0x47c0cf(0x99)]['expiry_date']],_0x17946a=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x13f)]],_0x1e4bd0=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0xd3)]],_0x2c1d18=[_0x3be508[_0x47c0cf(0x99)]['prod_cat']],_0x21aee7=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x79)]],_0x53510c=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x12c)]],_0x191da8=[_0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x6d)]],_0x38988=[_0x3be508['body'][_0x47c0cf(0x90)]],_0x544dfb=[_0x3be508['body']['id_transaction']];else var _0x3acc65=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0xa8)]],_0x2ed7d4=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0xf5)]],_0x1ed014=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x9a)]],_0x2f156f=[..._0x3be508[_0x47c0cf(0x99)]['types']],_0x56b36d=[..._0x3be508['body'][_0x47c0cf(0xd2)]],_0xf01214=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0xb0)]],_0x1f769e=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0xe0)]],_0x1237ee=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x6f)]],_0x4c0613=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0xff)]],_0x2acad5=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x84)]],_0x2f839d=[..._0x3be508['body'][_0x47c0cf(0xc1)]],_0x17946a=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x13f)]],_0x1e4bd0=[..._0x3be508['body'][_0x47c0cf(0xd3)]],_0x2c1d18=[..._0x3be508['body'][_0x47c0cf(0x8b)]],_0x21aee7=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x79)]],_0x53510c=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x12c)]],_0x191da8=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x6d)]],_0x38988=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x90)]],_0x544dfb=[..._0x3be508[_0x47c0cf(0x99)][_0x47c0cf(0x9f)]];const _0x4ce818=_0x3acc65['map'](_0x1ce005=>{return _0x1ce005={'product_name':_0x1ce005};});_0x2ed7d4[_0x47c0cf(0xa4)]((_0x2c1c73,_0x23795e)=>{_0x21aee7['forEach']((_0x1b5d29,_0x1b646a)=>{var _0x10e2f1=a0_0x2cec;if(_0x1b5d29=='Receiving\x20Area'&&_0x23795e==_0x1b646a){var _0x5b809e=_0x2c1c73['slice'](0x3);_0x4ce818[_0x23795e][_0x10e2f1(0x6b)]=_0x2c1c73[0x0],_0x4ce818[_0x23795e][_0x10e2f1(0xdf)]=_0x2c1c73[0x1],_0x4ce818[_0x23795e][_0x10e2f1(0x110)]=0x0,_0x4ce818[_0x23795e][_0x10e2f1(0x136)]=0x0,_0x4ce818[_0x23795e][_0x10e2f1(0x7d)]=_0x10e2f1(0x8d),_0x4ce818[_0x23795e][_0x10e2f1(0x7a)]=_0x5b809e;}else{if(_0x1b5d29==_0x10e2f1(0x123)&&_0x23795e==_0x1b646a){var _0x5b809e=_0x2c1c73[_0x10e2f1(0x134)](0x3);_0x4ce818[_0x23795e]['storage']=_0x2c1c73[0x0],_0x4ce818[_0x23795e]['rack']=_0x2c1c73[0x1],_0x4ce818[_0x23795e][_0x10e2f1(0x110)]=0x0,_0x4ce818[_0x23795e]['bin']=0x0,_0x4ce818[_0x23795e][_0x10e2f1(0x7d)]=_0x10e2f1(0x8d),_0x4ce818[_0x23795e][_0x10e2f1(0x7a)]=_0x2c1c73[0x5];}else{if(_0x23795e==_0x1b646a){var _0x2bfd27;if(_0x2c1c73[0x4]=='L')_0x2bfd27=_0x10e2f1(0xc2);else _0x2c1c73[0x4]=='F'&&(_0x2bfd27=_0x10e2f1(0x8d));_0x4ce818[_0x23795e][_0x10e2f1(0x6b)]=_0x2c1c73[0x0],_0x4ce818[_0x23795e][_0x10e2f1(0xdf)]=_0x2c1c73[0x1],_0x4ce818[_0x23795e][_0x10e2f1(0x110)]=_0x2c1c73[0x2],_0x4ce818[_0x23795e]['bin']=_0x2c1c73[0x3],_0x4ce818[_0x23795e][_0x10e2f1(0x7d)]=_0x2bfd27,_0x4ce818[_0x23795e][_0x10e2f1(0x7a)]=_0x2c1c73[0x5];}}}});}),_0x1ed014[_0x47c0cf(0xa4)]((_0x3128a5,_0x3cc7c0)=>{var _0x517959=_0x47c0cf;_0x4ce818[_0x3cc7c0][_0x517959(0x108)]=_0x3128a5;}),_0x544dfb['forEach']((_0x4e7a6f,_0x4c36e3)=>{var _0x15f674=_0x47c0cf;_0x4ce818[_0x4c36e3][_0x15f674(0xbc)]=_0x4e7a6f;}),_0x2f156f[_0x47c0cf(0xa4)]((_0xb567fb,_0x3a7158)=>{_0x4ce818[_0x3a7158]['types']=_0xb567fb;}),_0x56b36d[_0x47c0cf(0xa4)]((_0x3435f3,_0x45e2b9)=>{_0x4ce818[_0x45e2b9]['adjust_qty']=_0x3435f3;}),_0xf01214[_0x47c0cf(0xa4)]((_0x51422b,_0x5b93a8)=>{_0x4ce818[_0x5b93a8]['new_adjust_qty']=_0x51422b;}),_0x1f769e[_0x47c0cf(0xa4)]((_0x4efc93,_0x367119)=>{var _0x7150b0=_0x47c0cf;_0x4ce818[_0x367119][_0x7150b0(0xe0)]=_0x4efc93;}),_0x1237ee[_0x47c0cf(0xa4)]((_0x5ba8da,_0x40dea0)=>{var _0x1fc9f6=_0x47c0cf;_0x4ce818[_0x40dea0][_0x1fc9f6(0x9c)]=_0x5ba8da;}),_0x4c0613[_0x47c0cf(0xa4)]((_0x113e00,_0x4e0e8b)=>{var _0x3ea09e=_0x47c0cf;_0x4ce818[_0x4e0e8b][_0x3ea09e(0xd4)]=_0x113e00;}),_0x2acad5[_0x47c0cf(0xa4)]((_0x15e1cc,_0x745b44)=>{_0x4ce818[_0x745b44]['batch_code']=_0x15e1cc;}),_0x2f839d[_0x47c0cf(0xa4)]((_0x586331,_0x289c31)=>{_0x4ce818[_0x289c31]['expiry_date']=_0x586331;}),_0x17946a[_0x47c0cf(0xa4)]((_0x315822,_0x64d6d7)=>{var _0x3af6b5=_0x47c0cf;_0x4ce818[_0x64d6d7][_0x3af6b5(0xc9)]=_0x315822;}),_0x1e4bd0[_0x47c0cf(0xa4)]((_0x5da34f,_0x108140)=>{var _0x2df4c8=_0x47c0cf;_0x4ce818[_0x108140][_0x2df4c8(0xd3)]=_0x5da34f;}),_0x2c1d18[_0x47c0cf(0xa4)]((_0x19f382,_0x176e1a)=>{var _0x1bee3b=_0x47c0cf;_0x4ce818[_0x176e1a][_0x1bee3b(0x8b)]=_0x19f382;}),_0x21aee7[_0x47c0cf(0xa4)]((_0xeb3361,_0x54984d)=>{_0x4ce818[_0x54984d]['room_names']=_0xeb3361;}),_0x53510c[_0x47c0cf(0xa4)]((_0x3f6f70,_0xa96b7c)=>{var _0x38e481=_0x47c0cf;_0x4ce818[_0xa96b7c][_0x38e481(0x127)]=_0x3f6f70;}),_0x191da8[_0x47c0cf(0xa4)]((_0x59172d,_0x4246e1)=>{var _0x27833d=_0x47c0cf;_0x4ce818[_0x4246e1][_0x27833d(0xbb)]=_0x59172d;}),_0x38988['forEach']((_0x33da89,_0x5f4b61)=>{var _0x8e79b4=_0x47c0cf;_0x4ce818[_0x5f4b61][_0x8e79b4(0x146)]=_0x33da89;});const _0x363ed2=_0x4ce818[_0x47c0cf(0x104)](_0x2a4881=>_0x2a4881[_0x47c0cf(0x9b)]!=='0'&&_0x2a4881['adjust_qty']!=='');var _0x34dc5a=0x0;_0x363ed2['forEach'](_0x3b1fb0=>{var _0x1edf01=_0x47c0cf;console[_0x1edf01(0x139)](_0x1edf01(0xb7),_0x3b1fb0),parseInt(_0x3b1fb0[_0x1edf01(0x9b)])<=0x0&&_0x34dc5a++;});if(_0x34dc5a!=0x0)return _0x3be508[_0x47c0cf(0x94)]('errors',_0x47c0cf(0x72)),_0x28410e[_0x47c0cf(0x141)](_0x47c0cf(0x97));const _0xc0c234=new adjustment({'warehouse_name':_0x32daca,'date':_0x5b58ac,'product':_0x363ed2,'note':_0x27aee3,'room':_0x2c2de6,'invoice':_0x4361a3,'JO_number':_0x53b4b5,'expiry_date':_0x4b7e66}),_0x31f748=await _0xc0c234['save']();_0x3be508[_0x47c0cf(0x94)](_0x47c0cf(0x105),_0x47c0cf(0xea)),_0x28410e['redirect'](_0x47c0cf(0xe1)+_0x31f748[_0x47c0cf(0x7b)]);}catch(_0x44fab2){console[_0x47c0cf(0x139)](_0x44fab2),_0x28410e[_0x47c0cf(0x143)](0xc8)[_0x47c0cf(0xaa)]({'message':_0x44fab2['message']});}}),router[a0_0x5881aa(0xc6)]('/preview/:id',auth,async(_0x35a992,_0x2e4164)=>{var _0xd25da5=a0_0x5881aa;try{const {username:_0x12b873,email:_0x51c3cf,role:_0x5e5027}=_0x35a992[_0xd25da5(0xec)],_0x36d43d=_0x35a992[_0xd25da5(0xec)],_0x15584f=await profile[_0xd25da5(0xfd)]({'email':_0x36d43d[_0xd25da5(0x131)]}),_0x4fe26a=await master_shop[_0xd25da5(0x11e)](),_0x59861a=_0x35a992[_0xd25da5(0xfa)]['id'],_0x516f60=await adjustment['findById']({'_id':_0x59861a}),_0x1f8811=await purchases[_0xd25da5(0xc3)]([{'$match':{'warehouse_name':_0x516f60[_0xd25da5(0x101)]}},{'$unwind':_0xd25da5(0xce)},{'$group':{'_id':_0xd25da5(0x118)}}]),_0x33c6d7=await product[_0xd25da5(0x11e)]({}),_0x5ea32e=await warehouse['aggregate']([{'$match':{'name':_0x516f60[_0xd25da5(0x101)]}},{'$unwind':_0xd25da5(0x87)},{'$group':{'_id':_0xd25da5(0xa9),'name':{'$first':_0xd25da5(0x76)},'product_stock':{'$first':_0xd25da5(0x11a)},'bay':{'$first':_0xd25da5(0xdc)},'bin':{'$first':_0xd25da5(0xad)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xd25da5(0x80)},'primary_code':{'$first':_0xd25da5(0x93)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xd25da5(0xed)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xd25da5(0xb8)},'maxPerUnit':{'$first':_0xd25da5(0xd1)},'expiry_date':{'$first':_0xd25da5(0x73)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xd25da5(0x13c)},'room':{'$first':_0xd25da5(0x12a)}}}]);if(_0x4fe26a[0x0][_0xd25da5(0xcc)]==_0xd25da5(0xaf)){var _0xf1e7de=users[_0xd25da5(0x12d)];console[_0xd25da5(0x139)](_0xf1e7de);}else{if(_0x4fe26a[0x0][_0xd25da5(0xcc)]==_0xd25da5(0xa5))var _0xf1e7de=users[_0xd25da5(0xa5)];else{if(_0x4fe26a[0x0][_0xd25da5(0xcc)]=='German')var _0xf1e7de=users[_0xd25da5(0xca)];else{if(_0x4fe26a[0x0][_0xd25da5(0xcc)]==_0xd25da5(0x147))var _0xf1e7de=users[_0xd25da5(0x147)];else{if(_0x4fe26a[0x0][_0xd25da5(0xcc)]==_0xd25da5(0x91))var _0xf1e7de=users['French'];else{if(_0x4fe26a[0x0][_0xd25da5(0xcc)]==_0xd25da5(0x8a))var _0xf1e7de=users['Portuguese'];else{if(_0x4fe26a[0x0]['language']==_0xd25da5(0xbe))var _0xf1e7de=users[_0xd25da5(0xbe)];else{if(_0x4fe26a[0x0]['language']==_0xd25da5(0xd9))var _0xf1e7de=users[_0xd25da5(0xc5)];}}}}}}}_0x2e4164['render'](_0xd25da5(0xd0),{'success':_0x35a992[_0xd25da5(0x94)](_0xd25da5(0x105)),'errors':_0x35a992[_0xd25da5(0x94)](_0xd25da5(0x70)),'role':_0x36d43d,'profile':_0x15584f,'adjustment':_0x516f60,'master_shop':_0x4fe26a,'warehouse_name':_0x1f8811,'unit':_0x33c6d7,'language':_0xf1e7de});}catch(_0x35aab2){console['log'](_0x35aab2),_0x2e4164[_0xd25da5(0x143)](0xc8)[_0xd25da5(0xaa)]({'message':_0x35aab2[_0xd25da5(0x9e)]});}}),router[a0_0x5881aa(0xf6)](a0_0x5881aa(0xb2),auth,async(_0x5cee3b,_0x3169ab)=>{var _0x3fcb0f=a0_0x5881aa;try{const _0x137d8f=_0x5cee3b[_0x3fcb0f(0xfa)]['id'],{warehouse_name:_0x11fd90,Room_name:_0x5773d2}=_0x5cee3b[_0x3fcb0f(0x99)],_0xb3d99f=await adjustment[_0x3fcb0f(0x10b)]({'_id':_0x137d8f}),_0xe87945=_0xb3d99f[_0x3fcb0f(0xb4)][_0x3fcb0f(0x8f)](async _0x1c0e6c=>{var _0x274f02=_0x3fcb0f;if(_0x1c0e6c['adjust_qty']>0x0){const _0x36e268=mongoose[_0x274f02(0x10e)][_0x274f02(0xb1)];var _0x5a7530=await warehouse[_0x274f02(0xc3)]([{'$match':{'name':_0x11fd90,'room':_0x1c0e6c[_0x274f02(0x124)],'warehouse_category':_0x274f02(0xe3)}},{'$unwind':_0x274f02(0x87)},{'$match':{'product_details._id':_0x36e268(_0x1c0e6c['id_transaction_from'])}}]),_0x4792d8=0x0;for(let _0x1ec94f=0x0;_0x1ec94f<=_0x5a7530[_0x274f02(0xba)]-0x1;_0x1ec94f++){const _0x4c5aa3=_0x5a7530[_0x1ec94f];_0x1c0e6c[_0x274f02(0x117)]=='minus'?(console[_0x274f02(0x139)]('-'),_0x4792d8=parseFloat(_0x5a7530[_0x1ec94f][_0x274f02(0xa7)][_0x274f02(0xeb)])-parseFloat(_0x1c0e6c['adjust_qty'])):(console[_0x274f02(0x139)]('+'),_0x4792d8=parseFloat(_0x5a7530[_0x1ec94f][_0x274f02(0xa7)][_0x274f02(0xeb)])+parseFloat(_0x1c0e6c[_0x274f02(0x9b)])),await warehouse[_0x274f02(0x11f)]({'_id':_0x36e268(_0x4c5aa3[_0x274f02(0x7b)]['valueOf']()),'product_details._id':_0x36e268(_0x4c5aa3[_0x274f02(0xa7)][_0x274f02(0x7b)])},{'$set':{'product_details.$.product_stock':_0x4792d8,'product_details.$.adj_invoice':_0xb3d99f[_0x274f02(0x146)]}}),console[_0x274f02(0x139)](_0x4c5aa3[_0x274f02(0x7b)][_0x274f02(0x12b)]()+_0x274f02(0x12e)+_0x4c5aa3[_0x274f02(0xa7)]['_id']+_0x274f02(0x12e)+_0x4792d8);}}});_0xb3d99f[_0x3fcb0f(0x78)]=_0x3fcb0f(0x12f);const _0x5d7c7d=await _0xb3d99f[_0x3fcb0f(0x111)](),_0x2f38d2=await master_shop['find'](),_0xf85b17=await email_settings['findOne'](),_0x43f786=await supervisor_settings[_0x3fcb0f(0x11e)]();var _0x32d019=_0xb3d99f[_0x3fcb0f(0xb4)],_0x268f72='',_0x169ee4;for(_0x169ee4 in _0x32d019){_0x268f72+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x32d019[_0x169ee4][_0x3fcb0f(0xa0)]+_0x3fcb0f(0x98)+_0x3fcb0f(0xef)+_0x32d019[_0x169ee4][_0x3fcb0f(0xd4)]+_0x3fcb0f(0x98)+_0x3fcb0f(0xef)+_0x32d019[_0x169ee4][_0x3fcb0f(0x9b)]+_0x3fcb0f(0x98)+_0x3fcb0f(0xef)+_0x32d019[_0x169ee4][_0x3fcb0f(0xe0)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x32d019[_0x169ee4][_0x3fcb0f(0x9c)]+'</td>'+_0x3fcb0f(0xef)+_0xb3d99f[_0x3fcb0f(0x101)]+_0x3fcb0f(0x98)+_0x3fcb0f(0xef)+_0x32d019[_0x169ee4][_0x3fcb0f(0x124)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x32d019[_0x169ee4][_0x3fcb0f(0x6b)]+_0x32d019[_0x169ee4][_0x3fcb0f(0xdf)]+_0x32d019[_0x169ee4][_0x3fcb0f(0x110)]+_0x32d019[_0x169ee4]['bin']+_0x32d019[_0x169ee4][_0x3fcb0f(0x7d)][0x0]+_0x32d019[_0x169ee4]['floorlevel']+_0x3fcb0f(0x98),_0x3fcb0f(0x128);}let _0x191aa5=nodemailer['createTransport']({'host':_0xf85b17[_0x3fcb0f(0x142)],'port':Number(_0xf85b17[_0x3fcb0f(0x88)]),'secure':![],'auth':{'user':_0xf85b17[_0x3fcb0f(0x131)],'pass':_0xf85b17['password']}}),_0x333e7b={'from':_0xf85b17['email'],'to':_0x43f786[0x0][_0x3fcb0f(0x130)],'subject':'Adjustment\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x3fcb0f(0x112)+'/upload/'+_0x2f38d2[0x0][_0x3fcb0f(0xfc)],'cid':_0x3fcb0f(0xf9)}],'html':_0x3fcb0f(0xd6)+'<html><head><title></title>'+'</head><body>'+'<div>'+_0x3fcb0f(0x119)+_0x3fcb0f(0x7e)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x3fcb0f(0x7e)+_0x3fcb0f(0x102)+_0x2f38d2[0x0][_0x3fcb0f(0xa2)]+_0x3fcb0f(0x113)+_0x3fcb0f(0xb3)+_0x3fcb0f(0xb3)+_0x3fcb0f(0xfb)+_0x3fcb0f(0x7e)+_0x3fcb0f(0x135)+_0x3fcb0f(0xf4)+_0xb3d99f[_0x3fcb0f(0x146)]+'\x20'+_0x3fcb0f(0x10d)+'\x20Order\x20Date\x20:\x20'+_0xb3d99f[_0x3fcb0f(0xe8)]+'\x20'+_0x3fcb0f(0x83)+_0x3fcb0f(0xe2)+'</div>'+_0x3fcb0f(0x132)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3fcb0f(0x13e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x3fcb0f(0x121)+_0x3fcb0f(0x13d)+_0x3fcb0f(0x145)+_0x3fcb0f(0xbd)+_0x3fcb0f(0x140)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3fcb0f(0xe4)+_0x3fcb0f(0x128)+_0x3fcb0f(0xe9)+_0x3fcb0f(0xdd)+'\x20'+_0x268f72+'\x20'+_0x3fcb0f(0x114)+_0x3fcb0f(0x6e)+_0x3fcb0f(0x7e)+_0x3fcb0f(0x133)+_0x3fcb0f(0xd5)+_0x2f38d2[0x0][_0x3fcb0f(0xa2)]+_0x3fcb0f(0xe2)+_0x3fcb0f(0xb3)+'</div>'+'</body></html>'};_0x191aa5[_0x3fcb0f(0xc7)](_0x333e7b,function(_0x2151df,_0x3695cd){var _0x2c8a80=_0x3fcb0f;_0x2151df?(console[_0x2c8a80(0x139)](_0x2151df),console[_0x2c8a80(0x139)]('Error\x20Occurs')):console['log'](_0x2c8a80(0xdb));}),_0x5cee3b['flash']('success',_0x3fcb0f(0x82)),_0x3169ab[_0x3fcb0f(0x141)](_0x3fcb0f(0xf3)+_0x5d7c7d['_id']);}catch(_0x5b4703){console[_0x3fcb0f(0x139)](_0x5b4703),_0x3169ab[_0x3fcb0f(0x143)](0xc8)[_0x3fcb0f(0xaa)]({'message':_0x5b4703['message']});}}),router[a0_0x5881aa(0xc6)]('/view/:id',auth,async(_0x5ca7de,_0x1d1411)=>{var _0x697227=a0_0x5881aa;try{const {username:_0xe1f7f3,email:_0x181275,role:_0x5ce632}=_0x5ca7de['user'],_0x253ba8=_0x5ca7de[_0x697227(0xec)],_0x16f073=await profile[_0x697227(0xfd)]({'email':_0x253ba8[_0x697227(0x131)]}),_0x30ac09=await master_shop['find'](),_0x18f5cc=_0x5ca7de[_0x697227(0xfa)]['id'],_0x1b1883=await adjustment[_0x697227(0x10b)]({'_id':_0x18f5cc}),_0x5914e5=await purchases[_0x697227(0xc3)]([{'$match':{'warehouse_name':_0x1b1883[_0x697227(0x101)]}},{'$unwind':_0x697227(0xce)},{'$group':{'_id':_0x697227(0x118)}}]),_0x36902e=await product[_0x697227(0x11e)]({}),_0x3b0c69=await warehouse['aggregate']([{'$match':{'name':_0x1b1883[_0x697227(0x101)]}},{'$unwind':_0x697227(0x87)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x697227(0xdc)},'bin':{'$first':_0x697227(0xad)},'type':{'$first':_0x697227(0x10a)},'floorlevel':{'$first':_0x697227(0x80)},'primary_code':{'$first':_0x697227(0x93)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x697227(0xe7)},'rack':{'$first':_0x697227(0xb8)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x697227(0x86)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x697227(0x12a)}}}]);let _0x2df615;if(_0x253ba8[_0x697227(0x9d)]=='staff'){const _0x5cbca9=await staff[_0x697227(0xfd)]({'email':_0x253ba8[_0x697227(0x131)]});_0x2df615=await warehouse[_0x697227(0xc3)]([{'$match':{'status':_0x697227(0x10c),'name':_0x5cbca9['warehouse'],'warehouse_category':_0x697227(0xe3),'name':{'$ne':_0x697227(0xf1)}}},{'$group':{'_id':_0x697227(0x126),'name':{'$first':'$name'}}}]);}else _0x2df615=await warehouse[_0x697227(0xc3)]([{'$match':{'status':'Enabled','warehouse_category':_0x697227(0xe3),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x697227(0x126),'name':{'$first':'$name'}}}]);if(_0x30ac09[0x0][_0x697227(0xcc)]==_0x697227(0xaf)){var _0x2158a7=users['English'];console[_0x697227(0x139)](_0x2158a7);}else{if(_0x30ac09[0x0]['language']==_0x697227(0xa5))var _0x2158a7=users[_0x697227(0xa5)];else{if(_0x30ac09[0x0][_0x697227(0xcc)]=='German')var _0x2158a7=users[_0x697227(0xca)];else{if(_0x30ac09[0x0][_0x697227(0xcc)]==_0x697227(0x147))var _0x2158a7=users[_0x697227(0x147)];else{if(_0x30ac09[0x0][_0x697227(0xcc)]==_0x697227(0x91))var _0x2158a7=users[_0x697227(0x91)];else{if(_0x30ac09[0x0][_0x697227(0xcc)]=='Portuguese\x20(BR)')var _0x2158a7=users[_0x697227(0xf0)];else{if(_0x30ac09[0x0]['language']=='Chinese')var _0x2158a7=users['Chinese'];else{if(_0x30ac09[0x0]['language']=='Arabic\x20(ae)')var _0x2158a7=users['Arabic'];}}}}}}}_0x1d1411[_0x697227(0xa6)](_0x697227(0x85),{'success':_0x5ca7de[_0x697227(0x94)](_0x697227(0x105)),'errors':_0x5ca7de['flash'](_0x697227(0x70)),'role':_0x253ba8,'profile':_0x16f073,'adjustment':_0x1b1883,'stock':_0x3b0c69,'master_shop':_0x30ac09,'warehouse_name':_0x5914e5,'unit':_0x36902e,'language':_0x2158a7,'warehouse':_0x2df615});}catch(_0x4261a6){console[_0x697227(0x139)](_0x4261a6),_0x1d1411[_0x697227(0x143)](0xc8)[_0x697227(0xaa)]({'message':_0x4261a6[_0x697227(0x9e)]});}}),router[a0_0x5881aa(0xf6)](a0_0x5881aa(0x116),auth,async(_0x419308,_0xa52f7d)=>{var _0x3a6bf4=a0_0x5881aa;try{const _0x22248c=_0x419308['params']['id'],_0x5a2209=await adjustment[_0x3a6bf4(0x10b)]({'_id':_0x22248c}),_0x1cf4d8=await warehouse['findOne']({'name':_0x5a2209[_0x3a6bf4(0x101)],'room':_0x5a2209['room']}),{warehouse_name:_0x2b318a,date:_0x18df6e,prod_name:_0x5933d7,level:_0x30a7fc,isle:_0xa5e926,pallet:_0x48ae59,stock:_0x214bbb,types:_0x4566e1,adjust_qty:_0x161fe4,new_adjust_qty:_0x1d6c42,note:_0x2075a6,Room_name:_0x5ebf6f,invoice:_0x4179a1,JO_number:_0x30e6a0,expiry_date:_0x2165fc}=_0x419308['body'];if(typeof _0x5933d7==_0x3a6bf4(0xe5))var _0x1150e1=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xa8)]],_0x40fcc4=[_0x419308[_0x3a6bf4(0x99)]['level']],_0x32d22f=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x9a)]],_0x22923a=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x117)]],_0x3e06ee=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xd2)]],_0x1f6d19=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xb0)]],_0x57d890=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x109)]],_0x10ecb7=[_0x419308['body'][_0x3a6bf4(0x6f)]],_0x218163=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xff)]],_0x21e316=[_0x419308[_0x3a6bf4(0x99)]['batch_code']],_0x525bd9=[_0x419308['body']['expiry_date']],_0x564630=[_0x419308['body'][_0x3a6bf4(0x13f)]],_0x2634e6=[_0x419308['body'][_0x3a6bf4(0xd3)]],_0xb0a098=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x8b)]],_0x3ba294=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x79)]],_0x1e3a58=[_0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x12c)]],_0x3e7432=[_0x419308['body'][_0x3a6bf4(0x6d)]];else var _0x1150e1=[..._0x419308['body'][_0x3a6bf4(0xa8)]],_0x40fcc4=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xf5)]],_0x32d22f=[..._0x419308[_0x3a6bf4(0x99)]['stock']],_0x22923a=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x117)]],_0x3e06ee=[..._0x419308['body']['New_Qty_Converted_adj']],_0x1f6d19=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xb0)]],_0x57d890=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xe0)]],_0x10ecb7=[..._0x419308['body'][_0x3a6bf4(0x6f)]],_0x218163=[..._0x419308['body'][_0x3a6bf4(0xff)]],_0x21e316=[..._0x419308['body']['batch_code']],_0x525bd9=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0xc1)]],_0x564630=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x13f)]],_0x2634e6=[..._0x419308[_0x3a6bf4(0x99)]['production_date']],_0xb0a098=[..._0x419308['body'][_0x3a6bf4(0x8b)]],_0x3ba294=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x79)]],_0x1e3a58=[..._0x419308[_0x3a6bf4(0x99)][_0x3a6bf4(0x12c)]],_0x3e7432=[..._0x419308['body'][_0x3a6bf4(0x6d)]];const _0x1bdd9a=_0x1150e1['map'](_0x2b3ece=>{return _0x2b3ece={'product_name':_0x2b3ece};});_0x40fcc4[_0x3a6bf4(0xa4)]((_0x1ca596,_0x388f89)=>{var _0x9d4155=_0x3a6bf4;_0x3ba294[_0x9d4155(0xa4)]((_0x5c0f4e,_0x169f90)=>{var _0x276c0a=_0x9d4155;if(_0x5c0f4e==_0x276c0a(0xb6)&&_0x388f89==_0x169f90){var _0x5e63f9=_0x1ca596[_0x276c0a(0x134)](0x3);_0x1bdd9a[_0x388f89]['storage']=_0x1ca596[0x0],_0x1bdd9a[_0x388f89][_0x276c0a(0xdf)]=_0x1ca596[0x1],_0x1bdd9a[_0x388f89]['bay']=0x0,_0x1bdd9a[_0x388f89][_0x276c0a(0x136)]=0x0,_0x1bdd9a[_0x388f89]['type']='Floor',_0x1bdd9a[_0x388f89][_0x276c0a(0x7a)]=_0x5e63f9;}else{if(_0x5c0f4e==_0x276c0a(0x123)&&_0x388f89==_0x169f90){var _0x5e63f9=_0x1ca596[_0x276c0a(0x134)](0x3);_0x1bdd9a[_0x388f89][_0x276c0a(0x6b)]=_0x1ca596[0x0],_0x1bdd9a[_0x388f89][_0x276c0a(0xdf)]=_0x1ca596[0x1],_0x1bdd9a[_0x388f89][_0x276c0a(0x110)]=0x0,_0x1bdd9a[_0x388f89][_0x276c0a(0x136)]=0x0,_0x1bdd9a[_0x388f89]['type']=_0x276c0a(0x8d),_0x1bdd9a[_0x388f89]['floorlevel']=_0x1ca596[0x5];}else{if(_0x388f89==_0x169f90){var _0x5098d8;if(_0x1ca596[0x4]=='L')_0x5098d8=_0x276c0a(0xc2);else _0x1ca596[0x4]=='F'&&(_0x5098d8='Floor');_0x1bdd9a[_0x388f89][_0x276c0a(0x6b)]=_0x1ca596[0x0],_0x1bdd9a[_0x388f89][_0x276c0a(0xdf)]=_0x1ca596[0x1],_0x1bdd9a[_0x388f89]['bay']=_0x1ca596[0x2],_0x1bdd9a[_0x388f89][_0x276c0a(0x136)]=_0x1ca596[0x3],_0x1bdd9a[_0x388f89][_0x276c0a(0x7d)]=_0x5098d8,_0x1bdd9a[_0x388f89][_0x276c0a(0x7a)]=_0x1ca596[0x5];}}}});}),_0x32d22f['forEach']((_0x5be4f6,_0x294f3d)=>{var _0x47b27b=_0x3a6bf4;_0x1bdd9a[_0x294f3d][_0x47b27b(0x108)]=_0x5be4f6;}),_0x22923a[_0x3a6bf4(0xa4)]((_0x3f4ee3,_0x9baa03)=>{_0x1bdd9a[_0x9baa03]['types']=_0x3f4ee3;}),_0x3e06ee['forEach']((_0x13c63f,_0x501474)=>{_0x1bdd9a[_0x501474]['adjust_qty']=_0x13c63f;}),_0x1f6d19[_0x3a6bf4(0xa4)]((_0x47aa6c,_0x5416a1)=>{var _0x50994c=_0x3a6bf4;_0x1bdd9a[_0x5416a1][_0x50994c(0xd7)]=_0x47aa6c;}),_0x57d890[_0x3a6bf4(0xa4)]((_0x4d197e,_0x136af5)=>{var _0x535f48=_0x3a6bf4;_0x1bdd9a[_0x136af5][_0x535f48(0xe0)]=_0x4d197e;}),_0x10ecb7[_0x3a6bf4(0xa4)]((_0x22b712,_0x6ef765)=>{var _0x3b044d=_0x3a6bf4;_0x1bdd9a[_0x6ef765][_0x3b044d(0x9c)]=_0x22b712;}),_0x218163[_0x3a6bf4(0xa4)]((_0x2180ad,_0x1a0ccd)=>{var _0x9bcd33=_0x3a6bf4;_0x1bdd9a[_0x1a0ccd][_0x9bcd33(0xd4)]=_0x2180ad;}),_0x21e316['forEach']((_0xae67cd,_0x4e3a0c)=>{var _0x290f69=_0x3a6bf4;_0x1bdd9a[_0x4e3a0c][_0x290f69(0x84)]=_0xae67cd;}),_0x525bd9[_0x3a6bf4(0xa4)]((_0x545f37,_0x171bfe)=>{var _0xa1fd19=_0x3a6bf4;_0x1bdd9a[_0x171bfe][_0xa1fd19(0xc1)]=_0x545f37;}),_0x564630[_0x3a6bf4(0xa4)]((_0x3875bc,_0x35322d)=>{var _0x312ab3=_0x3a6bf4;_0x1bdd9a[_0x35322d][_0x312ab3(0xc9)]=_0x3875bc;}),_0x2634e6[_0x3a6bf4(0xa4)]((_0x2cccc4,_0x458696)=>{_0x1bdd9a[_0x458696]['production_date']=_0x2cccc4;}),_0xb0a098[_0x3a6bf4(0xa4)]((_0x97e110,_0x5a75a8)=>{var _0x150201=_0x3a6bf4;_0x1bdd9a[_0x5a75a8][_0x150201(0x8b)]=_0x97e110;}),_0x3ba294[_0x3a6bf4(0xa4)]((_0x1a0fb3,_0x407b01)=>{var _0x214d4d=_0x3a6bf4;_0x1bdd9a[_0x407b01][_0x214d4d(0x124)]=_0x1a0fb3;}),_0x1e3a58[_0x3a6bf4(0xa4)]((_0x198465,_0x2d0107)=>{var _0x243a65=_0x3a6bf4;_0x1bdd9a[_0x2d0107][_0x243a65(0x127)]=_0x198465;}),_0x3e7432[_0x3a6bf4(0xa4)]((_0x10db8a,_0x341897)=>{var _0x471f84=_0x3a6bf4;_0x1bdd9a[_0x341897][_0x471f84(0xbb)]=_0x10db8a;});const _0x5bb5f5=_0x1bdd9a[_0x3a6bf4(0x104)](_0x21a2bb=>_0x21a2bb['adjust_qty']!=='0'&&_0x21a2bb['adjust_qty']!=='');var _0x28fbbd=0x0;_0x5bb5f5['forEach'](_0x386efd=>{var _0x5ecdd4=_0x3a6bf4;console['log'](_0x5ecdd4(0xb7),_0x386efd),parseInt(_0x386efd[_0x5ecdd4(0x9b)])<=0x0&&_0x28fbbd++;});if(_0x28fbbd!=0x0)return _0x419308[_0x3a6bf4(0x94)](_0x3a6bf4(0x70),_0x3a6bf4(0x72)),_0xa52f7d[_0x3a6bf4(0x141)](_0x3a6bf4(0x97));_0x5a2209[_0x3a6bf4(0x101)]=_0x2b318a,_0x5a2209[_0x3a6bf4(0xe8)]=_0x18df6e,_0x5a2209[_0x3a6bf4(0xb4)]=_0x5bb5f5,_0x5a2209['note']=_0x2075a6,_0x5a2209[_0x3a6bf4(0x146)]=_0x4179a1,_0x5a2209[_0x3a6bf4(0x125)]=_0x3a6bf4(0x11b);const _0x148f1a=await _0x5a2209[_0x3a6bf4(0x111)]();_0x419308[_0x3a6bf4(0x94)](_0x3a6bf4(0x105),'adjustment\x20data\x20update\x20successfully'),_0xa52f7d[_0x3a6bf4(0x141)](_0x3a6bf4(0xae));}catch(_0xe512f9){console['log'](_0xe512f9);}}),router[a0_0x5881aa(0xf6)](a0_0x5881aa(0xc0),async(_0x5070cd,_0x5a162a)=>{var _0x1b2d9a=a0_0x5881aa;const {primary_code:_0x322410,warehouse_data:_0x1f3e32,rooms_data:_0x4f71fc,Roomslist:_0x16dd20}=_0x5070cd[_0x1b2d9a(0x99)],_0x89f05f=_0x16dd20[_0x1b2d9a(0x107)](','),_0x12995f=[];async function _0x2cb426(_0x3852e1){var _0x166993=_0x1b2d9a;const _0x17796c=await warehouse[_0x166993(0xc3)]([{'$match':{'name':_0x1f3e32,'room':_0x3852e1}},{'$unwind':_0x166993(0x87)},{'$match':{'product_details.primary_code':_0x322410}},{'$group':{'_id':_0x166993(0xa9),'name':{'$first':_0x166993(0x76)},'product_stock':{'$first':_0x166993(0x11a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x166993(0x144)},'product_code':{'$first':_0x166993(0xed)},'level':{'$first':_0x166993(0xdc)},'isle':{'$first':_0x166993(0xad)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x166993(0x80)},'unit':{'$first':_0x166993(0x8e)},'secondary_unit':{'$first':_0x166993(0xc8)},'storage':{'$first':_0x166993(0xe7)},'rack':{'$first':_0x166993(0xb8)},'expiry_date':{'$first':_0x166993(0x73)},'production_date':{'$first':_0x166993(0x86)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x166993(0x13c)},'product_cat':{'$first':_0x166993(0x8c)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x166993(0x12a)},'invoice':{'$first':_0x166993(0x11d)}}}]),_0x2de9b9=await warehouse[_0x166993(0xc3)]([{'$match':{'name':_0x1f3e32,'room':_0x3852e1}},{'$unwind':_0x166993(0x87)},{'$match':{'product_details.secondary_code':_0x322410}},{'$group':{'_id':_0x166993(0xa9),'name':{'$first':_0x166993(0x76)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x166993(0x144)},'product_code':{'$first':_0x166993(0xed)},'level':{'$first':_0x166993(0xdc)},'isle':{'$first':_0x166993(0xad)},'type':{'$first':_0x166993(0x10a)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x166993(0xc8)},'storage':{'$first':_0x166993(0xe7)},'rack':{'$first':_0x166993(0xb8)},'expiry_date':{'$first':_0x166993(0x73)},'production_date':{'$first':_0x166993(0x86)},'maxPerUnit':{'$first':_0x166993(0xd1)},'batch_code':{'$first':_0x166993(0x13c)},'product_cat':{'$first':_0x166993(0x8c)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x166993(0x12a)}}}]);if(_0x17796c[_0x166993(0xba)]>0x0)_0x12995f[_0x166993(0xf2)](_0x17796c);else _0x2de9b9[_0x166993(0xba)]>0x0&&_0x12995f['push'](_0x2de9b9);}const _0x526577=_0x89f05f['map'](_0x11011e=>_0x2cb426(_0x11011e));await Promise[_0x1b2d9a(0x103)](_0x526577),_0x5a162a[_0x1b2d9a(0xaa)](_0x12995f);}),router['post']('/CheckingWarehouse',async(_0x42fc22,_0x2bbd4c)=>{var _0x38db9c=a0_0x5881aa;const {primaryCode:_0x2d051d,secondaryCode:_0x3e463e,productCode:_0x4cc327,level:_0x281e7f,isle:_0x387e12,pallet:_0xa374fd,warehouses:_0x42461f,room:_0x4acae0}=_0x42fc22[_0x38db9c(0x99)];try{const _0x402bd4=await warehouse['aggregate']([{'$match':{'name':_0x42461f,'room':_0x4acae0}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x281e7f),'product_details.isle':_0x387e12,'product_details.pallet':parseInt(_0xa374fd)}},{'$group':{'_id':_0x38db9c(0xa9),'name':{'$first':_0x38db9c(0x76)},'product_stock':{'$first':_0x38db9c(0x11a)},'level':{'$first':_0x38db9c(0x13b)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x38db9c(0x77)},'maxProducts':{'$first':_0x38db9c(0x95)}}}]);_0x2bbd4c['status'](0xc8)[_0x38db9c(0xaa)](_0x402bd4);}catch(_0x3da8a7){_0x2bbd4c['status'](0x194)[_0x38db9c(0xaa)]({'message':_0x3da8a7[_0x38db9c(0x9e)]});}}),module['exports']=router;