var a0_0x4e4bd7=a0_0x2a4e;(function(_0x32a194,_0x25cf2c){var _0x1009a5=a0_0x2a4e,_0x1ef2eb=_0x32a194();while(!![]){try{var _0x4efb6e=parseInt(_0x1009a5(0x23a))/0x1+parseInt(_0x1009a5(0x20b))/0x2+parseInt(_0x1009a5(0x242))/0x3+parseInt(_0x1009a5(0x20d))/0x4+-parseInt(_0x1009a5(0x1fd))/0x5+-parseInt(_0x1009a5(0x1d4))/0x6+-parseInt(_0x1009a5(0x245))/0x7*(parseInt(_0x1009a5(0x1ad))/0x8);if(_0x4efb6e===_0x25cf2c)break;else _0x1ef2eb['push'](_0x1ef2eb['shift']());}catch(_0x16fcf9){_0x1ef2eb['push'](_0x1ef2eb['shift']());}}}(a0_0x1997,0x857da));const express=require('express'),app=express(),router=express[a0_0x4e4bd7(0x1cb)](),auth=require(a0_0x4e4bd7(0x1d0)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x4e4bd7(0x221)),users=require(a0_0x4e4bd7(0x1cc)),nodemailer=require(a0_0x4e4bd7(0x224));router['get'](a0_0x4e4bd7(0x241),auth,async(_0x48871b,_0x55d2ad)=>{var _0x816289=a0_0x4e4bd7;try{const {username:_0x1f5a02,email:_0x4255b6,role:_0x47dea6}=_0x48871b['user'],_0x25563d=_0x48871b[_0x816289(0x265)],_0x28ad0b=await profile[_0x816289(0x227)]({'email':_0x25563d['email']}),_0x207110=await master_shop[_0x816289(0x213)]();console[_0x816289(0x1cd)](_0x816289(0x1e1),_0x207110);let _0x325a13;if(_0x25563d[_0x816289(0x1b4)]==_0x816289(0x21f)){const _0x36fe91=await staff['findOne']({'email':_0x25563d[_0x816289(0x24e)]});_0x325a13=await warehouse['find']({'status':_0x816289(0x1c0),'name':_0x36fe91[_0x816289(0x244)]});}else _0x325a13=await warehouse[_0x816289(0x213)]({'status':_0x816289(0x1c0)});const _0x1970fd=await product[_0x816289(0x213)]();let _0x308d94;if(_0x25563d['role']==_0x816289(0x21f)){const _0x6f1b0e=await staff[_0x816289(0x227)]({'email':_0x25563d[_0x816289(0x24e)]});_0x308d94=await adjustment[_0x816289(0x213)]({'warehouse_name':_0x6f1b0e[_0x816289(0x244)]});}else _0x308d94=await adjustment[_0x816289(0x1f3)]([{'$unwind':_0x816289(0x194)},{'$group':{'_id':_0x816289(0x25f),'invoice':{'$first':_0x816289(0x217)},'date':{'$first':_0x816289(0x1ff)},'warehouse_name':{'$first':_0x816289(0x22b)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x207110[0x0]['language']==_0x816289(0x1c7)){var _0x20f3ce=users['English'];console[_0x816289(0x1cd)](_0x20f3ce);}else{if(_0x207110[0x0][_0x816289(0x238)]=='Hindi')var _0x20f3ce=users[_0x816289(0x246)];else{if(_0x207110[0x0][_0x816289(0x238)]==_0x816289(0x1a9))var _0x20f3ce=users['German'];else{if(_0x207110[0x0][_0x816289(0x238)]==_0x816289(0x22f))var _0x20f3ce=users[_0x816289(0x22f)];else{if(_0x207110[0x0][_0x816289(0x238)]==_0x816289(0x1a4))var _0x20f3ce=users[_0x816289(0x1a4)];else{if(_0x207110[0x0][_0x816289(0x238)]==_0x816289(0x24f))var _0x20f3ce=users['Portuguese'];else{if(_0x207110[0x0][_0x816289(0x238)]==_0x816289(0x1fe))var _0x20f3ce=users[_0x816289(0x1fe)];else{if(_0x207110[0x0][_0x816289(0x238)]=='Arabic\x20(ae)')var _0x20f3ce=users[_0x816289(0x21b)];}}}}}}}_0x55d2ad[_0x816289(0x262)](_0x816289(0x19e),{'success':_0x48871b[_0x816289(0x237)](_0x816289(0x211)),'errors':_0x48871b[_0x816289(0x237)](_0x816289(0x22c)),'role':_0x25563d,'profile':_0x28ad0b,'warehouse':_0x325a13,'product':_0x1970fd,'adjustment':_0x308d94,'master_shop':_0x207110,'language':_0x20f3ce});}catch(_0x38a276){console[_0x816289(0x1cd)](_0x38a276);}});function a0_0x2a4e(_0x2ca1ee,_0x543e39){var _0x199723=a0_0x1997();return a0_0x2a4e=function(_0x2a4e47,_0x4abcc4){_0x2a4e47=_0x2a4e47-0x192;var _0x53b796=_0x199723[_0x2a4e47];return _0x53b796;},a0_0x2a4e(_0x2ca1ee,_0x543e39);}async function getRandom8DigitNumber(){var _0xd6fa3d=a0_0x4e4bd7;const _0x355a90=0x989680,_0x4beb9f=0x5f5e0ff,_0x16e16f=Math[_0xd6fa3d(0x1b5)](Math[_0xd6fa3d(0x1b8)]()*(_0x4beb9f-_0x355a90+0x1))+_0x355a90;var _0x467257;const _0x412ce1=await adjustment[_0xd6fa3d(0x227)]({'invoice':_0xd6fa3d(0x219)+_0x16e16f});return _0x412ce1&&_0x412ce1[_0xd6fa3d(0x19a)]>0x0?_0x467257=_0xd6fa3d(0x219)+_0x16e16f:_0x467257='ADJ-'+_0x16e16f,_0x467257;}function a0_0x1997(){var _0x140cf4=['$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','master','</div>','level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','rack','bin','New_Qty_Converted','$product_details.invoice','padStart','$product_details.product_code','get','<html><head><title></title>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','product_details','error','string','_id','Logo.png','aggregate','/../public','id_transaction_from','$product_details.rack','$product_details.type','\x20Order\x20Number\x20:\x20','$product_details.isle','types','New_Qty_Converted_adj','/view/:id','5179960mvvXzZ','Chinese','$date','</head><body>','</tr>','$product.product_name','then','floorlevel','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.product_cat','/barcode_scanner','$product_details.level','An\x20error\x20occurred.','$product_details.bin','621682AXGDSb','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','2308600haVmxP','secondary_unit','$product_details.expiry_date','second1','success','product','find','$product_details.storage','</tbody>','product_stock','$invoice','findById','ADJ-','product_name','Arabic','warehouse_name','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<div>','staff','Floor','../models/all_models','stockBefore','<strong>\x20Regards\x20</strong>','nodemailer','room_names','unit','findOne','$name','$product_details.product_stock','<span\x20style=\x22float:\x20right;\x22>','$warehouse_name','errors','forEach','split','Spanish','invoice','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','back','<h2>\x20','slice','production_date','prod_code','flash','language','<tr>','349846ZirTtr','prime1','sendMail','Primary_Units','/view/add_adjustment','<h5\x20style=\x22text-align:\x20left;\x22>','json','/view','2113149GquQeR','max_per_unit','warehouse','301yGSIKd','Hindi','message','room','True','redirect','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','id_transaction','email','Portuguese\x20(BR)','<hr\x20class=\x22my-3\x22>','Raw\x20Materials','</span>','finalize','site_title','isAllowEdit','Arabic\x20(ae)','$product_details.secondary_code','$product_details.production_date','adjustment\x20Finalized\x20successfully','secondary_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','product_code','prod_cat','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$_id','filter','primary_code','render','map','body','user','$product_details.pallet','new_adjust_qty','$product','all','date','adjust_qty','stock','batch_code','length','edit_adjustment_view','image','Shelves','adjustment','</table>','$product_details.maxPerUnit','Return\x20Rooms','Email\x20sent\x20successfully','$product_details._id','French','Return\x20Goods','Portuguese','expiry_date','post','German','params','maxperunit','prod_invoice','24064MKcsmX','type','$product_details.product_name','$room','$product_details.maxProducts','$product_details.unit','catch','role','floor','port','$product_details.bay','random','/adjustment/view','bay','Level','$product_details.batch_code','note','createTransport','storage','Enabled','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<tbody\x20style=\x22text-align:\x20center;\x22>','Rooms','logo','Secondary_units','English\x20(US)','\x20<>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','password','Router','../public/language/languages.json','log','save','/picking_list/PDF_adjustment_rm/','../middleware/auth','$product_details.primary_code','<!DOCTYPE\x20html>','foreach\x20newproduct','1380636KQnVBn','$product_details','</thead>','\x20Order\x20Date\x20:\x20','Adjustment\x20Mail','edit_adjustment','</td>','<h5>','Enclosed','prod_name','adjustment\x20data\x20update\x20successfully'];a0_0x1997=function(){return _0x140cf4;};return a0_0x1997();}router[a0_0x4e4bd7(0x1eb)](a0_0x4e4bd7(0x23e),auth,async(_0x5a69de,_0x2f1717)=>{var _0x4e7fe4=a0_0x4e4bd7;try{const {username:_0x5bf528,email:_0x32ba4e,role:_0x1f3bb6}=_0x5a69de[_0x4e7fe4(0x265)],_0x21a70a=_0x5a69de[_0x4e7fe4(0x265)],_0x2adf5d=await profile[_0x4e7fe4(0x227)]({'email':_0x21a70a['email']}),_0x4d1926=await master_shop[_0x4e7fe4(0x213)]();let _0x45261d;if(_0x21a70a['role']=='staff'){const _0x52e506=await staff[_0x4e7fe4(0x227)]({'email':_0x21a70a['email']});_0x45261d=await warehouse[_0x4e7fe4(0x1f3)]([{'$match':{'status':_0x4e7fe4(0x1c0),'name':_0x52e506[_0x4e7fe4(0x244)],'warehouse_category':_0x4e7fe4(0x251),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x4e7fe4(0x228),'name':{'$first':_0x4e7fe4(0x228)}}}]);}else _0x45261d=await warehouse[_0x4e7fe4(0x1f3)]([{'$match':{'status':_0x4e7fe4(0x1c0),'warehouse_category':_0x4e7fe4(0x251),'name':{'$ne':_0x4e7fe4(0x1a5)}}},{'$group':{'_id':_0x4e7fe4(0x228),'name':{'$first':_0x4e7fe4(0x228)}}}]);const _0x29edc1=await product['find']({}),_0x3a5b84=await adjustment['find']({}),_0x52af15=_0x3a5b84[_0x4e7fe4(0x19a)]+0x1,_0x48e87e=_0x4e7fe4(0x219)+_0x52af15['toString']()[_0x4e7fe4(0x1e9)](0x5,'0');var _0x3d2f28=['Ambient',_0x4e7fe4(0x1dc),_0x4e7fe4(0x1a1)];if(_0x4d1926[0x0][_0x4e7fe4(0x238)]==_0x4e7fe4(0x1c7))var _0x279f9b=users['English'];else{if(_0x4d1926[0x0][_0x4e7fe4(0x238)]==_0x4e7fe4(0x246))var _0x279f9b=users[_0x4e7fe4(0x246)];else{if(_0x4d1926[0x0]['language']==_0x4e7fe4(0x1a9))var _0x279f9b=users['German'];else{if(_0x4d1926[0x0][_0x4e7fe4(0x238)]==_0x4e7fe4(0x22f))var _0x279f9b=users[_0x4e7fe4(0x22f)];else{if(_0x4d1926[0x0]['language']==_0x4e7fe4(0x1a4))var _0x279f9b=users[_0x4e7fe4(0x1a4)];else{if(_0x4d1926[0x0][_0x4e7fe4(0x238)]=='Portuguese\x20(BR)')var _0x279f9b=users[_0x4e7fe4(0x1a6)];else{if(_0x4d1926[0x0][_0x4e7fe4(0x238)]==_0x4e7fe4(0x1fe))var _0x279f9b=users[_0x4e7fe4(0x1fe)];else{if(_0x4d1926[0x0]['language']==_0x4e7fe4(0x256))var _0x279f9b=users['Arabic'];}}}}}}}const _0x46aa4a=getRandom8DigitNumber();_0x46aa4a[_0x4e7fe4(0x203)](_0x3d29af=>{var _0x369bfa=_0x4e7fe4;_0x2f1717[_0x369bfa(0x262)]('add_adjustment',{'success':_0x5a69de[_0x369bfa(0x237)](_0x369bfa(0x211)),'errors':_0x5a69de['flash'](_0x369bfa(0x22c)),'role':_0x21a70a,'profile':_0x2adf5d,'warehouse':_0x45261d,'product':_0x29edc1,'master_shop':_0x4d1926,'language':_0x279f9b,'rooms_data':_0x3d2f28,'invoice_no':_0x3d29af});})[_0x4e7fe4(0x1b3)](_0x31d242=>{var _0x1b3ba5=_0x4e7fe4;_0x5a69de[_0x1b3ba5(0x237)](_0x1b3ba5(0x22c),_0x1b3ba5(0x205)),_0x2f1717['redirect'](_0x1b3ba5(0x1b9));});}catch(_0x2d947d){console[_0x4e7fe4(0x1cd)](_0x2d947d);}}),router[a0_0x4e4bd7(0x1a8)](a0_0x4e4bd7(0x23e),auth,async(_0x3870d6,_0x116886)=>{var _0x5c1c4f=a0_0x4e4bd7;try{const {warehouse_name:_0x3719d6,date:_0x4fc5e7,prod_name:_0x401be0,level:_0x385c27,isle:_0x4d5f01,pallet:_0x2e472d,stock:_0x4d9df0,types:_0x1cf5c3,adjust_qty:_0x1a6aba,new_adjust_qty:_0x59139a,note:_0x2e8b75,Room_name:_0x33ce5b,invoice:_0xf495ef,JO_number:_0x1fb063,expiry_date:_0x56f89c}=_0x3870d6[_0x5c1c4f(0x264)];if(typeof _0x401be0==_0x5c1c4f(0x1f0))var _0x161a51=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1dd)]],_0x45d732=[_0x3870d6[_0x5c1c4f(0x264)]['level']],_0x1ef652=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x198)]],_0x165685=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1fa)]],_0x2a1949=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1fb)]],_0x2efaea=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1e7)]],_0x19e515=[_0x3870d6[_0x5c1c4f(0x264)]['Primary_Units']],_0x248e10=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1c6)]],_0x53293b=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x236)]],_0x3f334b=[_0x3870d6['body'][_0x5c1c4f(0x199)]],_0x2a1edc=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1a7)]],_0x49387f=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x243)]],_0xef3ddb=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x235)]],_0x1a1dfc=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x25d)]],_0x3ab40c=[_0x3870d6['body'][_0x5c1c4f(0x1c4)]],_0x217de6=[_0x3870d6[_0x5c1c4f(0x264)]['prime1']],_0x1f64a9=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x210)]],_0x134a83=[_0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1ac)]],_0x554ca4=[_0x3870d6['body']['id_transaction']];else var _0x161a51=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1dd)]],_0x45d732=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1e3)]],_0x1ef652=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x198)]],_0x165685=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1fa)]],_0x2a1949=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1fb)]],_0x2efaea=[..._0x3870d6[_0x5c1c4f(0x264)]['New_Qty_Converted']],_0x19e515=[..._0x3870d6[_0x5c1c4f(0x264)]['unit']],_0x248e10=[..._0x3870d6[_0x5c1c4f(0x264)]['Secondary_units']],_0x53293b=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x236)]],_0x3f334b=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x199)]],_0x2a1edc=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x1a7)]],_0x49387f=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x243)]],_0xef3ddb=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x235)]],_0x1a1dfc=[..._0x3870d6[_0x5c1c4f(0x264)]['prod_cat']],_0x3ab40c=[..._0x3870d6['body']['Rooms']],_0x217de6=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x23b)]],_0x1f64a9=[..._0x3870d6['body'][_0x5c1c4f(0x210)]],_0x134a83=[..._0x3870d6[_0x5c1c4f(0x264)]['prod_invoice']],_0x554ca4=[..._0x3870d6[_0x5c1c4f(0x264)][_0x5c1c4f(0x24d)]];const _0xed23f9=_0x161a51[_0x5c1c4f(0x263)](_0x3b27f3=>{return _0x3b27f3={'product_name':_0x3b27f3};});_0x45d732[_0x5c1c4f(0x22d)]((_0x16f84c,_0x39c41b)=>{var _0x1a6ebf=_0x5c1c4f;_0x3ab40c[_0x1a6ebf(0x22d)]((_0x2784c9,_0x3931dc)=>{var _0x3237f8=_0x1a6ebf;if(_0x2784c9=='Receiving\x20Area'&&_0x39c41b==_0x3931dc){var _0x2bc4dd=_0x16f84c[_0x3237f8(0x234)](0x3);_0xed23f9[_0x39c41b][_0x3237f8(0x1bf)]=_0x16f84c[0x0],_0xed23f9[_0x39c41b][_0x3237f8(0x1e5)]=_0x16f84c[0x1],_0xed23f9[_0x39c41b]['bay']=0x0,_0xed23f9[_0x39c41b][_0x3237f8(0x1e6)]=0x0,_0xed23f9[_0x39c41b][_0x3237f8(0x1ae)]=_0x3237f8(0x220),_0xed23f9[_0x39c41b][_0x3237f8(0x204)]=_0x2bc4dd;}else{if(_0x2784c9==_0x3237f8(0x19d)&&_0x39c41b==_0x3931dc){var _0x2bc4dd=_0x16f84c[_0x3237f8(0x234)](0x3);_0xed23f9[_0x39c41b]['storage']=_0x16f84c[0x0],_0xed23f9[_0x39c41b][_0x3237f8(0x1e5)]=_0x16f84c[0x1],_0xed23f9[_0x39c41b][_0x3237f8(0x1ba)]=0x0,_0xed23f9[_0x39c41b][_0x3237f8(0x1e6)]=0x0,_0xed23f9[_0x39c41b][_0x3237f8(0x1ae)]=_0x3237f8(0x220),_0xed23f9[_0x39c41b][_0x3237f8(0x204)]=_0x16f84c[0x5];}else{if(_0x39c41b==_0x3931dc){var _0x5ec907;if(_0x16f84c[0x4]=='L')_0x5ec907=_0x3237f8(0x1bb);else _0x16f84c[0x4]=='F'&&(_0x5ec907=_0x3237f8(0x220));_0xed23f9[_0x39c41b][_0x3237f8(0x1bf)]=_0x16f84c[0x0],_0xed23f9[_0x39c41b][_0x3237f8(0x1e5)]=_0x16f84c[0x1],_0xed23f9[_0x39c41b]['bay']=_0x16f84c[0x2],_0xed23f9[_0x39c41b][_0x3237f8(0x1e6)]=_0x16f84c[0x3],_0xed23f9[_0x39c41b][_0x3237f8(0x1ae)]=_0x5ec907,_0xed23f9[_0x39c41b]['floorlevel']=_0x16f84c[0x5];}}}});}),_0x1ef652[_0x5c1c4f(0x22d)]((_0x154f19,_0x16a049)=>{var _0x4d6c3=_0x5c1c4f;_0xed23f9[_0x16a049][_0x4d6c3(0x222)]=_0x154f19;}),_0x554ca4['forEach']((_0x5d7a40,_0x4e5a90)=>{var _0x59b7c1=_0x5c1c4f;_0xed23f9[_0x4e5a90][_0x59b7c1(0x1f5)]=_0x5d7a40;}),_0x165685['forEach']((_0xc5db46,_0x1ca5c6)=>{var _0xc0441b=_0x5c1c4f;_0xed23f9[_0x1ca5c6][_0xc0441b(0x1fa)]=_0xc5db46;}),_0x2a1949[_0x5c1c4f(0x22d)]((_0x537b40,_0xfad7a0)=>{_0xed23f9[_0xfad7a0]['adjust_qty']=_0x537b40;}),_0x2efaea[_0x5c1c4f(0x22d)]((_0x4179e7,_0x10ca3d)=>{var _0x5297b2=_0x5c1c4f;_0xed23f9[_0x10ca3d][_0x5297b2(0x193)]=_0x4179e7;}),_0x19e515[_0x5c1c4f(0x22d)]((_0x36be8d,_0x2dbc12)=>{var _0x56fd2=_0x5c1c4f;_0xed23f9[_0x2dbc12][_0x56fd2(0x226)]=_0x36be8d;}),_0x248e10[_0x5c1c4f(0x22d)]((_0x4fa6f7,_0x3d5312)=>{var _0x49e4a2=_0x5c1c4f;_0xed23f9[_0x3d5312][_0x49e4a2(0x20e)]=_0x4fa6f7;}),_0x53293b[_0x5c1c4f(0x22d)]((_0x5f474f,_0xa3313a)=>{var _0x545a3d=_0x5c1c4f;_0xed23f9[_0xa3313a][_0x545a3d(0x25c)]=_0x5f474f;}),_0x3f334b[_0x5c1c4f(0x22d)]((_0x413b6b,_0x302776)=>{_0xed23f9[_0x302776]['batch_code']=_0x413b6b;}),_0x2a1edc['forEach']((_0x4653d7,_0x41477d)=>{var _0x589c66=_0x5c1c4f;_0xed23f9[_0x41477d][_0x589c66(0x1a7)]=_0x4653d7;}),_0x49387f[_0x5c1c4f(0x22d)]((_0x4452ce,_0x228591)=>{_0xed23f9[_0x228591]['maxperunit']=_0x4452ce;}),_0xef3ddb[_0x5c1c4f(0x22d)]((_0x4ea824,_0x58611d)=>{var _0x3e0600=_0x5c1c4f;_0xed23f9[_0x58611d][_0x3e0600(0x235)]=_0x4ea824;}),_0x1a1dfc[_0x5c1c4f(0x22d)]((_0x1782cb,_0x12f31b)=>{var _0x5acb4d=_0x5c1c4f;_0xed23f9[_0x12f31b][_0x5acb4d(0x25d)]=_0x1782cb;}),_0x3ab40c[_0x5c1c4f(0x22d)]((_0x1af8dd,_0x465042)=>{var _0x11f46f=_0x5c1c4f;_0xed23f9[_0x465042][_0x11f46f(0x225)]=_0x1af8dd;}),_0x217de6['forEach']((_0x1596cc,_0x2a6b4e)=>{var _0x3e552d=_0x5c1c4f;_0xed23f9[_0x2a6b4e][_0x3e552d(0x261)]=_0x1596cc;}),_0x1f64a9[_0x5c1c4f(0x22d)]((_0x28d99c,_0x49ddc6)=>{var _0x4ca0c0=_0x5c1c4f;_0xed23f9[_0x49ddc6][_0x4ca0c0(0x25a)]=_0x28d99c;}),_0x134a83[_0x5c1c4f(0x22d)]((_0x3d9e82,_0xffc499)=>{var _0x537ac6=_0x5c1c4f;_0xed23f9[_0xffc499][_0x537ac6(0x230)]=_0x3d9e82;});const _0x5af80b=_0xed23f9['filter'](_0xa4abcb=>_0xa4abcb[_0x5c1c4f(0x197)]!=='0'&&_0xa4abcb[_0x5c1c4f(0x197)]!=='');var _0x4eeaac=0x0;_0x5af80b['forEach'](_0x5cef6a=>{var _0x420813=_0x5c1c4f;console[_0x420813(0x1cd)](_0x420813(0x1d3),_0x5cef6a),parseInt(_0x5cef6a[_0x420813(0x197)])<=0x0&&_0x4eeaac++;});if(_0x4eeaac!=0x0)return _0x3870d6[_0x5c1c4f(0x237)](_0x5c1c4f(0x22c),_0x5c1c4f(0x231)),_0x116886[_0x5c1c4f(0x24a)]('back');const _0x12cb6a=new adjustment({'warehouse_name':_0x3719d6,'date':_0x4fc5e7,'product':_0x5af80b,'note':_0x2e8b75,'room':_0x33ce5b,'invoice':_0xf495ef,'JO_number':_0x1fb063,'expiry_date':_0x56f89c}),_0x238322=await _0x12cb6a[_0x5c1c4f(0x1ce)]();_0x3870d6[_0x5c1c4f(0x237)](_0x5c1c4f(0x211),'adjustment\x20add\x20successfull'),_0x116886[_0x5c1c4f(0x24a)]('/adjustment/preview/'+_0x238322[_0x5c1c4f(0x1f1)]);}catch(_0x3d9033){console[_0x5c1c4f(0x1cd)](_0x3d9033),_0x116886[_0x5c1c4f(0x24b)](0xc8)['json']({'message':_0x3d9033[_0x5c1c4f(0x247)]});}}),router[a0_0x4e4bd7(0x1eb)]('/preview/:id',auth,async(_0x5c7271,_0x40b696)=>{var _0x17117e=a0_0x4e4bd7;try{const {username:_0x30f487,email:_0x3c4faf,role:_0xd5e8d}=_0x5c7271[_0x17117e(0x265)],_0x33e375=_0x5c7271[_0x17117e(0x265)],_0x4e1d29=await profile['findOne']({'email':_0x33e375['email']}),_0x31eb2c=await master_shop[_0x17117e(0x213)](),_0x54e3d1=_0x5c7271[_0x17117e(0x1aa)]['id'],_0x5bc01d=await adjustment[_0x17117e(0x218)]({'_id':_0x54e3d1}),_0x3f5529=await purchases[_0x17117e(0x1f3)]([{'$match':{'warehouse_name':_0x5bc01d[_0x17117e(0x21c)]}},{'$unwind':_0x17117e(0x194)},{'$group':{'_id':_0x17117e(0x202)}}]),_0x375ce6=await product[_0x17117e(0x213)]({}),_0x3423a5=await warehouse[_0x17117e(0x1f3)]([{'$match':{'name':_0x5bc01d[_0x17117e(0x21c)]}},{'$unwind':_0x17117e(0x1d5)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x17117e(0x1b7)},'bin':{'$first':_0x17117e(0x20a)},'type':{'$first':_0x17117e(0x1f7)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x17117e(0x1d1)},'secondary_code':{'$first':_0x17117e(0x257)},'product_code':{'$first':_0x17117e(0x1ea)},'storage':{'$first':_0x17117e(0x214)},'rack':{'$first':_0x17117e(0x1f6)},'maxPerUnit':{'$first':_0x17117e(0x1a0)},'expiry_date':{'$first':_0x17117e(0x20f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x17117e(0x1bc)},'room':{'$first':_0x17117e(0x1b0)}}}]);if(_0x31eb2c[0x0]['language']==_0x17117e(0x1c7)){var _0x3a3633=users[_0x17117e(0x1c1)];console[_0x17117e(0x1cd)](_0x3a3633);}else{if(_0x31eb2c[0x0][_0x17117e(0x238)]==_0x17117e(0x246))var _0x3a3633=users[_0x17117e(0x246)];else{if(_0x31eb2c[0x0]['language']==_0x17117e(0x1a9))var _0x3a3633=users[_0x17117e(0x1a9)];else{if(_0x31eb2c[0x0][_0x17117e(0x238)]==_0x17117e(0x22f))var _0x3a3633=users[_0x17117e(0x22f)];else{if(_0x31eb2c[0x0]['language']=='French')var _0x3a3633=users[_0x17117e(0x1a4)];else{if(_0x31eb2c[0x0][_0x17117e(0x238)]=='Portuguese\x20(BR)')var _0x3a3633=users[_0x17117e(0x1a6)];else{if(_0x31eb2c[0x0][_0x17117e(0x238)]==_0x17117e(0x1fe))var _0x3a3633=users['Chinese'];else{if(_0x31eb2c[0x0]['language']==_0x17117e(0x256))var _0x3a3633=users[_0x17117e(0x21b)];}}}}}}}_0x40b696[_0x17117e(0x262)](_0x17117e(0x19b),{'success':_0x5c7271[_0x17117e(0x237)]('success'),'errors':_0x5c7271[_0x17117e(0x237)]('errors'),'role':_0x33e375,'profile':_0x4e1d29,'adjustment':_0x5bc01d,'stock':_0x3423a5,'master_shop':_0x31eb2c,'warehouse_name':_0x3f5529,'unit':_0x375ce6,'language':_0x3a3633});}catch(_0x78617c){console[_0x17117e(0x1cd)](_0x78617c),_0x40b696[_0x17117e(0x24b)](0xc8)[_0x17117e(0x240)]({'message':_0x78617c[_0x17117e(0x247)]});}}),router[a0_0x4e4bd7(0x1a8)]('/preview/:id',auth,async(_0x5bb4bf,_0x15a321)=>{var _0x1d05dd=a0_0x4e4bd7;try{const _0x162447=_0x5bb4bf[_0x1d05dd(0x1aa)]['id'],{warehouse_name:_0x386731,Room_name:_0x56f8ad}=_0x5bb4bf[_0x1d05dd(0x264)],_0x2b8dd7=await adjustment['findById']({'_id':_0x162447}),_0x480adb=_0x2b8dd7[_0x1d05dd(0x212)][_0x1d05dd(0x263)](async _0x5a9d6d=>{var _0x23e4f8=_0x1d05dd;if(_0x5a9d6d[_0x23e4f8(0x197)]>0x0){var _0xc3e5a9=await warehouse[_0x23e4f8(0x227)]({'name':_0x386731,'room':_0x5a9d6d[_0x23e4f8(0x225)],'warehouse_category':_0x23e4f8(0x251)});const _0x202345=_0xc3e5a9[_0x23e4f8(0x1ee)][_0x23e4f8(0x263)](_0x384235=>{var _0x38491b=_0x23e4f8;console['log'](_0x5a9d6d[_0x38491b(0x1fa)]+_0x38491b(0x1c8));if(_0x5a9d6d[_0x38491b(0x1fa)]=='minus'){if(_0x384235[_0x38491b(0x21a)]==_0x5a9d6d[_0x38491b(0x21a)]&&_0x384235[_0x38491b(0x204)]==_0x5a9d6d[_0x38491b(0x204)]&&_0x384235['type']==_0x5a9d6d[_0x38491b(0x1ae)]&&_0x384235[_0x38491b(0x1e6)]==_0x5a9d6d[_0x38491b(0x1e6)]&&_0x384235[_0x38491b(0x1ba)]==_0x5a9d6d[_0x38491b(0x1ba)]&&_0x384235[_0x38491b(0x1e5)]==_0x5a9d6d[_0x38491b(0x1e5)]&&_0x384235['storage']==_0x5a9d6d[_0x38491b(0x1bf)]&&_0x384235['expiry_date']==_0x5a9d6d[_0x38491b(0x1a7)]&&_0x384235[_0x38491b(0x199)]==_0x5a9d6d['batch_code']&&_0x384235[_0x38491b(0x235)]==_0x5a9d6d[_0x38491b(0x235)]&&_0x384235[_0x38491b(0x230)]==_0x5a9d6d[_0x38491b(0x230)]&&_0x384235[_0x38491b(0x1f1)]==_0x5a9d6d[_0x38491b(0x1f5)]){var _0xf3fa03;_0xf3fa03=_0x5a9d6d[_0x38491b(0x197)],_0x5a9d6d['prod_cat']=='S'&&(_0xf3fa03=_0x5a9d6d[_0x38491b(0x197)]),_0x384235[_0x38491b(0x216)]=_0x384235[_0x38491b(0x216)]-_0xf3fa03;}}else{if(_0x384235['product_name']==_0x5a9d6d[_0x38491b(0x21a)]&&_0x384235[_0x38491b(0x204)]==_0x5a9d6d[_0x38491b(0x204)]&&_0x384235[_0x38491b(0x1ae)]==_0x5a9d6d['type']&&_0x384235[_0x38491b(0x1e6)]==_0x5a9d6d[_0x38491b(0x1e6)]&&_0x384235[_0x38491b(0x1ba)]==_0x5a9d6d[_0x38491b(0x1ba)]&&_0x384235[_0x38491b(0x1e5)]==_0x5a9d6d[_0x38491b(0x1e5)]&&_0x384235[_0x38491b(0x1bf)]==_0x5a9d6d[_0x38491b(0x1bf)]&&_0x384235[_0x38491b(0x1a7)]==_0x5a9d6d[_0x38491b(0x1a7)]&&_0x384235['batch_code']==_0x5a9d6d['batch_code']&&_0x384235[_0x38491b(0x235)]==_0x5a9d6d[_0x38491b(0x235)]&&_0x384235[_0x38491b(0x230)]==_0x5a9d6d[_0x38491b(0x230)]&&_0x384235[_0x38491b(0x1f1)]==_0x5a9d6d[_0x38491b(0x1f5)]){console[_0x38491b(0x1cd)](_0x5a9d6d);var _0xf3fa03;_0xf3fa03=_0x5a9d6d[_0x38491b(0x197)],_0x5a9d6d['prod_cat']=='S'&&(_0xf3fa03=_0x5a9d6d[_0x38491b(0x197)]),_0x384235[_0x38491b(0x216)]=_0x384235[_0x38491b(0x216)]+_0xf3fa03;}}});}return _0xc3e5a9;});Promise[_0x1d05dd(0x195)](_0x480adb)[_0x1d05dd(0x203)](async _0x5c6c33=>{var _0x4aee6d=_0x1d05dd;try{for(const _0x1dd92d of _0x5c6c33){await _0x1dd92d[_0x4aee6d(0x1ce)]();}_0x2b8dd7[_0x4aee6d(0x253)]=_0x4aee6d(0x249);const _0x339d3e=await _0x2b8dd7[_0x4aee6d(0x1ce)](),_0x5f378a=await master_shop[_0x4aee6d(0x213)](),_0x59d4cf=await email_settings[_0x4aee6d(0x227)](),_0x10648a=await supervisor_settings[_0x4aee6d(0x213)]();var _0x2a74be=_0x2b8dd7['product'],_0x76a2d9='',_0x2c02bb;for(_0x2c02bb in _0x2a74be){_0x76a2d9+='<tr>'+_0x4aee6d(0x21d)+_0x2a74be[_0x2c02bb][_0x4aee6d(0x21a)]+_0x4aee6d(0x1da)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2a74be[_0x2c02bb]['product_code']+_0x4aee6d(0x1da)+_0x4aee6d(0x21d)+_0x2a74be[_0x2c02bb][_0x4aee6d(0x197)]+_0x4aee6d(0x1da)+_0x4aee6d(0x21d)+_0x2a74be[_0x2c02bb][_0x4aee6d(0x226)]+_0x4aee6d(0x1da)+_0x4aee6d(0x21d)+_0x2a74be[_0x2c02bb][_0x4aee6d(0x20e)]+'</td>'+_0x4aee6d(0x21d)+_0x2b8dd7['warehouse_name']+_0x4aee6d(0x1da)+_0x4aee6d(0x21d)+_0x2a74be[_0x2c02bb][_0x4aee6d(0x225)]+_0x4aee6d(0x1da)+_0x4aee6d(0x21d)+_0x2a74be[_0x2c02bb][_0x4aee6d(0x1bf)]+_0x2a74be[_0x2c02bb][_0x4aee6d(0x1e5)]+_0x2a74be[_0x2c02bb]['bay']+_0x2a74be[_0x2c02bb][_0x4aee6d(0x1e6)]+_0x2a74be[_0x2c02bb]['type'][0x0]+_0x2a74be[_0x2c02bb]['floorlevel']+_0x4aee6d(0x1da),_0x4aee6d(0x201);}let _0x4bcfe3=nodemailer[_0x4aee6d(0x1be)]({'host':_0x59d4cf['host'],'port':Number(_0x59d4cf[_0x4aee6d(0x1b6)]),'secure':![],'auth':{'user':_0x59d4cf[_0x4aee6d(0x24e)],'pass':_0x59d4cf[_0x4aee6d(0x1ca)]}}),_0xbd7ea3={'from':_0x59d4cf[_0x4aee6d(0x24e)],'to':_0x10648a[0x0]['RMSEmail'],'subject':_0x4aee6d(0x1d8),'attachments':[{'filename':_0x4aee6d(0x1f2),'path':__dirname+_0x4aee6d(0x1f4)+'/upload/'+_0x5f378a[0x0][_0x4aee6d(0x19c)],'cid':_0x4aee6d(0x1c5)}],'html':_0x4aee6d(0x1d2)+_0x4aee6d(0x1ec)+_0x4aee6d(0x200)+_0x4aee6d(0x21e)+_0x4aee6d(0x25e)+_0x4aee6d(0x21e)+_0x4aee6d(0x25b)+_0x4aee6d(0x1e2)+'<div>'+_0x4aee6d(0x233)+_0x5f378a[0x0][_0x4aee6d(0x254)]+'\x20</h2>'+_0x4aee6d(0x1e2)+_0x4aee6d(0x1e2)+_0x4aee6d(0x250)+_0x4aee6d(0x21e)+_0x4aee6d(0x23f)+_0x4aee6d(0x1f8)+_0x2b8dd7[_0x4aee6d(0x230)]+'\x20'+_0x4aee6d(0x22a)+_0x4aee6d(0x1d7)+_0x2b8dd7[_0x4aee6d(0x196)]+'\x20'+_0x4aee6d(0x252)+'</h5>'+_0x4aee6d(0x1e2)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4aee6d(0x1ed)+_0x4aee6d(0x239)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x4aee6d(0x1c2)+_0x4aee6d(0x24c)+_0x4aee6d(0x1c9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x4aee6d(0x1e4)+_0x4aee6d(0x20c)+_0x4aee6d(0x1e0)+'</tr>'+_0x4aee6d(0x1d6)+_0x4aee6d(0x1c3)+'\x20'+_0x76a2d9+'\x20'+_0x4aee6d(0x215)+_0x4aee6d(0x19f)+_0x4aee6d(0x21e)+_0x4aee6d(0x223)+_0x4aee6d(0x1db)+_0x5f378a[0x0][_0x4aee6d(0x254)]+'</h5>'+'</div>'+_0x4aee6d(0x1e2)+'</body></html>'};_0x4bcfe3[_0x4aee6d(0x23c)](_0xbd7ea3,function(_0x54ade0,_0x32ade8){var _0x4991b3=_0x4aee6d;_0x54ade0?(console[_0x4991b3(0x1cd)](_0x54ade0),console[_0x4991b3(0x1cd)]('Error\x20Occurs')):console[_0x4991b3(0x1cd)](_0x4991b3(0x1a2));}),_0x5bb4bf[_0x4aee6d(0x237)](_0x4aee6d(0x211),_0x4aee6d(0x259)),_0x15a321[_0x4aee6d(0x24a)](_0x4aee6d(0x1cf)+_0x339d3e[_0x4aee6d(0x1f1)]);}catch(_0x460692){console[_0x4aee6d(0x1ef)](_0x460692),_0x15a321[_0x4aee6d(0x24b)](0x1f4)[_0x4aee6d(0x240)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x1d05dd(0x1b3)](_0x215657=>{var _0x146ac1=_0x1d05dd;console[_0x146ac1(0x1ef)](_0x215657),_0x15a321[_0x146ac1(0x24b)](0x1f4)['json']({'error':_0x146ac1(0x209)});});}catch(_0x355504){console[_0x1d05dd(0x1cd)](_0x355504),_0x15a321[_0x1d05dd(0x24b)](0xc8)[_0x1d05dd(0x240)]({'message':_0x355504[_0x1d05dd(0x247)]});}}),router['get'](a0_0x4e4bd7(0x1fc),auth,async(_0x1efb7a,_0x4b48da)=>{var _0x2fb2d3=a0_0x4e4bd7;try{const {username:_0x39a035,email:_0x12cb9e,role:_0x4b56c6}=_0x1efb7a[_0x2fb2d3(0x265)],_0x118432=_0x1efb7a[_0x2fb2d3(0x265)],_0x19dbcb=await profile[_0x2fb2d3(0x227)]({'email':_0x118432[_0x2fb2d3(0x24e)]}),_0x25f580=await master_shop['find'](),_0x3024f7=_0x1efb7a[_0x2fb2d3(0x1aa)]['id'],_0x46810b=await adjustment['findById']({'_id':_0x3024f7}),_0x5ce187=await purchases['aggregate']([{'$match':{'warehouse_name':_0x46810b[_0x2fb2d3(0x21c)]}},{'$unwind':_0x2fb2d3(0x194)},{'$group':{'_id':'$product.product_name'}}]),_0x329395=await product[_0x2fb2d3(0x213)]({}),_0x14fdba=await warehouse[_0x2fb2d3(0x1f3)]([{'$match':{'name':_0x46810b[_0x2fb2d3(0x21c)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2fb2d3(0x229)},'bay':{'$first':_0x2fb2d3(0x1b7)},'bin':{'$first':_0x2fb2d3(0x20a)},'type':{'$first':_0x2fb2d3(0x1f7)},'floorlevel':{'$first':_0x2fb2d3(0x1df)},'primary_code':{'$first':_0x2fb2d3(0x1d1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2fb2d3(0x1ea)},'storage':{'$first':_0x2fb2d3(0x214)},'rack':{'$first':_0x2fb2d3(0x1f6)},'maxPerUnit':{'$first':_0x2fb2d3(0x1a0)},'expiry_date':{'$first':_0x2fb2d3(0x20f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x2fb2d3(0x1b0)}}}]);let _0x1fd463;if(_0x118432[_0x2fb2d3(0x1b4)]=='staff'){const _0x1d8a0e=await staff['findOne']({'email':_0x118432[_0x2fb2d3(0x24e)]});_0x1fd463=await warehouse['aggregate']([{'$match':{'status':_0x2fb2d3(0x1c0),'name':_0x1d8a0e[_0x2fb2d3(0x244)],'warehouse_category':_0x2fb2d3(0x251),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x2fb2d3(0x228),'name':{'$first':_0x2fb2d3(0x228)}}}]);}else _0x1fd463=await warehouse['aggregate']([{'$match':{'status':_0x2fb2d3(0x1c0),'warehouse_category':_0x2fb2d3(0x251),'name':{'$ne':_0x2fb2d3(0x1a5)}}},{'$group':{'_id':_0x2fb2d3(0x228),'name':{'$first':_0x2fb2d3(0x228)}}}]);if(_0x25f580[0x0][_0x2fb2d3(0x238)]=='English\x20(US)'){var _0x58dcf0=users[_0x2fb2d3(0x1c1)];console[_0x2fb2d3(0x1cd)](_0x58dcf0);}else{if(_0x25f580[0x0][_0x2fb2d3(0x238)]==_0x2fb2d3(0x246))var _0x58dcf0=users[_0x2fb2d3(0x246)];else{if(_0x25f580[0x0][_0x2fb2d3(0x238)]==_0x2fb2d3(0x1a9))var _0x58dcf0=users[_0x2fb2d3(0x1a9)];else{if(_0x25f580[0x0][_0x2fb2d3(0x238)]=='Spanish')var _0x58dcf0=users[_0x2fb2d3(0x22f)];else{if(_0x25f580[0x0][_0x2fb2d3(0x238)]=='French')var _0x58dcf0=users[_0x2fb2d3(0x1a4)];else{if(_0x25f580[0x0][_0x2fb2d3(0x238)]==_0x2fb2d3(0x24f))var _0x58dcf0=users[_0x2fb2d3(0x1a6)];else{if(_0x25f580[0x0][_0x2fb2d3(0x238)]=='Chinese')var _0x58dcf0=users[_0x2fb2d3(0x1fe)];else{if(_0x25f580[0x0][_0x2fb2d3(0x238)]==_0x2fb2d3(0x256))var _0x58dcf0=users[_0x2fb2d3(0x21b)];}}}}}}}_0x4b48da[_0x2fb2d3(0x262)](_0x2fb2d3(0x1d9),{'success':_0x1efb7a[_0x2fb2d3(0x237)](_0x2fb2d3(0x211)),'errors':_0x1efb7a[_0x2fb2d3(0x237)](_0x2fb2d3(0x22c)),'role':_0x118432,'profile':_0x19dbcb,'adjustment':_0x46810b,'stock':_0x14fdba,'master_shop':_0x25f580,'warehouse_name':_0x5ce187,'unit':_0x329395,'language':_0x58dcf0,'warehouse':_0x1fd463});}catch(_0x2d2990){console[_0x2fb2d3(0x1cd)](_0x2d2990),_0x4b48da[_0x2fb2d3(0x24b)](0xc8)[_0x2fb2d3(0x240)]({'message':_0x2d2990[_0x2fb2d3(0x247)]});}}),router[a0_0x4e4bd7(0x1a8)](a0_0x4e4bd7(0x1fc),auth,async(_0x7e4c11,_0x1815e6)=>{var _0x19f192=a0_0x4e4bd7;try{const _0xdf8fa=_0x7e4c11[_0x19f192(0x1aa)]['id'],_0x2d07a9=await adjustment[_0x19f192(0x218)]({'_id':_0xdf8fa}),_0x177664=await warehouse[_0x19f192(0x227)]({'name':_0x2d07a9[_0x19f192(0x21c)],'room':_0x2d07a9[_0x19f192(0x248)]}),{warehouse_name:_0x5b6c21,date:_0x33bd4e,prod_name:_0x2b29c6,level:_0x5c435c,isle:_0x2d946e,pallet:_0x3a1e36,stock:_0x5469f8,types:_0x478b00,adjust_qty:_0x477733,new_adjust_qty:_0x2c7003,note:_0x5f5a91,Room_name:_0x36523a,invoice:_0x4f1279,JO_number:_0x4e5fb4,expiry_date:_0x48b336}=_0x7e4c11[_0x19f192(0x264)];if(typeof _0x2b29c6==_0x19f192(0x1f0))var _0x71c04d=[_0x7e4c11['body'][_0x19f192(0x1dd)]],_0x4feb3c=[_0x7e4c11[_0x19f192(0x264)]['level']],_0x22a016=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x198)]],_0x29a00f=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1fa)]],_0x33451c=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1fb)]],_0x665c07=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1e7)]],_0x2425b2=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x23d)]],_0x317f1d=[_0x7e4c11[_0x19f192(0x264)]['Secondary_units']],_0xc1abef=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x236)]],_0x29a78e=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x199)]],_0x71d15=[_0x7e4c11['body'][_0x19f192(0x1a7)]],_0x50c481=[_0x7e4c11['body'][_0x19f192(0x243)]],_0x44c8b8=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x235)]],_0x38dcd7=[_0x7e4c11[_0x19f192(0x264)]['prod_cat']],_0x36c9bd=[_0x7e4c11['body'][_0x19f192(0x1c4)]],_0x232d64=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x23b)]],_0x7caf87=[_0x7e4c11[_0x19f192(0x264)][_0x19f192(0x210)]];else var _0x71c04d=[..._0x7e4c11[_0x19f192(0x264)]['prod_name']],_0x4feb3c=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1e3)]],_0x22a016=[..._0x7e4c11[_0x19f192(0x264)]['stock']],_0x29a00f=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1fa)]],_0x33451c=[..._0x7e4c11[_0x19f192(0x264)]['New_Qty_Converted_adj']],_0x665c07=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1e7)]],_0x2425b2=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x226)]],_0x317f1d=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1c6)]],_0xc1abef=[..._0x7e4c11['body']['prod_code']],_0x29a78e=[..._0x7e4c11[_0x19f192(0x264)]['batch_code']],_0x71d15=[..._0x7e4c11['body'][_0x19f192(0x1a7)]],_0x50c481=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x243)]],_0x44c8b8=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x235)]],_0x38dcd7=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x25d)]],_0x36c9bd=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x1c4)]],_0x232d64=[..._0x7e4c11[_0x19f192(0x264)][_0x19f192(0x23b)]],_0x7caf87=[..._0x7e4c11[_0x19f192(0x264)]['second1']];const _0x110fe7=_0x71c04d[_0x19f192(0x263)](_0x28af8a=>{return _0x28af8a={'product_name':_0x28af8a};});_0x4feb3c['forEach']((_0x66d37,_0x5b6070)=>{var _0x574eeb=_0x19f192;_0x36c9bd[_0x574eeb(0x22d)]((_0x5726c9,_0x5ef022)=>{var _0x18e34d=_0x574eeb;if(_0x5726c9=='Receiving\x20Area'&&_0x5b6070==_0x5ef022){var _0xd44714=_0x66d37[_0x18e34d(0x234)](0x3);_0x110fe7[_0x5b6070][_0x18e34d(0x1bf)]=_0x66d37[0x0],_0x110fe7[_0x5b6070][_0x18e34d(0x1e5)]=_0x66d37[0x1],_0x110fe7[_0x5b6070][_0x18e34d(0x1ba)]=0x0,_0x110fe7[_0x5b6070][_0x18e34d(0x1e6)]=0x0,_0x110fe7[_0x5b6070][_0x18e34d(0x1ae)]=_0x18e34d(0x220),_0x110fe7[_0x5b6070]['floorlevel']=_0xd44714;}else{if(_0x5726c9==_0x18e34d(0x19d)&&_0x5b6070==_0x5ef022){var _0xd44714=_0x66d37[_0x18e34d(0x234)](0x3);_0x110fe7[_0x5b6070]['storage']=_0x66d37[0x0],_0x110fe7[_0x5b6070][_0x18e34d(0x1e5)]=_0x66d37[0x1],_0x110fe7[_0x5b6070][_0x18e34d(0x1ba)]=0x0,_0x110fe7[_0x5b6070][_0x18e34d(0x1e6)]=0x0,_0x110fe7[_0x5b6070][_0x18e34d(0x1ae)]='Floor',_0x110fe7[_0x5b6070]['floorlevel']=_0x66d37[0x5];}else{if(_0x5b6070==_0x5ef022){var _0x1e104d;if(_0x66d37[0x4]=='L')_0x1e104d=_0x18e34d(0x1bb);else _0x66d37[0x4]=='F'&&(_0x1e104d=_0x18e34d(0x220));_0x110fe7[_0x5b6070][_0x18e34d(0x1bf)]=_0x66d37[0x0],_0x110fe7[_0x5b6070][_0x18e34d(0x1e5)]=_0x66d37[0x1],_0x110fe7[_0x5b6070][_0x18e34d(0x1ba)]=_0x66d37[0x2],_0x110fe7[_0x5b6070][_0x18e34d(0x1e6)]=_0x66d37[0x3],_0x110fe7[_0x5b6070][_0x18e34d(0x1ae)]=_0x1e104d,_0x110fe7[_0x5b6070][_0x18e34d(0x204)]=_0x66d37[0x5];}}}});}),_0x22a016['forEach']((_0x24e871,_0x35c79c)=>{var _0x43d3de=_0x19f192;_0x110fe7[_0x35c79c][_0x43d3de(0x222)]=_0x24e871;}),_0x29a00f[_0x19f192(0x22d)]((_0x574795,_0x537bb3)=>{_0x110fe7[_0x537bb3]['types']=_0x574795;}),_0x33451c[_0x19f192(0x22d)]((_0x4c64f5,_0x361358)=>{var _0x5d63e9=_0x19f192;_0x110fe7[_0x361358][_0x5d63e9(0x197)]=_0x4c64f5;}),_0x665c07[_0x19f192(0x22d)]((_0xc8836d,_0x3cec36)=>{_0x110fe7[_0x3cec36]['new_adjust_qty']=_0xc8836d;}),_0x2425b2[_0x19f192(0x22d)]((_0x5891f2,_0x2a961d)=>{_0x110fe7[_0x2a961d]['unit']=_0x5891f2;}),_0x317f1d[_0x19f192(0x22d)]((_0x590272,_0x276956)=>{var _0x489c14=_0x19f192;_0x110fe7[_0x276956][_0x489c14(0x20e)]=_0x590272;}),_0xc1abef[_0x19f192(0x22d)]((_0x4f3b8e,_0x18bb19)=>{_0x110fe7[_0x18bb19]['product_code']=_0x4f3b8e;}),_0x29a78e['forEach']((_0xb1ad3f,_0x4b94e6)=>{var _0xc9d7ca=_0x19f192;_0x110fe7[_0x4b94e6][_0xc9d7ca(0x199)]=_0xb1ad3f;}),_0x71d15[_0x19f192(0x22d)]((_0x321bf3,_0x4bbcb8)=>{_0x110fe7[_0x4bbcb8]['expiry_date']=_0x321bf3;}),_0x50c481[_0x19f192(0x22d)]((_0x59a01a,_0x229353)=>{var _0x3f984d=_0x19f192;_0x110fe7[_0x229353][_0x3f984d(0x1ab)]=_0x59a01a;}),_0x44c8b8[_0x19f192(0x22d)]((_0xc44d6d,_0x2a7d67)=>{_0x110fe7[_0x2a7d67]['production_date']=_0xc44d6d;}),_0x38dcd7[_0x19f192(0x22d)]((_0xaa442b,_0x236a45)=>{var _0x2632fc=_0x19f192;_0x110fe7[_0x236a45][_0x2632fc(0x25d)]=_0xaa442b;}),_0x36c9bd[_0x19f192(0x22d)]((_0xae8322,_0xdbed9d)=>{var _0x4853d2=_0x19f192;_0x110fe7[_0xdbed9d][_0x4853d2(0x225)]=_0xae8322;}),_0x232d64[_0x19f192(0x22d)]((_0x3d4dbd,_0x2112b4)=>{_0x110fe7[_0x2112b4]['primary_code']=_0x3d4dbd;}),_0x7caf87[_0x19f192(0x22d)]((_0x1a9e6b,_0x359a43)=>{_0x110fe7[_0x359a43]['secondary_code']=_0x1a9e6b;});const _0x3c901e=_0x110fe7[_0x19f192(0x260)](_0x4524d7=>_0x4524d7[_0x19f192(0x197)]!=='0'&&_0x4524d7[_0x19f192(0x197)]!=='');var _0x2272de=0x0;_0x3c901e[_0x19f192(0x22d)](_0x22ac28=>{var _0x394b67=_0x19f192;console['log'](_0x394b67(0x1d3),_0x22ac28),parseInt(_0x22ac28['adjust_qty'])<=0x0&&_0x2272de++;});if(_0x2272de!=0x0)return _0x7e4c11[_0x19f192(0x237)](_0x19f192(0x22c),_0x19f192(0x231)),_0x1815e6[_0x19f192(0x24a)](_0x19f192(0x232));_0x2d07a9['warehouse_name']=_0x5b6c21,_0x2d07a9[_0x19f192(0x196)]=_0x33bd4e,_0x2d07a9[_0x19f192(0x212)]=_0x3c901e,_0x2d07a9[_0x19f192(0x1bd)]=_0x5f5a91,_0x2d07a9['invoice']=_0x4f1279,_0x2d07a9[_0x19f192(0x255)]='False';const _0x2c2128=await _0x2d07a9['save']();_0x7e4c11[_0x19f192(0x237)](_0x19f192(0x211),_0x19f192(0x1de)),_0x1815e6[_0x19f192(0x24a)](_0x19f192(0x1b9));}catch(_0x385732){console['log'](_0x385732);}}),router[a0_0x4e4bd7(0x1a8)](a0_0x4e4bd7(0x207),async(_0x5ee223,_0x34be33)=>{var _0x4e7a83=a0_0x4e4bd7;const {primary_code:_0x4f5a5c,warehouse_data:_0x4b4819,rooms_data:_0x3f9ebb,Roomslist:_0x2895c8}=_0x5ee223[_0x4e7a83(0x264)],_0x184437=_0x2895c8[_0x4e7a83(0x22e)](','),_0x3d88d3=[];async function _0xf5d2c2(_0x42451e){var _0x3746c7=_0x4e7a83;const _0x4008a5=await warehouse[_0x3746c7(0x1f3)]([{'$match':{'name':_0x4b4819,'room':_0x42451e}},{'$unwind':_0x3746c7(0x1d5)},{'$match':{'product_details.primary_code':_0x4f5a5c}},{'$group':{'_id':_0x3746c7(0x1a3),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3746c7(0x229)},'primary_code':{'$first':_0x3746c7(0x1d1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3746c7(0x1ea)},'level':{'$first':_0x3746c7(0x1b7)},'isle':{'$first':_0x3746c7(0x20a)},'type':{'$first':_0x3746c7(0x1f7)},'pallet':{'$first':_0x3746c7(0x1df)},'unit':{'$first':_0x3746c7(0x1b2)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3746c7(0x214)},'rack':{'$first':_0x3746c7(0x1f6)},'expiry_date':{'$first':_0x3746c7(0x20f)},'production_date':{'$first':_0x3746c7(0x258)},'maxPerUnit':{'$first':_0x3746c7(0x1a0)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3746c7(0x206)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3746c7(0x1b0)},'invoice':{'$first':_0x3746c7(0x1e8)}}}]),_0x26f9cd=await warehouse[_0x3746c7(0x1f3)]([{'$match':{'name':_0x4b4819,'room':_0x42451e}},{'$unwind':_0x3746c7(0x1d5)},{'$match':{'product_details.secondary_code':_0x4f5a5c}},{'$group':{'_id':_0x3746c7(0x1a3),'name':{'$first':_0x3746c7(0x1af)},'product_stock':{'$first':_0x3746c7(0x229)},'primary_code':{'$first':_0x3746c7(0x1d1)},'secondary_code':{'$first':_0x3746c7(0x257)},'product_code':{'$first':_0x3746c7(0x1ea)},'level':{'$first':_0x3746c7(0x1b7)},'isle':{'$first':_0x3746c7(0x20a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3746c7(0x1b2)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3746c7(0x214)},'rack':{'$first':_0x3746c7(0x1f6)},'expiry_date':{'$first':_0x3746c7(0x20f)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x3746c7(0x1a0)},'batch_code':{'$first':_0x3746c7(0x1bc)},'product_cat':{'$first':_0x3746c7(0x206)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3746c7(0x1b0)}}}]);if(_0x4008a5['length']>0x0)_0x3d88d3['push'](_0x4008a5);else _0x26f9cd[_0x3746c7(0x19a)]>0x0&&_0x3d88d3['push'](_0x26f9cd);}const _0x1f5b05=_0x184437[_0x4e7a83(0x263)](_0x255edd=>_0xf5d2c2(_0x255edd));await Promise[_0x4e7a83(0x195)](_0x1f5b05),_0x34be33[_0x4e7a83(0x240)](_0x3d88d3);}),router[a0_0x4e4bd7(0x1a8)]('/CheckingWarehouse',async(_0x58ccaa,_0x1b57a0)=>{var _0x1d1d01=a0_0x4e4bd7;const {primaryCode:_0x527240,secondaryCode:_0x379a22,productCode:_0x22a738,level:_0x3a0f8d,isle:_0x86ed8f,pallet:_0x2b674f,warehouses:_0x43a4f8,room:_0x4dc565}=_0x58ccaa[_0x1d1d01(0x264)];try{const _0x2b61e6=await warehouse[_0x1d1d01(0x1f3)]([{'$match':{'name':_0x43a4f8,'room':_0x4dc565}},{'$unwind':_0x1d1d01(0x1d5)},{'$match':{'product_details.level':parseInt(_0x3a0f8d),'product_details.isle':_0x86ed8f,'product_details.pallet':parseInt(_0x2b674f)}},{'$group':{'_id':_0x1d1d01(0x1a3),'name':{'$first':_0x1d1d01(0x1af)},'product_stock':{'$first':_0x1d1d01(0x229)},'level':{'$first':_0x1d1d01(0x208)},'isle':{'$first':_0x1d1d01(0x1f9)},'pallet':{'$first':_0x1d1d01(0x192)},'maxProducts':{'$first':_0x1d1d01(0x1b1)}}}]);_0x1b57a0[_0x1d1d01(0x24b)](0xc8)[_0x1d1d01(0x240)](_0x2b61e6);}catch(_0x5bb0be){_0x1b57a0[_0x1d1d01(0x24b)](0x194)[_0x1d1d01(0x240)]({'message':_0x5bb0be[_0x1d1d01(0x247)]});}}),module['exports']=router;