var a0_0x579bb6=a0_0x2701;(function(_0x1f5b16,_0xf12d81){var _0x1a40cf=a0_0x2701,_0x30376d=_0x1f5b16();while(!![]){try{var _0x246226=-parseInt(_0x1a40cf(0x1a5))/0x1*(-parseInt(_0x1a40cf(0x22d))/0x2)+parseInt(_0x1a40cf(0x262))/0x3*(parseInt(_0x1a40cf(0x21b))/0x4)+-parseInt(_0x1a40cf(0x231))/0x5*(-parseInt(_0x1a40cf(0x269))/0x6)+parseInt(_0x1a40cf(0x224))/0x7*(parseInt(_0x1a40cf(0x1a9))/0x8)+-parseInt(_0x1a40cf(0x1dd))/0x9+-parseInt(_0x1a40cf(0x1ad))/0xa+parseInt(_0x1a40cf(0x1b6))/0xb;if(_0x246226===_0xf12d81)break;else _0x30376d['push'](_0x30376d['shift']());}catch(_0x13a0e9){_0x30376d['push'](_0x30376d['shift']());}}}(a0_0x1f5e,0xbfcf2));const express=require(a0_0x579bb6(0x215)),app=express(),router=express[a0_0x579bb6(0x1a2)](),auth=require(a0_0x579bb6(0x1e5)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x579bb6(0x260)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x579bb6(0x259));function a0_0x2701(_0x270ca7,_0x414505){var _0x1f5e50=a0_0x1f5e();return a0_0x2701=function(_0x2701a1,_0x5603b4){_0x2701a1=_0x2701a1-0x196;var _0x336465=_0x1f5e50[_0x2701a1];return _0x336465;},a0_0x2701(_0x270ca7,_0x414505);}router['get'](a0_0x579bb6(0x241),auth,async(_0x76f586,_0xd0914c)=>{var _0x23ad7f=a0_0x579bb6;try{const {username:_0xf084f3,email:_0xc72a4b,role:_0x23191d}=_0x76f586[_0x23ad7f(0x26c)],_0x271b07=_0x76f586[_0x23ad7f(0x26c)],_0x4b47ef=await profile[_0x23ad7f(0x23b)]({'email':_0x271b07[_0x23ad7f(0x23c)]}),_0x3df344=await master_shop[_0x23ad7f(0x1d4)]();console[_0x23ad7f(0x25a)]('master',_0x3df344);let _0x3c5b8c;if(_0x271b07['role']=='staff'){const _0x21d3f7=await staff[_0x23ad7f(0x23b)]({'email':_0x271b07[_0x23ad7f(0x23c)]});_0x3c5b8c=await warehouse['find']({'status':'Enabled','name':_0x21d3f7['warehouse']});}else _0x3c5b8c=await warehouse['find']({'status':_0x23ad7f(0x250)});const _0x36220a=await product['find']();let _0x241955;if(_0x271b07[_0x23ad7f(0x1f2)]=='staff'){const _0x2b8146=await staff['findOne']({'email':_0x271b07[_0x23ad7f(0x23c)]});_0x241955=await adjustment[_0x23ad7f(0x1d4)]({'warehouse_name':_0x2b8146['warehouse']});}else _0x241955=await adjustment['aggregate']([{'$unwind':_0x23ad7f(0x1e9)},{'$group':{'_id':_0x23ad7f(0x202),'invoice':{'$first':_0x23ad7f(0x216)},'date':{'$first':_0x23ad7f(0x1c2)},'warehouse_name':{'$first':_0x23ad7f(0x22e)},'room':{'$addToSet':_0x23ad7f(0x1ef)},'finalize':{'$first':_0x23ad7f(0x245)},'isAllowEdit':{'$first':_0x23ad7f(0x1fc)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3df344[0x0]['language']==_0x23ad7f(0x1ca)){var _0xd368c1=users['English'];console[_0x23ad7f(0x25a)](_0xd368c1);}else{if(_0x3df344[0x0]['language']==_0x23ad7f(0x1bd))var _0xd368c1=users['Hindi'];else{if(_0x3df344[0x0][_0x23ad7f(0x252)]==_0x23ad7f(0x211))var _0xd368c1=users[_0x23ad7f(0x211)];else{if(_0x3df344[0x0]['language']=='Spanish')var _0xd368c1=users[_0x23ad7f(0x26d)];else{if(_0x3df344[0x0][_0x23ad7f(0x252)]==_0x23ad7f(0x1ed))var _0xd368c1=users['French'];else{if(_0x3df344[0x0][_0x23ad7f(0x252)]=='Portuguese\x20(BR)')var _0xd368c1=users[_0x23ad7f(0x1f4)];else{if(_0x3df344[0x0][_0x23ad7f(0x252)]==_0x23ad7f(0x1d6))var _0xd368c1=users[_0x23ad7f(0x1d6)];else{if(_0x3df344[0x0][_0x23ad7f(0x252)]=='Arabic\x20(ae)')var _0xd368c1=users[_0x23ad7f(0x1d3)];}}}}}}}_0xd0914c[_0x23ad7f(0x1e7)](_0x23ad7f(0x1b0),{'success':_0x76f586[_0x23ad7f(0x20c)](_0x23ad7f(0x1aa)),'errors':_0x76f586[_0x23ad7f(0x20c)]('errors'),'role':_0x271b07,'profile':_0x4b47ef,'warehouse':_0x3c5b8c,'product':_0x36220a,'adjustment':_0x241955,'master_shop':_0x3df344,'language':_0xd368c1});}catch(_0x24847b){console[_0x23ad7f(0x25a)](_0x24847b);}});async function getRandom8DigitNumber(){var _0x4dea3c=a0_0x579bb6;const _0x36b601=0x989680,_0x3ae82e=0x5f5e0ff,_0x96c041=Math['floor'](Math['random']()*(_0x3ae82e-_0x36b601+0x1))+_0x36b601;var _0x493444;const _0x4ab0c0=await adjustment[_0x4dea3c(0x23b)]({'invoice':'ADJ-'+_0x96c041});return _0x4ab0c0&&_0x4ab0c0['length']>0x0?_0x493444='ADJ-'+_0x96c041:_0x493444=_0x4dea3c(0x198)+_0x96c041,_0x493444;}function a0_0x1f5e(){var _0x2d76e0=['length','$isAllowEdit','</h5>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','map','$product_details.bin','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$_id','$room','product_details','Shelves','warehouse_name','<h2>\x20','stock','/view/add_adjustment','primary_code','/barcode_scanner','flash','max_per_unit','add_adjustment','Ambient','/picking_list/PDF_adjustment_rm/','German','$product_details.batch_code','findById','</head><body>','express','$invoice','Return\x20Rooms','$product_details.expiry_date','</body></html>','<tr>','11988kwUVip','product_name','message','prod_cat','<table\x20style=\x22width:\x20100%\x20!important;\x22>','note','production_date','</tr>','</td>','14dJLJqn','port','image','/adjustment/view','$product_details.product_code','Logo.png','English','createTransport','$product_details.unit','146612OrDwGP','$warehouse_name','$product_details.product_name','padStart','2415740erxdlE','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','get','$product_details.pallet','string','params','all','room_names','level','Primary_Units','findOne','email','second1','json','<div>','$product_details','/view','type','prod_name','filter','$finalize','<h5>','status','stockBefore','RMSEmail','site_title','Rooms','types','</span>','/preview/:id','body','Enabled','$product_details.maxPerUnit','language','$name','</div>','push','New_Qty_Converted','exports','save','nodemailer','log','bin','$product.product_name','split','Enclosed','Floor','../models/all_models','</tbody>','3rjkIhu','$product_details.level','product_code','logo','$product_details.floorlevel','Email\x20sent\x20successfully','\x20Order\x20Date\x20:\x20','6rAfwjK','$product_details.isle','$product_details.production_date','user','Spanish','product','<tbody\x20style=\x22text-align:\x20center;\x22>','Return\x20Goods','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','finalize','maxperunit','ADJ-','host','<html><head><title></title>','Arabic\x20(ae)','$product_details.secondary_unit','forEach','errors','_id','foreach\x20newproduct','<!DOCTYPE\x20html>','Router','edit_adjustment_view','$product_details.product_stock','7TfYYAo','secondary_code','/CheckingWarehouse','$product_details.secondary_code','5715496mRitxX','success','Level','$product_details.product_cat','4281830goAUyu','/upload/','back','adjustment','post','$product_details.maxProducts','product_stock','error','$product_details.rack','104610PqzinG','storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','new_adjust_qty','Hindi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.invoice','id_transaction_from','adjustment\x20Finalized\x20successfully','$date','toString','adjustment\x20add\x20successfull','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/view/:id','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','invoice','English\x20(US)','\x20<>\x20','$product_details.primary_code','$product_details.storage','/../public','sendMail','date','rack','/adjustment/preview/','Arabic','find','redirect','Chinese','$product_details.type','adjust_qty','Adjustment\x20Mail','secondary_unit','id_transaction','unit','11014542LYzRgg','then','An\x20error\x20occurred\x20while\x20saving\x20data.','slice','Portuguese\x20(BR)','Raw\x20Materials','aggregate','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','../middleware/auth','staff','render','\x20Order\x20Number\x20:\x20','$product','catch','prod_code','floorlevel','French','$product_details._id','$product.room_names','True','isAllowEdit','role','prime1','Portuguese','warehouse','Secondary_units','Receiving\x20Area','bay','batch_code','$product_details.bay'];a0_0x1f5e=function(){return _0x2d76e0;};return a0_0x1f5e();}router['get'](a0_0x579bb6(0x209),auth,async(_0x448cd7,_0x565ce1)=>{var _0x566bf3=a0_0x579bb6;try{const {username:_0x279993,email:_0x45375d,role:_0x37fe33}=_0x448cd7[_0x566bf3(0x26c)],_0x1a3eb8=_0x448cd7['user'],_0x48deda=await profile[_0x566bf3(0x23b)]({'email':_0x1a3eb8['email']}),_0x57cf1c=await master_shop[_0x566bf3(0x1d4)]();let _0x49a2bf;if(_0x1a3eb8[_0x566bf3(0x1f2)]==_0x566bf3(0x1e6)){const _0x2d6dbf=await staff[_0x566bf3(0x23b)]({'email':_0x1a3eb8[_0x566bf3(0x23c)]});_0x49a2bf=await warehouse[_0x566bf3(0x1e3)]([{'$match':{'status':_0x566bf3(0x250),'name':_0x2d6dbf[_0x566bf3(0x1f5)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x566bf3(0x270)}}},{'$group':{'_id':_0x566bf3(0x253),'name':{'$first':_0x566bf3(0x253)}}}]);}else _0x49a2bf=await warehouse['aggregate']([{'$match':{'status':_0x566bf3(0x250),'warehouse_category':_0x566bf3(0x1e2),'name':{'$ne':_0x566bf3(0x270)}}},{'$group':{'_id':'$name','name':{'$first':_0x566bf3(0x253)}}}]);const _0x2ff028=await product[_0x566bf3(0x1d4)]({}),_0x4e4def=await adjustment['find']({}),_0x30cca3=_0x4e4def[_0x566bf3(0x1fb)]+0x1,_0x139faf=_0x566bf3(0x198)+_0x30cca3[_0x566bf3(0x1c3)]()[_0x566bf3(0x230)](0x5,'0');var _0x63ceaa=[_0x566bf3(0x20f),_0x566bf3(0x25e),_0x566bf3(0x217)];if(_0x57cf1c[0x0][_0x566bf3(0x252)]==_0x566bf3(0x1ca))var _0x12bf7d=users[_0x566bf3(0x22a)];else{if(_0x57cf1c[0x0][_0x566bf3(0x252)]==_0x566bf3(0x1bd))var _0x12bf7d=users[_0x566bf3(0x1bd)];else{if(_0x57cf1c[0x0]['language']==_0x566bf3(0x211))var _0x12bf7d=users['German'];else{if(_0x57cf1c[0x0][_0x566bf3(0x252)]==_0x566bf3(0x26d))var _0x12bf7d=users[_0x566bf3(0x26d)];else{if(_0x57cf1c[0x0]['language']==_0x566bf3(0x1ed))var _0x12bf7d=users[_0x566bf3(0x1ed)];else{if(_0x57cf1c[0x0][_0x566bf3(0x252)]==_0x566bf3(0x1e1))var _0x12bf7d=users[_0x566bf3(0x1f4)];else{if(_0x57cf1c[0x0][_0x566bf3(0x252)]=='Chinese')var _0x12bf7d=users[_0x566bf3(0x1d6)];else{if(_0x57cf1c[0x0][_0x566bf3(0x252)]==_0x566bf3(0x19b))var _0x12bf7d=users['Arabic'];}}}}}}}const _0x4d50fb=getRandom8DigitNumber();_0x4d50fb[_0x566bf3(0x1de)](_0x253f23=>{var _0x5466e0=_0x566bf3;_0x565ce1[_0x5466e0(0x1e7)](_0x5466e0(0x20e),{'success':_0x448cd7['flash'](_0x5466e0(0x1aa)),'errors':_0x448cd7[_0x5466e0(0x20c)](_0x5466e0(0x19e)),'role':_0x1a3eb8,'profile':_0x48deda,'warehouse':_0x49a2bf,'product':_0x2ff028,'master_shop':_0x57cf1c,'language':_0x12bf7d,'rooms_data':_0x63ceaa,'invoice_no':_0x253f23});})[_0x566bf3(0x1ea)](_0x46ce7d=>{var _0xc5dfc5=_0x566bf3;_0x448cd7[_0xc5dfc5(0x20c)](_0xc5dfc5(0x19e),_0xc5dfc5(0x1fe)),_0x565ce1[_0xc5dfc5(0x1d5)](_0xc5dfc5(0x227));});}catch(_0x56e98e){console[_0x566bf3(0x25a)](_0x56e98e);}}),router[a0_0x579bb6(0x1b1)](a0_0x579bb6(0x209),auth,async(_0x7caa6c,_0x23035a)=>{var _0x33b0d1=a0_0x579bb6;try{const {warehouse_name:_0x5b784c,date:_0x1f19b6,prod_name:_0x263578,level:_0x4eed08,isle:_0x36ff69,pallet:_0x593f1c,stock:_0xb95b63,types:_0x33effd,adjust_qty:_0x1f1b41,new_adjust_qty:_0x15e16d,note:_0x3d0cdd,Room_name:_0x20ae41,invoice:_0x1655df,JO_number:_0x5095b6,expiry_date:_0xdfa765}=_0x7caa6c[_0x33b0d1(0x24f)];if(typeof _0x263578==_0x33b0d1(0x235))var _0x360122=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x243)]],_0x2d7c96=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x239)]],_0x5b7793=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x208)]],_0x2a8e40=[_0x7caa6c['body'][_0x33b0d1(0x24c)]],_0x4f50c5=[_0x7caa6c[_0x33b0d1(0x24f)]['New_Qty_Converted_adj']],_0x18b781=[_0x7caa6c['body'][_0x33b0d1(0x256)]],_0x18b700=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x23a)]],_0xf88a25=[_0x7caa6c[_0x33b0d1(0x24f)]['Secondary_units']],_0x4533c0=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1eb)]],_0x462fe0=[_0x7caa6c[_0x33b0d1(0x24f)]['batch_code']],_0x55f693=[_0x7caa6c['body'][_0x33b0d1(0x1c7)]],_0x1780f2=[_0x7caa6c['body'][_0x33b0d1(0x20d)]],_0x2b2aaa=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x221)]],_0x247c57=[_0x7caa6c['body'][_0x33b0d1(0x21e)]],_0x2f9930=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x24b)]],_0x1a4bdd=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1f3)]],_0xe83595=[_0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x23d)]],_0x1f60a4=[_0x7caa6c[_0x33b0d1(0x24f)]['prod_invoice']],_0x2b68b6=[_0x7caa6c[_0x33b0d1(0x24f)]['id_transaction']];else var _0x360122=[..._0x7caa6c[_0x33b0d1(0x24f)]['prod_name']],_0x2d7c96=[..._0x7caa6c['body']['level']],_0x5b7793=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x208)]],_0x2a8e40=[..._0x7caa6c[_0x33b0d1(0x24f)]['types']],_0x4f50c5=[..._0x7caa6c[_0x33b0d1(0x24f)]['New_Qty_Converted_adj']],_0x18b781=[..._0x7caa6c['body'][_0x33b0d1(0x256)]],_0x18b700=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1dc)]],_0xf88a25=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1f6)]],_0x4533c0=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1eb)]],_0x462fe0=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1f9)]],_0x55f693=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1c7)]],_0x1780f2=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x20d)]],_0x2b2aaa=[..._0x7caa6c[_0x33b0d1(0x24f)]['production_date']],_0x247c57=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x21e)]],_0x2f9930=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x24b)]],_0x1a4bdd=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1f3)]],_0xe83595=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x23d)]],_0x1f60a4=[..._0x7caa6c[_0x33b0d1(0x24f)]['prod_invoice']],_0x2b68b6=[..._0x7caa6c[_0x33b0d1(0x24f)][_0x33b0d1(0x1db)]];const _0x5d6ca4=_0x360122['map'](_0x31441f=>{return _0x31441f={'product_name':_0x31441f};});_0x2d7c96[_0x33b0d1(0x19d)]((_0x5c6a69,_0x547d3e)=>{var _0x1e1146=_0x33b0d1;_0x2f9930[_0x1e1146(0x19d)]((_0x1c9190,_0x7ee238)=>{var _0x2e87fb=_0x1e1146;if(_0x1c9190=='Receiving\x20Area'&&_0x547d3e==_0x7ee238){var _0x1de05f=_0x5c6a69[_0x2e87fb(0x1e0)](0x3);_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1b7)]=_0x5c6a69[0x0],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1d1)]=_0x5c6a69[0x1],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1f8)]=0x0,_0x5d6ca4[_0x547d3e][_0x2e87fb(0x25b)]=0x0,_0x5d6ca4[_0x547d3e][_0x2e87fb(0x242)]='Floor',_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1ec)]=_0x1de05f;}else{if(_0x1c9190==_0x2e87fb(0x205)&&_0x547d3e==_0x7ee238){var _0x1de05f=_0x5c6a69[_0x2e87fb(0x1e0)](0x3);_0x5d6ca4[_0x547d3e]['storage']=_0x5c6a69[0x0],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1d1)]=_0x5c6a69[0x1],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1f8)]=0x0,_0x5d6ca4[_0x547d3e][_0x2e87fb(0x25b)]=0x0,_0x5d6ca4[_0x547d3e][_0x2e87fb(0x242)]=_0x2e87fb(0x25f),_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1ec)]=_0x5c6a69[0x5];}else{if(_0x547d3e==_0x7ee238){var _0x5c5168;if(_0x5c6a69[0x4]=='L')_0x5c5168=_0x2e87fb(0x1ab);else _0x5c6a69[0x4]=='F'&&(_0x5c5168=_0x2e87fb(0x25f));_0x5d6ca4[_0x547d3e]['storage']=_0x5c6a69[0x0],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1d1)]=_0x5c6a69[0x1],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x1f8)]=_0x5c6a69[0x2],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x25b)]=_0x5c6a69[0x3],_0x5d6ca4[_0x547d3e][_0x2e87fb(0x242)]=_0x5c5168,_0x5d6ca4[_0x547d3e]['floorlevel']=_0x5c6a69[0x5];}}}});}),_0x5b7793[_0x33b0d1(0x19d)]((_0x5200ed,_0x5f09ff)=>{var _0xaacbd8=_0x33b0d1;_0x5d6ca4[_0x5f09ff][_0xaacbd8(0x248)]=_0x5200ed;}),_0x2b68b6[_0x33b0d1(0x19d)]((_0x5c407e,_0x3065fe)=>{var _0x12bd90=_0x33b0d1;_0x5d6ca4[_0x3065fe][_0x12bd90(0x1c0)]=_0x5c407e;}),_0x2a8e40[_0x33b0d1(0x19d)]((_0x34e9a6,_0x48f218)=>{var _0x126ac1=_0x33b0d1;_0x5d6ca4[_0x48f218][_0x126ac1(0x24c)]=_0x34e9a6;}),_0x4f50c5['forEach']((_0x105e78,_0x10ae5b)=>{var _0x29d257=_0x33b0d1;_0x5d6ca4[_0x10ae5b][_0x29d257(0x1d8)]=_0x105e78;}),_0x18b781[_0x33b0d1(0x19d)]((_0x80bb35,_0x23c033)=>{var _0x3697d4=_0x33b0d1;_0x5d6ca4[_0x23c033][_0x3697d4(0x1bc)]=_0x80bb35;}),_0x18b700[_0x33b0d1(0x19d)]((_0x5e468a,_0x2407cc)=>{var _0x318b9d=_0x33b0d1;_0x5d6ca4[_0x2407cc][_0x318b9d(0x1dc)]=_0x5e468a;}),_0xf88a25[_0x33b0d1(0x19d)]((_0x4c3c1b,_0x3bd39a)=>{_0x5d6ca4[_0x3bd39a]['secondary_unit']=_0x4c3c1b;}),_0x4533c0[_0x33b0d1(0x19d)]((_0x36556d,_0x15757c)=>{_0x5d6ca4[_0x15757c]['product_code']=_0x36556d;}),_0x462fe0[_0x33b0d1(0x19d)]((_0xbb992,_0x5cfe5b)=>{_0x5d6ca4[_0x5cfe5b]['batch_code']=_0xbb992;}),_0x55f693[_0x33b0d1(0x19d)]((_0x4c91fc,_0x15d84a)=>{var _0x26d732=_0x33b0d1;_0x5d6ca4[_0x15d84a][_0x26d732(0x1c7)]=_0x4c91fc;}),_0x1780f2[_0x33b0d1(0x19d)]((_0x267b6e,_0x4883fd)=>{var _0x3ad781=_0x33b0d1;_0x5d6ca4[_0x4883fd][_0x3ad781(0x197)]=_0x267b6e;}),_0x2b2aaa[_0x33b0d1(0x19d)]((_0x24b198,_0x371fb0)=>{var _0x3e4e03=_0x33b0d1;_0x5d6ca4[_0x371fb0][_0x3e4e03(0x221)]=_0x24b198;}),_0x247c57[_0x33b0d1(0x19d)]((_0x223abd,_0x5ed469)=>{var _0x470f1b=_0x33b0d1;_0x5d6ca4[_0x5ed469][_0x470f1b(0x21e)]=_0x223abd;}),_0x2f9930[_0x33b0d1(0x19d)]((_0x3c65ab,_0x502839)=>{var _0xda747a=_0x33b0d1;_0x5d6ca4[_0x502839][_0xda747a(0x238)]=_0x3c65ab;}),_0x1a4bdd[_0x33b0d1(0x19d)]((_0x4c25d5,_0x539741)=>{_0x5d6ca4[_0x539741]['primary_code']=_0x4c25d5;}),_0xe83595['forEach']((_0x3e0653,_0x2e8421)=>{var _0x245e22=_0x33b0d1;_0x5d6ca4[_0x2e8421][_0x245e22(0x1a6)]=_0x3e0653;}),_0x1f60a4[_0x33b0d1(0x19d)]((_0x7db523,_0x270be7)=>{var _0x53196c=_0x33b0d1;_0x5d6ca4[_0x270be7][_0x53196c(0x1c9)]=_0x7db523;});const _0x23a91e=_0x5d6ca4[_0x33b0d1(0x244)](_0x234551=>_0x234551[_0x33b0d1(0x1d8)]!=='0'&&_0x234551[_0x33b0d1(0x1d8)]!=='');var _0x214a4c=0x0;_0x23a91e[_0x33b0d1(0x19d)](_0x498169=>{var _0x238f4a=_0x33b0d1;console[_0x238f4a(0x25a)](_0x238f4a(0x1a0),_0x498169),parseInt(_0x498169[_0x238f4a(0x1d8)])<=0x0&&_0x214a4c++;});if(_0x214a4c!=0x0)return _0x7caa6c[_0x33b0d1(0x20c)](_0x33b0d1(0x19e),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x23035a[_0x33b0d1(0x1d5)](_0x33b0d1(0x1af));const _0x4ebf75=new adjustment({'warehouse_name':_0x5b784c,'date':_0x1f19b6,'product':_0x23a91e,'note':_0x3d0cdd,'room':_0x20ae41,'invoice':_0x1655df,'JO_number':_0x5095b6,'expiry_date':_0xdfa765}),_0x12b0f6=await _0x4ebf75['save']();_0x7caa6c[_0x33b0d1(0x20c)]('success',_0x33b0d1(0x1c4)),_0x23035a['redirect'](_0x33b0d1(0x1d2)+_0x12b0f6[_0x33b0d1(0x19f)]);}catch(_0x1058d1){console[_0x33b0d1(0x25a)](_0x1058d1),_0x23035a[_0x33b0d1(0x247)](0xc8)[_0x33b0d1(0x23e)]({'message':_0x1058d1[_0x33b0d1(0x21d)]});}}),router[a0_0x579bb6(0x233)](a0_0x579bb6(0x24e),auth,async(_0x5401d5,_0x29b862)=>{var _0x388a38=a0_0x579bb6;try{const {username:_0x384e19,email:_0xfb9bf3,role:_0x2a27a6}=_0x5401d5[_0x388a38(0x26c)],_0x476c7b=_0x5401d5[_0x388a38(0x26c)],_0x3b9865=await profile[_0x388a38(0x23b)]({'email':_0x476c7b[_0x388a38(0x23c)]}),_0x474941=await master_shop[_0x388a38(0x1d4)](),_0x13c3dc=_0x5401d5['params']['id'],_0x4ae85b=await adjustment[_0x388a38(0x213)]({'_id':_0x13c3dc}),_0x2e0f9f=await purchases[_0x388a38(0x1e3)]([{'$match':{'warehouse_name':_0x4ae85b[_0x388a38(0x206)]}},{'$unwind':'$product'},{'$group':{'_id':_0x388a38(0x25c)}}]),_0x4faa99=await product[_0x388a38(0x1d4)]({}),_0x552fcc=await warehouse['aggregate']([{'$match':{'name':_0x4ae85b[_0x388a38(0x206)]}},{'$unwind':_0x388a38(0x240)},{'$group':{'_id':_0x388a38(0x1ee),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x388a38(0x1fa)},'bin':{'$first':_0x388a38(0x200)},'type':{'$first':_0x388a38(0x1d7)},'floorlevel':{'$first':_0x388a38(0x266)},'primary_code':{'$first':_0x388a38(0x1cc)},'secondary_code':{'$first':_0x388a38(0x1a8)},'product_code':{'$first':_0x388a38(0x228)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x388a38(0x1b5)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x388a38(0x218)},'production_date':{'$first':_0x388a38(0x26b)},'batch_code':{'$first':_0x388a38(0x212)},'room':{'$first':_0x388a38(0x203)}}}]);if(_0x474941[0x0][_0x388a38(0x252)]==_0x388a38(0x1ca)){var _0x4442d0=users[_0x388a38(0x22a)];console[_0x388a38(0x25a)](_0x4442d0);}else{if(_0x474941[0x0][_0x388a38(0x252)]==_0x388a38(0x1bd))var _0x4442d0=users[_0x388a38(0x1bd)];else{if(_0x474941[0x0][_0x388a38(0x252)]==_0x388a38(0x211))var _0x4442d0=users[_0x388a38(0x211)];else{if(_0x474941[0x0][_0x388a38(0x252)]==_0x388a38(0x26d))var _0x4442d0=users[_0x388a38(0x26d)];else{if(_0x474941[0x0]['language']==_0x388a38(0x1ed))var _0x4442d0=users['French'];else{if(_0x474941[0x0]['language']==_0x388a38(0x1e1))var _0x4442d0=users[_0x388a38(0x1f4)];else{if(_0x474941[0x0]['language']==_0x388a38(0x1d6))var _0x4442d0=users['Chinese'];else{if(_0x474941[0x0][_0x388a38(0x252)]==_0x388a38(0x19b))var _0x4442d0=users[_0x388a38(0x1d3)];}}}}}}}_0x29b862[_0x388a38(0x1e7)](_0x388a38(0x1a3),{'success':_0x5401d5[_0x388a38(0x20c)](_0x388a38(0x1aa)),'errors':_0x5401d5['flash'](_0x388a38(0x19e)),'role':_0x476c7b,'profile':_0x3b9865,'adjustment':_0x4ae85b,'stock':_0x552fcc,'master_shop':_0x474941,'warehouse_name':_0x2e0f9f,'unit':_0x4faa99,'language':_0x4442d0});}catch(_0x1f363d){console[_0x388a38(0x25a)](_0x1f363d),_0x29b862[_0x388a38(0x247)](0xc8)[_0x388a38(0x23e)]({'message':_0x1f363d[_0x388a38(0x21d)]});}}),router[a0_0x579bb6(0x1b1)](a0_0x579bb6(0x24e),auth,async(_0x5bc495,_0x98a9b9)=>{var _0x512f90=a0_0x579bb6;try{const _0x3a0734=_0x5bc495['params']['id'],{warehouse_name:_0x8c94c2,Room_name:_0x5599a5}=_0x5bc495[_0x512f90(0x24f)],_0x1395b1=await adjustment['findById']({'_id':_0x3a0734}),_0x2544f4=_0x1395b1[_0x512f90(0x26e)][_0x512f90(0x1ff)](async _0x57cd60=>{var _0x12db2b=_0x512f90;if(_0x57cd60[_0x12db2b(0x1d8)]>0x0){var _0x16b671=await warehouse[_0x12db2b(0x23b)]({'name':_0x8c94c2,'room':_0x57cd60['room_names'],'warehouse_category':_0x12db2b(0x1e2)});const _0x388ea5=_0x16b671[_0x12db2b(0x204)]['map'](_0x319bfe=>{var _0xf8f410=_0x12db2b;console[_0xf8f410(0x25a)](_0x57cd60['types']+_0xf8f410(0x1cb));if(_0x57cd60[_0xf8f410(0x24c)]=='minus'){if(_0x319bfe[_0xf8f410(0x21c)]==_0x57cd60[_0xf8f410(0x21c)]&&_0x319bfe['floorlevel']==_0x57cd60['floorlevel']&&_0x319bfe[_0xf8f410(0x242)]==_0x57cd60[_0xf8f410(0x242)]&&_0x319bfe['bin']==_0x57cd60[_0xf8f410(0x25b)]&&_0x319bfe['bay']==_0x57cd60['bay']&&_0x319bfe[_0xf8f410(0x1d1)]==_0x57cd60[_0xf8f410(0x1d1)]&&_0x319bfe[_0xf8f410(0x1b7)]==_0x57cd60[_0xf8f410(0x1b7)]&&_0x319bfe[_0xf8f410(0x1c7)]==_0x57cd60[_0xf8f410(0x1c7)]&&_0x319bfe[_0xf8f410(0x1f9)]==_0x57cd60['batch_code']&&_0x319bfe['production_date']==_0x57cd60['production_date']&&_0x319bfe['invoice']==_0x57cd60[_0xf8f410(0x1c9)]&&_0x319bfe[_0xf8f410(0x19f)]==_0x57cd60['id_transaction_from']){var _0x4bcd09;_0x4bcd09=_0x57cd60[_0xf8f410(0x1d8)],_0x57cd60[_0xf8f410(0x21e)]=='S'&&(_0x4bcd09=_0x57cd60[_0xf8f410(0x1d8)]),_0x319bfe['product_stock']=_0x319bfe[_0xf8f410(0x1b3)]-_0x4bcd09;}}else{if(_0x319bfe['product_name']==_0x57cd60[_0xf8f410(0x21c)]&&_0x319bfe[_0xf8f410(0x1ec)]==_0x57cd60[_0xf8f410(0x1ec)]&&_0x319bfe[_0xf8f410(0x242)]==_0x57cd60['type']&&_0x319bfe[_0xf8f410(0x25b)]==_0x57cd60['bin']&&_0x319bfe[_0xf8f410(0x1f8)]==_0x57cd60[_0xf8f410(0x1f8)]&&_0x319bfe['rack']==_0x57cd60['rack']&&_0x319bfe[_0xf8f410(0x1b7)]==_0x57cd60['storage']&&_0x319bfe[_0xf8f410(0x1c7)]==_0x57cd60['expiry_date']&&_0x319bfe[_0xf8f410(0x1f9)]==_0x57cd60[_0xf8f410(0x1f9)]&&_0x319bfe[_0xf8f410(0x221)]==_0x57cd60[_0xf8f410(0x221)]&&_0x319bfe[_0xf8f410(0x1c9)]==_0x57cd60['invoice']&&_0x319bfe[_0xf8f410(0x19f)]==_0x57cd60[_0xf8f410(0x1c0)]){console['log'](_0x57cd60);var _0x4bcd09;_0x4bcd09=_0x57cd60['adjust_qty'],_0x57cd60['prod_cat']=='S'&&(_0x4bcd09=_0x57cd60[_0xf8f410(0x1d8)]),_0x319bfe[_0xf8f410(0x1b3)]=_0x319bfe[_0xf8f410(0x1b3)]+_0x4bcd09;}}});}return _0x16b671;});Promise['all'](_0x2544f4)[_0x512f90(0x1de)](async _0x2aabfb=>{var _0x4d2878=_0x512f90;try{for(const _0x48ad8a of _0x2aabfb){await _0x48ad8a[_0x4d2878(0x258)]();}_0x1395b1[_0x4d2878(0x196)]=_0x4d2878(0x1f0);const _0xa0c6dc=await _0x1395b1['save'](),_0x36b998=await master_shop[_0x4d2878(0x1d4)](),_0x137def=await email_settings['findOne'](),_0x363b71=await supervisor_settings[_0x4d2878(0x1d4)]();var _0x350615=_0x1395b1[_0x4d2878(0x26e)],_0x3f1b34='',_0x21e05a;for(_0x21e05a in _0x350615){_0x3f1b34+=_0x4d2878(0x21a)+_0x4d2878(0x1ba)+_0x350615[_0x21e05a][_0x4d2878(0x21c)]+_0x4d2878(0x223)+_0x4d2878(0x1ba)+_0x350615[_0x21e05a]['product_code']+_0x4d2878(0x223)+_0x4d2878(0x1ba)+_0x350615[_0x21e05a][_0x4d2878(0x1d8)]+_0x4d2878(0x223)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x350615[_0x21e05a][_0x4d2878(0x1dc)]+'</td>'+_0x4d2878(0x1ba)+_0x350615[_0x21e05a]['secondary_unit']+_0x4d2878(0x223)+_0x4d2878(0x1ba)+_0x1395b1[_0x4d2878(0x206)]+'</td>'+_0x4d2878(0x1ba)+_0x350615[_0x21e05a]['room_names']+_0x4d2878(0x223)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x350615[_0x21e05a]['storage']+_0x350615[_0x21e05a][_0x4d2878(0x1d1)]+_0x350615[_0x21e05a][_0x4d2878(0x1f8)]+_0x350615[_0x21e05a][_0x4d2878(0x25b)]+_0x350615[_0x21e05a][_0x4d2878(0x242)][0x0]+_0x350615[_0x21e05a][_0x4d2878(0x1ec)]+_0x4d2878(0x223),_0x4d2878(0x222);}let _0x5ee8a7=nodemailer[_0x4d2878(0x22b)]({'host':_0x137def[_0x4d2878(0x199)],'port':Number(_0x137def[_0x4d2878(0x225)]),'secure':![],'auth':{'user':_0x137def[_0x4d2878(0x23c)],'pass':_0x137def['password']}}),_0x220c53={'from':_0x137def[_0x4d2878(0x23c)],'to':_0x363b71[0x0][_0x4d2878(0x249)],'subject':_0x4d2878(0x1d9),'attachments':[{'filename':_0x4d2878(0x229),'path':__dirname+_0x4d2878(0x1ce)+_0x4d2878(0x1ae)+_0x36b998[0x0][_0x4d2878(0x226)],'cid':_0x4d2878(0x265)}],'html':_0x4d2878(0x1a1)+_0x4d2878(0x19a)+_0x4d2878(0x214)+_0x4d2878(0x23f)+_0x4d2878(0x201)+_0x4d2878(0x23f)+_0x4d2878(0x1e4)+_0x4d2878(0x254)+_0x4d2878(0x23f)+_0x4d2878(0x207)+_0x36b998[0x0]['site_title']+'\x20</h2>'+_0x4d2878(0x254)+_0x4d2878(0x254)+'<hr\x20class=\x22my-3\x22>'+_0x4d2878(0x23f)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x4d2878(0x1e8)+_0x1395b1[_0x4d2878(0x1c9)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x4d2878(0x268)+_0x1395b1[_0x4d2878(0x1d0)]+'\x20'+_0x4d2878(0x24d)+_0x4d2878(0x1fd)+_0x4d2878(0x254)+_0x4d2878(0x21f)+_0x4d2878(0x1b9)+'<tr>'+_0x4d2878(0x1b8)+_0x4d2878(0x1be)+_0x4d2878(0x1bb)+_0x4d2878(0x232)+_0x4d2878(0x1c8)+_0x4d2878(0x1c5)+_0x4d2878(0x271)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x4d2878(0x222)+'</thead>'+_0x4d2878(0x26f)+'\x20'+_0x3f1b34+'\x20'+_0x4d2878(0x261)+'</table>'+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x4d2878(0x246)+_0x36b998[0x0][_0x4d2878(0x24a)]+_0x4d2878(0x1fd)+_0x4d2878(0x254)+_0x4d2878(0x254)+_0x4d2878(0x219)};_0x5ee8a7[_0x4d2878(0x1cf)](_0x220c53,function(_0x2a19c0,_0x51e71e){var _0x17c1e1=_0x4d2878;_0x2a19c0?(console[_0x17c1e1(0x25a)](_0x2a19c0),console['log']('Error\x20Occurs')):console[_0x17c1e1(0x25a)](_0x17c1e1(0x267));}),_0x5bc495[_0x4d2878(0x20c)](_0x4d2878(0x1aa),_0x4d2878(0x1c1)),_0x98a9b9[_0x4d2878(0x1d5)](_0x4d2878(0x210)+_0xa0c6dc[_0x4d2878(0x19f)]);}catch(_0x210e92){console[_0x4d2878(0x1b4)](_0x210e92),_0x98a9b9[_0x4d2878(0x247)](0x1f4)[_0x4d2878(0x23e)]({'error':_0x4d2878(0x1df)});}})[_0x512f90(0x1ea)](_0x481bf5=>{var _0x486ef8=_0x512f90;console[_0x486ef8(0x1b4)](_0x481bf5),_0x98a9b9[_0x486ef8(0x247)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x149556){console[_0x512f90(0x25a)](_0x149556),_0x98a9b9[_0x512f90(0x247)](0xc8)[_0x512f90(0x23e)]({'message':_0x149556[_0x512f90(0x21d)]});}}),router['get'](a0_0x579bb6(0x1c6),auth,async(_0x54a7e7,_0x53881c)=>{var _0x471ac1=a0_0x579bb6;try{const {username:_0x388ace,email:_0x1a8680,role:_0x40202b}=_0x54a7e7[_0x471ac1(0x26c)],_0x4468a3=_0x54a7e7[_0x471ac1(0x26c)],_0x48878e=await profile['findOne']({'email':_0x4468a3[_0x471ac1(0x23c)]}),_0x1263e0=await master_shop[_0x471ac1(0x1d4)](),_0x495926=_0x54a7e7[_0x471ac1(0x236)]['id'],_0xa38d65=await adjustment[_0x471ac1(0x213)]({'_id':_0x495926}),_0x4c6910=await purchases[_0x471ac1(0x1e3)]([{'$match':{'warehouse_name':_0xa38d65[_0x471ac1(0x206)]}},{'$unwind':_0x471ac1(0x1e9)},{'$group':{'_id':'$product.product_name'}}]),_0x4efccd=await product[_0x471ac1(0x1d4)]({}),_0x446ec5=await warehouse['aggregate']([{'$match':{'name':_0xa38d65[_0x471ac1(0x206)]}},{'$unwind':_0x471ac1(0x240)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x471ac1(0x22f)},'product_stock':{'$first':_0x471ac1(0x1a4)},'bay':{'$first':_0x471ac1(0x1fa)},'bin':{'$first':_0x471ac1(0x200)},'type':{'$first':_0x471ac1(0x1d7)},'floorlevel':{'$first':_0x471ac1(0x266)},'primary_code':{'$first':_0x471ac1(0x1cc)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x471ac1(0x228)},'storage':{'$first':_0x471ac1(0x1cd)},'rack':{'$first':_0x471ac1(0x1b5)},'maxPerUnit':{'$first':_0x471ac1(0x251)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x471ac1(0x26b)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x471ac1(0x203)}}}]);let _0x460e58;if(_0x4468a3[_0x471ac1(0x1f2)]==_0x471ac1(0x1e6)){const _0x220f3b=await staff[_0x471ac1(0x23b)]({'email':_0x4468a3[_0x471ac1(0x23c)]});_0x460e58=await warehouse['aggregate']([{'$match':{'status':_0x471ac1(0x250),'name':_0x220f3b[_0x471ac1(0x1f5)],'warehouse_category':_0x471ac1(0x1e2),'name':{'$ne':_0x471ac1(0x270)}}},{'$group':{'_id':_0x471ac1(0x253),'name':{'$first':_0x471ac1(0x253)}}}]);}else _0x460e58=await warehouse[_0x471ac1(0x1e3)]([{'$match':{'status':'Enabled','warehouse_category':_0x471ac1(0x1e2),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x471ac1(0x253),'name':{'$first':_0x471ac1(0x253)}}}]);if(_0x1263e0[0x0][_0x471ac1(0x252)]==_0x471ac1(0x1ca)){var _0x53cf10=users[_0x471ac1(0x22a)];console[_0x471ac1(0x25a)](_0x53cf10);}else{if(_0x1263e0[0x0]['language']==_0x471ac1(0x1bd))var _0x53cf10=users[_0x471ac1(0x1bd)];else{if(_0x1263e0[0x0][_0x471ac1(0x252)]=='German')var _0x53cf10=users[_0x471ac1(0x211)];else{if(_0x1263e0[0x0][_0x471ac1(0x252)]==_0x471ac1(0x26d))var _0x53cf10=users[_0x471ac1(0x26d)];else{if(_0x1263e0[0x0][_0x471ac1(0x252)]==_0x471ac1(0x1ed))var _0x53cf10=users['French'];else{if(_0x1263e0[0x0][_0x471ac1(0x252)]==_0x471ac1(0x1e1))var _0x53cf10=users[_0x471ac1(0x1f4)];else{if(_0x1263e0[0x0][_0x471ac1(0x252)]==_0x471ac1(0x1d6))var _0x53cf10=users['Chinese'];else{if(_0x1263e0[0x0][_0x471ac1(0x252)]==_0x471ac1(0x19b))var _0x53cf10=users[_0x471ac1(0x1d3)];}}}}}}}_0x53881c['render']('edit_adjustment',{'success':_0x54a7e7[_0x471ac1(0x20c)](_0x471ac1(0x1aa)),'errors':_0x54a7e7['flash'](_0x471ac1(0x19e)),'role':_0x4468a3,'profile':_0x48878e,'adjustment':_0xa38d65,'stock':_0x446ec5,'master_shop':_0x1263e0,'warehouse_name':_0x4c6910,'unit':_0x4efccd,'language':_0x53cf10,'warehouse':_0x460e58});}catch(_0xc016c){console['log'](_0xc016c),_0x53881c[_0x471ac1(0x247)](0xc8)[_0x471ac1(0x23e)]({'message':_0xc016c[_0x471ac1(0x21d)]});}}),router['post'](a0_0x579bb6(0x1c6),auth,async(_0x3093ce,_0x27e5f5)=>{var _0x5c8250=a0_0x579bb6;try{const _0x3374b2=_0x3093ce[_0x5c8250(0x236)]['id'],_0x565f2f=await adjustment[_0x5c8250(0x213)]({'_id':_0x3374b2}),_0x48e205=await warehouse['findOne']({'name':_0x565f2f[_0x5c8250(0x206)],'room':_0x565f2f['room']}),{warehouse_name:_0x1febb4,date:_0x40574a,prod_name:_0x3c4e3e,level:_0x18a67e,isle:_0x13ea5b,pallet:_0x4befad,stock:_0x3273d3,types:_0x274452,adjust_qty:_0x2e6463,new_adjust_qty:_0x347b4e,note:_0x5630fd,Room_name:_0x4c37a6,invoice:_0x56b08b,JO_number:_0x504ea4,expiry_date:_0x13f087}=_0x3093ce[_0x5c8250(0x24f)];if(typeof _0x3c4e3e==_0x5c8250(0x235))var _0xb61a4c=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x243)]],_0xdf1d65=[_0x3093ce['body'][_0x5c8250(0x239)]],_0x3bea54=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x208)]],_0x190ea7=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x24c)]],_0x25c984=[_0x3093ce['body']['New_Qty_Converted_adj']],_0x4c575d=[_0x3093ce['body'][_0x5c8250(0x256)]],_0x1c71e9=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x23a)]],_0x10c059=[_0x3093ce[_0x5c8250(0x24f)]['Secondary_units']],_0x4fcb43=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x1eb)]],_0x4e8006=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x1f9)]],_0x17b129=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x1c7)]],_0x10bd90=[_0x3093ce['body'][_0x5c8250(0x20d)]],_0x302109=[_0x3093ce[_0x5c8250(0x24f)]['production_date']],_0x1386b4=[_0x3093ce[_0x5c8250(0x24f)]['prod_cat']],_0x39faa8=[_0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x24b)]],_0x3076a4=[_0x3093ce['body'][_0x5c8250(0x1f3)]],_0x1ad6e5=[_0x3093ce[_0x5c8250(0x24f)]['second1']];else var _0xb61a4c=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x243)]],_0xdf1d65=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x239)]],_0x3bea54=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x208)]],_0x190ea7=[..._0x3093ce[_0x5c8250(0x24f)]['types']],_0x25c984=[..._0x3093ce[_0x5c8250(0x24f)]['New_Qty_Converted_adj']],_0x4c575d=[..._0x3093ce['body'][_0x5c8250(0x256)]],_0x1c71e9=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x1dc)]],_0x10c059=[..._0x3093ce[_0x5c8250(0x24f)]['Secondary_units']],_0x4fcb43=[..._0x3093ce[_0x5c8250(0x24f)]['prod_code']],_0x4e8006=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x1f9)]],_0x17b129=[..._0x3093ce[_0x5c8250(0x24f)]['expiry_date']],_0x10bd90=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x20d)]],_0x302109=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x221)]],_0x1386b4=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x21e)]],_0x39faa8=[..._0x3093ce[_0x5c8250(0x24f)][_0x5c8250(0x24b)]],_0x3076a4=[..._0x3093ce['body'][_0x5c8250(0x1f3)]],_0x1ad6e5=[..._0x3093ce[_0x5c8250(0x24f)]['second1']];const _0x434ce3=_0xb61a4c[_0x5c8250(0x1ff)](_0x37c817=>{return _0x37c817={'product_name':_0x37c817};});_0xdf1d65['forEach']((_0x45f75d,_0x4372f2)=>{var _0x34c31e=_0x5c8250;_0x39faa8[_0x34c31e(0x19d)]((_0x5d17cb,_0x27ce4e)=>{var _0x3f91ca=_0x34c31e;if(_0x5d17cb==_0x3f91ca(0x1f7)&&_0x4372f2==_0x27ce4e){var _0x26014f=_0x45f75d[_0x3f91ca(0x1e0)](0x3);_0x434ce3[_0x4372f2]['storage']=_0x45f75d[0x0],_0x434ce3[_0x4372f2][_0x3f91ca(0x1d1)]=_0x45f75d[0x1],_0x434ce3[_0x4372f2][_0x3f91ca(0x1f8)]=0x0,_0x434ce3[_0x4372f2][_0x3f91ca(0x25b)]=0x0,_0x434ce3[_0x4372f2][_0x3f91ca(0x242)]=_0x3f91ca(0x25f),_0x434ce3[_0x4372f2][_0x3f91ca(0x1ec)]=_0x26014f;}else{if(_0x5d17cb=='Shelves'&&_0x4372f2==_0x27ce4e){var _0x26014f=_0x45f75d['slice'](0x3);_0x434ce3[_0x4372f2][_0x3f91ca(0x1b7)]=_0x45f75d[0x0],_0x434ce3[_0x4372f2]['rack']=_0x45f75d[0x1],_0x434ce3[_0x4372f2]['bay']=0x0,_0x434ce3[_0x4372f2]['bin']=0x0,_0x434ce3[_0x4372f2][_0x3f91ca(0x242)]='Floor',_0x434ce3[_0x4372f2][_0x3f91ca(0x1ec)]=_0x45f75d[0x5];}else{if(_0x4372f2==_0x27ce4e){var _0x7645c0;if(_0x45f75d[0x4]=='L')_0x7645c0=_0x3f91ca(0x1ab);else _0x45f75d[0x4]=='F'&&(_0x7645c0=_0x3f91ca(0x25f));_0x434ce3[_0x4372f2][_0x3f91ca(0x1b7)]=_0x45f75d[0x0],_0x434ce3[_0x4372f2][_0x3f91ca(0x1d1)]=_0x45f75d[0x1],_0x434ce3[_0x4372f2][_0x3f91ca(0x1f8)]=_0x45f75d[0x2],_0x434ce3[_0x4372f2][_0x3f91ca(0x25b)]=_0x45f75d[0x3],_0x434ce3[_0x4372f2][_0x3f91ca(0x242)]=_0x7645c0,_0x434ce3[_0x4372f2][_0x3f91ca(0x1ec)]=_0x45f75d[0x5];}}}});}),_0x3bea54[_0x5c8250(0x19d)]((_0x10805a,_0x121d66)=>{var _0x25d3fe=_0x5c8250;_0x434ce3[_0x121d66][_0x25d3fe(0x248)]=_0x10805a;}),_0x190ea7[_0x5c8250(0x19d)]((_0x584cdf,_0x9262c)=>{_0x434ce3[_0x9262c]['types']=_0x584cdf;}),_0x25c984[_0x5c8250(0x19d)]((_0x102e73,_0x1f9416)=>{_0x434ce3[_0x1f9416]['adjust_qty']=_0x102e73;}),_0x4c575d[_0x5c8250(0x19d)]((_0x18b21f,_0x2b11a2)=>{_0x434ce3[_0x2b11a2]['new_adjust_qty']=_0x18b21f;}),_0x1c71e9['forEach']((_0x530d1c,_0x4982b3)=>{_0x434ce3[_0x4982b3]['unit']=_0x530d1c;}),_0x10c059[_0x5c8250(0x19d)]((_0x55c583,_0x5beab0)=>{var _0x1bea7c=_0x5c8250;_0x434ce3[_0x5beab0][_0x1bea7c(0x1da)]=_0x55c583;}),_0x4fcb43['forEach']((_0x4feec2,_0x2a1bb5)=>{var _0x345b9f=_0x5c8250;_0x434ce3[_0x2a1bb5][_0x345b9f(0x264)]=_0x4feec2;}),_0x4e8006[_0x5c8250(0x19d)]((_0x179240,_0x33e3fd)=>{var _0x15ae09=_0x5c8250;_0x434ce3[_0x33e3fd][_0x15ae09(0x1f9)]=_0x179240;}),_0x17b129[_0x5c8250(0x19d)]((_0x57d54b,_0x3de7ee)=>{var _0x527e0c=_0x5c8250;_0x434ce3[_0x3de7ee][_0x527e0c(0x1c7)]=_0x57d54b;}),_0x10bd90[_0x5c8250(0x19d)]((_0x243915,_0x8b9bef)=>{var _0x114f33=_0x5c8250;_0x434ce3[_0x8b9bef][_0x114f33(0x197)]=_0x243915;}),_0x302109[_0x5c8250(0x19d)]((_0x37fafa,_0x4712a9)=>{_0x434ce3[_0x4712a9]['production_date']=_0x37fafa;}),_0x1386b4[_0x5c8250(0x19d)]((_0x1090a9,_0x48d344)=>{_0x434ce3[_0x48d344]['prod_cat']=_0x1090a9;}),_0x39faa8[_0x5c8250(0x19d)]((_0x2b3612,_0x31cd9a)=>{_0x434ce3[_0x31cd9a]['room_names']=_0x2b3612;}),_0x3076a4[_0x5c8250(0x19d)]((_0xa539f8,_0x1f5db1)=>{var _0x1de543=_0x5c8250;_0x434ce3[_0x1f5db1][_0x1de543(0x20a)]=_0xa539f8;}),_0x1ad6e5['forEach']((_0x5572a7,_0x2ee5dd)=>{var _0x197f63=_0x5c8250;_0x434ce3[_0x2ee5dd][_0x197f63(0x1a6)]=_0x5572a7;});const _0x124bb2=_0x434ce3[_0x5c8250(0x244)](_0x31fd52=>_0x31fd52[_0x5c8250(0x1d8)]!=='0'&&_0x31fd52[_0x5c8250(0x1d8)]!=='');var _0x21deb9=0x0;_0x124bb2[_0x5c8250(0x19d)](_0x43b3be=>{console['log']('foreach\x20newproduct',_0x43b3be),parseInt(_0x43b3be['adjust_qty'])<=0x0&&_0x21deb9++;});if(_0x21deb9!=0x0)return _0x3093ce[_0x5c8250(0x20c)](_0x5c8250(0x19e),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x27e5f5['redirect']('back');_0x565f2f['warehouse_name']=_0x1febb4,_0x565f2f[_0x5c8250(0x1d0)]=_0x40574a,_0x565f2f[_0x5c8250(0x26e)]=_0x124bb2,_0x565f2f[_0x5c8250(0x220)]=_0x5630fd,_0x565f2f[_0x5c8250(0x1c9)]=_0x56b08b,_0x565f2f[_0x5c8250(0x1f1)]='False';const _0x5e9007=await _0x565f2f[_0x5c8250(0x258)]();_0x3093ce[_0x5c8250(0x20c)](_0x5c8250(0x1aa),'adjustment\x20data\x20update\x20successfully'),_0x27e5f5[_0x5c8250(0x1d5)](_0x5c8250(0x227));}catch(_0x59c872){console[_0x5c8250(0x25a)](_0x59c872);}}),router[a0_0x579bb6(0x1b1)](a0_0x579bb6(0x20b),async(_0xedf1df,_0x1c2717)=>{var _0x46b03d=a0_0x579bb6;const {primary_code:_0x9c4f34,warehouse_data:_0x2a87ce,rooms_data:_0x324c29,Roomslist:_0x47caad}=_0xedf1df['body'],_0x29736d=_0x47caad[_0x46b03d(0x25d)](','),_0x564272=[];async function _0x52a2da(_0x434aa1){var _0x444a3d=_0x46b03d;const _0x4e2e4f=await warehouse[_0x444a3d(0x1e3)]([{'$match':{'name':_0x2a87ce,'room':_0x434aa1}},{'$unwind':_0x444a3d(0x240)},{'$match':{'product_details.primary_code':_0x9c4f34}},{'$group':{'_id':_0x444a3d(0x1ee),'name':{'$first':_0x444a3d(0x22f)},'product_stock':{'$first':_0x444a3d(0x1a4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x444a3d(0x1a8)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x444a3d(0x1d7)},'pallet':{'$first':_0x444a3d(0x266)},'unit':{'$first':_0x444a3d(0x22c)},'secondary_unit':{'$first':_0x444a3d(0x19c)},'storage':{'$first':_0x444a3d(0x1cd)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x444a3d(0x218)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x444a3d(0x251)},'batch_code':{'$first':_0x444a3d(0x212)},'product_cat':{'$first':_0x444a3d(0x1ac)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x444a3d(0x203)},'invoice':{'$first':_0x444a3d(0x1bf)}}}]),_0x281d7a=await warehouse['aggregate']([{'$match':{'name':_0x2a87ce,'room':_0x434aa1}},{'$unwind':_0x444a3d(0x240)},{'$match':{'product_details.secondary_code':_0x9c4f34}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x444a3d(0x1a4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x444a3d(0x1a8)},'product_code':{'$first':_0x444a3d(0x228)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x444a3d(0x1d7)},'pallet':{'$first':_0x444a3d(0x266)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x444a3d(0x19c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x444a3d(0x1b5)},'expiry_date':{'$first':_0x444a3d(0x218)},'production_date':{'$first':_0x444a3d(0x26b)},'maxPerUnit':{'$first':_0x444a3d(0x251)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x444a3d(0x203)}}}]);if(_0x4e2e4f[_0x444a3d(0x1fb)]>0x0)_0x564272[_0x444a3d(0x255)](_0x4e2e4f);else _0x281d7a[_0x444a3d(0x1fb)]>0x0&&_0x564272[_0x444a3d(0x255)](_0x281d7a);}const _0x599715=_0x29736d[_0x46b03d(0x1ff)](_0x1fc0e5=>_0x52a2da(_0x1fc0e5));await Promise[_0x46b03d(0x237)](_0x599715),_0x1c2717[_0x46b03d(0x23e)](_0x564272);}),router[a0_0x579bb6(0x1b1)](a0_0x579bb6(0x1a7),async(_0x190777,_0x11a50d)=>{var _0x5aceff=a0_0x579bb6;const {primaryCode:_0x5abfcc,secondaryCode:_0x283fb6,productCode:_0x2fbaf4,level:_0x36bab7,isle:_0x48483b,pallet:_0x406901,warehouses:_0x56fda8,room:_0x2d4ad4}=_0x190777[_0x5aceff(0x24f)];try{const _0xe9db6d=await warehouse['aggregate']([{'$match':{'name':_0x56fda8,'room':_0x2d4ad4}},{'$unwind':_0x5aceff(0x240)},{'$match':{'product_details.level':parseInt(_0x36bab7),'product_details.isle':_0x48483b,'product_details.pallet':parseInt(_0x406901)}},{'$group':{'_id':_0x5aceff(0x1ee),'name':{'$first':_0x5aceff(0x22f)},'product_stock':{'$first':_0x5aceff(0x1a4)},'level':{'$first':_0x5aceff(0x263)},'isle':{'$first':_0x5aceff(0x26a)},'pallet':{'$first':_0x5aceff(0x234)},'maxProducts':{'$first':_0x5aceff(0x1b2)}}}]);_0x11a50d[_0x5aceff(0x247)](0xc8)[_0x5aceff(0x23e)](_0xe9db6d);}catch(_0x4cd949){_0x11a50d[_0x5aceff(0x247)](0x194)[_0x5aceff(0x23e)]({'message':_0x4cd949['message']});}}),module[a0_0x579bb6(0x257)]=router;