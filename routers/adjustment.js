function a0_0x2e34(_0x2dd85a,_0x47959e){var _0x2b299f=a0_0x2b29();return a0_0x2e34=function(_0x2e3499,_0x4f2047){_0x2e3499=_0x2e3499-0x97;var _0x21c828=_0x2b299f[_0x2e3499];return _0x21c828;},a0_0x2e34(_0x2dd85a,_0x47959e);}var a0_0x1b90ef=a0_0x2e34;(function(_0x364550,_0x44b69b){var _0x518132=a0_0x2e34,_0x1d463a=_0x364550();while(!![]){try{var _0x44c865=parseInt(_0x518132(0x138))/0x1+parseInt(_0x518132(0x165))/0x2*(parseInt(_0x518132(0xfa))/0x3)+parseInt(_0x518132(0x152))/0x4*(parseInt(_0x518132(0xb6))/0x5)+parseInt(_0x518132(0x98))/0x6*(parseInt(_0x518132(0x118))/0x7)+-parseInt(_0x518132(0x126))/0x8*(parseInt(_0x518132(0x16c))/0x9)+parseInt(_0x518132(0x132))/0xa+parseInt(_0x518132(0x162))/0xb*(-parseInt(_0x518132(0x155))/0xc);if(_0x44c865===_0x44b69b)break;else _0x1d463a['push'](_0x1d463a['shift']());}catch(_0x3a1803){_0x1d463a['push'](_0x1d463a['shift']());}}}(a0_0x2b29,0xe020f));const express=require(a0_0x1b90ef(0xc8)),app=express(),router=express[a0_0x1b90ef(0x15c)](),auth=require(a0_0x1b90ef(0x102)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x1b90ef(0xa4)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x1b90ef(0xfe));router[a0_0x1b90ef(0xca)](a0_0x1b90ef(0xea),auth,async(_0x12a028,_0x5c204d)=>{var _0x4925cc=a0_0x1b90ef;try{const {username:_0xe737d5,email:_0x23a5ae,role:_0x3cb66e}=_0x12a028['user'],_0x4b955d=_0x12a028['user'],_0x596ea3=await profile[_0x4925cc(0xa2)]({'email':_0x4b955d['email']}),_0x39af2d=await master_shop['find']();console[_0x4925cc(0x117)]('master',_0x39af2d);let _0x57ade7;if(_0x4b955d[_0x4925cc(0x9a)]==_0x4925cc(0xf4)){const _0xad4713=await staff[_0x4925cc(0xa2)]({'email':_0x4b955d[_0x4925cc(0x146)]});_0x57ade7=await warehouse[_0x4925cc(0x153)]({'status':_0x4925cc(0x10e),'name':_0xad4713[_0x4925cc(0x148)]});}else _0x57ade7=await warehouse['find']({'status':'Enabled'});const _0x276284=await product[_0x4925cc(0x153)]();let _0xd18044;if(_0x4b955d['role']=='staff'){const _0x33001e=await staff['findOne']({'email':_0x4b955d[_0x4925cc(0x146)]});_0xd18044=await adjustment['find']({'warehouse_name':_0x33001e[_0x4925cc(0x148)]});}else _0xd18044=await adjustment['aggregate']([{'$unwind':_0x4925cc(0xa0)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4925cc(0x11b)},'date':{'$first':_0x4925cc(0x14d)},'warehouse_name':{'$first':_0x4925cc(0xd1)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x4925cc(0x163)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x39af2d[0x0][_0x4925cc(0x14f)]==_0x4925cc(0xc6)){var _0x10b6bd=users[_0x4925cc(0x103)];console[_0x4925cc(0x117)](_0x10b6bd);}else{if(_0x39af2d[0x0][_0x4925cc(0x14f)]==_0x4925cc(0xaf))var _0x10b6bd=users[_0x4925cc(0xaf)];else{if(_0x39af2d[0x0][_0x4925cc(0x14f)]==_0x4925cc(0x144))var _0x10b6bd=users[_0x4925cc(0x144)];else{if(_0x39af2d[0x0][_0x4925cc(0x14f)]=='Spanish')var _0x10b6bd=users[_0x4925cc(0x107)];else{if(_0x39af2d[0x0][_0x4925cc(0x14f)]==_0x4925cc(0xcb))var _0x10b6bd=users[_0x4925cc(0xcb)];else{if(_0x39af2d[0x0]['language']=='Portuguese\x20(BR)')var _0x10b6bd=users[_0x4925cc(0x11a)];else{if(_0x39af2d[0x0][_0x4925cc(0x14f)]==_0x4925cc(0x10a))var _0x10b6bd=users['Chinese'];else{if(_0x39af2d[0x0][_0x4925cc(0x14f)]==_0x4925cc(0x150))var _0x10b6bd=users['Arabic'];}}}}}}}_0x5c204d[_0x4925cc(0x123)](_0x4925cc(0x166),{'success':_0x12a028[_0x4925cc(0x157)](_0x4925cc(0xe2)),'errors':_0x12a028['flash'](_0x4925cc(0x16d)),'role':_0x4b955d,'profile':_0x596ea3,'warehouse':_0x57ade7,'product':_0x276284,'adjustment':_0xd18044,'master_shop':_0x39af2d,'language':_0x10b6bd});}catch(_0x45261f){console[_0x4925cc(0x117)](_0x45261f);}});async function getRandom8DigitNumber(){var _0x1929e1=a0_0x1b90ef;const _0x36426e=0x989680,_0xce5b83=0x5f5e0ff,_0x3b0aae=Math[_0x1929e1(0xff)](Math[_0x1929e1(0x120)]()*(_0xce5b83-_0x36426e+0x1))+_0x36426e;var _0x26ee79;const _0x3aa54c=await adjustment['findOne']({'invoice':'ADJ-'+_0x3b0aae});return _0x3aa54c&&_0x3aa54c['length']>0x0?_0x26ee79=_0x1929e1(0xd7)+_0x3b0aae:_0x26ee79=_0x1929e1(0xd7)+_0x3b0aae,_0x26ee79;}function a0_0x2b29(){var _0x77c7ab=['<div>','Arabic','toString','map','$date','level','language','Arabic\x20(ae)','product_code','39660RizFMG','find','Receiving\x20Area','24SSZFhl','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','flash','<span\x20style=\x22float:\x20right;\x22>','An\x20error\x20occurred.','</div>','adjustment\x20add\x20successfull','Router','<html><head><title></title>','room','push','$product_details.storage','<table\x20style=\x22width:\x20100%\x20!important;\x22>','26013251KFKZcT','$isAllowEdit','json','2csaWPu','adjustment','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','site_title','types','</span>','prod_cat','198VzsKAS','errors','$product_details.floorlevel','status','params','156wWHiDP','batch_code','role','createTransport','user','</thead>','/CheckingWarehouse','adjustment\x20data\x20update\x20successfully','$product','bin','findOne','</h5>','../models/all_models','image','</head><body>','Shelves','$product_details.bay','new_adjust_qty','date','$product_details.product_cat','bay','$product_details.unit','sendMail','Hindi','save','length','product_name','warehouse_name','host','$product_details.batch_code','705ASCLYM','Raw\x20Materials','/view/:id','redirect','back','product','\x20Order\x20Date\x20:\x20','</tr>','room_names','maxperunit','False','finalize','Adjustment\x20Mail','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/adjustment/view','$product_details.product_stock','English\x20(US)','$product_details.type','express','split','get','French','<!DOCTYPE\x20html>','product_details','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</table>','body','$warehouse_name','$product_details.secondary_code','$product_details.primary_code','secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','second1','ADJ-','Portuguese\x20(BR)','Email\x20sent\x20successfully','$product_details.secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','secondary_unit','$product_details.product_name','An\x20error\x20occurred\x20while\x20saving\x20data.','Return\x20Rooms','add_adjustment','$room','success','<tr>','RMSEmail','rack','stock','\x20<>\x20','Error\x20Occurs','invoice','/view','port','</body></html>','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.production_date','unit','$name','stockBefore','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','max_per_unit','\x20Order\x20Number\x20:\x20','Secondary_units','padStart','5130606CxNbFg','floorlevel','product_stock','/preview/:id','nodemailer','floor','exports','Return\x20Goods','../middleware/auth','English','edit_adjustment_view','message','post','Spanish','maxPerUnit','catch','Chinese','then','$product_details.maxPerUnit','isAllowEdit','Enabled','logo','edit_adjustment','aggregate','Ambient','adjustment\x20Finalized\x20successfully','New_Qty_Converted_adj','forEach','Rooms','log','483028qIUMrF','slice','Portuguese','$invoice','</td>','adjust_qty','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<hr\x20class=\x22my-3\x22>','random','expiry_date','error','render','findById','$product_details.product_code','169288ALfEHQ','/adjustment/preview/','string','/picking_list/PDF_adjustment_rm/','$product_details.bin','_id','$product_details.rack','prod_name','prime1','/barcode_scanner','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.maxProducts','8148800cYFyZE','$product.product_name','all','New_Qty_Converted','foreach\x20newproduct','production_date','396054EbVMym','$product_details.expiry_date','type','Level','Primary_Units','Floor','prod_invoice','filter','<h5\x20style=\x22text-align:\x20left;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','storage','$product_details','German','\x20</h2>','email','prod_code','warehouse'];a0_0x2b29=function(){return _0x77c7ab;};return a0_0x2b29();}router[a0_0x1b90ef(0xca)]('/view/add_adjustment',auth,async(_0x4fea98,_0x53a4fb)=>{var _0x366b29=a0_0x1b90ef;try{const {username:_0x49dcb2,email:_0xc5a332,role:_0x3af041}=_0x4fea98['user'],_0x1331c8=_0x4fea98[_0x366b29(0x9c)],_0x9fc337=await profile[_0x366b29(0xa2)]({'email':_0x1331c8[_0x366b29(0x146)]}),_0xb262d2=await master_shop[_0x366b29(0x153)]();let _0x5201f5;if(_0x1331c8[_0x366b29(0x9a)]=='staff'){const _0x46e950=await staff[_0x366b29(0xa2)]({'email':_0x1331c8['email']});_0x5201f5=await warehouse['aggregate']([{'$match':{'status':_0x366b29(0x10e),'name':_0x46e950[_0x366b29(0x148)],'warehouse_category':_0x366b29(0xb7),'name':{'$ne':_0x366b29(0x101)}}},{'$group':{'_id':_0x366b29(0xf2),'name':{'$first':_0x366b29(0xf2)}}}]);}else _0x5201f5=await warehouse[_0x366b29(0x111)]([{'$match':{'status':_0x366b29(0x10e),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x366b29(0x101)}}},{'$group':{'_id':_0x366b29(0xf2),'name':{'$first':_0x366b29(0xf2)}}}]);const _0x33fe5c=await product[_0x366b29(0x153)]({}),_0x5d3286=await adjustment[_0x366b29(0x153)]({}),_0x15c42c=_0x5d3286[_0x366b29(0xb1)]+0x1,_0x36184c=_0x366b29(0xd7)+_0x15c42c[_0x366b29(0x14b)]()[_0x366b29(0xf9)](0x5,'0');var _0x349fc0=[_0x366b29(0x112),'Enclosed',_0x366b29(0xdf)];if(_0xb262d2[0x0][_0x366b29(0x14f)]==_0x366b29(0xc6))var _0x43f8e2=users[_0x366b29(0x103)];else{if(_0xb262d2[0x0]['language']==_0x366b29(0xaf))var _0x43f8e2=users['Hindi'];else{if(_0xb262d2[0x0]['language']==_0x366b29(0x144))var _0x43f8e2=users[_0x366b29(0x144)];else{if(_0xb262d2[0x0][_0x366b29(0x14f)]==_0x366b29(0x107))var _0x43f8e2=users[_0x366b29(0x107)];else{if(_0xb262d2[0x0][_0x366b29(0x14f)]==_0x366b29(0xcb))var _0x43f8e2=users[_0x366b29(0xcb)];else{if(_0xb262d2[0x0][_0x366b29(0x14f)]==_0x366b29(0xd8))var _0x43f8e2=users[_0x366b29(0x11a)];else{if(_0xb262d2[0x0][_0x366b29(0x14f)]==_0x366b29(0x10a))var _0x43f8e2=users['Chinese'];else{if(_0xb262d2[0x0][_0x366b29(0x14f)]==_0x366b29(0x150))var _0x43f8e2=users[_0x366b29(0x14a)];}}}}}}}const _0x5a3550=getRandom8DigitNumber();_0x5a3550[_0x366b29(0x10b)](_0xf1d962=>{var _0x2f1825=_0x366b29;_0x53a4fb[_0x2f1825(0x123)](_0x2f1825(0xe0),{'success':_0x4fea98[_0x2f1825(0x157)]('success'),'errors':_0x4fea98[_0x2f1825(0x157)]('errors'),'role':_0x1331c8,'profile':_0x9fc337,'warehouse':_0x5201f5,'product':_0x33fe5c,'master_shop':_0xb262d2,'language':_0x43f8e2,'rooms_data':_0x349fc0,'invoice_no':_0xf1d962});})[_0x366b29(0x109)](_0x36f7a4=>{var _0x438c47=_0x366b29;_0x4fea98[_0x438c47(0x157)]('errors',_0x438c47(0x141)),_0x53a4fb[_0x438c47(0xb9)]('/adjustment/view');});}catch(_0xfb9d7d){console['log'](_0xfb9d7d);}}),router['post']('/view/add_adjustment',auth,async(_0x3c474c,_0x125cb5)=>{var _0x9c6a52=a0_0x1b90ef;try{const {warehouse_name:_0x3160d7,date:_0x2af4d3,prod_name:_0x151ec0,level:_0x15ec1b,isle:_0x45cd9a,pallet:_0x6edd9c,stock:_0xa9c8df,types:_0x130156,adjust_qty:_0x1fd344,new_adjust_qty:_0x4cb493,note:_0x38f091,Room_name:_0x33f371,invoice:_0x4dd0cc,JO_number:_0x2fd2d9,expiry_date:_0xe7a251}=_0x3c474c[_0x9c6a52(0xd0)];if(typeof _0x151ec0==_0x9c6a52(0x128))var _0x547736=[_0x3c474c[_0x9c6a52(0xd0)]['prod_name']],_0x23bcb6=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x14e)]],_0x4b5599=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0xe6)]],_0x1c8c88=[_0x3c474c['body'][_0x9c6a52(0x169)]],_0x41c4f8=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x114)]],_0x3e9a52=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x135)]],_0x58954b=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x13c)]],_0x1a276e=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0xf8)]],_0x5e9015=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x147)]],_0x4697f4=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x99)]],_0x1d7017=[_0x3c474c[_0x9c6a52(0xd0)]['expiry_date']],_0x3c5e05=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0xf6)]],_0x2ad6a7=[_0x3c474c['body'][_0x9c6a52(0x137)]],_0x15a982=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x16b)]],_0x2f1b7b=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x116)]],_0x52da89=[_0x3c474c['body'][_0x9c6a52(0x12e)]],_0x34bc7c=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0xd6)]],_0x2eb4d2=[_0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x13e)]];else var _0x547736=[..._0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x12d)]],_0x23bcb6=[..._0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x14e)]],_0x4b5599=[..._0x3c474c['body'][_0x9c6a52(0xe6)]],_0x1c8c88=[..._0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x169)]],_0x41c4f8=[..._0x3c474c[_0x9c6a52(0xd0)]['New_Qty_Converted_adj']],_0x3e9a52=[..._0x3c474c['body'][_0x9c6a52(0x135)]],_0x58954b=[..._0x3c474c['body']['unit']],_0x1a276e=[..._0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0xf8)]],_0x5e9015=[..._0x3c474c['body'][_0x9c6a52(0x147)]],_0x4697f4=[..._0x3c474c[_0x9c6a52(0xd0)]['batch_code']],_0x1d7017=[..._0x3c474c['body']['expiry_date']],_0x3c5e05=[..._0x3c474c['body'][_0x9c6a52(0xf6)]],_0x2ad6a7=[..._0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x137)]],_0x15a982=[..._0x3c474c['body']['prod_cat']],_0x2f1b7b=[..._0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x116)]],_0x52da89=[..._0x3c474c[_0x9c6a52(0xd0)]['prime1']],_0x34bc7c=[..._0x3c474c[_0x9c6a52(0xd0)]['second1']],_0x2eb4d2=[..._0x3c474c[_0x9c6a52(0xd0)][_0x9c6a52(0x13e)]];const _0x261d2c=_0x547736['map'](_0x104083=>{return _0x104083={'product_name':_0x104083};});_0x23bcb6['forEach']((_0x3e3cc0,_0x4d85db)=>{var _0x36c749=_0x9c6a52;_0x2f1b7b[_0x36c749(0x115)]((_0x29f1ef,_0x45ecb4)=>{var _0x3b67b6=_0x36c749;if(_0x29f1ef==_0x3b67b6(0x154)&&_0x4d85db==_0x45ecb4){var _0x16e667=_0x3e3cc0[_0x3b67b6(0x119)](0x3);_0x261d2c[_0x4d85db][_0x3b67b6(0x142)]=_0x3e3cc0[0x0],_0x261d2c[_0x4d85db][_0x3b67b6(0xe5)]=_0x3e3cc0[0x1],_0x261d2c[_0x4d85db][_0x3b67b6(0xac)]=0x0,_0x261d2c[_0x4d85db][_0x3b67b6(0xa1)]=0x0,_0x261d2c[_0x4d85db][_0x3b67b6(0x13a)]=_0x3b67b6(0x13d),_0x261d2c[_0x4d85db][_0x3b67b6(0xfb)]=_0x16e667;}else{if(_0x29f1ef==_0x3b67b6(0xa7)&&_0x4d85db==_0x45ecb4){var _0x16e667=_0x3e3cc0['slice'](0x3);_0x261d2c[_0x4d85db][_0x3b67b6(0x142)]=_0x3e3cc0[0x0],_0x261d2c[_0x4d85db]['rack']=_0x3e3cc0[0x1],_0x261d2c[_0x4d85db][_0x3b67b6(0xac)]=0x0,_0x261d2c[_0x4d85db]['bin']=0x0,_0x261d2c[_0x4d85db][_0x3b67b6(0x13a)]='Floor',_0x261d2c[_0x4d85db][_0x3b67b6(0xfb)]=_0x3e3cc0[0x5];}else{if(_0x4d85db==_0x45ecb4){var _0x2a4240;if(_0x3e3cc0[0x4]=='L')_0x2a4240='Level';else _0x3e3cc0[0x4]=='F'&&(_0x2a4240=_0x3b67b6(0x13d));_0x261d2c[_0x4d85db][_0x3b67b6(0x142)]=_0x3e3cc0[0x0],_0x261d2c[_0x4d85db][_0x3b67b6(0xe5)]=_0x3e3cc0[0x1],_0x261d2c[_0x4d85db][_0x3b67b6(0xac)]=_0x3e3cc0[0x2],_0x261d2c[_0x4d85db][_0x3b67b6(0xa1)]=_0x3e3cc0[0x3],_0x261d2c[_0x4d85db][_0x3b67b6(0x13a)]=_0x2a4240,_0x261d2c[_0x4d85db][_0x3b67b6(0xfb)]=_0x3e3cc0[0x5];}}}});}),_0x4b5599[_0x9c6a52(0x115)]((_0x2bdad9,_0x24ce80)=>{var _0x52fb0a=_0x9c6a52;_0x261d2c[_0x24ce80][_0x52fb0a(0xf3)]=_0x2bdad9;}),_0x1c8c88['forEach']((_0x4a4b0d,_0x34724f)=>{var _0x578c15=_0x9c6a52;_0x261d2c[_0x34724f][_0x578c15(0x169)]=_0x4a4b0d;}),_0x41c4f8['forEach']((_0x57e329,_0x3acfd1)=>{var _0x4b8e41=_0x9c6a52;_0x261d2c[_0x3acfd1][_0x4b8e41(0x11d)]=_0x57e329;}),_0x3e9a52[_0x9c6a52(0x115)]((_0x165d39,_0x4461a1)=>{var _0xe69e30=_0x9c6a52;_0x261d2c[_0x4461a1][_0xe69e30(0xa9)]=_0x165d39;}),_0x58954b[_0x9c6a52(0x115)]((_0x571a79,_0x2e66da)=>{var _0x4e0c65=_0x9c6a52;_0x261d2c[_0x2e66da][_0x4e0c65(0xf1)]=_0x571a79;}),_0x1a276e[_0x9c6a52(0x115)]((_0x5746cf,_0x3bb5fc)=>{var _0x20db48=_0x9c6a52;_0x261d2c[_0x3bb5fc][_0x20db48(0xdc)]=_0x5746cf;}),_0x5e9015[_0x9c6a52(0x115)]((_0x1abb21,_0x39cbf2)=>{var _0x23012d=_0x9c6a52;_0x261d2c[_0x39cbf2][_0x23012d(0x151)]=_0x1abb21;}),_0x4697f4['forEach']((_0x57d1b2,_0x1bf5c2)=>{var _0x587417=_0x9c6a52;_0x261d2c[_0x1bf5c2][_0x587417(0x99)]=_0x57d1b2;}),_0x1d7017[_0x9c6a52(0x115)]((_0x5ef6b9,_0x4d7c4c)=>{var _0x4f05f2=_0x9c6a52;_0x261d2c[_0x4d7c4c][_0x4f05f2(0x121)]=_0x5ef6b9;}),_0x3c5e05[_0x9c6a52(0x115)]((_0x1ca84b,_0x36c6c4)=>{var _0x4775c7=_0x9c6a52;_0x261d2c[_0x36c6c4][_0x4775c7(0xbf)]=_0x1ca84b;}),_0x2ad6a7['forEach']((_0x1324ba,_0x133eb7)=>{_0x261d2c[_0x133eb7]['production_date']=_0x1324ba;}),_0x15a982[_0x9c6a52(0x115)]((_0x4f64ec,_0x20a724)=>{_0x261d2c[_0x20a724]['prod_cat']=_0x4f64ec;}),_0x2f1b7b[_0x9c6a52(0x115)]((_0xd041a8,_0x1c78c4)=>{var _0x5b8060=_0x9c6a52;_0x261d2c[_0x1c78c4][_0x5b8060(0xbe)]=_0xd041a8;}),_0x52da89['forEach']((_0x49e125,_0x26a38b)=>{_0x261d2c[_0x26a38b]['primary_code']=_0x49e125;}),_0x34bc7c['forEach']((_0x429114,_0x4ec829)=>{_0x261d2c[_0x4ec829]['secondary_code']=_0x429114;}),_0x2eb4d2[_0x9c6a52(0x115)]((_0x17e3ae,_0x44a88b)=>{var _0x50288e=_0x9c6a52;_0x261d2c[_0x44a88b][_0x50288e(0xe9)]=_0x17e3ae;});const _0x3e31b7=_0x261d2c[_0x9c6a52(0x13f)](_0x2614d5=>_0x2614d5[_0x9c6a52(0x11d)]!=='0'&&_0x2614d5[_0x9c6a52(0x11d)]!=='');var _0x56f8df=0x0;_0x3e31b7[_0x9c6a52(0x115)](_0x470b3a=>{var _0x3afdbd=_0x9c6a52;console[_0x3afdbd(0x117)](_0x3afdbd(0x136),_0x470b3a),parseInt(_0x470b3a[_0x3afdbd(0x11d)])<=0x0&&_0x56f8df++;});if(_0x56f8df!=0x0)return _0x3c474c[_0x9c6a52(0x157)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x125cb5[_0x9c6a52(0xb9)](_0x9c6a52(0xba));const _0x12cfa9=new adjustment({'warehouse_name':_0x3160d7,'date':_0x2af4d3,'product':_0x3e31b7,'note':_0x38f091,'room':_0x33f371,'invoice':_0x4dd0cc,'JO_number':_0x2fd2d9,'expiry_date':_0xe7a251}),_0x272b2f=await _0x12cfa9[_0x9c6a52(0xb0)]();_0x3c474c[_0x9c6a52(0x157)](_0x9c6a52(0xe2),_0x9c6a52(0x15b)),_0x125cb5['redirect'](_0x9c6a52(0x127)+_0x272b2f[_0x9c6a52(0x12b)]);}catch(_0x38c7e8){console[_0x9c6a52(0x117)](_0x38c7e8),_0x125cb5[_0x9c6a52(0x16f)](0xc8)[_0x9c6a52(0x164)]({'message':_0x38c7e8['message']});}}),router[a0_0x1b90ef(0xca)](a0_0x1b90ef(0xfd),auth,async(_0x132220,_0x414e47)=>{var _0x535a24=a0_0x1b90ef;try{const {username:_0x2a0453,email:_0x587ea6,role:_0x481f70}=_0x132220[_0x535a24(0x9c)],_0xbd1f4f=_0x132220[_0x535a24(0x9c)],_0x358db1=await profile[_0x535a24(0xa2)]({'email':_0xbd1f4f['email']}),_0x175e8=await master_shop[_0x535a24(0x153)](),_0x525daf=_0x132220[_0x535a24(0x97)]['id'],_0x42a04e=await adjustment['findById']({'_id':_0x525daf}),_0x20d3f9=await purchases[_0x535a24(0x111)]([{'$match':{'warehouse_name':_0x42a04e[_0x535a24(0xb3)]}},{'$unwind':_0x535a24(0xa0)},{'$group':{'_id':_0x535a24(0x133)}}]),_0x4d1840=await product[_0x535a24(0x153)]({}),_0x133258=await warehouse[_0x535a24(0x111)]([{'$match':{'name':_0x42a04e[_0x535a24(0xb3)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x535a24(0xdd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x535a24(0xa8)},'bin':{'$first':_0x535a24(0x12a)},'type':{'$first':_0x535a24(0xc7)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x535a24(0xd3)},'secondary_code':{'$first':_0x535a24(0xd2)},'product_code':{'$first':_0x535a24(0x125)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x535a24(0x12c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x535a24(0x139)},'production_date':{'$first':_0x535a24(0xf0)},'batch_code':{'$first':_0x535a24(0xb5)},'room':{'$first':'$room'}}}]);if(_0x175e8[0x0]['language']==_0x535a24(0xc6)){var _0x139a30=users[_0x535a24(0x103)];console[_0x535a24(0x117)](_0x139a30);}else{if(_0x175e8[0x0][_0x535a24(0x14f)]=='Hindi')var _0x139a30=users[_0x535a24(0xaf)];else{if(_0x175e8[0x0]['language']==_0x535a24(0x144))var _0x139a30=users[_0x535a24(0x144)];else{if(_0x175e8[0x0][_0x535a24(0x14f)]==_0x535a24(0x107))var _0x139a30=users[_0x535a24(0x107)];else{if(_0x175e8[0x0][_0x535a24(0x14f)]==_0x535a24(0xcb))var _0x139a30=users[_0x535a24(0xcb)];else{if(_0x175e8[0x0]['language']==_0x535a24(0xd8))var _0x139a30=users[_0x535a24(0x11a)];else{if(_0x175e8[0x0][_0x535a24(0x14f)]==_0x535a24(0x10a))var _0x139a30=users['Chinese'];else{if(_0x175e8[0x0][_0x535a24(0x14f)]=='Arabic\x20(ae)')var _0x139a30=users[_0x535a24(0x14a)];}}}}}}}_0x414e47['render'](_0x535a24(0x104),{'success':_0x132220[_0x535a24(0x157)](_0x535a24(0xe2)),'errors':_0x132220['flash'](_0x535a24(0x16d)),'role':_0xbd1f4f,'profile':_0x358db1,'adjustment':_0x42a04e,'stock':_0x133258,'master_shop':_0x175e8,'warehouse_name':_0x20d3f9,'unit':_0x4d1840,'language':_0x139a30});}catch(_0x3c6b8d){console[_0x535a24(0x117)](_0x3c6b8d),_0x414e47['status'](0xc8)['json']({'message':_0x3c6b8d['message']});}}),router[a0_0x1b90ef(0x106)](a0_0x1b90ef(0xfd),auth,async(_0x192a14,_0x510121)=>{var _0x240204=a0_0x1b90ef;try{const _0xbd286=_0x192a14[_0x240204(0x97)]['id'],{warehouse_name:_0x3ee97c,Room_name:_0xa67ddd}=_0x192a14[_0x240204(0xd0)],_0x43be7c=await adjustment['findById']({'_id':_0xbd286}),_0x349820=_0x43be7c['product'][_0x240204(0x14c)](async _0x504e75=>{var _0x4e6f83=_0x240204;if(_0x504e75[_0x4e6f83(0x11d)]>0x0){var _0x464d90=await warehouse[_0x4e6f83(0xa2)]({'name':_0x3ee97c,'room':_0x504e75[_0x4e6f83(0xbe)],'warehouse_category':_0x4e6f83(0xb7)});const _0x353164=_0x464d90[_0x4e6f83(0xcd)]['map'](_0x434706=>{var _0x4a7c55=_0x4e6f83;if(_0x504e75[_0x4a7c55(0x13a)]=='minus'){if(_0x434706[_0x4a7c55(0xb2)]==_0x504e75[_0x4a7c55(0xb2)]&&_0x434706['floorlevel']==_0x504e75[_0x4a7c55(0xfb)]&&_0x434706['type']==_0x504e75[_0x4a7c55(0x13a)]&&_0x434706[_0x4a7c55(0xa1)]==_0x504e75['bin']&&_0x434706['bay']==_0x504e75[_0x4a7c55(0xac)]&&_0x434706[_0x4a7c55(0xe5)]==_0x504e75[_0x4a7c55(0xe5)]&&_0x434706[_0x4a7c55(0x142)]==_0x504e75[_0x4a7c55(0x142)]&&_0x434706[_0x4a7c55(0x121)]==_0x504e75[_0x4a7c55(0x121)]&&_0x434706[_0x4a7c55(0x99)]==_0x504e75[_0x4a7c55(0x99)]&&_0x434706[_0x4a7c55(0x137)]==_0x504e75[_0x4a7c55(0x137)]&&_0x434706['invoice']==_0x504e75[_0x4a7c55(0xe9)]){var _0x747e33;_0x747e33=_0x504e75[_0x4a7c55(0x11d)],_0x504e75[_0x4a7c55(0x16b)]=='S'&&(_0x747e33=_0x504e75['adjust_qty']),_0x434706['product_stock']=_0x434706[_0x4a7c55(0xfc)]-_0x747e33;}}else{if(_0x434706[_0x4a7c55(0xb2)]==_0x504e75[_0x4a7c55(0xb2)]&&_0x434706['floorlevel']==_0x504e75[_0x4a7c55(0xfb)]&&_0x434706[_0x4a7c55(0x13a)]==_0x504e75[_0x4a7c55(0x13a)]&&_0x434706[_0x4a7c55(0xa1)]==_0x504e75[_0x4a7c55(0xa1)]&&_0x434706[_0x4a7c55(0xac)]==_0x504e75[_0x4a7c55(0xac)]&&_0x434706[_0x4a7c55(0xe5)]==_0x504e75[_0x4a7c55(0xe5)]&&_0x434706[_0x4a7c55(0x142)]==_0x504e75[_0x4a7c55(0x142)]&&_0x434706[_0x4a7c55(0x121)]==_0x504e75['expiry_date']&&_0x434706[_0x4a7c55(0x99)]==_0x504e75[_0x4a7c55(0x99)]&&_0x434706[_0x4a7c55(0x137)]==_0x504e75[_0x4a7c55(0x137)]&&_0x434706[_0x4a7c55(0xe9)]==_0x504e75['invoice']){console[_0x4a7c55(0x117)](_0x504e75);var _0x747e33;_0x747e33=_0x504e75[_0x4a7c55(0x11d)],_0x504e75[_0x4a7c55(0x16b)]=='S'&&(_0x747e33=_0x504e75[_0x4a7c55(0x11d)]),console['log'](_0x747e33+_0x4a7c55(0xe7)+_0x504e75['adjust_qty']+'\x20<>\x20'+_0x434706[_0x4a7c55(0x108)]+_0x4a7c55(0xe7)+_0x504e75[_0x4a7c55(0x16b)]),_0x434706[_0x4a7c55(0xfc)]=_0x434706['product_stock']+_0x747e33;}}});}return _0x464d90;});Promise[_0x240204(0x134)](_0x349820)[_0x240204(0x10b)](async _0x4d5f69=>{var _0x54a0ed=_0x240204;try{for(const _0x409092 of _0x4d5f69){await _0x409092[_0x54a0ed(0xb0)]();}_0x43be7c[_0x54a0ed(0xc1)]='True';const _0x510631=await _0x43be7c[_0x54a0ed(0xb0)](),_0x171376=await master_shop[_0x54a0ed(0x153)](),_0x2f615b=await email_settings[_0x54a0ed(0xa2)](),_0x22e19e=await supervisor_settings[_0x54a0ed(0x153)]();var _0x10ede4=_0x43be7c[_0x54a0ed(0xbb)],_0x16562c='',_0x5207b7;for(_0x5207b7 in _0x10ede4){_0x16562c+='<tr>'+_0x54a0ed(0xc3)+_0x10ede4[_0x5207b7][_0x54a0ed(0xb2)]+_0x54a0ed(0x11c)+_0x54a0ed(0xc3)+_0x10ede4[_0x5207b7][_0x54a0ed(0x151)]+_0x54a0ed(0x11c)+_0x54a0ed(0xc3)+_0x10ede4[_0x5207b7][_0x54a0ed(0x11d)]+'</td>'+_0x54a0ed(0xc3)+_0x10ede4[_0x5207b7][_0x54a0ed(0xf1)]+_0x54a0ed(0x11c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10ede4[_0x5207b7]['secondary_unit']+'</td>'+_0x54a0ed(0xc3)+_0x43be7c['warehouse_name']+_0x54a0ed(0x11c)+_0x54a0ed(0xc3)+_0x10ede4[_0x5207b7]['room_names']+_0x54a0ed(0x11c)+_0x54a0ed(0xc3)+_0x10ede4[_0x5207b7][_0x54a0ed(0x142)]+_0x10ede4[_0x5207b7][_0x54a0ed(0xe5)]+_0x10ede4[_0x5207b7]['bay']+_0x10ede4[_0x5207b7]['bin']+_0x10ede4[_0x5207b7][_0x54a0ed(0x13a)][0x0]+_0x10ede4[_0x5207b7][_0x54a0ed(0xfb)]+'</td>',_0x54a0ed(0xbd);}let _0x1be360=nodemailer[_0x54a0ed(0x9b)]({'host':_0x2f615b[_0x54a0ed(0xb4)],'port':Number(_0x2f615b[_0x54a0ed(0xeb)]),'secure':![],'auth':{'user':_0x2f615b['email'],'pass':_0x2f615b['password']}}),_0x3d9e05={'from':_0x2f615b['email'],'to':_0x22e19e[0x0][_0x54a0ed(0xe4)],'subject':_0x54a0ed(0xc2),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+'/upload/'+_0x171376[0x0][_0x54a0ed(0xa5)],'cid':_0x54a0ed(0x10f)}],'html':_0x54a0ed(0xcc)+_0x54a0ed(0x15d)+_0x54a0ed(0xa6)+_0x54a0ed(0x149)+_0x54a0ed(0x11e)+'<div>'+_0x54a0ed(0xce)+_0x54a0ed(0x15a)+_0x54a0ed(0x149)+'<h2>\x20'+_0x171376[0x0]['site_title']+_0x54a0ed(0x145)+_0x54a0ed(0x15a)+_0x54a0ed(0x15a)+_0x54a0ed(0x11f)+'<div>'+_0x54a0ed(0x140)+_0x54a0ed(0xf7)+_0x43be7c[_0x54a0ed(0xe9)]+'\x20'+_0x54a0ed(0x158)+_0x54a0ed(0xbc)+_0x43be7c[_0x54a0ed(0xaa)]+'\x20'+_0x54a0ed(0x16a)+_0x54a0ed(0xa3)+_0x54a0ed(0x15a)+_0x54a0ed(0x161)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x54a0ed(0xe3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x54a0ed(0xef)+_0x54a0ed(0xdb)+_0x54a0ed(0xf5)+_0x54a0ed(0x167)+_0x54a0ed(0xd5)+_0x54a0ed(0x156)+_0x54a0ed(0x130)+'</tr>'+_0x54a0ed(0x9d)+_0x54a0ed(0xed)+'\x20'+_0x16562c+'\x20'+'</tbody>'+_0x54a0ed(0xcf)+_0x54a0ed(0x149)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x171376[0x0][_0x54a0ed(0x168)]+'</h5>'+_0x54a0ed(0x15a)+_0x54a0ed(0x15a)+_0x54a0ed(0xec)};_0x1be360[_0x54a0ed(0xae)](_0x3d9e05,function(_0x526a1e,_0x455479){var _0x52b77d=_0x54a0ed;_0x526a1e?(console[_0x52b77d(0x117)](_0x526a1e),console[_0x52b77d(0x117)](_0x52b77d(0xe8))):console[_0x52b77d(0x117)](_0x52b77d(0xd9));}),_0x192a14['flash']('success',_0x54a0ed(0x113)),_0x510121[_0x54a0ed(0xb9)](_0x54a0ed(0x129)+_0x510631[_0x54a0ed(0x12b)]);}catch(_0xb68aed){console['error'](_0xb68aed),_0x510121[_0x54a0ed(0x16f)](0x1f4)['json']({'error':_0x54a0ed(0xde)});}})['catch'](_0x4cc6c2=>{var _0x5b815d=_0x240204;console[_0x5b815d(0x122)](_0x4cc6c2),_0x510121[_0x5b815d(0x16f)](0x1f4)[_0x5b815d(0x164)]({'error':_0x5b815d(0x159)});});}catch(_0x235c27){console[_0x240204(0x117)](_0x235c27),_0x510121['status'](0xc8)[_0x240204(0x164)]({'message':_0x235c27[_0x240204(0x105)]});}}),router[a0_0x1b90ef(0xca)](a0_0x1b90ef(0xb8),auth,async(_0x15cff6,_0x3d0f92)=>{var _0x597e97=a0_0x1b90ef;try{const {username:_0x54f20d,email:_0x35866f,role:_0x330368}=_0x15cff6['user'],_0x2874db=_0x15cff6[_0x597e97(0x9c)],_0xae8072=await profile[_0x597e97(0xa2)]({'email':_0x2874db[_0x597e97(0x146)]}),_0x417794=await master_shop[_0x597e97(0x153)](),_0x187abb=_0x15cff6[_0x597e97(0x97)]['id'],_0x3c32e5=await adjustment[_0x597e97(0x124)]({'_id':_0x187abb}),_0x56459c=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3c32e5[_0x597e97(0xb3)]}},{'$unwind':_0x597e97(0xa0)},{'$group':{'_id':_0x597e97(0x133)}}]),_0x127ecb=await product[_0x597e97(0x153)]({}),_0x152a1f=await warehouse[_0x597e97(0x111)]([{'$match':{'name':_0x3c32e5['warehouse_name']}},{'$unwind':_0x597e97(0x143)},{'$group':{'_id':_0x597e97(0xee),'name':{'$first':_0x597e97(0xdd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x597e97(0xa8)},'bin':{'$first':_0x597e97(0x12a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x597e97(0x16e)},'primary_code':{'$first':_0x597e97(0xd3)},'secondary_code':{'$first':_0x597e97(0xd2)},'product_code':{'$first':_0x597e97(0x125)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x597e97(0x12c)},'maxPerUnit':{'$first':_0x597e97(0x10c)},'expiry_date':{'$first':_0x597e97(0x139)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x597e97(0xb5)},'room':{'$first':_0x597e97(0xe1)}}}]);let _0x3eff3c;if(_0x2874db[_0x597e97(0x9a)]==_0x597e97(0xf4)){const _0x242def=await staff[_0x597e97(0xa2)]({'email':_0x2874db[_0x597e97(0x146)]});_0x3eff3c=await warehouse[_0x597e97(0x111)]([{'$match':{'status':'Enabled','name':_0x242def[_0x597e97(0x148)],'warehouse_category':_0x597e97(0xb7),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x597e97(0xf2),'name':{'$first':_0x597e97(0xf2)}}}]);}else _0x3eff3c=await warehouse[_0x597e97(0x111)]([{'$match':{'status':_0x597e97(0x10e),'warehouse_category':_0x597e97(0xb7),'name':{'$ne':_0x597e97(0x101)}}},{'$group':{'_id':_0x597e97(0xf2),'name':{'$first':'$name'}}}]);if(_0x417794[0x0][_0x597e97(0x14f)]==_0x597e97(0xc6)){var _0x41e201=users[_0x597e97(0x103)];console[_0x597e97(0x117)](_0x41e201);}else{if(_0x417794[0x0][_0x597e97(0x14f)]==_0x597e97(0xaf))var _0x41e201=users['Hindi'];else{if(_0x417794[0x0]['language']=='German')var _0x41e201=users[_0x597e97(0x144)];else{if(_0x417794[0x0][_0x597e97(0x14f)]==_0x597e97(0x107))var _0x41e201=users[_0x597e97(0x107)];else{if(_0x417794[0x0][_0x597e97(0x14f)]=='French')var _0x41e201=users['French'];else{if(_0x417794[0x0]['language']==_0x597e97(0xd8))var _0x41e201=users['Portuguese'];else{if(_0x417794[0x0]['language']==_0x597e97(0x10a))var _0x41e201=users[_0x597e97(0x10a)];else{if(_0x417794[0x0][_0x597e97(0x14f)]==_0x597e97(0x150))var _0x41e201=users[_0x597e97(0x14a)];}}}}}}}_0x3d0f92[_0x597e97(0x123)](_0x597e97(0x110),{'success':_0x15cff6[_0x597e97(0x157)](_0x597e97(0xe2)),'errors':_0x15cff6[_0x597e97(0x157)]('errors'),'role':_0x2874db,'profile':_0xae8072,'adjustment':_0x3c32e5,'stock':_0x152a1f,'master_shop':_0x417794,'warehouse_name':_0x56459c,'unit':_0x127ecb,'language':_0x41e201,'warehouse':_0x3eff3c});}catch(_0x37928f){console[_0x597e97(0x117)](_0x37928f),_0x3d0f92[_0x597e97(0x16f)](0xc8)['json']({'message':_0x37928f[_0x597e97(0x105)]});}}),router[a0_0x1b90ef(0x106)](a0_0x1b90ef(0xb8),auth,async(_0x27f16c,_0x5c4e04)=>{var _0x4b62ac=a0_0x1b90ef;try{const _0x38dd87=_0x27f16c[_0x4b62ac(0x97)]['id'],_0x13e4b7=await adjustment[_0x4b62ac(0x124)]({'_id':_0x38dd87}),_0x29758e=await warehouse[_0x4b62ac(0xa2)]({'name':_0x13e4b7[_0x4b62ac(0xb3)],'room':_0x13e4b7[_0x4b62ac(0x15e)]}),{warehouse_name:_0x143bd6,date:_0x252ffb,prod_name:_0x43fbb5,level:_0x57fa98,isle:_0x1ebfa1,pallet:_0x4dd4ce,stock:_0x51f436,types:_0x47a72e,adjust_qty:_0x2f084f,new_adjust_qty:_0x55b947,note:_0x51e087,Room_name:_0x369323,invoice:_0x1c10bb,JO_number:_0xc38f26,expiry_date:_0x37baec}=_0x27f16c['body'];if(typeof _0x43fbb5=='string')var _0x1fde4e=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x12d)]],_0x469885=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x14e)]],_0x227426=[_0x27f16c['body']['stock']],_0x197379=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x169)]],_0x3639de=[_0x27f16c[_0x4b62ac(0xd0)]['New_Qty_Converted_adj']],_0x11e360=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x135)]],_0x429679=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x13c)]],_0x2e4e34=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0xf8)]],_0x418dee=[_0x27f16c['body'][_0x4b62ac(0x147)]],_0x1dc3fe=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x99)]],_0x29788a=[_0x27f16c['body']['expiry_date']],_0x46ed42=[_0x27f16c['body']['max_per_unit']],_0x437117=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x137)]],_0x425186=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x16b)]],_0x5162f4=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x116)]],_0x675b12=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x12e)]],_0x2cd803=[_0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0xd6)]];else var _0x1fde4e=[..._0x27f16c['body'][_0x4b62ac(0x12d)]],_0x469885=[..._0x27f16c['body'][_0x4b62ac(0x14e)]],_0x227426=[..._0x27f16c['body']['stock']],_0x197379=[..._0x27f16c[_0x4b62ac(0xd0)]['types']],_0x3639de=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x114)]],_0x11e360=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x135)]],_0x429679=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0xf1)]],_0x2e4e34=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0xf8)]],_0x418dee=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x147)]],_0x1dc3fe=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x99)]],_0x29788a=[..._0x27f16c['body'][_0x4b62ac(0x121)]],_0x46ed42=[..._0x27f16c[_0x4b62ac(0xd0)]['max_per_unit']],_0x437117=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x137)]],_0x425186=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0x16b)]],_0x5162f4=[..._0x27f16c['body'][_0x4b62ac(0x116)]],_0x675b12=[..._0x27f16c[_0x4b62ac(0xd0)]['prime1']],_0x2cd803=[..._0x27f16c[_0x4b62ac(0xd0)][_0x4b62ac(0xd6)]];const _0x1cc584=_0x1fde4e['map'](_0x1c48cf=>{return _0x1c48cf={'product_name':_0x1c48cf};});_0x469885[_0x4b62ac(0x115)]((_0x82a944,_0x45b6bf)=>{var _0x47689c=_0x4b62ac;_0x5162f4[_0x47689c(0x115)]((_0x1d4fd8,_0x115f6b)=>{var _0x2ad419=_0x47689c;if(_0x1d4fd8==_0x2ad419(0x154)&&_0x45b6bf==_0x115f6b){var _0x2fcded=_0x82a944[_0x2ad419(0x119)](0x3);_0x1cc584[_0x45b6bf][_0x2ad419(0x142)]=_0x82a944[0x0],_0x1cc584[_0x45b6bf]['rack']=_0x82a944[0x1],_0x1cc584[_0x45b6bf][_0x2ad419(0xac)]=0x0,_0x1cc584[_0x45b6bf][_0x2ad419(0xa1)]=0x0,_0x1cc584[_0x45b6bf][_0x2ad419(0x13a)]=_0x2ad419(0x13d),_0x1cc584[_0x45b6bf][_0x2ad419(0xfb)]=_0x2fcded;}else{if(_0x1d4fd8==_0x2ad419(0xa7)&&_0x45b6bf==_0x115f6b){var _0x2fcded=_0x82a944[_0x2ad419(0x119)](0x3);_0x1cc584[_0x45b6bf][_0x2ad419(0x142)]=_0x82a944[0x0],_0x1cc584[_0x45b6bf]['rack']=_0x82a944[0x1],_0x1cc584[_0x45b6bf][_0x2ad419(0xac)]=0x0,_0x1cc584[_0x45b6bf]['bin']=0x0,_0x1cc584[_0x45b6bf]['type']=_0x2ad419(0x13d),_0x1cc584[_0x45b6bf][_0x2ad419(0xfb)]=_0x82a944[0x5];}else{if(_0x45b6bf==_0x115f6b){var _0x3125f7;if(_0x82a944[0x4]=='L')_0x3125f7=_0x2ad419(0x13b);else _0x82a944[0x4]=='F'&&(_0x3125f7='Floor');_0x1cc584[_0x45b6bf][_0x2ad419(0x142)]=_0x82a944[0x0],_0x1cc584[_0x45b6bf][_0x2ad419(0xe5)]=_0x82a944[0x1],_0x1cc584[_0x45b6bf][_0x2ad419(0xac)]=_0x82a944[0x2],_0x1cc584[_0x45b6bf][_0x2ad419(0xa1)]=_0x82a944[0x3],_0x1cc584[_0x45b6bf][_0x2ad419(0x13a)]=_0x3125f7,_0x1cc584[_0x45b6bf][_0x2ad419(0xfb)]=_0x82a944[0x5];}}}});}),_0x227426[_0x4b62ac(0x115)]((_0x31fe88,_0xeb9eba)=>{var _0x51628e=_0x4b62ac;_0x1cc584[_0xeb9eba][_0x51628e(0xf3)]=_0x31fe88;}),_0x197379[_0x4b62ac(0x115)]((_0x538225,_0x164671)=>{var _0x7eadbf=_0x4b62ac;_0x1cc584[_0x164671][_0x7eadbf(0x169)]=_0x538225;}),_0x3639de[_0x4b62ac(0x115)]((_0x1fef67,_0x1fb73a)=>{var _0x4d8076=_0x4b62ac;_0x1cc584[_0x1fb73a][_0x4d8076(0x11d)]=_0x1fef67;}),_0x11e360['forEach']((_0x5b50ea,_0x176f02)=>{var _0x2b8c34=_0x4b62ac;_0x1cc584[_0x176f02][_0x2b8c34(0xa9)]=_0x5b50ea;}),_0x429679[_0x4b62ac(0x115)]((_0x3f27ec,_0x2641c7)=>{var _0x269e7d=_0x4b62ac;_0x1cc584[_0x2641c7][_0x269e7d(0xf1)]=_0x3f27ec;}),_0x2e4e34['forEach']((_0x38ca36,_0x32b43a)=>{var _0xf90ef1=_0x4b62ac;_0x1cc584[_0x32b43a][_0xf90ef1(0xdc)]=_0x38ca36;}),_0x418dee['forEach']((_0x21efe9,_0x1fe213)=>{var _0x86955b=_0x4b62ac;_0x1cc584[_0x1fe213][_0x86955b(0x151)]=_0x21efe9;}),_0x1dc3fe['forEach']((_0x143cdd,_0xfe61bd)=>{_0x1cc584[_0xfe61bd]['batch_code']=_0x143cdd;}),_0x29788a['forEach']((_0x495b5e,_0x5f32a7)=>{_0x1cc584[_0x5f32a7]['expiry_date']=_0x495b5e;}),_0x46ed42[_0x4b62ac(0x115)]((_0x42f02b,_0x49a6ff)=>{var _0x456cf9=_0x4b62ac;_0x1cc584[_0x49a6ff][_0x456cf9(0xbf)]=_0x42f02b;}),_0x437117[_0x4b62ac(0x115)]((_0x90d222,_0x4a0591)=>{var _0x1da06d=_0x4b62ac;_0x1cc584[_0x4a0591][_0x1da06d(0x137)]=_0x90d222;}),_0x425186[_0x4b62ac(0x115)]((_0xd4eaed,_0x5b12ca)=>{_0x1cc584[_0x5b12ca]['prod_cat']=_0xd4eaed;}),_0x5162f4[_0x4b62ac(0x115)]((_0x44719e,_0x5dad52)=>{_0x1cc584[_0x5dad52]['room_names']=_0x44719e;}),_0x675b12[_0x4b62ac(0x115)]((_0x2b4d35,_0x59408c)=>{_0x1cc584[_0x59408c]['primary_code']=_0x2b4d35;}),_0x2cd803['forEach']((_0x1a00c5,_0x114a13)=>{var _0x50d005=_0x4b62ac;_0x1cc584[_0x114a13][_0x50d005(0xd4)]=_0x1a00c5;});const _0x8bb0cb=_0x1cc584[_0x4b62ac(0x13f)](_0x272e1e=>_0x272e1e['adjust_qty']!=='0'&&_0x272e1e['adjust_qty']!=='');var _0x395d86=0x0;_0x8bb0cb['forEach'](_0xcda26d=>{var _0x1b9d20=_0x4b62ac;console['log'](_0x1b9d20(0x136),_0xcda26d),parseInt(_0xcda26d[_0x1b9d20(0x11d)])<=0x0&&_0x395d86++;});if(_0x395d86!=0x0)return _0x27f16c[_0x4b62ac(0x157)](_0x4b62ac(0x16d),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x5c4e04[_0x4b62ac(0xb9)](_0x4b62ac(0xba));_0x13e4b7[_0x4b62ac(0xb3)]=_0x143bd6,_0x13e4b7[_0x4b62ac(0xaa)]=_0x252ffb,_0x13e4b7['product']=_0x8bb0cb,_0x13e4b7['note']=_0x51e087,_0x13e4b7['invoice']=_0x1c10bb,_0x13e4b7[_0x4b62ac(0x10d)]=_0x4b62ac(0xc0);const _0x4255c1=await _0x13e4b7[_0x4b62ac(0xb0)]();_0x27f16c[_0x4b62ac(0x157)](_0x4b62ac(0xe2),_0x4b62ac(0x9f)),_0x5c4e04['redirect'](_0x4b62ac(0xc4));}catch(_0x958e3){console[_0x4b62ac(0x117)](_0x958e3);}}),router[a0_0x1b90ef(0x106)](a0_0x1b90ef(0x12f),async(_0x17af95,_0x1af0ec)=>{var _0x1463e3=a0_0x1b90ef;const {primary_code:_0x31e264,warehouse_data:_0x3c82a2,rooms_data:_0x3b19d8,Roomslist:_0x326f06}=_0x17af95[_0x1463e3(0xd0)],_0xbcaa13=_0x326f06[_0x1463e3(0xc9)](','),_0x18c991=[];async function _0x2ee5de(_0x2a2b57){var _0x2e889a=_0x1463e3;const _0x2b19c5=await warehouse[_0x2e889a(0x111)]([{'$match':{'name':_0x3c82a2,'room':_0x2a2b57}},{'$unwind':_0x2e889a(0x143)},{'$match':{'product_details.primary_code':_0x31e264}},{'$group':{'_id':_0x2e889a(0xee),'name':{'$first':_0x2e889a(0xdd)},'product_stock':{'$first':_0x2e889a(0xc5)},'primary_code':{'$first':_0x2e889a(0xd3)},'secondary_code':{'$first':_0x2e889a(0xd2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x2e889a(0xa8)},'isle':{'$first':_0x2e889a(0x12a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2e889a(0x16e)},'unit':{'$first':_0x2e889a(0xad)},'secondary_unit':{'$first':_0x2e889a(0xda)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2e889a(0xf0)},'maxPerUnit':{'$first':_0x2e889a(0x10c)},'batch_code':{'$first':_0x2e889a(0xb5)},'product_cat':{'$first':_0x2e889a(0xab)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x33f28d=await warehouse[_0x2e889a(0x111)]([{'$match':{'name':_0x3c82a2,'room':_0x2a2b57}},{'$unwind':_0x2e889a(0x143)},{'$match':{'product_details.secondary_code':_0x31e264}},{'$group':{'_id':_0x2e889a(0xee),'name':{'$first':_0x2e889a(0xdd)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x2e889a(0xd3)},'secondary_code':{'$first':_0x2e889a(0xd2)},'product_code':{'$first':_0x2e889a(0x125)},'level':{'$first':_0x2e889a(0xa8)},'isle':{'$first':_0x2e889a(0x12a)},'type':{'$first':_0x2e889a(0xc7)},'pallet':{'$first':_0x2e889a(0x16e)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2e889a(0xda)},'storage':{'$first':_0x2e889a(0x160)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2e889a(0x139)},'production_date':{'$first':_0x2e889a(0xf0)},'maxPerUnit':{'$first':_0x2e889a(0x10c)},'batch_code':{'$first':_0x2e889a(0xb5)},'product_cat':{'$first':_0x2e889a(0xab)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2e889a(0xe1)}}}]);if(_0x2b19c5[_0x2e889a(0xb1)]>0x0)_0x18c991[_0x2e889a(0x15f)](_0x2b19c5);else _0x33f28d[_0x2e889a(0xb1)]>0x0&&_0x18c991['push'](_0x33f28d);}const _0xcc2dac=_0xbcaa13['map'](_0x48869d=>_0x2ee5de(_0x48869d));await Promise[_0x1463e3(0x134)](_0xcc2dac),_0x1af0ec[_0x1463e3(0x164)](_0x18c991);}),router[a0_0x1b90ef(0x106)](a0_0x1b90ef(0x9e),async(_0x5ac226,_0x54ea56)=>{var _0x484844=a0_0x1b90ef;const {primaryCode:_0xafc941,secondaryCode:_0x16b257,productCode:_0x2ca7a4,level:_0x31e3c9,isle:_0x1456c6,pallet:_0x53f8e5,warehouses:_0x27a102,room:_0x564d2c}=_0x5ac226[_0x484844(0xd0)];try{const _0x2137c4=await warehouse[_0x484844(0x111)]([{'$match':{'name':_0x27a102,'room':_0x564d2c}},{'$unwind':_0x484844(0x143)},{'$match':{'product_details.level':parseInt(_0x31e3c9),'product_details.isle':_0x1456c6,'product_details.pallet':parseInt(_0x53f8e5)}},{'$group':{'_id':_0x484844(0xee),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x484844(0xc5)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x484844(0x131)}}}]);_0x54ea56['status'](0xc8)[_0x484844(0x164)](_0x2137c4);}catch(_0x568acf){_0x54ea56[_0x484844(0x16f)](0x194)['json']({'message':_0x568acf[_0x484844(0x105)]});}}),module[a0_0x1b90ef(0x100)]=router;