var a0_0x1efbcf=a0_0x57d1;(function(_0xc078c2,_0x408d0e){var _0x5b5816=a0_0x57d1,_0x4946cb=_0xc078c2();while(!![]){try{var _0x16eb0b=-parseInt(_0x5b5816(0x20c))/0x1+parseInt(_0x5b5816(0x141))/0x2+-parseInt(_0x5b5816(0x177))/0x3+parseInt(_0x5b5816(0x18f))/0x4+parseInt(_0x5b5816(0x180))/0x5+parseInt(_0x5b5816(0x1a6))/0x6*(parseInt(_0x5b5816(0x198))/0x7)+-parseInt(_0x5b5816(0x184))/0x8*(parseInt(_0x5b5816(0x1fc))/0x9);if(_0x16eb0b===_0x408d0e)break;else _0x4946cb['push'](_0x4946cb['shift']());}catch(_0x1f3964){_0x4946cb['push'](_0x4946cb['shift']());}}}(a0_0x1944,0x82d80));const express=require(a0_0x1efbcf(0x1f9)),app=express(),router=express[a0_0x1efbcf(0x176)](),auth=require(a0_0x1efbcf(0x16b)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x1efbcf(0x144)](a0_0x1efbcf(0x173),auth,async(_0x42d804,_0x5b6ef4)=>{var _0x33ce6f=a0_0x1efbcf;try{const {username:_0x162133,email:_0x5e9ed3,role:_0x1e6124}=_0x42d804[_0x33ce6f(0x1b9)],_0x3c7a83=_0x42d804[_0x33ce6f(0x1b9)],_0x1338b9=await profile[_0x33ce6f(0x189)]({'email':_0x3c7a83[_0x33ce6f(0x16a)]}),_0x24bddc=await master_shop[_0x33ce6f(0x15c)]();console[_0x33ce6f(0x14d)](_0x33ce6f(0x1e8),_0x24bddc);let _0x3d9abd;if(_0x3c7a83[_0x33ce6f(0x160)]==_0x33ce6f(0x1e1)){const _0x4dd3fe=await staff['findOne']({'email':_0x3c7a83[_0x33ce6f(0x16a)]});_0x3d9abd=await warehouse['find']({'status':_0x33ce6f(0x18a),'name':_0x4dd3fe[_0x33ce6f(0x1ce)]});}else _0x3d9abd=await warehouse[_0x33ce6f(0x15c)]({'status':_0x33ce6f(0x18a)});const _0x54aadf=await product[_0x33ce6f(0x15c)]();let _0x18ad7d;if(_0x3c7a83[_0x33ce6f(0x160)]==_0x33ce6f(0x1e1)){const _0x4cd709=await staff[_0x33ce6f(0x189)]({'email':_0x3c7a83[_0x33ce6f(0x16a)]});_0x18ad7d=await adjustment['find']({'warehouse_name':_0x4cd709['warehouse']});}else _0x18ad7d=await adjustment['aggregate']([{'$unwind':_0x33ce6f(0x171)},{'$group':{'_id':_0x33ce6f(0x209),'invoice':{'$first':_0x33ce6f(0x1fb)},'date':{'$first':_0x33ce6f(0x19e)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x33ce6f(0x18c)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x33ce6f(0x19d)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x24bddc[0x0]['language']==_0x33ce6f(0x13d)){var _0x195a74=users[_0x33ce6f(0x16e)];console[_0x33ce6f(0x14d)](_0x195a74);}else{if(_0x24bddc[0x0][_0x33ce6f(0x1c3)]==_0x33ce6f(0x1c7))var _0x195a74=users[_0x33ce6f(0x1c7)];else{if(_0x24bddc[0x0][_0x33ce6f(0x1c3)]==_0x33ce6f(0x1d1))var _0x195a74=users['German'];else{if(_0x24bddc[0x0]['language']=='Spanish')var _0x195a74=users[_0x33ce6f(0x1e2)];else{if(_0x24bddc[0x0][_0x33ce6f(0x1c3)]==_0x33ce6f(0x1cc))var _0x195a74=users[_0x33ce6f(0x1cc)];else{if(_0x24bddc[0x0][_0x33ce6f(0x1c3)]=='Portuguese\x20(BR)')var _0x195a74=users[_0x33ce6f(0x1f7)];else{if(_0x24bddc[0x0]['language']==_0x33ce6f(0x152))var _0x195a74=users[_0x33ce6f(0x152)];else{if(_0x24bddc[0x0]['language']=='Arabic\x20(ae)')var _0x195a74=users[_0x33ce6f(0x1bb)];}}}}}}}_0x5b6ef4['render'](_0x33ce6f(0x1d7),{'success':_0x42d804['flash'](_0x33ce6f(0x1b2)),'errors':_0x42d804[_0x33ce6f(0x1ca)](_0x33ce6f(0x204)),'role':_0x3c7a83,'profile':_0x1338b9,'warehouse':_0x3d9abd,'product':_0x54aadf,'adjustment':_0x18ad7d,'master_shop':_0x24bddc,'language':_0x195a74});}catch(_0x5ed89c){console['log'](_0x5ed89c);}});async function getRandom8DigitNumber(){var _0x221af1=a0_0x1efbcf;const _0x18cc4b=0x989680,_0x56bd96=0x5f5e0ff,_0x2ff1ad=Math[_0x221af1(0x1fe)](Math['random']()*(_0x56bd96-_0x18cc4b+0x1))+_0x18cc4b;var _0x9031a5;const _0x38ce05=await adjustment[_0x221af1(0x189)]({'invoice':_0x221af1(0x150)+_0x2ff1ad});return _0x38ce05&&_0x38ce05[_0x221af1(0x1cf)]>0x0?_0x9031a5=_0x221af1(0x150)+_0x2ff1ad:_0x9031a5='ADJ-'+_0x2ff1ad,_0x9031a5;}function a0_0x57d1(_0x385d48,_0x10484d){var _0x1944a1=a0_0x1944();return a0_0x57d1=function(_0x57d1ee,_0x3892e4){_0x57d1ee=_0x57d1ee-0x139;var _0x1c6d28=_0x1944a1[_0x57d1ee];return _0x1c6d28;},a0_0x57d1(_0x385d48,_0x10484d);}function a0_0x1944(){var _0x1ef654=['date','password','<div>','catch','errors','stock','/view/add_adjustment','expiry_date','$product.product_name','$_id','room','warehouse_name','438431oWDYzs','unit','rack','then','Email\x20sent\x20successfully','English\x20(US)','$product_details._id','Ambient','new_adjust_qty','909970LRLOKW','</h5>','$product_details.storage','get','$product_details.type','findById','An\x20error\x20occurred.','Return\x20Rooms','room_names','save','$product_details.unit','port','log','push','$product_details.floorlevel','ADJ-','$product_details.bay','Chinese','\x20Order\x20Number\x20:\x20','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','logo','max_per_unit','/preview/:id','message','find','forEach','<h5\x20style=\x22text-align:\x20left;\x22>','$product_details.maxProducts','role','product_name','New_Qty_Converted_adj','storage','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Level','$product_details.expiry_date','second1','error','<tr>','email','../middleware/auth','primary_code','aggregate','English','prime1','foreach\x20newproduct','$product','params','/view','_id','$product_details.rack','Router','1477830anZvbq','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.batch_code','$product_details.pallet','$product_details.product_cat','</body></html>','image','edit_adjustment','2849025vvGCDI','body','Rooms','status','3615400VPgREX','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$name','prod_invoice','findOne','Enabled','True','$product.room_names','production_date','product','2674576jMfDNp','secondary_unit','floorlevel','batch_code','post','$product_details.maxPerUnit','level','map','$product_details.invoice','526092axoZVl','id_transaction_from','$product_details.bin','id_transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$isAllowEdit','$date','back','$product_details.product_name','$product_details.product_code','/picking_list/PDF_adjustment_rm/','Primary_Units','</tbody>','stockBefore','18OTcSIV','adjustment\x20data\x20update\x20successfully','Floor','secondary_code','False','<html><head><title></title>','slice','note','types','finalize','</td>','$product_details.production_date','success','render','bin','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','maxperunit','/view/:id','</thead>','user','$product_details','Arabic','product_stock','string','$room','$product_details.product_stock','$product_details.secondary_code','An\x20error\x20occurred\x20while\x20saving\x20data.','/upload/','language','json','/adjustment/preview/','adjust_qty','Hindi','Return\x20Goods','</tr>','flash','redirect','French','<span\x20style=\x22float:\x20right;\x22>','warehouse','length','Adjustment\x20Mail','German','site_title','Secondary_units','/../public','prod_name','minus','adjustment','Arabic\x20(ae)','add_adjustment','createTransport','product_code','<h5>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<h2>\x20','<hr\x20class=\x22my-3\x22>','exports','staff','Spanish','<table\x20style=\x22width:\x20100%\x20!important;\x22>','prod_code','Portuguese\x20(BR)','New_Qty_Converted','prod_cat','master','bay','all','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','\x20<>\x20','Shelves','type','Receiving\x20Area','filter','isAllowEdit','padStart','</head><body>','$product_details.isle','Raw\x20Materials','/adjustment/view','Portuguese','sendMail','express','\x20Order\x20Date\x20:\x20','$invoice','9OOUsTu','$product_details.primary_code','floor','adjustment\x20Finalized\x20successfully'];a0_0x1944=function(){return _0x1ef654;};return a0_0x1944();}router['get'](a0_0x1efbcf(0x206),auth,async(_0xa7ca0b,_0x49a035)=>{var _0x30ff32=a0_0x1efbcf;try{const {username:_0x392d68,email:_0x19f773,role:_0x120bb7}=_0xa7ca0b[_0x30ff32(0x1b9)],_0x16979c=_0xa7ca0b['user'],_0x577b89=await profile['findOne']({'email':_0x16979c[_0x30ff32(0x16a)]}),_0x431831=await master_shop['find']();let _0x5707b3;if(_0x16979c[_0x30ff32(0x160)]==_0x30ff32(0x1e1)){const _0x50434c=await staff['findOne']({'email':_0x16979c['email']});_0x5707b3=await warehouse[_0x30ff32(0x16d)]([{'$match':{'status':'Enabled','name':_0x50434c[_0x30ff32(0x1ce)],'warehouse_category':_0x30ff32(0x1f5),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x30ff32(0x187),'name':{'$first':_0x30ff32(0x187)}}}]);}else _0x5707b3=await warehouse['aggregate']([{'$match':{'status':_0x30ff32(0x18a),'warehouse_category':_0x30ff32(0x1f5),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x30ff32(0x187),'name':{'$first':_0x30ff32(0x187)}}}]);const _0x58d4ee=await product[_0x30ff32(0x15c)]({}),_0x43fc39=await adjustment[_0x30ff32(0x15c)]({}),_0x5281dd=_0x43fc39['length']+0x1,_0x30de6f=_0x30ff32(0x150)+_0x5281dd['toString']()[_0x30ff32(0x1f2)](0x5,'0');var _0x220cff=[_0x30ff32(0x13f),'Enclosed',_0x30ff32(0x148)];if(_0x431831[0x0][_0x30ff32(0x1c3)]==_0x30ff32(0x13d))var _0x4142ad=users[_0x30ff32(0x16e)];else{if(_0x431831[0x0][_0x30ff32(0x1c3)]=='Hindi')var _0x4142ad=users[_0x30ff32(0x1c7)];else{if(_0x431831[0x0][_0x30ff32(0x1c3)]=='German')var _0x4142ad=users[_0x30ff32(0x1d1)];else{if(_0x431831[0x0][_0x30ff32(0x1c3)]=='Spanish')var _0x4142ad=users['Spanish'];else{if(_0x431831[0x0][_0x30ff32(0x1c3)]==_0x30ff32(0x1cc))var _0x4142ad=users[_0x30ff32(0x1cc)];else{if(_0x431831[0x0]['language']==_0x30ff32(0x1e5))var _0x4142ad=users[_0x30ff32(0x1f7)];else{if(_0x431831[0x0][_0x30ff32(0x1c3)]=='Chinese')var _0x4142ad=users['Chinese'];else{if(_0x431831[0x0][_0x30ff32(0x1c3)]==_0x30ff32(0x1d8))var _0x4142ad=users[_0x30ff32(0x1bb)];}}}}}}}const _0x260c3f=getRandom8DigitNumber();_0x260c3f['then'](_0x30489a=>{var _0x178dd0=_0x30ff32;_0x49a035['render'](_0x178dd0(0x1d9),{'success':_0xa7ca0b[_0x178dd0(0x1ca)]('success'),'errors':_0xa7ca0b[_0x178dd0(0x1ca)]('errors'),'role':_0x16979c,'profile':_0x577b89,'warehouse':_0x5707b3,'product':_0x58d4ee,'master_shop':_0x431831,'language':_0x4142ad,'rooms_data':_0x220cff,'invoice_no':_0x30489a});})[_0x30ff32(0x203)](_0x40c432=>{var _0x1226a8=_0x30ff32;_0xa7ca0b[_0x1226a8(0x1ca)](_0x1226a8(0x204),_0x1226a8(0x1dd)),_0x49a035[_0x1226a8(0x1cb)](_0x1226a8(0x1f6));});}catch(_0x54fd02){console[_0x30ff32(0x14d)](_0x54fd02);}}),router['post']('/view/add_adjustment',auth,async(_0x5a2027,_0x4c03db)=>{var _0x33a324=a0_0x1efbcf;try{const {warehouse_name:_0x2781a3,date:_0x13c423,prod_name:_0x5f53e6,level:_0x3fbb2e,isle:_0x27da7b,pallet:_0x2e1065,stock:_0x323379,types:_0x329976,adjust_qty:_0x5392a6,new_adjust_qty:_0x183e38,note:_0x146b81,Room_name:_0x56089d,invoice:_0x6c0c76,JO_number:_0x2a7f5b,expiry_date:_0x321400}=_0x5a2027['body'];if(typeof _0x5f53e6=='string')var _0xd4bf82=[_0x5a2027[_0x33a324(0x181)][_0x33a324(0x1d5)]],_0x1aa680=[_0x5a2027[_0x33a324(0x181)][_0x33a324(0x195)]],_0x1996cf=[_0x5a2027[_0x33a324(0x181)]['stock']],_0x16bb85=[_0x5a2027[_0x33a324(0x181)]['types']],_0x161f5b=[_0x5a2027[_0x33a324(0x181)][_0x33a324(0x162)]],_0x1f394a=[_0x5a2027['body']['New_Qty_Converted']],_0x59d027=[_0x5a2027['body'][_0x33a324(0x1a3)]],_0x401a3b=[_0x5a2027['body'][_0x33a324(0x1d3)]],_0x5433d7=[_0x5a2027[_0x33a324(0x181)]['prod_code']],_0x36be71=[_0x5a2027[_0x33a324(0x181)][_0x33a324(0x192)]],_0x43a622=[_0x5a2027[_0x33a324(0x181)]['expiry_date']],_0x5d8b52=[_0x5a2027[_0x33a324(0x181)][_0x33a324(0x159)]],_0x2ae77d=[_0x5a2027[_0x33a324(0x181)][_0x33a324(0x18d)]],_0x2735d6=[_0x5a2027['body'][_0x33a324(0x1e7)]],_0x316154=[_0x5a2027['body'][_0x33a324(0x182)]],_0x365847=[_0x5a2027[_0x33a324(0x181)][_0x33a324(0x16f)]],_0x30fbfd=[_0x5a2027[_0x33a324(0x181)]['second1']],_0x556c64=[_0x5a2027['body'][_0x33a324(0x188)]],_0x25b2e8=[_0x5a2027['body'][_0x33a324(0x19b)]];else var _0xd4bf82=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x1d5)]],_0x1aa680=[..._0x5a2027['body'][_0x33a324(0x195)]],_0x1996cf=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x205)]],_0x16bb85=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x1ae)]],_0x161f5b=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x162)]],_0x1f394a=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x1e6)]],_0x59d027=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x139)]],_0x401a3b=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x1d3)]],_0x5433d7=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x1e4)]],_0x36be71=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x192)]],_0x43a622=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x207)]],_0x5d8b52=[..._0x5a2027[_0x33a324(0x181)]['max_per_unit']],_0x2ae77d=[..._0x5a2027['body'][_0x33a324(0x18d)]],_0x2735d6=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x1e7)]],_0x316154=[..._0x5a2027['body'][_0x33a324(0x182)]],_0x365847=[..._0x5a2027[_0x33a324(0x181)]['prime1']],_0x30fbfd=[..._0x5a2027[_0x33a324(0x181)][_0x33a324(0x167)]],_0x556c64=[..._0x5a2027[_0x33a324(0x181)]['prod_invoice']],_0x25b2e8=[..._0x5a2027['body'][_0x33a324(0x19b)]];const _0x4b4e51=_0xd4bf82[_0x33a324(0x196)](_0x16b3ce=>{return _0x16b3ce={'product_name':_0x16b3ce};});_0x1aa680[_0x33a324(0x15d)]((_0x548a2b,_0x2482e9)=>{_0x316154['forEach']((_0x3e1aab,_0x5d470a)=>{var _0x120888=a0_0x57d1;if(_0x3e1aab==_0x120888(0x1ef)&&_0x2482e9==_0x5d470a){var _0x10a7ff=_0x548a2b[_0x120888(0x1ac)](0x3);_0x4b4e51[_0x2482e9]['storage']=_0x548a2b[0x0],_0x4b4e51[_0x2482e9]['rack']=_0x548a2b[0x1],_0x4b4e51[_0x2482e9]['bay']=0x0,_0x4b4e51[_0x2482e9][_0x120888(0x1b4)]=0x0,_0x4b4e51[_0x2482e9]['type']=_0x120888(0x1a8),_0x4b4e51[_0x2482e9]['floorlevel']=_0x10a7ff;}else{if(_0x3e1aab==_0x120888(0x1ed)&&_0x2482e9==_0x5d470a){var _0x10a7ff=_0x548a2b[_0x120888(0x1ac)](0x3);_0x4b4e51[_0x2482e9][_0x120888(0x163)]=_0x548a2b[0x0],_0x4b4e51[_0x2482e9][_0x120888(0x13a)]=_0x548a2b[0x1],_0x4b4e51[_0x2482e9][_0x120888(0x1e9)]=0x0,_0x4b4e51[_0x2482e9][_0x120888(0x1b4)]=0x0,_0x4b4e51[_0x2482e9]['type']=_0x120888(0x1a8),_0x4b4e51[_0x2482e9]['floorlevel']=_0x548a2b[0x5];}else{if(_0x2482e9==_0x5d470a){var _0xa34400;if(_0x548a2b[0x4]=='L')_0xa34400=_0x120888(0x165);else _0x548a2b[0x4]=='F'&&(_0xa34400=_0x120888(0x1a8));_0x4b4e51[_0x2482e9]['storage']=_0x548a2b[0x0],_0x4b4e51[_0x2482e9][_0x120888(0x13a)]=_0x548a2b[0x1],_0x4b4e51[_0x2482e9][_0x120888(0x1e9)]=_0x548a2b[0x2],_0x4b4e51[_0x2482e9][_0x120888(0x1b4)]=_0x548a2b[0x3],_0x4b4e51[_0x2482e9]['type']=_0xa34400,_0x4b4e51[_0x2482e9][_0x120888(0x191)]=_0x548a2b[0x5];}}}});}),_0x1996cf[_0x33a324(0x15d)]((_0x4ff1d1,_0x1fced5)=>{var _0xcbdb8a=_0x33a324;_0x4b4e51[_0x1fced5][_0xcbdb8a(0x1a5)]=_0x4ff1d1;}),_0x25b2e8['forEach']((_0x4fb620,_0x4c1437)=>{var _0x526f8f=_0x33a324;_0x4b4e51[_0x4c1437][_0x526f8f(0x19b)]=_0x4fb620;}),_0x16bb85[_0x33a324(0x15d)]((_0x3b428c,_0x13e318)=>{_0x4b4e51[_0x13e318]['types']=_0x3b428c;}),_0x161f5b[_0x33a324(0x15d)]((_0x4c1b21,_0xaa7e11)=>{var _0x64b94a=_0x33a324;_0x4b4e51[_0xaa7e11][_0x64b94a(0x1c6)]=_0x4c1b21;}),_0x1f394a['forEach']((_0x15100a,_0x2f8b13)=>{var _0x256d8c=_0x33a324;_0x4b4e51[_0x2f8b13][_0x256d8c(0x140)]=_0x15100a;}),_0x59d027['forEach']((_0x34ba52,_0x3dbe57)=>{var _0x2cda8=_0x33a324;_0x4b4e51[_0x3dbe57][_0x2cda8(0x139)]=_0x34ba52;}),_0x401a3b[_0x33a324(0x15d)]((_0x176e27,_0x2efe34)=>{var _0x1b1c8d=_0x33a324;_0x4b4e51[_0x2efe34][_0x1b1c8d(0x190)]=_0x176e27;}),_0x5433d7[_0x33a324(0x15d)]((_0x24e883,_0x26280d)=>{var _0x1d4e69=_0x33a324;_0x4b4e51[_0x26280d][_0x1d4e69(0x1db)]=_0x24e883;}),_0x36be71[_0x33a324(0x15d)]((_0x43c62f,_0x2ffaec)=>{var _0xd6ac15=_0x33a324;_0x4b4e51[_0x2ffaec][_0xd6ac15(0x192)]=_0x43c62f;}),_0x43a622[_0x33a324(0x15d)]((_0x102a3e,_0x206161)=>{var _0x21c2b3=_0x33a324;_0x4b4e51[_0x206161][_0x21c2b3(0x207)]=_0x102a3e;}),_0x5d8b52['forEach']((_0x469d1d,_0x456dc1)=>{var _0x133ba5=_0x33a324;_0x4b4e51[_0x456dc1][_0x133ba5(0x1b6)]=_0x469d1d;}),_0x2ae77d['forEach']((_0x117fe9,_0x42c5ae)=>{_0x4b4e51[_0x42c5ae]['production_date']=_0x117fe9;}),_0x2735d6[_0x33a324(0x15d)]((_0x5c87fd,_0x52a814)=>{var _0x44bf43=_0x33a324;_0x4b4e51[_0x52a814][_0x44bf43(0x1e7)]=_0x5c87fd;}),_0x316154['forEach']((_0x22d40e,_0x9b6f6d)=>{_0x4b4e51[_0x9b6f6d]['room_names']=_0x22d40e;}),_0x365847[_0x33a324(0x15d)]((_0x5ca08b,_0x2125b4)=>{var _0x2631b6=_0x33a324;_0x4b4e51[_0x2125b4][_0x2631b6(0x16c)]=_0x5ca08b;}),_0x30fbfd[_0x33a324(0x15d)]((_0x52f007,_0x16da46)=>{_0x4b4e51[_0x16da46]['secondary_code']=_0x52f007;}),_0x556c64[_0x33a324(0x15d)]((_0x5acbd8,_0x3b382a)=>{var _0x1f65c6=_0x33a324;_0x4b4e51[_0x3b382a][_0x1f65c6(0x178)]=_0x5acbd8;});const _0x2c08e2=_0x4b4e51[_0x33a324(0x1f0)](_0x8281ac=>_0x8281ac[_0x33a324(0x1c6)]!=='0'&&_0x8281ac[_0x33a324(0x1c6)]!=='');var _0x47fe9f=0x0;_0x2c08e2['forEach'](_0x31c45e=>{var _0x5b98ec=_0x33a324;console[_0x5b98ec(0x14d)]('foreach\x20newproduct',_0x31c45e),parseInt(_0x31c45e[_0x5b98ec(0x1c6)])<=0x0&&_0x47fe9f++;});if(_0x47fe9f!=0x0)return _0x5a2027[_0x33a324(0x1ca)](_0x33a324(0x204),_0x33a324(0x185)),_0x4c03db['redirect'](_0x33a324(0x19f));const _0x4252a4=new adjustment({'warehouse_name':_0x2781a3,'date':_0x13c423,'product':_0x2c08e2,'note':_0x146b81,'room':_0x56089d,'invoice':_0x6c0c76,'JO_number':_0x2a7f5b,'expiry_date':_0x321400}),_0x4e51f7=await _0x4252a4[_0x33a324(0x14a)]();_0x5a2027[_0x33a324(0x1ca)](_0x33a324(0x1b2),'adjustment\x20add\x20successfull'),_0x4c03db[_0x33a324(0x1cb)](_0x33a324(0x1c5)+_0x4e51f7['_id']);}catch(_0x557e5d){console[_0x33a324(0x14d)](_0x557e5d),_0x4c03db[_0x33a324(0x183)](0xc8)[_0x33a324(0x1c4)]({'message':_0x557e5d[_0x33a324(0x15b)]});}}),router['get']('/preview/:id',auth,async(_0x4818a4,_0x460c3d)=>{var _0x46e6e0=a0_0x1efbcf;try{const {username:_0x3bd814,email:_0xb07f9b,role:_0x28c8e2}=_0x4818a4[_0x46e6e0(0x1b9)],_0x56ff07=_0x4818a4[_0x46e6e0(0x1b9)],_0x50b942=await profile[_0x46e6e0(0x189)]({'email':_0x56ff07[_0x46e6e0(0x16a)]}),_0x1985e7=await master_shop[_0x46e6e0(0x15c)](),_0x4f0574=_0x4818a4[_0x46e6e0(0x172)]['id'],_0x3cd453=await adjustment['findById']({'_id':_0x4f0574}),_0x4feb7a=await purchases[_0x46e6e0(0x16d)]([{'$match':{'warehouse_name':_0x3cd453[_0x46e6e0(0x20b)]}},{'$unwind':'$product'},{'$group':{'_id':_0x46e6e0(0x208)}}]),_0x292d0d=await product[_0x46e6e0(0x15c)]({}),_0x5216a8=await warehouse['aggregate']([{'$match':{'name':_0x3cd453['warehouse_name']}},{'$unwind':_0x46e6e0(0x1ba)},{'$group':{'_id':_0x46e6e0(0x13e),'name':{'$first':_0x46e6e0(0x1a0)},'product_stock':{'$first':_0x46e6e0(0x1bf)},'bay':{'$first':_0x46e6e0(0x151)},'bin':{'$first':_0x46e6e0(0x19a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x46e6e0(0x14f)},'primary_code':{'$first':_0x46e6e0(0x1fd)},'secondary_code':{'$first':_0x46e6e0(0x1c0)},'product_code':{'$first':_0x46e6e0(0x1a1)},'storage':{'$first':_0x46e6e0(0x143)},'rack':{'$first':_0x46e6e0(0x175)},'maxPerUnit':{'$first':_0x46e6e0(0x194)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x46e6e0(0x1b1)},'batch_code':{'$first':_0x46e6e0(0x17a)},'room':{'$first':_0x46e6e0(0x1be)}}}]);if(_0x1985e7[0x0]['language']==_0x46e6e0(0x13d)){var _0x1fd012=users[_0x46e6e0(0x16e)];console['log'](_0x1fd012);}else{if(_0x1985e7[0x0][_0x46e6e0(0x1c3)]==_0x46e6e0(0x1c7))var _0x1fd012=users[_0x46e6e0(0x1c7)];else{if(_0x1985e7[0x0][_0x46e6e0(0x1c3)]=='German')var _0x1fd012=users['German'];else{if(_0x1985e7[0x0][_0x46e6e0(0x1c3)]==_0x46e6e0(0x1e2))var _0x1fd012=users[_0x46e6e0(0x1e2)];else{if(_0x1985e7[0x0][_0x46e6e0(0x1c3)]==_0x46e6e0(0x1cc))var _0x1fd012=users[_0x46e6e0(0x1cc)];else{if(_0x1985e7[0x0][_0x46e6e0(0x1c3)]==_0x46e6e0(0x1e5))var _0x1fd012=users['Portuguese'];else{if(_0x1985e7[0x0][_0x46e6e0(0x1c3)]=='Chinese')var _0x1fd012=users[_0x46e6e0(0x152)];else{if(_0x1985e7[0x0][_0x46e6e0(0x1c3)]==_0x46e6e0(0x1d8))var _0x1fd012=users[_0x46e6e0(0x1bb)];}}}}}}}_0x460c3d[_0x46e6e0(0x1b3)]('edit_adjustment_view',{'success':_0x4818a4[_0x46e6e0(0x1ca)]('success'),'errors':_0x4818a4[_0x46e6e0(0x1ca)](_0x46e6e0(0x204)),'role':_0x56ff07,'profile':_0x50b942,'adjustment':_0x3cd453,'stock':_0x5216a8,'master_shop':_0x1985e7,'warehouse_name':_0x4feb7a,'unit':_0x292d0d,'language':_0x1fd012});}catch(_0xf3a3f6){console[_0x46e6e0(0x14d)](_0xf3a3f6),_0x460c3d[_0x46e6e0(0x183)](0xc8)[_0x46e6e0(0x1c4)]({'message':_0xf3a3f6[_0x46e6e0(0x15b)]});}}),router[a0_0x1efbcf(0x193)](a0_0x1efbcf(0x15a),auth,async(_0x443d2f,_0x3ab7c1)=>{var _0x5b449a=a0_0x1efbcf;try{const _0x2c8a27=_0x443d2f[_0x5b449a(0x172)]['id'],{warehouse_name:_0xf5b477,Room_name:_0x152936}=_0x443d2f['body'],_0x4528b6=await adjustment['findById']({'_id':_0x2c8a27}),_0x3082fa=_0x4528b6[_0x5b449a(0x18e)]['map'](async _0x59eccc=>{var _0x48f5e9=_0x5b449a;if(_0x59eccc['adjust_qty']>0x0){var _0xf62117=await warehouse[_0x48f5e9(0x189)]({'name':_0xf5b477,'room':_0x59eccc[_0x48f5e9(0x149)],'warehouse_category':'Raw\x20Materials'});const _0x333d04=_0xf62117['product_details'][_0x48f5e9(0x196)](_0x46ad01=>{var _0x4a0180=_0x48f5e9;if(_0x59eccc[_0x4a0180(0x1ee)]==_0x4a0180(0x1d6)){if(_0x46ad01[_0x4a0180(0x161)]==_0x59eccc['product_name']&&_0x46ad01['floorlevel']==_0x59eccc[_0x4a0180(0x191)]&&_0x46ad01[_0x4a0180(0x1ee)]==_0x59eccc[_0x4a0180(0x1ee)]&&_0x46ad01['bin']==_0x59eccc['bin']&&_0x46ad01[_0x4a0180(0x1e9)]==_0x59eccc[_0x4a0180(0x1e9)]&&_0x46ad01[_0x4a0180(0x13a)]==_0x59eccc[_0x4a0180(0x13a)]&&_0x46ad01[_0x4a0180(0x163)]==_0x59eccc[_0x4a0180(0x163)]&&_0x46ad01['expiry_date']==_0x59eccc['expiry_date']&&_0x46ad01[_0x4a0180(0x192)]==_0x59eccc[_0x4a0180(0x192)]&&_0x46ad01[_0x4a0180(0x18d)]==_0x59eccc[_0x4a0180(0x18d)]&&_0x46ad01[_0x4a0180(0x178)]==_0x59eccc[_0x4a0180(0x178)]&&_0x46ad01[_0x4a0180(0x174)]==_0x59eccc[_0x4a0180(0x199)]){var _0x1bcb3a;_0x1bcb3a=_0x59eccc[_0x4a0180(0x1c6)],_0x59eccc[_0x4a0180(0x1e7)]=='S'&&(_0x1bcb3a=_0x59eccc[_0x4a0180(0x1c6)]),_0x46ad01[_0x4a0180(0x1bc)]=_0x46ad01['product_stock']-_0x1bcb3a;}}else{if(_0x46ad01[_0x4a0180(0x161)]==_0x59eccc[_0x4a0180(0x161)]&&_0x46ad01[_0x4a0180(0x191)]==_0x59eccc[_0x4a0180(0x191)]&&_0x46ad01[_0x4a0180(0x1ee)]==_0x59eccc[_0x4a0180(0x1ee)]&&_0x46ad01[_0x4a0180(0x1b4)]==_0x59eccc[_0x4a0180(0x1b4)]&&_0x46ad01[_0x4a0180(0x1e9)]==_0x59eccc['bay']&&_0x46ad01[_0x4a0180(0x13a)]==_0x59eccc['rack']&&_0x46ad01[_0x4a0180(0x163)]==_0x59eccc[_0x4a0180(0x163)]&&_0x46ad01[_0x4a0180(0x207)]==_0x59eccc[_0x4a0180(0x207)]&&_0x46ad01['batch_code']==_0x59eccc[_0x4a0180(0x192)]&&_0x46ad01[_0x4a0180(0x18d)]==_0x59eccc['production_date']&&_0x46ad01[_0x4a0180(0x178)]==_0x59eccc[_0x4a0180(0x178)]&&_0x46ad01[_0x4a0180(0x174)]==_0x59eccc[_0x4a0180(0x199)]){console[_0x4a0180(0x14d)](_0x59eccc);var _0x1bcb3a;_0x1bcb3a=_0x59eccc[_0x4a0180(0x1c6)],_0x59eccc[_0x4a0180(0x1e7)]=='S'&&(_0x1bcb3a=_0x59eccc[_0x4a0180(0x1c6)]),console[_0x4a0180(0x14d)](_0x1bcb3a+_0x4a0180(0x1ec)+_0x59eccc[_0x4a0180(0x1c6)]+'\x20<>\x20'+_0x46ad01['maxPerUnit']+_0x4a0180(0x1ec)+_0x59eccc['prod_cat']),_0x46ad01[_0x4a0180(0x1bc)]=_0x46ad01[_0x4a0180(0x1bc)]+_0x1bcb3a;}}});}return _0xf62117;});Promise[_0x5b449a(0x1ea)](_0x3082fa)[_0x5b449a(0x13b)](async _0x35218d=>{var _0x4b7db9=_0x5b449a;try{for(const _0x337993 of _0x35218d){await _0x337993['save']();}_0x4528b6[_0x4b7db9(0x1af)]=_0x4b7db9(0x18b);const _0x3b7686=await _0x4528b6[_0x4b7db9(0x14a)](),_0x35501e=await master_shop[_0x4b7db9(0x15c)](),_0x2a5dd7=await email_settings[_0x4b7db9(0x189)](),_0xee76d9=await supervisor_settings[_0x4b7db9(0x15c)]();var _0x44c65c=_0x4528b6[_0x4b7db9(0x18e)],_0x5ba423='',_0x4a2ef0;for(_0x4a2ef0 in _0x44c65c){_0x5ba423+=_0x4b7db9(0x169)+_0x4b7db9(0x1b5)+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x161)]+_0x4b7db9(0x1b0)+_0x4b7db9(0x1b5)+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x1db)]+_0x4b7db9(0x1b0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x1c6)]+_0x4b7db9(0x1b0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x139)]+_0x4b7db9(0x1b0)+_0x4b7db9(0x1b5)+_0x44c65c[_0x4a2ef0]['secondary_unit']+_0x4b7db9(0x1b0)+_0x4b7db9(0x1b5)+_0x4528b6[_0x4b7db9(0x20b)]+_0x4b7db9(0x1b0)+_0x4b7db9(0x1b5)+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x149)]+_0x4b7db9(0x1b0)+_0x4b7db9(0x1b5)+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x163)]+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x13a)]+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x1e9)]+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x1b4)]+_0x44c65c[_0x4a2ef0]['type'][0x0]+_0x44c65c[_0x4a2ef0][_0x4b7db9(0x191)]+'</td>','</tr>';}let _0xf6da37=nodemailer[_0x4b7db9(0x1da)]({'host':_0x2a5dd7['host'],'port':Number(_0x2a5dd7[_0x4b7db9(0x14c)]),'secure':![],'auth':{'user':_0x2a5dd7[_0x4b7db9(0x16a)],'pass':_0x2a5dd7[_0x4b7db9(0x201)]}}),_0x4073bc={'from':_0x2a5dd7['email'],'to':_0xee76d9[0x0]['RMSEmail'],'subject':_0x4b7db9(0x1d0),'attachments':[{'filename':'Logo.png','path':__dirname+_0x4b7db9(0x1d4)+_0x4b7db9(0x1c2)+_0x35501e[0x0][_0x4b7db9(0x17e)],'cid':_0x4b7db9(0x158)}],'html':_0x4b7db9(0x154)+_0x4b7db9(0x1ab)+_0x4b7db9(0x1f3)+_0x4b7db9(0x202)+_0x4b7db9(0x186)+_0x4b7db9(0x202)+_0x4b7db9(0x164)+_0x4b7db9(0x156)+_0x4b7db9(0x202)+_0x4b7db9(0x1de)+_0x35501e[0x0][_0x4b7db9(0x1d2)]+'\x20</h2>'+'</div>'+_0x4b7db9(0x156)+_0x4b7db9(0x1df)+_0x4b7db9(0x202)+_0x4b7db9(0x15e)+_0x4b7db9(0x153)+_0x4528b6[_0x4b7db9(0x178)]+'\x20'+_0x4b7db9(0x1cd)+_0x4b7db9(0x1fa)+_0x4528b6[_0x4b7db9(0x200)]+'\x20'+'</span>'+_0x4b7db9(0x142)+_0x4b7db9(0x156)+_0x4b7db9(0x1e3)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4b7db9(0x169)+_0x4b7db9(0x19c)+_0x4b7db9(0x155)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x4b7db9(0x157)+_0x4b7db9(0x1eb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x4b7db9(0x179)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x4b7db9(0x1c9)+_0x4b7db9(0x1b8)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x5ba423+'\x20'+_0x4b7db9(0x1a4)+'</table>'+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x4b7db9(0x1dc)+_0x35501e[0x0][_0x4b7db9(0x1d2)]+'</h5>'+_0x4b7db9(0x156)+'</div>'+_0x4b7db9(0x17d)};_0xf6da37[_0x4b7db9(0x1f8)](_0x4073bc,function(_0x5b76c2,_0x5ef27e){var _0xeb1b00=_0x4b7db9;_0x5b76c2?(console[_0xeb1b00(0x14d)](_0x5b76c2),console[_0xeb1b00(0x14d)]('Error\x20Occurs')):console[_0xeb1b00(0x14d)](_0xeb1b00(0x13c));}),_0x443d2f[_0x4b7db9(0x1ca)]('success',_0x4b7db9(0x1ff)),_0x3ab7c1[_0x4b7db9(0x1cb)](_0x4b7db9(0x1a2)+_0x3b7686[_0x4b7db9(0x174)]);}catch(_0x1abbf3){console[_0x4b7db9(0x168)](_0x1abbf3),_0x3ab7c1[_0x4b7db9(0x183)](0x1f4)[_0x4b7db9(0x1c4)]({'error':_0x4b7db9(0x1c1)});}})['catch'](_0x101a50=>{var _0x5ca5f7=_0x5b449a;console[_0x5ca5f7(0x168)](_0x101a50),_0x3ab7c1[_0x5ca5f7(0x183)](0x1f4)[_0x5ca5f7(0x1c4)]({'error':_0x5ca5f7(0x147)});});}catch(_0x3cc694){console[_0x5b449a(0x14d)](_0x3cc694),_0x3ab7c1[_0x5b449a(0x183)](0xc8)[_0x5b449a(0x1c4)]({'message':_0x3cc694[_0x5b449a(0x15b)]});}}),router[a0_0x1efbcf(0x144)](a0_0x1efbcf(0x1b7),auth,async(_0x1574ad,_0x133391)=>{var _0x137e18=a0_0x1efbcf;try{const {username:_0x446593,email:_0x35a3c0,role:_0x5eafff}=_0x1574ad[_0x137e18(0x1b9)],_0xfde2b4=_0x1574ad[_0x137e18(0x1b9)],_0x186bff=await profile[_0x137e18(0x189)]({'email':_0xfde2b4['email']}),_0x6b9b7c=await master_shop[_0x137e18(0x15c)](),_0x6d746f=_0x1574ad[_0x137e18(0x172)]['id'],_0x5ebe97=await adjustment['findById']({'_id':_0x6d746f}),_0x36c4b4=await purchases[_0x137e18(0x16d)]([{'$match':{'warehouse_name':_0x5ebe97[_0x137e18(0x20b)]}},{'$unwind':_0x137e18(0x171)},{'$group':{'_id':_0x137e18(0x208)}}]),_0x3012fb=await product[_0x137e18(0x15c)]({}),_0x136ebe=await warehouse['aggregate']([{'$match':{'name':_0x5ebe97['warehouse_name']}},{'$unwind':_0x137e18(0x1ba)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x137e18(0x1bf)},'bay':{'$first':_0x137e18(0x151)},'bin':{'$first':_0x137e18(0x19a)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x137e18(0x14f)},'primary_code':{'$first':_0x137e18(0x1fd)},'secondary_code':{'$first':_0x137e18(0x1c0)},'product_code':{'$first':_0x137e18(0x1a1)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x137e18(0x175)},'maxPerUnit':{'$first':_0x137e18(0x194)},'expiry_date':{'$first':_0x137e18(0x166)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x137e18(0x1be)}}}]);let _0x367116;if(_0xfde2b4['role']==_0x137e18(0x1e1)){const _0x13fd74=await staff[_0x137e18(0x189)]({'email':_0xfde2b4[_0x137e18(0x16a)]});_0x367116=await warehouse[_0x137e18(0x16d)]([{'$match':{'status':'Enabled','name':_0x13fd74[_0x137e18(0x1ce)],'warehouse_category':_0x137e18(0x1f5),'name':{'$ne':_0x137e18(0x1c8)}}},{'$group':{'_id':_0x137e18(0x187),'name':{'$first':_0x137e18(0x187)}}}]);}else _0x367116=await warehouse[_0x137e18(0x16d)]([{'$match':{'status':'Enabled','warehouse_category':_0x137e18(0x1f5),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x137e18(0x187),'name':{'$first':_0x137e18(0x187)}}}]);if(_0x6b9b7c[0x0][_0x137e18(0x1c3)]=='English\x20(US)'){var _0x2fe002=users[_0x137e18(0x16e)];console['log'](_0x2fe002);}else{if(_0x6b9b7c[0x0][_0x137e18(0x1c3)]==_0x137e18(0x1c7))var _0x2fe002=users[_0x137e18(0x1c7)];else{if(_0x6b9b7c[0x0][_0x137e18(0x1c3)]=='German')var _0x2fe002=users[_0x137e18(0x1d1)];else{if(_0x6b9b7c[0x0][_0x137e18(0x1c3)]=='Spanish')var _0x2fe002=users['Spanish'];else{if(_0x6b9b7c[0x0][_0x137e18(0x1c3)]==_0x137e18(0x1cc))var _0x2fe002=users['French'];else{if(_0x6b9b7c[0x0][_0x137e18(0x1c3)]=='Portuguese\x20(BR)')var _0x2fe002=users[_0x137e18(0x1f7)];else{if(_0x6b9b7c[0x0]['language']==_0x137e18(0x152))var _0x2fe002=users[_0x137e18(0x152)];else{if(_0x6b9b7c[0x0][_0x137e18(0x1c3)]=='Arabic\x20(ae)')var _0x2fe002=users['Arabic'];}}}}}}}_0x133391[_0x137e18(0x1b3)](_0x137e18(0x17f),{'success':_0x1574ad[_0x137e18(0x1ca)]('success'),'errors':_0x1574ad[_0x137e18(0x1ca)]('errors'),'role':_0xfde2b4,'profile':_0x186bff,'adjustment':_0x5ebe97,'stock':_0x136ebe,'master_shop':_0x6b9b7c,'warehouse_name':_0x36c4b4,'unit':_0x3012fb,'language':_0x2fe002,'warehouse':_0x367116});}catch(_0x4ea8f8){console[_0x137e18(0x14d)](_0x4ea8f8),_0x133391['status'](0xc8)[_0x137e18(0x1c4)]({'message':_0x4ea8f8[_0x137e18(0x15b)]});}}),router[a0_0x1efbcf(0x193)](a0_0x1efbcf(0x1b7),auth,async(_0x1b3868,_0xbe3b0b)=>{var _0x32f7f9=a0_0x1efbcf;try{const _0x2166b3=_0x1b3868[_0x32f7f9(0x172)]['id'],_0x24565f=await adjustment[_0x32f7f9(0x146)]({'_id':_0x2166b3}),_0x449f5b=await warehouse[_0x32f7f9(0x189)]({'name':_0x24565f[_0x32f7f9(0x20b)],'room':_0x24565f[_0x32f7f9(0x20a)]}),{warehouse_name:_0x1d6d44,date:_0x2abfbc,prod_name:_0x58cfe7,level:_0x507e60,isle:_0x2c7f3c,pallet:_0x1c8836,stock:_0x448b37,types:_0x576b5c,adjust_qty:_0x22070c,new_adjust_qty:_0x53ab7a,note:_0x1c95f2,Room_name:_0xbcabc0,invoice:_0x58059a,JO_number:_0x39dabc,expiry_date:_0x7ee413}=_0x1b3868['body'];if(typeof _0x58cfe7==_0x32f7f9(0x1bd))var _0x4a24c8=[_0x1b3868[_0x32f7f9(0x181)]['prod_name']],_0x14504c=[_0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x195)]],_0x3ebb06=[_0x1b3868['body'][_0x32f7f9(0x205)]],_0x1f7926=[_0x1b3868['body'][_0x32f7f9(0x1ae)]],_0x21ce46=[_0x1b3868['body'][_0x32f7f9(0x162)]],_0x2224d2=[_0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1e6)]],_0x24e5c0=[_0x1b3868[_0x32f7f9(0x181)]['Primary_Units']],_0x2699e8=[_0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1d3)]],_0x2a17b5=[_0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1e4)]],_0x50334d=[_0x1b3868[_0x32f7f9(0x181)]['batch_code']],_0x303c36=[_0x1b3868['body'][_0x32f7f9(0x207)]],_0x2637ef=[_0x1b3868[_0x32f7f9(0x181)]['max_per_unit']],_0x293a4d=[_0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x18d)]],_0x6ad429=[_0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1e7)]],_0x3c9494=[_0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x182)]],_0x364195=[_0x1b3868[_0x32f7f9(0x181)]['prime1']],_0x5bc391=[_0x1b3868['body']['second1']];else var _0x4a24c8=[..._0x1b3868['body']['prod_name']],_0x14504c=[..._0x1b3868['body'][_0x32f7f9(0x195)]],_0x3ebb06=[..._0x1b3868[_0x32f7f9(0x181)]['stock']],_0x1f7926=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1ae)]],_0x21ce46=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x162)]],_0x2224d2=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1e6)]],_0x24e5c0=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x139)]],_0x2699e8=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1d3)]],_0x2a17b5=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1e4)]],_0x50334d=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x192)]],_0x303c36=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x207)]],_0x2637ef=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x159)]],_0x293a4d=[..._0x1b3868['body'][_0x32f7f9(0x18d)]],_0x6ad429=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x1e7)]],_0x3c9494=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x182)]],_0x364195=[..._0x1b3868[_0x32f7f9(0x181)]['prime1']],_0x5bc391=[..._0x1b3868[_0x32f7f9(0x181)][_0x32f7f9(0x167)]];const _0x5f1979=_0x4a24c8[_0x32f7f9(0x196)](_0xc5245a=>{return _0xc5245a={'product_name':_0xc5245a};});_0x14504c['forEach']((_0x96ce04,_0x4f894b)=>{var _0xa422b1=_0x32f7f9;_0x3c9494[_0xa422b1(0x15d)]((_0x19715c,_0x10a344)=>{var _0x3d48b6=_0xa422b1;if(_0x19715c==_0x3d48b6(0x1ef)&&_0x4f894b==_0x10a344){var _0xb09e2=_0x96ce04['slice'](0x3);_0x5f1979[_0x4f894b][_0x3d48b6(0x163)]=_0x96ce04[0x0],_0x5f1979[_0x4f894b][_0x3d48b6(0x13a)]=_0x96ce04[0x1],_0x5f1979[_0x4f894b][_0x3d48b6(0x1e9)]=0x0,_0x5f1979[_0x4f894b]['bin']=0x0,_0x5f1979[_0x4f894b][_0x3d48b6(0x1ee)]=_0x3d48b6(0x1a8),_0x5f1979[_0x4f894b][_0x3d48b6(0x191)]=_0xb09e2;}else{if(_0x19715c==_0x3d48b6(0x1ed)&&_0x4f894b==_0x10a344){var _0xb09e2=_0x96ce04['slice'](0x3);_0x5f1979[_0x4f894b]['storage']=_0x96ce04[0x0],_0x5f1979[_0x4f894b][_0x3d48b6(0x13a)]=_0x96ce04[0x1],_0x5f1979[_0x4f894b][_0x3d48b6(0x1e9)]=0x0,_0x5f1979[_0x4f894b]['bin']=0x0,_0x5f1979[_0x4f894b][_0x3d48b6(0x1ee)]=_0x3d48b6(0x1a8),_0x5f1979[_0x4f894b][_0x3d48b6(0x191)]=_0x96ce04[0x5];}else{if(_0x4f894b==_0x10a344){var _0x11fc29;if(_0x96ce04[0x4]=='L')_0x11fc29=_0x3d48b6(0x165);else _0x96ce04[0x4]=='F'&&(_0x11fc29=_0x3d48b6(0x1a8));_0x5f1979[_0x4f894b]['storage']=_0x96ce04[0x0],_0x5f1979[_0x4f894b][_0x3d48b6(0x13a)]=_0x96ce04[0x1],_0x5f1979[_0x4f894b][_0x3d48b6(0x1e9)]=_0x96ce04[0x2],_0x5f1979[_0x4f894b][_0x3d48b6(0x1b4)]=_0x96ce04[0x3],_0x5f1979[_0x4f894b][_0x3d48b6(0x1ee)]=_0x11fc29,_0x5f1979[_0x4f894b][_0x3d48b6(0x191)]=_0x96ce04[0x5];}}}});}),_0x3ebb06[_0x32f7f9(0x15d)]((_0x33154c,_0x8fb625)=>{var _0x269586=_0x32f7f9;_0x5f1979[_0x8fb625][_0x269586(0x1a5)]=_0x33154c;}),_0x1f7926[_0x32f7f9(0x15d)]((_0x1a59ff,_0x521f97)=>{var _0x4d8921=_0x32f7f9;_0x5f1979[_0x521f97][_0x4d8921(0x1ae)]=_0x1a59ff;}),_0x21ce46[_0x32f7f9(0x15d)]((_0x34feb5,_0x9b7bb3)=>{var _0xf2d532=_0x32f7f9;_0x5f1979[_0x9b7bb3][_0xf2d532(0x1c6)]=_0x34feb5;}),_0x2224d2[_0x32f7f9(0x15d)]((_0x2a4e69,_0x4eccdd)=>{var _0x2d0e41=_0x32f7f9;_0x5f1979[_0x4eccdd][_0x2d0e41(0x140)]=_0x2a4e69;}),_0x24e5c0[_0x32f7f9(0x15d)]((_0x2d82cb,_0x4bf938)=>{var _0x4fde54=_0x32f7f9;_0x5f1979[_0x4bf938][_0x4fde54(0x139)]=_0x2d82cb;}),_0x2699e8[_0x32f7f9(0x15d)]((_0x5cea18,_0x2de554)=>{var _0x1ba03d=_0x32f7f9;_0x5f1979[_0x2de554][_0x1ba03d(0x190)]=_0x5cea18;}),_0x2a17b5[_0x32f7f9(0x15d)]((_0xecb0c1,_0x3f7c93)=>{var _0x1bdf60=_0x32f7f9;_0x5f1979[_0x3f7c93][_0x1bdf60(0x1db)]=_0xecb0c1;}),_0x50334d[_0x32f7f9(0x15d)]((_0x4a4c97,_0x3b8ad0)=>{var _0x5cd8f7=_0x32f7f9;_0x5f1979[_0x3b8ad0][_0x5cd8f7(0x192)]=_0x4a4c97;}),_0x303c36[_0x32f7f9(0x15d)]((_0x4bf640,_0x1b415f)=>{_0x5f1979[_0x1b415f]['expiry_date']=_0x4bf640;}),_0x2637ef['forEach']((_0x4b44a5,_0x3737c9)=>{var _0xf48b9c=_0x32f7f9;_0x5f1979[_0x3737c9][_0xf48b9c(0x1b6)]=_0x4b44a5;}),_0x293a4d['forEach']((_0xf68c8,_0x52c315)=>{_0x5f1979[_0x52c315]['production_date']=_0xf68c8;}),_0x6ad429[_0x32f7f9(0x15d)]((_0x1cd93b,_0x565131)=>{var _0x10894c=_0x32f7f9;_0x5f1979[_0x565131][_0x10894c(0x1e7)]=_0x1cd93b;}),_0x3c9494[_0x32f7f9(0x15d)]((_0x2aff83,_0x1d197a)=>{var _0x1c6271=_0x32f7f9;_0x5f1979[_0x1d197a][_0x1c6271(0x149)]=_0x2aff83;}),_0x364195[_0x32f7f9(0x15d)]((_0x7ebf30,_0x300a9d)=>{var _0x16127a=_0x32f7f9;_0x5f1979[_0x300a9d][_0x16127a(0x16c)]=_0x7ebf30;}),_0x5bc391['forEach']((_0x12b77d,_0x2d82df)=>{var _0x10c160=_0x32f7f9;_0x5f1979[_0x2d82df][_0x10c160(0x1a9)]=_0x12b77d;});const _0x354a28=_0x5f1979['filter'](_0x50b945=>_0x50b945[_0x32f7f9(0x1c6)]!=='0'&&_0x50b945[_0x32f7f9(0x1c6)]!=='');var _0x5ad4b3=0x0;_0x354a28[_0x32f7f9(0x15d)](_0x283158=>{var _0x13f398=_0x32f7f9;console[_0x13f398(0x14d)](_0x13f398(0x170),_0x283158),parseInt(_0x283158[_0x13f398(0x1c6)])<=0x0&&_0x5ad4b3++;});if(_0x5ad4b3!=0x0)return _0x1b3868[_0x32f7f9(0x1ca)](_0x32f7f9(0x204),_0x32f7f9(0x185)),_0xbe3b0b[_0x32f7f9(0x1cb)]('back');_0x24565f[_0x32f7f9(0x20b)]=_0x1d6d44,_0x24565f['date']=_0x2abfbc,_0x24565f[_0x32f7f9(0x18e)]=_0x354a28,_0x24565f[_0x32f7f9(0x1ad)]=_0x1c95f2,_0x24565f[_0x32f7f9(0x178)]=_0x58059a,_0x24565f[_0x32f7f9(0x1f1)]=_0x32f7f9(0x1aa);const _0x2ce3f8=await _0x24565f[_0x32f7f9(0x14a)]();_0x1b3868[_0x32f7f9(0x1ca)]('success',_0x32f7f9(0x1a7)),_0xbe3b0b[_0x32f7f9(0x1cb)](_0x32f7f9(0x1f6));}catch(_0x5c90eb){console[_0x32f7f9(0x14d)](_0x5c90eb);}}),router['post']('/barcode_scanner',async(_0x170956,_0x501801)=>{var _0x34b2b7=a0_0x1efbcf;const {primary_code:_0x5c9307,warehouse_data:_0x214236,rooms_data:_0x3e79cb,Roomslist:_0x2ec145}=_0x170956[_0x34b2b7(0x181)],_0x503ceb=_0x2ec145['split'](','),_0x390faf=[];async function _0x2fcae6(_0x13d1b3){var _0x44c5c7=_0x34b2b7;const _0x110e0f=await warehouse[_0x44c5c7(0x16d)]([{'$match':{'name':_0x214236,'room':_0x13d1b3}},{'$unwind':_0x44c5c7(0x1ba)},{'$match':{'product_details.primary_code':_0x5c9307}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x44c5c7(0x1a0)},'product_stock':{'$first':_0x44c5c7(0x1bf)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x44c5c7(0x1c0)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x44c5c7(0x151)},'isle':{'$first':_0x44c5c7(0x19a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x44c5c7(0x14f)},'unit':{'$first':_0x44c5c7(0x14b)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x44c5c7(0x143)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x44c5c7(0x166)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x44c5c7(0x194)},'batch_code':{'$first':_0x44c5c7(0x17a)},'product_cat':{'$first':_0x44c5c7(0x17c)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x44c5c7(0x1be)},'invoice':{'$first':_0x44c5c7(0x197)}}}]),_0x4467e8=await warehouse[_0x44c5c7(0x16d)]([{'$match':{'name':_0x214236,'room':_0x13d1b3}},{'$unwind':_0x44c5c7(0x1ba)},{'$match':{'product_details.secondary_code':_0x5c9307}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x44c5c7(0x1a0)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x44c5c7(0x1c0)},'product_code':{'$first':_0x44c5c7(0x1a1)},'level':{'$first':_0x44c5c7(0x151)},'isle':{'$first':_0x44c5c7(0x19a)},'type':{'$first':_0x44c5c7(0x145)},'pallet':{'$first':_0x44c5c7(0x14f)},'unit':{'$first':_0x44c5c7(0x14b)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x44c5c7(0x143)},'rack':{'$first':_0x44c5c7(0x175)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x44c5c7(0x1b1)},'maxPerUnit':{'$first':_0x44c5c7(0x194)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x44c5c7(0x17c)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x44c5c7(0x1be)}}}]);if(_0x110e0f[_0x44c5c7(0x1cf)]>0x0)_0x390faf['push'](_0x110e0f);else _0x4467e8['length']>0x0&&_0x390faf[_0x44c5c7(0x14e)](_0x4467e8);}const _0x3f9b65=_0x503ceb[_0x34b2b7(0x196)](_0x4977c0=>_0x2fcae6(_0x4977c0));await Promise[_0x34b2b7(0x1ea)](_0x3f9b65),_0x501801[_0x34b2b7(0x1c4)](_0x390faf);}),router[a0_0x1efbcf(0x193)]('/CheckingWarehouse',async(_0x12923a,_0x433be3)=>{var _0x58d25b=a0_0x1efbcf;const {primaryCode:_0x3bec2e,secondaryCode:_0x10f04f,productCode:_0x35210d,level:_0x58d92e,isle:_0xfa27e4,pallet:_0x213cbd,warehouses:_0x30421a,room:_0x53c0d2}=_0x12923a[_0x58d25b(0x181)];try{const _0x49d49f=await warehouse[_0x58d25b(0x16d)]([{'$match':{'name':_0x30421a,'room':_0x53c0d2}},{'$unwind':_0x58d25b(0x1ba)},{'$match':{'product_details.level':parseInt(_0x58d92e),'product_details.isle':_0xfa27e4,'product_details.pallet':parseInt(_0x213cbd)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x58d25b(0x1a0)},'product_stock':{'$first':_0x58d25b(0x1bf)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x58d25b(0x1f4)},'pallet':{'$first':_0x58d25b(0x17b)},'maxProducts':{'$first':_0x58d25b(0x15f)}}}]);_0x433be3[_0x58d25b(0x183)](0xc8)[_0x58d25b(0x1c4)](_0x49d49f);}catch(_0x493ef2){_0x433be3[_0x58d25b(0x183)](0x194)['json']({'message':_0x493ef2[_0x58d25b(0x15b)]});}}),module[a0_0x1efbcf(0x1e0)]=router;