function a0_0x227b(_0x909305,_0x33515b){var _0xb76f39=a0_0xb76f();return a0_0x227b=function(_0x227b3a,_0x394157){_0x227b3a=_0x227b3a-0x1d0;var _0x4baf38=_0xb76f39[_0x227b3a];return _0x4baf38;},a0_0x227b(_0x909305,_0x33515b);}var a0_0xedd354=a0_0x227b;(function(_0x3b414f,_0xb7c5f){var _0x16919f=a0_0x227b,_0x571bb8=_0x3b414f();while(!![]){try{var _0xc52cbd=parseInt(_0x16919f(0x249))/0x1*(-parseInt(_0x16919f(0x1d9))/0x2)+parseInt(_0x16919f(0x2a2))/0x3*(parseInt(_0x16919f(0x286))/0x4)+-parseInt(_0x16919f(0x25e))/0x5+-parseInt(_0x16919f(0x216))/0x6*(-parseInt(_0x16919f(0x205))/0x7)+parseInt(_0x16919f(0x1f9))/0x8*(-parseInt(_0x16919f(0x22b))/0x9)+parseInt(_0x16919f(0x247))/0xa+parseInt(_0x16919f(0x28d))/0xb;if(_0xc52cbd===_0xb7c5f)break;else _0x571bb8['push'](_0x571bb8['shift']());}catch(_0x31443a){_0x571bb8['push'](_0x571bb8['shift']());}}}(a0_0xb76f,0xab544));function a0_0xb76f(){var _0xe50833=['forEach','log','False','redirect','string','German','Chinese','slice','Primary_Units','$finalize','471220MVtAQY','warehouse_name','57147WBtgeu','\x20<>\x20','error','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','staff','/view/:id','$product.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','<div>','floorlevel','length','Arabic','$product_details.storage','language','$product_details.product_name','get','product_code','Enabled','English\x20(US)','English','adjust_qty','811985MuObRs','Return\x20Goods','aggregate','</div>','$product','batch_code','rack','production_date','</tr>','status','findOne','add_adjustment','Secondary_units','Floor','../public/language/languages.json','user','invoice','</table>','Arabic\x20(ae)','bin','all','product','$product_details.type','Enclosed','../middleware/auth','findById','$product_details.unit','password','prime1','/adjustment/view','flash','New_Qty_Converted','</tbody>','</td>','push','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','/CheckingWarehouse','types','second1','$room','42388TkdOTN','<hr\x20class=\x22my-3\x22>','site_title','Shelves','/view/add_adjustment','edit_adjustment_view','map','17533681nLCuQT','Rooms','storage','primary_code','$product_details.batch_code','$product_details.bin','prod_invoice','</span>','adjustment\x20Finalized\x20successfully','prod_cat','random','success','\x20Order\x20Date\x20:\x20','max_per_unit','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','type','$product_details.bay','product_stock','params','unit','78TsihcF','Router','$product_details','product_name','nodemailer','createTransport','logo','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','prod_code','/../public','10hlGAia','back','Receiving\x20Area','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','role','$warehouse_name','<strong>\x20Regards\x20</strong>','Ambient','expiry_date','save','render','Portuguese\x20(BR)','adjustment\x20add\x20successfull','catch','$product_details.product_stock','Adjustment\x20Mail','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','product_details','$product_details.floorlevel','$product_details.production_date','../models/all_models','<h5>','message','body','<span\x20style=\x22float:\x20right;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Hindi','post','$product_details.primary_code','$product_details.rack','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','10111936BKeziU','Portuguese','True','date','Error\x20Occurs','minus','find','id_transaction_from','\x20</h2>','/adjustment/preview/','email','warehouse','49thUGVI','$product_details._id','$product_details.product_cat','secondary_unit','<table\x20style=\x22width:\x20100%\x20!important;\x22>','note','filter','\x20Order\x20Number\x20:\x20','foreach\x20newproduct','$date','$product_details.invoice','$product_details.maxPerUnit','sendMail','An\x20error\x20occurred.','_id','<tbody\x20style=\x22text-align:\x20center;\x22>','bay','426234CcLFPm','New_Qty_Converted_adj','$product_details.isle','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','id_transaction','Spanish','$product_details.maxProducts','Level','room_names','maxperunit','$product_details.secondary_unit','secondary_code','$product.room_names','express','$product_details.secondary_code','$product_details.product_code','json','$product_details.expiry_date','stockBefore','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</h5>','9niJAVg','Raw\x20Materials','Email\x20sent\x20successfully','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','ADJ-','split','then','prod_name','level','maxPerUnit','new_adjust_qty','$product_details.level','RMSEmail','$_id','/preview/:id','errors','French','</body></html>'];a0_0xb76f=function(){return _0xe50833;};return a0_0xb76f();}const express=require(a0_0xedd354(0x223)),app=express(),router=express[a0_0xedd354(0x1d0)](),auth=require(a0_0xedd354(0x276)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0xedd354(0x1ed)),users=require(a0_0xedd354(0x26c)),nodemailer=require(a0_0xedd354(0x1d3));router[a0_0xedd354(0x258)]('/view',auth,async(_0xad9048,_0x58a838)=>{var _0x24bbda=a0_0xedd354;try{const {username:_0x1a9c76,email:_0x33aae3,role:_0x49c40a}=_0xad9048[_0x24bbda(0x26d)],_0x11fc53=_0xad9048['user'],_0x5e25d8=await profile['findOne']({'email':_0x11fc53[_0x24bbda(0x203)]}),_0x4c234c=await master_shop[_0x24bbda(0x1ff)]();console[_0x24bbda(0x23e)]('master',_0x4c234c);let _0x5df468;if(_0x11fc53['role']==_0x24bbda(0x24d)){const _0x38a377=await staff[_0x24bbda(0x268)]({'email':_0x11fc53['email']});_0x5df468=await warehouse['find']({'status':'Enabled','name':_0x38a377[_0x24bbda(0x204)]});}else _0x5df468=await warehouse[_0x24bbda(0x1ff)]({'status':_0x24bbda(0x25a)});const _0x4b8683=await product[_0x24bbda(0x1ff)]();let _0x99d31b;if(_0x11fc53['role']==_0x24bbda(0x24d)){const _0x3726b1=await staff[_0x24bbda(0x268)]({'email':_0x11fc53[_0x24bbda(0x203)]});_0x99d31b=await adjustment[_0x24bbda(0x1ff)]({'warehouse_name':_0x3726b1['warehouse']});}else _0x99d31b=await adjustment[_0x24bbda(0x260)]([{'$unwind':_0x24bbda(0x262)},{'$group':{'_id':_0x24bbda(0x238),'invoice':{'$first':'$invoice'},'date':{'$first':_0x24bbda(0x20e)},'warehouse_name':{'$first':_0x24bbda(0x1de)},'room':{'$addToSet':_0x24bbda(0x222)},'finalize':{'$first':_0x24bbda(0x246)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x4c234c[0x0][_0x24bbda(0x256)]=='English\x20(US)'){var _0x971643=users[_0x24bbda(0x25c)];console[_0x24bbda(0x23e)](_0x971643);}else{if(_0x4c234c[0x0][_0x24bbda(0x256)]==_0x24bbda(0x1f3))var _0x971643=users['Hindi'];else{if(_0x4c234c[0x0][_0x24bbda(0x256)]==_0x24bbda(0x242))var _0x971643=users[_0x24bbda(0x242)];else{if(_0x4c234c[0x0]['language']==_0x24bbda(0x21b))var _0x971643=users[_0x24bbda(0x21b)];else{if(_0x4c234c[0x0][_0x24bbda(0x256)]=='French')var _0x971643=users[_0x24bbda(0x23b)];else{if(_0x4c234c[0x0][_0x24bbda(0x256)]==_0x24bbda(0x1e4))var _0x971643=users[_0x24bbda(0x1fa)];else{if(_0x4c234c[0x0]['language']==_0x24bbda(0x243))var _0x971643=users['Chinese'];else{if(_0x4c234c[0x0][_0x24bbda(0x256)]==_0x24bbda(0x270))var _0x971643=users[_0x24bbda(0x254)];}}}}}}}_0x58a838[_0x24bbda(0x1e3)]('adjustment',{'success':_0xad9048['flash'](_0x24bbda(0x298)),'errors':_0xad9048[_0x24bbda(0x27c)](_0x24bbda(0x23a)),'role':_0x11fc53,'profile':_0x5e25d8,'warehouse':_0x5df468,'product':_0x4b8683,'adjustment':_0x99d31b,'master_shop':_0x4c234c,'language':_0x971643});}catch(_0x408fde){console['log'](_0x408fde);}});async function getRandom8DigitNumber(){var _0x3c46c2=a0_0xedd354;const _0x2e19b2=0x989680,_0x1d66ec=0x5f5e0ff,_0x446763=Math['floor'](Math[_0x3c46c2(0x297)]()*(_0x1d66ec-_0x2e19b2+0x1))+_0x2e19b2;var _0x2b9d4d;const _0x5171ef=await adjustment[_0x3c46c2(0x268)]({'invoice':_0x3c46c2(0x22f)+_0x446763});return _0x5171ef&&_0x5171ef[_0x3c46c2(0x253)]>0x0?_0x2b9d4d='ADJ-'+_0x446763:_0x2b9d4d='ADJ-'+_0x446763,_0x2b9d4d;}router[a0_0xedd354(0x258)](a0_0xedd354(0x28a),auth,async(_0x17201a,_0x521b5a)=>{var _0x387e3c=a0_0xedd354;try{const {username:_0xed16c3,email:_0x549764,role:_0x5b37de}=_0x17201a['user'],_0x2d3e26=_0x17201a['user'],_0x55e4b6=await profile[_0x387e3c(0x268)]({'email':_0x2d3e26[_0x387e3c(0x203)]}),_0x2b425f=await master_shop[_0x387e3c(0x1ff)]();let _0x2b11de;if(_0x2d3e26[_0x387e3c(0x1dd)]==_0x387e3c(0x24d)){const _0x74f7a=await staff[_0x387e3c(0x268)]({'email':_0x2d3e26[_0x387e3c(0x203)]});_0x2b11de=await warehouse['aggregate']([{'$match':{'status':_0x387e3c(0x25a),'name':_0x74f7a['warehouse'],'warehouse_category':_0x387e3c(0x22c),'name':{'$ne':_0x387e3c(0x25f)}}},{'$group':{'_id':_0x387e3c(0x29b),'name':{'$first':_0x387e3c(0x29b)}}}]);}else _0x2b11de=await warehouse[_0x387e3c(0x260)]([{'$match':{'status':_0x387e3c(0x25a),'warehouse_category':_0x387e3c(0x22c),'name':{'$ne':_0x387e3c(0x25f)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x3d3de5=await product[_0x387e3c(0x1ff)]({}),_0xe9f265=await adjustment[_0x387e3c(0x1ff)]({}),_0x3960f4=_0xe9f265[_0x387e3c(0x253)]+0x1,_0xdfb5ed='ADJ-'+_0x3960f4['toString']()['padStart'](0x5,'0');var _0x25908a=[_0x387e3c(0x1e0),_0x387e3c(0x275),'Return\x20Rooms'];if(_0x2b425f[0x0][_0x387e3c(0x256)]==_0x387e3c(0x25b))var _0xe589d8=users['English'];else{if(_0x2b425f[0x0][_0x387e3c(0x256)]==_0x387e3c(0x1f3))var _0xe589d8=users[_0x387e3c(0x1f3)];else{if(_0x2b425f[0x0][_0x387e3c(0x256)]==_0x387e3c(0x242))var _0xe589d8=users[_0x387e3c(0x242)];else{if(_0x2b425f[0x0][_0x387e3c(0x256)]=='Spanish')var _0xe589d8=users[_0x387e3c(0x21b)];else{if(_0x2b425f[0x0][_0x387e3c(0x256)]==_0x387e3c(0x23b))var _0xe589d8=users['French'];else{if(_0x2b425f[0x0][_0x387e3c(0x256)]==_0x387e3c(0x1e4))var _0xe589d8=users[_0x387e3c(0x1fa)];else{if(_0x2b425f[0x0]['language']==_0x387e3c(0x243))var _0xe589d8=users['Chinese'];else{if(_0x2b425f[0x0]['language']==_0x387e3c(0x270))var _0xe589d8=users[_0x387e3c(0x254)];}}}}}}}const _0x9f000c=getRandom8DigitNumber();_0x9f000c['then'](_0x4fc61b=>{var _0x2f1118=_0x387e3c;_0x521b5a[_0x2f1118(0x1e3)](_0x2f1118(0x269),{'success':_0x17201a[_0x2f1118(0x27c)](_0x2f1118(0x298)),'errors':_0x17201a['flash'](_0x2f1118(0x23a)),'role':_0x2d3e26,'profile':_0x55e4b6,'warehouse':_0x2b11de,'product':_0x3d3de5,'master_shop':_0x2b425f,'language':_0xe589d8,'rooms_data':_0x25908a,'invoice_no':_0x4fc61b});})[_0x387e3c(0x1e6)](_0x1dff19=>{var _0x175ac1=_0x387e3c;_0x17201a[_0x175ac1(0x27c)]('errors',_0x175ac1(0x1f2)),_0x521b5a['redirect'](_0x175ac1(0x27b));});}catch(_0xd9810d){console[_0x387e3c(0x23e)](_0xd9810d);}}),router[a0_0xedd354(0x1f4)](a0_0xedd354(0x28a),auth,async(_0x5ac640,_0x303ca6)=>{var _0xfbd2bf=a0_0xedd354;try{const {warehouse_name:_0x3a42ee,date:_0x531b2b,prod_name:_0x396402,level:_0x2afb6d,isle:_0x4f8bb0,pallet:_0x1dd4b8,stock:_0xbd161e,types:_0x491dcc,adjust_qty:_0x50feb8,new_adjust_qty:_0x18e594,note:_0xa06e84,Room_name:_0x4f41c0,invoice:_0x524cd5,JO_number:_0x3b2305,expiry_date:_0x3b9df8}=_0x5ac640[_0xfbd2bf(0x1f0)];if(typeof _0x396402==_0xfbd2bf(0x241))var _0x1bc2a1=[_0x5ac640[_0xfbd2bf(0x1f0)]['prod_name']],_0x3295ce=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x233)]],_0x4026a3=[_0x5ac640[_0xfbd2bf(0x1f0)]['stock']],_0x485e86=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x283)]],_0x121a81=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x217)]],_0x5a4fe0=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x27d)]],_0x838c35=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x245)]],_0x431a2c=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x26a)]],_0x47366a=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x1d7)]],_0x40d687=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x263)]],_0x4cfe3f=[_0x5ac640['body']['expiry_date']],_0x3f9cf7=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x29a)]],_0x1c5045=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x265)]],_0x4c8cd0=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x296)]],_0x4d9a32=[_0x5ac640[_0xfbd2bf(0x1f0)]['Rooms']],_0x4201d5=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x27a)]],_0x3e4f10=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x284)]],_0x4b98ec=[_0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x293)]],_0x5431cc=[_0x5ac640['body'][_0xfbd2bf(0x21a)]];else var _0x1bc2a1=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x232)]],_0x3295ce=[..._0x5ac640[_0xfbd2bf(0x1f0)]['level']],_0x4026a3=[..._0x5ac640[_0xfbd2bf(0x1f0)]['stock']],_0x485e86=[..._0x5ac640['body']['types']],_0x121a81=[..._0x5ac640[_0xfbd2bf(0x1f0)]['New_Qty_Converted_adj']],_0x5a4fe0=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x27d)]],_0x838c35=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x2a1)]],_0x431a2c=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x26a)]],_0x47366a=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x1d7)]],_0x40d687=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x263)]],_0x4cfe3f=[..._0x5ac640[_0xfbd2bf(0x1f0)]['expiry_date']],_0x3f9cf7=[..._0x5ac640[_0xfbd2bf(0x1f0)]['max_per_unit']],_0x1c5045=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x265)]],_0x4c8cd0=[..._0x5ac640[_0xfbd2bf(0x1f0)]['prod_cat']],_0x4d9a32=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x28e)]],_0x4201d5=[..._0x5ac640[_0xfbd2bf(0x1f0)]['prime1']],_0x3e4f10=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x284)]],_0x4b98ec=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x293)]],_0x5431cc=[..._0x5ac640[_0xfbd2bf(0x1f0)][_0xfbd2bf(0x21a)]];const _0x488ee2=_0x1bc2a1[_0xfbd2bf(0x28c)](_0xd50cf2=>{return _0xd50cf2={'product_name':_0xd50cf2};});_0x3295ce[_0xfbd2bf(0x23d)]((_0x581f4c,_0xee796e)=>{var _0x11bf18=_0xfbd2bf;_0x4d9a32[_0x11bf18(0x23d)]((_0x3c754c,_0x4f059e)=>{var _0x45120d=_0x11bf18;if(_0x3c754c=='Receiving\x20Area'&&_0xee796e==_0x4f059e){var _0x1fe257=_0x581f4c[_0x45120d(0x244)](0x3);_0x488ee2[_0xee796e][_0x45120d(0x28f)]=_0x581f4c[0x0],_0x488ee2[_0xee796e]['rack']=_0x581f4c[0x1],_0x488ee2[_0xee796e][_0x45120d(0x215)]=0x0,_0x488ee2[_0xee796e][_0x45120d(0x271)]=0x0,_0x488ee2[_0xee796e]['type']=_0x45120d(0x26b),_0x488ee2[_0xee796e][_0x45120d(0x252)]=_0x1fe257;}else{if(_0x3c754c=='Shelves'&&_0xee796e==_0x4f059e){var _0x1fe257=_0x581f4c[_0x45120d(0x244)](0x3);_0x488ee2[_0xee796e][_0x45120d(0x28f)]=_0x581f4c[0x0],_0x488ee2[_0xee796e][_0x45120d(0x264)]=_0x581f4c[0x1],_0x488ee2[_0xee796e][_0x45120d(0x215)]=0x0,_0x488ee2[_0xee796e][_0x45120d(0x271)]=0x0,_0x488ee2[_0xee796e][_0x45120d(0x29d)]=_0x45120d(0x26b),_0x488ee2[_0xee796e][_0x45120d(0x252)]=_0x581f4c[0x5];}else{if(_0xee796e==_0x4f059e){var _0x5c2717;if(_0x581f4c[0x4]=='L')_0x5c2717='Level';else _0x581f4c[0x4]=='F'&&(_0x5c2717='Floor');_0x488ee2[_0xee796e]['storage']=_0x581f4c[0x0],_0x488ee2[_0xee796e][_0x45120d(0x264)]=_0x581f4c[0x1],_0x488ee2[_0xee796e][_0x45120d(0x215)]=_0x581f4c[0x2],_0x488ee2[_0xee796e]['bin']=_0x581f4c[0x3],_0x488ee2[_0xee796e][_0x45120d(0x29d)]=_0x5c2717,_0x488ee2[_0xee796e]['floorlevel']=_0x581f4c[0x5];}}}});}),_0x4026a3[_0xfbd2bf(0x23d)]((_0x51682d,_0x1d3489)=>{var _0xe38610=_0xfbd2bf;_0x488ee2[_0x1d3489][_0xe38610(0x228)]=_0x51682d;}),_0x5431cc[_0xfbd2bf(0x23d)]((_0x127596,_0x44e490)=>{var _0x238de8=_0xfbd2bf;_0x488ee2[_0x44e490][_0x238de8(0x200)]=_0x127596;}),_0x485e86[_0xfbd2bf(0x23d)]((_0x48b0b0,_0x56c93a)=>{_0x488ee2[_0x56c93a]['types']=_0x48b0b0;}),_0x121a81['forEach']((_0x201666,_0x478ebb)=>{var _0x48be2b=_0xfbd2bf;_0x488ee2[_0x478ebb][_0x48be2b(0x25d)]=_0x201666;}),_0x5a4fe0[_0xfbd2bf(0x23d)]((_0x4808ab,_0x282a16)=>{var _0xd0e860=_0xfbd2bf;_0x488ee2[_0x282a16][_0xd0e860(0x235)]=_0x4808ab;}),_0x838c35[_0xfbd2bf(0x23d)]((_0x467afe,_0x4ac3ee)=>{_0x488ee2[_0x4ac3ee]['unit']=_0x467afe;}),_0x431a2c[_0xfbd2bf(0x23d)]((_0x212a15,_0x1b413f)=>{var _0x427bce=_0xfbd2bf;_0x488ee2[_0x1b413f][_0x427bce(0x208)]=_0x212a15;}),_0x47366a['forEach']((_0x3e9547,_0x3d5b5)=>{_0x488ee2[_0x3d5b5]['product_code']=_0x3e9547;}),_0x40d687[_0xfbd2bf(0x23d)]((_0x251e66,_0x54e8c2)=>{var _0x341c47=_0xfbd2bf;_0x488ee2[_0x54e8c2][_0x341c47(0x263)]=_0x251e66;}),_0x4cfe3f[_0xfbd2bf(0x23d)]((_0x1810e5,_0xe8a39d)=>{var _0x6e439d=_0xfbd2bf;_0x488ee2[_0xe8a39d][_0x6e439d(0x1e1)]=_0x1810e5;}),_0x3f9cf7['forEach']((_0x325480,_0x194f76)=>{var _0x1889ea=_0xfbd2bf;_0x488ee2[_0x194f76][_0x1889ea(0x21f)]=_0x325480;}),_0x1c5045[_0xfbd2bf(0x23d)]((_0x18afb8,_0x11936f)=>{var _0x6d931e=_0xfbd2bf;_0x488ee2[_0x11936f][_0x6d931e(0x265)]=_0x18afb8;}),_0x4c8cd0[_0xfbd2bf(0x23d)]((_0x1f191d,_0x51a19d)=>{var _0x4867e2=_0xfbd2bf;_0x488ee2[_0x51a19d][_0x4867e2(0x296)]=_0x1f191d;}),_0x4d9a32['forEach']((_0x34575f,_0x1a162b)=>{var _0x40a38c=_0xfbd2bf;_0x488ee2[_0x1a162b][_0x40a38c(0x21e)]=_0x34575f;}),_0x4201d5[_0xfbd2bf(0x23d)]((_0xf30a43,_0x408219)=>{var _0x2800b0=_0xfbd2bf;_0x488ee2[_0x408219][_0x2800b0(0x290)]=_0xf30a43;}),_0x3e4f10[_0xfbd2bf(0x23d)]((_0x81b3f8,_0x5d7225)=>{_0x488ee2[_0x5d7225]['secondary_code']=_0x81b3f8;}),_0x4b98ec['forEach']((_0x5d8fb3,_0x399573)=>{var _0x4d2d1b=_0xfbd2bf;_0x488ee2[_0x399573][_0x4d2d1b(0x26e)]=_0x5d8fb3;});const _0x88f2ba=_0x488ee2[_0xfbd2bf(0x20b)](_0x37dae6=>_0x37dae6['adjust_qty']!=='0'&&_0x37dae6['adjust_qty']!=='');var _0x21a0e6=0x0;_0x88f2ba[_0xfbd2bf(0x23d)](_0x15bc1b=>{var _0x909197=_0xfbd2bf;console[_0x909197(0x23e)]('foreach\x20newproduct',_0x15bc1b),parseInt(_0x15bc1b[_0x909197(0x25d)])<=0x0&&_0x21a0e6++;});if(_0x21a0e6!=0x0)return _0x5ac640[_0xfbd2bf(0x27c)](_0xfbd2bf(0x23a),_0xfbd2bf(0x281)),_0x303ca6[_0xfbd2bf(0x240)](_0xfbd2bf(0x1da));const _0x21724a=new adjustment({'warehouse_name':_0x3a42ee,'date':_0x531b2b,'product':_0x88f2ba,'note':_0xa06e84,'room':_0x4f41c0,'invoice':_0x524cd5,'JO_number':_0x3b2305,'expiry_date':_0x3b9df8}),_0x9fda4f=await _0x21724a[_0xfbd2bf(0x1e2)]();_0x5ac640[_0xfbd2bf(0x27c)](_0xfbd2bf(0x298),_0xfbd2bf(0x1e5)),_0x303ca6[_0xfbd2bf(0x240)](_0xfbd2bf(0x202)+_0x9fda4f['_id']);}catch(_0x43ee6e){console[_0xfbd2bf(0x23e)](_0x43ee6e),_0x303ca6['status'](0xc8)[_0xfbd2bf(0x226)]({'message':_0x43ee6e[_0xfbd2bf(0x1ef)]});}}),router[a0_0xedd354(0x258)](a0_0xedd354(0x239),auth,async(_0x979599,_0x34384e)=>{var _0x54c910=a0_0xedd354;try{const {username:_0x4ec40e,email:_0x4fd612,role:_0x1a23bf}=_0x979599['user'],_0x56c70a=_0x979599[_0x54c910(0x26d)],_0x48a88d=await profile[_0x54c910(0x268)]({'email':_0x56c70a['email']}),_0x4348d0=await master_shop[_0x54c910(0x1ff)](),_0x3a0951=_0x979599[_0x54c910(0x2a0)]['id'],_0x29126f=await adjustment[_0x54c910(0x277)]({'_id':_0x3a0951}),_0x23703a=await purchases[_0x54c910(0x260)]([{'$match':{'warehouse_name':_0x29126f['warehouse_name']}},{'$unwind':_0x54c910(0x262)},{'$group':{'_id':_0x54c910(0x24f)}}]),_0x453aef=await product[_0x54c910(0x1ff)]({}),_0x59e86e=await warehouse[_0x54c910(0x260)]([{'$match':{'name':_0x29126f[_0x54c910(0x248)]}},{'$unwind':_0x54c910(0x1d1)},{'$group':{'_id':_0x54c910(0x206),'name':{'$first':_0x54c910(0x257)},'product_stock':{'$first':_0x54c910(0x1e7)},'bay':{'$first':_0x54c910(0x29e)},'bin':{'$first':_0x54c910(0x292)},'type':{'$first':_0x54c910(0x274)},'floorlevel':{'$first':_0x54c910(0x1eb)},'primary_code':{'$first':_0x54c910(0x1f5)},'secondary_code':{'$first':_0x54c910(0x224)},'product_code':{'$first':_0x54c910(0x225)},'storage':{'$first':_0x54c910(0x255)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x54c910(0x210)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x54c910(0x1ec)},'batch_code':{'$first':_0x54c910(0x291)},'room':{'$first':'$room'}}}]);if(_0x4348d0[0x0][_0x54c910(0x256)]=='English\x20(US)'){var _0x1a004b=users[_0x54c910(0x25c)];console['log'](_0x1a004b);}else{if(_0x4348d0[0x0][_0x54c910(0x256)]==_0x54c910(0x1f3))var _0x1a004b=users['Hindi'];else{if(_0x4348d0[0x0][_0x54c910(0x256)]==_0x54c910(0x242))var _0x1a004b=users[_0x54c910(0x242)];else{if(_0x4348d0[0x0]['language']=='Spanish')var _0x1a004b=users[_0x54c910(0x21b)];else{if(_0x4348d0[0x0][_0x54c910(0x256)]==_0x54c910(0x23b))var _0x1a004b=users['French'];else{if(_0x4348d0[0x0][_0x54c910(0x256)]==_0x54c910(0x1e4))var _0x1a004b=users['Portuguese'];else{if(_0x4348d0[0x0]['language']=='Chinese')var _0x1a004b=users[_0x54c910(0x243)];else{if(_0x4348d0[0x0]['language']=='Arabic\x20(ae)')var _0x1a004b=users[_0x54c910(0x254)];}}}}}}}_0x34384e[_0x54c910(0x1e3)](_0x54c910(0x28b),{'success':_0x979599[_0x54c910(0x27c)](_0x54c910(0x298)),'errors':_0x979599[_0x54c910(0x27c)](_0x54c910(0x23a)),'role':_0x56c70a,'profile':_0x48a88d,'adjustment':_0x29126f,'stock':_0x59e86e,'master_shop':_0x4348d0,'warehouse_name':_0x23703a,'unit':_0x453aef,'language':_0x1a004b});}catch(_0x4b4607){console[_0x54c910(0x23e)](_0x4b4607),_0x34384e[_0x54c910(0x267)](0xc8)[_0x54c910(0x226)]({'message':_0x4b4607[_0x54c910(0x1ef)]});}}),router['post'](a0_0xedd354(0x239),auth,async(_0x48e5e5,_0x13c270)=>{var _0x14d52a=a0_0xedd354;try{const _0x55b77a=_0x48e5e5['params']['id'],{warehouse_name:_0x56b480,Room_name:_0x1b6e8d}=_0x48e5e5[_0x14d52a(0x1f0)],_0x116658=await adjustment[_0x14d52a(0x277)]({'_id':_0x55b77a}),_0x92f942=_0x116658[_0x14d52a(0x273)][_0x14d52a(0x28c)](async _0x300560=>{var _0x3f420e=_0x14d52a;if(_0x300560[_0x3f420e(0x25d)]>0x0){var _0x3579d2=await warehouse[_0x3f420e(0x268)]({'name':_0x56b480,'room':_0x300560[_0x3f420e(0x21e)],'warehouse_category':'Raw\x20Materials'});const _0x42dfb9=_0x3579d2[_0x3f420e(0x1ea)]['map'](_0x2875db=>{var _0x3d75b6=_0x3f420e;if(_0x300560['type']==_0x3d75b6(0x1fe)){if(_0x2875db[_0x3d75b6(0x1d2)]==_0x300560[_0x3d75b6(0x1d2)]&&_0x2875db[_0x3d75b6(0x252)]==_0x300560[_0x3d75b6(0x252)]&&_0x2875db[_0x3d75b6(0x29d)]==_0x300560[_0x3d75b6(0x29d)]&&_0x2875db['bin']==_0x300560[_0x3d75b6(0x271)]&&_0x2875db[_0x3d75b6(0x215)]==_0x300560[_0x3d75b6(0x215)]&&_0x2875db['rack']==_0x300560['rack']&&_0x2875db[_0x3d75b6(0x28f)]==_0x300560['storage']&&_0x2875db['expiry_date']==_0x300560[_0x3d75b6(0x1e1)]&&_0x2875db[_0x3d75b6(0x263)]==_0x300560[_0x3d75b6(0x263)]&&_0x2875db[_0x3d75b6(0x265)]==_0x300560['production_date']&&_0x2875db[_0x3d75b6(0x26e)]==_0x300560[_0x3d75b6(0x26e)]&&_0x2875db['_id']==_0x300560[_0x3d75b6(0x200)]){var _0x1cdb79;_0x1cdb79=_0x300560['adjust_qty'],_0x300560[_0x3d75b6(0x296)]=='S'&&(_0x1cdb79=_0x300560[_0x3d75b6(0x25d)]),_0x2875db[_0x3d75b6(0x29f)]=_0x2875db[_0x3d75b6(0x29f)]-_0x1cdb79;}}else{if(_0x2875db[_0x3d75b6(0x1d2)]==_0x300560[_0x3d75b6(0x1d2)]&&_0x2875db[_0x3d75b6(0x252)]==_0x300560[_0x3d75b6(0x252)]&&_0x2875db[_0x3d75b6(0x29d)]==_0x300560['type']&&_0x2875db[_0x3d75b6(0x271)]==_0x300560[_0x3d75b6(0x271)]&&_0x2875db[_0x3d75b6(0x215)]==_0x300560['bay']&&_0x2875db[_0x3d75b6(0x264)]==_0x300560[_0x3d75b6(0x264)]&&_0x2875db[_0x3d75b6(0x28f)]==_0x300560[_0x3d75b6(0x28f)]&&_0x2875db[_0x3d75b6(0x1e1)]==_0x300560['expiry_date']&&_0x2875db[_0x3d75b6(0x263)]==_0x300560[_0x3d75b6(0x263)]&&_0x2875db[_0x3d75b6(0x265)]==_0x300560[_0x3d75b6(0x265)]&&_0x2875db[_0x3d75b6(0x26e)]==_0x300560[_0x3d75b6(0x26e)]&&_0x2875db[_0x3d75b6(0x213)]==_0x300560[_0x3d75b6(0x200)]){console[_0x3d75b6(0x23e)](_0x300560);var _0x1cdb79;_0x1cdb79=_0x300560['adjust_qty'],_0x300560['prod_cat']=='S'&&(_0x1cdb79=_0x300560[_0x3d75b6(0x25d)]),console['log'](_0x1cdb79+_0x3d75b6(0x24a)+_0x300560[_0x3d75b6(0x25d)]+_0x3d75b6(0x24a)+_0x2875db[_0x3d75b6(0x234)]+_0x3d75b6(0x24a)+_0x300560[_0x3d75b6(0x296)]),_0x2875db['product_stock']=_0x2875db[_0x3d75b6(0x29f)]+_0x1cdb79;}}});}return _0x3579d2;});Promise[_0x14d52a(0x272)](_0x92f942)[_0x14d52a(0x231)](async _0x4d6bb8=>{var _0x4c97b5=_0x14d52a;try{for(const _0x1a745b of _0x4d6bb8){await _0x1a745b[_0x4c97b5(0x1e2)]();}_0x116658['finalize']=_0x4c97b5(0x1fb);const _0x3cd415=await _0x116658[_0x4c97b5(0x1e2)](),_0x2aca1f=await master_shop[_0x4c97b5(0x1ff)](),_0x10f808=await email_settings[_0x4c97b5(0x268)](),_0x249fb8=await supervisor_settings[_0x4c97b5(0x1ff)]();var _0x15e642=_0x116658[_0x4c97b5(0x273)],_0x4efc05='',_0x419130;for(_0x419130 in _0x15e642){_0x4efc05+='<tr>'+_0x4c97b5(0x1f7)+_0x15e642[_0x419130][_0x4c97b5(0x1d2)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15e642[_0x419130]['product_code']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15e642[_0x419130][_0x4c97b5(0x25d)]+_0x4c97b5(0x27f)+_0x4c97b5(0x1f7)+_0x15e642[_0x419130]['unit']+_0x4c97b5(0x27f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15e642[_0x419130][_0x4c97b5(0x208)]+_0x4c97b5(0x27f)+_0x4c97b5(0x1f7)+_0x116658[_0x4c97b5(0x248)]+_0x4c97b5(0x27f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15e642[_0x419130][_0x4c97b5(0x21e)]+'</td>'+_0x4c97b5(0x1f7)+_0x15e642[_0x419130][_0x4c97b5(0x28f)]+_0x15e642[_0x419130]['rack']+_0x15e642[_0x419130][_0x4c97b5(0x215)]+_0x15e642[_0x419130][_0x4c97b5(0x271)]+_0x15e642[_0x419130][_0x4c97b5(0x29d)][0x0]+_0x15e642[_0x419130][_0x4c97b5(0x252)]+'</td>',_0x4c97b5(0x266);}let _0x3a3928=nodemailer[_0x4c97b5(0x1d4)]({'host':_0x10f808['host'],'port':Number(_0x10f808['port']),'secure':![],'auth':{'user':_0x10f808[_0x4c97b5(0x203)],'pass':_0x10f808[_0x4c97b5(0x279)]}}),_0x12c6a0={'from':_0x10f808['email'],'to':_0x249fb8[0x0][_0x4c97b5(0x237)],'subject':_0x4c97b5(0x1e8),'attachments':[{'filename':'Logo.png','path':__dirname+_0x4c97b5(0x1d8)+'/upload/'+_0x2aca1f[0x0]['image'],'cid':_0x4c97b5(0x1d5)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+'</head><body>'+_0x4c97b5(0x251)+_0x4c97b5(0x22e)+'<div>'+_0x4c97b5(0x24c)+_0x4c97b5(0x261)+_0x4c97b5(0x251)+'<h2>\x20'+_0x2aca1f[0x0][_0x4c97b5(0x288)]+_0x4c97b5(0x201)+_0x4c97b5(0x261)+'</div>'+_0x4c97b5(0x287)+'<div>'+_0x4c97b5(0x1f8)+_0x4c97b5(0x20c)+_0x116658['invoice']+'\x20'+_0x4c97b5(0x1f1)+_0x4c97b5(0x299)+_0x116658[_0x4c97b5(0x1fc)]+'\x20'+_0x4c97b5(0x294)+_0x4c97b5(0x22a)+_0x4c97b5(0x261)+_0x4c97b5(0x209)+_0x4c97b5(0x1e9)+'<tr>'+_0x4c97b5(0x1d6)+_0x4c97b5(0x29c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x4c97b5(0x1dc)+_0x4c97b5(0x219)+_0x4c97b5(0x229)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x4c97b5(0x250)+_0x4c97b5(0x266)+'</thead>'+_0x4c97b5(0x214)+'\x20'+_0x4efc05+'\x20'+_0x4c97b5(0x27e)+_0x4c97b5(0x26f)+_0x4c97b5(0x251)+_0x4c97b5(0x1df)+_0x4c97b5(0x1ee)+_0x2aca1f[0x0][_0x4c97b5(0x288)]+'</h5>'+_0x4c97b5(0x261)+'</div>'+_0x4c97b5(0x23c)};_0x3a3928[_0x4c97b5(0x211)](_0x12c6a0,function(_0x55830f,_0x5152b7){var _0x2675a1=_0x4c97b5;_0x55830f?(console[_0x2675a1(0x23e)](_0x55830f),console[_0x2675a1(0x23e)](_0x2675a1(0x1fd))):console['log'](_0x2675a1(0x22d));}),_0x48e5e5[_0x4c97b5(0x27c)](_0x4c97b5(0x298),_0x4c97b5(0x295)),_0x13c270[_0x4c97b5(0x240)]('/picking_list/PDF_adjustment_rm/'+_0x3cd415[_0x4c97b5(0x213)]);}catch(_0x446e56){console[_0x4c97b5(0x24b)](_0x446e56),_0x13c270[_0x4c97b5(0x267)](0x1f4)[_0x4c97b5(0x226)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x14d52a(0x1e6)](_0x2e3f96=>{var _0x26f6ca=_0x14d52a;console[_0x26f6ca(0x24b)](_0x2e3f96),_0x13c270[_0x26f6ca(0x267)](0x1f4)['json']({'error':_0x26f6ca(0x212)});});}catch(_0xdb30d7){console[_0x14d52a(0x23e)](_0xdb30d7),_0x13c270[_0x14d52a(0x267)](0xc8)[_0x14d52a(0x226)]({'message':_0xdb30d7['message']});}}),router[a0_0xedd354(0x258)](a0_0xedd354(0x24e),auth,async(_0xbd0b79,_0x42c6d0)=>{var _0x4282af=a0_0xedd354;try{const {username:_0x368349,email:_0x550349,role:_0x3c630d}=_0xbd0b79[_0x4282af(0x26d)],_0x96a27d=_0xbd0b79[_0x4282af(0x26d)],_0x54e95a=await profile[_0x4282af(0x268)]({'email':_0x96a27d[_0x4282af(0x203)]}),_0x48067e=await master_shop[_0x4282af(0x1ff)](),_0x228731=_0xbd0b79[_0x4282af(0x2a0)]['id'],_0x9cac47=await adjustment[_0x4282af(0x277)]({'_id':_0x228731}),_0x180a3d=await purchases[_0x4282af(0x260)]([{'$match':{'warehouse_name':_0x9cac47['warehouse_name']}},{'$unwind':_0x4282af(0x262)},{'$group':{'_id':_0x4282af(0x24f)}}]),_0x519f95=await product[_0x4282af(0x1ff)]({}),_0x461421=await warehouse[_0x4282af(0x260)]([{'$match':{'name':_0x9cac47[_0x4282af(0x248)]}},{'$unwind':_0x4282af(0x1d1)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4282af(0x1e7)},'bay':{'$first':_0x4282af(0x29e)},'bin':{'$first':_0x4282af(0x292)},'type':{'$first':_0x4282af(0x274)},'floorlevel':{'$first':_0x4282af(0x1eb)},'primary_code':{'$first':_0x4282af(0x1f5)},'secondary_code':{'$first':_0x4282af(0x224)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4282af(0x255)},'rack':{'$first':_0x4282af(0x1f6)},'maxPerUnit':{'$first':_0x4282af(0x210)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4282af(0x291)},'room':{'$first':'$room'}}}]);let _0x1bf55e;if(_0x96a27d[_0x4282af(0x1dd)]==_0x4282af(0x24d)){const _0x4ca903=await staff['findOne']({'email':_0x96a27d[_0x4282af(0x203)]});_0x1bf55e=await warehouse[_0x4282af(0x260)]([{'$match':{'status':'Enabled','name':_0x4ca903[_0x4282af(0x204)],'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x4282af(0x29b)}}}]);}else _0x1bf55e=await warehouse[_0x4282af(0x260)]([{'$match':{'status':_0x4282af(0x25a),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x4282af(0x25f)}}},{'$group':{'_id':_0x4282af(0x29b),'name':{'$first':_0x4282af(0x29b)}}}]);if(_0x48067e[0x0]['language']==_0x4282af(0x25b)){var _0x5f02b4=users[_0x4282af(0x25c)];console[_0x4282af(0x23e)](_0x5f02b4);}else{if(_0x48067e[0x0][_0x4282af(0x256)]==_0x4282af(0x1f3))var _0x5f02b4=users[_0x4282af(0x1f3)];else{if(_0x48067e[0x0][_0x4282af(0x256)]==_0x4282af(0x242))var _0x5f02b4=users[_0x4282af(0x242)];else{if(_0x48067e[0x0][_0x4282af(0x256)]=='Spanish')var _0x5f02b4=users[_0x4282af(0x21b)];else{if(_0x48067e[0x0][_0x4282af(0x256)]==_0x4282af(0x23b))var _0x5f02b4=users[_0x4282af(0x23b)];else{if(_0x48067e[0x0][_0x4282af(0x256)]==_0x4282af(0x1e4))var _0x5f02b4=users[_0x4282af(0x1fa)];else{if(_0x48067e[0x0][_0x4282af(0x256)]==_0x4282af(0x243))var _0x5f02b4=users['Chinese'];else{if(_0x48067e[0x0]['language']==_0x4282af(0x270))var _0x5f02b4=users[_0x4282af(0x254)];}}}}}}}_0x42c6d0[_0x4282af(0x1e3)]('edit_adjustment',{'success':_0xbd0b79[_0x4282af(0x27c)](_0x4282af(0x298)),'errors':_0xbd0b79['flash'](_0x4282af(0x23a)),'role':_0x96a27d,'profile':_0x54e95a,'adjustment':_0x9cac47,'stock':_0x461421,'master_shop':_0x48067e,'warehouse_name':_0x180a3d,'unit':_0x519f95,'language':_0x5f02b4,'warehouse':_0x1bf55e});}catch(_0x1803c2){console[_0x4282af(0x23e)](_0x1803c2),_0x42c6d0[_0x4282af(0x267)](0xc8)['json']({'message':_0x1803c2['message']});}}),router[a0_0xedd354(0x1f4)](a0_0xedd354(0x24e),auth,async(_0xdbda81,_0x5ca5bd)=>{var _0x12cdbf=a0_0xedd354;try{const _0x2223ae=_0xdbda81[_0x12cdbf(0x2a0)]['id'],_0x5f1f6f=await adjustment[_0x12cdbf(0x277)]({'_id':_0x2223ae}),_0x31ca02=await warehouse[_0x12cdbf(0x268)]({'name':_0x5f1f6f[_0x12cdbf(0x248)],'room':_0x5f1f6f['room']}),{warehouse_name:_0x515f87,date:_0x5a49ff,prod_name:_0x465b8d,level:_0x241672,isle:_0x53b3c5,pallet:_0x4f639c,stock:_0x1cf7a1,types:_0xfeb3bb,adjust_qty:_0x24f439,new_adjust_qty:_0x53e889,note:_0x273509,Room_name:_0xb675b5,invoice:_0x5b0d84,JO_number:_0x11a5b7,expiry_date:_0x95f805}=_0xdbda81[_0x12cdbf(0x1f0)];if(typeof _0x465b8d==_0x12cdbf(0x241))var _0x1fce57=[_0xdbda81['body'][_0x12cdbf(0x232)]],_0x5dcfc5=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x233)]],_0x28f3d0=[_0xdbda81['body']['stock']],_0x360bb7=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x283)]],_0x30f983=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x217)]],_0x4c428e=[_0xdbda81[_0x12cdbf(0x1f0)]['New_Qty_Converted']],_0x3ae363=[_0xdbda81['body'][_0x12cdbf(0x245)]],_0x4924b4=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x26a)]],_0x2a90a8=[_0xdbda81['body'][_0x12cdbf(0x1d7)]],_0x38efd1=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x263)]],_0x222390=[_0xdbda81['body'][_0x12cdbf(0x1e1)]],_0x1bbd04=[_0xdbda81['body'][_0x12cdbf(0x29a)]],_0x5dfaaa=[_0xdbda81['body']['production_date']],_0x5afe90=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x296)]],_0x141051=[_0xdbda81['body'][_0x12cdbf(0x28e)]],_0x5324b4=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x27a)]],_0x4442f4=[_0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x284)]];else var _0x1fce57=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x232)]],_0x5dcfc5=[..._0xdbda81[_0x12cdbf(0x1f0)]['level']],_0x28f3d0=[..._0xdbda81['body']['stock']],_0x360bb7=[..._0xdbda81['body']['types']],_0x30f983=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x217)]],_0x4c428e=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x27d)]],_0x3ae363=[..._0xdbda81['body'][_0x12cdbf(0x2a1)]],_0x4924b4=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x26a)]],_0x2a90a8=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x1d7)]],_0x38efd1=[..._0xdbda81['body'][_0x12cdbf(0x263)]],_0x222390=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x1e1)]],_0x1bbd04=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x29a)]],_0x5dfaaa=[..._0xdbda81['body'][_0x12cdbf(0x265)]],_0x5afe90=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x296)]],_0x141051=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x28e)]],_0x5324b4=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x27a)]],_0x4442f4=[..._0xdbda81[_0x12cdbf(0x1f0)][_0x12cdbf(0x284)]];const _0x25be99=_0x1fce57[_0x12cdbf(0x28c)](_0x3aff30=>{return _0x3aff30={'product_name':_0x3aff30};});_0x5dcfc5[_0x12cdbf(0x23d)]((_0x212e71,_0x68410f)=>{var _0x1838a2=_0x12cdbf;_0x141051[_0x1838a2(0x23d)]((_0x350593,_0x35f114)=>{var _0x3ce2d2=_0x1838a2;if(_0x350593==_0x3ce2d2(0x1db)&&_0x68410f==_0x35f114){var _0x3a325b=_0x212e71['slice'](0x3);_0x25be99[_0x68410f][_0x3ce2d2(0x28f)]=_0x212e71[0x0],_0x25be99[_0x68410f]['rack']=_0x212e71[0x1],_0x25be99[_0x68410f][_0x3ce2d2(0x215)]=0x0,_0x25be99[_0x68410f][_0x3ce2d2(0x271)]=0x0,_0x25be99[_0x68410f][_0x3ce2d2(0x29d)]=_0x3ce2d2(0x26b),_0x25be99[_0x68410f][_0x3ce2d2(0x252)]=_0x3a325b;}else{if(_0x350593==_0x3ce2d2(0x289)&&_0x68410f==_0x35f114){var _0x3a325b=_0x212e71['slice'](0x3);_0x25be99[_0x68410f][_0x3ce2d2(0x28f)]=_0x212e71[0x0],_0x25be99[_0x68410f][_0x3ce2d2(0x264)]=_0x212e71[0x1],_0x25be99[_0x68410f][_0x3ce2d2(0x215)]=0x0,_0x25be99[_0x68410f][_0x3ce2d2(0x271)]=0x0,_0x25be99[_0x68410f][_0x3ce2d2(0x29d)]=_0x3ce2d2(0x26b),_0x25be99[_0x68410f]['floorlevel']=_0x212e71[0x5];}else{if(_0x68410f==_0x35f114){var _0x2e9c8e;if(_0x212e71[0x4]=='L')_0x2e9c8e=_0x3ce2d2(0x21d);else _0x212e71[0x4]=='F'&&(_0x2e9c8e='Floor');_0x25be99[_0x68410f][_0x3ce2d2(0x28f)]=_0x212e71[0x0],_0x25be99[_0x68410f][_0x3ce2d2(0x264)]=_0x212e71[0x1],_0x25be99[_0x68410f][_0x3ce2d2(0x215)]=_0x212e71[0x2],_0x25be99[_0x68410f][_0x3ce2d2(0x271)]=_0x212e71[0x3],_0x25be99[_0x68410f][_0x3ce2d2(0x29d)]=_0x2e9c8e,_0x25be99[_0x68410f][_0x3ce2d2(0x252)]=_0x212e71[0x5];}}}});}),_0x28f3d0[_0x12cdbf(0x23d)]((_0x411fc2,_0x2de9d5)=>{var _0x3d30b1=_0x12cdbf;_0x25be99[_0x2de9d5][_0x3d30b1(0x228)]=_0x411fc2;}),_0x360bb7['forEach']((_0x17aa0f,_0x441857)=>{var _0x4e9c2c=_0x12cdbf;_0x25be99[_0x441857][_0x4e9c2c(0x283)]=_0x17aa0f;}),_0x30f983[_0x12cdbf(0x23d)]((_0x275d65,_0x56d087)=>{var _0x17887c=_0x12cdbf;_0x25be99[_0x56d087][_0x17887c(0x25d)]=_0x275d65;}),_0x4c428e[_0x12cdbf(0x23d)]((_0xa30650,_0x582dfb)=>{_0x25be99[_0x582dfb]['new_adjust_qty']=_0xa30650;}),_0x3ae363[_0x12cdbf(0x23d)]((_0x429cc7,_0x442d9c)=>{var _0x5aeb5e=_0x12cdbf;_0x25be99[_0x442d9c][_0x5aeb5e(0x2a1)]=_0x429cc7;}),_0x4924b4['forEach']((_0x26e9fe,_0x36a2f7)=>{var _0xdf4369=_0x12cdbf;_0x25be99[_0x36a2f7][_0xdf4369(0x208)]=_0x26e9fe;}),_0x2a90a8['forEach']((_0xf7a6da,_0x511dce)=>{var _0x3dec22=_0x12cdbf;_0x25be99[_0x511dce][_0x3dec22(0x259)]=_0xf7a6da;}),_0x38efd1[_0x12cdbf(0x23d)]((_0x1e0997,_0x13f63d)=>{_0x25be99[_0x13f63d]['batch_code']=_0x1e0997;}),_0x222390[_0x12cdbf(0x23d)]((_0x2085a4,_0x1cb207)=>{var _0x542b98=_0x12cdbf;_0x25be99[_0x1cb207][_0x542b98(0x1e1)]=_0x2085a4;}),_0x1bbd04[_0x12cdbf(0x23d)]((_0x45bec8,_0x11b647)=>{var _0x3f6c5a=_0x12cdbf;_0x25be99[_0x11b647][_0x3f6c5a(0x21f)]=_0x45bec8;}),_0x5dfaaa[_0x12cdbf(0x23d)]((_0x2911a0,_0x16c4b9)=>{var _0x2a6d52=_0x12cdbf;_0x25be99[_0x16c4b9][_0x2a6d52(0x265)]=_0x2911a0;}),_0x5afe90['forEach']((_0x5df319,_0x46acea)=>{_0x25be99[_0x46acea]['prod_cat']=_0x5df319;}),_0x141051[_0x12cdbf(0x23d)]((_0x547e14,_0x2daebe)=>{var _0x7f9b96=_0x12cdbf;_0x25be99[_0x2daebe][_0x7f9b96(0x21e)]=_0x547e14;}),_0x5324b4['forEach']((_0x14b070,_0x489a27)=>{var _0x91c488=_0x12cdbf;_0x25be99[_0x489a27][_0x91c488(0x290)]=_0x14b070;}),_0x4442f4[_0x12cdbf(0x23d)]((_0x28dc08,_0x398967)=>{var _0x1bae6b=_0x12cdbf;_0x25be99[_0x398967][_0x1bae6b(0x221)]=_0x28dc08;});const _0x3ebd54=_0x25be99[_0x12cdbf(0x20b)](_0x4d4c48=>_0x4d4c48[_0x12cdbf(0x25d)]!=='0'&&_0x4d4c48[_0x12cdbf(0x25d)]!=='');var _0x1df4c6=0x0;_0x3ebd54[_0x12cdbf(0x23d)](_0x4b0df5=>{var _0x18893e=_0x12cdbf;console[_0x18893e(0x23e)](_0x18893e(0x20d),_0x4b0df5),parseInt(_0x4b0df5[_0x18893e(0x25d)])<=0x0&&_0x1df4c6++;});if(_0x1df4c6!=0x0)return _0xdbda81[_0x12cdbf(0x27c)](_0x12cdbf(0x23a),_0x12cdbf(0x281)),_0x5ca5bd['redirect'](_0x12cdbf(0x1da));_0x5f1f6f[_0x12cdbf(0x248)]=_0x515f87,_0x5f1f6f[_0x12cdbf(0x1fc)]=_0x5a49ff,_0x5f1f6f[_0x12cdbf(0x273)]=_0x3ebd54,_0x5f1f6f[_0x12cdbf(0x20a)]=_0x273509,_0x5f1f6f[_0x12cdbf(0x26e)]=_0x5b0d84,_0x5f1f6f['isAllowEdit']=_0x12cdbf(0x23f);const _0xa2c6f6=await _0x5f1f6f[_0x12cdbf(0x1e2)]();_0xdbda81[_0x12cdbf(0x27c)](_0x12cdbf(0x298),'adjustment\x20data\x20update\x20successfully'),_0x5ca5bd['redirect'](_0x12cdbf(0x27b));}catch(_0x17b4d7){console[_0x12cdbf(0x23e)](_0x17b4d7);}}),router[a0_0xedd354(0x1f4)]('/barcode_scanner',async(_0x47c43a,_0x106524)=>{var _0x30e238=a0_0xedd354;const {primary_code:_0x566038,warehouse_data:_0x70047a,rooms_data:_0x20439c,Roomslist:_0x38928c}=_0x47c43a[_0x30e238(0x1f0)],_0x10f95f=_0x38928c[_0x30e238(0x230)](','),_0x2d1d5b=[];async function _0x4a93f2(_0x386500){var _0x3e7716=_0x30e238;const _0x2f1780=await warehouse[_0x3e7716(0x260)]([{'$match':{'name':_0x70047a,'room':_0x386500}},{'$unwind':_0x3e7716(0x1d1)},{'$match':{'product_details.primary_code':_0x566038}},{'$group':{'_id':_0x3e7716(0x206),'name':{'$first':_0x3e7716(0x257)},'product_stock':{'$first':_0x3e7716(0x1e7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3e7716(0x224)},'product_code':{'$first':_0x3e7716(0x225)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3e7716(0x292)},'type':{'$first':_0x3e7716(0x274)},'pallet':{'$first':_0x3e7716(0x1eb)},'unit':{'$first':_0x3e7716(0x278)},'secondary_unit':{'$first':_0x3e7716(0x220)},'storage':{'$first':_0x3e7716(0x255)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x3e7716(0x210)},'batch_code':{'$first':_0x3e7716(0x291)},'product_cat':{'$first':_0x3e7716(0x207)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3e7716(0x285)},'invoice':{'$first':_0x3e7716(0x20f)}}}]),_0x47bdfb=await warehouse[_0x3e7716(0x260)]([{'$match':{'name':_0x70047a,'room':_0x386500}},{'$unwind':_0x3e7716(0x1d1)},{'$match':{'product_details.secondary_code':_0x566038}},{'$group':{'_id':_0x3e7716(0x206),'name':{'$first':_0x3e7716(0x257)},'product_stock':{'$first':_0x3e7716(0x1e7)},'primary_code':{'$first':_0x3e7716(0x1f5)},'secondary_code':{'$first':_0x3e7716(0x224)},'product_code':{'$first':_0x3e7716(0x225)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3e7716(0x292)},'type':{'$first':_0x3e7716(0x274)},'pallet':{'$first':_0x3e7716(0x1eb)},'unit':{'$first':_0x3e7716(0x278)},'secondary_unit':{'$first':_0x3e7716(0x220)},'storage':{'$first':_0x3e7716(0x255)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3e7716(0x227)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3e7716(0x207)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3e7716(0x285)}}}]);if(_0x2f1780['length']>0x0)_0x2d1d5b['push'](_0x2f1780);else _0x47bdfb[_0x3e7716(0x253)]>0x0&&_0x2d1d5b[_0x3e7716(0x280)](_0x47bdfb);}const _0x5e2b56=_0x10f95f[_0x30e238(0x28c)](_0x3f0a73=>_0x4a93f2(_0x3f0a73));await Promise['all'](_0x5e2b56),_0x106524[_0x30e238(0x226)](_0x2d1d5b);}),router[a0_0xedd354(0x1f4)](a0_0xedd354(0x282),async(_0x5be3fc,_0x50a038)=>{var _0x328d98=a0_0xedd354;const {primaryCode:_0x45b29e,secondaryCode:_0x5db419,productCode:_0x47551d,level:_0x4e35ca,isle:_0x5467ed,pallet:_0x3beff9,warehouses:_0x2fba44,room:_0x47554f}=_0x5be3fc[_0x328d98(0x1f0)];try{const _0x564f80=await warehouse[_0x328d98(0x260)]([{'$match':{'name':_0x2fba44,'room':_0x47554f}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x4e35ca),'product_details.isle':_0x5467ed,'product_details.pallet':parseInt(_0x3beff9)}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x328d98(0x1e7)},'level':{'$first':_0x328d98(0x236)},'isle':{'$first':_0x328d98(0x218)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x328d98(0x21c)}}}]);_0x50a038['status'](0xc8)['json'](_0x564f80);}catch(_0xe523){_0x50a038[_0x328d98(0x267)](0x194)[_0x328d98(0x226)]({'message':_0xe523[_0x328d98(0x1ef)]});}}),module['exports']=router;