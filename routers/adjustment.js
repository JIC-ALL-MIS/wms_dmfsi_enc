var a0_0x266171=a0_0x3822;(function(_0x49b4cc,_0x5ef9af){var _0x3ee7c7=a0_0x3822,_0x567063=_0x49b4cc();while(!![]){try{var _0x919e49=-parseInt(_0x3ee7c7(0x1bf))/0x1*(-parseInt(_0x3ee7c7(0x1c3))/0x2)+parseInt(_0x3ee7c7(0x224))/0x3*(parseInt(_0x3ee7c7(0x281))/0x4)+parseInt(_0x3ee7c7(0x217))/0x5*(-parseInt(_0x3ee7c7(0x21c))/0x6)+-parseInt(_0x3ee7c7(0x1f8))/0x7*(-parseInt(_0x3ee7c7(0x271))/0x8)+-parseInt(_0x3ee7c7(0x22d))/0x9*(parseInt(_0x3ee7c7(0x249))/0xa)+parseInt(_0x3ee7c7(0x247))/0xb*(-parseInt(_0x3ee7c7(0x26b))/0xc)+-parseInt(_0x3ee7c7(0x244))/0xd*(-parseInt(_0x3ee7c7(0x1ff))/0xe);if(_0x919e49===_0x5ef9af)break;else _0x567063['push'](_0x567063['shift']());}catch(_0x46991f){_0x567063['push'](_0x567063['shift']());}}}(a0_0x5771,0x2a53b));function a0_0x3822(_0xaa2057,_0x46490d){var _0x577117=a0_0x5771();return a0_0x3822=function(_0x382248,_0x2109b2){_0x382248=_0x382248-0x1b1;var _0x42673d=_0x577117[_0x382248];return _0x42673d;},a0_0x3822(_0xaa2057,_0x46490d);}const express=require('express'),app=express(),router=express[a0_0x266171(0x23f)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x266171(0x229)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x266171(0x1f5)](a0_0x266171(0x1e3),auth,async(_0x2d142f,_0x21c48b)=>{var _0x1f2bb7=a0_0x266171;try{const {username:_0x36c8fe,email:_0x2c61c0,role:_0x2ea2c8}=_0x2d142f['user'],_0x45300d=_0x2d142f[_0x1f2bb7(0x230)],_0x2841ee=await profile[_0x1f2bb7(0x236)]({'email':_0x45300d['email']}),_0xfb0827=await master_shop[_0x1f2bb7(0x1bb)]();console['log']('master',_0xfb0827);let _0x13da52;if(_0x45300d[_0x1f2bb7(0x1df)]==_0x1f2bb7(0x22f)){const _0x57433c=await staff[_0x1f2bb7(0x236)]({'email':_0x45300d[_0x1f2bb7(0x1de)]});_0x13da52=await warehouse[_0x1f2bb7(0x1bb)]({'status':'Enabled','name':_0x57433c[_0x1f2bb7(0x240)]});}else _0x13da52=await warehouse[_0x1f2bb7(0x1bb)]({'status':_0x1f2bb7(0x1b5)});const _0xc99ed4=await product['find']();let _0x2f733d;if(_0x45300d[_0x1f2bb7(0x1df)]==_0x1f2bb7(0x22f)){const _0x16faf0=await staff[_0x1f2bb7(0x236)]({'email':_0x45300d[_0x1f2bb7(0x1de)]});_0x2f733d=await adjustment[_0x1f2bb7(0x1bb)]({'warehouse_name':_0x16faf0[_0x1f2bb7(0x240)]});}else _0x2f733d=await adjustment['aggregate']([{'$unwind':_0x1f2bb7(0x250)},{'$group':{'_id':_0x1f2bb7(0x1f2),'invoice':{'$first':_0x1f2bb7(0x231)},'date':{'$first':_0x1f2bb7(0x22e)},'warehouse_name':{'$first':_0x1f2bb7(0x24e)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x1f2bb7(0x242)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xfb0827[0x0]['language']==_0x1f2bb7(0x270)){var _0xb22f0e=users[_0x1f2bb7(0x211)];console[_0x1f2bb7(0x1b8)](_0xb22f0e);}else{if(_0xfb0827[0x0][_0x1f2bb7(0x24b)]==_0x1f2bb7(0x1ec))var _0xb22f0e=users[_0x1f2bb7(0x1ec)];else{if(_0xfb0827[0x0][_0x1f2bb7(0x24b)]=='German')var _0xb22f0e=users[_0x1f2bb7(0x1c8)];else{if(_0xfb0827[0x0][_0x1f2bb7(0x24b)]==_0x1f2bb7(0x1c7))var _0xb22f0e=users[_0x1f2bb7(0x1c7)];else{if(_0xfb0827[0x0][_0x1f2bb7(0x24b)]==_0x1f2bb7(0x1fa))var _0xb22f0e=users[_0x1f2bb7(0x1fa)];else{if(_0xfb0827[0x0]['language']==_0x1f2bb7(0x214))var _0xb22f0e=users['Portuguese'];else{if(_0xfb0827[0x0][_0x1f2bb7(0x24b)]==_0x1f2bb7(0x222))var _0xb22f0e=users[_0x1f2bb7(0x222)];else{if(_0xfb0827[0x0]['language']==_0x1f2bb7(0x216))var _0xb22f0e=users['Arabic'];}}}}}}}_0x21c48b['render'](_0x1f2bb7(0x1d1),{'success':_0x2d142f[_0x1f2bb7(0x1f6)](_0x1f2bb7(0x1bd)),'errors':_0x2d142f[_0x1f2bb7(0x1f6)](_0x1f2bb7(0x1d3)),'role':_0x45300d,'profile':_0x2841ee,'warehouse':_0x13da52,'product':_0xc99ed4,'adjustment':_0x2f733d,'master_shop':_0xfb0827,'language':_0xb22f0e});}catch(_0x1106cd){console[_0x1f2bb7(0x1b8)](_0x1106cd);}});async function getRandom8DigitNumber(){var _0x297ca7=a0_0x266171;const _0x4d1921=0x989680,_0x1a8166=0x5f5e0ff,_0x525f52=Math[_0x297ca7(0x25c)](Math['random']()*(_0x1a8166-_0x4d1921+0x1))+_0x4d1921;var _0x7d826;const _0x2d5bbb=await adjustment[_0x297ca7(0x236)]({'invoice':_0x297ca7(0x1e8)+_0x525f52});return _0x2d5bbb&&_0x2d5bbb['length']>0x0?_0x7d826=_0x297ca7(0x1e8)+_0x525f52:_0x7d826=_0x297ca7(0x1e8)+_0x525f52,_0x7d826;}function a0_0x5771(){var _0x2c4349=['isAllowEdit','params','Spanish','German','Return\x20Rooms','$product_details.floorlevel','<h2>\x20','rack','slice','adjustment\x20data\x20update\x20successfully','invoice','$name','adjustment','$room','errors','redirect','floorlevel','date','$product_details.expiry_date','batch_code','Primary_Units','unit','/adjustment/view','$product_details.rack','$product_details.product_cat','email','role','<h5>','split','forEach','/view','/preview/:id','save','$product_details.level','site_title','ADJ-','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','room','all','Hindi','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Email\x20sent\x20successfully','level','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$_id','_id','Arabic','get','flash','storage','510895GukQFX','New_Qty_Converted_adj','French','warehouse_name','add_adjustment','$product_details.maxPerUnit','new_adjust_qty','2058JuStLp','Return\x20Goods','\x20Order\x20Number\x20:\x20','\x20Order\x20Date\x20:\x20','$product_details.pallet','<tr>','findById','$product_details.product_code','$product_details','$product_details.production_date','production_date','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','push','Shelves','</div>','<div>','English','type','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Portuguese\x20(BR)','host','Arabic\x20(ae)','61995WVZHoB','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.secondary_code','body','</thead>','42QNPVFg','/../public','</span>','stockBefore','adjust_qty','post','Chinese','There\x27s\x20a\x20error\x20in\x20this\x20transaction','987RcDzqv','</td>','types','expiry_date','Error\x20Occurs','../models/all_models','RMSEmail','$product_details.product_name','product_name','695646sKhFBb','$date','staff','user','$invoice','<strong>\x20Regards\x20</strong>','room_names','primary_code','Ambient','findOne','\x20<>\x20','render','note','Level','$product_details.unit','toString','</table>','Portuguese','Router','warehouse','port','$isAllowEdit','maxPerUnit','17056tMvrPs','second1','/adjustment/preview/','11nWuFQL','bay','30NTEVHu','product','language','map','filter','$warehouse_name','aggregate','$product','prod_cat','Enclosed','length','adjustment\x20add\x20successfull','padStart','max_per_unit','</tbody>','$product_details.isle','secondary_unit','prod_name','<html><head><title></title>','floor','json','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','error','Raw\x20Materials','</h5>','/view/:id','$product_details.bay','Rooms','New_Qty_Converted','string','$product_details.primary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.bin','3224472jndTnS','$product_details.storage','prod_code','<!DOCTYPE\x20html>','adjustment\x20Finalized\x20successfully','English\x20(US)','24biCHzj','Adjustment\x20Mail','prime1','exports','$product.product_name','product_stock','$product_details.batch_code','catch','foreach\x20newproduct','image','$product_details._id','</body></html>','\x20</h2>','$product_details.secondary_unit','False','bin','1540AfzGzE','/view/add_adjustment','/CheckingWarehouse','</tr>','message','sendMail','createTransport','Enabled','secondary_code','edit_adjustment_view','log','$product_details.product_stock','<hr\x20class=\x22my-3\x22>','find','finalize','success','status','111134IJMbrK','Secondary_units','password','stock','4bfMODK','Floor'];a0_0x5771=function(){return _0x2c4349;};return a0_0x5771();}router[a0_0x266171(0x1f5)](a0_0x266171(0x282),auth,async(_0x2483ee,_0x2e6c1c)=>{var _0x50e853=a0_0x266171;try{const {username:_0x4b59a0,email:_0x2c90d5,role:_0x1fe34c}=_0x2483ee[_0x50e853(0x230)],_0x38aabd=_0x2483ee[_0x50e853(0x230)],_0x52c1e2=await profile['findOne']({'email':_0x38aabd[_0x50e853(0x1de)]}),_0x416a65=await master_shop[_0x50e853(0x1bb)]();let _0x3c3cb0;if(_0x38aabd[_0x50e853(0x1df)]==_0x50e853(0x22f)){const _0x431791=await staff[_0x50e853(0x236)]({'email':_0x38aabd[_0x50e853(0x1de)]});_0x3c3cb0=await warehouse['aggregate']([{'$match':{'status':_0x50e853(0x1b5),'name':_0x431791['warehouse'],'warehouse_category':_0x50e853(0x261),'name':{'$ne':_0x50e853(0x200)}}},{'$group':{'_id':_0x50e853(0x1d0),'name':{'$first':'$name'}}}]);}else _0x3c3cb0=await warehouse['aggregate']([{'$match':{'status':_0x50e853(0x1b5),'warehouse_category':_0x50e853(0x261),'name':{'$ne':_0x50e853(0x200)}}},{'$group':{'_id':_0x50e853(0x1d0),'name':{'$first':_0x50e853(0x1d0)}}}]);const _0x178a36=await product[_0x50e853(0x1bb)]({}),_0x4cb772=await adjustment['find']({}),_0x398dae=_0x4cb772[_0x50e853(0x253)]+0x1,_0x1ef7c4=_0x50e853(0x1e8)+_0x398dae[_0x50e853(0x23c)]()[_0x50e853(0x255)](0x5,'0');var _0x6145ac=[_0x50e853(0x235),_0x50e853(0x252),_0x50e853(0x1c9)];if(_0x416a65[0x0][_0x50e853(0x24b)]==_0x50e853(0x270))var _0x2b3eab=users['English'];else{if(_0x416a65[0x0]['language']==_0x50e853(0x1ec))var _0x2b3eab=users[_0x50e853(0x1ec)];else{if(_0x416a65[0x0][_0x50e853(0x24b)]=='German')var _0x2b3eab=users[_0x50e853(0x1c8)];else{if(_0x416a65[0x0][_0x50e853(0x24b)]=='Spanish')var _0x2b3eab=users[_0x50e853(0x1c7)];else{if(_0x416a65[0x0][_0x50e853(0x24b)]==_0x50e853(0x1fa))var _0x2b3eab=users[_0x50e853(0x1fa)];else{if(_0x416a65[0x0][_0x50e853(0x24b)]=='Portuguese\x20(BR)')var _0x2b3eab=users[_0x50e853(0x23e)];else{if(_0x416a65[0x0][_0x50e853(0x24b)]==_0x50e853(0x222))var _0x2b3eab=users[_0x50e853(0x222)];else{if(_0x416a65[0x0][_0x50e853(0x24b)]==_0x50e853(0x216))var _0x2b3eab=users[_0x50e853(0x1f4)];}}}}}}}const _0x1b98c0=getRandom8DigitNumber();_0x1b98c0['then'](_0x3f05fb=>{var _0x572c50=_0x50e853;_0x2e6c1c[_0x572c50(0x238)](_0x572c50(0x1fc),{'success':_0x2483ee[_0x572c50(0x1f6)](_0x572c50(0x1bd)),'errors':_0x2483ee[_0x572c50(0x1f6)](_0x572c50(0x1d3)),'role':_0x38aabd,'profile':_0x52c1e2,'warehouse':_0x3c3cb0,'product':_0x178a36,'master_shop':_0x416a65,'language':_0x2b3eab,'rooms_data':_0x6145ac,'invoice_no':_0x3f05fb});})[_0x50e853(0x278)](_0x2a256d=>{var _0x139535=_0x50e853;_0x2483ee[_0x139535(0x1f6)](_0x139535(0x1d3),_0x139535(0x223)),_0x2e6c1c[_0x139535(0x1d4)]('/adjustment/view');});}catch(_0xe19e8e){console[_0x50e853(0x1b8)](_0xe19e8e);}}),router[a0_0x266171(0x221)]('/view/add_adjustment',auth,async(_0x521ab6,_0x5dc788)=>{var _0x4d6bf4=a0_0x266171;try{const {warehouse_name:_0x2dbb22,date:_0x203494,prod_name:_0x52ddf1,level:_0x2d3589,isle:_0x3bbb2c,pallet:_0x2e61c5,stock:_0x301430,types:_0x348452,adjust_qty:_0x16c5f1,new_adjust_qty:_0x17d8d9,note:_0x4f0285,Room_name:_0x5d31c6,invoice:_0x307cce,JO_number:_0x581280,expiry_date:_0x272869}=_0x521ab6['body'];if(typeof _0x52ddf1==_0x4d6bf4(0x267))var _0x49c40d=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x25a)]],_0x2cf297=[_0x521ab6['body']['level']],_0x5c3bb9=[_0x521ab6['body'][_0x4d6bf4(0x1c2)]],_0x46681f=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x226)]],_0x4161b9=[_0x521ab6['body']['New_Qty_Converted_adj']],_0x551c15=[_0x521ab6['body'][_0x4d6bf4(0x266)]],_0x2d4dbf=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x1d9)]],_0x4f86dc=[_0x521ab6['body'][_0x4d6bf4(0x1c0)]],_0x3ec197=[_0x521ab6[_0x4d6bf4(0x21a)]['prod_code']],_0x23f4cf=[_0x521ab6['body'][_0x4d6bf4(0x1d8)]],_0x4d12c1=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x227)]],_0x2379cb=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x256)]],_0x3b46ad=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x209)]],_0x2a4343=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x251)]],_0x2b1ba4=[_0x521ab6['body'][_0x4d6bf4(0x265)]],_0x101368=[_0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x273)]],_0x1b448a=[_0x521ab6['body']['second1']],_0x3ff2f6=[_0x521ab6[_0x4d6bf4(0x21a)]['prod_invoice']];else var _0x49c40d=[..._0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x25a)]],_0x2cf297=[..._0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x1ef)]],_0x5c3bb9=[..._0x521ab6['body']['stock']],_0x46681f=[..._0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x226)]],_0x4161b9=[..._0x521ab6[_0x4d6bf4(0x21a)]['New_Qty_Converted_adj']],_0x551c15=[..._0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x266)]],_0x2d4dbf=[..._0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x1da)]],_0x4f86dc=[..._0x521ab6[_0x4d6bf4(0x21a)]['Secondary_units']],_0x3ec197=[..._0x521ab6['body'][_0x4d6bf4(0x26d)]],_0x23f4cf=[..._0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x1d8)]],_0x4d12c1=[..._0x521ab6['body'][_0x4d6bf4(0x227)]],_0x2379cb=[..._0x521ab6['body'][_0x4d6bf4(0x256)]],_0x3b46ad=[..._0x521ab6[_0x4d6bf4(0x21a)]['production_date']],_0x2a4343=[..._0x521ab6['body'][_0x4d6bf4(0x251)]],_0x2b1ba4=[..._0x521ab6['body'][_0x4d6bf4(0x265)]],_0x101368=[..._0x521ab6[_0x4d6bf4(0x21a)][_0x4d6bf4(0x273)]],_0x1b448a=[..._0x521ab6[_0x4d6bf4(0x21a)]['second1']],_0x3ff2f6=[..._0x521ab6['body']['prod_invoice']];const _0x277188=_0x49c40d['map'](_0x22fe92=>{return _0x22fe92={'product_name':_0x22fe92};});_0x2cf297[_0x4d6bf4(0x1e2)]((_0x13095b,_0xceda78)=>{var _0x41bc4d=_0x4d6bf4;_0x2b1ba4[_0x41bc4d(0x1e2)]((_0x3de8af,_0x3088c8)=>{var _0x17c83e=_0x41bc4d;if(_0x3de8af=='Receiving\x20Area'&&_0xceda78==_0x3088c8){var _0x141ab8=_0x13095b[_0x17c83e(0x1cd)](0x3);_0x277188[_0xceda78]['storage']=_0x13095b[0x0],_0x277188[_0xceda78][_0x17c83e(0x1cc)]=_0x13095b[0x1],_0x277188[_0xceda78][_0x17c83e(0x248)]=0x0,_0x277188[_0xceda78]['bin']=0x0,_0x277188[_0xceda78][_0x17c83e(0x212)]=_0x17c83e(0x1c4),_0x277188[_0xceda78][_0x17c83e(0x1d5)]=_0x141ab8;}else{if(_0x3de8af==_0x17c83e(0x20e)&&_0xceda78==_0x3088c8){var _0x141ab8=_0x13095b[_0x17c83e(0x1cd)](0x3);_0x277188[_0xceda78]['storage']=_0x13095b[0x0],_0x277188[_0xceda78]['rack']=_0x13095b[0x1],_0x277188[_0xceda78][_0x17c83e(0x248)]=0x0,_0x277188[_0xceda78][_0x17c83e(0x280)]=0x0,_0x277188[_0xceda78]['type']=_0x17c83e(0x1c4),_0x277188[_0xceda78][_0x17c83e(0x1d5)]=_0x13095b[0x5];}else{if(_0xceda78==_0x3088c8){var _0x586006;if(_0x13095b[0x4]=='L')_0x586006=_0x17c83e(0x23a);else _0x13095b[0x4]=='F'&&(_0x586006=_0x17c83e(0x1c4));_0x277188[_0xceda78][_0x17c83e(0x1f7)]=_0x13095b[0x0],_0x277188[_0xceda78][_0x17c83e(0x1cc)]=_0x13095b[0x1],_0x277188[_0xceda78][_0x17c83e(0x248)]=_0x13095b[0x2],_0x277188[_0xceda78]['bin']=_0x13095b[0x3],_0x277188[_0xceda78][_0x17c83e(0x212)]=_0x586006,_0x277188[_0xceda78][_0x17c83e(0x1d5)]=_0x13095b[0x5];}}}});}),_0x5c3bb9[_0x4d6bf4(0x1e2)]((_0xc3d719,_0x3ee46c)=>{_0x277188[_0x3ee46c]['stockBefore']=_0xc3d719;}),_0x46681f[_0x4d6bf4(0x1e2)]((_0x331885,_0x11d473)=>{var _0x151ded=_0x4d6bf4;_0x277188[_0x11d473][_0x151ded(0x226)]=_0x331885;}),_0x4161b9['forEach']((_0x2cd2a4,_0x6c3861)=>{var _0x23cde9=_0x4d6bf4;_0x277188[_0x6c3861][_0x23cde9(0x220)]=_0x2cd2a4;}),_0x551c15[_0x4d6bf4(0x1e2)]((_0x395a9d,_0x5633b7)=>{var _0x43f0b1=_0x4d6bf4;_0x277188[_0x5633b7][_0x43f0b1(0x1fe)]=_0x395a9d;}),_0x2d4dbf['forEach']((_0x5255db,_0x392429)=>{_0x277188[_0x392429]['unit']=_0x5255db;}),_0x4f86dc[_0x4d6bf4(0x1e2)]((_0x3a1a18,_0x58655a)=>{var _0x31ba25=_0x4d6bf4;_0x277188[_0x58655a][_0x31ba25(0x259)]=_0x3a1a18;}),_0x3ec197[_0x4d6bf4(0x1e2)]((_0x1c1296,_0x15152c)=>{_0x277188[_0x15152c]['product_code']=_0x1c1296;}),_0x23f4cf['forEach']((_0x56b8d8,_0x21a51a)=>{_0x277188[_0x21a51a]['batch_code']=_0x56b8d8;}),_0x4d12c1[_0x4d6bf4(0x1e2)]((_0x4bbf78,_0x4b6491)=>{var _0x8ff690=_0x4d6bf4;_0x277188[_0x4b6491][_0x8ff690(0x227)]=_0x4bbf78;}),_0x2379cb['forEach']((_0xf60870,_0x4e2cc5)=>{_0x277188[_0x4e2cc5]['maxperunit']=_0xf60870;}),_0x3b46ad['forEach']((_0x5c50f6,_0x2574ca)=>{var _0x8abcfd=_0x4d6bf4;_0x277188[_0x2574ca][_0x8abcfd(0x209)]=_0x5c50f6;}),_0x2a4343[_0x4d6bf4(0x1e2)]((_0x2f7efb,_0x475a4e)=>{var _0x3e8b35=_0x4d6bf4;_0x277188[_0x475a4e][_0x3e8b35(0x251)]=_0x2f7efb;}),_0x2b1ba4['forEach']((_0x2d668d,_0x27cc55)=>{_0x277188[_0x27cc55]['room_names']=_0x2d668d;}),_0x101368[_0x4d6bf4(0x1e2)]((_0x5075aa,_0x3099bc)=>{var _0x20f655=_0x4d6bf4;_0x277188[_0x3099bc][_0x20f655(0x234)]=_0x5075aa;}),_0x1b448a[_0x4d6bf4(0x1e2)]((_0x374102,_0x1edb4a)=>{var _0x13b5b4=_0x4d6bf4;_0x277188[_0x1edb4a][_0x13b5b4(0x1b6)]=_0x374102;}),_0x3ff2f6[_0x4d6bf4(0x1e2)]((_0x38f000,_0x16fd1d)=>{_0x277188[_0x16fd1d]['invoice']=_0x38f000;});const _0x287588=_0x277188['filter'](_0x3c1c7a=>_0x3c1c7a['adjust_qty']!=='0'&&_0x3c1c7a[_0x4d6bf4(0x220)]!=='');var _0x2298c5=0x0;_0x287588[_0x4d6bf4(0x1e2)](_0x19bfff=>{var _0x41ea21=_0x4d6bf4;console['log'](_0x41ea21(0x279),_0x19bfff),parseInt(_0x19bfff['adjust_qty'])<=0x0&&_0x2298c5++;});if(_0x2298c5!=0x0)return _0x521ab6[_0x4d6bf4(0x1f6)](_0x4d6bf4(0x1d3),_0x4d6bf4(0x1ed)),_0x5dc788['redirect']('back');const _0x18ae4c=new adjustment({'warehouse_name':_0x2dbb22,'date':_0x203494,'product':_0x287588,'note':_0x4f0285,'room':_0x5d31c6,'invoice':_0x307cce,'JO_number':_0x581280,'expiry_date':_0x272869}),_0x2fb2ec=await _0x18ae4c['save']();_0x521ab6[_0x4d6bf4(0x1f6)](_0x4d6bf4(0x1bd),_0x4d6bf4(0x254)),_0x5dc788[_0x4d6bf4(0x1d4)](_0x4d6bf4(0x246)+_0x2fb2ec['_id']);}catch(_0x542b88){console[_0x4d6bf4(0x1b8)](_0x542b88),_0x5dc788['status'](0xc8)[_0x4d6bf4(0x25d)]({'message':_0x542b88[_0x4d6bf4(0x1b2)]});}}),router[a0_0x266171(0x1f5)](a0_0x266171(0x1e4),auth,async(_0x49bacb,_0x485d1b)=>{var _0x4e521d=a0_0x266171;try{const {username:_0x4c2bad,email:_0x534165,role:_0x43d3a9}=_0x49bacb[_0x4e521d(0x230)],_0x4c2880=_0x49bacb[_0x4e521d(0x230)],_0x1a0418=await profile['findOne']({'email':_0x4c2880[_0x4e521d(0x1de)]}),_0x18d78e=await master_shop[_0x4e521d(0x1bb)](),_0x4ef4da=_0x49bacb['params']['id'],_0x4dd6a6=await adjustment[_0x4e521d(0x205)]({'_id':_0x4ef4da}),_0x842fe=await purchases[_0x4e521d(0x24f)]([{'$match':{'warehouse_name':_0x4dd6a6['warehouse_name']}},{'$unwind':_0x4e521d(0x250)},{'$group':{'_id':'$product.product_name'}}]),_0x5048fe=await product[_0x4e521d(0x1bb)]({}),_0x51588f=await warehouse[_0x4e521d(0x24f)]([{'$match':{'name':_0x4dd6a6[_0x4e521d(0x1fb)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4e521d(0x27b),'name':{'$first':_0x4e521d(0x22b)},'product_stock':{'$first':_0x4e521d(0x1b9)},'bay':{'$first':_0x4e521d(0x264)},'bin':{'$first':_0x4e521d(0x26a)},'type':{'$first':_0x4e521d(0x20b)},'floorlevel':{'$first':_0x4e521d(0x1ca)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4e521d(0x219)},'product_code':{'$first':_0x4e521d(0x206)},'storage':{'$first':_0x4e521d(0x26c)},'rack':{'$first':_0x4e521d(0x1dc)},'maxPerUnit':{'$first':_0x4e521d(0x1fd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x4e521d(0x208)},'batch_code':{'$first':_0x4e521d(0x277)},'room':{'$first':_0x4e521d(0x1d2)}}}]);if(_0x18d78e[0x0]['language']=='English\x20(US)'){var _0x42e143=users[_0x4e521d(0x211)];console[_0x4e521d(0x1b8)](_0x42e143);}else{if(_0x18d78e[0x0][_0x4e521d(0x24b)]==_0x4e521d(0x1ec))var _0x42e143=users[_0x4e521d(0x1ec)];else{if(_0x18d78e[0x0]['language']=='German')var _0x42e143=users['German'];else{if(_0x18d78e[0x0][_0x4e521d(0x24b)]=='Spanish')var _0x42e143=users[_0x4e521d(0x1c7)];else{if(_0x18d78e[0x0]['language']==_0x4e521d(0x1fa))var _0x42e143=users['French'];else{if(_0x18d78e[0x0]['language']==_0x4e521d(0x214))var _0x42e143=users[_0x4e521d(0x23e)];else{if(_0x18d78e[0x0]['language']==_0x4e521d(0x222))var _0x42e143=users[_0x4e521d(0x222)];else{if(_0x18d78e[0x0][_0x4e521d(0x24b)]==_0x4e521d(0x216))var _0x42e143=users[_0x4e521d(0x1f4)];}}}}}}}_0x485d1b['render'](_0x4e521d(0x1b7),{'success':_0x49bacb[_0x4e521d(0x1f6)](_0x4e521d(0x1bd)),'errors':_0x49bacb[_0x4e521d(0x1f6)](_0x4e521d(0x1d3)),'role':_0x4c2880,'profile':_0x1a0418,'adjustment':_0x4dd6a6,'stock':_0x51588f,'master_shop':_0x18d78e,'warehouse_name':_0x842fe,'unit':_0x5048fe,'language':_0x42e143});}catch(_0x37578f){console[_0x4e521d(0x1b8)](_0x37578f),_0x485d1b['status'](0xc8)['json']({'message':_0x37578f[_0x4e521d(0x1b2)]});}}),router['post'](a0_0x266171(0x1e4),auth,async(_0x1c3a6b,_0x31b9b4)=>{var _0x441e30=a0_0x266171;try{const _0x256744=_0x1c3a6b[_0x441e30(0x1c6)]['id'],{warehouse_name:_0x37002d,Room_name:_0x3849ef}=_0x1c3a6b[_0x441e30(0x21a)],_0x1bc62c=await adjustment[_0x441e30(0x205)]({'_id':_0x256744}),_0x56e3df=_0x1bc62c[_0x441e30(0x24a)][_0x441e30(0x24c)](async _0x119a8d=>{var _0x385c90=_0x441e30;if(_0x119a8d[_0x385c90(0x220)]>0x0){var _0x15b154=await warehouse[_0x385c90(0x236)]({'name':_0x37002d,'room':_0x119a8d[_0x385c90(0x233)],'warehouse_category':_0x385c90(0x261)});const _0x4aa832=_0x15b154['product_details']['map'](_0x39c57b=>{var _0x5c5dc1=_0x385c90;if(_0x119a8d[_0x5c5dc1(0x212)]=='minus'){if(_0x39c57b[_0x5c5dc1(0x22c)]==_0x119a8d[_0x5c5dc1(0x22c)]&&_0x39c57b[_0x5c5dc1(0x1d5)]==_0x119a8d[_0x5c5dc1(0x1d5)]&&_0x39c57b[_0x5c5dc1(0x212)]==_0x119a8d[_0x5c5dc1(0x212)]&&_0x39c57b['bin']==_0x119a8d['bin']&&_0x39c57b[_0x5c5dc1(0x248)]==_0x119a8d[_0x5c5dc1(0x248)]&&_0x39c57b['rack']==_0x119a8d[_0x5c5dc1(0x1cc)]&&_0x39c57b[_0x5c5dc1(0x1f7)]==_0x119a8d[_0x5c5dc1(0x1f7)]&&_0x39c57b['expiry_date']==_0x119a8d[_0x5c5dc1(0x227)]&&_0x39c57b[_0x5c5dc1(0x1d8)]==_0x119a8d['batch_code']&&_0x39c57b[_0x5c5dc1(0x209)]==_0x119a8d[_0x5c5dc1(0x209)]&&_0x39c57b[_0x5c5dc1(0x1cf)]==_0x119a8d[_0x5c5dc1(0x1cf)]){var _0x1d19b2;_0x1d19b2=_0x119a8d[_0x5c5dc1(0x220)],_0x119a8d[_0x5c5dc1(0x251)]=='S'&&(_0x1d19b2=_0x119a8d[_0x5c5dc1(0x220)]),_0x39c57b[_0x5c5dc1(0x276)]=_0x39c57b[_0x5c5dc1(0x276)]-_0x1d19b2;}}else{if(_0x39c57b['product_name']==_0x119a8d[_0x5c5dc1(0x22c)]&&_0x39c57b[_0x5c5dc1(0x1d5)]==_0x119a8d[_0x5c5dc1(0x1d5)]&&_0x39c57b[_0x5c5dc1(0x212)]==_0x119a8d[_0x5c5dc1(0x212)]&&_0x39c57b[_0x5c5dc1(0x280)]==_0x119a8d[_0x5c5dc1(0x280)]&&_0x39c57b[_0x5c5dc1(0x248)]==_0x119a8d[_0x5c5dc1(0x248)]&&_0x39c57b[_0x5c5dc1(0x1cc)]==_0x119a8d[_0x5c5dc1(0x1cc)]&&_0x39c57b['storage']==_0x119a8d[_0x5c5dc1(0x1f7)]&&_0x39c57b[_0x5c5dc1(0x227)]==_0x119a8d['expiry_date']&&_0x39c57b[_0x5c5dc1(0x1d8)]==_0x119a8d['batch_code']&&_0x39c57b[_0x5c5dc1(0x209)]==_0x119a8d['production_date']&&_0x39c57b[_0x5c5dc1(0x1cf)]==_0x119a8d['invoice']){console[_0x5c5dc1(0x1b8)](_0x119a8d);var _0x1d19b2;_0x1d19b2=_0x119a8d[_0x5c5dc1(0x220)],_0x119a8d['prod_cat']=='S'&&(_0x1d19b2=_0x119a8d[_0x5c5dc1(0x220)]),console[_0x5c5dc1(0x1b8)](_0x1d19b2+_0x5c5dc1(0x237)+_0x119a8d[_0x5c5dc1(0x220)]+_0x5c5dc1(0x237)+_0x39c57b[_0x5c5dc1(0x243)]+_0x5c5dc1(0x237)+_0x119a8d[_0x5c5dc1(0x251)]),_0x39c57b[_0x5c5dc1(0x276)]=_0x39c57b['product_stock']+_0x1d19b2;}}});}return _0x15b154;});Promise[_0x441e30(0x1eb)](_0x56e3df)['then'](async _0x1b632c=>{var _0x1b35be=_0x441e30;try{for(const _0x4294dc of _0x1b632c){await _0x4294dc['save']();}_0x1bc62c[_0x1b35be(0x1bc)]='True';const _0x2380ed=await _0x1bc62c[_0x1b35be(0x1e5)](),_0x379692=await master_shop[_0x1b35be(0x1bb)](),_0x9f5527=await email_settings[_0x1b35be(0x236)](),_0x4a9ccc=await supervisor_settings['find']();var _0xb54958=_0x1bc62c[_0x1b35be(0x24a)],_0xe1b514='',_0x3ea06c;for(_0x3ea06c in _0xb54958){_0xe1b514+=_0x1b35be(0x204)+_0x1b35be(0x269)+_0xb54958[_0x3ea06c][_0x1b35be(0x22c)]+_0x1b35be(0x225)+_0x1b35be(0x269)+_0xb54958[_0x3ea06c][_0x1b35be(0x1f0)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xb54958[_0x3ea06c][_0x1b35be(0x220)]+_0x1b35be(0x225)+_0x1b35be(0x269)+_0xb54958[_0x3ea06c][_0x1b35be(0x1da)]+'</td>'+_0x1b35be(0x269)+_0xb54958[_0x3ea06c][_0x1b35be(0x259)]+_0x1b35be(0x225)+_0x1b35be(0x269)+_0x1bc62c[_0x1b35be(0x1fb)]+_0x1b35be(0x225)+_0x1b35be(0x269)+_0xb54958[_0x3ea06c]['room_names']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xb54958[_0x3ea06c][_0x1b35be(0x1f7)]+_0xb54958[_0x3ea06c][_0x1b35be(0x1cc)]+_0xb54958[_0x3ea06c][_0x1b35be(0x248)]+_0xb54958[_0x3ea06c][_0x1b35be(0x280)]+_0xb54958[_0x3ea06c]['type'][0x0]+_0xb54958[_0x3ea06c]['floorlevel']+_0x1b35be(0x225),'</tr>';}let _0x327e5c=nodemailer[_0x1b35be(0x1b4)]({'host':_0x9f5527[_0x1b35be(0x215)],'port':Number(_0x9f5527[_0x1b35be(0x241)]),'secure':![],'auth':{'user':_0x9f5527['email'],'pass':_0x9f5527[_0x1b35be(0x1c1)]}}),_0x468c8c={'from':_0x9f5527[_0x1b35be(0x1de)],'to':_0x4a9ccc[0x0][_0x1b35be(0x22a)],'subject':_0x1b35be(0x272),'attachments':[{'filename':'Logo.png','path':__dirname+_0x1b35be(0x21d)+'/upload/'+_0x379692[0x0][_0x1b35be(0x27a)],'cid':'logo'}],'html':_0x1b35be(0x26e)+_0x1b35be(0x25b)+'</head><body>'+_0x1b35be(0x210)+_0x1b35be(0x213)+_0x1b35be(0x210)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1b35be(0x20f)+_0x1b35be(0x210)+_0x1b35be(0x1cb)+_0x379692[0x0][_0x1b35be(0x1e7)]+_0x1b35be(0x27d)+_0x1b35be(0x20f)+_0x1b35be(0x20f)+_0x1b35be(0x1ba)+_0x1b35be(0x210)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x1b35be(0x201)+_0x1bc62c[_0x1b35be(0x1cf)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x1b35be(0x202)+_0x1bc62c[_0x1b35be(0x1d6)]+'\x20'+_0x1b35be(0x21e)+_0x1b35be(0x262)+_0x1b35be(0x20f)+_0x1b35be(0x218)+_0x1b35be(0x1e9)+_0x1b35be(0x204)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x1b35be(0x1f1)+_0x1b35be(0x25f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x1b35be(0x20c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x1b35be(0x1b1)+_0x1b35be(0x21b)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0xe1b514+'\x20'+_0x1b35be(0x257)+_0x1b35be(0x23d)+_0x1b35be(0x210)+_0x1b35be(0x232)+_0x1b35be(0x1e0)+_0x379692[0x0][_0x1b35be(0x1e7)]+_0x1b35be(0x262)+_0x1b35be(0x20f)+_0x1b35be(0x20f)+_0x1b35be(0x27c)};_0x327e5c[_0x1b35be(0x1b3)](_0x468c8c,function(_0x55ca60,_0x122882){var _0x17d09a=_0x1b35be;_0x55ca60?(console['log'](_0x55ca60),console['log'](_0x17d09a(0x228))):console[_0x17d09a(0x1b8)](_0x17d09a(0x1ee));}),_0x1c3a6b['flash'](_0x1b35be(0x1bd),_0x1b35be(0x26f)),_0x31b9b4[_0x1b35be(0x1d4)]('/picking_list/PDF_adjustment_rm/'+_0x2380ed[_0x1b35be(0x1f3)]);}catch(_0xd829ee){console[_0x1b35be(0x260)](_0xd829ee),_0x31b9b4[_0x1b35be(0x1be)](0x1f4)[_0x1b35be(0x25d)]({'error':_0x1b35be(0x20a)});}})[_0x441e30(0x278)](_0x334bf2=>{var _0xe6ab7e=_0x441e30;console[_0xe6ab7e(0x260)](_0x334bf2),_0x31b9b4[_0xe6ab7e(0x1be)](0x1f4)['json']({'error':_0xe6ab7e(0x25e)});});}catch(_0x593ded){console['log'](_0x593ded),_0x31b9b4[_0x441e30(0x1be)](0xc8)[_0x441e30(0x25d)]({'message':_0x593ded['message']});}}),router[a0_0x266171(0x1f5)](a0_0x266171(0x263),auth,async(_0x2e1682,_0x5831de)=>{var _0xe46e93=a0_0x266171;try{const {username:_0x1c4bf0,email:_0x940ba7,role:_0x596d8e}=_0x2e1682[_0xe46e93(0x230)],_0x52928b=_0x2e1682['user'],_0x41f957=await profile[_0xe46e93(0x236)]({'email':_0x52928b['email']}),_0x51b0b2=await master_shop['find'](),_0x5b2f41=_0x2e1682[_0xe46e93(0x1c6)]['id'],_0x11e4ce=await adjustment[_0xe46e93(0x205)]({'_id':_0x5b2f41}),_0x56b182=await purchases[_0xe46e93(0x24f)]([{'$match':{'warehouse_name':_0x11e4ce[_0xe46e93(0x1fb)]}},{'$unwind':_0xe46e93(0x250)},{'$group':{'_id':_0xe46e93(0x275)}}]),_0x2a1518=await product[_0xe46e93(0x1bb)]({}),_0x366463=await warehouse[_0xe46e93(0x24f)]([{'$match':{'name':_0x11e4ce['warehouse_name']}},{'$unwind':_0xe46e93(0x207)},{'$group':{'_id':_0xe46e93(0x27b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xe46e93(0x264)},'bin':{'$first':_0xe46e93(0x26a)},'type':{'$first':_0xe46e93(0x20b)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xe46e93(0x219)},'product_code':{'$first':_0xe46e93(0x206)},'storage':{'$first':_0xe46e93(0x26c)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0xe46e93(0x1fd)},'expiry_date':{'$first':_0xe46e93(0x1d7)},'production_date':{'$first':_0xe46e93(0x208)},'batch_code':{'$first':_0xe46e93(0x277)},'room':{'$first':'$room'}}}]);let _0x581151;if(_0x52928b[_0xe46e93(0x1df)]==_0xe46e93(0x22f)){const _0x30ac9b=await staff[_0xe46e93(0x236)]({'email':_0x52928b[_0xe46e93(0x1de)]});_0x581151=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x30ac9b['warehouse'],'warehouse_category':_0xe46e93(0x261),'name':{'$ne':_0xe46e93(0x200)}}},{'$group':{'_id':_0xe46e93(0x1d0),'name':{'$first':_0xe46e93(0x1d0)}}}]);}else _0x581151=await warehouse[_0xe46e93(0x24f)]([{'$match':{'status':'Enabled','warehouse_category':_0xe46e93(0x261),'name':{'$ne':_0xe46e93(0x200)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);if(_0x51b0b2[0x0]['language']==_0xe46e93(0x270)){var _0x373bf8=users['English'];console[_0xe46e93(0x1b8)](_0x373bf8);}else{if(_0x51b0b2[0x0][_0xe46e93(0x24b)]=='Hindi')var _0x373bf8=users['Hindi'];else{if(_0x51b0b2[0x0][_0xe46e93(0x24b)]=='German')var _0x373bf8=users['German'];else{if(_0x51b0b2[0x0][_0xe46e93(0x24b)]==_0xe46e93(0x1c7))var _0x373bf8=users[_0xe46e93(0x1c7)];else{if(_0x51b0b2[0x0]['language']==_0xe46e93(0x1fa))var _0x373bf8=users[_0xe46e93(0x1fa)];else{if(_0x51b0b2[0x0][_0xe46e93(0x24b)]==_0xe46e93(0x214))var _0x373bf8=users['Portuguese'];else{if(_0x51b0b2[0x0][_0xe46e93(0x24b)]==_0xe46e93(0x222))var _0x373bf8=users[_0xe46e93(0x222)];else{if(_0x51b0b2[0x0][_0xe46e93(0x24b)]==_0xe46e93(0x216))var _0x373bf8=users[_0xe46e93(0x1f4)];}}}}}}}_0x5831de[_0xe46e93(0x238)]('edit_adjustment',{'success':_0x2e1682['flash']('success'),'errors':_0x2e1682[_0xe46e93(0x1f6)](_0xe46e93(0x1d3)),'role':_0x52928b,'profile':_0x41f957,'adjustment':_0x11e4ce,'stock':_0x366463,'master_shop':_0x51b0b2,'warehouse_name':_0x56b182,'unit':_0x2a1518,'language':_0x373bf8,'warehouse':_0x581151});}catch(_0x3e68b7){console['log'](_0x3e68b7),_0x5831de[_0xe46e93(0x1be)](0xc8)[_0xe46e93(0x25d)]({'message':_0x3e68b7[_0xe46e93(0x1b2)]});}}),router[a0_0x266171(0x221)](a0_0x266171(0x263),auth,async(_0x39f10e,_0x509148)=>{var _0x7044df=a0_0x266171;try{const _0x56a045=_0x39f10e['params']['id'],_0x108f89=await adjustment[_0x7044df(0x205)]({'_id':_0x56a045}),_0x7b3f64=await warehouse[_0x7044df(0x236)]({'name':_0x108f89['warehouse_name'],'room':_0x108f89[_0x7044df(0x1ea)]}),{warehouse_name:_0x544259,date:_0x1de002,prod_name:_0x2f958d,level:_0x47822b,isle:_0x64c56b,pallet:_0x166aeb,stock:_0x1bd42e,types:_0x50f481,adjust_qty:_0x4f106c,new_adjust_qty:_0x12af1a,note:_0x465164,Room_name:_0x167f1b,invoice:_0x5f3601,JO_number:_0x33e19,expiry_date:_0x4a3188}=_0x39f10e[_0x7044df(0x21a)];if(typeof _0x2f958d==_0x7044df(0x267))var _0x522c02=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x25a)]],_0xeb1125=[_0x39f10e['body'][_0x7044df(0x1ef)]],_0x19f286=[_0x39f10e['body'][_0x7044df(0x1c2)]],_0x3f341e=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x226)]],_0x2be6be=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x1f9)]],_0x49f0f3=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x266)]],_0x38bf75=[_0x39f10e['body'][_0x7044df(0x1d9)]],_0x5be559=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x1c0)]],_0x117a62=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x26d)]],_0x1ca5d1=[_0x39f10e[_0x7044df(0x21a)]['batch_code']],_0x2c3726=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x227)]],_0x74ed8f=[_0x39f10e['body'][_0x7044df(0x256)]],_0xb9597b=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x209)]],_0x34f817=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x251)]],_0x4e5d81=[_0x39f10e['body'][_0x7044df(0x265)]],_0x3d54b5=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x273)]],_0x1d3d6c=[_0x39f10e[_0x7044df(0x21a)][_0x7044df(0x245)]];else var _0x522c02=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x25a)]],_0xeb1125=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x1ef)]],_0x19f286=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x1c2)]],_0x3f341e=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x226)]],_0x2be6be=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x1f9)]],_0x49f0f3=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x266)]],_0x38bf75=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x1da)]],_0x5be559=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x1c0)]],_0x117a62=[..._0x39f10e['body'][_0x7044df(0x26d)]],_0x1ca5d1=[..._0x39f10e['body']['batch_code']],_0x2c3726=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x227)]],_0x74ed8f=[..._0x39f10e['body'][_0x7044df(0x256)]],_0xb9597b=[..._0x39f10e['body'][_0x7044df(0x209)]],_0x34f817=[..._0x39f10e[_0x7044df(0x21a)][_0x7044df(0x251)]],_0x4e5d81=[..._0x39f10e[_0x7044df(0x21a)]['Rooms']],_0x3d54b5=[..._0x39f10e['body'][_0x7044df(0x273)]],_0x1d3d6c=[..._0x39f10e[_0x7044df(0x21a)]['second1']];const _0x1ca753=_0x522c02[_0x7044df(0x24c)](_0x5e48b8=>{return _0x5e48b8={'product_name':_0x5e48b8};});_0xeb1125['forEach']((_0x555524,_0xb9dcef)=>{var _0x23599e=_0x7044df;_0x4e5d81[_0x23599e(0x1e2)]((_0xe11809,_0x5a6cfb)=>{var _0x40e55b=_0x23599e;if(_0xe11809=='Receiving\x20Area'&&_0xb9dcef==_0x5a6cfb){var _0xd388e4=_0x555524[_0x40e55b(0x1cd)](0x3);_0x1ca753[_0xb9dcef]['storage']=_0x555524[0x0],_0x1ca753[_0xb9dcef][_0x40e55b(0x1cc)]=_0x555524[0x1],_0x1ca753[_0xb9dcef]['bay']=0x0,_0x1ca753[_0xb9dcef][_0x40e55b(0x280)]=0x0,_0x1ca753[_0xb9dcef][_0x40e55b(0x212)]=_0x40e55b(0x1c4),_0x1ca753[_0xb9dcef]['floorlevel']=_0xd388e4;}else{if(_0xe11809==_0x40e55b(0x20e)&&_0xb9dcef==_0x5a6cfb){var _0xd388e4=_0x555524['slice'](0x3);_0x1ca753[_0xb9dcef][_0x40e55b(0x1f7)]=_0x555524[0x0],_0x1ca753[_0xb9dcef][_0x40e55b(0x1cc)]=_0x555524[0x1],_0x1ca753[_0xb9dcef][_0x40e55b(0x248)]=0x0,_0x1ca753[_0xb9dcef]['bin']=0x0,_0x1ca753[_0xb9dcef][_0x40e55b(0x212)]=_0x40e55b(0x1c4),_0x1ca753[_0xb9dcef]['floorlevel']=_0x555524[0x5];}else{if(_0xb9dcef==_0x5a6cfb){var _0x242086;if(_0x555524[0x4]=='L')_0x242086='Level';else _0x555524[0x4]=='F'&&(_0x242086=_0x40e55b(0x1c4));_0x1ca753[_0xb9dcef][_0x40e55b(0x1f7)]=_0x555524[0x0],_0x1ca753[_0xb9dcef][_0x40e55b(0x1cc)]=_0x555524[0x1],_0x1ca753[_0xb9dcef]['bay']=_0x555524[0x2],_0x1ca753[_0xb9dcef][_0x40e55b(0x280)]=_0x555524[0x3],_0x1ca753[_0xb9dcef][_0x40e55b(0x212)]=_0x242086,_0x1ca753[_0xb9dcef][_0x40e55b(0x1d5)]=_0x555524[0x5];}}}});}),_0x19f286[_0x7044df(0x1e2)]((_0x52c0b6,_0xc7b214)=>{var _0x3cd1df=_0x7044df;_0x1ca753[_0xc7b214][_0x3cd1df(0x21f)]=_0x52c0b6;}),_0x3f341e[_0x7044df(0x1e2)]((_0x3e8bb0,_0x4e8369)=>{_0x1ca753[_0x4e8369]['types']=_0x3e8bb0;}),_0x2be6be[_0x7044df(0x1e2)]((_0x56fa95,_0x509b95)=>{var _0x15484b=_0x7044df;_0x1ca753[_0x509b95][_0x15484b(0x220)]=_0x56fa95;}),_0x49f0f3[_0x7044df(0x1e2)]((_0x3ca2a9,_0x423d13)=>{var _0x581e85=_0x7044df;_0x1ca753[_0x423d13][_0x581e85(0x1fe)]=_0x3ca2a9;}),_0x38bf75[_0x7044df(0x1e2)]((_0x364212,_0x61a0a1)=>{var _0x337a7f=_0x7044df;_0x1ca753[_0x61a0a1][_0x337a7f(0x1da)]=_0x364212;}),_0x5be559[_0x7044df(0x1e2)]((_0x39729a,_0x565568)=>{var _0x2ef086=_0x7044df;_0x1ca753[_0x565568][_0x2ef086(0x259)]=_0x39729a;}),_0x117a62[_0x7044df(0x1e2)]((_0x625bf3,_0x3d9c93)=>{var _0x1106c8=_0x7044df;_0x1ca753[_0x3d9c93][_0x1106c8(0x1f0)]=_0x625bf3;}),_0x1ca5d1['forEach']((_0x497a6e,_0x318356)=>{var _0x2697fc=_0x7044df;_0x1ca753[_0x318356][_0x2697fc(0x1d8)]=_0x497a6e;}),_0x2c3726['forEach']((_0x23fe04,_0x59d2bd)=>{var _0x2f5098=_0x7044df;_0x1ca753[_0x59d2bd][_0x2f5098(0x227)]=_0x23fe04;}),_0x74ed8f[_0x7044df(0x1e2)]((_0x1363f7,_0x7996a0)=>{_0x1ca753[_0x7996a0]['maxperunit']=_0x1363f7;}),_0xb9597b[_0x7044df(0x1e2)]((_0x25cef7,_0x2b7a65)=>{_0x1ca753[_0x2b7a65]['production_date']=_0x25cef7;}),_0x34f817[_0x7044df(0x1e2)]((_0x9fb128,_0x3952ad)=>{var _0x335c62=_0x7044df;_0x1ca753[_0x3952ad][_0x335c62(0x251)]=_0x9fb128;}),_0x4e5d81[_0x7044df(0x1e2)]((_0xabbbea,_0x46a33a)=>{_0x1ca753[_0x46a33a]['room_names']=_0xabbbea;}),_0x3d54b5['forEach']((_0x369f5c,_0x25a6ab)=>{var _0x1f2b75=_0x7044df;_0x1ca753[_0x25a6ab][_0x1f2b75(0x234)]=_0x369f5c;}),_0x1d3d6c[_0x7044df(0x1e2)]((_0x702bb3,_0xdac31)=>{var _0x3b7a3c=_0x7044df;_0x1ca753[_0xdac31][_0x3b7a3c(0x1b6)]=_0x702bb3;});const _0x1740cf=_0x1ca753[_0x7044df(0x24d)](_0x3368ab=>_0x3368ab['adjust_qty']!=='0'&&_0x3368ab[_0x7044df(0x220)]!=='');var _0x481c2a=0x0;_0x1740cf[_0x7044df(0x1e2)](_0x3cc843=>{var _0x54e3b7=_0x7044df;console[_0x54e3b7(0x1b8)](_0x54e3b7(0x279),_0x3cc843),parseInt(_0x3cc843['adjust_qty'])<=0x0&&_0x481c2a++;});if(_0x481c2a!=0x0)return _0x39f10e[_0x7044df(0x1f6)](_0x7044df(0x1d3),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x509148['redirect']('back');_0x108f89[_0x7044df(0x1fb)]=_0x544259,_0x108f89[_0x7044df(0x1d6)]=_0x1de002,_0x108f89[_0x7044df(0x24a)]=_0x1740cf,_0x108f89[_0x7044df(0x239)]=_0x465164,_0x108f89[_0x7044df(0x1cf)]=_0x5f3601,_0x108f89[_0x7044df(0x1c5)]=_0x7044df(0x27f);const _0x4faeb6=await _0x108f89[_0x7044df(0x1e5)]();_0x39f10e['flash'](_0x7044df(0x1bd),_0x7044df(0x1ce)),_0x509148[_0x7044df(0x1d4)](_0x7044df(0x1db));}catch(_0xdb4220){console[_0x7044df(0x1b8)](_0xdb4220);}}),router[a0_0x266171(0x221)]('/barcode_scanner',async(_0x2e5cf6,_0x45844d)=>{var _0x86d9c0=a0_0x266171;const {primary_code:_0x4c32f4,warehouse_data:_0x1fa181,rooms_data:_0xdaa62d,Roomslist:_0x4fa05a}=_0x2e5cf6[_0x86d9c0(0x21a)],_0x4fd274=_0x4fa05a[_0x86d9c0(0x1e1)](','),_0x9388cb=[];async function _0x23086c(_0x54cead){var _0x551dae=_0x86d9c0;const _0x1ad764=await warehouse['aggregate']([{'$match':{'name':_0x1fa181,'room':_0x54cead}},{'$unwind':_0x551dae(0x207)},{'$match':{'product_details.primary_code':_0x4c32f4}},{'$group':{'_id':_0x551dae(0x27b),'name':{'$first':_0x551dae(0x22b)},'product_stock':{'$first':_0x551dae(0x1b9)},'primary_code':{'$first':_0x551dae(0x268)},'secondary_code':{'$first':_0x551dae(0x219)},'product_code':{'$first':_0x551dae(0x206)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x551dae(0x26a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x551dae(0x1ca)},'unit':{'$first':_0x551dae(0x23b)},'secondary_unit':{'$first':_0x551dae(0x27e)},'storage':{'$first':_0x551dae(0x26c)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x551dae(0x1d7)},'production_date':{'$first':_0x551dae(0x208)},'maxPerUnit':{'$first':_0x551dae(0x1fd)},'batch_code':{'$first':_0x551dae(0x277)},'product_cat':{'$first':_0x551dae(0x1dd)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x551dae(0x1d2)}}}]),_0x158303=await warehouse[_0x551dae(0x24f)]([{'$match':{'name':_0x1fa181,'room':_0x54cead}},{'$unwind':_0x551dae(0x207)},{'$match':{'product_details.secondary_code':_0x4c32f4}},{'$group':{'_id':_0x551dae(0x27b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x551dae(0x219)},'product_code':{'$first':_0x551dae(0x206)},'level':{'$first':_0x551dae(0x264)},'isle':{'$first':_0x551dae(0x26a)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x551dae(0x23b)},'secondary_unit':{'$first':_0x551dae(0x27e)},'storage':{'$first':_0x551dae(0x26c)},'rack':{'$first':_0x551dae(0x1dc)},'expiry_date':{'$first':_0x551dae(0x1d7)},'production_date':{'$first':_0x551dae(0x208)},'maxPerUnit':{'$first':_0x551dae(0x1fd)},'batch_code':{'$first':_0x551dae(0x277)},'product_cat':{'$first':_0x551dae(0x1dd)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x551dae(0x1d2)}}}]);if(_0x1ad764['length']>0x0)_0x9388cb[_0x551dae(0x20d)](_0x1ad764);else _0x158303['length']>0x0&&_0x9388cb[_0x551dae(0x20d)](_0x158303);}const _0x100682=_0x4fd274[_0x86d9c0(0x24c)](_0x1cf88a=>_0x23086c(_0x1cf88a));await Promise['all'](_0x100682),_0x45844d[_0x86d9c0(0x25d)](_0x9388cb);}),router[a0_0x266171(0x221)](a0_0x266171(0x283),async(_0x3ba9c3,_0x4615a8)=>{var _0x5bf659=a0_0x266171;const {primaryCode:_0x4b8652,secondaryCode:_0x10df9d,productCode:_0x34cc51,level:_0x2b5959,isle:_0x326a1c,pallet:_0x260e93,warehouses:_0x4df521,room:_0x3e5c14}=_0x3ba9c3[_0x5bf659(0x21a)];try{const _0x36d1d6=await warehouse[_0x5bf659(0x24f)]([{'$match':{'name':_0x4df521,'room':_0x3e5c14}},{'$unwind':_0x5bf659(0x207)},{'$match':{'product_details.level':parseInt(_0x2b5959),'product_details.isle':_0x326a1c,'product_details.pallet':parseInt(_0x260e93)}},{'$group':{'_id':_0x5bf659(0x27b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5bf659(0x1b9)},'level':{'$first':_0x5bf659(0x1e6)},'isle':{'$first':_0x5bf659(0x258)},'pallet':{'$first':_0x5bf659(0x203)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x4615a8[_0x5bf659(0x1be)](0xc8)['json'](_0x36d1d6);}catch(_0x405e68){_0x4615a8[_0x5bf659(0x1be)](0x194)[_0x5bf659(0x25d)]({'message':_0x405e68[_0x5bf659(0x1b2)]});}}),module[a0_0x266171(0x274)]=router;