function a0_0x2143(_0x186540,_0x422c49){var _0xdbb546=a0_0xdbb5();return a0_0x2143=function(_0x21435d,_0x580308){_0x21435d=_0x21435d-0x17f;var _0x5c5fb0=_0xdbb546[_0x21435d];return _0x5c5fb0;},a0_0x2143(_0x186540,_0x422c49);}var a0_0x8409bd=a0_0x2143;(function(_0x1385fa,_0x24b979){var _0xd1bc5e=a0_0x2143,_0x35c729=_0x1385fa();while(!![]){try{var _0x43fc65=-parseInt(_0xd1bc5e(0x1f0))/0x1+-parseInt(_0xd1bc5e(0x24c))/0x2*(-parseInt(_0xd1bc5e(0x215))/0x3)+parseInt(_0xd1bc5e(0x1ee))/0x4+-parseInt(_0xd1bc5e(0x1f7))/0x5*(-parseInt(_0xd1bc5e(0x1d0))/0x6)+-parseInt(_0xd1bc5e(0x1de))/0x7*(-parseInt(_0xd1bc5e(0x21a))/0x8)+-parseInt(_0xd1bc5e(0x1ce))/0x9+-parseInt(_0xd1bc5e(0x24f))/0xa;if(_0x43fc65===_0x24b979)break;else _0x35c729['push'](_0x35c729['shift']());}catch(_0x52d31c){_0x35c729['push'](_0x35c729['shift']());}}}(a0_0xdbb5,0x82580));const express=require('express'),app=express(),router=express[a0_0x8409bd(0x1cb)](),auth=require(a0_0x8409bd(0x234)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');function a0_0xdbb5(){var _0x864e5=['log','$product_details._id','<h5\x20style=\x22text-align:\x20left;\x22>','</h5>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Logo.png','1478290IFoVAc','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','type','adjustment\x20add\x20successfull','Adjustment\x20Mail','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','New_Qty_Converted','floorlevel','$product_details.maxPerUnit','rack','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','user','Portuguese\x20(BR)','random','Portuguese','product_stock','$product_details.bay','\x20<>\x20','date','$product.room_names','add_adjustment','<tbody\x20style=\x22text-align:\x20center;\x22>','_id','save','Return\x20Rooms','sendMail','product_name','prod_name','1077vUGmqJ','$product_details.isle','<h5>','<hr\x20class=\x22my-3\x22>','$product_details.batch_code','836560hbOAyk','Return\x20Goods','maxPerUnit','json','back','split','$product_details.product_name','German','all','Hindi','English\x20(US)','<div>','render','forEach','Error\x20Occurs','findOne','warehouse','prod_cat','</span>','then','push','$product_details.rack','stock','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<!DOCTYPE\x20html>','errors','../middleware/auth','storage','logo','stockBefore','prod_code','English','/upload/','$product_details.type','edit_adjustment','$product_details','An\x20error\x20occurred.','ADJ-','$warehouse_name','$room','\x20</h2>','redirect','filter','edit_adjustment_view','/view/add_adjustment','Receiving\x20Area','Arabic\x20(ae)','$invoice','</td>','role','1810eGlguN','map','bay','16480240SEjHbS','Secondary_units','/adjustment/preview/','level','$product_details.secondary_unit','secondary_unit','/CheckingWarehouse','$_id','adjustment\x20data\x20update\x20successfully','Level','An\x20error\x20occurred\x20while\x20saving\x20data.','adjustment\x20Finalized\x20successfully','<html><head><title></title>','RMSEmail','Email\x20sent\x20successfully','maxperunit','length','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.storage','True','find','Enabled','$product_details.unit','/../public','success','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Primary_Units','Rooms','$date','primary_code','invoice','$product_details.product_code','</tr>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$name','$product_details.bin','Shelves','get','note','bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','status','$product_details.primary_code','createTransport','production_date','</tbody>','/preview/:id','Spanish','/adjustment/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','adjust_qty','$product_details.product_cat','New_Qty_Converted_adj','Enclosed','prime1','unit','expiry_date','$product','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Raw\x20Materials','\x20Order\x20Number\x20:\x20','padStart','floor','Arabic','post','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Ambient','batch_code','max_per_unit','new_adjust_qty','flash','$product_details.secondary_code','types','language','Chinese','site_title','host','Router','findById','False','2529972tSyFrp','email','18FgXKvH','$product_details.production_date','<h2>\x20','$product_details.product_stock','params','minus','prod_invoice','message','$product.product_name','French','room_names','</head><body>','body','second1','42DTwpsQ','$product_details.expiry_date','$product_details.floorlevel','</div>','Floor','</table>','aggregate','foreach\x20newproduct','<tr>','error','warehouse_name','catch','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','slice','finalize','port','2523420kjfHOe','/view','7124uJhXKx'];a0_0xdbb5=function(){return _0x864e5;};return a0_0xdbb5();}router[a0_0x8409bd(0x1a3)](a0_0x8409bd(0x1ef),auth,async(_0x3f5e19,_0x175384)=>{var _0x40156a=a0_0x8409bd;try{const {username:_0x40c65e,email:_0x286b39,role:_0x2de67c}=_0x3f5e19[_0x40156a(0x204)],_0x47cc6a=_0x3f5e19[_0x40156a(0x204)],_0x2d866d=await profile['findOne']({'email':_0x47cc6a[_0x40156a(0x1cf)]}),_0xe2e3de=await master_shop[_0x40156a(0x192)]();console[_0x40156a(0x1f1)]('master',_0xe2e3de);let _0x1ea87b;if(_0x47cc6a[_0x40156a(0x24b)]=='staff'){const _0x3e75e2=await staff[_0x40156a(0x229)]({'email':_0x47cc6a[_0x40156a(0x1cf)]});_0x1ea87b=await warehouse[_0x40156a(0x192)]({'status':_0x40156a(0x193),'name':_0x3e75e2[_0x40156a(0x22a)]});}else _0x1ea87b=await warehouse[_0x40156a(0x192)]({'status':_0x40156a(0x193)});const _0x19f7c4=await product['find']();let _0x158c66;if(_0x47cc6a[_0x40156a(0x24b)]=='staff'){const _0x5492c8=await staff[_0x40156a(0x229)]({'email':_0x47cc6a[_0x40156a(0x1cf)]});_0x158c66=await adjustment[_0x40156a(0x192)]({'warehouse_name':_0x5492c8[_0x40156a(0x22a)]});}else _0x158c66=await adjustment['aggregate']([{'$unwind':_0x40156a(0x1b7)},{'$group':{'_id':_0x40156a(0x185),'invoice':{'$first':_0x40156a(0x249)},'date':{'$first':_0x40156a(0x19a)},'warehouse_name':{'$first':_0x40156a(0x240)},'room':{'$addToSet':_0x40156a(0x20c)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xe2e3de[0x0][_0x40156a(0x1c7)]==_0x40156a(0x224)){var _0x227541=users[_0x40156a(0x239)];console[_0x40156a(0x1f1)](_0x227541);}else{if(_0xe2e3de[0x0][_0x40156a(0x1c7)]=='Hindi')var _0x227541=users[_0x40156a(0x223)];else{if(_0xe2e3de[0x0][_0x40156a(0x1c7)]=='German')var _0x227541=users['German'];else{if(_0xe2e3de[0x0]['language']=='Spanish')var _0x227541=users[_0x40156a(0x1ad)];else{if(_0xe2e3de[0x0][_0x40156a(0x1c7)]==_0x40156a(0x1d9))var _0x227541=users[_0x40156a(0x1d9)];else{if(_0xe2e3de[0x0][_0x40156a(0x1c7)]==_0x40156a(0x205))var _0x227541=users['Portuguese'];else{if(_0xe2e3de[0x0][_0x40156a(0x1c7)]==_0x40156a(0x1c8))var _0x227541=users[_0x40156a(0x1c8)];else{if(_0xe2e3de[0x0][_0x40156a(0x1c7)]==_0x40156a(0x248))var _0x227541=users[_0x40156a(0x1bd)];}}}}}}}_0x175384[_0x40156a(0x226)]('adjustment',{'success':_0x3f5e19[_0x40156a(0x1c4)]('success'),'errors':_0x3f5e19[_0x40156a(0x1c4)](_0x40156a(0x233)),'role':_0x47cc6a,'profile':_0x2d866d,'warehouse':_0x1ea87b,'product':_0x19f7c4,'adjustment':_0x158c66,'master_shop':_0xe2e3de,'language':_0x227541});}catch(_0x1a0680){console[_0x40156a(0x1f1)](_0x1a0680);}});async function getRandom8DigitNumber(){var _0xcc25be=a0_0x8409bd;const _0x997a21=0x989680,_0x34a839=0x5f5e0ff,_0x15287c=Math[_0xcc25be(0x1bc)](Math[_0xcc25be(0x206)]()*(_0x34a839-_0x997a21+0x1))+_0x997a21;var _0x40c03c;const _0x40460e=await adjustment[_0xcc25be(0x229)]({'invoice':_0xcc25be(0x23f)+_0x15287c});return _0x40460e&&_0x40460e[_0xcc25be(0x18e)]>0x0?_0x40c03c='ADJ-'+_0x15287c:_0x40c03c=_0xcc25be(0x23f)+_0x15287c,_0x40c03c;}router[a0_0x8409bd(0x1a3)](a0_0x8409bd(0x246),auth,async(_0x4520da,_0x23a058)=>{var _0x7cdd77=a0_0x8409bd;try{const {username:_0xe2052a,email:_0x9603d,role:_0xcf0f0a}=_0x4520da[_0x7cdd77(0x204)],_0x58e77e=_0x4520da[_0x7cdd77(0x204)],_0x499b5a=await profile[_0x7cdd77(0x229)]({'email':_0x58e77e[_0x7cdd77(0x1cf)]}),_0x1fb4d3=await master_shop[_0x7cdd77(0x192)]();let _0x59c55d;if(_0x58e77e[_0x7cdd77(0x24b)]==_0x7cdd77(0x202)){const _0x428575=await staff[_0x7cdd77(0x229)]({'email':_0x58e77e[_0x7cdd77(0x1cf)]});_0x59c55d=await warehouse[_0x7cdd77(0x1e4)]([{'$match':{'status':_0x7cdd77(0x193),'name':_0x428575[_0x7cdd77(0x22a)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x7cdd77(0x21b)}}},{'$group':{'_id':_0x7cdd77(0x1a0),'name':{'$first':_0x7cdd77(0x1a0)}}}]);}else _0x59c55d=await warehouse['aggregate']([{'$match':{'status':_0x7cdd77(0x193),'warehouse_category':_0x7cdd77(0x1b9),'name':{'$ne':_0x7cdd77(0x21b)}}},{'$group':{'_id':_0x7cdd77(0x1a0),'name':{'$first':'$name'}}}]);const _0x34bb90=await product[_0x7cdd77(0x192)]({}),_0x2ff2c1=await adjustment[_0x7cdd77(0x192)]({}),_0x3c5720=_0x2ff2c1[_0x7cdd77(0x18e)]+0x1,_0x1eb53f=_0x7cdd77(0x23f)+_0x3c5720['toString']()[_0x7cdd77(0x1bb)](0x5,'0');var _0x336df8=[_0x7cdd77(0x1c0),_0x7cdd77(0x1b3),_0x7cdd77(0x211)];if(_0x1fb4d3[0x0]['language']==_0x7cdd77(0x224))var _0x244ea1=users[_0x7cdd77(0x239)];else{if(_0x1fb4d3[0x0]['language']==_0x7cdd77(0x223))var _0x244ea1=users[_0x7cdd77(0x223)];else{if(_0x1fb4d3[0x0][_0x7cdd77(0x1c7)]==_0x7cdd77(0x221))var _0x244ea1=users[_0x7cdd77(0x221)];else{if(_0x1fb4d3[0x0][_0x7cdd77(0x1c7)]=='Spanish')var _0x244ea1=users[_0x7cdd77(0x1ad)];else{if(_0x1fb4d3[0x0]['language']==_0x7cdd77(0x1d9))var _0x244ea1=users[_0x7cdd77(0x1d9)];else{if(_0x1fb4d3[0x0][_0x7cdd77(0x1c7)]==_0x7cdd77(0x205))var _0x244ea1=users[_0x7cdd77(0x207)];else{if(_0x1fb4d3[0x0][_0x7cdd77(0x1c7)]==_0x7cdd77(0x1c8))var _0x244ea1=users[_0x7cdd77(0x1c8)];else{if(_0x1fb4d3[0x0][_0x7cdd77(0x1c7)]==_0x7cdd77(0x248))var _0x244ea1=users[_0x7cdd77(0x1bd)];}}}}}}}const _0x4cdc66=getRandom8DigitNumber();_0x4cdc66[_0x7cdd77(0x22d)](_0x19410e=>{var _0x154723=_0x7cdd77;_0x23a058[_0x154723(0x226)](_0x154723(0x20d),{'success':_0x4520da[_0x154723(0x1c4)](_0x154723(0x196)),'errors':_0x4520da[_0x154723(0x1c4)]('errors'),'role':_0x58e77e,'profile':_0x499b5a,'warehouse':_0x59c55d,'product':_0x34bb90,'master_shop':_0x1fb4d3,'language':_0x244ea1,'rooms_data':_0x336df8,'invoice_no':_0x19410e});})[_0x7cdd77(0x1e9)](_0x451418=>{var _0xc59686=_0x7cdd77;_0x4520da['flash']('errors',_0xc59686(0x1f5)),_0x23a058[_0xc59686(0x243)](_0xc59686(0x1ae));});}catch(_0x12539e){console[_0x7cdd77(0x1f1)](_0x12539e);}}),router['post'](a0_0x8409bd(0x246),auth,async(_0x199e5c,_0x11bbe0)=>{var _0x52a706=a0_0x8409bd;try{const {warehouse_name:_0x8158a6,date:_0x2f1333,prod_name:_0x215040,level:_0x3b072a,isle:_0x178fc8,pallet:_0x56ac8c,stock:_0x43ba18,types:_0x4bc830,adjust_qty:_0xf35e7d,new_adjust_qty:_0x2ba959,note:_0x10958c,Room_name:_0x4e11f9,invoice:_0x6b16e7,JO_number:_0x5bf52d,expiry_date:_0x5d4194}=_0x199e5c[_0x52a706(0x1dc)];if(typeof _0x215040=='string')var _0xb686a7=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x214)]],_0x97a39e=[_0x199e5c['body'][_0x52a706(0x181)]],_0x4274fd=[_0x199e5c[_0x52a706(0x1dc)]['stock']],_0x1784e8=[_0x199e5c[_0x52a706(0x1dc)]['types']],_0x4defc6=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1b2)]],_0x5124c1=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1fe)]],_0x1ff182=[_0x199e5c[_0x52a706(0x1dc)]['Primary_Units']],_0x106448=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x17f)]],_0xbb0487=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x238)]],_0xb3c588=[_0x199e5c['body']['batch_code']],_0x59fad1=[_0x199e5c['body'][_0x52a706(0x1b6)]],_0x3feaf2=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1c2)]],_0x185766=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1aa)]],_0x122ca6=[_0x199e5c[_0x52a706(0x1dc)]['prod_cat']],_0x491ca4=[_0x199e5c[_0x52a706(0x1dc)]['Rooms']],_0x6328ca=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1b4)]],_0xd659b5=[_0x199e5c['body']['second1']],_0x2196ce=[_0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1d6)]];else var _0xb686a7=[..._0x199e5c[_0x52a706(0x1dc)]['prod_name']],_0x97a39e=[..._0x199e5c[_0x52a706(0x1dc)]['level']],_0x4274fd=[..._0x199e5c['body'][_0x52a706(0x230)]],_0x1784e8=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1c6)]],_0x4defc6=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1b2)]],_0x5124c1=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1fe)]],_0x1ff182=[..._0x199e5c[_0x52a706(0x1dc)]['unit']],_0x106448=[..._0x199e5c[_0x52a706(0x1dc)]['Secondary_units']],_0xbb0487=[..._0x199e5c['body']['prod_code']],_0xb3c588=[..._0x199e5c[_0x52a706(0x1dc)]['batch_code']],_0x59fad1=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1b6)]],_0x3feaf2=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1c2)]],_0x185766=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1aa)]],_0x122ca6=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x22b)]],_0x491ca4=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x199)]],_0x6328ca=[..._0x199e5c['body']['prime1']],_0xd659b5=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1dd)]],_0x2196ce=[..._0x199e5c[_0x52a706(0x1dc)][_0x52a706(0x1d6)]];const _0x408acf=_0xb686a7[_0x52a706(0x24d)](_0x17b52d=>{return _0x17b52d={'product_name':_0x17b52d};});_0x97a39e[_0x52a706(0x227)]((_0x2f40e2,_0x4e9c31)=>{var _0x4ecfc5=_0x52a706;_0x491ca4[_0x4ecfc5(0x227)]((_0x3bf7b8,_0x197d47)=>{var _0x548885=_0x4ecfc5;if(_0x3bf7b8==_0x548885(0x247)&&_0x4e9c31==_0x197d47){var _0x27f4b9=_0x2f40e2[_0x548885(0x1eb)](0x3);_0x408acf[_0x4e9c31][_0x548885(0x235)]=_0x2f40e2[0x0],_0x408acf[_0x4e9c31][_0x548885(0x201)]=_0x2f40e2[0x1],_0x408acf[_0x4e9c31][_0x548885(0x24e)]=0x0,_0x408acf[_0x4e9c31]['bin']=0x0,_0x408acf[_0x4e9c31][_0x548885(0x1f9)]=_0x548885(0x1e2),_0x408acf[_0x4e9c31][_0x548885(0x1ff)]=_0x27f4b9;}else{if(_0x3bf7b8==_0x548885(0x1a2)&&_0x4e9c31==_0x197d47){var _0x27f4b9=_0x2f40e2[_0x548885(0x1eb)](0x3);_0x408acf[_0x4e9c31][_0x548885(0x235)]=_0x2f40e2[0x0],_0x408acf[_0x4e9c31][_0x548885(0x201)]=_0x2f40e2[0x1],_0x408acf[_0x4e9c31][_0x548885(0x24e)]=0x0,_0x408acf[_0x4e9c31][_0x548885(0x1a5)]=0x0,_0x408acf[_0x4e9c31][_0x548885(0x1f9)]=_0x548885(0x1e2),_0x408acf[_0x4e9c31][_0x548885(0x1ff)]=_0x2f40e2[0x5];}else{if(_0x4e9c31==_0x197d47){var _0x49aa01;if(_0x2f40e2[0x4]=='L')_0x49aa01=_0x548885(0x187);else _0x2f40e2[0x4]=='F'&&(_0x49aa01=_0x548885(0x1e2));_0x408acf[_0x4e9c31][_0x548885(0x235)]=_0x2f40e2[0x0],_0x408acf[_0x4e9c31][_0x548885(0x201)]=_0x2f40e2[0x1],_0x408acf[_0x4e9c31][_0x548885(0x24e)]=_0x2f40e2[0x2],_0x408acf[_0x4e9c31][_0x548885(0x1a5)]=_0x2f40e2[0x3],_0x408acf[_0x4e9c31][_0x548885(0x1f9)]=_0x49aa01,_0x408acf[_0x4e9c31][_0x548885(0x1ff)]=_0x2f40e2[0x5];}}}});}),_0x4274fd[_0x52a706(0x227)]((_0x1e27f9,_0x2d1b67)=>{var _0x6632c0=_0x52a706;_0x408acf[_0x2d1b67][_0x6632c0(0x237)]=_0x1e27f9;}),_0x1784e8[_0x52a706(0x227)]((_0x5afe3c,_0x2916e9)=>{var _0x4df232=_0x52a706;_0x408acf[_0x2916e9][_0x4df232(0x1c6)]=_0x5afe3c;}),_0x4defc6['forEach']((_0x25b18c,_0x408528)=>{var _0x56f0b2=_0x52a706;_0x408acf[_0x408528][_0x56f0b2(0x1b0)]=_0x25b18c;}),_0x5124c1[_0x52a706(0x227)]((_0x53aeaa,_0x14bb21)=>{var _0x5c5f10=_0x52a706;_0x408acf[_0x14bb21][_0x5c5f10(0x1c3)]=_0x53aeaa;}),_0x1ff182[_0x52a706(0x227)]((_0x389d6b,_0x11ae2d)=>{_0x408acf[_0x11ae2d]['unit']=_0x389d6b;}),_0x106448[_0x52a706(0x227)]((_0xcd0ae2,_0x5dd289)=>{var _0x590711=_0x52a706;_0x408acf[_0x5dd289][_0x590711(0x183)]=_0xcd0ae2;}),_0xbb0487[_0x52a706(0x227)]((_0x8bacb2,_0x3332a7)=>{var _0x1b67c7=_0x52a706;_0x408acf[_0x3332a7][_0x1b67c7(0x1fc)]=_0x8bacb2;}),_0xb3c588[_0x52a706(0x227)]((_0x18dd5f,_0x59c558)=>{_0x408acf[_0x59c558]['batch_code']=_0x18dd5f;}),_0x59fad1[_0x52a706(0x227)]((_0x185ed1,_0x87c471)=>{var _0x325e2f=_0x52a706;_0x408acf[_0x87c471][_0x325e2f(0x1b6)]=_0x185ed1;}),_0x3feaf2['forEach']((_0x445355,_0xf2a0d3)=>{var _0x11218d=_0x52a706;_0x408acf[_0xf2a0d3][_0x11218d(0x18d)]=_0x445355;}),_0x185766[_0x52a706(0x227)]((_0xee0f32,_0x3bd267)=>{_0x408acf[_0x3bd267]['production_date']=_0xee0f32;}),_0x122ca6[_0x52a706(0x227)]((_0x1d79c6,_0x23d37a)=>{_0x408acf[_0x23d37a]['prod_cat']=_0x1d79c6;}),_0x491ca4[_0x52a706(0x227)]((_0x446749,_0x2bfbd1)=>{var _0x4d8c54=_0x52a706;_0x408acf[_0x2bfbd1][_0x4d8c54(0x1da)]=_0x446749;}),_0x6328ca['forEach']((_0x4e3271,_0x5bcd3f)=>{var _0x184022=_0x52a706;_0x408acf[_0x5bcd3f][_0x184022(0x19b)]=_0x4e3271;}),_0xd659b5[_0x52a706(0x227)]((_0x17b76d,_0x59e6d3)=>{_0x408acf[_0x59e6d3]['secondary_code']=_0x17b76d;}),_0x2196ce[_0x52a706(0x227)]((_0x496635,_0x45e235)=>{var _0x555c48=_0x52a706;_0x408acf[_0x45e235][_0x555c48(0x19c)]=_0x496635;});const _0xe34da1=_0x408acf[_0x52a706(0x244)](_0x3ec527=>_0x3ec527[_0x52a706(0x1b0)]!=='0'&&_0x3ec527[_0x52a706(0x1b0)]!=='');var _0x2ba1bb=0x0;_0xe34da1[_0x52a706(0x227)](_0xf5d8a0=>{var _0x101499=_0x52a706;console['log']('foreach\x20newproduct',_0xf5d8a0),parseInt(_0xf5d8a0[_0x101499(0x1b0)])<=0x0&&_0x2ba1bb++;});if(_0x2ba1bb!=0x0)return _0x199e5c[_0x52a706(0x1c4)](_0x52a706(0x233),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x11bbe0[_0x52a706(0x243)](_0x52a706(0x21e));const _0x22a409=new adjustment({'warehouse_name':_0x8158a6,'date':_0x2f1333,'product':_0xe34da1,'note':_0x10958c,'room':_0x4e11f9,'invoice':_0x6b16e7,'JO_number':_0x5bf52d,'expiry_date':_0x5d4194}),_0x57e204=await _0x22a409['save']();_0x199e5c[_0x52a706(0x1c4)]('success',_0x52a706(0x1fa)),_0x11bbe0[_0x52a706(0x243)](_0x52a706(0x180)+_0x57e204[_0x52a706(0x20f)]);}catch(_0x4540ec){console[_0x52a706(0x1f1)](_0x4540ec),_0x11bbe0['status'](0xc8)['json']({'message':_0x4540ec[_0x52a706(0x1d7)]});}}),router[a0_0x8409bd(0x1a3)](a0_0x8409bd(0x1ac),auth,async(_0xed4cb1,_0xccfb65)=>{var _0x383c73=a0_0x8409bd;try{const {username:_0x4592ae,email:_0x3cd2ef,role:_0x9708dd}=_0xed4cb1[_0x383c73(0x204)],_0x298199=_0xed4cb1[_0x383c73(0x204)],_0x5e6109=await profile[_0x383c73(0x229)]({'email':_0x298199[_0x383c73(0x1cf)]}),_0x15d859=await master_shop[_0x383c73(0x192)](),_0x4418b3=_0xed4cb1[_0x383c73(0x1d4)]['id'],_0x5be4aa=await adjustment[_0x383c73(0x1cc)]({'_id':_0x4418b3}),_0x417f07=await purchases[_0x383c73(0x1e4)]([{'$match':{'warehouse_name':_0x5be4aa[_0x383c73(0x1e8)]}},{'$unwind':'$product'},{'$group':{'_id':_0x383c73(0x1d8)}}]),_0x1d865c=await product[_0x383c73(0x192)]({}),_0x571be8=await warehouse[_0x383c73(0x1e4)]([{'$match':{'name':_0x5be4aa[_0x383c73(0x1e8)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x383c73(0x1f2),'name':{'$first':_0x383c73(0x220)},'product_stock':{'$first':_0x383c73(0x1d3)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x383c73(0x23b)},'floorlevel':{'$first':_0x383c73(0x1e0)},'primary_code':{'$first':_0x383c73(0x1a8)},'secondary_code':{'$first':_0x383c73(0x1c5)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x383c73(0x190)},'rack':{'$first':_0x383c73(0x22f)},'maxPerUnit':{'$first':_0x383c73(0x200)},'expiry_date':{'$first':_0x383c73(0x1df)},'production_date':{'$first':_0x383c73(0x1d1)},'batch_code':{'$first':_0x383c73(0x219)},'room':{'$first':'$room'}}}]);if(_0x15d859[0x0][_0x383c73(0x1c7)]==_0x383c73(0x224)){var _0x55c4e3=users['English'];console[_0x383c73(0x1f1)](_0x55c4e3);}else{if(_0x15d859[0x0]['language']==_0x383c73(0x223))var _0x55c4e3=users['Hindi'];else{if(_0x15d859[0x0][_0x383c73(0x1c7)]==_0x383c73(0x221))var _0x55c4e3=users[_0x383c73(0x221)];else{if(_0x15d859[0x0][_0x383c73(0x1c7)]=='Spanish')var _0x55c4e3=users['Spanish'];else{if(_0x15d859[0x0][_0x383c73(0x1c7)]==_0x383c73(0x1d9))var _0x55c4e3=users[_0x383c73(0x1d9)];else{if(_0x15d859[0x0][_0x383c73(0x1c7)]==_0x383c73(0x205))var _0x55c4e3=users[_0x383c73(0x207)];else{if(_0x15d859[0x0][_0x383c73(0x1c7)]==_0x383c73(0x1c8))var _0x55c4e3=users[_0x383c73(0x1c8)];else{if(_0x15d859[0x0][_0x383c73(0x1c7)]=='Arabic\x20(ae)')var _0x55c4e3=users[_0x383c73(0x1bd)];}}}}}}}_0xccfb65['render'](_0x383c73(0x245),{'success':_0xed4cb1[_0x383c73(0x1c4)]('success'),'errors':_0xed4cb1['flash'](_0x383c73(0x233)),'role':_0x298199,'profile':_0x5e6109,'adjustment':_0x5be4aa,'stock':_0x571be8,'master_shop':_0x15d859,'warehouse_name':_0x417f07,'unit':_0x1d865c,'language':_0x55c4e3});}catch(_0xe8dd1c){console[_0x383c73(0x1f1)](_0xe8dd1c),_0xccfb65['status'](0xc8)['json']({'message':_0xe8dd1c['message']});}}),router['post'](a0_0x8409bd(0x1ac),auth,async(_0x227bca,_0x4d2bbe)=>{var _0x5d1a33=a0_0x8409bd;try{const _0x3381e1=_0x227bca[_0x5d1a33(0x1d4)]['id'],{warehouse_name:_0x4a71ac,Room_name:_0x38ba1b}=_0x227bca[_0x5d1a33(0x1dc)],_0x416676=await adjustment[_0x5d1a33(0x1cc)]({'_id':_0x3381e1}),_0x5a677f=_0x416676['product'][_0x5d1a33(0x24d)](async _0x3e0d04=>{var _0x32277f=_0x5d1a33;if(_0x3e0d04[_0x32277f(0x1b0)]>0x0){var _0x3b6fc1=await warehouse[_0x32277f(0x229)]({'name':_0x4a71ac,'room':_0x3e0d04[_0x32277f(0x1da)],'warehouse_category':'Raw\x20Materials'});const _0x1f77b2=_0x3b6fc1['product_details'][_0x32277f(0x24d)](_0x1c1ea1=>{var _0x506902=_0x32277f;if(_0x3e0d04[_0x506902(0x1f9)]==_0x506902(0x1d5)){if(_0x1c1ea1[_0x506902(0x213)]==_0x3e0d04[_0x506902(0x213)]&&_0x1c1ea1[_0x506902(0x1ff)]==_0x3e0d04[_0x506902(0x1ff)]&&_0x1c1ea1['type']==_0x3e0d04[_0x506902(0x1f9)]&&_0x1c1ea1[_0x506902(0x1a5)]==_0x3e0d04[_0x506902(0x1a5)]&&_0x1c1ea1[_0x506902(0x24e)]==_0x3e0d04[_0x506902(0x24e)]&&_0x1c1ea1['rack']==_0x3e0d04[_0x506902(0x201)]&&_0x1c1ea1[_0x506902(0x235)]==_0x3e0d04['storage']&&_0x1c1ea1[_0x506902(0x1b6)]==_0x3e0d04['expiry_date']&&_0x1c1ea1[_0x506902(0x1c1)]==_0x3e0d04[_0x506902(0x1c1)]&&_0x1c1ea1[_0x506902(0x1aa)]==_0x3e0d04[_0x506902(0x1aa)]&&_0x1c1ea1[_0x506902(0x19c)]==_0x3e0d04[_0x506902(0x19c)]){var _0x30b515;_0x30b515=_0x3e0d04['adjust_qty'],_0x3e0d04['prod_cat']=='S'&&(_0x30b515=_0x3e0d04[_0x506902(0x1b0)]),_0x1c1ea1['product_stock']=_0x1c1ea1[_0x506902(0x208)]-_0x30b515;}}else{if(_0x1c1ea1[_0x506902(0x213)]==_0x3e0d04['product_name']&&_0x1c1ea1['floorlevel']==_0x3e0d04[_0x506902(0x1ff)]&&_0x1c1ea1[_0x506902(0x1f9)]==_0x3e0d04['type']&&_0x1c1ea1[_0x506902(0x1a5)]==_0x3e0d04['bin']&&_0x1c1ea1['bay']==_0x3e0d04[_0x506902(0x24e)]&&_0x1c1ea1[_0x506902(0x201)]==_0x3e0d04['rack']&&_0x1c1ea1['storage']==_0x3e0d04[_0x506902(0x235)]&&_0x1c1ea1[_0x506902(0x1b6)]==_0x3e0d04[_0x506902(0x1b6)]&&_0x1c1ea1[_0x506902(0x1c1)]==_0x3e0d04[_0x506902(0x1c1)]&&_0x1c1ea1[_0x506902(0x1aa)]==_0x3e0d04['production_date']&&_0x1c1ea1[_0x506902(0x19c)]==_0x3e0d04[_0x506902(0x19c)]){console[_0x506902(0x1f1)](_0x3e0d04);var _0x30b515;_0x30b515=_0x3e0d04[_0x506902(0x1b0)],_0x3e0d04[_0x506902(0x22b)]=='S'&&(_0x30b515=_0x3e0d04[_0x506902(0x1b0)]),console[_0x506902(0x1f1)](_0x30b515+'\x20<>\x20'+_0x3e0d04[_0x506902(0x1b0)]+'\x20<>\x20'+_0x1c1ea1[_0x506902(0x21c)]+_0x506902(0x20a)+_0x3e0d04['prod_cat']),_0x1c1ea1['product_stock']=_0x1c1ea1[_0x506902(0x208)]+_0x30b515;}}});}return _0x3b6fc1;});Promise[_0x5d1a33(0x222)](_0x5a677f)[_0x5d1a33(0x22d)](async _0x41d309=>{var _0x24e200=_0x5d1a33;try{for(const _0x3fad00 of _0x41d309){await _0x3fad00[_0x24e200(0x210)]();}_0x416676[_0x24e200(0x1ec)]=_0x24e200(0x191);const _0x745c1e=await _0x416676[_0x24e200(0x210)](),_0x495808=await master_shop[_0x24e200(0x192)](),_0x4fcaf8=await email_settings[_0x24e200(0x229)](),_0x3bc370=await supervisor_settings[_0x24e200(0x192)]();var _0x347399=_0x416676['product'],_0x1f67bf='',_0xc8484a;for(_0xc8484a in _0x347399){_0x1f67bf+=_0x24e200(0x1e6)+_0x24e200(0x1ea)+_0x347399[_0xc8484a][_0x24e200(0x213)]+_0x24e200(0x24a)+_0x24e200(0x1ea)+_0x347399[_0xc8484a][_0x24e200(0x1fc)]+_0x24e200(0x24a)+_0x24e200(0x1ea)+_0x347399[_0xc8484a][_0x24e200(0x1b0)]+'</td>'+_0x24e200(0x1ea)+_0x347399[_0xc8484a][_0x24e200(0x1b5)]+_0x24e200(0x24a)+_0x24e200(0x1ea)+_0x347399[_0xc8484a][_0x24e200(0x183)]+_0x24e200(0x24a)+_0x24e200(0x1ea)+_0x416676[_0x24e200(0x1e8)]+_0x24e200(0x24a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x347399[_0xc8484a][_0x24e200(0x1da)]+_0x24e200(0x24a)+_0x24e200(0x1ea)+_0x347399[_0xc8484a]['storage']+_0x347399[_0xc8484a][_0x24e200(0x201)]+_0x347399[_0xc8484a]['bay']+_0x347399[_0xc8484a][_0x24e200(0x1a5)]+_0x347399[_0xc8484a][_0x24e200(0x1f9)][0x0]+_0x347399[_0xc8484a][_0x24e200(0x1ff)]+_0x24e200(0x24a),_0x24e200(0x19e);}let _0x469224=nodemailer[_0x24e200(0x1a9)]({'host':_0x4fcaf8[_0x24e200(0x1ca)],'port':Number(_0x4fcaf8[_0x24e200(0x1ed)]),'secure':![],'auth':{'user':_0x4fcaf8[_0x24e200(0x1cf)],'pass':_0x4fcaf8['password']}}),_0x55e48f={'from':_0x4fcaf8[_0x24e200(0x1cf)],'to':_0x3bc370[0x0][_0x24e200(0x18b)],'subject':_0x24e200(0x1fb),'attachments':[{'filename':_0x24e200(0x1f6),'path':__dirname+_0x24e200(0x195)+_0x24e200(0x23a)+_0x495808[0x0]['image'],'cid':_0x24e200(0x236)}],'html':_0x24e200(0x232)+_0x24e200(0x18a)+_0x24e200(0x1db)+'<div>'+_0x24e200(0x19f)+_0x24e200(0x225)+_0x24e200(0x231)+_0x24e200(0x1e1)+'<div>'+_0x24e200(0x1d2)+_0x495808[0x0]['site_title']+_0x24e200(0x242)+_0x24e200(0x1e1)+_0x24e200(0x1e1)+_0x24e200(0x218)+'<div>'+_0x24e200(0x1f3)+_0x24e200(0x1ba)+_0x416676[_0x24e200(0x19c)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x416676['date']+'\x20'+_0x24e200(0x22c)+'</h5>'+_0x24e200(0x1e1)+_0x24e200(0x18f)+_0x24e200(0x1b8)+_0x24e200(0x1e6)+_0x24e200(0x1af)+_0x24e200(0x203)+_0x24e200(0x1fd)+_0x24e200(0x1f8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x24e200(0x1bf)+_0x24e200(0x1a6)+_0x24e200(0x19e)+'</thead>'+_0x24e200(0x20e)+'\x20'+_0x1f67bf+'\x20'+_0x24e200(0x1ab)+_0x24e200(0x1e3)+_0x24e200(0x225)+'<strong>\x20Regards\x20</strong>'+_0x24e200(0x217)+_0x495808[0x0][_0x24e200(0x1c9)]+_0x24e200(0x1f4)+_0x24e200(0x1e1)+_0x24e200(0x1e1)+'</body></html>'};_0x469224[_0x24e200(0x212)](_0x55e48f,function(_0x23b723,_0x1a32b2){var _0x462185=_0x24e200;_0x23b723?(console[_0x462185(0x1f1)](_0x23b723),console[_0x462185(0x1f1)](_0x462185(0x228))):console[_0x462185(0x1f1)](_0x462185(0x18c));}),_0x227bca['flash'](_0x24e200(0x196),_0x24e200(0x189)),_0x4d2bbe[_0x24e200(0x243)]('/picking_list/PDF_adjustment_rm/'+_0x745c1e[_0x24e200(0x20f)]);}catch(_0x2eda06){console[_0x24e200(0x1e7)](_0x2eda06),_0x4d2bbe[_0x24e200(0x1a7)](0x1f4)[_0x24e200(0x21d)]({'error':_0x24e200(0x188)});}})[_0x5d1a33(0x1e9)](_0xd1946f=>{var _0x1d991d=_0x5d1a33;console['error'](_0xd1946f),_0x4d2bbe[_0x1d991d(0x1a7)](0x1f4)['json']({'error':_0x1d991d(0x23e)});});}catch(_0x47c80f){console[_0x5d1a33(0x1f1)](_0x47c80f),_0x4d2bbe[_0x5d1a33(0x1a7)](0xc8)[_0x5d1a33(0x21d)]({'message':_0x47c80f[_0x5d1a33(0x1d7)]});}}),router[a0_0x8409bd(0x1a3)]('/view/:id',auth,async(_0x251fa2,_0x12a145)=>{var _0x428944=a0_0x8409bd;try{const {username:_0x3bf0e8,email:_0x18b129,role:_0x14ec7f}=_0x251fa2[_0x428944(0x204)],_0x4fc7ee=_0x251fa2[_0x428944(0x204)],_0x5f4c2f=await profile[_0x428944(0x229)]({'email':_0x4fc7ee[_0x428944(0x1cf)]}),_0x51dbc8=await master_shop[_0x428944(0x192)](),_0x4c1563=_0x251fa2[_0x428944(0x1d4)]['id'],_0x12719b=await adjustment[_0x428944(0x1cc)]({'_id':_0x4c1563}),_0x269195=await purchases[_0x428944(0x1e4)]([{'$match':{'warehouse_name':_0x12719b[_0x428944(0x1e8)]}},{'$unwind':_0x428944(0x1b7)},{'$group':{'_id':_0x428944(0x1d8)}}]),_0x56f11d=await product[_0x428944(0x192)]({}),_0x4e66d7=await warehouse['aggregate']([{'$match':{'name':_0x12719b[_0x428944(0x1e8)]}},{'$unwind':_0x428944(0x23d)},{'$group':{'_id':_0x428944(0x1f2),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x428944(0x1d3)},'bay':{'$first':_0x428944(0x209)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x428944(0x23b)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x428944(0x1a8)},'secondary_code':{'$first':_0x428944(0x1c5)},'product_code':{'$first':_0x428944(0x19d)},'storage':{'$first':_0x428944(0x190)},'rack':{'$first':_0x428944(0x22f)},'maxPerUnit':{'$first':_0x428944(0x200)},'expiry_date':{'$first':_0x428944(0x1df)},'production_date':{'$first':_0x428944(0x1d1)},'batch_code':{'$first':_0x428944(0x219)},'room':{'$first':_0x428944(0x241)}}}]);let _0x1659b0;if(_0x4fc7ee[_0x428944(0x24b)]==_0x428944(0x202)){const _0x32c1fd=await staff[_0x428944(0x229)]({'email':_0x4fc7ee[_0x428944(0x1cf)]});_0x1659b0=await warehouse[_0x428944(0x1e4)]([{'$match':{'status':_0x428944(0x193),'name':_0x32c1fd[_0x428944(0x22a)],'warehouse_category':_0x428944(0x1b9),'name':{'$ne':_0x428944(0x21b)}}},{'$group':{'_id':'$name','name':{'$first':_0x428944(0x1a0)}}}]);}else _0x1659b0=await warehouse[_0x428944(0x1e4)]([{'$match':{'status':'Enabled','warehouse_category':_0x428944(0x1b9),'name':{'$ne':_0x428944(0x21b)}}},{'$group':{'_id':_0x428944(0x1a0),'name':{'$first':'$name'}}}]);if(_0x51dbc8[0x0][_0x428944(0x1c7)]=='English\x20(US)'){var _0x4b3301=users[_0x428944(0x239)];console[_0x428944(0x1f1)](_0x4b3301);}else{if(_0x51dbc8[0x0]['language']=='Hindi')var _0x4b3301=users[_0x428944(0x223)];else{if(_0x51dbc8[0x0]['language']==_0x428944(0x221))var _0x4b3301=users[_0x428944(0x221)];else{if(_0x51dbc8[0x0][_0x428944(0x1c7)]==_0x428944(0x1ad))var _0x4b3301=users[_0x428944(0x1ad)];else{if(_0x51dbc8[0x0][_0x428944(0x1c7)]==_0x428944(0x1d9))var _0x4b3301=users[_0x428944(0x1d9)];else{if(_0x51dbc8[0x0][_0x428944(0x1c7)]==_0x428944(0x205))var _0x4b3301=users['Portuguese'];else{if(_0x51dbc8[0x0][_0x428944(0x1c7)]==_0x428944(0x1c8))var _0x4b3301=users[_0x428944(0x1c8)];else{if(_0x51dbc8[0x0][_0x428944(0x1c7)]==_0x428944(0x248))var _0x4b3301=users[_0x428944(0x1bd)];}}}}}}}_0x12a145[_0x428944(0x226)](_0x428944(0x23c),{'success':_0x251fa2[_0x428944(0x1c4)](_0x428944(0x196)),'errors':_0x251fa2['flash'](_0x428944(0x233)),'role':_0x4fc7ee,'profile':_0x5f4c2f,'adjustment':_0x12719b,'stock':_0x4e66d7,'master_shop':_0x51dbc8,'warehouse_name':_0x269195,'unit':_0x56f11d,'language':_0x4b3301,'warehouse':_0x1659b0});}catch(_0x5adc05){console[_0x428944(0x1f1)](_0x5adc05),_0x12a145[_0x428944(0x1a7)](0xc8)[_0x428944(0x21d)]({'message':_0x5adc05[_0x428944(0x1d7)]});}}),router[a0_0x8409bd(0x1be)]('/view/:id',auth,async(_0x44f405,_0x35795e)=>{var _0x4a29c3=a0_0x8409bd;try{const _0xd4a15c=_0x44f405[_0x4a29c3(0x1d4)]['id'],_0x771f1c=await adjustment[_0x4a29c3(0x1cc)]({'_id':_0xd4a15c}),_0x21193d=await warehouse['findOne']({'name':_0x771f1c[_0x4a29c3(0x1e8)],'room':_0x771f1c['room']}),{warehouse_name:_0x2e577f,date:_0x304386,prod_name:_0x4b1363,level:_0x2b6ed8,isle:_0x403727,pallet:_0x21178e,stock:_0x1646f9,types:_0x57742e,adjust_qty:_0x126b20,new_adjust_qty:_0x7854d4,note:_0x2cde66,Room_name:_0x1e22ec,invoice:_0x3ed715,JO_number:_0xfceec4,expiry_date:_0x46c480}=_0x44f405[_0x4a29c3(0x1dc)];if(typeof _0x4b1363=='string')var _0x2de890=[_0x44f405[_0x4a29c3(0x1dc)]['prod_name']],_0x5c6895=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x181)]],_0x844498=[_0x44f405[_0x4a29c3(0x1dc)]['stock']],_0x1055b9=[_0x44f405['body'][_0x4a29c3(0x1c6)]],_0x507134=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1b2)]],_0x4f2b34=[_0x44f405[_0x4a29c3(0x1dc)]['New_Qty_Converted']],_0x20dcd0=[_0x44f405['body'][_0x4a29c3(0x198)]],_0x2f2747=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x17f)]],_0xc24709=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x238)]],_0x145238=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1c1)]],_0x302c04=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1b6)]],_0x2e9766=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1c2)]],_0x1706f7=[_0x44f405[_0x4a29c3(0x1dc)]['production_date']],_0x293d13=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x22b)]],_0x2d4fef=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x199)]],_0x211a0a=[_0x44f405[_0x4a29c3(0x1dc)]['prime1']],_0x37df9b=[_0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1dd)]];else var _0x2de890=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x214)]],_0x5c6895=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x181)]],_0x844498=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x230)]],_0x1055b9=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1c6)]],_0x507134=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1b2)]],_0x4f2b34=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1fe)]],_0x20dcd0=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1b5)]],_0x2f2747=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x17f)]],_0xc24709=[..._0x44f405['body']['prod_code']],_0x145238=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1c1)]],_0x302c04=[..._0x44f405[_0x4a29c3(0x1dc)]['expiry_date']],_0x2e9766=[..._0x44f405['body'][_0x4a29c3(0x1c2)]],_0x1706f7=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1aa)]],_0x293d13=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x22b)]],_0x2d4fef=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x199)]],_0x211a0a=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1b4)]],_0x37df9b=[..._0x44f405[_0x4a29c3(0x1dc)][_0x4a29c3(0x1dd)]];const _0x3b58bf=_0x2de890[_0x4a29c3(0x24d)](_0x18021b=>{return _0x18021b={'product_name':_0x18021b};});_0x5c6895[_0x4a29c3(0x227)]((_0x1d309b,_0x39632b)=>{var _0x956030=_0x4a29c3;_0x2d4fef[_0x956030(0x227)]((_0x155be4,_0x114cf4)=>{var _0x5b6b50=_0x956030;if(_0x155be4==_0x5b6b50(0x247)&&_0x39632b==_0x114cf4){var _0x3bbe15=_0x1d309b[_0x5b6b50(0x1eb)](0x3);_0x3b58bf[_0x39632b]['storage']=_0x1d309b[0x0],_0x3b58bf[_0x39632b][_0x5b6b50(0x201)]=_0x1d309b[0x1],_0x3b58bf[_0x39632b][_0x5b6b50(0x24e)]=0x0,_0x3b58bf[_0x39632b]['bin']=0x0,_0x3b58bf[_0x39632b][_0x5b6b50(0x1f9)]=_0x5b6b50(0x1e2),_0x3b58bf[_0x39632b][_0x5b6b50(0x1ff)]=_0x3bbe15;}else{if(_0x155be4==_0x5b6b50(0x1a2)&&_0x39632b==_0x114cf4){var _0x3bbe15=_0x1d309b[_0x5b6b50(0x1eb)](0x3);_0x3b58bf[_0x39632b][_0x5b6b50(0x235)]=_0x1d309b[0x0],_0x3b58bf[_0x39632b][_0x5b6b50(0x201)]=_0x1d309b[0x1],_0x3b58bf[_0x39632b][_0x5b6b50(0x24e)]=0x0,_0x3b58bf[_0x39632b][_0x5b6b50(0x1a5)]=0x0,_0x3b58bf[_0x39632b]['type']=_0x5b6b50(0x1e2),_0x3b58bf[_0x39632b]['floorlevel']=_0x1d309b[0x5];}else{if(_0x39632b==_0x114cf4){var _0x10897f;if(_0x1d309b[0x4]=='L')_0x10897f=_0x5b6b50(0x187);else _0x1d309b[0x4]=='F'&&(_0x10897f='Floor');_0x3b58bf[_0x39632b]['storage']=_0x1d309b[0x0],_0x3b58bf[_0x39632b]['rack']=_0x1d309b[0x1],_0x3b58bf[_0x39632b][_0x5b6b50(0x24e)]=_0x1d309b[0x2],_0x3b58bf[_0x39632b][_0x5b6b50(0x1a5)]=_0x1d309b[0x3],_0x3b58bf[_0x39632b][_0x5b6b50(0x1f9)]=_0x10897f,_0x3b58bf[_0x39632b]['floorlevel']=_0x1d309b[0x5];}}}});}),_0x844498[_0x4a29c3(0x227)]((_0x894a80,_0x50fba1)=>{var _0x13d4e1=_0x4a29c3;_0x3b58bf[_0x50fba1][_0x13d4e1(0x237)]=_0x894a80;}),_0x1055b9[_0x4a29c3(0x227)]((_0x15e26d,_0x7888b6)=>{var _0x1b21f2=_0x4a29c3;_0x3b58bf[_0x7888b6][_0x1b21f2(0x1c6)]=_0x15e26d;}),_0x507134[_0x4a29c3(0x227)]((_0x524bc1,_0x27f61d)=>{var _0xc65e3=_0x4a29c3;_0x3b58bf[_0x27f61d][_0xc65e3(0x1b0)]=_0x524bc1;}),_0x4f2b34[_0x4a29c3(0x227)]((_0x339591,_0x3cc8c0)=>{_0x3b58bf[_0x3cc8c0]['new_adjust_qty']=_0x339591;}),_0x20dcd0[_0x4a29c3(0x227)]((_0x4551c2,_0x314758)=>{_0x3b58bf[_0x314758]['unit']=_0x4551c2;}),_0x2f2747[_0x4a29c3(0x227)]((_0x291b58,_0x4a86da)=>{var _0x2cbea1=_0x4a29c3;_0x3b58bf[_0x4a86da][_0x2cbea1(0x183)]=_0x291b58;}),_0xc24709['forEach']((_0x3411c7,_0x4cf14c)=>{var _0x375826=_0x4a29c3;_0x3b58bf[_0x4cf14c][_0x375826(0x1fc)]=_0x3411c7;}),_0x145238['forEach']((_0x7821e1,_0x5c42d0)=>{var _0xe45db4=_0x4a29c3;_0x3b58bf[_0x5c42d0][_0xe45db4(0x1c1)]=_0x7821e1;}),_0x302c04[_0x4a29c3(0x227)]((_0x56b446,_0x2d4f33)=>{var _0x244861=_0x4a29c3;_0x3b58bf[_0x2d4f33][_0x244861(0x1b6)]=_0x56b446;}),_0x2e9766['forEach']((_0x739d77,_0x30eb79)=>{var _0x23a410=_0x4a29c3;_0x3b58bf[_0x30eb79][_0x23a410(0x18d)]=_0x739d77;}),_0x1706f7['forEach']((_0x15b9db,_0x1fda21)=>{var _0x539c10=_0x4a29c3;_0x3b58bf[_0x1fda21][_0x539c10(0x1aa)]=_0x15b9db;}),_0x293d13[_0x4a29c3(0x227)]((_0x4c91ff,_0x310b92)=>{_0x3b58bf[_0x310b92]['prod_cat']=_0x4c91ff;}),_0x2d4fef[_0x4a29c3(0x227)]((_0x499e3e,_0x2e1ac5)=>{var _0x3ff314=_0x4a29c3;_0x3b58bf[_0x2e1ac5][_0x3ff314(0x1da)]=_0x499e3e;}),_0x211a0a[_0x4a29c3(0x227)]((_0x458994,_0x2f1f47)=>{_0x3b58bf[_0x2f1f47]['primary_code']=_0x458994;}),_0x37df9b[_0x4a29c3(0x227)]((_0x260e82,_0x22145a)=>{_0x3b58bf[_0x22145a]['secondary_code']=_0x260e82;});const _0x42d978=_0x3b58bf[_0x4a29c3(0x244)](_0x3b5e91=>_0x3b5e91[_0x4a29c3(0x1b0)]!=='0'&&_0x3b5e91[_0x4a29c3(0x1b0)]!=='');var _0x91483c=0x0;_0x42d978[_0x4a29c3(0x227)](_0x4854ae=>{var _0x4c261c=_0x4a29c3;console['log'](_0x4c261c(0x1e5),_0x4854ae),parseInt(_0x4854ae[_0x4c261c(0x1b0)])<=0x0&&_0x91483c++;});if(_0x91483c!=0x0)return _0x44f405[_0x4a29c3(0x1c4)](_0x4a29c3(0x233),_0x4a29c3(0x197)),_0x35795e[_0x4a29c3(0x243)](_0x4a29c3(0x21e));_0x771f1c[_0x4a29c3(0x1e8)]=_0x2e577f,_0x771f1c[_0x4a29c3(0x20b)]=_0x304386,_0x771f1c['product']=_0x42d978,_0x771f1c[_0x4a29c3(0x1a4)]=_0x2cde66,_0x771f1c['invoice']=_0x3ed715,_0x771f1c['isAllowEdit']=_0x4a29c3(0x1cd);const _0x76d19=await _0x771f1c[_0x4a29c3(0x210)]();_0x44f405[_0x4a29c3(0x1c4)]('success',_0x4a29c3(0x186)),_0x35795e[_0x4a29c3(0x243)]('/adjustment/view');}catch(_0x447dfc){console['log'](_0x447dfc);}}),router[a0_0x8409bd(0x1be)]('/barcode_scanner',async(_0x34557f,_0x42ca72)=>{var _0x1c36ee=a0_0x8409bd;const {primary_code:_0x485c10,warehouse_data:_0x55bc25,rooms_data:_0x1c4b26,Roomslist:_0xde2505}=_0x34557f[_0x1c36ee(0x1dc)],_0x1604a3=_0xde2505[_0x1c36ee(0x21f)](','),_0x49a599=[];async function _0x362e90(_0x1493fa){var _0x3a610e=_0x1c36ee;const _0x2ac801=await warehouse[_0x3a610e(0x1e4)]([{'$match':{'name':_0x55bc25,'room':_0x1493fa}},{'$unwind':_0x3a610e(0x23d)},{'$match':{'product_details.primary_code':_0x485c10}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3a610e(0x220)},'product_stock':{'$first':_0x3a610e(0x1d3)},'primary_code':{'$first':_0x3a610e(0x1a8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3a610e(0x19d)},'level':{'$first':_0x3a610e(0x209)},'isle':{'$first':_0x3a610e(0x1a1)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3a610e(0x1e0)},'unit':{'$first':_0x3a610e(0x194)},'secondary_unit':{'$first':_0x3a610e(0x182)},'storage':{'$first':_0x3a610e(0x190)},'rack':{'$first':_0x3a610e(0x22f)},'expiry_date':{'$first':_0x3a610e(0x1df)},'production_date':{'$first':_0x3a610e(0x1d1)},'maxPerUnit':{'$first':_0x3a610e(0x200)},'batch_code':{'$first':_0x3a610e(0x219)},'product_cat':{'$first':_0x3a610e(0x1b1)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3a610e(0x241)}}}]),_0x3bc854=await warehouse['aggregate']([{'$match':{'name':_0x55bc25,'room':_0x1493fa}},{'$unwind':_0x3a610e(0x23d)},{'$match':{'product_details.secondary_code':_0x485c10}},{'$group':{'_id':_0x3a610e(0x1f2),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3a610e(0x1d3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3a610e(0x1a1)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3a610e(0x182)},'storage':{'$first':_0x3a610e(0x190)},'rack':{'$first':_0x3a610e(0x22f)},'expiry_date':{'$first':_0x3a610e(0x1df)},'production_date':{'$first':_0x3a610e(0x1d1)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x3a610e(0x219)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3a610e(0x241)}}}]);if(_0x2ac801['length']>0x0)_0x49a599['push'](_0x2ac801);else _0x3bc854[_0x3a610e(0x18e)]>0x0&&_0x49a599[_0x3a610e(0x22e)](_0x3bc854);}const _0x27bb65=_0x1604a3[_0x1c36ee(0x24d)](_0x286ba4=>_0x362e90(_0x286ba4));await Promise['all'](_0x27bb65),_0x42ca72[_0x1c36ee(0x21d)](_0x49a599);}),router[a0_0x8409bd(0x1be)](a0_0x8409bd(0x184),async(_0x15f772,_0x119313)=>{var _0x4a568f=a0_0x8409bd;const {primaryCode:_0x50c961,secondaryCode:_0x3aca39,productCode:_0x12808d,level:_0x55987e,isle:_0x342565,pallet:_0x2455f1,warehouses:_0x49db4f,room:_0x5549d0}=_0x15f772[_0x4a568f(0x1dc)];try{const _0x39988b=await warehouse[_0x4a568f(0x1e4)]([{'$match':{'name':_0x49db4f,'room':_0x5549d0}},{'$unwind':_0x4a568f(0x23d)},{'$match':{'product_details.level':parseInt(_0x55987e),'product_details.isle':_0x342565,'product_details.pallet':parseInt(_0x2455f1)}},{'$group':{'_id':_0x4a568f(0x1f2),'name':{'$first':_0x4a568f(0x220)},'product_stock':{'$first':_0x4a568f(0x1d3)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x4a568f(0x216)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x119313['status'](0xc8)[_0x4a568f(0x21d)](_0x39988b);}catch(_0x5dbc4f){_0x119313[_0x4a568f(0x1a7)](0x194)[_0x4a568f(0x21d)]({'message':_0x5dbc4f['message']});}}),module['exports']=router;