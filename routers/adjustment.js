var a0_0x4d3202=a0_0x116b;(function(_0x100dfc,_0x1207e7){var _0x532a7a=a0_0x116b,_0xc0dbd6=_0x100dfc();while(!![]){try{var _0x3b183d=parseInt(_0x532a7a(0x289))/0x1*(-parseInt(_0x532a7a(0x25a))/0x2)+parseInt(_0x532a7a(0x235))/0x3+parseInt(_0x532a7a(0x239))/0x4+-parseInt(_0x532a7a(0x24d))/0x5+-parseInt(_0x532a7a(0x207))/0x6+parseInt(_0x532a7a(0x27e))/0x7*(parseInt(_0x532a7a(0x242))/0x8)+-parseInt(_0x532a7a(0x281))/0x9*(-parseInt(_0x532a7a(0x1d0))/0xa);if(_0x3b183d===_0x1207e7)break;else _0xc0dbd6['push'](_0xc0dbd6['shift']());}catch(_0x488048){_0xc0dbd6['push'](_0xc0dbd6['shift']());}}}(a0_0x2142,0x389ac));function a0_0x2142(){var _0x25a9d0=['maxperunit','maxPerUnit','</td>','$product_details.rack','Rooms','product_name','toString','/CheckingWarehouse','secondary_unit','new_adjust_qty','4053lfNMPv','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','\x20<>\x20','product_stock','648020JTFMFv','<span\x20style=\x22float:\x20right;\x22>','adjust_qty','host','RMSEmail','room_names','$product_details','isAllowEdit','Receiving\x20Area','101944zlfUHT','product_details','$product_details.invoice','storage','$warehouse_name','Shelves','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','product','Raw\x20Materials','Level','message','1530485zeexWa','date','Portuguese','Return\x20Goods','<h2>\x20','slice','user','Error\x20Occurs','find','catch','back','/adjustment/view','<html><head><title></title>','194918XtMgaP','../public/language/languages.json','warehouse_name','$product_details.bin','$product_details.production_date','logo','minus','New_Qty_Converted','nodemailer','rack','findById','English','True','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','prod_name','</div>','/adjustment/preview/','id_transaction','\x20Order\x20Date\x20:\x20','string','$product_details.storage','Hindi','bay','adjustment\x20Finalized\x20successfully','$product_details.secondary_unit','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','json','$product_details.product_code','$room','max_per_unit','success','$product_details.batch_code','$product_details.expiry_date','floorlevel','Portuguese\x20(BR)','7rVJMPQ','createTransport','$product_details.maxPerUnit','9002403mRhpuo','$product_details.product_stock','stockBefore','foreach\x20newproduct','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','forEach','$product_details.pallet','</span>','3JlMhXt','prod_code','<!DOCTYPE\x20html>','</tr>','prime1','save','map','/../public','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.type','An\x20error\x20occurred\x20while\x20saving\x20data.','all','production_date','filter','Secondary_units','</h5>','Router','note','id_transaction_from','warehouse','second1','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','error','/view/:id','params','$product','$product_details.level','image','port','push','Enclosed','redirect','Arabic','$product.room_names','add_adjustment','10fhoxzJ','types','Ambient','render','level','prod_cat','$product_details.secondary_code','../models/all_models','New_Qty_Converted_adj','findOne','type','Floor','random','\x20Order\x20Number\x20:\x20','$product_details._id','/view','$product.product_name','French','/picking_list/PDF_adjustment_rm/','invoice','floor','<hr\x20class=\x22my-3\x22>','flash','role','errors','Enabled','status','$product_details.maxProducts','</thead>','$product_details.bay','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<h5>','express','secondary_code','</head><body>','English\x20(US)','</tbody>','ADJ-','unit','stock','master','site_title','$name','get','<div>','staff','email','primary_code','Logo.png','exports','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','batch_code','<table\x20style=\x22width:\x20100%\x20!important;\x22>','log','2076240ZrHGct','edit_adjustment','expiry_date','length','<tr>','password','Adjustment\x20Mail','$finalize','Arabic\x20(ae)','Chinese','adjustment\x20data\x20update\x20successfully','product_code','bin','/view/add_adjustment','body','False','post','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$date','$product_details.unit','then','Spanish','Return\x20Rooms','<tbody\x20style=\x22text-align:\x20center;\x22>','aggregate','$_id','</body></html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.product_cat','$product_details.product_name','split','prod_invoice','Email\x20sent\x20successfully','/barcode_scanner','German','_id'];a0_0x2142=function(){return _0x25a9d0;};return a0_0x2142();}const express=require(a0_0x4d3202(0x1f1)),app=express(),router=express[a0_0x4d3202(0x1bd)](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x4d3202(0x1d7)),users=require(a0_0x4d3202(0x25b)),nodemailer=require(a0_0x4d3202(0x262));function a0_0x116b(_0x48f122,_0xa1b8aa){var _0x214259=a0_0x2142();return a0_0x116b=function(_0x116b5b,_0x131a82){_0x116b5b=_0x116b5b-0x1b6;var _0x1f05ae=_0x214259[_0x116b5b];return _0x1f05ae;},a0_0x116b(_0x48f122,_0xa1b8aa);}router[a0_0x4d3202(0x1fc)](a0_0x4d3202(0x1df),auth,async(_0x645f8f,_0x21ea40)=>{var _0x5c598a=a0_0x4d3202;try{const {username:_0x25ad77,email:_0x1c5f84,role:_0x1bbf6d}=_0x645f8f[_0x5c598a(0x253)],_0x20f195=_0x645f8f[_0x5c598a(0x253)],_0x2a1b46=await profile[_0x5c598a(0x1d9)]({'email':_0x20f195[_0x5c598a(0x1ff)]}),_0x56c706=await master_shop[_0x5c598a(0x255)]();console[_0x5c598a(0x206)](_0x5c598a(0x1f9),_0x56c706);let _0x1c728d;if(_0x20f195[_0x5c598a(0x1e7)]==_0x5c598a(0x1fe)){const _0x13e493=await staff[_0x5c598a(0x1d9)]({'email':_0x20f195[_0x5c598a(0x1ff)]});_0x1c728d=await warehouse[_0x5c598a(0x255)]({'status':_0x5c598a(0x1e9),'name':_0x13e493[_0x5c598a(0x1c0)]});}else _0x1c728d=await warehouse['find']({'status':'Enabled'});const _0x1b3e52=await product[_0x5c598a(0x255)]();let _0x18a4f9;if(_0x20f195[_0x5c598a(0x1e7)]==_0x5c598a(0x1fe)){const _0xef0c8b=await staff['findOne']({'email':_0x20f195[_0x5c598a(0x1ff)]});_0x18a4f9=await adjustment['find']({'warehouse_name':_0xef0c8b[_0x5c598a(0x1c0)]});}else _0x18a4f9=await adjustment[_0x5c598a(0x21f)]([{'$unwind':_0x5c598a(0x1c6)},{'$group':{'_id':_0x5c598a(0x220),'invoice':{'$first':'$invoice'},'date':{'$first':_0x5c598a(0x219)},'warehouse_name':{'$first':_0x5c598a(0x246)},'room':{'$addToSet':_0x5c598a(0x1ce)},'finalize':{'$first':_0x5c598a(0x20e)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x56c706[0x0][_0x5c598a(0x291)]==_0x5c598a(0x1f4)){var _0x512bf5=users[_0x5c598a(0x265)];console[_0x5c598a(0x206)](_0x512bf5);}else{if(_0x56c706[0x0][_0x5c598a(0x291)]==_0x5c598a(0x26f))var _0x512bf5=users['Hindi'];else{if(_0x56c706[0x0][_0x5c598a(0x291)]=='German')var _0x512bf5=users[_0x5c598a(0x229)];else{if(_0x56c706[0x0][_0x5c598a(0x291)]==_0x5c598a(0x21c))var _0x512bf5=users[_0x5c598a(0x21c)];else{if(_0x56c706[0x0]['language']==_0x5c598a(0x1e1))var _0x512bf5=users['French'];else{if(_0x56c706[0x0]['language']=='Portuguese\x20(BR)')var _0x512bf5=users['Portuguese'];else{if(_0x56c706[0x0][_0x5c598a(0x291)]==_0x5c598a(0x210))var _0x512bf5=users['Chinese'];else{if(_0x56c706[0x0]['language']==_0x5c598a(0x20f))var _0x512bf5=users['Arabic'];}}}}}}}_0x21ea40['render']('adjustment',{'success':_0x645f8f['flash'](_0x5c598a(0x279)),'errors':_0x645f8f[_0x5c598a(0x1e6)]('errors'),'role':_0x20f195,'profile':_0x2a1b46,'warehouse':_0x1c728d,'product':_0x1b3e52,'adjustment':_0x18a4f9,'master_shop':_0x56c706,'language':_0x512bf5});}catch(_0x16b203){console[_0x5c598a(0x206)](_0x16b203);}});async function getRandom8DigitNumber(){var _0x400792=a0_0x4d3202;const _0x5ca842=0x989680,_0x49d8a2=0x5f5e0ff,_0x2dbb5b=Math[_0x400792(0x1e4)](Math[_0x400792(0x1dc)]()*(_0x49d8a2-_0x5ca842+0x1))+_0x5ca842;var _0xfb1a12;const _0x4e1da0=await adjustment[_0x400792(0x1d9)]({'invoice':_0x400792(0x1f6)+_0x2dbb5b});return _0x4e1da0&&_0x4e1da0[_0x400792(0x20a)]>0x0?_0xfb1a12=_0x400792(0x1f6)+_0x2dbb5b:_0xfb1a12='ADJ-'+_0x2dbb5b,_0xfb1a12;}router[a0_0x4d3202(0x1fc)]('/view/add_adjustment',auth,async(_0x663286,_0x265f9b)=>{var _0x44e2a7=a0_0x4d3202;try{const {username:_0x166cc5,email:_0x272165,role:_0x390d08}=_0x663286[_0x44e2a7(0x253)],_0x467f6d=_0x663286['user'],_0x130f06=await profile['findOne']({'email':_0x467f6d[_0x44e2a7(0x1ff)]}),_0x33f86a=await master_shop[_0x44e2a7(0x255)]();let _0x45a09f;if(_0x467f6d['role']==_0x44e2a7(0x1fe)){const _0x1cce4b=await staff[_0x44e2a7(0x1d9)]({'email':_0x467f6d['email']});_0x45a09f=await warehouse['aggregate']([{'$match':{'status':_0x44e2a7(0x1e9),'name':_0x1cce4b[_0x44e2a7(0x1c0)],'warehouse_category':_0x44e2a7(0x24a),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x44e2a7(0x1fb),'name':{'$first':_0x44e2a7(0x1fb)}}}]);}else _0x45a09f=await warehouse[_0x44e2a7(0x21f)]([{'$match':{'status':_0x44e2a7(0x1e9),'warehouse_category':_0x44e2a7(0x24a),'name':{'$ne':_0x44e2a7(0x250)}}},{'$group':{'_id':_0x44e2a7(0x1fb),'name':{'$first':_0x44e2a7(0x1fb)}}}]);const _0x29a8c0=await product['find']({}),_0x92416d=await adjustment[_0x44e2a7(0x255)]({}),_0x591208=_0x92416d[_0x44e2a7(0x20a)]+0x1,_0x364423='ADJ-'+_0x591208[_0x44e2a7(0x231)]()['padStart'](0x5,'0');var _0x4cacd6=[_0x44e2a7(0x1d2),_0x44e2a7(0x1cb),_0x44e2a7(0x21d)];if(_0x33f86a[0x0][_0x44e2a7(0x291)]==_0x44e2a7(0x1f4))var _0x51eecd=users[_0x44e2a7(0x265)];else{if(_0x33f86a[0x0][_0x44e2a7(0x291)]==_0x44e2a7(0x26f))var _0x51eecd=users[_0x44e2a7(0x26f)];else{if(_0x33f86a[0x0]['language']=='German')var _0x51eecd=users[_0x44e2a7(0x229)];else{if(_0x33f86a[0x0][_0x44e2a7(0x291)]==_0x44e2a7(0x21c))var _0x51eecd=users['Spanish'];else{if(_0x33f86a[0x0][_0x44e2a7(0x291)]=='French')var _0x51eecd=users[_0x44e2a7(0x1e1)];else{if(_0x33f86a[0x0][_0x44e2a7(0x291)]==_0x44e2a7(0x27d))var _0x51eecd=users['Portuguese'];else{if(_0x33f86a[0x0][_0x44e2a7(0x291)]==_0x44e2a7(0x210))var _0x51eecd=users[_0x44e2a7(0x210)];else{if(_0x33f86a[0x0][_0x44e2a7(0x291)]==_0x44e2a7(0x20f))var _0x51eecd=users[_0x44e2a7(0x1cd)];}}}}}}}const _0xaa32a7=getRandom8DigitNumber();_0xaa32a7[_0x44e2a7(0x21b)](_0x316467=>{var _0x269255=_0x44e2a7;_0x265f9b[_0x269255(0x1d3)](_0x269255(0x1cf),{'success':_0x663286[_0x269255(0x1e6)](_0x269255(0x279)),'errors':_0x663286['flash']('errors'),'role':_0x467f6d,'profile':_0x130f06,'warehouse':_0x45a09f,'product':_0x29a8c0,'master_shop':_0x33f86a,'language':_0x51eecd,'rooms_data':_0x4cacd6,'invoice_no':_0x316467});})[_0x44e2a7(0x256)](_0x1ee159=>{var _0x14bee9=_0x44e2a7;_0x663286['flash']('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x265f9b[_0x14bee9(0x1cc)]('/adjustment/view');});}catch(_0x3386d8){console[_0x44e2a7(0x206)](_0x3386d8);}}),router[a0_0x4d3202(0x217)](a0_0x4d3202(0x214),auth,async(_0x4d6bff,_0x7833b1)=>{var _0x4b1bbc=a0_0x4d3202;try{const {warehouse_name:_0x42b776,date:_0x4f5c6f,prod_name:_0x51be1c,level:_0x9ed56d,isle:_0x40ea25,pallet:_0xa6ac09,stock:_0x93b1d9,types:_0x1790e4,adjust_qty:_0x3f8520,new_adjust_qty:_0x5dd189,note:_0x27e900,Room_name:_0x1329f1,invoice:_0x52f87d,JO_number:_0x21de26,expiry_date:_0xd4f4f0}=_0x4d6bff[_0x4b1bbc(0x215)];if(typeof _0x51be1c==_0x4b1bbc(0x26d))var _0x15221c=[_0x4d6bff['body']['prod_name']],_0xacb463=[_0x4d6bff[_0x4b1bbc(0x215)]['level']],_0x123718=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1f8)]],_0x184d42=[_0x4d6bff['body']['types']],_0x450808=[_0x4d6bff[_0x4b1bbc(0x215)]['New_Qty_Converted_adj']],_0x46b0bf=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x261)]],_0x301676=[_0x4d6bff[_0x4b1bbc(0x215)]['Primary_Units']],_0x37972f=[_0x4d6bff[_0x4b1bbc(0x215)]['Secondary_units']],_0x3891b0=[_0x4d6bff['body'][_0x4b1bbc(0x28a)]],_0x5296a8=[_0x4d6bff['body'][_0x4b1bbc(0x204)]],_0x2002d9=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x209)]],_0x3c2d84=[_0x4d6bff['body'][_0x4b1bbc(0x278)]],_0x510e32=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1b9)]],_0x316f0b=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1d5)]],_0x10a5f0=[_0x4d6bff['body'][_0x4b1bbc(0x22f)]],_0x259336=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x28d)]],_0x2f9d8c=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1c1)]],_0x2a50cc=[_0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x226)]],_0x220f17=[_0x4d6bff[_0x4b1bbc(0x215)]['id_transaction']];else var _0x15221c=[..._0x4d6bff[_0x4b1bbc(0x215)]['prod_name']],_0xacb463=[..._0x4d6bff['body']['level']],_0x123718=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1f8)]],_0x184d42=[..._0x4d6bff[_0x4b1bbc(0x215)]['types']],_0x450808=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1d8)]],_0x46b0bf=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x261)]],_0x301676=[..._0x4d6bff[_0x4b1bbc(0x215)]['unit']],_0x37972f=[..._0x4d6bff[_0x4b1bbc(0x215)]['Secondary_units']],_0x3891b0=[..._0x4d6bff['body']['prod_code']],_0x5296a8=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x204)]],_0x2002d9=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x209)]],_0x3c2d84=[..._0x4d6bff['body'][_0x4b1bbc(0x278)]],_0x510e32=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1b9)]],_0x316f0b=[..._0x4d6bff[_0x4b1bbc(0x215)]['prod_cat']],_0x10a5f0=[..._0x4d6bff['body']['Rooms']],_0x259336=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x28d)]],_0x2f9d8c=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x1c1)]],_0x2a50cc=[..._0x4d6bff[_0x4b1bbc(0x215)][_0x4b1bbc(0x226)]],_0x220f17=[..._0x4d6bff['body'][_0x4b1bbc(0x26b)]];const _0x105e2e=_0x15221c[_0x4b1bbc(0x28f)](_0x5e0a35=>{return _0x5e0a35={'product_name':_0x5e0a35};});_0xacb463['forEach']((_0x105000,_0x389d7d)=>{var _0x16c86c=_0x4b1bbc;_0x10a5f0[_0x16c86c(0x286)]((_0x3352e6,_0x14f12e)=>{var _0x37135e=_0x16c86c;if(_0x3352e6==_0x37135e(0x241)&&_0x389d7d==_0x14f12e){var _0x1a7b36=_0x105000[_0x37135e(0x252)](0x3);_0x105e2e[_0x389d7d]['storage']=_0x105000[0x0],_0x105e2e[_0x389d7d]['rack']=_0x105000[0x1],_0x105e2e[_0x389d7d][_0x37135e(0x270)]=0x0,_0x105e2e[_0x389d7d][_0x37135e(0x213)]=0x0,_0x105e2e[_0x389d7d]['type']=_0x37135e(0x1db),_0x105e2e[_0x389d7d]['floorlevel']=_0x1a7b36;}else{if(_0x3352e6=='Shelves'&&_0x389d7d==_0x14f12e){var _0x1a7b36=_0x105000[_0x37135e(0x252)](0x3);_0x105e2e[_0x389d7d][_0x37135e(0x245)]=_0x105000[0x0],_0x105e2e[_0x389d7d]['rack']=_0x105000[0x1],_0x105e2e[_0x389d7d]['bay']=0x0,_0x105e2e[_0x389d7d][_0x37135e(0x213)]=0x0,_0x105e2e[_0x389d7d]['type']=_0x37135e(0x1db),_0x105e2e[_0x389d7d]['floorlevel']=_0x105000[0x5];}else{if(_0x389d7d==_0x14f12e){var _0x223a8c;if(_0x105000[0x4]=='L')_0x223a8c=_0x37135e(0x24b);else _0x105000[0x4]=='F'&&(_0x223a8c=_0x37135e(0x1db));_0x105e2e[_0x389d7d]['storage']=_0x105000[0x0],_0x105e2e[_0x389d7d]['rack']=_0x105000[0x1],_0x105e2e[_0x389d7d][_0x37135e(0x270)]=_0x105000[0x2],_0x105e2e[_0x389d7d][_0x37135e(0x213)]=_0x105000[0x3],_0x105e2e[_0x389d7d]['type']=_0x223a8c,_0x105e2e[_0x389d7d][_0x37135e(0x27c)]=_0x105000[0x5];}}}});}),_0x123718[_0x4b1bbc(0x286)]((_0x3b5905,_0x39d65a)=>{var _0x4d4479=_0x4b1bbc;_0x105e2e[_0x39d65a][_0x4d4479(0x283)]=_0x3b5905;}),_0x220f17['forEach']((_0x4b5f72,_0x37239a)=>{_0x105e2e[_0x37239a]['id_transaction_from']=_0x4b5f72;}),_0x184d42['forEach']((_0x2b8a1f,_0x36d3a3)=>{var _0x58ffe9=_0x4b1bbc;_0x105e2e[_0x36d3a3][_0x58ffe9(0x1d1)]=_0x2b8a1f;}),_0x450808[_0x4b1bbc(0x286)]((_0x4aa381,_0x24d376)=>{var _0x646275=_0x4b1bbc;_0x105e2e[_0x24d376][_0x646275(0x23b)]=_0x4aa381;}),_0x46b0bf[_0x4b1bbc(0x286)]((_0x5caf6f,_0x49ab12)=>{var _0x21c1a7=_0x4b1bbc;_0x105e2e[_0x49ab12][_0x21c1a7(0x234)]=_0x5caf6f;}),_0x301676[_0x4b1bbc(0x286)]((_0x42193a,_0xb4103d)=>{var _0x1b1794=_0x4b1bbc;_0x105e2e[_0xb4103d][_0x1b1794(0x1f7)]=_0x42193a;}),_0x37972f['forEach']((_0x1c763a,_0x5bc532)=>{var _0x397085=_0x4b1bbc;_0x105e2e[_0x5bc532][_0x397085(0x233)]=_0x1c763a;}),_0x3891b0[_0x4b1bbc(0x286)]((_0xa81482,_0x344a0c)=>{_0x105e2e[_0x344a0c]['product_code']=_0xa81482;}),_0x5296a8['forEach']((_0x13b49e,_0x6bf055)=>{var _0xd69ad6=_0x4b1bbc;_0x105e2e[_0x6bf055][_0xd69ad6(0x204)]=_0x13b49e;}),_0x2002d9['forEach']((_0x510922,_0x26c46a)=>{var _0x204bd2=_0x4b1bbc;_0x105e2e[_0x26c46a][_0x204bd2(0x209)]=_0x510922;}),_0x3c2d84[_0x4b1bbc(0x286)]((_0x49192f,_0x4f414d)=>{var _0x8751b6=_0x4b1bbc;_0x105e2e[_0x4f414d][_0x8751b6(0x22b)]=_0x49192f;}),_0x510e32['forEach']((_0x38e74b,_0x3451f2)=>{_0x105e2e[_0x3451f2]['production_date']=_0x38e74b;}),_0x316f0b['forEach']((_0x585814,_0x569421)=>{var _0x503dc6=_0x4b1bbc;_0x105e2e[_0x569421][_0x503dc6(0x1d5)]=_0x585814;}),_0x10a5f0[_0x4b1bbc(0x286)]((_0x3f16e7,_0x2ae3d8)=>{var _0xd97539=_0x4b1bbc;_0x105e2e[_0x2ae3d8][_0xd97539(0x23e)]=_0x3f16e7;}),_0x259336[_0x4b1bbc(0x286)]((_0x44df2a,_0x2d9204)=>{_0x105e2e[_0x2d9204]['primary_code']=_0x44df2a;}),_0x2f9d8c[_0x4b1bbc(0x286)]((_0x37feff,_0x4a55a2)=>{var _0x617839=_0x4b1bbc;_0x105e2e[_0x4a55a2][_0x617839(0x1f2)]=_0x37feff;}),_0x2a50cc[_0x4b1bbc(0x286)]((_0x28892b,_0xcbd180)=>{var _0xf9dadb=_0x4b1bbc;_0x105e2e[_0xcbd180][_0xf9dadb(0x1e3)]=_0x28892b;});const _0x14e246=_0x105e2e[_0x4b1bbc(0x1ba)](_0x59c531=>_0x59c531[_0x4b1bbc(0x23b)]!=='0'&&_0x59c531['adjust_qty']!=='');var _0x4f8d20=0x0;_0x14e246['forEach'](_0xea8177=>{console['log']('foreach\x20newproduct',_0xea8177),parseInt(_0xea8177['adjust_qty'])<=0x0&&_0x4f8d20++;});if(_0x4f8d20!=0x0)return _0x4d6bff[_0x4b1bbc(0x1e6)]('errors',_0x4b1bbc(0x1c2)),_0x7833b1[_0x4b1bbc(0x1cc)](_0x4b1bbc(0x257));const _0x484afe=new adjustment({'warehouse_name':_0x42b776,'date':_0x4f5c6f,'product':_0x14e246,'note':_0x27e900,'room':_0x1329f1,'invoice':_0x52f87d,'JO_number':_0x21de26,'expiry_date':_0xd4f4f0}),_0x2046fd=await _0x484afe[_0x4b1bbc(0x28e)]();_0x4d6bff['flash'](_0x4b1bbc(0x279),'adjustment\x20add\x20successfull'),_0x7833b1[_0x4b1bbc(0x1cc)](_0x4b1bbc(0x26a)+_0x2046fd[_0x4b1bbc(0x22a)]);}catch(_0x34748f){console['log'](_0x34748f),_0x7833b1[_0x4b1bbc(0x1ea)](0xc8)[_0x4b1bbc(0x275)]({'message':_0x34748f[_0x4b1bbc(0x24c)]});}}),router['get']('/preview/:id',auth,async(_0x5d2d19,_0x2a6ca5)=>{var _0x5e9f66=a0_0x4d3202;try{const {username:_0x53cff4,email:_0x25ee3c,role:_0x19a1c0}=_0x5d2d19[_0x5e9f66(0x253)],_0x60ac4b=_0x5d2d19[_0x5e9f66(0x253)],_0x2b111d=await profile[_0x5e9f66(0x1d9)]({'email':_0x60ac4b[_0x5e9f66(0x1ff)]}),_0x64b0a0=await master_shop[_0x5e9f66(0x255)](),_0x1f01a4=_0x5d2d19['params']['id'],_0x100c31=await adjustment['findById']({'_id':_0x1f01a4}),_0x19fefb=await purchases['aggregate']([{'$match':{'warehouse_name':_0x100c31[_0x5e9f66(0x25c)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5e9f66(0x1e0)}}]),_0x28173f=await product[_0x5e9f66(0x255)]({}),_0x54728a=await warehouse['aggregate']([{'$match':{'name':_0x100c31[_0x5e9f66(0x25c)]}},{'$unwind':_0x5e9f66(0x23f)},{'$group':{'_id':_0x5e9f66(0x1de),'name':{'$first':_0x5e9f66(0x224)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5e9f66(0x1ed)},'bin':{'$first':_0x5e9f66(0x25d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5e9f66(0x1ee)},'primary_code':{'$first':_0x5e9f66(0x273)},'secondary_code':{'$first':_0x5e9f66(0x1d6)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5e9f66(0x26e)},'rack':{'$first':_0x5e9f66(0x22e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5e9f66(0x25e)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x5e9f66(0x277)}}}]);if(_0x64b0a0[0x0]['language']==_0x5e9f66(0x1f4)){var _0x27efdb=users[_0x5e9f66(0x265)];console['log'](_0x27efdb);}else{if(_0x64b0a0[0x0]['language']=='Hindi')var _0x27efdb=users[_0x5e9f66(0x26f)];else{if(_0x64b0a0[0x0][_0x5e9f66(0x291)]==_0x5e9f66(0x229))var _0x27efdb=users[_0x5e9f66(0x229)];else{if(_0x64b0a0[0x0]['language']==_0x5e9f66(0x21c))var _0x27efdb=users[_0x5e9f66(0x21c)];else{if(_0x64b0a0[0x0][_0x5e9f66(0x291)]==_0x5e9f66(0x1e1))var _0x27efdb=users['French'];else{if(_0x64b0a0[0x0][_0x5e9f66(0x291)]==_0x5e9f66(0x27d))var _0x27efdb=users['Portuguese'];else{if(_0x64b0a0[0x0][_0x5e9f66(0x291)]=='Chinese')var _0x27efdb=users[_0x5e9f66(0x210)];else{if(_0x64b0a0[0x0]['language']==_0x5e9f66(0x20f))var _0x27efdb=users[_0x5e9f66(0x1cd)];}}}}}}}_0x2a6ca5[_0x5e9f66(0x1d3)]('edit_adjustment_view',{'success':_0x5d2d19['flash'](_0x5e9f66(0x279)),'errors':_0x5d2d19[_0x5e9f66(0x1e6)](_0x5e9f66(0x1e8)),'role':_0x60ac4b,'profile':_0x2b111d,'adjustment':_0x100c31,'stock':_0x54728a,'master_shop':_0x64b0a0,'warehouse_name':_0x19fefb,'unit':_0x28173f,'language':_0x27efdb});}catch(_0x554a38){console['log'](_0x554a38),_0x2a6ca5[_0x5e9f66(0x1ea)](0xc8)[_0x5e9f66(0x275)]({'message':_0x554a38['message']});}}),router[a0_0x4d3202(0x217)]('/preview/:id',auth,async(_0x5e421e,_0x1c2735)=>{var _0x1d3e30=a0_0x4d3202;try{const _0x469b3e=_0x5e421e[_0x1d3e30(0x1c5)]['id'],{warehouse_name:_0x16d1dd,Room_name:_0x2b9906}=_0x5e421e[_0x1d3e30(0x215)],_0x222bd5=await adjustment[_0x1d3e30(0x264)]({'_id':_0x469b3e}),_0x1c1998=_0x222bd5[_0x1d3e30(0x249)][_0x1d3e30(0x28f)](async _0x52c6f0=>{var _0xa7e341=_0x1d3e30;if(_0x52c6f0[_0xa7e341(0x23b)]>0x0){var _0x2d1adf=await warehouse['findOne']({'name':_0x16d1dd,'room':_0x52c6f0['room_names'],'warehouse_category':_0xa7e341(0x24a)});const _0xbb4cbd=_0x2d1adf[_0xa7e341(0x243)][_0xa7e341(0x28f)](_0x3964a4=>{var _0x1c0a47=_0xa7e341;if(_0x52c6f0[_0x1c0a47(0x1da)]==_0x1c0a47(0x260)){if(_0x3964a4[_0x1c0a47(0x230)]==_0x52c6f0[_0x1c0a47(0x230)]&&_0x3964a4[_0x1c0a47(0x27c)]==_0x52c6f0['floorlevel']&&_0x3964a4[_0x1c0a47(0x1da)]==_0x52c6f0[_0x1c0a47(0x1da)]&&_0x3964a4[_0x1c0a47(0x213)]==_0x52c6f0[_0x1c0a47(0x213)]&&_0x3964a4[_0x1c0a47(0x270)]==_0x52c6f0[_0x1c0a47(0x270)]&&_0x3964a4[_0x1c0a47(0x263)]==_0x52c6f0[_0x1c0a47(0x263)]&&_0x3964a4['storage']==_0x52c6f0[_0x1c0a47(0x245)]&&_0x3964a4[_0x1c0a47(0x209)]==_0x52c6f0['expiry_date']&&_0x3964a4['batch_code']==_0x52c6f0[_0x1c0a47(0x204)]&&_0x3964a4[_0x1c0a47(0x1b9)]==_0x52c6f0[_0x1c0a47(0x1b9)]&&_0x3964a4[_0x1c0a47(0x1e3)]==_0x52c6f0[_0x1c0a47(0x1e3)]&&_0x3964a4[_0x1c0a47(0x22a)]==_0x52c6f0[_0x1c0a47(0x1bf)]){var _0x49e0de;_0x49e0de=_0x52c6f0[_0x1c0a47(0x23b)],_0x52c6f0[_0x1c0a47(0x1d5)]=='S'&&(_0x49e0de=_0x52c6f0[_0x1c0a47(0x23b)]),_0x3964a4[_0x1c0a47(0x238)]=_0x3964a4[_0x1c0a47(0x238)]-_0x49e0de;}}else{if(_0x3964a4[_0x1c0a47(0x230)]==_0x52c6f0[_0x1c0a47(0x230)]&&_0x3964a4[_0x1c0a47(0x27c)]==_0x52c6f0[_0x1c0a47(0x27c)]&&_0x3964a4[_0x1c0a47(0x1da)]==_0x52c6f0[_0x1c0a47(0x1da)]&&_0x3964a4[_0x1c0a47(0x213)]==_0x52c6f0[_0x1c0a47(0x213)]&&_0x3964a4[_0x1c0a47(0x270)]==_0x52c6f0[_0x1c0a47(0x270)]&&_0x3964a4[_0x1c0a47(0x263)]==_0x52c6f0[_0x1c0a47(0x263)]&&_0x3964a4[_0x1c0a47(0x245)]==_0x52c6f0[_0x1c0a47(0x245)]&&_0x3964a4[_0x1c0a47(0x209)]==_0x52c6f0['expiry_date']&&_0x3964a4[_0x1c0a47(0x204)]==_0x52c6f0[_0x1c0a47(0x204)]&&_0x3964a4['production_date']==_0x52c6f0[_0x1c0a47(0x1b9)]&&_0x3964a4[_0x1c0a47(0x1e3)]==_0x52c6f0[_0x1c0a47(0x1e3)]&&_0x3964a4[_0x1c0a47(0x22a)]==_0x52c6f0[_0x1c0a47(0x1bf)]){console['log'](_0x52c6f0);var _0x49e0de;_0x49e0de=_0x52c6f0[_0x1c0a47(0x23b)],_0x52c6f0[_0x1c0a47(0x1d5)]=='S'&&(_0x49e0de=_0x52c6f0[_0x1c0a47(0x23b)]),console[_0x1c0a47(0x206)](_0x49e0de+_0x1c0a47(0x237)+_0x52c6f0[_0x1c0a47(0x23b)]+_0x1c0a47(0x237)+_0x3964a4[_0x1c0a47(0x22c)]+_0x1c0a47(0x237)+_0x52c6f0['prod_cat']),_0x3964a4['product_stock']=_0x3964a4[_0x1c0a47(0x238)]+_0x49e0de;}}});}return _0x2d1adf;});Promise[_0x1d3e30(0x1b8)](_0x1c1998)[_0x1d3e30(0x21b)](async _0x50e7ea=>{var _0x1d70c2=_0x1d3e30;try{for(const _0x4cd3ae of _0x50e7ea){await _0x4cd3ae[_0x1d70c2(0x28e)]();}_0x222bd5['finalize']=_0x1d70c2(0x266);const _0x1d5878=await _0x222bd5[_0x1d70c2(0x28e)](),_0x1a9fd7=await master_shop[_0x1d70c2(0x255)](),_0x41e21b=await email_settings[_0x1d70c2(0x1d9)](),_0x52f14d=await supervisor_settings[_0x1d70c2(0x255)]();var _0x221150=_0x222bd5[_0x1d70c2(0x249)],_0xedc745='',_0x2a183a;for(_0x2a183a in _0x221150){_0xedc745+=_0x1d70c2(0x20b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x221150[_0x2a183a]['product_name']+_0x1d70c2(0x22d)+_0x1d70c2(0x267)+_0x221150[_0x2a183a][_0x1d70c2(0x212)]+_0x1d70c2(0x22d)+_0x1d70c2(0x267)+_0x221150[_0x2a183a][_0x1d70c2(0x23b)]+_0x1d70c2(0x22d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x221150[_0x2a183a][_0x1d70c2(0x1f7)]+_0x1d70c2(0x22d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x221150[_0x2a183a]['secondary_unit']+_0x1d70c2(0x22d)+_0x1d70c2(0x267)+_0x222bd5['warehouse_name']+_0x1d70c2(0x22d)+_0x1d70c2(0x267)+_0x221150[_0x2a183a]['room_names']+'</td>'+_0x1d70c2(0x267)+_0x221150[_0x2a183a]['storage']+_0x221150[_0x2a183a][_0x1d70c2(0x263)]+_0x221150[_0x2a183a][_0x1d70c2(0x270)]+_0x221150[_0x2a183a]['bin']+_0x221150[_0x2a183a][_0x1d70c2(0x1da)][0x0]+_0x221150[_0x2a183a][_0x1d70c2(0x27c)]+_0x1d70c2(0x22d),_0x1d70c2(0x28c);}let _0x15c09e=nodemailer[_0x1d70c2(0x27f)]({'host':_0x41e21b[_0x1d70c2(0x23c)],'port':Number(_0x41e21b[_0x1d70c2(0x1c9)]),'secure':![],'auth':{'user':_0x41e21b[_0x1d70c2(0x1ff)],'pass':_0x41e21b[_0x1d70c2(0x20c)]}}),_0x418ac9={'from':_0x41e21b[_0x1d70c2(0x1ff)],'to':_0x52f14d[0x0][_0x1d70c2(0x23d)],'subject':_0x1d70c2(0x20d),'attachments':[{'filename':_0x1d70c2(0x201),'path':__dirname+_0x1d70c2(0x290)+'/upload/'+_0x1a9fd7[0x0][_0x1d70c2(0x1c8)],'cid':_0x1d70c2(0x25f)}],'html':_0x1d70c2(0x28b)+_0x1d70c2(0x259)+_0x1d70c2(0x1f3)+_0x1d70c2(0x1fd)+_0x1d70c2(0x218)+_0x1d70c2(0x1fd)+_0x1d70c2(0x203)+_0x1d70c2(0x269)+_0x1d70c2(0x1fd)+_0x1d70c2(0x251)+_0x1a9fd7[0x0]['site_title']+'\x20</h2>'+_0x1d70c2(0x269)+_0x1d70c2(0x269)+_0x1d70c2(0x1e5)+_0x1d70c2(0x1fd)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x1d70c2(0x1dd)+_0x222bd5['invoice']+'\x20'+_0x1d70c2(0x23a)+_0x1d70c2(0x26c)+_0x222bd5[_0x1d70c2(0x24e)]+'\x20'+_0x1d70c2(0x288)+'</h5>'+_0x1d70c2(0x269)+_0x1d70c2(0x205)+_0x1d70c2(0x236)+'<tr>'+_0x1d70c2(0x285)+_0x1d70c2(0x222)+_0x1d70c2(0x1ef)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x1d70c2(0x274)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x1d70c2(0x292)+_0x1d70c2(0x248)+_0x1d70c2(0x28c)+_0x1d70c2(0x1ec)+_0x1d70c2(0x21e)+'\x20'+_0xedc745+'\x20'+_0x1d70c2(0x1f5)+'</table>'+_0x1d70c2(0x1fd)+'<strong>\x20Regards\x20</strong>'+_0x1d70c2(0x1f0)+_0x1a9fd7[0x0][_0x1d70c2(0x1fa)]+_0x1d70c2(0x1bc)+_0x1d70c2(0x269)+_0x1d70c2(0x269)+_0x1d70c2(0x221)};_0x15c09e['sendMail'](_0x418ac9,function(_0x356851,_0x563be9){var _0x3db1ab=_0x1d70c2;_0x356851?(console['log'](_0x356851),console[_0x3db1ab(0x206)](_0x3db1ab(0x254))):console[_0x3db1ab(0x206)](_0x3db1ab(0x227));}),_0x5e421e[_0x1d70c2(0x1e6)](_0x1d70c2(0x279),_0x1d70c2(0x271)),_0x1c2735[_0x1d70c2(0x1cc)](_0x1d70c2(0x1e2)+_0x1d5878[_0x1d70c2(0x22a)]);}catch(_0xc3af68){console['error'](_0xc3af68),_0x1c2735[_0x1d70c2(0x1ea)](0x1f4)[_0x1d70c2(0x275)]({'error':_0x1d70c2(0x1b7)});}})[_0x1d3e30(0x256)](_0x74a032=>{var _0x2a2a15=_0x1d3e30;console[_0x2a2a15(0x1c3)](_0x74a032),_0x1c2735[_0x2a2a15(0x1ea)](0x1f4)[_0x2a2a15(0x275)]({'error':'An\x20error\x20occurred.'});});}catch(_0x1160a2){console[_0x1d3e30(0x206)](_0x1160a2),_0x1c2735['status'](0xc8)[_0x1d3e30(0x275)]({'message':_0x1160a2[_0x1d3e30(0x24c)]});}}),router[a0_0x4d3202(0x1fc)](a0_0x4d3202(0x1c4),auth,async(_0x4f07fe,_0x15452a)=>{var _0x324bd5=a0_0x4d3202;try{const {username:_0x5ae073,email:_0x435ada,role:_0x292c6e}=_0x4f07fe['user'],_0x32fa68=_0x4f07fe[_0x324bd5(0x253)],_0x582c49=await profile[_0x324bd5(0x1d9)]({'email':_0x32fa68[_0x324bd5(0x1ff)]}),_0x34841a=await master_shop['find'](),_0x29f1f7=_0x4f07fe[_0x324bd5(0x1c5)]['id'],_0x3fc9e9=await adjustment[_0x324bd5(0x264)]({'_id':_0x29f1f7}),_0x405c98=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3fc9e9['warehouse_name']}},{'$unwind':'$product'},{'$group':{'_id':_0x324bd5(0x1e0)}}]),_0x4957f9=await product['find']({}),_0x3fb04=await warehouse['aggregate']([{'$match':{'name':_0x3fc9e9[_0x324bd5(0x25c)]}},{'$unwind':_0x324bd5(0x23f)},{'$group':{'_id':_0x324bd5(0x1de),'name':{'$first':_0x324bd5(0x224)},'product_stock':{'$first':_0x324bd5(0x282)},'bay':{'$first':_0x324bd5(0x1ed)},'bin':{'$first':_0x324bd5(0x25d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x324bd5(0x1ee)},'primary_code':{'$first':_0x324bd5(0x273)},'secondary_code':{'$first':_0x324bd5(0x1d6)},'product_code':{'$first':_0x324bd5(0x276)},'storage':{'$first':_0x324bd5(0x26e)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x324bd5(0x27b)},'production_date':{'$first':_0x324bd5(0x25e)},'batch_code':{'$first':_0x324bd5(0x27a)},'room':{'$first':_0x324bd5(0x277)}}}]);let _0x4430b3;if(_0x32fa68[_0x324bd5(0x1e7)]=='staff'){const _0x1582e9=await staff[_0x324bd5(0x1d9)]({'email':_0x32fa68['email']});_0x4430b3=await warehouse[_0x324bd5(0x21f)]([{'$match':{'status':_0x324bd5(0x1e9),'name':_0x1582e9[_0x324bd5(0x1c0)],'warehouse_category':_0x324bd5(0x24a),'name':{'$ne':_0x324bd5(0x250)}}},{'$group':{'_id':_0x324bd5(0x1fb),'name':{'$first':_0x324bd5(0x1fb)}}}]);}else _0x4430b3=await warehouse['aggregate']([{'$match':{'status':_0x324bd5(0x1e9),'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x324bd5(0x1fb)}}}]);if(_0x34841a[0x0][_0x324bd5(0x291)]=='English\x20(US)'){var _0xc40a41=users[_0x324bd5(0x265)];console[_0x324bd5(0x206)](_0xc40a41);}else{if(_0x34841a[0x0][_0x324bd5(0x291)]==_0x324bd5(0x26f))var _0xc40a41=users[_0x324bd5(0x26f)];else{if(_0x34841a[0x0][_0x324bd5(0x291)]==_0x324bd5(0x229))var _0xc40a41=users[_0x324bd5(0x229)];else{if(_0x34841a[0x0][_0x324bd5(0x291)]=='Spanish')var _0xc40a41=users['Spanish'];else{if(_0x34841a[0x0][_0x324bd5(0x291)]==_0x324bd5(0x1e1))var _0xc40a41=users[_0x324bd5(0x1e1)];else{if(_0x34841a[0x0][_0x324bd5(0x291)]==_0x324bd5(0x27d))var _0xc40a41=users[_0x324bd5(0x24f)];else{if(_0x34841a[0x0][_0x324bd5(0x291)]==_0x324bd5(0x210))var _0xc40a41=users[_0x324bd5(0x210)];else{if(_0x34841a[0x0][_0x324bd5(0x291)]==_0x324bd5(0x20f))var _0xc40a41=users[_0x324bd5(0x1cd)];}}}}}}}_0x15452a[_0x324bd5(0x1d3)](_0x324bd5(0x208),{'success':_0x4f07fe['flash']('success'),'errors':_0x4f07fe[_0x324bd5(0x1e6)](_0x324bd5(0x1e8)),'role':_0x32fa68,'profile':_0x582c49,'adjustment':_0x3fc9e9,'stock':_0x3fb04,'master_shop':_0x34841a,'warehouse_name':_0x405c98,'unit':_0x4957f9,'language':_0xc40a41,'warehouse':_0x4430b3});}catch(_0x50f12a){console[_0x324bd5(0x206)](_0x50f12a),_0x15452a[_0x324bd5(0x1ea)](0xc8)[_0x324bd5(0x275)]({'message':_0x50f12a[_0x324bd5(0x24c)]});}}),router[a0_0x4d3202(0x217)](a0_0x4d3202(0x1c4),auth,async(_0x1d3153,_0x5426c1)=>{var _0x261576=a0_0x4d3202;try{const _0xe6484a=_0x1d3153[_0x261576(0x1c5)]['id'],_0x2d1619=await adjustment['findById']({'_id':_0xe6484a}),_0x2ebc8e=await warehouse[_0x261576(0x1d9)]({'name':_0x2d1619[_0x261576(0x25c)],'room':_0x2d1619['room']}),{warehouse_name:_0x333413,date:_0xd029c9,prod_name:_0x2eec13,level:_0x3d7765,isle:_0xfa924b,pallet:_0x5daf94,stock:_0x3e5b5d,types:_0x1e6029,adjust_qty:_0x46a959,new_adjust_qty:_0x241f20,note:_0xd31bb5,Room_name:_0xabaf64,invoice:_0x6d6c9e,JO_number:_0x4858f9,expiry_date:_0xaa07a6}=_0x1d3153[_0x261576(0x215)];if(typeof _0x2eec13==_0x261576(0x26d))var _0x46cfae=[_0x1d3153[_0x261576(0x215)][_0x261576(0x268)]],_0x581b47=[_0x1d3153[_0x261576(0x215)]['level']],_0x4a3100=[_0x1d3153[_0x261576(0x215)]['stock']],_0x17439c=[_0x1d3153['body'][_0x261576(0x1d1)]],_0x48edfd=[_0x1d3153['body'][_0x261576(0x1d8)]],_0x2101be=[_0x1d3153[_0x261576(0x215)][_0x261576(0x261)]],_0x26a9c4=[_0x1d3153[_0x261576(0x215)]['Primary_Units']],_0x20da72=[_0x1d3153[_0x261576(0x215)][_0x261576(0x1bb)]],_0x44b9ba=[_0x1d3153[_0x261576(0x215)][_0x261576(0x28a)]],_0x143175=[_0x1d3153[_0x261576(0x215)][_0x261576(0x204)]],_0x4f0e2c=[_0x1d3153[_0x261576(0x215)][_0x261576(0x209)]],_0x41468d=[_0x1d3153[_0x261576(0x215)][_0x261576(0x278)]],_0x36fe18=[_0x1d3153[_0x261576(0x215)][_0x261576(0x1b9)]],_0x1d5d29=[_0x1d3153[_0x261576(0x215)][_0x261576(0x1d5)]],_0x50e1bd=[_0x1d3153[_0x261576(0x215)][_0x261576(0x22f)]],_0x412cd5=[_0x1d3153[_0x261576(0x215)][_0x261576(0x28d)]],_0x3816c8=[_0x1d3153[_0x261576(0x215)]['second1']];else var _0x46cfae=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x268)]],_0x581b47=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x1d4)]],_0x4a3100=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x1f8)]],_0x17439c=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x1d1)]],_0x48edfd=[..._0x1d3153['body'][_0x261576(0x1d8)]],_0x2101be=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x261)]],_0x26a9c4=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x1f7)]],_0x20da72=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x1bb)]],_0x44b9ba=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x28a)]],_0x143175=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x204)]],_0x4f0e2c=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x209)]],_0x41468d=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x278)]],_0x36fe18=[..._0x1d3153[_0x261576(0x215)]['production_date']],_0x1d5d29=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x1d5)]],_0x50e1bd=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x22f)]],_0x412cd5=[..._0x1d3153[_0x261576(0x215)]['prime1']],_0x3816c8=[..._0x1d3153[_0x261576(0x215)][_0x261576(0x1c1)]];const _0x4ac63d=_0x46cfae[_0x261576(0x28f)](_0x2b6315=>{return _0x2b6315={'product_name':_0x2b6315};});_0x581b47[_0x261576(0x286)]((_0x181918,_0x16fab7)=>{var _0xb36d7b=_0x261576;_0x50e1bd[_0xb36d7b(0x286)]((_0x3e937c,_0x5bc9c0)=>{var _0x4e701f=_0xb36d7b;if(_0x3e937c==_0x4e701f(0x241)&&_0x16fab7==_0x5bc9c0){var _0xa904f1=_0x181918[_0x4e701f(0x252)](0x3);_0x4ac63d[_0x16fab7]['storage']=_0x181918[0x0],_0x4ac63d[_0x16fab7]['rack']=_0x181918[0x1],_0x4ac63d[_0x16fab7][_0x4e701f(0x270)]=0x0,_0x4ac63d[_0x16fab7][_0x4e701f(0x213)]=0x0,_0x4ac63d[_0x16fab7][_0x4e701f(0x1da)]=_0x4e701f(0x1db),_0x4ac63d[_0x16fab7][_0x4e701f(0x27c)]=_0xa904f1;}else{if(_0x3e937c==_0x4e701f(0x247)&&_0x16fab7==_0x5bc9c0){var _0xa904f1=_0x181918['slice'](0x3);_0x4ac63d[_0x16fab7][_0x4e701f(0x245)]=_0x181918[0x0],_0x4ac63d[_0x16fab7][_0x4e701f(0x263)]=_0x181918[0x1],_0x4ac63d[_0x16fab7][_0x4e701f(0x270)]=0x0,_0x4ac63d[_0x16fab7][_0x4e701f(0x213)]=0x0,_0x4ac63d[_0x16fab7][_0x4e701f(0x1da)]='Floor',_0x4ac63d[_0x16fab7][_0x4e701f(0x27c)]=_0x181918[0x5];}else{if(_0x16fab7==_0x5bc9c0){var _0x3b2bdf;if(_0x181918[0x4]=='L')_0x3b2bdf=_0x4e701f(0x24b);else _0x181918[0x4]=='F'&&(_0x3b2bdf='Floor');_0x4ac63d[_0x16fab7][_0x4e701f(0x245)]=_0x181918[0x0],_0x4ac63d[_0x16fab7][_0x4e701f(0x263)]=_0x181918[0x1],_0x4ac63d[_0x16fab7][_0x4e701f(0x270)]=_0x181918[0x2],_0x4ac63d[_0x16fab7][_0x4e701f(0x213)]=_0x181918[0x3],_0x4ac63d[_0x16fab7][_0x4e701f(0x1da)]=_0x3b2bdf,_0x4ac63d[_0x16fab7][_0x4e701f(0x27c)]=_0x181918[0x5];}}}});}),_0x4a3100[_0x261576(0x286)]((_0xe27d3,_0x4faaa2)=>{_0x4ac63d[_0x4faaa2]['stockBefore']=_0xe27d3;}),_0x17439c[_0x261576(0x286)]((_0x1b16cd,_0x498473)=>{_0x4ac63d[_0x498473]['types']=_0x1b16cd;}),_0x48edfd[_0x261576(0x286)]((_0x1887b,_0x258717)=>{_0x4ac63d[_0x258717]['adjust_qty']=_0x1887b;}),_0x2101be[_0x261576(0x286)]((_0x1cfb45,_0x47ebc3)=>{_0x4ac63d[_0x47ebc3]['new_adjust_qty']=_0x1cfb45;}),_0x26a9c4[_0x261576(0x286)]((_0x2defd3,_0x371acc)=>{var _0x4e8217=_0x261576;_0x4ac63d[_0x371acc][_0x4e8217(0x1f7)]=_0x2defd3;}),_0x20da72[_0x261576(0x286)]((_0x1adda4,_0x4e9a75)=>{var _0x38b24b=_0x261576;_0x4ac63d[_0x4e9a75][_0x38b24b(0x233)]=_0x1adda4;}),_0x44b9ba['forEach']((_0x2886e9,_0xf742dc)=>{var _0x1c4b6b=_0x261576;_0x4ac63d[_0xf742dc][_0x1c4b6b(0x212)]=_0x2886e9;}),_0x143175[_0x261576(0x286)]((_0x2c7d33,_0x1d88dc)=>{var _0xc12aba=_0x261576;_0x4ac63d[_0x1d88dc][_0xc12aba(0x204)]=_0x2c7d33;}),_0x4f0e2c[_0x261576(0x286)]((_0x352852,_0x238ecf)=>{var _0x412b5c=_0x261576;_0x4ac63d[_0x238ecf][_0x412b5c(0x209)]=_0x352852;}),_0x41468d['forEach']((_0x1adada,_0x4076c2)=>{_0x4ac63d[_0x4076c2]['maxperunit']=_0x1adada;}),_0x36fe18[_0x261576(0x286)]((_0x26362a,_0x3965a4)=>{var _0x34875c=_0x261576;_0x4ac63d[_0x3965a4][_0x34875c(0x1b9)]=_0x26362a;}),_0x1d5d29['forEach']((_0x47208f,_0x3dd4e1)=>{var _0x3f9d5e=_0x261576;_0x4ac63d[_0x3dd4e1][_0x3f9d5e(0x1d5)]=_0x47208f;}),_0x50e1bd['forEach']((_0x4c90da,_0x11917d)=>{var _0x9967ba=_0x261576;_0x4ac63d[_0x11917d][_0x9967ba(0x23e)]=_0x4c90da;}),_0x412cd5['forEach']((_0x5bf848,_0x400a80)=>{var _0x12b8f0=_0x261576;_0x4ac63d[_0x400a80][_0x12b8f0(0x200)]=_0x5bf848;}),_0x3816c8[_0x261576(0x286)]((_0x204bb0,_0x388a3d)=>{_0x4ac63d[_0x388a3d]['secondary_code']=_0x204bb0;});const _0x728988=_0x4ac63d[_0x261576(0x1ba)](_0x238fac=>_0x238fac['adjust_qty']!=='0'&&_0x238fac['adjust_qty']!=='');var _0x5796d8=0x0;_0x728988['forEach'](_0x2f0ebc=>{var _0x470905=_0x261576;console[_0x470905(0x206)](_0x470905(0x284),_0x2f0ebc),parseInt(_0x2f0ebc[_0x470905(0x23b)])<=0x0&&_0x5796d8++;});if(_0x5796d8!=0x0)return _0x1d3153['flash'](_0x261576(0x1e8),_0x261576(0x1c2)),_0x5426c1[_0x261576(0x1cc)](_0x261576(0x257));_0x2d1619[_0x261576(0x25c)]=_0x333413,_0x2d1619[_0x261576(0x24e)]=_0xd029c9,_0x2d1619[_0x261576(0x249)]=_0x728988,_0x2d1619[_0x261576(0x1be)]=_0xd31bb5,_0x2d1619['invoice']=_0x6d6c9e,_0x2d1619[_0x261576(0x240)]=_0x261576(0x216);const _0x303aeb=await _0x2d1619[_0x261576(0x28e)]();_0x1d3153[_0x261576(0x1e6)](_0x261576(0x279),_0x261576(0x211)),_0x5426c1[_0x261576(0x1cc)](_0x261576(0x258));}catch(_0x212b81){console[_0x261576(0x206)](_0x212b81);}}),router[a0_0x4d3202(0x217)](a0_0x4d3202(0x228),async(_0x372a79,_0x4b2b09)=>{var _0x3b1005=a0_0x4d3202;const {primary_code:_0x288c4d,warehouse_data:_0x459b54,rooms_data:_0x19a91f,Roomslist:_0xb5c969}=_0x372a79[_0x3b1005(0x215)],_0xd42807=_0xb5c969[_0x3b1005(0x225)](','),_0x18c70d=[];async function _0x1749a8(_0x1c9f91){var _0x188259=_0x3b1005;const _0x4f9c28=await warehouse[_0x188259(0x21f)]([{'$match':{'name':_0x459b54,'room':_0x1c9f91}},{'$unwind':_0x188259(0x23f)},{'$match':{'product_details.primary_code':_0x288c4d}},{'$group':{'_id':_0x188259(0x1de),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x188259(0x282)},'primary_code':{'$first':_0x188259(0x273)},'secondary_code':{'$first':_0x188259(0x1d6)},'product_code':{'$first':_0x188259(0x276)},'level':{'$first':_0x188259(0x1ed)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x188259(0x1b6)},'pallet':{'$first':_0x188259(0x1ee)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x188259(0x26e)},'rack':{'$first':_0x188259(0x22e)},'expiry_date':{'$first':_0x188259(0x27b)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x188259(0x280)},'batch_code':{'$first':_0x188259(0x27a)},'product_cat':{'$first':_0x188259(0x223)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x188259(0x277)},'invoice':{'$first':_0x188259(0x244)}}}]),_0x46ff39=await warehouse[_0x188259(0x21f)]([{'$match':{'name':_0x459b54,'room':_0x1c9f91}},{'$unwind':_0x188259(0x23f)},{'$match':{'product_details.secondary_code':_0x288c4d}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x188259(0x282)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x188259(0x1d6)},'product_code':{'$first':_0x188259(0x276)},'level':{'$first':_0x188259(0x1ed)},'isle':{'$first':_0x188259(0x25d)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x188259(0x21a)},'secondary_unit':{'$first':_0x188259(0x272)},'storage':{'$first':_0x188259(0x26e)},'rack':{'$first':_0x188259(0x22e)},'expiry_date':{'$first':_0x188259(0x27b)},'production_date':{'$first':_0x188259(0x25e)},'maxPerUnit':{'$first':_0x188259(0x280)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x188259(0x223)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x188259(0x277)}}}]);if(_0x4f9c28[_0x188259(0x20a)]>0x0)_0x18c70d[_0x188259(0x1ca)](_0x4f9c28);else _0x46ff39[_0x188259(0x20a)]>0x0&&_0x18c70d['push'](_0x46ff39);}const _0x18e7e8=_0xd42807[_0x3b1005(0x28f)](_0xb1dc76=>_0x1749a8(_0xb1dc76));await Promise[_0x3b1005(0x1b8)](_0x18e7e8),_0x4b2b09[_0x3b1005(0x275)](_0x18c70d);}),router[a0_0x4d3202(0x217)](a0_0x4d3202(0x232),async(_0x976a6d,_0x18be0d)=>{var _0x296b96=a0_0x4d3202;const {primaryCode:_0x1e9579,secondaryCode:_0x55b143,productCode:_0x1ffef3,level:_0x26ec94,isle:_0x579b68,pallet:_0x1f9502,warehouses:_0x5e4103,room:_0x3daf64}=_0x976a6d['body'];try{const _0x4d9ffd=await warehouse[_0x296b96(0x21f)]([{'$match':{'name':_0x5e4103,'room':_0x3daf64}},{'$unwind':_0x296b96(0x23f)},{'$match':{'product_details.level':parseInt(_0x26ec94),'product_details.isle':_0x579b68,'product_details.pallet':parseInt(_0x1f9502)}},{'$group':{'_id':_0x296b96(0x1de),'name':{'$first':_0x296b96(0x224)},'product_stock':{'$first':_0x296b96(0x282)},'level':{'$first':_0x296b96(0x1c7)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x296b96(0x287)},'maxProducts':{'$first':_0x296b96(0x1eb)}}}]);_0x18be0d[_0x296b96(0x1ea)](0xc8)['json'](_0x4d9ffd);}catch(_0x3bc95b){_0x18be0d[_0x296b96(0x1ea)](0x194)[_0x296b96(0x275)]({'message':_0x3bc95b[_0x296b96(0x24c)]});}}),module[a0_0x4d3202(0x202)]=router;