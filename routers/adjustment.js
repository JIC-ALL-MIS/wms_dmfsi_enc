var a0_0xd37988=a0_0x3c61;(function(_0x379174,_0x49e762){var _0x1f58c6=a0_0x3c61,_0x3dd297=_0x379174();while(!![]){try{var _0x5a39c9=parseInt(_0x1f58c6(0xc7))/0x1+parseInt(_0x1f58c6(0xea))/0x2*(parseInt(_0x1f58c6(0x7f))/0x3)+parseInt(_0x1f58c6(0xac))/0x4*(-parseInt(_0x1f58c6(0x126))/0x5)+-parseInt(_0x1f58c6(0xf0))/0x6*(-parseInt(_0x1f58c6(0xa2))/0x7)+-parseInt(_0x1f58c6(0xf4))/0x8+parseInt(_0x1f58c6(0xb4))/0x9+parseInt(_0x1f58c6(0xfa))/0xa;if(_0x5a39c9===_0x49e762)break;else _0x3dd297['push'](_0x3dd297['shift']());}catch(_0x47907d){_0x3dd297['push'](_0x3dd297['shift']());}}}(a0_0x579a,0x1fe1c));function a0_0x579a(){var _0x370827=['<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','warehouse_name','log','$product_details.isle','</tbody>','adjustment\x20data\x20update\x20successfully','287BcOyZg','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','foreach\x20newproduct','$product_details.bin','params','prime1','email','Portuguese','English\x20(US)','German','206852TeFRxh','maxperunit','warehouse','Rooms','$product.product_name','Level','createTransport','/preview/:id','538794EQXQGK','$product_details.type','Return\x20Goods','aggregate','<span\x20style=\x22float:\x20right;\x22>','$isAllowEdit','all','sendMail','$product_details.pallet','Shelves','save','stockBefore','type','ADJ-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.product_cat','role','$_id','id_transaction','100567jDLxMS','$product_details.maxPerUnit','$finalize','find','bay','unit','$product_details.storage','forEach','$product_details.production_date','redirect','success','secondary_unit','$room','<strong>\x20Regards\x20</strong>','<h2>\x20','port','product_code','$product_details.product_name','</thead>','catch','$product_details.maxProducts','product_name','$product.room_names','Error\x20Occurs','RMSEmail','adjust_qty','host','product_details','expiry_date','<tbody\x20style=\x22text-align:\x20center;\x22>','/picking_list/PDF_adjustment_rm/','isAllowEdit','date','then','site_title','8042LifzNX','bin','_id','nodemailer','Router','language','37998fyVtrz','filter','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details','1484120zEyHVm','$name','length','<table\x20style=\x22width:\x20100%\x20!important;\x22>','new_adjust_qty','level','988480NesRgP','$product_details.bay','<div>','express','Adjustment\x20Mail','prod_cat','Chinese','product','room_names','product_stock','staff','logo','status','Arabic','$date','/view/:id','$product_details.primary_code','stock','../public/language/languages.json','user','<!DOCTYPE\x20html>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','</head><body>','errors','rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','../middleware/auth','An\x20error\x20occurred.','push','$product_details.invoice','render','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','adjustment\x20Finalized\x20successfully','$product_details.unit','/adjustment/preview/','False','slice','$invoice','note','Logo.png','Enabled','split','20ovKSNM','prod_name','body','$product_details._id','Enclosed','exports','padStart','</div>','storage','/view/add_adjustment','Ambient','</tr>','\x20<>\x20','finalize','adjustment','message','types','floorlevel','/upload/','Receiving\x20Area','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Secondary_units','$product_details.secondary_code','Hindi','/adjustment/view','prod_invoice','findById','\x20</h2>','New_Qty_Converted_adj','Arabic\x20(ae)','</td>','Portuguese\x20(BR)','flash','floor','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.expiry_date','back','map','findOne','Email\x20sent\x20successfully','max_per_unit','password','post','</h5>','</body></html>','json','/CheckingWarehouse','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','French','New_Qty_Converted','3RsOadw','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','prod_code','$product_details.rack','<h5>','$product_details.secondary_unit','$product_details.batch_code','Raw\x20Materials','$product_details.product_code','Spanish','$product_details.product_stock','English','$product_details.floorlevel','</span>','Primary_Units','id_transaction_from','$product','maxPerUnit','edit_adjustment_view','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','/view','room','batch_code','secondary_code','invoice','production_date','Floor','get','second1'];a0_0x579a=function(){return _0x370827;};return a0_0x579a();}const express=require(a0_0xd37988(0xfd)),app=express(),router=express[a0_0xd37988(0xee)](),auth=require(a0_0xd37988(0x115)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0xd37988(0x10c)),nodemailer=require(a0_0xd37988(0xed));router[a0_0xd37988(0x9a)](a0_0xd37988(0x93),auth,async(_0x2261bb,_0x416d93)=>{var _0x59bf8f=a0_0xd37988;try{const {username:_0x347a7d,email:_0x419637,role:_0xc3a693}=_0x2261bb[_0x59bf8f(0x10d)],_0x34baf4=_0x2261bb['user'],_0x34b4e4=await profile[_0x59bf8f(0x73)]({'email':_0x34baf4[_0x59bf8f(0xa8)]}),_0x5159bd=await master_shop[_0x59bf8f(0xca)]();console['log']('master',_0x5159bd);let _0x524dc5;if(_0x34baf4['role']==_0x59bf8f(0x104)){const _0x5e60a1=await staff['findOne']({'email':_0x34baf4[_0x59bf8f(0xa8)]});_0x524dc5=await warehouse[_0x59bf8f(0xca)]({'status':'Enabled','name':_0x5e60a1[_0x59bf8f(0xae)]});}else _0x524dc5=await warehouse[_0x59bf8f(0xca)]({'status':_0x59bf8f(0x124)});const _0x252d8f=await product[_0x59bf8f(0xca)]();let _0x4f3d79;if(_0x34baf4[_0x59bf8f(0xc4)]==_0x59bf8f(0x104)){const _0x4df56e=await staff[_0x59bf8f(0x73)]({'email':_0x34baf4['email']});_0x4f3d79=await adjustment['find']({'warehouse_name':_0x4df56e[_0x59bf8f(0xae)]});}else _0x4f3d79=await adjustment['aggregate']([{'$unwind':_0x59bf8f(0x8f)},{'$group':{'_id':_0x59bf8f(0xc5),'invoice':{'$first':_0x59bf8f(0x121)},'date':{'$first':_0x59bf8f(0x108)},'warehouse_name':{'$first':'$warehouse_name'},'room':{'$addToSet':_0x59bf8f(0xdd)},'finalize':{'$first':_0x59bf8f(0xc9)},'isAllowEdit':{'$first':_0x59bf8f(0xb9)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x5159bd[0x0]['language']==_0x59bf8f(0xaa)){var _0xdb1587=users[_0x59bf8f(0x8a)];console['log'](_0xdb1587);}else{if(_0x5159bd[0x0][_0x59bf8f(0xef)]=='Hindi')var _0xdb1587=users[_0x59bf8f(0x13d)];else{if(_0x5159bd[0x0][_0x59bf8f(0xef)]=='German')var _0xdb1587=users[_0x59bf8f(0xab)];else{if(_0x5159bd[0x0][_0x59bf8f(0xef)]==_0x59bf8f(0x88))var _0xdb1587=users[_0x59bf8f(0x88)];else{if(_0x5159bd[0x0][_0x59bf8f(0xef)]=='French')var _0xdb1587=users[_0x59bf8f(0x7d)];else{if(_0x5159bd[0x0][_0x59bf8f(0xef)]==_0x59bf8f(0x6b))var _0xdb1587=users['Portuguese'];else{if(_0x5159bd[0x0]['language']==_0x59bf8f(0x100))var _0xdb1587=users['Chinese'];else{if(_0x5159bd[0x0][_0x59bf8f(0xef)]==_0x59bf8f(0x69))var _0xdb1587=users['Arabic'];}}}}}}}_0x416d93[_0x59bf8f(0x119)](_0x59bf8f(0x134),{'success':_0x2261bb[_0x59bf8f(0x6c)](_0x59bf8f(0xd1)),'errors':_0x2261bb['flash']('errors'),'role':_0x34baf4,'profile':_0x34b4e4,'warehouse':_0x524dc5,'product':_0x252d8f,'adjustment':_0x4f3d79,'master_shop':_0x5159bd,'language':_0xdb1587});}catch(_0x4930aa){console[_0x59bf8f(0x9e)](_0x4930aa);}});async function getRandom8DigitNumber(){var _0x4df0a3=a0_0xd37988;const _0x1a11de=0x989680,_0x537831=0x5f5e0ff,_0x8e67f9=Math[_0x4df0a3(0x6d)](Math['random']()*(_0x537831-_0x1a11de+0x1))+_0x1a11de;var _0x296a15;const _0x84c142=await adjustment[_0x4df0a3(0x73)]({'invoice':'ADJ-'+_0x8e67f9});return _0x84c142&&_0x84c142['length']>0x0?_0x296a15=_0x4df0a3(0xc1)+_0x8e67f9:_0x296a15='ADJ-'+_0x8e67f9,_0x296a15;}function a0_0x3c61(_0x2a0d8d,_0x5b0e4d){var _0x579a64=a0_0x579a();return a0_0x3c61=function(_0x3c6186,_0x64a07f){_0x3c6186=_0x3c6186-0x64;var _0x251ca1=_0x579a64[_0x3c6186];return _0x251ca1;},a0_0x3c61(_0x2a0d8d,_0x5b0e4d);}router[a0_0xd37988(0x9a)](a0_0xd37988(0x12f),auth,async(_0x5f20b4,_0x4e6f4d)=>{var _0x524b1a=a0_0xd37988;try{const {username:_0x4f718b,email:_0xb9b71a,role:_0x1d7195}=_0x5f20b4[_0x524b1a(0x10d)],_0x476d86=_0x5f20b4[_0x524b1a(0x10d)],_0x4f3a8b=await profile[_0x524b1a(0x73)]({'email':_0x476d86[_0x524b1a(0xa8)]}),_0xb7bf93=await master_shop['find']();let _0x5c06b5;if(_0x476d86['role']==_0x524b1a(0x104)){const _0x2a216b=await staff[_0x524b1a(0x73)]({'email':_0x476d86[_0x524b1a(0xa8)]});_0x5c06b5=await warehouse[_0x524b1a(0xb7)]([{'$match':{'status':_0x524b1a(0x124),'name':_0x2a216b[_0x524b1a(0xae)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x524b1a(0xb6)}}},{'$group':{'_id':_0x524b1a(0xf5),'name':{'$first':'$name'}}}]);}else _0x5c06b5=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x524b1a(0x86),'name':{'$ne':_0x524b1a(0xb6)}}},{'$group':{'_id':_0x524b1a(0xf5),'name':{'$first':'$name'}}}]);const _0x5a073e=await product[_0x524b1a(0xca)]({}),_0xca3eb4=await adjustment['find']({}),_0x1f4448=_0xca3eb4[_0x524b1a(0xf6)]+0x1,_0x4b3e91='ADJ-'+_0x1f4448['toString']()[_0x524b1a(0x12c)](0x5,'0');var _0x1cbcf4=[_0x524b1a(0x130),_0x524b1a(0x12a),'Return\x20Rooms'];if(_0xb7bf93[0x0][_0x524b1a(0xef)]==_0x524b1a(0xaa))var _0x29c4dc=users[_0x524b1a(0x8a)];else{if(_0xb7bf93[0x0][_0x524b1a(0xef)]==_0x524b1a(0x13d))var _0x29c4dc=users[_0x524b1a(0x13d)];else{if(_0xb7bf93[0x0]['language']=='German')var _0x29c4dc=users[_0x524b1a(0xab)];else{if(_0xb7bf93[0x0][_0x524b1a(0xef)]==_0x524b1a(0x88))var _0x29c4dc=users[_0x524b1a(0x88)];else{if(_0xb7bf93[0x0][_0x524b1a(0xef)]==_0x524b1a(0x7d))var _0x29c4dc=users['French'];else{if(_0xb7bf93[0x0][_0x524b1a(0xef)]==_0x524b1a(0x6b))var _0x29c4dc=users['Portuguese'];else{if(_0xb7bf93[0x0]['language']==_0x524b1a(0x100))var _0x29c4dc=users['Chinese'];else{if(_0xb7bf93[0x0][_0x524b1a(0xef)]==_0x524b1a(0x69))var _0x29c4dc=users[_0x524b1a(0x107)];}}}}}}}const _0x303fa2=getRandom8DigitNumber();_0x303fa2[_0x524b1a(0xe8)](_0x793de2=>{var _0x24c71f=_0x524b1a;_0x4e6f4d[_0x24c71f(0x119)]('add_adjustment',{'success':_0x5f20b4[_0x24c71f(0x6c)](_0x24c71f(0xd1)),'errors':_0x5f20b4['flash'](_0x24c71f(0x111)),'role':_0x476d86,'profile':_0x4f3a8b,'warehouse':_0x5c06b5,'product':_0x5a073e,'master_shop':_0xb7bf93,'language':_0x29c4dc,'rooms_data':_0x1cbcf4,'invoice_no':_0x793de2});})['catch'](_0x3f5042=>{var _0x2bff0b=_0x524b1a;_0x5f20b4[_0x2bff0b(0x6c)](_0x2bff0b(0x111),_0x2bff0b(0x10f)),_0x4e6f4d[_0x2bff0b(0xd0)](_0x2bff0b(0x64));});}catch(_0x5c2820){console['log'](_0x5c2820);}}),router[a0_0xd37988(0x77)](a0_0xd37988(0x12f),auth,async(_0x29cca2,_0x447623)=>{var _0x2f240c=a0_0xd37988;try{const {warehouse_name:_0x454579,date:_0x189351,prod_name:_0x349cca,level:_0x44828a,isle:_0x12e3e6,pallet:_0x5cbeb5,stock:_0x4f4557,types:_0x35bc,adjust_qty:_0x4678ae,new_adjust_qty:_0x4a920f,note:_0x54f609,Room_name:_0x2490fe,invoice:_0x1cf2d4,JO_number:_0x38b301,expiry_date:_0x3dea6c}=_0x29cca2['body'];if(typeof _0x349cca=='string')var _0x5c9849=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x127)]],_0x1461f9=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0xf9)]],_0x1eb75c=[_0x29cca2['body'][_0x2f240c(0x10b)]],_0x2ef11c=[_0x29cca2[_0x2f240c(0x128)]['types']],_0x26a192=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x68)]],_0x5d5b30=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x7e)]],_0x18f807=[_0x29cca2[_0x2f240c(0x128)]['Primary_Units']],_0x3af3be=[_0x29cca2['body'][_0x2f240c(0x13b)]],_0x4982fc=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x81)]],_0x2c098b=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x95)]],_0x3db325=[_0x29cca2[_0x2f240c(0x128)]['expiry_date']],_0x2e5c52=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x75)]],_0x1c16ec=[_0x29cca2[_0x2f240c(0x128)]['production_date']],_0x787f67=[_0x29cca2[_0x2f240c(0x128)]['prod_cat']],_0x26d616=[_0x29cca2[_0x2f240c(0x128)]['Rooms']],_0x388067=[_0x29cca2[_0x2f240c(0x128)]['prime1']],_0x342317=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x9b)]],_0x2b6d42=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x65)]],_0x3931e5=[_0x29cca2[_0x2f240c(0x128)][_0x2f240c(0xc6)]];else var _0x5c9849=[..._0x29cca2['body']['prod_name']],_0x1461f9=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0xf9)]],_0x1eb75c=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x10b)]],_0x2ef11c=[..._0x29cca2['body'][_0x2f240c(0x136)]],_0x26a192=[..._0x29cca2['body'][_0x2f240c(0x68)]],_0x5d5b30=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x7e)]],_0x18f807=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0xcc)]],_0x3af3be=[..._0x29cca2[_0x2f240c(0x128)]['Secondary_units']],_0x4982fc=[..._0x29cca2['body'][_0x2f240c(0x81)]],_0x2c098b=[..._0x29cca2[_0x2f240c(0x128)]['batch_code']],_0x3db325=[..._0x29cca2['body']['expiry_date']],_0x2e5c52=[..._0x29cca2['body'][_0x2f240c(0x75)]],_0x1c16ec=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x98)]],_0x787f67=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0xff)]],_0x26d616=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0xaf)]],_0x388067=[..._0x29cca2[_0x2f240c(0x128)]['prime1']],_0x342317=[..._0x29cca2['body'][_0x2f240c(0x9b)]],_0x2b6d42=[..._0x29cca2[_0x2f240c(0x128)][_0x2f240c(0x65)]],_0x3931e5=[..._0x29cca2['body'][_0x2f240c(0xc6)]];const _0x32334b=_0x5c9849[_0x2f240c(0x72)](_0x12d317=>{return _0x12d317={'product_name':_0x12d317};});_0x1461f9[_0x2f240c(0xce)]((_0xc81581,_0x56303c)=>{var _0x336df4=_0x2f240c;_0x26d616[_0x336df4(0xce)]((_0xb67d5a,_0x1bba7a)=>{var _0x4962b7=_0x336df4;if(_0xb67d5a==_0x4962b7(0x139)&&_0x56303c==_0x1bba7a){var _0x1390b0=_0xc81581[_0x4962b7(0x120)](0x3);_0x32334b[_0x56303c][_0x4962b7(0x12e)]=_0xc81581[0x0],_0x32334b[_0x56303c][_0x4962b7(0x112)]=_0xc81581[0x1],_0x32334b[_0x56303c][_0x4962b7(0xcb)]=0x0,_0x32334b[_0x56303c][_0x4962b7(0xeb)]=0x0,_0x32334b[_0x56303c][_0x4962b7(0xc0)]='Floor',_0x32334b[_0x56303c][_0x4962b7(0x137)]=_0x1390b0;}else{if(_0xb67d5a==_0x4962b7(0xbd)&&_0x56303c==_0x1bba7a){var _0x1390b0=_0xc81581[_0x4962b7(0x120)](0x3);_0x32334b[_0x56303c][_0x4962b7(0x12e)]=_0xc81581[0x0],_0x32334b[_0x56303c][_0x4962b7(0x112)]=_0xc81581[0x1],_0x32334b[_0x56303c][_0x4962b7(0xcb)]=0x0,_0x32334b[_0x56303c][_0x4962b7(0xeb)]=0x0,_0x32334b[_0x56303c][_0x4962b7(0xc0)]=_0x4962b7(0x99),_0x32334b[_0x56303c][_0x4962b7(0x137)]=_0xc81581[0x5];}else{if(_0x56303c==_0x1bba7a){var _0x5bc5fc;if(_0xc81581[0x4]=='L')_0x5bc5fc=_0x4962b7(0xb1);else _0xc81581[0x4]=='F'&&(_0x5bc5fc=_0x4962b7(0x99));_0x32334b[_0x56303c]['storage']=_0xc81581[0x0],_0x32334b[_0x56303c][_0x4962b7(0x112)]=_0xc81581[0x1],_0x32334b[_0x56303c][_0x4962b7(0xcb)]=_0xc81581[0x2],_0x32334b[_0x56303c][_0x4962b7(0xeb)]=_0xc81581[0x3],_0x32334b[_0x56303c][_0x4962b7(0xc0)]=_0x5bc5fc,_0x32334b[_0x56303c]['floorlevel']=_0xc81581[0x5];}}}});}),_0x1eb75c[_0x2f240c(0xce)]((_0x462dad,_0x5a2809)=>{var _0x139d39=_0x2f240c;_0x32334b[_0x5a2809][_0x139d39(0xbf)]=_0x462dad;}),_0x3931e5[_0x2f240c(0xce)]((_0xc90e7d,_0x3a5a7e)=>{var _0x51cd71=_0x2f240c;_0x32334b[_0x3a5a7e][_0x51cd71(0x8e)]=_0xc90e7d;}),_0x2ef11c[_0x2f240c(0xce)]((_0x18bc03,_0x393609)=>{var _0x4a51cc=_0x2f240c;_0x32334b[_0x393609][_0x4a51cc(0x136)]=_0x18bc03;}),_0x26a192[_0x2f240c(0xce)]((_0x58880c,_0x9a5d55)=>{var _0x28e8f5=_0x2f240c;_0x32334b[_0x9a5d55][_0x28e8f5(0xe0)]=_0x58880c;}),_0x5d5b30[_0x2f240c(0xce)]((_0x1a0cca,_0x35a337)=>{var _0x2b1415=_0x2f240c;_0x32334b[_0x35a337][_0x2b1415(0xf8)]=_0x1a0cca;}),_0x18f807[_0x2f240c(0xce)]((_0x5cdc79,_0x455866)=>{var _0x3ceada=_0x2f240c;_0x32334b[_0x455866][_0x3ceada(0xcc)]=_0x5cdc79;}),_0x3af3be['forEach']((_0x5c4b45,_0x79f441)=>{var _0x5f2bc4=_0x2f240c;_0x32334b[_0x79f441][_0x5f2bc4(0xd2)]=_0x5c4b45;}),_0x4982fc[_0x2f240c(0xce)]((_0x1ed37e,_0x37ef10)=>{_0x32334b[_0x37ef10]['product_code']=_0x1ed37e;}),_0x2c098b[_0x2f240c(0xce)]((_0x546918,_0x4f1f09)=>{_0x32334b[_0x4f1f09]['batch_code']=_0x546918;}),_0x3db325[_0x2f240c(0xce)]((_0x35058c,_0x540d7f)=>{var _0x5d4544=_0x2f240c;_0x32334b[_0x540d7f][_0x5d4544(0xe3)]=_0x35058c;}),_0x2e5c52[_0x2f240c(0xce)]((_0x4fa3fc,_0x557713)=>{var _0xe8633b=_0x2f240c;_0x32334b[_0x557713][_0xe8633b(0xad)]=_0x4fa3fc;}),_0x1c16ec[_0x2f240c(0xce)]((_0x321389,_0x41507e)=>{_0x32334b[_0x41507e]['production_date']=_0x321389;}),_0x787f67['forEach']((_0xaa8c8e,_0x3b9784)=>{var _0x3decac=_0x2f240c;_0x32334b[_0x3b9784][_0x3decac(0xff)]=_0xaa8c8e;}),_0x26d616[_0x2f240c(0xce)]((_0x296942,_0x315568)=>{_0x32334b[_0x315568]['room_names']=_0x296942;}),_0x388067[_0x2f240c(0xce)]((_0x12afd5,_0x3c0503)=>{_0x32334b[_0x3c0503]['primary_code']=_0x12afd5;}),_0x342317[_0x2f240c(0xce)]((_0x5f2881,_0x3b9338)=>{var _0x3aba5c=_0x2f240c;_0x32334b[_0x3b9338][_0x3aba5c(0x96)]=_0x5f2881;}),_0x2b6d42[_0x2f240c(0xce)]((_0x26c26d,_0x338343)=>{var _0x20a7bc=_0x2f240c;_0x32334b[_0x338343][_0x20a7bc(0x97)]=_0x26c26d;});const _0x41f804=_0x32334b[_0x2f240c(0xf1)](_0x90650=>_0x90650[_0x2f240c(0xe0)]!=='0'&&_0x90650[_0x2f240c(0xe0)]!=='');var _0x394065=0x0;_0x41f804[_0x2f240c(0xce)](_0xfc3bf0=>{var _0x1c7ac7=_0x2f240c;console[_0x1c7ac7(0x9e)](_0x1c7ac7(0xa4),_0xfc3bf0),parseInt(_0xfc3bf0[_0x1c7ac7(0xe0)])<=0x0&&_0x394065++;});if(_0x394065!=0x0)return _0x29cca2[_0x2f240c(0x6c)](_0x2f240c(0x111),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x447623[_0x2f240c(0xd0)]('back');const _0x36ef8f=new adjustment({'warehouse_name':_0x454579,'date':_0x189351,'product':_0x41f804,'note':_0x54f609,'room':_0x2490fe,'invoice':_0x1cf2d4,'JO_number':_0x38b301,'expiry_date':_0x3dea6c}),_0x1271e8=await _0x36ef8f[_0x2f240c(0xbe)]();_0x29cca2[_0x2f240c(0x6c)](_0x2f240c(0xd1),'adjustment\x20add\x20successfull'),_0x447623[_0x2f240c(0xd0)](_0x2f240c(0x11e)+_0x1271e8['_id']);}catch(_0x5b70af){console['log'](_0x5b70af),_0x447623[_0x2f240c(0x106)](0xc8)[_0x2f240c(0x7a)]({'message':_0x5b70af[_0x2f240c(0x135)]});}}),router[a0_0xd37988(0x9a)]('/preview/:id',auth,async(_0x21026f,_0x497fc)=>{var _0xf19e09=a0_0xd37988;try{const {username:_0x351fa6,email:_0x10e43c,role:_0x2d969f}=_0x21026f['user'],_0x2abf5b=_0x21026f[_0xf19e09(0x10d)],_0x2ab991=await profile['findOne']({'email':_0x2abf5b[_0xf19e09(0xa8)]}),_0x4dd903=await master_shop[_0xf19e09(0xca)](),_0x39c6b7=_0x21026f[_0xf19e09(0xa6)]['id'],_0x375566=await adjustment[_0xf19e09(0x66)]({'_id':_0x39c6b7}),_0x5b065e=await purchases[_0xf19e09(0xb7)]([{'$match':{'warehouse_name':_0x375566[_0xf19e09(0x9d)]}},{'$unwind':_0xf19e09(0x8f)},{'$group':{'_id':_0xf19e09(0xb0)}}]),_0x412958=await product[_0xf19e09(0xca)]({}),_0x501724=await warehouse[_0xf19e09(0xb7)]([{'$match':{'name':_0x375566[_0xf19e09(0x9d)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0xf19e09(0x129),'name':{'$first':_0xf19e09(0xd8)},'product_stock':{'$first':_0xf19e09(0x89)},'bay':{'$first':_0xf19e09(0xfb)},'bin':{'$first':_0xf19e09(0xa5)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xf19e09(0x87)},'storage':{'$first':_0xf19e09(0xcd)},'rack':{'$first':_0xf19e09(0x82)},'maxPerUnit':{'$first':_0xf19e09(0xc8)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xf19e09(0xcf)},'batch_code':{'$first':_0xf19e09(0x85)},'room':{'$first':_0xf19e09(0xd3)}}}]);if(_0x4dd903[0x0][_0xf19e09(0xef)]==_0xf19e09(0xaa)){var _0x58d778=users[_0xf19e09(0x8a)];console['log'](_0x58d778);}else{if(_0x4dd903[0x0][_0xf19e09(0xef)]=='Hindi')var _0x58d778=users[_0xf19e09(0x13d)];else{if(_0x4dd903[0x0][_0xf19e09(0xef)]==_0xf19e09(0xab))var _0x58d778=users[_0xf19e09(0xab)];else{if(_0x4dd903[0x0][_0xf19e09(0xef)]==_0xf19e09(0x88))var _0x58d778=users[_0xf19e09(0x88)];else{if(_0x4dd903[0x0][_0xf19e09(0xef)]==_0xf19e09(0x7d))var _0x58d778=users['French'];else{if(_0x4dd903[0x0][_0xf19e09(0xef)]==_0xf19e09(0x6b))var _0x58d778=users[_0xf19e09(0xa9)];else{if(_0x4dd903[0x0]['language']==_0xf19e09(0x100))var _0x58d778=users[_0xf19e09(0x100)];else{if(_0x4dd903[0x0][_0xf19e09(0xef)]==_0xf19e09(0x69))var _0x58d778=users[_0xf19e09(0x107)];}}}}}}}_0x497fc[_0xf19e09(0x119)](_0xf19e09(0x91),{'success':_0x21026f['flash'](_0xf19e09(0xd1)),'errors':_0x21026f[_0xf19e09(0x6c)](_0xf19e09(0x111)),'role':_0x2abf5b,'profile':_0x2ab991,'adjustment':_0x375566,'stock':_0x501724,'master_shop':_0x4dd903,'warehouse_name':_0x5b065e,'unit':_0x412958,'language':_0x58d778});}catch(_0x54f1be){console[_0xf19e09(0x9e)](_0x54f1be),_0x497fc[_0xf19e09(0x106)](0xc8)[_0xf19e09(0x7a)]({'message':_0x54f1be[_0xf19e09(0x135)]});}}),router[a0_0xd37988(0x77)](a0_0xd37988(0xb3),auth,async(_0x2bec74,_0x21138f)=>{var _0x46036b=a0_0xd37988;try{const _0x1d0ffe=_0x2bec74[_0x46036b(0xa6)]['id'],{warehouse_name:_0x52fa3c,Room_name:_0xceb1e4}=_0x2bec74[_0x46036b(0x128)],_0x5133c0=await adjustment[_0x46036b(0x66)]({'_id':_0x1d0ffe}),_0x4c428e=_0x5133c0[_0x46036b(0x101)]['map'](async _0xd30425=>{var _0xcbeb35=_0x46036b;if(_0xd30425[_0xcbeb35(0xe0)]>0x0){var _0x296679=await warehouse['findOne']({'name':_0x52fa3c,'room':_0xd30425[_0xcbeb35(0x102)],'warehouse_category':'Raw\x20Materials'});const _0x35bc8e=_0x296679[_0xcbeb35(0xe2)]['map'](_0x19d23c=>{var _0x391b70=_0xcbeb35;if(_0xd30425[_0x391b70(0xc0)]=='minus'){if(_0x19d23c[_0x391b70(0xdc)]==_0xd30425[_0x391b70(0xdc)]&&_0x19d23c[_0x391b70(0x137)]==_0xd30425[_0x391b70(0x137)]&&_0x19d23c[_0x391b70(0xc0)]==_0xd30425[_0x391b70(0xc0)]&&_0x19d23c[_0x391b70(0xeb)]==_0xd30425[_0x391b70(0xeb)]&&_0x19d23c['bay']==_0xd30425[_0x391b70(0xcb)]&&_0x19d23c[_0x391b70(0x112)]==_0xd30425[_0x391b70(0x112)]&&_0x19d23c[_0x391b70(0x12e)]==_0xd30425[_0x391b70(0x12e)]&&_0x19d23c[_0x391b70(0xe3)]==_0xd30425[_0x391b70(0xe3)]&&_0x19d23c[_0x391b70(0x95)]==_0xd30425['batch_code']&&_0x19d23c[_0x391b70(0x98)]==_0xd30425[_0x391b70(0x98)]&&_0x19d23c[_0x391b70(0x97)]==_0xd30425[_0x391b70(0x97)]&&_0x19d23c[_0x391b70(0xec)]==_0xd30425['id_transaction_from']){var _0x3b653c;_0x3b653c=_0xd30425[_0x391b70(0xe0)],_0xd30425['prod_cat']=='S'&&(_0x3b653c=_0xd30425['adjust_qty']),_0x19d23c[_0x391b70(0x103)]=_0x19d23c[_0x391b70(0x103)]-_0x3b653c;}}else{if(_0x19d23c[_0x391b70(0xdc)]==_0xd30425[_0x391b70(0xdc)]&&_0x19d23c['floorlevel']==_0xd30425[_0x391b70(0x137)]&&_0x19d23c[_0x391b70(0xc0)]==_0xd30425[_0x391b70(0xc0)]&&_0x19d23c[_0x391b70(0xeb)]==_0xd30425[_0x391b70(0xeb)]&&_0x19d23c[_0x391b70(0xcb)]==_0xd30425['bay']&&_0x19d23c[_0x391b70(0x112)]==_0xd30425[_0x391b70(0x112)]&&_0x19d23c[_0x391b70(0x12e)]==_0xd30425['storage']&&_0x19d23c[_0x391b70(0xe3)]==_0xd30425[_0x391b70(0xe3)]&&_0x19d23c[_0x391b70(0x95)]==_0xd30425[_0x391b70(0x95)]&&_0x19d23c['production_date']==_0xd30425[_0x391b70(0x98)]&&_0x19d23c[_0x391b70(0x97)]==_0xd30425[_0x391b70(0x97)]&&_0x19d23c['_id']==_0xd30425[_0x391b70(0x8e)]){console[_0x391b70(0x9e)](_0xd30425);var _0x3b653c;_0x3b653c=_0xd30425[_0x391b70(0xe0)],_0xd30425[_0x391b70(0xff)]=='S'&&(_0x3b653c=_0xd30425['adjust_qty']),console[_0x391b70(0x9e)](_0x3b653c+'\x20<>\x20'+_0xd30425['adjust_qty']+_0x391b70(0x132)+_0x19d23c[_0x391b70(0x90)]+_0x391b70(0x132)+_0xd30425[_0x391b70(0xff)]),_0x19d23c[_0x391b70(0x103)]=_0x19d23c[_0x391b70(0x103)]+_0x3b653c;}}});}return _0x296679;});Promise[_0x46036b(0xba)](_0x4c428e)[_0x46036b(0xe8)](async _0x15a767=>{var _0x14e8a1=_0x46036b;try{for(const _0x17b542 of _0x15a767){await _0x17b542[_0x14e8a1(0xbe)]();}_0x5133c0[_0x14e8a1(0x133)]=_0x14e8a1(0x11a);const _0x5f967f=await _0x5133c0[_0x14e8a1(0xbe)](),_0x333869=await master_shop[_0x14e8a1(0xca)](),_0x3a1e07=await email_settings['findOne'](),_0x468075=await supervisor_settings['find']();var _0x461851=_0x5133c0['product'],_0x1741fb='',_0x1fa133;for(_0x1fa133 in _0x461851){_0x1741fb+='<tr>'+_0x14e8a1(0x9c)+_0x461851[_0x1fa133][_0x14e8a1(0xdc)]+_0x14e8a1(0x6a)+_0x14e8a1(0x9c)+_0x461851[_0x1fa133]['product_code']+_0x14e8a1(0x6a)+_0x14e8a1(0x9c)+_0x461851[_0x1fa133]['adjust_qty']+_0x14e8a1(0x6a)+_0x14e8a1(0x9c)+_0x461851[_0x1fa133][_0x14e8a1(0xcc)]+_0x14e8a1(0x6a)+_0x14e8a1(0x9c)+_0x461851[_0x1fa133][_0x14e8a1(0xd2)]+_0x14e8a1(0x6a)+_0x14e8a1(0x9c)+_0x5133c0[_0x14e8a1(0x9d)]+_0x14e8a1(0x6a)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x461851[_0x1fa133][_0x14e8a1(0x102)]+_0x14e8a1(0x6a)+_0x14e8a1(0x9c)+_0x461851[_0x1fa133][_0x14e8a1(0x12e)]+_0x461851[_0x1fa133][_0x14e8a1(0x112)]+_0x461851[_0x1fa133][_0x14e8a1(0xcb)]+_0x461851[_0x1fa133]['bin']+_0x461851[_0x1fa133][_0x14e8a1(0xc0)][0x0]+_0x461851[_0x1fa133][_0x14e8a1(0x137)]+_0x14e8a1(0x6a),'</tr>';}let _0x13bc43=nodemailer[_0x14e8a1(0xb2)]({'host':_0x3a1e07[_0x14e8a1(0xe1)],'port':Number(_0x3a1e07[_0x14e8a1(0xd6)]),'secure':![],'auth':{'user':_0x3a1e07[_0x14e8a1(0xa8)],'pass':_0x3a1e07[_0x14e8a1(0x76)]}}),_0x596116={'from':_0x3a1e07['email'],'to':_0x468075[0x0][_0x14e8a1(0xdf)],'subject':_0x14e8a1(0xfe),'attachments':[{'filename':_0x14e8a1(0x123),'path':__dirname+'/../public'+_0x14e8a1(0x138)+_0x333869[0x0][_0x14e8a1(0x6e)],'cid':_0x14e8a1(0x105)}],'html':_0x14e8a1(0x10e)+'<html><head><title></title>'+_0x14e8a1(0x110)+_0x14e8a1(0xfc)+_0x14e8a1(0x7c)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x14e8a1(0x12d)+_0x14e8a1(0xfc)+_0x14e8a1(0xd5)+_0x333869[0x0][_0x14e8a1(0xe9)]+_0x14e8a1(0x67)+_0x14e8a1(0x12d)+_0x14e8a1(0x12d)+'<hr\x20class=\x22my-3\x22>'+_0x14e8a1(0xfc)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x5133c0[_0x14e8a1(0x97)]+'\x20'+_0x14e8a1(0xb8)+'\x20Order\x20Date\x20:\x20'+_0x5133c0[_0x14e8a1(0xe7)]+'\x20'+_0x14e8a1(0x8c)+'</h5>'+_0x14e8a1(0x12d)+_0x14e8a1(0xf7)+_0x14e8a1(0x80)+'<tr>'+_0x14e8a1(0x114)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x14e8a1(0xa3)+_0x14e8a1(0x6f)+_0x14e8a1(0x13a)+_0x14e8a1(0x11b)+_0x14e8a1(0x113)+_0x14e8a1(0xc2)+_0x14e8a1(0x131)+_0x14e8a1(0xd9)+_0x14e8a1(0xe4)+'\x20'+_0x1741fb+'\x20'+_0x14e8a1(0xa0)+'</table>'+_0x14e8a1(0xfc)+_0x14e8a1(0xd4)+_0x14e8a1(0x83)+_0x333869[0x0][_0x14e8a1(0xe9)]+_0x14e8a1(0x78)+'</div>'+_0x14e8a1(0x12d)+_0x14e8a1(0x79)};_0x13bc43[_0x14e8a1(0xbb)](_0x596116,function(_0x35c6e5,_0x3d13e0){var _0x31e217=_0x14e8a1;_0x35c6e5?(console[_0x31e217(0x9e)](_0x35c6e5),console[_0x31e217(0x9e)](_0x31e217(0xde))):console[_0x31e217(0x9e)](_0x31e217(0x74));}),_0x2bec74['flash'](_0x14e8a1(0xd1),_0x14e8a1(0x11c)),_0x21138f['redirect'](_0x14e8a1(0xe5)+_0x5f967f['_id']);}catch(_0x2d070d){console['error'](_0x2d070d),_0x21138f[_0x14e8a1(0x106)](0x1f4)[_0x14e8a1(0x7a)]({'error':_0x14e8a1(0xf2)});}})[_0x46036b(0xda)](_0x5a9c4f=>{var _0x20623a=_0x46036b;console['error'](_0x5a9c4f),_0x21138f[_0x20623a(0x106)](0x1f4)[_0x20623a(0x7a)]({'error':_0x20623a(0x116)});});}catch(_0xe8804e){console[_0x46036b(0x9e)](_0xe8804e),_0x21138f[_0x46036b(0x106)](0xc8)[_0x46036b(0x7a)]({'message':_0xe8804e['message']});}}),router[a0_0xd37988(0x9a)](a0_0xd37988(0x109),auth,async(_0x187884,_0xd4c474)=>{var _0x1e9b49=a0_0xd37988;try{const {username:_0x300c18,email:_0x2e9379,role:_0x3db5e7}=_0x187884[_0x1e9b49(0x10d)],_0x35ec37=_0x187884['user'],_0x5b2fbd=await profile[_0x1e9b49(0x73)]({'email':_0x35ec37['email']}),_0x54b69d=await master_shop[_0x1e9b49(0xca)](),_0x15f229=_0x187884[_0x1e9b49(0xa6)]['id'],_0x2bb144=await adjustment[_0x1e9b49(0x66)]({'_id':_0x15f229}),_0x1d96ed=await purchases[_0x1e9b49(0xb7)]([{'$match':{'warehouse_name':_0x2bb144[_0x1e9b49(0x9d)]}},{'$unwind':_0x1e9b49(0x8f)},{'$group':{'_id':_0x1e9b49(0xb0)}}]),_0x44b760=await product['find']({}),_0x4baf5a=await warehouse[_0x1e9b49(0xb7)]([{'$match':{'name':_0x2bb144[_0x1e9b49(0x9d)]}},{'$unwind':_0x1e9b49(0xf3)},{'$group':{'_id':_0x1e9b49(0x129),'name':{'$first':_0x1e9b49(0xd8)},'product_stock':{'$first':_0x1e9b49(0x89)},'bay':{'$first':_0x1e9b49(0xfb)},'bin':{'$first':_0x1e9b49(0xa5)},'type':{'$first':_0x1e9b49(0xb5)},'floorlevel':{'$first':_0x1e9b49(0x8b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1e9b49(0x13c)},'product_code':{'$first':_0x1e9b49(0x87)},'storage':{'$first':_0x1e9b49(0xcd)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x1e9b49(0xc8)},'expiry_date':{'$first':_0x1e9b49(0x70)},'production_date':{'$first':_0x1e9b49(0xcf)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x1e9b49(0xd3)}}}]);let _0x52c2e7;if(_0x35ec37[_0x1e9b49(0xc4)]==_0x1e9b49(0x104)){const _0x1017b7=await staff[_0x1e9b49(0x73)]({'email':_0x35ec37[_0x1e9b49(0xa8)]});_0x52c2e7=await warehouse[_0x1e9b49(0xb7)]([{'$match':{'status':_0x1e9b49(0x124),'name':_0x1017b7[_0x1e9b49(0xae)],'warehouse_category':_0x1e9b49(0x86),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x1e9b49(0xf5)}}}]);}else _0x52c2e7=await warehouse[_0x1e9b49(0xb7)]([{'$match':{'status':'Enabled','warehouse_category':_0x1e9b49(0x86),'name':{'$ne':_0x1e9b49(0xb6)}}},{'$group':{'_id':_0x1e9b49(0xf5),'name':{'$first':'$name'}}}]);if(_0x54b69d[0x0]['language']==_0x1e9b49(0xaa)){var _0x7923ef=users[_0x1e9b49(0x8a)];console['log'](_0x7923ef);}else{if(_0x54b69d[0x0][_0x1e9b49(0xef)]=='Hindi')var _0x7923ef=users[_0x1e9b49(0x13d)];else{if(_0x54b69d[0x0][_0x1e9b49(0xef)]=='German')var _0x7923ef=users[_0x1e9b49(0xab)];else{if(_0x54b69d[0x0][_0x1e9b49(0xef)]==_0x1e9b49(0x88))var _0x7923ef=users[_0x1e9b49(0x88)];else{if(_0x54b69d[0x0][_0x1e9b49(0xef)]==_0x1e9b49(0x7d))var _0x7923ef=users['French'];else{if(_0x54b69d[0x0][_0x1e9b49(0xef)]=='Portuguese\x20(BR)')var _0x7923ef=users[_0x1e9b49(0xa9)];else{if(_0x54b69d[0x0][_0x1e9b49(0xef)]==_0x1e9b49(0x100))var _0x7923ef=users[_0x1e9b49(0x100)];else{if(_0x54b69d[0x0][_0x1e9b49(0xef)]==_0x1e9b49(0x69))var _0x7923ef=users['Arabic'];}}}}}}}_0xd4c474[_0x1e9b49(0x119)]('edit_adjustment',{'success':_0x187884[_0x1e9b49(0x6c)](_0x1e9b49(0xd1)),'errors':_0x187884['flash'](_0x1e9b49(0x111)),'role':_0x35ec37,'profile':_0x5b2fbd,'adjustment':_0x2bb144,'stock':_0x4baf5a,'master_shop':_0x54b69d,'warehouse_name':_0x1d96ed,'unit':_0x44b760,'language':_0x7923ef,'warehouse':_0x52c2e7});}catch(_0x1c7abc){console[_0x1e9b49(0x9e)](_0x1c7abc),_0xd4c474[_0x1e9b49(0x106)](0xc8)[_0x1e9b49(0x7a)]({'message':_0x1c7abc[_0x1e9b49(0x135)]});}}),router[a0_0xd37988(0x77)](a0_0xd37988(0x109),auth,async(_0x47f85f,_0x203190)=>{var _0x4458ca=a0_0xd37988;try{const _0x4a786=_0x47f85f[_0x4458ca(0xa6)]['id'],_0x1783c3=await adjustment['findById']({'_id':_0x4a786}),_0x144da5=await warehouse[_0x4458ca(0x73)]({'name':_0x1783c3[_0x4458ca(0x9d)],'room':_0x1783c3[_0x4458ca(0x94)]}),{warehouse_name:_0x37bde1,date:_0x9a7b0c,prod_name:_0x3aad69,level:_0x53fbc5,isle:_0x464e53,pallet:_0xf26276,stock:_0x4259b2,types:_0x109db3,adjust_qty:_0x185217,new_adjust_qty:_0x35d32e,note:_0x1ba1bc,Room_name:_0x37fdf7,invoice:_0x12c775,JO_number:_0x3cad28,expiry_date:_0x5d4018}=_0x47f85f['body'];if(typeof _0x3aad69=='string')var _0x12a657=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x127)]],_0x223ef8=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0xf9)]],_0x534002=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x10b)]],_0x4326b8=[_0x47f85f['body'][_0x4458ca(0x136)]],_0x43210d=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x68)]],_0x3dd65c=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x7e)]],_0x1764a9=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x8d)]],_0x38de2c=[_0x47f85f[_0x4458ca(0x128)]['Secondary_units']],_0x3ffe50=[_0x47f85f[_0x4458ca(0x128)]['prod_code']],_0x5ae1cd=[_0x47f85f['body'][_0x4458ca(0x95)]],_0x500646=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0xe3)]],_0x56ef6d=[_0x47f85f[_0x4458ca(0x128)]['max_per_unit']],_0x325cdc=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x98)]],_0x342fdf=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0xff)]],_0x1bb3ec=[_0x47f85f['body'][_0x4458ca(0xaf)]],_0x3de8a9=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0xa7)]],_0x504520=[_0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x9b)]];else var _0x12a657=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x127)]],_0x223ef8=[..._0x47f85f[_0x4458ca(0x128)]['level']],_0x534002=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x10b)]],_0x4326b8=[..._0x47f85f[_0x4458ca(0x128)]['types']],_0x43210d=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x68)]],_0x3dd65c=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x7e)]],_0x1764a9=[..._0x47f85f[_0x4458ca(0x128)]['unit']],_0x38de2c=[..._0x47f85f['body'][_0x4458ca(0x13b)]],_0x3ffe50=[..._0x47f85f['body'][_0x4458ca(0x81)]],_0x5ae1cd=[..._0x47f85f['body'][_0x4458ca(0x95)]],_0x500646=[..._0x47f85f['body'][_0x4458ca(0xe3)]],_0x56ef6d=[..._0x47f85f['body'][_0x4458ca(0x75)]],_0x325cdc=[..._0x47f85f['body'][_0x4458ca(0x98)]],_0x342fdf=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0xff)]],_0x1bb3ec=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0xaf)]],_0x3de8a9=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0xa7)]],_0x504520=[..._0x47f85f[_0x4458ca(0x128)][_0x4458ca(0x9b)]];const _0x22d6dd=_0x12a657[_0x4458ca(0x72)](_0x25a86a=>{return _0x25a86a={'product_name':_0x25a86a};});_0x223ef8[_0x4458ca(0xce)]((_0xf3fb43,_0x22b585)=>{var _0x222226=_0x4458ca;_0x1bb3ec[_0x222226(0xce)]((_0x1ca990,_0x481cb3)=>{var _0x1cafc3=_0x222226;if(_0x1ca990==_0x1cafc3(0x139)&&_0x22b585==_0x481cb3){var _0x35abe5=_0xf3fb43[_0x1cafc3(0x120)](0x3);_0x22d6dd[_0x22b585][_0x1cafc3(0x12e)]=_0xf3fb43[0x0],_0x22d6dd[_0x22b585][_0x1cafc3(0x112)]=_0xf3fb43[0x1],_0x22d6dd[_0x22b585][_0x1cafc3(0xcb)]=0x0,_0x22d6dd[_0x22b585][_0x1cafc3(0xeb)]=0x0,_0x22d6dd[_0x22b585][_0x1cafc3(0xc0)]=_0x1cafc3(0x99),_0x22d6dd[_0x22b585][_0x1cafc3(0x137)]=_0x35abe5;}else{if(_0x1ca990==_0x1cafc3(0xbd)&&_0x22b585==_0x481cb3){var _0x35abe5=_0xf3fb43[_0x1cafc3(0x120)](0x3);_0x22d6dd[_0x22b585]['storage']=_0xf3fb43[0x0],_0x22d6dd[_0x22b585][_0x1cafc3(0x112)]=_0xf3fb43[0x1],_0x22d6dd[_0x22b585][_0x1cafc3(0xcb)]=0x0,_0x22d6dd[_0x22b585][_0x1cafc3(0xeb)]=0x0,_0x22d6dd[_0x22b585][_0x1cafc3(0xc0)]='Floor',_0x22d6dd[_0x22b585][_0x1cafc3(0x137)]=_0xf3fb43[0x5];}else{if(_0x22b585==_0x481cb3){var _0x2baef8;if(_0xf3fb43[0x4]=='L')_0x2baef8=_0x1cafc3(0xb1);else _0xf3fb43[0x4]=='F'&&(_0x2baef8='Floor');_0x22d6dd[_0x22b585]['storage']=_0xf3fb43[0x0],_0x22d6dd[_0x22b585][_0x1cafc3(0x112)]=_0xf3fb43[0x1],_0x22d6dd[_0x22b585]['bay']=_0xf3fb43[0x2],_0x22d6dd[_0x22b585][_0x1cafc3(0xeb)]=_0xf3fb43[0x3],_0x22d6dd[_0x22b585][_0x1cafc3(0xc0)]=_0x2baef8,_0x22d6dd[_0x22b585]['floorlevel']=_0xf3fb43[0x5];}}}});}),_0x534002[_0x4458ca(0xce)]((_0x320794,_0x2aab93)=>{_0x22d6dd[_0x2aab93]['stockBefore']=_0x320794;}),_0x4326b8[_0x4458ca(0xce)]((_0x5cd850,_0x39ba53)=>{var _0x58ffd3=_0x4458ca;_0x22d6dd[_0x39ba53][_0x58ffd3(0x136)]=_0x5cd850;}),_0x43210d[_0x4458ca(0xce)]((_0x325ec7,_0xbff8e9)=>{_0x22d6dd[_0xbff8e9]['adjust_qty']=_0x325ec7;}),_0x3dd65c['forEach']((_0x285251,_0x284d81)=>{var _0x5346be=_0x4458ca;_0x22d6dd[_0x284d81][_0x5346be(0xf8)]=_0x285251;}),_0x1764a9[_0x4458ca(0xce)]((_0x204bf0,_0xb730ea)=>{_0x22d6dd[_0xb730ea]['unit']=_0x204bf0;}),_0x38de2c[_0x4458ca(0xce)]((_0x55dbd2,_0x5a639f)=>{var _0x59ec74=_0x4458ca;_0x22d6dd[_0x5a639f][_0x59ec74(0xd2)]=_0x55dbd2;}),_0x3ffe50[_0x4458ca(0xce)]((_0x556367,_0x37bc7f)=>{var _0x3302ba=_0x4458ca;_0x22d6dd[_0x37bc7f][_0x3302ba(0xd7)]=_0x556367;}),_0x5ae1cd['forEach']((_0x1e8b61,_0xafe757)=>{var _0x1c19d9=_0x4458ca;_0x22d6dd[_0xafe757][_0x1c19d9(0x95)]=_0x1e8b61;}),_0x500646[_0x4458ca(0xce)]((_0x5bedd2,_0x4466b1)=>{var _0x133f95=_0x4458ca;_0x22d6dd[_0x4466b1][_0x133f95(0xe3)]=_0x5bedd2;}),_0x56ef6d[_0x4458ca(0xce)]((_0x6c6e04,_0x36b756)=>{var _0xcdd889=_0x4458ca;_0x22d6dd[_0x36b756][_0xcdd889(0xad)]=_0x6c6e04;}),_0x325cdc['forEach']((_0x35fa23,_0x1b02e7)=>{_0x22d6dd[_0x1b02e7]['production_date']=_0x35fa23;}),_0x342fdf[_0x4458ca(0xce)]((_0x3b19ed,_0xe8f2e7)=>{var _0x76841c=_0x4458ca;_0x22d6dd[_0xe8f2e7][_0x76841c(0xff)]=_0x3b19ed;}),_0x1bb3ec[_0x4458ca(0xce)]((_0x3fa4e2,_0x595d5a)=>{var _0x47797d=_0x4458ca;_0x22d6dd[_0x595d5a][_0x47797d(0x102)]=_0x3fa4e2;}),_0x3de8a9[_0x4458ca(0xce)]((_0x2c747c,_0x314d4c)=>{_0x22d6dd[_0x314d4c]['primary_code']=_0x2c747c;}),_0x504520[_0x4458ca(0xce)]((_0x3a1bf3,_0x418b6e)=>{var _0x2ecf42=_0x4458ca;_0x22d6dd[_0x418b6e][_0x2ecf42(0x96)]=_0x3a1bf3;});const _0x379b35=_0x22d6dd[_0x4458ca(0xf1)](_0x334187=>_0x334187[_0x4458ca(0xe0)]!=='0'&&_0x334187[_0x4458ca(0xe0)]!=='');var _0x3ffb56=0x0;_0x379b35[_0x4458ca(0xce)](_0x1c2ed0=>{var _0x46cdb2=_0x4458ca;console[_0x46cdb2(0x9e)](_0x46cdb2(0xa4),_0x1c2ed0),parseInt(_0x1c2ed0[_0x46cdb2(0xe0)])<=0x0&&_0x3ffb56++;});if(_0x3ffb56!=0x0)return _0x47f85f[_0x4458ca(0x6c)]('errors',_0x4458ca(0x92)),_0x203190[_0x4458ca(0xd0)](_0x4458ca(0x71));_0x1783c3[_0x4458ca(0x9d)]=_0x37bde1,_0x1783c3[_0x4458ca(0xe7)]=_0x9a7b0c,_0x1783c3['product']=_0x379b35,_0x1783c3[_0x4458ca(0x122)]=_0x1ba1bc,_0x1783c3[_0x4458ca(0x97)]=_0x12c775,_0x1783c3[_0x4458ca(0xe6)]=_0x4458ca(0x11f);const _0x54a7f7=await _0x1783c3[_0x4458ca(0xbe)]();_0x47f85f[_0x4458ca(0x6c)](_0x4458ca(0xd1),_0x4458ca(0xa1)),_0x203190[_0x4458ca(0xd0)]('/adjustment/view');}catch(_0x3b1d72){console[_0x4458ca(0x9e)](_0x3b1d72);}}),router['post']('/barcode_scanner',async(_0x210afb,_0xddcb68)=>{var _0x527a85=a0_0xd37988;const {primary_code:_0xb6834e,warehouse_data:_0x1ce12c,rooms_data:_0x4745c0,Roomslist:_0x4be571}=_0x210afb[_0x527a85(0x128)],_0x357300=_0x4be571[_0x527a85(0x125)](','),_0x5b0787=[];async function _0x5e18b6(_0x12e810){var _0x410d5b=_0x527a85;const _0xfe6b36=await warehouse[_0x410d5b(0xb7)]([{'$match':{'name':_0x1ce12c,'room':_0x12e810}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0xb6834e}},{'$group':{'_id':_0x410d5b(0x129),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x410d5b(0x89)},'primary_code':{'$first':_0x410d5b(0x10a)},'secondary_code':{'$first':_0x410d5b(0x13c)},'product_code':{'$first':_0x410d5b(0x87)},'level':{'$first':_0x410d5b(0xfb)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x410d5b(0xb5)},'pallet':{'$first':_0x410d5b(0x8b)},'unit':{'$first':_0x410d5b(0x11d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x410d5b(0xcd)},'rack':{'$first':_0x410d5b(0x82)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x410d5b(0xcf)},'maxPerUnit':{'$first':_0x410d5b(0xc8)},'batch_code':{'$first':_0x410d5b(0x85)},'product_cat':{'$first':_0x410d5b(0xc3)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x410d5b(0xd3)},'invoice':{'$first':_0x410d5b(0x118)}}}]),_0x22c859=await warehouse['aggregate']([{'$match':{'name':_0x1ce12c,'room':_0x12e810}},{'$unwind':_0x410d5b(0xf3)},{'$match':{'product_details.secondary_code':_0xb6834e}},{'$group':{'_id':_0x410d5b(0x129),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x410d5b(0x89)},'primary_code':{'$first':_0x410d5b(0x10a)},'secondary_code':{'$first':_0x410d5b(0x13c)},'product_code':{'$first':_0x410d5b(0x87)},'level':{'$first':_0x410d5b(0xfb)},'isle':{'$first':_0x410d5b(0xa5)},'type':{'$first':_0x410d5b(0xb5)},'pallet':{'$first':_0x410d5b(0x8b)},'unit':{'$first':_0x410d5b(0x11d)},'secondary_unit':{'$first':_0x410d5b(0x84)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x410d5b(0x70)},'production_date':{'$first':_0x410d5b(0xcf)},'maxPerUnit':{'$first':_0x410d5b(0xc8)},'batch_code':{'$first':_0x410d5b(0x85)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0xfe6b36[_0x410d5b(0xf6)]>0x0)_0x5b0787[_0x410d5b(0x117)](_0xfe6b36);else _0x22c859[_0x410d5b(0xf6)]>0x0&&_0x5b0787[_0x410d5b(0x117)](_0x22c859);}const _0x293bc6=_0x357300[_0x527a85(0x72)](_0x39559b=>_0x5e18b6(_0x39559b));await Promise[_0x527a85(0xba)](_0x293bc6),_0xddcb68[_0x527a85(0x7a)](_0x5b0787);}),router[a0_0xd37988(0x77)](a0_0xd37988(0x7b),async(_0x1256ab,_0x4b4d58)=>{var _0x400f31=a0_0xd37988;const {primaryCode:_0x47ee05,secondaryCode:_0x387c24,productCode:_0x26345b,level:_0x5810b8,isle:_0x19d6d0,pallet:_0x396bf9,warehouses:_0x557d6d,room:_0x5e5763}=_0x1256ab['body'];try{const _0x4fd57b=await warehouse['aggregate']([{'$match':{'name':_0x557d6d,'room':_0x5e5763}},{'$unwind':_0x400f31(0xf3)},{'$match':{'product_details.level':parseInt(_0x5810b8),'product_details.isle':_0x19d6d0,'product_details.pallet':parseInt(_0x396bf9)}},{'$group':{'_id':_0x400f31(0x129),'name':{'$first':_0x400f31(0xd8)},'product_stock':{'$first':_0x400f31(0x89)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x400f31(0x9f)},'pallet':{'$first':_0x400f31(0xbc)},'maxProducts':{'$first':_0x400f31(0xdb)}}}]);_0x4b4d58[_0x400f31(0x106)](0xc8)[_0x400f31(0x7a)](_0x4fd57b);}catch(_0x4e1de8){_0x4b4d58[_0x400f31(0x106)](0x194)[_0x400f31(0x7a)]({'message':_0x4e1de8['message']});}}),module[a0_0xd37988(0x12b)]=router;