var a0_0x38e597=a0_0x44cd;(function(_0x1d17c1,_0x4fd1e8){var _0xdcd00c=a0_0x44cd,_0x59a30a=_0x1d17c1();while(!![]){try{var _0x36a275=parseInt(_0xdcd00c(0x281))/0x1*(parseInt(_0xdcd00c(0x28f))/0x2)+-parseInt(_0xdcd00c(0x24e))/0x3+-parseInt(_0xdcd00c(0x277))/0x4*(parseInt(_0xdcd00c(0x2aa))/0x5)+-parseInt(_0xdcd00c(0x1f7))/0x6*(-parseInt(_0xdcd00c(0x20a))/0x7)+parseInt(_0xdcd00c(0x27d))/0x8*(-parseInt(_0xdcd00c(0x28e))/0x9)+parseInt(_0xdcd00c(0x24c))/0xa+parseInt(_0xdcd00c(0x23c))/0xb;if(_0x36a275===_0x4fd1e8)break;else _0x59a30a['push'](_0x59a30a['shift']());}catch(_0x4f9544){_0x59a30a['push'](_0x59a30a['shift']());}}}(a0_0x27cc,0xab62c));const express=require(a0_0x38e597(0x276)),app=express(),router=express['Router'](),auth=require('../middleware/auth'),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require('../models/all_models'),users=require(a0_0x38e597(0x1ed)),nodemailer=require('nodemailer');router[a0_0x38e597(0x295)](a0_0x38e597(0x211),auth,async(_0x3f14ed,_0x4e8540)=>{var _0x5a0a26=a0_0x38e597;try{const {username:_0xd3cc88,email:_0x5b9f0a,role:_0x26219c}=_0x3f14ed[_0x5a0a26(0x223)],_0x2b22be=_0x3f14ed[_0x5a0a26(0x223)],_0x2eb93c=await profile[_0x5a0a26(0x283)]({'email':_0x2b22be[_0x5a0a26(0x282)]}),_0xed7e97=await master_shop[_0x5a0a26(0x220)]();console['log']('master',_0xed7e97);let _0x2b4f2a;if(_0x2b22be[_0x5a0a26(0x21b)]==_0x5a0a26(0x29d)){const _0x3290d2=await staff[_0x5a0a26(0x283)]({'email':_0x2b22be[_0x5a0a26(0x282)]});_0x2b4f2a=await warehouse[_0x5a0a26(0x220)]({'status':_0x5a0a26(0x252),'name':_0x3290d2['warehouse']});}else _0x2b4f2a=await warehouse['find']({'status':'Enabled'});const _0x3db35f=await product[_0x5a0a26(0x220)]();let _0xc8b9e8;if(_0x2b22be[_0x5a0a26(0x21b)]==_0x5a0a26(0x29d)){const _0x1c78da=await staff[_0x5a0a26(0x283)]({'email':_0x2b22be[_0x5a0a26(0x282)]});_0xc8b9e8=await adjustment['find']({'warehouse_name':_0x1c78da[_0x5a0a26(0x286)]});}else _0xc8b9e8=await adjustment[_0x5a0a26(0x1f4)]([{'$unwind':_0x5a0a26(0x270)},{'$group':{'_id':_0x5a0a26(0x1f3),'invoice':{'$first':_0x5a0a26(0x210)},'date':{'$first':_0x5a0a26(0x237)},'warehouse_name':{'$first':_0x5a0a26(0x222)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':_0x5a0a26(0x21c)},'isAllowEdit':{'$first':_0x5a0a26(0x23d)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0xed7e97[0x0][_0x5a0a26(0x230)]==_0x5a0a26(0x25f)){var _0x5bd7d8=users['English'];console[_0x5a0a26(0x23a)](_0x5bd7d8);}else{if(_0xed7e97[0x0]['language']=='Hindi')var _0x5bd7d8=users[_0x5a0a26(0x288)];else{if(_0xed7e97[0x0][_0x5a0a26(0x230)]=='German')var _0x5bd7d8=users[_0x5a0a26(0x244)];else{if(_0xed7e97[0x0][_0x5a0a26(0x230)]==_0x5a0a26(0x29c))var _0x5bd7d8=users[_0x5a0a26(0x29c)];else{if(_0xed7e97[0x0][_0x5a0a26(0x230)]==_0x5a0a26(0x26a))var _0x5bd7d8=users[_0x5a0a26(0x26a)];else{if(_0xed7e97[0x0]['language']==_0x5a0a26(0x221))var _0x5bd7d8=users[_0x5a0a26(0x1ec)];else{if(_0xed7e97[0x0][_0x5a0a26(0x230)]==_0x5a0a26(0x1ea))var _0x5bd7d8=users[_0x5a0a26(0x1ea)];else{if(_0xed7e97[0x0][_0x5a0a26(0x230)]==_0x5a0a26(0x272))var _0x5bd7d8=users[_0x5a0a26(0x214)];}}}}}}}_0x4e8540[_0x5a0a26(0x27b)](_0x5a0a26(0x274),{'success':_0x3f14ed[_0x5a0a26(0x2a7)]('success'),'errors':_0x3f14ed[_0x5a0a26(0x2a7)](_0x5a0a26(0x247)),'role':_0x2b22be,'profile':_0x2eb93c,'warehouse':_0x2b4f2a,'product':_0x3db35f,'adjustment':_0xc8b9e8,'master_shop':_0xed7e97,'language':_0x5bd7d8});}catch(_0x29937f){console[_0x5a0a26(0x23a)](_0x29937f);}});async function getRandom8DigitNumber(){var _0x28e5ba=a0_0x38e597;const _0x45b841=0x989680,_0x3be34b=0x5f5e0ff,_0x381cff=Math[_0x28e5ba(0x235)](Math[_0x28e5ba(0x26b)]()*(_0x3be34b-_0x45b841+0x1))+_0x45b841;var _0x35457d;const _0x249350=await adjustment['findOne']({'invoice':'ADJ-'+_0x381cff});return _0x249350&&_0x249350['length']>0x0?_0x35457d=_0x28e5ba(0x261)+_0x381cff:_0x35457d='ADJ-'+_0x381cff,_0x35457d;}function a0_0x44cd(_0x8b2d33,_0x344ec8){var _0x27cc7a=a0_0x27cc();return a0_0x44cd=function(_0x44cd4b,_0x59a723){_0x44cd4b=_0x44cd4b-0x1e0;var _0x4250fa=_0x27cc7a[_0x44cd4b];return _0x4250fa;},a0_0x44cd(_0x8b2d33,_0x344ec8);}router[a0_0x38e597(0x295)](a0_0x38e597(0x284),auth,async(_0x502708,_0x12556f)=>{var _0x31c03d=a0_0x38e597;try{const {username:_0x3c7dcf,email:_0x25df06,role:_0x544d0e}=_0x502708[_0x31c03d(0x223)],_0x499aff=_0x502708[_0x31c03d(0x223)],_0x640fef=await profile[_0x31c03d(0x283)]({'email':_0x499aff[_0x31c03d(0x282)]}),_0x33b84f=await master_shop[_0x31c03d(0x220)]();let _0x3386d9;if(_0x499aff[_0x31c03d(0x21b)]==_0x31c03d(0x29d)){const _0x152e90=await staff['findOne']({'email':_0x499aff[_0x31c03d(0x282)]});_0x3386d9=await warehouse['aggregate']([{'$match':{'status':_0x31c03d(0x252),'name':_0x152e90[_0x31c03d(0x286)],'warehouse_category':_0x31c03d(0x25c),'name':{'$ne':_0x31c03d(0x208)}}},{'$group':{'_id':_0x31c03d(0x2b3),'name':{'$first':'$name'}}}]);}else _0x3386d9=await warehouse[_0x31c03d(0x1f4)]([{'$match':{'status':_0x31c03d(0x252),'warehouse_category':_0x31c03d(0x25c),'name':{'$ne':_0x31c03d(0x208)}}},{'$group':{'_id':_0x31c03d(0x2b3),'name':{'$first':_0x31c03d(0x2b3)}}}]);const _0x5c0868=await product['find']({}),_0xb0c2d1=await adjustment[_0x31c03d(0x220)]({}),_0x2635f2=_0xb0c2d1[_0x31c03d(0x213)]+0x1,_0x2570ea=_0x31c03d(0x261)+_0x2635f2['toString']()[_0x31c03d(0x204)](0x5,'0');var _0x546205=['Ambient',_0x31c03d(0x25a),_0x31c03d(0x260)];if(_0x33b84f[0x0][_0x31c03d(0x230)]==_0x31c03d(0x25f))var _0x17acbc=users[_0x31c03d(0x20f)];else{if(_0x33b84f[0x0]['language']==_0x31c03d(0x288))var _0x17acbc=users[_0x31c03d(0x288)];else{if(_0x33b84f[0x0][_0x31c03d(0x230)]==_0x31c03d(0x244))var _0x17acbc=users[_0x31c03d(0x244)];else{if(_0x33b84f[0x0][_0x31c03d(0x230)]=='Spanish')var _0x17acbc=users[_0x31c03d(0x29c)];else{if(_0x33b84f[0x0][_0x31c03d(0x230)]==_0x31c03d(0x26a))var _0x17acbc=users[_0x31c03d(0x26a)];else{if(_0x33b84f[0x0]['language']==_0x31c03d(0x221))var _0x17acbc=users['Portuguese'];else{if(_0x33b84f[0x0][_0x31c03d(0x230)]==_0x31c03d(0x1ea))var _0x17acbc=users['Chinese'];else{if(_0x33b84f[0x0][_0x31c03d(0x230)]=='Arabic\x20(ae)')var _0x17acbc=users[_0x31c03d(0x214)];}}}}}}}const _0x1ccf90=getRandom8DigitNumber();_0x1ccf90['then'](_0x47138f=>{var _0x115a9c=_0x31c03d;_0x12556f['render'](_0x115a9c(0x1e6),{'success':_0x502708[_0x115a9c(0x2a7)](_0x115a9c(0x268)),'errors':_0x502708[_0x115a9c(0x2a7)]('errors'),'role':_0x499aff,'profile':_0x640fef,'warehouse':_0x3386d9,'product':_0x5c0868,'master_shop':_0x33b84f,'language':_0x17acbc,'rooms_data':_0x546205,'invoice_no':_0x47138f});})['catch'](_0x2d6b1f=>{var _0x3a54d1=_0x31c03d;_0x502708[_0x3a54d1(0x2a7)](_0x3a54d1(0x247),_0x3a54d1(0x23f)),_0x12556f[_0x3a54d1(0x1f8)](_0x3a54d1(0x1f1));});}catch(_0x2c79e4){console[_0x31c03d(0x23a)](_0x2c79e4);}}),router[a0_0x38e597(0x246)](a0_0x38e597(0x284),auth,async(_0x3b84bd,_0xc2a783)=>{var _0x33ac23=a0_0x38e597;try{const {warehouse_name:_0x19e847,date:_0x2851dd,prod_name:_0x7c5ef4,level:_0x5bf6cf,isle:_0x157216,pallet:_0x4df5b8,stock:_0x30f807,types:_0x5bc71c,adjust_qty:_0x30cbd2,new_adjust_qty:_0xafb306,note:_0x429591,Room_name:_0x3d63cf,invoice:_0x56b51d,JO_number:_0x1d232a,expiry_date:_0x2007eb}=_0x3b84bd['body'];if(typeof _0x7c5ef4==_0x33ac23(0x2a0))var _0x20d534=[_0x3b84bd[_0x33ac23(0x251)]['prod_name']],_0x4a2a7b=[_0x3b84bd['body'][_0x33ac23(0x1f2)]],_0x3a7d72=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x229)]],_0x362db6=[_0x3b84bd['body'][_0x33ac23(0x1e1)]],_0x13e859=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x271)]],_0x565b55=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x257)]],_0x4cbed9=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x26c)]],_0x11d931=[_0x3b84bd['body'][_0x33ac23(0x233)]],_0x1c62ba=[_0x3b84bd['body'][_0x33ac23(0x28d)]],_0x1870cf=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x27e)]],_0xc46f16=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x241)]],_0x1ed0f2=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x25e)]],_0x4fd165=[_0x3b84bd['body'][_0x33ac23(0x297)]],_0x1a24bf=[_0x3b84bd[_0x33ac23(0x251)]['prod_cat']],_0x5de5a2=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x1fe)]],_0x4faa5d=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x2b2)]],_0x5b4a4a=[_0x3b84bd['body'][_0x33ac23(0x28c)]],_0x13bced=[_0x3b84bd['body'][_0x33ac23(0x27f)]],_0x3e1f2e=[_0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x280)]];else var _0x20d534=[..._0x3b84bd[_0x33ac23(0x251)]['prod_name']],_0x4a2a7b=[..._0x3b84bd['body'][_0x33ac23(0x1f2)]],_0x3a7d72=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x229)]],_0x362db6=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x1e1)]],_0x13e859=[..._0x3b84bd[_0x33ac23(0x251)]['New_Qty_Converted_adj']],_0x565b55=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x257)]],_0x4cbed9=[..._0x3b84bd['body'][_0x33ac23(0x256)]],_0x11d931=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x233)]],_0x1c62ba=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x28d)]],_0x1870cf=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x27e)]],_0xc46f16=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x241)]],_0x1ed0f2=[..._0x3b84bd[_0x33ac23(0x251)]['max_per_unit']],_0x4fd165=[..._0x3b84bd[_0x33ac23(0x251)]['production_date']],_0x1a24bf=[..._0x3b84bd['body']['prod_cat']],_0x5de5a2=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x1fe)]],_0x4faa5d=[..._0x3b84bd['body'][_0x33ac23(0x2b2)]],_0x5b4a4a=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x28c)]],_0x13bced=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x27f)]],_0x3e1f2e=[..._0x3b84bd[_0x33ac23(0x251)][_0x33ac23(0x280)]];const _0x5dc1b9=_0x20d534[_0x33ac23(0x1ff)](_0x502ea3=>{return _0x502ea3={'product_name':_0x502ea3};});_0x4a2a7b[_0x33ac23(0x1ef)]((_0x245fc6,_0x51d328)=>{var _0x5a669b=_0x33ac23;_0x5de5a2[_0x5a669b(0x1ef)]((_0x4fbd1b,_0x548d58)=>{var _0x10ffcf=_0x5a669b;if(_0x4fbd1b==_0x10ffcf(0x1eb)&&_0x51d328==_0x548d58){var _0x5405dc=_0x245fc6['slice'](0x3);_0x5dc1b9[_0x51d328][_0x10ffcf(0x2b8)]=_0x245fc6[0x0],_0x5dc1b9[_0x51d328][_0x10ffcf(0x1e2)]=_0x245fc6[0x1],_0x5dc1b9[_0x51d328][_0x10ffcf(0x269)]=0x0,_0x5dc1b9[_0x51d328][_0x10ffcf(0x291)]=0x0,_0x5dc1b9[_0x51d328][_0x10ffcf(0x2a3)]='Floor',_0x5dc1b9[_0x51d328][_0x10ffcf(0x1f6)]=_0x5405dc;}else{if(_0x4fbd1b=='Shelves'&&_0x51d328==_0x548d58){var _0x5405dc=_0x245fc6[_0x10ffcf(0x212)](0x3);_0x5dc1b9[_0x51d328][_0x10ffcf(0x2b8)]=_0x245fc6[0x0],_0x5dc1b9[_0x51d328][_0x10ffcf(0x1e2)]=_0x245fc6[0x1],_0x5dc1b9[_0x51d328][_0x10ffcf(0x269)]=0x0,_0x5dc1b9[_0x51d328][_0x10ffcf(0x291)]=0x0,_0x5dc1b9[_0x51d328][_0x10ffcf(0x2a3)]=_0x10ffcf(0x22d),_0x5dc1b9[_0x51d328][_0x10ffcf(0x1f6)]=_0x245fc6[0x5];}else{if(_0x51d328==_0x548d58){var _0x2e8960;if(_0x245fc6[0x4]=='L')_0x2e8960=_0x10ffcf(0x20c);else _0x245fc6[0x4]=='F'&&(_0x2e8960='Floor');_0x5dc1b9[_0x51d328][_0x10ffcf(0x2b8)]=_0x245fc6[0x0],_0x5dc1b9[_0x51d328][_0x10ffcf(0x1e2)]=_0x245fc6[0x1],_0x5dc1b9[_0x51d328][_0x10ffcf(0x269)]=_0x245fc6[0x2],_0x5dc1b9[_0x51d328][_0x10ffcf(0x291)]=_0x245fc6[0x3],_0x5dc1b9[_0x51d328][_0x10ffcf(0x2a3)]=_0x2e8960,_0x5dc1b9[_0x51d328][_0x10ffcf(0x1f6)]=_0x245fc6[0x5];}}}});}),_0x3a7d72[_0x33ac23(0x1ef)]((_0x347fa5,_0x31f3f9)=>{_0x5dc1b9[_0x31f3f9]['stockBefore']=_0x347fa5;}),_0x3e1f2e[_0x33ac23(0x1ef)]((_0x1fbbfc,_0x59edde)=>{var _0x4155f8=_0x33ac23;_0x5dc1b9[_0x59edde][_0x4155f8(0x2ae)]=_0x1fbbfc;}),_0x362db6[_0x33ac23(0x1ef)]((_0x7f7d8d,_0x2901da)=>{var _0x5628ab=_0x33ac23;_0x5dc1b9[_0x2901da][_0x5628ab(0x1e1)]=_0x7f7d8d;}),_0x13e859['forEach']((_0x9c1829,_0x30f43c)=>{_0x5dc1b9[_0x30f43c]['adjust_qty']=_0x9c1829;}),_0x565b55['forEach']((_0x261514,_0x3fe23e)=>{_0x5dc1b9[_0x3fe23e]['new_adjust_qty']=_0x261514;}),_0x4cbed9[_0x33ac23(0x1ef)]((_0x42b158,_0x4f3349)=>{var _0x389f83=_0x33ac23;_0x5dc1b9[_0x4f3349][_0x389f83(0x256)]=_0x42b158;}),_0x11d931['forEach']((_0x5cc711,_0xa13310)=>{var _0x3059ed=_0x33ac23;_0x5dc1b9[_0xa13310][_0x3059ed(0x2a2)]=_0x5cc711;}),_0x1c62ba[_0x33ac23(0x1ef)]((_0x340d18,_0xdbfcc5)=>{var _0xeb7ab3=_0x33ac23;_0x5dc1b9[_0xdbfcc5][_0xeb7ab3(0x227)]=_0x340d18;}),_0x1870cf[_0x33ac23(0x1ef)]((_0x131c4c,_0xf82de4)=>{var _0x43bb1e=_0x33ac23;_0x5dc1b9[_0xf82de4][_0x43bb1e(0x27e)]=_0x131c4c;}),_0xc46f16[_0x33ac23(0x1ef)]((_0x208e8d,_0x2a6ff1)=>{var _0x2cdcfd=_0x33ac23;_0x5dc1b9[_0x2a6ff1][_0x2cdcfd(0x241)]=_0x208e8d;}),_0x1ed0f2[_0x33ac23(0x1ef)]((_0x3117ce,_0x4ff0e2)=>{_0x5dc1b9[_0x4ff0e2]['maxperunit']=_0x3117ce;}),_0x4fd165[_0x33ac23(0x1ef)]((_0xfaa4dd,_0x44f466)=>{var _0xf4b543=_0x33ac23;_0x5dc1b9[_0x44f466][_0xf4b543(0x297)]=_0xfaa4dd;}),_0x1a24bf['forEach']((_0x522556,_0x4a52c8)=>{var _0x644830=_0x33ac23;_0x5dc1b9[_0x4a52c8][_0x644830(0x29a)]=_0x522556;}),_0x5de5a2[_0x33ac23(0x1ef)]((_0x58e47b,_0xfff89b)=>{var _0x3201f3=_0x33ac23;_0x5dc1b9[_0xfff89b][_0x3201f3(0x243)]=_0x58e47b;}),_0x4faa5d[_0x33ac23(0x1ef)]((_0x213bbc,_0x192762)=>{_0x5dc1b9[_0x192762]['primary_code']=_0x213bbc;}),_0x5b4a4a[_0x33ac23(0x1ef)]((_0x4d1eb1,_0x3b3e2e)=>{var _0x1014d0=_0x33ac23;_0x5dc1b9[_0x3b3e2e][_0x1014d0(0x279)]=_0x4d1eb1;}),_0x13bced['forEach']((_0x3ed03b,_0x240832)=>{_0x5dc1b9[_0x240832]['invoice']=_0x3ed03b;});const _0x7c677b=_0x5dc1b9[_0x33ac23(0x1fa)](_0x2818ba=>_0x2818ba[_0x33ac23(0x206)]!=='0'&&_0x2818ba['adjust_qty']!=='');var _0x522b0a=0x0;_0x7c677b[_0x33ac23(0x1ef)](_0x22d19b=>{var _0x15c806=_0x33ac23;console[_0x15c806(0x23a)]('foreach\x20newproduct',_0x22d19b),parseInt(_0x22d19b[_0x15c806(0x206)])<=0x0&&_0x522b0a++;});if(_0x522b0a!=0x0)return _0x3b84bd[_0x33ac23(0x2a7)](_0x33ac23(0x247),_0x33ac23(0x1e9)),_0xc2a783[_0x33ac23(0x1f8)](_0x33ac23(0x219));const _0x26a0a5=new adjustment({'warehouse_name':_0x19e847,'date':_0x2851dd,'product':_0x7c677b,'note':_0x429591,'room':_0x3d63cf,'invoice':_0x56b51d,'JO_number':_0x1d232a,'expiry_date':_0x2007eb}),_0x11ca95=await _0x26a0a5[_0x33ac23(0x22b)]();_0x3b84bd[_0x33ac23(0x2a7)](_0x33ac23(0x268),_0x33ac23(0x1fc)),_0xc2a783[_0x33ac23(0x1f8)](_0x33ac23(0x258)+_0x11ca95['_id']);}catch(_0x51dcb1){console[_0x33ac23(0x23a)](_0x51dcb1),_0xc2a783[_0x33ac23(0x1fb)](0xc8)[_0x33ac23(0x25b)]({'message':_0x51dcb1[_0x33ac23(0x29b)]});}}),router[a0_0x38e597(0x295)](a0_0x38e597(0x238),auth,async(_0x977f5a,_0x46cc23)=>{var _0x245cac=a0_0x38e597;try{const {username:_0x259266,email:_0x48ff59,role:_0x40e039}=_0x977f5a['user'],_0x3db564=_0x977f5a[_0x245cac(0x223)],_0x13fec1=await profile[_0x245cac(0x283)]({'email':_0x3db564[_0x245cac(0x282)]}),_0x5b5036=await master_shop['find'](),_0xa617cb=_0x977f5a[_0x245cac(0x242)]['id'],_0x1dc93a=await adjustment[_0x245cac(0x293)]({'_id':_0xa617cb}),_0x15a053=await purchases['aggregate']([{'$match':{'warehouse_name':_0x1dc93a['warehouse_name']}},{'$unwind':_0x245cac(0x270)},{'$group':{'_id':_0x245cac(0x253)}}]),_0x3c3787=await product[_0x245cac(0x220)]({}),_0x518480=await warehouse[_0x245cac(0x1f4)]([{'$match':{'name':_0x1dc93a[_0x245cac(0x285)]}},{'$unwind':_0x245cac(0x264)},{'$group':{'_id':_0x245cac(0x24b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x245cac(0x1e5)},'bay':{'$first':_0x245cac(0x2b0)},'bin':{'$first':_0x245cac(0x298)},'type':{'$first':_0x245cac(0x245)},'floorlevel':{'$first':_0x245cac(0x26d)},'primary_code':{'$first':_0x245cac(0x29e)},'secondary_code':{'$first':_0x245cac(0x294)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x245cac(0x24d)},'rack':{'$first':_0x245cac(0x207)},'maxPerUnit':{'$first':_0x245cac(0x232)},'expiry_date':{'$first':_0x245cac(0x29f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x245cac(0x1e3)},'room':{'$first':'$room'}}}]);if(_0x5b5036[0x0][_0x245cac(0x230)]==_0x245cac(0x25f)){var _0x771c5b=users[_0x245cac(0x20f)];console['log'](_0x771c5b);}else{if(_0x5b5036[0x0][_0x245cac(0x230)]==_0x245cac(0x288))var _0x771c5b=users['Hindi'];else{if(_0x5b5036[0x0][_0x245cac(0x230)]==_0x245cac(0x244))var _0x771c5b=users['German'];else{if(_0x5b5036[0x0][_0x245cac(0x230)]==_0x245cac(0x29c))var _0x771c5b=users[_0x245cac(0x29c)];else{if(_0x5b5036[0x0]['language']==_0x245cac(0x26a))var _0x771c5b=users[_0x245cac(0x26a)];else{if(_0x5b5036[0x0][_0x245cac(0x230)]==_0x245cac(0x221))var _0x771c5b=users['Portuguese'];else{if(_0x5b5036[0x0][_0x245cac(0x230)]=='Chinese')var _0x771c5b=users[_0x245cac(0x1ea)];else{if(_0x5b5036[0x0][_0x245cac(0x230)]==_0x245cac(0x272))var _0x771c5b=users[_0x245cac(0x214)];}}}}}}}_0x46cc23[_0x245cac(0x27b)]('edit_adjustment_view',{'success':_0x977f5a[_0x245cac(0x2a7)](_0x245cac(0x268)),'errors':_0x977f5a[_0x245cac(0x2a7)](_0x245cac(0x247)),'role':_0x3db564,'profile':_0x13fec1,'adjustment':_0x1dc93a,'stock':_0x518480,'master_shop':_0x5b5036,'warehouse_name':_0x15a053,'unit':_0x3c3787,'language':_0x771c5b});}catch(_0x1cbb12){console[_0x245cac(0x23a)](_0x1cbb12),_0x46cc23[_0x245cac(0x1fb)](0xc8)[_0x245cac(0x25b)]({'message':_0x1cbb12['message']});}}),router[a0_0x38e597(0x246)](a0_0x38e597(0x238),auth,async(_0xd2c451,_0x4712ed)=>{var _0x420b6c=a0_0x38e597;try{const _0x5c6d4e=_0xd2c451['params']['id'],{warehouse_name:_0x25803d,Room_name:_0x1c874a}=_0xd2c451[_0x420b6c(0x251)],_0xc8f29=await adjustment[_0x420b6c(0x293)]({'_id':_0x5c6d4e}),_0x1c51ee=_0xc8f29[_0x420b6c(0x299)][_0x420b6c(0x1ff)](async _0x568c60=>{var _0x4b7d8f=_0x420b6c;if(_0x568c60[_0x4b7d8f(0x206)]>0x0){var _0x1a1d41=await warehouse[_0x4b7d8f(0x283)]({'name':_0x25803d,'room':_0x568c60[_0x4b7d8f(0x243)],'warehouse_category':_0x4b7d8f(0x25c)});const _0x7a7bb6=_0x1a1d41[_0x4b7d8f(0x26f)][_0x4b7d8f(0x1ff)](_0x4bcfe1=>{var _0x227df6=_0x4b7d8f;if(_0x568c60[_0x227df6(0x2a3)]==_0x227df6(0x203)){if(_0x4bcfe1[_0x227df6(0x262)]==_0x568c60[_0x227df6(0x262)]&&_0x4bcfe1[_0x227df6(0x1f6)]==_0x568c60['floorlevel']&&_0x4bcfe1[_0x227df6(0x2a3)]==_0x568c60['type']&&_0x4bcfe1[_0x227df6(0x291)]==_0x568c60[_0x227df6(0x291)]&&_0x4bcfe1[_0x227df6(0x269)]==_0x568c60['bay']&&_0x4bcfe1[_0x227df6(0x1e2)]==_0x568c60[_0x227df6(0x1e2)]&&_0x4bcfe1[_0x227df6(0x2b8)]==_0x568c60[_0x227df6(0x2b8)]&&_0x4bcfe1[_0x227df6(0x241)]==_0x568c60['expiry_date']&&_0x4bcfe1[_0x227df6(0x27e)]==_0x568c60[_0x227df6(0x27e)]&&_0x4bcfe1[_0x227df6(0x297)]==_0x568c60[_0x227df6(0x297)]&&_0x4bcfe1['invoice']==_0x568c60[_0x227df6(0x2a4)]&&_0x4bcfe1[_0x227df6(0x2ad)]==_0x568c60['id_transaction_from']){var _0x578a2a;_0x578a2a=_0x568c60[_0x227df6(0x206)],_0x568c60[_0x227df6(0x29a)]=='S'&&(_0x578a2a=_0x568c60[_0x227df6(0x206)]),_0x4bcfe1[_0x227df6(0x28a)]=_0x4bcfe1['product_stock']-_0x578a2a;}}else{if(_0x4bcfe1[_0x227df6(0x262)]==_0x568c60[_0x227df6(0x262)]&&_0x4bcfe1['floorlevel']==_0x568c60[_0x227df6(0x1f6)]&&_0x4bcfe1[_0x227df6(0x2a3)]==_0x568c60[_0x227df6(0x2a3)]&&_0x4bcfe1[_0x227df6(0x291)]==_0x568c60[_0x227df6(0x291)]&&_0x4bcfe1[_0x227df6(0x269)]==_0x568c60['bay']&&_0x4bcfe1[_0x227df6(0x1e2)]==_0x568c60[_0x227df6(0x1e2)]&&_0x4bcfe1[_0x227df6(0x2b8)]==_0x568c60['storage']&&_0x4bcfe1[_0x227df6(0x241)]==_0x568c60[_0x227df6(0x241)]&&_0x4bcfe1[_0x227df6(0x27e)]==_0x568c60['batch_code']&&_0x4bcfe1[_0x227df6(0x297)]==_0x568c60['production_date']&&_0x4bcfe1['invoice']==_0x568c60[_0x227df6(0x2a4)]&&_0x4bcfe1[_0x227df6(0x2ad)]==_0x568c60[_0x227df6(0x2ae)]){console[_0x227df6(0x23a)](_0x568c60);var _0x578a2a;_0x578a2a=_0x568c60[_0x227df6(0x206)],_0x568c60['prod_cat']=='S'&&(_0x578a2a=_0x568c60[_0x227df6(0x206)]),console[_0x227df6(0x23a)](_0x578a2a+'\x20<>\x20'+_0x568c60['adjust_qty']+_0x227df6(0x21a)+_0x4bcfe1[_0x227df6(0x1ee)]+_0x227df6(0x21a)+_0x568c60[_0x227df6(0x29a)]),_0x4bcfe1[_0x227df6(0x28a)]=_0x4bcfe1['product_stock']+_0x578a2a;}}});}return _0x1a1d41;});Promise[_0x420b6c(0x292)](_0x1c51ee)[_0x420b6c(0x263)](async _0x44ced0=>{var _0x4a6915=_0x420b6c;try{for(const _0xa1e4 of _0x44ced0){await _0xa1e4[_0x4a6915(0x22b)]();}_0xc8f29[_0x4a6915(0x1e8)]=_0x4a6915(0x236);const _0x57b7ae=await _0xc8f29['save'](),_0x51640f=await master_shop[_0x4a6915(0x220)](),_0x183928=await email_settings[_0x4a6915(0x283)](),_0x28f0a5=await supervisor_settings[_0x4a6915(0x220)]();var _0x39d3ac=_0xc8f29[_0x4a6915(0x299)],_0x478617='',_0x31211c;for(_0x31211c in _0x39d3ac){_0x478617+=_0x4a6915(0x1e7)+_0x4a6915(0x202)+_0x39d3ac[_0x31211c][_0x4a6915(0x262)]+_0x4a6915(0x240)+_0x4a6915(0x202)+_0x39d3ac[_0x31211c][_0x4a6915(0x227)]+_0x4a6915(0x240)+_0x4a6915(0x202)+_0x39d3ac[_0x31211c]['adjust_qty']+'</td>'+_0x4a6915(0x202)+_0x39d3ac[_0x31211c]['unit']+_0x4a6915(0x240)+_0x4a6915(0x202)+_0x39d3ac[_0x31211c][_0x4a6915(0x2a2)]+_0x4a6915(0x240)+_0x4a6915(0x202)+_0xc8f29['warehouse_name']+_0x4a6915(0x240)+_0x4a6915(0x202)+_0x39d3ac[_0x31211c][_0x4a6915(0x243)]+_0x4a6915(0x240)+_0x4a6915(0x202)+_0x39d3ac[_0x31211c][_0x4a6915(0x2b8)]+_0x39d3ac[_0x31211c][_0x4a6915(0x1e2)]+_0x39d3ac[_0x31211c]['bay']+_0x39d3ac[_0x31211c][_0x4a6915(0x291)]+_0x39d3ac[_0x31211c][_0x4a6915(0x2a3)][0x0]+_0x39d3ac[_0x31211c]['floorlevel']+_0x4a6915(0x240),_0x4a6915(0x2a1);}let _0x2d03cb=nodemailer[_0x4a6915(0x22c)]({'host':_0x183928['host'],'port':Number(_0x183928[_0x4a6915(0x2a5)]),'secure':![],'auth':{'user':_0x183928['email'],'pass':_0x183928[_0x4a6915(0x25d)]}}),_0x231d8d={'from':_0x183928[_0x4a6915(0x282)],'to':_0x28f0a5[0x0][_0x4a6915(0x205)],'subject':'Adjustment\x20Mail','attachments':[{'filename':_0x4a6915(0x249),'path':__dirname+_0x4a6915(0x24a)+_0x4a6915(0x28b)+_0x51640f[0x0][_0x4a6915(0x209)],'cid':_0x4a6915(0x20b)}],'html':_0x4a6915(0x248)+_0x4a6915(0x224)+_0x4a6915(0x231)+_0x4a6915(0x226)+_0x4a6915(0x250)+_0x4a6915(0x226)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x4a6915(0x23e)+_0x4a6915(0x226)+'<h2>\x20'+_0x51640f[0x0]['site_title']+_0x4a6915(0x215)+_0x4a6915(0x23e)+_0x4a6915(0x23e)+_0x4a6915(0x2af)+'<div>'+_0x4a6915(0x259)+'\x20Order\x20Number\x20:\x20'+_0xc8f29[_0x4a6915(0x2a4)]+'\x20'+_0x4a6915(0x239)+_0x4a6915(0x234)+_0xc8f29[_0x4a6915(0x2ab)]+'\x20'+'</span>'+_0x4a6915(0x254)+'</div>'+_0x4a6915(0x2a9)+_0x4a6915(0x23b)+_0x4a6915(0x1e7)+_0x4a6915(0x22f)+_0x4a6915(0x27a)+_0x4a6915(0x27c)+_0x4a6915(0x255)+_0x4a6915(0x20e)+_0x4a6915(0x278)+_0x4a6915(0x2a6)+_0x4a6915(0x2b4)+_0x4a6915(0x2a1)+'</thead>'+_0x4a6915(0x273)+'\x20'+_0x478617+'\x20'+_0x4a6915(0x22e)+_0x4a6915(0x228)+_0x4a6915(0x226)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x51640f[0x0][_0x4a6915(0x1e0)]+_0x4a6915(0x254)+_0x4a6915(0x23e)+'</div>'+'</body></html>'};_0x2d03cb['sendMail'](_0x231d8d,function(_0x1ccc64,_0x30b67f){var _0x51fb5e=_0x4a6915;_0x1ccc64?(console[_0x51fb5e(0x23a)](_0x1ccc64),console['log'](_0x51fb5e(0x287))):console['log'](_0x51fb5e(0x201));}),_0xd2c451[_0x4a6915(0x2a7)]('success','adjustment\x20Finalized\x20successfully'),_0x4712ed[_0x4a6915(0x1f8)](_0x4a6915(0x20d)+_0x57b7ae[_0x4a6915(0x2ad)]);}catch(_0x31af05){console[_0x4a6915(0x265)](_0x31af05),_0x4712ed[_0x4a6915(0x1fb)](0x1f4)[_0x4a6915(0x25b)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x420b6c(0x216)](_0xa797=>{var _0xd86c8a=_0x420b6c;console[_0xd86c8a(0x265)](_0xa797),_0x4712ed[_0xd86c8a(0x1fb)](0x1f4)['json']({'error':_0xd86c8a(0x1fd)});});}catch(_0x3e58a0){console[_0x420b6c(0x23a)](_0x3e58a0),_0x4712ed[_0x420b6c(0x1fb)](0xc8)[_0x420b6c(0x25b)]({'message':_0x3e58a0[_0x420b6c(0x29b)]});}}),router[a0_0x38e597(0x295)]('/view/:id',auth,async(_0x57dbe9,_0x3bb9e7)=>{var _0xf6e18b=a0_0x38e597;try{const {username:_0x65a66b,email:_0x45a8a5,role:_0x456529}=_0x57dbe9[_0xf6e18b(0x223)],_0x36a579=_0x57dbe9[_0xf6e18b(0x223)],_0x4d16bd=await profile[_0xf6e18b(0x283)]({'email':_0x36a579[_0xf6e18b(0x282)]}),_0x384c9b=await master_shop[_0xf6e18b(0x220)](),_0x1b7351=_0x57dbe9['params']['id'],_0x2979cf=await adjustment[_0xf6e18b(0x293)]({'_id':_0x1b7351}),_0x12ad26=await purchases[_0xf6e18b(0x1f4)]([{'$match':{'warehouse_name':_0x2979cf[_0xf6e18b(0x285)]}},{'$unwind':_0xf6e18b(0x270)},{'$group':{'_id':'$product.product_name'}}]),_0x5cde73=await product[_0xf6e18b(0x220)]({}),_0x272e22=await warehouse[_0xf6e18b(0x1f4)]([{'$match':{'name':_0x2979cf[_0xf6e18b(0x285)]}},{'$unwind':_0xf6e18b(0x264)},{'$group':{'_id':'$product_details._id','name':{'$first':_0xf6e18b(0x218)},'product_stock':{'$first':_0xf6e18b(0x1e5)},'bay':{'$first':_0xf6e18b(0x2b0)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xf6e18b(0x245)},'floorlevel':{'$first':_0xf6e18b(0x26d)},'primary_code':{'$first':_0xf6e18b(0x29e)},'secondary_code':{'$first':_0xf6e18b(0x294)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xf6e18b(0x207)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0xf6e18b(0x29f)},'production_date':{'$first':_0xf6e18b(0x289)},'batch_code':{'$first':_0xf6e18b(0x1e3)},'room':{'$first':_0xf6e18b(0x2b5)}}}]);let _0x388bda;if(_0x36a579[_0xf6e18b(0x21b)]==_0xf6e18b(0x29d)){const _0x46c351=await staff[_0xf6e18b(0x283)]({'email':_0x36a579['email']});_0x388bda=await warehouse[_0xf6e18b(0x1f4)]([{'$match':{'status':_0xf6e18b(0x252),'name':_0x46c351[_0xf6e18b(0x286)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xf6e18b(0x208)}}},{'$group':{'_id':'$name','name':{'$first':_0xf6e18b(0x2b3)}}}]);}else _0x388bda=await warehouse['aggregate']([{'$match':{'status':_0xf6e18b(0x252),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xf6e18b(0x208)}}},{'$group':{'_id':_0xf6e18b(0x2b3),'name':{'$first':_0xf6e18b(0x2b3)}}}]);if(_0x384c9b[0x0][_0xf6e18b(0x230)]==_0xf6e18b(0x25f)){var _0xa19634=users[_0xf6e18b(0x20f)];console[_0xf6e18b(0x23a)](_0xa19634);}else{if(_0x384c9b[0x0][_0xf6e18b(0x230)]==_0xf6e18b(0x288))var _0xa19634=users[_0xf6e18b(0x288)];else{if(_0x384c9b[0x0][_0xf6e18b(0x230)]==_0xf6e18b(0x244))var _0xa19634=users[_0xf6e18b(0x244)];else{if(_0x384c9b[0x0][_0xf6e18b(0x230)]=='Spanish')var _0xa19634=users[_0xf6e18b(0x29c)];else{if(_0x384c9b[0x0][_0xf6e18b(0x230)]==_0xf6e18b(0x26a))var _0xa19634=users[_0xf6e18b(0x26a)];else{if(_0x384c9b[0x0]['language']==_0xf6e18b(0x221))var _0xa19634=users['Portuguese'];else{if(_0x384c9b[0x0][_0xf6e18b(0x230)]==_0xf6e18b(0x1ea))var _0xa19634=users[_0xf6e18b(0x1ea)];else{if(_0x384c9b[0x0]['language']==_0xf6e18b(0x272))var _0xa19634=users[_0xf6e18b(0x214)];}}}}}}}_0x3bb9e7[_0xf6e18b(0x27b)](_0xf6e18b(0x290),{'success':_0x57dbe9[_0xf6e18b(0x2a7)](_0xf6e18b(0x268)),'errors':_0x57dbe9[_0xf6e18b(0x2a7)](_0xf6e18b(0x247)),'role':_0x36a579,'profile':_0x4d16bd,'adjustment':_0x2979cf,'stock':_0x272e22,'master_shop':_0x384c9b,'warehouse_name':_0x12ad26,'unit':_0x5cde73,'language':_0xa19634,'warehouse':_0x388bda});}catch(_0x5945f0){console[_0xf6e18b(0x23a)](_0x5945f0),_0x3bb9e7['status'](0xc8)[_0xf6e18b(0x25b)]({'message':_0x5945f0[_0xf6e18b(0x29b)]});}}),router[a0_0x38e597(0x246)]('/view/:id',auth,async(_0x2823c5,_0x20d980)=>{var _0x5e1324=a0_0x38e597;try{const _0x29090f=_0x2823c5[_0x5e1324(0x242)]['id'],_0x64b8a2=await adjustment[_0x5e1324(0x293)]({'_id':_0x29090f}),_0x1f0faa=await warehouse['findOne']({'name':_0x64b8a2[_0x5e1324(0x285)],'room':_0x64b8a2[_0x5e1324(0x21d)]}),{warehouse_name:_0x37e41b,date:_0x22d6d8,prod_name:_0x21c403,level:_0x30c298,isle:_0x443684,pallet:_0x544dec,stock:_0x3dd9e5,types:_0x64552,adjust_qty:_0x3af03b,new_adjust_qty:_0x347faf,note:_0x4af1ab,Room_name:_0x287693,invoice:_0x2ef29e,JO_number:_0x5dcfc3,expiry_date:_0x48166}=_0x2823c5[_0x5e1324(0x251)];if(typeof _0x21c403==_0x5e1324(0x2a0))var _0x45927d=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x24f)]],_0xaad977=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x1f2)]],_0xef848e=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x229)]],_0x293abb=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x1e1)]],_0x211124=[_0x2823c5['body'][_0x5e1324(0x271)]],_0x536f34=[_0x2823c5['body'][_0x5e1324(0x257)]],_0x170169=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x26c)]],_0x48aef8=[_0x2823c5['body'][_0x5e1324(0x233)]],_0x59b8b=[_0x2823c5['body'][_0x5e1324(0x28d)]],_0x574777=[_0x2823c5['body'][_0x5e1324(0x27e)]],_0x285cef=[_0x2823c5['body'][_0x5e1324(0x241)]],_0x1c0d04=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x25e)]],_0x491b11=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x297)]],_0x573245=[_0x2823c5['body'][_0x5e1324(0x29a)]],_0xdbc161=[_0x2823c5[_0x5e1324(0x251)]['Rooms']],_0x5a71ce=[_0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x2b2)]],_0x2d3b20=[_0x2823c5['body'][_0x5e1324(0x28c)]];else var _0x45927d=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x24f)]],_0xaad977=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x1f2)]],_0xef848e=[..._0x2823c5[_0x5e1324(0x251)]['stock']],_0x293abb=[..._0x2823c5['body']['types']],_0x211124=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x271)]],_0x536f34=[..._0x2823c5['body'][_0x5e1324(0x257)]],_0x170169=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x256)]],_0x48aef8=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x233)]],_0x59b8b=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x28d)]],_0x574777=[..._0x2823c5['body'][_0x5e1324(0x27e)]],_0x285cef=[..._0x2823c5['body'][_0x5e1324(0x241)]],_0x1c0d04=[..._0x2823c5[_0x5e1324(0x251)]['max_per_unit']],_0x491b11=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x297)]],_0x573245=[..._0x2823c5['body']['prod_cat']],_0xdbc161=[..._0x2823c5[_0x5e1324(0x251)][_0x5e1324(0x1fe)]],_0x5a71ce=[..._0x2823c5[_0x5e1324(0x251)]['prime1']],_0x2d3b20=[..._0x2823c5['body'][_0x5e1324(0x28c)]];const _0x4b4fd5=_0x45927d['map'](_0x1ebbba=>{return _0x1ebbba={'product_name':_0x1ebbba};});_0xaad977['forEach']((_0x5be133,_0x2cb33f)=>{var _0x39eea9=_0x5e1324;_0xdbc161[_0x39eea9(0x1ef)]((_0x2cb894,_0x40d2af)=>{var _0xaddb65=_0x39eea9;if(_0x2cb894==_0xaddb65(0x1eb)&&_0x2cb33f==_0x40d2af){var _0x22bf16=_0x5be133[_0xaddb65(0x212)](0x3);_0x4b4fd5[_0x2cb33f][_0xaddb65(0x2b8)]=_0x5be133[0x0],_0x4b4fd5[_0x2cb33f][_0xaddb65(0x1e2)]=_0x5be133[0x1],_0x4b4fd5[_0x2cb33f]['bay']=0x0,_0x4b4fd5[_0x2cb33f][_0xaddb65(0x291)]=0x0,_0x4b4fd5[_0x2cb33f][_0xaddb65(0x2a3)]=_0xaddb65(0x22d),_0x4b4fd5[_0x2cb33f][_0xaddb65(0x1f6)]=_0x22bf16;}else{if(_0x2cb894==_0xaddb65(0x266)&&_0x2cb33f==_0x40d2af){var _0x22bf16=_0x5be133['slice'](0x3);_0x4b4fd5[_0x2cb33f][_0xaddb65(0x2b8)]=_0x5be133[0x0],_0x4b4fd5[_0x2cb33f][_0xaddb65(0x1e2)]=_0x5be133[0x1],_0x4b4fd5[_0x2cb33f][_0xaddb65(0x269)]=0x0,_0x4b4fd5[_0x2cb33f]['bin']=0x0,_0x4b4fd5[_0x2cb33f][_0xaddb65(0x2a3)]=_0xaddb65(0x22d),_0x4b4fd5[_0x2cb33f][_0xaddb65(0x1f6)]=_0x5be133[0x5];}else{if(_0x2cb33f==_0x40d2af){var _0x5a2a4a;if(_0x5be133[0x4]=='L')_0x5a2a4a='Level';else _0x5be133[0x4]=='F'&&(_0x5a2a4a='Floor');_0x4b4fd5[_0x2cb33f][_0xaddb65(0x2b8)]=_0x5be133[0x0],_0x4b4fd5[_0x2cb33f][_0xaddb65(0x1e2)]=_0x5be133[0x1],_0x4b4fd5[_0x2cb33f][_0xaddb65(0x269)]=_0x5be133[0x2],_0x4b4fd5[_0x2cb33f]['bin']=_0x5be133[0x3],_0x4b4fd5[_0x2cb33f][_0xaddb65(0x2a3)]=_0x5a2a4a,_0x4b4fd5[_0x2cb33f][_0xaddb65(0x1f6)]=_0x5be133[0x5];}}}});}),_0xef848e['forEach']((_0x30eba4,_0x3fffac)=>{var _0x4b7590=_0x5e1324;_0x4b4fd5[_0x3fffac][_0x4b7590(0x2b1)]=_0x30eba4;}),_0x293abb[_0x5e1324(0x1ef)]((_0x1d15d9,_0x5535c0)=>{var _0x2e9683=_0x5e1324;_0x4b4fd5[_0x5535c0][_0x2e9683(0x1e1)]=_0x1d15d9;}),_0x211124[_0x5e1324(0x1ef)]((_0x3c0ecc,_0x3fcafb)=>{var _0x21a45e=_0x5e1324;_0x4b4fd5[_0x3fcafb][_0x21a45e(0x206)]=_0x3c0ecc;}),_0x536f34[_0x5e1324(0x1ef)]((_0x307adb,_0x3fe82b)=>{var _0x599fe2=_0x5e1324;_0x4b4fd5[_0x3fe82b][_0x599fe2(0x1f5)]=_0x307adb;}),_0x170169[_0x5e1324(0x1ef)]((_0x519829,_0x48b0c7)=>{var _0x2604d2=_0x5e1324;_0x4b4fd5[_0x48b0c7][_0x2604d2(0x256)]=_0x519829;}),_0x48aef8['forEach']((_0x347303,_0x1f904a)=>{_0x4b4fd5[_0x1f904a]['secondary_unit']=_0x347303;}),_0x59b8b[_0x5e1324(0x1ef)]((_0x45614f,_0x3dd3e5)=>{var _0x491723=_0x5e1324;_0x4b4fd5[_0x3dd3e5][_0x491723(0x227)]=_0x45614f;}),_0x574777[_0x5e1324(0x1ef)]((_0x48f285,_0x1f5d2b)=>{var _0x2bcb9d=_0x5e1324;_0x4b4fd5[_0x1f5d2b][_0x2bcb9d(0x27e)]=_0x48f285;}),_0x285cef[_0x5e1324(0x1ef)]((_0x13bb61,_0x53f246)=>{_0x4b4fd5[_0x53f246]['expiry_date']=_0x13bb61;}),_0x1c0d04[_0x5e1324(0x1ef)]((_0xc3452,_0x6a8273)=>{var _0x47047a=_0x5e1324;_0x4b4fd5[_0x6a8273][_0x47047a(0x21e)]=_0xc3452;}),_0x491b11[_0x5e1324(0x1ef)]((_0x347cba,_0xc4dd14)=>{_0x4b4fd5[_0xc4dd14]['production_date']=_0x347cba;}),_0x573245['forEach']((_0x55a00e,_0x19bc49)=>{_0x4b4fd5[_0x19bc49]['prod_cat']=_0x55a00e;}),_0xdbc161[_0x5e1324(0x1ef)]((_0x2497d0,_0x57c812)=>{_0x4b4fd5[_0x57c812]['room_names']=_0x2497d0;}),_0x5a71ce['forEach']((_0x4f556b,_0x5b7407)=>{var _0x4c09e9=_0x5e1324;_0x4b4fd5[_0x5b7407][_0x4c09e9(0x2ac)]=_0x4f556b;}),_0x2d3b20['forEach']((_0x316590,_0x140302)=>{var _0x899e2f=_0x5e1324;_0x4b4fd5[_0x140302][_0x899e2f(0x279)]=_0x316590;});const _0x149036=_0x4b4fd5[_0x5e1324(0x1fa)](_0x39c27a=>_0x39c27a[_0x5e1324(0x206)]!=='0'&&_0x39c27a[_0x5e1324(0x206)]!=='');var _0x36b2e9=0x0;_0x149036[_0x5e1324(0x1ef)](_0x1aae05=>{var _0x226d62=_0x5e1324;console[_0x226d62(0x23a)](_0x226d62(0x1f9),_0x1aae05),parseInt(_0x1aae05[_0x226d62(0x206)])<=0x0&&_0x36b2e9++;});if(_0x36b2e9!=0x0)return _0x2823c5[_0x5e1324(0x2a7)](_0x5e1324(0x247),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x20d980[_0x5e1324(0x1f8)]('back');_0x64b8a2[_0x5e1324(0x285)]=_0x37e41b,_0x64b8a2[_0x5e1324(0x2ab)]=_0x22d6d8,_0x64b8a2[_0x5e1324(0x299)]=_0x149036,_0x64b8a2['note']=_0x4af1ab,_0x64b8a2[_0x5e1324(0x2a4)]=_0x2ef29e,_0x64b8a2[_0x5e1324(0x22a)]=_0x5e1324(0x2a8);const _0x212a46=await _0x64b8a2[_0x5e1324(0x22b)]();_0x2823c5['flash'](_0x5e1324(0x268),_0x5e1324(0x200)),_0x20d980[_0x5e1324(0x1f8)](_0x5e1324(0x1f1));}catch(_0x136bad){console[_0x5e1324(0x23a)](_0x136bad);}}),router[a0_0x38e597(0x246)]('/barcode_scanner',async(_0x2ed34c,_0x13ed4c)=>{var _0x2d0bb6=a0_0x38e597;const {primary_code:_0x3f9cef,warehouse_data:_0x57e2f3,rooms_data:_0x625f83,Roomslist:_0x5aa410}=_0x2ed34c[_0x2d0bb6(0x251)],_0xee854=_0x5aa410[_0x2d0bb6(0x2b7)](','),_0x3eb24a=[];async function _0x2271f7(_0x3e3032){var _0x2b2232=_0x2d0bb6;const _0x196242=await warehouse[_0x2b2232(0x1f4)]([{'$match':{'name':_0x57e2f3,'room':_0x3e3032}},{'$unwind':_0x2b2232(0x264)},{'$match':{'product_details.primary_code':_0x3f9cef}},{'$group':{'_id':_0x2b2232(0x24b),'name':{'$first':_0x2b2232(0x218)},'product_stock':{'$first':_0x2b2232(0x1e5)},'primary_code':{'$first':_0x2b2232(0x29e)},'secondary_code':{'$first':_0x2b2232(0x294)},'product_code':{'$first':_0x2b2232(0x2b6)},'level':{'$first':_0x2b2232(0x2b0)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2b2232(0x275)},'secondary_unit':{'$first':_0x2b2232(0x21f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2b2232(0x207)},'expiry_date':{'$first':_0x2b2232(0x29f)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2b2232(0x1e3)},'product_cat':{'$first':_0x2b2232(0x1f0)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x2b2232(0x296)}}}]),_0x15a8e4=await warehouse[_0x2b2232(0x1f4)]([{'$match':{'name':_0x57e2f3,'room':_0x3e3032}},{'$unwind':_0x2b2232(0x264)},{'$match':{'product_details.secondary_code':_0x3f9cef}},{'$group':{'_id':_0x2b2232(0x24b),'name':{'$first':_0x2b2232(0x218)},'product_stock':{'$first':_0x2b2232(0x1e5)},'primary_code':{'$first':_0x2b2232(0x29e)},'secondary_code':{'$first':_0x2b2232(0x294)},'product_code':{'$first':_0x2b2232(0x2b6)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2b2232(0x275)},'secondary_unit':{'$first':_0x2b2232(0x21f)},'storage':{'$first':_0x2b2232(0x24d)},'rack':{'$first':_0x2b2232(0x207)},'expiry_date':{'$first':_0x2b2232(0x29f)},'production_date':{'$first':_0x2b2232(0x289)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2b2232(0x1e3)},'product_cat':{'$first':_0x2b2232(0x1f0)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x2b2232(0x2b5)}}}]);if(_0x196242[_0x2b2232(0x213)]>0x0)_0x3eb24a['push'](_0x196242);else _0x15a8e4[_0x2b2232(0x213)]>0x0&&_0x3eb24a[_0x2b2232(0x217)](_0x15a8e4);}const _0x4bfdc5=_0xee854[_0x2d0bb6(0x1ff)](_0x3dbee8=>_0x2271f7(_0x3dbee8));await Promise[_0x2d0bb6(0x292)](_0x4bfdc5),_0x13ed4c[_0x2d0bb6(0x25b)](_0x3eb24a);}),router[a0_0x38e597(0x246)](a0_0x38e597(0x26e),async(_0x151277,_0x2b25ee)=>{var _0x2276b7=a0_0x38e597;const {primaryCode:_0x37bd7c,secondaryCode:_0x16db6c,productCode:_0x1c1282,level:_0x54318f,isle:_0x20af32,pallet:_0x1f7d61,warehouses:_0x3f6bad,room:_0x2b9b81}=_0x151277[_0x2276b7(0x251)];try{const _0x28447b=await warehouse['aggregate']([{'$match':{'name':_0x3f6bad,'room':_0x2b9b81}},{'$unwind':_0x2276b7(0x264)},{'$match':{'product_details.level':parseInt(_0x54318f),'product_details.isle':_0x20af32,'product_details.pallet':parseInt(_0x1f7d61)}},{'$group':{'_id':_0x2276b7(0x24b),'name':{'$first':_0x2276b7(0x218)},'product_stock':{'$first':_0x2276b7(0x1e5)},'level':{'$first':_0x2276b7(0x225)},'isle':{'$first':_0x2276b7(0x267)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2b25ee[_0x2276b7(0x1fb)](0xc8)[_0x2276b7(0x25b)](_0x28447b);}catch(_0x5be0db){_0x2b25ee[_0x2276b7(0x1fb)](0x194)['json']({'message':_0x5be0db[_0x2276b7(0x29b)]});}}),module[a0_0x38e597(0x1e4)]=router;function a0_0x27cc(){var _0x5c8cf1=['product_stock','/upload/','second1','prod_code','9066177wVXPUp','8072UeJOAO','edit_adjustment','bin','all','findById','$product_details.secondary_code','get','$product_details.invoice','production_date','$product_details.bin','product','prod_cat','message','Spanish','staff','$product_details.primary_code','$product_details.expiry_date','string','</tr>','secondary_unit','type','invoice','port','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','flash','False','<table\x20style=\x22width:\x20100%\x20!important;\x22>','205UxMWTm','date','primary_code','_id','id_transaction_from','<hr\x20class=\x22my-3\x22>','$product_details.bay','stockBefore','prime1','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$room','$product_details.product_code','split','storage','site_title','types','rack','$product_details.batch_code','exports','$product_details.product_stock','add_adjustment','<tr>','finalize','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','Chinese','Receiving\x20Area','Portuguese','../public/language/languages.json','maxPerUnit','forEach','$product_details.product_cat','/adjustment/view','level','$_id','aggregate','new_adjust_qty','floorlevel','6ejAShy','redirect','foreach\x20newproduct','filter','status','adjustment\x20add\x20successfull','An\x20error\x20occurred.','Rooms','map','adjustment\x20data\x20update\x20successfully','Email\x20sent\x20successfully','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','minus','padStart','RMSEmail','adjust_qty','$product_details.rack','Return\x20Goods','image','5402292WcBpCW','logo','Level','/picking_list/PDF_adjustment_rm/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','English','$invoice','/view','slice','length','Arabic','\x20</h2>','catch','push','$product_details.product_name','back','\x20<>\x20','role','$finalize','room','maxperunit','$product_details.secondary_unit','find','Portuguese\x20(BR)','$warehouse_name','user','<html><head><title></title>','$product_details.level','<div>','product_code','</table>','stock','isAllowEdit','save','createTransport','Floor','</tbody>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','language','</head><body>','$product_details.maxPerUnit','Secondary_units','\x20Order\x20Date\x20:\x20','floor','True','$date','/preview/:id','<span\x20style=\x22float:\x20right;\x22>','log','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','10142451BVaijV','$isAllowEdit','</div>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','</td>','expiry_date','params','room_names','German','$product_details.type','post','errors','<!DOCTYPE\x20html>','Logo.png','/../public','$product_details._id','3547690bidzuM','$product_details.storage','575091toclRb','prod_name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','body','Enabled','$product.product_name','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','unit','New_Qty_Converted','/adjustment/preview/','<h5\x20style=\x22text-align:\x20left;\x22>','Enclosed','json','Raw\x20Materials','password','max_per_unit','English\x20(US)','Return\x20Rooms','ADJ-','product_name','then','$product_details','error','Shelves','$product_details.isle','success','bay','French','random','Primary_Units','$product_details.floorlevel','/CheckingWarehouse','product_details','$product','New_Qty_Converted_adj','Arabic\x20(ae)','<tbody\x20style=\x22text-align:\x20center;\x22>','adjustment','$product_details.unit','express','98656MJamBp','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','secondary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','8TnEXmr','batch_code','prod_invoice','id_transaction','214JUIIJx','email','findOne','/view/add_adjustment','warehouse_name','warehouse','Error\x20Occurs','Hindi','$product_details.production_date'];a0_0x27cc=function(){return _0x5c8cf1;};return a0_0x27cc();}