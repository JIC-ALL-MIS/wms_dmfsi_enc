var a0_0x214ded=a0_0x76d9;(function(_0x560ae1,_0x580a84){var _0x3163d6=a0_0x76d9,_0x3d1729=_0x560ae1();while(!![]){try{var _0x336e20=parseInt(_0x3163d6(0x1f5))/0x1*(-parseInt(_0x3163d6(0x21f))/0x2)+parseInt(_0x3163d6(0x1d7))/0x3*(parseInt(_0x3163d6(0x258))/0x4)+-parseInt(_0x3163d6(0x1ca))/0x5*(parseInt(_0x3163d6(0x1cf))/0x6)+-parseInt(_0x3163d6(0x200))/0x7*(-parseInt(_0x3163d6(0x21e))/0x8)+-parseInt(_0x3163d6(0x260))/0x9*(-parseInt(_0x3163d6(0x197))/0xa)+-parseInt(_0x3163d6(0x229))/0xb*(-parseInt(_0x3163d6(0x1d2))/0xc)+parseInt(_0x3163d6(0x1b8))/0xd*(-parseInt(_0x3163d6(0x1fc))/0xe);if(_0x336e20===_0x580a84)break;else _0x3d1729['push'](_0x3d1729['shift']());}catch(_0x1cba4f){_0x3d1729['push'](_0x3d1729['shift']());}}}(a0_0x11ca,0xc2740));function a0_0x76d9(_0x3a707d,_0x59d9c3){var _0x11ca94=a0_0x11ca();return a0_0x76d9=function(_0x76d9fd,_0x46e516){_0x76d9fd=_0x76d9fd-0x193;var _0x53c81b=_0x11ca94[_0x76d9fd];return _0x53c81b;},a0_0x76d9(_0x3a707d,_0x59d9c3);}const express=require(a0_0x214ded(0x24a)),app=express(),router=express[a0_0x214ded(0x252)](),auth=require(a0_0x214ded(0x261)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x214ded(0x250)),users=require(a0_0x214ded(0x24d)),nodemailer=require(a0_0x214ded(0x1bd));router[a0_0x214ded(0x223)](a0_0x214ded(0x1d1),auth,async(_0x22df17,_0x2071c2)=>{var _0x23e5c2=a0_0x214ded;try{const {username:_0x54e91d,email:_0x3214a2,role:_0x2938bb}=_0x22df17[_0x23e5c2(0x20d)],_0x13b5a4=_0x22df17['user'],_0x2f03b0=await profile[_0x23e5c2(0x205)]({'email':_0x13b5a4[_0x23e5c2(0x232)]}),_0x108ded=await master_shop[_0x23e5c2(0x1e2)]();console[_0x23e5c2(0x256)](_0x23e5c2(0x263),_0x108ded);let _0x1fbb07;if(_0x13b5a4['role']==_0x23e5c2(0x253)){const _0x4583e3=await staff[_0x23e5c2(0x205)]({'email':_0x13b5a4[_0x23e5c2(0x232)]});_0x1fbb07=await warehouse['find']({'status':'Enabled','name':_0x4583e3['warehouse']});}else _0x1fbb07=await warehouse[_0x23e5c2(0x1e2)]({'status':_0x23e5c2(0x254)});const _0x15dbcd=await product[_0x23e5c2(0x1e2)]();let _0xbd1259;if(_0x13b5a4[_0x23e5c2(0x243)]=='staff'){const _0x19358f=await staff['findOne']({'email':_0x13b5a4[_0x23e5c2(0x232)]});_0xbd1259=await adjustment[_0x23e5c2(0x1e2)]({'warehouse_name':_0x19358f[_0x23e5c2(0x1ac)]});}else _0xbd1259=await adjustment[_0x23e5c2(0x239)]([{'$unwind':_0x23e5c2(0x1c0)},{'$group':{'_id':_0x23e5c2(0x1bb),'invoice':{'$first':_0x23e5c2(0x1b2)},'date':{'$first':_0x23e5c2(0x22e)},'warehouse_name':{'$first':_0x23e5c2(0x204)},'room':{'$addToSet':_0x23e5c2(0x1da)},'finalize':{'$first':_0x23e5c2(0x208)},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x108ded[0x0][_0x23e5c2(0x23d)]=='English\x20(US)'){var _0xaf4231=users[_0x23e5c2(0x1e8)];console[_0x23e5c2(0x256)](_0xaf4231);}else{if(_0x108ded[0x0]['language']==_0x23e5c2(0x221))var _0xaf4231=users['Hindi'];else{if(_0x108ded[0x0][_0x23e5c2(0x23d)]==_0x23e5c2(0x25f))var _0xaf4231=users[_0x23e5c2(0x25f)];else{if(_0x108ded[0x0][_0x23e5c2(0x23d)]==_0x23e5c2(0x207))var _0xaf4231=users[_0x23e5c2(0x207)];else{if(_0x108ded[0x0][_0x23e5c2(0x23d)]=='French')var _0xaf4231=users[_0x23e5c2(0x1f0)];else{if(_0x108ded[0x0][_0x23e5c2(0x23d)]=='Portuguese\x20(BR)')var _0xaf4231=users[_0x23e5c2(0x1ab)];else{if(_0x108ded[0x0]['language']=='Chinese')var _0xaf4231=users[_0x23e5c2(0x24c)];else{if(_0x108ded[0x0][_0x23e5c2(0x23d)]==_0x23e5c2(0x1e7))var _0xaf4231=users[_0x23e5c2(0x1dd)];}}}}}}}_0x2071c2[_0x23e5c2(0x251)]('adjustment',{'success':_0x22df17[_0x23e5c2(0x1a2)](_0x23e5c2(0x1fa)),'errors':_0x22df17[_0x23e5c2(0x1a2)]('errors'),'role':_0x13b5a4,'profile':_0x2f03b0,'warehouse':_0x1fbb07,'product':_0x15dbcd,'adjustment':_0xbd1259,'master_shop':_0x108ded,'language':_0xaf4231});}catch(_0x429620){console['log'](_0x429620);}});function a0_0x11ca(){var _0x2ac69a=['render','Router','staff','Enabled','message','log','product_code','4BFCXcH','status','English\x20(US)','Level','$product_details.expiry_date','add_adjustment','findById','German','39267lactNI','../middleware/auth','then','master','Email\x20sent\x20successfully','Adjustment\x20Mail','<strong>\x20Regards\x20</strong>','adjustment\x20add\x20successfull','Rooms','maxPerUnit','Logo.png','An\x20error\x20occurred.','type','second1','errors','1050IbRANd','floorlevel','prod_code','/view/add_adjustment','production_date','params','</h5>','<tbody\x20style=\x22text-align:\x20center;\x22>','forEach','/upload/','$product_details.product_code','flash','$product_details.floorlevel','ADJ-','foreach\x20newproduct','$product_details._id','Secondary_units','stockBefore','stock','error','Portuguese','warehouse','max_per_unit','\x20</h2>','Shelves','string','image','$invoice','adjustment\x20Finalized\x20successfully','bay','types','<tr>','$product_details.secondary_unit','689UvHQdi','$product_details.isle','Portuguese\x20(BR)','$_id','$name','nodemailer','True','exports','$product','map','back','invoice','</head><body>','level','Return\x20Rooms','storage','redirect','Return\x20Goods','2475400FWLRcG','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','edit_adjustment_view','Error\x20Occurs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','6YTpYsr','</tr>','/view','1415340EpemYL','/preview/:id','<h5>','</tbody>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','3493482AeBQrk','/../public','minus','$product.room_names','$product_details.production_date','primary_code','Arabic','slice','$room','warehouse_name','Floor','find','length','$product_details.rack','adjust_qty','Raw\x20Materials','Arabic\x20(ae)','English','prime1','$product_details.secondary_code','prod_invoice','filter','\x20Order\x20Date\x20:\x20','$product_details.maxPerUnit','Ambient','French','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','finalize','body','613uFnEMG','$product_details.batch_code','</thead>','expiry_date','$product.product_name','success','save','652414LEIiZV','batch_code','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','14xxLRox','<h2>\x20','</div>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$warehouse_name','findOne','new_adjust_qty','Spanish','$finalize','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','$product_details.bin','False','json','user','$product_details.product_name','room_names','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','maxperunit','split','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/picking_list/PDF_adjustment_rm/','$product_details.primary_code','Receiving\x20Area','rack','prod_name','date','New_Qty_Converted_adj','/barcode_scanner','<!DOCTYPE\x20html>','3424944QFejwk','818WnOAtN','$product_details.storage','Hindi','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','get','logo','edit_adjustment','$product_details','bin','product','143ZAtIJH','$product_details.product_cat','product_stock','<h5\x20style=\x22text-align:\x20left;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$date','unit','prod_cat','product_details','email','$product_details.unit','$product_details.pallet','$product_details.product_stock','$product_details.level','/adjustment/view','<table\x20style=\x22width:\x20100%\x20!important;\x22>','aggregate','</span>','<div>','push','language','createTransport','_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Primary_Units','secondary_unit','role','post','catch','all','product_name','site_title','/view/:id','express','\x20<>\x20','Chinese','../public/language/languages.json','An\x20error\x20occurred\x20while\x20saving\x20data.','New_Qty_Converted','../models/all_models'];a0_0x11ca=function(){return _0x2ac69a;};return a0_0x11ca();}async function getRandom8DigitNumber(){var _0x5cd380=a0_0x214ded;const _0x471c0b=0x989680,_0x5a6234=0x5f5e0ff,_0x53584c=Math['floor'](Math['random']()*(_0x5a6234-_0x471c0b+0x1))+_0x471c0b;var _0x4c9d2a;const _0x1c2e62=await adjustment[_0x5cd380(0x205)]({'invoice':_0x5cd380(0x1a4)+_0x53584c});return _0x1c2e62&&_0x1c2e62['length']>0x0?_0x4c9d2a=_0x5cd380(0x1a4)+_0x53584c:_0x4c9d2a=_0x5cd380(0x1a4)+_0x53584c,_0x4c9d2a;}router[a0_0x214ded(0x223)](a0_0x214ded(0x19a),auth,async(_0x346472,_0x23749a)=>{var _0x2ff14f=a0_0x214ded;try{const {username:_0x50c4fc,email:_0x3dfe97,role:_0x5d780e}=_0x346472[_0x2ff14f(0x20d)],_0x2b6658=_0x346472[_0x2ff14f(0x20d)],_0x48e00f=await profile[_0x2ff14f(0x205)]({'email':_0x2b6658[_0x2ff14f(0x232)]}),_0x39384e=await master_shop[_0x2ff14f(0x1e2)]();let _0x2d87e3;if(_0x2b6658[_0x2ff14f(0x243)]==_0x2ff14f(0x253)){const _0x1cb58b=await staff[_0x2ff14f(0x205)]({'email':_0x2b6658[_0x2ff14f(0x232)]});_0x2d87e3=await warehouse['aggregate']([{'$match':{'status':_0x2ff14f(0x254),'name':_0x1cb58b[_0x2ff14f(0x1ac)],'warehouse_category':_0x2ff14f(0x1e6),'name':{'$ne':_0x2ff14f(0x1c9)}}},{'$group':{'_id':_0x2ff14f(0x1bc),'name':{'$first':'$name'}}}]);}else _0x2d87e3=await warehouse[_0x2ff14f(0x239)]([{'$match':{'status':_0x2ff14f(0x254),'warehouse_category':_0x2ff14f(0x1e6),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x47c482=await product[_0x2ff14f(0x1e2)]({}),_0x5e38e6=await adjustment[_0x2ff14f(0x1e2)]({}),_0x18f949=_0x5e38e6[_0x2ff14f(0x1e3)]+0x1,_0xc44c2f=_0x2ff14f(0x1a4)+_0x18f949['toString']()['padStart'](0x5,'0');var _0x4f4f0e=[_0x2ff14f(0x1ef),'Enclosed',_0x2ff14f(0x1c6)];if(_0x39384e[0x0][_0x2ff14f(0x23d)]==_0x2ff14f(0x25a))var _0x347498=users['English'];else{if(_0x39384e[0x0][_0x2ff14f(0x23d)]==_0x2ff14f(0x221))var _0x347498=users['Hindi'];else{if(_0x39384e[0x0]['language']==_0x2ff14f(0x25f))var _0x347498=users['German'];else{if(_0x39384e[0x0][_0x2ff14f(0x23d)]==_0x2ff14f(0x207))var _0x347498=users[_0x2ff14f(0x207)];else{if(_0x39384e[0x0][_0x2ff14f(0x23d)]=='French')var _0x347498=users[_0x2ff14f(0x1f0)];else{if(_0x39384e[0x0][_0x2ff14f(0x23d)]==_0x2ff14f(0x1ba))var _0x347498=users[_0x2ff14f(0x1ab)];else{if(_0x39384e[0x0][_0x2ff14f(0x23d)]==_0x2ff14f(0x24c))var _0x347498=users['Chinese'];else{if(_0x39384e[0x0]['language']==_0x2ff14f(0x1e7))var _0x347498=users[_0x2ff14f(0x1dd)];}}}}}}}const _0x40e973=getRandom8DigitNumber();_0x40e973[_0x2ff14f(0x262)](_0x3a72d3=>{var _0x38f138=_0x2ff14f;_0x23749a['render'](_0x38f138(0x25d),{'success':_0x346472[_0x38f138(0x1a2)](_0x38f138(0x1fa)),'errors':_0x346472[_0x38f138(0x1a2)](_0x38f138(0x196)),'role':_0x2b6658,'profile':_0x48e00f,'warehouse':_0x2d87e3,'product':_0x47c482,'master_shop':_0x39384e,'language':_0x347498,'rooms_data':_0x4f4f0e,'invoice_no':_0x3a72d3});})[_0x2ff14f(0x245)](_0x5454e8=>{var _0x22f969=_0x2ff14f;_0x346472['flash']('errors',_0x22f969(0x214)),_0x23749a[_0x22f969(0x1c8)](_0x22f969(0x237));});}catch(_0x49604a){console[_0x2ff14f(0x256)](_0x49604a);}}),router[a0_0x214ded(0x244)](a0_0x214ded(0x19a),auth,async(_0x18a32a,_0x5245e7)=>{var _0x79f476=a0_0x214ded;try{const {warehouse_name:_0x456938,date:_0x309c03,prod_name:_0x496551,level:_0x3f1f90,isle:_0x696e8e,pallet:_0x204b79,stock:_0xfdc8f1,types:_0x519ec0,adjust_qty:_0x1f1947,new_adjust_qty:_0x3d8747,note:_0x5dc6ab,Room_name:_0xd66a8a,invoice:_0x23dce1,JO_number:_0x4d64ad,expiry_date:_0x54d77a}=_0x18a32a['body'];if(typeof _0x496551=='string')var _0x5480a4=[_0x18a32a[_0x79f476(0x1f4)]['prod_name']],_0x31f57b=[_0x18a32a['body'][_0x79f476(0x1c5)]],_0x285e5d=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1a9)]],_0x50601e=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1b5)]],_0x4ba0e7=[_0x18a32a['body']['New_Qty_Converted_adj']],_0x9ca732=[_0x18a32a['body'][_0x79f476(0x24f)]],_0x40ffbf=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x241)]],_0x4e6963=[_0x18a32a['body'][_0x79f476(0x1a7)]],_0x47ed7c=[_0x18a32a[_0x79f476(0x1f4)]['prod_code']],_0x3a4f41=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1fd)]],_0x15b53a=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1f8)]],_0x3834ec=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1ad)]],_0x2ff45a=[_0x18a32a['body'][_0x79f476(0x19b)]],_0x3d8c77=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x230)]],_0x31d75a=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x268)]],_0x36e197=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1e9)]],_0x29bd36=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x195)]],_0x4d9c30=[_0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1eb)]];else var _0x5480a4=[..._0x18a32a[_0x79f476(0x1f4)]['prod_name']],_0x31f57b=[..._0x18a32a['body']['level']],_0x285e5d=[..._0x18a32a[_0x79f476(0x1f4)]['stock']],_0x50601e=[..._0x18a32a[_0x79f476(0x1f4)]['types']],_0x4ba0e7=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x21b)]],_0x9ca732=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x24f)]],_0x40ffbf=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x22f)]],_0x4e6963=[..._0x18a32a[_0x79f476(0x1f4)]['Secondary_units']],_0x47ed7c=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x199)]],_0x3a4f41=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1fd)]],_0x15b53a=[..._0x18a32a[_0x79f476(0x1f4)]['expiry_date']],_0x3834ec=[..._0x18a32a[_0x79f476(0x1f4)]['max_per_unit']],_0x2ff45a=[..._0x18a32a['body'][_0x79f476(0x19b)]],_0x3d8c77=[..._0x18a32a[_0x79f476(0x1f4)]['prod_cat']],_0x31d75a=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x268)]],_0x36e197=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1e9)]],_0x29bd36=[..._0x18a32a[_0x79f476(0x1f4)]['second1']],_0x4d9c30=[..._0x18a32a[_0x79f476(0x1f4)][_0x79f476(0x1eb)]];const _0x3e9eee=_0x5480a4[_0x79f476(0x1c1)](_0xb7e34e=>{return _0xb7e34e={'product_name':_0xb7e34e};});_0x31f57b['forEach']((_0x43a043,_0x194b95)=>{var _0x1fad3d=_0x79f476;_0x31d75a[_0x1fad3d(0x19f)]((_0xdea45c,_0x5a686f)=>{var _0x2223ad=_0x1fad3d;if(_0xdea45c==_0x2223ad(0x217)&&_0x194b95==_0x5a686f){var _0x5b6657=_0x43a043[_0x2223ad(0x1de)](0x3);_0x3e9eee[_0x194b95][_0x2223ad(0x1c7)]=_0x43a043[0x0],_0x3e9eee[_0x194b95][_0x2223ad(0x218)]=_0x43a043[0x1],_0x3e9eee[_0x194b95][_0x2223ad(0x1b4)]=0x0,_0x3e9eee[_0x194b95][_0x2223ad(0x227)]=0x0,_0x3e9eee[_0x194b95]['type']='Floor',_0x3e9eee[_0x194b95][_0x2223ad(0x198)]=_0x5b6657;}else{if(_0xdea45c==_0x2223ad(0x1af)&&_0x194b95==_0x5a686f){var _0x5b6657=_0x43a043[_0x2223ad(0x1de)](0x3);_0x3e9eee[_0x194b95][_0x2223ad(0x1c7)]=_0x43a043[0x0],_0x3e9eee[_0x194b95][_0x2223ad(0x218)]=_0x43a043[0x1],_0x3e9eee[_0x194b95]['bay']=0x0,_0x3e9eee[_0x194b95][_0x2223ad(0x227)]=0x0,_0x3e9eee[_0x194b95][_0x2223ad(0x194)]=_0x2223ad(0x1e1),_0x3e9eee[_0x194b95][_0x2223ad(0x198)]=_0x43a043[0x5];}else{if(_0x194b95==_0x5a686f){var _0x18166e;if(_0x43a043[0x4]=='L')_0x18166e=_0x2223ad(0x25b);else _0x43a043[0x4]=='F'&&(_0x18166e='Floor');_0x3e9eee[_0x194b95][_0x2223ad(0x1c7)]=_0x43a043[0x0],_0x3e9eee[_0x194b95][_0x2223ad(0x218)]=_0x43a043[0x1],_0x3e9eee[_0x194b95][_0x2223ad(0x1b4)]=_0x43a043[0x2],_0x3e9eee[_0x194b95][_0x2223ad(0x227)]=_0x43a043[0x3],_0x3e9eee[_0x194b95]['type']=_0x18166e,_0x3e9eee[_0x194b95][_0x2223ad(0x198)]=_0x43a043[0x5];}}}});}),_0x285e5d[_0x79f476(0x19f)]((_0x4369ac,_0x376002)=>{var _0x430a3d=_0x79f476;_0x3e9eee[_0x376002][_0x430a3d(0x1a8)]=_0x4369ac;}),_0x50601e[_0x79f476(0x19f)]((_0x4e400a,_0x1dd3a5)=>{var _0x2b8481=_0x79f476;_0x3e9eee[_0x1dd3a5][_0x2b8481(0x1b5)]=_0x4e400a;}),_0x4ba0e7[_0x79f476(0x19f)]((_0x9cfe3c,_0x893f20)=>{_0x3e9eee[_0x893f20]['adjust_qty']=_0x9cfe3c;}),_0x9ca732[_0x79f476(0x19f)]((_0x2e3a47,_0x16835d)=>{_0x3e9eee[_0x16835d]['new_adjust_qty']=_0x2e3a47;}),_0x40ffbf[_0x79f476(0x19f)]((_0x57fe2e,_0x204a87)=>{_0x3e9eee[_0x204a87]['unit']=_0x57fe2e;}),_0x4e6963['forEach']((_0x26d7ed,_0x588a3b)=>{var _0xdf7bd0=_0x79f476;_0x3e9eee[_0x588a3b][_0xdf7bd0(0x242)]=_0x26d7ed;}),_0x47ed7c[_0x79f476(0x19f)]((_0x5eeadd,_0x462245)=>{_0x3e9eee[_0x462245]['product_code']=_0x5eeadd;}),_0x3a4f41['forEach']((_0x22eb43,_0x57d915)=>{var _0x320c14=_0x79f476;_0x3e9eee[_0x57d915][_0x320c14(0x1fd)]=_0x22eb43;}),_0x15b53a[_0x79f476(0x19f)]((_0x33a0b7,_0x5cadf7)=>{var _0x754895=_0x79f476;_0x3e9eee[_0x5cadf7][_0x754895(0x1f8)]=_0x33a0b7;}),_0x3834ec['forEach']((_0x114291,_0x5175bd)=>{var _0x50ae7f=_0x79f476;_0x3e9eee[_0x5175bd][_0x50ae7f(0x212)]=_0x114291;}),_0x2ff45a[_0x79f476(0x19f)]((_0x354bf3,_0x257458)=>{_0x3e9eee[_0x257458]['production_date']=_0x354bf3;}),_0x3d8c77[_0x79f476(0x19f)]((_0x55e682,_0x8b8cd8)=>{var _0x1ee9b1=_0x79f476;_0x3e9eee[_0x8b8cd8][_0x1ee9b1(0x230)]=_0x55e682;}),_0x31d75a['forEach']((_0x7ad04b,_0x307ead)=>{var _0x1c2e3b=_0x79f476;_0x3e9eee[_0x307ead][_0x1c2e3b(0x20f)]=_0x7ad04b;}),_0x36e197[_0x79f476(0x19f)]((_0x613a0e,_0xb73aa5)=>{_0x3e9eee[_0xb73aa5]['primary_code']=_0x613a0e;}),_0x29bd36[_0x79f476(0x19f)]((_0x5d58d0,_0xbd83c7)=>{_0x3e9eee[_0xbd83c7]['secondary_code']=_0x5d58d0;}),_0x4d9c30[_0x79f476(0x19f)]((_0x9aa392,_0x2583af)=>{var _0x3db10e=_0x79f476;_0x3e9eee[_0x2583af][_0x3db10e(0x1c3)]=_0x9aa392;});const _0x4a0f96=_0x3e9eee[_0x79f476(0x1ec)](_0x44379a=>_0x44379a['adjust_qty']!=='0'&&_0x44379a[_0x79f476(0x1e5)]!=='');var _0xf22c90=0x0;_0x4a0f96[_0x79f476(0x19f)](_0x4cfadc=>{var _0x379bf6=_0x79f476;console[_0x379bf6(0x256)]('foreach\x20newproduct',_0x4cfadc),parseInt(_0x4cfadc[_0x379bf6(0x1e5)])<=0x0&&_0xf22c90++;});if(_0xf22c90!=0x0)return _0x18a32a[_0x79f476(0x1a2)](_0x79f476(0x196),_0x79f476(0x209)),_0x5245e7[_0x79f476(0x1c8)]('back');const _0x369acd=new adjustment({'warehouse_name':_0x456938,'date':_0x309c03,'product':_0x4a0f96,'note':_0x5dc6ab,'room':_0xd66a8a,'invoice':_0x23dce1,'JO_number':_0x4d64ad,'expiry_date':_0x54d77a}),_0x1fb960=await _0x369acd['save']();_0x18a32a[_0x79f476(0x1a2)](_0x79f476(0x1fa),_0x79f476(0x267)),_0x5245e7[_0x79f476(0x1c8)]('/adjustment/preview/'+_0x1fb960['_id']);}catch(_0x29fe01){console[_0x79f476(0x256)](_0x29fe01),_0x5245e7[_0x79f476(0x259)](0xc8)['json']({'message':_0x29fe01[_0x79f476(0x255)]});}}),router['get'](a0_0x214ded(0x1d3),auth,async(_0x1d6e0d,_0x59bb89)=>{var _0x41a23c=a0_0x214ded;try{const {username:_0x15f9fa,email:_0x4ed269,role:_0x462de5}=_0x1d6e0d[_0x41a23c(0x20d)],_0x3e3db1=_0x1d6e0d['user'],_0xfc28a0=await profile['findOne']({'email':_0x3e3db1[_0x41a23c(0x232)]}),_0x5ebca2=await master_shop['find'](),_0x5da51c=_0x1d6e0d[_0x41a23c(0x19c)]['id'],_0x2920b7=await adjustment[_0x41a23c(0x25e)]({'_id':_0x5da51c}),_0x2eb4f6=await purchases[_0x41a23c(0x239)]([{'$match':{'warehouse_name':_0x2920b7['warehouse_name']}},{'$unwind':_0x41a23c(0x1c0)},{'$group':{'_id':_0x41a23c(0x1f9)}}]),_0x294234=await product[_0x41a23c(0x1e2)]({}),_0x591a60=await warehouse[_0x41a23c(0x239)]([{'$match':{'name':_0x2920b7[_0x41a23c(0x1e0)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x41a23c(0x20a)},'type':{'$first':_0x41a23c(0x1fe)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x41a23c(0x216)},'secondary_code':{'$first':_0x41a23c(0x1ea)},'product_code':{'$first':_0x41a23c(0x1a1)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x41a23c(0x1e4)},'maxPerUnit':{'$first':_0x41a23c(0x1ee)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x41a23c(0x1db)},'batch_code':{'$first':_0x41a23c(0x1f6)},'room':{'$first':_0x41a23c(0x1df)}}}]);if(_0x5ebca2[0x0][_0x41a23c(0x23d)]==_0x41a23c(0x25a)){var _0x10b0d6=users['English'];console['log'](_0x10b0d6);}else{if(_0x5ebca2[0x0][_0x41a23c(0x23d)]==_0x41a23c(0x221))var _0x10b0d6=users[_0x41a23c(0x221)];else{if(_0x5ebca2[0x0][_0x41a23c(0x23d)]==_0x41a23c(0x25f))var _0x10b0d6=users[_0x41a23c(0x25f)];else{if(_0x5ebca2[0x0][_0x41a23c(0x23d)]==_0x41a23c(0x207))var _0x10b0d6=users['Spanish'];else{if(_0x5ebca2[0x0]['language']==_0x41a23c(0x1f0))var _0x10b0d6=users[_0x41a23c(0x1f0)];else{if(_0x5ebca2[0x0][_0x41a23c(0x23d)]=='Portuguese\x20(BR)')var _0x10b0d6=users[_0x41a23c(0x1ab)];else{if(_0x5ebca2[0x0]['language']==_0x41a23c(0x24c))var _0x10b0d6=users[_0x41a23c(0x24c)];else{if(_0x5ebca2[0x0][_0x41a23c(0x23d)]==_0x41a23c(0x1e7))var _0x10b0d6=users[_0x41a23c(0x1dd)];}}}}}}}_0x59bb89[_0x41a23c(0x251)](_0x41a23c(0x1cc),{'success':_0x1d6e0d[_0x41a23c(0x1a2)](_0x41a23c(0x1fa)),'errors':_0x1d6e0d[_0x41a23c(0x1a2)]('errors'),'role':_0x3e3db1,'profile':_0xfc28a0,'adjustment':_0x2920b7,'stock':_0x591a60,'master_shop':_0x5ebca2,'warehouse_name':_0x2eb4f6,'unit':_0x294234,'language':_0x10b0d6});}catch(_0x2e743d){console['log'](_0x2e743d),_0x59bb89[_0x41a23c(0x259)](0xc8)[_0x41a23c(0x20c)]({'message':_0x2e743d[_0x41a23c(0x255)]});}}),router[a0_0x214ded(0x244)](a0_0x214ded(0x1d3),auth,async(_0x1bc1fa,_0x457922)=>{var _0x49aa76=a0_0x214ded;try{const _0x277377=_0x1bc1fa['params']['id'],{warehouse_name:_0x7fee28,Room_name:_0x490de4}=_0x1bc1fa[_0x49aa76(0x1f4)],_0x50e051=await adjustment[_0x49aa76(0x25e)]({'_id':_0x277377}),_0x290ff4=_0x50e051['product'][_0x49aa76(0x1c1)](async _0x599f2e=>{var _0x448e7e=_0x49aa76;if(_0x599f2e['adjust_qty']>0x0){var _0x439fdc=await warehouse[_0x448e7e(0x205)]({'name':_0x7fee28,'room':_0x599f2e[_0x448e7e(0x20f)],'warehouse_category':_0x448e7e(0x1e6)});const _0x1a0dea=_0x439fdc[_0x448e7e(0x231)][_0x448e7e(0x1c1)](_0x3ac57b=>{var _0x9e7736=_0x448e7e;if(_0x599f2e['type']==_0x9e7736(0x1d9)){if(_0x3ac57b['product_name']==_0x599f2e['product_name']&&_0x3ac57b['floorlevel']==_0x599f2e[_0x9e7736(0x198)]&&_0x3ac57b['type']==_0x599f2e[_0x9e7736(0x194)]&&_0x3ac57b[_0x9e7736(0x227)]==_0x599f2e[_0x9e7736(0x227)]&&_0x3ac57b[_0x9e7736(0x1b4)]==_0x599f2e[_0x9e7736(0x1b4)]&&_0x3ac57b['rack']==_0x599f2e[_0x9e7736(0x218)]&&_0x3ac57b[_0x9e7736(0x1c7)]==_0x599f2e[_0x9e7736(0x1c7)]&&_0x3ac57b[_0x9e7736(0x1f8)]==_0x599f2e['expiry_date']&&_0x3ac57b[_0x9e7736(0x1fd)]==_0x599f2e[_0x9e7736(0x1fd)]&&_0x3ac57b[_0x9e7736(0x19b)]==_0x599f2e['production_date']&&_0x3ac57b[_0x9e7736(0x1c3)]==_0x599f2e['invoice']){var _0x48525b;_0x48525b=_0x599f2e[_0x9e7736(0x1e5)],_0x599f2e[_0x9e7736(0x230)]=='S'&&(_0x48525b=_0x599f2e[_0x9e7736(0x1e5)]),_0x3ac57b[_0x9e7736(0x22b)]=_0x3ac57b['product_stock']-_0x48525b;}}else{if(_0x3ac57b[_0x9e7736(0x247)]==_0x599f2e[_0x9e7736(0x247)]&&_0x3ac57b[_0x9e7736(0x198)]==_0x599f2e[_0x9e7736(0x198)]&&_0x3ac57b[_0x9e7736(0x194)]==_0x599f2e[_0x9e7736(0x194)]&&_0x3ac57b['bin']==_0x599f2e['bin']&&_0x3ac57b[_0x9e7736(0x1b4)]==_0x599f2e[_0x9e7736(0x1b4)]&&_0x3ac57b['rack']==_0x599f2e[_0x9e7736(0x218)]&&_0x3ac57b[_0x9e7736(0x1c7)]==_0x599f2e['storage']&&_0x3ac57b[_0x9e7736(0x1f8)]==_0x599f2e[_0x9e7736(0x1f8)]&&_0x3ac57b['batch_code']==_0x599f2e[_0x9e7736(0x1fd)]&&_0x3ac57b[_0x9e7736(0x19b)]==_0x599f2e['production_date']&&_0x3ac57b[_0x9e7736(0x1c3)]==_0x599f2e[_0x9e7736(0x1c3)]){console[_0x9e7736(0x256)](_0x599f2e);var _0x48525b;_0x48525b=_0x599f2e[_0x9e7736(0x1e5)],_0x599f2e[_0x9e7736(0x230)]=='S'&&(_0x48525b=_0x599f2e[_0x9e7736(0x1e5)]),console['log'](_0x48525b+_0x9e7736(0x24b)+_0x599f2e[_0x9e7736(0x1e5)]+_0x9e7736(0x24b)+_0x3ac57b[_0x9e7736(0x269)]+'\x20<>\x20'+_0x599f2e[_0x9e7736(0x230)]),_0x3ac57b[_0x9e7736(0x22b)]=_0x3ac57b[_0x9e7736(0x22b)]+_0x48525b;}}});}return _0x439fdc;});Promise[_0x49aa76(0x246)](_0x290ff4)[_0x49aa76(0x262)](async _0x7f8cd6=>{var _0x48b3ed=_0x49aa76;try{for(const _0x16959d of _0x7f8cd6){await _0x16959d[_0x48b3ed(0x1fb)]();}_0x50e051[_0x48b3ed(0x1f3)]=_0x48b3ed(0x1be);const _0x597101=await _0x50e051[_0x48b3ed(0x1fb)](),_0x26c739=await master_shop[_0x48b3ed(0x1e2)](),_0x3be0ce=await email_settings[_0x48b3ed(0x205)](),_0x4ee150=await supervisor_settings[_0x48b3ed(0x1e2)]();var _0x4a9b5b=_0x50e051['product'],_0xd62ae7='',_0x3b245e;for(_0x3b245e in _0x4a9b5b){_0xd62ae7+=_0x48b3ed(0x1b6)+_0x48b3ed(0x203)+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x247)]+_0x48b3ed(0x1f1)+_0x48b3ed(0x203)+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x257)]+_0x48b3ed(0x1f1)+_0x48b3ed(0x203)+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x1e5)]+_0x48b3ed(0x1f1)+_0x48b3ed(0x203)+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x22f)]+_0x48b3ed(0x1f1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x242)]+_0x48b3ed(0x1f1)+_0x48b3ed(0x203)+_0x50e051[_0x48b3ed(0x1e0)]+'</td>'+_0x48b3ed(0x203)+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x20f)]+_0x48b3ed(0x1f1)+_0x48b3ed(0x203)+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x1c7)]+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x218)]+_0x4a9b5b[_0x3b245e]['bay']+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x227)]+_0x4a9b5b[_0x3b245e][_0x48b3ed(0x194)][0x0]+_0x4a9b5b[_0x3b245e]['floorlevel']+'</td>',_0x48b3ed(0x1d0);}let _0x5a7a70=nodemailer[_0x48b3ed(0x23e)]({'host':_0x3be0ce['host'],'port':Number(_0x3be0ce['port']),'secure':![],'auth':{'user':_0x3be0ce[_0x48b3ed(0x232)],'pass':_0x3be0ce['password']}}),_0x12b5e2={'from':_0x3be0ce[_0x48b3ed(0x232)],'to':_0x4ee150[0x0]['RMSEmail'],'subject':_0x48b3ed(0x265),'attachments':[{'filename':_0x48b3ed(0x26a),'path':__dirname+_0x48b3ed(0x1d8)+_0x48b3ed(0x1a0)+_0x26c739[0x0][_0x48b3ed(0x1b1)],'cid':_0x48b3ed(0x224)}],'html':_0x48b3ed(0x21d)+'<html><head><title></title>'+_0x48b3ed(0x1c4)+_0x48b3ed(0x23b)+_0x48b3ed(0x1cb)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x48b3ed(0x202)+'<div>'+_0x48b3ed(0x201)+_0x26c739[0x0][_0x48b3ed(0x248)]+_0x48b3ed(0x1ae)+_0x48b3ed(0x202)+_0x48b3ed(0x202)+'<hr\x20class=\x22my-3\x22>'+_0x48b3ed(0x23b)+_0x48b3ed(0x22c)+'\x20Order\x20Number\x20:\x20'+_0x50e051[_0x48b3ed(0x1c3)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x48b3ed(0x1ed)+_0x50e051[_0x48b3ed(0x21a)]+'\x20'+_0x48b3ed(0x23a)+_0x48b3ed(0x19d)+'</div>'+_0x48b3ed(0x238)+_0x48b3ed(0x222)+'<tr>'+_0x48b3ed(0x22d)+_0x48b3ed(0x1d6)+_0x48b3ed(0x1ff)+_0x48b3ed(0x240)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x48b3ed(0x211)+_0x48b3ed(0x1f2)+_0x48b3ed(0x1ce)+'</tr>'+_0x48b3ed(0x1f7)+_0x48b3ed(0x19e)+'\x20'+_0xd62ae7+'\x20'+_0x48b3ed(0x1d5)+'</table>'+_0x48b3ed(0x23b)+_0x48b3ed(0x266)+_0x48b3ed(0x1d4)+_0x26c739[0x0][_0x48b3ed(0x248)]+_0x48b3ed(0x19d)+_0x48b3ed(0x202)+_0x48b3ed(0x202)+'</body></html>'};_0x5a7a70['sendMail'](_0x12b5e2,function(_0x203f2c,_0x4b1ce4){var _0x4d41f2=_0x48b3ed;_0x203f2c?(console[_0x4d41f2(0x256)](_0x203f2c),console[_0x4d41f2(0x256)](_0x4d41f2(0x1cd))):console['log'](_0x4d41f2(0x264));}),_0x1bc1fa[_0x48b3ed(0x1a2)](_0x48b3ed(0x1fa),_0x48b3ed(0x1b3)),_0x457922[_0x48b3ed(0x1c8)](_0x48b3ed(0x215)+_0x597101[_0x48b3ed(0x23f)]);}catch(_0x5dc3a5){console[_0x48b3ed(0x1aa)](_0x5dc3a5),_0x457922[_0x48b3ed(0x259)](0x1f4)[_0x48b3ed(0x20c)]({'error':_0x48b3ed(0x24e)});}})['catch'](_0x5ab63f=>{var _0x51cb11=_0x49aa76;console[_0x51cb11(0x1aa)](_0x5ab63f),_0x457922[_0x51cb11(0x259)](0x1f4)['json']({'error':_0x51cb11(0x193)});});}catch(_0x4e8431){console[_0x49aa76(0x256)](_0x4e8431),_0x457922[_0x49aa76(0x259)](0xc8)[_0x49aa76(0x20c)]({'message':_0x4e8431[_0x49aa76(0x255)]});}}),router['get'](a0_0x214ded(0x249),auth,async(_0x30a550,_0x23da54)=>{var _0x53bd4e=a0_0x214ded;try{const {username:_0x151cd9,email:_0x184c3a,role:_0xe575ec}=_0x30a550[_0x53bd4e(0x20d)],_0x311be2=_0x30a550[_0x53bd4e(0x20d)],_0x3bfdf0=await profile[_0x53bd4e(0x205)]({'email':_0x311be2[_0x53bd4e(0x232)]}),_0xe45a57=await master_shop[_0x53bd4e(0x1e2)](),_0x4d26be=_0x30a550[_0x53bd4e(0x19c)]['id'],_0x4a5df1=await adjustment[_0x53bd4e(0x25e)]({'_id':_0x4d26be}),_0x17f255=await purchases[_0x53bd4e(0x239)]([{'$match':{'warehouse_name':_0x4a5df1[_0x53bd4e(0x1e0)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x99bef4=await product[_0x53bd4e(0x1e2)]({}),_0x2f37a8=await warehouse['aggregate']([{'$match':{'name':_0x4a5df1[_0x53bd4e(0x1e0)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x53bd4e(0x1a6),'name':{'$first':_0x53bd4e(0x20e)},'product_stock':{'$first':_0x53bd4e(0x235)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x53bd4e(0x20a)},'type':{'$first':_0x53bd4e(0x1fe)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x53bd4e(0x216)},'secondary_code':{'$first':_0x53bd4e(0x1ea)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x53bd4e(0x220)},'rack':{'$first':_0x53bd4e(0x1e4)},'maxPerUnit':{'$first':_0x53bd4e(0x1ee)},'expiry_date':{'$first':_0x53bd4e(0x25c)},'production_date':{'$first':_0x53bd4e(0x1db)},'batch_code':{'$first':_0x53bd4e(0x1f6)},'room':{'$first':_0x53bd4e(0x1df)}}}]);let _0x397e99;if(_0x311be2[_0x53bd4e(0x243)]==_0x53bd4e(0x253)){const _0x366d92=await staff[_0x53bd4e(0x205)]({'email':_0x311be2[_0x53bd4e(0x232)]});_0x397e99=await warehouse[_0x53bd4e(0x239)]([{'$match':{'status':'Enabled','name':_0x366d92[_0x53bd4e(0x1ac)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x53bd4e(0x1c9)}}},{'$group':{'_id':_0x53bd4e(0x1bc),'name':{'$first':_0x53bd4e(0x1bc)}}}]);}else _0x397e99=await warehouse['aggregate']([{'$match':{'status':_0x53bd4e(0x254),'warehouse_category':'Raw\x20Materials','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x53bd4e(0x1bc),'name':{'$first':'$name'}}}]);if(_0xe45a57[0x0][_0x53bd4e(0x23d)]==_0x53bd4e(0x25a)){var _0x32dcab=users['English'];console[_0x53bd4e(0x256)](_0x32dcab);}else{if(_0xe45a57[0x0][_0x53bd4e(0x23d)]==_0x53bd4e(0x221))var _0x32dcab=users['Hindi'];else{if(_0xe45a57[0x0][_0x53bd4e(0x23d)]==_0x53bd4e(0x25f))var _0x32dcab=users[_0x53bd4e(0x25f)];else{if(_0xe45a57[0x0][_0x53bd4e(0x23d)]=='Spanish')var _0x32dcab=users[_0x53bd4e(0x207)];else{if(_0xe45a57[0x0][_0x53bd4e(0x23d)]==_0x53bd4e(0x1f0))var _0x32dcab=users[_0x53bd4e(0x1f0)];else{if(_0xe45a57[0x0]['language']==_0x53bd4e(0x1ba))var _0x32dcab=users[_0x53bd4e(0x1ab)];else{if(_0xe45a57[0x0][_0x53bd4e(0x23d)]==_0x53bd4e(0x24c))var _0x32dcab=users['Chinese'];else{if(_0xe45a57[0x0][_0x53bd4e(0x23d)]=='Arabic\x20(ae)')var _0x32dcab=users[_0x53bd4e(0x1dd)];}}}}}}}_0x23da54[_0x53bd4e(0x251)](_0x53bd4e(0x225),{'success':_0x30a550[_0x53bd4e(0x1a2)](_0x53bd4e(0x1fa)),'errors':_0x30a550[_0x53bd4e(0x1a2)](_0x53bd4e(0x196)),'role':_0x311be2,'profile':_0x3bfdf0,'adjustment':_0x4a5df1,'stock':_0x2f37a8,'master_shop':_0xe45a57,'warehouse_name':_0x17f255,'unit':_0x99bef4,'language':_0x32dcab,'warehouse':_0x397e99});}catch(_0xf2e398){console['log'](_0xf2e398),_0x23da54[_0x53bd4e(0x259)](0xc8)[_0x53bd4e(0x20c)]({'message':_0xf2e398[_0x53bd4e(0x255)]});}}),router[a0_0x214ded(0x244)](a0_0x214ded(0x249),auth,async(_0x54576f,_0x33aae5)=>{var _0x511866=a0_0x214ded;try{const _0x1969c6=_0x54576f[_0x511866(0x19c)]['id'],_0x1a963f=await adjustment[_0x511866(0x25e)]({'_id':_0x1969c6}),_0x49be0f=await warehouse[_0x511866(0x205)]({'name':_0x1a963f[_0x511866(0x1e0)],'room':_0x1a963f['room']}),{warehouse_name:_0x339c15,date:_0x5aa640,prod_name:_0xb4c6ec,level:_0x2ddf7d,isle:_0x24f854,pallet:_0x440d8d,stock:_0x5bd416,types:_0x580b6f,adjust_qty:_0x50750b,new_adjust_qty:_0x58050d,note:_0x46c72e,Room_name:_0xccbb82,invoice:_0x4e0540,JO_number:_0x162d78,expiry_date:_0x5a8db3}=_0x54576f[_0x511866(0x1f4)];if(typeof _0xb4c6ec==_0x511866(0x1b0))var _0x4f55fb=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x219)]],_0x14c633=[_0x54576f['body'][_0x511866(0x1c5)]],_0x3f9a7d=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x1a9)]],_0x341a6a=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x1b5)]],_0x81639f=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x21b)]],_0x3ef904=[_0x54576f['body'][_0x511866(0x24f)]],_0x3987c9=[_0x54576f[_0x511866(0x1f4)]['Primary_Units']],_0x2d2ba0=[_0x54576f[_0x511866(0x1f4)]['Secondary_units']],_0x3f0a46=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x199)]],_0x257b4b=[_0x54576f['body'][_0x511866(0x1fd)]],_0x1f77db=[_0x54576f[_0x511866(0x1f4)]['expiry_date']],_0x13dad6=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x1ad)]],_0x23cf73=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x19b)]],_0x3b542e=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x230)]],_0x266fa7=[_0x54576f[_0x511866(0x1f4)]['Rooms']],_0x47ceac=[_0x54576f[_0x511866(0x1f4)][_0x511866(0x1e9)]],_0x12e1d8=[_0x54576f[_0x511866(0x1f4)]['second1']];else var _0x4f55fb=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x219)]],_0x14c633=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x1c5)]],_0x3f9a7d=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x1a9)]],_0x341a6a=[..._0x54576f['body'][_0x511866(0x1b5)]],_0x81639f=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x21b)]],_0x3ef904=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x24f)]],_0x3987c9=[..._0x54576f['body']['unit']],_0x2d2ba0=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x1a7)]],_0x3f0a46=[..._0x54576f['body'][_0x511866(0x199)]],_0x257b4b=[..._0x54576f[_0x511866(0x1f4)]['batch_code']],_0x1f77db=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x1f8)]],_0x13dad6=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x1ad)]],_0x23cf73=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x19b)]],_0x3b542e=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x230)]],_0x266fa7=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x268)]],_0x47ceac=[..._0x54576f[_0x511866(0x1f4)]['prime1']],_0x12e1d8=[..._0x54576f[_0x511866(0x1f4)][_0x511866(0x195)]];const _0x325a4e=_0x4f55fb[_0x511866(0x1c1)](_0x3b90c2=>{return _0x3b90c2={'product_name':_0x3b90c2};});_0x14c633['forEach']((_0x470832,_0x1a2854)=>{var _0x18c5b5=_0x511866;_0x266fa7[_0x18c5b5(0x19f)]((_0x5d32e3,_0x2cd132)=>{var _0x56bc9f=_0x18c5b5;if(_0x5d32e3=='Receiving\x20Area'&&_0x1a2854==_0x2cd132){var _0xae8ec9=_0x470832[_0x56bc9f(0x1de)](0x3);_0x325a4e[_0x1a2854][_0x56bc9f(0x1c7)]=_0x470832[0x0],_0x325a4e[_0x1a2854][_0x56bc9f(0x218)]=_0x470832[0x1],_0x325a4e[_0x1a2854][_0x56bc9f(0x1b4)]=0x0,_0x325a4e[_0x1a2854][_0x56bc9f(0x227)]=0x0,_0x325a4e[_0x1a2854][_0x56bc9f(0x194)]=_0x56bc9f(0x1e1),_0x325a4e[_0x1a2854]['floorlevel']=_0xae8ec9;}else{if(_0x5d32e3==_0x56bc9f(0x1af)&&_0x1a2854==_0x2cd132){var _0xae8ec9=_0x470832[_0x56bc9f(0x1de)](0x3);_0x325a4e[_0x1a2854][_0x56bc9f(0x1c7)]=_0x470832[0x0],_0x325a4e[_0x1a2854][_0x56bc9f(0x218)]=_0x470832[0x1],_0x325a4e[_0x1a2854][_0x56bc9f(0x1b4)]=0x0,_0x325a4e[_0x1a2854][_0x56bc9f(0x227)]=0x0,_0x325a4e[_0x1a2854][_0x56bc9f(0x194)]=_0x56bc9f(0x1e1),_0x325a4e[_0x1a2854][_0x56bc9f(0x198)]=_0x470832[0x5];}else{if(_0x1a2854==_0x2cd132){var _0x405224;if(_0x470832[0x4]=='L')_0x405224=_0x56bc9f(0x25b);else _0x470832[0x4]=='F'&&(_0x405224=_0x56bc9f(0x1e1));_0x325a4e[_0x1a2854][_0x56bc9f(0x1c7)]=_0x470832[0x0],_0x325a4e[_0x1a2854][_0x56bc9f(0x218)]=_0x470832[0x1],_0x325a4e[_0x1a2854]['bay']=_0x470832[0x2],_0x325a4e[_0x1a2854][_0x56bc9f(0x227)]=_0x470832[0x3],_0x325a4e[_0x1a2854][_0x56bc9f(0x194)]=_0x405224,_0x325a4e[_0x1a2854][_0x56bc9f(0x198)]=_0x470832[0x5];}}}});}),_0x3f9a7d[_0x511866(0x19f)]((_0x5b2004,_0x176db7)=>{_0x325a4e[_0x176db7]['stockBefore']=_0x5b2004;}),_0x341a6a[_0x511866(0x19f)]((_0x3d05e4,_0x420e36)=>{var _0x18bb50=_0x511866;_0x325a4e[_0x420e36][_0x18bb50(0x1b5)]=_0x3d05e4;}),_0x81639f[_0x511866(0x19f)]((_0x291d6d,_0x48ed1c)=>{_0x325a4e[_0x48ed1c]['adjust_qty']=_0x291d6d;}),_0x3ef904[_0x511866(0x19f)]((_0x2518fb,_0x5aa790)=>{var _0x28270a=_0x511866;_0x325a4e[_0x5aa790][_0x28270a(0x206)]=_0x2518fb;}),_0x3987c9['forEach']((_0x141919,_0x54aba1)=>{_0x325a4e[_0x54aba1]['unit']=_0x141919;}),_0x2d2ba0[_0x511866(0x19f)]((_0x3202,_0x4219d8)=>{_0x325a4e[_0x4219d8]['secondary_unit']=_0x3202;}),_0x3f0a46[_0x511866(0x19f)]((_0x421cc4,_0x4f4c26)=>{var _0x474f62=_0x511866;_0x325a4e[_0x4f4c26][_0x474f62(0x257)]=_0x421cc4;}),_0x257b4b[_0x511866(0x19f)]((_0x26aca4,_0x2732c3)=>{var _0x3c73eb=_0x511866;_0x325a4e[_0x2732c3][_0x3c73eb(0x1fd)]=_0x26aca4;}),_0x1f77db[_0x511866(0x19f)]((_0x51ab41,_0x11d92f)=>{var _0x414a33=_0x511866;_0x325a4e[_0x11d92f][_0x414a33(0x1f8)]=_0x51ab41;}),_0x13dad6[_0x511866(0x19f)]((_0x5c8975,_0x2dd090)=>{_0x325a4e[_0x2dd090]['maxperunit']=_0x5c8975;}),_0x23cf73[_0x511866(0x19f)]((_0x6294e7,_0x54fd55)=>{var _0x5b8caf=_0x511866;_0x325a4e[_0x54fd55][_0x5b8caf(0x19b)]=_0x6294e7;}),_0x3b542e[_0x511866(0x19f)]((_0x69fd24,_0x1be349)=>{_0x325a4e[_0x1be349]['prod_cat']=_0x69fd24;}),_0x266fa7['forEach']((_0x4edfe9,_0x55414f)=>{var _0x31a0ee=_0x511866;_0x325a4e[_0x55414f][_0x31a0ee(0x20f)]=_0x4edfe9;}),_0x47ceac[_0x511866(0x19f)]((_0x4f103e,_0x3698f1)=>{var _0x40ba24=_0x511866;_0x325a4e[_0x3698f1][_0x40ba24(0x1dc)]=_0x4f103e;}),_0x12e1d8[_0x511866(0x19f)]((_0x47ead1,_0x1e0215)=>{_0x325a4e[_0x1e0215]['secondary_code']=_0x47ead1;});const _0x56a6ab=_0x325a4e[_0x511866(0x1ec)](_0x4edec8=>_0x4edec8[_0x511866(0x1e5)]!=='0'&&_0x4edec8[_0x511866(0x1e5)]!=='');var _0x3364b9=0x0;_0x56a6ab['forEach'](_0x5ebb88=>{var _0x5df32c=_0x511866;console[_0x5df32c(0x256)](_0x5df32c(0x1a5),_0x5ebb88),parseInt(_0x5ebb88['adjust_qty'])<=0x0&&_0x3364b9++;});if(_0x3364b9!=0x0)return _0x54576f['flash']('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x33aae5[_0x511866(0x1c8)](_0x511866(0x1c2));_0x1a963f['warehouse_name']=_0x339c15,_0x1a963f[_0x511866(0x21a)]=_0x5aa640,_0x1a963f[_0x511866(0x228)]=_0x56a6ab,_0x1a963f['note']=_0x46c72e,_0x1a963f['invoice']=_0x4e0540,_0x1a963f['isAllowEdit']=_0x511866(0x20b);const _0x421cf0=await _0x1a963f[_0x511866(0x1fb)]();_0x54576f[_0x511866(0x1a2)](_0x511866(0x1fa),'adjustment\x20data\x20update\x20successfully'),_0x33aae5[_0x511866(0x1c8)](_0x511866(0x237));}catch(_0x2954e7){console[_0x511866(0x256)](_0x2954e7);}}),router['post'](a0_0x214ded(0x21c),async(_0x12af11,_0x2a3375)=>{var _0x361709=a0_0x214ded;const {primary_code:_0x1d6f79,warehouse_data:_0x58bff8,rooms_data:_0x2eec38,Roomslist:_0x1c06f9}=_0x12af11[_0x361709(0x1f4)],_0x15da54=_0x1c06f9[_0x361709(0x213)](','),_0x2a2c6e=[];async function _0x1e3e44(_0x499b58){var _0x162af4=_0x361709;const _0x5ebbbb=await warehouse[_0x162af4(0x239)]([{'$match':{'name':_0x58bff8,'room':_0x499b58}},{'$unwind':_0x162af4(0x226)},{'$match':{'product_details.primary_code':_0x1d6f79}},{'$group':{'_id':_0x162af4(0x1a6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x162af4(0x235)},'primary_code':{'$first':_0x162af4(0x216)},'secondary_code':{'$first':_0x162af4(0x1ea)},'product_code':{'$first':_0x162af4(0x1a1)},'level':{'$first':_0x162af4(0x210)},'isle':{'$first':_0x162af4(0x20a)},'type':{'$first':_0x162af4(0x1fe)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x162af4(0x233)},'secondary_unit':{'$first':_0x162af4(0x1b7)},'storage':{'$first':_0x162af4(0x220)},'rack':{'$first':_0x162af4(0x1e4)},'expiry_date':{'$first':_0x162af4(0x25c)},'production_date':{'$first':_0x162af4(0x1db)},'maxPerUnit':{'$first':_0x162af4(0x1ee)},'batch_code':{'$first':_0x162af4(0x1f6)},'product_cat':{'$first':_0x162af4(0x22a)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x1d4057=await warehouse[_0x162af4(0x239)]([{'$match':{'name':_0x58bff8,'room':_0x499b58}},{'$unwind':_0x162af4(0x226)},{'$match':{'product_details.secondary_code':_0x1d6f79}},{'$group':{'_id':_0x162af4(0x1a6),'name':{'$first':_0x162af4(0x20e)},'product_stock':{'$first':_0x162af4(0x235)},'primary_code':{'$first':_0x162af4(0x216)},'secondary_code':{'$first':_0x162af4(0x1ea)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x162af4(0x210)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x162af4(0x1a3)},'unit':{'$first':_0x162af4(0x233)},'secondary_unit':{'$first':_0x162af4(0x1b7)},'storage':{'$first':_0x162af4(0x220)},'rack':{'$first':_0x162af4(0x1e4)},'expiry_date':{'$first':_0x162af4(0x25c)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x162af4(0x1f6)},'product_cat':{'$first':_0x162af4(0x22a)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x162af4(0x1df)}}}]);if(_0x5ebbbb[_0x162af4(0x1e3)]>0x0)_0x2a2c6e['push'](_0x5ebbbb);else _0x1d4057[_0x162af4(0x1e3)]>0x0&&_0x2a2c6e[_0x162af4(0x23c)](_0x1d4057);}const _0x5452d4=_0x15da54['map'](_0x35e943=>_0x1e3e44(_0x35e943));await Promise[_0x361709(0x246)](_0x5452d4),_0x2a3375[_0x361709(0x20c)](_0x2a2c6e);}),router[a0_0x214ded(0x244)]('/CheckingWarehouse',async(_0x3dc168,_0x40cb45)=>{var _0x514f9e=a0_0x214ded;const {primaryCode:_0x1929e0,secondaryCode:_0x568a31,productCode:_0x165f13,level:_0x48024d,isle:_0x4eca46,pallet:_0x1955d7,warehouses:_0x4551e7,room:_0x15f199}=_0x3dc168['body'];try{const _0x4bcb46=await warehouse['aggregate']([{'$match':{'name':_0x4551e7,'room':_0x15f199}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x48024d),'product_details.isle':_0x4eca46,'product_details.pallet':parseInt(_0x1955d7)}},{'$group':{'_id':_0x514f9e(0x1a6),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x514f9e(0x235)},'level':{'$first':_0x514f9e(0x236)},'isle':{'$first':_0x514f9e(0x1b9)},'pallet':{'$first':_0x514f9e(0x234)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x40cb45[_0x514f9e(0x259)](0xc8)[_0x514f9e(0x20c)](_0x4bcb46);}catch(_0x14acc6){_0x40cb45['status'](0x194)[_0x514f9e(0x20c)]({'message':_0x14acc6['message']});}}),module[a0_0x214ded(0x1bf)]=router;