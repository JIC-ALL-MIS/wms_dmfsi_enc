var a0_0x91e05a=a0_0x1c58;function a0_0x51d7(){var _0x5bd2db=['product_name','adjustment','$product_details.unit','id_transaction','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<h5>','$warehouse_name','French','<html><head><title></title>','\x20Order\x20Date\x20:\x20','</table>','rack','/picking_list/PDF_adjustment_rm/','product_details','$product_details.secondary_unit','add_adjustment','status','length','aggregate','second1','$product_details.product_stock','Return\x20Goods','adjust_qty','errors','level','Arabic','<strong>\x20Regards\x20</strong>','note','/view/:id','$product_details.maxPerUnit','all','production_date','<h2>\x20','<!DOCTYPE\x20html>','isAllowEdit','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Logo.png','push','Portuguese\x20(BR)','split','primary_code','site_title','$product_details.type','24fogvHz','_id','product_code','</td>','then','English\x20(US)','batch_code','Enabled','Rooms','storage','email','minus','English','get','$product_details.expiry_date','user','$product_details.bin','new_adjust_qty','bay','122517GyTfla','Hindi','bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details','$invoice','slice','Level','$product_details.isle','2263575giGaZL','success','body','\x20<>\x20','$product_details.pallet','/CheckingWarehouse','<span\x20style=\x22float:\x20right;\x22>','findById','2372OQBZDc','</head><body>','express','</tbody>','$product_details.rack','$product_details.product_cat','maxperunit','5677MqKwDh','warehouse_name','prod_code','message','Chinese','type','role','/preview/:id','adjustment\x20Finalized\x20successfully','invoice','back','RMSEmail','$date','adjustment\x20data\x20update\x20successfully','Shelves','flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product','$product_details.invoice','prod_invoice','date','3704ShgMvU','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Receiving\x20Area','27BwNfZt','save','catch','</div>','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','True','Spanish','$product_details.production_date','Ambient','json','adjustment\x20add\x20successfull','language','Arabic\x20(ae)','expiry_date','$product_details.floorlevel','room','\x20Order\x20Number\x20:\x20','host','filter','Router','post','exports','/view','ADJ-','9794811UwhXkZ','Enclosed','<tbody\x20style=\x22text-align:\x20center;\x22>','../middleware/auth','2150401WzrgDD','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','render','$product_details.primary_code','/adjustment/view','Secondary_units','Raw\x20Materials','6CmIsou','master','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.bay','stockBefore','logo','$product_details.storage','</span>','$product.product_name','prod_cat','port','id_transaction_from','params','Primary_Units','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','prod_name','Floor','</tr>','150pPvCrY','$product_details.product_code','Adjustment\x20Mail','71oqhKmd','New_Qty_Converted_adj','sendMail','$product_details.batch_code','$name','<div>','nodemailer','$product_details._id','random','product','product_stock','/barcode_scanner','image','secondary_unit','unit','<hr\x20class=\x22my-3\x22>','<tr>','$room','room_names','types','Portuguese','find','map','/../public','$product_details.product_name','findOne','stock','warehouse','staff','log','redirect','string','secondary_code','90404vJAYfX','error','New_Qty_Converted','foreach\x20newproduct','</h5>','/view/add_adjustment','$product_details.secondary_code','An\x20error\x20occurred.','max_per_unit','<h5\x20style=\x22text-align:\x20left;\x22>','edit_adjustment','prime1','$product_details.level','\x20</h2>','</thead>','German','floorlevel','../models/all_models','forEach','padStart','/upload/'];a0_0x51d7=function(){return _0x5bd2db;};return a0_0x51d7();}(function(_0x522c55,_0x341d97){var _0x2a8052=a0_0x1c58,_0x4df2b8=_0x522c55();while(!![]){try{var _0x1bfdeb=parseInt(_0x2a8052(0x18f))/0x1*(-parseInt(_0x2a8052(0x138))/0x2)+-parseInt(_0x2a8052(0x157))/0x3*(parseInt(_0x2a8052(0x1b0))/0x4)+parseInt(_0x2a8052(0x130))/0x5*(-parseInt(_0x2a8052(0x17a))/0x6)+-parseInt(_0x2a8052(0x13f))/0x7*(parseInt(_0x2a8052(0x154))/0x8)+-parseInt(_0x2a8052(0x127))/0x9*(-parseInt(_0x2a8052(0x18c))/0xa)+-parseInt(_0x2a8052(0x173))/0xb*(-parseInt(_0x2a8052(0x114))/0xc)+parseInt(_0x2a8052(0x16f))/0xd;if(_0x1bfdeb===_0x341d97)break;else _0x4df2b8['push'](_0x4df2b8['shift']());}catch(_0x22521d){_0x4df2b8['push'](_0x4df2b8['shift']());}}}(a0_0x51d7,0x38d61));const express=require(a0_0x91e05a(0x13a)),app=express(),router=express[a0_0x91e05a(0x16a)](),auth=require(a0_0x91e05a(0x172)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x91e05a(0x1c1)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x91e05a(0x195));router['get'](a0_0x91e05a(0x16d),auth,async(_0x3ac00b,_0x20391d)=>{var _0x496c0=a0_0x91e05a;try{const {username:_0x342915,email:_0x1404df,role:_0x3ea6f5}=_0x3ac00b[_0x496c0(0x123)],_0x545373=_0x3ac00b['user'],_0xf46e6=await profile['findOne']({'email':_0x545373[_0x496c0(0x11e)]}),_0x2bebfa=await master_shop[_0x496c0(0x1a4)]();console['log'](_0x496c0(0x17b),_0x2bebfa);let _0x3d7d1f;if(_0x545373[_0x496c0(0x145)]==_0x496c0(0x1ab)){const _0x213cfe=await staff[_0x496c0(0x1a8)]({'email':_0x545373[_0x496c0(0x11e)]});_0x3d7d1f=await warehouse[_0x496c0(0x1a4)]({'status':_0x496c0(0x11b),'name':_0x213cfe[_0x496c0(0x1aa)]});}else _0x3d7d1f=await warehouse['find']({'status':'Enabled'});const _0x1cf3e7=await product[_0x496c0(0x1a4)]();let _0x2fdf85;if(_0x545373[_0x496c0(0x145)]==_0x496c0(0x1ab)){const _0x4c5230=await staff[_0x496c0(0x1a8)]({'email':_0x545373['email']});_0x2fdf85=await adjustment[_0x496c0(0x1a4)]({'warehouse_name':_0x4c5230[_0x496c0(0x1aa)]});}else _0x2fdf85=await adjustment[_0x496c0(0xfb)]([{'$unwind':_0x496c0(0x150)},{'$group':{'_id':'$_id','invoice':{'$first':_0x496c0(0x12c)},'date':{'$first':_0x496c0(0x14b)},'warehouse_name':{'$first':_0x496c0(0x1cb)},'room':{'$addToSet':'$product.room_names'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':'$isAllowEdit'}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x2bebfa[0x0][_0x496c0(0x162)]==_0x496c0(0x119)){var _0x3dd325=users['English'];console[_0x496c0(0x1ac)](_0x3dd325);}else{if(_0x2bebfa[0x0][_0x496c0(0x162)]==_0x496c0(0x128))var _0x3dd325=users[_0x496c0(0x128)];else{if(_0x2bebfa[0x0][_0x496c0(0x162)]==_0x496c0(0x1bf))var _0x3dd325=users[_0x496c0(0x1bf)];else{if(_0x2bebfa[0x0]['language']==_0x496c0(0x15d))var _0x3dd325=users[_0x496c0(0x15d)];else{if(_0x2bebfa[0x0][_0x496c0(0x162)]==_0x496c0(0x1cc))var _0x3dd325=users[_0x496c0(0x1cc)];else{if(_0x2bebfa[0x0][_0x496c0(0x162)]=='Portuguese\x20(BR)')var _0x3dd325=users['Portuguese'];else{if(_0x2bebfa[0x0]['language']==_0x496c0(0x143))var _0x3dd325=users[_0x496c0(0x143)];else{if(_0x2bebfa[0x0]['language']==_0x496c0(0x163))var _0x3dd325=users[_0x496c0(0x102)];}}}}}}}_0x20391d[_0x496c0(0x175)](_0x496c0(0x1c6),{'success':_0x3ac00b[_0x496c0(0x14e)](_0x496c0(0x131)),'errors':_0x3ac00b[_0x496c0(0x14e)](_0x496c0(0x100)),'role':_0x545373,'profile':_0xf46e6,'warehouse':_0x3d7d1f,'product':_0x1cf3e7,'adjustment':_0x2fdf85,'master_shop':_0x2bebfa,'language':_0x3dd325});}catch(_0x4c5cb6){console[_0x496c0(0x1ac)](_0x4c5cb6);}});function a0_0x1c58(_0x3fc81c,_0x1a8127){var _0x51d7f4=a0_0x51d7();return a0_0x1c58=function(_0x1c5840,_0x34701a){_0x1c5840=_0x1c5840-0xfa;var _0x594636=_0x51d7f4[_0x1c5840];return _0x594636;},a0_0x1c58(_0x3fc81c,_0x1a8127);}async function getRandom8DigitNumber(){var _0x5298ab=a0_0x91e05a;const _0x480ae8=0x989680,_0x5bc6b9=0x5f5e0ff,_0x5e203e=Math['floor'](Math[_0x5298ab(0x197)]()*(_0x5bc6b9-_0x480ae8+0x1))+_0x480ae8;var _0x5a9692;const _0x1120de=await adjustment[_0x5298ab(0x1a8)]({'invoice':'ADJ-'+_0x5e203e});return _0x1120de&&_0x1120de[_0x5298ab(0xfa)]>0x0?_0x5a9692=_0x5298ab(0x16e)+_0x5e203e:_0x5a9692='ADJ-'+_0x5e203e,_0x5a9692;}router[a0_0x91e05a(0x121)](a0_0x91e05a(0x1b5),auth,async(_0x2dcc4d,_0x1bf485)=>{var _0x3fb2db=a0_0x91e05a;try{const {username:_0x4c8cea,email:_0x10e98f,role:_0xf2b12c}=_0x2dcc4d[_0x3fb2db(0x123)],_0x245433=_0x2dcc4d[_0x3fb2db(0x123)],_0x14d225=await profile[_0x3fb2db(0x1a8)]({'email':_0x245433[_0x3fb2db(0x11e)]}),_0x35efe2=await master_shop[_0x3fb2db(0x1a4)]();let _0x4af312;if(_0x245433[_0x3fb2db(0x145)]==_0x3fb2db(0x1ab)){const _0xd32621=await staff[_0x3fb2db(0x1a8)]({'email':_0x245433['email']});_0x4af312=await warehouse['aggregate']([{'$match':{'status':_0x3fb2db(0x11b),'name':_0xd32621[_0x3fb2db(0x1aa)],'warehouse_category':_0x3fb2db(0x179),'name':{'$ne':_0x3fb2db(0xfe)}}},{'$group':{'_id':_0x3fb2db(0x193),'name':{'$first':_0x3fb2db(0x193)}}}]);}else _0x4af312=await warehouse['aggregate']([{'$match':{'status':_0x3fb2db(0x11b),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x3fb2db(0xfe)}}},{'$group':{'_id':_0x3fb2db(0x193),'name':{'$first':'$name'}}}]);const _0x33b2a1=await product['find']({}),_0x56e7ba=await adjustment[_0x3fb2db(0x1a4)]({}),_0xc0423=_0x56e7ba['length']+0x1,_0x740578=_0x3fb2db(0x16e)+_0xc0423['toString']()[_0x3fb2db(0x1c3)](0x5,'0');var _0x16a1a0=[_0x3fb2db(0x15f),_0x3fb2db(0x170),'Return\x20Rooms'];if(_0x35efe2[0x0][_0x3fb2db(0x162)]==_0x3fb2db(0x119))var _0x48ca2a=users[_0x3fb2db(0x120)];else{if(_0x35efe2[0x0][_0x3fb2db(0x162)]==_0x3fb2db(0x128))var _0x48ca2a=users[_0x3fb2db(0x128)];else{if(_0x35efe2[0x0][_0x3fb2db(0x162)]=='German')var _0x48ca2a=users[_0x3fb2db(0x1bf)];else{if(_0x35efe2[0x0][_0x3fb2db(0x162)]==_0x3fb2db(0x15d))var _0x48ca2a=users['Spanish'];else{if(_0x35efe2[0x0][_0x3fb2db(0x162)]==_0x3fb2db(0x1cc))var _0x48ca2a=users[_0x3fb2db(0x1cc)];else{if(_0x35efe2[0x0][_0x3fb2db(0x162)]=='Portuguese\x20(BR)')var _0x48ca2a=users['Portuguese'];else{if(_0x35efe2[0x0][_0x3fb2db(0x162)]==_0x3fb2db(0x143))var _0x48ca2a=users[_0x3fb2db(0x143)];else{if(_0x35efe2[0x0]['language']=='Arabic\x20(ae)')var _0x48ca2a=users[_0x3fb2db(0x102)];}}}}}}}const _0xea14dd=getRandom8DigitNumber();_0xea14dd[_0x3fb2db(0x118)](_0x7e874d=>{var _0x479abe=_0x3fb2db;_0x1bf485[_0x479abe(0x175)](_0x479abe(0x1d4),{'success':_0x2dcc4d[_0x479abe(0x14e)](_0x479abe(0x131)),'errors':_0x2dcc4d['flash']('errors'),'role':_0x245433,'profile':_0x14d225,'warehouse':_0x4af312,'product':_0x33b2a1,'master_shop':_0x35efe2,'language':_0x48ca2a,'rooms_data':_0x16a1a0,'invoice_no':_0x7e874d});})[_0x3fb2db(0x159)](_0x2f9178=>{var _0x12b46f=_0x3fb2db;_0x2dcc4d['flash']('errors',_0x12b46f(0x1c9)),_0x1bf485[_0x12b46f(0x1ad)](_0x12b46f(0x177));});}catch(_0x3511f0){console[_0x3fb2db(0x1ac)](_0x3511f0);}}),router[a0_0x91e05a(0x16b)](a0_0x91e05a(0x1b5),auth,async(_0x56d517,_0x1644ba)=>{var _0x53c3e6=a0_0x91e05a;try{const {warehouse_name:_0x95051,date:_0x2e7659,prod_name:_0x394f8d,level:_0x2a49de,isle:_0x389ef9,pallet:_0x2e7e0e,stock:_0x382346,types:_0x5cc97b,adjust_qty:_0x5eb68a,new_adjust_qty:_0x5bb6ea,note:_0x189801,Room_name:_0x5cada6,invoice:_0x1f2486,JO_number:_0xe4b94e,expiry_date:_0x1a54d2}=_0x56d517[_0x53c3e6(0x132)];if(typeof _0x394f8d==_0x53c3e6(0x1ae))var _0xeab5b5=[_0x56d517['body'][_0x53c3e6(0x189)]],_0x2b472a=[_0x56d517[_0x53c3e6(0x132)]['level']],_0x13c856=[_0x56d517[_0x53c3e6(0x132)]['stock']],_0x260716=[_0x56d517[_0x53c3e6(0x132)]['types']],_0x569119=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x190)]],_0x35c52d=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1b2)]],_0x27f294=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x187)]],_0x307838=[_0x56d517['body'][_0x53c3e6(0x178)]],_0x3eadd3=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x141)]],_0x42a85e=[_0x56d517['body'][_0x53c3e6(0x11a)]],_0x23b80b=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x164)]],_0x3406d3=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1b8)]],_0xc3c77=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x108)]],_0x17527f=[_0x56d517[_0x53c3e6(0x132)]['prod_cat']],_0x41b577=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x11c)]],_0x2e4b50=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1bb)]],_0x1ade88=[_0x56d517['body'][_0x53c3e6(0xfc)]],_0x471975=[_0x56d517[_0x53c3e6(0x132)]['prod_invoice']],_0x61bca4=[_0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1c8)]];else var _0xeab5b5=[..._0x56d517[_0x53c3e6(0x132)]['prod_name']],_0x2b472a=[..._0x56d517[_0x53c3e6(0x132)]['level']],_0x13c856=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1a9)]],_0x260716=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1a2)]],_0x569119=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x190)]],_0x35c52d=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1b2)]],_0x27f294=[..._0x56d517['body']['unit']],_0x307838=[..._0x56d517[_0x53c3e6(0x132)]['Secondary_units']],_0x3eadd3=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x141)]],_0x42a85e=[..._0x56d517[_0x53c3e6(0x132)]['batch_code']],_0x23b80b=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x164)]],_0x3406d3=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1b8)]],_0xc3c77=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x108)]],_0x17527f=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x183)]],_0x41b577=[..._0x56d517['body']['Rooms']],_0x2e4b50=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1bb)]],_0x1ade88=[..._0x56d517['body'][_0x53c3e6(0xfc)]],_0x471975=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x152)]],_0x61bca4=[..._0x56d517[_0x53c3e6(0x132)][_0x53c3e6(0x1c8)]];const _0xb21842=_0xeab5b5[_0x53c3e6(0x1a5)](_0x3513b5=>{return _0x3513b5={'product_name':_0x3513b5};});_0x2b472a['forEach']((_0x5a4869,_0x548460)=>{var _0x50d99e=_0x53c3e6;_0x41b577[_0x50d99e(0x1c2)]((_0x11c761,_0x477d91)=>{var _0x3986d7=_0x50d99e;if(_0x11c761==_0x3986d7(0x156)&&_0x548460==_0x477d91){var _0x1efdf2=_0x5a4869[_0x3986d7(0x12d)](0x3);_0xb21842[_0x548460][_0x3986d7(0x11d)]=_0x5a4869[0x0],_0xb21842[_0x548460][_0x3986d7(0x1d0)]=_0x5a4869[0x1],_0xb21842[_0x548460][_0x3986d7(0x126)]=0x0,_0xb21842[_0x548460][_0x3986d7(0x129)]=0x0,_0xb21842[_0x548460]['type']=_0x3986d7(0x18a),_0xb21842[_0x548460][_0x3986d7(0x1c0)]=_0x1efdf2;}else{if(_0x11c761==_0x3986d7(0x14d)&&_0x548460==_0x477d91){var _0x1efdf2=_0x5a4869[_0x3986d7(0x12d)](0x3);_0xb21842[_0x548460][_0x3986d7(0x11d)]=_0x5a4869[0x0],_0xb21842[_0x548460][_0x3986d7(0x1d0)]=_0x5a4869[0x1],_0xb21842[_0x548460][_0x3986d7(0x126)]=0x0,_0xb21842[_0x548460]['bin']=0x0,_0xb21842[_0x548460][_0x3986d7(0x144)]=_0x3986d7(0x18a),_0xb21842[_0x548460][_0x3986d7(0x1c0)]=_0x5a4869[0x5];}else{if(_0x548460==_0x477d91){var _0x255db9;if(_0x5a4869[0x4]=='L')_0x255db9=_0x3986d7(0x12e);else _0x5a4869[0x4]=='F'&&(_0x255db9=_0x3986d7(0x18a));_0xb21842[_0x548460][_0x3986d7(0x11d)]=_0x5a4869[0x0],_0xb21842[_0x548460][_0x3986d7(0x1d0)]=_0x5a4869[0x1],_0xb21842[_0x548460][_0x3986d7(0x126)]=_0x5a4869[0x2],_0xb21842[_0x548460][_0x3986d7(0x129)]=_0x5a4869[0x3],_0xb21842[_0x548460]['type']=_0x255db9,_0xb21842[_0x548460][_0x3986d7(0x1c0)]=_0x5a4869[0x5];}}}});}),_0x13c856[_0x53c3e6(0x1c2)]((_0x48a4a8,_0x2148d5)=>{var _0x31b909=_0x53c3e6;_0xb21842[_0x2148d5][_0x31b909(0x17e)]=_0x48a4a8;}),_0x61bca4[_0x53c3e6(0x1c2)]((_0x1e8041,_0x5c1084)=>{var _0x4a6285=_0x53c3e6;_0xb21842[_0x5c1084][_0x4a6285(0x185)]=_0x1e8041;}),_0x260716[_0x53c3e6(0x1c2)]((_0x4f12cd,_0x143e00)=>{var _0x2c44b1=_0x53c3e6;_0xb21842[_0x143e00][_0x2c44b1(0x1a2)]=_0x4f12cd;}),_0x569119[_0x53c3e6(0x1c2)]((_0x4527a2,_0x3927a6)=>{var _0x4b2e6b=_0x53c3e6;_0xb21842[_0x3927a6][_0x4b2e6b(0xff)]=_0x4527a2;}),_0x35c52d[_0x53c3e6(0x1c2)]((_0xee0d58,_0x301137)=>{var _0x4655ac=_0x53c3e6;_0xb21842[_0x301137][_0x4655ac(0x125)]=_0xee0d58;}),_0x27f294['forEach']((_0x5703bd,_0x585db0)=>{var _0x59ebe4=_0x53c3e6;_0xb21842[_0x585db0][_0x59ebe4(0x19d)]=_0x5703bd;}),_0x307838[_0x53c3e6(0x1c2)]((_0x492c79,_0x5e794e)=>{var _0x422f3c=_0x53c3e6;_0xb21842[_0x5e794e][_0x422f3c(0x19c)]=_0x492c79;}),_0x3eadd3[_0x53c3e6(0x1c2)]((_0x1702e4,_0x3c119f)=>{var _0x507198=_0x53c3e6;_0xb21842[_0x3c119f][_0x507198(0x116)]=_0x1702e4;}),_0x42a85e[_0x53c3e6(0x1c2)]((_0x20490d,_0x3ca3aa)=>{var _0x56e5c5=_0x53c3e6;_0xb21842[_0x3ca3aa][_0x56e5c5(0x11a)]=_0x20490d;}),_0x23b80b['forEach']((_0x40a439,_0x2c6983)=>{var _0x3ebe82=_0x53c3e6;_0xb21842[_0x2c6983][_0x3ebe82(0x164)]=_0x40a439;}),_0x3406d3[_0x53c3e6(0x1c2)]((_0x2f281e,_0x3fb8a5)=>{var _0x73a4c3=_0x53c3e6;_0xb21842[_0x3fb8a5][_0x73a4c3(0x13e)]=_0x2f281e;}),_0xc3c77[_0x53c3e6(0x1c2)]((_0x5478cd,_0x40c6f9)=>{var _0x303fad=_0x53c3e6;_0xb21842[_0x40c6f9][_0x303fad(0x108)]=_0x5478cd;}),_0x17527f[_0x53c3e6(0x1c2)]((_0x5d664a,_0x274d8b)=>{var _0x16765c=_0x53c3e6;_0xb21842[_0x274d8b][_0x16765c(0x183)]=_0x5d664a;}),_0x41b577['forEach']((_0x11190,_0x25b825)=>{var _0x558390=_0x53c3e6;_0xb21842[_0x25b825][_0x558390(0x1a1)]=_0x11190;}),_0x2e4b50[_0x53c3e6(0x1c2)]((_0x3d30b2,_0x462fef)=>{var _0x5ccb4a=_0x53c3e6;_0xb21842[_0x462fef][_0x5ccb4a(0x111)]=_0x3d30b2;}),_0x1ade88['forEach']((_0x377ac3,_0x3b5b43)=>{var _0x51bace=_0x53c3e6;_0xb21842[_0x3b5b43][_0x51bace(0x1af)]=_0x377ac3;}),_0x471975['forEach']((_0x591987,_0x482c9d)=>{var _0x327955=_0x53c3e6;_0xb21842[_0x482c9d][_0x327955(0x148)]=_0x591987;});const _0x2eff46=_0xb21842[_0x53c3e6(0x169)](_0x21b516=>_0x21b516[_0x53c3e6(0xff)]!=='0'&&_0x21b516['adjust_qty']!=='');var _0x41ba41=0x0;_0x2eff46[_0x53c3e6(0x1c2)](_0x48638b=>{var _0x995c47=_0x53c3e6;console[_0x995c47(0x1ac)](_0x995c47(0x1b3),_0x48638b),parseInt(_0x48638b[_0x995c47(0xff)])<=0x0&&_0x41ba41++;});if(_0x41ba41!=0x0)return _0x56d517[_0x53c3e6(0x14e)](_0x53c3e6(0x100),_0x53c3e6(0x15b)),_0x1644ba[_0x53c3e6(0x1ad)](_0x53c3e6(0x149));const _0x59407e=new adjustment({'warehouse_name':_0x95051,'date':_0x2e7659,'product':_0x2eff46,'note':_0x189801,'room':_0x5cada6,'invoice':_0x1f2486,'JO_number':_0xe4b94e,'expiry_date':_0x1a54d2}),_0x513df6=await _0x59407e['save']();_0x56d517[_0x53c3e6(0x14e)](_0x53c3e6(0x131),_0x53c3e6(0x161)),_0x1644ba[_0x53c3e6(0x1ad)]('/adjustment/preview/'+_0x513df6['_id']);}catch(_0x5e2ff2){console[_0x53c3e6(0x1ac)](_0x5e2ff2),_0x1644ba[_0x53c3e6(0x1d5)](0xc8)[_0x53c3e6(0x160)]({'message':_0x5e2ff2[_0x53c3e6(0x142)]});}}),router[a0_0x91e05a(0x121)](a0_0x91e05a(0x146),auth,async(_0x57a0e1,_0x46328e)=>{var _0xf4b226=a0_0x91e05a;try{const {username:_0xd5e6e6,email:_0x108c77,role:_0x31cc79}=_0x57a0e1[_0xf4b226(0x123)],_0x1cef40=_0x57a0e1[_0xf4b226(0x123)],_0x28ba53=await profile[_0xf4b226(0x1a8)]({'email':_0x1cef40[_0xf4b226(0x11e)]}),_0x3771e8=await master_shop[_0xf4b226(0x1a4)](),_0x319bef=_0x57a0e1[_0xf4b226(0x186)]['id'],_0x3ab2c3=await adjustment[_0xf4b226(0x137)]({'_id':_0x319bef}),_0x3503e8=await purchases[_0xf4b226(0xfb)]([{'$match':{'warehouse_name':_0x3ab2c3['warehouse_name']}},{'$unwind':_0xf4b226(0x150)},{'$group':{'_id':_0xf4b226(0x182)}}]),_0x472fc2=await product[_0xf4b226(0x1a4)]({}),_0x367a6f=await warehouse[_0xf4b226(0xfb)]([{'$match':{'name':_0x3ab2c3['warehouse_name']}},{'$unwind':_0xf4b226(0x12b)},{'$group':{'_id':_0xf4b226(0x196),'name':{'$first':_0xf4b226(0x1a7)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xf4b226(0x17d)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xf4b226(0x113)},'floorlevel':{'$first':_0xf4b226(0x165)},'primary_code':{'$first':_0xf4b226(0x176)},'secondary_code':{'$first':_0xf4b226(0x1b6)},'product_code':{'$first':_0xf4b226(0x18d)},'storage':{'$first':_0xf4b226(0x180)},'rack':{'$first':_0xf4b226(0x13c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0xf4b226(0x122)},'production_date':{'$first':_0xf4b226(0x15e)},'batch_code':{'$first':_0xf4b226(0x192)},'room':{'$first':'$room'}}}]);if(_0x3771e8[0x0][_0xf4b226(0x162)]==_0xf4b226(0x119)){var _0x4869d9=users[_0xf4b226(0x120)];console[_0xf4b226(0x1ac)](_0x4869d9);}else{if(_0x3771e8[0x0]['language']=='Hindi')var _0x4869d9=users[_0xf4b226(0x128)];else{if(_0x3771e8[0x0][_0xf4b226(0x162)]==_0xf4b226(0x1bf))var _0x4869d9=users[_0xf4b226(0x1bf)];else{if(_0x3771e8[0x0][_0xf4b226(0x162)]=='Spanish')var _0x4869d9=users[_0xf4b226(0x15d)];else{if(_0x3771e8[0x0][_0xf4b226(0x162)]==_0xf4b226(0x1cc))var _0x4869d9=users['French'];else{if(_0x3771e8[0x0][_0xf4b226(0x162)]==_0xf4b226(0x10f))var _0x4869d9=users['Portuguese'];else{if(_0x3771e8[0x0]['language']==_0xf4b226(0x143))var _0x4869d9=users[_0xf4b226(0x143)];else{if(_0x3771e8[0x0][_0xf4b226(0x162)]==_0xf4b226(0x163))var _0x4869d9=users['Arabic'];}}}}}}}_0x46328e['render']('edit_adjustment_view',{'success':_0x57a0e1[_0xf4b226(0x14e)]('success'),'errors':_0x57a0e1[_0xf4b226(0x14e)]('errors'),'role':_0x1cef40,'profile':_0x28ba53,'adjustment':_0x3ab2c3,'stock':_0x367a6f,'master_shop':_0x3771e8,'warehouse_name':_0x3503e8,'unit':_0x472fc2,'language':_0x4869d9});}catch(_0x164f6a){console[_0xf4b226(0x1ac)](_0x164f6a),_0x46328e['status'](0xc8)['json']({'message':_0x164f6a[_0xf4b226(0x142)]});}}),router[a0_0x91e05a(0x16b)]('/preview/:id',auth,async(_0x11d561,_0x4e3ee6)=>{var _0xb8cadc=a0_0x91e05a;try{const _0x2691ee=_0x11d561[_0xb8cadc(0x186)]['id'],{warehouse_name:_0x254ba1,Room_name:_0x7cc0f2}=_0x11d561[_0xb8cadc(0x132)],_0x4478ef=await adjustment[_0xb8cadc(0x137)]({'_id':_0x2691ee}),_0x240ec6=_0x4478ef['product'][_0xb8cadc(0x1a5)](async _0x39eb51=>{var _0x4600d3=_0xb8cadc;if(_0x39eb51[_0x4600d3(0xff)]>0x0){var _0x22a614=await warehouse[_0x4600d3(0x1a8)]({'name':_0x254ba1,'room':_0x39eb51['room_names'],'warehouse_category':'Raw\x20Materials'});const _0x13bde8=_0x22a614[_0x4600d3(0x1d2)][_0x4600d3(0x1a5)](_0x242ff1=>{var _0x5270ac=_0x4600d3;console['log'](_0x39eb51['types']+_0x5270ac(0x133));if(_0x39eb51[_0x5270ac(0x1a2)]==_0x5270ac(0x11f)){if(_0x242ff1[_0x5270ac(0x1c5)]==_0x39eb51[_0x5270ac(0x1c5)]&&_0x242ff1['floorlevel']==_0x39eb51['floorlevel']&&_0x242ff1[_0x5270ac(0x144)]==_0x39eb51[_0x5270ac(0x144)]&&_0x242ff1['bin']==_0x39eb51[_0x5270ac(0x129)]&&_0x242ff1['bay']==_0x39eb51[_0x5270ac(0x126)]&&_0x242ff1['rack']==_0x39eb51[_0x5270ac(0x1d0)]&&_0x242ff1[_0x5270ac(0x11d)]==_0x39eb51[_0x5270ac(0x11d)]&&_0x242ff1['expiry_date']==_0x39eb51[_0x5270ac(0x164)]&&_0x242ff1[_0x5270ac(0x11a)]==_0x39eb51['batch_code']&&_0x242ff1[_0x5270ac(0x108)]==_0x39eb51[_0x5270ac(0x108)]&&_0x242ff1['invoice']==_0x39eb51['invoice']&&_0x242ff1['_id']==_0x39eb51[_0x5270ac(0x185)]){var _0x170694;_0x170694=_0x39eb51['adjust_qty'],_0x39eb51[_0x5270ac(0x183)]=='S'&&(_0x170694=_0x39eb51[_0x5270ac(0xff)]),_0x242ff1[_0x5270ac(0x199)]=_0x242ff1['product_stock']-_0x170694;}}else{if(_0x242ff1[_0x5270ac(0x1c5)]==_0x39eb51[_0x5270ac(0x1c5)]&&_0x242ff1[_0x5270ac(0x1c0)]==_0x39eb51['floorlevel']&&_0x242ff1[_0x5270ac(0x144)]==_0x39eb51['type']&&_0x242ff1[_0x5270ac(0x129)]==_0x39eb51[_0x5270ac(0x129)]&&_0x242ff1[_0x5270ac(0x126)]==_0x39eb51[_0x5270ac(0x126)]&&_0x242ff1[_0x5270ac(0x1d0)]==_0x39eb51[_0x5270ac(0x1d0)]&&_0x242ff1[_0x5270ac(0x11d)]==_0x39eb51[_0x5270ac(0x11d)]&&_0x242ff1[_0x5270ac(0x164)]==_0x39eb51['expiry_date']&&_0x242ff1[_0x5270ac(0x11a)]==_0x39eb51['batch_code']&&_0x242ff1[_0x5270ac(0x108)]==_0x39eb51[_0x5270ac(0x108)]&&_0x242ff1['invoice']==_0x39eb51[_0x5270ac(0x148)]&&_0x242ff1[_0x5270ac(0x115)]==_0x39eb51[_0x5270ac(0x185)]){console[_0x5270ac(0x1ac)](_0x39eb51);var _0x170694;_0x170694=_0x39eb51[_0x5270ac(0xff)],_0x39eb51[_0x5270ac(0x183)]=='S'&&(_0x170694=_0x39eb51[_0x5270ac(0xff)]),_0x242ff1[_0x5270ac(0x199)]=_0x242ff1['product_stock']+_0x170694;}}});}return _0x22a614;});Promise[_0xb8cadc(0x107)](_0x240ec6)['then'](async _0x575323=>{var _0x33df2b=_0xb8cadc;try{for(const _0x4b852a of _0x575323){await _0x4b852a[_0x33df2b(0x158)]();}_0x4478ef['finalize']=_0x33df2b(0x15c);const _0x4913d5=await _0x4478ef[_0x33df2b(0x158)](),_0x389f3c=await master_shop['find'](),_0x224a39=await email_settings[_0x33df2b(0x1a8)](),_0x43f425=await supervisor_settings[_0x33df2b(0x1a4)]();var _0x38c9ce=_0x4478ef[_0x33df2b(0x198)],_0x3b7d6c='',_0x2b9d61;for(_0x2b9d61 in _0x38c9ce){_0x3b7d6c+=_0x33df2b(0x19f)+_0x33df2b(0x174)+_0x38c9ce[_0x2b9d61]['product_name']+_0x33df2b(0x117)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x38c9ce[_0x2b9d61]['product_code']+_0x33df2b(0x117)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x38c9ce[_0x2b9d61][_0x33df2b(0xff)]+_0x33df2b(0x117)+_0x33df2b(0x174)+_0x38c9ce[_0x2b9d61][_0x33df2b(0x19d)]+'</td>'+_0x33df2b(0x174)+_0x38c9ce[_0x2b9d61][_0x33df2b(0x19c)]+_0x33df2b(0x117)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4478ef[_0x33df2b(0x140)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x38c9ce[_0x2b9d61][_0x33df2b(0x1a1)]+'</td>'+_0x33df2b(0x174)+_0x38c9ce[_0x2b9d61]['storage']+_0x38c9ce[_0x2b9d61][_0x33df2b(0x1d0)]+_0x38c9ce[_0x2b9d61][_0x33df2b(0x126)]+_0x38c9ce[_0x2b9d61][_0x33df2b(0x129)]+_0x38c9ce[_0x2b9d61][_0x33df2b(0x144)][0x0]+_0x38c9ce[_0x2b9d61][_0x33df2b(0x1c0)]+_0x33df2b(0x117),_0x33df2b(0x18b);}let _0x226301=nodemailer['createTransport']({'host':_0x224a39[_0x33df2b(0x168)],'port':Number(_0x224a39[_0x33df2b(0x184)]),'secure':![],'auth':{'user':_0x224a39[_0x33df2b(0x11e)],'pass':_0x224a39['password']}}),_0x1f5243={'from':_0x224a39['email'],'to':_0x43f425[0x0][_0x33df2b(0x14a)],'subject':_0x33df2b(0x18e),'attachments':[{'filename':_0x33df2b(0x10d),'path':__dirname+_0x33df2b(0x1a6)+_0x33df2b(0x1c4)+_0x389f3c[0x0][_0x33df2b(0x19b)],'cid':_0x33df2b(0x17f)}],'html':_0x33df2b(0x10a)+_0x33df2b(0x1cd)+_0x33df2b(0x139)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x33df2b(0x194)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x33df2b(0x15a)+_0x33df2b(0x194)+_0x33df2b(0x109)+_0x389f3c[0x0]['site_title']+_0x33df2b(0x1bd)+_0x33df2b(0x15a)+_0x33df2b(0x15a)+_0x33df2b(0x19e)+_0x33df2b(0x194)+_0x33df2b(0x1b9)+_0x33df2b(0x167)+_0x4478ef[_0x33df2b(0x148)]+'\x20'+_0x33df2b(0x136)+_0x33df2b(0x1ce)+_0x4478ef[_0x33df2b(0x153)]+'\x20'+_0x33df2b(0x181)+_0x33df2b(0x1b4)+_0x33df2b(0x15a)+_0x33df2b(0x10c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x33df2b(0x19f)+_0x33df2b(0x155)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x33df2b(0x17c)+_0x33df2b(0x188)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x33df2b(0x14f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x33df2b(0x12a)+_0x33df2b(0x18b)+_0x33df2b(0x1be)+_0x33df2b(0x171)+'\x20'+_0x3b7d6c+'\x20'+_0x33df2b(0x13b)+_0x33df2b(0x1cf)+'<div>'+_0x33df2b(0x103)+_0x33df2b(0x1ca)+_0x389f3c[0x0][_0x33df2b(0x112)]+'</h5>'+'</div>'+'</div>'+'</body></html>'};_0x226301[_0x33df2b(0x191)](_0x1f5243,function(_0x1724fb,_0x1b01e3){var _0x377a26=_0x33df2b;_0x1724fb?(console[_0x377a26(0x1ac)](_0x1724fb),console['log']('Error\x20Occurs')):console[_0x377a26(0x1ac)]('Email\x20sent\x20successfully');}),_0x11d561[_0x33df2b(0x14e)]('success',_0x33df2b(0x147)),_0x4e3ee6['redirect'](_0x33df2b(0x1d1)+_0x4913d5[_0x33df2b(0x115)]);}catch(_0x2b9237){console['error'](_0x2b9237),_0x4e3ee6[_0x33df2b(0x1d5)](0x1f4)[_0x33df2b(0x160)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0xb8cadc(0x159)](_0x3b2387=>{var _0x2335be=_0xb8cadc;console[_0x2335be(0x1b1)](_0x3b2387),_0x4e3ee6['status'](0x1f4)[_0x2335be(0x160)]({'error':_0x2335be(0x1b7)});});}catch(_0x2d2dd2){console[_0xb8cadc(0x1ac)](_0x2d2dd2),_0x4e3ee6[_0xb8cadc(0x1d5)](0xc8)[_0xb8cadc(0x160)]({'message':_0x2d2dd2[_0xb8cadc(0x142)]});}}),router['get'](a0_0x91e05a(0x105),auth,async(_0x25e3c7,_0x1fe0d2)=>{var _0x5175ec=a0_0x91e05a;try{const {username:_0x5dc172,email:_0x33b52d,role:_0x1394ae}=_0x25e3c7['user'],_0x558040=_0x25e3c7[_0x5175ec(0x123)],_0x38fe1b=await profile['findOne']({'email':_0x558040[_0x5175ec(0x11e)]}),_0x58c73c=await master_shop[_0x5175ec(0x1a4)](),_0x4199e4=_0x25e3c7[_0x5175ec(0x186)]['id'],_0x1fac47=await adjustment[_0x5175ec(0x137)]({'_id':_0x4199e4}),_0xdaacdb=await purchases[_0x5175ec(0xfb)]([{'$match':{'warehouse_name':_0x1fac47[_0x5175ec(0x140)]}},{'$unwind':'$product'},{'$group':{'_id':_0x5175ec(0x182)}}]),_0x4b1c37=await product[_0x5175ec(0x1a4)]({}),_0x12ee84=await warehouse[_0x5175ec(0xfb)]([{'$match':{'name':_0x1fac47[_0x5175ec(0x140)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x5175ec(0x196),'name':{'$first':_0x5175ec(0x1a7)},'product_stock':{'$first':_0x5175ec(0xfd)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5175ec(0x124)},'type':{'$first':_0x5175ec(0x113)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5175ec(0x18d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5175ec(0x13c)},'maxPerUnit':{'$first':_0x5175ec(0x106)},'expiry_date':{'$first':_0x5175ec(0x122)},'production_date':{'$first':_0x5175ec(0x15e)},'batch_code':{'$first':_0x5175ec(0x192)},'room':{'$first':_0x5175ec(0x1a0)}}}]);let _0x5e92d0;if(_0x558040['role']=='staff'){const _0x21219f=await staff[_0x5175ec(0x1a8)]({'email':_0x558040['email']});_0x5e92d0=await warehouse[_0x5175ec(0xfb)]([{'$match':{'status':'Enabled','name':_0x21219f[_0x5175ec(0x1aa)],'warehouse_category':_0x5175ec(0x179),'name':{'$ne':_0x5175ec(0xfe)}}},{'$group':{'_id':_0x5175ec(0x193),'name':{'$first':_0x5175ec(0x193)}}}]);}else _0x5e92d0=await warehouse['aggregate']([{'$match':{'status':_0x5175ec(0x11b),'warehouse_category':_0x5175ec(0x179),'name':{'$ne':_0x5175ec(0xfe)}}},{'$group':{'_id':_0x5175ec(0x193),'name':{'$first':_0x5175ec(0x193)}}}]);if(_0x58c73c[0x0]['language']==_0x5175ec(0x119)){var _0x4fbc4b=users['English'];console['log'](_0x4fbc4b);}else{if(_0x58c73c[0x0][_0x5175ec(0x162)]==_0x5175ec(0x128))var _0x4fbc4b=users[_0x5175ec(0x128)];else{if(_0x58c73c[0x0]['language']=='German')var _0x4fbc4b=users[_0x5175ec(0x1bf)];else{if(_0x58c73c[0x0][_0x5175ec(0x162)]==_0x5175ec(0x15d))var _0x4fbc4b=users['Spanish'];else{if(_0x58c73c[0x0][_0x5175ec(0x162)]==_0x5175ec(0x1cc))var _0x4fbc4b=users[_0x5175ec(0x1cc)];else{if(_0x58c73c[0x0][_0x5175ec(0x162)]=='Portuguese\x20(BR)')var _0x4fbc4b=users[_0x5175ec(0x1a3)];else{if(_0x58c73c[0x0][_0x5175ec(0x162)]=='Chinese')var _0x4fbc4b=users['Chinese'];else{if(_0x58c73c[0x0][_0x5175ec(0x162)]==_0x5175ec(0x163))var _0x4fbc4b=users[_0x5175ec(0x102)];}}}}}}}_0x1fe0d2[_0x5175ec(0x175)](_0x5175ec(0x1ba),{'success':_0x25e3c7[_0x5175ec(0x14e)](_0x5175ec(0x131)),'errors':_0x25e3c7[_0x5175ec(0x14e)]('errors'),'role':_0x558040,'profile':_0x38fe1b,'adjustment':_0x1fac47,'stock':_0x12ee84,'master_shop':_0x58c73c,'warehouse_name':_0xdaacdb,'unit':_0x4b1c37,'language':_0x4fbc4b,'warehouse':_0x5e92d0});}catch(_0x1fc823){console[_0x5175ec(0x1ac)](_0x1fc823),_0x1fe0d2[_0x5175ec(0x1d5)](0xc8)[_0x5175ec(0x160)]({'message':_0x1fc823[_0x5175ec(0x142)]});}}),router['post']('/view/:id',auth,async(_0x63d103,_0x3aa36b)=>{var _0x4dca40=a0_0x91e05a;try{const _0x4abef4=_0x63d103[_0x4dca40(0x186)]['id'],_0x13e3fd=await adjustment[_0x4dca40(0x137)]({'_id':_0x4abef4}),_0x49a1bc=await warehouse[_0x4dca40(0x1a8)]({'name':_0x13e3fd[_0x4dca40(0x140)],'room':_0x13e3fd[_0x4dca40(0x166)]}),{warehouse_name:_0x49017c,date:_0x21ac70,prod_name:_0x32b682,level:_0x351a9c,isle:_0x4c2b38,pallet:_0x4ac9bb,stock:_0x3a8713,types:_0x1d9e3b,adjust_qty:_0x4ba6f2,new_adjust_qty:_0x1f27cd,note:_0x3ac536,Room_name:_0x53d890,invoice:_0x1db69f,JO_number:_0x2cf670,expiry_date:_0x520fab}=_0x63d103[_0x4dca40(0x132)];if(typeof _0x32b682==_0x4dca40(0x1ae))var _0xb6c092=[_0x63d103['body']['prod_name']],_0x432605=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x101)]],_0x187652=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x1a9)]],_0x491ed9=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x1a2)]],_0x1e4cff=[_0x63d103['body'][_0x4dca40(0x190)]],_0x1be1b5=[_0x63d103[_0x4dca40(0x132)]['New_Qty_Converted']],_0x101b0a=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x187)]],_0x1e64e3=[_0x63d103['body'][_0x4dca40(0x178)]],_0x3ce821=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x141)]],_0x2e1294=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x11a)]],_0x568a9b=[_0x63d103['body'][_0x4dca40(0x164)]],_0xdb8f74=[_0x63d103['body']['max_per_unit']],_0x29ef54=[_0x63d103['body'][_0x4dca40(0x108)]],_0x2c42de=[_0x63d103[_0x4dca40(0x132)]['prod_cat']],_0x3a04a2=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x11c)]],_0x220e97=[_0x63d103[_0x4dca40(0x132)][_0x4dca40(0x1bb)]],_0x148698=[_0x63d103['body'][_0x4dca40(0xfc)]];else var _0xb6c092=[..._0x63d103['body']['prod_name']],_0x432605=[..._0x63d103[_0x4dca40(0x132)][_0x4dca40(0x101)]],_0x187652=[..._0x63d103[_0x4dca40(0x132)]['stock']],_0x491ed9=[..._0x63d103[_0x4dca40(0x132)][_0x4dca40(0x1a2)]],_0x1e4cff=[..._0x63d103[_0x4dca40(0x132)][_0x4dca40(0x190)]],_0x1be1b5=[..._0x63d103['body'][_0x4dca40(0x1b2)]],_0x101b0a=[..._0x63d103['body'][_0x4dca40(0x19d)]],_0x1e64e3=[..._0x63d103['body'][_0x4dca40(0x178)]],_0x3ce821=[..._0x63d103[_0x4dca40(0x132)][_0x4dca40(0x141)]],_0x2e1294=[..._0x63d103['body'][_0x4dca40(0x11a)]],_0x568a9b=[..._0x63d103[_0x4dca40(0x132)]['expiry_date']],_0xdb8f74=[..._0x63d103[_0x4dca40(0x132)]['max_per_unit']],_0x29ef54=[..._0x63d103['body']['production_date']],_0x2c42de=[..._0x63d103['body'][_0x4dca40(0x183)]],_0x3a04a2=[..._0x63d103[_0x4dca40(0x132)]['Rooms']],_0x220e97=[..._0x63d103['body'][_0x4dca40(0x1bb)]],_0x148698=[..._0x63d103[_0x4dca40(0x132)][_0x4dca40(0xfc)]];const _0x18e355=_0xb6c092[_0x4dca40(0x1a5)](_0x534b22=>{return _0x534b22={'product_name':_0x534b22};});_0x432605[_0x4dca40(0x1c2)]((_0x29c404,_0x1cc46d)=>{var _0x2cc977=_0x4dca40;_0x3a04a2[_0x2cc977(0x1c2)]((_0x227fc9,_0xba9d89)=>{var _0x166895=_0x2cc977;if(_0x227fc9==_0x166895(0x156)&&_0x1cc46d==_0xba9d89){var _0x189af0=_0x29c404['slice'](0x3);_0x18e355[_0x1cc46d][_0x166895(0x11d)]=_0x29c404[0x0],_0x18e355[_0x1cc46d]['rack']=_0x29c404[0x1],_0x18e355[_0x1cc46d][_0x166895(0x126)]=0x0,_0x18e355[_0x1cc46d]['bin']=0x0,_0x18e355[_0x1cc46d]['type']=_0x166895(0x18a),_0x18e355[_0x1cc46d]['floorlevel']=_0x189af0;}else{if(_0x227fc9==_0x166895(0x14d)&&_0x1cc46d==_0xba9d89){var _0x189af0=_0x29c404[_0x166895(0x12d)](0x3);_0x18e355[_0x1cc46d][_0x166895(0x11d)]=_0x29c404[0x0],_0x18e355[_0x1cc46d][_0x166895(0x1d0)]=_0x29c404[0x1],_0x18e355[_0x1cc46d]['bay']=0x0,_0x18e355[_0x1cc46d][_0x166895(0x129)]=0x0,_0x18e355[_0x1cc46d]['type']=_0x166895(0x18a),_0x18e355[_0x1cc46d][_0x166895(0x1c0)]=_0x29c404[0x5];}else{if(_0x1cc46d==_0xba9d89){var _0x5263dc;if(_0x29c404[0x4]=='L')_0x5263dc=_0x166895(0x12e);else _0x29c404[0x4]=='F'&&(_0x5263dc='Floor');_0x18e355[_0x1cc46d][_0x166895(0x11d)]=_0x29c404[0x0],_0x18e355[_0x1cc46d]['rack']=_0x29c404[0x1],_0x18e355[_0x1cc46d][_0x166895(0x126)]=_0x29c404[0x2],_0x18e355[_0x1cc46d][_0x166895(0x129)]=_0x29c404[0x3],_0x18e355[_0x1cc46d][_0x166895(0x144)]=_0x5263dc,_0x18e355[_0x1cc46d][_0x166895(0x1c0)]=_0x29c404[0x5];}}}});}),_0x187652[_0x4dca40(0x1c2)]((_0xbaa171,_0xbcdaa4)=>{var _0x4ae8b0=_0x4dca40;_0x18e355[_0xbcdaa4][_0x4ae8b0(0x17e)]=_0xbaa171;}),_0x491ed9[_0x4dca40(0x1c2)]((_0x2e9ee7,_0xad1484)=>{var _0x7a06da=_0x4dca40;_0x18e355[_0xad1484][_0x7a06da(0x1a2)]=_0x2e9ee7;}),_0x1e4cff['forEach']((_0x19104f,_0x5c2d8a)=>{_0x18e355[_0x5c2d8a]['adjust_qty']=_0x19104f;}),_0x1be1b5[_0x4dca40(0x1c2)]((_0x455a58,_0x28d32e)=>{var _0x5da7df=_0x4dca40;_0x18e355[_0x28d32e][_0x5da7df(0x125)]=_0x455a58;}),_0x101b0a[_0x4dca40(0x1c2)]((_0x53604f,_0x2f1cff)=>{var _0x44f0a0=_0x4dca40;_0x18e355[_0x2f1cff][_0x44f0a0(0x19d)]=_0x53604f;}),_0x1e64e3['forEach']((_0x535b5a,_0xcfab3a)=>{_0x18e355[_0xcfab3a]['secondary_unit']=_0x535b5a;}),_0x3ce821[_0x4dca40(0x1c2)]((_0x56fb1b,_0x28f51d)=>{var _0x24b759=_0x4dca40;_0x18e355[_0x28f51d][_0x24b759(0x116)]=_0x56fb1b;}),_0x2e1294['forEach']((_0x337021,_0x344a71)=>{var _0x4794e4=_0x4dca40;_0x18e355[_0x344a71][_0x4794e4(0x11a)]=_0x337021;}),_0x568a9b[_0x4dca40(0x1c2)]((_0x4db518,_0x5d6ca6)=>{var _0x45388a=_0x4dca40;_0x18e355[_0x5d6ca6][_0x45388a(0x164)]=_0x4db518;}),_0xdb8f74[_0x4dca40(0x1c2)]((_0x79c3b4,_0x28e67e)=>{var _0x1f4784=_0x4dca40;_0x18e355[_0x28e67e][_0x1f4784(0x13e)]=_0x79c3b4;}),_0x29ef54[_0x4dca40(0x1c2)]((_0x3ff95d,_0x338751)=>{var _0x4b40f4=_0x4dca40;_0x18e355[_0x338751][_0x4b40f4(0x108)]=_0x3ff95d;}),_0x2c42de[_0x4dca40(0x1c2)]((_0x1d374d,_0x573f7a)=>{_0x18e355[_0x573f7a]['prod_cat']=_0x1d374d;}),_0x3a04a2[_0x4dca40(0x1c2)]((_0x2a846f,_0x1433bf)=>{var _0x83e867=_0x4dca40;_0x18e355[_0x1433bf][_0x83e867(0x1a1)]=_0x2a846f;}),_0x220e97[_0x4dca40(0x1c2)]((_0x446b0a,_0x8a4645)=>{var _0x5b3749=_0x4dca40;_0x18e355[_0x8a4645][_0x5b3749(0x111)]=_0x446b0a;}),_0x148698[_0x4dca40(0x1c2)]((_0x5d905a,_0x5a8fea)=>{var _0x256c56=_0x4dca40;_0x18e355[_0x5a8fea][_0x256c56(0x1af)]=_0x5d905a;});const _0x21a763=_0x18e355['filter'](_0x1892fc=>_0x1892fc[_0x4dca40(0xff)]!=='0'&&_0x1892fc[_0x4dca40(0xff)]!=='');var _0x3485b5=0x0;_0x21a763[_0x4dca40(0x1c2)](_0x288aae=>{var _0x9aa314=_0x4dca40;console[_0x9aa314(0x1ac)](_0x9aa314(0x1b3),_0x288aae),parseInt(_0x288aae[_0x9aa314(0xff)])<=0x0&&_0x3485b5++;});if(_0x3485b5!=0x0)return _0x63d103[_0x4dca40(0x14e)](_0x4dca40(0x100),_0x4dca40(0x15b)),_0x3aa36b['redirect']('back');_0x13e3fd[_0x4dca40(0x140)]=_0x49017c,_0x13e3fd[_0x4dca40(0x153)]=_0x21ac70,_0x13e3fd[_0x4dca40(0x198)]=_0x21a763,_0x13e3fd[_0x4dca40(0x104)]=_0x3ac536,_0x13e3fd['invoice']=_0x1db69f,_0x13e3fd[_0x4dca40(0x10b)]='False';const _0x586cbb=await _0x13e3fd[_0x4dca40(0x158)]();_0x63d103[_0x4dca40(0x14e)](_0x4dca40(0x131),_0x4dca40(0x14c)),_0x3aa36b[_0x4dca40(0x1ad)](_0x4dca40(0x177));}catch(_0x29ff94){console[_0x4dca40(0x1ac)](_0x29ff94);}}),router['post'](a0_0x91e05a(0x19a),async(_0x484f7c,_0x10ab10)=>{var _0x14b725=a0_0x91e05a;const {primary_code:_0x5aeea7,warehouse_data:_0x1ad3f0,rooms_data:_0x80231c,Roomslist:_0x32633c}=_0x484f7c['body'],_0x477c79=_0x32633c[_0x14b725(0x110)](','),_0x541abe=[];async function _0xf1f871(_0x302e6d){var _0x407a58=_0x14b725;const _0xe6b656=await warehouse['aggregate']([{'$match':{'name':_0x1ad3f0,'room':_0x302e6d}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5aeea7}},{'$group':{'_id':_0x407a58(0x196),'name':{'$first':_0x407a58(0x1a7)},'product_stock':{'$first':_0x407a58(0xfd)},'primary_code':{'$first':_0x407a58(0x176)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x407a58(0x17d)},'isle':{'$first':_0x407a58(0x124)},'type':{'$first':_0x407a58(0x113)},'pallet':{'$first':_0x407a58(0x165)},'unit':{'$first':_0x407a58(0x1c7)},'secondary_unit':{'$first':_0x407a58(0x1d3)},'storage':{'$first':_0x407a58(0x180)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x407a58(0x15e)},'maxPerUnit':{'$first':_0x407a58(0x106)},'batch_code':{'$first':_0x407a58(0x192)},'product_cat':{'$first':_0x407a58(0x13d)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x407a58(0x1a0)},'invoice':{'$first':_0x407a58(0x151)}}}]),_0x1e9347=await warehouse[_0x407a58(0xfb)]([{'$match':{'name':_0x1ad3f0,'room':_0x302e6d}},{'$unwind':_0x407a58(0x12b)},{'$match':{'product_details.secondary_code':_0x5aeea7}},{'$group':{'_id':_0x407a58(0x196),'name':{'$first':_0x407a58(0x1a7)},'product_stock':{'$first':_0x407a58(0xfd)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x407a58(0x1b6)},'product_code':{'$first':_0x407a58(0x18d)},'level':{'$first':_0x407a58(0x17d)},'isle':{'$first':_0x407a58(0x124)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x407a58(0x165)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x407a58(0x1d3)},'storage':{'$first':_0x407a58(0x180)},'rack':{'$first':_0x407a58(0x13c)},'expiry_date':{'$first':_0x407a58(0x122)},'production_date':{'$first':_0x407a58(0x15e)},'maxPerUnit':{'$first':_0x407a58(0x106)},'batch_code':{'$first':_0x407a58(0x192)},'product_cat':{'$first':_0x407a58(0x13d)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x407a58(0x1a0)}}}]);if(_0xe6b656[_0x407a58(0xfa)]>0x0)_0x541abe[_0x407a58(0x10e)](_0xe6b656);else _0x1e9347['length']>0x0&&_0x541abe[_0x407a58(0x10e)](_0x1e9347);}const _0x298087=_0x477c79[_0x14b725(0x1a5)](_0x2f2f74=>_0xf1f871(_0x2f2f74));await Promise['all'](_0x298087),_0x10ab10[_0x14b725(0x160)](_0x541abe);}),router[a0_0x91e05a(0x16b)](a0_0x91e05a(0x135),async(_0x12f9af,_0x48cf7e)=>{var _0x2cc61a=a0_0x91e05a;const {primaryCode:_0x35a40d,secondaryCode:_0x585dff,productCode:_0x2811bd,level:_0xd7ff1d,isle:_0x3b1ba9,pallet:_0x4b3f60,warehouses:_0x39c27a,room:_0x2a7aef}=_0x12f9af[_0x2cc61a(0x132)];try{const _0xc53e30=await warehouse['aggregate']([{'$match':{'name':_0x39c27a,'room':_0x2a7aef}},{'$unwind':_0x2cc61a(0x12b)},{'$match':{'product_details.level':parseInt(_0xd7ff1d),'product_details.isle':_0x3b1ba9,'product_details.pallet':parseInt(_0x4b3f60)}},{'$group':{'_id':_0x2cc61a(0x196),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2cc61a(0xfd)},'level':{'$first':_0x2cc61a(0x1bc)},'isle':{'$first':_0x2cc61a(0x12f)},'pallet':{'$first':_0x2cc61a(0x134)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x48cf7e[_0x2cc61a(0x1d5)](0xc8)[_0x2cc61a(0x160)](_0xc53e30);}catch(_0x5e63f8){_0x48cf7e[_0x2cc61a(0x1d5)](0x194)[_0x2cc61a(0x160)]({'message':_0x5e63f8[_0x2cc61a(0x142)]});}}),module[a0_0x91e05a(0x16c)]=router;