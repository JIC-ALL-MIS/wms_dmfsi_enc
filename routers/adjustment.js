var a0_0x386eff=a0_0xa7a5;(function(_0x329efb,_0x4a7950){var _0x153c9c=a0_0xa7a5,_0x523493=_0x329efb();while(!![]){try{var _0x1b3506=parseInt(_0x153c9c(0x146))/0x1+parseInt(_0x153c9c(0x193))/0x2*(parseInt(_0x153c9c(0x152))/0x3)+parseInt(_0x153c9c(0x10f))/0x4+parseInt(_0x153c9c(0x19d))/0x5+parseInt(_0x153c9c(0x1d1))/0x6*(-parseInt(_0x153c9c(0x132))/0x7)+parseInt(_0x153c9c(0x13f))/0x8+parseInt(_0x153c9c(0x1ae))/0x9*(-parseInt(_0x153c9c(0x148))/0xa);if(_0x1b3506===_0x4a7950)break;else _0x523493['push'](_0x523493['shift']());}catch(_0x181041){_0x523493['push'](_0x523493['shift']());}}}(a0_0x5cdf,0xe24ed));const express=require(a0_0x386eff(0x165)),app=express(),router=express['Router'](),auth=require(a0_0x386eff(0x1ab)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,supervisor_settings,email_settings}=require(a0_0x386eff(0x12c)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x386eff(0x198));function a0_0xa7a5(_0x48c7d3,_0x3c6fab){var _0x5cdf9e=a0_0x5cdf();return a0_0xa7a5=function(_0xa7a5df,_0x1ca07a){_0xa7a5df=_0xa7a5df-0xfe;var _0x560059=_0x5cdf9e[_0xa7a5df];return _0x560059;},a0_0xa7a5(_0x48c7d3,_0x3c6fab);}router[a0_0x386eff(0x17a)](a0_0x386eff(0x131),auth,async(_0x229de7,_0x425093)=>{var _0x59bfc7=a0_0x386eff;try{const {username:_0x2ff74d,email:_0x325b76,role:_0x18e2c2}=_0x229de7[_0x59bfc7(0x1a4)],_0x1a7eb0=_0x229de7['user'],_0x1d7b56=await profile[_0x59bfc7(0x111)]({'email':_0x1a7eb0[_0x59bfc7(0x199)]}),_0x33e519=await master_shop[_0x59bfc7(0x14a)]();console[_0x59bfc7(0x1c3)](_0x59bfc7(0x162),_0x33e519);let _0x572917;if(_0x1a7eb0['role']==_0x59bfc7(0x110)){const _0x1294f9=await staff['findOne']({'email':_0x1a7eb0[_0x59bfc7(0x199)]});_0x572917=await warehouse['find']({'status':_0x59bfc7(0x1b8),'name':_0x1294f9[_0x59bfc7(0x170)]});}else _0x572917=await warehouse[_0x59bfc7(0x14a)]({'status':_0x59bfc7(0x1b8)});const _0x2aa4dd=await product['find']();let _0x18f607;if(_0x1a7eb0[_0x59bfc7(0x1c9)]==_0x59bfc7(0x110)){const _0x2bd5a4=await staff['findOne']({'email':_0x1a7eb0[_0x59bfc7(0x199)]});_0x18f607=await adjustment[_0x59bfc7(0x14a)]({'warehouse_name':_0x2bd5a4[_0x59bfc7(0x170)]});}else _0x18f607=await adjustment[_0x59bfc7(0x100)]([{'$unwind':_0x59bfc7(0x12d)},{'$group':{'_id':_0x59bfc7(0x164),'invoice':{'$first':_0x59bfc7(0xfe)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x59bfc7(0x1cb)},'room':{'$addToSet':_0x59bfc7(0x1d3)},'finalize':{'$first':_0x59bfc7(0x18b)},'isAllowEdit':{'$first':_0x59bfc7(0x1ba)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x33e519[0x0][_0x59bfc7(0x1a5)]==_0x59bfc7(0x1aa)){var _0x39cae2=users[_0x59bfc7(0x1d0)];console[_0x59bfc7(0x1c3)](_0x39cae2);}else{if(_0x33e519[0x0]['language']==_0x59bfc7(0x171))var _0x39cae2=users[_0x59bfc7(0x171)];else{if(_0x33e519[0x0][_0x59bfc7(0x1a5)]=='German')var _0x39cae2=users[_0x59bfc7(0x176)];else{if(_0x33e519[0x0][_0x59bfc7(0x1a5)]==_0x59bfc7(0x185))var _0x39cae2=users[_0x59bfc7(0x185)];else{if(_0x33e519[0x0]['language']==_0x59bfc7(0x14e))var _0x39cae2=users[_0x59bfc7(0x14e)];else{if(_0x33e519[0x0][_0x59bfc7(0x1a5)]==_0x59bfc7(0x161))var _0x39cae2=users[_0x59bfc7(0x17b)];else{if(_0x33e519[0x0][_0x59bfc7(0x1a5)]=='Chinese')var _0x39cae2=users[_0x59bfc7(0x124)];else{if(_0x33e519[0x0]['language']=='Arabic\x20(ae)')var _0x39cae2=users[_0x59bfc7(0x1ca)];}}}}}}}_0x425093[_0x59bfc7(0x11e)](_0x59bfc7(0x17e),{'success':_0x229de7[_0x59bfc7(0x1b4)](_0x59bfc7(0x138)),'errors':_0x229de7[_0x59bfc7(0x1b4)](_0x59bfc7(0x115)),'role':_0x1a7eb0,'profile':_0x1d7b56,'warehouse':_0x572917,'product':_0x2aa4dd,'adjustment':_0x18f607,'master_shop':_0x33e519,'language':_0x39cae2});}catch(_0x41141f){console[_0x59bfc7(0x1c3)](_0x41141f);}});async function getRandom8DigitNumber(){var _0x57276a=a0_0x386eff;const _0x13b410=0x989680,_0x560afc=0x5f5e0ff,_0x36f0f9=Math['floor'](Math[_0x57276a(0x10c)]()*(_0x560afc-_0x13b410+0x1))+_0x13b410;var _0xa269a5;const _0x9b512e=await adjustment[_0x57276a(0x111)]({'invoice':'ADJ-'+_0x36f0f9});return _0x9b512e&&_0x9b512e[_0x57276a(0x1cc)]>0x0?_0xa269a5='ADJ-'+_0x36f0f9:_0xa269a5=_0x57276a(0x140)+_0x36f0f9,_0xa269a5;}function a0_0x5cdf(){var _0x1a7c2a=['/view/add_adjustment','9oZTuGE','adjustment\x20Finalized\x20successfully','Primary_Units','$product_details.primary_code','json','prod_name','flash','_id','product_name','$product_details.batch_code','Enabled','back','$isAllowEdit','add_adjustment','isAllowEdit','RMSEmail','date','maxPerUnit','$product_details.bay','new_adjust_qty','$product_details.secondary_code','log','$product_details.storage','$product_details.unit','types','/barcode_scanner','$room','role','Arabic','$warehouse_name','length','split','logo','</div>','English','144NiKjnp','Return\x20Rooms','$product.room_names','/adjustment/preview/','$invoice','primary_code','aggregate','edit_adjustment_view','$product_details._id','Level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<h5>','password','error','$product_details.rack','prod_invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','random','/CheckingWarehouse','slice','3875272DbaSMo','staff','findOne','/../public','$product.product_name','$product_details','errors','$product_details.expiry_date','level','string','toString','Email\x20sent\x20successfully','\x20</h2>','site_title','<span\x20style=\x22float:\x20right;\x22>','render','product','storage','warehouse_name','foreach\x20newproduct','$product_details.maxProducts','Chinese','$name','</tr>','adjust_qty','$product_details.maxPerUnit','<h2>\x20','Enclosed','adjustment\x20add\x20successfull','../models/all_models','$product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Floor','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/view','100583bntttZ','padStart','product_details','/view/:id','\x20<>\x20','$product_details.pallet','success','params','stockBefore','Secondary_units','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','product_code','body','2030896LFwFOA','ADJ-','Receiving\x20Area','<div>','message','all','prod_code','1368403EbGTat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','24859070GWbxBG','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','find','New_Qty_Converted','<h5\x20style=\x22text-align:\x20left;\x22>','max_per_unit','French','unit','bin','<!DOCTYPE\x20html>','3CDlNXk','forEach','Shelves','then','$product_details.product_code','/picking_list/PDF_adjustment_rm/','$product_details.type','$product_details.product_stock','$product_details.isle','room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','adjustment\x20data\x20update\x20successfully','catch','/adjustment/view','Adjustment\x20Mail','Portuguese\x20(BR)','master','push','$_id','express','True','$product_details.floorlevel','stock','type','</h5>','batch_code','second1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','bay','map','warehouse','Hindi','An\x20error\x20occurred.','$product_details.product_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</body></html>','German','</table>','status','Return\x20Goods','get','Portuguese','floorlevel','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','adjustment','invoice','/upload/','$product_details.product_name','save','prod_cat','$product_details.secondary_unit','Spanish','filter','expiry_date','prime1','\x20Order\x20Number\x20:\x20','</td>','$finalize','</span>','production_date','image','An\x20error\x20occurred\x20while\x20saving\x20data.','secondary_unit','Rooms','Arabic\x20(ae)','1916862zQMqMl','room_names','post','$product_details.level','$product_details.production_date','nodemailer','email','secondary_code','/preview/:id','Raw\x20Materials','1041030jlnkZx','Logo.png','</thead>','New_Qty_Converted_adj','<tr>','maxperunit','$product_details.bin','user','language','product_stock','rack','findById','<strong>\x20Regards\x20</strong>','English\x20(US)','../middleware/auth','redirect'];a0_0x5cdf=function(){return _0x1a7c2a;};return a0_0x5cdf();}router['get'](a0_0x386eff(0x1ad),auth,async(_0x344857,_0x4edf0d)=>{var _0x209362=a0_0x386eff;try{const {username:_0x1e6352,email:_0x9920a1,role:_0x31c069}=_0x344857[_0x209362(0x1a4)],_0x58106d=_0x344857[_0x209362(0x1a4)],_0x5f1409=await profile[_0x209362(0x111)]({'email':_0x58106d[_0x209362(0x199)]}),_0x2c09ac=await master_shop['find']();let _0x7ae5e2;if(_0x58106d['role']==_0x209362(0x110)){const _0x54a299=await staff['findOne']({'email':_0x58106d[_0x209362(0x199)]});_0x7ae5e2=await warehouse[_0x209362(0x100)]([{'$match':{'status':'Enabled','name':_0x54a299[_0x209362(0x170)],'warehouse_category':_0x209362(0x19c),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x209362(0x125),'name':{'$first':'$name'}}}]);}else _0x7ae5e2=await warehouse[_0x209362(0x100)]([{'$match':{'status':_0x209362(0x1b8),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x209362(0x179)}}},{'$group':{'_id':'$name','name':{'$first':_0x209362(0x125)}}}]);const _0x198d38=await product['find']({}),_0x4e4fd4=await adjustment['find']({}),_0x3bbdbc=_0x4e4fd4[_0x209362(0x1cc)]+0x1,_0x11d87f='ADJ-'+_0x3bbdbc[_0x209362(0x119)]()[_0x209362(0x133)](0x5,'0');var _0x12ef0b=['Ambient',_0x209362(0x12a),_0x209362(0x1d2)];if(_0x2c09ac[0x0][_0x209362(0x1a5)]==_0x209362(0x1aa))var _0x3eaf48=users['English'];else{if(_0x2c09ac[0x0][_0x209362(0x1a5)]=='Hindi')var _0x3eaf48=users[_0x209362(0x171)];else{if(_0x2c09ac[0x0][_0x209362(0x1a5)]==_0x209362(0x176))var _0x3eaf48=users[_0x209362(0x176)];else{if(_0x2c09ac[0x0][_0x209362(0x1a5)]==_0x209362(0x185))var _0x3eaf48=users[_0x209362(0x185)];else{if(_0x2c09ac[0x0]['language']==_0x209362(0x14e))var _0x3eaf48=users[_0x209362(0x14e)];else{if(_0x2c09ac[0x0]['language']==_0x209362(0x161))var _0x3eaf48=users[_0x209362(0x17b)];else{if(_0x2c09ac[0x0][_0x209362(0x1a5)]=='Chinese')var _0x3eaf48=users[_0x209362(0x124)];else{if(_0x2c09ac[0x0]['language']=='Arabic\x20(ae)')var _0x3eaf48=users['Arabic'];}}}}}}}const _0x56e524=getRandom8DigitNumber();_0x56e524[_0x209362(0x155)](_0x2ffe0b=>{var _0x3b6a08=_0x209362;_0x4edf0d[_0x3b6a08(0x11e)](_0x3b6a08(0x1bb),{'success':_0x344857['flash']('success'),'errors':_0x344857[_0x3b6a08(0x1b4)](_0x3b6a08(0x115)),'role':_0x58106d,'profile':_0x5f1409,'warehouse':_0x7ae5e2,'product':_0x198d38,'master_shop':_0x2c09ac,'language':_0x3eaf48,'rooms_data':_0x12ef0b,'invoice_no':_0x2ffe0b});})[_0x209362(0x15e)](_0x1d70f2=>{var _0x356497=_0x209362;_0x344857['flash']('errors',_0x356497(0x10a)),_0x4edf0d[_0x356497(0x1ac)]('/adjustment/view');});}catch(_0x539579){console[_0x209362(0x1c3)](_0x539579);}}),router[a0_0x386eff(0x195)](a0_0x386eff(0x1ad),auth,async(_0x2fd6a1,_0x5a78a6)=>{var _0x39485e=a0_0x386eff;try{const {warehouse_name:_0x35de6d,date:_0x39e52f,prod_name:_0x2f749f,level:_0x19c598,isle:_0x56d08a,pallet:_0x33678d,stock:_0x3c2737,types:_0x549eed,adjust_qty:_0x54f550,new_adjust_qty:_0x1e6cc7,note:_0x564818,Room_name:_0x2c5d64,invoice:_0x44cc6c,JO_number:_0x2bedf6,expiry_date:_0x14c0a2}=_0x2fd6a1[_0x39485e(0x13e)];if(typeof _0x2f749f==_0x39485e(0x118))var _0x10134a=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x1b3)]],_0x15ef9a=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x117)]],_0x66a567=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x168)]],_0x1e9e99=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x1c6)]],_0x1a38e1=[_0x2fd6a1['body'][_0x39485e(0x1a0)]],_0x475f0f=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x14b)]],_0x3c29bc=[_0x2fd6a1['body'][_0x39485e(0x1b0)]],_0x531b31=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x13b)]],_0x48c28a=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x145)]],_0x52cd3c=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x16b)]],_0x1e7849=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x187)]],_0x30331c=[_0x2fd6a1['body'][_0x39485e(0x14d)]],_0x4ac047=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x18d)]],_0x5ea61e=[_0x2fd6a1[_0x39485e(0x13e)]['prod_cat']],_0x1a5a5f=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x191)]],_0x18c53e=[_0x2fd6a1[_0x39485e(0x13e)]['prime1']],_0x2fa18f=[_0x2fd6a1['body'][_0x39485e(0x16c)]],_0x401038=[_0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x109)]];else var _0x10134a=[..._0x2fd6a1['body'][_0x39485e(0x1b3)]],_0x15ef9a=[..._0x2fd6a1[_0x39485e(0x13e)]['level']],_0x66a567=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x168)]],_0x1e9e99=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x1c6)]],_0x1a38e1=[..._0x2fd6a1['body'][_0x39485e(0x1a0)]],_0x475f0f=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x14b)]],_0x3c29bc=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x14f)]],_0x531b31=[..._0x2fd6a1[_0x39485e(0x13e)]['Secondary_units']],_0x48c28a=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x145)]],_0x52cd3c=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x16b)]],_0x1e7849=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x187)]],_0x30331c=[..._0x2fd6a1[_0x39485e(0x13e)]['max_per_unit']],_0x4ac047=[..._0x2fd6a1['body']['production_date']],_0x5ea61e=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x183)]],_0x1a5a5f=[..._0x2fd6a1[_0x39485e(0x13e)]['Rooms']],_0x18c53e=[..._0x2fd6a1['body']['prime1']],_0x2fa18f=[..._0x2fd6a1['body']['second1']],_0x401038=[..._0x2fd6a1[_0x39485e(0x13e)][_0x39485e(0x109)]];const _0x40ff28=_0x10134a[_0x39485e(0x16f)](_0x356b1d=>{return _0x356b1d={'product_name':_0x356b1d};});_0x15ef9a['forEach']((_0x583e02,_0xa6a8a7)=>{var _0x52531a=_0x39485e;_0x1a5a5f[_0x52531a(0x153)]((_0x3ee418,_0x36de53)=>{var _0x58fc12=_0x52531a;if(_0x3ee418==_0x58fc12(0x141)&&_0xa6a8a7==_0x36de53){var _0x33e276=_0x583e02[_0x58fc12(0x10e)](0x3);_0x40ff28[_0xa6a8a7][_0x58fc12(0x120)]=_0x583e02[0x0],_0x40ff28[_0xa6a8a7]['rack']=_0x583e02[0x1],_0x40ff28[_0xa6a8a7][_0x58fc12(0x16e)]=0x0,_0x40ff28[_0xa6a8a7][_0x58fc12(0x150)]=0x0,_0x40ff28[_0xa6a8a7]['type']=_0x58fc12(0x12f),_0x40ff28[_0xa6a8a7]['floorlevel']=_0x33e276;}else{if(_0x3ee418=='Shelves'&&_0xa6a8a7==_0x36de53){var _0x33e276=_0x583e02[_0x58fc12(0x10e)](0x3);_0x40ff28[_0xa6a8a7][_0x58fc12(0x120)]=_0x583e02[0x0],_0x40ff28[_0xa6a8a7][_0x58fc12(0x1a7)]=_0x583e02[0x1],_0x40ff28[_0xa6a8a7]['bay']=0x0,_0x40ff28[_0xa6a8a7]['bin']=0x0,_0x40ff28[_0xa6a8a7]['type']='Floor',_0x40ff28[_0xa6a8a7]['floorlevel']=_0x583e02[0x5];}else{if(_0xa6a8a7==_0x36de53){var _0x43ac64;if(_0x583e02[0x4]=='L')_0x43ac64=_0x58fc12(0x103);else _0x583e02[0x4]=='F'&&(_0x43ac64=_0x58fc12(0x12f));_0x40ff28[_0xa6a8a7]['storage']=_0x583e02[0x0],_0x40ff28[_0xa6a8a7][_0x58fc12(0x1a7)]=_0x583e02[0x1],_0x40ff28[_0xa6a8a7][_0x58fc12(0x16e)]=_0x583e02[0x2],_0x40ff28[_0xa6a8a7]['bin']=_0x583e02[0x3],_0x40ff28[_0xa6a8a7][_0x58fc12(0x169)]=_0x43ac64,_0x40ff28[_0xa6a8a7][_0x58fc12(0x17c)]=_0x583e02[0x5];}}}});}),_0x66a567['forEach']((_0x1471df,_0x3a9827)=>{var _0x5b829c=_0x39485e;_0x40ff28[_0x3a9827][_0x5b829c(0x13a)]=_0x1471df;}),_0x1e9e99[_0x39485e(0x153)]((_0x2bf572,_0x454aea)=>{var _0x476554=_0x39485e;_0x40ff28[_0x454aea][_0x476554(0x1c6)]=_0x2bf572;}),_0x1a38e1[_0x39485e(0x153)]((_0x67f47c,_0x4f9cac)=>{_0x40ff28[_0x4f9cac]['adjust_qty']=_0x67f47c;}),_0x475f0f[_0x39485e(0x153)]((_0xfc6cf7,_0xb86ad8)=>{_0x40ff28[_0xb86ad8]['new_adjust_qty']=_0xfc6cf7;}),_0x3c29bc[_0x39485e(0x153)]((_0x451974,_0x1ca269)=>{var _0x29a260=_0x39485e;_0x40ff28[_0x1ca269][_0x29a260(0x14f)]=_0x451974;}),_0x531b31[_0x39485e(0x153)]((_0x2e602e,_0x2cebf4)=>{_0x40ff28[_0x2cebf4]['secondary_unit']=_0x2e602e;}),_0x48c28a[_0x39485e(0x153)]((_0x124ede,_0x74654a)=>{_0x40ff28[_0x74654a]['product_code']=_0x124ede;}),_0x52cd3c[_0x39485e(0x153)]((_0x559316,_0x5bfbb8)=>{var _0xc93010=_0x39485e;_0x40ff28[_0x5bfbb8][_0xc93010(0x16b)]=_0x559316;}),_0x1e7849['forEach']((_0x216db6,_0x467fc5)=>{var _0x422dcf=_0x39485e;_0x40ff28[_0x467fc5][_0x422dcf(0x187)]=_0x216db6;}),_0x30331c[_0x39485e(0x153)]((_0x3a9795,_0x329af1)=>{var _0x330af6=_0x39485e;_0x40ff28[_0x329af1][_0x330af6(0x1a2)]=_0x3a9795;}),_0x4ac047[_0x39485e(0x153)]((_0x44f211,_0x5554fa)=>{var _0x485924=_0x39485e;_0x40ff28[_0x5554fa][_0x485924(0x18d)]=_0x44f211;}),_0x5ea61e[_0x39485e(0x153)]((_0x3669ec,_0x6fc7a5)=>{var _0x485145=_0x39485e;_0x40ff28[_0x6fc7a5][_0x485145(0x183)]=_0x3669ec;}),_0x1a5a5f[_0x39485e(0x153)]((_0x3cc626,_0x2cb55b)=>{_0x40ff28[_0x2cb55b]['room_names']=_0x3cc626;}),_0x18c53e['forEach']((_0x56ab0c,_0x7f5477)=>{var _0x2e3944=_0x39485e;_0x40ff28[_0x7f5477][_0x2e3944(0xff)]=_0x56ab0c;}),_0x2fa18f[_0x39485e(0x153)]((_0x4bf7ba,_0x29b0e6)=>{var _0x166dbf=_0x39485e;_0x40ff28[_0x29b0e6][_0x166dbf(0x19a)]=_0x4bf7ba;}),_0x401038['forEach']((_0x5a75d3,_0x1c4a07)=>{var _0x323ce7=_0x39485e;_0x40ff28[_0x1c4a07][_0x323ce7(0x17f)]=_0x5a75d3;});const _0xf8be72=_0x40ff28[_0x39485e(0x186)](_0x51008d=>_0x51008d[_0x39485e(0x127)]!=='0'&&_0x51008d[_0x39485e(0x127)]!=='');var _0x290bd8=0x0;_0xf8be72[_0x39485e(0x153)](_0x523ccd=>{var _0x5220b3=_0x39485e;console[_0x5220b3(0x1c3)](_0x5220b3(0x122),_0x523ccd),parseInt(_0x523ccd['adjust_qty'])<=0x0&&_0x290bd8++;});if(_0x290bd8!=0x0)return _0x2fd6a1[_0x39485e(0x1b4)]('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x5a78a6[_0x39485e(0x1ac)](_0x39485e(0x1b9));const _0xa3502c=new adjustment({'warehouse_name':_0x35de6d,'date':_0x39e52f,'product':_0xf8be72,'note':_0x564818,'room':_0x2c5d64,'invoice':_0x44cc6c,'JO_number':_0x2bedf6,'expiry_date':_0x14c0a2}),_0x496a2e=await _0xa3502c[_0x39485e(0x182)]();_0x2fd6a1[_0x39485e(0x1b4)](_0x39485e(0x138),_0x39485e(0x12b)),_0x5a78a6[_0x39485e(0x1ac)](_0x39485e(0x1d4)+_0x496a2e[_0x39485e(0x1b5)]);}catch(_0x2adbd5){console[_0x39485e(0x1c3)](_0x2adbd5),_0x5a78a6[_0x39485e(0x178)](0xc8)[_0x39485e(0x1b2)]({'message':_0x2adbd5['message']});}}),router[a0_0x386eff(0x17a)](a0_0x386eff(0x19b),auth,async(_0x21f81f,_0x2f0122)=>{var _0x463aa3=a0_0x386eff;try{const {username:_0x12f74a,email:_0x462403,role:_0x367837}=_0x21f81f[_0x463aa3(0x1a4)],_0x498b5a=_0x21f81f[_0x463aa3(0x1a4)],_0x10fdba=await profile[_0x463aa3(0x111)]({'email':_0x498b5a[_0x463aa3(0x199)]}),_0x2219b9=await master_shop[_0x463aa3(0x14a)](),_0x59401b=_0x21f81f[_0x463aa3(0x139)]['id'],_0x6be39c=await adjustment[_0x463aa3(0x1a8)]({'_id':_0x59401b}),_0x963c6d=await purchases[_0x463aa3(0x100)]([{'$match':{'warehouse_name':_0x6be39c['warehouse_name']}},{'$unwind':_0x463aa3(0x12d)},{'$group':{'_id':_0x463aa3(0x113)}}]),_0x56578d=await product[_0x463aa3(0x14a)]({}),_0x3ebf54=await warehouse['aggregate']([{'$match':{'name':_0x6be39c['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x463aa3(0x102),'name':{'$first':_0x463aa3(0x181)},'product_stock':{'$first':_0x463aa3(0x159)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x463aa3(0x1a3)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x463aa3(0x167)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x463aa3(0x156)},'storage':{'$first':_0x463aa3(0x1c4)},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':_0x463aa3(0x128)},'expiry_date':{'$first':_0x463aa3(0x116)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x463aa3(0x1c8)}}}]);if(_0x2219b9[0x0]['language']==_0x463aa3(0x1aa)){var _0x6f022f=users[_0x463aa3(0x1d0)];console[_0x463aa3(0x1c3)](_0x6f022f);}else{if(_0x2219b9[0x0][_0x463aa3(0x1a5)]==_0x463aa3(0x171))var _0x6f022f=users[_0x463aa3(0x171)];else{if(_0x2219b9[0x0][_0x463aa3(0x1a5)]==_0x463aa3(0x176))var _0x6f022f=users[_0x463aa3(0x176)];else{if(_0x2219b9[0x0][_0x463aa3(0x1a5)]=='Spanish')var _0x6f022f=users[_0x463aa3(0x185)];else{if(_0x2219b9[0x0][_0x463aa3(0x1a5)]==_0x463aa3(0x14e))var _0x6f022f=users[_0x463aa3(0x14e)];else{if(_0x2219b9[0x0][_0x463aa3(0x1a5)]==_0x463aa3(0x161))var _0x6f022f=users['Portuguese'];else{if(_0x2219b9[0x0]['language']==_0x463aa3(0x124))var _0x6f022f=users['Chinese'];else{if(_0x2219b9[0x0]['language']==_0x463aa3(0x192))var _0x6f022f=users[_0x463aa3(0x1ca)];}}}}}}}_0x2f0122[_0x463aa3(0x11e)](_0x463aa3(0x101),{'success':_0x21f81f[_0x463aa3(0x1b4)](_0x463aa3(0x138)),'errors':_0x21f81f[_0x463aa3(0x1b4)]('errors'),'role':_0x498b5a,'profile':_0x10fdba,'adjustment':_0x6be39c,'stock':_0x3ebf54,'master_shop':_0x2219b9,'warehouse_name':_0x963c6d,'unit':_0x56578d,'language':_0x6f022f});}catch(_0x193ada){console[_0x463aa3(0x1c3)](_0x193ada),_0x2f0122[_0x463aa3(0x178)](0xc8)[_0x463aa3(0x1b2)]({'message':_0x193ada[_0x463aa3(0x143)]});}}),router[a0_0x386eff(0x195)](a0_0x386eff(0x19b),auth,async(_0x18469a,_0x296c09)=>{var _0x447479=a0_0x386eff;try{const _0x387a8a=_0x18469a['params']['id'],{warehouse_name:_0xc64ccb,Room_name:_0x17eb1c}=_0x18469a[_0x447479(0x13e)],_0x24bdd7=await adjustment[_0x447479(0x1a8)]({'_id':_0x387a8a}),_0x4605e9=_0x24bdd7[_0x447479(0x11f)][_0x447479(0x16f)](async _0x39cf32=>{var _0x2d1028=_0x447479;if(_0x39cf32[_0x2d1028(0x127)]>0x0){var _0x1cafbf=await warehouse[_0x2d1028(0x111)]({'name':_0xc64ccb,'room':_0x39cf32[_0x2d1028(0x194)],'warehouse_category':'Raw\x20Materials'});const _0x49b505=_0x1cafbf[_0x2d1028(0x134)][_0x2d1028(0x16f)](_0x3a6775=>{var _0x2da49f=_0x2d1028;if(_0x39cf32['type']=='minus'){if(_0x3a6775['product_name']==_0x39cf32[_0x2da49f(0x1b6)]&&_0x3a6775['floorlevel']==_0x39cf32[_0x2da49f(0x17c)]&&_0x3a6775['type']==_0x39cf32[_0x2da49f(0x169)]&&_0x3a6775[_0x2da49f(0x150)]==_0x39cf32[_0x2da49f(0x150)]&&_0x3a6775[_0x2da49f(0x16e)]==_0x39cf32[_0x2da49f(0x16e)]&&_0x3a6775[_0x2da49f(0x1a7)]==_0x39cf32[_0x2da49f(0x1a7)]&&_0x3a6775[_0x2da49f(0x120)]==_0x39cf32[_0x2da49f(0x120)]&&_0x3a6775[_0x2da49f(0x187)]==_0x39cf32[_0x2da49f(0x187)]&&_0x3a6775[_0x2da49f(0x16b)]==_0x39cf32['batch_code']&&_0x3a6775[_0x2da49f(0x18d)]==_0x39cf32[_0x2da49f(0x18d)]&&_0x3a6775['invoice']==_0x39cf32[_0x2da49f(0x17f)]){var _0x3d8f40;_0x3d8f40=_0x39cf32['adjust_qty'],_0x39cf32['prod_cat']=='S'&&(_0x3d8f40=_0x39cf32['adjust_qty']),_0x3a6775[_0x2da49f(0x1a6)]=_0x3a6775['product_stock']-_0x3d8f40;}}else{if(_0x3a6775[_0x2da49f(0x1b6)]==_0x39cf32[_0x2da49f(0x1b6)]&&_0x3a6775['floorlevel']==_0x39cf32[_0x2da49f(0x17c)]&&_0x3a6775[_0x2da49f(0x169)]==_0x39cf32[_0x2da49f(0x169)]&&_0x3a6775[_0x2da49f(0x150)]==_0x39cf32[_0x2da49f(0x150)]&&_0x3a6775[_0x2da49f(0x16e)]==_0x39cf32[_0x2da49f(0x16e)]&&_0x3a6775[_0x2da49f(0x1a7)]==_0x39cf32['rack']&&_0x3a6775['storage']==_0x39cf32['storage']&&_0x3a6775[_0x2da49f(0x187)]==_0x39cf32['expiry_date']&&_0x3a6775[_0x2da49f(0x16b)]==_0x39cf32[_0x2da49f(0x16b)]&&_0x3a6775['production_date']==_0x39cf32['production_date']&&_0x3a6775[_0x2da49f(0x17f)]==_0x39cf32[_0x2da49f(0x17f)]){console[_0x2da49f(0x1c3)](_0x39cf32);var _0x3d8f40;_0x3d8f40=_0x39cf32[_0x2da49f(0x127)],_0x39cf32[_0x2da49f(0x183)]=='S'&&(_0x3d8f40=_0x39cf32[_0x2da49f(0x127)]),console['log'](_0x3d8f40+'\x20<>\x20'+_0x39cf32[_0x2da49f(0x127)]+_0x2da49f(0x136)+_0x3a6775[_0x2da49f(0x1bf)]+'\x20<>\x20'+_0x39cf32[_0x2da49f(0x183)]),_0x3a6775[_0x2da49f(0x1a6)]=_0x3a6775[_0x2da49f(0x1a6)]+_0x3d8f40;}}});}return _0x1cafbf;});Promise['all'](_0x4605e9)[_0x447479(0x155)](async _0x2d4ca0=>{var _0x949716=_0x447479;try{for(const _0x5d0266 of _0x2d4ca0){await _0x5d0266[_0x949716(0x182)]();}_0x24bdd7['finalize']=_0x949716(0x166);const _0x1a052e=await _0x24bdd7[_0x949716(0x182)](),_0x32b2ad=await master_shop['find'](),_0x2680ec=await email_settings[_0x949716(0x111)](),_0x280444=await supervisor_settings[_0x949716(0x14a)]();var _0xcf89c0=_0x24bdd7[_0x949716(0x11f)],_0x156991='',_0xdfdb84;for(_0xdfdb84 in _0xcf89c0){_0x156991+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xcf89c0[_0xdfdb84][_0x949716(0x1b6)]+_0x949716(0x18a)+_0x949716(0x10b)+_0xcf89c0[_0xdfdb84][_0x949716(0x13d)]+_0x949716(0x18a)+_0x949716(0x10b)+_0xcf89c0[_0xdfdb84][_0x949716(0x127)]+_0x949716(0x18a)+_0x949716(0x10b)+_0xcf89c0[_0xdfdb84][_0x949716(0x14f)]+_0x949716(0x18a)+_0x949716(0x10b)+_0xcf89c0[_0xdfdb84][_0x949716(0x190)]+'</td>'+_0x949716(0x10b)+_0x24bdd7['warehouse_name']+'</td>'+_0x949716(0x10b)+_0xcf89c0[_0xdfdb84][_0x949716(0x194)]+'</td>'+_0x949716(0x10b)+_0xcf89c0[_0xdfdb84][_0x949716(0x120)]+_0xcf89c0[_0xdfdb84][_0x949716(0x1a7)]+_0xcf89c0[_0xdfdb84][_0x949716(0x16e)]+_0xcf89c0[_0xdfdb84]['bin']+_0xcf89c0[_0xdfdb84]['type'][0x0]+_0xcf89c0[_0xdfdb84][_0x949716(0x17c)]+_0x949716(0x18a),_0x949716(0x126);}let _0xee48cb=nodemailer['createTransport']({'host':_0x2680ec['host'],'port':Number(_0x2680ec['port']),'secure':![],'auth':{'user':_0x2680ec[_0x949716(0x199)],'pass':_0x2680ec[_0x949716(0x106)]}}),_0x454fa9={'from':_0x2680ec[_0x949716(0x199)],'to':_0x280444[0x0][_0x949716(0x1bd)],'subject':_0x949716(0x160),'attachments':[{'filename':_0x949716(0x19e),'path':__dirname+_0x949716(0x112)+_0x949716(0x180)+_0x32b2ad[0x0][_0x949716(0x18e)],'cid':_0x949716(0x1ce)}],'html':_0x949716(0x151)+'<html><head><title></title>'+'</head><body>'+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x949716(0x142)+_0x949716(0x17d)+_0x949716(0x1cf)+'<div>'+_0x949716(0x129)+_0x32b2ad[0x0][_0x949716(0x11c)]+_0x949716(0x11b)+_0x949716(0x1cf)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x949716(0x142)+_0x949716(0x14c)+_0x949716(0x189)+_0x24bdd7[_0x949716(0x17f)]+'\x20'+_0x949716(0x11d)+'\x20Order\x20Date\x20:\x20'+_0x24bdd7[_0x949716(0x1be)]+'\x20'+_0x949716(0x18c)+_0x949716(0x16a)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x949716(0x149)+_0x949716(0x1a1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x949716(0x12e)+_0x949716(0x130)+_0x949716(0x104)+_0x949716(0x174)+_0x949716(0x147)+_0x949716(0x15c)+_0x949716(0x16d)+_0x949716(0x126)+_0x949716(0x19f)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x156991+'\x20'+'</tbody>'+_0x949716(0x177)+'<div>'+_0x949716(0x1a9)+_0x949716(0x105)+_0x32b2ad[0x0][_0x949716(0x11c)]+'</h5>'+_0x949716(0x1cf)+'</div>'+_0x949716(0x175)};_0xee48cb['sendMail'](_0x454fa9,function(_0x433099,_0x203c78){var _0x507a40=_0x949716;_0x433099?(console[_0x507a40(0x1c3)](_0x433099),console['log']('Error\x20Occurs')):console[_0x507a40(0x1c3)](_0x507a40(0x11a));}),_0x18469a['flash'](_0x949716(0x138),_0x949716(0x1af)),_0x296c09[_0x949716(0x1ac)](_0x949716(0x157)+_0x1a052e['_id']);}catch(_0x5eeb42){console[_0x949716(0x107)](_0x5eeb42),_0x296c09[_0x949716(0x178)](0x1f4)[_0x949716(0x1b2)]({'error':_0x949716(0x18f)});}})[_0x447479(0x15e)](_0x4880ed=>{var _0xcb99e1=_0x447479;console[_0xcb99e1(0x107)](_0x4880ed),_0x296c09['status'](0x1f4)[_0xcb99e1(0x1b2)]({'error':_0xcb99e1(0x172)});});}catch(_0x2ca3ff){console[_0x447479(0x1c3)](_0x2ca3ff),_0x296c09['status'](0xc8)[_0x447479(0x1b2)]({'message':_0x2ca3ff[_0x447479(0x143)]});}}),router['get'](a0_0x386eff(0x135),auth,async(_0x1e29bd,_0x4e66e1)=>{var _0x29671e=a0_0x386eff;try{const {username:_0x6f1ecb,email:_0x58b930,role:_0x564eeb}=_0x1e29bd[_0x29671e(0x1a4)],_0x31688e=_0x1e29bd[_0x29671e(0x1a4)],_0x4f6eae=await profile[_0x29671e(0x111)]({'email':_0x31688e[_0x29671e(0x199)]}),_0x14417f=await master_shop['find'](),_0x42b9e1=_0x1e29bd[_0x29671e(0x139)]['id'],_0x5c73d9=await adjustment[_0x29671e(0x1a8)]({'_id':_0x42b9e1}),_0x231b70=await purchases[_0x29671e(0x100)]([{'$match':{'warehouse_name':_0x5c73d9[_0x29671e(0x121)]}},{'$unwind':_0x29671e(0x12d)},{'$group':{'_id':_0x29671e(0x113)}}]),_0x402afe=await product['find']({}),_0x3df456=await warehouse[_0x29671e(0x100)]([{'$match':{'name':_0x5c73d9[_0x29671e(0x121)]}},{'$unwind':_0x29671e(0x114)},{'$group':{'_id':_0x29671e(0x102),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x29671e(0x159)},'bay':{'$first':_0x29671e(0x1c0)},'bin':{'$first':_0x29671e(0x1a3)},'type':{'$first':_0x29671e(0x158)},'floorlevel':{'$first':_0x29671e(0x167)},'primary_code':{'$first':_0x29671e(0x1b1)},'secondary_code':{'$first':_0x29671e(0x1c2)},'product_code':{'$first':_0x29671e(0x156)},'storage':{'$first':_0x29671e(0x1c4)},'rack':{'$first':_0x29671e(0x108)},'maxPerUnit':{'$first':_0x29671e(0x128)},'expiry_date':{'$first':_0x29671e(0x116)},'production_date':{'$first':_0x29671e(0x197)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':'$room'}}}]);let _0xfd55cc;if(_0x31688e[_0x29671e(0x1c9)]==_0x29671e(0x110)){const _0x3e6ed9=await staff[_0x29671e(0x111)]({'email':_0x31688e[_0x29671e(0x199)]});_0xfd55cc=await warehouse[_0x29671e(0x100)]([{'$match':{'status':_0x29671e(0x1b8),'name':_0x3e6ed9[_0x29671e(0x170)],'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x29671e(0x179)}}},{'$group':{'_id':_0x29671e(0x125),'name':{'$first':_0x29671e(0x125)}}}]);}else _0xfd55cc=await warehouse['aggregate']([{'$match':{'status':_0x29671e(0x1b8),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0x29671e(0x179)}}},{'$group':{'_id':'$name','name':{'$first':_0x29671e(0x125)}}}]);if(_0x14417f[0x0][_0x29671e(0x1a5)]==_0x29671e(0x1aa)){var _0x1962b5=users[_0x29671e(0x1d0)];console[_0x29671e(0x1c3)](_0x1962b5);}else{if(_0x14417f[0x0]['language']==_0x29671e(0x171))var _0x1962b5=users[_0x29671e(0x171)];else{if(_0x14417f[0x0][_0x29671e(0x1a5)]==_0x29671e(0x176))var _0x1962b5=users[_0x29671e(0x176)];else{if(_0x14417f[0x0]['language']==_0x29671e(0x185))var _0x1962b5=users[_0x29671e(0x185)];else{if(_0x14417f[0x0]['language']==_0x29671e(0x14e))var _0x1962b5=users[_0x29671e(0x14e)];else{if(_0x14417f[0x0][_0x29671e(0x1a5)]=='Portuguese\x20(BR)')var _0x1962b5=users[_0x29671e(0x17b)];else{if(_0x14417f[0x0][_0x29671e(0x1a5)]==_0x29671e(0x124))var _0x1962b5=users[_0x29671e(0x124)];else{if(_0x14417f[0x0][_0x29671e(0x1a5)]=='Arabic\x20(ae)')var _0x1962b5=users[_0x29671e(0x1ca)];}}}}}}}_0x4e66e1[_0x29671e(0x11e)]('edit_adjustment',{'success':_0x1e29bd[_0x29671e(0x1b4)](_0x29671e(0x138)),'errors':_0x1e29bd['flash'](_0x29671e(0x115)),'role':_0x31688e,'profile':_0x4f6eae,'adjustment':_0x5c73d9,'stock':_0x3df456,'master_shop':_0x14417f,'warehouse_name':_0x231b70,'unit':_0x402afe,'language':_0x1962b5,'warehouse':_0xfd55cc});}catch(_0x1b1410){console[_0x29671e(0x1c3)](_0x1b1410),_0x4e66e1[_0x29671e(0x178)](0xc8)[_0x29671e(0x1b2)]({'message':_0x1b1410[_0x29671e(0x143)]});}}),router[a0_0x386eff(0x195)]('/view/:id',auth,async(_0x336f24,_0x2c3b11)=>{var _0x5dd877=a0_0x386eff;try{const _0x167806=_0x336f24['params']['id'],_0x3e168d=await adjustment[_0x5dd877(0x1a8)]({'_id':_0x167806}),_0x2feed5=await warehouse[_0x5dd877(0x111)]({'name':_0x3e168d[_0x5dd877(0x121)],'room':_0x3e168d[_0x5dd877(0x15b)]}),{warehouse_name:_0x5c655c,date:_0x156be4,prod_name:_0x32d2f9,level:_0x47edf2,isle:_0x53421e,pallet:_0x1a5851,stock:_0x56e7ba,types:_0x33ec84,adjust_qty:_0x35b119,new_adjust_qty:_0x1a7047,note:_0x318abe,Room_name:_0x4fdb39,invoice:_0x39939d,JO_number:_0x145b93,expiry_date:_0x248d58}=_0x336f24['body'];if(typeof _0x32d2f9=='string')var _0x1f8e84=[_0x336f24['body'][_0x5dd877(0x1b3)]],_0x350689=[_0x336f24['body'][_0x5dd877(0x117)]],_0x2c8669=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x168)]],_0x53143a=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x1c6)]],_0xeb0567=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x1a0)]],_0x3bb2eb=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x14b)]],_0x4316ec=[_0x336f24['body'][_0x5dd877(0x1b0)]],_0x1fb433=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x13b)]],_0x34df41=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x145)]],_0x4d18f4=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x16b)]],_0x55b9fc=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x187)]],_0x643aee=[_0x336f24['body'][_0x5dd877(0x14d)]],_0x3cc515=[_0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x18d)]],_0x38c51a=[_0x336f24[_0x5dd877(0x13e)]['prod_cat']],_0x474942=[_0x336f24['body']['Rooms']],_0x1deedb=[_0x336f24['body']['prime1']],_0x3b613d=[_0x336f24[_0x5dd877(0x13e)]['second1']];else var _0x1f8e84=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x1b3)]],_0x350689=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x117)]],_0x2c8669=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x168)]],_0x53143a=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x1c6)]],_0xeb0567=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x1a0)]],_0x3bb2eb=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x14b)]],_0x4316ec=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x14f)]],_0x1fb433=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x13b)]],_0x34df41=[..._0x336f24[_0x5dd877(0x13e)]['prod_code']],_0x4d18f4=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x16b)]],_0x55b9fc=[..._0x336f24['body'][_0x5dd877(0x187)]],_0x643aee=[..._0x336f24['body'][_0x5dd877(0x14d)]],_0x3cc515=[..._0x336f24['body']['production_date']],_0x38c51a=[..._0x336f24['body'][_0x5dd877(0x183)]],_0x474942=[..._0x336f24['body'][_0x5dd877(0x191)]],_0x1deedb=[..._0x336f24['body'][_0x5dd877(0x188)]],_0x3b613d=[..._0x336f24[_0x5dd877(0x13e)][_0x5dd877(0x16c)]];const _0x575fc0=_0x1f8e84[_0x5dd877(0x16f)](_0x20f044=>{return _0x20f044={'product_name':_0x20f044};});_0x350689['forEach']((_0x16bad8,_0x5109a4)=>{var _0x5e8706=_0x5dd877;_0x474942[_0x5e8706(0x153)]((_0x4dc14b,_0x7ceada)=>{var _0x359253=_0x5e8706;if(_0x4dc14b==_0x359253(0x141)&&_0x5109a4==_0x7ceada){var _0x318ce7=_0x16bad8[_0x359253(0x10e)](0x3);_0x575fc0[_0x5109a4]['storage']=_0x16bad8[0x0],_0x575fc0[_0x5109a4][_0x359253(0x1a7)]=_0x16bad8[0x1],_0x575fc0[_0x5109a4][_0x359253(0x16e)]=0x0,_0x575fc0[_0x5109a4][_0x359253(0x150)]=0x0,_0x575fc0[_0x5109a4][_0x359253(0x169)]=_0x359253(0x12f),_0x575fc0[_0x5109a4][_0x359253(0x17c)]=_0x318ce7;}else{if(_0x4dc14b==_0x359253(0x154)&&_0x5109a4==_0x7ceada){var _0x318ce7=_0x16bad8['slice'](0x3);_0x575fc0[_0x5109a4][_0x359253(0x120)]=_0x16bad8[0x0],_0x575fc0[_0x5109a4][_0x359253(0x1a7)]=_0x16bad8[0x1],_0x575fc0[_0x5109a4][_0x359253(0x16e)]=0x0,_0x575fc0[_0x5109a4][_0x359253(0x150)]=0x0,_0x575fc0[_0x5109a4][_0x359253(0x169)]=_0x359253(0x12f),_0x575fc0[_0x5109a4]['floorlevel']=_0x16bad8[0x5];}else{if(_0x5109a4==_0x7ceada){var _0x4ef8a2;if(_0x16bad8[0x4]=='L')_0x4ef8a2='Level';else _0x16bad8[0x4]=='F'&&(_0x4ef8a2=_0x359253(0x12f));_0x575fc0[_0x5109a4]['storage']=_0x16bad8[0x0],_0x575fc0[_0x5109a4][_0x359253(0x1a7)]=_0x16bad8[0x1],_0x575fc0[_0x5109a4][_0x359253(0x16e)]=_0x16bad8[0x2],_0x575fc0[_0x5109a4][_0x359253(0x150)]=_0x16bad8[0x3],_0x575fc0[_0x5109a4][_0x359253(0x169)]=_0x4ef8a2,_0x575fc0[_0x5109a4]['floorlevel']=_0x16bad8[0x5];}}}});}),_0x2c8669[_0x5dd877(0x153)]((_0x54f8f8,_0x2630cd)=>{var _0x5d99cc=_0x5dd877;_0x575fc0[_0x2630cd][_0x5d99cc(0x13a)]=_0x54f8f8;}),_0x53143a[_0x5dd877(0x153)]((_0x2e60cb,_0x155437)=>{var _0x3fc15b=_0x5dd877;_0x575fc0[_0x155437][_0x3fc15b(0x1c6)]=_0x2e60cb;}),_0xeb0567[_0x5dd877(0x153)]((_0x203ff0,_0xc6af4b)=>{_0x575fc0[_0xc6af4b]['adjust_qty']=_0x203ff0;}),_0x3bb2eb[_0x5dd877(0x153)]((_0x2dbad6,_0x5e7977)=>{var _0x341d96=_0x5dd877;_0x575fc0[_0x5e7977][_0x341d96(0x1c1)]=_0x2dbad6;}),_0x4316ec[_0x5dd877(0x153)]((_0x111908,_0x1c797e)=>{var _0xd355b7=_0x5dd877;_0x575fc0[_0x1c797e][_0xd355b7(0x14f)]=_0x111908;}),_0x1fb433[_0x5dd877(0x153)]((_0x252011,_0x1c1016)=>{_0x575fc0[_0x1c1016]['secondary_unit']=_0x252011;}),_0x34df41[_0x5dd877(0x153)]((_0x1c49cd,_0x2eff51)=>{var _0x5d87a4=_0x5dd877;_0x575fc0[_0x2eff51][_0x5d87a4(0x13d)]=_0x1c49cd;}),_0x4d18f4[_0x5dd877(0x153)]((_0x2ae76b,_0x46f408)=>{var _0x1c6b7e=_0x5dd877;_0x575fc0[_0x46f408][_0x1c6b7e(0x16b)]=_0x2ae76b;}),_0x55b9fc['forEach']((_0x2528da,_0x2b1787)=>{_0x575fc0[_0x2b1787]['expiry_date']=_0x2528da;}),_0x643aee[_0x5dd877(0x153)]((_0xff55b6,_0x3fed48)=>{var _0x595bc1=_0x5dd877;_0x575fc0[_0x3fed48][_0x595bc1(0x1a2)]=_0xff55b6;}),_0x3cc515[_0x5dd877(0x153)]((_0x48c5f2,_0x567a13)=>{var _0x42af84=_0x5dd877;_0x575fc0[_0x567a13][_0x42af84(0x18d)]=_0x48c5f2;}),_0x38c51a[_0x5dd877(0x153)]((_0x192db5,_0x5bc2f5)=>{var _0x26b819=_0x5dd877;_0x575fc0[_0x5bc2f5][_0x26b819(0x183)]=_0x192db5;}),_0x474942[_0x5dd877(0x153)]((_0x3cf18,_0x4a4fa0)=>{_0x575fc0[_0x4a4fa0]['room_names']=_0x3cf18;}),_0x1deedb[_0x5dd877(0x153)]((_0x39afb8,_0x3a4837)=>{var _0x2d760a=_0x5dd877;_0x575fc0[_0x3a4837][_0x2d760a(0xff)]=_0x39afb8;}),_0x3b613d[_0x5dd877(0x153)]((_0x4ba002,_0x27594a)=>{var _0x40e128=_0x5dd877;_0x575fc0[_0x27594a][_0x40e128(0x19a)]=_0x4ba002;});const _0xce12c8=_0x575fc0[_0x5dd877(0x186)](_0x299be7=>_0x299be7[_0x5dd877(0x127)]!=='0'&&_0x299be7['adjust_qty']!=='');var _0x268cfa=0x0;_0xce12c8[_0x5dd877(0x153)](_0x446609=>{var _0x456763=_0x5dd877;console[_0x456763(0x1c3)](_0x456763(0x122),_0x446609),parseInt(_0x446609[_0x456763(0x127)])<=0x0&&_0x268cfa++;});if(_0x268cfa!=0x0)return _0x336f24['flash'](_0x5dd877(0x115),_0x5dd877(0x13c)),_0x2c3b11[_0x5dd877(0x1ac)](_0x5dd877(0x1b9));_0x3e168d[_0x5dd877(0x121)]=_0x5c655c,_0x3e168d[_0x5dd877(0x1be)]=_0x156be4,_0x3e168d[_0x5dd877(0x11f)]=_0xce12c8,_0x3e168d['note']=_0x318abe,_0x3e168d['invoice']=_0x39939d,_0x3e168d[_0x5dd877(0x1bc)]='False';const _0x3a26ba=await _0x3e168d['save']();_0x336f24[_0x5dd877(0x1b4)]('success',_0x5dd877(0x15d)),_0x2c3b11[_0x5dd877(0x1ac)](_0x5dd877(0x15f));}catch(_0x4070cc){console[_0x5dd877(0x1c3)](_0x4070cc);}}),router[a0_0x386eff(0x195)](a0_0x386eff(0x1c7),async(_0x569d27,_0x44b3f5)=>{var _0xeedaaf=a0_0x386eff;const {primary_code:_0x46b268,warehouse_data:_0x4a5eba,rooms_data:_0x1d776b,Roomslist:_0x18580a}=_0x569d27[_0xeedaaf(0x13e)],_0x7e2f19=_0x18580a[_0xeedaaf(0x1cd)](','),_0x1ae03c=[];async function _0x263b2d(_0x30484e){var _0x5ad25a=_0xeedaaf;const _0x440a93=await warehouse['aggregate']([{'$match':{'name':_0x4a5eba,'room':_0x30484e}},{'$unwind':_0x5ad25a(0x114)},{'$match':{'product_details.primary_code':_0x46b268}},{'$group':{'_id':_0x5ad25a(0x102),'name':{'$first':_0x5ad25a(0x181)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x5ad25a(0x1b1)},'secondary_code':{'$first':_0x5ad25a(0x1c2)},'product_code':{'$first':_0x5ad25a(0x156)},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x5ad25a(0x158)},'pallet':{'$first':_0x5ad25a(0x167)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5ad25a(0x184)},'storage':{'$first':_0x5ad25a(0x1c4)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5ad25a(0x197)},'maxPerUnit':{'$first':_0x5ad25a(0x128)},'batch_code':{'$first':_0x5ad25a(0x1b7)},'product_cat':{'$first':_0x5ad25a(0x173)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x5ad25a(0x1c8)}}}]),_0x212cc2=await warehouse[_0x5ad25a(0x100)]([{'$match':{'name':_0x4a5eba,'room':_0x30484e}},{'$unwind':_0x5ad25a(0x114)},{'$match':{'product_details.secondary_code':_0x46b268}},{'$group':{'_id':_0x5ad25a(0x102),'name':{'$first':_0x5ad25a(0x181)},'product_stock':{'$first':_0x5ad25a(0x159)},'primary_code':{'$first':_0x5ad25a(0x1b1)},'secondary_code':{'$first':_0x5ad25a(0x1c2)},'product_code':{'$first':_0x5ad25a(0x156)},'level':{'$first':_0x5ad25a(0x1c0)},'isle':{'$first':_0x5ad25a(0x1a3)},'type':{'$first':_0x5ad25a(0x158)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x5ad25a(0x1c5)},'secondary_unit':{'$first':_0x5ad25a(0x184)},'storage':{'$first':_0x5ad25a(0x1c4)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5ad25a(0x116)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x5ad25a(0x128)},'batch_code':{'$first':_0x5ad25a(0x1b7)},'product_cat':{'$first':_0x5ad25a(0x173)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5ad25a(0x1c8)}}}]);if(_0x440a93[_0x5ad25a(0x1cc)]>0x0)_0x1ae03c[_0x5ad25a(0x163)](_0x440a93);else _0x212cc2[_0x5ad25a(0x1cc)]>0x0&&_0x1ae03c[_0x5ad25a(0x163)](_0x212cc2);}const _0x5b325e=_0x7e2f19[_0xeedaaf(0x16f)](_0x15b30e=>_0x263b2d(_0x15b30e));await Promise[_0xeedaaf(0x144)](_0x5b325e),_0x44b3f5[_0xeedaaf(0x1b2)](_0x1ae03c);}),router[a0_0x386eff(0x195)](a0_0x386eff(0x10d),async(_0x58a5b4,_0x534559)=>{var _0x4fab61=a0_0x386eff;const {primaryCode:_0x3ba99e,secondaryCode:_0x12998e,productCode:_0x1962d6,level:_0x3b9952,isle:_0xc07f67,pallet:_0x53eb32,warehouses:_0x324d06,room:_0x31b10c}=_0x58a5b4[_0x4fab61(0x13e)];try{const _0x142c85=await warehouse[_0x4fab61(0x100)]([{'$match':{'name':_0x324d06,'room':_0x31b10c}},{'$unwind':_0x4fab61(0x114)},{'$match':{'product_details.level':parseInt(_0x3b9952),'product_details.isle':_0xc07f67,'product_details.pallet':parseInt(_0x53eb32)}},{'$group':{'_id':_0x4fab61(0x102),'name':{'$first':_0x4fab61(0x181)},'product_stock':{'$first':_0x4fab61(0x159)},'level':{'$first':_0x4fab61(0x196)},'isle':{'$first':_0x4fab61(0x15a)},'pallet':{'$first':_0x4fab61(0x137)},'maxProducts':{'$first':_0x4fab61(0x123)}}}]);_0x534559[_0x4fab61(0x178)](0xc8)[_0x4fab61(0x1b2)](_0x142c85);}catch(_0x26d0b1){_0x534559[_0x4fab61(0x178)](0x194)[_0x4fab61(0x1b2)]({'message':_0x26d0b1[_0x4fab61(0x143)]});}}),module['exports']=router;