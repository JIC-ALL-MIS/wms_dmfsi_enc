function a0_0x33d7(){var _0x15eb12=['Arabic','max','/view/:id','catch','RoomAssigned','Enabled','sendMail','$product_details.product_code','primary_unit','error','getMonth','$product_details.floorlevel','$date','An\x20error\x20occurred.','/give_payment/:id','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$customers_docs','nodemailer','/view/add_sales','True','success','$product_details.invoice','ADD\x20SALE','/view/return_sales/:id','305450eMVEIe','sale_product','getDate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$customer','return_sale','$product_details.rack','push','quantity','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','production_date','../models/all_models','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','currency_placement','invoice','German','$product_details.maxProducts','product_code_QA','final','$sale_product.quantity','padStart','<tbody\x20style=\x22text-align:\x20center;\x22>','stock_data','expiry_date_QA','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','map','/view/add_sale/product','Add\x20Sales','\x20&&\x20','finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','160984nDGfyQ','sale_qty','all','return_sale_QA','express','$sale_product.floorlevel','name','prod_cat','barcode\x20Product\x20master','\x20==\x20','$product_details.product_name','add_sales_finished','$room','batch_code','$product','$product_details','warehouse','customers_docs','</body></html>','Portuguese','English\x20(US)','1344Ipudao','body','</thead>','stock','post','stocks_QA','foreach\x20newproduct','/upload/','concat','back','Sale\x20Return\x20Mail','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</h5>','/all_sales_finished/preview/','product_details','return_sale_finished','</tbody>','image','$product_details.storage','$product_details.primary_code','save','gmail','level','/barcode/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','findOne','maxProducts_QA','secondary_unit','date','random','/all_sales/view','\x20</h2>','maxPerUnit_QA','$product_details.expiry_date','</span>','customer','carton','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','return_qty_QA','Spanish','purchases_data','staff','product_name','language','Chinese','forEach','$product_details.unit','$invoice','batch_code_QA','primary_code','edit_sales_finished','adjust_qty','length','abs','for_categorize','then','string','received_amount','<tr>','user','DRY\x20GOODS','sales_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$note','floor','sales_quantity_QA','54kGXhQp','Ambient','room','/barcode_scanner','render','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','flash','Hindi','currency','createTransport','$warehouse_name','split','$product_details.secondary_code','maxProducts','redirect','room_name','$product_details.secondary_unit','../middleware/auth','slice','maxPerUnit','role','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product','log','$product_details.room_name','email','/view','English','/preview/:id','toString','\x20>>>\x20','\x20Order\x20Number\x20:\x20','product_stock','Logo.png','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','French','product_data','get','suppliers','unit','$product_details.product_cat','$product_details.production_date','761565bSWZDm','json','host','filter','Sales\x20Update\x20successfully','edit_sales_finished_view','_id','$product_details.product_stock','unit_QA','$finalize','primary_code_QA','</td>','master','/view/add_sales/:id','expiry_date','$return_data','secondary_code_QA','Quality\x20Inspection','maxperunit','Received\x20Payment\x20For\x20Sale','$product_details.batch_code','message','$product_details._id','return_qty','password','Router','return_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','secondary_code','</head><body>','$sale_product.bay','bay','id_transaction_from','find','450866vbQhaN','$product_details.bay','</table>','barcode\x20user_id','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','product_name_QA1','<h5>','status','13839TRZYZK','/invoice/:id','$product_details.type','<table\x20style=\x22width:\x20100%\x20!important;\x22>','2368510rgeqZl','$product_details.bin','logo','949884eiWdJo','<!DOCTYPE\x20html>','production_date_QA','prod_code','<div>','findById','$sale_product.type','customer_data','\x20<<<==>>>\x20','Portuguese\x20(BR)','aggregate','Finished\x20Goods','22ZeKXEh','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</div>','sales_quantity','Email\x20sent\x20successfully','prod_invoice','4aRXWKp','QA\x20Warehouse','product_list','$product_details.maxPerUnit','port','<hr\x20class=\x22my-3\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','Error\x20Occurs','all_sales_barcode','warehouse_name','OUTF-','</tr>','$_id','max_per_unit','christian.villamer@jakagroup.com','$sale_product','\x20Order\x20Date\x20:\x20','product_date','customers','../public/language/languages.json','<span\x20style=\x22float:\x20right;\x22>','sales\x20item\x20return\x20successfull','params','site_title','$name','/all_sales_finished/view','<strong>\x20Regards\x20</strong>','Enclosed','<html><head><title></title>','errors','Arabic\x20(ae)','payment\x20successfull','$sale_product.bin','getFullYear','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'];a0_0x33d7=function(){return _0x15eb12;};return a0_0x33d7();}var a0_0xede780=a0_0x11ab;(function(_0x24998c,_0x2ab671){var _0x58a0ea=a0_0x11ab,_0x477081=_0x24998c();while(!![]){try{var _0x21619=-parseInt(_0x58a0ea(0x112))/0x1+parseInt(_0x58a0ea(0x121))/0x2+parseInt(_0x58a0ea(0xf0))/0x3+parseInt(_0x58a0ea(0x134))/0x4*(parseInt(_0x58a0ea(0x170))/0x5)+parseInt(_0x58a0ea(0x1a5))/0x6*(-parseInt(_0x58a0ea(0x11a))/0x7)+parseInt(_0x58a0ea(0x190))/0x8*(-parseInt(_0x58a0ea(0xc5))/0x9)+parseInt(_0x58a0ea(0x11e))/0xa*(parseInt(_0x58a0ea(0x12d))/0xb);if(_0x21619===_0x2ab671)break;else _0x477081['push'](_0x477081['shift']());}catch(_0x4cddab){_0x477081['push'](_0x477081['shift']());}}}(a0_0x33d7,0x3cd31));const express=require(a0_0xede780(0x194)),app=express(),router=express[a0_0xede780(0x109)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0xede780(0x17c)),auth=require(a0_0xede780(0xd6)),nodemailer=require(a0_0xede780(0x169)),users=require(a0_0xede780(0x147));router[a0_0xede780(0xeb)](a0_0xede780(0xdf),auth,async(_0x1b3d4c,_0x4deaee)=>{var _0x2865dc=a0_0xede780;try{const {username:_0x20ca3a,email:_0xae33c1,role:_0x4b51ea}=_0x1b3d4c[_0x2865dc(0xbe)],_0x2d389e=_0x1b3d4c[_0x2865dc(0xbe)],_0x53f6b1=await profile[_0x2865dc(0x1be)]({'email':_0x2d389e[_0x2865dc(0xde)]}),_0x4ebdf5=await master_shop[_0x2865dc(0x111)]();let _0x42fee3;if(_0x2d389e[_0x2865dc(0xd9)]==_0x2865dc(0x1ce)){const _0xe6efd3=await staff[_0x2865dc(0x1be)]({'email':_0x2d389e[_0x2865dc(0xde)]});_0x42fee3=await sales_finished[_0x2865dc(0x12b)]([{'$lookup':{'from':_0x2865dc(0x146),'localField':_0x2865dc(0x1c8),'foreignField':_0x2865dc(0x196),'as':_0x2865dc(0x1a1)}},{'$unwind':_0x2865dc(0x168)},{'$unwind':_0x2865dc(0x143)},{'$group':{'_id':_0x2865dc(0x140),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x2865dc(0x174)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x2865dc(0x143)},'note':{'$first':_0x2865dc(0xc2)},'return_data':{'$first':_0x2865dc(0xff)},'customers_docs':{'$first':_0x2865dc(0x168)},'total_saleproduct_quantity':{'$sum':_0x2865dc(0x184)},'level':{'$addToSet':_0x2865dc(0x10e)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x2865dc(0x127)},'pallet':{'$addToSet':_0x2865dc(0x195)},'finalize':{'$first':_0x2865dc(0xf9)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x42fee3=await sales_finished[_0x2865dc(0x12b)]([{'$lookup':{'from':_0x2865dc(0x146),'localField':_0x2865dc(0x1c8),'foreignField':'name','as':_0x2865dc(0x1a1)}},{'$unwind':_0x2865dc(0x168)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x2865dc(0x140),'invoice':{'$first':_0x2865dc(0x1d4)},'customers':{'$first':'$customer'},'date':{'$first':_0x2865dc(0x164)},'warehouse_name':{'$first':_0x2865dc(0xcf)},'sale_product':{'$push':_0x2865dc(0x143)},'note':{'$first':_0x2865dc(0xc2)},'return_data':{'$first':_0x2865dc(0xff)},'customers_docs':{'$first':_0x2865dc(0x168)},'total_saleproduct_quantity':{'$sum':_0x2865dc(0x184)},'level':{'$addToSet':_0x2865dc(0x10e)},'isle':{'$addToSet':_0x2865dc(0x154)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x2865dc(0xf9)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x4ebdf5[0x0]['language']==_0x2865dc(0x1a4)){var _0x4c2944=users[_0x2865dc(0xe0)];console[_0x2865dc(0xdc)](_0x4c2944);}else{if(_0x4ebdf5[0x0][_0x2865dc(0x1d0)]=='Hindi')var _0x4c2944=users[_0x2865dc(0xcc)];else{if(_0x4ebdf5[0x0][_0x2865dc(0x1d0)]=='German')var _0x4c2944=users[_0x2865dc(0x180)];else{if(_0x4ebdf5[0x0][_0x2865dc(0x1d0)]==_0x2865dc(0x1cc))var _0x4c2944=users[_0x2865dc(0x1cc)];else{if(_0x4ebdf5[0x0][_0x2865dc(0x1d0)]=='French')var _0x4c2944=users[_0x2865dc(0xe9)];else{if(_0x4ebdf5[0x0]['language']==_0x2865dc(0x12a))var _0x4c2944=users['Portuguese'];else{if(_0x4ebdf5[0x0]['language']==_0x2865dc(0x1d1))var _0x4c2944=users[_0x2865dc(0x1d1)];else{if(_0x4ebdf5[0x0][_0x2865dc(0x1d0)]=='Arabic\x20(ae)')var _0x4c2944=users[_0x2865dc(0x158)];}}}}}}}_0x4deaee[_0x2865dc(0xc9)]('all_sales_finished',{'success':_0x1b3d4c[_0x2865dc(0xcb)](_0x2865dc(0x16c)),'errors':_0x1b3d4c['flash'](_0x2865dc(0x151)),'sales':_0x42fee3,'profile':_0x53f6b1,'role':_0x2d389e,'master_shop':_0x4ebdf5,'language':_0x4c2944});}catch(_0x1b1601){console['log'](_0x1b1601);}});async function getRandom8DigitNumber(){var _0x25f7be=a0_0xede780;const _0x4b8d87=0x989680,_0x13a0d2=0x5f5e0ff,_0x5d20c5=Math[_0x25f7be(0xc3)](Math[_0x25f7be(0x1c2)]()*(_0x13a0d2-_0x4b8d87+0x1))+_0x4b8d87;var _0x141f65;const _0x4e0c73=await sales_finished[_0x25f7be(0x1be)]({'invoice':_0x25f7be(0x13e)+_0x5d20c5});return _0x4e0c73&&_0x4e0c73[_0x25f7be(0xb7)]>0x0?_0x141f65='OUTF-'+_0x5d20c5:_0x141f65=_0x25f7be(0x13e)+_0x5d20c5,_0x141f65;}function a0_0x11ab(_0x452f7f,_0x4861cd){var _0x33d7e4=a0_0x33d7();return a0_0x11ab=function(_0x11ab1f,_0x67dc60){_0x11ab1f=_0x11ab1f-0xb3;var _0x1b236d=_0x33d7e4[_0x11ab1f];return _0x1b236d;},a0_0x11ab(_0x452f7f,_0x4861cd);}router[a0_0xede780(0xeb)](a0_0xede780(0x16a),auth,async(_0x36c06f,_0x11641f)=>{var _0x34cf51=a0_0xede780;try{const {username:_0x5c43df,email:_0x2ee6df,role:_0x1d9cf8}=_0x36c06f['user'],_0x4f5c55=_0x36c06f[_0x34cf51(0xbe)],_0x151269=await profile[_0x34cf51(0x1be)]({'email':_0x4f5c55['email']}),_0x34fb44=await master_shop[_0x34cf51(0x111)](),_0x1c24c7=await customer['find']({});let _0x517909;if(_0x4f5c55[_0x34cf51(0xd9)]==_0x34cf51(0x1ce)){const _0x28f780=await staff[_0x34cf51(0x1be)]({'email':_0x4f5c55[_0x34cf51(0xde)]});_0x517909=await warehouse['aggregate']([{'$match':{'status':_0x34cf51(0x15d),'name':_0x28f780[_0x34cf51(0x1a0)],'warehouse_category':_0x34cf51(0x12c),'name':{'$ne':_0x34cf51(0x135)}}},{'$group':{'_id':_0x34cf51(0x14c),'name':{'$first':_0x34cf51(0x14c)}}},{'$sort':{'name':0x1}}]);}else _0x517909=await warehouse[_0x34cf51(0x12b)]([{'$match':{'status':_0x34cf51(0x15d),'warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x34cf51(0x14c)}}},{'$sort':{'name':0x1}}]);const _0x302074=await product[_0x34cf51(0x111)]({});var _0x4c1ee3=['Ambient',_0x34cf51(0x14f)];const _0xa41be8=await sales_finished['find']({}),_0x5c27dd=_0xa41be8['length']+0x1,_0xd6f005=_0x34cf51(0x13e)+_0x5c27dd[_0x34cf51(0xe2)]()[_0x34cf51(0x185)](0x5,'0');if(_0x34fb44[0x0][_0x34cf51(0x1d0)]==_0x34cf51(0x1a4)){var _0x5799a7=users[_0x34cf51(0xe0)];console[_0x34cf51(0xdc)](_0x5799a7);}else{if(_0x34fb44[0x0][_0x34cf51(0x1d0)]==_0x34cf51(0xcc))var _0x5799a7=users['Hindi'];else{if(_0x34fb44[0x0]['language']==_0x34cf51(0x180))var _0x5799a7=users[_0x34cf51(0x180)];else{if(_0x34fb44[0x0][_0x34cf51(0x1d0)]=='Spanish')var _0x5799a7=users[_0x34cf51(0x1cc)];else{if(_0x34fb44[0x0]['language']=='French')var _0x5799a7=users[_0x34cf51(0xe9)];else{if(_0x34fb44[0x0]['language']=='Portuguese\x20(BR)')var _0x5799a7=users[_0x34cf51(0x1a3)];else{if(_0x34fb44[0x0][_0x34cf51(0x1d0)]==_0x34cf51(0x1d1))var _0x5799a7=users[_0x34cf51(0x1d1)];else{if(_0x34fb44[0x0]['language']==_0x34cf51(0x152))var _0x5799a7=users['Arabic'];}}}}}}}const _0x1d379b=getRandom8DigitNumber();_0x1d379b['then'](_0x18ff5c=>{var _0x24c139=_0x34cf51;_0x11641f[_0x24c139(0xc9)](_0x24c139(0x19b),{'success':_0x36c06f[_0x24c139(0xcb)](_0x24c139(0x16c)),'errors':_0x36c06f[_0x24c139(0xcb)](_0x24c139(0x151)),'role':_0x4f5c55,'profile':_0x151269,'customer':_0x1c24c7,'warehouse':_0x517909,'product':_0x302074,'invoice':_0x18ff5c,'master_shop':_0x34fb44,'language':_0x5799a7,'rooms_data':_0x4c1ee3});})['catch'](_0x6b1fba=>{var _0x2ce262=_0x34cf51;_0x36c06f[_0x2ce262(0xcb)](_0x2ce262(0x151),_0x2ce262(0xda)),_0x11641f['redirect'](_0x2ce262(0x14d));});}catch(_0xc9f1e9){console['log'](_0xc9f1e9);}}),router['get'](a0_0xede780(0xfd),auth,async(_0x2a79f9,_0x59b6b8)=>{var _0x5a2354=a0_0xede780;try{const _0x56c3d9=_0x2a79f9[_0x5a2354(0x14a)]['id'];console['log'](_0x56c3d9);const _0x3b5d6e=await product[_0x5a2354(0x111)](),_0x498fcd=await purchases[_0x5a2354(0x12b)]([{'$match':{'warehouse_name':_0x56c3d9}},{'$unwind':_0x5a2354(0x19e)},{'$group':{'_id':'$product.product_name'}}]);console['log'](_0x5a2354(0x1cd),_0x498fcd),_0x59b6b8[_0x5a2354(0x119)](0xc8)[_0x5a2354(0xf1)]({'purchases_data':_0x498fcd,'product_data':_0x3b5d6e});}catch(_0x5d61c3){console['log'](_0x5d61c3);}}),router['post'](a0_0xede780(0x18b),auth,async(_0x5bd1c5,_0x342a06)=>{var _0x36b1bc=a0_0xede780;try{const {warehouse_data:_0x32c8bb,product_data:_0x114f1f}=_0x5bd1c5['body'];console['log'](_0x5bd1c5['body'][_0x36b1bc(0xea)]);;const _0x44d8af=await master_shop[_0x36b1bc(0x111)]();console[_0x36b1bc(0xdc)](_0x36b1bc(0xfc),_0x44d8af);const _0x296ddf=await product['findOne']({'name':_0x114f1f});console[_0x36b1bc(0xdc)](_0x36b1bc(0xdb),_0x296ddf);const _0x382960=await warehouse[_0x36b1bc(0x12b)]([{'$match':{'name':_0x32c8bb}},{'$unwind':_0x36b1bc(0x19f)},{'$match':{'product_details.product_name':_0x114f1f}},{'$group':{'_id':_0x36b1bc(0x19a),'product_stock':{'$first':_0x36b1bc(0xf7)}}}]);console[_0x36b1bc(0xdc)](_0x36b1bc(0x187),_0x382960),_0x342a06[_0x36b1bc(0x119)](0xc8)[_0x36b1bc(0xf1)]({'master':_0x44d8af,'new_product':_0x296ddf,'stock_data':_0x382960});}catch(_0x1cb6ca){console[_0x36b1bc(0xdc)](_0x1cb6ca);}}),router[a0_0xede780(0x1a9)](a0_0xede780(0x16a),auth,async(_0x2a0143,_0x378f60)=>{var _0x19bd04=a0_0xede780;try{const {invoice:_0x3b9cad,date:_0x192e8d,warehouse_name:_0x2ef5cc,product_name:_0x519bf7,stock:_0x4b45af,quantity:_0x4269bc,note:_0x249529,room:_0x13c17b,primary_code:_0x4d47bd,secondary_code:_0x42a325,prod_code:_0x24aabe,level:_0x31c268,isle:_0x48e3c7,pallet:_0x330dd5,batch_code:_0x59f5f5,SCRN:_0xa0a7c6,expiry_date:_0x42c19f,mode_transpo:_0x436ce5,name_driver:_0x1c855b}=_0x2a0143[_0x19bd04(0x1a6)];if(typeof _0x519bf7==_0x19bd04(0xbb))var _0x420e6d=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1cf)]],_0x2599a9=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1a8)]],_0x393e2b=[_0x2a0143[_0x19bd04(0x1a6)]['carton']],_0x518e2e=[_0x2a0143[_0x19bd04(0x1a6)]['primary_code']],_0x26006b=[_0x2a0143[_0x19bd04(0x1a6)]['secondary_code']],_0x516f21=[_0x2a0143['body']['prod_code']],_0x393ca9=[_0x2a0143['body'][_0x19bd04(0x1bb)]],_0x5b3014=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x160)]],_0xe705d0=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1c0)]],_0x3fb7f1=[_0x2a0143[_0x19bd04(0x1a6)]['batch_code']],_0x33a5ab=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0xfe)]],_0x42cf64=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x145)]],_0x52580d=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x141)]],_0x2b9ff7=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x197)]],_0x1ea74e=[_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x15c)]],_0x81cb50=[_0x2a0143[_0x19bd04(0x1a6)]['prod_invoice']],_0x5bf9f5=[_0x2a0143[_0x19bd04(0x1a6)]['id_transaction_from']];else var _0x420e6d=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1cf)]],_0x2599a9=[..._0x2a0143['body'][_0x19bd04(0x1a8)]],_0x393e2b=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1c9)]],_0x518e2e=[..._0x2a0143[_0x19bd04(0x1a6)]['primary_code']],_0x26006b=[..._0x2a0143[_0x19bd04(0x1a6)]['secondary_code']],_0x516f21=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x124)]],_0x393ca9=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1bb)]],_0x5b3014=[..._0x2a0143['body'][_0x19bd04(0x160)]],_0xe705d0=[..._0x2a0143['body'][_0x19bd04(0x1c0)]],_0x3fb7f1=[..._0x2a0143[_0x19bd04(0x1a6)]['batch_code']],_0x33a5ab=[..._0x2a0143['body']['expiry_date']],_0x42cf64=[..._0x2a0143['body'][_0x19bd04(0x145)]],_0x52580d=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x141)]],_0x2b9ff7=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x197)]],_0x1ea74e=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x15c)]],_0x81cb50=[..._0x2a0143['body'][_0x19bd04(0x133)]],_0x5bf9f5=[..._0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x110)]];const _0xf21396=_0x420e6d[_0x19bd04(0x18a)](_0x4b9c83=>{return _0x4b9c83={'product_name':_0x4b9c83};});_0x2599a9[_0x19bd04(0x1d2)]((_0x57c519,_0x2eb2b9)=>{_0xf21396[_0x2eb2b9]['stock']=_0x57c519;}),_0x393e2b[_0x19bd04(0x1d2)]((_0x184ca9,_0x21571b)=>{var _0x3477ff=_0x19bd04;_0xf21396[_0x21571b]['quantity']=Math[_0x3477ff(0xb8)](_0x184ca9);}),_0x5bf9f5[_0x19bd04(0x1d2)]((_0x419836,_0x58c809)=>{var _0x2b9e0a=_0x19bd04;_0xf21396[_0x58c809][_0x2b9e0a(0x110)]=_0x419836;}),_0x518e2e[_0x19bd04(0x1d2)]((_0x3ee2c6,_0x12b389)=>{var _0x44459a=_0x19bd04;_0xf21396[_0x12b389][_0x44459a(0xb4)]=_0x3ee2c6;}),_0x26006b[_0x19bd04(0x1d2)]((_0x584ac6,_0xf85755)=>{var _0x583591=_0x19bd04;_0xf21396[_0xf85755][_0x583591(0x10c)]=_0x584ac6;}),_0x516f21['forEach']((_0x44ea9d,_0x51217b)=>{_0xf21396[_0x51217b]['product_code']=_0x44ea9d;}),_0x393ca9[_0x19bd04(0x1d2)]((_0x361edb,_0x4fd954)=>{var _0x2def61=_0x19bd04;_0xf21396[_0x4fd954][_0x2def61(0x10f)]=_0x361edb;}),_0x5b3014[_0x19bd04(0x1d2)]((_0x9cc4ec,_0x3e54ea)=>{var _0x77a5f6=_0x19bd04;_0xf21396[_0x3e54ea][_0x77a5f6(0xed)]=_0x9cc4ec;}),_0xe705d0['forEach']((_0x510839,_0x516ed7)=>{var _0x4f66de=_0x19bd04;_0xf21396[_0x516ed7][_0x4f66de(0x1c0)]=_0x510839;}),_0x3fb7f1['forEach']((_0x37aba0,_0x444b77)=>{_0xf21396[_0x444b77]['batch_code']=_0x37aba0;}),_0x33a5ab['forEach']((_0x8e212b,_0x2a1e2e)=>{var _0x53b775=_0x19bd04;_0xf21396[_0x2a1e2e][_0x53b775(0xfe)]=_0x8e212b;}),_0x42cf64[_0x19bd04(0x1d2)]((_0x2279ab,_0x10475d)=>{var _0x52c459=_0x19bd04;_0xf21396[_0x10475d][_0x52c459(0x17b)]=_0x2279ab;}),_0x52580d[_0x19bd04(0x1d2)]((_0x5eb2f3,_0x190cd7)=>{var _0x583dca=_0x19bd04;_0xf21396[_0x190cd7][_0x583dca(0x102)]=_0x5eb2f3;}),_0x2b9ff7[_0x19bd04(0x1d2)]((_0x2c48e0,_0x45cf00)=>{var _0x26ba0c=_0x19bd04;_0xf21396[_0x45cf00][_0x26ba0c(0x197)]=_0x2c48e0;}),_0x1ea74e['forEach']((_0x15f0e0,_0x237257)=>{_0xf21396[_0x237257]['room_name']=_0x15f0e0;}),_0x81cb50[_0x19bd04(0x1d2)]((_0x5ebde9,_0x244e9e)=>{var _0x4ef02e=_0x19bd04;_0xf21396[_0x244e9e][_0x4ef02e(0x17f)]=_0x5ebde9;});var _0x2081fb=0x0;_0xf21396['forEach'](_0x5e690d=>{var _0x2ae73a=_0x19bd04;parseFloat(_0x5e690d[_0x2ae73a(0x1a8)])<parseFloat(_0x5e690d[_0x2ae73a(0x178)])&&parseFloat(_0x5e690d['quantity'])>parseFloat(_0x5e690d[_0x2ae73a(0x1a8)])&&(console[_0x2ae73a(0xdc)](_0x5e690d[_0x2ae73a(0x1a8)]+'\x20<>\x20'+_0x5e690d[_0x2ae73a(0x178)]),_0x2081fb++);});if(_0x2081fb!=0x0)return _0x2a0143['flash'](_0x19bd04(0x151),_0x19bd04(0xe8)),_0x378f60[_0x19bd04(0xd3)](_0x19bd04(0x1ae));const _0x58eebb=_0xf21396[_0x19bd04(0xf3)](_0x48df56=>_0x48df56[_0x19bd04(0x178)]!=='0'&&_0x48df56[_0x19bd04(0x178)]!==''),_0x32ef0e=new sales_finished({'invoice':_0x3b9cad,'customer':_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1c8)],'date':_0x192e8d,'warehouse_name':_0x2ef5cc,'sale_product':_0x58eebb,'note':_0x249529,'room':_0x13c17b,'primary_code':_0x4d47bd,'secondary_code':_0x42a325,'prod_code':_0x24aabe,'SCRN':_0xa0a7c6,'finalize':'False','mode_transpo':_0x436ce5,'name_driver':_0x1c855b}),_0xdd501d=await _0x32ef0e['save'](),_0x148820=await sales_finished['findOne']({'invoice':_0x3b9cad}),_0x247821=new c_payment_data({'invoice':_0x3b9cad,'customer':_0x2a0143[_0x19bd04(0x1a6)][_0x19bd04(0x1c8)],'reason':'Sale'});await _0x247821['save']();const _0x462e8d=await master_shop[_0x19bd04(0x111)](),_0x249fd7=await email_settings['findOne'](),_0x504abc=await customer[_0x19bd04(0x1be)]({'name':_0x2a0143['body']['customer']});_0x462e8d[0x0][_0x19bd04(0x17e)]==0x1?(right_currency=_0x462e8d[0x0][_0x19bd04(0xcd)],left_currency=''):(right_currency='',left_currency=_0x462e8d[0x0][_0x19bd04(0xcd)]);var _0x244d4c=_0x420e6d,_0x5bfb1d=_0x393e2b,_0x413326='',_0x2cbd15;for(_0x2cbd15 in _0x244d4c){_0x413326+=_0x19bd04(0xbd)+_0x19bd04(0x189)+_0x244d4c[_0x2cbd15]+_0x19bd04(0xfb)+_0x19bd04(0x189)+_0x5bfb1d[_0x2cbd15]+_0x19bd04(0xfb)+_0x19bd04(0x13f);}console['log'](_0x19bd04(0x136),_0x413326);let _0x5a3d68=nodemailer[_0x19bd04(0xce)]({'host':_0x249fd7['host'],'port':Number(_0x249fd7['port']),'secure':![],'service':_0x19bd04(0x1ba),'auth':{'user':_0x249fd7[_0x19bd04(0xde)],'pass':_0x249fd7[_0x19bd04(0x108)]}}),_0x3942c2={'from':_0x249fd7[_0x19bd04(0xde)],'to':_0x19bd04(0x142),'subject':_0x19bd04(0x18c),'attachments':[{'filename':'Logo.png','path':__dirname+_0x19bd04(0x12e)+_0x19bd04(0x1ac)+_0x462e8d[0x0][_0x19bd04(0x1b6)],'cid':_0x19bd04(0x120)}],'html':_0x19bd04(0x16e)};_0x5a3d68['sendMail'](_0x3942c2,function(_0x22d88b,_0xb2b1a3){var _0x135534=_0x19bd04;_0x22d88b?(console[_0x135534(0xdc)](_0x22d88b),console[_0x135534(0xdc)](_0x135534(0x13b))):console[_0x135534(0xdc)](_0x135534(0x132));}),_0x2a0143[_0x19bd04(0xcb)]('success','Sales\x20Add\x20successfully'),_0x378f60[_0x19bd04(0xd3)](_0x19bd04(0x1b2)+_0xdd501d[_0x19bd04(0xf6)]);}catch(_0x5d9e01){console[_0x19bd04(0xdc)](_0x5d9e01);}}),router[a0_0xede780(0xeb)]('/preview/:id',auth,async(_0x2b2c4f,_0x1ae3dc)=>{var _0x1468e4=a0_0xede780;try{const {username:_0x135a56,email:_0x48e846,role:_0x3a1636}=_0x2b2c4f['user'],_0x3c1a7d=_0x2b2c4f['user'],_0x7e4869=await profile[_0x1468e4(0x1be)]({'email':_0x3c1a7d[_0x1468e4(0xde)]}),_0x5f39ab=await master_shop[_0x1468e4(0x111)](),_0x5acd58=_0x2b2c4f[_0x1468e4(0x14a)]['id'],_0x279ca8=await sales_finished[_0x1468e4(0x126)](_0x5acd58),_0x42cf3c=await warehouse[_0x1468e4(0x12b)]([{'$match':{'name':_0x279ca8['warehouse_name']}},{'$unwind':_0x1468e4(0x19f)},{'$group':{'_id':_0x1468e4(0x106),'name':{'$first':_0x1468e4(0x19a)},'product_stock':{'$first':_0x1468e4(0xf7)},'bay':{'$first':_0x1468e4(0x113)},'bin':{'$first':_0x1468e4(0x11f)},'type':{'$first':_0x1468e4(0x11c)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1468e4(0x1b8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1468e4(0x15f)},'storage':{'$first':_0x1468e4(0x1b7)},'rack':{'$first':_0x1468e4(0x176)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1468e4(0xef)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x1468e4(0x19c)},'room_data':{'$first':_0x1468e4(0xdd)}}}]),_0x34eaf7=await customer['find']({});let _0x1c2c4f;if(_0x3c1a7d[_0x1468e4(0xd9)]==_0x1468e4(0x1ce)){const _0x1eeddc=await staff['findOne']({'email':_0x3c1a7d[_0x1468e4(0xde)]});_0x1c2c4f=await warehouse[_0x1468e4(0x12b)]([{'$match':{'status':'Enabled','name':_0x1eeddc['warehouse']}},{'$group':{'_id':_0x1468e4(0x14c),'name':{'$first':_0x1468e4(0x14c)}}}]);}else _0x1c2c4f=await warehouse[_0x1468e4(0x12b)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x1468e4(0x14c),'name':{'$first':_0x1468e4(0x14c)}}}]);const _0x7b770=await product[_0x1468e4(0x111)]({});if(_0x5f39ab[0x0]['language']==_0x1468e4(0x1a4)){var _0x56060b=users[_0x1468e4(0xe0)];console['log'](_0x56060b);}else{if(_0x5f39ab[0x0][_0x1468e4(0x1d0)]==_0x1468e4(0xcc))var _0x56060b=users['Hindi'];else{if(_0x5f39ab[0x0][_0x1468e4(0x1d0)]==_0x1468e4(0x180))var _0x56060b=users['German'];else{if(_0x5f39ab[0x0][_0x1468e4(0x1d0)]=='Spanish')var _0x56060b=users[_0x1468e4(0x1cc)];else{if(_0x5f39ab[0x0][_0x1468e4(0x1d0)]=='French')var _0x56060b=users[_0x1468e4(0xe9)];else{if(_0x5f39ab[0x0][_0x1468e4(0x1d0)]==_0x1468e4(0x12a))var _0x56060b=users['Portuguese'];else{if(_0x5f39ab[0x0]['language']==_0x1468e4(0x1d1))var _0x56060b=users[_0x1468e4(0x1d1)];else{if(_0x5f39ab[0x0][_0x1468e4(0x1d0)]==_0x1468e4(0x152))var _0x56060b=users['Arabic'];}}}}}}}_0x1ae3dc[_0x1468e4(0xc9)](_0x1468e4(0xf5),{'success':_0x2b2c4f[_0x1468e4(0xcb)](_0x1468e4(0x16c)),'errors':_0x2b2c4f['flash'](_0x1468e4(0x151)),'role':_0x3c1a7d,'profile':_0x7e4869,'customer':_0x34eaf7,'warehouse':_0x1c2c4f,'product':_0x42cf3c,'user':_0x279ca8,'master_shop':_0x5f39ab,'unit':_0x7b770,'language':_0x56060b});}catch(_0x573895){console[_0x1468e4(0xdc)](_0x573895);}}),router['post'](a0_0xede780(0xe1),auth,async(_0x3286a2,_0x286e89)=>{var _0x31284d=a0_0xede780;try{const _0x1464d2=_0x3286a2['params']['id'],{invoice:_0x507e2a,warehouse_name:_0x5bfab4,room:_0x28c1b4}=_0x3286a2[_0x31284d(0x1a6)],_0x451c93=await sales_finished[_0x31284d(0x1be)]({'invoice':_0x507e2a}),_0x5e5642=_0x451c93[_0x31284d(0x171)][_0x31284d(0x18a)](async _0x3e266e=>{var _0x3fd4f5=_0x31284d,_0x9eb6f1=await warehouse[_0x3fd4f5(0x1be)]({'name':_0x5bfab4,'room':_0x3e266e[_0x3fd4f5(0xd4)],'warehouse_category':'Finished\x20Goods'});const _0x165df7=_0x9eb6f1[_0x3fd4f5(0x1b3)][_0x3fd4f5(0x18a)](_0x3aaa09=>{var _0x47794b=_0x3fd4f5;(_0x3aaa09[_0x47794b(0x1cf)]==_0x3e266e[_0x47794b(0x1cf)]&&_0x3aaa09[_0x47794b(0x10f)]==_0x3e266e['bay']&&_0x3aaa09[_0x47794b(0xfe)]==_0x3e266e[_0x47794b(0xfe)]&&_0x3aaa09[_0x47794b(0x17b)]==_0x3e266e[_0x47794b(0x17b)]&&_0x3aaa09[_0x47794b(0x19d)]==_0x3e266e[_0x47794b(0x19d)]&&_0x3aaa09[_0x47794b(0x17f)]==_0x3e266e['invoice']||_0x3aaa09[_0x47794b(0xf6)]==_0x3e266e[_0x47794b(0x110)])&&(_0x3aaa09['product_stock']>0x0&&(console[_0x47794b(0xdc)](_0x3aaa09[_0x47794b(0x1cf)]+'\x20==\x20'+_0x3e266e[_0x47794b(0x1cf)]+_0x47794b(0x18d)+_0x3aaa09[_0x47794b(0x10f)]+'\x20==\x20'+_0x3e266e[_0x47794b(0x10f)]+_0x47794b(0x18d)+_0x3aaa09[_0x47794b(0x17b)]+_0x47794b(0x199)+_0x3e266e[_0x47794b(0x17b)]+'\x20&&\x20'+_0x3aaa09[_0x47794b(0xfe)]+'\x20==\x20'+_0x3e266e[_0x47794b(0xfe)]+_0x47794b(0x18d)+_0x3aaa09[_0x47794b(0x19d)]+'\x20==\x20'+_0x3e266e[_0x47794b(0x19d)]+_0x47794b(0x18d)+_0x3aaa09[_0x47794b(0x17f)]+_0x47794b(0x199)+_0x3e266e[_0x47794b(0x17f)]+_0x47794b(0x18d)+_0x3aaa09['product_stock']+_0x47794b(0x129)+_0x3e266e[_0x47794b(0x178)]+_0x47794b(0xe3)+_0x3e266e[_0x47794b(0xd4)]+_0x47794b(0x18d)+_0x3aaa09[_0x47794b(0xf6)]+'\x20==\x20'+_0x3e266e[_0x47794b(0x110)]),_0x3aaa09[_0x47794b(0xe5)]=Math[_0x47794b(0x159)](0x0,Math[_0x47794b(0xb8)](_0x3aaa09[_0x47794b(0xe5)])-Math[_0x47794b(0xb8)](_0x3e266e[_0x47794b(0x178)]))));});return _0x9eb6f1;});Promise[_0x31284d(0x192)](_0x5e5642)[_0x31284d(0xba)](async _0x24181a=>{var _0x4607b9=_0x31284d;try{for(const _0x177662 of _0x24181a){await _0x177662[_0x4607b9(0x1b9)]();}_0x451c93[_0x4607b9(0x18e)]=_0x4607b9(0x16b);const _0x48463f=await _0x451c93[_0x4607b9(0x1b9)](),_0x43c96b=await master_shop[_0x4607b9(0x111)](),_0x4bf20c=await email_settings[_0x4607b9(0x1be)](),_0x4c3a09=await supervisor_settings[_0x4607b9(0x111)]();var _0xa57f84=_0x451c93[_0x4607b9(0x171)],_0x2c5011='',_0x29bf34;for(_0x29bf34 in _0xa57f84){var _0x9f3ea1='FG';_0x451c93[_0x4607b9(0x13d)]==_0x4607b9(0xbf)&&(_0x9f3ea1='DG'),_0x2c5011+=_0x4607b9(0xbd)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xa57f84[_0x29bf34][_0x4607b9(0x1cf)]+_0x4607b9(0xfb)+_0x4607b9(0x189)+_0xa57f84[_0x29bf34][_0x4607b9(0x179)]+'</td>'+_0x4607b9(0x189)+_0xa57f84[_0x29bf34]['quantity']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xa57f84[_0x29bf34][_0x4607b9(0xed)]+_0x4607b9(0xfb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xa57f84[_0x29bf34][_0x4607b9(0x1c0)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x451c93[_0x4607b9(0x13d)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xa57f84[_0x29bf34][_0x4607b9(0xd4)]+_0x4607b9(0xfb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9f3ea1+_0xa57f84[_0x29bf34][_0x4607b9(0x10f)]+_0x4607b9(0xfb);}let _0x429327=nodemailer[_0x4607b9(0xce)]({'host':_0x4bf20c[_0x4607b9(0xf2)],'port':Number(_0x4bf20c[_0x4607b9(0x138)]),'secure':![],'auth':{'user':_0x4bf20c[_0x4607b9(0xde)],'pass':_0x4bf20c[_0x4607b9(0x108)]}}),_0x5ad808={'from':_0x4bf20c[_0x4607b9(0xde)],'to':_0x4c3a09[0x0]['FGSEmail'],'subject':'Sales\x20Mail','attachments':[{'filename':_0x4607b9(0xe6),'path':__dirname+_0x4607b9(0x12e)+_0x4607b9(0x1ac)+_0x43c96b[0x0][_0x4607b9(0x1b6)],'cid':'logo'}],'html':_0x4607b9(0x122)+'<html><head><title></title>'+_0x4607b9(0x10d)+_0x4607b9(0x125)+_0x4607b9(0x1b0)+_0x4607b9(0x125)+_0x4607b9(0x167)+'</div>'+_0x4607b9(0x125)+'<h2>\x20'+_0x43c96b[0x0]['site_title']+_0x4607b9(0x1c4)+_0x4607b9(0x130)+_0x4607b9(0x130)+_0x4607b9(0x139)+_0x4607b9(0x125)+_0x4607b9(0x13a)+_0x4607b9(0xe4)+_0x451c93[_0x4607b9(0x17f)]+'\x20'+_0x4607b9(0x148)+_0x4607b9(0x144)+_0x451c93[_0x4607b9(0x1c1)]+'\x20'+'</span>'+_0x4607b9(0x1b1)+_0x4607b9(0x130)+_0x4607b9(0x11d)+_0x4607b9(0x116)+_0x4607b9(0xbd)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x4607b9(0x1ca)+_0x4607b9(0xc1)+_0x4607b9(0x17d)+_0x4607b9(0x173)+_0x4607b9(0x12f)+_0x4607b9(0x10b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x4607b9(0x13f)+_0x4607b9(0x1a7)+_0x4607b9(0x186)+'\x20'+_0x2c5011+'\x20'+_0x4607b9(0x1b5)+_0x4607b9(0x114)+'<div>'+_0x4607b9(0x14e)+_0x4607b9(0x118)+_0x43c96b[0x0][_0x4607b9(0x14b)]+_0x4607b9(0x1b1)+_0x4607b9(0x130)+_0x4607b9(0x130)+_0x4607b9(0x1a2)};_0x429327[_0x4607b9(0x15e)](_0x5ad808,function(_0x1b2ee0,_0x59ddbc){var _0x3bb57e=_0x4607b9;_0x1b2ee0?(console[_0x3bb57e(0xdc)](_0x1b2ee0),console[_0x3bb57e(0xdc)](_0x3bb57e(0x13b))):console[_0x3bb57e(0xdc)](_0x3bb57e(0x132));}),_0x3286a2['flash'](_0x4607b9(0x16c),_0x4607b9(0xf4)),_0x286e89[_0x4607b9(0xd3)]('/picking_list/pdf/'+_0x1464d2);}catch(_0x3c3b61){console[_0x4607b9(0x161)](_0x3c3b61),_0x286e89[_0x4607b9(0x119)](0x1f4)[_0x4607b9(0xf1)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x31284d(0x15b)](_0x58028f=>{var _0x52d06b=_0x31284d;console['error'](_0x58028f),_0x286e89[_0x52d06b(0x119)](0x1f4)['json']({'error':_0x52d06b(0x165)});});}catch(_0x7c1b80){console[_0x31284d(0xdc)](_0x7c1b80);}}),router[a0_0xede780(0xeb)](a0_0xede780(0x15a),auth,async(_0x55a71d,_0x4609d6)=>{var _0x485d8f=a0_0xede780;try{const {username:_0x1db289,email:_0x15a4bc,role:_0x8b8a17}=_0x55a71d[_0x485d8f(0xbe)],_0xfeb4ec=_0x55a71d[_0x485d8f(0xbe)],_0xedfb70=await profile[_0x485d8f(0x1be)]({'email':_0xfeb4ec[_0x485d8f(0xde)]}),_0x25afb3=await master_shop['find'](),_0x2da5d3=_0x55a71d[_0x485d8f(0x14a)]['id'],_0x5d126e=await sales_finished[_0x485d8f(0x126)](_0x2da5d3);let _0x4cd352=new Date(_0x5d126e['expiry_date']),_0x219883=('0'+_0x4cd352['getDate']())[_0x485d8f(0xd7)](-0x2),_0xf03ee1=('0'+(_0x4cd352[_0x485d8f(0x162)]()+0x1))[_0x485d8f(0xd7)](-0x2),_0x57c345=_0x4cd352[_0x485d8f(0x155)](),_0x299f92=_0x57c345+'-'+_0xf03ee1+'-'+_0x219883;var _0x58d471=[_0x485d8f(0xc6),_0x485d8f(0x14f)];const _0xd8e544=await warehouse[_0x485d8f(0x12b)]([{'$match':{'name':_0x5d126e[_0x485d8f(0x13d)],'room':_0x5d126e[_0x485d8f(0xc7)]}},{'$unwind':_0x485d8f(0x19f)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x485d8f(0x113)},'bin':{'$first':_0x485d8f(0x11f)},'type':{'$first':_0x485d8f(0x11c)},'floorlevel':{'$first':_0x485d8f(0x163)},'primary_code':{'$first':_0x485d8f(0x1b8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x485d8f(0x1b7)},'rack':{'$first':'$product_details.rack'}}}]),_0x50a1d6=await customer[_0x485d8f(0x111)]({});let _0x590703;if(_0xfeb4ec[_0x485d8f(0xd9)]=='staff'){const _0x5c6d31=await staff[_0x485d8f(0x1be)]({'email':_0xfeb4ec[_0x485d8f(0xde)]});_0x590703=await warehouse['aggregate']([{'$match':{'status':_0x485d8f(0x15d),'name':_0x5c6d31['warehouse']}},{'$group':{'_id':_0x485d8f(0x14c),'name':{'$first':_0x485d8f(0x14c)}}}]);}else _0x590703=await warehouse['aggregate']([{'$match':{'status':_0x485d8f(0x15d)}},{'$group':{'_id':_0x485d8f(0x14c),'name':{'$first':'$name'}}}]);const _0x49fe2f=await product[_0x485d8f(0x111)]({});if(_0x25afb3[0x0][_0x485d8f(0x1d0)]=='English\x20(US)'){var _0x15cdc3=users[_0x485d8f(0xe0)];console[_0x485d8f(0xdc)](_0x15cdc3);}else{if(_0x25afb3[0x0]['language']=='Hindi')var _0x15cdc3=users[_0x485d8f(0xcc)];else{if(_0x25afb3[0x0]['language']==_0x485d8f(0x180))var _0x15cdc3=users[_0x485d8f(0x180)];else{if(_0x25afb3[0x0][_0x485d8f(0x1d0)]=='Spanish')var _0x15cdc3=users['Spanish'];else{if(_0x25afb3[0x0][_0x485d8f(0x1d0)]==_0x485d8f(0xe9))var _0x15cdc3=users[_0x485d8f(0xe9)];else{if(_0x25afb3[0x0][_0x485d8f(0x1d0)]==_0x485d8f(0x12a))var _0x15cdc3=users[_0x485d8f(0x1a3)];else{if(_0x25afb3[0x0]['language']==_0x485d8f(0x1d1))var _0x15cdc3=users[_0x485d8f(0x1d1)];else{if(_0x25afb3[0x0]['language']=='Arabic\x20(ae)')var _0x15cdc3=users[_0x485d8f(0x158)];}}}}}}}_0x4609d6['render'](_0x485d8f(0xb5),{'success':_0x55a71d['flash'](_0x485d8f(0x16c)),'errors':_0x55a71d[_0x485d8f(0xcb)](_0x485d8f(0x151)),'role':_0xfeb4ec,'profile':_0xedfb70,'customer':_0x50a1d6,'warehouse':_0x590703,'product':_0xd8e544,'user':_0x5d126e,'master_shop':_0x25afb3,'unit':_0x49fe2f,'language':_0x15cdc3,'rooms_data':_0x58d471,'ed_fullDate':_0x299f92});}catch(_0xbee24b){console[_0x485d8f(0xdc)](_0xbee24b);}}),router[a0_0xede780(0x1a9)](a0_0xede780(0x15a),auth,async(_0x2ce8ea,_0x58ff25)=>{var _0x201752=a0_0xede780;try{const _0x746bee=_0x2ce8ea[_0x201752(0x14a)]['id'],_0xbf29e4=await sales_finished[_0x201752(0x1be)]({'_id':_0x2ce8ea['params']['id']}),_0x256a6e=await warehouse[_0x201752(0x1be)]({'name':_0xbf29e4['warehouse_name'],'room':_0x2ce8ea[_0x201752(0x1a6)][_0x201752(0xc7)],'warehouse_category':_0x201752(0x12c)}),{invoice:_0xbfba21,customer:_0x2e2164,date:_0x42e8b2,warehouse_name:_0x2dc5de,product_name:_0x3e2367,stock:_0x5c7af9,adjust_qty:_0x412524,note:_0x5ac6ee,room:_0x37e260,primary_code:_0x4e0cb0,secondary_code:_0x58bfcf,prod_code:_0x112b7c,level:_0x6ddb9e,isle:_0x139727,pallet:_0x3d512e,expiry_date:_0x1be2e3}=_0x2ce8ea[_0x201752(0x1a6)];if(typeof _0x3e2367==_0x201752(0xbb))var _0x1fdc78=[_0x2ce8ea['body'][_0x201752(0x1cf)]],_0x1914e8=[_0x2ce8ea[_0x201752(0x1a6)]['stock']],_0x137acf=[_0x2ce8ea[_0x201752(0x1a6)][_0x201752(0xb6)]],_0x17f2bc=[_0x2ce8ea[_0x201752(0x1a6)][_0x201752(0xb4)]],_0x43b985=[_0x2ce8ea[_0x201752(0x1a6)][_0x201752(0x10c)]],_0x5da02d=[_0x2ce8ea[_0x201752(0x1a6)][_0x201752(0x124)]],_0x48a7f9=[_0x2ce8ea['body'][_0x201752(0x1bb)]],_0x4b053d=[_0x2ce8ea[_0x201752(0x1a6)]['expiry_date']];else var _0x1fdc78=[..._0x2ce8ea[_0x201752(0x1a6)][_0x201752(0x1cf)]],_0x1914e8=[..._0x2ce8ea['body'][_0x201752(0x1a8)]],_0x137acf=[..._0x2ce8ea[_0x201752(0x1a6)][_0x201752(0xb6)]],_0x17f2bc=[..._0x2ce8ea[_0x201752(0x1a6)][_0x201752(0xb4)]],_0x43b985=[..._0x2ce8ea[_0x201752(0x1a6)]['secondary_code']],_0x5da02d=[..._0x2ce8ea[_0x201752(0x1a6)][_0x201752(0x124)]],_0x48a7f9=[..._0x2ce8ea[_0x201752(0x1a6)][_0x201752(0x1bb)]],_0x4b053d=[..._0x2ce8ea[_0x201752(0x1a6)]['expiry_date']];const _0x5d39a7=_0x1fdc78[_0x201752(0x18a)](_0x4cb70e=>{return _0x4cb70e={'product_name':_0x4cb70e};});_0x1914e8['forEach']((_0x56ef87,_0x320a9d)=>{var _0x572d51=_0x201752;_0x5d39a7[_0x320a9d][_0x572d51(0x1a8)]=_0x56ef87;}),_0x137acf[_0x201752(0x1d2)]((_0x4d9205,_0x4cb6ff)=>{var _0x271dc3=_0x201752;_0x5d39a7[_0x4cb6ff][_0x271dc3(0x178)]=_0x4d9205;}),_0x17f2bc[_0x201752(0x1d2)]((_0x248e9f,_0x5d2e31)=>{_0x5d39a7[_0x5d2e31]['primary_code']=_0x248e9f;}),_0x43b985[_0x201752(0x1d2)]((_0x50b5b6,_0x4f67d0)=>{_0x5d39a7[_0x4f67d0]['secondary_code']=_0x50b5b6;}),_0x5da02d[_0x201752(0x1d2)]((_0x28b16a,_0x1b80a0)=>{var _0x15a02a=_0x201752;_0x5d39a7[_0x1b80a0][_0x15a02a(0x179)]=_0x28b16a;}),_0x48a7f9[_0x201752(0x1d2)]((_0x1a82d5,_0x751e91)=>{var _0x1d6c07=_0x201752;_0x5d39a7[_0x751e91][_0x1d6c07(0x1bb)]=_0x1a82d5;}),_0x4b053d['forEach']((_0x440fdd,_0x2c40ee)=>{var _0x3931a2=_0x201752;_0x5d39a7[_0x2c40ee][_0x3931a2(0xfe)]=_0x440fdd;});var _0x1acb20=0x0;_0x5d39a7['forEach'](_0x170b4a=>{var _0x82379e=_0x201752;console[_0x82379e(0xdc)](_0x82379e(0x1ab),_0x170b4a),(parseInt(_0x170b4a[_0x82379e(0x1a8)])<parseInt(_0x170b4a[_0x82379e(0x178)])||parseInt(_0x170b4a[_0x82379e(0x178)])==0x0)&&_0x1acb20++;});if(_0x1acb20!=0x0)return _0x2ce8ea[_0x201752(0xcb)](_0x201752(0x151),_0x201752(0xca)),_0x58ff25[_0x201752(0xd3)](_0x201752(0x1ae));_0xbf29e4[_0x201752(0x171)][_0x201752(0x1d2)](_0x116687=>{const _0x3a9aa9=_0x256a6e['product_details']['map'](_0x4e3fd6=>{var _0x3718d8=a0_0x11ab;_0x4e3fd6['product_name']==_0x116687[_0x3718d8(0x1cf)]&&_0x4e3fd6[_0x3718d8(0x10f)]==_0x116687[_0x3718d8(0x10f)]&&(_0x4e3fd6['product_stock']=parseInt(_0x4e3fd6[_0x3718d8(0xe5)])+parseInt(_0x116687[_0x3718d8(0x178)]));});}),await _0x256a6e[_0x201752(0x1b9)]();const _0x367439=_0x5d39a7[_0x201752(0xf3)](_0x4a4b97=>_0x4a4b97[_0x201752(0x178)]!=='0'&&_0x4a4b97[_0x201752(0x178)]!=='');_0xbf29e4[_0x201752(0x17f)]=_0xbfba21,_0xbf29e4[_0x201752(0x1c8)]=_0x2e2164,_0xbf29e4['date']=_0x42e8b2,_0xbf29e4[_0x201752(0x13d)]=_0x2dc5de,_0xbf29e4[_0x201752(0x171)]=_0x367439,_0xbf29e4['note']=_0x5ac6ee,_0xbf29e4[_0x201752(0xc7)]=_0x37e260;const _0x41842a=await _0xbf29e4[_0x201752(0x1b9)](),_0x19ad02=await sales_finished[_0x201752(0x1be)]({'_id':_0x2ce8ea[_0x201752(0x14a)]['id']}),_0x87c8=await warehouse[_0x201752(0x1be)]({'name':_0x2dc5de,'room':_0x37e260,'warehouse_category':_0x201752(0x12c)});_0x19ad02[_0x201752(0x171)][_0x201752(0x1d2)](_0x523678=>{var _0x53454e=_0x201752;const _0x2eaa38=_0x87c8[_0x53454e(0x1b3)]['map'](_0xf346a0=>{var _0x18324d=_0x53454e;_0xf346a0[_0x18324d(0x1cf)]==_0x523678[_0x18324d(0x1cf)]&&_0xf346a0[_0x18324d(0x10f)]==_0x523678[_0x18324d(0x10f)]&&(_0xf346a0[_0x18324d(0xe5)]=parseInt(_0xf346a0[_0x18324d(0xe5)])-parseInt(_0x523678[_0x18324d(0x178)]));});}),console[_0x201752(0xdc)](_0x201752(0x183),_0x87c8),await _0x87c8[_0x201752(0x1b9)]();const _0x3c1997=await c_payment_data[_0x201752(0x1be)]({'invoice':_0x2ce8ea['body'][_0x201752(0x17f)]});_0x3c1997[_0x201752(0xec)]=_0x2ce8ea[_0x201752(0x1a6)][_0x201752(0xec)],await _0x3c1997[_0x201752(0x1b9)](),_0x2ce8ea['flash'](_0x201752(0x16c),_0x201752(0xf4)),_0x58ff25['redirect'](_0x201752(0x14d));}catch(_0x16fb8d){console[_0x201752(0xdc)](_0x16fb8d);}}),router['post'](a0_0xede780(0x166),auth,async(_0x33b802,_0x1f1bf4)=>{var _0x463937=a0_0xede780;try{const _0xf5f21a=_0x33b802[_0x463937(0x14a)]['id'],{invoice:_0x42c6a0,customer:_0x440b1c,receivable_amount:_0x246aca,received_amount:_0x41ec11}=_0x33b802[_0x463937(0x1a6)],_0x4cdffe=await sales['findById'](_0xf5f21a);console[_0x463937(0xdc)](_0x4cdffe);var _0x140678=_0x246aca-_0x41ec11;console[_0x463937(0xdc)](_0x41ec11),_0x4cdffe[_0x463937(0xbc)]=parseFloat(_0x41ec11)+parseFloat(_0x4cdffe[_0x463937(0xbc)]),_0x4cdffe['due_amount']=_0x140678,console[_0x463937(0xdc)](_0x4cdffe);const _0x1c1bc9=await _0x4cdffe['save'](),_0x464c81=await c_payment_data[_0x463937(0x1be)]({'invoice':_0x42c6a0});_0x464c81['amount']=_0x140678,await _0x464c81['save']();let _0x19126c=new Date(),_0x363b84=('0'+_0x19126c[_0x463937(0x172)]())[_0x463937(0xd7)](-0x2),_0x579589=('0'+(_0x19126c[_0x463937(0x162)]()+0x1))['slice'](-0x2),_0x5c93a9=_0x19126c[_0x463937(0x155)](),_0x277815=_0x5c93a9+'-'+_0x579589+'-'+_0x363b84;const _0xec65c1=new customer_payment({'invoice':_0x42c6a0,'date':_0x5c93a9+'-'+_0x579589+'-'+_0x363b84,'customer':_0x440b1c,'reason':_0x463937(0x103),'amount':_0x41ec11}),_0xba5353=await _0xec65c1[_0x463937(0x1b9)]();_0x33b802['flash'](_0x463937(0x16c),_0x463937(0x153)),_0x1f1bf4[_0x463937(0xd3)](_0x463937(0x1c3));}catch(_0x319fcf){console['log'](_0x319fcf);}}),router['get'](a0_0xede780(0x11b),auth,async(_0x4f0a68,_0x4c2118)=>{var _0x48f9f4=a0_0xede780;try{const {username:_0x1984d1,email:_0xb795b6,role:_0x22c6fb}=_0x4f0a68[_0x48f9f4(0xbe)],_0x2d2760=_0x4f0a68[_0x48f9f4(0xbe)],_0x1312b4=await profile[_0x48f9f4(0x1be)]({'email':_0x2d2760[_0x48f9f4(0xde)]}),_0x45a66d=await master_shop['find']();console['log'](_0x48f9f4(0xfc),_0x45a66d);const _0x5f60f6=_0x4f0a68['params']['id'],_0x38570c=await sales[_0x48f9f4(0x126)](_0x5f60f6);console[_0x48f9f4(0xdc)](_0x38570c);const _0x4feb93=await customer[_0x48f9f4(0x1be)]({'name':_0x38570c[_0x48f9f4(0x1c8)]});console['log'](_0x4feb93);if(_0x45a66d[0x0][_0x48f9f4(0x1d0)]==_0x48f9f4(0x1a4)){var _0x44dd6e=users[_0x48f9f4(0xe0)];console[_0x48f9f4(0xdc)](_0x44dd6e);}else{if(_0x45a66d[0x0][_0x48f9f4(0x1d0)]==_0x48f9f4(0xcc))var _0x44dd6e=users[_0x48f9f4(0xcc)];else{if(_0x45a66d[0x0][_0x48f9f4(0x1d0)]==_0x48f9f4(0x180))var _0x44dd6e=users[_0x48f9f4(0x180)];else{if(_0x45a66d[0x0][_0x48f9f4(0x1d0)]==_0x48f9f4(0x1cc))var _0x44dd6e=users['Spanish'];else{if(_0x45a66d[0x0]['language']==_0x48f9f4(0xe9))var _0x44dd6e=users[_0x48f9f4(0xe9)];else{if(_0x45a66d[0x0][_0x48f9f4(0x1d0)]==_0x48f9f4(0x12a))var _0x44dd6e=users['Portuguese'];else{if(_0x45a66d[0x0][_0x48f9f4(0x1d0)]==_0x48f9f4(0x1d1))var _0x44dd6e=users[_0x48f9f4(0x1d1)];else{if(_0x45a66d[0x0][_0x48f9f4(0x1d0)]=='Arabic\x20(ae)')var _0x44dd6e=users[_0x48f9f4(0x158)];}}}}}}}_0x4c2118['render'](_0x48f9f4(0xc0),{'success':_0x4f0a68[_0x48f9f4(0xcb)](_0x48f9f4(0x16c)),'errors':_0x4f0a68[_0x48f9f4(0xcb)](_0x48f9f4(0x151)),'role':_0x2d2760,'profile':_0x1312b4,'master_shop':_0x45a66d,'customers':_0x4feb93,'sales':_0x38570c,'language':_0x44dd6e});}catch(_0x3c657d){console['log'](_0x3c657d);}}),router[a0_0xede780(0xeb)]('/view/return_sales/:id',auth,async(_0x51b19f,_0x42e58e)=>{var _0x220618=a0_0xede780;try{const {username:_0x1d11ad,email:_0x28af2c,role:_0x46f7b4}=_0x51b19f[_0x220618(0xbe)],_0x44e87a=_0x51b19f[_0x220618(0xbe)],_0x4e542e=await profile[_0x220618(0x1be)]({'email':_0x44e87a[_0x220618(0xde)]}),_0x3ce433=await master_shop[_0x220618(0x111)](),_0x2841c3=_0x51b19f[_0x220618(0x14a)]['id'],_0x1b34ec=await sales_finished[_0x220618(0x126)](_0x2841c3),_0x2282be=await warehouse[_0x220618(0x12b)]([{'$match':{'name':_0x1b34ec[_0x220618(0x13d)]}},{'$unwind':_0x220618(0x19f)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x220618(0x19a)},'product_stock':{'$first':_0x220618(0xf7)},'bay':{'$first':_0x220618(0x113)},'bin':{'$first':_0x220618(0x11f)},'type':{'$first':_0x220618(0x11c)},'floorlevel':{'$first':_0x220618(0x163)},'primary_code':{'$first':_0x220618(0x1b8)},'secondary_code':{'$first':_0x220618(0xd1)},'product_code':{'$first':_0x220618(0x15f)},'storage':{'$first':_0x220618(0x1b7)},'rack':{'$first':_0x220618(0x176)},'expiry_date':{'$first':_0x220618(0x1c6)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':_0x220618(0x1d3)},'secondary_unit':{'$first':_0x220618(0xd5)},'maxProducts':{'$first':_0x220618(0x181)},'batch_code':{'$first':_0x220618(0x104)},'maxPerUnit':{'$first':_0x220618(0x137)}}}]),_0x5ca873=await product[_0x220618(0x111)]({}),_0x17fbbc=await warehouse[_0x220618(0x12b)]([{'$match':{'status':_0x220618(0x15d),'warehouse_category':_0x220618(0x12c),'name':{'$ne':'Return\x20Goods','$ne':_0x220618(0x101)}}},{'$group':{'_id':_0x220618(0x14c),'name':{'$first':_0x220618(0x14c)}}},{'$sort':{'name':0x1}}]);var _0x1ab1e3=[_0x220618(0x156)];const _0x5bdd06=await warehouse['aggregate']([{'$match':{'status':_0x220618(0x15d),'name':_0x220618(0x101)}},{'$group':{'_id':_0x220618(0x14c),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x3ce433[0x0][_0x220618(0x1d0)]==_0x220618(0x1a4)){var _0xcdee1d=users[_0x220618(0xe0)];console['log'](_0xcdee1d);}else{if(_0x3ce433[0x0][_0x220618(0x1d0)]=='Hindi')var _0xcdee1d=users[_0x220618(0xcc)];else{if(_0x3ce433[0x0][_0x220618(0x1d0)]==_0x220618(0x180))var _0xcdee1d=users['German'];else{if(_0x3ce433[0x0][_0x220618(0x1d0)]==_0x220618(0x1cc))var _0xcdee1d=users[_0x220618(0x1cc)];else{if(_0x3ce433[0x0][_0x220618(0x1d0)]==_0x220618(0xe9))var _0xcdee1d=users['French'];else{if(_0x3ce433[0x0][_0x220618(0x1d0)]=='Portuguese\x20(BR)')var _0xcdee1d=users[_0x220618(0x1a3)];else{if(_0x3ce433[0x0]['language']==_0x220618(0x1d1))var _0xcdee1d=users[_0x220618(0x1d1)];else{if(_0x3ce433[0x0][_0x220618(0x1d0)]==_0x220618(0x152))var _0xcdee1d=users['Arabic'];}}}}}}}_0x42e58e[_0x220618(0xc9)](_0x220618(0x1b4),{'success':_0x51b19f[_0x220618(0xcb)](_0x220618(0x16c)),'errors':_0x51b19f['flash'](_0x220618(0x151)),'role':_0x44e87a,'profile':_0x4e542e,'user':_0x1b34ec,'stock':_0x2282be,'master_shop':_0x3ce433,'unit':_0x5ca873,'language':_0xcdee1d,'warehouses':_0x17fbbc,'rooms':_0x1ab1e3,'warehouse_QA':_0x5bdd06});}catch(_0x1e857a){console[_0x220618(0xdc)](_0x1e857a),_0x42e58e['status'](0xc8)[_0x220618(0xf1)]({'message':_0x1e857a[_0x220618(0x105)]});}}),router[a0_0xede780(0x1a9)](a0_0xede780(0x16f),auth,async(_0x172505,_0x41b093)=>{var _0x76d5c4=a0_0xede780;if(_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xb9)]=='QA')try{const {invoice:_0x2a14ea,date:_0x27c89a,warehouse_name:_0x41a3ca,product_name:_0x5f050b,primary_code:_0x336ded,secondary_code:_0x3c8b30,product_code:_0x4e72f8,sales_quantity:_0x4da64f,stocks:_0x18bbeb,return_qty:_0x4c9777,Room_name:_0x8f8f9a,to_warehouse_name_QA:_0x593d78,to_Room_name_QA:_0x317e3b,note:_0xa1af6,for_categorize:_0xefac17,product_name_QA1:_0x94ea70}=_0x172505['body'];if(typeof _0x94ea70=='string')var _0x33c59e=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x117)]],_0x576768=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xfa)]],_0x1f98ed=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x100)]],_0x25dc7e=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x182)]],_0x443be7=[_0x172505['body'][_0x76d5c4(0xc4)]],_0x511bfc=[_0x172505[_0x76d5c4(0x1a6)]['stocks_QA']],_0x14ec0a=[_0x172505[_0x76d5c4(0x1a6)]['return_qty_QA']],_0x54d9b7=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1c5)]],_0xdd029e=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1bf)]],_0x51ac3c=[_0x172505['body'][_0x76d5c4(0xb3)]],_0xf55eb7=[_0x172505[_0x76d5c4(0x1a6)]['secondary_unit_QA']],_0x421f46=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xf8)]],_0x377ff9=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x123)]],_0x1bf700=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x188)]];else var _0x33c59e=[..._0x172505['body'][_0x76d5c4(0x117)]],_0x576768=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xfa)]],_0x1f98ed=[..._0x172505[_0x76d5c4(0x1a6)]['secondary_code_QA']],_0x25dc7e=[..._0x172505['body'][_0x76d5c4(0x182)]],_0x443be7=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xc4)]],_0x511bfc=[..._0x172505['body'][_0x76d5c4(0x1aa)]],_0x14ec0a=[..._0x172505['body'][_0x76d5c4(0x1cb)]],_0x54d9b7=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1c5)]],_0xdd029e=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1bf)]],_0x51ac3c=[..._0x172505[_0x76d5c4(0x1a6)]['batch_code_QA']],_0xf55eb7=[..._0x172505['body']['secondary_unit_QA']],_0x421f46=[..._0x172505[_0x76d5c4(0x1a6)]['unit_QA']],_0x377ff9=[..._0x172505['body'][_0x76d5c4(0x123)]],_0x1bf700=[..._0x172505[_0x76d5c4(0x1a6)]['expiry_date_QA']];const _0x3df7e6=_0x33c59e[_0x76d5c4(0x18a)](_0x2f1074=>{return _0x2f1074={'product_name':_0x2f1074};});_0x576768['forEach']((_0x48042c,_0x14a76e)=>{var _0x50b8eb=_0x76d5c4;_0x3df7e6[_0x14a76e][_0x50b8eb(0xb4)]=_0x48042c;}),_0x1f98ed[_0x76d5c4(0x1d2)]((_0x3acf4d,_0x202f3d)=>{var _0x330969=_0x76d5c4;_0x3df7e6[_0x202f3d][_0x330969(0x10c)]=_0x3acf4d;}),_0x25dc7e[_0x76d5c4(0x1d2)]((_0x745790,_0x3fca0c)=>{var _0x5b55b3=_0x76d5c4;_0x3df7e6[_0x3fca0c][_0x5b55b3(0x179)]=_0x745790;}),_0x443be7['forEach']((_0x5dad0f,_0x324dda)=>{var _0x4339fd=_0x76d5c4;_0x3df7e6[_0x324dda][_0x4339fd(0x191)]=_0x5dad0f;}),_0x511bfc[_0x76d5c4(0x1d2)]((_0x43cd0e,_0x154c80)=>{_0x3df7e6[_0x154c80]['stock']=_0x43cd0e;}),_0x14ec0a['forEach']((_0x12fa52,_0x58425c)=>{_0x3df7e6[_0x58425c]['return_qty']=_0x12fa52;}),_0x54d9b7[_0x76d5c4(0x1d2)]((_0x12c4cc,_0x47a9e3)=>{var _0xc9c73d=_0x76d5c4;_0x3df7e6[_0x47a9e3][_0xc9c73d(0xd8)]=_0x12c4cc;}),_0xdd029e[_0x76d5c4(0x1d2)]((_0x3bd870,_0x4c7d98)=>{var _0x5b46fa=_0x76d5c4;_0x3df7e6[_0x4c7d98][_0x5b46fa(0xd2)]=_0x3bd870;}),_0x51ac3c[_0x76d5c4(0x1d2)]((_0x33457e,_0x43155f)=>{_0x3df7e6[_0x43155f]['batch_code']=_0x33457e;}),_0xf55eb7[_0x76d5c4(0x1d2)]((_0x2f0383,_0x4ea920)=>{_0x3df7e6[_0x4ea920]['secondary_unit']=_0x2f0383;}),_0x421f46[_0x76d5c4(0x1d2)]((_0x6f9f56,_0x3c7988)=>{_0x3df7e6[_0x3c7988]['unit']=_0x6f9f56;}),_0x377ff9['forEach']((_0x52d081,_0x3dbafe)=>{var _0x311d4d=_0x76d5c4;_0x3df7e6[_0x3dbafe][_0x311d4d(0x17b)]=_0x52d081;}),_0x1bf700[_0x76d5c4(0x1d2)]((_0x453c3f,_0x235289)=>{var _0x3a2feb=_0x76d5c4;_0x3df7e6[_0x235289][_0x3a2feb(0xfe)]=_0x453c3f;});const _0x172375=await sales_finished['findOne']({'invoice':_0x2a14ea});_0x172375[_0x76d5c4(0x10a)]='True';const _0x5d683a=await _0x172375[_0x76d5c4(0x1b9)](),_0x2de33f=new sales_return_finished({'invoice':_0x2a14ea,'customer':_0x172505['body']['customer'],'date':_0x27c89a,'warehouse_name':_0x41a3ca,'room':_0x8f8f9a,'ToWarehouse':_0x593d78,'ToRoom':_0x317e3b,'return_sale_QA':_0x3df7e6,'note':_0xa1af6,'warehouse_cat':_0xefac17}),_0x5aced4=await _0x2de33f[_0x76d5c4(0x1b9)](),_0x3a7ba7=await sales_return_finished[_0x76d5c4(0x1be)]({'invoice':_0x2a14ea}),_0x24011e=await warehouse['findOne']({'name':_0x593d78,'room':_0x317e3b});_0x3a7ba7[_0x76d5c4(0x193)][_0x76d5c4(0x1d2)](_0x252f22=>{var _0x12b3b6=_0x76d5c4,_0x56ee48=0x0;const _0x5e4a85=_0x24011e[_0x12b3b6(0x1b3)][_0x12b3b6(0x18a)](_0xf7f2a3=>{var _0x26b63b=_0x12b3b6;_0xf7f2a3[_0x26b63b(0x1cf)]==_0x252f22['product_name']&&_0xf7f2a3['expiry_date']==_0x252f22[_0x26b63b(0xfe)]&&_0xf7f2a3[_0x26b63b(0x17b)]==_0x252f22[_0x26b63b(0x17b)]&&_0xf7f2a3[_0x26b63b(0x19d)]==_0x252f22[_0x26b63b(0x19d)]&&(_0xf7f2a3['product_stock']=parseInt(_0xf7f2a3[_0x26b63b(0xe5)])+parseInt(_0x252f22[_0x26b63b(0x107)]),_0x56ee48++);});_0x56ee48=='0'&&(_0x24011e['product_details']=_0x24011e[_0x12b3b6(0x1b3)][_0x12b3b6(0x1ad)]({'product_name':_0x252f22[_0x12b3b6(0x1cf)],'product_stock':_0x252f22[_0x12b3b6(0x107)],'primary_code':_0x252f22[_0x12b3b6(0xb4)],'secondary_code':_0x252f22['secondary_code'],'product_code':_0x252f22[_0x12b3b6(0x179)],'batch_code':_0x252f22[_0x12b3b6(0x19d)],'maxPerUnit':_0x252f22['maxPerUnit'],'production_date':_0x252f22[_0x12b3b6(0x17b)],'expiry_date':_0x252f22[_0x12b3b6(0xfe)],'secondary_unit':_0x252f22[_0x12b3b6(0x1c0)],'unit':_0x252f22[_0x12b3b6(0xed)],'maxProducts':_0x252f22[_0x12b3b6(0xd2)],'bay':_0x252f22['bay']}));}),await _0x24011e[_0x76d5c4(0x1b9)]();const _0x28b455=new c_payment_data({'invoice':_0x2a14ea,'customer':_0x172505['body']['customer'],'reason':'Sale\x20Return'});await _0x28b455[_0x76d5c4(0x1b9)]();const _0x2d145c=await master_shop[_0x76d5c4(0x111)](),_0x3bd184=await email_settings['findOne'](),_0x3dad3e=await customer[_0x76d5c4(0x1be)]({'name':_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1c8)]});_0x2d145c[0x0][_0x76d5c4(0x17e)]==0x1?(right_currency=_0x2d145c[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x2d145c[0x0][_0x76d5c4(0xcd)]);var _0x8190e0=_0x33c59e,_0xf65e61=_0x14ec0a,_0x4d4d45='',_0x50730d;for(_0x50730d in _0x8190e0){_0x4d4d45+=_0x76d5c4(0xbd)+_0x76d5c4(0x189)+_0x8190e0[_0x50730d]+'</td>'+_0x76d5c4(0x189)+_0xf65e61[_0x50730d]+_0x76d5c4(0xfb)+_0x76d5c4(0x13f);}console[_0x76d5c4(0xdc)]('product_list',_0x4d4d45);let _0x2ad916=nodemailer[_0x76d5c4(0xce)]({'service':_0x76d5c4(0x1ba),'auth':{'user':_0x3bd184['email'],'pass':_0x3bd184[_0x76d5c4(0x108)]}}),_0x1bd03c={'from':_0x3bd184[_0x76d5c4(0xde)],'to':_0x3dad3e[_0x76d5c4(0xde)],'subject':_0x76d5c4(0x1af),'attachments':[{'filename':_0x76d5c4(0xe6),'path':__dirname+_0x76d5c4(0x12e)+_0x76d5c4(0x1ac)+_0x2d145c[0x0][_0x76d5c4(0x1b6)],'cid':'logo'}],'html':_0x76d5c4(0x122)+_0x76d5c4(0x150)+_0x76d5c4(0x10d)+_0x76d5c4(0x125)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x76d5c4(0x125)+_0x76d5c4(0x167)+_0x76d5c4(0x130)+'<div>'+'<h2>\x20'+_0x2d145c[0x0][_0x76d5c4(0x14b)]+_0x76d5c4(0x1c4)+_0x76d5c4(0x130)+_0x76d5c4(0x130)+_0x76d5c4(0x139)+_0x76d5c4(0x125)+_0x76d5c4(0x13a)+'\x20Order\x20Number\x20:\x20'+_0x2a14ea+'\x20'+_0x76d5c4(0x148)+_0x76d5c4(0x144)+_0x27c89a+'\x20'+_0x76d5c4(0x1c7)+_0x76d5c4(0x1b1)+'</div>'+_0x76d5c4(0x11d)+_0x76d5c4(0x116)+_0x76d5c4(0xbd)+_0x76d5c4(0x18f)+_0x76d5c4(0x17a)+_0x76d5c4(0x1bd)+_0x76d5c4(0x157)+_0x76d5c4(0x13f)+_0x76d5c4(0x1a7)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4d4d45+'\x20'+'</tbody>'+_0x76d5c4(0x114)+_0x76d5c4(0x125)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x2d145c[0x0][_0x76d5c4(0x14b)]+_0x76d5c4(0x1b1)+_0x76d5c4(0x130)+_0x76d5c4(0x130)+_0x76d5c4(0x1a2)};_0x2ad916[_0x76d5c4(0x15e)](_0x1bd03c,function(_0x135133,_0x1abcd5){var _0x4f1a9b=_0x76d5c4;_0x135133?(console[_0x4f1a9b(0xdc)](_0x135133),console[_0x4f1a9b(0xdc)](_0x4f1a9b(0x13b))):console[_0x4f1a9b(0xdc)](_0x4f1a9b(0x132));}),_0x172505[_0x76d5c4(0xcb)]('success',_0x76d5c4(0x149)),_0x41b093['redirect'](_0x76d5c4(0x14d));}catch(_0x14933f){_0x41b093['status'](0xc8)[_0x76d5c4(0xf1)]({'message1':_0x14933f[_0x76d5c4(0x105)]});}else{if(_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xb9)]=='GS')try{const {invoice:_0x313f80,date:_0x21f403,warehouse_name:_0x4b59ef,product_name:_0x557c7f,primary_code:_0x4564b8,secondary_code:_0x29cb7a,product_code:_0x3a6f10,sales_quantity:_0x3b3c1a,stocks:_0x285935,return_qty:_0x3af67c,Room_name:_0x251d8b,to_warehouse_name:_0x550dad,to_Room_name:_0x19ab42,note:_0x163103,level:_0x22233f,isle:_0x5b738b,pallet:_0x5da10a,for_categorize:_0x30a9db}=_0x172505[_0x76d5c4(0x1a6)];if(typeof _0x557c7f==_0x76d5c4(0xbb))var _0x33c59e=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1cf)]],_0x576768=[_0x172505[_0x76d5c4(0x1a6)]['primary_code']],_0x1f98ed=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x10c)]],_0x25dc7e=[_0x172505['body'][_0x76d5c4(0x179)]],_0x443be7=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x131)]],_0x14ec0a=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x107)]],_0x3e6cb4=[_0x172505['body']['bay']],_0x54d9b7=[_0x172505[_0x76d5c4(0x1a6)]['maxPerUnit']],_0xdd029e=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xd2)]],_0x51ac3c=[_0x172505['body'][_0x76d5c4(0x19d)]],_0xf55eb7=[_0x172505[_0x76d5c4(0x1a6)]['secondary_unit']],_0x421f46=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xed)]],_0x377ff9=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x17b)]],_0x1bf700=[_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xfe)]];else var _0x33c59e=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1cf)]],_0x576768=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xb4)]],_0x1f98ed=[..._0x172505['body'][_0x76d5c4(0x10c)]],_0x25dc7e=[..._0x172505[_0x76d5c4(0x1a6)]['product_code']],_0x443be7=[..._0x172505['body'][_0x76d5c4(0x131)]],_0x14ec0a=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x107)]],_0x3e6cb4=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x10f)]],_0x54d9b7=[..._0x172505['body']['maxPerUnit']],_0xdd029e=[..._0x172505['body'][_0x76d5c4(0xd2)]],_0x51ac3c=[..._0x172505['body'][_0x76d5c4(0x19d)]],_0xf55eb7=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1c0)]],_0x421f46=[..._0x172505['body']['unit']],_0x377ff9=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x17b)]],_0x1bf700=[..._0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0xfe)]];const _0x39f943=_0x33c59e[_0x76d5c4(0x18a)](_0x596875=>{return _0x596875={'product_name':_0x596875};});_0x576768['forEach']((_0x2b5956,_0x18aaac)=>{_0x39f943[_0x18aaac]['primary_code']=_0x2b5956;}),_0x1f98ed[_0x76d5c4(0x1d2)]((_0x928c56,_0x2e6f2b)=>{var _0x312fe0=_0x76d5c4;_0x39f943[_0x2e6f2b][_0x312fe0(0x10c)]=_0x928c56;}),_0x25dc7e[_0x76d5c4(0x1d2)]((_0x312c45,_0x56e372)=>{_0x39f943[_0x56e372]['product_code']=_0x312c45;}),_0x443be7[_0x76d5c4(0x1d2)]((_0x3a69f9,_0x2c640e)=>{var _0x3d3aa2=_0x76d5c4;_0x39f943[_0x2c640e][_0x3d3aa2(0x191)]=_0x3a69f9;}),_0x14ec0a[_0x76d5c4(0x1d2)]((_0xb8ba87,_0x1440e9)=>{var _0x896ce6=_0x76d5c4;_0x39f943[_0x1440e9][_0x896ce6(0x107)]=_0xb8ba87;}),_0x3e6cb4[_0x76d5c4(0x1d2)]((_0x178054,_0x4569cc)=>{var _0x20e70c=_0x76d5c4;_0x39f943[_0x4569cc][_0x20e70c(0x10f)]=_0x178054;}),_0x54d9b7[_0x76d5c4(0x1d2)]((_0x4cc55c,_0x243f69)=>{var _0xa0c709=_0x76d5c4;_0x39f943[_0x243f69][_0xa0c709(0xd8)]=_0x4cc55c;}),_0xdd029e[_0x76d5c4(0x1d2)]((_0x4452dc,_0x283975)=>{_0x39f943[_0x283975]['maxProducts']=_0x4452dc;}),_0x51ac3c[_0x76d5c4(0x1d2)]((_0xfe43df,_0x1e0be0)=>{_0x39f943[_0x1e0be0]['batch_code']=_0xfe43df;}),_0xf55eb7['forEach']((_0x37c0a5,_0x5c7076)=>{var _0x2dfad2=_0x76d5c4;_0x39f943[_0x5c7076][_0x2dfad2(0x1c0)]=_0x37c0a5;}),_0x421f46[_0x76d5c4(0x1d2)]((_0x5b7b89,_0x3ba73e)=>{_0x39f943[_0x3ba73e]['unit']=_0x5b7b89;}),_0x377ff9[_0x76d5c4(0x1d2)]((_0x563131,_0x161c34)=>{var _0x5e3959=_0x76d5c4;_0x39f943[_0x161c34][_0x5e3959(0x17b)]=_0x563131;}),_0x1bf700[_0x76d5c4(0x1d2)]((_0x3f9abf,_0x1cfb3d)=>{var _0x8b91d7=_0x76d5c4;_0x39f943[_0x1cfb3d][_0x8b91d7(0xfe)]=_0x3f9abf;});var _0x2b7f96=0x0;_0x39f943[_0x76d5c4(0x1d2)](_0x1cb0a1=>{var _0x40be0c=_0x76d5c4;(parseInt(_0x1cb0a1['sale_qty'])<parseInt(_0x1cb0a1['return_qty'])||parseInt(_0x1cb0a1['stock'])<parseInt(_0x1cb0a1[_0x40be0c(0x107)])&&parseInt(_0x1cb0a1[_0x40be0c(0x191)])>parseInt(_0x1cb0a1[_0x40be0c(0x107)])||parseInt(_0x1cb0a1[_0x40be0c(0x107)])==0x0)&&_0x2b7f96++;});if(_0x2b7f96!=0x0)return _0x172505[_0x76d5c4(0xcb)]('errors',_0x76d5c4(0xe7)),_0x41b093[_0x76d5c4(0xd3)](_0x76d5c4(0x1ae));const _0x478abc=await sales_finished['findOne']({'invoice':_0x313f80});_0x478abc[_0x76d5c4(0x10a)]=_0x76d5c4(0x16b);const _0x5a0f11=await _0x478abc[_0x76d5c4(0x1b9)](),_0x1852a7=new sales_return_finished({'invoice':_0x313f80,'customer':_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1c8)],'date':_0x21f403,'warehouse_name':_0x4b59ef,'room':_0x251d8b,'ToWarehouse':_0x550dad,'ToRoom':_0x19ab42,'return_sale':_0x39f943,'note':_0x163103,'warehouse_cat':_0x30a9db}),_0x48e398=await _0x1852a7['save'](),_0x474f58=await sales_return_finished[_0x76d5c4(0x1be)]({'invoice':_0x313f80}),_0x909bf8=await warehouse[_0x76d5c4(0x1be)]({'name':_0x550dad,'room':_0x19ab42,'warehouse_category':_0x76d5c4(0x12c)});_0x474f58[_0x76d5c4(0x175)]['forEach'](_0x38fdb9=>{var _0x2ecb03=_0x76d5c4,_0xbaf8a6=0x0;const _0x364720=_0x909bf8[_0x2ecb03(0x1b3)][_0x2ecb03(0x18a)](_0x305c9e=>{var _0x3046cd=_0x2ecb03;_0x305c9e[_0x3046cd(0x1cf)]==_0x38fdb9['product_name']&&_0x305c9e['bay']==_0x38fdb9[_0x3046cd(0x10f)]&&_0x305c9e[_0x3046cd(0xfe)]==_0x38fdb9[_0x3046cd(0xfe)]&&_0x305c9e[_0x3046cd(0x17b)]==_0x38fdb9[_0x3046cd(0x17b)]&&_0x305c9e['batch_code']==_0x38fdb9['batch_code']&&(_0x305c9e[_0x3046cd(0xe5)]=parseInt(_0x305c9e['product_stock'])+parseInt(_0x38fdb9['return_qty']),_0xbaf8a6++);});_0xbaf8a6=='0'&&(_0x909bf8[_0x2ecb03(0x1b3)]=_0x909bf8[_0x2ecb03(0x1b3)][_0x2ecb03(0x1ad)]({'product_name':_0x38fdb9[_0x2ecb03(0x1cf)],'product_stock':_0x38fdb9[_0x2ecb03(0x107)],'primary_code':_0x38fdb9[_0x2ecb03(0xb4)],'secondary_code':_0x38fdb9[_0x2ecb03(0x10c)],'product_code':_0x38fdb9[_0x2ecb03(0x179)],'bay':_0x38fdb9[_0x2ecb03(0x10f)],'batch_code':_0x38fdb9['batch_code'],'maxPerUnit':_0x38fdb9[_0x2ecb03(0xd8)],'production_date':_0x38fdb9[_0x2ecb03(0x17b)],'expiry_date':_0x38fdb9[_0x2ecb03(0xfe)],'secondary_unit':_0x38fdb9['secondary_unit'],'unit':_0x38fdb9[_0x2ecb03(0xed)],'maxProducts':_0x38fdb9[_0x2ecb03(0xd2)]}));}),await _0x909bf8[_0x76d5c4(0x1b9)](),console['log'](_0x172505[_0x76d5c4(0x1a6)]);const _0x387b7a=new c_payment_data({'invoice':_0x313f80,'customer':_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1c8)],'reason':'Sale\x20Return'});await _0x387b7a['save']();const _0x965194=await master_shop[_0x76d5c4(0x111)]();console[_0x76d5c4(0xdc)]('add\x20post',_0x965194[0x0][_0x76d5c4(0x1b6)]);const _0x4c3464=await email_settings[_0x76d5c4(0x1be)](),_0x2a5484=await customer[_0x76d5c4(0x1be)]({'name':_0x172505[_0x76d5c4(0x1a6)][_0x76d5c4(0x1c8)]});console[_0x76d5c4(0xdc)](_0x76d5c4(0x128),_0x2a5484);_0x965194[0x0][_0x76d5c4(0x17e)]==0x1?(right_currency=_0x965194[0x0][_0x76d5c4(0xcd)],left_currency=''):(right_currency='',left_currency=_0x965194[0x0][_0x76d5c4(0xcd)]);var _0x8190e0=_0x33c59e,_0xf65e61=_0x14ec0a,_0x4d4d45='',_0x50730d;for(_0x50730d in _0x8190e0){_0x4d4d45+=_0x76d5c4(0xbd)+_0x76d5c4(0x189)+_0x8190e0[_0x50730d]+'</td>'+_0x76d5c4(0x189)+_0xf65e61[_0x50730d]+_0x76d5c4(0xfb)+_0x76d5c4(0x13f);}console[_0x76d5c4(0xdc)]('product_list',_0x4d4d45);let _0x42519d=nodemailer['createTransport']({'service':'gmail','auth':{'user':_0x4c3464[_0x76d5c4(0xde)],'pass':_0x4c3464['password']}}),_0x113eb5={'from':_0x4c3464[_0x76d5c4(0xde)],'to':_0x2a5484[_0x76d5c4(0xde)],'subject':_0x76d5c4(0x1af),'attachments':[{'filename':_0x76d5c4(0xe6),'path':__dirname+_0x76d5c4(0x12e)+_0x76d5c4(0x1ac)+_0x965194[0x0]['image'],'cid':_0x76d5c4(0x120)}],'html':_0x76d5c4(0x122)+_0x76d5c4(0x150)+_0x76d5c4(0x10d)+_0x76d5c4(0x125)+_0x76d5c4(0x1b0)+_0x76d5c4(0x125)+_0x76d5c4(0x167)+_0x76d5c4(0x130)+_0x76d5c4(0x125)+'<h2>\x20'+_0x965194[0x0][_0x76d5c4(0x14b)]+_0x76d5c4(0x1c4)+'</div>'+'</div>'+_0x76d5c4(0x139)+_0x76d5c4(0x125)+_0x76d5c4(0x13a)+'\x20Order\x20Number\x20:\x20'+_0x313f80+'\x20'+_0x76d5c4(0x148)+_0x76d5c4(0x144)+_0x21f403+'\x20'+'</span>'+_0x76d5c4(0x1b1)+_0x76d5c4(0x130)+_0x76d5c4(0x11d)+_0x76d5c4(0x116)+_0x76d5c4(0xbd)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x76d5c4(0x17a)+_0x76d5c4(0x1bd)+_0x76d5c4(0x157)+_0x76d5c4(0x13f)+_0x76d5c4(0x1a7)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x4d4d45+'\x20'+_0x76d5c4(0x1b5)+'</table>'+_0x76d5c4(0x125)+_0x76d5c4(0x14e)+_0x76d5c4(0x118)+_0x965194[0x0][_0x76d5c4(0x14b)]+'</h5>'+_0x76d5c4(0x130)+_0x76d5c4(0x130)+_0x76d5c4(0x1a2)};_0x42519d[_0x76d5c4(0x15e)](_0x113eb5,function(_0xb3cb78,_0x4602b6){var _0x3c115d=_0x76d5c4;_0xb3cb78?(console['log'](_0xb3cb78),console['log'](_0x3c115d(0x13b))):console[_0x3c115d(0xdc)](_0x3c115d(0x132));}),_0x172505[_0x76d5c4(0xcb)](_0x76d5c4(0x16c),_0x76d5c4(0x149)),_0x41b093[_0x76d5c4(0xd3)](_0x76d5c4(0x14d));}catch(_0x3649f0){console[_0x76d5c4(0xdc)](_0x3649f0),_0x41b093[_0x76d5c4(0x119)](0xc8)[_0x76d5c4(0xf1)]({'message1':_0x3649f0[_0x76d5c4(0x105)]});}}}),router[a0_0xede780(0xeb)](a0_0xede780(0x1bc),auth,async(_0x2c5c62,_0x2dc1aa)=>{var _0x27dc3a=a0_0xede780;try{const {username:_0x3c6649,email:_0x180740,role:_0x541da1}=_0x2c5c62['user'],_0x184530=_0x2c5c62[_0x27dc3a(0xbe)],_0xec195a=await profile['findOne']({'email':_0x184530[_0x27dc3a(0xde)]}),_0x5d8fc2=await master_shop[_0x27dc3a(0x111)]();console[_0x27dc3a(0xdc)](_0x27dc3a(0x198),_0x5d8fc2);const _0x279b5c=_0x2c5c62[_0x27dc3a(0x14a)]['id'],_0x4895d8=await sales['findById'](_0x279b5c);console['log'](_0x27dc3a(0x115),_0x4895d8);if(_0x5d8fc2[0x0]['language']==_0x27dc3a(0x1a4))var _0x1e091b=users['English'];else{if(_0x5d8fc2[0x0]['language']==_0x27dc3a(0xcc))var _0x1e091b=users[_0x27dc3a(0xcc)];else{if(_0x5d8fc2[0x0][_0x27dc3a(0x1d0)]=='German')var _0x1e091b=users['German'];else{if(_0x5d8fc2[0x0][_0x27dc3a(0x1d0)]=='Spanish')var _0x1e091b=users[_0x27dc3a(0x1cc)];else{if(_0x5d8fc2[0x0][_0x27dc3a(0x1d0)]==_0x27dc3a(0xe9))var _0x1e091b=users[_0x27dc3a(0xe9)];else{if(_0x5d8fc2[0x0][_0x27dc3a(0x1d0)]=='Portuguese\x20(BR)')var _0x1e091b=users[_0x27dc3a(0x1a3)];else{if(_0x5d8fc2[0x0][_0x27dc3a(0x1d0)]=='Chinese')var _0x1e091b=users[_0x27dc3a(0x1d1)];else{if(_0x5d8fc2[0x0][_0x27dc3a(0x1d0)]==_0x27dc3a(0x152))var _0x1e091b=users[_0x27dc3a(0x158)];}}}}}}}_0x2dc1aa[_0x27dc3a(0xc9)](_0x27dc3a(0x13c),{'success':_0x2c5c62['flash'](_0x27dc3a(0x16c)),'errors':_0x2c5c62[_0x27dc3a(0xcb)](_0x27dc3a(0x151)),'role':_0x184530,'profile':_0xec195a,'alldata':_0x4895d8,'master_shop':_0x5d8fc2,'language':_0x1e091b});}catch(_0x151905){console[_0x27dc3a(0xdc)](_0x151905);}}),router[a0_0xede780(0x1a9)](a0_0xede780(0xc8),async(_0x108c16,_0x4eb3b5)=>{var _0x55cadb=a0_0xede780;const {product_code:_0x3084d7,warehouse_name:_0x564782,rooms_data:_0x1ab8e9,Roomslist:_0x488429}=_0x108c16[_0x55cadb(0x1a6)],_0xb2ead2=_0x488429[_0x55cadb(0xd0)](','),_0x51ab69=[];async function _0x1b29a8(_0x1c3194){var _0x532669=_0x55cadb;const _0x18a680=await warehouse[_0x532669(0x12b)]([{'$match':{'name':_0x564782,'room':_0x1c3194}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x3084d7}},{'$group':{'_id':_0x532669(0x106),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x532669(0xf7)},'primary_code':{'$first':_0x532669(0x1b8)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x532669(0x15f)},'level':{'$first':_0x532669(0x113)},'isle':{'$first':_0x532669(0x11f)},'type':{'$first':_0x532669(0x11c)},'pallet':{'$first':_0x532669(0x163)},'unit':{'$first':_0x532669(0x1d3)},'secondary_unit':{'$first':_0x532669(0xd5)},'storage':{'$first':_0x532669(0x1b7)},'rack':{'$first':_0x532669(0x176)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x532669(0x137)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x532669(0xee)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x532669(0x19c)},'invoice':{'$first':_0x532669(0x16d)}}}]),_0x5f495f=await warehouse[_0x532669(0x12b)]([{'$match':{'name':_0x564782,'room':_0x1c3194}},{'$unwind':_0x532669(0x19f)},{'$match':{'product_details.secondary_code':_0x3084d7}},{'$group':{'_id':_0x532669(0x106),'name':{'$first':_0x532669(0x19a)},'product_stock':{'$first':_0x532669(0xf7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x532669(0xd1)},'product_code':{'$first':_0x532669(0x15f)},'level':{'$first':_0x532669(0x113)},'isle':{'$first':_0x532669(0x11f)},'type':{'$first':_0x532669(0x11c)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x532669(0x1d3)},'secondary_unit':{'$first':_0x532669(0xd5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x532669(0x176)},'expiry_date':{'$first':_0x532669(0x1c6)},'production_date':{'$first':_0x532669(0xef)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x532669(0x104)},'product_cat':{'$first':_0x532669(0xee)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x532669(0x19c)},'invoice':{'$first':_0x532669(0x16d)}}}]);if(_0x18a680[_0x532669(0xb7)]>0x0)_0x51ab69[_0x532669(0x177)](_0x18a680);else _0x5f495f[_0x532669(0xb7)]>0x0&&_0x51ab69[_0x532669(0x177)](_0x5f495f);}const _0x519b1a=_0xb2ead2[_0x55cadb(0x18a)](_0x50c6a8=>_0x1b29a8(_0x50c6a8));await Promise[_0x55cadb(0x192)](_0x519b1a),_0x4eb3b5[_0x55cadb(0xf1)](_0x51ab69);}),module['exports']=router;