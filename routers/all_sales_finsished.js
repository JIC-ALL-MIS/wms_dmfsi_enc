var a0_0x3ee30d=a0_0x3248;(function(_0x1fb1c5,_0x3c3b73){var _0x2cbb93=a0_0x3248,_0x321454=_0x1fb1c5();while(!![]){try{var _0x20c583=parseInt(_0x2cbb93(0xa5))/0x1+-parseInt(_0x2cbb93(0x158))/0x2+parseInt(_0x2cbb93(0xc6))/0x3+-parseInt(_0x2cbb93(0xbc))/0x4+parseInt(_0x2cbb93(0x134))/0x5*(parseInt(_0x2cbb93(0xb5))/0x6)+-parseInt(_0x2cbb93(0xf0))/0x7+-parseInt(_0x2cbb93(0xad))/0x8*(-parseInt(_0x2cbb93(0x79))/0x9);if(_0x20c583===_0x3c3b73)break;else _0x321454['push'](_0x321454['shift']());}catch(_0x21cc55){_0x321454['push'](_0x321454['shift']());}}}(a0_0x1d55,0x315ec));const express=require(a0_0x3ee30d(0xd5)),app=express(),router=express[a0_0x3ee30d(0x152)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x3ee30d(0x7b)),auth=require(a0_0x3ee30d(0x13d)),nodemailer=require('nodemailer'),users=require(a0_0x3ee30d(0xe3));function a0_0x1d55(){var _0x2cd09c=['<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</h5>','FGSEmail','True','stocks_QA','/view/add_sales','warehouse_name','product','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','sales_quantity_QA','success','received_amount','expiry_date','image','flash','room_name','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','return_data','Hindi','<table\x20style=\x22width:\x20100%\x20!important;\x22>','all_sales_finished','map','$note','Enabled','secondary_code_QA','adjust_qty','status','amount','customers','string','add_sales_finished','$room','date','edit_sales_finished','Sale\x20Return','customers_docs','customer','$product_details','$customer','315nzRgPq','room','../models/all_models','$product_details.expiry_date','$product_details.primary_code','add\x20post','</div>','/view/add_sale/product','site_title','$product_details.invoice','unit','product_code_QA','invoice','$customers_docs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','French','Sale\x20Return\x20Mail','/give_payment/:id','sendMail','sales_quantity','return_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$invoice','$return_data','/invoice/:id','catch','_id','$product_details.product_cat','/all_sales_finished/preview/','batch_code','getMonth','Sales\x20Add\x20successfully','<!DOCTYPE\x20html>','user','English','for_categorize','concat','logo','$finalize','product_name_QA1','then','An\x20error\x20occurred\x20while\x20saving\x20data.','Ambient','Portuguese','81206hfzlui','$product','/upload/','Sales\x20Mail','product_list','$name','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','65848oZxttV','/picking_list/pdf/','purchases_data','Spanish','port','createTransport','secondary_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','12hRnHmW','prod_cat','random','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','batch_code_QA','</span>','<tbody\x20style=\x22text-align:\x20center;\x22>','1198228VgAStM','\x20</h2>','<hr\x20class=\x22my-3\x22>','</tr>','redirect','<h5>','Quality\x20Inspection','Error\x20Occurs','customer_data','message','917124Movzhm','</tbody>','suppliers','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<h5\x20style=\x22text-align:\x20left;\x22>','Sale','forEach','/all_sales/view','level','password','return_sale_finished','quantity','note','split','/preview/:id','express','all','edit_sales_finished_view','</table>','An\x20error\x20occurred.','back','finalize','$product_details.secondary_unit','<h2>\x20','sale_product','padStart','Enclosed','product_details','Return\x20Rooms','../public/language/languages.json','carton','save','maxProducts','expiry_date_QA','product_stock','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','Portuguese\x20(BR)','$product_details.production_date','Sale\x20Product\x20Mail','$product_details.batch_code','<html><head><title></title>','225596Dhzwfx','$product_details.floorlevel','</body></html>','prod_invoice','$product_details.product_stock','Logo.png','sale_qty','body','RoomAssigned','Arabic','/all_sales_finished/view','/view/return_sales/:id','bay','sales_invoice','$product_details.bay','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','getFullYear','due_amount','product_name','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','\x20Order\x20Number\x20:\x20','exports','maxPerUnit','German','slice','filter','sales\x20item\x20return\x20successfull','production_date_QA','language','$product_details.bin','maxProducts_QA','errors','Finished\x20Goods','$_id','production_date','product_data','payment\x20successfull','json','$sale_product.type','$date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','\x20Order\x20Date\x20:\x20','$product_details.storage','</head><body>','role','unit_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details._id','currency','$product_details.maxPerUnit','staff','primary_unit','<span\x20style=\x22float:\x20right;\x22>','Email\x20sent\x20successfully','Return\x20Goods','email','$sale_product.bin','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.product_code','OUTF-','findById','return_qty_QA','<tr>','$sale_product.bay','$product_details.type','primary_code','stock','189935sKqhGF','currency_placement','Chinese','$product_details.unit','</td>','all_sales_barcode','$sale_product','primary_code_QA','gmail','../middleware/auth','aggregate','push','getDate','maxPerUnit_QA','return_sale_QA','product_code','/view/:id','<strong>\x20Regards\x20</strong>','$product.product_name','/view/add_sales/:id','error','prod_code','find','floor','warehouse','name','barcode\x20user_id','get','max_per_unit','Arabic\x20(ae)','Router','QA\x20Warehouse','product_date','params','</thead>','$sale_product.floorlevel','433936vEduPL','findOne','secondary_unit','$product_details.product_name','/../public','$product_details.secondary_code','English\x20(US)','post','$product_details.rack','secondary_unit_QA','Received\x20Payment\x20For\x20Sale','$sale_product.quantity'];a0_0x1d55=function(){return _0x2cd09c;};return a0_0x1d55();}function a0_0x3248(_0x568afe,_0x34efc7){var _0x1d558c=a0_0x1d55();return a0_0x3248=function(_0x32483b,_0x430d91){_0x32483b=_0x32483b-0x74;var _0x4064f6=_0x1d558c[_0x32483b];return _0x4064f6;},a0_0x3248(_0x568afe,_0x34efc7);}router[a0_0x3ee30d(0x14f)]('/view',auth,async(_0xc6b35,_0x3b2685)=>{var _0x30530e=a0_0x3ee30d;try{const {username:_0x577103,email:_0xb2963f,role:_0x57dceb}=_0xc6b35[_0x30530e(0x9a)],_0xf6c2a3=_0xc6b35[_0x30530e(0x9a)],_0x2eb77c=await profile[_0x30530e(0x159)]({'email':_0xf6c2a3[_0x30530e(0x127)]}),_0x285884=await master_shop[_0x30530e(0x14a)]();let _0x236dd2;if(_0xf6c2a3[_0x30530e(0x11c)]=='staff'){const _0x48ab8a=await staff['findOne']({'email':_0xf6c2a3[_0x30530e(0x127)]});_0x236dd2=await sales_finished[_0x30530e(0x13e)]([{'$lookup':{'from':'customers','localField':_0x30530e(0x76),'foreignField':_0x30530e(0x14d),'as':_0x30530e(0x75)}},{'$unwind':_0x30530e(0x86)},{'$unwind':_0x30530e(0x13a)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x30530e(0x117)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x30530e(0x13a)},'note':{'$first':_0x30530e(0x17c)},'return_data':{'$first':_0x30530e(0x90)},'customers_docs':{'$first':_0x30530e(0x86)},'total_saleproduct_quantity':{'$sum':_0x30530e(0x163)},'level':{'$addToSet':_0x30530e(0x130)},'isle':{'$addToSet':_0x30530e(0x128)},'type':{'$addToSet':_0x30530e(0x116)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x30530e(0x9f)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x236dd2=await sales_finished[_0x30530e(0x13e)]([{'$lookup':{'from':_0x30530e(0x182),'localField':'customer','foreignField':_0x30530e(0x14d),'as':_0x30530e(0x75)}},{'$unwind':_0x30530e(0x86)},{'$unwind':_0x30530e(0x13a)},{'$group':{'_id':_0x30530e(0x111),'invoice':{'$first':_0x30530e(0x8f)},'customers':{'$first':_0x30530e(0x78)},'date':{'$first':_0x30530e(0x117)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':_0x30530e(0x90)},'customers_docs':{'$first':_0x30530e(0x86)},'total_saleproduct_quantity':{'$sum':_0x30530e(0x163)},'level':{'$addToSet':_0x30530e(0x130)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x30530e(0x116)},'pallet':{'$addToSet':_0x30530e(0x157)},'finalize':{'$first':_0x30530e(0x9f)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x285884[0x0]['language']=='English\x20(US)'){var _0x1e316a=users[_0x30530e(0x9b)];console[_0x30530e(0xab)](_0x1e316a);}else{if(_0x285884[0x0]['language']=='Hindi')var _0x1e316a=users[_0x30530e(0x178)];else{if(_0x285884[0x0][_0x30530e(0x10c)]==_0x30530e(0x107))var _0x1e316a=users[_0x30530e(0x107)];else{if(_0x285884[0x0][_0x30530e(0x10c)]=='Spanish')var _0x1e316a=users[_0x30530e(0xb0)];else{if(_0x285884[0x0][_0x30530e(0x10c)]==_0x30530e(0x88))var _0x1e316a=users[_0x30530e(0x88)];else{if(_0x285884[0x0]['language']==_0x30530e(0xeb))var _0x1e316a=users[_0x30530e(0xa4)];else{if(_0x285884[0x0][_0x30530e(0x10c)]=='Chinese')var _0x1e316a=users[_0x30530e(0x136)];else{if(_0x285884[0x0][_0x30530e(0x10c)]==_0x30530e(0x151))var _0x1e316a=users[_0x30530e(0xf9)];}}}}}}}_0x3b2685[_0x30530e(0xe9)](_0x30530e(0x17a),{'success':_0xc6b35['flash'](_0x30530e(0x16f)),'errors':_0xc6b35[_0x30530e(0x173)](_0x30530e(0x10f)),'sales':_0x236dd2,'profile':_0x2eb77c,'role':_0xf6c2a3,'master_shop':_0x285884,'language':_0x1e316a});}catch(_0x72b133){console['log'](_0x72b133);}});async function getRandom8DigitNumber(){var _0x5c22cb=a0_0x3ee30d;const _0x40927a=0x989680,_0x35f66d=0x5f5e0ff,_0x5286cf=Math[_0x5c22cb(0x14b)](Math[_0x5c22cb(0xb7)]()*(_0x35f66d-_0x40927a+0x1))+_0x40927a;var _0x265591;const _0x3f60bd=await sales_finished[_0x5c22cb(0x159)]({'invoice':_0x5c22cb(0x12c)+_0x5286cf});return _0x3f60bd&&_0x3f60bd[_0x5c22cb(0x129)]>0x0?_0x265591='OUTF-'+_0x5286cf:_0x265591=_0x5c22cb(0x12c)+_0x5286cf,_0x265591;}router[a0_0x3ee30d(0x14f)](a0_0x3ee30d(0x16a),auth,async(_0x206b9d,_0x183118)=>{var _0x156e23=a0_0x3ee30d;try{const {username:_0x2f3ceb,email:_0x2d9403,role:_0x56f27f}=_0x206b9d[_0x156e23(0x9a)],_0x4393d6=_0x206b9d[_0x156e23(0x9a)],_0x2e6f60=await profile['findOne']({'email':_0x4393d6[_0x156e23(0x127)]}),_0x3cb1d7=await master_shop[_0x156e23(0x14a)](),_0x5d8ea3=await customer[_0x156e23(0x14a)]({});let _0x152d73;if(_0x4393d6[_0x156e23(0x11c)]==_0x156e23(0x122)){const _0xec6679=await staff['findOne']({'email':_0x4393d6[_0x156e23(0x127)]});_0x152d73=await warehouse[_0x156e23(0x13e)]([{'$match':{'status':_0x156e23(0x17d),'name':_0xec6679[_0x156e23(0x14c)],'warehouse_category':_0x156e23(0x110),'name':{'$ne':_0x156e23(0x153)}}},{'$group':{'_id':'$name','name':{'$first':_0x156e23(0xaa)}}},{'$sort':{'name':0x1}}]);}else _0x152d73=await warehouse[_0x156e23(0x13e)]([{'$match':{'status':_0x156e23(0x17d),'warehouse_category':_0x156e23(0x110),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x156e23(0xaa),'name':{'$first':_0x156e23(0xaa)}}},{'$sort':{'name':0x1}}]);const _0x5dbc57=await product[_0x156e23(0x14a)]({});var _0x4cdb09=[_0x156e23(0xa3),_0x156e23(0xe0)];const _0x42a29a=await sales_finished[_0x156e23(0x14a)]({}),_0x18a10f=_0x42a29a[_0x156e23(0x129)]+0x1,_0x28db92=_0x156e23(0x12c)+_0x18a10f['toString']()[_0x156e23(0xdf)](0x5,'0');if(_0x3cb1d7[0x0]['language']=='English\x20(US)'){var _0x2ed8f5=users['English'];console[_0x156e23(0xab)](_0x2ed8f5);}else{if(_0x3cb1d7[0x0][_0x156e23(0x10c)]==_0x156e23(0x178))var _0x2ed8f5=users[_0x156e23(0x178)];else{if(_0x3cb1d7[0x0][_0x156e23(0x10c)]=='German')var _0x2ed8f5=users['German'];else{if(_0x3cb1d7[0x0][_0x156e23(0x10c)]==_0x156e23(0xb0))var _0x2ed8f5=users[_0x156e23(0xb0)];else{if(_0x3cb1d7[0x0]['language']==_0x156e23(0x88))var _0x2ed8f5=users[_0x156e23(0x88)];else{if(_0x3cb1d7[0x0][_0x156e23(0x10c)]==_0x156e23(0xeb))var _0x2ed8f5=users['Portuguese'];else{if(_0x3cb1d7[0x0][_0x156e23(0x10c)]==_0x156e23(0x136))var _0x2ed8f5=users[_0x156e23(0x136)];else{if(_0x3cb1d7[0x0][_0x156e23(0x10c)]=='Arabic\x20(ae)')var _0x2ed8f5=users['Arabic'];}}}}}}}const _0x57565e=getRandom8DigitNumber();_0x57565e[_0x156e23(0xa1)](_0x14d074=>{var _0x95153e=_0x156e23;_0x183118[_0x95153e(0xe9)](_0x95153e(0x184),{'success':_0x206b9d['flash'](_0x95153e(0x16f)),'errors':_0x206b9d['flash']('errors'),'role':_0x4393d6,'profile':_0x2e6f60,'customer':_0x5d8ea3,'warehouse':_0x152d73,'product':_0x5dbc57,'invoice':_0x14d074,'master_shop':_0x3cb1d7,'language':_0x2ed8f5,'rooms_data':_0x4cdb09});})[_0x156e23(0x92)](_0x515804=>{var _0x1f2107=_0x156e23;_0x206b9d[_0x1f2107(0x173)](_0x1f2107(0x10f),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x183118[_0x1f2107(0xc0)](_0x1f2107(0xfa));});}catch(_0x405ad6){console[_0x156e23(0xab)](_0x405ad6);}}),router['get'](a0_0x3ee30d(0x147),auth,async(_0x3db591,_0x850cf6)=>{var _0x33003c=a0_0x3ee30d;try{const _0x18c690=_0x3db591[_0x33003c(0x155)]['id'];console[_0x33003c(0xab)](_0x18c690);const _0x14eabc=await product[_0x33003c(0x14a)](),_0x1d4b38=await purchases['aggregate']([{'$match':{'warehouse_name':_0x18c690}},{'$unwind':_0x33003c(0xa6)},{'$group':{'_id':_0x33003c(0x146)}}]);console[_0x33003c(0xab)](_0x33003c(0xaf),_0x1d4b38),_0x850cf6[_0x33003c(0x180)](0xc8)[_0x33003c(0x115)]({'purchases_data':_0x1d4b38,'product_data':_0x14eabc});}catch(_0x5d300b){console['log'](_0x5d300b);}}),router['post'](a0_0x3ee30d(0x80),auth,async(_0x34fc80,_0x1c6003)=>{var _0x24ddf1=a0_0x3ee30d;try{const {warehouse_data:_0x372b43,product_data:_0x534929}=_0x34fc80['body'];console[_0x24ddf1(0xab)](_0x34fc80['body'][_0x24ddf1(0x113)]);;const _0x5d68d7=await master_shop[_0x24ddf1(0x14a)]();console[_0x24ddf1(0xab)]('master',_0x5d68d7);const _0x28ba28=await product[_0x24ddf1(0x159)]({'name':_0x534929});console[_0x24ddf1(0xab)](_0x24ddf1(0x16c),_0x28ba28);const _0x44c567=await warehouse[_0x24ddf1(0x13e)]([{'$match':{'name':_0x372b43}},{'$unwind':_0x24ddf1(0x77)},{'$match':{'product_details.product_name':_0x534929}},{'$group':{'_id':_0x24ddf1(0x15b),'product_stock':{'$first':_0x24ddf1(0xf4)}}}]);console[_0x24ddf1(0xab)]('stock_data',_0x44c567),_0x1c6003['status'](0xc8)[_0x24ddf1(0x115)]({'master':_0x5d68d7,'new_product':_0x28ba28,'stock_data':_0x44c567});}catch(_0x302210){console['log'](_0x302210);}}),router[a0_0x3ee30d(0x15f)](a0_0x3ee30d(0x16a),auth,async(_0xbaaff5,_0x39b2c9)=>{var _0x40f4ba=a0_0x3ee30d;try{const {invoice:_0x10c61c,date:_0x1aa716,warehouse_name:_0x16658b,product_name:_0x4de434,stock:_0x3d0c23,quantity:_0x1b962b,note:_0x361bab,room:_0xb12915,primary_code:_0x332665,secondary_code:_0x3fe9fd,prod_code:_0x5da310,level:_0x4108a9,isle:_0xdeedae,pallet:_0x28cab3,batch_code:_0x40dab7,SCRN:_0x581901,expiry_date:_0x7663f1,mode_transpo:_0x38eca4,name_driver:_0x3b1fee}=_0xbaaff5[_0x40f4ba(0xf7)];if(typeof _0x4de434=='string')var _0x4d24fc=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x102)]],_0x24e194=[_0xbaaff5['body']['stock']],_0x873b83=[_0xbaaff5[_0x40f4ba(0xf7)]['carton']],_0xfeeae2=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x132)]],_0x1ba977=[_0xbaaff5[_0x40f4ba(0xf7)]['secondary_code']],_0x541a87=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x149)]],_0x48bc64=[_0xbaaff5['body'][_0x40f4ba(0xce)]],_0x179b8f=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x123)]],_0x2582dc=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x15a)]],_0x3c8dcd=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x96)]],_0x13cc1c=[_0xbaaff5['body'][_0x40f4ba(0x171)]],_0x45d94f=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x154)]],_0x4d84d0=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x150)]],_0x4640b2=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0xb6)]],_0x5d92a8=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0xf8)]],_0x128684=[_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0xf3)]];else var _0x4d24fc=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x102)]],_0x24e194=[..._0xbaaff5[_0x40f4ba(0xf7)]['stock']],_0x873b83=[..._0xbaaff5['body'][_0x40f4ba(0xe4)]],_0xfeeae2=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x132)]],_0x1ba977=[..._0xbaaff5['body'][_0x40f4ba(0xb3)]],_0x541a87=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x149)]],_0x48bc64=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0xce)]],_0x179b8f=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x123)]],_0x2582dc=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x15a)]],_0x3c8dcd=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x96)]],_0x13cc1c=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x171)]],_0x45d94f=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x154)]],_0x4d84d0=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x150)]],_0x4640b2=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0xb6)]],_0x5d92a8=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0xf8)]],_0x128684=[..._0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0xf3)]];const _0x28c013=_0x4d24fc[_0x40f4ba(0x17b)](_0x2037df=>{return _0x2037df={'product_name':_0x2037df};});_0x24e194[_0x40f4ba(0xcc)]((_0x4e46b8,_0x11408b)=>{var _0x2bc4d6=_0x40f4ba;_0x28c013[_0x11408b][_0x2bc4d6(0x133)]=_0x4e46b8;}),_0x873b83['forEach']((_0x2aad94,_0x28bebf)=>{var _0x5f1689=_0x40f4ba;_0x28c013[_0x28bebf][_0x5f1689(0xd1)]=_0x2aad94;}),_0xfeeae2[_0x40f4ba(0xcc)]((_0x138742,_0x2d3c36)=>{var _0x339a85=_0x40f4ba;_0x28c013[_0x2d3c36][_0x339a85(0x132)]=_0x138742;}),_0x1ba977[_0x40f4ba(0xcc)]((_0x18ebfb,_0x161e66)=>{var _0x1d940a=_0x40f4ba;_0x28c013[_0x161e66][_0x1d940a(0xb3)]=_0x18ebfb;}),_0x541a87['forEach']((_0x225048,_0x5570bb)=>{var _0x28a72b=_0x40f4ba;_0x28c013[_0x5570bb][_0x28a72b(0x143)]=_0x225048;}),_0x48bc64['forEach']((_0xf586e3,_0x713f28)=>{var _0x3ecef4=_0x40f4ba;_0x28c013[_0x713f28][_0x3ecef4(0xfc)]=_0xf586e3;}),_0x179b8f['forEach']((_0x52055f,_0x43f884)=>{var _0x5949c2=_0x40f4ba;_0x28c013[_0x43f884][_0x5949c2(0x83)]=_0x52055f;}),_0x2582dc['forEach']((_0x1fe28b,_0x2ec8c3)=>{var _0x48b00c=_0x40f4ba;_0x28c013[_0x2ec8c3][_0x48b00c(0x15a)]=_0x1fe28b;}),_0x3c8dcd['forEach']((_0x375824,_0x145663)=>{_0x28c013[_0x145663]['batch_code']=_0x375824;}),_0x13cc1c[_0x40f4ba(0xcc)]((_0x339bc0,_0x53d432)=>{_0x28c013[_0x53d432]['expiry_date']=_0x339bc0;}),_0x45d94f['forEach']((_0x434a6a,_0x549bdb)=>{_0x28c013[_0x549bdb]['production_date']=_0x434a6a;}),_0x4d84d0[_0x40f4ba(0xcc)]((_0x2d3b72,_0x4b497e)=>{_0x28c013[_0x4b497e]['maxperunit']=_0x2d3b72;}),_0x4640b2[_0x40f4ba(0xcc)]((_0x536a3e,_0x582b97)=>{var _0x5c660f=_0x40f4ba;_0x28c013[_0x582b97][_0x5c660f(0xb6)]=_0x536a3e;}),_0x5d92a8['forEach']((_0x381d3d,_0x7f2b4)=>{var _0x307ad8=_0x40f4ba;_0x28c013[_0x7f2b4][_0x307ad8(0x174)]=_0x381d3d;}),_0x128684['forEach']((_0x39dd53,_0x507ef8)=>{var _0x556e64=_0x40f4ba;_0x28c013[_0x507ef8][_0x556e64(0x85)]=_0x39dd53;});var _0x58e6e0=0x0;_0x28c013['forEach'](_0x496866=>{var _0x14de6e=_0x40f4ba;console[_0x14de6e(0xab)]('foreach\x20newproduct',_0x496866),(parseInt(_0x496866['stock'])<parseInt(_0x496866[_0x14de6e(0xd1)])||parseInt(_0x496866[_0x14de6e(0xd1)])==0x0)&&_0x58e6e0++;});if(_0x58e6e0!=0x0)return _0xbaaff5[_0x40f4ba(0x173)](_0x40f4ba(0x10f),_0x40f4ba(0xff)),_0x39b2c9[_0x40f4ba(0xc0)]('back');const _0x235556=_0x28c013['filter'](_0x162131=>_0x162131['quantity']!=='0'&&_0x162131[_0x40f4ba(0xd1)]!==''),_0x46619e=new sales_finished({'invoice':_0x10c61c,'customer':_0xbaaff5[_0x40f4ba(0xf7)][_0x40f4ba(0x76)],'date':_0x1aa716,'warehouse_name':_0x16658b,'sale_product':_0x235556,'note':_0x361bab,'room':_0xb12915,'primary_code':_0x332665,'secondary_code':_0x3fe9fd,'prod_code':_0x5da310,'SCRN':_0x581901,'finalize':'False','mode_transpo':_0x38eca4,'name_driver':_0x3b1fee}),_0x3f95e9=await _0x46619e[_0x40f4ba(0xe5)](),_0x458972=await sales_finished[_0x40f4ba(0x159)]({'invoice':_0x10c61c}),_0x3b4b9e=new c_payment_data({'invoice':_0x10c61c,'customer':_0xbaaff5['body']['customer'],'reason':_0x40f4ba(0xcb)});await _0x3b4b9e[_0x40f4ba(0xe5)]();const _0x54ed1c=await master_shop[_0x40f4ba(0x14a)](),_0x216981=await email_settings['findOne'](),_0xa7cf5d=await customer[_0x40f4ba(0x159)]({'name':_0xbaaff5['body']['customer']});_0x54ed1c[0x0]['currency_placement']==0x1?(right_currency=_0x54ed1c[0x0][_0x40f4ba(0x120)],left_currency=''):(right_currency='',left_currency=_0x54ed1c[0x0][_0x40f4ba(0x120)]);var _0x53c509=_0x4d24fc,_0x5ee49f=_0x873b83,_0x34707e='',_0x1476aa;for(_0x1476aa in _0x53c509){_0x34707e+=_0x40f4ba(0x12f)+_0x40f4ba(0x16d)+_0x53c509[_0x1476aa]+_0x40f4ba(0x138)+_0x40f4ba(0x16d)+_0x5ee49f[_0x1476aa]+_0x40f4ba(0x138)+_0x40f4ba(0xbf);}console[_0x40f4ba(0xab)](_0x40f4ba(0xa9),_0x34707e);let _0x3b076d=nodemailer[_0x40f4ba(0xb2)]({'service':_0x40f4ba(0x13c),'auth':{'user':_0x216981[_0x40f4ba(0x127)],'pass':_0x216981[_0x40f4ba(0xcf)]}}),_0x1b599a={'from':_0x216981[_0x40f4ba(0x127)],'to':_0xa7cf5d['email'],'subject':_0x40f4ba(0xed),'attachments':[{'filename':_0x40f4ba(0xf5),'path':__dirname+_0x40f4ba(0x15c)+_0x40f4ba(0xa7)+_0x54ed1c[0x0][_0x40f4ba(0x172)],'cid':_0x40f4ba(0x9e)}],'html':_0x40f4ba(0x99)+_0x40f4ba(0xef)+_0x40f4ba(0x11b)+_0x40f4ba(0x175)+_0x40f4ba(0x164)+'<div>'+_0x40f4ba(0x103)+_0x40f4ba(0x7f)+_0x40f4ba(0x175)+_0x40f4ba(0xdd)+_0x54ed1c[0x0][_0x40f4ba(0x81)]+_0x40f4ba(0xbd)+_0x40f4ba(0x7f)+_0x40f4ba(0x7f)+_0x40f4ba(0xbe)+_0x40f4ba(0x175)+_0x40f4ba(0xca)+_0x40f4ba(0x104)+_0x10c61c+'\x20'+_0x40f4ba(0x124)+_0x40f4ba(0x119)+_0x1aa716+'\x20'+_0x40f4ba(0xba)+'</h5>'+_0x40f4ba(0x7f)+_0x40f4ba(0x179)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x40f4ba(0x8e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>'+'</tr>'+_0x40f4ba(0x156)+_0x40f4ba(0xbb)+'\x20'+_0x34707e+'\x20'+_0x40f4ba(0xc7)+'</table>'+'<div>'+_0x40f4ba(0x145)+_0x40f4ba(0xc1)+_0x54ed1c[0x0]['site_title']+_0x40f4ba(0x166)+_0x40f4ba(0x7f)+_0x40f4ba(0x7f)+_0x40f4ba(0xf2)};_0x3b076d[_0x40f4ba(0x8b)](_0x1b599a,function(_0x2e69ce,_0x575364){var _0x3a65e6=_0x40f4ba;_0x2e69ce?(console['log'](_0x2e69ce),console[_0x3a65e6(0xab)](_0x3a65e6(0xc3))):console[_0x3a65e6(0xab)]('Email\x20sent\x20successfully');}),_0xbaaff5['flash'](_0x40f4ba(0x16f),_0x40f4ba(0x98)),_0x39b2c9[_0x40f4ba(0xc0)](_0x40f4ba(0x95)+_0x3f95e9[_0x40f4ba(0x93)]);}catch(_0x5576a4){console[_0x40f4ba(0xab)](_0x5576a4);}}),router['get'](a0_0x3ee30d(0xd4),auth,async(_0x2d6f35,_0x25293d)=>{var _0x177b46=a0_0x3ee30d;try{const {username:_0x12866e,email:_0x3dea81,role:_0x5d5113}=_0x2d6f35[_0x177b46(0x9a)],_0x294efc=_0x2d6f35[_0x177b46(0x9a)],_0x553982=await profile[_0x177b46(0x159)]({'email':_0x294efc[_0x177b46(0x127)]}),_0x409578=await master_shop[_0x177b46(0x14a)](),_0xeac076=_0x2d6f35['params']['id'],_0x536896=await sales_finished[_0x177b46(0x12d)](_0xeac076),_0x2e5716=await warehouse[_0x177b46(0x13e)]([{'$match':{'name':_0x536896[_0x177b46(0x16b)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x177b46(0x11f),'name':{'$first':_0x177b46(0x15b)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x177b46(0xfe)},'bin':{'$first':_0x177b46(0x10d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x177b46(0xf1)},'primary_code':{'$first':_0x177b46(0x7d)},'secondary_code':{'$first':_0x177b46(0x15d)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x177b46(0x11a)},'rack':{'$first':_0x177b46(0x160)},'expiry_date':{'$first':_0x177b46(0x7c)},'production_date':{'$first':_0x177b46(0xec)},'batch_code':{'$first':_0x177b46(0xee)},'room':{'$first':_0x177b46(0x185)}}}]),_0x30c532=await customer['find']({});let _0x529096;if(_0x294efc[_0x177b46(0x11c)]==_0x177b46(0x122)){const _0x4160b2=await staff[_0x177b46(0x159)]({'email':_0x294efc['email']});_0x529096=await warehouse[_0x177b46(0x13e)]([{'$match':{'status':_0x177b46(0x17d),'name':_0x4160b2[_0x177b46(0x14c)]}},{'$group':{'_id':_0x177b46(0xaa),'name':{'$first':_0x177b46(0xaa)}}}]);}else _0x529096=await warehouse[_0x177b46(0x13e)]([{'$match':{'status':_0x177b46(0x17d)}},{'$group':{'_id':_0x177b46(0xaa),'name':{'$first':'$name'}}}]);const _0x46f3b0=await product[_0x177b46(0x14a)]({});if(_0x409578[0x0][_0x177b46(0x10c)]=='English\x20(US)'){var _0x12d0a3=users[_0x177b46(0x9b)];console[_0x177b46(0xab)](_0x12d0a3);}else{if(_0x409578[0x0]['language']==_0x177b46(0x178))var _0x12d0a3=users['Hindi'];else{if(_0x409578[0x0][_0x177b46(0x10c)]==_0x177b46(0x107))var _0x12d0a3=users['German'];else{if(_0x409578[0x0]['language']=='Spanish')var _0x12d0a3=users[_0x177b46(0xb0)];else{if(_0x409578[0x0]['language']==_0x177b46(0x88))var _0x12d0a3=users[_0x177b46(0x88)];else{if(_0x409578[0x0][_0x177b46(0x10c)]=='Portuguese\x20(BR)')var _0x12d0a3=users['Portuguese'];else{if(_0x409578[0x0][_0x177b46(0x10c)]==_0x177b46(0x136))var _0x12d0a3=users['Chinese'];else{if(_0x409578[0x0]['language']==_0x177b46(0x151))var _0x12d0a3=users[_0x177b46(0xf9)];}}}}}}}_0x25293d['render'](_0x177b46(0xd7),{'success':_0x2d6f35[_0x177b46(0x173)](_0x177b46(0x16f)),'errors':_0x2d6f35[_0x177b46(0x173)](_0x177b46(0x10f)),'role':_0x294efc,'profile':_0x553982,'customer':_0x30c532,'warehouse':_0x529096,'product':_0x2e5716,'user':_0x536896,'master_shop':_0x409578,'unit':_0x46f3b0,'language':_0x12d0a3});}catch(_0x5675aa){console[_0x177b46(0xab)](_0x5675aa);}}),router[a0_0x3ee30d(0x15f)]('/preview/:id',auth,async(_0xe5c9db,_0x483cf1)=>{var _0x3f1e1c=a0_0x3ee30d;try{const _0x11e191=_0xe5c9db[_0x3f1e1c(0x155)]['id'],{invoice:_0x4674eb,warehouse_name:_0x585ee4,room:_0x313645}=_0xe5c9db['body'],_0x3e1e86=await sales_finished[_0x3f1e1c(0x159)]({'invoice':_0x4674eb}),_0x43365e=_0x3e1e86[_0x3f1e1c(0xde)][_0x3f1e1c(0x17b)](async _0x5a044c=>{var _0x44a10e=_0x3f1e1c,_0x36c192=await warehouse[_0x44a10e(0x159)]({'name':_0x585ee4,'room':_0x5a044c['room_name'],'warehouse_category':'Finished\x20Goods'});const _0x107f40=_0x36c192[_0x44a10e(0xe1)][_0x44a10e(0x17b)](_0x22c782=>{var _0x4806fa=_0x44a10e;_0x22c782[_0x4806fa(0x102)]==_0x5a044c[_0x4806fa(0x102)]&&_0x22c782['bay']==_0x5a044c['bay']&&_0x22c782['expiry_date']==_0x5a044c[_0x4806fa(0x171)]&&_0x22c782[_0x4806fa(0x112)]==_0x5a044c[_0x4806fa(0x112)]&&_0x22c782['batch_code']==_0x5a044c[_0x4806fa(0x96)]&&_0x22c782[_0x4806fa(0x85)]==_0x5a044c[_0x4806fa(0x85)]&&(_0x22c782[_0x4806fa(0xe8)]=_0x22c782[_0x4806fa(0xe8)]-_0x5a044c[_0x4806fa(0xd1)]);});return _0x36c192;});Promise[_0x3f1e1c(0xd6)](_0x43365e)[_0x3f1e1c(0xa1)](async _0x1a48f8=>{var _0x374deb=_0x3f1e1c;try{for(const _0x52fc42 of _0x1a48f8){await _0x52fc42['save']();}_0x3e1e86[_0x374deb(0xdb)]=_0x374deb(0x168);const _0x19e5bb=await _0x3e1e86[_0x374deb(0xe5)](),_0x15ba6e=await master_shop[_0x374deb(0x14a)](),_0x3f4598=await email_settings[_0x374deb(0x159)](),_0x487690=await supervisor_settings[_0x374deb(0x14a)]();var _0x24f485=_0x3e1e86[_0x374deb(0xde)],_0x2ba6e8='',_0x4dfb1c;for(_0x4dfb1c in _0x24f485){var _0x2c35bd='FG';_0x3e1e86['warehouse_name']=='DRY\x20GOODS'&&(_0x2c35bd='DG'),_0x2ba6e8+=_0x374deb(0x12f)+_0x374deb(0x16d)+_0x24f485[_0x4dfb1c]['product_name']+_0x374deb(0x138)+_0x374deb(0x16d)+_0x24f485[_0x4dfb1c]['product_code']+_0x374deb(0x138)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24f485[_0x4dfb1c][_0x374deb(0xd1)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24f485[_0x4dfb1c][_0x374deb(0x83)]+'</td>'+_0x374deb(0x16d)+_0x24f485[_0x4dfb1c][_0x374deb(0x15a)]+'</td>'+_0x374deb(0x16d)+_0x3e1e86['warehouse_name']+'</td>'+_0x374deb(0x16d)+_0x24f485[_0x4dfb1c][_0x374deb(0x174)]+_0x374deb(0x138)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2c35bd+_0x24f485[_0x4dfb1c][_0x374deb(0xfc)]+_0x374deb(0x138);}let _0x1dd9f2=nodemailer['createTransport']({'host':_0x3f4598['host'],'port':Number(_0x3f4598[_0x374deb(0xb1)]),'secure':![],'auth':{'user':_0x3f4598['email'],'pass':_0x3f4598[_0x374deb(0xcf)]}}),_0x53394f={'from':_0x3f4598[_0x374deb(0x127)],'to':_0x487690[0x0][_0x374deb(0x167)],'subject':_0x374deb(0xa8),'attachments':[{'filename':_0x374deb(0xf5),'path':__dirname+'/../public'+'/upload/'+_0x15ba6e[0x0]['image'],'cid':_0x374deb(0x9e)}],'html':_0x374deb(0x99)+_0x374deb(0xef)+_0x374deb(0x11b)+_0x374deb(0x175)+_0x374deb(0x164)+_0x374deb(0x175)+_0x374deb(0x103)+_0x374deb(0x7f)+'<div>'+'<h2>\x20'+_0x15ba6e[0x0][_0x374deb(0x81)]+_0x374deb(0xbd)+_0x374deb(0x7f)+_0x374deb(0x7f)+_0x374deb(0xbe)+_0x374deb(0x175)+_0x374deb(0xca)+_0x374deb(0x104)+_0x3e1e86[_0x374deb(0x85)]+'\x20'+_0x374deb(0x124)+_0x374deb(0x119)+_0x3e1e86[_0x374deb(0x186)]+'\x20'+_0x374deb(0xba)+_0x374deb(0x166)+_0x374deb(0x7f)+_0x374deb(0x179)+_0x374deb(0xb4)+_0x374deb(0x12f)+_0x374deb(0x8e)+_0x374deb(0x11e)+_0x374deb(0x176)+_0x374deb(0xc9)+_0x374deb(0x118)+_0x374deb(0x165)+_0x374deb(0x12a)+_0x374deb(0xac)+_0x374deb(0xbf)+_0x374deb(0x156)+_0x374deb(0xbb)+'\x20'+_0x2ba6e8+'\x20'+_0x374deb(0xc7)+_0x374deb(0xd8)+'<div>'+_0x374deb(0x145)+_0x374deb(0xc1)+_0x15ba6e[0x0][_0x374deb(0x81)]+_0x374deb(0x166)+'</div>'+_0x374deb(0x7f)+_0x374deb(0xf2)};_0x1dd9f2[_0x374deb(0x8b)](_0x53394f,function(_0x245c77,_0x58af1e){var _0x36f8c1=_0x374deb;_0x245c77?(console[_0x36f8c1(0xab)](_0x245c77),console['log'](_0x36f8c1(0xc3))):console[_0x36f8c1(0xab)](_0x36f8c1(0x125));}),_0xe5c9db[_0x374deb(0x173)](_0x374deb(0x16f),'Sales\x20Update\x20successfully'),_0x483cf1['redirect'](_0x374deb(0xae)+_0x11e191);}catch(_0x360a70){console[_0x374deb(0x148)](_0x360a70),_0x483cf1['status'](0x1f4)[_0x374deb(0x115)]({'error':_0x374deb(0xa2)});}})['catch'](_0x5006cb=>{var _0x26e8ae=_0x3f1e1c;console[_0x26e8ae(0x148)](_0x5006cb),_0x483cf1['status'](0x1f4)['json']({'error':_0x26e8ae(0xd9)});});}catch(_0x4639cc){console['log'](_0x4639cc);}}),router[a0_0x3ee30d(0x14f)](a0_0x3ee30d(0x144),auth,async(_0x2a06db,_0x336ec2)=>{var _0x135317=a0_0x3ee30d;try{const {username:_0xe05ebc,email:_0xdd7f45,role:_0x8fc548}=_0x2a06db[_0x135317(0x9a)],_0x1406c7=_0x2a06db['user'],_0x1f89d3=await profile['findOne']({'email':_0x1406c7[_0x135317(0x127)]}),_0x44af45=await master_shop['find'](),_0x1d5b91=_0x2a06db['params']['id'],_0x530799=await sales_finished[_0x135317(0x12d)](_0x1d5b91);let _0x348436=new Date(_0x530799[_0x135317(0x171)]),_0xddba13=('0'+_0x348436['getDate']())[_0x135317(0x108)](-0x2),_0xe99ac6=('0'+(_0x348436[_0x135317(0x97)]()+0x1))['slice'](-0x2),_0x483519=_0x348436[_0x135317(0x100)](),_0x419629=_0x483519+'-'+_0xe99ac6+'-'+_0xddba13;var _0x331580=['Ambient',_0x135317(0xe0)];const _0x2568be=await warehouse['aggregate']([{'$match':{'name':_0x530799[_0x135317(0x16b)],'room':_0x530799['room']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x135317(0x15b)},'product_stock':{'$first':_0x135317(0xf4)},'bay':{'$first':_0x135317(0xfe)},'bin':{'$first':_0x135317(0x10d)},'type':{'$first':_0x135317(0x131)},'floorlevel':{'$first':_0x135317(0xf1)},'primary_code':{'$first':_0x135317(0x7d)},'secondary_code':{'$first':_0x135317(0x15d)},'product_code':{'$first':_0x135317(0x12b)},'storage':{'$first':_0x135317(0x11a)},'rack':{'$first':_0x135317(0x160)}}}]),_0x107cbb=await customer[_0x135317(0x14a)]({});let _0x4f8603;if(_0x1406c7['role']=='staff'){const _0x2a9988=await staff[_0x135317(0x159)]({'email':_0x1406c7[_0x135317(0x127)]});_0x4f8603=await warehouse[_0x135317(0x13e)]([{'$match':{'status':_0x135317(0x17d),'name':_0x2a9988[_0x135317(0x14c)]}},{'$group':{'_id':_0x135317(0xaa),'name':{'$first':_0x135317(0xaa)}}}]);}else _0x4f8603=await warehouse[_0x135317(0x13e)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x135317(0xaa)}}}]);const _0x3a48ec=await product[_0x135317(0x14a)]({});if(_0x44af45[0x0][_0x135317(0x10c)]==_0x135317(0x15e)){var _0x29a5a4=users[_0x135317(0x9b)];console['log'](_0x29a5a4);}else{if(_0x44af45[0x0][_0x135317(0x10c)]==_0x135317(0x178))var _0x29a5a4=users[_0x135317(0x178)];else{if(_0x44af45[0x0]['language']==_0x135317(0x107))var _0x29a5a4=users['German'];else{if(_0x44af45[0x0][_0x135317(0x10c)]==_0x135317(0xb0))var _0x29a5a4=users[_0x135317(0xb0)];else{if(_0x44af45[0x0][_0x135317(0x10c)]==_0x135317(0x88))var _0x29a5a4=users[_0x135317(0x88)];else{if(_0x44af45[0x0][_0x135317(0x10c)]=='Portuguese\x20(BR)')var _0x29a5a4=users[_0x135317(0xa4)];else{if(_0x44af45[0x0][_0x135317(0x10c)]==_0x135317(0x136))var _0x29a5a4=users[_0x135317(0x136)];else{if(_0x44af45[0x0][_0x135317(0x10c)]==_0x135317(0x151))var _0x29a5a4=users['Arabic'];}}}}}}}_0x336ec2[_0x135317(0xe9)](_0x135317(0x187),{'success':_0x2a06db['flash'](_0x135317(0x16f)),'errors':_0x2a06db[_0x135317(0x173)](_0x135317(0x10f)),'role':_0x1406c7,'profile':_0x1f89d3,'customer':_0x107cbb,'warehouse':_0x4f8603,'product':_0x2568be,'user':_0x530799,'master_shop':_0x44af45,'unit':_0x3a48ec,'language':_0x29a5a4,'rooms_data':_0x331580,'ed_fullDate':_0x419629});}catch(_0x59b95c){console['log'](_0x59b95c);}}),router[a0_0x3ee30d(0x15f)](a0_0x3ee30d(0x144),auth,async(_0x2df073,_0x2a9134)=>{var _0x46aaaf=a0_0x3ee30d;try{const _0x2afdcd=_0x2df073[_0x46aaaf(0x155)]['id'],_0x563c63=await sales_finished['findOne']({'_id':_0x2df073[_0x46aaaf(0x155)]['id']}),_0x39659d=await warehouse[_0x46aaaf(0x159)]({'name':_0x563c63['warehouse_name'],'room':_0x2df073[_0x46aaaf(0xf7)]['room'],'warehouse_category':_0x46aaaf(0x110)}),{invoice:_0x15585a,customer:_0x39021b,date:_0x574d3a,warehouse_name:_0xb67ab8,product_name:_0x529cac,stock:_0x50305a,adjust_qty:_0x4e0ef4,note:_0x4163a7,room:_0x40462e,primary_code:_0x436d2c,secondary_code:_0x38ca14,prod_code:_0x5870b7,level:_0x3cd719,isle:_0x310f6a,pallet:_0x11a027,expiry_date:_0x55c5e4}=_0x2df073[_0x46aaaf(0xf7)];if(typeof _0x529cac==_0x46aaaf(0x183))var _0x35dd14=[_0x2df073[_0x46aaaf(0xf7)]['product_name']],_0x5ad3fa=[_0x2df073[_0x46aaaf(0xf7)]['stock']],_0x32bd80=[_0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0x17f)]],_0x4d1894=[_0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0x132)]],_0x8d9a77=[_0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0xb3)]],_0x3d2568=[_0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0x149)]],_0x56cfb0=[_0x2df073['body'][_0x46aaaf(0xce)]],_0x382171=[_0x2df073[_0x46aaaf(0xf7)]['expiry_date']];else var _0x35dd14=[..._0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0x102)]],_0x5ad3fa=[..._0x2df073[_0x46aaaf(0xf7)]['stock']],_0x32bd80=[..._0x2df073['body'][_0x46aaaf(0x17f)]],_0x4d1894=[..._0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0x132)]],_0x8d9a77=[..._0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0xb3)]],_0x3d2568=[..._0x2df073['body'][_0x46aaaf(0x149)]],_0x56cfb0=[..._0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0xce)]],_0x382171=[..._0x2df073['body']['expiry_date']];const _0x44031f=_0x35dd14['map'](_0x43c566=>{return _0x43c566={'product_name':_0x43c566};});_0x5ad3fa['forEach']((_0x1efb76,_0x12a303)=>{var _0x14310d=_0x46aaaf;_0x44031f[_0x12a303][_0x14310d(0x133)]=_0x1efb76;}),_0x32bd80[_0x46aaaf(0xcc)]((_0x83c232,_0x510ee6)=>{_0x44031f[_0x510ee6]['quantity']=_0x83c232;}),_0x4d1894[_0x46aaaf(0xcc)]((_0x339224,_0x5247d0)=>{var _0x51bac9=_0x46aaaf;_0x44031f[_0x5247d0][_0x51bac9(0x132)]=_0x339224;}),_0x8d9a77[_0x46aaaf(0xcc)]((_0x20596e,_0x4060a9)=>{var _0x3e0622=_0x46aaaf;_0x44031f[_0x4060a9][_0x3e0622(0xb3)]=_0x20596e;}),_0x3d2568[_0x46aaaf(0xcc)]((_0x1976bb,_0x3fe029)=>{_0x44031f[_0x3fe029]['product_code']=_0x1976bb;}),_0x56cfb0[_0x46aaaf(0xcc)]((_0x106b0e,_0x3c3912)=>{_0x44031f[_0x3c3912]['level']=_0x106b0e;}),_0x382171['forEach']((_0x1ccb09,_0x3a7e6d)=>{var _0x13f624=_0x46aaaf;_0x44031f[_0x3a7e6d][_0x13f624(0x171)]=_0x1ccb09;});var _0x199e2f=0x0;_0x44031f[_0x46aaaf(0xcc)](_0x1e990b=>{var _0x4b38a2=_0x46aaaf;console[_0x4b38a2(0xab)]('foreach\x20newproduct',_0x1e990b),(parseInt(_0x1e990b[_0x4b38a2(0x133)])<parseInt(_0x1e990b[_0x4b38a2(0xd1)])||parseInt(_0x1e990b[_0x4b38a2(0xd1)])==0x0)&&_0x199e2f++;});if(_0x199e2f!=0x0)return _0x2df073[_0x46aaaf(0x173)](_0x46aaaf(0x10f),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2a9134[_0x46aaaf(0xc0)](_0x46aaaf(0xda));_0x563c63['sale_product'][_0x46aaaf(0xcc)](_0x398826=>{var _0x295eaa=_0x46aaaf;const _0xde395d=_0x39659d[_0x295eaa(0xe1)][_0x295eaa(0x17b)](_0x506cbd=>{var _0x293326=_0x295eaa;_0x506cbd[_0x293326(0x102)]==_0x398826[_0x293326(0x102)]&&_0x506cbd[_0x293326(0xfc)]==_0x398826['bay']&&(_0x506cbd[_0x293326(0xe8)]=parseInt(_0x506cbd[_0x293326(0xe8)])+parseInt(_0x398826[_0x293326(0xd1)]));});}),await _0x39659d[_0x46aaaf(0xe5)]();const _0x43b4de=_0x44031f[_0x46aaaf(0x109)](_0x1e7788=>_0x1e7788[_0x46aaaf(0xd1)]!=='0'&&_0x1e7788[_0x46aaaf(0xd1)]!=='');_0x563c63[_0x46aaaf(0x85)]=_0x15585a,_0x563c63[_0x46aaaf(0x76)]=_0x39021b,_0x563c63[_0x46aaaf(0x186)]=_0x574d3a,_0x563c63[_0x46aaaf(0x16b)]=_0xb67ab8,_0x563c63['sale_product']=_0x43b4de,_0x563c63[_0x46aaaf(0xd2)]=_0x4163a7,_0x563c63[_0x46aaaf(0x7a)]=_0x40462e;const _0x5a2a39=await _0x563c63[_0x46aaaf(0xe5)](),_0x5cde28=await sales_finished[_0x46aaaf(0x159)]({'_id':_0x2df073[_0x46aaaf(0x155)]['id']}),_0xe4b2f3=await warehouse[_0x46aaaf(0x159)]({'name':_0xb67ab8,'room':_0x40462e,'warehouse_category':_0x46aaaf(0x110)});_0x5cde28[_0x46aaaf(0xde)][_0x46aaaf(0xcc)](_0x5f4425=>{var _0x5245c7=_0x46aaaf;const _0xd1803b=_0xe4b2f3[_0x5245c7(0xe1)][_0x5245c7(0x17b)](_0x28eac7=>{var _0x55ba3f=_0x5245c7;_0x28eac7[_0x55ba3f(0x102)]==_0x5f4425[_0x55ba3f(0x102)]&&_0x28eac7[_0x55ba3f(0xfc)]==_0x5f4425[_0x55ba3f(0xfc)]&&(_0x28eac7['product_stock']=parseInt(_0x28eac7[_0x55ba3f(0xe8)])-parseInt(_0x5f4425[_0x55ba3f(0xd1)]));});}),console[_0x46aaaf(0xab)]('final',_0xe4b2f3),await _0xe4b2f3[_0x46aaaf(0xe5)]();const _0x5a874=await c_payment_data[_0x46aaaf(0x159)]({'invoice':_0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0x85)]});_0x5a874['suppliers']=_0x2df073[_0x46aaaf(0xf7)][_0x46aaaf(0xc8)],await _0x5a874[_0x46aaaf(0xe5)](),_0x2df073[_0x46aaaf(0x173)](_0x46aaaf(0x16f),'Sales\x20Update\x20successfully'),_0x2a9134[_0x46aaaf(0xc0)](_0x46aaaf(0xfa));}catch(_0x44e8b5){console['log'](_0x44e8b5);}}),router[a0_0x3ee30d(0x15f)](a0_0x3ee30d(0x8a),auth,async(_0x527b9a,_0x5a946c)=>{var _0x3948f6=a0_0x3ee30d;try{const _0xd1f6b6=_0x527b9a['params']['id'],{invoice:_0x349514,customer:_0x1159be,receivable_amount:_0x1b162a,received_amount:_0x16a9d8}=_0x527b9a['body'],_0x5bdf9e=await sales[_0x3948f6(0x12d)](_0xd1f6b6);console[_0x3948f6(0xab)](_0x5bdf9e);var _0x2577db=_0x1b162a-_0x16a9d8;console[_0x3948f6(0xab)](_0x16a9d8),_0x5bdf9e[_0x3948f6(0x170)]=parseFloat(_0x16a9d8)+parseFloat(_0x5bdf9e['received_amount']),_0x5bdf9e[_0x3948f6(0x101)]=_0x2577db,console[_0x3948f6(0xab)](_0x5bdf9e);const _0x3d57da=await _0x5bdf9e['save'](),_0x112349=await c_payment_data[_0x3948f6(0x159)]({'invoice':_0x349514});_0x112349[_0x3948f6(0x181)]=_0x2577db,await _0x112349[_0x3948f6(0xe5)]();let _0x289e40=new Date(),_0x39aa33=('0'+_0x289e40[_0x3948f6(0x140)]())[_0x3948f6(0x108)](-0x2),_0x7b107d=('0'+(_0x289e40['getMonth']()+0x1))['slice'](-0x2),_0x42354b=_0x289e40[_0x3948f6(0x100)](),_0x5661aa=_0x42354b+'-'+_0x7b107d+'-'+_0x39aa33;const _0x15c6e0=new customer_payment({'invoice':_0x349514,'date':_0x42354b+'-'+_0x7b107d+'-'+_0x39aa33,'customer':_0x1159be,'reason':_0x3948f6(0x162),'amount':_0x16a9d8}),_0x502819=await _0x15c6e0['save']();_0x527b9a[_0x3948f6(0x173)]('success',_0x3948f6(0x114)),_0x5a946c[_0x3948f6(0xc0)](_0x3948f6(0xcd));}catch(_0xb5327b){console['log'](_0xb5327b);}}),router['get'](a0_0x3ee30d(0x91),auth,async(_0x7d062b,_0x15d6d0)=>{var _0x5376d6=a0_0x3ee30d;try{const {username:_0x338287,email:_0x4037f5,role:_0x22b2a2}=_0x7d062b[_0x5376d6(0x9a)],_0x30cb26=_0x7d062b[_0x5376d6(0x9a)],_0x132a32=await profile[_0x5376d6(0x159)]({'email':_0x30cb26[_0x5376d6(0x127)]}),_0x38530e=await master_shop[_0x5376d6(0x14a)]();console[_0x5376d6(0xab)]('master',_0x38530e);const _0x2de013=_0x7d062b[_0x5376d6(0x155)]['id'],_0x5ce633=await sales['findById'](_0x2de013);console[_0x5376d6(0xab)](_0x5ce633);const _0x524a5d=await customer[_0x5376d6(0x159)]({'name':_0x5ce633[_0x5376d6(0x76)]});console[_0x5376d6(0xab)](_0x524a5d);if(_0x38530e[0x0][_0x5376d6(0x10c)]=='English\x20(US)'){var _0x13a049=users[_0x5376d6(0x9b)];console[_0x5376d6(0xab)](_0x13a049);}else{if(_0x38530e[0x0][_0x5376d6(0x10c)]==_0x5376d6(0x178))var _0x13a049=users[_0x5376d6(0x178)];else{if(_0x38530e[0x0]['language']==_0x5376d6(0x107))var _0x13a049=users[_0x5376d6(0x107)];else{if(_0x38530e[0x0][_0x5376d6(0x10c)]==_0x5376d6(0xb0))var _0x13a049=users[_0x5376d6(0xb0)];else{if(_0x38530e[0x0][_0x5376d6(0x10c)]==_0x5376d6(0x88))var _0x13a049=users[_0x5376d6(0x88)];else{if(_0x38530e[0x0][_0x5376d6(0x10c)]=='Portuguese\x20(BR)')var _0x13a049=users[_0x5376d6(0xa4)];else{if(_0x38530e[0x0][_0x5376d6(0x10c)]==_0x5376d6(0x136))var _0x13a049=users[_0x5376d6(0x136)];else{if(_0x38530e[0x0][_0x5376d6(0x10c)]==_0x5376d6(0x151))var _0x13a049=users[_0x5376d6(0xf9)];}}}}}}}_0x15d6d0[_0x5376d6(0xe9)](_0x5376d6(0xfd),{'success':_0x7d062b[_0x5376d6(0x173)](_0x5376d6(0x16f)),'errors':_0x7d062b[_0x5376d6(0x173)]('errors'),'role':_0x30cb26,'profile':_0x132a32,'master_shop':_0x38530e,'customers':_0x524a5d,'sales':_0x5ce633,'language':_0x13a049});}catch(_0x2b0140){console['log'](_0x2b0140);}}),router[a0_0x3ee30d(0x14f)](a0_0x3ee30d(0xfb),auth,async(_0x42d96b,_0x581806)=>{var _0x15dba9=a0_0x3ee30d;try{const {username:_0x3a2539,email:_0x28cf7e,role:_0x35b97f}=_0x42d96b[_0x15dba9(0x9a)],_0x56217b=_0x42d96b['user'],_0x405db5=await profile[_0x15dba9(0x159)]({'email':_0x56217b[_0x15dba9(0x127)]}),_0x15adbd=await master_shop[_0x15dba9(0x14a)](),_0x17dd5e=_0x42d96b[_0x15dba9(0x155)]['id'],_0x578aa0=await sales_finished[_0x15dba9(0x12d)](_0x17dd5e),_0x361fa2=await warehouse['aggregate']([{'$match':{'name':_0x578aa0[_0x15dba9(0x16b)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x15dba9(0xf4)},'bay':{'$first':_0x15dba9(0xfe)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x15dba9(0x131)},'floorlevel':{'$first':_0x15dba9(0xf1)},'primary_code':{'$first':_0x15dba9(0x7d)},'secondary_code':{'$first':_0x15dba9(0x15d)},'product_code':{'$first':_0x15dba9(0x12b)},'storage':{'$first':_0x15dba9(0x11a)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x15dba9(0x7c)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x15dba9(0xdc)},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x15dba9(0x121)}}}]),_0x36fbf8=await product['find']({}),_0x448ef1=await warehouse[_0x15dba9(0x13e)]([{'$match':{'status':_0x15dba9(0x17d),'warehouse_category':_0x15dba9(0x110),'name':{'$ne':_0x15dba9(0x126),'$ne':_0x15dba9(0xc2)}}},{'$group':{'_id':_0x15dba9(0xaa),'name':{'$first':_0x15dba9(0xaa)}}},{'$sort':{'name':0x1}}]);var _0x372fa4=[_0x15dba9(0xe2)];const _0x13df67=await warehouse[_0x15dba9(0x13e)]([{'$match':{'status':'Enabled','name':_0x15dba9(0xc2)}},{'$group':{'_id':'$name','name':{'$first':_0x15dba9(0xaa)}}},{'$sort':{'name':0x1}}]);if(_0x15adbd[0x0][_0x15dba9(0x10c)]=='English\x20(US)'){var _0x4b066b=users[_0x15dba9(0x9b)];console[_0x15dba9(0xab)](_0x4b066b);}else{if(_0x15adbd[0x0]['language']=='Hindi')var _0x4b066b=users[_0x15dba9(0x178)];else{if(_0x15adbd[0x0][_0x15dba9(0x10c)]=='German')var _0x4b066b=users[_0x15dba9(0x107)];else{if(_0x15adbd[0x0][_0x15dba9(0x10c)]==_0x15dba9(0xb0))var _0x4b066b=users[_0x15dba9(0xb0)];else{if(_0x15adbd[0x0][_0x15dba9(0x10c)]==_0x15dba9(0x88))var _0x4b066b=users[_0x15dba9(0x88)];else{if(_0x15adbd[0x0][_0x15dba9(0x10c)]==_0x15dba9(0xeb))var _0x4b066b=users['Portuguese'];else{if(_0x15adbd[0x0][_0x15dba9(0x10c)]==_0x15dba9(0x136))var _0x4b066b=users[_0x15dba9(0x136)];else{if(_0x15adbd[0x0][_0x15dba9(0x10c)]==_0x15dba9(0x151))var _0x4b066b=users[_0x15dba9(0xf9)];}}}}}}}_0x581806['render'](_0x15dba9(0xd0),{'success':_0x42d96b[_0x15dba9(0x173)](_0x15dba9(0x16f)),'errors':_0x42d96b['flash']('errors'),'role':_0x56217b,'profile':_0x405db5,'user':_0x578aa0,'stock':_0x361fa2,'master_shop':_0x15adbd,'unit':_0x36fbf8,'language':_0x4b066b,'warehouses':_0x448ef1,'rooms':_0x372fa4,'warehouse_QA':_0x13df67});}catch(_0x5951b0){console['log'](_0x5951b0),_0x581806[_0x15dba9(0x180)](0xc8)[_0x15dba9(0x115)]({'message':_0x5951b0[_0x15dba9(0xc5)]});}}),router[a0_0x3ee30d(0x15f)](a0_0x3ee30d(0xfb),auth,async(_0x2c1541,_0x6d114d)=>{var _0x30b78a=a0_0x3ee30d;if(_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x9c)]=='QA')try{const {invoice:_0x50256e,date:_0x27bdd2,warehouse_name:_0x14c914,product_name:_0x2ca787,primary_code:_0x4b6a14,secondary_code:_0x5d4d1b,product_code:_0x5b1764,sales_quantity:_0x2f3d8f,stocks:_0x198729,return_qty:_0x4e70c0,Room_name:_0x6b2c9f,to_warehouse_name_QA:_0x2530c1,to_Room_name_QA:_0x3e0b6c,note:_0xd7dfa3,for_categorize:_0x391e0f,product_name_QA1:_0x1dc25f}=_0x2c1541[_0x30b78a(0xf7)];if(typeof _0x1dc25f==_0x30b78a(0x183))var _0x38473d=[_0x2c1541[_0x30b78a(0xf7)]['product_name_QA1']],_0x5e2f03=[_0x2c1541[_0x30b78a(0xf7)]['primary_code_QA']],_0x13a42f=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x17e)]],_0x55a001=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x84)]],_0xb32c5d=[_0x2c1541[_0x30b78a(0xf7)]['sales_quantity_QA']],_0x20f99f=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x169)]],_0x3caba7=[_0x2c1541['body'][_0x30b78a(0x12e)]],_0x496604=[_0x2c1541['body'][_0x30b78a(0x141)]],_0x5bd97f=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x10e)]],_0x183907=[_0x2c1541['body'][_0x30b78a(0xb9)]],_0x36cd09=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x161)]],_0x1053cc=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x11d)]],_0x24fb66=[_0x2c1541[_0x30b78a(0xf7)]['production_date_QA']],_0x16b7c5=[_0x2c1541[_0x30b78a(0xf7)]['expiry_date_QA']];else var _0x38473d=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0xa0)]],_0x5e2f03=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x13b)]],_0x13a42f=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x17e)]],_0x55a001=[..._0x2c1541[_0x30b78a(0xf7)]['product_code_QA']],_0xb32c5d=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x16e)]],_0x20f99f=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x169)]],_0x3caba7=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x12e)]],_0x496604=[..._0x2c1541[_0x30b78a(0xf7)]['maxPerUnit_QA']],_0x5bd97f=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x10e)]],_0x183907=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0xb9)]],_0x36cd09=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x161)]],_0x1053cc=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x11d)]],_0x24fb66=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x10b)]],_0x16b7c5=[..._0x2c1541['body'][_0x30b78a(0xe7)]];const _0x1b944d=_0x38473d[_0x30b78a(0x17b)](_0x5dbec1=>{return _0x5dbec1={'product_name':_0x5dbec1};});_0x5e2f03['forEach']((_0x42d862,_0x309c47)=>{var _0x5885bb=_0x30b78a;_0x1b944d[_0x309c47][_0x5885bb(0x132)]=_0x42d862;}),_0x13a42f[_0x30b78a(0xcc)]((_0xe2ca4c,_0x17c1a3)=>{var _0x57b3f0=_0x30b78a;_0x1b944d[_0x17c1a3][_0x57b3f0(0xb3)]=_0xe2ca4c;}),_0x55a001[_0x30b78a(0xcc)]((_0x132814,_0x3e69af)=>{var _0x5a8daa=_0x30b78a;_0x1b944d[_0x3e69af][_0x5a8daa(0x143)]=_0x132814;}),_0xb32c5d['forEach']((_0x7e2674,_0x47f506)=>{var _0xeed28d=_0x30b78a;_0x1b944d[_0x47f506][_0xeed28d(0xf6)]=_0x7e2674;}),_0x20f99f[_0x30b78a(0xcc)]((_0x4ada11,_0x376428)=>{_0x1b944d[_0x376428]['stock']=_0x4ada11;}),_0x3caba7[_0x30b78a(0xcc)]((_0xa84794,_0x179cfe)=>{var _0x17e263=_0x30b78a;_0x1b944d[_0x179cfe][_0x17e263(0x8d)]=_0xa84794;}),_0x496604['forEach']((_0x230450,_0x5a267c)=>{_0x1b944d[_0x5a267c]['maxPerUnit']=_0x230450;}),_0x5bd97f[_0x30b78a(0xcc)]((_0xe0d1c3,_0x55a37b)=>{var _0x569f62=_0x30b78a;_0x1b944d[_0x55a37b][_0x569f62(0xe6)]=_0xe0d1c3;}),_0x183907[_0x30b78a(0xcc)]((_0x475d53,_0x407bdc)=>{var _0xe17399=_0x30b78a;_0x1b944d[_0x407bdc][_0xe17399(0x96)]=_0x475d53;}),_0x36cd09['forEach']((_0x2f1991,_0x1b4001)=>{var _0x983fae=_0x30b78a;_0x1b944d[_0x1b4001][_0x983fae(0x15a)]=_0x2f1991;}),_0x1053cc[_0x30b78a(0xcc)]((_0x151370,_0x3e3617)=>{var _0x41dd46=_0x30b78a;_0x1b944d[_0x3e3617][_0x41dd46(0x83)]=_0x151370;}),_0x24fb66[_0x30b78a(0xcc)]((_0x5944ce,_0x1d7bf4)=>{var _0x269053=_0x30b78a;_0x1b944d[_0x1d7bf4][_0x269053(0x112)]=_0x5944ce;}),_0x16b7c5['forEach']((_0x38bca9,_0x11e999)=>{_0x1b944d[_0x11e999]['expiry_date']=_0x38bca9;});const _0x38d171=await sales_finished[_0x30b78a(0x159)]({'invoice':_0x50256e});_0x38d171[_0x30b78a(0x177)]=_0x30b78a(0x168);const _0x4600=await _0x38d171[_0x30b78a(0xe5)](),_0x3af1c5=new sales_return_finished({'invoice':_0x50256e,'customer':_0x2c1541['body'][_0x30b78a(0x76)],'date':_0x27bdd2,'warehouse_name':_0x14c914,'room':_0x6b2c9f,'ToWarehouse':_0x2530c1,'ToRoom':_0x3e0b6c,'return_sale_QA':_0x1b944d,'note':_0xd7dfa3,'warehouse_cat':_0x391e0f}),_0x571df4=await _0x3af1c5[_0x30b78a(0xe5)](),_0x2ba461=await sales_return_finished[_0x30b78a(0x159)]({'invoice':_0x50256e}),_0x35e602=await warehouse['findOne']({'name':_0x2530c1,'room':_0x3e0b6c});_0x2ba461[_0x30b78a(0x142)][_0x30b78a(0xcc)](_0x2b416f=>{var _0x137313=_0x30b78a,_0x29e36c=0x0;const _0x1c5100=_0x35e602[_0x137313(0xe1)][_0x137313(0x17b)](_0x121734=>{var _0x6a537a=_0x137313;_0x121734[_0x6a537a(0x102)]==_0x2b416f['product_name']&&_0x121734[_0x6a537a(0x171)]==_0x2b416f[_0x6a537a(0x171)]&&_0x121734[_0x6a537a(0x112)]==_0x2b416f[_0x6a537a(0x112)]&&_0x121734[_0x6a537a(0x96)]==_0x2b416f[_0x6a537a(0x96)]&&(_0x121734[_0x6a537a(0xe8)]=parseInt(_0x121734[_0x6a537a(0xe8)])+parseInt(_0x2b416f[_0x6a537a(0x8d)]),_0x29e36c++);});_0x29e36c=='0'&&(_0x35e602[_0x137313(0xe1)]=_0x35e602[_0x137313(0xe1)][_0x137313(0x9d)]({'product_name':_0x2b416f[_0x137313(0x102)],'product_stock':_0x2b416f[_0x137313(0x8d)],'primary_code':_0x2b416f[_0x137313(0x132)],'secondary_code':_0x2b416f['secondary_code'],'product_code':_0x2b416f[_0x137313(0x143)],'batch_code':_0x2b416f[_0x137313(0x96)],'maxPerUnit':_0x2b416f[_0x137313(0x106)],'production_date':_0x2b416f['production_date'],'expiry_date':_0x2b416f[_0x137313(0x171)],'secondary_unit':_0x2b416f[_0x137313(0x15a)],'unit':_0x2b416f[_0x137313(0x83)],'maxProducts':_0x2b416f[_0x137313(0xe6)],'bay':_0x2b416f[_0x137313(0xfc)]}));}),await _0x35e602[_0x30b78a(0xe5)]();const _0x82585d=new c_payment_data({'invoice':_0x50256e,'customer':_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x76)],'reason':_0x30b78a(0x74)});await _0x82585d[_0x30b78a(0xe5)]();const _0x49a07a=await master_shop['find'](),_0x5581f8=await email_settings[_0x30b78a(0x159)](),_0x827b30=await customer[_0x30b78a(0x159)]({'name':_0x2c1541[_0x30b78a(0xf7)]['customer']});_0x49a07a[0x0][_0x30b78a(0x135)]==0x1?(right_currency=_0x49a07a[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x49a07a[0x0][_0x30b78a(0x120)]);var _0x4f945b=_0x38473d,_0x73b846=_0x3caba7,_0x43eafa='',_0x3f7a2f;for(_0x3f7a2f in _0x4f945b){_0x43eafa+='<tr>'+_0x30b78a(0x16d)+_0x4f945b[_0x3f7a2f]+_0x30b78a(0x138)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x73b846[_0x3f7a2f]+'</td>'+_0x30b78a(0xbf);}console[_0x30b78a(0xab)](_0x30b78a(0xa9),_0x43eafa);let _0x28fc80=nodemailer[_0x30b78a(0xb2)]({'service':'gmail','auth':{'user':_0x5581f8['email'],'pass':_0x5581f8[_0x30b78a(0xcf)]}}),_0x4b409b={'from':_0x5581f8[_0x30b78a(0x127)],'to':_0x827b30[_0x30b78a(0x127)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x30b78a(0xf5),'path':__dirname+_0x30b78a(0x15c)+_0x30b78a(0xa7)+_0x49a07a[0x0]['image'],'cid':_0x30b78a(0x9e)}],'html':_0x30b78a(0x99)+_0x30b78a(0xef)+_0x30b78a(0x11b)+_0x30b78a(0x175)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x30b78a(0x175)+_0x30b78a(0x103)+_0x30b78a(0x7f)+_0x30b78a(0x175)+_0x30b78a(0xdd)+_0x49a07a[0x0][_0x30b78a(0x81)]+_0x30b78a(0xbd)+_0x30b78a(0x7f)+_0x30b78a(0x7f)+_0x30b78a(0xbe)+_0x30b78a(0x175)+_0x30b78a(0xca)+_0x30b78a(0x104)+_0x50256e+'\x20'+_0x30b78a(0x124)+'\x20Order\x20Date\x20:\x20'+_0x27bdd2+'\x20'+_0x30b78a(0xba)+_0x30b78a(0x166)+_0x30b78a(0x7f)+_0x30b78a(0x179)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x30b78a(0x12f)+_0x30b78a(0x8e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x30b78a(0xb8)+_0x30b78a(0xea)+_0x30b78a(0xbf)+_0x30b78a(0x156)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x43eafa+'\x20'+_0x30b78a(0xc7)+_0x30b78a(0xd8)+'<div>'+_0x30b78a(0x145)+_0x30b78a(0xc1)+_0x49a07a[0x0]['site_title']+_0x30b78a(0x166)+'</div>'+_0x30b78a(0x7f)+_0x30b78a(0xf2)};_0x28fc80[_0x30b78a(0x8b)](_0x4b409b,function(_0x57e852,_0x26a2c9){var _0x515bfe=_0x30b78a;_0x57e852?(console['log'](_0x57e852),console[_0x515bfe(0xab)]('Error\x20Occurs')):console[_0x515bfe(0xab)](_0x515bfe(0x125));}),_0x2c1541['flash'](_0x30b78a(0x16f),_0x30b78a(0x10a)),_0x6d114d[_0x30b78a(0xc0)](_0x30b78a(0xfa));}catch(_0x9c8636){_0x6d114d[_0x30b78a(0x180)](0xc8)['json']({'message1':_0x9c8636[_0x30b78a(0xc5)]});}else{if(_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x9c)]=='GS')try{const {invoice:_0x5aa327,date:_0xd32d,warehouse_name:_0x28086d,product_name:_0x23b899,primary_code:_0x234de7,secondary_code:_0xf1fa0d,product_code:_0x5b1653,sales_quantity:_0x3ee6d1,stocks:_0x486fe6,return_qty:_0x4ba069,Room_name:_0x11f0a2,to_warehouse_name:_0x153a73,to_Room_name:_0xafb165,note:_0x1d3210,level:_0x3d0eb1,isle:_0x196f9e,pallet:_0x12fdea,for_categorize:_0x16b460}=_0x2c1541[_0x30b78a(0xf7)];if(typeof _0x23b899==_0x30b78a(0x183))var _0x38473d=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x102)]],_0x5e2f03=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x132)]],_0x13a42f=[_0x2c1541['body'][_0x30b78a(0xb3)]],_0x55a001=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x143)]],_0xb32c5d=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x8c)]],_0x3caba7=[_0x2c1541[_0x30b78a(0xf7)]['return_qty']],_0x57ddbe=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0xfc)]],_0x496604=[_0x2c1541[_0x30b78a(0xf7)]['maxPerUnit']],_0x5bd97f=[_0x2c1541['body']['maxProducts']],_0x183907=[_0x2c1541['body'][_0x30b78a(0x96)]],_0x36cd09=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x15a)]],_0x1053cc=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x83)]],_0x24fb66=[_0x2c1541['body']['production_date']],_0x16b7c5=[_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x171)]];else var _0x38473d=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x102)]],_0x5e2f03=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x132)]],_0x13a42f=[..._0x2c1541['body'][_0x30b78a(0xb3)]],_0x55a001=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x143)]],_0xb32c5d=[..._0x2c1541[_0x30b78a(0xf7)]['sales_quantity']],_0x3caba7=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x8d)]],_0x57ddbe=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0xfc)]],_0x496604=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x106)]],_0x5bd97f=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0xe6)]],_0x183907=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x96)]],_0x36cd09=[..._0x2c1541['body'][_0x30b78a(0x15a)]],_0x1053cc=[..._0x2c1541['body'][_0x30b78a(0x83)]],_0x24fb66=[..._0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x112)]],_0x16b7c5=[..._0x2c1541['body'][_0x30b78a(0x171)]];const _0x5dc7e5=_0x38473d[_0x30b78a(0x17b)](_0x5d745d=>{return _0x5d745d={'product_name':_0x5d745d};});_0x5e2f03[_0x30b78a(0xcc)]((_0x53ab85,_0x3895d3)=>{var _0x4d105d=_0x30b78a;_0x5dc7e5[_0x3895d3][_0x4d105d(0x132)]=_0x53ab85;}),_0x13a42f['forEach']((_0x3de920,_0x10712c)=>{var _0x1b5e48=_0x30b78a;_0x5dc7e5[_0x10712c][_0x1b5e48(0xb3)]=_0x3de920;}),_0x55a001['forEach']((_0x37c2a8,_0x261681)=>{var _0x555f3b=_0x30b78a;_0x5dc7e5[_0x261681][_0x555f3b(0x143)]=_0x37c2a8;}),_0xb32c5d[_0x30b78a(0xcc)]((_0xb7efc7,_0x4a3316)=>{var _0x2448eb=_0x30b78a;_0x5dc7e5[_0x4a3316][_0x2448eb(0xf6)]=_0xb7efc7;}),_0x3caba7[_0x30b78a(0xcc)]((_0x5670a7,_0xcf8c01)=>{var _0x46178f=_0x30b78a;_0x5dc7e5[_0xcf8c01][_0x46178f(0x8d)]=_0x5670a7;}),_0x57ddbe[_0x30b78a(0xcc)]((_0x42185c,_0x187e26)=>{var _0x243f4d=_0x30b78a;_0x5dc7e5[_0x187e26][_0x243f4d(0xfc)]=_0x42185c;}),_0x496604[_0x30b78a(0xcc)]((_0x1af35e,_0x46157a)=>{_0x5dc7e5[_0x46157a]['maxPerUnit']=_0x1af35e;}),_0x5bd97f[_0x30b78a(0xcc)]((_0x329bf2,_0x11c119)=>{_0x5dc7e5[_0x11c119]['maxProducts']=_0x329bf2;}),_0x183907[_0x30b78a(0xcc)]((_0x359c35,_0x56ad79)=>{var _0x4c11e3=_0x30b78a;_0x5dc7e5[_0x56ad79][_0x4c11e3(0x96)]=_0x359c35;}),_0x36cd09[_0x30b78a(0xcc)]((_0x2af8b9,_0x42af37)=>{var _0x353af3=_0x30b78a;_0x5dc7e5[_0x42af37][_0x353af3(0x15a)]=_0x2af8b9;}),_0x1053cc[_0x30b78a(0xcc)]((_0x255e33,_0x1c9c3a)=>{_0x5dc7e5[_0x1c9c3a]['unit']=_0x255e33;}),_0x24fb66[_0x30b78a(0xcc)]((_0x1ecede,_0x24b5ef)=>{var _0x234ab5=_0x30b78a;_0x5dc7e5[_0x24b5ef][_0x234ab5(0x112)]=_0x1ecede;}),_0x16b7c5[_0x30b78a(0xcc)]((_0x5d354c,_0x3da8ca)=>{var _0x3d2943=_0x30b78a;_0x5dc7e5[_0x3da8ca][_0x3d2943(0x171)]=_0x5d354c;});var _0x49a88d=0x0;_0x5dc7e5[_0x30b78a(0xcc)](_0x53fed9=>{var _0x5cbc7a=_0x30b78a;(parseInt(_0x53fed9[_0x5cbc7a(0xf6)])<parseInt(_0x53fed9[_0x5cbc7a(0x8d)])||parseInt(_0x53fed9[_0x5cbc7a(0x133)])<parseInt(_0x53fed9[_0x5cbc7a(0x8d)])&&parseInt(_0x53fed9[_0x5cbc7a(0xf6)])>parseInt(_0x53fed9[_0x5cbc7a(0x8d)])||parseInt(_0x53fed9[_0x5cbc7a(0x8d)])==0x0)&&_0x49a88d++;});if(_0x49a88d!=0x0)return _0x2c1541[_0x30b78a(0x173)](_0x30b78a(0x10f),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x6d114d['redirect']('back');const _0x1ee3d9=await sales_finished['findOne']({'invoice':_0x5aa327});_0x1ee3d9[_0x30b78a(0x177)]='True';const _0x5a1192=await _0x1ee3d9['save'](),_0x56b385=new sales_return_finished({'invoice':_0x5aa327,'customer':_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x76)],'date':_0xd32d,'warehouse_name':_0x28086d,'room':_0x11f0a2,'ToWarehouse':_0x153a73,'ToRoom':_0xafb165,'return_sale':_0x5dc7e5,'note':_0x1d3210,'warehouse_cat':_0x16b460}),_0xc79a70=await _0x56b385[_0x30b78a(0xe5)](),_0x3e2259=await sales_return_finished[_0x30b78a(0x159)]({'invoice':_0x5aa327}),_0x1adef3=await warehouse[_0x30b78a(0x159)]({'name':_0x153a73,'room':_0xafb165,'warehouse_category':_0x30b78a(0x110)});_0x3e2259['return_sale']['forEach'](_0x2810bd=>{var _0xa84321=_0x30b78a,_0x57e534=0x0;const _0x599b56=_0x1adef3[_0xa84321(0xe1)][_0xa84321(0x17b)](_0x263899=>{var _0x49599d=_0xa84321;_0x263899[_0x49599d(0x102)]==_0x2810bd[_0x49599d(0x102)]&&_0x263899[_0x49599d(0xfc)]==_0x2810bd[_0x49599d(0xfc)]&&_0x263899[_0x49599d(0x171)]==_0x2810bd['expiry_date']&&_0x263899[_0x49599d(0x112)]==_0x2810bd['production_date']&&_0x263899['batch_code']==_0x2810bd['batch_code']&&(_0x263899[_0x49599d(0xe8)]=parseInt(_0x263899[_0x49599d(0xe8)])+parseInt(_0x2810bd[_0x49599d(0x8d)]),_0x57e534++);});_0x57e534=='0'&&(_0x1adef3['product_details']=_0x1adef3['product_details']['concat']({'product_name':_0x2810bd[_0xa84321(0x102)],'product_stock':_0x2810bd[_0xa84321(0x8d)],'primary_code':_0x2810bd[_0xa84321(0x132)],'secondary_code':_0x2810bd[_0xa84321(0xb3)],'product_code':_0x2810bd[_0xa84321(0x143)],'bay':_0x2810bd[_0xa84321(0xfc)],'batch_code':_0x2810bd['batch_code'],'maxPerUnit':_0x2810bd[_0xa84321(0x106)],'production_date':_0x2810bd[_0xa84321(0x112)],'expiry_date':_0x2810bd[_0xa84321(0x171)],'secondary_unit':_0x2810bd[_0xa84321(0x15a)],'unit':_0x2810bd[_0xa84321(0x83)],'maxProducts':_0x2810bd[_0xa84321(0xe6)]}));}),await _0x1adef3[_0x30b78a(0xe5)](),console[_0x30b78a(0xab)](_0x2c1541['body']);const _0x13c04a=new c_payment_data({'invoice':_0x5aa327,'customer':_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x76)],'reason':_0x30b78a(0x74)});await _0x13c04a[_0x30b78a(0xe5)]();const _0x33c7c1=await master_shop['find']();console['log'](_0x30b78a(0x7e),_0x33c7c1[0x0][_0x30b78a(0x172)]);const _0x5b6565=await email_settings[_0x30b78a(0x159)](),_0x2dbb52=await customer[_0x30b78a(0x159)]({'name':_0x2c1541[_0x30b78a(0xf7)][_0x30b78a(0x76)]});console['log'](_0x30b78a(0xc4),_0x2dbb52);_0x33c7c1[0x0][_0x30b78a(0x135)]==0x1?(right_currency=_0x33c7c1[0x0][_0x30b78a(0x120)],left_currency=''):(right_currency='',left_currency=_0x33c7c1[0x0][_0x30b78a(0x120)]);var _0x4f945b=_0x38473d,_0x73b846=_0x3caba7,_0x43eafa='',_0x3f7a2f;for(_0x3f7a2f in _0x4f945b){_0x43eafa+=_0x30b78a(0x12f)+_0x30b78a(0x16d)+_0x4f945b[_0x3f7a2f]+_0x30b78a(0x138)+_0x30b78a(0x16d)+_0x73b846[_0x3f7a2f]+_0x30b78a(0x138)+_0x30b78a(0xbf);}console[_0x30b78a(0xab)](_0x30b78a(0xa9),_0x43eafa);let _0x38a22e=nodemailer[_0x30b78a(0xb2)]({'service':_0x30b78a(0x13c),'auth':{'user':_0x5b6565['email'],'pass':_0x5b6565['password']}}),_0x5f1248={'from':_0x5b6565[_0x30b78a(0x127)],'to':_0x2dbb52[_0x30b78a(0x127)],'subject':_0x30b78a(0x89),'attachments':[{'filename':_0x30b78a(0xf5),'path':__dirname+_0x30b78a(0x15c)+_0x30b78a(0xa7)+_0x33c7c1[0x0][_0x30b78a(0x172)],'cid':_0x30b78a(0x9e)}],'html':_0x30b78a(0x99)+_0x30b78a(0xef)+_0x30b78a(0x11b)+_0x30b78a(0x175)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x30b78a(0x103)+_0x30b78a(0x7f)+_0x30b78a(0x175)+_0x30b78a(0xdd)+_0x33c7c1[0x0]['site_title']+_0x30b78a(0xbd)+_0x30b78a(0x7f)+_0x30b78a(0x7f)+_0x30b78a(0xbe)+_0x30b78a(0x175)+_0x30b78a(0xca)+'\x20Order\x20Number\x20:\x20'+_0x5aa327+'\x20'+_0x30b78a(0x124)+_0x30b78a(0x119)+_0xd32d+'\x20'+_0x30b78a(0xba)+_0x30b78a(0x166)+_0x30b78a(0x7f)+_0x30b78a(0x179)+_0x30b78a(0xb4)+_0x30b78a(0x12f)+_0x30b78a(0x8e)+_0x30b78a(0x87)+_0x30b78a(0xb8)+_0x30b78a(0xea)+_0x30b78a(0xbf)+'</thead>'+_0x30b78a(0xbb)+'\x20'+_0x43eafa+'\x20'+'</tbody>'+_0x30b78a(0xd8)+_0x30b78a(0x175)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x33c7c1[0x0][_0x30b78a(0x81)]+_0x30b78a(0x166)+'</div>'+_0x30b78a(0x7f)+'</body></html>'};_0x38a22e[_0x30b78a(0x8b)](_0x5f1248,function(_0x4c701e,_0x2c3c36){var _0x395bcf=_0x30b78a;_0x4c701e?(console[_0x395bcf(0xab)](_0x4c701e),console[_0x395bcf(0xab)](_0x395bcf(0xc3))):console[_0x395bcf(0xab)](_0x395bcf(0x125));}),_0x2c1541[_0x30b78a(0x173)](_0x30b78a(0x16f),'sales\x20item\x20return\x20successfull'),_0x6d114d['redirect']('/all_sales_finished/view');}catch(_0x42ddc8){console[_0x30b78a(0xab)](_0x42ddc8),_0x6d114d[_0x30b78a(0x180)](0xc8)[_0x30b78a(0x115)]({'message1':_0x42ddc8['message']});}}}),router[a0_0x3ee30d(0x14f)]('/barcode/:id',auth,async(_0x375b25,_0x2d1c77)=>{var _0xc03cdd=a0_0x3ee30d;try{const {username:_0x3e53a7,email:_0x1423a4,role:_0x1416bd}=_0x375b25[_0xc03cdd(0x9a)],_0x15a9b3=_0x375b25[_0xc03cdd(0x9a)],_0x309e2=await profile[_0xc03cdd(0x159)]({'email':_0x15a9b3[_0xc03cdd(0x127)]}),_0xbd2878=await master_shop[_0xc03cdd(0x14a)]();console[_0xc03cdd(0xab)]('barcode\x20Product\x20master',_0xbd2878);const _0x9c29bb=_0x375b25[_0xc03cdd(0x155)]['id'],_0x3a1d32=await sales['findById'](_0x9c29bb);console[_0xc03cdd(0xab)](_0xc03cdd(0x14e),_0x3a1d32);if(_0xbd2878[0x0]['language']==_0xc03cdd(0x15e))var _0x51b2de=users[_0xc03cdd(0x9b)];else{if(_0xbd2878[0x0][_0xc03cdd(0x10c)]=='Hindi')var _0x51b2de=users['Hindi'];else{if(_0xbd2878[0x0]['language']=='German')var _0x51b2de=users[_0xc03cdd(0x107)];else{if(_0xbd2878[0x0][_0xc03cdd(0x10c)]==_0xc03cdd(0xb0))var _0x51b2de=users[_0xc03cdd(0xb0)];else{if(_0xbd2878[0x0][_0xc03cdd(0x10c)]=='French')var _0x51b2de=users[_0xc03cdd(0x88)];else{if(_0xbd2878[0x0]['language']==_0xc03cdd(0xeb))var _0x51b2de=users['Portuguese'];else{if(_0xbd2878[0x0][_0xc03cdd(0x10c)]==_0xc03cdd(0x136))var _0x51b2de=users[_0xc03cdd(0x136)];else{if(_0xbd2878[0x0][_0xc03cdd(0x10c)]==_0xc03cdd(0x151))var _0x51b2de=users[_0xc03cdd(0xf9)];}}}}}}}_0x2d1c77[_0xc03cdd(0xe9)](_0xc03cdd(0x139),{'success':_0x375b25[_0xc03cdd(0x173)](_0xc03cdd(0x16f)),'errors':_0x375b25[_0xc03cdd(0x173)](_0xc03cdd(0x10f)),'role':_0x15a9b3,'profile':_0x309e2,'alldata':_0x3a1d32,'master_shop':_0xbd2878,'language':_0x51b2de});}catch(_0x24c048){console[_0xc03cdd(0xab)](_0x24c048);}}),router['post']('/barcode_scanner',async(_0x17f9e0,_0x3e6bf8)=>{var _0x48a768=a0_0x3ee30d;const {product_code:_0x3a6755,warehouse_name:_0xf4024c,rooms_data:_0x3988e5,Roomslist:_0x495a68}=_0x17f9e0[_0x48a768(0xf7)],_0x5cead0=_0x495a68[_0x48a768(0xd3)](','),_0x172d6d=[];async function _0x56526e(_0x1d9820){var _0x10cbde=_0x48a768;const _0x3108d5=await warehouse['aggregate']([{'$match':{'name':_0xf4024c,'room':_0x1d9820}},{'$unwind':_0x10cbde(0x77)},{'$match':{'product_details.primary_code':_0x3a6755}},{'$group':{'_id':_0x10cbde(0x11f),'name':{'$first':_0x10cbde(0x15b)},'product_stock':{'$first':_0x10cbde(0xf4)},'primary_code':{'$first':_0x10cbde(0x7d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x10cbde(0x12b)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x10cbde(0x10d)},'type':{'$first':_0x10cbde(0x131)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x10cbde(0x11a)},'rack':{'$first':_0x10cbde(0x160)},'expiry_date':{'$first':_0x10cbde(0x7c)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x10cbde(0x94)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x10cbde(0x82)}}}]),_0x53bbd6=await warehouse[_0x10cbde(0x13e)]([{'$match':{'name':_0xf4024c,'room':_0x1d9820}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3a6755}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x10cbde(0xf4)},'primary_code':{'$first':_0x10cbde(0x7d)},'secondary_code':{'$first':_0x10cbde(0x15d)},'product_code':{'$first':_0x10cbde(0x12b)},'level':{'$first':_0x10cbde(0xfe)},'isle':{'$first':_0x10cbde(0x10d)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x10cbde(0xf1)},'unit':{'$first':_0x10cbde(0x137)},'secondary_unit':{'$first':_0x10cbde(0xdc)},'storage':{'$first':_0x10cbde(0x11a)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x10cbde(0x7c)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x10cbde(0x121)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x10cbde(0x94)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x10cbde(0x185)},'invoice':{'$first':_0x10cbde(0x82)}}}]);if(_0x3108d5[_0x10cbde(0x129)]>0x0)_0x172d6d[_0x10cbde(0x13f)](_0x3108d5);else _0x53bbd6[_0x10cbde(0x129)]>0x0&&_0x172d6d[_0x10cbde(0x13f)](_0x53bbd6);}const _0x1272dd=_0x5cead0[_0x48a768(0x17b)](_0x7e4ec0=>_0x56526e(_0x7e4ec0));await Promise[_0x48a768(0xd6)](_0x1272dd),_0x3e6bf8[_0x48a768(0x115)](_0x172d6d);}),module[a0_0x3ee30d(0x105)]=router;