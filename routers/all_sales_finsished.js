function a0_0xc91a(){var _0x2d1dc6=['$product_details.bin','$product_details.expiry_date','Hindi','German','stock','find','/../public','add_sales_finished','Spanish','/view/add_sales/:id','/barcode_scanner','</head><body>','$product_details.room_name','params','maxProducts','master','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/view/add_sales','</span>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','product_data','product','get','barcode\x20Product\x20master','getDate','8336124VZmdvE','$sale_product.floorlevel','max_per_unit','product_details','<!DOCTYPE\x20html>','</thead>','save','$note','/all_sales_finished/preview/','Enabled','RoomAssigned','return_qty_QA','$name','Quality\x20Inspection','$customer','purchases_data','length','all_sales_finished','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','DRY\x20GOODS','Portuguese','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','floor','$product_details.primary_code','../public/language/languages.json','Sale','sale_qty','$product_details.unit','render','Portuguese\x20(BR)','error','random','\x20</h2>','$product_details.bay','customers','$customers_docs','/upload/','findById','errors','$sale_product','_id','primary_unit','gmail','sales_quantity','<hr\x20class=\x22my-3\x22>','$product','message','\x20Order\x20Date\x20:\x20','Sales\x20Mail','$product_details.floorlevel','maxProducts_QA','True','production_date_QA','logo','/barcode/:id','map','3TqhXJw','$product_details.product_cat','production_date','return_qty','<strong>\x20Regards\x20</strong>','Error\x20Occurs','express','sales_invoice','<span\x20style=\x22float:\x20right;\x22>','unit','level','maxPerUnit','</body></html>','Chinese','$product_details.secondary_code','currency','post','customer_data','<h2>\x20','unit_QA','/picking_list/pdf/','json','Return\x20Rooms','return_data','$product_details.secondary_unit','carton','redirect','Ambient','/view','host','split','note','return_sale_QA','Sales\x20Update\x20successfully','$_id','</table>','user','maxperunit','edit_sales_finished','edit_sales_finished_view','4aoEyJJ','$product.product_name','product_name','catch','name','invoice','product_code','$sale_product.bay','expiry_date_QA','Email\x20sent\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','received_amount','room','string','$product_details','getMonth','prod_invoice','filter','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','/view/:id','log','return_sale','1346245bTmYrm','suppliers','staff','room_name','success','Received\x20Payment\x20For\x20Sale','/all_sales_finished/view','/give_payment/:id','French','Sale\x20Return\x20Mail','Arabic\x20(ae)','</tbody>','add\x20post','warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$warehouse_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Enclosed','back','<tr>','$finalize','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','\x20Order\x20Number\x20:\x20','barcode\x20user_id','return_sale_finished','sales_quantity_QA','createTransport','date_data','English','prod_code','language','<tbody\x20style=\x22text-align:\x20center;\x22>','body','$sale_product.type','product_code_QA','23928UIWHCY','$invoice','An\x20error\x20occurred.','image','<h5>','OUTF-','<h5\x20style=\x22text-align:\x20left;\x22>','push','foreach\x20newproduct','$product_details.batch_code','../middleware/auth','18160IPnQSq','abs','$sale_product.bin','padStart','$product_details.type','for_categorize','id_transaction_from','/preview/:id','primary_code_QA','product_list','QA\x20Warehouse','</div>','<div>','flash','Sale\x20Return','max','customers_docs','customer','concat','site_title','product_stock','False','final','$product_details.storage','password','product_name_QA1','</tr>','</h5>','warehouse_name','$product_details.production_date','$product_details.product_code','secondary_unit','/view/add_sale/product','role','aggregate','2163dOdhIX','secondary_unit_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$date','sale_product','secondary_code','stocks_QA','forEach','out_invoice','/all_sales/view','$room','Logo.png','</td>','all_sales_barcode','There\x27s\x20a\x20error\x20in\x20this\x20transaction','batch_code_QA','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.rack','sales\x20item\x20return\x20successfull','prod_cat','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','maxPerUnit_QA','status','getFullYear','email','exports','stock_data','\x20<>\x20','Router','941059wjtnle','expiry_date','all','Finished\x20Goods','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','batch_code','/view/return_sales/:id','currency_placement','15136PYEkUr','quantity','11301453CVWxYi','$product_details.maxPerUnit','$return_data','Return\x20Goods','nodemailer','$product_details.product_name','primary_code','English\x20(US)','$product_details.product_stock','<html><head><title></title>','bay','findOne','2749018JlFnnR','slice'];a0_0xc91a=function(){return _0x2d1dc6;};return a0_0xc91a();}function a0_0x3d63(_0x4bec7d,_0x15ffa1){var _0xc91a24=a0_0xc91a();return a0_0x3d63=function(_0x3d6322,_0x1bc011){_0x3d6322=_0x3d6322-0xed;var _0x4a5945=_0xc91a24[_0x3d6322];return _0x4a5945;},a0_0x3d63(_0x4bec7d,_0x15ffa1);}var a0_0x3fd6a7=a0_0x3d63;(function(_0x466e38,_0x58f71a){var _0x124073=a0_0x3d63,_0xe91657=_0x466e38();while(!![]){try{var _0x1c8c70=-parseInt(_0x124073(0x12f))/0x1+parseInt(_0x124073(0x145))/0x2*(-parseInt(_0x124073(0x19a))/0x3)+parseInt(_0x124073(0x1c2))/0x4*(-parseInt(_0x124073(0x1d8))/0x5)+-parseInt(_0x124073(0x160))/0x6+parseInt(_0x124073(0x111))/0x7*(parseInt(_0x124073(0x1fc))/0x8)+parseInt(_0x124073(0x139))/0x9+parseInt(_0x124073(0xee))/0xa*(parseInt(_0x124073(0x137))/0xb);if(_0x1c8c70===_0x58f71a)break;else _0xe91657['push'](_0xe91657['shift']());}catch(_0x5db7aa){_0xe91657['push'](_0xe91657['shift']());}}}(a0_0xc91a,0xac045));const express=require(a0_0x3fd6a7(0x1a0)),app=express(),router=express[a0_0x3fd6a7(0x12e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x3fd6a7(0xed)),nodemailer=require(a0_0x3fd6a7(0x13d)),users=require(a0_0x3fd6a7(0x17a));router[a0_0x3fd6a7(0x15d)](a0_0x3fd6a7(0x1b6),auth,async(_0x561878,_0xc77a8d)=>{var _0x2f5918=a0_0x3fd6a7;try{const {username:_0x3e8a71,email:_0x5bad28,role:_0x33d108}=_0x561878[_0x2f5918(0x1be)],_0x3c4616=_0x561878[_0x2f5918(0x1be)],_0x3dbbe0=await profile['findOne']({'email':_0x3c4616[_0x2f5918(0x12a)]}),_0x117580=await master_shop[_0x2f5918(0x14c)]();let _0x2f3a36;if(_0x3c4616[_0x2f5918(0x10f)]==_0x2f5918(0x1da)){const _0x5ba689=await staff[_0x2f5918(0x144)]({'email':_0x3c4616[_0x2f5918(0x12a)]});_0x2f3a36=await sales_finished[_0x2f5918(0x110)]([{'$lookup':{'from':'customers','localField':'customer','foreignField':_0x2f5918(0x1c6),'as':_0x2f5918(0xfe)}},{'$unwind':'$customers_docs'},{'$unwind':_0x2f5918(0x189)},{'$group':{'_id':_0x2f5918(0x1bc),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x2f5918(0x167)},'return_data':{'$first':_0x2f5918(0x13b)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x2f5918(0x1c9)},'isle':{'$addToSet':_0x2f5918(0xf0)},'type':{'$addToSet':_0x2f5918(0x1fa)},'pallet':{'$addToSet':_0x2f5918(0x161)},'finalize':{'$first':_0x2f5918(0x1ec)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x2f3a36=await sales_finished['aggregate']([{'$lookup':{'from':_0x2f5918(0x184),'localField':'customer','foreignField':_0x2f5918(0x1c6),'as':_0x2f5918(0xfe)}},{'$unwind':_0x2f5918(0x185)},{'$unwind':_0x2f5918(0x189)},{'$group':{'_id':'$_id','invoice':{'$first':_0x2f5918(0x1fd)},'customers':{'$first':_0x2f5918(0x16e)},'date':{'$first':_0x2f5918(0x114)},'warehouse_name':{'$first':_0x2f5918(0x1e7)},'sale_product':{'$push':_0x2f5918(0x189)},'note':{'$first':'$note'},'return_data':{'$first':_0x2f5918(0x13b)},'customers_docs':{'$first':_0x2f5918(0x185)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x2f5918(0x1c9)},'isle':{'$addToSet':_0x2f5918(0xf0)},'type':{'$addToSet':_0x2f5918(0x1fa)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x2f5918(0x1ec)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x117580[0x0]['language']==_0x2f5918(0x140)){var _0x464ce3=users[_0x2f5918(0x1f5)];console[_0x2f5918(0x1d6)](_0x464ce3);}else{if(_0x117580[0x0]['language']==_0x2f5918(0x149))var _0x464ce3=users['Hindi'];else{if(_0x117580[0x0]['language']=='German')var _0x464ce3=users[_0x2f5918(0x14a)];else{if(_0x117580[0x0][_0x2f5918(0x1f7)]==_0x2f5918(0x14f))var _0x464ce3=users[_0x2f5918(0x14f)];else{if(_0x117580[0x0]['language']=='French')var _0x464ce3=users[_0x2f5918(0x1e0)];else{if(_0x117580[0x0][_0x2f5918(0x1f7)]=='Portuguese\x20(BR)')var _0x464ce3=users[_0x2f5918(0x175)];else{if(_0x117580[0x0]['language']=='Chinese')var _0x464ce3=users[_0x2f5918(0x1a7)];else{if(_0x117580[0x0]['language']==_0x2f5918(0x1e2))var _0x464ce3=users[_0x2f5918(0x1ed)];}}}}}}}_0xc77a8d[_0x2f5918(0x17e)](_0x2f5918(0x171),{'success':_0x561878['flash'](_0x2f5918(0x1dc)),'errors':_0x561878[_0x2f5918(0xfb)]('errors'),'sales':_0x2f3a36,'profile':_0x3dbbe0,'role':_0x3c4616,'master_shop':_0x117580,'language':_0x464ce3});}catch(_0x56c49b){console[_0x2f5918(0x1d6)](_0x56c49b);}});async function getRandom8DigitNumber(){var _0x1de739=a0_0x3fd6a7;const _0x531580=0x989680,_0x41a7d9=0x5f5e0ff,_0x3dc132=Math[_0x1de739(0x178)](Math[_0x1de739(0x181)]()*(_0x41a7d9-_0x531580+0x1))+_0x531580;var _0x39bf5e;const _0x4e2185=await sales_finished[_0x1de739(0x144)]({'invoice':'OUTF-'+_0x3dc132});return _0x4e2185&&_0x4e2185[_0x1de739(0x170)]>0x0?_0x39bf5e=_0x1de739(0x201)+_0x3dc132:_0x39bf5e='OUTF-'+_0x3dc132,_0x39bf5e;}router['get']('/view/add_sales',auth,async(_0x24df7d,_0xf4cc3)=>{var _0x52e677=a0_0x3fd6a7;try{const {username:_0x200888,email:_0x123683,role:_0x1d170a}=_0x24df7d[_0x52e677(0x1be)],_0x3d11d6=_0x24df7d[_0x52e677(0x1be)],_0x446b1c=await profile[_0x52e677(0x144)]({'email':_0x3d11d6[_0x52e677(0x12a)]}),_0x3734c4=await master_shop[_0x52e677(0x14c)](),_0x2f7c8c=await customer[_0x52e677(0x14c)]({});let _0x25cd8a;if(_0x3d11d6[_0x52e677(0x10f)]==_0x52e677(0x1da)){const _0x36c625=await staff[_0x52e677(0x144)]({'email':_0x3d11d6[_0x52e677(0x12a)]});_0x25cd8a=await warehouse[_0x52e677(0x110)]([{'$match':{'status':_0x52e677(0x169),'name':_0x36c625[_0x52e677(0x1e5)],'warehouse_category':_0x52e677(0x132),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x52e677(0x16c)}}},{'$sort':{'name':0x1}}]);}else _0x25cd8a=await warehouse[_0x52e677(0x110)]([{'$match':{'status':_0x52e677(0x169),'warehouse_category':_0x52e677(0x132),'name':{'$ne':_0x52e677(0xf8)}}},{'$group':{'_id':_0x52e677(0x16c),'name':{'$first':_0x52e677(0x16c)}}},{'$sort':{'name':0x1}}]);const _0x5c17b5=await product['find']({});var _0x43ef3c=[_0x52e677(0x1b5),'Enclosed'];const _0x118ebc=await sales_finished['find']({}),_0x4c8d37=_0x118ebc[_0x52e677(0x170)]+0x1,_0x26f346=_0x52e677(0x201)+_0x4c8d37['toString']()[_0x52e677(0xf1)](0x5,'0');if(_0x3734c4[0x0][_0x52e677(0x1f7)]==_0x52e677(0x140)){var _0xec3933=users[_0x52e677(0x1f5)];console[_0x52e677(0x1d6)](_0xec3933);}else{if(_0x3734c4[0x0][_0x52e677(0x1f7)]==_0x52e677(0x149))var _0xec3933=users[_0x52e677(0x149)];else{if(_0x3734c4[0x0][_0x52e677(0x1f7)]=='German')var _0xec3933=users[_0x52e677(0x14a)];else{if(_0x3734c4[0x0][_0x52e677(0x1f7)]==_0x52e677(0x14f))var _0xec3933=users[_0x52e677(0x14f)];else{if(_0x3734c4[0x0]['language']==_0x52e677(0x1e0))var _0xec3933=users[_0x52e677(0x1e0)];else{if(_0x3734c4[0x0][_0x52e677(0x1f7)]==_0x52e677(0x17f))var _0xec3933=users[_0x52e677(0x175)];else{if(_0x3734c4[0x0][_0x52e677(0x1f7)]==_0x52e677(0x1a7))var _0xec3933=users[_0x52e677(0x1a7)];else{if(_0x3734c4[0x0]['language']=='Arabic\x20(ae)')var _0xec3933=users['Arabic'];}}}}}}}const _0x5aae40=getRandom8DigitNumber();_0x5aae40['then'](_0x2f5495=>{var _0x330da3=_0x52e677;_0xf4cc3[_0x330da3(0x17e)](_0x330da3(0x14e),{'success':_0x24df7d[_0x330da3(0xfb)](_0x330da3(0x1dc)),'errors':_0x24df7d[_0x330da3(0xfb)](_0x330da3(0x188)),'role':_0x3d11d6,'profile':_0x446b1c,'customer':_0x2f7c8c,'warehouse':_0x25cd8a,'product':_0x5c17b5,'invoice':_0x2f5495,'master_shop':_0x3734c4,'language':_0xec3933,'rooms_data':_0x43ef3c});})['catch'](_0x4299e6=>{var _0x230e54=_0x52e677;_0x24df7d['flash']('errors',_0x230e54(0x11f)),_0xf4cc3[_0x230e54(0x1b4)](_0x230e54(0x1de));});}catch(_0x2a79a7){console['log'](_0x2a79a7);}}),router[a0_0x3fd6a7(0x15d)](a0_0x3fd6a7(0x150),auth,async(_0x48615e,_0xd2e210)=>{var _0x38cea3=a0_0x3fd6a7;try{const _0x593de7=_0x48615e[_0x38cea3(0x154)]['id'];console[_0x38cea3(0x1d6)](_0x593de7);const _0x4dda44=await product[_0x38cea3(0x14c)](),_0x15781f=await purchases[_0x38cea3(0x110)]([{'$match':{'warehouse_name':_0x593de7}},{'$unwind':_0x38cea3(0x18f)},{'$group':{'_id':_0x38cea3(0x1c3)}}]);console[_0x38cea3(0x1d6)](_0x38cea3(0x16f),_0x15781f),_0xd2e210[_0x38cea3(0x128)](0xc8)['json']({'purchases_data':_0x15781f,'product_data':_0x4dda44});}catch(_0x7c50a8){console[_0x38cea3(0x1d6)](_0x7c50a8);}}),router[a0_0x3fd6a7(0x1aa)](a0_0x3fd6a7(0x10e),auth,async(_0x7aac13,_0x3c4db0)=>{var _0x338456=a0_0x3fd6a7;try{const {warehouse_data:_0x58c209,product_data:_0xc0bb61}=_0x7aac13['body'];console[_0x338456(0x1d6)](_0x7aac13[_0x338456(0x1f9)][_0x338456(0x15b)]);;const _0x66b49f=await master_shop[_0x338456(0x14c)]();console[_0x338456(0x1d6)](_0x338456(0x156),_0x66b49f);const _0x543c85=await product[_0x338456(0x144)]({'name':_0xc0bb61});console[_0x338456(0x1d6)](_0x338456(0x15c),_0x543c85);const _0x5c0c65=await warehouse['aggregate']([{'$match':{'name':_0x58c209}},{'$unwind':_0x338456(0x1d0)},{'$match':{'product_details.product_name':_0xc0bb61}},{'$group':{'_id':_0x338456(0x13e),'product_stock':{'$first':'$product_details.product_stock'}}}]);console[_0x338456(0x1d6)](_0x338456(0x12c),_0x5c0c65),_0x3c4db0[_0x338456(0x128)](0xc8)['json']({'master':_0x66b49f,'new_product':_0x543c85,'stock_data':_0x5c0c65});}catch(_0x3cdb2a){console[_0x338456(0x1d6)](_0x3cdb2a);}}),router[a0_0x3fd6a7(0x1aa)](a0_0x3fd6a7(0x158),auth,async(_0x5eeaf2,_0x25e4f0)=>{var _0x46c8a4=a0_0x3fd6a7;try{const {invoice:_0x238b7c,date:_0x8528fc,warehouse_name:_0x4854c7,product_name:_0x42b7d8,stock:_0x1b88b6,quantity:_0x27d4f4,note:_0x137f6a,room:_0x3019f5,primary_code:_0x518330,secondary_code:_0xccc0ec,prod_code:_0x3c54c4,level:_0x4904bd,isle:_0x26b322,pallet:_0x25692d,batch_code:_0x67ef56,SCRN:_0x17fcff,expiry_date:_0x204ceb,mode_transpo:_0x55e7b0,name_driver:_0x2a4f9f}=_0x5eeaf2[_0x46c8a4(0x1f9)];if(typeof _0x42b7d8==_0x46c8a4(0x1cf))var _0x4d51bb=[_0x5eeaf2['body']['product_name']],_0x9eb7b0=[_0x5eeaf2['body'][_0x46c8a4(0x14b)]],_0x30870c=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x1b3)]],_0x5235d6=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x13f)]],_0x4d90b4=[_0x5eeaf2['body']['secondary_code']],_0x5ddea7=[_0x5eeaf2[_0x46c8a4(0x1f9)]['prod_code']],_0x3e209a=[_0x5eeaf2['body'][_0x46c8a4(0x1a4)]],_0x22888c=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x18b)]],_0x1c41d5=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x10d)]],_0x2257c7=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x134)]],_0x22385b=[_0x5eeaf2['body']['expiry_date']],_0x21426a=[_0x5eeaf2[_0x46c8a4(0x1f9)]['product_date']],_0x312c18=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x162)]],_0x49423f=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x125)]],_0x14cedd=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x16a)]],_0x4a4eb5=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x1d2)]],_0x36c851=[_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0xf4)]];else var _0x4d51bb=[..._0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x1c4)]],_0x9eb7b0=[..._0x5eeaf2['body'][_0x46c8a4(0x14b)]],_0x30870c=[..._0x5eeaf2[_0x46c8a4(0x1f9)]['carton']],_0x5235d6=[..._0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x13f)]],_0x4d90b4=[..._0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x116)]],_0x5ddea7=[..._0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x1f6)]],_0x3e209a=[..._0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x1a4)]],_0x22888c=[..._0x5eeaf2[_0x46c8a4(0x1f9)]['primary_unit']],_0x1c41d5=[..._0x5eeaf2[_0x46c8a4(0x1f9)]['secondary_unit']],_0x2257c7=[..._0x5eeaf2['body']['batch_code']],_0x22385b=[..._0x5eeaf2['body'][_0x46c8a4(0x130)]],_0x21426a=[..._0x5eeaf2[_0x46c8a4(0x1f9)]['product_date']],_0x312c18=[..._0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x162)]],_0x49423f=[..._0x5eeaf2['body']['prod_cat']],_0x14cedd=[..._0x5eeaf2[_0x46c8a4(0x1f9)]['RoomAssigned']],_0x4a4eb5=[..._0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0x1d2)]],_0x36c851=[..._0x5eeaf2['body'][_0x46c8a4(0xf4)]];const _0x32f4d8=_0x4d51bb[_0x46c8a4(0x199)](_0x530b31=>{return _0x530b31={'product_name':_0x530b31};});_0x9eb7b0[_0x46c8a4(0x118)]((_0x8f5cd6,_0x13ddbf)=>{_0x32f4d8[_0x13ddbf]['stock']=_0x8f5cd6;}),_0x30870c['forEach']((_0x46e7e3,_0x57bd2d)=>{var _0x1678f0=_0x46c8a4;_0x32f4d8[_0x57bd2d]['quantity']=Math[_0x1678f0(0xef)](_0x46e7e3);}),_0x36c851[_0x46c8a4(0x118)]((_0x3de7b2,_0x1ef8ee)=>{_0x32f4d8[_0x1ef8ee]['id_transaction_from']=_0x3de7b2;}),_0x5235d6[_0x46c8a4(0x118)]((_0x250953,_0x31140b)=>{var _0x51a16d=_0x46c8a4;_0x32f4d8[_0x31140b][_0x51a16d(0x13f)]=_0x250953;}),_0x4d90b4[_0x46c8a4(0x118)]((_0x30ddc5,_0x15e23f)=>{var _0x4ae8ac=_0x46c8a4;_0x32f4d8[_0x15e23f][_0x4ae8ac(0x116)]=_0x30ddc5;}),_0x5ddea7[_0x46c8a4(0x118)]((_0xe905f2,_0x57f19c)=>{var _0x413496=_0x46c8a4;_0x32f4d8[_0x57f19c][_0x413496(0x1c8)]=_0xe905f2,_0x32f4d8[_0x57f19c][_0x413496(0x1f4)]=_0x8528fc;}),_0x3e209a['forEach']((_0x451a31,_0x35a435)=>{var _0x1c7e93=_0x46c8a4;_0x32f4d8[_0x35a435][_0x1c7e93(0x143)]=_0x451a31;}),_0x22888c[_0x46c8a4(0x118)]((_0x38db6f,_0x25634f)=>{_0x32f4d8[_0x25634f]['unit']=_0x38db6f;}),_0x1c41d5['forEach']((_0x3ea9b4,_0x1ad84e)=>{var _0x30938a=_0x46c8a4;_0x32f4d8[_0x1ad84e][_0x30938a(0x10d)]=_0x3ea9b4;}),_0x2257c7[_0x46c8a4(0x118)]((_0x44266f,_0x359554)=>{_0x32f4d8[_0x359554]['batch_code']=_0x44266f;}),_0x22385b['forEach']((_0xdbad41,_0x14a197)=>{var _0x56f31d=_0x46c8a4;_0x32f4d8[_0x14a197][_0x56f31d(0x130)]=_0xdbad41;}),_0x21426a[_0x46c8a4(0x118)]((_0x4ce15b,_0x48cb30)=>{_0x32f4d8[_0x48cb30]['production_date']=_0x4ce15b;}),_0x312c18['forEach']((_0x579483,_0x2f2cec)=>{var _0x3f7eb5=_0x46c8a4;_0x32f4d8[_0x2f2cec][_0x3f7eb5(0x1bf)]=_0x579483;}),_0x49423f[_0x46c8a4(0x118)]((_0xe84c5e,_0x285950)=>{var _0x1aedec=_0x46c8a4;_0x32f4d8[_0x285950][_0x1aedec(0x125)]=_0xe84c5e;}),_0x14cedd[_0x46c8a4(0x118)]((_0x42a109,_0x5b7ff9)=>{_0x32f4d8[_0x5b7ff9]['room_name']=_0x42a109;}),_0x4a4eb5[_0x46c8a4(0x118)]((_0x95416a,_0x1de164)=>{_0x32f4d8[_0x1de164]['invoice']=_0x95416a;});var _0x52bed2=0x0;_0x32f4d8[_0x46c8a4(0x118)](_0x2fe5a2=>{var _0x1baa1c=_0x46c8a4;parseFloat(_0x2fe5a2[_0x1baa1c(0x14b)])<parseFloat(_0x2fe5a2[_0x1baa1c(0x138)])&&parseFloat(_0x2fe5a2[_0x1baa1c(0x138)])>parseFloat(_0x2fe5a2[_0x1baa1c(0x14b)])&&(console[_0x1baa1c(0x1d6)](_0x2fe5a2[_0x1baa1c(0x14b)]+_0x1baa1c(0x12d)+_0x2fe5a2[_0x1baa1c(0x138)]),_0x52bed2++);});if(_0x52bed2!=0x0)return _0x5eeaf2['flash']('errors','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x25e4f0[_0x46c8a4(0x1b4)](_0x46c8a4(0x1ea));const _0x9f0e30=_0x32f4d8[_0x46c8a4(0x1d3)](_0xeb2540=>_0xeb2540[_0x46c8a4(0x138)]!=='0'&&_0xeb2540['quantity']!==''),_0x24cf56=new sales_finished({'invoice':_0x238b7c,'customer':_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0xff)],'date':_0x8528fc,'warehouse_name':_0x4854c7,'sale_product':_0x9f0e30,'note':_0x137f6a,'room':_0x3019f5,'primary_code':_0x518330,'secondary_code':_0xccc0ec,'prod_code':_0x3c54c4,'SCRN':_0x17fcff,'finalize':_0x46c8a4(0x103),'mode_transpo':_0x55e7b0,'name_driver':_0x2a4f9f}),_0x1f0aff=await _0x24cf56[_0x46c8a4(0x166)](),_0x4fb3c4=await sales_finished[_0x46c8a4(0x144)]({'invoice':_0x238b7c}),_0x2ac4c1=new c_payment_data({'invoice':_0x238b7c,'customer':_0x5eeaf2[_0x46c8a4(0x1f9)][_0x46c8a4(0xff)],'reason':_0x46c8a4(0x17b)});await _0x2ac4c1[_0x46c8a4(0x166)]();const _0x376e93=await master_shop[_0x46c8a4(0x14c)](),_0x4bf327=await email_settings[_0x46c8a4(0x144)](),_0x1210cb=await customer[_0x46c8a4(0x144)]({'name':_0x5eeaf2[_0x46c8a4(0x1f9)]['customer']});_0x376e93[0x0][_0x46c8a4(0x136)]==0x1?(right_currency=_0x376e93[0x0][_0x46c8a4(0x1a9)],left_currency=''):(right_currency='',left_currency=_0x376e93[0x0][_0x46c8a4(0x1a9)]);var _0x50941d=_0x4d51bb,_0x525533=_0x30870c,_0x1b302f='',_0xefd11e;for(_0xefd11e in _0x50941d){_0x1b302f+=_0x46c8a4(0x1eb)+_0x46c8a4(0x176)+_0x50941d[_0xefd11e]+_0x46c8a4(0x11d)+_0x46c8a4(0x176)+_0x525533[_0xefd11e]+'</td>'+_0x46c8a4(0x108);}console['log']('product_list',_0x1b302f),_0x5eeaf2[_0x46c8a4(0xfb)](_0x46c8a4(0x1dc),'Sales\x20Add\x20successfully'),_0x25e4f0[_0x46c8a4(0x1b4)](_0x46c8a4(0x168)+_0x1f0aff[_0x46c8a4(0x18a)]);}catch(_0x30fac3){console[_0x46c8a4(0x1d6)](_0x30fac3);}}),router[a0_0x3fd6a7(0x15d)]('/preview/:id',auth,async(_0x525438,_0x115019)=>{var _0xddca77=a0_0x3fd6a7;try{const {username:_0x361c0b,email:_0x5c54c8,role:_0x55f530}=_0x525438['user'],_0x4a7aff=_0x525438['user'],_0x24c196=await profile['findOne']({'email':_0x4a7aff[_0xddca77(0x12a)]}),_0x4d0954=await master_shop[_0xddca77(0x14c)](),_0x57be82=_0x525438[_0xddca77(0x154)]['id'],_0x454910=await sales_finished[_0xddca77(0x187)](_0x57be82),_0x11a0e2=await warehouse[_0xddca77(0x110)]([{'$match':{'name':_0x454910[_0xddca77(0x10a)]}},{'$unwind':_0xddca77(0x1d0)},{'$group':{'_id':'$product_details._id','name':{'$first':_0xddca77(0x13e)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xddca77(0xf2)},'floorlevel':{'$first':_0xddca77(0x193)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xddca77(0x1a8)},'product_code':{'$first':_0xddca77(0x10c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xddca77(0x123)},'expiry_date':{'$first':_0xddca77(0x148)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xddca77(0x205)},'room':{'$first':_0xddca77(0x11b)},'room_data':{'$first':_0xddca77(0x153)}}}]),_0x2dd5cd=await customer[_0xddca77(0x14c)]({});let _0xff90e8;if(_0x4a7aff['role']==_0xddca77(0x1da)){const _0xbe4aba=await staff[_0xddca77(0x144)]({'email':_0x4a7aff[_0xddca77(0x12a)]});_0xff90e8=await warehouse[_0xddca77(0x110)]([{'$match':{'status':'Enabled','name':_0xbe4aba['warehouse']}},{'$group':{'_id':_0xddca77(0x16c),'name':{'$first':_0xddca77(0x16c)}}}]);}else _0xff90e8=await warehouse[_0xddca77(0x110)]([{'$match':{'status':_0xddca77(0x169)}},{'$group':{'_id':_0xddca77(0x16c),'name':{'$first':_0xddca77(0x16c)}}}]);const _0x1ad1b0=await product[_0xddca77(0x14c)]({});if(_0x4d0954[0x0][_0xddca77(0x1f7)]==_0xddca77(0x140)){var _0x1eaeec=users[_0xddca77(0x1f5)];console[_0xddca77(0x1d6)](_0x1eaeec);}else{if(_0x4d0954[0x0]['language']==_0xddca77(0x149))var _0x1eaeec=users[_0xddca77(0x149)];else{if(_0x4d0954[0x0][_0xddca77(0x1f7)]==_0xddca77(0x14a))var _0x1eaeec=users[_0xddca77(0x14a)];else{if(_0x4d0954[0x0][_0xddca77(0x1f7)]=='Spanish')var _0x1eaeec=users[_0xddca77(0x14f)];else{if(_0x4d0954[0x0][_0xddca77(0x1f7)]==_0xddca77(0x1e0))var _0x1eaeec=users[_0xddca77(0x1e0)];else{if(_0x4d0954[0x0]['language']==_0xddca77(0x17f))var _0x1eaeec=users['Portuguese'];else{if(_0x4d0954[0x0][_0xddca77(0x1f7)]==_0xddca77(0x1a7))var _0x1eaeec=users[_0xddca77(0x1a7)];else{if(_0x4d0954[0x0][_0xddca77(0x1f7)]==_0xddca77(0x1e2))var _0x1eaeec=users['Arabic'];}}}}}}}_0x115019[_0xddca77(0x17e)](_0xddca77(0x1c1),{'success':_0x525438['flash'](_0xddca77(0x1dc)),'errors':_0x525438[_0xddca77(0xfb)](_0xddca77(0x188)),'role':_0x4a7aff,'profile':_0x24c196,'customer':_0x2dd5cd,'warehouse':_0xff90e8,'product':_0x11a0e2,'user':_0x454910,'master_shop':_0x4d0954,'unit':_0x1ad1b0,'language':_0x1eaeec});}catch(_0x464c9c){console[_0xddca77(0x1d6)](_0x464c9c);}}),router[a0_0x3fd6a7(0x1aa)](a0_0x3fd6a7(0xf5),auth,async(_0x632ffa,_0x2a4c80)=>{var _0x9ae3c6=a0_0x3fd6a7;try{const _0x599e28=_0x632ffa[_0x9ae3c6(0x154)]['id'],{invoice:_0x119acb,warehouse_name:_0x4b20d0,room:_0x53c98c}=_0x632ffa[_0x9ae3c6(0x1f9)],_0x3bc0b5=await sales_finished[_0x9ae3c6(0x144)]({'invoice':_0x119acb}),_0x41779d=_0x3bc0b5[_0x9ae3c6(0x115)]['map'](async _0x6a70bd=>{var _0x3b9c1b=_0x9ae3c6,_0x50b562=await warehouse[_0x3b9c1b(0x144)]({'name':_0x4b20d0,'room':_0x6a70bd[_0x3b9c1b(0x1db)],'warehouse_category':_0x3b9c1b(0x132)});const _0x236e3b=_0x50b562[_0x3b9c1b(0x163)][_0x3b9c1b(0x199)](_0x687cca=>{var _0x575338=_0x3b9c1b;if(_0x687cca[_0x575338(0x1c4)]==_0x6a70bd[_0x575338(0x1c4)]&&_0x687cca[_0x575338(0x143)]==_0x6a70bd[_0x575338(0x143)]&&_0x687cca['expiry_date']==_0x6a70bd[_0x575338(0x130)]&&_0x687cca[_0x575338(0x19c)]==_0x6a70bd[_0x575338(0x19c)]&&_0x687cca[_0x575338(0x134)]==_0x6a70bd['batch_code']&&_0x687cca['_id']==_0x6a70bd[_0x575338(0xf4)]){if(_0x687cca[_0x575338(0x102)]>0x0){_0x687cca[_0x575338(0x102)]=Math[_0x575338(0xfd)](0x0,Math[_0x575338(0xef)](_0x687cca['product_stock'])-Math[_0x575338(0xef)](_0x6a70bd[_0x575338(0x138)]));if(_0x687cca['out_invoice']==undefined)_0x687cca[_0x575338(0x119)]=_0x119acb+'~';else{var _0x222992=_0x687cca[_0x575338(0x119)]['split']('~'),_0x252123='';for(let _0x5359b8=0x0;_0x5359b8<=_0x222992[_0x575338(0x170)]-0x1;_0x5359b8++){const _0x2652ad=_0x222992[_0x5359b8];_0x2652ad['length']>0x0&&(_0x252123+=_0x2652ad+'~');}_0x687cca[_0x575338(0x119)]=_0x252123;}}}});return console['log'](_0x50b562),_0x50b562;});Promise['all'](_0x41779d)['then'](async _0x3cb0fe=>{var _0x1669bd=_0x9ae3c6;try{for(const _0x274251 of _0x3cb0fe){await _0x274251[_0x1669bd(0x166)]();}_0x3bc0b5['finalize']=_0x1669bd(0x195);const _0x3b43fb=await _0x3bc0b5[_0x1669bd(0x166)](),_0x2c5418=await master_shop[_0x1669bd(0x14c)](),_0x1cfe38=await email_settings[_0x1669bd(0x144)](),_0x2d0296=await supervisor_settings[_0x1669bd(0x14c)]();var _0x3baff6=_0x3bc0b5[_0x1669bd(0x115)],_0x5805d4='',_0x2bb215;for(_0x2bb215 in _0x3baff6){var _0x33c0be='FG';_0x3bc0b5['warehouse_name']==_0x1669bd(0x174)&&(_0x33c0be='DG'),_0x5805d4+=_0x1669bd(0x1eb)+_0x1669bd(0x176)+_0x3baff6[_0x2bb215][_0x1669bd(0x1c4)]+_0x1669bd(0x11d)+_0x1669bd(0x176)+_0x3baff6[_0x2bb215]['product_code']+'</td>'+_0x1669bd(0x176)+_0x3baff6[_0x2bb215][_0x1669bd(0x138)]+_0x1669bd(0x11d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3baff6[_0x2bb215]['unit']+'</td>'+_0x1669bd(0x176)+_0x3baff6[_0x2bb215]['secondary_unit']+_0x1669bd(0x11d)+_0x1669bd(0x176)+_0x3bc0b5[_0x1669bd(0x10a)]+_0x1669bd(0x11d)+_0x1669bd(0x176)+_0x3baff6[_0x2bb215][_0x1669bd(0x1db)]+_0x1669bd(0x11d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x33c0be+_0x3baff6[_0x2bb215][_0x1669bd(0x143)]+_0x1669bd(0x11d);}let _0xcd826c=nodemailer[_0x1669bd(0x1f3)]({'host':_0x1cfe38[_0x1669bd(0x1b7)],'port':Number(_0x1cfe38['port']),'secure':![],'auth':{'user':_0x1cfe38[_0x1669bd(0x12a)],'pass':_0x1cfe38['password']}}),_0x1f9282={'from':_0x1cfe38['email'],'to':_0x2d0296[0x0]['FGSEmail'],'subject':_0x1669bd(0x192),'attachments':[{'filename':_0x1669bd(0x11c),'path':__dirname+_0x1669bd(0x14d)+_0x1669bd(0x186)+_0x2c5418[0x0][_0x1669bd(0x1ff)],'cid':_0x1669bd(0x197)}],'html':_0x1669bd(0x164)+_0x1669bd(0x142)+_0x1669bd(0x152)+_0x1669bd(0xfa)+_0x1669bd(0x133)+_0x1669bd(0xfa)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1669bd(0xf9)+_0x1669bd(0xfa)+_0x1669bd(0x1ac)+_0x2c5418[0x0][_0x1669bd(0x101)]+_0x1669bd(0x182)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x1669bd(0xfa)+_0x1669bd(0x202)+'\x20Order\x20Number\x20:\x20'+_0x3bc0b5[_0x1669bd(0x1c7)]+'\x20'+_0x1669bd(0x1a2)+_0x1669bd(0x191)+_0x3bc0b5['date']+'\x20'+_0x1669bd(0x159)+_0x1669bd(0x109)+_0x1669bd(0xf9)+_0x1669bd(0x122)+_0x1669bd(0x157)+_0x1669bd(0x1eb)+_0x1669bd(0x113)+_0x1669bd(0x1e8)+_0x1669bd(0x173)+_0x1669bd(0x177)+_0x1669bd(0x1ee)+_0x1669bd(0x1cc)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+_0x1669bd(0x165)+_0x1669bd(0x1f8)+'\x20'+_0x5805d4+'\x20'+_0x1669bd(0x1e3)+_0x1669bd(0x1bd)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x1669bd(0x200)+_0x2c5418[0x0][_0x1669bd(0x101)]+_0x1669bd(0x109)+_0x1669bd(0xf9)+_0x1669bd(0xf9)+'</body></html>'};_0xcd826c['sendMail'](_0x1f9282,function(_0x21f6ca,_0x58ec0f){var _0x298c44=_0x1669bd;_0x21f6ca?(console[_0x298c44(0x1d6)](_0x21f6ca),console[_0x298c44(0x1d6)](_0x298c44(0x19f))):console[_0x298c44(0x1d6)](_0x298c44(0x1cb));}),_0x632ffa[_0x1669bd(0xfb)](_0x1669bd(0x1dc),_0x1669bd(0x1bb)),_0x2a4c80[_0x1669bd(0x1b4)](_0x1669bd(0x1ae)+_0x599e28);}catch(_0x15f3e1){console['error'](_0x15f3e1),_0x2a4c80['status'](0x1f4)[_0x1669bd(0x1af)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x9ae3c6(0x1c5)](_0xfffc93=>{var _0x431a57=_0x9ae3c6;console[_0x431a57(0x180)](_0xfffc93),_0x2a4c80[_0x431a57(0x128)](0x1f4)[_0x431a57(0x1af)]({'error':_0x431a57(0x1fe)});});}catch(_0x535aa0){console['log'](_0x535aa0);}}),router['get'](a0_0x3fd6a7(0x1d5),auth,async(_0x3b3007,_0x38f550)=>{var _0x4e0896=a0_0x3fd6a7;try{const {username:_0x16f35e,email:_0x559159,role:_0x102942}=_0x3b3007[_0x4e0896(0x1be)],_0x29eac0=_0x3b3007['user'],_0x45fde1=await profile['findOne']({'email':_0x29eac0[_0x4e0896(0x12a)]}),_0x145041=await master_shop[_0x4e0896(0x14c)](),_0x4df45e=_0x3b3007[_0x4e0896(0x154)]['id'],_0x370a45=await sales_finished[_0x4e0896(0x187)](_0x4df45e);let _0x4be499=new Date(_0x370a45[_0x4e0896(0x130)]),_0x407262=('0'+_0x4be499[_0x4e0896(0x15f)]())[_0x4e0896(0x146)](-0x2),_0x2f64ef=('0'+(_0x4be499['getMonth']()+0x1))['slice'](-0x2),_0x58728d=_0x4be499[_0x4e0896(0x129)](),_0x1bff5c=_0x58728d+'-'+_0x2f64ef+'-'+_0x407262;var _0x2814a7=[_0x4e0896(0x1b5),_0x4e0896(0x1e9)];const _0x16f41f=await warehouse['aggregate']([{'$match':{'name':_0x370a45[_0x4e0896(0x10a)],'room':_0x370a45['room']}},{'$unwind':_0x4e0896(0x1d0)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4e0896(0x13e)},'product_stock':{'$first':_0x4e0896(0x141)},'bay':{'$first':_0x4e0896(0x183)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4e0896(0xf2)},'floorlevel':{'$first':_0x4e0896(0x193)},'primary_code':{'$first':_0x4e0896(0x179)},'secondary_code':{'$first':_0x4e0896(0x1a8)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4e0896(0x123)}}}]),_0x4d1214=await customer[_0x4e0896(0x14c)]({});let _0x487513;if(_0x29eac0[_0x4e0896(0x10f)]=='staff'){const _0x27a5af=await staff[_0x4e0896(0x144)]({'email':_0x29eac0['email']});_0x487513=await warehouse[_0x4e0896(0x110)]([{'$match':{'status':_0x4e0896(0x169),'name':_0x27a5af[_0x4e0896(0x1e5)]}},{'$group':{'_id':'$name','name':{'$first':_0x4e0896(0x16c)}}}]);}else _0x487513=await warehouse[_0x4e0896(0x110)]([{'$match':{'status':_0x4e0896(0x169)}},{'$group':{'_id':'$name','name':{'$first':_0x4e0896(0x16c)}}}]);const _0x1ad100=await product['find']({});if(_0x145041[0x0][_0x4e0896(0x1f7)]=='English\x20(US)'){var _0x4601f6=users[_0x4e0896(0x1f5)];console[_0x4e0896(0x1d6)](_0x4601f6);}else{if(_0x145041[0x0]['language']=='Hindi')var _0x4601f6=users[_0x4e0896(0x149)];else{if(_0x145041[0x0]['language']==_0x4e0896(0x14a))var _0x4601f6=users[_0x4e0896(0x14a)];else{if(_0x145041[0x0][_0x4e0896(0x1f7)]==_0x4e0896(0x14f))var _0x4601f6=users[_0x4e0896(0x14f)];else{if(_0x145041[0x0]['language']==_0x4e0896(0x1e0))var _0x4601f6=users[_0x4e0896(0x1e0)];else{if(_0x145041[0x0][_0x4e0896(0x1f7)]==_0x4e0896(0x17f))var _0x4601f6=users[_0x4e0896(0x175)];else{if(_0x145041[0x0][_0x4e0896(0x1f7)]=='Chinese')var _0x4601f6=users[_0x4e0896(0x1a7)];else{if(_0x145041[0x0][_0x4e0896(0x1f7)]==_0x4e0896(0x1e2))var _0x4601f6=users[_0x4e0896(0x1ed)];}}}}}}}_0x38f550[_0x4e0896(0x17e)](_0x4e0896(0x1c0),{'success':_0x3b3007[_0x4e0896(0xfb)](_0x4e0896(0x1dc)),'errors':_0x3b3007[_0x4e0896(0xfb)](_0x4e0896(0x188)),'role':_0x29eac0,'profile':_0x45fde1,'customer':_0x4d1214,'warehouse':_0x487513,'product':_0x16f41f,'user':_0x370a45,'master_shop':_0x145041,'unit':_0x1ad100,'language':_0x4601f6,'rooms_data':_0x2814a7,'ed_fullDate':_0x1bff5c});}catch(_0x1811b1){console[_0x4e0896(0x1d6)](_0x1811b1);}}),router[a0_0x3fd6a7(0x1aa)]('/view/:id',auth,async(_0x3faaf4,_0x39aac9)=>{var _0x4e9e87=a0_0x3fd6a7;try{const _0x169d24=_0x3faaf4[_0x4e9e87(0x154)]['id'],_0x57c64e=await sales_finished[_0x4e9e87(0x144)]({'_id':_0x3faaf4[_0x4e9e87(0x154)]['id']}),_0x3e43cc=await warehouse[_0x4e9e87(0x144)]({'name':_0x57c64e['warehouse_name'],'room':_0x3faaf4['body']['room'],'warehouse_category':_0x4e9e87(0x132)}),{invoice:_0xfc7e7e,customer:_0x33f0e6,date:_0x1c624a,warehouse_name:_0x21deae,product_name:_0x24c9a2,stock:_0x2fc6fe,adjust_qty:_0x9483e2,note:_0x70ae3d,room:_0x23a72f,primary_code:_0x253ff2,secondary_code:_0x55be49,prod_code:_0x1077f7,level:_0x5bdb46,isle:_0x3dd0e1,pallet:_0x1ce345,expiry_date:_0x244847}=_0x3faaf4[_0x4e9e87(0x1f9)];if(typeof _0x24c9a2==_0x4e9e87(0x1cf))var _0x36154c=[_0x3faaf4[_0x4e9e87(0x1f9)][_0x4e9e87(0x1c4)]],_0x2f088f=[_0x3faaf4[_0x4e9e87(0x1f9)][_0x4e9e87(0x14b)]],_0x2d872a=[_0x3faaf4[_0x4e9e87(0x1f9)]['adjust_qty']],_0x17c497=[_0x3faaf4['body']['primary_code']],_0x8c1ab4=[_0x3faaf4['body'][_0x4e9e87(0x116)]],_0x333096=[_0x3faaf4[_0x4e9e87(0x1f9)]['prod_code']],_0xded601=[_0x3faaf4[_0x4e9e87(0x1f9)]['level']],_0x2f4eb5=[_0x3faaf4[_0x4e9e87(0x1f9)]['expiry_date']];else var _0x36154c=[..._0x3faaf4[_0x4e9e87(0x1f9)]['product_name']],_0x2f088f=[..._0x3faaf4['body'][_0x4e9e87(0x14b)]],_0x2d872a=[..._0x3faaf4[_0x4e9e87(0x1f9)]['adjust_qty']],_0x17c497=[..._0x3faaf4['body'][_0x4e9e87(0x13f)]],_0x8c1ab4=[..._0x3faaf4['body'][_0x4e9e87(0x116)]],_0x333096=[..._0x3faaf4[_0x4e9e87(0x1f9)][_0x4e9e87(0x1f6)]],_0xded601=[..._0x3faaf4['body'][_0x4e9e87(0x1a4)]],_0x2f4eb5=[..._0x3faaf4[_0x4e9e87(0x1f9)][_0x4e9e87(0x130)]];const _0x5470bc=_0x36154c[_0x4e9e87(0x199)](_0x5abe0d=>{return _0x5abe0d={'product_name':_0x5abe0d};});_0x2f088f[_0x4e9e87(0x118)]((_0x56bf0c,_0x4b0638)=>{var _0x3d2be7=_0x4e9e87;_0x5470bc[_0x4b0638][_0x3d2be7(0x14b)]=_0x56bf0c;}),_0x2d872a['forEach']((_0x92d108,_0x2b5e98)=>{var _0x4e2a00=_0x4e9e87;_0x5470bc[_0x2b5e98][_0x4e2a00(0x138)]=_0x92d108;}),_0x17c497[_0x4e9e87(0x118)]((_0x2d20b8,_0x3bcf0d)=>{var _0x157637=_0x4e9e87;_0x5470bc[_0x3bcf0d][_0x157637(0x13f)]=_0x2d20b8;}),_0x8c1ab4['forEach']((_0x18dc83,_0x135cf4)=>{var _0x1d1e3d=_0x4e9e87;_0x5470bc[_0x135cf4][_0x1d1e3d(0x116)]=_0x18dc83;}),_0x333096['forEach']((_0x2e3ce6,_0x358c00)=>{var _0x3ca3b4=_0x4e9e87;_0x5470bc[_0x358c00][_0x3ca3b4(0x1c8)]=_0x2e3ce6;}),_0xded601['forEach']((_0x45e12e,_0x2091b3)=>{var _0x1c7aa1=_0x4e9e87;_0x5470bc[_0x2091b3][_0x1c7aa1(0x1a4)]=_0x45e12e;}),_0x2f4eb5[_0x4e9e87(0x118)]((_0x54b304,_0x49a914)=>{var _0x17bff1=_0x4e9e87;_0x5470bc[_0x49a914][_0x17bff1(0x130)]=_0x54b304;});var _0x54c062=0x0;_0x5470bc['forEach'](_0x4ace16=>{var _0x1cf6c1=_0x4e9e87;console[_0x1cf6c1(0x1d6)](_0x1cf6c1(0x204),_0x4ace16),(parseInt(_0x4ace16[_0x1cf6c1(0x14b)])<parseInt(_0x4ace16[_0x1cf6c1(0x138)])||parseInt(_0x4ace16[_0x1cf6c1(0x138)])==0x0)&&_0x54c062++;});if(_0x54c062!=0x0)return _0x3faaf4[_0x4e9e87(0xfb)](_0x4e9e87(0x188),_0x4e9e87(0x126)),_0x39aac9[_0x4e9e87(0x1b4)]('back');_0x57c64e[_0x4e9e87(0x115)][_0x4e9e87(0x118)](_0x461145=>{var _0x56e8be=_0x4e9e87;const _0x345bec=_0x3e43cc[_0x56e8be(0x163)][_0x56e8be(0x199)](_0x32dcf4=>{var _0x1ea563=_0x56e8be;_0x32dcf4[_0x1ea563(0x1c4)]==_0x461145[_0x1ea563(0x1c4)]&&_0x32dcf4[_0x1ea563(0x143)]==_0x461145[_0x1ea563(0x143)]&&(_0x32dcf4[_0x1ea563(0x102)]=parseInt(_0x32dcf4[_0x1ea563(0x102)])+parseInt(_0x461145[_0x1ea563(0x138)]));});}),await _0x3e43cc[_0x4e9e87(0x166)]();const _0x3e8295=_0x5470bc['filter'](_0x2ea058=>_0x2ea058[_0x4e9e87(0x138)]!=='0'&&_0x2ea058['quantity']!=='');_0x57c64e[_0x4e9e87(0x1c7)]=_0xfc7e7e,_0x57c64e[_0x4e9e87(0xff)]=_0x33f0e6,_0x57c64e['date']=_0x1c624a,_0x57c64e[_0x4e9e87(0x10a)]=_0x21deae,_0x57c64e[_0x4e9e87(0x115)]=_0x3e8295,_0x57c64e[_0x4e9e87(0x1b9)]=_0x70ae3d,_0x57c64e[_0x4e9e87(0x1ce)]=_0x23a72f;const _0x1b50e4=await _0x57c64e['save'](),_0x52716e=await sales_finished[_0x4e9e87(0x144)]({'_id':_0x3faaf4[_0x4e9e87(0x154)]['id']}),_0x1ca499=await warehouse[_0x4e9e87(0x144)]({'name':_0x21deae,'room':_0x23a72f,'warehouse_category':_0x4e9e87(0x132)});_0x52716e[_0x4e9e87(0x115)][_0x4e9e87(0x118)](_0x500307=>{var _0x5e8716=_0x4e9e87;const _0x3510c1=_0x1ca499['product_details'][_0x5e8716(0x199)](_0x3db07e=>{var _0x18837d=_0x5e8716;_0x3db07e[_0x18837d(0x1c4)]==_0x500307[_0x18837d(0x1c4)]&&_0x3db07e[_0x18837d(0x143)]==_0x500307[_0x18837d(0x143)]&&(_0x3db07e['product_stock']=parseInt(_0x3db07e['product_stock'])-parseInt(_0x500307[_0x18837d(0x138)]));});}),console[_0x4e9e87(0x1d6)](_0x4e9e87(0x104),_0x1ca499),await _0x1ca499[_0x4e9e87(0x166)]();const _0x87501=await c_payment_data[_0x4e9e87(0x144)]({'invoice':_0x3faaf4[_0x4e9e87(0x1f9)][_0x4e9e87(0x1c7)]});_0x87501[_0x4e9e87(0x1d9)]=_0x3faaf4['body'][_0x4e9e87(0x1d9)],await _0x87501[_0x4e9e87(0x166)](),_0x3faaf4[_0x4e9e87(0xfb)]('success',_0x4e9e87(0x1bb)),_0x39aac9[_0x4e9e87(0x1b4)]('/all_sales_finished/view');}catch(_0x2aa0f0){console[_0x4e9e87(0x1d6)](_0x2aa0f0);}}),router['post'](a0_0x3fd6a7(0x1df),auth,async(_0x47734c,_0xf586b0)=>{var _0xf522fa=a0_0x3fd6a7;try{const _0x1edaef=_0x47734c[_0xf522fa(0x154)]['id'],{invoice:_0x5a01ab,customer:_0x3b8b06,receivable_amount:_0xbda1ef,received_amount:_0x467a66}=_0x47734c[_0xf522fa(0x1f9)],_0x176dea=await sales[_0xf522fa(0x187)](_0x1edaef);console[_0xf522fa(0x1d6)](_0x176dea);var _0x15f810=_0xbda1ef-_0x467a66;console[_0xf522fa(0x1d6)](_0x467a66),_0x176dea['received_amount']=parseFloat(_0x467a66)+parseFloat(_0x176dea[_0xf522fa(0x1cd)]),_0x176dea['due_amount']=_0x15f810,console[_0xf522fa(0x1d6)](_0x176dea);const _0xda8c47=await _0x176dea[_0xf522fa(0x166)](),_0x144bd6=await c_payment_data[_0xf522fa(0x144)]({'invoice':_0x5a01ab});_0x144bd6['amount']=_0x15f810,await _0x144bd6[_0xf522fa(0x166)]();let _0x4edd54=new Date(),_0x1806cc=('0'+_0x4edd54['getDate']())['slice'](-0x2),_0x426b12=('0'+(_0x4edd54[_0xf522fa(0x1d1)]()+0x1))[_0xf522fa(0x146)](-0x2),_0x53beec=_0x4edd54['getFullYear'](),_0x4b5a5f=_0x53beec+'-'+_0x426b12+'-'+_0x1806cc;const _0x467613=new customer_payment({'invoice':_0x5a01ab,'date':_0x53beec+'-'+_0x426b12+'-'+_0x1806cc,'customer':_0x3b8b06,'reason':_0xf522fa(0x1dd),'amount':_0x467a66}),_0x510a99=await _0x467613[_0xf522fa(0x166)]();_0x47734c[_0xf522fa(0xfb)](_0xf522fa(0x1dc),'payment\x20successfull'),_0xf586b0[_0xf522fa(0x1b4)](_0xf522fa(0x11a));}catch(_0x21aa9d){console[_0xf522fa(0x1d6)](_0x21aa9d);}}),router[a0_0x3fd6a7(0x15d)]('/invoice/:id',auth,async(_0xe07a79,_0x32d7d0)=>{var _0x23db30=a0_0x3fd6a7;try{const {username:_0x208b96,email:_0x4dc64a,role:_0x73561b}=_0xe07a79['user'],_0x4c8931=_0xe07a79[_0x23db30(0x1be)],_0x176644=await profile[_0x23db30(0x144)]({'email':_0x4c8931['email']}),_0x13b85b=await master_shop[_0x23db30(0x14c)]();console[_0x23db30(0x1d6)](_0x23db30(0x156),_0x13b85b);const _0x38af71=_0xe07a79[_0x23db30(0x154)]['id'],_0x449511=await sales[_0x23db30(0x187)](_0x38af71);console[_0x23db30(0x1d6)](_0x449511);const _0x298862=await customer[_0x23db30(0x144)]({'name':_0x449511['customer']});console[_0x23db30(0x1d6)](_0x298862);if(_0x13b85b[0x0][_0x23db30(0x1f7)]==_0x23db30(0x140)){var _0xa607e=users['English'];console['log'](_0xa607e);}else{if(_0x13b85b[0x0][_0x23db30(0x1f7)]==_0x23db30(0x149))var _0xa607e=users[_0x23db30(0x149)];else{if(_0x13b85b[0x0][_0x23db30(0x1f7)]==_0x23db30(0x14a))var _0xa607e=users[_0x23db30(0x14a)];else{if(_0x13b85b[0x0][_0x23db30(0x1f7)]=='Spanish')var _0xa607e=users[_0x23db30(0x14f)];else{if(_0x13b85b[0x0]['language']==_0x23db30(0x1e0))var _0xa607e=users[_0x23db30(0x1e0)];else{if(_0x13b85b[0x0]['language']==_0x23db30(0x17f))var _0xa607e=users['Portuguese'];else{if(_0x13b85b[0x0][_0x23db30(0x1f7)]=='Chinese')var _0xa607e=users[_0x23db30(0x1a7)];else{if(_0x13b85b[0x0][_0x23db30(0x1f7)]==_0x23db30(0x1e2))var _0xa607e=users['Arabic'];}}}}}}}_0x32d7d0[_0x23db30(0x17e)](_0x23db30(0x1a1),{'success':_0xe07a79[_0x23db30(0xfb)]('success'),'errors':_0xe07a79[_0x23db30(0xfb)](_0x23db30(0x188)),'role':_0x4c8931,'profile':_0x176644,'master_shop':_0x13b85b,'customers':_0x298862,'sales':_0x449511,'language':_0xa607e});}catch(_0x4d0d22){console[_0x23db30(0x1d6)](_0x4d0d22);}}),router[a0_0x3fd6a7(0x15d)]('/view/return_sales/:id',auth,async(_0x286504,_0x1567b1)=>{var _0x4ae392=a0_0x3fd6a7;try{const {username:_0x462cb6,email:_0x3a16e3,role:_0x218a4d}=_0x286504[_0x4ae392(0x1be)],_0x2d9eb1=_0x286504[_0x4ae392(0x1be)],_0x12ee99=await profile[_0x4ae392(0x144)]({'email':_0x2d9eb1[_0x4ae392(0x12a)]}),_0x1073d0=await master_shop[_0x4ae392(0x14c)](),_0x2323ad=_0x286504['params']['id'],_0x39fcc9=await sales_finished['findById'](_0x2323ad),_0x87fde7=await warehouse[_0x4ae392(0x110)]([{'$match':{'name':_0x39fcc9[_0x4ae392(0x10a)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4ae392(0x13e)},'product_stock':{'$first':_0x4ae392(0x141)},'bay':{'$first':_0x4ae392(0x183)},'bin':{'$first':_0x4ae392(0x147)},'type':{'$first':_0x4ae392(0xf2)},'floorlevel':{'$first':_0x4ae392(0x193)},'primary_code':{'$first':_0x4ae392(0x179)},'secondary_code':{'$first':_0x4ae392(0x1a8)},'product_code':{'$first':_0x4ae392(0x10c)},'storage':{'$first':_0x4ae392(0x105)},'rack':{'$first':_0x4ae392(0x123)},'expiry_date':{'$first':_0x4ae392(0x148)},'production_date':{'$first':_0x4ae392(0x10b)},'unit':{'$first':_0x4ae392(0x17d)},'secondary_unit':{'$first':_0x4ae392(0x1b2)},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x4ae392(0x205)},'maxPerUnit':{'$first':_0x4ae392(0x13a)}}}]),_0x51b22c=await product[_0x4ae392(0x14c)]({}),_0x423a96=await warehouse['aggregate']([{'$match':{'status':_0x4ae392(0x169),'warehouse_category':_0x4ae392(0x132),'name':{'$ne':_0x4ae392(0x13c),'$ne':_0x4ae392(0x16d)}}},{'$group':{'_id':'$name','name':{'$first':_0x4ae392(0x16c)}}},{'$sort':{'name':0x1}}]);var _0x669abc=[_0x4ae392(0x1b0)];const _0x1bcb87=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x4ae392(0x16d)}},{'$group':{'_id':_0x4ae392(0x16c),'name':{'$first':_0x4ae392(0x16c)}}},{'$sort':{'name':0x1}}]);if(_0x1073d0[0x0][_0x4ae392(0x1f7)]==_0x4ae392(0x140)){var _0x39700b=users[_0x4ae392(0x1f5)];console[_0x4ae392(0x1d6)](_0x39700b);}else{if(_0x1073d0[0x0][_0x4ae392(0x1f7)]==_0x4ae392(0x149))var _0x39700b=users[_0x4ae392(0x149)];else{if(_0x1073d0[0x0][_0x4ae392(0x1f7)]=='German')var _0x39700b=users[_0x4ae392(0x14a)];else{if(_0x1073d0[0x0][_0x4ae392(0x1f7)]==_0x4ae392(0x14f))var _0x39700b=users[_0x4ae392(0x14f)];else{if(_0x1073d0[0x0][_0x4ae392(0x1f7)]==_0x4ae392(0x1e0))var _0x39700b=users[_0x4ae392(0x1e0)];else{if(_0x1073d0[0x0][_0x4ae392(0x1f7)]==_0x4ae392(0x17f))var _0x39700b=users[_0x4ae392(0x175)];else{if(_0x1073d0[0x0]['language']==_0x4ae392(0x1a7))var _0x39700b=users[_0x4ae392(0x1a7)];else{if(_0x1073d0[0x0][_0x4ae392(0x1f7)]==_0x4ae392(0x1e2))var _0x39700b=users['Arabic'];}}}}}}}_0x1567b1['render'](_0x4ae392(0x1f1),{'success':_0x286504[_0x4ae392(0xfb)](_0x4ae392(0x1dc)),'errors':_0x286504[_0x4ae392(0xfb)](_0x4ae392(0x188)),'role':_0x2d9eb1,'profile':_0x12ee99,'user':_0x39fcc9,'stock':_0x87fde7,'master_shop':_0x1073d0,'unit':_0x51b22c,'language':_0x39700b,'warehouses':_0x423a96,'rooms':_0x669abc,'warehouse_QA':_0x1bcb87});}catch(_0x405969){console['log'](_0x405969),_0x1567b1[_0x4ae392(0x128)](0xc8)[_0x4ae392(0x1af)]({'message':_0x405969['message']});}}),router[a0_0x3fd6a7(0x1aa)](a0_0x3fd6a7(0x135),auth,async(_0x11a81b,_0x5e8736)=>{var _0x2b029e=a0_0x3fd6a7;if(_0x11a81b[_0x2b029e(0x1f9)]['for_categorize']=='QA')try{const {invoice:_0x4e05e6,date:_0x14bc38,warehouse_name:_0x1097a5,product_name:_0x5c1474,primary_code:_0x54651a,secondary_code:_0x1e2aeb,product_code:_0x1b985a,sales_quantity:_0x102a23,stocks:_0x5de575,return_qty:_0x58c091,Room_name:_0x538261,to_warehouse_name_QA:_0x24cb6c,to_Room_name_QA:_0x2a3f5c,note:_0x50e892,for_categorize:_0xdd9351,product_name_QA1:_0x5e30ef}=_0x11a81b[_0x2b029e(0x1f9)];if(typeof _0x5e30ef==_0x2b029e(0x1cf))var _0x57a061=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x107)]],_0x483f8b=[_0x11a81b['body']['primary_code_QA']],_0x1f2967=[_0x11a81b[_0x2b029e(0x1f9)]['secondary_code_QA']],_0x4302d1=[_0x11a81b[_0x2b029e(0x1f9)]['product_code_QA']],_0x45feb7=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1f2)]],_0x2fff9d=[_0x11a81b[_0x2b029e(0x1f9)]['stocks_QA']],_0x275e85=[_0x11a81b['body'][_0x2b029e(0x16b)]],_0x190e03=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x127)]],_0x2737cc=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x194)]],_0x48de0b=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x120)]],_0x1c7614=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x112)]],_0x4ed6d1=[_0x11a81b['body'][_0x2b029e(0x1ad)]],_0x15ad4e=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x196)]],_0x3fa2f5=[_0x11a81b['body'][_0x2b029e(0x1ca)]];else var _0x57a061=[..._0x11a81b['body'][_0x2b029e(0x107)]],_0x483f8b=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0xf6)]],_0x1f2967=[..._0x11a81b[_0x2b029e(0x1f9)]['secondary_code_QA']],_0x4302d1=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1fb)]],_0x45feb7=[..._0x11a81b['body'][_0x2b029e(0x1f2)]],_0x2fff9d=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x117)]],_0x275e85=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x16b)]],_0x190e03=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x127)]],_0x2737cc=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x194)]],_0x48de0b=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x120)]],_0x1c7614=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x112)]],_0x4ed6d1=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1ad)]],_0x15ad4e=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x196)]],_0x3fa2f5=[..._0x11a81b['body']['expiry_date_QA']];const _0x23ab31=_0x57a061[_0x2b029e(0x199)](_0x31e1d4=>{return _0x31e1d4={'product_name':_0x31e1d4};});_0x483f8b[_0x2b029e(0x118)]((_0x4cfe53,_0x5068e7)=>{_0x23ab31[_0x5068e7]['primary_code']=_0x4cfe53;}),_0x1f2967[_0x2b029e(0x118)]((_0x263c72,_0x328c1a)=>{var _0x3511da=_0x2b029e;_0x23ab31[_0x328c1a][_0x3511da(0x116)]=_0x263c72;}),_0x4302d1[_0x2b029e(0x118)]((_0x27a91e,_0x3ba56d)=>{_0x23ab31[_0x3ba56d]['product_code']=_0x27a91e;}),_0x45feb7['forEach']((_0x131f2b,_0x5752bb)=>{var _0x1c7a54=_0x2b029e;_0x23ab31[_0x5752bb][_0x1c7a54(0x17c)]=_0x131f2b;}),_0x2fff9d[_0x2b029e(0x118)]((_0x21a04f,_0x3ac855)=>{var _0x43d0b8=_0x2b029e;_0x23ab31[_0x3ac855][_0x43d0b8(0x14b)]=_0x21a04f;}),_0x275e85[_0x2b029e(0x118)]((_0x47d9c8,_0x556c12)=>{_0x23ab31[_0x556c12]['return_qty']=_0x47d9c8;}),_0x190e03['forEach']((_0x1c16e3,_0x21fdf2)=>{var _0x26536a=_0x2b029e;_0x23ab31[_0x21fdf2][_0x26536a(0x1a5)]=_0x1c16e3;}),_0x2737cc['forEach']((_0x2c89a4,_0x4bb075)=>{var _0x2eb481=_0x2b029e;_0x23ab31[_0x4bb075][_0x2eb481(0x155)]=_0x2c89a4;}),_0x48de0b['forEach']((_0x4f1161,_0x40d6e9)=>{var _0x397b7b=_0x2b029e;_0x23ab31[_0x40d6e9][_0x397b7b(0x134)]=_0x4f1161;}),_0x1c7614[_0x2b029e(0x118)]((_0x51b0d8,_0xa75cbd)=>{var _0x133e9f=_0x2b029e;_0x23ab31[_0xa75cbd][_0x133e9f(0x10d)]=_0x51b0d8;}),_0x4ed6d1[_0x2b029e(0x118)]((_0x1b7dba,_0xd07cb7)=>{_0x23ab31[_0xd07cb7]['unit']=_0x1b7dba;}),_0x15ad4e['forEach']((_0x43510c,_0x42bb04)=>{var _0x9b9410=_0x2b029e;_0x23ab31[_0x42bb04][_0x9b9410(0x19c)]=_0x43510c;}),_0x3fa2f5['forEach']((_0x336012,_0x4fe11c)=>{var _0x4ffd5a=_0x2b029e;_0x23ab31[_0x4fe11c][_0x4ffd5a(0x130)]=_0x336012;});const _0x525ea9=await sales_finished['findOne']({'invoice':_0x4e05e6});_0x525ea9[_0x2b029e(0x1b1)]='True';const _0x3722d6=await _0x525ea9['save'](),_0x2ddb7f=new sales_return_finished({'invoice':_0x4e05e6,'customer':_0x11a81b['body'][_0x2b029e(0xff)],'date':_0x14bc38,'warehouse_name':_0x1097a5,'room':_0x538261,'ToWarehouse':_0x24cb6c,'ToRoom':_0x2a3f5c,'return_sale_QA':_0x23ab31,'note':_0x50e892,'warehouse_cat':_0xdd9351}),_0x2aa10b=await _0x2ddb7f[_0x2b029e(0x166)](),_0x41dd39=await sales_return_finished['findOne']({'invoice':_0x4e05e6}),_0x44bfd8=await warehouse[_0x2b029e(0x144)]({'name':_0x24cb6c,'room':_0x2a3f5c});_0x41dd39[_0x2b029e(0x1ba)]['forEach'](_0x4fef7d=>{var _0x3d7b68=_0x2b029e,_0x471c16=0x0;const _0x7201cf=_0x44bfd8[_0x3d7b68(0x163)][_0x3d7b68(0x199)](_0x254deb=>{var _0x4cb29=_0x3d7b68;_0x254deb['product_name']==_0x4fef7d[_0x4cb29(0x1c4)]&&_0x254deb[_0x4cb29(0x130)]==_0x4fef7d['expiry_date']&&_0x254deb['production_date']==_0x4fef7d[_0x4cb29(0x19c)]&&_0x254deb['batch_code']==_0x4fef7d[_0x4cb29(0x134)]&&(_0x254deb['product_stock']=parseInt(_0x254deb[_0x4cb29(0x102)])+parseInt(_0x4fef7d[_0x4cb29(0x19d)]),_0x471c16++);});_0x471c16=='0'&&(_0x44bfd8[_0x3d7b68(0x163)]=_0x44bfd8[_0x3d7b68(0x163)][_0x3d7b68(0x100)]({'product_name':_0x4fef7d['product_name'],'product_stock':_0x4fef7d['return_qty'],'primary_code':_0x4fef7d['primary_code'],'secondary_code':_0x4fef7d['secondary_code'],'product_code':_0x4fef7d[_0x3d7b68(0x1c8)],'batch_code':_0x4fef7d[_0x3d7b68(0x134)],'maxPerUnit':_0x4fef7d[_0x3d7b68(0x1a5)],'production_date':_0x4fef7d['production_date'],'expiry_date':_0x4fef7d['expiry_date'],'secondary_unit':_0x4fef7d[_0x3d7b68(0x10d)],'unit':_0x4fef7d[_0x3d7b68(0x1a3)],'maxProducts':_0x4fef7d['maxProducts'],'bay':_0x4fef7d[_0x3d7b68(0x143)]}));}),await _0x44bfd8[_0x2b029e(0x166)]();const _0x1447d7=new c_payment_data({'invoice':_0x4e05e6,'customer':_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0xff)],'reason':'Sale\x20Return'});await _0x1447d7[_0x2b029e(0x166)]();const _0x3ecb17=await master_shop[_0x2b029e(0x14c)](),_0x48f4c3=await email_settings[_0x2b029e(0x144)](),_0x3e9590=await customer[_0x2b029e(0x144)]({'name':_0x11a81b['body'][_0x2b029e(0xff)]});_0x3ecb17[0x0][_0x2b029e(0x136)]==0x1?(right_currency=_0x3ecb17[0x0][_0x2b029e(0x1a9)],left_currency=''):(right_currency='',left_currency=_0x3ecb17[0x0][_0x2b029e(0x1a9)]);var _0x63f1ca=_0x57a061,_0x2301bd=_0x275e85,_0x24011b='',_0x15a179;for(_0x15a179 in _0x63f1ca){_0x24011b+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x63f1ca[_0x15a179]+_0x2b029e(0x11d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2301bd[_0x15a179]+_0x2b029e(0x11d)+_0x2b029e(0x108);}console['log'](_0x2b029e(0xf7),_0x24011b);let _0x32d310=nodemailer[_0x2b029e(0x1f3)]({'service':_0x2b029e(0x18c),'auth':{'user':_0x48f4c3[_0x2b029e(0x12a)],'pass':_0x48f4c3['password']}}),_0xca4d40={'from':_0x48f4c3[_0x2b029e(0x12a)],'to':_0x3e9590[_0x2b029e(0x12a)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x2b029e(0x11c),'path':__dirname+_0x2b029e(0x14d)+_0x2b029e(0x186)+_0x3ecb17[0x0]['image'],'cid':'logo'}],'html':_0x2b029e(0x164)+_0x2b029e(0x142)+'</head><body>'+_0x2b029e(0xfa)+_0x2b029e(0x133)+_0x2b029e(0xfa)+_0x2b029e(0x172)+_0x2b029e(0xf9)+_0x2b029e(0xfa)+_0x2b029e(0x1ac)+_0x3ecb17[0x0][_0x2b029e(0x101)]+_0x2b029e(0x182)+_0x2b029e(0xf9)+_0x2b029e(0xf9)+_0x2b029e(0x18e)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x2b029e(0x1ef)+_0x4e05e6+'\x20'+_0x2b029e(0x1a2)+'\x20Order\x20Date\x20:\x20'+_0x14bc38+'\x20'+_0x2b029e(0x159)+_0x2b029e(0x109)+_0x2b029e(0xf9)+_0x2b029e(0x122)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2b029e(0x1eb)+_0x2b029e(0x113)+_0x2b029e(0x1d4)+_0x2b029e(0x15a)+_0x2b029e(0x1e6)+'</tr>'+_0x2b029e(0x165)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x24011b+'\x20'+'</tbody>'+_0x2b029e(0x1bd)+_0x2b029e(0xfa)+'<strong>\x20Regards\x20</strong>'+_0x2b029e(0x200)+_0x3ecb17[0x0][_0x2b029e(0x101)]+_0x2b029e(0x109)+_0x2b029e(0xf9)+'</div>'+_0x2b029e(0x1a6)};_0x32d310['sendMail'](_0xca4d40,function(_0x2f431c,_0xc07ac0){var _0x51fdb5=_0x2b029e;_0x2f431c?(console[_0x51fdb5(0x1d6)](_0x2f431c),console['log'](_0x51fdb5(0x19f))):console[_0x51fdb5(0x1d6)](_0x51fdb5(0x1cb));}),_0x11a81b[_0x2b029e(0xfb)](_0x2b029e(0x1dc),'sales\x20item\x20return\x20successfull'),_0x5e8736[_0x2b029e(0x1b4)]('/all_sales_finished/view');}catch(_0x5437d2){_0x5e8736[_0x2b029e(0x128)](0xc8)['json']({'message1':_0x5437d2[_0x2b029e(0x190)]});}else{if(_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0xf3)]=='GS')try{const {invoice:_0x5559cf,date:_0x4a632e,warehouse_name:_0x40a2d0,product_name:_0x166009,primary_code:_0x357d2a,secondary_code:_0x1bc9f0,product_code:_0x4db23e,sales_quantity:_0x3ec635,stocks:_0x1edf57,return_qty:_0x4a6ff6,Room_name:_0x3c25a8,to_warehouse_name:_0x57461c,to_Room_name:_0x4a962d,note:_0x46f0f4,level:_0x5d1177,isle:_0x1c4e5b,pallet:_0x53aed1,for_categorize:_0x121a15}=_0x11a81b['body'];if(typeof _0x166009==_0x2b029e(0x1cf))var _0x57a061=[_0x11a81b[_0x2b029e(0x1f9)]['product_name']],_0x483f8b=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x13f)]],_0x1f2967=[_0x11a81b[_0x2b029e(0x1f9)]['secondary_code']],_0x4302d1=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1c8)]],_0x45feb7=[_0x11a81b['body'][_0x2b029e(0x18d)]],_0x275e85=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x19d)]],_0x43ba45=[_0x11a81b['body'][_0x2b029e(0x143)]],_0x190e03=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1a5)]],_0x2737cc=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x155)]],_0x48de0b=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x134)]],_0x1c7614=[_0x11a81b['body']['secondary_unit']],_0x4ed6d1=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1a3)]],_0x15ad4e=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x19c)]],_0x3fa2f5=[_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x130)]];else var _0x57a061=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1c4)]],_0x483f8b=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x13f)]],_0x1f2967=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x116)]],_0x4302d1=[..._0x11a81b['body'][_0x2b029e(0x1c8)]],_0x45feb7=[..._0x11a81b['body'][_0x2b029e(0x18d)]],_0x275e85=[..._0x11a81b['body'][_0x2b029e(0x19d)]],_0x43ba45=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x143)]],_0x190e03=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x1a5)]],_0x2737cc=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x155)]],_0x48de0b=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x134)]],_0x1c7614=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x10d)]],_0x4ed6d1=[..._0x11a81b['body'][_0x2b029e(0x1a3)]],_0x15ad4e=[..._0x11a81b[_0x2b029e(0x1f9)]['production_date']],_0x3fa2f5=[..._0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0x130)]];const _0x2d9505=_0x57a061['map'](_0x1af601=>{return _0x1af601={'product_name':_0x1af601};});_0x483f8b['forEach']((_0x15c2fa,_0x51a193)=>{var _0x10252e=_0x2b029e;_0x2d9505[_0x51a193][_0x10252e(0x13f)]=_0x15c2fa;}),_0x1f2967['forEach']((_0x36e1d4,_0x568276)=>{var _0x5accaa=_0x2b029e;_0x2d9505[_0x568276][_0x5accaa(0x116)]=_0x36e1d4;}),_0x4302d1['forEach']((_0x4146c6,_0x45ce35)=>{var _0xbf2896=_0x2b029e;_0x2d9505[_0x45ce35][_0xbf2896(0x1c8)]=_0x4146c6;}),_0x45feb7[_0x2b029e(0x118)]((_0x8966ff,_0x306eaa)=>{_0x2d9505[_0x306eaa]['sale_qty']=_0x8966ff;}),_0x275e85[_0x2b029e(0x118)]((_0x20e746,_0x169bcb)=>{_0x2d9505[_0x169bcb]['return_qty']=_0x20e746;}),_0x43ba45[_0x2b029e(0x118)]((_0x54b285,_0x79dd34)=>{var _0x2e9af6=_0x2b029e;_0x2d9505[_0x79dd34][_0x2e9af6(0x143)]=_0x54b285;}),_0x190e03[_0x2b029e(0x118)]((_0x5c440f,_0x54cd85)=>{var _0x5bef93=_0x2b029e;_0x2d9505[_0x54cd85][_0x5bef93(0x1a5)]=_0x5c440f;}),_0x2737cc[_0x2b029e(0x118)]((_0x251b0a,_0x398a48)=>{_0x2d9505[_0x398a48]['maxProducts']=_0x251b0a;}),_0x48de0b[_0x2b029e(0x118)]((_0x2109a5,_0x13e396)=>{_0x2d9505[_0x13e396]['batch_code']=_0x2109a5;}),_0x1c7614[_0x2b029e(0x118)]((_0x3e3768,_0x114c47)=>{_0x2d9505[_0x114c47]['secondary_unit']=_0x3e3768;}),_0x4ed6d1['forEach']((_0x1d6659,_0x234429)=>{var _0x13ae2d=_0x2b029e;_0x2d9505[_0x234429][_0x13ae2d(0x1a3)]=_0x1d6659;}),_0x15ad4e[_0x2b029e(0x118)]((_0x78c42c,_0x4802b8)=>{var _0x39489f=_0x2b029e;_0x2d9505[_0x4802b8][_0x39489f(0x19c)]=_0x78c42c;}),_0x3fa2f5[_0x2b029e(0x118)]((_0x3fb778,_0x7d7826)=>{var _0x9dca5a=_0x2b029e;_0x2d9505[_0x7d7826][_0x9dca5a(0x130)]=_0x3fb778;});var _0x5133a1=0x0;_0x2d9505[_0x2b029e(0x118)](_0x300e31=>{var _0x443ea0=_0x2b029e;(parseInt(_0x300e31[_0x443ea0(0x17c)])<parseInt(_0x300e31[_0x443ea0(0x19d)])||parseInt(_0x300e31[_0x443ea0(0x14b)])<parseInt(_0x300e31['return_qty'])&&parseInt(_0x300e31['sale_qty'])>parseInt(_0x300e31[_0x443ea0(0x19d)])||parseInt(_0x300e31[_0x443ea0(0x19d)])==0x0)&&_0x5133a1++;});if(_0x5133a1!=0x0)return _0x11a81b[_0x2b029e(0xfb)]('errors',_0x2b029e(0x121)),_0x5e8736[_0x2b029e(0x1b4)]('back');const _0x1b9b4d=await sales_finished['findOne']({'invoice':_0x5559cf});_0x1b9b4d[_0x2b029e(0x1b1)]=_0x2b029e(0x195);const _0x4cefc9=await _0x1b9b4d[_0x2b029e(0x166)](),_0xfcf97d=new sales_return_finished({'invoice':_0x5559cf,'customer':_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0xff)],'date':_0x4a632e,'warehouse_name':_0x40a2d0,'room':_0x3c25a8,'ToWarehouse':_0x57461c,'ToRoom':_0x4a962d,'return_sale':_0x2d9505,'note':_0x46f0f4,'warehouse_cat':_0x121a15}),_0x1f1371=await _0xfcf97d[_0x2b029e(0x166)](),_0x229d05=await sales_return_finished[_0x2b029e(0x144)]({'invoice':_0x5559cf}),_0x180c2a=await warehouse[_0x2b029e(0x144)]({'name':_0x57461c,'room':_0x4a962d,'warehouse_category':'Finished\x20Goods'});_0x229d05[_0x2b029e(0x1d7)][_0x2b029e(0x118)](_0x10b6ac=>{var _0x36ccf9=_0x2b029e,_0x565042=0x0;const _0x43b807=_0x180c2a[_0x36ccf9(0x163)][_0x36ccf9(0x199)](_0x506202=>{var _0x15f61b=_0x36ccf9;_0x506202[_0x15f61b(0x1c4)]==_0x10b6ac['product_name']&&_0x506202['bay']==_0x10b6ac[_0x15f61b(0x143)]&&_0x506202['expiry_date']==_0x10b6ac['expiry_date']&&_0x506202[_0x15f61b(0x19c)]==_0x10b6ac[_0x15f61b(0x19c)]&&_0x506202[_0x15f61b(0x134)]==_0x10b6ac['batch_code']&&(_0x506202[_0x15f61b(0x102)]=parseInt(_0x506202[_0x15f61b(0x102)])+parseInt(_0x10b6ac[_0x15f61b(0x19d)]),_0x565042++);});_0x565042=='0'&&(_0x180c2a[_0x36ccf9(0x163)]=_0x180c2a['product_details']['concat']({'product_name':_0x10b6ac['product_name'],'product_stock':_0x10b6ac[_0x36ccf9(0x19d)],'primary_code':_0x10b6ac['primary_code'],'secondary_code':_0x10b6ac['secondary_code'],'product_code':_0x10b6ac[_0x36ccf9(0x1c8)],'bay':_0x10b6ac[_0x36ccf9(0x143)],'batch_code':_0x10b6ac[_0x36ccf9(0x134)],'maxPerUnit':_0x10b6ac[_0x36ccf9(0x1a5)],'production_date':_0x10b6ac[_0x36ccf9(0x19c)],'expiry_date':_0x10b6ac[_0x36ccf9(0x130)],'secondary_unit':_0x10b6ac[_0x36ccf9(0x10d)],'unit':_0x10b6ac[_0x36ccf9(0x1a3)],'maxProducts':_0x10b6ac[_0x36ccf9(0x155)]}));}),await _0x180c2a[_0x2b029e(0x166)](),console[_0x2b029e(0x1d6)](_0x11a81b[_0x2b029e(0x1f9)]);const _0x2403de=new c_payment_data({'invoice':_0x5559cf,'customer':_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0xff)],'reason':_0x2b029e(0xfc)});await _0x2403de[_0x2b029e(0x166)]();const _0x5da513=await master_shop[_0x2b029e(0x14c)]();console[_0x2b029e(0x1d6)](_0x2b029e(0x1e4),_0x5da513[0x0]['image']);const _0x426b3c=await email_settings[_0x2b029e(0x144)](),_0x10b994=await customer[_0x2b029e(0x144)]({'name':_0x11a81b[_0x2b029e(0x1f9)][_0x2b029e(0xff)]});console['log'](_0x2b029e(0x1ab),_0x10b994);_0x5da513[0x0][_0x2b029e(0x136)]==0x1?(right_currency=_0x5da513[0x0][_0x2b029e(0x1a9)],left_currency=''):(right_currency='',left_currency=_0x5da513[0x0][_0x2b029e(0x1a9)]);var _0x63f1ca=_0x57a061,_0x2301bd=_0x275e85,_0x24011b='',_0x15a179;for(_0x15a179 in _0x63f1ca){_0x24011b+=_0x2b029e(0x1eb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x63f1ca[_0x15a179]+_0x2b029e(0x11d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2301bd[_0x15a179]+_0x2b029e(0x11d)+_0x2b029e(0x108);}console[_0x2b029e(0x1d6)]('product_list',_0x24011b);let _0x524d4f=nodemailer['createTransport']({'service':_0x2b029e(0x18c),'auth':{'user':_0x426b3c[_0x2b029e(0x12a)],'pass':_0x426b3c[_0x2b029e(0x106)]}}),_0x10dd68={'from':_0x426b3c[_0x2b029e(0x12a)],'to':_0x10b994[_0x2b029e(0x12a)],'subject':_0x2b029e(0x1e1),'attachments':[{'filename':_0x2b029e(0x11c),'path':__dirname+_0x2b029e(0x14d)+'/upload/'+_0x5da513[0x0][_0x2b029e(0x1ff)],'cid':_0x2b029e(0x197)}],'html':_0x2b029e(0x164)+_0x2b029e(0x142)+'</head><body>'+_0x2b029e(0xfa)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x2b029e(0xfa)+_0x2b029e(0x1ac)+_0x5da513[0x0][_0x2b029e(0x101)]+_0x2b029e(0x182)+_0x2b029e(0xf9)+_0x2b029e(0xf9)+_0x2b029e(0x18e)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x2b029e(0x1ef)+_0x5559cf+'\x20'+_0x2b029e(0x1a2)+_0x2b029e(0x191)+_0x4a632e+'\x20'+_0x2b029e(0x159)+'</h5>'+_0x2b029e(0xf9)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2b029e(0x157)+_0x2b029e(0x1eb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2b029e(0x1d4)+_0x2b029e(0x15a)+_0x2b029e(0x1e6)+'</tr>'+_0x2b029e(0x165)+_0x2b029e(0x1f8)+'\x20'+_0x24011b+'\x20'+_0x2b029e(0x1e3)+'</table>'+_0x2b029e(0xfa)+_0x2b029e(0x19e)+_0x2b029e(0x200)+_0x5da513[0x0][_0x2b029e(0x101)]+'</h5>'+_0x2b029e(0xf9)+_0x2b029e(0xf9)+'</body></html>'};_0x524d4f['sendMail'](_0x10dd68,function(_0x39680b,_0x2e1570){var _0x37de2b=_0x2b029e;_0x39680b?(console['log'](_0x39680b),console[_0x37de2b(0x1d6)](_0x37de2b(0x19f))):console[_0x37de2b(0x1d6)](_0x37de2b(0x1cb));}),_0x11a81b[_0x2b029e(0xfb)]('success',_0x2b029e(0x124)),_0x5e8736[_0x2b029e(0x1b4)](_0x2b029e(0x1de));}catch(_0x2870d3){console[_0x2b029e(0x1d6)](_0x2870d3),_0x5e8736[_0x2b029e(0x128)](0xc8)[_0x2b029e(0x1af)]({'message1':_0x2870d3[_0x2b029e(0x190)]});}}}),router[a0_0x3fd6a7(0x15d)](a0_0x3fd6a7(0x198),auth,async(_0x12993c,_0x3ddb1e)=>{var _0x421dc9=a0_0x3fd6a7;try{const {username:_0x4d644c,email:_0x214e0c,role:_0x398559}=_0x12993c['user'],_0x445f04=_0x12993c[_0x421dc9(0x1be)],_0x95de46=await profile[_0x421dc9(0x144)]({'email':_0x445f04[_0x421dc9(0x12a)]}),_0xb44c3c=await master_shop[_0x421dc9(0x14c)]();console[_0x421dc9(0x1d6)](_0x421dc9(0x15e),_0xb44c3c);const _0x4c5d58=_0x12993c[_0x421dc9(0x154)]['id'],_0x262516=await sales['findById'](_0x4c5d58);console[_0x421dc9(0x1d6)](_0x421dc9(0x1f0),_0x262516);if(_0xb44c3c[0x0][_0x421dc9(0x1f7)]=='English\x20(US)')var _0x3565ec=users[_0x421dc9(0x1f5)];else{if(_0xb44c3c[0x0][_0x421dc9(0x1f7)]=='Hindi')var _0x3565ec=users[_0x421dc9(0x149)];else{if(_0xb44c3c[0x0]['language']==_0x421dc9(0x14a))var _0x3565ec=users[_0x421dc9(0x14a)];else{if(_0xb44c3c[0x0]['language']==_0x421dc9(0x14f))var _0x3565ec=users['Spanish'];else{if(_0xb44c3c[0x0][_0x421dc9(0x1f7)]==_0x421dc9(0x1e0))var _0x3565ec=users[_0x421dc9(0x1e0)];else{if(_0xb44c3c[0x0][_0x421dc9(0x1f7)]==_0x421dc9(0x17f))var _0x3565ec=users['Portuguese'];else{if(_0xb44c3c[0x0]['language']==_0x421dc9(0x1a7))var _0x3565ec=users[_0x421dc9(0x1a7)];else{if(_0xb44c3c[0x0][_0x421dc9(0x1f7)]==_0x421dc9(0x1e2))var _0x3565ec=users[_0x421dc9(0x1ed)];}}}}}}}_0x3ddb1e[_0x421dc9(0x17e)](_0x421dc9(0x11e),{'success':_0x12993c[_0x421dc9(0xfb)](_0x421dc9(0x1dc)),'errors':_0x12993c[_0x421dc9(0xfb)](_0x421dc9(0x188)),'role':_0x445f04,'profile':_0x95de46,'alldata':_0x262516,'master_shop':_0xb44c3c,'language':_0x3565ec});}catch(_0x27cd23){console[_0x421dc9(0x1d6)](_0x27cd23);}}),router[a0_0x3fd6a7(0x1aa)](a0_0x3fd6a7(0x151),async(_0x29663f,_0x3a8d79)=>{var _0xbde8c1=a0_0x3fd6a7;const {product_code:_0x5da0b2,warehouse_name:_0x15050f,rooms_data:_0x3e0ac4,Roomslist:_0x320a85}=_0x29663f['body'],_0x3b9a4e=_0x320a85[_0xbde8c1(0x1b8)](','),_0x231171=[];async function _0x58a315(_0x21cad1){var _0x4d507a=_0xbde8c1;const _0xb50aba=await warehouse[_0x4d507a(0x110)]([{'$match':{'name':_0x15050f,'room':_0x21cad1}},{'$unwind':_0x4d507a(0x1d0)},{'$match':{'product_details.primary_code':_0x5da0b2}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4d507a(0x13e)},'product_stock':{'$first':_0x4d507a(0x141)},'primary_code':{'$first':_0x4d507a(0x179)},'secondary_code':{'$first':_0x4d507a(0x1a8)},'product_code':{'$first':_0x4d507a(0x10c)},'level':{'$first':_0x4d507a(0x183)},'isle':{'$first':_0x4d507a(0x147)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x4d507a(0x193)},'unit':{'$first':_0x4d507a(0x17d)},'secondary_unit':{'$first':_0x4d507a(0x1b2)},'storage':{'$first':_0x4d507a(0x105)},'rack':{'$first':_0x4d507a(0x123)},'expiry_date':{'$first':_0x4d507a(0x148)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x4d507a(0x13a)},'batch_code':{'$first':_0x4d507a(0x205)},'product_cat':{'$first':_0x4d507a(0x19b)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x4d507a(0x11b)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x48e099=await warehouse[_0x4d507a(0x110)]([{'$match':{'name':_0x15050f,'room':_0x21cad1}},{'$unwind':_0x4d507a(0x1d0)},{'$match':{'product_details.secondary_code':_0x5da0b2}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4d507a(0x13e)},'product_stock':{'$first':_0x4d507a(0x141)},'primary_code':{'$first':_0x4d507a(0x179)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4d507a(0x183)},'isle':{'$first':_0x4d507a(0x147)},'type':{'$first':_0x4d507a(0xf2)},'pallet':{'$first':_0x4d507a(0x193)},'unit':{'$first':_0x4d507a(0x17d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x4d507a(0x105)},'rack':{'$first':_0x4d507a(0x123)},'expiry_date':{'$first':_0x4d507a(0x148)},'production_date':{'$first':_0x4d507a(0x10b)},'maxPerUnit':{'$first':_0x4d507a(0x13a)},'batch_code':{'$first':_0x4d507a(0x205)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0xb50aba[_0x4d507a(0x170)]>0x0)_0x231171[_0x4d507a(0x203)](_0xb50aba);else _0x48e099[_0x4d507a(0x170)]>0x0&&_0x231171['push'](_0x48e099);}const _0x4216b2=_0x3b9a4e[_0xbde8c1(0x199)](_0x492740=>_0x58a315(_0x492740));await Promise[_0xbde8c1(0x131)](_0x4216b2),_0x3a8d79[_0xbde8c1(0x1af)](_0x231171);}),module[a0_0x3fd6a7(0x12b)]=router;