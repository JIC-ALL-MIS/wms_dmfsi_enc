function a0_0x5644(){var _0x307a03=['filter','return_qty','$return_data','False','suppliers','sales_quantity_QA','abs','$product_details.bay','getMonth','return_data','findById','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','success','map','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','carton','adjust_qty','Return\x20Rooms','/view/add_sales/:id','max_per_unit','/all_sales_finished/view','$product_details.product_stock','redirect','$finalize','OUTF-','sale_product','<table\x20style=\x22width:\x20100%\x20!important;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','26xrSQIP','<h5>','/all_sales/view','138467QpcxNO','product_details','50494dukeIa','DRY\x20GOODS','express','Enabled','Sale','Arabic','all_sales_barcode','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','floor','sendMail','payment\x20successfull','<!DOCTYPE\x20html>','<tbody\x20style=\x22text-align:\x20center;\x22>','back','\x20Order\x20Date\x20:\x20','post','Portuguese','logo','barcode\x20user_id','sales_invoice','body','/view/:id','production_date','foreach\x20newproduct','8bErlvL','password','70GJZmFk','Router','gmail','return_qty_QA','message','4rhIVdf','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','customers','$invoice','christian.villamer@jakagroup.com','product_code_QA','<tr>','unit_QA','secondary_code_QA','maxPerUnit_QA','144230tmfShI','padStart','$product_details._id','sale_qty','$name','/view','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','currency_placement','/picking_list/pdf/','$sale_product.floorlevel','add_sales_finished','$product.product_name','$product_details.expiry_date','$sale_product.quantity','$product_details','length','$warehouse_name','json','sales_quantity','<strong>\x20Regards\x20</strong>','$product_details.batch_code','$sale_product.bin','return_sale','$note','image','<h5\x20style=\x22text-align:\x20left;\x22>','warehouse_name','Ambient','../models/all_models','</table>','</h5>','Enclosed','$product_details.invoice','/barcode_scanner','\x20&&\x20','split','</tbody>','<html><head><title></title>','final','Sales\x20Update\x20successfully','level','expiry_date_QA','/upload/','find','165jspMaj','email','get','</body></html>','flash','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</tr>','push','currency','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','\x20</h2>','</span>','Email\x20sent\x20successfully','<h2>\x20','1762911zfkiTs','maxProducts_QA','Sale\x20Return','$product_details.product_name','<div>','product_list','Sales\x20Add\x20successfully','edit_sales_finished_view','/all_sales_finished/preview/','barcode\x20Product\x20master','<span\x20style=\x22float:\x20right;\x22>','French','secondary_unit_QA','stocks_QA','quantity','</div>','edit_sales_finished','invoice','$product_details.storage','/preview/:id','Portuguese\x20(BR)','Spanish','customers_docs','prod_cat','received_amount','secondary_code','$product_details.product_cat','primary_code','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/view/add_sale/product','Chinese','$product','$product_details.secondary_code','_id','catch','Logo.png','finalize','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$product_details.product_code','Sale\x20Return\x20Mail','15KivvVF','129972uRIfbj','sales\x20item\x20return\x20successfull','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','stock','concat','log','/view/return_sales/:id','all_sales_finished','QA\x20Warehouse','site_title','host','$product_details.floorlevel','getFullYear','slice','RoomAssigned','maxperunit','master','render','2085024WcWErx','$product_details.production_date','../middleware/auth','status','product_data','English','all','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','save','aggregate','</thead>','max','note','$product_details.maxProducts','date','Arabic\x20(ae)','$date','Hindi','production_date_QA','warehouse','/view/add_sales','$product_details.bin','$sale_product.type','$room','language','An\x20error\x20occurred.','prod_code','English\x20(US)','</td>','findOne','error','return_sale_QA','purchases_data','$product_details.type','\x20<>\x20','room','errors','/../public','batch_code','/barcode/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','ADD\x20SALE','$sale_product.bay','bay','$customer','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.secondary_unit','maxPerUnit','createTransport','user','\x20>>>\x20','params','../public/language/languages.json','primary_unit','port','product_date','staff','</head><body>','$product_details.rack','maxProducts','customer_data','$product_details.unit','name','$customers_docs','Add\x20Sales','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','batch_code_QA','$_id','\x20==\x20','room_name','exports','<hr\x20class=\x22my-3\x22>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','for_categorize','/invoice/:id','amount','$product_details.maxPerUnit','customer','then','Finished\x20Goods','getDate','product_stock','stock_data','637805ihBkZM','unit','expiry_date','\x20<<<==>>>\x20','Error\x20Occurs','German','/give_payment/:id','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.primary_code','string','id_transaction_from','Quality\x20Inspection','forEach','\x20Order\x20Number\x20:\x20'];a0_0x5644=function(){return _0x307a03;};return a0_0x5644();}var a0_0x379413=a0_0xddba;(function(_0x22b4c7,_0x48f5bc){var _0x306f26=a0_0xddba,_0x3b955b=_0x22b4c7();while(!![]){try{var _0x3fd948=parseInt(_0x306f26(0x11c))/0x1+-parseInt(_0x306f26(0x11e))/0x2*(-parseInt(_0x306f26(0x88))/0x3)+-parseInt(_0x306f26(0x13e))/0x4*(-parseInt(_0x306f26(0xee))/0x5)+parseInt(_0x306f26(0x89))/0x6*(-parseInt(_0x306f26(0x139))/0x7)+-parseInt(_0x306f26(0x137))/0x8*(parseInt(_0x306f26(0x183))/0x9)+parseInt(_0x306f26(0x148))/0xa*(-parseInt(_0x306f26(0x175))/0xb)+-parseInt(_0x306f26(0x9b))/0xc*(-parseInt(_0x306f26(0x119))/0xd);if(_0x3fd948===_0x48f5bc)break;else _0x3b955b['push'](_0x3b955b['shift']());}catch(_0x205f16){_0x3b955b['push'](_0x3b955b['shift']());}}}(a0_0x5644,0x1b14b));const express=require(a0_0x379413(0x120)),app=express(),router=express[a0_0x379413(0x13a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x379413(0x165)),auth=require(a0_0x379413(0x9d)),nodemailer=require('nodemailer'),users=require(a0_0x379413(0xcf));router[a0_0x379413(0x177)](a0_0x379413(0x14d),auth,async(_0x490aae,_0x24836e)=>{var _0x591593=a0_0x379413;try{const {username:_0x100130,email:_0x39c062,role:_0x5cca5e}=_0x490aae['user'],_0xf023ab=_0x490aae['user'],_0x2d644e=await profile[_0x591593(0xb8)]({'email':_0xf023ab[_0x591593(0x176)]}),_0x253227=await master_shop[_0x591593(0x174)]();let _0x5613eb;if(_0xf023ab['role']==_0x591593(0xd3)){const _0x2aa41a=await staff['findOne']({'email':_0xf023ab[_0x591593(0x176)]});_0x5613eb=await sales_finished[_0x591593(0xa4)]([{'$lookup':{'from':_0x591593(0x140),'localField':'customer','foreignField':_0x591593(0xd9),'as':_0x591593(0x75)}},{'$unwind':_0x591593(0xda)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x591593(0xde),'invoice':{'$first':_0x591593(0x141)},'customers':{'$first':'$customer'},'date':{'$first':_0x591593(0xab)},'warehouse_name':{'$first':_0x591593(0x159)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x591593(0x160)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x591593(0xda)},'total_saleproduct_quantity':{'$sum':_0x591593(0x156)},'level':{'$addToSet':_0x591593(0xc5)},'isle':{'$addToSet':_0x591593(0x15e)},'type':{'$addToSet':_0x591593(0xb1)},'pallet':{'$addToSet':_0x591593(0x152)},'finalize':{'$first':_0x591593(0x114)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5613eb=await sales_finished[_0x591593(0xa4)]([{'$lookup':{'from':_0x591593(0x140),'localField':'customer','foreignField':_0x591593(0xd9),'as':_0x591593(0x75)}},{'$unwind':'$customers_docs'},{'$unwind':'$sale_product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x591593(0x141)},'customers':{'$first':_0x591593(0xc7)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x591593(0x159)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x591593(0x160)},'return_data':{'$first':_0x591593(0xfe)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x591593(0x156)},'level':{'$addToSet':_0x591593(0xc5)},'isle':{'$addToSet':_0x591593(0x15e)},'type':{'$addToSet':_0x591593(0xb1)},'pallet':{'$addToSet':_0x591593(0x152)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x253227[0x0][_0x591593(0xb3)]==_0x591593(0xb6)){var _0x2dc7a1=users[_0x591593(0xa0)];console[_0x591593(0x8e)](_0x2dc7a1);}else{if(_0x253227[0x0][_0x591593(0xb3)]==_0x591593(0xac))var _0x2dc7a1=users[_0x591593(0xac)];else{if(_0x253227[0x0]['language']==_0x591593(0xf3))var _0x2dc7a1=users[_0x591593(0xf3)];else{if(_0x253227[0x0][_0x591593(0xb3)]==_0x591593(0x74))var _0x2dc7a1=users[_0x591593(0x74)];else{if(_0x253227[0x0][_0x591593(0xb3)]==_0x591593(0x18e))var _0x2dc7a1=users[_0x591593(0x18e)];else{if(_0x253227[0x0][_0x591593(0xb3)]=='Portuguese\x20(BR)')var _0x2dc7a1=users[_0x591593(0x12f)];else{if(_0x253227[0x0][_0x591593(0xb3)]==_0x591593(0x7e))var _0x2dc7a1=users['Chinese'];else{if(_0x253227[0x0][_0x591593(0xb3)]==_0x591593(0xaa))var _0x2dc7a1=users[_0x591593(0x123)];}}}}}}}_0x24836e[_0x591593(0x9a)](_0x591593(0x90),{'success':_0x490aae[_0x591593(0x179)]('success'),'errors':_0x490aae[_0x591593(0x179)]('errors'),'sales':_0x5613eb,'profile':_0x2d644e,'role':_0xf023ab,'master_shop':_0x253227,'language':_0x2dc7a1});}catch(_0xdc39f0){console['log'](_0xdc39f0);}});function a0_0xddba(_0xafa1e0,_0x3489f4){var _0x56440f=a0_0x5644();return a0_0xddba=function(_0xddbac1,_0x7f9127){_0xddbac1=_0xddbac1-0x70;var _0x2567a9=_0x56440f[_0xddbac1];return _0x2567a9;},a0_0xddba(_0xafa1e0,_0x3489f4);}async function getRandom8DigitNumber(){var _0x17fe96=a0_0x379413;const _0x34053a=0x989680,_0x519076=0x5f5e0ff,_0x1af881=Math[_0x17fe96(0x127)](Math['random']()*(_0x519076-_0x34053a+0x1))+_0x34053a;var _0x2f023e;const _0x29a0f0=await sales_finished['findOne']({'invoice':'OUTF-'+_0x1af881});return _0x29a0f0&&_0x29a0f0[_0x17fe96(0x158)]>0x0?_0x2f023e=_0x17fe96(0x115)+_0x1af881:_0x2f023e=_0x17fe96(0x115)+_0x1af881,_0x2f023e;}router['get'](a0_0x379413(0xaf),auth,async(_0xcbc85d,_0x29f2ab)=>{var _0x425556=a0_0x379413;try{const {username:_0x7309d6,email:_0x470ec3,role:_0x425f39}=_0xcbc85d[_0x425556(0xcc)],_0xb8a362=_0xcbc85d['user'],_0xc63973=await profile['findOne']({'email':_0xb8a362[_0x425556(0x176)]}),_0x494a22=await master_shop['find'](),_0x4b23cd=await customer[_0x425556(0x174)]({});let _0x41ebb9;if(_0xb8a362['role']==_0x425556(0xd3)){const _0x15525b=await staff['findOne']({'email':_0xb8a362['email']});_0x41ebb9=await warehouse[_0x425556(0xa4)]([{'$match':{'status':_0x425556(0x121),'name':_0x15525b['warehouse'],'warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x425556(0x14c),'name':{'$first':_0x425556(0x14c)}}},{'$sort':{'name':0x1}}]);}else _0x41ebb9=await warehouse[_0x425556(0xa4)]([{'$match':{'status':'Enabled','warehouse_category':_0x425556(0xea),'name':{'$ne':_0x425556(0x91)}}},{'$group':{'_id':'$name','name':{'$first':_0x425556(0x14c)}}},{'$sort':{'name':0x1}}]);const _0x6bec0f=await product[_0x425556(0x174)]({});var _0x334e82=[_0x425556(0x164),'Enclosed'];const _0x59ad5d=await sales_finished['find']({}),_0x112e01=_0x59ad5d[_0x425556(0x158)]+0x1,_0x5826b6=_0x425556(0x115)+_0x112e01['toString']()[_0x425556(0x149)](0x5,'0');if(_0x494a22[0x0][_0x425556(0xb3)]=='English\x20(US)'){var _0x470e2c=users['English'];console[_0x425556(0x8e)](_0x470e2c);}else{if(_0x494a22[0x0][_0x425556(0xb3)]=='Hindi')var _0x470e2c=users[_0x425556(0xac)];else{if(_0x494a22[0x0][_0x425556(0xb3)]==_0x425556(0xf3))var _0x470e2c=users[_0x425556(0xf3)];else{if(_0x494a22[0x0][_0x425556(0xb3)]=='Spanish')var _0x470e2c=users[_0x425556(0x74)];else{if(_0x494a22[0x0][_0x425556(0xb3)]=='French')var _0x470e2c=users[_0x425556(0x18e)];else{if(_0x494a22[0x0][_0x425556(0xb3)]==_0x425556(0x73))var _0x470e2c=users['Portuguese'];else{if(_0x494a22[0x0][_0x425556(0xb3)]==_0x425556(0x7e))var _0x470e2c=users[_0x425556(0x7e)];else{if(_0x494a22[0x0]['language']==_0x425556(0xaa))var _0x470e2c=users[_0x425556(0x123)];}}}}}}}const _0xd9c6aa=getRandom8DigitNumber();_0xd9c6aa[_0x425556(0xe9)](_0x363adc=>{var _0x2ef294=_0x425556;_0x29f2ab[_0x2ef294(0x9a)](_0x2ef294(0x153),{'success':_0xcbc85d[_0x2ef294(0x179)](_0x2ef294(0x108)),'errors':_0xcbc85d[_0x2ef294(0x179)](_0x2ef294(0xbf)),'role':_0xb8a362,'profile':_0xc63973,'customer':_0x4b23cd,'warehouse':_0x41ebb9,'product':_0x6bec0f,'invoice':_0x363adc,'master_shop':_0x494a22,'language':_0x470e2c,'rooms_data':_0x334e82});})[_0x425556(0x82)](_0x133263=>{var _0x19899c=_0x425556;_0xcbc85d[_0x19899c(0x179)](_0x19899c(0xbf),_0x19899c(0x118)),_0x29f2ab[_0x19899c(0x113)]('/all_sales_finished/view');});}catch(_0x3a41ca){console[_0x425556(0x8e)](_0x3a41ca);}}),router['get'](a0_0x379413(0x10f),auth,async(_0x292f26,_0x5aee7a)=>{var _0x396e02=a0_0x379413;try{const _0x3cc525=_0x292f26[_0x396e02(0xce)]['id'];console[_0x396e02(0x8e)](_0x3cc525);const _0x2e70a0=await product['find'](),_0x837b96=await purchases[_0x396e02(0xa4)]([{'$match':{'warehouse_name':_0x3cc525}},{'$unwind':_0x396e02(0x7f)},{'$group':{'_id':_0x396e02(0x154)}}]);console[_0x396e02(0x8e)](_0x396e02(0xbb),_0x837b96),_0x5aee7a['status'](0xc8)[_0x396e02(0x15a)]({'purchases_data':_0x837b96,'product_data':_0x2e70a0});}catch(_0x11e9ea){console[_0x396e02(0x8e)](_0x11e9ea);}}),router['post'](a0_0x379413(0x7d),auth,async(_0x39c2f0,_0x42f42a)=>{var _0x425d7f=a0_0x379413;try{const {warehouse_data:_0x2ab9b1,product_data:_0x3d0cac}=_0x39c2f0[_0x425d7f(0x133)];console['log'](_0x39c2f0[_0x425d7f(0x133)][_0x425d7f(0x9f)]);;const _0x34f895=await master_shop['find']();console[_0x425d7f(0x8e)]('master',_0x34f895);const _0x1a3aba=await product['findOne']({'name':_0x3d0cac});console['log'](_0x425d7f(0x10a),_0x1a3aba);const _0x1c0159=await warehouse['aggregate']([{'$match':{'name':_0x2ab9b1}},{'$unwind':_0x425d7f(0x157)},{'$match':{'product_details.product_name':_0x3d0cac}},{'$group':{'_id':_0x425d7f(0x186),'product_stock':{'$first':_0x425d7f(0x112)}}}]);console[_0x425d7f(0x8e)](_0x425d7f(0xed),_0x1c0159),_0x42f42a[_0x425d7f(0x9e)](0xc8)[_0x425d7f(0x15a)]({'master':_0x34f895,'new_product':_0x1a3aba,'stock_data':_0x1c0159});}catch(_0x42e101){console[_0x425d7f(0x8e)](_0x42e101);}}),router[a0_0x379413(0x12e)]('/view/add_sales',auth,async(_0x201a73,_0x3e43dd)=>{var _0x2d50e2=a0_0x379413;try{const {invoice:_0xa91875,date:_0x3a1d0b,warehouse_name:_0x18ace8,product_name:_0x24ac67,stock:_0x50bb77,quantity:_0x2294fe,note:_0x11245c,room:_0x39389d,primary_code:_0x5b54f3,secondary_code:_0x2155b1,prod_code:_0x3e6ee5,level:_0x38ac78,isle:_0x435185,pallet:_0x5cf081,batch_code:_0x8ea085,SCRN:_0x2d301f,expiry_date:_0x405bd0,mode_transpo:_0x4dcc89,name_driver:_0xbd42a5}=_0x201a73[_0x2d50e2(0x133)];if(typeof _0x24ac67==_0x2d50e2(0xf7))var _0x2887b7=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x125)]],_0x5b3918=[_0x201a73['body']['stock']],_0x6c8876=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x10c)]],_0x13f0e5=[_0x201a73[_0x2d50e2(0x133)]['primary_code']],_0x28d504=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x78)]],_0x4901e3=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0xb5)]],_0x1fdc60=[_0x201a73[_0x2d50e2(0x133)]['level']],_0x4b5f18=[_0x201a73['body'][_0x2d50e2(0xd0)]],_0x2f956b=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x14e)]],_0x23cce7=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0xc1)]],_0xb3ba06=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0xf0)]],_0x2a212a=[_0x201a73[_0x2d50e2(0x133)]['product_date']],_0x456e59=[_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x110)]],_0x390fcd=[_0x201a73[_0x2d50e2(0x133)]['prod_cat']],_0x776993=[_0x201a73['body'][_0x2d50e2(0x97)]],_0x5dff1f=[_0x201a73[_0x2d50e2(0x133)]['prod_invoice']],_0x184936=[_0x201a73['body']['id_transaction_from']];else var _0x2887b7=[..._0x201a73[_0x2d50e2(0x133)]['product_name']],_0x5b3918=[..._0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x8c)]],_0x6c8876=[..._0x201a73['body'][_0x2d50e2(0x10c)]],_0x13f0e5=[..._0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x7a)]],_0x28d504=[..._0x201a73['body'][_0x2d50e2(0x78)]],_0x4901e3=[..._0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0xb5)]],_0x1fdc60=[..._0x201a73['body'][_0x2d50e2(0x171)]],_0x4b5f18=[..._0x201a73['body']['primary_unit']],_0x2f956b=[..._0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x14e)]],_0x23cce7=[..._0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0xc1)]],_0xb3ba06=[..._0x201a73['body'][_0x2d50e2(0xf0)]],_0x2a212a=[..._0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0xd2)]],_0x456e59=[..._0x201a73[_0x2d50e2(0x133)]['max_per_unit']],_0x390fcd=[..._0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0x76)]],_0x776993=[..._0x201a73['body'][_0x2d50e2(0x97)]],_0x5dff1f=[..._0x201a73[_0x2d50e2(0x133)]['prod_invoice']],_0x184936=[..._0x201a73['body'][_0x2d50e2(0xf8)]];const _0x5a7994=_0x2887b7[_0x2d50e2(0x109)](_0x1ab05b=>{return _0x1ab05b={'product_name':_0x1ab05b};});_0x5b3918[_0x2d50e2(0xfa)]((_0x1feac0,_0x4d0ee2)=>{var _0x594c05=_0x2d50e2;_0x5a7994[_0x4d0ee2][_0x594c05(0x8c)]=_0x1feac0;}),_0x6c8876[_0x2d50e2(0xfa)]((_0x298cd2,_0x9b05e8)=>{var _0x38a4b7=_0x2d50e2;_0x5a7994[_0x9b05e8][_0x38a4b7(0x191)]=Math[_0x38a4b7(0x102)](_0x298cd2);}),_0x184936[_0x2d50e2(0xfa)]((_0x58167f,_0x3685f4)=>{var _0xe75ea1=_0x2d50e2;_0x5a7994[_0x3685f4][_0xe75ea1(0xf8)]=_0x58167f;}),_0x13f0e5[_0x2d50e2(0xfa)]((_0x8c21ae,_0x3c493c)=>{_0x5a7994[_0x3c493c]['primary_code']=_0x8c21ae;}),_0x28d504['forEach']((_0x1164b9,_0xbd2777)=>{_0x5a7994[_0xbd2777]['secondary_code']=_0x1164b9;}),_0x4901e3[_0x2d50e2(0xfa)]((_0xfb60a0,_0xccd777)=>{var _0x5ee6ec=_0x2d50e2;_0x5a7994[_0xccd777][_0x5ee6ec(0x7b)]=_0xfb60a0;}),_0x1fdc60[_0x2d50e2(0xfa)]((_0x26ab51,_0x3c6bc8)=>{_0x5a7994[_0x3c6bc8]['bay']=_0x26ab51;}),_0x4b5f18[_0x2d50e2(0xfa)]((_0x48e312,_0x1c6e57)=>{_0x5a7994[_0x1c6e57]['unit']=_0x48e312;}),_0x2f956b[_0x2d50e2(0xfa)]((_0x16b93e,_0x582abf)=>{_0x5a7994[_0x582abf]['secondary_unit']=_0x16b93e;}),_0x23cce7['forEach']((_0x355f96,_0x437fbf)=>{var _0xa2e18b=_0x2d50e2;_0x5a7994[_0x437fbf][_0xa2e18b(0xc1)]=_0x355f96;}),_0xb3ba06[_0x2d50e2(0xfa)]((_0x28cbb9,_0x437269)=>{var _0x9b6ecf=_0x2d50e2;_0x5a7994[_0x437269][_0x9b6ecf(0xf0)]=_0x28cbb9;}),_0x2a212a[_0x2d50e2(0xfa)]((_0x181082,_0x4492cd)=>{_0x5a7994[_0x4492cd]['production_date']=_0x181082;}),_0x456e59[_0x2d50e2(0xfa)]((_0x47cd99,_0x55e9a2)=>{var _0x5bc2d2=_0x2d50e2;_0x5a7994[_0x55e9a2][_0x5bc2d2(0x98)]=_0x47cd99;}),_0x390fcd[_0x2d50e2(0xfa)]((_0x4e47b0,_0x13fbce)=>{var _0x126ef9=_0x2d50e2;_0x5a7994[_0x13fbce][_0x126ef9(0x76)]=_0x4e47b0;}),_0x776993[_0x2d50e2(0xfa)]((_0x4b86fb,_0x1aad15)=>{var _0x4c39f4=_0x2d50e2;_0x5a7994[_0x1aad15][_0x4c39f4(0xe0)]=_0x4b86fb;}),_0x5dff1f[_0x2d50e2(0xfa)]((_0x6dc23f,_0xe2f298)=>{var _0x8fc19a=_0x2d50e2;_0x5a7994[_0xe2f298][_0x8fc19a(0x70)]=_0x6dc23f;});var _0x3059bc=0x0;_0x5a7994[_0x2d50e2(0xfa)](_0x5a746b=>{var _0x51a26f=_0x2d50e2;parseFloat(_0x5a746b[_0x51a26f(0x8c)])<parseFloat(_0x5a746b[_0x51a26f(0x191)])&&parseFloat(_0x5a746b[_0x51a26f(0x191)])>parseFloat(_0x5a746b['stock'])&&(console[_0x51a26f(0x8e)](_0x5a746b[_0x51a26f(0x8c)]+_0x51a26f(0xbd)+_0x5a746b[_0x51a26f(0x191)]),_0x3059bc++);});if(_0x3059bc!=0x0)return _0x201a73[_0x2d50e2(0x179)]('errors',_0x2d50e2(0x17e)),_0x3e43dd[_0x2d50e2(0x113)](_0x2d50e2(0x12c));const _0x9c23e5=_0x5a7994[_0x2d50e2(0xfc)](_0x36efca=>_0x36efca[_0x2d50e2(0x191)]!=='0'&&_0x36efca['quantity']!==''),_0x35d54c=new sales_finished({'invoice':_0xa91875,'customer':_0x201a73[_0x2d50e2(0x133)][_0x2d50e2(0xe8)],'date':_0x3a1d0b,'warehouse_name':_0x18ace8,'sale_product':_0x9c23e5,'note':_0x11245c,'room':_0x39389d,'primary_code':_0x5b54f3,'secondary_code':_0x2155b1,'prod_code':_0x3e6ee5,'SCRN':_0x2d301f,'finalize':_0x2d50e2(0xff),'mode_transpo':_0x4dcc89,'name_driver':_0xbd42a5}),_0x448843=await _0x35d54c['save'](),_0x52a9b9=await sales_finished[_0x2d50e2(0xb8)]({'invoice':_0xa91875}),_0x14e1ff=new c_payment_data({'invoice':_0xa91875,'customer':_0x201a73[_0x2d50e2(0x133)]['customer'],'reason':_0x2d50e2(0x122)});await _0x14e1ff[_0x2d50e2(0xa3)]();const _0x2050d1=await master_shop['find'](),_0x4884de=await email_settings[_0x2d50e2(0xb8)](),_0x35cb73=await customer['findOne']({'name':_0x201a73[_0x2d50e2(0x133)]['customer']});_0x2050d1[0x0][_0x2d50e2(0x150)]==0x1?(right_currency=_0x2050d1[0x0][_0x2d50e2(0x17d)],left_currency=''):(right_currency='',left_currency=_0x2050d1[0x0][_0x2d50e2(0x17d)]);var _0x24d94e=_0x2887b7,_0x378514=_0x6c8876,_0xd3f91a='',_0x150790;for(_0x150790 in _0x24d94e){_0xd3f91a+=_0x2d50e2(0x144)+_0x2d50e2(0x13f)+_0x24d94e[_0x150790]+'</td>'+_0x2d50e2(0x13f)+_0x378514[_0x150790]+_0x2d50e2(0xb7)+_0x2d50e2(0x17b);}console[_0x2d50e2(0x8e)]('product_list',_0xd3f91a);let _0x108406=nodemailer[_0x2d50e2(0xcb)]({'host':_0x4884de[_0x2d50e2(0x93)],'port':Number(_0x4884de[_0x2d50e2(0xd1)]),'secure':![],'service':_0x2d50e2(0x13b),'auth':{'user':_0x4884de[_0x2d50e2(0x176)],'pass':_0x4884de[_0x2d50e2(0x138)]}}),_0x400afa={'from':_0x4884de[_0x2d50e2(0x176)],'to':_0x2d50e2(0x142),'subject':_0x2d50e2(0xdb),'attachments':[{'filename':_0x2d50e2(0x83),'path':__dirname+_0x2d50e2(0xc0)+_0x2d50e2(0x173)+_0x2050d1[0x0][_0x2d50e2(0x161)],'cid':_0x2d50e2(0x130)}],'html':_0x2d50e2(0xc4)};_0x108406[_0x2d50e2(0x128)](_0x400afa,function(_0x526fbd,_0x5b9db6){var _0x36216c=_0x2d50e2;_0x526fbd?(console[_0x36216c(0x8e)](_0x526fbd),console[_0x36216c(0x8e)](_0x36216c(0xf2))):console['log']('Email\x20sent\x20successfully');}),_0x201a73[_0x2d50e2(0x179)](_0x2d50e2(0x108),_0x2d50e2(0x189)),_0x3e43dd[_0x2d50e2(0x113)](_0x2d50e2(0x18b)+_0x448843[_0x2d50e2(0x81)]);}catch(_0x57bc2b){console[_0x2d50e2(0x8e)](_0x57bc2b);}}),router[a0_0x379413(0x177)]('/preview/:id',auth,async(_0x2d3f91,_0x11b20c)=>{var _0x2b0809=a0_0x379413;try{const {username:_0x3171c3,email:_0x423e8b,role:_0x582024}=_0x2d3f91[_0x2b0809(0xcc)],_0xa2272=_0x2d3f91['user'],_0x3d49e1=await profile['findOne']({'email':_0xa2272[_0x2b0809(0x176)]}),_0x4cabac=await master_shop[_0x2b0809(0x174)](),_0x4aa875=_0x2d3f91[_0x2b0809(0xce)]['id'],_0x232ee9=await sales_finished[_0x2b0809(0x106)](_0x4aa875),_0x58ee8e=await warehouse[_0x2b0809(0xa4)]([{'$match':{'name':_0x232ee9[_0x2b0809(0x163)]}},{'$unwind':_0x2b0809(0x157)},{'$group':{'_id':_0x2b0809(0x14a),'name':{'$first':_0x2b0809(0x186)},'product_stock':{'$first':_0x2b0809(0x112)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x2b0809(0xb0)},'type':{'$first':_0x2b0809(0xbc)},'floorlevel':{'$first':_0x2b0809(0x94)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2b0809(0x71)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2b0809(0x155)},'production_date':{'$first':_0x2b0809(0x9c)},'batch_code':{'$first':_0x2b0809(0x15d)},'room':{'$first':_0x2b0809(0xb2)},'room_data':{'$first':'$product_details.room_name'}}}]),_0x54f7f2=await customer['find']({});let _0x5be8e0;if(_0xa2272['role']=='staff'){const _0x157ad1=await staff['findOne']({'email':_0xa2272[_0x2b0809(0x176)]});_0x5be8e0=await warehouse['aggregate']([{'$match':{'status':_0x2b0809(0x121),'name':_0x157ad1[_0x2b0809(0xae)]}},{'$group':{'_id':_0x2b0809(0x14c),'name':{'$first':_0x2b0809(0x14c)}}}]);}else _0x5be8e0=await warehouse[_0x2b0809(0xa4)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x2b0809(0x14c)}}}]);const _0x25b38c=await product[_0x2b0809(0x174)]({});if(_0x4cabac[0x0][_0x2b0809(0xb3)]=='English\x20(US)'){var _0x3d445b=users[_0x2b0809(0xa0)];console['log'](_0x3d445b);}else{if(_0x4cabac[0x0][_0x2b0809(0xb3)]=='Hindi')var _0x3d445b=users[_0x2b0809(0xac)];else{if(_0x4cabac[0x0]['language']==_0x2b0809(0xf3))var _0x3d445b=users[_0x2b0809(0xf3)];else{if(_0x4cabac[0x0][_0x2b0809(0xb3)]==_0x2b0809(0x74))var _0x3d445b=users[_0x2b0809(0x74)];else{if(_0x4cabac[0x0]['language']==_0x2b0809(0x18e))var _0x3d445b=users['French'];else{if(_0x4cabac[0x0][_0x2b0809(0xb3)]==_0x2b0809(0x73))var _0x3d445b=users['Portuguese'];else{if(_0x4cabac[0x0][_0x2b0809(0xb3)]=='Chinese')var _0x3d445b=users[_0x2b0809(0x7e)];else{if(_0x4cabac[0x0]['language']==_0x2b0809(0xaa))var _0x3d445b=users[_0x2b0809(0x123)];}}}}}}}_0x11b20c[_0x2b0809(0x9a)](_0x2b0809(0x18a),{'success':_0x2d3f91[_0x2b0809(0x179)]('success'),'errors':_0x2d3f91[_0x2b0809(0x179)](_0x2b0809(0xbf)),'role':_0xa2272,'profile':_0x3d49e1,'customer':_0x54f7f2,'warehouse':_0x5be8e0,'product':_0x58ee8e,'user':_0x232ee9,'master_shop':_0x4cabac,'unit':_0x25b38c,'language':_0x3d445b});}catch(_0x5b8cd8){console[_0x2b0809(0x8e)](_0x5b8cd8);}}),router['post'](a0_0x379413(0x72),auth,async(_0x11df29,_0x17b08c)=>{var _0x175b8f=a0_0x379413;try{const _0x13d273=_0x11df29[_0x175b8f(0xce)]['id'],{invoice:_0x12cba4,warehouse_name:_0x2711fc,room:_0x2b52bc}=_0x11df29[_0x175b8f(0x133)],_0x364ccb=await sales_finished['findOne']({'invoice':_0x12cba4}),_0x560e22=_0x364ccb[_0x175b8f(0x116)][_0x175b8f(0x109)](async _0x134439=>{var _0xde9f6a=_0x175b8f,_0x19adaf=await warehouse[_0xde9f6a(0xb8)]({'name':_0x2711fc,'room':_0x134439['room_name'],'warehouse_category':_0xde9f6a(0xea)});const _0x5a9315=_0x19adaf[_0xde9f6a(0x11d)][_0xde9f6a(0x109)](_0x3a7810=>{var _0x2b63d9=_0xde9f6a;(_0x3a7810[_0x2b63d9(0x125)]==_0x134439[_0x2b63d9(0x125)]&&_0x3a7810[_0x2b63d9(0xc6)]==_0x134439[_0x2b63d9(0xc6)]&&_0x3a7810[_0x2b63d9(0xf0)]==_0x134439[_0x2b63d9(0xf0)]&&_0x3a7810[_0x2b63d9(0x135)]==_0x134439['production_date']&&_0x3a7810[_0x2b63d9(0xc1)]==_0x134439[_0x2b63d9(0xc1)]&&_0x3a7810[_0x2b63d9(0x70)]==_0x134439[_0x2b63d9(0x70)]||_0x3a7810[_0x2b63d9(0x81)]==_0x134439[_0x2b63d9(0xf8)])&&(_0x3a7810[_0x2b63d9(0xec)]>0x0&&(console['log'](_0x3a7810[_0x2b63d9(0x125)]+_0x2b63d9(0xdf)+_0x134439[_0x2b63d9(0x125)]+'\x20&&\x20'+_0x3a7810[_0x2b63d9(0xc6)]+'\x20==\x20'+_0x134439[_0x2b63d9(0xc6)]+_0x2b63d9(0x16b)+_0x3a7810['production_date']+_0x2b63d9(0xdf)+_0x134439['production_date']+_0x2b63d9(0x16b)+_0x3a7810['expiry_date']+'\x20==\x20'+_0x134439['expiry_date']+_0x2b63d9(0x16b)+_0x3a7810[_0x2b63d9(0xc1)]+'\x20==\x20'+_0x134439[_0x2b63d9(0xc1)]+_0x2b63d9(0x16b)+_0x3a7810[_0x2b63d9(0x70)]+'\x20==\x20'+_0x134439['invoice']+_0x2b63d9(0x16b)+_0x3a7810['product_stock']+_0x2b63d9(0xf1)+_0x134439[_0x2b63d9(0x191)]+_0x2b63d9(0xcd)+_0x134439['room_name']+_0x2b63d9(0x16b)+_0x3a7810[_0x2b63d9(0x81)]+'\x20==\x20'+_0x134439[_0x2b63d9(0xf8)]),_0x3a7810['product_stock']=Math[_0x2b63d9(0xa6)](0x0,Math[_0x2b63d9(0x102)](_0x3a7810[_0x2b63d9(0xec)])-Math[_0x2b63d9(0x102)](_0x134439[_0x2b63d9(0x191)]))));});return _0x19adaf;});Promise[_0x175b8f(0xa1)](_0x560e22)[_0x175b8f(0xe9)](async _0x54e96d=>{var _0x259a6d=_0x175b8f;try{for(const _0xc28132 of _0x54e96d){await _0xc28132[_0x259a6d(0xa3)]();}_0x364ccb[_0x259a6d(0x84)]='True';const _0x4cf7d5=await _0x364ccb[_0x259a6d(0xa3)](),_0x240b80=await master_shop[_0x259a6d(0x174)](),_0x4de1b0=await email_settings[_0x259a6d(0xb8)](),_0x514abf=await supervisor_settings[_0x259a6d(0x174)]();var _0x192f95=_0x364ccb[_0x259a6d(0x116)],_0x477a7e='',_0x53361;for(_0x53361 in _0x192f95){var _0x6afba3='FG';_0x364ccb[_0x259a6d(0x163)]==_0x259a6d(0x11f)&&(_0x6afba3='DG'),_0x477a7e+=_0x259a6d(0x144)+_0x259a6d(0x13f)+_0x192f95[_0x53361][_0x259a6d(0x125)]+_0x259a6d(0xb7)+_0x259a6d(0x13f)+_0x192f95[_0x53361][_0x259a6d(0x7b)]+_0x259a6d(0xb7)+_0x259a6d(0x13f)+_0x192f95[_0x53361][_0x259a6d(0x191)]+_0x259a6d(0xb7)+_0x259a6d(0x13f)+_0x192f95[_0x53361][_0x259a6d(0xef)]+'</td>'+_0x259a6d(0x13f)+_0x192f95[_0x53361]['secondary_unit']+_0x259a6d(0xb7)+_0x259a6d(0x13f)+_0x364ccb[_0x259a6d(0x163)]+'</td>'+_0x259a6d(0x13f)+_0x192f95[_0x53361][_0x259a6d(0xe0)]+'</td>'+_0x259a6d(0x13f)+_0x6afba3+_0x192f95[_0x53361][_0x259a6d(0xc6)]+_0x259a6d(0xb7);}let _0x2e737a=nodemailer[_0x259a6d(0xcb)]({'host':_0x4de1b0['host'],'port':Number(_0x4de1b0[_0x259a6d(0xd1)]),'secure':![],'auth':{'user':_0x4de1b0[_0x259a6d(0x176)],'pass':_0x4de1b0['password']}}),_0x4cfd42={'from':_0x4de1b0[_0x259a6d(0x176)],'to':_0x514abf[0x0]['FGSEmail'],'subject':'Sales\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x259a6d(0xc0)+'/upload/'+_0x240b80[0x0][_0x259a6d(0x161)],'cid':_0x259a6d(0x130)}],'html':_0x259a6d(0x12a)+'<html><head><title></title>'+_0x259a6d(0xd4)+_0x259a6d(0x187)+_0x259a6d(0x17a)+'<div>'+_0x259a6d(0x8b)+'</div>'+_0x259a6d(0x187)+'<h2>\x20'+_0x240b80[0x0][_0x259a6d(0x92)]+_0x259a6d(0x17f)+_0x259a6d(0x192)+_0x259a6d(0x192)+'<hr\x20class=\x22my-3\x22>'+_0x259a6d(0x187)+_0x259a6d(0x162)+_0x259a6d(0xfb)+_0x364ccb[_0x259a6d(0x70)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x259a6d(0x12d)+_0x364ccb[_0x259a6d(0xa9)]+'\x20'+_0x259a6d(0x180)+'</h5>'+_0x259a6d(0x192)+_0x259a6d(0x117)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x259a6d(0x14f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x259a6d(0x7c)+_0x259a6d(0xdc)+_0x259a6d(0x107)+_0x259a6d(0x126)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x259a6d(0x17b)+_0x259a6d(0xa5)+_0x259a6d(0x12b)+'\x20'+_0x477a7e+'\x20'+_0x259a6d(0x16d)+_0x259a6d(0x166)+_0x259a6d(0x187)+_0x259a6d(0x15c)+_0x259a6d(0x11a)+_0x240b80[0x0]['site_title']+'</h5>'+_0x259a6d(0x192)+_0x259a6d(0x192)+'</body></html>'};_0x2e737a[_0x259a6d(0x128)](_0x4cfd42,function(_0x4cdebf,_0x4f01a7){var _0x86e64c=_0x259a6d;_0x4cdebf?(console['log'](_0x4cdebf),console[_0x86e64c(0x8e)](_0x86e64c(0xf2))):console[_0x86e64c(0x8e)]('Email\x20sent\x20successfully');}),_0x11df29[_0x259a6d(0x179)]('success',_0x259a6d(0x170)),_0x17b08c[_0x259a6d(0x113)](_0x259a6d(0x151)+_0x13d273);}catch(_0x4d0294){console['error'](_0x4d0294),_0x17b08c[_0x259a6d(0x9e)](0x1f4)[_0x259a6d(0x15a)]({'error':_0x259a6d(0xf5)});}})[_0x175b8f(0x82)](_0x499c5a=>{var _0x26a012=_0x175b8f;console[_0x26a012(0xb9)](_0x499c5a),_0x17b08c[_0x26a012(0x9e)](0x1f4)[_0x26a012(0x15a)]({'error':_0x26a012(0xb4)});});}catch(_0x1aec7c){console[_0x175b8f(0x8e)](_0x1aec7c);}}),router[a0_0x379413(0x177)](a0_0x379413(0x134),auth,async(_0x6ae99d,_0xa0b3ad)=>{var _0x221cf2=a0_0x379413;try{const {username:_0x178f6d,email:_0xe87fec,role:_0x1e5d3e}=_0x6ae99d[_0x221cf2(0xcc)],_0x1af323=_0x6ae99d[_0x221cf2(0xcc)],_0x178b81=await profile[_0x221cf2(0xb8)]({'email':_0x1af323['email']}),_0x4324b0=await master_shop[_0x221cf2(0x174)](),_0x350be3=_0x6ae99d[_0x221cf2(0xce)]['id'],_0x107900=await sales_finished[_0x221cf2(0x106)](_0x350be3);let _0x1f0882=new Date(_0x107900[_0x221cf2(0xf0)]),_0x252118=('0'+_0x1f0882['getDate']())[_0x221cf2(0x96)](-0x2),_0x48fa06=('0'+(_0x1f0882[_0x221cf2(0x104)]()+0x1))['slice'](-0x2),_0x1dab18=_0x1f0882[_0x221cf2(0x95)](),_0x30e7ed=_0x1dab18+'-'+_0x48fa06+'-'+_0x252118;var _0x1251ff=['Ambient',_0x221cf2(0x168)];const _0x1d0f6a=await warehouse['aggregate']([{'$match':{'name':_0x107900[_0x221cf2(0x163)],'room':_0x107900[_0x221cf2(0xbe)]}},{'$unwind':_0x221cf2(0x157)},{'$group':{'_id':_0x221cf2(0x14a),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x221cf2(0x112)},'bay':{'$first':_0x221cf2(0x103)},'bin':{'$first':_0x221cf2(0xb0)},'type':{'$first':_0x221cf2(0xbc)},'floorlevel':{'$first':_0x221cf2(0x94)},'primary_code':{'$first':_0x221cf2(0xf6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x221cf2(0x86)},'storage':{'$first':_0x221cf2(0x71)},'rack':{'$first':_0x221cf2(0xd5)}}}]),_0x2f1400=await customer[_0x221cf2(0x174)]({});let _0x18c72f;if(_0x1af323['role']==_0x221cf2(0xd3)){const _0x3ae936=await staff[_0x221cf2(0xb8)]({'email':_0x1af323[_0x221cf2(0x176)]});_0x18c72f=await warehouse[_0x221cf2(0xa4)]([{'$match':{'status':_0x221cf2(0x121),'name':_0x3ae936[_0x221cf2(0xae)]}},{'$group':{'_id':_0x221cf2(0x14c),'name':{'$first':'$name'}}}]);}else _0x18c72f=await warehouse[_0x221cf2(0xa4)]([{'$match':{'status':_0x221cf2(0x121)}},{'$group':{'_id':_0x221cf2(0x14c),'name':{'$first':_0x221cf2(0x14c)}}}]);const _0x615f73=await product[_0x221cf2(0x174)]({});if(_0x4324b0[0x0]['language']==_0x221cf2(0xb6)){var _0x2a5e07=users['English'];console['log'](_0x2a5e07);}else{if(_0x4324b0[0x0]['language']==_0x221cf2(0xac))var _0x2a5e07=users['Hindi'];else{if(_0x4324b0[0x0][_0x221cf2(0xb3)]==_0x221cf2(0xf3))var _0x2a5e07=users['German'];else{if(_0x4324b0[0x0]['language']==_0x221cf2(0x74))var _0x2a5e07=users['Spanish'];else{if(_0x4324b0[0x0][_0x221cf2(0xb3)]==_0x221cf2(0x18e))var _0x2a5e07=users[_0x221cf2(0x18e)];else{if(_0x4324b0[0x0][_0x221cf2(0xb3)]==_0x221cf2(0x73))var _0x2a5e07=users['Portuguese'];else{if(_0x4324b0[0x0][_0x221cf2(0xb3)]==_0x221cf2(0x7e))var _0x2a5e07=users['Chinese'];else{if(_0x4324b0[0x0][_0x221cf2(0xb3)]=='Arabic\x20(ae)')var _0x2a5e07=users[_0x221cf2(0x123)];}}}}}}}_0xa0b3ad['render'](_0x221cf2(0x193),{'success':_0x6ae99d[_0x221cf2(0x179)](_0x221cf2(0x108)),'errors':_0x6ae99d[_0x221cf2(0x179)](_0x221cf2(0xbf)),'role':_0x1af323,'profile':_0x178b81,'customer':_0x2f1400,'warehouse':_0x18c72f,'product':_0x1d0f6a,'user':_0x107900,'master_shop':_0x4324b0,'unit':_0x615f73,'language':_0x2a5e07,'rooms_data':_0x1251ff,'ed_fullDate':_0x30e7ed});}catch(_0x554e77){console[_0x221cf2(0x8e)](_0x554e77);}}),router[a0_0x379413(0x12e)](a0_0x379413(0x134),auth,async(_0x10e96c,_0x41b637)=>{var _0x51b47e=a0_0x379413;try{const _0x500898=_0x10e96c['params']['id'],_0x553fec=await sales_finished['findOne']({'_id':_0x10e96c[_0x51b47e(0xce)]['id']}),_0x4f4635=await warehouse[_0x51b47e(0xb8)]({'name':_0x553fec[_0x51b47e(0x163)],'room':_0x10e96c[_0x51b47e(0x133)][_0x51b47e(0xbe)],'warehouse_category':_0x51b47e(0xea)}),{invoice:_0x34b42b,customer:_0x5261f1,date:_0x44ddf9,warehouse_name:_0x54644e,product_name:_0x423575,stock:_0xa71aa0,adjust_qty:_0xcfe08f,note:_0x428abf,room:_0x35cc5c,primary_code:_0x6d2dc3,secondary_code:_0x32fe74,prod_code:_0x2a6252,level:_0x37a501,isle:_0x19e26f,pallet:_0x28fd72,expiry_date:_0x13149a}=_0x10e96c[_0x51b47e(0x133)];if(typeof _0x423575==_0x51b47e(0xf7))var _0x3a33a1=[_0x10e96c['body'][_0x51b47e(0x125)]],_0x39dd4e=[_0x10e96c[_0x51b47e(0x133)][_0x51b47e(0x8c)]],_0x51b5ea=[_0x10e96c[_0x51b47e(0x133)][_0x51b47e(0x10d)]],_0x558aea=[_0x10e96c[_0x51b47e(0x133)]['primary_code']],_0x258951=[_0x10e96c[_0x51b47e(0x133)][_0x51b47e(0x78)]],_0x1659f3=[_0x10e96c[_0x51b47e(0x133)][_0x51b47e(0xb5)]],_0x1bfb4b=[_0x10e96c['body'][_0x51b47e(0x171)]],_0x5921ac=[_0x10e96c[_0x51b47e(0x133)][_0x51b47e(0xf0)]];else var _0x3a33a1=[..._0x10e96c[_0x51b47e(0x133)][_0x51b47e(0x125)]],_0x39dd4e=[..._0x10e96c[_0x51b47e(0x133)][_0x51b47e(0x8c)]],_0x51b5ea=[..._0x10e96c['body']['adjust_qty']],_0x558aea=[..._0x10e96c[_0x51b47e(0x133)][_0x51b47e(0x7a)]],_0x258951=[..._0x10e96c['body'][_0x51b47e(0x78)]],_0x1659f3=[..._0x10e96c[_0x51b47e(0x133)]['prod_code']],_0x1bfb4b=[..._0x10e96c['body'][_0x51b47e(0x171)]],_0x5921ac=[..._0x10e96c[_0x51b47e(0x133)][_0x51b47e(0xf0)]];const _0x3cfcbe=_0x3a33a1[_0x51b47e(0x109)](_0x58209f=>{return _0x58209f={'product_name':_0x58209f};});_0x39dd4e[_0x51b47e(0xfa)]((_0x2980b0,_0x33b7f5)=>{var _0x1841e5=_0x51b47e;_0x3cfcbe[_0x33b7f5][_0x1841e5(0x8c)]=_0x2980b0;}),_0x51b5ea[_0x51b47e(0xfa)]((_0x5d7b39,_0x567fb0)=>{var _0x19eb6b=_0x51b47e;_0x3cfcbe[_0x567fb0][_0x19eb6b(0x191)]=_0x5d7b39;}),_0x558aea[_0x51b47e(0xfa)]((_0x418932,_0x5810ca)=>{var _0x3de82f=_0x51b47e;_0x3cfcbe[_0x5810ca][_0x3de82f(0x7a)]=_0x418932;}),_0x258951['forEach']((_0x7ef0fc,_0x512e71)=>{var _0x46bbc9=_0x51b47e;_0x3cfcbe[_0x512e71][_0x46bbc9(0x78)]=_0x7ef0fc;}),_0x1659f3[_0x51b47e(0xfa)]((_0x4214ba,_0x1f5331)=>{var _0x8ecf3b=_0x51b47e;_0x3cfcbe[_0x1f5331][_0x8ecf3b(0x7b)]=_0x4214ba;}),_0x1bfb4b[_0x51b47e(0xfa)]((_0xc93f99,_0x3dedcc)=>{var _0x1c4696=_0x51b47e;_0x3cfcbe[_0x3dedcc][_0x1c4696(0x171)]=_0xc93f99;}),_0x5921ac[_0x51b47e(0xfa)]((_0x5a6fef,_0x43fe9c)=>{var _0x2a3948=_0x51b47e;_0x3cfcbe[_0x43fe9c][_0x2a3948(0xf0)]=_0x5a6fef;});var _0x45e2b1=0x0;_0x3cfcbe[_0x51b47e(0xfa)](_0x1c9613=>{var _0x39d508=_0x51b47e;console[_0x39d508(0x8e)](_0x39d508(0x136),_0x1c9613),(parseInt(_0x1c9613[_0x39d508(0x8c)])<parseInt(_0x1c9613['quantity'])||parseInt(_0x1c9613[_0x39d508(0x191)])==0x0)&&_0x45e2b1++;});if(_0x45e2b1!=0x0)return _0x10e96c[_0x51b47e(0x179)]('errors',_0x51b47e(0xc8)),_0x41b637[_0x51b47e(0x113)](_0x51b47e(0x12c));_0x553fec[_0x51b47e(0x116)][_0x51b47e(0xfa)](_0x4460f2=>{var _0x25f686=_0x51b47e;const _0x5b8ff8=_0x4f4635[_0x25f686(0x11d)][_0x25f686(0x109)](_0x2da2b0=>{var _0x9eb19d=_0x25f686;_0x2da2b0['product_name']==_0x4460f2[_0x9eb19d(0x125)]&&_0x2da2b0[_0x9eb19d(0xc6)]==_0x4460f2[_0x9eb19d(0xc6)]&&(_0x2da2b0[_0x9eb19d(0xec)]=parseInt(_0x2da2b0[_0x9eb19d(0xec)])+parseInt(_0x4460f2['quantity']));});}),await _0x4f4635[_0x51b47e(0xa3)]();const _0x53018d=_0x3cfcbe[_0x51b47e(0xfc)](_0x3fbe95=>_0x3fbe95['quantity']!=='0'&&_0x3fbe95['quantity']!=='');_0x553fec[_0x51b47e(0x70)]=_0x34b42b,_0x553fec['customer']=_0x5261f1,_0x553fec[_0x51b47e(0xa9)]=_0x44ddf9,_0x553fec[_0x51b47e(0x163)]=_0x54644e,_0x553fec['sale_product']=_0x53018d,_0x553fec[_0x51b47e(0xa7)]=_0x428abf,_0x553fec[_0x51b47e(0xbe)]=_0x35cc5c;const _0x356838=await _0x553fec[_0x51b47e(0xa3)](),_0x2f8ebe=await sales_finished[_0x51b47e(0xb8)]({'_id':_0x10e96c[_0x51b47e(0xce)]['id']}),_0x30e781=await warehouse[_0x51b47e(0xb8)]({'name':_0x54644e,'room':_0x35cc5c,'warehouse_category':'Finished\x20Goods'});_0x2f8ebe[_0x51b47e(0x116)][_0x51b47e(0xfa)](_0x3f2525=>{var _0x30f41f=_0x51b47e;const _0x462458=_0x30e781[_0x30f41f(0x11d)][_0x30f41f(0x109)](_0x3f2b73=>{var _0xabe4b6=_0x30f41f;_0x3f2b73[_0xabe4b6(0x125)]==_0x3f2525[_0xabe4b6(0x125)]&&_0x3f2b73[_0xabe4b6(0xc6)]==_0x3f2525[_0xabe4b6(0xc6)]&&(_0x3f2b73[_0xabe4b6(0xec)]=parseInt(_0x3f2b73[_0xabe4b6(0xec)])-parseInt(_0x3f2525[_0xabe4b6(0x191)]));});}),console[_0x51b47e(0x8e)](_0x51b47e(0x16f),_0x30e781),await _0x30e781[_0x51b47e(0xa3)]();const _0x125312=await c_payment_data[_0x51b47e(0xb8)]({'invoice':_0x10e96c['body']['invoice']});_0x125312[_0x51b47e(0x100)]=_0x10e96c[_0x51b47e(0x133)]['suppliers'],await _0x125312[_0x51b47e(0xa3)](),_0x10e96c['flash'](_0x51b47e(0x108),_0x51b47e(0x170)),_0x41b637[_0x51b47e(0x113)](_0x51b47e(0x111));}catch(_0x29d6ff){console['log'](_0x29d6ff);}}),router['post'](a0_0x379413(0xf4),auth,async(_0x1dec7a,_0x57f848)=>{var _0x4e6ad6=a0_0x379413;try{const _0x3ae338=_0x1dec7a[_0x4e6ad6(0xce)]['id'],{invoice:_0x573b26,customer:_0x5c4463,receivable_amount:_0x1918e4,received_amount:_0x23a780}=_0x1dec7a['body'],_0x1c389f=await sales[_0x4e6ad6(0x106)](_0x3ae338);console[_0x4e6ad6(0x8e)](_0x1c389f);var _0x19bc24=_0x1918e4-_0x23a780;console[_0x4e6ad6(0x8e)](_0x23a780),_0x1c389f[_0x4e6ad6(0x77)]=parseFloat(_0x23a780)+parseFloat(_0x1c389f['received_amount']),_0x1c389f['due_amount']=_0x19bc24,console['log'](_0x1c389f);const _0x1fbdfd=await _0x1c389f['save'](),_0x414d6a=await c_payment_data[_0x4e6ad6(0xb8)]({'invoice':_0x573b26});_0x414d6a[_0x4e6ad6(0xe6)]=_0x19bc24,await _0x414d6a[_0x4e6ad6(0xa3)]();let _0x4d057b=new Date(),_0xd24412=('0'+_0x4d057b[_0x4e6ad6(0xeb)]())[_0x4e6ad6(0x96)](-0x2),_0x2dc2d9=('0'+(_0x4d057b[_0x4e6ad6(0x104)]()+0x1))[_0x4e6ad6(0x96)](-0x2),_0xe8e22f=_0x4d057b[_0x4e6ad6(0x95)](),_0x2f7db7=_0xe8e22f+'-'+_0x2dc2d9+'-'+_0xd24412;const _0x4deefd=new customer_payment({'invoice':_0x573b26,'date':_0xe8e22f+'-'+_0x2dc2d9+'-'+_0xd24412,'customer':_0x5c4463,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x23a780}),_0x3c4b2f=await _0x4deefd[_0x4e6ad6(0xa3)]();_0x1dec7a['flash'](_0x4e6ad6(0x108),_0x4e6ad6(0x129)),_0x57f848[_0x4e6ad6(0x113)](_0x4e6ad6(0x11b));}catch(_0x4fc918){console[_0x4e6ad6(0x8e)](_0x4fc918);}}),router[a0_0x379413(0x177)](a0_0x379413(0xe5),auth,async(_0x97712,_0xa3d70b)=>{var _0x55ca03=a0_0x379413;try{const {username:_0x5cae10,email:_0x57e6cd,role:_0x49302f}=_0x97712[_0x55ca03(0xcc)],_0x565215=_0x97712['user'],_0x2f36e3=await profile['findOne']({'email':_0x565215['email']}),_0x4af65e=await master_shop[_0x55ca03(0x174)]();console[_0x55ca03(0x8e)](_0x55ca03(0x99),_0x4af65e);const _0x85a63b=_0x97712[_0x55ca03(0xce)]['id'],_0x25ed89=await sales[_0x55ca03(0x106)](_0x85a63b);console['log'](_0x25ed89);const _0x20dc83=await customer[_0x55ca03(0xb8)]({'name':_0x25ed89[_0x55ca03(0xe8)]});console[_0x55ca03(0x8e)](_0x20dc83);if(_0x4af65e[0x0][_0x55ca03(0xb3)]=='English\x20(US)'){var _0x4b35f1=users[_0x55ca03(0xa0)];console['log'](_0x4b35f1);}else{if(_0x4af65e[0x0]['language']==_0x55ca03(0xac))var _0x4b35f1=users[_0x55ca03(0xac)];else{if(_0x4af65e[0x0][_0x55ca03(0xb3)]==_0x55ca03(0xf3))var _0x4b35f1=users[_0x55ca03(0xf3)];else{if(_0x4af65e[0x0][_0x55ca03(0xb3)]=='Spanish')var _0x4b35f1=users[_0x55ca03(0x74)];else{if(_0x4af65e[0x0][_0x55ca03(0xb3)]=='French')var _0x4b35f1=users[_0x55ca03(0x18e)];else{if(_0x4af65e[0x0][_0x55ca03(0xb3)]==_0x55ca03(0x73))var _0x4b35f1=users[_0x55ca03(0x12f)];else{if(_0x4af65e[0x0][_0x55ca03(0xb3)]==_0x55ca03(0x7e))var _0x4b35f1=users[_0x55ca03(0x7e)];else{if(_0x4af65e[0x0][_0x55ca03(0xb3)]=='Arabic\x20(ae)')var _0x4b35f1=users['Arabic'];}}}}}}}_0xa3d70b[_0x55ca03(0x9a)](_0x55ca03(0x132),{'success':_0x97712['flash'](_0x55ca03(0x108)),'errors':_0x97712[_0x55ca03(0x179)](_0x55ca03(0xbf)),'role':_0x565215,'profile':_0x2f36e3,'master_shop':_0x4af65e,'customers':_0x20dc83,'sales':_0x25ed89,'language':_0x4b35f1});}catch(_0x455b5c){console[_0x55ca03(0x8e)](_0x455b5c);}}),router[a0_0x379413(0x177)](a0_0x379413(0x8f),auth,async(_0x364cf6,_0x2a4128)=>{var _0x1caab6=a0_0x379413;try{const {username:_0xca7d66,email:_0x3f562c,role:_0x24ae1e}=_0x364cf6[_0x1caab6(0xcc)],_0x1d9908=_0x364cf6[_0x1caab6(0xcc)],_0x3f1e40=await profile[_0x1caab6(0xb8)]({'email':_0x1d9908['email']}),_0xe0b473=await master_shop['find'](),_0x4e2f09=_0x364cf6['params']['id'],_0x505742=await sales_finished[_0x1caab6(0x106)](_0x4e2f09),_0x194b17=await warehouse[_0x1caab6(0xa4)]([{'$match':{'name':_0x505742[_0x1caab6(0x163)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1caab6(0x14a),'name':{'$first':_0x1caab6(0x186)},'product_stock':{'$first':_0x1caab6(0x112)},'bay':{'$first':_0x1caab6(0x103)},'bin':{'$first':_0x1caab6(0xb0)},'type':{'$first':_0x1caab6(0xbc)},'floorlevel':{'$first':_0x1caab6(0x94)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1caab6(0x86)},'storage':{'$first':_0x1caab6(0x71)},'rack':{'$first':_0x1caab6(0xd5)},'expiry_date':{'$first':_0x1caab6(0x155)},'production_date':{'$first':_0x1caab6(0x9c)},'unit':{'$first':_0x1caab6(0xd8)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x1caab6(0xa8)},'batch_code':{'$first':_0x1caab6(0x15d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x173099=await product[_0x1caab6(0x174)]({}),_0x43f3cd=await warehouse[_0x1caab6(0xa4)]([{'$match':{'status':_0x1caab6(0x121),'warehouse_category':_0x1caab6(0xea),'name':{'$ne':'Return\x20Goods','$ne':_0x1caab6(0xf9)}}},{'$group':{'_id':_0x1caab6(0x14c),'name':{'$first':_0x1caab6(0x14c)}}},{'$sort':{'name':0x1}}]);var _0x592fa3=[_0x1caab6(0x10e)];const _0x2be563=await warehouse[_0x1caab6(0xa4)]([{'$match':{'status':_0x1caab6(0x121),'name':_0x1caab6(0xf9)}},{'$group':{'_id':_0x1caab6(0x14c),'name':{'$first':_0x1caab6(0x14c)}}},{'$sort':{'name':0x1}}]);if(_0xe0b473[0x0][_0x1caab6(0xb3)]==_0x1caab6(0xb6)){var _0xf3002=users[_0x1caab6(0xa0)];console['log'](_0xf3002);}else{if(_0xe0b473[0x0][_0x1caab6(0xb3)]=='Hindi')var _0xf3002=users['Hindi'];else{if(_0xe0b473[0x0]['language']==_0x1caab6(0xf3))var _0xf3002=users['German'];else{if(_0xe0b473[0x0][_0x1caab6(0xb3)]==_0x1caab6(0x74))var _0xf3002=users[_0x1caab6(0x74)];else{if(_0xe0b473[0x0][_0x1caab6(0xb3)]=='French')var _0xf3002=users[_0x1caab6(0x18e)];else{if(_0xe0b473[0x0]['language']==_0x1caab6(0x73))var _0xf3002=users[_0x1caab6(0x12f)];else{if(_0xe0b473[0x0]['language']==_0x1caab6(0x7e))var _0xf3002=users[_0x1caab6(0x7e)];else{if(_0xe0b473[0x0][_0x1caab6(0xb3)]==_0x1caab6(0xaa))var _0xf3002=users[_0x1caab6(0x123)];}}}}}}}_0x2a4128[_0x1caab6(0x9a)]('return_sale_finished',{'success':_0x364cf6['flash'](_0x1caab6(0x108)),'errors':_0x364cf6[_0x1caab6(0x179)](_0x1caab6(0xbf)),'role':_0x1d9908,'profile':_0x3f1e40,'user':_0x505742,'stock':_0x194b17,'master_shop':_0xe0b473,'unit':_0x173099,'language':_0xf3002,'warehouses':_0x43f3cd,'rooms':_0x592fa3,'warehouse_QA':_0x2be563});}catch(_0x2daf89){console['log'](_0x2daf89),_0x2a4128['status'](0xc8)['json']({'message':_0x2daf89['message']});}}),router[a0_0x379413(0x12e)](a0_0x379413(0x8f),auth,async(_0xac4b7d,_0x1c8321)=>{var _0x447b24=a0_0x379413;if(_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xe4)]=='QA')try{const {invoice:_0x2400cd,date:_0x15127f,warehouse_name:_0x4130cc,product_name:_0x25612a,primary_code:_0xadaa8c,secondary_code:_0x4d5c11,product_code:_0x136f93,sales_quantity:_0x45266f,stocks:_0x26f270,return_qty:_0x4dccf6,Room_name:_0x2693e9,to_warehouse_name_QA:_0x12447c,to_Room_name_QA:_0x1a4c50,note:_0x55b64a,for_categorize:_0x3048ee,product_name_QA1:_0x5df752}=_0xac4b7d[_0x447b24(0x133)];if(typeof _0x5df752==_0x447b24(0xf7))var _0x20490a=[_0xac4b7d[_0x447b24(0x133)]['product_name_QA1']],_0x1ba563=[_0xac4b7d['body']['primary_code_QA']],_0x227eab=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x146)]],_0x3425d7=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x143)]],_0x5beeb3=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x101)]],_0x37a4f6=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x190)]],_0xfd5bd3=[_0xac4b7d['body'][_0x447b24(0x13c)]],_0x5814dc=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x147)]],_0x494234=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x184)]],_0x5f5050=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xdd)]],_0x5b4bec=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x18f)]],_0x2bb6ca=[_0xac4b7d[_0x447b24(0x133)]['unit_QA']],_0x1473c1=[_0xac4b7d['body'][_0x447b24(0xad)]],_0x451a94=[_0xac4b7d['body'][_0x447b24(0x172)]];else var _0x20490a=[..._0xac4b7d['body']['product_name_QA1']],_0x1ba563=[..._0xac4b7d['body']['primary_code_QA']],_0x227eab=[..._0xac4b7d[_0x447b24(0x133)]['secondary_code_QA']],_0x3425d7=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x143)]],_0x5beeb3=[..._0xac4b7d[_0x447b24(0x133)]['sales_quantity_QA']],_0x37a4f6=[..._0xac4b7d[_0x447b24(0x133)]['stocks_QA']],_0xfd5bd3=[..._0xac4b7d['body']['return_qty_QA']],_0x5814dc=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x147)]],_0x494234=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x184)]],_0x5f5050=[..._0xac4b7d['body'][_0x447b24(0xdd)]],_0x5b4bec=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x18f)]],_0x2bb6ca=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x145)]],_0x1473c1=[..._0xac4b7d[_0x447b24(0x133)]['production_date_QA']],_0x451a94=[..._0xac4b7d[_0x447b24(0x133)]['expiry_date_QA']];const _0x31d6a1=_0x20490a[_0x447b24(0x109)](_0x56e726=>{return _0x56e726={'product_name':_0x56e726};});_0x1ba563[_0x447b24(0xfa)]((_0x3062d8,_0x557a53)=>{_0x31d6a1[_0x557a53]['primary_code']=_0x3062d8;}),_0x227eab[_0x447b24(0xfa)]((_0x53a70a,_0x158510)=>{var _0x320e28=_0x447b24;_0x31d6a1[_0x158510][_0x320e28(0x78)]=_0x53a70a;}),_0x3425d7[_0x447b24(0xfa)]((_0x362ff0,_0x3cd31b)=>{var _0x27a2e2=_0x447b24;_0x31d6a1[_0x3cd31b][_0x27a2e2(0x7b)]=_0x362ff0;}),_0x5beeb3[_0x447b24(0xfa)]((_0x680352,_0x5dd4bd)=>{var _0x18678f=_0x447b24;_0x31d6a1[_0x5dd4bd][_0x18678f(0x14b)]=_0x680352;}),_0x37a4f6['forEach']((_0x152a61,_0x4f1f45)=>{var _0x527bad=_0x447b24;_0x31d6a1[_0x4f1f45][_0x527bad(0x8c)]=_0x152a61;}),_0xfd5bd3[_0x447b24(0xfa)]((_0x55d304,_0x55562e)=>{var _0x10329b=_0x447b24;_0x31d6a1[_0x55562e][_0x10329b(0xfd)]=_0x55d304;}),_0x5814dc['forEach']((_0x43a319,_0x13ee5a)=>{var _0x4fc2aa=_0x447b24;_0x31d6a1[_0x13ee5a][_0x4fc2aa(0xca)]=_0x43a319;}),_0x494234[_0x447b24(0xfa)]((_0x128c4e,_0x20df43)=>{var _0x2f27dd=_0x447b24;_0x31d6a1[_0x20df43][_0x2f27dd(0xd6)]=_0x128c4e;}),_0x5f5050[_0x447b24(0xfa)]((_0x201876,_0x148d0e)=>{var _0x17d430=_0x447b24;_0x31d6a1[_0x148d0e][_0x17d430(0xc1)]=_0x201876;}),_0x5b4bec['forEach']((_0x4e3a41,_0xb87dde)=>{_0x31d6a1[_0xb87dde]['secondary_unit']=_0x4e3a41;}),_0x2bb6ca[_0x447b24(0xfa)]((_0x39c7ef,_0x30c35a)=>{var _0x303f80=_0x447b24;_0x31d6a1[_0x30c35a][_0x303f80(0xef)]=_0x39c7ef;}),_0x1473c1[_0x447b24(0xfa)]((_0x39c1e2,_0x309e19)=>{_0x31d6a1[_0x309e19]['production_date']=_0x39c1e2;}),_0x451a94[_0x447b24(0xfa)]((_0x3268a4,_0x28dc79)=>{var _0x5dc3c3=_0x447b24;_0x31d6a1[_0x28dc79][_0x5dc3c3(0xf0)]=_0x3268a4;});const _0x1fa1ff=await sales_finished[_0x447b24(0xb8)]({'invoice':_0x2400cd});_0x1fa1ff[_0x447b24(0x105)]='True';const _0x3a0305=await _0x1fa1ff[_0x447b24(0xa3)](),_0x18b220=new sales_return_finished({'invoice':_0x2400cd,'customer':_0xac4b7d[_0x447b24(0x133)]['customer'],'date':_0x15127f,'warehouse_name':_0x4130cc,'room':_0x2693e9,'ToWarehouse':_0x12447c,'ToRoom':_0x1a4c50,'return_sale_QA':_0x31d6a1,'note':_0x55b64a,'warehouse_cat':_0x3048ee}),_0x3a8557=await _0x18b220['save'](),_0xc3e1cd=await sales_return_finished[_0x447b24(0xb8)]({'invoice':_0x2400cd}),_0x5bccac=await warehouse[_0x447b24(0xb8)]({'name':_0x12447c,'room':_0x1a4c50});_0xc3e1cd[_0x447b24(0xba)][_0x447b24(0xfa)](_0x2b23a1=>{var _0x2ed7ad=_0x447b24,_0x9c0aa4=0x0;const _0x2fc339=_0x5bccac[_0x2ed7ad(0x11d)][_0x2ed7ad(0x109)](_0x715130=>{var _0xd72963=_0x2ed7ad;_0x715130['product_name']==_0x2b23a1[_0xd72963(0x125)]&&_0x715130[_0xd72963(0xf0)]==_0x2b23a1[_0xd72963(0xf0)]&&_0x715130[_0xd72963(0x135)]==_0x2b23a1[_0xd72963(0x135)]&&_0x715130[_0xd72963(0xc1)]==_0x2b23a1[_0xd72963(0xc1)]&&(_0x715130[_0xd72963(0xec)]=parseInt(_0x715130[_0xd72963(0xec)])+parseInt(_0x2b23a1['return_qty']),_0x9c0aa4++);});_0x9c0aa4=='0'&&(_0x5bccac['product_details']=_0x5bccac['product_details'][_0x2ed7ad(0x8d)]({'product_name':_0x2b23a1[_0x2ed7ad(0x125)],'product_stock':_0x2b23a1[_0x2ed7ad(0xfd)],'primary_code':_0x2b23a1[_0x2ed7ad(0x7a)],'secondary_code':_0x2b23a1[_0x2ed7ad(0x78)],'product_code':_0x2b23a1['product_code'],'batch_code':_0x2b23a1[_0x2ed7ad(0xc1)],'maxPerUnit':_0x2b23a1[_0x2ed7ad(0xca)],'production_date':_0x2b23a1[_0x2ed7ad(0x135)],'expiry_date':_0x2b23a1[_0x2ed7ad(0xf0)],'secondary_unit':_0x2b23a1[_0x2ed7ad(0x14e)],'unit':_0x2b23a1[_0x2ed7ad(0xef)],'maxProducts':_0x2b23a1[_0x2ed7ad(0xd6)],'bay':_0x2b23a1['bay']}));}),await _0x5bccac[_0x447b24(0xa3)]();const _0x3de5f2=new c_payment_data({'invoice':_0x2400cd,'customer':_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xe8)],'reason':_0x447b24(0x185)});await _0x3de5f2[_0x447b24(0xa3)]();const _0x16a796=await master_shop['find'](),_0x5e86c9=await email_settings[_0x447b24(0xb8)](),_0x229cbc=await customer['findOne']({'name':_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xe8)]});_0x16a796[0x0][_0x447b24(0x150)]==0x1?(right_currency=_0x16a796[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x16a796[0x0][_0x447b24(0x17d)]);var _0x11ef8=_0x20490a,_0x33adac=_0xfd5bd3,_0x46f23e='',_0x5e4dd9;for(_0x5e4dd9 in _0x11ef8){_0x46f23e+='<tr>'+_0x447b24(0x13f)+_0x11ef8[_0x5e4dd9]+_0x447b24(0xb7)+_0x447b24(0x13f)+_0x33adac[_0x5e4dd9]+_0x447b24(0xb7)+'</tr>';}console[_0x447b24(0x8e)]('product_list',_0x46f23e);let _0x523aff=nodemailer[_0x447b24(0xcb)]({'service':_0x447b24(0x13b),'auth':{'user':_0x5e86c9[_0x447b24(0x176)],'pass':_0x5e86c9[_0x447b24(0x138)]}}),_0x3c40de={'from':_0x5e86c9['email'],'to':_0x229cbc[_0x447b24(0x176)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x447b24(0xc0)+_0x447b24(0x173)+_0x16a796[0x0][_0x447b24(0x161)],'cid':_0x447b24(0x130)}],'html':'<!DOCTYPE\x20html>'+_0x447b24(0x16e)+_0x447b24(0xd4)+'<div>'+_0x447b24(0x17a)+_0x447b24(0x187)+_0x447b24(0x8b)+_0x447b24(0x192)+_0x447b24(0x187)+_0x447b24(0x182)+_0x16a796[0x0][_0x447b24(0x92)]+'\x20</h2>'+_0x447b24(0x192)+_0x447b24(0x192)+_0x447b24(0xe2)+'<div>'+_0x447b24(0x162)+_0x447b24(0xfb)+_0x2400cd+'\x20'+_0x447b24(0x18d)+_0x447b24(0x12d)+_0x15127f+'\x20'+_0x447b24(0x180)+_0x447b24(0x167)+_0x447b24(0x192)+_0x447b24(0x117)+_0x447b24(0xe3)+_0x447b24(0x144)+_0x447b24(0x14f)+_0x447b24(0x10b)+_0x447b24(0xa2)+_0x447b24(0xc3)+_0x447b24(0x17b)+_0x447b24(0xa5)+_0x447b24(0x12b)+'\x20'+_0x46f23e+'\x20'+_0x447b24(0x16d)+_0x447b24(0x166)+_0x447b24(0x187)+_0x447b24(0x15c)+_0x447b24(0x11a)+_0x16a796[0x0]['site_title']+_0x447b24(0x167)+_0x447b24(0x192)+'</div>'+_0x447b24(0x178)};_0x523aff['sendMail'](_0x3c40de,function(_0x244c61,_0x459792){var _0xf35ea0=_0x447b24;_0x244c61?(console[_0xf35ea0(0x8e)](_0x244c61),console['log'](_0xf35ea0(0xf2))):console[_0xf35ea0(0x8e)](_0xf35ea0(0x181));}),_0xac4b7d[_0x447b24(0x179)]('success',_0x447b24(0x8a)),_0x1c8321['redirect'](_0x447b24(0x111));}catch(_0x10bf3d){_0x1c8321[_0x447b24(0x9e)](0xc8)[_0x447b24(0x15a)]({'message1':_0x10bf3d[_0x447b24(0x13d)]});}else{if(_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xe4)]=='GS')try{const {invoice:_0x44f080,date:_0x58abc5,warehouse_name:_0x1e71c1,product_name:_0x9d356a,primary_code:_0x166fd2,secondary_code:_0x11eb88,product_code:_0xfd4515,sales_quantity:_0x5922dc,stocks:_0x1fc9be,return_qty:_0x254ec3,Room_name:_0x244457,to_warehouse_name:_0x441a84,to_Room_name:_0x47801e,note:_0x1a9713,level:_0x3f95f0,isle:_0x1f7a44,pallet:_0x197605,for_categorize:_0x59fa99}=_0xac4b7d[_0x447b24(0x133)];if(typeof _0x9d356a==_0x447b24(0xf7))var _0x20490a=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x125)]],_0x1ba563=[_0xac4b7d['body']['primary_code']],_0x227eab=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x78)]],_0x3425d7=[_0xac4b7d[_0x447b24(0x133)]['product_code']],_0x5beeb3=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x15b)]],_0xfd5bd3=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xfd)]],_0x5f03ac=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xc6)]],_0x5814dc=[_0xac4b7d[_0x447b24(0x133)]['maxPerUnit']],_0x494234=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xd6)]],_0x5f5050=[_0xac4b7d[_0x447b24(0x133)]['batch_code']],_0x5b4bec=[_0xac4b7d['body'][_0x447b24(0x14e)]],_0x2bb6ca=[_0xac4b7d[_0x447b24(0x133)]['unit']],_0x1473c1=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0x135)]],_0x451a94=[_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xf0)]];else var _0x20490a=[..._0xac4b7d[_0x447b24(0x133)]['product_name']],_0x1ba563=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x7a)]],_0x227eab=[..._0xac4b7d[_0x447b24(0x133)]['secondary_code']],_0x3425d7=[..._0xac4b7d['body'][_0x447b24(0x7b)]],_0x5beeb3=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x15b)]],_0xfd5bd3=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0xfd)]],_0x5f03ac=[..._0xac4b7d['body']['bay']],_0x5814dc=[..._0xac4b7d['body'][_0x447b24(0xca)]],_0x494234=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0xd6)]],_0x5f5050=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0xc1)]],_0x5b4bec=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x14e)]],_0x2bb6ca=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0xef)]],_0x1473c1=[..._0xac4b7d[_0x447b24(0x133)][_0x447b24(0x135)]],_0x451a94=[..._0xac4b7d[_0x447b24(0x133)]['expiry_date']];const _0x3afab8=_0x20490a[_0x447b24(0x109)](_0x3ea587=>{return _0x3ea587={'product_name':_0x3ea587};});_0x1ba563[_0x447b24(0xfa)]((_0x33a43c,_0x5b2da6)=>{_0x3afab8[_0x5b2da6]['primary_code']=_0x33a43c;}),_0x227eab['forEach']((_0x22744a,_0xda107d)=>{var _0x8db8b=_0x447b24;_0x3afab8[_0xda107d][_0x8db8b(0x78)]=_0x22744a;}),_0x3425d7['forEach']((_0x1c50de,_0x12695b)=>{_0x3afab8[_0x12695b]['product_code']=_0x1c50de;}),_0x5beeb3['forEach']((_0x1f115d,_0x33659d)=>{var _0x1179ce=_0x447b24;_0x3afab8[_0x33659d][_0x1179ce(0x14b)]=_0x1f115d;}),_0xfd5bd3[_0x447b24(0xfa)]((_0x4f7d5e,_0x3c7c0a)=>{var _0x133be4=_0x447b24;_0x3afab8[_0x3c7c0a][_0x133be4(0xfd)]=_0x4f7d5e;}),_0x5f03ac[_0x447b24(0xfa)]((_0x98a324,_0x512ffb)=>{var _0x17003d=_0x447b24;_0x3afab8[_0x512ffb][_0x17003d(0xc6)]=_0x98a324;}),_0x5814dc[_0x447b24(0xfa)]((_0x538393,_0x2071a5)=>{var _0x19df8f=_0x447b24;_0x3afab8[_0x2071a5][_0x19df8f(0xca)]=_0x538393;}),_0x494234[_0x447b24(0xfa)]((_0x28a98f,_0x81267c)=>{var _0x598dbd=_0x447b24;_0x3afab8[_0x81267c][_0x598dbd(0xd6)]=_0x28a98f;}),_0x5f5050[_0x447b24(0xfa)]((_0x1b622b,_0x3ca937)=>{var _0x18a88f=_0x447b24;_0x3afab8[_0x3ca937][_0x18a88f(0xc1)]=_0x1b622b;}),_0x5b4bec['forEach']((_0xd27bf5,_0x5a39a2)=>{var _0x2d79ff=_0x447b24;_0x3afab8[_0x5a39a2][_0x2d79ff(0x14e)]=_0xd27bf5;}),_0x2bb6ca[_0x447b24(0xfa)]((_0x440013,_0x2a974e)=>{var _0x3f7f92=_0x447b24;_0x3afab8[_0x2a974e][_0x3f7f92(0xef)]=_0x440013;}),_0x1473c1[_0x447b24(0xfa)]((_0x38acfa,_0x106301)=>{_0x3afab8[_0x106301]['production_date']=_0x38acfa;}),_0x451a94['forEach']((_0x3ef609,_0x356a52)=>{var _0x30aa01=_0x447b24;_0x3afab8[_0x356a52][_0x30aa01(0xf0)]=_0x3ef609;});var _0x46ce18=0x0;_0x3afab8[_0x447b24(0xfa)](_0x1ab1e6=>{var _0x1c267b=_0x447b24;(parseInt(_0x1ab1e6['sale_qty'])<parseInt(_0x1ab1e6[_0x1c267b(0xfd)])||parseInt(_0x1ab1e6[_0x1c267b(0x8c)])<parseInt(_0x1ab1e6[_0x1c267b(0xfd)])&&parseInt(_0x1ab1e6['sale_qty'])>parseInt(_0x1ab1e6[_0x1c267b(0xfd)])||parseInt(_0x1ab1e6[_0x1c267b(0xfd)])==0x0)&&_0x46ce18++;});if(_0x46ce18!=0x0)return _0xac4b7d[_0x447b24(0x179)](_0x447b24(0xbf),_0x447b24(0x85)),_0x1c8321['redirect'](_0x447b24(0x12c));const _0x5a2d66=await sales_finished[_0x447b24(0xb8)]({'invoice':_0x44f080});_0x5a2d66[_0x447b24(0x105)]='True';const _0x3da0de=await _0x5a2d66[_0x447b24(0xa3)](),_0x5114b6=new sales_return_finished({'invoice':_0x44f080,'customer':_0xac4b7d['body'][_0x447b24(0xe8)],'date':_0x58abc5,'warehouse_name':_0x1e71c1,'room':_0x244457,'ToWarehouse':_0x441a84,'ToRoom':_0x47801e,'return_sale':_0x3afab8,'note':_0x1a9713,'warehouse_cat':_0x59fa99}),_0x3a2848=await _0x5114b6[_0x447b24(0xa3)](),_0x5e2760=await sales_return_finished[_0x447b24(0xb8)]({'invoice':_0x44f080}),_0x98fea6=await warehouse[_0x447b24(0xb8)]({'name':_0x441a84,'room':_0x47801e,'warehouse_category':_0x447b24(0xea)});_0x5e2760[_0x447b24(0x15f)][_0x447b24(0xfa)](_0x46d957=>{var _0x5ef235=_0x447b24,_0x3fb124=0x0;const _0x3d72ad=_0x98fea6[_0x5ef235(0x11d)][_0x5ef235(0x109)](_0x41a709=>{var _0x16dec1=_0x5ef235;_0x41a709[_0x16dec1(0x125)]==_0x46d957[_0x16dec1(0x125)]&&_0x41a709[_0x16dec1(0xc6)]==_0x46d957[_0x16dec1(0xc6)]&&_0x41a709[_0x16dec1(0xf0)]==_0x46d957[_0x16dec1(0xf0)]&&_0x41a709[_0x16dec1(0x135)]==_0x46d957['production_date']&&_0x41a709['batch_code']==_0x46d957[_0x16dec1(0xc1)]&&(_0x41a709['product_stock']=parseInt(_0x41a709['product_stock'])+parseInt(_0x46d957[_0x16dec1(0xfd)]),_0x3fb124++);});_0x3fb124=='0'&&(_0x98fea6[_0x5ef235(0x11d)]=_0x98fea6[_0x5ef235(0x11d)][_0x5ef235(0x8d)]({'product_name':_0x46d957[_0x5ef235(0x125)],'product_stock':_0x46d957[_0x5ef235(0xfd)],'primary_code':_0x46d957[_0x5ef235(0x7a)],'secondary_code':_0x46d957[_0x5ef235(0x78)],'product_code':_0x46d957['product_code'],'bay':_0x46d957[_0x5ef235(0xc6)],'batch_code':_0x46d957['batch_code'],'maxPerUnit':_0x46d957[_0x5ef235(0xca)],'production_date':_0x46d957[_0x5ef235(0x135)],'expiry_date':_0x46d957[_0x5ef235(0xf0)],'secondary_unit':_0x46d957[_0x5ef235(0x14e)],'unit':_0x46d957[_0x5ef235(0xef)],'maxProducts':_0x46d957['maxProducts']}));}),await _0x98fea6['save'](),console[_0x447b24(0x8e)](_0xac4b7d['body']);const _0x23bcb=new c_payment_data({'invoice':_0x44f080,'customer':_0xac4b7d[_0x447b24(0x133)][_0x447b24(0xe8)],'reason':_0x447b24(0x185)});await _0x23bcb[_0x447b24(0xa3)]();const _0x65730d=await master_shop[_0x447b24(0x174)]();console[_0x447b24(0x8e)]('add\x20post',_0x65730d[0x0][_0x447b24(0x161)]);const _0x19234f=await email_settings[_0x447b24(0xb8)](),_0xe7ee3e=await customer[_0x447b24(0xb8)]({'name':_0xac4b7d[_0x447b24(0x133)]['customer']});console['log'](_0x447b24(0xd7),_0xe7ee3e);_0x65730d[0x0][_0x447b24(0x150)]==0x1?(right_currency=_0x65730d[0x0][_0x447b24(0x17d)],left_currency=''):(right_currency='',left_currency=_0x65730d[0x0][_0x447b24(0x17d)]);var _0x11ef8=_0x20490a,_0x33adac=_0xfd5bd3,_0x46f23e='',_0x5e4dd9;for(_0x5e4dd9 in _0x11ef8){_0x46f23e+=_0x447b24(0x144)+_0x447b24(0x13f)+_0x11ef8[_0x5e4dd9]+_0x447b24(0xb7)+_0x447b24(0x13f)+_0x33adac[_0x5e4dd9]+_0x447b24(0xb7)+_0x447b24(0x17b);}console[_0x447b24(0x8e)](_0x447b24(0x188),_0x46f23e);let _0x55a195=nodemailer[_0x447b24(0xcb)]({'service':'gmail','auth':{'user':_0x19234f['email'],'pass':_0x19234f[_0x447b24(0x138)]}}),_0x5f1d47={'from':_0x19234f[_0x447b24(0x176)],'to':_0xe7ee3e[_0x447b24(0x176)],'subject':_0x447b24(0x87),'attachments':[{'filename':_0x447b24(0x83),'path':__dirname+'/../public'+_0x447b24(0x173)+_0x65730d[0x0][_0x447b24(0x161)],'cid':_0x447b24(0x130)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x447b24(0xd4)+_0x447b24(0x187)+_0x447b24(0x17a)+_0x447b24(0x187)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+_0x447b24(0x182)+_0x65730d[0x0][_0x447b24(0x92)]+_0x447b24(0x17f)+_0x447b24(0x192)+_0x447b24(0x192)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x447b24(0x162)+_0x447b24(0xfb)+_0x44f080+'\x20'+_0x447b24(0x18d)+'\x20Order\x20Date\x20:\x20'+_0x58abc5+'\x20'+_0x447b24(0x180)+_0x447b24(0x167)+'</div>'+_0x447b24(0x117)+_0x447b24(0xe3)+_0x447b24(0x144)+_0x447b24(0x14f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x447b24(0xc3)+'</tr>'+_0x447b24(0xa5)+_0x447b24(0x12b)+'\x20'+_0x46f23e+'\x20'+_0x447b24(0x16d)+'</table>'+_0x447b24(0x187)+_0x447b24(0x15c)+_0x447b24(0x11a)+_0x65730d[0x0][_0x447b24(0x92)]+_0x447b24(0x167)+'</div>'+'</div>'+'</body></html>'};_0x55a195[_0x447b24(0x128)](_0x5f1d47,function(_0x5b62de,_0x507a85){var _0xbbfbc1=_0x447b24;_0x5b62de?(console['log'](_0x5b62de),console[_0xbbfbc1(0x8e)](_0xbbfbc1(0xf2))):console[_0xbbfbc1(0x8e)]('Email\x20sent\x20successfully');}),_0xac4b7d[_0x447b24(0x179)]('success',_0x447b24(0x8a)),_0x1c8321[_0x447b24(0x113)](_0x447b24(0x111));}catch(_0x23b0fc){console[_0x447b24(0x8e)](_0x23b0fc),_0x1c8321['status'](0xc8)['json']({'message1':_0x23b0fc[_0x447b24(0x13d)]});}}}),router[a0_0x379413(0x177)](a0_0x379413(0xc2),auth,async(_0x2fb3fd,_0x3419c5)=>{var _0x54c5e0=a0_0x379413;try{const {username:_0x270ce6,email:_0x420fd9,role:_0x398d88}=_0x2fb3fd['user'],_0x5811f2=_0x2fb3fd[_0x54c5e0(0xcc)],_0x550dd5=await profile[_0x54c5e0(0xb8)]({'email':_0x5811f2[_0x54c5e0(0x176)]}),_0x14948b=await master_shop[_0x54c5e0(0x174)]();console[_0x54c5e0(0x8e)](_0x54c5e0(0x18c),_0x14948b);const _0x529a2c=_0x2fb3fd[_0x54c5e0(0xce)]['id'],_0x30cc3e=await sales['findById'](_0x529a2c);console['log'](_0x54c5e0(0x131),_0x30cc3e);if(_0x14948b[0x0][_0x54c5e0(0xb3)]==_0x54c5e0(0xb6))var _0x272618=users[_0x54c5e0(0xa0)];else{if(_0x14948b[0x0][_0x54c5e0(0xb3)]==_0x54c5e0(0xac))var _0x272618=users[_0x54c5e0(0xac)];else{if(_0x14948b[0x0]['language']=='German')var _0x272618=users[_0x54c5e0(0xf3)];else{if(_0x14948b[0x0][_0x54c5e0(0xb3)]=='Spanish')var _0x272618=users[_0x54c5e0(0x74)];else{if(_0x14948b[0x0][_0x54c5e0(0xb3)]==_0x54c5e0(0x18e))var _0x272618=users[_0x54c5e0(0x18e)];else{if(_0x14948b[0x0][_0x54c5e0(0xb3)]==_0x54c5e0(0x73))var _0x272618=users[_0x54c5e0(0x12f)];else{if(_0x14948b[0x0][_0x54c5e0(0xb3)]==_0x54c5e0(0x7e))var _0x272618=users[_0x54c5e0(0x7e)];else{if(_0x14948b[0x0][_0x54c5e0(0xb3)]==_0x54c5e0(0xaa))var _0x272618=users[_0x54c5e0(0x123)];}}}}}}}_0x3419c5[_0x54c5e0(0x9a)](_0x54c5e0(0x124),{'success':_0x2fb3fd[_0x54c5e0(0x179)](_0x54c5e0(0x108)),'errors':_0x2fb3fd['flash'](_0x54c5e0(0xbf)),'role':_0x5811f2,'profile':_0x550dd5,'alldata':_0x30cc3e,'master_shop':_0x14948b,'language':_0x272618});}catch(_0x4d2333){console[_0x54c5e0(0x8e)](_0x4d2333);}}),router['post'](a0_0x379413(0x16a),async(_0x5970f3,_0xeb2099)=>{var _0x2cca61=a0_0x379413;const {product_code:_0x179878,warehouse_name:_0x52178e,rooms_data:_0x48014e,Roomslist:_0x270647}=_0x5970f3[_0x2cca61(0x133)],_0x479a52=_0x270647[_0x2cca61(0x16c)](','),_0x464e12=[];async function _0x2960f5(_0x54cc70){var _0x512e30=_0x2cca61;const _0x24a457=await warehouse[_0x512e30(0xa4)]([{'$match':{'name':_0x52178e,'room':_0x54cc70}},{'$unwind':_0x512e30(0x157)},{'$match':{'product_details.primary_code':_0x179878}},{'$group':{'_id':_0x512e30(0x14a),'name':{'$first':_0x512e30(0x186)},'product_stock':{'$first':_0x512e30(0x112)},'primary_code':{'$first':_0x512e30(0xf6)},'secondary_code':{'$first':_0x512e30(0x80)},'product_code':{'$first':_0x512e30(0x86)},'level':{'$first':_0x512e30(0x103)},'isle':{'$first':_0x512e30(0xb0)},'type':{'$first':_0x512e30(0xbc)},'pallet':{'$first':_0x512e30(0x94)},'unit':{'$first':_0x512e30(0xd8)},'secondary_unit':{'$first':_0x512e30(0xc9)},'storage':{'$first':_0x512e30(0x71)},'rack':{'$first':_0x512e30(0xd5)},'expiry_date':{'$first':_0x512e30(0x155)},'production_date':{'$first':_0x512e30(0x9c)},'maxPerUnit':{'$first':_0x512e30(0xe7)},'batch_code':{'$first':_0x512e30(0x15d)},'product_cat':{'$first':_0x512e30(0x79)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x512e30(0x169)}}}]),_0x578671=await warehouse['aggregate']([{'$match':{'name':_0x52178e,'room':_0x54cc70}},{'$unwind':_0x512e30(0x157)},{'$match':{'product_details.secondary_code':_0x179878}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x512e30(0x186)},'product_stock':{'$first':_0x512e30(0x112)},'primary_code':{'$first':_0x512e30(0xf6)},'secondary_code':{'$first':_0x512e30(0x80)},'product_code':{'$first':_0x512e30(0x86)},'level':{'$first':_0x512e30(0x103)},'isle':{'$first':_0x512e30(0xb0)},'type':{'$first':_0x512e30(0xbc)},'pallet':{'$first':_0x512e30(0x94)},'unit':{'$first':_0x512e30(0xd8)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x512e30(0x71)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x512e30(0x155)},'production_date':{'$first':_0x512e30(0x9c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x512e30(0x15d)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x512e30(0xb2)},'invoice':{'$first':_0x512e30(0x169)}}}]);if(_0x24a457[_0x512e30(0x158)]>0x0)_0x464e12[_0x512e30(0x17c)](_0x24a457);else _0x578671[_0x512e30(0x158)]>0x0&&_0x464e12[_0x512e30(0x17c)](_0x578671);}const _0x4a97dc=_0x479a52[_0x2cca61(0x109)](_0xf95b49=>_0x2960f5(_0xf95b49));await Promise[_0x2cca61(0xa1)](_0x4a97dc),_0xeb2099[_0x2cca61(0x15a)](_0x464e12);}),module[a0_0x379413(0xe1)]=router;