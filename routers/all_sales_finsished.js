var a0_0x5b567a=a0_0x13e0;(function(_0x2dfbc5,_0x1d4e57){var _0x2f1fb1=a0_0x13e0,_0x30a549=_0x2dfbc5();while(!![]){try{var _0x2298d7=-parseInt(_0x2f1fb1(0x1b6))/0x1+parseInt(_0x2f1fb1(0x1c7))/0x2*(-parseInt(_0x2f1fb1(0x13c))/0x3)+parseInt(_0x2f1fb1(0x14b))/0x4+parseInt(_0x2f1fb1(0x1cf))/0x5+parseInt(_0x2f1fb1(0x1c9))/0x6+-parseInt(_0x2f1fb1(0x1a0))/0x7*(-parseInt(_0x2f1fb1(0x1d9))/0x8)+-parseInt(_0x2f1fb1(0x1c2))/0x9*(parseInt(_0x2f1fb1(0x151))/0xa);if(_0x2298d7===_0x1d4e57)break;else _0x30a549['push'](_0x30a549['shift']());}catch(_0x3d82b6){_0x30a549['push'](_0x30a549['shift']());}}}(a0_0xbc56,0x1e14f));const express=require('express'),app=express(),router=express[a0_0x5b567a(0x1ed)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x5b567a(0x1b7)),auth=require(a0_0x5b567a(0x149)),nodemailer=require('nodemailer'),users=require(a0_0x5b567a(0x1ff));function a0_0x13e0(_0x13beeb,_0xfda606){var _0xbc56d5=a0_0xbc56();return a0_0x13e0=function(_0x13e033,_0x28ad14){_0x13e033=_0x13e033-0x134;var _0x5e25ee=_0xbc56d5[_0x13e033];return _0x5e25ee;},a0_0x13e0(_0x13beeb,_0xfda606);}router[a0_0x5b567a(0x160)](a0_0x5b567a(0x20b),auth,async(_0xbf5186,_0x32b8d1)=>{var _0x3b7efc=a0_0x5b567a;try{const {username:_0x8b10f9,email:_0x16ca81,role:_0x5195fd}=_0xbf5186[_0x3b7efc(0x144)],_0x147052=_0xbf5186[_0x3b7efc(0x144)],_0x52d006=await profile[_0x3b7efc(0x19b)]({'email':_0x147052[_0x3b7efc(0x22a)]}),_0x455f2d=await master_shop['find']();let _0x998879;if(_0x147052[_0x3b7efc(0x1f6)]==_0x3b7efc(0x185)){const _0x4d803d=await staff['findOne']({'email':_0x147052[_0x3b7efc(0x22a)]});_0x998879=await sales_finished[_0x3b7efc(0x1d8)]([{'$lookup':{'from':_0x3b7efc(0x210),'localField':_0x3b7efc(0x21d),'foreignField':_0x3b7efc(0x1af),'as':_0x3b7efc(0x23b)}},{'$unwind':'$customers_docs'},{'$unwind':_0x3b7efc(0x195)},{'$group':{'_id':_0x3b7efc(0x214),'invoice':{'$first':_0x3b7efc(0x181)},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x3b7efc(0x195)},'note':{'$first':_0x3b7efc(0x21a)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x3b7efc(0x1ab)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x3b7efc(0x241)},'type':{'$addToSet':_0x3b7efc(0x23c)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x3b7efc(0x174)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x998879=await sales_finished['aggregate']([{'$lookup':{'from':_0x3b7efc(0x210),'localField':_0x3b7efc(0x21d),'foreignField':'name','as':_0x3b7efc(0x23b)}},{'$unwind':_0x3b7efc(0x235)},{'$unwind':_0x3b7efc(0x195)},{'$group':{'_id':_0x3b7efc(0x214),'invoice':{'$first':_0x3b7efc(0x181)},'customers':{'$first':'$customer'},'date':{'$first':_0x3b7efc(0x142)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x3b7efc(0x21a)},'return_data':{'$first':_0x3b7efc(0x1a9)},'customers_docs':{'$first':_0x3b7efc(0x235)},'total_saleproduct_quantity':{'$sum':_0x3b7efc(0x1ab)},'level':{'$addToSet':_0x3b7efc(0x211)},'isle':{'$addToSet':_0x3b7efc(0x241)},'type':{'$addToSet':_0x3b7efc(0x23c)},'pallet':{'$addToSet':_0x3b7efc(0x1a2)},'finalize':{'$first':_0x3b7efc(0x174)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x455f2d[0x0][_0x3b7efc(0x20d)]==_0x3b7efc(0x1a5)){var _0x41856f=users[_0x3b7efc(0x244)];console[_0x3b7efc(0x227)](_0x41856f);}else{if(_0x455f2d[0x0][_0x3b7efc(0x20d)]==_0x3b7efc(0x18d))var _0x41856f=users[_0x3b7efc(0x18d)];else{if(_0x455f2d[0x0][_0x3b7efc(0x20d)]==_0x3b7efc(0x17b))var _0x41856f=users['German'];else{if(_0x455f2d[0x0][_0x3b7efc(0x20d)]==_0x3b7efc(0x1bc))var _0x41856f=users[_0x3b7efc(0x1bc)];else{if(_0x455f2d[0x0]['language']==_0x3b7efc(0x1ca))var _0x41856f=users[_0x3b7efc(0x1ca)];else{if(_0x455f2d[0x0][_0x3b7efc(0x20d)]==_0x3b7efc(0x157))var _0x41856f=users[_0x3b7efc(0x247)];else{if(_0x455f2d[0x0]['language']==_0x3b7efc(0x1bf))var _0x41856f=users[_0x3b7efc(0x1bf)];else{if(_0x455f2d[0x0][_0x3b7efc(0x20d)]==_0x3b7efc(0x138))var _0x41856f=users['Arabic'];}}}}}}}_0x32b8d1[_0x3b7efc(0x1a7)](_0x3b7efc(0x147),{'success':_0xbf5186[_0x3b7efc(0x236)]('success'),'errors':_0xbf5186['flash'](_0x3b7efc(0x1f4)),'sales':_0x998879,'profile':_0x52d006,'role':_0x147052,'master_shop':_0x455f2d,'language':_0x41856f});}catch(_0x45611d){console[_0x3b7efc(0x227)](_0x45611d);}});function a0_0xbc56(){var _0x2ce046=['filter','max_per_unit','$customers_docs','flash','maxperunit','stock_data','currency_placement','</tbody>','customers_docs','$sale_product.type','logo','prod_code','payment\x20successfull','product_stock','$sale_product.bin','string','$product_details.expiry_date','English','$product.product_name','save','Portuguese','$product_details.primary_code','DRY\x20GOODS','warehouse_name','findById','False','</h5>','then','Arabic\x20(ae)','An\x20error\x20occurred.','toString','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','691167viDOIn','$product_details.product_code','Quality\x20Inspection','maxProducts_QA','</head><body>','product_date','$date','return_data','user','length','currency','all_sales_finished','maxProducts','../middleware/auth','purchases_data','948896wTLXdR','$product_details.product_name','<div>','sales_quantity_QA','params','adjust_qty','81100duoaSa','Sales\x20Add\x20successfully','$product_details.bay','received_amount','bay','<tbody\x20style=\x22text-align:\x20center;\x22>','Portuguese\x20(BR)','post','stock','/all_sales_finished/preview/','Return\x20Rooms','for_categorize','Sale\x20Return','warehouse','/barcode/:id','get','</body></html>','$product_details.unit','$product_details.maxPerUnit','$product_details.bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','getMonth','$product_details.type','json','sales_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','all','<h2>\x20','find','status','$product_details.floorlevel','forEach','$product_details.rack','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','image','$finalize','\x20Order\x20Date\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Received\x20Payment\x20For\x20Sale','Logo.png','date','Sale','German','split','return_sale_QA','Return\x20Goods','room_name','<hr\x20class=\x22my-3\x22>','$invoice','error','$product_details.batch_code','Sales\x20Update\x20successfully','staff','message','map','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','edit_sales_finished_view','sales_invoice','primary_code','/view/add_sales','Hindi','gmail','floor','barcode\x20Product\x20master','/view/return_sales/:id','<!DOCTYPE\x20html>','Sales\x20Mail','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$sale_product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','add_sales_finished','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','product_list','<html><head><title></title>','findOne','note','</table>','secondary_unit_QA','unit_QA','363412NwYBqY','<span\x20style=\x22float:\x20right;\x22>','$sale_product.floorlevel','</td>','production_date','English\x20(US)','_id','render','product','$return_data','random','$sale_product.quantity','$product_details','all_sales_barcode','level','name','Error\x20Occurs','<table\x20style=\x22width:\x20100%\x20!important;\x22>','return_sale_finished','getDate','/give_payment/:id','quantity','72347tUdOxp','../models/all_models','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/preview/:id','</div>','product_name_QA1','Spanish','Email\x20sent\x20successfully','An\x20error\x20occurred\x20while\x20saving\x20data.','Chinese','True','room','288zWHCxZ','back','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','Sale\x20Return\x20Mail','batch_code','2fsyOKF','Arabic','1287660MLqNQK','French','/upload/','redirect','<strong>\x20Regards\x20</strong>','maxPerUnit','649025tNVIwq','sale_product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.secondary_unit','sale_qty','return_qty_QA','Sale\x20Product\x20Mail','foreach\x20newproduct','success','aggregate','16rhMmNg','product_name','sendMail','exports','product_code','Enabled','expiry_date_QA','push','catch','Finished\x20Goods','master','QA\x20Warehouse','return_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','slice','final','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','password','/barcode_scanner','Router','<h5\x20style=\x22text-align:\x20left;\x22>','finalize','FGSEmail','$product_details.product_cat','stocks_QA','Ambient','errors','<tr>','role','secondary_code','carton','/picking_list/pdf/','$product_details.product_stock','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/view/:id','$product_details.invoice','return_sale','../public/language/languages.json','$product_details.production_date','prod_cat','$product_details.storage','unit','</thead>','padStart','concat','$product_details._id','maxPerUnit_QA','$room','body','/view','$product_details.secondary_code','language','product_code_QA','createTransport','customers','$sale_product.bay','invoice','primary_unit','$_id','</tr>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/all_sales_finished/view','secondary_code_QA','RoomAssigned','$note','</span>','prod_invoice','customer','<h5>','site_title','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','secondary_unit','expiry_date','\x20Order\x20Number\x20:\x20','production_date_QA','/view/add_sales/:id','Enclosed','log','host','/view/add_sale/product','email','edit_sales_finished','OUTF-','product_details','primary_code_QA','due_amount','\x20</h2>','$name','/../public'];a0_0xbc56=function(){return _0x2ce046;};return a0_0xbc56();}async function getRandom8DigitNumber(){var _0x11d494=a0_0x5b567a;const _0x4706c8=0x989680,_0x4a3828=0x5f5e0ff,_0x2d7559=Math[_0x11d494(0x18f)](Math[_0x11d494(0x1aa)]()*(_0x4a3828-_0x4706c8+0x1))+_0x4706c8;var _0x3274fe;const _0x4089a8=await sales_finished['findOne']({'invoice':_0x11d494(0x22c)+_0x2d7559});return _0x4089a8&&_0x4089a8[_0x11d494(0x145)]>0x0?_0x3274fe=_0x11d494(0x22c)+_0x2d7559:_0x3274fe='OUTF-'+_0x2d7559,_0x3274fe;}router[a0_0x5b567a(0x160)](a0_0x5b567a(0x18c),auth,async(_0x44d4bc,_0x5109bd)=>{var _0x303f61=a0_0x5b567a;try{const {username:_0x545568,email:_0x36cb0b,role:_0x391de9}=_0x44d4bc[_0x303f61(0x144)],_0x5cd89a=_0x44d4bc[_0x303f61(0x144)],_0x11faf0=await profile['findOne']({'email':_0x5cd89a[_0x303f61(0x22a)]}),_0x5b9c9b=await master_shop[_0x303f61(0x16d)](),_0x4371fb=await customer['find']({});let _0x355f6c;if(_0x5cd89a[_0x303f61(0x1f6)]==_0x303f61(0x185)){const _0x4fc3ea=await staff[_0x303f61(0x19b)]({'email':_0x5cd89a[_0x303f61(0x22a)]});_0x355f6c=await warehouse[_0x303f61(0x1d8)]([{'$match':{'status':_0x303f61(0x1de),'name':_0x4fc3ea[_0x303f61(0x15e)],'warehouse_category':_0x303f61(0x1e2),'name':{'$ne':_0x303f61(0x1e4)}}},{'$group':{'_id':_0x303f61(0x231),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x355f6c=await warehouse[_0x303f61(0x1d8)]([{'$match':{'status':_0x303f61(0x1de),'warehouse_category':_0x303f61(0x1e2),'name':{'$ne':_0x303f61(0x1e4)}}},{'$group':{'_id':_0x303f61(0x231),'name':{'$first':_0x303f61(0x231)}}},{'$sort':{'name':0x1}}]);const _0x41027a=await product[_0x303f61(0x16d)]({});var _0x1c6008=[_0x303f61(0x1f3),_0x303f61(0x226)];const _0x88af11=await sales_finished[_0x303f61(0x16d)]({}),_0x42e0e3=_0x88af11[_0x303f61(0x145)]+0x1,_0x4470a3=_0x303f61(0x22c)+_0x42e0e3[_0x303f61(0x13a)]()[_0x303f61(0x205)](0x5,'0');if(_0x5b9c9b[0x0]['language']==_0x303f61(0x1a5)){var _0xb6f438=users[_0x303f61(0x244)];console['log'](_0xb6f438);}else{if(_0x5b9c9b[0x0][_0x303f61(0x20d)]==_0x303f61(0x18d))var _0xb6f438=users[_0x303f61(0x18d)];else{if(_0x5b9c9b[0x0][_0x303f61(0x20d)]==_0x303f61(0x17b))var _0xb6f438=users[_0x303f61(0x17b)];else{if(_0x5b9c9b[0x0][_0x303f61(0x20d)]==_0x303f61(0x1bc))var _0xb6f438=users[_0x303f61(0x1bc)];else{if(_0x5b9c9b[0x0]['language']==_0x303f61(0x1ca))var _0xb6f438=users[_0x303f61(0x1ca)];else{if(_0x5b9c9b[0x0]['language']==_0x303f61(0x157))var _0xb6f438=users['Portuguese'];else{if(_0x5b9c9b[0x0]['language']==_0x303f61(0x1bf))var _0xb6f438=users[_0x303f61(0x1bf)];else{if(_0x5b9c9b[0x0]['language']==_0x303f61(0x138))var _0xb6f438=users['Arabic'];}}}}}}}const _0x3905be=getRandom8DigitNumber();_0x3905be[_0x303f61(0x137)](_0x4d3947=>{var _0xd9a678=_0x303f61;_0x5109bd[_0xd9a678(0x1a7)](_0xd9a678(0x197),{'success':_0x44d4bc[_0xd9a678(0x236)]('success'),'errors':_0x44d4bc['flash']('errors'),'role':_0x5cd89a,'profile':_0x11faf0,'customer':_0x4371fb,'warehouse':_0x355f6c,'product':_0x41027a,'invoice':_0x4d3947,'master_shop':_0x5b9c9b,'language':_0xb6f438,'rooms_data':_0x1c6008});})[_0x303f61(0x1e1)](_0x4fcb2e=>{var _0x4037e5=_0x303f61;_0x44d4bc[_0x4037e5(0x236)](_0x4037e5(0x1f4),_0x4037e5(0x216)),_0x5109bd['redirect'](_0x4037e5(0x217));});}catch(_0x551d19){console[_0x303f61(0x227)](_0x551d19);}}),router[a0_0x5b567a(0x160)](a0_0x5b567a(0x225),auth,async(_0x860647,_0x4c6031)=>{var _0x290856=a0_0x5b567a;try{const _0x45201b=_0x860647['params']['id'];console[_0x290856(0x227)](_0x45201b);const _0x4cd218=await product['find'](),_0x4d2a23=await purchases[_0x290856(0x1d8)]([{'$match':{'warehouse_name':_0x45201b}},{'$unwind':'$product'},{'$group':{'_id':_0x290856(0x245)}}]);console['log'](_0x290856(0x14a),_0x4d2a23),_0x4c6031[_0x290856(0x16e)](0xc8)[_0x290856(0x168)]({'purchases_data':_0x4d2a23,'product_data':_0x4cd218});}catch(_0x449afa){console[_0x290856(0x227)](_0x449afa);}}),router[a0_0x5b567a(0x158)](a0_0x5b567a(0x229),auth,async(_0x14577d,_0x345b90)=>{var _0x3eec2b=a0_0x5b567a;try{const {warehouse_data:_0x98ba13,product_data:_0x1598e1}=_0x14577d[_0x3eec2b(0x20a)];console[_0x3eec2b(0x227)](_0x14577d['body']['product_data']);;const _0x47f276=await master_shop[_0x3eec2b(0x16d)]();console[_0x3eec2b(0x227)](_0x3eec2b(0x1e3),_0x47f276);const _0x268999=await product[_0x3eec2b(0x19b)]({'name':_0x1598e1});console[_0x3eec2b(0x227)](_0x3eec2b(0x1a8),_0x268999);const _0x18b86c=await warehouse[_0x3eec2b(0x1d8)]([{'$match':{'name':_0x98ba13}},{'$unwind':_0x3eec2b(0x1ac)},{'$match':{'product_details.product_name':_0x1598e1}},{'$group':{'_id':_0x3eec2b(0x14c),'product_stock':{'$first':_0x3eec2b(0x1fa)}}}]);console['log'](_0x3eec2b(0x238),_0x18b86c),_0x345b90[_0x3eec2b(0x16e)](0xc8)[_0x3eec2b(0x168)]({'master':_0x47f276,'new_product':_0x268999,'stock_data':_0x18b86c});}catch(_0x297f20){console['log'](_0x297f20);}}),router[a0_0x5b567a(0x158)](a0_0x5b567a(0x18c),auth,async(_0x5ed139,_0x7d82f4)=>{var _0x211d1d=a0_0x5b567a;try{const {invoice:_0x50f1a3,date:_0x33312d,warehouse_name:_0x10c28e,product_name:_0x1bbc1e,stock:_0x1cbd0c,quantity:_0x1c5cc9,note:_0x585f13,room:_0x54bde7,primary_code:_0x424865,secondary_code:_0x396988,prod_code:_0x2f639c,level:_0x1f45c0,isle:_0x14853c,pallet:_0x2bab78,batch_code:_0x53257e,SCRN:_0x2a8d84,expiry_date:_0x51767e,mode_transpo:_0x1460f0,name_driver:_0x4a7e0a}=_0x5ed139[_0x211d1d(0x20a)];if(typeof _0x1bbc1e=='string')var _0x58adc4=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x1da)]],_0x472eb3=[_0x5ed139['body'][_0x211d1d(0x159)]],_0x5aed3e=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x1f8)]],_0x578afd=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x18b)]],_0x11f1dc=[_0x5ed139['body'][_0x211d1d(0x1f7)]],_0x398bd2=[_0x5ed139['body'][_0x211d1d(0x23e)]],_0x28c7be=[_0x5ed139['body'][_0x211d1d(0x1ae)]],_0x573c4b=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x213)]],_0xa9d0aa=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x221)]],_0x4f433d=[_0x5ed139[_0x211d1d(0x20a)]['batch_code']],_0x10b5b2=[_0x5ed139['body'][_0x211d1d(0x222)]],_0x494ff5=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x141)]],_0x8dac7f=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x234)]],_0x1c2272=[_0x5ed139['body'][_0x211d1d(0x201)]],_0xe43dfc=[_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x219)]],_0x450ea8=[_0x5ed139['body'][_0x211d1d(0x21c)]];else var _0x58adc4=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x1da)]],_0x472eb3=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x159)]],_0x5aed3e=[..._0x5ed139['body']['carton']],_0x578afd=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x18b)]],_0x11f1dc=[..._0x5ed139['body'][_0x211d1d(0x1f7)]],_0x398bd2=[..._0x5ed139['body'][_0x211d1d(0x23e)]],_0x28c7be=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x1ae)]],_0x573c4b=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x213)]],_0xa9d0aa=[..._0x5ed139['body'][_0x211d1d(0x221)]],_0x4f433d=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x1c6)]],_0x10b5b2=[..._0x5ed139['body'][_0x211d1d(0x222)]],_0x494ff5=[..._0x5ed139[_0x211d1d(0x20a)]['product_date']],_0x8dac7f=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x234)]],_0x1c2272=[..._0x5ed139[_0x211d1d(0x20a)]['prod_cat']],_0xe43dfc=[..._0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x219)]],_0x450ea8=[..._0x5ed139['body'][_0x211d1d(0x21c)]];const _0x5425c2=_0x58adc4[_0x211d1d(0x187)](_0x4c38c=>{return _0x4c38c={'product_name':_0x4c38c};});_0x472eb3[_0x211d1d(0x170)]((_0xccfe84,_0x15dbee)=>{var _0x34914f=_0x211d1d;_0x5425c2[_0x15dbee][_0x34914f(0x159)]=_0xccfe84;}),_0x5aed3e[_0x211d1d(0x170)]((_0x27a421,_0x1d4e0c)=>{var _0x4654db=_0x211d1d;_0x5425c2[_0x1d4e0c][_0x4654db(0x1b5)]=_0x27a421;}),_0x578afd[_0x211d1d(0x170)]((_0x52aa0e,_0x3660ad)=>{_0x5425c2[_0x3660ad]['primary_code']=_0x52aa0e;}),_0x11f1dc[_0x211d1d(0x170)]((_0xcbd85b,_0x2670aa)=>{var _0xe2967d=_0x211d1d;_0x5425c2[_0x2670aa][_0xe2967d(0x1f7)]=_0xcbd85b;}),_0x398bd2[_0x211d1d(0x170)]((_0x2837e7,_0x894d56)=>{_0x5425c2[_0x894d56]['product_code']=_0x2837e7;}),_0x28c7be['forEach']((_0x2de987,_0x72eb00)=>{_0x5425c2[_0x72eb00]['bay']=_0x2de987;}),_0x573c4b[_0x211d1d(0x170)]((_0x16591f,_0x1363d6)=>{_0x5425c2[_0x1363d6]['unit']=_0x16591f;}),_0xa9d0aa[_0x211d1d(0x170)]((_0x52ed6d,_0x48e94d)=>{var _0x400211=_0x211d1d;_0x5425c2[_0x48e94d][_0x400211(0x221)]=_0x52ed6d;}),_0x4f433d[_0x211d1d(0x170)]((_0x2874f2,_0x2c62aa)=>{_0x5425c2[_0x2c62aa]['batch_code']=_0x2874f2;}),_0x10b5b2[_0x211d1d(0x170)]((_0xa32cf6,_0x565486)=>{var _0x1f5c60=_0x211d1d;_0x5425c2[_0x565486][_0x1f5c60(0x222)]=_0xa32cf6;}),_0x494ff5['forEach']((_0x47ee89,_0x3285a9)=>{var _0x50686d=_0x211d1d;_0x5425c2[_0x3285a9][_0x50686d(0x1a4)]=_0x47ee89;}),_0x8dac7f[_0x211d1d(0x170)]((_0x5503ba,_0x328df4)=>{var _0x24362d=_0x211d1d;_0x5425c2[_0x328df4][_0x24362d(0x237)]=_0x5503ba;}),_0x1c2272[_0x211d1d(0x170)]((_0x2bb2b3,_0x1b258c)=>{_0x5425c2[_0x1b258c]['prod_cat']=_0x2bb2b3;}),_0xe43dfc[_0x211d1d(0x170)]((_0x416d26,_0x3635ee)=>{var _0x28b55b=_0x211d1d;_0x5425c2[_0x3635ee][_0x28b55b(0x17f)]=_0x416d26;}),_0x450ea8[_0x211d1d(0x170)]((_0x949a2f,_0x246406)=>{var _0x5be2c8=_0x211d1d;_0x5425c2[_0x246406][_0x5be2c8(0x212)]=_0x949a2f;});var _0x3367a5=0x0;_0x5425c2[_0x211d1d(0x170)](_0xfc530a=>{var _0x48cfef=_0x211d1d;console[_0x48cfef(0x227)](_0x48cfef(0x1d6),_0xfc530a),(parseInt(_0xfc530a[_0x48cfef(0x159)])<parseInt(_0xfc530a[_0x48cfef(0x1b5)])||parseInt(_0xfc530a[_0x48cfef(0x1b5)])==0x0)&&_0x3367a5++;});if(_0x3367a5!=0x0)return _0x5ed139[_0x211d1d(0x236)](_0x211d1d(0x1f4),_0x211d1d(0x1fb)),_0x7d82f4[_0x211d1d(0x1cc)](_0x211d1d(0x1c3));const _0x3d8e02=_0x5425c2[_0x211d1d(0x233)](_0x4fe474=>_0x4fe474[_0x211d1d(0x1b5)]!=='0'&&_0x4fe474[_0x211d1d(0x1b5)]!==''),_0x380d54=new sales_finished({'invoice':_0x50f1a3,'customer':_0x5ed139[_0x211d1d(0x20a)]['customer'],'date':_0x33312d,'warehouse_name':_0x10c28e,'sale_product':_0x3d8e02,'note':_0x585f13,'room':_0x54bde7,'primary_code':_0x424865,'secondary_code':_0x396988,'prod_code':_0x2f639c,'SCRN':_0x2a8d84,'finalize':_0x211d1d(0x135),'mode_transpo':_0x1460f0,'name_driver':_0x4a7e0a}),_0x1131ce=await _0x380d54[_0x211d1d(0x246)](),_0xe8a8d7=await sales_finished[_0x211d1d(0x19b)]({'invoice':_0x50f1a3}),_0x376766=new c_payment_data({'invoice':_0x50f1a3,'customer':_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x21d)],'reason':_0x211d1d(0x17a)});await _0x376766[_0x211d1d(0x246)]();const _0x4b6e52=await master_shop['find'](),_0x1f9670=await email_settings[_0x211d1d(0x19b)](),_0x4c813c=await customer[_0x211d1d(0x19b)]({'name':_0x5ed139[_0x211d1d(0x20a)][_0x211d1d(0x21d)]});_0x4b6e52[0x0][_0x211d1d(0x239)]==0x1?(right_currency=_0x4b6e52[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x4b6e52[0x0][_0x211d1d(0x146)]);var _0x49d7c4=_0x58adc4,_0x3d0bab=_0x5aed3e,_0x25ba4c='',_0x4775dc;for(_0x4775dc in _0x49d7c4){_0x25ba4c+='<tr>'+_0x211d1d(0x220)+_0x49d7c4[_0x4775dc]+_0x211d1d(0x1a3)+_0x211d1d(0x220)+_0x3d0bab[_0x4775dc]+_0x211d1d(0x1a3)+_0x211d1d(0x215);}console[_0x211d1d(0x227)](_0x211d1d(0x199),_0x25ba4c);let _0x5e832e=nodemailer['createTransport']({'service':_0x211d1d(0x18e),'auth':{'user':_0x1f9670['email'],'pass':_0x1f9670[_0x211d1d(0x1eb)]}}),_0x16f5d0={'from':_0x1f9670['email'],'to':_0x4c813c['email'],'subject':_0x211d1d(0x1d5),'attachments':[{'filename':_0x211d1d(0x178),'path':__dirname+_0x211d1d(0x232)+_0x211d1d(0x1cb)+_0x4b6e52[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x211d1d(0x19a)+'</head><body>'+_0x211d1d(0x14d)+_0x211d1d(0x194)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x211d1d(0x1ba)+'<div>'+_0x211d1d(0x16c)+_0x4b6e52[0x0][_0x211d1d(0x21f)]+_0x211d1d(0x230)+_0x211d1d(0x1ba)+_0x211d1d(0x1ba)+_0x211d1d(0x180)+_0x211d1d(0x14d)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x211d1d(0x223)+_0x50f1a3+'\x20'+_0x211d1d(0x1a1)+_0x211d1d(0x175)+_0x33312d+'\x20'+_0x211d1d(0x21b)+_0x211d1d(0x136)+_0x211d1d(0x1ba)+_0x211d1d(0x1b1)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x211d1d(0x1f5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x211d1d(0x198)+_0x211d1d(0x215)+_0x211d1d(0x204)+_0x211d1d(0x156)+'\x20'+_0x25ba4c+'\x20'+_0x211d1d(0x23a)+'</table>'+_0x211d1d(0x14d)+_0x211d1d(0x1cd)+_0x211d1d(0x21e)+_0x4b6e52[0x0][_0x211d1d(0x21f)]+_0x211d1d(0x136)+_0x211d1d(0x1ba)+_0x211d1d(0x1ba)+'</body></html>'};_0x5e832e[_0x211d1d(0x1db)](_0x16f5d0,function(_0x4b33cf,_0x2ebe83){var _0x2a5f86=_0x211d1d;_0x4b33cf?(console[_0x2a5f86(0x227)](_0x4b33cf),console[_0x2a5f86(0x227)]('Error\x20Occurs')):console[_0x2a5f86(0x227)](_0x2a5f86(0x1bd));}),_0x5ed139[_0x211d1d(0x236)](_0x211d1d(0x1d7),_0x211d1d(0x152)),_0x7d82f4['redirect'](_0x211d1d(0x15a)+_0x1131ce[_0x211d1d(0x1a6)]);}catch(_0x42d7e3){console[_0x211d1d(0x227)](_0x42d7e3);}}),router['get'](a0_0x5b567a(0x1b9),auth,async(_0x1d9db6,_0x5aed63)=>{var _0x23a6d3=a0_0x5b567a;try{const {username:_0x31c24c,email:_0x1ea332,role:_0x3f9476}=_0x1d9db6[_0x23a6d3(0x144)],_0x371321=_0x1d9db6[_0x23a6d3(0x144)],_0x2b3e5d=await profile[_0x23a6d3(0x19b)]({'email':_0x371321[_0x23a6d3(0x22a)]}),_0x49d263=await master_shop['find'](),_0x1eb3bc=_0x1d9db6[_0x23a6d3(0x14f)]['id'],_0x1f5a4e=await sales_finished[_0x23a6d3(0x134)](_0x1eb3bc),_0x467587=await warehouse[_0x23a6d3(0x1d8)]([{'$match':{'name':_0x1f5a4e[_0x23a6d3(0x24a)]}},{'$unwind':_0x23a6d3(0x1ac)},{'$group':{'_id':_0x23a6d3(0x207),'name':{'$first':_0x23a6d3(0x14c)},'product_stock':{'$first':_0x23a6d3(0x1fa)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x23a6d3(0x164)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x23a6d3(0x16f)},'primary_code':{'$first':_0x23a6d3(0x248)},'secondary_code':{'$first':_0x23a6d3(0x20c)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x23a6d3(0x202)},'rack':{'$first':_0x23a6d3(0x171)},'expiry_date':{'$first':_0x23a6d3(0x243)},'production_date':{'$first':_0x23a6d3(0x200)},'batch_code':{'$first':_0x23a6d3(0x183)},'room':{'$first':_0x23a6d3(0x209)}}}]),_0x577eff=await customer['find']({});let _0x29db42;if(_0x371321[_0x23a6d3(0x1f6)]=='staff'){const _0x4a918a=await staff[_0x23a6d3(0x19b)]({'email':_0x371321[_0x23a6d3(0x22a)]});_0x29db42=await warehouse[_0x23a6d3(0x1d8)]([{'$match':{'status':_0x23a6d3(0x1de),'name':_0x4a918a[_0x23a6d3(0x15e)]}},{'$group':{'_id':_0x23a6d3(0x231),'name':{'$first':_0x23a6d3(0x231)}}}]);}else _0x29db42=await warehouse[_0x23a6d3(0x1d8)]([{'$match':{'status':_0x23a6d3(0x1de)}},{'$group':{'_id':'$name','name':{'$first':_0x23a6d3(0x231)}}}]);const _0x17c010=await product[_0x23a6d3(0x16d)]({});if(_0x49d263[0x0][_0x23a6d3(0x20d)]=='English\x20(US)'){var _0x4452f7=users['English'];console[_0x23a6d3(0x227)](_0x4452f7);}else{if(_0x49d263[0x0][_0x23a6d3(0x20d)]==_0x23a6d3(0x18d))var _0x4452f7=users['Hindi'];else{if(_0x49d263[0x0][_0x23a6d3(0x20d)]==_0x23a6d3(0x17b))var _0x4452f7=users[_0x23a6d3(0x17b)];else{if(_0x49d263[0x0][_0x23a6d3(0x20d)]=='Spanish')var _0x4452f7=users[_0x23a6d3(0x1bc)];else{if(_0x49d263[0x0][_0x23a6d3(0x20d)]==_0x23a6d3(0x1ca))var _0x4452f7=users[_0x23a6d3(0x1ca)];else{if(_0x49d263[0x0][_0x23a6d3(0x20d)]==_0x23a6d3(0x157))var _0x4452f7=users[_0x23a6d3(0x247)];else{if(_0x49d263[0x0][_0x23a6d3(0x20d)]=='Chinese')var _0x4452f7=users[_0x23a6d3(0x1bf)];else{if(_0x49d263[0x0]['language']==_0x23a6d3(0x138))var _0x4452f7=users[_0x23a6d3(0x1c8)];}}}}}}}_0x5aed63[_0x23a6d3(0x1a7)](_0x23a6d3(0x189),{'success':_0x1d9db6[_0x23a6d3(0x236)]('success'),'errors':_0x1d9db6[_0x23a6d3(0x236)]('errors'),'role':_0x371321,'profile':_0x2b3e5d,'customer':_0x577eff,'warehouse':_0x29db42,'product':_0x467587,'user':_0x1f5a4e,'master_shop':_0x49d263,'unit':_0x17c010,'language':_0x4452f7});}catch(_0x62e68b){console[_0x23a6d3(0x227)](_0x62e68b);}}),router[a0_0x5b567a(0x158)](a0_0x5b567a(0x1b9),auth,async(_0x3a62b4,_0x375018)=>{var _0x1b46fa=a0_0x5b567a;try{const _0x11501a=_0x3a62b4[_0x1b46fa(0x14f)]['id'],{invoice:_0xcee04c,warehouse_name:_0x247471,room:_0x556999}=_0x3a62b4[_0x1b46fa(0x20a)],_0x4a2fb1=await sales_finished[_0x1b46fa(0x19b)]({'invoice':_0xcee04c}),_0xf1ffff=_0x4a2fb1[_0x1b46fa(0x1d0)][_0x1b46fa(0x187)](async _0x59a7cc=>{var _0x24a8a2=_0x1b46fa,_0x2456a5=await warehouse[_0x24a8a2(0x19b)]({'name':_0x247471,'room':_0x59a7cc[_0x24a8a2(0x17f)],'warehouse_category':_0x24a8a2(0x1e2)});const _0x810342=_0x2456a5[_0x24a8a2(0x22d)][_0x24a8a2(0x187)](_0x1f1d46=>{var _0x2642c6=_0x24a8a2;_0x1f1d46[_0x2642c6(0x1da)]==_0x59a7cc[_0x2642c6(0x1da)]&&_0x1f1d46[_0x2642c6(0x155)]==_0x59a7cc[_0x2642c6(0x155)]&&_0x1f1d46[_0x2642c6(0x222)]==_0x59a7cc[_0x2642c6(0x222)]&&_0x1f1d46[_0x2642c6(0x1a4)]==_0x59a7cc[_0x2642c6(0x1a4)]&&_0x1f1d46[_0x2642c6(0x1c6)]==_0x59a7cc[_0x2642c6(0x1c6)]&&_0x1f1d46['invoice']==_0x59a7cc[_0x2642c6(0x212)]&&(_0x1f1d46[_0x2642c6(0x240)]=_0x1f1d46['product_stock']-_0x59a7cc['quantity']);});return _0x2456a5;});Promise[_0x1b46fa(0x16b)](_0xf1ffff)[_0x1b46fa(0x137)](async _0x38833b=>{var _0x205ac4=_0x1b46fa;try{for(const _0x384044 of _0x38833b){await _0x384044[_0x205ac4(0x246)]();}_0x4a2fb1[_0x205ac4(0x1ef)]=_0x205ac4(0x1c0);const _0x523a8f=await _0x4a2fb1[_0x205ac4(0x246)](),_0x5b8019=await master_shop[_0x205ac4(0x16d)](),_0x32d50f=await email_settings[_0x205ac4(0x19b)](),_0x258ed4=await supervisor_settings['find']();var _0x1a0ec6=_0x4a2fb1[_0x205ac4(0x1d0)],_0x29d6b3='',_0x117a4d;for(_0x117a4d in _0x1a0ec6){var _0x1521bf='FG';_0x4a2fb1[_0x205ac4(0x24a)]==_0x205ac4(0x249)&&(_0x1521bf='DG'),_0x29d6b3+=_0x205ac4(0x1f5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a0ec6[_0x117a4d]['product_name']+'</td>'+_0x205ac4(0x220)+_0x1a0ec6[_0x117a4d][_0x205ac4(0x1dd)]+'</td>'+_0x205ac4(0x220)+_0x1a0ec6[_0x117a4d][_0x205ac4(0x1b5)]+_0x205ac4(0x1a3)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1a0ec6[_0x117a4d][_0x205ac4(0x203)]+_0x205ac4(0x1a3)+_0x205ac4(0x220)+_0x1a0ec6[_0x117a4d][_0x205ac4(0x221)]+'</td>'+_0x205ac4(0x220)+_0x4a2fb1[_0x205ac4(0x24a)]+_0x205ac4(0x1a3)+_0x205ac4(0x220)+_0x1a0ec6[_0x117a4d]['room_name']+'</td>'+_0x205ac4(0x220)+_0x1521bf+_0x1a0ec6[_0x117a4d][_0x205ac4(0x155)]+_0x205ac4(0x1a3);}let _0x117f29=nodemailer[_0x205ac4(0x20f)]({'host':_0x32d50f[_0x205ac4(0x228)],'port':Number(_0x32d50f['port']),'secure':![],'auth':{'user':_0x32d50f[_0x205ac4(0x22a)],'pass':_0x32d50f[_0x205ac4(0x1eb)]}}),_0x2609bb={'from':_0x32d50f['email'],'to':_0x258ed4[0x0][_0x205ac4(0x1f0)],'subject':_0x205ac4(0x193),'attachments':[{'filename':_0x205ac4(0x178),'path':__dirname+'/../public'+_0x205ac4(0x1cb)+_0x5b8019[0x0]['image'],'cid':_0x205ac4(0x23d)}],'html':_0x205ac4(0x192)+'<html><head><title></title>'+_0x205ac4(0x140)+'<div>'+_0x205ac4(0x194)+'<div>'+_0x205ac4(0x172)+_0x205ac4(0x1ba)+_0x205ac4(0x14d)+_0x205ac4(0x16c)+_0x5b8019[0x0][_0x205ac4(0x21f)]+'\x20</h2>'+_0x205ac4(0x1ba)+_0x205ac4(0x1ba)+_0x205ac4(0x180)+_0x205ac4(0x14d)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x205ac4(0x223)+_0x4a2fb1[_0x205ac4(0x212)]+'\x20'+_0x205ac4(0x1a1)+'\x20Order\x20Date\x20:\x20'+_0x4a2fb1[_0x205ac4(0x179)]+'\x20'+'</span>'+_0x205ac4(0x136)+_0x205ac4(0x1ba)+_0x205ac4(0x1b1)+_0x205ac4(0x1b8)+_0x205ac4(0x1f5)+_0x205ac4(0x1ea)+_0x205ac4(0x176)+_0x205ac4(0x165)+_0x205ac4(0x16a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x205ac4(0x196)+_0x205ac4(0x1d1)+_0x205ac4(0x1e7)+_0x205ac4(0x215)+_0x205ac4(0x204)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x29d6b3+'\x20'+'</tbody>'+'</table>'+_0x205ac4(0x14d)+_0x205ac4(0x1cd)+_0x205ac4(0x21e)+_0x5b8019[0x0]['site_title']+_0x205ac4(0x136)+_0x205ac4(0x1ba)+_0x205ac4(0x1ba)+'</body></html>'};_0x117f29['sendMail'](_0x2609bb,function(_0x2db0fd,_0x19ff0c){var _0x316217=_0x205ac4;_0x2db0fd?(console[_0x316217(0x227)](_0x2db0fd),console[_0x316217(0x227)](_0x316217(0x1b0))):console[_0x316217(0x227)]('Email\x20sent\x20successfully');}),_0x3a62b4['flash']('success',_0x205ac4(0x184)),_0x375018[_0x205ac4(0x1cc)](_0x205ac4(0x1f9)+_0x11501a);}catch(_0x42d994){console[_0x205ac4(0x182)](_0x42d994),_0x375018[_0x205ac4(0x16e)](0x1f4)[_0x205ac4(0x168)]({'error':_0x205ac4(0x1be)});}})[_0x1b46fa(0x1e1)](_0x3bcbf6=>{var _0xaf27a=_0x1b46fa;console['error'](_0x3bcbf6),_0x375018['status'](0x1f4)[_0xaf27a(0x168)]({'error':_0xaf27a(0x139)});});}catch(_0x23b6a6){console['log'](_0x23b6a6);}}),router[a0_0x5b567a(0x160)](a0_0x5b567a(0x1fc),auth,async(_0x3230f0,_0x56e1f5)=>{var _0x313705=a0_0x5b567a;try{const {username:_0x25d504,email:_0x217795,role:_0x6ded5c}=_0x3230f0['user'],_0xe04c8f=_0x3230f0['user'],_0x4c3a16=await profile[_0x313705(0x19b)]({'email':_0xe04c8f[_0x313705(0x22a)]}),_0x147284=await master_shop['find'](),_0x109d9d=_0x3230f0[_0x313705(0x14f)]['id'],_0x6bb951=await sales_finished['findById'](_0x109d9d);let _0x44a02d=new Date(_0x6bb951[_0x313705(0x222)]),_0x592ce5=('0'+_0x44a02d[_0x313705(0x1b3)]())[_0x313705(0x1e8)](-0x2),_0x271e64=('0'+(_0x44a02d[_0x313705(0x166)]()+0x1))[_0x313705(0x1e8)](-0x2),_0xe21c7=_0x44a02d['getFullYear'](),_0x5af5b0=_0xe21c7+'-'+_0x271e64+'-'+_0x592ce5;var _0x4f3532=[_0x313705(0x1f3),_0x313705(0x226)];const _0x5d2f7f=await warehouse[_0x313705(0x1d8)]([{'$match':{'name':_0x6bb951[_0x313705(0x24a)],'room':_0x6bb951[_0x313705(0x1c1)]}},{'$unwind':_0x313705(0x1ac)},{'$group':{'_id':_0x313705(0x207),'name':{'$first':_0x313705(0x14c)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x313705(0x153)},'bin':{'$first':_0x313705(0x164)},'type':{'$first':_0x313705(0x167)},'floorlevel':{'$first':_0x313705(0x16f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x313705(0x20c)},'product_code':{'$first':_0x313705(0x13d)},'storage':{'$first':_0x313705(0x202)},'rack':{'$first':_0x313705(0x171)}}}]),_0x12a711=await customer[_0x313705(0x16d)]({});let _0x3edc53;if(_0xe04c8f['role']==_0x313705(0x185)){const _0x54d714=await staff[_0x313705(0x19b)]({'email':_0xe04c8f[_0x313705(0x22a)]});_0x3edc53=await warehouse[_0x313705(0x1d8)]([{'$match':{'status':_0x313705(0x1de),'name':_0x54d714[_0x313705(0x15e)]}},{'$group':{'_id':_0x313705(0x231),'name':{'$first':_0x313705(0x231)}}}]);}else _0x3edc53=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x313705(0x231),'name':{'$first':_0x313705(0x231)}}}]);const _0x1167c6=await product[_0x313705(0x16d)]({});if(_0x147284[0x0]['language']==_0x313705(0x1a5)){var _0x5197be=users[_0x313705(0x244)];console[_0x313705(0x227)](_0x5197be);}else{if(_0x147284[0x0][_0x313705(0x20d)]==_0x313705(0x18d))var _0x5197be=users[_0x313705(0x18d)];else{if(_0x147284[0x0][_0x313705(0x20d)]==_0x313705(0x17b))var _0x5197be=users['German'];else{if(_0x147284[0x0][_0x313705(0x20d)]==_0x313705(0x1bc))var _0x5197be=users[_0x313705(0x1bc)];else{if(_0x147284[0x0][_0x313705(0x20d)]=='French')var _0x5197be=users['French'];else{if(_0x147284[0x0]['language']=='Portuguese\x20(BR)')var _0x5197be=users[_0x313705(0x247)];else{if(_0x147284[0x0]['language']==_0x313705(0x1bf))var _0x5197be=users[_0x313705(0x1bf)];else{if(_0x147284[0x0]['language']=='Arabic\x20(ae)')var _0x5197be=users[_0x313705(0x1c8)];}}}}}}}_0x56e1f5[_0x313705(0x1a7)](_0x313705(0x22b),{'success':_0x3230f0[_0x313705(0x236)](_0x313705(0x1d7)),'errors':_0x3230f0['flash'](_0x313705(0x1f4)),'role':_0xe04c8f,'profile':_0x4c3a16,'customer':_0x12a711,'warehouse':_0x3edc53,'product':_0x5d2f7f,'user':_0x6bb951,'master_shop':_0x147284,'unit':_0x1167c6,'language':_0x5197be,'rooms_data':_0x4f3532,'ed_fullDate':_0x5af5b0});}catch(_0x5f3e76){console[_0x313705(0x227)](_0x5f3e76);}}),router['post'](a0_0x5b567a(0x1fc),auth,async(_0x154c5b,_0x1036d0)=>{var _0x37572f=a0_0x5b567a;try{const _0xa5e810=_0x154c5b[_0x37572f(0x14f)]['id'],_0x30f578=await sales_finished[_0x37572f(0x19b)]({'_id':_0x154c5b[_0x37572f(0x14f)]['id']}),_0x2cf6c8=await warehouse[_0x37572f(0x19b)]({'name':_0x30f578[_0x37572f(0x24a)],'room':_0x154c5b[_0x37572f(0x20a)]['room'],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x1c2d13,customer:_0xe08375,date:_0x3be0c,warehouse_name:_0x297214,product_name:_0x17dd29,stock:_0x44a7b9,adjust_qty:_0x9c4a03,note:_0x2413c9,room:_0x2031fc,primary_code:_0x2e5aeb,secondary_code:_0x366e08,prod_code:_0x1b405a,level:_0x303e5d,isle:_0x9e6394,pallet:_0x2e8e45,expiry_date:_0xa7a19d}=_0x154c5b[_0x37572f(0x20a)];if(typeof _0x17dd29==_0x37572f(0x242))var _0x571da0=[_0x154c5b[_0x37572f(0x20a)][_0x37572f(0x1da)]],_0x35f142=[_0x154c5b[_0x37572f(0x20a)][_0x37572f(0x159)]],_0x5406fd=[_0x154c5b[_0x37572f(0x20a)][_0x37572f(0x150)]],_0x17d2d6=[_0x154c5b[_0x37572f(0x20a)][_0x37572f(0x18b)]],_0xfa2ba7=[_0x154c5b['body'][_0x37572f(0x1f7)]],_0xb53bc0=[_0x154c5b[_0x37572f(0x20a)]['prod_code']],_0x23df26=[_0x154c5b[_0x37572f(0x20a)][_0x37572f(0x1ae)]],_0x3e2d13=[_0x154c5b['body'][_0x37572f(0x222)]];else var _0x571da0=[..._0x154c5b[_0x37572f(0x20a)]['product_name']],_0x35f142=[..._0x154c5b[_0x37572f(0x20a)]['stock']],_0x5406fd=[..._0x154c5b['body']['adjust_qty']],_0x17d2d6=[..._0x154c5b[_0x37572f(0x20a)][_0x37572f(0x18b)]],_0xfa2ba7=[..._0x154c5b[_0x37572f(0x20a)][_0x37572f(0x1f7)]],_0xb53bc0=[..._0x154c5b[_0x37572f(0x20a)][_0x37572f(0x23e)]],_0x23df26=[..._0x154c5b[_0x37572f(0x20a)]['level']],_0x3e2d13=[..._0x154c5b[_0x37572f(0x20a)][_0x37572f(0x222)]];const _0x4a18cb=_0x571da0[_0x37572f(0x187)](_0x29185f=>{return _0x29185f={'product_name':_0x29185f};});_0x35f142[_0x37572f(0x170)]((_0x223315,_0x470298)=>{var _0x477b0c=_0x37572f;_0x4a18cb[_0x470298][_0x477b0c(0x159)]=_0x223315;}),_0x5406fd[_0x37572f(0x170)]((_0x30b029,_0x3f9257)=>{_0x4a18cb[_0x3f9257]['quantity']=_0x30b029;}),_0x17d2d6[_0x37572f(0x170)]((_0x264836,_0x3c5f2c)=>{var _0x9f9055=_0x37572f;_0x4a18cb[_0x3c5f2c][_0x9f9055(0x18b)]=_0x264836;}),_0xfa2ba7[_0x37572f(0x170)]((_0x2bed16,_0x355dff)=>{var _0xebd91d=_0x37572f;_0x4a18cb[_0x355dff][_0xebd91d(0x1f7)]=_0x2bed16;}),_0xb53bc0[_0x37572f(0x170)]((_0x13ebd3,_0x9cf918)=>{var _0x16ea78=_0x37572f;_0x4a18cb[_0x9cf918][_0x16ea78(0x1dd)]=_0x13ebd3;}),_0x23df26[_0x37572f(0x170)]((_0x2193e4,_0x152e7b)=>{var _0x5ebcbd=_0x37572f;_0x4a18cb[_0x152e7b][_0x5ebcbd(0x1ae)]=_0x2193e4;}),_0x3e2d13['forEach']((_0x9f9589,_0xb753c7)=>{var _0x4d500d=_0x37572f;_0x4a18cb[_0xb753c7][_0x4d500d(0x222)]=_0x9f9589;});var _0x1c7b2d=0x0;_0x4a18cb[_0x37572f(0x170)](_0x1ce7cd=>{var _0x4ee576=_0x37572f;console[_0x4ee576(0x227)](_0x4ee576(0x1d6),_0x1ce7cd),(parseInt(_0x1ce7cd['stock'])<parseInt(_0x1ce7cd[_0x4ee576(0x1b5)])||parseInt(_0x1ce7cd[_0x4ee576(0x1b5)])==0x0)&&_0x1c7b2d++;});if(_0x1c7b2d!=0x0)return _0x154c5b[_0x37572f(0x236)](_0x37572f(0x1f4),_0x37572f(0x1fb)),_0x1036d0[_0x37572f(0x1cc)](_0x37572f(0x1c3));_0x30f578[_0x37572f(0x1d0)][_0x37572f(0x170)](_0x5abd8b=>{const _0x14d357=_0x2cf6c8['product_details']['map'](_0x4f4a17=>{var _0x3e9ccd=a0_0x13e0;_0x4f4a17['product_name']==_0x5abd8b['product_name']&&_0x4f4a17[_0x3e9ccd(0x155)]==_0x5abd8b[_0x3e9ccd(0x155)]&&(_0x4f4a17[_0x3e9ccd(0x240)]=parseInt(_0x4f4a17[_0x3e9ccd(0x240)])+parseInt(_0x5abd8b[_0x3e9ccd(0x1b5)]));});}),await _0x2cf6c8['save']();const _0x571950=_0x4a18cb[_0x37572f(0x233)](_0x4e1df5=>_0x4e1df5[_0x37572f(0x1b5)]!=='0'&&_0x4e1df5[_0x37572f(0x1b5)]!=='');_0x30f578['invoice']=_0x1c2d13,_0x30f578[_0x37572f(0x21d)]=_0xe08375,_0x30f578['date']=_0x3be0c,_0x30f578['warehouse_name']=_0x297214,_0x30f578['sale_product']=_0x571950,_0x30f578[_0x37572f(0x19c)]=_0x2413c9,_0x30f578['room']=_0x2031fc;const _0x3939c4=await _0x30f578[_0x37572f(0x246)](),_0x26e00b=await sales_finished[_0x37572f(0x19b)]({'_id':_0x154c5b[_0x37572f(0x14f)]['id']}),_0x3fe922=await warehouse[_0x37572f(0x19b)]({'name':_0x297214,'room':_0x2031fc,'warehouse_category':_0x37572f(0x1e2)});_0x26e00b['sale_product'][_0x37572f(0x170)](_0x11dc77=>{var _0x5c2c0a=_0x37572f;const _0x15f3a2=_0x3fe922[_0x5c2c0a(0x22d)][_0x5c2c0a(0x187)](_0x1719e8=>{var _0x41dbb0=_0x5c2c0a;_0x1719e8[_0x41dbb0(0x1da)]==_0x11dc77[_0x41dbb0(0x1da)]&&_0x1719e8[_0x41dbb0(0x155)]==_0x11dc77[_0x41dbb0(0x155)]&&(_0x1719e8['product_stock']=parseInt(_0x1719e8[_0x41dbb0(0x240)])-parseInt(_0x11dc77[_0x41dbb0(0x1b5)]));});}),console[_0x37572f(0x227)](_0x37572f(0x1e9),_0x3fe922),await _0x3fe922['save']();const _0x182094=await c_payment_data[_0x37572f(0x19b)]({'invoice':_0x154c5b[_0x37572f(0x20a)][_0x37572f(0x212)]});_0x182094['suppliers']=_0x154c5b[_0x37572f(0x20a)]['suppliers'],await _0x182094[_0x37572f(0x246)](),_0x154c5b[_0x37572f(0x236)]('success',_0x37572f(0x184)),_0x1036d0[_0x37572f(0x1cc)](_0x37572f(0x217));}catch(_0x53d328){console[_0x37572f(0x227)](_0x53d328);}}),router[a0_0x5b567a(0x158)](a0_0x5b567a(0x1b4),auth,async(_0x578f94,_0x1e5ac7)=>{var _0x69094=a0_0x5b567a;try{const _0x36d89c=_0x578f94[_0x69094(0x14f)]['id'],{invoice:_0x1b0e08,customer:_0x5bd57a,receivable_amount:_0x10d3a0,received_amount:_0x5e151e}=_0x578f94[_0x69094(0x20a)],_0x4f1a8a=await sales[_0x69094(0x134)](_0x36d89c);console[_0x69094(0x227)](_0x4f1a8a);var _0xa61384=_0x10d3a0-_0x5e151e;console['log'](_0x5e151e),_0x4f1a8a[_0x69094(0x154)]=parseFloat(_0x5e151e)+parseFloat(_0x4f1a8a[_0x69094(0x154)]),_0x4f1a8a[_0x69094(0x22f)]=_0xa61384,console[_0x69094(0x227)](_0x4f1a8a);const _0x26d46b=await _0x4f1a8a[_0x69094(0x246)](),_0x590388=await c_payment_data[_0x69094(0x19b)]({'invoice':_0x1b0e08});_0x590388['amount']=_0xa61384,await _0x590388[_0x69094(0x246)]();let _0x502823=new Date(),_0x10b5bd=('0'+_0x502823[_0x69094(0x1b3)]())[_0x69094(0x1e8)](-0x2),_0x4f3163=('0'+(_0x502823[_0x69094(0x166)]()+0x1))['slice'](-0x2),_0x1ff884=_0x502823['getFullYear'](),_0x4070d4=_0x1ff884+'-'+_0x4f3163+'-'+_0x10b5bd;const _0x51069f=new customer_payment({'invoice':_0x1b0e08,'date':_0x1ff884+'-'+_0x4f3163+'-'+_0x10b5bd,'customer':_0x5bd57a,'reason':_0x69094(0x177),'amount':_0x5e151e}),_0x227dd4=await _0x51069f[_0x69094(0x246)]();_0x578f94[_0x69094(0x236)](_0x69094(0x1d7),_0x69094(0x23f)),_0x1e5ac7[_0x69094(0x1cc)]('/all_sales/view');}catch(_0x52fc26){console[_0x69094(0x227)](_0x52fc26);}}),router[a0_0x5b567a(0x160)]('/invoice/:id',auth,async(_0x5e1f31,_0x48e8ef)=>{var _0x23f40a=a0_0x5b567a;try{const {username:_0x1f7911,email:_0x21bc68,role:_0x33dcfe}=_0x5e1f31[_0x23f40a(0x144)],_0x1d86d6=_0x5e1f31[_0x23f40a(0x144)],_0x155df0=await profile[_0x23f40a(0x19b)]({'email':_0x1d86d6['email']}),_0x5bdec3=await master_shop[_0x23f40a(0x16d)]();console[_0x23f40a(0x227)](_0x23f40a(0x1e3),_0x5bdec3);const _0x1e7408=_0x5e1f31['params']['id'],_0xb484a7=await sales[_0x23f40a(0x134)](_0x1e7408);console[_0x23f40a(0x227)](_0xb484a7);const _0x19e654=await customer[_0x23f40a(0x19b)]({'name':_0xb484a7[_0x23f40a(0x21d)]});console[_0x23f40a(0x227)](_0x19e654);if(_0x5bdec3[0x0][_0x23f40a(0x20d)]==_0x23f40a(0x1a5)){var _0x2fecc7=users['English'];console[_0x23f40a(0x227)](_0x2fecc7);}else{if(_0x5bdec3[0x0][_0x23f40a(0x20d)]==_0x23f40a(0x18d))var _0x2fecc7=users[_0x23f40a(0x18d)];else{if(_0x5bdec3[0x0][_0x23f40a(0x20d)]==_0x23f40a(0x17b))var _0x2fecc7=users[_0x23f40a(0x17b)];else{if(_0x5bdec3[0x0]['language']=='Spanish')var _0x2fecc7=users[_0x23f40a(0x1bc)];else{if(_0x5bdec3[0x0][_0x23f40a(0x20d)]==_0x23f40a(0x1ca))var _0x2fecc7=users[_0x23f40a(0x1ca)];else{if(_0x5bdec3[0x0][_0x23f40a(0x20d)]=='Portuguese\x20(BR)')var _0x2fecc7=users[_0x23f40a(0x247)];else{if(_0x5bdec3[0x0]['language']=='Chinese')var _0x2fecc7=users[_0x23f40a(0x1bf)];else{if(_0x5bdec3[0x0][_0x23f40a(0x20d)]==_0x23f40a(0x138))var _0x2fecc7=users[_0x23f40a(0x1c8)];}}}}}}}_0x48e8ef['render'](_0x23f40a(0x18a),{'success':_0x5e1f31[_0x23f40a(0x236)]('success'),'errors':_0x5e1f31[_0x23f40a(0x236)](_0x23f40a(0x1f4)),'role':_0x1d86d6,'profile':_0x155df0,'master_shop':_0x5bdec3,'customers':_0x19e654,'sales':_0xb484a7,'language':_0x2fecc7});}catch(_0x25478d){console[_0x23f40a(0x227)](_0x25478d);}}),router[a0_0x5b567a(0x160)](a0_0x5b567a(0x191),auth,async(_0x349bd1,_0x5b8ef9)=>{var _0x205b71=a0_0x5b567a;try{const {username:_0x4e33b5,email:_0x2b9e78,role:_0x57468d}=_0x349bd1['user'],_0x516850=_0x349bd1[_0x205b71(0x144)],_0x518dbf=await profile[_0x205b71(0x19b)]({'email':_0x516850[_0x205b71(0x22a)]}),_0x47508f=await master_shop['find'](),_0x1f2ce6=_0x349bd1[_0x205b71(0x14f)]['id'],_0x94fed9=await sales_finished['findById'](_0x1f2ce6),_0x44eaa8=await warehouse[_0x205b71(0x1d8)]([{'$match':{'name':_0x94fed9[_0x205b71(0x24a)]}},{'$unwind':_0x205b71(0x1ac)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x205b71(0x14c)},'product_stock':{'$first':_0x205b71(0x1fa)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x205b71(0x164)},'type':{'$first':_0x205b71(0x167)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x205b71(0x20c)},'product_code':{'$first':_0x205b71(0x13d)},'storage':{'$first':_0x205b71(0x202)},'rack':{'$first':_0x205b71(0x171)},'expiry_date':{'$first':_0x205b71(0x243)},'production_date':{'$first':_0x205b71(0x200)},'unit':{'$first':_0x205b71(0x162)},'secondary_unit':{'$first':_0x205b71(0x1d2)},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x205b71(0x183)},'maxPerUnit':{'$first':_0x205b71(0x163)}}}]),_0x4f1e4c=await product['find']({}),_0x2bae17=await warehouse['aggregate']([{'$match':{'status':_0x205b71(0x1de),'warehouse_category':_0x205b71(0x1e2),'name':{'$ne':_0x205b71(0x17e),'$ne':_0x205b71(0x13e)}}},{'$group':{'_id':_0x205b71(0x231),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);var _0xa5c25c=[_0x205b71(0x15b)];const _0x2c2c0c=await warehouse[_0x205b71(0x1d8)]([{'$match':{'status':_0x205b71(0x1de),'name':_0x205b71(0x13e)}},{'$group':{'_id':_0x205b71(0x231),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x47508f[0x0][_0x205b71(0x20d)]==_0x205b71(0x1a5)){var _0xec367a=users['English'];console['log'](_0xec367a);}else{if(_0x47508f[0x0]['language']=='Hindi')var _0xec367a=users[_0x205b71(0x18d)];else{if(_0x47508f[0x0][_0x205b71(0x20d)]==_0x205b71(0x17b))var _0xec367a=users['German'];else{if(_0x47508f[0x0][_0x205b71(0x20d)]=='Spanish')var _0xec367a=users[_0x205b71(0x1bc)];else{if(_0x47508f[0x0][_0x205b71(0x20d)]==_0x205b71(0x1ca))var _0xec367a=users[_0x205b71(0x1ca)];else{if(_0x47508f[0x0]['language']=='Portuguese\x20(BR)')var _0xec367a=users[_0x205b71(0x247)];else{if(_0x47508f[0x0][_0x205b71(0x20d)]==_0x205b71(0x1bf))var _0xec367a=users[_0x205b71(0x1bf)];else{if(_0x47508f[0x0]['language']=='Arabic\x20(ae)')var _0xec367a=users[_0x205b71(0x1c8)];}}}}}}}_0x5b8ef9['render'](_0x205b71(0x1b2),{'success':_0x349bd1[_0x205b71(0x236)](_0x205b71(0x1d7)),'errors':_0x349bd1['flash'](_0x205b71(0x1f4)),'role':_0x516850,'profile':_0x518dbf,'user':_0x94fed9,'stock':_0x44eaa8,'master_shop':_0x47508f,'unit':_0x4f1e4c,'language':_0xec367a,'warehouses':_0x2bae17,'rooms':_0xa5c25c,'warehouse_QA':_0x2c2c0c});}catch(_0x385006){console[_0x205b71(0x227)](_0x385006),_0x5b8ef9[_0x205b71(0x16e)](0xc8)[_0x205b71(0x168)]({'message':_0x385006['message']});}}),router[a0_0x5b567a(0x158)]('/view/return_sales/:id',auth,async(_0x56ddaf,_0x139fbd)=>{var _0x4ee810=a0_0x5b567a;if(_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x15c)]=='QA')try{const {invoice:_0x1a8eb2,date:_0x51f9a6,warehouse_name:_0x299603,product_name:_0x125a2d,primary_code:_0x5b2065,secondary_code:_0x3addee,product_code:_0x270ae9,sales_quantity:_0x5099ca,stocks:_0x61bdaf,return_qty:_0x322f6a,Room_name:_0x1455cf,to_warehouse_name_QA:_0x411633,to_Room_name_QA:_0x24caa4,note:_0x265a0e,for_categorize:_0xa8a6,product_name_QA1:_0x1acdac}=_0x56ddaf[_0x4ee810(0x20a)];if(typeof _0x1acdac==_0x4ee810(0x242))var _0x5a148a=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1bb)]],_0x1112ce=[_0x56ddaf[_0x4ee810(0x20a)]['primary_code_QA']],_0x471b38=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x218)]],_0x3b318a=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x20e)]],_0x1aa28f=[_0x56ddaf[_0x4ee810(0x20a)]['sales_quantity_QA']],_0x5d013e=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1f2)]],_0xb4523a=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1d4)]],_0x1be474=[_0x56ddaf[_0x4ee810(0x20a)]['maxPerUnit_QA']],_0x14e379=[_0x56ddaf['body'][_0x4ee810(0x13f)]],_0x2291ba=[_0x56ddaf[_0x4ee810(0x20a)]['batch_code_QA']],_0x42c18c=[_0x56ddaf['body'][_0x4ee810(0x19e)]],_0x369368=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x19f)]],_0x3e7ad7=[_0x56ddaf['body']['production_date_QA']],_0x48873c=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1df)]];else var _0x5a148a=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1bb)]],_0x1112ce=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x22e)]],_0x471b38=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x218)]],_0x3b318a=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x20e)]],_0x1aa28f=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x14e)]],_0x5d013e=[..._0x56ddaf[_0x4ee810(0x20a)]['stocks_QA']],_0xb4523a=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1d4)]],_0x1be474=[..._0x56ddaf['body'][_0x4ee810(0x208)]],_0x14e379=[..._0x56ddaf[_0x4ee810(0x20a)]['maxProducts_QA']],_0x2291ba=[..._0x56ddaf[_0x4ee810(0x20a)]['batch_code_QA']],_0x42c18c=[..._0x56ddaf['body'][_0x4ee810(0x19e)]],_0x369368=[..._0x56ddaf[_0x4ee810(0x20a)]['unit_QA']],_0x3e7ad7=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x224)]],_0x48873c=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1df)]];const _0x3c6fce=_0x5a148a[_0x4ee810(0x187)](_0x350557=>{return _0x350557={'product_name':_0x350557};});_0x1112ce[_0x4ee810(0x170)]((_0x592d5f,_0x499dd6)=>{_0x3c6fce[_0x499dd6]['primary_code']=_0x592d5f;}),_0x471b38[_0x4ee810(0x170)]((_0x38c783,_0x1e4d51)=>{var _0x5a21f7=_0x4ee810;_0x3c6fce[_0x1e4d51][_0x5a21f7(0x1f7)]=_0x38c783;}),_0x3b318a[_0x4ee810(0x170)]((_0x717314,_0x23ec0f)=>{var _0x209302=_0x4ee810;_0x3c6fce[_0x23ec0f][_0x209302(0x1dd)]=_0x717314;}),_0x1aa28f[_0x4ee810(0x170)]((_0xde8fba,_0xd6965b)=>{var _0x51ac90=_0x4ee810;_0x3c6fce[_0xd6965b][_0x51ac90(0x1d3)]=_0xde8fba;}),_0x5d013e[_0x4ee810(0x170)]((_0x4548a7,_0x4849ad)=>{_0x3c6fce[_0x4849ad]['stock']=_0x4548a7;}),_0xb4523a['forEach']((_0x25d151,_0x2f1b7f)=>{var _0x4b473a=_0x4ee810;_0x3c6fce[_0x2f1b7f][_0x4b473a(0x1e5)]=_0x25d151;}),_0x1be474[_0x4ee810(0x170)]((_0x38d8c7,_0x26e627)=>{var _0x549674=_0x4ee810;_0x3c6fce[_0x26e627][_0x549674(0x1ce)]=_0x38d8c7;}),_0x14e379['forEach']((_0x122af7,_0x15482f)=>{var _0x3a4d6c=_0x4ee810;_0x3c6fce[_0x15482f][_0x3a4d6c(0x148)]=_0x122af7;}),_0x2291ba[_0x4ee810(0x170)]((_0x254a17,_0xc9cfa6)=>{_0x3c6fce[_0xc9cfa6]['batch_code']=_0x254a17;}),_0x42c18c['forEach']((_0x2d0231,_0x141688)=>{var _0x57f127=_0x4ee810;_0x3c6fce[_0x141688][_0x57f127(0x221)]=_0x2d0231;}),_0x369368['forEach']((_0x369639,_0x18b19e)=>{var _0x56460e=_0x4ee810;_0x3c6fce[_0x18b19e][_0x56460e(0x203)]=_0x369639;}),_0x3e7ad7[_0x4ee810(0x170)]((_0x12cd8f,_0x267d37)=>{var _0x16ab15=_0x4ee810;_0x3c6fce[_0x267d37][_0x16ab15(0x1a4)]=_0x12cd8f;}),_0x48873c[_0x4ee810(0x170)]((_0x2a0eaa,_0x1fee54)=>{_0x3c6fce[_0x1fee54]['expiry_date']=_0x2a0eaa;});const _0x4997d0=await sales_finished[_0x4ee810(0x19b)]({'invoice':_0x1a8eb2});_0x4997d0[_0x4ee810(0x143)]=_0x4ee810(0x1c0);const _0x5b2d83=await _0x4997d0[_0x4ee810(0x246)](),_0x25ded5=new sales_return_finished({'invoice':_0x1a8eb2,'customer':_0x56ddaf['body'][_0x4ee810(0x21d)],'date':_0x51f9a6,'warehouse_name':_0x299603,'room':_0x1455cf,'ToWarehouse':_0x411633,'ToRoom':_0x24caa4,'return_sale_QA':_0x3c6fce,'note':_0x265a0e,'warehouse_cat':_0xa8a6}),_0x37d227=await _0x25ded5[_0x4ee810(0x246)](),_0x47ff09=await sales_return_finished[_0x4ee810(0x19b)]({'invoice':_0x1a8eb2}),_0x193015=await warehouse[_0x4ee810(0x19b)]({'name':_0x411633,'room':_0x24caa4});_0x47ff09[_0x4ee810(0x17d)][_0x4ee810(0x170)](_0x1f46a2=>{var _0x1c6748=_0x4ee810,_0x33cd00=0x0;const _0x16035f=_0x193015[_0x1c6748(0x22d)][_0x1c6748(0x187)](_0x462799=>{var _0x2cb9c4=_0x1c6748;_0x462799[_0x2cb9c4(0x1da)]==_0x1f46a2[_0x2cb9c4(0x1da)]&&_0x462799['expiry_date']==_0x1f46a2[_0x2cb9c4(0x222)]&&_0x462799[_0x2cb9c4(0x1a4)]==_0x1f46a2[_0x2cb9c4(0x1a4)]&&_0x462799[_0x2cb9c4(0x1c6)]==_0x1f46a2[_0x2cb9c4(0x1c6)]&&(_0x462799[_0x2cb9c4(0x240)]=parseInt(_0x462799[_0x2cb9c4(0x240)])+parseInt(_0x1f46a2[_0x2cb9c4(0x1e5)]),_0x33cd00++);});_0x33cd00=='0'&&(_0x193015[_0x1c6748(0x22d)]=_0x193015[_0x1c6748(0x22d)][_0x1c6748(0x206)]({'product_name':_0x1f46a2[_0x1c6748(0x1da)],'product_stock':_0x1f46a2['return_qty'],'primary_code':_0x1f46a2[_0x1c6748(0x18b)],'secondary_code':_0x1f46a2[_0x1c6748(0x1f7)],'product_code':_0x1f46a2[_0x1c6748(0x1dd)],'batch_code':_0x1f46a2[_0x1c6748(0x1c6)],'maxPerUnit':_0x1f46a2['maxPerUnit'],'production_date':_0x1f46a2['production_date'],'expiry_date':_0x1f46a2[_0x1c6748(0x222)],'secondary_unit':_0x1f46a2[_0x1c6748(0x221)],'unit':_0x1f46a2[_0x1c6748(0x203)],'maxProducts':_0x1f46a2['maxProducts'],'bay':_0x1f46a2['bay']}));}),await _0x193015[_0x4ee810(0x246)]();const _0x348b1a=new c_payment_data({'invoice':_0x1a8eb2,'customer':_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x21d)],'reason':'Sale\x20Return'});await _0x348b1a['save']();const _0x56c336=await master_shop[_0x4ee810(0x16d)](),_0x4c1987=await email_settings[_0x4ee810(0x19b)](),_0x555249=await customer[_0x4ee810(0x19b)]({'name':_0x56ddaf['body'][_0x4ee810(0x21d)]});_0x56c336[0x0]['currency_placement']==0x1?(right_currency=_0x56c336[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x56c336[0x0][_0x4ee810(0x146)]);var _0x5ef635=_0x5a148a,_0x496b56=_0xb4523a,_0x504b9c='',_0x3649f7;for(_0x3649f7 in _0x5ef635){_0x504b9c+=_0x4ee810(0x1f5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5ef635[_0x3649f7]+_0x4ee810(0x1a3)+_0x4ee810(0x220)+_0x496b56[_0x3649f7]+_0x4ee810(0x1a3)+'</tr>';}console[_0x4ee810(0x227)](_0x4ee810(0x199),_0x504b9c);let _0x1aa37d=nodemailer[_0x4ee810(0x20f)]({'service':_0x4ee810(0x18e),'auth':{'user':_0x4c1987[_0x4ee810(0x22a)],'pass':_0x4c1987['password']}}),_0x2c6c90={'from':_0x4c1987[_0x4ee810(0x22a)],'to':_0x555249[_0x4ee810(0x22a)],'subject':_0x4ee810(0x1c5),'attachments':[{'filename':_0x4ee810(0x178),'path':__dirname+'/../public'+_0x4ee810(0x1cb)+_0x56c336[0x0]['image'],'cid':_0x4ee810(0x23d)}],'html':_0x4ee810(0x192)+_0x4ee810(0x19a)+_0x4ee810(0x140)+_0x4ee810(0x14d)+_0x4ee810(0x194)+_0x4ee810(0x14d)+_0x4ee810(0x172)+_0x4ee810(0x1ba)+_0x4ee810(0x14d)+_0x4ee810(0x16c)+_0x56c336[0x0][_0x4ee810(0x21f)]+_0x4ee810(0x230)+_0x4ee810(0x1ba)+_0x4ee810(0x1ba)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x4ee810(0x1ee)+_0x4ee810(0x223)+_0x1a8eb2+'\x20'+_0x4ee810(0x1a1)+_0x4ee810(0x175)+_0x51f9a6+'\x20'+_0x4ee810(0x21b)+'</h5>'+_0x4ee810(0x1ba)+_0x4ee810(0x1b1)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4ee810(0x1f5)+_0x4ee810(0x1ea)+_0x4ee810(0x1c4)+_0x4ee810(0x13b)+_0x4ee810(0x1e6)+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x504b9c+'\x20'+'</tbody>'+_0x4ee810(0x19d)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x4ee810(0x21e)+_0x56c336[0x0][_0x4ee810(0x21f)]+_0x4ee810(0x136)+_0x4ee810(0x1ba)+_0x4ee810(0x1ba)+_0x4ee810(0x161)};_0x1aa37d['sendMail'](_0x2c6c90,function(_0x150907,_0x500d4d){var _0x5e157e=_0x4ee810;_0x150907?(console['log'](_0x150907),console[_0x5e157e(0x227)]('Error\x20Occurs')):console[_0x5e157e(0x227)](_0x5e157e(0x1bd));}),_0x56ddaf[_0x4ee810(0x236)](_0x4ee810(0x1d7),'sales\x20item\x20return\x20successfull'),_0x139fbd[_0x4ee810(0x1cc)](_0x4ee810(0x217));}catch(_0x7d08ff){_0x139fbd[_0x4ee810(0x16e)](0xc8)['json']({'message1':_0x7d08ff['message']});}else{if(_0x56ddaf['body'][_0x4ee810(0x15c)]=='GS')try{const {invoice:_0x5efecc,date:_0x138db8,warehouse_name:_0x9d8d4b,product_name:_0xb02b79,primary_code:_0x1c7158,secondary_code:_0x1f5dc8,product_code:_0x536a16,sales_quantity:_0x196b1f,stocks:_0x3a18ec,return_qty:_0x38c766,Room_name:_0x52e3b3,to_warehouse_name:_0x263c7a,to_Room_name:_0x10ca32,note:_0x33b812,level:_0x34121c,isle:_0x2c2d76,pallet:_0x1687a8,for_categorize:_0x570254}=_0x56ddaf[_0x4ee810(0x20a)];if(typeof _0xb02b79==_0x4ee810(0x242))var _0x5a148a=[_0x56ddaf[_0x4ee810(0x20a)]['product_name']],_0x1112ce=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x18b)]],_0x471b38=[_0x56ddaf['body']['secondary_code']],_0x3b318a=[_0x56ddaf['body'][_0x4ee810(0x1dd)]],_0x1aa28f=[_0x56ddaf[_0x4ee810(0x20a)]['sales_quantity']],_0xb4523a=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1e5)]],_0x21cbda=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x155)]],_0x1be474=[_0x56ddaf[_0x4ee810(0x20a)]['maxPerUnit']],_0x14e379=[_0x56ddaf['body']['maxProducts']],_0x2291ba=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1c6)]],_0x42c18c=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x221)]],_0x369368=[_0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x203)]],_0x3e7ad7=[_0x56ddaf['body'][_0x4ee810(0x1a4)]],_0x48873c=[_0x56ddaf[_0x4ee810(0x20a)]['expiry_date']];else var _0x5a148a=[..._0x56ddaf['body'][_0x4ee810(0x1da)]],_0x1112ce=[..._0x56ddaf['body'][_0x4ee810(0x18b)]],_0x471b38=[..._0x56ddaf[_0x4ee810(0x20a)]['secondary_code']],_0x3b318a=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1dd)]],_0x1aa28f=[..._0x56ddaf['body'][_0x4ee810(0x169)]],_0xb4523a=[..._0x56ddaf['body'][_0x4ee810(0x1e5)]],_0x21cbda=[..._0x56ddaf['body'][_0x4ee810(0x155)]],_0x1be474=[..._0x56ddaf[_0x4ee810(0x20a)]['maxPerUnit']],_0x14e379=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x148)]],_0x2291ba=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x1c6)]],_0x42c18c=[..._0x56ddaf[_0x4ee810(0x20a)][_0x4ee810(0x221)]],_0x369368=[..._0x56ddaf['body'][_0x4ee810(0x203)]],_0x3e7ad7=[..._0x56ddaf['body'][_0x4ee810(0x1a4)]],_0x48873c=[..._0x56ddaf['body'][_0x4ee810(0x222)]];const _0x2f1d80=_0x5a148a['map'](_0x25af02=>{return _0x25af02={'product_name':_0x25af02};});_0x1112ce['forEach']((_0x2b1e9d,_0x1d745e)=>{var _0x9d07d4=_0x4ee810;_0x2f1d80[_0x1d745e][_0x9d07d4(0x18b)]=_0x2b1e9d;}),_0x471b38['forEach']((_0x31e603,_0x4d5063)=>{var _0x1b1271=_0x4ee810;_0x2f1d80[_0x4d5063][_0x1b1271(0x1f7)]=_0x31e603;}),_0x3b318a[_0x4ee810(0x170)]((_0x4edd55,_0x473d48)=>{var _0xdfede0=_0x4ee810;_0x2f1d80[_0x473d48][_0xdfede0(0x1dd)]=_0x4edd55;}),_0x1aa28f['forEach']((_0x6eb154,_0x3f548e)=>{var _0x2139f1=_0x4ee810;_0x2f1d80[_0x3f548e][_0x2139f1(0x1d3)]=_0x6eb154;}),_0xb4523a['forEach']((_0x3b2b0e,_0x310c0c)=>{_0x2f1d80[_0x310c0c]['return_qty']=_0x3b2b0e;}),_0x21cbda[_0x4ee810(0x170)]((_0x364583,_0x2a4317)=>{var _0x8a10d6=_0x4ee810;_0x2f1d80[_0x2a4317][_0x8a10d6(0x155)]=_0x364583;}),_0x1be474[_0x4ee810(0x170)]((_0x4df7d1,_0x4547f3)=>{var _0x3b5b41=_0x4ee810;_0x2f1d80[_0x4547f3][_0x3b5b41(0x1ce)]=_0x4df7d1;}),_0x14e379['forEach']((_0x3b9244,_0x439125)=>{var _0x860abe=_0x4ee810;_0x2f1d80[_0x439125][_0x860abe(0x148)]=_0x3b9244;}),_0x2291ba[_0x4ee810(0x170)]((_0x3a14d9,_0x350e8c)=>{var _0x35383c=_0x4ee810;_0x2f1d80[_0x350e8c][_0x35383c(0x1c6)]=_0x3a14d9;}),_0x42c18c[_0x4ee810(0x170)]((_0x148090,_0x54eaa8)=>{var _0x31c84d=_0x4ee810;_0x2f1d80[_0x54eaa8][_0x31c84d(0x221)]=_0x148090;}),_0x369368[_0x4ee810(0x170)]((_0x14cb27,_0x48ae33)=>{_0x2f1d80[_0x48ae33]['unit']=_0x14cb27;}),_0x3e7ad7[_0x4ee810(0x170)]((_0x200835,_0x245335)=>{var _0x145418=_0x4ee810;_0x2f1d80[_0x245335][_0x145418(0x1a4)]=_0x200835;}),_0x48873c[_0x4ee810(0x170)]((_0x4dbe31,_0x456bba)=>{var _0x5d53e2=_0x4ee810;_0x2f1d80[_0x456bba][_0x5d53e2(0x222)]=_0x4dbe31;});var _0x36000c=0x0;_0x2f1d80['forEach'](_0x5ad673=>{var _0x3f8fe6=_0x4ee810;(parseInt(_0x5ad673[_0x3f8fe6(0x1d3)])<parseInt(_0x5ad673['return_qty'])||parseInt(_0x5ad673[_0x3f8fe6(0x159)])<parseInt(_0x5ad673[_0x3f8fe6(0x1e5)])&&parseInt(_0x5ad673[_0x3f8fe6(0x1d3)])>parseInt(_0x5ad673[_0x3f8fe6(0x1e5)])||parseInt(_0x5ad673['return_qty'])==0x0)&&_0x36000c++;});if(_0x36000c!=0x0)return _0x56ddaf['flash'](_0x4ee810(0x1f4),_0x4ee810(0x188)),_0x139fbd['redirect']('back');const _0x27c4d5=await sales_finished[_0x4ee810(0x19b)]({'invoice':_0x5efecc});_0x27c4d5[_0x4ee810(0x143)]='True';const _0x498381=await _0x27c4d5['save'](),_0x284bdc=new sales_return_finished({'invoice':_0x5efecc,'customer':_0x56ddaf['body'][_0x4ee810(0x21d)],'date':_0x138db8,'warehouse_name':_0x9d8d4b,'room':_0x52e3b3,'ToWarehouse':_0x263c7a,'ToRoom':_0x10ca32,'return_sale':_0x2f1d80,'note':_0x33b812,'warehouse_cat':_0x570254}),_0x3eace6=await _0x284bdc[_0x4ee810(0x246)](),_0x2c8647=await sales_return_finished['findOne']({'invoice':_0x5efecc}),_0x172dca=await warehouse[_0x4ee810(0x19b)]({'name':_0x263c7a,'room':_0x10ca32,'warehouse_category':'Finished\x20Goods'});_0x2c8647[_0x4ee810(0x1fe)]['forEach'](_0x45c439=>{var _0x12f09a=_0x4ee810,_0x4a52a1=0x0;const _0x8bdda=_0x172dca[_0x12f09a(0x22d)]['map'](_0x463418=>{var _0x2c67e1=_0x12f09a;_0x463418['product_name']==_0x45c439[_0x2c67e1(0x1da)]&&_0x463418['bay']==_0x45c439['bay']&&_0x463418[_0x2c67e1(0x222)]==_0x45c439[_0x2c67e1(0x222)]&&_0x463418[_0x2c67e1(0x1a4)]==_0x45c439['production_date']&&_0x463418[_0x2c67e1(0x1c6)]==_0x45c439[_0x2c67e1(0x1c6)]&&(_0x463418['product_stock']=parseInt(_0x463418[_0x2c67e1(0x240)])+parseInt(_0x45c439['return_qty']),_0x4a52a1++);});_0x4a52a1=='0'&&(_0x172dca[_0x12f09a(0x22d)]=_0x172dca[_0x12f09a(0x22d)][_0x12f09a(0x206)]({'product_name':_0x45c439[_0x12f09a(0x1da)],'product_stock':_0x45c439[_0x12f09a(0x1e5)],'primary_code':_0x45c439[_0x12f09a(0x18b)],'secondary_code':_0x45c439['secondary_code'],'product_code':_0x45c439[_0x12f09a(0x1dd)],'bay':_0x45c439[_0x12f09a(0x155)],'batch_code':_0x45c439['batch_code'],'maxPerUnit':_0x45c439[_0x12f09a(0x1ce)],'production_date':_0x45c439[_0x12f09a(0x1a4)],'expiry_date':_0x45c439['expiry_date'],'secondary_unit':_0x45c439[_0x12f09a(0x221)],'unit':_0x45c439['unit'],'maxProducts':_0x45c439[_0x12f09a(0x148)]}));}),await _0x172dca[_0x4ee810(0x246)](),console[_0x4ee810(0x227)](_0x56ddaf[_0x4ee810(0x20a)]);const _0x5cb692=new c_payment_data({'invoice':_0x5efecc,'customer':_0x56ddaf[_0x4ee810(0x20a)]['customer'],'reason':_0x4ee810(0x15d)});await _0x5cb692[_0x4ee810(0x246)]();const _0x2b03fd=await master_shop['find']();console[_0x4ee810(0x227)]('add\x20post',_0x2b03fd[0x0][_0x4ee810(0x173)]);const _0xc75e31=await email_settings[_0x4ee810(0x19b)](),_0x3d035d=await customer[_0x4ee810(0x19b)]({'name':_0x56ddaf[_0x4ee810(0x20a)]['customer']});console[_0x4ee810(0x227)]('customer_data',_0x3d035d);_0x2b03fd[0x0][_0x4ee810(0x239)]==0x1?(right_currency=_0x2b03fd[0x0][_0x4ee810(0x146)],left_currency=''):(right_currency='',left_currency=_0x2b03fd[0x0]['currency']);var _0x5ef635=_0x5a148a,_0x496b56=_0xb4523a,_0x504b9c='',_0x3649f7;for(_0x3649f7 in _0x5ef635){_0x504b9c+=_0x4ee810(0x1f5)+_0x4ee810(0x220)+_0x5ef635[_0x3649f7]+_0x4ee810(0x1a3)+_0x4ee810(0x220)+_0x496b56[_0x3649f7]+_0x4ee810(0x1a3)+_0x4ee810(0x215);}console[_0x4ee810(0x227)](_0x4ee810(0x199),_0x504b9c);let _0x9b2f37=nodemailer[_0x4ee810(0x20f)]({'service':_0x4ee810(0x18e),'auth':{'user':_0xc75e31[_0x4ee810(0x22a)],'pass':_0xc75e31[_0x4ee810(0x1eb)]}}),_0x24ea5b={'from':_0xc75e31[_0x4ee810(0x22a)],'to':_0x3d035d['email'],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x4ee810(0x178),'path':__dirname+'/../public'+_0x4ee810(0x1cb)+_0x2b03fd[0x0][_0x4ee810(0x173)],'cid':_0x4ee810(0x23d)}],'html':_0x4ee810(0x192)+_0x4ee810(0x19a)+_0x4ee810(0x140)+_0x4ee810(0x14d)+_0x4ee810(0x194)+_0x4ee810(0x14d)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x4ee810(0x14d)+_0x4ee810(0x16c)+_0x2b03fd[0x0][_0x4ee810(0x21f)]+_0x4ee810(0x230)+_0x4ee810(0x1ba)+_0x4ee810(0x1ba)+_0x4ee810(0x180)+_0x4ee810(0x14d)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x4ee810(0x223)+_0x5efecc+'\x20'+_0x4ee810(0x1a1)+_0x4ee810(0x175)+_0x138db8+'\x20'+_0x4ee810(0x21b)+_0x4ee810(0x136)+_0x4ee810(0x1ba)+_0x4ee810(0x1b1)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4ee810(0x1f5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x4ee810(0x1c4)+_0x4ee810(0x13b)+_0x4ee810(0x1e6)+'</tr>'+_0x4ee810(0x204)+_0x4ee810(0x156)+'\x20'+_0x504b9c+'\x20'+_0x4ee810(0x23a)+'</table>'+_0x4ee810(0x14d)+_0x4ee810(0x1cd)+_0x4ee810(0x21e)+_0x2b03fd[0x0]['site_title']+'</h5>'+'</div>'+'</div>'+_0x4ee810(0x161)};_0x9b2f37[_0x4ee810(0x1db)](_0x24ea5b,function(_0xf22486,_0x2b9d16){var _0x3b3958=_0x4ee810;_0xf22486?(console['log'](_0xf22486),console[_0x3b3958(0x227)](_0x3b3958(0x1b0))):console[_0x3b3958(0x227)]('Email\x20sent\x20successfully');}),_0x56ddaf['flash']('success','sales\x20item\x20return\x20successfull'),_0x139fbd[_0x4ee810(0x1cc)](_0x4ee810(0x217));}catch(_0x41267b){console[_0x4ee810(0x227)](_0x41267b),_0x139fbd[_0x4ee810(0x16e)](0xc8)[_0x4ee810(0x168)]({'message1':_0x41267b[_0x4ee810(0x186)]});}}}),router[a0_0x5b567a(0x160)](a0_0x5b567a(0x15f),auth,async(_0x5bd543,_0x20e168)=>{var _0x20a47a=a0_0x5b567a;try{const {username:_0x28a5e3,email:_0x206eac,role:_0x368aba}=_0x5bd543[_0x20a47a(0x144)],_0x4b4d73=_0x5bd543[_0x20a47a(0x144)],_0x1e59e2=await profile[_0x20a47a(0x19b)]({'email':_0x4b4d73[_0x20a47a(0x22a)]}),_0x34d7bf=await master_shop[_0x20a47a(0x16d)]();console['log'](_0x20a47a(0x190),_0x34d7bf);const _0x5e3f73=_0x5bd543['params']['id'],_0x5bf22c=await sales[_0x20a47a(0x134)](_0x5e3f73);console[_0x20a47a(0x227)]('barcode\x20user_id',_0x5bf22c);if(_0x34d7bf[0x0]['language']=='English\x20(US)')var _0x229e4f=users[_0x20a47a(0x244)];else{if(_0x34d7bf[0x0][_0x20a47a(0x20d)]=='Hindi')var _0x229e4f=users[_0x20a47a(0x18d)];else{if(_0x34d7bf[0x0][_0x20a47a(0x20d)]=='German')var _0x229e4f=users[_0x20a47a(0x17b)];else{if(_0x34d7bf[0x0]['language']=='Spanish')var _0x229e4f=users[_0x20a47a(0x1bc)];else{if(_0x34d7bf[0x0][_0x20a47a(0x20d)]=='French')var _0x229e4f=users['French'];else{if(_0x34d7bf[0x0][_0x20a47a(0x20d)]=='Portuguese\x20(BR)')var _0x229e4f=users[_0x20a47a(0x247)];else{if(_0x34d7bf[0x0][_0x20a47a(0x20d)]==_0x20a47a(0x1bf))var _0x229e4f=users[_0x20a47a(0x1bf)];else{if(_0x34d7bf[0x0][_0x20a47a(0x20d)]==_0x20a47a(0x138))var _0x229e4f=users['Arabic'];}}}}}}}_0x20e168[_0x20a47a(0x1a7)](_0x20a47a(0x1ad),{'success':_0x5bd543[_0x20a47a(0x236)](_0x20a47a(0x1d7)),'errors':_0x5bd543[_0x20a47a(0x236)](_0x20a47a(0x1f4)),'role':_0x4b4d73,'profile':_0x1e59e2,'alldata':_0x5bf22c,'master_shop':_0x34d7bf,'language':_0x229e4f});}catch(_0x2903c8){console[_0x20a47a(0x227)](_0x2903c8);}}),router[a0_0x5b567a(0x158)](a0_0x5b567a(0x1ec),async(_0x160192,_0x4bcee6)=>{var _0x4d3c7e=a0_0x5b567a;const {product_code:_0x20e4fd,warehouse_name:_0x5cc69c,rooms_data:_0x5b3f4f,Roomslist:_0x53199a}=_0x160192[_0x4d3c7e(0x20a)],_0x5b45c2=_0x53199a[_0x4d3c7e(0x17c)](','),_0x4d0d29=[];async function _0x5343c0(_0x415d24){var _0xc84752=_0x4d3c7e;const _0x1c9689=await warehouse['aggregate']([{'$match':{'name':_0x5cc69c,'room':_0x415d24}},{'$unwind':_0xc84752(0x1ac)},{'$match':{'product_details.primary_code':_0x20e4fd}},{'$group':{'_id':_0xc84752(0x207),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xc84752(0x1fa)},'primary_code':{'$first':_0xc84752(0x248)},'secondary_code':{'$first':_0xc84752(0x20c)},'product_code':{'$first':_0xc84752(0x13d)},'level':{'$first':_0xc84752(0x153)},'isle':{'$first':_0xc84752(0x164)},'type':{'$first':_0xc84752(0x167)},'pallet':{'$first':_0xc84752(0x16f)},'unit':{'$first':_0xc84752(0x162)},'secondary_unit':{'$first':_0xc84752(0x1d2)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0xc84752(0x243)},'production_date':{'$first':_0xc84752(0x200)},'maxPerUnit':{'$first':_0xc84752(0x163)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0xc84752(0x1f1)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0xc84752(0x209)},'invoice':{'$first':_0xc84752(0x1fd)}}}]),_0x59eaee=await warehouse[_0xc84752(0x1d8)]([{'$match':{'name':_0x5cc69c,'room':_0x415d24}},{'$unwind':_0xc84752(0x1ac)},{'$match':{'product_details.secondary_code':_0x20e4fd}},{'$group':{'_id':_0xc84752(0x207),'name':{'$first':_0xc84752(0x14c)},'product_stock':{'$first':_0xc84752(0x1fa)},'primary_code':{'$first':_0xc84752(0x248)},'secondary_code':{'$first':_0xc84752(0x20c)},'product_code':{'$first':_0xc84752(0x13d)},'level':{'$first':_0xc84752(0x153)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xc84752(0x167)},'pallet':{'$first':_0xc84752(0x16f)},'unit':{'$first':_0xc84752(0x162)},'secondary_unit':{'$first':_0xc84752(0x1d2)},'storage':{'$first':_0xc84752(0x202)},'rack':{'$first':_0xc84752(0x171)},'expiry_date':{'$first':_0xc84752(0x243)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0xc84752(0x163)},'batch_code':{'$first':_0xc84752(0x183)},'product_cat':{'$first':_0xc84752(0x1f1)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0xc84752(0x1fd)}}}]);if(_0x1c9689[_0xc84752(0x145)]>0x0)_0x4d0d29['push'](_0x1c9689);else _0x59eaee[_0xc84752(0x145)]>0x0&&_0x4d0d29[_0xc84752(0x1e0)](_0x59eaee);}const _0x308f67=_0x5b45c2[_0x4d3c7e(0x187)](_0x53510b=>_0x5343c0(_0x53510b));await Promise[_0x4d3c7e(0x16b)](_0x308f67),_0x4bcee6[_0x4d3c7e(0x168)](_0x4d0d29);}),module[a0_0x5b567a(0x1dc)]=router;