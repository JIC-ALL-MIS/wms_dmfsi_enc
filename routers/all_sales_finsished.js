var a0_0x2a4b90=a0_0x2c94;function a0_0x4393(){var _0x2fe6de=['True','Portuguese','/all_sales_finished/preview/','</tr>','sales\x20item\x20return\x20successfull','$sale_product.bay','secondary_unit_QA','getFullYear','exports','$product_details.maxProducts','role','<h2>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','maxProducts','An\x20error\x20occurred.','port','message','sales_invoice','</body></html>','post','save','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','product_data','maxPerUnit_QA','return_qty','Ambient','$sale_product','bay','Finished\x20Goods','sales_quantity','$customers_docs','$sale_product.quantity','An\x20error\x20occurred\x20while\x20saving\x20data.','filter','/view/add_sale/product','batch_code','/view/return_sales/:id','batch_code_QA','site_title','$customer','<!DOCTYPE\x20html>','$product_details.bin','invoice','add\x20post','</thead>','1877140zgwGNm','slice','room_name','\x20</h2>','prod_code','currency','string','user','Arabic\x20(ae)','\x20>>>\x20','stocks_QA','211348zCEfpl','product_stock','Sales\x20Update\x20successfully','floor','6ASXpQf','customers_docs','primary_code_QA','sendMail','staff','maxperunit','/view/add_sales/:id','$product_details.rack','push','prod_cat','redirect','French','room','$product_details.expiry_date','all_sales_barcode','Return\x20Goods','354066UPTpTH','$product_details.product_code','return_data','$warehouse_name','customers','nodemailer','\x20<>\x20','/all_sales_finished/view','\x20==\x20','success','$product_details.invoice','product_date','return_sale','$sale_product.floorlevel','secondary_unit','Portuguese\x20(BR)','</head><body>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.maxPerUnit','unit','currency_placement','6220654adkPgX','findOne','$product_details','Router','<div>','Arabic','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<h5>','Email\x20sent\x20successfully','edit_sales_finished_view','unit_QA','$product_details.product_stock','Sales\x20Mail','all','1065360zslBhS','$product_details.bay','maxPerUnit','<tbody\x20style=\x22text-align:\x20center;\x22>','secondary_code','$product_details.product_cat','638717VyJpVX','catch','return_sale_QA','christian.villamer@jakagroup.com','$product_details.unit','product_list','production_date','../models/all_models','<hr\x20class=\x22my-3\x22>','$note','customer_data','ADD\x20SALE','/all_sales/view','level','product_name','stock_data','suppliers','getDate','QA\x20Warehouse','27ITagUj','2PhwDjM','Sale\x20Return\x20Mail','$product_details.storage','</tbody>','barcode\x20Product\x20master','Sale\x20Return','<h5\x20style=\x22text-align:\x20left;\x22>','$sale_product.type','63enOnut','RoomAssigned','Sale','add_sales_finished','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.floorlevel','concat','expiry_date_QA','received_amount','json','/view/add_sales','product_code','language','render','$product_details.batch_code','/barcode/:id','$sale_product.bin','German','</span>','log','$product.product_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','expiry_date','customer','$room','getMonth','primary_unit','Quality\x20Inspection','$product_details._id','\x20Order\x20Number\x20:\x20','\x20<<<==>>>\x20','sale_qty','$name','$finalize','sales_quantity_QA','$product_details.production_date','foreach\x20newproduct','\x20Order\x20Date\x20:\x20','forEach','English\x20(US)','product_code_QA','../public/language/languages.json','master','OUTF-','purchases_data','error','/give_payment/:id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/../public','$product_details.secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','warehouse','\x20&&\x20','Error\x20Occurs','image','createTransport','</table>','back','password','maxProducts_QA','prod_invoice','max_per_unit','$return_data','sale_product','Sales\x20Add\x20successfully','Hindi','/preview/:id','/view/:id','name','Enabled','secondary_code_QA','aggregate','product','$invoice','<span\x20style=\x22float:\x20right;\x22>','length','$product_details.product_name','host','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.primary_code','findById','due_amount','../middleware/auth','English','Chinese','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','final','primary_code','adjust_qty','_id','map','</td>','errors','$_id','stock','toString','get','status','email','for_categorize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','Spanish','amount','edit_sales_finished','barcode\x20user_id','random','</h5>','product_details','$product_details.type','warehouse_name','</div>','find','<strong>\x20Regards\x20</strong>','gmail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/upload/','express','Enclosed','return_qty_QA','$product_details.secondary_code','id_transaction_from','Logo.png','abs','params','body','logo','1029752rOyvtE','<tr>','quantity','note','flash','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','product_name_QA1'];a0_0x4393=function(){return _0x2fe6de;};return a0_0x4393();}(function(_0x170684,_0x3a80a5){var _0x285e0b=a0_0x2c94,_0x4c4a80=_0x170684();while(!![]){try{var _0x29f27d=-parseInt(_0x285e0b(0x1a5))/0x1*(parseInt(_0x285e0b(0x1b9))/0x2)+-parseInt(_0x285e0b(0x16c))/0x3*(parseInt(_0x285e0b(0x168))/0x4)+parseInt(_0x285e0b(0x15d))/0x5+parseInt(_0x285e0b(0x17c))/0x6*(parseInt(_0x285e0b(0x1c1))/0x7)+-parseInt(_0x285e0b(0x243))/0x8*(parseInt(_0x285e0b(0x1b8))/0x9)+parseInt(_0x285e0b(0x19f))/0xa+parseInt(_0x285e0b(0x191))/0xb;if(_0x29f27d===_0x3a80a5)break;else _0x4c4a80['push'](_0x4c4a80['shift']());}catch(_0x3fb624){_0x4c4a80['push'](_0x4c4a80['shift']());}}}(a0_0x4393,0x6d61d));const express=require(a0_0x2a4b90(0x239)),app=express(),router=express[a0_0x2a4b90(0x194)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x2a4b90(0x1ac)),auth=require(a0_0x2a4b90(0x214)),nodemailer=require(a0_0x2a4b90(0x181)),users=require(a0_0x2a4b90(0x1eb));function a0_0x2c94(_0x8274ce,_0x12a4d0){var _0x4393cd=a0_0x4393();return a0_0x2c94=function(_0x2c9460,_0x43ad6f){_0x2c9460=_0x2c9460-0x140;var _0x571961=_0x4393cd[_0x2c9460];return _0x571961;},a0_0x2c94(_0x8274ce,_0x12a4d0);}router[a0_0x2a4b90(0x222)]('/view',auth,async(_0x36be74,_0x295163)=>{var _0x10ed2c=a0_0x2a4b90;try{const {username:_0x5a459c,email:_0x207244,role:_0x1e9d61}=_0x36be74[_0x10ed2c(0x164)],_0x5786d8=_0x36be74[_0x10ed2c(0x164)],_0x3558f7=await profile[_0x10ed2c(0x192)]({'email':_0x5786d8[_0x10ed2c(0x224)]}),_0x7cd13f=await master_shop['find']();let _0x4e31a8;if(_0x5786d8['role']=='staff'){const _0x1547a0=await staff[_0x10ed2c(0x192)]({'email':_0x5786d8[_0x10ed2c(0x224)]});_0x4e31a8=await sales_finished[_0x10ed2c(0x209)]([{'$lookup':{'from':_0x10ed2c(0x180),'localField':_0x10ed2c(0x1d9),'foreignField':_0x10ed2c(0x206),'as':_0x10ed2c(0x16d)}},{'$unwind':_0x10ed2c(0x14e)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x10ed2c(0x21f),'invoice':{'$first':_0x10ed2c(0x20b)},'customers':{'$first':_0x10ed2c(0x157)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x10ed2c(0x17f)},'sale_product':{'$push':_0x10ed2c(0x14a)},'note':{'$first':_0x10ed2c(0x1ae)},'return_data':{'$first':_0x10ed2c(0x200)},'customers_docs':{'$first':_0x10ed2c(0x14e)},'total_saleproduct_quantity':{'$sum':_0x10ed2c(0x14f)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x10ed2c(0x1d2)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x10ed2c(0x189)},'finalize':{'$first':_0x10ed2c(0x1e3)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x4e31a8=await sales_finished[_0x10ed2c(0x209)]([{'$lookup':{'from':_0x10ed2c(0x180),'localField':_0x10ed2c(0x1d9),'foreignField':'name','as':'customers_docs'}},{'$unwind':'$customers_docs'},{'$unwind':_0x10ed2c(0x14a)},{'$group':{'_id':_0x10ed2c(0x21f),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x10ed2c(0x157)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x10ed2c(0x17f)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x10ed2c(0x1ae)},'return_data':{'$first':_0x10ed2c(0x200)},'customers_docs':{'$first':_0x10ed2c(0x14e)},'total_saleproduct_quantity':{'$sum':_0x10ed2c(0x14f)},'level':{'$addToSet':_0x10ed2c(0x24f)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x10ed2c(0x1c0)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x7cd13f[0x0][_0x10ed2c(0x1ce)]==_0x10ed2c(0x1e9)){var _0x2da6fd=users[_0x10ed2c(0x215)];console[_0x10ed2c(0x1d5)](_0x2da6fd);}else{if(_0x7cd13f[0x0][_0x10ed2c(0x1ce)]=='Hindi')var _0x2da6fd=users[_0x10ed2c(0x203)];else{if(_0x7cd13f[0x0]['language']==_0x10ed2c(0x1d3))var _0x2da6fd=users[_0x10ed2c(0x1d3)];else{if(_0x7cd13f[0x0][_0x10ed2c(0x1ce)]==_0x10ed2c(0x228))var _0x2da6fd=users['Spanish'];else{if(_0x7cd13f[0x0]['language']==_0x10ed2c(0x177))var _0x2da6fd=users['French'];else{if(_0x7cd13f[0x0]['language']=='Portuguese\x20(BR)')var _0x2da6fd=users[_0x10ed2c(0x24b)];else{if(_0x7cd13f[0x0]['language']==_0x10ed2c(0x216))var _0x2da6fd=users[_0x10ed2c(0x216)];else{if(_0x7cd13f[0x0][_0x10ed2c(0x1ce)]==_0x10ed2c(0x165))var _0x2da6fd=users['Arabic'];}}}}}}}_0x295163[_0x10ed2c(0x1cf)]('all_sales_finished',{'success':_0x36be74[_0x10ed2c(0x247)](_0x10ed2c(0x185)),'errors':_0x36be74[_0x10ed2c(0x247)](_0x10ed2c(0x21e)),'sales':_0x4e31a8,'profile':_0x3558f7,'role':_0x5786d8,'master_shop':_0x7cd13f,'language':_0x2da6fd});}catch(_0x119fad){console[_0x10ed2c(0x1d5)](_0x119fad);}});async function getRandom8DigitNumber(){var _0x3d4fb6=a0_0x2a4b90;const _0x458a56=0x989680,_0x4f0a4f=0x5f5e0ff,_0x42b014=Math[_0x3d4fb6(0x16b)](Math[_0x3d4fb6(0x22c)]()*(_0x4f0a4f-_0x458a56+0x1))+_0x458a56;var _0x19225;const _0x9eaf1a=await sales_finished[_0x3d4fb6(0x192)]({'invoice':_0x3d4fb6(0x1ed)+_0x42b014});return _0x9eaf1a&&_0x9eaf1a['length']>0x0?_0x19225=_0x3d4fb6(0x1ed)+_0x42b014:_0x19225='OUTF-'+_0x42b014,_0x19225;}router['get'](a0_0x2a4b90(0x1cc),auth,async(_0x4d9874,_0x3930bd)=>{var _0x402b8f=a0_0x2a4b90;try{const {username:_0x80bcdb,email:_0x253699,role:_0x50b907}=_0x4d9874[_0x402b8f(0x164)],_0x510ad3=_0x4d9874[_0x402b8f(0x164)],_0xce46f4=await profile[_0x402b8f(0x192)]({'email':_0x510ad3[_0x402b8f(0x224)]}),_0x312378=await master_shop['find'](),_0x11452a=await customer[_0x402b8f(0x232)]({});let _0x2ef9bd;if(_0x510ad3[_0x402b8f(0x254)]==_0x402b8f(0x170)){const _0x2b8006=await staff['findOne']({'email':_0x510ad3[_0x402b8f(0x224)]});_0x2ef9bd=await warehouse[_0x402b8f(0x209)]([{'$match':{'status':'Enabled','name':_0x2b8006[_0x402b8f(0x1f5)],'warehouse_category':_0x402b8f(0x14c),'name':{'$ne':_0x402b8f(0x1b7)}}},{'$group':{'_id':_0x402b8f(0x1e2),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x2ef9bd=await warehouse[_0x402b8f(0x209)]([{'$match':{'status':_0x402b8f(0x207),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x402b8f(0x1b7)}}},{'$group':{'_id':'$name','name':{'$first':_0x402b8f(0x1e2)}}},{'$sort':{'name':0x1}}]);const _0x4c6682=await product[_0x402b8f(0x232)]({});var _0x5ab4cc=[_0x402b8f(0x149),_0x402b8f(0x23a)];const _0x2322f3=await sales_finished['find']({}),_0x11c6da=_0x2322f3['length']+0x1,_0x34fb81='OUTF-'+_0x11c6da[_0x402b8f(0x221)]()['padStart'](0x5,'0');if(_0x312378[0x0][_0x402b8f(0x1ce)]==_0x402b8f(0x1e9)){var _0x2d7986=users[_0x402b8f(0x215)];console[_0x402b8f(0x1d5)](_0x2d7986);}else{if(_0x312378[0x0][_0x402b8f(0x1ce)]==_0x402b8f(0x203))var _0x2d7986=users[_0x402b8f(0x203)];else{if(_0x312378[0x0][_0x402b8f(0x1ce)]==_0x402b8f(0x1d3))var _0x2d7986=users[_0x402b8f(0x1d3)];else{if(_0x312378[0x0][_0x402b8f(0x1ce)]=='Spanish')var _0x2d7986=users[_0x402b8f(0x228)];else{if(_0x312378[0x0][_0x402b8f(0x1ce)]==_0x402b8f(0x177))var _0x2d7986=users['French'];else{if(_0x312378[0x0][_0x402b8f(0x1ce)]==_0x402b8f(0x18b))var _0x2d7986=users[_0x402b8f(0x24b)];else{if(_0x312378[0x0]['language']=='Chinese')var _0x2d7986=users['Chinese'];else{if(_0x312378[0x0][_0x402b8f(0x1ce)]==_0x402b8f(0x165))var _0x2d7986=users['Arabic'];}}}}}}}const _0x2b7769=getRandom8DigitNumber();_0x2b7769['then'](_0x25abda=>{var _0x3b2edd=_0x402b8f;_0x3930bd['render'](_0x3b2edd(0x1c4),{'success':_0x4d9874[_0x3b2edd(0x247)](_0x3b2edd(0x185)),'errors':_0x4d9874[_0x3b2edd(0x247)](_0x3b2edd(0x21e)),'role':_0x510ad3,'profile':_0xce46f4,'customer':_0x11452a,'warehouse':_0x2ef9bd,'product':_0x4c6682,'invoice':_0x25abda,'master_shop':_0x312378,'language':_0x2d7986,'rooms_data':_0x5ab4cc});})[_0x402b8f(0x1a6)](_0x567392=>{var _0x5f2a43=_0x402b8f;_0x4d9874[_0x5f2a43(0x247)](_0x5f2a43(0x21e),_0x5f2a43(0x18d)),_0x3930bd[_0x5f2a43(0x176)](_0x5f2a43(0x183));});}catch(_0x149f78){console[_0x402b8f(0x1d5)](_0x149f78);}}),router[a0_0x2a4b90(0x222)](a0_0x2a4b90(0x172),auth,async(_0x4d47b1,_0x48a8cd)=>{var _0x26efa5=a0_0x2a4b90;try{const _0x3ca1d7=_0x4d47b1[_0x26efa5(0x240)]['id'];console[_0x26efa5(0x1d5)](_0x3ca1d7);const _0x2a17c8=await product[_0x26efa5(0x232)](),_0xafb221=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3ca1d7}},{'$unwind':'$product'},{'$group':{'_id':_0x26efa5(0x1d6)}}]);console[_0x26efa5(0x1d5)](_0x26efa5(0x1ee),_0xafb221),_0x48a8cd[_0x26efa5(0x223)](0xc8)[_0x26efa5(0x1cb)]({'purchases_data':_0xafb221,'product_data':_0x2a17c8});}catch(_0x4020b4){console[_0x26efa5(0x1d5)](_0x4020b4);}}),router['post'](a0_0x2a4b90(0x152),auth,async(_0x1bbb9f,_0x467759)=>{var _0x3b3389=a0_0x2a4b90;try{const {warehouse_data:_0x57b473,product_data:_0x4cc25c}=_0x1bbb9f[_0x3b3389(0x241)];console[_0x3b3389(0x1d5)](_0x1bbb9f[_0x3b3389(0x241)][_0x3b3389(0x146)]);;const _0x571da5=await master_shop[_0x3b3389(0x232)]();console['log'](_0x3b3389(0x1ec),_0x571da5);const _0x519712=await product[_0x3b3389(0x192)]({'name':_0x4cc25c});console[_0x3b3389(0x1d5)](_0x3b3389(0x20a),_0x519712);const _0xbf8a74=await warehouse[_0x3b3389(0x209)]([{'$match':{'name':_0x57b473}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x4cc25c}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x3b3389(0x19c)}}}]);console[_0x3b3389(0x1d5)](_0x3b3389(0x1b4),_0xbf8a74),_0x467759[_0x3b3389(0x223)](0xc8)[_0x3b3389(0x1cb)]({'master':_0x571da5,'new_product':_0x519712,'stock_data':_0xbf8a74});}catch(_0x23c548){console[_0x3b3389(0x1d5)](_0x23c548);}}),router[a0_0x2a4b90(0x141)](a0_0x2a4b90(0x1cc),auth,async(_0x456e7b,_0x34f9dc)=>{var _0xb0e5d8=a0_0x2a4b90;try{const {invoice:_0x3bca47,date:_0x409f8d,warehouse_name:_0x1b5f57,product_name:_0x4be671,stock:_0x14f81a,quantity:_0x555726,note:_0x38fdb8,room:_0x5bb9f5,primary_code:_0x2559ae,secondary_code:_0x34a7d7,prod_code:_0xc37cd1,level:_0x3f068d,isle:_0x36961c,pallet:_0x5bcd2b,batch_code:_0xf70ec7,SCRN:_0x59d0f8,expiry_date:_0x3b8d69,mode_transpo:_0x4ef856,name_driver:_0x51d413}=_0x456e7b[_0xb0e5d8(0x241)];if(typeof _0x4be671=='string')var _0x390b7e=[_0x456e7b[_0xb0e5d8(0x241)]['product_name']],_0x4b3a61=[_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x220)]],_0x3ae0a7=[_0x456e7b[_0xb0e5d8(0x241)]['carton']],_0x19dc5a=[_0x456e7b['body'][_0xb0e5d8(0x219)]],_0x18dfb0=[_0x456e7b[_0xb0e5d8(0x241)]['secondary_code']],_0x32aa76=[_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x161)]],_0x54cd60=[_0x456e7b['body'][_0xb0e5d8(0x1b2)]],_0x567ca5=[_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1dc)]],_0x3f0d71=[_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x18a)]],_0x54db41=[_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x153)]],_0x22b7bb=[_0x456e7b[_0xb0e5d8(0x241)]['expiry_date']],_0x228663=[_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x187)]],_0x4c3e8e=[_0x456e7b['body'][_0xb0e5d8(0x1ff)]],_0x4985f8=[_0x456e7b[_0xb0e5d8(0x241)]['prod_cat']],_0x2ac1df=[_0x456e7b[_0xb0e5d8(0x241)]['RoomAssigned']],_0x34e880=[_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1fe)]],_0x40eb6f=[_0x456e7b[_0xb0e5d8(0x241)]['id_transaction_from']];else var _0x390b7e=[..._0x456e7b[_0xb0e5d8(0x241)]['product_name']],_0x4b3a61=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x220)]],_0x3ae0a7=[..._0x456e7b['body']['carton']],_0x19dc5a=[..._0x456e7b[_0xb0e5d8(0x241)]['primary_code']],_0x18dfb0=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1a3)]],_0x32aa76=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x161)]],_0x54cd60=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1b2)]],_0x567ca5=[..._0x456e7b[_0xb0e5d8(0x241)]['primary_unit']],_0x3f0d71=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x18a)]],_0x54db41=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x153)]],_0x22b7bb=[..._0x456e7b['body'][_0xb0e5d8(0x1d8)]],_0x228663=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x187)]],_0x4c3e8e=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1ff)]],_0x4985f8=[..._0x456e7b[_0xb0e5d8(0x241)]['prod_cat']],_0x2ac1df=[..._0x456e7b['body'][_0xb0e5d8(0x1c2)]],_0x34e880=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1fe)]],_0x40eb6f=[..._0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x23d)]];const _0x2e9699=_0x390b7e[_0xb0e5d8(0x21c)](_0x1c711e=>{return _0x1c711e={'product_name':_0x1c711e};});_0x4b3a61['forEach']((_0x2dbc32,_0x32561d)=>{_0x2e9699[_0x32561d]['stock']=_0x2dbc32;}),_0x3ae0a7[_0xb0e5d8(0x1e8)]((_0x1ed0b3,_0x463538)=>{var _0x5a12a6=_0xb0e5d8;_0x2e9699[_0x463538][_0x5a12a6(0x245)]=Math[_0x5a12a6(0x23f)](_0x1ed0b3);}),_0x40eb6f[_0xb0e5d8(0x1e8)]((_0x11ef93,_0x2b48be)=>{var _0x2ed5cc=_0xb0e5d8;_0x2e9699[_0x2b48be][_0x2ed5cc(0x23d)]=_0x11ef93;}),_0x19dc5a[_0xb0e5d8(0x1e8)]((_0x800267,_0x109260)=>{_0x2e9699[_0x109260]['primary_code']=_0x800267;}),_0x18dfb0[_0xb0e5d8(0x1e8)]((_0x4c7c2a,_0x373f1d)=>{_0x2e9699[_0x373f1d]['secondary_code']=_0x4c7c2a;}),_0x32aa76[_0xb0e5d8(0x1e8)]((_0x47e9f0,_0xc96dc5)=>{_0x2e9699[_0xc96dc5]['product_code']=_0x47e9f0;}),_0x54cd60[_0xb0e5d8(0x1e8)]((_0x5631f5,_0xf7095c)=>{var _0x4c6345=_0xb0e5d8;_0x2e9699[_0xf7095c][_0x4c6345(0x14b)]=_0x5631f5;}),_0x567ca5[_0xb0e5d8(0x1e8)]((_0x3c2b1b,_0x23d245)=>{var _0x4486dc=_0xb0e5d8;_0x2e9699[_0x23d245][_0x4486dc(0x18f)]=_0x3c2b1b;}),_0x3f0d71[_0xb0e5d8(0x1e8)]((_0x39bcc4,_0xce44e8)=>{var _0x5e6ab1=_0xb0e5d8;_0x2e9699[_0xce44e8][_0x5e6ab1(0x18a)]=_0x39bcc4;}),_0x54db41[_0xb0e5d8(0x1e8)]((_0x21b4fe,_0x22b054)=>{var _0x4b64db=_0xb0e5d8;_0x2e9699[_0x22b054][_0x4b64db(0x153)]=_0x21b4fe;}),_0x22b7bb['forEach']((_0x5878d1,_0x5161b4)=>{var _0x4b01d4=_0xb0e5d8;_0x2e9699[_0x5161b4][_0x4b01d4(0x1d8)]=_0x5878d1;}),_0x228663[_0xb0e5d8(0x1e8)]((_0x225fe9,_0x548773)=>{var _0x317616=_0xb0e5d8;_0x2e9699[_0x548773][_0x317616(0x1ab)]=_0x225fe9;}),_0x4c3e8e[_0xb0e5d8(0x1e8)]((_0x162534,_0x2d30a1)=>{var _0x599947=_0xb0e5d8;_0x2e9699[_0x2d30a1][_0x599947(0x171)]=_0x162534;}),_0x4985f8[_0xb0e5d8(0x1e8)]((_0x1dea3a,_0x43c1dd)=>{var _0x484466=_0xb0e5d8;_0x2e9699[_0x43c1dd][_0x484466(0x175)]=_0x1dea3a;}),_0x2ac1df['forEach']((_0x1b931a,_0x2e76ce)=>{var _0x176e64=_0xb0e5d8;_0x2e9699[_0x2e76ce][_0x176e64(0x15f)]=_0x1b931a;}),_0x34e880[_0xb0e5d8(0x1e8)]((_0x30731d,_0x4cb3c3)=>{var _0x42324b=_0xb0e5d8;_0x2e9699[_0x4cb3c3][_0x42324b(0x15a)]=_0x30731d;});var _0x42284a=0x0;_0x2e9699[_0xb0e5d8(0x1e8)](_0x57f797=>{var _0x27614d=_0xb0e5d8;parseFloat(_0x57f797['stock'])<parseFloat(_0x57f797[_0x27614d(0x245)])&&parseFloat(_0x57f797[_0x27614d(0x245)])>parseFloat(_0x57f797['stock'])&&(console[_0x27614d(0x1d5)](_0x57f797['stock']+_0x27614d(0x182)+_0x57f797[_0x27614d(0x245)]),_0x42284a++);});if(_0x42284a!=0x0)return _0x456e7b[_0xb0e5d8(0x247)](_0xb0e5d8(0x21e),_0xb0e5d8(0x145)),_0x34f9dc[_0xb0e5d8(0x176)](_0xb0e5d8(0x1fb));const _0x1700d9=_0x2e9699[_0xb0e5d8(0x151)](_0x156ac1=>_0x156ac1[_0xb0e5d8(0x245)]!=='0'&&_0x156ac1['quantity']!==''),_0x11091e=new sales_finished({'invoice':_0x3bca47,'customer':_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1d9)],'date':_0x409f8d,'warehouse_name':_0x1b5f57,'sale_product':_0x1700d9,'note':_0x38fdb8,'room':_0x5bb9f5,'primary_code':_0x2559ae,'secondary_code':_0x34a7d7,'prod_code':_0xc37cd1,'SCRN':_0x59d0f8,'finalize':'False','mode_transpo':_0x4ef856,'name_driver':_0x51d413}),_0x2f5a22=await _0x11091e[_0xb0e5d8(0x142)](),_0x4bb493=await sales_finished[_0xb0e5d8(0x192)]({'invoice':_0x3bca47}),_0x12f428=new c_payment_data({'invoice':_0x3bca47,'customer':_0x456e7b['body']['customer'],'reason':_0xb0e5d8(0x1c3)});await _0x12f428[_0xb0e5d8(0x142)]();const _0x57663f=await master_shop['find'](),_0x43092e=await email_settings[_0xb0e5d8(0x192)](),_0x293505=await customer[_0xb0e5d8(0x192)]({'name':_0x456e7b[_0xb0e5d8(0x241)][_0xb0e5d8(0x1d9)]});_0x57663f[0x0][_0xb0e5d8(0x190)]==0x1?(right_currency=_0x57663f[0x0][_0xb0e5d8(0x162)],left_currency=''):(right_currency='',left_currency=_0x57663f[0x0][_0xb0e5d8(0x162)]);var _0x460b72=_0x390b7e,_0x584367=_0x3ae0a7,_0x136e53='',_0x11b9d4;for(_0x11b9d4 in _0x460b72){_0x136e53+=_0xb0e5d8(0x244)+_0xb0e5d8(0x248)+_0x460b72[_0x11b9d4]+_0xb0e5d8(0x21d)+_0xb0e5d8(0x248)+_0x584367[_0x11b9d4]+_0xb0e5d8(0x21d)+_0xb0e5d8(0x24d);}console[_0xb0e5d8(0x1d5)]('product_list',_0x136e53);let _0x330b7e=nodemailer[_0xb0e5d8(0x1f9)]({'host':_0x43092e[_0xb0e5d8(0x20f)],'port':Number(_0x43092e['port']),'secure':![],'service':_0xb0e5d8(0x234),'auth':{'user':_0x43092e[_0xb0e5d8(0x224)],'pass':_0x43092e['password']}}),_0x204966={'from':_0x43092e[_0xb0e5d8(0x224)],'to':_0xb0e5d8(0x1a8),'subject':'Add\x20Sales','attachments':[{'filename':_0xb0e5d8(0x23e),'path':__dirname+_0xb0e5d8(0x1f2)+_0xb0e5d8(0x238)+_0x57663f[0x0][_0xb0e5d8(0x1f8)],'cid':_0xb0e5d8(0x242)}],'html':_0xb0e5d8(0x1b0)};_0x330b7e[_0xb0e5d8(0x16f)](_0x204966,function(_0x375bcd,_0x2390c7){var _0x20b1b4=_0xb0e5d8;_0x375bcd?(console[_0x20b1b4(0x1d5)](_0x375bcd),console[_0x20b1b4(0x1d5)]('Error\x20Occurs')):console[_0x20b1b4(0x1d5)](_0x20b1b4(0x199));}),_0x456e7b[_0xb0e5d8(0x247)](_0xb0e5d8(0x185),_0xb0e5d8(0x202)),_0x34f9dc['redirect'](_0xb0e5d8(0x24c)+_0x2f5a22[_0xb0e5d8(0x21b)]);}catch(_0x123a0b){console[_0xb0e5d8(0x1d5)](_0x123a0b);}}),router['get'](a0_0x2a4b90(0x204),auth,async(_0xa0123d,_0x5679e9)=>{var _0x2aea3f=a0_0x2a4b90;try{const {username:_0x574200,email:_0x584ad5,role:_0xdf9b4e}=_0xa0123d[_0x2aea3f(0x164)],_0x20de37=_0xa0123d[_0x2aea3f(0x164)],_0x4155f5=await profile[_0x2aea3f(0x192)]({'email':_0x20de37[_0x2aea3f(0x224)]}),_0x2d5059=await master_shop[_0x2aea3f(0x232)](),_0x3a8e18=_0xa0123d[_0x2aea3f(0x240)]['id'],_0x5b22f7=await sales_finished[_0x2aea3f(0x212)](_0x3a8e18),_0x196d95=await warehouse[_0x2aea3f(0x209)]([{'$match':{'name':_0x5b22f7[_0x2aea3f(0x230)]}},{'$unwind':_0x2aea3f(0x193)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2aea3f(0x19c)},'bay':{'$first':_0x2aea3f(0x1a0)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2aea3f(0x22f)},'floorlevel':{'$first':_0x2aea3f(0x1c7)},'primary_code':{'$first':_0x2aea3f(0x211)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2aea3f(0x17d)},'storage':{'$first':_0x2aea3f(0x1bb)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2aea3f(0x179)},'production_date':{'$first':_0x2aea3f(0x1e5)},'batch_code':{'$first':_0x2aea3f(0x1d0)},'room':{'$first':_0x2aea3f(0x1da)},'room_data':{'$first':'$product_details.room_name'}}}]),_0xbbd44f=await customer[_0x2aea3f(0x232)]({});let _0x3a1b8d;if(_0x20de37[_0x2aea3f(0x254)]=='staff'){const _0x494847=await staff[_0x2aea3f(0x192)]({'email':_0x20de37[_0x2aea3f(0x224)]});_0x3a1b8d=await warehouse['aggregate']([{'$match':{'status':_0x2aea3f(0x207),'name':_0x494847['warehouse']}},{'$group':{'_id':_0x2aea3f(0x1e2),'name':{'$first':'$name'}}}]);}else _0x3a1b8d=await warehouse['aggregate']([{'$match':{'status':_0x2aea3f(0x207)}},{'$group':{'_id':_0x2aea3f(0x1e2),'name':{'$first':_0x2aea3f(0x1e2)}}}]);const _0xa49b69=await product[_0x2aea3f(0x232)]({});if(_0x2d5059[0x0][_0x2aea3f(0x1ce)]==_0x2aea3f(0x1e9)){var _0x4547ba=users[_0x2aea3f(0x215)];console[_0x2aea3f(0x1d5)](_0x4547ba);}else{if(_0x2d5059[0x0][_0x2aea3f(0x1ce)]=='Hindi')var _0x4547ba=users[_0x2aea3f(0x203)];else{if(_0x2d5059[0x0][_0x2aea3f(0x1ce)]==_0x2aea3f(0x1d3))var _0x4547ba=users[_0x2aea3f(0x1d3)];else{if(_0x2d5059[0x0]['language']==_0x2aea3f(0x228))var _0x4547ba=users['Spanish'];else{if(_0x2d5059[0x0]['language']==_0x2aea3f(0x177))var _0x4547ba=users['French'];else{if(_0x2d5059[0x0][_0x2aea3f(0x1ce)]==_0x2aea3f(0x18b))var _0x4547ba=users[_0x2aea3f(0x24b)];else{if(_0x2d5059[0x0][_0x2aea3f(0x1ce)]==_0x2aea3f(0x216))var _0x4547ba=users['Chinese'];else{if(_0x2d5059[0x0][_0x2aea3f(0x1ce)]==_0x2aea3f(0x165))var _0x4547ba=users['Arabic'];}}}}}}}_0x5679e9[_0x2aea3f(0x1cf)](_0x2aea3f(0x19a),{'success':_0xa0123d[_0x2aea3f(0x247)](_0x2aea3f(0x185)),'errors':_0xa0123d[_0x2aea3f(0x247)](_0x2aea3f(0x21e)),'role':_0x20de37,'profile':_0x4155f5,'customer':_0xbbd44f,'warehouse':_0x3a1b8d,'product':_0x196d95,'user':_0x5b22f7,'master_shop':_0x2d5059,'unit':_0xa49b69,'language':_0x4547ba});}catch(_0x20e1c7){console[_0x2aea3f(0x1d5)](_0x20e1c7);}}),router[a0_0x2a4b90(0x141)]('/preview/:id',auth,async(_0x5242bd,_0x44e35e)=>{var _0x520f7b=a0_0x2a4b90;try{const _0x425a15=_0x5242bd[_0x520f7b(0x240)]['id'],{invoice:_0x4645ba,warehouse_name:_0x196f3b,room:_0x27296b}=_0x5242bd['body'],_0x2abc5b=await sales_finished['findOne']({'invoice':_0x4645ba}),_0x3aa15a=_0x2abc5b[_0x520f7b(0x201)]['map'](async _0x4fd088=>{var _0x467288=_0x520f7b,_0x2400b8=await warehouse[_0x467288(0x192)]({'name':_0x196f3b,'room':_0x4fd088[_0x467288(0x15f)],'warehouse_category':'Finished\x20Goods'});const _0x1cd390=_0x2400b8[_0x467288(0x22e)][_0x467288(0x21c)](_0x4d2a6c=>{var _0x1448e2=_0x467288;_0x4d2a6c['product_name']==_0x4fd088['product_name']&&_0x4d2a6c[_0x1448e2(0x14b)]==_0x4fd088['bay']&&_0x4d2a6c['expiry_date']==_0x4fd088[_0x1448e2(0x1d8)]&&_0x4d2a6c[_0x1448e2(0x1ab)]==_0x4fd088[_0x1448e2(0x1ab)]&&_0x4d2a6c[_0x1448e2(0x153)]==_0x4fd088[_0x1448e2(0x153)]&&_0x4d2a6c[_0x1448e2(0x21b)]==_0x4fd088[_0x1448e2(0x23d)]&&(_0x4d2a6c['product_stock']>0x0&&(console['log'](_0x4d2a6c[_0x1448e2(0x1b3)]+'\x20==\x20'+_0x4fd088['product_name']+'\x20&&\x20'+_0x4d2a6c['bay']+_0x1448e2(0x184)+_0x4fd088[_0x1448e2(0x14b)]+_0x1448e2(0x1f6)+_0x4d2a6c['production_date']+'\x20==\x20'+_0x4fd088[_0x1448e2(0x1ab)]+'\x20&&\x20'+_0x4d2a6c[_0x1448e2(0x1d8)]+_0x1448e2(0x184)+_0x4fd088[_0x1448e2(0x1d8)]+_0x1448e2(0x1f6)+_0x4d2a6c['batch_code']+'\x20==\x20'+_0x4fd088[_0x1448e2(0x153)]+_0x1448e2(0x1f6)+_0x4d2a6c[_0x1448e2(0x15a)]+_0x1448e2(0x184)+_0x4fd088[_0x1448e2(0x15a)]+_0x1448e2(0x1f6)+_0x4d2a6c[_0x1448e2(0x169)]+_0x1448e2(0x1e0)+_0x4fd088[_0x1448e2(0x245)]+_0x1448e2(0x166)+_0x4fd088[_0x1448e2(0x15f)]+_0x1448e2(0x1f6)+_0x4d2a6c[_0x1448e2(0x21b)]+_0x1448e2(0x184)+_0x4fd088[_0x1448e2(0x23d)]),_0x4d2a6c['product_stock']=Math['max'](0x0,Math[_0x1448e2(0x23f)](_0x4d2a6c[_0x1448e2(0x169)])-Math[_0x1448e2(0x23f)](_0x4fd088['quantity']))));});return _0x2400b8;});Promise[_0x520f7b(0x19e)](_0x3aa15a)['then'](async _0x2959c3=>{var _0x58101a=_0x520f7b;try{for(const _0x2173d7 of _0x2959c3){await _0x2173d7[_0x58101a(0x142)]();}_0x2abc5b['finalize']=_0x58101a(0x24a);const _0xead8e8=await _0x2abc5b[_0x58101a(0x142)](),_0x166631=await master_shop[_0x58101a(0x232)](),_0x206d0a=await email_settings[_0x58101a(0x192)](),_0x1bbdb4=await supervisor_settings['find']();var _0x48ae5d=_0x2abc5b[_0x58101a(0x201)],_0x27b9f7='',_0x4e2c16;for(_0x4e2c16 in _0x48ae5d){var _0x8a1bb3='FG';_0x2abc5b[_0x58101a(0x230)]=='DRY\x20GOODS'&&(_0x8a1bb3='DG'),_0x27b9f7+=_0x58101a(0x244)+_0x58101a(0x248)+_0x48ae5d[_0x4e2c16][_0x58101a(0x1b3)]+_0x58101a(0x21d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x48ae5d[_0x4e2c16]['product_code']+_0x58101a(0x21d)+_0x58101a(0x248)+_0x48ae5d[_0x4e2c16][_0x58101a(0x245)]+_0x58101a(0x21d)+_0x58101a(0x248)+_0x48ae5d[_0x4e2c16]['unit']+'</td>'+_0x58101a(0x248)+_0x48ae5d[_0x4e2c16]['secondary_unit']+_0x58101a(0x21d)+_0x58101a(0x248)+_0x2abc5b[_0x58101a(0x230)]+_0x58101a(0x21d)+_0x58101a(0x248)+_0x48ae5d[_0x4e2c16]['room_name']+_0x58101a(0x21d)+_0x58101a(0x248)+_0x8a1bb3+_0x48ae5d[_0x4e2c16][_0x58101a(0x14b)]+'</td>';}let _0x575232=nodemailer[_0x58101a(0x1f9)]({'host':_0x206d0a[_0x58101a(0x20f)],'port':Number(_0x206d0a[_0x58101a(0x259)]),'secure':![],'auth':{'user':_0x206d0a[_0x58101a(0x224)],'pass':_0x206d0a['password']}}),_0x46d474={'from':_0x206d0a[_0x58101a(0x224)],'to':_0x1bbdb4[0x0]['FGSEmail'],'subject':_0x58101a(0x19d),'attachments':[{'filename':_0x58101a(0x23e),'path':__dirname+_0x58101a(0x1f2)+_0x58101a(0x238)+_0x166631[0x0]['image'],'cid':'logo'}],'html':_0x58101a(0x158)+_0x58101a(0x143)+_0x58101a(0x18c)+_0x58101a(0x195)+_0x58101a(0x1c6)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x58101a(0x231)+'<div>'+_0x58101a(0x255)+_0x166631[0x0][_0x58101a(0x156)]+_0x58101a(0x160)+'</div>'+'</div>'+_0x58101a(0x1ad)+_0x58101a(0x195)+_0x58101a(0x1bf)+'\x20Order\x20Number\x20:\x20'+_0x2abc5b[_0x58101a(0x15a)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x58101a(0x1e7)+_0x2abc5b['date']+'\x20'+'</span>'+'</h5>'+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x58101a(0x1d7)+_0x58101a(0x244)+_0x58101a(0x237)+_0x58101a(0x217)+_0x58101a(0x235)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x58101a(0x226)+_0x58101a(0x1c5)+_0x58101a(0x144)+_0x58101a(0x210)+_0x58101a(0x24d)+_0x58101a(0x15c)+_0x58101a(0x1a2)+'\x20'+_0x27b9f7+'\x20'+_0x58101a(0x1bc)+_0x58101a(0x1fa)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x166631[0x0]['site_title']+_0x58101a(0x22d)+_0x58101a(0x231)+_0x58101a(0x231)+_0x58101a(0x140)};_0x575232[_0x58101a(0x16f)](_0x46d474,function(_0x11d6de,_0x542f66){var _0x3faca2=_0x58101a;_0x11d6de?(console[_0x3faca2(0x1d5)](_0x11d6de),console[_0x3faca2(0x1d5)](_0x3faca2(0x1f7))):console[_0x3faca2(0x1d5)]('Email\x20sent\x20successfully');}),_0x5242bd[_0x58101a(0x247)]('success',_0x58101a(0x16a)),_0x44e35e[_0x58101a(0x176)]('/picking_list/pdf/'+_0x425a15);}catch(_0xe8f87){console[_0x58101a(0x1ef)](_0xe8f87),_0x44e35e[_0x58101a(0x223)](0x1f4)[_0x58101a(0x1cb)]({'error':_0x58101a(0x150)});}})[_0x520f7b(0x1a6)](_0x5c4fa1=>{var _0x4e524d=_0x520f7b;console[_0x4e524d(0x1ef)](_0x5c4fa1),_0x44e35e[_0x4e524d(0x223)](0x1f4)[_0x4e524d(0x1cb)]({'error':_0x4e524d(0x258)});});}catch(_0x17bdb1){console[_0x520f7b(0x1d5)](_0x17bdb1);}}),router['get'](a0_0x2a4b90(0x205),auth,async(_0xaa789c,_0x3b88a1)=>{var _0x5c9893=a0_0x2a4b90;try{const {username:_0x3de7c0,email:_0x4166ef,role:_0x28f742}=_0xaa789c[_0x5c9893(0x164)],_0x3ef1d6=_0xaa789c[_0x5c9893(0x164)],_0x218b66=await profile[_0x5c9893(0x192)]({'email':_0x3ef1d6[_0x5c9893(0x224)]}),_0x5d5069=await master_shop[_0x5c9893(0x232)](),_0x1fceaf=_0xaa789c[_0x5c9893(0x240)]['id'],_0x248570=await sales_finished[_0x5c9893(0x212)](_0x1fceaf);let _0x23712f=new Date(_0x248570[_0x5c9893(0x1d8)]),_0x5d0d30=('0'+_0x23712f['getDate']())[_0x5c9893(0x15e)](-0x2),_0x171d4c=('0'+(_0x23712f[_0x5c9893(0x1db)]()+0x1))[_0x5c9893(0x15e)](-0x2),_0x2d73d3=_0x23712f[_0x5c9893(0x251)](),_0x23a227=_0x2d73d3+'-'+_0x171d4c+'-'+_0x5d0d30;var _0x293d97=[_0x5c9893(0x149),'Enclosed'];const _0x428c74=await warehouse[_0x5c9893(0x209)]([{'$match':{'name':_0x248570[_0x5c9893(0x230)],'room':_0x248570[_0x5c9893(0x178)]}},{'$unwind':_0x5c9893(0x193)},{'$group':{'_id':_0x5c9893(0x1de),'name':{'$first':_0x5c9893(0x20e)},'product_stock':{'$first':_0x5c9893(0x19c)},'bay':{'$first':_0x5c9893(0x1a0)},'bin':{'$first':_0x5c9893(0x159)},'type':{'$first':_0x5c9893(0x22f)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x5c9893(0x211)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5c9893(0x173)}}}]),_0xee406c=await customer['find']({});let _0x155765;if(_0x3ef1d6[_0x5c9893(0x254)]==_0x5c9893(0x170)){const _0x2e5a2d=await staff[_0x5c9893(0x192)]({'email':_0x3ef1d6[_0x5c9893(0x224)]});_0x155765=await warehouse[_0x5c9893(0x209)]([{'$match':{'status':_0x5c9893(0x207),'name':_0x2e5a2d[_0x5c9893(0x1f5)]}},{'$group':{'_id':'$name','name':{'$first':_0x5c9893(0x1e2)}}}]);}else _0x155765=await warehouse['aggregate']([{'$match':{'status':_0x5c9893(0x207)}},{'$group':{'_id':_0x5c9893(0x1e2),'name':{'$first':'$name'}}}]);const _0x2f1844=await product[_0x5c9893(0x232)]({});if(_0x5d5069[0x0][_0x5c9893(0x1ce)]==_0x5c9893(0x1e9)){var _0x168c43=users[_0x5c9893(0x215)];console['log'](_0x168c43);}else{if(_0x5d5069[0x0]['language']==_0x5c9893(0x203))var _0x168c43=users['Hindi'];else{if(_0x5d5069[0x0][_0x5c9893(0x1ce)]==_0x5c9893(0x1d3))var _0x168c43=users[_0x5c9893(0x1d3)];else{if(_0x5d5069[0x0][_0x5c9893(0x1ce)]==_0x5c9893(0x228))var _0x168c43=users[_0x5c9893(0x228)];else{if(_0x5d5069[0x0][_0x5c9893(0x1ce)]=='French')var _0x168c43=users[_0x5c9893(0x177)];else{if(_0x5d5069[0x0][_0x5c9893(0x1ce)]=='Portuguese\x20(BR)')var _0x168c43=users[_0x5c9893(0x24b)];else{if(_0x5d5069[0x0][_0x5c9893(0x1ce)]==_0x5c9893(0x216))var _0x168c43=users[_0x5c9893(0x216)];else{if(_0x5d5069[0x0][_0x5c9893(0x1ce)]==_0x5c9893(0x165))var _0x168c43=users['Arabic'];}}}}}}}_0x3b88a1[_0x5c9893(0x1cf)](_0x5c9893(0x22a),{'success':_0xaa789c['flash'](_0x5c9893(0x185)),'errors':_0xaa789c[_0x5c9893(0x247)](_0x5c9893(0x21e)),'role':_0x3ef1d6,'profile':_0x218b66,'customer':_0xee406c,'warehouse':_0x155765,'product':_0x428c74,'user':_0x248570,'master_shop':_0x5d5069,'unit':_0x2f1844,'language':_0x168c43,'rooms_data':_0x293d97,'ed_fullDate':_0x23a227});}catch(_0x31deab){console[_0x5c9893(0x1d5)](_0x31deab);}}),router['post'](a0_0x2a4b90(0x205),auth,async(_0x389a74,_0x580268)=>{var _0x486e52=a0_0x2a4b90;try{const _0x3482e6=_0x389a74[_0x486e52(0x240)]['id'],_0x47a32b=await sales_finished[_0x486e52(0x192)]({'_id':_0x389a74['params']['id']}),_0x4c5ec3=await warehouse[_0x486e52(0x192)]({'name':_0x47a32b[_0x486e52(0x230)],'room':_0x389a74[_0x486e52(0x241)][_0x486e52(0x178)],'warehouse_category':_0x486e52(0x14c)}),{invoice:_0x31add9,customer:_0x4292d2,date:_0x2f75ab,warehouse_name:_0x1d6831,product_name:_0xc5aa1b,stock:_0x38cad8,adjust_qty:_0x574a46,note:_0x5b452a,room:_0x25463d,primary_code:_0x37f032,secondary_code:_0x39cbe9,prod_code:_0x4130e7,level:_0xd1dc47,isle:_0x18169b,pallet:_0x4deaff,expiry_date:_0xf69a2f}=_0x389a74[_0x486e52(0x241)];if(typeof _0xc5aa1b==_0x486e52(0x163))var _0x25e56b=[_0x389a74['body'][_0x486e52(0x1b3)]],_0x5f1e09=[_0x389a74['body'][_0x486e52(0x220)]],_0x32ce21=[_0x389a74[_0x486e52(0x241)][_0x486e52(0x21a)]],_0x1245d5=[_0x389a74['body'][_0x486e52(0x219)]],_0x571a74=[_0x389a74[_0x486e52(0x241)][_0x486e52(0x1a3)]],_0xd59c99=[_0x389a74['body'][_0x486e52(0x161)]],_0x549c7e=[_0x389a74['body'][_0x486e52(0x1b2)]],_0x240679=[_0x389a74[_0x486e52(0x241)]['expiry_date']];else var _0x25e56b=[..._0x389a74[_0x486e52(0x241)][_0x486e52(0x1b3)]],_0x5f1e09=[..._0x389a74[_0x486e52(0x241)][_0x486e52(0x220)]],_0x32ce21=[..._0x389a74[_0x486e52(0x241)]['adjust_qty']],_0x1245d5=[..._0x389a74[_0x486e52(0x241)][_0x486e52(0x219)]],_0x571a74=[..._0x389a74['body'][_0x486e52(0x1a3)]],_0xd59c99=[..._0x389a74[_0x486e52(0x241)][_0x486e52(0x161)]],_0x549c7e=[..._0x389a74['body']['level']],_0x240679=[..._0x389a74['body']['expiry_date']];const _0x46d021=_0x25e56b['map'](_0x5286c7=>{return _0x5286c7={'product_name':_0x5286c7};});_0x5f1e09['forEach']((_0xa5b32d,_0x3d99d6)=>{var _0x4040b2=_0x486e52;_0x46d021[_0x3d99d6][_0x4040b2(0x220)]=_0xa5b32d;}),_0x32ce21[_0x486e52(0x1e8)]((_0x207e9a,_0x4cbf33)=>{var _0x38f036=_0x486e52;_0x46d021[_0x4cbf33][_0x38f036(0x245)]=_0x207e9a;}),_0x1245d5[_0x486e52(0x1e8)]((_0x57e652,_0x180fa5)=>{var _0x30c1fd=_0x486e52;_0x46d021[_0x180fa5][_0x30c1fd(0x219)]=_0x57e652;}),_0x571a74[_0x486e52(0x1e8)]((_0x32b2cf,_0x5d93a6)=>{var _0x231172=_0x486e52;_0x46d021[_0x5d93a6][_0x231172(0x1a3)]=_0x32b2cf;}),_0xd59c99[_0x486e52(0x1e8)]((_0x1df042,_0x3a6572)=>{var _0xd258f1=_0x486e52;_0x46d021[_0x3a6572][_0xd258f1(0x1cd)]=_0x1df042;}),_0x549c7e['forEach']((_0x71eaec,_0x5ead7a)=>{var _0x557b22=_0x486e52;_0x46d021[_0x5ead7a][_0x557b22(0x1b2)]=_0x71eaec;}),_0x240679[_0x486e52(0x1e8)]((_0x5c9730,_0x13505c)=>{var _0x59aa68=_0x486e52;_0x46d021[_0x13505c][_0x59aa68(0x1d8)]=_0x5c9730;});var _0x33d58d=0x0;_0x46d021[_0x486e52(0x1e8)](_0x32a9c9=>{var _0x5adf1b=_0x486e52;console[_0x5adf1b(0x1d5)](_0x5adf1b(0x1e6),_0x32a9c9),(parseInt(_0x32a9c9[_0x5adf1b(0x220)])<parseInt(_0x32a9c9[_0x5adf1b(0x245)])||parseInt(_0x32a9c9[_0x5adf1b(0x245)])==0x0)&&_0x33d58d++;});if(_0x33d58d!=0x0)return _0x389a74['flash'](_0x486e52(0x21e),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x580268[_0x486e52(0x176)](_0x486e52(0x1fb));_0x47a32b[_0x486e52(0x201)][_0x486e52(0x1e8)](_0x12c6a4=>{var _0x3cbbc7=_0x486e52;const _0x2ffedd=_0x4c5ec3[_0x3cbbc7(0x22e)][_0x3cbbc7(0x21c)](_0x4fdc34=>{var _0x646b1b=_0x3cbbc7;_0x4fdc34[_0x646b1b(0x1b3)]==_0x12c6a4[_0x646b1b(0x1b3)]&&_0x4fdc34[_0x646b1b(0x14b)]==_0x12c6a4[_0x646b1b(0x14b)]&&(_0x4fdc34[_0x646b1b(0x169)]=parseInt(_0x4fdc34['product_stock'])+parseInt(_0x12c6a4[_0x646b1b(0x245)]));});}),await _0x4c5ec3[_0x486e52(0x142)]();const _0x27c76f=_0x46d021[_0x486e52(0x151)](_0x19dcca=>_0x19dcca['quantity']!=='0'&&_0x19dcca['quantity']!=='');_0x47a32b[_0x486e52(0x15a)]=_0x31add9,_0x47a32b[_0x486e52(0x1d9)]=_0x4292d2,_0x47a32b['date']=_0x2f75ab,_0x47a32b[_0x486e52(0x230)]=_0x1d6831,_0x47a32b[_0x486e52(0x201)]=_0x27c76f,_0x47a32b[_0x486e52(0x246)]=_0x5b452a,_0x47a32b[_0x486e52(0x178)]=_0x25463d;const _0x268d4e=await _0x47a32b[_0x486e52(0x142)](),_0x36a729=await sales_finished['findOne']({'_id':_0x389a74['params']['id']}),_0x2431e7=await warehouse[_0x486e52(0x192)]({'name':_0x1d6831,'room':_0x25463d,'warehouse_category':'Finished\x20Goods'});_0x36a729[_0x486e52(0x201)][_0x486e52(0x1e8)](_0x496ac5=>{var _0x201012=_0x486e52;const _0x48cafe=_0x2431e7[_0x201012(0x22e)][_0x201012(0x21c)](_0x576299=>{var _0x13ac24=_0x201012;_0x576299[_0x13ac24(0x1b3)]==_0x496ac5['product_name']&&_0x576299[_0x13ac24(0x14b)]==_0x496ac5[_0x13ac24(0x14b)]&&(_0x576299[_0x13ac24(0x169)]=parseInt(_0x576299[_0x13ac24(0x169)])-parseInt(_0x496ac5['quantity']));});}),console[_0x486e52(0x1d5)](_0x486e52(0x218),_0x2431e7),await _0x2431e7[_0x486e52(0x142)]();const _0x289ebf=await c_payment_data[_0x486e52(0x192)]({'invoice':_0x389a74[_0x486e52(0x241)][_0x486e52(0x15a)]});_0x289ebf[_0x486e52(0x1b5)]=_0x389a74[_0x486e52(0x241)]['suppliers'],await _0x289ebf[_0x486e52(0x142)](),_0x389a74[_0x486e52(0x247)]('success',_0x486e52(0x16a)),_0x580268[_0x486e52(0x176)](_0x486e52(0x183));}catch(_0x224861){console[_0x486e52(0x1d5)](_0x224861);}}),router[a0_0x2a4b90(0x141)](a0_0x2a4b90(0x1f0),auth,async(_0x4de6e0,_0x254d9a)=>{var _0x24c243=a0_0x2a4b90;try{const _0x4f34f2=_0x4de6e0['params']['id'],{invoice:_0x661a5f,customer:_0x273643,receivable_amount:_0x18a18f,received_amount:_0x368751}=_0x4de6e0['body'],_0x1c737a=await sales[_0x24c243(0x212)](_0x4f34f2);console[_0x24c243(0x1d5)](_0x1c737a);var _0x3186ea=_0x18a18f-_0x368751;console[_0x24c243(0x1d5)](_0x368751),_0x1c737a[_0x24c243(0x1ca)]=parseFloat(_0x368751)+parseFloat(_0x1c737a[_0x24c243(0x1ca)]),_0x1c737a[_0x24c243(0x213)]=_0x3186ea,console[_0x24c243(0x1d5)](_0x1c737a);const _0x5da66f=await _0x1c737a[_0x24c243(0x142)](),_0x4e0d24=await c_payment_data[_0x24c243(0x192)]({'invoice':_0x661a5f});_0x4e0d24[_0x24c243(0x229)]=_0x3186ea,await _0x4e0d24[_0x24c243(0x142)]();let _0xcdf2c9=new Date(),_0x469b13=('0'+_0xcdf2c9[_0x24c243(0x1b6)]())['slice'](-0x2),_0x100850=('0'+(_0xcdf2c9[_0x24c243(0x1db)]()+0x1))['slice'](-0x2),_0x5d67af=_0xcdf2c9[_0x24c243(0x251)](),_0x3c7a2d=_0x5d67af+'-'+_0x100850+'-'+_0x469b13;const _0x41996a=new customer_payment({'invoice':_0x661a5f,'date':_0x5d67af+'-'+_0x100850+'-'+_0x469b13,'customer':_0x273643,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x368751}),_0x362786=await _0x41996a['save']();_0x4de6e0[_0x24c243(0x247)]('success','payment\x20successfull'),_0x254d9a[_0x24c243(0x176)](_0x24c243(0x1b1));}catch(_0x452177){console[_0x24c243(0x1d5)](_0x452177);}}),router[a0_0x2a4b90(0x222)]('/invoice/:id',auth,async(_0x5da981,_0x5b1bbb)=>{var _0x132ebf=a0_0x2a4b90;try{const {username:_0x524b03,email:_0x105ee0,role:_0x2912e1}=_0x5da981[_0x132ebf(0x164)],_0x2a4859=_0x5da981[_0x132ebf(0x164)],_0x42013a=await profile[_0x132ebf(0x192)]({'email':_0x2a4859['email']}),_0x4edfea=await master_shop[_0x132ebf(0x232)]();console['log'](_0x132ebf(0x1ec),_0x4edfea);const _0x203e9d=_0x5da981['params']['id'],_0x2e5c56=await sales['findById'](_0x203e9d);console[_0x132ebf(0x1d5)](_0x2e5c56);const _0x5f33d1=await customer['findOne']({'name':_0x2e5c56[_0x132ebf(0x1d9)]});console[_0x132ebf(0x1d5)](_0x5f33d1);if(_0x4edfea[0x0]['language']==_0x132ebf(0x1e9)){var _0x2446e9=users[_0x132ebf(0x215)];console['log'](_0x2446e9);}else{if(_0x4edfea[0x0]['language']==_0x132ebf(0x203))var _0x2446e9=users[_0x132ebf(0x203)];else{if(_0x4edfea[0x0][_0x132ebf(0x1ce)]==_0x132ebf(0x1d3))var _0x2446e9=users[_0x132ebf(0x1d3)];else{if(_0x4edfea[0x0]['language']=='Spanish')var _0x2446e9=users['Spanish'];else{if(_0x4edfea[0x0][_0x132ebf(0x1ce)]==_0x132ebf(0x177))var _0x2446e9=users['French'];else{if(_0x4edfea[0x0]['language']==_0x132ebf(0x18b))var _0x2446e9=users[_0x132ebf(0x24b)];else{if(_0x4edfea[0x0][_0x132ebf(0x1ce)]==_0x132ebf(0x216))var _0x2446e9=users[_0x132ebf(0x216)];else{if(_0x4edfea[0x0][_0x132ebf(0x1ce)]==_0x132ebf(0x165))var _0x2446e9=users[_0x132ebf(0x196)];}}}}}}}_0x5b1bbb['render'](_0x132ebf(0x25b),{'success':_0x5da981[_0x132ebf(0x247)](_0x132ebf(0x185)),'errors':_0x5da981['flash'](_0x132ebf(0x21e)),'role':_0x2a4859,'profile':_0x42013a,'master_shop':_0x4edfea,'customers':_0x5f33d1,'sales':_0x2e5c56,'language':_0x2446e9});}catch(_0x145953){console['log'](_0x145953);}}),router['get'](a0_0x2a4b90(0x154),auth,async(_0x573209,_0x2702c2)=>{var _0x2f006c=a0_0x2a4b90;try{const {username:_0x245473,email:_0x197577,role:_0x31f7e8}=_0x573209['user'],_0xb06d74=_0x573209[_0x2f006c(0x164)],_0xe0f7bb=await profile[_0x2f006c(0x192)]({'email':_0xb06d74[_0x2f006c(0x224)]}),_0x1a704c=await master_shop[_0x2f006c(0x232)](),_0x442b3b=_0x573209[_0x2f006c(0x240)]['id'],_0x16efa7=await sales_finished[_0x2f006c(0x212)](_0x442b3b),_0x282f54=await warehouse[_0x2f006c(0x209)]([{'$match':{'name':_0x16efa7['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2f006c(0x20e)},'product_stock':{'$first':_0x2f006c(0x19c)},'bay':{'$first':_0x2f006c(0x1a0)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2f006c(0x22f)},'floorlevel':{'$first':_0x2f006c(0x1c7)},'primary_code':{'$first':_0x2f006c(0x211)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2f006c(0x17d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2f006c(0x1e5)},'unit':{'$first':_0x2f006c(0x1a9)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x2f006c(0x253)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x2f006c(0x18e)}}}]),_0x39cbe3=await product[_0x2f006c(0x232)]({}),_0x11dc0d=await warehouse[_0x2f006c(0x209)]([{'$match':{'status':_0x2f006c(0x207),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x2f006c(0x17b),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x2f006c(0x1e2),'name':{'$first':_0x2f006c(0x1e2)}}},{'$sort':{'name':0x1}}]);var _0x3f2e6f=[_0x2f006c(0x236)];const _0x4e7917=await warehouse[_0x2f006c(0x209)]([{'$match':{'status':_0x2f006c(0x207),'name':_0x2f006c(0x1dd)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x1a704c[0x0]['language']==_0x2f006c(0x1e9)){var _0x26e79a=users['English'];console[_0x2f006c(0x1d5)](_0x26e79a);}else{if(_0x1a704c[0x0][_0x2f006c(0x1ce)]==_0x2f006c(0x203))var _0x26e79a=users[_0x2f006c(0x203)];else{if(_0x1a704c[0x0][_0x2f006c(0x1ce)]==_0x2f006c(0x1d3))var _0x26e79a=users[_0x2f006c(0x1d3)];else{if(_0x1a704c[0x0][_0x2f006c(0x1ce)]=='Spanish')var _0x26e79a=users[_0x2f006c(0x228)];else{if(_0x1a704c[0x0]['language']==_0x2f006c(0x177))var _0x26e79a=users['French'];else{if(_0x1a704c[0x0][_0x2f006c(0x1ce)]==_0x2f006c(0x18b))var _0x26e79a=users['Portuguese'];else{if(_0x1a704c[0x0][_0x2f006c(0x1ce)]=='Chinese')var _0x26e79a=users[_0x2f006c(0x216)];else{if(_0x1a704c[0x0][_0x2f006c(0x1ce)]==_0x2f006c(0x165))var _0x26e79a=users['Arabic'];}}}}}}}_0x2702c2[_0x2f006c(0x1cf)]('return_sale_finished',{'success':_0x573209[_0x2f006c(0x247)]('success'),'errors':_0x573209[_0x2f006c(0x247)]('errors'),'role':_0xb06d74,'profile':_0xe0f7bb,'user':_0x16efa7,'stock':_0x282f54,'master_shop':_0x1a704c,'unit':_0x39cbe3,'language':_0x26e79a,'warehouses':_0x11dc0d,'rooms':_0x3f2e6f,'warehouse_QA':_0x4e7917});}catch(_0x4a7013){console[_0x2f006c(0x1d5)](_0x4a7013),_0x2702c2[_0x2f006c(0x223)](0xc8)[_0x2f006c(0x1cb)]({'message':_0x4a7013[_0x2f006c(0x25a)]});}}),router[a0_0x2a4b90(0x141)](a0_0x2a4b90(0x154),auth,async(_0x35cbe5,_0x76070a)=>{var _0x2ea0f5=a0_0x2a4b90;if(_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x225)]=='QA')try{const {invoice:_0x4093c4,date:_0x553551,warehouse_name:_0x3e4ee9,product_name:_0x3d9ae4,primary_code:_0x4a72ee,secondary_code:_0x27b4fe,product_code:_0x353175,sales_quantity:_0x16ae9d,stocks:_0x47b852,return_qty:_0x2c7dcb,Room_name:_0x189d89,to_warehouse_name_QA:_0x33aeb2,to_Room_name_QA:_0x1b2d6b,note:_0x20f83c,for_categorize:_0x3cbeb6,product_name_QA1:_0x2d5bde}=_0x35cbe5[_0x2ea0f5(0x241)];if(typeof _0x2d5bde==_0x2ea0f5(0x163))var _0x377265=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x249)]],_0x4de794=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x16e)]],_0x2934fe=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x208)]],_0x513a17=[_0x35cbe5['body']['product_code_QA']],_0x590644=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1e4)]],_0x4416de=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x167)]],_0x303551=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x23b)]],_0x3be23b=[_0x35cbe5[_0x2ea0f5(0x241)]['maxPerUnit_QA']],_0x44f827=[_0x35cbe5[_0x2ea0f5(0x241)]['maxProducts_QA']],_0x15102f=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x155)]],_0x58b95d=[_0x35cbe5[_0x2ea0f5(0x241)]['secondary_unit_QA']],_0x4d7668=[_0x35cbe5['body'][_0x2ea0f5(0x19b)]],_0x40f485=[_0x35cbe5[_0x2ea0f5(0x241)]['production_date_QA']],_0x542d7b=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1c9)]];else var _0x377265=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x249)]],_0x4de794=[..._0x35cbe5['body'][_0x2ea0f5(0x16e)]],_0x2934fe=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x208)]],_0x513a17=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1ea)]],_0x590644=[..._0x35cbe5['body']['sales_quantity_QA']],_0x4416de=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x167)]],_0x303551=[..._0x35cbe5['body'][_0x2ea0f5(0x23b)]],_0x3be23b=[..._0x35cbe5['body'][_0x2ea0f5(0x147)]],_0x44f827=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1fd)]],_0x15102f=[..._0x35cbe5['body'][_0x2ea0f5(0x155)]],_0x58b95d=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x250)]],_0x4d7668=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x19b)]],_0x40f485=[..._0x35cbe5['body']['production_date_QA']],_0x542d7b=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1c9)]];const _0x4dd40a=_0x377265[_0x2ea0f5(0x21c)](_0x18cdf9=>{return _0x18cdf9={'product_name':_0x18cdf9};});_0x4de794[_0x2ea0f5(0x1e8)]((_0x15cabc,_0x2ab709)=>{_0x4dd40a[_0x2ab709]['primary_code']=_0x15cabc;}),_0x2934fe[_0x2ea0f5(0x1e8)]((_0xe47a3b,_0x5b7373)=>{_0x4dd40a[_0x5b7373]['secondary_code']=_0xe47a3b;}),_0x513a17['forEach']((_0x44ec0f,_0x199621)=>{var _0xd3b998=_0x2ea0f5;_0x4dd40a[_0x199621][_0xd3b998(0x1cd)]=_0x44ec0f;}),_0x590644['forEach']((_0xb8e8c5,_0x364d9b)=>{var _0x589a3d=_0x2ea0f5;_0x4dd40a[_0x364d9b][_0x589a3d(0x1e1)]=_0xb8e8c5;}),_0x4416de['forEach']((_0x57b5d7,_0x487b6e)=>{var _0x567af0=_0x2ea0f5;_0x4dd40a[_0x487b6e][_0x567af0(0x220)]=_0x57b5d7;}),_0x303551['forEach']((_0x52edb7,_0x2ecc69)=>{var _0x3ad1dd=_0x2ea0f5;_0x4dd40a[_0x2ecc69][_0x3ad1dd(0x148)]=_0x52edb7;}),_0x3be23b[_0x2ea0f5(0x1e8)]((_0x554910,_0x1de6be)=>{var _0x5ae5ed=_0x2ea0f5;_0x4dd40a[_0x1de6be][_0x5ae5ed(0x1a1)]=_0x554910;}),_0x44f827[_0x2ea0f5(0x1e8)]((_0x541e48,_0x3598f9)=>{_0x4dd40a[_0x3598f9]['maxProducts']=_0x541e48;}),_0x15102f[_0x2ea0f5(0x1e8)]((_0x46add6,_0x42a828)=>{_0x4dd40a[_0x42a828]['batch_code']=_0x46add6;}),_0x58b95d[_0x2ea0f5(0x1e8)]((_0x116402,_0x3e0da1)=>{var _0x28a53f=_0x2ea0f5;_0x4dd40a[_0x3e0da1][_0x28a53f(0x18a)]=_0x116402;}),_0x4d7668[_0x2ea0f5(0x1e8)]((_0x38cd79,_0x4afcfa)=>{var _0x15691b=_0x2ea0f5;_0x4dd40a[_0x4afcfa][_0x15691b(0x18f)]=_0x38cd79;}),_0x40f485['forEach']((_0x56be03,_0xc97fc2)=>{_0x4dd40a[_0xc97fc2]['production_date']=_0x56be03;}),_0x542d7b[_0x2ea0f5(0x1e8)]((_0x3057d7,_0x495a38)=>{var _0x657dc7=_0x2ea0f5;_0x4dd40a[_0x495a38][_0x657dc7(0x1d8)]=_0x3057d7;});const _0x36f4a3=await sales_finished[_0x2ea0f5(0x192)]({'invoice':_0x4093c4});_0x36f4a3[_0x2ea0f5(0x17e)]='True';const _0x12093c=await _0x36f4a3[_0x2ea0f5(0x142)](),_0xe52ab8=new sales_return_finished({'invoice':_0x4093c4,'customer':_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1d9)],'date':_0x553551,'warehouse_name':_0x3e4ee9,'room':_0x189d89,'ToWarehouse':_0x33aeb2,'ToRoom':_0x1b2d6b,'return_sale_QA':_0x4dd40a,'note':_0x20f83c,'warehouse_cat':_0x3cbeb6}),_0x47142f=await _0xe52ab8[_0x2ea0f5(0x142)](),_0x162c71=await sales_return_finished[_0x2ea0f5(0x192)]({'invoice':_0x4093c4}),_0x52f679=await warehouse[_0x2ea0f5(0x192)]({'name':_0x33aeb2,'room':_0x1b2d6b});_0x162c71[_0x2ea0f5(0x1a7)][_0x2ea0f5(0x1e8)](_0x30d992=>{var _0x2b200b=_0x2ea0f5,_0x1297e5=0x0;const _0x4aceb0=_0x52f679[_0x2b200b(0x22e)][_0x2b200b(0x21c)](_0x273c98=>{var _0x444361=_0x2b200b;_0x273c98[_0x444361(0x1b3)]==_0x30d992['product_name']&&_0x273c98['expiry_date']==_0x30d992[_0x444361(0x1d8)]&&_0x273c98['production_date']==_0x30d992[_0x444361(0x1ab)]&&_0x273c98[_0x444361(0x153)]==_0x30d992[_0x444361(0x153)]&&(_0x273c98[_0x444361(0x169)]=parseInt(_0x273c98['product_stock'])+parseInt(_0x30d992[_0x444361(0x148)]),_0x1297e5++);});_0x1297e5=='0'&&(_0x52f679[_0x2b200b(0x22e)]=_0x52f679[_0x2b200b(0x22e)][_0x2b200b(0x1c8)]({'product_name':_0x30d992[_0x2b200b(0x1b3)],'product_stock':_0x30d992[_0x2b200b(0x148)],'primary_code':_0x30d992[_0x2b200b(0x219)],'secondary_code':_0x30d992[_0x2b200b(0x1a3)],'product_code':_0x30d992[_0x2b200b(0x1cd)],'batch_code':_0x30d992[_0x2b200b(0x153)],'maxPerUnit':_0x30d992['maxPerUnit'],'production_date':_0x30d992['production_date'],'expiry_date':_0x30d992[_0x2b200b(0x1d8)],'secondary_unit':_0x30d992['secondary_unit'],'unit':_0x30d992[_0x2b200b(0x18f)],'maxProducts':_0x30d992['maxProducts'],'bay':_0x30d992[_0x2b200b(0x14b)]}));}),await _0x52f679[_0x2ea0f5(0x142)]();const _0x59955d=new c_payment_data({'invoice':_0x4093c4,'customer':_0x35cbe5[_0x2ea0f5(0x241)]['customer'],'reason':_0x2ea0f5(0x1be)});await _0x59955d['save']();const _0x372da4=await master_shop[_0x2ea0f5(0x232)](),_0x5bc955=await email_settings['findOne'](),_0x27df99=await customer[_0x2ea0f5(0x192)]({'name':_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1d9)]});_0x372da4[0x0]['currency_placement']==0x1?(right_currency=_0x372da4[0x0][_0x2ea0f5(0x162)],left_currency=''):(right_currency='',left_currency=_0x372da4[0x0][_0x2ea0f5(0x162)]);var _0x76957f=_0x377265,_0x10b18e=_0x303551,_0x3c59a7='',_0x4da6a8;for(_0x4da6a8 in _0x76957f){_0x3c59a7+=_0x2ea0f5(0x244)+_0x2ea0f5(0x248)+_0x76957f[_0x4da6a8]+_0x2ea0f5(0x21d)+_0x2ea0f5(0x248)+_0x10b18e[_0x4da6a8]+_0x2ea0f5(0x21d)+'</tr>';}console[_0x2ea0f5(0x1d5)]('product_list',_0x3c59a7);let _0x56a4fd=nodemailer[_0x2ea0f5(0x1f9)]({'service':_0x2ea0f5(0x234),'auth':{'user':_0x5bc955[_0x2ea0f5(0x224)],'pass':_0x5bc955[_0x2ea0f5(0x1fc)]}}),_0x2d47dd={'from':_0x5bc955[_0x2ea0f5(0x224)],'to':_0x27df99['email'],'subject':_0x2ea0f5(0x1ba),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2ea0f5(0x1f2)+_0x2ea0f5(0x238)+_0x372da4[0x0][_0x2ea0f5(0x1f8)],'cid':'logo'}],'html':_0x2ea0f5(0x158)+_0x2ea0f5(0x143)+_0x2ea0f5(0x18c)+'<div>'+_0x2ea0f5(0x1c6)+'<div>'+_0x2ea0f5(0x197)+'</div>'+_0x2ea0f5(0x195)+_0x2ea0f5(0x255)+_0x372da4[0x0]['site_title']+_0x2ea0f5(0x160)+_0x2ea0f5(0x231)+_0x2ea0f5(0x231)+_0x2ea0f5(0x1ad)+_0x2ea0f5(0x195)+_0x2ea0f5(0x1bf)+_0x2ea0f5(0x1df)+_0x4093c4+'\x20'+_0x2ea0f5(0x20c)+_0x2ea0f5(0x1e7)+_0x553551+'\x20'+_0x2ea0f5(0x1d4)+_0x2ea0f5(0x22d)+'</div>'+_0x2ea0f5(0x1f1)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2ea0f5(0x244)+_0x2ea0f5(0x237)+_0x2ea0f5(0x256)+_0x2ea0f5(0x227)+_0x2ea0f5(0x1f4)+_0x2ea0f5(0x24d)+'</thead>'+_0x2ea0f5(0x1a2)+'\x20'+_0x3c59a7+'\x20'+_0x2ea0f5(0x1bc)+_0x2ea0f5(0x1fa)+'<div>'+_0x2ea0f5(0x233)+_0x2ea0f5(0x198)+_0x372da4[0x0][_0x2ea0f5(0x156)]+'</h5>'+_0x2ea0f5(0x231)+'</div>'+_0x2ea0f5(0x140)};_0x56a4fd[_0x2ea0f5(0x16f)](_0x2d47dd,function(_0x526cbb,_0x5910b2){var _0xea48d6=_0x2ea0f5;_0x526cbb?(console['log'](_0x526cbb),console[_0xea48d6(0x1d5)]('Error\x20Occurs')):console[_0xea48d6(0x1d5)](_0xea48d6(0x199));}),_0x35cbe5[_0x2ea0f5(0x247)](_0x2ea0f5(0x185),_0x2ea0f5(0x24e)),_0x76070a[_0x2ea0f5(0x176)](_0x2ea0f5(0x183));}catch(_0x11861b){_0x76070a[_0x2ea0f5(0x223)](0xc8)[_0x2ea0f5(0x1cb)]({'message1':_0x11861b[_0x2ea0f5(0x25a)]});}else{if(_0x35cbe5[_0x2ea0f5(0x241)]['for_categorize']=='GS')try{const {invoice:_0x1ad13e,date:_0x4a7b99,warehouse_name:_0x32e84e,product_name:_0x4e87b1,primary_code:_0x47e6c1,secondary_code:_0x68017e,product_code:_0xe5a43f,sales_quantity:_0x115ff6,stocks:_0xdd58de,return_qty:_0x2216f1,Room_name:_0xe386f2,to_warehouse_name:_0x1d9fe9,to_Room_name:_0x17333f,note:_0x55532a,level:_0x21e2ce,isle:_0x40bb30,pallet:_0x20d138,for_categorize:_0x1b35fa}=_0x35cbe5[_0x2ea0f5(0x241)];if(typeof _0x4e87b1==_0x2ea0f5(0x163))var _0x377265=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1b3)]],_0x4de794=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x219)]],_0x2934fe=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1a3)]],_0x513a17=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1cd)]],_0x590644=[_0x35cbe5['body'][_0x2ea0f5(0x14d)]],_0x303551=[_0x35cbe5['body'][_0x2ea0f5(0x148)]],_0x58907c=[_0x35cbe5[_0x2ea0f5(0x241)]['bay']],_0x3be23b=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1a1)]],_0x44f827=[_0x35cbe5['body'][_0x2ea0f5(0x257)]],_0x15102f=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x153)]],_0x58b95d=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x18a)]],_0x4d7668=[_0x35cbe5['body'][_0x2ea0f5(0x18f)]],_0x40f485=[_0x35cbe5[_0x2ea0f5(0x241)]['production_date']],_0x542d7b=[_0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1d8)]];else var _0x377265=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1b3)]],_0x4de794=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x219)]],_0x2934fe=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1a3)]],_0x513a17=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1cd)]],_0x590644=[..._0x35cbe5[_0x2ea0f5(0x241)]['sales_quantity']],_0x303551=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x148)]],_0x58907c=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x14b)]],_0x3be23b=[..._0x35cbe5['body'][_0x2ea0f5(0x1a1)]],_0x44f827=[..._0x35cbe5[_0x2ea0f5(0x241)]['maxProducts']],_0x15102f=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x153)]],_0x58b95d=[..._0x35cbe5[_0x2ea0f5(0x241)]['secondary_unit']],_0x4d7668=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x18f)]],_0x40f485=[..._0x35cbe5[_0x2ea0f5(0x241)][_0x2ea0f5(0x1ab)]],_0x542d7b=[..._0x35cbe5[_0x2ea0f5(0x241)]['expiry_date']];const _0x4f4532=_0x377265[_0x2ea0f5(0x21c)](_0x1a0029=>{return _0x1a0029={'product_name':_0x1a0029};});_0x4de794[_0x2ea0f5(0x1e8)]((_0x4aa731,_0x9c05)=>{_0x4f4532[_0x9c05]['primary_code']=_0x4aa731;}),_0x2934fe['forEach']((_0x42544a,_0x490267)=>{_0x4f4532[_0x490267]['secondary_code']=_0x42544a;}),_0x513a17[_0x2ea0f5(0x1e8)]((_0x525918,_0x4f781c)=>{var _0x1120a2=_0x2ea0f5;_0x4f4532[_0x4f781c][_0x1120a2(0x1cd)]=_0x525918;}),_0x590644[_0x2ea0f5(0x1e8)]((_0x34c20e,_0x35d927)=>{var _0x20c290=_0x2ea0f5;_0x4f4532[_0x35d927][_0x20c290(0x1e1)]=_0x34c20e;}),_0x303551[_0x2ea0f5(0x1e8)]((_0x3b970f,_0x36e5d5)=>{_0x4f4532[_0x36e5d5]['return_qty']=_0x3b970f;}),_0x58907c[_0x2ea0f5(0x1e8)]((_0x1b6c9f,_0x253cdd)=>{var _0x57c4bf=_0x2ea0f5;_0x4f4532[_0x253cdd][_0x57c4bf(0x14b)]=_0x1b6c9f;}),_0x3be23b[_0x2ea0f5(0x1e8)]((_0x19a897,_0xfab121)=>{var _0xde3e59=_0x2ea0f5;_0x4f4532[_0xfab121][_0xde3e59(0x1a1)]=_0x19a897;}),_0x44f827[_0x2ea0f5(0x1e8)]((_0x2cd2fa,_0x25de23)=>{_0x4f4532[_0x25de23]['maxProducts']=_0x2cd2fa;}),_0x15102f[_0x2ea0f5(0x1e8)]((_0x37ce8f,_0x1c648c)=>{_0x4f4532[_0x1c648c]['batch_code']=_0x37ce8f;}),_0x58b95d['forEach']((_0x1b389d,_0x345922)=>{var _0x5e0a75=_0x2ea0f5;_0x4f4532[_0x345922][_0x5e0a75(0x18a)]=_0x1b389d;}),_0x4d7668[_0x2ea0f5(0x1e8)]((_0x313647,_0x23326c)=>{_0x4f4532[_0x23326c]['unit']=_0x313647;}),_0x40f485['forEach']((_0x5a4b3d,_0x4519a2)=>{var _0x424047=_0x2ea0f5;_0x4f4532[_0x4519a2][_0x424047(0x1ab)]=_0x5a4b3d;}),_0x542d7b[_0x2ea0f5(0x1e8)]((_0x4d54e0,_0x3d3827)=>{var _0x102e59=_0x2ea0f5;_0x4f4532[_0x3d3827][_0x102e59(0x1d8)]=_0x4d54e0;});var _0x4d36c4=0x0;_0x4f4532[_0x2ea0f5(0x1e8)](_0x2f7d92=>{var _0x26acc3=_0x2ea0f5;(parseInt(_0x2f7d92[_0x26acc3(0x1e1)])<parseInt(_0x2f7d92[_0x26acc3(0x148)])||parseInt(_0x2f7d92[_0x26acc3(0x220)])<parseInt(_0x2f7d92[_0x26acc3(0x148)])&&parseInt(_0x2f7d92[_0x26acc3(0x1e1)])>parseInt(_0x2f7d92[_0x26acc3(0x148)])||parseInt(_0x2f7d92[_0x26acc3(0x148)])==0x0)&&_0x4d36c4++;});if(_0x4d36c4!=0x0)return _0x35cbe5['flash']('errors','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x76070a[_0x2ea0f5(0x176)](_0x2ea0f5(0x1fb));const _0xf8a632=await sales_finished[_0x2ea0f5(0x192)]({'invoice':_0x1ad13e});_0xf8a632['return_data']=_0x2ea0f5(0x24a);const _0x2792d4=await _0xf8a632['save'](),_0x3c9f4a=new sales_return_finished({'invoice':_0x1ad13e,'customer':_0x35cbe5[_0x2ea0f5(0x241)]['customer'],'date':_0x4a7b99,'warehouse_name':_0x32e84e,'room':_0xe386f2,'ToWarehouse':_0x1d9fe9,'ToRoom':_0x17333f,'return_sale':_0x4f4532,'note':_0x55532a,'warehouse_cat':_0x1b35fa}),_0x416921=await _0x3c9f4a[_0x2ea0f5(0x142)](),_0x28b58e=await sales_return_finished[_0x2ea0f5(0x192)]({'invoice':_0x1ad13e}),_0x3d6b60=await warehouse['findOne']({'name':_0x1d9fe9,'room':_0x17333f,'warehouse_category':_0x2ea0f5(0x14c)});_0x28b58e[_0x2ea0f5(0x188)][_0x2ea0f5(0x1e8)](_0x50d610=>{var _0x1d9498=_0x2ea0f5,_0x51671b=0x0;const _0x35a6b9=_0x3d6b60['product_details']['map'](_0x330c1f=>{var _0xa7c143=a0_0x2c94;_0x330c1f[_0xa7c143(0x1b3)]==_0x50d610[_0xa7c143(0x1b3)]&&_0x330c1f[_0xa7c143(0x14b)]==_0x50d610[_0xa7c143(0x14b)]&&_0x330c1f[_0xa7c143(0x1d8)]==_0x50d610[_0xa7c143(0x1d8)]&&_0x330c1f[_0xa7c143(0x1ab)]==_0x50d610[_0xa7c143(0x1ab)]&&_0x330c1f['batch_code']==_0x50d610['batch_code']&&(_0x330c1f[_0xa7c143(0x169)]=parseInt(_0x330c1f[_0xa7c143(0x169)])+parseInt(_0x50d610[_0xa7c143(0x148)]),_0x51671b++);});_0x51671b=='0'&&(_0x3d6b60[_0x1d9498(0x22e)]=_0x3d6b60[_0x1d9498(0x22e)][_0x1d9498(0x1c8)]({'product_name':_0x50d610[_0x1d9498(0x1b3)],'product_stock':_0x50d610[_0x1d9498(0x148)],'primary_code':_0x50d610[_0x1d9498(0x219)],'secondary_code':_0x50d610['secondary_code'],'product_code':_0x50d610[_0x1d9498(0x1cd)],'bay':_0x50d610[_0x1d9498(0x14b)],'batch_code':_0x50d610[_0x1d9498(0x153)],'maxPerUnit':_0x50d610[_0x1d9498(0x1a1)],'production_date':_0x50d610[_0x1d9498(0x1ab)],'expiry_date':_0x50d610[_0x1d9498(0x1d8)],'secondary_unit':_0x50d610[_0x1d9498(0x18a)],'unit':_0x50d610['unit'],'maxProducts':_0x50d610['maxProducts']}));}),await _0x3d6b60[_0x2ea0f5(0x142)](),console[_0x2ea0f5(0x1d5)](_0x35cbe5[_0x2ea0f5(0x241)]);const _0x1bc43d=new c_payment_data({'invoice':_0x1ad13e,'customer':_0x35cbe5[_0x2ea0f5(0x241)]['customer'],'reason':_0x2ea0f5(0x1be)});await _0x1bc43d[_0x2ea0f5(0x142)]();const _0x3fd411=await master_shop[_0x2ea0f5(0x232)]();console[_0x2ea0f5(0x1d5)](_0x2ea0f5(0x15b),_0x3fd411[0x0]['image']);const _0x511423=await email_settings['findOne'](),_0x5f4102=await customer[_0x2ea0f5(0x192)]({'name':_0x35cbe5['body'][_0x2ea0f5(0x1d9)]});console['log'](_0x2ea0f5(0x1af),_0x5f4102);_0x3fd411[0x0][_0x2ea0f5(0x190)]==0x1?(right_currency=_0x3fd411[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x3fd411[0x0][_0x2ea0f5(0x162)]);var _0x76957f=_0x377265,_0x10b18e=_0x303551,_0x3c59a7='',_0x4da6a8;for(_0x4da6a8 in _0x76957f){_0x3c59a7+=_0x2ea0f5(0x244)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x76957f[_0x4da6a8]+_0x2ea0f5(0x21d)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10b18e[_0x4da6a8]+_0x2ea0f5(0x21d)+_0x2ea0f5(0x24d);}console['log'](_0x2ea0f5(0x1aa),_0x3c59a7);let _0x36eada=nodemailer[_0x2ea0f5(0x1f9)]({'service':'gmail','auth':{'user':_0x511423[_0x2ea0f5(0x224)],'pass':_0x511423[_0x2ea0f5(0x1fc)]}}),_0x457c3d={'from':_0x511423[_0x2ea0f5(0x224)],'to':_0x5f4102['email'],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x2ea0f5(0x23e),'path':__dirname+'/../public'+_0x2ea0f5(0x238)+_0x3fd411[0x0][_0x2ea0f5(0x1f8)],'cid':_0x2ea0f5(0x242)}],'html':_0x2ea0f5(0x158)+'<html><head><title></title>'+'</head><body>'+_0x2ea0f5(0x195)+_0x2ea0f5(0x1c6)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+_0x2ea0f5(0x255)+_0x3fd411[0x0][_0x2ea0f5(0x156)]+_0x2ea0f5(0x160)+_0x2ea0f5(0x231)+'</div>'+_0x2ea0f5(0x1ad)+_0x2ea0f5(0x195)+_0x2ea0f5(0x1bf)+_0x2ea0f5(0x1df)+_0x1ad13e+'\x20'+_0x2ea0f5(0x20c)+'\x20Order\x20Date\x20:\x20'+_0x4a7b99+'\x20'+_0x2ea0f5(0x1d4)+'</h5>'+_0x2ea0f5(0x231)+_0x2ea0f5(0x1f1)+_0x2ea0f5(0x1d7)+_0x2ea0f5(0x244)+_0x2ea0f5(0x237)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x2ea0f5(0x227)+_0x2ea0f5(0x1f4)+'</tr>'+_0x2ea0f5(0x15c)+_0x2ea0f5(0x1a2)+'\x20'+_0x3c59a7+'\x20'+_0x2ea0f5(0x1bc)+'</table>'+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x2ea0f5(0x198)+_0x3fd411[0x0][_0x2ea0f5(0x156)]+_0x2ea0f5(0x22d)+_0x2ea0f5(0x231)+_0x2ea0f5(0x231)+_0x2ea0f5(0x140)};_0x36eada['sendMail'](_0x457c3d,function(_0xf2f90c,_0x302b3c){var _0x1abf97=_0x2ea0f5;_0xf2f90c?(console[_0x1abf97(0x1d5)](_0xf2f90c),console[_0x1abf97(0x1d5)]('Error\x20Occurs')):console[_0x1abf97(0x1d5)](_0x1abf97(0x199));}),_0x35cbe5[_0x2ea0f5(0x247)]('success',_0x2ea0f5(0x24e)),_0x76070a[_0x2ea0f5(0x176)](_0x2ea0f5(0x183));}catch(_0x50f992){console[_0x2ea0f5(0x1d5)](_0x50f992),_0x76070a[_0x2ea0f5(0x223)](0xc8)[_0x2ea0f5(0x1cb)]({'message1':_0x50f992[_0x2ea0f5(0x25a)]});}}}),router[a0_0x2a4b90(0x222)](a0_0x2a4b90(0x1d1),auth,async(_0x5471ae,_0x109378)=>{var _0x28b406=a0_0x2a4b90;try{const {username:_0x2a2161,email:_0x391a0f,role:_0x256d0e}=_0x5471ae[_0x28b406(0x164)],_0x46e3b6=_0x5471ae[_0x28b406(0x164)],_0x4982e7=await profile[_0x28b406(0x192)]({'email':_0x46e3b6[_0x28b406(0x224)]}),_0xbe23b5=await master_shop[_0x28b406(0x232)]();console[_0x28b406(0x1d5)](_0x28b406(0x1bd),_0xbe23b5);const _0x2e589e=_0x5471ae[_0x28b406(0x240)]['id'],_0x2cd372=await sales[_0x28b406(0x212)](_0x2e589e);console[_0x28b406(0x1d5)](_0x28b406(0x22b),_0x2cd372);if(_0xbe23b5[0x0][_0x28b406(0x1ce)]==_0x28b406(0x1e9))var _0x2e96ed=users['English'];else{if(_0xbe23b5[0x0][_0x28b406(0x1ce)]==_0x28b406(0x203))var _0x2e96ed=users['Hindi'];else{if(_0xbe23b5[0x0][_0x28b406(0x1ce)]==_0x28b406(0x1d3))var _0x2e96ed=users[_0x28b406(0x1d3)];else{if(_0xbe23b5[0x0][_0x28b406(0x1ce)]==_0x28b406(0x228))var _0x2e96ed=users[_0x28b406(0x228)];else{if(_0xbe23b5[0x0][_0x28b406(0x1ce)]=='French')var _0x2e96ed=users['French'];else{if(_0xbe23b5[0x0]['language']==_0x28b406(0x18b))var _0x2e96ed=users[_0x28b406(0x24b)];else{if(_0xbe23b5[0x0]['language']==_0x28b406(0x216))var _0x2e96ed=users['Chinese'];else{if(_0xbe23b5[0x0]['language']==_0x28b406(0x165))var _0x2e96ed=users[_0x28b406(0x196)];}}}}}}}_0x109378[_0x28b406(0x1cf)](_0x28b406(0x17a),{'success':_0x5471ae[_0x28b406(0x247)]('success'),'errors':_0x5471ae[_0x28b406(0x247)]('errors'),'role':_0x46e3b6,'profile':_0x4982e7,'alldata':_0x2cd372,'master_shop':_0xbe23b5,'language':_0x2e96ed});}catch(_0x276861){console[_0x28b406(0x1d5)](_0x276861);}}),router['post']('/barcode_scanner',async(_0x17a60e,_0x5815e6)=>{var _0x18b4e4=a0_0x2a4b90;const {product_code:_0x23e732,warehouse_name:_0x547a51,rooms_data:_0x5ee72a,Roomslist:_0x2b4a94}=_0x17a60e[_0x18b4e4(0x241)],_0x25607a=_0x2b4a94['split'](','),_0x5d318e=[];async function _0x36f894(_0x48a738){var _0x9bd217=_0x18b4e4;const _0x42c492=await warehouse[_0x9bd217(0x209)]([{'$match':{'name':_0x547a51,'room':_0x48a738}},{'$unwind':_0x9bd217(0x193)},{'$match':{'product_details.primary_code':_0x23e732}},{'$group':{'_id':_0x9bd217(0x1de),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x9bd217(0x211)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x9bd217(0x17d)},'level':{'$first':_0x9bd217(0x1a0)},'isle':{'$first':_0x9bd217(0x159)},'type':{'$first':_0x9bd217(0x22f)},'pallet':{'$first':_0x9bd217(0x1c7)},'unit':{'$first':_0x9bd217(0x1a9)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x9bd217(0x1bb)},'rack':{'$first':_0x9bd217(0x173)},'expiry_date':{'$first':_0x9bd217(0x179)},'production_date':{'$first':_0x9bd217(0x1e5)},'maxPerUnit':{'$first':_0x9bd217(0x18e)},'batch_code':{'$first':_0x9bd217(0x1d0)},'product_cat':{'$first':_0x9bd217(0x1a4)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x9bd217(0x186)}}}]),_0x1017ed=await warehouse[_0x9bd217(0x209)]([{'$match':{'name':_0x547a51,'room':_0x48a738}},{'$unwind':_0x9bd217(0x193)},{'$match':{'product_details.secondary_code':_0x23e732}},{'$group':{'_id':_0x9bd217(0x1de),'name':{'$first':_0x9bd217(0x20e)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x9bd217(0x211)},'secondary_code':{'$first':_0x9bd217(0x23c)},'product_code':{'$first':_0x9bd217(0x17d)},'level':{'$first':_0x9bd217(0x1a0)},'isle':{'$first':_0x9bd217(0x159)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x9bd217(0x1c7)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x9bd217(0x1f3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x9bd217(0x173)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x9bd217(0x1e5)},'maxPerUnit':{'$first':_0x9bd217(0x18e)},'batch_code':{'$first':_0x9bd217(0x1d0)},'product_cat':{'$first':_0x9bd217(0x1a4)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x9bd217(0x1da)},'invoice':{'$first':_0x9bd217(0x186)}}}]);if(_0x42c492[_0x9bd217(0x20d)]>0x0)_0x5d318e[_0x9bd217(0x174)](_0x42c492);else _0x1017ed[_0x9bd217(0x20d)]>0x0&&_0x5d318e['push'](_0x1017ed);}const _0x1d92dc=_0x25607a[_0x18b4e4(0x21c)](_0x88dd9b=>_0x36f894(_0x88dd9b));await Promise[_0x18b4e4(0x19e)](_0x1d92dc),_0x5815e6[_0x18b4e4(0x1cb)](_0x5d318e);}),module[a0_0x2a4b90(0x252)]=router;