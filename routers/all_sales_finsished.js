var a0_0xadf73f=a0_0x2c11;(function(_0xcd22d8,_0x120e1d){var _0x28339a=a0_0x2c11,_0x276f8a=_0xcd22d8();while(!![]){try{var _0x79612a=-parseInt(_0x28339a(0x16b))/0x1+-parseInt(_0x28339a(0x193))/0x2+parseInt(_0x28339a(0x176))/0x3+-parseInt(_0x28339a(0x15f))/0x4+-parseInt(_0x28339a(0x1fd))/0x5*(parseInt(_0x28339a(0x185))/0x6)+parseInt(_0x28339a(0x18c))/0x7+parseInt(_0x28339a(0x17d))/0x8;if(_0x79612a===_0x120e1d)break;else _0x276f8a['push'](_0x276f8a['shift']());}catch(_0x50a7bc){_0x276f8a['push'](_0x276f8a['shift']());}}}(a0_0x7d03,0x2606f));const express=require(a0_0xadf73f(0x1c9)),app=express(),router=express[a0_0xadf73f(0x16e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require('../models/all_models'),auth=require(a0_0xadf73f(0x1ae)),nodemailer=require(a0_0xadf73f(0x181)),users=require(a0_0xadf73f(0x201));router['get'](a0_0xadf73f(0x1e2),auth,async(_0x156c8d,_0xd2016b)=>{var _0x12c1d4=a0_0xadf73f;try{const {username:_0x20496b,email:_0x48abf3,role:_0x1bb00}=_0x156c8d[_0x12c1d4(0x1a2)],_0x3d3abf=_0x156c8d[_0x12c1d4(0x1a2)],_0x2e9670=await profile[_0x12c1d4(0x15e)]({'email':_0x3d3abf[_0x12c1d4(0x1ca)]}),_0x22f34e=await master_shop[_0x12c1d4(0x18d)]();let _0x24f0af;if(_0x3d3abf[_0x12c1d4(0x169)]==_0x12c1d4(0x1e8)){const _0x5c420d=await staff[_0x12c1d4(0x15e)]({'email':_0x3d3abf[_0x12c1d4(0x1ca)]});_0x24f0af=await sales_finished[_0x12c1d4(0x200)]([{'$lookup':{'from':_0x12c1d4(0x1a4),'localField':'customer','foreignField':_0x12c1d4(0x1e4),'as':'customers_docs'}},{'$unwind':_0x12c1d4(0x1db)},{'$unwind':_0x12c1d4(0x1d1)},{'$group':{'_id':_0x12c1d4(0x173),'invoice':{'$first':_0x12c1d4(0x1c6)},'customers':{'$first':_0x12c1d4(0x17e)},'date':{'$first':_0x12c1d4(0x1b7)},'warehouse_name':{'$first':_0x12c1d4(0x16d)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x12c1d4(0x182)},'return_data':{'$first':_0x12c1d4(0x221)},'customers_docs':{'$first':_0x12c1d4(0x1db)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x12c1d4(0x215)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x12c1d4(0x24f)},'finalize':{'$first':_0x12c1d4(0x220)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x24f0af=await sales_finished[_0x12c1d4(0x200)]([{'$lookup':{'from':_0x12c1d4(0x1a4),'localField':'customer','foreignField':_0x12c1d4(0x1e4),'as':_0x12c1d4(0x1bc)}},{'$unwind':'$customers_docs'},{'$unwind':_0x12c1d4(0x1d1)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':_0x12c1d4(0x17e)},'date':{'$first':_0x12c1d4(0x1b7)},'warehouse_name':{'$first':_0x12c1d4(0x16d)},'sale_product':{'$push':_0x12c1d4(0x1d1)},'note':{'$first':_0x12c1d4(0x182)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x12c1d4(0x1db)},'total_saleproduct_quantity':{'$sum':_0x12c1d4(0x22a)},'level':{'$addToSet':_0x12c1d4(0x18f)},'isle':{'$addToSet':_0x12c1d4(0x215)},'type':{'$addToSet':_0x12c1d4(0x261)},'pallet':{'$addToSet':_0x12c1d4(0x24f)},'finalize':{'$first':_0x12c1d4(0x220)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x22f34e[0x0][_0x12c1d4(0x1f5)]==_0x12c1d4(0x1f7)){var _0x3bb7a4=users[_0x12c1d4(0x165)];console[_0x12c1d4(0x1eb)](_0x3bb7a4);}else{if(_0x22f34e[0x0][_0x12c1d4(0x1f5)]==_0x12c1d4(0x226))var _0x3bb7a4=users[_0x12c1d4(0x226)];else{if(_0x22f34e[0x0][_0x12c1d4(0x1f5)]=='German')var _0x3bb7a4=users[_0x12c1d4(0x1ac)];else{if(_0x22f34e[0x0][_0x12c1d4(0x1f5)]=='Spanish')var _0x3bb7a4=users[_0x12c1d4(0x252)];else{if(_0x22f34e[0x0][_0x12c1d4(0x1f5)]==_0x12c1d4(0x195))var _0x3bb7a4=users['French'];else{if(_0x22f34e[0x0][_0x12c1d4(0x1f5)]==_0x12c1d4(0x184))var _0x3bb7a4=users['Portuguese'];else{if(_0x22f34e[0x0]['language']==_0x12c1d4(0x1aa))var _0x3bb7a4=users[_0x12c1d4(0x1aa)];else{if(_0x22f34e[0x0][_0x12c1d4(0x1f5)]==_0x12c1d4(0x1fc))var _0x3bb7a4=users[_0x12c1d4(0x177)];}}}}}}}_0xd2016b[_0x12c1d4(0x1a6)]('all_sales_finished',{'success':_0x156c8d['flash'](_0x12c1d4(0x21c)),'errors':_0x156c8d['flash'](_0x12c1d4(0x178)),'sales':_0x24f0af,'profile':_0x2e9670,'role':_0x3d3abf,'master_shop':_0x22f34e,'language':_0x3bb7a4});}catch(_0x58f62d){console[_0x12c1d4(0x1eb)](_0x58f62d);}});async function getRandom8DigitNumber(){var _0x5687f2=a0_0xadf73f;const _0x4177b8=0x989680,_0x53fd17=0x5f5e0ff,_0x5406ec=Math[_0x5687f2(0x205)](Math['random']()*(_0x53fd17-_0x4177b8+0x1))+_0x4177b8;var _0x4a2285;const _0x2ee9fd=await sales_finished['findOne']({'invoice':_0x5687f2(0x216)+_0x5406ec});return _0x2ee9fd&&_0x2ee9fd[_0x5687f2(0x1e5)]>0x0?_0x4a2285=_0x5687f2(0x216)+_0x5406ec:_0x4a2285=_0x5687f2(0x216)+_0x5406ec,_0x4a2285;}function a0_0x2c11(_0x412fb3,_0x538454){var _0x7d03f9=a0_0x7d03();return a0_0x2c11=function(_0x2c11ee,_0x15d928){_0x2c11ee=_0x2c11ee-0x151;var _0x1a0508=_0x7d03f9[_0x2c11ee];return _0x1a0508;},a0_0x2c11(_0x412fb3,_0x538454);}router['get'](a0_0xadf73f(0x19c),auth,async(_0x12fc5f,_0x39e9ac)=>{var _0x299acb=a0_0xadf73f;try{const {username:_0x553536,email:_0x4becc4,role:_0x45ab18}=_0x12fc5f[_0x299acb(0x1a2)],_0x47b93e=_0x12fc5f[_0x299acb(0x1a2)],_0x343a24=await profile[_0x299acb(0x15e)]({'email':_0x47b93e[_0x299acb(0x1ca)]}),_0x4d8ab6=await master_shop[_0x299acb(0x18d)](),_0x117da0=await customer[_0x299acb(0x18d)]({});let _0x3ac53d;if(_0x47b93e[_0x299acb(0x169)]==_0x299acb(0x1e8)){const _0x117f0d=await staff[_0x299acb(0x15e)]({'email':_0x47b93e[_0x299acb(0x1ca)]});_0x3ac53d=await warehouse['aggregate']([{'$match':{'status':_0x299acb(0x254),'name':_0x117f0d[_0x299acb(0x1bd)],'warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x299acb(0x1e9),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x3ac53d=await warehouse[_0x299acb(0x200)]([{'$match':{'status':_0x299acb(0x254),'warehouse_category':_0x299acb(0x1de),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x299acb(0x1e9),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0xdd3794=await product[_0x299acb(0x18d)]({});var _0x53be35=[_0x299acb(0x257),_0x299acb(0x188)];const _0x2f2a82=await sales_finished[_0x299acb(0x18d)]({}),_0x400c70=_0x2f2a82[_0x299acb(0x1e5)]+0x1,_0x48a875='OUTF-'+_0x400c70[_0x299acb(0x160)]()['padStart'](0x5,'0');if(_0x4d8ab6[0x0][_0x299acb(0x1f5)]==_0x299acb(0x1f7)){var _0x245845=users[_0x299acb(0x165)];console[_0x299acb(0x1eb)](_0x245845);}else{if(_0x4d8ab6[0x0][_0x299acb(0x1f5)]==_0x299acb(0x226))var _0x245845=users[_0x299acb(0x226)];else{if(_0x4d8ab6[0x0][_0x299acb(0x1f5)]==_0x299acb(0x1ac))var _0x245845=users['German'];else{if(_0x4d8ab6[0x0]['language']==_0x299acb(0x252))var _0x245845=users[_0x299acb(0x252)];else{if(_0x4d8ab6[0x0][_0x299acb(0x1f5)]==_0x299acb(0x195))var _0x245845=users[_0x299acb(0x195)];else{if(_0x4d8ab6[0x0][_0x299acb(0x1f5)]==_0x299acb(0x184))var _0x245845=users[_0x299acb(0x1b5)];else{if(_0x4d8ab6[0x0]['language']==_0x299acb(0x1aa))var _0x245845=users[_0x299acb(0x1aa)];else{if(_0x4d8ab6[0x0][_0x299acb(0x1f5)]==_0x299acb(0x1fc))var _0x245845=users['Arabic'];}}}}}}}const _0x243da0=getRandom8DigitNumber();_0x243da0[_0x299acb(0x190)](_0x14771e=>{var _0x3cf2cc=_0x299acb;_0x39e9ac[_0x3cf2cc(0x1a6)](_0x3cf2cc(0x170),{'success':_0x12fc5f['flash'](_0x3cf2cc(0x21c)),'errors':_0x12fc5f[_0x3cf2cc(0x1a3)](_0x3cf2cc(0x178)),'role':_0x47b93e,'profile':_0x343a24,'customer':_0x117da0,'warehouse':_0x3ac53d,'product':_0xdd3794,'invoice':_0x14771e,'master_shop':_0x4d8ab6,'language':_0x245845,'rooms_data':_0x53be35});})[_0x299acb(0x179)](_0x5b528a=>{var _0x10c6b6=_0x299acb;_0x12fc5f[_0x10c6b6(0x1a3)](_0x10c6b6(0x178),_0x10c6b6(0x228)),_0x39e9ac[_0x10c6b6(0x1dc)](_0x10c6b6(0x1e3));});}catch(_0x56b075){console[_0x299acb(0x1eb)](_0x56b075);}}),router[a0_0xadf73f(0x18e)]('/view/add_sales/:id',auth,async(_0x5d9de4,_0x45bd16)=>{var _0x5cbb5d=a0_0xadf73f;try{const _0x1fa4d3=_0x5d9de4[_0x5cbb5d(0x230)]['id'];console[_0x5cbb5d(0x1eb)](_0x1fa4d3);const _0x510c40=await product[_0x5cbb5d(0x18d)](),_0x3cd80c=await purchases[_0x5cbb5d(0x200)]([{'$match':{'warehouse_name':_0x1fa4d3}},{'$unwind':'$product'},{'$group':{'_id':_0x5cbb5d(0x231)}}]);console['log']('purchases_data',_0x3cd80c),_0x45bd16[_0x5cbb5d(0x246)](0xc8)['json']({'purchases_data':_0x3cd80c,'product_data':_0x510c40});}catch(_0x50e7c5){console[_0x5cbb5d(0x1eb)](_0x50e7c5);}}),router[a0_0xadf73f(0x242)]('/view/add_sale/product',auth,async(_0x268255,_0x17e0e1)=>{var _0x4d009c=a0_0xadf73f;try{const {warehouse_data:_0x291807,product_data:_0x5c56e2}=_0x268255[_0x4d009c(0x1ee)];console[_0x4d009c(0x1eb)](_0x268255[_0x4d009c(0x1ee)]['product_data']);;const _0xe9ae4a=await master_shop[_0x4d009c(0x18d)]();console[_0x4d009c(0x1eb)](_0x4d009c(0x262),_0xe9ae4a);const _0x402a22=await product[_0x4d009c(0x15e)]({'name':_0x5c56e2});console[_0x4d009c(0x1eb)]('product',_0x402a22);const _0x58e187=await warehouse[_0x4d009c(0x200)]([{'$match':{'name':_0x291807}},{'$unwind':_0x4d009c(0x204)},{'$match':{'product_details.product_name':_0x5c56e2}},{'$group':{'_id':_0x4d009c(0x23e),'product_stock':{'$first':_0x4d009c(0x1d2)}}}]);console[_0x4d009c(0x1eb)](_0x4d009c(0x224),_0x58e187),_0x17e0e1['status'](0xc8)['json']({'master':_0xe9ae4a,'new_product':_0x402a22,'stock_data':_0x58e187});}catch(_0xcd5ebd){console[_0x4d009c(0x1eb)](_0xcd5ebd);}}),router[a0_0xadf73f(0x242)](a0_0xadf73f(0x19c),auth,async(_0x275f65,_0x215b9d)=>{var _0x19ee41=a0_0xadf73f;try{const {invoice:_0x541817,date:_0x18da44,warehouse_name:_0x597554,product_name:_0x23bb4a,stock:_0x5178eb,quantity:_0x1407d0,note:_0x247b78,room:_0x3b13f3,primary_code:_0x1f1e87,secondary_code:_0x2b4114,prod_code:_0x2b114d,level:_0x287901,isle:_0x3db2c6,pallet:_0xc18926,batch_code:_0x1a5ef5,SCRN:_0x939cf6,expiry_date:_0x37a776,mode_transpo:_0x5988f8,name_driver:_0x1f52f9}=_0x275f65[_0x19ee41(0x1ee)];if(typeof _0x23bb4a=='string')var _0x48c739=[_0x275f65['body'][_0x19ee41(0x1dd)]],_0x31faa3=[_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x19f)]],_0x30a666=[_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x255)]],_0x2f67d2=[_0x275f65[_0x19ee41(0x1ee)]['primary_code']],_0x17fa01=[_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x247)]],_0x3abed1=[_0x275f65['body']['prod_code']],_0x3bb7f0=[_0x275f65['body'][_0x19ee41(0x1ce)]],_0x26820d=[_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x171)]],_0x14c2c1=[_0x275f65[_0x19ee41(0x1ee)]['secondary_unit']],_0x1ba59b=[_0x275f65[_0x19ee41(0x1ee)]['batch_code']],_0x43f1d8=[_0x275f65[_0x19ee41(0x1ee)]['expiry_date']],_0x4c3e3c=[_0x275f65[_0x19ee41(0x1ee)]['product_date']],_0x58cfe0=[_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x1c2)]],_0x5555d4=[_0x275f65[_0x19ee41(0x1ee)]['prod_cat']],_0x373bec=[_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x19d)]],_0x36dd6b=[_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x1d8)]],_0x516e11=[_0x275f65['body']['id_transaction_from']];else var _0x48c739=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x1dd)]],_0x31faa3=[..._0x275f65['body'][_0x19ee41(0x19f)]],_0x30a666=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x255)]],_0x2f67d2=[..._0x275f65[_0x19ee41(0x1ee)]['primary_code']],_0x17fa01=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x247)]],_0x3abed1=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x1f3)]],_0x3bb7f0=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x1ce)]],_0x26820d=[..._0x275f65['body']['primary_unit']],_0x14c2c1=[..._0x275f65[_0x19ee41(0x1ee)]['secondary_unit']],_0x1ba59b=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x217)]],_0x43f1d8=[..._0x275f65['body']['expiry_date']],_0x4c3e3c=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x222)]],_0x58cfe0=[..._0x275f65['body'][_0x19ee41(0x1c2)]],_0x5555d4=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x25c)]],_0x373bec=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x19d)]],_0x36dd6b=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x1d8)]],_0x516e11=[..._0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x23a)]];const _0xa377f0=_0x48c739[_0x19ee41(0x1b8)](_0x41e818=>{return _0x41e818={'product_name':_0x41e818};});_0x31faa3[_0x19ee41(0x1ed)]((_0x1a9a84,_0x3d8464)=>{var _0x26ce79=_0x19ee41;_0xa377f0[_0x3d8464][_0x26ce79(0x19f)]=_0x1a9a84;}),_0x30a666[_0x19ee41(0x1ed)]((_0xf58739,_0x2cf22d)=>{var _0x2b5807=_0x19ee41;_0xa377f0[_0x2cf22d][_0x2b5807(0x152)]=Math['abs'](_0xf58739);}),_0x516e11[_0x19ee41(0x1ed)]((_0x4bad82,_0x52b8af)=>{var _0x2fc06c=_0x19ee41;_0xa377f0[_0x52b8af][_0x2fc06c(0x23a)]=_0x4bad82;}),_0x2f67d2[_0x19ee41(0x1ed)]((_0x2669d4,_0x1c74b5)=>{var _0x2583b9=_0x19ee41;_0xa377f0[_0x1c74b5][_0x2583b9(0x202)]=_0x2669d4;}),_0x17fa01['forEach']((_0x10f056,_0x4d9e18)=>{var _0x1f33c1=_0x19ee41;_0xa377f0[_0x4d9e18][_0x1f33c1(0x247)]=_0x10f056;}),_0x3abed1[_0x19ee41(0x1ed)]((_0xb99c0,_0x56596d)=>{var _0x46a755=_0x19ee41;_0xa377f0[_0x56596d][_0x46a755(0x15b)]=_0xb99c0;}),_0x3bb7f0['forEach']((_0x48723a,_0x1b2cad)=>{var _0x4d74f4=_0x19ee41;_0xa377f0[_0x1b2cad][_0x4d74f4(0x15d)]=_0x48723a;}),_0x26820d[_0x19ee41(0x1ed)]((_0x14b121,_0x18fd23)=>{var _0x216409=_0x19ee41;_0xa377f0[_0x18fd23][_0x216409(0x253)]=_0x14b121;}),_0x14c2c1['forEach']((_0x1e2055,_0x122510)=>{var _0xde9f70=_0x19ee41;_0xa377f0[_0x122510][_0xde9f70(0x1b2)]=_0x1e2055;}),_0x1ba59b['forEach']((_0x191f78,_0x46ba16)=>{_0xa377f0[_0x46ba16]['batch_code']=_0x191f78;}),_0x43f1d8[_0x19ee41(0x1ed)]((_0x4313e8,_0x1c07c1)=>{var _0x29a8ea=_0x19ee41;_0xa377f0[_0x1c07c1][_0x29a8ea(0x20f)]=_0x4313e8;}),_0x4c3e3c[_0x19ee41(0x1ed)]((_0x24f692,_0x5e54eb)=>{var _0x44f75b=_0x19ee41;_0xa377f0[_0x5e54eb][_0x44f75b(0x1b1)]=_0x24f692;}),_0x58cfe0[_0x19ee41(0x1ed)]((_0x365e53,_0x338934)=>{var _0x367a82=_0x19ee41;_0xa377f0[_0x338934][_0x367a82(0x1b4)]=_0x365e53;}),_0x5555d4[_0x19ee41(0x1ed)]((_0x274e5f,_0x11b51e)=>{var _0x35e6c4=_0x19ee41;_0xa377f0[_0x11b51e][_0x35e6c4(0x25c)]=_0x274e5f;}),_0x373bec[_0x19ee41(0x1ed)]((_0x491e55,_0xe67ea1)=>{var _0x2c7cae=_0x19ee41;_0xa377f0[_0xe67ea1][_0x2c7cae(0x198)]=_0x491e55;}),_0x36dd6b[_0x19ee41(0x1ed)]((_0x6c1f0c,_0x3fd631)=>{_0xa377f0[_0x3fd631]['invoice']=_0x6c1f0c;});var _0x1ad05d=0x0;_0xa377f0[_0x19ee41(0x1ed)](_0x311c9b=>{var _0x5ae15c=_0x19ee41;parseFloat(_0x311c9b['stock'])<parseFloat(_0x311c9b[_0x5ae15c(0x152)])&&parseFloat(_0x311c9b[_0x5ae15c(0x152)])>parseFloat(_0x311c9b[_0x5ae15c(0x19f)])&&(console[_0x5ae15c(0x1eb)](_0x311c9b[_0x5ae15c(0x19f)]+'\x20<>\x20'+_0x311c9b[_0x5ae15c(0x152)]),_0x1ad05d++);});if(_0x1ad05d!=0x0)return _0x275f65[_0x19ee41(0x1a3)]('errors',_0x19ee41(0x21d)),_0x215b9d[_0x19ee41(0x1dc)](_0x19ee41(0x1fe));const _0x16ab76=_0xa377f0[_0x19ee41(0x1ea)](_0x8b6fbd=>_0x8b6fbd[_0x19ee41(0x152)]!=='0'&&_0x8b6fbd[_0x19ee41(0x152)]!==''),_0x3d615b=new sales_finished({'invoice':_0x541817,'customer':_0x275f65[_0x19ee41(0x1ee)]['customer'],'date':_0x18da44,'warehouse_name':_0x597554,'sale_product':_0x16ab76,'note':_0x247b78,'room':_0x3b13f3,'primary_code':_0x1f1e87,'secondary_code':_0x2b4114,'prod_code':_0x2b114d,'SCRN':_0x939cf6,'finalize':'False','mode_transpo':_0x5988f8,'name_driver':_0x1f52f9}),_0x337a07=await _0x3d615b[_0x19ee41(0x164)](),_0x1f7a60=await sales_finished[_0x19ee41(0x15e)]({'invoice':_0x541817}),_0x3c3a65=new c_payment_data({'invoice':_0x541817,'customer':_0x275f65[_0x19ee41(0x1ee)][_0x19ee41(0x24e)],'reason':_0x19ee41(0x21f)});await _0x3c3a65[_0x19ee41(0x164)]();const _0x4164cd=await master_shop[_0x19ee41(0x18d)](),_0x1b17b6=await email_settings['findOne'](),_0x2d2fde=await customer[_0x19ee41(0x15e)]({'name':_0x275f65[_0x19ee41(0x1ee)]['customer']});_0x4164cd[0x0][_0x19ee41(0x183)]==0x1?(right_currency=_0x4164cd[0x0][_0x19ee41(0x19b)],left_currency=''):(right_currency='',left_currency=_0x4164cd[0x0]['currency']);var _0x474f1e=_0x48c739,_0x2fa4bf=_0x30a666,_0x415a3f='',_0x2044a8;for(_0x2044a8 in _0x474f1e){_0x415a3f+=_0x19ee41(0x24d)+_0x19ee41(0x22f)+_0x474f1e[_0x2044a8]+_0x19ee41(0x1da)+_0x19ee41(0x22f)+_0x2fa4bf[_0x2044a8]+'</td>'+_0x19ee41(0x210);}console[_0x19ee41(0x1eb)](_0x19ee41(0x19a),_0x415a3f),_0x275f65[_0x19ee41(0x1a3)](_0x19ee41(0x21c),_0x19ee41(0x162)),_0x215b9d[_0x19ee41(0x1dc)](_0x19ee41(0x1e0)+_0x337a07['_id']);}catch(_0x564fa1){console[_0x19ee41(0x1eb)](_0x564fa1);}}),router['get'](a0_0xadf73f(0x1f1),auth,async(_0x57d222,_0x26a2e9)=>{var _0x54ada8=a0_0xadf73f;try{const {username:_0x5ef69c,email:_0x4d095b,role:_0x516b12}=_0x57d222[_0x54ada8(0x1a2)],_0x59834b=_0x57d222[_0x54ada8(0x1a2)],_0x20bec4=await profile[_0x54ada8(0x15e)]({'email':_0x59834b[_0x54ada8(0x1ca)]}),_0x217e42=await master_shop[_0x54ada8(0x18d)](),_0x471ede=_0x57d222['params']['id'],_0x36e9a0=await sales_finished['findById'](_0x471ede),_0x535ef4=await warehouse[_0x54ada8(0x200)]([{'$match':{'name':_0x36e9a0[_0x54ada8(0x163)]}},{'$unwind':_0x54ada8(0x204)},{'$group':{'_id':_0x54ada8(0x233),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x54ada8(0x1d2)},'bay':{'$first':_0x54ada8(0x21b)},'bin':{'$first':_0x54ada8(0x1ad)},'type':{'$first':_0x54ada8(0x156)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x54ada8(0x1cf)},'product_code':{'$first':_0x54ada8(0x218)},'storage':{'$first':_0x54ada8(0x15a)},'rack':{'$first':_0x54ada8(0x243)},'expiry_date':{'$first':_0x54ada8(0x1d4)},'production_date':{'$first':_0x54ada8(0x1a5)},'batch_code':{'$first':_0x54ada8(0x225)},'room':{'$first':_0x54ada8(0x1ef)},'room_data':{'$first':_0x54ada8(0x1cd)}}}]),_0x49eede=await customer[_0x54ada8(0x18d)]({});let _0x29c34e;if(_0x59834b['role']==_0x54ada8(0x1e8)){const _0xbbb5be=await staff[_0x54ada8(0x15e)]({'email':_0x59834b[_0x54ada8(0x1ca)]});_0x29c34e=await warehouse[_0x54ada8(0x200)]([{'$match':{'status':_0x54ada8(0x254),'name':_0xbbb5be[_0x54ada8(0x1bd)]}},{'$group':{'_id':_0x54ada8(0x1e9),'name':{'$first':'$name'}}}]);}else _0x29c34e=await warehouse['aggregate']([{'$match':{'status':_0x54ada8(0x254)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x5b4fc3=await product[_0x54ada8(0x18d)]({});if(_0x217e42[0x0][_0x54ada8(0x1f5)]==_0x54ada8(0x1f7)){var _0x2723c7=users[_0x54ada8(0x165)];console[_0x54ada8(0x1eb)](_0x2723c7);}else{if(_0x217e42[0x0][_0x54ada8(0x1f5)]==_0x54ada8(0x226))var _0x2723c7=users[_0x54ada8(0x226)];else{if(_0x217e42[0x0][_0x54ada8(0x1f5)]==_0x54ada8(0x1ac))var _0x2723c7=users[_0x54ada8(0x1ac)];else{if(_0x217e42[0x0][_0x54ada8(0x1f5)]==_0x54ada8(0x252))var _0x2723c7=users['Spanish'];else{if(_0x217e42[0x0][_0x54ada8(0x1f5)]==_0x54ada8(0x195))var _0x2723c7=users[_0x54ada8(0x195)];else{if(_0x217e42[0x0][_0x54ada8(0x1f5)]==_0x54ada8(0x184))var _0x2723c7=users[_0x54ada8(0x1b5)];else{if(_0x217e42[0x0][_0x54ada8(0x1f5)]=='Chinese')var _0x2723c7=users[_0x54ada8(0x1aa)];else{if(_0x217e42[0x0][_0x54ada8(0x1f5)]==_0x54ada8(0x1fc))var _0x2723c7=users['Arabic'];}}}}}}}_0x26a2e9['render'](_0x54ada8(0x1d0),{'success':_0x57d222[_0x54ada8(0x1a3)]('success'),'errors':_0x57d222[_0x54ada8(0x1a3)](_0x54ada8(0x178)),'role':_0x59834b,'profile':_0x20bec4,'customer':_0x49eede,'warehouse':_0x29c34e,'product':_0x535ef4,'user':_0x36e9a0,'master_shop':_0x217e42,'unit':_0x5b4fc3,'language':_0x2723c7});}catch(_0xc6da19){console[_0x54ada8(0x1eb)](_0xc6da19);}}),router[a0_0xadf73f(0x242)](a0_0xadf73f(0x1f1),auth,async(_0x38c9d5,_0x5cf46d)=>{var _0x140415=a0_0xadf73f;try{const _0x464578=_0x38c9d5[_0x140415(0x230)]['id'],{invoice:_0x471464,warehouse_name:_0x41c108,room:_0x42a581}=_0x38c9d5[_0x140415(0x1ee)],_0x105281=await sales_finished['findOne']({'invoice':_0x471464}),_0x4e84ff=_0x105281[_0x140415(0x175)]['map'](async _0x460b8d=>{var _0x30a585=_0x140415,_0x3cf03=await warehouse[_0x30a585(0x15e)]({'name':_0x41c108,'room':_0x460b8d[_0x30a585(0x198)],'warehouse_category':'Finished\x20Goods'});const _0x1e437d=_0x3cf03[_0x30a585(0x25b)][_0x30a585(0x1b8)](_0x513dce=>{var _0x36e18b=_0x30a585;_0x513dce[_0x36e18b(0x1dd)]==_0x460b8d['product_name']&&_0x513dce['bay']==_0x460b8d[_0x36e18b(0x15d)]&&_0x513dce['expiry_date']==_0x460b8d['expiry_date']&&_0x513dce['production_date']==_0x460b8d[_0x36e18b(0x1b1)]&&_0x513dce['batch_code']==_0x460b8d[_0x36e18b(0x217)]&&_0x513dce['_id']==_0x460b8d[_0x36e18b(0x23a)]&&(_0x513dce['product_stock']>0x0&&(console[_0x36e18b(0x1eb)](_0x513dce[_0x36e18b(0x1dd)]+_0x36e18b(0x238)+_0x460b8d[_0x36e18b(0x1dd)]+_0x36e18b(0x159)+_0x513dce[_0x36e18b(0x15d)]+_0x36e18b(0x238)+_0x460b8d[_0x36e18b(0x15d)]+_0x36e18b(0x159)+_0x513dce['production_date']+_0x36e18b(0x238)+_0x460b8d[_0x36e18b(0x1b1)]+_0x36e18b(0x159)+_0x513dce['expiry_date']+'\x20==\x20'+_0x460b8d[_0x36e18b(0x20f)]+_0x36e18b(0x159)+_0x513dce['batch_code']+_0x36e18b(0x238)+_0x460b8d[_0x36e18b(0x217)]+'\x20&&\x20'+_0x513dce[_0x36e18b(0x18b)]+'\x20==\x20'+_0x460b8d['invoice']+_0x36e18b(0x159)+_0x513dce['product_stock']+_0x36e18b(0x158)+_0x460b8d[_0x36e18b(0x152)]+_0x36e18b(0x25d)+_0x460b8d[_0x36e18b(0x198)]+'\x20&&\x20'+_0x513dce['_id']+'\x20==\x20'+_0x460b8d['id_transaction_from']),_0x513dce[_0x36e18b(0x209)]=Math['max'](0x0,Math[_0x36e18b(0x260)](_0x513dce['product_stock'])-Math['abs'](_0x460b8d['quantity']))));});return _0x3cf03;});Promise[_0x140415(0x245)](_0x4e84ff)[_0x140415(0x190)](async _0x2c47f4=>{var _0x2b87ee=_0x140415;try{for(const _0x485504 of _0x2c47f4){await _0x485504['save']();}_0x105281[_0x2b87ee(0x191)]=_0x2b87ee(0x1b3);const _0x272123=await _0x105281[_0x2b87ee(0x164)](),_0x1c96fc=await master_shop[_0x2b87ee(0x18d)](),_0x111c64=await email_settings[_0x2b87ee(0x15e)](),_0x5485d6=await supervisor_settings[_0x2b87ee(0x18d)]();var _0x56d96f=_0x105281[_0x2b87ee(0x175)],_0xc867ce='',_0x3e6a5d;for(_0x3e6a5d in _0x56d96f){var _0x418335='FG';_0x105281[_0x2b87ee(0x163)]=='DRY\x20GOODS'&&(_0x418335='DG'),_0xc867ce+=_0x2b87ee(0x24d)+_0x2b87ee(0x22f)+_0x56d96f[_0x3e6a5d][_0x2b87ee(0x1dd)]+'</td>'+_0x2b87ee(0x22f)+_0x56d96f[_0x3e6a5d][_0x2b87ee(0x15b)]+_0x2b87ee(0x1da)+_0x2b87ee(0x22f)+_0x56d96f[_0x3e6a5d][_0x2b87ee(0x152)]+_0x2b87ee(0x1da)+_0x2b87ee(0x22f)+_0x56d96f[_0x3e6a5d]['unit']+_0x2b87ee(0x1da)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x56d96f[_0x3e6a5d]['secondary_unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x105281['warehouse_name']+_0x2b87ee(0x1da)+_0x2b87ee(0x22f)+_0x56d96f[_0x3e6a5d][_0x2b87ee(0x198)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x418335+_0x56d96f[_0x3e6a5d][_0x2b87ee(0x15d)]+_0x2b87ee(0x1da);}let _0x228795=nodemailer[_0x2b87ee(0x235)]({'host':_0x111c64[_0x2b87ee(0x1bf)],'port':Number(_0x111c64['port']),'secure':![],'auth':{'user':_0x111c64[_0x2b87ee(0x1ca)],'pass':_0x111c64[_0x2b87ee(0x25f)]}}),_0x3249e8={'from':_0x111c64[_0x2b87ee(0x1ca)],'to':_0x5485d6[0x0]['FGSEmail'],'subject':_0x2b87ee(0x1f2),'attachments':[{'filename':_0x2b87ee(0x194),'path':__dirname+_0x2b87ee(0x1ec)+_0x2b87ee(0x189)+_0x1c96fc[0x0][_0x2b87ee(0x154)],'cid':_0x2b87ee(0x186)}],'html':_0x2b87ee(0x1a7)+'<html><head><title></title>'+_0x2b87ee(0x1cc)+_0x2b87ee(0x223)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2b87ee(0x223)+_0x2b87ee(0x1cb)+_0x2b87ee(0x22d)+'<div>'+_0x2b87ee(0x1c3)+_0x1c96fc[0x0][_0x2b87ee(0x248)]+_0x2b87ee(0x20b)+_0x2b87ee(0x22d)+_0x2b87ee(0x22d)+_0x2b87ee(0x227)+'<div>'+_0x2b87ee(0x256)+'\x20Order\x20Number\x20:\x20'+_0x105281[_0x2b87ee(0x18b)]+'\x20'+_0x2b87ee(0x237)+_0x2b87ee(0x206)+_0x105281[_0x2b87ee(0x1c8)]+'\x20'+_0x2b87ee(0x1af)+_0x2b87ee(0x213)+_0x2b87ee(0x22d)+_0x2b87ee(0x23f)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x2b87ee(0x241)+_0x2b87ee(0x244)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x2b87ee(0x208)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x2b87ee(0x21a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x2b87ee(0x1f6)+_0x2b87ee(0x210)+_0x2b87ee(0x199)+_0x2b87ee(0x232)+'\x20'+_0xc867ce+'\x20'+_0x2b87ee(0x151)+_0x2b87ee(0x1ff)+_0x2b87ee(0x223)+_0x2b87ee(0x239)+_0x2b87ee(0x168)+_0x1c96fc[0x0]['site_title']+_0x2b87ee(0x213)+_0x2b87ee(0x22d)+_0x2b87ee(0x22d)+'</body></html>'};_0x228795[_0x2b87ee(0x157)](_0x3249e8,function(_0x372511,_0xaa986b){var _0x50e730=_0x2b87ee;_0x372511?(console[_0x50e730(0x1eb)](_0x372511),console['log'](_0x50e730(0x17b))):console[_0x50e730(0x1eb)](_0x50e730(0x1c0));}),_0x38c9d5[_0x2b87ee(0x1a3)](_0x2b87ee(0x21c),_0x2b87ee(0x1d6)),_0x5cf46d[_0x2b87ee(0x1dc)](_0x2b87ee(0x1ab)+_0x464578);}catch(_0x308628){console[_0x2b87ee(0x1c4)](_0x308628),_0x5cf46d[_0x2b87ee(0x246)](0x1f4)[_0x2b87ee(0x21e)]({'error':_0x2b87ee(0x1b9)});}})[_0x140415(0x179)](_0x13aed0=>{var _0x3ce2a8=_0x140415;console['error'](_0x13aed0),_0x5cf46d[_0x3ce2a8(0x246)](0x1f4)[_0x3ce2a8(0x21e)]({'error':'An\x20error\x20occurred.'});});}catch(_0x110bf4){console[_0x140415(0x1eb)](_0x110bf4);}}),router[a0_0xadf73f(0x18e)](a0_0xadf73f(0x17a),auth,async(_0x104a26,_0x4c1f3a)=>{var _0xa2377d=a0_0xadf73f;try{const {username:_0xe35a61,email:_0x5b7477,role:_0x51def1}=_0x104a26[_0xa2377d(0x1a2)],_0x24feee=_0x104a26[_0xa2377d(0x1a2)],_0x14fd35=await profile[_0xa2377d(0x15e)]({'email':_0x24feee[_0xa2377d(0x1ca)]}),_0x282955=await master_shop['find'](),_0x548ad1=_0x104a26['params']['id'],_0x3e574a=await sales_finished[_0xa2377d(0x20d)](_0x548ad1);let _0x278bdc=new Date(_0x3e574a['expiry_date']),_0x3f22de=('0'+_0x278bdc[_0xa2377d(0x166)]())[_0xa2377d(0x1d3)](-0x2),_0x9e5dde=('0'+(_0x278bdc[_0xa2377d(0x1f9)]()+0x1))['slice'](-0x2),_0x4dab59=_0x278bdc[_0xa2377d(0x17f)](),_0x26975f=_0x4dab59+'-'+_0x9e5dde+'-'+_0x3f22de;var _0x284503=[_0xa2377d(0x257),_0xa2377d(0x188)];const _0x1b28d7=await warehouse['aggregate']([{'$match':{'name':_0x3e574a['warehouse_name'],'room':_0x3e574a['room']}},{'$unwind':_0xa2377d(0x204)},{'$group':{'_id':_0xa2377d(0x233),'name':{'$first':_0xa2377d(0x23e)},'product_stock':{'$first':_0xa2377d(0x1d2)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0xa2377d(0x1ad)},'type':{'$first':_0xa2377d(0x156)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xa2377d(0x196)},'secondary_code':{'$first':_0xa2377d(0x1cf)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xa2377d(0x15a)},'rack':{'$first':_0xa2377d(0x243)}}}]),_0x410f23=await customer[_0xa2377d(0x18d)]({});let _0x43c9b8;if(_0x24feee[_0xa2377d(0x169)]=='staff'){const _0x2793a6=await staff['findOne']({'email':_0x24feee[_0xa2377d(0x1ca)]});_0x43c9b8=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x2793a6[_0xa2377d(0x1bd)]}},{'$group':{'_id':'$name','name':{'$first':_0xa2377d(0x1e9)}}}]);}else _0x43c9b8=await warehouse['aggregate']([{'$match':{'status':_0xa2377d(0x254)}},{'$group':{'_id':'$name','name':{'$first':_0xa2377d(0x1e9)}}}]);const _0x5ca9c7=await product[_0xa2377d(0x18d)]({});if(_0x282955[0x0]['language']==_0xa2377d(0x1f7)){var _0x12c229=users['English'];console[_0xa2377d(0x1eb)](_0x12c229);}else{if(_0x282955[0x0][_0xa2377d(0x1f5)]==_0xa2377d(0x226))var _0x12c229=users['Hindi'];else{if(_0x282955[0x0]['language']==_0xa2377d(0x1ac))var _0x12c229=users[_0xa2377d(0x1ac)];else{if(_0x282955[0x0][_0xa2377d(0x1f5)]==_0xa2377d(0x252))var _0x12c229=users['Spanish'];else{if(_0x282955[0x0][_0xa2377d(0x1f5)]==_0xa2377d(0x195))var _0x12c229=users[_0xa2377d(0x195)];else{if(_0x282955[0x0]['language']=='Portuguese\x20(BR)')var _0x12c229=users[_0xa2377d(0x1b5)];else{if(_0x282955[0x0][_0xa2377d(0x1f5)]==_0xa2377d(0x1aa))var _0x12c229=users[_0xa2377d(0x1aa)];else{if(_0x282955[0x0][_0xa2377d(0x1f5)]==_0xa2377d(0x1fc))var _0x12c229=users[_0xa2377d(0x177)];}}}}}}}_0x4c1f3a[_0xa2377d(0x1a6)](_0xa2377d(0x17c),{'success':_0x104a26[_0xa2377d(0x1a3)](_0xa2377d(0x21c)),'errors':_0x104a26[_0xa2377d(0x1a3)](_0xa2377d(0x178)),'role':_0x24feee,'profile':_0x14fd35,'customer':_0x410f23,'warehouse':_0x43c9b8,'product':_0x1b28d7,'user':_0x3e574a,'master_shop':_0x282955,'unit':_0x5ca9c7,'language':_0x12c229,'rooms_data':_0x284503,'ed_fullDate':_0x26975f});}catch(_0x4d9d13){console[_0xa2377d(0x1eb)](_0x4d9d13);}}),router[a0_0xadf73f(0x242)]('/view/:id',auth,async(_0x3e5791,_0x163014)=>{var _0x30dd9e=a0_0xadf73f;try{const _0x39bba5=_0x3e5791[_0x30dd9e(0x230)]['id'],_0x548e2e=await sales_finished['findOne']({'_id':_0x3e5791[_0x30dd9e(0x230)]['id']}),_0x15dac4=await warehouse[_0x30dd9e(0x15e)]({'name':_0x548e2e['warehouse_name'],'room':_0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x203)],'warehouse_category':_0x30dd9e(0x1de)}),{invoice:_0x2e447b,customer:_0x3ed561,date:_0x2d340d,warehouse_name:_0x1cefc8,product_name:_0x3646c0,stock:_0x4dcbb0,adjust_qty:_0x1c9483,note:_0x3cb972,room:_0x100f12,primary_code:_0x1acc1e,secondary_code:_0x5721d9,prod_code:_0x59721f,level:_0x1b1ecd,isle:_0x320b14,pallet:_0x1c3d46,expiry_date:_0x1e2757}=_0x3e5791[_0x30dd9e(0x1ee)];if(typeof _0x3646c0==_0x30dd9e(0x1fb))var _0x5e9ccc=[_0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x1dd)]],_0x4bdb8a=[_0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x19f)]],_0x5c37dd=[_0x3e5791[_0x30dd9e(0x1ee)]['adjust_qty']],_0x354bc7=[_0x3e5791['body'][_0x30dd9e(0x202)]],_0x352e67=[_0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x247)]],_0x27faf0=[_0x3e5791['body']['prod_code']],_0x194867=[_0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x1ce)]],_0x176841=[_0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x20f)]];else var _0x5e9ccc=[..._0x3e5791['body'][_0x30dd9e(0x1dd)]],_0x4bdb8a=[..._0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x19f)]],_0x5c37dd=[..._0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x1bb)]],_0x354bc7=[..._0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x202)]],_0x352e67=[..._0x3e5791['body'][_0x30dd9e(0x247)]],_0x27faf0=[..._0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x1f3)]],_0x194867=[..._0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x1ce)]],_0x176841=[..._0x3e5791[_0x30dd9e(0x1ee)]['expiry_date']];const _0x4aa890=_0x5e9ccc[_0x30dd9e(0x1b8)](_0x5c5f75=>{return _0x5c5f75={'product_name':_0x5c5f75};});_0x4bdb8a[_0x30dd9e(0x1ed)]((_0xbecbf1,_0xbeb2c1)=>{_0x4aa890[_0xbeb2c1]['stock']=_0xbecbf1;}),_0x5c37dd[_0x30dd9e(0x1ed)]((_0x43f2ac,_0x26cecd)=>{var _0x3c44dd=_0x30dd9e;_0x4aa890[_0x26cecd][_0x3c44dd(0x152)]=_0x43f2ac;}),_0x354bc7[_0x30dd9e(0x1ed)]((_0xc065d,_0x5f0fbe)=>{var _0x5dddcd=_0x30dd9e;_0x4aa890[_0x5f0fbe][_0x5dddcd(0x202)]=_0xc065d;}),_0x352e67[_0x30dd9e(0x1ed)]((_0x275104,_0x523e93)=>{_0x4aa890[_0x523e93]['secondary_code']=_0x275104;}),_0x27faf0[_0x30dd9e(0x1ed)]((_0x355c6c,_0x5bfa26)=>{var _0x214e84=_0x30dd9e;_0x4aa890[_0x5bfa26][_0x214e84(0x15b)]=_0x355c6c;}),_0x194867[_0x30dd9e(0x1ed)]((_0x35d5a4,_0x2b41f9)=>{var _0x15535a=_0x30dd9e;_0x4aa890[_0x2b41f9][_0x15535a(0x1ce)]=_0x35d5a4;}),_0x176841[_0x30dd9e(0x1ed)]((_0x1892a0,_0x1a0d4d)=>{var _0x214ad5=_0x30dd9e;_0x4aa890[_0x1a0d4d][_0x214ad5(0x20f)]=_0x1892a0;});var _0x5ae110=0x0;_0x4aa890['forEach'](_0x4df8e0=>{var _0x416496=_0x30dd9e;console[_0x416496(0x1eb)](_0x416496(0x192),_0x4df8e0),(parseInt(_0x4df8e0[_0x416496(0x19f)])<parseInt(_0x4df8e0['quantity'])||parseInt(_0x4df8e0['quantity'])==0x0)&&_0x5ae110++;});if(_0x5ae110!=0x0)return _0x3e5791['flash'](_0x30dd9e(0x178),_0x30dd9e(0x1a0)),_0x163014[_0x30dd9e(0x1dc)](_0x30dd9e(0x1fe));_0x548e2e[_0x30dd9e(0x175)][_0x30dd9e(0x1ed)](_0x60d27e=>{var _0x15ac11=_0x30dd9e;const _0x45dab8=_0x15dac4[_0x15ac11(0x25b)][_0x15ac11(0x1b8)](_0x4e20df=>{var _0x331180=_0x15ac11;_0x4e20df[_0x331180(0x1dd)]==_0x60d27e[_0x331180(0x1dd)]&&_0x4e20df[_0x331180(0x15d)]==_0x60d27e[_0x331180(0x15d)]&&(_0x4e20df[_0x331180(0x209)]=parseInt(_0x4e20df[_0x331180(0x209)])+parseInt(_0x60d27e[_0x331180(0x152)]));});}),await _0x15dac4[_0x30dd9e(0x164)]();const _0x1771fb=_0x4aa890[_0x30dd9e(0x1ea)](_0x3b4898=>_0x3b4898['quantity']!=='0'&&_0x3b4898[_0x30dd9e(0x152)]!=='');_0x548e2e[_0x30dd9e(0x18b)]=_0x2e447b,_0x548e2e[_0x30dd9e(0x24e)]=_0x3ed561,_0x548e2e[_0x30dd9e(0x1c8)]=_0x2d340d,_0x548e2e['warehouse_name']=_0x1cefc8,_0x548e2e['sale_product']=_0x1771fb,_0x548e2e['note']=_0x3cb972,_0x548e2e['room']=_0x100f12;const _0x471c5b=await _0x548e2e[_0x30dd9e(0x164)](),_0x1737f5=await sales_finished['findOne']({'_id':_0x3e5791['params']['id']}),_0x48da5d=await warehouse[_0x30dd9e(0x15e)]({'name':_0x1cefc8,'room':_0x100f12,'warehouse_category':_0x30dd9e(0x1de)});_0x1737f5[_0x30dd9e(0x175)]['forEach'](_0x3beecf=>{var _0x186dd5=_0x30dd9e;const _0x313fe2=_0x48da5d[_0x186dd5(0x25b)][_0x186dd5(0x1b8)](_0x59ff4d=>{var _0x10ffb0=_0x186dd5;_0x59ff4d[_0x10ffb0(0x1dd)]==_0x3beecf[_0x10ffb0(0x1dd)]&&_0x59ff4d[_0x10ffb0(0x15d)]==_0x3beecf['bay']&&(_0x59ff4d[_0x10ffb0(0x209)]=parseInt(_0x59ff4d[_0x10ffb0(0x209)])-parseInt(_0x3beecf['quantity']));});}),console[_0x30dd9e(0x1eb)](_0x30dd9e(0x1d9),_0x48da5d),await _0x48da5d[_0x30dd9e(0x164)]();const _0x36030c=await c_payment_data['findOne']({'invoice':_0x3e5791[_0x30dd9e(0x1ee)][_0x30dd9e(0x18b)]});_0x36030c[_0x30dd9e(0x20c)]=_0x3e5791[_0x30dd9e(0x1ee)]['suppliers'],await _0x36030c[_0x30dd9e(0x164)](),_0x3e5791[_0x30dd9e(0x1a3)](_0x30dd9e(0x21c),_0x30dd9e(0x1d6)),_0x163014['redirect']('/all_sales_finished/view');}catch(_0x3ae4a4){console[_0x30dd9e(0x1eb)](_0x3ae4a4);}}),router[a0_0xadf73f(0x242)](a0_0xadf73f(0x18a),auth,async(_0x1a0021,_0x279db3)=>{var _0x21476f=a0_0xadf73f;try{const _0x159b52=_0x1a0021[_0x21476f(0x230)]['id'],{invoice:_0x3d213a,customer:_0x151e4f,receivable_amount:_0x5cf00c,received_amount:_0x1559fe}=_0x1a0021[_0x21476f(0x1ee)],_0xcf55f1=await sales[_0x21476f(0x20d)](_0x159b52);console[_0x21476f(0x1eb)](_0xcf55f1);var _0x56d5d8=_0x5cf00c-_0x1559fe;console[_0x21476f(0x1eb)](_0x1559fe),_0xcf55f1[_0x21476f(0x1f4)]=parseFloat(_0x1559fe)+parseFloat(_0xcf55f1[_0x21476f(0x1f4)]),_0xcf55f1['due_amount']=_0x56d5d8,console[_0x21476f(0x1eb)](_0xcf55f1);const _0x355054=await _0xcf55f1[_0x21476f(0x164)](),_0xd94ff7=await c_payment_data[_0x21476f(0x15e)]({'invoice':_0x3d213a});_0xd94ff7[_0x21476f(0x259)]=_0x56d5d8,await _0xd94ff7[_0x21476f(0x164)]();let _0x434b39=new Date(),_0x47b8a5=('0'+_0x434b39[_0x21476f(0x166)]())[_0x21476f(0x1d3)](-0x2),_0x219be1=('0'+(_0x434b39[_0x21476f(0x1f9)]()+0x1))[_0x21476f(0x1d3)](-0x2),_0x3fb233=_0x434b39[_0x21476f(0x17f)](),_0x2743d5=_0x3fb233+'-'+_0x219be1+'-'+_0x47b8a5;const _0x2c07ec=new customer_payment({'invoice':_0x3d213a,'date':_0x3fb233+'-'+_0x219be1+'-'+_0x47b8a5,'customer':_0x151e4f,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x1559fe}),_0xb3e06e=await _0x2c07ec[_0x21476f(0x164)]();_0x1a0021[_0x21476f(0x1a3)](_0x21476f(0x21c),'payment\x20successfull'),_0x279db3['redirect'](_0x21476f(0x22b));}catch(_0x4ed1c0){console[_0x21476f(0x1eb)](_0x4ed1c0);}}),router['get'](a0_0xadf73f(0x250),auth,async(_0x46b029,_0x7849df)=>{var _0x22a0cc=a0_0xadf73f;try{const {username:_0x1ff1d9,email:_0x483f4a,role:_0x1cb2ad}=_0x46b029[_0x22a0cc(0x1a2)],_0x8b8159=_0x46b029[_0x22a0cc(0x1a2)],_0x3a3b76=await profile['findOne']({'email':_0x8b8159[_0x22a0cc(0x1ca)]}),_0x1dfcd5=await master_shop[_0x22a0cc(0x18d)]();console[_0x22a0cc(0x1eb)]('master',_0x1dfcd5);const _0x1d45a4=_0x46b029[_0x22a0cc(0x230)]['id'],_0x174bd3=await sales['findById'](_0x1d45a4);console['log'](_0x174bd3);const _0x3b185c=await customer[_0x22a0cc(0x15e)]({'name':_0x174bd3[_0x22a0cc(0x24e)]});console[_0x22a0cc(0x1eb)](_0x3b185c);if(_0x1dfcd5[0x0][_0x22a0cc(0x1f5)]=='English\x20(US)'){var _0x2ecff8=users[_0x22a0cc(0x165)];console[_0x22a0cc(0x1eb)](_0x2ecff8);}else{if(_0x1dfcd5[0x0]['language']==_0x22a0cc(0x226))var _0x2ecff8=users['Hindi'];else{if(_0x1dfcd5[0x0][_0x22a0cc(0x1f5)]=='German')var _0x2ecff8=users['German'];else{if(_0x1dfcd5[0x0]['language']=='Spanish')var _0x2ecff8=users['Spanish'];else{if(_0x1dfcd5[0x0][_0x22a0cc(0x1f5)]=='French')var _0x2ecff8=users[_0x22a0cc(0x195)];else{if(_0x1dfcd5[0x0]['language']=='Portuguese\x20(BR)')var _0x2ecff8=users[_0x22a0cc(0x1b5)];else{if(_0x1dfcd5[0x0][_0x22a0cc(0x1f5)]==_0x22a0cc(0x1aa))var _0x2ecff8=users[_0x22a0cc(0x1aa)];else{if(_0x1dfcd5[0x0][_0x22a0cc(0x1f5)]=='Arabic\x20(ae)')var _0x2ecff8=users[_0x22a0cc(0x177)];}}}}}}}_0x7849df[_0x22a0cc(0x1a6)](_0x22a0cc(0x234),{'success':_0x46b029[_0x22a0cc(0x1a3)](_0x22a0cc(0x21c)),'errors':_0x46b029['flash']('errors'),'role':_0x8b8159,'profile':_0x3a3b76,'master_shop':_0x1dfcd5,'customers':_0x3b185c,'sales':_0x174bd3,'language':_0x2ecff8});}catch(_0x1f8a80){console[_0x22a0cc(0x1eb)](_0x1f8a80);}}),router[a0_0xadf73f(0x18e)](a0_0xadf73f(0x23d),auth,async(_0x1552b0,_0x31bbdb)=>{var _0x2a9972=a0_0xadf73f;try{const {username:_0x408008,email:_0x4971f9,role:_0x55b8f4}=_0x1552b0[_0x2a9972(0x1a2)],_0x5af499=_0x1552b0[_0x2a9972(0x1a2)],_0x310ad9=await profile[_0x2a9972(0x15e)]({'email':_0x5af499['email']}),_0x106e15=await master_shop['find'](),_0x2b63d7=_0x1552b0[_0x2a9972(0x230)]['id'],_0x7a293=await sales_finished[_0x2a9972(0x20d)](_0x2b63d7),_0x2d1ef2=await warehouse[_0x2a9972(0x200)]([{'$match':{'name':_0x7a293[_0x2a9972(0x163)]}},{'$unwind':_0x2a9972(0x204)},{'$group':{'_id':_0x2a9972(0x233),'name':{'$first':_0x2a9972(0x23e)},'product_stock':{'$first':_0x2a9972(0x1d2)},'bay':{'$first':_0x2a9972(0x21b)},'bin':{'$first':_0x2a9972(0x1ad)},'type':{'$first':_0x2a9972(0x156)},'floorlevel':{'$first':_0x2a9972(0x1c7)},'primary_code':{'$first':_0x2a9972(0x196)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x2a9972(0x15a)},'rack':{'$first':_0x2a9972(0x243)},'expiry_date':{'$first':_0x2a9972(0x1d4)},'production_date':{'$first':_0x2a9972(0x1a5)},'unit':{'$first':_0x2a9972(0x1be)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x2a9972(0x1fa)},'batch_code':{'$first':_0x2a9972(0x225)},'maxPerUnit':{'$first':_0x2a9972(0x236)}}}]),_0x4c96fc=await product[_0x2a9972(0x18d)]({}),_0x5a1378=await warehouse[_0x2a9972(0x200)]([{'$match':{'status':_0x2a9972(0x254),'warehouse_category':_0x2a9972(0x1de),'name':{'$ne':_0x2a9972(0x1f0),'$ne':_0x2a9972(0x22c)}}},{'$group':{'_id':_0x2a9972(0x1e9),'name':{'$first':_0x2a9972(0x1e9)}}},{'$sort':{'name':0x1}}]);var _0x1ab79e=[_0x2a9972(0x1a8)];const _0x4fb7b7=await warehouse[_0x2a9972(0x200)]([{'$match':{'status':_0x2a9972(0x254),'name':_0x2a9972(0x22c)}},{'$group':{'_id':_0x2a9972(0x1e9),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x106e15[0x0][_0x2a9972(0x1f5)]==_0x2a9972(0x1f7)){var _0x582420=users[_0x2a9972(0x165)];console[_0x2a9972(0x1eb)](_0x582420);}else{if(_0x106e15[0x0][_0x2a9972(0x1f5)]==_0x2a9972(0x226))var _0x582420=users[_0x2a9972(0x226)];else{if(_0x106e15[0x0][_0x2a9972(0x1f5)]==_0x2a9972(0x1ac))var _0x582420=users[_0x2a9972(0x1ac)];else{if(_0x106e15[0x0][_0x2a9972(0x1f5)]==_0x2a9972(0x252))var _0x582420=users['Spanish'];else{if(_0x106e15[0x0]['language']==_0x2a9972(0x195))var _0x582420=users['French'];else{if(_0x106e15[0x0][_0x2a9972(0x1f5)]==_0x2a9972(0x184))var _0x582420=users['Portuguese'];else{if(_0x106e15[0x0][_0x2a9972(0x1f5)]=='Chinese')var _0x582420=users[_0x2a9972(0x1aa)];else{if(_0x106e15[0x0][_0x2a9972(0x1f5)]==_0x2a9972(0x1fc))var _0x582420=users[_0x2a9972(0x177)];}}}}}}}_0x31bbdb['render'](_0x2a9972(0x258),{'success':_0x1552b0[_0x2a9972(0x1a3)](_0x2a9972(0x21c)),'errors':_0x1552b0[_0x2a9972(0x1a3)](_0x2a9972(0x178)),'role':_0x5af499,'profile':_0x310ad9,'user':_0x7a293,'stock':_0x2d1ef2,'master_shop':_0x106e15,'unit':_0x4c96fc,'language':_0x582420,'warehouses':_0x5a1378,'rooms':_0x1ab79e,'warehouse_QA':_0x4fb7b7});}catch(_0x853b86){console['log'](_0x853b86),_0x31bbdb[_0x2a9972(0x246)](0xc8)[_0x2a9972(0x21e)]({'message':_0x853b86['message']});}}),router[a0_0xadf73f(0x242)]('/view/return_sales/:id',auth,async(_0x4a3050,_0x45d157)=>{var _0x2a8779=a0_0xadf73f;if(_0x4a3050[_0x2a8779(0x1ee)]['for_categorize']=='QA')try{const {invoice:_0x2ad124,date:_0x20b09a,warehouse_name:_0x3bd233,product_name:_0x569e3c,primary_code:_0x57cd50,secondary_code:_0x63146c,product_code:_0x363067,sales_quantity:_0x4ad34b,stocks:_0x4806d3,return_qty:_0x22fb4b,Room_name:_0x239f07,to_warehouse_name_QA:_0x4160c7,to_Room_name_QA:_0xe8f79d,note:_0x5ed0b4,for_categorize:_0x5e4836,product_name_QA1:_0x3a90b0}=_0x4a3050[_0x2a8779(0x1ee)];if(typeof _0x3a90b0==_0x2a8779(0x1fb))var _0x3f1286=[_0x4a3050['body'][_0x2a8779(0x1ba)]],_0x35a149=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x211)]],_0x24f1b2=[_0x4a3050[_0x2a8779(0x1ee)]['secondary_code_QA']],_0x462db0=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1d5)]],_0x2d6cc6=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x155)]],_0x5a455b=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x240)]],_0x226d8e=[_0x4a3050['body'][_0x2a8779(0x16f)]],_0x3e550d=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1b6)]],_0x1f555f=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1d7)]],_0x28f1a3=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x25a)]],_0x5b32d9=[_0x4a3050[_0x2a8779(0x1ee)]['secondary_unit_QA']],_0x3e4dbf=[_0x4a3050['body'][_0x2a8779(0x1c5)]],_0x10fd0b=[_0x4a3050['body'][_0x2a8779(0x23c)]],_0x6d8f88=[_0x4a3050['body']['expiry_date_QA']];else var _0x3f1286=[..._0x4a3050[_0x2a8779(0x1ee)]['product_name_QA1']],_0x35a149=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x211)]],_0x24f1b2=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x19e)]],_0x462db0=[..._0x4a3050['body']['product_code_QA']],_0x2d6cc6=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x155)]],_0x5a455b=[..._0x4a3050[_0x2a8779(0x1ee)]['stocks_QA']],_0x226d8e=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x16f)]],_0x3e550d=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1b6)]],_0x1f555f=[..._0x4a3050['body'][_0x2a8779(0x1d7)]],_0x28f1a3=[..._0x4a3050['body'][_0x2a8779(0x25a)]],_0x5b32d9=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1df)]],_0x3e4dbf=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1c5)]],_0x10fd0b=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x23c)]],_0x6d8f88=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x22e)]];const _0x482251=_0x3f1286[_0x2a8779(0x1b8)](_0x344aa5=>{return _0x344aa5={'product_name':_0x344aa5};});_0x35a149['forEach']((_0x12e36e,_0x3cc731)=>{var _0x8f9cdc=_0x2a8779;_0x482251[_0x3cc731][_0x8f9cdc(0x202)]=_0x12e36e;}),_0x24f1b2[_0x2a8779(0x1ed)]((_0x584509,_0x143934)=>{var _0x3ed925=_0x2a8779;_0x482251[_0x143934][_0x3ed925(0x247)]=_0x584509;}),_0x462db0['forEach']((_0x52bf62,_0x3b6cd6)=>{var _0x13bf8e=_0x2a8779;_0x482251[_0x3b6cd6][_0x13bf8e(0x15b)]=_0x52bf62;}),_0x2d6cc6[_0x2a8779(0x1ed)]((_0x2a2b06,_0x490654)=>{_0x482251[_0x490654]['sale_qty']=_0x2a2b06;}),_0x5a455b['forEach']((_0x2cf2dc,_0x1575df)=>{var _0x3dcb92=_0x2a8779;_0x482251[_0x1575df][_0x3dcb92(0x19f)]=_0x2cf2dc;}),_0x226d8e[_0x2a8779(0x1ed)]((_0x5ab356,_0x348487)=>{_0x482251[_0x348487]['return_qty']=_0x5ab356;}),_0x3e550d[_0x2a8779(0x1ed)]((_0x3a7443,_0x1580ac)=>{_0x482251[_0x1580ac]['maxPerUnit']=_0x3a7443;}),_0x1f555f[_0x2a8779(0x1ed)]((_0x48a34c,_0x22517d)=>{var _0x57d6fc=_0x2a8779;_0x482251[_0x22517d][_0x57d6fc(0x167)]=_0x48a34c;}),_0x28f1a3[_0x2a8779(0x1ed)]((_0x1a6c21,_0x2cef08)=>{var _0x1557ca=_0x2a8779;_0x482251[_0x2cef08][_0x1557ca(0x217)]=_0x1a6c21;}),_0x5b32d9['forEach']((_0x3bbd64,_0x580c85)=>{var _0x3c02fa=_0x2a8779;_0x482251[_0x580c85][_0x3c02fa(0x1b2)]=_0x3bbd64;}),_0x3e4dbf[_0x2a8779(0x1ed)]((_0x385827,_0x4d4061)=>{_0x482251[_0x4d4061]['unit']=_0x385827;}),_0x10fd0b[_0x2a8779(0x1ed)]((_0x569797,_0x43ccda)=>{var _0x1c9a78=_0x2a8779;_0x482251[_0x43ccda][_0x1c9a78(0x1b1)]=_0x569797;}),_0x6d8f88[_0x2a8779(0x1ed)]((_0x59da71,_0x1e1936)=>{var _0x2d3d8c=_0x2a8779;_0x482251[_0x1e1936][_0x2d3d8c(0x20f)]=_0x59da71;});const _0x2de148=await sales_finished[_0x2a8779(0x15e)]({'invoice':_0x2ad124});_0x2de148[_0x2a8779(0x16c)]=_0x2a8779(0x1b3);const _0x6311ef=await _0x2de148['save'](),_0x102db0=new sales_return_finished({'invoice':_0x2ad124,'customer':_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x24e)],'date':_0x20b09a,'warehouse_name':_0x3bd233,'room':_0x239f07,'ToWarehouse':_0x4160c7,'ToRoom':_0xe8f79d,'return_sale_QA':_0x482251,'note':_0x5ed0b4,'warehouse_cat':_0x5e4836}),_0x1d3d98=await _0x102db0[_0x2a8779(0x164)](),_0x686273=await sales_return_finished['findOne']({'invoice':_0x2ad124}),_0xdc0d33=await warehouse['findOne']({'name':_0x4160c7,'room':_0xe8f79d});_0x686273[_0x2a8779(0x1e7)][_0x2a8779(0x1ed)](_0x9ec218=>{var _0xa72f8f=_0x2a8779,_0x209550=0x0;const _0x2fabfe=_0xdc0d33[_0xa72f8f(0x25b)][_0xa72f8f(0x1b8)](_0x6175de=>{var _0x2415ff=_0xa72f8f;_0x6175de['product_name']==_0x9ec218[_0x2415ff(0x1dd)]&&_0x6175de[_0x2415ff(0x20f)]==_0x9ec218[_0x2415ff(0x20f)]&&_0x6175de[_0x2415ff(0x1b1)]==_0x9ec218[_0x2415ff(0x1b1)]&&_0x6175de[_0x2415ff(0x217)]==_0x9ec218['batch_code']&&(_0x6175de['product_stock']=parseInt(_0x6175de[_0x2415ff(0x209)])+parseInt(_0x9ec218[_0x2415ff(0x161)]),_0x209550++);});_0x209550=='0'&&(_0xdc0d33[_0xa72f8f(0x25b)]=_0xdc0d33['product_details'][_0xa72f8f(0x197)]({'product_name':_0x9ec218[_0xa72f8f(0x1dd)],'product_stock':_0x9ec218[_0xa72f8f(0x161)],'primary_code':_0x9ec218['primary_code'],'secondary_code':_0x9ec218[_0xa72f8f(0x247)],'product_code':_0x9ec218['product_code'],'batch_code':_0x9ec218[_0xa72f8f(0x217)],'maxPerUnit':_0x9ec218['maxPerUnit'],'production_date':_0x9ec218[_0xa72f8f(0x1b1)],'expiry_date':_0x9ec218['expiry_date'],'secondary_unit':_0x9ec218[_0xa72f8f(0x1b2)],'unit':_0x9ec218[_0xa72f8f(0x253)],'maxProducts':_0x9ec218[_0xa72f8f(0x167)],'bay':_0x9ec218['bay']}));}),await _0xdc0d33['save']();const _0x271c49=new c_payment_data({'invoice':_0x2ad124,'customer':_0x4a3050['body'][_0x2a8779(0x24e)],'reason':_0x2a8779(0x207)});await _0x271c49[_0x2a8779(0x164)]();const _0x1deea0=await master_shop[_0x2a8779(0x18d)](),_0x285afb=await email_settings[_0x2a8779(0x15e)](),_0x4d7d97=await customer[_0x2a8779(0x15e)]({'name':_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x24e)]});_0x1deea0[0x0][_0x2a8779(0x183)]==0x1?(right_currency=_0x1deea0[0x0][_0x2a8779(0x19b)],left_currency=''):(right_currency='',left_currency=_0x1deea0[0x0]['currency']);var _0x571727=_0x3f1286,_0x29960e=_0x226d8e,_0x2e0e08='',_0x1a9023;for(_0x1a9023 in _0x571727){_0x2e0e08+=_0x2a8779(0x24d)+_0x2a8779(0x22f)+_0x571727[_0x1a9023]+'</td>'+_0x2a8779(0x22f)+_0x29960e[_0x1a9023]+'</td>'+_0x2a8779(0x210);}console[_0x2a8779(0x1eb)](_0x2a8779(0x19a),_0x2e0e08);let _0x12b7f0=nodemailer[_0x2a8779(0x235)]({'service':_0x2a8779(0x20a),'auth':{'user':_0x285afb[_0x2a8779(0x1ca)],'pass':_0x285afb['password']}}),_0x286c58={'from':_0x285afb[_0x2a8779(0x1ca)],'to':_0x4d7d97[_0x2a8779(0x1ca)],'subject':_0x2a8779(0x24b),'attachments':[{'filename':_0x2a8779(0x194),'path':__dirname+_0x2a8779(0x1ec)+'/upload/'+_0x1deea0[0x0][_0x2a8779(0x154)],'cid':_0x2a8779(0x186)}],'html':_0x2a8779(0x1a7)+_0x2a8779(0x1a9)+_0x2a8779(0x1cc)+_0x2a8779(0x223)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x2a8779(0x1cb)+_0x2a8779(0x22d)+_0x2a8779(0x223)+'<h2>\x20'+_0x1deea0[0x0][_0x2a8779(0x248)]+_0x2a8779(0x20b)+'</div>'+'</div>'+_0x2a8779(0x227)+_0x2a8779(0x223)+_0x2a8779(0x256)+_0x2a8779(0x172)+_0x2ad124+'\x20'+_0x2a8779(0x237)+_0x2a8779(0x206)+_0x20b09a+'\x20'+_0x2a8779(0x1af)+_0x2a8779(0x213)+'</div>'+_0x2a8779(0x23f)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2a8779(0x24d)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2a8779(0x1e1)+_0x2a8779(0x174)+_0x2a8779(0x214)+_0x2a8779(0x210)+_0x2a8779(0x199)+_0x2a8779(0x232)+'\x20'+_0x2e0e08+'\x20'+_0x2a8779(0x151)+_0x2a8779(0x1ff)+_0x2a8779(0x223)+_0x2a8779(0x239)+_0x2a8779(0x168)+_0x1deea0[0x0]['site_title']+_0x2a8779(0x213)+_0x2a8779(0x22d)+'</div>'+'</body></html>'};_0x12b7f0[_0x2a8779(0x157)](_0x286c58,function(_0x15511f,_0x52b6bc){var _0x163d30=_0x2a8779;_0x15511f?(console['log'](_0x15511f),console[_0x163d30(0x1eb)](_0x163d30(0x17b))):console['log']('Email\x20sent\x20successfully');}),_0x4a3050['flash'](_0x2a8779(0x21c),'sales\x20item\x20return\x20successfull'),_0x45d157[_0x2a8779(0x1dc)](_0x2a8779(0x1e3));}catch(_0x33d56f){_0x45d157[_0x2a8779(0x246)](0xc8)[_0x2a8779(0x21e)]({'message1':_0x33d56f[_0x2a8779(0x187)]});}else{if(_0x4a3050['body']['for_categorize']=='GS')try{const {invoice:_0x34aa9d,date:_0x46c2a9,warehouse_name:_0x482bcc,product_name:_0x48cba9,primary_code:_0x3f48d7,secondary_code:_0x41bc43,product_code:_0x356b3d,sales_quantity:_0x29ae25,stocks:_0x2a2203,return_qty:_0x3d0adf,Room_name:_0x58ce97,to_warehouse_name:_0x228169,to_Room_name:_0x3d18b6,note:_0x6a042b,level:_0x38bc92,isle:_0x394d0f,pallet:_0x4b4fd8,for_categorize:_0x5e25e4}=_0x4a3050[_0x2a8779(0x1ee)];if(typeof _0x48cba9=='string')var _0x3f1286=[_0x4a3050['body'][_0x2a8779(0x1dd)]],_0x35a149=[_0x4a3050[_0x2a8779(0x1ee)]['primary_code']],_0x24f1b2=[_0x4a3050['body']['secondary_code']],_0x462db0=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x15b)]],_0x2d6cc6=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x219)]],_0x226d8e=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x161)]],_0x3bdd5d=[_0x4a3050['body'][_0x2a8779(0x15d)]],_0x3e550d=[_0x4a3050['body']['maxPerUnit']],_0x1f555f=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x167)]],_0x28f1a3=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x217)]],_0x5b32d9=[_0x4a3050['body'][_0x2a8779(0x1b2)]],_0x3e4dbf=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x253)]],_0x10fd0b=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1b1)]],_0x6d8f88=[_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x20f)]];else var _0x3f1286=[..._0x4a3050[_0x2a8779(0x1ee)]['product_name']],_0x35a149=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x202)]],_0x24f1b2=[..._0x4a3050['body'][_0x2a8779(0x247)]],_0x462db0=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x15b)]],_0x2d6cc6=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x219)]],_0x226d8e=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x161)]],_0x3bdd5d=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x15d)]],_0x3e550d=[..._0x4a3050[_0x2a8779(0x1ee)]['maxPerUnit']],_0x1f555f=[..._0x4a3050['body'][_0x2a8779(0x167)]],_0x28f1a3=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x217)]],_0x5b32d9=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1b2)]],_0x3e4dbf=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x253)]],_0x10fd0b=[..._0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x1b1)]],_0x6d8f88=[..._0x4a3050['body'][_0x2a8779(0x20f)]];const _0x50a743=_0x3f1286[_0x2a8779(0x1b8)](_0x2aa58d=>{return _0x2aa58d={'product_name':_0x2aa58d};});_0x35a149['forEach']((_0x1e61b7,_0x5bd894)=>{var _0x349d2c=_0x2a8779;_0x50a743[_0x5bd894][_0x349d2c(0x202)]=_0x1e61b7;}),_0x24f1b2[_0x2a8779(0x1ed)]((_0x5dfe59,_0x3dccad)=>{var _0x39e89b=_0x2a8779;_0x50a743[_0x3dccad][_0x39e89b(0x247)]=_0x5dfe59;}),_0x462db0['forEach']((_0x49e50b,_0x41e42d)=>{var _0x32f24f=_0x2a8779;_0x50a743[_0x41e42d][_0x32f24f(0x15b)]=_0x49e50b;}),_0x2d6cc6[_0x2a8779(0x1ed)]((_0x6c7a27,_0x54b5b8)=>{var _0x27b5d4=_0x2a8779;_0x50a743[_0x54b5b8][_0x27b5d4(0x229)]=_0x6c7a27;}),_0x226d8e[_0x2a8779(0x1ed)]((_0x5b4f64,_0x2bf025)=>{var _0x2ebb82=_0x2a8779;_0x50a743[_0x2bf025][_0x2ebb82(0x161)]=_0x5b4f64;}),_0x3bdd5d[_0x2a8779(0x1ed)]((_0x14fbfb,_0x57ba3f)=>{_0x50a743[_0x57ba3f]['bay']=_0x14fbfb;}),_0x3e550d[_0x2a8779(0x1ed)]((_0x542730,_0x15b57d)=>{var _0x3321b5=_0x2a8779;_0x50a743[_0x15b57d][_0x3321b5(0x249)]=_0x542730;}),_0x1f555f[_0x2a8779(0x1ed)]((_0x38fe42,_0x207403)=>{var _0x4f9c2d=_0x2a8779;_0x50a743[_0x207403][_0x4f9c2d(0x167)]=_0x38fe42;}),_0x28f1a3[_0x2a8779(0x1ed)]((_0x2ce753,_0x50a9db)=>{var _0xee0296=_0x2a8779;_0x50a743[_0x50a9db][_0xee0296(0x217)]=_0x2ce753;}),_0x5b32d9[_0x2a8779(0x1ed)]((_0x48474d,_0x1852b9)=>{var _0x53be92=_0x2a8779;_0x50a743[_0x1852b9][_0x53be92(0x1b2)]=_0x48474d;}),_0x3e4dbf['forEach']((_0x3e4aa6,_0x228bb0)=>{_0x50a743[_0x228bb0]['unit']=_0x3e4aa6;}),_0x10fd0b[_0x2a8779(0x1ed)]((_0x204799,_0x1662cc)=>{_0x50a743[_0x1662cc]['production_date']=_0x204799;}),_0x6d8f88[_0x2a8779(0x1ed)]((_0x571612,_0x494b21)=>{var _0x2252ca=_0x2a8779;_0x50a743[_0x494b21][_0x2252ca(0x20f)]=_0x571612;});var _0x394c2f=0x0;_0x50a743[_0x2a8779(0x1ed)](_0xd90575=>{var _0x3f5020=_0x2a8779;(parseInt(_0xd90575[_0x3f5020(0x229)])<parseInt(_0xd90575[_0x3f5020(0x161)])||parseInt(_0xd90575[_0x3f5020(0x19f)])<parseInt(_0xd90575[_0x3f5020(0x161)])&&parseInt(_0xd90575[_0x3f5020(0x229)])>parseInt(_0xd90575[_0x3f5020(0x161)])||parseInt(_0xd90575[_0x3f5020(0x161)])==0x0)&&_0x394c2f++;});if(_0x394c2f!=0x0)return _0x4a3050[_0x2a8779(0x1a3)](_0x2a8779(0x178),_0x2a8779(0x15c)),_0x45d157[_0x2a8779(0x1dc)]('back');const _0x11171e=await sales_finished[_0x2a8779(0x15e)]({'invoice':_0x34aa9d});_0x11171e[_0x2a8779(0x16c)]=_0x2a8779(0x1b3);const _0x3c4b82=await _0x11171e[_0x2a8779(0x164)](),_0xe6d00d=new sales_return_finished({'invoice':_0x34aa9d,'customer':_0x4a3050[_0x2a8779(0x1ee)]['customer'],'date':_0x46c2a9,'warehouse_name':_0x482bcc,'room':_0x58ce97,'ToWarehouse':_0x228169,'ToRoom':_0x3d18b6,'return_sale':_0x50a743,'note':_0x6a042b,'warehouse_cat':_0x5e25e4}),_0x20fe97=await _0xe6d00d['save'](),_0x348cae=await sales_return_finished[_0x2a8779(0x15e)]({'invoice':_0x34aa9d}),_0x5ce4ae=await warehouse[_0x2a8779(0x15e)]({'name':_0x228169,'room':_0x3d18b6,'warehouse_category':'Finished\x20Goods'});_0x348cae[_0x2a8779(0x180)][_0x2a8779(0x1ed)](_0x13da35=>{var _0x5c1606=_0x2a8779,_0x254a6f=0x0;const _0x3f7e42=_0x5ce4ae[_0x5c1606(0x25b)]['map'](_0x38fa31=>{var _0x13909d=_0x5c1606;_0x38fa31['product_name']==_0x13da35['product_name']&&_0x38fa31[_0x13909d(0x15d)]==_0x13da35[_0x13909d(0x15d)]&&_0x38fa31[_0x13909d(0x20f)]==_0x13da35[_0x13909d(0x20f)]&&_0x38fa31['production_date']==_0x13da35[_0x13909d(0x1b1)]&&_0x38fa31['batch_code']==_0x13da35[_0x13909d(0x217)]&&(_0x38fa31[_0x13909d(0x209)]=parseInt(_0x38fa31['product_stock'])+parseInt(_0x13da35['return_qty']),_0x254a6f++);});_0x254a6f=='0'&&(_0x5ce4ae[_0x5c1606(0x25b)]=_0x5ce4ae[_0x5c1606(0x25b)][_0x5c1606(0x197)]({'product_name':_0x13da35[_0x5c1606(0x1dd)],'product_stock':_0x13da35[_0x5c1606(0x161)],'primary_code':_0x13da35['primary_code'],'secondary_code':_0x13da35[_0x5c1606(0x247)],'product_code':_0x13da35['product_code'],'bay':_0x13da35[_0x5c1606(0x15d)],'batch_code':_0x13da35['batch_code'],'maxPerUnit':_0x13da35[_0x5c1606(0x249)],'production_date':_0x13da35[_0x5c1606(0x1b1)],'expiry_date':_0x13da35[_0x5c1606(0x20f)],'secondary_unit':_0x13da35['secondary_unit'],'unit':_0x13da35['unit'],'maxProducts':_0x13da35[_0x5c1606(0x167)]}));}),await _0x5ce4ae['save'](),console[_0x2a8779(0x1eb)](_0x4a3050[_0x2a8779(0x1ee)]);const _0x41d38f=new c_payment_data({'invoice':_0x34aa9d,'customer':_0x4a3050[_0x2a8779(0x1ee)][_0x2a8779(0x24e)],'reason':'Sale\x20Return'});await _0x41d38f[_0x2a8779(0x164)]();const _0x5343ec=await master_shop[_0x2a8779(0x18d)]();console[_0x2a8779(0x1eb)](_0x2a8779(0x212),_0x5343ec[0x0][_0x2a8779(0x154)]);const _0x3f11ec=await email_settings['findOne'](),_0x14bcdf=await customer['findOne']({'name':_0x4a3050['body'][_0x2a8779(0x24e)]});console[_0x2a8779(0x1eb)](_0x2a8779(0x24a),_0x14bcdf);_0x5343ec[0x0][_0x2a8779(0x183)]==0x1?(right_currency=_0x5343ec[0x0][_0x2a8779(0x19b)],left_currency=''):(right_currency='',left_currency=_0x5343ec[0x0][_0x2a8779(0x19b)]);var _0x571727=_0x3f1286,_0x29960e=_0x226d8e,_0x2e0e08='',_0x1a9023;for(_0x1a9023 in _0x571727){_0x2e0e08+=_0x2a8779(0x24d)+_0x2a8779(0x22f)+_0x571727[_0x1a9023]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x29960e[_0x1a9023]+_0x2a8779(0x1da)+_0x2a8779(0x210);}console['log'](_0x2a8779(0x19a),_0x2e0e08);let _0x89beea=nodemailer['createTransport']({'service':'gmail','auth':{'user':_0x3f11ec[_0x2a8779(0x1ca)],'pass':_0x3f11ec['password']}}),_0x1371d5={'from':_0x3f11ec['email'],'to':_0x14bcdf[_0x2a8779(0x1ca)],'subject':_0x2a8779(0x24b),'attachments':[{'filename':_0x2a8779(0x194),'path':__dirname+'/../public'+_0x2a8779(0x189)+_0x5343ec[0x0][_0x2a8779(0x154)],'cid':'logo'}],'html':_0x2a8779(0x1a7)+_0x2a8779(0x1a9)+_0x2a8779(0x1cc)+_0x2a8779(0x223)+_0x2a8779(0x1c1)+_0x2a8779(0x223)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2a8779(0x22d)+_0x2a8779(0x223)+_0x2a8779(0x1c3)+_0x5343ec[0x0]['site_title']+_0x2a8779(0x20b)+_0x2a8779(0x22d)+_0x2a8779(0x22d)+_0x2a8779(0x227)+_0x2a8779(0x223)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x2a8779(0x172)+_0x34aa9d+'\x20'+_0x2a8779(0x237)+_0x2a8779(0x206)+_0x46c2a9+'\x20'+'</span>'+_0x2a8779(0x213)+_0x2a8779(0x22d)+_0x2a8779(0x23f)+_0x2a8779(0x16a)+_0x2a8779(0x24d)+_0x2a8779(0x241)+_0x2a8779(0x1e1)+_0x2a8779(0x174)+_0x2a8779(0x214)+_0x2a8779(0x210)+_0x2a8779(0x199)+_0x2a8779(0x232)+'\x20'+_0x2e0e08+'\x20'+_0x2a8779(0x151)+'</table>'+_0x2a8779(0x223)+_0x2a8779(0x239)+_0x2a8779(0x168)+_0x5343ec[0x0][_0x2a8779(0x248)]+_0x2a8779(0x213)+_0x2a8779(0x22d)+_0x2a8779(0x22d)+_0x2a8779(0x25e)};_0x89beea['sendMail'](_0x1371d5,function(_0x3d11e2,_0x540536){var _0x3bb729=_0x2a8779;_0x3d11e2?(console['log'](_0x3d11e2),console[_0x3bb729(0x1eb)](_0x3bb729(0x17b))):console[_0x3bb729(0x1eb)]('Email\x20sent\x20successfully');}),_0x4a3050[_0x2a8779(0x1a3)](_0x2a8779(0x21c),_0x2a8779(0x23b)),_0x45d157[_0x2a8779(0x1dc)]('/all_sales_finished/view');}catch(_0x3f1e75){console['log'](_0x3f1e75),_0x45d157[_0x2a8779(0x246)](0xc8)[_0x2a8779(0x21e)]({'message1':_0x3f1e75[_0x2a8779(0x187)]});}}}),router[a0_0xadf73f(0x18e)]('/barcode/:id',auth,async(_0x40eccf,_0x5cb02f)=>{var _0x29fcd7=a0_0xadf73f;try{const {username:_0x2c3cf9,email:_0x4b9adb,role:_0x56cd04}=_0x40eccf[_0x29fcd7(0x1a2)],_0x140eea=_0x40eccf[_0x29fcd7(0x1a2)],_0x539b87=await profile[_0x29fcd7(0x15e)]({'email':_0x140eea[_0x29fcd7(0x1ca)]}),_0x58ff28=await master_shop[_0x29fcd7(0x18d)]();console[_0x29fcd7(0x1eb)](_0x29fcd7(0x24c),_0x58ff28);const _0x17db02=_0x40eccf[_0x29fcd7(0x230)]['id'],_0x16eec4=await sales[_0x29fcd7(0x20d)](_0x17db02);console[_0x29fcd7(0x1eb)](_0x29fcd7(0x1f8),_0x16eec4);if(_0x58ff28[0x0]['language']==_0x29fcd7(0x1f7))var _0x5d6b29=users['English'];else{if(_0x58ff28[0x0][_0x29fcd7(0x1f5)]==_0x29fcd7(0x226))var _0x5d6b29=users[_0x29fcd7(0x226)];else{if(_0x58ff28[0x0][_0x29fcd7(0x1f5)]==_0x29fcd7(0x1ac))var _0x5d6b29=users[_0x29fcd7(0x1ac)];else{if(_0x58ff28[0x0][_0x29fcd7(0x1f5)]==_0x29fcd7(0x252))var _0x5d6b29=users['Spanish'];else{if(_0x58ff28[0x0][_0x29fcd7(0x1f5)]==_0x29fcd7(0x195))var _0x5d6b29=users[_0x29fcd7(0x195)];else{if(_0x58ff28[0x0]['language']==_0x29fcd7(0x184))var _0x5d6b29=users['Portuguese'];else{if(_0x58ff28[0x0][_0x29fcd7(0x1f5)]=='Chinese')var _0x5d6b29=users[_0x29fcd7(0x1aa)];else{if(_0x58ff28[0x0][_0x29fcd7(0x1f5)]==_0x29fcd7(0x1fc))var _0x5d6b29=users[_0x29fcd7(0x177)];}}}}}}}_0x5cb02f[_0x29fcd7(0x1a6)](_0x29fcd7(0x1a1),{'success':_0x40eccf[_0x29fcd7(0x1a3)](_0x29fcd7(0x21c)),'errors':_0x40eccf['flash'](_0x29fcd7(0x178)),'role':_0x140eea,'profile':_0x539b87,'alldata':_0x16eec4,'master_shop':_0x58ff28,'language':_0x5d6b29});}catch(_0x4c2d39){console[_0x29fcd7(0x1eb)](_0x4c2d39);}}),router[a0_0xadf73f(0x242)](a0_0xadf73f(0x20e),async(_0x440f54,_0x48c075)=>{var _0x1ef2f5=a0_0xadf73f;const {product_code:_0x49fb92,warehouse_name:_0xbdd49b,rooms_data:_0xc216b9,Roomslist:_0x2301f7}=_0x440f54['body'],_0x49bcbc=_0x2301f7[_0x1ef2f5(0x153)](','),_0x450bbc=[];async function _0x13e0ff(_0x2ae02a){var _0x164a0d=_0x1ef2f5;const _0x17d792=await warehouse[_0x164a0d(0x200)]([{'$match':{'name':_0xbdd49b,'room':_0x2ae02a}},{'$unwind':_0x164a0d(0x204)},{'$match':{'product_details.primary_code':_0x49fb92}},{'$group':{'_id':_0x164a0d(0x233),'name':{'$first':_0x164a0d(0x23e)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x164a0d(0x196)},'secondary_code':{'$first':_0x164a0d(0x1cf)},'product_code':{'$first':_0x164a0d(0x218)},'level':{'$first':_0x164a0d(0x21b)},'isle':{'$first':_0x164a0d(0x1ad)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x164a0d(0x15a)},'rack':{'$first':_0x164a0d(0x243)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x164a0d(0x1a5)},'maxPerUnit':{'$first':_0x164a0d(0x236)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x164a0d(0x1e6)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x164a0d(0x1ef)},'invoice':{'$first':_0x164a0d(0x1b0)}}}]),_0x20b5c5=await warehouse[_0x164a0d(0x200)]([{'$match':{'name':_0xbdd49b,'room':_0x2ae02a}},{'$unwind':_0x164a0d(0x204)},{'$match':{'product_details.secondary_code':_0x49fb92}},{'$group':{'_id':_0x164a0d(0x233),'name':{'$first':_0x164a0d(0x23e)},'product_stock':{'$first':_0x164a0d(0x1d2)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x164a0d(0x1cf)},'product_code':{'$first':_0x164a0d(0x218)},'level':{'$first':_0x164a0d(0x21b)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x164a0d(0x156)},'pallet':{'$first':_0x164a0d(0x1c7)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x164a0d(0x15a)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x164a0d(0x1d4)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x164a0d(0x236)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x164a0d(0x1e6)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x164a0d(0x1ef)},'invoice':{'$first':_0x164a0d(0x1b0)}}}]);if(_0x17d792['length']>0x0)_0x450bbc[_0x164a0d(0x251)](_0x17d792);else _0x20b5c5[_0x164a0d(0x1e5)]>0x0&&_0x450bbc[_0x164a0d(0x251)](_0x20b5c5);}const _0x1ea604=_0x49bcbc[_0x1ef2f5(0x1b8)](_0x3151b6=>_0x13e0ff(_0x3151b6));await Promise[_0x1ef2f5(0x245)](_0x1ea604),_0x48c075[_0x1ef2f5(0x21e)](_0x450bbc);}),module['exports']=router;function a0_0x7d03(){var _0x427b16=['product_code_QA','Sales\x20Update\x20successfully','maxProducts_QA','prod_invoice','final','</td>','$customers_docs','redirect','product_name','Finished\x20Goods','secondary_unit_QA','/all_sales_finished/preview/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','/view','/all_sales_finished/view','name','length','$product_details.product_cat','return_sale_QA','staff','$name','filter','log','/../public','forEach','body','$room','Return\x20Goods','/preview/:id','Sales\x20Mail','prod_code','received_amount','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','English\x20(US)','barcode\x20user_id','getMonth','$product_details.maxProducts','string','Arabic\x20(ae)','320DsdBbd','back','</table>','aggregate','../public/language/languages.json','primary_code','room','$product_details','floor','\x20Order\x20Date\x20:\x20','Sale\x20Return','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_stock','gmail','\x20</h2>','suppliers','findById','/barcode_scanner','expiry_date','</tr>','primary_code_QA','add\x20post','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$sale_product.bin','OUTF-','batch_code','$product_details.product_code','sales_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.bay','success','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','json','Sale','$finalize','$return_data','product_date','<div>','stock_data','$product_details.batch_code','Hindi','<hr\x20class=\x22my-3\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','sale_qty','$sale_product.quantity','/all_sales/view','Quality\x20Inspection','</div>','expiry_date_QA','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','params','$product.product_name','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details._id','sales_invoice','createTransport','$product_details.maxPerUnit','<span\x20style=\x22float:\x20right;\x22>','\x20==\x20','<strong>\x20Regards\x20</strong>','id_transaction_from','sales\x20item\x20return\x20successfull','production_date_QA','/view/return_sales/:id','$product_details.product_name','<table\x20style=\x22width:\x20100%\x20!important;\x22>','stocks_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','post','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','all','status','secondary_code','site_title','maxPerUnit','customer_data','Sale\x20Return\x20Mail','barcode\x20Product\x20master','<tr>','customer','$sale_product.floorlevel','/invoice/:id','push','Spanish','unit','Enabled','carton','<h5\x20style=\x22text-align:\x20left;\x22>','Ambient','return_sale_finished','amount','batch_code_QA','product_details','prod_cat','\x20>>>\x20','</body></html>','password','abs','$sale_product.type','master','</tbody>','quantity','split','image','sales_quantity_QA','$product_details.type','sendMail','\x20<<<==>>>\x20','\x20&&\x20','$product_details.storage','product_code','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','bay','findOne','1238432bnRpaZ','toString','return_qty','Sales\x20Add\x20successfully','warehouse_name','save','English','getDate','maxProducts','<h5>','role','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','179546seyTHG','return_data','$warehouse_name','Router','return_qty_QA','add_sales_finished','primary_unit','\x20Order\x20Number\x20:\x20','$_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','sale_product','773040ONxhwD','Arabic','errors','catch','/view/:id','Error\x20Occurs','edit_sales_finished','6769656BbXMvb','$customer','getFullYear','return_sale','nodemailer','$note','currency_placement','Portuguese\x20(BR)','21168bupeht','logo','message','Enclosed','/upload/','/give_payment/:id','invoice','44492BVoSjd','find','get','$sale_product.bay','then','finalize','foreach\x20newproduct','479076VnMEbk','Logo.png','French','$product_details.primary_code','concat','room_name','</thead>','product_list','currency','/view/add_sales','RoomAssigned','secondary_code_QA','stock','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','all_sales_barcode','user','flash','customers','$product_details.production_date','render','<!DOCTYPE\x20html>','Return\x20Rooms','<html><head><title></title>','Chinese','/picking_list/pdf/','German','$product_details.bin','../middleware/auth','</span>','$product_details.invoice','production_date','secondary_unit','True','maxperunit','Portuguese','maxPerUnit_QA','$date','map','An\x20error\x20occurred\x20while\x20saving\x20data.','product_name_QA1','adjust_qty','customers_docs','warehouse','$product_details.unit','host','Email\x20sent\x20successfully','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','max_per_unit','<h2>\x20','error','unit_QA','$invoice','$product_details.floorlevel','date','express','email','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</head><body>','$product_details.room_name','level','$product_details.secondary_code','edit_sales_finished_view','$sale_product','$product_details.product_stock','slice','$product_details.expiry_date'];a0_0x7d03=function(){return _0x427b16;};return a0_0x7d03();}