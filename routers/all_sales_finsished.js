function a0_0x3111(){var _0xcd70a6=['find','Sale\x20Return','level','Logo.png','secondary_unit_QA','carton','expiry_date','user','primary_code_QA','prod_code','\x20<>\x20','$product_details.maxPerUnit','date','split','Portuguese','back','params','message','/all_sales_finished/preview/','all_sales_barcode','add_sales_finished','catch','product_data','$product_details.rack','abs','random','post','primary_unit','received_amount','</div>','Return\x20Goods','/invoice/:id','maxperunit','stock','French','product','5734880DYRpcB','/view/:id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','body','Return\x20Rooms','customer','exports','$product_details.unit','max_per_unit','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','/view/add_sales','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/upload/','adjust_qty','foreach\x20newproduct','slice','DRY\x20GOODS','$product_details','site_title','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','Ambient','186srAYjh','product_stock','Arabic\x20(ae)','Finished\x20Goods','$product_details.batch_code','host','Sale','string','then','$product.product_name','add\x20post','$sale_product','\x20</h2>','prod_invoice','/all_sales/view','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','sales\x20item\x20return\x20successfull','findById','quantity','return_sale','_id','<h2>\x20','Email\x20sent\x20successfully','Error\x20Occurs','sendMail','$sale_product.bay','$product_details.secondary_code','Spanish','map','OUTF-','return_data','sale_product','703248uYFecs','An\x20error\x20occurred\x20while\x20saving\x20data.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$finalize','Sale\x20Return\x20Mail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','$sale_product.type','barcode\x20Product\x20master','product_name','$customer','aggregate','sales_invoice','$product_details.floorlevel','sales_quantity','errors','<span\x20style=\x22float:\x20right;\x22>','$customers_docs','<h5\x20style=\x22text-align:\x20left;\x22>','<html><head><title></title>','findOne','<table\x20style=\x22width:\x20100%\x20!important;\x22>','</table>','280WvIsMq','customer_data','<hr\x20class=\x22my-3\x22>','</span>','return_qty_QA','Received\x20Payment\x20For\x20Sale','Quality\x20Inspection','sale_qty','$product_details.product_stock','Enabled','final','batch_code_QA','product_date','</body></html>','Chinese','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','purchases_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.product_cat','Portuguese\x20(BR)','$_id','email','43685JKOndB','unit','currency_placement','/view/add_sales/:id','Sale\x20Product\x20Mail','</td>','$room','master','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.product_name','/view/add_sale/product','json','maxProducts_QA','<h5>','return_qty','getDate','due_amount','language','warehouse_name','filter','all','$product_details.maxProducts','suppliers','secondary_unit','customers','/view','$name','concat','English','$return_data','$product_details.bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','password','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$date','63721qRKEop','success','../public/language/languages.json','480816oIsqek','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','</head><body>','</tbody>','<tr>','redirect','status','maxProducts','finalize','$product_details._id','render','gmail','unit_QA','role','\x20Order\x20Number\x20:\x20','production_date_QA','$product_details.storage','True','</thead>','../middleware/auth','product_code','$product_details.expiry_date','Sales\x20Add\x20successfully','\x20&&\x20','image','logo','/../public','571632OIMRtc','bay','edit_sales_finished_view','$sale_product.quantity','amount','$product_details.secondary_unit','get','warehouse','<!DOCTYPE\x20html>','length','sales_quantity_QA','Arabic','all_sales_finished','staff','room','/preview/:id','/barcode/:id','maxPerUnit','edit_sales_finished','QA\x20Warehouse','$sale_product.bin','$product_details.product_code','expiry_date_QA','padStart','push','createTransport','product_code_QA','name','primary_code','prod_cat','save','log','<strong>\x20Regards\x20</strong>','\x20Order\x20Date\x20:\x20','There\x27s\x20a\x20error\x20in\x20this\x20transaction','for_categorize','English\x20(US)','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$note','$product','nodemailer','/all_sales_finished/view','Router','9vbITUq','</h5>','batch_code','$product_details.bin','$product_details.primary_code','production_date','currency','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/view/return_sales/:id','An\x20error\x20occurred.','stock_data','$product_details.production_date','$product_details.type','$warehouse_name','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','maxPerUnit_QA','Hindi','secondary_code','89395RbZhnA','<tbody\x20style=\x22text-align:\x20center;\x22>','customers_docs','German','stocks_QA','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','flash','$invoice','getFullYear','product_list','<div>','product_details','RoomAssigned','Sales\x20Update\x20successfully','port','room_name','toString','getMonth','invoice','forEach','\x20==\x20'];a0_0x3111=function(){return _0xcd70a6;};return a0_0x3111();}function a0_0x1ae7(_0x22e33f,_0x5d3757){var _0x311195=a0_0x3111();return a0_0x1ae7=function(_0x1ae792,_0x284027){_0x1ae792=_0x1ae792-0x186;var _0x392b7f=_0x311195[_0x1ae792];return _0x392b7f;},a0_0x1ae7(_0x22e33f,_0x5d3757);}var a0_0x16193f=a0_0x1ae7;(function(_0x4bcca5,_0x4fa23a){var _0x2dce35=a0_0x1ae7,_0xe366f7=_0x4bcca5();while(!![]){try{var _0x5f3023=parseInt(_0x2dce35(0x233))/0x1+parseInt(_0x2dce35(0x1f5))/0x2+parseInt(_0x2dce35(0x188))/0x3+parseInt(_0x2dce35(0x1da))/0x4+-parseInt(_0x2dce35(0x1b4))/0x5*(parseInt(_0x2dce35(0x282))/0x6)+parseInt(_0x2dce35(0x1d7))/0x7*(parseInt(_0x2dce35(0x19e))/0x8)+-parseInt(_0x2dce35(0x221))/0x9*(parseInt(_0x2dce35(0x26c))/0xa);if(_0x5f3023===_0x4fa23a)break;else _0xe366f7['push'](_0xe366f7['shift']());}catch(_0x3c8a6d){_0xe366f7['push'](_0xe366f7['shift']());}}}(a0_0x3111,0x31d45));const express=require('express'),app=express(),router=express[a0_0x16193f(0x220)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x16193f(0x1ed)),nodemailer=require(a0_0x16193f(0x21e)),users=require(a0_0x16193f(0x1d9));router['get'](a0_0x16193f(0x1cd),auth,async(_0xa82eb3,_0x54bdfe)=>{var _0x25855b=a0_0x16193f;try{const {username:_0x21ed97,email:_0x112bfa,role:_0xf9bc91}=_0xa82eb3[_0x25855b(0x24f)],_0x17054a=_0xa82eb3[_0x25855b(0x24f)],_0x3c2c1a=await profile[_0x25855b(0x19b)]({'email':_0x17054a[_0x25855b(0x1b3)]}),_0x246409=await master_shop[_0x25855b(0x248)]();let _0xaf1ac9;if(_0x17054a[_0x25855b(0x1e7)]==_0x25855b(0x202)){const _0x118506=await staff[_0x25855b(0x19b)]({'email':_0x17054a['email']});_0xaf1ac9=await sales_finished[_0x25855b(0x192)]([{'$lookup':{'from':_0x25855b(0x1cc),'localField':_0x25855b(0x271),'foreignField':_0x25855b(0x210),'as':'customers_docs'}},{'$unwind':_0x25855b(0x198)},{'$unwind':_0x25855b(0x28d)},{'$group':{'_id':'$_id','invoice':{'$first':_0x25855b(0x23a)},'customers':{'$first':_0x25855b(0x191)},'date':{'$first':_0x25855b(0x1d6)},'warehouse_name':{'$first':_0x25855b(0x22e)},'sale_product':{'$push':_0x25855b(0x28d)},'note':{'$first':'$note'},'return_data':{'$first':_0x25855b(0x1d1)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x25855b(0x1f8)},'level':{'$addToSet':_0x25855b(0x29c)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x25855b(0x18e)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x25855b(0x18b)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0xaf1ac9=await sales_finished[_0x25855b(0x192)]([{'$lookup':{'from':_0x25855b(0x1cc),'localField':_0x25855b(0x271),'foreignField':_0x25855b(0x210),'as':_0x25855b(0x235)}},{'$unwind':_0x25855b(0x198)},{'$unwind':_0x25855b(0x28d)},{'$group':{'_id':_0x25855b(0x1b2),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x25855b(0x1d6)},'warehouse_name':{'$first':_0x25855b(0x22e)},'sale_product':{'$push':_0x25855b(0x28d)},'note':{'$first':_0x25855b(0x21c)},'return_data':{'$first':_0x25855b(0x1d1)},'customers_docs':{'$first':_0x25855b(0x198)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x25855b(0x29c)},'isle':{'$addToSet':_0x25855b(0x209)},'type':{'$addToSet':_0x25855b(0x18e)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x25855b(0x18b)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x246409[0x0][_0x25855b(0x1c5)]==_0x25855b(0x219)){var _0x11c806=users[_0x25855b(0x1d0)];console[_0x25855b(0x214)](_0x11c806);}else{if(_0x246409[0x0]['language']==_0x25855b(0x231))var _0x11c806=users['Hindi'];else{if(_0x246409[0x0][_0x25855b(0x1c5)]==_0x25855b(0x236))var _0x11c806=users[_0x25855b(0x236)];else{if(_0x246409[0x0][_0x25855b(0x1c5)]=='Spanish')var _0x11c806=users['Spanish'];else{if(_0x246409[0x0][_0x25855b(0x1c5)]==_0x25855b(0x26a))var _0x11c806=users[_0x25855b(0x26a)];else{if(_0x246409[0x0][_0x25855b(0x1c5)]==_0x25855b(0x1b1))var _0x11c806=users['Portuguese'];else{if(_0x246409[0x0]['language']=='Chinese')var _0x11c806=users[_0x25855b(0x1ac)];else{if(_0x246409[0x0][_0x25855b(0x1c5)]==_0x25855b(0x284))var _0x11c806=users['Arabic'];}}}}}}}_0x54bdfe[_0x25855b(0x1e4)](_0x25855b(0x201),{'success':_0xa82eb3['flash'](_0x25855b(0x1d8)),'errors':_0xa82eb3[_0x25855b(0x239)](_0x25855b(0x196)),'sales':_0xaf1ac9,'profile':_0x3c2c1a,'role':_0x17054a,'master_shop':_0x246409,'language':_0x11c806});}catch(_0x178a4f){console[_0x25855b(0x214)](_0x178a4f);}});async function getRandom8DigitNumber(){var _0x15125d=a0_0x16193f;const _0x1f160f=0x989680,_0x213c33=0x5f5e0ff,_0x1e2836=Math['floor'](Math[_0x15125d(0x261)]()*(_0x213c33-_0x1f160f+0x1))+_0x1f160f;var _0x2afb48;const _0x237f0c=await sales_finished[_0x15125d(0x19b)]({'invoice':_0x15125d(0x2a0)+_0x1e2836});return _0x237f0c&&_0x237f0c[_0x15125d(0x1fe)]>0x0?_0x2afb48=_0x15125d(0x2a0)+_0x1e2836:_0x2afb48=_0x15125d(0x2a0)+_0x1e2836,_0x2afb48;}router[a0_0x16193f(0x1fb)]('/view/add_sales',auth,async(_0x329e25,_0x281b49)=>{var _0x5b697f=a0_0x16193f;try{const {username:_0xf6b49,email:_0x577f28,role:_0x17a405}=_0x329e25['user'],_0x57ed97=_0x329e25[_0x5b697f(0x24f)],_0x5e911b=await profile[_0x5b697f(0x19b)]({'email':_0x57ed97[_0x5b697f(0x1b3)]}),_0x331e71=await master_shop['find'](),_0x4ce704=await customer[_0x5b697f(0x248)]({});let _0x17ff65;if(_0x57ed97[_0x5b697f(0x1e7)]=='staff'){const _0x1d505c=await staff[_0x5b697f(0x19b)]({'email':_0x57ed97['email']});_0x17ff65=await warehouse[_0x5b697f(0x192)]([{'$match':{'status':_0x5b697f(0x1a7),'name':_0x1d505c[_0x5b697f(0x1fc)],'warehouse_category':_0x5b697f(0x285),'name':{'$ne':_0x5b697f(0x208)}}},{'$group':{'_id':_0x5b697f(0x1ce),'name':{'$first':_0x5b697f(0x1ce)}}},{'$sort':{'name':0x1}}]);}else _0x17ff65=await warehouse[_0x5b697f(0x192)]([{'$match':{'status':'Enabled','warehouse_category':_0x5b697f(0x285),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x5b697f(0x1ce)}}},{'$sort':{'name':0x1}}]);const _0x2d9867=await product[_0x5b697f(0x248)]({});var _0x467512=[_0x5b697f(0x281),'Enclosed'];const _0x2d5f0b=await sales_finished[_0x5b697f(0x248)]({}),_0x222e41=_0x2d5f0b[_0x5b697f(0x1fe)]+0x1,_0x1e3cb0='OUTF-'+_0x222e41[_0x5b697f(0x243)]()[_0x5b697f(0x20c)](0x5,'0');if(_0x331e71[0x0][_0x5b697f(0x1c5)]==_0x5b697f(0x219)){var _0x3f6e4d=users[_0x5b697f(0x1d0)];console[_0x5b697f(0x214)](_0x3f6e4d);}else{if(_0x331e71[0x0][_0x5b697f(0x1c5)]==_0x5b697f(0x231))var _0x3f6e4d=users[_0x5b697f(0x231)];else{if(_0x331e71[0x0][_0x5b697f(0x1c5)]==_0x5b697f(0x236))var _0x3f6e4d=users[_0x5b697f(0x236)];else{if(_0x331e71[0x0]['language']==_0x5b697f(0x29e))var _0x3f6e4d=users[_0x5b697f(0x29e)];else{if(_0x331e71[0x0][_0x5b697f(0x1c5)]=='French')var _0x3f6e4d=users[_0x5b697f(0x26a)];else{if(_0x331e71[0x0][_0x5b697f(0x1c5)]==_0x5b697f(0x1b1))var _0x3f6e4d=users['Portuguese'];else{if(_0x331e71[0x0][_0x5b697f(0x1c5)]==_0x5b697f(0x1ac))var _0x3f6e4d=users[_0x5b697f(0x1ac)];else{if(_0x331e71[0x0][_0x5b697f(0x1c5)]==_0x5b697f(0x284))var _0x3f6e4d=users['Arabic'];}}}}}}}const _0x180cc3=getRandom8DigitNumber();_0x180cc3['then'](_0x59abfe=>{var _0x15233e=_0x5b697f;_0x281b49[_0x15233e(0x1e4)](_0x15233e(0x25c),{'success':_0x329e25[_0x15233e(0x239)](_0x15233e(0x1d8)),'errors':_0x329e25[_0x15233e(0x239)](_0x15233e(0x196)),'role':_0x57ed97,'profile':_0x5e911b,'customer':_0x4ce704,'warehouse':_0x17ff65,'product':_0x2d9867,'invoice':_0x59abfe,'master_shop':_0x331e71,'language':_0x3f6e4d,'rooms_data':_0x467512});})[_0x5b697f(0x25d)](_0x384b29=>{var _0x20e6b5=_0x5b697f;_0x329e25['flash'](_0x20e6b5(0x196),_0x20e6b5(0x217)),_0x281b49['redirect'](_0x20e6b5(0x21f));});}catch(_0x2a6c99){console[_0x5b697f(0x214)](_0x2a6c99);}}),router[a0_0x16193f(0x1fb)](a0_0x16193f(0x1b7),auth,async(_0x27f026,_0x2d7eb4)=>{var _0x33b03c=a0_0x16193f;try{const _0x35ed13=_0x27f026[_0x33b03c(0x258)]['id'];console['log'](_0x35ed13);const _0x24a2d9=await product[_0x33b03c(0x248)](),_0x5ada3c=await purchases[_0x33b03c(0x192)]([{'$match':{'warehouse_name':_0x35ed13}},{'$unwind':_0x33b03c(0x21d)},{'$group':{'_id':_0x33b03c(0x28b)}}]);console[_0x33b03c(0x214)](_0x33b03c(0x1ae),_0x5ada3c),_0x2d7eb4['status'](0xc8)[_0x33b03c(0x1bf)]({'purchases_data':_0x5ada3c,'product_data':_0x24a2d9});}catch(_0x42d6d0){console[_0x33b03c(0x214)](_0x42d6d0);}}),router[a0_0x16193f(0x262)](a0_0x16193f(0x1be),auth,async(_0x20fdce,_0x1852e5)=>{var _0x3828c0=a0_0x16193f;try{const {warehouse_data:_0x2c9635,product_data:_0x3e1b24}=_0x20fdce[_0x3828c0(0x26f)];console[_0x3828c0(0x214)](_0x20fdce[_0x3828c0(0x26f)][_0x3828c0(0x25e)]);;const _0x1f4c9e=await master_shop['find']();console[_0x3828c0(0x214)](_0x3828c0(0x1bb),_0x1f4c9e);const _0x3bf434=await product[_0x3828c0(0x19b)]({'name':_0x3e1b24});console[_0x3828c0(0x214)](_0x3828c0(0x26b),_0x3bf434);const _0x17107c=await warehouse[_0x3828c0(0x192)]([{'$match':{'name':_0x2c9635}},{'$unwind':_0x3828c0(0x27d)},{'$match':{'product_details.product_name':_0x3e1b24}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':'$product_details.product_stock'}}}]);console['log'](_0x3828c0(0x22b),_0x17107c),_0x1852e5['status'](0xc8)[_0x3828c0(0x1bf)]({'master':_0x1f4c9e,'new_product':_0x3bf434,'stock_data':_0x17107c});}catch(_0x42e045){console[_0x3828c0(0x214)](_0x42e045);}}),router['post'](a0_0x16193f(0x276),auth,async(_0x1ba329,_0x33a035)=>{var _0x2b2e65=a0_0x16193f;try{const {invoice:_0x3eec74,date:_0x2dfa7b,warehouse_name:_0x1d6675,product_name:_0x5cc898,stock:_0x251178,quantity:_0xfabbba,note:_0x4116b9,room:_0x6c9cb,primary_code:_0x107a77,secondary_code:_0x4cf0a3,prod_code:_0x1cddfb,level:_0x114772,isle:_0xacd061,pallet:_0x11c344,batch_code:_0x164f14,SCRN:_0x182144,expiry_date:_0x54bdee,mode_transpo:_0x3eeefa,name_driver:_0x5deb3a}=_0x1ba329[_0x2b2e65(0x26f)];if(typeof _0x5cc898==_0x2b2e65(0x289))var _0x2019ce=[_0x1ba329[_0x2b2e65(0x26f)]['product_name']],_0x495fb8=[_0x1ba329['body']['stock']],_0x3ac478=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x24d)]],_0x57fcbf=[_0x1ba329[_0x2b2e65(0x26f)]['primary_code']],_0x579a7a=[_0x1ba329[_0x2b2e65(0x26f)]['secondary_code']],_0x40fbf3=[_0x1ba329['body'][_0x2b2e65(0x251)]],_0x2d9321=[_0x1ba329['body']['level']],_0x280307=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x263)]],_0x950aac=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x1cb)]],_0x2221b4=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x223)]],_0x230917=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x24e)]],_0x5c4e38=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x1aa)]],_0x261d72=[_0x1ba329[_0x2b2e65(0x26f)]['max_per_unit']],_0x5d96bc=[_0x1ba329[_0x2b2e65(0x26f)]['prod_cat']],_0x105b60=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x23f)]],_0x1286aa=[_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x28f)]];else var _0x2019ce=[..._0x1ba329[_0x2b2e65(0x26f)]['product_name']],_0x495fb8=[..._0x1ba329['body']['stock']],_0x3ac478=[..._0x1ba329[_0x2b2e65(0x26f)]['carton']],_0x57fcbf=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x211)]],_0x579a7a=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x232)]],_0x40fbf3=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x251)]],_0x2d9321=[..._0x1ba329['body'][_0x2b2e65(0x24a)]],_0x280307=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x263)]],_0x950aac=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x1cb)]],_0x2221b4=[..._0x1ba329[_0x2b2e65(0x26f)]['batch_code']],_0x230917=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x24e)]],_0x5c4e38=[..._0x1ba329[_0x2b2e65(0x26f)]['product_date']],_0x261d72=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x274)]],_0x5d96bc=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x212)]],_0x105b60=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x23f)]],_0x1286aa=[..._0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x28f)]];const _0x3c48d7=_0x2019ce[_0x2b2e65(0x29f)](_0x3be202=>{return _0x3be202={'product_name':_0x3be202};});_0x495fb8[_0x2b2e65(0x246)]((_0x304f61,_0x38860a)=>{_0x3c48d7[_0x38860a]['stock']=_0x304f61;}),_0x3ac478[_0x2b2e65(0x246)]((_0x4777a4,_0x368272)=>{var _0x5551d9=_0x2b2e65;_0x3c48d7[_0x368272][_0x5551d9(0x295)]=Math['abs'](_0x4777a4);}),_0x57fcbf[_0x2b2e65(0x246)]((_0x5e0502,_0x5c2f6a)=>{var _0x26f3bb=_0x2b2e65;_0x3c48d7[_0x5c2f6a][_0x26f3bb(0x211)]=_0x5e0502;}),_0x579a7a['forEach']((_0x4afa59,_0x25408a)=>{var _0xce3bc5=_0x2b2e65;_0x3c48d7[_0x25408a][_0xce3bc5(0x232)]=_0x4afa59;}),_0x40fbf3['forEach']((_0x4e070f,_0x32c0f5)=>{var _0xf36b28=_0x2b2e65;_0x3c48d7[_0x32c0f5][_0xf36b28(0x1ee)]=_0x4e070f;}),_0x2d9321[_0x2b2e65(0x246)]((_0xb471b2,_0x3648ef)=>{var _0x69f2a8=_0x2b2e65;_0x3c48d7[_0x3648ef][_0x69f2a8(0x1f6)]=_0xb471b2;}),_0x280307[_0x2b2e65(0x246)]((_0x3566bc,_0x15570e)=>{var _0x2700cd=_0x2b2e65;_0x3c48d7[_0x15570e][_0x2700cd(0x1b5)]=_0x3566bc;}),_0x950aac[_0x2b2e65(0x246)]((_0x31dcdf,_0x6176d6)=>{var _0x1c4d82=_0x2b2e65;_0x3c48d7[_0x6176d6][_0x1c4d82(0x1cb)]=_0x31dcdf;}),_0x2221b4[_0x2b2e65(0x246)]((_0xde472,_0x520bb4)=>{var _0x1a4c2e=_0x2b2e65;_0x3c48d7[_0x520bb4][_0x1a4c2e(0x223)]=_0xde472;}),_0x230917[_0x2b2e65(0x246)]((_0x493328,_0x1e8428)=>{var _0x14df3f=_0x2b2e65;_0x3c48d7[_0x1e8428][_0x14df3f(0x24e)]=_0x493328;}),_0x5c4e38['forEach']((_0x2e9d6d,_0x563bfe)=>{var _0x299a3a=_0x2b2e65;_0x3c48d7[_0x563bfe][_0x299a3a(0x226)]=_0x2e9d6d;}),_0x261d72['forEach']((_0x2491d4,_0x30cc24)=>{var _0x548849=_0x2b2e65;_0x3c48d7[_0x30cc24][_0x548849(0x268)]=_0x2491d4;}),_0x5d96bc['forEach']((_0x329b46,_0x47f184)=>{var _0x5a0460=_0x2b2e65;_0x3c48d7[_0x47f184][_0x5a0460(0x212)]=_0x329b46;}),_0x105b60[_0x2b2e65(0x246)]((_0x4c8704,_0x4a9148)=>{var _0x3f81bf=_0x2b2e65;_0x3c48d7[_0x4a9148][_0x3f81bf(0x242)]=_0x4c8704;}),_0x1286aa[_0x2b2e65(0x246)]((_0x2c2f36,_0x301ce5)=>{var _0x3e7fbb=_0x2b2e65;_0x3c48d7[_0x301ce5][_0x3e7fbb(0x245)]=_0x2c2f36;});var _0x4fc975=0x0;_0x3c48d7['forEach'](_0x1502f3=>{var _0x42dc7f=_0x2b2e65;parseFloat(_0x1502f3[_0x42dc7f(0x269)])<parseFloat(_0x1502f3[_0x42dc7f(0x295)])&&parseFloat(_0x1502f3[_0x42dc7f(0x295)])>parseFloat(_0x1502f3[_0x42dc7f(0x269)])&&(console[_0x42dc7f(0x214)](_0x1502f3[_0x42dc7f(0x269)]+_0x42dc7f(0x252)+_0x1502f3[_0x42dc7f(0x295)]),_0x4fc975++);});if(_0x4fc975!=0x0)return _0x1ba329[_0x2b2e65(0x239)]('errors',_0x2b2e65(0x238)),_0x33a035[_0x2b2e65(0x1df)](_0x2b2e65(0x257));const _0x10f4ff=_0x3c48d7[_0x2b2e65(0x1c7)](_0x458778=>_0x458778[_0x2b2e65(0x295)]!=='0'&&_0x458778[_0x2b2e65(0x295)]!==''),_0x1e0856=new sales_finished({'invoice':_0x3eec74,'customer':_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x271)],'date':_0x2dfa7b,'warehouse_name':_0x1d6675,'sale_product':_0x10f4ff,'note':_0x4116b9,'room':_0x6c9cb,'primary_code':_0x107a77,'secondary_code':_0x4cf0a3,'prod_code':_0x1cddfb,'SCRN':_0x182144,'finalize':'False','mode_transpo':_0x3eeefa,'name_driver':_0x5deb3a}),_0x5c61b0=await _0x1e0856['save'](),_0x55a21a=await sales_finished[_0x2b2e65(0x19b)]({'invoice':_0x3eec74}),_0x4cbfac=new c_payment_data({'invoice':_0x3eec74,'customer':_0x1ba329['body']['customer'],'reason':_0x2b2e65(0x288)});await _0x4cbfac[_0x2b2e65(0x213)]();const _0x141c47=await master_shop[_0x2b2e65(0x248)](),_0x27e05d=await email_settings[_0x2b2e65(0x19b)](),_0x4b1f35=await customer[_0x2b2e65(0x19b)]({'name':_0x1ba329[_0x2b2e65(0x26f)][_0x2b2e65(0x271)]});_0x141c47[0x0][_0x2b2e65(0x1b6)]==0x1?(right_currency=_0x141c47[0x0][_0x2b2e65(0x227)],left_currency=''):(right_currency='',left_currency=_0x141c47[0x0][_0x2b2e65(0x227)]);var _0x2c63e8=_0x2019ce,_0x4e094c=_0x3ac478,_0x3e3729='',_0xb5bc83;for(_0xb5bc83 in _0x2c63e8){_0x3e3729+='<tr>'+_0x2b2e65(0x26e)+_0x2c63e8[_0xb5bc83]+_0x2b2e65(0x1b9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4e094c[_0xb5bc83]+'</td>'+_0x2b2e65(0x291);}console['log'](_0x2b2e65(0x23c),_0x3e3729);let _0x213f96=nodemailer[_0x2b2e65(0x20e)]({'service':_0x2b2e65(0x1e5),'auth':{'user':_0x27e05d[_0x2b2e65(0x1b3)],'pass':_0x27e05d[_0x2b2e65(0x1d4)]}}),_0x1f6d6a={'from':_0x27e05d['email'],'to':_0x4b1f35[_0x2b2e65(0x1b3)],'subject':_0x2b2e65(0x1b8),'attachments':[{'filename':_0x2b2e65(0x24b),'path':__dirname+_0x2b2e65(0x1f4)+_0x2b2e65(0x278)+_0x141c47[0x0][_0x2b2e65(0x1f2)],'cid':_0x2b2e65(0x1f3)}],'html':_0x2b2e65(0x1fd)+_0x2b2e65(0x19a)+_0x2b2e65(0x1dc)+_0x2b2e65(0x23d)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2b2e65(0x23d)+_0x2b2e65(0x22f)+_0x2b2e65(0x265)+_0x2b2e65(0x23d)+'<h2>\x20'+_0x141c47[0x0]['site_title']+_0x2b2e65(0x28e)+_0x2b2e65(0x265)+_0x2b2e65(0x265)+'<hr\x20class=\x22my-3\x22>'+_0x2b2e65(0x23d)+_0x2b2e65(0x199)+_0x2b2e65(0x1e8)+_0x3eec74+'\x20'+_0x2b2e65(0x197)+_0x2b2e65(0x216)+_0x2dfa7b+'\x20'+_0x2b2e65(0x1a1)+'</h5>'+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2b2e65(0x1ad)+'<tr>'+_0x2b2e65(0x1af)+_0x2b2e65(0x18d)+_0x2b2e65(0x291)+'</thead>'+_0x2b2e65(0x234)+'\x20'+_0x3e3729+'\x20'+_0x2b2e65(0x1dd)+_0x2b2e65(0x19d)+'<div>'+_0x2b2e65(0x215)+_0x2b2e65(0x1c1)+_0x141c47[0x0][_0x2b2e65(0x27e)]+_0x2b2e65(0x222)+_0x2b2e65(0x265)+_0x2b2e65(0x265)+_0x2b2e65(0x1ab)};_0x213f96['sendMail'](_0x1f6d6a,function(_0x5f5b86,_0x66326d){var _0x930b1c=_0x2b2e65;_0x5f5b86?(console[_0x930b1c(0x214)](_0x5f5b86),console['log'](_0x930b1c(0x29a))):console[_0x930b1c(0x214)]('Email\x20sent\x20successfully');}),_0x1ba329[_0x2b2e65(0x239)](_0x2b2e65(0x1d8),_0x2b2e65(0x1f0)),_0x33a035[_0x2b2e65(0x1df)](_0x2b2e65(0x25a)+_0x5c61b0[_0x2b2e65(0x297)]);}catch(_0x2d666d){console[_0x2b2e65(0x214)](_0x2d666d);}}),router[a0_0x16193f(0x1fb)](a0_0x16193f(0x204),auth,async(_0xc90c13,_0x4ba110)=>{var _0x4b219a=a0_0x16193f;try{const {username:_0x29972b,email:_0x1eca8c,role:_0x653cc6}=_0xc90c13[_0x4b219a(0x24f)],_0x15c106=_0xc90c13[_0x4b219a(0x24f)],_0x214932=await profile[_0x4b219a(0x19b)]({'email':_0x15c106[_0x4b219a(0x1b3)]}),_0x1d1b9d=await master_shop[_0x4b219a(0x248)](),_0x492ecc=_0xc90c13[_0x4b219a(0x258)]['id'],_0x2fb411=await sales_finished[_0x4b219a(0x294)](_0x492ecc),_0x2381e0=await warehouse[_0x4b219a(0x192)]([{'$match':{'name':_0x2fb411[_0x4b219a(0x1c6)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4b219a(0x1bd)},'product_stock':{'$first':_0x4b219a(0x1a6)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x4b219a(0x224)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4b219a(0x29d)},'product_code':{'$first':_0x4b219a(0x20a)},'storage':{'$first':_0x4b219a(0x1ea)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4b219a(0x1ef)},'production_date':{'$first':_0x4b219a(0x22c)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x4b219a(0x1ba)},'room_data':{'$first':'$product_details.room_name'}}}]),_0x116df6=await customer['find']({});let _0x153485;if(_0x15c106[_0x4b219a(0x1e7)]==_0x4b219a(0x202)){const _0x54b16b=await staff[_0x4b219a(0x19b)]({'email':_0x15c106[_0x4b219a(0x1b3)]});_0x153485=await warehouse[_0x4b219a(0x192)]([{'$match':{'status':'Enabled','name':_0x54b16b['warehouse']}},{'$group':{'_id':_0x4b219a(0x1ce),'name':{'$first':_0x4b219a(0x1ce)}}}]);}else _0x153485=await warehouse[_0x4b219a(0x192)]([{'$match':{'status':_0x4b219a(0x1a7)}},{'$group':{'_id':_0x4b219a(0x1ce),'name':{'$first':_0x4b219a(0x1ce)}}}]);const _0x47872b=await product[_0x4b219a(0x248)]({});if(_0x1d1b9d[0x0]['language']==_0x4b219a(0x219)){var _0x492784=users[_0x4b219a(0x1d0)];console[_0x4b219a(0x214)](_0x492784);}else{if(_0x1d1b9d[0x0]['language']=='Hindi')var _0x492784=users[_0x4b219a(0x231)];else{if(_0x1d1b9d[0x0][_0x4b219a(0x1c5)]==_0x4b219a(0x236))var _0x492784=users[_0x4b219a(0x236)];else{if(_0x1d1b9d[0x0][_0x4b219a(0x1c5)]==_0x4b219a(0x29e))var _0x492784=users[_0x4b219a(0x29e)];else{if(_0x1d1b9d[0x0]['language']=='French')var _0x492784=users[_0x4b219a(0x26a)];else{if(_0x1d1b9d[0x0][_0x4b219a(0x1c5)]=='Portuguese\x20(BR)')var _0x492784=users[_0x4b219a(0x256)];else{if(_0x1d1b9d[0x0]['language']==_0x4b219a(0x1ac))var _0x492784=users['Chinese'];else{if(_0x1d1b9d[0x0][_0x4b219a(0x1c5)]==_0x4b219a(0x284))var _0x492784=users[_0x4b219a(0x200)];}}}}}}}_0x4ba110[_0x4b219a(0x1e4)](_0x4b219a(0x1f7),{'success':_0xc90c13[_0x4b219a(0x239)](_0x4b219a(0x1d8)),'errors':_0xc90c13['flash'](_0x4b219a(0x196)),'role':_0x15c106,'profile':_0x214932,'customer':_0x116df6,'warehouse':_0x153485,'product':_0x2381e0,'user':_0x2fb411,'master_shop':_0x1d1b9d,'unit':_0x47872b,'language':_0x492784});}catch(_0x53a058){console['log'](_0x53a058);}}),router[a0_0x16193f(0x262)](a0_0x16193f(0x204),auth,async(_0x39624b,_0x318ea5)=>{var _0x50e398=a0_0x16193f;try{const _0x33b126=_0x39624b[_0x50e398(0x258)]['id'],{invoice:_0x1989d3,warehouse_name:_0x3698f7,room:_0x14700c}=_0x39624b[_0x50e398(0x26f)],_0x51dedb=await sales_finished[_0x50e398(0x19b)]({'invoice':_0x1989d3}),_0x1dc382=_0x51dedb['sale_product'][_0x50e398(0x29f)](async _0x1af410=>{var _0x453e84=_0x50e398,_0x2fe530=await warehouse['findOne']({'name':_0x3698f7,'room':_0x1af410['room_name'],'warehouse_category':'Finished\x20Goods'});const _0x970ff8=_0x2fe530[_0x453e84(0x23e)][_0x453e84(0x29f)](_0x3cd9c7=>{var _0x2593f8=_0x453e84;_0x3cd9c7[_0x2593f8(0x190)]==_0x1af410['product_name']&&_0x3cd9c7[_0x2593f8(0x1f6)]==_0x1af410['bay']&&_0x3cd9c7['expiry_date']==_0x1af410['expiry_date']&&_0x3cd9c7[_0x2593f8(0x226)]==_0x1af410[_0x2593f8(0x226)]&&_0x3cd9c7[_0x2593f8(0x223)]==_0x1af410[_0x2593f8(0x223)]&&_0x3cd9c7[_0x2593f8(0x245)]==_0x1af410[_0x2593f8(0x245)]&&(console['log'](_0x3cd9c7[_0x2593f8(0x190)]+'\x20==\x20'+_0x1af410[_0x2593f8(0x190)]+_0x2593f8(0x1f1)+_0x3cd9c7['bay']+_0x2593f8(0x247)+_0x1af410[_0x2593f8(0x1f6)]+_0x2593f8(0x1f1)+_0x3cd9c7[_0x2593f8(0x226)]+_0x2593f8(0x247)+_0x1af410[_0x2593f8(0x226)]+_0x2593f8(0x1f1)+_0x3cd9c7[_0x2593f8(0x24e)]+_0x2593f8(0x247)+_0x1af410['expiry_date']+'\x20&&\x20'+_0x3cd9c7[_0x2593f8(0x223)]+'\x20==\x20'+_0x1af410[_0x2593f8(0x223)]+_0x2593f8(0x1f1)+_0x3cd9c7['invoice']+_0x2593f8(0x247)+_0x1af410[_0x2593f8(0x245)]+_0x2593f8(0x1f1)+_0x3cd9c7[_0x2593f8(0x283)]+_0x2593f8(0x247)+_0x1af410['quantity']+'\x20>>>\x20'+_0x1af410[_0x2593f8(0x242)]),_0x3cd9c7['product_stock']=Math[_0x2593f8(0x260)](Math[_0x2593f8(0x260)](_0x3cd9c7[_0x2593f8(0x283)])-Math[_0x2593f8(0x260)](_0x1af410[_0x2593f8(0x295)])));});return _0x2fe530;});Promise[_0x50e398(0x1c8)](_0x1dc382)[_0x50e398(0x28a)](async _0x252710=>{var _0x2336a2=_0x50e398;try{for(const _0xaae4be of _0x252710){await _0xaae4be[_0x2336a2(0x213)]();}_0x51dedb[_0x2336a2(0x1e2)]='True';const _0x5e3dd2=await _0x51dedb[_0x2336a2(0x213)](),_0x494ec2=await master_shop[_0x2336a2(0x248)](),_0x30e973=await email_settings[_0x2336a2(0x19b)](),_0xc417c0=await supervisor_settings[_0x2336a2(0x248)]();var _0x2d4711=_0x51dedb[_0x2336a2(0x187)],_0x36f4b5='',_0x2244b9;for(_0x2244b9 in _0x2d4711){var _0x3faa4e='FG';_0x51dedb[_0x2336a2(0x1c6)]==_0x2336a2(0x27c)&&(_0x3faa4e='DG'),_0x36f4b5+=_0x2336a2(0x1de)+_0x2336a2(0x26e)+_0x2d4711[_0x2244b9][_0x2336a2(0x190)]+'</td>'+_0x2336a2(0x26e)+_0x2d4711[_0x2244b9]['product_code']+_0x2336a2(0x1b9)+_0x2336a2(0x26e)+_0x2d4711[_0x2244b9]['quantity']+_0x2336a2(0x1b9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2d4711[_0x2244b9]['unit']+_0x2336a2(0x1b9)+_0x2336a2(0x26e)+_0x2d4711[_0x2244b9][_0x2336a2(0x1cb)]+_0x2336a2(0x1b9)+_0x2336a2(0x26e)+_0x51dedb[_0x2336a2(0x1c6)]+_0x2336a2(0x1b9)+_0x2336a2(0x26e)+_0x2d4711[_0x2244b9][_0x2336a2(0x242)]+_0x2336a2(0x1b9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3faa4e+_0x2d4711[_0x2244b9][_0x2336a2(0x1f6)]+'</td>';}let _0x37cd3b=nodemailer[_0x2336a2(0x20e)]({'host':_0x30e973[_0x2336a2(0x287)],'port':Number(_0x30e973[_0x2336a2(0x241)]),'secure':![],'auth':{'user':_0x30e973[_0x2336a2(0x1b3)],'pass':_0x30e973['password']}}),_0xa8347f={'from':_0x30e973['email'],'to':_0xc417c0[0x0]['FGSEmail'],'subject':'Sales\x20Mail','attachments':[{'filename':_0x2336a2(0x24b),'path':__dirname+'/../public'+_0x2336a2(0x278)+_0x494ec2[0x0][_0x2336a2(0x1f2)],'cid':_0x2336a2(0x1f3)}],'html':_0x2336a2(0x1fd)+_0x2336a2(0x19a)+_0x2336a2(0x1dc)+_0x2336a2(0x23d)+_0x2336a2(0x277)+_0x2336a2(0x23d)+_0x2336a2(0x22f)+_0x2336a2(0x265)+'<div>'+_0x2336a2(0x298)+_0x494ec2[0x0][_0x2336a2(0x27e)]+'\x20</h2>'+'</div>'+'</div>'+_0x2336a2(0x1a0)+_0x2336a2(0x23d)+_0x2336a2(0x199)+_0x2336a2(0x1e8)+_0x51dedb[_0x2336a2(0x245)]+'\x20'+_0x2336a2(0x197)+_0x2336a2(0x216)+_0x51dedb[_0x2336a2(0x254)]+'\x20'+_0x2336a2(0x1a1)+_0x2336a2(0x222)+'</div>'+_0x2336a2(0x19c)+_0x2336a2(0x1ad)+_0x2336a2(0x1de)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2336a2(0x18a)+_0x2336a2(0x1bc)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x2336a2(0x21b)+_0x2336a2(0x292)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x2336a2(0x228)+'</tr>'+'</thead>'+_0x2336a2(0x234)+'\x20'+_0x36f4b5+'\x20'+_0x2336a2(0x1dd)+'</table>'+'<div>'+_0x2336a2(0x215)+_0x2336a2(0x1c1)+_0x494ec2[0x0]['site_title']+_0x2336a2(0x222)+_0x2336a2(0x265)+'</div>'+'</body></html>'};_0x37cd3b[_0x2336a2(0x29b)](_0xa8347f,function(_0xe870d7,_0x1d27a0){var _0x2e4868=_0x2336a2;_0xe870d7?(console[_0x2e4868(0x214)](_0xe870d7),console['log'](_0x2e4868(0x29a))):console[_0x2e4868(0x214)](_0x2e4868(0x299));}),_0x39624b[_0x2336a2(0x239)](_0x2336a2(0x1d8),_0x2336a2(0x240)),_0x318ea5['redirect']('/picking_list/pdf/'+_0x33b126);}catch(_0x37159a){console[_0x2336a2(0x27f)](_0x37159a),_0x318ea5[_0x2336a2(0x1e0)](0x1f4)[_0x2336a2(0x1bf)]({'error':_0x2336a2(0x189)});}})[_0x50e398(0x25d)](_0x25a4af=>{var _0x3bf58c=_0x50e398;console[_0x3bf58c(0x27f)](_0x25a4af),_0x318ea5[_0x3bf58c(0x1e0)](0x1f4)[_0x3bf58c(0x1bf)]({'error':_0x3bf58c(0x22a)});});}catch(_0x39170f){console[_0x50e398(0x214)](_0x39170f);}}),router[a0_0x16193f(0x1fb)](a0_0x16193f(0x26d),auth,async(_0x3103ed,_0x10e35f)=>{var _0x91449e=a0_0x16193f;try{const {username:_0x281755,email:_0x4d8fcf,role:_0x11dd55}=_0x3103ed[_0x91449e(0x24f)],_0x4d50ed=_0x3103ed[_0x91449e(0x24f)],_0x2dd9f1=await profile[_0x91449e(0x19b)]({'email':_0x4d50ed[_0x91449e(0x1b3)]}),_0x3a7f83=await master_shop['find'](),_0x282c76=_0x3103ed[_0x91449e(0x258)]['id'],_0x40dc83=await sales_finished[_0x91449e(0x294)](_0x282c76);let _0x15b885=new Date(_0x40dc83['expiry_date']),_0x5bd68f=('0'+_0x15b885['getDate']())[_0x91449e(0x27b)](-0x2),_0x3fd67b=('0'+(_0x15b885[_0x91449e(0x244)]()+0x1))[_0x91449e(0x27b)](-0x2),_0x5131df=_0x15b885[_0x91449e(0x23b)](),_0x2a8363=_0x5131df+'-'+_0x3fd67b+'-'+_0x5bd68f;var _0x2bdb4a=[_0x91449e(0x281),'Enclosed'];const _0xaa2aa6=await warehouse[_0x91449e(0x192)]([{'$match':{'name':_0x40dc83[_0x91449e(0x1c6)],'room':_0x40dc83[_0x91449e(0x203)]}},{'$unwind':_0x91449e(0x27d)},{'$group':{'_id':_0x91449e(0x1e3),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x91449e(0x1a6)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x91449e(0x224)},'type':{'$first':_0x91449e(0x22d)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x91449e(0x29d)},'product_code':{'$first':_0x91449e(0x20a)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x91449e(0x25f)}}}]),_0x5841ae=await customer[_0x91449e(0x248)]({});let _0x39a7fd;if(_0x4d50ed[_0x91449e(0x1e7)]==_0x91449e(0x202)){const _0x3bf98f=await staff[_0x91449e(0x19b)]({'email':_0x4d50ed[_0x91449e(0x1b3)]});_0x39a7fd=await warehouse[_0x91449e(0x192)]([{'$match':{'status':_0x91449e(0x1a7),'name':_0x3bf98f['warehouse']}},{'$group':{'_id':_0x91449e(0x1ce),'name':{'$first':_0x91449e(0x1ce)}}}]);}else _0x39a7fd=await warehouse[_0x91449e(0x192)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x91449e(0x1ce),'name':{'$first':'$name'}}}]);const _0x5f2024=await product[_0x91449e(0x248)]({});if(_0x3a7f83[0x0][_0x91449e(0x1c5)]=='English\x20(US)'){var _0x3b9406=users[_0x91449e(0x1d0)];console[_0x91449e(0x214)](_0x3b9406);}else{if(_0x3a7f83[0x0]['language']==_0x91449e(0x231))var _0x3b9406=users[_0x91449e(0x231)];else{if(_0x3a7f83[0x0][_0x91449e(0x1c5)]==_0x91449e(0x236))var _0x3b9406=users['German'];else{if(_0x3a7f83[0x0][_0x91449e(0x1c5)]==_0x91449e(0x29e))var _0x3b9406=users['Spanish'];else{if(_0x3a7f83[0x0]['language']=='French')var _0x3b9406=users[_0x91449e(0x26a)];else{if(_0x3a7f83[0x0][_0x91449e(0x1c5)]==_0x91449e(0x1b1))var _0x3b9406=users[_0x91449e(0x256)];else{if(_0x3a7f83[0x0][_0x91449e(0x1c5)]==_0x91449e(0x1ac))var _0x3b9406=users['Chinese'];else{if(_0x3a7f83[0x0][_0x91449e(0x1c5)]==_0x91449e(0x284))var _0x3b9406=users[_0x91449e(0x200)];}}}}}}}_0x10e35f['render'](_0x91449e(0x207),{'success':_0x3103ed[_0x91449e(0x239)](_0x91449e(0x1d8)),'errors':_0x3103ed[_0x91449e(0x239)](_0x91449e(0x196)),'role':_0x4d50ed,'profile':_0x2dd9f1,'customer':_0x5841ae,'warehouse':_0x39a7fd,'product':_0xaa2aa6,'user':_0x40dc83,'master_shop':_0x3a7f83,'unit':_0x5f2024,'language':_0x3b9406,'rooms_data':_0x2bdb4a,'ed_fullDate':_0x2a8363});}catch(_0x2f79eb){console['log'](_0x2f79eb);}}),router[a0_0x16193f(0x262)](a0_0x16193f(0x26d),auth,async(_0x545052,_0x61038e)=>{var _0x4192f4=a0_0x16193f;try{const _0x474092=_0x545052[_0x4192f4(0x258)]['id'],_0x14754d=await sales_finished[_0x4192f4(0x19b)]({'_id':_0x545052[_0x4192f4(0x258)]['id']}),_0x5c8e04=await warehouse[_0x4192f4(0x19b)]({'name':_0x14754d[_0x4192f4(0x1c6)],'room':_0x545052[_0x4192f4(0x26f)][_0x4192f4(0x203)],'warehouse_category':_0x4192f4(0x285)}),{invoice:_0x14a275,customer:_0x3bf6be,date:_0x261d1d,warehouse_name:_0x2e6740,product_name:_0xbba8e9,stock:_0x5f364f,adjust_qty:_0xc5655f,note:_0x328f0d,room:_0x5063ed,primary_code:_0x4bbf3a,secondary_code:_0x2566a6,prod_code:_0x1a7659,level:_0x289605,isle:_0x61e55d,pallet:_0x1f11c4,expiry_date:_0x5ebee2}=_0x545052[_0x4192f4(0x26f)];if(typeof _0xbba8e9==_0x4192f4(0x289))var _0xfbac12=[_0x545052[_0x4192f4(0x26f)][_0x4192f4(0x190)]],_0x326a37=[_0x545052[_0x4192f4(0x26f)]['stock']],_0x59eac8=[_0x545052[_0x4192f4(0x26f)][_0x4192f4(0x279)]],_0x3ca363=[_0x545052[_0x4192f4(0x26f)][_0x4192f4(0x211)]],_0x4eaf81=[_0x545052[_0x4192f4(0x26f)][_0x4192f4(0x232)]],_0x50e98=[_0x545052['body'][_0x4192f4(0x251)]],_0x2943f7=[_0x545052[_0x4192f4(0x26f)][_0x4192f4(0x24a)]],_0x221c60=[_0x545052[_0x4192f4(0x26f)]['expiry_date']];else var _0xfbac12=[..._0x545052[_0x4192f4(0x26f)][_0x4192f4(0x190)]],_0x326a37=[..._0x545052['body'][_0x4192f4(0x269)]],_0x59eac8=[..._0x545052[_0x4192f4(0x26f)][_0x4192f4(0x279)]],_0x3ca363=[..._0x545052[_0x4192f4(0x26f)][_0x4192f4(0x211)]],_0x4eaf81=[..._0x545052['body'][_0x4192f4(0x232)]],_0x50e98=[..._0x545052[_0x4192f4(0x26f)][_0x4192f4(0x251)]],_0x2943f7=[..._0x545052['body']['level']],_0x221c60=[..._0x545052[_0x4192f4(0x26f)][_0x4192f4(0x24e)]];const _0x22e0ea=_0xfbac12[_0x4192f4(0x29f)](_0x13ce84=>{return _0x13ce84={'product_name':_0x13ce84};});_0x326a37[_0x4192f4(0x246)]((_0x455267,_0x552788)=>{var _0x1b2a1b=_0x4192f4;_0x22e0ea[_0x552788][_0x1b2a1b(0x269)]=_0x455267;}),_0x59eac8[_0x4192f4(0x246)]((_0x350c9d,_0xc6457f)=>{var _0x2bd897=_0x4192f4;_0x22e0ea[_0xc6457f][_0x2bd897(0x295)]=_0x350c9d;}),_0x3ca363['forEach']((_0x12374b,_0x2f8ac0)=>{_0x22e0ea[_0x2f8ac0]['primary_code']=_0x12374b;}),_0x4eaf81['forEach']((_0x388380,_0x2093e6)=>{var _0xc0bf4a=_0x4192f4;_0x22e0ea[_0x2093e6][_0xc0bf4a(0x232)]=_0x388380;}),_0x50e98[_0x4192f4(0x246)]((_0x1c22c5,_0x470621)=>{_0x22e0ea[_0x470621]['product_code']=_0x1c22c5;}),_0x2943f7[_0x4192f4(0x246)]((_0x2db55d,_0x3cdebe)=>{_0x22e0ea[_0x3cdebe]['level']=_0x2db55d;}),_0x221c60[_0x4192f4(0x246)]((_0x6a0710,_0x25e8e3)=>{var _0x530099=_0x4192f4;_0x22e0ea[_0x25e8e3][_0x530099(0x24e)]=_0x6a0710;});var _0xc15933=0x0;_0x22e0ea[_0x4192f4(0x246)](_0x5ae338=>{var _0x50e1a9=_0x4192f4;console[_0x50e1a9(0x214)](_0x50e1a9(0x27a),_0x5ae338),(parseInt(_0x5ae338[_0x50e1a9(0x269)])<parseInt(_0x5ae338['quantity'])||parseInt(_0x5ae338['quantity'])==0x0)&&_0xc15933++;});if(_0xc15933!=0x0)return _0x545052[_0x4192f4(0x239)](_0x4192f4(0x196),_0x4192f4(0x1d5)),_0x61038e['redirect'](_0x4192f4(0x257));_0x14754d[_0x4192f4(0x187)]['forEach'](_0x160c63=>{var _0x3074fd=_0x4192f4;const _0x350668=_0x5c8e04[_0x3074fd(0x23e)][_0x3074fd(0x29f)](_0x2ac47f=>{var _0x591cea=_0x3074fd;_0x2ac47f['product_name']==_0x160c63[_0x591cea(0x190)]&&_0x2ac47f[_0x591cea(0x1f6)]==_0x160c63[_0x591cea(0x1f6)]&&(_0x2ac47f[_0x591cea(0x283)]=parseInt(_0x2ac47f[_0x591cea(0x283)])+parseInt(_0x160c63[_0x591cea(0x295)]));});}),await _0x5c8e04[_0x4192f4(0x213)]();const _0x23ebab=_0x22e0ea['filter'](_0x553720=>_0x553720['quantity']!=='0'&&_0x553720['quantity']!=='');_0x14754d['invoice']=_0x14a275,_0x14754d['customer']=_0x3bf6be,_0x14754d[_0x4192f4(0x254)]=_0x261d1d,_0x14754d[_0x4192f4(0x1c6)]=_0x2e6740,_0x14754d[_0x4192f4(0x187)]=_0x23ebab,_0x14754d['note']=_0x328f0d,_0x14754d[_0x4192f4(0x203)]=_0x5063ed;const _0xa3322b=await _0x14754d[_0x4192f4(0x213)](),_0x2db8a7=await sales_finished[_0x4192f4(0x19b)]({'_id':_0x545052['params']['id']}),_0x4db0a2=await warehouse[_0x4192f4(0x19b)]({'name':_0x2e6740,'room':_0x5063ed,'warehouse_category':_0x4192f4(0x285)});_0x2db8a7['sale_product'][_0x4192f4(0x246)](_0x46db69=>{var _0xa9250c=_0x4192f4;const _0x5bc9bf=_0x4db0a2['product_details'][_0xa9250c(0x29f)](_0x348d48=>{var _0x4995f7=_0xa9250c;_0x348d48[_0x4995f7(0x190)]==_0x46db69[_0x4995f7(0x190)]&&_0x348d48['bay']==_0x46db69[_0x4995f7(0x1f6)]&&(_0x348d48[_0x4995f7(0x283)]=parseInt(_0x348d48[_0x4995f7(0x283)])-parseInt(_0x46db69[_0x4995f7(0x295)]));});}),console[_0x4192f4(0x214)](_0x4192f4(0x1a8),_0x4db0a2),await _0x4db0a2['save']();const _0x9d3591=await c_payment_data[_0x4192f4(0x19b)]({'invoice':_0x545052['body'][_0x4192f4(0x245)]});_0x9d3591[_0x4192f4(0x1ca)]=_0x545052[_0x4192f4(0x26f)][_0x4192f4(0x1ca)],await _0x9d3591[_0x4192f4(0x213)](),_0x545052[_0x4192f4(0x239)](_0x4192f4(0x1d8),_0x4192f4(0x240)),_0x61038e['redirect'](_0x4192f4(0x21f));}catch(_0x5bea12){console[_0x4192f4(0x214)](_0x5bea12);}}),router[a0_0x16193f(0x262)]('/give_payment/:id',auth,async(_0x3a2272,_0x910cc3)=>{var _0x17a65e=a0_0x16193f;try{const _0x56e0dc=_0x3a2272['params']['id'],{invoice:_0x240baa,customer:_0x12013b,receivable_amount:_0x25abe0,received_amount:_0x2b3ede}=_0x3a2272[_0x17a65e(0x26f)],_0x2b3af9=await sales[_0x17a65e(0x294)](_0x56e0dc);console[_0x17a65e(0x214)](_0x2b3af9);var _0x3ba320=_0x25abe0-_0x2b3ede;console['log'](_0x2b3ede),_0x2b3af9[_0x17a65e(0x264)]=parseFloat(_0x2b3ede)+parseFloat(_0x2b3af9[_0x17a65e(0x264)]),_0x2b3af9[_0x17a65e(0x1c4)]=_0x3ba320,console[_0x17a65e(0x214)](_0x2b3af9);const _0x413450=await _0x2b3af9[_0x17a65e(0x213)](),_0x2838da=await c_payment_data[_0x17a65e(0x19b)]({'invoice':_0x240baa});_0x2838da[_0x17a65e(0x1f9)]=_0x3ba320,await _0x2838da['save']();let _0x3677ec=new Date(),_0x18be7f=('0'+_0x3677ec[_0x17a65e(0x1c3)]())[_0x17a65e(0x27b)](-0x2),_0x552e57=('0'+(_0x3677ec[_0x17a65e(0x244)]()+0x1))['slice'](-0x2),_0x2ce929=_0x3677ec['getFullYear'](),_0x328c58=_0x2ce929+'-'+_0x552e57+'-'+_0x18be7f;const _0x47747f=new customer_payment({'invoice':_0x240baa,'date':_0x2ce929+'-'+_0x552e57+'-'+_0x18be7f,'customer':_0x12013b,'reason':_0x17a65e(0x1a3),'amount':_0x2b3ede}),_0x273b69=await _0x47747f[_0x17a65e(0x213)]();_0x3a2272[_0x17a65e(0x239)](_0x17a65e(0x1d8),'payment\x20successfull'),_0x910cc3[_0x17a65e(0x1df)](_0x17a65e(0x290));}catch(_0x1fd54d){console[_0x17a65e(0x214)](_0x1fd54d);}}),router[a0_0x16193f(0x1fb)](a0_0x16193f(0x267),auth,async(_0x5f53d1,_0x23d9f8)=>{var _0x1835f1=a0_0x16193f;try{const {username:_0x7b3da4,email:_0x2db5bc,role:_0x263807}=_0x5f53d1[_0x1835f1(0x24f)],_0x3eecad=_0x5f53d1[_0x1835f1(0x24f)],_0x2671ef=await profile[_0x1835f1(0x19b)]({'email':_0x3eecad['email']}),_0x41c706=await master_shop['find']();console[_0x1835f1(0x214)]('master',_0x41c706);const _0x5ce7a6=_0x5f53d1[_0x1835f1(0x258)]['id'],_0x36140c=await sales['findById'](_0x5ce7a6);console[_0x1835f1(0x214)](_0x36140c);const _0x13b9a1=await customer['findOne']({'name':_0x36140c['customer']});console[_0x1835f1(0x214)](_0x13b9a1);if(_0x41c706[0x0]['language']==_0x1835f1(0x219)){var _0x51a5fb=users['English'];console['log'](_0x51a5fb);}else{if(_0x41c706[0x0]['language']=='Hindi')var _0x51a5fb=users['Hindi'];else{if(_0x41c706[0x0][_0x1835f1(0x1c5)]==_0x1835f1(0x236))var _0x51a5fb=users[_0x1835f1(0x236)];else{if(_0x41c706[0x0][_0x1835f1(0x1c5)]==_0x1835f1(0x29e))var _0x51a5fb=users[_0x1835f1(0x29e)];else{if(_0x41c706[0x0][_0x1835f1(0x1c5)]=='French')var _0x51a5fb=users[_0x1835f1(0x26a)];else{if(_0x41c706[0x0][_0x1835f1(0x1c5)]==_0x1835f1(0x1b1))var _0x51a5fb=users['Portuguese'];else{if(_0x41c706[0x0][_0x1835f1(0x1c5)]==_0x1835f1(0x1ac))var _0x51a5fb=users[_0x1835f1(0x1ac)];else{if(_0x41c706[0x0][_0x1835f1(0x1c5)]==_0x1835f1(0x284))var _0x51a5fb=users[_0x1835f1(0x200)];}}}}}}}_0x23d9f8[_0x1835f1(0x1e4)](_0x1835f1(0x193),{'success':_0x5f53d1[_0x1835f1(0x239)]('success'),'errors':_0x5f53d1[_0x1835f1(0x239)](_0x1835f1(0x196)),'role':_0x3eecad,'profile':_0x2671ef,'master_shop':_0x41c706,'customers':_0x13b9a1,'sales':_0x36140c,'language':_0x51a5fb});}catch(_0x14be5d){console[_0x1835f1(0x214)](_0x14be5d);}}),router[a0_0x16193f(0x1fb)](a0_0x16193f(0x229),auth,async(_0xee4e70,_0x193867)=>{var _0x4ad28e=a0_0x16193f;try{const {username:_0x50b3d1,email:_0x598a27,role:_0x5ed566}=_0xee4e70[_0x4ad28e(0x24f)],_0xe0c926=_0xee4e70[_0x4ad28e(0x24f)],_0x1cebe1=await profile[_0x4ad28e(0x19b)]({'email':_0xe0c926[_0x4ad28e(0x1b3)]}),_0x1c0576=await master_shop[_0x4ad28e(0x248)](),_0x1f2f53=_0xee4e70[_0x4ad28e(0x258)]['id'],_0x425512=await sales_finished[_0x4ad28e(0x294)](_0x1f2f53),_0x49bdf4=await warehouse[_0x4ad28e(0x192)]([{'$match':{'name':_0x425512['warehouse_name']}},{'$unwind':_0x4ad28e(0x27d)},{'$group':{'_id':_0x4ad28e(0x1e3),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4ad28e(0x1a6)},'bay':{'$first':_0x4ad28e(0x1d2)},'bin':{'$first':_0x4ad28e(0x224)},'type':{'$first':_0x4ad28e(0x22d)},'floorlevel':{'$first':_0x4ad28e(0x194)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4ad28e(0x29d)},'product_code':{'$first':_0x4ad28e(0x20a)},'storage':{'$first':_0x4ad28e(0x1ea)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4ad28e(0x1ef)},'production_date':{'$first':_0x4ad28e(0x22c)},'unit':{'$first':_0x4ad28e(0x273)},'secondary_unit':{'$first':_0x4ad28e(0x1fa)},'maxProducts':{'$first':_0x4ad28e(0x1c9)},'batch_code':{'$first':_0x4ad28e(0x286)},'maxPerUnit':{'$first':_0x4ad28e(0x253)}}}]),_0xaa31a7=await product[_0x4ad28e(0x248)]({}),_0x1ff3d1=await warehouse[_0x4ad28e(0x192)]([{'$match':{'status':'Enabled','warehouse_category':_0x4ad28e(0x285),'name':{'$ne':_0x4ad28e(0x266),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x4ad28e(0x1ce),'name':{'$first':_0x4ad28e(0x1ce)}}},{'$sort':{'name':0x1}}]);var _0x17ae8b=[_0x4ad28e(0x270)];const _0x2dec8a=await warehouse[_0x4ad28e(0x192)]([{'$match':{'status':_0x4ad28e(0x1a7),'name':_0x4ad28e(0x1a4)}},{'$group':{'_id':'$name','name':{'$first':_0x4ad28e(0x1ce)}}},{'$sort':{'name':0x1}}]);if(_0x1c0576[0x0]['language']==_0x4ad28e(0x219)){var _0x345f30=users[_0x4ad28e(0x1d0)];console[_0x4ad28e(0x214)](_0x345f30);}else{if(_0x1c0576[0x0][_0x4ad28e(0x1c5)]==_0x4ad28e(0x231))var _0x345f30=users[_0x4ad28e(0x231)];else{if(_0x1c0576[0x0][_0x4ad28e(0x1c5)]==_0x4ad28e(0x236))var _0x345f30=users['German'];else{if(_0x1c0576[0x0][_0x4ad28e(0x1c5)]=='Spanish')var _0x345f30=users[_0x4ad28e(0x29e)];else{if(_0x1c0576[0x0]['language']=='French')var _0x345f30=users['French'];else{if(_0x1c0576[0x0][_0x4ad28e(0x1c5)]=='Portuguese\x20(BR)')var _0x345f30=users[_0x4ad28e(0x256)];else{if(_0x1c0576[0x0]['language']==_0x4ad28e(0x1ac))var _0x345f30=users[_0x4ad28e(0x1ac)];else{if(_0x1c0576[0x0][_0x4ad28e(0x1c5)]==_0x4ad28e(0x284))var _0x345f30=users[_0x4ad28e(0x200)];}}}}}}}_0x193867['render']('return_sale_finished',{'success':_0xee4e70[_0x4ad28e(0x239)](_0x4ad28e(0x1d8)),'errors':_0xee4e70[_0x4ad28e(0x239)](_0x4ad28e(0x196)),'role':_0xe0c926,'profile':_0x1cebe1,'user':_0x425512,'stock':_0x49bdf4,'master_shop':_0x1c0576,'unit':_0xaa31a7,'language':_0x345f30,'warehouses':_0x1ff3d1,'rooms':_0x17ae8b,'warehouse_QA':_0x2dec8a});}catch(_0x4f0340){console[_0x4ad28e(0x214)](_0x4f0340),_0x193867[_0x4ad28e(0x1e0)](0xc8)['json']({'message':_0x4f0340['message']});}}),router[a0_0x16193f(0x262)]('/view/return_sales/:id',auth,async(_0x53a713,_0xee309d)=>{var _0x2b5974=a0_0x16193f;if(_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x218)]=='QA')try{const {invoice:_0x444536,date:_0x3deba2,warehouse_name:_0x1145ab,product_name:_0x28f9da,primary_code:_0x433505,secondary_code:_0x9ae0ea,product_code:_0x2fccbf,sales_quantity:_0x58b9ac,stocks:_0x64542,return_qty:_0x3cd161,Room_name:_0x2a9bae,to_warehouse_name_QA:_0x49cce8,to_Room_name_QA:_0x276643,note:_0x176ed8,for_categorize:_0x2c6535,product_name_QA1:_0x2fe150}=_0x53a713[_0x2b5974(0x26f)];if(typeof _0x2fe150=='string')var _0x534f42=[_0x53a713['body']['product_name_QA1']],_0x1cc9a8=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x250)]],_0x250336=[_0x53a713[_0x2b5974(0x26f)]['secondary_code_QA']],_0x5618d8=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x20f)]],_0x5e504f=[_0x53a713[_0x2b5974(0x26f)]['sales_quantity_QA']],_0x8442f5=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x237)]],_0x5b48cf=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1a2)]],_0xf067c8=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x230)]],_0x47b982=[_0x53a713[_0x2b5974(0x26f)]['maxProducts_QA']],_0x19e5be=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1a9)]],_0x1483d4=[_0x53a713[_0x2b5974(0x26f)]['secondary_unit_QA']],_0x36aba6=[_0x53a713[_0x2b5974(0x26f)]['unit_QA']],_0x32ffc6=[_0x53a713[_0x2b5974(0x26f)]['production_date_QA']],_0x2c68b1=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x20b)]];else var _0x534f42=[..._0x53a713['body']['product_name_QA1']],_0x1cc9a8=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x250)]],_0x250336=[..._0x53a713[_0x2b5974(0x26f)]['secondary_code_QA']],_0x5618d8=[..._0x53a713['body'][_0x2b5974(0x20f)]],_0x5e504f=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1ff)]],_0x8442f5=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x237)]],_0x5b48cf=[..._0x53a713['body'][_0x2b5974(0x1a2)]],_0xf067c8=[..._0x53a713[_0x2b5974(0x26f)]['maxPerUnit_QA']],_0x47b982=[..._0x53a713['body'][_0x2b5974(0x1c0)]],_0x19e5be=[..._0x53a713[_0x2b5974(0x26f)]['batch_code_QA']],_0x1483d4=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x24c)]],_0x36aba6=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1e6)]],_0x32ffc6=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1e9)]],_0x2c68b1=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x20b)]];const _0x7cb195=_0x534f42[_0x2b5974(0x29f)](_0x56b560=>{return _0x56b560={'product_name':_0x56b560};});_0x1cc9a8['forEach']((_0x16524c,_0x56032b)=>{var _0x4ee952=_0x2b5974;_0x7cb195[_0x56032b][_0x4ee952(0x211)]=_0x16524c;}),_0x250336[_0x2b5974(0x246)]((_0x24a6a5,_0x1d514c)=>{var _0x44bbad=_0x2b5974;_0x7cb195[_0x1d514c][_0x44bbad(0x232)]=_0x24a6a5;}),_0x5618d8[_0x2b5974(0x246)]((_0x355668,_0x204d91)=>{var _0x4dddda=_0x2b5974;_0x7cb195[_0x204d91][_0x4dddda(0x1ee)]=_0x355668;}),_0x5e504f[_0x2b5974(0x246)]((_0x365ed1,_0x1ef5a1)=>{var _0x37f8f9=_0x2b5974;_0x7cb195[_0x1ef5a1][_0x37f8f9(0x1a5)]=_0x365ed1;}),_0x8442f5[_0x2b5974(0x246)]((_0x1895b8,_0x3902cf)=>{var _0x2011cd=_0x2b5974;_0x7cb195[_0x3902cf][_0x2011cd(0x269)]=_0x1895b8;}),_0x5b48cf[_0x2b5974(0x246)]((_0x4a1530,_0x5a7493)=>{var _0x2712ad=_0x2b5974;_0x7cb195[_0x5a7493][_0x2712ad(0x1c2)]=_0x4a1530;}),_0xf067c8[_0x2b5974(0x246)]((_0x23de89,_0xa1ea84)=>{var _0x31e6ae=_0x2b5974;_0x7cb195[_0xa1ea84][_0x31e6ae(0x206)]=_0x23de89;}),_0x47b982['forEach']((_0x5d111e,_0x2dfdf1)=>{_0x7cb195[_0x2dfdf1]['maxProducts']=_0x5d111e;}),_0x19e5be[_0x2b5974(0x246)]((_0x38b2b3,_0xb2287a)=>{var _0x398455=_0x2b5974;_0x7cb195[_0xb2287a][_0x398455(0x223)]=_0x38b2b3;}),_0x1483d4['forEach']((_0x4b4230,_0x5831c9)=>{_0x7cb195[_0x5831c9]['secondary_unit']=_0x4b4230;}),_0x36aba6['forEach']((_0x4b24b8,_0x24734a)=>{var _0x13241c=_0x2b5974;_0x7cb195[_0x24734a][_0x13241c(0x1b5)]=_0x4b24b8;}),_0x32ffc6[_0x2b5974(0x246)]((_0x4d4edb,_0x2d174c)=>{var _0x311188=_0x2b5974;_0x7cb195[_0x2d174c][_0x311188(0x226)]=_0x4d4edb;}),_0x2c68b1[_0x2b5974(0x246)]((_0x1d71e7,_0x1d6ccc)=>{var _0x22a875=_0x2b5974;_0x7cb195[_0x1d6ccc][_0x22a875(0x24e)]=_0x1d71e7;});const _0x5046b3=await sales_finished[_0x2b5974(0x19b)]({'invoice':_0x444536});_0x5046b3[_0x2b5974(0x186)]=_0x2b5974(0x1eb);const _0x36da0d=await _0x5046b3[_0x2b5974(0x213)](),_0x42d12b=new sales_return_finished({'invoice':_0x444536,'customer':_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x271)],'date':_0x3deba2,'warehouse_name':_0x1145ab,'room':_0x2a9bae,'ToWarehouse':_0x49cce8,'ToRoom':_0x276643,'return_sale_QA':_0x7cb195,'note':_0x176ed8,'warehouse_cat':_0x2c6535}),_0x3eef9e=await _0x42d12b[_0x2b5974(0x213)](),_0x338b08=await sales_return_finished['findOne']({'invoice':_0x444536}),_0x32a039=await warehouse[_0x2b5974(0x19b)]({'name':_0x49cce8,'room':_0x276643});_0x338b08['return_sale_QA'][_0x2b5974(0x246)](_0x368338=>{var _0x59a89c=_0x2b5974,_0x253beb=0x0;const _0x1b2a9e=_0x32a039[_0x59a89c(0x23e)][_0x59a89c(0x29f)](_0x45d8bc=>{var _0x2e26ce=_0x59a89c;_0x45d8bc[_0x2e26ce(0x190)]==_0x368338['product_name']&&_0x45d8bc[_0x2e26ce(0x24e)]==_0x368338[_0x2e26ce(0x24e)]&&_0x45d8bc[_0x2e26ce(0x226)]==_0x368338[_0x2e26ce(0x226)]&&_0x45d8bc['batch_code']==_0x368338['batch_code']&&(_0x45d8bc[_0x2e26ce(0x283)]=parseInt(_0x45d8bc[_0x2e26ce(0x283)])+parseInt(_0x368338[_0x2e26ce(0x1c2)]),_0x253beb++);});_0x253beb=='0'&&(_0x32a039[_0x59a89c(0x23e)]=_0x32a039[_0x59a89c(0x23e)][_0x59a89c(0x1cf)]({'product_name':_0x368338[_0x59a89c(0x190)],'product_stock':_0x368338[_0x59a89c(0x1c2)],'primary_code':_0x368338['primary_code'],'secondary_code':_0x368338[_0x59a89c(0x232)],'product_code':_0x368338[_0x59a89c(0x1ee)],'batch_code':_0x368338['batch_code'],'maxPerUnit':_0x368338[_0x59a89c(0x206)],'production_date':_0x368338[_0x59a89c(0x226)],'expiry_date':_0x368338[_0x59a89c(0x24e)],'secondary_unit':_0x368338['secondary_unit'],'unit':_0x368338[_0x59a89c(0x1b5)],'maxProducts':_0x368338[_0x59a89c(0x1e1)],'bay':_0x368338[_0x59a89c(0x1f6)]}));}),await _0x32a039['save']();const _0x2da33f=new c_payment_data({'invoice':_0x444536,'customer':_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x271)],'reason':_0x2b5974(0x249)});await _0x2da33f[_0x2b5974(0x213)]();const _0x632345=await master_shop[_0x2b5974(0x248)](),_0x5d45ff=await email_settings[_0x2b5974(0x19b)](),_0x1994b1=await customer[_0x2b5974(0x19b)]({'name':_0x53a713[_0x2b5974(0x26f)]['customer']});_0x632345[0x0]['currency_placement']==0x1?(right_currency=_0x632345[0x0][_0x2b5974(0x227)],left_currency=''):(right_currency='',left_currency=_0x632345[0x0][_0x2b5974(0x227)]);var _0xb7b8ac=_0x534f42,_0x2fced1=_0x5b48cf,_0x586fa8='',_0x4d6a4f;for(_0x4d6a4f in _0xb7b8ac){_0x586fa8+=_0x2b5974(0x1de)+_0x2b5974(0x26e)+_0xb7b8ac[_0x4d6a4f]+_0x2b5974(0x1b9)+_0x2b5974(0x26e)+_0x2fced1[_0x4d6a4f]+_0x2b5974(0x1b9)+_0x2b5974(0x291);}console[_0x2b5974(0x214)](_0x2b5974(0x23c),_0x586fa8);let _0x1216f2=nodemailer[_0x2b5974(0x20e)]({'service':_0x2b5974(0x1e5),'auth':{'user':_0x5d45ff[_0x2b5974(0x1b3)],'pass':_0x5d45ff[_0x2b5974(0x1d4)]}}),_0x356d0b={'from':_0x5d45ff[_0x2b5974(0x1b3)],'to':_0x1994b1[_0x2b5974(0x1b3)],'subject':_0x2b5974(0x18c),'attachments':[{'filename':_0x2b5974(0x24b),'path':__dirname+'/../public'+_0x2b5974(0x278)+_0x632345[0x0][_0x2b5974(0x1f2)],'cid':_0x2b5974(0x1f3)}],'html':_0x2b5974(0x1fd)+_0x2b5974(0x19a)+_0x2b5974(0x1dc)+_0x2b5974(0x23d)+_0x2b5974(0x277)+_0x2b5974(0x23d)+_0x2b5974(0x22f)+'</div>'+_0x2b5974(0x23d)+'<h2>\x20'+_0x632345[0x0][_0x2b5974(0x27e)]+_0x2b5974(0x28e)+_0x2b5974(0x265)+_0x2b5974(0x265)+_0x2b5974(0x1a0)+_0x2b5974(0x23d)+_0x2b5974(0x199)+'\x20Order\x20Number\x20:\x20'+_0x444536+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2b5974(0x216)+_0x3deba2+'\x20'+_0x2b5974(0x1a1)+_0x2b5974(0x222)+_0x2b5974(0x265)+_0x2b5974(0x19c)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2b5974(0x1de)+_0x2b5974(0x1af)+_0x2b5974(0x280)+_0x2b5974(0x1db)+_0x2b5974(0x1d3)+'</tr>'+_0x2b5974(0x1ec)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x586fa8+'\x20'+_0x2b5974(0x1dd)+'</table>'+_0x2b5974(0x23d)+_0x2b5974(0x215)+_0x2b5974(0x1c1)+_0x632345[0x0]['site_title']+'</h5>'+'</div>'+_0x2b5974(0x265)+_0x2b5974(0x1ab)};_0x1216f2[_0x2b5974(0x29b)](_0x356d0b,function(_0x4d5720,_0x2b51fa){var _0x52561e=_0x2b5974;_0x4d5720?(console[_0x52561e(0x214)](_0x4d5720),console[_0x52561e(0x214)](_0x52561e(0x29a))):console['log'](_0x52561e(0x299));}),_0x53a713[_0x2b5974(0x239)](_0x2b5974(0x1d8),_0x2b5974(0x293)),_0xee309d['redirect'](_0x2b5974(0x21f));}catch(_0x1f541c){_0xee309d[_0x2b5974(0x1e0)](0xc8)[_0x2b5974(0x1bf)]({'message1':_0x1f541c[_0x2b5974(0x259)]});}else{if(_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x218)]=='GS')try{const {invoice:_0x530a65,date:_0x371ae4,warehouse_name:_0x8acc5a,product_name:_0x335385,primary_code:_0x5d26cc,secondary_code:_0x2fb4be,product_code:_0x4b185a,sales_quantity:_0x53ddc9,stocks:_0x421ffd,return_qty:_0x238267,Room_name:_0x55d6d8,to_warehouse_name:_0x3a759d,to_Room_name:_0x30f14c,note:_0x5e28d5,level:_0x1d562f,isle:_0x5a1b47,pallet:_0x432a23,for_categorize:_0x18e05b}=_0x53a713[_0x2b5974(0x26f)];if(typeof _0x335385==_0x2b5974(0x289))var _0x534f42=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x190)]],_0x1cc9a8=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x211)]],_0x250336=[_0x53a713[_0x2b5974(0x26f)]['secondary_code']],_0x5618d8=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1ee)]],_0x5e504f=[_0x53a713['body'][_0x2b5974(0x195)]],_0x5b48cf=[_0x53a713['body'][_0x2b5974(0x1c2)]],_0x5ad783=[_0x53a713[_0x2b5974(0x26f)]['bay']],_0xf067c8=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x206)]],_0x47b982=[_0x53a713['body'][_0x2b5974(0x1e1)]],_0x19e5be=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x223)]],_0x1483d4=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1cb)]],_0x36aba6=[_0x53a713['body'][_0x2b5974(0x1b5)]],_0x32ffc6=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x226)]],_0x2c68b1=[_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x24e)]];else var _0x534f42=[..._0x53a713['body'][_0x2b5974(0x190)]],_0x1cc9a8=[..._0x53a713['body'][_0x2b5974(0x211)]],_0x250336=[..._0x53a713['body'][_0x2b5974(0x232)]],_0x5618d8=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1ee)]],_0x5e504f=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x195)]],_0x5b48cf=[..._0x53a713['body'][_0x2b5974(0x1c2)]],_0x5ad783=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1f6)]],_0xf067c8=[..._0x53a713['body'][_0x2b5974(0x206)]],_0x47b982=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1e1)]],_0x19e5be=[..._0x53a713['body']['batch_code']],_0x1483d4=[..._0x53a713['body'][_0x2b5974(0x1cb)]],_0x36aba6=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x1b5)]],_0x32ffc6=[..._0x53a713['body'][_0x2b5974(0x226)]],_0x2c68b1=[..._0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x24e)]];const _0x332a9c=_0x534f42[_0x2b5974(0x29f)](_0x2fa408=>{return _0x2fa408={'product_name':_0x2fa408};});_0x1cc9a8['forEach']((_0x4e3d05,_0x5c5588)=>{var _0x44e481=_0x2b5974;_0x332a9c[_0x5c5588][_0x44e481(0x211)]=_0x4e3d05;}),_0x250336[_0x2b5974(0x246)]((_0xeb398a,_0x1e7d07)=>{var _0x4ad2fc=_0x2b5974;_0x332a9c[_0x1e7d07][_0x4ad2fc(0x232)]=_0xeb398a;}),_0x5618d8['forEach']((_0x2cc9a0,_0x5133dd)=>{_0x332a9c[_0x5133dd]['product_code']=_0x2cc9a0;}),_0x5e504f[_0x2b5974(0x246)]((_0x33f856,_0x383028)=>{var _0x26c0f5=_0x2b5974;_0x332a9c[_0x383028][_0x26c0f5(0x1a5)]=_0x33f856;}),_0x5b48cf['forEach']((_0x13f5e8,_0x14589e)=>{var _0x2c82be=_0x2b5974;_0x332a9c[_0x14589e][_0x2c82be(0x1c2)]=_0x13f5e8;}),_0x5ad783[_0x2b5974(0x246)]((_0x5cf758,_0x4c173d)=>{var _0x1fe3bb=_0x2b5974;_0x332a9c[_0x4c173d][_0x1fe3bb(0x1f6)]=_0x5cf758;}),_0xf067c8[_0x2b5974(0x246)]((_0x27118e,_0x2fad5a)=>{var _0x57d0c2=_0x2b5974;_0x332a9c[_0x2fad5a][_0x57d0c2(0x206)]=_0x27118e;}),_0x47b982['forEach']((_0x211703,_0x1dc7a9)=>{var _0x4afb0c=_0x2b5974;_0x332a9c[_0x1dc7a9][_0x4afb0c(0x1e1)]=_0x211703;}),_0x19e5be[_0x2b5974(0x246)]((_0x4df8d2,_0x49164c)=>{var _0x45c302=_0x2b5974;_0x332a9c[_0x49164c][_0x45c302(0x223)]=_0x4df8d2;}),_0x1483d4[_0x2b5974(0x246)]((_0x45f038,_0x586f8e)=>{_0x332a9c[_0x586f8e]['secondary_unit']=_0x45f038;}),_0x36aba6['forEach']((_0x3732b8,_0x3da9af)=>{_0x332a9c[_0x3da9af]['unit']=_0x3732b8;}),_0x32ffc6['forEach']((_0x28bc53,_0x39e3ef)=>{var _0x164ea4=_0x2b5974;_0x332a9c[_0x39e3ef][_0x164ea4(0x226)]=_0x28bc53;}),_0x2c68b1[_0x2b5974(0x246)]((_0x193177,_0x566c11)=>{var _0x4d532a=_0x2b5974;_0x332a9c[_0x566c11][_0x4d532a(0x24e)]=_0x193177;});var _0x17945f=0x0;_0x332a9c[_0x2b5974(0x246)](_0x6de941=>{var _0x23b99e=_0x2b5974;(parseInt(_0x6de941[_0x23b99e(0x1a5)])<parseInt(_0x6de941['return_qty'])||parseInt(_0x6de941[_0x23b99e(0x269)])<parseInt(_0x6de941[_0x23b99e(0x1c2)])&&parseInt(_0x6de941[_0x23b99e(0x1a5)])>parseInt(_0x6de941[_0x23b99e(0x1c2)])||parseInt(_0x6de941[_0x23b99e(0x1c2)])==0x0)&&_0x17945f++;});if(_0x17945f!=0x0)return _0x53a713['flash']('errors',_0x2b5974(0x275)),_0xee309d['redirect'](_0x2b5974(0x257));const _0x15c3cf=await sales_finished[_0x2b5974(0x19b)]({'invoice':_0x530a65});_0x15c3cf[_0x2b5974(0x186)]=_0x2b5974(0x1eb);const _0x6a02c9=await _0x15c3cf[_0x2b5974(0x213)](),_0x3f57c6=new sales_return_finished({'invoice':_0x530a65,'customer':_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x271)],'date':_0x371ae4,'warehouse_name':_0x8acc5a,'room':_0x55d6d8,'ToWarehouse':_0x3a759d,'ToRoom':_0x30f14c,'return_sale':_0x332a9c,'note':_0x5e28d5,'warehouse_cat':_0x18e05b}),_0x51bd4e=await _0x3f57c6[_0x2b5974(0x213)](),_0xcc2ac=await sales_return_finished[_0x2b5974(0x19b)]({'invoice':_0x530a65}),_0x2360e6=await warehouse[_0x2b5974(0x19b)]({'name':_0x3a759d,'room':_0x30f14c,'warehouse_category':_0x2b5974(0x285)});_0xcc2ac[_0x2b5974(0x296)]['forEach'](_0x4726f8=>{var _0x1dc414=_0x2b5974,_0xa39a30=0x0;const _0x497225=_0x2360e6[_0x1dc414(0x23e)]['map'](_0x19d94b=>{var _0x116527=_0x1dc414;_0x19d94b[_0x116527(0x190)]==_0x4726f8[_0x116527(0x190)]&&_0x19d94b[_0x116527(0x1f6)]==_0x4726f8[_0x116527(0x1f6)]&&_0x19d94b['expiry_date']==_0x4726f8['expiry_date']&&_0x19d94b[_0x116527(0x226)]==_0x4726f8[_0x116527(0x226)]&&_0x19d94b[_0x116527(0x223)]==_0x4726f8[_0x116527(0x223)]&&(_0x19d94b[_0x116527(0x283)]=parseInt(_0x19d94b['product_stock'])+parseInt(_0x4726f8['return_qty']),_0xa39a30++);});_0xa39a30=='0'&&(_0x2360e6['product_details']=_0x2360e6[_0x1dc414(0x23e)][_0x1dc414(0x1cf)]({'product_name':_0x4726f8['product_name'],'product_stock':_0x4726f8[_0x1dc414(0x1c2)],'primary_code':_0x4726f8['primary_code'],'secondary_code':_0x4726f8[_0x1dc414(0x232)],'product_code':_0x4726f8[_0x1dc414(0x1ee)],'bay':_0x4726f8[_0x1dc414(0x1f6)],'batch_code':_0x4726f8['batch_code'],'maxPerUnit':_0x4726f8[_0x1dc414(0x206)],'production_date':_0x4726f8[_0x1dc414(0x226)],'expiry_date':_0x4726f8[_0x1dc414(0x24e)],'secondary_unit':_0x4726f8[_0x1dc414(0x1cb)],'unit':_0x4726f8[_0x1dc414(0x1b5)],'maxProducts':_0x4726f8['maxProducts']}));}),await _0x2360e6[_0x2b5974(0x213)](),console[_0x2b5974(0x214)](_0x53a713[_0x2b5974(0x26f)]);const _0x2618ee=new c_payment_data({'invoice':_0x530a65,'customer':_0x53a713[_0x2b5974(0x26f)]['customer'],'reason':_0x2b5974(0x249)});await _0x2618ee[_0x2b5974(0x213)]();const _0x3033fd=await master_shop[_0x2b5974(0x248)]();console[_0x2b5974(0x214)](_0x2b5974(0x28c),_0x3033fd[0x0][_0x2b5974(0x1f2)]);const _0xf64bdc=await email_settings[_0x2b5974(0x19b)](),_0xd4fe4e=await customer[_0x2b5974(0x19b)]({'name':_0x53a713[_0x2b5974(0x26f)][_0x2b5974(0x271)]});console[_0x2b5974(0x214)](_0x2b5974(0x19f),_0xd4fe4e);_0x3033fd[0x0][_0x2b5974(0x1b6)]==0x1?(right_currency=_0x3033fd[0x0][_0x2b5974(0x227)],left_currency=''):(right_currency='',left_currency=_0x3033fd[0x0][_0x2b5974(0x227)]);var _0xb7b8ac=_0x534f42,_0x2fced1=_0x5b48cf,_0x586fa8='',_0x4d6a4f;for(_0x4d6a4f in _0xb7b8ac){_0x586fa8+=_0x2b5974(0x1de)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xb7b8ac[_0x4d6a4f]+_0x2b5974(0x1b9)+_0x2b5974(0x26e)+_0x2fced1[_0x4d6a4f]+_0x2b5974(0x1b9)+_0x2b5974(0x291);}console['log'](_0x2b5974(0x23c),_0x586fa8);let _0xf22938=nodemailer[_0x2b5974(0x20e)]({'service':'gmail','auth':{'user':_0xf64bdc['email'],'pass':_0xf64bdc[_0x2b5974(0x1d4)]}}),_0x2c0158={'from':_0xf64bdc[_0x2b5974(0x1b3)],'to':_0xd4fe4e['email'],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x2b5974(0x24b),'path':__dirname+_0x2b5974(0x1f4)+_0x2b5974(0x278)+_0x3033fd[0x0][_0x2b5974(0x1f2)],'cid':'logo'}],'html':_0x2b5974(0x1fd)+_0x2b5974(0x19a)+_0x2b5974(0x1dc)+'<div>'+_0x2b5974(0x277)+_0x2b5974(0x23d)+_0x2b5974(0x22f)+_0x2b5974(0x265)+_0x2b5974(0x23d)+_0x2b5974(0x298)+_0x3033fd[0x0]['site_title']+'\x20</h2>'+_0x2b5974(0x265)+_0x2b5974(0x265)+_0x2b5974(0x1a0)+_0x2b5974(0x23d)+_0x2b5974(0x199)+_0x2b5974(0x1e8)+_0x530a65+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2b5974(0x216)+_0x371ae4+'\x20'+_0x2b5974(0x1a1)+_0x2b5974(0x222)+'</div>'+_0x2b5974(0x19c)+_0x2b5974(0x1ad)+_0x2b5974(0x1de)+_0x2b5974(0x1af)+_0x2b5974(0x280)+_0x2b5974(0x1db)+_0x2b5974(0x1d3)+'</tr>'+_0x2b5974(0x1ec)+_0x2b5974(0x234)+'\x20'+_0x586fa8+'\x20'+_0x2b5974(0x1dd)+_0x2b5974(0x19d)+'<div>'+_0x2b5974(0x215)+'<h5>'+_0x3033fd[0x0][_0x2b5974(0x27e)]+'</h5>'+_0x2b5974(0x265)+'</div>'+_0x2b5974(0x1ab)};_0xf22938[_0x2b5974(0x29b)](_0x2c0158,function(_0x50b31b,_0x4b03f2){var _0xea2a3c=_0x2b5974;_0x50b31b?(console[_0xea2a3c(0x214)](_0x50b31b),console[_0xea2a3c(0x214)](_0xea2a3c(0x29a))):console[_0xea2a3c(0x214)](_0xea2a3c(0x299));}),_0x53a713[_0x2b5974(0x239)](_0x2b5974(0x1d8),'sales\x20item\x20return\x20successfull'),_0xee309d[_0x2b5974(0x1df)](_0x2b5974(0x21f));}catch(_0xd1cea8){console[_0x2b5974(0x214)](_0xd1cea8),_0xee309d[_0x2b5974(0x1e0)](0xc8)['json']({'message1':_0xd1cea8[_0x2b5974(0x259)]});}}}),router['get'](a0_0x16193f(0x205),auth,async(_0x469231,_0x471750)=>{var _0x46a7cd=a0_0x16193f;try{const {username:_0x10d84c,email:_0x46d078,role:_0x5a86c5}=_0x469231[_0x46a7cd(0x24f)],_0x1a7ed8=_0x469231[_0x46a7cd(0x24f)],_0x1fc2b3=await profile['findOne']({'email':_0x1a7ed8[_0x46a7cd(0x1b3)]}),_0x344468=await master_shop['find']();console[_0x46a7cd(0x214)](_0x46a7cd(0x18f),_0x344468);const _0x2c44f6=_0x469231[_0x46a7cd(0x258)]['id'],_0x541a32=await sales[_0x46a7cd(0x294)](_0x2c44f6);console[_0x46a7cd(0x214)]('barcode\x20user_id',_0x541a32);if(_0x344468[0x0][_0x46a7cd(0x1c5)]==_0x46a7cd(0x219))var _0x46cac5=users[_0x46a7cd(0x1d0)];else{if(_0x344468[0x0][_0x46a7cd(0x1c5)]=='Hindi')var _0x46cac5=users['Hindi'];else{if(_0x344468[0x0][_0x46a7cd(0x1c5)]=='German')var _0x46cac5=users['German'];else{if(_0x344468[0x0][_0x46a7cd(0x1c5)]==_0x46a7cd(0x29e))var _0x46cac5=users[_0x46a7cd(0x29e)];else{if(_0x344468[0x0]['language']==_0x46a7cd(0x26a))var _0x46cac5=users[_0x46a7cd(0x26a)];else{if(_0x344468[0x0][_0x46a7cd(0x1c5)]==_0x46a7cd(0x1b1))var _0x46cac5=users[_0x46a7cd(0x256)];else{if(_0x344468[0x0][_0x46a7cd(0x1c5)]==_0x46a7cd(0x1ac))var _0x46cac5=users[_0x46a7cd(0x1ac)];else{if(_0x344468[0x0][_0x46a7cd(0x1c5)]=='Arabic\x20(ae)')var _0x46cac5=users['Arabic'];}}}}}}}_0x471750[_0x46a7cd(0x1e4)](_0x46a7cd(0x25b),{'success':_0x469231[_0x46a7cd(0x239)]('success'),'errors':_0x469231['flash'](_0x46a7cd(0x196)),'role':_0x1a7ed8,'profile':_0x1fc2b3,'alldata':_0x541a32,'master_shop':_0x344468,'language':_0x46cac5});}catch(_0x170159){console[_0x46a7cd(0x214)](_0x170159);}}),router[a0_0x16193f(0x262)]('/barcode_scanner',async(_0x4a2589,_0x3dda04)=>{var _0x70c35=a0_0x16193f;const {product_code:_0x5371d1,warehouse_name:_0x5ecf91,rooms_data:_0x4e2c5d,Roomslist:_0x47b260}=_0x4a2589[_0x70c35(0x26f)],_0x5e1272=_0x47b260[_0x70c35(0x255)](','),_0xf28487=[];async function _0xc27c32(_0x4e1820){var _0x59153a=_0x70c35;const _0x3302a7=await warehouse['aggregate']([{'$match':{'name':_0x5ecf91,'room':_0x4e1820}},{'$unwind':_0x59153a(0x27d)},{'$match':{'product_details.primary_code':_0x5371d1}},{'$group':{'_id':_0x59153a(0x1e3),'name':{'$first':_0x59153a(0x1bd)},'product_stock':{'$first':_0x59153a(0x1a6)},'primary_code':{'$first':_0x59153a(0x225)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x59153a(0x20a)},'level':{'$first':_0x59153a(0x1d2)},'isle':{'$first':_0x59153a(0x224)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x59153a(0x194)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x59153a(0x1fa)},'storage':{'$first':_0x59153a(0x1ea)},'rack':{'$first':_0x59153a(0x25f)},'expiry_date':{'$first':_0x59153a(0x1ef)},'production_date':{'$first':_0x59153a(0x22c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x59153a(0x286)},'product_cat':{'$first':_0x59153a(0x1b0)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x59153a(0x1ba)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x538632=await warehouse['aggregate']([{'$match':{'name':_0x5ecf91,'room':_0x4e1820}},{'$unwind':_0x59153a(0x27d)},{'$match':{'product_details.secondary_code':_0x5371d1}},{'$group':{'_id':_0x59153a(0x1e3),'name':{'$first':_0x59153a(0x1bd)},'product_stock':{'$first':_0x59153a(0x1a6)},'primary_code':{'$first':_0x59153a(0x225)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x59153a(0x1d2)},'isle':{'$first':_0x59153a(0x224)},'type':{'$first':_0x59153a(0x22d)},'pallet':{'$first':_0x59153a(0x194)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x59153a(0x1fa)},'storage':{'$first':_0x59153a(0x1ea)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x59153a(0x1ef)},'production_date':{'$first':_0x59153a(0x22c)},'maxPerUnit':{'$first':_0x59153a(0x253)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x59153a(0x1b0)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x59153a(0x1ba)},'invoice':{'$first':_0x59153a(0x21a)}}}]);if(_0x3302a7['length']>0x0)_0xf28487[_0x59153a(0x20d)](_0x3302a7);else _0x538632['length']>0x0&&_0xf28487[_0x59153a(0x20d)](_0x538632);}const _0x49a378=_0x5e1272[_0x70c35(0x29f)](_0xc48172=>_0xc27c32(_0xc48172));await Promise['all'](_0x49a378),_0x3dda04['json'](_0xf28487);}),module[a0_0x16193f(0x272)]=router;