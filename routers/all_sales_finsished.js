var a0_0x4e9c7a=a0_0x2958;(function(_0x500a36,_0xbd4651){var _0xca09e=a0_0x2958,_0x3703fd=_0x500a36();while(!![]){try{var _0x7f1803=parseInt(_0xca09e(0x1b0))/0x1*(-parseInt(_0xca09e(0x220))/0x2)+parseInt(_0xca09e(0x1e2))/0x3+-parseInt(_0xca09e(0x1d0))/0x4*(parseInt(_0xca09e(0x26c))/0x5)+-parseInt(_0xca09e(0x1fb))/0x6+parseInt(_0xca09e(0x20c))/0x7*(parseInt(_0xca09e(0x249))/0x8)+-parseInt(_0xca09e(0x239))/0x9+parseInt(_0xca09e(0x1a8))/0xa;if(_0x7f1803===_0xbd4651)break;else _0x3703fd['push'](_0x3703fd['shift']());}catch(_0x366d38){_0x3703fd['push'](_0x3703fd['shift']());}}}(a0_0x3786,0x286f4));function a0_0x2958(_0x3c5934,_0x184cd0){var _0x378650=a0_0x3786();return a0_0x2958=function(_0x295806,_0x38f68e){_0x295806=_0x295806-0x18d;var _0x239e4b=_0x378650[_0x295806];return _0x239e4b;},a0_0x2958(_0x3c5934,_0x184cd0);}const express=require(a0_0x4e9c7a(0x1ed)),app=express(),router=express[a0_0x4e9c7a(0x203)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x4e9c7a(0x1a5)),auth=require(a0_0x4e9c7a(0x284)),nodemailer=require('nodemailer'),users=require(a0_0x4e9c7a(0x1b3));router[a0_0x4e9c7a(0x1bc)]('/view',auth,async(_0x38660c,_0x25c1e8)=>{var _0x416c8e=a0_0x4e9c7a;try{const {username:_0x3e57b7,email:_0x4c06f5,role:_0xaadd50}=_0x38660c[_0x416c8e(0x299)],_0x50b454=_0x38660c[_0x416c8e(0x299)],_0x4a44e1=await profile[_0x416c8e(0x23b)]({'email':_0x50b454['email']}),_0x4e6ab6=await master_shop[_0x416c8e(0x232)]();let _0x5dbd8e;if(_0x50b454['role']==_0x416c8e(0x1cb)){const _0x35160f=await staff['findOne']({'email':_0x50b454[_0x416c8e(0x20e)]});_0x5dbd8e=await sales_finished[_0x416c8e(0x264)]([{'$lookup':{'from':_0x416c8e(0x25b),'localField':'customer','foreignField':_0x416c8e(0x269),'as':'customers_docs'}},{'$unwind':_0x416c8e(0x231)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x416c8e(0x211),'invoice':{'$first':_0x416c8e(0x2a2)},'customers':{'$first':_0x416c8e(0x28d)},'date':{'$first':_0x416c8e(0x25f)},'warehouse_name':{'$first':_0x416c8e(0x1ac)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x416c8e(0x1ee)},'return_data':{'$first':_0x416c8e(0x27a)},'customers_docs':{'$first':_0x416c8e(0x231)},'total_saleproduct_quantity':{'$sum':_0x416c8e(0x1fc)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x416c8e(0x20d)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5dbd8e=await sales_finished[_0x416c8e(0x264)]([{'$lookup':{'from':_0x416c8e(0x25b),'localField':_0x416c8e(0x1d4),'foreignField':'name','as':'customers_docs'}},{'$unwind':_0x416c8e(0x231)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x416c8e(0x211),'invoice':{'$first':_0x416c8e(0x2a2)},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x416c8e(0x1ac)},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':_0x416c8e(0x27a)},'customers_docs':{'$first':_0x416c8e(0x231)},'total_saleproduct_quantity':{'$sum':_0x416c8e(0x1fc)},'level':{'$addToSet':_0x416c8e(0x296)},'isle':{'$addToSet':_0x416c8e(0x20d)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x416c8e(0x19e)},'finalize':{'$first':_0x416c8e(0x1ab)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x4e6ab6[0x0][_0x416c8e(0x1d5)]==_0x416c8e(0x1e1)){var _0x31e7bf=users[_0x416c8e(0x291)];console[_0x416c8e(0x217)](_0x31e7bf);}else{if(_0x4e6ab6[0x0][_0x416c8e(0x1d5)]==_0x416c8e(0x20a))var _0x31e7bf=users['Hindi'];else{if(_0x4e6ab6[0x0][_0x416c8e(0x1d5)]==_0x416c8e(0x224))var _0x31e7bf=users[_0x416c8e(0x224)];else{if(_0x4e6ab6[0x0]['language']==_0x416c8e(0x26e))var _0x31e7bf=users[_0x416c8e(0x26e)];else{if(_0x4e6ab6[0x0]['language']==_0x416c8e(0x19c))var _0x31e7bf=users['French'];else{if(_0x4e6ab6[0x0][_0x416c8e(0x1d5)]==_0x416c8e(0x288))var _0x31e7bf=users[_0x416c8e(0x243)];else{if(_0x4e6ab6[0x0][_0x416c8e(0x1d5)]=='Chinese')var _0x31e7bf=users[_0x416c8e(0x261)];else{if(_0x4e6ab6[0x0][_0x416c8e(0x1d5)]==_0x416c8e(0x197))var _0x31e7bf=users[_0x416c8e(0x263)];}}}}}}}_0x25c1e8[_0x416c8e(0x216)](_0x416c8e(0x281),{'success':_0x38660c[_0x416c8e(0x28c)](_0x416c8e(0x235)),'errors':_0x38660c[_0x416c8e(0x28c)](_0x416c8e(0x276)),'sales':_0x5dbd8e,'profile':_0x4a44e1,'role':_0x50b454,'master_shop':_0x4e6ab6,'language':_0x31e7bf});}catch(_0x583c9d){console[_0x416c8e(0x217)](_0x583c9d);}});async function getRandom8DigitNumber(){var _0x3322ad=a0_0x4e9c7a;const _0x432f55=0x989680,_0xe874d2=0x5f5e0ff,_0x5a3631=Math[_0x3322ad(0x18f)](Math[_0x3322ad(0x29a)]()*(_0xe874d2-_0x432f55+0x1))+_0x432f55;var _0x259877;const _0x862877=await sales_finished[_0x3322ad(0x23b)]({'invoice':_0x3322ad(0x272)+_0x5a3631});return _0x862877&&_0x862877[_0x3322ad(0x21b)]>0x0?_0x259877=_0x3322ad(0x272)+_0x5a3631:_0x259877=_0x3322ad(0x272)+_0x5a3631,_0x259877;}router['get'](a0_0x4e9c7a(0x19b),auth,async(_0x775a6f,_0x4af9e4)=>{var _0x121b83=a0_0x4e9c7a;try{const {username:_0x28a01e,email:_0x5b6fc8,role:_0x43daf0}=_0x775a6f[_0x121b83(0x299)],_0x4674e3=_0x775a6f[_0x121b83(0x299)],_0x4cf684=await profile[_0x121b83(0x23b)]({'email':_0x4674e3[_0x121b83(0x20e)]}),_0x206a75=await master_shop[_0x121b83(0x232)](),_0x5cbc10=await customer[_0x121b83(0x232)]({});let _0x216166;if(_0x4674e3[_0x121b83(0x22e)]=='staff'){const _0x20c100=await staff[_0x121b83(0x23b)]({'email':_0x4674e3[_0x121b83(0x20e)]});_0x216166=await warehouse['aggregate']([{'$match':{'status':_0x121b83(0x1c5),'name':_0x20c100[_0x121b83(0x26d)],'warehouse_category':_0x121b83(0x26f),'name':{'$ne':_0x121b83(0x236)}}},{'$group':{'_id':_0x121b83(0x28f),'name':{'$first':_0x121b83(0x28f)}}},{'$sort':{'name':0x1}}]);}else _0x216166=await warehouse[_0x121b83(0x264)]([{'$match':{'status':_0x121b83(0x1c5),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x121b83(0x236)}}},{'$group':{'_id':'$name','name':{'$first':_0x121b83(0x28f)}}},{'$sort':{'name':0x1}}]);const _0x481e65=await product[_0x121b83(0x232)]({});var _0x3c218c=['Ambient',_0x121b83(0x283)];const _0x3c258b=await sales_finished[_0x121b83(0x232)]({}),_0x29bbc1=_0x3c258b[_0x121b83(0x21b)]+0x1,_0x413d09='OUTF-'+_0x29bbc1['toString']()[_0x121b83(0x19a)](0x5,'0');if(_0x206a75[0x0][_0x121b83(0x1d5)]=='English\x20(US)'){var _0x1d0916=users['English'];console[_0x121b83(0x217)](_0x1d0916);}else{if(_0x206a75[0x0][_0x121b83(0x1d5)]==_0x121b83(0x20a))var _0x1d0916=users[_0x121b83(0x20a)];else{if(_0x206a75[0x0][_0x121b83(0x1d5)]==_0x121b83(0x224))var _0x1d0916=users[_0x121b83(0x224)];else{if(_0x206a75[0x0][_0x121b83(0x1d5)]==_0x121b83(0x26e))var _0x1d0916=users[_0x121b83(0x26e)];else{if(_0x206a75[0x0][_0x121b83(0x1d5)]==_0x121b83(0x19c))var _0x1d0916=users[_0x121b83(0x19c)];else{if(_0x206a75[0x0][_0x121b83(0x1d5)]==_0x121b83(0x288))var _0x1d0916=users[_0x121b83(0x243)];else{if(_0x206a75[0x0][_0x121b83(0x1d5)]==_0x121b83(0x261))var _0x1d0916=users[_0x121b83(0x261)];else{if(_0x206a75[0x0][_0x121b83(0x1d5)]==_0x121b83(0x197))var _0x1d0916=users[_0x121b83(0x263)];}}}}}}}const _0x2bc690=getRandom8DigitNumber();_0x2bc690[_0x121b83(0x1f5)](_0xc8e7=>{var _0x6ba52c=_0x121b83;_0x4af9e4[_0x6ba52c(0x216)]('add_sales_finished',{'success':_0x775a6f[_0x6ba52c(0x28c)](_0x6ba52c(0x235)),'errors':_0x775a6f['flash'](_0x6ba52c(0x276)),'role':_0x4674e3,'profile':_0x4cf684,'customer':_0x5cbc10,'warehouse':_0x216166,'product':_0x481e65,'invoice':_0xc8e7,'master_shop':_0x206a75,'language':_0x1d0916,'rooms_data':_0x3c218c});})[_0x121b83(0x24c)](_0x14fe7a=>{var _0x255d8e=_0x121b83;_0x775a6f[_0x255d8e(0x28c)](_0x255d8e(0x276),_0x255d8e(0x208)),_0x4af9e4[_0x255d8e(0x251)](_0x255d8e(0x279));});}catch(_0x428715){console[_0x121b83(0x217)](_0x428715);}}),router[a0_0x4e9c7a(0x1bc)](a0_0x4e9c7a(0x2a6),auth,async(_0x47c2a0,_0x1f6b47)=>{var _0x565056=a0_0x4e9c7a;try{const _0x1fb6c1=_0x47c2a0[_0x565056(0x1d2)]['id'];console[_0x565056(0x217)](_0x1fb6c1);const _0x4688e0=await product[_0x565056(0x232)](),_0xac527=await purchases[_0x565056(0x264)]([{'$match':{'warehouse_name':_0x1fb6c1}},{'$unwind':_0x565056(0x1b5)},{'$group':{'_id':'$product.product_name'}}]);console[_0x565056(0x217)](_0x565056(0x223),_0xac527),_0x1f6b47[_0x565056(0x212)](0xc8)[_0x565056(0x1ca)]({'purchases_data':_0xac527,'product_data':_0x4688e0});}catch(_0x399a01){console[_0x565056(0x217)](_0x399a01);}}),router[a0_0x4e9c7a(0x192)](a0_0x4e9c7a(0x278),auth,async(_0x36244d,_0x5f04a7)=>{var _0x1485f4=a0_0x4e9c7a;try{const {warehouse_data:_0x3b7985,product_data:_0x465c88}=_0x36244d[_0x1485f4(0x1b7)];console[_0x1485f4(0x217)](_0x36244d[_0x1485f4(0x1b7)][_0x1485f4(0x1e3)]);;const _0x4a2637=await master_shop[_0x1485f4(0x232)]();console['log'](_0x1485f4(0x1f1),_0x4a2637);const _0xf7f36b=await product[_0x1485f4(0x23b)]({'name':_0x465c88});console[_0x1485f4(0x217)](_0x1485f4(0x23a),_0xf7f36b);const _0x2a3ac6=await warehouse[_0x1485f4(0x264)]([{'$match':{'name':_0x3b7985}},{'$unwind':_0x1485f4(0x282)},{'$match':{'product_details.product_name':_0x465c88}},{'$group':{'_id':_0x1485f4(0x205),'product_stock':{'$first':_0x1485f4(0x1ec)}}}]);console[_0x1485f4(0x217)](_0x1485f4(0x1a0),_0x2a3ac6),_0x5f04a7[_0x1485f4(0x212)](0xc8)[_0x1485f4(0x1ca)]({'master':_0x4a2637,'new_product':_0xf7f36b,'stock_data':_0x2a3ac6});}catch(_0x35378d){console[_0x1485f4(0x217)](_0x35378d);}}),router[a0_0x4e9c7a(0x192)]('/view/add_sales',auth,async(_0x3bdf3d,_0x30e0f3)=>{var _0x258411=a0_0x4e9c7a;try{const {invoice:_0x21e19c,date:_0x3c709e,warehouse_name:_0x405f7c,product_name:_0x48c8d6,stock:_0x3e40be,quantity:_0x1c5884,note:_0x1f5767,room:_0x25f639,primary_code:_0x2ace2f,secondary_code:_0xae1814,prod_code:_0x2ebcd4,level:_0x462c20,isle:_0x3b5c94,pallet:_0x44ceed,batch_code:_0x585f5e,SCRN:_0x31337b,expiry_date:_0x578467,mode_transpo:_0x2e5cfb,name_driver:_0x263b71}=_0x3bdf3d['body'];if(typeof _0x48c8d6==_0x258411(0x247))var _0x92ecde=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1da)]],_0x1615b8=[_0x3bdf3d['body'][_0x258411(0x191)]],_0xb01a6=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x190)]],_0x3adff2=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x275)]],_0x11bb3f=[_0x3bdf3d[_0x258411(0x1b7)]['secondary_code']],_0x12c819=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1d3)]],_0xb3da68=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x195)]],_0x7dd785=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1e5)]],_0x7acbbf=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x20f)]],_0xbffc60=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x293)]],_0x44bf9d=[_0x3bdf3d['body'][_0x258411(0x29e)]],_0x293015=[_0x3bdf3d['body'][_0x258411(0x201)]],_0x54bb57=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1a7)]],_0x147d56=[_0x3bdf3d['body']['prod_cat']],_0x260b01=[_0x3bdf3d['body'][_0x258411(0x1d1)]],_0x490408=[_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x280)]],_0x429684=[_0x3bdf3d[_0x258411(0x1b7)]['id_transaction_from']];else var _0x92ecde=[..._0x3bdf3d[_0x258411(0x1b7)]['product_name']],_0x1615b8=[..._0x3bdf3d[_0x258411(0x1b7)]['stock']],_0xb01a6=[..._0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x190)]],_0x3adff2=[..._0x3bdf3d['body'][_0x258411(0x275)]],_0x11bb3f=[..._0x3bdf3d['body'][_0x258411(0x1c1)]],_0x12c819=[..._0x3bdf3d['body']['prod_code']],_0xb3da68=[..._0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x195)]],_0x7dd785=[..._0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1e5)]],_0x7acbbf=[..._0x3bdf3d['body'][_0x258411(0x20f)]],_0xbffc60=[..._0x3bdf3d['body']['batch_code']],_0x44bf9d=[..._0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x29e)]],_0x293015=[..._0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x201)]],_0x54bb57=[..._0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1a7)]],_0x147d56=[..._0x3bdf3d['body']['prod_cat']],_0x260b01=[..._0x3bdf3d['body'][_0x258411(0x1d1)]],_0x490408=[..._0x3bdf3d[_0x258411(0x1b7)]['prod_invoice']],_0x429684=[..._0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x24e)]];const _0x499a1f=_0x92ecde[_0x258411(0x277)](_0x2b3aa3=>{return _0x2b3aa3={'product_name':_0x2b3aa3};});_0x1615b8['forEach']((_0x3dfa52,_0x4c8a96)=>{_0x499a1f[_0x4c8a96]['stock']=_0x3dfa52;}),_0xb01a6['forEach']((_0x6b30d3,_0xf315a5)=>{var _0x737169=_0x258411;_0x499a1f[_0xf315a5][_0x737169(0x200)]=Math[_0x737169(0x1bd)](_0x6b30d3);}),_0x429684[_0x258411(0x1e6)]((_0x3e3ce8,_0x47b6ae)=>{var _0x559c9e=_0x258411;_0x499a1f[_0x47b6ae][_0x559c9e(0x24e)]=_0x3e3ce8;}),_0x3adff2[_0x258411(0x1e6)]((_0x22e787,_0x3ff1ac)=>{_0x499a1f[_0x3ff1ac]['primary_code']=_0x22e787;}),_0x11bb3f[_0x258411(0x1e6)]((_0x59a520,_0x5c2308)=>{var _0x2e0435=_0x258411;_0x499a1f[_0x5c2308][_0x2e0435(0x1c1)]=_0x59a520;}),_0x12c819[_0x258411(0x1e6)]((_0x46dbb6,_0x95269e)=>{_0x499a1f[_0x95269e]['product_code']=_0x46dbb6;}),_0xb3da68[_0x258411(0x1e6)]((_0x90bde,_0xc33e1a)=>{_0x499a1f[_0xc33e1a]['bay']=_0x90bde;}),_0x7dd785[_0x258411(0x1e6)]((_0x38b1d1,_0x36a63f)=>{var _0x471549=_0x258411;_0x499a1f[_0x36a63f][_0x471549(0x226)]=_0x38b1d1;}),_0x7acbbf[_0x258411(0x1e6)]((_0x58e1a7,_0x48b8c2)=>{var _0x6e4af7=_0x258411;_0x499a1f[_0x48b8c2][_0x6e4af7(0x20f)]=_0x58e1a7;}),_0xbffc60[_0x258411(0x1e6)]((_0x4c6acb,_0x9317e6)=>{_0x499a1f[_0x9317e6]['batch_code']=_0x4c6acb;}),_0x44bf9d[_0x258411(0x1e6)]((_0x511a2d,_0x3e4faa)=>{_0x499a1f[_0x3e4faa]['expiry_date']=_0x511a2d;}),_0x293015['forEach']((_0x5f0230,_0x135dd7)=>{var _0x5d2a37=_0x258411;_0x499a1f[_0x135dd7][_0x5d2a37(0x259)]=_0x5f0230;}),_0x54bb57['forEach']((_0x48e515,_0x46d517)=>{var _0x943305=_0x258411;_0x499a1f[_0x46d517][_0x943305(0x1e4)]=_0x48e515;}),_0x147d56[_0x258411(0x1e6)]((_0x1edce9,_0x57532a)=>{var _0x160346=_0x258411;_0x499a1f[_0x57532a][_0x160346(0x267)]=_0x1edce9;}),_0x260b01['forEach']((_0x21c8c3,_0x1b71ff)=>{_0x499a1f[_0x1b71ff]['room_name']=_0x21c8c3;}),_0x490408['forEach']((_0x483270,_0x68459e)=>{var _0x3f31c7=_0x258411;_0x499a1f[_0x68459e][_0x3f31c7(0x23f)]=_0x483270;});var _0x4cbb8b=0x0;_0x499a1f[_0x258411(0x1e6)](_0x1a19dd=>{var _0x43df75=_0x258411;parseFloat(_0x1a19dd[_0x43df75(0x191)])<parseFloat(_0x1a19dd[_0x43df75(0x200)])&&parseFloat(_0x1a19dd[_0x43df75(0x200)])>parseFloat(_0x1a19dd[_0x43df75(0x191)])&&(console['log'](_0x1a19dd[_0x43df75(0x191)]+'\x20<>\x20'+_0x1a19dd[_0x43df75(0x200)]),_0x4cbb8b++);});if(_0x4cbb8b!=0x0)return _0x3bdf3d[_0x258411(0x28c)](_0x258411(0x276),_0x258411(0x1c9)),_0x30e0f3[_0x258411(0x251)](_0x258411(0x22b));const _0x458a16=_0x499a1f['filter'](_0x55e2eb=>_0x55e2eb[_0x258411(0x200)]!=='0'&&_0x55e2eb[_0x258411(0x200)]!==''),_0x87275=new sales_finished({'invoice':_0x21e19c,'customer':_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1d4)],'date':_0x3c709e,'warehouse_name':_0x405f7c,'sale_product':_0x458a16,'note':_0x1f5767,'room':_0x25f639,'primary_code':_0x2ace2f,'secondary_code':_0xae1814,'prod_code':_0x2ebcd4,'SCRN':_0x31337b,'finalize':_0x258411(0x28a),'mode_transpo':_0x2e5cfb,'name_driver':_0x263b71}),_0x54e9b7=await _0x87275[_0x258411(0x257)](),_0x4f1add=await sales_finished[_0x258411(0x23b)]({'invoice':_0x21e19c}),_0x63d7c1=new c_payment_data({'invoice':_0x21e19c,'customer':_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1d4)],'reason':_0x258411(0x21a)});await _0x63d7c1['save']();const _0x353257=await master_shop[_0x258411(0x232)](),_0x4420be=await email_settings[_0x258411(0x23b)](),_0x515a4e=await customer['findOne']({'name':_0x3bdf3d[_0x258411(0x1b7)][_0x258411(0x1d4)]});_0x353257[0x0]['currency_placement']==0x1?(right_currency=_0x353257[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x353257[0x0][_0x258411(0x29c)]);var _0x13ea78=_0x92ecde,_0x1e15e9=_0xb01a6,_0x58e7e9='',_0x4edfca;for(_0x4edfca in _0x13ea78){_0x58e7e9+=_0x258411(0x248)+_0x258411(0x1fa)+_0x13ea78[_0x4edfca]+_0x258411(0x194)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1e15e9[_0x4edfca]+'</td>'+_0x258411(0x245);}console['log'](_0x258411(0x210),_0x58e7e9);let _0x25824b=nodemailer[_0x258411(0x1eb)]({'host':_0x4420be[_0x258411(0x1f9)],'port':Number(_0x4420be['port']),'secure':![],'service':_0x258411(0x218),'auth':{'user':_0x4420be['email'],'pass':_0x4420be[_0x258411(0x241)]}}),_0x5cd6a9={'from':_0x4420be[_0x258411(0x20e)],'to':_0x258411(0x1ba),'subject':_0x258411(0x193),'attachments':[{'filename':_0x258411(0x250),'path':__dirname+_0x258411(0x260)+_0x258411(0x196)+_0x353257[0x0]['image'],'cid':_0x258411(0x22f)}],'html':_0x258411(0x289)};_0x25824b['sendMail'](_0x5cd6a9,function(_0x2ea84d,_0xd2805d){var _0x17c97e=_0x258411;_0x2ea84d?(console[_0x17c97e(0x217)](_0x2ea84d),console['log'](_0x17c97e(0x198))):console[_0x17c97e(0x217)](_0x17c97e(0x1d8));}),_0x3bdf3d['flash'](_0x258411(0x235),_0x258411(0x1cd)),_0x30e0f3[_0x258411(0x251)](_0x258411(0x2a4)+_0x54e9b7[_0x258411(0x258)]);}catch(_0x56c15a){console[_0x258411(0x217)](_0x56c15a);}}),router[a0_0x4e9c7a(0x1bc)]('/preview/:id',auth,async(_0x43466b,_0x19a7bc)=>{var _0x118cc6=a0_0x4e9c7a;try{const {username:_0x1e62b3,email:_0x4dfee,role:_0x5ec5b1}=_0x43466b[_0x118cc6(0x299)],_0x515062=_0x43466b[_0x118cc6(0x299)],_0x22b9fe=await profile[_0x118cc6(0x23b)]({'email':_0x515062[_0x118cc6(0x20e)]}),_0x5a8448=await master_shop[_0x118cc6(0x232)](),_0x11f6e3=_0x43466b[_0x118cc6(0x1d2)]['id'],_0x274237=await sales_finished['findById'](_0x11f6e3),_0x38db1f=await warehouse[_0x118cc6(0x264)]([{'$match':{'name':_0x274237[_0x118cc6(0x254)]}},{'$unwind':_0x118cc6(0x282)},{'$group':{'_id':_0x118cc6(0x1ea),'name':{'$first':_0x118cc6(0x205)},'product_stock':{'$first':_0x118cc6(0x1ec)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x118cc6(0x1b9)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x118cc6(0x1c6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x118cc6(0x274)},'storage':{'$first':_0x118cc6(0x253)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x118cc6(0x1a2)},'production_date':{'$first':_0x118cc6(0x1c0)},'batch_code':{'$first':_0x118cc6(0x294)},'room':{'$first':'$room'},'room_data':{'$first':_0x118cc6(0x244)}}}]),_0x11b804=await customer[_0x118cc6(0x232)]({});let _0x1d3e3d;if(_0x515062[_0x118cc6(0x22e)]=='staff'){const _0x1af63a=await staff['findOne']({'email':_0x515062['email']});_0x1d3e3d=await warehouse[_0x118cc6(0x264)]([{'$match':{'status':_0x118cc6(0x1c5),'name':_0x1af63a['warehouse']}},{'$group':{'_id':_0x118cc6(0x28f),'name':{'$first':'$name'}}}]);}else _0x1d3e3d=await warehouse[_0x118cc6(0x264)]([{'$match':{'status':_0x118cc6(0x1c5)}},{'$group':{'_id':_0x118cc6(0x28f),'name':{'$first':'$name'}}}]);const _0x1cf9ac=await product[_0x118cc6(0x232)]({});if(_0x5a8448[0x0][_0x118cc6(0x1d5)]==_0x118cc6(0x1e1)){var _0x320f55=users['English'];console[_0x118cc6(0x217)](_0x320f55);}else{if(_0x5a8448[0x0][_0x118cc6(0x1d5)]=='Hindi')var _0x320f55=users[_0x118cc6(0x20a)];else{if(_0x5a8448[0x0]['language']==_0x118cc6(0x224))var _0x320f55=users[_0x118cc6(0x224)];else{if(_0x5a8448[0x0][_0x118cc6(0x1d5)]==_0x118cc6(0x26e))var _0x320f55=users[_0x118cc6(0x26e)];else{if(_0x5a8448[0x0][_0x118cc6(0x1d5)]=='French')var _0x320f55=users[_0x118cc6(0x19c)];else{if(_0x5a8448[0x0][_0x118cc6(0x1d5)]==_0x118cc6(0x288))var _0x320f55=users['Portuguese'];else{if(_0x5a8448[0x0][_0x118cc6(0x1d5)]==_0x118cc6(0x261))var _0x320f55=users['Chinese'];else{if(_0x5a8448[0x0][_0x118cc6(0x1d5)]==_0x118cc6(0x197))var _0x320f55=users[_0x118cc6(0x263)];}}}}}}}_0x19a7bc[_0x118cc6(0x216)]('edit_sales_finished_view',{'success':_0x43466b['flash'](_0x118cc6(0x235)),'errors':_0x43466b['flash'](_0x118cc6(0x276)),'role':_0x515062,'profile':_0x22b9fe,'customer':_0x11b804,'warehouse':_0x1d3e3d,'product':_0x38db1f,'user':_0x274237,'master_shop':_0x5a8448,'unit':_0x1cf9ac,'language':_0x320f55});}catch(_0x505077){console[_0x118cc6(0x217)](_0x505077);}}),router[a0_0x4e9c7a(0x192)](a0_0x4e9c7a(0x1ce),auth,async(_0x3262e4,_0x2ae05f)=>{var _0x5bb56c=a0_0x4e9c7a;try{const _0x5e5b7f=_0x3262e4[_0x5bb56c(0x1d2)]['id'],{invoice:_0x44ddab,warehouse_name:_0x127c04,room:_0x49d48e}=_0x3262e4['body'],_0x4cd669=await sales_finished[_0x5bb56c(0x23b)]({'invoice':_0x44ddab}),_0x43b7ee=_0x4cd669[_0x5bb56c(0x1db)][_0x5bb56c(0x277)](async _0x4d6dc8=>{var _0x427293=_0x5bb56c,_0x4cf32f=await warehouse[_0x427293(0x23b)]({'name':_0x127c04,'room':_0x4d6dc8[_0x427293(0x221)],'warehouse_category':'Finished\x20Goods'});const _0x226b9b=_0x4cf32f['product_details'][_0x427293(0x277)](_0x59f249=>{var _0x4e3f30=_0x427293;(_0x59f249[_0x4e3f30(0x1da)]==_0x4d6dc8[_0x4e3f30(0x1da)]&&_0x59f249[_0x4e3f30(0x28b)]==_0x4d6dc8[_0x4e3f30(0x28b)]&&_0x59f249[_0x4e3f30(0x29e)]==_0x4d6dc8[_0x4e3f30(0x29e)]&&_0x59f249['production_date']==_0x4d6dc8[_0x4e3f30(0x259)]&&_0x59f249[_0x4e3f30(0x293)]==_0x4d6dc8[_0x4e3f30(0x293)]&&_0x59f249[_0x4e3f30(0x23f)]==_0x4d6dc8['invoice']||_0x59f249[_0x4e3f30(0x258)]==_0x4d6dc8[_0x4e3f30(0x24e)])&&(_0x59f249['product_stock']>0x0&&(console[_0x4e3f30(0x217)](_0x59f249[_0x4e3f30(0x1da)]+_0x4e3f30(0x25a)+_0x4d6dc8[_0x4e3f30(0x1da)]+_0x4e3f30(0x26b)+_0x59f249[_0x4e3f30(0x28b)]+_0x4e3f30(0x25a)+_0x4d6dc8[_0x4e3f30(0x28b)]+_0x4e3f30(0x26b)+_0x59f249[_0x4e3f30(0x259)]+_0x4e3f30(0x25a)+_0x4d6dc8[_0x4e3f30(0x259)]+_0x4e3f30(0x26b)+_0x59f249[_0x4e3f30(0x29e)]+_0x4e3f30(0x25a)+_0x4d6dc8[_0x4e3f30(0x29e)]+_0x4e3f30(0x26b)+_0x59f249[_0x4e3f30(0x293)]+_0x4e3f30(0x25a)+_0x4d6dc8[_0x4e3f30(0x293)]+_0x4e3f30(0x26b)+_0x59f249[_0x4e3f30(0x23f)]+_0x4e3f30(0x25a)+_0x4d6dc8[_0x4e3f30(0x23f)]+_0x4e3f30(0x26b)+_0x59f249['product_stock']+_0x4e3f30(0x1c3)+_0x4d6dc8[_0x4e3f30(0x200)]+'\x20>>>\x20'+_0x4d6dc8[_0x4e3f30(0x221)]+_0x4e3f30(0x26b)+_0x59f249[_0x4e3f30(0x258)]+'\x20==\x20'+_0x4d6dc8['id_transaction_from']),_0x59f249[_0x4e3f30(0x1aa)]=Math[_0x4e3f30(0x27f)](0x0,Math[_0x4e3f30(0x1bd)](_0x59f249[_0x4e3f30(0x1aa)])-Math[_0x4e3f30(0x1bd)](_0x4d6dc8[_0x4e3f30(0x200)]))));});return _0x4cf32f;});Promise[_0x5bb56c(0x1f6)](_0x43b7ee)[_0x5bb56c(0x1f5)](async _0xc9dabf=>{var _0x3631dc=_0x5bb56c;try{for(const _0x125cf5 of _0xc9dabf){await _0x125cf5['save']();}_0x4cd669['finalize']=_0x3631dc(0x1a1);const _0x1703e2=await _0x4cd669[_0x3631dc(0x257)](),_0x109482=await master_shop[_0x3631dc(0x232)](),_0x81fc40=await email_settings[_0x3631dc(0x23b)](),_0x479b51=await supervisor_settings[_0x3631dc(0x232)]();var _0x239b1c=_0x4cd669[_0x3631dc(0x1db)],_0x470910='',_0x5e999d;for(_0x5e999d in _0x239b1c){var _0x3f8be1='FG';_0x4cd669[_0x3631dc(0x254)]==_0x3631dc(0x1fe)&&(_0x3f8be1='DG'),_0x470910+=_0x3631dc(0x248)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x239b1c[_0x5e999d][_0x3631dc(0x1da)]+_0x3631dc(0x194)+_0x3631dc(0x1fa)+_0x239b1c[_0x5e999d][_0x3631dc(0x27c)]+_0x3631dc(0x194)+_0x3631dc(0x1fa)+_0x239b1c[_0x5e999d][_0x3631dc(0x200)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x239b1c[_0x5e999d][_0x3631dc(0x226)]+_0x3631dc(0x194)+_0x3631dc(0x1fa)+_0x239b1c[_0x5e999d][_0x3631dc(0x20f)]+_0x3631dc(0x194)+_0x3631dc(0x1fa)+_0x4cd669['warehouse_name']+'</td>'+_0x3631dc(0x1fa)+_0x239b1c[_0x5e999d][_0x3631dc(0x221)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3f8be1+_0x239b1c[_0x5e999d][_0x3631dc(0x28b)]+_0x3631dc(0x194);}let _0x4bc6bb=nodemailer[_0x3631dc(0x1eb)]({'host':_0x81fc40[_0x3631dc(0x1f9)],'port':Number(_0x81fc40[_0x3631dc(0x230)]),'secure':![],'auth':{'user':_0x81fc40['email'],'pass':_0x81fc40[_0x3631dc(0x241)]}}),_0x7c79ce={'from':_0x81fc40[_0x3631dc(0x20e)],'to':_0x479b51[0x0][_0x3631dc(0x27e)],'subject':_0x3631dc(0x24f),'attachments':[{'filename':_0x3631dc(0x250),'path':__dirname+'/../public'+_0x3631dc(0x196)+_0x109482[0x0][_0x3631dc(0x206)],'cid':_0x3631dc(0x22f)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x3631dc(0x1d7)+_0x3631dc(0x1af)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x3631dc(0x1af)+_0x3631dc(0x18d)+'</div>'+_0x3631dc(0x1af)+_0x3631dc(0x1d6)+_0x109482[0x0][_0x3631dc(0x1ad)]+_0x3631dc(0x1be)+_0x3631dc(0x29f)+_0x3631dc(0x29f)+_0x3631dc(0x228)+_0x3631dc(0x1af)+_0x3631dc(0x23d)+_0x3631dc(0x25c)+_0x4cd669[_0x3631dc(0x23f)]+'\x20'+_0x3631dc(0x262)+_0x3631dc(0x23c)+_0x4cd669[_0x3631dc(0x29b)]+'\x20'+'</span>'+'</h5>'+_0x3631dc(0x29f)+_0x3631dc(0x290)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x3631dc(0x248)+_0x3631dc(0x1f3)+_0x3631dc(0x1df)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x3631dc(0x1a4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3631dc(0x2a3)+_0x3631dc(0x234)+_0x3631dc(0x1b8)+_0x3631dc(0x245)+_0x3631dc(0x1f2)+_0x3631dc(0x270)+'\x20'+_0x470910+'\x20'+'</tbody>'+_0x3631dc(0x1ae)+'<div>'+_0x3631dc(0x1b4)+_0x3631dc(0x227)+_0x109482[0x0][_0x3631dc(0x1ad)]+_0x3631dc(0x1e7)+_0x3631dc(0x29f)+_0x3631dc(0x29f)+_0x3631dc(0x273)};_0x4bc6bb[_0x3631dc(0x238)](_0x7c79ce,function(_0x37590a,_0x4d8514){var _0x58ebf3=_0x3631dc;_0x37590a?(console[_0x58ebf3(0x217)](_0x37590a),console[_0x58ebf3(0x217)](_0x58ebf3(0x198))):console[_0x58ebf3(0x217)]('Email\x20sent\x20successfully');}),_0x3262e4[_0x3631dc(0x28c)](_0x3631dc(0x235),_0x3631dc(0x1cf)),_0x2ae05f[_0x3631dc(0x251)](_0x3631dc(0x25d)+_0x5e5b7f);}catch(_0x33e50a){console['error'](_0x33e50a),_0x2ae05f[_0x3631dc(0x212)](0x1f4)['json']({'error':_0x3631dc(0x266)});}})['catch'](_0x48b46a=>{var _0x42e7cd=_0x5bb56c;console[_0x42e7cd(0x233)](_0x48b46a),_0x2ae05f[_0x42e7cd(0x212)](0x1f4)[_0x42e7cd(0x1ca)]({'error':_0x42e7cd(0x252)});});}catch(_0x501a51){console[_0x5bb56c(0x217)](_0x501a51);}}),router[a0_0x4e9c7a(0x1bc)]('/view/:id',auth,async(_0xc961ed,_0x2ca13c)=>{var _0x50213a=a0_0x4e9c7a;try{const {username:_0x1830b6,email:_0x1e3dc6,role:_0x64cfe9}=_0xc961ed['user'],_0x1a36a1=_0xc961ed[_0x50213a(0x299)],_0x3253e2=await profile[_0x50213a(0x23b)]({'email':_0x1a36a1[_0x50213a(0x20e)]}),_0x22c796=await master_shop['find'](),_0x51aec5=_0xc961ed['params']['id'],_0x50feec=await sales_finished[_0x50213a(0x242)](_0x51aec5);let _0x1e8102=new Date(_0x50feec['expiry_date']),_0x1cbe8a=('0'+_0x1e8102[_0x50213a(0x292)]())[_0x50213a(0x209)](-0x2),_0x34a656=('0'+(_0x1e8102['getMonth']()+0x1))[_0x50213a(0x209)](-0x2),_0x268e05=_0x1e8102[_0x50213a(0x2a0)](),_0x355756=_0x268e05+'-'+_0x34a656+'-'+_0x1cbe8a;var _0x2d9772=['Ambient',_0x50213a(0x283)];const _0x50b132=await warehouse[_0x50213a(0x264)]([{'$match':{'name':_0x50feec['warehouse_name'],'room':_0x50feec[_0x50213a(0x271)]}},{'$unwind':_0x50213a(0x282)},{'$group':{'_id':_0x50213a(0x1ea),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x50213a(0x1ec)},'bay':{'$first':_0x50213a(0x1cc)},'bin':{'$first':_0x50213a(0x29d)},'type':{'$first':_0x50213a(0x1b9)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x50213a(0x1c6)},'secondary_code':{'$first':_0x50213a(0x27d)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x50213a(0x253)},'rack':{'$first':'$product_details.rack'}}}]),_0x46f8af=await customer[_0x50213a(0x232)]({});let _0x17b39a;if(_0x1a36a1[_0x50213a(0x22e)]==_0x50213a(0x1cb)){const _0x56934c=await staff[_0x50213a(0x23b)]({'email':_0x1a36a1['email']});_0x17b39a=await warehouse[_0x50213a(0x264)]([{'$match':{'status':_0x50213a(0x1c5),'name':_0x56934c[_0x50213a(0x26d)]}},{'$group':{'_id':_0x50213a(0x28f),'name':{'$first':'$name'}}}]);}else _0x17b39a=await warehouse[_0x50213a(0x264)]([{'$match':{'status':_0x50213a(0x1c5)}},{'$group':{'_id':'$name','name':{'$first':_0x50213a(0x28f)}}}]);const _0x2f62e8=await product[_0x50213a(0x232)]({});if(_0x22c796[0x0]['language']==_0x50213a(0x1e1)){var _0x1175fd=users[_0x50213a(0x291)];console[_0x50213a(0x217)](_0x1175fd);}else{if(_0x22c796[0x0][_0x50213a(0x1d5)]==_0x50213a(0x20a))var _0x1175fd=users['Hindi'];else{if(_0x22c796[0x0][_0x50213a(0x1d5)]==_0x50213a(0x224))var _0x1175fd=users[_0x50213a(0x224)];else{if(_0x22c796[0x0]['language']==_0x50213a(0x26e))var _0x1175fd=users[_0x50213a(0x26e)];else{if(_0x22c796[0x0][_0x50213a(0x1d5)]==_0x50213a(0x19c))var _0x1175fd=users[_0x50213a(0x19c)];else{if(_0x22c796[0x0]['language']==_0x50213a(0x288))var _0x1175fd=users[_0x50213a(0x243)];else{if(_0x22c796[0x0][_0x50213a(0x1d5)]==_0x50213a(0x261))var _0x1175fd=users['Chinese'];else{if(_0x22c796[0x0][_0x50213a(0x1d5)]=='Arabic\x20(ae)')var _0x1175fd=users[_0x50213a(0x263)];}}}}}}}_0x2ca13c[_0x50213a(0x216)]('edit_sales_finished',{'success':_0xc961ed[_0x50213a(0x28c)](_0x50213a(0x235)),'errors':_0xc961ed['flash'](_0x50213a(0x276)),'role':_0x1a36a1,'profile':_0x3253e2,'customer':_0x46f8af,'warehouse':_0x17b39a,'product':_0x50b132,'user':_0x50feec,'master_shop':_0x22c796,'unit':_0x2f62e8,'language':_0x1175fd,'rooms_data':_0x2d9772,'ed_fullDate':_0x355756});}catch(_0xb05f21){console[_0x50213a(0x217)](_0xb05f21);}}),router[a0_0x4e9c7a(0x192)]('/view/:id',auth,async(_0x253175,_0x5eb8a7)=>{var _0x599959=a0_0x4e9c7a;try{const _0x5bef3f=_0x253175[_0x599959(0x1d2)]['id'],_0x39bc64=await sales_finished[_0x599959(0x23b)]({'_id':_0x253175[_0x599959(0x1d2)]['id']}),_0x4de24e=await warehouse[_0x599959(0x23b)]({'name':_0x39bc64[_0x599959(0x254)],'room':_0x253175['body']['room'],'warehouse_category':_0x599959(0x26f)}),{invoice:_0x5587c4,customer:_0x2a9055,date:_0x40724a,warehouse_name:_0x8b4d7f,product_name:_0x24d9ed,stock:_0x20f418,adjust_qty:_0x48404b,note:_0x2cf433,room:_0x50dad0,primary_code:_0x45012d,secondary_code:_0x294edb,prod_code:_0x572f34,level:_0x1320ff,isle:_0x11a852,pallet:_0x1e07f0,expiry_date:_0x18102c}=_0x253175[_0x599959(0x1b7)];if(typeof _0x24d9ed==_0x599959(0x247))var _0x148cba=[_0x253175[_0x599959(0x1b7)][_0x599959(0x1da)]],_0x13e9e2=[_0x253175[_0x599959(0x1b7)]['stock']],_0x14c0cf=[_0x253175[_0x599959(0x1b7)][_0x599959(0x19f)]],_0x6b2512=[_0x253175[_0x599959(0x1b7)][_0x599959(0x275)]],_0x3013e5=[_0x253175['body'][_0x599959(0x1c1)]],_0x44a43e=[_0x253175[_0x599959(0x1b7)][_0x599959(0x1d3)]],_0x43b67a=[_0x253175[_0x599959(0x1b7)][_0x599959(0x195)]],_0x37b986=[_0x253175[_0x599959(0x1b7)][_0x599959(0x29e)]];else var _0x148cba=[..._0x253175['body'][_0x599959(0x1da)]],_0x13e9e2=[..._0x253175['body']['stock']],_0x14c0cf=[..._0x253175[_0x599959(0x1b7)][_0x599959(0x19f)]],_0x6b2512=[..._0x253175[_0x599959(0x1b7)][_0x599959(0x275)]],_0x3013e5=[..._0x253175['body'][_0x599959(0x1c1)]],_0x44a43e=[..._0x253175[_0x599959(0x1b7)][_0x599959(0x1d3)]],_0x43b67a=[..._0x253175[_0x599959(0x1b7)]['level']],_0x37b986=[..._0x253175[_0x599959(0x1b7)][_0x599959(0x29e)]];const _0x231dca=_0x148cba[_0x599959(0x277)](_0x1adc40=>{return _0x1adc40={'product_name':_0x1adc40};});_0x13e9e2[_0x599959(0x1e6)]((_0x242735,_0x5ac593)=>{var _0x283909=_0x599959;_0x231dca[_0x5ac593][_0x283909(0x191)]=_0x242735;}),_0x14c0cf[_0x599959(0x1e6)]((_0x4965bc,_0x4810c)=>{_0x231dca[_0x4810c]['quantity']=_0x4965bc;}),_0x6b2512[_0x599959(0x1e6)]((_0x31a3b2,_0x96e9b5)=>{_0x231dca[_0x96e9b5]['primary_code']=_0x31a3b2;}),_0x3013e5['forEach']((_0x8779b5,_0x24aa07)=>{_0x231dca[_0x24aa07]['secondary_code']=_0x8779b5;}),_0x44a43e['forEach']((_0x9cc87b,_0x40468c)=>{_0x231dca[_0x40468c]['product_code']=_0x9cc87b;}),_0x43b67a['forEach']((_0x5c7a9d,_0xc85b75)=>{_0x231dca[_0xc85b75]['level']=_0x5c7a9d;}),_0x37b986['forEach']((_0x47feab,_0x31c433)=>{_0x231dca[_0x31c433]['expiry_date']=_0x47feab;});var _0x39060d=0x0;_0x231dca[_0x599959(0x1e6)](_0x442635=>{var _0x28ffbd=_0x599959;console[_0x28ffbd(0x217)](_0x28ffbd(0x287),_0x442635),(parseInt(_0x442635[_0x28ffbd(0x191)])<parseInt(_0x442635[_0x28ffbd(0x200)])||parseInt(_0x442635[_0x28ffbd(0x200)])==0x0)&&_0x39060d++;});if(_0x39060d!=0x0)return _0x253175[_0x599959(0x28c)](_0x599959(0x276),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x5eb8a7[_0x599959(0x251)](_0x599959(0x22b));_0x39bc64[_0x599959(0x1db)][_0x599959(0x1e6)](_0x3a60c8=>{var _0x26ef83=_0x599959;const _0xd4b7ac=_0x4de24e[_0x26ef83(0x22d)]['map'](_0x2e3cd6=>{var _0x4bdf1a=_0x26ef83;_0x2e3cd6[_0x4bdf1a(0x1da)]==_0x3a60c8[_0x4bdf1a(0x1da)]&&_0x2e3cd6['bay']==_0x3a60c8[_0x4bdf1a(0x28b)]&&(_0x2e3cd6['product_stock']=parseInt(_0x2e3cd6[_0x4bdf1a(0x1aa)])+parseInt(_0x3a60c8[_0x4bdf1a(0x200)]));});}),await _0x4de24e[_0x599959(0x257)]();const _0x48ea45=_0x231dca[_0x599959(0x246)](_0x329fbc=>_0x329fbc[_0x599959(0x200)]!=='0'&&_0x329fbc[_0x599959(0x200)]!=='');_0x39bc64[_0x599959(0x23f)]=_0x5587c4,_0x39bc64['customer']=_0x2a9055,_0x39bc64[_0x599959(0x29b)]=_0x40724a,_0x39bc64[_0x599959(0x254)]=_0x8b4d7f,_0x39bc64[_0x599959(0x1db)]=_0x48ea45,_0x39bc64[_0x599959(0x285)]=_0x2cf433,_0x39bc64[_0x599959(0x271)]=_0x50dad0;const _0x5060a6=await _0x39bc64[_0x599959(0x257)](),_0x2cea1e=await sales_finished['findOne']({'_id':_0x253175[_0x599959(0x1d2)]['id']}),_0x15d467=await warehouse[_0x599959(0x23b)]({'name':_0x8b4d7f,'room':_0x50dad0,'warehouse_category':_0x599959(0x26f)});_0x2cea1e['sale_product'][_0x599959(0x1e6)](_0x46ccd8=>{var _0x1bfc4a=_0x599959;const _0x342f95=_0x15d467['product_details'][_0x1bfc4a(0x277)](_0x16c0ea=>{var _0xaf79a4=_0x1bfc4a;_0x16c0ea[_0xaf79a4(0x1da)]==_0x46ccd8[_0xaf79a4(0x1da)]&&_0x16c0ea[_0xaf79a4(0x28b)]==_0x46ccd8[_0xaf79a4(0x28b)]&&(_0x16c0ea[_0xaf79a4(0x1aa)]=parseInt(_0x16c0ea[_0xaf79a4(0x1aa)])-parseInt(_0x46ccd8[_0xaf79a4(0x200)]));});}),console[_0x599959(0x217)](_0x599959(0x2a1),_0x15d467),await _0x15d467[_0x599959(0x257)]();const _0xd743f5=await c_payment_data[_0x599959(0x23b)]({'invoice':_0x253175['body']['invoice']});_0xd743f5[_0x599959(0x1f7)]=_0x253175[_0x599959(0x1b7)][_0x599959(0x1f7)],await _0xd743f5[_0x599959(0x257)](),_0x253175['flash']('success',_0x599959(0x1cf)),_0x5eb8a7[_0x599959(0x251)](_0x599959(0x279));}catch(_0x2b5c42){console[_0x599959(0x217)](_0x2b5c42);}}),router['post'](a0_0x4e9c7a(0x202),auth,async(_0xc4c26c,_0x2be6e2)=>{var _0x4a0368=a0_0x4e9c7a;try{const _0x4a751c=_0xc4c26c['params']['id'],{invoice:_0x285c55,customer:_0x35bf3c,receivable_amount:_0x6c2096,received_amount:_0x294a8b}=_0xc4c26c[_0x4a0368(0x1b7)],_0x4166f8=await sales['findById'](_0x4a751c);console[_0x4a0368(0x217)](_0x4166f8);var _0x6d2a45=_0x6c2096-_0x294a8b;console['log'](_0x294a8b),_0x4166f8['received_amount']=parseFloat(_0x294a8b)+parseFloat(_0x4166f8[_0x4a0368(0x214)]),_0x4166f8[_0x4a0368(0x1de)]=_0x6d2a45,console['log'](_0x4166f8);const _0x3d7a5f=await _0x4166f8[_0x4a0368(0x257)](),_0x2189cc=await c_payment_data[_0x4a0368(0x23b)]({'invoice':_0x285c55});_0x2189cc[_0x4a0368(0x1bf)]=_0x6d2a45,await _0x2189cc[_0x4a0368(0x257)]();let _0x5b4ba8=new Date(),_0x3f5c02=('0'+_0x5b4ba8['getDate']())['slice'](-0x2),_0xde3130=('0'+(_0x5b4ba8[_0x4a0368(0x1e8)]()+0x1))[_0x4a0368(0x209)](-0x2),_0x1eeae2=_0x5b4ba8[_0x4a0368(0x2a0)](),_0x2f7ad2=_0x1eeae2+'-'+_0xde3130+'-'+_0x3f5c02;const _0x457939=new customer_payment({'invoice':_0x285c55,'date':_0x1eeae2+'-'+_0xde3130+'-'+_0x3f5c02,'customer':_0x35bf3c,'reason':_0x4a0368(0x1ff),'amount':_0x294a8b}),_0x43cdf9=await _0x457939[_0x4a0368(0x257)]();_0xc4c26c[_0x4a0368(0x28c)](_0x4a0368(0x235),_0x4a0368(0x199)),_0x2be6e2[_0x4a0368(0x251)](_0x4a0368(0x26a));}catch(_0x1e5331){console[_0x4a0368(0x217)](_0x1e5331);}}),router[a0_0x4e9c7a(0x1bc)](a0_0x4e9c7a(0x1fd),auth,async(_0x1f2fec,_0x15f76a)=>{var _0x2dc86a=a0_0x4e9c7a;try{const {username:_0x15d7d6,email:_0x27adf1,role:_0x516b59}=_0x1f2fec[_0x2dc86a(0x299)],_0x243bec=_0x1f2fec[_0x2dc86a(0x299)],_0x3fd82c=await profile[_0x2dc86a(0x23b)]({'email':_0x243bec[_0x2dc86a(0x20e)]}),_0x3c713f=await master_shop['find']();console[_0x2dc86a(0x217)]('master',_0x3c713f);const _0x126d61=_0x1f2fec[_0x2dc86a(0x1d2)]['id'],_0x377b17=await sales['findById'](_0x126d61);console['log'](_0x377b17);const _0x460643=await customer[_0x2dc86a(0x23b)]({'name':_0x377b17['customer']});console['log'](_0x460643);if(_0x3c713f[0x0]['language']==_0x2dc86a(0x1e1)){var _0x376860=users[_0x2dc86a(0x291)];console['log'](_0x376860);}else{if(_0x3c713f[0x0][_0x2dc86a(0x1d5)]==_0x2dc86a(0x20a))var _0x376860=users[_0x2dc86a(0x20a)];else{if(_0x3c713f[0x0][_0x2dc86a(0x1d5)]==_0x2dc86a(0x224))var _0x376860=users['German'];else{if(_0x3c713f[0x0]['language']==_0x2dc86a(0x26e))var _0x376860=users[_0x2dc86a(0x26e)];else{if(_0x3c713f[0x0][_0x2dc86a(0x1d5)]==_0x2dc86a(0x19c))var _0x376860=users[_0x2dc86a(0x19c)];else{if(_0x3c713f[0x0][_0x2dc86a(0x1d5)]==_0x2dc86a(0x288))var _0x376860=users[_0x2dc86a(0x243)];else{if(_0x3c713f[0x0]['language']=='Chinese')var _0x376860=users[_0x2dc86a(0x261)];else{if(_0x3c713f[0x0][_0x2dc86a(0x1d5)]==_0x2dc86a(0x197))var _0x376860=users['Arabic'];}}}}}}}_0x15f76a[_0x2dc86a(0x216)](_0x2dc86a(0x24b),{'success':_0x1f2fec[_0x2dc86a(0x28c)]('success'),'errors':_0x1f2fec[_0x2dc86a(0x28c)](_0x2dc86a(0x276)),'role':_0x243bec,'profile':_0x3fd82c,'master_shop':_0x3c713f,'customers':_0x460643,'sales':_0x377b17,'language':_0x376860});}catch(_0x550755){console['log'](_0x550755);}}),router[a0_0x4e9c7a(0x1bc)]('/view/return_sales/:id',auth,async(_0x3f6fc1,_0x3c3974)=>{var _0x1c8277=a0_0x4e9c7a;try{const {username:_0x379e7c,email:_0xf9c715,role:_0x2472e5}=_0x3f6fc1[_0x1c8277(0x299)],_0x5b9804=_0x3f6fc1[_0x1c8277(0x299)],_0x34929c=await profile[_0x1c8277(0x23b)]({'email':_0x5b9804['email']}),_0x4609a2=await master_shop[_0x1c8277(0x232)](),_0x495eaa=_0x3f6fc1[_0x1c8277(0x1d2)]['id'],_0x577e4c=await sales_finished['findById'](_0x495eaa),_0x5dd39b=await warehouse['aggregate']([{'$match':{'name':_0x577e4c[_0x1c8277(0x254)]}},{'$unwind':_0x1c8277(0x282)},{'$group':{'_id':_0x1c8277(0x1ea),'name':{'$first':_0x1c8277(0x205)},'product_stock':{'$first':_0x1c8277(0x1ec)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1c8277(0x29d)},'type':{'$first':_0x1c8277(0x1b9)},'floorlevel':{'$first':_0x1c8277(0x28e)},'primary_code':{'$first':_0x1c8277(0x1c6)},'secondary_code':{'$first':_0x1c8277(0x27d)},'product_code':{'$first':_0x1c8277(0x274)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1c8277(0x1b6)},'expiry_date':{'$first':_0x1c8277(0x1a2)},'production_date':{'$first':_0x1c8277(0x1c0)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1c8277(0x21e)},'maxProducts':{'$first':_0x1c8277(0x215)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x1c8277(0x1c8)}}}]),_0x3b14a4=await product[_0x1c8277(0x232)]({}),_0xb56cb5=await warehouse[_0x1c8277(0x264)]([{'$match':{'status':_0x1c8277(0x1c5),'warehouse_category':_0x1c8277(0x26f),'name':{'$ne':'Return\x20Goods','$ne':_0x1c8277(0x25e)}}},{'$group':{'_id':_0x1c8277(0x28f),'name':{'$first':_0x1c8277(0x28f)}}},{'$sort':{'name':0x1}}]);var _0x36e30e=[_0x1c8277(0x1f4)];const _0x16aad0=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':'Quality\x20Inspection'}},{'$group':{'_id':_0x1c8277(0x28f),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x4609a2[0x0][_0x1c8277(0x1d5)]=='English\x20(US)'){var _0x5dae06=users[_0x1c8277(0x291)];console['log'](_0x5dae06);}else{if(_0x4609a2[0x0][_0x1c8277(0x1d5)]==_0x1c8277(0x20a))var _0x5dae06=users[_0x1c8277(0x20a)];else{if(_0x4609a2[0x0][_0x1c8277(0x1d5)]==_0x1c8277(0x224))var _0x5dae06=users['German'];else{if(_0x4609a2[0x0]['language']==_0x1c8277(0x26e))var _0x5dae06=users[_0x1c8277(0x26e)];else{if(_0x4609a2[0x0][_0x1c8277(0x1d5)]==_0x1c8277(0x19c))var _0x5dae06=users[_0x1c8277(0x19c)];else{if(_0x4609a2[0x0][_0x1c8277(0x1d5)]==_0x1c8277(0x288))var _0x5dae06=users['Portuguese'];else{if(_0x4609a2[0x0]['language']==_0x1c8277(0x261))var _0x5dae06=users[_0x1c8277(0x261)];else{if(_0x4609a2[0x0][_0x1c8277(0x1d5)]==_0x1c8277(0x197))var _0x5dae06=users[_0x1c8277(0x263)];}}}}}}}_0x3c3974[_0x1c8277(0x216)](_0x1c8277(0x22a),{'success':_0x3f6fc1[_0x1c8277(0x28c)](_0x1c8277(0x235)),'errors':_0x3f6fc1['flash'](_0x1c8277(0x276)),'role':_0x5b9804,'profile':_0x34929c,'user':_0x577e4c,'stock':_0x5dd39b,'master_shop':_0x4609a2,'unit':_0x3b14a4,'language':_0x5dae06,'warehouses':_0xb56cb5,'rooms':_0x36e30e,'warehouse_QA':_0x16aad0});}catch(_0x9cd5fb){console['log'](_0x9cd5fb),_0x3c3974[_0x1c8277(0x212)](0xc8)[_0x1c8277(0x1ca)]({'message':_0x9cd5fb['message']});}}),router[a0_0x4e9c7a(0x192)]('/view/return_sales/:id',auth,async(_0x3e7531,_0x53cf6d)=>{var _0x2b484e=a0_0x4e9c7a;if(_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x24a)]=='QA')try{const {invoice:_0x4713d2,date:_0x3f767c,warehouse_name:_0x54ec16,product_name:_0x48beae,primary_code:_0x4e2fd3,secondary_code:_0x6666f,product_code:_0x546e95,sales_quantity:_0x422bc4,stocks:_0x491a43,return_qty:_0x2c7074,Room_name:_0x44a24d,to_warehouse_name_QA:_0x2e9524,to_Room_name_QA:_0x534af5,note:_0x3328f7,for_categorize:_0x20a520,product_name_QA1:_0x2b9cb5}=_0x3e7531[_0x2b484e(0x1b7)];if(typeof _0x2b9cb5==_0x2b484e(0x247))var _0x4481d7=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x18e)]],_0x5677f4=[_0x3e7531['body'][_0x2b484e(0x1e0)]],_0x3837c5=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x21f)]],_0x56f372=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x204)]],_0x43fc15=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x222)]],_0x4d0d94=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1c4)]],_0x33799a=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x20b)]],_0x48963e=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x19d)]],_0x58a435=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1ef)]],_0x30f10a=[_0x3e7531[_0x2b484e(0x1b7)]['batch_code_QA']],_0x501d54=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x286)]],_0x3cf9b3=[_0x3e7531['body'][_0x2b484e(0x21d)]],_0x1be3b2=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1dd)]],_0x28d1f0=[_0x3e7531['body'][_0x2b484e(0x229)]];else var _0x4481d7=[..._0x3e7531[_0x2b484e(0x1b7)]['product_name_QA1']],_0x5677f4=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1e0)]],_0x3837c5=[..._0x3e7531['body']['secondary_code_QA']],_0x56f372=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x204)]],_0x43fc15=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x222)]],_0x4d0d94=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1c4)]],_0x33799a=[..._0x3e7531[_0x2b484e(0x1b7)]['return_qty_QA']],_0x48963e=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x19d)]],_0x58a435=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1ef)]],_0x30f10a=[..._0x3e7531['body']['batch_code_QA']],_0x501d54=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x286)]],_0x3cf9b3=[..._0x3e7531[_0x2b484e(0x1b7)]['unit_QA']],_0x1be3b2=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1dd)]],_0x28d1f0=[..._0x3e7531['body'][_0x2b484e(0x229)]];const _0x502af5=_0x4481d7[_0x2b484e(0x277)](_0x54c400=>{return _0x54c400={'product_name':_0x54c400};});_0x5677f4[_0x2b484e(0x1e6)]((_0x12402f,_0x5de9fc)=>{var _0x1af06d=_0x2b484e;_0x502af5[_0x5de9fc][_0x1af06d(0x275)]=_0x12402f;}),_0x3837c5[_0x2b484e(0x1e6)]((_0x3b6271,_0x1d2aad)=>{_0x502af5[_0x1d2aad]['secondary_code']=_0x3b6271;}),_0x56f372[_0x2b484e(0x1e6)]((_0x5a2d00,_0x13eb7c)=>{var _0x441d28=_0x2b484e;_0x502af5[_0x13eb7c][_0x441d28(0x27c)]=_0x5a2d00;}),_0x43fc15[_0x2b484e(0x1e6)]((_0x1f481e,_0xd13fbc)=>{var _0x32a4fb=_0x2b484e;_0x502af5[_0xd13fbc][_0x32a4fb(0x23e)]=_0x1f481e;}),_0x4d0d94[_0x2b484e(0x1e6)]((_0x5e4b12,_0x49cab9)=>{var _0x33c131=_0x2b484e;_0x502af5[_0x49cab9][_0x33c131(0x191)]=_0x5e4b12;}),_0x33799a[_0x2b484e(0x1e6)]((_0x3779a3,_0x2261fe)=>{_0x502af5[_0x2261fe]['return_qty']=_0x3779a3;}),_0x48963e[_0x2b484e(0x1e6)]((_0x273fd2,_0x4afc0f)=>{var _0x370806=_0x2b484e;_0x502af5[_0x4afc0f][_0x370806(0x1b1)]=_0x273fd2;}),_0x58a435[_0x2b484e(0x1e6)]((_0x14a07a,_0x277ba5)=>{_0x502af5[_0x277ba5]['maxProducts']=_0x14a07a;}),_0x30f10a['forEach']((_0x288b3f,_0x194a43)=>{var _0x2bbe2b=_0x2b484e;_0x502af5[_0x194a43][_0x2bbe2b(0x293)]=_0x288b3f;}),_0x501d54[_0x2b484e(0x1e6)]((_0x40a527,_0x18da7f)=>{var _0x410c54=_0x2b484e;_0x502af5[_0x18da7f][_0x410c54(0x20f)]=_0x40a527;}),_0x3cf9b3[_0x2b484e(0x1e6)]((_0x1627e1,_0x26fcbe)=>{var _0x133c6a=_0x2b484e;_0x502af5[_0x26fcbe][_0x133c6a(0x226)]=_0x1627e1;}),_0x1be3b2[_0x2b484e(0x1e6)]((_0x17aa2c,_0x30988f)=>{var _0x3b87c0=_0x2b484e;_0x502af5[_0x30988f][_0x3b87c0(0x259)]=_0x17aa2c;}),_0x28d1f0[_0x2b484e(0x1e6)]((_0x321bcd,_0x18c8a6)=>{var _0x4462eb=_0x2b484e;_0x502af5[_0x18c8a6][_0x4462eb(0x29e)]=_0x321bcd;});const _0x31d574=await sales_finished[_0x2b484e(0x23b)]({'invoice':_0x4713d2});_0x31d574[_0x2b484e(0x1a9)]=_0x2b484e(0x1a1);const _0x19bdd5=await _0x31d574[_0x2b484e(0x257)](),_0x384157=new sales_return_finished({'invoice':_0x4713d2,'customer':_0x3e7531[_0x2b484e(0x1b7)]['customer'],'date':_0x3f767c,'warehouse_name':_0x54ec16,'room':_0x44a24d,'ToWarehouse':_0x2e9524,'ToRoom':_0x534af5,'return_sale_QA':_0x502af5,'note':_0x3328f7,'warehouse_cat':_0x20a520}),_0x1b4d68=await _0x384157[_0x2b484e(0x257)](),_0x413f4=await sales_return_finished['findOne']({'invoice':_0x4713d2}),_0xbfdccb=await warehouse[_0x2b484e(0x23b)]({'name':_0x2e9524,'room':_0x534af5});_0x413f4[_0x2b484e(0x1dc)][_0x2b484e(0x1e6)](_0x6e847d=>{var _0x1ac899=_0x2b484e,_0x5b6077=0x0;const _0x144e4b=_0xbfdccb[_0x1ac899(0x22d)]['map'](_0x12c875=>{var _0x303f9c=_0x1ac899;_0x12c875[_0x303f9c(0x1da)]==_0x6e847d[_0x303f9c(0x1da)]&&_0x12c875[_0x303f9c(0x29e)]==_0x6e847d[_0x303f9c(0x29e)]&&_0x12c875[_0x303f9c(0x259)]==_0x6e847d[_0x303f9c(0x259)]&&_0x12c875['batch_code']==_0x6e847d[_0x303f9c(0x293)]&&(_0x12c875[_0x303f9c(0x1aa)]=parseInt(_0x12c875['product_stock'])+parseInt(_0x6e847d[_0x303f9c(0x2a5)]),_0x5b6077++);});_0x5b6077=='0'&&(_0xbfdccb['product_details']=_0xbfdccb[_0x1ac899(0x22d)][_0x1ac899(0x297)]({'product_name':_0x6e847d['product_name'],'product_stock':_0x6e847d[_0x1ac899(0x2a5)],'primary_code':_0x6e847d['primary_code'],'secondary_code':_0x6e847d['secondary_code'],'product_code':_0x6e847d[_0x1ac899(0x27c)],'batch_code':_0x6e847d[_0x1ac899(0x293)],'maxPerUnit':_0x6e847d[_0x1ac899(0x1b1)],'production_date':_0x6e847d[_0x1ac899(0x259)],'expiry_date':_0x6e847d['expiry_date'],'secondary_unit':_0x6e847d[_0x1ac899(0x20f)],'unit':_0x6e847d['unit'],'maxProducts':_0x6e847d[_0x1ac899(0x213)],'bay':_0x6e847d[_0x1ac899(0x28b)]}));}),await _0xbfdccb[_0x2b484e(0x257)]();const _0x4fcfad=new c_payment_data({'invoice':_0x4713d2,'customer':_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1d4)],'reason':_0x2b484e(0x256)});await _0x4fcfad[_0x2b484e(0x257)]();const _0x477bcc=await master_shop[_0x2b484e(0x232)](),_0x3b63dd=await email_settings[_0x2b484e(0x23b)](),_0x33eb68=await customer[_0x2b484e(0x23b)]({'name':_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1d4)]});_0x477bcc[0x0][_0x2b484e(0x225)]==0x1?(right_currency=_0x477bcc[0x0][_0x2b484e(0x29c)],left_currency=''):(right_currency='',left_currency=_0x477bcc[0x0][_0x2b484e(0x29c)]);var _0x34b55f=_0x4481d7,_0x44c8a7=_0x33799a,_0x15c899='',_0x3111fc;for(_0x3111fc in _0x34b55f){_0x15c899+=_0x2b484e(0x248)+_0x2b484e(0x1fa)+_0x34b55f[_0x3111fc]+_0x2b484e(0x194)+_0x2b484e(0x1fa)+_0x44c8a7[_0x3111fc]+_0x2b484e(0x194)+'</tr>';}console['log']('product_list',_0x15c899);let _0x571937=nodemailer[_0x2b484e(0x1eb)]({'service':_0x2b484e(0x218),'auth':{'user':_0x3b63dd[_0x2b484e(0x20e)],'pass':_0x3b63dd[_0x2b484e(0x241)]}}),_0x5a011e={'from':_0x3b63dd[_0x2b484e(0x20e)],'to':_0x33eb68[_0x2b484e(0x20e)],'subject':_0x2b484e(0x1d9),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2b484e(0x260)+_0x2b484e(0x196)+_0x477bcc[0x0][_0x2b484e(0x206)],'cid':'logo'}],'html':_0x2b484e(0x240)+_0x2b484e(0x1c7)+_0x2b484e(0x1d7)+_0x2b484e(0x1af)+_0x2b484e(0x1f8)+_0x2b484e(0x1af)+_0x2b484e(0x18d)+'</div>'+_0x2b484e(0x1af)+_0x2b484e(0x1d6)+_0x477bcc[0x0][_0x2b484e(0x1ad)]+_0x2b484e(0x1be)+_0x2b484e(0x29f)+_0x2b484e(0x29f)+_0x2b484e(0x228)+'<div>'+_0x2b484e(0x23d)+_0x2b484e(0x25c)+_0x4713d2+'\x20'+_0x2b484e(0x262)+_0x2b484e(0x23c)+_0x3f767c+'\x20'+_0x2b484e(0x1bb)+_0x2b484e(0x1e7)+_0x2b484e(0x29f)+_0x2b484e(0x290)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2b484e(0x248)+_0x2b484e(0x1f3)+_0x2b484e(0x207)+_0x2b484e(0x265)+_0x2b484e(0x237)+_0x2b484e(0x245)+_0x2b484e(0x1f2)+_0x2b484e(0x270)+'\x20'+_0x15c899+'\x20'+_0x2b484e(0x298)+_0x2b484e(0x1ae)+_0x2b484e(0x1af)+_0x2b484e(0x1b4)+_0x2b484e(0x227)+_0x477bcc[0x0][_0x2b484e(0x1ad)]+_0x2b484e(0x1e7)+_0x2b484e(0x29f)+_0x2b484e(0x29f)+_0x2b484e(0x273)};_0x571937[_0x2b484e(0x238)](_0x5a011e,function(_0x4e856b,_0x141073){var _0x1facbc=_0x2b484e;_0x4e856b?(console['log'](_0x4e856b),console[_0x1facbc(0x217)]('Error\x20Occurs')):console[_0x1facbc(0x217)](_0x1facbc(0x1d8));}),_0x3e7531[_0x2b484e(0x28c)]('success',_0x2b484e(0x1b2)),_0x53cf6d['redirect'](_0x2b484e(0x279));}catch(_0x41d45e){_0x53cf6d['status'](0xc8)[_0x2b484e(0x1ca)]({'message1':_0x41d45e[_0x2b484e(0x1c2)]});}else{if(_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x24a)]=='GS')try{const {invoice:_0xe2f4c8,date:_0x568710,warehouse_name:_0x1aa82e,product_name:_0x189e1f,primary_code:_0x56aa3b,secondary_code:_0x3a1c1d,product_code:_0x17aab3,sales_quantity:_0x282f0f,stocks:_0x48d628,return_qty:_0x90d25d,Room_name:_0x22a71d,to_warehouse_name:_0x85f41d,to_Room_name:_0x4a68d4,note:_0x40a54d,level:_0x49aa9c,isle:_0x2397b3,pallet:_0x423fb9,for_categorize:_0x3c8cb4}=_0x3e7531[_0x2b484e(0x1b7)];if(typeof _0x189e1f==_0x2b484e(0x247))var _0x4481d7=[_0x3e7531[_0x2b484e(0x1b7)]['product_name']],_0x5677f4=[_0x3e7531['body'][_0x2b484e(0x275)]],_0x3837c5=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1c1)]],_0x56f372=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x27c)]],_0x43fc15=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x2a7)]],_0x33799a=[_0x3e7531['body'][_0x2b484e(0x2a5)]],_0x1dbaa5=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x28b)]],_0x48963e=[_0x3e7531['body'][_0x2b484e(0x1b1)]],_0x58a435=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x213)]],_0x30f10a=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x293)]],_0x501d54=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x20f)]],_0x3cf9b3=[_0x3e7531['body'][_0x2b484e(0x226)]],_0x1be3b2=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x259)]],_0x28d1f0=[_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x29e)]];else var _0x4481d7=[..._0x3e7531['body'][_0x2b484e(0x1da)]],_0x5677f4=[..._0x3e7531[_0x2b484e(0x1b7)]['primary_code']],_0x3837c5=[..._0x3e7531[_0x2b484e(0x1b7)]['secondary_code']],_0x56f372=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x27c)]],_0x43fc15=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x2a7)]],_0x33799a=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x2a5)]],_0x1dbaa5=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x28b)]],_0x48963e=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1b1)]],_0x58a435=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x213)]],_0x30f10a=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x293)]],_0x501d54=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x20f)]],_0x3cf9b3=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x226)]],_0x1be3b2=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x259)]],_0x28d1f0=[..._0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x29e)]];const _0x2be98b=_0x4481d7[_0x2b484e(0x277)](_0x47939b=>{return _0x47939b={'product_name':_0x47939b};});_0x5677f4[_0x2b484e(0x1e6)]((_0x569e4a,_0xb099bb)=>{_0x2be98b[_0xb099bb]['primary_code']=_0x569e4a;}),_0x3837c5['forEach']((_0x405912,_0x3d09cc)=>{var _0x246e2f=_0x2b484e;_0x2be98b[_0x3d09cc][_0x246e2f(0x1c1)]=_0x405912;}),_0x56f372[_0x2b484e(0x1e6)]((_0x356292,_0x4d5a99)=>{var _0x45b964=_0x2b484e;_0x2be98b[_0x4d5a99][_0x45b964(0x27c)]=_0x356292;}),_0x43fc15['forEach']((_0x2f9207,_0x1b33c0)=>{var _0x465e89=_0x2b484e;_0x2be98b[_0x1b33c0][_0x465e89(0x23e)]=_0x2f9207;}),_0x33799a[_0x2b484e(0x1e6)]((_0x417bad,_0x4c622c)=>{_0x2be98b[_0x4c622c]['return_qty']=_0x417bad;}),_0x1dbaa5[_0x2b484e(0x1e6)]((_0x2812ea,_0x3aa7ed)=>{var _0x2fea35=_0x2b484e;_0x2be98b[_0x3aa7ed][_0x2fea35(0x28b)]=_0x2812ea;}),_0x48963e[_0x2b484e(0x1e6)]((_0x3970a9,_0x126cfb)=>{var _0x390fe8=_0x2b484e;_0x2be98b[_0x126cfb][_0x390fe8(0x1b1)]=_0x3970a9;}),_0x58a435[_0x2b484e(0x1e6)]((_0x44c58f,_0x53bc70)=>{var _0x46e964=_0x2b484e;_0x2be98b[_0x53bc70][_0x46e964(0x213)]=_0x44c58f;}),_0x30f10a[_0x2b484e(0x1e6)]((_0x4f69bf,_0x233955)=>{var _0x11ffe4=_0x2b484e;_0x2be98b[_0x233955][_0x11ffe4(0x293)]=_0x4f69bf;}),_0x501d54['forEach']((_0x2298bf,_0x2dcdc4)=>{var _0x171f64=_0x2b484e;_0x2be98b[_0x2dcdc4][_0x171f64(0x20f)]=_0x2298bf;}),_0x3cf9b3[_0x2b484e(0x1e6)]((_0x13a34f,_0x1fa12d)=>{var _0x3ed56c=_0x2b484e;_0x2be98b[_0x1fa12d][_0x3ed56c(0x226)]=_0x13a34f;}),_0x1be3b2['forEach']((_0x404433,_0x36a790)=>{var _0x528214=_0x2b484e;_0x2be98b[_0x36a790][_0x528214(0x259)]=_0x404433;}),_0x28d1f0['forEach']((_0x5880b3,_0x1268b2)=>{_0x2be98b[_0x1268b2]['expiry_date']=_0x5880b3;});var _0x3ef753=0x0;_0x2be98b[_0x2b484e(0x1e6)](_0x548c6b=>{var _0x2a14e8=_0x2b484e;(parseInt(_0x548c6b[_0x2a14e8(0x23e)])<parseInt(_0x548c6b[_0x2a14e8(0x2a5)])||parseInt(_0x548c6b[_0x2a14e8(0x191)])<parseInt(_0x548c6b[_0x2a14e8(0x2a5)])&&parseInt(_0x548c6b['sale_qty'])>parseInt(_0x548c6b[_0x2a14e8(0x2a5)])||parseInt(_0x548c6b[_0x2a14e8(0x2a5)])==0x0)&&_0x3ef753++;});if(_0x3ef753!=0x0)return _0x3e7531['flash']('errors',_0x2b484e(0x1e9)),_0x53cf6d['redirect'](_0x2b484e(0x22b));const _0x13156c=await sales_finished[_0x2b484e(0x23b)]({'invoice':_0xe2f4c8});_0x13156c[_0x2b484e(0x1a9)]=_0x2b484e(0x1a1);const _0x149635=await _0x13156c['save'](),_0x1e39d4=new sales_return_finished({'invoice':_0xe2f4c8,'customer':_0x3e7531[_0x2b484e(0x1b7)]['customer'],'date':_0x568710,'warehouse_name':_0x1aa82e,'room':_0x22a71d,'ToWarehouse':_0x85f41d,'ToRoom':_0x4a68d4,'return_sale':_0x2be98b,'note':_0x40a54d,'warehouse_cat':_0x3c8cb4}),_0xf40426=await _0x1e39d4[_0x2b484e(0x257)](),_0x117177=await sales_return_finished['findOne']({'invoice':_0xe2f4c8}),_0x104d87=await warehouse[_0x2b484e(0x23b)]({'name':_0x85f41d,'room':_0x4a68d4,'warehouse_category':_0x2b484e(0x26f)});_0x117177['return_sale'][_0x2b484e(0x1e6)](_0x2871f2=>{var _0x83992=_0x2b484e,_0x52dc96=0x0;const _0x3ec616=_0x104d87[_0x83992(0x22d)][_0x83992(0x277)](_0x56d150=>{var _0x4e30bb=_0x83992;_0x56d150['product_name']==_0x2871f2[_0x4e30bb(0x1da)]&&_0x56d150[_0x4e30bb(0x28b)]==_0x2871f2['bay']&&_0x56d150['expiry_date']==_0x2871f2[_0x4e30bb(0x29e)]&&_0x56d150['production_date']==_0x2871f2[_0x4e30bb(0x259)]&&_0x56d150['batch_code']==_0x2871f2[_0x4e30bb(0x293)]&&(_0x56d150['product_stock']=parseInt(_0x56d150['product_stock'])+parseInt(_0x2871f2[_0x4e30bb(0x2a5)]),_0x52dc96++);});_0x52dc96=='0'&&(_0x104d87[_0x83992(0x22d)]=_0x104d87['product_details'][_0x83992(0x297)]({'product_name':_0x2871f2['product_name'],'product_stock':_0x2871f2[_0x83992(0x2a5)],'primary_code':_0x2871f2[_0x83992(0x275)],'secondary_code':_0x2871f2['secondary_code'],'product_code':_0x2871f2[_0x83992(0x27c)],'bay':_0x2871f2[_0x83992(0x28b)],'batch_code':_0x2871f2[_0x83992(0x293)],'maxPerUnit':_0x2871f2[_0x83992(0x1b1)],'production_date':_0x2871f2['production_date'],'expiry_date':_0x2871f2[_0x83992(0x29e)],'secondary_unit':_0x2871f2[_0x83992(0x20f)],'unit':_0x2871f2['unit'],'maxProducts':_0x2871f2['maxProducts']}));}),await _0x104d87[_0x2b484e(0x257)](),console[_0x2b484e(0x217)](_0x3e7531[_0x2b484e(0x1b7)]);const _0x11cfff=new c_payment_data({'invoice':_0xe2f4c8,'customer':_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1d4)],'reason':_0x2b484e(0x256)});await _0x11cfff[_0x2b484e(0x257)]();const _0x309d12=await master_shop['find']();console[_0x2b484e(0x217)](_0x2b484e(0x1a3),_0x309d12[0x0][_0x2b484e(0x206)]);const _0x54035a=await email_settings[_0x2b484e(0x23b)](),_0x521567=await customer[_0x2b484e(0x23b)]({'name':_0x3e7531[_0x2b484e(0x1b7)][_0x2b484e(0x1d4)]});console['log']('customer_data',_0x521567);_0x309d12[0x0][_0x2b484e(0x225)]==0x1?(right_currency=_0x309d12[0x0][_0x2b484e(0x29c)],left_currency=''):(right_currency='',left_currency=_0x309d12[0x0][_0x2b484e(0x29c)]);var _0x34b55f=_0x4481d7,_0x44c8a7=_0x33799a,_0x15c899='',_0x3111fc;for(_0x3111fc in _0x34b55f){_0x15c899+=_0x2b484e(0x248)+_0x2b484e(0x1fa)+_0x34b55f[_0x3111fc]+_0x2b484e(0x194)+_0x2b484e(0x1fa)+_0x44c8a7[_0x3111fc]+_0x2b484e(0x194)+_0x2b484e(0x245);}console['log']('product_list',_0x15c899);let _0x5c11a8=nodemailer[_0x2b484e(0x1eb)]({'service':'gmail','auth':{'user':_0x54035a['email'],'pass':_0x54035a[_0x2b484e(0x241)]}}),_0x384731={'from':_0x54035a[_0x2b484e(0x20e)],'to':_0x521567[_0x2b484e(0x20e)],'subject':_0x2b484e(0x1d9),'attachments':[{'filename':_0x2b484e(0x250),'path':__dirname+_0x2b484e(0x260)+_0x2b484e(0x196)+_0x309d12[0x0][_0x2b484e(0x206)],'cid':_0x2b484e(0x22f)}],'html':'<!DOCTYPE\x20html>'+_0x2b484e(0x1c7)+_0x2b484e(0x1d7)+_0x2b484e(0x1af)+_0x2b484e(0x1f8)+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2b484e(0x29f)+_0x2b484e(0x1af)+_0x2b484e(0x1d6)+_0x309d12[0x0][_0x2b484e(0x1ad)]+_0x2b484e(0x1be)+_0x2b484e(0x29f)+_0x2b484e(0x29f)+_0x2b484e(0x228)+'<div>'+_0x2b484e(0x23d)+_0x2b484e(0x25c)+_0xe2f4c8+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2b484e(0x23c)+_0x568710+'\x20'+_0x2b484e(0x1bb)+_0x2b484e(0x1e7)+_0x2b484e(0x29f)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2b484e(0x295)+_0x2b484e(0x248)+_0x2b484e(0x1f3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x2b484e(0x237)+_0x2b484e(0x245)+_0x2b484e(0x1f2)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x15c899+'\x20'+'</tbody>'+_0x2b484e(0x1ae)+_0x2b484e(0x1af)+_0x2b484e(0x1b4)+_0x2b484e(0x227)+_0x309d12[0x0]['site_title']+_0x2b484e(0x1e7)+_0x2b484e(0x29f)+_0x2b484e(0x29f)+'</body></html>'};_0x5c11a8['sendMail'](_0x384731,function(_0x58ad62,_0x2ab3e4){var _0x411303=_0x2b484e;_0x58ad62?(console[_0x411303(0x217)](_0x58ad62),console['log'](_0x411303(0x198))):console[_0x411303(0x217)](_0x411303(0x1d8));}),_0x3e7531[_0x2b484e(0x28c)]('success',_0x2b484e(0x1b2)),_0x53cf6d['redirect']('/all_sales_finished/view');}catch(_0x348056){console[_0x2b484e(0x217)](_0x348056),_0x53cf6d[_0x2b484e(0x212)](0xc8)[_0x2b484e(0x1ca)]({'message1':_0x348056['message']});}}}),router['get']('/barcode/:id',auth,async(_0x1d74ed,_0x19505f)=>{var _0x5d2d88=a0_0x4e9c7a;try{const {username:_0x53a545,email:_0x8d6f5c,role:_0x500de0}=_0x1d74ed['user'],_0x1920d3=_0x1d74ed[_0x5d2d88(0x299)],_0x38a82f=await profile[_0x5d2d88(0x23b)]({'email':_0x1920d3[_0x5d2d88(0x20e)]}),_0x2177c0=await master_shop[_0x5d2d88(0x232)]();console['log'](_0x5d2d88(0x268),_0x2177c0);const _0xb90583=_0x1d74ed['params']['id'],_0x56ff18=await sales['findById'](_0xb90583);console[_0x5d2d88(0x217)]('barcode\x20user_id',_0x56ff18);if(_0x2177c0[0x0][_0x5d2d88(0x1d5)]==_0x5d2d88(0x1e1))var _0x528ad0=users[_0x5d2d88(0x291)];else{if(_0x2177c0[0x0][_0x5d2d88(0x1d5)]=='Hindi')var _0x528ad0=users[_0x5d2d88(0x20a)];else{if(_0x2177c0[0x0][_0x5d2d88(0x1d5)]==_0x5d2d88(0x224))var _0x528ad0=users['German'];else{if(_0x2177c0[0x0][_0x5d2d88(0x1d5)]==_0x5d2d88(0x26e))var _0x528ad0=users['Spanish'];else{if(_0x2177c0[0x0]['language']==_0x5d2d88(0x19c))var _0x528ad0=users[_0x5d2d88(0x19c)];else{if(_0x2177c0[0x0][_0x5d2d88(0x1d5)]=='Portuguese\x20(BR)')var _0x528ad0=users[_0x5d2d88(0x243)];else{if(_0x2177c0[0x0][_0x5d2d88(0x1d5)]==_0x5d2d88(0x261))var _0x528ad0=users['Chinese'];else{if(_0x2177c0[0x0]['language']==_0x5d2d88(0x197))var _0x528ad0=users[_0x5d2d88(0x263)];}}}}}}}_0x19505f[_0x5d2d88(0x216)]('all_sales_barcode',{'success':_0x1d74ed[_0x5d2d88(0x28c)]('success'),'errors':_0x1d74ed[_0x5d2d88(0x28c)]('errors'),'role':_0x1920d3,'profile':_0x38a82f,'alldata':_0x56ff18,'master_shop':_0x2177c0,'language':_0x528ad0});}catch(_0x1c902a){console[_0x5d2d88(0x217)](_0x1c902a);}}),router['post'](a0_0x4e9c7a(0x22c),async(_0x42a57d,_0x552fd2)=>{var _0x270a97=a0_0x4e9c7a;const {product_code:_0x4289ce,warehouse_name:_0xe44bd5,rooms_data:_0x4f2f7c,Roomslist:_0x446c9a}=_0x42a57d[_0x270a97(0x1b7)],_0x1faaf2=_0x446c9a[_0x270a97(0x219)](','),_0x4ab566=[];async function _0x802aca(_0x1a7075){var _0x5519ef=_0x270a97;const _0x1e1561=await warehouse[_0x5519ef(0x264)]([{'$match':{'name':_0xe44bd5,'room':_0x1a7075}},{'$unwind':_0x5519ef(0x282)},{'$match':{'product_details.primary_code':_0x4289ce}},{'$group':{'_id':_0x5519ef(0x1ea),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5519ef(0x1ec)},'primary_code':{'$first':_0x5519ef(0x1c6)},'secondary_code':{'$first':_0x5519ef(0x27d)},'product_code':{'$first':_0x5519ef(0x274)},'level':{'$first':_0x5519ef(0x1cc)},'isle':{'$first':_0x5519ef(0x29d)},'type':{'$first':_0x5519ef(0x1b9)},'pallet':{'$first':_0x5519ef(0x28e)},'unit':{'$first':_0x5519ef(0x21c)},'secondary_unit':{'$first':_0x5519ef(0x21e)},'storage':{'$first':_0x5519ef(0x253)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x5519ef(0x294)},'product_cat':{'$first':_0x5519ef(0x27b)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x5519ef(0x255)},'invoice':{'$first':_0x5519ef(0x1f0)}}}]),_0x5ce8f0=await warehouse['aggregate']([{'$match':{'name':_0xe44bd5,'room':_0x1a7075}},{'$unwind':_0x5519ef(0x282)},{'$match':{'product_details.secondary_code':_0x4289ce}},{'$group':{'_id':_0x5519ef(0x1ea),'name':{'$first':_0x5519ef(0x205)},'product_stock':{'$first':_0x5519ef(0x1ec)},'primary_code':{'$first':_0x5519ef(0x1c6)},'secondary_code':{'$first':_0x5519ef(0x27d)},'product_code':{'$first':_0x5519ef(0x274)},'level':{'$first':_0x5519ef(0x1cc)},'isle':{'$first':_0x5519ef(0x29d)},'type':{'$first':_0x5519ef(0x1b9)},'pallet':{'$first':_0x5519ef(0x28e)},'unit':{'$first':_0x5519ef(0x21c)},'secondary_unit':{'$first':_0x5519ef(0x21e)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5519ef(0x1b6)},'expiry_date':{'$first':_0x5519ef(0x1a2)},'production_date':{'$first':_0x5519ef(0x1c0)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x5519ef(0x27b)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5519ef(0x255)},'invoice':{'$first':_0x5519ef(0x1f0)}}}]);if(_0x1e1561[_0x5519ef(0x21b)]>0x0)_0x4ab566[_0x5519ef(0x1a6)](_0x1e1561);else _0x5ce8f0[_0x5519ef(0x21b)]>0x0&&_0x4ab566[_0x5519ef(0x1a6)](_0x5ce8f0);}const _0x3ff394=_0x1faaf2[_0x270a97(0x277)](_0x3df50c=>_0x802aca(_0x3df50c));await Promise[_0x270a97(0x1f6)](_0x3ff394),_0x552fd2[_0x270a97(0x1ca)](_0x4ab566);}),module[a0_0x4e9c7a(0x24d)]=router;function a0_0x3786(){var _0x1319e4=['maxPerUnit_QA','$sale_product.floorlevel','adjust_qty','stock_data','True','$product_details.expiry_date','add\x20post','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','../models/all_models','push','max_per_unit','1813920nFmzLx','return_data','product_stock','$finalize','$warehouse_name','site_title','</table>','<div>','69578PzPMFZ','maxPerUnit','sales\x20item\x20return\x20successfull','../public/language/languages.json','<strong>\x20Regards\x20</strong>','$product','$product_details.rack','body','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.type','christian.villamer@jakagroup.com','</span>','get','abs','\x20</h2>','amount','$product_details.production_date','secondary_code','message','\x20<<<==>>>\x20','stocks_QA','Enabled','$product_details.primary_code','<html><head><title></title>','$product_details.maxPerUnit','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','json','staff','$product_details.bay','Sales\x20Add\x20successfully','/preview/:id','Sales\x20Update\x20successfully','328MvPXCg','RoomAssigned','params','prod_code','customer','language','<h2>\x20','</head><body>','Email\x20sent\x20successfully','Sale\x20Return\x20Mail','product_name','sale_product','return_sale_QA','production_date_QA','due_amount','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','primary_code_QA','English\x20(US)','535638HCRceb','product_data','maxperunit','primary_unit','forEach','</h5>','getMonth','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$product_details._id','createTransport','$product_details.product_stock','express','$note','maxProducts_QA','$product_details.invoice','master','</thead>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Return\x20Rooms','then','all','suppliers','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','host','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','539550sBLBoc','$sale_product.quantity','/invoice/:id','DRY\x20GOODS','Received\x20Payment\x20For\x20Sale','quantity','product_date','/give_payment/:id','Router','product_code_QA','$product_details.product_name','image','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','slice','Hindi','return_qty_QA','389683zXVQEA','$sale_product.bin','email','secondary_unit','product_list','$_id','status','maxProducts','received_amount','$product_details.maxProducts','render','log','gmail','split','Sale','length','$product_details.unit','unit_QA','$product_details.secondary_unit','secondary_code_QA','2TdeMIK','room_name','sales_quantity_QA','purchases_data','German','currency_placement','unit','<h5>','<hr\x20class=\x22my-3\x22>','expiry_date_QA','return_sale_finished','back','/barcode_scanner','product_details','role','logo','port','$customers_docs','find','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','success','QA\x20Warehouse','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','sendMail','620100cwSygp','product','findOne','\x20Order\x20Date\x20:\x20','<h5\x20style=\x22text-align:\x20left;\x22>','sale_qty','invoice','<!DOCTYPE\x20html>','password','findById','Portuguese','$product_details.room_name','</tr>','filter','string','<tr>','24SDFnDk','for_categorize','sales_invoice','catch','exports','id_transaction_from','Sales\x20Mail','Logo.png','redirect','An\x20error\x20occurred.','$product_details.storage','warehouse_name','$room','Sale\x20Return','save','_id','production_date','\x20==\x20','customers','\x20Order\x20Number\x20:\x20','/picking_list/pdf/','Quality\x20Inspection','$date','/../public','Chinese','<span\x20style=\x22float:\x20right;\x22>','Arabic','aggregate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','An\x20error\x20occurred\x20while\x20saving\x20data.','prod_cat','barcode\x20Product\x20master','name','/all_sales/view','\x20&&\x20','8105CATSLh','warehouse','Spanish','Finished\x20Goods','<tbody\x20style=\x22text-align:\x20center;\x22>','room','OUTF-','</body></html>','$product_details.product_code','primary_code','errors','map','/view/add_sale/product','/all_sales_finished/view','$return_data','$product_details.product_cat','product_code','$product_details.secondary_code','FGSEmail','max','prod_invoice','all_sales_finished','$product_details','Enclosed','../middleware/auth','note','secondary_unit_QA','foreach\x20newproduct','Portuguese\x20(BR)','ADD\x20SALE','False','bay','flash','$customer','$product_details.floorlevel','$name','<table\x20style=\x22width:\x20100%\x20!important;\x22>','English','getDate','batch_code','$product_details.batch_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$sale_product.bay','concat','</tbody>','user','random','date','currency','$product_details.bin','expiry_date','</div>','getFullYear','final','$invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/all_sales_finished/preview/','return_qty','/view/add_sales/:id','sales_quantity','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','product_name_QA1','floor','carton','stock','post','Add\x20Sales','</td>','level','/upload/','Arabic\x20(ae)','Error\x20Occurs','payment\x20successfull','padStart','/view/add_sales','French'];a0_0x3786=function(){return _0x1319e4;};return a0_0x3786();}