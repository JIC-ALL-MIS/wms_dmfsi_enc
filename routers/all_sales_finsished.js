var a0_0x275e41=a0_0x560b;(function(_0x2ea8c7,_0x874d12){var _0x1543f5=a0_0x560b,_0x5a69bd=_0x2ea8c7();while(!![]){try{var _0x379e3d=-parseInt(_0x1543f5(0x191))/0x1+parseInt(_0x1543f5(0x129))/0x2+parseInt(_0x1543f5(0x18f))/0x3+-parseInt(_0x1543f5(0x1df))/0x4*(-parseInt(_0x1543f5(0x17e))/0x5)+parseInt(_0x1543f5(0x15b))/0x6*(-parseInt(_0x1543f5(0x164))/0x7)+-parseInt(_0x1543f5(0xf9))/0x8+parseInt(_0x1543f5(0x1c2))/0x9;if(_0x379e3d===_0x874d12)break;else _0x5a69bd['push'](_0x5a69bd['shift']());}catch(_0x31648e){_0x5a69bd['push'](_0x5a69bd['shift']());}}}(a0_0x6171,0xac8c5));const express=require(a0_0x275e41(0x12a)),app=express(),router=express[a0_0x275e41(0x1de)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x275e41(0x13c)),auth=require('../middleware/auth'),nodemailer=require(a0_0x275e41(0x19e)),users=require('../public/language/languages.json');router['get'](a0_0x275e41(0x1cd),auth,async(_0x4e8611,_0x1e2a02)=>{var _0x1050b7=a0_0x275e41;try{const {username:_0x42c190,email:_0xf29945,role:_0x1f3f4f}=_0x4e8611[_0x1050b7(0x11a)],_0x24818c=_0x4e8611[_0x1050b7(0x11a)],_0x297538=await profile[_0x1050b7(0x180)]({'email':_0x24818c[_0x1050b7(0x1bc)]}),_0xf19676=await master_shop['find']();let _0x21e228;if(_0x24818c[_0x1050b7(0x13a)]==_0x1050b7(0x1e6)){const _0x5c142c=await staff['findOne']({'email':_0x24818c[_0x1050b7(0x1bc)]});_0x21e228=await sales_finished[_0x1050b7(0x1a3)]([{'$lookup':{'from':_0x1050b7(0xfa),'localField':_0x1050b7(0xec),'foreignField':_0x1050b7(0x1a5),'as':_0x1050b7(0x1a9)}},{'$unwind':_0x1050b7(0x183)},{'$unwind':_0x1050b7(0x1dc)},{'$group':{'_id':_0x1050b7(0x1cc),'invoice':{'$first':_0x1050b7(0x1e7)},'customers':{'$first':'$customer'},'date':{'$first':_0x1050b7(0x115)},'warehouse_name':{'$first':_0x1050b7(0x114)},'sale_product':{'$push':_0x1050b7(0x1dc)},'note':{'$first':'$note'},'return_data':{'$first':_0x1050b7(0x134)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x1050b7(0x176)},'level':{'$addToSet':_0x1050b7(0xe7)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x1050b7(0xe4)},'pallet':{'$addToSet':_0x1050b7(0x1ea)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x21e228=await sales_finished[_0x1050b7(0x1a3)]([{'$lookup':{'from':_0x1050b7(0xfa),'localField':_0x1050b7(0xec),'foreignField':_0x1050b7(0x1a5),'as':_0x1050b7(0x1a9)}},{'$unwind':'$customers_docs'},{'$unwind':'$sale_product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x1050b7(0x1e7)},'customers':{'$first':_0x1050b7(0x1bb)},'date':{'$first':_0x1050b7(0x115)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x1050b7(0x1dc)},'note':{'$first':_0x1050b7(0x18a)},'return_data':{'$first':_0x1050b7(0x134)},'customers_docs':{'$first':_0x1050b7(0x183)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x1050b7(0xe7)},'isle':{'$addToSet':_0x1050b7(0x17d)},'type':{'$addToSet':_0x1050b7(0xe4)},'pallet':{'$addToSet':_0x1050b7(0x1ea)},'finalize':{'$first':_0x1050b7(0x19f)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0xf19676[0x0][_0x1050b7(0x1ec)]=='English\x20(US)'){var _0x5efb75=users['English'];console[_0x1050b7(0x168)](_0x5efb75);}else{if(_0xf19676[0x0]['language']==_0x1050b7(0x14c))var _0x5efb75=users['Hindi'];else{if(_0xf19676[0x0][_0x1050b7(0x1ec)]==_0x1050b7(0x159))var _0x5efb75=users[_0x1050b7(0x159)];else{if(_0xf19676[0x0]['language']=='Spanish')var _0x5efb75=users[_0x1050b7(0x19d)];else{if(_0xf19676[0x0][_0x1050b7(0x1ec)]==_0x1050b7(0x18b))var _0x5efb75=users[_0x1050b7(0x18b)];else{if(_0xf19676[0x0][_0x1050b7(0x1ec)]==_0x1050b7(0x193))var _0x5efb75=users[_0x1050b7(0x127)];else{if(_0xf19676[0x0]['language']=='Chinese')var _0x5efb75=users['Chinese'];else{if(_0xf19676[0x0][_0x1050b7(0x1ec)]==_0x1050b7(0x135))var _0x5efb75=users[_0x1050b7(0x1d9)];}}}}}}}_0x1e2a02['render'](_0x1050b7(0x1a4),{'success':_0x4e8611[_0x1050b7(0x1cf)](_0x1050b7(0x1ca)),'errors':_0x4e8611['flash']('errors'),'sales':_0x21e228,'profile':_0x297538,'role':_0x24818c,'master_shop':_0xf19676,'language':_0x5efb75});}catch(_0x234fe1){console[_0x1050b7(0x168)](_0x234fe1);}});function a0_0x6171(){var _0x4d1717=['product_name','suppliers','edit_sales_finished','maxPerUnit_QA','Spanish','nodemailer','$finalize','room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','OUTF-','aggregate','all_sales_finished','name','$product_details.production_date','production_date','errors','customers_docs','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','currency_placement','$product','return_data','$product_details.product_stock','Sale','then','/give_payment/:id','status','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/upload/','createTransport','quantity','True','</head><body>','sales_quantity_QA','$customer','email','$product_details.bin','English','Return\x20Goods','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','2091483tkrkzw','<h2>\x20','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','map','<h5\x20style=\x22text-align:\x20left;\x22>','stocks_QA','unit','toString','success','host','$_id','/view','params','flash','string','batch_code_QA','FGSEmail','\x20Order\x20Number\x20:\x20','</body></html>','/all_sales_finished/view','$product_details.floorlevel','product_data','product_code_QA','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.product_cat','$sale_product','</thead>','Router','10628UxKArG','$product_details.type','$product_details.rack','$product_details.unit','random','max_per_unit','product_code','staff','$invoice','</div>','False','$sale_product.floorlevel','secondary_code_QA','language','floor','Sale\x20Return','RoomAssigned','maxProducts_QA','Sale\x20Return\x20Mail','sale_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','/all_sales_finished/preview/','<tr>','primary_code','$product_details.product_name','$sale_product.type','Chinese','Sales\x20Update\x20successfully','$sale_product.bay','sales_quantity','port','There\x27s\x20a\x20error\x20in\x20this\x20transaction','secondary_unit_QA','customer','logo','site_title','Sales\x20Add\x20successfully','/view/add_sales','redirect','abs','add_sales_finished','bay','Error\x20Occurs','return_qty_QA','/picking_list/pdf/','Email\x20sent\x20successfully','7875456Rtyydb','customers','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','</tr>','Quality\x20Inspection','all_sales_barcode','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','secondary_code','padStart','warehouse','Sales\x20Mail','product_details','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','Sale\x20Product\x20Mail','</td>','prod_cat','</span>','product_date','finalize','final','post','$product_details.secondary_unit','getMonth','for_categorize','body','production_date_QA','level','$warehouse_name','$date','secondary_unit','get','back','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','user','$product_details.invoice','sales\x20item\x20return\x20successfull','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','product_name_QA1','findById','English\x20(US)','return_sale_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','getFullYear','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.bay','warehouse_name','Portuguese','all','1952028USIXSK','express','maxperunit','return_sale','QA\x20Warehouse','$product_details.secondary_code','barcode\x20Product\x20master','product_stock','$product_details.primary_code','purchases_data','sale_product','$return_data','Arabic\x20(ae)','date','</table>','$product_details','adjust_qty','role','due_amount','../models/all_models','_id','$product_details._id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','save','$room','invoice','return_qty','</h5>','currency','expiry_date','expiry_date_QA','note','barcode\x20user_id','concat','\x20</h2>','Hindi','An\x20error\x20occurred.','catch','/all_sales/view','product_list','forEach','Finished\x20Goods','/preview/:id','<tbody\x20style=\x22text-align:\x20center;\x22>','\x20<>\x20','Enclosed','<span\x20style=\x22float:\x20right;\x22>','length','German','$name','820632qgSHtG','/barcode/:id','error','\x20Order\x20Date\x20:\x20','</tbody>','render','$product_details.maxPerUnit','prod_code','maxProducts','7czajsF','sendMail','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','return_sale_finished','log','DRY\x20GOODS','Enabled','$product_details.storage','exports','/view/add_sales/:id','<!DOCTYPE\x20html>','add\x20post','primary_unit','<div>','room_name','<h5>','slice','password','$sale_product.quantity','stock','Ambient','<hr\x20class=\x22my-3\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','received_amount','$product_details.expiry_date','$sale_product.bin','2015SiZybb','customer_data','findOne','find','unit_QA','$customers_docs','json','message','/view/return_sales/:id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','maxPerUnit','/invoice/:id','$note','French','master','gmail','getDate','785805RHEPtg','batch_code','713146pXgNfO','<strong>\x20Regards\x20</strong>','Portuguese\x20(BR)','/../public','Logo.png','$product_details.batch_code','image','stock_data'];a0_0x6171=function(){return _0x4d1717;};return a0_0x6171();}function a0_0x560b(_0x3187a5,_0x406045){var _0x6171e0=a0_0x6171();return a0_0x560b=function(_0x560b42,_0x186ce1){_0x560b42=_0x560b42-0xda;var _0x3dde88=_0x6171e0[_0x560b42];return _0x3dde88;},a0_0x560b(_0x3187a5,_0x406045);}async function getRandom8DigitNumber(){var _0x18251c=a0_0x275e41;const _0x416bb5=0x989680,_0x1cc5ad=0x5f5e0ff,_0x31b923=Math[_0x18251c(0x1ed)](Math[_0x18251c(0x1e3)]()*(_0x1cc5ad-_0x416bb5+0x1))+_0x416bb5;var _0x251189;const _0x28052c=await sales_finished['findOne']({'invoice':_0x18251c(0x1a2)+_0x31b923});return _0x28052c&&_0x28052c['length']>0x0?_0x251189=_0x18251c(0x1a2)+_0x31b923:_0x251189=_0x18251c(0x1a2)+_0x31b923,_0x251189;}router[a0_0x275e41(0x117)](a0_0x275e41(0xf0),auth,async(_0x207a78,_0x4e1011)=>{var _0x225534=a0_0x275e41;try{const {username:_0x409cb8,email:_0x4f75fc,role:_0x4ebe13}=_0x207a78[_0x225534(0x11a)],_0x1d9a05=_0x207a78['user'],_0x356073=await profile[_0x225534(0x180)]({'email':_0x1d9a05[_0x225534(0x1bc)]}),_0x3ab0cf=await master_shop[_0x225534(0x181)](),_0xcb1cb3=await customer['find']({});let _0x2b10c1;if(_0x1d9a05[_0x225534(0x13a)]==_0x225534(0x1e6)){const _0x147c2c=await staff[_0x225534(0x180)]({'email':_0x1d9a05[_0x225534(0x1bc)]});_0x2b10c1=await warehouse['aggregate']([{'$match':{'status':_0x225534(0x16a),'name':_0x147c2c[_0x225534(0x102)],'warehouse_category':_0x225534(0x152),'name':{'$ne':_0x225534(0x12d)}}},{'$group':{'_id':'$name','name':{'$first':_0x225534(0x15a)}}},{'$sort':{'name':0x1}}]);}else _0x2b10c1=await warehouse[_0x225534(0x1a3)]([{'$match':{'status':_0x225534(0x16a),'warehouse_category':_0x225534(0x152),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x175254=await product[_0x225534(0x181)]({});var _0x46e520=[_0x225534(0x178),_0x225534(0x156)];const _0x9f56ff=await sales_finished[_0x225534(0x181)]({}),_0x43ca29=_0x9f56ff['length']+0x1,_0x4e5d90=_0x225534(0x1a2)+_0x43ca29[_0x225534(0x1c9)]()[_0x225534(0x101)](0x5,'0');if(_0x3ab0cf[0x0][_0x225534(0x1ec)]==_0x225534(0x120)){var _0x45d442=users['English'];console[_0x225534(0x168)](_0x45d442);}else{if(_0x3ab0cf[0x0]['language']=='Hindi')var _0x45d442=users['Hindi'];else{if(_0x3ab0cf[0x0][_0x225534(0x1ec)]=='German')var _0x45d442=users[_0x225534(0x159)];else{if(_0x3ab0cf[0x0][_0x225534(0x1ec)]==_0x225534(0x19d))var _0x45d442=users[_0x225534(0x19d)];else{if(_0x3ab0cf[0x0][_0x225534(0x1ec)]==_0x225534(0x18b))var _0x45d442=users[_0x225534(0x18b)];else{if(_0x3ab0cf[0x0]['language']==_0x225534(0x193))var _0x45d442=users[_0x225534(0x127)];else{if(_0x3ab0cf[0x0]['language']==_0x225534(0xe5))var _0x45d442=users['Chinese'];else{if(_0x3ab0cf[0x0]['language']==_0x225534(0x135))var _0x45d442=users[_0x225534(0x1d9)];}}}}}}}const _0x3282ef=getRandom8DigitNumber();_0x3282ef[_0x225534(0x1b1)](_0x56f11c=>{var _0x157f88=_0x225534;_0x4e1011[_0x157f88(0x160)](_0x157f88(0xf3),{'success':_0x207a78[_0x157f88(0x1cf)](_0x157f88(0x1ca)),'errors':_0x207a78[_0x157f88(0x1cf)](_0x157f88(0x1a8)),'role':_0x1d9a05,'profile':_0x356073,'customer':_0xcb1cb3,'warehouse':_0x2b10c1,'product':_0x175254,'invoice':_0x56f11c,'master_shop':_0x3ab0cf,'language':_0x45d442,'rooms_data':_0x46e520});})[_0x225534(0x14e)](_0x457725=>{var _0x1c13ff=_0x225534;_0x207a78[_0x1c13ff(0x1cf)](_0x1c13ff(0x1a8),_0x1c13ff(0xea)),_0x4e1011[_0x1c13ff(0xf1)](_0x1c13ff(0x1d5));});}catch(_0x39ec2f){console[_0x225534(0x168)](_0x39ec2f);}}),router[a0_0x275e41(0x117)](a0_0x275e41(0x16d),auth,async(_0x51d8ef,_0x1b162a)=>{var _0x5c42c0=a0_0x275e41;try{const _0x3eaef5=_0x51d8ef[_0x5c42c0(0x1ce)]['id'];console[_0x5c42c0(0x168)](_0x3eaef5);const _0x25e1b1=await product[_0x5c42c0(0x181)](),_0x4d4f8a=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3eaef5}},{'$unwind':_0x5c42c0(0x1ad)},{'$group':{'_id':'$product.product_name'}}]);console[_0x5c42c0(0x168)](_0x5c42c0(0x132),_0x4d4f8a),_0x1b162a[_0x5c42c0(0x1b3)](0xc8)[_0x5c42c0(0x184)]({'purchases_data':_0x4d4f8a,'product_data':_0x25e1b1});}catch(_0x486edd){console[_0x5c42c0(0x168)](_0x486edd);}}),router[a0_0x275e41(0x10d)]('/view/add_sale/product',auth,async(_0x175368,_0x28291e)=>{var _0x28add1=a0_0x275e41;try{const {warehouse_data:_0x1ab6e5,product_data:_0x582a46}=_0x175368[_0x28add1(0x111)];console['log'](_0x175368[_0x28add1(0x111)][_0x28add1(0x1d7)]);;const _0x3c5748=await master_shop['find']();console[_0x28add1(0x168)](_0x28add1(0x18c),_0x3c5748);const _0x1fa1c3=await product[_0x28add1(0x180)]({'name':_0x582a46});console[_0x28add1(0x168)]('product',_0x1fa1c3);const _0x44b012=await warehouse['aggregate']([{'$match':{'name':_0x1ab6e5}},{'$unwind':_0x28add1(0x138)},{'$match':{'product_details.product_name':_0x582a46}},{'$group':{'_id':_0x28add1(0xe3),'product_stock':{'$first':_0x28add1(0x1af)}}}]);console[_0x28add1(0x168)](_0x28add1(0x198),_0x44b012),_0x28291e[_0x28add1(0x1b3)](0xc8)[_0x28add1(0x184)]({'master':_0x3c5748,'new_product':_0x1fa1c3,'stock_data':_0x44b012});}catch(_0x1762ca){console[_0x28add1(0x168)](_0x1762ca);}}),router['post'](a0_0x275e41(0xf0),auth,async(_0x2527ea,_0x4156ad)=>{var _0x4e797f=a0_0x275e41;try{const {invoice:_0x2c3922,date:_0x341535,warehouse_name:_0x2971dc,product_name:_0xb21e61,stock:_0x285347,quantity:_0x57ac15,note:_0x3f3433,room:_0x5125d3,primary_code:_0x47d700,secondary_code:_0x4397f4,prod_code:_0x1f0f96,level:_0x53ec79,isle:_0x3eb492,pallet:_0xf29588,batch_code:_0x28a300,SCRN:_0x3bc097,expiry_date:_0x2533c2,mode_transpo:_0x4bca04,name_driver:_0x474382}=_0x2527ea[_0x4e797f(0x111)];if(typeof _0xb21e61==_0x4e797f(0x1d0))var _0x31d439=[_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x199)]],_0x45821b=[_0x2527ea['body'][_0x4e797f(0x177)]],_0x2fcd4b=[_0x2527ea[_0x4e797f(0x111)]['carton']],_0x1b745d=[_0x2527ea[_0x4e797f(0x111)]['primary_code']],_0x16c316=[_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x100)]],_0x3c8d4d=[_0x2527ea['body']['prod_code']],_0x1d44be=[_0x2527ea['body'][_0x4e797f(0x113)]],_0x1dc6e2=[_0x2527ea['body'][_0x4e797f(0x170)]],_0x1ee34e=[_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x116)]],_0x2e3bbd=[_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x190)]],_0x3bcdc8=[_0x2527ea['body']['expiry_date']],_0x46a97b=[_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x10a)]],_0x1e3037=[_0x2527ea[_0x4e797f(0x111)]['max_per_unit']],_0x797245=[_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x108)]],_0x6ff7d7=[_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0xdb)]],_0x40c40e=[_0x2527ea['body']['prod_invoice']];else var _0x31d439=[..._0x2527ea['body'][_0x4e797f(0x199)]],_0x45821b=[..._0x2527ea[_0x4e797f(0x111)]['stock']],_0x2fcd4b=[..._0x2527ea['body']['carton']],_0x1b745d=[..._0x2527ea[_0x4e797f(0x111)][_0x4e797f(0xe2)]],_0x16c316=[..._0x2527ea['body'][_0x4e797f(0x100)]],_0x3c8d4d=[..._0x2527ea[_0x4e797f(0x111)]['prod_code']],_0x1d44be=[..._0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x113)]],_0x1dc6e2=[..._0x2527ea['body']['primary_unit']],_0x1ee34e=[..._0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x116)]],_0x2e3bbd=[..._0x2527ea['body'][_0x4e797f(0x190)]],_0x3bcdc8=[..._0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x146)]],_0x46a97b=[..._0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x10a)]],_0x1e3037=[..._0x2527ea['body'][_0x4e797f(0x1e4)]],_0x797245=[..._0x2527ea[_0x4e797f(0x111)][_0x4e797f(0x108)]],_0x6ff7d7=[..._0x2527ea['body'][_0x4e797f(0xdb)]],_0x40c40e=[..._0x2527ea['body']['prod_invoice']];const _0x5022d2=_0x31d439[_0x4e797f(0x1c5)](_0x236be6=>{return _0x236be6={'product_name':_0x236be6};});_0x45821b[_0x4e797f(0x151)]((_0x151c63,_0x1c0905)=>{var _0x54b3a8=_0x4e797f;_0x5022d2[_0x1c0905][_0x54b3a8(0x177)]=_0x151c63;}),_0x2fcd4b[_0x4e797f(0x151)]((_0x23baf7,_0x3127c4)=>{var _0x53730a=_0x4e797f;_0x5022d2[_0x3127c4][_0x53730a(0x1b7)]=Math[_0x53730a(0xf2)](_0x23baf7);}),_0x1b745d[_0x4e797f(0x151)]((_0x40d108,_0x26f462)=>{var _0x5c6cbb=_0x4e797f;_0x5022d2[_0x26f462][_0x5c6cbb(0xe2)]=_0x40d108;}),_0x16c316[_0x4e797f(0x151)]((_0x54f806,_0x5da382)=>{var _0x58a8dc=_0x4e797f;_0x5022d2[_0x5da382][_0x58a8dc(0x100)]=_0x54f806;}),_0x3c8d4d[_0x4e797f(0x151)]((_0x5826a6,_0x17f251)=>{var _0x3e0419=_0x4e797f;_0x5022d2[_0x17f251][_0x3e0419(0x1e5)]=_0x5826a6;}),_0x1d44be[_0x4e797f(0x151)]((_0x9ae2ec,_0x4253e0)=>{var _0x22f973=_0x4e797f;_0x5022d2[_0x4253e0][_0x22f973(0xf4)]=_0x9ae2ec;}),_0x1dc6e2[_0x4e797f(0x151)]((_0x53a5ba,_0x36fddb)=>{var _0x3a52a0=_0x4e797f;_0x5022d2[_0x36fddb][_0x3a52a0(0x1c8)]=_0x53a5ba;}),_0x1ee34e[_0x4e797f(0x151)]((_0x49e875,_0x2c96a0)=>{var _0x27cd48=_0x4e797f;_0x5022d2[_0x2c96a0][_0x27cd48(0x116)]=_0x49e875;}),_0x2e3bbd['forEach']((_0x5181ed,_0x3a43d1)=>{var _0x57db7b=_0x4e797f;_0x5022d2[_0x3a43d1][_0x57db7b(0x190)]=_0x5181ed;}),_0x3bcdc8[_0x4e797f(0x151)]((_0x4f9b9d,_0x511f18)=>{var _0x139ddb=_0x4e797f;_0x5022d2[_0x511f18][_0x139ddb(0x146)]=_0x4f9b9d;}),_0x46a97b['forEach']((_0x38d429,_0x288855)=>{_0x5022d2[_0x288855]['production_date']=_0x38d429;}),_0x1e3037[_0x4e797f(0x151)]((_0x51b0a2,_0x4a1daa)=>{var _0x4fe49f=_0x4e797f;_0x5022d2[_0x4a1daa][_0x4fe49f(0x12b)]=_0x51b0a2;}),_0x797245[_0x4e797f(0x151)]((_0x301226,_0x2b8eb6)=>{var _0x1c8820=_0x4e797f;_0x5022d2[_0x2b8eb6][_0x1c8820(0x108)]=_0x301226;}),_0x6ff7d7['forEach']((_0xfae3f0,_0x61a8d2)=>{var _0x144950=_0x4e797f;_0x5022d2[_0x61a8d2][_0x144950(0x172)]=_0xfae3f0;}),_0x40c40e[_0x4e797f(0x151)]((_0xa0b635,_0x2f9f2a)=>{_0x5022d2[_0x2f9f2a]['invoice']=_0xa0b635;});var _0x23a517=0x0;_0x5022d2[_0x4e797f(0x151)](_0x7a1d3b=>{var _0x209ca9=_0x4e797f;parseFloat(_0x7a1d3b[_0x209ca9(0x177)])<parseFloat(_0x7a1d3b[_0x209ca9(0x1b7)])&&parseFloat(_0x7a1d3b[_0x209ca9(0x1b7)])>parseFloat(_0x7a1d3b[_0x209ca9(0x177)])&&(console['log'](_0x7a1d3b[_0x209ca9(0x177)]+_0x209ca9(0x155)+_0x7a1d3b[_0x209ca9(0x1b7)]),_0x23a517++);});if(_0x23a517!=0x0)return _0x2527ea[_0x4e797f(0x1cf)]('errors',_0x4e797f(0x105)),_0x4156ad[_0x4e797f(0xf1)](_0x4e797f(0x118));const _0x4911cc=_0x5022d2['filter'](_0x282a85=>_0x282a85[_0x4e797f(0x1b7)]!=='0'&&_0x282a85['quantity']!==''),_0x5c57c4=new sales_finished({'invoice':_0x2c3922,'customer':_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0xec)],'date':_0x341535,'warehouse_name':_0x2971dc,'sale_product':_0x4911cc,'note':_0x3f3433,'room':_0x5125d3,'primary_code':_0x47d700,'secondary_code':_0x4397f4,'prod_code':_0x1f0f96,'SCRN':_0x3bc097,'finalize':_0x4e797f(0x1e9),'mode_transpo':_0x4bca04,'name_driver':_0x474382}),_0x2474b7=await _0x5c57c4[_0x4e797f(0x140)](),_0x1de3e7=await sales_finished[_0x4e797f(0x180)]({'invoice':_0x2c3922}),_0x4467cb=new c_payment_data({'invoice':_0x2c3922,'customer':_0x2527ea[_0x4e797f(0x111)][_0x4e797f(0xec)],'reason':_0x4e797f(0x1b0)});await _0x4467cb[_0x4e797f(0x140)]();const _0x354f36=await master_shop[_0x4e797f(0x181)](),_0x42dc05=await email_settings[_0x4e797f(0x180)](),_0x25fd8c=await customer[_0x4e797f(0x180)]({'name':_0x2527ea['body']['customer']});_0x354f36[0x0]['currency_placement']==0x1?(right_currency=_0x354f36[0x0][_0x4e797f(0x145)],left_currency=''):(right_currency='',left_currency=_0x354f36[0x0][_0x4e797f(0x145)]);var _0x597469=_0x31d439,_0x117e86=_0x2fcd4b,_0x3d121e='',_0x18872f;for(_0x18872f in _0x597469){_0x3d121e+=_0x4e797f(0xe1)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x597469[_0x18872f]+_0x4e797f(0x107)+_0x4e797f(0x1b4)+_0x117e86[_0x18872f]+_0x4e797f(0x107)+_0x4e797f(0xfc);}console[_0x4e797f(0x168)]('product_list',_0x3d121e);let _0x575d2f=nodemailer[_0x4e797f(0x1b6)]({'service':_0x4e797f(0x18d),'auth':{'user':_0x42dc05[_0x4e797f(0x1bc)],'pass':_0x42dc05[_0x4e797f(0x175)]}}),_0x45627e={'from':_0x42dc05[_0x4e797f(0x1bc)],'to':_0x25fd8c['email'],'subject':_0x4e797f(0x106),'attachments':[{'filename':_0x4e797f(0x195),'path':__dirname+_0x4e797f(0x194)+_0x4e797f(0x1b5)+_0x354f36[0x0][_0x4e797f(0x197)],'cid':'logo'}],'html':_0x4e797f(0x16e)+_0x4e797f(0x1c0)+_0x4e797f(0x1b9)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x4e797f(0x171)+_0x4e797f(0x124)+_0x4e797f(0x1e8)+_0x4e797f(0x171)+_0x4e797f(0x1c3)+_0x354f36[0x0]['site_title']+_0x4e797f(0x14b)+'</div>'+_0x4e797f(0x1e8)+'<hr\x20class=\x22my-3\x22>'+_0x4e797f(0x171)+_0x4e797f(0x1c6)+_0x4e797f(0x1d3)+_0x2c3922+'\x20'+_0x4e797f(0x157)+_0x4e797f(0x15e)+_0x341535+'\x20'+_0x4e797f(0x109)+_0x4e797f(0x144)+_0x4e797f(0x1e8)+_0x4e797f(0x187)+_0x4e797f(0x119)+_0x4e797f(0xe1)+_0x4e797f(0xff)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>'+_0x4e797f(0xfc)+'</thead>'+_0x4e797f(0x154)+'\x20'+_0x3d121e+'\x20'+_0x4e797f(0x15f)+_0x4e797f(0x137)+_0x4e797f(0x171)+_0x4e797f(0x192)+'<h5>'+_0x354f36[0x0]['site_title']+_0x4e797f(0x144)+_0x4e797f(0x1e8)+'</div>'+_0x4e797f(0x1d4)};_0x575d2f[_0x4e797f(0x165)](_0x45627e,function(_0x46e8c0,_0xd04f8c){var _0x10b532=_0x4e797f;_0x46e8c0?(console['log'](_0x46e8c0),console[_0x10b532(0x168)]('Error\x20Occurs')):console[_0x10b532(0x168)](_0x10b532(0xf8));}),_0x2527ea['flash'](_0x4e797f(0x1ca),_0x4e797f(0xef)),_0x4156ad[_0x4e797f(0xf1)](_0x4e797f(0xe0)+_0x2474b7[_0x4e797f(0x13d)]);}catch(_0x1e1542){console[_0x4e797f(0x168)](_0x1e1542);}}),router[a0_0x275e41(0x117)](a0_0x275e41(0x153),auth,async(_0x531aea,_0x445096)=>{var _0x5754ff=a0_0x275e41;try{const {username:_0x246388,email:_0x4db34e,role:_0x229d1a}=_0x531aea['user'],_0x1e0f4a=_0x531aea[_0x5754ff(0x11a)],_0x682935=await profile[_0x5754ff(0x180)]({'email':_0x1e0f4a[_0x5754ff(0x1bc)]}),_0x2f7e5c=await master_shop['find'](),_0x38e3bc=_0x531aea['params']['id'],_0x2a0203=await sales_finished['findById'](_0x38e3bc),_0x5447ef=await warehouse['aggregate']([{'$match':{'name':_0x2a0203[_0x5754ff(0x126)]}},{'$unwind':_0x5754ff(0x138)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5754ff(0xe3)},'product_stock':{'$first':_0x5754ff(0x1af)},'bay':{'$first':_0x5754ff(0x125)},'bin':{'$first':_0x5754ff(0x1bd)},'type':{'$first':_0x5754ff(0x1e0)},'floorlevel':{'$first':_0x5754ff(0x1d6)},'primary_code':{'$first':_0x5754ff(0x131)},'secondary_code':{'$first':_0x5754ff(0x12e)},'product_code':{'$first':_0x5754ff(0x1aa)},'storage':{'$first':_0x5754ff(0x16b)},'rack':{'$first':_0x5754ff(0x1e1)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5754ff(0x1a6)},'batch_code':{'$first':_0x5754ff(0x196)},'room':{'$first':_0x5754ff(0x141)}}}]),_0x2d129c=await customer['find']({});let _0x122f11;if(_0x1e0f4a[_0x5754ff(0x13a)]==_0x5754ff(0x1e6)){const _0x5dc261=await staff[_0x5754ff(0x180)]({'email':_0x1e0f4a[_0x5754ff(0x1bc)]});_0x122f11=await warehouse['aggregate']([{'$match':{'status':_0x5754ff(0x16a),'name':_0x5dc261[_0x5754ff(0x102)]}},{'$group':{'_id':_0x5754ff(0x15a),'name':{'$first':_0x5754ff(0x15a)}}}]);}else _0x122f11=await warehouse[_0x5754ff(0x1a3)]([{'$match':{'status':_0x5754ff(0x16a)}},{'$group':{'_id':_0x5754ff(0x15a),'name':{'$first':_0x5754ff(0x15a)}}}]);const _0x541abe=await product[_0x5754ff(0x181)]({});if(_0x2f7e5c[0x0][_0x5754ff(0x1ec)]==_0x5754ff(0x120)){var _0x47d9bc=users[_0x5754ff(0x1be)];console[_0x5754ff(0x168)](_0x47d9bc);}else{if(_0x2f7e5c[0x0][_0x5754ff(0x1ec)]==_0x5754ff(0x14c))var _0x47d9bc=users[_0x5754ff(0x14c)];else{if(_0x2f7e5c[0x0]['language']==_0x5754ff(0x159))var _0x47d9bc=users['German'];else{if(_0x2f7e5c[0x0][_0x5754ff(0x1ec)]==_0x5754ff(0x19d))var _0x47d9bc=users['Spanish'];else{if(_0x2f7e5c[0x0]['language']=='French')var _0x47d9bc=users[_0x5754ff(0x18b)];else{if(_0x2f7e5c[0x0][_0x5754ff(0x1ec)]==_0x5754ff(0x193))var _0x47d9bc=users[_0x5754ff(0x127)];else{if(_0x2f7e5c[0x0][_0x5754ff(0x1ec)]==_0x5754ff(0xe5))var _0x47d9bc=users[_0x5754ff(0xe5)];else{if(_0x2f7e5c[0x0][_0x5754ff(0x1ec)]==_0x5754ff(0x135))var _0x47d9bc=users[_0x5754ff(0x1d9)];}}}}}}}_0x445096['render']('edit_sales_finished_view',{'success':_0x531aea['flash'](_0x5754ff(0x1ca)),'errors':_0x531aea[_0x5754ff(0x1cf)](_0x5754ff(0x1a8)),'role':_0x1e0f4a,'profile':_0x682935,'customer':_0x2d129c,'warehouse':_0x122f11,'product':_0x5447ef,'user':_0x2a0203,'master_shop':_0x2f7e5c,'unit':_0x541abe,'language':_0x47d9bc});}catch(_0x196e86){console[_0x5754ff(0x168)](_0x196e86);}}),router['post']('/preview/:id',auth,async(_0x31edd9,_0x19cedb)=>{var _0x1cd795=a0_0x275e41;try{const _0x33f119=_0x31edd9[_0x1cd795(0x1ce)]['id'],{invoice:_0x44a126,warehouse_name:_0x316833,room:_0x576473}=_0x31edd9[_0x1cd795(0x111)],_0xe3f9d4=await sales_finished[_0x1cd795(0x180)]({'invoice':_0x44a126}),_0x5338aa=_0xe3f9d4[_0x1cd795(0x133)][_0x1cd795(0x1c5)](async _0x2aa5bd=>{var _0x116653=_0x1cd795,_0x2bba6d=await warehouse[_0x116653(0x180)]({'name':_0x316833,'room':_0x2aa5bd[_0x116653(0x172)],'warehouse_category':_0x116653(0x152)});const _0x4a7148=_0x2bba6d[_0x116653(0x104)][_0x116653(0x1c5)](_0x14d133=>{var _0x2988c9=_0x116653;_0x14d133[_0x2988c9(0x199)]==_0x2aa5bd[_0x2988c9(0x199)]&&_0x14d133['bay']==_0x2aa5bd['bay']&&_0x14d133[_0x2988c9(0x146)]==_0x2aa5bd[_0x2988c9(0x146)]&&_0x14d133[_0x2988c9(0x1a7)]==_0x2aa5bd[_0x2988c9(0x1a7)]&&_0x14d133['batch_code']==_0x2aa5bd['batch_code']&&_0x14d133[_0x2988c9(0x142)]==_0x2aa5bd['invoice']&&(_0x14d133[_0x2988c9(0x130)]=Math[_0x2988c9(0xf2)](_0x14d133[_0x2988c9(0x130)])-Math[_0x2988c9(0xf2)](_0x2aa5bd['quantity']));});return _0x2bba6d;});Promise[_0x1cd795(0x128)](_0x5338aa)[_0x1cd795(0x1b1)](async _0x47f00b=>{var _0x223298=_0x1cd795;try{for(const _0x818e71 of _0x47f00b){await _0x818e71[_0x223298(0x140)]();}_0xe3f9d4[_0x223298(0x10b)]=_0x223298(0x1b8);const _0x332319=await _0xe3f9d4['save'](),_0x248515=await master_shop[_0x223298(0x181)](),_0x13604a=await email_settings[_0x223298(0x180)](),_0x4fbe6c=await supervisor_settings[_0x223298(0x181)]();var _0x456002=_0xe3f9d4[_0x223298(0x133)],_0x240387='',_0x2c9cce;for(_0x2c9cce in _0x456002){var _0x52407f='FG';_0xe3f9d4[_0x223298(0x126)]==_0x223298(0x169)&&(_0x52407f='DG'),_0x240387+='<tr>'+_0x223298(0x1b4)+_0x456002[_0x2c9cce][_0x223298(0x199)]+'</td>'+_0x223298(0x1b4)+_0x456002[_0x2c9cce][_0x223298(0x1e5)]+'</td>'+_0x223298(0x1b4)+_0x456002[_0x2c9cce][_0x223298(0x1b7)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x456002[_0x2c9cce]['unit']+_0x223298(0x107)+_0x223298(0x1b4)+_0x456002[_0x2c9cce][_0x223298(0x116)]+_0x223298(0x107)+_0x223298(0x1b4)+_0xe3f9d4[_0x223298(0x126)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x456002[_0x2c9cce][_0x223298(0x172)]+_0x223298(0x107)+_0x223298(0x1b4)+_0x52407f+_0x456002[_0x2c9cce][_0x223298(0xf4)]+_0x223298(0x107);}let _0x5ad32b=nodemailer[_0x223298(0x1b6)]({'host':_0x13604a[_0x223298(0x1cb)],'port':Number(_0x13604a[_0x223298(0xe9)]),'secure':![],'auth':{'user':_0x13604a[_0x223298(0x1bc)],'pass':_0x13604a[_0x223298(0x175)]}}),_0x1e54b2={'from':_0x13604a[_0x223298(0x1bc)],'to':_0x4fbe6c[0x0][_0x223298(0x1d2)],'subject':_0x223298(0x103),'attachments':[{'filename':'Logo.png','path':__dirname+_0x223298(0x194)+_0x223298(0x1b5)+_0x248515[0x0][_0x223298(0x197)],'cid':_0x223298(0xed)}],'html':_0x223298(0x16e)+_0x223298(0x1c0)+'</head><body>'+_0x223298(0x171)+_0x223298(0x13f)+_0x223298(0x171)+_0x223298(0x124)+_0x223298(0x1e8)+'<div>'+'<h2>\x20'+_0x248515[0x0][_0x223298(0xee)]+_0x223298(0x14b)+_0x223298(0x1e8)+_0x223298(0x1e8)+'<hr\x20class=\x22my-3\x22>'+_0x223298(0x171)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x223298(0x1d3)+_0xe3f9d4[_0x223298(0x142)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x223298(0x15e)+_0xe3f9d4[_0x223298(0x136)]+'\x20'+'</span>'+_0x223298(0x144)+_0x223298(0x1e8)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x223298(0x119)+_0x223298(0xe1)+_0x223298(0xff)+_0x223298(0x122)+_0x223298(0x1ab)+_0x223298(0x1c1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x223298(0x1a1)+_0x223298(0x11d)+_0x223298(0x1da)+_0x223298(0xfc)+'</thead>'+_0x223298(0x154)+'\x20'+_0x240387+'\x20'+'</tbody>'+'</table>'+_0x223298(0x171)+'<strong>\x20Regards\x20</strong>'+_0x223298(0x173)+_0x248515[0x0][_0x223298(0xee)]+_0x223298(0x144)+'</div>'+_0x223298(0x1e8)+_0x223298(0x1d4)};_0x5ad32b[_0x223298(0x165)](_0x1e54b2,function(_0x136e78,_0x570d46){var _0x407403=_0x223298;_0x136e78?(console['log'](_0x136e78),console['log'](_0x407403(0xf5))):console[_0x407403(0x168)]('Email\x20sent\x20successfully');}),_0x31edd9[_0x223298(0x1cf)]('success',_0x223298(0xe6)),_0x19cedb[_0x223298(0xf1)](_0x223298(0xf7)+_0x33f119);}catch(_0x9ba94){console[_0x223298(0x15d)](_0x9ba94),_0x19cedb['status'](0x1f4)[_0x223298(0x184)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x1cd795(0x14e)](_0x58ab24=>{var _0x480b6c=_0x1cd795;console['error'](_0x58ab24),_0x19cedb['status'](0x1f4)[_0x480b6c(0x184)]({'error':_0x480b6c(0x14d)});});}catch(_0x457e14){console['log'](_0x457e14);}}),router[a0_0x275e41(0x117)]('/view/:id',auth,async(_0x167912,_0x29cbaa)=>{var _0x589eea=a0_0x275e41;try{const {username:_0x5a9405,email:_0x3d9c0a,role:_0x240c28}=_0x167912['user'],_0x489e3c=_0x167912['user'],_0x32837b=await profile[_0x589eea(0x180)]({'email':_0x489e3c[_0x589eea(0x1bc)]}),_0x3085b4=await master_shop['find'](),_0x13e0e4=_0x167912['params']['id'],_0x5c2b54=await sales_finished['findById'](_0x13e0e4);let _0x1725d5=new Date(_0x5c2b54['expiry_date']),_0x22d72e=('0'+_0x1725d5[_0x589eea(0x18e)]())[_0x589eea(0x174)](-0x2),_0x418d41=('0'+(_0x1725d5[_0x589eea(0x10f)]()+0x1))[_0x589eea(0x174)](-0x2),_0x32f1b9=_0x1725d5['getFullYear'](),_0x2750d8=_0x32f1b9+'-'+_0x418d41+'-'+_0x22d72e;var _0x3cf901=['Ambient',_0x589eea(0x156)];const _0xaff48e=await warehouse[_0x589eea(0x1a3)]([{'$match':{'name':_0x5c2b54[_0x589eea(0x126)],'room':_0x5c2b54[_0x589eea(0x1a0)]}},{'$unwind':_0x589eea(0x138)},{'$group':{'_id':_0x589eea(0x13e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x589eea(0x1af)},'bay':{'$first':_0x589eea(0x125)},'bin':{'$first':_0x589eea(0x1bd)},'type':{'$first':_0x589eea(0x1e0)},'floorlevel':{'$first':_0x589eea(0x1d6)},'primary_code':{'$first':_0x589eea(0x131)},'secondary_code':{'$first':_0x589eea(0x12e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x589eea(0x16b)},'rack':{'$first':_0x589eea(0x1e1)}}}]),_0x17adba=await customer['find']({});let _0x113f44;if(_0x489e3c[_0x589eea(0x13a)]==_0x589eea(0x1e6)){const _0x276959=await staff['findOne']({'email':_0x489e3c[_0x589eea(0x1bc)]});_0x113f44=await warehouse[_0x589eea(0x1a3)]([{'$match':{'status':_0x589eea(0x16a),'name':_0x276959['warehouse']}},{'$group':{'_id':_0x589eea(0x15a),'name':{'$first':_0x589eea(0x15a)}}}]);}else _0x113f44=await warehouse[_0x589eea(0x1a3)]([{'$match':{'status':_0x589eea(0x16a)}},{'$group':{'_id':_0x589eea(0x15a),'name':{'$first':_0x589eea(0x15a)}}}]);const _0x1b0e8c=await product[_0x589eea(0x181)]({});if(_0x3085b4[0x0][_0x589eea(0x1ec)]==_0x589eea(0x120)){var _0xe9d681=users[_0x589eea(0x1be)];console['log'](_0xe9d681);}else{if(_0x3085b4[0x0][_0x589eea(0x1ec)]==_0x589eea(0x14c))var _0xe9d681=users['Hindi'];else{if(_0x3085b4[0x0][_0x589eea(0x1ec)]==_0x589eea(0x159))var _0xe9d681=users[_0x589eea(0x159)];else{if(_0x3085b4[0x0][_0x589eea(0x1ec)]=='Spanish')var _0xe9d681=users['Spanish'];else{if(_0x3085b4[0x0]['language']=='French')var _0xe9d681=users[_0x589eea(0x18b)];else{if(_0x3085b4[0x0][_0x589eea(0x1ec)]==_0x589eea(0x193))var _0xe9d681=users[_0x589eea(0x127)];else{if(_0x3085b4[0x0][_0x589eea(0x1ec)]==_0x589eea(0xe5))var _0xe9d681=users[_0x589eea(0xe5)];else{if(_0x3085b4[0x0][_0x589eea(0x1ec)]==_0x589eea(0x135))var _0xe9d681=users[_0x589eea(0x1d9)];}}}}}}}_0x29cbaa['render'](_0x589eea(0x19b),{'success':_0x167912[_0x589eea(0x1cf)](_0x589eea(0x1ca)),'errors':_0x167912[_0x589eea(0x1cf)](_0x589eea(0x1a8)),'role':_0x489e3c,'profile':_0x32837b,'customer':_0x17adba,'warehouse':_0x113f44,'product':_0xaff48e,'user':_0x5c2b54,'master_shop':_0x3085b4,'unit':_0x1b0e8c,'language':_0xe9d681,'rooms_data':_0x3cf901,'ed_fullDate':_0x2750d8});}catch(_0x4b52a3){console[_0x589eea(0x168)](_0x4b52a3);}}),router['post']('/view/:id',auth,async(_0x12e126,_0x143b7c)=>{var _0x8eab5d=a0_0x275e41;try{const _0x1d0699=_0x12e126[_0x8eab5d(0x1ce)]['id'],_0x2e4b36=await sales_finished[_0x8eab5d(0x180)]({'_id':_0x12e126[_0x8eab5d(0x1ce)]['id']}),_0x5be32c=await warehouse[_0x8eab5d(0x180)]({'name':_0x2e4b36[_0x8eab5d(0x126)],'room':_0x12e126['body'][_0x8eab5d(0x1a0)],'warehouse_category':_0x8eab5d(0x152)}),{invoice:_0x3797f4,customer:_0x581d73,date:_0x53db8f,warehouse_name:_0x2f82fb,product_name:_0x52a03b,stock:_0x4023cb,adjust_qty:_0x216dd0,note:_0x4bbae4,room:_0x457abc,primary_code:_0x597e24,secondary_code:_0x5d09a7,prod_code:_0x5c9ece,level:_0x130a50,isle:_0x187b3c,pallet:_0x4015f5,expiry_date:_0x1dbb38}=_0x12e126[_0x8eab5d(0x111)];if(typeof _0x52a03b==_0x8eab5d(0x1d0))var _0x6eb2c3=[_0x12e126['body']['product_name']],_0x57bb2d=[_0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0x177)]],_0x8ce9ec=[_0x12e126[_0x8eab5d(0x111)]['adjust_qty']],_0x2cabde=[_0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0xe2)]],_0x3ec1f7=[_0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0x100)]],_0x18f39b=[_0x12e126['body'][_0x8eab5d(0x162)]],_0x27111f=[_0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0x113)]],_0x38c33b=[_0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0x146)]];else var _0x6eb2c3=[..._0x12e126['body']['product_name']],_0x57bb2d=[..._0x12e126['body'][_0x8eab5d(0x177)]],_0x8ce9ec=[..._0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0x139)]],_0x2cabde=[..._0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0xe2)]],_0x3ec1f7=[..._0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0x100)]],_0x18f39b=[..._0x12e126['body'][_0x8eab5d(0x162)]],_0x27111f=[..._0x12e126[_0x8eab5d(0x111)]['level']],_0x38c33b=[..._0x12e126['body']['expiry_date']];const _0x5215bc=_0x6eb2c3[_0x8eab5d(0x1c5)](_0x40de75=>{return _0x40de75={'product_name':_0x40de75};});_0x57bb2d[_0x8eab5d(0x151)]((_0x426d72,_0x32db9b)=>{var _0x3f439b=_0x8eab5d;_0x5215bc[_0x32db9b][_0x3f439b(0x177)]=_0x426d72;}),_0x8ce9ec['forEach']((_0x440633,_0x46373c)=>{var _0x1535d9=_0x8eab5d;_0x5215bc[_0x46373c][_0x1535d9(0x1b7)]=_0x440633;}),_0x2cabde[_0x8eab5d(0x151)]((_0x15d053,_0x45f413)=>{var _0x903cc3=_0x8eab5d;_0x5215bc[_0x45f413][_0x903cc3(0xe2)]=_0x15d053;}),_0x3ec1f7[_0x8eab5d(0x151)]((_0x128c3c,_0x1c1ae2)=>{_0x5215bc[_0x1c1ae2]['secondary_code']=_0x128c3c;}),_0x18f39b[_0x8eab5d(0x151)]((_0x5c53e8,_0x2d94d3)=>{var _0x32d234=_0x8eab5d;_0x5215bc[_0x2d94d3][_0x32d234(0x1e5)]=_0x5c53e8;}),_0x27111f[_0x8eab5d(0x151)]((_0x4d2e7a,_0x21df0f)=>{_0x5215bc[_0x21df0f]['level']=_0x4d2e7a;}),_0x38c33b[_0x8eab5d(0x151)]((_0x15f3f1,_0x10af8d)=>{var _0x9da257=_0x8eab5d;_0x5215bc[_0x10af8d][_0x9da257(0x146)]=_0x15f3f1;});var _0x2d7834=0x0;_0x5215bc[_0x8eab5d(0x151)](_0x4459d0=>{var _0x2dabeb=_0x8eab5d;console['log']('foreach\x20newproduct',_0x4459d0),(parseInt(_0x4459d0[_0x2dabeb(0x177)])<parseInt(_0x4459d0[_0x2dabeb(0x1b7)])||parseInt(_0x4459d0['quantity'])==0x0)&&_0x2d7834++;});if(_0x2d7834!=0x0)return _0x12e126[_0x8eab5d(0x1cf)]('errors',_0x8eab5d(0x166)),_0x143b7c['redirect']('back');_0x2e4b36[_0x8eab5d(0x133)]['forEach'](_0x3a109b=>{var _0x1b4737=_0x8eab5d;const _0x5139b6=_0x5be32c[_0x1b4737(0x104)]['map'](_0x51625c=>{var _0x40541b=_0x1b4737;_0x51625c[_0x40541b(0x199)]==_0x3a109b[_0x40541b(0x199)]&&_0x51625c[_0x40541b(0xf4)]==_0x3a109b[_0x40541b(0xf4)]&&(_0x51625c[_0x40541b(0x130)]=parseInt(_0x51625c[_0x40541b(0x130)])+parseInt(_0x3a109b[_0x40541b(0x1b7)]));});}),await _0x5be32c[_0x8eab5d(0x140)]();const _0x55e308=_0x5215bc['filter'](_0x1c6694=>_0x1c6694[_0x8eab5d(0x1b7)]!=='0'&&_0x1c6694['quantity']!=='');_0x2e4b36[_0x8eab5d(0x142)]=_0x3797f4,_0x2e4b36[_0x8eab5d(0xec)]=_0x581d73,_0x2e4b36['date']=_0x53db8f,_0x2e4b36['warehouse_name']=_0x2f82fb,_0x2e4b36['sale_product']=_0x55e308,_0x2e4b36[_0x8eab5d(0x148)]=_0x4bbae4,_0x2e4b36[_0x8eab5d(0x1a0)]=_0x457abc;const _0x2a897e=await _0x2e4b36[_0x8eab5d(0x140)](),_0x14708e=await sales_finished[_0x8eab5d(0x180)]({'_id':_0x12e126[_0x8eab5d(0x1ce)]['id']}),_0x5249a0=await warehouse[_0x8eab5d(0x180)]({'name':_0x2f82fb,'room':_0x457abc,'warehouse_category':_0x8eab5d(0x152)});_0x14708e[_0x8eab5d(0x133)][_0x8eab5d(0x151)](_0x21891f=>{var _0x2e241e=_0x8eab5d;const _0x4bfbae=_0x5249a0[_0x2e241e(0x104)][_0x2e241e(0x1c5)](_0x2676f1=>{var _0x2661bc=_0x2e241e;_0x2676f1[_0x2661bc(0x199)]==_0x21891f[_0x2661bc(0x199)]&&_0x2676f1[_0x2661bc(0xf4)]==_0x21891f[_0x2661bc(0xf4)]&&(_0x2676f1['product_stock']=parseInt(_0x2676f1[_0x2661bc(0x130)])-parseInt(_0x21891f[_0x2661bc(0x1b7)]));});}),console['log'](_0x8eab5d(0x10c),_0x5249a0),await _0x5249a0[_0x8eab5d(0x140)]();const _0x34bc7e=await c_payment_data['findOne']({'invoice':_0x12e126[_0x8eab5d(0x111)][_0x8eab5d(0x142)]});_0x34bc7e[_0x8eab5d(0x19a)]=_0x12e126[_0x8eab5d(0x111)]['suppliers'],await _0x34bc7e['save'](),_0x12e126[_0x8eab5d(0x1cf)]('success',_0x8eab5d(0xe6)),_0x143b7c['redirect']('/all_sales_finished/view');}catch(_0x16b929){console[_0x8eab5d(0x168)](_0x16b929);}}),router[a0_0x275e41(0x10d)](a0_0x275e41(0x1b2),auth,async(_0x115074,_0x80bfd6)=>{var _0x2a7c54=a0_0x275e41;try{const _0x54843c=_0x115074[_0x2a7c54(0x1ce)]['id'],{invoice:_0x268123,customer:_0x498f80,receivable_amount:_0x92d7fd,received_amount:_0x32a6e3}=_0x115074[_0x2a7c54(0x111)],_0x1cfae2=await sales['findById'](_0x54843c);console[_0x2a7c54(0x168)](_0x1cfae2);var _0x44bc11=_0x92d7fd-_0x32a6e3;console[_0x2a7c54(0x168)](_0x32a6e3),_0x1cfae2[_0x2a7c54(0x17b)]=parseFloat(_0x32a6e3)+parseFloat(_0x1cfae2[_0x2a7c54(0x17b)]),_0x1cfae2[_0x2a7c54(0x13b)]=_0x44bc11,console[_0x2a7c54(0x168)](_0x1cfae2);const _0x3bb38c=await _0x1cfae2[_0x2a7c54(0x140)](),_0xb21d77=await c_payment_data[_0x2a7c54(0x180)]({'invoice':_0x268123});_0xb21d77['amount']=_0x44bc11,await _0xb21d77[_0x2a7c54(0x140)]();let _0x2e09b0=new Date(),_0x3f5489=('0'+_0x2e09b0[_0x2a7c54(0x18e)]())[_0x2a7c54(0x174)](-0x2),_0x5afa7f=('0'+(_0x2e09b0[_0x2a7c54(0x10f)]()+0x1))[_0x2a7c54(0x174)](-0x2),_0x41ad0a=_0x2e09b0[_0x2a7c54(0x123)](),_0x3c8ef9=_0x41ad0a+'-'+_0x5afa7f+'-'+_0x3f5489;const _0x391876=new customer_payment({'invoice':_0x268123,'date':_0x41ad0a+'-'+_0x5afa7f+'-'+_0x3f5489,'customer':_0x498f80,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x32a6e3}),_0xc8e03f=await _0x391876[_0x2a7c54(0x140)]();_0x115074[_0x2a7c54(0x1cf)](_0x2a7c54(0x1ca),'payment\x20successfull'),_0x80bfd6['redirect'](_0x2a7c54(0x14f));}catch(_0x5c4585){console[_0x2a7c54(0x168)](_0x5c4585);}}),router[a0_0x275e41(0x117)](a0_0x275e41(0x189),auth,async(_0x2a2269,_0xab119e)=>{var _0x14dd7d=a0_0x275e41;try{const {username:_0x32ca37,email:_0x5e7c79,role:_0x4dd670}=_0x2a2269[_0x14dd7d(0x11a)],_0x15d9d7=_0x2a2269['user'],_0x5985ec=await profile[_0x14dd7d(0x180)]({'email':_0x15d9d7[_0x14dd7d(0x1bc)]}),_0x5d7f1e=await master_shop[_0x14dd7d(0x181)]();console[_0x14dd7d(0x168)](_0x14dd7d(0x18c),_0x5d7f1e);const _0x47200d=_0x2a2269[_0x14dd7d(0x1ce)]['id'],_0x2b979e=await sales[_0x14dd7d(0x11f)](_0x47200d);console[_0x14dd7d(0x168)](_0x2b979e);const _0x37575a=await customer[_0x14dd7d(0x180)]({'name':_0x2b979e[_0x14dd7d(0xec)]});console[_0x14dd7d(0x168)](_0x37575a);if(_0x5d7f1e[0x0][_0x14dd7d(0x1ec)]==_0x14dd7d(0x120)){var _0x6a3ac2=users[_0x14dd7d(0x1be)];console['log'](_0x6a3ac2);}else{if(_0x5d7f1e[0x0][_0x14dd7d(0x1ec)]==_0x14dd7d(0x14c))var _0x6a3ac2=users[_0x14dd7d(0x14c)];else{if(_0x5d7f1e[0x0][_0x14dd7d(0x1ec)]==_0x14dd7d(0x159))var _0x6a3ac2=users[_0x14dd7d(0x159)];else{if(_0x5d7f1e[0x0][_0x14dd7d(0x1ec)]=='Spanish')var _0x6a3ac2=users[_0x14dd7d(0x19d)];else{if(_0x5d7f1e[0x0]['language']==_0x14dd7d(0x18b))var _0x6a3ac2=users['French'];else{if(_0x5d7f1e[0x0]['language']==_0x14dd7d(0x193))var _0x6a3ac2=users[_0x14dd7d(0x127)];else{if(_0x5d7f1e[0x0]['language']==_0x14dd7d(0xe5))var _0x6a3ac2=users['Chinese'];else{if(_0x5d7f1e[0x0]['language']==_0x14dd7d(0x135))var _0x6a3ac2=users[_0x14dd7d(0x1d9)];}}}}}}}_0xab119e['render']('sales_invoice',{'success':_0x2a2269[_0x14dd7d(0x1cf)](_0x14dd7d(0x1ca)),'errors':_0x2a2269[_0x14dd7d(0x1cf)](_0x14dd7d(0x1a8)),'role':_0x15d9d7,'profile':_0x5985ec,'master_shop':_0x5d7f1e,'customers':_0x37575a,'sales':_0x2b979e,'language':_0x6a3ac2});}catch(_0x117b59){console[_0x14dd7d(0x168)](_0x117b59);}}),router[a0_0x275e41(0x117)]('/view/return_sales/:id',auth,async(_0x1881da,_0x116e41)=>{var _0x35be09=a0_0x275e41;try{const {username:_0x2bf795,email:_0x4a7375,role:_0x5d9a1d}=_0x1881da[_0x35be09(0x11a)],_0x46a0f8=_0x1881da['user'],_0x2d5a2e=await profile[_0x35be09(0x180)]({'email':_0x46a0f8[_0x35be09(0x1bc)]}),_0x3fd622=await master_shop[_0x35be09(0x181)](),_0x50391f=_0x1881da['params']['id'],_0x17b129=await sales_finished[_0x35be09(0x11f)](_0x50391f),_0x5717cb=await warehouse[_0x35be09(0x1a3)]([{'$match':{'name':_0x17b129[_0x35be09(0x126)]}},{'$unwind':_0x35be09(0x138)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x35be09(0xe3)},'product_stock':{'$first':_0x35be09(0x1af)},'bay':{'$first':_0x35be09(0x125)},'bin':{'$first':_0x35be09(0x1bd)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x35be09(0x1d6)},'primary_code':{'$first':_0x35be09(0x131)},'secondary_code':{'$first':_0x35be09(0x12e)},'product_code':{'$first':_0x35be09(0x1aa)},'storage':{'$first':_0x35be09(0x16b)},'rack':{'$first':_0x35be09(0x1e1)},'expiry_date':{'$first':_0x35be09(0x17c)},'production_date':{'$first':_0x35be09(0x1a6)},'unit':{'$first':_0x35be09(0x1e2)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x35be09(0x196)},'maxPerUnit':{'$first':_0x35be09(0x161)}}}]),_0x22b8c3=await product[_0x35be09(0x181)]({}),_0x1712a2=await warehouse[_0x35be09(0x1a3)]([{'$match':{'status':_0x35be09(0x16a),'warehouse_category':_0x35be09(0x152),'name':{'$ne':_0x35be09(0x1bf),'$ne':_0x35be09(0xfd)}}},{'$group':{'_id':_0x35be09(0x15a),'name':{'$first':_0x35be09(0x15a)}}},{'$sort':{'name':0x1}}]);var _0x334020=['Return\x20Rooms'];const _0x451bfb=await warehouse[_0x35be09(0x1a3)]([{'$match':{'status':_0x35be09(0x16a),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x35be09(0x15a),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x3fd622[0x0]['language']=='English\x20(US)'){var _0x59d7c4=users[_0x35be09(0x1be)];console[_0x35be09(0x168)](_0x59d7c4);}else{if(_0x3fd622[0x0][_0x35be09(0x1ec)]=='Hindi')var _0x59d7c4=users['Hindi'];else{if(_0x3fd622[0x0][_0x35be09(0x1ec)]==_0x35be09(0x159))var _0x59d7c4=users[_0x35be09(0x159)];else{if(_0x3fd622[0x0][_0x35be09(0x1ec)]==_0x35be09(0x19d))var _0x59d7c4=users[_0x35be09(0x19d)];else{if(_0x3fd622[0x0][_0x35be09(0x1ec)]==_0x35be09(0x18b))var _0x59d7c4=users[_0x35be09(0x18b)];else{if(_0x3fd622[0x0]['language']==_0x35be09(0x193))var _0x59d7c4=users[_0x35be09(0x127)];else{if(_0x3fd622[0x0][_0x35be09(0x1ec)]=='Chinese')var _0x59d7c4=users[_0x35be09(0xe5)];else{if(_0x3fd622[0x0]['language']==_0x35be09(0x135))var _0x59d7c4=users['Arabic'];}}}}}}}_0x116e41['render'](_0x35be09(0x167),{'success':_0x1881da[_0x35be09(0x1cf)](_0x35be09(0x1ca)),'errors':_0x1881da[_0x35be09(0x1cf)](_0x35be09(0x1a8)),'role':_0x46a0f8,'profile':_0x2d5a2e,'user':_0x17b129,'stock':_0x5717cb,'master_shop':_0x3fd622,'unit':_0x22b8c3,'language':_0x59d7c4,'warehouses':_0x1712a2,'rooms':_0x334020,'warehouse_QA':_0x451bfb});}catch(_0x17aa49){console['log'](_0x17aa49),_0x116e41[_0x35be09(0x1b3)](0xc8)[_0x35be09(0x184)]({'message':_0x17aa49[_0x35be09(0x185)]});}}),router[a0_0x275e41(0x10d)](a0_0x275e41(0x186),auth,async(_0x340f07,_0x7d01e5)=>{var _0x9e6329=a0_0x275e41;if(_0x340f07['body'][_0x9e6329(0x110)]=='QA')try{const {invoice:_0x3a682f,date:_0x3e314e,warehouse_name:_0x3736bd,product_name:_0x14f73c,primary_code:_0x4c4a7b,secondary_code:_0xb4c1,product_code:_0x450254,sales_quantity:_0x105597,stocks:_0x4640c9,return_qty:_0x314791,Room_name:_0x4e4733,to_warehouse_name_QA:_0x593168,to_Room_name_QA:_0x146643,note:_0x334b0b,for_categorize:_0x406690,product_name_QA1:_0x2748f2}=_0x340f07[_0x9e6329(0x111)];if(typeof _0x2748f2==_0x9e6329(0x1d0))var _0x20632e=[_0x340f07[_0x9e6329(0x111)]['product_name_QA1']],_0x2f6aab=[_0x340f07['body']['primary_code_QA']],_0x42e496=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1eb)]],_0x1c170b=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1d8)]],_0x19b413=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1ba)]],_0x38e5cf=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1c7)]],_0x49eac4=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0xf6)]],_0x222ad3=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x19c)]],_0x51df46=[_0x340f07['body'][_0x9e6329(0xdc)]],_0x194447=[_0x340f07['body'][_0x9e6329(0x1d1)]],_0x9f2967=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0xeb)]],_0x5ad1bf=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x182)]],_0x570608=[_0x340f07['body']['production_date_QA']],_0x4a97a5=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x147)]];else var _0x20632e=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x11e)]],_0x2f6aab=[..._0x340f07[_0x9e6329(0x111)]['primary_code_QA']],_0x42e496=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1eb)]],_0x1c170b=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1d8)]],_0x19b413=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1ba)]],_0x38e5cf=[..._0x340f07['body']['stocks_QA']],_0x49eac4=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0xf6)]],_0x222ad3=[..._0x340f07[_0x9e6329(0x111)]['maxPerUnit_QA']],_0x51df46=[..._0x340f07['body'][_0x9e6329(0xdc)]],_0x194447=[..._0x340f07['body'][_0x9e6329(0x1d1)]],_0x9f2967=[..._0x340f07['body'][_0x9e6329(0xeb)]],_0x5ad1bf=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x182)]],_0x570608=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x112)]],_0x4a97a5=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x147)]];const _0xe7e92c=_0x20632e[_0x9e6329(0x1c5)](_0x2b98ff=>{return _0x2b98ff={'product_name':_0x2b98ff};});_0x2f6aab[_0x9e6329(0x151)]((_0x4761d8,_0x2a216c)=>{var _0x1bf152=_0x9e6329;_0xe7e92c[_0x2a216c][_0x1bf152(0xe2)]=_0x4761d8;}),_0x42e496[_0x9e6329(0x151)]((_0x133f07,_0x24662d)=>{var _0x1a5e80=_0x9e6329;_0xe7e92c[_0x24662d][_0x1a5e80(0x100)]=_0x133f07;}),_0x1c170b[_0x9e6329(0x151)]((_0x4b59aa,_0x561b1a)=>{var _0x2a0d51=_0x9e6329;_0xe7e92c[_0x561b1a][_0x2a0d51(0x1e5)]=_0x4b59aa;}),_0x19b413['forEach']((_0x2275f6,_0x264f70)=>{var _0x303e8a=_0x9e6329;_0xe7e92c[_0x264f70][_0x303e8a(0xde)]=_0x2275f6;}),_0x38e5cf[_0x9e6329(0x151)]((_0xbbb4b2,_0x9d8a8f)=>{var _0x5057d8=_0x9e6329;_0xe7e92c[_0x9d8a8f][_0x5057d8(0x177)]=_0xbbb4b2;}),_0x49eac4[_0x9e6329(0x151)]((_0x5421bc,_0x40a0ff)=>{var _0x4a2e58=_0x9e6329;_0xe7e92c[_0x40a0ff][_0x4a2e58(0x143)]=_0x5421bc;}),_0x222ad3[_0x9e6329(0x151)]((_0x1b2140,_0x5a09fe)=>{var _0x5cba31=_0x9e6329;_0xe7e92c[_0x5a09fe][_0x5cba31(0x188)]=_0x1b2140;}),_0x51df46['forEach']((_0x2746bd,_0x47cd2a)=>{var _0x2a8a0f=_0x9e6329;_0xe7e92c[_0x47cd2a][_0x2a8a0f(0x163)]=_0x2746bd;}),_0x194447[_0x9e6329(0x151)]((_0x301bbc,_0x3ec5ae)=>{var _0x13eb3b=_0x9e6329;_0xe7e92c[_0x3ec5ae][_0x13eb3b(0x190)]=_0x301bbc;}),_0x9f2967[_0x9e6329(0x151)]((_0x3e3878,_0x211409)=>{var _0x35b913=_0x9e6329;_0xe7e92c[_0x211409][_0x35b913(0x116)]=_0x3e3878;}),_0x5ad1bf['forEach']((_0x3853f2,_0x345a77)=>{var _0x1eec51=_0x9e6329;_0xe7e92c[_0x345a77][_0x1eec51(0x1c8)]=_0x3853f2;}),_0x570608[_0x9e6329(0x151)]((_0x35ee91,_0x4037a3)=>{_0xe7e92c[_0x4037a3]['production_date']=_0x35ee91;}),_0x4a97a5[_0x9e6329(0x151)]((_0x3a1181,_0xef2e9f)=>{var _0x50cce0=_0x9e6329;_0xe7e92c[_0xef2e9f][_0x50cce0(0x146)]=_0x3a1181;});const _0x344c70=await sales_finished[_0x9e6329(0x180)]({'invoice':_0x3a682f});_0x344c70[_0x9e6329(0x1ae)]=_0x9e6329(0x1b8);const _0x1d1cd7=await _0x344c70[_0x9e6329(0x140)](),_0x35e1e0=new sales_return_finished({'invoice':_0x3a682f,'customer':_0x340f07[_0x9e6329(0x111)][_0x9e6329(0xec)],'date':_0x3e314e,'warehouse_name':_0x3736bd,'room':_0x4e4733,'ToWarehouse':_0x593168,'ToRoom':_0x146643,'return_sale_QA':_0xe7e92c,'note':_0x334b0b,'warehouse_cat':_0x406690}),_0x491602=await _0x35e1e0[_0x9e6329(0x140)](),_0x113ca4=await sales_return_finished[_0x9e6329(0x180)]({'invoice':_0x3a682f}),_0x23b5f2=await warehouse['findOne']({'name':_0x593168,'room':_0x146643});_0x113ca4[_0x9e6329(0x121)]['forEach'](_0x1bae8f=>{var _0x423708=_0x9e6329,_0x34695c=0x0;const _0x2e2bd1=_0x23b5f2[_0x423708(0x104)][_0x423708(0x1c5)](_0x2b8491=>{var _0x43ca0a=_0x423708;_0x2b8491[_0x43ca0a(0x199)]==_0x1bae8f[_0x43ca0a(0x199)]&&_0x2b8491['expiry_date']==_0x1bae8f['expiry_date']&&_0x2b8491[_0x43ca0a(0x1a7)]==_0x1bae8f['production_date']&&_0x2b8491['batch_code']==_0x1bae8f['batch_code']&&(_0x2b8491['product_stock']=parseInt(_0x2b8491['product_stock'])+parseInt(_0x1bae8f['return_qty']),_0x34695c++);});_0x34695c=='0'&&(_0x23b5f2['product_details']=_0x23b5f2[_0x423708(0x104)][_0x423708(0x14a)]({'product_name':_0x1bae8f['product_name'],'product_stock':_0x1bae8f[_0x423708(0x143)],'primary_code':_0x1bae8f[_0x423708(0xe2)],'secondary_code':_0x1bae8f['secondary_code'],'product_code':_0x1bae8f[_0x423708(0x1e5)],'batch_code':_0x1bae8f[_0x423708(0x190)],'maxPerUnit':_0x1bae8f[_0x423708(0x188)],'production_date':_0x1bae8f[_0x423708(0x1a7)],'expiry_date':_0x1bae8f[_0x423708(0x146)],'secondary_unit':_0x1bae8f['secondary_unit'],'unit':_0x1bae8f[_0x423708(0x1c8)],'maxProducts':_0x1bae8f[_0x423708(0x163)],'bay':_0x1bae8f[_0x423708(0xf4)]}));}),await _0x23b5f2[_0x9e6329(0x140)]();const _0x4421dc=new c_payment_data({'invoice':_0x3a682f,'customer':_0x340f07[_0x9e6329(0x111)][_0x9e6329(0xec)],'reason':_0x9e6329(0xda)});await _0x4421dc['save']();const _0xfbecdb=await master_shop[_0x9e6329(0x181)](),_0xa15aec=await email_settings[_0x9e6329(0x180)](),_0x42e177=await customer['findOne']({'name':_0x340f07[_0x9e6329(0x111)]['customer']});_0xfbecdb[0x0]['currency_placement']==0x1?(right_currency=_0xfbecdb[0x0][_0x9e6329(0x145)],left_currency=''):(right_currency='',left_currency=_0xfbecdb[0x0]['currency']);var _0x4feb10=_0x20632e,_0x1b28e8=_0x49eac4,_0x3aa514='',_0x44edb6;for(_0x44edb6 in _0x4feb10){_0x3aa514+=_0x9e6329(0xe1)+_0x9e6329(0x1b4)+_0x4feb10[_0x44edb6]+'</td>'+_0x9e6329(0x1b4)+_0x1b28e8[_0x44edb6]+_0x9e6329(0x107)+_0x9e6329(0xfc);}console[_0x9e6329(0x168)](_0x9e6329(0x150),_0x3aa514);let _0x26b4bc=nodemailer['createTransport']({'service':_0x9e6329(0x18d),'auth':{'user':_0xa15aec[_0x9e6329(0x1bc)],'pass':_0xa15aec[_0x9e6329(0x175)]}}),_0xc5baf4={'from':_0xa15aec[_0x9e6329(0x1bc)],'to':_0x42e177[_0x9e6329(0x1bc)],'subject':_0x9e6329(0xdd),'attachments':[{'filename':_0x9e6329(0x195),'path':__dirname+'/../public'+_0x9e6329(0x1b5)+_0xfbecdb[0x0][_0x9e6329(0x197)],'cid':_0x9e6329(0xed)}],'html':_0x9e6329(0x16e)+'<html><head><title></title>'+_0x9e6329(0x1b9)+_0x9e6329(0x171)+_0x9e6329(0x13f)+_0x9e6329(0x171)+_0x9e6329(0x124)+_0x9e6329(0x1e8)+_0x9e6329(0x171)+_0x9e6329(0x1c3)+_0xfbecdb[0x0]['site_title']+_0x9e6329(0x14b)+_0x9e6329(0x1e8)+'</div>'+_0x9e6329(0x179)+_0x9e6329(0x171)+_0x9e6329(0x1c6)+_0x9e6329(0x1d3)+_0x3a682f+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x9e6329(0x15e)+_0x3e314e+'\x20'+_0x9e6329(0x109)+'</h5>'+_0x9e6329(0x1e8)+_0x9e6329(0x187)+_0x9e6329(0x119)+_0x9e6329(0xe1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x9e6329(0xfb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x9e6329(0x17a)+_0x9e6329(0xfc)+_0x9e6329(0x1dd)+_0x9e6329(0x154)+'\x20'+_0x3aa514+'\x20'+_0x9e6329(0x15f)+_0x9e6329(0x137)+_0x9e6329(0x171)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0xfbecdb[0x0]['site_title']+_0x9e6329(0x144)+_0x9e6329(0x1e8)+'</div>'+_0x9e6329(0x1d4)};_0x26b4bc['sendMail'](_0xc5baf4,function(_0x6cd69b,_0x29da54){var _0x382fd8=_0x9e6329;_0x6cd69b?(console[_0x382fd8(0x168)](_0x6cd69b),console[_0x382fd8(0x168)](_0x382fd8(0xf5))):console[_0x382fd8(0x168)]('Email\x20sent\x20successfully');}),_0x340f07[_0x9e6329(0x1cf)](_0x9e6329(0x1ca),'sales\x20item\x20return\x20successfull'),_0x7d01e5[_0x9e6329(0xf1)](_0x9e6329(0x1d5));}catch(_0x2ab4ee){_0x7d01e5[_0x9e6329(0x1b3)](0xc8)['json']({'message1':_0x2ab4ee[_0x9e6329(0x185)]});}else{if(_0x340f07['body'][_0x9e6329(0x110)]=='GS')try{const {invoice:_0x497199,date:_0x1899fd,warehouse_name:_0xcb6885,product_name:_0x5d48a1,primary_code:_0x49cc16,secondary_code:_0x209e9a,product_code:_0x32565a,sales_quantity:_0xa39f5,stocks:_0x40ff3a,return_qty:_0x1b4126,Room_name:_0x4cd933,to_warehouse_name:_0xc8d0cd,to_Room_name:_0x393fcc,note:_0x3d44dd,level:_0x692b8d,isle:_0x1a023b,pallet:_0x6b0a0a,for_categorize:_0xf9c4fa}=_0x340f07['body'];if(typeof _0x5d48a1==_0x9e6329(0x1d0))var _0x20632e=[_0x340f07['body']['product_name']],_0x2f6aab=[_0x340f07['body'][_0x9e6329(0xe2)]],_0x42e496=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x100)]],_0x1c170b=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1e5)]],_0x19b413=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0xe8)]],_0x49eac4=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x143)]],_0x1eb4e2=[_0x340f07[_0x9e6329(0x111)]['bay']],_0x222ad3=[_0x340f07[_0x9e6329(0x111)]['maxPerUnit']],_0x51df46=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x163)]],_0x194447=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x190)]],_0x9f2967=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x116)]],_0x5ad1bf=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x1c8)]],_0x570608=[_0x340f07['body'][_0x9e6329(0x1a7)]],_0x4a97a5=[_0x340f07[_0x9e6329(0x111)][_0x9e6329(0x146)]];else var _0x20632e=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x199)]],_0x2f6aab=[..._0x340f07[_0x9e6329(0x111)]['primary_code']],_0x42e496=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x100)]],_0x1c170b=[..._0x340f07['body'][_0x9e6329(0x1e5)]],_0x19b413=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0xe8)]],_0x49eac4=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x143)]],_0x1eb4e2=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0xf4)]],_0x222ad3=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x188)]],_0x51df46=[..._0x340f07['body']['maxProducts']],_0x194447=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x190)]],_0x9f2967=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x116)]],_0x5ad1bf=[..._0x340f07[_0x9e6329(0x111)]['unit']],_0x570608=[..._0x340f07['body'][_0x9e6329(0x1a7)]],_0x4a97a5=[..._0x340f07[_0x9e6329(0x111)][_0x9e6329(0x146)]];const _0xf1c45f=_0x20632e['map'](_0x35f8a6=>{return _0x35f8a6={'product_name':_0x35f8a6};});_0x2f6aab[_0x9e6329(0x151)]((_0x55ce26,_0x5ab4a8)=>{var _0x4e58be=_0x9e6329;_0xf1c45f[_0x5ab4a8][_0x4e58be(0xe2)]=_0x55ce26;}),_0x42e496[_0x9e6329(0x151)]((_0x31679e,_0x9a4df4)=>{var _0x5d017f=_0x9e6329;_0xf1c45f[_0x9a4df4][_0x5d017f(0x100)]=_0x31679e;}),_0x1c170b['forEach']((_0x137e56,_0x3d2e33)=>{var _0x1c2de6=_0x9e6329;_0xf1c45f[_0x3d2e33][_0x1c2de6(0x1e5)]=_0x137e56;}),_0x19b413[_0x9e6329(0x151)]((_0x344c5f,_0x27094d)=>{var _0x8ad23f=_0x9e6329;_0xf1c45f[_0x27094d][_0x8ad23f(0xde)]=_0x344c5f;}),_0x49eac4['forEach']((_0x19baf4,_0x5df38c)=>{var _0x34ce14=_0x9e6329;_0xf1c45f[_0x5df38c][_0x34ce14(0x143)]=_0x19baf4;}),_0x1eb4e2[_0x9e6329(0x151)]((_0x480220,_0xbef10c)=>{var _0x2b312d=_0x9e6329;_0xf1c45f[_0xbef10c][_0x2b312d(0xf4)]=_0x480220;}),_0x222ad3['forEach']((_0x274507,_0x4f04d0)=>{var _0x1d4dc8=_0x9e6329;_0xf1c45f[_0x4f04d0][_0x1d4dc8(0x188)]=_0x274507;}),_0x51df46[_0x9e6329(0x151)]((_0x3188fc,_0x792e4c)=>{var _0x15de99=_0x9e6329;_0xf1c45f[_0x792e4c][_0x15de99(0x163)]=_0x3188fc;}),_0x194447[_0x9e6329(0x151)]((_0x178a25,_0x4f9dcc)=>{var _0x22a218=_0x9e6329;_0xf1c45f[_0x4f9dcc][_0x22a218(0x190)]=_0x178a25;}),_0x9f2967[_0x9e6329(0x151)]((_0x4192ba,_0x19bb19)=>{var _0x10ca7e=_0x9e6329;_0xf1c45f[_0x19bb19][_0x10ca7e(0x116)]=_0x4192ba;}),_0x5ad1bf['forEach']((_0x1d332f,_0x3e9a42)=>{_0xf1c45f[_0x3e9a42]['unit']=_0x1d332f;}),_0x570608['forEach']((_0x34ad24,_0x161497)=>{_0xf1c45f[_0x161497]['production_date']=_0x34ad24;}),_0x4a97a5['forEach']((_0x26eb9c,_0x65bc)=>{var _0x38175f=_0x9e6329;_0xf1c45f[_0x65bc][_0x38175f(0x146)]=_0x26eb9c;});var _0xf5f2b7=0x0;_0xf1c45f[_0x9e6329(0x151)](_0x22e1c6=>{var _0x3734ca=_0x9e6329;(parseInt(_0x22e1c6['sale_qty'])<parseInt(_0x22e1c6[_0x3734ca(0x143)])||parseInt(_0x22e1c6[_0x3734ca(0x177)])<parseInt(_0x22e1c6['return_qty'])&&parseInt(_0x22e1c6['sale_qty'])>parseInt(_0x22e1c6[_0x3734ca(0x143)])||parseInt(_0x22e1c6[_0x3734ca(0x143)])==0x0)&&_0xf5f2b7++;});if(_0xf5f2b7!=0x0)return _0x340f07[_0x9e6329(0x1cf)](_0x9e6329(0x1a8),_0x9e6329(0x1c4)),_0x7d01e5[_0x9e6329(0xf1)](_0x9e6329(0x118));const _0x355ffa=await sales_finished[_0x9e6329(0x180)]({'invoice':_0x497199});_0x355ffa[_0x9e6329(0x1ae)]='True';const _0x397418=await _0x355ffa[_0x9e6329(0x140)](),_0x14b912=new sales_return_finished({'invoice':_0x497199,'customer':_0x340f07[_0x9e6329(0x111)][_0x9e6329(0xec)],'date':_0x1899fd,'warehouse_name':_0xcb6885,'room':_0x4cd933,'ToWarehouse':_0xc8d0cd,'ToRoom':_0x393fcc,'return_sale':_0xf1c45f,'note':_0x3d44dd,'warehouse_cat':_0xf9c4fa}),_0x4ab71f=await _0x14b912['save'](),_0x5281bb=await sales_return_finished['findOne']({'invoice':_0x497199}),_0x547dc1=await warehouse[_0x9e6329(0x180)]({'name':_0xc8d0cd,'room':_0x393fcc,'warehouse_category':_0x9e6329(0x152)});_0x5281bb[_0x9e6329(0x12c)][_0x9e6329(0x151)](_0x4e7ae8=>{var _0x1e1c60=_0x9e6329,_0x263a13=0x0;const _0x217f36=_0x547dc1[_0x1e1c60(0x104)][_0x1e1c60(0x1c5)](_0x3e3836=>{var _0x56f614=_0x1e1c60;_0x3e3836['product_name']==_0x4e7ae8['product_name']&&_0x3e3836['bay']==_0x4e7ae8[_0x56f614(0xf4)]&&_0x3e3836[_0x56f614(0x146)]==_0x4e7ae8[_0x56f614(0x146)]&&_0x3e3836[_0x56f614(0x1a7)]==_0x4e7ae8[_0x56f614(0x1a7)]&&_0x3e3836[_0x56f614(0x190)]==_0x4e7ae8['batch_code']&&(_0x3e3836[_0x56f614(0x130)]=parseInt(_0x3e3836[_0x56f614(0x130)])+parseInt(_0x4e7ae8['return_qty']),_0x263a13++);});_0x263a13=='0'&&(_0x547dc1['product_details']=_0x547dc1[_0x1e1c60(0x104)][_0x1e1c60(0x14a)]({'product_name':_0x4e7ae8[_0x1e1c60(0x199)],'product_stock':_0x4e7ae8[_0x1e1c60(0x143)],'primary_code':_0x4e7ae8['primary_code'],'secondary_code':_0x4e7ae8[_0x1e1c60(0x100)],'product_code':_0x4e7ae8['product_code'],'bay':_0x4e7ae8[_0x1e1c60(0xf4)],'batch_code':_0x4e7ae8['batch_code'],'maxPerUnit':_0x4e7ae8['maxPerUnit'],'production_date':_0x4e7ae8[_0x1e1c60(0x1a7)],'expiry_date':_0x4e7ae8[_0x1e1c60(0x146)],'secondary_unit':_0x4e7ae8[_0x1e1c60(0x116)],'unit':_0x4e7ae8[_0x1e1c60(0x1c8)],'maxProducts':_0x4e7ae8[_0x1e1c60(0x163)]}));}),await _0x547dc1[_0x9e6329(0x140)](),console[_0x9e6329(0x168)](_0x340f07['body']);const _0x5733c2=new c_payment_data({'invoice':_0x497199,'customer':_0x340f07['body']['customer'],'reason':_0x9e6329(0xda)});await _0x5733c2[_0x9e6329(0x140)]();const _0xdce6b2=await master_shop[_0x9e6329(0x181)]();console['log'](_0x9e6329(0x16f),_0xdce6b2[0x0]['image']);const _0x5e9d2f=await email_settings[_0x9e6329(0x180)](),_0x3f1488=await customer[_0x9e6329(0x180)]({'name':_0x340f07['body']['customer']});console[_0x9e6329(0x168)](_0x9e6329(0x17f),_0x3f1488);_0xdce6b2[0x0][_0x9e6329(0x1ac)]==0x1?(right_currency=_0xdce6b2[0x0][_0x9e6329(0x145)],left_currency=''):(right_currency='',left_currency=_0xdce6b2[0x0][_0x9e6329(0x145)]);var _0x4feb10=_0x20632e,_0x1b28e8=_0x49eac4,_0x3aa514='',_0x44edb6;for(_0x44edb6 in _0x4feb10){_0x3aa514+=_0x9e6329(0xe1)+_0x9e6329(0x1b4)+_0x4feb10[_0x44edb6]+_0x9e6329(0x107)+_0x9e6329(0x1b4)+_0x1b28e8[_0x44edb6]+_0x9e6329(0x107)+'</tr>';}console[_0x9e6329(0x168)](_0x9e6329(0x150),_0x3aa514);let _0x31c302=nodemailer['createTransport']({'service':_0x9e6329(0x18d),'auth':{'user':_0x5e9d2f[_0x9e6329(0x1bc)],'pass':_0x5e9d2f[_0x9e6329(0x175)]}}),_0x15b99e={'from':_0x5e9d2f[_0x9e6329(0x1bc)],'to':_0x3f1488[_0x9e6329(0x1bc)],'subject':_0x9e6329(0xdd),'attachments':[{'filename':_0x9e6329(0x195),'path':__dirname+_0x9e6329(0x194)+_0x9e6329(0x1b5)+_0xdce6b2[0x0][_0x9e6329(0x197)],'cid':_0x9e6329(0xed)}],'html':_0x9e6329(0x16e)+_0x9e6329(0x1c0)+_0x9e6329(0x1b9)+_0x9e6329(0x171)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x9e6329(0x1e8)+_0x9e6329(0x171)+_0x9e6329(0x1c3)+_0xdce6b2[0x0]['site_title']+_0x9e6329(0x14b)+_0x9e6329(0x1e8)+_0x9e6329(0x1e8)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x9e6329(0x1c6)+_0x9e6329(0x1d3)+_0x497199+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x9e6329(0x15e)+_0x1899fd+'\x20'+_0x9e6329(0x109)+_0x9e6329(0x144)+_0x9e6329(0x1e8)+_0x9e6329(0x187)+_0x9e6329(0x119)+'<tr>'+_0x9e6329(0xff)+_0x9e6329(0xfb)+_0x9e6329(0xdf)+_0x9e6329(0x17a)+_0x9e6329(0xfc)+'</thead>'+_0x9e6329(0x154)+'\x20'+_0x3aa514+'\x20'+_0x9e6329(0x15f)+_0x9e6329(0x137)+_0x9e6329(0x171)+_0x9e6329(0x192)+_0x9e6329(0x173)+_0xdce6b2[0x0][_0x9e6329(0xee)]+_0x9e6329(0x144)+_0x9e6329(0x1e8)+'</div>'+_0x9e6329(0x1d4)};_0x31c302[_0x9e6329(0x165)](_0x15b99e,function(_0xe3faed,_0x27a44c){var _0x337005=_0x9e6329;_0xe3faed?(console[_0x337005(0x168)](_0xe3faed),console[_0x337005(0x168)](_0x337005(0xf5))):console[_0x337005(0x168)](_0x337005(0xf8));}),_0x340f07['flash'](_0x9e6329(0x1ca),_0x9e6329(0x11c)),_0x7d01e5[_0x9e6329(0xf1)](_0x9e6329(0x1d5));}catch(_0x1c3b37){console[_0x9e6329(0x168)](_0x1c3b37),_0x7d01e5[_0x9e6329(0x1b3)](0xc8)[_0x9e6329(0x184)]({'message1':_0x1c3b37[_0x9e6329(0x185)]});}}}),router[a0_0x275e41(0x117)](a0_0x275e41(0x15c),auth,async(_0x1c42dc,_0x38ce81)=>{var _0x4ec473=a0_0x275e41;try{const {username:_0x536cd3,email:_0x15dd82,role:_0x3456bf}=_0x1c42dc['user'],_0x12ced9=_0x1c42dc[_0x4ec473(0x11a)],_0x26f269=await profile[_0x4ec473(0x180)]({'email':_0x12ced9[_0x4ec473(0x1bc)]}),_0x3e828b=await master_shop[_0x4ec473(0x181)]();console[_0x4ec473(0x168)](_0x4ec473(0x12f),_0x3e828b);const _0x5b2018=_0x1c42dc[_0x4ec473(0x1ce)]['id'],_0x46a4d9=await sales['findById'](_0x5b2018);console[_0x4ec473(0x168)](_0x4ec473(0x149),_0x46a4d9);if(_0x3e828b[0x0]['language']=='English\x20(US)')var _0x26ea58=users[_0x4ec473(0x1be)];else{if(_0x3e828b[0x0]['language']==_0x4ec473(0x14c))var _0x26ea58=users[_0x4ec473(0x14c)];else{if(_0x3e828b[0x0]['language']==_0x4ec473(0x159))var _0x26ea58=users[_0x4ec473(0x159)];else{if(_0x3e828b[0x0][_0x4ec473(0x1ec)]==_0x4ec473(0x19d))var _0x26ea58=users[_0x4ec473(0x19d)];else{if(_0x3e828b[0x0][_0x4ec473(0x1ec)]=='French')var _0x26ea58=users[_0x4ec473(0x18b)];else{if(_0x3e828b[0x0]['language']==_0x4ec473(0x193))var _0x26ea58=users['Portuguese'];else{if(_0x3e828b[0x0][_0x4ec473(0x1ec)]==_0x4ec473(0xe5))var _0x26ea58=users['Chinese'];else{if(_0x3e828b[0x0][_0x4ec473(0x1ec)]==_0x4ec473(0x135))var _0x26ea58=users[_0x4ec473(0x1d9)];}}}}}}}_0x38ce81[_0x4ec473(0x160)](_0x4ec473(0xfe),{'success':_0x1c42dc['flash'](_0x4ec473(0x1ca)),'errors':_0x1c42dc['flash'](_0x4ec473(0x1a8)),'role':_0x12ced9,'profile':_0x26f269,'alldata':_0x46a4d9,'master_shop':_0x3e828b,'language':_0x26ea58});}catch(_0x1cffef){console['log'](_0x1cffef);}}),router['post']('/barcode_scanner',async(_0xfc8d4b,_0x4c9f6c)=>{var _0x4e6aff=a0_0x275e41;const {product_code:_0x5a64c5,warehouse_name:_0x23169a,rooms_data:_0x1d7d71,Roomslist:_0x61e6ec}=_0xfc8d4b[_0x4e6aff(0x111)],_0x58b4d9=_0x61e6ec['split'](','),_0x3cebc6=[];async function _0x4867e8(_0x8e6ea){var _0x5a4e5f=_0x4e6aff;const _0x14313c=await warehouse[_0x5a4e5f(0x1a3)]([{'$match':{'name':_0x23169a,'room':_0x8e6ea}},{'$unwind':_0x5a4e5f(0x138)},{'$match':{'product_details.primary_code':_0x5a64c5}},{'$group':{'_id':_0x5a4e5f(0x13e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5a4e5f(0x1af)},'primary_code':{'$first':_0x5a4e5f(0x131)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5a4e5f(0x1bd)},'type':{'$first':_0x5a4e5f(0x1e0)},'pallet':{'$first':_0x5a4e5f(0x1d6)},'unit':{'$first':_0x5a4e5f(0x1e2)},'secondary_unit':{'$first':_0x5a4e5f(0x10e)},'storage':{'$first':_0x5a4e5f(0x16b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x5a4e5f(0x1a6)},'maxPerUnit':{'$first':_0x5a4e5f(0x161)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x5a4e5f(0x1db)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x5a4e5f(0x11b)}}}]),_0x8324dd=await warehouse[_0x5a4e5f(0x1a3)]([{'$match':{'name':_0x23169a,'room':_0x8e6ea}},{'$unwind':_0x5a4e5f(0x138)},{'$match':{'product_details.secondary_code':_0x5a64c5}},{'$group':{'_id':_0x5a4e5f(0x13e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5a4e5f(0x1af)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5a4e5f(0x12e)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5a4e5f(0x125)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x5a4e5f(0x1e0)},'pallet':{'$first':_0x5a4e5f(0x1d6)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5a4e5f(0x10e)},'storage':{'$first':_0x5a4e5f(0x16b)},'rack':{'$first':_0x5a4e5f(0x1e1)},'expiry_date':{'$first':_0x5a4e5f(0x17c)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x5a4e5f(0x196)},'product_cat':{'$first':_0x5a4e5f(0x1db)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5a4e5f(0x141)},'invoice':{'$first':_0x5a4e5f(0x11b)}}}]);if(_0x14313c[_0x5a4e5f(0x158)]>0x0)_0x3cebc6['push'](_0x14313c);else _0x8324dd[_0x5a4e5f(0x158)]>0x0&&_0x3cebc6['push'](_0x8324dd);}const _0x31bcca=_0x58b4d9['map'](_0x5bc36f=>_0x4867e8(_0x5bc36f));await Promise[_0x4e6aff(0x128)](_0x31bcca),_0x4c9f6c[_0x4e6aff(0x184)](_0x3cebc6);}),module[a0_0x275e41(0x16c)]=router;