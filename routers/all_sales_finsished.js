function a0_0x5511(){var _0x50ced9=['return_data','secondary_unit_QA','primary_code','$sale_product','staff','purchases_data','return_sale_finished','product_list','$product_details','../middleware/auth','gmail','13336VnpUrW','currency_placement','$product_details.primary_code','<html><head><title></title>','for_categorize','$sale_product.type','getDate','/view/add_sale/product','$sale_product.bin','3216213txruWx','max','Received\x20Payment\x20For\x20Sale','\x20<<<==>>>\x20','$product_details.product_cat','createTransport','maxProducts_QA','map','return_qty','floor','<hr\x20class=\x22my-3\x22>','catch','forEach','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','warehouse_name','/view/return_sales/:id','<span\x20style=\x22float:\x20right;\x22>','$product_details.storage','/all_sales_finished/view','912ePBbhj','German','post','slice','$product_details.expiry_date','</body></html>','max_per_unit','$product_details.floorlevel','message','aggregate','host','sale_qty','return_qty_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','maxProducts','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','flash','$sale_product.quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$product_details.type','batch_code','<h2>\x20','master','product_name','product_code_QA','Hindi','unit_QA','OUTF-','$product','stocks_QA','language','<strong>\x20Regards\x20</strong>','port','Arabic\x20(ae)','sales_invoice','Ambient','getMonth','express','$product_details.bay','carton','errors','sales_quantity','$customer','$invoice','level','5222RkTCkz','product_data','getFullYear','product_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','\x20</h2>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','sale_product','nodemailer','</thead>','$product_details.secondary_code','/view/:id','/picking_list/pdf/','padStart','</h5>','payment\x20successfull','Email\x20sent\x20successfully','Spanish','save','1615OaWjzb','note','\x20Order\x20Date\x20:\x20','</tbody>','True','/all_sales_finished/preview/','/preview/:id','An\x20error\x20occurred.','findById','status','push','prod_cat','customer','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','string','amount','log','abs','maxPerUnit','secondary_code_QA','split','<table\x20style=\x22width:\x20100%\x20!important;\x22>','primary_code_QA','role','$product_details._id','\x20==\x20','$note','logo','find','$product_details.maxProducts','QA\x20Warehouse','Portuguese','customers','product_date','length','batch_code_QA','\x20>>>\x20','/barcode_scanner','Sale\x20Return','/view/add_sales','email','sendMail','$name','Quality\x20Inspection','Sale\x20Return\x20Mail','/invoice/:id','Finished\x20Goods','1114534kOGepm','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','room','sales\x20item\x20return\x20successfull','all','1751816tqQiTp','</tr>','edit_sales_finished','10XEOMVg','maxperunit','warehouse','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','invoice','product_details','/../public','site_title','password','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product.product_name','$finalize','$product_details.secondary_unit','params','findOne','$sale_product.bay','\x20Order\x20Number\x20:\x20','currency','\x20&&\x20','expiry_date','/barcode/:id','<h5\x20style=\x22text-align:\x20left;\x22>','unit','$warehouse_name','product_name_QA1','foreach\x20newproduct','redirect','prod_invoice','image','maxPerUnit_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','received_amount','$date','final','Portuguese\x20(BR)','$product_details.maxPerUnit','Error\x20Occurs','adjust_qty','/upload/','<h5>','<div>','product_stock','back','</div>','body','/view/add_sales/:id','$product_details.invoice','concat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','$product_details.rack','English','$product_details.product_name','$return_data','filter','Router','2466IWNeZx','Return\x20Rooms','stock','</table>','Logo.png','then','/give_payment/:id','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','id_transaction_from','$product_details.product_stock','return_sale','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','primary_unit','get','Sales\x20Mail','user','_id','json','sales_quantity_QA','English\x20(US)','production_date_QA','$product_details.batch_code','../public/language/languages.json','due_amount','Chinese','suppliers','prod_code','1044zMuMce','customers_docs','success','FGSEmail','Arabic','Sales\x20Add\x20successfully','room_name','secondary_code','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.product_code','RoomAssigned','</span>','<!DOCTYPE\x20html>','render','$product_details.room_name','secondary_unit','error','$product_details.unit','all_sales_finished','</td>','751847zHvFBx','Enabled','production_date','Sale','</head><body>','$product_details.bin','French','$product_details.production_date','$_id','<tr>','expiry_date_QA','quantity','Enclosed','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','add\x20post','$customers_docs'];a0_0x5511=function(){return _0x50ced9;};return a0_0x5511();}var a0_0x2c2748=a0_0x3a67;(function(_0x4bbd88,_0x1bd76f){var _0x59075f=a0_0x3a67,_0xeb6f89=_0x4bbd88();while(!![]){try{var _0x2b38f8=-parseInt(_0x59075f(0xe8))/0x1+parseInt(_0x59075f(0x190))/0x2+parseInt(_0x59075f(0x10c))/0x3+parseInt(_0x59075f(0xd4))/0x4*(parseInt(_0x59075f(0x161))/0x5)+parseInt(_0x59075f(0x11f))/0x6*(-parseInt(_0x59075f(0x14e))/0x7)+-parseInt(_0x59075f(0x103))/0x8*(parseInt(_0x59075f(0xb8))/0x9)+parseInt(_0x59075f(0x199))/0xa*(parseInt(_0x59075f(0x196))/0xb);if(_0x2b38f8===_0x1bd76f)break;else _0xeb6f89['push'](_0xeb6f89['shift']());}catch(_0xa871e5){_0xeb6f89['push'](_0xeb6f89['shift']());}}}(a0_0x5511,0x867f4));function a0_0x3a67(_0x489449,_0x29a273){var _0x551174=a0_0x5511();return a0_0x3a67=function(_0x3a67eb,_0x27136c){_0x3a67eb=_0x3a67eb-0x8d;var _0x98de97=_0x551174[_0x3a67eb];return _0x98de97;},a0_0x3a67(_0x489449,_0x29a273);}const express=require(a0_0x2c2748(0x146)),app=express(),router=express[a0_0x2c2748(0xb7)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x2c2748(0x101)),nodemailer=require(a0_0x2c2748(0x156)),users=require(a0_0x2c2748(0xcf));router[a0_0x2c2748(0xc6)]('/view',auth,async(_0x36c267,_0x1f2b89)=>{var _0x43662d=a0_0x2c2748;try{const {username:_0x3d21df,email:_0x287514,role:_0xe7a60d}=_0x36c267[_0x43662d(0xc8)],_0xedf7a1=_0x36c267[_0x43662d(0xc8)],_0x18507f=await profile[_0x43662d(0x8f)]({'email':_0xedf7a1[_0x43662d(0x189)]}),_0x464ccb=await master_shop[_0x43662d(0x17d)]();let _0x370e33;if(_0xedf7a1['role']==_0x43662d(0xfc)){const _0xda5fc9=await staff['findOne']({'email':_0xedf7a1[_0x43662d(0x189)]});_0x370e33=await sales_finished[_0x43662d(0x128)]([{'$lookup':{'from':_0x43662d(0x181),'localField':'customer','foreignField':'name','as':'customers_docs'}},{'$unwind':_0x43662d(0xf7)},{'$unwind':_0x43662d(0xfb)},{'$group':{'_id':_0x43662d(0xf0),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x43662d(0x14b)},'date':{'$first':_0x43662d(0xa1)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x43662d(0xfb)},'note':{'$first':_0x43662d(0x17b)},'return_data':{'$first':_0x43662d(0xb5)},'customers_docs':{'$first':_0x43662d(0xf7)},'total_saleproduct_quantity':{'$sum':_0x43662d(0x132)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x43662d(0x10b)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x43662d(0x1a4)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x370e33=await sales_finished[_0x43662d(0x128)]([{'$lookup':{'from':_0x43662d(0x181),'localField':'customer','foreignField':'name','as':_0x43662d(0xd5)}},{'$unwind':_0x43662d(0xf7)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x43662d(0xf0),'invoice':{'$first':_0x43662d(0x14c)},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x43662d(0x98)},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x43662d(0x90)},'isle':{'$addToSet':_0x43662d(0x10b)},'type':{'$addToSet':_0x43662d(0x108)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x43662d(0x1a4)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x464ccb[0x0][_0x43662d(0x13f)]==_0x43662d(0xcc)){var _0x149db9=users['English'];console[_0x43662d(0x171)](_0x149db9);}else{if(_0x464ccb[0x0][_0x43662d(0x13f)]==_0x43662d(0x13a))var _0x149db9=users[_0x43662d(0x13a)];else{if(_0x464ccb[0x0][_0x43662d(0x13f)]==_0x43662d(0x120))var _0x149db9=users[_0x43662d(0x120)];else{if(_0x464ccb[0x0][_0x43662d(0x13f)]=='Spanish')var _0x149db9=users[_0x43662d(0x15f)];else{if(_0x464ccb[0x0][_0x43662d(0x13f)]==_0x43662d(0xee))var _0x149db9=users[_0x43662d(0xee)];else{if(_0x464ccb[0x0][_0x43662d(0x13f)]=='Portuguese\x20(BR)')var _0x149db9=users['Portuguese'];else{if(_0x464ccb[0x0]['language']==_0x43662d(0xd1))var _0x149db9=users[_0x43662d(0xd1)];else{if(_0x464ccb[0x0][_0x43662d(0x13f)]==_0x43662d(0x142))var _0x149db9=users[_0x43662d(0xd8)];}}}}}}}_0x1f2b89['render'](_0x43662d(0xe6),{'success':_0x36c267['flash'](_0x43662d(0xd6)),'errors':_0x36c267[_0x43662d(0x131)](_0x43662d(0x149)),'sales':_0x370e33,'profile':_0x18507f,'role':_0xedf7a1,'master_shop':_0x464ccb,'language':_0x149db9});}catch(_0x2fdac6){console[_0x43662d(0x171)](_0x2fdac6);}});async function getRandom8DigitNumber(){var _0x5857b5=a0_0x2c2748;const _0x20c017=0x989680,_0x5a77e3=0x5f5e0ff,_0x57eb5e=Math[_0x5857b5(0x115)](Math['random']()*(_0x5a77e3-_0x20c017+0x1))+_0x20c017;var _0x5b6ad3;const _0x3278dc=await sales_finished['findOne']({'invoice':_0x5857b5(0x13c)+_0x57eb5e});return _0x3278dc&&_0x3278dc[_0x5857b5(0x183)]>0x0?_0x5b6ad3='OUTF-'+_0x57eb5e:_0x5b6ad3=_0x5857b5(0x13c)+_0x57eb5e,_0x5b6ad3;}router[a0_0x2c2748(0xc6)](a0_0x2c2748(0x188),auth,async(_0x5e15ff,_0x33e0ef)=>{var _0x595b3f=a0_0x2c2748;try{const {username:_0x424b48,email:_0x3df77b,role:_0x50d890}=_0x5e15ff['user'],_0x6ea202=_0x5e15ff[_0x595b3f(0xc8)],_0x512ce7=await profile[_0x595b3f(0x8f)]({'email':_0x6ea202[_0x595b3f(0x189)]}),_0x1286dd=await master_shop['find'](),_0x1161c0=await customer[_0x595b3f(0x17d)]({});let _0x139d7b;if(_0x6ea202[_0x595b3f(0x178)]==_0x595b3f(0xfc)){const _0x11ccfe=await staff['findOne']({'email':_0x6ea202[_0x595b3f(0x189)]});_0x139d7b=await warehouse[_0x595b3f(0x128)]([{'$match':{'status':_0x595b3f(0xe9),'name':_0x11ccfe[_0x595b3f(0x19b)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x595b3f(0x17f)}}},{'$group':{'_id':_0x595b3f(0x18b),'name':{'$first':_0x595b3f(0x18b)}}},{'$sort':{'name':0x1}}]);}else _0x139d7b=await warehouse['aggregate']([{'$match':{'status':_0x595b3f(0xe9),'warehouse_category':_0x595b3f(0x18f),'name':{'$ne':_0x595b3f(0x17f)}}},{'$group':{'_id':_0x595b3f(0x18b),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0xc59d1f=await product[_0x595b3f(0x17d)]({});var _0x464eef=['Ambient',_0x595b3f(0xf4)];const _0x4f6c3=await sales_finished[_0x595b3f(0x17d)]({}),_0x4b8b0a=_0x4f6c3['length']+0x1,_0x201d47=_0x595b3f(0x13c)+_0x4b8b0a['toString']()[_0x595b3f(0x15b)](0x5,'0');if(_0x1286dd[0x0][_0x595b3f(0x13f)]==_0x595b3f(0xcc)){var _0x327af5=users['English'];console[_0x595b3f(0x171)](_0x327af5);}else{if(_0x1286dd[0x0][_0x595b3f(0x13f)]==_0x595b3f(0x13a))var _0x327af5=users['Hindi'];else{if(_0x1286dd[0x0][_0x595b3f(0x13f)]==_0x595b3f(0x120))var _0x327af5=users[_0x595b3f(0x120)];else{if(_0x1286dd[0x0]['language']==_0x595b3f(0x15f))var _0x327af5=users[_0x595b3f(0x15f)];else{if(_0x1286dd[0x0][_0x595b3f(0x13f)]==_0x595b3f(0xee))var _0x327af5=users[_0x595b3f(0xee)];else{if(_0x1286dd[0x0]['language']=='Portuguese\x20(BR)')var _0x327af5=users[_0x595b3f(0x180)];else{if(_0x1286dd[0x0][_0x595b3f(0x13f)]==_0x595b3f(0xd1))var _0x327af5=users[_0x595b3f(0xd1)];else{if(_0x1286dd[0x0]['language']==_0x595b3f(0x142))var _0x327af5=users[_0x595b3f(0xd8)];}}}}}}}const _0x3a9268=getRandom8DigitNumber();_0x3a9268['then'](_0x344462=>{var _0x268703=_0x595b3f;_0x33e0ef[_0x268703(0xe1)]('add_sales_finished',{'success':_0x5e15ff[_0x268703(0x131)](_0x268703(0xd6)),'errors':_0x5e15ff[_0x268703(0x131)](_0x268703(0x149)),'role':_0x6ea202,'profile':_0x512ce7,'customer':_0x1161c0,'warehouse':_0x139d7b,'product':_0xc59d1f,'invoice':_0x344462,'master_shop':_0x1286dd,'language':_0x327af5,'rooms_data':_0x464eef});})[_0x595b3f(0x117)](_0x1cadaa=>{var _0x1d01a9=_0x595b3f;_0x5e15ff[_0x1d01a9(0x131)](_0x1d01a9(0x149),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x33e0ef[_0x1d01a9(0x9b)](_0x1d01a9(0x11e));});}catch(_0xfe0bc){console[_0x595b3f(0x171)](_0xfe0bc);}}),router['get'](a0_0x2c2748(0xae),auth,async(_0x185924,_0x1f81cb)=>{var _0x2888ad=a0_0x2c2748;try{const _0x581a5a=_0x185924[_0x2888ad(0x8e)]['id'];console[_0x2888ad(0x171)](_0x581a5a);const _0x370dd8=await product[_0x2888ad(0x17d)](),_0x2626ba=await purchases['aggregate']([{'$match':{'warehouse_name':_0x581a5a}},{'$unwind':_0x2888ad(0x13d)},{'$group':{'_id':_0x2888ad(0x1a3)}}]);console[_0x2888ad(0x171)](_0x2888ad(0xfd),_0x2626ba),_0x1f81cb['status'](0xc8)[_0x2888ad(0xca)]({'purchases_data':_0x2626ba,'product_data':_0x370dd8});}catch(_0x31a6d6){console['log'](_0x31a6d6);}}),router[a0_0x2c2748(0x121)](a0_0x2c2748(0x10a),auth,async(_0x524992,_0x2176e5)=>{var _0x17cb87=a0_0x2c2748;try{const {warehouse_data:_0x4079a4,product_data:_0x3b8207}=_0x524992['body'];console[_0x17cb87(0x171)](_0x524992[_0x17cb87(0xad)][_0x17cb87(0x14f)]);;const _0x3c2b9b=await master_shop[_0x17cb87(0x17d)]();console[_0x17cb87(0x171)](_0x17cb87(0x137),_0x3c2b9b);const _0x535dc4=await product['findOne']({'name':_0x3b8207});console['log']('product',_0x535dc4);const _0x3e5c80=await warehouse['aggregate']([{'$match':{'name':_0x4079a4}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x3b8207}},{'$group':{'_id':_0x17cb87(0xb4),'product_stock':{'$first':_0x17cb87(0xc1)}}}]);console[_0x17cb87(0x171)]('stock_data',_0x3e5c80),_0x2176e5['status'](0xc8)[_0x17cb87(0xca)]({'master':_0x3c2b9b,'new_product':_0x535dc4,'stock_data':_0x3e5c80});}catch(_0x5b76f8){console[_0x17cb87(0x171)](_0x5b76f8);}}),router[a0_0x2c2748(0x121)](a0_0x2c2748(0x188),auth,async(_0x44bbdf,_0x5115d7)=>{var _0x252509=a0_0x2c2748;try{const {invoice:_0xf56480,date:_0x3f9f4b,warehouse_name:_0x31432b,product_name:_0x8e9b88,stock:_0x495d59,quantity:_0x3d2825,note:_0x2ca319,room:_0x2cf1e1,primary_code:_0x532a7e,secondary_code:_0x23115b,prod_code:_0x2541af,level:_0x179206,isle:_0x1c20ef,pallet:_0x4753a8,batch_code:_0x2611de,SCRN:_0x33b0d1,expiry_date:_0x2e6f7f,mode_transpo:_0x2acff2,name_driver:_0x4b708b}=_0x44bbdf[_0x252509(0xad)];if(typeof _0x8e9b88==_0x252509(0x16f))var _0x32c047=[_0x44bbdf[_0x252509(0xad)][_0x252509(0x138)]],_0x916204=[_0x44bbdf['body'][_0x252509(0xba)]],_0x5e20e8=[_0x44bbdf[_0x252509(0xad)][_0x252509(0x148)]],_0x6293af=[_0x44bbdf['body']['primary_code']],_0x4807de=[_0x44bbdf[_0x252509(0xad)]['secondary_code']],_0x4d0c36=[_0x44bbdf[_0x252509(0xad)]['prod_code']],_0x451990=[_0x44bbdf[_0x252509(0xad)][_0x252509(0x14d)]],_0x39fa8d=[_0x44bbdf[_0x252509(0xad)]['primary_unit']],_0x17bd99=[_0x44bbdf['body'][_0x252509(0xe3)]],_0x5b6dec=[_0x44bbdf[_0x252509(0xad)]['batch_code']],_0x1ae041=[_0x44bbdf[_0x252509(0xad)]['expiry_date']],_0xc4542f=[_0x44bbdf[_0x252509(0xad)][_0x252509(0x182)]],_0x115fee=[_0x44bbdf['body'][_0x252509(0x125)]],_0x302718=[_0x44bbdf['body']['prod_cat']],_0x5dd50d=[_0x44bbdf[_0x252509(0xad)][_0x252509(0xde)]],_0x62a4d6=[_0x44bbdf[_0x252509(0xad)][_0x252509(0x9c)]],_0x1d9119=[_0x44bbdf['body'][_0x252509(0xc0)]];else var _0x32c047=[..._0x44bbdf['body'][_0x252509(0x138)]],_0x916204=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0xba)]],_0x5e20e8=[..._0x44bbdf['body']['carton']],_0x6293af=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0xfa)]],_0x4807de=[..._0x44bbdf[_0x252509(0xad)]['secondary_code']],_0x4d0c36=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0xd3)]],_0x451990=[..._0x44bbdf['body'][_0x252509(0x14d)]],_0x39fa8d=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0xc5)]],_0x17bd99=[..._0x44bbdf['body'][_0x252509(0xe3)]],_0x5b6dec=[..._0x44bbdf['body']['batch_code']],_0x1ae041=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0x94)]],_0xc4542f=[..._0x44bbdf[_0x252509(0xad)]['product_date']],_0x115fee=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0x125)]],_0x302718=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0x16c)]],_0x5dd50d=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0xde)]],_0x62a4d6=[..._0x44bbdf[_0x252509(0xad)]['prod_invoice']],_0x1d9119=[..._0x44bbdf[_0x252509(0xad)][_0x252509(0xc0)]];const _0x22ed9c=_0x32c047['map'](_0xe07cc9=>{return _0xe07cc9={'product_name':_0xe07cc9};});_0x916204[_0x252509(0x118)]((_0xab7b40,_0x216720)=>{var _0x20bf40=_0x252509;_0x22ed9c[_0x216720][_0x20bf40(0xba)]=_0xab7b40;}),_0x5e20e8['forEach']((_0x195de3,_0xe6aa08)=>{var _0x54f6a2=_0x252509;_0x22ed9c[_0xe6aa08][_0x54f6a2(0xf3)]=Math[_0x54f6a2(0x172)](_0x195de3);}),_0x1d9119[_0x252509(0x118)]((_0x2d2e55,_0x4dba74)=>{var _0x443a75=_0x252509;_0x22ed9c[_0x4dba74][_0x443a75(0xc0)]=_0x2d2e55;}),_0x6293af[_0x252509(0x118)]((_0xb7b8f4,_0x34d3ed)=>{var _0x447008=_0x252509;_0x22ed9c[_0x34d3ed][_0x447008(0xfa)]=_0xb7b8f4;}),_0x4807de[_0x252509(0x118)]((_0x205bee,_0x2e4d29)=>{var _0x198996=_0x252509;_0x22ed9c[_0x2e4d29][_0x198996(0xdb)]=_0x205bee;}),_0x4d0c36[_0x252509(0x118)]((_0x2f5eff,_0xe8a25)=>{var _0x23c257=_0x252509;_0x22ed9c[_0xe8a25][_0x23c257(0x151)]=_0x2f5eff;}),_0x451990[_0x252509(0x118)]((_0x337174,_0x55a12a)=>{var _0x467f6e=_0x252509;_0x22ed9c[_0x55a12a][_0x467f6e(0x12d)]=_0x337174;}),_0x39fa8d[_0x252509(0x118)]((_0x54b789,_0x1b51ea)=>{var _0xd8eac6=_0x252509;_0x22ed9c[_0x1b51ea][_0xd8eac6(0x97)]=_0x54b789;}),_0x17bd99[_0x252509(0x118)]((_0x2e46b3,_0x1d5ae2)=>{var _0x4373d5=_0x252509;_0x22ed9c[_0x1d5ae2][_0x4373d5(0xe3)]=_0x2e46b3;}),_0x5b6dec['forEach']((_0x30cea5,_0x28d59f)=>{var _0x288060=_0x252509;_0x22ed9c[_0x28d59f][_0x288060(0x135)]=_0x30cea5;}),_0x1ae041['forEach']((_0x445a89,_0x5b763b)=>{var _0x4f30c6=_0x252509;_0x22ed9c[_0x5b763b][_0x4f30c6(0x94)]=_0x445a89;}),_0xc4542f[_0x252509(0x118)]((_0x4be31b,_0x249c94)=>{var _0x49b201=_0x252509;_0x22ed9c[_0x249c94][_0x49b201(0xea)]=_0x4be31b;}),_0x115fee[_0x252509(0x118)]((_0x4bb777,_0x1f7a42)=>{var _0x20f649=_0x252509;_0x22ed9c[_0x1f7a42][_0x20f649(0x19a)]=_0x4bb777;}),_0x302718[_0x252509(0x118)]((_0x1c1781,_0xeaf194)=>{var _0x3829f4=_0x252509;_0x22ed9c[_0xeaf194][_0x3829f4(0x16c)]=_0x1c1781;}),_0x5dd50d['forEach']((_0x3b8966,_0x271d60)=>{var _0x37b851=_0x252509;_0x22ed9c[_0x271d60][_0x37b851(0xda)]=_0x3b8966;}),_0x62a4d6['forEach']((_0x2fc9c5,_0x90528d)=>{var _0x3587cd=_0x252509;_0x22ed9c[_0x90528d][_0x3587cd(0x19d)]=_0x2fc9c5;});var _0x554122=0x0;_0x22ed9c[_0x252509(0x118)](_0x50ef59=>{var _0x29f495=_0x252509;parseFloat(_0x50ef59['stock'])<parseFloat(_0x50ef59[_0x29f495(0xf3)])&&parseFloat(_0x50ef59[_0x29f495(0xf3)])>parseFloat(_0x50ef59[_0x29f495(0xba)])&&(console[_0x29f495(0x171)](_0x50ef59['stock']+'\x20<>\x20'+_0x50ef59['quantity']),_0x554122++);});if(_0x554122!=0x0)return _0x44bbdf[_0x252509(0x131)](_0x252509(0x149),_0x252509(0x130)),_0x5115d7[_0x252509(0x9b)](_0x252509(0xab));const _0x1371b9=_0x22ed9c[_0x252509(0xb6)](_0x53bc67=>_0x53bc67[_0x252509(0xf3)]!=='0'&&_0x53bc67[_0x252509(0xf3)]!==''),_0x3f2a0c=new sales_finished({'invoice':_0xf56480,'customer':_0x44bbdf[_0x252509(0xad)][_0x252509(0x16d)],'date':_0x3f9f4b,'warehouse_name':_0x31432b,'sale_product':_0x1371b9,'note':_0x2ca319,'room':_0x2cf1e1,'primary_code':_0x532a7e,'secondary_code':_0x23115b,'prod_code':_0x2541af,'SCRN':_0x33b0d1,'finalize':'False','mode_transpo':_0x2acff2,'name_driver':_0x4b708b}),_0x13980d=await _0x3f2a0c[_0x252509(0x160)](),_0x46d5b2=await sales_finished[_0x252509(0x8f)]({'invoice':_0xf56480}),_0x2a0d0a=new c_payment_data({'invoice':_0xf56480,'customer':_0x44bbdf[_0x252509(0xad)][_0x252509(0x16d)],'reason':_0x252509(0xeb)});await _0x2a0d0a[_0x252509(0x160)]();const _0x4297a0=await master_shop[_0x252509(0x17d)](),_0x4777b9=await email_settings[_0x252509(0x8f)](),_0x32c4e9=await customer[_0x252509(0x8f)]({'name':_0x44bbdf[_0x252509(0xad)][_0x252509(0x16d)]});_0x4297a0[0x0]['currency_placement']==0x1?(right_currency=_0x4297a0[0x0][_0x252509(0x92)],left_currency=''):(right_currency='',left_currency=_0x4297a0[0x0][_0x252509(0x92)]);var _0x3b5855=_0x32c047,_0x1cb244=_0x5e20e8,_0x3e7dc3='',_0x3150b1;for(_0x3150b1 in _0x3b5855){_0x3e7dc3+=_0x252509(0xf1)+_0x252509(0x152)+_0x3b5855[_0x3150b1]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1cb244[_0x3150b1]+_0x252509(0xe7)+'</tr>';}console[_0x252509(0x171)](_0x252509(0xff),_0x3e7dc3);let _0x5ebe10=nodemailer[_0x252509(0x111)]({'service':_0x252509(0x102),'auth':{'user':_0x4777b9[_0x252509(0x189)],'pass':_0x4777b9[_0x252509(0x1a1)]}}),_0x59b77f={'from':_0x4777b9[_0x252509(0x189)],'to':_0x32c4e9[_0x252509(0x189)],'subject':'Sale\x20Product\x20Mail','attachments':[{'filename':_0x252509(0xbc),'path':__dirname+_0x252509(0x19f)+_0x252509(0xa7)+_0x4297a0[0x0][_0x252509(0x9d)],'cid':_0x252509(0x17c)}],'html':'<!DOCTYPE\x20html>'+_0x252509(0x106)+_0x252509(0xec)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x252509(0xa9)+_0x252509(0xbf)+_0x252509(0xac)+'<div>'+_0x252509(0x136)+_0x4297a0[0x0][_0x252509(0x1a0)]+_0x252509(0x153)+_0x252509(0xac)+_0x252509(0xac)+_0x252509(0x116)+'<div>'+_0x252509(0x96)+_0x252509(0x91)+_0xf56480+'\x20'+_0x252509(0x11c)+_0x252509(0x163)+_0x3f9f4b+'\x20'+'</span>'+_0x252509(0x15c)+_0x252509(0xac)+_0x252509(0x176)+_0x252509(0x16e)+_0x252509(0xf1)+_0x252509(0x192)+_0x252509(0xb1)+_0x252509(0x197)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3e7dc3+'\x20'+_0x252509(0x164)+_0x252509(0xbb)+'<div>'+_0x252509(0x140)+_0x252509(0xa8)+_0x4297a0[0x0][_0x252509(0x1a0)]+_0x252509(0x15c)+'</div>'+'</div>'+_0x252509(0x124)};_0x5ebe10['sendMail'](_0x59b77f,function(_0x2b70fe,_0x4b054f){var _0x65834f=_0x252509;_0x2b70fe?(console[_0x65834f(0x171)](_0x2b70fe),console['log'](_0x65834f(0xa5))):console[_0x65834f(0x171)](_0x65834f(0x15e));}),_0x44bbdf['flash'](_0x252509(0xd6),_0x252509(0xd9)),_0x5115d7[_0x252509(0x9b)](_0x252509(0x166)+_0x13980d[_0x252509(0xc9)]);}catch(_0x33f2cc){console['log'](_0x33f2cc);}}),router['get'](a0_0x2c2748(0x167),auth,async(_0x1ef5c7,_0x3574b4)=>{var _0x12c5e9=a0_0x2c2748;try{const {username:_0x222258,email:_0x15f881,role:_0x1b4120}=_0x1ef5c7[_0x12c5e9(0xc8)],_0x306a5b=_0x1ef5c7[_0x12c5e9(0xc8)],_0x37a0e9=await profile[_0x12c5e9(0x8f)]({'email':_0x306a5b[_0x12c5e9(0x189)]}),_0x857eb=await master_shop['find'](),_0x3d69a0=_0x1ef5c7[_0x12c5e9(0x8e)]['id'],_0x461a05=await sales_finished[_0x12c5e9(0x169)](_0x3d69a0),_0x87c274=await warehouse[_0x12c5e9(0x128)]([{'$match':{'name':_0x461a05[_0x12c5e9(0x11a)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x12c5e9(0x179),'name':{'$first':_0x12c5e9(0xb4)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x12c5e9(0x134)},'floorlevel':{'$first':_0x12c5e9(0x126)},'primary_code':{'$first':_0x12c5e9(0x105)},'secondary_code':{'$first':_0x12c5e9(0x158)},'product_code':{'$first':_0x12c5e9(0xdd)},'storage':{'$first':_0x12c5e9(0x11d)},'rack':{'$first':_0x12c5e9(0xb2)},'expiry_date':{'$first':_0x12c5e9(0x123)},'production_date':{'$first':_0x12c5e9(0xef)},'batch_code':{'$first':_0x12c5e9(0xce)},'room':{'$first':_0x12c5e9(0x191)},'room_data':{'$first':_0x12c5e9(0xe2)}}}]),_0x27e3c7=await customer['find']({});let _0x24dad1;if(_0x306a5b['role']==_0x12c5e9(0xfc)){const _0x1b8139=await staff[_0x12c5e9(0x8f)]({'email':_0x306a5b['email']});_0x24dad1=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x1b8139[_0x12c5e9(0x19b)]}},{'$group':{'_id':_0x12c5e9(0x18b),'name':{'$first':'$name'}}}]);}else _0x24dad1=await warehouse[_0x12c5e9(0x128)]([{'$match':{'status':_0x12c5e9(0xe9)}},{'$group':{'_id':_0x12c5e9(0x18b),'name':{'$first':_0x12c5e9(0x18b)}}}]);const _0x543506=await product['find']({});if(_0x857eb[0x0]['language']=='English\x20(US)'){var _0xd17d1f=users[_0x12c5e9(0xb3)];console['log'](_0xd17d1f);}else{if(_0x857eb[0x0][_0x12c5e9(0x13f)]==_0x12c5e9(0x13a))var _0xd17d1f=users['Hindi'];else{if(_0x857eb[0x0][_0x12c5e9(0x13f)]==_0x12c5e9(0x120))var _0xd17d1f=users[_0x12c5e9(0x120)];else{if(_0x857eb[0x0][_0x12c5e9(0x13f)]=='Spanish')var _0xd17d1f=users[_0x12c5e9(0x15f)];else{if(_0x857eb[0x0][_0x12c5e9(0x13f)]=='French')var _0xd17d1f=users[_0x12c5e9(0xee)];else{if(_0x857eb[0x0][_0x12c5e9(0x13f)]==_0x12c5e9(0xa3))var _0xd17d1f=users[_0x12c5e9(0x180)];else{if(_0x857eb[0x0][_0x12c5e9(0x13f)]==_0x12c5e9(0xd1))var _0xd17d1f=users[_0x12c5e9(0xd1)];else{if(_0x857eb[0x0][_0x12c5e9(0x13f)]==_0x12c5e9(0x142))var _0xd17d1f=users[_0x12c5e9(0xd8)];}}}}}}}_0x3574b4[_0x12c5e9(0xe1)]('edit_sales_finished_view',{'success':_0x1ef5c7[_0x12c5e9(0x131)]('success'),'errors':_0x1ef5c7[_0x12c5e9(0x131)]('errors'),'role':_0x306a5b,'profile':_0x37a0e9,'customer':_0x27e3c7,'warehouse':_0x24dad1,'product':_0x87c274,'user':_0x461a05,'master_shop':_0x857eb,'unit':_0x543506,'language':_0xd17d1f});}catch(_0x36d3c4){console['log'](_0x36d3c4);}}),router['post'](a0_0x2c2748(0x167),auth,async(_0xb8065,_0x70f49b)=>{var _0x98f817=a0_0x2c2748;try{const _0x16c240=_0xb8065['params']['id'],{invoice:_0x246bcd,warehouse_name:_0x15abfd,room:_0x830414}=_0xb8065[_0x98f817(0xad)],_0x2fce5c=await sales_finished['findOne']({'invoice':_0x246bcd}),_0x305329=_0x2fce5c[_0x98f817(0x155)][_0x98f817(0x113)](async _0x256ef4=>{var _0x16902c=_0x98f817,_0xb4a63f=await warehouse[_0x16902c(0x8f)]({'name':_0x15abfd,'room':_0x256ef4[_0x16902c(0xda)],'warehouse_category':_0x16902c(0x18f)});const _0x23d43b=_0xb4a63f[_0x16902c(0x19e)][_0x16902c(0x113)](_0x25ac9e=>{var _0x2bc23e=_0x16902c;_0x25ac9e[_0x2bc23e(0x138)]==_0x256ef4[_0x2bc23e(0x138)]&&_0x25ac9e[_0x2bc23e(0x12d)]==_0x256ef4[_0x2bc23e(0x12d)]&&_0x25ac9e['expiry_date']==_0x256ef4[_0x2bc23e(0x94)]&&_0x25ac9e[_0x2bc23e(0xea)]==_0x256ef4[_0x2bc23e(0xea)]&&_0x25ac9e['batch_code']==_0x256ef4['batch_code']&&_0x25ac9e[_0x2bc23e(0x19d)]==_0x256ef4[_0x2bc23e(0x19d)]&&_0x25ac9e[_0x2bc23e(0xc9)]==_0x256ef4[_0x2bc23e(0xc0)]&&(_0x25ac9e['product_stock']>0x0&&(console[_0x2bc23e(0x171)](_0x25ac9e['product_name']+_0x2bc23e(0x17a)+_0x256ef4[_0x2bc23e(0x138)]+'\x20&&\x20'+_0x25ac9e['bay']+_0x2bc23e(0x17a)+_0x256ef4[_0x2bc23e(0x12d)]+'\x20&&\x20'+_0x25ac9e['production_date']+_0x2bc23e(0x17a)+_0x256ef4[_0x2bc23e(0xea)]+_0x2bc23e(0x93)+_0x25ac9e['expiry_date']+'\x20==\x20'+_0x256ef4[_0x2bc23e(0x94)]+_0x2bc23e(0x93)+_0x25ac9e[_0x2bc23e(0x135)]+_0x2bc23e(0x17a)+_0x256ef4[_0x2bc23e(0x135)]+'\x20&&\x20'+_0x25ac9e['invoice']+_0x2bc23e(0x17a)+_0x256ef4[_0x2bc23e(0x19d)]+_0x2bc23e(0x93)+_0x25ac9e[_0x2bc23e(0xaa)]+_0x2bc23e(0x10f)+_0x256ef4[_0x2bc23e(0xf3)]+_0x2bc23e(0x185)+_0x256ef4[_0x2bc23e(0xda)]+_0x2bc23e(0x93)+_0x25ac9e['_id']+'\x20==\x20'+_0x256ef4[_0x2bc23e(0xc0)]),_0x25ac9e['product_stock']=Math[_0x2bc23e(0x10d)](0x0,Math['abs'](_0x25ac9e['product_stock'])-Math[_0x2bc23e(0x172)](_0x256ef4['quantity']))));});return _0xb4a63f;});Promise[_0x98f817(0x195)](_0x305329)[_0x98f817(0xbd)](async _0x49f1d7=>{var _0x429ff2=_0x98f817;try{for(const _0x35345a of _0x49f1d7){await _0x35345a[_0x429ff2(0x160)]();}_0x2fce5c['finalize']=_0x429ff2(0x165);const _0x51ba44=await _0x2fce5c[_0x429ff2(0x160)](),_0xf19d49=await master_shop[_0x429ff2(0x17d)](),_0x23e68f=await email_settings[_0x429ff2(0x8f)](),_0x376ae7=await supervisor_settings[_0x429ff2(0x17d)]();var _0x4e4f2e=_0x2fce5c[_0x429ff2(0x155)],_0x2d9348='',_0x1e4cb9;for(_0x1e4cb9 in _0x4e4f2e){var _0x25ddd2='FG';_0x2fce5c[_0x429ff2(0x11a)]=='DRY\x20GOODS'&&(_0x25ddd2='DG'),_0x2d9348+=_0x429ff2(0xf1)+_0x429ff2(0x152)+_0x4e4f2e[_0x1e4cb9][_0x429ff2(0x138)]+'</td>'+_0x429ff2(0x152)+_0x4e4f2e[_0x1e4cb9][_0x429ff2(0x151)]+'</td>'+_0x429ff2(0x152)+_0x4e4f2e[_0x1e4cb9][_0x429ff2(0xf3)]+_0x429ff2(0xe7)+_0x429ff2(0x152)+_0x4e4f2e[_0x1e4cb9]['unit']+_0x429ff2(0xe7)+_0x429ff2(0x152)+_0x4e4f2e[_0x1e4cb9][_0x429ff2(0xe3)]+_0x429ff2(0xe7)+_0x429ff2(0x152)+_0x2fce5c[_0x429ff2(0x11a)]+_0x429ff2(0xe7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4e4f2e[_0x1e4cb9][_0x429ff2(0xda)]+_0x429ff2(0xe7)+_0x429ff2(0x152)+_0x25ddd2+_0x4e4f2e[_0x1e4cb9]['bay']+'</td>';}let _0x3f5411=nodemailer[_0x429ff2(0x111)]({'host':_0x23e68f[_0x429ff2(0x129)],'port':Number(_0x23e68f[_0x429ff2(0x141)]),'secure':![],'auth':{'user':_0x23e68f[_0x429ff2(0x189)],'pass':_0x23e68f['password']}}),_0x2658a0={'from':_0x23e68f[_0x429ff2(0x189)],'to':_0x376ae7[0x0][_0x429ff2(0xd7)],'subject':_0x429ff2(0xc7),'attachments':[{'filename':'Logo.png','path':__dirname+_0x429ff2(0x19f)+_0x429ff2(0xa7)+_0xf19d49[0x0][_0x429ff2(0x9d)],'cid':'logo'}],'html':_0x429ff2(0xe0)+_0x429ff2(0x106)+_0x429ff2(0xec)+_0x429ff2(0xa9)+_0x429ff2(0x19c)+'<div>'+_0x429ff2(0xbf)+_0x429ff2(0xac)+_0x429ff2(0xa9)+'<h2>\x20'+_0xf19d49[0x0]['site_title']+_0x429ff2(0x153)+_0x429ff2(0xac)+_0x429ff2(0xac)+_0x429ff2(0x116)+_0x429ff2(0xa9)+_0x429ff2(0x96)+_0x429ff2(0x91)+_0x2fce5c['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x429ff2(0x163)+_0x2fce5c['date']+'\x20'+'</span>'+_0x429ff2(0x15c)+_0x429ff2(0xac)+_0x429ff2(0x176)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x429ff2(0x192)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x429ff2(0x12c)+_0x429ff2(0xc4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x429ff2(0x1a2)+_0x429ff2(0x154)+_0x429ff2(0x9f)+'</tr>'+_0x429ff2(0x157)+_0x429ff2(0xdc)+'\x20'+_0x2d9348+'\x20'+_0x429ff2(0x164)+_0x429ff2(0xbb)+_0x429ff2(0xa9)+_0x429ff2(0x140)+_0x429ff2(0xa8)+_0xf19d49[0x0][_0x429ff2(0x1a0)]+_0x429ff2(0x15c)+'</div>'+_0x429ff2(0xac)+'</body></html>'};_0x3f5411['sendMail'](_0x2658a0,function(_0xb06b01,_0x7c2c28){var _0x249f41=_0x429ff2;_0xb06b01?(console[_0x249f41(0x171)](_0xb06b01),console[_0x249f41(0x171)](_0x249f41(0xa5))):console[_0x249f41(0x171)]('Email\x20sent\x20successfully');}),_0xb8065[_0x429ff2(0x131)](_0x429ff2(0xd6),'Sales\x20Update\x20successfully'),_0x70f49b['redirect'](_0x429ff2(0x15a)+_0x16c240);}catch(_0x2636c9){console['error'](_0x2636c9),_0x70f49b[_0x429ff2(0x16a)](0x1f4)[_0x429ff2(0xca)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x33791e=>{var _0x1ed331=_0x98f817;console[_0x1ed331(0xe4)](_0x33791e),_0x70f49b['status'](0x1f4)[_0x1ed331(0xca)]({'error':_0x1ed331(0x168)});});}catch(_0x206d22){console[_0x98f817(0x171)](_0x206d22);}}),router[a0_0x2c2748(0xc6)](a0_0x2c2748(0x159),auth,async(_0xb49ea,_0x2318e4)=>{var _0x384bb6=a0_0x2c2748;try{const {username:_0x13101c,email:_0x4b8be4,role:_0x2bbc8d}=_0xb49ea[_0x384bb6(0xc8)],_0x4d3f10=_0xb49ea[_0x384bb6(0xc8)],_0x4152ff=await profile['findOne']({'email':_0x4d3f10[_0x384bb6(0x189)]}),_0x39c732=await master_shop[_0x384bb6(0x17d)](),_0x57c90e=_0xb49ea[_0x384bb6(0x8e)]['id'],_0x47daab=await sales_finished['findById'](_0x57c90e);let _0x40931e=new Date(_0x47daab['expiry_date']),_0x4a4e72=('0'+_0x40931e[_0x384bb6(0x109)]())[_0x384bb6(0x122)](-0x2),_0x45fa1b=('0'+(_0x40931e[_0x384bb6(0x145)]()+0x1))[_0x384bb6(0x122)](-0x2),_0x2ed3da=_0x40931e[_0x384bb6(0x150)](),_0x1c1be7=_0x2ed3da+'-'+_0x45fa1b+'-'+_0x4a4e72;var _0x4edf0d=[_0x384bb6(0x144),_0x384bb6(0xf4)];const _0x25ca63=await warehouse[_0x384bb6(0x128)]([{'$match':{'name':_0x47daab[_0x384bb6(0x11a)],'room':_0x47daab[_0x384bb6(0x193)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x384bb6(0x179),'name':{'$first':_0x384bb6(0xb4)},'product_stock':{'$first':_0x384bb6(0xc1)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x384bb6(0x134)},'floorlevel':{'$first':_0x384bb6(0x126)},'primary_code':{'$first':_0x384bb6(0x105)},'secondary_code':{'$first':_0x384bb6(0x158)},'product_code':{'$first':_0x384bb6(0xdd)},'storage':{'$first':_0x384bb6(0x11d)},'rack':{'$first':_0x384bb6(0xb2)}}}]),_0x543dfe=await customer[_0x384bb6(0x17d)]({});let _0x1752ef;if(_0x4d3f10['role']==_0x384bb6(0xfc)){const _0x3e754c=await staff[_0x384bb6(0x8f)]({'email':_0x4d3f10[_0x384bb6(0x189)]});_0x1752ef=await warehouse['aggregate']([{'$match':{'status':_0x384bb6(0xe9),'name':_0x3e754c[_0x384bb6(0x19b)]}},{'$group':{'_id':_0x384bb6(0x18b),'name':{'$first':'$name'}}}]);}else _0x1752ef=await warehouse[_0x384bb6(0x128)]([{'$match':{'status':_0x384bb6(0xe9)}},{'$group':{'_id':_0x384bb6(0x18b),'name':{'$first':'$name'}}}]);const _0x4d61fc=await product[_0x384bb6(0x17d)]({});if(_0x39c732[0x0][_0x384bb6(0x13f)]=='English\x20(US)'){var _0x29a294=users['English'];console[_0x384bb6(0x171)](_0x29a294);}else{if(_0x39c732[0x0][_0x384bb6(0x13f)]=='Hindi')var _0x29a294=users[_0x384bb6(0x13a)];else{if(_0x39c732[0x0][_0x384bb6(0x13f)]==_0x384bb6(0x120))var _0x29a294=users[_0x384bb6(0x120)];else{if(_0x39c732[0x0][_0x384bb6(0x13f)]==_0x384bb6(0x15f))var _0x29a294=users[_0x384bb6(0x15f)];else{if(_0x39c732[0x0]['language']=='French')var _0x29a294=users['French'];else{if(_0x39c732[0x0][_0x384bb6(0x13f)]=='Portuguese\x20(BR)')var _0x29a294=users['Portuguese'];else{if(_0x39c732[0x0]['language']==_0x384bb6(0xd1))var _0x29a294=users[_0x384bb6(0xd1)];else{if(_0x39c732[0x0]['language']==_0x384bb6(0x142))var _0x29a294=users[_0x384bb6(0xd8)];}}}}}}}_0x2318e4['render'](_0x384bb6(0x198),{'success':_0xb49ea[_0x384bb6(0x131)](_0x384bb6(0xd6)),'errors':_0xb49ea['flash'](_0x384bb6(0x149)),'role':_0x4d3f10,'profile':_0x4152ff,'customer':_0x543dfe,'warehouse':_0x1752ef,'product':_0x25ca63,'user':_0x47daab,'master_shop':_0x39c732,'unit':_0x4d61fc,'language':_0x29a294,'rooms_data':_0x4edf0d,'ed_fullDate':_0x1c1be7});}catch(_0x9b5364){console[_0x384bb6(0x171)](_0x9b5364);}}),router[a0_0x2c2748(0x121)](a0_0x2c2748(0x159),auth,async(_0x2bb04c,_0x1b0978)=>{var _0x2963ec=a0_0x2c2748;try{const _0x408b2d=_0x2bb04c[_0x2963ec(0x8e)]['id'],_0x46ca94=await sales_finished['findOne']({'_id':_0x2bb04c['params']['id']}),_0x58fdab=await warehouse['findOne']({'name':_0x46ca94['warehouse_name'],'room':_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0x193)],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x5c90fe,customer:_0x4adb56,date:_0xd4442d,warehouse_name:_0x1f6f52,product_name:_0x1ff576,stock:_0x345950,adjust_qty:_0x374277,note:_0x305c8e,room:_0x59bd71,primary_code:_0x7e7bd0,secondary_code:_0x70e5d8,prod_code:_0x328be1,level:_0x5907c6,isle:_0x470c04,pallet:_0x1b3ea5,expiry_date:_0x1bfe49}=_0x2bb04c[_0x2963ec(0xad)];if(typeof _0x1ff576==_0x2963ec(0x16f))var _0x5749a4=[_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0x138)]],_0x2f3fab=[_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xba)]],_0x3c03db=[_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xa6)]],_0x55448f=[_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xfa)]],_0x24e725=[_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xdb)]],_0x23f43a=[_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xd3)]],_0x1fb568=[_0x2bb04c[_0x2963ec(0xad)]['level']],_0x2c486a=[_0x2bb04c[_0x2963ec(0xad)]['expiry_date']];else var _0x5749a4=[..._0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0x138)]],_0x2f3fab=[..._0x2bb04c[_0x2963ec(0xad)]['stock']],_0x3c03db=[..._0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xa6)]],_0x55448f=[..._0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xfa)]],_0x24e725=[..._0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xdb)]],_0x23f43a=[..._0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0xd3)]],_0x1fb568=[..._0x2bb04c['body'][_0x2963ec(0x14d)]],_0x2c486a=[..._0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0x94)]];const _0x1d6555=_0x5749a4[_0x2963ec(0x113)](_0x20bc16=>{return _0x20bc16={'product_name':_0x20bc16};});_0x2f3fab['forEach']((_0x3989fd,_0x1072a0)=>{var _0xf1c488=_0x2963ec;_0x1d6555[_0x1072a0][_0xf1c488(0xba)]=_0x3989fd;}),_0x3c03db[_0x2963ec(0x118)]((_0x296e5b,_0x53a903)=>{var _0x164568=_0x2963ec;_0x1d6555[_0x53a903][_0x164568(0xf3)]=_0x296e5b;}),_0x55448f[_0x2963ec(0x118)]((_0x5be957,_0xe6529a)=>{var _0x28a76d=_0x2963ec;_0x1d6555[_0xe6529a][_0x28a76d(0xfa)]=_0x5be957;}),_0x24e725[_0x2963ec(0x118)]((_0x19f7af,_0x123457)=>{var _0x5b971f=_0x2963ec;_0x1d6555[_0x123457][_0x5b971f(0xdb)]=_0x19f7af;}),_0x23f43a[_0x2963ec(0x118)]((_0x7889df,_0x45bbe9)=>{var _0xa0a39b=_0x2963ec;_0x1d6555[_0x45bbe9][_0xa0a39b(0x151)]=_0x7889df;}),_0x1fb568[_0x2963ec(0x118)]((_0x300835,_0x22cd4d)=>{var _0x4c73b7=_0x2963ec;_0x1d6555[_0x22cd4d][_0x4c73b7(0x14d)]=_0x300835;}),_0x2c486a['forEach']((_0x56ab56,_0x5cb86b)=>{var _0x18b55d=_0x2963ec;_0x1d6555[_0x5cb86b][_0x18b55d(0x94)]=_0x56ab56;});var _0x5a0c20=0x0;_0x1d6555[_0x2963ec(0x118)](_0x3c4f10=>{var _0x20c47f=_0x2963ec;console[_0x20c47f(0x171)](_0x20c47f(0x9a),_0x3c4f10),(parseInt(_0x3c4f10[_0x20c47f(0xba)])<parseInt(_0x3c4f10[_0x20c47f(0xf3)])||parseInt(_0x3c4f10['quantity'])==0x0)&&_0x5a0c20++;});if(_0x5a0c20!=0x0)return _0x2bb04c['flash'](_0x2963ec(0x149),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x1b0978[_0x2963ec(0x9b)](_0x2963ec(0xab));_0x46ca94[_0x2963ec(0x155)][_0x2963ec(0x118)](_0x616b57=>{var _0x232cce=_0x2963ec;const _0xbb5110=_0x58fdab[_0x232cce(0x19e)][_0x232cce(0x113)](_0x302737=>{var _0x457d38=_0x232cce;_0x302737[_0x457d38(0x138)]==_0x616b57[_0x457d38(0x138)]&&_0x302737[_0x457d38(0x12d)]==_0x616b57[_0x457d38(0x12d)]&&(_0x302737[_0x457d38(0xaa)]=parseInt(_0x302737[_0x457d38(0xaa)])+parseInt(_0x616b57['quantity']));});}),await _0x58fdab[_0x2963ec(0x160)]();const _0x33ed4b=_0x1d6555[_0x2963ec(0xb6)](_0x716bf6=>_0x716bf6[_0x2963ec(0xf3)]!=='0'&&_0x716bf6[_0x2963ec(0xf3)]!=='');_0x46ca94[_0x2963ec(0x19d)]=_0x5c90fe,_0x46ca94[_0x2963ec(0x16d)]=_0x4adb56,_0x46ca94['date']=_0xd4442d,_0x46ca94['warehouse_name']=_0x1f6f52,_0x46ca94[_0x2963ec(0x155)]=_0x33ed4b,_0x46ca94[_0x2963ec(0x162)]=_0x305c8e,_0x46ca94[_0x2963ec(0x193)]=_0x59bd71;const _0x4f005d=await _0x46ca94[_0x2963ec(0x160)](),_0x48eccd=await sales_finished[_0x2963ec(0x8f)]({'_id':_0x2bb04c['params']['id']}),_0xe48327=await warehouse['findOne']({'name':_0x1f6f52,'room':_0x59bd71,'warehouse_category':_0x2963ec(0x18f)});_0x48eccd[_0x2963ec(0x155)][_0x2963ec(0x118)](_0x258189=>{var _0x5772be=_0x2963ec;const _0x3d67f5=_0xe48327[_0x5772be(0x19e)][_0x5772be(0x113)](_0x3e2ea2=>{var _0x3e4ab4=_0x5772be;_0x3e2ea2[_0x3e4ab4(0x138)]==_0x258189[_0x3e4ab4(0x138)]&&_0x3e2ea2[_0x3e4ab4(0x12d)]==_0x258189[_0x3e4ab4(0x12d)]&&(_0x3e2ea2[_0x3e4ab4(0xaa)]=parseInt(_0x3e2ea2[_0x3e4ab4(0xaa)])-parseInt(_0x258189[_0x3e4ab4(0xf3)]));});}),console[_0x2963ec(0x171)](_0x2963ec(0xa2),_0xe48327),await _0xe48327['save']();const _0xd2ba3=await c_payment_data['findOne']({'invoice':_0x2bb04c[_0x2963ec(0xad)][_0x2963ec(0x19d)]});_0xd2ba3[_0x2963ec(0xd2)]=_0x2bb04c[_0x2963ec(0xad)]['suppliers'],await _0xd2ba3['save'](),_0x2bb04c['flash']('success','Sales\x20Update\x20successfully'),_0x1b0978[_0x2963ec(0x9b)](_0x2963ec(0x11e));}catch(_0x516340){console[_0x2963ec(0x171)](_0x516340);}}),router[a0_0x2c2748(0x121)](a0_0x2c2748(0xbe),auth,async(_0x5f323e,_0x5c2d3e)=>{var _0x19b623=a0_0x2c2748;try{const _0x370523=_0x5f323e[_0x19b623(0x8e)]['id'],{invoice:_0x50512d,customer:_0x43de46,receivable_amount:_0x5a8e6d,received_amount:_0x99e720}=_0x5f323e['body'],_0x387128=await sales[_0x19b623(0x169)](_0x370523);console[_0x19b623(0x171)](_0x387128);var _0x2684b3=_0x5a8e6d-_0x99e720;console[_0x19b623(0x171)](_0x99e720),_0x387128[_0x19b623(0xa0)]=parseFloat(_0x99e720)+parseFloat(_0x387128[_0x19b623(0xa0)]),_0x387128[_0x19b623(0xd0)]=_0x2684b3,console[_0x19b623(0x171)](_0x387128);const _0x3d5346=await _0x387128[_0x19b623(0x160)](),_0x1605f6=await c_payment_data[_0x19b623(0x8f)]({'invoice':_0x50512d});_0x1605f6[_0x19b623(0x170)]=_0x2684b3,await _0x1605f6[_0x19b623(0x160)]();let _0x56e9ee=new Date(),_0x3ea693=('0'+_0x56e9ee[_0x19b623(0x109)]())['slice'](-0x2),_0x3b4bb3=('0'+(_0x56e9ee[_0x19b623(0x145)]()+0x1))[_0x19b623(0x122)](-0x2),_0x1c4547=_0x56e9ee[_0x19b623(0x150)](),_0x377676=_0x1c4547+'-'+_0x3b4bb3+'-'+_0x3ea693;const _0x159934=new customer_payment({'invoice':_0x50512d,'date':_0x1c4547+'-'+_0x3b4bb3+'-'+_0x3ea693,'customer':_0x43de46,'reason':_0x19b623(0x10e),'amount':_0x99e720}),_0x5607f5=await _0x159934['save']();_0x5f323e[_0x19b623(0x131)](_0x19b623(0xd6),_0x19b623(0x15d)),_0x5c2d3e[_0x19b623(0x9b)]('/all_sales/view');}catch(_0x576e35){console[_0x19b623(0x171)](_0x576e35);}}),router[a0_0x2c2748(0xc6)](a0_0x2c2748(0x18e),auth,async(_0x1fdd5c,_0x23d7e7)=>{var _0x55ae8f=a0_0x2c2748;try{const {username:_0x85e56f,email:_0x38a159,role:_0x8a1cf4}=_0x1fdd5c[_0x55ae8f(0xc8)],_0x24c817=_0x1fdd5c[_0x55ae8f(0xc8)],_0x127056=await profile[_0x55ae8f(0x8f)]({'email':_0x24c817['email']}),_0x444124=await master_shop[_0x55ae8f(0x17d)]();console[_0x55ae8f(0x171)](_0x55ae8f(0x137),_0x444124);const _0x4f61b2=_0x1fdd5c['params']['id'],_0x26c0bd=await sales[_0x55ae8f(0x169)](_0x4f61b2);console[_0x55ae8f(0x171)](_0x26c0bd);const _0x56d97b=await customer[_0x55ae8f(0x8f)]({'name':_0x26c0bd[_0x55ae8f(0x16d)]});console[_0x55ae8f(0x171)](_0x56d97b);if(_0x444124[0x0][_0x55ae8f(0x13f)]==_0x55ae8f(0xcc)){var _0x284f11=users['English'];console[_0x55ae8f(0x171)](_0x284f11);}else{if(_0x444124[0x0][_0x55ae8f(0x13f)]=='Hindi')var _0x284f11=users[_0x55ae8f(0x13a)];else{if(_0x444124[0x0][_0x55ae8f(0x13f)]==_0x55ae8f(0x120))var _0x284f11=users[_0x55ae8f(0x120)];else{if(_0x444124[0x0][_0x55ae8f(0x13f)]==_0x55ae8f(0x15f))var _0x284f11=users[_0x55ae8f(0x15f)];else{if(_0x444124[0x0]['language']==_0x55ae8f(0xee))var _0x284f11=users[_0x55ae8f(0xee)];else{if(_0x444124[0x0][_0x55ae8f(0x13f)]=='Portuguese\x20(BR)')var _0x284f11=users[_0x55ae8f(0x180)];else{if(_0x444124[0x0]['language']==_0x55ae8f(0xd1))var _0x284f11=users['Chinese'];else{if(_0x444124[0x0][_0x55ae8f(0x13f)]==_0x55ae8f(0x142))var _0x284f11=users[_0x55ae8f(0xd8)];}}}}}}}_0x23d7e7[_0x55ae8f(0xe1)](_0x55ae8f(0x143),{'success':_0x1fdd5c[_0x55ae8f(0x131)](_0x55ae8f(0xd6)),'errors':_0x1fdd5c[_0x55ae8f(0x131)](_0x55ae8f(0x149)),'role':_0x24c817,'profile':_0x127056,'master_shop':_0x444124,'customers':_0x56d97b,'sales':_0x26c0bd,'language':_0x284f11});}catch(_0x43e4a5){console[_0x55ae8f(0x171)](_0x43e4a5);}}),router[a0_0x2c2748(0xc6)](a0_0x2c2748(0x11b),auth,async(_0x2d8ffb,_0x4f7a97)=>{var _0x279c75=a0_0x2c2748;try{const {username:_0x485a7e,email:_0x4ad635,role:_0x39f9ec}=_0x2d8ffb['user'],_0x514b85=_0x2d8ffb[_0x279c75(0xc8)],_0xc3ccfb=await profile['findOne']({'email':_0x514b85[_0x279c75(0x189)]}),_0x4bd029=await master_shop[_0x279c75(0x17d)](),_0x154ca7=_0x2d8ffb[_0x279c75(0x8e)]['id'],_0x2e0fb8=await sales_finished[_0x279c75(0x169)](_0x154ca7),_0x4b8346=await warehouse[_0x279c75(0x128)]([{'$match':{'name':_0x2e0fb8['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x279c75(0x179),'name':{'$first':_0x279c75(0xb4)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x279c75(0xed)},'type':{'$first':_0x279c75(0x134)},'floorlevel':{'$first':_0x279c75(0x126)},'primary_code':{'$first':_0x279c75(0x105)},'secondary_code':{'$first':_0x279c75(0x158)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x279c75(0x11d)},'rack':{'$first':_0x279c75(0xb2)},'expiry_date':{'$first':_0x279c75(0x123)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':_0x279c75(0xe5)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x279c75(0x17e)},'batch_code':{'$first':_0x279c75(0xce)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x784922=await product['find']({}),_0x2e7e46=await warehouse['aggregate']([{'$match':{'status':_0x279c75(0xe9),'warehouse_category':_0x279c75(0x18f),'name':{'$ne':'Return\x20Goods','$ne':_0x279c75(0x18c)}}},{'$group':{'_id':_0x279c75(0x18b),'name':{'$first':_0x279c75(0x18b)}}},{'$sort':{'name':0x1}}]);var _0x314b4d=[_0x279c75(0xb9)];const _0x102dbb=await warehouse[_0x279c75(0x128)]([{'$match':{'status':'Enabled','name':'Quality\x20Inspection'}},{'$group':{'_id':'$name','name':{'$first':_0x279c75(0x18b)}}},{'$sort':{'name':0x1}}]);if(_0x4bd029[0x0]['language']=='English\x20(US)'){var _0x993f87=users[_0x279c75(0xb3)];console['log'](_0x993f87);}else{if(_0x4bd029[0x0][_0x279c75(0x13f)]==_0x279c75(0x13a))var _0x993f87=users['Hindi'];else{if(_0x4bd029[0x0]['language']=='German')var _0x993f87=users['German'];else{if(_0x4bd029[0x0][_0x279c75(0x13f)]==_0x279c75(0x15f))var _0x993f87=users[_0x279c75(0x15f)];else{if(_0x4bd029[0x0][_0x279c75(0x13f)]==_0x279c75(0xee))var _0x993f87=users[_0x279c75(0xee)];else{if(_0x4bd029[0x0][_0x279c75(0x13f)]==_0x279c75(0xa3))var _0x993f87=users[_0x279c75(0x180)];else{if(_0x4bd029[0x0][_0x279c75(0x13f)]==_0x279c75(0xd1))var _0x993f87=users[_0x279c75(0xd1)];else{if(_0x4bd029[0x0]['language']==_0x279c75(0x142))var _0x993f87=users[_0x279c75(0xd8)];}}}}}}}_0x4f7a97[_0x279c75(0xe1)](_0x279c75(0xfe),{'success':_0x2d8ffb[_0x279c75(0x131)](_0x279c75(0xd6)),'errors':_0x2d8ffb[_0x279c75(0x131)](_0x279c75(0x149)),'role':_0x514b85,'profile':_0xc3ccfb,'user':_0x2e0fb8,'stock':_0x4b8346,'master_shop':_0x4bd029,'unit':_0x784922,'language':_0x993f87,'warehouses':_0x2e7e46,'rooms':_0x314b4d,'warehouse_QA':_0x102dbb});}catch(_0x22a8b2){console[_0x279c75(0x171)](_0x22a8b2),_0x4f7a97[_0x279c75(0x16a)](0xc8)[_0x279c75(0xca)]({'message':_0x22a8b2[_0x279c75(0x127)]});}}),router[a0_0x2c2748(0x121)](a0_0x2c2748(0x11b),auth,async(_0x3b8f75,_0x15c0d2)=>{var _0x4b4257=a0_0x2c2748;if(_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x107)]=='QA')try{const {invoice:_0x30e703,date:_0x5d791c,warehouse_name:_0x4c2f50,product_name:_0x5067a7,primary_code:_0x2c452d,secondary_code:_0x20cff8,product_code:_0x434c1d,sales_quantity:_0x3c29ff,stocks:_0x5594c6,return_qty:_0x4e10b8,Room_name:_0x1ca055,to_warehouse_name_QA:_0x1eb4ae,to_Room_name_QA:_0x3a53ed,note:_0x232609,for_categorize:_0x3c57e0,product_name_QA1:_0x869eee}=_0x3b8f75[_0x4b4257(0xad)];if(typeof _0x869eee==_0x4b4257(0x16f))var _0x198ed3=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x99)]],_0x4ac08d=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x177)]],_0x2f713f=[_0x3b8f75['body'][_0x4b4257(0x174)]],_0xce37b4=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x139)]],_0x3daabe=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xcb)]],_0xcf1410=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x13e)]],_0xac7b3c=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x12b)]],_0x339797=[_0x3b8f75['body'][_0x4b4257(0x9e)]],_0x4997ff=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x112)]],_0x41c506=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x184)]],_0x5e7f12=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xf9)]],_0x5431d0=[_0x3b8f75['body'][_0x4b4257(0x13b)]],_0x356d6a=[_0x3b8f75['body'][_0x4b4257(0xcd)]],_0x21e0d8=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xf2)]];else var _0x198ed3=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x99)]],_0x4ac08d=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x177)]],_0x2f713f=[..._0x3b8f75['body'][_0x4b4257(0x174)]],_0xce37b4=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x139)]],_0x3daabe=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xcb)]],_0xcf1410=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x13e)]],_0xac7b3c=[..._0x3b8f75[_0x4b4257(0xad)]['return_qty_QA']],_0x339797=[..._0x3b8f75[_0x4b4257(0xad)]['maxPerUnit_QA']],_0x4997ff=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x112)]],_0x41c506=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x184)]],_0x5e7f12=[..._0x3b8f75['body'][_0x4b4257(0xf9)]],_0x5431d0=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x13b)]],_0x356d6a=[..._0x3b8f75['body'][_0x4b4257(0xcd)]],_0x21e0d8=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xf2)]];const _0x410697=_0x198ed3[_0x4b4257(0x113)](_0x5e2dcd=>{return _0x5e2dcd={'product_name':_0x5e2dcd};});_0x4ac08d[_0x4b4257(0x118)]((_0x165a48,_0x24cc1f)=>{var _0x3e552=_0x4b4257;_0x410697[_0x24cc1f][_0x3e552(0xfa)]=_0x165a48;}),_0x2f713f['forEach']((_0xf1bda6,_0x5ad172)=>{var _0x1331b5=_0x4b4257;_0x410697[_0x5ad172][_0x1331b5(0xdb)]=_0xf1bda6;}),_0xce37b4[_0x4b4257(0x118)]((_0x4373e9,_0x60ce3c)=>{var _0x1c54e3=_0x4b4257;_0x410697[_0x60ce3c][_0x1c54e3(0x151)]=_0x4373e9;}),_0x3daabe[_0x4b4257(0x118)]((_0x1330dd,_0xe0ec03)=>{var _0x5c0dbc=_0x4b4257;_0x410697[_0xe0ec03][_0x5c0dbc(0x12a)]=_0x1330dd;}),_0xcf1410[_0x4b4257(0x118)]((_0x3b328b,_0x5a7d74)=>{_0x410697[_0x5a7d74]['stock']=_0x3b328b;}),_0xac7b3c['forEach']((_0x2f9836,_0x4629af)=>{_0x410697[_0x4629af]['return_qty']=_0x2f9836;}),_0x339797[_0x4b4257(0x118)]((_0x24da3a,_0xe3a8f3)=>{var _0x4f3af1=_0x4b4257;_0x410697[_0xe3a8f3][_0x4f3af1(0x173)]=_0x24da3a;}),_0x4997ff[_0x4b4257(0x118)]((_0x585893,_0x37b2d8)=>{var _0x29540d=_0x4b4257;_0x410697[_0x37b2d8][_0x29540d(0x12f)]=_0x585893;}),_0x41c506[_0x4b4257(0x118)]((_0x125a17,_0x131f22)=>{var _0xd9b64=_0x4b4257;_0x410697[_0x131f22][_0xd9b64(0x135)]=_0x125a17;}),_0x5e7f12[_0x4b4257(0x118)]((_0x24c4dd,_0x2f37fb)=>{var _0x43ec01=_0x4b4257;_0x410697[_0x2f37fb][_0x43ec01(0xe3)]=_0x24c4dd;}),_0x5431d0[_0x4b4257(0x118)]((_0x3be32b,_0x495ec7)=>{var _0x30c6ea=_0x4b4257;_0x410697[_0x495ec7][_0x30c6ea(0x97)]=_0x3be32b;}),_0x356d6a[_0x4b4257(0x118)]((_0x43a893,_0x1d0de2)=>{_0x410697[_0x1d0de2]['production_date']=_0x43a893;}),_0x21e0d8[_0x4b4257(0x118)]((_0x21ef9d,_0x6ed614)=>{var _0x156701=_0x4b4257;_0x410697[_0x6ed614][_0x156701(0x94)]=_0x21ef9d;});const _0x214fb9=await sales_finished[_0x4b4257(0x8f)]({'invoice':_0x30e703});_0x214fb9[_0x4b4257(0xf8)]=_0x4b4257(0x165);const _0x5b52ec=await _0x214fb9['save'](),_0x57ff8d=new sales_return_finished({'invoice':_0x30e703,'customer':_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x16d)],'date':_0x5d791c,'warehouse_name':_0x4c2f50,'room':_0x1ca055,'ToWarehouse':_0x1eb4ae,'ToRoom':_0x3a53ed,'return_sale_QA':_0x410697,'note':_0x232609,'warehouse_cat':_0x3c57e0}),_0xa10361=await _0x57ff8d[_0x4b4257(0x160)](),_0x5121a2=await sales_return_finished[_0x4b4257(0x8f)]({'invoice':_0x30e703}),_0x266a17=await warehouse[_0x4b4257(0x8f)]({'name':_0x1eb4ae,'room':_0x3a53ed});_0x5121a2['return_sale_QA'][_0x4b4257(0x118)](_0x56361f=>{var _0x39d030=_0x4b4257,_0x17aa74=0x0;const _0x3f39b4=_0x266a17['product_details'][_0x39d030(0x113)](_0x715bf7=>{var _0x3da31d=_0x39d030;_0x715bf7['product_name']==_0x56361f[_0x3da31d(0x138)]&&_0x715bf7[_0x3da31d(0x94)]==_0x56361f[_0x3da31d(0x94)]&&_0x715bf7['production_date']==_0x56361f[_0x3da31d(0xea)]&&_0x715bf7[_0x3da31d(0x135)]==_0x56361f[_0x3da31d(0x135)]&&(_0x715bf7['product_stock']=parseInt(_0x715bf7['product_stock'])+parseInt(_0x56361f[_0x3da31d(0x114)]),_0x17aa74++);});_0x17aa74=='0'&&(_0x266a17[_0x39d030(0x19e)]=_0x266a17[_0x39d030(0x19e)][_0x39d030(0xb0)]({'product_name':_0x56361f[_0x39d030(0x138)],'product_stock':_0x56361f[_0x39d030(0x114)],'primary_code':_0x56361f[_0x39d030(0xfa)],'secondary_code':_0x56361f[_0x39d030(0xdb)],'product_code':_0x56361f[_0x39d030(0x151)],'batch_code':_0x56361f['batch_code'],'maxPerUnit':_0x56361f['maxPerUnit'],'production_date':_0x56361f['production_date'],'expiry_date':_0x56361f[_0x39d030(0x94)],'secondary_unit':_0x56361f[_0x39d030(0xe3)],'unit':_0x56361f[_0x39d030(0x97)],'maxProducts':_0x56361f[_0x39d030(0x12f)],'bay':_0x56361f[_0x39d030(0x12d)]}));}),await _0x266a17[_0x4b4257(0x160)]();const _0x109cbe=new c_payment_data({'invoice':_0x30e703,'customer':_0x3b8f75[_0x4b4257(0xad)]['customer'],'reason':_0x4b4257(0x187)});await _0x109cbe[_0x4b4257(0x160)]();const _0x5aeaf5=await master_shop['find'](),_0x2c7177=await email_settings[_0x4b4257(0x8f)](),_0x4adc29=await customer[_0x4b4257(0x8f)]({'name':_0x3b8f75['body']['customer']});_0x5aeaf5[0x0][_0x4b4257(0x104)]==0x1?(right_currency=_0x5aeaf5[0x0][_0x4b4257(0x92)],left_currency=''):(right_currency='',left_currency=_0x5aeaf5[0x0]['currency']);var _0xffc115=_0x198ed3,_0x3ff0d2=_0xac7b3c,_0x57e5c5='',_0x2ded41;for(_0x2ded41 in _0xffc115){_0x57e5c5+=_0x4b4257(0xf1)+_0x4b4257(0x152)+_0xffc115[_0x2ded41]+_0x4b4257(0xe7)+_0x4b4257(0x152)+_0x3ff0d2[_0x2ded41]+_0x4b4257(0xe7)+'</tr>';}console['log'](_0x4b4257(0xff),_0x57e5c5);let _0x37c1f8=nodemailer[_0x4b4257(0x111)]({'service':_0x4b4257(0x102),'auth':{'user':_0x2c7177['email'],'pass':_0x2c7177['password']}}),_0x495b90={'from':_0x2c7177[_0x4b4257(0x189)],'to':_0x4adc29[_0x4b4257(0x189)],'subject':_0x4b4257(0x18d),'attachments':[{'filename':_0x4b4257(0xbc),'path':__dirname+_0x4b4257(0x19f)+_0x4b4257(0xa7)+_0x5aeaf5[0x0][_0x4b4257(0x9d)],'cid':'logo'}],'html':_0x4b4257(0xe0)+_0x4b4257(0x106)+_0x4b4257(0xec)+'<div>'+_0x4b4257(0x19c)+_0x4b4257(0xa9)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x4b4257(0xac)+_0x4b4257(0xa9)+_0x4b4257(0x136)+_0x5aeaf5[0x0][_0x4b4257(0x1a0)]+_0x4b4257(0x153)+_0x4b4257(0xac)+_0x4b4257(0xac)+_0x4b4257(0x116)+'<div>'+_0x4b4257(0x96)+_0x4b4257(0x91)+_0x30e703+'\x20'+_0x4b4257(0x11c)+_0x4b4257(0x163)+_0x5d791c+'\x20'+_0x4b4257(0xdf)+'</h5>'+_0x4b4257(0xac)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4b4257(0xf1)+_0x4b4257(0x192)+_0x4b4257(0x119)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x4b4257(0x12e)+_0x4b4257(0x197)+_0x4b4257(0x157)+_0x4b4257(0xdc)+'\x20'+_0x57e5c5+'\x20'+_0x4b4257(0x164)+_0x4b4257(0xbb)+_0x4b4257(0xa9)+_0x4b4257(0x140)+_0x4b4257(0xa8)+_0x5aeaf5[0x0]['site_title']+_0x4b4257(0x15c)+_0x4b4257(0xac)+'</div>'+_0x4b4257(0x124)};_0x37c1f8['sendMail'](_0x495b90,function(_0x15fda5,_0x10bce8){var _0x1e9448=_0x4b4257;_0x15fda5?(console[_0x1e9448(0x171)](_0x15fda5),console['log'](_0x1e9448(0xa5))):console[_0x1e9448(0x171)]('Email\x20sent\x20successfully');}),_0x3b8f75['flash']('success',_0x4b4257(0x194)),_0x15c0d2[_0x4b4257(0x9b)]('/all_sales_finished/view');}catch(_0x2f0941){_0x15c0d2[_0x4b4257(0x16a)](0xc8)['json']({'message1':_0x2f0941['message']});}else{if(_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x107)]=='GS')try{const {invoice:_0x3b6c8b,date:_0x220ce4,warehouse_name:_0x359af1,product_name:_0x4a42ad,primary_code:_0x149bd2,secondary_code:_0x19dcbd,product_code:_0x2d5e92,sales_quantity:_0x425ad6,stocks:_0x1f4e66,return_qty:_0x181f27,Room_name:_0x4f66cb,to_warehouse_name:_0x2d8651,to_Room_name:_0x3eb2f5,note:_0x5e5d66,level:_0x539763,isle:_0x5e67e7,pallet:_0x25e0ea,for_categorize:_0x1804fa}=_0x3b8f75[_0x4b4257(0xad)];if(typeof _0x4a42ad==_0x4b4257(0x16f))var _0x198ed3=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x138)]],_0x4ac08d=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xfa)]],_0x2f713f=[_0x3b8f75['body'][_0x4b4257(0xdb)]],_0xce37b4=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x151)]],_0x3daabe=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x14a)]],_0xac7b3c=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x114)]],_0x2eb9e6=[_0x3b8f75[_0x4b4257(0xad)]['bay']],_0x339797=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x173)]],_0x4997ff=[_0x3b8f75[_0x4b4257(0xad)]['maxProducts']],_0x41c506=[_0x3b8f75[_0x4b4257(0xad)]['batch_code']],_0x5e7f12=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xe3)]],_0x5431d0=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x97)]],_0x356d6a=[_0x3b8f75[_0x4b4257(0xad)]['production_date']],_0x21e0d8=[_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x94)]];else var _0x198ed3=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x138)]],_0x4ac08d=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xfa)]],_0x2f713f=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xdb)]],_0xce37b4=[..._0x3b8f75['body'][_0x4b4257(0x151)]],_0x3daabe=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x14a)]],_0xac7b3c=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x114)]],_0x2eb9e6=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x12d)]],_0x339797=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x173)]],_0x4997ff=[..._0x3b8f75['body']['maxProducts']],_0x41c506=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x135)]],_0x5e7f12=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0xe3)]],_0x5431d0=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x97)]],_0x356d6a=[..._0x3b8f75[_0x4b4257(0xad)]['production_date']],_0x21e0d8=[..._0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x94)]];const _0x37ce0c=_0x198ed3[_0x4b4257(0x113)](_0x2367c8=>{return _0x2367c8={'product_name':_0x2367c8};});_0x4ac08d[_0x4b4257(0x118)]((_0xe6b4f,_0x24980d)=>{var _0x5d0815=_0x4b4257;_0x37ce0c[_0x24980d][_0x5d0815(0xfa)]=_0xe6b4f;}),_0x2f713f[_0x4b4257(0x118)]((_0x151a22,_0x2b991c)=>{var _0x215e9f=_0x4b4257;_0x37ce0c[_0x2b991c][_0x215e9f(0xdb)]=_0x151a22;}),_0xce37b4[_0x4b4257(0x118)]((_0xb03f9d,_0x4aea7a)=>{_0x37ce0c[_0x4aea7a]['product_code']=_0xb03f9d;}),_0x3daabe['forEach']((_0x52e903,_0x2fcd84)=>{var _0x2f9e5f=_0x4b4257;_0x37ce0c[_0x2fcd84][_0x2f9e5f(0x12a)]=_0x52e903;}),_0xac7b3c[_0x4b4257(0x118)]((_0xde64ae,_0x1cf635)=>{var _0x4e2a3a=_0x4b4257;_0x37ce0c[_0x1cf635][_0x4e2a3a(0x114)]=_0xde64ae;}),_0x2eb9e6[_0x4b4257(0x118)]((_0xd1f1ca,_0x5a3d8a)=>{var _0x19b06=_0x4b4257;_0x37ce0c[_0x5a3d8a][_0x19b06(0x12d)]=_0xd1f1ca;}),_0x339797['forEach']((_0x51358f,_0x5b6de0)=>{_0x37ce0c[_0x5b6de0]['maxPerUnit']=_0x51358f;}),_0x4997ff['forEach']((_0x53de61,_0x30528c)=>{var _0x497951=_0x4b4257;_0x37ce0c[_0x30528c][_0x497951(0x12f)]=_0x53de61;}),_0x41c506[_0x4b4257(0x118)]((_0xc16beb,_0xccd4dd)=>{var _0x532995=_0x4b4257;_0x37ce0c[_0xccd4dd][_0x532995(0x135)]=_0xc16beb;}),_0x5e7f12[_0x4b4257(0x118)]((_0x18e53c,_0x589de6)=>{var _0x3f9c89=_0x4b4257;_0x37ce0c[_0x589de6][_0x3f9c89(0xe3)]=_0x18e53c;}),_0x5431d0['forEach']((_0x301a7c,_0x167a8b)=>{var _0x2ccfef=_0x4b4257;_0x37ce0c[_0x167a8b][_0x2ccfef(0x97)]=_0x301a7c;}),_0x356d6a[_0x4b4257(0x118)]((_0x15ba16,_0x3cd29a)=>{var _0x35d623=_0x4b4257;_0x37ce0c[_0x3cd29a][_0x35d623(0xea)]=_0x15ba16;}),_0x21e0d8['forEach']((_0x406259,_0x4da925)=>{_0x37ce0c[_0x4da925]['expiry_date']=_0x406259;});var _0x37edfb=0x0;_0x37ce0c['forEach'](_0x3085cc=>{var _0x4a7a19=_0x4b4257;(parseInt(_0x3085cc[_0x4a7a19(0x12a)])<parseInt(_0x3085cc[_0x4a7a19(0x114)])||parseInt(_0x3085cc[_0x4a7a19(0xba)])<parseInt(_0x3085cc[_0x4a7a19(0x114)])&&parseInt(_0x3085cc['sale_qty'])>parseInt(_0x3085cc[_0x4a7a19(0x114)])||parseInt(_0x3085cc[_0x4a7a19(0x114)])==0x0)&&_0x37edfb++;});if(_0x37edfb!=0x0)return _0x3b8f75[_0x4b4257(0x131)]('errors',_0x4b4257(0xf5)),_0x15c0d2[_0x4b4257(0x9b)](_0x4b4257(0xab));const _0x51c76e=await sales_finished[_0x4b4257(0x8f)]({'invoice':_0x3b6c8b});_0x51c76e[_0x4b4257(0xf8)]=_0x4b4257(0x165);const _0x2fac53=await _0x51c76e[_0x4b4257(0x160)](),_0x26a073=new sales_return_finished({'invoice':_0x3b6c8b,'customer':_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x16d)],'date':_0x220ce4,'warehouse_name':_0x359af1,'room':_0x4f66cb,'ToWarehouse':_0x2d8651,'ToRoom':_0x3eb2f5,'return_sale':_0x37ce0c,'note':_0x5e5d66,'warehouse_cat':_0x1804fa}),_0x1fdb68=await _0x26a073[_0x4b4257(0x160)](),_0x2dd00d=await sales_return_finished['findOne']({'invoice':_0x3b6c8b}),_0xcba81b=await warehouse['findOne']({'name':_0x2d8651,'room':_0x3eb2f5,'warehouse_category':_0x4b4257(0x18f)});_0x2dd00d[_0x4b4257(0xc2)][_0x4b4257(0x118)](_0x145d5a=>{var _0x339a71=_0x4b4257,_0x591d13=0x0;const _0x1a60c8=_0xcba81b[_0x339a71(0x19e)]['map'](_0x13385a=>{var _0x1b7859=_0x339a71;_0x13385a[_0x1b7859(0x138)]==_0x145d5a[_0x1b7859(0x138)]&&_0x13385a['bay']==_0x145d5a['bay']&&_0x13385a[_0x1b7859(0x94)]==_0x145d5a[_0x1b7859(0x94)]&&_0x13385a[_0x1b7859(0xea)]==_0x145d5a[_0x1b7859(0xea)]&&_0x13385a[_0x1b7859(0x135)]==_0x145d5a['batch_code']&&(_0x13385a['product_stock']=parseInt(_0x13385a[_0x1b7859(0xaa)])+parseInt(_0x145d5a[_0x1b7859(0x114)]),_0x591d13++);});_0x591d13=='0'&&(_0xcba81b[_0x339a71(0x19e)]=_0xcba81b[_0x339a71(0x19e)][_0x339a71(0xb0)]({'product_name':_0x145d5a['product_name'],'product_stock':_0x145d5a[_0x339a71(0x114)],'primary_code':_0x145d5a[_0x339a71(0xfa)],'secondary_code':_0x145d5a['secondary_code'],'product_code':_0x145d5a['product_code'],'bay':_0x145d5a[_0x339a71(0x12d)],'batch_code':_0x145d5a[_0x339a71(0x135)],'maxPerUnit':_0x145d5a[_0x339a71(0x173)],'production_date':_0x145d5a['production_date'],'expiry_date':_0x145d5a['expiry_date'],'secondary_unit':_0x145d5a[_0x339a71(0xe3)],'unit':_0x145d5a[_0x339a71(0x97)],'maxProducts':_0x145d5a['maxProducts']}));}),await _0xcba81b[_0x4b4257(0x160)](),console[_0x4b4257(0x171)](_0x3b8f75[_0x4b4257(0xad)]);const _0x422353=new c_payment_data({'invoice':_0x3b6c8b,'customer':_0x3b8f75[_0x4b4257(0xad)][_0x4b4257(0x16d)],'reason':_0x4b4257(0x187)});await _0x422353['save']();const _0x37998a=await master_shop['find']();console[_0x4b4257(0x171)](_0x4b4257(0xf6),_0x37998a[0x0]['image']);const _0x41ad2d=await email_settings['findOne'](),_0x3a7f12=await customer[_0x4b4257(0x8f)]({'name':_0x3b8f75[_0x4b4257(0xad)]['customer']});console['log']('customer_data',_0x3a7f12);_0x37998a[0x0][_0x4b4257(0x104)]==0x1?(right_currency=_0x37998a[0x0][_0x4b4257(0x92)],left_currency=''):(right_currency='',left_currency=_0x37998a[0x0][_0x4b4257(0x92)]);var _0xffc115=_0x198ed3,_0x3ff0d2=_0xac7b3c,_0x57e5c5='',_0x2ded41;for(_0x2ded41 in _0xffc115){_0x57e5c5+=_0x4b4257(0xf1)+_0x4b4257(0x152)+_0xffc115[_0x2ded41]+_0x4b4257(0xe7)+_0x4b4257(0x152)+_0x3ff0d2[_0x2ded41]+_0x4b4257(0xe7)+'</tr>';}console[_0x4b4257(0x171)](_0x4b4257(0xff),_0x57e5c5);let _0xf8989d=nodemailer[_0x4b4257(0x111)]({'service':'gmail','auth':{'user':_0x41ad2d['email'],'pass':_0x41ad2d['password']}}),_0x2818d7={'from':_0x41ad2d[_0x4b4257(0x189)],'to':_0x3a7f12[_0x4b4257(0x189)],'subject':_0x4b4257(0x18d),'attachments':[{'filename':_0x4b4257(0xbc),'path':__dirname+_0x4b4257(0x19f)+_0x4b4257(0xa7)+_0x37998a[0x0]['image'],'cid':_0x4b4257(0x17c)}],'html':_0x4b4257(0xe0)+'<html><head><title></title>'+_0x4b4257(0xec)+_0x4b4257(0xa9)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x4b4257(0xbf)+_0x4b4257(0xac)+_0x4b4257(0xa9)+'<h2>\x20'+_0x37998a[0x0][_0x4b4257(0x1a0)]+_0x4b4257(0x153)+_0x4b4257(0xac)+_0x4b4257(0xac)+_0x4b4257(0x116)+'<div>'+_0x4b4257(0x96)+_0x4b4257(0x91)+_0x3b6c8b+'\x20'+_0x4b4257(0x11c)+'\x20Order\x20Date\x20:\x20'+_0x220ce4+'\x20'+_0x4b4257(0xdf)+_0x4b4257(0x15c)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4b4257(0x16e)+_0x4b4257(0xf1)+_0x4b4257(0x192)+_0x4b4257(0x119)+_0x4b4257(0x133)+_0x4b4257(0x12e)+_0x4b4257(0x197)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x57e5c5+'\x20'+_0x4b4257(0x164)+_0x4b4257(0xbb)+_0x4b4257(0xa9)+_0x4b4257(0x140)+_0x4b4257(0xa8)+_0x37998a[0x0][_0x4b4257(0x1a0)]+_0x4b4257(0x15c)+_0x4b4257(0xac)+_0x4b4257(0xac)+_0x4b4257(0x124)};_0xf8989d[_0x4b4257(0x18a)](_0x2818d7,function(_0x4a5ec1,_0x260c0b){var _0x354c12=_0x4b4257;_0x4a5ec1?(console[_0x354c12(0x171)](_0x4a5ec1),console[_0x354c12(0x171)](_0x354c12(0xa5))):console['log']('Email\x20sent\x20successfully');}),_0x3b8f75[_0x4b4257(0x131)](_0x4b4257(0xd6),_0x4b4257(0x194)),_0x15c0d2[_0x4b4257(0x9b)](_0x4b4257(0x11e));}catch(_0x489e1f){console['log'](_0x489e1f),_0x15c0d2[_0x4b4257(0x16a)](0xc8)[_0x4b4257(0xca)]({'message1':_0x489e1f[_0x4b4257(0x127)]});}}}),router[a0_0x2c2748(0xc6)](a0_0x2c2748(0x95),auth,async(_0x42e493,_0x559592)=>{var _0x1c3b8a=a0_0x2c2748;try{const {username:_0x5d06a0,email:_0x408658,role:_0x31e90c}=_0x42e493[_0x1c3b8a(0xc8)],_0xc37506=_0x42e493[_0x1c3b8a(0xc8)],_0x343c50=await profile[_0x1c3b8a(0x8f)]({'email':_0xc37506[_0x1c3b8a(0x189)]}),_0x217a19=await master_shop[_0x1c3b8a(0x17d)]();console['log']('barcode\x20Product\x20master',_0x217a19);const _0x984834=_0x42e493[_0x1c3b8a(0x8e)]['id'],_0x3e4088=await sales[_0x1c3b8a(0x169)](_0x984834);console[_0x1c3b8a(0x171)]('barcode\x20user_id',_0x3e4088);if(_0x217a19[0x0][_0x1c3b8a(0x13f)]==_0x1c3b8a(0xcc))var _0x3edd76=users[_0x1c3b8a(0xb3)];else{if(_0x217a19[0x0][_0x1c3b8a(0x13f)]==_0x1c3b8a(0x13a))var _0x3edd76=users['Hindi'];else{if(_0x217a19[0x0][_0x1c3b8a(0x13f)]==_0x1c3b8a(0x120))var _0x3edd76=users['German'];else{if(_0x217a19[0x0]['language']==_0x1c3b8a(0x15f))var _0x3edd76=users[_0x1c3b8a(0x15f)];else{if(_0x217a19[0x0][_0x1c3b8a(0x13f)]==_0x1c3b8a(0xee))var _0x3edd76=users[_0x1c3b8a(0xee)];else{if(_0x217a19[0x0][_0x1c3b8a(0x13f)]=='Portuguese\x20(BR)')var _0x3edd76=users[_0x1c3b8a(0x180)];else{if(_0x217a19[0x0]['language']==_0x1c3b8a(0xd1))var _0x3edd76=users[_0x1c3b8a(0xd1)];else{if(_0x217a19[0x0][_0x1c3b8a(0x13f)]==_0x1c3b8a(0x142))var _0x3edd76=users[_0x1c3b8a(0xd8)];}}}}}}}_0x559592[_0x1c3b8a(0xe1)]('all_sales_barcode',{'success':_0x42e493['flash'](_0x1c3b8a(0xd6)),'errors':_0x42e493[_0x1c3b8a(0x131)](_0x1c3b8a(0x149)),'role':_0xc37506,'profile':_0x343c50,'alldata':_0x3e4088,'master_shop':_0x217a19,'language':_0x3edd76});}catch(_0x3e0ad4){console[_0x1c3b8a(0x171)](_0x3e0ad4);}}),router[a0_0x2c2748(0x121)](a0_0x2c2748(0x186),async(_0x1221ac,_0x3b8cb6)=>{var _0x21ba35=a0_0x2c2748;const {product_code:_0x42636d,warehouse_name:_0x1e18e0,rooms_data:_0x3ed306,Roomslist:_0x3d0d27}=_0x1221ac[_0x21ba35(0xad)],_0x46d4fd=_0x3d0d27[_0x21ba35(0x175)](','),_0xbe63ff=[];async function _0x1ef604(_0x242679){var _0x3db483=_0x21ba35;const _0x4a1fa0=await warehouse[_0x3db483(0x128)]([{'$match':{'name':_0x1e18e0,'room':_0x242679}},{'$unwind':_0x3db483(0x100)},{'$match':{'product_details.primary_code':_0x42636d}},{'$group':{'_id':_0x3db483(0x179),'name':{'$first':_0x3db483(0xb4)},'product_stock':{'$first':_0x3db483(0xc1)},'primary_code':{'$first':_0x3db483(0x105)},'secondary_code':{'$first':_0x3db483(0x158)},'product_code':{'$first':_0x3db483(0xdd)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3db483(0xed)},'type':{'$first':_0x3db483(0x134)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x3db483(0xe5)},'secondary_unit':{'$first':_0x3db483(0x8d)},'storage':{'$first':_0x3db483(0x11d)},'rack':{'$first':_0x3db483(0xb2)},'expiry_date':{'$first':_0x3db483(0x123)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x3db483(0xa4)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3db483(0x110)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3db483(0x191)},'invoice':{'$first':_0x3db483(0xaf)}}}]),_0x4c42e7=await warehouse['aggregate']([{'$match':{'name':_0x1e18e0,'room':_0x242679}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x42636d}},{'$group':{'_id':_0x3db483(0x179),'name':{'$first':_0x3db483(0xb4)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x3db483(0x105)},'secondary_code':{'$first':_0x3db483(0x158)},'product_code':{'$first':_0x3db483(0xdd)},'level':{'$first':_0x3db483(0x147)},'isle':{'$first':_0x3db483(0xed)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3db483(0x126)},'unit':{'$first':_0x3db483(0xe5)},'secondary_unit':{'$first':_0x3db483(0x8d)},'storage':{'$first':_0x3db483(0x11d)},'rack':{'$first':_0x3db483(0xb2)},'expiry_date':{'$first':_0x3db483(0x123)},'production_date':{'$first':_0x3db483(0xef)},'maxPerUnit':{'$first':_0x3db483(0xa4)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3db483(0x110)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3db483(0x191)},'invoice':{'$first':_0x3db483(0xaf)}}}]);if(_0x4a1fa0[_0x3db483(0x183)]>0x0)_0xbe63ff[_0x3db483(0x16b)](_0x4a1fa0);else _0x4c42e7['length']>0x0&&_0xbe63ff[_0x3db483(0x16b)](_0x4c42e7);}const _0x2a7dcb=_0x46d4fd[_0x21ba35(0x113)](_0x38c6ae=>_0x1ef604(_0x38c6ae));await Promise[_0x21ba35(0x195)](_0x2a7dcb),_0x3b8cb6[_0x21ba35(0xca)](_0xbe63ff);}),module[a0_0x2c2748(0xc3)]=router;