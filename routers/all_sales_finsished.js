function a0_0x2866(){var _0x4aeda3=['/barcode_scanner','catch','/view/:id','product_date','warehouse_name','German','$return_data','$date','35763RcyAKU','edit_sales_finished_view','RoomAssigned','unit_QA','1883898dIAuYb','</head><body>','$sale_product.quantity','An\x20error\x20occurred\x20while\x20saving\x20data.','$sale_product.floorlevel','save','stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Sales\x20Add\x20successfully','warehouse','abs','port','nodemailer','$product_details.bin','$customers_docs','email','return_sale_finished','edit_sales_finished','$product_details.product_code','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','/view','$product_details._id','suppliers','unit','purchases_data','11237281bVpeUY','return_qty_QA','floor','Sale\x20Return','/all_sales/view','find','maxPerUnit','$room','$name','$product_details.type','room','$note','status','return_sale_QA','Arabic','adjust_qty','findById','1200IbxdMD','level','/view/add_sale/product','DRY\x20GOODS','filter','</tbody>','11780fSWAcu','sale_qty','batch_code_QA','primary_unit','<h5\x20style=\x22text-align:\x20left;\x22>','due_amount','/preview/:id','back','get','$product_details.product_stock','customers_docs','$product_details.product_name','$product_details.room_name','final','forEach','product_name_QA1','language','secondary_code_QA','English','528899wnFHRB','</thead>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','express','</span>','/view/add_sales','/give_payment/:id','$sale_product.bay','amount','<h2>\x20','$sale_product.type','product_code','\x20</h2>','/../public','Enclosed','$_id','message','prod_code','</div>','expiry_date','../models/all_models','getDate','gmail','secondary_unit','OUTF-','/barcode/:id','json','maxperunit','sale_product','add_sales_finished','batch_code','render','post','\x20Order\x20Date\x20:\x20','/invoice/:id','bay','ADD\x20SALE','$sale_product.bin','quantity','secondary_code','$product_details.maxProducts','push','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$product_details.secondary_code','product','aggregate','primary_code_QA','maxProducts','</td>','$product_details.invoice','Logo.png','There\x27s\x20a\x20error\x20in\x20this\x20transaction','all_sales_barcode','$product_details.expiry_date','$product_details.bay','<div>','product_code_QA','errors','image','../public/language/languages.json','production_date','product_details','<span\x20style=\x22float:\x20right;\x22>','$product_details.storage','../middleware/auth','barcode\x20Product\x20master','customers','stocks_QA','toString','maxProducts_QA','$product_details.production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.maxPerUnit','Add\x20Sales','flash','logo','<html><head><title></title>','production_date_QA','product_name','$sale_product','Error\x20Occurs','role','received_amount','product_data','maxPerUnit_QA','name','English\x20(US)','Portuguese\x20(BR)','note','findOne','QA\x20Warehouse','</table>','customer_data','Arabic\x20(ae)','FGSEmail','foreach\x20newproduct','id_transaction_from','site_title','$product.product_name','8379nWxUml','False','\x20&&\x20','2zLFlzE','body','Router','Enabled','$product_details','$customer','prod_cat','length','\x20Order\x20Number\x20:\x20','params','getFullYear','Portuguese','string','redirect','An\x20error\x20occurred.','invoice','Sale\x20Return\x20Mail','slice','finalize','date','return_data','<!DOCTYPE\x20html>','\x20>>>\x20','room_name','max_per_unit','exports','then','7090WMBtNJ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$invoice','currency','sales_quantity_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','error','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','createTransport','master','Received\x20Payment\x20For\x20Sale','primary_code','$product_details.unit','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','customer','user','max','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Finished\x20Goods','$product_details.primary_code','sales_quantity','secondary_unit_QA','return_qty','Ambient','return_sale','log','Chinese','$product_details.rack','product_stock','$finalize','Return\x20Goods','carton','sales_invoice','all','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Sales\x20Update\x20successfully','/picking_list/pdf/','sendMail','5428208lHAMKD','padStart','/all_sales_finished/preview/','map','<tr>','<h5>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Hindi','Quality\x20Inspection','/all_sales_finished/view','</body></html>','<strong>\x20Regards\x20</strong>','/view/add_sales/:id','staff','\x20<<<==>>>\x20','Spanish','$product_details.floorlevel','sales\x20item\x20return\x20successfull','Email\x20sent\x20successfully','6trgrcc','getMonth','French','product_list','\x20==\x20','$warehouse_name','all_sales_finished','currency_placement','_id','</tr>','<hr\x20class=\x22my-3\x22>','expiry_date_QA','prod_invoice','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','success','$product_details.batch_code','/upload/','password','Sale','host','$product_details.product_cat','<tbody\x20style=\x22text-align:\x20center;\x22>','concat','</h5>'];a0_0x2866=function(){return _0x4aeda3;};return a0_0x2866();}var a0_0x47c58f=a0_0x2b78;function a0_0x2b78(_0x5ba998,_0x23064d){var _0x286686=a0_0x2866();return a0_0x2b78=function(_0x2b7876,_0x4c5e4c){_0x2b7876=_0x2b7876-0xc7;var _0x45c97e=_0x286686[_0x2b7876];return _0x45c97e;},a0_0x2b78(_0x5ba998,_0x23064d);}(function(_0x5c4dc0,_0x3e8f15){var _0x5cf0c6=a0_0x2b78,_0x3086f5=_0x5c4dc0();while(!![]){try{var _0xb7bd49=-parseInt(_0x5cf0c6(0x170))/0x1*(parseInt(_0x5cf0c6(0x1d6))/0x2)+-parseInt(_0x5cf0c6(0x12d))/0x3+parseInt(_0x5cf0c6(0x15d))/0x4*(-parseInt(_0x5cf0c6(0x157))/0x5)+-parseInt(_0x5cf0c6(0x108))/0x6*(parseInt(_0x5cf0c6(0x129))/0x7)+parseInt(_0x5cf0c6(0xf5))/0x8+parseInt(_0x5cf0c6(0x1d3))/0x9*(parseInt(_0x5cf0c6(0xcd))/0xa)+parseInt(_0x5cf0c6(0x146))/0xb;if(_0xb7bd49===_0x3e8f15)break;else _0x3086f5['push'](_0x3086f5['shift']());}catch(_0x49899e){_0x3086f5['push'](_0x3086f5['shift']());}}}(a0_0x2866,0x77f8a));const express=require(a0_0x47c58f(0x173)),app=express(),router=express[a0_0x47c58f(0x1d8)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x47c58f(0x184)),auth=require(a0_0x47c58f(0x1b0)),nodemailer=require(a0_0x47c58f(0x139)),users=require(a0_0x47c58f(0x1ab));router[a0_0x47c58f(0x165)](a0_0x47c58f(0x141),auth,async(_0x4df72b,_0x46dc35)=>{var _0x4b0910=a0_0x47c58f;try{const {username:_0x5254c9,email:_0x5281e8,role:_0x33d549}=_0x4df72b[_0x4b0910(0xde)],_0xe5ec60=_0x4df72b['user'],_0x5e9f97=await profile[_0x4b0910(0x1c9)]({'email':_0xe5ec60['email']}),_0x5a1162=await master_shop['find']();let _0x5893da;if(_0xe5ec60[_0x4b0910(0x1c1)]==_0x4b0910(0x102)){const _0x3c9ed7=await staff[_0x4b0910(0x1c9)]({'email':_0xe5ec60[_0x4b0910(0x13c)]});_0x5893da=await sales_finished[_0x4b0910(0x19d)]([{'$lookup':{'from':'customers','localField':_0x4b0910(0xdd),'foreignField':_0x4b0910(0x1c5),'as':'customers_docs'}},{'$unwind':_0x4b0910(0x13b)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x4b0910(0x17f),'invoice':{'$first':_0x4b0910(0xcf)},'customers':{'$first':_0x4b0910(0x1db)},'date':{'$first':_0x4b0910(0x128)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x4b0910(0x1bf)},'note':{'$first':'$note'},'return_data':{'$first':_0x4b0910(0x127)},'customers_docs':{'$first':_0x4b0910(0x13b)},'total_saleproduct_quantity':{'$sum':_0x4b0910(0x12f)},'level':{'$addToSet':_0x4b0910(0x177)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x4b0910(0x17a)},'pallet':{'$addToSet':_0x4b0910(0x131)},'finalize':{'$first':_0x4b0910(0xec)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5893da=await sales_finished[_0x4b0910(0x19d)]([{'$lookup':{'from':_0x4b0910(0x1b2),'localField':'customer','foreignField':_0x4b0910(0x1c5),'as':_0x4b0910(0x167)}},{'$unwind':_0x4b0910(0x13b)},{'$unwind':_0x4b0910(0x1bf)},{'$group':{'_id':_0x4b0910(0x17f),'invoice':{'$first':_0x4b0910(0xcf)},'customers':{'$first':_0x4b0910(0x1db)},'date':{'$first':_0x4b0910(0x128)},'warehouse_name':{'$first':_0x4b0910(0x10d)},'sale_product':{'$push':_0x4b0910(0x1bf)},'note':{'$first':_0x4b0910(0x151)},'return_data':{'$first':_0x4b0910(0x127)},'customers_docs':{'$first':_0x4b0910(0x13b)},'total_saleproduct_quantity':{'$sum':_0x4b0910(0x12f)},'level':{'$addToSet':_0x4b0910(0x177)},'isle':{'$addToSet':_0x4b0910(0x195)},'type':{'$addToSet':_0x4b0910(0x17a)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x4b0910(0xec)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x5a1162[0x0][_0x4b0910(0x16d)]==_0x4b0910(0x1c6)){var _0x176ab2=users['English'];console[_0x4b0910(0xe8)](_0x176ab2);}else{if(_0x5a1162[0x0][_0x4b0910(0x16d)]==_0x4b0910(0xfc))var _0x176ab2=users[_0x4b0910(0xfc)];else{if(_0x5a1162[0x0][_0x4b0910(0x16d)]==_0x4b0910(0x126))var _0x176ab2=users[_0x4b0910(0x126)];else{if(_0x5a1162[0x0][_0x4b0910(0x16d)]==_0x4b0910(0x104))var _0x176ab2=users['Spanish'];else{if(_0x5a1162[0x0][_0x4b0910(0x16d)]==_0x4b0910(0x10a))var _0x176ab2=users[_0x4b0910(0x10a)];else{if(_0x5a1162[0x0][_0x4b0910(0x16d)]==_0x4b0910(0x1c7))var _0x176ab2=users[_0x4b0910(0x1e1)];else{if(_0x5a1162[0x0]['language']=='Chinese')var _0x176ab2=users[_0x4b0910(0xe9)];else{if(_0x5a1162[0x0][_0x4b0910(0x16d)]=='Arabic\x20(ae)')var _0x176ab2=users['Arabic'];}}}}}}}_0x46dc35['render'](_0x4b0910(0x10e),{'success':_0x4df72b[_0x4b0910(0x1ba)](_0x4b0910(0x117)),'errors':_0x4df72b[_0x4b0910(0x1ba)](_0x4b0910(0x1a9)),'sales':_0x5893da,'profile':_0x5e9f97,'role':_0xe5ec60,'master_shop':_0x5a1162,'language':_0x176ab2});}catch(_0x135eb0){console[_0x4b0910(0xe8)](_0x135eb0);}});async function getRandom8DigitNumber(){var _0x5280e7=a0_0x47c58f;const _0x56d9c4=0x989680,_0x4e251a=0x5f5e0ff,_0x1ee577=Math[_0x5280e7(0x148)](Math['random']()*(_0x4e251a-_0x56d9c4+0x1))+_0x56d9c4;var _0x55e3fd;const _0x2fa456=await sales_finished[_0x5280e7(0x1c9)]({'invoice':_0x5280e7(0x188)+_0x1ee577});return _0x2fa456&&_0x2fa456[_0x5280e7(0x1dd)]>0x0?_0x55e3fd=_0x5280e7(0x188)+_0x1ee577:_0x55e3fd=_0x5280e7(0x188)+_0x1ee577,_0x55e3fd;}router[a0_0x47c58f(0x165)](a0_0x47c58f(0x175),auth,async(_0x29991e,_0x3d3f4d)=>{var _0x2407fa=a0_0x47c58f;try{const {username:_0x4975d4,email:_0x2cfeee,role:_0x31c16f}=_0x29991e[_0x2407fa(0xde)],_0x407067=_0x29991e[_0x2407fa(0xde)],_0x172497=await profile[_0x2407fa(0x1c9)]({'email':_0x407067[_0x2407fa(0x13c)]}),_0x2a940a=await master_shop[_0x2407fa(0x14b)](),_0x1f5402=await customer['find']({});let _0x551bd0;if(_0x407067[_0x2407fa(0x1c1)]==_0x2407fa(0x102)){const _0x11c614=await staff[_0x2407fa(0x1c9)]({'email':_0x407067[_0x2407fa(0x13c)]});_0x551bd0=await warehouse[_0x2407fa(0x19d)]([{'$match':{'status':'Enabled','name':_0x11c614[_0x2407fa(0x136)],'warehouse_category':_0x2407fa(0xe1),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x2407fa(0x14e),'name':{'$first':_0x2407fa(0x14e)}}},{'$sort':{'name':0x1}}]);}else _0x551bd0=await warehouse[_0x2407fa(0x19d)]([{'$match':{'status':'Enabled','warehouse_category':_0x2407fa(0xe1),'name':{'$ne':_0x2407fa(0x1ca)}}},{'$group':{'_id':_0x2407fa(0x14e),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x17987a=await product[_0x2407fa(0x14b)]({});var _0x4e94bb=[_0x2407fa(0xe6),_0x2407fa(0x17e)];const _0x43fea3=await sales_finished[_0x2407fa(0x14b)]({}),_0x5d831e=_0x43fea3['length']+0x1,_0x768a92=_0x2407fa(0x188)+_0x5d831e[_0x2407fa(0x1b4)]()[_0x2407fa(0xf6)](0x5,'0');if(_0x2a940a[0x0][_0x2407fa(0x16d)]=='English\x20(US)'){var _0xf72fa4=users[_0x2407fa(0x16f)];console[_0x2407fa(0xe8)](_0xf72fa4);}else{if(_0x2a940a[0x0]['language']==_0x2407fa(0xfc))var _0xf72fa4=users[_0x2407fa(0xfc)];else{if(_0x2a940a[0x0][_0x2407fa(0x16d)]==_0x2407fa(0x126))var _0xf72fa4=users[_0x2407fa(0x126)];else{if(_0x2a940a[0x0][_0x2407fa(0x16d)]==_0x2407fa(0x104))var _0xf72fa4=users[_0x2407fa(0x104)];else{if(_0x2a940a[0x0][_0x2407fa(0x16d)]==_0x2407fa(0x10a))var _0xf72fa4=users['French'];else{if(_0x2a940a[0x0][_0x2407fa(0x16d)]==_0x2407fa(0x1c7))var _0xf72fa4=users[_0x2407fa(0x1e1)];else{if(_0x2a940a[0x0][_0x2407fa(0x16d)]==_0x2407fa(0xe9))var _0xf72fa4=users['Chinese'];else{if(_0x2a940a[0x0][_0x2407fa(0x16d)]=='Arabic\x20(ae)')var _0xf72fa4=users[_0x2407fa(0x154)];}}}}}}}const _0x15443c=getRandom8DigitNumber();_0x15443c[_0x2407fa(0xcc)](_0x57efd3=>{var _0xace305=_0x2407fa;_0x3d3f4d[_0xace305(0x18f)](_0xace305(0x18d),{'success':_0x29991e[_0xace305(0x1ba)](_0xace305(0x117)),'errors':_0x29991e['flash'](_0xace305(0x1a9)),'role':_0x407067,'profile':_0x172497,'customer':_0x1f5402,'warehouse':_0x551bd0,'product':_0x17987a,'invoice':_0x57efd3,'master_shop':_0x2a940a,'language':_0xf72fa4,'rooms_data':_0x4e94bb});})[_0x2407fa(0x122)](_0x22db6c=>{var _0x130dd2=_0x2407fa;_0x29991e[_0x130dd2(0x1ba)](_0x130dd2(0x1a9),_0x130dd2(0x1a3)),_0x3d3f4d[_0x130dd2(0x1e3)](_0x130dd2(0xfe));});}catch(_0x51c5f5){console[_0x2407fa(0xe8)](_0x51c5f5);}}),router[a0_0x47c58f(0x165)](a0_0x47c58f(0x101),auth,async(_0x171fc1,_0x5c0580)=>{var _0x50fcbf=a0_0x47c58f;try{const _0x1cc375=_0x171fc1[_0x50fcbf(0x1df)]['id'];console[_0x50fcbf(0xe8)](_0x1cc375);const _0x2ab065=await product['find'](),_0xa967c7=await purchases[_0x50fcbf(0x19d)]([{'$match':{'warehouse_name':_0x1cc375}},{'$unwind':'$product'},{'$group':{'_id':_0x50fcbf(0x1d2)}}]);console[_0x50fcbf(0xe8)](_0x50fcbf(0x145),_0xa967c7),_0x5c0580[_0x50fcbf(0x152)](0xc8)[_0x50fcbf(0x18a)]({'purchases_data':_0xa967c7,'product_data':_0x2ab065});}catch(_0x313d4c){console[_0x50fcbf(0xe8)](_0x313d4c);}}),router[a0_0x47c58f(0x190)](a0_0x47c58f(0x159),auth,async(_0x2d6b83,_0x9b4852)=>{var _0x1b7a1e=a0_0x47c58f;try{const {warehouse_data:_0x2bca98,product_data:_0x261774}=_0x2d6b83[_0x1b7a1e(0x1d7)];console[_0x1b7a1e(0xe8)](_0x2d6b83[_0x1b7a1e(0x1d7)][_0x1b7a1e(0x1c3)]);;const _0x1761ad=await master_shop[_0x1b7a1e(0x14b)]();console[_0x1b7a1e(0xe8)](_0x1b7a1e(0xd7),_0x1761ad);const _0x5d7cdf=await product[_0x1b7a1e(0x1c9)]({'name':_0x261774});console[_0x1b7a1e(0xe8)](_0x1b7a1e(0x19c),_0x5d7cdf);const _0x1bd740=await warehouse['aggregate']([{'$match':{'name':_0x2bca98}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x261774}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x1b7a1e(0x166)}}}]);console[_0x1b7a1e(0xe8)]('stock_data',_0x1bd740),_0x9b4852[_0x1b7a1e(0x152)](0xc8)['json']({'master':_0x1761ad,'new_product':_0x5d7cdf,'stock_data':_0x1bd740});}catch(_0x216b50){console[_0x1b7a1e(0xe8)](_0x216b50);}}),router['post']('/view/add_sales',auth,async(_0x486f34,_0xc99fee)=>{var _0x3fbb79=a0_0x47c58f;try{const {invoice:_0x1ceebf,date:_0x30a490,warehouse_name:_0x69f64b,product_name:_0x23cdab,stock:_0xa54f5f,quantity:_0x292736,note:_0x1583fa,room:_0x56bc0d,primary_code:_0x4ad4b4,secondary_code:_0x2cc66a,prod_code:_0x4ad6a9,level:_0x3139f6,isle:_0x5b303d,pallet:_0xd46d4e,batch_code:_0x834b5f,SCRN:_0x36d0c0,expiry_date:_0x59fecf,mode_transpo:_0x9a69f3,name_driver:_0x556eec}=_0x486f34['body'];if(typeof _0x23cdab==_0x3fbb79(0x1e2))var _0x2165a1=[_0x486f34['body'][_0x3fbb79(0x1be)]],_0x527f33=[_0x486f34['body'][_0x3fbb79(0x133)]],_0x3ec7d3=[_0x486f34[_0x3fbb79(0x1d7)]['carton']],_0x211625=[_0x486f34[_0x3fbb79(0x1d7)]['primary_code']],_0x33b791=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x197)]],_0x297ba3=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x181)]],_0x4cc97e=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x158)]],_0x579c8c=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x160)]],_0x54d2a8=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x187)]],_0x2c3308=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x18e)]],_0x3a1434=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x183)]],_0x3b904c=[_0x486f34['body'][_0x3fbb79(0x124)]],_0x401513=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0xca)]],_0x1b3b8d=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x1dc)]],_0x2d404b=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x12b)]],_0x3b8edd=[_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x114)]],_0x414f9e=[_0x486f34['body']['id_transaction_from']];else var _0x2165a1=[..._0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x1be)]],_0x527f33=[..._0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x133)]],_0x3ec7d3=[..._0x486f34['body'][_0x3fbb79(0xee)]],_0x211625=[..._0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0xd9)]],_0x33b791=[..._0x486f34['body'][_0x3fbb79(0x197)]],_0x297ba3=[..._0x486f34['body'][_0x3fbb79(0x181)]],_0x4cc97e=[..._0x486f34['body'][_0x3fbb79(0x158)]],_0x579c8c=[..._0x486f34[_0x3fbb79(0x1d7)]['primary_unit']],_0x54d2a8=[..._0x486f34['body'][_0x3fbb79(0x187)]],_0x2c3308=[..._0x486f34['body'][_0x3fbb79(0x18e)]],_0x3a1434=[..._0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x183)]],_0x3b904c=[..._0x486f34['body'][_0x3fbb79(0x124)]],_0x401513=[..._0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0xca)]],_0x1b3b8d=[..._0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x1dc)]],_0x2d404b=[..._0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0x12b)]],_0x3b8edd=[..._0x486f34[_0x3fbb79(0x1d7)]['prod_invoice']],_0x414f9e=[..._0x486f34['body']['id_transaction_from']];const _0x4741fe=_0x2165a1[_0x3fbb79(0xf8)](_0x3c2164=>{return _0x3c2164={'product_name':_0x3c2164};});_0x527f33[_0x3fbb79(0x16b)]((_0x25e910,_0x4580f8)=>{var _0x40b69f=_0x3fbb79;_0x4741fe[_0x4580f8][_0x40b69f(0x133)]=_0x25e910;}),_0x3ec7d3[_0x3fbb79(0x16b)]((_0xd07648,_0x43b2ea)=>{var _0x160703=_0x3fbb79;_0x4741fe[_0x43b2ea]['quantity']=Math[_0x160703(0x137)](_0xd07648);}),_0x414f9e['forEach']((_0x17be84,_0x180a85)=>{var _0x3e9c9c=_0x3fbb79;_0x4741fe[_0x180a85][_0x3e9c9c(0x1d0)]=_0x17be84;}),_0x211625[_0x3fbb79(0x16b)]((_0x592cb3,_0x1a1962)=>{var _0x5ef497=_0x3fbb79;_0x4741fe[_0x1a1962][_0x5ef497(0xd9)]=_0x592cb3;}),_0x33b791['forEach']((_0x17b19c,_0x1d045a)=>{var _0x4c7c34=_0x3fbb79;_0x4741fe[_0x1d045a][_0x4c7c34(0x197)]=_0x17b19c;}),_0x297ba3['forEach']((_0x2e83a0,_0x44bfd3)=>{var _0x12c5a9=_0x3fbb79;_0x4741fe[_0x44bfd3][_0x12c5a9(0x17b)]=_0x2e83a0;}),_0x4cc97e[_0x3fbb79(0x16b)]((_0x1c25f3,_0x44f8a6)=>{var _0x4f8589=_0x3fbb79;_0x4741fe[_0x44f8a6][_0x4f8589(0x193)]=_0x1c25f3;}),_0x579c8c[_0x3fbb79(0x16b)]((_0x4f8935,_0xa2471d)=>{var _0x3b42d5=_0x3fbb79;_0x4741fe[_0xa2471d][_0x3b42d5(0x144)]=_0x4f8935;}),_0x54d2a8[_0x3fbb79(0x16b)]((_0x23d415,_0x2013a1)=>{var _0x2ee0ad=_0x3fbb79;_0x4741fe[_0x2013a1][_0x2ee0ad(0x187)]=_0x23d415;}),_0x2c3308['forEach']((_0xa8703e,_0x1ddd46)=>{_0x4741fe[_0x1ddd46]['batch_code']=_0xa8703e;}),_0x3a1434['forEach']((_0x3c94fd,_0x27d08f)=>{_0x4741fe[_0x27d08f]['expiry_date']=_0x3c94fd;}),_0x3b904c[_0x3fbb79(0x16b)]((_0x37eb9f,_0x2fddc9)=>{var _0x1acf2b=_0x3fbb79;_0x4741fe[_0x2fddc9][_0x1acf2b(0x1ac)]=_0x37eb9f;}),_0x401513[_0x3fbb79(0x16b)]((_0x5ae193,_0x5957f2)=>{var _0x1ea111=_0x3fbb79;_0x4741fe[_0x5957f2][_0x1ea111(0x18b)]=_0x5ae193;}),_0x1b3b8d[_0x3fbb79(0x16b)]((_0x1d64b2,_0x1abc97)=>{var _0x32660d=_0x3fbb79;_0x4741fe[_0x1abc97][_0x32660d(0x1dc)]=_0x1d64b2;}),_0x2d404b[_0x3fbb79(0x16b)]((_0x1aabad,_0x3f63a9)=>{var _0x14bbcd=_0x3fbb79;_0x4741fe[_0x3f63a9][_0x14bbcd(0xc9)]=_0x1aabad;}),_0x3b8edd['forEach']((_0xe0511a,_0x28fd2a)=>{var _0x3755a9=_0x3fbb79;_0x4741fe[_0x28fd2a][_0x3755a9(0x1e5)]=_0xe0511a;});var _0x16e9d4=0x0;_0x4741fe['forEach'](_0x144d28=>{var _0x1e083a=_0x3fbb79;parseFloat(_0x144d28[_0x1e083a(0x133)])<parseFloat(_0x144d28[_0x1e083a(0x196)])&&parseFloat(_0x144d28[_0x1e083a(0x196)])>parseFloat(_0x144d28[_0x1e083a(0x133)])&&(console['log'](_0x144d28[_0x1e083a(0x133)]+'\x20<>\x20'+_0x144d28['quantity']),_0x16e9d4++);});if(_0x16e9d4!=0x0)return _0x486f34['flash'](_0x3fbb79(0x1a9),_0x3fbb79(0x140)),_0xc99fee[_0x3fbb79(0x1e3)]('back');const _0x47a693=_0x4741fe[_0x3fbb79(0x15b)](_0x241243=>_0x241243[_0x3fbb79(0x196)]!=='0'&&_0x241243[_0x3fbb79(0x196)]!==''),_0x451be3=new sales_finished({'invoice':_0x1ceebf,'customer':_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0xdd)],'date':_0x30a490,'warehouse_name':_0x69f64b,'sale_product':_0x47a693,'note':_0x1583fa,'room':_0x56bc0d,'primary_code':_0x4ad4b4,'secondary_code':_0x2cc66a,'prod_code':_0x4ad6a9,'SCRN':_0x36d0c0,'finalize':_0x3fbb79(0x1d4),'mode_transpo':_0x9a69f3,'name_driver':_0x556eec}),_0x1f7b79=await _0x451be3[_0x3fbb79(0x132)](),_0x99abe3=await sales_finished[_0x3fbb79(0x1c9)]({'invoice':_0x1ceebf}),_0x23cb5b=new c_payment_data({'invoice':_0x1ceebf,'customer':_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0xdd)],'reason':_0x3fbb79(0x11b)});await _0x23cb5b[_0x3fbb79(0x132)]();const _0x34874e=await master_shop[_0x3fbb79(0x14b)](),_0x54e880=await email_settings[_0x3fbb79(0x1c9)](),_0x312fc7=await customer[_0x3fbb79(0x1c9)]({'name':_0x486f34[_0x3fbb79(0x1d7)][_0x3fbb79(0xdd)]});_0x34874e[0x0][_0x3fbb79(0x10f)]==0x1?(right_currency=_0x34874e[0x0][_0x3fbb79(0xd0)],left_currency=''):(right_currency='',left_currency=_0x34874e[0x0]['currency']);var _0x5f0936=_0x2165a1,_0x48cab0=_0x3ec7d3,_0x346161='',_0x5e558b;for(_0x5e558b in _0x5f0936){_0x346161+=_0x3fbb79(0xf9)+_0x3fbb79(0xf1)+_0x5f0936[_0x5e558b]+'</td>'+_0x3fbb79(0xf1)+_0x48cab0[_0x5e558b]+_0x3fbb79(0x1a0)+_0x3fbb79(0x111);}console[_0x3fbb79(0xe8)](_0x3fbb79(0x10b),_0x346161);let _0x2b3d18=nodemailer[_0x3fbb79(0xd6)]({'host':_0x54e880['host'],'port':Number(_0x54e880[_0x3fbb79(0x138)]),'secure':![],'service':_0x3fbb79(0x186),'auth':{'user':_0x54e880['email'],'pass':_0x54e880['password']}}),_0x5b0e08={'from':_0x54e880['email'],'to':'christian.villamer@jakagroup.com','subject':_0x3fbb79(0x1b9),'attachments':[{'filename':'Logo.png','path':__dirname+_0x3fbb79(0x17d)+_0x3fbb79(0x119)+_0x34874e[0x0][_0x3fbb79(0x1aa)],'cid':_0x3fbb79(0x1bb)}],'html':_0x3fbb79(0x194)};_0x2b3d18[_0x3fbb79(0xf4)](_0x5b0e08,function(_0x409a01,_0x18384e){var _0x49b548=_0x3fbb79;_0x409a01?(console[_0x49b548(0xe8)](_0x409a01),console['log'](_0x49b548(0x1c0))):console[_0x49b548(0xe8)](_0x49b548(0x107));}),_0x486f34[_0x3fbb79(0x1ba)]('success',_0x3fbb79(0x135)),_0xc99fee[_0x3fbb79(0x1e3)](_0x3fbb79(0xf7)+_0x1f7b79['_id']);}catch(_0x588770){console[_0x3fbb79(0xe8)](_0x588770);}}),router[a0_0x47c58f(0x165)]('/preview/:id',auth,async(_0x4f470e,_0x213b82)=>{var _0x4e0fa9=a0_0x47c58f;try{const {username:_0x82bc2,email:_0x2807fe,role:_0x5dea54}=_0x4f470e['user'],_0x2c3054=_0x4f470e[_0x4e0fa9(0xde)],_0x4961b9=await profile[_0x4e0fa9(0x1c9)]({'email':_0x2c3054['email']}),_0x2bdd21=await master_shop[_0x4e0fa9(0x14b)](),_0x571172=_0x4f470e[_0x4e0fa9(0x1df)]['id'],_0x236b65=await sales_finished[_0x4e0fa9(0x156)](_0x571172),_0x5d9106=await warehouse[_0x4e0fa9(0x19d)]([{'$match':{'name':_0x236b65['warehouse_name']}},{'$unwind':_0x4e0fa9(0x1da)},{'$group':{'_id':_0x4e0fa9(0x142),'name':{'$first':_0x4e0fa9(0x168)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4e0fa9(0x1a6)},'bin':{'$first':_0x4e0fa9(0x13a)},'type':{'$first':_0x4e0fa9(0x14f)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x4e0fa9(0xe2)},'secondary_code':{'$first':_0x4e0fa9(0x19b)},'product_code':{'$first':_0x4e0fa9(0x13f)},'storage':{'$first':_0x4e0fa9(0x1af)},'rack':{'$first':_0x4e0fa9(0xea)},'expiry_date':{'$first':_0x4e0fa9(0x1a5)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x4e0fa9(0x118)},'room':{'$first':'$room'},'room_data':{'$first':_0x4e0fa9(0x169)}}}]),_0x18d200=await customer[_0x4e0fa9(0x14b)]({});let _0x3cc1dd;if(_0x2c3054[_0x4e0fa9(0x1c1)]==_0x4e0fa9(0x102)){const _0x2ad285=await staff['findOne']({'email':_0x2c3054['email']});_0x3cc1dd=await warehouse[_0x4e0fa9(0x19d)]([{'$match':{'status':'Enabled','name':_0x2ad285['warehouse']}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x3cc1dd=await warehouse[_0x4e0fa9(0x19d)]([{'$match':{'status':_0x4e0fa9(0x1d9)}},{'$group':{'_id':_0x4e0fa9(0x14e),'name':{'$first':_0x4e0fa9(0x14e)}}}]);const _0x185515=await product[_0x4e0fa9(0x14b)]({});if(_0x2bdd21[0x0][_0x4e0fa9(0x16d)]==_0x4e0fa9(0x1c6)){var _0x5c4fb0=users['English'];console['log'](_0x5c4fb0);}else{if(_0x2bdd21[0x0][_0x4e0fa9(0x16d)]==_0x4e0fa9(0xfc))var _0x5c4fb0=users['Hindi'];else{if(_0x2bdd21[0x0][_0x4e0fa9(0x16d)]==_0x4e0fa9(0x126))var _0x5c4fb0=users[_0x4e0fa9(0x126)];else{if(_0x2bdd21[0x0][_0x4e0fa9(0x16d)]==_0x4e0fa9(0x104))var _0x5c4fb0=users[_0x4e0fa9(0x104)];else{if(_0x2bdd21[0x0][_0x4e0fa9(0x16d)]==_0x4e0fa9(0x10a))var _0x5c4fb0=users['French'];else{if(_0x2bdd21[0x0][_0x4e0fa9(0x16d)]=='Portuguese\x20(BR)')var _0x5c4fb0=users[_0x4e0fa9(0x1e1)];else{if(_0x2bdd21[0x0][_0x4e0fa9(0x16d)]=='Chinese')var _0x5c4fb0=users[_0x4e0fa9(0xe9)];else{if(_0x2bdd21[0x0]['language']==_0x4e0fa9(0x1cd))var _0x5c4fb0=users[_0x4e0fa9(0x154)];}}}}}}}_0x213b82[_0x4e0fa9(0x18f)](_0x4e0fa9(0x12a),{'success':_0x4f470e['flash'](_0x4e0fa9(0x117)),'errors':_0x4f470e[_0x4e0fa9(0x1ba)](_0x4e0fa9(0x1a9)),'role':_0x2c3054,'profile':_0x4961b9,'customer':_0x18d200,'warehouse':_0x3cc1dd,'product':_0x5d9106,'user':_0x236b65,'master_shop':_0x2bdd21,'unit':_0x185515,'language':_0x5c4fb0});}catch(_0x42ec9e){console['log'](_0x42ec9e);}}),router[a0_0x47c58f(0x190)](a0_0x47c58f(0x163),auth,async(_0x1a05f7,_0xc282e0)=>{var _0x49ec6e=a0_0x47c58f;try{const _0x4b779e=_0x1a05f7[_0x49ec6e(0x1df)]['id'],{invoice:_0x2a25e6,warehouse_name:_0x410a26,room:_0xf2c0ae}=_0x1a05f7[_0x49ec6e(0x1d7)],_0x1ea6ea=await sales_finished[_0x49ec6e(0x1c9)]({'invoice':_0x2a25e6}),_0x2a4168=_0x1ea6ea[_0x49ec6e(0x18c)]['map'](async _0x40ff0c=>{var _0x51b6a6=_0x49ec6e,_0xd922b7=await warehouse[_0x51b6a6(0x1c9)]({'name':_0x410a26,'room':_0x40ff0c[_0x51b6a6(0xc9)],'warehouse_category':_0x51b6a6(0xe1)});const _0x59ce1f=_0xd922b7[_0x51b6a6(0x1ad)][_0x51b6a6(0xf8)](_0x36cd6c=>{var _0x10dea0=_0x51b6a6;_0x36cd6c[_0x10dea0(0x1be)]==_0x40ff0c[_0x10dea0(0x1be)]&&_0x36cd6c['bay']==_0x40ff0c[_0x10dea0(0x193)]&&_0x36cd6c['expiry_date']==_0x40ff0c['expiry_date']&&_0x36cd6c[_0x10dea0(0x1ac)]==_0x40ff0c['production_date']&&_0x36cd6c[_0x10dea0(0x18e)]==_0x40ff0c[_0x10dea0(0x18e)]&&_0x36cd6c[_0x10dea0(0x110)]==_0x40ff0c['id_transaction_from']&&(_0x36cd6c['product_stock']>0x0&&(console[_0x10dea0(0xe8)](_0x36cd6c[_0x10dea0(0x1be)]+_0x10dea0(0x10c)+_0x40ff0c[_0x10dea0(0x1be)]+_0x10dea0(0x1d5)+_0x36cd6c[_0x10dea0(0x193)]+'\x20==\x20'+_0x40ff0c[_0x10dea0(0x193)]+_0x10dea0(0x1d5)+_0x36cd6c[_0x10dea0(0x1ac)]+'\x20==\x20'+_0x40ff0c[_0x10dea0(0x1ac)]+_0x10dea0(0x1d5)+_0x36cd6c[_0x10dea0(0x183)]+_0x10dea0(0x10c)+_0x40ff0c[_0x10dea0(0x183)]+'\x20&&\x20'+_0x36cd6c[_0x10dea0(0x18e)]+_0x10dea0(0x10c)+_0x40ff0c[_0x10dea0(0x18e)]+_0x10dea0(0x1d5)+_0x36cd6c['invoice']+_0x10dea0(0x10c)+_0x40ff0c[_0x10dea0(0x1e5)]+_0x10dea0(0x1d5)+_0x36cd6c[_0x10dea0(0xeb)]+_0x10dea0(0x103)+_0x40ff0c[_0x10dea0(0x196)]+_0x10dea0(0xc8)+_0x40ff0c[_0x10dea0(0xc9)]+_0x10dea0(0x1d5)+_0x36cd6c['_id']+'\x20==\x20'+_0x40ff0c[_0x10dea0(0x1d0)]),_0x36cd6c[_0x10dea0(0xeb)]=Math[_0x10dea0(0xdf)](0x0,Math['abs'](_0x36cd6c[_0x10dea0(0xeb)])-Math[_0x10dea0(0x137)](_0x40ff0c[_0x10dea0(0x196)]))));});return _0xd922b7;});Promise[_0x49ec6e(0xf0)](_0x2a4168)[_0x49ec6e(0xcc)](async _0x1424f9=>{var _0x509323=_0x49ec6e;try{for(const _0x85ebb0 of _0x1424f9){await _0x85ebb0[_0x509323(0x132)]();}_0x1ea6ea[_0x509323(0x1e8)]=_0x509323(0xdb);const _0x57f05d=await _0x1ea6ea['save'](),_0x23422b=await master_shop[_0x509323(0x14b)](),_0x517452=await email_settings[_0x509323(0x1c9)](),_0x4604ce=await supervisor_settings[_0x509323(0x14b)]();var _0xf7125d=_0x1ea6ea[_0x509323(0x18c)],_0x4d3a9d='',_0x5b990b;for(_0x5b990b in _0xf7125d){var _0x2b9818='FG';_0x1ea6ea[_0x509323(0x125)]==_0x509323(0x15a)&&(_0x2b9818='DG'),_0x4d3a9d+=_0x509323(0xf9)+_0x509323(0xf1)+_0xf7125d[_0x5b990b]['product_name']+_0x509323(0x1a0)+_0x509323(0xf1)+_0xf7125d[_0x5b990b]['product_code']+'</td>'+_0x509323(0xf1)+_0xf7125d[_0x5b990b][_0x509323(0x196)]+_0x509323(0x1a0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xf7125d[_0x5b990b]['unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xf7125d[_0x5b990b][_0x509323(0x187)]+_0x509323(0x1a0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1ea6ea[_0x509323(0x125)]+_0x509323(0x1a0)+_0x509323(0xf1)+_0xf7125d[_0x5b990b]['room_name']+_0x509323(0x1a0)+_0x509323(0xf1)+_0x2b9818+_0xf7125d[_0x5b990b]['bay']+'</td>';}let _0xb7e020=nodemailer[_0x509323(0xd6)]({'host':_0x517452[_0x509323(0x11c)],'port':Number(_0x517452[_0x509323(0x138)]),'secure':![],'auth':{'user':_0x517452[_0x509323(0x13c)],'pass':_0x517452[_0x509323(0x11a)]}}),_0xc0b39c={'from':_0x517452[_0x509323(0x13c)],'to':_0x4604ce[0x0][_0x509323(0x1ce)],'subject':'Sales\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x509323(0x17d)+_0x509323(0x119)+_0x23422b[0x0][_0x509323(0x1aa)],'cid':_0x509323(0x1bb)}],'html':'<!DOCTYPE\x20html>'+_0x509323(0x1bc)+_0x509323(0x12e)+_0x509323(0x1a7)+_0x509323(0x116)+_0x509323(0x1a7)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x509323(0x182)+_0x509323(0x1a7)+_0x509323(0x179)+_0x23422b[0x0]['site_title']+_0x509323(0x17c)+_0x509323(0x182)+_0x509323(0x182)+_0x509323(0x112)+_0x509323(0x1a7)+_0x509323(0x161)+_0x509323(0x1de)+_0x1ea6ea['invoice']+'\x20'+_0x509323(0x1ae)+_0x509323(0x191)+_0x1ea6ea[_0x509323(0x1e9)]+'\x20'+_0x509323(0x174)+'</h5>'+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x509323(0xd5)+'<tr>'+_0x509323(0x134)+_0x509323(0xe0)+_0x509323(0xce)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x509323(0x1b7)+_0x509323(0xd3)+_0x509323(0xdc)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x509323(0x111)+'</thead>'+_0x509323(0x11e)+'\x20'+_0x4d3a9d+'\x20'+_0x509323(0x15c)+'</table>'+'<div>'+_0x509323(0x100)+_0x509323(0xfa)+_0x23422b[0x0][_0x509323(0x1d1)]+'</h5>'+_0x509323(0x182)+_0x509323(0x182)+'</body></html>'};_0xb7e020[_0x509323(0xf4)](_0xc0b39c,function(_0xe95027,_0xc189e4){var _0x45feff=_0x509323;_0xe95027?(console[_0x45feff(0xe8)](_0xe95027),console[_0x45feff(0xe8)]('Error\x20Occurs')):console[_0x45feff(0xe8)](_0x45feff(0x107));}),_0x1a05f7[_0x509323(0x1ba)](_0x509323(0x117),_0x509323(0xf2)),_0xc282e0[_0x509323(0x1e3)](_0x509323(0xf3)+_0x4b779e);}catch(_0x2f1e28){console[_0x509323(0xd4)](_0x2f1e28),_0xc282e0[_0x509323(0x152)](0x1f4)['json']({'error':_0x509323(0x130)});}})[_0x49ec6e(0x122)](_0x3ce895=>{var _0x8ec0c0=_0x49ec6e;console[_0x8ec0c0(0xd4)](_0x3ce895),_0xc282e0[_0x8ec0c0(0x152)](0x1f4)['json']({'error':_0x8ec0c0(0x1e4)});});}catch(_0x162e91){console['log'](_0x162e91);}}),router['get'](a0_0x47c58f(0x123),auth,async(_0x4e747c,_0x8d4651)=>{var _0x5ecb1c=a0_0x47c58f;try{const {username:_0x1abe2b,email:_0x364c39,role:_0x208dbc}=_0x4e747c[_0x5ecb1c(0xde)],_0x11424c=_0x4e747c[_0x5ecb1c(0xde)],_0x275542=await profile[_0x5ecb1c(0x1c9)]({'email':_0x11424c[_0x5ecb1c(0x13c)]}),_0x394fa0=await master_shop['find'](),_0x2e4030=_0x4e747c['params']['id'],_0x47a026=await sales_finished[_0x5ecb1c(0x156)](_0x2e4030);let _0x250a9d=new Date(_0x47a026['expiry_date']),_0x4a83f2=('0'+_0x250a9d[_0x5ecb1c(0x185)]())[_0x5ecb1c(0x1e7)](-0x2),_0x13e1a5=('0'+(_0x250a9d[_0x5ecb1c(0x109)]()+0x1))[_0x5ecb1c(0x1e7)](-0x2),_0x2b1861=_0x250a9d['getFullYear'](),_0x42d90e=_0x2b1861+'-'+_0x13e1a5+'-'+_0x4a83f2;var _0x4acb20=[_0x5ecb1c(0xe6),_0x5ecb1c(0x17e)];const _0x2891ac=await warehouse[_0x5ecb1c(0x19d)]([{'$match':{'name':_0x47a026[_0x5ecb1c(0x125)],'room':_0x47a026[_0x5ecb1c(0x150)]}},{'$unwind':_0x5ecb1c(0x1da)},{'$group':{'_id':_0x5ecb1c(0x142),'name':{'$first':_0x5ecb1c(0x168)},'product_stock':{'$first':_0x5ecb1c(0x166)},'bay':{'$first':_0x5ecb1c(0x1a6)},'bin':{'$first':_0x5ecb1c(0x13a)},'type':{'$first':_0x5ecb1c(0x14f)},'floorlevel':{'$first':_0x5ecb1c(0x105)},'primary_code':{'$first':_0x5ecb1c(0xe2)},'secondary_code':{'$first':_0x5ecb1c(0x19b)},'product_code':{'$first':_0x5ecb1c(0x13f)},'storage':{'$first':_0x5ecb1c(0x1af)},'rack':{'$first':_0x5ecb1c(0xea)}}}]),_0x4f52e1=await customer['find']({});let _0x24fae2;if(_0x11424c[_0x5ecb1c(0x1c1)]=='staff'){const _0x5e045f=await staff[_0x5ecb1c(0x1c9)]({'email':_0x11424c[_0x5ecb1c(0x13c)]});_0x24fae2=await warehouse[_0x5ecb1c(0x19d)]([{'$match':{'status':_0x5ecb1c(0x1d9),'name':_0x5e045f[_0x5ecb1c(0x136)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x24fae2=await warehouse['aggregate']([{'$match':{'status':_0x5ecb1c(0x1d9)}},{'$group':{'_id':_0x5ecb1c(0x14e),'name':{'$first':_0x5ecb1c(0x14e)}}}]);const _0x5accaf=await product['find']({});if(_0x394fa0[0x0]['language']==_0x5ecb1c(0x1c6)){var _0x3a5c6d=users['English'];console['log'](_0x3a5c6d);}else{if(_0x394fa0[0x0][_0x5ecb1c(0x16d)]=='Hindi')var _0x3a5c6d=users[_0x5ecb1c(0xfc)];else{if(_0x394fa0[0x0][_0x5ecb1c(0x16d)]==_0x5ecb1c(0x126))var _0x3a5c6d=users[_0x5ecb1c(0x126)];else{if(_0x394fa0[0x0]['language']==_0x5ecb1c(0x104))var _0x3a5c6d=users[_0x5ecb1c(0x104)];else{if(_0x394fa0[0x0][_0x5ecb1c(0x16d)]==_0x5ecb1c(0x10a))var _0x3a5c6d=users[_0x5ecb1c(0x10a)];else{if(_0x394fa0[0x0][_0x5ecb1c(0x16d)]==_0x5ecb1c(0x1c7))var _0x3a5c6d=users['Portuguese'];else{if(_0x394fa0[0x0]['language']==_0x5ecb1c(0xe9))var _0x3a5c6d=users[_0x5ecb1c(0xe9)];else{if(_0x394fa0[0x0][_0x5ecb1c(0x16d)]==_0x5ecb1c(0x1cd))var _0x3a5c6d=users['Arabic'];}}}}}}}_0x8d4651[_0x5ecb1c(0x18f)](_0x5ecb1c(0x13e),{'success':_0x4e747c[_0x5ecb1c(0x1ba)](_0x5ecb1c(0x117)),'errors':_0x4e747c[_0x5ecb1c(0x1ba)](_0x5ecb1c(0x1a9)),'role':_0x11424c,'profile':_0x275542,'customer':_0x4f52e1,'warehouse':_0x24fae2,'product':_0x2891ac,'user':_0x47a026,'master_shop':_0x394fa0,'unit':_0x5accaf,'language':_0x3a5c6d,'rooms_data':_0x4acb20,'ed_fullDate':_0x42d90e});}catch(_0x2b2d15){console[_0x5ecb1c(0xe8)](_0x2b2d15);}}),router['post'](a0_0x47c58f(0x123),auth,async(_0x21531a,_0x463a4c)=>{var _0xccaf86=a0_0x47c58f;try{const _0x4b437e=_0x21531a[_0xccaf86(0x1df)]['id'],_0x5287b7=await sales_finished[_0xccaf86(0x1c9)]({'_id':_0x21531a[_0xccaf86(0x1df)]['id']}),_0x2ce8e8=await warehouse[_0xccaf86(0x1c9)]({'name':_0x5287b7['warehouse_name'],'room':_0x21531a[_0xccaf86(0x1d7)][_0xccaf86(0x150)],'warehouse_category':_0xccaf86(0xe1)}),{invoice:_0x2af7d9,customer:_0x2aa914,date:_0x392734,warehouse_name:_0x4162f8,product_name:_0x29171a,stock:_0x46c043,adjust_qty:_0x2fb26d,note:_0x1fa2d1,room:_0x1b62ae,primary_code:_0x11d537,secondary_code:_0x48473c,prod_code:_0x4590ce,level:_0x2db25f,isle:_0x48d582,pallet:_0x4e2d01,expiry_date:_0x925c25}=_0x21531a['body'];if(typeof _0x29171a==_0xccaf86(0x1e2))var _0x1ed9df=[_0x21531a['body']['product_name']],_0x373d22=[_0x21531a[_0xccaf86(0x1d7)][_0xccaf86(0x133)]],_0x2851da=[_0x21531a[_0xccaf86(0x1d7)][_0xccaf86(0x155)]],_0x494d8e=[_0x21531a[_0xccaf86(0x1d7)][_0xccaf86(0xd9)]],_0x43f6de=[_0x21531a[_0xccaf86(0x1d7)][_0xccaf86(0x197)]],_0x1959b0=[_0x21531a[_0xccaf86(0x1d7)]['prod_code']],_0x257429=[_0x21531a['body']['level']],_0x5e84b6=[_0x21531a['body'][_0xccaf86(0x183)]];else var _0x1ed9df=[..._0x21531a[_0xccaf86(0x1d7)][_0xccaf86(0x1be)]],_0x373d22=[..._0x21531a['body']['stock']],_0x2851da=[..._0x21531a['body'][_0xccaf86(0x155)]],_0x494d8e=[..._0x21531a['body'][_0xccaf86(0xd9)]],_0x43f6de=[..._0x21531a[_0xccaf86(0x1d7)]['secondary_code']],_0x1959b0=[..._0x21531a[_0xccaf86(0x1d7)][_0xccaf86(0x181)]],_0x257429=[..._0x21531a['body'][_0xccaf86(0x158)]],_0x5e84b6=[..._0x21531a['body'][_0xccaf86(0x183)]];const _0x270de8=_0x1ed9df[_0xccaf86(0xf8)](_0x3c163d=>{return _0x3c163d={'product_name':_0x3c163d};});_0x373d22['forEach']((_0x582f1c,_0x51d3f0)=>{var _0x38e8f2=_0xccaf86;_0x270de8[_0x51d3f0][_0x38e8f2(0x133)]=_0x582f1c;}),_0x2851da[_0xccaf86(0x16b)]((_0x18c5cb,_0x3c9667)=>{var _0x386aa6=_0xccaf86;_0x270de8[_0x3c9667][_0x386aa6(0x196)]=_0x18c5cb;}),_0x494d8e[_0xccaf86(0x16b)]((_0x107499,_0x47e19f)=>{var _0x1fd360=_0xccaf86;_0x270de8[_0x47e19f][_0x1fd360(0xd9)]=_0x107499;}),_0x43f6de[_0xccaf86(0x16b)]((_0x33dd96,_0x801ba3)=>{_0x270de8[_0x801ba3]['secondary_code']=_0x33dd96;}),_0x1959b0[_0xccaf86(0x16b)]((_0x225846,_0x5251df)=>{var _0x36c618=_0xccaf86;_0x270de8[_0x5251df][_0x36c618(0x17b)]=_0x225846;}),_0x257429[_0xccaf86(0x16b)]((_0x4dd476,_0x404c28)=>{_0x270de8[_0x404c28]['level']=_0x4dd476;}),_0x5e84b6[_0xccaf86(0x16b)]((_0x244c60,_0x462e6a)=>{_0x270de8[_0x462e6a]['expiry_date']=_0x244c60;});var _0x472b5c=0x0;_0x270de8[_0xccaf86(0x16b)](_0x137730=>{var _0x32548a=_0xccaf86;console[_0x32548a(0xe8)](_0x32548a(0x1cf),_0x137730),(parseInt(_0x137730[_0x32548a(0x133)])<parseInt(_0x137730[_0x32548a(0x196)])||parseInt(_0x137730[_0x32548a(0x196)])==0x0)&&_0x472b5c++;});if(_0x472b5c!=0x0)return _0x21531a[_0xccaf86(0x1ba)](_0xccaf86(0x1a9),_0xccaf86(0xfb)),_0x463a4c[_0xccaf86(0x1e3)](_0xccaf86(0x164));_0x5287b7[_0xccaf86(0x18c)]['forEach'](_0x16efad=>{var _0x1d9992=_0xccaf86;const _0x5208be=_0x2ce8e8[_0x1d9992(0x1ad)][_0x1d9992(0xf8)](_0x91b99e=>{var _0x18ee46=_0x1d9992;_0x91b99e['product_name']==_0x16efad[_0x18ee46(0x1be)]&&_0x91b99e['bay']==_0x16efad[_0x18ee46(0x193)]&&(_0x91b99e['product_stock']=parseInt(_0x91b99e[_0x18ee46(0xeb)])+parseInt(_0x16efad[_0x18ee46(0x196)]));});}),await _0x2ce8e8['save']();const _0x199cbe=_0x270de8[_0xccaf86(0x15b)](_0x2dc696=>_0x2dc696[_0xccaf86(0x196)]!=='0'&&_0x2dc696['quantity']!=='');_0x5287b7[_0xccaf86(0x1e5)]=_0x2af7d9,_0x5287b7[_0xccaf86(0xdd)]=_0x2aa914,_0x5287b7[_0xccaf86(0x1e9)]=_0x392734,_0x5287b7[_0xccaf86(0x125)]=_0x4162f8,_0x5287b7[_0xccaf86(0x18c)]=_0x199cbe,_0x5287b7[_0xccaf86(0x1c8)]=_0x1fa2d1,_0x5287b7['room']=_0x1b62ae;const _0x554e54=await _0x5287b7[_0xccaf86(0x132)](),_0x11ebd2=await sales_finished[_0xccaf86(0x1c9)]({'_id':_0x21531a[_0xccaf86(0x1df)]['id']}),_0x2545d7=await warehouse[_0xccaf86(0x1c9)]({'name':_0x4162f8,'room':_0x1b62ae,'warehouse_category':_0xccaf86(0xe1)});_0x11ebd2[_0xccaf86(0x18c)]['forEach'](_0x5a5480=>{var _0x4d2b5b=_0xccaf86;const _0x5efafc=_0x2545d7[_0x4d2b5b(0x1ad)]['map'](_0x54b0f2=>{var _0x299c03=_0x4d2b5b;_0x54b0f2[_0x299c03(0x1be)]==_0x5a5480[_0x299c03(0x1be)]&&_0x54b0f2[_0x299c03(0x193)]==_0x5a5480['bay']&&(_0x54b0f2['product_stock']=parseInt(_0x54b0f2['product_stock'])-parseInt(_0x5a5480[_0x299c03(0x196)]));});}),console[_0xccaf86(0xe8)](_0xccaf86(0x16a),_0x2545d7),await _0x2545d7[_0xccaf86(0x132)]();const _0x5c456b=await c_payment_data[_0xccaf86(0x1c9)]({'invoice':_0x21531a[_0xccaf86(0x1d7)]['invoice']});_0x5c456b[_0xccaf86(0x143)]=_0x21531a['body'][_0xccaf86(0x143)],await _0x5c456b[_0xccaf86(0x132)](),_0x21531a['flash'](_0xccaf86(0x117),_0xccaf86(0xf2)),_0x463a4c[_0xccaf86(0x1e3)](_0xccaf86(0xfe));}catch(_0x4dd0a2){console[_0xccaf86(0xe8)](_0x4dd0a2);}}),router[a0_0x47c58f(0x190)](a0_0x47c58f(0x176),auth,async(_0x44a285,_0x484a33)=>{var _0x1cee4e=a0_0x47c58f;try{const _0x39938b=_0x44a285['params']['id'],{invoice:_0x26ea38,customer:_0x415560,receivable_amount:_0x29d6a6,received_amount:_0x1bd486}=_0x44a285[_0x1cee4e(0x1d7)],_0x28bcde=await sales[_0x1cee4e(0x156)](_0x39938b);console['log'](_0x28bcde);var _0x5423e4=_0x29d6a6-_0x1bd486;console[_0x1cee4e(0xe8)](_0x1bd486),_0x28bcde[_0x1cee4e(0x1c2)]=parseFloat(_0x1bd486)+parseFloat(_0x28bcde['received_amount']),_0x28bcde[_0x1cee4e(0x162)]=_0x5423e4,console[_0x1cee4e(0xe8)](_0x28bcde);const _0x532f63=await _0x28bcde['save'](),_0x3044ea=await c_payment_data[_0x1cee4e(0x1c9)]({'invoice':_0x26ea38});_0x3044ea[_0x1cee4e(0x178)]=_0x5423e4,await _0x3044ea['save']();let _0x39e7df=new Date(),_0x17fa02=('0'+_0x39e7df[_0x1cee4e(0x185)]())[_0x1cee4e(0x1e7)](-0x2),_0x471d60=('0'+(_0x39e7df[_0x1cee4e(0x109)]()+0x1))[_0x1cee4e(0x1e7)](-0x2),_0x49ca9a=_0x39e7df[_0x1cee4e(0x1e0)](),_0x3d12f1=_0x49ca9a+'-'+_0x471d60+'-'+_0x17fa02;const _0x26ed0b=new customer_payment({'invoice':_0x26ea38,'date':_0x49ca9a+'-'+_0x471d60+'-'+_0x17fa02,'customer':_0x415560,'reason':_0x1cee4e(0xd8),'amount':_0x1bd486}),_0x5ee09a=await _0x26ed0b[_0x1cee4e(0x132)]();_0x44a285[_0x1cee4e(0x1ba)](_0x1cee4e(0x117),'payment\x20successfull'),_0x484a33['redirect'](_0x1cee4e(0x14a));}catch(_0x5372cd){console[_0x1cee4e(0xe8)](_0x5372cd);}}),router[a0_0x47c58f(0x165)](a0_0x47c58f(0x192),auth,async(_0x10e2bf,_0x577baf)=>{var _0x464c64=a0_0x47c58f;try{const {username:_0x2936e8,email:_0x46554c,role:_0x1205d8}=_0x10e2bf['user'],_0xc97204=_0x10e2bf[_0x464c64(0xde)],_0x4cb28b=await profile[_0x464c64(0x1c9)]({'email':_0xc97204[_0x464c64(0x13c)]}),_0x779cec=await master_shop[_0x464c64(0x14b)]();console['log'](_0x464c64(0xd7),_0x779cec);const _0x314597=_0x10e2bf['params']['id'],_0x3b0e8e=await sales[_0x464c64(0x156)](_0x314597);console['log'](_0x3b0e8e);const _0x18822d=await customer['findOne']({'name':_0x3b0e8e[_0x464c64(0xdd)]});console[_0x464c64(0xe8)](_0x18822d);if(_0x779cec[0x0]['language']==_0x464c64(0x1c6)){var _0x35bff4=users[_0x464c64(0x16f)];console['log'](_0x35bff4);}else{if(_0x779cec[0x0][_0x464c64(0x16d)]==_0x464c64(0xfc))var _0x35bff4=users[_0x464c64(0xfc)];else{if(_0x779cec[0x0][_0x464c64(0x16d)]==_0x464c64(0x126))var _0x35bff4=users[_0x464c64(0x126)];else{if(_0x779cec[0x0]['language']==_0x464c64(0x104))var _0x35bff4=users[_0x464c64(0x104)];else{if(_0x779cec[0x0]['language']==_0x464c64(0x10a))var _0x35bff4=users[_0x464c64(0x10a)];else{if(_0x779cec[0x0][_0x464c64(0x16d)]==_0x464c64(0x1c7))var _0x35bff4=users[_0x464c64(0x1e1)];else{if(_0x779cec[0x0][_0x464c64(0x16d)]==_0x464c64(0xe9))var _0x35bff4=users[_0x464c64(0xe9)];else{if(_0x779cec[0x0][_0x464c64(0x16d)]=='Arabic\x20(ae)')var _0x35bff4=users[_0x464c64(0x154)];}}}}}}}_0x577baf[_0x464c64(0x18f)](_0x464c64(0xef),{'success':_0x10e2bf[_0x464c64(0x1ba)]('success'),'errors':_0x10e2bf[_0x464c64(0x1ba)]('errors'),'role':_0xc97204,'profile':_0x4cb28b,'master_shop':_0x779cec,'customers':_0x18822d,'sales':_0x3b0e8e,'language':_0x35bff4});}catch(_0x10a7ec){console[_0x464c64(0xe8)](_0x10a7ec);}}),router['get']('/view/return_sales/:id',auth,async(_0x446540,_0x1fe0e7)=>{var _0x19c5de=a0_0x47c58f;try{const {username:_0x5ec7f9,email:_0x27442f,role:_0x24a4c7}=_0x446540[_0x19c5de(0xde)],_0x41e866=_0x446540[_0x19c5de(0xde)],_0x50d529=await profile['findOne']({'email':_0x41e866[_0x19c5de(0x13c)]}),_0x297dd5=await master_shop[_0x19c5de(0x14b)](),_0x1ff849=_0x446540[_0x19c5de(0x1df)]['id'],_0x3d1e78=await sales_finished[_0x19c5de(0x156)](_0x1ff849),_0x43b83c=await warehouse['aggregate']([{'$match':{'name':_0x3d1e78[_0x19c5de(0x125)]}},{'$unwind':_0x19c5de(0x1da)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x19c5de(0x168)},'product_stock':{'$first':_0x19c5de(0x166)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x19c5de(0x13a)},'type':{'$first':_0x19c5de(0x14f)},'floorlevel':{'$first':_0x19c5de(0x105)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x19c5de(0x19b)},'product_code':{'$first':_0x19c5de(0x13f)},'storage':{'$first':_0x19c5de(0x1af)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x19c5de(0x1b6)},'unit':{'$first':_0x19c5de(0xda)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x19c5de(0x198)},'batch_code':{'$first':_0x19c5de(0x118)},'maxPerUnit':{'$first':_0x19c5de(0x1b8)}}}]),_0x409ef0=await product[_0x19c5de(0x14b)]({}),_0x45035f=await warehouse[_0x19c5de(0x19d)]([{'$match':{'status':_0x19c5de(0x1d9),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x19c5de(0xed),'$ne':_0x19c5de(0xfd)}}},{'$group':{'_id':_0x19c5de(0x14e),'name':{'$first':_0x19c5de(0x14e)}}},{'$sort':{'name':0x1}}]);var _0x5479ea=['Return\x20Rooms'];const _0x264381=await warehouse[_0x19c5de(0x19d)]([{'$match':{'status':_0x19c5de(0x1d9),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x19c5de(0x14e),'name':{'$first':_0x19c5de(0x14e)}}},{'$sort':{'name':0x1}}]);if(_0x297dd5[0x0][_0x19c5de(0x16d)]=='English\x20(US)'){var _0x198934=users[_0x19c5de(0x16f)];console[_0x19c5de(0xe8)](_0x198934);}else{if(_0x297dd5[0x0][_0x19c5de(0x16d)]==_0x19c5de(0xfc))var _0x198934=users[_0x19c5de(0xfc)];else{if(_0x297dd5[0x0]['language']==_0x19c5de(0x126))var _0x198934=users['German'];else{if(_0x297dd5[0x0][_0x19c5de(0x16d)]==_0x19c5de(0x104))var _0x198934=users[_0x19c5de(0x104)];else{if(_0x297dd5[0x0][_0x19c5de(0x16d)]==_0x19c5de(0x10a))var _0x198934=users[_0x19c5de(0x10a)];else{if(_0x297dd5[0x0][_0x19c5de(0x16d)]==_0x19c5de(0x1c7))var _0x198934=users['Portuguese'];else{if(_0x297dd5[0x0][_0x19c5de(0x16d)]==_0x19c5de(0xe9))var _0x198934=users[_0x19c5de(0xe9)];else{if(_0x297dd5[0x0]['language']==_0x19c5de(0x1cd))var _0x198934=users['Arabic'];}}}}}}}_0x1fe0e7[_0x19c5de(0x18f)](_0x19c5de(0x13d),{'success':_0x446540['flash'](_0x19c5de(0x117)),'errors':_0x446540[_0x19c5de(0x1ba)](_0x19c5de(0x1a9)),'role':_0x41e866,'profile':_0x50d529,'user':_0x3d1e78,'stock':_0x43b83c,'master_shop':_0x297dd5,'unit':_0x409ef0,'language':_0x198934,'warehouses':_0x45035f,'rooms':_0x5479ea,'warehouse_QA':_0x264381});}catch(_0x83489e){console[_0x19c5de(0xe8)](_0x83489e),_0x1fe0e7['status'](0xc8)[_0x19c5de(0x18a)]({'message':_0x83489e[_0x19c5de(0x180)]});}}),router[a0_0x47c58f(0x190)]('/view/return_sales/:id',auth,async(_0x21eb0d,_0x50331c)=>{var _0x183e08=a0_0x47c58f;if(_0x21eb0d[_0x183e08(0x1d7)]['for_categorize']=='QA')try{const {invoice:_0x5f5652,date:_0x211b1c,warehouse_name:_0x56dd17,product_name:_0x312d31,primary_code:_0x4bda61,secondary_code:_0x41a140,product_code:_0x40b99b,sales_quantity:_0x23ed6d,stocks:_0xc7ee98,return_qty:_0x5b6abe,Room_name:_0x42c35e,to_warehouse_name_QA:_0x508f78,to_Room_name_QA:_0x5e4b3a,note:_0x20461f,for_categorize:_0x2bd7e3,product_name_QA1:_0x83e8ef}=_0x21eb0d[_0x183e08(0x1d7)];if(typeof _0x83e8ef==_0x183e08(0x1e2))var _0x2c9b6e=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x16c)]],_0x5c0f79=[_0x21eb0d[_0x183e08(0x1d7)]['primary_code_QA']],_0x496142=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x16e)]],_0x46c3d9=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x1a8)]],_0x383426=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xd1)]],_0x4cf407=[_0x21eb0d['body']['stocks_QA']],_0x41323b=[_0x21eb0d['body'][_0x183e08(0x147)]],_0x59b085=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x1c4)]],_0x1f92b0=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x1b5)]],_0xf7f07f=[_0x21eb0d['body'][_0x183e08(0x15f)]],_0x270957=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xe4)]],_0x4913c2=[_0x21eb0d['body'][_0x183e08(0x12c)]],_0xb6c11a=[_0x21eb0d['body'][_0x183e08(0x1bd)]],_0x5ae085=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x113)]];else var _0x2c9b6e=[..._0x21eb0d[_0x183e08(0x1d7)]['product_name_QA1']],_0x5c0f79=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x19e)]],_0x496142=[..._0x21eb0d['body'][_0x183e08(0x16e)]],_0x46c3d9=[..._0x21eb0d['body']['product_code_QA']],_0x383426=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xd1)]],_0x4cf407=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x1b3)]],_0x41323b=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x147)]],_0x59b085=[..._0x21eb0d['body'][_0x183e08(0x1c4)]],_0x1f92b0=[..._0x21eb0d['body'][_0x183e08(0x1b5)]],_0xf7f07f=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x15f)]],_0x270957=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xe4)]],_0x4913c2=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x12c)]],_0xb6c11a=[..._0x21eb0d['body'][_0x183e08(0x1bd)]],_0x5ae085=[..._0x21eb0d['body'][_0x183e08(0x113)]];const _0x36602d=_0x2c9b6e['map'](_0x545e79=>{return _0x545e79={'product_name':_0x545e79};});_0x5c0f79['forEach']((_0x394433,_0x581370)=>{var _0x203dd9=_0x183e08;_0x36602d[_0x581370][_0x203dd9(0xd9)]=_0x394433;}),_0x496142[_0x183e08(0x16b)]((_0x5e906f,_0xfbdbbc)=>{var _0x463726=_0x183e08;_0x36602d[_0xfbdbbc][_0x463726(0x197)]=_0x5e906f;}),_0x46c3d9[_0x183e08(0x16b)]((_0x472ec2,_0x2dfb0a)=>{var _0x39ae49=_0x183e08;_0x36602d[_0x2dfb0a][_0x39ae49(0x17b)]=_0x472ec2;}),_0x383426[_0x183e08(0x16b)]((_0x4a133e,_0x4c440a)=>{_0x36602d[_0x4c440a]['sale_qty']=_0x4a133e;}),_0x4cf407[_0x183e08(0x16b)]((_0x33096e,_0x96b1d2)=>{var _0x3310cf=_0x183e08;_0x36602d[_0x96b1d2][_0x3310cf(0x133)]=_0x33096e;}),_0x41323b[_0x183e08(0x16b)]((_0x32cc5b,_0x5ae5ca)=>{var _0x11072d=_0x183e08;_0x36602d[_0x5ae5ca][_0x11072d(0xe5)]=_0x32cc5b;}),_0x59b085[_0x183e08(0x16b)]((_0x3eef76,_0x5eedfd)=>{_0x36602d[_0x5eedfd]['maxPerUnit']=_0x3eef76;}),_0x1f92b0[_0x183e08(0x16b)]((_0x59d938,_0x3b9844)=>{_0x36602d[_0x3b9844]['maxProducts']=_0x59d938;}),_0xf7f07f['forEach']((_0x37f79d,_0x28f69c)=>{var _0x2dccd0=_0x183e08;_0x36602d[_0x28f69c][_0x2dccd0(0x18e)]=_0x37f79d;}),_0x270957[_0x183e08(0x16b)]((_0x213dd9,_0xe924a8)=>{var _0x36d518=_0x183e08;_0x36602d[_0xe924a8][_0x36d518(0x187)]=_0x213dd9;}),_0x4913c2[_0x183e08(0x16b)]((_0x2dda80,_0x58a482)=>{var _0x60e27e=_0x183e08;_0x36602d[_0x58a482][_0x60e27e(0x144)]=_0x2dda80;}),_0xb6c11a[_0x183e08(0x16b)]((_0x4bc0b0,_0x5d5bb1)=>{_0x36602d[_0x5d5bb1]['production_date']=_0x4bc0b0;}),_0x5ae085[_0x183e08(0x16b)]((_0x5a533f,_0x3baba3)=>{var _0x5eee69=_0x183e08;_0x36602d[_0x3baba3][_0x5eee69(0x183)]=_0x5a533f;});const _0x2d9945=await sales_finished[_0x183e08(0x1c9)]({'invoice':_0x5f5652});_0x2d9945[_0x183e08(0x1ea)]=_0x183e08(0xdb);const _0x34214f=await _0x2d9945[_0x183e08(0x132)](),_0xc87e6b=new sales_return_finished({'invoice':_0x5f5652,'customer':_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xdd)],'date':_0x211b1c,'warehouse_name':_0x56dd17,'room':_0x42c35e,'ToWarehouse':_0x508f78,'ToRoom':_0x5e4b3a,'return_sale_QA':_0x36602d,'note':_0x20461f,'warehouse_cat':_0x2bd7e3}),_0x2f4036=await _0xc87e6b['save'](),_0xe25ebb=await sales_return_finished[_0x183e08(0x1c9)]({'invoice':_0x5f5652}),_0x1702e3=await warehouse['findOne']({'name':_0x508f78,'room':_0x5e4b3a});_0xe25ebb[_0x183e08(0x153)][_0x183e08(0x16b)](_0x376826=>{var _0x5e5da9=_0x183e08,_0x39b485=0x0;const _0x3b095d=_0x1702e3[_0x5e5da9(0x1ad)]['map'](_0xc8b33e=>{var _0x1cc557=_0x5e5da9;_0xc8b33e[_0x1cc557(0x1be)]==_0x376826[_0x1cc557(0x1be)]&&_0xc8b33e[_0x1cc557(0x183)]==_0x376826[_0x1cc557(0x183)]&&_0xc8b33e['production_date']==_0x376826[_0x1cc557(0x1ac)]&&_0xc8b33e['batch_code']==_0x376826[_0x1cc557(0x18e)]&&(_0xc8b33e['product_stock']=parseInt(_0xc8b33e[_0x1cc557(0xeb)])+parseInt(_0x376826[_0x1cc557(0xe5)]),_0x39b485++);});_0x39b485=='0'&&(_0x1702e3[_0x5e5da9(0x1ad)]=_0x1702e3['product_details']['concat']({'product_name':_0x376826[_0x5e5da9(0x1be)],'product_stock':_0x376826[_0x5e5da9(0xe5)],'primary_code':_0x376826[_0x5e5da9(0xd9)],'secondary_code':_0x376826[_0x5e5da9(0x197)],'product_code':_0x376826[_0x5e5da9(0x17b)],'batch_code':_0x376826[_0x5e5da9(0x18e)],'maxPerUnit':_0x376826[_0x5e5da9(0x14c)],'production_date':_0x376826[_0x5e5da9(0x1ac)],'expiry_date':_0x376826[_0x5e5da9(0x183)],'secondary_unit':_0x376826[_0x5e5da9(0x187)],'unit':_0x376826[_0x5e5da9(0x144)],'maxProducts':_0x376826[_0x5e5da9(0x19f)],'bay':_0x376826['bay']}));}),await _0x1702e3['save']();const _0x197e5a=new c_payment_data({'invoice':_0x5f5652,'customer':_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xdd)],'reason':_0x183e08(0x149)});await _0x197e5a[_0x183e08(0x132)]();const _0x48d0f4=await master_shop[_0x183e08(0x14b)](),_0x4a4009=await email_settings[_0x183e08(0x1c9)](),_0x3d9667=await customer['findOne']({'name':_0x21eb0d[_0x183e08(0x1d7)]['customer']});_0x48d0f4[0x0][_0x183e08(0x10f)]==0x1?(right_currency=_0x48d0f4[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x48d0f4[0x0][_0x183e08(0xd0)]);var _0x4a2a4d=_0x2c9b6e,_0x1d68ed=_0x41323b,_0x503439='',_0x3318d5;for(_0x3318d5 in _0x4a2a4d){_0x503439+=_0x183e08(0xf9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4a2a4d[_0x3318d5]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1d68ed[_0x3318d5]+_0x183e08(0x1a0)+_0x183e08(0x111);}console[_0x183e08(0xe8)](_0x183e08(0x10b),_0x503439);let _0x2b059b=nodemailer[_0x183e08(0xd6)]({'service':_0x183e08(0x186),'auth':{'user':_0x4a4009['email'],'pass':_0x4a4009[_0x183e08(0x11a)]}}),_0x25f999={'from':_0x4a4009[_0x183e08(0x13c)],'to':_0x3d9667[_0x183e08(0x13c)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x183e08(0x1a2),'path':__dirname+_0x183e08(0x17d)+'/upload/'+_0x48d0f4[0x0][_0x183e08(0x1aa)],'cid':_0x183e08(0x1bb)}],'html':_0x183e08(0xc7)+'<html><head><title></title>'+_0x183e08(0x12e)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x183e08(0x115)+_0x183e08(0x182)+_0x183e08(0x1a7)+_0x183e08(0x179)+_0x48d0f4[0x0]['site_title']+'\x20</h2>'+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x183e08(0x1a7)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x5f5652+'\x20'+_0x183e08(0x1ae)+_0x183e08(0x191)+_0x211b1c+'\x20'+'</span>'+_0x183e08(0x120)+_0x183e08(0x182)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x183e08(0xd5)+_0x183e08(0xf9)+_0x183e08(0x134)+_0x183e08(0xd2)+_0x183e08(0x172)+_0x183e08(0x19a)+_0x183e08(0x111)+_0x183e08(0x171)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x503439+'\x20'+_0x183e08(0x15c)+_0x183e08(0x1cb)+'<div>'+_0x183e08(0x100)+'<h5>'+_0x48d0f4[0x0][_0x183e08(0x1d1)]+_0x183e08(0x120)+_0x183e08(0x182)+'</div>'+_0x183e08(0xff)};_0x2b059b[_0x183e08(0xf4)](_0x25f999,function(_0x5add1a,_0x13bb3b){var _0x2a3d43=_0x183e08;_0x5add1a?(console['log'](_0x5add1a),console['log'](_0x2a3d43(0x1c0))):console['log']('Email\x20sent\x20successfully');}),_0x21eb0d['flash']('success',_0x183e08(0x106)),_0x50331c[_0x183e08(0x1e3)](_0x183e08(0xfe));}catch(_0x432c7e){_0x50331c[_0x183e08(0x152)](0xc8)[_0x183e08(0x18a)]({'message1':_0x432c7e[_0x183e08(0x180)]});}else{if(_0x21eb0d[_0x183e08(0x1d7)]['for_categorize']=='GS')try{const {invoice:_0x130151,date:_0x1d536f,warehouse_name:_0x5378d2,product_name:_0x1da3c9,primary_code:_0x55e4c3,secondary_code:_0x11c4d7,product_code:_0x5748da,sales_quantity:_0x422070,stocks:_0x420dea,return_qty:_0x44f00f,Room_name:_0x16f28b,to_warehouse_name:_0x2e63f5,to_Room_name:_0x3c6a2e,note:_0x59b1df,level:_0x41f811,isle:_0xf54021,pallet:_0x5bd278,for_categorize:_0x3b0c06}=_0x21eb0d[_0x183e08(0x1d7)];if(typeof _0x1da3c9==_0x183e08(0x1e2))var _0x2c9b6e=[_0x21eb0d['body'][_0x183e08(0x1be)]],_0x5c0f79=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xd9)]],_0x496142=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x197)]],_0x46c3d9=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x17b)]],_0x383426=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xe3)]],_0x41323b=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xe5)]],_0x641358=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x193)]],_0x59b085=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x14c)]],_0x1f92b0=[_0x21eb0d['body'][_0x183e08(0x19f)]],_0xf7f07f=[_0x21eb0d[_0x183e08(0x1d7)]['batch_code']],_0x270957=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x187)]],_0x4913c2=[_0x21eb0d['body']['unit']],_0xb6c11a=[_0x21eb0d['body'][_0x183e08(0x1ac)]],_0x5ae085=[_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x183)]];else var _0x2c9b6e=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x1be)]],_0x5c0f79=[..._0x21eb0d[_0x183e08(0x1d7)]['primary_code']],_0x496142=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x197)]],_0x46c3d9=[..._0x21eb0d['body'][_0x183e08(0x17b)]],_0x383426=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xe3)]],_0x41323b=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xe5)]],_0x641358=[..._0x21eb0d[_0x183e08(0x1d7)]['bay']],_0x59b085=[..._0x21eb0d[_0x183e08(0x1d7)]['maxPerUnit']],_0x1f92b0=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x19f)]],_0xf7f07f=[..._0x21eb0d[_0x183e08(0x1d7)]['batch_code']],_0x270957=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x187)]],_0x4913c2=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x144)]],_0xb6c11a=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x1ac)]],_0x5ae085=[..._0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0x183)]];const _0x156765=_0x2c9b6e[_0x183e08(0xf8)](_0xad34e0=>{return _0xad34e0={'product_name':_0xad34e0};});_0x5c0f79['forEach']((_0xe7fed8,_0x551eb9)=>{_0x156765[_0x551eb9]['primary_code']=_0xe7fed8;}),_0x496142['forEach']((_0x43d433,_0x5f0366)=>{var _0x4a5b70=_0x183e08;_0x156765[_0x5f0366][_0x4a5b70(0x197)]=_0x43d433;}),_0x46c3d9[_0x183e08(0x16b)]((_0x4ddd42,_0x21d1bc)=>{var _0x5da775=_0x183e08;_0x156765[_0x21d1bc][_0x5da775(0x17b)]=_0x4ddd42;}),_0x383426[_0x183e08(0x16b)]((_0x30e062,_0x4cf44a)=>{var _0x18f6cc=_0x183e08;_0x156765[_0x4cf44a][_0x18f6cc(0x15e)]=_0x30e062;}),_0x41323b[_0x183e08(0x16b)]((_0x7ff3ee,_0x5422af)=>{var _0x3ab16f=_0x183e08;_0x156765[_0x5422af][_0x3ab16f(0xe5)]=_0x7ff3ee;}),_0x641358[_0x183e08(0x16b)]((_0x11ee8a,_0x4c3c49)=>{_0x156765[_0x4c3c49]['bay']=_0x11ee8a;}),_0x59b085[_0x183e08(0x16b)]((_0x52821a,_0xa274cc)=>{var _0x172a6a=_0x183e08;_0x156765[_0xa274cc][_0x172a6a(0x14c)]=_0x52821a;}),_0x1f92b0['forEach']((_0x4e256c,_0x55757b)=>{var _0x442ae5=_0x183e08;_0x156765[_0x55757b][_0x442ae5(0x19f)]=_0x4e256c;}),_0xf7f07f[_0x183e08(0x16b)]((_0x45b338,_0x1ec63f)=>{var _0x5997c4=_0x183e08;_0x156765[_0x1ec63f][_0x5997c4(0x18e)]=_0x45b338;}),_0x270957[_0x183e08(0x16b)]((_0x2abd91,_0x5983a4)=>{var _0xfd270=_0x183e08;_0x156765[_0x5983a4][_0xfd270(0x187)]=_0x2abd91;}),_0x4913c2[_0x183e08(0x16b)]((_0x31fab4,_0x4246a8)=>{_0x156765[_0x4246a8]['unit']=_0x31fab4;}),_0xb6c11a['forEach']((_0x13f195,_0x164f8b)=>{_0x156765[_0x164f8b]['production_date']=_0x13f195;}),_0x5ae085[_0x183e08(0x16b)]((_0x456bb0,_0x5c22f8)=>{var _0x6d716e=_0x183e08;_0x156765[_0x5c22f8][_0x6d716e(0x183)]=_0x456bb0;});var _0x41f99b=0x0;_0x156765[_0x183e08(0x16b)](_0x241d12=>{var _0x44eaf4=_0x183e08;(parseInt(_0x241d12[_0x44eaf4(0x15e)])<parseInt(_0x241d12[_0x44eaf4(0xe5)])||parseInt(_0x241d12[_0x44eaf4(0x133)])<parseInt(_0x241d12['return_qty'])&&parseInt(_0x241d12[_0x44eaf4(0x15e)])>parseInt(_0x241d12[_0x44eaf4(0xe5)])||parseInt(_0x241d12[_0x44eaf4(0xe5)])==0x0)&&_0x41f99b++;});if(_0x41f99b!=0x0)return _0x21eb0d[_0x183e08(0x1ba)](_0x183e08(0x1a9),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x50331c[_0x183e08(0x1e3)](_0x183e08(0x164));const _0x99d6d3=await sales_finished[_0x183e08(0x1c9)]({'invoice':_0x130151});_0x99d6d3[_0x183e08(0x1ea)]=_0x183e08(0xdb);const _0x3515b1=await _0x99d6d3[_0x183e08(0x132)](),_0x4b424e=new sales_return_finished({'invoice':_0x130151,'customer':_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xdd)],'date':_0x1d536f,'warehouse_name':_0x5378d2,'room':_0x16f28b,'ToWarehouse':_0x2e63f5,'ToRoom':_0x3c6a2e,'return_sale':_0x156765,'note':_0x59b1df,'warehouse_cat':_0x3b0c06}),_0x4b32af=await _0x4b424e[_0x183e08(0x132)](),_0x25f617=await sales_return_finished[_0x183e08(0x1c9)]({'invoice':_0x130151}),_0xbbf81=await warehouse['findOne']({'name':_0x2e63f5,'room':_0x3c6a2e,'warehouse_category':_0x183e08(0xe1)});_0x25f617[_0x183e08(0xe7)]['forEach'](_0x2fd7a1=>{var _0x232765=_0x183e08,_0x23ba18=0x0;const _0x5b68e4=_0xbbf81[_0x232765(0x1ad)][_0x232765(0xf8)](_0x1e6e4a=>{var _0xa03b8a=_0x232765;_0x1e6e4a[_0xa03b8a(0x1be)]==_0x2fd7a1[_0xa03b8a(0x1be)]&&_0x1e6e4a[_0xa03b8a(0x193)]==_0x2fd7a1[_0xa03b8a(0x193)]&&_0x1e6e4a[_0xa03b8a(0x183)]==_0x2fd7a1['expiry_date']&&_0x1e6e4a['production_date']==_0x2fd7a1['production_date']&&_0x1e6e4a[_0xa03b8a(0x18e)]==_0x2fd7a1[_0xa03b8a(0x18e)]&&(_0x1e6e4a[_0xa03b8a(0xeb)]=parseInt(_0x1e6e4a['product_stock'])+parseInt(_0x2fd7a1[_0xa03b8a(0xe5)]),_0x23ba18++);});_0x23ba18=='0'&&(_0xbbf81[_0x232765(0x1ad)]=_0xbbf81[_0x232765(0x1ad)][_0x232765(0x11f)]({'product_name':_0x2fd7a1['product_name'],'product_stock':_0x2fd7a1[_0x232765(0xe5)],'primary_code':_0x2fd7a1[_0x232765(0xd9)],'secondary_code':_0x2fd7a1[_0x232765(0x197)],'product_code':_0x2fd7a1['product_code'],'bay':_0x2fd7a1['bay'],'batch_code':_0x2fd7a1['batch_code'],'maxPerUnit':_0x2fd7a1[_0x232765(0x14c)],'production_date':_0x2fd7a1['production_date'],'expiry_date':_0x2fd7a1[_0x232765(0x183)],'secondary_unit':_0x2fd7a1['secondary_unit'],'unit':_0x2fd7a1['unit'],'maxProducts':_0x2fd7a1['maxProducts']}));}),await _0xbbf81[_0x183e08(0x132)](),console['log'](_0x21eb0d['body']);const _0x484665=new c_payment_data({'invoice':_0x130151,'customer':_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xdd)],'reason':_0x183e08(0x149)});await _0x484665[_0x183e08(0x132)]();const _0x59d25d=await master_shop[_0x183e08(0x14b)]();console[_0x183e08(0xe8)]('add\x20post',_0x59d25d[0x0][_0x183e08(0x1aa)]);const _0x340657=await email_settings['findOne'](),_0xc42fbb=await customer[_0x183e08(0x1c9)]({'name':_0x21eb0d[_0x183e08(0x1d7)][_0x183e08(0xdd)]});console[_0x183e08(0xe8)](_0x183e08(0x1cc),_0xc42fbb);_0x59d25d[0x0][_0x183e08(0x10f)]==0x1?(right_currency=_0x59d25d[0x0][_0x183e08(0xd0)],left_currency=''):(right_currency='',left_currency=_0x59d25d[0x0][_0x183e08(0xd0)]);var _0x4a2a4d=_0x2c9b6e,_0x1d68ed=_0x41323b,_0x503439='',_0x3318d5;for(_0x3318d5 in _0x4a2a4d){_0x503439+=_0x183e08(0xf9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4a2a4d[_0x3318d5]+'</td>'+_0x183e08(0xf1)+_0x1d68ed[_0x3318d5]+_0x183e08(0x1a0)+'</tr>';}console[_0x183e08(0xe8)](_0x183e08(0x10b),_0x503439);let _0x5594b4=nodemailer[_0x183e08(0xd6)]({'service':_0x183e08(0x186),'auth':{'user':_0x340657['email'],'pass':_0x340657[_0x183e08(0x11a)]}}),_0x429d3e={'from':_0x340657['email'],'to':_0xc42fbb[_0x183e08(0x13c)],'subject':_0x183e08(0x1e6),'attachments':[{'filename':_0x183e08(0x1a2),'path':__dirname+'/../public'+'/upload/'+_0x59d25d[0x0]['image'],'cid':'logo'}],'html':_0x183e08(0xc7)+_0x183e08(0x1bc)+_0x183e08(0x12e)+_0x183e08(0x1a7)+_0x183e08(0x116)+'<div>'+_0x183e08(0x115)+_0x183e08(0x182)+_0x183e08(0x1a7)+_0x183e08(0x179)+_0x59d25d[0x0]['site_title']+_0x183e08(0x17c)+'</div>'+_0x183e08(0x182)+_0x183e08(0x112)+_0x183e08(0x1a7)+_0x183e08(0x161)+_0x183e08(0x1de)+_0x130151+'\x20'+_0x183e08(0x1ae)+_0x183e08(0x191)+_0x1d536f+'\x20'+_0x183e08(0x174)+'</h5>'+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x183e08(0xf9)+_0x183e08(0x134)+_0x183e08(0xd2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x183e08(0x19a)+_0x183e08(0x111)+'</thead>'+_0x183e08(0x11e)+'\x20'+_0x503439+'\x20'+'</tbody>'+_0x183e08(0x1cb)+_0x183e08(0x1a7)+_0x183e08(0x100)+_0x183e08(0xfa)+_0x59d25d[0x0][_0x183e08(0x1d1)]+_0x183e08(0x120)+'</div>'+'</div>'+_0x183e08(0xff)};_0x5594b4[_0x183e08(0xf4)](_0x429d3e,function(_0x2e9e98,_0x4d28c0){var _0x2e999d=_0x183e08;_0x2e9e98?(console[_0x2e999d(0xe8)](_0x2e9e98),console['log'](_0x2e999d(0x1c0))):console['log']('Email\x20sent\x20successfully');}),_0x21eb0d[_0x183e08(0x1ba)]('success',_0x183e08(0x106)),_0x50331c[_0x183e08(0x1e3)](_0x183e08(0xfe));}catch(_0x2d7860){console['log'](_0x2d7860),_0x50331c[_0x183e08(0x152)](0xc8)['json']({'message1':_0x2d7860[_0x183e08(0x180)]});}}}),router[a0_0x47c58f(0x165)](a0_0x47c58f(0x189),auth,async(_0x2c854d,_0xd2343c)=>{var _0x5808a7=a0_0x47c58f;try{const {username:_0x391cd4,email:_0x51b966,role:_0x57011c}=_0x2c854d['user'],_0x1a8969=_0x2c854d['user'],_0x3678cd=await profile['findOne']({'email':_0x1a8969[_0x5808a7(0x13c)]}),_0x24bfc7=await master_shop[_0x5808a7(0x14b)]();console[_0x5808a7(0xe8)](_0x5808a7(0x1b1),_0x24bfc7);const _0x586a9c=_0x2c854d[_0x5808a7(0x1df)]['id'],_0x7afbab=await sales['findById'](_0x586a9c);console[_0x5808a7(0xe8)]('barcode\x20user_id',_0x7afbab);if(_0x24bfc7[0x0][_0x5808a7(0x16d)]==_0x5808a7(0x1c6))var _0x2a0961=users[_0x5808a7(0x16f)];else{if(_0x24bfc7[0x0][_0x5808a7(0x16d)]==_0x5808a7(0xfc))var _0x2a0961=users[_0x5808a7(0xfc)];else{if(_0x24bfc7[0x0]['language']==_0x5808a7(0x126))var _0x2a0961=users['German'];else{if(_0x24bfc7[0x0][_0x5808a7(0x16d)]==_0x5808a7(0x104))var _0x2a0961=users[_0x5808a7(0x104)];else{if(_0x24bfc7[0x0][_0x5808a7(0x16d)]==_0x5808a7(0x10a))var _0x2a0961=users[_0x5808a7(0x10a)];else{if(_0x24bfc7[0x0][_0x5808a7(0x16d)]==_0x5808a7(0x1c7))var _0x2a0961=users[_0x5808a7(0x1e1)];else{if(_0x24bfc7[0x0][_0x5808a7(0x16d)]==_0x5808a7(0xe9))var _0x2a0961=users['Chinese'];else{if(_0x24bfc7[0x0]['language']==_0x5808a7(0x1cd))var _0x2a0961=users['Arabic'];}}}}}}}_0xd2343c['render'](_0x5808a7(0x1a4),{'success':_0x2c854d[_0x5808a7(0x1ba)]('success'),'errors':_0x2c854d['flash']('errors'),'role':_0x1a8969,'profile':_0x3678cd,'alldata':_0x7afbab,'master_shop':_0x24bfc7,'language':_0x2a0961});}catch(_0x180c36){console['log'](_0x180c36);}}),router[a0_0x47c58f(0x190)](a0_0x47c58f(0x121),async(_0x407d30,_0x4e23c3)=>{var _0x39f41b=a0_0x47c58f;const {product_code:_0x5dfa0e,warehouse_name:_0xca0469,rooms_data:_0x44c262,Roomslist:_0x4ca48a}=_0x407d30[_0x39f41b(0x1d7)],_0x4b3f07=_0x4ca48a['split'](','),_0x4ac0ef=[];async function _0x1d034a(_0x46e865){var _0x22654b=_0x39f41b;const _0xad9af=await warehouse[_0x22654b(0x19d)]([{'$match':{'name':_0xca0469,'room':_0x46e865}},{'$unwind':_0x22654b(0x1da)},{'$match':{'product_details.primary_code':_0x5dfa0e}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x22654b(0x166)},'primary_code':{'$first':_0x22654b(0xe2)},'secondary_code':{'$first':_0x22654b(0x19b)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x22654b(0x1a6)},'isle':{'$first':_0x22654b(0x13a)},'type':{'$first':_0x22654b(0x14f)},'pallet':{'$first':_0x22654b(0x105)},'unit':{'$first':_0x22654b(0xda)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x22654b(0x1a5)},'production_date':{'$first':_0x22654b(0x1b6)},'maxPerUnit':{'$first':_0x22654b(0x1b8)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x22654b(0x11d)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x22654b(0x14d)},'invoice':{'$first':_0x22654b(0x1a1)}}}]),_0x52b783=await warehouse[_0x22654b(0x19d)]([{'$match':{'name':_0xca0469,'room':_0x46e865}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5dfa0e}},{'$group':{'_id':_0x22654b(0x142),'name':{'$first':_0x22654b(0x168)},'product_stock':{'$first':_0x22654b(0x166)},'primary_code':{'$first':_0x22654b(0xe2)},'secondary_code':{'$first':_0x22654b(0x19b)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x22654b(0x13a)},'type':{'$first':_0x22654b(0x14f)},'pallet':{'$first':_0x22654b(0x105)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x22654b(0x1af)},'rack':{'$first':_0x22654b(0xea)},'expiry_date':{'$first':_0x22654b(0x1a5)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x22654b(0x1b8)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x22654b(0x11d)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x22654b(0x14d)},'invoice':{'$first':_0x22654b(0x1a1)}}}]);if(_0xad9af[_0x22654b(0x1dd)]>0x0)_0x4ac0ef['push'](_0xad9af);else _0x52b783['length']>0x0&&_0x4ac0ef[_0x22654b(0x199)](_0x52b783);}const _0x59a65d=_0x4b3f07['map'](_0x28c0a2=>_0x1d034a(_0x28c0a2));await Promise[_0x39f41b(0xf0)](_0x59a65d),_0x4e23c3[_0x39f41b(0x18a)](_0x4ac0ef);}),module[a0_0x47c58f(0xcb)]=router;