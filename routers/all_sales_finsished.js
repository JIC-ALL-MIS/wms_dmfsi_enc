function a0_0x5ece(){var _0xd8a545=['success','product_code_QA','return_data','../models/all_models','sales_quantity_QA','$product','617420dNpUhk','$sale_product.bay','$sale_product','warehouse','maxPerUnit_QA','Portuguese\x20(BR)','</head><body>','due_amount','aggregate','\x20Order\x20Number\x20:\x20','Sale','Hindi','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$return_data','Spanish','return_sale','map','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','createTransport','unit_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.storage','final','156HKwEOr','$product_details.batch_code','$product_details.maxPerUnit','adjust_qty','$sale_product.floorlevel','payment\x20successfull','quantity','user','$sale_product.type','$_id','barcode\x20Product\x20master','barcode\x20user_id','1DLNnXX','$product_details.invoice','sales_quantity','findById','sales\x20item\x20return\x20successfull','<hr\x20class=\x22my-3\x22>','Return\x20Goods','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','<tr>','language','Enclosed','_id','production_date','image','$product_details.maxProducts','$product_details.product_stock','Arabic\x20(ae)','json','$name','</tr>','room_name','/all_sales/view','return_sale_finished','flash','\x20&&\x20','/all_sales_finished/view','abs','filter','<h2>\x20','</h5>','product_name','foreach\x20newproduct','\x20<>\x20','$product_details.bay','catch','toString','$product_details.production_date','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','prod_code','save','edit_sales_finished_view','log','/view','return_qty_QA','customer','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','return_sale_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','344150bHrJSZ','length','name','/view/add_sales/:id','$room','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','date','forEach','$product_details.product_code','$product_details','</thead>','<h5>','find','An\x20error\x20occurred.','$product_details.expiry_date','733449bTqscg','production_date_QA','<table\x20style=\x22width:\x20100%\x20!important;\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','add\x20post','nodemailer','\x20==\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','/preview/:id','Quality\x20Inspection','German','Error\x20Occurs','finalize','123081byQljq','QA\x20Warehouse','received_amount','Ambient','gmail','/view/add_sale/product','$product_details.secondary_code','getFullYear','product_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','status','$date','error','Email\x20sent\x20successfully','password','$invoice','master','maxperunit','$sale_product.quantity','max','/invoice/:id','Portuguese','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','prod_cat','$customer','invoice','prod_invoice','<html><head><title></title>','Sale\x20Return\x20Mail','Sales\x20Add\x20successfully','Router','/all_sales_finished/preview/','$product_details.product_cat','findOne','Arabic','Enabled','split','warehouse_name','bay','logo','$product_details.unit','/upload/','product_stock','carton','concat','role','/view/return_sales/:id','$product_details.product_name','\x20<<<==>>>\x20','<!DOCTYPE\x20html>','/view/:id','push','all','Chinese','$product_details.rack','message','primary_code','RoomAssigned','$sale_product.bin','product_details','render','FGSEmail','expiry_date','/barcode_scanner','\x20>>>\x20','product_list','stock_data','$note','slice','<strong>\x20Regards\x20</strong>','<tbody\x20style=\x22text-align:\x20center;\x22>','/../public','return_qty','$product_details.type','max_per_unit','False','string','customers','stock','$warehouse_name','/picking_list/pdf/','\x20Order\x20Date\x20:\x20','getMonth','product_data','2776096ZfXrlp','</td>','OUTF-','secondary_code','<div>','primary_code_QA','$product_details.bin','room','for_categorize','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','maxPerUnit','</tbody>','maxProducts','sale_qty','</body></html>','product_date','post','id_transaction_from','French','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','staff','225540UuzsOM','params','get','padStart','<h5\x20style=\x22text-align:\x20left;\x22>','purchases_data','redirect','$product_details.floorlevel','amount','True','secondary_unit','secondary_unit_QA','$customers_docs','Sales\x20Mail','customers_docs','site_title','<span\x20style=\x22float:\x20right;\x22>','errors','batch_code','expiry_date_QA','2398986NyCAWO','suppliers','English\x20(US)','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','then','email','Sales\x20Update\x20successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','secondary_code_QA','</table>','sendMail','body','level','sale_product','currency_placement','$product_details.primary_code','</span>','Sale\x20Return','English','floor','$product.product_name','Logo.png','</div>','Finished\x20Goods','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','product','$finalize','maxProducts_QA','$product_details._id','currency','batch_code_QA','unit','back'];a0_0x5ece=function(){return _0xd8a545;};return a0_0x5ece();}var a0_0x2b3417=a0_0x199d;(function(_0x1f2624,_0x52d617){var _0x564431=a0_0x199d,_0x35e767=_0x1f2624();while(!![]){try{var _0x4853ad=parseInt(_0x564431(0x1db))/0x1*(parseInt(_0x564431(0x20e))/0x2)+parseInt(_0x564431(0x21d))/0x3+parseInt(_0x564431(0x1b8))/0x4+parseInt(_0x564431(0x17d))/0x5+-parseInt(_0x564431(0x1cf))/0x6*(parseInt(_0x564431(0x22a))/0x7)+parseInt(_0x564431(0x168))/0x8+-parseInt(_0x564431(0x191))/0x9;if(_0x4853ad===_0x52d617)break;else _0x35e767['push'](_0x35e767['shift']());}catch(_0x107201){_0x35e767['push'](_0x35e767['shift']());}}}(a0_0x5ece,0x3a6d9));function a0_0x199d(_0x3f69dd,_0x477bc6){var _0x5ecedf=a0_0x5ece();return a0_0x199d=function(_0x199dbb,_0x3b0261){_0x199dbb=_0x199dbb-0x15b;var _0x4fa6fd=_0x5ecedf[_0x199dbb];return _0x4fa6fd;},a0_0x199d(_0x3f69dd,_0x477bc6);}const express=require('express'),app=express(),router=express[a0_0x2b3417(0x249)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x2b3417(0x1b5)),auth=require('../middleware/auth'),nodemailer=require(a0_0x2b3417(0x222)),users=require('../public/language/languages.json');router[a0_0x2b3417(0x17f)](a0_0x2b3417(0x205),auth,async(_0xce5ad9,_0x38e0d7)=>{var _0x31e1d0=a0_0x2b3417;try{const {username:_0x4f5f29,email:_0xd4eb5c,role:_0x3b434e}=_0xce5ad9[_0x31e1d0(0x1d6)],_0x11faed=_0xce5ad9['user'],_0x3b9315=await profile[_0x31e1d0(0x24c)]({'email':_0x11faed['email']}),_0x1fffec=await master_shop[_0x31e1d0(0x21a)]();let _0x47c66f;if(_0x11faed[_0x31e1d0(0x258)]==_0x31e1d0(0x17c)){const _0x5b6a2d=await staff[_0x31e1d0(0x24c)]({'email':_0x11faed['email']});_0x47c66f=await sales_finished['aggregate']([{'$lookup':{'from':_0x31e1d0(0x161),'localField':_0x31e1d0(0x207),'foreignField':_0x31e1d0(0x210),'as':_0x31e1d0(0x18b)}},{'$unwind':'$customers_docs'},{'$unwind':'$sale_product'},{'$group':{'_id':_0x31e1d0(0x1d8),'invoice':{'$first':_0x31e1d0(0x23a)},'customers':{'$first':_0x31e1d0(0x243)},'date':{'$first':_0x31e1d0(0x236)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x31e1d0(0x1ba)},'note':{'$first':_0x31e1d0(0x26e)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x31e1d0(0x189)},'total_saleproduct_quantity':{'$sum':_0x31e1d0(0x23d)},'level':{'$addToSet':_0x31e1d0(0x1b9)},'isle':{'$addToSet':_0x31e1d0(0x265)},'type':{'$addToSet':_0x31e1d0(0x1d7)},'pallet':{'$addToSet':_0x31e1d0(0x1d3)},'finalize':{'$first':_0x31e1d0(0x1ab)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x47c66f=await sales_finished[_0x31e1d0(0x1c0)]([{'$lookup':{'from':'customers','localField':'customer','foreignField':'name','as':_0x31e1d0(0x18b)}},{'$unwind':'$customers_docs'},{'$unwind':_0x31e1d0(0x1ba)},{'$group':{'_id':_0x31e1d0(0x1d8),'invoice':{'$first':_0x31e1d0(0x23a)},'customers':{'$first':_0x31e1d0(0x243)},'date':{'$first':_0x31e1d0(0x236)},'warehouse_name':{'$first':_0x31e1d0(0x163)},'sale_product':{'$push':_0x31e1d0(0x1ba)},'note':{'$first':_0x31e1d0(0x26e)},'return_data':{'$first':_0x31e1d0(0x1c5)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x31e1d0(0x265)},'type':{'$addToSet':_0x31e1d0(0x1d7)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x1fffec[0x0]['language']==_0x31e1d0(0x193)){var _0x4be8d8=users[_0x31e1d0(0x1a3)];console[_0x31e1d0(0x204)](_0x4be8d8);}else{if(_0x1fffec[0x0][_0x31e1d0(0x1e4)]=='Hindi')var _0x4be8d8=users[_0x31e1d0(0x1c3)];else{if(_0x1fffec[0x0]['language']==_0x31e1d0(0x227))var _0x4be8d8=users[_0x31e1d0(0x227)];else{if(_0x1fffec[0x0][_0x31e1d0(0x1e4)]=='Spanish')var _0x4be8d8=users[_0x31e1d0(0x1c6)];else{if(_0x1fffec[0x0][_0x31e1d0(0x1e4)]==_0x31e1d0(0x17a))var _0x4be8d8=users['French'];else{if(_0x1fffec[0x0]['language']==_0x31e1d0(0x1bd))var _0x4be8d8=users['Portuguese'];else{if(_0x1fffec[0x0]['language']==_0x31e1d0(0x260))var _0x4be8d8=users[_0x31e1d0(0x260)];else{if(_0x1fffec[0x0][_0x31e1d0(0x1e4)]==_0x31e1d0(0x1eb))var _0x4be8d8=users['Arabic'];}}}}}}}_0x38e0d7[_0x31e1d0(0x267)]('all_sales_finished',{'success':_0xce5ad9[_0x31e1d0(0x1f2)](_0x31e1d0(0x1b2)),'errors':_0xce5ad9[_0x31e1d0(0x1f2)](_0x31e1d0(0x18e)),'sales':_0x47c66f,'profile':_0x3b9315,'role':_0x11faed,'master_shop':_0x1fffec,'language':_0x4be8d8});}catch(_0x5e5f10){console[_0x31e1d0(0x204)](_0x5e5f10);}});async function getRandom8DigitNumber(){var _0x10a226=a0_0x2b3417;const _0x4db623=0x989680,_0x245bea=0x5f5e0ff,_0x4f32a1=Math[_0x10a226(0x1a4)](Math['random']()*(_0x245bea-_0x4db623+0x1))+_0x4db623;var _0xbe8f8a;const _0x4a1264=await sales_finished['findOne']({'invoice':_0x10a226(0x16a)+_0x4f32a1});return _0x4a1264&&_0x4a1264[_0x10a226(0x20f)]>0x0?_0xbe8f8a='OUTF-'+_0x4f32a1:_0xbe8f8a=_0x10a226(0x16a)+_0x4f32a1,_0xbe8f8a;}router[a0_0x2b3417(0x17f)]('/view/add_sales',auth,async(_0x125b05,_0x2729e1)=>{var _0x451cae=a0_0x2b3417;try{const {username:_0x68243c,email:_0x5289b6,role:_0x44988f}=_0x125b05[_0x451cae(0x1d6)],_0x462a6a=_0x125b05[_0x451cae(0x1d6)],_0x24a557=await profile[_0x451cae(0x24c)]({'email':_0x462a6a[_0x451cae(0x196)]}),_0x430266=await master_shop[_0x451cae(0x21a)](),_0xdc790f=await customer['find']({});let _0xda8a18;if(_0x462a6a['role']==_0x451cae(0x17c)){const _0x38dbe5=await staff['findOne']({'email':_0x462a6a[_0x451cae(0x196)]});_0xda8a18=await warehouse[_0x451cae(0x1c0)]([{'$match':{'status':_0x451cae(0x24e),'name':_0x38dbe5['warehouse'],'warehouse_category':_0x451cae(0x1a8),'name':{'$ne':_0x451cae(0x22b)}}},{'$group':{'_id':_0x451cae(0x1ed),'name':{'$first':_0x451cae(0x1ed)}}},{'$sort':{'name':0x1}}]);}else _0xda8a18=await warehouse['aggregate']([{'$match':{'status':_0x451cae(0x24e),'warehouse_category':_0x451cae(0x1a8),'name':{'$ne':_0x451cae(0x22b)}}},{'$group':{'_id':_0x451cae(0x1ed),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x1546da=await product[_0x451cae(0x21a)]({});var _0x169189=['Ambient',_0x451cae(0x1e5)];const _0x25b396=await sales_finished[_0x451cae(0x21a)]({}),_0x2ad7f6=_0x25b396[_0x451cae(0x20f)]+0x1,_0x43e62d=_0x451cae(0x16a)+_0x2ad7f6[_0x451cae(0x1fe)]()[_0x451cae(0x180)](0x5,'0');if(_0x430266[0x0][_0x451cae(0x1e4)]==_0x451cae(0x193)){var _0x348ff5=users[_0x451cae(0x1a3)];console[_0x451cae(0x204)](_0x348ff5);}else{if(_0x430266[0x0][_0x451cae(0x1e4)]==_0x451cae(0x1c3))var _0x348ff5=users[_0x451cae(0x1c3)];else{if(_0x430266[0x0][_0x451cae(0x1e4)]=='German')var _0x348ff5=users[_0x451cae(0x227)];else{if(_0x430266[0x0][_0x451cae(0x1e4)]==_0x451cae(0x1c6))var _0x348ff5=users[_0x451cae(0x1c6)];else{if(_0x430266[0x0][_0x451cae(0x1e4)]=='French')var _0x348ff5=users[_0x451cae(0x17a)];else{if(_0x430266[0x0][_0x451cae(0x1e4)]==_0x451cae(0x1bd))var _0x348ff5=users[_0x451cae(0x240)];else{if(_0x430266[0x0][_0x451cae(0x1e4)]==_0x451cae(0x260))var _0x348ff5=users[_0x451cae(0x260)];else{if(_0x430266[0x0][_0x451cae(0x1e4)]=='Arabic\x20(ae)')var _0x348ff5=users[_0x451cae(0x24d)];}}}}}}}const _0x21699d=getRandom8DigitNumber();_0x21699d[_0x451cae(0x195)](_0x212e9a=>{var _0x38f70b=_0x451cae;_0x2729e1[_0x38f70b(0x267)]('add_sales_finished',{'success':_0x125b05[_0x38f70b(0x1f2)](_0x38f70b(0x1b2)),'errors':_0x125b05[_0x38f70b(0x1f2)](_0x38f70b(0x18e)),'role':_0x462a6a,'profile':_0x24a557,'customer':_0xdc790f,'warehouse':_0xda8a18,'product':_0x1546da,'invoice':_0x212e9a,'master_shop':_0x430266,'language':_0x348ff5,'rooms_data':_0x169189});})[_0x451cae(0x1fd)](_0x315c57=>{var _0x109ec4=_0x451cae;_0x125b05[_0x109ec4(0x1f2)](_0x109ec4(0x18e),_0x109ec4(0x233)),_0x2729e1['redirect'](_0x109ec4(0x1f4));});}catch(_0x1f4eb6){console['log'](_0x1f4eb6);}}),router[a0_0x2b3417(0x17f)](a0_0x2b3417(0x211),auth,async(_0x5d374d,_0x3e787f)=>{var _0xd3875=a0_0x2b3417;try{const _0x42f5d6=_0x5d374d[_0xd3875(0x17e)]['id'];console[_0xd3875(0x204)](_0x42f5d6);const _0x34fa85=await product[_0xd3875(0x21a)](),_0x14f74b=await purchases[_0xd3875(0x1c0)]([{'$match':{'warehouse_name':_0x42f5d6}},{'$unwind':_0xd3875(0x1b7)},{'$group':{'_id':_0xd3875(0x1a5)}}]);console[_0xd3875(0x204)](_0xd3875(0x182),_0x14f74b),_0x3e787f[_0xd3875(0x235)](0xc8)[_0xd3875(0x1ec)]({'purchases_data':_0x14f74b,'product_data':_0x34fa85});}catch(_0x27cba0){console[_0xd3875(0x204)](_0x27cba0);}}),router[a0_0x2b3417(0x178)](a0_0x2b3417(0x22f),auth,async(_0x37530d,_0x185492)=>{var _0x1822ab=a0_0x2b3417;try{const {warehouse_data:_0x56d1cb,product_data:_0x5d738f}=_0x37530d[_0x1822ab(0x19c)];console[_0x1822ab(0x204)](_0x37530d[_0x1822ab(0x19c)][_0x1822ab(0x167)]);;const _0x5cf0ed=await master_shop[_0x1822ab(0x21a)]();console[_0x1822ab(0x204)](_0x1822ab(0x23b),_0x5cf0ed);const _0x3ff9f5=await product['findOne']({'name':_0x5d738f});console[_0x1822ab(0x204)](_0x1822ab(0x1aa),_0x3ff9f5);const _0x14a661=await warehouse[_0x1822ab(0x1c0)]([{'$match':{'name':_0x56d1cb}},{'$unwind':_0x1822ab(0x217)},{'$match':{'product_details.product_name':_0x5d738f}},{'$group':{'_id':_0x1822ab(0x25a),'product_stock':{'$first':_0x1822ab(0x1ea)}}}]);console['log'](_0x1822ab(0x26d),_0x14a661),_0x185492[_0x1822ab(0x235)](0xc8)[_0x1822ab(0x1ec)]({'master':_0x5cf0ed,'new_product':_0x3ff9f5,'stock_data':_0x14a661});}catch(_0x515688){console[_0x1822ab(0x204)](_0x515688);}}),router[a0_0x2b3417(0x178)]('/view/add_sales',auth,async(_0x1af0df,_0x470eff)=>{var _0x4b64c4=a0_0x2b3417;try{const {invoice:_0x2f63a2,date:_0xc4403a,warehouse_name:_0x354348,product_name:_0x302a10,stock:_0x1b0f95,quantity:_0x1be53c,note:_0x288ce1,room:_0xae9f08,primary_code:_0x46a98b,secondary_code:_0x48d9b1,prod_code:_0xf008dc,level:_0x4a94a3,isle:_0x135d31,pallet:_0x2e43e5,batch_code:_0x39abc5,SCRN:_0x26ae9c,expiry_date:_0x1cd881,mode_transpo:_0x4be090,name_driver:_0x26d513}=_0x1af0df[_0x4b64c4(0x19c)];if(typeof _0x302a10=='string')var _0x11f584=[_0x1af0df['body'][_0x4b64c4(0x1f9)]],_0x43a33c=[_0x1af0df[_0x4b64c4(0x19c)]['stock']],_0xb0dffe=[_0x1af0df['body']['carton']],_0x39c095=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x263)]],_0x4aab5a=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x16b)]],_0x153cfe=[_0x1af0df['body']['prod_code']],_0x30d3eb=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x19d)]],_0x2b5fdd=[_0x1af0df[_0x4b64c4(0x19c)]['primary_unit']],_0x5cf400=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x187)]],_0x25bd51=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x18f)]],_0x293485=[_0x1af0df['body'][_0x4b64c4(0x269)]],_0x1465f4=[_0x1af0df[_0x4b64c4(0x19c)]['product_date']],_0x14b596=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x15e)]],_0xe8d30d=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x242)]],_0x24a292=[_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x264)]],_0x5408e2=[_0x1af0df[_0x4b64c4(0x19c)]['prod_invoice']],_0x527417=[_0x1af0df['body'][_0x4b64c4(0x179)]];else var _0x11f584=[..._0x1af0df['body'][_0x4b64c4(0x1f9)]],_0x43a33c=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x162)]],_0xb0dffe=[..._0x1af0df['body'][_0x4b64c4(0x256)]],_0x39c095=[..._0x1af0df['body'][_0x4b64c4(0x263)]],_0x4aab5a=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x16b)]],_0x153cfe=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x201)]],_0x30d3eb=[..._0x1af0df[_0x4b64c4(0x19c)]['level']],_0x2b5fdd=[..._0x1af0df['body']['primary_unit']],_0x5cf400=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x187)]],_0x25bd51=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x18f)]],_0x293485=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x269)]],_0x1465f4=[..._0x1af0df['body'][_0x4b64c4(0x177)]],_0x14b596=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x15e)]],_0xe8d30d=[..._0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x242)]],_0x24a292=[..._0x1af0df['body'][_0x4b64c4(0x264)]],_0x5408e2=[..._0x1af0df['body'][_0x4b64c4(0x245)]],_0x527417=[..._0x1af0df[_0x4b64c4(0x19c)]['id_transaction_from']];const _0x12e32d=_0x11f584[_0x4b64c4(0x1c8)](_0x715c0=>{return _0x715c0={'product_name':_0x715c0};});_0x43a33c[_0x4b64c4(0x215)]((_0x30e0c2,_0x2f5595)=>{var _0x2b086d=_0x4b64c4;_0x12e32d[_0x2f5595][_0x2b086d(0x162)]=_0x30e0c2;}),_0xb0dffe[_0x4b64c4(0x215)]((_0x17c8ce,_0x163abc)=>{var _0x24f81f=_0x4b64c4;_0x12e32d[_0x163abc][_0x24f81f(0x1d5)]=Math[_0x24f81f(0x1f5)](_0x17c8ce);}),_0x527417['forEach']((_0x491d52,_0x2bd8ee)=>{var _0x359a14=_0x4b64c4;_0x12e32d[_0x2bd8ee][_0x359a14(0x179)]=_0x491d52;}),_0x39c095['forEach']((_0x11e40c,_0x32dbc0)=>{var _0x317b6f=_0x4b64c4;_0x12e32d[_0x32dbc0][_0x317b6f(0x263)]=_0x11e40c;}),_0x4aab5a[_0x4b64c4(0x215)]((_0x33a2f4,_0x14b5c3)=>{var _0x3755b6=_0x4b64c4;_0x12e32d[_0x14b5c3][_0x3755b6(0x16b)]=_0x33a2f4;}),_0x153cfe[_0x4b64c4(0x215)]((_0x135724,_0xbcd2d0)=>{var _0xedb28c=_0x4b64c4;_0x12e32d[_0xbcd2d0][_0xedb28c(0x232)]=_0x135724;}),_0x30d3eb[_0x4b64c4(0x215)]((_0x291191,_0x5d14ed)=>{var _0x5b3a22=_0x4b64c4;_0x12e32d[_0x5d14ed][_0x5b3a22(0x251)]=_0x291191;}),_0x2b5fdd[_0x4b64c4(0x215)]((_0x48f57d,_0x39afd5)=>{var _0x2bb04b=_0x4b64c4;_0x12e32d[_0x39afd5][_0x2bb04b(0x1b0)]=_0x48f57d;}),_0x5cf400[_0x4b64c4(0x215)]((_0x5cc16c,_0x52796b)=>{var _0x1f4260=_0x4b64c4;_0x12e32d[_0x52796b][_0x1f4260(0x187)]=_0x5cc16c;}),_0x25bd51[_0x4b64c4(0x215)]((_0x384089,_0x366cd1)=>{var _0x16086f=_0x4b64c4;_0x12e32d[_0x366cd1][_0x16086f(0x18f)]=_0x384089;}),_0x293485[_0x4b64c4(0x215)]((_0x366c4b,_0x522365)=>{var _0xff88e5=_0x4b64c4;_0x12e32d[_0x522365][_0xff88e5(0x269)]=_0x366c4b;}),_0x1465f4[_0x4b64c4(0x215)]((_0x37a16c,_0x77e5eb)=>{_0x12e32d[_0x77e5eb]['production_date']=_0x37a16c;}),_0x14b596[_0x4b64c4(0x215)]((_0x2c8a80,_0x20884e)=>{var _0x360778=_0x4b64c4;_0x12e32d[_0x20884e][_0x360778(0x23c)]=_0x2c8a80;}),_0xe8d30d[_0x4b64c4(0x215)]((_0x4da4af,_0x586619)=>{var _0x146191=_0x4b64c4;_0x12e32d[_0x586619][_0x146191(0x242)]=_0x4da4af;}),_0x24a292[_0x4b64c4(0x215)]((_0x17a68c,_0x16791e)=>{_0x12e32d[_0x16791e]['room_name']=_0x17a68c;}),_0x5408e2[_0x4b64c4(0x215)]((_0x57bd2f,_0x1b5c3d)=>{_0x12e32d[_0x1b5c3d]['invoice']=_0x57bd2f;});var _0x35bb69=0x0;_0x12e32d[_0x4b64c4(0x215)](_0x4a2801=>{var _0x267b1e=_0x4b64c4;parseFloat(_0x4a2801[_0x267b1e(0x162)])<parseFloat(_0x4a2801[_0x267b1e(0x1d5)])&&parseFloat(_0x4a2801[_0x267b1e(0x1d5)])>parseFloat(_0x4a2801[_0x267b1e(0x162)])&&(console[_0x267b1e(0x204)](_0x4a2801[_0x267b1e(0x162)]+_0x267b1e(0x1fb)+_0x4a2801[_0x267b1e(0x1d5)]),_0x35bb69++);});if(_0x35bb69!=0x0)return _0x1af0df[_0x4b64c4(0x1f2)]('errors',_0x4b64c4(0x200)),_0x470eff['redirect']('back');const _0x38f806=_0x12e32d[_0x4b64c4(0x1f6)](_0x588102=>_0x588102[_0x4b64c4(0x1d5)]!=='0'&&_0x588102['quantity']!==''),_0x459d74=new sales_finished({'invoice':_0x2f63a2,'customer':_0x1af0df['body'][_0x4b64c4(0x207)],'date':_0xc4403a,'warehouse_name':_0x354348,'sale_product':_0x38f806,'note':_0x288ce1,'room':_0xae9f08,'primary_code':_0x46a98b,'secondary_code':_0x48d9b1,'prod_code':_0xf008dc,'SCRN':_0x26ae9c,'finalize':_0x4b64c4(0x15f),'mode_transpo':_0x4be090,'name_driver':_0x26d513}),_0x3b7b31=await _0x459d74[_0x4b64c4(0x202)](),_0x53878b=await sales_finished[_0x4b64c4(0x24c)]({'invoice':_0x2f63a2}),_0x5922de=new c_payment_data({'invoice':_0x2f63a2,'customer':_0x1af0df[_0x4b64c4(0x19c)]['customer'],'reason':_0x4b64c4(0x1c2)});await _0x5922de['save']();const _0x231ae2=await master_shop[_0x4b64c4(0x21a)](),_0x1f8a38=await email_settings[_0x4b64c4(0x24c)](),_0x4c9019=await customer[_0x4b64c4(0x24c)]({'name':_0x1af0df[_0x4b64c4(0x19c)][_0x4b64c4(0x207)]});_0x231ae2[0x0][_0x4b64c4(0x19f)]==0x1?(right_currency=_0x231ae2[0x0][_0x4b64c4(0x1ae)],left_currency=''):(right_currency='',left_currency=_0x231ae2[0x0][_0x4b64c4(0x1ae)]);var _0x1ece7c=_0x11f584,_0x3b92a1=_0xb0dffe,_0x20da75='',_0x788750;for(_0x788750 in _0x1ece7c){_0x20da75+='<tr>'+_0x4b64c4(0x1c4)+_0x1ece7c[_0x788750]+'</td>'+_0x4b64c4(0x1c4)+_0x3b92a1[_0x788750]+'</td>'+'</tr>';}console['log'](_0x4b64c4(0x26c),_0x20da75),_0x1af0df[_0x4b64c4(0x1f2)](_0x4b64c4(0x1b2),_0x4b64c4(0x248)),_0x470eff['redirect'](_0x4b64c4(0x24a)+_0x3b7b31[_0x4b64c4(0x1e6)]);}catch(_0x22d726){console[_0x4b64c4(0x204)](_0x22d726);}}),router[a0_0x2b3417(0x17f)](a0_0x2b3417(0x225),auth,async(_0x561a7d,_0x550106)=>{var _0x3f3870=a0_0x2b3417;try{const {username:_0x26e501,email:_0x316ba6,role:_0x1c28ba}=_0x561a7d['user'],_0x353bfa=_0x561a7d[_0x3f3870(0x1d6)],_0x193c6e=await profile[_0x3f3870(0x24c)]({'email':_0x353bfa[_0x3f3870(0x196)]}),_0xc0509e=await master_shop[_0x3f3870(0x21a)](),_0x13294e=_0x561a7d[_0x3f3870(0x17e)]['id'],_0x17c009=await sales_finished['findById'](_0x13294e),_0x5d1017=await warehouse[_0x3f3870(0x1c0)]([{'$match':{'name':_0x17c009['warehouse_name']}},{'$unwind':_0x3f3870(0x217)},{'$group':{'_id':_0x3f3870(0x1ad),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3f3870(0x1fc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3f3870(0x15d)},'floorlevel':{'$first':_0x3f3870(0x184)},'primary_code':{'$first':_0x3f3870(0x1a0)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3f3870(0x1cd)},'rack':{'$first':_0x3f3870(0x261)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3f3870(0x1ff)},'batch_code':{'$first':_0x3f3870(0x1d0)},'room':{'$first':_0x3f3870(0x212)},'room_data':{'$first':'$product_details.room_name'}}}]),_0x8f7ca5=await customer[_0x3f3870(0x21a)]({});let _0x4727a5;if(_0x353bfa[_0x3f3870(0x258)]=='staff'){const _0x404b31=await staff[_0x3f3870(0x24c)]({'email':_0x353bfa[_0x3f3870(0x196)]});_0x4727a5=await warehouse[_0x3f3870(0x1c0)]([{'$match':{'status':_0x3f3870(0x24e),'name':_0x404b31[_0x3f3870(0x1bb)]}},{'$group':{'_id':_0x3f3870(0x1ed),'name':{'$first':_0x3f3870(0x1ed)}}}]);}else _0x4727a5=await warehouse['aggregate']([{'$match':{'status':_0x3f3870(0x24e)}},{'$group':{'_id':_0x3f3870(0x1ed),'name':{'$first':'$name'}}}]);const _0x163372=await product['find']({});if(_0xc0509e[0x0][_0x3f3870(0x1e4)]==_0x3f3870(0x193)){var _0x15b2ce=users[_0x3f3870(0x1a3)];console[_0x3f3870(0x204)](_0x15b2ce);}else{if(_0xc0509e[0x0]['language']=='Hindi')var _0x15b2ce=users[_0x3f3870(0x1c3)];else{if(_0xc0509e[0x0]['language']==_0x3f3870(0x227))var _0x15b2ce=users['German'];else{if(_0xc0509e[0x0][_0x3f3870(0x1e4)]==_0x3f3870(0x1c6))var _0x15b2ce=users['Spanish'];else{if(_0xc0509e[0x0][_0x3f3870(0x1e4)]==_0x3f3870(0x17a))var _0x15b2ce=users['French'];else{if(_0xc0509e[0x0][_0x3f3870(0x1e4)]==_0x3f3870(0x1bd))var _0x15b2ce=users[_0x3f3870(0x240)];else{if(_0xc0509e[0x0][_0x3f3870(0x1e4)]==_0x3f3870(0x260))var _0x15b2ce=users['Chinese'];else{if(_0xc0509e[0x0][_0x3f3870(0x1e4)]==_0x3f3870(0x1eb))var _0x15b2ce=users['Arabic'];}}}}}}}_0x550106[_0x3f3870(0x267)](_0x3f3870(0x203),{'success':_0x561a7d[_0x3f3870(0x1f2)]('success'),'errors':_0x561a7d[_0x3f3870(0x1f2)](_0x3f3870(0x18e)),'role':_0x353bfa,'profile':_0x193c6e,'customer':_0x8f7ca5,'warehouse':_0x4727a5,'product':_0x5d1017,'user':_0x17c009,'master_shop':_0xc0509e,'unit':_0x163372,'language':_0x15b2ce});}catch(_0x2fc9f6){console['log'](_0x2fc9f6);}}),router[a0_0x2b3417(0x178)](a0_0x2b3417(0x225),auth,async(_0x44ed33,_0x2025c8)=>{var _0x12d943=a0_0x2b3417;try{const _0x3f7f57=_0x44ed33[_0x12d943(0x17e)]['id'],{invoice:_0x310cad,warehouse_name:_0x36f948,room:_0x4eb9a2}=_0x44ed33[_0x12d943(0x19c)],_0x4d4366=await sales_finished['findOne']({'invoice':_0x310cad}),_0x4c6143=_0x4d4366[_0x12d943(0x19e)]['map'](async _0x5d5add=>{var _0x4e9666=_0x12d943,_0x4c6bc4=await warehouse[_0x4e9666(0x24c)]({'name':_0x36f948,'room':_0x5d5add[_0x4e9666(0x1ef)],'warehouse_category':'Finished\x20Goods'});const _0x283bd9=_0x4c6bc4[_0x4e9666(0x266)][_0x4e9666(0x1c8)](_0x5dc9d7=>{var _0x11113b=_0x4e9666;_0x5dc9d7['product_name']==_0x5d5add[_0x11113b(0x1f9)]&&_0x5dc9d7[_0x11113b(0x251)]==_0x5d5add['bay']&&_0x5dc9d7[_0x11113b(0x269)]==_0x5d5add['expiry_date']&&_0x5dc9d7[_0x11113b(0x1e7)]==_0x5d5add[_0x11113b(0x1e7)]&&_0x5dc9d7[_0x11113b(0x18f)]==_0x5d5add[_0x11113b(0x18f)]&&_0x5dc9d7[_0x11113b(0x1e6)]==_0x5d5add['id_transaction_from']&&(_0x5dc9d7[_0x11113b(0x255)]>0x0&&(console[_0x11113b(0x204)](_0x5dc9d7['product_name']+'\x20==\x20'+_0x5d5add[_0x11113b(0x1f9)]+'\x20&&\x20'+_0x5dc9d7[_0x11113b(0x251)]+_0x11113b(0x223)+_0x5d5add[_0x11113b(0x251)]+_0x11113b(0x1f3)+_0x5dc9d7['production_date']+_0x11113b(0x223)+_0x5d5add[_0x11113b(0x1e7)]+_0x11113b(0x1f3)+_0x5dc9d7[_0x11113b(0x269)]+'\x20==\x20'+_0x5d5add[_0x11113b(0x269)]+_0x11113b(0x1f3)+_0x5dc9d7[_0x11113b(0x18f)]+_0x11113b(0x223)+_0x5d5add[_0x11113b(0x18f)]+'\x20&&\x20'+_0x5dc9d7['invoice']+_0x11113b(0x223)+_0x5d5add[_0x11113b(0x244)]+_0x11113b(0x1f3)+_0x5dc9d7[_0x11113b(0x255)]+_0x11113b(0x25b)+_0x5d5add['quantity']+_0x11113b(0x26b)+_0x5d5add['room_name']+_0x11113b(0x1f3)+_0x5dc9d7[_0x11113b(0x1e6)]+_0x11113b(0x223)+_0x5d5add[_0x11113b(0x179)]),_0x5dc9d7[_0x11113b(0x255)]=Math[_0x11113b(0x23e)](0x0,Math['abs'](_0x5dc9d7[_0x11113b(0x255)])-Math['abs'](_0x5d5add[_0x11113b(0x1d5)]))));});return _0x4c6bc4;});Promise[_0x12d943(0x25f)](_0x4c6143)[_0x12d943(0x195)](async _0x2b50f8=>{var _0x4cff05=_0x12d943;try{for(const _0x138d37 of _0x2b50f8){await _0x138d37[_0x4cff05(0x202)]();}_0x4d4366[_0x4cff05(0x229)]=_0x4cff05(0x186);const _0x8db771=await _0x4d4366[_0x4cff05(0x202)](),_0x4c5f29=await master_shop[_0x4cff05(0x21a)](),_0x55c4fc=await email_settings[_0x4cff05(0x24c)](),_0x3eb35c=await supervisor_settings['find']();var _0x403622=_0x4d4366[_0x4cff05(0x19e)],_0x25f261='',_0x450a71;for(_0x450a71 in _0x403622){var _0x5df107='FG';_0x4d4366[_0x4cff05(0x250)]=='DRY\x20GOODS'&&(_0x5df107='DG'),_0x25f261+=_0x4cff05(0x1e3)+_0x4cff05(0x1c4)+_0x403622[_0x450a71]['product_name']+'</td>'+_0x4cff05(0x1c4)+_0x403622[_0x450a71][_0x4cff05(0x232)]+_0x4cff05(0x169)+_0x4cff05(0x1c4)+_0x403622[_0x450a71][_0x4cff05(0x1d5)]+_0x4cff05(0x169)+_0x4cff05(0x1c4)+_0x403622[_0x450a71][_0x4cff05(0x1b0)]+_0x4cff05(0x169)+_0x4cff05(0x1c4)+_0x403622[_0x450a71]['secondary_unit']+'</td>'+_0x4cff05(0x1c4)+_0x4d4366[_0x4cff05(0x250)]+_0x4cff05(0x169)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x403622[_0x450a71][_0x4cff05(0x1ef)]+_0x4cff05(0x169)+_0x4cff05(0x1c4)+_0x5df107+_0x403622[_0x450a71][_0x4cff05(0x251)]+_0x4cff05(0x169);}let _0x4ae865=nodemailer[_0x4cff05(0x1ca)]({'host':_0x55c4fc['host'],'port':Number(_0x55c4fc['port']),'secure':![],'auth':{'user':_0x55c4fc[_0x4cff05(0x196)],'pass':_0x55c4fc[_0x4cff05(0x239)]}}),_0x55c65c={'from':_0x55c4fc['email'],'to':_0x3eb35c[0x0][_0x4cff05(0x268)],'subject':_0x4cff05(0x18a),'attachments':[{'filename':_0x4cff05(0x1a6),'path':__dirname+_0x4cff05(0x15b)+'/upload/'+_0x4c5f29[0x0][_0x4cff05(0x1e8)],'cid':_0x4cff05(0x252)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x4cff05(0x1be)+'<div>'+_0x4cff05(0x241)+'<div>'+_0x4cff05(0x17b)+_0x4cff05(0x1a7)+'<div>'+'<h2>\x20'+_0x4c5f29[0x0]['site_title']+'\x20</h2>'+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x4d4366[_0x4cff05(0x244)]+'\x20'+_0x4cff05(0x18d)+_0x4cff05(0x165)+_0x4d4366['date']+'\x20'+'</span>'+_0x4cff05(0x1f8)+_0x4cff05(0x1a7)+_0x4cff05(0x21f)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4cff05(0x1e3)+_0x4cff05(0x20a)+_0x4cff05(0x1a9)+_0x4cff05(0x209)+_0x4cff05(0x20b)+_0x4cff05(0x1cc)+_0x4cff05(0x20d)+_0x4cff05(0x198)+_0x4cff05(0x234)+_0x4cff05(0x1ee)+_0x4cff05(0x218)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x25f261+'\x20'+'</tbody>'+_0x4cff05(0x19a)+_0x4cff05(0x16c)+_0x4cff05(0x270)+'<h5>'+_0x4c5f29[0x0][_0x4cff05(0x18c)]+_0x4cff05(0x1f8)+_0x4cff05(0x1a7)+_0x4cff05(0x1a7)+'</body></html>'};_0x4ae865[_0x4cff05(0x19b)](_0x55c65c,function(_0x59f792,_0x195785){var _0x41c72d=_0x4cff05;_0x59f792?(console['log'](_0x59f792),console[_0x41c72d(0x204)]('Error\x20Occurs')):console[_0x41c72d(0x204)](_0x41c72d(0x238));}),_0x44ed33[_0x4cff05(0x1f2)]('success','Sales\x20Update\x20successfully'),_0x2025c8[_0x4cff05(0x183)](_0x4cff05(0x164)+_0x3f7f57);}catch(_0x235181){console['error'](_0x235181),_0x2025c8[_0x4cff05(0x235)](0x1f4)['json']({'error':_0x4cff05(0x220)});}})[_0x12d943(0x1fd)](_0x321edc=>{var _0x7e34f3=_0x12d943;console[_0x7e34f3(0x237)](_0x321edc),_0x2025c8[_0x7e34f3(0x235)](0x1f4)[_0x7e34f3(0x1ec)]({'error':_0x7e34f3(0x21b)});});}catch(_0x417c84){console[_0x12d943(0x204)](_0x417c84);}}),router[a0_0x2b3417(0x17f)](a0_0x2b3417(0x25d),auth,async(_0x2a7444,_0x78d021)=>{var _0xc9cf1f=a0_0x2b3417;try{const {username:_0x1c46d7,email:_0x11a23d,role:_0x222a2e}=_0x2a7444[_0xc9cf1f(0x1d6)],_0x51ea1c=_0x2a7444[_0xc9cf1f(0x1d6)],_0x216cb4=await profile['findOne']({'email':_0x51ea1c['email']}),_0x42feb9=await master_shop[_0xc9cf1f(0x21a)](),_0x5c6d84=_0x2a7444['params']['id'],_0x594706=await sales_finished[_0xc9cf1f(0x1de)](_0x5c6d84);let _0x556333=new Date(_0x594706[_0xc9cf1f(0x269)]),_0x3b7d38=('0'+_0x556333['getDate']())['slice'](-0x2),_0x3c1973=('0'+(_0x556333[_0xc9cf1f(0x166)]()+0x1))['slice'](-0x2),_0x4bffc0=_0x556333[_0xc9cf1f(0x231)](),_0x258990=_0x4bffc0+'-'+_0x3c1973+'-'+_0x3b7d38;var _0x532513=[_0xc9cf1f(0x22d),_0xc9cf1f(0x1e5)];const _0x19b4c9=await warehouse['aggregate']([{'$match':{'name':_0x594706[_0xc9cf1f(0x250)],'room':_0x594706[_0xc9cf1f(0x16f)]}},{'$unwind':_0xc9cf1f(0x217)},{'$group':{'_id':_0xc9cf1f(0x1ad),'name':{'$first':_0xc9cf1f(0x25a)},'product_stock':{'$first':_0xc9cf1f(0x1ea)},'bay':{'$first':_0xc9cf1f(0x1fc)},'bin':{'$first':_0xc9cf1f(0x16e)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xc9cf1f(0x230)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xc9cf1f(0x1cd)},'rack':{'$first':_0xc9cf1f(0x261)}}}]),_0x1ecab4=await customer['find']({});let _0x1dbb19;if(_0x51ea1c[_0xc9cf1f(0x258)]==_0xc9cf1f(0x17c)){const _0x3d29c3=await staff[_0xc9cf1f(0x24c)]({'email':_0x51ea1c['email']});_0x1dbb19=await warehouse[_0xc9cf1f(0x1c0)]([{'$match':{'status':_0xc9cf1f(0x24e),'name':_0x3d29c3[_0xc9cf1f(0x1bb)]}},{'$group':{'_id':_0xc9cf1f(0x1ed),'name':{'$first':'$name'}}}]);}else _0x1dbb19=await warehouse[_0xc9cf1f(0x1c0)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0xc9cf1f(0x1ed),'name':{'$first':_0xc9cf1f(0x1ed)}}}]);const _0x3009d2=await product[_0xc9cf1f(0x21a)]({});if(_0x42feb9[0x0][_0xc9cf1f(0x1e4)]==_0xc9cf1f(0x193)){var _0x503640=users[_0xc9cf1f(0x1a3)];console[_0xc9cf1f(0x204)](_0x503640);}else{if(_0x42feb9[0x0][_0xc9cf1f(0x1e4)]==_0xc9cf1f(0x1c3))var _0x503640=users[_0xc9cf1f(0x1c3)];else{if(_0x42feb9[0x0][_0xc9cf1f(0x1e4)]==_0xc9cf1f(0x227))var _0x503640=users[_0xc9cf1f(0x227)];else{if(_0x42feb9[0x0][_0xc9cf1f(0x1e4)]=='Spanish')var _0x503640=users[_0xc9cf1f(0x1c6)];else{if(_0x42feb9[0x0]['language']==_0xc9cf1f(0x17a))var _0x503640=users[_0xc9cf1f(0x17a)];else{if(_0x42feb9[0x0][_0xc9cf1f(0x1e4)]=='Portuguese\x20(BR)')var _0x503640=users['Portuguese'];else{if(_0x42feb9[0x0]['language']==_0xc9cf1f(0x260))var _0x503640=users[_0xc9cf1f(0x260)];else{if(_0x42feb9[0x0][_0xc9cf1f(0x1e4)]=='Arabic\x20(ae)')var _0x503640=users[_0xc9cf1f(0x24d)];}}}}}}}_0x78d021['render']('edit_sales_finished',{'success':_0x2a7444[_0xc9cf1f(0x1f2)](_0xc9cf1f(0x1b2)),'errors':_0x2a7444['flash'](_0xc9cf1f(0x18e)),'role':_0x51ea1c,'profile':_0x216cb4,'customer':_0x1ecab4,'warehouse':_0x1dbb19,'product':_0x19b4c9,'user':_0x594706,'master_shop':_0x42feb9,'unit':_0x3009d2,'language':_0x503640,'rooms_data':_0x532513,'ed_fullDate':_0x258990});}catch(_0x19e9a3){console[_0xc9cf1f(0x204)](_0x19e9a3);}}),router[a0_0x2b3417(0x178)](a0_0x2b3417(0x25d),auth,async(_0x276d10,_0x35c9d7)=>{var _0xba6c45=a0_0x2b3417;try{const _0x5189cf=_0x276d10[_0xba6c45(0x17e)]['id'],_0x425d30=await sales_finished['findOne']({'_id':_0x276d10['params']['id']}),_0x40dfc5=await warehouse[_0xba6c45(0x24c)]({'name':_0x425d30[_0xba6c45(0x250)],'room':_0x276d10['body'][_0xba6c45(0x16f)],'warehouse_category':_0xba6c45(0x1a8)}),{invoice:_0x475fab,customer:_0x20b8a7,date:_0x418647,warehouse_name:_0x25ba48,product_name:_0x4598a1,stock:_0x65f428,adjust_qty:_0x1edaa1,note:_0x165d52,room:_0x4949e1,primary_code:_0x5d6c95,secondary_code:_0x9c5f17,prod_code:_0x640057,level:_0x30dbe9,isle:_0x157840,pallet:_0x163ece,expiry_date:_0x70b5b3}=_0x276d10[_0xba6c45(0x19c)];if(typeof _0x4598a1=='string')var _0x5441a8=[_0x276d10[_0xba6c45(0x19c)][_0xba6c45(0x1f9)]],_0x208363=[_0x276d10[_0xba6c45(0x19c)]['stock']],_0x4c379c=[_0x276d10['body']['adjust_qty']],_0x142d70=[_0x276d10['body'][_0xba6c45(0x263)]],_0x536645=[_0x276d10['body'][_0xba6c45(0x16b)]],_0x5bea83=[_0x276d10[_0xba6c45(0x19c)][_0xba6c45(0x201)]],_0x35be43=[_0x276d10[_0xba6c45(0x19c)]['level']],_0x236470=[_0x276d10[_0xba6c45(0x19c)][_0xba6c45(0x269)]];else var _0x5441a8=[..._0x276d10[_0xba6c45(0x19c)]['product_name']],_0x208363=[..._0x276d10[_0xba6c45(0x19c)][_0xba6c45(0x162)]],_0x4c379c=[..._0x276d10['body'][_0xba6c45(0x1d2)]],_0x142d70=[..._0x276d10[_0xba6c45(0x19c)][_0xba6c45(0x263)]],_0x536645=[..._0x276d10['body']['secondary_code']],_0x5bea83=[..._0x276d10[_0xba6c45(0x19c)]['prod_code']],_0x35be43=[..._0x276d10[_0xba6c45(0x19c)][_0xba6c45(0x19d)]],_0x236470=[..._0x276d10[_0xba6c45(0x19c)][_0xba6c45(0x269)]];const _0x144021=_0x5441a8[_0xba6c45(0x1c8)](_0x48ae79=>{return _0x48ae79={'product_name':_0x48ae79};});_0x208363['forEach']((_0x194437,_0xf5c27b)=>{_0x144021[_0xf5c27b]['stock']=_0x194437;}),_0x4c379c[_0xba6c45(0x215)]((_0x4bd19d,_0x1fbd4a)=>{var _0xb180c0=_0xba6c45;_0x144021[_0x1fbd4a][_0xb180c0(0x1d5)]=_0x4bd19d;}),_0x142d70[_0xba6c45(0x215)]((_0x67a396,_0x43f8f3)=>{_0x144021[_0x43f8f3]['primary_code']=_0x67a396;}),_0x536645['forEach']((_0x51aedb,_0x34caa8)=>{var _0x5ba4be=_0xba6c45;_0x144021[_0x34caa8][_0x5ba4be(0x16b)]=_0x51aedb;}),_0x5bea83['forEach']((_0x34173f,_0x2132da)=>{var _0x10e887=_0xba6c45;_0x144021[_0x2132da][_0x10e887(0x232)]=_0x34173f;}),_0x35be43[_0xba6c45(0x215)]((_0x7700ac,_0x11b4b0)=>{var _0x35947f=_0xba6c45;_0x144021[_0x11b4b0][_0x35947f(0x19d)]=_0x7700ac;}),_0x236470[_0xba6c45(0x215)]((_0x1ef6eb,_0x3ab8f2)=>{_0x144021[_0x3ab8f2]['expiry_date']=_0x1ef6eb;});var _0x428513=0x0;_0x144021[_0xba6c45(0x215)](_0x28e7ea=>{var _0x2378c7=_0xba6c45;console[_0x2378c7(0x204)](_0x2378c7(0x1fa),_0x28e7ea),(parseInt(_0x28e7ea[_0x2378c7(0x162)])<parseInt(_0x28e7ea[_0x2378c7(0x1d5)])||parseInt(_0x28e7ea[_0x2378c7(0x1d5)])==0x0)&&_0x428513++;});if(_0x428513!=0x0)return _0x276d10[_0xba6c45(0x1f2)](_0xba6c45(0x18e),_0xba6c45(0x194)),_0x35c9d7[_0xba6c45(0x183)](_0xba6c45(0x1b1));_0x425d30[_0xba6c45(0x19e)][_0xba6c45(0x215)](_0x4b05e8=>{var _0x57981a=_0xba6c45;const _0x4d3e39=_0x40dfc5[_0x57981a(0x266)][_0x57981a(0x1c8)](_0x5573b6=>{var _0x25becd=_0x57981a;_0x5573b6[_0x25becd(0x1f9)]==_0x4b05e8[_0x25becd(0x1f9)]&&_0x5573b6[_0x25becd(0x251)]==_0x4b05e8[_0x25becd(0x251)]&&(_0x5573b6[_0x25becd(0x255)]=parseInt(_0x5573b6['product_stock'])+parseInt(_0x4b05e8[_0x25becd(0x1d5)]));});}),await _0x40dfc5[_0xba6c45(0x202)]();const _0x52a118=_0x144021[_0xba6c45(0x1f6)](_0x543005=>_0x543005[_0xba6c45(0x1d5)]!=='0'&&_0x543005[_0xba6c45(0x1d5)]!=='');_0x425d30[_0xba6c45(0x244)]=_0x475fab,_0x425d30['customer']=_0x20b8a7,_0x425d30[_0xba6c45(0x214)]=_0x418647,_0x425d30[_0xba6c45(0x250)]=_0x25ba48,_0x425d30['sale_product']=_0x52a118,_0x425d30['note']=_0x165d52,_0x425d30[_0xba6c45(0x16f)]=_0x4949e1;const _0x3e9cad=await _0x425d30['save'](),_0x4a1f47=await sales_finished[_0xba6c45(0x24c)]({'_id':_0x276d10[_0xba6c45(0x17e)]['id']}),_0x50c01b=await warehouse[_0xba6c45(0x24c)]({'name':_0x25ba48,'room':_0x4949e1,'warehouse_category':_0xba6c45(0x1a8)});_0x4a1f47[_0xba6c45(0x19e)][_0xba6c45(0x215)](_0xd87ca3=>{var _0x200d57=_0xba6c45;const _0x91cb98=_0x50c01b[_0x200d57(0x266)]['map'](_0x1f86e6=>{var _0x1a113b=_0x200d57;_0x1f86e6[_0x1a113b(0x1f9)]==_0xd87ca3[_0x1a113b(0x1f9)]&&_0x1f86e6[_0x1a113b(0x251)]==_0xd87ca3[_0x1a113b(0x251)]&&(_0x1f86e6[_0x1a113b(0x255)]=parseInt(_0x1f86e6['product_stock'])-parseInt(_0xd87ca3[_0x1a113b(0x1d5)]));});}),console['log'](_0xba6c45(0x1ce),_0x50c01b),await _0x50c01b[_0xba6c45(0x202)]();const _0x2b4a25=await c_payment_data['findOne']({'invoice':_0x276d10['body']['invoice']});_0x2b4a25[_0xba6c45(0x192)]=_0x276d10[_0xba6c45(0x19c)]['suppliers'],await _0x2b4a25['save'](),_0x276d10['flash'](_0xba6c45(0x1b2),_0xba6c45(0x197)),_0x35c9d7[_0xba6c45(0x183)](_0xba6c45(0x1f4));}catch(_0x141417){console['log'](_0x141417);}}),router[a0_0x2b3417(0x178)]('/give_payment/:id',auth,async(_0x29d9a9,_0x3ce3e5)=>{var _0x145f80=a0_0x2b3417;try{const _0x4654a5=_0x29d9a9[_0x145f80(0x17e)]['id'],{invoice:_0x4b12c0,customer:_0x2aba8f,receivable_amount:_0x221c71,received_amount:_0x31bfbe}=_0x29d9a9['body'],_0x94d7d=await sales['findById'](_0x4654a5);console[_0x145f80(0x204)](_0x94d7d);var _0x37c23b=_0x221c71-_0x31bfbe;console[_0x145f80(0x204)](_0x31bfbe),_0x94d7d[_0x145f80(0x22c)]=parseFloat(_0x31bfbe)+parseFloat(_0x94d7d[_0x145f80(0x22c)]),_0x94d7d[_0x145f80(0x1bf)]=_0x37c23b,console[_0x145f80(0x204)](_0x94d7d);const _0x739b75=await _0x94d7d[_0x145f80(0x202)](),_0x28f2ee=await c_payment_data['findOne']({'invoice':_0x4b12c0});_0x28f2ee[_0x145f80(0x185)]=_0x37c23b,await _0x28f2ee[_0x145f80(0x202)]();let _0x252e84=new Date(),_0x15c22e=('0'+_0x252e84['getDate']())[_0x145f80(0x26f)](-0x2),_0x499d8f=('0'+(_0x252e84['getMonth']()+0x1))[_0x145f80(0x26f)](-0x2),_0x807666=_0x252e84[_0x145f80(0x231)](),_0x7a63e4=_0x807666+'-'+_0x499d8f+'-'+_0x15c22e;const _0x88c780=new customer_payment({'invoice':_0x4b12c0,'date':_0x807666+'-'+_0x499d8f+'-'+_0x15c22e,'customer':_0x2aba8f,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x31bfbe}),_0x471c6f=await _0x88c780[_0x145f80(0x202)]();_0x29d9a9[_0x145f80(0x1f2)]('success',_0x145f80(0x1d4)),_0x3ce3e5['redirect'](_0x145f80(0x1f0));}catch(_0x250c29){console[_0x145f80(0x204)](_0x250c29);}}),router[a0_0x2b3417(0x17f)](a0_0x2b3417(0x23f),auth,async(_0x15d50e,_0x24070e)=>{var _0x54ef2f=a0_0x2b3417;try{const {username:_0x53dcec,email:_0xf3a035,role:_0x389db1}=_0x15d50e['user'],_0x22a80b=_0x15d50e[_0x54ef2f(0x1d6)],_0x521a21=await profile[_0x54ef2f(0x24c)]({'email':_0x22a80b[_0x54ef2f(0x196)]}),_0x2e741f=await master_shop[_0x54ef2f(0x21a)]();console[_0x54ef2f(0x204)](_0x54ef2f(0x23b),_0x2e741f);const _0x4333fe=_0x15d50e[_0x54ef2f(0x17e)]['id'],_0x125d4c=await sales['findById'](_0x4333fe);console[_0x54ef2f(0x204)](_0x125d4c);const _0x55a0e0=await customer[_0x54ef2f(0x24c)]({'name':_0x125d4c[_0x54ef2f(0x207)]});console['log'](_0x55a0e0);if(_0x2e741f[0x0]['language']==_0x54ef2f(0x193)){var _0x3816ee=users[_0x54ef2f(0x1a3)];console[_0x54ef2f(0x204)](_0x3816ee);}else{if(_0x2e741f[0x0][_0x54ef2f(0x1e4)]==_0x54ef2f(0x1c3))var _0x3816ee=users['Hindi'];else{if(_0x2e741f[0x0][_0x54ef2f(0x1e4)]==_0x54ef2f(0x227))var _0x3816ee=users[_0x54ef2f(0x227)];else{if(_0x2e741f[0x0]['language']==_0x54ef2f(0x1c6))var _0x3816ee=users[_0x54ef2f(0x1c6)];else{if(_0x2e741f[0x0][_0x54ef2f(0x1e4)]==_0x54ef2f(0x17a))var _0x3816ee=users['French'];else{if(_0x2e741f[0x0][_0x54ef2f(0x1e4)]==_0x54ef2f(0x1bd))var _0x3816ee=users[_0x54ef2f(0x240)];else{if(_0x2e741f[0x0][_0x54ef2f(0x1e4)]==_0x54ef2f(0x260))var _0x3816ee=users['Chinese'];else{if(_0x2e741f[0x0]['language']==_0x54ef2f(0x1eb))var _0x3816ee=users[_0x54ef2f(0x24d)];}}}}}}}_0x24070e['render']('sales_invoice',{'success':_0x15d50e[_0x54ef2f(0x1f2)]('success'),'errors':_0x15d50e[_0x54ef2f(0x1f2)]('errors'),'role':_0x22a80b,'profile':_0x521a21,'master_shop':_0x2e741f,'customers':_0x55a0e0,'sales':_0x125d4c,'language':_0x3816ee});}catch(_0x4e93ef){console[_0x54ef2f(0x204)](_0x4e93ef);}}),router[a0_0x2b3417(0x17f)](a0_0x2b3417(0x259),auth,async(_0x1f2428,_0x339d7b)=>{var _0x42e4cf=a0_0x2b3417;try{const {username:_0x4823f5,email:_0x6f9157,role:_0x1647df}=_0x1f2428[_0x42e4cf(0x1d6)],_0x3e8549=_0x1f2428[_0x42e4cf(0x1d6)],_0x488cf5=await profile['findOne']({'email':_0x3e8549['email']}),_0x2dd135=await master_shop['find'](),_0x8b47e7=_0x1f2428[_0x42e4cf(0x17e)]['id'],_0x281eb9=await sales_finished['findById'](_0x8b47e7),_0x26fca7=await warehouse[_0x42e4cf(0x1c0)]([{'$match':{'name':_0x281eb9['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x42e4cf(0x1ad),'name':{'$first':_0x42e4cf(0x25a)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x42e4cf(0x1fc)},'bin':{'$first':_0x42e4cf(0x16e)},'type':{'$first':_0x42e4cf(0x15d)},'floorlevel':{'$first':_0x42e4cf(0x184)},'primary_code':{'$first':_0x42e4cf(0x1a0)},'secondary_code':{'$first':_0x42e4cf(0x230)},'product_code':{'$first':_0x42e4cf(0x216)},'storage':{'$first':_0x42e4cf(0x1cd)},'rack':{'$first':_0x42e4cf(0x261)},'expiry_date':{'$first':_0x42e4cf(0x21c)},'production_date':{'$first':_0x42e4cf(0x1ff)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x42e4cf(0x1e9)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x42e4cf(0x1d1)}}}]),_0xb0dd57=await product[_0x42e4cf(0x21a)]({}),_0x987362=await warehouse[_0x42e4cf(0x1c0)]([{'$match':{'status':_0x42e4cf(0x24e),'warehouse_category':_0x42e4cf(0x1a8),'name':{'$ne':_0x42e4cf(0x1e1),'$ne':_0x42e4cf(0x226)}}},{'$group':{'_id':_0x42e4cf(0x1ed),'name':{'$first':_0x42e4cf(0x1ed)}}},{'$sort':{'name':0x1}}]);var _0x599ca8=['Return\x20Rooms'];const _0x18bbfe=await warehouse[_0x42e4cf(0x1c0)]([{'$match':{'status':_0x42e4cf(0x24e),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x42e4cf(0x1ed),'name':{'$first':_0x42e4cf(0x1ed)}}},{'$sort':{'name':0x1}}]);if(_0x2dd135[0x0][_0x42e4cf(0x1e4)]==_0x42e4cf(0x193)){var _0x4e22e1=users[_0x42e4cf(0x1a3)];console[_0x42e4cf(0x204)](_0x4e22e1);}else{if(_0x2dd135[0x0]['language']==_0x42e4cf(0x1c3))var _0x4e22e1=users['Hindi'];else{if(_0x2dd135[0x0]['language']=='German')var _0x4e22e1=users['German'];else{if(_0x2dd135[0x0][_0x42e4cf(0x1e4)]==_0x42e4cf(0x1c6))var _0x4e22e1=users[_0x42e4cf(0x1c6)];else{if(_0x2dd135[0x0]['language']=='French')var _0x4e22e1=users[_0x42e4cf(0x17a)];else{if(_0x2dd135[0x0][_0x42e4cf(0x1e4)]=='Portuguese\x20(BR)')var _0x4e22e1=users[_0x42e4cf(0x240)];else{if(_0x2dd135[0x0][_0x42e4cf(0x1e4)]=='Chinese')var _0x4e22e1=users[_0x42e4cf(0x260)];else{if(_0x2dd135[0x0][_0x42e4cf(0x1e4)]=='Arabic\x20(ae)')var _0x4e22e1=users['Arabic'];}}}}}}}_0x339d7b[_0x42e4cf(0x267)](_0x42e4cf(0x1f1),{'success':_0x1f2428['flash'](_0x42e4cf(0x1b2)),'errors':_0x1f2428[_0x42e4cf(0x1f2)](_0x42e4cf(0x18e)),'role':_0x3e8549,'profile':_0x488cf5,'user':_0x281eb9,'stock':_0x26fca7,'master_shop':_0x2dd135,'unit':_0xb0dd57,'language':_0x4e22e1,'warehouses':_0x987362,'rooms':_0x599ca8,'warehouse_QA':_0x18bbfe});}catch(_0x5006df){console['log'](_0x5006df),_0x339d7b[_0x42e4cf(0x235)](0xc8)[_0x42e4cf(0x1ec)]({'message':_0x5006df[_0x42e4cf(0x262)]});}}),router[a0_0x2b3417(0x178)](a0_0x2b3417(0x259),auth,async(_0x46bc38,_0x1a8944)=>{var _0x2352bd=a0_0x2b3417;if(_0x46bc38[_0x2352bd(0x19c)]['for_categorize']=='QA')try{const {invoice:_0x5aabe1,date:_0x1b88b4,warehouse_name:_0x3977ef,product_name:_0x258a0a,primary_code:_0x5da817,secondary_code:_0x371b13,product_code:_0xf92694,sales_quantity:_0x3d04ad,stocks:_0x32900f,return_qty:_0x54e9eb,Room_name:_0x4f412f,to_warehouse_name_QA:_0x437ff8,to_Room_name_QA:_0x3a2f1f,note:_0x185bd2,for_categorize:_0x59d689,product_name_QA1:_0x4b0e81}=_0x46bc38[_0x2352bd(0x19c)];if(typeof _0x4b0e81=='string')var _0x22d92a=[_0x46bc38[_0x2352bd(0x19c)]['product_name_QA1']],_0x50d5f1=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x16d)]],_0x2e01e4=[_0x46bc38['body'][_0x2352bd(0x199)]],_0x55548f=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1b3)]],_0x3a6f2e=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1b6)]],_0x18853d=[_0x46bc38[_0x2352bd(0x19c)]['stocks_QA']],_0xa6867e=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x206)]],_0x120101=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1bc)]],_0x571859=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1ac)]],_0xce2f66=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1af)]],_0x1b278e=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x188)]],_0x515318=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1cb)]],_0x3dd06b=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x21e)]],_0x3c347f=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x190)]];else var _0x22d92a=[..._0x46bc38[_0x2352bd(0x19c)]['product_name_QA1']],_0x50d5f1=[..._0x46bc38['body'][_0x2352bd(0x16d)]],_0x2e01e4=[..._0x46bc38['body'][_0x2352bd(0x199)]],_0x55548f=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1b3)]],_0x3a6f2e=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1b6)]],_0x18853d=[..._0x46bc38[_0x2352bd(0x19c)]['stocks_QA']],_0xa6867e=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x206)]],_0x120101=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1bc)]],_0x571859=[..._0x46bc38['body'][_0x2352bd(0x1ac)]],_0xce2f66=[..._0x46bc38['body'][_0x2352bd(0x1af)]],_0x1b278e=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x188)]],_0x515318=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1cb)]],_0x3dd06b=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x21e)]],_0x3c347f=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x190)]];const _0x8e9fc7=_0x22d92a[_0x2352bd(0x1c8)](_0x277111=>{return _0x277111={'product_name':_0x277111};});_0x50d5f1[_0x2352bd(0x215)]((_0x233f4b,_0x578d33)=>{var _0x57ded3=_0x2352bd;_0x8e9fc7[_0x578d33][_0x57ded3(0x263)]=_0x233f4b;}),_0x2e01e4[_0x2352bd(0x215)]((_0x467698,_0x1e6cc1)=>{_0x8e9fc7[_0x1e6cc1]['secondary_code']=_0x467698;}),_0x55548f[_0x2352bd(0x215)]((_0x4380bb,_0x5f1f67)=>{var _0x4a0d4e=_0x2352bd;_0x8e9fc7[_0x5f1f67][_0x4a0d4e(0x232)]=_0x4380bb;}),_0x3a6f2e['forEach']((_0xdb54d1,_0x144967)=>{var _0x26583a=_0x2352bd;_0x8e9fc7[_0x144967][_0x26583a(0x175)]=_0xdb54d1;}),_0x18853d['forEach']((_0x9c8e5d,_0xf20c55)=>{_0x8e9fc7[_0xf20c55]['stock']=_0x9c8e5d;}),_0xa6867e[_0x2352bd(0x215)]((_0x30c812,_0x53b315)=>{var _0x2efbaa=_0x2352bd;_0x8e9fc7[_0x53b315][_0x2efbaa(0x15c)]=_0x30c812;}),_0x120101['forEach']((_0x319ed0,_0x20b718)=>{var _0x3cc185=_0x2352bd;_0x8e9fc7[_0x20b718][_0x3cc185(0x172)]=_0x319ed0;}),_0x571859[_0x2352bd(0x215)]((_0x17c2a1,_0xc966e9)=>{var _0x172425=_0x2352bd;_0x8e9fc7[_0xc966e9][_0x172425(0x174)]=_0x17c2a1;}),_0xce2f66[_0x2352bd(0x215)]((_0x841cd0,_0x34cd0f)=>{var _0x10e26b=_0x2352bd;_0x8e9fc7[_0x34cd0f][_0x10e26b(0x18f)]=_0x841cd0;}),_0x1b278e['forEach']((_0x2c0cbb,_0x1bba65)=>{var _0xb839df=_0x2352bd;_0x8e9fc7[_0x1bba65][_0xb839df(0x187)]=_0x2c0cbb;}),_0x515318['forEach']((_0x305a3b,_0x17dd46)=>{var _0x1a9949=_0x2352bd;_0x8e9fc7[_0x17dd46][_0x1a9949(0x1b0)]=_0x305a3b;}),_0x3dd06b[_0x2352bd(0x215)]((_0x20e7bd,_0x486071)=>{var _0x4593d5=_0x2352bd;_0x8e9fc7[_0x486071][_0x4593d5(0x1e7)]=_0x20e7bd;}),_0x3c347f[_0x2352bd(0x215)]((_0x1292f5,_0x5bb894)=>{_0x8e9fc7[_0x5bb894]['expiry_date']=_0x1292f5;});const _0x3b92ec=await sales_finished[_0x2352bd(0x24c)]({'invoice':_0x5aabe1});_0x3b92ec['return_data']=_0x2352bd(0x186);const _0x4a15ea=await _0x3b92ec['save'](),_0x297275=new sales_return_finished({'invoice':_0x5aabe1,'customer':_0x46bc38[_0x2352bd(0x19c)]['customer'],'date':_0x1b88b4,'warehouse_name':_0x3977ef,'room':_0x4f412f,'ToWarehouse':_0x437ff8,'ToRoom':_0x3a2f1f,'return_sale_QA':_0x8e9fc7,'note':_0x185bd2,'warehouse_cat':_0x59d689}),_0x4377f4=await _0x297275[_0x2352bd(0x202)](),_0x4746c0=await sales_return_finished['findOne']({'invoice':_0x5aabe1}),_0x6d3685=await warehouse['findOne']({'name':_0x437ff8,'room':_0x3a2f1f});_0x4746c0[_0x2352bd(0x20c)][_0x2352bd(0x215)](_0x4f87f7=>{var _0x51897d=_0x2352bd,_0x5ec1a8=0x0;const _0x30b780=_0x6d3685['product_details'][_0x51897d(0x1c8)](_0x150e6f=>{var _0x460905=_0x51897d;_0x150e6f['product_name']==_0x4f87f7[_0x460905(0x1f9)]&&_0x150e6f['expiry_date']==_0x4f87f7[_0x460905(0x269)]&&_0x150e6f[_0x460905(0x1e7)]==_0x4f87f7[_0x460905(0x1e7)]&&_0x150e6f['batch_code']==_0x4f87f7[_0x460905(0x18f)]&&(_0x150e6f[_0x460905(0x255)]=parseInt(_0x150e6f[_0x460905(0x255)])+parseInt(_0x4f87f7['return_qty']),_0x5ec1a8++);});_0x5ec1a8=='0'&&(_0x6d3685[_0x51897d(0x266)]=_0x6d3685[_0x51897d(0x266)]['concat']({'product_name':_0x4f87f7[_0x51897d(0x1f9)],'product_stock':_0x4f87f7[_0x51897d(0x15c)],'primary_code':_0x4f87f7[_0x51897d(0x263)],'secondary_code':_0x4f87f7['secondary_code'],'product_code':_0x4f87f7[_0x51897d(0x232)],'batch_code':_0x4f87f7[_0x51897d(0x18f)],'maxPerUnit':_0x4f87f7[_0x51897d(0x172)],'production_date':_0x4f87f7[_0x51897d(0x1e7)],'expiry_date':_0x4f87f7[_0x51897d(0x269)],'secondary_unit':_0x4f87f7[_0x51897d(0x187)],'unit':_0x4f87f7[_0x51897d(0x1b0)],'maxProducts':_0x4f87f7[_0x51897d(0x174)],'bay':_0x4f87f7['bay']}));}),await _0x6d3685[_0x2352bd(0x202)]();const _0x2be101=new c_payment_data({'invoice':_0x5aabe1,'customer':_0x46bc38[_0x2352bd(0x19c)]['customer'],'reason':_0x2352bd(0x1a2)});await _0x2be101[_0x2352bd(0x202)]();const _0xb6276b=await master_shop['find'](),_0x88e3a9=await email_settings['findOne'](),_0x135378=await customer['findOne']({'name':_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x207)]});_0xb6276b[0x0][_0x2352bd(0x19f)]==0x1?(right_currency=_0xb6276b[0x0][_0x2352bd(0x1ae)],left_currency=''):(right_currency='',left_currency=_0xb6276b[0x0][_0x2352bd(0x1ae)]);var _0x921317=_0x22d92a,_0x1fd6aa=_0xa6867e,_0x2dcb0c='',_0x3896f6;for(_0x3896f6 in _0x921317){_0x2dcb0c+='<tr>'+_0x2352bd(0x1c4)+_0x921317[_0x3896f6]+_0x2352bd(0x169)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1fd6aa[_0x3896f6]+'</td>'+_0x2352bd(0x1ee);}console[_0x2352bd(0x204)](_0x2352bd(0x26c),_0x2dcb0c);let _0x6242ee=nodemailer[_0x2352bd(0x1ca)]({'service':_0x2352bd(0x22e),'auth':{'user':_0x88e3a9[_0x2352bd(0x196)],'pass':_0x88e3a9['password']}}),_0x3831c7={'from':_0x88e3a9[_0x2352bd(0x196)],'to':_0x135378[_0x2352bd(0x196)],'subject':_0x2352bd(0x247),'attachments':[{'filename':_0x2352bd(0x1a6),'path':__dirname+_0x2352bd(0x15b)+'/upload/'+_0xb6276b[0x0]['image'],'cid':_0x2352bd(0x252)}],'html':'<!DOCTYPE\x20html>'+_0x2352bd(0x246)+'</head><body>'+_0x2352bd(0x16c)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2352bd(0x16c)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2352bd(0x1a7)+_0x2352bd(0x16c)+_0x2352bd(0x1f7)+_0xb6276b[0x0]['site_title']+'\x20</h2>'+_0x2352bd(0x1a7)+_0x2352bd(0x1a7)+_0x2352bd(0x1e0)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x2352bd(0x1c1)+_0x5aabe1+'\x20'+_0x2352bd(0x18d)+_0x2352bd(0x165)+_0x1b88b4+'\x20'+_0x2352bd(0x1a1)+_0x2352bd(0x1f8)+'</div>'+_0x2352bd(0x21f)+_0x2352bd(0x171)+_0x2352bd(0x1e3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2352bd(0x1e2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x2352bd(0x1ee)+_0x2352bd(0x218)+_0x2352bd(0x271)+'\x20'+_0x2dcb0c+'\x20'+_0x2352bd(0x173)+'</table>'+_0x2352bd(0x16c)+_0x2352bd(0x270)+_0x2352bd(0x219)+_0xb6276b[0x0]['site_title']+_0x2352bd(0x1f8)+_0x2352bd(0x1a7)+'</div>'+_0x2352bd(0x176)};_0x6242ee[_0x2352bd(0x19b)](_0x3831c7,function(_0x6e82a9,_0x216500){var _0x55e905=_0x2352bd;_0x6e82a9?(console[_0x55e905(0x204)](_0x6e82a9),console[_0x55e905(0x204)](_0x55e905(0x228))):console[_0x55e905(0x204)](_0x55e905(0x238));}),_0x46bc38['flash'](_0x2352bd(0x1b2),_0x2352bd(0x1df)),_0x1a8944[_0x2352bd(0x183)](_0x2352bd(0x1f4));}catch(_0xfa6064){_0x1a8944[_0x2352bd(0x235)](0xc8)[_0x2352bd(0x1ec)]({'message1':_0xfa6064[_0x2352bd(0x262)]});}else{if(_0x46bc38['body'][_0x2352bd(0x170)]=='GS')try{const {invoice:_0x13d998,date:_0x42aaea,warehouse_name:_0x51fa3d,product_name:_0xe54535,primary_code:_0x31ac83,secondary_code:_0x3f7480,product_code:_0x89d361,sales_quantity:_0x55aa1f,stocks:_0x15d567,return_qty:_0x175d18,Room_name:_0x44b930,to_warehouse_name:_0x5e96a3,to_Room_name:_0x11b97a,note:_0x2a12be,level:_0x1769f8,isle:_0x4f3916,pallet:_0x4c8420,for_categorize:_0x270aff}=_0x46bc38[_0x2352bd(0x19c)];if(typeof _0xe54535==_0x2352bd(0x160))var _0x22d92a=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1f9)]],_0x50d5f1=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x263)]],_0x2e01e4=[_0x46bc38['body'][_0x2352bd(0x16b)]],_0x55548f=[_0x46bc38['body'][_0x2352bd(0x232)]],_0x3a6f2e=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1dd)]],_0xa6867e=[_0x46bc38['body'][_0x2352bd(0x15c)]],_0x23d229=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x251)]],_0x120101=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x172)]],_0x571859=[_0x46bc38[_0x2352bd(0x19c)]['maxProducts']],_0xce2f66=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x18f)]],_0x1b278e=[_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x187)]],_0x515318=[_0x46bc38[_0x2352bd(0x19c)]['unit']],_0x3dd06b=[_0x46bc38[_0x2352bd(0x19c)]['production_date']],_0x3c347f=[_0x46bc38['body'][_0x2352bd(0x269)]];else var _0x22d92a=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1f9)]],_0x50d5f1=[..._0x46bc38['body'][_0x2352bd(0x263)]],_0x2e01e4=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x16b)]],_0x55548f=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x232)]],_0x3a6f2e=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1dd)]],_0xa6867e=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x15c)]],_0x23d229=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x251)]],_0x120101=[..._0x46bc38['body'][_0x2352bd(0x172)]],_0x571859=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x174)]],_0xce2f66=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x18f)]],_0x1b278e=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x187)]],_0x515318=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1b0)]],_0x3dd06b=[..._0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x1e7)]],_0x3c347f=[..._0x46bc38[_0x2352bd(0x19c)]['expiry_date']];const _0x1431db=_0x22d92a[_0x2352bd(0x1c8)](_0x15ad39=>{return _0x15ad39={'product_name':_0x15ad39};});_0x50d5f1[_0x2352bd(0x215)]((_0x3f4256,_0x4e6943)=>{_0x1431db[_0x4e6943]['primary_code']=_0x3f4256;}),_0x2e01e4['forEach']((_0x6051f9,_0x2e7853)=>{var _0x582362=_0x2352bd;_0x1431db[_0x2e7853][_0x582362(0x16b)]=_0x6051f9;}),_0x55548f[_0x2352bd(0x215)]((_0x3380df,_0x265a25)=>{var _0x586884=_0x2352bd;_0x1431db[_0x265a25][_0x586884(0x232)]=_0x3380df;}),_0x3a6f2e['forEach']((_0x1f2780,_0x13c53a)=>{var _0x361273=_0x2352bd;_0x1431db[_0x13c53a][_0x361273(0x175)]=_0x1f2780;}),_0xa6867e[_0x2352bd(0x215)]((_0x33eeeb,_0x29e904)=>{var _0x4b0b5e=_0x2352bd;_0x1431db[_0x29e904][_0x4b0b5e(0x15c)]=_0x33eeeb;}),_0x23d229['forEach']((_0x3ede09,_0x16f981)=>{_0x1431db[_0x16f981]['bay']=_0x3ede09;}),_0x120101[_0x2352bd(0x215)]((_0x42b4a1,_0x52f235)=>{var _0x158907=_0x2352bd;_0x1431db[_0x52f235][_0x158907(0x172)]=_0x42b4a1;}),_0x571859[_0x2352bd(0x215)]((_0x499d0f,_0x5b3254)=>{var _0x59ffa3=_0x2352bd;_0x1431db[_0x5b3254][_0x59ffa3(0x174)]=_0x499d0f;}),_0xce2f66['forEach']((_0x31cd2a,_0xf6b949)=>{var _0x286b3b=_0x2352bd;_0x1431db[_0xf6b949][_0x286b3b(0x18f)]=_0x31cd2a;}),_0x1b278e['forEach']((_0x4cb1fd,_0x5192bc)=>{var _0x56c3c2=_0x2352bd;_0x1431db[_0x5192bc][_0x56c3c2(0x187)]=_0x4cb1fd;}),_0x515318[_0x2352bd(0x215)]((_0x5d63aa,_0x28cf3b)=>{_0x1431db[_0x28cf3b]['unit']=_0x5d63aa;}),_0x3dd06b[_0x2352bd(0x215)]((_0x16a367,_0x46d69b)=>{var _0x3e4285=_0x2352bd;_0x1431db[_0x46d69b][_0x3e4285(0x1e7)]=_0x16a367;}),_0x3c347f['forEach']((_0x8514f5,_0x136db7)=>{var _0x46d44d=_0x2352bd;_0x1431db[_0x136db7][_0x46d44d(0x269)]=_0x8514f5;});var _0x2bd5e7=0x0;_0x1431db[_0x2352bd(0x215)](_0x295c04=>{var _0x4ef0e9=_0x2352bd;(parseInt(_0x295c04['sale_qty'])<parseInt(_0x295c04['return_qty'])||parseInt(_0x295c04[_0x4ef0e9(0x162)])<parseInt(_0x295c04[_0x4ef0e9(0x15c)])&&parseInt(_0x295c04['sale_qty'])>parseInt(_0x295c04[_0x4ef0e9(0x15c)])||parseInt(_0x295c04[_0x4ef0e9(0x15c)])==0x0)&&_0x2bd5e7++;});if(_0x2bd5e7!=0x0)return _0x46bc38[_0x2352bd(0x1f2)](_0x2352bd(0x18e),_0x2352bd(0x213)),_0x1a8944['redirect'](_0x2352bd(0x1b1));const _0x20d111=await sales_finished[_0x2352bd(0x24c)]({'invoice':_0x13d998});_0x20d111[_0x2352bd(0x1b4)]=_0x2352bd(0x186);const _0x3958e9=await _0x20d111[_0x2352bd(0x202)](),_0x254773=new sales_return_finished({'invoice':_0x13d998,'customer':_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x207)],'date':_0x42aaea,'warehouse_name':_0x51fa3d,'room':_0x44b930,'ToWarehouse':_0x5e96a3,'ToRoom':_0x11b97a,'return_sale':_0x1431db,'note':_0x2a12be,'warehouse_cat':_0x270aff}),_0x2469f1=await _0x254773[_0x2352bd(0x202)](),_0xfebb23=await sales_return_finished[_0x2352bd(0x24c)]({'invoice':_0x13d998}),_0x234128=await warehouse['findOne']({'name':_0x5e96a3,'room':_0x11b97a,'warehouse_category':'Finished\x20Goods'});_0xfebb23[_0x2352bd(0x1c7)]['forEach'](_0x43574b=>{var _0x1a8c39=_0x2352bd,_0x3904b0=0x0;const _0x4d8f55=_0x234128[_0x1a8c39(0x266)][_0x1a8c39(0x1c8)](_0x373b69=>{var _0x291b26=_0x1a8c39;_0x373b69[_0x291b26(0x1f9)]==_0x43574b[_0x291b26(0x1f9)]&&_0x373b69[_0x291b26(0x251)]==_0x43574b[_0x291b26(0x251)]&&_0x373b69[_0x291b26(0x269)]==_0x43574b[_0x291b26(0x269)]&&_0x373b69[_0x291b26(0x1e7)]==_0x43574b[_0x291b26(0x1e7)]&&_0x373b69['batch_code']==_0x43574b['batch_code']&&(_0x373b69['product_stock']=parseInt(_0x373b69[_0x291b26(0x255)])+parseInt(_0x43574b[_0x291b26(0x15c)]),_0x3904b0++);});_0x3904b0=='0'&&(_0x234128[_0x1a8c39(0x266)]=_0x234128[_0x1a8c39(0x266)][_0x1a8c39(0x257)]({'product_name':_0x43574b[_0x1a8c39(0x1f9)],'product_stock':_0x43574b[_0x1a8c39(0x15c)],'primary_code':_0x43574b[_0x1a8c39(0x263)],'secondary_code':_0x43574b[_0x1a8c39(0x16b)],'product_code':_0x43574b['product_code'],'bay':_0x43574b[_0x1a8c39(0x251)],'batch_code':_0x43574b[_0x1a8c39(0x18f)],'maxPerUnit':_0x43574b[_0x1a8c39(0x172)],'production_date':_0x43574b[_0x1a8c39(0x1e7)],'expiry_date':_0x43574b['expiry_date'],'secondary_unit':_0x43574b['secondary_unit'],'unit':_0x43574b[_0x1a8c39(0x1b0)],'maxProducts':_0x43574b[_0x1a8c39(0x174)]}));}),await _0x234128['save'](),console[_0x2352bd(0x204)](_0x46bc38[_0x2352bd(0x19c)]);const _0x318a63=new c_payment_data({'invoice':_0x13d998,'customer':_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x207)],'reason':_0x2352bd(0x1a2)});await _0x318a63['save']();const _0x2a779a=await master_shop['find']();console['log'](_0x2352bd(0x221),_0x2a779a[0x0][_0x2352bd(0x1e8)]);const _0x7bd787=await email_settings[_0x2352bd(0x24c)](),_0x1b1be8=await customer[_0x2352bd(0x24c)]({'name':_0x46bc38[_0x2352bd(0x19c)][_0x2352bd(0x207)]});console[_0x2352bd(0x204)]('customer_data',_0x1b1be8);_0x2a779a[0x0]['currency_placement']==0x1?(right_currency=_0x2a779a[0x0][_0x2352bd(0x1ae)],left_currency=''):(right_currency='',left_currency=_0x2a779a[0x0][_0x2352bd(0x1ae)]);var _0x921317=_0x22d92a,_0x1fd6aa=_0xa6867e,_0x2dcb0c='',_0x3896f6;for(_0x3896f6 in _0x921317){_0x2dcb0c+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x921317[_0x3896f6]+_0x2352bd(0x169)+_0x2352bd(0x1c4)+_0x1fd6aa[_0x3896f6]+_0x2352bd(0x169)+'</tr>';}console[_0x2352bd(0x204)](_0x2352bd(0x26c),_0x2dcb0c);let _0x10277a=nodemailer['createTransport']({'service':_0x2352bd(0x22e),'auth':{'user':_0x7bd787[_0x2352bd(0x196)],'pass':_0x7bd787[_0x2352bd(0x239)]}}),_0x1628c4={'from':_0x7bd787[_0x2352bd(0x196)],'to':_0x1b1be8[_0x2352bd(0x196)],'subject':_0x2352bd(0x247),'attachments':[{'filename':_0x2352bd(0x1a6),'path':__dirname+_0x2352bd(0x15b)+_0x2352bd(0x254)+_0x2a779a[0x0][_0x2352bd(0x1e8)],'cid':'logo'}],'html':_0x2352bd(0x25c)+_0x2352bd(0x246)+_0x2352bd(0x1be)+_0x2352bd(0x16c)+_0x2352bd(0x241)+_0x2352bd(0x16c)+_0x2352bd(0x17b)+_0x2352bd(0x1a7)+_0x2352bd(0x16c)+_0x2352bd(0x1f7)+_0x2a779a[0x0][_0x2352bd(0x18c)]+'\x20</h2>'+_0x2352bd(0x1a7)+_0x2352bd(0x1a7)+_0x2352bd(0x1e0)+'<div>'+_0x2352bd(0x181)+_0x2352bd(0x1c1)+_0x13d998+'\x20'+_0x2352bd(0x18d)+_0x2352bd(0x165)+_0x42aaea+'\x20'+_0x2352bd(0x1a1)+_0x2352bd(0x1f8)+_0x2352bd(0x1a7)+_0x2352bd(0x21f)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2352bd(0x1e3)+_0x2352bd(0x20a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x2352bd(0x1c9)+_0x2352bd(0x224)+_0x2352bd(0x1ee)+_0x2352bd(0x218)+_0x2352bd(0x271)+'\x20'+_0x2dcb0c+'\x20'+'</tbody>'+_0x2352bd(0x19a)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x2a779a[0x0]['site_title']+'</h5>'+_0x2352bd(0x1a7)+'</div>'+_0x2352bd(0x176)};_0x10277a['sendMail'](_0x1628c4,function(_0x49e625,_0x21cb10){var _0x3da2b0=_0x2352bd;_0x49e625?(console['log'](_0x49e625),console[_0x3da2b0(0x204)](_0x3da2b0(0x228))):console['log']('Email\x20sent\x20successfully');}),_0x46bc38[_0x2352bd(0x1f2)](_0x2352bd(0x1b2),_0x2352bd(0x1df)),_0x1a8944[_0x2352bd(0x183)]('/all_sales_finished/view');}catch(_0x5435cd){console[_0x2352bd(0x204)](_0x5435cd),_0x1a8944['status'](0xc8)[_0x2352bd(0x1ec)]({'message1':_0x5435cd[_0x2352bd(0x262)]});}}}),router['get']('/barcode/:id',auth,async(_0x1638b1,_0x4fb3bc)=>{var _0x5729c0=a0_0x2b3417;try{const {username:_0xc0491a,email:_0x382339,role:_0x3a98ee}=_0x1638b1[_0x5729c0(0x1d6)],_0x32572a=_0x1638b1['user'],_0x336eec=await profile[_0x5729c0(0x24c)]({'email':_0x32572a[_0x5729c0(0x196)]}),_0x498652=await master_shop[_0x5729c0(0x21a)]();console[_0x5729c0(0x204)](_0x5729c0(0x1d9),_0x498652);const _0x56fefe=_0x1638b1[_0x5729c0(0x17e)]['id'],_0x33a420=await sales['findById'](_0x56fefe);console['log'](_0x5729c0(0x1da),_0x33a420);if(_0x498652[0x0][_0x5729c0(0x1e4)]==_0x5729c0(0x193))var _0x47bd46=users['English'];else{if(_0x498652[0x0]['language']=='Hindi')var _0x47bd46=users['Hindi'];else{if(_0x498652[0x0][_0x5729c0(0x1e4)]==_0x5729c0(0x227))var _0x47bd46=users['German'];else{if(_0x498652[0x0][_0x5729c0(0x1e4)]==_0x5729c0(0x1c6))var _0x47bd46=users[_0x5729c0(0x1c6)];else{if(_0x498652[0x0][_0x5729c0(0x1e4)]==_0x5729c0(0x17a))var _0x47bd46=users[_0x5729c0(0x17a)];else{if(_0x498652[0x0][_0x5729c0(0x1e4)]==_0x5729c0(0x1bd))var _0x47bd46=users[_0x5729c0(0x240)];else{if(_0x498652[0x0][_0x5729c0(0x1e4)]==_0x5729c0(0x260))var _0x47bd46=users[_0x5729c0(0x260)];else{if(_0x498652[0x0]['language']==_0x5729c0(0x1eb))var _0x47bd46=users[_0x5729c0(0x24d)];}}}}}}}_0x4fb3bc['render']('all_sales_barcode',{'success':_0x1638b1[_0x5729c0(0x1f2)](_0x5729c0(0x1b2)),'errors':_0x1638b1['flash'](_0x5729c0(0x18e)),'role':_0x32572a,'profile':_0x336eec,'alldata':_0x33a420,'master_shop':_0x498652,'language':_0x47bd46});}catch(_0x462df3){console[_0x5729c0(0x204)](_0x462df3);}}),router[a0_0x2b3417(0x178)](a0_0x2b3417(0x26a),async(_0x4596b7,_0x56bd13)=>{var _0x3126e2=a0_0x2b3417;const {product_code:_0x304d75,warehouse_name:_0x59e588,rooms_data:_0x4afeb5,Roomslist:_0x51ed0e}=_0x4596b7[_0x3126e2(0x19c)],_0x508472=_0x51ed0e[_0x3126e2(0x24f)](','),_0x4fed80=[];async function _0x50c401(_0x272dd1){var _0x24c50f=_0x3126e2;const _0x4fded1=await warehouse['aggregate']([{'$match':{'name':_0x59e588,'room':_0x272dd1}},{'$unwind':_0x24c50f(0x217)},{'$match':{'product_details.primary_code':_0x304d75}},{'$group':{'_id':_0x24c50f(0x1ad),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x24c50f(0x1ea)},'primary_code':{'$first':_0x24c50f(0x1a0)},'secondary_code':{'$first':_0x24c50f(0x230)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x24c50f(0x1fc)},'isle':{'$first':_0x24c50f(0x16e)},'type':{'$first':_0x24c50f(0x15d)},'pallet':{'$first':_0x24c50f(0x184)},'unit':{'$first':_0x24c50f(0x253)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x24c50f(0x1cd)},'rack':{'$first':_0x24c50f(0x261)},'expiry_date':{'$first':_0x24c50f(0x21c)},'production_date':{'$first':_0x24c50f(0x1ff)},'maxPerUnit':{'$first':_0x24c50f(0x1d1)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x24c50f(0x1dc)}}}]),_0x47b1fd=await warehouse[_0x24c50f(0x1c0)]([{'$match':{'name':_0x59e588,'room':_0x272dd1}},{'$unwind':_0x24c50f(0x217)},{'$match':{'product_details.secondary_code':_0x304d75}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x24c50f(0x25a)},'product_stock':{'$first':_0x24c50f(0x1ea)},'primary_code':{'$first':_0x24c50f(0x1a0)},'secondary_code':{'$first':_0x24c50f(0x230)},'product_code':{'$first':_0x24c50f(0x216)},'level':{'$first':_0x24c50f(0x1fc)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x24c50f(0x15d)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x24c50f(0x253)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x24c50f(0x1cd)},'rack':{'$first':_0x24c50f(0x261)},'expiry_date':{'$first':_0x24c50f(0x21c)},'production_date':{'$first':_0x24c50f(0x1ff)},'maxPerUnit':{'$first':_0x24c50f(0x1d1)},'batch_code':{'$first':_0x24c50f(0x1d0)},'product_cat':{'$first':_0x24c50f(0x24b)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x24c50f(0x212)},'invoice':{'$first':_0x24c50f(0x1dc)}}}]);if(_0x4fded1[_0x24c50f(0x20f)]>0x0)_0x4fed80[_0x24c50f(0x25e)](_0x4fded1);else _0x47b1fd[_0x24c50f(0x20f)]>0x0&&_0x4fed80['push'](_0x47b1fd);}const _0x554418=_0x508472['map'](_0x33f2c5=>_0x50c401(_0x33f2c5));await Promise['all'](_0x554418),_0x56bd13[_0x3126e2(0x1ec)](_0x4fed80);}),module[a0_0x2b3417(0x208)]=router;