var a0_0x475af3=a0_0x2a65;function a0_0x160f(){var _0x5e2796=['logo','Finished\x20Goods','final','<span\x20style=\x22float:\x20right;\x22>','/view/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$_id','An\x20error\x20occurred.','<table\x20style=\x22width:\x20100%\x20!important;\x22>','\x20==\x20','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','<tbody\x20style=\x22text-align:\x20center;\x22>','../public/language/languages.json','Portuguese\x20(BR)','log','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','site_title','expiry_date','$product_details.primary_code','max_per_unit','received_amount','product','$product_details.batch_code','</div>','product_name_QA1','Enclosed','$customer','floor','1644214JwHYfr','language','sales_quantity','1008SVEtno','Return\x20Rooms','$note','stock_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','\x20Order\x20Number\x20:\x20','Received\x20Payment\x20For\x20Sale','221058XAXaIq','prod_cat','$product_details.secondary_code','add_sales_finished','Spanish','host','map','sales_quantity_QA','$product_details.type','customers_docs','getDate','json','christian.villamer@jakagroup.com','all_sales_finished','$product_details.expiry_date','adjust_qty','\x20<<<==>>>\x20','room_name','$invoice','nodemailer','warehouse_name','$warehouse_name','batch_code_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','toString','status','secondary_code_QA','password','$product_details.room_name','/give_payment/:id','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$sale_product.bin','product_data','$product_details.product_cat','\x20&&\x20','body','sale_qty','$product_details.maxPerUnit','due_amount','/all_sales_finished/preview/','post','return_data','primary_code','Arabic','date','secondary_unit','95528OXODUk','Sales\x20Update\x20successfully','$product_details','product_code','</h5>','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','maxPerUnit','$sale_product','$product_details.maxProducts','$date','primary_code_QA','<h5\x20style=\x22text-align:\x20left;\x22>','purchases_data','redirect','Logo.png','message','</span>','maxProducts','False','<h5>','Chinese','stocks_QA','$finalize','flash','unit_QA','express','<tr>','English\x20(US)','error','success','warehouse','secondary_code','ADD\x20SALE','$product.product_name','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','\x20Order\x20Date\x20:\x20','$sale_product.quantity','$product_details._id','Error\x20Occurs','customer_data','random','/invoice/:id','staff','invoice','expiry_date_QA','findById','903628YdjaBd','params','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','port','Ambient','True','sale_product','primary_unit','id_transaction_from','barcode\x20Product\x20master','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','QA\x20Warehouse','French','</table>','Router','return_qty_QA','slice','<div>','edit_sales_finished','$product_details.product_code','secondary_unit_QA','return_qty','<h2>\x20','product_code_QA','split','exports','</tr>','prod_code','bay','3uzNBCO','abs','$sale_product.type','product_name','$product_details.product_stock','/view/add_sales/:id','German','save','$product_details.invoice','back','return_sale_QA','/../public','Portuguese','14774240tuLEbf','</td>','DRY\x20GOODS','aggregate','_id','Hindi','name','findOne','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</thead>','batch_code','errors','/all_sales_finished/view','Email\x20sent\x20successfully','<!DOCTYPE\x20html>','getMonth','OUTF-','$product_details.product_name','sendMail','<strong>\x20Regards\x20</strong>','for_categorize','all_sales_barcode','$product','Arabic\x20(ae)','/preview/:id','currency_placement','An\x20error\x20occurred\x20while\x20saving\x20data.','product_details','concat','$room','English','</tbody>','unit','<hr\x20class=\x22my-3\x22>','/view/add_sales','forEach','product_date','edit_sales_finished_view','add\x20post','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$product_details.bay','205kyWoxI','production_date','get','all','5329584gHiUTR','finalize','role','Sale','</body></html>','/all_sales/view','filter','master','Quality\x20Inspection','carton','Sale\x20Return\x20Mail','find','</head><body>','$product_details.storage','$product_details.secondary_unit','/upload/','/view/return_sales/:id','amount','image','level','length','then','render','sales_invoice','$product_details.bin','getFullYear','$product_details.unit','quantity','/view/add_sale/product','suppliers','payment\x20successfull','maxProducts_QA','\x20>>>\x20','product_stock','string','stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','push','currency','gmail','Sale\x20Return','customer','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$name','production_date_QA','user','Return\x20Goods','product_list','6304718FXqXxY','Enabled','createTransport','$product_details.floorlevel','\x20</h2>','$customers_docs','$product_details.rack','FGSEmail'];a0_0x160f=function(){return _0x5e2796;};return a0_0x160f();}(function(_0x55b055,_0x327d7b){var _0x70380c=a0_0x2a65,_0x39e499=_0x55b055();while(!![]){try{var _0x430cee=-parseInt(_0x70380c(0x260))/0x1+parseInt(_0x70380c(0x1b2))/0x2*(parseInt(_0x70380c(0x1cf))/0x3)+parseInt(_0x70380c(0x209))/0x4+-parseInt(_0x70380c(0x205))/0x5*(-parseInt(_0x70380c(0x26a))/0x6)+-parseInt(_0x70380c(0x23b))/0x7+-parseInt(_0x70380c(0x298))/0x8*(parseInt(_0x70380c(0x263))/0x9)+parseInt(_0x70380c(0x1dc))/0xa;if(_0x430cee===_0x327d7b)break;else _0x39e499['push'](_0x39e499['shift']());}catch(_0x3951ef){_0x39e499['push'](_0x39e499['shift']());}}}(a0_0x160f,0xd943d));function a0_0x2a65(_0x5bc763,_0x4b81a5){var _0x160f20=a0_0x160f();return a0_0x2a65=function(_0x2a65c4,_0x5d8c75){_0x2a65c4=_0x2a65c4-0x19b;var _0x490dbf=_0x160f20[_0x2a65c4];return _0x490dbf;},a0_0x2a65(_0x5bc763,_0x4b81a5);}const express=require(a0_0x475af3(0x19d)),app=express(),router=express[a0_0x475af3(0x1c0)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),nodemailer=require(a0_0x475af3(0x27d)),users=require(a0_0x475af3(0x250));router[a0_0x475af3(0x207)](a0_0x475af3(0x234),auth,async(_0x1f1b93,_0x6a4616)=>{var _0x27a01d=a0_0x475af3;try{const {username:_0x931fef,email:_0x276c48,role:_0x3f6e95}=_0x1f1b93[_0x27a01d(0x238)],_0x574467=_0x1f1b93[_0x27a01d(0x238)],_0x50ca67=await profile[_0x27a01d(0x1e3)]({'email':_0x574467[_0x27a01d(0x24d)]}),_0x51d89b=await master_shop['find']();let _0x2f6065;if(_0x574467[_0x27a01d(0x20b)]==_0x27a01d(0x1ae)){const _0x473913=await staff['findOne']({'email':_0x574467[_0x27a01d(0x24d)]});_0x2f6065=await sales_finished[_0x27a01d(0x1df)]([{'$lookup':{'from':'customers','localField':_0x27a01d(0x233),'foreignField':_0x27a01d(0x1e2),'as':_0x27a01d(0x273)}},{'$unwind':_0x27a01d(0x240)},{'$unwind':_0x27a01d(0x2a0)},{'$group':{'_id':'$_id','invoice':{'$first':_0x27a01d(0x27c)},'customers':{'$first':'$customer'},'date':{'$first':_0x27a01d(0x2a2)},'warehouse_name':{'$first':_0x27a01d(0x27f)},'sale_product':{'$push':_0x27a01d(0x2a0)},'note':{'$first':_0x27a01d(0x265)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x27a01d(0x240)},'total_saleproduct_quantity':{'$sum':_0x27a01d(0x1a8)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x27a01d(0x289)},'type':{'$addToSet':_0x27a01d(0x1d1)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x27a01d(0x2af)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x2f6065=await sales_finished['aggregate']([{'$lookup':{'from':'customers','localField':_0x27a01d(0x233),'foreignField':'name','as':_0x27a01d(0x273)}},{'$unwind':_0x27a01d(0x240)},{'$unwind':_0x27a01d(0x2a0)},{'$group':{'_id':_0x27a01d(0x249),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x27a01d(0x25e)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x27a01d(0x27f)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x27a01d(0x265)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x27a01d(0x240)},'total_saleproduct_quantity':{'$sum':_0x27a01d(0x1a8)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x27a01d(0x289)},'type':{'$addToSet':_0x27a01d(0x1d1)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x27a01d(0x2af)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x51d89b[0x0][_0x27a01d(0x261)]==_0x27a01d(0x19f)){var _0x4a28dd=users[_0x27a01d(0x1fa)];console[_0x27a01d(0x252)](_0x4a28dd);}else{if(_0x51d89b[0x0][_0x27a01d(0x261)]=='Hindi')var _0x4a28dd=users[_0x27a01d(0x1e1)];else{if(_0x51d89b[0x0][_0x27a01d(0x261)]==_0x27a01d(0x1d5))var _0x4a28dd=users['German'];else{if(_0x51d89b[0x0]['language']==_0x27a01d(0x26e))var _0x4a28dd=users[_0x27a01d(0x26e)];else{if(_0x51d89b[0x0][_0x27a01d(0x261)]==_0x27a01d(0x1be))var _0x4a28dd=users[_0x27a01d(0x1be)];else{if(_0x51d89b[0x0][_0x27a01d(0x261)]==_0x27a01d(0x251))var _0x4a28dd=users[_0x27a01d(0x1db)];else{if(_0x51d89b[0x0]['language']==_0x27a01d(0x2ad))var _0x4a28dd=users[_0x27a01d(0x2ad)];else{if(_0x51d89b[0x0][_0x27a01d(0x261)]==_0x27a01d(0x1f3))var _0x4a28dd=users[_0x27a01d(0x295)];}}}}}}}_0x6a4616['render'](_0x27a01d(0x277),{'success':_0x1f1b93['flash'](_0x27a01d(0x1a1)),'errors':_0x1f1b93[_0x27a01d(0x19b)](_0x27a01d(0x1e7)),'sales':_0x2f6065,'profile':_0x50ca67,'role':_0x574467,'master_shop':_0x51d89b,'language':_0x4a28dd});}catch(_0x21076c){console[_0x27a01d(0x252)](_0x21076c);}});async function getRandom8DigitNumber(){var _0x2a0747=a0_0x475af3;const _0x46a34a=0x989680,_0x153b52=0x5f5e0ff,_0x2a18d1=Math[_0x2a0747(0x25f)](Math[_0x2a0747(0x1ac)]()*(_0x153b52-_0x46a34a+0x1))+_0x46a34a;var _0x56e3ad;const _0x168ac6=await sales_finished[_0x2a0747(0x1e3)]({'invoice':_0x2a0747(0x1ec)+_0x2a18d1});return _0x168ac6&&_0x168ac6[_0x2a0747(0x21d)]>0x0?_0x56e3ad=_0x2a0747(0x1ec)+_0x2a18d1:_0x56e3ad=_0x2a0747(0x1ec)+_0x2a18d1,_0x56e3ad;}router[a0_0x475af3(0x207)](a0_0x475af3(0x1fe),auth,async(_0x5b13f3,_0x354b0b)=>{var _0xbe576=a0_0x475af3;try{const {username:_0x34e742,email:_0x5418f0,role:_0xb400d5}=_0x5b13f3['user'],_0x52054d=_0x5b13f3['user'],_0x5e26a5=await profile['findOne']({'email':_0x52054d[_0xbe576(0x24d)]}),_0xaff33a=await master_shop[_0xbe576(0x214)](),_0xbc3796=await customer['find']({});let _0x530523;if(_0x52054d['role']==_0xbe576(0x1ae)){const _0x3c9892=await staff['findOne']({'email':_0x52054d[_0xbe576(0x24d)]});_0x530523=await warehouse[_0xbe576(0x1df)]([{'$match':{'status':_0xbe576(0x23c),'name':_0x3c9892['warehouse'],'warehouse_category':_0xbe576(0x244),'name':{'$ne':_0xbe576(0x1bd)}}},{'$group':{'_id':_0xbe576(0x236),'name':{'$first':_0xbe576(0x236)}}},{'$sort':{'name':0x1}}]);}else _0x530523=await warehouse[_0xbe576(0x1df)]([{'$match':{'status':_0xbe576(0x23c),'warehouse_category':_0xbe576(0x244),'name':{'$ne':_0xbe576(0x1bd)}}},{'$group':{'_id':'$name','name':{'$first':_0xbe576(0x236)}}},{'$sort':{'name':0x1}}]);const _0x476323=await product['find']({});var _0x349fe5=[_0xbe576(0x1b6),_0xbe576(0x25d)];const _0x6b4caa=await sales_finished[_0xbe576(0x214)]({}),_0x2c4e4d=_0x6b4caa[_0xbe576(0x21d)]+0x1,_0x1789cf=_0xbe576(0x1ec)+_0x2c4e4d[_0xbe576(0x282)]()['padStart'](0x5,'0');if(_0xaff33a[0x0][_0xbe576(0x261)]==_0xbe576(0x19f)){var _0x3ec800=users[_0xbe576(0x1fa)];console[_0xbe576(0x252)](_0x3ec800);}else{if(_0xaff33a[0x0][_0xbe576(0x261)]==_0xbe576(0x1e1))var _0x3ec800=users[_0xbe576(0x1e1)];else{if(_0xaff33a[0x0][_0xbe576(0x261)]=='German')var _0x3ec800=users['German'];else{if(_0xaff33a[0x0]['language']==_0xbe576(0x26e))var _0x3ec800=users['Spanish'];else{if(_0xaff33a[0x0][_0xbe576(0x261)]==_0xbe576(0x1be))var _0x3ec800=users[_0xbe576(0x1be)];else{if(_0xaff33a[0x0][_0xbe576(0x261)]==_0xbe576(0x251))var _0x3ec800=users['Portuguese'];else{if(_0xaff33a[0x0][_0xbe576(0x261)]=='Chinese')var _0x3ec800=users['Chinese'];else{if(_0xaff33a[0x0][_0xbe576(0x261)]==_0xbe576(0x1f3))var _0x3ec800=users[_0xbe576(0x295)];}}}}}}}const _0x24cf86=getRandom8DigitNumber();_0x24cf86[_0xbe576(0x21e)](_0x2cd0e3=>{var _0x1364ec=_0xbe576;_0x354b0b[_0x1364ec(0x21f)](_0x1364ec(0x26d),{'success':_0x5b13f3['flash'](_0x1364ec(0x1a1)),'errors':_0x5b13f3[_0x1364ec(0x19b)](_0x1364ec(0x1e7)),'role':_0x52054d,'profile':_0x5e26a5,'customer':_0xbc3796,'warehouse':_0x530523,'product':_0x476323,'invoice':_0x2cd0e3,'master_shop':_0xaff33a,'language':_0x3ec800,'rooms_data':_0x349fe5});})['catch'](_0x351169=>{var _0x309128=_0xbe576;_0x5b13f3[_0x309128(0x19b)]('errors',_0x309128(0x22e)),_0x354b0b[_0x309128(0x2a6)](_0x309128(0x1e8));});}catch(_0x31f62c){console['log'](_0x31f62c);}}),router[a0_0x475af3(0x207)](a0_0x475af3(0x1d4),auth,async(_0x45ea14,_0x4fedfc)=>{var _0x188dcb=a0_0x475af3;try{const _0x59590b=_0x45ea14['params']['id'];console[_0x188dcb(0x252)](_0x59590b);const _0xa9b488=await product[_0x188dcb(0x214)](),_0x29c5cd=await purchases['aggregate']([{'$match':{'warehouse_name':_0x59590b}},{'$unwind':_0x188dcb(0x1f2)},{'$group':{'_id':_0x188dcb(0x1a5)}}]);console[_0x188dcb(0x252)](_0x188dcb(0x2a5),_0x29c5cd),_0x4fedfc[_0x188dcb(0x283)](0xc8)[_0x188dcb(0x275)]({'purchases_data':_0x29c5cd,'product_data':_0xa9b488});}catch(_0x271e73){console['log'](_0x271e73);}}),router[a0_0x475af3(0x292)](a0_0x475af3(0x225),auth,async(_0x10f889,_0x517544)=>{var _0x2a856b=a0_0x475af3;try{const {warehouse_data:_0x39cddf,product_data:_0x55104c}=_0x10f889[_0x2a856b(0x28d)];console['log'](_0x10f889[_0x2a856b(0x28d)][_0x2a856b(0x28a)]);;const _0x8653a6=await master_shop[_0x2a856b(0x214)]();console[_0x2a856b(0x252)]('master',_0x8653a6);const _0x494cf0=await product[_0x2a856b(0x1e3)]({'name':_0x55104c});console[_0x2a856b(0x252)](_0x2a856b(0x259),_0x494cf0);const _0x18ef28=await warehouse[_0x2a856b(0x1df)]([{'$match':{'name':_0x39cddf}},{'$unwind':_0x2a856b(0x29a)},{'$match':{'product_details.product_name':_0x55104c}},{'$group':{'_id':_0x2a856b(0x1ed),'product_stock':{'$first':_0x2a856b(0x1d3)}}}]);console[_0x2a856b(0x252)](_0x2a856b(0x266),_0x18ef28),_0x517544['status'](0xc8)['json']({'master':_0x8653a6,'new_product':_0x494cf0,'stock_data':_0x18ef28});}catch(_0x2d32fd){console[_0x2a856b(0x252)](_0x2d32fd);}}),router['post'](a0_0x475af3(0x1fe),auth,async(_0x3af596,_0x23b10a)=>{var _0x53c7ec=a0_0x475af3;try{const {invoice:_0x26b872,date:_0x1b6cdf,warehouse_name:_0x4105f7,product_name:_0x303265,stock:_0x4811f0,quantity:_0xceb962,note:_0x23440c,room:_0x5e7a3e,primary_code:_0x271c9a,secondary_code:_0x5b886a,prod_code:_0x2c5b62,level:_0x436649,isle:_0x348048,pallet:_0x525540,batch_code:_0x4534f6,SCRN:_0x24976b,expiry_date:_0x4df209,mode_transpo:_0x47a12a,name_driver:_0x1d1f76}=_0x3af596[_0x53c7ec(0x28d)];if(typeof _0x303265=='string')var _0x4efd18=[_0x3af596[_0x53c7ec(0x28d)]['product_name']],_0x1a84fb=[_0x3af596['body']['stock']],_0x3f9723=[_0x3af596['body'][_0x53c7ec(0x212)]],_0x38b5d3=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x294)]],_0x40acc1=[_0x3af596[_0x53c7ec(0x28d)]['secondary_code']],_0xcdcf76=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1cd)]],_0x2fb3ad=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x21c)]],_0x3c1cac=[_0x3af596[_0x53c7ec(0x28d)]['primary_unit']],_0x46a62d=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x297)]],_0x5a11cf=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1e6)]],_0x4b3bfd=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x255)]],_0x467fac=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x200)]],_0x2ce9a6=[_0x3af596['body']['max_per_unit']],_0x4db2e3=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x26b)]],_0x322d87=[_0x3af596[_0x53c7ec(0x28d)]['RoomAssigned']],_0x3ec7d0=[_0x3af596[_0x53c7ec(0x28d)]['prod_invoice']],_0xc6d4f3=[_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1ba)]];else var _0x4efd18=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1d2)]],_0x1a84fb=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x22c)]],_0x3f9723=[..._0x3af596[_0x53c7ec(0x28d)]['carton']],_0x38b5d3=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x294)]],_0x40acc1=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1a3)]],_0xcdcf76=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1cd)]],_0x2fb3ad=[..._0x3af596[_0x53c7ec(0x28d)]['level']],_0x3c1cac=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1b9)]],_0x46a62d=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x297)]],_0x5a11cf=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1e6)]],_0x4b3bfd=[..._0x3af596['body'][_0x53c7ec(0x255)]],_0x467fac=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x200)]],_0x2ce9a6=[..._0x3af596['body'][_0x53c7ec(0x257)]],_0x4db2e3=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x26b)]],_0x322d87=[..._0x3af596['body']['RoomAssigned']],_0x3ec7d0=[..._0x3af596['body']['prod_invoice']],_0xc6d4f3=[..._0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x1ba)]];const _0x946104=_0x4efd18[_0x53c7ec(0x270)](_0x6dc48d=>{return _0x6dc48d={'product_name':_0x6dc48d};});_0x1a84fb[_0x53c7ec(0x1ff)]((_0x1aa673,_0x3e5a95)=>{var _0x280d35=_0x53c7ec;_0x946104[_0x3e5a95][_0x280d35(0x22c)]=_0x1aa673;}),_0x3f9723['forEach']((_0x460ee2,_0x29451d)=>{var _0x54a2a6=_0x53c7ec;_0x946104[_0x29451d]['quantity']=Math[_0x54a2a6(0x1d0)](_0x460ee2);}),_0xc6d4f3[_0x53c7ec(0x1ff)]((_0x90bc1b,_0x4c210e)=>{_0x946104[_0x4c210e]['id_transaction_from']=_0x90bc1b;}),_0x38b5d3[_0x53c7ec(0x1ff)]((_0x28e4c8,_0x1ca6b4)=>{var _0x39d0c5=_0x53c7ec;_0x946104[_0x1ca6b4][_0x39d0c5(0x294)]=_0x28e4c8;}),_0x40acc1[_0x53c7ec(0x1ff)]((_0x2ba63e,_0x3463ab)=>{var _0x7786f8=_0x53c7ec;_0x946104[_0x3463ab][_0x7786f8(0x1a3)]=_0x2ba63e;}),_0xcdcf76[_0x53c7ec(0x1ff)]((_0x104f8b,_0x699d02)=>{var _0x5dc08d=_0x53c7ec;_0x946104[_0x699d02][_0x5dc08d(0x29b)]=_0x104f8b;}),_0x2fb3ad['forEach']((_0x6d6e,_0x53dc81)=>{var _0x1eb6d5=_0x53c7ec;_0x946104[_0x53dc81][_0x1eb6d5(0x1ce)]=_0x6d6e;}),_0x3c1cac[_0x53c7ec(0x1ff)]((_0x5ef536,_0x1d41ed)=>{var _0x1efa9c=_0x53c7ec;_0x946104[_0x1d41ed][_0x1efa9c(0x1fc)]=_0x5ef536;}),_0x46a62d[_0x53c7ec(0x1ff)]((_0x1e5059,_0x3eebe2)=>{var _0x3ca443=_0x53c7ec;_0x946104[_0x3eebe2][_0x3ca443(0x297)]=_0x1e5059;}),_0x5a11cf[_0x53c7ec(0x1ff)]((_0x286585,_0x387857)=>{_0x946104[_0x387857]['batch_code']=_0x286585;}),_0x4b3bfd['forEach']((_0x3fc83e,_0x3b23d5)=>{var _0x43c979=_0x53c7ec;_0x946104[_0x3b23d5][_0x43c979(0x255)]=_0x3fc83e;}),_0x467fac[_0x53c7ec(0x1ff)]((_0x5af0d2,_0x5d6ed5)=>{_0x946104[_0x5d6ed5]['production_date']=_0x5af0d2;}),_0x2ce9a6[_0x53c7ec(0x1ff)]((_0x574d1d,_0x31b796)=>{_0x946104[_0x31b796]['maxperunit']=_0x574d1d;}),_0x4db2e3[_0x53c7ec(0x1ff)]((_0x1118ae,_0x381a77)=>{var _0x36539a=_0x53c7ec;_0x946104[_0x381a77][_0x36539a(0x26b)]=_0x1118ae;}),_0x322d87[_0x53c7ec(0x1ff)]((_0x5e198e,_0x19e0a6)=>{_0x946104[_0x19e0a6]['room_name']=_0x5e198e;}),_0x3ec7d0[_0x53c7ec(0x1ff)]((_0x4fab97,_0x16338b)=>{var _0x59975a=_0x53c7ec;_0x946104[_0x16338b][_0x59975a(0x1af)]=_0x4fab97;});var _0x382eae=0x0;_0x946104[_0x53c7ec(0x1ff)](_0x38b08f=>{var _0x2fa82c=_0x53c7ec;parseFloat(_0x38b08f[_0x2fa82c(0x22c)])<parseFloat(_0x38b08f[_0x2fa82c(0x224)])&&parseFloat(_0x38b08f[_0x2fa82c(0x224)])>parseFloat(_0x38b08f[_0x2fa82c(0x22c)])&&(console[_0x2fa82c(0x252)](_0x38b08f['stock']+'\x20<>\x20'+_0x38b08f['quantity']),_0x382eae++);});if(_0x382eae!=0x0)return _0x3af596['flash'](_0x53c7ec(0x1e7),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x23b10a[_0x53c7ec(0x2a6)](_0x53c7ec(0x1d8));const _0x1822e5=_0x946104['filter'](_0x1ec7b9=>_0x1ec7b9[_0x53c7ec(0x224)]!=='0'&&_0x1ec7b9[_0x53c7ec(0x224)]!==''),_0x3133e9=new sales_finished({'invoice':_0x26b872,'customer':_0x3af596[_0x53c7ec(0x28d)]['customer'],'date':_0x1b6cdf,'warehouse_name':_0x4105f7,'sale_product':_0x1822e5,'note':_0x23440c,'room':_0x5e7a3e,'primary_code':_0x271c9a,'secondary_code':_0x5b886a,'prod_code':_0x2c5b62,'SCRN':_0x24976b,'finalize':_0x53c7ec(0x2ab),'mode_transpo':_0x47a12a,'name_driver':_0x1d1f76}),_0x4b98d9=await _0x3133e9[_0x53c7ec(0x1d6)](),_0xc6c67a=await sales_finished['findOne']({'invoice':_0x26b872}),_0x4e72e3=new c_payment_data({'invoice':_0x26b872,'customer':_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x233)],'reason':_0x53c7ec(0x20c)});await _0x4e72e3['save']();const _0x2a6630=await master_shop[_0x53c7ec(0x214)](),_0x581f67=await email_settings[_0x53c7ec(0x1e3)](),_0x562936=await customer[_0x53c7ec(0x1e3)]({'name':_0x3af596[_0x53c7ec(0x28d)][_0x53c7ec(0x233)]});_0x2a6630[0x0]['currency_placement']==0x1?(right_currency=_0x2a6630[0x0][_0x53c7ec(0x230)],left_currency=''):(right_currency='',left_currency=_0x2a6630[0x0][_0x53c7ec(0x230)]);var _0x14aedd=_0x4efd18,_0x5edb62=_0x3f9723,_0x521144='',_0x297e7a;for(_0x297e7a in _0x14aedd){_0x521144+=_0x53c7ec(0x19e)+_0x53c7ec(0x288)+_0x14aedd[_0x297e7a]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5edb62[_0x297e7a]+_0x53c7ec(0x1dd)+'</tr>';}console[_0x53c7ec(0x252)]('product_list',_0x521144);let _0x39a129=nodemailer[_0x53c7ec(0x23d)]({'host':_0x581f67[_0x53c7ec(0x26f)],'port':Number(_0x581f67[_0x53c7ec(0x1b5)]),'secure':![],'service':'gmail','auth':{'user':_0x581f67[_0x53c7ec(0x24d)],'pass':_0x581f67[_0x53c7ec(0x285)]}}),_0x1c8a3f={'from':_0x581f67[_0x53c7ec(0x24d)],'to':_0x53c7ec(0x276),'subject':'Add\x20Sales','attachments':[{'filename':_0x53c7ec(0x2a7),'path':__dirname+_0x53c7ec(0x1da)+'/upload/'+_0x2a6630[0x0]['image'],'cid':_0x53c7ec(0x243)}],'html':_0x53c7ec(0x1a4)};_0x39a129[_0x53c7ec(0x1ee)](_0x1c8a3f,function(_0x42b39c,_0x1b4a36){var _0x913396=_0x53c7ec;_0x42b39c?(console[_0x913396(0x252)](_0x42b39c),console[_0x913396(0x252)]('Error\x20Occurs')):console[_0x913396(0x252)](_0x913396(0x1e9));}),_0x3af596[_0x53c7ec(0x19b)](_0x53c7ec(0x1a1),'Sales\x20Add\x20successfully'),_0x23b10a['redirect'](_0x53c7ec(0x291)+_0x4b98d9['_id']);}catch(_0x10d6d9){console[_0x53c7ec(0x252)](_0x10d6d9);}}),router[a0_0x475af3(0x207)](a0_0x475af3(0x1f4),auth,async(_0x43ba71,_0x4386d3)=>{var _0x473e02=a0_0x475af3;try{const {username:_0x5176f5,email:_0x5197df,role:_0x1f0793}=_0x43ba71[_0x473e02(0x238)],_0x51025a=_0x43ba71[_0x473e02(0x238)],_0x8626e3=await profile[_0x473e02(0x1e3)]({'email':_0x51025a[_0x473e02(0x24d)]}),_0x346246=await master_shop[_0x473e02(0x214)](),_0x542dd5=_0x43ba71[_0x473e02(0x1b3)]['id'],_0xd198e2=await sales_finished[_0x473e02(0x1b1)](_0x542dd5),_0x3e174f=await warehouse[_0x473e02(0x1df)]([{'$match':{'name':_0xd198e2['warehouse_name']}},{'$unwind':_0x473e02(0x29a)},{'$group':{'_id':_0x473e02(0x1a9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x473e02(0x1d3)},'bay':{'$first':_0x473e02(0x204)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x473e02(0x272)},'floorlevel':{'$first':_0x473e02(0x23e)},'primary_code':{'$first':_0x473e02(0x256)},'secondary_code':{'$first':_0x473e02(0x26c)},'product_code':{'$first':_0x473e02(0x1c5)},'storage':{'$first':_0x473e02(0x216)},'rack':{'$first':_0x473e02(0x241)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x473e02(0x25a)},'room':{'$first':_0x473e02(0x1f9)},'room_data':{'$first':_0x473e02(0x286)}}}]),_0x1f8bbb=await customer[_0x473e02(0x214)]({});let _0x28f40d;if(_0x51025a[_0x473e02(0x20b)]==_0x473e02(0x1ae)){const _0x356279=await staff['findOne']({'email':_0x51025a['email']});_0x28f40d=await warehouse[_0x473e02(0x1df)]([{'$match':{'status':_0x473e02(0x23c),'name':_0x356279['warehouse']}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x28f40d=await warehouse[_0x473e02(0x1df)]([{'$match':{'status':_0x473e02(0x23c)}},{'$group':{'_id':_0x473e02(0x236),'name':{'$first':_0x473e02(0x236)}}}]);const _0x10733d=await product[_0x473e02(0x214)]({});if(_0x346246[0x0][_0x473e02(0x261)]=='English\x20(US)'){var _0x19f772=users[_0x473e02(0x1fa)];console[_0x473e02(0x252)](_0x19f772);}else{if(_0x346246[0x0][_0x473e02(0x261)]==_0x473e02(0x1e1))var _0x19f772=users['Hindi'];else{if(_0x346246[0x0][_0x473e02(0x261)]=='German')var _0x19f772=users[_0x473e02(0x1d5)];else{if(_0x346246[0x0][_0x473e02(0x261)]==_0x473e02(0x26e))var _0x19f772=users['Spanish'];else{if(_0x346246[0x0][_0x473e02(0x261)]==_0x473e02(0x1be))var _0x19f772=users[_0x473e02(0x1be)];else{if(_0x346246[0x0][_0x473e02(0x261)]==_0x473e02(0x251))var _0x19f772=users['Portuguese'];else{if(_0x346246[0x0][_0x473e02(0x261)]==_0x473e02(0x2ad))var _0x19f772=users[_0x473e02(0x2ad)];else{if(_0x346246[0x0][_0x473e02(0x261)]==_0x473e02(0x1f3))var _0x19f772=users['Arabic'];}}}}}}}_0x4386d3[_0x473e02(0x21f)](_0x473e02(0x201),{'success':_0x43ba71[_0x473e02(0x19b)](_0x473e02(0x1a1)),'errors':_0x43ba71['flash'](_0x473e02(0x1e7)),'role':_0x51025a,'profile':_0x8626e3,'customer':_0x1f8bbb,'warehouse':_0x28f40d,'product':_0x3e174f,'user':_0xd198e2,'master_shop':_0x346246,'unit':_0x10733d,'language':_0x19f772});}catch(_0xa406db){console[_0x473e02(0x252)](_0xa406db);}}),router[a0_0x475af3(0x292)](a0_0x475af3(0x1f4),auth,async(_0x1f2a9c,_0x4686c4)=>{var _0x3d14ae=a0_0x475af3;try{const _0x1cbac8=_0x1f2a9c[_0x3d14ae(0x1b3)]['id'],{invoice:_0x11d703,warehouse_name:_0x3ec639,room:_0x1c7334}=_0x1f2a9c[_0x3d14ae(0x28d)],_0x501528=await sales_finished['findOne']({'invoice':_0x11d703}),_0x18b970=_0x501528['sale_product'][_0x3d14ae(0x270)](async _0x44a889=>{var _0x534ea6=_0x3d14ae,_0x22a31a=await warehouse[_0x534ea6(0x1e3)]({'name':_0x3ec639,'room':_0x44a889[_0x534ea6(0x27b)],'warehouse_category':_0x534ea6(0x244)});const _0x332681=_0x22a31a['product_details'][_0x534ea6(0x270)](_0x1b4524=>{var _0x319dcb=_0x534ea6;(_0x1b4524[_0x319dcb(0x1d2)]==_0x44a889[_0x319dcb(0x1d2)]&&_0x1b4524[_0x319dcb(0x1ce)]==_0x44a889['bay']&&_0x1b4524[_0x319dcb(0x255)]==_0x44a889[_0x319dcb(0x255)]&&_0x1b4524['production_date']==_0x44a889[_0x319dcb(0x206)]&&_0x1b4524[_0x319dcb(0x1e6)]==_0x44a889['batch_code']&&_0x1b4524[_0x319dcb(0x1af)]==_0x44a889[_0x319dcb(0x1af)]||_0x1b4524[_0x319dcb(0x1e0)]==_0x44a889[_0x319dcb(0x1ba)])&&(_0x1b4524[_0x319dcb(0x22a)]>0x0&&(console[_0x319dcb(0x252)](_0x1b4524[_0x319dcb(0x1d2)]+_0x319dcb(0x24c)+_0x44a889[_0x319dcb(0x1d2)]+_0x319dcb(0x28c)+_0x1b4524['bay']+_0x319dcb(0x24c)+_0x44a889[_0x319dcb(0x1ce)]+'\x20&&\x20'+_0x1b4524[_0x319dcb(0x206)]+_0x319dcb(0x24c)+_0x44a889[_0x319dcb(0x206)]+_0x319dcb(0x28c)+_0x1b4524[_0x319dcb(0x255)]+'\x20==\x20'+_0x44a889[_0x319dcb(0x255)]+_0x319dcb(0x28c)+_0x1b4524[_0x319dcb(0x1e6)]+_0x319dcb(0x24c)+_0x44a889[_0x319dcb(0x1e6)]+_0x319dcb(0x28c)+_0x1b4524[_0x319dcb(0x1af)]+_0x319dcb(0x24c)+_0x44a889[_0x319dcb(0x1af)]+_0x319dcb(0x28c)+_0x1b4524[_0x319dcb(0x22a)]+_0x319dcb(0x27a)+_0x44a889['quantity']+_0x319dcb(0x229)+_0x44a889[_0x319dcb(0x27b)]+_0x319dcb(0x28c)+_0x1b4524[_0x319dcb(0x1e0)]+_0x319dcb(0x24c)+_0x44a889[_0x319dcb(0x1ba)]),_0x1b4524[_0x319dcb(0x22a)]=Math['max'](0x0,Math[_0x319dcb(0x1d0)](_0x1b4524[_0x319dcb(0x22a)])-Math['abs'](_0x44a889[_0x319dcb(0x224)]))));});return _0x22a31a;});Promise[_0x3d14ae(0x208)](_0x18b970)[_0x3d14ae(0x21e)](async _0x5874c0=>{var _0x37368b=_0x3d14ae;try{for(const _0x265da3 of _0x5874c0){await _0x265da3[_0x37368b(0x1d6)]();}_0x501528[_0x37368b(0x20a)]=_0x37368b(0x1b7);const _0x25da31=await _0x501528[_0x37368b(0x1d6)](),_0x37cb00=await master_shop[_0x37368b(0x214)](),_0x5adb6d=await email_settings[_0x37368b(0x1e3)](),_0x36c19e=await supervisor_settings[_0x37368b(0x214)]();var _0x5db9a7=_0x501528[_0x37368b(0x1b8)],_0xa5148f='',_0x2a8306;for(_0x2a8306 in _0x5db9a7){var _0x4f61fc='FG';_0x501528[_0x37368b(0x27e)]==_0x37368b(0x1de)&&(_0x4f61fc='DG'),_0xa5148f+=_0x37368b(0x19e)+_0x37368b(0x288)+_0x5db9a7[_0x2a8306][_0x37368b(0x1d2)]+_0x37368b(0x1dd)+_0x37368b(0x288)+_0x5db9a7[_0x2a8306]['product_code']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5db9a7[_0x2a8306][_0x37368b(0x224)]+'</td>'+_0x37368b(0x288)+_0x5db9a7[_0x2a8306][_0x37368b(0x1fc)]+_0x37368b(0x1dd)+_0x37368b(0x288)+_0x5db9a7[_0x2a8306]['secondary_unit']+_0x37368b(0x1dd)+_0x37368b(0x288)+_0x501528[_0x37368b(0x27e)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5db9a7[_0x2a8306][_0x37368b(0x27b)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4f61fc+_0x5db9a7[_0x2a8306]['bay']+_0x37368b(0x1dd);}let _0x53c4b0=nodemailer[_0x37368b(0x23d)]({'host':_0x5adb6d[_0x37368b(0x26f)],'port':Number(_0x5adb6d[_0x37368b(0x1b5)]),'secure':![],'auth':{'user':_0x5adb6d[_0x37368b(0x24d)],'pass':_0x5adb6d[_0x37368b(0x285)]}}),_0x41a31b={'from':_0x5adb6d[_0x37368b(0x24d)],'to':_0x36c19e[0x0][_0x37368b(0x242)],'subject':'Sales\x20Mail','attachments':[{'filename':_0x37368b(0x2a7),'path':__dirname+_0x37368b(0x1da)+'/upload/'+_0x37cb00[0x0][_0x37368b(0x21b)],'cid':_0x37368b(0x243)}],'html':_0x37368b(0x1ea)+'<html><head><title></title>'+'</head><body>'+_0x37368b(0x1c3)+_0x37368b(0x1a6)+_0x37368b(0x1c3)+_0x37368b(0x1b4)+_0x37368b(0x25b)+_0x37368b(0x1c3)+'<h2>\x20'+_0x37cb00[0x0][_0x37368b(0x254)]+_0x37368b(0x23f)+_0x37368b(0x25b)+_0x37368b(0x25b)+_0x37368b(0x1fd)+'<div>'+_0x37368b(0x2a4)+_0x37368b(0x268)+_0x501528[_0x37368b(0x1af)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x37368b(0x1a7)+_0x501528[_0x37368b(0x296)]+'\x20'+_0x37368b(0x2a9)+'</h5>'+_0x37368b(0x25b)+_0x37368b(0x24b)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x37368b(0x235)+_0x37368b(0x1e4)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x37368b(0x22d)+_0x37368b(0x248)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x37368b(0x1cc)+_0x37368b(0x1e5)+_0x37368b(0x24f)+'\x20'+_0xa5148f+'\x20'+_0x37368b(0x1fb)+_0x37368b(0x1bf)+_0x37368b(0x1c3)+_0x37368b(0x1ef)+'<h5>'+_0x37cb00[0x0][_0x37368b(0x254)]+_0x37368b(0x29c)+_0x37368b(0x25b)+'</div>'+'</body></html>'};_0x53c4b0[_0x37368b(0x1ee)](_0x41a31b,function(_0x4d8034,_0x2246bb){var _0xf5a2bf=_0x37368b;_0x4d8034?(console[_0xf5a2bf(0x252)](_0x4d8034),console[_0xf5a2bf(0x252)]('Error\x20Occurs')):console['log'](_0xf5a2bf(0x1e9));}),_0x1f2a9c[_0x37368b(0x19b)](_0x37368b(0x1a1),_0x37368b(0x299)),_0x4686c4[_0x37368b(0x2a6)]('/picking_list/pdf/'+_0x1cbac8);}catch(_0x3b204b){console['error'](_0x3b204b),_0x4686c4[_0x37368b(0x283)](0x1f4)['json']({'error':_0x37368b(0x1f6)});}})['catch'](_0x5e3596=>{var _0x224d78=_0x3d14ae;console[_0x224d78(0x1a0)](_0x5e3596),_0x4686c4[_0x224d78(0x283)](0x1f4)[_0x224d78(0x275)]({'error':_0x224d78(0x24a)});});}catch(_0x4ce9aa){console['log'](_0x4ce9aa);}}),router['get'](a0_0x475af3(0x247),auth,async(_0x59768e,_0x13ed25)=>{var _0xbf4d0d=a0_0x475af3;try{const {username:_0x4031b3,email:_0x38ff04,role:_0x5577f8}=_0x59768e['user'],_0x16f33e=_0x59768e[_0xbf4d0d(0x238)],_0x42841f=await profile[_0xbf4d0d(0x1e3)]({'email':_0x16f33e[_0xbf4d0d(0x24d)]}),_0x2b8e2b=await master_shop[_0xbf4d0d(0x214)](),_0x229693=_0x59768e[_0xbf4d0d(0x1b3)]['id'],_0x3992f7=await sales_finished[_0xbf4d0d(0x1b1)](_0x229693);let _0xfc2d41=new Date(_0x3992f7[_0xbf4d0d(0x255)]),_0x577a64=('0'+_0xfc2d41[_0xbf4d0d(0x274)]())['slice'](-0x2),_0x5659ae=('0'+(_0xfc2d41[_0xbf4d0d(0x1eb)]()+0x1))['slice'](-0x2),_0x3fd2c3=_0xfc2d41[_0xbf4d0d(0x222)](),_0x408106=_0x3fd2c3+'-'+_0x5659ae+'-'+_0x577a64;var _0x267273=['Ambient',_0xbf4d0d(0x25d)];const _0x19b7f6=await warehouse['aggregate']([{'$match':{'name':_0x3992f7['warehouse_name'],'room':_0x3992f7['room']}},{'$unwind':'$product_details'},{'$group':{'_id':_0xbf4d0d(0x1a9),'name':{'$first':_0xbf4d0d(0x1ed)},'product_stock':{'$first':_0xbf4d0d(0x1d3)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xbf4d0d(0x256)},'secondary_code':{'$first':_0xbf4d0d(0x26c)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'}}}]),_0x2a0602=await customer['find']({});let _0x30c944;if(_0x16f33e[_0xbf4d0d(0x20b)]=='staff'){const _0x11e48b=await staff[_0xbf4d0d(0x1e3)]({'email':_0x16f33e[_0xbf4d0d(0x24d)]});_0x30c944=await warehouse[_0xbf4d0d(0x1df)]([{'$match':{'status':_0xbf4d0d(0x23c),'name':_0x11e48b[_0xbf4d0d(0x1a2)]}},{'$group':{'_id':_0xbf4d0d(0x236),'name':{'$first':'$name'}}}]);}else _0x30c944=await warehouse[_0xbf4d0d(0x1df)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0xbf4d0d(0x236),'name':{'$first':_0xbf4d0d(0x236)}}}]);const _0x2977a3=await product[_0xbf4d0d(0x214)]({});if(_0x2b8e2b[0x0][_0xbf4d0d(0x261)]==_0xbf4d0d(0x19f)){var _0x2c9c78=users['English'];console[_0xbf4d0d(0x252)](_0x2c9c78);}else{if(_0x2b8e2b[0x0][_0xbf4d0d(0x261)]==_0xbf4d0d(0x1e1))var _0x2c9c78=users[_0xbf4d0d(0x1e1)];else{if(_0x2b8e2b[0x0][_0xbf4d0d(0x261)]==_0xbf4d0d(0x1d5))var _0x2c9c78=users['German'];else{if(_0x2b8e2b[0x0]['language']=='Spanish')var _0x2c9c78=users[_0xbf4d0d(0x26e)];else{if(_0x2b8e2b[0x0][_0xbf4d0d(0x261)]=='French')var _0x2c9c78=users[_0xbf4d0d(0x1be)];else{if(_0x2b8e2b[0x0][_0xbf4d0d(0x261)]==_0xbf4d0d(0x251))var _0x2c9c78=users['Portuguese'];else{if(_0x2b8e2b[0x0][_0xbf4d0d(0x261)]==_0xbf4d0d(0x2ad))var _0x2c9c78=users[_0xbf4d0d(0x2ad)];else{if(_0x2b8e2b[0x0]['language']=='Arabic\x20(ae)')var _0x2c9c78=users['Arabic'];}}}}}}}_0x13ed25['render'](_0xbf4d0d(0x1c4),{'success':_0x59768e[_0xbf4d0d(0x19b)](_0xbf4d0d(0x1a1)),'errors':_0x59768e[_0xbf4d0d(0x19b)](_0xbf4d0d(0x1e7)),'role':_0x16f33e,'profile':_0x42841f,'customer':_0x2a0602,'warehouse':_0x30c944,'product':_0x19b7f6,'user':_0x3992f7,'master_shop':_0x2b8e2b,'unit':_0x2977a3,'language':_0x2c9c78,'rooms_data':_0x267273,'ed_fullDate':_0x408106});}catch(_0x1815a8){console[_0xbf4d0d(0x252)](_0x1815a8);}}),router[a0_0x475af3(0x292)](a0_0x475af3(0x247),auth,async(_0x240f0f,_0x395d9d)=>{var _0x2cf2ed=a0_0x475af3;try{const _0x14123f=_0x240f0f['params']['id'],_0x5191fe=await sales_finished[_0x2cf2ed(0x1e3)]({'_id':_0x240f0f[_0x2cf2ed(0x1b3)]['id']}),_0x1216a3=await warehouse[_0x2cf2ed(0x1e3)]({'name':_0x5191fe[_0x2cf2ed(0x27e)],'room':_0x240f0f[_0x2cf2ed(0x28d)]['room'],'warehouse_category':_0x2cf2ed(0x244)}),{invoice:_0x4468ed,customer:_0xefc13,date:_0x4da011,warehouse_name:_0x3388e6,product_name:_0x1a8a10,stock:_0x99a810,adjust_qty:_0x24ccb1,note:_0x4c02fc,room:_0x120d83,primary_code:_0x39ea2f,secondary_code:_0x32a9ef,prod_code:_0x5a304f,level:_0x1be0b2,isle:_0x33142f,pallet:_0x130e0c,expiry_date:_0x128525}=_0x240f0f[_0x2cf2ed(0x28d)];if(typeof _0x1a8a10==_0x2cf2ed(0x22b))var _0x504ba0=[_0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x1d2)]],_0x32a877=[_0x240f0f['body']['stock']],_0x43fec7=[_0x240f0f['body'][_0x2cf2ed(0x279)]],_0x1f96be=[_0x240f0f['body']['primary_code']],_0x45ff73=[_0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x1a3)]],_0x22a879=[_0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x1cd)]],_0x575677=[_0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x21c)]],_0x11c6d3=[_0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x255)]];else var _0x504ba0=[..._0x240f0f[_0x2cf2ed(0x28d)]['product_name']],_0x32a877=[..._0x240f0f['body']['stock']],_0x43fec7=[..._0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x279)]],_0x1f96be=[..._0x240f0f['body']['primary_code']],_0x45ff73=[..._0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x1a3)]],_0x22a879=[..._0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x1cd)]],_0x575677=[..._0x240f0f[_0x2cf2ed(0x28d)]['level']],_0x11c6d3=[..._0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x255)]];const _0x4dab72=_0x504ba0[_0x2cf2ed(0x270)](_0x4014e2=>{return _0x4014e2={'product_name':_0x4014e2};});_0x32a877[_0x2cf2ed(0x1ff)]((_0x4501cd,_0x4afea3)=>{var _0x26fa69=_0x2cf2ed;_0x4dab72[_0x4afea3][_0x26fa69(0x22c)]=_0x4501cd;}),_0x43fec7[_0x2cf2ed(0x1ff)]((_0x492dd3,_0x4a4753)=>{_0x4dab72[_0x4a4753]['quantity']=_0x492dd3;}),_0x1f96be[_0x2cf2ed(0x1ff)]((_0xcd259c,_0x583755)=>{_0x4dab72[_0x583755]['primary_code']=_0xcd259c;}),_0x45ff73[_0x2cf2ed(0x1ff)]((_0x1924c2,_0x2249cf)=>{var _0x2e83a2=_0x2cf2ed;_0x4dab72[_0x2249cf][_0x2e83a2(0x1a3)]=_0x1924c2;}),_0x22a879['forEach']((_0x263a5e,_0x3a631b)=>{_0x4dab72[_0x3a631b]['product_code']=_0x263a5e;}),_0x575677[_0x2cf2ed(0x1ff)]((_0x73e84c,_0x32ece8)=>{var _0x184dd5=_0x2cf2ed;_0x4dab72[_0x32ece8][_0x184dd5(0x21c)]=_0x73e84c;}),_0x11c6d3[_0x2cf2ed(0x1ff)]((_0x7b8927,_0x4ffe8b)=>{var _0x14f430=_0x2cf2ed;_0x4dab72[_0x4ffe8b][_0x14f430(0x255)]=_0x7b8927;});var _0x407c92=0x0;_0x4dab72[_0x2cf2ed(0x1ff)](_0x3e2691=>{var _0xea6d08=_0x2cf2ed;console[_0xea6d08(0x252)]('foreach\x20newproduct',_0x3e2691),(parseInt(_0x3e2691[_0xea6d08(0x22c)])<parseInt(_0x3e2691[_0xea6d08(0x224)])||parseInt(_0x3e2691[_0xea6d08(0x224)])==0x0)&&_0x407c92++;});if(_0x407c92!=0x0)return _0x240f0f[_0x2cf2ed(0x19b)](_0x2cf2ed(0x1e7),_0x2cf2ed(0x1bc)),_0x395d9d[_0x2cf2ed(0x2a6)](_0x2cf2ed(0x1d8));_0x5191fe['sale_product'][_0x2cf2ed(0x1ff)](_0xbb2c45=>{var _0x1e9b44=_0x2cf2ed;const _0x4fb217=_0x1216a3[_0x1e9b44(0x1f7)]['map'](_0x5067a8=>{var _0x445c16=_0x1e9b44;_0x5067a8['product_name']==_0xbb2c45[_0x445c16(0x1d2)]&&_0x5067a8[_0x445c16(0x1ce)]==_0xbb2c45[_0x445c16(0x1ce)]&&(_0x5067a8[_0x445c16(0x22a)]=parseInt(_0x5067a8[_0x445c16(0x22a)])+parseInt(_0xbb2c45[_0x445c16(0x224)]));});}),await _0x1216a3[_0x2cf2ed(0x1d6)]();const _0x5358c4=_0x4dab72[_0x2cf2ed(0x20f)](_0x56efe7=>_0x56efe7['quantity']!=='0'&&_0x56efe7[_0x2cf2ed(0x224)]!=='');_0x5191fe['invoice']=_0x4468ed,_0x5191fe['customer']=_0xefc13,_0x5191fe[_0x2cf2ed(0x296)]=_0x4da011,_0x5191fe['warehouse_name']=_0x3388e6,_0x5191fe[_0x2cf2ed(0x1b8)]=_0x5358c4,_0x5191fe['note']=_0x4c02fc,_0x5191fe['room']=_0x120d83;const _0x36c4eb=await _0x5191fe[_0x2cf2ed(0x1d6)](),_0x5a48cd=await sales_finished[_0x2cf2ed(0x1e3)]({'_id':_0x240f0f[_0x2cf2ed(0x1b3)]['id']}),_0x1c02a5=await warehouse['findOne']({'name':_0x3388e6,'room':_0x120d83,'warehouse_category':_0x2cf2ed(0x244)});_0x5a48cd['sale_product'][_0x2cf2ed(0x1ff)](_0x464b5e=>{var _0x23c292=_0x2cf2ed;const _0x3012ce=_0x1c02a5['product_details'][_0x23c292(0x270)](_0x4063a8=>{var _0x4892d0=_0x23c292;_0x4063a8['product_name']==_0x464b5e['product_name']&&_0x4063a8[_0x4892d0(0x1ce)]==_0x464b5e[_0x4892d0(0x1ce)]&&(_0x4063a8[_0x4892d0(0x22a)]=parseInt(_0x4063a8[_0x4892d0(0x22a)])-parseInt(_0x464b5e[_0x4892d0(0x224)]));});}),console[_0x2cf2ed(0x252)](_0x2cf2ed(0x245),_0x1c02a5),await _0x1c02a5[_0x2cf2ed(0x1d6)]();const _0x38f120=await c_payment_data[_0x2cf2ed(0x1e3)]({'invoice':_0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x1af)]});_0x38f120[_0x2cf2ed(0x226)]=_0x240f0f[_0x2cf2ed(0x28d)][_0x2cf2ed(0x226)],await _0x38f120[_0x2cf2ed(0x1d6)](),_0x240f0f['flash'](_0x2cf2ed(0x1a1),_0x2cf2ed(0x299)),_0x395d9d['redirect']('/all_sales_finished/view');}catch(_0x42c0cf){console['log'](_0x42c0cf);}}),router[a0_0x475af3(0x292)](a0_0x475af3(0x287),auth,async(_0x3e48a1,_0x2cd36d)=>{var _0x549db8=a0_0x475af3;try{const _0x4bab42=_0x3e48a1[_0x549db8(0x1b3)]['id'],{invoice:_0x498621,customer:_0x56a028,receivable_amount:_0x27170b,received_amount:_0x13ec99}=_0x3e48a1[_0x549db8(0x28d)],_0x1a3842=await sales[_0x549db8(0x1b1)](_0x4bab42);console['log'](_0x1a3842);var _0x42c6c0=_0x27170b-_0x13ec99;console[_0x549db8(0x252)](_0x13ec99),_0x1a3842[_0x549db8(0x258)]=parseFloat(_0x13ec99)+parseFloat(_0x1a3842[_0x549db8(0x258)]),_0x1a3842[_0x549db8(0x290)]=_0x42c6c0,console[_0x549db8(0x252)](_0x1a3842);const _0x370084=await _0x1a3842[_0x549db8(0x1d6)](),_0xe10a10=await c_payment_data[_0x549db8(0x1e3)]({'invoice':_0x498621});_0xe10a10[_0x549db8(0x21a)]=_0x42c6c0,await _0xe10a10[_0x549db8(0x1d6)]();let _0x158191=new Date(),_0x14c4a2=('0'+_0x158191[_0x549db8(0x274)]())[_0x549db8(0x1c2)](-0x2),_0x1fb888=('0'+(_0x158191['getMonth']()+0x1))[_0x549db8(0x1c2)](-0x2),_0x56ebe8=_0x158191[_0x549db8(0x222)](),_0x138adc=_0x56ebe8+'-'+_0x1fb888+'-'+_0x14c4a2;const _0x3e716e=new customer_payment({'invoice':_0x498621,'date':_0x56ebe8+'-'+_0x1fb888+'-'+_0x14c4a2,'customer':_0x56a028,'reason':_0x549db8(0x269),'amount':_0x13ec99}),_0x5872de=await _0x3e716e[_0x549db8(0x1d6)]();_0x3e48a1['flash']('success',_0x549db8(0x227)),_0x2cd36d[_0x549db8(0x2a6)](_0x549db8(0x20e));}catch(_0x2aa2d5){console['log'](_0x2aa2d5);}}),router[a0_0x475af3(0x207)](a0_0x475af3(0x1ad),auth,async(_0x3073e1,_0x5c5bf1)=>{var _0x4f5a7b=a0_0x475af3;try{const {username:_0x476b8c,email:_0x4a229c,role:_0x5efedc}=_0x3073e1[_0x4f5a7b(0x238)],_0x1a281c=_0x3073e1[_0x4f5a7b(0x238)],_0xad6884=await profile[_0x4f5a7b(0x1e3)]({'email':_0x1a281c[_0x4f5a7b(0x24d)]}),_0x50b298=await master_shop[_0x4f5a7b(0x214)]();console[_0x4f5a7b(0x252)](_0x4f5a7b(0x210),_0x50b298);const _0x18e703=_0x3073e1[_0x4f5a7b(0x1b3)]['id'],_0x542e06=await sales[_0x4f5a7b(0x1b1)](_0x18e703);console[_0x4f5a7b(0x252)](_0x542e06);const _0x569417=await customer[_0x4f5a7b(0x1e3)]({'name':_0x542e06['customer']});console['log'](_0x569417);if(_0x50b298[0x0]['language']=='English\x20(US)'){var _0x3da766=users['English'];console['log'](_0x3da766);}else{if(_0x50b298[0x0][_0x4f5a7b(0x261)]==_0x4f5a7b(0x1e1))var _0x3da766=users[_0x4f5a7b(0x1e1)];else{if(_0x50b298[0x0]['language']==_0x4f5a7b(0x1d5))var _0x3da766=users[_0x4f5a7b(0x1d5)];else{if(_0x50b298[0x0][_0x4f5a7b(0x261)]=='Spanish')var _0x3da766=users[_0x4f5a7b(0x26e)];else{if(_0x50b298[0x0][_0x4f5a7b(0x261)]=='French')var _0x3da766=users['French'];else{if(_0x50b298[0x0][_0x4f5a7b(0x261)]==_0x4f5a7b(0x251))var _0x3da766=users[_0x4f5a7b(0x1db)];else{if(_0x50b298[0x0][_0x4f5a7b(0x261)]==_0x4f5a7b(0x2ad))var _0x3da766=users['Chinese'];else{if(_0x50b298[0x0]['language']==_0x4f5a7b(0x1f3))var _0x3da766=users['Arabic'];}}}}}}}_0x5c5bf1[_0x4f5a7b(0x21f)](_0x4f5a7b(0x220),{'success':_0x3073e1[_0x4f5a7b(0x19b)]('success'),'errors':_0x3073e1[_0x4f5a7b(0x19b)](_0x4f5a7b(0x1e7)),'role':_0x1a281c,'profile':_0xad6884,'master_shop':_0x50b298,'customers':_0x569417,'sales':_0x542e06,'language':_0x3da766});}catch(_0x37a3bd){console[_0x4f5a7b(0x252)](_0x37a3bd);}}),router[a0_0x475af3(0x207)](a0_0x475af3(0x219),auth,async(_0x59b97f,_0xee2509)=>{var _0x1bb86f=a0_0x475af3;try{const {username:_0x5426de,email:_0x40a5e2,role:_0x1183eb}=_0x59b97f[_0x1bb86f(0x238)],_0x392aa4=_0x59b97f['user'],_0x3521c7=await profile[_0x1bb86f(0x1e3)]({'email':_0x392aa4[_0x1bb86f(0x24d)]}),_0x2e957b=await master_shop[_0x1bb86f(0x214)](),_0x1e625f=_0x59b97f[_0x1bb86f(0x1b3)]['id'],_0x12a420=await sales_finished[_0x1bb86f(0x1b1)](_0x1e625f),_0x3a19c6=await warehouse[_0x1bb86f(0x1df)]([{'$match':{'name':_0x12a420[_0x1bb86f(0x27e)]}},{'$unwind':_0x1bb86f(0x29a)},{'$group':{'_id':_0x1bb86f(0x1a9),'name':{'$first':_0x1bb86f(0x1ed)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1bb86f(0x204)},'bin':{'$first':_0x1bb86f(0x221)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x1bb86f(0x23e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1bb86f(0x1c5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1bb86f(0x241)},'expiry_date':{'$first':_0x1bb86f(0x278)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':_0x1bb86f(0x223)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x1bb86f(0x2a1)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x1bb86f(0x28f)}}}]),_0x1933d6=await product[_0x1bb86f(0x214)]({}),_0x5d6aec=await warehouse[_0x1bb86f(0x1df)]([{'$match':{'status':_0x1bb86f(0x23c),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x1bb86f(0x239),'$ne':_0x1bb86f(0x211)}}},{'$group':{'_id':_0x1bb86f(0x236),'name':{'$first':_0x1bb86f(0x236)}}},{'$sort':{'name':0x1}}]);var _0x5a3300=[_0x1bb86f(0x264)];const _0x343005=await warehouse[_0x1bb86f(0x1df)]([{'$match':{'status':_0x1bb86f(0x23c),'name':_0x1bb86f(0x211)}},{'$group':{'_id':_0x1bb86f(0x236),'name':{'$first':_0x1bb86f(0x236)}}},{'$sort':{'name':0x1}}]);if(_0x2e957b[0x0][_0x1bb86f(0x261)]==_0x1bb86f(0x19f)){var _0x535c98=users[_0x1bb86f(0x1fa)];console['log'](_0x535c98);}else{if(_0x2e957b[0x0][_0x1bb86f(0x261)]=='Hindi')var _0x535c98=users[_0x1bb86f(0x1e1)];else{if(_0x2e957b[0x0]['language']==_0x1bb86f(0x1d5))var _0x535c98=users[_0x1bb86f(0x1d5)];else{if(_0x2e957b[0x0][_0x1bb86f(0x261)]==_0x1bb86f(0x26e))var _0x535c98=users[_0x1bb86f(0x26e)];else{if(_0x2e957b[0x0][_0x1bb86f(0x261)]==_0x1bb86f(0x1be))var _0x535c98=users[_0x1bb86f(0x1be)];else{if(_0x2e957b[0x0][_0x1bb86f(0x261)]==_0x1bb86f(0x251))var _0x535c98=users[_0x1bb86f(0x1db)];else{if(_0x2e957b[0x0][_0x1bb86f(0x261)]=='Chinese')var _0x535c98=users[_0x1bb86f(0x2ad)];else{if(_0x2e957b[0x0][_0x1bb86f(0x261)]==_0x1bb86f(0x1f3))var _0x535c98=users['Arabic'];}}}}}}}_0xee2509[_0x1bb86f(0x21f)]('return_sale_finished',{'success':_0x59b97f[_0x1bb86f(0x19b)]('success'),'errors':_0x59b97f[_0x1bb86f(0x19b)](_0x1bb86f(0x1e7)),'role':_0x392aa4,'profile':_0x3521c7,'user':_0x12a420,'stock':_0x3a19c6,'master_shop':_0x2e957b,'unit':_0x1933d6,'language':_0x535c98,'warehouses':_0x5d6aec,'rooms':_0x5a3300,'warehouse_QA':_0x343005});}catch(_0x2efa99){console[_0x1bb86f(0x252)](_0x2efa99),_0xee2509[_0x1bb86f(0x283)](0xc8)[_0x1bb86f(0x275)]({'message':_0x2efa99[_0x1bb86f(0x2a8)]});}}),router[a0_0x475af3(0x292)](a0_0x475af3(0x219),auth,async(_0x552e47,_0x27ddf2)=>{var _0x455214=a0_0x475af3;if(_0x552e47['body'][_0x455214(0x1f0)]=='QA')try{const {invoice:_0x4d0828,date:_0x321e0a,warehouse_name:_0x18c4be,product_name:_0x54f921,primary_code:_0xdff190,secondary_code:_0x1bc69c,product_code:_0x5c5fbd,sales_quantity:_0x3f7161,stocks:_0x5702d8,return_qty:_0x310084,Room_name:_0x4f06c9,to_warehouse_name_QA:_0x565255,to_Room_name_QA:_0x28f1b5,note:_0x372433,for_categorize:_0x337ad4,product_name_QA1:_0x226e01}=_0x552e47[_0x455214(0x28d)];if(typeof _0x226e01==_0x455214(0x22b))var _0x1351ba=[_0x552e47[_0x455214(0x28d)][_0x455214(0x25c)]],_0x95e8ea=[_0x552e47[_0x455214(0x28d)][_0x455214(0x2a3)]],_0x41f21b=[_0x552e47[_0x455214(0x28d)][_0x455214(0x284)]],_0x39ec1c=[_0x552e47[_0x455214(0x28d)][_0x455214(0x1c9)]],_0x294e0a=[_0x552e47[_0x455214(0x28d)][_0x455214(0x271)]],_0x399ad8=[_0x552e47[_0x455214(0x28d)]['stocks_QA']],_0x183344=[_0x552e47[_0x455214(0x28d)][_0x455214(0x1c1)]],_0x11253d=[_0x552e47[_0x455214(0x28d)]['maxPerUnit_QA']],_0x6fcab7=[_0x552e47[_0x455214(0x28d)][_0x455214(0x228)]],_0xa912d4=[_0x552e47[_0x455214(0x28d)][_0x455214(0x280)]],_0xb0db2=[_0x552e47[_0x455214(0x28d)][_0x455214(0x1c6)]],_0x4295d0=[_0x552e47[_0x455214(0x28d)]['unit_QA']],_0x402c13=[_0x552e47[_0x455214(0x28d)][_0x455214(0x237)]],_0x51420b=[_0x552e47[_0x455214(0x28d)][_0x455214(0x1b0)]];else var _0x1351ba=[..._0x552e47[_0x455214(0x28d)]['product_name_QA1']],_0x95e8ea=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x2a3)]],_0x41f21b=[..._0x552e47['body'][_0x455214(0x284)]],_0x39ec1c=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x1c9)]],_0x294e0a=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x271)]],_0x399ad8=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x2ae)]],_0x183344=[..._0x552e47['body'][_0x455214(0x1c1)]],_0x11253d=[..._0x552e47['body']['maxPerUnit_QA']],_0x6fcab7=[..._0x552e47['body'][_0x455214(0x228)]],_0xa912d4=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x280)]],_0xb0db2=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x1c6)]],_0x4295d0=[..._0x552e47['body'][_0x455214(0x19c)]],_0x402c13=[..._0x552e47[_0x455214(0x28d)]['production_date_QA']],_0x51420b=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x1b0)]];const _0x2f4159=_0x1351ba['map'](_0x2e9869=>{return _0x2e9869={'product_name':_0x2e9869};});_0x95e8ea[_0x455214(0x1ff)]((_0x53e79b,_0x43917f)=>{var _0x12599f=_0x455214;_0x2f4159[_0x43917f][_0x12599f(0x294)]=_0x53e79b;}),_0x41f21b['forEach']((_0x8bc83,_0x5d1e56)=>{var _0x5d0e0f=_0x455214;_0x2f4159[_0x5d1e56][_0x5d0e0f(0x1a3)]=_0x8bc83;}),_0x39ec1c[_0x455214(0x1ff)]((_0x53fd63,_0x49de49)=>{var _0x1fb7c1=_0x455214;_0x2f4159[_0x49de49][_0x1fb7c1(0x29b)]=_0x53fd63;}),_0x294e0a[_0x455214(0x1ff)]((_0xcc36b1,_0x147115)=>{var _0x55489c=_0x455214;_0x2f4159[_0x147115][_0x55489c(0x28e)]=_0xcc36b1;}),_0x399ad8[_0x455214(0x1ff)]((_0x58a444,_0x4922bc)=>{var _0x25053c=_0x455214;_0x2f4159[_0x4922bc][_0x25053c(0x22c)]=_0x58a444;}),_0x183344['forEach']((_0x3964b2,_0x4bbfa7)=>{var _0xad2752=_0x455214;_0x2f4159[_0x4bbfa7][_0xad2752(0x1c7)]=_0x3964b2;}),_0x11253d['forEach']((_0x156d64,_0x3ec6af)=>{var _0x4456fa=_0x455214;_0x2f4159[_0x3ec6af][_0x4456fa(0x29f)]=_0x156d64;}),_0x6fcab7[_0x455214(0x1ff)]((_0x513a36,_0x239acf)=>{var _0x174d7f=_0x455214;_0x2f4159[_0x239acf][_0x174d7f(0x2aa)]=_0x513a36;}),_0xa912d4['forEach']((_0x5ded69,_0x111b20)=>{var _0x27d236=_0x455214;_0x2f4159[_0x111b20][_0x27d236(0x1e6)]=_0x5ded69;}),_0xb0db2['forEach']((_0xb92ee6,_0x4ea1a0)=>{var _0x11db76=_0x455214;_0x2f4159[_0x4ea1a0][_0x11db76(0x297)]=_0xb92ee6;}),_0x4295d0[_0x455214(0x1ff)]((_0x1ae142,_0x1f1b07)=>{var _0x206199=_0x455214;_0x2f4159[_0x1f1b07][_0x206199(0x1fc)]=_0x1ae142;}),_0x402c13[_0x455214(0x1ff)]((_0x11999b,_0x560cd5)=>{var _0x1722a1=_0x455214;_0x2f4159[_0x560cd5][_0x1722a1(0x206)]=_0x11999b;}),_0x51420b[_0x455214(0x1ff)]((_0x3c0ec8,_0x2722b0)=>{_0x2f4159[_0x2722b0]['expiry_date']=_0x3c0ec8;});const _0x278251=await sales_finished[_0x455214(0x1e3)]({'invoice':_0x4d0828});_0x278251[_0x455214(0x293)]=_0x455214(0x1b7);const _0x360a36=await _0x278251['save'](),_0x31d3e5=new sales_return_finished({'invoice':_0x4d0828,'customer':_0x552e47['body'][_0x455214(0x233)],'date':_0x321e0a,'warehouse_name':_0x18c4be,'room':_0x4f06c9,'ToWarehouse':_0x565255,'ToRoom':_0x28f1b5,'return_sale_QA':_0x2f4159,'note':_0x372433,'warehouse_cat':_0x337ad4}),_0xd6ae=await _0x31d3e5[_0x455214(0x1d6)](),_0x35f386=await sales_return_finished['findOne']({'invoice':_0x4d0828}),_0x5ba39c=await warehouse[_0x455214(0x1e3)]({'name':_0x565255,'room':_0x28f1b5});_0x35f386[_0x455214(0x1d9)][_0x455214(0x1ff)](_0x472642=>{var _0x4b3703=_0x455214,_0x254a5c=0x0;const _0x18e854=_0x5ba39c[_0x4b3703(0x1f7)][_0x4b3703(0x270)](_0x1028fe=>{var _0x24bee9=_0x4b3703;_0x1028fe[_0x24bee9(0x1d2)]==_0x472642[_0x24bee9(0x1d2)]&&_0x1028fe[_0x24bee9(0x255)]==_0x472642['expiry_date']&&_0x1028fe[_0x24bee9(0x206)]==_0x472642[_0x24bee9(0x206)]&&_0x1028fe[_0x24bee9(0x1e6)]==_0x472642[_0x24bee9(0x1e6)]&&(_0x1028fe['product_stock']=parseInt(_0x1028fe[_0x24bee9(0x22a)])+parseInt(_0x472642[_0x24bee9(0x1c7)]),_0x254a5c++);});_0x254a5c=='0'&&(_0x5ba39c[_0x4b3703(0x1f7)]=_0x5ba39c[_0x4b3703(0x1f7)][_0x4b3703(0x1f8)]({'product_name':_0x472642['product_name'],'product_stock':_0x472642[_0x4b3703(0x1c7)],'primary_code':_0x472642[_0x4b3703(0x294)],'secondary_code':_0x472642['secondary_code'],'product_code':_0x472642[_0x4b3703(0x29b)],'batch_code':_0x472642[_0x4b3703(0x1e6)],'maxPerUnit':_0x472642[_0x4b3703(0x29f)],'production_date':_0x472642[_0x4b3703(0x206)],'expiry_date':_0x472642[_0x4b3703(0x255)],'secondary_unit':_0x472642[_0x4b3703(0x297)],'unit':_0x472642['unit'],'maxProducts':_0x472642[_0x4b3703(0x2aa)],'bay':_0x472642[_0x4b3703(0x1ce)]}));}),await _0x5ba39c[_0x455214(0x1d6)]();const _0x37f2d9=new c_payment_data({'invoice':_0x4d0828,'customer':_0x552e47['body'][_0x455214(0x233)],'reason':_0x455214(0x232)});await _0x37f2d9['save']();const _0x11fa9b=await master_shop[_0x455214(0x214)](),_0x4f602d=await email_settings[_0x455214(0x1e3)](),_0x1d85c9=await customer[_0x455214(0x1e3)]({'name':_0x552e47[_0x455214(0x28d)][_0x455214(0x233)]});_0x11fa9b[0x0][_0x455214(0x1f5)]==0x1?(right_currency=_0x11fa9b[0x0][_0x455214(0x230)],left_currency=''):(right_currency='',left_currency=_0x11fa9b[0x0]['currency']);var _0x2b8cea=_0x1351ba,_0xc10209=_0x183344,_0x4a58e1='',_0x5716e9;for(_0x5716e9 in _0x2b8cea){_0x4a58e1+=_0x455214(0x19e)+_0x455214(0x288)+_0x2b8cea[_0x5716e9]+_0x455214(0x1dd)+_0x455214(0x288)+_0xc10209[_0x5716e9]+_0x455214(0x1dd)+'</tr>';}console[_0x455214(0x252)](_0x455214(0x23a),_0x4a58e1);let _0x1508cd=nodemailer[_0x455214(0x23d)]({'service':_0x455214(0x231),'auth':{'user':_0x4f602d['email'],'pass':_0x4f602d[_0x455214(0x285)]}}),_0x4479bb={'from':_0x4f602d[_0x455214(0x24d)],'to':_0x1d85c9[_0x455214(0x24d)],'subject':_0x455214(0x213),'attachments':[{'filename':'Logo.png','path':__dirname+_0x455214(0x1da)+_0x455214(0x218)+_0x11fa9b[0x0][_0x455214(0x21b)],'cid':_0x455214(0x243)}],'html':_0x455214(0x1ea)+_0x455214(0x29d)+_0x455214(0x215)+_0x455214(0x1c3)+_0x455214(0x1a6)+_0x455214(0x1c3)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x455214(0x25b)+_0x455214(0x1c3)+_0x455214(0x1c8)+_0x11fa9b[0x0][_0x455214(0x254)]+_0x455214(0x23f)+_0x455214(0x25b)+_0x455214(0x25b)+_0x455214(0x1fd)+_0x455214(0x1c3)+_0x455214(0x2a4)+'\x20Order\x20Number\x20:\x20'+_0x4d0828+'\x20'+_0x455214(0x246)+_0x455214(0x1a7)+_0x321e0a+'\x20'+_0x455214(0x2a9)+_0x455214(0x29c)+_0x455214(0x25b)+_0x455214(0x24b)+_0x455214(0x253)+_0x455214(0x19e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x455214(0x267)+_0x455214(0x1cc)+_0x455214(0x1e5)+_0x455214(0x24f)+'\x20'+_0x4a58e1+'\x20'+'</tbody>'+_0x455214(0x1bf)+'<div>'+_0x455214(0x1ef)+_0x455214(0x2ac)+_0x11fa9b[0x0]['site_title']+'</h5>'+_0x455214(0x25b)+_0x455214(0x25b)+'</body></html>'};_0x1508cd[_0x455214(0x1ee)](_0x4479bb,function(_0x36eb0f,_0x4569fc){var _0x49bb16=_0x455214;_0x36eb0f?(console[_0x49bb16(0x252)](_0x36eb0f),console[_0x49bb16(0x252)](_0x49bb16(0x1aa))):console[_0x49bb16(0x252)]('Email\x20sent\x20successfully');}),_0x552e47[_0x455214(0x19b)](_0x455214(0x1a1),'sales\x20item\x20return\x20successfull'),_0x27ddf2[_0x455214(0x2a6)]('/all_sales_finished/view');}catch(_0x3f0271){_0x27ddf2['status'](0xc8)[_0x455214(0x275)]({'message1':_0x3f0271[_0x455214(0x2a8)]});}else{if(_0x552e47[_0x455214(0x28d)][_0x455214(0x1f0)]=='GS')try{const {invoice:_0x24901f,date:_0x13f8c4,warehouse_name:_0x55ece4,product_name:_0x5a5abf,primary_code:_0x10da82,secondary_code:_0x16ea78,product_code:_0x3e6fac,sales_quantity:_0x5c2ac6,stocks:_0x26e553,return_qty:_0x43811f,Room_name:_0xb495a0,to_warehouse_name:_0x22bb17,to_Room_name:_0x4c9eed,note:_0x4947b8,level:_0x11130f,isle:_0x5d4c6b,pallet:_0x34a3cb,for_categorize:_0x52dc3c}=_0x552e47[_0x455214(0x28d)];if(typeof _0x5a5abf==_0x455214(0x22b))var _0x1351ba=[_0x552e47[_0x455214(0x28d)][_0x455214(0x1d2)]],_0x95e8ea=[_0x552e47[_0x455214(0x28d)]['primary_code']],_0x41f21b=[_0x552e47[_0x455214(0x28d)][_0x455214(0x1a3)]],_0x39ec1c=[_0x552e47[_0x455214(0x28d)][_0x455214(0x29b)]],_0x294e0a=[_0x552e47['body'][_0x455214(0x262)]],_0x183344=[_0x552e47[_0x455214(0x28d)][_0x455214(0x1c7)]],_0x298fb7=[_0x552e47[_0x455214(0x28d)]['bay']],_0x11253d=[_0x552e47[_0x455214(0x28d)][_0x455214(0x29f)]],_0x6fcab7=[_0x552e47[_0x455214(0x28d)][_0x455214(0x2aa)]],_0xa912d4=[_0x552e47[_0x455214(0x28d)]['batch_code']],_0xb0db2=[_0x552e47[_0x455214(0x28d)]['secondary_unit']],_0x4295d0=[_0x552e47['body']['unit']],_0x402c13=[_0x552e47['body']['production_date']],_0x51420b=[_0x552e47[_0x455214(0x28d)]['expiry_date']];else var _0x1351ba=[..._0x552e47[_0x455214(0x28d)]['product_name']],_0x95e8ea=[..._0x552e47[_0x455214(0x28d)]['primary_code']],_0x41f21b=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x1a3)]],_0x39ec1c=[..._0x552e47['body']['product_code']],_0x294e0a=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x262)]],_0x183344=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x1c7)]],_0x298fb7=[..._0x552e47['body']['bay']],_0x11253d=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x29f)]],_0x6fcab7=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x2aa)]],_0xa912d4=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x1e6)]],_0xb0db2=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x297)]],_0x4295d0=[..._0x552e47[_0x455214(0x28d)][_0x455214(0x1fc)]],_0x402c13=[..._0x552e47['body']['production_date']],_0x51420b=[..._0x552e47[_0x455214(0x28d)]['expiry_date']];const _0xe8006d=_0x1351ba[_0x455214(0x270)](_0x129a93=>{return _0x129a93={'product_name':_0x129a93};});_0x95e8ea[_0x455214(0x1ff)]((_0x3cb137,_0x17dd0d)=>{var _0x524623=_0x455214;_0xe8006d[_0x17dd0d][_0x524623(0x294)]=_0x3cb137;}),_0x41f21b[_0x455214(0x1ff)]((_0x2de0cb,_0xca7895)=>{var _0x55c133=_0x455214;_0xe8006d[_0xca7895][_0x55c133(0x1a3)]=_0x2de0cb;}),_0x39ec1c[_0x455214(0x1ff)]((_0xf94610,_0x1905c2)=>{var _0x27b366=_0x455214;_0xe8006d[_0x1905c2][_0x27b366(0x29b)]=_0xf94610;}),_0x294e0a[_0x455214(0x1ff)]((_0x19ff74,_0x2aa63d)=>{_0xe8006d[_0x2aa63d]['sale_qty']=_0x19ff74;}),_0x183344[_0x455214(0x1ff)]((_0x3304aa,_0x23c927)=>{var _0x2e19ef=_0x455214;_0xe8006d[_0x23c927][_0x2e19ef(0x1c7)]=_0x3304aa;}),_0x298fb7[_0x455214(0x1ff)]((_0x4d5f36,_0x2a47b2)=>{var _0x3f9e01=_0x455214;_0xe8006d[_0x2a47b2][_0x3f9e01(0x1ce)]=_0x4d5f36;}),_0x11253d[_0x455214(0x1ff)]((_0x225fce,_0x2f9b45)=>{_0xe8006d[_0x2f9b45]['maxPerUnit']=_0x225fce;}),_0x6fcab7[_0x455214(0x1ff)]((_0x3be27e,_0xab0be1)=>{var _0x7d1799=_0x455214;_0xe8006d[_0xab0be1][_0x7d1799(0x2aa)]=_0x3be27e;}),_0xa912d4[_0x455214(0x1ff)]((_0x519875,_0x3e4cb3)=>{var _0x4f1c65=_0x455214;_0xe8006d[_0x3e4cb3][_0x4f1c65(0x1e6)]=_0x519875;}),_0xb0db2[_0x455214(0x1ff)]((_0x572e0c,_0x305a66)=>{var _0x14d179=_0x455214;_0xe8006d[_0x305a66][_0x14d179(0x297)]=_0x572e0c;}),_0x4295d0[_0x455214(0x1ff)]((_0x5cae78,_0x2569f5)=>{_0xe8006d[_0x2569f5]['unit']=_0x5cae78;}),_0x402c13['forEach']((_0x39b367,_0x1cd7f8)=>{_0xe8006d[_0x1cd7f8]['production_date']=_0x39b367;}),_0x51420b[_0x455214(0x1ff)]((_0xec971c,_0x423cfe)=>{var _0x36fb43=_0x455214;_0xe8006d[_0x423cfe][_0x36fb43(0x255)]=_0xec971c;});var _0x21b1b3=0x0;_0xe8006d[_0x455214(0x1ff)](_0x29d5df=>{var _0x33e711=_0x455214;(parseInt(_0x29d5df['sale_qty'])<parseInt(_0x29d5df[_0x33e711(0x1c7)])||parseInt(_0x29d5df[_0x33e711(0x22c)])<parseInt(_0x29d5df[_0x33e711(0x1c7)])&&parseInt(_0x29d5df[_0x33e711(0x28e)])>parseInt(_0x29d5df['return_qty'])||parseInt(_0x29d5df[_0x33e711(0x1c7)])==0x0)&&_0x21b1b3++;});if(_0x21b1b3!=0x0)return _0x552e47[_0x455214(0x19b)](_0x455214(0x1e7),_0x455214(0x203)),_0x27ddf2['redirect'](_0x455214(0x1d8));const _0x1a5e58=await sales_finished[_0x455214(0x1e3)]({'invoice':_0x24901f});_0x1a5e58[_0x455214(0x293)]=_0x455214(0x1b7);const _0x4df097=await _0x1a5e58[_0x455214(0x1d6)](),_0x109905=new sales_return_finished({'invoice':_0x24901f,'customer':_0x552e47[_0x455214(0x28d)][_0x455214(0x233)],'date':_0x13f8c4,'warehouse_name':_0x55ece4,'room':_0xb495a0,'ToWarehouse':_0x22bb17,'ToRoom':_0x4c9eed,'return_sale':_0xe8006d,'note':_0x4947b8,'warehouse_cat':_0x52dc3c}),_0x2d129e=await _0x109905[_0x455214(0x1d6)](),_0x48afcc=await sales_return_finished[_0x455214(0x1e3)]({'invoice':_0x24901f}),_0x6014af=await warehouse[_0x455214(0x1e3)]({'name':_0x22bb17,'room':_0x4c9eed,'warehouse_category':_0x455214(0x244)});_0x48afcc['return_sale'][_0x455214(0x1ff)](_0x4b12b6=>{var _0x57a356=_0x455214,_0x39b277=0x0;const _0x26d25b=_0x6014af[_0x57a356(0x1f7)][_0x57a356(0x270)](_0x3d8519=>{var _0x321d7f=_0x57a356;_0x3d8519[_0x321d7f(0x1d2)]==_0x4b12b6[_0x321d7f(0x1d2)]&&_0x3d8519[_0x321d7f(0x1ce)]==_0x4b12b6[_0x321d7f(0x1ce)]&&_0x3d8519['expiry_date']==_0x4b12b6['expiry_date']&&_0x3d8519[_0x321d7f(0x206)]==_0x4b12b6[_0x321d7f(0x206)]&&_0x3d8519[_0x321d7f(0x1e6)]==_0x4b12b6[_0x321d7f(0x1e6)]&&(_0x3d8519['product_stock']=parseInt(_0x3d8519[_0x321d7f(0x22a)])+parseInt(_0x4b12b6[_0x321d7f(0x1c7)]),_0x39b277++);});_0x39b277=='0'&&(_0x6014af[_0x57a356(0x1f7)]=_0x6014af[_0x57a356(0x1f7)][_0x57a356(0x1f8)]({'product_name':_0x4b12b6[_0x57a356(0x1d2)],'product_stock':_0x4b12b6[_0x57a356(0x1c7)],'primary_code':_0x4b12b6[_0x57a356(0x294)],'secondary_code':_0x4b12b6['secondary_code'],'product_code':_0x4b12b6[_0x57a356(0x29b)],'bay':_0x4b12b6[_0x57a356(0x1ce)],'batch_code':_0x4b12b6[_0x57a356(0x1e6)],'maxPerUnit':_0x4b12b6[_0x57a356(0x29f)],'production_date':_0x4b12b6[_0x57a356(0x206)],'expiry_date':_0x4b12b6[_0x57a356(0x255)],'secondary_unit':_0x4b12b6[_0x57a356(0x297)],'unit':_0x4b12b6['unit'],'maxProducts':_0x4b12b6[_0x57a356(0x2aa)]}));}),await _0x6014af[_0x455214(0x1d6)](),console[_0x455214(0x252)](_0x552e47[_0x455214(0x28d)]);const _0x1c3e83=new c_payment_data({'invoice':_0x24901f,'customer':_0x552e47[_0x455214(0x28d)][_0x455214(0x233)],'reason':_0x455214(0x232)});await _0x1c3e83[_0x455214(0x1d6)]();const _0x123f98=await master_shop[_0x455214(0x214)]();console[_0x455214(0x252)](_0x455214(0x202),_0x123f98[0x0][_0x455214(0x21b)]);const _0x30c51f=await email_settings[_0x455214(0x1e3)](),_0x7da8c8=await customer[_0x455214(0x1e3)]({'name':_0x552e47[_0x455214(0x28d)]['customer']});console[_0x455214(0x252)](_0x455214(0x1ab),_0x7da8c8);_0x123f98[0x0][_0x455214(0x1f5)]==0x1?(right_currency=_0x123f98[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x123f98[0x0]['currency']);var _0x2b8cea=_0x1351ba,_0xc10209=_0x183344,_0x4a58e1='',_0x5716e9;for(_0x5716e9 in _0x2b8cea){_0x4a58e1+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2b8cea[_0x5716e9]+'</td>'+_0x455214(0x288)+_0xc10209[_0x5716e9]+'</td>'+'</tr>';}console['log']('product_list',_0x4a58e1);let _0x46f5f5=nodemailer[_0x455214(0x23d)]({'service':_0x455214(0x231),'auth':{'user':_0x30c51f[_0x455214(0x24d)],'pass':_0x30c51f[_0x455214(0x285)]}}),_0x1f3869={'from':_0x30c51f[_0x455214(0x24d)],'to':_0x7da8c8['email'],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x455214(0x218)+_0x123f98[0x0]['image'],'cid':_0x455214(0x243)}],'html':_0x455214(0x1ea)+'<html><head><title></title>'+_0x455214(0x215)+_0x455214(0x1c3)+_0x455214(0x1a6)+_0x455214(0x1c3)+_0x455214(0x1b4)+_0x455214(0x25b)+'<div>'+_0x455214(0x1c8)+_0x123f98[0x0][_0x455214(0x254)]+_0x455214(0x23f)+_0x455214(0x25b)+_0x455214(0x25b)+_0x455214(0x1fd)+_0x455214(0x1c3)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x455214(0x268)+_0x24901f+'\x20'+_0x455214(0x246)+_0x455214(0x1a7)+_0x13f8c4+'\x20'+_0x455214(0x2a9)+'</h5>'+_0x455214(0x25b)+_0x455214(0x24b)+_0x455214(0x253)+'<tr>'+_0x455214(0x281)+_0x455214(0x29e)+_0x455214(0x24e)+_0x455214(0x267)+'</tr>'+_0x455214(0x1e5)+_0x455214(0x24f)+'\x20'+_0x4a58e1+'\x20'+'</tbody>'+_0x455214(0x1bf)+_0x455214(0x1c3)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x123f98[0x0]['site_title']+'</h5>'+'</div>'+_0x455214(0x25b)+_0x455214(0x20d)};_0x46f5f5['sendMail'](_0x1f3869,function(_0x13bbfa,_0x1c86a5){var _0x4428f2=_0x455214;_0x13bbfa?(console[_0x4428f2(0x252)](_0x13bbfa),console[_0x4428f2(0x252)]('Error\x20Occurs')):console['log'](_0x4428f2(0x1e9));}),_0x552e47[_0x455214(0x19b)]('success','sales\x20item\x20return\x20successfull'),_0x27ddf2[_0x455214(0x2a6)]('/all_sales_finished/view');}catch(_0x147597){console['log'](_0x147597),_0x27ddf2['status'](0xc8)['json']({'message1':_0x147597[_0x455214(0x2a8)]});}}}),router[a0_0x475af3(0x207)]('/barcode/:id',auth,async(_0x4f0bb4,_0x36f7bf)=>{var _0x58b1b0=a0_0x475af3;try{const {username:_0x46df42,email:_0x20aee4,role:_0x39f0d0}=_0x4f0bb4[_0x58b1b0(0x238)],_0x72144e=_0x4f0bb4[_0x58b1b0(0x238)],_0x44a39e=await profile[_0x58b1b0(0x1e3)]({'email':_0x72144e[_0x58b1b0(0x24d)]}),_0x2fca8e=await master_shop[_0x58b1b0(0x214)]();console[_0x58b1b0(0x252)](_0x58b1b0(0x1bb),_0x2fca8e);const _0x17324d=_0x4f0bb4[_0x58b1b0(0x1b3)]['id'],_0x305955=await sales[_0x58b1b0(0x1b1)](_0x17324d);console[_0x58b1b0(0x252)]('barcode\x20user_id',_0x305955);if(_0x2fca8e[0x0]['language']==_0x58b1b0(0x19f))var _0x17f06a=users[_0x58b1b0(0x1fa)];else{if(_0x2fca8e[0x0][_0x58b1b0(0x261)]==_0x58b1b0(0x1e1))var _0x17f06a=users['Hindi'];else{if(_0x2fca8e[0x0]['language']==_0x58b1b0(0x1d5))var _0x17f06a=users[_0x58b1b0(0x1d5)];else{if(_0x2fca8e[0x0][_0x58b1b0(0x261)]==_0x58b1b0(0x26e))var _0x17f06a=users['Spanish'];else{if(_0x2fca8e[0x0]['language']==_0x58b1b0(0x1be))var _0x17f06a=users[_0x58b1b0(0x1be)];else{if(_0x2fca8e[0x0][_0x58b1b0(0x261)]==_0x58b1b0(0x251))var _0x17f06a=users[_0x58b1b0(0x1db)];else{if(_0x2fca8e[0x0][_0x58b1b0(0x261)]=='Chinese')var _0x17f06a=users[_0x58b1b0(0x2ad)];else{if(_0x2fca8e[0x0][_0x58b1b0(0x261)]=='Arabic\x20(ae)')var _0x17f06a=users[_0x58b1b0(0x295)];}}}}}}}_0x36f7bf['render'](_0x58b1b0(0x1f1),{'success':_0x4f0bb4[_0x58b1b0(0x19b)](_0x58b1b0(0x1a1)),'errors':_0x4f0bb4[_0x58b1b0(0x19b)](_0x58b1b0(0x1e7)),'role':_0x72144e,'profile':_0x44a39e,'alldata':_0x305955,'master_shop':_0x2fca8e,'language':_0x17f06a});}catch(_0x1dc737){console[_0x58b1b0(0x252)](_0x1dc737);}}),router[a0_0x475af3(0x292)]('/barcode_scanner',async(_0x2e4834,_0x16fbe7)=>{var _0x2a563d=a0_0x475af3;const {product_code:_0x378f65,warehouse_name:_0x283844,rooms_data:_0x41cf19,Roomslist:_0x293036}=_0x2e4834[_0x2a563d(0x28d)],_0x2c37d7=_0x293036[_0x2a563d(0x1ca)](','),_0x11371b=[];async function _0x2cc1aa(_0x1e0062){var _0x34cd69=_0x2a563d;const _0x3e381c=await warehouse[_0x34cd69(0x1df)]([{'$match':{'name':_0x283844,'room':_0x1e0062}},{'$unwind':_0x34cd69(0x29a)},{'$match':{'product_details.primary_code':_0x378f65}},{'$group':{'_id':_0x34cd69(0x1a9),'name':{'$first':_0x34cd69(0x1ed)},'product_stock':{'$first':_0x34cd69(0x1d3)},'primary_code':{'$first':_0x34cd69(0x256)},'secondary_code':{'$first':_0x34cd69(0x26c)},'product_code':{'$first':_0x34cd69(0x1c5)},'level':{'$first':_0x34cd69(0x204)},'isle':{'$first':_0x34cd69(0x221)},'type':{'$first':_0x34cd69(0x272)},'pallet':{'$first':_0x34cd69(0x23e)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x34cd69(0x217)},'storage':{'$first':_0x34cd69(0x216)},'rack':{'$first':_0x34cd69(0x241)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x34cd69(0x28f)},'batch_code':{'$first':_0x34cd69(0x25a)},'product_cat':{'$first':_0x34cd69(0x28b)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x34cd69(0x1f9)},'invoice':{'$first':_0x34cd69(0x1d7)}}}]),_0x25497d=await warehouse[_0x34cd69(0x1df)]([{'$match':{'name':_0x283844,'room':_0x1e0062}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x378f65}},{'$group':{'_id':_0x34cd69(0x1a9),'name':{'$first':_0x34cd69(0x1ed)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x34cd69(0x256)},'secondary_code':{'$first':_0x34cd69(0x26c)},'product_code':{'$first':_0x34cd69(0x1c5)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x34cd69(0x221)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x34cd69(0x23e)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x34cd69(0x216)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x34cd69(0x278)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x34cd69(0x28f)},'batch_code':{'$first':_0x34cd69(0x25a)},'product_cat':{'$first':_0x34cd69(0x28b)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x34cd69(0x1f9)},'invoice':{'$first':_0x34cd69(0x1d7)}}}]);if(_0x3e381c[_0x34cd69(0x21d)]>0x0)_0x11371b[_0x34cd69(0x22f)](_0x3e381c);else _0x25497d['length']>0x0&&_0x11371b[_0x34cd69(0x22f)](_0x25497d);}const _0x18f717=_0x2c37d7[_0x2a563d(0x270)](_0x16f5b4=>_0x2cc1aa(_0x16f5b4));await Promise['all'](_0x18f717),_0x16fbe7[_0x2a563d(0x275)](_0x11371b);}),module[a0_0x475af3(0x1cb)]=router;