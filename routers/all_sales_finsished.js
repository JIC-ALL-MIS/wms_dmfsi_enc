var a0_0x40155e=a0_0x4dfb;function a0_0x9795(){var _0x3bb2f7=['unit_spmx','date_data','157194ZIVVoi','Arabic\x20(ae)','/view/add_sales_spmx','$product_details_spmx.spicemix_spmx_qty','</tr>','../models/all_models','$product_details.product_cat','$note','product_code','/view/add_sale/product','Logo.png','/invoice/:id','QA\x20Warehouse','$product_details_spmx.curing_spmx_qty','id_transaction_from','product_details_spmx','return_sale','<strong>\x20Regards\x20</strong>','German','json','</td>','params','site_title','product','table\x20page','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','length','12wUJcGz','expiry_date','nodemailer','map','13EOnDGq','error','$name','$product_details.unit','brand_spmx','Sale\x20Return','password','$product_details.secondary_unit','staff','4718189GEDXiG','$product_details.batch_code','secondary_code_QA','expiry_date_QA','bay','floor','primary_unit','$product_details.production_date','sales_invoice','Sales\x20Add\x20successfully','prod_invoice','<table\x20style=\x22width:\x20100%\x20!important;\x22>','out_going_id','body','Outgoing\x20Successfully\x20Added\x20but\x20not\x20Finalized','</table>','finalize','$product_details_spmx.spicemix_spmx','sales_quantity','/all_sales_finished/view_sales_spmx/','maxPerUnit_QA','Sale\x20Return\x20Mail','\x20Order\x20Date\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Return\x20Rooms','True','$return_data','40IEHRKl','primary_code_QA','<h5\x20style=\x22text-align:\x20left;\x22>','max_per_unit','stocks_QA','sales\x20item\x20return\x20successfull','29632040aSXzLw','$sale_product.curing_spmx_qty','extenders_spmx','$product_details.bay','getMonth','$room','$finalize','$product_details.maxPerUnit','invoice','French','</span>','Enclosed','primary_code','/barcode_scanner_spmx','<tbody\x20style=\x22text-align:\x20center;\x22>','$product_details.floorlevel','/give_payment/:id','$product_details.storage','$product','product_date','English','maxProducts','SPMX','$product_details_spmx.extenders_spmx','$product_details.expiry_date','</thead>','all_sales_barcode','view_sales_finished_spmx','<html><head><title></title>','gmail','<h5>','get','Chinese','maxPerUnit','Email\x20sent\x20successfully','Sales\x20Update\x20successfully','/barcode/:id','carton','back','extenders_spmx_qty','batch_code','aggregate','$product_details.primary_code','redirect','_id','$product_details.room_name','curing_spmx_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$product_details.product_code','adjust_qty','customer','Hindi','secondary_unit','Portuguese','currency_placement','express','$product_details.rack','flash','language','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details_spmx.category_spmx','string','../public/language/languages.json','Sale','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','DRY\x20GOODS','sendMail','filter','split','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Finished\x20Goods','$product_details.invoice','$product_details.secondary_code','concat','Enabled','Spanish','status','Arabic','production_date_QA','$product_details._id','$product_details_spmx.unit_spmx','logo','$product_details_spmx.inv_incoming','maxperunit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','edit_sales_finished','Outgoing\x20Successfully\x20Added\x20and\x20Finalized','<h2>\x20','room','Ambient','$sale_product.type','Error\x20Occurs','</h5>','findById','room_name','extenders_spmx_qty_stock','incoming_invoice','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','port','$customer','padStart','message','suppliers','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','return_qty','catch','</head><body>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','batch_code_QA','../middleware/auth','$sale_product.room_spmx','$sale_product','$sale_product.extenders_spmx','$sale_product.bay','product_details','/view_spmx','spicemix_spmx_qty','OUTF-','then','sale_qty','1881621WYBLdD','$sale_product.quantity','Received\x20Payment\x20For\x20Sale','return_data','<tr>','/all_sales_finished/preview/','secondary_code','$_id','final','findOne','spicemix_spmx','3247488TeRgIg','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.bin','</body></html>','$product_details','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/../public','product_name','product_code_QA','/view','all_sales_finished_spmx','image','role','for_categorize','log','False','currency','success','curing_spmx','<!DOCTYPE\x20html>','add_sales_finished_spmx','3481596BlXlAF','Portuguese\x20(BR)','exports','purchases_data','add_sales_finished','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$product_details.type','warehouse','prod_code','abs','post','$warehouse_name','connect-flash','payment\x20successfull','user','all','slice','spicemix_spmx_qty_stock','\x20<>\x20','\x20</h2>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','product_name_QA1','errors','/view_sales_spmx/:id','</div>','customer_data','OUT-','level','received_amount','/view/add_sales/:id','$sale_product.bin','toString','An\x20error\x20occurred\x20while\x20saving\x20data.','unit','curing_spmx_qty_stock','$product_details.product_stock','1606590IdXslb','warehouse_name','all_sales_finished','$sale_product.extenders_spmx_qty','render','note','amount','/process/:id','product_list','getDate','find','$sale_product.curing_spmx','<span\x20style=\x22float:\x20right;\x22>','RoomAssigned','sales_quantity_QA','production_date','Quality\x20Inspection','product_data','$product_details.maxProducts','category_spmx','sale_product','push','add\x20post','<div>','English\x20(US)','return_qty_QA','$sale_product.floorlevel','</tbody>','$date','stock','out_invoice','unit_QA','email','master','quantity','max','prod_cat','room_spmx','$product.product_name','edit_sales_finished_view','due_amount','/all_sales_finished/view','/view/add_sales','/view/return_sales/:id','/all_sales/view','$invoice','createTransport','$product_details.product_name','save','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','forEach','$product_details_spmx.brand_spmx','secondary_unit_QA','An\x20error\x20occurred.','foreach\x20newproduct'];a0_0x9795=function(){return _0x3bb2f7;};return a0_0x9795();}function a0_0x4dfb(_0x3b8508,_0x45916a){var _0x97954e=a0_0x9795();return a0_0x4dfb=function(_0x4dfbc8,_0x405cf0){_0x4dfbc8=_0x4dfbc8-0x1ce;var _0x2a7d55=_0x97954e[_0x4dfbc8];return _0x2a7d55;},a0_0x4dfb(_0x3b8508,_0x45916a);}(function(_0x32c1b8,_0x220bf5){var _0x46f4a8=a0_0x4dfb,_0x32167e=_0x32c1b8();while(!![]){try{var _0x309468=parseInt(_0x46f4a8(0x2d9))/0x1*(-parseInt(_0x46f4a8(0x2ba))/0x2)+parseInt(_0x46f4a8(0x247))/0x3+parseInt(_0x46f4a8(0x25c))/0x4+parseInt(_0x46f4a8(0x281))/0x5+parseInt(_0x46f4a8(0x2d5))/0x6*(parseInt(_0x46f4a8(0x2e2))/0x7)+parseInt(_0x46f4a8(0x2fd))/0x8*(parseInt(_0x46f4a8(0x23c))/0x9)+-parseInt(_0x46f4a8(0x303))/0xa;if(_0x309468===_0x220bf5)break;else _0x32167e['push'](_0x32167e['shift']());}catch(_0x50d89b){_0x32167e['push'](_0x32167e['shift']());}}}(a0_0x9795,0xa6a97));const express=require(a0_0x40155e(0x1f8)),app=express(),router=express['Router'](),{profile,master_shop,sales_spmx,invoice_for_outgoing,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x40155e(0x2bf)),auth=require(a0_0x40155e(0x231)),nodemailer=require(a0_0x40155e(0x2d7)),users=require(a0_0x40155e(0x200)),e=require(a0_0x40155e(0x268));router[a0_0x40155e(0x1e0)](a0_0x40155e(0x237),auth,async(_0x21db47,_0x142e64)=>{var _0x3f1551=a0_0x40155e;try{const {username:_0x22b534,email:_0xc7146,role:_0x4563c5}=_0x21db47['user'],_0x1bd616=_0x21db47[_0x3f1551(0x26a)],_0x4b3bdf=await profile[_0x3f1551(0x245)]({'email':_0x1bd616[_0x3f1551(0x2a1)]}),_0x3126e4=await staff[_0x3f1551(0x245)]({'email':_0x1bd616[_0x3f1551(0x2a1)]});if(_0x1bd616[_0x3f1551(0x253)]=='staff'){const _0x5696c0=await staff['findOne']({'email':_0x1bd616[_0x3f1551(0x2a1)]});}const _0x2ff7a1=await master_shop[_0x3f1551(0x28b)](),_0x3b2558=await sales_spmx[_0x3f1551(0x1ea)]([{'$unwind':_0x3f1551(0x233)},{'$group':{'_id':_0x3f1551(0x243),'invoice':{'$first':_0x3f1551(0x2ae)},'date':{'$first':_0x3f1551(0x29d)},'finalize':{'$first':_0x3f1551(0x309)},'warehouse_name':{'$first':'$warehouse_name'},'room_spmx':{'$addToSet':_0x3f1551(0x232)},'sale_product':{'$push':_0x3f1551(0x233)},'note':{'$first':_0x3f1551(0x2c1)},'spicemix_spmx_qty':{'$sum':'$sale_product.spicemix_spmx_qty'},'extenders_spmx_qty':{'$sum':_0x3f1551(0x284)},'curing_spmx_qty':{'$sum':_0x3f1551(0x304)},'spicemix_spmx':{'$addToSet':'$sale_product.spicemix_spmx'},'extenders_spmx':{'$addToSet':_0x3f1551(0x234)},'curing_spmx':{'$addToSet':_0x3f1551(0x28c)},'product_code':{'$addToSet':'$sale_product.product_code'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'warehouse_name':0x1,'room_spmx':0x1,'sale_product':0x1,'note':0x1,'spicemix_spmx_qty':0x1,'extenders_spmx_qty':0x1,'curing_spmx_qty':0x1,'spicemix_spmx':0x1,'extenders_spmx':0x1,'curing_spmx':0x1,'product_code':0x1,'finalize':0x1}}]);if(_0x2ff7a1[0x0][_0x3f1551(0x1fb)]==_0x3f1551(0x299))var _0x5b7e1c=users[_0x3f1551(0x1d5)];else{if(_0x2ff7a1[0x0][_0x3f1551(0x1fb)]==_0x3f1551(0x1f4))var _0x5b7e1c=users[_0x3f1551(0x1f4)];else{if(_0x2ff7a1[0x0][_0x3f1551(0x1fb)]==_0x3f1551(0x2cc))var _0x5b7e1c=users[_0x3f1551(0x2cc)];else{if(_0x2ff7a1[0x0]['language']=='Spanish')var _0x5b7e1c=users[_0x3f1551(0x20e)];else{if(_0x2ff7a1[0x0][_0x3f1551(0x1fb)]==_0x3f1551(0x30c))var _0x5b7e1c=users['French'];else{if(_0x2ff7a1[0x0][_0x3f1551(0x1fb)]=='Portuguese\x20(BR)')var _0x5b7e1c=users[_0x3f1551(0x1f6)];else{if(_0x2ff7a1[0x0][_0x3f1551(0x1fb)]==_0x3f1551(0x1e1))var _0x5b7e1c=users[_0x3f1551(0x1e1)];else{if(_0x2ff7a1[0x0][_0x3f1551(0x1fb)]==_0x3f1551(0x2bb))var _0x5b7e1c=users['Arabic'];}}}}}}}_0x142e64[_0x3f1551(0x285)](_0x3f1551(0x251),{'success':_0x21db47[_0x3f1551(0x1fa)](_0x3f1551(0x258)),'errors':_0x21db47[_0x3f1551(0x1fa)](_0x3f1551(0x273)),'data':_0x3b2558,'role':_0x1bd616,'profile':_0x4b3bdf,'master_shop':_0x2ff7a1,'language':_0x5b7e1c});}catch(_0x550b17){console[_0x3f1551(0x255)](_0x3f1551(0x2d2),_0x550b17),_0x142e64[_0x3f1551(0x20f)](0xc8)[_0x3f1551(0x2cd)]({'message':_0x550b17[_0x3f1551(0x228)]});}}),router[a0_0x40155e(0x1e0)](a0_0x40155e(0x2bc),auth,async(_0x44d715,_0x3ad737)=>{var _0x4bc2ee=a0_0x40155e;try{const {username:_0x5554d3,email:_0x2ac1e0,role:_0x446547}=_0x44d715[_0x4bc2ee(0x26a)],_0x532546=_0x44d715[_0x4bc2ee(0x26a)],_0x39ee27=await profile[_0x4bc2ee(0x245)]({'email':_0x532546[_0x4bc2ee(0x2a1)]}),_0x4fb5f0=await staff[_0x4bc2ee(0x245)]({'email':_0x532546[_0x4bc2ee(0x2a1)]});if(_0x532546['role']==_0x4bc2ee(0x2e1)){const _0xd4d603=await staff[_0x4bc2ee(0x245)]({'email':_0x532546[_0x4bc2ee(0x2a1)]});}const _0x3a3e3b=await warehouse[_0x4bc2ee(0x1ea)]([{'$match':{'status':_0x4bc2ee(0x20d),'warehouse_category':_0x4bc2ee(0x1d7),'name':{'$ne':_0x4bc2ee(0x2c6)}}},{'$group':{'_id':_0x4bc2ee(0x2db),'name':{'$first':'$name'}}}]),_0x591c1c=await master_shop[_0x4bc2ee(0x28b)]();if(_0x591c1c[0x0][_0x4bc2ee(0x1fb)]==_0x4bc2ee(0x299))var _0x4998ee=users[_0x4bc2ee(0x1d5)];else{if(_0x591c1c[0x0][_0x4bc2ee(0x1fb)]==_0x4bc2ee(0x1f4))var _0x4998ee=users[_0x4bc2ee(0x1f4)];else{if(_0x591c1c[0x0][_0x4bc2ee(0x1fb)]==_0x4bc2ee(0x2cc))var _0x4998ee=users[_0x4bc2ee(0x2cc)];else{if(_0x591c1c[0x0][_0x4bc2ee(0x1fb)]=='Spanish')var _0x4998ee=users[_0x4bc2ee(0x20e)];else{if(_0x591c1c[0x0][_0x4bc2ee(0x1fb)]==_0x4bc2ee(0x30c))var _0x4998ee=users[_0x4bc2ee(0x30c)];else{if(_0x591c1c[0x0][_0x4bc2ee(0x1fb)]=='Portuguese\x20(BR)')var _0x4998ee=users[_0x4bc2ee(0x1f6)];else{if(_0x591c1c[0x0][_0x4bc2ee(0x1fb)]=='Chinese')var _0x4998ee=users[_0x4bc2ee(0x1e1)];else{if(_0x591c1c[0x0]['language']=='Arabic\x20(ae)')var _0x4998ee=users[_0x4bc2ee(0x210)];}}}}}}}_0x3ad737['render'](_0x4bc2ee(0x25b),{'success':_0x44d715[_0x4bc2ee(0x1fa)](_0x4bc2ee(0x258)),'errors':_0x44d715[_0x4bc2ee(0x1fa)]('errors'),'role':_0x532546,'profile':_0x39ee27,'master_shop':_0x591c1c,'warehouse':_0x3a3e3b,'language':_0x4998ee});}catch(_0x2948cf){console[_0x4bc2ee(0x255)]('table\x20page',_0x2948cf),_0x3ad737['status'](0xc8)[_0x4bc2ee(0x2cd)]({'message':_0x2948cf[_0x4bc2ee(0x228)]});}}),router[a0_0x40155e(0x266)]('/view/add_sales_spmx',auth,async(_0x5db350,_0x124413)=>{var _0x431b40=a0_0x40155e;try{const {date:_0x2e9d8b,SCRN:_0x4ca65d,PO_number:_0xdfd0f9,warehouse_name:_0x200f24,to_room_name:_0xba6236,prod_code:_0x456857,note:_0xfbddd6}=_0x5db350[_0x431b40(0x2ef)];if(typeof _0x456857==_0x431b40(0x1ff))var _0xdbcddd=[_0x5db350[_0x431b40(0x2ef)]['prod_code']],_0x464c04=[_0x5db350[_0x431b40(0x2ef)][_0x431b40(0x246)]],_0x467d87=[_0x5db350['body']['spicemix_spmx_qty']],_0x1a6df0=[_0x5db350[_0x431b40(0x2ef)]['spicemix_spmx_qty_stock']],_0x48d1bc=[_0x5db350['body'][_0x431b40(0x305)]],_0x38f096=[_0x5db350[_0x431b40(0x2ef)]['extenders_spmx_qty']],_0x17caea=[_0x5db350[_0x431b40(0x2ef)]['extenders_spmx_qty_stock']],_0x2c1efa=[_0x5db350[_0x431b40(0x2ef)][_0x431b40(0x259)]],_0x2859c3=[_0x5db350[_0x431b40(0x2ef)][_0x431b40(0x1ef)]],_0x90dd80=[_0x5db350['body'][_0x431b40(0x27f)]],_0x4363af=[_0x5db350['body']['room_spmx']],_0x1fa8cb=[_0x5db350['body'][_0x431b40(0x2b8)]],_0x359363=[_0x5db350[_0x431b40(0x2ef)][_0x431b40(0x2dd)]],_0x236d57=[_0x5db350[_0x431b40(0x2ef)][_0x431b40(0x294)]],_0x4b6b41=[_0x5db350[_0x431b40(0x2ef)][_0x431b40(0x2ee)]],_0x5801f5=[_0x5db350[_0x431b40(0x2ef)]['incoming_invoice']];else var _0xdbcddd=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x264)]],_0x464c04=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x246)]],_0x467d87=[..._0x5db350['body'][_0x431b40(0x238)]],_0x1a6df0=[..._0x5db350[_0x431b40(0x2ef)]['spicemix_spmx_qty_stock']],_0x48d1bc=[..._0x5db350['body'][_0x431b40(0x305)]],_0x38f096=[..._0x5db350[_0x431b40(0x2ef)]['extenders_spmx_qty']],_0x17caea=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x222)]],_0x2c1efa=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x259)]],_0x2859c3=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x1ef)]],_0x90dd80=[..._0x5db350['body']['curing_spmx_qty_stock']],_0x4363af=[..._0x5db350['body'][_0x431b40(0x2a6)]],_0x1fa8cb=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x2b8)]],_0x359363=[..._0x5db350[_0x431b40(0x2ef)]['brand_spmx']],_0x236d57=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x294)]],_0x4b6b41=[..._0x5db350['body'][_0x431b40(0x2ee)]],_0x5801f5=[..._0x5db350[_0x431b40(0x2ef)][_0x431b40(0x223)]];const _0x104b20=_0xdbcddd[_0x431b40(0x2d8)](_0xa955ad=>{return _0xa955ad={'product_code':_0xa955ad};});_0x464c04['forEach']((_0x55f28f,_0x5c7d45)=>{var _0x78f39=_0x431b40;_0x104b20[_0x5c7d45][_0x78f39(0x246)]=_0x55f28f;}),_0x467d87[_0x431b40(0x2b3)]((_0x2b5746,_0x4482c3)=>{var _0x30b411=_0x431b40;_0x104b20[_0x4482c3][_0x30b411(0x238)]=_0x2b5746;}),_0x1a6df0['forEach']((_0x4c3f2d,_0x100386)=>{var _0xa0fec6=_0x431b40;_0x104b20[_0x100386][_0xa0fec6(0x26d)]=_0x4c3f2d;}),_0x48d1bc[_0x431b40(0x2b3)]((_0x56b285,_0x1fb8c8)=>{var _0x47b3f1=_0x431b40;_0x104b20[_0x1fb8c8][_0x47b3f1(0x305)]=_0x56b285;}),_0x38f096[_0x431b40(0x2b3)]((_0x52c8cc,_0x4c4929)=>{var _0x31eada=_0x431b40;_0x104b20[_0x4c4929][_0x31eada(0x1e8)]=_0x52c8cc;}),_0x17caea[_0x431b40(0x2b3)]((_0x3842f0,_0x1a6b5a)=>{_0x104b20[_0x1a6b5a]['extenders_spmx_qty_stock']=_0x3842f0;}),_0x2c1efa['forEach']((_0x359f25,_0x50be12)=>{_0x104b20[_0x50be12]['curing_spmx']=_0x359f25;}),_0x2859c3[_0x431b40(0x2b3)]((_0x20d1d3,_0x4c47b5)=>{var _0x4e2f0c=_0x431b40;_0x104b20[_0x4c47b5][_0x4e2f0c(0x1ef)]=_0x20d1d3;}),_0x90dd80[_0x431b40(0x2b3)]((_0x162f73,_0x9166a2)=>{var _0x4eed48=_0x431b40;_0x104b20[_0x9166a2][_0x4eed48(0x27f)]=_0x162f73;}),_0x4363af[_0x431b40(0x2b3)]((_0x17e3e0,_0x14dd4d)=>{_0x104b20[_0x14dd4d]['room_spmx']=_0x17e3e0;}),_0x1fa8cb[_0x431b40(0x2b3)]((_0x3af639,_0x152c8b)=>{var _0x2c2b97=_0x431b40;_0x104b20[_0x152c8b][_0x2c2b97(0x2b8)]=_0x3af639;}),_0x359363[_0x431b40(0x2b3)]((_0x3c020c,_0x5152f5)=>{var _0x25f6f4=_0x431b40;_0x104b20[_0x5152f5][_0x25f6f4(0x2dd)]=_0x3c020c;}),_0x236d57['forEach']((_0x2fbc82,_0x167c7e)=>{var _0xc06744=_0x431b40;_0x104b20[_0x167c7e][_0xc06744(0x294)]=_0x2fbc82;}),_0x4b6b41['forEach']((_0x204fbf,_0x2a08a2)=>{var _0x4a08d3=_0x431b40;_0x104b20[_0x2a08a2][_0x4a08d3(0x2c8)]=_0x204fbf;}),_0x5801f5[_0x431b40(0x2b3)]((_0x426b61,_0x386906)=>{var _0x1678bf=_0x431b40;_0x104b20[_0x386906][_0x1678bf(0x223)]=_0x426b61;});const _0x245f16=new invoice_for_outgoing();await _0x245f16[_0x431b40(0x2b1)]();const _0x540b41=new sales_spmx({'invoice':_0x431b40(0x277)+_0x245f16['invoice_init'][_0x431b40(0x27c)]()[_0x431b40(0x227)](0x8,'0'),'date':_0x2e9d8b,'warehouse_name':_0x200f24,'sale_product':_0x104b20,'note':_0xfbddd6,'POnumber':_0xdfd0f9,'SCRN':_0x4ca65d}),_0x4038ac=await _0x540b41[_0x431b40(0x2b1)]();_0x5db350[_0x431b40(0x1fa)](_0x431b40(0x258),_0x431b40(0x2f0)),_0x124413['redirect'](_0x431b40(0x2f5)+_0x4038ac[_0x431b40(0x1ed)]);}catch(_0x175bad){console[_0x431b40(0x255)]('table\x20page',_0x175bad),_0x124413[_0x431b40(0x20f)](0xc8)['json']({'message':_0x175bad[_0x431b40(0x228)]});}}),router[a0_0x40155e(0x1e0)](a0_0x40155e(0x274),auth,async(_0x5b431c,_0x112b70)=>{var _0x2a34f7=a0_0x40155e;try{const _0x34f862=_0x5b431c[_0x2a34f7(0x2cf)]['id'],_0x4e8214=await sales_spmx['findById'](_0x34f862),_0x4a3b4a=await master_shop[_0x2a34f7(0x28b)](),_0x50d47d=_0x5b431c[_0x2a34f7(0x26a)],_0x24df4c=await profile[_0x2a34f7(0x245)]({'email':_0x50d47d['email']}),_0x4162f2=await staff['findOne']({'email':_0x50d47d['email']});if(_0x4a3b4a[0x0][_0x2a34f7(0x1fb)]=='English\x20(US)')var _0x3d513f=users['English'];else{if(_0x4a3b4a[0x0][_0x2a34f7(0x1fb)]=='Hindi')var _0x3d513f=users[_0x2a34f7(0x1f4)];else{if(_0x4a3b4a[0x0]['language']=='German')var _0x3d513f=users['German'];else{if(_0x4a3b4a[0x0]['language']==_0x2a34f7(0x20e))var _0x3d513f=users['Spanish'];else{if(_0x4a3b4a[0x0][_0x2a34f7(0x1fb)]=='French')var _0x3d513f=users[_0x2a34f7(0x30c)];else{if(_0x4a3b4a[0x0][_0x2a34f7(0x1fb)]==_0x2a34f7(0x25d))var _0x3d513f=users[_0x2a34f7(0x1f6)];else{if(_0x4a3b4a[0x0][_0x2a34f7(0x1fb)]==_0x2a34f7(0x1e1))var _0x3d513f=users['Chinese'];else{if(_0x4a3b4a[0x0][_0x2a34f7(0x1fb)]==_0x2a34f7(0x2bb))var _0x3d513f=users[_0x2a34f7(0x210)];}}}}}}}_0x112b70['render'](_0x2a34f7(0x1dc),{'success':_0x5b431c['flash'](_0x2a34f7(0x258)),'errors':_0x5b431c[_0x2a34f7(0x1fa)](_0x2a34f7(0x273)),'role':_0x50d47d,'profile':_0x24df4c,'master_shop':_0x4a3b4a,'language':_0x3d513f,'data':_0x4e8214});}catch(_0x2dec96){;_0x112b70['status'](0xc8)['json']({'message':_0x2dec96[_0x2a34f7(0x228)]});}}),router[a0_0x40155e(0x266)](a0_0x40155e(0x288),auth,async(_0x3059df,_0x212383)=>{var _0x22a6dc=a0_0x40155e;try{const _0x1d3e25=_0x3059df[_0x22a6dc(0x2cf)]['id'],_0x40ec8b=await sales_spmx['findById'](_0x1d3e25);_0x40ec8b[_0x22a6dc(0x295)][_0x22a6dc(0x2b3)](async _0xd68b0a=>{var _0x27c9d0=_0x22a6dc;const _0x1fc98b=await warehouse['findOne']({'name':_0x40ec8b[_0x27c9d0(0x282)],'room':_0xd68b0a[_0x27c9d0(0x2a6)],'warehouse_category':_0x27c9d0(0x1d7),'product_details_spmx._id':_0xd68b0a[_0x27c9d0(0x2c8)]});if(_0x1fc98b){const _0x428219=_0x1fc98b[_0x27c9d0(0x2c9)][_0x27c9d0(0x28b)](_0x50b9e9=>_0x50b9e9[_0x27c9d0(0x1ed)][_0x27c9d0(0x27c)]()===_0xd68b0a[_0x27c9d0(0x2c8)]);_0x428219[_0x27c9d0(0x238)]=_0x428219['spicemix_spmx_qty']-_0xd68b0a['spicemix_spmx_qty'],_0x428219[_0x27c9d0(0x1e8)]=_0x428219['extenders_spmx_qty']-_0xd68b0a[_0x27c9d0(0x1e8)],_0x428219[_0x27c9d0(0x1ef)]=_0x428219['curing_spmx_qty']-_0xd68b0a[_0x27c9d0(0x1ef)],await warehouse['updateOne']({'name':_0x40ec8b[_0x27c9d0(0x282)],'room':_0xd68b0a[_0x27c9d0(0x2a6)],'warehouse_category':_0x27c9d0(0x1d7),'product_details_spmx._id':_0xd68b0a['id_transaction_from']},{'$set':{'product_details_spmx.$.spicemix_spmx_qty':_0x428219[_0x27c9d0(0x238)],'product_details_spmx.$.extenders_spmx_qty':_0x428219[_0x27c9d0(0x1e8)],'product_details_spmx.$.curing_spmx_qty':_0x428219[_0x27c9d0(0x1ef)]}});}}),_0x40ec8b[_0x22a6dc(0x2f2)]=_0x22a6dc(0x2fb),_0x40ec8b[_0x22a6dc(0x2b1)](),_0x3059df[_0x22a6dc(0x1fa)]('success',_0x22a6dc(0x219)),_0x212383[_0x22a6dc(0x1ec)](_0x22a6dc(0x2f5)+_0x40ec8b[_0x22a6dc(0x1ed)]);return;}catch(_0x4dc978){_0x212383[_0x22a6dc(0x2cd)]({'message':_0x4dc978[_0x22a6dc(0x228)]});}}),router[a0_0x40155e(0x1e0)](a0_0x40155e(0x250),auth,async(_0x474f93,_0xe3113)=>{var _0xfadcd8=a0_0x40155e;try{const {username:_0xd2866c,email:_0xf91dbd,role:_0x4adcb8}=_0x474f93[_0xfadcd8(0x26a)],_0x16b728=_0x474f93[_0xfadcd8(0x26a)],_0x59ce02=await profile[_0xfadcd8(0x245)]({'email':_0x16b728['email']}),_0x43427e=await master_shop[_0xfadcd8(0x28b)]();let _0x3b0722;if(_0x16b728['role']==_0xfadcd8(0x2e1)){const _0x56a04e=await staff[_0xfadcd8(0x245)]({'email':_0x16b728['email']});_0x3b0722=await sales_finished[_0xfadcd8(0x1ea)]([{'$unwind':_0xfadcd8(0x233)},{'$group':{'_id':_0xfadcd8(0x243),'invoice':{'$first':_0xfadcd8(0x2ae)},'customers':{'$first':_0xfadcd8(0x226)},'date':{'$first':_0xfadcd8(0x29d)},'warehouse_name':{'$first':_0xfadcd8(0x267)},'note':{'$first':_0xfadcd8(0x2c1)},'return_data':{'$first':_0xfadcd8(0x2fc)},'total_saleproduct_quantity':{'$sum':_0xfadcd8(0x23d)},'level':{'$addToSet':_0xfadcd8(0x235)},'isle':{'$addToSet':_0xfadcd8(0x27b)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0xfadcd8(0x309)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'note':0x1,'return_data':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x3b0722=await sales_finished[_0xfadcd8(0x1ea)]([{'$unwind':_0xfadcd8(0x233)},{'$group':{'_id':'$_id','invoice':{'$first':_0xfadcd8(0x2ae)},'customers':{'$first':'$customer'},'date':{'$first':_0xfadcd8(0x29d)},'warehouse_name':{'$first':_0xfadcd8(0x267)},'note':{'$first':'$note'},'return_data':{'$first':_0xfadcd8(0x2fc)},'total_saleproduct_quantity':{'$sum':_0xfadcd8(0x23d)},'level':{'$addToSet':_0xfadcd8(0x235)},'isle':{'$addToSet':_0xfadcd8(0x27b)},'type':{'$addToSet':_0xfadcd8(0x21d)},'pallet':{'$addToSet':_0xfadcd8(0x29b)},'finalize':{'$first':_0xfadcd8(0x309)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'note':0x1,'return_data':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x43427e[0x0][_0xfadcd8(0x1fb)]==_0xfadcd8(0x299)){var _0x414cde=users[_0xfadcd8(0x1d5)];console[_0xfadcd8(0x255)](_0x414cde);}else{if(_0x43427e[0x0]['language']==_0xfadcd8(0x1f4))var _0x414cde=users[_0xfadcd8(0x1f4)];else{if(_0x43427e[0x0][_0xfadcd8(0x1fb)]=='German')var _0x414cde=users[_0xfadcd8(0x2cc)];else{if(_0x43427e[0x0]['language']==_0xfadcd8(0x20e))var _0x414cde=users[_0xfadcd8(0x20e)];else{if(_0x43427e[0x0][_0xfadcd8(0x1fb)]==_0xfadcd8(0x30c))var _0x414cde=users[_0xfadcd8(0x30c)];else{if(_0x43427e[0x0][_0xfadcd8(0x1fb)]==_0xfadcd8(0x25d))var _0x414cde=users[_0xfadcd8(0x1f6)];else{if(_0x43427e[0x0]['language']==_0xfadcd8(0x1e1))var _0x414cde=users[_0xfadcd8(0x1e1)];else{if(_0x43427e[0x0]['language']==_0xfadcd8(0x2bb))var _0x414cde=users[_0xfadcd8(0x210)];}}}}}}}_0xe3113[_0xfadcd8(0x285)](_0xfadcd8(0x283),{'success':_0x474f93[_0xfadcd8(0x1fa)](_0xfadcd8(0x258)),'errors':_0x474f93[_0xfadcd8(0x1fa)]('errors'),'sales':_0x3b0722,'profile':_0x59ce02,'role':_0x16b728,'master_shop':_0x43427e,'language':_0x414cde});}catch(_0x18af7a){console[_0xfadcd8(0x255)](_0x18af7a);}});async function getRandom8DigitNumber(){var _0x53b225=a0_0x40155e;const _0x5270ce=0x989680,_0x4755b8=0x5f5e0ff,_0x412b31=Math[_0x53b225(0x2e7)](Math['random']()*(_0x4755b8-_0x5270ce+0x1))+_0x5270ce;var _0x53c063;const _0x3afdb1=await sales_finished[_0x53b225(0x245)]({'invoice':_0x53b225(0x239)+_0x412b31});return _0x3afdb1&&_0x3afdb1[_0x53b225(0x2d4)]>0x0?_0x53c063=_0x53b225(0x239)+_0x412b31:_0x53c063=_0x53b225(0x239)+_0x412b31,_0x53c063;}router[a0_0x40155e(0x1e0)](a0_0x40155e(0x2ab),auth,async(_0x3c3d6c,_0x350859)=>{var _0x5c4316=a0_0x40155e;try{const {username:_0x3067c5,email:_0x355e77,role:_0x4e8036}=_0x3c3d6c['user'],_0x5e2efb=_0x3c3d6c[_0x5c4316(0x26a)],_0x1e914a=await profile[_0x5c4316(0x245)]({'email':_0x5e2efb['email']}),_0x2c9148=await master_shop[_0x5c4316(0x28b)](),_0xf4ce0=await customer[_0x5c4316(0x28b)]({});let _0x310a20;if(_0x5e2efb[_0x5c4316(0x253)]=='staff'){const _0x168893=await staff['findOne']({'email':_0x5e2efb[_0x5c4316(0x2a1)]});_0x310a20=await warehouse[_0x5c4316(0x1ea)]([{'$match':{'status':_0x5c4316(0x20d),'name':_0x168893[_0x5c4316(0x263)],'warehouse_category':_0x5c4316(0x209),'name':{'$ne':_0x5c4316(0x2c6)}}},{'$group':{'_id':_0x5c4316(0x2db),'name':{'$first':_0x5c4316(0x2db)}}},{'$sort':{'name':0x1}}]);}else _0x310a20=await warehouse[_0x5c4316(0x1ea)]([{'$match':{'status':'Enabled','warehouse_category':_0x5c4316(0x209),'name':{'$ne':_0x5c4316(0x2c6)}}},{'$group':{'_id':_0x5c4316(0x2db),'name':{'$first':_0x5c4316(0x2db)}}},{'$sort':{'name':0x1}}]);const _0x3b2c4f=await product[_0x5c4316(0x28b)]({});var _0x2e3637=[_0x5c4316(0x21c),_0x5c4316(0x30e)];const _0x3f65fb=await sales_finished[_0x5c4316(0x28b)]({}),_0x57a80e=_0x3f65fb['length']+0x1,_0x747316='OUTF-'+_0x57a80e['toString']()[_0x5c4316(0x227)](0x5,'0');if(_0x2c9148[0x0]['language']=='English\x20(US)'){var _0x243294=users[_0x5c4316(0x1d5)];console[_0x5c4316(0x255)](_0x243294);}else{if(_0x2c9148[0x0][_0x5c4316(0x1fb)]==_0x5c4316(0x1f4))var _0x243294=users['Hindi'];else{if(_0x2c9148[0x0][_0x5c4316(0x1fb)]==_0x5c4316(0x2cc))var _0x243294=users[_0x5c4316(0x2cc)];else{if(_0x2c9148[0x0]['language']==_0x5c4316(0x20e))var _0x243294=users['Spanish'];else{if(_0x2c9148[0x0][_0x5c4316(0x1fb)]==_0x5c4316(0x30c))var _0x243294=users[_0x5c4316(0x30c)];else{if(_0x2c9148[0x0][_0x5c4316(0x1fb)]==_0x5c4316(0x25d))var _0x243294=users[_0x5c4316(0x1f6)];else{if(_0x2c9148[0x0][_0x5c4316(0x1fb)]==_0x5c4316(0x1e1))var _0x243294=users[_0x5c4316(0x1e1)];else{if(_0x2c9148[0x0][_0x5c4316(0x1fb)]=='Arabic\x20(ae)')var _0x243294=users['Arabic'];}}}}}}}const _0x9b48bd=getRandom8DigitNumber();_0x9b48bd[_0x5c4316(0x23a)](_0x5bbdda=>{var _0x1f2d69=_0x5c4316;_0x350859[_0x1f2d69(0x285)](_0x1f2d69(0x260),{'success':_0x3c3d6c[_0x1f2d69(0x1fa)](_0x1f2d69(0x258)),'errors':_0x3c3d6c[_0x1f2d69(0x1fa)](_0x1f2d69(0x273)),'role':_0x5e2efb,'profile':_0x1e914a,'customer':_0xf4ce0,'warehouse':_0x310a20,'product':_0x3b2c4f,'invoice':_0x5bbdda,'master_shop':_0x2c9148,'language':_0x243294,'rooms_data':_0x2e3637});})[_0x5c4316(0x22d)](_0x22bb3b=>{var _0x415bd0=_0x5c4316;_0x3c3d6c[_0x415bd0(0x1fa)](_0x415bd0(0x273),_0x415bd0(0x22f)),_0x350859[_0x415bd0(0x1ec)](_0x415bd0(0x2aa));});}catch(_0x5b3bb4){console[_0x5c4316(0x255)](_0x5b3bb4);}}),router[a0_0x40155e(0x1e0)](a0_0x40155e(0x27a),auth,async(_0x511478,_0x1adddc)=>{var _0x58979f=a0_0x40155e;try{const _0x4e84c1=_0x511478['params']['id'];console[_0x58979f(0x255)](_0x4e84c1);const _0x334d56=await product[_0x58979f(0x28b)](),_0x50c060=await purchases[_0x58979f(0x1ea)]([{'$match':{'warehouse_name':_0x4e84c1}},{'$unwind':_0x58979f(0x1d3)},{'$group':{'_id':_0x58979f(0x2a7)}}]);console['log'](_0x58979f(0x25f),_0x50c060),_0x1adddc['status'](0xc8)[_0x58979f(0x2cd)]({'purchases_data':_0x50c060,'product_data':_0x334d56});}catch(_0x43b98f){console[_0x58979f(0x255)](_0x43b98f);}}),router['post'](a0_0x40155e(0x2c3),auth,async(_0x583d8f,_0x4aac32)=>{var _0x42d5c1=a0_0x40155e;try{const {warehouse_data:_0x28c25b,product_data:_0x5d3f54}=_0x583d8f[_0x42d5c1(0x2ef)];console[_0x42d5c1(0x255)](_0x583d8f[_0x42d5c1(0x2ef)][_0x42d5c1(0x292)]);;const _0x43508b=await master_shop['find']();console['log'](_0x42d5c1(0x2a2),_0x43508b);const _0x27aa4f=await product[_0x42d5c1(0x245)]({'name':_0x5d3f54});console['log'](_0x42d5c1(0x2d1),_0x27aa4f);const _0x152ca9=await warehouse[_0x42d5c1(0x1ea)]([{'$match':{'name':_0x28c25b}},{'$unwind':_0x42d5c1(0x24b)},{'$match':{'product_details.product_name':_0x5d3f54}},{'$group':{'_id':_0x42d5c1(0x2b0),'product_stock':{'$first':_0x42d5c1(0x280)}}}]);console[_0x42d5c1(0x255)]('stock_data',_0x152ca9),_0x4aac32['status'](0xc8)['json']({'master':_0x43508b,'new_product':_0x27aa4f,'stock_data':_0x152ca9});}catch(_0x4850d5){console[_0x42d5c1(0x255)](_0x4850d5);}}),router[a0_0x40155e(0x266)](a0_0x40155e(0x2ab),auth,async(_0x38a7e6,_0x29c4a1)=>{var _0x37bb70=a0_0x40155e;try{const {invoice:_0x4023f1,date:_0x5960e5,warehouse_name:_0x167cb1,product_name:_0x235339,stock:_0xe98435,quantity:_0x4318a7,note:_0x42ba48,room:_0x59481e,primary_code:_0x2f16d8,secondary_code:_0x50522a,prod_code:_0x18371a,level:_0x13b6b6,isle:_0x20950f,pallet:_0x29c901,batch_code:_0x13b437,SCRN:_0x5bc3f8,expiry_date:_0x1e4d6d,mode_transpo:_0x49f882,name_driver:_0x2eb6d8}=_0x38a7e6[_0x37bb70(0x2ef)];if(typeof _0x235339=='string')var _0x438e16=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x24e)]],_0x5ae385=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x29e)]],_0x17405e=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x1e6)]],_0x57b3d5=[_0x38a7e6[_0x37bb70(0x2ef)]['primary_code']],_0x479000=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x242)]],_0x41b4ce=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x264)]],_0x572683=[_0x38a7e6['body']['level']],_0x7cc283=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2e8)]],_0x2fb564=[_0x38a7e6[_0x37bb70(0x2ef)]['secondary_unit']],_0x37b846=[_0x38a7e6[_0x37bb70(0x2ef)]['batch_code']],_0x450bfb=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2d6)]],_0x4bc821=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x1d4)]],_0x12427f=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x300)]],_0x4bf1f0=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2a5)]],_0x2e54c6=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x28e)]],_0x1d8e35=[_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2ec)]],_0x4c4075=[_0x38a7e6[_0x37bb70(0x2ef)]['id_transaction_from']];else var _0x438e16=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x24e)]],_0x5ae385=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x29e)]],_0x17405e=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x1e6)]],_0x57b3d5=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x30f)]],_0x479000=[..._0x38a7e6['body'][_0x37bb70(0x242)]],_0x41b4ce=[..._0x38a7e6[_0x37bb70(0x2ef)]['prod_code']],_0x572683=[..._0x38a7e6['body'][_0x37bb70(0x278)]],_0x7cc283=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2e8)]],_0x2fb564=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x1f5)]],_0x37b846=[..._0x38a7e6[_0x37bb70(0x2ef)]['batch_code']],_0x450bfb=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2d6)]],_0x4bc821=[..._0x38a7e6['body'][_0x37bb70(0x1d4)]],_0x12427f=[..._0x38a7e6[_0x37bb70(0x2ef)]['max_per_unit']],_0x4bf1f0=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2a5)]],_0x2e54c6=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x28e)]],_0x1d8e35=[..._0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x2ec)]],_0x4c4075=[..._0x38a7e6[_0x37bb70(0x2ef)]['id_transaction_from']];const _0x2be199=_0x438e16[_0x37bb70(0x2d8)](_0x23e6fa=>{return _0x23e6fa={'product_name':_0x23e6fa};});_0x5ae385[_0x37bb70(0x2b3)]((_0x15a16d,_0x35f281)=>{var _0x5d180e=_0x37bb70;_0x2be199[_0x35f281][_0x5d180e(0x29e)]=_0x15a16d;}),_0x17405e[_0x37bb70(0x2b3)]((_0x1a75e7,_0x9c4d76)=>{var _0xe6f715=_0x37bb70;_0x2be199[_0x9c4d76]['quantity']=Math[_0xe6f715(0x265)](_0x1a75e7);}),_0x4c4075[_0x37bb70(0x2b3)]((_0x5d8b3f,_0x2b9ba6)=>{var _0x398c09=_0x37bb70;_0x2be199[_0x2b9ba6][_0x398c09(0x2c8)]=_0x5d8b3f;}),_0x57b3d5['forEach']((_0x1ad892,_0x21d08a)=>{var _0x432b3c=_0x37bb70;_0x2be199[_0x21d08a][_0x432b3c(0x30f)]=_0x1ad892;}),_0x479000[_0x37bb70(0x2b3)]((_0xab5509,_0x31d59)=>{_0x2be199[_0x31d59]['secondary_code']=_0xab5509;}),_0x41b4ce['forEach']((_0x49fa8f,_0x1456dd)=>{var _0x3d6e89=_0x37bb70;_0x2be199[_0x1456dd][_0x3d6e89(0x2c2)]=_0x49fa8f,_0x2be199[_0x1456dd][_0x3d6e89(0x2b9)]=_0x5960e5;}),_0x572683[_0x37bb70(0x2b3)]((_0x48cd08,_0x3e2748)=>{_0x2be199[_0x3e2748]['bay']=_0x48cd08;}),_0x7cc283[_0x37bb70(0x2b3)]((_0x48bf28,_0x31b560)=>{_0x2be199[_0x31b560]['unit']=_0x48bf28;}),_0x2fb564[_0x37bb70(0x2b3)]((_0x2f84e4,_0x1f4574)=>{var _0x582786=_0x37bb70;_0x2be199[_0x1f4574][_0x582786(0x1f5)]=_0x2f84e4;}),_0x37b846[_0x37bb70(0x2b3)]((_0x21c21f,_0x27d090)=>{var _0x27ca09=_0x37bb70;_0x2be199[_0x27d090][_0x27ca09(0x1e9)]=_0x21c21f;}),_0x450bfb[_0x37bb70(0x2b3)]((_0x542974,_0x1fde61)=>{var _0xf10100=_0x37bb70;_0x2be199[_0x1fde61][_0xf10100(0x2d6)]=_0x542974;}),_0x4bc821[_0x37bb70(0x2b3)]((_0xc420a6,_0x29f6ad)=>{var _0x3c96cc=_0x37bb70;_0x2be199[_0x29f6ad][_0x3c96cc(0x290)]=_0xc420a6;}),_0x12427f[_0x37bb70(0x2b3)]((_0x3bba3c,_0x25679a)=>{var _0x396a6c=_0x37bb70;_0x2be199[_0x25679a][_0x396a6c(0x216)]=_0x3bba3c;}),_0x4bf1f0['forEach']((_0x3cdb9d,_0x33a4df)=>{var _0x48fcd6=_0x37bb70;_0x2be199[_0x33a4df][_0x48fcd6(0x2a5)]=_0x3cdb9d;}),_0x2e54c6['forEach']((_0x4078bf,_0x23df83)=>{_0x2be199[_0x23df83]['room_name']=_0x4078bf;}),_0x1d8e35[_0x37bb70(0x2b3)]((_0x3fa214,_0x4dfff7)=>{var _0x1b1997=_0x37bb70;_0x2be199[_0x4dfff7][_0x1b1997(0x30b)]=_0x3fa214;});var _0x4d21f8=0x0;_0x2be199[_0x37bb70(0x2b3)](_0x4a5a61=>{var _0x409f9a=_0x37bb70;parseFloat(_0x4a5a61[_0x409f9a(0x29e)])<parseFloat(_0x4a5a61[_0x409f9a(0x2a3)])&&parseFloat(_0x4a5a61[_0x409f9a(0x2a3)])>parseFloat(_0x4a5a61[_0x409f9a(0x29e)])&&(console[_0x409f9a(0x255)](_0x4a5a61[_0x409f9a(0x29e)]+_0x409f9a(0x26e)+_0x4a5a61[_0x409f9a(0x2a3)]),_0x4d21f8++);});if(_0x4d21f8!=0x0)return _0x38a7e6[_0x37bb70(0x1fa)](_0x37bb70(0x273),_0x37bb70(0x224)),_0x29c4a1[_0x37bb70(0x1ec)](_0x37bb70(0x1e7));const _0x5613ce=_0x2be199['filter'](_0x94081c=>_0x94081c[_0x37bb70(0x2a3)]!=='0'&&_0x94081c[_0x37bb70(0x2a3)]!==''),_0x50d192=new sales_finished({'invoice':_0x4023f1,'customer':_0x38a7e6[_0x37bb70(0x2ef)][_0x37bb70(0x1f3)],'date':_0x5960e5,'warehouse_name':_0x167cb1,'sale_product':_0x5613ce,'note':_0x42ba48,'room':_0x59481e,'primary_code':_0x2f16d8,'secondary_code':_0x50522a,'prod_code':_0x18371a,'SCRN':_0x5bc3f8,'finalize':_0x37bb70(0x256),'mode_transpo':_0x49f882,'name_driver':_0x2eb6d8}),_0x4b6512=await _0x50d192[_0x37bb70(0x2b1)](),_0xc94ca6=await sales_finished[_0x37bb70(0x245)]({'invoice':_0x4023f1}),_0xd3fa36=new c_payment_data({'invoice':_0x4023f1,'customer':_0x38a7e6[_0x37bb70(0x2ef)]['customer'],'reason':_0x37bb70(0x201)});await _0xd3fa36[_0x37bb70(0x2b1)]();const _0x2b2e03=await master_shop[_0x37bb70(0x28b)](),_0x5bb0d6=await email_settings[_0x37bb70(0x245)](),_0x44682f=await customer['findOne']({'name':_0x38a7e6['body'][_0x37bb70(0x1f3)]});_0x2b2e03[0x0][_0x37bb70(0x1f7)]==0x1?(right_currency=_0x2b2e03[0x0][_0x37bb70(0x257)],left_currency=''):(right_currency='',left_currency=_0x2b2e03[0x0][_0x37bb70(0x257)]);var _0x1e487d=_0x438e16,_0x44cc51=_0x17405e,_0x29036c='',_0x1f9161;for(_0x1f9161 in _0x1e487d){_0x29036c+=_0x37bb70(0x240)+_0x37bb70(0x208)+_0x1e487d[_0x1f9161]+'</td>'+_0x37bb70(0x208)+_0x44cc51[_0x1f9161]+_0x37bb70(0x2ce)+_0x37bb70(0x2be);}console['log'](_0x37bb70(0x289),_0x29036c),_0x38a7e6[_0x37bb70(0x1fa)](_0x37bb70(0x258),_0x37bb70(0x2eb)),_0x29c4a1['redirect'](_0x37bb70(0x241)+_0x4b6512[_0x37bb70(0x1ed)]);}catch(_0x320377){console[_0x37bb70(0x255)](_0x320377);}}),router[a0_0x40155e(0x1e0)]('/preview/:id',auth,async(_0x3da142,_0x2b6a17)=>{var _0x127224=a0_0x40155e;try{const {username:_0x454147,email:_0x401c2c,role:_0x1a922b}=_0x3da142[_0x127224(0x26a)],_0x23570f=_0x3da142[_0x127224(0x26a)],_0x3aabb9=await profile['findOne']({'email':_0x23570f[_0x127224(0x2a1)]}),_0x33df07=await master_shop[_0x127224(0x28b)](),_0x5dd524=_0x3da142[_0x127224(0x2cf)]['id'],_0x5b5c6d=await sales_finished['findById'](_0x5dd524),_0x4ffbac=await warehouse['aggregate']([{'$match':{'name':_0x5b5c6d[_0x127224(0x282)]}},{'$unwind':_0x127224(0x24b)},{'$group':{'_id':_0x127224(0x212),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x127224(0x280)},'bay':{'$first':_0x127224(0x306)},'bin':{'$first':_0x127224(0x249)},'type':{'$first':_0x127224(0x262)},'floorlevel':{'$first':_0x127224(0x1d0)},'primary_code':{'$first':_0x127224(0x1eb)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x127224(0x1f1)},'storage':{'$first':_0x127224(0x1d2)},'rack':{'$first':_0x127224(0x1f9)},'expiry_date':{'$first':_0x127224(0x1d9)},'production_date':{'$first':_0x127224(0x2e9)},'batch_code':{'$first':_0x127224(0x2e3)},'room':{'$first':_0x127224(0x308)},'room_data':{'$first':_0x127224(0x1ee)}}}]),_0x49fbcd=await customer[_0x127224(0x28b)]({});let _0x24a93c;if(_0x23570f[_0x127224(0x253)]==_0x127224(0x2e1)){const _0x3e5049=await staff[_0x127224(0x245)]({'email':_0x23570f[_0x127224(0x2a1)]});_0x24a93c=await warehouse[_0x127224(0x1ea)]([{'$match':{'status':_0x127224(0x20d),'name':_0x3e5049[_0x127224(0x263)]}},{'$group':{'_id':'$name','name':{'$first':_0x127224(0x2db)}}}]);}else _0x24a93c=await warehouse[_0x127224(0x1ea)]([{'$match':{'status':_0x127224(0x20d)}},{'$group':{'_id':_0x127224(0x2db),'name':{'$first':_0x127224(0x2db)}}}]);const _0x1a3c7c=await product[_0x127224(0x28b)]({});if(_0x33df07[0x0]['language']=='English\x20(US)'){var _0x35d2ec=users['English'];console[_0x127224(0x255)](_0x35d2ec);}else{if(_0x33df07[0x0][_0x127224(0x1fb)]==_0x127224(0x1f4))var _0x35d2ec=users[_0x127224(0x1f4)];else{if(_0x33df07[0x0][_0x127224(0x1fb)]=='German')var _0x35d2ec=users['German'];else{if(_0x33df07[0x0]['language']==_0x127224(0x20e))var _0x35d2ec=users[_0x127224(0x20e)];else{if(_0x33df07[0x0][_0x127224(0x1fb)]==_0x127224(0x30c))var _0x35d2ec=users[_0x127224(0x30c)];else{if(_0x33df07[0x0]['language']=='Portuguese\x20(BR)')var _0x35d2ec=users[_0x127224(0x1f6)];else{if(_0x33df07[0x0][_0x127224(0x1fb)]=='Chinese')var _0x35d2ec=users[_0x127224(0x1e1)];else{if(_0x33df07[0x0]['language']==_0x127224(0x2bb))var _0x35d2ec=users['Arabic'];}}}}}}}_0x2b6a17[_0x127224(0x285)](_0x127224(0x2a8),{'success':_0x3da142['flash'](_0x127224(0x258)),'errors':_0x3da142[_0x127224(0x1fa)](_0x127224(0x273)),'role':_0x23570f,'profile':_0x3aabb9,'customer':_0x49fbcd,'warehouse':_0x24a93c,'product':_0x4ffbac,'user':_0x5b5c6d,'master_shop':_0x33df07,'unit':_0x1a3c7c,'language':_0x35d2ec});}catch(_0x55b6c6){console[_0x127224(0x255)](_0x55b6c6);}}),router[a0_0x40155e(0x266)]('/preview/:id',auth,async(_0x3bdd4d,_0x1b24ae)=>{var _0x42bb9a=a0_0x40155e;try{const _0x8d0682=_0x3bdd4d[_0x42bb9a(0x2cf)]['id'],{invoice:_0x411ec2,warehouse_name:_0x9d7295,room:_0x1200bc}=_0x3bdd4d[_0x42bb9a(0x2ef)],_0x590ed9=await sales_finished[_0x42bb9a(0x245)]({'invoice':_0x411ec2}),_0x11ccd6=_0x590ed9[_0x42bb9a(0x295)]['map'](async _0x594bf6=>{var _0xeee242=_0x42bb9a,_0x3054b0=await warehouse['findOne']({'name':_0x9d7295,'room':_0x594bf6['room_name'],'warehouse_category':_0xeee242(0x209)});const _0x5ba96c=_0x3054b0[_0xeee242(0x236)][_0xeee242(0x2d8)](_0x5566ec=>{var _0x1c3f27=_0xeee242;if(_0x5566ec[_0x1c3f27(0x24e)]==_0x594bf6[_0x1c3f27(0x24e)]&&_0x5566ec['bay']==_0x594bf6['bay']&&_0x5566ec[_0x1c3f27(0x2d6)]==_0x594bf6[_0x1c3f27(0x2d6)]&&_0x5566ec[_0x1c3f27(0x290)]==_0x594bf6[_0x1c3f27(0x290)]&&_0x5566ec[_0x1c3f27(0x1e9)]==_0x594bf6['batch_code']&&_0x5566ec['_id']==_0x594bf6['id_transaction_from']){if(_0x5566ec[_0x1c3f27(0x22a)]>0x0){_0x5566ec[_0x1c3f27(0x22a)]=Math[_0x1c3f27(0x2a4)](0x0,Math[_0x1c3f27(0x265)](_0x5566ec[_0x1c3f27(0x22a)])-Math['abs'](_0x594bf6['quantity']));if(_0x5566ec[_0x1c3f27(0x29f)]==undefined)_0x5566ec[_0x1c3f27(0x29f)]=_0x411ec2+'~';else{var _0x295e22=_0x5566ec[_0x1c3f27(0x29f)]['split']('~'),_0x2e274f='';for(let _0x14adbe=0x0;_0x14adbe<=_0x295e22[_0x1c3f27(0x2d4)]-0x1;_0x14adbe++){const _0x108b7a=_0x295e22[_0x14adbe];_0x108b7a['length']>0x0&&(_0x2e274f+=_0x108b7a+'~');}_0x5566ec[_0x1c3f27(0x29f)]=_0x2e274f;}}}});return console[_0xeee242(0x255)](_0x3054b0),_0x3054b0;});Promise[_0x42bb9a(0x26b)](_0x11ccd6)[_0x42bb9a(0x23a)](async _0x9595c8=>{var _0x15194d=_0x42bb9a;try{for(const _0x381a10 of _0x9595c8){await _0x381a10['save']();}_0x590ed9['finalize']='True';const _0x3156af=await _0x590ed9[_0x15194d(0x2b1)](),_0x2fc1e5=await master_shop['find'](),_0x2cda51=await email_settings[_0x15194d(0x245)](),_0x2484b7=await supervisor_settings[_0x15194d(0x28b)]();var _0x5b852b=_0x590ed9[_0x15194d(0x295)],_0x2a8eeb='',_0x490886;for(_0x490886 in _0x5b852b){var _0x454e90='FG';_0x590ed9['warehouse_name']==_0x15194d(0x203)&&(_0x454e90='DG'),_0x2a8eeb+=_0x15194d(0x240)+_0x15194d(0x208)+_0x5b852b[_0x490886][_0x15194d(0x24e)]+'</td>'+_0x15194d(0x208)+_0x5b852b[_0x490886][_0x15194d(0x2c2)]+_0x15194d(0x2ce)+_0x15194d(0x208)+_0x5b852b[_0x490886][_0x15194d(0x2a3)]+_0x15194d(0x2ce)+_0x15194d(0x208)+_0x5b852b[_0x490886]['unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5b852b[_0x490886][_0x15194d(0x1f5)]+_0x15194d(0x2ce)+_0x15194d(0x208)+_0x590ed9[_0x15194d(0x282)]+'</td>'+_0x15194d(0x208)+_0x5b852b[_0x490886][_0x15194d(0x221)]+_0x15194d(0x2ce)+_0x15194d(0x208)+_0x454e90+_0x5b852b[_0x490886][_0x15194d(0x2e6)]+_0x15194d(0x2ce);}let _0x263971=nodemailer[_0x15194d(0x2af)]({'host':_0x2cda51['host'],'port':Number(_0x2cda51[_0x15194d(0x225)]),'secure':![],'auth':{'user':_0x2cda51[_0x15194d(0x2a1)],'pass':_0x2cda51[_0x15194d(0x2df)]}}),_0xfe9a43={'from':_0x2cda51[_0x15194d(0x2a1)],'to':_0x2484b7[0x0]['FGSEmail'],'subject':'Sales\x20Mail','attachments':[{'filename':_0x15194d(0x2c4),'path':__dirname+_0x15194d(0x24d)+'/upload/'+_0x2fc1e5[0x0]['image'],'cid':_0x15194d(0x214)}],'html':_0x15194d(0x25a)+_0x15194d(0x1dd)+'</head><body>'+_0x15194d(0x298)+_0x15194d(0x1fc)+_0x15194d(0x298)+_0x15194d(0x1fd)+_0x15194d(0x275)+_0x15194d(0x298)+_0x15194d(0x21a)+_0x2fc1e5[0x0]['site_title']+_0x15194d(0x26f)+_0x15194d(0x275)+_0x15194d(0x275)+'<hr\x20class=\x22my-3\x22>'+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x590ed9[_0x15194d(0x30b)]+'\x20'+_0x15194d(0x28d)+_0x15194d(0x2f8)+_0x590ed9['date']+'\x20'+_0x15194d(0x30d)+_0x15194d(0x21f)+_0x15194d(0x275)+_0x15194d(0x2ed)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x15194d(0x271)+_0x15194d(0x22b)+_0x15194d(0x2d3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x15194d(0x217)+_0x15194d(0x202)+_0x15194d(0x2f9)+_0x15194d(0x248)+_0x15194d(0x2be)+_0x15194d(0x1da)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x2a8eeb+'\x20'+'</tbody>'+'</table>'+'<div>'+_0x15194d(0x2cb)+_0x15194d(0x1df)+_0x2fc1e5[0x0][_0x15194d(0x2d0)]+_0x15194d(0x21f)+_0x15194d(0x275)+_0x15194d(0x275)+'</body></html>'};_0x263971['sendMail'](_0xfe9a43,function(_0x131584,_0x4123de){var _0x2eaa98=_0x15194d;_0x131584?(console[_0x2eaa98(0x255)](_0x131584),console[_0x2eaa98(0x255)](_0x2eaa98(0x21e))):console[_0x2eaa98(0x255)](_0x2eaa98(0x1e3));}),_0x3bdd4d[_0x15194d(0x1fa)](_0x15194d(0x258),_0x15194d(0x1e4)),_0x1b24ae[_0x15194d(0x1ec)]('/picking_list/pdf/'+_0x8d0682);}catch(_0x3fe986){console[_0x15194d(0x2da)](_0x3fe986),_0x1b24ae[_0x15194d(0x20f)](0x1f4)[_0x15194d(0x2cd)]({'error':_0x15194d(0x27d)});}})[_0x42bb9a(0x22d)](_0x4e78ae=>{var _0x2eb41c=_0x42bb9a;console[_0x2eb41c(0x2da)](_0x4e78ae),_0x1b24ae[_0x2eb41c(0x20f)](0x1f4)[_0x2eb41c(0x2cd)]({'error':_0x2eb41c(0x2b6)});});}catch(_0x1fce63){console[_0x42bb9a(0x255)](_0x1fce63);}}),router[a0_0x40155e(0x1e0)]('/view/:id',auth,async(_0x14bb38,_0x24227d)=>{var _0x146e11=a0_0x40155e;try{const {username:_0x328fdd,email:_0x2bc958,role:_0x21ad23}=_0x14bb38[_0x146e11(0x26a)],_0x5063c0=_0x14bb38[_0x146e11(0x26a)],_0x4e1b17=await profile['findOne']({'email':_0x5063c0[_0x146e11(0x2a1)]}),_0x814ad7=await master_shop[_0x146e11(0x28b)](),_0x41b078=_0x14bb38[_0x146e11(0x2cf)]['id'],_0x52fdc6=await sales_finished[_0x146e11(0x220)](_0x41b078);let _0x530a64=new Date(_0x52fdc6['expiry_date']),_0x34a0d1=('0'+_0x530a64['getDate']())[_0x146e11(0x26c)](-0x2),_0x1a6970=('0'+(_0x530a64[_0x146e11(0x307)]()+0x1))['slice'](-0x2),_0x29a0aa=_0x530a64['getFullYear'](),_0x3b513b=_0x29a0aa+'-'+_0x1a6970+'-'+_0x34a0d1;var _0x15f3a9=[_0x146e11(0x21c),_0x146e11(0x30e)];const _0x105db1=await warehouse[_0x146e11(0x1ea)]([{'$match':{'name':_0x52fdc6['warehouse_name'],'room':_0x52fdc6[_0x146e11(0x21b)]}},{'$unwind':_0x146e11(0x24b)},{'$group':{'_id':_0x146e11(0x212),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x146e11(0x280)},'bay':{'$first':_0x146e11(0x306)},'bin':{'$first':_0x146e11(0x249)},'type':{'$first':_0x146e11(0x262)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x146e11(0x20b)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x146e11(0x1d2)},'rack':{'$first':_0x146e11(0x1f9)}}}]),_0x5093af=await customer[_0x146e11(0x28b)]({});let _0x402ec0;if(_0x5063c0[_0x146e11(0x253)]==_0x146e11(0x2e1)){const _0x5446eb=await staff[_0x146e11(0x245)]({'email':_0x5063c0[_0x146e11(0x2a1)]});_0x402ec0=await warehouse['aggregate']([{'$match':{'status':_0x146e11(0x20d),'name':_0x5446eb[_0x146e11(0x263)]}},{'$group':{'_id':_0x146e11(0x2db),'name':{'$first':_0x146e11(0x2db)}}}]);}else _0x402ec0=await warehouse[_0x146e11(0x1ea)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x146e11(0x2db),'name':{'$first':_0x146e11(0x2db)}}}]);const _0x4b2b44=await product['find']({});if(_0x814ad7[0x0][_0x146e11(0x1fb)]==_0x146e11(0x299)){var _0x17b903=users[_0x146e11(0x1d5)];console[_0x146e11(0x255)](_0x17b903);}else{if(_0x814ad7[0x0][_0x146e11(0x1fb)]==_0x146e11(0x1f4))var _0x17b903=users['Hindi'];else{if(_0x814ad7[0x0]['language']=='German')var _0x17b903=users[_0x146e11(0x2cc)];else{if(_0x814ad7[0x0][_0x146e11(0x1fb)]==_0x146e11(0x20e))var _0x17b903=users[_0x146e11(0x20e)];else{if(_0x814ad7[0x0]['language']==_0x146e11(0x30c))var _0x17b903=users[_0x146e11(0x30c)];else{if(_0x814ad7[0x0][_0x146e11(0x1fb)]==_0x146e11(0x25d))var _0x17b903=users[_0x146e11(0x1f6)];else{if(_0x814ad7[0x0][_0x146e11(0x1fb)]==_0x146e11(0x1e1))var _0x17b903=users[_0x146e11(0x1e1)];else{if(_0x814ad7[0x0][_0x146e11(0x1fb)]==_0x146e11(0x2bb))var _0x17b903=users['Arabic'];}}}}}}}_0x24227d['render'](_0x146e11(0x218),{'success':_0x14bb38[_0x146e11(0x1fa)](_0x146e11(0x258)),'errors':_0x14bb38[_0x146e11(0x1fa)](_0x146e11(0x273)),'role':_0x5063c0,'profile':_0x4e1b17,'customer':_0x5093af,'warehouse':_0x402ec0,'product':_0x105db1,'user':_0x52fdc6,'master_shop':_0x814ad7,'unit':_0x4b2b44,'language':_0x17b903,'rooms_data':_0x15f3a9,'ed_fullDate':_0x3b513b});}catch(_0x21218f){console[_0x146e11(0x255)](_0x21218f);}}),router[a0_0x40155e(0x266)]('/view/:id',auth,async(_0x14c2cb,_0x5dd50c)=>{var _0xe7ae4=a0_0x40155e;try{const _0x3f67a8=_0x14c2cb[_0xe7ae4(0x2cf)]['id'],_0x2ece78=await sales_finished[_0xe7ae4(0x245)]({'_id':_0x14c2cb[_0xe7ae4(0x2cf)]['id']}),_0x1a0c80=await warehouse[_0xe7ae4(0x245)]({'name':_0x2ece78['warehouse_name'],'room':_0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x21b)],'warehouse_category':_0xe7ae4(0x209)}),{invoice:_0x2311c1,customer:_0x1461a7,date:_0x2ff527,warehouse_name:_0x8c96e0,product_name:_0x5dedeb,stock:_0x464e,adjust_qty:_0x15ea86,note:_0x1ac089,room:_0x28a135,primary_code:_0x3a19e0,secondary_code:_0x41d2f5,prod_code:_0x409e61,level:_0xc33290,isle:_0x11064e,pallet:_0x25b638,expiry_date:_0x52ad8b}=_0x14c2cb['body'];if(typeof _0x5dedeb==_0xe7ae4(0x1ff))var _0x3922cc=[_0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x24e)]],_0x24247a=[_0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x29e)]],_0x424458=[_0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x1f2)]],_0x5b9891=[_0x14c2cb['body'][_0xe7ae4(0x30f)]],_0x465c6d=[_0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x242)]],_0x4fad6e=[_0x14c2cb['body'][_0xe7ae4(0x264)]],_0x35b32f=[_0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x278)]],_0x27fae6=[_0x14c2cb['body']['expiry_date']];else var _0x3922cc=[..._0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x24e)]],_0x24247a=[..._0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x29e)]],_0x424458=[..._0x14c2cb[_0xe7ae4(0x2ef)]['adjust_qty']],_0x5b9891=[..._0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x30f)]],_0x465c6d=[..._0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x242)]],_0x4fad6e=[..._0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x264)]],_0x35b32f=[..._0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x278)]],_0x27fae6=[..._0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x2d6)]];const _0x449bc5=_0x3922cc['map'](_0x5867d6=>{return _0x5867d6={'product_name':_0x5867d6};});_0x24247a[_0xe7ae4(0x2b3)]((_0x191ab3,_0x33447c)=>{var _0x575106=_0xe7ae4;_0x449bc5[_0x33447c][_0x575106(0x29e)]=_0x191ab3;}),_0x424458[_0xe7ae4(0x2b3)]((_0x166ec7,_0x1d7e88)=>{var _0x1ee0e7=_0xe7ae4;_0x449bc5[_0x1d7e88][_0x1ee0e7(0x2a3)]=_0x166ec7;}),_0x5b9891[_0xe7ae4(0x2b3)]((_0x2fdb9a,_0x18d2c7)=>{var _0x141fdc=_0xe7ae4;_0x449bc5[_0x18d2c7][_0x141fdc(0x30f)]=_0x2fdb9a;}),_0x465c6d[_0xe7ae4(0x2b3)]((_0x56f11c,_0x224fcf)=>{var _0x330be8=_0xe7ae4;_0x449bc5[_0x224fcf][_0x330be8(0x242)]=_0x56f11c;}),_0x4fad6e[_0xe7ae4(0x2b3)]((_0x56df6e,_0x562bb7)=>{_0x449bc5[_0x562bb7]['product_code']=_0x56df6e;}),_0x35b32f['forEach']((_0x72edf8,_0x213965)=>{var _0xfd332e=_0xe7ae4;_0x449bc5[_0x213965][_0xfd332e(0x278)]=_0x72edf8;}),_0x27fae6[_0xe7ae4(0x2b3)]((_0x1f3385,_0x70ebd)=>{var _0x4d86f8=_0xe7ae4;_0x449bc5[_0x70ebd][_0x4d86f8(0x2d6)]=_0x1f3385;});var _0x24121c=0x0;_0x449bc5[_0xe7ae4(0x2b3)](_0x2b01ba=>{var _0x566ab8=_0xe7ae4;console['log'](_0x566ab8(0x2b7),_0x2b01ba),(parseInt(_0x2b01ba['stock'])<parseInt(_0x2b01ba[_0x566ab8(0x2a3)])||parseInt(_0x2b01ba['quantity'])==0x0)&&_0x24121c++;});if(_0x24121c!=0x0)return _0x14c2cb[_0xe7ae4(0x1fa)](_0xe7ae4(0x273),_0xe7ae4(0x24c)),_0x5dd50c[_0xe7ae4(0x1ec)](_0xe7ae4(0x1e7));_0x2ece78[_0xe7ae4(0x295)][_0xe7ae4(0x2b3)](_0x28103a=>{var _0x499c10=_0xe7ae4;const _0x5b12e7=_0x1a0c80[_0x499c10(0x236)][_0x499c10(0x2d8)](_0x56a5e1=>{var _0x51f2fa=_0x499c10;_0x56a5e1[_0x51f2fa(0x24e)]==_0x28103a[_0x51f2fa(0x24e)]&&_0x56a5e1[_0x51f2fa(0x2e6)]==_0x28103a['bay']&&(_0x56a5e1['product_stock']=parseInt(_0x56a5e1[_0x51f2fa(0x22a)])+parseInt(_0x28103a[_0x51f2fa(0x2a3)]));});}),await _0x1a0c80['save']();const _0x1fe8a0=_0x449bc5[_0xe7ae4(0x205)](_0x1e10ed=>_0x1e10ed[_0xe7ae4(0x2a3)]!=='0'&&_0x1e10ed[_0xe7ae4(0x2a3)]!=='');_0x2ece78[_0xe7ae4(0x30b)]=_0x2311c1,_0x2ece78['customer']=_0x1461a7,_0x2ece78['date']=_0x2ff527,_0x2ece78[_0xe7ae4(0x282)]=_0x8c96e0,_0x2ece78[_0xe7ae4(0x295)]=_0x1fe8a0,_0x2ece78[_0xe7ae4(0x286)]=_0x1ac089,_0x2ece78[_0xe7ae4(0x21b)]=_0x28a135;const _0x5168a9=await _0x2ece78['save'](),_0x5ee149=await sales_finished[_0xe7ae4(0x245)]({'_id':_0x14c2cb['params']['id']}),_0x31862a=await warehouse[_0xe7ae4(0x245)]({'name':_0x8c96e0,'room':_0x28a135,'warehouse_category':_0xe7ae4(0x209)});_0x5ee149[_0xe7ae4(0x295)]['forEach'](_0x34c21a=>{var _0x4357a2=_0xe7ae4;const _0x17b94c=_0x31862a[_0x4357a2(0x236)][_0x4357a2(0x2d8)](_0x4f0924=>{var _0x2a953e=_0x4357a2;_0x4f0924[_0x2a953e(0x24e)]==_0x34c21a[_0x2a953e(0x24e)]&&_0x4f0924[_0x2a953e(0x2e6)]==_0x34c21a[_0x2a953e(0x2e6)]&&(_0x4f0924[_0x2a953e(0x22a)]=parseInt(_0x4f0924[_0x2a953e(0x22a)])-parseInt(_0x34c21a[_0x2a953e(0x2a3)]));});}),console['log'](_0xe7ae4(0x244),_0x31862a),await _0x31862a[_0xe7ae4(0x2b1)]();const _0x16edd6=await c_payment_data[_0xe7ae4(0x245)]({'invoice':_0x14c2cb[_0xe7ae4(0x2ef)][_0xe7ae4(0x30b)]});_0x16edd6['suppliers']=_0x14c2cb['body'][_0xe7ae4(0x229)],await _0x16edd6[_0xe7ae4(0x2b1)](),_0x14c2cb['flash'](_0xe7ae4(0x258),_0xe7ae4(0x1e4)),_0x5dd50c[_0xe7ae4(0x1ec)](_0xe7ae4(0x2aa));}catch(_0x31b664){console[_0xe7ae4(0x255)](_0x31b664);}}),router[a0_0x40155e(0x266)](a0_0x40155e(0x1d1),auth,async(_0xc2b24c,_0x34cbdb)=>{var _0x48cec9=a0_0x40155e;try{const _0x2382e0=_0xc2b24c[_0x48cec9(0x2cf)]['id'],{invoice:_0x3989da,customer:_0x11a30d,receivable_amount:_0x11668e,received_amount:_0x1087b2}=_0xc2b24c[_0x48cec9(0x2ef)],_0x542d6d=await sales[_0x48cec9(0x220)](_0x2382e0);console[_0x48cec9(0x255)](_0x542d6d);var _0x3a2836=_0x11668e-_0x1087b2;console['log'](_0x1087b2),_0x542d6d['received_amount']=parseFloat(_0x1087b2)+parseFloat(_0x542d6d[_0x48cec9(0x279)]),_0x542d6d[_0x48cec9(0x2a9)]=_0x3a2836,console[_0x48cec9(0x255)](_0x542d6d);const _0x4eba27=await _0x542d6d['save'](),_0x3df801=await c_payment_data[_0x48cec9(0x245)]({'invoice':_0x3989da});_0x3df801[_0x48cec9(0x287)]=_0x3a2836,await _0x3df801[_0x48cec9(0x2b1)]();let _0x66c4c9=new Date(),_0x2976c5=('0'+_0x66c4c9[_0x48cec9(0x28a)]())[_0x48cec9(0x26c)](-0x2),_0x2f6d32=('0'+(_0x66c4c9[_0x48cec9(0x307)]()+0x1))[_0x48cec9(0x26c)](-0x2),_0x2a7596=_0x66c4c9['getFullYear'](),_0x8d5640=_0x2a7596+'-'+_0x2f6d32+'-'+_0x2976c5;const _0x44a9f4=new customer_payment({'invoice':_0x3989da,'date':_0x2a7596+'-'+_0x2f6d32+'-'+_0x2976c5,'customer':_0x11a30d,'reason':_0x48cec9(0x23e),'amount':_0x1087b2}),_0x2230cc=await _0x44a9f4[_0x48cec9(0x2b1)]();_0xc2b24c[_0x48cec9(0x1fa)]('success',_0x48cec9(0x269)),_0x34cbdb[_0x48cec9(0x1ec)](_0x48cec9(0x2ad));}catch(_0x34b28e){console[_0x48cec9(0x255)](_0x34b28e);}}),router[a0_0x40155e(0x1e0)](a0_0x40155e(0x2c5),auth,async(_0x12411d,_0x4fa37f)=>{var _0x3c1b86=a0_0x40155e;try{const {username:_0xdb7b70,email:_0x47f756,role:_0x39a58f}=_0x12411d['user'],_0x23a923=_0x12411d[_0x3c1b86(0x26a)],_0xbc4756=await profile[_0x3c1b86(0x245)]({'email':_0x23a923[_0x3c1b86(0x2a1)]}),_0x1b8ae4=await master_shop['find']();console[_0x3c1b86(0x255)]('master',_0x1b8ae4);const _0x63bc25=_0x12411d['params']['id'],_0x14b67c=await sales[_0x3c1b86(0x220)](_0x63bc25);console['log'](_0x14b67c);const _0x441eee=await customer[_0x3c1b86(0x245)]({'name':_0x14b67c[_0x3c1b86(0x1f3)]});console[_0x3c1b86(0x255)](_0x441eee);if(_0x1b8ae4[0x0][_0x3c1b86(0x1fb)]==_0x3c1b86(0x299)){var _0xed3ca2=users[_0x3c1b86(0x1d5)];console[_0x3c1b86(0x255)](_0xed3ca2);}else{if(_0x1b8ae4[0x0]['language']==_0x3c1b86(0x1f4))var _0xed3ca2=users['Hindi'];else{if(_0x1b8ae4[0x0][_0x3c1b86(0x1fb)]==_0x3c1b86(0x2cc))var _0xed3ca2=users[_0x3c1b86(0x2cc)];else{if(_0x1b8ae4[0x0][_0x3c1b86(0x1fb)]==_0x3c1b86(0x20e))var _0xed3ca2=users[_0x3c1b86(0x20e)];else{if(_0x1b8ae4[0x0]['language']=='French')var _0xed3ca2=users[_0x3c1b86(0x30c)];else{if(_0x1b8ae4[0x0][_0x3c1b86(0x1fb)]==_0x3c1b86(0x25d))var _0xed3ca2=users[_0x3c1b86(0x1f6)];else{if(_0x1b8ae4[0x0][_0x3c1b86(0x1fb)]==_0x3c1b86(0x1e1))var _0xed3ca2=users['Chinese'];else{if(_0x1b8ae4[0x0][_0x3c1b86(0x1fb)]==_0x3c1b86(0x2bb))var _0xed3ca2=users[_0x3c1b86(0x210)];}}}}}}}_0x4fa37f[_0x3c1b86(0x285)](_0x3c1b86(0x2ea),{'success':_0x12411d[_0x3c1b86(0x1fa)]('success'),'errors':_0x12411d['flash']('errors'),'role':_0x23a923,'profile':_0xbc4756,'master_shop':_0x1b8ae4,'customers':_0x441eee,'sales':_0x14b67c,'language':_0xed3ca2});}catch(_0x51ced4){console[_0x3c1b86(0x255)](_0x51ced4);}}),router['get'](a0_0x40155e(0x2ac),auth,async(_0x948143,_0x182211)=>{var _0x9c9595=a0_0x40155e;try{const {username:_0x56f0b0,email:_0x1684fb,role:_0x2cb824}=_0x948143['user'],_0xd12a81=_0x948143['user'],_0x183562=await profile[_0x9c9595(0x245)]({'email':_0xd12a81[_0x9c9595(0x2a1)]}),_0x5eceb3=await master_shop[_0x9c9595(0x28b)](),_0x9421ea=_0x948143[_0x9c9595(0x2cf)]['id'],_0xec7162=await sales_finished[_0x9c9595(0x220)](_0x9421ea),_0x34d802=await warehouse[_0x9c9595(0x1ea)]([{'$match':{'name':_0xec7162['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x9c9595(0x212),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x9c9595(0x280)},'bay':{'$first':_0x9c9595(0x306)},'bin':{'$first':_0x9c9595(0x249)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x9c9595(0x1d0)},'primary_code':{'$first':_0x9c9595(0x1eb)},'secondary_code':{'$first':_0x9c9595(0x20b)},'product_code':{'$first':_0x9c9595(0x1f1)},'storage':{'$first':_0x9c9595(0x1d2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x9c9595(0x1d9)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':_0x9c9595(0x2dc)},'secondary_unit':{'$first':_0x9c9595(0x2e0)},'maxProducts':{'$first':_0x9c9595(0x293)},'batch_code':{'$first':_0x9c9595(0x2e3)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x519793=await product['find']({}),_0x3544b2=await warehouse['aggregate']([{'$match':{'status':_0x9c9595(0x20d),'warehouse_category':'Finished\x20Goods','name':{'$ne':'Return\x20Goods','$ne':_0x9c9595(0x291)}}},{'$group':{'_id':'$name','name':{'$first':_0x9c9595(0x2db)}}},{'$sort':{'name':0x1}}]);var _0x257136=[_0x9c9595(0x2fa)];const _0x2a7359=await warehouse[_0x9c9595(0x1ea)]([{'$match':{'status':_0x9c9595(0x20d),'name':_0x9c9595(0x291)}},{'$group':{'_id':_0x9c9595(0x2db),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x5eceb3[0x0][_0x9c9595(0x1fb)]==_0x9c9595(0x299)){var _0x1b0b2a=users[_0x9c9595(0x1d5)];console[_0x9c9595(0x255)](_0x1b0b2a);}else{if(_0x5eceb3[0x0]['language']==_0x9c9595(0x1f4))var _0x1b0b2a=users['Hindi'];else{if(_0x5eceb3[0x0][_0x9c9595(0x1fb)]==_0x9c9595(0x2cc))var _0x1b0b2a=users[_0x9c9595(0x2cc)];else{if(_0x5eceb3[0x0][_0x9c9595(0x1fb)]=='Spanish')var _0x1b0b2a=users[_0x9c9595(0x20e)];else{if(_0x5eceb3[0x0][_0x9c9595(0x1fb)]=='French')var _0x1b0b2a=users['French'];else{if(_0x5eceb3[0x0][_0x9c9595(0x1fb)]==_0x9c9595(0x25d))var _0x1b0b2a=users['Portuguese'];else{if(_0x5eceb3[0x0][_0x9c9595(0x1fb)]==_0x9c9595(0x1e1))var _0x1b0b2a=users[_0x9c9595(0x1e1)];else{if(_0x5eceb3[0x0][_0x9c9595(0x1fb)]=='Arabic\x20(ae)')var _0x1b0b2a=users[_0x9c9595(0x210)];}}}}}}}_0x182211['render']('return_sale_finished',{'success':_0x948143[_0x9c9595(0x1fa)]('success'),'errors':_0x948143['flash']('errors'),'role':_0xd12a81,'profile':_0x183562,'user':_0xec7162,'stock':_0x34d802,'master_shop':_0x5eceb3,'unit':_0x519793,'language':_0x1b0b2a,'warehouses':_0x3544b2,'rooms':_0x257136,'warehouse_QA':_0x2a7359});}catch(_0x46ec32){console[_0x9c9595(0x255)](_0x46ec32),_0x182211['status'](0xc8)[_0x9c9595(0x2cd)]({'message':_0x46ec32[_0x9c9595(0x228)]});}}),router[a0_0x40155e(0x266)]('/view/return_sales/:id',auth,async(_0x32ba3f,_0xef5a44)=>{var _0x188152=a0_0x40155e;if(_0x32ba3f['body'][_0x188152(0x254)]=='QA')try{const {invoice:_0x6d562e,date:_0x44f6d9,warehouse_name:_0x39ad63,product_name:_0x3c1098,primary_code:_0x52b873,secondary_code:_0x53b06d,product_code:_0x19a7fb,sales_quantity:_0x48a6c4,stocks:_0x395af1,return_qty:_0x1576e4,Room_name:_0x68d47c,to_warehouse_name_QA:_0x40888b,to_Room_name_QA:_0x2b7a1a,note:_0x43e5a8,for_categorize:_0x5f1012,product_name_QA1:_0xf4c610}=_0x32ba3f[_0x188152(0x2ef)];if(typeof _0xf4c610==_0x188152(0x1ff))var _0x299573=[_0x32ba3f['body'][_0x188152(0x272)]],_0x3cb3f7=[_0x32ba3f['body'][_0x188152(0x2fe)]],_0x5b75dc=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2e4)]],_0x488b5e=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x24f)]],_0x9bc40a=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x28f)]],_0x394625=[_0x32ba3f[_0x188152(0x2ef)]['stocks_QA']],_0x452e4a=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x29a)]],_0x1fee6a=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2f6)]],_0x5a54e0=[_0x32ba3f[_0x188152(0x2ef)]['maxProducts_QA']],_0x161c2c=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x230)]],_0x43eecc=[_0x32ba3f[_0x188152(0x2ef)]['secondary_unit_QA']],_0x291e76=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2a0)]],_0x159d02=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x211)]],_0x2014a0=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2e5)]];else var _0x299573=[..._0x32ba3f['body']['product_name_QA1']],_0x3cb3f7=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2fe)]],_0x5b75dc=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2e4)]],_0x488b5e=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x24f)]],_0x9bc40a=[..._0x32ba3f[_0x188152(0x2ef)]['sales_quantity_QA']],_0x394625=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x301)]],_0x452e4a=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x29a)]],_0x1fee6a=[..._0x32ba3f[_0x188152(0x2ef)]['maxPerUnit_QA']],_0x5a54e0=[..._0x32ba3f[_0x188152(0x2ef)]['maxProducts_QA']],_0x161c2c=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x230)]],_0x43eecc=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2b5)]],_0x291e76=[..._0x32ba3f[_0x188152(0x2ef)]['unit_QA']],_0x159d02=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x211)]],_0x2014a0=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2e5)]];const _0x5a6e3f=_0x299573['map'](_0x70c580=>{return _0x70c580={'product_name':_0x70c580};});_0x3cb3f7['forEach']((_0x355913,_0x572644)=>{_0x5a6e3f[_0x572644]['primary_code']=_0x355913;}),_0x5b75dc[_0x188152(0x2b3)]((_0x503149,_0x2b1d64)=>{var _0x5b0898=_0x188152;_0x5a6e3f[_0x2b1d64][_0x5b0898(0x242)]=_0x503149;}),_0x488b5e['forEach']((_0x1112d7,_0x3e3384)=>{var _0x683777=_0x188152;_0x5a6e3f[_0x3e3384][_0x683777(0x2c2)]=_0x1112d7;}),_0x9bc40a[_0x188152(0x2b3)]((_0x4b0502,_0x230ce2)=>{var _0x4aeee0=_0x188152;_0x5a6e3f[_0x230ce2][_0x4aeee0(0x23b)]=_0x4b0502;}),_0x394625[_0x188152(0x2b3)]((_0x1414a4,_0x23b9c9)=>{_0x5a6e3f[_0x23b9c9]['stock']=_0x1414a4;}),_0x452e4a[_0x188152(0x2b3)]((_0x42c031,_0x2f6bd0)=>{var _0x4192ca=_0x188152;_0x5a6e3f[_0x2f6bd0][_0x4192ca(0x22c)]=_0x42c031;}),_0x1fee6a[_0x188152(0x2b3)]((_0x39bf77,_0x1d814f)=>{var _0x42ac49=_0x188152;_0x5a6e3f[_0x1d814f][_0x42ac49(0x1e2)]=_0x39bf77;}),_0x5a54e0[_0x188152(0x2b3)]((_0x83414,_0x48fc87)=>{var _0x47803d=_0x188152;_0x5a6e3f[_0x48fc87][_0x47803d(0x1d6)]=_0x83414;}),_0x161c2c[_0x188152(0x2b3)]((_0x4baee9,_0x36ff7a)=>{var _0x29b541=_0x188152;_0x5a6e3f[_0x36ff7a][_0x29b541(0x1e9)]=_0x4baee9;}),_0x43eecc[_0x188152(0x2b3)]((_0x118cd8,_0x26f734)=>{var _0xe65832=_0x188152;_0x5a6e3f[_0x26f734][_0xe65832(0x1f5)]=_0x118cd8;}),_0x291e76[_0x188152(0x2b3)]((_0x370432,_0xe42c55)=>{var _0x2e1980=_0x188152;_0x5a6e3f[_0xe42c55][_0x2e1980(0x27e)]=_0x370432;}),_0x159d02[_0x188152(0x2b3)]((_0x3c10de,_0x4a6d87)=>{var _0x441150=_0x188152;_0x5a6e3f[_0x4a6d87][_0x441150(0x290)]=_0x3c10de;}),_0x2014a0[_0x188152(0x2b3)]((_0x4d321e,_0x545b32)=>{var _0x17d43f=_0x188152;_0x5a6e3f[_0x545b32][_0x17d43f(0x2d6)]=_0x4d321e;});const _0x2f2a51=await sales_finished[_0x188152(0x245)]({'invoice':_0x6d562e});_0x2f2a51[_0x188152(0x23f)]=_0x188152(0x2fb);const _0x4c556c=await _0x2f2a51[_0x188152(0x2b1)](),_0x24f6fd=new sales_return_finished({'invoice':_0x6d562e,'customer':_0x32ba3f['body'][_0x188152(0x1f3)],'date':_0x44f6d9,'warehouse_name':_0x39ad63,'room':_0x68d47c,'ToWarehouse':_0x40888b,'ToRoom':_0x2b7a1a,'return_sale_QA':_0x5a6e3f,'note':_0x43e5a8,'warehouse_cat':_0x5f1012}),_0x2737fb=await _0x24f6fd[_0x188152(0x2b1)](),_0xc7ea60=await sales_return_finished['findOne']({'invoice':_0x6d562e}),_0x392656=await warehouse['findOne']({'name':_0x40888b,'room':_0x2b7a1a});_0xc7ea60['return_sale_QA'][_0x188152(0x2b3)](_0x1fc7bb=>{var _0x337b99=_0x188152,_0x24a0c8=0x0;const _0xe4d90=_0x392656[_0x337b99(0x236)][_0x337b99(0x2d8)](_0x50f3cf=>{var _0x4edcd0=_0x337b99;_0x50f3cf[_0x4edcd0(0x24e)]==_0x1fc7bb[_0x4edcd0(0x24e)]&&_0x50f3cf[_0x4edcd0(0x2d6)]==_0x1fc7bb[_0x4edcd0(0x2d6)]&&_0x50f3cf[_0x4edcd0(0x290)]==_0x1fc7bb['production_date']&&_0x50f3cf[_0x4edcd0(0x1e9)]==_0x1fc7bb[_0x4edcd0(0x1e9)]&&(_0x50f3cf[_0x4edcd0(0x22a)]=parseInt(_0x50f3cf['product_stock'])+parseInt(_0x1fc7bb[_0x4edcd0(0x22c)]),_0x24a0c8++);});_0x24a0c8=='0'&&(_0x392656[_0x337b99(0x236)]=_0x392656[_0x337b99(0x236)]['concat']({'product_name':_0x1fc7bb['product_name'],'product_stock':_0x1fc7bb['return_qty'],'primary_code':_0x1fc7bb['primary_code'],'secondary_code':_0x1fc7bb[_0x337b99(0x242)],'product_code':_0x1fc7bb[_0x337b99(0x2c2)],'batch_code':_0x1fc7bb['batch_code'],'maxPerUnit':_0x1fc7bb[_0x337b99(0x1e2)],'production_date':_0x1fc7bb[_0x337b99(0x290)],'expiry_date':_0x1fc7bb[_0x337b99(0x2d6)],'secondary_unit':_0x1fc7bb['secondary_unit'],'unit':_0x1fc7bb[_0x337b99(0x27e)],'maxProducts':_0x1fc7bb[_0x337b99(0x1d6)],'bay':_0x1fc7bb['bay']}));}),await _0x392656[_0x188152(0x2b1)]();const _0x348f91=new c_payment_data({'invoice':_0x6d562e,'customer':_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1f3)],'reason':_0x188152(0x2de)});await _0x348f91[_0x188152(0x2b1)]();const _0x1dcbf1=await master_shop['find'](),_0x4d3488=await email_settings[_0x188152(0x245)](),_0x542c6a=await customer[_0x188152(0x245)]({'name':_0x32ba3f[_0x188152(0x2ef)]['customer']});_0x1dcbf1[0x0][_0x188152(0x1f7)]==0x1?(right_currency=_0x1dcbf1[0x0][_0x188152(0x257)],left_currency=''):(right_currency='',left_currency=_0x1dcbf1[0x0][_0x188152(0x257)]);var _0x23b64c=_0x299573,_0x8532bb=_0x452e4a,_0x4ae26c='',_0x395bba;for(_0x395bba in _0x23b64c){_0x4ae26c+=_0x188152(0x240)+_0x188152(0x208)+_0x23b64c[_0x395bba]+_0x188152(0x2ce)+_0x188152(0x208)+_0x8532bb[_0x395bba]+'</td>'+_0x188152(0x2be);}console['log'](_0x188152(0x289),_0x4ae26c);let _0x15b028=nodemailer[_0x188152(0x2af)]({'service':_0x188152(0x1de),'auth':{'user':_0x4d3488['email'],'pass':_0x4d3488[_0x188152(0x2df)]}}),_0x383937={'from':_0x4d3488[_0x188152(0x2a1)],'to':_0x542c6a[_0x188152(0x2a1)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+'/upload/'+_0x1dcbf1[0x0][_0x188152(0x252)],'cid':_0x188152(0x214)}],'html':_0x188152(0x25a)+'<html><head><title></title>'+'</head><body>'+'<div>'+_0x188152(0x1fc)+'<div>'+_0x188152(0x1fd)+_0x188152(0x275)+_0x188152(0x298)+_0x188152(0x21a)+_0x1dcbf1[0x0][_0x188152(0x2d0)]+'\x20</h2>'+_0x188152(0x275)+_0x188152(0x275)+'<hr\x20class=\x22my-3\x22>'+_0x188152(0x298)+_0x188152(0x2ff)+'\x20Order\x20Number\x20:\x20'+_0x6d562e+'\x20'+_0x188152(0x28d)+_0x188152(0x2f8)+_0x44f6d9+'\x20'+_0x188152(0x30d)+_0x188152(0x21f)+_0x188152(0x275)+_0x188152(0x2ed)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x188152(0x240)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x188152(0x207)+_0x188152(0x270)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x188152(0x2be)+_0x188152(0x1da)+_0x188152(0x1cf)+'\x20'+_0x4ae26c+'\x20'+'</tbody>'+_0x188152(0x2f1)+_0x188152(0x298)+_0x188152(0x2cb)+_0x188152(0x1df)+_0x1dcbf1[0x0]['site_title']+_0x188152(0x21f)+_0x188152(0x275)+'</div>'+_0x188152(0x24a)};_0x15b028[_0x188152(0x204)](_0x383937,function(_0x500732,_0x2e2385){var _0x1553a9=_0x188152;_0x500732?(console[_0x1553a9(0x255)](_0x500732),console['log'](_0x1553a9(0x21e))):console[_0x1553a9(0x255)](_0x1553a9(0x1e3));}),_0x32ba3f[_0x188152(0x1fa)](_0x188152(0x258),_0x188152(0x302)),_0xef5a44[_0x188152(0x1ec)](_0x188152(0x2aa));}catch(_0x1e0687){_0xef5a44[_0x188152(0x20f)](0xc8)[_0x188152(0x2cd)]({'message1':_0x1e0687[_0x188152(0x228)]});}else{if(_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x254)]=='GS')try{const {invoice:_0xceb449,date:_0x2d1bc2,warehouse_name:_0x346d72,product_name:_0x1b8d8a,primary_code:_0x5b7b33,secondary_code:_0x1739ed,product_code:_0x42a972,sales_quantity:_0x4d15ff,stocks:_0x447ab5,return_qty:_0x179870,Room_name:_0x2320cf,to_warehouse_name:_0x355e85,to_Room_name:_0x4acb96,note:_0x2ad900,level:_0x54f300,isle:_0x40d0b2,pallet:_0x5876a5,for_categorize:_0x4af82b}=_0x32ba3f[_0x188152(0x2ef)];if(typeof _0x1b8d8a==_0x188152(0x1ff))var _0x299573=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x24e)]],_0x3cb3f7=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x30f)]],_0x5b75dc=[_0x32ba3f[_0x188152(0x2ef)]['secondary_code']],_0x488b5e=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2c2)]],_0x9bc40a=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2f4)]],_0x452e4a=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x22c)]],_0x3e8967=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2e6)]],_0x1fee6a=[_0x32ba3f['body'][_0x188152(0x1e2)]],_0x5a54e0=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1d6)]],_0x161c2c=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1e9)]],_0x43eecc=[_0x32ba3f[_0x188152(0x2ef)]['secondary_unit']],_0x291e76=[_0x32ba3f['body'][_0x188152(0x27e)]],_0x159d02=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x290)]],_0x2014a0=[_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2d6)]];else var _0x299573=[..._0x32ba3f['body']['product_name']],_0x3cb3f7=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x30f)]],_0x5b75dc=[..._0x32ba3f['body']['secondary_code']],_0x488b5e=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2c2)]],_0x9bc40a=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2f4)]],_0x452e4a=[..._0x32ba3f['body'][_0x188152(0x22c)]],_0x3e8967=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x2e6)]],_0x1fee6a=[..._0x32ba3f['body']['maxPerUnit']],_0x5a54e0=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1d6)]],_0x161c2c=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1e9)]],_0x43eecc=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1f5)]],_0x291e76=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x27e)]],_0x159d02=[..._0x32ba3f[_0x188152(0x2ef)][_0x188152(0x290)]],_0x2014a0=[..._0x32ba3f[_0x188152(0x2ef)]['expiry_date']];const _0x55c037=_0x299573[_0x188152(0x2d8)](_0x3b503c=>{return _0x3b503c={'product_name':_0x3b503c};});_0x3cb3f7[_0x188152(0x2b3)]((_0x238b12,_0x507608)=>{var _0x56426c=_0x188152;_0x55c037[_0x507608][_0x56426c(0x30f)]=_0x238b12;}),_0x5b75dc[_0x188152(0x2b3)]((_0x578178,_0x175fcc)=>{var _0x3aa246=_0x188152;_0x55c037[_0x175fcc][_0x3aa246(0x242)]=_0x578178;}),_0x488b5e[_0x188152(0x2b3)]((_0xe31918,_0x1eeb01)=>{var _0xaf37e4=_0x188152;_0x55c037[_0x1eeb01][_0xaf37e4(0x2c2)]=_0xe31918;}),_0x9bc40a[_0x188152(0x2b3)]((_0x128973,_0xb11b34)=>{var _0xdd602f=_0x188152;_0x55c037[_0xb11b34][_0xdd602f(0x23b)]=_0x128973;}),_0x452e4a[_0x188152(0x2b3)]((_0x315953,_0x63e789)=>{var _0x26cc99=_0x188152;_0x55c037[_0x63e789][_0x26cc99(0x22c)]=_0x315953;}),_0x3e8967[_0x188152(0x2b3)]((_0x1e4a41,_0x4fc3bc)=>{var _0x350c7b=_0x188152;_0x55c037[_0x4fc3bc][_0x350c7b(0x2e6)]=_0x1e4a41;}),_0x1fee6a[_0x188152(0x2b3)]((_0x1005e6,_0x4a9a84)=>{var _0x147881=_0x188152;_0x55c037[_0x4a9a84][_0x147881(0x1e2)]=_0x1005e6;}),_0x5a54e0['forEach']((_0x31bfe4,_0x2c2459)=>{_0x55c037[_0x2c2459]['maxProducts']=_0x31bfe4;}),_0x161c2c[_0x188152(0x2b3)]((_0x26c1a9,_0x353d43)=>{var _0x4784a3=_0x188152;_0x55c037[_0x353d43][_0x4784a3(0x1e9)]=_0x26c1a9;}),_0x43eecc['forEach']((_0x2ff6db,_0x4d5dc4)=>{var _0x5f5425=_0x188152;_0x55c037[_0x4d5dc4][_0x5f5425(0x1f5)]=_0x2ff6db;}),_0x291e76['forEach']((_0x3e72ce,_0x524129)=>{var _0x870f8d=_0x188152;_0x55c037[_0x524129][_0x870f8d(0x27e)]=_0x3e72ce;}),_0x159d02['forEach']((_0xddc53a,_0x5b6d75)=>{var _0x585498=_0x188152;_0x55c037[_0x5b6d75][_0x585498(0x290)]=_0xddc53a;}),_0x2014a0['forEach']((_0x1d32d7,_0x2d2bfb)=>{var _0x2e7c40=_0x188152;_0x55c037[_0x2d2bfb][_0x2e7c40(0x2d6)]=_0x1d32d7;});var _0x38174d=0x0;_0x55c037['forEach'](_0x2b5a79=>{var _0x3ea2aa=_0x188152;(parseInt(_0x2b5a79[_0x3ea2aa(0x23b)])<parseInt(_0x2b5a79[_0x3ea2aa(0x22c)])||parseInt(_0x2b5a79['stock'])<parseInt(_0x2b5a79[_0x3ea2aa(0x22c)])&&parseInt(_0x2b5a79[_0x3ea2aa(0x23b)])>parseInt(_0x2b5a79[_0x3ea2aa(0x22c)])||parseInt(_0x2b5a79[_0x3ea2aa(0x22c)])==0x0)&&_0x38174d++;});if(_0x38174d!=0x0)return _0x32ba3f[_0x188152(0x1fa)]('errors',_0x188152(0x261)),_0xef5a44[_0x188152(0x1ec)](_0x188152(0x1e7));const _0x110268=await sales_finished[_0x188152(0x245)]({'invoice':_0xceb449});_0x110268['return_data']=_0x188152(0x2fb);const _0x1f099f=await _0x110268[_0x188152(0x2b1)](),_0x42251d=new sales_return_finished({'invoice':_0xceb449,'customer':_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1f3)],'date':_0x2d1bc2,'warehouse_name':_0x346d72,'room':_0x2320cf,'ToWarehouse':_0x355e85,'ToRoom':_0x4acb96,'return_sale':_0x55c037,'note':_0x2ad900,'warehouse_cat':_0x4af82b}),_0x1eeb72=await _0x42251d[_0x188152(0x2b1)](),_0x172d7e=await sales_return_finished['findOne']({'invoice':_0xceb449}),_0x379bf9=await warehouse['findOne']({'name':_0x355e85,'room':_0x4acb96,'warehouse_category':_0x188152(0x209)});_0x172d7e[_0x188152(0x2ca)][_0x188152(0x2b3)](_0x1fa965=>{var _0x49696a=_0x188152,_0x80912e=0x0;const _0x20151e=_0x379bf9[_0x49696a(0x236)]['map'](_0x4ec1ad=>{var _0x541c42=_0x49696a;_0x4ec1ad[_0x541c42(0x24e)]==_0x1fa965[_0x541c42(0x24e)]&&_0x4ec1ad[_0x541c42(0x2e6)]==_0x1fa965[_0x541c42(0x2e6)]&&_0x4ec1ad['expiry_date']==_0x1fa965[_0x541c42(0x2d6)]&&_0x4ec1ad['production_date']==_0x1fa965[_0x541c42(0x290)]&&_0x4ec1ad[_0x541c42(0x1e9)]==_0x1fa965['batch_code']&&(_0x4ec1ad[_0x541c42(0x22a)]=parseInt(_0x4ec1ad[_0x541c42(0x22a)])+parseInt(_0x1fa965['return_qty']),_0x80912e++);});_0x80912e=='0'&&(_0x379bf9[_0x49696a(0x236)]=_0x379bf9[_0x49696a(0x236)][_0x49696a(0x20c)]({'product_name':_0x1fa965[_0x49696a(0x24e)],'product_stock':_0x1fa965[_0x49696a(0x22c)],'primary_code':_0x1fa965['primary_code'],'secondary_code':_0x1fa965['secondary_code'],'product_code':_0x1fa965[_0x49696a(0x2c2)],'bay':_0x1fa965[_0x49696a(0x2e6)],'batch_code':_0x1fa965[_0x49696a(0x1e9)],'maxPerUnit':_0x1fa965[_0x49696a(0x1e2)],'production_date':_0x1fa965[_0x49696a(0x290)],'expiry_date':_0x1fa965[_0x49696a(0x2d6)],'secondary_unit':_0x1fa965[_0x49696a(0x1f5)],'unit':_0x1fa965['unit'],'maxProducts':_0x1fa965[_0x49696a(0x1d6)]}));}),await _0x379bf9[_0x188152(0x2b1)](),console[_0x188152(0x255)](_0x32ba3f[_0x188152(0x2ef)]);const _0x83433c=new c_payment_data({'invoice':_0xceb449,'customer':_0x32ba3f[_0x188152(0x2ef)][_0x188152(0x1f3)],'reason':'Sale\x20Return'});await _0x83433c['save']();const _0xb0340c=await master_shop[_0x188152(0x28b)]();console[_0x188152(0x255)](_0x188152(0x297),_0xb0340c[0x0]['image']);const _0x12abe9=await email_settings['findOne'](),_0x473fe1=await customer[_0x188152(0x245)]({'name':_0x32ba3f['body'][_0x188152(0x1f3)]});console[_0x188152(0x255)](_0x188152(0x276),_0x473fe1);_0xb0340c[0x0][_0x188152(0x1f7)]==0x1?(right_currency=_0xb0340c[0x0][_0x188152(0x257)],left_currency=''):(right_currency='',left_currency=_0xb0340c[0x0]['currency']);var _0x23b64c=_0x299573,_0x8532bb=_0x452e4a,_0x4ae26c='',_0x395bba;for(_0x395bba in _0x23b64c){_0x4ae26c+=_0x188152(0x240)+_0x188152(0x208)+_0x23b64c[_0x395bba]+_0x188152(0x2ce)+_0x188152(0x208)+_0x8532bb[_0x395bba]+_0x188152(0x2ce)+'</tr>';}console[_0x188152(0x255)](_0x188152(0x289),_0x4ae26c);let _0x42ccdf=nodemailer[_0x188152(0x2af)]({'service':'gmail','auth':{'user':_0x12abe9[_0x188152(0x2a1)],'pass':_0x12abe9[_0x188152(0x2df)]}}),_0x563bb6={'from':_0x12abe9[_0x188152(0x2a1)],'to':_0x473fe1[_0x188152(0x2a1)],'subject':_0x188152(0x2f7),'attachments':[{'filename':_0x188152(0x2c4),'path':__dirname+_0x188152(0x24d)+'/upload/'+_0xb0340c[0x0][_0x188152(0x252)],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x188152(0x1dd)+_0x188152(0x22e)+_0x188152(0x298)+_0x188152(0x1fc)+'<div>'+_0x188152(0x1fd)+'</div>'+_0x188152(0x298)+_0x188152(0x21a)+_0xb0340c[0x0]['site_title']+_0x188152(0x26f)+_0x188152(0x275)+_0x188152(0x275)+'<hr\x20class=\x22my-3\x22>'+_0x188152(0x298)+_0x188152(0x2ff)+'\x20Order\x20Number\x20:\x20'+_0xceb449+'\x20'+_0x188152(0x28d)+'\x20Order\x20Date\x20:\x20'+_0x2d1bc2+'\x20'+'</span>'+_0x188152(0x21f)+_0x188152(0x275)+_0x188152(0x2ed)+_0x188152(0x2b2)+_0x188152(0x240)+_0x188152(0x271)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x188152(0x270)+_0x188152(0x1f0)+_0x188152(0x2be)+_0x188152(0x1da)+_0x188152(0x1cf)+'\x20'+_0x4ae26c+'\x20'+_0x188152(0x29c)+_0x188152(0x2f1)+_0x188152(0x298)+_0x188152(0x2cb)+_0x188152(0x1df)+_0xb0340c[0x0][_0x188152(0x2d0)]+_0x188152(0x21f)+_0x188152(0x275)+_0x188152(0x275)+'</body></html>'};_0x42ccdf[_0x188152(0x204)](_0x563bb6,function(_0x263e9b,_0x429485){var _0x28d82d=_0x188152;_0x263e9b?(console[_0x28d82d(0x255)](_0x263e9b),console['log'](_0x28d82d(0x21e))):console['log'](_0x28d82d(0x1e3));}),_0x32ba3f['flash'](_0x188152(0x258),_0x188152(0x302)),_0xef5a44[_0x188152(0x1ec)](_0x188152(0x2aa));}catch(_0x36ddf2){console[_0x188152(0x255)](_0x36ddf2),_0xef5a44[_0x188152(0x20f)](0xc8)['json']({'message1':_0x36ddf2[_0x188152(0x228)]});}}}),router[a0_0x40155e(0x1e0)](a0_0x40155e(0x1e5),auth,async(_0x1b9a14,_0x240bc3)=>{var _0x4f5918=a0_0x40155e;try{const {username:_0x1045e7,email:_0x3b557a,role:_0x4c7f23}=_0x1b9a14['user'],_0x4292b6=_0x1b9a14[_0x4f5918(0x26a)],_0x2f6f18=await profile[_0x4f5918(0x245)]({'email':_0x4292b6['email']}),_0x134047=await master_shop[_0x4f5918(0x28b)]();console[_0x4f5918(0x255)]('barcode\x20Product\x20master',_0x134047);const _0x46869f=_0x1b9a14[_0x4f5918(0x2cf)]['id'],_0x3eb6d1=await sales[_0x4f5918(0x220)](_0x46869f);console[_0x4f5918(0x255)]('barcode\x20user_id',_0x3eb6d1);if(_0x134047[0x0][_0x4f5918(0x1fb)]=='English\x20(US)')var _0x58fc27=users[_0x4f5918(0x1d5)];else{if(_0x134047[0x0][_0x4f5918(0x1fb)]==_0x4f5918(0x1f4))var _0x58fc27=users['Hindi'];else{if(_0x134047[0x0][_0x4f5918(0x1fb)]==_0x4f5918(0x2cc))var _0x58fc27=users[_0x4f5918(0x2cc)];else{if(_0x134047[0x0][_0x4f5918(0x1fb)]=='Spanish')var _0x58fc27=users[_0x4f5918(0x20e)];else{if(_0x134047[0x0][_0x4f5918(0x1fb)]=='French')var _0x58fc27=users[_0x4f5918(0x30c)];else{if(_0x134047[0x0]['language']==_0x4f5918(0x25d))var _0x58fc27=users[_0x4f5918(0x1f6)];else{if(_0x134047[0x0]['language']=='Chinese')var _0x58fc27=users[_0x4f5918(0x1e1)];else{if(_0x134047[0x0][_0x4f5918(0x1fb)]==_0x4f5918(0x2bb))var _0x58fc27=users[_0x4f5918(0x210)];}}}}}}}_0x240bc3[_0x4f5918(0x285)](_0x4f5918(0x1db),{'success':_0x1b9a14[_0x4f5918(0x1fa)](_0x4f5918(0x258)),'errors':_0x1b9a14[_0x4f5918(0x1fa)](_0x4f5918(0x273)),'role':_0x4292b6,'profile':_0x2f6f18,'alldata':_0x3eb6d1,'master_shop':_0x134047,'language':_0x58fc27});}catch(_0x4d45fe){console[_0x4f5918(0x255)](_0x4d45fe);}}),router[a0_0x40155e(0x266)]('/barcode_scanner',async(_0x2a852e,_0x21fd17)=>{var _0x4f37c7=a0_0x40155e;const {product_code:_0x5a7a7b,warehouse_name:_0x15c4c7,rooms_data:_0x228e33,Roomslist:_0x219ff8}=_0x2a852e[_0x4f37c7(0x2ef)],_0x6cc6e2=_0x219ff8[_0x4f37c7(0x206)](','),_0x973251=[];async function _0xc0d563(_0x2df74d){var _0x2b0ddd=_0x4f37c7;const _0x5760db=await warehouse[_0x2b0ddd(0x1ea)]([{'$match':{'name':_0x15c4c7,'room':_0x2df74d}},{'$unwind':_0x2b0ddd(0x24b)},{'$match':{'product_details.primary_code':_0x5a7a7b}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2b0ddd(0x280)},'primary_code':{'$first':_0x2b0ddd(0x1eb)},'secondary_code':{'$first':_0x2b0ddd(0x20b)},'product_code':{'$first':_0x2b0ddd(0x1f1)},'level':{'$first':_0x2b0ddd(0x306)},'isle':{'$first':_0x2b0ddd(0x249)},'type':{'$first':_0x2b0ddd(0x262)},'pallet':{'$first':_0x2b0ddd(0x1d0)},'unit':{'$first':_0x2b0ddd(0x2dc)},'secondary_unit':{'$first':_0x2b0ddd(0x2e0)},'storage':{'$first':_0x2b0ddd(0x1d2)},'rack':{'$first':_0x2b0ddd(0x1f9)},'expiry_date':{'$first':_0x2b0ddd(0x1d9)},'production_date':{'$first':_0x2b0ddd(0x2e9)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x2b0ddd(0x2e3)},'product_cat':{'$first':_0x2b0ddd(0x2c0)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x2b0ddd(0x308)},'invoice':{'$first':_0x2b0ddd(0x20a)}}}]),_0x3144d6=await warehouse[_0x2b0ddd(0x1ea)]([{'$match':{'name':_0x15c4c7,'room':_0x2df74d}},{'$unwind':_0x2b0ddd(0x24b)},{'$match':{'product_details.secondary_code':_0x5a7a7b}},{'$group':{'_id':_0x2b0ddd(0x212),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2b0ddd(0x280)},'primary_code':{'$first':_0x2b0ddd(0x1eb)},'secondary_code':{'$first':_0x2b0ddd(0x20b)},'product_code':{'$first':_0x2b0ddd(0x1f1)},'level':{'$first':_0x2b0ddd(0x306)},'isle':{'$first':_0x2b0ddd(0x249)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2b0ddd(0x1d0)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2b0ddd(0x2e0)},'storage':{'$first':_0x2b0ddd(0x1d2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2b0ddd(0x1d9)},'production_date':{'$first':_0x2b0ddd(0x2e9)},'maxPerUnit':{'$first':_0x2b0ddd(0x30a)},'batch_code':{'$first':_0x2b0ddd(0x2e3)},'product_cat':{'$first':_0x2b0ddd(0x2c0)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x2b0ddd(0x20a)}}}]);if(_0x5760db[_0x2b0ddd(0x2d4)]>0x0)_0x973251[_0x2b0ddd(0x296)](_0x5760db);else _0x3144d6[_0x2b0ddd(0x2d4)]>0x0&&_0x973251['push'](_0x3144d6);}const _0x25e9f9=_0x6cc6e2[_0x4f37c7(0x2d8)](_0x384c1f=>_0xc0d563(_0x384c1f));await Promise[_0x4f37c7(0x26b)](_0x25e9f9),_0x21fd17[_0x4f37c7(0x2cd)](_0x973251);}),router[a0_0x40155e(0x266)](a0_0x40155e(0x1ce),async(_0x227cac,_0x2503c9)=>{var _0x34003b=a0_0x40155e;const {product_code:_0x4182f2,warehouse_name:_0x300e7d,rooms_data:_0x389236,Roomslist:_0x4acbb7}=_0x227cac[_0x34003b(0x2ef)];console[_0x34003b(0x255)](_0x227cac[_0x34003b(0x2ef)]);const _0x1e5c61=_0x4acbb7[_0x34003b(0x206)](','),_0x5d84f4=[];async function _0x271f87(_0x26e95e){var _0x522475=_0x34003b;const _0x1ad0f3=await warehouse[_0x522475(0x1ea)]([{'$match':{'name':_0x300e7d,'room':_0x26e95e}},{'$unwind':'$product_details_spmx'},{'$match':{'product_details_spmx.product_code':_0x4182f2}},{'$group':{'_id':'$product_details_spmx._id','spicemix_spmx':{'$first':_0x522475(0x2f3)},'extenders_spmx':{'$first':_0x522475(0x1d8)},'curing_spmx':{'$first':'$product_details_spmx.curing_spmx'},'spicemix_spmx_qty':{'$first':_0x522475(0x2bd)},'extenders_spmx_qty':{'$first':'$product_details_spmx.extenders_spmx_qty'},'curing_spmx_qty':{'$first':_0x522475(0x2c7)},'unit_spmx':{'$first':_0x522475(0x213)},'brand_spmx':{'$first':_0x522475(0x2b4)},'category_spmx':{'$first':_0x522475(0x1fe)},'roomNamed':{'$first':_0x522475(0x308)},'invoice':{'$first':_0x522475(0x215)},'product_code_spmx':{'$first':'$product_details_spmx.product_code'}}}]);_0x5d84f4[_0x522475(0x296)](_0x1ad0f3);}const _0x2d0eca=_0x1e5c61['map'](_0x324cbf=>_0x271f87(_0x324cbf));await Promise[_0x34003b(0x26b)](_0x2d0eca),_0x2503c9[_0x34003b(0x2cd)](_0x5d84f4);}),module[a0_0x40155e(0x25e)]=router;