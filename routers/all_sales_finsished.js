function a0_0x2991(){var _0x1c1d57=['6461kikNjP','product_data','$product_details.product_code','$customer','/barcode_scanner','payment\x20successfull','Return\x20Rooms','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','product_list','Finished\x20Goods','$sale_product.type','purchases_data','aggregate','$product_details.maxPerUnit','$invoice','findById','all_sales_barcode','40472JyBLnd','$product_details.secondary_unit','room_name','barcode\x20Product\x20master','for_categorize','German','<tr>','level','unit','sale_product','post','1184990dwMVVc','$product_details.product_stock','add_sales_finished','prod_invoice','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Sales\x20Update\x20successfully','There\x27s\x20a\x20error\x20in\x20this\x20transaction','stocks_QA','prod_code','primary_code_QA','<tbody\x20style=\x22text-align:\x20center;\x22>','primary_unit','/preview/:id','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','product','secondary_unit','<strong>\x20Regards\x20</strong>','$warehouse_name','product_details','$sale_product.quantity','$product_details.batch_code','error','concat','abs','maxProducts_QA','then','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</span>','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</head><body>','<h5\x20style=\x22text-align:\x20left;\x22>','stock','4636FioUUX','</tbody>','flash','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','Error\x20Occurs','batch_code_QA','render','$product_details.rack','</body></html>','product_code_QA','/all_sales_finished/view','all_sales_finished','getMonth','$product_details','</div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$sale_product','RoomAssigned','Enclosed','name','$product_details._id','map','random','Sale\x20Return\x20Mail','Arabic','language','sales\x20item\x20return\x20successfull','prod_cat','<span\x20style=\x22float:\x20right;\x22>','/../public','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.expiry_date','gmail','Email\x20sent\x20successfully','maxPerUnit_QA','1276470EbnjbS','\x20Order\x20Number\x20:\x20','maxProducts','$return_data','currency_placement','production_date','Arabic\x20(ae)','sendMail','sales_invoice','nodemailer','../public/language/languages.json','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','length','master','json','DRY\x20GOODS','success','return_sale','product_name','save','</thead>','/view/add_sale/product','host','$room','\x20</h2>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','edit_sales_finished','True','get','French','carton','amount','redirect','max_per_unit','adjust_qty','$product_details.product_cat','English\x20(US)','site_title','274yEDyyg','customer_data','maxPerUnit','body','find','<div>','$product_details.secondary_code','barcode\x20user_id','production_date_QA','/give_payment/:id','message','Sales\x20Add\x20successfully','warehouse_name','errors','$product_details.product_name','sale_qty','837imFrTh','secondary_unit_QA','primary_code','</h5>','/view/return_sales/:id','customers','$product_details.production_date','image','$product_details.storage','unit_QA','product_stock','return_qty','Chinese','product_code','Sale\x20Return','due_amount','<hr\x20class=\x22my-3\x22>','2082vCfMUK','room','password','customer','product_date','$name','filter','$product_details.unit','Portuguese\x20(BR)','log','/upload/','OUTF-','express','$product_details.primary_code','role','$product_details.floorlevel','Sale\x20Product\x20Mail','sales_quantity_QA','Router','3120kWsAMx','date','expiry_date','Hindi','user','Logo.png','Spanish','toString','email','findOne','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$finalize','<h5>','secondary_code','Portuguese','$sale_product.bin','quantity','currency','batch_code','return_sale_QA','750156KUQnEP','$product_details.bay','forEach','stock_data','customers_docs','push','/view/:id','$product','status','$product.product_name','$sale_product.bay','$customers_docs','all','catch','/invoice/:id','<html><head><title></title>','$sale_product.floorlevel','string','Quality\x20Inspection','getFullYear','$product_details.type','invoice','product_name_QA1','final','/view/add_sales/:id','Ambient','secondary_code_QA','slice','exports','/all_sales_finished/preview/','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','</tr>','back','getDate','$note','/view/add_sales','Enabled','logo','params','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','bay','$product_details.bin','return_sale_finished','createTransport','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','\x20Order\x20Date\x20:\x20','QA\x20Warehouse','../models/all_models','An\x20error\x20occurred\x20while\x20saving\x20data.','expiry_date_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','add\x20post','return_data','return_qty_QA','split','received_amount','5182NaeXaK','<h2>\x20','suppliers','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</table>','foreach\x20newproduct','/picking_list/pdf/','An\x20error\x20occurred.'];a0_0x2991=function(){return _0x1c1d57;};return a0_0x2991();}var a0_0x2261e5=a0_0x43f8;function a0_0x43f8(_0x449a1e,_0x56452e){var _0x299134=a0_0x2991();return a0_0x43f8=function(_0x43f8a4,_0x2e7983){_0x43f8a4=_0x43f8a4-0x1ba;var _0x530f76=_0x299134[_0x43f8a4];return _0x530f76;},a0_0x43f8(_0x449a1e,_0x56452e);}(function(_0x21607c,_0x2aab00){var _0x4b3e99=a0_0x43f8,_0x585108=_0x21607c();while(!![]){try{var _0x41b67f=parseInt(_0x4b3e99(0x21c))/0x1*(parseInt(_0x4b3e99(0x2af))/0x2)+-parseInt(_0x4b3e99(0x1bd))/0x3*(-parseInt(_0x4b3e99(0x262))/0x4)+-parseInt(_0x4b3e99(0x288))/0x5+parseInt(_0x4b3e99(0x1d0))/0x6*(-parseInt(_0x4b3e99(0x225))/0x7)+parseInt(_0x4b3e99(0x236))/0x8*(-parseInt(_0x4b3e99(0x2bf))/0x9)+parseInt(_0x4b3e99(0x241))/0xa+parseInt(_0x4b3e99(0x1e4))/0xb;if(_0x41b67f===_0x2aab00)break;else _0x585108['push'](_0x585108['shift']());}catch(_0x294e95){_0x585108['push'](_0x585108['shift']());}}}(a0_0x2991,0x78e82));const express=require(a0_0x2261e5(0x1c9)),app=express(),router=express[a0_0x2261e5(0x1cf)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x2261e5(0x213)),auth=require('../middleware/auth'),nodemailer=require(a0_0x2261e5(0x291)),users=require(a0_0x2261e5(0x292));router[a0_0x2261e5(0x2a5)]('/view',auth,async(_0xb16792,_0x93b3c6)=>{var _0x7743e9=a0_0x2261e5;try{const {username:_0x3fcc52,email:_0x51465e,role:_0x5003b9}=_0xb16792[_0x7743e9(0x1d4)],_0x51af35=_0xb16792['user'],_0x20041b=await profile[_0x7743e9(0x1d9)]({'email':_0x51af35[_0x7743e9(0x1d8)]}),_0x3b2c29=await master_shop['find']();let _0xf18f4b;if(_0x51af35[_0x7743e9(0x1cb)]==_0x7743e9(0x21f)){const _0x3bc8da=await staff[_0x7743e9(0x1d9)]({'email':_0x51af35[_0x7743e9(0x1d8)]});_0xf18f4b=await sales_finished[_0x7743e9(0x231)]([{'$lookup':{'from':_0x7743e9(0x2c4),'localField':'customer','foreignField':_0x7743e9(0x276),'as':_0x7743e9(0x1e8)}},{'$unwind':_0x7743e9(0x1ef)},{'$unwind':_0x7743e9(0x273)},{'$group':{'_id':'$_id','invoice':{'$first':_0x7743e9(0x233)},'customers':{'$first':_0x7743e9(0x228)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x7743e9(0x252)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x7743e9(0x206)},'return_data':{'$first':_0x7743e9(0x28b)},'customers_docs':{'$first':_0x7743e9(0x1ef)},'total_saleproduct_quantity':{'$sum':_0x7743e9(0x254)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x7743e9(0x1df)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x7743e9(0x1f4)},'finalize':{'$first':_0x7743e9(0x1db)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0xf18f4b=await sales_finished[_0x7743e9(0x231)]([{'$lookup':{'from':_0x7743e9(0x2c4),'localField':'customer','foreignField':_0x7743e9(0x276),'as':_0x7743e9(0x1e8)}},{'$unwind':'$customers_docs'},{'$unwind':_0x7743e9(0x273)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':_0x7743e9(0x228)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x7743e9(0x273)},'note':{'$first':_0x7743e9(0x206)},'return_data':{'$first':_0x7743e9(0x28b)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x7743e9(0x254)},'level':{'$addToSet':_0x7743e9(0x1ee)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x7743e9(0x22f)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x7743e9(0x1db)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x3b2c29[0x0][_0x7743e9(0x27c)]==_0x7743e9(0x2ad)){var _0x32d8d5=users[_0x7743e9(0x293)];console[_0x7743e9(0x1c6)](_0x32d8d5);}else{if(_0x3b2c29[0x0]['language']=='Hindi')var _0x32d8d5=users[_0x7743e9(0x1d3)];else{if(_0x3b2c29[0x0]['language']==_0x7743e9(0x23b))var _0x32d8d5=users[_0x7743e9(0x23b)];else{if(_0x3b2c29[0x0][_0x7743e9(0x27c)]=='Spanish')var _0x32d8d5=users['Spanish'];else{if(_0x3b2c29[0x0]['language']=='French')var _0x32d8d5=users['French'];else{if(_0x3b2c29[0x0]['language']=='Portuguese\x20(BR)')var _0x32d8d5=users[_0x7743e9(0x1de)];else{if(_0x3b2c29[0x0][_0x7743e9(0x27c)]==_0x7743e9(0x2cb))var _0x32d8d5=users['Chinese'];else{if(_0x3b2c29[0x0][_0x7743e9(0x27c)]=='Arabic\x20(ae)')var _0x32d8d5=users['Arabic'];}}}}}}}_0x93b3c6[_0x7743e9(0x269)](_0x7743e9(0x26e),{'success':_0xb16792[_0x7743e9(0x264)](_0x7743e9(0x299)),'errors':_0xb16792[_0x7743e9(0x264)]('errors'),'sales':_0xf18f4b,'profile':_0x20041b,'role':_0x51af35,'master_shop':_0x3b2c29,'language':_0x32d8d5});}catch(_0x47f1db){console['log'](_0x47f1db);}});async function getRandom8DigitNumber(){var _0x583639=a0_0x2261e5;const _0x9d3a50=0x989680,_0x22ca8e=0x5f5e0ff,_0x16b288=Math['floor'](Math[_0x583639(0x279)]()*(_0x22ca8e-_0x9d3a50+0x1))+_0x9d3a50;var _0x261b8f;const _0x29a2c9=await sales_finished[_0x583639(0x1d9)]({'invoice':_0x583639(0x1c8)+_0x16b288});return _0x29a2c9&&_0x29a2c9['length']>0x0?_0x261b8f=_0x583639(0x1c8)+_0x16b288:_0x261b8f='OUTF-'+_0x16b288,_0x261b8f;}router[a0_0x2261e5(0x2a5)](a0_0x2261e5(0x207),auth,async(_0xd42471,_0x14ac8c)=>{var _0x3345b3=a0_0x2261e5;try{const {username:_0x5eb4d7,email:_0x97b0b9,role:_0x51204b}=_0xd42471[_0x3345b3(0x1d4)],_0x4c0176=_0xd42471[_0x3345b3(0x1d4)],_0x3a8825=await profile[_0x3345b3(0x1d9)]({'email':_0x4c0176[_0x3345b3(0x1d8)]}),_0x36edbb=await master_shop['find'](),_0x40db7b=await customer['find']({});let _0x9af9a8;if(_0x4c0176['role']==_0x3345b3(0x21f)){const _0x48a117=await staff['findOne']({'email':_0x4c0176[_0x3345b3(0x1d8)]});_0x9af9a8=await warehouse[_0x3345b3(0x231)]([{'$match':{'status':_0x3345b3(0x208),'name':_0x48a117['warehouse'],'warehouse_category':_0x3345b3(0x22e),'name':{'$ne':_0x3345b3(0x212)}}},{'$group':{'_id':_0x3345b3(0x1c2),'name':{'$first':_0x3345b3(0x1c2)}}},{'$sort':{'name':0x1}}]);}else _0x9af9a8=await warehouse[_0x3345b3(0x231)]([{'$match':{'status':_0x3345b3(0x208),'warehouse_category':_0x3345b3(0x22e),'name':{'$ne':_0x3345b3(0x212)}}},{'$group':{'_id':_0x3345b3(0x1c2),'name':{'$first':_0x3345b3(0x1c2)}}},{'$sort':{'name':0x1}}]);const _0x39a140=await product[_0x3345b3(0x2b3)]({});var _0x158b12=[_0x3345b3(0x1fd),_0x3345b3(0x275)];const _0x305788=await sales_finished[_0x3345b3(0x2b3)]({}),_0x1fd4ad=_0x305788[_0x3345b3(0x295)]+0x1,_0x5e6e36=_0x3345b3(0x1c8)+_0x1fd4ad[_0x3345b3(0x1d7)]()['padStart'](0x5,'0');if(_0x36edbb[0x0][_0x3345b3(0x27c)]==_0x3345b3(0x2ad)){var _0x4e5e1f=users[_0x3345b3(0x293)];console[_0x3345b3(0x1c6)](_0x4e5e1f);}else{if(_0x36edbb[0x0][_0x3345b3(0x27c)]=='Hindi')var _0x4e5e1f=users['Hindi'];else{if(_0x36edbb[0x0][_0x3345b3(0x27c)]==_0x3345b3(0x23b))var _0x4e5e1f=users[_0x3345b3(0x23b)];else{if(_0x36edbb[0x0]['language']==_0x3345b3(0x1d6))var _0x4e5e1f=users[_0x3345b3(0x1d6)];else{if(_0x36edbb[0x0]['language']==_0x3345b3(0x2a6))var _0x4e5e1f=users['French'];else{if(_0x36edbb[0x0][_0x3345b3(0x27c)]=='Portuguese\x20(BR)')var _0x4e5e1f=users['Portuguese'];else{if(_0x36edbb[0x0][_0x3345b3(0x27c)]==_0x3345b3(0x2cb))var _0x4e5e1f=users[_0x3345b3(0x2cb)];else{if(_0x36edbb[0x0][_0x3345b3(0x27c)]==_0x3345b3(0x28e))var _0x4e5e1f=users[_0x3345b3(0x27b)];}}}}}}}const _0x27ae52=getRandom8DigitNumber();_0x27ae52[_0x3345b3(0x25a)](_0x17bf42=>{var _0x28d330=_0x3345b3;_0x14ac8c[_0x28d330(0x269)](_0x28d330(0x243),{'success':_0xd42471['flash'](_0x28d330(0x299)),'errors':_0xd42471[_0x28d330(0x264)](_0x28d330(0x2bc)),'role':_0x4c0176,'profile':_0x3a8825,'customer':_0x40db7b,'warehouse':_0x9af9a8,'product':_0x39a140,'invoice':_0x17bf42,'master_shop':_0x36edbb,'language':_0x4e5e1f,'rooms_data':_0x158b12});})[_0x3345b3(0x1f1)](_0xd79eb0=>{var _0x2fa8c3=_0x3345b3;_0xd42471[_0x2fa8c3(0x264)](_0x2fa8c3(0x2bc),_0x2fa8c3(0x247)),_0x14ac8c['redirect'](_0x2fa8c3(0x26d));});}catch(_0x32cfb3){console['log'](_0x32cfb3);}}),router[a0_0x2261e5(0x2a5)](a0_0x2261e5(0x1fc),auth,async(_0x17deeb,_0x2b14e7)=>{var _0x156c1c=a0_0x2261e5;try{const _0x21ca7b=_0x17deeb[_0x156c1c(0x20a)]['id'];console[_0x156c1c(0x1c6)](_0x21ca7b);const _0x1c9ec5=await product[_0x156c1c(0x2b3)](),_0x16301a=await purchases[_0x156c1c(0x231)]([{'$match':{'warehouse_name':_0x21ca7b}},{'$unwind':_0x156c1c(0x1eb)},{'$group':{'_id':_0x156c1c(0x1ed)}}]);console[_0x156c1c(0x1c6)](_0x156c1c(0x230),_0x16301a),_0x2b14e7[_0x156c1c(0x1ec)](0xc8)[_0x156c1c(0x297)]({'purchases_data':_0x16301a,'product_data':_0x1c9ec5});}catch(_0x1ae299){console[_0x156c1c(0x1c6)](_0x1ae299);}}),router[a0_0x2261e5(0x240)](a0_0x2261e5(0x29e),auth,async(_0x270a11,_0x3db5b6)=>{var _0x4f2e1e=a0_0x2261e5;try{const {warehouse_data:_0x483696,product_data:_0x39d67e}=_0x270a11[_0x4f2e1e(0x2b2)];console['log'](_0x270a11[_0x4f2e1e(0x2b2)][_0x4f2e1e(0x226)]);;const _0xfecab7=await master_shop[_0x4f2e1e(0x2b3)]();console['log'](_0x4f2e1e(0x296),_0xfecab7);const _0x30e6bc=await product[_0x4f2e1e(0x1d9)]({'name':_0x39d67e});console[_0x4f2e1e(0x1c6)](_0x4f2e1e(0x24f),_0x30e6bc);const _0x5d01b8=await warehouse['aggregate']([{'$match':{'name':_0x483696}},{'$unwind':_0x4f2e1e(0x270)},{'$match':{'product_details.product_name':_0x39d67e}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x4f2e1e(0x242)}}}]);console[_0x4f2e1e(0x1c6)](_0x4f2e1e(0x1e7),_0x5d01b8),_0x3db5b6[_0x4f2e1e(0x1ec)](0xc8)[_0x4f2e1e(0x297)]({'master':_0xfecab7,'new_product':_0x30e6bc,'stock_data':_0x5d01b8});}catch(_0x48fb54){console[_0x4f2e1e(0x1c6)](_0x48fb54);}}),router[a0_0x2261e5(0x240)](a0_0x2261e5(0x207),auth,async(_0x76663b,_0x4d07e5)=>{var _0x2b72c1=a0_0x2261e5;try{const {invoice:_0x32a0a7,date:_0x46d7bc,warehouse_name:_0x1c549c,product_name:_0x4beb92,stock:_0x24120e,quantity:_0x25770e,note:_0x2d625c,room:_0x257247,primary_code:_0x311876,secondary_code:_0xf6b7b7,prod_code:_0x11f813,level:_0x3ce3f4,isle:_0x4e55da,pallet:_0x31d19f,batch_code:_0xb338d8,SCRN:_0x2141dd,expiry_date:_0x2c065a,mode_transpo:_0x3f6602,name_driver:_0x39960c}=_0x76663b[_0x2b72c1(0x2b2)];if(typeof _0x4beb92==_0x2b72c1(0x1f5))var _0x7b34d6=[_0x76663b['body'][_0x2b72c1(0x29b)]],_0x560e01=[_0x76663b[_0x2b72c1(0x2b2)]['stock']],_0x85af34=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x2a7)]],_0x28096a=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x2c1)]],_0x50ca87=[_0x76663b['body'][_0x2b72c1(0x1dd)]],_0x472dc7=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x249)]],_0x17da63=[_0x76663b[_0x2b72c1(0x2b2)]['level']],_0x759353=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x24c)]],_0x4c685f=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x250)]],_0xf48e41=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x1e2)]],_0x384d88=[_0x76663b[_0x2b72c1(0x2b2)]['expiry_date']],_0x2aceb=[_0x76663b['body'][_0x2b72c1(0x1c1)]],_0x2700c3=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x2aa)]],_0x44f9f1=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x27e)]],_0x5977c8=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x274)]],_0x1209d3=[_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x244)]];else var _0x7b34d6=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x29b)]],_0x560e01=[..._0x76663b['body'][_0x2b72c1(0x261)]],_0x85af34=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x2a7)]],_0x28096a=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x2c1)]],_0x50ca87=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x1dd)]],_0x472dc7=[..._0x76663b[_0x2b72c1(0x2b2)]['prod_code']],_0x17da63=[..._0x76663b['body']['level']],_0x759353=[..._0x76663b['body'][_0x2b72c1(0x24c)]],_0x4c685f=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x250)]],_0xf48e41=[..._0x76663b['body']['batch_code']],_0x384d88=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x1d2)]],_0x2aceb=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x1c1)]],_0x2700c3=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x2aa)]],_0x44f9f1=[..._0x76663b['body'][_0x2b72c1(0x27e)]],_0x5977c8=[..._0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x274)]],_0x1209d3=[..._0x76663b['body'][_0x2b72c1(0x244)]];const _0x4236fc=_0x7b34d6[_0x2b72c1(0x278)](_0x4858e5=>{return _0x4858e5={'product_name':_0x4858e5};});_0x560e01[_0x2b72c1(0x1e6)]((_0x499592,_0x4e3035)=>{_0x4236fc[_0x4e3035]['stock']=_0x499592;}),_0x85af34['forEach']((_0x19608d,_0x4f6a33)=>{var _0x310037=_0x2b72c1;_0x4236fc[_0x4f6a33][_0x310037(0x1e0)]=Math['abs'](_0x19608d);}),_0x28096a['forEach']((_0x162386,_0x244bd8)=>{_0x4236fc[_0x244bd8]['primary_code']=_0x162386;}),_0x50ca87['forEach']((_0x25fab8,_0x231867)=>{var _0x284102=_0x2b72c1;_0x4236fc[_0x231867][_0x284102(0x1dd)]=_0x25fab8;}),_0x472dc7[_0x2b72c1(0x1e6)]((_0x3e2bd0,_0x18f8f0)=>{var _0xe44cad=_0x2b72c1;_0x4236fc[_0x18f8f0][_0xe44cad(0x2cc)]=_0x3e2bd0;}),_0x17da63[_0x2b72c1(0x1e6)]((_0x599075,_0x13e703)=>{_0x4236fc[_0x13e703]['bay']=_0x599075;}),_0x759353['forEach']((_0x3c5e80,_0x11b39d)=>{_0x4236fc[_0x11b39d]['unit']=_0x3c5e80;}),_0x4c685f[_0x2b72c1(0x1e6)]((_0x803cf,_0x4b86af)=>{var _0x3fc6a4=_0x2b72c1;_0x4236fc[_0x4b86af][_0x3fc6a4(0x250)]=_0x803cf;}),_0xf48e41['forEach']((_0x161467,_0x412def)=>{var _0x658cb=_0x2b72c1;_0x4236fc[_0x412def][_0x658cb(0x1e2)]=_0x161467;}),_0x384d88[_0x2b72c1(0x1e6)]((_0x5b2039,_0x39b2fc)=>{var _0x2c24f3=_0x2b72c1;_0x4236fc[_0x39b2fc][_0x2c24f3(0x1d2)]=_0x5b2039;}),_0x2aceb['forEach']((_0x31444c,_0x2a4660)=>{var _0x4a39c9=_0x2b72c1;_0x4236fc[_0x2a4660][_0x4a39c9(0x28d)]=_0x31444c;}),_0x2700c3[_0x2b72c1(0x1e6)]((_0x2bc2ca,_0x49f8e8)=>{_0x4236fc[_0x49f8e8]['maxperunit']=_0x2bc2ca;}),_0x44f9f1[_0x2b72c1(0x1e6)]((_0x57349b,_0x2f9fc7)=>{var _0x50de7b=_0x2b72c1;_0x4236fc[_0x2f9fc7][_0x50de7b(0x27e)]=_0x57349b;}),_0x5977c8[_0x2b72c1(0x1e6)]((_0x136ba8,_0x1a1645)=>{_0x4236fc[_0x1a1645]['room_name']=_0x136ba8;}),_0x1209d3['forEach']((_0x5b3e30,_0x4015fc)=>{var _0x251ba8=_0x2b72c1;_0x4236fc[_0x4015fc][_0x251ba8(0x1f9)]=_0x5b3e30;});var _0x374fbc=0x0;_0x4236fc[_0x2b72c1(0x1e6)](_0x4cbd7e=>{var _0x1709ee=_0x2b72c1;parseFloat(_0x4cbd7e[_0x1709ee(0x261)])<parseFloat(_0x4cbd7e[_0x1709ee(0x1e0)])&&parseFloat(_0x4cbd7e[_0x1709ee(0x1e0)])>parseFloat(_0x4cbd7e[_0x1709ee(0x261)])&&(console['log'](_0x4cbd7e[_0x1709ee(0x261)]+'\x20<>\x20'+_0x4cbd7e[_0x1709ee(0x1e0)]),_0x374fbc++);});if(_0x374fbc!=0x0)return _0x76663b[_0x2b72c1(0x264)](_0x2b72c1(0x2bc),_0x2b72c1(0x210)),_0x4d07e5[_0x2b72c1(0x2a9)]('back');const _0x4e3586=_0x4236fc[_0x2b72c1(0x1c3)](_0x41ebf9=>_0x41ebf9['quantity']!=='0'&&_0x41ebf9[_0x2b72c1(0x1e0)]!==''),_0x3e5eeb=new sales_finished({'invoice':_0x32a0a7,'customer':_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x1c0)],'date':_0x46d7bc,'warehouse_name':_0x1c549c,'sale_product':_0x4e3586,'note':_0x2d625c,'room':_0x257247,'primary_code':_0x311876,'secondary_code':_0xf6b7b7,'prod_code':_0x11f813,'SCRN':_0x2141dd,'finalize':'False','mode_transpo':_0x3f6602,'name_driver':_0x39960c}),_0x13e119=await _0x3e5eeb[_0x2b72c1(0x29c)](),_0x4276af=await sales_finished['findOne']({'invoice':_0x32a0a7}),_0x31f7ee=new c_payment_data({'invoice':_0x32a0a7,'customer':_0x76663b[_0x2b72c1(0x2b2)][_0x2b72c1(0x1c0)],'reason':'Sale'});await _0x31f7ee[_0x2b72c1(0x29c)]();const _0x4c3b23=await master_shop[_0x2b72c1(0x2b3)](),_0x1d4540=await email_settings[_0x2b72c1(0x1d9)](),_0x2a978e=await customer['findOne']({'name':_0x76663b['body'][_0x2b72c1(0x1c0)]});_0x4c3b23[0x0][_0x2b72c1(0x28c)]==0x1?(right_currency=_0x4c3b23[0x0][_0x2b72c1(0x1e1)],left_currency=''):(right_currency='',left_currency=_0x4c3b23[0x0][_0x2b72c1(0x1e1)]);var _0x29aa46=_0x7b34d6,_0x4459fa=_0x85af34,_0x37fc28='',_0x45fe86;for(_0x45fe86 in _0x29aa46){_0x37fc28+='<tr>'+_0x2b72c1(0x283)+_0x29aa46[_0x45fe86]+_0x2b72c1(0x281)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4459fa[_0x45fe86]+_0x2b72c1(0x281)+_0x2b72c1(0x203);}console[_0x2b72c1(0x1c6)](_0x2b72c1(0x22d),_0x37fc28);let _0x40c553=nodemailer[_0x2b72c1(0x20f)]({'service':'gmail','auth':{'user':_0x1d4540[_0x2b72c1(0x1d8)],'pass':_0x1d4540['password']}}),_0x43e6e4={'from':_0x1d4540[_0x2b72c1(0x1d8)],'to':_0x2a978e[_0x2b72c1(0x1d8)],'subject':_0x2b72c1(0x1cd),'attachments':[{'filename':_0x2b72c1(0x1d5),'path':__dirname+_0x2b72c1(0x280)+_0x2b72c1(0x1c7)+_0x4c3b23[0x0]['image'],'cid':_0x2b72c1(0x209)}],'html':_0x2b72c1(0x265)+_0x2b72c1(0x1f3)+_0x2b72c1(0x25f)+_0x2b72c1(0x2b4)+_0x2b72c1(0x25b)+'<div>'+_0x2b72c1(0x202)+'</div>'+_0x2b72c1(0x2b4)+_0x2b72c1(0x21d)+_0x4c3b23[0x0][_0x2b72c1(0x2ae)]+'\x20</h2>'+_0x2b72c1(0x271)+_0x2b72c1(0x271)+_0x2b72c1(0x1bc)+_0x2b72c1(0x2b4)+_0x2b72c1(0x260)+'\x20Order\x20Number\x20:\x20'+_0x32a0a7+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x2b72c1(0x211)+_0x46d7bc+'\x20'+'</span>'+_0x2b72c1(0x2c2)+'</div>'+_0x2b72c1(0x245)+_0x2b72c1(0x1da)+_0x2b72c1(0x23c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>'+_0x2b72c1(0x203)+_0x2b72c1(0x29d)+_0x2b72c1(0x24b)+'\x20'+_0x37fc28+'\x20'+_0x2b72c1(0x263)+'</table>'+_0x2b72c1(0x2b4)+_0x2b72c1(0x251)+_0x2b72c1(0x1dc)+_0x4c3b23[0x0]['site_title']+_0x2b72c1(0x2c2)+_0x2b72c1(0x271)+_0x2b72c1(0x271)+_0x2b72c1(0x26b)};_0x40c553[_0x2b72c1(0x28f)](_0x43e6e4,function(_0x181b89,_0x49ebce){var _0x3100b7=_0x2b72c1;_0x181b89?(console['log'](_0x181b89),console[_0x3100b7(0x1c6)](_0x3100b7(0x267))):console['log'](_0x3100b7(0x286));}),_0x76663b[_0x2b72c1(0x264)](_0x2b72c1(0x299),_0x2b72c1(0x2ba)),_0x4d07e5[_0x2b72c1(0x2a9)](_0x2b72c1(0x201)+_0x13e119['_id']);}catch(_0x5a6616){console[_0x2b72c1(0x1c6)](_0x5a6616);}}),router[a0_0x2261e5(0x2a5)](a0_0x2261e5(0x24d),auth,async(_0x23ecbe,_0xa1026c)=>{var _0x1b90fe=a0_0x2261e5;try{const {username:_0x278c78,email:_0x57e7c7,role:_0x331a00}=_0x23ecbe[_0x1b90fe(0x1d4)],_0xdbfbba=_0x23ecbe[_0x1b90fe(0x1d4)],_0xdb72e0=await profile[_0x1b90fe(0x1d9)]({'email':_0xdbfbba['email']}),_0x50ff2d=await master_shop[_0x1b90fe(0x2b3)](),_0x4bf8ad=_0x23ecbe[_0x1b90fe(0x20a)]['id'],_0x33051c=await sales_finished[_0x1b90fe(0x234)](_0x4bf8ad),_0x3f07f1=await warehouse['aggregate']([{'$match':{'name':_0x33051c[_0x1b90fe(0x2bb)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1b90fe(0x277),'name':{'$first':_0x1b90fe(0x2bd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1b90fe(0x20d)},'type':{'$first':_0x1b90fe(0x1f8)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1b90fe(0x1ca)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1b90fe(0x227)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1b90fe(0x26a)},'expiry_date':{'$first':_0x1b90fe(0x284)},'production_date':{'$first':_0x1b90fe(0x2c5)},'batch_code':{'$first':_0x1b90fe(0x255)},'room':{'$first':'$room'}}}]),_0x11f763=await customer[_0x1b90fe(0x2b3)]({});let _0x5ab946;if(_0xdbfbba['role']=='staff'){const _0x427717=await staff['findOne']({'email':_0xdbfbba[_0x1b90fe(0x1d8)]});_0x5ab946=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x427717['warehouse']}},{'$group':{'_id':_0x1b90fe(0x1c2),'name':{'$first':_0x1b90fe(0x1c2)}}}]);}else _0x5ab946=await warehouse[_0x1b90fe(0x231)]([{'$match':{'status':_0x1b90fe(0x208)}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x1c4df4=await product[_0x1b90fe(0x2b3)]({});if(_0x50ff2d[0x0][_0x1b90fe(0x27c)]==_0x1b90fe(0x2ad)){var _0x252909=users[_0x1b90fe(0x293)];console[_0x1b90fe(0x1c6)](_0x252909);}else{if(_0x50ff2d[0x0][_0x1b90fe(0x27c)]==_0x1b90fe(0x1d3))var _0x252909=users[_0x1b90fe(0x1d3)];else{if(_0x50ff2d[0x0][_0x1b90fe(0x27c)]==_0x1b90fe(0x23b))var _0x252909=users[_0x1b90fe(0x23b)];else{if(_0x50ff2d[0x0]['language']==_0x1b90fe(0x1d6))var _0x252909=users[_0x1b90fe(0x1d6)];else{if(_0x50ff2d[0x0][_0x1b90fe(0x27c)]==_0x1b90fe(0x2a6))var _0x252909=users[_0x1b90fe(0x2a6)];else{if(_0x50ff2d[0x0][_0x1b90fe(0x27c)]==_0x1b90fe(0x1c5))var _0x252909=users[_0x1b90fe(0x1de)];else{if(_0x50ff2d[0x0][_0x1b90fe(0x27c)]==_0x1b90fe(0x2cb))var _0x252909=users['Chinese'];else{if(_0x50ff2d[0x0]['language']=='Arabic\x20(ae)')var _0x252909=users['Arabic'];}}}}}}}_0xa1026c[_0x1b90fe(0x269)]('edit_sales_finished_view',{'success':_0x23ecbe[_0x1b90fe(0x264)](_0x1b90fe(0x299)),'errors':_0x23ecbe[_0x1b90fe(0x264)](_0x1b90fe(0x2bc)),'role':_0xdbfbba,'profile':_0xdb72e0,'customer':_0x11f763,'warehouse':_0x5ab946,'product':_0x3f07f1,'user':_0x33051c,'master_shop':_0x50ff2d,'unit':_0x1c4df4,'language':_0x252909});}catch(_0x19ba9e){console[_0x1b90fe(0x1c6)](_0x19ba9e);}}),router[a0_0x2261e5(0x240)](a0_0x2261e5(0x24d),auth,async(_0x40bacd,_0x5c6639)=>{var _0x5b2a8f=a0_0x2261e5;try{const _0x469a6a=_0x40bacd[_0x5b2a8f(0x20a)]['id'],{invoice:_0x33e00b,warehouse_name:_0x4478a7,room:_0x4c7ee5}=_0x40bacd['body'],_0x4d7a9c=await sales_finished[_0x5b2a8f(0x1d9)]({'invoice':_0x33e00b}),_0x3246fa=_0x4d7a9c['sale_product'][_0x5b2a8f(0x278)](async _0x1720b5=>{var _0x543a98=_0x5b2a8f,_0x49abba=await warehouse[_0x543a98(0x1d9)]({'name':_0x4478a7,'room':_0x1720b5[_0x543a98(0x238)],'warehouse_category':_0x543a98(0x22e)});const _0xbbf543=_0x49abba['product_details'][_0x543a98(0x278)](_0x88fbd1=>{var _0x7af626=_0x543a98;_0x88fbd1['product_name']==_0x1720b5[_0x7af626(0x29b)]&&_0x88fbd1[_0x7af626(0x20c)]==_0x1720b5['bay']&&_0x88fbd1[_0x7af626(0x1d2)]==_0x1720b5['expiry_date']&&_0x88fbd1[_0x7af626(0x28d)]==_0x1720b5[_0x7af626(0x28d)]&&_0x88fbd1[_0x7af626(0x1e2)]==_0x1720b5[_0x7af626(0x1e2)]&&_0x88fbd1[_0x7af626(0x1f9)]==_0x1720b5['invoice']&&(_0x88fbd1[_0x7af626(0x2c9)]=Math[_0x7af626(0x258)](_0x88fbd1[_0x7af626(0x2c9)])-Math['abs'](_0x1720b5['quantity']));});return _0x49abba;});Promise[_0x5b2a8f(0x1f0)](_0x3246fa)[_0x5b2a8f(0x25a)](async _0x3a0e44=>{var _0x204425=_0x5b2a8f;try{for(const _0x5dfa16 of _0x3a0e44){await _0x5dfa16[_0x204425(0x29c)]();}_0x4d7a9c['finalize']=_0x204425(0x2a4);const _0xdfacaf=await _0x4d7a9c[_0x204425(0x29c)](),_0x3e6be0=await master_shop['find'](),_0x3153ba=await email_settings['findOne'](),_0x47fdf8=await supervisor_settings[_0x204425(0x2b3)]();var _0x1b669e=_0x4d7a9c[_0x204425(0x23f)],_0x45c43a='',_0x455e05;for(_0x455e05 in _0x1b669e){var _0x3246fc='FG';_0x4d7a9c[_0x204425(0x2bb)]==_0x204425(0x298)&&(_0x3246fc='DG'),_0x45c43a+=_0x204425(0x23c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1b669e[_0x455e05]['product_name']+_0x204425(0x281)+_0x204425(0x283)+_0x1b669e[_0x455e05][_0x204425(0x2cc)]+_0x204425(0x281)+_0x204425(0x283)+_0x1b669e[_0x455e05][_0x204425(0x1e0)]+_0x204425(0x281)+_0x204425(0x283)+_0x1b669e[_0x455e05]['unit']+_0x204425(0x281)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1b669e[_0x455e05]['secondary_unit']+_0x204425(0x281)+_0x204425(0x283)+_0x4d7a9c[_0x204425(0x2bb)]+'</td>'+_0x204425(0x283)+_0x1b669e[_0x455e05][_0x204425(0x238)]+_0x204425(0x281)+_0x204425(0x283)+_0x3246fc+_0x1b669e[_0x455e05][_0x204425(0x20c)]+_0x204425(0x281);}let _0x5daf4a=nodemailer[_0x204425(0x20f)]({'host':_0x3153ba[_0x204425(0x29f)],'port':Number(_0x3153ba['port']),'secure':![],'auth':{'user':_0x3153ba[_0x204425(0x1d8)],'pass':_0x3153ba[_0x204425(0x1bf)]}}),_0x48bbb4={'from':_0x3153ba[_0x204425(0x1d8)],'to':_0x47fdf8[0x0]['FGSEmail'],'subject':'Sales\x20Mail','attachments':[{'filename':_0x204425(0x1d5),'path':__dirname+_0x204425(0x280)+_0x204425(0x1c7)+_0x3e6be0[0x0][_0x204425(0x2c6)],'cid':_0x204425(0x209)}],'html':_0x204425(0x265)+_0x204425(0x1f3)+'</head><body>'+_0x204425(0x2b4)+_0x204425(0x25b)+'<div>'+_0x204425(0x202)+_0x204425(0x271)+_0x204425(0x2b4)+_0x204425(0x21d)+_0x3e6be0[0x0][_0x204425(0x2ae)]+_0x204425(0x2a1)+_0x204425(0x271)+'</div>'+_0x204425(0x1bc)+'<div>'+_0x204425(0x260)+'\x20Order\x20Number\x20:\x20'+_0x4d7a9c[_0x204425(0x1f9)]+'\x20'+_0x204425(0x27f)+_0x204425(0x211)+_0x4d7a9c[_0x204425(0x1d1)]+'\x20'+_0x204425(0x25c)+_0x204425(0x2c2)+_0x204425(0x271)+_0x204425(0x245)+_0x204425(0x1da)+_0x204425(0x23c)+_0x204425(0x216)+_0x204425(0x25e)+_0x204425(0x22c)+_0x204425(0x294)+_0x204425(0x220)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x204425(0x282)+_0x204425(0x272)+_0x204425(0x203)+_0x204425(0x29d)+_0x204425(0x24b)+'\x20'+_0x45c43a+'\x20'+_0x204425(0x263)+_0x204425(0x221)+'<div>'+_0x204425(0x251)+'<h5>'+_0x3e6be0[0x0][_0x204425(0x2ae)]+_0x204425(0x2c2)+_0x204425(0x271)+'</div>'+_0x204425(0x26b)};_0x5daf4a['sendMail'](_0x48bbb4,function(_0x5416dd,_0x285198){var _0x1ec49f=_0x204425;_0x5416dd?(console[_0x1ec49f(0x1c6)](_0x5416dd),console[_0x1ec49f(0x1c6)](_0x1ec49f(0x267))):console[_0x1ec49f(0x1c6)]('Email\x20sent\x20successfully');}),_0x40bacd[_0x204425(0x264)](_0x204425(0x299),'Sales\x20Update\x20successfully'),_0x5c6639[_0x204425(0x2a9)](_0x204425(0x223)+_0x469a6a);}catch(_0x5cb065){console[_0x204425(0x256)](_0x5cb065),_0x5c6639[_0x204425(0x1ec)](0x1f4)['json']({'error':_0x204425(0x214)});}})[_0x5b2a8f(0x1f1)](_0x124b0b=>{var _0x3680fb=_0x5b2a8f;console['error'](_0x124b0b),_0x5c6639[_0x3680fb(0x1ec)](0x1f4)[_0x3680fb(0x297)]({'error':_0x3680fb(0x224)});});}catch(_0x595765){console['log'](_0x595765);}}),router[a0_0x2261e5(0x2a5)](a0_0x2261e5(0x1ea),auth,async(_0x4903ea,_0x1edc76)=>{var _0x2827fb=a0_0x2261e5;try{const {username:_0x3468fb,email:_0x15b9ec,role:_0x315250}=_0x4903ea[_0x2827fb(0x1d4)],_0x2a1684=_0x4903ea['user'],_0x260929=await profile[_0x2827fb(0x1d9)]({'email':_0x2a1684[_0x2827fb(0x1d8)]}),_0x4e4f1a=await master_shop[_0x2827fb(0x2b3)](),_0x2fcef4=_0x4903ea[_0x2827fb(0x20a)]['id'],_0x132480=await sales_finished[_0x2827fb(0x234)](_0x2fcef4);let _0x580222=new Date(_0x132480[_0x2827fb(0x1d2)]),_0x56842c=('0'+_0x580222[_0x2827fb(0x205)]())[_0x2827fb(0x1ff)](-0x2),_0x3cce7b=('0'+(_0x580222[_0x2827fb(0x26f)]()+0x1))['slice'](-0x2),_0x346734=_0x580222[_0x2827fb(0x1f7)](),_0x3a6928=_0x346734+'-'+_0x3cce7b+'-'+_0x56842c;var _0x3dd9ac=[_0x2827fb(0x1fd),_0x2827fb(0x275)];const _0x38ff23=await warehouse['aggregate']([{'$match':{'name':_0x132480['warehouse_name'],'room':_0x132480[_0x2827fb(0x1be)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2827fb(0x277),'name':{'$first':_0x2827fb(0x2bd)},'product_stock':{'$first':_0x2827fb(0x242)},'bay':{'$first':_0x2827fb(0x1e5)},'bin':{'$first':_0x2827fb(0x20d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x2827fb(0x1cc)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2827fb(0x2b5)},'product_code':{'$first':_0x2827fb(0x227)},'storage':{'$first':_0x2827fb(0x2c7)},'rack':{'$first':_0x2827fb(0x26a)}}}]),_0x1198fe=await customer[_0x2827fb(0x2b3)]({});let _0x181150;if(_0x2a1684[_0x2827fb(0x1cb)]==_0x2827fb(0x21f)){const _0x4a075f=await staff[_0x2827fb(0x1d9)]({'email':_0x2a1684[_0x2827fb(0x1d8)]});_0x181150=await warehouse[_0x2827fb(0x231)]([{'$match':{'status':_0x2827fb(0x208),'name':_0x4a075f['warehouse']}},{'$group':{'_id':_0x2827fb(0x1c2),'name':{'$first':_0x2827fb(0x1c2)}}}]);}else _0x181150=await warehouse[_0x2827fb(0x231)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x2827fb(0x1c2)}}}]);const _0x3bf308=await product[_0x2827fb(0x2b3)]({});if(_0x4e4f1a[0x0][_0x2827fb(0x27c)]==_0x2827fb(0x2ad)){var _0x3e599a=users['English'];console[_0x2827fb(0x1c6)](_0x3e599a);}else{if(_0x4e4f1a[0x0][_0x2827fb(0x27c)]=='Hindi')var _0x3e599a=users[_0x2827fb(0x1d3)];else{if(_0x4e4f1a[0x0][_0x2827fb(0x27c)]=='German')var _0x3e599a=users[_0x2827fb(0x23b)];else{if(_0x4e4f1a[0x0][_0x2827fb(0x27c)]==_0x2827fb(0x1d6))var _0x3e599a=users[_0x2827fb(0x1d6)];else{if(_0x4e4f1a[0x0]['language']=='French')var _0x3e599a=users[_0x2827fb(0x2a6)];else{if(_0x4e4f1a[0x0]['language']=='Portuguese\x20(BR)')var _0x3e599a=users['Portuguese'];else{if(_0x4e4f1a[0x0][_0x2827fb(0x27c)]==_0x2827fb(0x2cb))var _0x3e599a=users[_0x2827fb(0x2cb)];else{if(_0x4e4f1a[0x0][_0x2827fb(0x27c)]==_0x2827fb(0x28e))var _0x3e599a=users[_0x2827fb(0x27b)];}}}}}}}_0x1edc76[_0x2827fb(0x269)](_0x2827fb(0x2a3),{'success':_0x4903ea[_0x2827fb(0x264)](_0x2827fb(0x299)),'errors':_0x4903ea[_0x2827fb(0x264)](_0x2827fb(0x2bc)),'role':_0x2a1684,'profile':_0x260929,'customer':_0x1198fe,'warehouse':_0x181150,'product':_0x38ff23,'user':_0x132480,'master_shop':_0x4e4f1a,'unit':_0x3bf308,'language':_0x3e599a,'rooms_data':_0x3dd9ac,'ed_fullDate':_0x3a6928});}catch(_0x15bd51){console[_0x2827fb(0x1c6)](_0x15bd51);}}),router[a0_0x2261e5(0x240)](a0_0x2261e5(0x1ea),auth,async(_0x3d24d3,_0x38eabe)=>{var _0x143507=a0_0x2261e5;try{const _0xb6208b=_0x3d24d3['params']['id'],_0x34e396=await sales_finished[_0x143507(0x1d9)]({'_id':_0x3d24d3[_0x143507(0x20a)]['id']}),_0x36fd23=await warehouse[_0x143507(0x1d9)]({'name':_0x34e396[_0x143507(0x2bb)],'room':_0x3d24d3[_0x143507(0x2b2)][_0x143507(0x1be)],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x4f8564,customer:_0x3a029f,date:_0x5c22f8,warehouse_name:_0x5331db,product_name:_0x51b666,stock:_0x1dc542,adjust_qty:_0x4fed8f,note:_0x2173ef,room:_0x54c760,primary_code:_0x15b6c1,secondary_code:_0x178a04,prod_code:_0x41a1b0,level:_0xeb897e,isle:_0x3aeb36,pallet:_0x2283a4,expiry_date:_0x3b644b}=_0x3d24d3[_0x143507(0x2b2)];if(typeof _0x51b666==_0x143507(0x1f5))var _0x170f5a=[_0x3d24d3[_0x143507(0x2b2)][_0x143507(0x29b)]],_0x3c92bc=[_0x3d24d3['body'][_0x143507(0x261)]],_0x72f1ff=[_0x3d24d3[_0x143507(0x2b2)][_0x143507(0x2ab)]],_0x537216=[_0x3d24d3[_0x143507(0x2b2)]['primary_code']],_0x1cd5a2=[_0x3d24d3[_0x143507(0x2b2)][_0x143507(0x1dd)]],_0x4784d0=[_0x3d24d3['body']['prod_code']],_0x32454d=[_0x3d24d3[_0x143507(0x2b2)][_0x143507(0x23d)]],_0x40e045=[_0x3d24d3[_0x143507(0x2b2)][_0x143507(0x1d2)]];else var _0x170f5a=[..._0x3d24d3[_0x143507(0x2b2)][_0x143507(0x29b)]],_0x3c92bc=[..._0x3d24d3['body'][_0x143507(0x261)]],_0x72f1ff=[..._0x3d24d3['body']['adjust_qty']],_0x537216=[..._0x3d24d3[_0x143507(0x2b2)][_0x143507(0x2c1)]],_0x1cd5a2=[..._0x3d24d3[_0x143507(0x2b2)][_0x143507(0x1dd)]],_0x4784d0=[..._0x3d24d3[_0x143507(0x2b2)]['prod_code']],_0x32454d=[..._0x3d24d3[_0x143507(0x2b2)][_0x143507(0x23d)]],_0x40e045=[..._0x3d24d3[_0x143507(0x2b2)][_0x143507(0x1d2)]];const _0x285b54=_0x170f5a[_0x143507(0x278)](_0x4ea1a6=>{return _0x4ea1a6={'product_name':_0x4ea1a6};});_0x3c92bc['forEach']((_0x499df4,_0x27a566)=>{var _0x5497cb=_0x143507;_0x285b54[_0x27a566][_0x5497cb(0x261)]=_0x499df4;}),_0x72f1ff['forEach']((_0x5d508d,_0x6e4ae7)=>{_0x285b54[_0x6e4ae7]['quantity']=_0x5d508d;}),_0x537216[_0x143507(0x1e6)]((_0x57506c,_0x35db6e)=>{var _0x4db476=_0x143507;_0x285b54[_0x35db6e][_0x4db476(0x2c1)]=_0x57506c;}),_0x1cd5a2['forEach']((_0x41178e,_0x18b154)=>{var _0x1db128=_0x143507;_0x285b54[_0x18b154][_0x1db128(0x1dd)]=_0x41178e;}),_0x4784d0['forEach']((_0x5a42d,_0x565c44)=>{var _0x8a3ae=_0x143507;_0x285b54[_0x565c44][_0x8a3ae(0x2cc)]=_0x5a42d;}),_0x32454d[_0x143507(0x1e6)]((_0x3dd296,_0x436409)=>{var _0x3cae51=_0x143507;_0x285b54[_0x436409][_0x3cae51(0x23d)]=_0x3dd296;}),_0x40e045[_0x143507(0x1e6)]((_0x58962b,_0x420e0e)=>{var _0x30e16f=_0x143507;_0x285b54[_0x420e0e][_0x30e16f(0x1d2)]=_0x58962b;});var _0x132969=0x0;_0x285b54['forEach'](_0x2fe138=>{var _0x1ae11c=_0x143507;console[_0x1ae11c(0x1c6)](_0x1ae11c(0x222),_0x2fe138),(parseInt(_0x2fe138[_0x1ae11c(0x261)])<parseInt(_0x2fe138[_0x1ae11c(0x1e0)])||parseInt(_0x2fe138[_0x1ae11c(0x1e0)])==0x0)&&_0x132969++;});if(_0x132969!=0x0)return _0x3d24d3['flash']('errors',_0x143507(0x2a2)),_0x38eabe['redirect'](_0x143507(0x204));_0x34e396[_0x143507(0x23f)][_0x143507(0x1e6)](_0x2b4a75=>{const _0x4a66cb=_0x36fd23['product_details']['map'](_0x5298a0=>{var _0x246fd9=a0_0x43f8;_0x5298a0['product_name']==_0x2b4a75['product_name']&&_0x5298a0[_0x246fd9(0x20c)]==_0x2b4a75['bay']&&(_0x5298a0[_0x246fd9(0x2c9)]=parseInt(_0x5298a0[_0x246fd9(0x2c9)])+parseInt(_0x2b4a75[_0x246fd9(0x1e0)]));});}),await _0x36fd23[_0x143507(0x29c)]();const _0xd2238=_0x285b54[_0x143507(0x1c3)](_0x36b513=>_0x36b513[_0x143507(0x1e0)]!=='0'&&_0x36b513[_0x143507(0x1e0)]!=='');_0x34e396[_0x143507(0x1f9)]=_0x4f8564,_0x34e396[_0x143507(0x1c0)]=_0x3a029f,_0x34e396[_0x143507(0x1d1)]=_0x5c22f8,_0x34e396['warehouse_name']=_0x5331db,_0x34e396[_0x143507(0x23f)]=_0xd2238,_0x34e396['note']=_0x2173ef,_0x34e396[_0x143507(0x1be)]=_0x54c760;const _0x3604c6=await _0x34e396[_0x143507(0x29c)](),_0x2153d8=await sales_finished['findOne']({'_id':_0x3d24d3[_0x143507(0x20a)]['id']}),_0x33c45a=await warehouse[_0x143507(0x1d9)]({'name':_0x5331db,'room':_0x54c760,'warehouse_category':_0x143507(0x22e)});_0x2153d8[_0x143507(0x23f)][_0x143507(0x1e6)](_0x4f3eef=>{var _0x498a44=_0x143507;const _0x16bd85=_0x33c45a[_0x498a44(0x253)][_0x498a44(0x278)](_0x1eec98=>{var _0x4f8932=_0x498a44;_0x1eec98[_0x4f8932(0x29b)]==_0x4f3eef[_0x4f8932(0x29b)]&&_0x1eec98[_0x4f8932(0x20c)]==_0x4f3eef[_0x4f8932(0x20c)]&&(_0x1eec98[_0x4f8932(0x2c9)]=parseInt(_0x1eec98[_0x4f8932(0x2c9)])-parseInt(_0x4f3eef[_0x4f8932(0x1e0)]));});}),console[_0x143507(0x1c6)](_0x143507(0x1fb),_0x33c45a),await _0x33c45a[_0x143507(0x29c)]();const _0x289766=await c_payment_data[_0x143507(0x1d9)]({'invoice':_0x3d24d3['body'][_0x143507(0x1f9)]});_0x289766[_0x143507(0x21e)]=_0x3d24d3[_0x143507(0x2b2)]['suppliers'],await _0x289766[_0x143507(0x29c)](),_0x3d24d3[_0x143507(0x264)](_0x143507(0x299),_0x143507(0x246)),_0x38eabe[_0x143507(0x2a9)](_0x143507(0x26d));}catch(_0x3706e5){console['log'](_0x3706e5);}}),router[a0_0x2261e5(0x240)](a0_0x2261e5(0x2b8),auth,async(_0x5d4f38,_0x42e2e2)=>{var _0x1c1a01=a0_0x2261e5;try{const _0x1e7aef=_0x5d4f38[_0x1c1a01(0x20a)]['id'],{invoice:_0x7e96b4,customer:_0x2d0d3b,receivable_amount:_0x28cb69,received_amount:_0xcb7290}=_0x5d4f38[_0x1c1a01(0x2b2)],_0x180e67=await sales[_0x1c1a01(0x234)](_0x1e7aef);console[_0x1c1a01(0x1c6)](_0x180e67);var _0x468bc8=_0x28cb69-_0xcb7290;console[_0x1c1a01(0x1c6)](_0xcb7290),_0x180e67[_0x1c1a01(0x21b)]=parseFloat(_0xcb7290)+parseFloat(_0x180e67[_0x1c1a01(0x21b)]),_0x180e67[_0x1c1a01(0x1bb)]=_0x468bc8,console[_0x1c1a01(0x1c6)](_0x180e67);const _0x1303e6=await _0x180e67[_0x1c1a01(0x29c)](),_0x11fd8f=await c_payment_data[_0x1c1a01(0x1d9)]({'invoice':_0x7e96b4});_0x11fd8f[_0x1c1a01(0x2a8)]=_0x468bc8,await _0x11fd8f[_0x1c1a01(0x29c)]();let _0x1e3de9=new Date(),_0x345f36=('0'+_0x1e3de9[_0x1c1a01(0x205)]())[_0x1c1a01(0x1ff)](-0x2),_0x48c7ba=('0'+(_0x1e3de9[_0x1c1a01(0x26f)]()+0x1))['slice'](-0x2),_0x114131=_0x1e3de9[_0x1c1a01(0x1f7)](),_0xd198c5=_0x114131+'-'+_0x48c7ba+'-'+_0x345f36;const _0x1b3608=new customer_payment({'invoice':_0x7e96b4,'date':_0x114131+'-'+_0x48c7ba+'-'+_0x345f36,'customer':_0x2d0d3b,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0xcb7290}),_0x43fe96=await _0x1b3608[_0x1c1a01(0x29c)]();_0x5d4f38[_0x1c1a01(0x264)]('success',_0x1c1a01(0x22a)),_0x42e2e2[_0x1c1a01(0x2a9)]('/all_sales/view');}catch(_0x34ceca){console[_0x1c1a01(0x1c6)](_0x34ceca);}}),router[a0_0x2261e5(0x2a5)](a0_0x2261e5(0x1f2),auth,async(_0x346bd6,_0x3c2f3b)=>{var _0x20f544=a0_0x2261e5;try{const {username:_0x4a20f3,email:_0x17dbe2,role:_0x4e753d}=_0x346bd6[_0x20f544(0x1d4)],_0x13d7ad=_0x346bd6[_0x20f544(0x1d4)],_0x3c6b33=await profile['findOne']({'email':_0x13d7ad[_0x20f544(0x1d8)]}),_0xd83e41=await master_shop[_0x20f544(0x2b3)]();console[_0x20f544(0x1c6)](_0x20f544(0x296),_0xd83e41);const _0x50a06c=_0x346bd6[_0x20f544(0x20a)]['id'],_0xcafc43=await sales[_0x20f544(0x234)](_0x50a06c);console['log'](_0xcafc43);const _0x41974c=await customer['findOne']({'name':_0xcafc43[_0x20f544(0x1c0)]});console[_0x20f544(0x1c6)](_0x41974c);if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x2ad)){var _0x2a165e=users[_0x20f544(0x293)];console[_0x20f544(0x1c6)](_0x2a165e);}else{if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x1d3))var _0x2a165e=users['Hindi'];else{if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x23b))var _0x2a165e=users['German'];else{if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x1d6))var _0x2a165e=users[_0x20f544(0x1d6)];else{if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x2a6))var _0x2a165e=users['French'];else{if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x1c5))var _0x2a165e=users[_0x20f544(0x1de)];else{if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x2cb))var _0x2a165e=users[_0x20f544(0x2cb)];else{if(_0xd83e41[0x0][_0x20f544(0x27c)]==_0x20f544(0x28e))var _0x2a165e=users[_0x20f544(0x27b)];}}}}}}}_0x3c2f3b['render'](_0x20f544(0x290),{'success':_0x346bd6['flash'](_0x20f544(0x299)),'errors':_0x346bd6[_0x20f544(0x264)](_0x20f544(0x2bc)),'role':_0x13d7ad,'profile':_0x3c6b33,'master_shop':_0xd83e41,'customers':_0x41974c,'sales':_0xcafc43,'language':_0x2a165e});}catch(_0x5bf8cf){console[_0x20f544(0x1c6)](_0x5bf8cf);}}),router[a0_0x2261e5(0x2a5)](a0_0x2261e5(0x2c3),auth,async(_0x26010c,_0xfe28cc)=>{var _0x21e495=a0_0x2261e5;try{const {username:_0xafbead,email:_0x5c1b6b,role:_0x309f36}=_0x26010c['user'],_0x6eb88c=_0x26010c[_0x21e495(0x1d4)],_0xf9881=await profile[_0x21e495(0x1d9)]({'email':_0x6eb88c[_0x21e495(0x1d8)]}),_0xaff942=await master_shop[_0x21e495(0x2b3)](),_0x4796a6=_0x26010c[_0x21e495(0x20a)]['id'],_0x483581=await sales_finished['findById'](_0x4796a6),_0x2af71c=await warehouse[_0x21e495(0x231)]([{'$match':{'name':_0x483581[_0x21e495(0x2bb)]}},{'$unwind':_0x21e495(0x270)},{'$group':{'_id':_0x21e495(0x277),'name':{'$first':_0x21e495(0x2bd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x21e495(0x1e5)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x21e495(0x1f8)},'floorlevel':{'$first':_0x21e495(0x1cc)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x21e495(0x2b5)},'product_code':{'$first':_0x21e495(0x227)},'storage':{'$first':_0x21e495(0x2c7)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x21e495(0x284)},'production_date':{'$first':_0x21e495(0x2c5)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x21e495(0x255)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x2a5e0d=await product[_0x21e495(0x2b3)]({}),_0x4066dd=await warehouse[_0x21e495(0x231)]([{'$match':{'status':_0x21e495(0x208),'warehouse_category':_0x21e495(0x22e),'name':{'$ne':'Return\x20Goods','$ne':_0x21e495(0x1f6)}}},{'$group':{'_id':_0x21e495(0x1c2),'name':{'$first':_0x21e495(0x1c2)}}},{'$sort':{'name':0x1}}]);var _0x3faa14=[_0x21e495(0x22b)];const _0x37a5a7=await warehouse[_0x21e495(0x231)]([{'$match':{'status':_0x21e495(0x208),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x21e495(0x1c2),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0xaff942[0x0]['language']==_0x21e495(0x2ad)){var _0x126202=users[_0x21e495(0x293)];console[_0x21e495(0x1c6)](_0x126202);}else{if(_0xaff942[0x0][_0x21e495(0x27c)]=='Hindi')var _0x126202=users['Hindi'];else{if(_0xaff942[0x0][_0x21e495(0x27c)]=='German')var _0x126202=users[_0x21e495(0x23b)];else{if(_0xaff942[0x0]['language']==_0x21e495(0x1d6))var _0x126202=users[_0x21e495(0x1d6)];else{if(_0xaff942[0x0][_0x21e495(0x27c)]==_0x21e495(0x2a6))var _0x126202=users[_0x21e495(0x2a6)];else{if(_0xaff942[0x0][_0x21e495(0x27c)]=='Portuguese\x20(BR)')var _0x126202=users['Portuguese'];else{if(_0xaff942[0x0]['language']==_0x21e495(0x2cb))var _0x126202=users[_0x21e495(0x2cb)];else{if(_0xaff942[0x0]['language']==_0x21e495(0x28e))var _0x126202=users['Arabic'];}}}}}}}_0xfe28cc['render'](_0x21e495(0x20e),{'success':_0x26010c[_0x21e495(0x264)](_0x21e495(0x299)),'errors':_0x26010c[_0x21e495(0x264)](_0x21e495(0x2bc)),'role':_0x6eb88c,'profile':_0xf9881,'user':_0x483581,'stock':_0x2af71c,'master_shop':_0xaff942,'unit':_0x2a5e0d,'language':_0x126202,'warehouses':_0x4066dd,'rooms':_0x3faa14,'warehouse_QA':_0x37a5a7});}catch(_0x5e69a7){console[_0x21e495(0x1c6)](_0x5e69a7),_0xfe28cc[_0x21e495(0x1ec)](0xc8)[_0x21e495(0x297)]({'message':_0x5e69a7[_0x21e495(0x2b9)]});}}),router[a0_0x2261e5(0x240)]('/view/return_sales/:id',auth,async(_0x2e4264,_0x409132)=>{var _0x24606a=a0_0x2261e5;if(_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x23a)]=='QA')try{const {invoice:_0x2e70da,date:_0x51f1ec,warehouse_name:_0x38611c,product_name:_0x20a727,primary_code:_0x2df041,secondary_code:_0x4cc37c,product_code:_0x54e745,sales_quantity:_0x1ab0ff,stocks:_0x5d2898,return_qty:_0x1cce96,Room_name:_0x378b15,to_warehouse_name_QA:_0x1116e0,to_Room_name_QA:_0x111703,note:_0x117345,for_categorize:_0x286283,product_name_QA1:_0x198a7b}=_0x2e4264[_0x24606a(0x2b2)];if(typeof _0x198a7b==_0x24606a(0x1f5))var _0x4d0a5a=[_0x2e4264[_0x24606a(0x2b2)]['product_name_QA1']],_0x162dc9=[_0x2e4264['body'][_0x24606a(0x24a)]],_0x5e6bba=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1fe)]],_0x16ffff=[_0x2e4264[_0x24606a(0x2b2)]['product_code_QA']],_0x4e8633=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1ce)]],_0x4cdf73=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x248)]],_0x56688b=[_0x2e4264['body'][_0x24606a(0x219)]],_0x56ba38=[_0x2e4264['body'][_0x24606a(0x287)]],_0x2cf60f=[_0x2e4264['body']['maxProducts_QA']],_0x3db5bb=[_0x2e4264['body'][_0x24606a(0x268)]],_0x28cc1f=[_0x2e4264['body'][_0x24606a(0x2c0)]],_0xbb204a=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2c8)]],_0x5c1f72=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2b7)]],_0xbed4b8=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x215)]];else var _0x4d0a5a=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1fa)]],_0x162dc9=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x24a)]],_0x5e6bba=[..._0x2e4264['body'][_0x24606a(0x1fe)]],_0x16ffff=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x26c)]],_0x4e8633=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1ce)]],_0x4cdf73=[..._0x2e4264[_0x24606a(0x2b2)]['stocks_QA']],_0x56688b=[..._0x2e4264['body'][_0x24606a(0x219)]],_0x56ba38=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x287)]],_0x2cf60f=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x259)]],_0x3db5bb=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x268)]],_0x28cc1f=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2c0)]],_0xbb204a=[..._0x2e4264['body'][_0x24606a(0x2c8)]],_0x5c1f72=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2b7)]],_0xbed4b8=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x215)]];const _0x1af8ed=_0x4d0a5a[_0x24606a(0x278)](_0x2c6e08=>{return _0x2c6e08={'product_name':_0x2c6e08};});_0x162dc9[_0x24606a(0x1e6)]((_0x233416,_0x1b17f2)=>{var _0x5cd314=_0x24606a;_0x1af8ed[_0x1b17f2][_0x5cd314(0x2c1)]=_0x233416;}),_0x5e6bba['forEach']((_0x5b3253,_0x133c57)=>{var _0x20da77=_0x24606a;_0x1af8ed[_0x133c57][_0x20da77(0x1dd)]=_0x5b3253;}),_0x16ffff[_0x24606a(0x1e6)]((_0x31fd30,_0x19647a)=>{_0x1af8ed[_0x19647a]['product_code']=_0x31fd30;}),_0x4e8633[_0x24606a(0x1e6)]((_0x2d8c3b,_0x38cc7d)=>{var _0x1a08fb=_0x24606a;_0x1af8ed[_0x38cc7d][_0x1a08fb(0x2be)]=_0x2d8c3b;}),_0x4cdf73[_0x24606a(0x1e6)]((_0x28a563,_0x322996)=>{var _0x146d6e=_0x24606a;_0x1af8ed[_0x322996][_0x146d6e(0x261)]=_0x28a563;}),_0x56688b[_0x24606a(0x1e6)]((_0x192c0c,_0x36df3c)=>{var _0x162923=_0x24606a;_0x1af8ed[_0x36df3c][_0x162923(0x2ca)]=_0x192c0c;}),_0x56ba38[_0x24606a(0x1e6)]((_0x55ec78,_0x4e4135)=>{var _0x2a037c=_0x24606a;_0x1af8ed[_0x4e4135][_0x2a037c(0x2b1)]=_0x55ec78;}),_0x2cf60f['forEach']((_0xd0975c,_0x2c4c6e)=>{var _0x296c92=_0x24606a;_0x1af8ed[_0x2c4c6e][_0x296c92(0x28a)]=_0xd0975c;}),_0x3db5bb[_0x24606a(0x1e6)]((_0x216b77,_0x1b783b)=>{var _0x1b6297=_0x24606a;_0x1af8ed[_0x1b783b][_0x1b6297(0x1e2)]=_0x216b77;}),_0x28cc1f[_0x24606a(0x1e6)]((_0x358f18,_0x58e333)=>{var _0x4b5a95=_0x24606a;_0x1af8ed[_0x58e333][_0x4b5a95(0x250)]=_0x358f18;}),_0xbb204a[_0x24606a(0x1e6)]((_0x4a70c4,_0x52d065)=>{var _0x28deaa=_0x24606a;_0x1af8ed[_0x52d065][_0x28deaa(0x23e)]=_0x4a70c4;}),_0x5c1f72[_0x24606a(0x1e6)]((_0x218e0c,_0xce7a0e)=>{var _0x2bb5e3=_0x24606a;_0x1af8ed[_0xce7a0e][_0x2bb5e3(0x28d)]=_0x218e0c;}),_0xbed4b8[_0x24606a(0x1e6)]((_0x13f6a2,_0x1a2507)=>{_0x1af8ed[_0x1a2507]['expiry_date']=_0x13f6a2;});const _0x453bdc=await sales_finished[_0x24606a(0x1d9)]({'invoice':_0x2e70da});_0x453bdc[_0x24606a(0x218)]=_0x24606a(0x2a4);const _0x339f16=await _0x453bdc[_0x24606a(0x29c)](),_0x1e3ea6=new sales_return_finished({'invoice':_0x2e70da,'customer':_0x2e4264['body'][_0x24606a(0x1c0)],'date':_0x51f1ec,'warehouse_name':_0x38611c,'room':_0x378b15,'ToWarehouse':_0x1116e0,'ToRoom':_0x111703,'return_sale_QA':_0x1af8ed,'note':_0x117345,'warehouse_cat':_0x286283}),_0x20ca20=await _0x1e3ea6[_0x24606a(0x29c)](),_0x2aeb3b=await sales_return_finished[_0x24606a(0x1d9)]({'invoice':_0x2e70da}),_0x3a1724=await warehouse[_0x24606a(0x1d9)]({'name':_0x1116e0,'room':_0x111703});_0x2aeb3b[_0x24606a(0x1e3)][_0x24606a(0x1e6)](_0xea58b3=>{var _0xb64c28=_0x24606a,_0x1492a6=0x0;const _0x3815aa=_0x3a1724['product_details']['map'](_0x6d0858=>{var _0x3ca0b9=a0_0x43f8;_0x6d0858['product_name']==_0xea58b3[_0x3ca0b9(0x29b)]&&_0x6d0858[_0x3ca0b9(0x1d2)]==_0xea58b3[_0x3ca0b9(0x1d2)]&&_0x6d0858['production_date']==_0xea58b3[_0x3ca0b9(0x28d)]&&_0x6d0858[_0x3ca0b9(0x1e2)]==_0xea58b3[_0x3ca0b9(0x1e2)]&&(_0x6d0858['product_stock']=parseInt(_0x6d0858['product_stock'])+parseInt(_0xea58b3[_0x3ca0b9(0x2ca)]),_0x1492a6++);});_0x1492a6=='0'&&(_0x3a1724[_0xb64c28(0x253)]=_0x3a1724[_0xb64c28(0x253)][_0xb64c28(0x257)]({'product_name':_0xea58b3[_0xb64c28(0x29b)],'product_stock':_0xea58b3[_0xb64c28(0x2ca)],'primary_code':_0xea58b3[_0xb64c28(0x2c1)],'secondary_code':_0xea58b3[_0xb64c28(0x1dd)],'product_code':_0xea58b3[_0xb64c28(0x2cc)],'batch_code':_0xea58b3[_0xb64c28(0x1e2)],'maxPerUnit':_0xea58b3[_0xb64c28(0x2b1)],'production_date':_0xea58b3[_0xb64c28(0x28d)],'expiry_date':_0xea58b3[_0xb64c28(0x1d2)],'secondary_unit':_0xea58b3['secondary_unit'],'unit':_0xea58b3[_0xb64c28(0x23e)],'maxProducts':_0xea58b3[_0xb64c28(0x28a)],'bay':_0xea58b3['bay']}));}),await _0x3a1724[_0x24606a(0x29c)]();const _0x543425=new c_payment_data({'invoice':_0x2e70da,'customer':_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1c0)],'reason':_0x24606a(0x1ba)});await _0x543425[_0x24606a(0x29c)]();const _0x1d2acd=await master_shop['find'](),_0x46bd3a=await email_settings[_0x24606a(0x1d9)](),_0x840087=await customer[_0x24606a(0x1d9)]({'name':_0x2e4264['body'][_0x24606a(0x1c0)]});_0x1d2acd[0x0][_0x24606a(0x28c)]==0x1?(right_currency=_0x1d2acd[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x1d2acd[0x0][_0x24606a(0x1e1)]);var _0x42bc8a=_0x4d0a5a,_0x9de631=_0x56688b,_0x20a77e='',_0x178776;for(_0x178776 in _0x42bc8a){_0x20a77e+=_0x24606a(0x23c)+_0x24606a(0x283)+_0x42bc8a[_0x178776]+'</td>'+_0x24606a(0x283)+_0x9de631[_0x178776]+'</td>'+'</tr>';}console[_0x24606a(0x1c6)]('product_list',_0x20a77e);let _0x10f146=nodemailer[_0x24606a(0x20f)]({'service':_0x24606a(0x285),'auth':{'user':_0x46bd3a[_0x24606a(0x1d8)],'pass':_0x46bd3a[_0x24606a(0x1bf)]}}),_0x582dbc={'from':_0x46bd3a[_0x24606a(0x1d8)],'to':_0x840087['email'],'subject':_0x24606a(0x27a),'attachments':[{'filename':_0x24606a(0x1d5),'path':__dirname+_0x24606a(0x280)+_0x24606a(0x1c7)+_0x1d2acd[0x0][_0x24606a(0x2c6)],'cid':_0x24606a(0x209)}],'html':_0x24606a(0x265)+_0x24606a(0x1f3)+_0x24606a(0x25f)+_0x24606a(0x2b4)+_0x24606a(0x25b)+_0x24606a(0x2b4)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x24606a(0x271)+_0x24606a(0x2b4)+_0x24606a(0x21d)+_0x1d2acd[0x0][_0x24606a(0x2ae)]+_0x24606a(0x2a1)+_0x24606a(0x271)+_0x24606a(0x271)+_0x24606a(0x1bc)+'<div>'+_0x24606a(0x260)+_0x24606a(0x289)+_0x2e70da+'\x20'+_0x24606a(0x27f)+_0x24606a(0x211)+_0x51f1ec+'\x20'+_0x24606a(0x25c)+_0x24606a(0x2c2)+_0x24606a(0x271)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x24606a(0x23c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x24606a(0x20b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x24606a(0x266)+'</tr>'+'</thead>'+_0x24606a(0x24b)+'\x20'+_0x20a77e+'\x20'+_0x24606a(0x263)+_0x24606a(0x221)+_0x24606a(0x2b4)+_0x24606a(0x251)+'<h5>'+_0x1d2acd[0x0][_0x24606a(0x2ae)]+_0x24606a(0x2c2)+_0x24606a(0x271)+'</div>'+_0x24606a(0x26b)};_0x10f146[_0x24606a(0x28f)](_0x582dbc,function(_0x32ee75,_0x25b78c){var _0x4cf6d0=_0x24606a;_0x32ee75?(console[_0x4cf6d0(0x1c6)](_0x32ee75),console[_0x4cf6d0(0x1c6)](_0x4cf6d0(0x267))):console['log'](_0x4cf6d0(0x286));}),_0x2e4264[_0x24606a(0x264)]('success',_0x24606a(0x27d)),_0x409132[_0x24606a(0x2a9)](_0x24606a(0x26d));}catch(_0x202548){_0x409132[_0x24606a(0x1ec)](0xc8)[_0x24606a(0x297)]({'message1':_0x202548[_0x24606a(0x2b9)]});}else{if(_0x2e4264['body'][_0x24606a(0x23a)]=='GS')try{const {invoice:_0x450bbe,date:_0x299f63,warehouse_name:_0x324700,product_name:_0x331e8d,primary_code:_0x3817f8,secondary_code:_0x573124,product_code:_0x353a51,sales_quantity:_0x3533fd,stocks:_0x21d719,return_qty:_0x7a2d1b,Room_name:_0x2790a9,to_warehouse_name:_0x1a5b63,to_Room_name:_0x1bd418,note:_0x2fba35,level:_0x27d3d6,isle:_0x544fc0,pallet:_0x2a4b87,for_categorize:_0x48085a}=_0x2e4264[_0x24606a(0x2b2)];if(typeof _0x331e8d==_0x24606a(0x1f5))var _0x4d0a5a=[_0x2e4264[_0x24606a(0x2b2)]['product_name']],_0x162dc9=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2c1)]],_0x5e6bba=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1dd)]],_0x16ffff=[_0x2e4264['body'][_0x24606a(0x2cc)]],_0x4e8633=[_0x2e4264[_0x24606a(0x2b2)]['sales_quantity']],_0x56688b=[_0x2e4264[_0x24606a(0x2b2)]['return_qty']],_0x553072=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x20c)]],_0x56ba38=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2b1)]],_0x2cf60f=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x28a)]],_0x3db5bb=[_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1e2)]],_0x28cc1f=[_0x2e4264['body'][_0x24606a(0x250)]],_0xbb204a=[_0x2e4264['body'][_0x24606a(0x23e)]],_0x5c1f72=[_0x2e4264['body']['production_date']],_0xbed4b8=[_0x2e4264['body'][_0x24606a(0x1d2)]];else var _0x4d0a5a=[..._0x2e4264['body'][_0x24606a(0x29b)]],_0x162dc9=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2c1)]],_0x5e6bba=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1dd)]],_0x16ffff=[..._0x2e4264['body'][_0x24606a(0x2cc)]],_0x4e8633=[..._0x2e4264[_0x24606a(0x2b2)]['sales_quantity']],_0x56688b=[..._0x2e4264['body'][_0x24606a(0x2ca)]],_0x553072=[..._0x2e4264[_0x24606a(0x2b2)]['bay']],_0x56ba38=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x2b1)]],_0x2cf60f=[..._0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x28a)]],_0x3db5bb=[..._0x2e4264['body'][_0x24606a(0x1e2)]],_0x28cc1f=[..._0x2e4264[_0x24606a(0x2b2)]['secondary_unit']],_0xbb204a=[..._0x2e4264['body'][_0x24606a(0x23e)]],_0x5c1f72=[..._0x2e4264['body']['production_date']],_0xbed4b8=[..._0x2e4264[_0x24606a(0x2b2)]['expiry_date']];const _0x59944d=_0x4d0a5a[_0x24606a(0x278)](_0x3853eb=>{return _0x3853eb={'product_name':_0x3853eb};});_0x162dc9[_0x24606a(0x1e6)]((_0x885c6f,_0xa7e610)=>{_0x59944d[_0xa7e610]['primary_code']=_0x885c6f;}),_0x5e6bba[_0x24606a(0x1e6)]((_0x2a5ce1,_0x3266f6)=>{_0x59944d[_0x3266f6]['secondary_code']=_0x2a5ce1;}),_0x16ffff[_0x24606a(0x1e6)]((_0x2ee089,_0x4af2d2)=>{var _0x350826=_0x24606a;_0x59944d[_0x4af2d2][_0x350826(0x2cc)]=_0x2ee089;}),_0x4e8633[_0x24606a(0x1e6)]((_0x477b8b,_0x5b6555)=>{var _0x56bf3a=_0x24606a;_0x59944d[_0x5b6555][_0x56bf3a(0x2be)]=_0x477b8b;}),_0x56688b[_0x24606a(0x1e6)]((_0x572efc,_0x4d1190)=>{var _0x12a9df=_0x24606a;_0x59944d[_0x4d1190][_0x12a9df(0x2ca)]=_0x572efc;}),_0x553072[_0x24606a(0x1e6)]((_0x1aec18,_0x44380d)=>{var _0x1a7f8f=_0x24606a;_0x59944d[_0x44380d][_0x1a7f8f(0x20c)]=_0x1aec18;}),_0x56ba38[_0x24606a(0x1e6)]((_0x48c6b8,_0x126855)=>{var _0x1cc6d4=_0x24606a;_0x59944d[_0x126855][_0x1cc6d4(0x2b1)]=_0x48c6b8;}),_0x2cf60f[_0x24606a(0x1e6)]((_0x5e5e00,_0x26889c)=>{var _0x43da00=_0x24606a;_0x59944d[_0x26889c][_0x43da00(0x28a)]=_0x5e5e00;}),_0x3db5bb['forEach']((_0x5adadb,_0x560a7d)=>{var _0x2fc1a7=_0x24606a;_0x59944d[_0x560a7d][_0x2fc1a7(0x1e2)]=_0x5adadb;}),_0x28cc1f[_0x24606a(0x1e6)]((_0x2b7f72,_0xa7882f)=>{var _0x198a77=_0x24606a;_0x59944d[_0xa7882f][_0x198a77(0x250)]=_0x2b7f72;}),_0xbb204a[_0x24606a(0x1e6)]((_0x29726b,_0x175082)=>{var _0x59f0c1=_0x24606a;_0x59944d[_0x175082][_0x59f0c1(0x23e)]=_0x29726b;}),_0x5c1f72[_0x24606a(0x1e6)]((_0x26bcb2,_0x197907)=>{var _0x5c0458=_0x24606a;_0x59944d[_0x197907][_0x5c0458(0x28d)]=_0x26bcb2;}),_0xbed4b8[_0x24606a(0x1e6)]((_0x24b0cb,_0xee4550)=>{var _0x4875d4=_0x24606a;_0x59944d[_0xee4550][_0x4875d4(0x1d2)]=_0x24b0cb;});var _0x17e68a=0x0;_0x59944d[_0x24606a(0x1e6)](_0x3b6357=>{var _0x102529=_0x24606a;(parseInt(_0x3b6357['sale_qty'])<parseInt(_0x3b6357[_0x102529(0x2ca)])||parseInt(_0x3b6357[_0x102529(0x261)])<parseInt(_0x3b6357[_0x102529(0x2ca)])&&parseInt(_0x3b6357['sale_qty'])>parseInt(_0x3b6357[_0x102529(0x2ca)])||parseInt(_0x3b6357[_0x102529(0x2ca)])==0x0)&&_0x17e68a++;});if(_0x17e68a!=0x0)return _0x2e4264[_0x24606a(0x264)](_0x24606a(0x2bc),_0x24606a(0x24e)),_0x409132['redirect']('back');const _0xf8b8e2=await sales_finished['findOne']({'invoice':_0x450bbe});_0xf8b8e2[_0x24606a(0x218)]=_0x24606a(0x2a4);const _0x3a97a4=await _0xf8b8e2[_0x24606a(0x29c)](),_0x1db02f=new sales_return_finished({'invoice':_0x450bbe,'customer':_0x2e4264['body'][_0x24606a(0x1c0)],'date':_0x299f63,'warehouse_name':_0x324700,'room':_0x2790a9,'ToWarehouse':_0x1a5b63,'ToRoom':_0x1bd418,'return_sale':_0x59944d,'note':_0x2fba35,'warehouse_cat':_0x48085a}),_0x524963=await _0x1db02f[_0x24606a(0x29c)](),_0x95435f=await sales_return_finished[_0x24606a(0x1d9)]({'invoice':_0x450bbe}),_0xda586e=await warehouse[_0x24606a(0x1d9)]({'name':_0x1a5b63,'room':_0x1bd418,'warehouse_category':'Finished\x20Goods'});_0x95435f[_0x24606a(0x29a)][_0x24606a(0x1e6)](_0x10da13=>{var _0xd0d665=_0x24606a,_0x32b749=0x0;const _0x1f9da3=_0xda586e[_0xd0d665(0x253)][_0xd0d665(0x278)](_0x39dc4a=>{var _0x46ce0c=_0xd0d665;_0x39dc4a[_0x46ce0c(0x29b)]==_0x10da13['product_name']&&_0x39dc4a[_0x46ce0c(0x20c)]==_0x10da13[_0x46ce0c(0x20c)]&&_0x39dc4a[_0x46ce0c(0x1d2)]==_0x10da13[_0x46ce0c(0x1d2)]&&_0x39dc4a['production_date']==_0x10da13['production_date']&&_0x39dc4a['batch_code']==_0x10da13['batch_code']&&(_0x39dc4a['product_stock']=parseInt(_0x39dc4a[_0x46ce0c(0x2c9)])+parseInt(_0x10da13['return_qty']),_0x32b749++);});_0x32b749=='0'&&(_0xda586e[_0xd0d665(0x253)]=_0xda586e[_0xd0d665(0x253)][_0xd0d665(0x257)]({'product_name':_0x10da13[_0xd0d665(0x29b)],'product_stock':_0x10da13[_0xd0d665(0x2ca)],'primary_code':_0x10da13[_0xd0d665(0x2c1)],'secondary_code':_0x10da13[_0xd0d665(0x1dd)],'product_code':_0x10da13[_0xd0d665(0x2cc)],'bay':_0x10da13[_0xd0d665(0x20c)],'batch_code':_0x10da13[_0xd0d665(0x1e2)],'maxPerUnit':_0x10da13[_0xd0d665(0x2b1)],'production_date':_0x10da13['production_date'],'expiry_date':_0x10da13[_0xd0d665(0x1d2)],'secondary_unit':_0x10da13['secondary_unit'],'unit':_0x10da13[_0xd0d665(0x23e)],'maxProducts':_0x10da13[_0xd0d665(0x28a)]}));}),await _0xda586e[_0x24606a(0x29c)](),console[_0x24606a(0x1c6)](_0x2e4264['body']);const _0x411d53=new c_payment_data({'invoice':_0x450bbe,'customer':_0x2e4264[_0x24606a(0x2b2)][_0x24606a(0x1c0)],'reason':'Sale\x20Return'});await _0x411d53[_0x24606a(0x29c)]();const _0x4bb386=await master_shop[_0x24606a(0x2b3)]();console[_0x24606a(0x1c6)](_0x24606a(0x217),_0x4bb386[0x0][_0x24606a(0x2c6)]);const _0x3acb06=await email_settings[_0x24606a(0x1d9)](),_0x1577d4=await customer[_0x24606a(0x1d9)]({'name':_0x2e4264['body'][_0x24606a(0x1c0)]});console[_0x24606a(0x1c6)](_0x24606a(0x2b0),_0x1577d4);_0x4bb386[0x0][_0x24606a(0x28c)]==0x1?(right_currency=_0x4bb386[0x0][_0x24606a(0x1e1)],left_currency=''):(right_currency='',left_currency=_0x4bb386[0x0][_0x24606a(0x1e1)]);var _0x42bc8a=_0x4d0a5a,_0x9de631=_0x56688b,_0x20a77e='',_0x178776;for(_0x178776 in _0x42bc8a){_0x20a77e+=_0x24606a(0x23c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x42bc8a[_0x178776]+_0x24606a(0x281)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9de631[_0x178776]+_0x24606a(0x281)+_0x24606a(0x203);}console['log'](_0x24606a(0x22d),_0x20a77e);let _0xa53bbe=nodemailer['createTransport']({'service':_0x24606a(0x285),'auth':{'user':_0x3acb06[_0x24606a(0x1d8)],'pass':_0x3acb06[_0x24606a(0x1bf)]}}),_0xfb3cc2={'from':_0x3acb06[_0x24606a(0x1d8)],'to':_0x1577d4['email'],'subject':_0x24606a(0x27a),'attachments':[{'filename':_0x24606a(0x1d5),'path':__dirname+_0x24606a(0x280)+_0x24606a(0x1c7)+_0x4bb386[0x0][_0x24606a(0x2c6)],'cid':_0x24606a(0x209)}],'html':_0x24606a(0x265)+_0x24606a(0x1f3)+_0x24606a(0x25f)+_0x24606a(0x2b4)+_0x24606a(0x25b)+_0x24606a(0x2b4)+_0x24606a(0x202)+'</div>'+'<div>'+_0x24606a(0x21d)+_0x4bb386[0x0][_0x24606a(0x2ae)]+_0x24606a(0x2a1)+_0x24606a(0x271)+_0x24606a(0x271)+_0x24606a(0x1bc)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x24606a(0x289)+_0x450bbe+'\x20'+_0x24606a(0x27f)+'\x20Order\x20Date\x20:\x20'+_0x299f63+'\x20'+_0x24606a(0x25c)+_0x24606a(0x2c2)+_0x24606a(0x271)+_0x24606a(0x245)+_0x24606a(0x1da)+_0x24606a(0x23c)+_0x24606a(0x216)+_0x24606a(0x20b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x20a77e+'\x20'+_0x24606a(0x263)+_0x24606a(0x221)+_0x24606a(0x2b4)+'<strong>\x20Regards\x20</strong>'+_0x24606a(0x1dc)+_0x4bb386[0x0][_0x24606a(0x2ae)]+'</h5>'+_0x24606a(0x271)+_0x24606a(0x271)+'</body></html>'};_0xa53bbe[_0x24606a(0x28f)](_0xfb3cc2,function(_0x5d961c,_0x21a5a3){var _0x4283a6=_0x24606a;_0x5d961c?(console[_0x4283a6(0x1c6)](_0x5d961c),console[_0x4283a6(0x1c6)](_0x4283a6(0x267))):console[_0x4283a6(0x1c6)](_0x4283a6(0x286));}),_0x2e4264[_0x24606a(0x264)](_0x24606a(0x299),_0x24606a(0x27d)),_0x409132[_0x24606a(0x2a9)](_0x24606a(0x26d));}catch(_0x485f98){console[_0x24606a(0x1c6)](_0x485f98),_0x409132[_0x24606a(0x1ec)](0xc8)[_0x24606a(0x297)]({'message1':_0x485f98['message']});}}}),router[a0_0x2261e5(0x2a5)]('/barcode/:id',auth,async(_0x740876,_0x2645f8)=>{var _0x4416ca=a0_0x2261e5;try{const {username:_0x48e1ed,email:_0x414232,role:_0x5321dd}=_0x740876[_0x4416ca(0x1d4)],_0xa16448=_0x740876['user'],_0x2e93c7=await profile['findOne']({'email':_0xa16448[_0x4416ca(0x1d8)]}),_0x1563ad=await master_shop[_0x4416ca(0x2b3)]();console[_0x4416ca(0x1c6)](_0x4416ca(0x239),_0x1563ad);const _0x30c1b0=_0x740876[_0x4416ca(0x20a)]['id'],_0x5e8f2f=await sales['findById'](_0x30c1b0);console[_0x4416ca(0x1c6)](_0x4416ca(0x2b6),_0x5e8f2f);if(_0x1563ad[0x0][_0x4416ca(0x27c)]==_0x4416ca(0x2ad))var _0x4056bd=users[_0x4416ca(0x293)];else{if(_0x1563ad[0x0][_0x4416ca(0x27c)]==_0x4416ca(0x1d3))var _0x4056bd=users[_0x4416ca(0x1d3)];else{if(_0x1563ad[0x0][_0x4416ca(0x27c)]==_0x4416ca(0x23b))var _0x4056bd=users[_0x4416ca(0x23b)];else{if(_0x1563ad[0x0][_0x4416ca(0x27c)]==_0x4416ca(0x1d6))var _0x4056bd=users['Spanish'];else{if(_0x1563ad[0x0][_0x4416ca(0x27c)]==_0x4416ca(0x2a6))var _0x4056bd=users[_0x4416ca(0x2a6)];else{if(_0x1563ad[0x0][_0x4416ca(0x27c)]==_0x4416ca(0x1c5))var _0x4056bd=users[_0x4416ca(0x1de)];else{if(_0x1563ad[0x0][_0x4416ca(0x27c)]==_0x4416ca(0x2cb))var _0x4056bd=users[_0x4416ca(0x2cb)];else{if(_0x1563ad[0x0][_0x4416ca(0x27c)]=='Arabic\x20(ae)')var _0x4056bd=users['Arabic'];}}}}}}}_0x2645f8[_0x4416ca(0x269)](_0x4416ca(0x235),{'success':_0x740876[_0x4416ca(0x264)](_0x4416ca(0x299)),'errors':_0x740876[_0x4416ca(0x264)](_0x4416ca(0x2bc)),'role':_0xa16448,'profile':_0x2e93c7,'alldata':_0x5e8f2f,'master_shop':_0x1563ad,'language':_0x4056bd});}catch(_0x28de01){console[_0x4416ca(0x1c6)](_0x28de01);}}),router['post'](a0_0x2261e5(0x229),async(_0x5a1b1c,_0x2ec39c)=>{var _0x1be4a5=a0_0x2261e5;const {product_code:_0x260dfd,warehouse_name:_0xdbb2d1,rooms_data:_0x2f0d39,Roomslist:_0x3dc1de}=_0x5a1b1c['body'],_0x4438de=_0x3dc1de[_0x1be4a5(0x21a)](','),_0x3c2807=[];async function _0x2c4424(_0x4021cf){var _0x4117e5=_0x1be4a5;const _0x3facc7=await warehouse['aggregate']([{'$match':{'name':_0xdbb2d1,'room':_0x4021cf}},{'$unwind':_0x4117e5(0x270)},{'$match':{'product_details.primary_code':_0x260dfd}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4117e5(0x2bd)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4117e5(0x2b5)},'product_code':{'$first':_0x4117e5(0x227)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4117e5(0x20d)},'type':{'$first':_0x4117e5(0x1f8)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x4117e5(0x1c4)},'secondary_unit':{'$first':_0x4117e5(0x237)},'storage':{'$first':_0x4117e5(0x2c7)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4117e5(0x284)},'production_date':{'$first':_0x4117e5(0x2c5)},'maxPerUnit':{'$first':_0x4117e5(0x232)},'batch_code':{'$first':_0x4117e5(0x255)},'product_cat':{'$first':_0x4117e5(0x2ac)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x4117e5(0x2a0)},'invoice':{'$first':_0x4117e5(0x25d)}}}]),_0x2fecaa=await warehouse[_0x4117e5(0x231)]([{'$match':{'name':_0xdbb2d1,'room':_0x4021cf}},{'$unwind':_0x4117e5(0x270)},{'$match':{'product_details.secondary_code':_0x260dfd}},{'$group':{'_id':_0x4117e5(0x277),'name':{'$first':_0x4117e5(0x2bd)},'product_stock':{'$first':_0x4117e5(0x242)},'primary_code':{'$first':_0x4117e5(0x1ca)},'secondary_code':{'$first':_0x4117e5(0x2b5)},'product_code':{'$first':_0x4117e5(0x227)},'level':{'$first':_0x4117e5(0x1e5)},'isle':{'$first':_0x4117e5(0x20d)},'type':{'$first':_0x4117e5(0x1f8)},'pallet':{'$first':_0x4117e5(0x1cc)},'unit':{'$first':_0x4117e5(0x1c4)},'secondary_unit':{'$first':_0x4117e5(0x237)},'storage':{'$first':_0x4117e5(0x2c7)},'rack':{'$first':_0x4117e5(0x26a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4117e5(0x255)},'product_cat':{'$first':_0x4117e5(0x2ac)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x4117e5(0x2a0)},'invoice':{'$first':_0x4117e5(0x25d)}}}]);if(_0x3facc7[_0x4117e5(0x295)]>0x0)_0x3c2807[_0x4117e5(0x1e9)](_0x3facc7);else _0x2fecaa[_0x4117e5(0x295)]>0x0&&_0x3c2807[_0x4117e5(0x1e9)](_0x2fecaa);}const _0x2f5067=_0x4438de[_0x1be4a5(0x278)](_0x979115=>_0x2c4424(_0x979115));await Promise['all'](_0x2f5067),_0x2ec39c[_0x1be4a5(0x297)](_0x3c2807);}),module[a0_0x2261e5(0x200)]=router;