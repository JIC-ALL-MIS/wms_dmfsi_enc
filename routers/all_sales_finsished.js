function a0_0x4eea(){var _0x1d7a8b=['</td>','/give_payment/:id','$note','return_sale','return_sale_finished','user','secondary_code','status','add_sales_finished','slice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','padStart','</span>','/view/return_sales/:id','QA\x20Warehouse','<tbody\x20style=\x22text-align:\x20center;\x22>','</table>','/preview/:id','Hindi','$return_data','all','</tr>','<html><head><title></title>','product_stock','all_sales_barcode','English\x20(US)','return_sale_QA','toString','FGSEmail','aggregate','$product_details.product_code','Portuguese','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','push','quantity','currency_placement','Sales\x20Update\x20successfully','$sale_product.type','/invoice/:id','site_title','primary_unit','Enabled','findById','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','\x20</h2>','stocks_QA','received_amount','$product_details.product_cat','prod_invoice','Chinese','1254411caOsrs','$product_details.production_date','return_qty_QA','redirect','Ambient','Email\x20sent\x20successfully','findOne','English','primary_code_QA','$invoice','back','getMonth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$date','production_date_QA','forEach','currency','get','Return\x20Goods','log','German','product_code','Logo.png','product_name','$product_details.product_name','json','/view/add_sales','Return\x20Rooms','unit','render','/all_sales_finished/view','../middleware/auth','$product_details.floorlevel','Sale','Sales\x20Mail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','return_data','getFullYear','Quality\x20Inspection','/view','invoice','<tr>','nodemailer','abs','Portuguese\x20(BR)','/upload/','password','warehouse_name','random','/view/add_sale/product','finalize','error','$customers_docs','secondary_unit_QA','$name','\x20<>\x20','maxPerUnit_QA','concat','$product_details.unit','return_qty','</div>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.maxProducts','3525330sYkATw','edit_sales_finished','Spanish','$room','$sale_product.quantity','$product_details.primary_code','maxPerUnit','$product_details','getDate','Sale\x20Product\x20Mail','RoomAssigned','secondary_code_QA','<hr\x20class=\x22my-3\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<strong>\x20Regards\x20</strong>','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','secondary_unit','Arabic\x20(ae)','An\x20error\x20occurred.','sale_product','Received\x20Payment\x20For\x20Sale','createTransport','<div>','7331048OqqcYS','maxProducts','customer','batch_code','$warehouse_name','batch_code_QA','product_list','$product_details._id','barcode\x20Product\x20master','</h5>','floor','product_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','language','name','$product_details.expiry_date','image','post','$product_details.bay','$product.product_name','foreach\x20newproduct','12GMPFJe','room_name','$product_details.type','/view/:id','sales\x20item\x20return\x20successfull','expiry_date_QA','string','product_name_QA1','<h2>\x20','length','level','barcode\x20user_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$sale_product.floorlevel','expiry_date','27448083pfJbIo','Router','add\x20post','maxProducts_QA','then','17KZxvRI','<h5>','/view/add_sales/:id','172034gFLgGH','$sale_product','</thead>','message','$sale_product.bay','max_per_unit','prod_code','$product_details.product_stock','</tbody>','customers','logo','$product_details.rack','master','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','customers_docs','email','Sale\x20Return','/../public','sales_quantity','port','room','staff','Arabic','$product_details.batch_code','due_amount','save','Sale\x20Return\x20Mail','/picking_list/pdf/','body','\x20Order\x20Date\x20:\x20','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.maxPerUnit','edit_sales_finished_view','<table\x20style=\x22width:\x20100%\x20!important;\x22>','purchases_data','gmail','French','product_code_QA','suppliers','amount','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','carton','Error\x20Occurs','../public/language/languages.json','</body></html>','filter','True','success','$_id','An\x20error\x20occurred\x20while\x20saving\x20data.','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','product_details','$customer','warehouse','False','222530UytTZE','adjust_qty','stock_data','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','errors','Enclosed','sendMail','$product_details.bin','express','flash','$product_details.secondary_code','stock','4302960Mivsnn','split','bay','primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Finished\x20Goods','note','find','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$sale_product.bin','sales_quantity_QA','date','<span\x20style=\x22float:\x20right;\x22>','prod_cat','sales_invoice','<h5\x20style=\x22text-align:\x20left;\x22>','../models/all_models','OUTF-','role','params','map','/barcode/:id','$product_details.secondary_unit','sale_qty','production_date','product_date','unit_QA','\x20Order\x20Number\x20:\x20'];a0_0x4eea=function(){return _0x1d7a8b;};return a0_0x4eea();}var a0_0x134f93=a0_0x395c;(function(_0x4896b2,_0x2a126e){var _0x5c1565=a0_0x395c,_0x2ac4a6=_0x4896b2();while(!![]){try{var _0x50f3c2=-parseInt(_0x5c1565(0x2d3))/0x1*(parseInt(_0x5c1565(0x2d6))/0x2)+-parseInt(_0x5c1565(0x253))/0x3*(parseInt(_0x5c1565(0x2bf))/0x4)+parseInt(_0x5c1565(0x202))/0x5+parseInt(_0x5c1565(0x292))/0x6+-parseInt(_0x5c1565(0x1f5))/0x7+-parseInt(_0x5c1565(0x2aa))/0x8+parseInt(_0x5c1565(0x2ce))/0x9;if(_0x50f3c2===_0x2a126e)break;else _0x2ac4a6['push'](_0x2ac4a6['shift']());}catch(_0xd6f452){_0x2ac4a6['push'](_0x2ac4a6['shift']());}}}(a0_0x4eea,0xcb627));const express=require(a0_0x134f93(0x1fe)),app=express(),router=express[a0_0x134f93(0x2cf)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x134f93(0x214)),auth=require(a0_0x134f93(0x272)),nodemailer=require(a0_0x134f93(0x27d)),users=require(a0_0x134f93(0x1e9));function a0_0x395c(_0x236bd4,_0x43e709){var _0x4eea02=a0_0x4eea();return a0_0x395c=function(_0x395c44,_0x7d6486){_0x395c44=_0x395c44-0x1bf;var _0x2fda3a=_0x4eea02[_0x395c44];return _0x2fda3a;},a0_0x395c(_0x236bd4,_0x43e709);}router[a0_0x134f93(0x264)](a0_0x134f93(0x27a),auth,async(_0x1063a6,_0x183803)=>{var _0x4c77cd=a0_0x134f93;try{const {username:_0x2761cc,email:_0x53e60c,role:_0x2a37e7}=_0x1063a6[_0x4c77cd(0x225)],_0x4c59bc=_0x1063a6['user'],_0x27c855=await profile[_0x4c77cd(0x259)]({'email':_0x4c59bc[_0x4c77cd(0x1cd)]}),_0x2ca556=await master_shop[_0x4c77cd(0x209)]();let _0x25e443;if(_0x4c59bc[_0x4c77cd(0x216)]==_0x4c77cd(0x1d3)){const _0x3098ec=await staff[_0x4c77cd(0x259)]({'email':_0x4c59bc['email']});_0x25e443=await sales_finished['aggregate']([{'$lookup':{'from':_0x4c77cd(0x1c7),'localField':_0x4c77cd(0x2ac),'foreignField':_0x4c77cd(0x2b8),'as':_0x4c77cd(0x1cc)}},{'$unwind':_0x4c77cd(0x287)},{'$unwind':_0x4c77cd(0x1bf)},{'$group':{'_id':_0x4c77cd(0x1ee),'invoice':{'$first':'$invoice'},'customers':{'$first':'$customer'},'date':{'$first':_0x4c77cd(0x260)},'warehouse_name':{'$first':_0x4c77cd(0x2ae)},'sale_product':{'$push':_0x4c77cd(0x1bf)},'note':{'$first':_0x4c77cd(0x222)},'return_data':{'$first':_0x4c77cd(0x233)},'customers_docs':{'$first':_0x4c77cd(0x287)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x4c77cd(0x1c2)},'isle':{'$addToSet':_0x4c77cd(0x20d)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x4c77cd(0x2cc)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x25e443=await sales_finished['aggregate']([{'$lookup':{'from':'customers','localField':_0x4c77cd(0x2ac),'foreignField':_0x4c77cd(0x2b8),'as':_0x4c77cd(0x1cc)}},{'$unwind':'$customers_docs'},{'$unwind':'$sale_product'},{'$group':{'_id':_0x4c77cd(0x1ee),'invoice':{'$first':_0x4c77cd(0x25c)},'customers':{'$first':_0x4c77cd(0x1f2)},'date':{'$first':_0x4c77cd(0x260)},'warehouse_name':{'$first':_0x4c77cd(0x2ae)},'sale_product':{'$push':_0x4c77cd(0x1bf)},'note':{'$first':_0x4c77cd(0x222)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x4c77cd(0x287)},'total_saleproduct_quantity':{'$sum':_0x4c77cd(0x296)},'level':{'$addToSet':_0x4c77cd(0x1c2)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x4c77cd(0x246)},'pallet':{'$addToSet':_0x4c77cd(0x2cc)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x2ca556[0x0][_0x4c77cd(0x2b7)]=='English\x20(US)'){var _0x1dd065=users['English'];console[_0x4c77cd(0x266)](_0x1dd065);}else{if(_0x2ca556[0x0][_0x4c77cd(0x2b7)]==_0x4c77cd(0x232))var _0x1dd065=users['Hindi'];else{if(_0x2ca556[0x0][_0x4c77cd(0x2b7)]==_0x4c77cd(0x267))var _0x1dd065=users[_0x4c77cd(0x267)];else{if(_0x2ca556[0x0][_0x4c77cd(0x2b7)]==_0x4c77cd(0x294))var _0x1dd065=users[_0x4c77cd(0x294)];else{if(_0x2ca556[0x0][_0x4c77cd(0x2b7)]==_0x4c77cd(0x1e2))var _0x1dd065=users[_0x4c77cd(0x1e2)];else{if(_0x2ca556[0x0]['language']==_0x4c77cd(0x27f))var _0x1dd065=users[_0x4c77cd(0x23f)];else{if(_0x2ca556[0x0][_0x4c77cd(0x2b7)]==_0x4c77cd(0x252))var _0x1dd065=users[_0x4c77cd(0x252)];else{if(_0x2ca556[0x0][_0x4c77cd(0x2b7)]==_0x4c77cd(0x2a4))var _0x1dd065=users[_0x4c77cd(0x1d4)];}}}}}}}_0x183803[_0x4c77cd(0x270)]('all_sales_finished',{'success':_0x1063a6[_0x4c77cd(0x1ff)](_0x4c77cd(0x1ed)),'errors':_0x1063a6['flash'](_0x4c77cd(0x1fa)),'sales':_0x25e443,'profile':_0x27c855,'role':_0x4c59bc,'master_shop':_0x2ca556,'language':_0x1dd065});}catch(_0x25ed40){console[_0x4c77cd(0x266)](_0x25ed40);}});async function getRandom8DigitNumber(){var _0x406e94=a0_0x134f93;const _0x2e1829=0x989680,_0x6b4284=0x5f5e0ff,_0x209183=Math[_0x406e94(0x2b4)](Math[_0x406e94(0x283)]()*(_0x6b4284-_0x2e1829+0x1))+_0x2e1829;var _0xad5d07;const _0x28222b=await sales_finished['findOne']({'invoice':'OUTF-'+_0x209183});return _0x28222b&&_0x28222b['length']>0x0?_0xad5d07=_0x406e94(0x215)+_0x209183:_0xad5d07='OUTF-'+_0x209183,_0xad5d07;}router['get'](a0_0x134f93(0x26d),auth,async(_0x30ce5a,_0x22126d)=>{var _0x29dbbd=a0_0x134f93;try{const {username:_0x4e58ea,email:_0x5c0df0,role:_0x1803fc}=_0x30ce5a['user'],_0xd9d384=_0x30ce5a[_0x29dbbd(0x225)],_0x491b97=await profile[_0x29dbbd(0x259)]({'email':_0xd9d384[_0x29dbbd(0x1cd)]}),_0x5d5b39=await master_shop[_0x29dbbd(0x209)](),_0x1b68fd=await customer[_0x29dbbd(0x209)]({});let _0x5f119c;if(_0xd9d384[_0x29dbbd(0x216)]==_0x29dbbd(0x1d3)){const _0x2c9e65=await staff[_0x29dbbd(0x259)]({'email':_0xd9d384[_0x29dbbd(0x1cd)]});_0x5f119c=await warehouse[_0x29dbbd(0x23d)]([{'$match':{'status':'Enabled','name':_0x2c9e65['warehouse'],'warehouse_category':_0x29dbbd(0x207),'name':{'$ne':_0x29dbbd(0x22e)}}},{'$group':{'_id':_0x29dbbd(0x289),'name':{'$first':_0x29dbbd(0x289)}}},{'$sort':{'name':0x1}}]);}else _0x5f119c=await warehouse[_0x29dbbd(0x23d)]([{'$match':{'status':'Enabled','warehouse_category':_0x29dbbd(0x207),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x29dbbd(0x289)}}},{'$sort':{'name':0x1}}]);const _0x3803ef=await product['find']({});var _0x3eb830=[_0x29dbbd(0x257),_0x29dbbd(0x1fb)];const _0x15ed72=await sales_finished[_0x29dbbd(0x209)]({}),_0x5e6b28=_0x15ed72['length']+0x1,_0x17983e=_0x29dbbd(0x215)+_0x5e6b28[_0x29dbbd(0x23b)]()[_0x29dbbd(0x22b)](0x5,'0');if(_0x5d5b39[0x0]['language']=='English\x20(US)'){var _0x17eb3a=users[_0x29dbbd(0x25a)];console[_0x29dbbd(0x266)](_0x17eb3a);}else{if(_0x5d5b39[0x0][_0x29dbbd(0x2b7)]==_0x29dbbd(0x232))var _0x17eb3a=users['Hindi'];else{if(_0x5d5b39[0x0]['language']=='German')var _0x17eb3a=users[_0x29dbbd(0x267)];else{if(_0x5d5b39[0x0][_0x29dbbd(0x2b7)]==_0x29dbbd(0x294))var _0x17eb3a=users[_0x29dbbd(0x294)];else{if(_0x5d5b39[0x0]['language']==_0x29dbbd(0x1e2))var _0x17eb3a=users[_0x29dbbd(0x1e2)];else{if(_0x5d5b39[0x0][_0x29dbbd(0x2b7)]==_0x29dbbd(0x27f))var _0x17eb3a=users['Portuguese'];else{if(_0x5d5b39[0x0][_0x29dbbd(0x2b7)]==_0x29dbbd(0x252))var _0x17eb3a=users[_0x29dbbd(0x252)];else{if(_0x5d5b39[0x0][_0x29dbbd(0x2b7)]==_0x29dbbd(0x2a4))var _0x17eb3a=users[_0x29dbbd(0x1d4)];}}}}}}}const _0x4dfd38=getRandom8DigitNumber();_0x4dfd38[_0x29dbbd(0x2d2)](_0x115216=>{var _0x2125f0=_0x29dbbd;_0x22126d[_0x2125f0(0x270)](_0x2125f0(0x228),{'success':_0x30ce5a[_0x2125f0(0x1ff)](_0x2125f0(0x1ed)),'errors':_0x30ce5a[_0x2125f0(0x1ff)](_0x2125f0(0x1fa)),'role':_0xd9d384,'profile':_0x491b97,'customer':_0x1b68fd,'warehouse':_0x5f119c,'product':_0x3803ef,'invoice':_0x115216,'master_shop':_0x5d5b39,'language':_0x17eb3a,'rooms_data':_0x3eb830});})['catch'](_0x4503e6=>{var _0xa82213=_0x29dbbd;_0x30ce5a[_0xa82213(0x1ff)](_0xa82213(0x1fa),_0xa82213(0x290)),_0x22126d['redirect'](_0xa82213(0x271));});}catch(_0x1b3575){console[_0x29dbbd(0x266)](_0x1b3575);}}),router['get'](a0_0x134f93(0x2d5),auth,async(_0x2dd2a7,_0x3db6bc)=>{var _0x50ea55=a0_0x134f93;try{const _0x1d2bc6=_0x2dd2a7[_0x50ea55(0x217)]['id'];console[_0x50ea55(0x266)](_0x1d2bc6);const _0x5ded96=await product[_0x50ea55(0x209)](),_0x2d6062=await purchases[_0x50ea55(0x23d)]([{'$match':{'warehouse_name':_0x1d2bc6}},{'$unwind':'$product'},{'$group':{'_id':_0x50ea55(0x2bd)}}]);console[_0x50ea55(0x266)](_0x50ea55(0x1e0),_0x2d6062),_0x3db6bc[_0x50ea55(0x227)](0xc8)[_0x50ea55(0x26c)]({'purchases_data':_0x2d6062,'product_data':_0x5ded96});}catch(_0x2918ba){console['log'](_0x2918ba);}}),router[a0_0x134f93(0x2bb)](a0_0x134f93(0x284),auth,async(_0x1aeaf2,_0x5df807)=>{var _0x3f269b=a0_0x134f93;try{const {warehouse_data:_0x1797c2,product_data:_0x45baec}=_0x1aeaf2[_0x3f269b(0x1da)];console[_0x3f269b(0x266)](_0x1aeaf2['body'][_0x3f269b(0x2b5)]);;const _0x536ee6=await master_shop[_0x3f269b(0x209)]();console[_0x3f269b(0x266)](_0x3f269b(0x1ca),_0x536ee6);const _0x220ec8=await product[_0x3f269b(0x259)]({'name':_0x45baec});console[_0x3f269b(0x266)](_0x3f269b(0x2a1),_0x220ec8);const _0x22b7a5=await warehouse['aggregate']([{'$match':{'name':_0x1797c2}},{'$unwind':_0x3f269b(0x299)},{'$match':{'product_details.product_name':_0x45baec}},{'$group':{'_id':_0x3f269b(0x26b),'product_stock':{'$first':_0x3f269b(0x1c5)}}}]);console[_0x3f269b(0x266)](_0x3f269b(0x1f7),_0x22b7a5),_0x5df807[_0x3f269b(0x227)](0xc8)[_0x3f269b(0x26c)]({'master':_0x536ee6,'new_product':_0x220ec8,'stock_data':_0x22b7a5});}catch(_0x398598){console[_0x3f269b(0x266)](_0x398598);}}),router['post'](a0_0x134f93(0x26d),auth,async(_0x2517a8,_0x3f54e2)=>{var _0x5530fa=a0_0x134f93;try{const {invoice:_0x2107ec,date:_0x46fe6b,warehouse_name:_0x308cac,product_name:_0x41e4a7,stock:_0x342973,quantity:_0x16ebc1,note:_0x3fd675,room:_0x44dcd5,primary_code:_0xe9ab6d,secondary_code:_0x24c898,prod_code:_0x2724a3,level:_0x36eea6,isle:_0x148f0b,pallet:_0x307eb8,batch_code:_0x55d054,SCRN:_0xaa252,expiry_date:_0x4c8299,mode_transpo:_0x3e8f17,name_driver:_0x30809f}=_0x2517a8[_0x5530fa(0x1da)];if(typeof _0x41e4a7=='string')var _0x19abd9=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x26a)]],_0x249d88=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x201)]],_0x17db48=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x1e7)]],_0xd21346=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x205)]],_0x1f965c=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x226)]],_0x358702=[_0x2517a8[_0x5530fa(0x1da)]['prod_code']],_0x1e1c9f=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x2c9)]],_0x199960=[_0x2517a8['body']['primary_unit']],_0x49145e=[_0x2517a8['body'][_0x5530fa(0x2a3)]],_0x897d2b=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x2ad)]],_0x336d39=[_0x2517a8[_0x5530fa(0x1da)]['expiry_date']],_0x15866=[_0x2517a8[_0x5530fa(0x1da)]['product_date']],_0x636292=[_0x2517a8['body'][_0x5530fa(0x1c3)]],_0x4fbdc2=[_0x2517a8['body'][_0x5530fa(0x211)]],_0xa99c57=[_0x2517a8[_0x5530fa(0x1da)]['RoomAssigned']],_0x1d8d6f=[_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x251)]];else var _0x19abd9=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x26a)]],_0x249d88=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x201)]],_0x17db48=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x1e7)]],_0xd21346=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x205)]],_0x1f965c=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x226)]],_0x358702=[..._0x2517a8[_0x5530fa(0x1da)]['prod_code']],_0x1e1c9f=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x2c9)]],_0x199960=[..._0x2517a8['body'][_0x5530fa(0x249)]],_0x49145e=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x2a3)]],_0x897d2b=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x2ad)]],_0x336d39=[..._0x2517a8['body']['expiry_date']],_0x15866=[..._0x2517a8['body'][_0x5530fa(0x21d)]],_0x636292=[..._0x2517a8['body'][_0x5530fa(0x1c3)]],_0x4fbdc2=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x211)]],_0xa99c57=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x29c)]],_0x1d8d6f=[..._0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x251)]];const _0x45e3ae=_0x19abd9['map'](_0x24e2d1=>{return _0x24e2d1={'product_name':_0x24e2d1};});_0x249d88[_0x5530fa(0x262)]((_0x33e285,_0x565e19)=>{var _0x4b0d28=_0x5530fa;_0x45e3ae[_0x565e19][_0x4b0d28(0x201)]=_0x33e285;}),_0x17db48[_0x5530fa(0x262)]((_0x529c84,_0x59b13)=>{_0x45e3ae[_0x59b13]['quantity']=Math['abs'](_0x529c84);}),_0xd21346[_0x5530fa(0x262)]((_0x16e87e,_0x3aa421)=>{var _0x529804=_0x5530fa;_0x45e3ae[_0x3aa421][_0x529804(0x205)]=_0x16e87e;}),_0x1f965c[_0x5530fa(0x262)]((_0xfe336,_0x452f93)=>{var _0x36fba6=_0x5530fa;_0x45e3ae[_0x452f93][_0x36fba6(0x226)]=_0xfe336;}),_0x358702[_0x5530fa(0x262)]((_0x4bd7fb,_0xfea5e5)=>{var _0x4b5a7d=_0x5530fa;_0x45e3ae[_0xfea5e5][_0x4b5a7d(0x268)]=_0x4bd7fb;}),_0x1e1c9f['forEach']((_0xc68748,_0xcebefd)=>{var _0x406b88=_0x5530fa;_0x45e3ae[_0xcebefd][_0x406b88(0x204)]=_0xc68748;}),_0x199960[_0x5530fa(0x262)]((_0xd8cd57,_0x246bbf)=>{var _0x8385ab=_0x5530fa;_0x45e3ae[_0x246bbf][_0x8385ab(0x26f)]=_0xd8cd57;}),_0x49145e[_0x5530fa(0x262)]((_0x29759e,_0x126d76)=>{var _0x496739=_0x5530fa;_0x45e3ae[_0x126d76][_0x496739(0x2a3)]=_0x29759e;}),_0x897d2b[_0x5530fa(0x262)]((_0xdcdc96,_0x10e0d4)=>{var _0x24a660=_0x5530fa;_0x45e3ae[_0x10e0d4][_0x24a660(0x2ad)]=_0xdcdc96;}),_0x336d39[_0x5530fa(0x262)]((_0x11a36b,_0xe82afc)=>{var _0x36c562=_0x5530fa;_0x45e3ae[_0xe82afc][_0x36c562(0x2cd)]=_0x11a36b;}),_0x15866[_0x5530fa(0x262)]((_0x942ebe,_0x10cf4f)=>{_0x45e3ae[_0x10cf4f]['production_date']=_0x942ebe;}),_0x636292['forEach']((_0x54818f,_0x4b57bf)=>{_0x45e3ae[_0x4b57bf]['maxperunit']=_0x54818f;}),_0x4fbdc2[_0x5530fa(0x262)]((_0x4b826f,_0x4732ef)=>{var _0x4b6efb=_0x5530fa;_0x45e3ae[_0x4732ef][_0x4b6efb(0x211)]=_0x4b826f;}),_0xa99c57['forEach']((_0x562b10,_0x7a658c)=>{_0x45e3ae[_0x7a658c]['room_name']=_0x562b10;}),_0x1d8d6f['forEach']((_0x21e75d,_0x4ff262)=>{var _0x50538e=_0x5530fa;_0x45e3ae[_0x4ff262][_0x50538e(0x27b)]=_0x21e75d;});var _0x1bee77=0x0;_0x45e3ae[_0x5530fa(0x262)](_0x4ae889=>{var _0x4674be=_0x5530fa;parseFloat(_0x4ae889[_0x4674be(0x201)])<parseFloat(_0x4ae889[_0x4674be(0x243)])&&parseFloat(_0x4ae889[_0x4674be(0x243)])>parseFloat(_0x4ae889['stock'])&&(console[_0x4674be(0x266)](_0x4ae889[_0x4674be(0x201)]+_0x4674be(0x28a)+_0x4ae889[_0x4674be(0x243)]),_0x1bee77++);});if(_0x1bee77!=0x0)return _0x2517a8['flash'](_0x5530fa(0x1fa),_0x5530fa(0x24c)),_0x3f54e2[_0x5530fa(0x256)](_0x5530fa(0x25d));const _0x1d8c64=_0x45e3ae[_0x5530fa(0x1eb)](_0x4e29e3=>_0x4e29e3['quantity']!=='0'&&_0x4e29e3[_0x5530fa(0x243)]!==''),_0x2eccad=new sales_finished({'invoice':_0x2107ec,'customer':_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x2ac)],'date':_0x46fe6b,'warehouse_name':_0x308cac,'sale_product':_0x1d8c64,'note':_0x3fd675,'room':_0x44dcd5,'primary_code':_0xe9ab6d,'secondary_code':_0x24c898,'prod_code':_0x2724a3,'SCRN':_0xaa252,'finalize':_0x5530fa(0x1f4),'mode_transpo':_0x3e8f17,'name_driver':_0x30809f}),_0x24582d=await _0x2eccad[_0x5530fa(0x1d7)](),_0x457120=await sales_finished[_0x5530fa(0x259)]({'invoice':_0x2107ec}),_0x2f980b=new c_payment_data({'invoice':_0x2107ec,'customer':_0x2517a8['body'][_0x5530fa(0x2ac)],'reason':_0x5530fa(0x274)});await _0x2f980b[_0x5530fa(0x1d7)]();const _0x3d96cc=await master_shop[_0x5530fa(0x209)](),_0x250733=await email_settings[_0x5530fa(0x259)](),_0x12cca4=await customer[_0x5530fa(0x259)]({'name':_0x2517a8[_0x5530fa(0x1da)][_0x5530fa(0x2ac)]});_0x3d96cc[0x0]['currency_placement']==0x1?(right_currency=_0x3d96cc[0x0][_0x5530fa(0x263)],left_currency=''):(right_currency='',left_currency=_0x3d96cc[0x0][_0x5530fa(0x263)]);var _0x294495=_0x19abd9,_0x599ccc=_0x17db48,_0x359e70='',_0x5aedfc;for(_0x5aedfc in _0x294495){_0x359e70+=_0x5530fa(0x27c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x294495[_0x5aedfc]+_0x5530fa(0x220)+_0x5530fa(0x20c)+_0x599ccc[_0x5aedfc]+_0x5530fa(0x220)+_0x5530fa(0x235);}console[_0x5530fa(0x266)](_0x5530fa(0x2b0),_0x359e70);let _0x511bfe=nodemailer[_0x5530fa(0x2a8)]({'service':_0x5530fa(0x1e1),'auth':{'user':_0x250733[_0x5530fa(0x1cd)],'pass':_0x250733[_0x5530fa(0x281)]}}),_0x97a0ea={'from':_0x250733[_0x5530fa(0x1cd)],'to':_0x12cca4[_0x5530fa(0x1cd)],'subject':_0x5530fa(0x29b),'attachments':[{'filename':_0x5530fa(0x269),'path':__dirname+'/../public'+'/upload/'+_0x3d96cc[0x0][_0x5530fa(0x2ba)],'cid':_0x5530fa(0x1c8)}],'html':_0x5530fa(0x1f8)+_0x5530fa(0x236)+_0x5530fa(0x20a)+_0x5530fa(0x2a9)+_0x5530fa(0x1f0)+_0x5530fa(0x2a9)+_0x5530fa(0x1e6)+_0x5530fa(0x28f)+_0x5530fa(0x2a9)+_0x5530fa(0x2c7)+_0x3d96cc[0x0][_0x5530fa(0x248)]+_0x5530fa(0x24d)+'</div>'+_0x5530fa(0x28f)+_0x5530fa(0x29e)+_0x5530fa(0x2a9)+_0x5530fa(0x213)+_0x5530fa(0x21f)+_0x2107ec+'\x20'+_0x5530fa(0x210)+_0x5530fa(0x1db)+_0x46fe6b+'\x20'+_0x5530fa(0x22c)+'</h5>'+_0x5530fa(0x28f)+_0x5530fa(0x1df)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5530fa(0x27c)+_0x5530fa(0x29f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>'+'</tr>'+_0x5530fa(0x1c0)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x359e70+'\x20'+_0x5530fa(0x1c6)+_0x5530fa(0x230)+_0x5530fa(0x2a9)+_0x5530fa(0x2a0)+_0x5530fa(0x2d4)+_0x3d96cc[0x0]['site_title']+'</h5>'+_0x5530fa(0x28f)+_0x5530fa(0x28f)+_0x5530fa(0x1ea)};_0x511bfe['sendMail'](_0x97a0ea,function(_0x4b3222,_0x264cef){var _0x3e29ba=_0x5530fa;_0x4b3222?(console[_0x3e29ba(0x266)](_0x4b3222),console['log'](_0x3e29ba(0x1e8))):console[_0x3e29ba(0x266)]('Email\x20sent\x20successfully');}),_0x2517a8[_0x5530fa(0x1ff)](_0x5530fa(0x1ed),'Sales\x20Add\x20successfully'),_0x3f54e2[_0x5530fa(0x256)]('/all_sales_finished/preview/'+_0x24582d['_id']);}catch(_0x1bbbdd){console['log'](_0x1bbbdd);}}),router['get'](a0_0x134f93(0x231),auth,async(_0x4e8e93,_0x5b8b1e)=>{var _0x44159c=a0_0x134f93;try{const {username:_0x2f0dc8,email:_0x206b78,role:_0x1a1608}=_0x4e8e93[_0x44159c(0x225)],_0x5daaa7=_0x4e8e93[_0x44159c(0x225)],_0x583d12=await profile['findOne']({'email':_0x5daaa7[_0x44159c(0x1cd)]}),_0x467d50=await master_shop[_0x44159c(0x209)](),_0xa11043=_0x4e8e93[_0x44159c(0x217)]['id'],_0x3a543c=await sales_finished[_0x44159c(0x24b)](_0xa11043),_0xb26631=await warehouse['aggregate']([{'$match':{'name':_0x3a543c[_0x44159c(0x282)]}},{'$unwind':_0x44159c(0x299)},{'$group':{'_id':_0x44159c(0x2b1),'name':{'$first':_0x44159c(0x26b)},'product_stock':{'$first':_0x44159c(0x1c5)},'bay':{'$first':_0x44159c(0x2bc)},'bin':{'$first':_0x44159c(0x1fd)},'type':{'$first':_0x44159c(0x2c1)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x44159c(0x297)},'secondary_code':{'$first':_0x44159c(0x200)},'product_code':{'$first':_0x44159c(0x23e)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x44159c(0x1c9)},'expiry_date':{'$first':_0x44159c(0x2b9)},'production_date':{'$first':_0x44159c(0x254)},'batch_code':{'$first':_0x44159c(0x1d5)},'room':{'$first':_0x44159c(0x295)}}}]),_0x41db34=await customer['find']({});let _0x4a7234;if(_0x5daaa7[_0x44159c(0x216)]==_0x44159c(0x1d3)){const _0xd759da=await staff[_0x44159c(0x259)]({'email':_0x5daaa7[_0x44159c(0x1cd)]});_0x4a7234=await warehouse[_0x44159c(0x23d)]([{'$match':{'status':_0x44159c(0x24a),'name':_0xd759da[_0x44159c(0x1f3)]}},{'$group':{'_id':_0x44159c(0x289),'name':{'$first':_0x44159c(0x289)}}}]);}else _0x4a7234=await warehouse['aggregate']([{'$match':{'status':_0x44159c(0x24a)}},{'$group':{'_id':_0x44159c(0x289),'name':{'$first':_0x44159c(0x289)}}}]);const _0x15dfad=await product[_0x44159c(0x209)]({});if(_0x467d50[0x0][_0x44159c(0x2b7)]==_0x44159c(0x239)){var _0x15a5a7=users[_0x44159c(0x25a)];console[_0x44159c(0x266)](_0x15a5a7);}else{if(_0x467d50[0x0][_0x44159c(0x2b7)]==_0x44159c(0x232))var _0x15a5a7=users[_0x44159c(0x232)];else{if(_0x467d50[0x0][_0x44159c(0x2b7)]=='German')var _0x15a5a7=users[_0x44159c(0x267)];else{if(_0x467d50[0x0][_0x44159c(0x2b7)]==_0x44159c(0x294))var _0x15a5a7=users[_0x44159c(0x294)];else{if(_0x467d50[0x0][_0x44159c(0x2b7)]==_0x44159c(0x1e2))var _0x15a5a7=users['French'];else{if(_0x467d50[0x0][_0x44159c(0x2b7)]==_0x44159c(0x27f))var _0x15a5a7=users[_0x44159c(0x23f)];else{if(_0x467d50[0x0]['language']==_0x44159c(0x252))var _0x15a5a7=users[_0x44159c(0x252)];else{if(_0x467d50[0x0][_0x44159c(0x2b7)]==_0x44159c(0x2a4))var _0x15a5a7=users[_0x44159c(0x1d4)];}}}}}}}_0x5b8b1e['render'](_0x44159c(0x1de),{'success':_0x4e8e93['flash']('success'),'errors':_0x4e8e93[_0x44159c(0x1ff)]('errors'),'role':_0x5daaa7,'profile':_0x583d12,'customer':_0x41db34,'warehouse':_0x4a7234,'product':_0xb26631,'user':_0x3a543c,'master_shop':_0x467d50,'unit':_0x15dfad,'language':_0x15a5a7});}catch(_0xb7b686){console['log'](_0xb7b686);}}),router[a0_0x134f93(0x2bb)](a0_0x134f93(0x231),auth,async(_0x116c53,_0xa4053a)=>{var _0x168d0a=a0_0x134f93;try{const _0x511840=_0x116c53['params']['id'],{invoice:_0x55e0fa,warehouse_name:_0x9ee5c0,room:_0x3886b5}=_0x116c53['body'],_0x27056f=await sales_finished[_0x168d0a(0x259)]({'invoice':_0x55e0fa}),_0x21694d=_0x27056f[_0x168d0a(0x2a6)][_0x168d0a(0x218)](async _0xd59a1f=>{var _0x1b4fcd=_0x168d0a,_0x531ffe=await warehouse[_0x1b4fcd(0x259)]({'name':_0x9ee5c0,'room':_0xd59a1f['room_name'],'warehouse_category':'Finished\x20Goods'});const _0x4fc75a=_0x531ffe['product_details']['map'](_0x3b8be6=>{var _0x2a3db8=_0x1b4fcd;_0x3b8be6[_0x2a3db8(0x26a)]==_0xd59a1f[_0x2a3db8(0x26a)]&&_0x3b8be6[_0x2a3db8(0x204)]==_0xd59a1f[_0x2a3db8(0x204)]&&_0x3b8be6[_0x2a3db8(0x2cd)]==_0xd59a1f[_0x2a3db8(0x2cd)]&&_0x3b8be6['production_date']==_0xd59a1f[_0x2a3db8(0x21c)]&&_0x3b8be6[_0x2a3db8(0x2ad)]==_0xd59a1f[_0x2a3db8(0x2ad)]&&_0x3b8be6[_0x2a3db8(0x27b)]==_0xd59a1f[_0x2a3db8(0x27b)]&&(_0x3b8be6[_0x2a3db8(0x237)]=Math[_0x2a3db8(0x27e)](_0x3b8be6[_0x2a3db8(0x237)])-Math[_0x2a3db8(0x27e)](_0xd59a1f[_0x2a3db8(0x243)]));});return _0x531ffe;});Promise[_0x168d0a(0x234)](_0x21694d)['then'](async _0x3c5db4=>{var _0x20462e=_0x168d0a;try{for(const _0x18b843 of _0x3c5db4){await _0x18b843['save']();}_0x27056f[_0x20462e(0x285)]=_0x20462e(0x1ec);const _0xfd20de=await _0x27056f[_0x20462e(0x1d7)](),_0x31a7dc=await master_shop[_0x20462e(0x209)](),_0x14d028=await email_settings['findOne'](),_0x372590=await supervisor_settings[_0x20462e(0x209)]();var _0x35bfe9=_0x27056f[_0x20462e(0x2a6)],_0x23cd66='',_0x428fbd;for(_0x428fbd in _0x35bfe9){var _0x1904b5='FG';_0x27056f[_0x20462e(0x282)]=='DRY\x20GOODS'&&(_0x1904b5='DG'),_0x23cd66+=_0x20462e(0x27c)+_0x20462e(0x20c)+_0x35bfe9[_0x428fbd]['product_name']+_0x20462e(0x220)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x35bfe9[_0x428fbd][_0x20462e(0x268)]+'</td>'+_0x20462e(0x20c)+_0x35bfe9[_0x428fbd][_0x20462e(0x243)]+_0x20462e(0x220)+_0x20462e(0x20c)+_0x35bfe9[_0x428fbd]['unit']+_0x20462e(0x220)+_0x20462e(0x20c)+_0x35bfe9[_0x428fbd][_0x20462e(0x2a3)]+_0x20462e(0x220)+_0x20462e(0x20c)+_0x27056f[_0x20462e(0x282)]+_0x20462e(0x220)+_0x20462e(0x20c)+_0x35bfe9[_0x428fbd][_0x20462e(0x2c0)]+_0x20462e(0x220)+_0x20462e(0x20c)+_0x1904b5+_0x35bfe9[_0x428fbd][_0x20462e(0x204)]+'</td>';}let _0x30e68e=nodemailer[_0x20462e(0x2a8)]({'host':_0x14d028['host'],'port':Number(_0x14d028[_0x20462e(0x1d1)]),'secure':![],'auth':{'user':_0x14d028['email'],'pass':_0x14d028['password']}}),_0x336fa0={'from':_0x14d028[_0x20462e(0x1cd)],'to':_0x372590[0x0][_0x20462e(0x23c)],'subject':_0x20462e(0x275),'attachments':[{'filename':_0x20462e(0x269),'path':__dirname+_0x20462e(0x1cf)+_0x20462e(0x280)+_0x31a7dc[0x0]['image'],'cid':_0x20462e(0x1c8)}],'html':'<!DOCTYPE\x20html>'+_0x20462e(0x236)+_0x20462e(0x20a)+'<div>'+_0x20462e(0x1f0)+_0x20462e(0x2a9)+_0x20462e(0x1e6)+_0x20462e(0x28f)+'<div>'+_0x20462e(0x2c7)+_0x31a7dc[0x0][_0x20462e(0x248)]+'\x20</h2>'+_0x20462e(0x28f)+_0x20462e(0x28f)+'<hr\x20class=\x22my-3\x22>'+'<div>'+_0x20462e(0x213)+_0x20462e(0x21f)+_0x27056f[_0x20462e(0x27b)]+'\x20'+_0x20462e(0x210)+_0x20462e(0x1db)+_0x27056f[_0x20462e(0x20f)]+'\x20'+_0x20462e(0x22c)+'</h5>'+_0x20462e(0x28f)+_0x20462e(0x1df)+_0x20462e(0x1dc)+_0x20462e(0x27c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x20462e(0x2a2)+_0x20462e(0x2b6)+_0x20462e(0x2cb)+_0x20462e(0x22a)+_0x20462e(0x241)+_0x20462e(0x1f9)+_0x20462e(0x206)+_0x20462e(0x235)+_0x20462e(0x1c0)+_0x20462e(0x22f)+'\x20'+_0x23cd66+'\x20'+_0x20462e(0x1c6)+'</table>'+_0x20462e(0x2a9)+_0x20462e(0x2a0)+_0x20462e(0x2d4)+_0x31a7dc[0x0][_0x20462e(0x248)]+'</h5>'+_0x20462e(0x28f)+_0x20462e(0x28f)+_0x20462e(0x1ea)};_0x30e68e[_0x20462e(0x1fc)](_0x336fa0,function(_0x53b6a9,_0x59ce45){var _0x1ffb77=_0x20462e;_0x53b6a9?(console['log'](_0x53b6a9),console[_0x1ffb77(0x266)]('Error\x20Occurs')):console[_0x1ffb77(0x266)](_0x1ffb77(0x258));}),_0x116c53[_0x20462e(0x1ff)](_0x20462e(0x1ed),_0x20462e(0x245)),_0xa4053a[_0x20462e(0x256)](_0x20462e(0x1d9)+_0x511840);}catch(_0x5dbfaa){console[_0x20462e(0x286)](_0x5dbfaa),_0xa4053a[_0x20462e(0x227)](0x1f4)[_0x20462e(0x26c)]({'error':_0x20462e(0x1ef)});}})['catch'](_0x23cc70=>{var _0x277e02=_0x168d0a;console[_0x277e02(0x286)](_0x23cc70),_0xa4053a[_0x277e02(0x227)](0x1f4)[_0x277e02(0x26c)]({'error':_0x277e02(0x2a5)});});}catch(_0x149223){console[_0x168d0a(0x266)](_0x149223);}}),router[a0_0x134f93(0x264)]('/view/:id',auth,async(_0xfbc42c,_0x1682a2)=>{var _0x3637f1=a0_0x134f93;try{const {username:_0x20482b,email:_0x2b0f56,role:_0x4af719}=_0xfbc42c[_0x3637f1(0x225)],_0x2abe88=_0xfbc42c[_0x3637f1(0x225)],_0x40ae9d=await profile['findOne']({'email':_0x2abe88[_0x3637f1(0x1cd)]}),_0x106b08=await master_shop[_0x3637f1(0x209)](),_0x7d0382=_0xfbc42c[_0x3637f1(0x217)]['id'],_0xffab04=await sales_finished[_0x3637f1(0x24b)](_0x7d0382);let _0x35a143=new Date(_0xffab04[_0x3637f1(0x2cd)]),_0x5d7270=('0'+_0x35a143['getDate']())[_0x3637f1(0x229)](-0x2),_0x557219=('0'+(_0x35a143[_0x3637f1(0x25e)]()+0x1))['slice'](-0x2),_0x3fdd86=_0x35a143[_0x3637f1(0x278)](),_0x337986=_0x3fdd86+'-'+_0x557219+'-'+_0x5d7270;var _0x352c47=[_0x3637f1(0x257),_0x3637f1(0x1fb)];const _0x547b40=await warehouse['aggregate']([{'$match':{'name':_0xffab04[_0x3637f1(0x282)],'room':_0xffab04[_0x3637f1(0x1d2)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3637f1(0x2b1),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3637f1(0x1c5)},'bay':{'$first':_0x3637f1(0x2bc)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3637f1(0x2c1)},'floorlevel':{'$first':_0x3637f1(0x273)},'primary_code':{'$first':_0x3637f1(0x297)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3637f1(0x23e)},'storage':{'$first':_0x3637f1(0x240)},'rack':{'$first':_0x3637f1(0x1c9)}}}]),_0x3d2334=await customer[_0x3637f1(0x209)]({});let _0x59fee6;if(_0x2abe88['role']==_0x3637f1(0x1d3)){const _0x4f97eb=await staff[_0x3637f1(0x259)]({'email':_0x2abe88[_0x3637f1(0x1cd)]});_0x59fee6=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x4f97eb['warehouse']}},{'$group':{'_id':_0x3637f1(0x289),'name':{'$first':_0x3637f1(0x289)}}}]);}else _0x59fee6=await warehouse[_0x3637f1(0x23d)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x3637f1(0x289),'name':{'$first':'$name'}}}]);const _0x3c9bee=await product[_0x3637f1(0x209)]({});if(_0x106b08[0x0][_0x3637f1(0x2b7)]==_0x3637f1(0x239)){var _0x181221=users[_0x3637f1(0x25a)];console[_0x3637f1(0x266)](_0x181221);}else{if(_0x106b08[0x0][_0x3637f1(0x2b7)]=='Hindi')var _0x181221=users[_0x3637f1(0x232)];else{if(_0x106b08[0x0][_0x3637f1(0x2b7)]==_0x3637f1(0x267))var _0x181221=users['German'];else{if(_0x106b08[0x0]['language']==_0x3637f1(0x294))var _0x181221=users[_0x3637f1(0x294)];else{if(_0x106b08[0x0][_0x3637f1(0x2b7)]==_0x3637f1(0x1e2))var _0x181221=users[_0x3637f1(0x1e2)];else{if(_0x106b08[0x0][_0x3637f1(0x2b7)]==_0x3637f1(0x27f))var _0x181221=users[_0x3637f1(0x23f)];else{if(_0x106b08[0x0][_0x3637f1(0x2b7)]==_0x3637f1(0x252))var _0x181221=users[_0x3637f1(0x252)];else{if(_0x106b08[0x0][_0x3637f1(0x2b7)]==_0x3637f1(0x2a4))var _0x181221=users['Arabic'];}}}}}}}_0x1682a2[_0x3637f1(0x270)](_0x3637f1(0x293),{'success':_0xfbc42c[_0x3637f1(0x1ff)](_0x3637f1(0x1ed)),'errors':_0xfbc42c[_0x3637f1(0x1ff)](_0x3637f1(0x1fa)),'role':_0x2abe88,'profile':_0x40ae9d,'customer':_0x3d2334,'warehouse':_0x59fee6,'product':_0x547b40,'user':_0xffab04,'master_shop':_0x106b08,'unit':_0x3c9bee,'language':_0x181221,'rooms_data':_0x352c47,'ed_fullDate':_0x337986});}catch(_0x43c3eb){console[_0x3637f1(0x266)](_0x43c3eb);}}),router[a0_0x134f93(0x2bb)](a0_0x134f93(0x2c2),auth,async(_0x2b0eb7,_0x3cef4f)=>{var _0x192cd7=a0_0x134f93;try{const _0x2dfced=_0x2b0eb7[_0x192cd7(0x217)]['id'],_0x55b1e9=await sales_finished[_0x192cd7(0x259)]({'_id':_0x2b0eb7['params']['id']}),_0x3feb20=await warehouse['findOne']({'name':_0x55b1e9[_0x192cd7(0x282)],'room':_0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x1d2)],'warehouse_category':_0x192cd7(0x207)}),{invoice:_0xe06e5a,customer:_0x397bbd,date:_0x26dcc4,warehouse_name:_0x2063e0,product_name:_0x456350,stock:_0x195fb5,adjust_qty:_0xec2c3,note:_0x486905,room:_0x1680b8,primary_code:_0x594519,secondary_code:_0x33bd15,prod_code:_0x569a2f,level:_0x25fcc2,isle:_0x187436,pallet:_0x47fd7c,expiry_date:_0x2bbaa3}=_0x2b0eb7[_0x192cd7(0x1da)];if(typeof _0x456350=='string')var _0x437a54=[_0x2b0eb7[_0x192cd7(0x1da)]['product_name']],_0x52d1bf=[_0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x201)]],_0xbf19aa=[_0x2b0eb7[_0x192cd7(0x1da)]['adjust_qty']],_0x334174=[_0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x205)]],_0x365c05=[_0x2b0eb7['body']['secondary_code']],_0x2c4ffb=[_0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x1c4)]],_0x2bbb0f=[_0x2b0eb7[_0x192cd7(0x1da)]['level']],_0x2e918b=[_0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x2cd)]];else var _0x437a54=[..._0x2b0eb7[_0x192cd7(0x1da)]['product_name']],_0x52d1bf=[..._0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x201)]],_0xbf19aa=[..._0x2b0eb7['body'][_0x192cd7(0x1f6)]],_0x334174=[..._0x2b0eb7['body'][_0x192cd7(0x205)]],_0x365c05=[..._0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x226)]],_0x2c4ffb=[..._0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x1c4)]],_0x2bbb0f=[..._0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x2c9)]],_0x2e918b=[..._0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x2cd)]];const _0xe200ad=_0x437a54[_0x192cd7(0x218)](_0x8a63ae=>{return _0x8a63ae={'product_name':_0x8a63ae};});_0x52d1bf[_0x192cd7(0x262)]((_0x386f8e,_0x41d3fc)=>{_0xe200ad[_0x41d3fc]['stock']=_0x386f8e;}),_0xbf19aa[_0x192cd7(0x262)]((_0x260bd0,_0x271345)=>{var _0x4bd7ea=_0x192cd7;_0xe200ad[_0x271345][_0x4bd7ea(0x243)]=_0x260bd0;}),_0x334174[_0x192cd7(0x262)]((_0x387d28,_0x10ff80)=>{var _0xbddc41=_0x192cd7;_0xe200ad[_0x10ff80][_0xbddc41(0x205)]=_0x387d28;}),_0x365c05[_0x192cd7(0x262)]((_0x18b6d4,_0x10262d)=>{var _0x48ba4f=_0x192cd7;_0xe200ad[_0x10262d][_0x48ba4f(0x226)]=_0x18b6d4;}),_0x2c4ffb[_0x192cd7(0x262)]((_0x3eaf05,_0x51a864)=>{var _0x2c7313=_0x192cd7;_0xe200ad[_0x51a864][_0x2c7313(0x268)]=_0x3eaf05;}),_0x2bbb0f['forEach']((_0x155480,_0xb2db6c)=>{var _0x16219b=_0x192cd7;_0xe200ad[_0xb2db6c][_0x16219b(0x2c9)]=_0x155480;}),_0x2e918b[_0x192cd7(0x262)]((_0x23e1d9,_0x2f9b00)=>{_0xe200ad[_0x2f9b00]['expiry_date']=_0x23e1d9;});var _0x4d4e59=0x0;_0xe200ad[_0x192cd7(0x262)](_0x10098a=>{var _0xb3c193=_0x192cd7;console[_0xb3c193(0x266)](_0xb3c193(0x2be),_0x10098a),(parseInt(_0x10098a['stock'])<parseInt(_0x10098a[_0xb3c193(0x243)])||parseInt(_0x10098a[_0xb3c193(0x243)])==0x0)&&_0x4d4e59++;});if(_0x4d4e59!=0x0)return _0x2b0eb7[_0x192cd7(0x1ff)](_0x192cd7(0x1fa),_0x192cd7(0x1cb)),_0x3cef4f['redirect'](_0x192cd7(0x25d));_0x55b1e9[_0x192cd7(0x2a6)][_0x192cd7(0x262)](_0x176101=>{var _0x8ed49c=_0x192cd7;const _0x204366=_0x3feb20['product_details'][_0x8ed49c(0x218)](_0x2bd408=>{var _0x3af40f=_0x8ed49c;_0x2bd408[_0x3af40f(0x26a)]==_0x176101[_0x3af40f(0x26a)]&&_0x2bd408[_0x3af40f(0x204)]==_0x176101[_0x3af40f(0x204)]&&(_0x2bd408[_0x3af40f(0x237)]=parseInt(_0x2bd408[_0x3af40f(0x237)])+parseInt(_0x176101[_0x3af40f(0x243)]));});}),await _0x3feb20[_0x192cd7(0x1d7)]();const _0x5d9310=_0xe200ad['filter'](_0xe8d717=>_0xe8d717[_0x192cd7(0x243)]!=='0'&&_0xe8d717[_0x192cd7(0x243)]!=='');_0x55b1e9[_0x192cd7(0x27b)]=_0xe06e5a,_0x55b1e9[_0x192cd7(0x2ac)]=_0x397bbd,_0x55b1e9[_0x192cd7(0x20f)]=_0x26dcc4,_0x55b1e9[_0x192cd7(0x282)]=_0x2063e0,_0x55b1e9[_0x192cd7(0x2a6)]=_0x5d9310,_0x55b1e9[_0x192cd7(0x208)]=_0x486905,_0x55b1e9['room']=_0x1680b8;const _0x16ef30=await _0x55b1e9[_0x192cd7(0x1d7)](),_0xfabb82=await sales_finished[_0x192cd7(0x259)]({'_id':_0x2b0eb7[_0x192cd7(0x217)]['id']}),_0x4349c0=await warehouse[_0x192cd7(0x259)]({'name':_0x2063e0,'room':_0x1680b8,'warehouse_category':_0x192cd7(0x207)});_0xfabb82[_0x192cd7(0x2a6)]['forEach'](_0x275320=>{var _0x3c6c07=_0x192cd7;const _0x5a6dcc=_0x4349c0[_0x3c6c07(0x1f1)][_0x3c6c07(0x218)](_0x37aa51=>{var _0x26949c=_0x3c6c07;_0x37aa51[_0x26949c(0x26a)]==_0x275320['product_name']&&_0x37aa51[_0x26949c(0x204)]==_0x275320[_0x26949c(0x204)]&&(_0x37aa51[_0x26949c(0x237)]=parseInt(_0x37aa51[_0x26949c(0x237)])-parseInt(_0x275320[_0x26949c(0x243)]));});}),console['log']('final',_0x4349c0),await _0x4349c0[_0x192cd7(0x1d7)]();const _0x17f916=await c_payment_data[_0x192cd7(0x259)]({'invoice':_0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x27b)]});_0x17f916[_0x192cd7(0x1e4)]=_0x2b0eb7[_0x192cd7(0x1da)][_0x192cd7(0x1e4)],await _0x17f916[_0x192cd7(0x1d7)](),_0x2b0eb7[_0x192cd7(0x1ff)]('success',_0x192cd7(0x245)),_0x3cef4f[_0x192cd7(0x256)](_0x192cd7(0x271));}catch(_0x5ed30e){console[_0x192cd7(0x266)](_0x5ed30e);}}),router[a0_0x134f93(0x2bb)](a0_0x134f93(0x221),auth,async(_0x30c367,_0x3ee4ff)=>{var _0x432e7f=a0_0x134f93;try{const _0x30bb27=_0x30c367[_0x432e7f(0x217)]['id'],{invoice:_0x428dcd,customer:_0x12e554,receivable_amount:_0x5060d0,received_amount:_0x2d9774}=_0x30c367[_0x432e7f(0x1da)],_0x1acb18=await sales[_0x432e7f(0x24b)](_0x30bb27);console[_0x432e7f(0x266)](_0x1acb18);var _0x535e81=_0x5060d0-_0x2d9774;console[_0x432e7f(0x266)](_0x2d9774),_0x1acb18[_0x432e7f(0x24f)]=parseFloat(_0x2d9774)+parseFloat(_0x1acb18[_0x432e7f(0x24f)]),_0x1acb18[_0x432e7f(0x1d6)]=_0x535e81,console['log'](_0x1acb18);const _0x1e5b2b=await _0x1acb18[_0x432e7f(0x1d7)](),_0xda91cb=await c_payment_data[_0x432e7f(0x259)]({'invoice':_0x428dcd});_0xda91cb[_0x432e7f(0x1e5)]=_0x535e81,await _0xda91cb['save']();let _0x22fe68=new Date(),_0x5b2917=('0'+_0x22fe68[_0x432e7f(0x29a)]())[_0x432e7f(0x229)](-0x2),_0x5971e2=('0'+(_0x22fe68[_0x432e7f(0x25e)]()+0x1))['slice'](-0x2),_0x27305b=_0x22fe68[_0x432e7f(0x278)](),_0xb370c0=_0x27305b+'-'+_0x5971e2+'-'+_0x5b2917;const _0x2c7eca=new customer_payment({'invoice':_0x428dcd,'date':_0x27305b+'-'+_0x5971e2+'-'+_0x5b2917,'customer':_0x12e554,'reason':_0x432e7f(0x2a7),'amount':_0x2d9774}),_0x2423dc=await _0x2c7eca['save']();_0x30c367[_0x432e7f(0x1ff)](_0x432e7f(0x1ed),'payment\x20successfull'),_0x3ee4ff[_0x432e7f(0x256)]('/all_sales/view');}catch(_0x397c39){console['log'](_0x397c39);}}),router['get'](a0_0x134f93(0x247),auth,async(_0x1650a2,_0x2b9ce9)=>{var _0x1cdb47=a0_0x134f93;try{const {username:_0x6b4814,email:_0x38edf8,role:_0x10c2e9}=_0x1650a2[_0x1cdb47(0x225)],_0x400e6d=_0x1650a2[_0x1cdb47(0x225)],_0x2db64a=await profile[_0x1cdb47(0x259)]({'email':_0x400e6d[_0x1cdb47(0x1cd)]}),_0x4d34b0=await master_shop[_0x1cdb47(0x209)]();console[_0x1cdb47(0x266)](_0x1cdb47(0x1ca),_0x4d34b0);const _0x240c51=_0x1650a2[_0x1cdb47(0x217)]['id'],_0x57b0dc=await sales['findById'](_0x240c51);console[_0x1cdb47(0x266)](_0x57b0dc);const _0x30f7c3=await customer[_0x1cdb47(0x259)]({'name':_0x57b0dc[_0x1cdb47(0x2ac)]});console[_0x1cdb47(0x266)](_0x30f7c3);if(_0x4d34b0[0x0][_0x1cdb47(0x2b7)]=='English\x20(US)'){var _0x38caba=users[_0x1cdb47(0x25a)];console[_0x1cdb47(0x266)](_0x38caba);}else{if(_0x4d34b0[0x0][_0x1cdb47(0x2b7)]==_0x1cdb47(0x232))var _0x38caba=users[_0x1cdb47(0x232)];else{if(_0x4d34b0[0x0][_0x1cdb47(0x2b7)]==_0x1cdb47(0x267))var _0x38caba=users[_0x1cdb47(0x267)];else{if(_0x4d34b0[0x0]['language']==_0x1cdb47(0x294))var _0x38caba=users['Spanish'];else{if(_0x4d34b0[0x0][_0x1cdb47(0x2b7)]==_0x1cdb47(0x1e2))var _0x38caba=users['French'];else{if(_0x4d34b0[0x0][_0x1cdb47(0x2b7)]=='Portuguese\x20(BR)')var _0x38caba=users[_0x1cdb47(0x23f)];else{if(_0x4d34b0[0x0]['language']=='Chinese')var _0x38caba=users[_0x1cdb47(0x252)];else{if(_0x4d34b0[0x0][_0x1cdb47(0x2b7)]==_0x1cdb47(0x2a4))var _0x38caba=users[_0x1cdb47(0x1d4)];}}}}}}}_0x2b9ce9[_0x1cdb47(0x270)](_0x1cdb47(0x212),{'success':_0x1650a2[_0x1cdb47(0x1ff)]('success'),'errors':_0x1650a2[_0x1cdb47(0x1ff)](_0x1cdb47(0x1fa)),'role':_0x400e6d,'profile':_0x2db64a,'master_shop':_0x4d34b0,'customers':_0x30f7c3,'sales':_0x57b0dc,'language':_0x38caba});}catch(_0x4a2098){console[_0x1cdb47(0x266)](_0x4a2098);}}),router[a0_0x134f93(0x264)](a0_0x134f93(0x22d),auth,async(_0x211c5d,_0x525723)=>{var _0x54c7c2=a0_0x134f93;try{const {username:_0xff019f,email:_0x95d612,role:_0x497ede}=_0x211c5d['user'],_0x8de6a8=_0x211c5d[_0x54c7c2(0x225)],_0x49ac14=await profile[_0x54c7c2(0x259)]({'email':_0x8de6a8[_0x54c7c2(0x1cd)]}),_0x7b3f15=await master_shop[_0x54c7c2(0x209)](),_0x39a581=_0x211c5d[_0x54c7c2(0x217)]['id'],_0x3b0bb0=await sales_finished['findById'](_0x39a581),_0x5e0070=await warehouse[_0x54c7c2(0x23d)]([{'$match':{'name':_0x3b0bb0[_0x54c7c2(0x282)]}},{'$unwind':_0x54c7c2(0x299)},{'$group':{'_id':_0x54c7c2(0x2b1),'name':{'$first':_0x54c7c2(0x26b)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x54c7c2(0x2bc)},'bin':{'$first':_0x54c7c2(0x1fd)},'type':{'$first':_0x54c7c2(0x2c1)},'floorlevel':{'$first':_0x54c7c2(0x273)},'primary_code':{'$first':_0x54c7c2(0x297)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x54c7c2(0x23e)},'storage':{'$first':_0x54c7c2(0x240)},'rack':{'$first':_0x54c7c2(0x1c9)},'expiry_date':{'$first':_0x54c7c2(0x2b9)},'production_date':{'$first':_0x54c7c2(0x254)},'unit':{'$first':_0x54c7c2(0x28d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x54c7c2(0x291)},'batch_code':{'$first':_0x54c7c2(0x1d5)},'maxPerUnit':{'$first':_0x54c7c2(0x1dd)}}}]),_0xcbe8ff=await product[_0x54c7c2(0x209)]({}),_0x4dbffa=await warehouse[_0x54c7c2(0x23d)]([{'$match':{'status':_0x54c7c2(0x24a),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x54c7c2(0x265),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':_0x54c7c2(0x289),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);var _0x1d8b90=[_0x54c7c2(0x26e)];const _0x5872af=await warehouse[_0x54c7c2(0x23d)]([{'$match':{'status':_0x54c7c2(0x24a),'name':_0x54c7c2(0x279)}},{'$group':{'_id':'$name','name':{'$first':_0x54c7c2(0x289)}}},{'$sort':{'name':0x1}}]);if(_0x7b3f15[0x0][_0x54c7c2(0x2b7)]==_0x54c7c2(0x239)){var _0x368ae4=users[_0x54c7c2(0x25a)];console[_0x54c7c2(0x266)](_0x368ae4);}else{if(_0x7b3f15[0x0][_0x54c7c2(0x2b7)]=='Hindi')var _0x368ae4=users['Hindi'];else{if(_0x7b3f15[0x0][_0x54c7c2(0x2b7)]==_0x54c7c2(0x267))var _0x368ae4=users[_0x54c7c2(0x267)];else{if(_0x7b3f15[0x0][_0x54c7c2(0x2b7)]==_0x54c7c2(0x294))var _0x368ae4=users[_0x54c7c2(0x294)];else{if(_0x7b3f15[0x0]['language']==_0x54c7c2(0x1e2))var _0x368ae4=users[_0x54c7c2(0x1e2)];else{if(_0x7b3f15[0x0][_0x54c7c2(0x2b7)]=='Portuguese\x20(BR)')var _0x368ae4=users[_0x54c7c2(0x23f)];else{if(_0x7b3f15[0x0][_0x54c7c2(0x2b7)]==_0x54c7c2(0x252))var _0x368ae4=users[_0x54c7c2(0x252)];else{if(_0x7b3f15[0x0][_0x54c7c2(0x2b7)]==_0x54c7c2(0x2a4))var _0x368ae4=users[_0x54c7c2(0x1d4)];}}}}}}}_0x525723['render'](_0x54c7c2(0x224),{'success':_0x211c5d['flash']('success'),'errors':_0x211c5d[_0x54c7c2(0x1ff)](_0x54c7c2(0x1fa)),'role':_0x8de6a8,'profile':_0x49ac14,'user':_0x3b0bb0,'stock':_0x5e0070,'master_shop':_0x7b3f15,'unit':_0xcbe8ff,'language':_0x368ae4,'warehouses':_0x4dbffa,'rooms':_0x1d8b90,'warehouse_QA':_0x5872af});}catch(_0x3413b3){console['log'](_0x3413b3),_0x525723[_0x54c7c2(0x227)](0xc8)['json']({'message':_0x3413b3['message']});}}),router[a0_0x134f93(0x2bb)]('/view/return_sales/:id',auth,async(_0x3994f4,_0x229fd3)=>{var _0x31fd99=a0_0x134f93;if(_0x3994f4[_0x31fd99(0x1da)]['for_categorize']=='QA')try{const {invoice:_0x393b1d,date:_0xdc530d,warehouse_name:_0x10b79f,product_name:_0x50f884,primary_code:_0x174019,secondary_code:_0x263614,product_code:_0x2e938f,sales_quantity:_0x5d9ea7,stocks:_0x51e692,return_qty:_0x2ca06e,Room_name:_0x254b8b,to_warehouse_name_QA:_0x4cc31d,to_Room_name_QA:_0x269345,note:_0x558ac1,for_categorize:_0x4d3ac3,product_name_QA1:_0x39e27f}=_0x3994f4[_0x31fd99(0x1da)];if(typeof _0x39e27f=='string')var _0x5a2761=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2c6)]],_0x4f9ea7=[_0x3994f4['body'][_0x31fd99(0x25b)]],_0x3303cf=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x29d)]],_0x3d5b0d=[_0x3994f4[_0x31fd99(0x1da)]['product_code_QA']],_0x200bc5=[_0x3994f4[_0x31fd99(0x1da)]['sales_quantity_QA']],_0x5e2f22=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x24e)]],_0x39a201=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x255)]],_0x2c64ce=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x28b)]],_0x4d367d=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2d1)]],_0x2c47a1=[_0x3994f4['body'][_0x31fd99(0x2af)]],_0x49afaf=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x288)]],_0x169e0b=[_0x3994f4[_0x31fd99(0x1da)]['unit_QA']],_0x5e8f1d=[_0x3994f4[_0x31fd99(0x1da)]['production_date_QA']],_0x31031e=[_0x3994f4['body'][_0x31fd99(0x2c4)]];else var _0x5a2761=[..._0x3994f4['body'][_0x31fd99(0x2c6)]],_0x4f9ea7=[..._0x3994f4['body'][_0x31fd99(0x25b)]],_0x3303cf=[..._0x3994f4[_0x31fd99(0x1da)]['secondary_code_QA']],_0x3d5b0d=[..._0x3994f4['body'][_0x31fd99(0x1e3)]],_0x200bc5=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x20e)]],_0x5e2f22=[..._0x3994f4[_0x31fd99(0x1da)]['stocks_QA']],_0x39a201=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x255)]],_0x2c64ce=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x28b)]],_0x4d367d=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2d1)]],_0x2c47a1=[..._0x3994f4['body'][_0x31fd99(0x2af)]],_0x49afaf=[..._0x3994f4['body']['secondary_unit_QA']],_0x169e0b=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x21e)]],_0x5e8f1d=[..._0x3994f4['body'][_0x31fd99(0x261)]],_0x31031e=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2c4)]];const _0x3f25dc=_0x5a2761['map'](_0xa8839a=>{return _0xa8839a={'product_name':_0xa8839a};});_0x4f9ea7['forEach']((_0x381474,_0x2abb02)=>{_0x3f25dc[_0x2abb02]['primary_code']=_0x381474;}),_0x3303cf[_0x31fd99(0x262)]((_0x561830,_0x2c1e6e)=>{_0x3f25dc[_0x2c1e6e]['secondary_code']=_0x561830;}),_0x3d5b0d[_0x31fd99(0x262)]((_0x27ca21,_0x112efb)=>{var _0x3925ed=_0x31fd99;_0x3f25dc[_0x112efb][_0x3925ed(0x268)]=_0x27ca21;}),_0x200bc5[_0x31fd99(0x262)]((_0x3f73fe,_0x46079d)=>{var _0x14c24f=_0x31fd99;_0x3f25dc[_0x46079d][_0x14c24f(0x21b)]=_0x3f73fe;}),_0x5e2f22[_0x31fd99(0x262)]((_0x1100e7,_0x57050b)=>{_0x3f25dc[_0x57050b]['stock']=_0x1100e7;}),_0x39a201[_0x31fd99(0x262)]((_0x4cc744,_0x396f6a)=>{var _0x1182fa=_0x31fd99;_0x3f25dc[_0x396f6a][_0x1182fa(0x28e)]=_0x4cc744;}),_0x2c64ce[_0x31fd99(0x262)]((_0x463823,_0x5d4f55)=>{var _0x48337e=_0x31fd99;_0x3f25dc[_0x5d4f55][_0x48337e(0x298)]=_0x463823;}),_0x4d367d[_0x31fd99(0x262)]((_0x10f6d9,_0x549890)=>{_0x3f25dc[_0x549890]['maxProducts']=_0x10f6d9;}),_0x2c47a1[_0x31fd99(0x262)]((_0x2ce260,_0x34b4ab)=>{var _0x24814b=_0x31fd99;_0x3f25dc[_0x34b4ab][_0x24814b(0x2ad)]=_0x2ce260;}),_0x49afaf[_0x31fd99(0x262)]((_0x7bdf43,_0x16db48)=>{var _0x117391=_0x31fd99;_0x3f25dc[_0x16db48][_0x117391(0x2a3)]=_0x7bdf43;}),_0x169e0b[_0x31fd99(0x262)]((_0x2a71f4,_0x4f8016)=>{var _0x4d91b5=_0x31fd99;_0x3f25dc[_0x4f8016][_0x4d91b5(0x26f)]=_0x2a71f4;}),_0x5e8f1d[_0x31fd99(0x262)]((_0x4269e2,_0x3313b4)=>{_0x3f25dc[_0x3313b4]['production_date']=_0x4269e2;}),_0x31031e['forEach']((_0x27de55,_0xe13ac8)=>{var _0x389461=_0x31fd99;_0x3f25dc[_0xe13ac8][_0x389461(0x2cd)]=_0x27de55;});const _0x3ac2f9=await sales_finished[_0x31fd99(0x259)]({'invoice':_0x393b1d});_0x3ac2f9[_0x31fd99(0x277)]=_0x31fd99(0x1ec);const _0xca1331=await _0x3ac2f9[_0x31fd99(0x1d7)](),_0x47fb07=new sales_return_finished({'invoice':_0x393b1d,'customer':_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2ac)],'date':_0xdc530d,'warehouse_name':_0x10b79f,'room':_0x254b8b,'ToWarehouse':_0x4cc31d,'ToRoom':_0x269345,'return_sale_QA':_0x3f25dc,'note':_0x558ac1,'warehouse_cat':_0x4d3ac3}),_0x49780d=await _0x47fb07[_0x31fd99(0x1d7)](),_0x295ffc=await sales_return_finished[_0x31fd99(0x259)]({'invoice':_0x393b1d}),_0xad104b=await warehouse[_0x31fd99(0x259)]({'name':_0x4cc31d,'room':_0x269345});_0x295ffc[_0x31fd99(0x23a)][_0x31fd99(0x262)](_0x31d2e4=>{var _0x1a4ccf=_0x31fd99,_0x4c2f33=0x0;const _0x1d049a=_0xad104b[_0x1a4ccf(0x1f1)][_0x1a4ccf(0x218)](_0x1a5ded=>{var _0x3c64b4=_0x1a4ccf;_0x1a5ded['product_name']==_0x31d2e4[_0x3c64b4(0x26a)]&&_0x1a5ded[_0x3c64b4(0x2cd)]==_0x31d2e4[_0x3c64b4(0x2cd)]&&_0x1a5ded['production_date']==_0x31d2e4['production_date']&&_0x1a5ded['batch_code']==_0x31d2e4[_0x3c64b4(0x2ad)]&&(_0x1a5ded['product_stock']=parseInt(_0x1a5ded[_0x3c64b4(0x237)])+parseInt(_0x31d2e4['return_qty']),_0x4c2f33++);});_0x4c2f33=='0'&&(_0xad104b[_0x1a4ccf(0x1f1)]=_0xad104b[_0x1a4ccf(0x1f1)]['concat']({'product_name':_0x31d2e4[_0x1a4ccf(0x26a)],'product_stock':_0x31d2e4[_0x1a4ccf(0x28e)],'primary_code':_0x31d2e4['primary_code'],'secondary_code':_0x31d2e4[_0x1a4ccf(0x226)],'product_code':_0x31d2e4[_0x1a4ccf(0x268)],'batch_code':_0x31d2e4[_0x1a4ccf(0x2ad)],'maxPerUnit':_0x31d2e4[_0x1a4ccf(0x298)],'production_date':_0x31d2e4[_0x1a4ccf(0x21c)],'expiry_date':_0x31d2e4['expiry_date'],'secondary_unit':_0x31d2e4[_0x1a4ccf(0x2a3)],'unit':_0x31d2e4[_0x1a4ccf(0x26f)],'maxProducts':_0x31d2e4[_0x1a4ccf(0x2ab)],'bay':_0x31d2e4[_0x1a4ccf(0x204)]}));}),await _0xad104b[_0x31fd99(0x1d7)]();const _0x2adfaa=new c_payment_data({'invoice':_0x393b1d,'customer':_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2ac)],'reason':'Sale\x20Return'});await _0x2adfaa[_0x31fd99(0x1d7)]();const _0x5349f1=await master_shop[_0x31fd99(0x209)](),_0x5379d0=await email_settings[_0x31fd99(0x259)](),_0x438055=await customer['findOne']({'name':_0x3994f4[_0x31fd99(0x1da)]['customer']});_0x5349f1[0x0][_0x31fd99(0x244)]==0x1?(right_currency=_0x5349f1[0x0][_0x31fd99(0x263)],left_currency=''):(right_currency='',left_currency=_0x5349f1[0x0][_0x31fd99(0x263)]);var _0x1385c5=_0x5a2761,_0x5321f6=_0x39a201,_0x89aef0='',_0x274d27;for(_0x274d27 in _0x1385c5){_0x89aef0+=_0x31fd99(0x27c)+_0x31fd99(0x20c)+_0x1385c5[_0x274d27]+_0x31fd99(0x220)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5321f6[_0x274d27]+_0x31fd99(0x220)+_0x31fd99(0x235);}console[_0x31fd99(0x266)](_0x31fd99(0x2b0),_0x89aef0);let _0x3548b9=nodemailer[_0x31fd99(0x2a8)]({'service':_0x31fd99(0x1e1),'auth':{'user':_0x5379d0[_0x31fd99(0x1cd)],'pass':_0x5379d0[_0x31fd99(0x281)]}}),_0xbdbceb={'from':_0x5379d0[_0x31fd99(0x1cd)],'to':_0x438055[_0x31fd99(0x1cd)],'subject':_0x31fd99(0x1d8),'attachments':[{'filename':_0x31fd99(0x269),'path':__dirname+_0x31fd99(0x1cf)+_0x31fd99(0x280)+_0x5349f1[0x0][_0x31fd99(0x2ba)],'cid':_0x31fd99(0x1c8)}],'html':_0x31fd99(0x1f8)+_0x31fd99(0x236)+_0x31fd99(0x20a)+_0x31fd99(0x2a9)+_0x31fd99(0x1f0)+_0x31fd99(0x2a9)+_0x31fd99(0x1e6)+_0x31fd99(0x28f)+_0x31fd99(0x2a9)+_0x31fd99(0x2c7)+_0x5349f1[0x0][_0x31fd99(0x248)]+_0x31fd99(0x24d)+_0x31fd99(0x28f)+_0x31fd99(0x28f)+'<hr\x20class=\x22my-3\x22>'+_0x31fd99(0x2a9)+_0x31fd99(0x213)+_0x31fd99(0x21f)+_0x393b1d+'\x20'+_0x31fd99(0x210)+'\x20Order\x20Date\x20:\x20'+_0xdc530d+'\x20'+_0x31fd99(0x22c)+_0x31fd99(0x2b3)+_0x31fd99(0x28f)+_0x31fd99(0x1df)+_0x31fd99(0x1dc)+_0x31fd99(0x27c)+_0x31fd99(0x29f)+_0x31fd99(0x20b)+_0x31fd99(0x276)+_0x31fd99(0x25f)+_0x31fd99(0x235)+_0x31fd99(0x1c0)+_0x31fd99(0x22f)+'\x20'+_0x89aef0+'\x20'+'</tbody>'+_0x31fd99(0x230)+_0x31fd99(0x2a9)+_0x31fd99(0x2a0)+_0x31fd99(0x2d4)+_0x5349f1[0x0][_0x31fd99(0x248)]+_0x31fd99(0x2b3)+_0x31fd99(0x28f)+'</div>'+'</body></html>'};_0x3548b9[_0x31fd99(0x1fc)](_0xbdbceb,function(_0xcbf2da,_0x2f9ee3){var _0x334f8d=_0x31fd99;_0xcbf2da?(console[_0x334f8d(0x266)](_0xcbf2da),console[_0x334f8d(0x266)](_0x334f8d(0x1e8))):console[_0x334f8d(0x266)](_0x334f8d(0x258));}),_0x3994f4[_0x31fd99(0x1ff)](_0x31fd99(0x1ed),_0x31fd99(0x2c3)),_0x229fd3['redirect'](_0x31fd99(0x271));}catch(_0x4c59c9){_0x229fd3[_0x31fd99(0x227)](0xc8)[_0x31fd99(0x26c)]({'message1':_0x4c59c9[_0x31fd99(0x1c1)]});}else{if(_0x3994f4['body']['for_categorize']=='GS')try{const {invoice:_0x583e24,date:_0x28ced4,warehouse_name:_0x21523f,product_name:_0x1f496b,primary_code:_0xdc7478,secondary_code:_0x5617c9,product_code:_0x5c6f70,sales_quantity:_0x168d97,stocks:_0x4e841f,return_qty:_0x408708,Room_name:_0x2cd9cb,to_warehouse_name:_0x479b55,to_Room_name:_0x24b904,note:_0x432a26,level:_0x42f16b,isle:_0x10721a,pallet:_0x37666e,for_categorize:_0x37350d}=_0x3994f4[_0x31fd99(0x1da)];if(typeof _0x1f496b==_0x31fd99(0x2c5))var _0x5a2761=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x26a)]],_0x4f9ea7=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x205)]],_0x3303cf=[_0x3994f4[_0x31fd99(0x1da)]['secondary_code']],_0x3d5b0d=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x268)]],_0x200bc5=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x1d0)]],_0x39a201=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x28e)]],_0x41b857=[_0x3994f4['body']['bay']],_0x2c64ce=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x298)]],_0x4d367d=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2ab)]],_0x2c47a1=[_0x3994f4[_0x31fd99(0x1da)]['batch_code']],_0x49afaf=[_0x3994f4['body'][_0x31fd99(0x2a3)]],_0x169e0b=[_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x26f)]],_0x5e8f1d=[_0x3994f4['body']['production_date']],_0x31031e=[_0x3994f4[_0x31fd99(0x1da)]['expiry_date']];else var _0x5a2761=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x26a)]],_0x4f9ea7=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x205)]],_0x3303cf=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x226)]],_0x3d5b0d=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x268)]],_0x200bc5=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x1d0)]],_0x39a201=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x28e)]],_0x41b857=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x204)]],_0x2c64ce=[..._0x3994f4['body'][_0x31fd99(0x298)]],_0x4d367d=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2ab)]],_0x2c47a1=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2ad)]],_0x49afaf=[..._0x3994f4['body'][_0x31fd99(0x2a3)]],_0x169e0b=[..._0x3994f4[_0x31fd99(0x1da)]['unit']],_0x5e8f1d=[..._0x3994f4[_0x31fd99(0x1da)]['production_date']],_0x31031e=[..._0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2cd)]];const _0x1af14e=_0x5a2761[_0x31fd99(0x218)](_0xef53fd=>{return _0xef53fd={'product_name':_0xef53fd};});_0x4f9ea7[_0x31fd99(0x262)]((_0x342a4b,_0x496064)=>{_0x1af14e[_0x496064]['primary_code']=_0x342a4b;}),_0x3303cf[_0x31fd99(0x262)]((_0x22594b,_0x4330c7)=>{var _0x52fa7d=_0x31fd99;_0x1af14e[_0x4330c7][_0x52fa7d(0x226)]=_0x22594b;}),_0x3d5b0d[_0x31fd99(0x262)]((_0x4a3702,_0x43741f)=>{_0x1af14e[_0x43741f]['product_code']=_0x4a3702;}),_0x200bc5[_0x31fd99(0x262)]((_0x4426af,_0x499f1c)=>{var _0x51800a=_0x31fd99;_0x1af14e[_0x499f1c][_0x51800a(0x21b)]=_0x4426af;}),_0x39a201[_0x31fd99(0x262)]((_0x47a7cf,_0x574a43)=>{var _0x5ae11f=_0x31fd99;_0x1af14e[_0x574a43][_0x5ae11f(0x28e)]=_0x47a7cf;}),_0x41b857[_0x31fd99(0x262)]((_0x388ec0,_0x146631)=>{var _0x2dd279=_0x31fd99;_0x1af14e[_0x146631][_0x2dd279(0x204)]=_0x388ec0;}),_0x2c64ce[_0x31fd99(0x262)]((_0x462a84,_0x1f2d86)=>{var _0x2b3367=_0x31fd99;_0x1af14e[_0x1f2d86][_0x2b3367(0x298)]=_0x462a84;}),_0x4d367d[_0x31fd99(0x262)]((_0x37cadc,_0xb0328b)=>{_0x1af14e[_0xb0328b]['maxProducts']=_0x37cadc;}),_0x2c47a1[_0x31fd99(0x262)]((_0x1a8c5f,_0x3d93da)=>{var _0x20a926=_0x31fd99;_0x1af14e[_0x3d93da][_0x20a926(0x2ad)]=_0x1a8c5f;}),_0x49afaf[_0x31fd99(0x262)]((_0x229b6e,_0x2f914c)=>{_0x1af14e[_0x2f914c]['secondary_unit']=_0x229b6e;}),_0x169e0b[_0x31fd99(0x262)]((_0x2ffb0d,_0x58b7fa)=>{var _0x1456e4=_0x31fd99;_0x1af14e[_0x58b7fa][_0x1456e4(0x26f)]=_0x2ffb0d;}),_0x5e8f1d[_0x31fd99(0x262)]((_0x5e0ad2,_0x559145)=>{var _0x4390c2=_0x31fd99;_0x1af14e[_0x559145][_0x4390c2(0x21c)]=_0x5e0ad2;}),_0x31031e['forEach']((_0x4d876b,_0x2f6283)=>{_0x1af14e[_0x2f6283]['expiry_date']=_0x4d876b;});var _0x3b46c5=0x0;_0x1af14e['forEach'](_0x1ca5bc=>{var _0x5d05fc=_0x31fd99;(parseInt(_0x1ca5bc[_0x5d05fc(0x21b)])<parseInt(_0x1ca5bc[_0x5d05fc(0x28e)])||parseInt(_0x1ca5bc[_0x5d05fc(0x201)])<parseInt(_0x1ca5bc['return_qty'])&&parseInt(_0x1ca5bc[_0x5d05fc(0x21b)])>parseInt(_0x1ca5bc[_0x5d05fc(0x28e)])||parseInt(_0x1ca5bc[_0x5d05fc(0x28e)])==0x0)&&_0x3b46c5++;});if(_0x3b46c5!=0x0)return _0x3994f4['flash'](_0x31fd99(0x1fa),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x229fd3[_0x31fd99(0x256)](_0x31fd99(0x25d));const _0x3e6139=await sales_finished['findOne']({'invoice':_0x583e24});_0x3e6139[_0x31fd99(0x277)]=_0x31fd99(0x1ec);const _0x14bad0=await _0x3e6139[_0x31fd99(0x1d7)](),_0x1f2a4f=new sales_return_finished({'invoice':_0x583e24,'customer':_0x3994f4['body'][_0x31fd99(0x2ac)],'date':_0x28ced4,'warehouse_name':_0x21523f,'room':_0x2cd9cb,'ToWarehouse':_0x479b55,'ToRoom':_0x24b904,'return_sale':_0x1af14e,'note':_0x432a26,'warehouse_cat':_0x37350d}),_0x4d1d75=await _0x1f2a4f['save'](),_0x316ac9=await sales_return_finished[_0x31fd99(0x259)]({'invoice':_0x583e24}),_0x310210=await warehouse[_0x31fd99(0x259)]({'name':_0x479b55,'room':_0x24b904,'warehouse_category':'Finished\x20Goods'});_0x316ac9[_0x31fd99(0x223)][_0x31fd99(0x262)](_0x3dea66=>{var _0x4d39e0=_0x31fd99,_0x377472=0x0;const _0x9363ff=_0x310210[_0x4d39e0(0x1f1)][_0x4d39e0(0x218)](_0x337137=>{var _0x15e743=_0x4d39e0;_0x337137[_0x15e743(0x26a)]==_0x3dea66[_0x15e743(0x26a)]&&_0x337137[_0x15e743(0x204)]==_0x3dea66[_0x15e743(0x204)]&&_0x337137[_0x15e743(0x2cd)]==_0x3dea66[_0x15e743(0x2cd)]&&_0x337137[_0x15e743(0x21c)]==_0x3dea66[_0x15e743(0x21c)]&&_0x337137['batch_code']==_0x3dea66[_0x15e743(0x2ad)]&&(_0x337137[_0x15e743(0x237)]=parseInt(_0x337137['product_stock'])+parseInt(_0x3dea66['return_qty']),_0x377472++);});_0x377472=='0'&&(_0x310210[_0x4d39e0(0x1f1)]=_0x310210[_0x4d39e0(0x1f1)][_0x4d39e0(0x28c)]({'product_name':_0x3dea66['product_name'],'product_stock':_0x3dea66['return_qty'],'primary_code':_0x3dea66[_0x4d39e0(0x205)],'secondary_code':_0x3dea66[_0x4d39e0(0x226)],'product_code':_0x3dea66[_0x4d39e0(0x268)],'bay':_0x3dea66['bay'],'batch_code':_0x3dea66[_0x4d39e0(0x2ad)],'maxPerUnit':_0x3dea66[_0x4d39e0(0x298)],'production_date':_0x3dea66[_0x4d39e0(0x21c)],'expiry_date':_0x3dea66[_0x4d39e0(0x2cd)],'secondary_unit':_0x3dea66[_0x4d39e0(0x2a3)],'unit':_0x3dea66[_0x4d39e0(0x26f)],'maxProducts':_0x3dea66[_0x4d39e0(0x2ab)]}));}),await _0x310210[_0x31fd99(0x1d7)](),console[_0x31fd99(0x266)](_0x3994f4[_0x31fd99(0x1da)]);const _0x575194=new c_payment_data({'invoice':_0x583e24,'customer':_0x3994f4[_0x31fd99(0x1da)]['customer'],'reason':_0x31fd99(0x1ce)});await _0x575194[_0x31fd99(0x1d7)]();const _0x439761=await master_shop[_0x31fd99(0x209)]();console[_0x31fd99(0x266)](_0x31fd99(0x2d0),_0x439761[0x0]['image']);const _0x498792=await email_settings[_0x31fd99(0x259)](),_0x200c83=await customer['findOne']({'name':_0x3994f4[_0x31fd99(0x1da)][_0x31fd99(0x2ac)]});console['log']('customer_data',_0x200c83);_0x439761[0x0][_0x31fd99(0x244)]==0x1?(right_currency=_0x439761[0x0][_0x31fd99(0x263)],left_currency=''):(right_currency='',left_currency=_0x439761[0x0][_0x31fd99(0x263)]);var _0x1385c5=_0x5a2761,_0x5321f6=_0x39a201,_0x89aef0='',_0x274d27;for(_0x274d27 in _0x1385c5){_0x89aef0+=_0x31fd99(0x27c)+_0x31fd99(0x20c)+_0x1385c5[_0x274d27]+'</td>'+_0x31fd99(0x20c)+_0x5321f6[_0x274d27]+_0x31fd99(0x220)+_0x31fd99(0x235);}console[_0x31fd99(0x266)](_0x31fd99(0x2b0),_0x89aef0);let _0x4e373e=nodemailer[_0x31fd99(0x2a8)]({'service':_0x31fd99(0x1e1),'auth':{'user':_0x498792[_0x31fd99(0x1cd)],'pass':_0x498792[_0x31fd99(0x281)]}}),_0xc02d98={'from':_0x498792[_0x31fd99(0x1cd)],'to':_0x200c83['email'],'subject':_0x31fd99(0x1d8),'attachments':[{'filename':_0x31fd99(0x269),'path':__dirname+_0x31fd99(0x1cf)+'/upload/'+_0x439761[0x0][_0x31fd99(0x2ba)],'cid':_0x31fd99(0x1c8)}],'html':_0x31fd99(0x1f8)+_0x31fd99(0x236)+_0x31fd99(0x20a)+'<div>'+_0x31fd99(0x1f0)+_0x31fd99(0x2a9)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+_0x31fd99(0x2c7)+_0x439761[0x0]['site_title']+'\x20</h2>'+'</div>'+_0x31fd99(0x28f)+_0x31fd99(0x29e)+'<div>'+_0x31fd99(0x213)+_0x31fd99(0x21f)+_0x583e24+'\x20'+_0x31fd99(0x210)+'\x20Order\x20Date\x20:\x20'+_0x28ced4+'\x20'+'</span>'+_0x31fd99(0x2b3)+_0x31fd99(0x28f)+_0x31fd99(0x1df)+_0x31fd99(0x1dc)+_0x31fd99(0x27c)+_0x31fd99(0x29f)+_0x31fd99(0x20b)+_0x31fd99(0x276)+_0x31fd99(0x25f)+_0x31fd99(0x235)+_0x31fd99(0x1c0)+_0x31fd99(0x22f)+'\x20'+_0x89aef0+'\x20'+'</tbody>'+'</table>'+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x31fd99(0x2d4)+_0x439761[0x0][_0x31fd99(0x248)]+_0x31fd99(0x2b3)+_0x31fd99(0x28f)+_0x31fd99(0x28f)+'</body></html>'};_0x4e373e[_0x31fd99(0x1fc)](_0xc02d98,function(_0x419f54,_0x3fcea6){var _0x179baf=_0x31fd99;_0x419f54?(console[_0x179baf(0x266)](_0x419f54),console['log']('Error\x20Occurs')):console[_0x179baf(0x266)]('Email\x20sent\x20successfully');}),_0x3994f4['flash'](_0x31fd99(0x1ed),_0x31fd99(0x2c3)),_0x229fd3['redirect'](_0x31fd99(0x271));}catch(_0x58314a){console[_0x31fd99(0x266)](_0x58314a),_0x229fd3[_0x31fd99(0x227)](0xc8)[_0x31fd99(0x26c)]({'message1':_0x58314a[_0x31fd99(0x1c1)]});}}}),router['get'](a0_0x134f93(0x219),auth,async(_0x22cf94,_0x5050a9)=>{var _0x53f318=a0_0x134f93;try{const {username:_0x11e907,email:_0x438fd2,role:_0x6ed1ee}=_0x22cf94[_0x53f318(0x225)],_0x212e12=_0x22cf94['user'],_0x6a5933=await profile[_0x53f318(0x259)]({'email':_0x212e12['email']}),_0x1d7624=await master_shop['find']();console[_0x53f318(0x266)](_0x53f318(0x2b2),_0x1d7624);const _0x5c9f63=_0x22cf94['params']['id'],_0x32695c=await sales['findById'](_0x5c9f63);console['log'](_0x53f318(0x2ca),_0x32695c);if(_0x1d7624[0x0][_0x53f318(0x2b7)]==_0x53f318(0x239))var _0x5e210c=users['English'];else{if(_0x1d7624[0x0][_0x53f318(0x2b7)]==_0x53f318(0x232))var _0x5e210c=users['Hindi'];else{if(_0x1d7624[0x0]['language']=='German')var _0x5e210c=users[_0x53f318(0x267)];else{if(_0x1d7624[0x0]['language']=='Spanish')var _0x5e210c=users[_0x53f318(0x294)];else{if(_0x1d7624[0x0][_0x53f318(0x2b7)]=='French')var _0x5e210c=users['French'];else{if(_0x1d7624[0x0][_0x53f318(0x2b7)]==_0x53f318(0x27f))var _0x5e210c=users[_0x53f318(0x23f)];else{if(_0x1d7624[0x0][_0x53f318(0x2b7)]==_0x53f318(0x252))var _0x5e210c=users['Chinese'];else{if(_0x1d7624[0x0]['language']==_0x53f318(0x2a4))var _0x5e210c=users[_0x53f318(0x1d4)];}}}}}}}_0x5050a9[_0x53f318(0x270)](_0x53f318(0x238),{'success':_0x22cf94[_0x53f318(0x1ff)](_0x53f318(0x1ed)),'errors':_0x22cf94[_0x53f318(0x1ff)](_0x53f318(0x1fa)),'role':_0x212e12,'profile':_0x6a5933,'alldata':_0x32695c,'master_shop':_0x1d7624,'language':_0x5e210c});}catch(_0x3da3ff){console[_0x53f318(0x266)](_0x3da3ff);}}),router[a0_0x134f93(0x2bb)]('/barcode_scanner',async(_0x3c4c37,_0x51b470)=>{var _0x3c2950=a0_0x134f93;const {product_code:_0x3c0891,warehouse_name:_0x4d7785,rooms_data:_0xc6860f,Roomslist:_0xdd9795}=_0x3c4c37[_0x3c2950(0x1da)],_0x4ef02d=_0xdd9795[_0x3c2950(0x203)](','),_0x78be1b=[];async function _0x5bb5ea(_0x51f3c3){var _0xaa70fe=_0x3c2950;const _0x5a71f4=await warehouse[_0xaa70fe(0x23d)]([{'$match':{'name':_0x4d7785,'room':_0x51f3c3}},{'$unwind':_0xaa70fe(0x299)},{'$match':{'product_details.primary_code':_0x3c0891}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xaa70fe(0x1c5)},'primary_code':{'$first':_0xaa70fe(0x297)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xaa70fe(0x23e)},'level':{'$first':_0xaa70fe(0x2bc)},'isle':{'$first':_0xaa70fe(0x1fd)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0xaa70fe(0x273)},'unit':{'$first':_0xaa70fe(0x28d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0xaa70fe(0x240)},'rack':{'$first':_0xaa70fe(0x1c9)},'expiry_date':{'$first':_0xaa70fe(0x2b9)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0xaa70fe(0x1dd)},'batch_code':{'$first':_0xaa70fe(0x1d5)},'product_cat':{'$first':_0xaa70fe(0x250)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0xaa70fe(0x295)},'invoice':{'$first':'$product_details.invoice'}}}]),_0xf61e7a=await warehouse['aggregate']([{'$match':{'name':_0x4d7785,'room':_0x51f3c3}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3c0891}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xaa70fe(0x26b)},'product_stock':{'$first':_0xaa70fe(0x1c5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xaa70fe(0x200)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0xaa70fe(0x2bc)},'isle':{'$first':_0xaa70fe(0x1fd)},'type':{'$first':_0xaa70fe(0x2c1)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0xaa70fe(0x28d)},'secondary_unit':{'$first':_0xaa70fe(0x21a)},'storage':{'$first':_0xaa70fe(0x240)},'rack':{'$first':_0xaa70fe(0x1c9)},'expiry_date':{'$first':_0xaa70fe(0x2b9)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0xaa70fe(0x1dd)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0xaa70fe(0x250)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x5a71f4[_0xaa70fe(0x2c8)]>0x0)_0x78be1b[_0xaa70fe(0x242)](_0x5a71f4);else _0xf61e7a[_0xaa70fe(0x2c8)]>0x0&&_0x78be1b[_0xaa70fe(0x242)](_0xf61e7a);}const _0x187eb3=_0x4ef02d['map'](_0x3d33e1=>_0x5bb5ea(_0x3d33e1));await Promise[_0x3c2950(0x234)](_0x187eb3),_0x51b470['json'](_0x78be1b);}),module['exports']=router;