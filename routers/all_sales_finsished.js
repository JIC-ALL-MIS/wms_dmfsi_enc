var a0_0x298c51=a0_0x37b7;function a0_0x37b7(_0x2cb154,_0x1998a7){var _0x7f2b4f=a0_0x7f2b();return a0_0x37b7=function(_0x37b713,_0x337ea3){_0x37b713=_0x37b713-0x16c;var _0x28266e=_0x7f2b4f[_0x37b713];return _0x28266e;},a0_0x37b7(_0x2cb154,_0x1998a7);}(function(_0x54b681,_0x14d861){var _0x2342b7=a0_0x37b7,_0x553d27=_0x54b681();while(!![]){try{var _0x1c5e0f=-parseInt(_0x2342b7(0x1f0))/0x1*(-parseInt(_0x2342b7(0x289))/0x2)+parseInt(_0x2342b7(0x232))/0x3+parseInt(_0x2342b7(0x191))/0x4*(parseInt(_0x2342b7(0x24d))/0x5)+-parseInt(_0x2342b7(0x198))/0x6+-parseInt(_0x2342b7(0x1d3))/0x7*(-parseInt(_0x2342b7(0x1db))/0x8)+-parseInt(_0x2342b7(0x1ea))/0x9*(-parseInt(_0x2342b7(0x1f6))/0xa)+parseInt(_0x2342b7(0x1d5))/0xb*(-parseInt(_0x2342b7(0x20c))/0xc);if(_0x1c5e0f===_0x14d861)break;else _0x553d27['push'](_0x553d27['shift']());}catch(_0x5610a6){_0x553d27['push'](_0x553d27['shift']());}}}(a0_0x7f2b,0xb2d82));function a0_0x7f2b(){var _0x2c3278=['maxPerUnit_QA','maxperunit','render','logo','$product_details.product_name','secondary_unit_QA','<h5\x20style=\x22text-align:\x20left;\x22>','product','Email\x20sent\x20successfully','sales_quantity','language','20741lTLGkb','Arabic\x20(ae)','55vcWOpF','/all_sales_finished/view','SPMX','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','toString','stocks_QA','256aviRWO','barcode\x20Product\x20master','post','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.secondary_code','False','primary_unit','OUT-','$sale_product.extenders_spmx','$product_details_spmx.curing_spmx','edit_sales_finished','currency','stock_data','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','1655307cPSgnv','sendMail','prod_cat','product_name','$date','product_list','198977LsVocc','push','$product.product_name','$product_details.batch_code','Chinese','findById','40Icnvlz','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','params','/view/add_sales_spmx','batch_code_QA','Finished\x20Goods','</thead>','return_qty','prod_invoice','getDate','$product_details._id','$_id','sales\x20item\x20return\x20successfull','<!DOCTYPE\x20html>','/all_sales_finished/view_sales_spmx/','bay','</div>','$product_details.product_cat','product_code_QA','secondary_unit','extenders_spmx_qty_stock','createTransport','4465128LxgaXG','/view/add_sales','_id','$product_details_spmx.curing_spmx_qty','padStart','$sale_product.floorlevel','$warehouse_name','purchases_data','then','flash','site_title','Quality\x20Inspection','$sale_product.spicemix_spmx_qty','An\x20error\x20occurred.','email','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','add_sales_finished_spmx','success','$sale_product.product_code','product_name_QA1','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Received\x20Payment\x20For\x20Sale','$product','json','\x20<>\x20','add_sales_finished','$name','foreach\x20newproduct','/../public','$product_details_spmx.brand_spmx','$product_details_spmx','Portuguese','/all_sales/view','Sales\x20Mail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.maxProducts','2221011MhaBAS','return_data','../middleware/auth','Portuguese\x20(BR)','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','finalize','$return_data','save','secondary_code_QA','extenders_spmx_qty','currency_placement','/preview/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','room','final','unit_spmx','/view','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<strong>\x20Regards\x20</strong>','$product_details_spmx.category_spmx','warehouse','out_going_id','An\x20error\x20occurred\x20while\x20saving\x20data.','Sales\x20Update\x20successfully','$room','$product_details.bay','Router','85KdGbzb','$product_details_spmx.extenders_spmx_qty','$product_details.room_name','$product_details_spmx._id','prod_code','sale_qty','$sale_product.curing_spmx','True','brand_spmx','customer','message','carton','DRY\x20GOODS','German','port','map','Outgoing\x20Successfully\x20Added\x20but\x20not\x20Finalized','/invoice/:id','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details_spmx.extenders_spmx','sales_quantity_QA','curing_spmx_qty_stock','$product_details.primary_code','production_date','/upload/','all_sales_finished','invoice_init','FGSEmail','for_categorize','table\x20page','</td>','spicemix_spmx_qty_stock','../models/all_models','body','$product_details_spmx.spicemix_spmx','production_date_QA','getMonth','\x20Order\x20Date\x20:\x20','French','add\x20post','OUTF-','Enclosed','$sale_product.bin','password','\x20Order\x20Number\x20:\x20','suppliers','$finalize','concat','updateOne','warehouse_name','product_code','find','image','Return\x20Goods','<tbody\x20style=\x22text-align:\x20center;\x22>','unit','primary_code_QA','$product_details.product_code','slice','</tr>','8MvDwEs','back','error','getFullYear','</span>','/barcode_scanner_spmx','findOne','$sale_product.spicemix_spmx','room_spmx','id_transaction_from','level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','user','Error\x20Occurs','incoming_invoice','abs','../public/language/languages.json','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$product_details.secondary_unit','all_sales_finished_spmx','length','extenders_spmx','$product_details.rack','redirect','room_name','maxProducts','spicemix_spmx_qty','curing_spmx','Enabled','date_data','$sale_product','nodemailer','$sale_product.extenders_spmx_qty','master','QA\x20Warehouse','product_details','product_data','aggregate','host','Logo.png','</head><body>','</body></html>','<html><head><title></title>','$sale_product.bay','Arabic','/picking_list/pdf/','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.production_date','return_sale_finished','$sale_product.quantity','sale_product','filter','forEach','expiry_date','/give_payment/:id','$product_details.product_stock','Sale','$product_details.unit','max','<h5>','maxPerUnit','/view/return_sales/:id','return_sale_QA','edit_sales_finished_view','product_stock','spicemix_spmx','date','/view/add_sales/:id','Ambient','/view/:id','</h5>','</tbody>','batch_code','<tr>','$customer','stock','product_details_spmx','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details_spmx.product_code','$invoice','catch','<div>','$product_details.bin','344096VYMpDd','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','due_amount','RoomAssigned','/view/add_sale/product','$sale_product.room_spmx','$product_details_spmx.unit_spmx','7416870Jzknek','quantity','return_qty_QA','unit_QA','received_amount','$product_details.invoice','invoice','Sale\x20Return\x20Mail','adjust_qty','/view_sales_spmx/:id','$sale_product.type','$product_details_spmx.inv_incoming','$product_details.storage','$product_details','/process/:id','\x20</h2>','connect-flash','</table>','out_invoice','Hindi','errors','get','all','$product_details.expiry_date','status','secondary_code','maxProducts_QA','log','$note','English\x20(US)','<hr\x20class=\x22my-3\x22>','amount','payment\x20successfull','category_spmx','gmail','split','string','<span\x20style=\x22float:\x20right;\x22>','primary_code','$product_details.maxPerUnit','<h2>\x20','staff','English','/barcode/:id','max_per_unit','curing_spmx_qty','role','Spanish'];a0_0x7f2b=function(){return _0x2c3278;};return a0_0x7f2b();}const express=require('express'),app=express(),router=express[a0_0x298c51(0x24c)](),{profile,master_shop,sales_spmx,invoice_for_outgoing,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x298c51(0x26d)),auth=require(a0_0x298c51(0x234)),nodemailer=require(a0_0x298c51(0x2a8)),users=require(a0_0x298c51(0x299)),e=require(a0_0x298c51(0x1a8));router[a0_0x298c51(0x1ad)]('/view_spmx',auth,async(_0x2c991b,_0x225ed7)=>{var _0x35943f=a0_0x298c51;try{const {username:_0xb18a76,email:_0x2447e2,role:_0x2026da}=_0x2c991b[_0x35943f(0x295)],_0x5b336c=_0x2c991b[_0x35943f(0x295)],_0x2b4019=await profile[_0x35943f(0x28f)]({'email':_0x5b336c[_0x35943f(0x21a)]}),_0x417830=await staff[_0x35943f(0x28f)]({'email':_0x5b336c[_0x35943f(0x21a)]});if(_0x5b336c[_0x35943f(0x1c6)]==_0x35943f(0x1c1)){const _0x2eb458=await staff[_0x35943f(0x28f)]({'email':_0x5b336c[_0x35943f(0x21a)]});}const _0x4eecaf=await master_shop['find'](),_0x3f9053=await sales_spmx[_0x35943f(0x2ae)]([{'$unwind':'$sale_product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x35943f(0x18d)},'date':{'$first':_0x35943f(0x1ee)},'finalize':{'$first':_0x35943f(0x27b)},'warehouse_name':{'$first':_0x35943f(0x212)},'room_spmx':{'$addToSet':_0x35943f(0x196)},'sale_product':{'$push':_0x35943f(0x2a7)},'note':{'$first':_0x35943f(0x1b4)},'spicemix_spmx_qty':{'$sum':_0x35943f(0x218)},'extenders_spmx_qty':{'$sum':_0x35943f(0x2a9)},'curing_spmx_qty':{'$sum':'$sale_product.curing_spmx_qty'},'spicemix_spmx':{'$addToSet':_0x35943f(0x290)},'extenders_spmx':{'$addToSet':_0x35943f(0x1e4)},'curing_spmx':{'$addToSet':_0x35943f(0x253)},'product_code':{'$addToSet':_0x35943f(0x21f)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'warehouse_name':0x1,'room_spmx':0x1,'sale_product':0x1,'note':0x1,'spicemix_spmx_qty':0x1,'extenders_spmx_qty':0x1,'curing_spmx_qty':0x1,'spicemix_spmx':0x1,'extenders_spmx':0x1,'curing_spmx':0x1,'product_code':0x1,'finalize':0x1}}]);if(_0x4eecaf[0x0]['language']=='English\x20(US)')var _0x35267c=users[_0x35943f(0x1c2)];else{if(_0x4eecaf[0x0]['language']==_0x35943f(0x1ab))var _0x35267c=users[_0x35943f(0x1ab)];else{if(_0x4eecaf[0x0][_0x35943f(0x1d2)]=='German')var _0x35267c=users[_0x35943f(0x25a)];else{if(_0x4eecaf[0x0][_0x35943f(0x1d2)]==_0x35943f(0x1c7))var _0x35267c=users[_0x35943f(0x1c7)];else{if(_0x4eecaf[0x0][_0x35943f(0x1d2)]==_0x35943f(0x273))var _0x35267c=users[_0x35943f(0x273)];else{if(_0x4eecaf[0x0]['language']==_0x35943f(0x235))var _0x35267c=users[_0x35943f(0x22c)];else{if(_0x4eecaf[0x0]['language']==_0x35943f(0x1f4))var _0x35267c=users[_0x35943f(0x1f4)];else{if(_0x4eecaf[0x0][_0x35943f(0x1d2)]==_0x35943f(0x1d4))var _0x35267c=users['Arabic'];}}}}}}}_0x225ed7[_0x35943f(0x1ca)](_0x35943f(0x29c),{'success':_0x2c991b['flash'](_0x35943f(0x21e)),'errors':_0x2c991b[_0x35943f(0x215)](_0x35943f(0x1ac)),'data':_0x3f9053,'role':_0x5b336c,'profile':_0x2b4019,'master_shop':_0x4eecaf,'language':_0x35267c});}catch(_0x31bde1){console[_0x35943f(0x1b3)](_0x35943f(0x26a),_0x31bde1),_0x225ed7[_0x35943f(0x1b0)](0xc8)['json']({'message':_0x31bde1['message']});}}),router['get']('/view/add_sales_spmx',auth,async(_0x905f82,_0x5f5342)=>{var _0x19416b=a0_0x298c51;try{const {username:_0x676ae8,email:_0xe257f6,role:_0x2e0bf0}=_0x905f82[_0x19416b(0x295)],_0x59176e=_0x905f82[_0x19416b(0x295)],_0x4e1801=await profile[_0x19416b(0x28f)]({'email':_0x59176e[_0x19416b(0x21a)]}),_0x3b08b3=await staff[_0x19416b(0x28f)]({'email':_0x59176e['email']});if(_0x59176e[_0x19416b(0x1c6)]==_0x19416b(0x1c1)){const _0x18ac9e=await staff[_0x19416b(0x28f)]({'email':_0x59176e[_0x19416b(0x21a)]});}const _0x8f4b20=await warehouse[_0x19416b(0x2ae)]([{'$match':{'status':_0x19416b(0x2a5),'warehouse_category':_0x19416b(0x1d7),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x19416b(0x227),'name':{'$first':_0x19416b(0x227)}}}]),_0x1f2728=await master_shop[_0x19416b(0x280)]();if(_0x1f2728[0x0][_0x19416b(0x1d2)]==_0x19416b(0x1b5))var _0x2cec21=users[_0x19416b(0x1c2)];else{if(_0x1f2728[0x0]['language']==_0x19416b(0x1ab))var _0x2cec21=users[_0x19416b(0x1ab)];else{if(_0x1f2728[0x0][_0x19416b(0x1d2)]==_0x19416b(0x25a))var _0x2cec21=users[_0x19416b(0x25a)];else{if(_0x1f2728[0x0][_0x19416b(0x1d2)]==_0x19416b(0x1c7))var _0x2cec21=users['Spanish'];else{if(_0x1f2728[0x0][_0x19416b(0x1d2)]==_0x19416b(0x273))var _0x2cec21=users['French'];else{if(_0x1f2728[0x0][_0x19416b(0x1d2)]==_0x19416b(0x235))var _0x2cec21=users['Portuguese'];else{if(_0x1f2728[0x0][_0x19416b(0x1d2)]==_0x19416b(0x1f4))var _0x2cec21=users[_0x19416b(0x1f4)];else{if(_0x1f2728[0x0][_0x19416b(0x1d2)]==_0x19416b(0x1d4))var _0x2cec21=users[_0x19416b(0x2b5)];}}}}}}}_0x5f5342[_0x19416b(0x1ca)](_0x19416b(0x21d),{'success':_0x905f82['flash'](_0x19416b(0x21e)),'errors':_0x905f82[_0x19416b(0x215)](_0x19416b(0x1ac)),'role':_0x59176e,'profile':_0x4e1801,'master_shop':_0x1f2728,'warehouse':_0x8f4b20,'language':_0x2cec21});}catch(_0x40bbff){console[_0x19416b(0x1b3)](_0x19416b(0x26a),_0x40bbff),_0x5f5342[_0x19416b(0x1b0)](0xc8)[_0x19416b(0x224)]({'message':_0x40bbff['message']});}}),router[a0_0x298c51(0x1dd)](a0_0x298c51(0x1f9),auth,async(_0x14b5c7,_0x33cf20)=>{var _0x310df7=a0_0x298c51;try{const {date:_0x248647,SCRN:_0x356d15,PO_number:_0xb88a17,warehouse_name:_0x138f98,to_room_name:_0x3a5495,prod_code:_0x4f96d6,note:_0x53eec6,req_by:_0x315039,app_by:_0x3369a2,rec_by:_0x4d2749}=_0x14b5c7[_0x310df7(0x26e)];if(typeof _0x4f96d6=='string')var _0x38f561=[_0x14b5c7['body'][_0x310df7(0x251)]],_0x2e8f08=[_0x14b5c7['body']['spicemix_spmx']],_0x2cd4ce=[_0x14b5c7['body'][_0x310df7(0x2a3)]],_0x2efdfd=[_0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x26c)]],_0x450352=[_0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x29e)]],_0x4df8de=[_0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x23b)]],_0x11fa86=[_0x14b5c7['body'][_0x310df7(0x20a)]],_0x2e15c5=[_0x14b5c7['body']['curing_spmx']],_0x3b2a28=[_0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x1c5)]],_0x52ccd0=[_0x14b5c7['body'][_0x310df7(0x262)]],_0x3b6065=[_0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x291)]],_0x54c35b=[_0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x241)]],_0x3a9545=[_0x14b5c7['body']['brand_spmx']],_0x2e11ac=[_0x14b5c7['body']['category_spmx']],_0x3d231e=[_0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x247)]],_0x5ee519=[_0x14b5c7['body'][_0x310df7(0x297)]];else var _0x38f561=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x251)]],_0x2e8f08=[..._0x14b5c7['body'][_0x310df7(0x17f)]],_0x2cd4ce=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x2a3)]],_0x2efdfd=[..._0x14b5c7['body'][_0x310df7(0x26c)]],_0x450352=[..._0x14b5c7['body'][_0x310df7(0x29e)]],_0x4df8de=[..._0x14b5c7['body']['extenders_spmx_qty']],_0x11fa86=[..._0x14b5c7['body'][_0x310df7(0x20a)]],_0x2e15c5=[..._0x14b5c7['body'][_0x310df7(0x2a4)]],_0x3b2a28=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x1c5)]],_0x52ccd0=[..._0x14b5c7[_0x310df7(0x26e)]['curing_spmx_qty_stock']],_0x3b6065=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x291)]],_0x54c35b=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x241)]],_0x3a9545=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x255)]],_0x2e11ac=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x1b9)]],_0x3d231e=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x247)]],_0x5ee519=[..._0x14b5c7[_0x310df7(0x26e)][_0x310df7(0x297)]];const _0x536712=_0x38f561[_0x310df7(0x25c)](_0x4bfc74=>{return _0x4bfc74={'product_code':_0x4bfc74};});_0x2e8f08[_0x310df7(0x172)]((_0x5af585,_0x506fa7)=>{var _0x46bbbb=_0x310df7;_0x536712[_0x506fa7][_0x46bbbb(0x17f)]=_0x5af585;}),_0x2cd4ce[_0x310df7(0x172)]((_0x50937a,_0x11fde6)=>{var _0x3f4c14=_0x310df7;_0x536712[_0x11fde6][_0x3f4c14(0x2a3)]=_0x50937a;}),_0x2efdfd[_0x310df7(0x172)]((_0x3d9986,_0x2d8dd1)=>{var _0x24908f=_0x310df7;_0x536712[_0x2d8dd1][_0x24908f(0x26c)]=_0x3d9986;}),_0x450352['forEach']((_0x32f8ae,_0x10c762)=>{var _0x663848=_0x310df7;_0x536712[_0x10c762][_0x663848(0x29e)]=_0x32f8ae;}),_0x4df8de[_0x310df7(0x172)]((_0x39adae,_0x5c022f)=>{var _0x57fc88=_0x310df7;_0x536712[_0x5c022f][_0x57fc88(0x23b)]=_0x39adae;}),_0x11fa86[_0x310df7(0x172)]((_0x14ac68,_0x449a9c)=>{var _0x5274dc=_0x310df7;_0x536712[_0x449a9c][_0x5274dc(0x20a)]=_0x14ac68;}),_0x2e15c5[_0x310df7(0x172)]((_0x33c6c0,_0x59441d)=>{var _0x572474=_0x310df7;_0x536712[_0x59441d][_0x572474(0x2a4)]=_0x33c6c0;}),_0x3b2a28[_0x310df7(0x172)]((_0x2418dd,_0x477902)=>{_0x536712[_0x477902]['curing_spmx_qty']=_0x2418dd;}),_0x52ccd0[_0x310df7(0x172)]((_0x399b9f,_0x18fb3c)=>{var _0x186115=_0x310df7;_0x536712[_0x18fb3c][_0x186115(0x262)]=_0x399b9f;}),_0x3b6065['forEach']((_0x42ca60,_0x2d1e11)=>{var _0x596a74=_0x310df7;_0x536712[_0x2d1e11][_0x596a74(0x291)]=_0x42ca60;}),_0x54c35b[_0x310df7(0x172)]((_0x2274a5,_0x5c4c8a)=>{var _0x143927=_0x310df7;_0x536712[_0x5c4c8a][_0x143927(0x241)]=_0x2274a5;}),_0x3a9545[_0x310df7(0x172)]((_0x58a9f3,_0x3ac675)=>{_0x536712[_0x3ac675]['brand_spmx']=_0x58a9f3;}),_0x2e11ac['forEach']((_0x481877,_0x185333)=>{var _0x49eb49=_0x310df7;_0x536712[_0x185333][_0x49eb49(0x1b9)]=_0x481877;}),_0x3d231e[_0x310df7(0x172)]((_0xf811c5,_0xd4906c)=>{var _0x3649f2=_0x310df7;_0x536712[_0xd4906c][_0x3649f2(0x292)]=_0xf811c5;}),_0x5ee519['forEach']((_0x196149,_0x48195)=>{_0x536712[_0x48195]['incoming_invoice']=_0x196149;});const _0x272800=new invoice_for_outgoing();await _0x272800[_0x310df7(0x239)]();const _0x528b01=new sales_spmx({'invoice':_0x310df7(0x1e3)+_0x272800[_0x310df7(0x267)][_0x310df7(0x1d9)]()['padStart'](0x8,'0'),'date':_0x248647,'warehouse_name':_0x138f98,'sale_product':_0x536712,'note':_0x53eec6,'POnumber':_0xb88a17,'SCRN':_0x356d15,'req_by':_0x315039,'appr_by':_0x3369a2,'rec_by':_0x4d2749}),_0x44587f=await _0x528b01[_0x310df7(0x239)]();_0x14b5c7[_0x310df7(0x215)](_0x310df7(0x21e),_0x310df7(0x25d)),_0x33cf20['redirect'](_0x310df7(0x204)+_0x44587f[_0x310df7(0x20e)]);}catch(_0x1b1947){console[_0x310df7(0x1b3)](_0x310df7(0x26a),_0x1b1947),_0x33cf20[_0x310df7(0x1b0)](0xc8)[_0x310df7(0x224)]({'message':_0x1b1947[_0x310df7(0x257)]});}}),router[a0_0x298c51(0x1ad)](a0_0x298c51(0x1a1),auth,async(_0xd415c7,_0x283d60)=>{var _0x233e01=a0_0x298c51;try{const _0xced1d4=_0xd415c7[_0x233e01(0x1f8)]['id'],_0x224e4d=await sales_spmx['findById'](_0xced1d4),_0x53fec3=await master_shop[_0x233e01(0x280)](),_0x19a495=_0xd415c7[_0x233e01(0x295)],_0x584b83=await profile[_0x233e01(0x28f)]({'email':_0x19a495[_0x233e01(0x21a)]}),_0x4407f7=await staff[_0x233e01(0x28f)]({'email':_0x19a495['email']});if(_0x53fec3[0x0]['language']==_0x233e01(0x1b5))var _0x1f1af1=users['English'];else{if(_0x53fec3[0x0][_0x233e01(0x1d2)]==_0x233e01(0x1ab))var _0x1f1af1=users['Hindi'];else{if(_0x53fec3[0x0][_0x233e01(0x1d2)]==_0x233e01(0x25a))var _0x1f1af1=users['German'];else{if(_0x53fec3[0x0][_0x233e01(0x1d2)]==_0x233e01(0x1c7))var _0x1f1af1=users[_0x233e01(0x1c7)];else{if(_0x53fec3[0x0][_0x233e01(0x1d2)]==_0x233e01(0x273))var _0x1f1af1=users[_0x233e01(0x273)];else{if(_0x53fec3[0x0]['language']==_0x233e01(0x235))var _0x1f1af1=users[_0x233e01(0x22c)];else{if(_0x53fec3[0x0][_0x233e01(0x1d2)]==_0x233e01(0x1f4))var _0x1f1af1=users[_0x233e01(0x1f4)];else{if(_0x53fec3[0x0]['language']==_0x233e01(0x1d4))var _0x1f1af1=users[_0x233e01(0x2b5)];}}}}}}}_0x283d60[_0x233e01(0x1ca)]('view_sales_finished_spmx',{'success':_0xd415c7['flash'](_0x233e01(0x21e)),'errors':_0xd415c7[_0x233e01(0x215)](_0x233e01(0x1ac)),'role':_0x19a495,'profile':_0x584b83,'master_shop':_0x53fec3,'language':_0x1f1af1,'data':_0x224e4d});}catch(_0x264b5f){;_0x283d60[_0x233e01(0x1b0)](0xc8)[_0x233e01(0x224)]({'message':_0x264b5f['message']});}}),router[a0_0x298c51(0x1dd)](a0_0x298c51(0x1a6),auth,async(_0x605a29,_0x1961af)=>{var _0x5e29e9=a0_0x298c51;try{const _0x42e74d=_0x605a29[_0x5e29e9(0x1f8)]['id'],_0x17fd54=await sales_spmx[_0x5e29e9(0x1f5)](_0x42e74d);_0x17fd54[_0x5e29e9(0x170)][_0x5e29e9(0x172)](async _0x185a4b=>{var _0x4ebb83=_0x5e29e9;const _0x4c6f83=await warehouse[_0x4ebb83(0x28f)]({'name':_0x17fd54['warehouse_name'],'room':_0x185a4b['room_spmx'],'warehouse_category':'SPMX','product_details_spmx._id':_0x185a4b['id_transaction_from']});if(_0x4c6f83){const _0x22ba86=_0x4c6f83[_0x4ebb83(0x18a)][_0x4ebb83(0x280)](_0x4f4dcb=>_0x4f4dcb['_id'][_0x4ebb83(0x1d9)]()===_0x185a4b[_0x4ebb83(0x292)]);_0x22ba86[_0x4ebb83(0x2a3)]=_0x22ba86[_0x4ebb83(0x2a3)]-_0x185a4b['spicemix_spmx_qty'],_0x22ba86[_0x4ebb83(0x23b)]=_0x22ba86['extenders_spmx_qty']-_0x185a4b['extenders_spmx_qty'],_0x22ba86['curing_spmx_qty']=_0x22ba86['curing_spmx_qty']-_0x185a4b[_0x4ebb83(0x1c5)],await warehouse[_0x4ebb83(0x27d)]({'name':_0x17fd54[_0x4ebb83(0x27e)],'room':_0x185a4b[_0x4ebb83(0x291)],'warehouse_category':'SPMX','product_details_spmx._id':_0x185a4b[_0x4ebb83(0x292)]},{'$set':{'product_details_spmx.$.spicemix_spmx_qty':_0x22ba86[_0x4ebb83(0x2a3)],'product_details_spmx.$.extenders_spmx_qty':_0x22ba86[_0x4ebb83(0x23b)],'product_details_spmx.$.curing_spmx_qty':_0x22ba86[_0x4ebb83(0x1c5)]}});}}),_0x17fd54['finalize']=_0x5e29e9(0x254),_0x17fd54[_0x5e29e9(0x239)](),_0x605a29[_0x5e29e9(0x215)](_0x5e29e9(0x21e),'Outgoing\x20Successfully\x20Added\x20and\x20Finalized'),_0x1961af[_0x5e29e9(0x2a0)](_0x5e29e9(0x204)+_0x17fd54[_0x5e29e9(0x20e)]);return;}catch(_0xc407fa){_0x1961af[_0x5e29e9(0x224)]({'message':_0xc407fa[_0x5e29e9(0x257)]});}}),router[a0_0x298c51(0x1ad)](a0_0x298c51(0x242),auth,async(_0x180a28,_0x25021c)=>{var _0x1a2940=a0_0x298c51;try{const {username:_0x47dfec,email:_0x1aca76,role:_0x49a40b}=_0x180a28[_0x1a2940(0x295)],_0x1d20d6=_0x180a28['user'],_0x4c488e=await profile[_0x1a2940(0x28f)]({'email':_0x1d20d6[_0x1a2940(0x21a)]}),_0x38e5b1=await master_shop['find']();let _0x1688a5;if(_0x1d20d6['role']==_0x1a2940(0x1c1)){const _0x162a90=await staff['findOne']({'email':_0x1d20d6[_0x1a2940(0x21a)]});_0x1688a5=await sales_finished[_0x1a2940(0x2ae)]([{'$unwind':_0x1a2940(0x2a7)},{'$group':{'_id':_0x1a2940(0x201),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x1a2940(0x188)},'date':{'$first':_0x1a2940(0x1ee)},'warehouse_name':{'$first':_0x1a2940(0x212)},'note':{'$first':_0x1a2940(0x1b4)},'return_data':{'$first':_0x1a2940(0x238)},'total_saleproduct_quantity':{'$sum':_0x1a2940(0x16f)},'level':{'$addToSet':_0x1a2940(0x2b4)},'isle':{'$addToSet':_0x1a2940(0x277)},'type':{'$addToSet':_0x1a2940(0x1a2)},'pallet':{'$addToSet':_0x1a2940(0x211)},'finalize':{'$first':_0x1a2940(0x27b)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'note':0x1,'return_data':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x1688a5=await sales_finished[_0x1a2940(0x2ae)]([{'$unwind':_0x1a2940(0x2a7)},{'$group':{'_id':_0x1a2940(0x201),'invoice':{'$first':_0x1a2940(0x18d)},'customers':{'$first':_0x1a2940(0x188)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x1a2940(0x212)},'note':{'$first':_0x1a2940(0x1b4)},'return_data':{'$first':_0x1a2940(0x238)},'total_saleproduct_quantity':{'$sum':_0x1a2940(0x16f)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x1a2940(0x277)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x1a2940(0x211)},'finalize':{'$first':_0x1a2940(0x27b)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'note':0x1,'return_data':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x38e5b1[0x0][_0x1a2940(0x1d2)]=='English\x20(US)'){var _0x149750=users['English'];console[_0x1a2940(0x1b3)](_0x149750);}else{if(_0x38e5b1[0x0][_0x1a2940(0x1d2)]==_0x1a2940(0x1ab))var _0x149750=users['Hindi'];else{if(_0x38e5b1[0x0][_0x1a2940(0x1d2)]==_0x1a2940(0x25a))var _0x149750=users[_0x1a2940(0x25a)];else{if(_0x38e5b1[0x0]['language']==_0x1a2940(0x1c7))var _0x149750=users[_0x1a2940(0x1c7)];else{if(_0x38e5b1[0x0][_0x1a2940(0x1d2)]==_0x1a2940(0x273))var _0x149750=users[_0x1a2940(0x273)];else{if(_0x38e5b1[0x0][_0x1a2940(0x1d2)]==_0x1a2940(0x235))var _0x149750=users[_0x1a2940(0x22c)];else{if(_0x38e5b1[0x0][_0x1a2940(0x1d2)]==_0x1a2940(0x1f4))var _0x149750=users['Chinese'];else{if(_0x38e5b1[0x0][_0x1a2940(0x1d2)]=='Arabic\x20(ae)')var _0x149750=users[_0x1a2940(0x2b5)];}}}}}}}_0x25021c[_0x1a2940(0x1ca)](_0x1a2940(0x266),{'success':_0x180a28[_0x1a2940(0x215)](_0x1a2940(0x21e)),'errors':_0x180a28['flash'](_0x1a2940(0x1ac)),'sales':_0x1688a5,'profile':_0x4c488e,'role':_0x1d20d6,'master_shop':_0x38e5b1,'language':_0x149750});}catch(_0x51640d){console[_0x1a2940(0x1b3)](_0x51640d);}});async function getRandom8DigitNumber(){var _0x181556=a0_0x298c51;const _0x120ec3=0x989680,_0x11375c=0x5f5e0ff,_0x531753=Math['floor'](Math['random']()*(_0x11375c-_0x120ec3+0x1))+_0x120ec3;var _0x1b1d02;const _0x4fd761=await sales_finished[_0x181556(0x28f)]({'invoice':_0x181556(0x275)+_0x531753});return _0x4fd761&&_0x4fd761['length']>0x0?_0x1b1d02=_0x181556(0x275)+_0x531753:_0x1b1d02=_0x181556(0x275)+_0x531753,_0x1b1d02;}router[a0_0x298c51(0x1ad)]('/view/add_sales',auth,async(_0x11e3de,_0x8248d3)=>{var _0x15d893=a0_0x298c51;try{const {username:_0x56a21a,email:_0x1ce93f,role:_0x53716c}=_0x11e3de[_0x15d893(0x295)],_0x2734b8=_0x11e3de['user'],_0xc16aaf=await profile[_0x15d893(0x28f)]({'email':_0x2734b8['email']}),_0x295eb5=await master_shop[_0x15d893(0x280)](),_0x23f641=await customer[_0x15d893(0x280)]({});let _0x530dab;if(_0x2734b8[_0x15d893(0x1c6)]==_0x15d893(0x1c1)){const _0x5a02a5=await staff['findOne']({'email':_0x2734b8['email']});_0x530dab=await warehouse[_0x15d893(0x2ae)]([{'$match':{'status':_0x15d893(0x2a5),'name':_0x5a02a5[_0x15d893(0x246)],'warehouse_category':_0x15d893(0x1fb),'name':{'$ne':_0x15d893(0x2ab)}}},{'$group':{'_id':_0x15d893(0x227),'name':{'$first':_0x15d893(0x227)}}},{'$sort':{'name':0x1}}]);}else _0x530dab=await warehouse[_0x15d893(0x2ae)]([{'$match':{'status':_0x15d893(0x2a5),'warehouse_category':_0x15d893(0x1fb),'name':{'$ne':_0x15d893(0x2ab)}}},{'$group':{'_id':_0x15d893(0x227),'name':{'$first':_0x15d893(0x227)}}},{'$sort':{'name':0x1}}]);const _0x3bad2a=await product[_0x15d893(0x280)]({});var _0x27d5a3=[_0x15d893(0x182),_0x15d893(0x276)];const _0x15f58d=await sales_finished['find']({}),_0x293b97=_0x15f58d[_0x15d893(0x29d)]+0x1,_0x25d9e9='OUTF-'+_0x293b97['toString']()[_0x15d893(0x210)](0x5,'0');if(_0x295eb5[0x0]['language']==_0x15d893(0x1b5)){var _0x122145=users[_0x15d893(0x1c2)];console[_0x15d893(0x1b3)](_0x122145);}else{if(_0x295eb5[0x0][_0x15d893(0x1d2)]==_0x15d893(0x1ab))var _0x122145=users[_0x15d893(0x1ab)];else{if(_0x295eb5[0x0][_0x15d893(0x1d2)]=='German')var _0x122145=users[_0x15d893(0x25a)];else{if(_0x295eb5[0x0][_0x15d893(0x1d2)]==_0x15d893(0x1c7))var _0x122145=users[_0x15d893(0x1c7)];else{if(_0x295eb5[0x0][_0x15d893(0x1d2)]==_0x15d893(0x273))var _0x122145=users[_0x15d893(0x273)];else{if(_0x295eb5[0x0][_0x15d893(0x1d2)]==_0x15d893(0x235))var _0x122145=users[_0x15d893(0x22c)];else{if(_0x295eb5[0x0][_0x15d893(0x1d2)]==_0x15d893(0x1f4))var _0x122145=users['Chinese'];else{if(_0x295eb5[0x0][_0x15d893(0x1d2)]==_0x15d893(0x1d4))var _0x122145=users[_0x15d893(0x2b5)];}}}}}}}const _0x178240=getRandom8DigitNumber();_0x178240[_0x15d893(0x214)](_0x55c74b=>{var _0x28f4cb=_0x15d893;_0x8248d3[_0x28f4cb(0x1ca)](_0x28f4cb(0x226),{'success':_0x11e3de[_0x28f4cb(0x215)](_0x28f4cb(0x21e)),'errors':_0x11e3de[_0x28f4cb(0x215)](_0x28f4cb(0x1ac)),'role':_0x2734b8,'profile':_0xc16aaf,'customer':_0x23f641,'warehouse':_0x530dab,'product':_0x3bad2a,'invoice':_0x55c74b,'master_shop':_0x295eb5,'language':_0x122145,'rooms_data':_0x27d5a3});})[_0x15d893(0x18e)](_0x4045b3=>{var _0x56b756=_0x15d893;_0x11e3de['flash']('errors',_0x56b756(0x243)),_0x8248d3[_0x56b756(0x2a0)](_0x56b756(0x1d6));});}catch(_0x5b0223){console[_0x15d893(0x1b3)](_0x5b0223);}}),router[a0_0x298c51(0x1ad)](a0_0x298c51(0x181),auth,async(_0x355feb,_0x39e448)=>{var _0x105fbd=a0_0x298c51;try{const _0x36f03a=_0x355feb[_0x105fbd(0x1f8)]['id'];console[_0x105fbd(0x1b3)](_0x36f03a);const _0x140f78=await product[_0x105fbd(0x280)](),_0x11c9e7=await purchases['aggregate']([{'$match':{'warehouse_name':_0x36f03a}},{'$unwind':_0x105fbd(0x223)},{'$group':{'_id':_0x105fbd(0x1f2)}}]);console['log'](_0x105fbd(0x213),_0x11c9e7),_0x39e448[_0x105fbd(0x1b0)](0xc8)[_0x105fbd(0x224)]({'purchases_data':_0x11c9e7,'product_data':_0x140f78});}catch(_0x382d00){console[_0x105fbd(0x1b3)](_0x382d00);}}),router[a0_0x298c51(0x1dd)](a0_0x298c51(0x195),auth,async(_0x53c16e,_0x2a857e)=>{var _0x43345a=a0_0x298c51;try{const {warehouse_data:_0x11bff8,product_data:_0x5bddae}=_0x53c16e['body'];console[_0x43345a(0x1b3)](_0x53c16e['body'][_0x43345a(0x2ad)]);;const _0x1d878a=await master_shop[_0x43345a(0x280)]();console[_0x43345a(0x1b3)](_0x43345a(0x2aa),_0x1d878a);const _0x24312f=await product[_0x43345a(0x28f)]({'name':_0x5bddae});console[_0x43345a(0x1b3)](_0x43345a(0x1cf),_0x24312f);const _0x3e2c02=await warehouse[_0x43345a(0x2ae)]([{'$match':{'name':_0x11bff8}},{'$unwind':_0x43345a(0x1a5)},{'$match':{'product_details.product_name':_0x5bddae}},{'$group':{'_id':_0x43345a(0x1cc),'product_stock':{'$first':_0x43345a(0x175)}}}]);console[_0x43345a(0x1b3)](_0x43345a(0x1e8),_0x3e2c02),_0x2a857e[_0x43345a(0x1b0)](0xc8)['json']({'master':_0x1d878a,'new_product':_0x24312f,'stock_data':_0x3e2c02});}catch(_0x527c96){console[_0x43345a(0x1b3)](_0x527c96);}}),router[a0_0x298c51(0x1dd)](a0_0x298c51(0x20d),auth,async(_0x38dce4,_0x3c6e13)=>{var _0x3ad7dd=a0_0x298c51;try{const {invoice:_0x45df7c,date:_0x31133a,warehouse_name:_0x2773a2,product_name:_0x75cc62,stock:_0x337338,quantity:_0x3af101,note:_0x3add31,room:_0x4d12b3,primary_code:_0x3f3189,secondary_code:_0x16170a,prod_code:_0x2d11a2,level:_0x5bda6c,isle:_0x59f86e,pallet:_0x3f95a5,batch_code:_0x5f0def,SCRN:_0x58b1c6,expiry_date:_0x59098f,mode_transpo:_0xb1df8f,name_driver:_0x4765d7}=_0x38dce4[_0x3ad7dd(0x26e)];if(typeof _0x75cc62==_0x3ad7dd(0x1bc))var _0x12b2df=[_0x38dce4['body'][_0x3ad7dd(0x1ed)]],_0x572d01=[_0x38dce4[_0x3ad7dd(0x26e)]['stock']],_0x4ac7f1=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x258)]],_0x57d1b6=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x1be)]],_0x1f277a=[_0x38dce4['body'][_0x3ad7dd(0x1b1)]],_0x53b898=[_0x38dce4['body']['prod_code']],_0x31e9c8=[_0x38dce4['body'][_0x3ad7dd(0x293)]],_0x3773f4=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x1e2)]],_0x1842d1=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x209)]],_0x5364cc=[_0x38dce4['body'][_0x3ad7dd(0x186)]],_0xcbea98=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x173)]],_0x855427=[_0x38dce4[_0x3ad7dd(0x26e)]['product_date']],_0x512885=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x1c4)]],_0x4d62e2=[_0x38dce4[_0x3ad7dd(0x26e)]['prod_cat']],_0x4b9bc0=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x194)]],_0x18d21c=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x1fe)]],_0x391bc7=[_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x292)]];else var _0x12b2df=[..._0x38dce4[_0x3ad7dd(0x26e)]['product_name']],_0x572d01=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x189)]],_0x4ac7f1=[..._0x38dce4[_0x3ad7dd(0x26e)]['carton']],_0x57d1b6=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x1be)]],_0x1f277a=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x1b1)]],_0x53b898=[..._0x38dce4['body'][_0x3ad7dd(0x251)]],_0x31e9c8=[..._0x38dce4['body']['level']],_0x3773f4=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x1e2)]],_0x1842d1=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x209)]],_0x5364cc=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x186)]],_0xcbea98=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x173)]],_0x855427=[..._0x38dce4[_0x3ad7dd(0x26e)]['product_date']],_0x512885=[..._0x38dce4['body'][_0x3ad7dd(0x1c4)]],_0x4d62e2=[..._0x38dce4['body'][_0x3ad7dd(0x1ec)]],_0x4b9bc0=[..._0x38dce4['body'][_0x3ad7dd(0x194)]],_0x18d21c=[..._0x38dce4[_0x3ad7dd(0x26e)]['prod_invoice']],_0x391bc7=[..._0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x292)]];const _0x572e78=_0x12b2df['map'](_0x55dc60=>{return _0x55dc60={'product_name':_0x55dc60};});_0x572d01[_0x3ad7dd(0x172)]((_0x540dd8,_0x5a83a3)=>{var _0x52d76b=_0x3ad7dd;_0x572e78[_0x5a83a3][_0x52d76b(0x189)]=_0x540dd8;}),_0x4ac7f1[_0x3ad7dd(0x172)]((_0x4cb152,_0x5b22ab)=>{var _0x44281b=_0x3ad7dd;_0x572e78[_0x5b22ab][_0x44281b(0x199)]=Math['abs'](_0x4cb152);}),_0x391bc7[_0x3ad7dd(0x172)]((_0x1fe194,_0x117562)=>{var _0x490d42=_0x3ad7dd;_0x572e78[_0x117562][_0x490d42(0x292)]=_0x1fe194;}),_0x57d1b6['forEach']((_0x2bdf6b,_0x3530d3)=>{var _0x4c2267=_0x3ad7dd;_0x572e78[_0x3530d3][_0x4c2267(0x1be)]=_0x2bdf6b;}),_0x1f277a[_0x3ad7dd(0x172)]((_0x49543c,_0x2f2290)=>{_0x572e78[_0x2f2290]['secondary_code']=_0x49543c;}),_0x53b898[_0x3ad7dd(0x172)]((_0x4129b2,_0xce730)=>{var _0x287a80=_0x3ad7dd;_0x572e78[_0xce730]['product_code']=_0x4129b2,_0x572e78[_0xce730][_0x287a80(0x2a6)]=_0x31133a;}),_0x31e9c8[_0x3ad7dd(0x172)]((_0x5147e4,_0xf0f9c)=>{var _0x106053=_0x3ad7dd;_0x572e78[_0xf0f9c][_0x106053(0x205)]=_0x5147e4;}),_0x3773f4[_0x3ad7dd(0x172)]((_0x1b4e63,_0x382b5a)=>{var _0x1ef678=_0x3ad7dd;_0x572e78[_0x382b5a][_0x1ef678(0x284)]=_0x1b4e63;}),_0x1842d1['forEach']((_0x4da7d9,_0x2b94cc)=>{var _0x3eb8d7=_0x3ad7dd;_0x572e78[_0x2b94cc][_0x3eb8d7(0x209)]=_0x4da7d9;}),_0x5364cc[_0x3ad7dd(0x172)]((_0x391705,_0x56e6fe)=>{_0x572e78[_0x56e6fe]['batch_code']=_0x391705;}),_0xcbea98[_0x3ad7dd(0x172)]((_0x2645c0,_0x298ea3)=>{_0x572e78[_0x298ea3]['expiry_date']=_0x2645c0;}),_0x855427[_0x3ad7dd(0x172)]((_0x3712de,_0x5bfe15)=>{_0x572e78[_0x5bfe15]['production_date']=_0x3712de;}),_0x512885['forEach']((_0x1de4eb,_0x369d0c)=>{var _0x58ff8d=_0x3ad7dd;_0x572e78[_0x369d0c][_0x58ff8d(0x1c9)]=_0x1de4eb;}),_0x4d62e2[_0x3ad7dd(0x172)]((_0x3caaf0,_0x1f410f)=>{var _0x287e05=_0x3ad7dd;_0x572e78[_0x1f410f][_0x287e05(0x1ec)]=_0x3caaf0;}),_0x4b9bc0[_0x3ad7dd(0x172)]((_0x97266a,_0x84aa87)=>{var _0xb2c902=_0x3ad7dd;_0x572e78[_0x84aa87][_0xb2c902(0x2a1)]=_0x97266a;}),_0x18d21c[_0x3ad7dd(0x172)]((_0x5ee545,_0x4accfe)=>{var _0x103e79=_0x3ad7dd;_0x572e78[_0x4accfe][_0x103e79(0x19e)]=_0x5ee545;});var _0x59cde4=0x0;_0x572e78[_0x3ad7dd(0x172)](_0xea4226=>{var _0x3e154b=_0x3ad7dd;parseFloat(_0xea4226[_0x3e154b(0x189)])<parseFloat(_0xea4226[_0x3e154b(0x199)])&&parseFloat(_0xea4226[_0x3e154b(0x199)])>parseFloat(_0xea4226[_0x3e154b(0x189)])&&(console['log'](_0xea4226[_0x3e154b(0x189)]+_0x3e154b(0x225)+_0xea4226[_0x3e154b(0x199)]),_0x59cde4++);});if(_0x59cde4!=0x0)return _0x38dce4[_0x3ad7dd(0x215)](_0x3ad7dd(0x1ac),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x3c6e13[_0x3ad7dd(0x2a0)](_0x3ad7dd(0x28a));const _0x49bf77=_0x572e78[_0x3ad7dd(0x171)](_0x2ec526=>_0x2ec526[_0x3ad7dd(0x199)]!=='0'&&_0x2ec526[_0x3ad7dd(0x199)]!==''),_0x4ffa76=new sales_finished({'invoice':_0x45df7c,'customer':_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x256)],'date':_0x31133a,'warehouse_name':_0x2773a2,'sale_product':_0x49bf77,'note':_0x3add31,'room':_0x4d12b3,'primary_code':_0x3f3189,'secondary_code':_0x16170a,'prod_code':_0x2d11a2,'SCRN':_0x58b1c6,'finalize':_0x3ad7dd(0x1e1),'mode_transpo':_0xb1df8f,'name_driver':_0x4765d7}),_0x458174=await _0x4ffa76[_0x3ad7dd(0x239)](),_0x2f1d59=await sales_finished[_0x3ad7dd(0x28f)]({'invoice':_0x45df7c}),_0x2c6fdc=new c_payment_data({'invoice':_0x45df7c,'customer':_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x256)],'reason':_0x3ad7dd(0x176)});await _0x2c6fdc['save']();const _0x4a272d=await master_shop[_0x3ad7dd(0x280)](),_0x42267e=await email_settings['findOne'](),_0xdaa5f1=await customer[_0x3ad7dd(0x28f)]({'name':_0x38dce4[_0x3ad7dd(0x26e)][_0x3ad7dd(0x256)]});_0x4a272d[0x0][_0x3ad7dd(0x23c)]==0x1?(right_currency=_0x4a272d[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x4a272d[0x0][_0x3ad7dd(0x1e7)]);var _0x5bf4e9=_0x12b2df,_0x53bdc9=_0x4ac7f1,_0x5cb07b='',_0x129ce0;for(_0x129ce0 in _0x5bf4e9){_0x5cb07b+=_0x3ad7dd(0x187)+_0x3ad7dd(0x1d8)+_0x5bf4e9[_0x129ce0]+_0x3ad7dd(0x26b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x53bdc9[_0x129ce0]+_0x3ad7dd(0x26b)+'</tr>';}console[_0x3ad7dd(0x1b3)](_0x3ad7dd(0x1ef),_0x5cb07b),_0x38dce4[_0x3ad7dd(0x215)](_0x3ad7dd(0x21e),'Sales\x20Add\x20successfully'),_0x3c6e13[_0x3ad7dd(0x2a0)]('/all_sales_finished/preview/'+_0x458174[_0x3ad7dd(0x20e)]);}catch(_0x304b08){console['log'](_0x304b08);}}),router[a0_0x298c51(0x1ad)](a0_0x298c51(0x23d),auth,async(_0x5f3e64,_0x1269de)=>{var _0x316f98=a0_0x298c51;try{const {username:_0x2ca315,email:_0x25ba91,role:_0x548250}=_0x5f3e64['user'],_0x5ad9bd=_0x5f3e64['user'],_0x2fd6b3=await profile['findOne']({'email':_0x5ad9bd[_0x316f98(0x21a)]}),_0x30a48d=await master_shop[_0x316f98(0x280)](),_0x516fb2=_0x5f3e64[_0x316f98(0x1f8)]['id'],_0x5786b3=await sales_finished[_0x316f98(0x1f5)](_0x516fb2),_0x373fea=await warehouse['aggregate']([{'$match':{'name':_0x5786b3[_0x316f98(0x27e)]}},{'$unwind':_0x316f98(0x1a5)},{'$group':{'_id':_0x316f98(0x200),'name':{'$first':_0x316f98(0x1cc)},'product_stock':{'$first':_0x316f98(0x175)},'bay':{'$first':_0x316f98(0x24b)},'bin':{'$first':_0x316f98(0x190)},'type':{'$first':_0x316f98(0x1de)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x316f98(0x263)},'secondary_code':{'$first':_0x316f98(0x1e0)},'product_code':{'$first':_0x316f98(0x286)},'storage':{'$first':_0x316f98(0x1a4)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x316f98(0x16d)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x316f98(0x24a)},'room_data':{'$first':_0x316f98(0x24f)}}}]),_0x553585=await customer['find']({});let _0x1d76e2;if(_0x5ad9bd[_0x316f98(0x1c6)]==_0x316f98(0x1c1)){const _0x527241=await staff['findOne']({'email':_0x5ad9bd['email']});_0x1d76e2=await warehouse['aggregate']([{'$match':{'status':_0x316f98(0x2a5),'name':_0x527241[_0x316f98(0x246)]}},{'$group':{'_id':_0x316f98(0x227),'name':{'$first':_0x316f98(0x227)}}}]);}else _0x1d76e2=await warehouse[_0x316f98(0x2ae)]([{'$match':{'status':_0x316f98(0x2a5)}},{'$group':{'_id':_0x316f98(0x227),'name':{'$first':_0x316f98(0x227)}}}]);const _0x2b4191=await product['find']({});if(_0x30a48d[0x0][_0x316f98(0x1d2)]==_0x316f98(0x1b5)){var _0x1b7cee=users[_0x316f98(0x1c2)];console[_0x316f98(0x1b3)](_0x1b7cee);}else{if(_0x30a48d[0x0][_0x316f98(0x1d2)]==_0x316f98(0x1ab))var _0x1b7cee=users['Hindi'];else{if(_0x30a48d[0x0]['language']=='German')var _0x1b7cee=users[_0x316f98(0x25a)];else{if(_0x30a48d[0x0][_0x316f98(0x1d2)]==_0x316f98(0x1c7))var _0x1b7cee=users[_0x316f98(0x1c7)];else{if(_0x30a48d[0x0][_0x316f98(0x1d2)]==_0x316f98(0x273))var _0x1b7cee=users[_0x316f98(0x273)];else{if(_0x30a48d[0x0]['language']==_0x316f98(0x235))var _0x1b7cee=users[_0x316f98(0x22c)];else{if(_0x30a48d[0x0]['language']==_0x316f98(0x1f4))var _0x1b7cee=users[_0x316f98(0x1f4)];else{if(_0x30a48d[0x0][_0x316f98(0x1d2)]==_0x316f98(0x1d4))var _0x1b7cee=users[_0x316f98(0x2b5)];}}}}}}}_0x1269de[_0x316f98(0x1ca)](_0x316f98(0x17d),{'success':_0x5f3e64[_0x316f98(0x215)](_0x316f98(0x21e)),'errors':_0x5f3e64[_0x316f98(0x215)](_0x316f98(0x1ac)),'role':_0x5ad9bd,'profile':_0x2fd6b3,'customer':_0x553585,'warehouse':_0x1d76e2,'product':_0x373fea,'user':_0x5786b3,'master_shop':_0x30a48d,'unit':_0x2b4191,'language':_0x1b7cee});}catch(_0x583be5){console[_0x316f98(0x1b3)](_0x583be5);}}),router['post']('/preview/:id',auth,async(_0x5ff925,_0x29412b)=>{var _0x59956b=a0_0x298c51;try{const _0x7ebb84=_0x5ff925['params']['id'],{invoice:_0x35a315,warehouse_name:_0x198a24,room:_0xd83ca7}=_0x5ff925['body'],_0x5db8bb=await sales_finished[_0x59956b(0x28f)]({'invoice':_0x35a315}),_0x25502d=_0x5db8bb['sale_product'][_0x59956b(0x25c)](async _0x3881d9=>{var _0x183b19=_0x59956b,_0x5ab3ea=await warehouse[_0x183b19(0x28f)]({'name':_0x198a24,'room':_0x3881d9['room_name'],'warehouse_category':_0x183b19(0x1fb)});const _0x46973b=_0x5ab3ea[_0x183b19(0x2ac)][_0x183b19(0x25c)](_0x23502e=>{var _0x8cc2c0=_0x183b19;if(_0x23502e[_0x8cc2c0(0x1ed)]==_0x3881d9[_0x8cc2c0(0x1ed)]&&_0x23502e[_0x8cc2c0(0x205)]==_0x3881d9[_0x8cc2c0(0x205)]&&_0x23502e[_0x8cc2c0(0x173)]==_0x3881d9[_0x8cc2c0(0x173)]&&_0x23502e['production_date']==_0x3881d9['production_date']&&_0x23502e[_0x8cc2c0(0x186)]==_0x3881d9['batch_code']&&_0x23502e['_id']==_0x3881d9['id_transaction_from']){if(_0x23502e['product_stock']>0x0){_0x23502e['product_stock']=Math[_0x8cc2c0(0x178)](0x0,Math[_0x8cc2c0(0x298)](_0x23502e[_0x8cc2c0(0x17e)])-Math[_0x8cc2c0(0x298)](_0x3881d9[_0x8cc2c0(0x199)]));if(_0x23502e['out_invoice']==undefined)_0x23502e[_0x8cc2c0(0x1aa)]=_0x35a315+'~';else{var _0x3171fa=_0x23502e[_0x8cc2c0(0x1aa)][_0x8cc2c0(0x1bb)]('~'),_0x411dab='';for(let _0x5a9ad8=0x0;_0x5a9ad8<=_0x3171fa[_0x8cc2c0(0x29d)]-0x1;_0x5a9ad8++){const _0x5c8eef=_0x3171fa[_0x5a9ad8];_0x5c8eef[_0x8cc2c0(0x29d)]>0x0&&(_0x411dab+=_0x5c8eef+'~');}_0x23502e[_0x8cc2c0(0x1aa)]=_0x411dab;}}}});return console[_0x183b19(0x1b3)](_0x5ab3ea),_0x5ab3ea;});Promise[_0x59956b(0x1ae)](_0x25502d)[_0x59956b(0x214)](async _0x1af0a9=>{var _0x1a4c48=_0x59956b;try{for(const _0x45ad1f of _0x1af0a9){await _0x45ad1f[_0x1a4c48(0x239)]();}_0x5db8bb[_0x1a4c48(0x237)]=_0x1a4c48(0x254);const _0x3426b3=await _0x5db8bb[_0x1a4c48(0x239)](),_0x2c5fe8=await master_shop['find'](),_0x4d43e8=await email_settings[_0x1a4c48(0x28f)](),_0x3d1a27=await supervisor_settings[_0x1a4c48(0x280)]();var _0x408b75=_0x5db8bb[_0x1a4c48(0x170)],_0x21677b='',_0x29233e;for(_0x29233e in _0x408b75){var _0x14c5a5='FG';_0x5db8bb[_0x1a4c48(0x27e)]==_0x1a4c48(0x259)&&(_0x14c5a5='DG'),_0x21677b+=_0x1a4c48(0x187)+_0x1a4c48(0x1d8)+_0x408b75[_0x29233e][_0x1a4c48(0x1ed)]+_0x1a4c48(0x26b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x408b75[_0x29233e][_0x1a4c48(0x27f)]+'</td>'+_0x1a4c48(0x1d8)+_0x408b75[_0x29233e][_0x1a4c48(0x199)]+_0x1a4c48(0x26b)+_0x1a4c48(0x1d8)+_0x408b75[_0x29233e][_0x1a4c48(0x284)]+'</td>'+_0x1a4c48(0x1d8)+_0x408b75[_0x29233e]['secondary_unit']+_0x1a4c48(0x26b)+_0x1a4c48(0x1d8)+_0x5db8bb[_0x1a4c48(0x27e)]+_0x1a4c48(0x26b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x408b75[_0x29233e][_0x1a4c48(0x2a1)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x14c5a5+_0x408b75[_0x29233e][_0x1a4c48(0x205)]+_0x1a4c48(0x26b);}let _0x27044f=nodemailer[_0x1a4c48(0x20b)]({'host':_0x4d43e8[_0x1a4c48(0x2af)],'port':Number(_0x4d43e8[_0x1a4c48(0x25b)]),'secure':![],'auth':{'user':_0x4d43e8[_0x1a4c48(0x21a)],'pass':_0x4d43e8[_0x1a4c48(0x278)]}}),_0xb5c1ac={'from':_0x4d43e8[_0x1a4c48(0x21a)],'to':_0x3d1a27[0x0][_0x1a4c48(0x268)],'subject':_0x1a4c48(0x22e),'attachments':[{'filename':'Logo.png','path':__dirname+_0x1a4c48(0x229)+'/upload/'+_0x2c5fe8[0x0][_0x1a4c48(0x281)],'cid':_0x1a4c48(0x1cb)}],'html':'<!DOCTYPE\x20html>'+_0x1a4c48(0x2b3)+_0x1a4c48(0x2b1)+_0x1a4c48(0x18f)+_0x1a4c48(0x1f7)+_0x1a4c48(0x18f)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1a4c48(0x206)+_0x1a4c48(0x18f)+_0x1a4c48(0x1c0)+_0x2c5fe8[0x0][_0x1a4c48(0x216)]+_0x1a4c48(0x1a7)+'</div>'+_0x1a4c48(0x206)+_0x1a4c48(0x1b6)+_0x1a4c48(0x18f)+_0x1a4c48(0x1ce)+_0x1a4c48(0x279)+_0x5db8bb[_0x1a4c48(0x19e)]+'\x20'+_0x1a4c48(0x1bd)+'\x20Order\x20Date\x20:\x20'+_0x5db8bb[_0x1a4c48(0x180)]+'\x20'+_0x1a4c48(0x28d)+_0x1a4c48(0x184)+_0x1a4c48(0x206)+_0x1a4c48(0x18b)+_0x1a4c48(0x236)+'<tr>'+_0x1a4c48(0x23e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x1a4c48(0x230)+_0x1a4c48(0x294)+_0x1a4c48(0x221)+_0x1a4c48(0x16c)+_0x1a4c48(0x22f)+_0x1a4c48(0x1df)+_0x1a4c48(0x288)+'</thead>'+_0x1a4c48(0x283)+'\x20'+_0x21677b+'\x20'+'</tbody>'+_0x1a4c48(0x1a9)+_0x1a4c48(0x18f)+'<strong>\x20Regards\x20</strong>'+_0x1a4c48(0x179)+_0x2c5fe8[0x0][_0x1a4c48(0x216)]+_0x1a4c48(0x184)+'</div>'+_0x1a4c48(0x206)+_0x1a4c48(0x2b2)};_0x27044f[_0x1a4c48(0x1eb)](_0xb5c1ac,function(_0x573802,_0x464bba){var _0x38beb9=_0x1a4c48;_0x573802?(console['log'](_0x573802),console['log'](_0x38beb9(0x296))):console[_0x38beb9(0x1b3)](_0x38beb9(0x1d0));}),_0x5ff925[_0x1a4c48(0x215)]('success','Sales\x20Update\x20successfully'),_0x29412b[_0x1a4c48(0x2a0)](_0x1a4c48(0x2b6)+_0x7ebb84);}catch(_0x570879){console[_0x1a4c48(0x28b)](_0x570879),_0x29412b[_0x1a4c48(0x1b0)](0x1f4)[_0x1a4c48(0x224)]({'error':_0x1a4c48(0x248)});}})[_0x59956b(0x18e)](_0x92e607=>{var _0x161809=_0x59956b;console[_0x161809(0x28b)](_0x92e607),_0x29412b['status'](0x1f4)[_0x161809(0x224)]({'error':_0x161809(0x219)});});}catch(_0xb672b0){console['log'](_0xb672b0);}}),router[a0_0x298c51(0x1ad)](a0_0x298c51(0x183),auth,async(_0x2ac326,_0xdd23f8)=>{var _0x4cd50e=a0_0x298c51;try{const {username:_0x2e76a4,email:_0x25d7fe,role:_0xf2d9e0}=_0x2ac326[_0x4cd50e(0x295)],_0x8cbb11=_0x2ac326[_0x4cd50e(0x295)],_0x28e1c4=await profile['findOne']({'email':_0x8cbb11['email']}),_0x3906d4=await master_shop['find'](),_0x4f3eae=_0x2ac326[_0x4cd50e(0x1f8)]['id'],_0x5c230c=await sales_finished[_0x4cd50e(0x1f5)](_0x4f3eae);let _0x5f1412=new Date(_0x5c230c[_0x4cd50e(0x173)]),_0x4f8040=('0'+_0x5f1412[_0x4cd50e(0x1ff)]())[_0x4cd50e(0x287)](-0x2),_0x8cd444=('0'+(_0x5f1412[_0x4cd50e(0x271)]()+0x1))['slice'](-0x2),_0x40605f=_0x5f1412[_0x4cd50e(0x28c)](),_0x1db316=_0x40605f+'-'+_0x8cd444+'-'+_0x4f8040;var _0x46d4a8=[_0x4cd50e(0x182),'Enclosed'];const _0x506b4c=await warehouse[_0x4cd50e(0x2ae)]([{'$match':{'name':_0x5c230c[_0x4cd50e(0x27e)],'room':_0x5c230c[_0x4cd50e(0x23f)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4cd50e(0x1cc)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4cd50e(0x24b)},'bin':{'$first':_0x4cd50e(0x190)},'type':{'$first':_0x4cd50e(0x1de)},'floorlevel':{'$first':_0x4cd50e(0x2b7)},'primary_code':{'$first':_0x4cd50e(0x263)},'secondary_code':{'$first':_0x4cd50e(0x1e0)},'product_code':{'$first':_0x4cd50e(0x286)},'storage':{'$first':_0x4cd50e(0x1a4)},'rack':{'$first':'$product_details.rack'}}}]),_0x213587=await customer[_0x4cd50e(0x280)]({});let _0x590d70;if(_0x8cbb11[_0x4cd50e(0x1c6)]==_0x4cd50e(0x1c1)){const _0x3c8d3e=await staff[_0x4cd50e(0x28f)]({'email':_0x8cbb11[_0x4cd50e(0x21a)]});_0x590d70=await warehouse[_0x4cd50e(0x2ae)]([{'$match':{'status':_0x4cd50e(0x2a5),'name':_0x3c8d3e[_0x4cd50e(0x246)]}},{'$group':{'_id':_0x4cd50e(0x227),'name':{'$first':_0x4cd50e(0x227)}}}]);}else _0x590d70=await warehouse['aggregate']([{'$match':{'status':_0x4cd50e(0x2a5)}},{'$group':{'_id':'$name','name':{'$first':_0x4cd50e(0x227)}}}]);const _0x369b69=await product[_0x4cd50e(0x280)]({});if(_0x3906d4[0x0]['language']==_0x4cd50e(0x1b5)){var _0x4496c0=users[_0x4cd50e(0x1c2)];console[_0x4cd50e(0x1b3)](_0x4496c0);}else{if(_0x3906d4[0x0][_0x4cd50e(0x1d2)]==_0x4cd50e(0x1ab))var _0x4496c0=users[_0x4cd50e(0x1ab)];else{if(_0x3906d4[0x0][_0x4cd50e(0x1d2)]==_0x4cd50e(0x25a))var _0x4496c0=users[_0x4cd50e(0x25a)];else{if(_0x3906d4[0x0]['language']==_0x4cd50e(0x1c7))var _0x4496c0=users[_0x4cd50e(0x1c7)];else{if(_0x3906d4[0x0][_0x4cd50e(0x1d2)]==_0x4cd50e(0x273))var _0x4496c0=users[_0x4cd50e(0x273)];else{if(_0x3906d4[0x0][_0x4cd50e(0x1d2)]==_0x4cd50e(0x235))var _0x4496c0=users['Portuguese'];else{if(_0x3906d4[0x0][_0x4cd50e(0x1d2)]==_0x4cd50e(0x1f4))var _0x4496c0=users['Chinese'];else{if(_0x3906d4[0x0]['language']==_0x4cd50e(0x1d4))var _0x4496c0=users[_0x4cd50e(0x2b5)];}}}}}}}_0xdd23f8[_0x4cd50e(0x1ca)](_0x4cd50e(0x1e6),{'success':_0x2ac326[_0x4cd50e(0x215)]('success'),'errors':_0x2ac326[_0x4cd50e(0x215)](_0x4cd50e(0x1ac)),'role':_0x8cbb11,'profile':_0x28e1c4,'customer':_0x213587,'warehouse':_0x590d70,'product':_0x506b4c,'user':_0x5c230c,'master_shop':_0x3906d4,'unit':_0x369b69,'language':_0x4496c0,'rooms_data':_0x46d4a8,'ed_fullDate':_0x1db316});}catch(_0x2f4fa3){console[_0x4cd50e(0x1b3)](_0x2f4fa3);}}),router[a0_0x298c51(0x1dd)](a0_0x298c51(0x183),auth,async(_0x3520a7,_0x13e811)=>{var _0x27d913=a0_0x298c51;try{const _0x8f4cf0=_0x3520a7[_0x27d913(0x1f8)]['id'],_0x2dadc9=await sales_finished['findOne']({'_id':_0x3520a7[_0x27d913(0x1f8)]['id']}),_0x1a7a24=await warehouse[_0x27d913(0x28f)]({'name':_0x2dadc9['warehouse_name'],'room':_0x3520a7[_0x27d913(0x26e)]['room'],'warehouse_category':'Finished\x20Goods'}),{invoice:_0x5e25fb,customer:_0x47b00e,date:_0xd08b7,warehouse_name:_0xfa5155,product_name:_0x4e2ca0,stock:_0xa1c300,adjust_qty:_0x5c5d9a,note:_0x53cfc2,room:_0x2da4f1,primary_code:_0x16f8de,secondary_code:_0x262264,prod_code:_0x2f89fc,level:_0x7ab432,isle:_0x1483cf,pallet:_0x4d523b,expiry_date:_0x39f908}=_0x3520a7[_0x27d913(0x26e)];if(typeof _0x4e2ca0==_0x27d913(0x1bc))var _0x29f070=[_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x1ed)]],_0x410913=[_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x189)]],_0x21ec1c=[_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x1a0)]],_0x455cd5=[_0x3520a7['body']['primary_code']],_0x7127dd=[_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x1b1)]],_0x3b8eac=[_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x251)]],_0xa061c3=[_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x293)]],_0x12a730=[_0x3520a7[_0x27d913(0x26e)]['expiry_date']];else var _0x29f070=[..._0x3520a7['body']['product_name']],_0x410913=[..._0x3520a7[_0x27d913(0x26e)][_0x27d913(0x189)]],_0x21ec1c=[..._0x3520a7[_0x27d913(0x26e)]['adjust_qty']],_0x455cd5=[..._0x3520a7['body'][_0x27d913(0x1be)]],_0x7127dd=[..._0x3520a7[_0x27d913(0x26e)][_0x27d913(0x1b1)]],_0x3b8eac=[..._0x3520a7['body'][_0x27d913(0x251)]],_0xa061c3=[..._0x3520a7[_0x27d913(0x26e)]['level']],_0x12a730=[..._0x3520a7[_0x27d913(0x26e)][_0x27d913(0x173)]];const _0x1a264b=_0x29f070[_0x27d913(0x25c)](_0x44c466=>{return _0x44c466={'product_name':_0x44c466};});_0x410913[_0x27d913(0x172)]((_0x4532db,_0x4ef3f0)=>{var _0x1e75c4=_0x27d913;_0x1a264b[_0x4ef3f0][_0x1e75c4(0x189)]=_0x4532db;}),_0x21ec1c[_0x27d913(0x172)]((_0x5ee59c,_0x1322a0)=>{var _0x364f0e=_0x27d913;_0x1a264b[_0x1322a0][_0x364f0e(0x199)]=_0x5ee59c;}),_0x455cd5[_0x27d913(0x172)]((_0x34a330,_0x282b1d)=>{_0x1a264b[_0x282b1d]['primary_code']=_0x34a330;}),_0x7127dd['forEach']((_0x13902a,_0x30dc41)=>{var _0x304005=_0x27d913;_0x1a264b[_0x30dc41][_0x304005(0x1b1)]=_0x13902a;}),_0x3b8eac[_0x27d913(0x172)]((_0xf63c2,_0x55a8d0)=>{var _0x555152=_0x27d913;_0x1a264b[_0x55a8d0][_0x555152(0x27f)]=_0xf63c2;}),_0xa061c3['forEach']((_0x26178c,_0x6dafd1)=>{var _0x2b3c76=_0x27d913;_0x1a264b[_0x6dafd1][_0x2b3c76(0x293)]=_0x26178c;}),_0x12a730[_0x27d913(0x172)]((_0x1e8718,_0x1e3883)=>{var _0x541324=_0x27d913;_0x1a264b[_0x1e3883][_0x541324(0x173)]=_0x1e8718;});var _0x5e8e6e=0x0;_0x1a264b[_0x27d913(0x172)](_0x4adc08=>{var _0x36e964=_0x27d913;console['log'](_0x36e964(0x228),_0x4adc08),(parseInt(_0x4adc08['stock'])<parseInt(_0x4adc08[_0x36e964(0x199)])||parseInt(_0x4adc08[_0x36e964(0x199)])==0x0)&&_0x5e8e6e++;});if(_0x5e8e6e!=0x0)return _0x3520a7[_0x27d913(0x215)](_0x27d913(0x1ac),_0x27d913(0x1e9)),_0x13e811[_0x27d913(0x2a0)]('back');_0x2dadc9['sale_product'][_0x27d913(0x172)](_0x31464a=>{var _0x303ed6=_0x27d913;const _0x3f3689=_0x1a7a24[_0x303ed6(0x2ac)][_0x303ed6(0x25c)](_0x561f11=>{var _0x3df8da=_0x303ed6;_0x561f11[_0x3df8da(0x1ed)]==_0x31464a[_0x3df8da(0x1ed)]&&_0x561f11['bay']==_0x31464a[_0x3df8da(0x205)]&&(_0x561f11[_0x3df8da(0x17e)]=parseInt(_0x561f11[_0x3df8da(0x17e)])+parseInt(_0x31464a[_0x3df8da(0x199)]));});}),await _0x1a7a24[_0x27d913(0x239)]();const _0x3dd6aa=_0x1a264b[_0x27d913(0x171)](_0x1134e0=>_0x1134e0['quantity']!=='0'&&_0x1134e0[_0x27d913(0x199)]!=='');_0x2dadc9['invoice']=_0x5e25fb,_0x2dadc9[_0x27d913(0x256)]=_0x47b00e,_0x2dadc9[_0x27d913(0x180)]=_0xd08b7,_0x2dadc9['warehouse_name']=_0xfa5155,_0x2dadc9[_0x27d913(0x170)]=_0x3dd6aa,_0x2dadc9['note']=_0x53cfc2,_0x2dadc9[_0x27d913(0x23f)]=_0x2da4f1;const _0x102998=await _0x2dadc9['save'](),_0x567588=await sales_finished[_0x27d913(0x28f)]({'_id':_0x3520a7['params']['id']}),_0x5706cb=await warehouse[_0x27d913(0x28f)]({'name':_0xfa5155,'room':_0x2da4f1,'warehouse_category':_0x27d913(0x1fb)});_0x567588[_0x27d913(0x170)][_0x27d913(0x172)](_0x23eb6c=>{var _0x29e914=_0x27d913;const _0x38ce71=_0x5706cb[_0x29e914(0x2ac)][_0x29e914(0x25c)](_0x98b02d=>{var _0x1a23f9=_0x29e914;_0x98b02d['product_name']==_0x23eb6c[_0x1a23f9(0x1ed)]&&_0x98b02d['bay']==_0x23eb6c[_0x1a23f9(0x205)]&&(_0x98b02d[_0x1a23f9(0x17e)]=parseInt(_0x98b02d[_0x1a23f9(0x17e)])-parseInt(_0x23eb6c[_0x1a23f9(0x199)]));});}),console['log'](_0x27d913(0x240),_0x5706cb),await _0x5706cb['save']();const _0x659fc2=await c_payment_data[_0x27d913(0x28f)]({'invoice':_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x19e)]});_0x659fc2[_0x27d913(0x27a)]=_0x3520a7[_0x27d913(0x26e)][_0x27d913(0x27a)],await _0x659fc2[_0x27d913(0x239)](),_0x3520a7[_0x27d913(0x215)](_0x27d913(0x21e),_0x27d913(0x249)),_0x13e811[_0x27d913(0x2a0)](_0x27d913(0x1d6));}catch(_0x1bf7e5){console[_0x27d913(0x1b3)](_0x1bf7e5);}}),router['post'](a0_0x298c51(0x174),auth,async(_0x5485f5,_0x47b204)=>{var _0x4f9a77=a0_0x298c51;try{const _0x341e47=_0x5485f5[_0x4f9a77(0x1f8)]['id'],{invoice:_0x3fbc34,customer:_0x30c125,receivable_amount:_0x17d40e,received_amount:_0x58116b}=_0x5485f5[_0x4f9a77(0x26e)],_0x1195b1=await sales[_0x4f9a77(0x1f5)](_0x341e47);console['log'](_0x1195b1);var _0x3fd7b1=_0x17d40e-_0x58116b;console[_0x4f9a77(0x1b3)](_0x58116b),_0x1195b1[_0x4f9a77(0x19c)]=parseFloat(_0x58116b)+parseFloat(_0x1195b1[_0x4f9a77(0x19c)]),_0x1195b1[_0x4f9a77(0x193)]=_0x3fd7b1,console['log'](_0x1195b1);const _0x41b3b3=await _0x1195b1[_0x4f9a77(0x239)](),_0x3a6f87=await c_payment_data['findOne']({'invoice':_0x3fbc34});_0x3a6f87[_0x4f9a77(0x1b7)]=_0x3fd7b1,await _0x3a6f87[_0x4f9a77(0x239)]();let _0x2fdecc=new Date(),_0x30e56b=('0'+_0x2fdecc[_0x4f9a77(0x1ff)]())[_0x4f9a77(0x287)](-0x2),_0x2e362e=('0'+(_0x2fdecc[_0x4f9a77(0x271)]()+0x1))[_0x4f9a77(0x287)](-0x2),_0x53735d=_0x2fdecc[_0x4f9a77(0x28c)](),_0xf12816=_0x53735d+'-'+_0x2e362e+'-'+_0x30e56b;const _0x1caa3d=new customer_payment({'invoice':_0x3fbc34,'date':_0x53735d+'-'+_0x2e362e+'-'+_0x30e56b,'customer':_0x30c125,'reason':_0x4f9a77(0x222),'amount':_0x58116b}),_0x487431=await _0x1caa3d[_0x4f9a77(0x239)]();_0x5485f5[_0x4f9a77(0x215)](_0x4f9a77(0x21e),_0x4f9a77(0x1b8)),_0x47b204[_0x4f9a77(0x2a0)](_0x4f9a77(0x22d));}catch(_0x4be884){console[_0x4f9a77(0x1b3)](_0x4be884);}}),router[a0_0x298c51(0x1ad)](a0_0x298c51(0x25e),auth,async(_0x47308d,_0x4a36a7)=>{var _0x4f25f1=a0_0x298c51;try{const {username:_0x3bdbff,email:_0x465472,role:_0x3fb044}=_0x47308d['user'],_0x57b7eb=_0x47308d[_0x4f25f1(0x295)],_0x433337=await profile['findOne']({'email':_0x57b7eb[_0x4f25f1(0x21a)]}),_0x2577a5=await master_shop[_0x4f25f1(0x280)]();console[_0x4f25f1(0x1b3)](_0x4f25f1(0x2aa),_0x2577a5);const _0x6c9e1a=_0x47308d[_0x4f25f1(0x1f8)]['id'],_0x3b8056=await sales[_0x4f25f1(0x1f5)](_0x6c9e1a);console[_0x4f25f1(0x1b3)](_0x3b8056);const _0x30c52d=await customer[_0x4f25f1(0x28f)]({'name':_0x3b8056['customer']});console[_0x4f25f1(0x1b3)](_0x30c52d);if(_0x2577a5[0x0]['language']=='English\x20(US)'){var _0x26c43e=users['English'];console['log'](_0x26c43e);}else{if(_0x2577a5[0x0]['language']==_0x4f25f1(0x1ab))var _0x26c43e=users[_0x4f25f1(0x1ab)];else{if(_0x2577a5[0x0][_0x4f25f1(0x1d2)]==_0x4f25f1(0x25a))var _0x26c43e=users[_0x4f25f1(0x25a)];else{if(_0x2577a5[0x0][_0x4f25f1(0x1d2)]==_0x4f25f1(0x1c7))var _0x26c43e=users['Spanish'];else{if(_0x2577a5[0x0][_0x4f25f1(0x1d2)]==_0x4f25f1(0x273))var _0x26c43e=users[_0x4f25f1(0x273)];else{if(_0x2577a5[0x0][_0x4f25f1(0x1d2)]==_0x4f25f1(0x235))var _0x26c43e=users[_0x4f25f1(0x22c)];else{if(_0x2577a5[0x0][_0x4f25f1(0x1d2)]=='Chinese')var _0x26c43e=users[_0x4f25f1(0x1f4)];else{if(_0x2577a5[0x0]['language']==_0x4f25f1(0x1d4))var _0x26c43e=users['Arabic'];}}}}}}}_0x4a36a7[_0x4f25f1(0x1ca)]('sales_invoice',{'success':_0x47308d['flash']('success'),'errors':_0x47308d['flash'](_0x4f25f1(0x1ac)),'role':_0x57b7eb,'profile':_0x433337,'master_shop':_0x2577a5,'customers':_0x30c52d,'sales':_0x3b8056,'language':_0x26c43e});}catch(_0x296593){console[_0x4f25f1(0x1b3)](_0x296593);}}),router[a0_0x298c51(0x1ad)]('/view/return_sales/:id',auth,async(_0x3696e5,_0x2b4e6d)=>{var _0x103096=a0_0x298c51;try{const {username:_0x3a4351,email:_0xc33a6c,role:_0x4f4468}=_0x3696e5[_0x103096(0x295)],_0x17b913=_0x3696e5['user'],_0x38eebd=await profile['findOne']({'email':_0x17b913['email']}),_0x3e315e=await master_shop['find'](),_0xa9f42a=_0x3696e5['params']['id'],_0x493530=await sales_finished[_0x103096(0x1f5)](_0xa9f42a),_0x4e997d=await warehouse[_0x103096(0x2ae)]([{'$match':{'name':_0x493530[_0x103096(0x27e)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x103096(0x200),'name':{'$first':_0x103096(0x1cc)},'product_stock':{'$first':_0x103096(0x175)},'bay':{'$first':_0x103096(0x24b)},'bin':{'$first':_0x103096(0x190)},'type':{'$first':_0x103096(0x1de)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x103096(0x263)},'secondary_code':{'$first':_0x103096(0x1e0)},'product_code':{'$first':_0x103096(0x286)},'storage':{'$first':_0x103096(0x1a4)},'rack':{'$first':_0x103096(0x29f)},'expiry_date':{'$first':_0x103096(0x1af)},'production_date':{'$first':_0x103096(0x16d)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x103096(0x29b)},'maxProducts':{'$first':_0x103096(0x231)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x103096(0x1bf)}}}]),_0x12120e=await product[_0x103096(0x280)]({}),_0x5aeba5=await warehouse[_0x103096(0x2ae)]([{'$match':{'status':_0x103096(0x2a5),'warehouse_category':_0x103096(0x1fb),'name':{'$ne':_0x103096(0x282),'$ne':_0x103096(0x217)}}},{'$group':{'_id':_0x103096(0x227),'name':{'$first':_0x103096(0x227)}}},{'$sort':{'name':0x1}}]);var _0x9542be=['Return\x20Rooms'];const _0xded405=await warehouse[_0x103096(0x2ae)]([{'$match':{'status':_0x103096(0x2a5),'name':_0x103096(0x217)}},{'$group':{'_id':_0x103096(0x227),'name':{'$first':_0x103096(0x227)}}},{'$sort':{'name':0x1}}]);if(_0x3e315e[0x0]['language']==_0x103096(0x1b5)){var _0xee72cd=users[_0x103096(0x1c2)];console[_0x103096(0x1b3)](_0xee72cd);}else{if(_0x3e315e[0x0][_0x103096(0x1d2)]=='Hindi')var _0xee72cd=users[_0x103096(0x1ab)];else{if(_0x3e315e[0x0][_0x103096(0x1d2)]=='German')var _0xee72cd=users['German'];else{if(_0x3e315e[0x0]['language']==_0x103096(0x1c7))var _0xee72cd=users['Spanish'];else{if(_0x3e315e[0x0][_0x103096(0x1d2)]==_0x103096(0x273))var _0xee72cd=users[_0x103096(0x273)];else{if(_0x3e315e[0x0]['language']=='Portuguese\x20(BR)')var _0xee72cd=users['Portuguese'];else{if(_0x3e315e[0x0][_0x103096(0x1d2)]==_0x103096(0x1f4))var _0xee72cd=users['Chinese'];else{if(_0x3e315e[0x0][_0x103096(0x1d2)]==_0x103096(0x1d4))var _0xee72cd=users[_0x103096(0x2b5)];}}}}}}}_0x2b4e6d[_0x103096(0x1ca)](_0x103096(0x16e),{'success':_0x3696e5['flash'](_0x103096(0x21e)),'errors':_0x3696e5[_0x103096(0x215)]('errors'),'role':_0x17b913,'profile':_0x38eebd,'user':_0x493530,'stock':_0x4e997d,'master_shop':_0x3e315e,'unit':_0x12120e,'language':_0xee72cd,'warehouses':_0x5aeba5,'rooms':_0x9542be,'warehouse_QA':_0xded405});}catch(_0x3393b8){console[_0x103096(0x1b3)](_0x3393b8),_0x2b4e6d[_0x103096(0x1b0)](0xc8)['json']({'message':_0x3393b8['message']});}}),router[a0_0x298c51(0x1dd)](a0_0x298c51(0x17b),auth,async(_0x553c58,_0x34e2a0)=>{var _0x228821=a0_0x298c51;if(_0x553c58[_0x228821(0x26e)]['for_categorize']=='QA')try{const {invoice:_0x24a1e3,date:_0x538302,warehouse_name:_0x5ecca1,product_name:_0x45287b,primary_code:_0x161c8b,secondary_code:_0x41fdf3,product_code:_0x1e15be,sales_quantity:_0x4deb0a,stocks:_0x5dd1ae,return_qty:_0x51cacd,Room_name:_0x12b965,to_warehouse_name_QA:_0x1fe906,to_Room_name_QA:_0x1f5e06,note:_0x1fb1a9,for_categorize:_0x1360ee,product_name_QA1:_0x46d59b}=_0x553c58['body'];if(typeof _0x46d59b==_0x228821(0x1bc))var _0x5dfd48=[_0x553c58[_0x228821(0x26e)][_0x228821(0x220)]],_0x30459a=[_0x553c58[_0x228821(0x26e)][_0x228821(0x285)]],_0xf31e01=[_0x553c58['body'][_0x228821(0x23a)]],_0x2bb9fc=[_0x553c58[_0x228821(0x26e)][_0x228821(0x208)]],_0x643bca=[_0x553c58['body'][_0x228821(0x261)]],_0x22ad89=[_0x553c58[_0x228821(0x26e)][_0x228821(0x1da)]],_0x10c31a=[_0x553c58['body'][_0x228821(0x19a)]],_0x13fe81=[_0x553c58[_0x228821(0x26e)][_0x228821(0x1c8)]],_0x4053ce=[_0x553c58[_0x228821(0x26e)][_0x228821(0x1b2)]],_0x45517c=[_0x553c58[_0x228821(0x26e)][_0x228821(0x1fa)]],_0x464a53=[_0x553c58[_0x228821(0x26e)][_0x228821(0x1cd)]],_0x38e4b6=[_0x553c58[_0x228821(0x26e)][_0x228821(0x19b)]],_0xe6e38d=[_0x553c58[_0x228821(0x26e)][_0x228821(0x270)]],_0x41c06b=[_0x553c58[_0x228821(0x26e)]['expiry_date_QA']];else var _0x5dfd48=[..._0x553c58[_0x228821(0x26e)]['product_name_QA1']],_0x30459a=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x285)]],_0xf31e01=[..._0x553c58['body'][_0x228821(0x23a)]],_0x2bb9fc=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x208)]],_0x643bca=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x261)]],_0x22ad89=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x1da)]],_0x10c31a=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x19a)]],_0x13fe81=[..._0x553c58['body'][_0x228821(0x1c8)]],_0x4053ce=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x1b2)]],_0x45517c=[..._0x553c58['body'][_0x228821(0x1fa)]],_0x464a53=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x1cd)]],_0x38e4b6=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x19b)]],_0xe6e38d=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x270)]],_0x41c06b=[..._0x553c58[_0x228821(0x26e)]['expiry_date_QA']];const _0x337e58=_0x5dfd48['map'](_0x458432=>{return _0x458432={'product_name':_0x458432};});_0x30459a[_0x228821(0x172)]((_0x428b24,_0x5d95b4)=>{_0x337e58[_0x5d95b4]['primary_code']=_0x428b24;}),_0xf31e01[_0x228821(0x172)]((_0x3b2db1,_0x33595e)=>{var _0x4fe570=_0x228821;_0x337e58[_0x33595e][_0x4fe570(0x1b1)]=_0x3b2db1;}),_0x2bb9fc['forEach']((_0x316b43,_0x4e4635)=>{var _0x240190=_0x228821;_0x337e58[_0x4e4635][_0x240190(0x27f)]=_0x316b43;}),_0x643bca[_0x228821(0x172)]((_0x509a6e,_0x15d829)=>{var _0x1b13d9=_0x228821;_0x337e58[_0x15d829][_0x1b13d9(0x252)]=_0x509a6e;}),_0x22ad89[_0x228821(0x172)]((_0x4188ec,_0x23f617)=>{var _0x334932=_0x228821;_0x337e58[_0x23f617][_0x334932(0x189)]=_0x4188ec;}),_0x10c31a['forEach']((_0x1be370,_0x2dd683)=>{_0x337e58[_0x2dd683]['return_qty']=_0x1be370;}),_0x13fe81[_0x228821(0x172)]((_0x12abe5,_0x140fc6)=>{_0x337e58[_0x140fc6]['maxPerUnit']=_0x12abe5;}),_0x4053ce[_0x228821(0x172)]((_0x1c06f9,_0x450d2e)=>{var _0x1c5bf7=_0x228821;_0x337e58[_0x450d2e][_0x1c5bf7(0x2a2)]=_0x1c06f9;}),_0x45517c[_0x228821(0x172)]((_0x5e0e97,_0x4ce377)=>{var _0x5e1a35=_0x228821;_0x337e58[_0x4ce377][_0x5e1a35(0x186)]=_0x5e0e97;}),_0x464a53['forEach']((_0x56ba49,_0x2c1d5c)=>{var _0x3a5839=_0x228821;_0x337e58[_0x2c1d5c][_0x3a5839(0x209)]=_0x56ba49;}),_0x38e4b6['forEach']((_0x21b8ea,_0x46bb5e)=>{_0x337e58[_0x46bb5e]['unit']=_0x21b8ea;}),_0xe6e38d[_0x228821(0x172)]((_0x1b52e2,_0x5d8bc8)=>{var _0x30cf7a=_0x228821;_0x337e58[_0x5d8bc8][_0x30cf7a(0x264)]=_0x1b52e2;}),_0x41c06b['forEach']((_0x2bfe3a,_0x468d8e)=>{var _0x52fb68=_0x228821;_0x337e58[_0x468d8e][_0x52fb68(0x173)]=_0x2bfe3a;});const _0x41e268=await sales_finished[_0x228821(0x28f)]({'invoice':_0x24a1e3});_0x41e268[_0x228821(0x233)]=_0x228821(0x254);const _0x46fd72=await _0x41e268[_0x228821(0x239)](),_0x45cb88=new sales_return_finished({'invoice':_0x24a1e3,'customer':_0x553c58['body']['customer'],'date':_0x538302,'warehouse_name':_0x5ecca1,'room':_0x12b965,'ToWarehouse':_0x1fe906,'ToRoom':_0x1f5e06,'return_sale_QA':_0x337e58,'note':_0x1fb1a9,'warehouse_cat':_0x1360ee}),_0x5c93bb=await _0x45cb88[_0x228821(0x239)](),_0x1b0232=await sales_return_finished[_0x228821(0x28f)]({'invoice':_0x24a1e3}),_0x352513=await warehouse[_0x228821(0x28f)]({'name':_0x1fe906,'room':_0x1f5e06});_0x1b0232[_0x228821(0x17c)]['forEach'](_0x3ec14d=>{var _0x2eed71=_0x228821,_0xa26e21=0x0;const _0x13a90a=_0x352513[_0x2eed71(0x2ac)][_0x2eed71(0x25c)](_0x4d900f=>{var _0x4515f3=_0x2eed71;_0x4d900f[_0x4515f3(0x1ed)]==_0x3ec14d['product_name']&&_0x4d900f[_0x4515f3(0x173)]==_0x3ec14d[_0x4515f3(0x173)]&&_0x4d900f[_0x4515f3(0x264)]==_0x3ec14d['production_date']&&_0x4d900f['batch_code']==_0x3ec14d['batch_code']&&(_0x4d900f['product_stock']=parseInt(_0x4d900f['product_stock'])+parseInt(_0x3ec14d[_0x4515f3(0x1fd)]),_0xa26e21++);});_0xa26e21=='0'&&(_0x352513[_0x2eed71(0x2ac)]=_0x352513['product_details']['concat']({'product_name':_0x3ec14d[_0x2eed71(0x1ed)],'product_stock':_0x3ec14d[_0x2eed71(0x1fd)],'primary_code':_0x3ec14d[_0x2eed71(0x1be)],'secondary_code':_0x3ec14d['secondary_code'],'product_code':_0x3ec14d['product_code'],'batch_code':_0x3ec14d['batch_code'],'maxPerUnit':_0x3ec14d[_0x2eed71(0x17a)],'production_date':_0x3ec14d['production_date'],'expiry_date':_0x3ec14d[_0x2eed71(0x173)],'secondary_unit':_0x3ec14d[_0x2eed71(0x209)],'unit':_0x3ec14d[_0x2eed71(0x284)],'maxProducts':_0x3ec14d[_0x2eed71(0x2a2)],'bay':_0x3ec14d['bay']}));}),await _0x352513['save']();const _0x2b7e05=new c_payment_data({'invoice':_0x24a1e3,'customer':_0x553c58[_0x228821(0x26e)][_0x228821(0x256)],'reason':'Sale\x20Return'});await _0x2b7e05[_0x228821(0x239)]();const _0x43185f=await master_shop[_0x228821(0x280)](),_0x15bc34=await email_settings[_0x228821(0x28f)](),_0x419e2a=await customer[_0x228821(0x28f)]({'name':_0x553c58[_0x228821(0x26e)][_0x228821(0x256)]});_0x43185f[0x0][_0x228821(0x23c)]==0x1?(right_currency=_0x43185f[0x0][_0x228821(0x1e7)],left_currency=''):(right_currency='',left_currency=_0x43185f[0x0][_0x228821(0x1e7)]);var _0x56334e=_0x5dfd48,_0x1918a8=_0x10c31a,_0xd1befc='',_0x5d80dc;for(_0x5d80dc in _0x56334e){_0xd1befc+=_0x228821(0x187)+_0x228821(0x1d8)+_0x56334e[_0x5d80dc]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1918a8[_0x5d80dc]+_0x228821(0x26b)+_0x228821(0x288);}console[_0x228821(0x1b3)](_0x228821(0x1ef),_0xd1befc);let _0x2208a4=nodemailer['createTransport']({'service':_0x228821(0x1ba),'auth':{'user':_0x15bc34[_0x228821(0x21a)],'pass':_0x15bc34[_0x228821(0x278)]}}),_0x39aeb1={'from':_0x15bc34[_0x228821(0x21a)],'to':_0x419e2a['email'],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x228821(0x229)+_0x228821(0x265)+_0x43185f[0x0][_0x228821(0x281)],'cid':_0x228821(0x1cb)}],'html':_0x228821(0x203)+_0x228821(0x2b3)+_0x228821(0x2b1)+_0x228821(0x18f)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x228821(0x18f)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x228821(0x206)+_0x228821(0x18f)+_0x228821(0x1c0)+_0x43185f[0x0][_0x228821(0x216)]+'\x20</h2>'+_0x228821(0x206)+_0x228821(0x206)+'<hr\x20class=\x22my-3\x22>'+_0x228821(0x18f)+_0x228821(0x1ce)+_0x228821(0x279)+_0x24a1e3+'\x20'+_0x228821(0x1bd)+_0x228821(0x272)+_0x538302+'\x20'+_0x228821(0x28d)+_0x228821(0x184)+_0x228821(0x206)+_0x228821(0x18b)+_0x228821(0x236)+'<tr>'+_0x228821(0x23e)+_0x228821(0x21c)+_0x228821(0x29a)+_0x228821(0x192)+_0x228821(0x288)+_0x228821(0x1fc)+_0x228821(0x283)+'\x20'+_0xd1befc+'\x20'+_0x228821(0x185)+_0x228821(0x1a9)+_0x228821(0x18f)+_0x228821(0x244)+'<h5>'+_0x43185f[0x0][_0x228821(0x216)]+'</h5>'+_0x228821(0x206)+_0x228821(0x206)+_0x228821(0x2b2)};_0x2208a4['sendMail'](_0x39aeb1,function(_0x3f4ce0,_0x4f72bd){var _0x2c859f=_0x228821;_0x3f4ce0?(console[_0x2c859f(0x1b3)](_0x3f4ce0),console[_0x2c859f(0x1b3)]('Error\x20Occurs')):console[_0x2c859f(0x1b3)](_0x2c859f(0x1d0));}),_0x553c58[_0x228821(0x215)]('success',_0x228821(0x202)),_0x34e2a0['redirect'](_0x228821(0x1d6));}catch(_0x4de339){_0x34e2a0[_0x228821(0x1b0)](0xc8)['json']({'message1':_0x4de339[_0x228821(0x257)]});}else{if(_0x553c58[_0x228821(0x26e)][_0x228821(0x269)]=='GS')try{const {invoice:_0x11c666,date:_0x5d7681,warehouse_name:_0x15f13e,product_name:_0x5d4e27,primary_code:_0x932c58,secondary_code:_0x525967,product_code:_0x19cb09,sales_quantity:_0x3fe497,stocks:_0x47ec5b,return_qty:_0x1ae416,Room_name:_0x5745fb,to_warehouse_name:_0x47d880,to_Room_name:_0x7ad2c6,note:_0xc1a9b9,level:_0x58e9e2,isle:_0x3e0254,pallet:_0x35069e,for_categorize:_0x1912f5}=_0x553c58[_0x228821(0x26e)];if(typeof _0x5d4e27=='string')var _0x5dfd48=[_0x553c58[_0x228821(0x26e)][_0x228821(0x1ed)]],_0x30459a=[_0x553c58['body']['primary_code']],_0xf31e01=[_0x553c58[_0x228821(0x26e)]['secondary_code']],_0x2bb9fc=[_0x553c58[_0x228821(0x26e)][_0x228821(0x27f)]],_0x643bca=[_0x553c58[_0x228821(0x26e)][_0x228821(0x1d1)]],_0x10c31a=[_0x553c58['body']['return_qty']],_0x55ea81=[_0x553c58['body'][_0x228821(0x205)]],_0x13fe81=[_0x553c58[_0x228821(0x26e)][_0x228821(0x17a)]],_0x4053ce=[_0x553c58[_0x228821(0x26e)]['maxProducts']],_0x45517c=[_0x553c58[_0x228821(0x26e)]['batch_code']],_0x464a53=[_0x553c58['body']['secondary_unit']],_0x38e4b6=[_0x553c58['body'][_0x228821(0x284)]],_0xe6e38d=[_0x553c58[_0x228821(0x26e)]['production_date']],_0x41c06b=[_0x553c58[_0x228821(0x26e)][_0x228821(0x173)]];else var _0x5dfd48=[..._0x553c58[_0x228821(0x26e)]['product_name']],_0x30459a=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x1be)]],_0xf31e01=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x1b1)]],_0x2bb9fc=[..._0x553c58['body'][_0x228821(0x27f)]],_0x643bca=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x1d1)]],_0x10c31a=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x1fd)]],_0x55ea81=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x205)]],_0x13fe81=[..._0x553c58[_0x228821(0x26e)]['maxPerUnit']],_0x4053ce=[..._0x553c58[_0x228821(0x26e)][_0x228821(0x2a2)]],_0x45517c=[..._0x553c58[_0x228821(0x26e)]['batch_code']],_0x464a53=[..._0x553c58[_0x228821(0x26e)]['secondary_unit']],_0x38e4b6=[..._0x553c58['body'][_0x228821(0x284)]],_0xe6e38d=[..._0x553c58['body'][_0x228821(0x264)]],_0x41c06b=[..._0x553c58['body'][_0x228821(0x173)]];const _0x3c9091=_0x5dfd48[_0x228821(0x25c)](_0x12369d=>{return _0x12369d={'product_name':_0x12369d};});_0x30459a[_0x228821(0x172)]((_0x136788,_0x34d30d)=>{_0x3c9091[_0x34d30d]['primary_code']=_0x136788;}),_0xf31e01[_0x228821(0x172)]((_0x35bb32,_0x5e1e1e)=>{var _0x59462b=_0x228821;_0x3c9091[_0x5e1e1e][_0x59462b(0x1b1)]=_0x35bb32;}),_0x2bb9fc[_0x228821(0x172)]((_0x2e57db,_0x293e5e)=>{var _0xd342e2=_0x228821;_0x3c9091[_0x293e5e][_0xd342e2(0x27f)]=_0x2e57db;}),_0x643bca[_0x228821(0x172)]((_0x1eba53,_0x134a1f)=>{var _0x818159=_0x228821;_0x3c9091[_0x134a1f][_0x818159(0x252)]=_0x1eba53;}),_0x10c31a['forEach']((_0x4b0c52,_0x18df36)=>{var _0x3591da=_0x228821;_0x3c9091[_0x18df36][_0x3591da(0x1fd)]=_0x4b0c52;}),_0x55ea81['forEach']((_0x298cfd,_0x5ec6a8)=>{var _0x7f5cd9=_0x228821;_0x3c9091[_0x5ec6a8][_0x7f5cd9(0x205)]=_0x298cfd;}),_0x13fe81[_0x228821(0x172)]((_0x2c1308,_0x2db628)=>{_0x3c9091[_0x2db628]['maxPerUnit']=_0x2c1308;}),_0x4053ce[_0x228821(0x172)]((_0x146a1b,_0x158eec)=>{var _0x1afbe7=_0x228821;_0x3c9091[_0x158eec][_0x1afbe7(0x2a2)]=_0x146a1b;}),_0x45517c['forEach']((_0x450bc7,_0x487d6c)=>{var _0x52b7d2=_0x228821;_0x3c9091[_0x487d6c][_0x52b7d2(0x186)]=_0x450bc7;}),_0x464a53[_0x228821(0x172)]((_0x15ab4e,_0x39e8d0)=>{var _0x433bea=_0x228821;_0x3c9091[_0x39e8d0][_0x433bea(0x209)]=_0x15ab4e;}),_0x38e4b6[_0x228821(0x172)]((_0x38fe03,_0x438848)=>{var _0x48da74=_0x228821;_0x3c9091[_0x438848][_0x48da74(0x284)]=_0x38fe03;}),_0xe6e38d[_0x228821(0x172)]((_0x234e5d,_0x1e5c59)=>{var _0x3e9f2f=_0x228821;_0x3c9091[_0x1e5c59][_0x3e9f2f(0x264)]=_0x234e5d;}),_0x41c06b[_0x228821(0x172)]((_0x18c450,_0x5bb4e9)=>{var _0x6bd36e=_0x228821;_0x3c9091[_0x5bb4e9][_0x6bd36e(0x173)]=_0x18c450;});var _0x54b29c=0x0;_0x3c9091[_0x228821(0x172)](_0x46443e=>{var _0x507b28=_0x228821;(parseInt(_0x46443e[_0x507b28(0x252)])<parseInt(_0x46443e[_0x507b28(0x1fd)])||parseInt(_0x46443e['stock'])<parseInt(_0x46443e[_0x507b28(0x1fd)])&&parseInt(_0x46443e[_0x507b28(0x252)])>parseInt(_0x46443e[_0x507b28(0x1fd)])||parseInt(_0x46443e[_0x507b28(0x1fd)])==0x0)&&_0x54b29c++;});if(_0x54b29c!=0x0)return _0x553c58[_0x228821(0x215)](_0x228821(0x1ac),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x34e2a0[_0x228821(0x2a0)](_0x228821(0x28a));const _0x3de54f=await sales_finished['findOne']({'invoice':_0x11c666});_0x3de54f[_0x228821(0x233)]=_0x228821(0x254);const _0x5af865=await _0x3de54f[_0x228821(0x239)](),_0x4a498e=new sales_return_finished({'invoice':_0x11c666,'customer':_0x553c58[_0x228821(0x26e)]['customer'],'date':_0x5d7681,'warehouse_name':_0x15f13e,'room':_0x5745fb,'ToWarehouse':_0x47d880,'ToRoom':_0x7ad2c6,'return_sale':_0x3c9091,'note':_0xc1a9b9,'warehouse_cat':_0x1912f5}),_0x226669=await _0x4a498e[_0x228821(0x239)](),_0x1dceb3=await sales_return_finished[_0x228821(0x28f)]({'invoice':_0x11c666}),_0x597695=await warehouse[_0x228821(0x28f)]({'name':_0x47d880,'room':_0x7ad2c6,'warehouse_category':'Finished\x20Goods'});_0x1dceb3['return_sale']['forEach'](_0xc63777=>{var _0x3a230c=_0x228821,_0x44512a=0x0;const _0x3da9a9=_0x597695[_0x3a230c(0x2ac)][_0x3a230c(0x25c)](_0x22e438=>{var _0x15c80d=_0x3a230c;_0x22e438[_0x15c80d(0x1ed)]==_0xc63777[_0x15c80d(0x1ed)]&&_0x22e438['bay']==_0xc63777[_0x15c80d(0x205)]&&_0x22e438[_0x15c80d(0x173)]==_0xc63777[_0x15c80d(0x173)]&&_0x22e438[_0x15c80d(0x264)]==_0xc63777[_0x15c80d(0x264)]&&_0x22e438[_0x15c80d(0x186)]==_0xc63777[_0x15c80d(0x186)]&&(_0x22e438[_0x15c80d(0x17e)]=parseInt(_0x22e438[_0x15c80d(0x17e)])+parseInt(_0xc63777[_0x15c80d(0x1fd)]),_0x44512a++);});_0x44512a=='0'&&(_0x597695['product_details']=_0x597695[_0x3a230c(0x2ac)][_0x3a230c(0x27c)]({'product_name':_0xc63777[_0x3a230c(0x1ed)],'product_stock':_0xc63777[_0x3a230c(0x1fd)],'primary_code':_0xc63777[_0x3a230c(0x1be)],'secondary_code':_0xc63777[_0x3a230c(0x1b1)],'product_code':_0xc63777[_0x3a230c(0x27f)],'bay':_0xc63777['bay'],'batch_code':_0xc63777[_0x3a230c(0x186)],'maxPerUnit':_0xc63777[_0x3a230c(0x17a)],'production_date':_0xc63777[_0x3a230c(0x264)],'expiry_date':_0xc63777['expiry_date'],'secondary_unit':_0xc63777[_0x3a230c(0x209)],'unit':_0xc63777['unit'],'maxProducts':_0xc63777[_0x3a230c(0x2a2)]}));}),await _0x597695[_0x228821(0x239)](),console[_0x228821(0x1b3)](_0x553c58[_0x228821(0x26e)]);const _0x1b2c56=new c_payment_data({'invoice':_0x11c666,'customer':_0x553c58[_0x228821(0x26e)]['customer'],'reason':'Sale\x20Return'});await _0x1b2c56[_0x228821(0x239)]();const _0x4ef684=await master_shop[_0x228821(0x280)]();console[_0x228821(0x1b3)](_0x228821(0x274),_0x4ef684[0x0]['image']);const _0x32f2bd=await email_settings['findOne'](),_0x1d8843=await customer['findOne']({'name':_0x553c58['body'][_0x228821(0x256)]});console[_0x228821(0x1b3)]('customer_data',_0x1d8843);_0x4ef684[0x0][_0x228821(0x23c)]==0x1?(right_currency=_0x4ef684[0x0][_0x228821(0x1e7)],left_currency=''):(right_currency='',left_currency=_0x4ef684[0x0]['currency']);var _0x56334e=_0x5dfd48,_0x1918a8=_0x10c31a,_0xd1befc='',_0x5d80dc;for(_0x5d80dc in _0x56334e){_0xd1befc+='<tr>'+_0x228821(0x1d8)+_0x56334e[_0x5d80dc]+_0x228821(0x26b)+_0x228821(0x1d8)+_0x1918a8[_0x5d80dc]+_0x228821(0x26b)+_0x228821(0x288);}console[_0x228821(0x1b3)](_0x228821(0x1ef),_0xd1befc);let _0x4477c1=nodemailer[_0x228821(0x20b)]({'service':'gmail','auth':{'user':_0x32f2bd[_0x228821(0x21a)],'pass':_0x32f2bd[_0x228821(0x278)]}}),_0x30b9e1={'from':_0x32f2bd['email'],'to':_0x1d8843[_0x228821(0x21a)],'subject':_0x228821(0x19f),'attachments':[{'filename':_0x228821(0x2b0),'path':__dirname+_0x228821(0x229)+'/upload/'+_0x4ef684[0x0][_0x228821(0x281)],'cid':_0x228821(0x1cb)}],'html':'<!DOCTYPE\x20html>'+_0x228821(0x2b3)+_0x228821(0x2b1)+'<div>'+_0x228821(0x1f7)+'<div>'+_0x228821(0x25f)+_0x228821(0x206)+_0x228821(0x18f)+'<h2>\x20'+_0x4ef684[0x0]['site_title']+_0x228821(0x1a7)+_0x228821(0x206)+_0x228821(0x206)+_0x228821(0x1b6)+'<div>'+_0x228821(0x1ce)+'\x20Order\x20Number\x20:\x20'+_0x11c666+'\x20'+_0x228821(0x1bd)+_0x228821(0x272)+_0x5d7681+'\x20'+_0x228821(0x28d)+_0x228821(0x184)+'</div>'+_0x228821(0x18b)+_0x228821(0x236)+_0x228821(0x187)+_0x228821(0x23e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x228821(0x29a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x228821(0x288)+_0x228821(0x1fc)+_0x228821(0x283)+'\x20'+_0xd1befc+'\x20'+'</tbody>'+_0x228821(0x1a9)+_0x228821(0x18f)+'<strong>\x20Regards\x20</strong>'+_0x228821(0x179)+_0x4ef684[0x0][_0x228821(0x216)]+'</h5>'+_0x228821(0x206)+'</div>'+_0x228821(0x2b2)};_0x4477c1[_0x228821(0x1eb)](_0x30b9e1,function(_0x287132,_0x2736a0){var _0x3f5369=_0x228821;_0x287132?(console[_0x3f5369(0x1b3)](_0x287132),console['log'](_0x3f5369(0x296))):console[_0x3f5369(0x1b3)](_0x3f5369(0x1d0));}),_0x553c58[_0x228821(0x215)]('success',_0x228821(0x202)),_0x34e2a0[_0x228821(0x2a0)](_0x228821(0x1d6));}catch(_0x240c01){console[_0x228821(0x1b3)](_0x240c01),_0x34e2a0['status'](0xc8)['json']({'message1':_0x240c01['message']});}}}),router['get'](a0_0x298c51(0x1c3),auth,async(_0x2cdb7c,_0x269963)=>{var _0x2f7ae2=a0_0x298c51;try{const {username:_0x5579b7,email:_0x174830,role:_0x147cb8}=_0x2cdb7c[_0x2f7ae2(0x295)],_0x48a978=_0x2cdb7c[_0x2f7ae2(0x295)],_0x461c18=await profile['findOne']({'email':_0x48a978['email']}),_0x66d544=await master_shop[_0x2f7ae2(0x280)]();console[_0x2f7ae2(0x1b3)](_0x2f7ae2(0x1dc),_0x66d544);const _0x5947e7=_0x2cdb7c[_0x2f7ae2(0x1f8)]['id'],_0x1cc1c6=await sales[_0x2f7ae2(0x1f5)](_0x5947e7);console[_0x2f7ae2(0x1b3)]('barcode\x20user_id',_0x1cc1c6);if(_0x66d544[0x0]['language']==_0x2f7ae2(0x1b5))var _0x378d59=users[_0x2f7ae2(0x1c2)];else{if(_0x66d544[0x0][_0x2f7ae2(0x1d2)]==_0x2f7ae2(0x1ab))var _0x378d59=users[_0x2f7ae2(0x1ab)];else{if(_0x66d544[0x0]['language']=='German')var _0x378d59=users[_0x2f7ae2(0x25a)];else{if(_0x66d544[0x0]['language']==_0x2f7ae2(0x1c7))var _0x378d59=users[_0x2f7ae2(0x1c7)];else{if(_0x66d544[0x0]['language']==_0x2f7ae2(0x273))var _0x378d59=users['French'];else{if(_0x66d544[0x0][_0x2f7ae2(0x1d2)]==_0x2f7ae2(0x235))var _0x378d59=users[_0x2f7ae2(0x22c)];else{if(_0x66d544[0x0][_0x2f7ae2(0x1d2)]=='Chinese')var _0x378d59=users[_0x2f7ae2(0x1f4)];else{if(_0x66d544[0x0]['language']=='Arabic\x20(ae)')var _0x378d59=users['Arabic'];}}}}}}}_0x269963[_0x2f7ae2(0x1ca)]('all_sales_barcode',{'success':_0x2cdb7c[_0x2f7ae2(0x215)](_0x2f7ae2(0x21e)),'errors':_0x2cdb7c[_0x2f7ae2(0x215)](_0x2f7ae2(0x1ac)),'role':_0x48a978,'profile':_0x461c18,'alldata':_0x1cc1c6,'master_shop':_0x66d544,'language':_0x378d59});}catch(_0x1c3082){console[_0x2f7ae2(0x1b3)](_0x1c3082);}}),router[a0_0x298c51(0x1dd)]('/barcode_scanner',async(_0x22e992,_0x58b1ed)=>{var _0x452b6a=a0_0x298c51;const {product_code:_0x48e7f5,warehouse_name:_0x712755,rooms_data:_0x1a5f95,Roomslist:_0x5e74fe}=_0x22e992[_0x452b6a(0x26e)],_0x187056=_0x5e74fe['split'](','),_0x20db9e=[];async function _0x4f5ebe(_0x35c26d){var _0x5ce955=_0x452b6a;const _0x12a9ba=await warehouse[_0x5ce955(0x2ae)]([{'$match':{'name':_0x712755,'room':_0x35c26d}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x48e7f5}},{'$group':{'_id':_0x5ce955(0x200),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x5ce955(0x175)},'primary_code':{'$first':_0x5ce955(0x263)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5ce955(0x286)},'level':{'$first':_0x5ce955(0x24b)},'isle':{'$first':_0x5ce955(0x190)},'type':{'$first':_0x5ce955(0x1de)},'pallet':{'$first':_0x5ce955(0x2b7)},'unit':{'$first':_0x5ce955(0x177)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5ce955(0x1a4)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x5ce955(0x1af)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x5ce955(0x1bf)},'batch_code':{'$first':_0x5ce955(0x1f3)},'product_cat':{'$first':_0x5ce955(0x207)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x5ce955(0x24a)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x4ab830=await warehouse[_0x5ce955(0x2ae)]([{'$match':{'name':_0x712755,'room':_0x35c26d}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x48e7f5}},{'$group':{'_id':_0x5ce955(0x200),'name':{'$first':_0x5ce955(0x1cc)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5ce955(0x1e0)},'product_code':{'$first':_0x5ce955(0x286)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x5ce955(0x190)},'type':{'$first':_0x5ce955(0x1de)},'pallet':{'$first':_0x5ce955(0x2b7)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x5ce955(0x29b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5ce955(0x29f)},'expiry_date':{'$first':_0x5ce955(0x1af)},'production_date':{'$first':_0x5ce955(0x16d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x5ce955(0x1f3)},'product_cat':{'$first':_0x5ce955(0x207)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x5ce955(0x24a)},'invoice':{'$first':_0x5ce955(0x19d)}}}]);if(_0x12a9ba['length']>0x0)_0x20db9e[_0x5ce955(0x1f1)](_0x12a9ba);else _0x4ab830['length']>0x0&&_0x20db9e['push'](_0x4ab830);}const _0x4f2aed=_0x187056[_0x452b6a(0x25c)](_0x4c8e23=>_0x4f5ebe(_0x4c8e23));await Promise[_0x452b6a(0x1ae)](_0x4f2aed),_0x58b1ed[_0x452b6a(0x224)](_0x20db9e);}),router[a0_0x298c51(0x1dd)](a0_0x298c51(0x28e),async(_0x335175,_0x239ee4)=>{var _0x3d97ba=a0_0x298c51;const {product_code:_0x34de36,warehouse_name:_0x5096bc,rooms_data:_0x141d31,Roomslist:_0x55c6cd}=_0x335175['body'];console[_0x3d97ba(0x1b3)](_0x335175[_0x3d97ba(0x26e)]);const _0x16b547=_0x55c6cd[_0x3d97ba(0x1bb)](','),_0x21a1e8=[];async function _0x2f2bd7(_0x24dad7){var _0x53b778=_0x3d97ba;const _0x2d5853=await warehouse[_0x53b778(0x2ae)]([{'$match':{'name':_0x5096bc,'room':_0x24dad7}},{'$unwind':_0x53b778(0x22b)},{'$match':{'product_details_spmx.product_code':_0x34de36}},{'$group':{'_id':_0x53b778(0x250),'spicemix_spmx':{'$first':_0x53b778(0x26f)},'extenders_spmx':{'$first':_0x53b778(0x260)},'curing_spmx':{'$first':_0x53b778(0x1e5)},'spicemix_spmx_qty':{'$first':'$product_details_spmx.spicemix_spmx_qty'},'extenders_spmx_qty':{'$first':_0x53b778(0x24e)},'curing_spmx_qty':{'$first':_0x53b778(0x20f)},'unit_spmx':{'$first':_0x53b778(0x197)},'brand_spmx':{'$first':_0x53b778(0x22a)},'category_spmx':{'$first':_0x53b778(0x245)},'roomNamed':{'$first':_0x53b778(0x24a)},'invoice':{'$first':_0x53b778(0x1a3)},'product_code_spmx':{'$first':_0x53b778(0x18c)}}}]);_0x21a1e8[_0x53b778(0x1f1)](_0x2d5853);}const _0x39d177=_0x16b547[_0x3d97ba(0x25c)](_0x513515=>_0x2f2bd7(_0x513515));await Promise[_0x3d97ba(0x1ae)](_0x39d177),_0x239ee4[_0x3d97ba(0x224)](_0x21a1e8);}),module[a0_0x298c51(0x21b)]=router;