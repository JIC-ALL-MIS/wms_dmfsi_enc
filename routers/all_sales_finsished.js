var a0_0x46c467=a0_0x4a9f;(function(_0x4376be,_0x5f44a2){var _0x56b43a=a0_0x4a9f,_0x1e307e=_0x4376be();while(!![]){try{var _0x24fced=-parseInt(_0x56b43a(0x273))/0x1*(-parseInt(_0x56b43a(0x2d7))/0x2)+parseInt(_0x56b43a(0x2fe))/0x3+parseInt(_0x56b43a(0x2a2))/0x4+-parseInt(_0x56b43a(0x249))/0x5*(parseInt(_0x56b43a(0x28e))/0x6)+-parseInt(_0x56b43a(0x2a9))/0x7+-parseInt(_0x56b43a(0x214))/0x8+parseInt(_0x56b43a(0x203))/0x9*(parseInt(_0x56b43a(0x23a))/0xa);if(_0x24fced===_0x5f44a2)break;else _0x1e307e['push'](_0x1e307e['shift']());}catch(_0x4eec75){_0x1e307e['push'](_0x1e307e['shift']());}}}(a0_0x4efb,0xcb22e));function a0_0x4efb(){var _0x43edbf=['</td>','sales\x20item\x20return\x20successfull','<h2>\x20','$return_data','room_name','customers_docs','Sale\x20Return\x20Mail','FGSEmail','all','</tbody>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','master','<tbody\x20style=\x22text-align:\x20center;\x22>','<strong>\x20Regards\x20</strong>','map','findOne','<div>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','Spanish','/preview/:id','prod_code','/view/add_sales','product_details','expiry_date','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','add\x20post','8343426aLDjly','DRY\x20GOODS','$product_details.production_date','/all_sales_finished/preview/','$product_details.product_stock','production_date','amount','Enclosed','product_data','return_sale_finished','maxperunit','secondary_code_QA','nodemailer','Hindi','sale_product','edit_sales_finished','</tr>','due_amount','message','French','3423892Rznoma','\x20==\x20','edit_sales_finished_view','Arabic\x20(ae)','\x20>>>\x20','date','\x20</h2>','7138369lyltLU','success','/all_sales_finished/view','$product_details.product_code','carton','payment\x20successfull','sales_quantity','primary_unit','suppliers','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','note','$sale_product.bay','length','$finalize','warehouse','Finished\x20Goods','stocks_QA','random','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$sale_product.quantity','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.secondary_unit','sale_qty','Sales\x20Update\x20successfully','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','flash','getMonth','$name','forEach','$product_details.type','secondary_unit_QA','</thead>','abs','Sales\x20Add\x20successfully','$product_details.product_name','product_date','render','product_code','foreach\x20newproduct','product_stock','maxPerUnit_QA','QA\x20Warehouse','<span\x20style=\x22float:\x20right;\x22>','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','3842cBOQLh','/view/add_sale/product','<h5>','log','sales_quantity_QA','Sales\x20Mail','product_list','product','level','Error\x20Occurs','<html><head><title></title>','OUTF-','\x20Order\x20Number\x20:\x20','maxPerUnit','barcode\x20user_id','maxProducts','Portuguese\x20(BR)','createTransport','return_sale_QA','stock','customer','English\x20(US)','currency_placement','$product','</span>','/invoice/:id','aggregate','/upload/','room','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','German','$product_details.storage','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','errors','findById','string','email','expiry_date_QA','1897179EdWsje','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','image','password','$product_details.expiry_date','error','max_per_unit','$customer','warehouse_name','customers','Quality\x20Inspection','express','site_title','<tr>','unit_QA','back','filter','received_amount','gmail','product_code_QA','RoomAssigned','../models/all_models','Enabled','body','bay','Return\x20Goods','exports','</h5>','logo','json','batch_code','return_qty','9DKCrEE','concat','port','\x20Order\x20Date\x20:\x20','Chinese','sales_invoice','$product_details.bay','padStart','$_id','<hr\x20class=\x22my-3\x22>','return_qty_QA','$invoice','\x20&&\x20','adjust_qty','Router','$product_details._id','\x20<<<==>>>\x20','8727704mFTZDm','name','<!DOCTYPE\x20html>','then','</body></html>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','secondary_code','role','$sale_product.type','batch_code_QA','../middleware/auth','$product_details.batch_code','</div>','barcode\x20Product\x20master','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','product_name_QA1','$customers_docs','find','currency','prod_invoice','push','Portuguese','Logo.png','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','An\x20error\x20occurred\x20while\x20saving\x20data.','status','quantity','sendMail','</table>','maxProducts_QA','add_sales_finished','slice','getDate','/view/return_sales/:id','secondary_unit','for_categorize','max','28238500RTUpsd','product_name','$product_details.floorlevel','primary_code_QA','$warehouse_name','<h5\x20style=\x22text-align:\x20left;\x22>','$sale_product','Sale','user','production_date_QA','Arabic','purchases_data','customer_data','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$product_details.rack','5KpQCxi','$product_details.unit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','split','return_data','/view/add_sales/:id','save','/../public','$product_details.bin','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$product_details.maxPerUnit','$sale_product.floorlevel','redirect','primary_code','Email\x20sent\x20successfully','floor','$product_details.maxProducts','Sale\x20Return','English','$product_details.secondary_code','get','$room','/all_sales/view','post','params','catch','$date','unit','Ambient','$product_details.product_cat','getFullYear','invoice','$note','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','staff','finalize','../public/language/languages.json','/view','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','11ZOrBWO'];a0_0x4efb=function(){return _0x43edbf;};return a0_0x4efb();}const express=require(a0_0x46c467(0x30a)),app=express(),router=express[a0_0x46c467(0x211)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x46c467(0x1f8)),auth=require(a0_0x46c467(0x21e)),nodemailer=require(a0_0x46c467(0x29a)),users=require(a0_0x46c467(0x270));router['get'](a0_0x46c467(0x271),auth,async(_0x57caf6,_0x24a3d6)=>{var _0x19b95b=a0_0x46c467;try{const {username:_0x4067cb,email:_0x1e47e5,role:_0x164afa}=_0x57caf6[_0x19b95b(0x242)],_0x3a3d54=_0x57caf6[_0x19b95b(0x242)],_0x57505f=await profile[_0x19b95b(0x283)]({'email':_0x3a3d54[_0x19b95b(0x2fc)]}),_0x387f71=await master_shop[_0x19b95b(0x226)]();let _0x5cb889;if(_0x3a3d54['role']==_0x19b95b(0x26e)){const _0x45e8b3=await staff[_0x19b95b(0x283)]({'email':_0x3a3d54[_0x19b95b(0x2fc)]});_0x5cb889=await sales_finished[_0x19b95b(0x2f1)]([{'$lookup':{'from':_0x19b95b(0x308),'localField':_0x19b95b(0x2eb),'foreignField':_0x19b95b(0x215),'as':'customers_docs'}},{'$unwind':_0x19b95b(0x225)},{'$unwind':_0x19b95b(0x240)},{'$group':{'_id':_0x19b95b(0x20b),'invoice':{'$first':_0x19b95b(0x20e)},'customers':{'$first':_0x19b95b(0x306)},'date':{'$first':_0x19b95b(0x265)},'warehouse_name':{'$first':_0x19b95b(0x23e)},'sale_product':{'$push':_0x19b95b(0x240)},'note':{'$first':_0x19b95b(0x26b)},'return_data':{'$first':_0x19b95b(0x277)},'customers_docs':{'$first':_0x19b95b(0x225)},'total_saleproduct_quantity':{'$sum':_0x19b95b(0x2bc)},'level':{'$addToSet':_0x19b95b(0x2b4)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x19b95b(0x2b6)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5cb889=await sales_finished[_0x19b95b(0x2f1)]([{'$lookup':{'from':_0x19b95b(0x308),'localField':_0x19b95b(0x2eb),'foreignField':_0x19b95b(0x215),'as':_0x19b95b(0x279)}},{'$unwind':'$customers_docs'},{'$unwind':_0x19b95b(0x240)},{'$group':{'_id':_0x19b95b(0x20b),'invoice':{'$first':_0x19b95b(0x20e)},'customers':{'$first':_0x19b95b(0x306)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x19b95b(0x240)},'note':{'$first':_0x19b95b(0x26b)},'return_data':{'$first':_0x19b95b(0x277)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x19b95b(0x2bc)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x19b95b(0x21c)},'pallet':{'$addToSet':_0x19b95b(0x256)},'finalize':{'$first':_0x19b95b(0x2b6)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x387f71[0x0][_0x19b95b(0x2ff)]==_0x19b95b(0x2ec)){var _0x4c07bf=users[_0x19b95b(0x25d)];console[_0x19b95b(0x2da)](_0x4c07bf);}else{if(_0x387f71[0x0][_0x19b95b(0x2ff)]==_0x19b95b(0x29b))var _0x4c07bf=users[_0x19b95b(0x29b)];else{if(_0x387f71[0x0][_0x19b95b(0x2ff)]=='German')var _0x4c07bf=users[_0x19b95b(0x2f5)];else{if(_0x387f71[0x0][_0x19b95b(0x2ff)]==_0x19b95b(0x286))var _0x4c07bf=users['Spanish'];else{if(_0x387f71[0x0][_0x19b95b(0x2ff)]==_0x19b95b(0x2a1))var _0x4c07bf=users['French'];else{if(_0x387f71[0x0][_0x19b95b(0x2ff)]=='Portuguese\x20(BR)')var _0x4c07bf=users['Portuguese'];else{if(_0x387f71[0x0][_0x19b95b(0x2ff)]==_0x19b95b(0x207))var _0x4c07bf=users[_0x19b95b(0x207)];else{if(_0x387f71[0x0][_0x19b95b(0x2ff)]==_0x19b95b(0x2a5))var _0x4c07bf=users['Arabic'];}}}}}}}_0x24a3d6[_0x19b95b(0x2ce)]('all_sales_finished',{'success':_0x57caf6['flash'](_0x19b95b(0x2aa)),'errors':_0x57caf6[_0x19b95b(0x2c3)](_0x19b95b(0x2f9)),'sales':_0x5cb889,'profile':_0x57505f,'role':_0x3a3d54,'master_shop':_0x387f71,'language':_0x4c07bf});}catch(_0x3c29d0){console[_0x19b95b(0x2da)](_0x3c29d0);}});function a0_0x4a9f(_0x483d98,_0xb19f13){var _0x4efb2e=a0_0x4efb();return a0_0x4a9f=function(_0x4a9f27,_0x5f1202){_0x4a9f27=_0x4a9f27-0x1f2;var _0x40f5e8=_0x4efb2e[_0x4a9f27];return _0x40f5e8;},a0_0x4a9f(_0x483d98,_0xb19f13);}async function getRandom8DigitNumber(){var _0x488253=a0_0x46c467;const _0x1cae0f=0x989680,_0x24eb7b=0x5f5e0ff,_0x11b214=Math[_0x488253(0x25a)](Math[_0x488253(0x2ba)]()*(_0x24eb7b-_0x1cae0f+0x1))+_0x1cae0f;var _0x4cd2e7;const _0x17fb02=await sales_finished[_0x488253(0x283)]({'invoice':_0x488253(0x2e2)+_0x11b214});return _0x17fb02&&_0x17fb02['length']>0x0?_0x4cd2e7=_0x488253(0x2e2)+_0x11b214:_0x4cd2e7='OUTF-'+_0x11b214,_0x4cd2e7;}router[a0_0x46c467(0x25f)]('/view/add_sales',auth,async(_0x42c254,_0x39844c)=>{var _0xd60b1f=a0_0x46c467;try{const {username:_0x52bf3a,email:_0x5b0606,role:_0x4a580f}=_0x42c254[_0xd60b1f(0x242)],_0x2ba9b1=_0x42c254[_0xd60b1f(0x242)],_0x773c9d=await profile[_0xd60b1f(0x283)]({'email':_0x2ba9b1[_0xd60b1f(0x2fc)]}),_0x530add=await master_shop[_0xd60b1f(0x226)](),_0x1f9e32=await customer['find']({});let _0x5a25c4;if(_0x2ba9b1[_0xd60b1f(0x21b)]==_0xd60b1f(0x26e)){const _0x5bc92f=await staff[_0xd60b1f(0x283)]({'email':_0x2ba9b1[_0xd60b1f(0x2fc)]});_0x5a25c4=await warehouse[_0xd60b1f(0x2f1)]([{'$match':{'status':'Enabled','name':_0x5bc92f['warehouse'],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0xd60b1f(0x2d3)}}},{'$group':{'_id':_0xd60b1f(0x2c5),'name':{'$first':_0xd60b1f(0x2c5)}}},{'$sort':{'name':0x1}}]);}else _0x5a25c4=await warehouse['aggregate']([{'$match':{'status':_0xd60b1f(0x1f9),'warehouse_category':_0xd60b1f(0x2b8),'name':{'$ne':_0xd60b1f(0x2d3)}}},{'$group':{'_id':_0xd60b1f(0x2c5),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x18cc8a=await product[_0xd60b1f(0x226)]({});var _0x5b0281=[_0xd60b1f(0x267),_0xd60b1f(0x295)];const _0x1f49c8=await sales_finished['find']({}),_0xa994df=_0x1f49c8[_0xd60b1f(0x2b5)]+0x1,_0x12c701=_0xd60b1f(0x2e2)+_0xa994df['toString']()[_0xd60b1f(0x20a)](0x5,'0');if(_0x530add[0x0][_0xd60b1f(0x2ff)]==_0xd60b1f(0x2ec)){var _0x5411bc=users['English'];console[_0xd60b1f(0x2da)](_0x5411bc);}else{if(_0x530add[0x0][_0xd60b1f(0x2ff)]=='Hindi')var _0x5411bc=users[_0xd60b1f(0x29b)];else{if(_0x530add[0x0][_0xd60b1f(0x2ff)]==_0xd60b1f(0x2f5))var _0x5411bc=users['German'];else{if(_0x530add[0x0][_0xd60b1f(0x2ff)]==_0xd60b1f(0x286))var _0x5411bc=users[_0xd60b1f(0x286)];else{if(_0x530add[0x0][_0xd60b1f(0x2ff)]==_0xd60b1f(0x2a1))var _0x5411bc=users[_0xd60b1f(0x2a1)];else{if(_0x530add[0x0][_0xd60b1f(0x2ff)]=='Portuguese\x20(BR)')var _0x5411bc=users['Portuguese'];else{if(_0x530add[0x0][_0xd60b1f(0x2ff)]==_0xd60b1f(0x207))var _0x5411bc=users[_0xd60b1f(0x207)];else{if(_0x530add[0x0][_0xd60b1f(0x2ff)]==_0xd60b1f(0x2a5))var _0x5411bc=users[_0xd60b1f(0x244)];}}}}}}}const _0x4f7a34=getRandom8DigitNumber();_0x4f7a34[_0xd60b1f(0x217)](_0x325d71=>{var _0x4674fa=_0xd60b1f;_0x39844c[_0x4674fa(0x2ce)](_0x4674fa(0x233),{'success':_0x42c254[_0x4674fa(0x2c3)](_0x4674fa(0x2aa)),'errors':_0x42c254[_0x4674fa(0x2c3)]('errors'),'role':_0x2ba9b1,'profile':_0x773c9d,'customer':_0x1f9e32,'warehouse':_0x5a25c4,'product':_0x18cc8a,'invoice':_0x325d71,'master_shop':_0x530add,'language':_0x5411bc,'rooms_data':_0x5b0281});})[_0xd60b1f(0x264)](_0x3d1d75=>{var _0x5923ea=_0xd60b1f;_0x42c254['flash'](_0x5923ea(0x2f9),_0x5923ea(0x24b)),_0x39844c[_0x5923ea(0x257)](_0x5923ea(0x2ab));});}catch(_0x43e461){console[_0xd60b1f(0x2da)](_0x43e461);}}),router['get'](a0_0x46c467(0x250),auth,async(_0x1d6688,_0x2fb219)=>{var _0x3a0a09=a0_0x46c467;try{const _0x5e1fe2=_0x1d6688[_0x3a0a09(0x263)]['id'];console['log'](_0x5e1fe2);const _0xfbf55e=await product['find'](),_0x50aafb=await purchases[_0x3a0a09(0x2f1)]([{'$match':{'warehouse_name':_0x5e1fe2}},{'$unwind':_0x3a0a09(0x2ee)},{'$group':{'_id':'$product.product_name'}}]);console[_0x3a0a09(0x2da)](_0x3a0a09(0x245),_0x50aafb),_0x2fb219['status'](0xc8)['json']({'purchases_data':_0x50aafb,'product_data':_0xfbf55e});}catch(_0x3ba51d){console['log'](_0x3ba51d);}}),router[a0_0x46c467(0x262)](a0_0x46c467(0x2d8),auth,async(_0x1518af,_0x828e07)=>{var _0x12ede5=a0_0x46c467;try{const {warehouse_data:_0x356d0f,product_data:_0x1b49b0}=_0x1518af[_0x12ede5(0x1fa)];console['log'](_0x1518af[_0x12ede5(0x1fa)][_0x12ede5(0x296)]);;const _0x2a5025=await master_shop['find']();console[_0x12ede5(0x2da)]('master',_0x2a5025);const _0x6b68e3=await product[_0x12ede5(0x283)]({'name':_0x1b49b0});console[_0x12ede5(0x2da)](_0x12ede5(0x2de),_0x6b68e3);const _0x55fcfe=await warehouse[_0x12ede5(0x2f1)]([{'$match':{'name':_0x356d0f}},{'$unwind':_0x12ede5(0x26c)},{'$match':{'product_details.product_name':_0x1b49b0}},{'$group':{'_id':_0x12ede5(0x2cc),'product_stock':{'$first':_0x12ede5(0x292)}}}]);console[_0x12ede5(0x2da)]('stock_data',_0x55fcfe),_0x828e07[_0x12ede5(0x22e)](0xc8)[_0x12ede5(0x200)]({'master':_0x2a5025,'new_product':_0x6b68e3,'stock_data':_0x55fcfe});}catch(_0x627f59){console[_0x12ede5(0x2da)](_0x627f59);}}),router[a0_0x46c467(0x262)](a0_0x46c467(0x289),auth,async(_0x4b3d2b,_0x3a3fa5)=>{var _0x2c4c18=a0_0x46c467;try{const {invoice:_0x58b092,date:_0x1adb1d,warehouse_name:_0x3bba31,product_name:_0x7e1a9a,stock:_0x530c3a,quantity:_0x4dcec6,note:_0x45461e,room:_0x591ab9,primary_code:_0x4e1a04,secondary_code:_0x3f88c2,prod_code:_0x4c0fc0,level:_0x174ce2,isle:_0x1cea43,pallet:_0x1e38e5,batch_code:_0xdecf4,SCRN:_0x456cd1,expiry_date:_0x48d485,mode_transpo:_0x38ce95,name_driver:_0x3749d5}=_0x4b3d2b[_0x2c4c18(0x1fa)];if(typeof _0x7e1a9a==_0x2c4c18(0x2fb))var _0x4f1261=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x23b)]],_0x1fdc7c=[_0x4b3d2b['body'][_0x2c4c18(0x2ea)]],_0x52aabf=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2ad)]],_0x2402f8=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x258)]],_0x4ebbef=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x21a)]],_0x54dd04=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x288)]],_0x37368b=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2df)]],_0x616f27=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2b0)]],_0x59f687=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x237)]],_0x1d7944=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x201)]],_0x53ca1a=[_0x4b3d2b['body'][_0x2c4c18(0x28b)]],_0x2a7380=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2cd)]],_0x2facf2=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x305)]],_0x361b31=[_0x4b3d2b[_0x2c4c18(0x1fa)]['prod_cat']],_0x413668=[_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x1f7)]],_0x2c2d89=[_0x4b3d2b['body']['prod_invoice']];else var _0x4f1261=[..._0x4b3d2b['body'][_0x2c4c18(0x23b)]],_0x1fdc7c=[..._0x4b3d2b['body']['stock']],_0x52aabf=[..._0x4b3d2b[_0x2c4c18(0x1fa)]['carton']],_0x2402f8=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x258)]],_0x4ebbef=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x21a)]],_0x54dd04=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x288)]],_0x37368b=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2df)]],_0x616f27=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2b0)]],_0x59f687=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x237)]],_0x1d7944=[..._0x4b3d2b['body'][_0x2c4c18(0x201)]],_0x53ca1a=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x28b)]],_0x2a7380=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2cd)]],_0x2facf2=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x305)]],_0x361b31=[..._0x4b3d2b['body'][_0x2c4c18(0x222)]],_0x413668=[..._0x4b3d2b['body']['RoomAssigned']],_0x2c2d89=[..._0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x228)]];const _0x5b2db2=_0x4f1261[_0x2c4c18(0x282)](_0x58e435=>{return _0x58e435={'product_name':_0x58e435};});_0x1fdc7c['forEach']((_0x2910a3,_0x206423)=>{var _0x5da58e=_0x2c4c18;_0x5b2db2[_0x206423][_0x5da58e(0x2ea)]=_0x2910a3;}),_0x52aabf[_0x2c4c18(0x2c6)]((_0x27c9c3,_0x4d8a96)=>{var _0x11b8b6=_0x2c4c18;_0x5b2db2[_0x4d8a96][_0x11b8b6(0x22f)]=Math[_0x11b8b6(0x2ca)](_0x27c9c3);}),_0x2402f8[_0x2c4c18(0x2c6)]((_0x3ef097,_0x1df71d)=>{var _0x4a7df7=_0x2c4c18;_0x5b2db2[_0x1df71d][_0x4a7df7(0x258)]=_0x3ef097;}),_0x4ebbef[_0x2c4c18(0x2c6)]((_0x239519,_0x1fe7dc)=>{_0x5b2db2[_0x1fe7dc]['secondary_code']=_0x239519;}),_0x54dd04[_0x2c4c18(0x2c6)]((_0x4fbe95,_0x57538a)=>{var _0x425f14=_0x2c4c18;_0x5b2db2[_0x57538a][_0x425f14(0x2cf)]=_0x4fbe95;}),_0x37368b['forEach']((_0x3203c3,_0x3ec06e)=>{var _0x34180d=_0x2c4c18;_0x5b2db2[_0x3ec06e][_0x34180d(0x1fb)]=_0x3203c3;}),_0x616f27[_0x2c4c18(0x2c6)]((_0x554224,_0x2c2301)=>{var _0x437c9b=_0x2c4c18;_0x5b2db2[_0x2c2301][_0x437c9b(0x266)]=_0x554224;}),_0x59f687[_0x2c4c18(0x2c6)]((_0x3dcba7,_0x5bc8a5)=>{var _0x1ddfc8=_0x2c4c18;_0x5b2db2[_0x5bc8a5][_0x1ddfc8(0x237)]=_0x3dcba7;}),_0x1d7944[_0x2c4c18(0x2c6)]((_0x511841,_0x41151b)=>{_0x5b2db2[_0x41151b]['batch_code']=_0x511841;}),_0x53ca1a['forEach']((_0xc98071,_0x4cb1e9)=>{var _0x36ec94=_0x2c4c18;_0x5b2db2[_0x4cb1e9][_0x36ec94(0x28b)]=_0xc98071;}),_0x2a7380[_0x2c4c18(0x2c6)]((_0xa2e8d2,_0x5a256c)=>{var _0x35bc33=_0x2c4c18;_0x5b2db2[_0x5a256c][_0x35bc33(0x293)]=_0xa2e8d2;}),_0x2facf2['forEach']((_0x2b8fce,_0x2a7958)=>{var _0x4721e9=_0x2c4c18;_0x5b2db2[_0x2a7958][_0x4721e9(0x298)]=_0x2b8fce;}),_0x361b31[_0x2c4c18(0x2c6)]((_0x546445,_0x7e7cac)=>{var _0x1888ca=_0x2c4c18;_0x5b2db2[_0x7e7cac][_0x1888ca(0x222)]=_0x546445;}),_0x413668['forEach']((_0x14b9dd,_0x402d66)=>{_0x5b2db2[_0x402d66]['room_name']=_0x14b9dd;}),_0x2c2d89[_0x2c4c18(0x2c6)]((_0x222018,_0xd97737)=>{var _0x183cb8=_0x2c4c18;_0x5b2db2[_0xd97737][_0x183cb8(0x26a)]=_0x222018;});var _0x15afa5=0x0;_0x5b2db2[_0x2c4c18(0x2c6)](_0x17df22=>{var _0x3d5e45=_0x2c4c18;parseFloat(_0x17df22[_0x3d5e45(0x2ea)])<parseFloat(_0x17df22[_0x3d5e45(0x22f)])&&parseFloat(_0x17df22[_0x3d5e45(0x22f)])>parseFloat(_0x17df22['stock'])&&(console[_0x3d5e45(0x2da)](_0x17df22['stock']+'\x20<>\x20'+_0x17df22[_0x3d5e45(0x22f)]),_0x15afa5++);});if(_0x15afa5!=0x0)return _0x4b3d2b[_0x2c4c18(0x2c3)]('errors',_0x2c4c18(0x2f4)),_0x3a3fa5[_0x2c4c18(0x257)](_0x2c4c18(0x1f2));const _0x1cc229=_0x5b2db2[_0x2c4c18(0x1f3)](_0x375db6=>_0x375db6['quantity']!=='0'&&_0x375db6['quantity']!==''),_0x219660=new sales_finished({'invoice':_0x58b092,'customer':_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2eb)],'date':_0x1adb1d,'warehouse_name':_0x3bba31,'sale_product':_0x1cc229,'note':_0x45461e,'room':_0x591ab9,'primary_code':_0x4e1a04,'secondary_code':_0x3f88c2,'prod_code':_0x4c0fc0,'SCRN':_0x456cd1,'finalize':'False','mode_transpo':_0x38ce95,'name_driver':_0x3749d5}),_0x584f70=await _0x219660['save'](),_0x1af0fd=await sales_finished['findOne']({'invoice':_0x58b092}),_0x3ab743=new c_payment_data({'invoice':_0x58b092,'customer':_0x4b3d2b[_0x2c4c18(0x1fa)][_0x2c4c18(0x2eb)],'reason':_0x2c4c18(0x241)});await _0x3ab743['save']();const _0xf36ab6=await master_shop['find'](),_0x4efee5=await email_settings['findOne'](),_0x1c804a=await customer[_0x2c4c18(0x283)]({'name':_0x4b3d2b['body'][_0x2c4c18(0x2eb)]});_0xf36ab6[0x0][_0x2c4c18(0x2ed)]==0x1?(right_currency=_0xf36ab6[0x0][_0x2c4c18(0x227)],left_currency=''):(right_currency='',left_currency=_0xf36ab6[0x0][_0x2c4c18(0x227)]);var _0x15c528=_0x4f1261,_0x2d1118=_0x52aabf,_0x232566='',_0x13295f;for(_0x13295f in _0x15c528){_0x232566+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15c528[_0x13295f]+'</td>'+_0x2c4c18(0x28c)+_0x2d1118[_0x13295f]+_0x2c4c18(0x274)+_0x2c4c18(0x29e);}console[_0x2c4c18(0x2da)](_0x2c4c18(0x2dd),_0x232566);let _0x53d9d4=nodemailer[_0x2c4c18(0x2e8)]({'service':_0x2c4c18(0x1f5),'auth':{'user':_0x4efee5[_0x2c4c18(0x2fc)],'pass':_0x4efee5[_0x2c4c18(0x302)]}}),_0x3726ff={'from':_0x4efee5[_0x2c4c18(0x2fc)],'to':_0x1c804a['email'],'subject':'Sale\x20Product\x20Mail','attachments':[{'filename':_0x2c4c18(0x22b),'path':__dirname+'/../public'+_0x2c4c18(0x2f2)+_0xf36ab6[0x0]['image'],'cid':_0x2c4c18(0x1ff)}],'html':_0x2c4c18(0x216)+_0x2c4c18(0x2e1)+_0x2c4c18(0x2d5)+_0x2c4c18(0x284)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x2c4c18(0x272)+'</div>'+_0x2c4c18(0x284)+_0x2c4c18(0x276)+_0xf36ab6[0x0][_0x2c4c18(0x30b)]+_0x2c4c18(0x2a8)+_0x2c4c18(0x220)+_0x2c4c18(0x220)+_0x2c4c18(0x20c)+_0x2c4c18(0x284)+_0x2c4c18(0x23f)+'\x20Order\x20Number\x20:\x20'+_0x58b092+'\x20'+_0x2c4c18(0x2d4)+_0x2c4c18(0x206)+_0x1adb1d+'\x20'+_0x2c4c18(0x2ef)+_0x2c4c18(0x1fe)+'</div>'+_0x2c4c18(0x219)+_0x2c4c18(0x27e)+_0x2c4c18(0x30c)+_0x2c4c18(0x2f8)+_0x2c4c18(0x2c2)+_0x2c4c18(0x29e)+_0x2c4c18(0x2c9)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x232566+'\x20'+_0x2c4c18(0x27d)+_0x2c4c18(0x231)+_0x2c4c18(0x284)+'<strong>\x20Regards\x20</strong>'+_0x2c4c18(0x2d9)+_0xf36ab6[0x0][_0x2c4c18(0x30b)]+_0x2c4c18(0x1fe)+_0x2c4c18(0x220)+_0x2c4c18(0x220)+'</body></html>'};_0x53d9d4[_0x2c4c18(0x230)](_0x3726ff,function(_0x50ddbc,_0x5a9d41){var _0x1e3374=_0x2c4c18;_0x50ddbc?(console[_0x1e3374(0x2da)](_0x50ddbc),console['log']('Error\x20Occurs')):console[_0x1e3374(0x2da)](_0x1e3374(0x259));}),_0x4b3d2b['flash']('success',_0x2c4c18(0x2cb)),_0x3a3fa5[_0x2c4c18(0x257)](_0x2c4c18(0x291)+_0x584f70['_id']);}catch(_0x3d14aa){console[_0x2c4c18(0x2da)](_0x3d14aa);}}),router[a0_0x46c467(0x25f)](a0_0x46c467(0x287),auth,async(_0x36247f,_0x4511d1)=>{var _0xa93f5c=a0_0x46c467;try{const {username:_0x20747e,email:_0x18672f,role:_0x37ef79}=_0x36247f[_0xa93f5c(0x242)],_0xbc4d01=_0x36247f[_0xa93f5c(0x242)],_0x5a0d08=await profile[_0xa93f5c(0x283)]({'email':_0xbc4d01[_0xa93f5c(0x2fc)]}),_0x52d7da=await master_shop[_0xa93f5c(0x226)](),_0x512183=_0x36247f[_0xa93f5c(0x263)]['id'],_0x5a54a1=await sales_finished[_0xa93f5c(0x2fa)](_0x512183),_0x252de3=await warehouse[_0xa93f5c(0x2f1)]([{'$match':{'name':_0x5a54a1[_0xa93f5c(0x307)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0xa93f5c(0x212),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xa93f5c(0x292)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0xa93f5c(0x253)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xa93f5c(0x23c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xa93f5c(0x25e)},'product_code':{'$first':_0xa93f5c(0x2ac)},'storage':{'$first':_0xa93f5c(0x2f6)},'rack':{'$first':_0xa93f5c(0x248)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xa93f5c(0x290)},'batch_code':{'$first':_0xa93f5c(0x21f)},'room':{'$first':_0xa93f5c(0x260)},'room_data':{'$first':'$product_details.room_name'}}}]),_0xcc06c6=await customer[_0xa93f5c(0x226)]({});let _0xabcb77;if(_0xbc4d01['role']==_0xa93f5c(0x26e)){const _0x1f71f7=await staff[_0xa93f5c(0x283)]({'email':_0xbc4d01['email']});_0xabcb77=await warehouse[_0xa93f5c(0x2f1)]([{'$match':{'status':_0xa93f5c(0x1f9),'name':_0x1f71f7['warehouse']}},{'$group':{'_id':_0xa93f5c(0x2c5),'name':{'$first':_0xa93f5c(0x2c5)}}}]);}else _0xabcb77=await warehouse[_0xa93f5c(0x2f1)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0xa93f5c(0x2c5),'name':{'$first':_0xa93f5c(0x2c5)}}}]);const _0x1b48c7=await product['find']({});if(_0x52d7da[0x0][_0xa93f5c(0x2ff)]==_0xa93f5c(0x2ec)){var _0x47b588=users[_0xa93f5c(0x25d)];console['log'](_0x47b588);}else{if(_0x52d7da[0x0]['language']==_0xa93f5c(0x29b))var _0x47b588=users[_0xa93f5c(0x29b)];else{if(_0x52d7da[0x0][_0xa93f5c(0x2ff)]=='German')var _0x47b588=users['German'];else{if(_0x52d7da[0x0][_0xa93f5c(0x2ff)]==_0xa93f5c(0x286))var _0x47b588=users[_0xa93f5c(0x286)];else{if(_0x52d7da[0x0]['language']==_0xa93f5c(0x2a1))var _0x47b588=users[_0xa93f5c(0x2a1)];else{if(_0x52d7da[0x0][_0xa93f5c(0x2ff)]==_0xa93f5c(0x2e7))var _0x47b588=users[_0xa93f5c(0x22a)];else{if(_0x52d7da[0x0][_0xa93f5c(0x2ff)]==_0xa93f5c(0x207))var _0x47b588=users[_0xa93f5c(0x207)];else{if(_0x52d7da[0x0][_0xa93f5c(0x2ff)]==_0xa93f5c(0x2a5))var _0x47b588=users[_0xa93f5c(0x244)];}}}}}}}_0x4511d1[_0xa93f5c(0x2ce)](_0xa93f5c(0x2a4),{'success':_0x36247f['flash'](_0xa93f5c(0x2aa)),'errors':_0x36247f[_0xa93f5c(0x2c3)](_0xa93f5c(0x2f9)),'role':_0xbc4d01,'profile':_0x5a0d08,'customer':_0xcc06c6,'warehouse':_0xabcb77,'product':_0x252de3,'user':_0x5a54a1,'master_shop':_0x52d7da,'unit':_0x1b48c7,'language':_0x47b588});}catch(_0x391a10){console['log'](_0x391a10);}}),router[a0_0x46c467(0x262)](a0_0x46c467(0x287),auth,async(_0x17419a,_0x38b467)=>{var _0x52c4ad=a0_0x46c467;try{const _0x2cd225=_0x17419a[_0x52c4ad(0x263)]['id'],{invoice:_0x3a15d6,warehouse_name:_0x99ef9e,room:_0x40d54f}=_0x17419a['body'],_0x420660=await sales_finished[_0x52c4ad(0x283)]({'invoice':_0x3a15d6}),_0x453931=_0x420660['sale_product'][_0x52c4ad(0x282)](async _0x22b975=>{var _0x23a5e4=_0x52c4ad,_0x425c04=await warehouse[_0x23a5e4(0x283)]({'name':_0x99ef9e,'room':_0x22b975[_0x23a5e4(0x278)],'warehouse_category':_0x23a5e4(0x2b8)});const _0x2fe369=_0x425c04[_0x23a5e4(0x28a)][_0x23a5e4(0x282)](_0x1d1b6c=>{var _0x1b9cf8=_0x23a5e4;_0x1d1b6c['product_name']==_0x22b975[_0x1b9cf8(0x23b)]&&_0x1d1b6c[_0x1b9cf8(0x1fb)]==_0x22b975[_0x1b9cf8(0x1fb)]&&_0x1d1b6c[_0x1b9cf8(0x28b)]==_0x22b975[_0x1b9cf8(0x28b)]&&_0x1d1b6c[_0x1b9cf8(0x293)]==_0x22b975[_0x1b9cf8(0x293)]&&_0x1d1b6c[_0x1b9cf8(0x201)]==_0x22b975[_0x1b9cf8(0x201)]&&_0x1d1b6c[_0x1b9cf8(0x26a)]==_0x22b975[_0x1b9cf8(0x26a)]&&(_0x1d1b6c[_0x1b9cf8(0x2d1)]>0x0&&(console[_0x1b9cf8(0x2da)](_0x1d1b6c[_0x1b9cf8(0x23b)]+'\x20==\x20'+_0x22b975[_0x1b9cf8(0x23b)]+_0x1b9cf8(0x20f)+_0x1d1b6c[_0x1b9cf8(0x1fb)]+'\x20==\x20'+_0x22b975[_0x1b9cf8(0x1fb)]+'\x20&&\x20'+_0x1d1b6c[_0x1b9cf8(0x293)]+_0x1b9cf8(0x2a3)+_0x22b975[_0x1b9cf8(0x293)]+_0x1b9cf8(0x20f)+_0x1d1b6c['expiry_date']+_0x1b9cf8(0x2a3)+_0x22b975[_0x1b9cf8(0x28b)]+'\x20&&\x20'+_0x1d1b6c[_0x1b9cf8(0x201)]+_0x1b9cf8(0x2a3)+_0x22b975[_0x1b9cf8(0x201)]+_0x1b9cf8(0x20f)+_0x1d1b6c[_0x1b9cf8(0x26a)]+_0x1b9cf8(0x2a3)+_0x22b975[_0x1b9cf8(0x26a)]+_0x1b9cf8(0x20f)+_0x1d1b6c[_0x1b9cf8(0x2d1)]+_0x1b9cf8(0x213)+_0x22b975[_0x1b9cf8(0x22f)]+_0x1b9cf8(0x2a6)+_0x22b975[_0x1b9cf8(0x278)]),_0x1d1b6c[_0x1b9cf8(0x2d1)]=Math[_0x1b9cf8(0x239)](0x0,Math[_0x1b9cf8(0x2ca)](_0x1d1b6c[_0x1b9cf8(0x2d1)])-Math['abs'](_0x22b975[_0x1b9cf8(0x22f)]))));});return _0x425c04;});Promise[_0x52c4ad(0x27c)](_0x453931)['then'](async _0x2561f8=>{var _0x362957=_0x52c4ad;try{for(const _0x248d40 of _0x2561f8){await _0x248d40[_0x362957(0x251)]();}_0x420660[_0x362957(0x26f)]=_0x362957(0x2c1);const _0x2e8691=await _0x420660[_0x362957(0x251)](),_0x36b3ec=await master_shop[_0x362957(0x226)](),_0x3bc8aa=await email_settings[_0x362957(0x283)](),_0x11a494=await supervisor_settings[_0x362957(0x226)]();var _0x9caad8=_0x420660[_0x362957(0x29c)],_0x85533a='',_0x51844a;for(_0x51844a in _0x9caad8){var _0x5077db='FG';_0x420660[_0x362957(0x307)]==_0x362957(0x28f)&&(_0x5077db='DG'),_0x85533a+=_0x362957(0x30c)+_0x362957(0x28c)+_0x9caad8[_0x51844a][_0x362957(0x23b)]+'</td>'+_0x362957(0x28c)+_0x9caad8[_0x51844a][_0x362957(0x2cf)]+_0x362957(0x274)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9caad8[_0x51844a]['quantity']+'</td>'+_0x362957(0x28c)+_0x9caad8[_0x51844a]['unit']+_0x362957(0x274)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x9caad8[_0x51844a]['secondary_unit']+_0x362957(0x274)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x420660[_0x362957(0x307)]+_0x362957(0x274)+_0x362957(0x28c)+_0x9caad8[_0x51844a][_0x362957(0x278)]+_0x362957(0x274)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5077db+_0x9caad8[_0x51844a][_0x362957(0x1fb)]+'</td>';}let _0x4a3587=nodemailer[_0x362957(0x2e8)]({'host':_0x3bc8aa['host'],'port':Number(_0x3bc8aa[_0x362957(0x205)]),'secure':![],'auth':{'user':_0x3bc8aa[_0x362957(0x2fc)],'pass':_0x3bc8aa['password']}}),_0x2784e7={'from':_0x3bc8aa[_0x362957(0x2fc)],'to':_0x11a494[0x0][_0x362957(0x27b)],'subject':_0x362957(0x2dc),'attachments':[{'filename':_0x362957(0x22b),'path':__dirname+_0x362957(0x252)+_0x362957(0x2f2)+_0x36b3ec[0x0][_0x362957(0x301)],'cid':'logo'}],'html':_0x362957(0x216)+'<html><head><title></title>'+_0x362957(0x2d5)+'<div>'+_0x362957(0x2bd)+_0x362957(0x284)+_0x362957(0x272)+_0x362957(0x220)+_0x362957(0x284)+'<h2>\x20'+_0x36b3ec[0x0][_0x362957(0x30b)]+_0x362957(0x2a8)+'</div>'+'</div>'+_0x362957(0x20c)+_0x362957(0x284)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x420660[_0x362957(0x26a)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x362957(0x206)+_0x420660['date']+'\x20'+_0x362957(0x2ef)+'</h5>'+'</div>'+_0x362957(0x219)+_0x362957(0x27e)+_0x362957(0x30c)+_0x362957(0x2f8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x362957(0x223)+_0x362957(0x300)+_0x362957(0x26d)+_0x362957(0x2d6)+_0x362957(0x24d)+_0x362957(0x2bb)+'</tr>'+_0x362957(0x2c9)+_0x362957(0x280)+'\x20'+_0x85533a+'\x20'+'</tbody>'+_0x362957(0x231)+_0x362957(0x284)+_0x362957(0x281)+_0x362957(0x2d9)+_0x36b3ec[0x0][_0x362957(0x30b)]+'</h5>'+_0x362957(0x220)+_0x362957(0x220)+_0x362957(0x218)};_0x4a3587[_0x362957(0x230)](_0x2784e7,function(_0x397050,_0x26be42){var _0xa2ac10=_0x362957;_0x397050?(console[_0xa2ac10(0x2da)](_0x397050),console[_0xa2ac10(0x2da)](_0xa2ac10(0x2e0))):console['log']('Email\x20sent\x20successfully');}),_0x17419a['flash'](_0x362957(0x2aa),_0x362957(0x2c0)),_0x38b467[_0x362957(0x257)]('/picking_list/pdf/'+_0x2cd225);}catch(_0x46b4f6){console[_0x362957(0x304)](_0x46b4f6),_0x38b467[_0x362957(0x22e)](0x1f4)['json']({'error':_0x362957(0x22d)});}})[_0x52c4ad(0x264)](_0x55c109=>{var _0x36d3d2=_0x52c4ad;console['error'](_0x55c109),_0x38b467[_0x36d3d2(0x22e)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x181ee0){console[_0x52c4ad(0x2da)](_0x181ee0);}}),router[a0_0x46c467(0x25f)]('/view/:id',auth,async(_0x3e4837,_0x435045)=>{var _0x475e42=a0_0x46c467;try{const {username:_0x40b050,email:_0x3201ea,role:_0x16ce41}=_0x3e4837[_0x475e42(0x242)],_0x4f40b0=_0x3e4837[_0x475e42(0x242)],_0x35d2e7=await profile[_0x475e42(0x283)]({'email':_0x4f40b0[_0x475e42(0x2fc)]}),_0x46620e=await master_shop[_0x475e42(0x226)](),_0xa65ba8=_0x3e4837[_0x475e42(0x263)]['id'],_0x13de17=await sales_finished[_0x475e42(0x2fa)](_0xa65ba8);let _0x541b44=new Date(_0x13de17[_0x475e42(0x28b)]),_0x4370a6=('0'+_0x541b44[_0x475e42(0x235)]())[_0x475e42(0x234)](-0x2),_0x2cf818=('0'+(_0x541b44[_0x475e42(0x2c4)]()+0x1))['slice'](-0x2),_0x2d6e9b=_0x541b44['getFullYear'](),_0x302e55=_0x2d6e9b+'-'+_0x2cf818+'-'+_0x4370a6;var _0x4d27fa=[_0x475e42(0x267),_0x475e42(0x295)];const _0x1ddf10=await warehouse[_0x475e42(0x2f1)]([{'$match':{'name':_0x13de17['warehouse_name'],'room':_0x13de17[_0x475e42(0x2f3)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x475e42(0x212),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x475e42(0x253)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x475e42(0x23c)},'primary_code':{'$first':_0x475e42(0x2f7)},'secondary_code':{'$first':_0x475e42(0x25e)},'product_code':{'$first':_0x475e42(0x2ac)},'storage':{'$first':_0x475e42(0x2f6)},'rack':{'$first':_0x475e42(0x248)}}}]),_0x5e0f13=await customer['find']({});let _0x2e7d08;if(_0x4f40b0['role']==_0x475e42(0x26e)){const _0xa6bea3=await staff['findOne']({'email':_0x4f40b0[_0x475e42(0x2fc)]});_0x2e7d08=await warehouse[_0x475e42(0x2f1)]([{'$match':{'status':_0x475e42(0x1f9),'name':_0xa6bea3[_0x475e42(0x2b7)]}},{'$group':{'_id':_0x475e42(0x2c5),'name':{'$first':_0x475e42(0x2c5)}}}]);}else _0x2e7d08=await warehouse[_0x475e42(0x2f1)]([{'$match':{'status':_0x475e42(0x1f9)}},{'$group':{'_id':_0x475e42(0x2c5),'name':{'$first':_0x475e42(0x2c5)}}}]);const _0x36e38c=await product[_0x475e42(0x226)]({});if(_0x46620e[0x0]['language']==_0x475e42(0x2ec)){var _0x1322c4=users[_0x475e42(0x25d)];console[_0x475e42(0x2da)](_0x1322c4);}else{if(_0x46620e[0x0][_0x475e42(0x2ff)]==_0x475e42(0x29b))var _0x1322c4=users[_0x475e42(0x29b)];else{if(_0x46620e[0x0][_0x475e42(0x2ff)]=='German')var _0x1322c4=users[_0x475e42(0x2f5)];else{if(_0x46620e[0x0][_0x475e42(0x2ff)]==_0x475e42(0x286))var _0x1322c4=users[_0x475e42(0x286)];else{if(_0x46620e[0x0][_0x475e42(0x2ff)]==_0x475e42(0x2a1))var _0x1322c4=users[_0x475e42(0x2a1)];else{if(_0x46620e[0x0][_0x475e42(0x2ff)]==_0x475e42(0x2e7))var _0x1322c4=users[_0x475e42(0x22a)];else{if(_0x46620e[0x0][_0x475e42(0x2ff)]==_0x475e42(0x207))var _0x1322c4=users[_0x475e42(0x207)];else{if(_0x46620e[0x0][_0x475e42(0x2ff)]=='Arabic\x20(ae)')var _0x1322c4=users['Arabic'];}}}}}}}_0x435045[_0x475e42(0x2ce)](_0x475e42(0x29d),{'success':_0x3e4837[_0x475e42(0x2c3)](_0x475e42(0x2aa)),'errors':_0x3e4837[_0x475e42(0x2c3)]('errors'),'role':_0x4f40b0,'profile':_0x35d2e7,'customer':_0x5e0f13,'warehouse':_0x2e7d08,'product':_0x1ddf10,'user':_0x13de17,'master_shop':_0x46620e,'unit':_0x36e38c,'language':_0x1322c4,'rooms_data':_0x4d27fa,'ed_fullDate':_0x302e55});}catch(_0x4959f6){console[_0x475e42(0x2da)](_0x4959f6);}}),router[a0_0x46c467(0x262)]('/view/:id',auth,async(_0x171c8e,_0x1f8a82)=>{var _0x16668d=a0_0x46c467;try{const _0x141104=_0x171c8e[_0x16668d(0x263)]['id'],_0x11028b=await sales_finished[_0x16668d(0x283)]({'_id':_0x171c8e[_0x16668d(0x263)]['id']}),_0x165988=await warehouse[_0x16668d(0x283)]({'name':_0x11028b[_0x16668d(0x307)],'room':_0x171c8e[_0x16668d(0x1fa)]['room'],'warehouse_category':_0x16668d(0x2b8)}),{invoice:_0x1ea2ec,customer:_0x551f23,date:_0x2b60a1,warehouse_name:_0x9b70cf,product_name:_0x59ed5b,stock:_0x3fed1e,adjust_qty:_0x2a07ae,note:_0x201cd0,room:_0x1891af,primary_code:_0x1c5f63,secondary_code:_0x26376b,prod_code:_0x3afb81,level:_0x54dcae,isle:_0x54e603,pallet:_0x43b9d4,expiry_date:_0x1c5bb2}=_0x171c8e[_0x16668d(0x1fa)];if(typeof _0x59ed5b==_0x16668d(0x2fb))var _0x157cb6=[_0x171c8e[_0x16668d(0x1fa)]['product_name']],_0x11d520=[_0x171c8e['body']['stock']],_0x2c6387=[_0x171c8e[_0x16668d(0x1fa)]['adjust_qty']],_0x1069e4=[_0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x258)]],_0x16671d=[_0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x21a)]],_0x3c9690=[_0x171c8e[_0x16668d(0x1fa)]['prod_code']],_0x1bd3b7=[_0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x2df)]],_0x201e62=[_0x171c8e['body']['expiry_date']];else var _0x157cb6=[..._0x171c8e['body']['product_name']],_0x11d520=[..._0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x2ea)]],_0x2c6387=[..._0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x210)]],_0x1069e4=[..._0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x258)]],_0x16671d=[..._0x171c8e['body']['secondary_code']],_0x3c9690=[..._0x171c8e[_0x16668d(0x1fa)]['prod_code']],_0x1bd3b7=[..._0x171c8e[_0x16668d(0x1fa)]['level']],_0x201e62=[..._0x171c8e['body'][_0x16668d(0x28b)]];const _0x1741fb=_0x157cb6[_0x16668d(0x282)](_0x312c88=>{return _0x312c88={'product_name':_0x312c88};});_0x11d520[_0x16668d(0x2c6)]((_0x2e2344,_0x5a9ba9)=>{_0x1741fb[_0x5a9ba9]['stock']=_0x2e2344;}),_0x2c6387[_0x16668d(0x2c6)]((_0x2ed02a,_0x5d3139)=>{var _0x3c62fd=_0x16668d;_0x1741fb[_0x5d3139][_0x3c62fd(0x22f)]=_0x2ed02a;}),_0x1069e4[_0x16668d(0x2c6)]((_0xfa1508,_0x368581)=>{var _0x391fdd=_0x16668d;_0x1741fb[_0x368581][_0x391fdd(0x258)]=_0xfa1508;}),_0x16671d[_0x16668d(0x2c6)]((_0x57dee9,_0x1b0fc8)=>{var _0x72b397=_0x16668d;_0x1741fb[_0x1b0fc8][_0x72b397(0x21a)]=_0x57dee9;}),_0x3c9690[_0x16668d(0x2c6)]((_0x1a459c,_0x5343cb)=>{var _0x56bc49=_0x16668d;_0x1741fb[_0x5343cb][_0x56bc49(0x2cf)]=_0x1a459c;}),_0x1bd3b7[_0x16668d(0x2c6)]((_0x34eef0,_0x1541f7)=>{_0x1741fb[_0x1541f7]['level']=_0x34eef0;}),_0x201e62[_0x16668d(0x2c6)]((_0x2746a9,_0x1cb669)=>{_0x1741fb[_0x1cb669]['expiry_date']=_0x2746a9;});var _0xf289dd=0x0;_0x1741fb[_0x16668d(0x2c6)](_0x50eb5d=>{var _0x154ce4=_0x16668d;console[_0x154ce4(0x2da)](_0x154ce4(0x2d0),_0x50eb5d),(parseInt(_0x50eb5d[_0x154ce4(0x2ea)])<parseInt(_0x50eb5d[_0x154ce4(0x22f)])||parseInt(_0x50eb5d[_0x154ce4(0x22f)])==0x0)&&_0xf289dd++;});if(_0xf289dd!=0x0)return _0x171c8e[_0x16668d(0x2c3)](_0x16668d(0x2f9),_0x16668d(0x2b2)),_0x1f8a82['redirect'](_0x16668d(0x1f2));_0x11028b[_0x16668d(0x29c)]['forEach'](_0x16d122=>{var _0xb1c0ec=_0x16668d;const _0x5b93b5=_0x165988['product_details'][_0xb1c0ec(0x282)](_0x2f028d=>{var _0x172b67=_0xb1c0ec;_0x2f028d[_0x172b67(0x23b)]==_0x16d122[_0x172b67(0x23b)]&&_0x2f028d[_0x172b67(0x1fb)]==_0x16d122[_0x172b67(0x1fb)]&&(_0x2f028d[_0x172b67(0x2d1)]=parseInt(_0x2f028d['product_stock'])+parseInt(_0x16d122[_0x172b67(0x22f)]));});}),await _0x165988[_0x16668d(0x251)]();const _0x23f7d2=_0x1741fb[_0x16668d(0x1f3)](_0xe4778c=>_0xe4778c['quantity']!=='0'&&_0xe4778c['quantity']!=='');_0x11028b[_0x16668d(0x26a)]=_0x1ea2ec,_0x11028b[_0x16668d(0x2eb)]=_0x551f23,_0x11028b[_0x16668d(0x2a7)]=_0x2b60a1,_0x11028b['warehouse_name']=_0x9b70cf,_0x11028b[_0x16668d(0x29c)]=_0x23f7d2,_0x11028b[_0x16668d(0x2b3)]=_0x201cd0,_0x11028b[_0x16668d(0x2f3)]=_0x1891af;const _0x2ecf98=await _0x11028b[_0x16668d(0x251)](),_0x53dfad=await sales_finished[_0x16668d(0x283)]({'_id':_0x171c8e[_0x16668d(0x263)]['id']}),_0x482f3c=await warehouse['findOne']({'name':_0x9b70cf,'room':_0x1891af,'warehouse_category':_0x16668d(0x2b8)});_0x53dfad[_0x16668d(0x29c)][_0x16668d(0x2c6)](_0x40bc0c=>{var _0x539bed=_0x16668d;const _0x52d4c2=_0x482f3c['product_details'][_0x539bed(0x282)](_0x1de461=>{var _0x3d43d4=_0x539bed;_0x1de461[_0x3d43d4(0x23b)]==_0x40bc0c[_0x3d43d4(0x23b)]&&_0x1de461[_0x3d43d4(0x1fb)]==_0x40bc0c[_0x3d43d4(0x1fb)]&&(_0x1de461[_0x3d43d4(0x2d1)]=parseInt(_0x1de461[_0x3d43d4(0x2d1)])-parseInt(_0x40bc0c['quantity']));});}),console[_0x16668d(0x2da)]('final',_0x482f3c),await _0x482f3c[_0x16668d(0x251)]();const _0xe28010=await c_payment_data[_0x16668d(0x283)]({'invoice':_0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x26a)]});_0xe28010['suppliers']=_0x171c8e[_0x16668d(0x1fa)][_0x16668d(0x2b1)],await _0xe28010[_0x16668d(0x251)](),_0x171c8e[_0x16668d(0x2c3)]('success',_0x16668d(0x2c0)),_0x1f8a82[_0x16668d(0x257)](_0x16668d(0x2ab));}catch(_0x38b65c){console[_0x16668d(0x2da)](_0x38b65c);}}),router[a0_0x46c467(0x262)]('/give_payment/:id',auth,async(_0x57f63b,_0x3d623a)=>{var _0x55c3a3=a0_0x46c467;try{const _0x2e3d84=_0x57f63b[_0x55c3a3(0x263)]['id'],{invoice:_0x2131ed,customer:_0x2212e1,receivable_amount:_0x28f5b2,received_amount:_0x188738}=_0x57f63b['body'],_0x59ab8a=await sales[_0x55c3a3(0x2fa)](_0x2e3d84);console[_0x55c3a3(0x2da)](_0x59ab8a);var _0x59f22f=_0x28f5b2-_0x188738;console['log'](_0x188738),_0x59ab8a[_0x55c3a3(0x1f4)]=parseFloat(_0x188738)+parseFloat(_0x59ab8a[_0x55c3a3(0x1f4)]),_0x59ab8a[_0x55c3a3(0x29f)]=_0x59f22f,console['log'](_0x59ab8a);const _0x406b9f=await _0x59ab8a[_0x55c3a3(0x251)](),_0x3940b8=await c_payment_data[_0x55c3a3(0x283)]({'invoice':_0x2131ed});_0x3940b8[_0x55c3a3(0x294)]=_0x59f22f,await _0x3940b8['save']();let _0x1d370f=new Date(),_0x3295fe=('0'+_0x1d370f['getDate']())[_0x55c3a3(0x234)](-0x2),_0x52bd82=('0'+(_0x1d370f[_0x55c3a3(0x2c4)]()+0x1))[_0x55c3a3(0x234)](-0x2),_0x38b373=_0x1d370f[_0x55c3a3(0x269)](),_0x3aabad=_0x38b373+'-'+_0x52bd82+'-'+_0x3295fe;const _0x51e181=new customer_payment({'invoice':_0x2131ed,'date':_0x38b373+'-'+_0x52bd82+'-'+_0x3295fe,'customer':_0x2212e1,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x188738}),_0x2792fd=await _0x51e181[_0x55c3a3(0x251)]();_0x57f63b[_0x55c3a3(0x2c3)](_0x55c3a3(0x2aa),_0x55c3a3(0x2ae)),_0x3d623a[_0x55c3a3(0x257)](_0x55c3a3(0x261));}catch(_0x38b2c8){console['log'](_0x38b2c8);}}),router[a0_0x46c467(0x25f)](a0_0x46c467(0x2f0),auth,async(_0x165c14,_0x476ef6)=>{var _0x2e4548=a0_0x46c467;try{const {username:_0x4c43c6,email:_0x48cd2b,role:_0x3b4348}=_0x165c14[_0x2e4548(0x242)],_0x3f2a52=_0x165c14[_0x2e4548(0x242)],_0x1cb17b=await profile['findOne']({'email':_0x3f2a52[_0x2e4548(0x2fc)]}),_0x280317=await master_shop[_0x2e4548(0x226)]();console[_0x2e4548(0x2da)](_0x2e4548(0x27f),_0x280317);const _0x22ebd4=_0x165c14[_0x2e4548(0x263)]['id'],_0x2e71e1=await sales[_0x2e4548(0x2fa)](_0x22ebd4);console[_0x2e4548(0x2da)](_0x2e71e1);const _0x59faf9=await customer[_0x2e4548(0x283)]({'name':_0x2e71e1[_0x2e4548(0x2eb)]});console[_0x2e4548(0x2da)](_0x59faf9);if(_0x280317[0x0][_0x2e4548(0x2ff)]==_0x2e4548(0x2ec)){var _0x10ca55=users[_0x2e4548(0x25d)];console['log'](_0x10ca55);}else{if(_0x280317[0x0][_0x2e4548(0x2ff)]==_0x2e4548(0x29b))var _0x10ca55=users['Hindi'];else{if(_0x280317[0x0][_0x2e4548(0x2ff)]==_0x2e4548(0x2f5))var _0x10ca55=users[_0x2e4548(0x2f5)];else{if(_0x280317[0x0][_0x2e4548(0x2ff)]=='Spanish')var _0x10ca55=users['Spanish'];else{if(_0x280317[0x0][_0x2e4548(0x2ff)]=='French')var _0x10ca55=users[_0x2e4548(0x2a1)];else{if(_0x280317[0x0][_0x2e4548(0x2ff)]=='Portuguese\x20(BR)')var _0x10ca55=users['Portuguese'];else{if(_0x280317[0x0][_0x2e4548(0x2ff)]==_0x2e4548(0x207))var _0x10ca55=users[_0x2e4548(0x207)];else{if(_0x280317[0x0][_0x2e4548(0x2ff)]=='Arabic\x20(ae)')var _0x10ca55=users[_0x2e4548(0x244)];}}}}}}}_0x476ef6['render'](_0x2e4548(0x208),{'success':_0x165c14[_0x2e4548(0x2c3)](_0x2e4548(0x2aa)),'errors':_0x165c14['flash'](_0x2e4548(0x2f9)),'role':_0x3f2a52,'profile':_0x1cb17b,'master_shop':_0x280317,'customers':_0x59faf9,'sales':_0x2e71e1,'language':_0x10ca55});}catch(_0x41c743){console['log'](_0x41c743);}}),router['get'](a0_0x46c467(0x236),auth,async(_0x1a270c,_0x59d81b)=>{var _0x2e9d0c=a0_0x46c467;try{const {username:_0x40ce09,email:_0x477a60,role:_0x25fbea}=_0x1a270c[_0x2e9d0c(0x242)],_0x1ea4ab=_0x1a270c[_0x2e9d0c(0x242)],_0xf1da28=await profile[_0x2e9d0c(0x283)]({'email':_0x1ea4ab[_0x2e9d0c(0x2fc)]}),_0x55d0b0=await master_shop['find'](),_0x3b8dd9=_0x1a270c[_0x2e9d0c(0x263)]['id'],_0x3f9e37=await sales_finished[_0x2e9d0c(0x2fa)](_0x3b8dd9),_0x45e332=await warehouse[_0x2e9d0c(0x2f1)]([{'$match':{'name':_0x3f9e37[_0x2e9d0c(0x307)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2e9d0c(0x292)},'bay':{'$first':_0x2e9d0c(0x209)},'bin':{'$first':_0x2e9d0c(0x253)},'type':{'$first':_0x2e9d0c(0x2c7)},'floorlevel':{'$first':_0x2e9d0c(0x23c)},'primary_code':{'$first':_0x2e9d0c(0x2f7)},'secondary_code':{'$first':_0x2e9d0c(0x25e)},'product_code':{'$first':_0x2e9d0c(0x2ac)},'storage':{'$first':_0x2e9d0c(0x2f6)},'rack':{'$first':_0x2e9d0c(0x248)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2e9d0c(0x290)},'unit':{'$first':_0x2e9d0c(0x24a)},'secondary_unit':{'$first':_0x2e9d0c(0x2be)},'maxProducts':{'$first':_0x2e9d0c(0x25b)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x2e9d0c(0x255)}}}]),_0x3ba360=await product[_0x2e9d0c(0x226)]({}),_0x595914=await warehouse[_0x2e9d0c(0x2f1)]([{'$match':{'status':_0x2e9d0c(0x1f9),'warehouse_category':_0x2e9d0c(0x2b8),'name':{'$ne':_0x2e9d0c(0x1fc),'$ne':'Quality\x20Inspection'}}},{'$group':{'_id':'$name','name':{'$first':_0x2e9d0c(0x2c5)}}},{'$sort':{'name':0x1}}]);var _0x362dc5=['Return\x20Rooms'];const _0x52a670=await warehouse[_0x2e9d0c(0x2f1)]([{'$match':{'status':_0x2e9d0c(0x1f9),'name':_0x2e9d0c(0x309)}},{'$group':{'_id':_0x2e9d0c(0x2c5),'name':{'$first':_0x2e9d0c(0x2c5)}}},{'$sort':{'name':0x1}}]);if(_0x55d0b0[0x0][_0x2e9d0c(0x2ff)]==_0x2e9d0c(0x2ec)){var _0x159c35=users[_0x2e9d0c(0x25d)];console['log'](_0x159c35);}else{if(_0x55d0b0[0x0][_0x2e9d0c(0x2ff)]=='Hindi')var _0x159c35=users['Hindi'];else{if(_0x55d0b0[0x0][_0x2e9d0c(0x2ff)]==_0x2e9d0c(0x2f5))var _0x159c35=users['German'];else{if(_0x55d0b0[0x0][_0x2e9d0c(0x2ff)]==_0x2e9d0c(0x286))var _0x159c35=users[_0x2e9d0c(0x286)];else{if(_0x55d0b0[0x0]['language']=='French')var _0x159c35=users[_0x2e9d0c(0x2a1)];else{if(_0x55d0b0[0x0][_0x2e9d0c(0x2ff)]==_0x2e9d0c(0x2e7))var _0x159c35=users[_0x2e9d0c(0x22a)];else{if(_0x55d0b0[0x0]['language']==_0x2e9d0c(0x207))var _0x159c35=users['Chinese'];else{if(_0x55d0b0[0x0][_0x2e9d0c(0x2ff)]==_0x2e9d0c(0x2a5))var _0x159c35=users['Arabic'];}}}}}}}_0x59d81b[_0x2e9d0c(0x2ce)](_0x2e9d0c(0x297),{'success':_0x1a270c[_0x2e9d0c(0x2c3)](_0x2e9d0c(0x2aa)),'errors':_0x1a270c['flash'](_0x2e9d0c(0x2f9)),'role':_0x1ea4ab,'profile':_0xf1da28,'user':_0x3f9e37,'stock':_0x45e332,'master_shop':_0x55d0b0,'unit':_0x3ba360,'language':_0x159c35,'warehouses':_0x595914,'rooms':_0x362dc5,'warehouse_QA':_0x52a670});}catch(_0x35ccfe){console['log'](_0x35ccfe),_0x59d81b['status'](0xc8)['json']({'message':_0x35ccfe['message']});}}),router[a0_0x46c467(0x262)](a0_0x46c467(0x236),auth,async(_0x43a796,_0x26dc5e)=>{var _0x170d37=a0_0x46c467;if(_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x238)]=='QA')try{const {invoice:_0x136644,date:_0x4f4f53,warehouse_name:_0x4efe50,product_name:_0xa4616f,primary_code:_0x3811f9,secondary_code:_0x1a00da,product_code:_0x321f2b,sales_quantity:_0x3a5a25,stocks:_0x29106a,return_qty:_0x244528,Room_name:_0x18ff06,to_warehouse_name_QA:_0x20c6c8,to_Room_name_QA:_0x49d4b5,note:_0x52247a,for_categorize:_0x15bcae,product_name_QA1:_0x58388b}=_0x43a796[_0x170d37(0x1fa)];if(typeof _0x58388b==_0x170d37(0x2fb))var _0x5ca9c3=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x224)]],_0x4e34f8=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x23d)]],_0x414764=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x299)]],_0x515c60=[_0x43a796['body'][_0x170d37(0x1f6)]],_0x5b4992=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2db)]],_0x26e03f=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2b9)]],_0x2ae135=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x20d)]],_0x47e0de=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2d2)]],_0x411e6d=[_0x43a796[_0x170d37(0x1fa)]['maxProducts_QA']],_0x46465d=[_0x43a796[_0x170d37(0x1fa)]['batch_code_QA']],_0x54088d=[_0x43a796[_0x170d37(0x1fa)]['secondary_unit_QA']],_0x2fcf0d=[_0x43a796[_0x170d37(0x1fa)]['unit_QA']],_0x4e96b0=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x243)]],_0x57cf72=[_0x43a796[_0x170d37(0x1fa)]['expiry_date_QA']];else var _0x5ca9c3=[..._0x43a796['body']['product_name_QA1']],_0x4e34f8=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x23d)]],_0x414764=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x299)]],_0x515c60=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x1f6)]],_0x5b4992=[..._0x43a796['body'][_0x170d37(0x2db)]],_0x26e03f=[..._0x43a796[_0x170d37(0x1fa)]['stocks_QA']],_0x2ae135=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x20d)]],_0x47e0de=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2d2)]],_0x411e6d=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x232)]],_0x46465d=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x21d)]],_0x54088d=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2c8)]],_0x2fcf0d=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x30d)]],_0x4e96b0=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x243)]],_0x57cf72=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2fd)]];const _0x4e74f4=_0x5ca9c3['map'](_0x2a7fc4=>{return _0x2a7fc4={'product_name':_0x2a7fc4};});_0x4e34f8[_0x170d37(0x2c6)]((_0x3788f7,_0x26434c)=>{_0x4e74f4[_0x26434c]['primary_code']=_0x3788f7;}),_0x414764[_0x170d37(0x2c6)]((_0x1364e9,_0x147ffb)=>{var _0x242efe=_0x170d37;_0x4e74f4[_0x147ffb][_0x242efe(0x21a)]=_0x1364e9;}),_0x515c60['forEach']((_0x1fe3aa,_0x2f1f18)=>{var _0x13055f=_0x170d37;_0x4e74f4[_0x2f1f18][_0x13055f(0x2cf)]=_0x1fe3aa;}),_0x5b4992[_0x170d37(0x2c6)]((_0x33ad51,_0x21ab98)=>{_0x4e74f4[_0x21ab98]['sale_qty']=_0x33ad51;}),_0x26e03f[_0x170d37(0x2c6)]((_0x5ac471,_0x366d29)=>{var _0x292e5f=_0x170d37;_0x4e74f4[_0x366d29][_0x292e5f(0x2ea)]=_0x5ac471;}),_0x2ae135[_0x170d37(0x2c6)]((_0x415ef6,_0x4f9d0c)=>{var _0x454771=_0x170d37;_0x4e74f4[_0x4f9d0c][_0x454771(0x202)]=_0x415ef6;}),_0x47e0de['forEach']((_0x3ede43,_0x17640c)=>{var _0x1fac22=_0x170d37;_0x4e74f4[_0x17640c][_0x1fac22(0x2e4)]=_0x3ede43;}),_0x411e6d['forEach']((_0x62d4dc,_0x3be72d)=>{var _0x368740=_0x170d37;_0x4e74f4[_0x3be72d][_0x368740(0x2e6)]=_0x62d4dc;}),_0x46465d[_0x170d37(0x2c6)]((_0x20ea50,_0x308701)=>{var _0x101c76=_0x170d37;_0x4e74f4[_0x308701][_0x101c76(0x201)]=_0x20ea50;}),_0x54088d[_0x170d37(0x2c6)]((_0x2c2632,_0x376d32)=>{var _0xce4598=_0x170d37;_0x4e74f4[_0x376d32][_0xce4598(0x237)]=_0x2c2632;}),_0x2fcf0d[_0x170d37(0x2c6)]((_0x290750,_0x9f7c1f)=>{var _0x382114=_0x170d37;_0x4e74f4[_0x9f7c1f][_0x382114(0x266)]=_0x290750;}),_0x4e96b0[_0x170d37(0x2c6)]((_0x120864,_0x99abcf)=>{var _0x172ffc=_0x170d37;_0x4e74f4[_0x99abcf][_0x172ffc(0x293)]=_0x120864;}),_0x57cf72['forEach']((_0x264073,_0x3d8712)=>{var _0x342f91=_0x170d37;_0x4e74f4[_0x3d8712][_0x342f91(0x28b)]=_0x264073;});const _0x360a02=await sales_finished['findOne']({'invoice':_0x136644});_0x360a02[_0x170d37(0x24f)]='True';const _0x343a15=await _0x360a02[_0x170d37(0x251)](),_0x4ed506=new sales_return_finished({'invoice':_0x136644,'customer':_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2eb)],'date':_0x4f4f53,'warehouse_name':_0x4efe50,'room':_0x18ff06,'ToWarehouse':_0x20c6c8,'ToRoom':_0x49d4b5,'return_sale_QA':_0x4e74f4,'note':_0x52247a,'warehouse_cat':_0x15bcae}),_0x30075f=await _0x4ed506[_0x170d37(0x251)](),_0x246645=await sales_return_finished[_0x170d37(0x283)]({'invoice':_0x136644}),_0x5dfbc4=await warehouse[_0x170d37(0x283)]({'name':_0x20c6c8,'room':_0x49d4b5});_0x246645[_0x170d37(0x2e9)][_0x170d37(0x2c6)](_0x401c8f=>{var _0x2b2abd=_0x170d37,_0x4508e4=0x0;const _0x5af21c=_0x5dfbc4[_0x2b2abd(0x28a)][_0x2b2abd(0x282)](_0x2968cd=>{var _0x483c74=_0x2b2abd;_0x2968cd[_0x483c74(0x23b)]==_0x401c8f[_0x483c74(0x23b)]&&_0x2968cd[_0x483c74(0x28b)]==_0x401c8f[_0x483c74(0x28b)]&&_0x2968cd[_0x483c74(0x293)]==_0x401c8f['production_date']&&_0x2968cd[_0x483c74(0x201)]==_0x401c8f[_0x483c74(0x201)]&&(_0x2968cd[_0x483c74(0x2d1)]=parseInt(_0x2968cd[_0x483c74(0x2d1)])+parseInt(_0x401c8f[_0x483c74(0x202)]),_0x4508e4++);});_0x4508e4=='0'&&(_0x5dfbc4[_0x2b2abd(0x28a)]=_0x5dfbc4['product_details'][_0x2b2abd(0x204)]({'product_name':_0x401c8f[_0x2b2abd(0x23b)],'product_stock':_0x401c8f[_0x2b2abd(0x202)],'primary_code':_0x401c8f[_0x2b2abd(0x258)],'secondary_code':_0x401c8f[_0x2b2abd(0x21a)],'product_code':_0x401c8f[_0x2b2abd(0x2cf)],'batch_code':_0x401c8f['batch_code'],'maxPerUnit':_0x401c8f['maxPerUnit'],'production_date':_0x401c8f[_0x2b2abd(0x293)],'expiry_date':_0x401c8f[_0x2b2abd(0x28b)],'secondary_unit':_0x401c8f[_0x2b2abd(0x237)],'unit':_0x401c8f['unit'],'maxProducts':_0x401c8f[_0x2b2abd(0x2e6)],'bay':_0x401c8f['bay']}));}),await _0x5dfbc4['save']();const _0x3803c6=new c_payment_data({'invoice':_0x136644,'customer':_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2eb)],'reason':_0x170d37(0x25c)});await _0x3803c6[_0x170d37(0x251)]();const _0x208c48=await master_shop[_0x170d37(0x226)](),_0x21750b=await email_settings[_0x170d37(0x283)](),_0x418d16=await customer['findOne']({'name':_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2eb)]});_0x208c48[0x0][_0x170d37(0x2ed)]==0x1?(right_currency=_0x208c48[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x208c48[0x0][_0x170d37(0x227)]);var _0x37f08b=_0x5ca9c3,_0x194d85=_0x2ae135,_0x56a261='',_0x19e95d;for(_0x19e95d in _0x37f08b){_0x56a261+=_0x170d37(0x30c)+_0x170d37(0x28c)+_0x37f08b[_0x19e95d]+'</td>'+_0x170d37(0x28c)+_0x194d85[_0x19e95d]+_0x170d37(0x274)+_0x170d37(0x29e);}console[_0x170d37(0x2da)](_0x170d37(0x2dd),_0x56a261);let _0x4c8f16=nodemailer[_0x170d37(0x2e8)]({'service':_0x170d37(0x1f5),'auth':{'user':_0x21750b['email'],'pass':_0x21750b[_0x170d37(0x302)]}}),_0x38a63c={'from':_0x21750b[_0x170d37(0x2fc)],'to':_0x418d16['email'],'subject':_0x170d37(0x27a),'attachments':[{'filename':_0x170d37(0x22b),'path':__dirname+_0x170d37(0x252)+_0x170d37(0x2f2)+_0x208c48[0x0][_0x170d37(0x301)],'cid':'logo'}],'html':_0x170d37(0x216)+_0x170d37(0x2e1)+_0x170d37(0x2d5)+_0x170d37(0x284)+_0x170d37(0x2bd)+_0x170d37(0x284)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x170d37(0x220)+_0x170d37(0x284)+_0x170d37(0x276)+_0x208c48[0x0][_0x170d37(0x30b)]+_0x170d37(0x2a8)+'</div>'+_0x170d37(0x220)+_0x170d37(0x20c)+'<div>'+_0x170d37(0x23f)+_0x170d37(0x2e3)+_0x136644+'\x20'+_0x170d37(0x2d4)+_0x170d37(0x206)+_0x4f4f53+'\x20'+'</span>'+_0x170d37(0x1fe)+_0x170d37(0x220)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x170d37(0x27e)+'<tr>'+_0x170d37(0x2f8)+_0x170d37(0x254)+_0x170d37(0x22c)+_0x170d37(0x285)+'</tr>'+_0x170d37(0x2c9)+_0x170d37(0x280)+'\x20'+_0x56a261+'\x20'+_0x170d37(0x27d)+_0x170d37(0x231)+_0x170d37(0x284)+'<strong>\x20Regards\x20</strong>'+_0x170d37(0x2d9)+_0x208c48[0x0][_0x170d37(0x30b)]+'</h5>'+_0x170d37(0x220)+_0x170d37(0x220)+_0x170d37(0x218)};_0x4c8f16['sendMail'](_0x38a63c,function(_0x3b8b43,_0x23e5f5){var _0x52e6ce=_0x170d37;_0x3b8b43?(console['log'](_0x3b8b43),console[_0x52e6ce(0x2da)]('Error\x20Occurs')):console[_0x52e6ce(0x2da)](_0x52e6ce(0x259));}),_0x43a796[_0x170d37(0x2c3)](_0x170d37(0x2aa),'sales\x20item\x20return\x20successfull'),_0x26dc5e[_0x170d37(0x257)](_0x170d37(0x2ab));}catch(_0x3d6246){_0x26dc5e[_0x170d37(0x22e)](0xc8)['json']({'message1':_0x3d6246[_0x170d37(0x2a0)]});}else{if(_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x238)]=='GS')try{const {invoice:_0x7f4427,date:_0x3d7e3e,warehouse_name:_0x32539c,product_name:_0x3a6382,primary_code:_0x3bbde0,secondary_code:_0x35e379,product_code:_0xd5cf5e,sales_quantity:_0x56cdd3,stocks:_0x2e3afd,return_qty:_0x333b7f,Room_name:_0x47415a,to_warehouse_name:_0x43c497,to_Room_name:_0x4601f1,note:_0x3b9c01,level:_0x2a5ec2,isle:_0xdf5844,pallet:_0x21dd42,for_categorize:_0x41f044}=_0x43a796[_0x170d37(0x1fa)];if(typeof _0x3a6382==_0x170d37(0x2fb))var _0x5ca9c3=[_0x43a796['body'][_0x170d37(0x23b)]],_0x4e34f8=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x258)]],_0x414764=[_0x43a796[_0x170d37(0x1fa)]['secondary_code']],_0x515c60=[_0x43a796[_0x170d37(0x1fa)]['product_code']],_0x5b4992=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2af)]],_0x2ae135=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x202)]],_0x50fca1=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x1fb)]],_0x47e0de=[_0x43a796['body'][_0x170d37(0x2e4)]],_0x411e6d=[_0x43a796['body'][_0x170d37(0x2e6)]],_0x46465d=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x201)]],_0x54088d=[_0x43a796['body'][_0x170d37(0x237)]],_0x2fcf0d=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x266)]],_0x4e96b0=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x293)]],_0x57cf72=[_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x28b)]];else var _0x5ca9c3=[..._0x43a796['body'][_0x170d37(0x23b)]],_0x4e34f8=[..._0x43a796['body']['primary_code']],_0x414764=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x21a)]],_0x515c60=[..._0x43a796['body'][_0x170d37(0x2cf)]],_0x5b4992=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2af)]],_0x2ae135=[..._0x43a796[_0x170d37(0x1fa)]['return_qty']],_0x50fca1=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x1fb)]],_0x47e0de=[..._0x43a796[_0x170d37(0x1fa)]['maxPerUnit']],_0x411e6d=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2e6)]],_0x46465d=[..._0x43a796[_0x170d37(0x1fa)]['batch_code']],_0x54088d=[..._0x43a796[_0x170d37(0x1fa)]['secondary_unit']],_0x2fcf0d=[..._0x43a796['body'][_0x170d37(0x266)]],_0x4e96b0=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x293)]],_0x57cf72=[..._0x43a796[_0x170d37(0x1fa)][_0x170d37(0x28b)]];const _0x391da5=_0x5ca9c3[_0x170d37(0x282)](_0x436726=>{return _0x436726={'product_name':_0x436726};});_0x4e34f8[_0x170d37(0x2c6)]((_0x294d30,_0x55375f)=>{var _0x5b1f9e=_0x170d37;_0x391da5[_0x55375f][_0x5b1f9e(0x258)]=_0x294d30;}),_0x414764['forEach']((_0x2cf14a,_0x22b7ea)=>{_0x391da5[_0x22b7ea]['secondary_code']=_0x2cf14a;}),_0x515c60[_0x170d37(0x2c6)]((_0x4d400f,_0x3be0e0)=>{_0x391da5[_0x3be0e0]['product_code']=_0x4d400f;}),_0x5b4992[_0x170d37(0x2c6)]((_0x5f256f,_0xe19716)=>{var _0x2cb7b3=_0x170d37;_0x391da5[_0xe19716][_0x2cb7b3(0x2bf)]=_0x5f256f;}),_0x2ae135[_0x170d37(0x2c6)]((_0x51356f,_0x10c693)=>{var _0x5431b5=_0x170d37;_0x391da5[_0x10c693][_0x5431b5(0x202)]=_0x51356f;}),_0x50fca1['forEach']((_0x588cc1,_0xa1fc70)=>{var _0x23dfc0=_0x170d37;_0x391da5[_0xa1fc70][_0x23dfc0(0x1fb)]=_0x588cc1;}),_0x47e0de[_0x170d37(0x2c6)]((_0x43e43d,_0x23aedb)=>{_0x391da5[_0x23aedb]['maxPerUnit']=_0x43e43d;}),_0x411e6d[_0x170d37(0x2c6)]((_0x41c0ea,_0xb99029)=>{var _0x2d9911=_0x170d37;_0x391da5[_0xb99029][_0x2d9911(0x2e6)]=_0x41c0ea;}),_0x46465d[_0x170d37(0x2c6)]((_0x27062e,_0x161f2d)=>{_0x391da5[_0x161f2d]['batch_code']=_0x27062e;}),_0x54088d[_0x170d37(0x2c6)]((_0x466fef,_0x36a65a)=>{_0x391da5[_0x36a65a]['secondary_unit']=_0x466fef;}),_0x2fcf0d['forEach']((_0x3e09b3,_0x3a6dfa)=>{var _0x59369c=_0x170d37;_0x391da5[_0x3a6dfa][_0x59369c(0x266)]=_0x3e09b3;}),_0x4e96b0[_0x170d37(0x2c6)]((_0x291dc8,_0x3763aa)=>{var _0x4a7d5a=_0x170d37;_0x391da5[_0x3763aa][_0x4a7d5a(0x293)]=_0x291dc8;}),_0x57cf72['forEach']((_0x344055,_0x1fdcfe)=>{var _0x189399=_0x170d37;_0x391da5[_0x1fdcfe][_0x189399(0x28b)]=_0x344055;});var _0x234149=0x0;_0x391da5[_0x170d37(0x2c6)](_0x37f31e=>{var _0x33da46=_0x170d37;(parseInt(_0x37f31e[_0x33da46(0x2bf)])<parseInt(_0x37f31e['return_qty'])||parseInt(_0x37f31e['stock'])<parseInt(_0x37f31e[_0x33da46(0x202)])&&parseInt(_0x37f31e[_0x33da46(0x2bf)])>parseInt(_0x37f31e[_0x33da46(0x202)])||parseInt(_0x37f31e[_0x33da46(0x202)])==0x0)&&_0x234149++;});if(_0x234149!=0x0)return _0x43a796[_0x170d37(0x2c3)]('errors',_0x170d37(0x247)),_0x26dc5e[_0x170d37(0x257)](_0x170d37(0x1f2));const _0x5b8415=await sales_finished[_0x170d37(0x283)]({'invoice':_0x7f4427});_0x5b8415[_0x170d37(0x24f)]=_0x170d37(0x2c1);const _0x3a4f50=await _0x5b8415[_0x170d37(0x251)](),_0x22b09b=new sales_return_finished({'invoice':_0x7f4427,'customer':_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2eb)],'date':_0x3d7e3e,'warehouse_name':_0x32539c,'room':_0x47415a,'ToWarehouse':_0x43c497,'ToRoom':_0x4601f1,'return_sale':_0x391da5,'note':_0x3b9c01,'warehouse_cat':_0x41f044}),_0x5103f2=await _0x22b09b[_0x170d37(0x251)](),_0x1ba979=await sales_return_finished[_0x170d37(0x283)]({'invoice':_0x7f4427}),_0x35368c=await warehouse[_0x170d37(0x283)]({'name':_0x43c497,'room':_0x4601f1,'warehouse_category':'Finished\x20Goods'});_0x1ba979['return_sale'][_0x170d37(0x2c6)](_0x32a44a=>{var _0x5eb0d9=_0x170d37,_0x1c1bcb=0x0;const _0x365c6c=_0x35368c[_0x5eb0d9(0x28a)][_0x5eb0d9(0x282)](_0x245399=>{var _0x3ef267=_0x5eb0d9;_0x245399[_0x3ef267(0x23b)]==_0x32a44a[_0x3ef267(0x23b)]&&_0x245399[_0x3ef267(0x1fb)]==_0x32a44a[_0x3ef267(0x1fb)]&&_0x245399[_0x3ef267(0x28b)]==_0x32a44a['expiry_date']&&_0x245399[_0x3ef267(0x293)]==_0x32a44a[_0x3ef267(0x293)]&&_0x245399[_0x3ef267(0x201)]==_0x32a44a[_0x3ef267(0x201)]&&(_0x245399[_0x3ef267(0x2d1)]=parseInt(_0x245399['product_stock'])+parseInt(_0x32a44a['return_qty']),_0x1c1bcb++);});_0x1c1bcb=='0'&&(_0x35368c[_0x5eb0d9(0x28a)]=_0x35368c[_0x5eb0d9(0x28a)][_0x5eb0d9(0x204)]({'product_name':_0x32a44a['product_name'],'product_stock':_0x32a44a[_0x5eb0d9(0x202)],'primary_code':_0x32a44a[_0x5eb0d9(0x258)],'secondary_code':_0x32a44a[_0x5eb0d9(0x21a)],'product_code':_0x32a44a['product_code'],'bay':_0x32a44a[_0x5eb0d9(0x1fb)],'batch_code':_0x32a44a[_0x5eb0d9(0x201)],'maxPerUnit':_0x32a44a[_0x5eb0d9(0x2e4)],'production_date':_0x32a44a[_0x5eb0d9(0x293)],'expiry_date':_0x32a44a[_0x5eb0d9(0x28b)],'secondary_unit':_0x32a44a[_0x5eb0d9(0x237)],'unit':_0x32a44a[_0x5eb0d9(0x266)],'maxProducts':_0x32a44a[_0x5eb0d9(0x2e6)]}));}),await _0x35368c[_0x170d37(0x251)](),console[_0x170d37(0x2da)](_0x43a796['body']);const _0x1f5f09=new c_payment_data({'invoice':_0x7f4427,'customer':_0x43a796[_0x170d37(0x1fa)][_0x170d37(0x2eb)],'reason':_0x170d37(0x25c)});await _0x1f5f09[_0x170d37(0x251)]();const _0x286ee1=await master_shop[_0x170d37(0x226)]();console['log'](_0x170d37(0x28d),_0x286ee1[0x0][_0x170d37(0x301)]);const _0x422bde=await email_settings[_0x170d37(0x283)](),_0xdd6088=await customer[_0x170d37(0x283)]({'name':_0x43a796[_0x170d37(0x1fa)]['customer']});console[_0x170d37(0x2da)](_0x170d37(0x246),_0xdd6088);_0x286ee1[0x0][_0x170d37(0x2ed)]==0x1?(right_currency=_0x286ee1[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x286ee1[0x0][_0x170d37(0x227)]);var _0x37f08b=_0x5ca9c3,_0x194d85=_0x2ae135,_0x56a261='',_0x19e95d;for(_0x19e95d in _0x37f08b){_0x56a261+=_0x170d37(0x30c)+_0x170d37(0x28c)+_0x37f08b[_0x19e95d]+_0x170d37(0x274)+_0x170d37(0x28c)+_0x194d85[_0x19e95d]+_0x170d37(0x274)+_0x170d37(0x29e);}console['log'](_0x170d37(0x2dd),_0x56a261);let _0x2eeb1f=nodemailer['createTransport']({'service':'gmail','auth':{'user':_0x422bde['email'],'pass':_0x422bde['password']}}),_0x1700e4={'from':_0x422bde[_0x170d37(0x2fc)],'to':_0xdd6088[_0x170d37(0x2fc)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x170d37(0x22b),'path':__dirname+_0x170d37(0x252)+_0x170d37(0x2f2)+_0x286ee1[0x0][_0x170d37(0x301)],'cid':_0x170d37(0x1ff)}],'html':'<!DOCTYPE\x20html>'+_0x170d37(0x2e1)+'</head><body>'+_0x170d37(0x284)+_0x170d37(0x2bd)+_0x170d37(0x284)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x170d37(0x220)+'<div>'+_0x170d37(0x276)+_0x286ee1[0x0][_0x170d37(0x30b)]+_0x170d37(0x2a8)+'</div>'+_0x170d37(0x220)+_0x170d37(0x20c)+'<div>'+_0x170d37(0x23f)+'\x20Order\x20Number\x20:\x20'+_0x7f4427+'\x20'+_0x170d37(0x2d4)+_0x170d37(0x206)+_0x3d7e3e+'\x20'+_0x170d37(0x2ef)+_0x170d37(0x1fe)+'</div>'+_0x170d37(0x219)+_0x170d37(0x27e)+_0x170d37(0x30c)+_0x170d37(0x2f8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x170d37(0x22c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+'</tr>'+_0x170d37(0x2c9)+_0x170d37(0x280)+'\x20'+_0x56a261+'\x20'+_0x170d37(0x27d)+_0x170d37(0x231)+_0x170d37(0x284)+'<strong>\x20Regards\x20</strong>'+_0x170d37(0x2d9)+_0x286ee1[0x0][_0x170d37(0x30b)]+_0x170d37(0x1fe)+'</div>'+'</div>'+_0x170d37(0x218)};_0x2eeb1f['sendMail'](_0x1700e4,function(_0x3c3e17,_0x51eac2){var _0x2c9982=_0x170d37;_0x3c3e17?(console['log'](_0x3c3e17),console[_0x2c9982(0x2da)]('Error\x20Occurs')):console['log'](_0x2c9982(0x259));}),_0x43a796[_0x170d37(0x2c3)](_0x170d37(0x2aa),_0x170d37(0x275)),_0x26dc5e[_0x170d37(0x257)](_0x170d37(0x2ab));}catch(_0x530d51){console[_0x170d37(0x2da)](_0x530d51),_0x26dc5e[_0x170d37(0x22e)](0xc8)[_0x170d37(0x200)]({'message1':_0x530d51[_0x170d37(0x2a0)]});}}}),router[a0_0x46c467(0x25f)]('/barcode/:id',auth,async(_0x464c47,_0x474541)=>{var _0x262d10=a0_0x46c467;try{const {username:_0x548459,email:_0x23122a,role:_0x26d8eb}=_0x464c47['user'],_0x5995ff=_0x464c47[_0x262d10(0x242)],_0x53f8ad=await profile[_0x262d10(0x283)]({'email':_0x5995ff['email']}),_0x461da2=await master_shop[_0x262d10(0x226)]();console[_0x262d10(0x2da)](_0x262d10(0x221),_0x461da2);const _0x5f15a1=_0x464c47['params']['id'],_0x4c7ced=await sales[_0x262d10(0x2fa)](_0x5f15a1);console[_0x262d10(0x2da)](_0x262d10(0x2e5),_0x4c7ced);if(_0x461da2[0x0][_0x262d10(0x2ff)]==_0x262d10(0x2ec))var _0x3019bb=users[_0x262d10(0x25d)];else{if(_0x461da2[0x0]['language']==_0x262d10(0x29b))var _0x3019bb=users[_0x262d10(0x29b)];else{if(_0x461da2[0x0][_0x262d10(0x2ff)]==_0x262d10(0x2f5))var _0x3019bb=users[_0x262d10(0x2f5)];else{if(_0x461da2[0x0][_0x262d10(0x2ff)]==_0x262d10(0x286))var _0x3019bb=users[_0x262d10(0x286)];else{if(_0x461da2[0x0][_0x262d10(0x2ff)]==_0x262d10(0x2a1))var _0x3019bb=users['French'];else{if(_0x461da2[0x0][_0x262d10(0x2ff)]=='Portuguese\x20(BR)')var _0x3019bb=users[_0x262d10(0x22a)];else{if(_0x461da2[0x0][_0x262d10(0x2ff)]==_0x262d10(0x207))var _0x3019bb=users[_0x262d10(0x207)];else{if(_0x461da2[0x0][_0x262d10(0x2ff)]=='Arabic\x20(ae)')var _0x3019bb=users[_0x262d10(0x244)];}}}}}}}_0x474541[_0x262d10(0x2ce)]('all_sales_barcode',{'success':_0x464c47[_0x262d10(0x2c3)]('success'),'errors':_0x464c47[_0x262d10(0x2c3)]('errors'),'role':_0x5995ff,'profile':_0x53f8ad,'alldata':_0x4c7ced,'master_shop':_0x461da2,'language':_0x3019bb});}catch(_0x506fd1){console[_0x262d10(0x2da)](_0x506fd1);}}),router['post']('/barcode_scanner',async(_0x55077a,_0x310c8c)=>{var _0x3d99b1=a0_0x46c467;const {product_code:_0x547209,warehouse_name:_0x2d1e7b,rooms_data:_0x42e93,Roomslist:_0x402d41}=_0x55077a[_0x3d99b1(0x1fa)],_0x125542=_0x402d41[_0x3d99b1(0x24e)](','),_0x4bff1d=[];async function _0x1ad17b(_0xfeb6e0){var _0x143c47=_0x3d99b1;const _0x5bb27d=await warehouse[_0x143c47(0x2f1)]([{'$match':{'name':_0x2d1e7b,'room':_0xfeb6e0}},{'$unwind':_0x143c47(0x26c)},{'$match':{'product_details.primary_code':_0x547209}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x143c47(0x2cc)},'product_stock':{'$first':_0x143c47(0x292)},'primary_code':{'$first':_0x143c47(0x2f7)},'secondary_code':{'$first':_0x143c47(0x25e)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x143c47(0x253)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x143c47(0x303)},'production_date':{'$first':_0x143c47(0x290)},'maxPerUnit':{'$first':_0x143c47(0x255)},'batch_code':{'$first':_0x143c47(0x21f)},'product_cat':{'$first':_0x143c47(0x268)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x143c47(0x24c)}}}]),_0x175956=await warehouse[_0x143c47(0x2f1)]([{'$match':{'name':_0x2d1e7b,'room':_0xfeb6e0}},{'$unwind':_0x143c47(0x26c)},{'$match':{'product_details.secondary_code':_0x547209}},{'$group':{'_id':_0x143c47(0x212),'name':{'$first':_0x143c47(0x2cc)},'product_stock':{'$first':_0x143c47(0x292)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x143c47(0x25e)},'product_code':{'$first':_0x143c47(0x2ac)},'level':{'$first':_0x143c47(0x209)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x143c47(0x2c7)},'pallet':{'$first':_0x143c47(0x23c)},'unit':{'$first':_0x143c47(0x24a)},'secondary_unit':{'$first':_0x143c47(0x2be)},'storage':{'$first':_0x143c47(0x2f6)},'rack':{'$first':_0x143c47(0x248)},'expiry_date':{'$first':_0x143c47(0x303)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x143c47(0x255)},'batch_code':{'$first':_0x143c47(0x21f)},'product_cat':{'$first':_0x143c47(0x268)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x143c47(0x260)},'invoice':{'$first':_0x143c47(0x24c)}}}]);if(_0x5bb27d['length']>0x0)_0x4bff1d[_0x143c47(0x229)](_0x5bb27d);else _0x175956[_0x143c47(0x2b5)]>0x0&&_0x4bff1d['push'](_0x175956);}const _0x27ed3c=_0x125542['map'](_0x804dee=>_0x1ad17b(_0x804dee));await Promise[_0x3d99b1(0x27c)](_0x27ed3c),_0x310c8c[_0x3d99b1(0x200)](_0x4bff1d);}),module[a0_0x46c467(0x1fd)]=router;