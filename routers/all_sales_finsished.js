var a0_0x54b10c=a0_0x4f32;function a0_0x542d(){var _0x18b5cd=['staff','save','room_name','$customer','render','secondary_unit_QA','\x20Order\x20Date\x20:\x20','map','Sales\x20Mail','/all_sales/view','params','maxProducts_QA','1922406mGhoKr','$product_details.batch_code','foreach\x20newproduct','<html><head><title></title>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$product_details.storage','findOne','$product_details.unit','secondary_code','flash','$customers_docs','$sale_product.bin','An\x20error\x20occurred\x20while\x20saving\x20data.','\x20<>\x20','Router','product_name','Finished\x20Goods','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','<div>','prod_code','Enclosed','\x20</h2>','\x20Order\x20Number\x20:\x20','getDate','maxPerUnit_QA','exports','/view/add_sales','118152qJNlsg','$warehouse_name','/view','user','15541730KCwtbD','259553RsvBDx','suppliers','</tbody>','Sales\x20Update\x20successfully','string','$product_details.invoice','sales\x20item\x20return\x20successfull','quantity','Email\x20sent\x20successfully','German','/preview/:id','currency','$product_details.secondary_code','117zLOLij','log','$sale_product.floorlevel','customers_docs','maxPerUnit','$room','aggregate','random','/view/add_sales/:id','../middleware/auth','$product_details.maxPerUnit','purchases_data','$product_details.bin','</td>','$product_details.product_cat','/give_payment/:id','QA\x20Warehouse','barcode\x20user_id','1455720TUBmHH','primary_code','prod_cat','gmail','<h5>','An\x20error\x20occurred.','Return\x20Goods','<span\x20style=\x22float:\x20right;\x22>','secondary_unit','$finalize','sales_invoice','/view/:id','</h5>','edit_sales_finished_view','password','</div>','warehouse','/all_sales_finished/view','filter','stock_data','Chinese','nodemailer','final','<tr>','prod_invoice','/view/add_sale/product','$product_details.product_stock','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','../models/all_models','DRY\x20GOODS','body','push','$_id','$product_details.primary_code','$sale_product','toString','RoomAssigned','for_categorize','$note','$date','all','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','return_qty','add_sales_finished','product','room','$invoice','product_name_QA1','site_title','abs','Enabled','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','return_data','English','logo','/barcode_scanner','return_sale_QA','$product_details.rack','role','name','batch_code','received_amount','product_date','sendMail','$sale_product.quantity','return_qty_QA','_id','True','272644QAHpxK','secondary_code_QA','catch','</tr>','add\x20post','due_amount','/view/return_sales/:id','sales_quantity_QA','back','Quality\x20Inspection','Arabic','port','then','/../public','French','$product_details._id','customer','padStart','$product_details.expiry_date','note','amount','length','<strong>\x20Regards\x20</strong>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','errors','</body></html>','Error\x20Occurs','/upload/','Portuguese\x20(BR)','$name','<hr\x20class=\x22my-3\x22>','message','$product_details.production_date','$product_details.product_name','Portuguese','post','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','error','unit','sales_quantity','84MobCpJ','forEach','$product.product_name','max_per_unit','$sale_product.bay','primary_unit','$product_details.maxProducts','split','$product_details.floorlevel','currency_placement','product_code','<!DOCTYPE\x20html>','master','level','host','2aVuGLZ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','../public/language/languages.json','</span>','349156KVZSxJ','find','edit_sales_finished','warehouse_name','success','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','invoice','$sale_product.type','OUTF-','json','unit_QA','sale_product','all_sales_finished','get','slice','floor','barcode\x20Product\x20master','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','date','maxProducts','False','</table>','image','Ambient','status','$product_details.secondary_unit','production_date','finalize','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','language','Logo.png','<table\x20style=\x22width:\x20100%\x20!important;\x22>','product_stock','FGSEmail','adjust_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','Return\x20Rooms','product_code_QA','<h2>\x20','Hindi','findById','stock','$product_details.product_code','getMonth','$product_details','Spanish','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','expiry_date_QA','Arabic\x20(ae)','carton','expiry_date','11ZSBeMi','</head><body>','Sale\x20Return','production_date_QA','bay','sale_qty','Sale\x20Return\x20Mail','$product_details.type','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','concat','all_sales_barcode','$product_details.bay','createTransport','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</thead>','/barcode/:id','English\x20(US)','redirect','product_details','product_list','customers'];a0_0x542d=function(){return _0x18b5cd;};return a0_0x542d();}function a0_0x4f32(_0x3a6ddf,_0xe8a1c8){var _0x542df3=a0_0x542d();return a0_0x4f32=function(_0x4f3262,_0x5b9860){_0x4f3262=_0x4f3262-0x1a8;var _0x29a0dc=_0x542df3[_0x4f3262];return _0x29a0dc;},a0_0x4f32(_0x3a6ddf,_0xe8a1c8);}(function(_0x5c9638,_0xe23977){var _0x4cf2ea=a0_0x4f32,_0x399709=_0x5c9638();while(!![]){try{var _0x109061=parseInt(_0x4cf2ea(0x261))/0x1*(parseInt(_0x4cf2ea(0x229))/0x2)+-parseInt(_0x4cf2ea(0x2bd))/0x3+-parseInt(_0x4cf2ea(0x265))/0x4+-parseInt(_0x4cf2ea(0x1e5))/0x5+-parseInt(_0x4cf2ea(0x252))/0x6*(parseInt(_0x4cf2ea(0x1c6))/0x7)+-parseInt(_0x4cf2ea(0x1c1))/0x8*(-parseInt(_0x4cf2ea(0x1d3))/0x9)+parseInt(_0x4cf2ea(0x1c5))/0xa*(parseInt(_0x4cf2ea(0x29a))/0xb);if(_0x109061===_0xe23977)break;else _0x399709['push'](_0x399709['shift']());}catch(_0x4fc42a){_0x399709['push'](_0x399709['shift']());}}}(a0_0x542d,0x754d9));const express=require('express'),app=express(),router=express[a0_0x54b10c(0x1b4)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x54b10c(0x201)),auth=require(a0_0x54b10c(0x1dc)),nodemailer=require(a0_0x54b10c(0x1fa)),users=require(a0_0x54b10c(0x263));router[a0_0x54b10c(0x273)](a0_0x54b10c(0x1c3),auth,async(_0xd415eb,_0x571f15)=>{var _0x4232d4=a0_0x54b10c;try{const {username:_0x1cf692,email:_0x3b6fc0,role:_0x2fc84c}=_0xd415eb[_0x4232d4(0x1c4)],_0x2f917b=_0xd415eb[_0x4232d4(0x1c4)],_0x4a5d83=await profile[_0x4232d4(0x1ac)]({'email':_0x2f917b[_0x4232d4(0x26a)]}),_0x15d2f0=await master_shop[_0x4232d4(0x266)]();let _0x32c759;if(_0x2f917b[_0x4232d4(0x21f)]==_0x4232d4(0x2b1)){const _0x2d5111=await staff[_0x4232d4(0x1ac)]({'email':_0x2f917b['email']});_0x32c759=await sales_finished[_0x4232d4(0x1d9)]([{'$lookup':{'from':_0x4232d4(0x2b0),'localField':_0x4232d4(0x239),'foreignField':'name','as':_0x4232d4(0x1d6)}},{'$unwind':_0x4232d4(0x1b0)},{'$unwind':_0x4232d4(0x207)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'customers':{'$first':_0x4232d4(0x2b4)},'date':{'$first':_0x4232d4(0x20c)},'warehouse_name':{'$first':_0x4232d4(0x1c2)},'sale_product':{'$push':_0x4232d4(0x207)},'note':{'$first':_0x4232d4(0x20b)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x4232d4(0x1b0)},'total_saleproduct_quantity':{'$sum':_0x4232d4(0x225)},'level':{'$addToSet':_0x4232d4(0x256)},'isle':{'$addToSet':_0x4232d4(0x1b1)},'type':{'$addToSet':_0x4232d4(0x26d)},'pallet':{'$addToSet':_0x4232d4(0x1d5)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x32c759=await sales_finished[_0x4232d4(0x1d9)]([{'$lookup':{'from':'customers','localField':'customer','foreignField':_0x4232d4(0x220),'as':'customers_docs'}},{'$unwind':'$customers_docs'},{'$unwind':_0x4232d4(0x207)},{'$group':{'_id':_0x4232d4(0x205),'invoice':{'$first':_0x4232d4(0x213)},'customers':{'$first':_0x4232d4(0x2b4)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x4232d4(0x1c2)},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x4232d4(0x1b0)},'total_saleproduct_quantity':{'$sum':_0x4232d4(0x225)},'level':{'$addToSet':_0x4232d4(0x256)},'isle':{'$addToSet':_0x4232d4(0x1b1)},'type':{'$addToSet':_0x4232d4(0x26d)},'pallet':{'$addToSet':_0x4232d4(0x1d5)},'finalize':{'$first':_0x4232d4(0x1ee)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x15d2f0[0x0]['language']==_0x4232d4(0x2ac)){var _0x3c5c59=users[_0x4232d4(0x21a)];console[_0x4232d4(0x1d4)](_0x3c5c59);}else{if(_0x15d2f0[0x0]['language']==_0x4232d4(0x28e))var _0x3c5c59=users[_0x4232d4(0x28e)];else{if(_0x15d2f0[0x0][_0x4232d4(0x284)]==_0x4232d4(0x1cf))var _0x3c5c59=users[_0x4232d4(0x1cf)];else{if(_0x15d2f0[0x0][_0x4232d4(0x284)]==_0x4232d4(0x294))var _0x3c5c59=users['Spanish'];else{if(_0x15d2f0[0x0][_0x4232d4(0x284)]==_0x4232d4(0x237))var _0x3c5c59=users[_0x4232d4(0x237)];else{if(_0x15d2f0[0x0][_0x4232d4(0x284)]==_0x4232d4(0x246))var _0x3c5c59=users[_0x4232d4(0x24c)];else{if(_0x15d2f0[0x0]['language']==_0x4232d4(0x1f9))var _0x3c5c59=users[_0x4232d4(0x1f9)];else{if(_0x15d2f0[0x0][_0x4232d4(0x284)]=='Arabic\x20(ae)')var _0x3c5c59=users['Arabic'];}}}}}}}_0x571f15['render'](_0x4232d4(0x272),{'success':_0xd415eb[_0x4232d4(0x1af)](_0x4232d4(0x269)),'errors':_0xd415eb['flash'](_0x4232d4(0x242)),'sales':_0x32c759,'profile':_0x4a5d83,'role':_0x2f917b,'master_shop':_0x15d2f0,'language':_0x3c5c59});}catch(_0x262413){console[_0x4232d4(0x1d4)](_0x262413);}});async function getRandom8DigitNumber(){var _0x2283be=a0_0x54b10c;const _0x9f62c=0x989680,_0x44f0d5=0x5f5e0ff,_0x57a479=Math[_0x2283be(0x275)](Math[_0x2283be(0x1da)]()*(_0x44f0d5-_0x9f62c+0x1))+_0x9f62c;var _0x428fa2;const _0x181a3f=await sales_finished[_0x2283be(0x1ac)]({'invoice':_0x2283be(0x26e)+_0x57a479});return _0x181a3f&&_0x181a3f['length']>0x0?_0x428fa2=_0x2283be(0x26e)+_0x57a479:_0x428fa2=_0x2283be(0x26e)+_0x57a479,_0x428fa2;}router[a0_0x54b10c(0x273)](a0_0x54b10c(0x1c0),auth,async(_0x631284,_0x14eb5b)=>{var _0x556b24=a0_0x54b10c;try{const {username:_0x1729b6,email:_0x551a9d,role:_0x206a15}=_0x631284['user'],_0x91d899=_0x631284['user'],_0xeea21f=await profile['findOne']({'email':_0x91d899[_0x556b24(0x26a)]}),_0x30b614=await master_shop[_0x556b24(0x266)](),_0x385e47=await customer['find']({});let _0x1bed3c;if(_0x91d899[_0x556b24(0x21f)]==_0x556b24(0x2b1)){const _0x1e2ed8=await staff[_0x556b24(0x1ac)]({'email':_0x91d899[_0x556b24(0x26a)]});_0x1bed3c=await warehouse[_0x556b24(0x1d9)]([{'$match':{'status':_0x556b24(0x217),'name':_0x1e2ed8[_0x556b24(0x1f5)],'warehouse_category':_0x556b24(0x1b6),'name':{'$ne':_0x556b24(0x1e3)}}},{'$group':{'_id':'$name','name':{'$first':_0x556b24(0x247)}}},{'$sort':{'name':0x1}}]);}else _0x1bed3c=await warehouse['aggregate']([{'$match':{'status':_0x556b24(0x217),'warehouse_category':_0x556b24(0x1b6),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x556b24(0x247),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x1fc054=await product[_0x556b24(0x266)]({});var _0x2f0d45=[_0x556b24(0x27e),'Enclosed'];const _0x71ef42=await sales_finished[_0x556b24(0x266)]({}),_0x10d9ca=_0x71ef42[_0x556b24(0x23e)]+0x1,_0x576aa2=_0x556b24(0x26e)+_0x10d9ca[_0x556b24(0x208)]()[_0x556b24(0x23a)](0x5,'0');if(_0x30b614[0x0]['language']=='English\x20(US)'){var _0x38cf75=users['English'];console['log'](_0x38cf75);}else{if(_0x30b614[0x0][_0x556b24(0x284)]=='Hindi')var _0x38cf75=users[_0x556b24(0x28e)];else{if(_0x30b614[0x0]['language']==_0x556b24(0x1cf))var _0x38cf75=users[_0x556b24(0x1cf)];else{if(_0x30b614[0x0]['language']==_0x556b24(0x294))var _0x38cf75=users['Spanish'];else{if(_0x30b614[0x0]['language']==_0x556b24(0x237))var _0x38cf75=users[_0x556b24(0x237)];else{if(_0x30b614[0x0][_0x556b24(0x284)]==_0x556b24(0x246))var _0x38cf75=users[_0x556b24(0x24c)];else{if(_0x30b614[0x0]['language']=='Chinese')var _0x38cf75=users[_0x556b24(0x1f9)];else{if(_0x30b614[0x0][_0x556b24(0x284)]=='Arabic\x20(ae)')var _0x38cf75=users['Arabic'];}}}}}}}const _0x493286=getRandom8DigitNumber();_0x493286[_0x556b24(0x235)](_0x3fbaf5=>{var _0x19e06b=_0x556b24;_0x14eb5b[_0x19e06b(0x2b5)](_0x19e06b(0x210),{'success':_0x631284[_0x19e06b(0x1af)]('success'),'errors':_0x631284[_0x19e06b(0x1af)]('errors'),'role':_0x91d899,'profile':_0xeea21f,'customer':_0x385e47,'warehouse':_0x1bed3c,'product':_0x1fc054,'invoice':_0x3fbaf5,'master_shop':_0x30b614,'language':_0x38cf75,'rooms_data':_0x2f0d45});})[_0x556b24(0x22b)](_0x207324=>{var _0x156428=_0x556b24;_0x631284[_0x156428(0x1af)]('errors','There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x14eb5b[_0x156428(0x2ad)](_0x156428(0x1f6));});}catch(_0x3a13e3){console[_0x556b24(0x1d4)](_0x3a13e3);}}),router['get'](a0_0x54b10c(0x1db),auth,async(_0x453471,_0x24ad38)=>{var _0x10e658=a0_0x54b10c;try{const _0x3159e9=_0x453471[_0x10e658(0x2bb)]['id'];console[_0x10e658(0x1d4)](_0x3159e9);const _0x1f912e=await product['find'](),_0x29007b=await purchases[_0x10e658(0x1d9)]([{'$match':{'warehouse_name':_0x3159e9}},{'$unwind':'$product'},{'$group':{'_id':_0x10e658(0x254)}}]);console[_0x10e658(0x1d4)](_0x10e658(0x1de),_0x29007b),_0x24ad38['status'](0xc8)[_0x10e658(0x26f)]({'purchases_data':_0x29007b,'product_data':_0x1f912e});}catch(_0x354999){console[_0x10e658(0x1d4)](_0x354999);}}),router[a0_0x54b10c(0x24d)](a0_0x54b10c(0x1fe),auth,async(_0x5abc03,_0x2f1c8c)=>{var _0x7dda1b=a0_0x54b10c;try{const {warehouse_data:_0x5919bd,product_data:_0x4abc94}=_0x5abc03[_0x7dda1b(0x203)];console['log'](_0x5abc03[_0x7dda1b(0x203)]['product_data']);;const _0x2e8f66=await master_shop[_0x7dda1b(0x266)]();console[_0x7dda1b(0x1d4)](_0x7dda1b(0x25e),_0x2e8f66);const _0x4e9ea0=await product[_0x7dda1b(0x1ac)]({'name':_0x4abc94});console[_0x7dda1b(0x1d4)](_0x7dda1b(0x211),_0x4e9ea0);const _0xaecf97=await warehouse['aggregate']([{'$match':{'name':_0x5919bd}},{'$unwind':_0x7dda1b(0x293)},{'$match':{'product_details.product_name':_0x4abc94}},{'$group':{'_id':_0x7dda1b(0x24b),'product_stock':{'$first':_0x7dda1b(0x1ff)}}}]);console[_0x7dda1b(0x1d4)](_0x7dda1b(0x1f8),_0xaecf97),_0x2f1c8c['status'](0xc8)[_0x7dda1b(0x26f)]({'master':_0x2e8f66,'new_product':_0x4e9ea0,'stock_data':_0xaecf97});}catch(_0x28ab5c){console[_0x7dda1b(0x1d4)](_0x28ab5c);}}),router[a0_0x54b10c(0x24d)]('/view/add_sales',auth,async(_0x2d9959,_0xa02d36)=>{var _0x50121e=a0_0x54b10c;try{const {invoice:_0x4b156c,date:_0xcbcc3f,warehouse_name:_0x1af736,product_name:_0x7a6acb,stock:_0x4a623d,quantity:_0x81d2fc,note:_0x53bacc,room:_0x59008e,primary_code:_0x45ab29,secondary_code:_0x13fcbd,prod_code:_0x4e4f39,level:_0x58d9e1,isle:_0x175c89,pallet:_0x2e669d,batch_code:_0x35d7af,SCRN:_0x581922,expiry_date:_0x22346c,mode_transpo:_0x55c1f4,name_driver:_0x3bf0a9}=_0x2d9959['body'];if(typeof _0x7a6acb=='string')var _0x425aa2=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x1b5)]],_0x32a6bf=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x290)]],_0x1a07bd=[_0x2d9959['body'][_0x50121e(0x298)]],_0x593873=[_0x2d9959[_0x50121e(0x203)]['primary_code']],_0x3973b4=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x1ae)]],_0x2c4d1c=[_0x2d9959['body']['prod_code']],_0x4f6cee=[_0x2d9959['body'][_0x50121e(0x25f)]],_0x63a5af=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x257)]],_0x374334=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x1ed)]],_0x3b83a8=[_0x2d9959['body'][_0x50121e(0x221)]],_0x277d51=[_0x2d9959['body'][_0x50121e(0x299)]],_0x3ca50c=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x223)]],_0x5484bd=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x255)]],_0x1fafd4=[_0x2d9959[_0x50121e(0x203)]['prod_cat']],_0x691555=[_0x2d9959[_0x50121e(0x203)][_0x50121e(0x209)]],_0x264ac8=[_0x2d9959['body'][_0x50121e(0x1fd)]];else var _0x425aa2=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x1b5)]],_0x32a6bf=[..._0x2d9959['body']['stock']],_0x1a07bd=[..._0x2d9959[_0x50121e(0x203)]['carton']],_0x593873=[..._0x2d9959['body'][_0x50121e(0x1e6)]],_0x3973b4=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x1ae)]],_0x2c4d1c=[..._0x2d9959['body'][_0x50121e(0x1b9)]],_0x4f6cee=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x25f)]],_0x63a5af=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x257)]],_0x374334=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x1ed)]],_0x3b83a8=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x221)]],_0x277d51=[..._0x2d9959[_0x50121e(0x203)]['expiry_date']],_0x3ca50c=[..._0x2d9959['body'][_0x50121e(0x223)]],_0x5484bd=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x255)]],_0x1fafd4=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x1e7)]],_0x691555=[..._0x2d9959['body'][_0x50121e(0x209)]],_0x264ac8=[..._0x2d9959[_0x50121e(0x203)][_0x50121e(0x1fd)]];const _0x28f015=_0x425aa2[_0x50121e(0x2b8)](_0x4ae512=>{return _0x4ae512={'product_name':_0x4ae512};});_0x32a6bf['forEach']((_0x234b23,_0x30943a)=>{var _0x33a16d=_0x50121e;_0x28f015[_0x30943a][_0x33a16d(0x290)]=_0x234b23;}),_0x1a07bd[_0x50121e(0x253)]((_0x2230b8,_0x474971)=>{var _0x32b76a=_0x50121e;_0x28f015[_0x474971]['quantity']=Math[_0x32b76a(0x216)](_0x2230b8);}),_0x593873[_0x50121e(0x253)]((_0x285442,_0x3ca42d)=>{var _0x526e71=_0x50121e;_0x28f015[_0x3ca42d][_0x526e71(0x1e6)]=_0x285442;}),_0x3973b4[_0x50121e(0x253)]((_0x253d66,_0x269775)=>{var _0x32df58=_0x50121e;_0x28f015[_0x269775][_0x32df58(0x1ae)]=_0x253d66;}),_0x2c4d1c[_0x50121e(0x253)]((_0x1c3c67,_0x18e252)=>{var _0x49bc01=_0x50121e;_0x28f015[_0x18e252][_0x49bc01(0x25c)]=_0x1c3c67;}),_0x4f6cee[_0x50121e(0x253)]((_0x3cfb84,_0x437677)=>{var _0x422ee1=_0x50121e;_0x28f015[_0x437677][_0x422ee1(0x29e)]=_0x3cfb84;}),_0x63a5af[_0x50121e(0x253)]((_0x499821,_0x4924bf)=>{_0x28f015[_0x4924bf]['unit']=_0x499821;}),_0x374334['forEach']((_0x16f707,_0x3849e8)=>{var _0x568f26=_0x50121e;_0x28f015[_0x3849e8][_0x568f26(0x1ed)]=_0x16f707;}),_0x3b83a8['forEach']((_0x6c106c,_0x166d21)=>{_0x28f015[_0x166d21]['batch_code']=_0x6c106c;}),_0x277d51['forEach']((_0x356385,_0x3ac3d7)=>{var _0x5140e0=_0x50121e;_0x28f015[_0x3ac3d7][_0x5140e0(0x299)]=_0x356385;}),_0x3ca50c[_0x50121e(0x253)]((_0x8adb6c,_0xfe6720)=>{var _0x2074bf=_0x50121e;_0x28f015[_0xfe6720][_0x2074bf(0x281)]=_0x8adb6c;}),_0x5484bd[_0x50121e(0x253)]((_0x3b0765,_0x417cd9)=>{_0x28f015[_0x417cd9]['maxperunit']=_0x3b0765;}),_0x1fafd4[_0x50121e(0x253)]((_0x4bbe82,_0x64d46a)=>{_0x28f015[_0x64d46a]['prod_cat']=_0x4bbe82;}),_0x691555[_0x50121e(0x253)]((_0x46e535,_0x21ac9b)=>{var _0x2de246=_0x50121e;_0x28f015[_0x21ac9b][_0x2de246(0x2b3)]=_0x46e535;}),_0x264ac8[_0x50121e(0x253)]((_0x338ad5,_0x2a931e)=>{var _0x11143b=_0x50121e;_0x28f015[_0x2a931e][_0x11143b(0x26c)]=_0x338ad5;});var _0x5317f3=0x0;_0x28f015[_0x50121e(0x253)](_0x348840=>{var _0x353048=_0x50121e;parseFloat(_0x348840[_0x353048(0x290)])<parseFloat(_0x348840[_0x353048(0x1cd)])&&parseFloat(_0x348840[_0x353048(0x1cd)])>parseFloat(_0x348840[_0x353048(0x290)])&&(console[_0x353048(0x1d4)](_0x348840['stock']+_0x353048(0x1b3)+_0x348840[_0x353048(0x1cd)]),_0x5317f3++);});if(_0x5317f3!=0x0)return _0x2d9959[_0x50121e(0x1af)](_0x50121e(0x242),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0xa02d36[_0x50121e(0x2ad)](_0x50121e(0x231));const _0x521cad=_0x28f015[_0x50121e(0x1f7)](_0x4be746=>_0x4be746[_0x50121e(0x1cd)]!=='0'&&_0x4be746[_0x50121e(0x1cd)]!==''),_0x4bb243=new sales_finished({'invoice':_0x4b156c,'customer':_0x2d9959['body'][_0x50121e(0x239)],'date':_0xcbcc3f,'warehouse_name':_0x1af736,'sale_product':_0x521cad,'note':_0x53bacc,'room':_0x59008e,'primary_code':_0x45ab29,'secondary_code':_0x13fcbd,'prod_code':_0x4e4f39,'SCRN':_0x581922,'finalize':_0x50121e(0x27b),'mode_transpo':_0x55c1f4,'name_driver':_0x3bf0a9}),_0x530b67=await _0x4bb243[_0x50121e(0x2b2)](),_0x49ee5f=await sales_finished[_0x50121e(0x1ac)]({'invoice':_0x4b156c}),_0x484fe3=new c_payment_data({'invoice':_0x4b156c,'customer':_0x2d9959['body'][_0x50121e(0x239)],'reason':'Sale'});await _0x484fe3[_0x50121e(0x2b2)]();const _0xbeb646=await master_shop['find'](),_0x37c4fe=await email_settings[_0x50121e(0x1ac)](),_0x13973e=await customer[_0x50121e(0x1ac)]({'name':_0x2d9959[_0x50121e(0x203)][_0x50121e(0x239)]});_0xbeb646[0x0]['currency_placement']==0x1?(right_currency=_0xbeb646[0x0][_0x50121e(0x1d1)],left_currency=''):(right_currency='',left_currency=_0xbeb646[0x0][_0x50121e(0x1d1)]);var _0x141e11=_0x425aa2,_0x3c8843=_0x1a07bd,_0x1058f6='',_0x252f0a;for(_0x252f0a in _0x141e11){_0x1058f6+=_0x50121e(0x1fc)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x141e11[_0x252f0a]+_0x50121e(0x1e0)+_0x50121e(0x200)+_0x3c8843[_0x252f0a]+_0x50121e(0x1e0)+_0x50121e(0x22c);}console[_0x50121e(0x1d4)](_0x50121e(0x2af),_0x1058f6);let _0x255297=nodemailer[_0x50121e(0x2a8)]({'service':_0x50121e(0x1e8),'auth':{'user':_0x37c4fe['email'],'pass':_0x37c4fe[_0x50121e(0x1f3)]}}),_0x38e2bb={'from':_0x37c4fe[_0x50121e(0x26a)],'to':_0x13973e['email'],'subject':'Sale\x20Product\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+_0x50121e(0x236)+_0x50121e(0x245)+_0xbeb646[0x0]['image'],'cid':'logo'}],'html':_0x50121e(0x25d)+_0x50121e(0x1a9)+'</head><body>'+_0x50121e(0x1b8)+_0x50121e(0x2a2)+_0x50121e(0x1b8)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+'<div>'+_0x50121e(0x28d)+_0xbeb646[0x0][_0x50121e(0x215)]+_0x50121e(0x1bb)+'</div>'+_0x50121e(0x1f4)+'<hr\x20class=\x22my-3\x22>'+_0x50121e(0x1b8)+_0x50121e(0x2a3)+_0x50121e(0x1bc)+_0x4b156c+'\x20'+_0x50121e(0x1ec)+_0x50121e(0x2b7)+_0xcbcc3f+'\x20'+_0x50121e(0x264)+_0x50121e(0x1f1)+_0x50121e(0x1f4)+_0x50121e(0x286)+_0x50121e(0x2a9)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>'+_0x50121e(0x22c)+_0x50121e(0x2aa)+_0x50121e(0x277)+'\x20'+_0x1058f6+'\x20'+_0x50121e(0x1c8)+_0x50121e(0x27c)+_0x50121e(0x1b8)+_0x50121e(0x23f)+_0x50121e(0x1e9)+_0xbeb646[0x0]['site_title']+'</h5>'+_0x50121e(0x1f4)+'</div>'+_0x50121e(0x243)};_0x255297[_0x50121e(0x224)](_0x38e2bb,function(_0x4a68fb,_0x546e0d){var _0xc893a9=_0x50121e;_0x4a68fb?(console['log'](_0x4a68fb),console[_0xc893a9(0x1d4)](_0xc893a9(0x244))):console[_0xc893a9(0x1d4)](_0xc893a9(0x1ce));}),_0x2d9959['flash'](_0x50121e(0x269),'Sales\x20Add\x20successfully'),_0xa02d36[_0x50121e(0x2ad)]('/all_sales_finished/preview/'+_0x530b67[_0x50121e(0x227)]);}catch(_0x119a57){console['log'](_0x119a57);}}),router['get'](a0_0x54b10c(0x1d0),auth,async(_0x59af7e,_0x4bef8b)=>{var _0x372127=a0_0x54b10c;try{const {username:_0xa9588f,email:_0x151ea8,role:_0x4bef39}=_0x59af7e['user'],_0x44b1f5=_0x59af7e[_0x372127(0x1c4)],_0x169ade=await profile[_0x372127(0x1ac)]({'email':_0x44b1f5[_0x372127(0x26a)]}),_0x240122=await master_shop['find'](),_0x4b6dfa=_0x59af7e['params']['id'],_0x422c68=await sales_finished[_0x372127(0x28f)](_0x4b6dfa),_0x29b643=await warehouse[_0x372127(0x1d9)]([{'$match':{'name':_0x422c68['warehouse_name']}},{'$unwind':_0x372127(0x293)},{'$group':{'_id':_0x372127(0x238),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x372127(0x2a7)},'bin':{'$first':_0x372127(0x1df)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x372127(0x25a)},'primary_code':{'$first':_0x372127(0x206)},'secondary_code':{'$first':_0x372127(0x1d2)},'product_code':{'$first':_0x372127(0x291)},'storage':{'$first':_0x372127(0x1ab)},'rack':{'$first':_0x372127(0x21e)},'expiry_date':{'$first':_0x372127(0x23b)},'production_date':{'$first':_0x372127(0x24a)},'batch_code':{'$first':'$product_details.batch_code'},'room':{'$first':_0x372127(0x1d8)}}}]),_0x2d7efe=await customer[_0x372127(0x266)]({});let _0x5ad904;if(_0x44b1f5[_0x372127(0x21f)]==_0x372127(0x2b1)){const _0x4d1539=await staff['findOne']({'email':_0x44b1f5[_0x372127(0x26a)]});_0x5ad904=await warehouse[_0x372127(0x1d9)]([{'$match':{'status':_0x372127(0x217),'name':_0x4d1539[_0x372127(0x1f5)]}},{'$group':{'_id':_0x372127(0x247),'name':{'$first':_0x372127(0x247)}}}]);}else _0x5ad904=await warehouse[_0x372127(0x1d9)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x372127(0x247)}}}]);const _0x531463=await product[_0x372127(0x266)]({});if(_0x240122[0x0][_0x372127(0x284)]==_0x372127(0x2ac)){var _0x48532d=users[_0x372127(0x21a)];console[_0x372127(0x1d4)](_0x48532d);}else{if(_0x240122[0x0]['language']==_0x372127(0x28e))var _0x48532d=users[_0x372127(0x28e)];else{if(_0x240122[0x0]['language']==_0x372127(0x1cf))var _0x48532d=users[_0x372127(0x1cf)];else{if(_0x240122[0x0][_0x372127(0x284)]=='Spanish')var _0x48532d=users[_0x372127(0x294)];else{if(_0x240122[0x0][_0x372127(0x284)]==_0x372127(0x237))var _0x48532d=users['French'];else{if(_0x240122[0x0][_0x372127(0x284)]==_0x372127(0x246))var _0x48532d=users[_0x372127(0x24c)];else{if(_0x240122[0x0][_0x372127(0x284)]==_0x372127(0x1f9))var _0x48532d=users['Chinese'];else{if(_0x240122[0x0][_0x372127(0x284)]==_0x372127(0x297))var _0x48532d=users['Arabic'];}}}}}}}_0x4bef8b[_0x372127(0x2b5)](_0x372127(0x1f2),{'success':_0x59af7e[_0x372127(0x1af)](_0x372127(0x269)),'errors':_0x59af7e[_0x372127(0x1af)]('errors'),'role':_0x44b1f5,'profile':_0x169ade,'customer':_0x2d7efe,'warehouse':_0x5ad904,'product':_0x29b643,'user':_0x422c68,'master_shop':_0x240122,'unit':_0x531463,'language':_0x48532d});}catch(_0x22c4e3){console[_0x372127(0x1d4)](_0x22c4e3);}}),router[a0_0x54b10c(0x24d)]('/preview/:id',auth,async(_0x2dfc8d,_0x5181bc)=>{var _0x29f966=a0_0x54b10c;try{const _0x3d01a9=_0x2dfc8d['params']['id'],{invoice:_0x9aee41,warehouse_name:_0x371949,room:_0x3a339d}=_0x2dfc8d[_0x29f966(0x203)],_0x4f55ee=await sales_finished['findOne']({'invoice':_0x9aee41}),_0x4a1f8e=_0x4f55ee[_0x29f966(0x271)][_0x29f966(0x2b8)](async _0x52b999=>{var _0x42f706=_0x29f966,_0x23f1c3=await warehouse[_0x42f706(0x1ac)]({'name':_0x371949,'room':_0x52b999[_0x42f706(0x2b3)],'warehouse_category':_0x42f706(0x1b6)});const _0x447881=_0x23f1c3[_0x42f706(0x2ae)][_0x42f706(0x2b8)](_0x4b196a=>{var _0x102ff5=_0x42f706;_0x4b196a[_0x102ff5(0x1b5)]==_0x52b999[_0x102ff5(0x1b5)]&&_0x4b196a[_0x102ff5(0x29e)]==_0x52b999['bay']&&_0x4b196a[_0x102ff5(0x299)]==_0x52b999['expiry_date']&&_0x4b196a[_0x102ff5(0x281)]==_0x52b999[_0x102ff5(0x281)]&&_0x4b196a[_0x102ff5(0x221)]==_0x52b999[_0x102ff5(0x221)]&&_0x4b196a[_0x102ff5(0x26c)]==_0x52b999[_0x102ff5(0x26c)]&&(_0x4b196a['product_stock']=Math[_0x102ff5(0x216)](_0x4b196a[_0x102ff5(0x287)])-Math['abs'](_0x52b999[_0x102ff5(0x1cd)]));});return _0x23f1c3;});Promise[_0x29f966(0x20d)](_0x4a1f8e)[_0x29f966(0x235)](async _0x121e1a=>{var _0x4f9b80=_0x29f966;try{for(const _0x5285d3 of _0x121e1a){await _0x5285d3[_0x4f9b80(0x2b2)]();}_0x4f55ee[_0x4f9b80(0x282)]=_0x4f9b80(0x228);const _0x3dd77f=await _0x4f55ee[_0x4f9b80(0x2b2)](),_0x58a829=await master_shop[_0x4f9b80(0x266)](),_0xfe6887=await email_settings[_0x4f9b80(0x1ac)](),_0xc59bc1=await supervisor_settings[_0x4f9b80(0x266)]();var _0x177631=_0x4f55ee[_0x4f9b80(0x271)],_0x1d5568='',_0x26ad47;for(_0x26ad47 in _0x177631){var _0x44c8f0='FG';_0x4f55ee[_0x4f9b80(0x268)]==_0x4f9b80(0x202)&&(_0x44c8f0='DG'),_0x1d5568+=_0x4f9b80(0x1fc)+_0x4f9b80(0x200)+_0x177631[_0x26ad47][_0x4f9b80(0x1b5)]+_0x4f9b80(0x1e0)+_0x4f9b80(0x200)+_0x177631[_0x26ad47]['product_code']+_0x4f9b80(0x1e0)+_0x4f9b80(0x200)+_0x177631[_0x26ad47][_0x4f9b80(0x1cd)]+_0x4f9b80(0x1e0)+_0x4f9b80(0x200)+_0x177631[_0x26ad47][_0x4f9b80(0x250)]+_0x4f9b80(0x1e0)+_0x4f9b80(0x200)+_0x177631[_0x26ad47][_0x4f9b80(0x1ed)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4f55ee['warehouse_name']+_0x4f9b80(0x1e0)+_0x4f9b80(0x200)+_0x177631[_0x26ad47][_0x4f9b80(0x2b3)]+_0x4f9b80(0x1e0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x44c8f0+_0x177631[_0x26ad47]['bay']+_0x4f9b80(0x1e0);}let _0x335a50=nodemailer[_0x4f9b80(0x2a8)]({'host':_0xfe6887[_0x4f9b80(0x260)],'port':Number(_0xfe6887[_0x4f9b80(0x234)]),'secure':![],'auth':{'user':_0xfe6887[_0x4f9b80(0x26a)],'pass':_0xfe6887[_0x4f9b80(0x1f3)]}}),_0x45cffc={'from':_0xfe6887[_0x4f9b80(0x26a)],'to':_0xc59bc1[0x0][_0x4f9b80(0x288)],'subject':_0x4f9b80(0x2b9),'attachments':[{'filename':_0x4f9b80(0x285),'path':__dirname+'/../public'+'/upload/'+_0x58a829[0x0][_0x4f9b80(0x27d)],'cid':_0x4f9b80(0x21b)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x4f9b80(0x29b)+_0x4f9b80(0x1b8)+_0x4f9b80(0x2a2)+_0x4f9b80(0x1b8)+_0x4f9b80(0x240)+'</div>'+_0x4f9b80(0x1b8)+_0x4f9b80(0x28d)+_0x58a829[0x0][_0x4f9b80(0x215)]+'\x20</h2>'+'</div>'+_0x4f9b80(0x1f4)+_0x4f9b80(0x248)+_0x4f9b80(0x1b8)+_0x4f9b80(0x2a3)+_0x4f9b80(0x1bc)+_0x4f55ee[_0x4f9b80(0x26c)]+'\x20'+_0x4f9b80(0x1ec)+_0x4f9b80(0x2b7)+_0x4f55ee['date']+'\x20'+_0x4f9b80(0x264)+_0x4f9b80(0x1f1)+'</div>'+_0x4f9b80(0x286)+_0x4f9b80(0x2a9)+_0x4f9b80(0x1fc)+_0x4f9b80(0x295)+_0x4f9b80(0x26b)+_0x4f9b80(0x283)+_0x4f9b80(0x24e)+_0x4f9b80(0x2a4)+_0x4f9b80(0x262)+_0x4f9b80(0x278)+_0x4f9b80(0x20e)+_0x4f9b80(0x22c)+_0x4f9b80(0x2aa)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1d5568+'\x20'+'</tbody>'+_0x4f9b80(0x27c)+_0x4f9b80(0x1b8)+_0x4f9b80(0x23f)+_0x4f9b80(0x1e9)+_0x58a829[0x0][_0x4f9b80(0x215)]+_0x4f9b80(0x1f1)+_0x4f9b80(0x1f4)+'</div>'+_0x4f9b80(0x243)};_0x335a50[_0x4f9b80(0x224)](_0x45cffc,function(_0x5e51e7,_0x551562){var _0x9408f=_0x4f9b80;_0x5e51e7?(console['log'](_0x5e51e7),console['log']('Error\x20Occurs')):console[_0x9408f(0x1d4)]('Email\x20sent\x20successfully');}),_0x2dfc8d[_0x4f9b80(0x1af)](_0x4f9b80(0x269),_0x4f9b80(0x1c9)),_0x5181bc[_0x4f9b80(0x2ad)]('/picking_list/pdf/'+_0x3d01a9);}catch(_0x5213b0){console[_0x4f9b80(0x24f)](_0x5213b0),_0x5181bc[_0x4f9b80(0x27f)](0x1f4)['json']({'error':_0x4f9b80(0x1b2)});}})[_0x29f966(0x22b)](_0x35c904=>{var _0x4552be=_0x29f966;console[_0x4552be(0x24f)](_0x35c904),_0x5181bc[_0x4552be(0x27f)](0x1f4)[_0x4552be(0x26f)]({'error':_0x4552be(0x1ea)});});}catch(_0x5c5388){console['log'](_0x5c5388);}}),router['get'](a0_0x54b10c(0x1f0),auth,async(_0x1b6010,_0x1948fb)=>{var _0x478764=a0_0x54b10c;try{const {username:_0x198284,email:_0x2e7148,role:_0x490880}=_0x1b6010[_0x478764(0x1c4)],_0x54363c=_0x1b6010[_0x478764(0x1c4)],_0xe741bd=await profile[_0x478764(0x1ac)]({'email':_0x54363c[_0x478764(0x26a)]}),_0x233160=await master_shop[_0x478764(0x266)](),_0x378322=_0x1b6010['params']['id'],_0x3a96e4=await sales_finished[_0x478764(0x28f)](_0x378322);let _0x5d5e8e=new Date(_0x3a96e4[_0x478764(0x299)]),_0x4e0b3e=('0'+_0x5d5e8e[_0x478764(0x1bd)]())['slice'](-0x2),_0x37adf5=('0'+(_0x5d5e8e[_0x478764(0x292)]()+0x1))[_0x478764(0x274)](-0x2),_0x2f4f2c=_0x5d5e8e['getFullYear'](),_0x37c99b=_0x2f4f2c+'-'+_0x37adf5+'-'+_0x4e0b3e;var _0x180e44=[_0x478764(0x27e),_0x478764(0x1ba)];const _0x5041ef=await warehouse[_0x478764(0x1d9)]([{'$match':{'name':_0x3a96e4[_0x478764(0x268)],'room':_0x3a96e4[_0x478764(0x212)]}},{'$unwind':_0x478764(0x293)},{'$group':{'_id':_0x478764(0x238),'name':{'$first':_0x478764(0x24b)},'product_stock':{'$first':_0x478764(0x1ff)},'bay':{'$first':_0x478764(0x2a7)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x478764(0x2a1)},'floorlevel':{'$first':_0x478764(0x25a)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x478764(0x291)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x478764(0x21e)}}}]),_0x5a1219=await customer[_0x478764(0x266)]({});let _0x4c409a;if(_0x54363c[_0x478764(0x21f)]==_0x478764(0x2b1)){const _0x5c087c=await staff['findOne']({'email':_0x54363c[_0x478764(0x26a)]});_0x4c409a=await warehouse[_0x478764(0x1d9)]([{'$match':{'status':'Enabled','name':_0x5c087c[_0x478764(0x1f5)]}},{'$group':{'_id':_0x478764(0x247),'name':{'$first':_0x478764(0x247)}}}]);}else _0x4c409a=await warehouse[_0x478764(0x1d9)]([{'$match':{'status':_0x478764(0x217)}},{'$group':{'_id':'$name','name':{'$first':_0x478764(0x247)}}}]);const _0x39eedd=await product[_0x478764(0x266)]({});if(_0x233160[0x0][_0x478764(0x284)]==_0x478764(0x2ac)){var _0x696c47=users['English'];console['log'](_0x696c47);}else{if(_0x233160[0x0][_0x478764(0x284)]=='Hindi')var _0x696c47=users['Hindi'];else{if(_0x233160[0x0][_0x478764(0x284)]=='German')var _0x696c47=users[_0x478764(0x1cf)];else{if(_0x233160[0x0][_0x478764(0x284)]==_0x478764(0x294))var _0x696c47=users[_0x478764(0x294)];else{if(_0x233160[0x0][_0x478764(0x284)]==_0x478764(0x237))var _0x696c47=users[_0x478764(0x237)];else{if(_0x233160[0x0][_0x478764(0x284)]==_0x478764(0x246))var _0x696c47=users[_0x478764(0x24c)];else{if(_0x233160[0x0][_0x478764(0x284)]==_0x478764(0x1f9))var _0x696c47=users[_0x478764(0x1f9)];else{if(_0x233160[0x0][_0x478764(0x284)]==_0x478764(0x297))var _0x696c47=users[_0x478764(0x233)];}}}}}}}_0x1948fb[_0x478764(0x2b5)](_0x478764(0x267),{'success':_0x1b6010[_0x478764(0x1af)]('success'),'errors':_0x1b6010[_0x478764(0x1af)](_0x478764(0x242)),'role':_0x54363c,'profile':_0xe741bd,'customer':_0x5a1219,'warehouse':_0x4c409a,'product':_0x5041ef,'user':_0x3a96e4,'master_shop':_0x233160,'unit':_0x39eedd,'language':_0x696c47,'rooms_data':_0x180e44,'ed_fullDate':_0x37c99b});}catch(_0x3a1dcf){console['log'](_0x3a1dcf);}}),router['post'](a0_0x54b10c(0x1f0),auth,async(_0x439175,_0x1e6ab8)=>{var _0x448e66=a0_0x54b10c;try{const _0x13a4f1=_0x439175[_0x448e66(0x2bb)]['id'],_0x2468be=await sales_finished['findOne']({'_id':_0x439175['params']['id']}),_0x4806d2=await warehouse[_0x448e66(0x1ac)]({'name':_0x2468be[_0x448e66(0x268)],'room':_0x439175[_0x448e66(0x203)][_0x448e66(0x212)],'warehouse_category':_0x448e66(0x1b6)}),{invoice:_0x18a121,customer:_0x434f69,date:_0x17702e,warehouse_name:_0xe9792c,product_name:_0x394098,stock:_0x39acb2,adjust_qty:_0xc7e6c5,note:_0x265a08,room:_0x481e0e,primary_code:_0x38f09b,secondary_code:_0x280c44,prod_code:_0x1bfa8f,level:_0x77a5a5,isle:_0x354f91,pallet:_0x2d61f5,expiry_date:_0xa16750}=_0x439175[_0x448e66(0x203)];if(typeof _0x394098=='string')var _0x192784=[_0x439175[_0x448e66(0x203)][_0x448e66(0x1b5)]],_0x2963bd=[_0x439175[_0x448e66(0x203)]['stock']],_0x461cd7=[_0x439175[_0x448e66(0x203)][_0x448e66(0x289)]],_0xa9c534=[_0x439175[_0x448e66(0x203)]['primary_code']],_0x1edf2d=[_0x439175[_0x448e66(0x203)][_0x448e66(0x1ae)]],_0x8eea99=[_0x439175[_0x448e66(0x203)]['prod_code']],_0x162a26=[_0x439175[_0x448e66(0x203)][_0x448e66(0x25f)]],_0x3e7ddd=[_0x439175[_0x448e66(0x203)][_0x448e66(0x299)]];else var _0x192784=[..._0x439175[_0x448e66(0x203)][_0x448e66(0x1b5)]],_0x2963bd=[..._0x439175[_0x448e66(0x203)][_0x448e66(0x290)]],_0x461cd7=[..._0x439175['body'][_0x448e66(0x289)]],_0xa9c534=[..._0x439175[_0x448e66(0x203)][_0x448e66(0x1e6)]],_0x1edf2d=[..._0x439175[_0x448e66(0x203)][_0x448e66(0x1ae)]],_0x8eea99=[..._0x439175[_0x448e66(0x203)][_0x448e66(0x1b9)]],_0x162a26=[..._0x439175[_0x448e66(0x203)][_0x448e66(0x25f)]],_0x3e7ddd=[..._0x439175[_0x448e66(0x203)][_0x448e66(0x299)]];const _0x4ede28=_0x192784[_0x448e66(0x2b8)](_0x4a627d=>{return _0x4a627d={'product_name':_0x4a627d};});_0x2963bd[_0x448e66(0x253)]((_0x1ee61c,_0x598b05)=>{var _0x14fc27=_0x448e66;_0x4ede28[_0x598b05][_0x14fc27(0x290)]=_0x1ee61c;}),_0x461cd7[_0x448e66(0x253)]((_0xdfd3e8,_0x4a7640)=>{var _0x5185a6=_0x448e66;_0x4ede28[_0x4a7640][_0x5185a6(0x1cd)]=_0xdfd3e8;}),_0xa9c534[_0x448e66(0x253)]((_0x5f5dc4,_0x5496b4)=>{_0x4ede28[_0x5496b4]['primary_code']=_0x5f5dc4;}),_0x1edf2d['forEach']((_0x54f763,_0x6fbf1e)=>{var _0x35aeba=_0x448e66;_0x4ede28[_0x6fbf1e][_0x35aeba(0x1ae)]=_0x54f763;}),_0x8eea99['forEach']((_0x2a15a3,_0x360c38)=>{_0x4ede28[_0x360c38]['product_code']=_0x2a15a3;}),_0x162a26['forEach']((_0x2f41ca,_0x14848c)=>{var _0x2f8491=_0x448e66;_0x4ede28[_0x14848c][_0x2f8491(0x25f)]=_0x2f41ca;}),_0x3e7ddd[_0x448e66(0x253)]((_0x2124ce,_0x301dfc)=>{var _0x3be0da=_0x448e66;_0x4ede28[_0x301dfc][_0x3be0da(0x299)]=_0x2124ce;});var _0xb81155=0x0;_0x4ede28['forEach'](_0x1f77f2=>{var _0x3448b0=_0x448e66;console[_0x3448b0(0x1d4)](_0x3448b0(0x1a8),_0x1f77f2),(parseInt(_0x1f77f2[_0x3448b0(0x290)])<parseInt(_0x1f77f2['quantity'])||parseInt(_0x1f77f2[_0x3448b0(0x1cd)])==0x0)&&_0xb81155++;});if(_0xb81155!=0x0)return _0x439175[_0x448e66(0x1af)](_0x448e66(0x242),_0x448e66(0x1b7)),_0x1e6ab8[_0x448e66(0x2ad)](_0x448e66(0x231));_0x2468be[_0x448e66(0x271)]['forEach'](_0x25f31d=>{var _0xc0a5ca=_0x448e66;const _0x5de8dc=_0x4806d2['product_details'][_0xc0a5ca(0x2b8)](_0x2a00e4=>{var _0x39c7f2=_0xc0a5ca;_0x2a00e4[_0x39c7f2(0x1b5)]==_0x25f31d['product_name']&&_0x2a00e4[_0x39c7f2(0x29e)]==_0x25f31d[_0x39c7f2(0x29e)]&&(_0x2a00e4[_0x39c7f2(0x287)]=parseInt(_0x2a00e4[_0x39c7f2(0x287)])+parseInt(_0x25f31d['quantity']));});}),await _0x4806d2[_0x448e66(0x2b2)]();const _0x4c2ab9=_0x4ede28[_0x448e66(0x1f7)](_0x88428e=>_0x88428e['quantity']!=='0'&&_0x88428e[_0x448e66(0x1cd)]!=='');_0x2468be['invoice']=_0x18a121,_0x2468be[_0x448e66(0x239)]=_0x434f69,_0x2468be[_0x448e66(0x279)]=_0x17702e,_0x2468be[_0x448e66(0x268)]=_0xe9792c,_0x2468be[_0x448e66(0x271)]=_0x4c2ab9,_0x2468be[_0x448e66(0x23c)]=_0x265a08,_0x2468be[_0x448e66(0x212)]=_0x481e0e;const _0xc734a3=await _0x2468be[_0x448e66(0x2b2)](),_0x201c21=await sales_finished[_0x448e66(0x1ac)]({'_id':_0x439175[_0x448e66(0x2bb)]['id']}),_0x3b48a8=await warehouse[_0x448e66(0x1ac)]({'name':_0xe9792c,'room':_0x481e0e,'warehouse_category':_0x448e66(0x1b6)});_0x201c21['sale_product'][_0x448e66(0x253)](_0x50637f=>{var _0xaf204a=_0x448e66;const _0x4b8e4e=_0x3b48a8['product_details'][_0xaf204a(0x2b8)](_0x176fa2=>{var _0x5a4511=_0xaf204a;_0x176fa2['product_name']==_0x50637f[_0x5a4511(0x1b5)]&&_0x176fa2[_0x5a4511(0x29e)]==_0x50637f['bay']&&(_0x176fa2[_0x5a4511(0x287)]=parseInt(_0x176fa2['product_stock'])-parseInt(_0x50637f['quantity']));});}),console['log'](_0x448e66(0x1fb),_0x3b48a8),await _0x3b48a8[_0x448e66(0x2b2)]();const _0x5f2dc9=await c_payment_data[_0x448e66(0x1ac)]({'invoice':_0x439175['body'][_0x448e66(0x26c)]});_0x5f2dc9[_0x448e66(0x1c7)]=_0x439175[_0x448e66(0x203)][_0x448e66(0x1c7)],await _0x5f2dc9[_0x448e66(0x2b2)](),_0x439175[_0x448e66(0x1af)]('success',_0x448e66(0x1c9)),_0x1e6ab8[_0x448e66(0x2ad)](_0x448e66(0x1f6));}catch(_0x595728){console[_0x448e66(0x1d4)](_0x595728);}}),router[a0_0x54b10c(0x24d)](a0_0x54b10c(0x1e2),auth,async(_0x1e424f,_0x1e45df)=>{var _0x3ef3f4=a0_0x54b10c;try{const _0x35137c=_0x1e424f[_0x3ef3f4(0x2bb)]['id'],{invoice:_0x377cb0,customer:_0x512ae6,receivable_amount:_0x4f75de,received_amount:_0x35021a}=_0x1e424f[_0x3ef3f4(0x203)],_0x202fc1=await sales[_0x3ef3f4(0x28f)](_0x35137c);console['log'](_0x202fc1);var _0x1848fc=_0x4f75de-_0x35021a;console[_0x3ef3f4(0x1d4)](_0x35021a),_0x202fc1['received_amount']=parseFloat(_0x35021a)+parseFloat(_0x202fc1[_0x3ef3f4(0x222)]),_0x202fc1[_0x3ef3f4(0x22e)]=_0x1848fc,console[_0x3ef3f4(0x1d4)](_0x202fc1);const _0x4b47a4=await _0x202fc1[_0x3ef3f4(0x2b2)](),_0x23fefb=await c_payment_data[_0x3ef3f4(0x1ac)]({'invoice':_0x377cb0});_0x23fefb[_0x3ef3f4(0x23d)]=_0x1848fc,await _0x23fefb[_0x3ef3f4(0x2b2)]();let _0x434576=new Date(),_0x427195=('0'+_0x434576[_0x3ef3f4(0x1bd)]())[_0x3ef3f4(0x274)](-0x2),_0x51d229=('0'+(_0x434576[_0x3ef3f4(0x292)]()+0x1))['slice'](-0x2),_0x36da7a=_0x434576['getFullYear'](),_0x36ed84=_0x36da7a+'-'+_0x51d229+'-'+_0x427195;const _0x352529=new customer_payment({'invoice':_0x377cb0,'date':_0x36da7a+'-'+_0x51d229+'-'+_0x427195,'customer':_0x512ae6,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x35021a}),_0x30e332=await _0x352529[_0x3ef3f4(0x2b2)]();_0x1e424f['flash'](_0x3ef3f4(0x269),'payment\x20successfull'),_0x1e45df['redirect'](_0x3ef3f4(0x2ba));}catch(_0x1f3cad){console[_0x3ef3f4(0x1d4)](_0x1f3cad);}}),router['get']('/invoice/:id',auth,async(_0x30aca1,_0x7d1ed3)=>{var _0x220e84=a0_0x54b10c;try{const {username:_0x388c17,email:_0x99567c,role:_0x560e81}=_0x30aca1[_0x220e84(0x1c4)],_0x4409ac=_0x30aca1[_0x220e84(0x1c4)],_0x2ec656=await profile[_0x220e84(0x1ac)]({'email':_0x4409ac['email']}),_0x3f2b0b=await master_shop[_0x220e84(0x266)]();console[_0x220e84(0x1d4)]('master',_0x3f2b0b);const _0x3c753a=_0x30aca1[_0x220e84(0x2bb)]['id'],_0x11a143=await sales['findById'](_0x3c753a);console['log'](_0x11a143);const _0x153072=await customer['findOne']({'name':_0x11a143[_0x220e84(0x239)]});console[_0x220e84(0x1d4)](_0x153072);if(_0x3f2b0b[0x0][_0x220e84(0x284)]==_0x220e84(0x2ac)){var _0x258ed9=users['English'];console[_0x220e84(0x1d4)](_0x258ed9);}else{if(_0x3f2b0b[0x0][_0x220e84(0x284)]==_0x220e84(0x28e))var _0x258ed9=users['Hindi'];else{if(_0x3f2b0b[0x0][_0x220e84(0x284)]=='German')var _0x258ed9=users[_0x220e84(0x1cf)];else{if(_0x3f2b0b[0x0][_0x220e84(0x284)]==_0x220e84(0x294))var _0x258ed9=users[_0x220e84(0x294)];else{if(_0x3f2b0b[0x0][_0x220e84(0x284)]==_0x220e84(0x237))var _0x258ed9=users['French'];else{if(_0x3f2b0b[0x0][_0x220e84(0x284)]==_0x220e84(0x246))var _0x258ed9=users[_0x220e84(0x24c)];else{if(_0x3f2b0b[0x0][_0x220e84(0x284)]==_0x220e84(0x1f9))var _0x258ed9=users[_0x220e84(0x1f9)];else{if(_0x3f2b0b[0x0][_0x220e84(0x284)]==_0x220e84(0x297))var _0x258ed9=users[_0x220e84(0x233)];}}}}}}}_0x7d1ed3[_0x220e84(0x2b5)](_0x220e84(0x1ef),{'success':_0x30aca1[_0x220e84(0x1af)]('success'),'errors':_0x30aca1[_0x220e84(0x1af)](_0x220e84(0x242)),'role':_0x4409ac,'profile':_0x2ec656,'master_shop':_0x3f2b0b,'customers':_0x153072,'sales':_0x11a143,'language':_0x258ed9});}catch(_0x17f7ab){console['log'](_0x17f7ab);}}),router[a0_0x54b10c(0x273)](a0_0x54b10c(0x22f),auth,async(_0xd61ec0,_0x468235)=>{var _0x1b4c41=a0_0x54b10c;try{const {username:_0x3922cf,email:_0x2f6c20,role:_0x55707c}=_0xd61ec0[_0x1b4c41(0x1c4)],_0x57dbd4=_0xd61ec0[_0x1b4c41(0x1c4)],_0x558de9=await profile[_0x1b4c41(0x1ac)]({'email':_0x57dbd4[_0x1b4c41(0x26a)]}),_0x4848e7=await master_shop[_0x1b4c41(0x266)](),_0x23570f=_0xd61ec0[_0x1b4c41(0x2bb)]['id'],_0x71eef1=await sales_finished[_0x1b4c41(0x28f)](_0x23570f),_0x49bc23=await warehouse['aggregate']([{'$match':{'name':_0x71eef1[_0x1b4c41(0x268)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1b4c41(0x238),'name':{'$first':_0x1b4c41(0x24b)},'product_stock':{'$first':_0x1b4c41(0x1ff)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1b4c41(0x1df)},'type':{'$first':_0x1b4c41(0x2a1)},'floorlevel':{'$first':_0x1b4c41(0x25a)},'primary_code':{'$first':_0x1b4c41(0x206)},'secondary_code':{'$first':_0x1b4c41(0x1d2)},'product_code':{'$first':_0x1b4c41(0x291)},'storage':{'$first':_0x1b4c41(0x1ab)},'rack':{'$first':_0x1b4c41(0x21e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1b4c41(0x24a)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1b4c41(0x280)},'maxProducts':{'$first':_0x1b4c41(0x258)},'batch_code':{'$first':_0x1b4c41(0x2be)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x4f1eec=await product[_0x1b4c41(0x266)]({}),_0x1b2dce=await warehouse[_0x1b4c41(0x1d9)]([{'$match':{'status':'Enabled','warehouse_category':_0x1b4c41(0x1b6),'name':{'$ne':_0x1b4c41(0x1eb),'$ne':_0x1b4c41(0x232)}}},{'$group':{'_id':_0x1b4c41(0x247),'name':{'$first':_0x1b4c41(0x247)}}},{'$sort':{'name':0x1}}]);var _0x2d1f04=[_0x1b4c41(0x28b)];const _0x1bbb7c=await warehouse[_0x1b4c41(0x1d9)]([{'$match':{'status':_0x1b4c41(0x217),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x1b4c41(0x247),'name':{'$first':_0x1b4c41(0x247)}}},{'$sort':{'name':0x1}}]);if(_0x4848e7[0x0][_0x1b4c41(0x284)]=='English\x20(US)'){var _0x428eb0=users[_0x1b4c41(0x21a)];console['log'](_0x428eb0);}else{if(_0x4848e7[0x0][_0x1b4c41(0x284)]==_0x1b4c41(0x28e))var _0x428eb0=users[_0x1b4c41(0x28e)];else{if(_0x4848e7[0x0][_0x1b4c41(0x284)]=='German')var _0x428eb0=users[_0x1b4c41(0x1cf)];else{if(_0x4848e7[0x0][_0x1b4c41(0x284)]==_0x1b4c41(0x294))var _0x428eb0=users['Spanish'];else{if(_0x4848e7[0x0][_0x1b4c41(0x284)]==_0x1b4c41(0x237))var _0x428eb0=users[_0x1b4c41(0x237)];else{if(_0x4848e7[0x0]['language']==_0x1b4c41(0x246))var _0x428eb0=users[_0x1b4c41(0x24c)];else{if(_0x4848e7[0x0][_0x1b4c41(0x284)]==_0x1b4c41(0x1f9))var _0x428eb0=users[_0x1b4c41(0x1f9)];else{if(_0x4848e7[0x0][_0x1b4c41(0x284)]=='Arabic\x20(ae)')var _0x428eb0=users[_0x1b4c41(0x233)];}}}}}}}_0x468235[_0x1b4c41(0x2b5)]('return_sale_finished',{'success':_0xd61ec0[_0x1b4c41(0x1af)](_0x1b4c41(0x269)),'errors':_0xd61ec0[_0x1b4c41(0x1af)]('errors'),'role':_0x57dbd4,'profile':_0x558de9,'user':_0x71eef1,'stock':_0x49bc23,'master_shop':_0x4848e7,'unit':_0x4f1eec,'language':_0x428eb0,'warehouses':_0x1b2dce,'rooms':_0x2d1f04,'warehouse_QA':_0x1bbb7c});}catch(_0x4ce27a){console['log'](_0x4ce27a),_0x468235[_0x1b4c41(0x27f)](0xc8)[_0x1b4c41(0x26f)]({'message':_0x4ce27a[_0x1b4c41(0x249)]});}}),router[a0_0x54b10c(0x24d)](a0_0x54b10c(0x22f),auth,async(_0x1b74f1,_0x2025f7)=>{var _0x55a483=a0_0x54b10c;if(_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x20a)]=='QA')try{const {invoice:_0x3bda5f,date:_0x6dbaea,warehouse_name:_0x2818f2,product_name:_0x5247e0,primary_code:_0x3f2b4e,secondary_code:_0x4ca99f,product_code:_0x5c33c0,sales_quantity:_0x1fcff6,stocks:_0x5f23d7,return_qty:_0x12ff8a,Room_name:_0xed1112,to_warehouse_name_QA:_0x54c128,to_Room_name_QA:_0x4d6980,note:_0x2b6ab5,for_categorize:_0x1da8e1,product_name_QA1:_0x2bbee9}=_0x1b74f1['body'];if(typeof _0x2bbee9=='string')var _0x50ffbe=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x214)]],_0x23c3ef=[_0x1b74f1[_0x55a483(0x203)]['primary_code_QA']],_0x5b5c02=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x22a)]],_0x2a0520=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x28c)]],_0x48c087=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x230)]],_0x39e0b2=[_0x1b74f1['body']['stocks_QA']],_0xc5cda2=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x226)]],_0x2fddeb=[_0x1b74f1[_0x55a483(0x203)]['maxPerUnit_QA']],_0xa4f72f=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x2bc)]],_0x586742=[_0x1b74f1['body']['batch_code_QA']],_0x520157=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x2b6)]],_0xcd765c=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x270)]],_0x33a578=[_0x1b74f1[_0x55a483(0x203)]['production_date_QA']],_0x3c714d=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x296)]];else var _0x50ffbe=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x214)]],_0x23c3ef=[..._0x1b74f1[_0x55a483(0x203)]['primary_code_QA']],_0x5b5c02=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x22a)]],_0x2a0520=[..._0x1b74f1[_0x55a483(0x203)]['product_code_QA']],_0x48c087=[..._0x1b74f1['body'][_0x55a483(0x230)]],_0x39e0b2=[..._0x1b74f1[_0x55a483(0x203)]['stocks_QA']],_0xc5cda2=[..._0x1b74f1['body']['return_qty_QA']],_0x2fddeb=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x1be)]],_0xa4f72f=[..._0x1b74f1['body'][_0x55a483(0x2bc)]],_0x586742=[..._0x1b74f1[_0x55a483(0x203)]['batch_code_QA']],_0x520157=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x2b6)]],_0xcd765c=[..._0x1b74f1['body'][_0x55a483(0x270)]],_0x33a578=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x29d)]],_0x3c714d=[..._0x1b74f1['body']['expiry_date_QA']];const _0x5f4791=_0x50ffbe[_0x55a483(0x2b8)](_0x664563=>{return _0x664563={'product_name':_0x664563};});_0x23c3ef[_0x55a483(0x253)]((_0x3cc0c0,_0x39874b)=>{var _0xc95d78=_0x55a483;_0x5f4791[_0x39874b][_0xc95d78(0x1e6)]=_0x3cc0c0;}),_0x5b5c02['forEach']((_0x325b80,_0x2ea342)=>{_0x5f4791[_0x2ea342]['secondary_code']=_0x325b80;}),_0x2a0520[_0x55a483(0x253)]((_0x45c042,_0x5e48b6)=>{_0x5f4791[_0x5e48b6]['product_code']=_0x45c042;}),_0x48c087[_0x55a483(0x253)]((_0x43680e,_0x4bbd71)=>{var _0x103f0b=_0x55a483;_0x5f4791[_0x4bbd71][_0x103f0b(0x29f)]=_0x43680e;}),_0x39e0b2[_0x55a483(0x253)]((_0xb32061,_0x14978a)=>{var _0x16f0ef=_0x55a483;_0x5f4791[_0x14978a][_0x16f0ef(0x290)]=_0xb32061;}),_0xc5cda2['forEach']((_0x5524a0,_0x4d384e)=>{var _0x570703=_0x55a483;_0x5f4791[_0x4d384e][_0x570703(0x20f)]=_0x5524a0;}),_0x2fddeb['forEach']((_0x22a559,_0x360943)=>{var _0x333908=_0x55a483;_0x5f4791[_0x360943][_0x333908(0x1d7)]=_0x22a559;}),_0xa4f72f[_0x55a483(0x253)]((_0x446290,_0x2003b4)=>{var _0x34bb2b=_0x55a483;_0x5f4791[_0x2003b4][_0x34bb2b(0x27a)]=_0x446290;}),_0x586742[_0x55a483(0x253)]((_0x3a32d0,_0x2c189e)=>{_0x5f4791[_0x2c189e]['batch_code']=_0x3a32d0;}),_0x520157[_0x55a483(0x253)]((_0x513cc4,_0x1dfbeb)=>{var _0x17f0e0=_0x55a483;_0x5f4791[_0x1dfbeb][_0x17f0e0(0x1ed)]=_0x513cc4;}),_0xcd765c[_0x55a483(0x253)]((_0x4455a1,_0x2e3601)=>{_0x5f4791[_0x2e3601]['unit']=_0x4455a1;}),_0x33a578[_0x55a483(0x253)]((_0xe25854,_0x1e6933)=>{var _0x423e8d=_0x55a483;_0x5f4791[_0x1e6933][_0x423e8d(0x281)]=_0xe25854;}),_0x3c714d[_0x55a483(0x253)]((_0x30082d,_0xb89161)=>{var _0x4445ce=_0x55a483;_0x5f4791[_0xb89161][_0x4445ce(0x299)]=_0x30082d;});const _0x47a9c0=await sales_finished[_0x55a483(0x1ac)]({'invoice':_0x3bda5f});_0x47a9c0[_0x55a483(0x219)]=_0x55a483(0x228);const _0x4774c6=await _0x47a9c0['save'](),_0x20cf92=new sales_return_finished({'invoice':_0x3bda5f,'customer':_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x239)],'date':_0x6dbaea,'warehouse_name':_0x2818f2,'room':_0xed1112,'ToWarehouse':_0x54c128,'ToRoom':_0x4d6980,'return_sale_QA':_0x5f4791,'note':_0x2b6ab5,'warehouse_cat':_0x1da8e1}),_0x11d2b8=await _0x20cf92[_0x55a483(0x2b2)](),_0x369255=await sales_return_finished[_0x55a483(0x1ac)]({'invoice':_0x3bda5f}),_0x16ddc3=await warehouse[_0x55a483(0x1ac)]({'name':_0x54c128,'room':_0x4d6980});_0x369255[_0x55a483(0x21d)]['forEach'](_0xb3ca6b=>{var _0x16871e=_0x55a483,_0x2d5bba=0x0;const _0x50b80d=_0x16ddc3[_0x16871e(0x2ae)][_0x16871e(0x2b8)](_0x3e6039=>{var _0x40b11c=_0x16871e;_0x3e6039[_0x40b11c(0x1b5)]==_0xb3ca6b[_0x40b11c(0x1b5)]&&_0x3e6039['expiry_date']==_0xb3ca6b[_0x40b11c(0x299)]&&_0x3e6039[_0x40b11c(0x281)]==_0xb3ca6b['production_date']&&_0x3e6039[_0x40b11c(0x221)]==_0xb3ca6b['batch_code']&&(_0x3e6039[_0x40b11c(0x287)]=parseInt(_0x3e6039['product_stock'])+parseInt(_0xb3ca6b['return_qty']),_0x2d5bba++);});_0x2d5bba=='0'&&(_0x16ddc3[_0x16871e(0x2ae)]=_0x16ddc3[_0x16871e(0x2ae)][_0x16871e(0x2a5)]({'product_name':_0xb3ca6b['product_name'],'product_stock':_0xb3ca6b['return_qty'],'primary_code':_0xb3ca6b[_0x16871e(0x1e6)],'secondary_code':_0xb3ca6b[_0x16871e(0x1ae)],'product_code':_0xb3ca6b[_0x16871e(0x25c)],'batch_code':_0xb3ca6b[_0x16871e(0x221)],'maxPerUnit':_0xb3ca6b['maxPerUnit'],'production_date':_0xb3ca6b['production_date'],'expiry_date':_0xb3ca6b['expiry_date'],'secondary_unit':_0xb3ca6b['secondary_unit'],'unit':_0xb3ca6b[_0x16871e(0x250)],'maxProducts':_0xb3ca6b['maxProducts'],'bay':_0xb3ca6b['bay']}));}),await _0x16ddc3[_0x55a483(0x2b2)]();const _0x2e01df=new c_payment_data({'invoice':_0x3bda5f,'customer':_0x1b74f1['body']['customer'],'reason':'Sale\x20Return'});await _0x2e01df['save']();const _0x3ba252=await master_shop[_0x55a483(0x266)](),_0x4da96c=await email_settings[_0x55a483(0x1ac)](),_0x1aa30e=await customer[_0x55a483(0x1ac)]({'name':_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x239)]});_0x3ba252[0x0][_0x55a483(0x25b)]==0x1?(right_currency=_0x3ba252[0x0][_0x55a483(0x1d1)],left_currency=''):(right_currency='',left_currency=_0x3ba252[0x0][_0x55a483(0x1d1)]);var _0x4ccd92=_0x50ffbe,_0x2c23f7=_0xc5cda2,_0x3e0ff6='',_0x26329c;for(_0x26329c in _0x4ccd92){_0x3e0ff6+=_0x55a483(0x1fc)+_0x55a483(0x200)+_0x4ccd92[_0x26329c]+_0x55a483(0x1e0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2c23f7[_0x26329c]+'</td>'+_0x55a483(0x22c);}console[_0x55a483(0x1d4)](_0x55a483(0x2af),_0x3e0ff6);let _0x3ae085=nodemailer['createTransport']({'service':_0x55a483(0x1e8),'auth':{'user':_0x4da96c[_0x55a483(0x26a)],'pass':_0x4da96c[_0x55a483(0x1f3)]}}),_0x55ea9e={'from':_0x4da96c[_0x55a483(0x26a)],'to':_0x1aa30e[_0x55a483(0x26a)],'subject':_0x55a483(0x2a0),'attachments':[{'filename':_0x55a483(0x285),'path':__dirname+_0x55a483(0x236)+_0x55a483(0x245)+_0x3ba252[0x0][_0x55a483(0x27d)],'cid':_0x55a483(0x21b)}],'html':_0x55a483(0x25d)+_0x55a483(0x1a9)+'</head><body>'+_0x55a483(0x1b8)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x55a483(0x1b8)+_0x55a483(0x240)+_0x55a483(0x1f4)+_0x55a483(0x1b8)+_0x55a483(0x28d)+_0x3ba252[0x0][_0x55a483(0x215)]+_0x55a483(0x1bb)+_0x55a483(0x1f4)+_0x55a483(0x1f4)+_0x55a483(0x248)+'<div>'+_0x55a483(0x2a3)+_0x55a483(0x1bc)+_0x3bda5f+'\x20'+_0x55a483(0x1ec)+_0x55a483(0x2b7)+_0x6dbaea+'\x20'+_0x55a483(0x264)+_0x55a483(0x1f1)+'</div>'+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x55a483(0x2a9)+_0x55a483(0x1fc)+_0x55a483(0x295)+_0x55a483(0x241)+_0x55a483(0x28a)+_0x55a483(0x1aa)+_0x55a483(0x22c)+_0x55a483(0x2aa)+_0x55a483(0x277)+'\x20'+_0x3e0ff6+'\x20'+_0x55a483(0x1c8)+_0x55a483(0x27c)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x55a483(0x1e9)+_0x3ba252[0x0][_0x55a483(0x215)]+_0x55a483(0x1f1)+_0x55a483(0x1f4)+_0x55a483(0x1f4)+_0x55a483(0x243)};_0x3ae085['sendMail'](_0x55ea9e,function(_0x130817,_0x952692){var _0x483c4c=_0x55a483;_0x130817?(console[_0x483c4c(0x1d4)](_0x130817),console[_0x483c4c(0x1d4)](_0x483c4c(0x244))):console[_0x483c4c(0x1d4)](_0x483c4c(0x1ce));}),_0x1b74f1['flash'](_0x55a483(0x269),_0x55a483(0x1cc)),_0x2025f7[_0x55a483(0x2ad)](_0x55a483(0x1f6));}catch(_0xa7fb54){_0x2025f7[_0x55a483(0x27f)](0xc8)['json']({'message1':_0xa7fb54['message']});}else{if(_0x1b74f1['body'][_0x55a483(0x20a)]=='GS')try{const {invoice:_0x1bd24b,date:_0x353ace,warehouse_name:_0x19e55e,product_name:_0x44fac8,primary_code:_0x1bf724,secondary_code:_0x2fd5b7,product_code:_0x513860,sales_quantity:_0x12f035,stocks:_0x451de0,return_qty:_0x422cfa,Room_name:_0x35c03c,to_warehouse_name:_0x2d3de3,to_Room_name:_0x1bdf2c,note:_0x3b5166,level:_0x16d3e5,isle:_0x3f3609,pallet:_0x4cdf48,for_categorize:_0x1dcf33}=_0x1b74f1[_0x55a483(0x203)];if(typeof _0x44fac8==_0x55a483(0x1ca))var _0x50ffbe=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x1b5)]],_0x23c3ef=[_0x1b74f1[_0x55a483(0x203)]['primary_code']],_0x5b5c02=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x1ae)]],_0x2a0520=[_0x1b74f1[_0x55a483(0x203)]['product_code']],_0x48c087=[_0x1b74f1['body']['sales_quantity']],_0xc5cda2=[_0x1b74f1[_0x55a483(0x203)]['return_qty']],_0x7d0dcb=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x29e)]],_0x2fddeb=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x1d7)]],_0xa4f72f=[_0x1b74f1['body'][_0x55a483(0x27a)]],_0x586742=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x221)]],_0x520157=[_0x1b74f1[_0x55a483(0x203)]['secondary_unit']],_0xcd765c=[_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x250)]],_0x33a578=[_0x1b74f1[_0x55a483(0x203)]['production_date']],_0x3c714d=[_0x1b74f1['body'][_0x55a483(0x299)]];else var _0x50ffbe=[..._0x1b74f1['body'][_0x55a483(0x1b5)]],_0x23c3ef=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x1e6)]],_0x5b5c02=[..._0x1b74f1[_0x55a483(0x203)]['secondary_code']],_0x2a0520=[..._0x1b74f1['body']['product_code']],_0x48c087=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x251)]],_0xc5cda2=[..._0x1b74f1[_0x55a483(0x203)]['return_qty']],_0x7d0dcb=[..._0x1b74f1['body'][_0x55a483(0x29e)]],_0x2fddeb=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x1d7)]],_0xa4f72f=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x27a)]],_0x586742=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x221)]],_0x520157=[..._0x1b74f1['body'][_0x55a483(0x1ed)]],_0xcd765c=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x250)]],_0x33a578=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x281)]],_0x3c714d=[..._0x1b74f1[_0x55a483(0x203)][_0x55a483(0x299)]];const _0x4c9f6f=_0x50ffbe[_0x55a483(0x2b8)](_0x1f651e=>{return _0x1f651e={'product_name':_0x1f651e};});_0x23c3ef[_0x55a483(0x253)]((_0x4ac26e,_0x3729cf)=>{var _0x142934=_0x55a483;_0x4c9f6f[_0x3729cf][_0x142934(0x1e6)]=_0x4ac26e;}),_0x5b5c02[_0x55a483(0x253)]((_0x55881a,_0xb45e85)=>{var _0xfd823f=_0x55a483;_0x4c9f6f[_0xb45e85][_0xfd823f(0x1ae)]=_0x55881a;}),_0x2a0520[_0x55a483(0x253)]((_0x52e49c,_0x22d1c5)=>{_0x4c9f6f[_0x22d1c5]['product_code']=_0x52e49c;}),_0x48c087['forEach']((_0x1f895f,_0x3cdff4)=>{var _0x427db8=_0x55a483;_0x4c9f6f[_0x3cdff4][_0x427db8(0x29f)]=_0x1f895f;}),_0xc5cda2['forEach']((_0x2e638a,_0x4c944e)=>{var _0x43fab5=_0x55a483;_0x4c9f6f[_0x4c944e][_0x43fab5(0x20f)]=_0x2e638a;}),_0x7d0dcb[_0x55a483(0x253)]((_0x42ae30,_0x14e095)=>{_0x4c9f6f[_0x14e095]['bay']=_0x42ae30;}),_0x2fddeb[_0x55a483(0x253)]((_0x1f8e6c,_0x7336d3)=>{_0x4c9f6f[_0x7336d3]['maxPerUnit']=_0x1f8e6c;}),_0xa4f72f[_0x55a483(0x253)]((_0x43c088,_0x3eaf26)=>{var _0xbfdd94=_0x55a483;_0x4c9f6f[_0x3eaf26][_0xbfdd94(0x27a)]=_0x43c088;}),_0x586742[_0x55a483(0x253)]((_0x15dc1f,_0x271bf4)=>{var _0x12ba41=_0x55a483;_0x4c9f6f[_0x271bf4][_0x12ba41(0x221)]=_0x15dc1f;}),_0x520157['forEach']((_0x575f06,_0x277ae0)=>{var _0x18a47e=_0x55a483;_0x4c9f6f[_0x277ae0][_0x18a47e(0x1ed)]=_0x575f06;}),_0xcd765c[_0x55a483(0x253)]((_0x5b614e,_0x3b93c3)=>{var _0x3686d2=_0x55a483;_0x4c9f6f[_0x3b93c3][_0x3686d2(0x250)]=_0x5b614e;}),_0x33a578[_0x55a483(0x253)]((_0x2feabd,_0x5a74ec)=>{var _0x365324=_0x55a483;_0x4c9f6f[_0x5a74ec][_0x365324(0x281)]=_0x2feabd;}),_0x3c714d['forEach']((_0x1f0400,_0x467499)=>{var _0x285562=_0x55a483;_0x4c9f6f[_0x467499][_0x285562(0x299)]=_0x1f0400;});var _0x44b91b=0x0;_0x4c9f6f[_0x55a483(0x253)](_0x142ae0=>{var _0x30eb84=_0x55a483;(parseInt(_0x142ae0[_0x30eb84(0x29f)])<parseInt(_0x142ae0[_0x30eb84(0x20f)])||parseInt(_0x142ae0[_0x30eb84(0x290)])<parseInt(_0x142ae0[_0x30eb84(0x20f)])&&parseInt(_0x142ae0[_0x30eb84(0x29f)])>parseInt(_0x142ae0[_0x30eb84(0x20f)])||parseInt(_0x142ae0[_0x30eb84(0x20f)])==0x0)&&_0x44b91b++;});if(_0x44b91b!=0x0)return _0x1b74f1[_0x55a483(0x1af)](_0x55a483(0x242),_0x55a483(0x218)),_0x2025f7[_0x55a483(0x2ad)]('back');const _0x44a21f=await sales_finished[_0x55a483(0x1ac)]({'invoice':_0x1bd24b});_0x44a21f[_0x55a483(0x219)]=_0x55a483(0x228);const _0x5b736d=await _0x44a21f['save'](),_0x29c52a=new sales_return_finished({'invoice':_0x1bd24b,'customer':_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x239)],'date':_0x353ace,'warehouse_name':_0x19e55e,'room':_0x35c03c,'ToWarehouse':_0x2d3de3,'ToRoom':_0x1bdf2c,'return_sale':_0x4c9f6f,'note':_0x3b5166,'warehouse_cat':_0x1dcf33}),_0x48ae0f=await _0x29c52a[_0x55a483(0x2b2)](),_0x1c29c6=await sales_return_finished[_0x55a483(0x1ac)]({'invoice':_0x1bd24b}),_0x4c4615=await warehouse[_0x55a483(0x1ac)]({'name':_0x2d3de3,'room':_0x1bdf2c,'warehouse_category':'Finished\x20Goods'});_0x1c29c6['return_sale']['forEach'](_0xaf8614=>{var _0x33628c=_0x55a483,_0x4be432=0x0;const _0x8dcd55=_0x4c4615[_0x33628c(0x2ae)][_0x33628c(0x2b8)](_0x245ed5=>{var _0x5a2eec=_0x33628c;_0x245ed5[_0x5a2eec(0x1b5)]==_0xaf8614[_0x5a2eec(0x1b5)]&&_0x245ed5[_0x5a2eec(0x29e)]==_0xaf8614[_0x5a2eec(0x29e)]&&_0x245ed5[_0x5a2eec(0x299)]==_0xaf8614[_0x5a2eec(0x299)]&&_0x245ed5['production_date']==_0xaf8614[_0x5a2eec(0x281)]&&_0x245ed5[_0x5a2eec(0x221)]==_0xaf8614[_0x5a2eec(0x221)]&&(_0x245ed5[_0x5a2eec(0x287)]=parseInt(_0x245ed5[_0x5a2eec(0x287)])+parseInt(_0xaf8614[_0x5a2eec(0x20f)]),_0x4be432++);});_0x4be432=='0'&&(_0x4c4615[_0x33628c(0x2ae)]=_0x4c4615[_0x33628c(0x2ae)][_0x33628c(0x2a5)]({'product_name':_0xaf8614[_0x33628c(0x1b5)],'product_stock':_0xaf8614['return_qty'],'primary_code':_0xaf8614[_0x33628c(0x1e6)],'secondary_code':_0xaf8614[_0x33628c(0x1ae)],'product_code':_0xaf8614[_0x33628c(0x25c)],'bay':_0xaf8614['bay'],'batch_code':_0xaf8614['batch_code'],'maxPerUnit':_0xaf8614['maxPerUnit'],'production_date':_0xaf8614[_0x33628c(0x281)],'expiry_date':_0xaf8614['expiry_date'],'secondary_unit':_0xaf8614[_0x33628c(0x1ed)],'unit':_0xaf8614['unit'],'maxProducts':_0xaf8614['maxProducts']}));}),await _0x4c4615['save'](),console[_0x55a483(0x1d4)](_0x1b74f1[_0x55a483(0x203)]);const _0x3ae269=new c_payment_data({'invoice':_0x1bd24b,'customer':_0x1b74f1[_0x55a483(0x203)][_0x55a483(0x239)],'reason':_0x55a483(0x29c)});await _0x3ae269[_0x55a483(0x2b2)]();const _0x1f3606=await master_shop[_0x55a483(0x266)]();console[_0x55a483(0x1d4)](_0x55a483(0x22d),_0x1f3606[0x0][_0x55a483(0x27d)]);const _0xaeae4=await email_settings[_0x55a483(0x1ac)](),_0x151a00=await customer[_0x55a483(0x1ac)]({'name':_0x1b74f1['body'][_0x55a483(0x239)]});console['log']('customer_data',_0x151a00);_0x1f3606[0x0][_0x55a483(0x25b)]==0x1?(right_currency=_0x1f3606[0x0][_0x55a483(0x1d1)],left_currency=''):(right_currency='',left_currency=_0x1f3606[0x0][_0x55a483(0x1d1)]);var _0x4ccd92=_0x50ffbe,_0x2c23f7=_0xc5cda2,_0x3e0ff6='',_0x26329c;for(_0x26329c in _0x4ccd92){_0x3e0ff6+=_0x55a483(0x1fc)+_0x55a483(0x200)+_0x4ccd92[_0x26329c]+_0x55a483(0x1e0)+_0x55a483(0x200)+_0x2c23f7[_0x26329c]+_0x55a483(0x1e0)+_0x55a483(0x22c);}console[_0x55a483(0x1d4)](_0x55a483(0x2af),_0x3e0ff6);let _0x1012f6=nodemailer[_0x55a483(0x2a8)]({'service':_0x55a483(0x1e8),'auth':{'user':_0xaeae4[_0x55a483(0x26a)],'pass':_0xaeae4[_0x55a483(0x1f3)]}}),_0x103b0f={'from':_0xaeae4['email'],'to':_0x151a00[_0x55a483(0x26a)],'subject':_0x55a483(0x2a0),'attachments':[{'filename':_0x55a483(0x285),'path':__dirname+_0x55a483(0x236)+'/upload/'+_0x1f3606[0x0]['image'],'cid':_0x55a483(0x21b)}],'html':'<!DOCTYPE\x20html>'+_0x55a483(0x1a9)+_0x55a483(0x29b)+'<div>'+_0x55a483(0x2a2)+_0x55a483(0x1b8)+_0x55a483(0x240)+_0x55a483(0x1f4)+_0x55a483(0x1b8)+_0x55a483(0x28d)+_0x1f3606[0x0][_0x55a483(0x215)]+'\x20</h2>'+_0x55a483(0x1f4)+_0x55a483(0x1f4)+_0x55a483(0x248)+'<div>'+_0x55a483(0x2a3)+_0x55a483(0x1bc)+_0x1bd24b+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x55a483(0x2b7)+_0x353ace+'\x20'+_0x55a483(0x264)+_0x55a483(0x1f1)+_0x55a483(0x1f4)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x55a483(0x1fc)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x55a483(0x241)+_0x55a483(0x28a)+_0x55a483(0x1aa)+'</tr>'+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3e0ff6+'\x20'+_0x55a483(0x1c8)+'</table>'+_0x55a483(0x1b8)+_0x55a483(0x23f)+_0x55a483(0x1e9)+_0x1f3606[0x0][_0x55a483(0x215)]+'</h5>'+_0x55a483(0x1f4)+_0x55a483(0x1f4)+'</body></html>'};_0x1012f6[_0x55a483(0x224)](_0x103b0f,function(_0x477ec6,_0x110163){var _0x38e3f7=_0x55a483;_0x477ec6?(console[_0x38e3f7(0x1d4)](_0x477ec6),console[_0x38e3f7(0x1d4)]('Error\x20Occurs')):console[_0x38e3f7(0x1d4)](_0x38e3f7(0x1ce));}),_0x1b74f1['flash'](_0x55a483(0x269),_0x55a483(0x1cc)),_0x2025f7[_0x55a483(0x2ad)](_0x55a483(0x1f6));}catch(_0x459bb2){console[_0x55a483(0x1d4)](_0x459bb2),_0x2025f7[_0x55a483(0x27f)](0xc8)[_0x55a483(0x26f)]({'message1':_0x459bb2[_0x55a483(0x249)]});}}}),router['get'](a0_0x54b10c(0x2ab),auth,async(_0x4607f5,_0x77474)=>{var _0x311085=a0_0x54b10c;try{const {username:_0x5bebe6,email:_0x1582ba,role:_0x145138}=_0x4607f5[_0x311085(0x1c4)],_0x54b743=_0x4607f5['user'],_0x4a4fd3=await profile[_0x311085(0x1ac)]({'email':_0x54b743['email']}),_0x40ac4a=await master_shop[_0x311085(0x266)]();console[_0x311085(0x1d4)](_0x311085(0x276),_0x40ac4a);const _0x512348=_0x4607f5['params']['id'],_0x2530b8=await sales[_0x311085(0x28f)](_0x512348);console[_0x311085(0x1d4)](_0x311085(0x1e4),_0x2530b8);if(_0x40ac4a[0x0]['language']==_0x311085(0x2ac))var _0x3e7937=users['English'];else{if(_0x40ac4a[0x0]['language']==_0x311085(0x28e))var _0x3e7937=users[_0x311085(0x28e)];else{if(_0x40ac4a[0x0][_0x311085(0x284)]==_0x311085(0x1cf))var _0x3e7937=users[_0x311085(0x1cf)];else{if(_0x40ac4a[0x0][_0x311085(0x284)]==_0x311085(0x294))var _0x3e7937=users[_0x311085(0x294)];else{if(_0x40ac4a[0x0]['language']==_0x311085(0x237))var _0x3e7937=users[_0x311085(0x237)];else{if(_0x40ac4a[0x0][_0x311085(0x284)]=='Portuguese\x20(BR)')var _0x3e7937=users['Portuguese'];else{if(_0x40ac4a[0x0][_0x311085(0x284)]==_0x311085(0x1f9))var _0x3e7937=users['Chinese'];else{if(_0x40ac4a[0x0][_0x311085(0x284)]==_0x311085(0x297))var _0x3e7937=users[_0x311085(0x233)];}}}}}}}_0x77474[_0x311085(0x2b5)](_0x311085(0x2a6),{'success':_0x4607f5['flash'](_0x311085(0x269)),'errors':_0x4607f5[_0x311085(0x1af)](_0x311085(0x242)),'role':_0x54b743,'profile':_0x4a4fd3,'alldata':_0x2530b8,'master_shop':_0x40ac4a,'language':_0x3e7937});}catch(_0x4c7c58){console[_0x311085(0x1d4)](_0x4c7c58);}}),router['post'](a0_0x54b10c(0x21c),async(_0x4a619a,_0x2964e4)=>{var _0x7183fc=a0_0x54b10c;const {product_code:_0x158530,warehouse_name:_0x38cca,rooms_data:_0x178bac,Roomslist:_0x209971}=_0x4a619a['body'],_0x288e1e=_0x209971[_0x7183fc(0x259)](','),_0x7fd56c=[];async function _0x42612b(_0x108e6b){var _0x3e9013=_0x7183fc;const _0x20c2e6=await warehouse[_0x3e9013(0x1d9)]([{'$match':{'name':_0x38cca,'room':_0x108e6b}},{'$unwind':_0x3e9013(0x293)},{'$match':{'product_details.primary_code':_0x158530}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3e9013(0x1d2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3e9013(0x2a1)},'pallet':{'$first':_0x3e9013(0x25a)},'unit':{'$first':_0x3e9013(0x1ad)},'secondary_unit':{'$first':_0x3e9013(0x280)},'storage':{'$first':_0x3e9013(0x1ab)},'rack':{'$first':_0x3e9013(0x21e)},'expiry_date':{'$first':_0x3e9013(0x23b)},'production_date':{'$first':_0x3e9013(0x24a)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x3e9013(0x1e1)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3e9013(0x1d8)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x45ab53=await warehouse[_0x3e9013(0x1d9)]([{'$match':{'name':_0x38cca,'room':_0x108e6b}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x158530}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3e9013(0x1ff)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3e9013(0x1d2)},'product_code':{'$first':_0x3e9013(0x291)},'level':{'$first':_0x3e9013(0x2a7)},'isle':{'$first':_0x3e9013(0x1df)},'type':{'$first':_0x3e9013(0x2a1)},'pallet':{'$first':_0x3e9013(0x25a)},'unit':{'$first':_0x3e9013(0x1ad)},'secondary_unit':{'$first':_0x3e9013(0x280)},'storage':{'$first':_0x3e9013(0x1ab)},'rack':{'$first':_0x3e9013(0x21e)},'expiry_date':{'$first':_0x3e9013(0x23b)},'production_date':{'$first':_0x3e9013(0x24a)},'maxPerUnit':{'$first':_0x3e9013(0x1dd)},'batch_code':{'$first':_0x3e9013(0x2be)},'product_cat':{'$first':_0x3e9013(0x1e1)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3e9013(0x1d8)},'invoice':{'$first':_0x3e9013(0x1cb)}}}]);if(_0x20c2e6[_0x3e9013(0x23e)]>0x0)_0x7fd56c[_0x3e9013(0x204)](_0x20c2e6);else _0x45ab53['length']>0x0&&_0x7fd56c[_0x3e9013(0x204)](_0x45ab53);}const _0x7afe23=_0x288e1e[_0x7183fc(0x2b8)](_0x26cece=>_0x42612b(_0x26cece));await Promise[_0x7183fc(0x20d)](_0x7afe23),_0x2964e4[_0x7183fc(0x26f)](_0x7fd56c);}),module[a0_0x54b10c(0x1bf)]=router;