function a0_0x2d40(_0x4a8ab6,_0x5cca62){var _0x4b006e=a0_0x4b00();return a0_0x2d40=function(_0x2d4092,_0x4e929b){_0x2d4092=_0x2d4092-0x1d4;var _0x314ba4=_0x4b006e[_0x2d4092];return _0x314ba4;},a0_0x2d40(_0x4a8ab6,_0x5cca62);}function a0_0x4b00(){var _0x36e30d=['slice','user','customers_docs','add_sales_finished','OUTF-','level','sendMail','save','$product_details.maxPerUnit','Quality\x20Inspection','Router','out_invoice','bay','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$sale_product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','push','carton','Sale','createTransport','final','concat','product_code_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','../models/all_models','Sales\x20Mail','length','FGSEmail','barcode\x20user_id','random','/view/add_sales','True','$product_details.bin','get','$product_details.product_name','role','adjust_qty','</table>','$product_details.bay','/invoice/:id','success','all_sales_barcode','German','batch_code','findById','product_name','<tbody\x20style=\x22text-align:\x20center;\x22>','production_date','$note','931684JNfwoq','<h5>','$sale_product.bay','/view/return_sales/:id','$name','getDate','$product_details.production_date','$sale_product.floorlevel','maxPerUnit','stock','Sale\x20Return','error','\x20Order\x20Date\x20:\x20','render','quantity','RoomAssigned','$product_details._id','return_sale','</body></html>','An\x20error\x20occurred\x20while\x20saving\x20data.','English','</div>','all_sales_finished','suppliers','False','$product_details','Portuguese','sales\x20item\x20return\x20successfull','exports','sale_qty','expiry_date','/all_sales_finished/view','sale_product','Ambient','production_date_QA','QA\x20Warehouse','<span\x20style=\x22float:\x20right;\x22>','sales_quantity','/upload/','max','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','purchases_data','primary_code','map','return_qty_QA','$product_details.unit','Finished\x20Goods','maxProducts','$product_details.primary_code','find','An\x20error\x20occurred.','back','$date','password','message','<h5\x20style=\x22text-align:\x20left;\x22>','<div>','Enclosed','$product_details.expiry_date','room_name','Hindi','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','product_data','$finalize','received_amount','$product_details.type','../public/language/languages.json','DRY\x20GOODS','floor','log','Logo.png','<hr\x20class=\x22my-3\x22>','all','image','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','params','There\x27s\x20a\x20error\x20in\x20this\x20transaction','stocks_QA','../middleware/auth','warehouse','logo','body','Received\x20Payment\x20For\x20Sale','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','customer_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','Sales\x20Add\x20successfully','/../public','status','gmail','Chinese','redirect','</tbody>','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','aggregate','prod_cat','_id','3326407GqTXrf','$product_details.storage','/barcode/:id','warehouse_name','product_stock','$_id','$product_details.rack','secondary_code_QA','/all_sales/view','</head><body>','staff','language','Arabic\x20(ae)','catch','</td>','<!DOCTYPE\x20html>','expiry_date_QA','$sale_product.quantity','string','Spanish','</h5>','return_sale_finished','return_data','$sale_product.type','Error\x20Occurs','$product.product_name','json','secondary_unit','product_details','currency_placement','Return\x20Goods','nodemailer','split','English\x20(US)','$return_data','3557328BtPxeL','primary_unit','currency','express','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','17425afAZgu','note','sales_quantity_QA','/preview/:id','forEach','<html><head><title></title>','return_qty','Portuguese\x20(BR)','product_list','/all_sales_finished/preview/','prod_code','$product_details.batch_code','batch_code_QA','flash','unit_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','product_code','</thead>','10ESTesC','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','766RWEQDH','maxperunit','$product','$product_details.product_cat','filter','/view','Sale\x20Return\x20Mail','<tr>','toString','\x20</h2>','1941138mFOnqy','$room','name','$product_details.secondary_unit','258aXGyih','errors','invoice','<strong>\x20Regards\x20</strong>','abs','Arabic','product_name_QA1','edit_sales_finished_view','Enabled','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','prod_invoice','\x20<>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.secondary_code','\x20Order\x20Number\x20:\x20','Sales\x20Update\x20successfully','getMonth','post','padStart','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','site_title','unit','id_transaction_from','master','maxPerUnit_QA','1356255fWqzaY','customers','finalize','<h2>\x20','room','$product_details.invoice','French','max_per_unit','$product_details.product_code','due_amount','port','$customers_docs','product_date','</tr>','$product_details.floorlevel','payment\x20successfull','$product_details.product_stock','secondary_unit_QA','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$customer','</span>','primary_code_QA','host','Email\x20sent\x20successfully','findOne','secondary_code','/picking_list/pdf/','maxProducts_QA','then','amount','customer'];a0_0x4b00=function(){return _0x36e30d;};return a0_0x4b00();}var a0_0x1b1201=a0_0x2d40;(function(_0x4088ba,_0x3d9e8e){var _0x45c0cc=a0_0x2d40,_0x5a5963=_0x4088ba();while(!![]){try{var _0x56ed52=parseInt(_0x45c0cc(0x1e5))/0x1*(-parseInt(_0x45c0cc(0x1e7))/0x2)+-parseInt(_0x45c0cc(0x1f1))/0x3+parseInt(_0x45c0cc(0x25e))/0x4+parseInt(_0x45c0cc(0x2e9))/0x5*(parseInt(_0x45c0cc(0x1f5))/0x6)+parseInt(_0x45c0cc(0x2c1))/0x7+parseInt(_0x45c0cc(0x2e4))/0x8+-parseInt(_0x45c0cc(0x20e))/0x9;if(_0x56ed52===_0x3d9e8e)break;else _0x5a5963['push'](_0x5a5963['shift']());}catch(_0x1f24b8){_0x5a5963['push'](_0x5a5963['shift']());}}}(a0_0x4b00,0x7a550));const express=require(a0_0x1b1201(0x2e7)),app=express(),router=express[a0_0x1b1201(0x237)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x1b1201(0x245)),auth=require(a0_0x1b1201(0x2ad)),nodemailer=require(a0_0x1b1201(0x2e0)),users=require(a0_0x1b1201(0x2a0));router['get'](a0_0x1b1201(0x1ec),auth,async(_0x4968c8,_0x536cdf)=>{var _0x6fe39c=a0_0x1b1201;try{const {username:_0x2dc17c,email:_0x62cf5d,role:_0x3193c0}=_0x4968c8[_0x6fe39c(0x22e)],_0x2d4227=_0x4968c8[_0x6fe39c(0x22e)],_0x1c8f9c=await profile[_0x6fe39c(0x226)]({'email':_0x2d4227['email']}),_0x3ddf8b=await master_shop['find']();let _0x153d44;if(_0x2d4227[_0x6fe39c(0x250)]==_0x6fe39c(0x2cb)){const _0x2e2d78=await staff['findOne']({'email':_0x2d4227['email']});_0x153d44=await sales_finished[_0x6fe39c(0x2be)]([{'$lookup':{'from':'customers','localField':_0x6fe39c(0x22c),'foreignField':_0x6fe39c(0x1f3),'as':_0x6fe39c(0x22f)}},{'$unwind':_0x6fe39c(0x219)},{'$unwind':_0x6fe39c(0x23b)},{'$group':{'_id':_0x6fe39c(0x2c6),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x6fe39c(0x221)},'date':{'$first':_0x6fe39c(0x292)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x6fe39c(0x23b)},'note':{'$first':_0x6fe39c(0x25d)},'return_data':{'$first':_0x6fe39c(0x2e3)},'customers_docs':{'$first':_0x6fe39c(0x219)},'total_saleproduct_quantity':{'$sum':_0x6fe39c(0x2d2)},'level':{'$addToSet':_0x6fe39c(0x260)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x6fe39c(0x2d8)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x153d44=await sales_finished[_0x6fe39c(0x2be)]([{'$lookup':{'from':_0x6fe39c(0x20f),'localField':_0x6fe39c(0x22c),'foreignField':_0x6fe39c(0x1f3),'as':_0x6fe39c(0x22f)}},{'$unwind':_0x6fe39c(0x219)},{'$unwind':_0x6fe39c(0x23b)},{'$group':{'_id':_0x6fe39c(0x2c6),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x6fe39c(0x221)},'date':{'$first':_0x6fe39c(0x292)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':'$note'},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x6fe39c(0x219)},'total_saleproduct_quantity':{'$sum':_0x6fe39c(0x2d2)},'level':{'$addToSet':_0x6fe39c(0x260)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x6fe39c(0x2d8)},'pallet':{'$addToSet':_0x6fe39c(0x265)},'finalize':{'$first':_0x6fe39c(0x29d)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x3ddf8b[0x0]['language']=='English\x20(US)'){var _0x3b25f2=users['English'];console[_0x6fe39c(0x2a3)](_0x3b25f2);}else{if(_0x3ddf8b[0x0][_0x6fe39c(0x2cc)]==_0x6fe39c(0x29a))var _0x3b25f2=users['Hindi'];else{if(_0x3ddf8b[0x0][_0x6fe39c(0x2cc)]==_0x6fe39c(0x257))var _0x3b25f2=users[_0x6fe39c(0x257)];else{if(_0x3ddf8b[0x0][_0x6fe39c(0x2cc)]=='Spanish')var _0x3b25f2=users[_0x6fe39c(0x2d4)];else{if(_0x3ddf8b[0x0][_0x6fe39c(0x2cc)]==_0x6fe39c(0x214))var _0x3b25f2=users[_0x6fe39c(0x214)];else{if(_0x3ddf8b[0x0][_0x6fe39c(0x2cc)]==_0x6fe39c(0x1da))var _0x3b25f2=users[_0x6fe39c(0x278)];else{if(_0x3ddf8b[0x0][_0x6fe39c(0x2cc)]==_0x6fe39c(0x2b9))var _0x3b25f2=users[_0x6fe39c(0x2b9)];else{if(_0x3ddf8b[0x0][_0x6fe39c(0x2cc)]=='Arabic\x20(ae)')var _0x3b25f2=users[_0x6fe39c(0x1fa)];}}}}}}}_0x536cdf[_0x6fe39c(0x26b)](_0x6fe39c(0x274),{'success':_0x4968c8['flash']('success'),'errors':_0x4968c8[_0x6fe39c(0x1e0)]('errors'),'sales':_0x153d44,'profile':_0x1c8f9c,'role':_0x2d4227,'master_shop':_0x3ddf8b,'language':_0x3b25f2});}catch(_0x1ca563){console['log'](_0x1ca563);}});async function getRandom8DigitNumber(){var _0x37a0b1=a0_0x1b1201;const _0x4f196a=0x989680,_0x143bfb=0x5f5e0ff,_0x5abe6b=Math[_0x37a0b1(0x2a2)](Math[_0x37a0b1(0x24a)]()*(_0x143bfb-_0x4f196a+0x1))+_0x4f196a;var _0x23cf3b;const _0x12cd6a=await sales_finished['findOne']({'invoice':_0x37a0b1(0x231)+_0x5abe6b});return _0x12cd6a&&_0x12cd6a[_0x37a0b1(0x247)]>0x0?_0x23cf3b=_0x37a0b1(0x231)+_0x5abe6b:_0x23cf3b='OUTF-'+_0x5abe6b,_0x23cf3b;}router[a0_0x1b1201(0x24e)](a0_0x1b1201(0x24b),auth,async(_0x4488c2,_0x565071)=>{var _0x2984ed=a0_0x1b1201;try{const {username:_0x3f7b2d,email:_0x4939a6,role:_0x1a947c}=_0x4488c2[_0x2984ed(0x22e)],_0x72fdd7=_0x4488c2[_0x2984ed(0x22e)],_0x2d1029=await profile[_0x2984ed(0x226)]({'email':_0x72fdd7['email']}),_0x3c7534=await master_shop[_0x2984ed(0x28f)](),_0x428c5f=await customer['find']({});let _0x13df4e;if(_0x72fdd7[_0x2984ed(0x250)]==_0x2984ed(0x2cb)){const _0x46f108=await staff['findOne']({'email':_0x72fdd7[_0x2984ed(0x2bc)]});_0x13df4e=await warehouse['aggregate']([{'$match':{'status':_0x2984ed(0x1fd),'name':_0x46f108[_0x2984ed(0x2ae)],'warehouse_category':_0x2984ed(0x28c),'name':{'$ne':_0x2984ed(0x281)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x13df4e=await warehouse[_0x2984ed(0x2be)]([{'$match':{'status':_0x2984ed(0x1fd),'warehouse_category':_0x2984ed(0x28c),'name':{'$ne':_0x2984ed(0x281)}}},{'$group':{'_id':_0x2984ed(0x262),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x201538=await product['find']({});var _0x6a80b2=[_0x2984ed(0x27f),_0x2984ed(0x297)];const _0x31c7e0=await sales_finished['find']({}),_0x25346e=_0x31c7e0[_0x2984ed(0x247)]+0x1,_0x11cdd6=_0x2984ed(0x231)+_0x25346e[_0x2984ed(0x1ef)]()[_0x2984ed(0x207)](0x5,'0');if(_0x3c7534[0x0][_0x2984ed(0x2cc)]==_0x2984ed(0x2e2)){var _0x3c4567=users[_0x2984ed(0x272)];console[_0x2984ed(0x2a3)](_0x3c4567);}else{if(_0x3c7534[0x0]['language']=='Hindi')var _0x3c4567=users['Hindi'];else{if(_0x3c7534[0x0]['language']==_0x2984ed(0x257))var _0x3c4567=users[_0x2984ed(0x257)];else{if(_0x3c7534[0x0][_0x2984ed(0x2cc)]=='Spanish')var _0x3c4567=users['Spanish'];else{if(_0x3c7534[0x0]['language']==_0x2984ed(0x214))var _0x3c4567=users[_0x2984ed(0x214)];else{if(_0x3c7534[0x0]['language']=='Portuguese\x20(BR)')var _0x3c4567=users[_0x2984ed(0x278)];else{if(_0x3c7534[0x0][_0x2984ed(0x2cc)]==_0x2984ed(0x2b9))var _0x3c4567=users[_0x2984ed(0x2b9)];else{if(_0x3c7534[0x0][_0x2984ed(0x2cc)]=='Arabic\x20(ae)')var _0x3c4567=users[_0x2984ed(0x1fa)];}}}}}}}const _0x2a95aa=getRandom8DigitNumber();_0x2a95aa[_0x2984ed(0x22a)](_0x4e5a8d=>{var _0x2ab68f=_0x2984ed;_0x565071[_0x2ab68f(0x26b)](_0x2ab68f(0x230),{'success':_0x4488c2[_0x2ab68f(0x1e0)](_0x2ab68f(0x255)),'errors':_0x4488c2[_0x2ab68f(0x1e0)](_0x2ab68f(0x1f6)),'role':_0x72fdd7,'profile':_0x2d1029,'customer':_0x428c5f,'warehouse':_0x13df4e,'product':_0x201538,'invoice':_0x4e5a8d,'master_shop':_0x3c7534,'language':_0x3c4567,'rooms_data':_0x6a80b2});})[_0x2984ed(0x2ce)](_0x582c1a=>{var _0x4c6da0=_0x2984ed;_0x4488c2[_0x4c6da0(0x1e0)](_0x4c6da0(0x1f6),_0x4c6da0(0x2ab)),_0x565071[_0x4c6da0(0x2ba)](_0x4c6da0(0x27d));});}catch(_0x53bec2){console['log'](_0x53bec2);}}),router[a0_0x1b1201(0x24e)]('/view/add_sales/:id',auth,async(_0x4203da,_0x53f1b0)=>{var _0x25b75b=a0_0x1b1201;try{const _0x2895f0=_0x4203da[_0x25b75b(0x2aa)]['id'];console[_0x25b75b(0x2a3)](_0x2895f0);const _0x4b2acc=await product[_0x25b75b(0x28f)](),_0x39a7d2=await purchases[_0x25b75b(0x2be)]([{'$match':{'warehouse_name':_0x2895f0}},{'$unwind':_0x25b75b(0x1e9)},{'$group':{'_id':_0x25b75b(0x2da)}}]);console['log'](_0x25b75b(0x287),_0x39a7d2),_0x53f1b0[_0x25b75b(0x2b7)](0xc8)[_0x25b75b(0x2db)]({'purchases_data':_0x39a7d2,'product_data':_0x4b2acc});}catch(_0xea44e7){console[_0x25b75b(0x2a3)](_0xea44e7);}}),router['post']('/view/add_sale/product',auth,async(_0x777f0e,_0x5285e5)=>{var _0x59b452=a0_0x1b1201;try{const {warehouse_data:_0x25306a,product_data:_0x229484}=_0x777f0e[_0x59b452(0x2b0)];console[_0x59b452(0x2a3)](_0x777f0e[_0x59b452(0x2b0)][_0x59b452(0x29c)]);;const _0x58a706=await master_shop[_0x59b452(0x28f)]();console[_0x59b452(0x2a3)](_0x59b452(0x20c),_0x58a706);const _0x8c16b2=await product['findOne']({'name':_0x229484});console[_0x59b452(0x2a3)](_0x59b452(0x2a8),_0x8c16b2);const _0x1c9d71=await warehouse[_0x59b452(0x2be)]([{'$match':{'name':_0x25306a}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x229484}},{'$group':{'_id':_0x59b452(0x24f),'product_stock':{'$first':'$product_details.product_stock'}}}]);console[_0x59b452(0x2a3)]('stock_data',_0x1c9d71),_0x5285e5[_0x59b452(0x2b7)](0xc8)['json']({'master':_0x58a706,'new_product':_0x8c16b2,'stock_data':_0x1c9d71});}catch(_0x32b30e){console['log'](_0x32b30e);}}),router[a0_0x1b1201(0x206)]('/view/add_sales',auth,async(_0x4fae5e,_0x44e70f)=>{var _0x3e8a6f=a0_0x1b1201;try{const {invoice:_0x283b95,date:_0x1b4458,warehouse_name:_0x1104c3,product_name:_0x4f148f,stock:_0x58b6a7,quantity:_0x423701,note:_0x292dd0,room:_0x3e65a1,primary_code:_0x1e0011,secondary_code:_0x4634bc,prod_code:_0x14d23c,level:_0x13e175,isle:_0x424407,pallet:_0x464fd0,batch_code:_0x19c6cb,SCRN:_0x1f0d77,expiry_date:_0x3c25f3,mode_transpo:_0x2780fb,name_driver:_0x49d066}=_0x4fae5e[_0x3e8a6f(0x2b0)];if(typeof _0x4f148f==_0x3e8a6f(0x2d3))var _0x1d0056=[_0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x25a)]],_0x1a020b=[_0x4fae5e['body']['stock']],_0xdd0779=[_0x4fae5e['body'][_0x3e8a6f(0x23e)]],_0x1b4b1d=[_0x4fae5e[_0x3e8a6f(0x2b0)]['primary_code']],_0x34335f=[_0x4fae5e[_0x3e8a6f(0x2b0)]['secondary_code']],_0x296c2c=[_0x4fae5e[_0x3e8a6f(0x2b0)]['prod_code']],_0x50f93a=[_0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x232)]],_0x1fafd1=[_0x4fae5e['body'][_0x3e8a6f(0x2e5)]],_0x5bad34=[_0x4fae5e['body'][_0x3e8a6f(0x2dc)]],_0x47cc37=[_0x4fae5e[_0x3e8a6f(0x2b0)]['batch_code']],_0x45e126=[_0x4fae5e[_0x3e8a6f(0x2b0)]['expiry_date']],_0x1d9114=[_0x4fae5e['body'][_0x3e8a6f(0x21a)]],_0x4acba2=[_0x4fae5e[_0x3e8a6f(0x2b0)]['max_per_unit']],_0x34504f=[_0x4fae5e['body']['prod_cat']],_0x30db98=[_0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x26d)]],_0x752a66=[_0x4fae5e[_0x3e8a6f(0x2b0)]['prod_invoice']],_0x5ea947=[_0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x20b)]];else var _0x1d0056=[..._0x4fae5e['body']['product_name']],_0x1a020b=[..._0x4fae5e[_0x3e8a6f(0x2b0)]['stock']],_0xdd0779=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x23e)]],_0x1b4b1d=[..._0x4fae5e[_0x3e8a6f(0x2b0)]['primary_code']],_0x34335f=[..._0x4fae5e['body'][_0x3e8a6f(0x227)]],_0x296c2c=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x1dd)]],_0x50f93a=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x232)]],_0x1fafd1=[..._0x4fae5e[_0x3e8a6f(0x2b0)]['primary_unit']],_0x5bad34=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x2dc)]],_0x47cc37=[..._0x4fae5e['body'][_0x3e8a6f(0x258)]],_0x45e126=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x27c)]],_0x1d9114=[..._0x4fae5e['body']['product_date']],_0x4acba2=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x215)]],_0x34504f=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x2bf)]],_0x30db98=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x26d)]],_0x752a66=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x1ff)]],_0x5ea947=[..._0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x20b)]];const _0x3386bc=_0x1d0056[_0x3e8a6f(0x289)](_0x1ea280=>{return _0x1ea280={'product_name':_0x1ea280};});_0x1a020b[_0x3e8a6f(0x1d7)]((_0x2c74d4,_0x221945)=>{var _0xa783e1=_0x3e8a6f;_0x3386bc[_0x221945][_0xa783e1(0x267)]=_0x2c74d4;}),_0xdd0779[_0x3e8a6f(0x1d7)]((_0x2d7754,_0x3be6bd)=>{var _0xeb73a=_0x3e8a6f;_0x3386bc[_0x3be6bd]['quantity']=Math[_0xeb73a(0x1f9)](_0x2d7754);}),_0x5ea947[_0x3e8a6f(0x1d7)]((_0x491a1a,_0x4c6e76)=>{_0x3386bc[_0x4c6e76]['id_transaction_from']=_0x491a1a;}),_0x1b4b1d[_0x3e8a6f(0x1d7)]((_0x331c74,_0x10179f)=>{var _0x33a528=_0x3e8a6f;_0x3386bc[_0x10179f][_0x33a528(0x288)]=_0x331c74;}),_0x34335f[_0x3e8a6f(0x1d7)]((_0x26f520,_0x2e0fbc)=>{var _0xb5bb1a=_0x3e8a6f;_0x3386bc[_0x2e0fbc][_0xb5bb1a(0x227)]=_0x26f520;}),_0x296c2c['forEach']((_0x44c39f,_0x200b55)=>{_0x3386bc[_0x200b55]['product_code']=_0x44c39f,_0x3386bc[_0x200b55]['date_data']=_0x1b4458;}),_0x50f93a[_0x3e8a6f(0x1d7)]((_0x579228,_0x16f8ca)=>{var _0x802482=_0x3e8a6f;_0x3386bc[_0x16f8ca][_0x802482(0x239)]=_0x579228;}),_0x1fafd1[_0x3e8a6f(0x1d7)]((_0x42d954,_0x150a65)=>{_0x3386bc[_0x150a65]['unit']=_0x42d954;}),_0x5bad34['forEach']((_0x51a5e6,_0x365064)=>{var _0x5d7954=_0x3e8a6f;_0x3386bc[_0x365064][_0x5d7954(0x2dc)]=_0x51a5e6;}),_0x47cc37[_0x3e8a6f(0x1d7)]((_0x4aeeca,_0x237e55)=>{var _0x56cc4c=_0x3e8a6f;_0x3386bc[_0x237e55][_0x56cc4c(0x258)]=_0x4aeeca;}),_0x45e126[_0x3e8a6f(0x1d7)]((_0x3ba25f,_0x40736e)=>{var _0x4fa002=_0x3e8a6f;_0x3386bc[_0x40736e][_0x4fa002(0x27c)]=_0x3ba25f;}),_0x1d9114['forEach']((_0x39bd7e,_0x2068f5)=>{_0x3386bc[_0x2068f5]['production_date']=_0x39bd7e;}),_0x4acba2[_0x3e8a6f(0x1d7)]((_0x3e1f76,_0x55843c)=>{var _0x185135=_0x3e8a6f;_0x3386bc[_0x55843c][_0x185135(0x1e8)]=_0x3e1f76;}),_0x34504f[_0x3e8a6f(0x1d7)]((_0x27601a,_0x5e7559)=>{var _0x378b02=_0x3e8a6f;_0x3386bc[_0x5e7559][_0x378b02(0x2bf)]=_0x27601a;}),_0x30db98[_0x3e8a6f(0x1d7)]((_0x7001d,_0x5e4c46)=>{var _0x5ccf79=_0x3e8a6f;_0x3386bc[_0x5e4c46][_0x5ccf79(0x299)]=_0x7001d;}),_0x752a66['forEach']((_0x578865,_0x23da58)=>{var _0x5a4237=_0x3e8a6f;_0x3386bc[_0x23da58][_0x5a4237(0x1f7)]=_0x578865;});var _0x580490=0x0;_0x3386bc[_0x3e8a6f(0x1d7)](_0xb62f1d=>{var _0x1e6f20=_0x3e8a6f;parseFloat(_0xb62f1d[_0x1e6f20(0x267)])<parseFloat(_0xb62f1d[_0x1e6f20(0x26c)])&&parseFloat(_0xb62f1d['quantity'])>parseFloat(_0xb62f1d['stock'])&&(console['log'](_0xb62f1d[_0x1e6f20(0x267)]+_0x1e6f20(0x200)+_0xb62f1d[_0x1e6f20(0x26c)]),_0x580490++);});if(_0x580490!=0x0)return _0x4fae5e[_0x3e8a6f(0x1e0)](_0x3e8a6f(0x1f6),'Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty'),_0x44e70f[_0x3e8a6f(0x2ba)]('back');const _0x59fa55=_0x3386bc['filter'](_0x5d13c8=>_0x5d13c8[_0x3e8a6f(0x26c)]!=='0'&&_0x5d13c8[_0x3e8a6f(0x26c)]!==''),_0x110db0=new sales_finished({'invoice':_0x283b95,'customer':_0x4fae5e['body'][_0x3e8a6f(0x22c)],'date':_0x1b4458,'warehouse_name':_0x1104c3,'sale_product':_0x59fa55,'note':_0x292dd0,'room':_0x3e65a1,'primary_code':_0x1e0011,'secondary_code':_0x4634bc,'prod_code':_0x14d23c,'SCRN':_0x1f0d77,'finalize':_0x3e8a6f(0x276),'mode_transpo':_0x2780fb,'name_driver':_0x49d066}),_0xa5513e=await _0x110db0[_0x3e8a6f(0x234)](),_0x3f4a94=await sales_finished['findOne']({'invoice':_0x283b95}),_0x5038ee=new c_payment_data({'invoice':_0x283b95,'customer':_0x4fae5e['body']['customer'],'reason':_0x3e8a6f(0x23f)});await _0x5038ee[_0x3e8a6f(0x234)]();const _0x3b97eb=await master_shop[_0x3e8a6f(0x28f)](),_0x4b09ed=await email_settings[_0x3e8a6f(0x226)](),_0x3d0e44=await customer[_0x3e8a6f(0x226)]({'name':_0x4fae5e[_0x3e8a6f(0x2b0)][_0x3e8a6f(0x22c)]});_0x3b97eb[0x0][_0x3e8a6f(0x2de)]==0x1?(right_currency=_0x3b97eb[0x0][_0x3e8a6f(0x2e6)],left_currency=''):(right_currency='',left_currency=_0x3b97eb[0x0]['currency']);var _0x30c602=_0x1d0056,_0x2ea6d9=_0xdd0779,_0x3aa365='',_0x11e77d;for(_0x11e77d in _0x30c602){_0x3aa365+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x30c602[_0x11e77d]+_0x3e8a6f(0x2cf)+_0x3e8a6f(0x23a)+_0x2ea6d9[_0x11e77d]+_0x3e8a6f(0x2cf)+'</tr>';}console[_0x3e8a6f(0x2a3)](_0x3e8a6f(0x1db),_0x3aa365),_0x4fae5e[_0x3e8a6f(0x1e0)](_0x3e8a6f(0x255),_0x3e8a6f(0x2b5)),_0x44e70f[_0x3e8a6f(0x2ba)](_0x3e8a6f(0x1dc)+_0xa5513e['_id']);}catch(_0x44ecd0){console[_0x3e8a6f(0x2a3)](_0x44ecd0);}}),router['get'](a0_0x1b1201(0x1d6),auth,async(_0x2ee435,_0x56227e)=>{var _0x442c4c=a0_0x1b1201;try{const {username:_0x5e4452,email:_0x11072c,role:_0x49cc60}=_0x2ee435[_0x442c4c(0x22e)],_0x1fc60b=_0x2ee435[_0x442c4c(0x22e)],_0x22d992=await profile[_0x442c4c(0x226)]({'email':_0x1fc60b[_0x442c4c(0x2bc)]}),_0x592f4f=await master_shop['find'](),_0x36d51b=_0x2ee435[_0x442c4c(0x2aa)]['id'],_0x1688df=await sales_finished['findById'](_0x36d51b),_0x58d1be=await warehouse['aggregate']([{'$match':{'name':_0x1688df['warehouse_name']}},{'$unwind':_0x442c4c(0x277)},{'$group':{'_id':_0x442c4c(0x26e),'name':{'$first':_0x442c4c(0x24f)},'product_stock':{'$first':_0x442c4c(0x21e)},'bay':{'$first':_0x442c4c(0x253)},'bin':{'$first':_0x442c4c(0x24d)},'type':{'$first':_0x442c4c(0x29f)},'floorlevel':{'$first':_0x442c4c(0x21c)},'primary_code':{'$first':_0x442c4c(0x28e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x442c4c(0x2c2)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x442c4c(0x298)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x442c4c(0x1de)},'room':{'$first':_0x442c4c(0x1f2)},'room_data':{'$first':'$product_details.room_name'}}}]),_0x42467c=await customer[_0x442c4c(0x28f)]({});let _0x5ad7ea;if(_0x1fc60b[_0x442c4c(0x250)]==_0x442c4c(0x2cb)){const _0x1fdfc7=await staff[_0x442c4c(0x226)]({'email':_0x1fc60b[_0x442c4c(0x2bc)]});_0x5ad7ea=await warehouse[_0x442c4c(0x2be)]([{'$match':{'status':_0x442c4c(0x1fd),'name':_0x1fdfc7[_0x442c4c(0x2ae)]}},{'$group':{'_id':'$name','name':{'$first':_0x442c4c(0x262)}}}]);}else _0x5ad7ea=await warehouse[_0x442c4c(0x2be)]([{'$match':{'status':_0x442c4c(0x1fd)}},{'$group':{'_id':_0x442c4c(0x262),'name':{'$first':_0x442c4c(0x262)}}}]);const _0x2c58b8=await product[_0x442c4c(0x28f)]({});if(_0x592f4f[0x0][_0x442c4c(0x2cc)]==_0x442c4c(0x2e2)){var _0x4ebb7a=users[_0x442c4c(0x272)];console[_0x442c4c(0x2a3)](_0x4ebb7a);}else{if(_0x592f4f[0x0]['language']=='Hindi')var _0x4ebb7a=users[_0x442c4c(0x29a)];else{if(_0x592f4f[0x0][_0x442c4c(0x2cc)]==_0x442c4c(0x257))var _0x4ebb7a=users['German'];else{if(_0x592f4f[0x0]['language']==_0x442c4c(0x2d4))var _0x4ebb7a=users[_0x442c4c(0x2d4)];else{if(_0x592f4f[0x0][_0x442c4c(0x2cc)]==_0x442c4c(0x214))var _0x4ebb7a=users[_0x442c4c(0x214)];else{if(_0x592f4f[0x0][_0x442c4c(0x2cc)]==_0x442c4c(0x1da))var _0x4ebb7a=users[_0x442c4c(0x278)];else{if(_0x592f4f[0x0][_0x442c4c(0x2cc)]==_0x442c4c(0x2b9))var _0x4ebb7a=users[_0x442c4c(0x2b9)];else{if(_0x592f4f[0x0][_0x442c4c(0x2cc)]==_0x442c4c(0x2cd))var _0x4ebb7a=users[_0x442c4c(0x1fa)];}}}}}}}_0x56227e[_0x442c4c(0x26b)](_0x442c4c(0x1fc),{'success':_0x2ee435[_0x442c4c(0x1e0)]('success'),'errors':_0x2ee435[_0x442c4c(0x1e0)]('errors'),'role':_0x1fc60b,'profile':_0x22d992,'customer':_0x42467c,'warehouse':_0x5ad7ea,'product':_0x58d1be,'user':_0x1688df,'master_shop':_0x592f4f,'unit':_0x2c58b8,'language':_0x4ebb7a});}catch(_0xfe69e3){console[_0x442c4c(0x2a3)](_0xfe69e3);}}),router[a0_0x1b1201(0x206)]('/preview/:id',auth,async(_0x812635,_0x236387)=>{var _0x3144a7=a0_0x1b1201;try{const _0x3ef923=_0x812635['params']['id'],{invoice:_0x12b6b6,warehouse_name:_0x2282dd,room:_0x1ea8ed}=_0x812635[_0x3144a7(0x2b0)],_0x4fb026=await sales_finished[_0x3144a7(0x226)]({'invoice':_0x12b6b6}),_0x14772a=_0x4fb026[_0x3144a7(0x27e)][_0x3144a7(0x289)](async _0x3dc038=>{var _0x52203f=_0x3144a7,_0x2af289=await warehouse[_0x52203f(0x226)]({'name':_0x2282dd,'room':_0x3dc038[_0x52203f(0x299)],'warehouse_category':_0x52203f(0x28c)});const _0x14d033=_0x2af289[_0x52203f(0x2dd)]['map'](_0x1522d0=>{var _0x2f1ad8=_0x52203f;if(_0x1522d0['product_name']==_0x3dc038[_0x2f1ad8(0x25a)]&&_0x1522d0[_0x2f1ad8(0x239)]==_0x3dc038['bay']&&_0x1522d0[_0x2f1ad8(0x27c)]==_0x3dc038[_0x2f1ad8(0x27c)]&&_0x1522d0['production_date']==_0x3dc038['production_date']&&_0x1522d0[_0x2f1ad8(0x258)]==_0x3dc038[_0x2f1ad8(0x258)]&&_0x1522d0[_0x2f1ad8(0x2c0)]==_0x3dc038['id_transaction_from']){if(_0x1522d0[_0x2f1ad8(0x2c5)]>0x0){_0x1522d0[_0x2f1ad8(0x2c5)]=Math[_0x2f1ad8(0x285)](0x0,Math[_0x2f1ad8(0x1f9)](_0x1522d0['product_stock'])-Math['abs'](_0x3dc038['quantity']));if(_0x1522d0[_0x2f1ad8(0x238)]==undefined)_0x1522d0[_0x2f1ad8(0x238)]=_0x12b6b6+'~';else{var _0x6db645=_0x1522d0[_0x2f1ad8(0x238)]['split']('~'),_0x176698='';for(let _0x545e5b=0x0;_0x545e5b<=_0x6db645['length']-0x1;_0x545e5b++){const _0x3abbbc=_0x6db645[_0x545e5b];_0x3abbbc[_0x2f1ad8(0x247)]>0x0&&(_0x176698+=_0x3abbbc+'~');}_0x1522d0[_0x2f1ad8(0x238)]=_0x176698;}}}});return console[_0x52203f(0x2a3)](_0x2af289),_0x2af289;});Promise[_0x3144a7(0x2a6)](_0x14772a)[_0x3144a7(0x22a)](async _0x11e917=>{var _0x26478a=_0x3144a7;try{for(const _0x137cea of _0x11e917){await _0x137cea['save']();}_0x4fb026[_0x26478a(0x210)]=_0x26478a(0x24c);const _0x2b7138=await _0x4fb026[_0x26478a(0x234)](),_0x5eb710=await master_shop[_0x26478a(0x28f)](),_0x1c4179=await email_settings[_0x26478a(0x226)](),_0x45a3ca=await supervisor_settings[_0x26478a(0x28f)]();var _0x358823=_0x4fb026[_0x26478a(0x27e)],_0x18e5f='',_0x482c6e;for(_0x482c6e in _0x358823){var _0x1792c0='FG';_0x4fb026['warehouse_name']==_0x26478a(0x2a1)&&(_0x1792c0='DG'),_0x18e5f+=_0x26478a(0x1ee)+_0x26478a(0x23a)+_0x358823[_0x482c6e][_0x26478a(0x25a)]+_0x26478a(0x2cf)+_0x26478a(0x23a)+_0x358823[_0x482c6e][_0x26478a(0x1e3)]+_0x26478a(0x2cf)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x358823[_0x482c6e][_0x26478a(0x26c)]+_0x26478a(0x2cf)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x358823[_0x482c6e][_0x26478a(0x20a)]+'</td>'+_0x26478a(0x23a)+_0x358823[_0x482c6e][_0x26478a(0x2dc)]+_0x26478a(0x2cf)+_0x26478a(0x23a)+_0x4fb026[_0x26478a(0x2c4)]+'</td>'+_0x26478a(0x23a)+_0x358823[_0x482c6e]['room_name']+'</td>'+_0x26478a(0x23a)+_0x1792c0+_0x358823[_0x482c6e][_0x26478a(0x239)]+_0x26478a(0x2cf);}let _0x16a368=nodemailer[_0x26478a(0x240)]({'host':_0x1c4179[_0x26478a(0x224)],'port':Number(_0x1c4179[_0x26478a(0x218)]),'secure':![],'auth':{'user':_0x1c4179[_0x26478a(0x2bc)],'pass':_0x1c4179['password']}}),_0x3a2d12={'from':_0x1c4179[_0x26478a(0x2bc)],'to':_0x45a3ca[0x0][_0x26478a(0x248)],'subject':_0x26478a(0x246),'attachments':[{'filename':_0x26478a(0x2a4),'path':__dirname+_0x26478a(0x2b6)+_0x26478a(0x284)+_0x5eb710[0x0]['image'],'cid':_0x26478a(0x2af)}],'html':_0x26478a(0x2d0)+_0x26478a(0x1d8)+_0x26478a(0x2ca)+_0x26478a(0x296)+_0x26478a(0x286)+_0x26478a(0x296)+_0x26478a(0x2e8)+_0x26478a(0x273)+_0x26478a(0x296)+_0x26478a(0x211)+_0x5eb710[0x0][_0x26478a(0x209)]+_0x26478a(0x1f0)+_0x26478a(0x273)+_0x26478a(0x273)+_0x26478a(0x2a5)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x4fb026[_0x26478a(0x1f7)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x26478a(0x26a)+_0x4fb026['date']+'\x20'+_0x26478a(0x222)+_0x26478a(0x2d5)+_0x26478a(0x273)+_0x26478a(0x220)+_0x26478a(0x208)+_0x26478a(0x1ee)+_0x26478a(0x201)+_0x26478a(0x2bd)+_0x26478a(0x1e6)+_0x26478a(0x1fe)+_0x26478a(0x23c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x26478a(0x2b2)+_0x26478a(0x2a9)+_0x26478a(0x21b)+_0x26478a(0x1e4)+_0x26478a(0x25b)+'\x20'+_0x18e5f+'\x20'+_0x26478a(0x2bb)+'</table>'+_0x26478a(0x296)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x5eb710[0x0][_0x26478a(0x209)]+_0x26478a(0x2d5)+_0x26478a(0x273)+_0x26478a(0x273)+'</body></html>'};_0x16a368[_0x26478a(0x233)](_0x3a2d12,function(_0x137e3d,_0x2b5669){var _0x3fd643=_0x26478a;_0x137e3d?(console['log'](_0x137e3d),console['log'](_0x3fd643(0x2d9))):console[_0x3fd643(0x2a3)]('Email\x20sent\x20successfully');}),_0x812635[_0x26478a(0x1e0)](_0x26478a(0x255),'Sales\x20Update\x20successfully'),_0x236387[_0x26478a(0x2ba)](_0x26478a(0x228)+_0x3ef923);}catch(_0x5b466e){console['error'](_0x5b466e),_0x236387[_0x26478a(0x2b7)](0x1f4)['json']({'error':_0x26478a(0x271)});}})['catch'](_0x1e8e2a=>{var _0x45638e=_0x3144a7;console[_0x45638e(0x269)](_0x1e8e2a),_0x236387[_0x45638e(0x2b7)](0x1f4)[_0x45638e(0x2db)]({'error':_0x45638e(0x290)});});}catch(_0x2ab7c6){console[_0x3144a7(0x2a3)](_0x2ab7c6);}}),router[a0_0x1b1201(0x24e)]('/view/:id',auth,async(_0x54f9ab,_0x58e877)=>{var _0x3a4d33=a0_0x1b1201;try{const {username:_0x2a940c,email:_0x55b022,role:_0x4f0dae}=_0x54f9ab[_0x3a4d33(0x22e)],_0x5c6b85=_0x54f9ab[_0x3a4d33(0x22e)],_0x3d9e99=await profile[_0x3a4d33(0x226)]({'email':_0x5c6b85[_0x3a4d33(0x2bc)]}),_0xa3befa=await master_shop['find'](),_0x4f6e8d=_0x54f9ab['params']['id'],_0x2edc5d=await sales_finished[_0x3a4d33(0x259)](_0x4f6e8d);let _0x1118c9=new Date(_0x2edc5d[_0x3a4d33(0x27c)]),_0x32cf4f=('0'+_0x1118c9[_0x3a4d33(0x263)]())[_0x3a4d33(0x22d)](-0x2),_0x88e179=('0'+(_0x1118c9[_0x3a4d33(0x205)]()+0x1))[_0x3a4d33(0x22d)](-0x2),_0x324d9c=_0x1118c9['getFullYear'](),_0x3703f8=_0x324d9c+'-'+_0x88e179+'-'+_0x32cf4f;var _0x51c220=[_0x3a4d33(0x27f),_0x3a4d33(0x297)];const _0x107ad4=await warehouse[_0x3a4d33(0x2be)]([{'$match':{'name':_0x2edc5d[_0x3a4d33(0x2c4)],'room':_0x2edc5d['room']}},{'$unwind':_0x3a4d33(0x277)},{'$group':{'_id':_0x3a4d33(0x26e),'name':{'$first':_0x3a4d33(0x24f)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3a4d33(0x253)},'bin':{'$first':_0x3a4d33(0x24d)},'type':{'$first':_0x3a4d33(0x29f)},'floorlevel':{'$first':_0x3a4d33(0x21c)},'primary_code':{'$first':_0x3a4d33(0x28e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3a4d33(0x216)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3a4d33(0x2c7)}}}]),_0x12d49c=await customer[_0x3a4d33(0x28f)]({});let _0x5c2017;if(_0x5c6b85[_0x3a4d33(0x250)]==_0x3a4d33(0x2cb)){const _0x22036a=await staff[_0x3a4d33(0x226)]({'email':_0x5c6b85[_0x3a4d33(0x2bc)]});_0x5c2017=await warehouse[_0x3a4d33(0x2be)]([{'$match':{'status':_0x3a4d33(0x1fd),'name':_0x22036a[_0x3a4d33(0x2ae)]}},{'$group':{'_id':_0x3a4d33(0x262),'name':{'$first':'$name'}}}]);}else _0x5c2017=await warehouse[_0x3a4d33(0x2be)]([{'$match':{'status':_0x3a4d33(0x1fd)}},{'$group':{'_id':'$name','name':{'$first':_0x3a4d33(0x262)}}}]);const _0x1138e0=await product[_0x3a4d33(0x28f)]({});if(_0xa3befa[0x0][_0x3a4d33(0x2cc)]==_0x3a4d33(0x2e2)){var _0x5f3909=users[_0x3a4d33(0x272)];console[_0x3a4d33(0x2a3)](_0x5f3909);}else{if(_0xa3befa[0x0][_0x3a4d33(0x2cc)]==_0x3a4d33(0x29a))var _0x5f3909=users['Hindi'];else{if(_0xa3befa[0x0]['language']==_0x3a4d33(0x257))var _0x5f3909=users[_0x3a4d33(0x257)];else{if(_0xa3befa[0x0]['language']==_0x3a4d33(0x2d4))var _0x5f3909=users['Spanish'];else{if(_0xa3befa[0x0][_0x3a4d33(0x2cc)]=='French')var _0x5f3909=users['French'];else{if(_0xa3befa[0x0][_0x3a4d33(0x2cc)]==_0x3a4d33(0x1da))var _0x5f3909=users[_0x3a4d33(0x278)];else{if(_0xa3befa[0x0][_0x3a4d33(0x2cc)]==_0x3a4d33(0x2b9))var _0x5f3909=users[_0x3a4d33(0x2b9)];else{if(_0xa3befa[0x0][_0x3a4d33(0x2cc)]==_0x3a4d33(0x2cd))var _0x5f3909=users[_0x3a4d33(0x1fa)];}}}}}}}_0x58e877[_0x3a4d33(0x26b)]('edit_sales_finished',{'success':_0x54f9ab[_0x3a4d33(0x1e0)](_0x3a4d33(0x255)),'errors':_0x54f9ab[_0x3a4d33(0x1e0)](_0x3a4d33(0x1f6)),'role':_0x5c6b85,'profile':_0x3d9e99,'customer':_0x12d49c,'warehouse':_0x5c2017,'product':_0x107ad4,'user':_0x2edc5d,'master_shop':_0xa3befa,'unit':_0x1138e0,'language':_0x5f3909,'rooms_data':_0x51c220,'ed_fullDate':_0x3703f8});}catch(_0x3d2e0f){console[_0x3a4d33(0x2a3)](_0x3d2e0f);}}),router[a0_0x1b1201(0x206)]('/view/:id',auth,async(_0x232c2e,_0x57a73a)=>{var _0x15faab=a0_0x1b1201;try{const _0xad5545=_0x232c2e[_0x15faab(0x2aa)]['id'],_0xc3ee1f=await sales_finished[_0x15faab(0x226)]({'_id':_0x232c2e['params']['id']}),_0x1ac556=await warehouse[_0x15faab(0x226)]({'name':_0xc3ee1f[_0x15faab(0x2c4)],'room':_0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x212)],'warehouse_category':_0x15faab(0x28c)}),{invoice:_0x183145,customer:_0x446868,date:_0x5d2967,warehouse_name:_0x4bddc3,product_name:_0x1f3582,stock:_0x23a1ce,adjust_qty:_0x58c872,note:_0x36c43c,room:_0x477543,primary_code:_0x454ea8,secondary_code:_0x1f79e2,prod_code:_0x3acb3a,level:_0x555716,isle:_0xd88d17,pallet:_0x587ae0,expiry_date:_0x4fdd88}=_0x232c2e[_0x15faab(0x2b0)];if(typeof _0x1f3582==_0x15faab(0x2d3))var _0x449d93=[_0x232c2e[_0x15faab(0x2b0)]['product_name']],_0x1d34cd=[_0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x267)]],_0x98f41a=[_0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x251)]],_0x15bdf3=[_0x232c2e['body'][_0x15faab(0x288)]],_0x48422a=[_0x232c2e[_0x15faab(0x2b0)]['secondary_code']],_0x694e6f=[_0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x1dd)]],_0x10f73f=[_0x232c2e['body'][_0x15faab(0x232)]],_0x4a6391=[_0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x27c)]];else var _0x449d93=[..._0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x25a)]],_0x1d34cd=[..._0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x267)]],_0x98f41a=[..._0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x251)]],_0x15bdf3=[..._0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x288)]],_0x48422a=[..._0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x227)]],_0x694e6f=[..._0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x1dd)]],_0x10f73f=[..._0x232c2e['body'][_0x15faab(0x232)]],_0x4a6391=[..._0x232c2e['body'][_0x15faab(0x27c)]];const _0x37120b=_0x449d93[_0x15faab(0x289)](_0x4cdea0=>{return _0x4cdea0={'product_name':_0x4cdea0};});_0x1d34cd[_0x15faab(0x1d7)]((_0x3c03cd,_0x2e1863)=>{var _0x35e75e=_0x15faab;_0x37120b[_0x2e1863][_0x35e75e(0x267)]=_0x3c03cd;}),_0x98f41a[_0x15faab(0x1d7)]((_0x271192,_0x2bdee6)=>{_0x37120b[_0x2bdee6]['quantity']=_0x271192;}),_0x15bdf3['forEach']((_0x2be722,_0x2e8f3e)=>{var _0x223117=_0x15faab;_0x37120b[_0x2e8f3e][_0x223117(0x288)]=_0x2be722;}),_0x48422a[_0x15faab(0x1d7)]((_0x5f0289,_0x4ef1bb)=>{var _0x495a07=_0x15faab;_0x37120b[_0x4ef1bb][_0x495a07(0x227)]=_0x5f0289;}),_0x694e6f['forEach']((_0xda49ec,_0x3fe1ee)=>{var _0x4ff75c=_0x15faab;_0x37120b[_0x3fe1ee][_0x4ff75c(0x1e3)]=_0xda49ec;}),_0x10f73f[_0x15faab(0x1d7)]((_0x352aec,_0x33f9a2)=>{var _0x27381d=_0x15faab;_0x37120b[_0x33f9a2][_0x27381d(0x232)]=_0x352aec;}),_0x4a6391[_0x15faab(0x1d7)]((_0x45d651,_0x30b7fd)=>{var _0x4d261a=_0x15faab;_0x37120b[_0x30b7fd][_0x4d261a(0x27c)]=_0x45d651;});var _0x78b6b1=0x0;_0x37120b[_0x15faab(0x1d7)](_0xfb4dbb=>{var _0xa6bf15=_0x15faab;console[_0xa6bf15(0x2a3)]('foreach\x20newproduct',_0xfb4dbb),(parseInt(_0xfb4dbb[_0xa6bf15(0x267)])<parseInt(_0xfb4dbb[_0xa6bf15(0x26c)])||parseInt(_0xfb4dbb[_0xa6bf15(0x26c)])==0x0)&&_0x78b6b1++;});if(_0x78b6b1!=0x0)return _0x232c2e[_0x15faab(0x1e0)](_0x15faab(0x1f6),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x57a73a[_0x15faab(0x2ba)](_0x15faab(0x291));_0xc3ee1f[_0x15faab(0x27e)]['forEach'](_0x5ac6c2=>{var _0x35cae8=_0x15faab;const _0x205f4b=_0x1ac556[_0x35cae8(0x2dd)][_0x35cae8(0x289)](_0x3704d0=>{var _0xa27db7=_0x35cae8;_0x3704d0[_0xa27db7(0x25a)]==_0x5ac6c2[_0xa27db7(0x25a)]&&_0x3704d0[_0xa27db7(0x239)]==_0x5ac6c2[_0xa27db7(0x239)]&&(_0x3704d0['product_stock']=parseInt(_0x3704d0[_0xa27db7(0x2c5)])+parseInt(_0x5ac6c2[_0xa27db7(0x26c)]));});}),await _0x1ac556[_0x15faab(0x234)]();const _0x49dbd8=_0x37120b[_0x15faab(0x1eb)](_0x257596=>_0x257596[_0x15faab(0x26c)]!=='0'&&_0x257596[_0x15faab(0x26c)]!=='');_0xc3ee1f['invoice']=_0x183145,_0xc3ee1f[_0x15faab(0x22c)]=_0x446868,_0xc3ee1f['date']=_0x5d2967,_0xc3ee1f['warehouse_name']=_0x4bddc3,_0xc3ee1f['sale_product']=_0x49dbd8,_0xc3ee1f[_0x15faab(0x1d4)]=_0x36c43c,_0xc3ee1f[_0x15faab(0x212)]=_0x477543;const _0x9e1d5d=await _0xc3ee1f[_0x15faab(0x234)](),_0x220022=await sales_finished[_0x15faab(0x226)]({'_id':_0x232c2e['params']['id']}),_0x26e578=await warehouse[_0x15faab(0x226)]({'name':_0x4bddc3,'room':_0x477543,'warehouse_category':'Finished\x20Goods'});_0x220022['sale_product'][_0x15faab(0x1d7)](_0x1464b4=>{var _0x4a5ce9=_0x15faab;const _0x24b7eb=_0x26e578[_0x4a5ce9(0x2dd)][_0x4a5ce9(0x289)](_0x53c4b8=>{var _0x2fd111=_0x4a5ce9;_0x53c4b8[_0x2fd111(0x25a)]==_0x1464b4[_0x2fd111(0x25a)]&&_0x53c4b8[_0x2fd111(0x239)]==_0x1464b4[_0x2fd111(0x239)]&&(_0x53c4b8[_0x2fd111(0x2c5)]=parseInt(_0x53c4b8[_0x2fd111(0x2c5)])-parseInt(_0x1464b4[_0x2fd111(0x26c)]));});}),console[_0x15faab(0x2a3)](_0x15faab(0x241),_0x26e578),await _0x26e578[_0x15faab(0x234)]();const _0x279c56=await c_payment_data[_0x15faab(0x226)]({'invoice':_0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x1f7)]});_0x279c56[_0x15faab(0x275)]=_0x232c2e[_0x15faab(0x2b0)][_0x15faab(0x275)],await _0x279c56[_0x15faab(0x234)](),_0x232c2e[_0x15faab(0x1e0)](_0x15faab(0x255),_0x15faab(0x204)),_0x57a73a[_0x15faab(0x2ba)](_0x15faab(0x27d));}catch(_0x4d9d7e){console[_0x15faab(0x2a3)](_0x4d9d7e);}}),router[a0_0x1b1201(0x206)]('/give_payment/:id',auth,async(_0xb3b214,_0x48fed3)=>{var _0xa85aa1=a0_0x1b1201;try{const _0x315aaf=_0xb3b214['params']['id'],{invoice:_0x29719b,customer:_0x18a55e,receivable_amount:_0x50e052,received_amount:_0x1c2ee0}=_0xb3b214[_0xa85aa1(0x2b0)],_0xf65c00=await sales[_0xa85aa1(0x259)](_0x315aaf);console[_0xa85aa1(0x2a3)](_0xf65c00);var _0x5299a4=_0x50e052-_0x1c2ee0;console['log'](_0x1c2ee0),_0xf65c00['received_amount']=parseFloat(_0x1c2ee0)+parseFloat(_0xf65c00[_0xa85aa1(0x29e)]),_0xf65c00[_0xa85aa1(0x217)]=_0x5299a4,console['log'](_0xf65c00);const _0x953ebe=await _0xf65c00[_0xa85aa1(0x234)](),_0x455888=await c_payment_data[_0xa85aa1(0x226)]({'invoice':_0x29719b});_0x455888[_0xa85aa1(0x22b)]=_0x5299a4,await _0x455888[_0xa85aa1(0x234)]();let _0x52a5ef=new Date(),_0x9afb31=('0'+_0x52a5ef[_0xa85aa1(0x263)]())[_0xa85aa1(0x22d)](-0x2),_0x39c041=('0'+(_0x52a5ef[_0xa85aa1(0x205)]()+0x1))['slice'](-0x2),_0x5a7455=_0x52a5ef['getFullYear'](),_0x1000c8=_0x5a7455+'-'+_0x39c041+'-'+_0x9afb31;const _0x18380c=new customer_payment({'invoice':_0x29719b,'date':_0x5a7455+'-'+_0x39c041+'-'+_0x9afb31,'customer':_0x18a55e,'reason':_0xa85aa1(0x2b1),'amount':_0x1c2ee0}),_0x52dfcc=await _0x18380c[_0xa85aa1(0x234)]();_0xb3b214[_0xa85aa1(0x1e0)](_0xa85aa1(0x255),_0xa85aa1(0x21d)),_0x48fed3[_0xa85aa1(0x2ba)](_0xa85aa1(0x2c9));}catch(_0x3045e3){console[_0xa85aa1(0x2a3)](_0x3045e3);}}),router[a0_0x1b1201(0x24e)](a0_0x1b1201(0x254),auth,async(_0x1610dd,_0x98c0f2)=>{var _0x5a2e3f=a0_0x1b1201;try{const {username:_0x1b2c20,email:_0xe9c8e2,role:_0x4969b1}=_0x1610dd[_0x5a2e3f(0x22e)],_0x12a204=_0x1610dd[_0x5a2e3f(0x22e)],_0x325833=await profile['findOne']({'email':_0x12a204['email']}),_0x1536fe=await master_shop[_0x5a2e3f(0x28f)]();console[_0x5a2e3f(0x2a3)]('master',_0x1536fe);const _0x32312f=_0x1610dd[_0x5a2e3f(0x2aa)]['id'],_0x575660=await sales['findById'](_0x32312f);console[_0x5a2e3f(0x2a3)](_0x575660);const _0xd22b58=await customer[_0x5a2e3f(0x226)]({'name':_0x575660[_0x5a2e3f(0x22c)]});console[_0x5a2e3f(0x2a3)](_0xd22b58);if(_0x1536fe[0x0]['language']==_0x5a2e3f(0x2e2)){var _0x3a23ad=users[_0x5a2e3f(0x272)];console[_0x5a2e3f(0x2a3)](_0x3a23ad);}else{if(_0x1536fe[0x0][_0x5a2e3f(0x2cc)]=='Hindi')var _0x3a23ad=users[_0x5a2e3f(0x29a)];else{if(_0x1536fe[0x0][_0x5a2e3f(0x2cc)]==_0x5a2e3f(0x257))var _0x3a23ad=users['German'];else{if(_0x1536fe[0x0][_0x5a2e3f(0x2cc)]==_0x5a2e3f(0x2d4))var _0x3a23ad=users[_0x5a2e3f(0x2d4)];else{if(_0x1536fe[0x0][_0x5a2e3f(0x2cc)]=='French')var _0x3a23ad=users['French'];else{if(_0x1536fe[0x0][_0x5a2e3f(0x2cc)]==_0x5a2e3f(0x1da))var _0x3a23ad=users[_0x5a2e3f(0x278)];else{if(_0x1536fe[0x0][_0x5a2e3f(0x2cc)]==_0x5a2e3f(0x2b9))var _0x3a23ad=users[_0x5a2e3f(0x2b9)];else{if(_0x1536fe[0x0][_0x5a2e3f(0x2cc)]==_0x5a2e3f(0x2cd))var _0x3a23ad=users[_0x5a2e3f(0x1fa)];}}}}}}}_0x98c0f2[_0x5a2e3f(0x26b)]('sales_invoice',{'success':_0x1610dd[_0x5a2e3f(0x1e0)]('success'),'errors':_0x1610dd['flash'](_0x5a2e3f(0x1f6)),'role':_0x12a204,'profile':_0x325833,'master_shop':_0x1536fe,'customers':_0xd22b58,'sales':_0x575660,'language':_0x3a23ad});}catch(_0x35c6b2){console[_0x5a2e3f(0x2a3)](_0x35c6b2);}}),router['get']('/view/return_sales/:id',auth,async(_0x5ef381,_0x197f01)=>{var _0x2b1076=a0_0x1b1201;try{const {username:_0x2d70fa,email:_0x44ff1d,role:_0x53e8ff}=_0x5ef381['user'],_0x3c1c13=_0x5ef381['user'],_0x2178b2=await profile[_0x2b1076(0x226)]({'email':_0x3c1c13[_0x2b1076(0x2bc)]}),_0x49daf5=await master_shop[_0x2b1076(0x28f)](),_0x3b1a15=_0x5ef381['params']['id'],_0x54e8b2=await sales_finished[_0x2b1076(0x259)](_0x3b1a15),_0x5ebc76=await warehouse[_0x2b1076(0x2be)]([{'$match':{'name':_0x54e8b2[_0x2b1076(0x2c4)]}},{'$unwind':_0x2b1076(0x277)},{'$group':{'_id':_0x2b1076(0x26e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2b1076(0x21e)},'bay':{'$first':_0x2b1076(0x253)},'bin':{'$first':_0x2b1076(0x24d)},'type':{'$first':_0x2b1076(0x29f)},'floorlevel':{'$first':_0x2b1076(0x21c)},'primary_code':{'$first':_0x2b1076(0x28e)},'secondary_code':{'$first':_0x2b1076(0x202)},'product_code':{'$first':_0x2b1076(0x216)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2b1076(0x2c7)},'expiry_date':{'$first':_0x2b1076(0x298)},'production_date':{'$first':_0x2b1076(0x264)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':'$product_details.maxProducts'},'batch_code':{'$first':_0x2b1076(0x1de)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x295436=await product['find']({}),_0x43ad63=await warehouse[_0x2b1076(0x2be)]([{'$match':{'status':_0x2b1076(0x1fd),'warehouse_category':_0x2b1076(0x28c),'name':{'$ne':_0x2b1076(0x2df),'$ne':_0x2b1076(0x236)}}},{'$group':{'_id':_0x2b1076(0x262),'name':{'$first':_0x2b1076(0x262)}}},{'$sort':{'name':0x1}}]);var _0x1b4f1d=['Return\x20Rooms'];const _0x2db827=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':'Quality\x20Inspection'}},{'$group':{'_id':_0x2b1076(0x262),'name':{'$first':_0x2b1076(0x262)}}},{'$sort':{'name':0x1}}]);if(_0x49daf5[0x0][_0x2b1076(0x2cc)]==_0x2b1076(0x2e2)){var _0x1909d4=users['English'];console[_0x2b1076(0x2a3)](_0x1909d4);}else{if(_0x49daf5[0x0][_0x2b1076(0x2cc)]==_0x2b1076(0x29a))var _0x1909d4=users[_0x2b1076(0x29a)];else{if(_0x49daf5[0x0][_0x2b1076(0x2cc)]==_0x2b1076(0x257))var _0x1909d4=users[_0x2b1076(0x257)];else{if(_0x49daf5[0x0][_0x2b1076(0x2cc)]=='Spanish')var _0x1909d4=users['Spanish'];else{if(_0x49daf5[0x0][_0x2b1076(0x2cc)]==_0x2b1076(0x214))var _0x1909d4=users['French'];else{if(_0x49daf5[0x0][_0x2b1076(0x2cc)]==_0x2b1076(0x1da))var _0x1909d4=users[_0x2b1076(0x278)];else{if(_0x49daf5[0x0][_0x2b1076(0x2cc)]==_0x2b1076(0x2b9))var _0x1909d4=users[_0x2b1076(0x2b9)];else{if(_0x49daf5[0x0][_0x2b1076(0x2cc)]=='Arabic\x20(ae)')var _0x1909d4=users['Arabic'];}}}}}}}_0x197f01[_0x2b1076(0x26b)](_0x2b1076(0x2d6),{'success':_0x5ef381[_0x2b1076(0x1e0)]('success'),'errors':_0x5ef381[_0x2b1076(0x1e0)]('errors'),'role':_0x3c1c13,'profile':_0x2178b2,'user':_0x54e8b2,'stock':_0x5ebc76,'master_shop':_0x49daf5,'unit':_0x295436,'language':_0x1909d4,'warehouses':_0x43ad63,'rooms':_0x1b4f1d,'warehouse_QA':_0x2db827});}catch(_0x530579){console['log'](_0x530579),_0x197f01[_0x2b1076(0x2b7)](0xc8)['json']({'message':_0x530579['message']});}}),router[a0_0x1b1201(0x206)](a0_0x1b1201(0x261),auth,async(_0x3e7ad5,_0x2494e7)=>{var _0x30c507=a0_0x1b1201;if(_0x3e7ad5[_0x30c507(0x2b0)]['for_categorize']=='QA')try{const {invoice:_0x46f373,date:_0x3c2dee,warehouse_name:_0x47a921,product_name:_0x191ad8,primary_code:_0x452279,secondary_code:_0x2d3182,product_code:_0x4865dc,sales_quantity:_0x20de56,stocks:_0x5df70f,return_qty:_0x11bf91,Room_name:_0x241aba,to_warehouse_name_QA:_0x31e93a,to_Room_name_QA:_0x2a7bd8,note:_0x51e9ea,for_categorize:_0x1b41f6,product_name_QA1:_0x3273c9}=_0x3e7ad5[_0x30c507(0x2b0)];if(typeof _0x3273c9==_0x30c507(0x2d3))var _0x18afcf=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x1fb)]],_0x20ddb3=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x223)]],_0x4d81a7=[_0x3e7ad5['body']['secondary_code_QA']],_0x5aff69=[_0x3e7ad5[_0x30c507(0x2b0)]['product_code_QA']],_0x4ffcfb=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x1d5)]],_0x34b53c=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x2ac)]],_0x3a4ff3=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x28a)]],_0x164c7d=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x20d)]],_0x79def7=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x229)]],_0x1d7d32=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x1df)]],_0xc06d75=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x21f)]],_0x12cd2f=[_0x3e7ad5['body']['unit_QA']],_0x1f225b=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x280)]],_0x5bbdc4=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x2d1)]];else var _0x18afcf=[..._0x3e7ad5['body'][_0x30c507(0x1fb)]],_0x20ddb3=[..._0x3e7ad5[_0x30c507(0x2b0)]['primary_code_QA']],_0x4d81a7=[..._0x3e7ad5['body'][_0x30c507(0x2c8)]],_0x5aff69=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x243)]],_0x4ffcfb=[..._0x3e7ad5['body'][_0x30c507(0x1d5)]],_0x34b53c=[..._0x3e7ad5['body']['stocks_QA']],_0x3a4ff3=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x28a)]],_0x164c7d=[..._0x3e7ad5[_0x30c507(0x2b0)]['maxPerUnit_QA']],_0x79def7=[..._0x3e7ad5['body'][_0x30c507(0x229)]],_0x1d7d32=[..._0x3e7ad5[_0x30c507(0x2b0)]['batch_code_QA']],_0xc06d75=[..._0x3e7ad5[_0x30c507(0x2b0)]['secondary_unit_QA']],_0x12cd2f=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x1e1)]],_0x1f225b=[..._0x3e7ad5['body'][_0x30c507(0x280)]],_0x5bbdc4=[..._0x3e7ad5['body']['expiry_date_QA']];const _0x313c08=_0x18afcf[_0x30c507(0x289)](_0x5b0641=>{return _0x5b0641={'product_name':_0x5b0641};});_0x20ddb3['forEach']((_0x5043cb,_0x3f1024)=>{var _0x1babe8=_0x30c507;_0x313c08[_0x3f1024][_0x1babe8(0x288)]=_0x5043cb;}),_0x4d81a7['forEach']((_0x454713,_0x57b97b)=>{var _0x166512=_0x30c507;_0x313c08[_0x57b97b][_0x166512(0x227)]=_0x454713;}),_0x5aff69[_0x30c507(0x1d7)]((_0x5546ee,_0x32811c)=>{var _0x1e47cb=_0x30c507;_0x313c08[_0x32811c][_0x1e47cb(0x1e3)]=_0x5546ee;}),_0x4ffcfb['forEach']((_0x22f5d2,_0x33fc6d)=>{var _0x561e23=_0x30c507;_0x313c08[_0x33fc6d][_0x561e23(0x27b)]=_0x22f5d2;}),_0x34b53c[_0x30c507(0x1d7)]((_0x53e3f7,_0x5d4e2f)=>{var _0x2f9180=_0x30c507;_0x313c08[_0x5d4e2f][_0x2f9180(0x267)]=_0x53e3f7;}),_0x3a4ff3['forEach']((_0x5d8b4f,_0x889ef6)=>{var _0x5888f2=_0x30c507;_0x313c08[_0x889ef6][_0x5888f2(0x1d9)]=_0x5d8b4f;}),_0x164c7d['forEach']((_0x12834c,_0xabc1cc)=>{var _0x2f6609=_0x30c507;_0x313c08[_0xabc1cc][_0x2f6609(0x266)]=_0x12834c;}),_0x79def7[_0x30c507(0x1d7)]((_0x4415d7,_0x119cbf)=>{_0x313c08[_0x119cbf]['maxProducts']=_0x4415d7;}),_0x1d7d32[_0x30c507(0x1d7)]((_0x46c173,_0x39f8a6)=>{var _0x23ede8=_0x30c507;_0x313c08[_0x39f8a6][_0x23ede8(0x258)]=_0x46c173;}),_0xc06d75[_0x30c507(0x1d7)]((_0x35ba66,_0x37d7d3)=>{var _0xc9ec37=_0x30c507;_0x313c08[_0x37d7d3][_0xc9ec37(0x2dc)]=_0x35ba66;}),_0x12cd2f[_0x30c507(0x1d7)]((_0x134e10,_0x290e8e)=>{_0x313c08[_0x290e8e]['unit']=_0x134e10;}),_0x1f225b[_0x30c507(0x1d7)]((_0x5653ea,_0x50750d)=>{var _0x546ff5=_0x30c507;_0x313c08[_0x50750d][_0x546ff5(0x25c)]=_0x5653ea;}),_0x5bbdc4['forEach']((_0x232e8f,_0x14395a)=>{_0x313c08[_0x14395a]['expiry_date']=_0x232e8f;});const _0x5c5992=await sales_finished['findOne']({'invoice':_0x46f373});_0x5c5992[_0x30c507(0x2d7)]=_0x30c507(0x24c);const _0x39c2bb=await _0x5c5992[_0x30c507(0x234)](),_0x2f706a=new sales_return_finished({'invoice':_0x46f373,'customer':_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x22c)],'date':_0x3c2dee,'warehouse_name':_0x47a921,'room':_0x241aba,'ToWarehouse':_0x31e93a,'ToRoom':_0x2a7bd8,'return_sale_QA':_0x313c08,'note':_0x51e9ea,'warehouse_cat':_0x1b41f6}),_0x1b5238=await _0x2f706a[_0x30c507(0x234)](),_0x55d9aa=await sales_return_finished['findOne']({'invoice':_0x46f373}),_0x139d5a=await warehouse[_0x30c507(0x226)]({'name':_0x31e93a,'room':_0x2a7bd8});_0x55d9aa['return_sale_QA'][_0x30c507(0x1d7)](_0x2f077c=>{var _0x554190=_0x30c507,_0x1da40a=0x0;const _0x401ed9=_0x139d5a['product_details'][_0x554190(0x289)](_0x896228=>{var _0x49cf53=_0x554190;_0x896228[_0x49cf53(0x25a)]==_0x2f077c[_0x49cf53(0x25a)]&&_0x896228['expiry_date']==_0x2f077c[_0x49cf53(0x27c)]&&_0x896228[_0x49cf53(0x25c)]==_0x2f077c[_0x49cf53(0x25c)]&&_0x896228['batch_code']==_0x2f077c[_0x49cf53(0x258)]&&(_0x896228[_0x49cf53(0x2c5)]=parseInt(_0x896228[_0x49cf53(0x2c5)])+parseInt(_0x2f077c[_0x49cf53(0x1d9)]),_0x1da40a++);});_0x1da40a=='0'&&(_0x139d5a[_0x554190(0x2dd)]=_0x139d5a[_0x554190(0x2dd)]['concat']({'product_name':_0x2f077c[_0x554190(0x25a)],'product_stock':_0x2f077c[_0x554190(0x1d9)],'primary_code':_0x2f077c['primary_code'],'secondary_code':_0x2f077c[_0x554190(0x227)],'product_code':_0x2f077c[_0x554190(0x1e3)],'batch_code':_0x2f077c[_0x554190(0x258)],'maxPerUnit':_0x2f077c[_0x554190(0x266)],'production_date':_0x2f077c[_0x554190(0x25c)],'expiry_date':_0x2f077c[_0x554190(0x27c)],'secondary_unit':_0x2f077c[_0x554190(0x2dc)],'unit':_0x2f077c['unit'],'maxProducts':_0x2f077c[_0x554190(0x28d)],'bay':_0x2f077c[_0x554190(0x239)]}));}),await _0x139d5a[_0x30c507(0x234)]();const _0x3d1af6=new c_payment_data({'invoice':_0x46f373,'customer':_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x22c)],'reason':'Sale\x20Return'});await _0x3d1af6[_0x30c507(0x234)]();const _0x4bc7c0=await master_shop[_0x30c507(0x28f)](),_0x5f2c3d=await email_settings[_0x30c507(0x226)](),_0x36a28c=await customer[_0x30c507(0x226)]({'name':_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x22c)]});_0x4bc7c0[0x0][_0x30c507(0x2de)]==0x1?(right_currency=_0x4bc7c0[0x0][_0x30c507(0x2e6)],left_currency=''):(right_currency='',left_currency=_0x4bc7c0[0x0][_0x30c507(0x2e6)]);var _0x5811ba=_0x18afcf,_0x52d19f=_0x3a4ff3,_0x32d95a='',_0x1cef2c;for(_0x1cef2c in _0x5811ba){_0x32d95a+=_0x30c507(0x1ee)+_0x30c507(0x23a)+_0x5811ba[_0x1cef2c]+_0x30c507(0x2cf)+_0x30c507(0x23a)+_0x52d19f[_0x1cef2c]+'</td>'+_0x30c507(0x21b);}console[_0x30c507(0x2a3)](_0x30c507(0x1db),_0x32d95a);let _0x5093c8=nodemailer[_0x30c507(0x240)]({'service':'gmail','auth':{'user':_0x5f2c3d[_0x30c507(0x2bc)],'pass':_0x5f2c3d['password']}}),_0x13b8c1={'from':_0x5f2c3d[_0x30c507(0x2bc)],'to':_0x36a28c[_0x30c507(0x2bc)],'subject':_0x30c507(0x1ed),'attachments':[{'filename':_0x30c507(0x2a4),'path':__dirname+'/../public'+_0x30c507(0x284)+_0x4bc7c0[0x0][_0x30c507(0x2a7)],'cid':'logo'}],'html':_0x30c507(0x2d0)+_0x30c507(0x1d8)+'</head><body>'+_0x30c507(0x296)+_0x30c507(0x286)+'<div>'+_0x30c507(0x2e8)+'</div>'+_0x30c507(0x296)+_0x30c507(0x211)+_0x4bc7c0[0x0][_0x30c507(0x209)]+_0x30c507(0x1f0)+'</div>'+'</div>'+_0x30c507(0x2a5)+_0x30c507(0x296)+_0x30c507(0x295)+_0x30c507(0x203)+_0x46f373+'\x20'+_0x30c507(0x282)+_0x30c507(0x26a)+_0x3c2dee+'\x20'+_0x30c507(0x222)+_0x30c507(0x2d5)+_0x30c507(0x273)+_0x30c507(0x220)+_0x30c507(0x208)+_0x30c507(0x1ee)+_0x30c507(0x201)+_0x30c507(0x1e2)+_0x30c507(0x2b4)+_0x30c507(0x244)+_0x30c507(0x21b)+'</thead>'+_0x30c507(0x25b)+'\x20'+_0x32d95a+'\x20'+'</tbody>'+_0x30c507(0x252)+_0x30c507(0x296)+_0x30c507(0x1f8)+_0x30c507(0x25f)+_0x4bc7c0[0x0][_0x30c507(0x209)]+_0x30c507(0x2d5)+'</div>'+_0x30c507(0x273)+_0x30c507(0x270)};_0x5093c8[_0x30c507(0x233)](_0x13b8c1,function(_0x28cb93,_0x3e488b){var _0x5664ef=_0x30c507;_0x28cb93?(console[_0x5664ef(0x2a3)](_0x28cb93),console[_0x5664ef(0x2a3)](_0x5664ef(0x2d9))):console[_0x5664ef(0x2a3)](_0x5664ef(0x225));}),_0x3e7ad5[_0x30c507(0x1e0)](_0x30c507(0x255),_0x30c507(0x279)),_0x2494e7['redirect']('/all_sales_finished/view');}catch(_0x182b4f){_0x2494e7[_0x30c507(0x2b7)](0xc8)[_0x30c507(0x2db)]({'message1':_0x182b4f[_0x30c507(0x294)]});}else{if(_0x3e7ad5[_0x30c507(0x2b0)]['for_categorize']=='GS')try{const {invoice:_0x58e0f8,date:_0x30b1d6,warehouse_name:_0x394662,product_name:_0x3a72a1,primary_code:_0x536fc0,secondary_code:_0x3342dc,product_code:_0x2a2559,sales_quantity:_0x2f56d5,stocks:_0x4d73b4,return_qty:_0x5bd869,Room_name:_0x467087,to_warehouse_name:_0x78e9c5,to_Room_name:_0x34b143,note:_0x21c4f7,level:_0x2c7794,isle:_0x347aed,pallet:_0x2d4f06,for_categorize:_0xa8913e}=_0x3e7ad5[_0x30c507(0x2b0)];if(typeof _0x3a72a1=='string')var _0x18afcf=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x25a)]],_0x20ddb3=[_0x3e7ad5[_0x30c507(0x2b0)]['primary_code']],_0x4d81a7=[_0x3e7ad5[_0x30c507(0x2b0)]['secondary_code']],_0x5aff69=[_0x3e7ad5[_0x30c507(0x2b0)]['product_code']],_0x4ffcfb=[_0x3e7ad5[_0x30c507(0x2b0)]['sales_quantity']],_0x3a4ff3=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x1d9)]],_0x4f9646=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x239)]],_0x164c7d=[_0x3e7ad5['body'][_0x30c507(0x266)]],_0x79def7=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x28d)]],_0x1d7d32=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x258)]],_0xc06d75=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x2dc)]],_0x12cd2f=[_0x3e7ad5[_0x30c507(0x2b0)]['unit']],_0x1f225b=[_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x25c)]],_0x5bbdc4=[_0x3e7ad5['body']['expiry_date']];else var _0x18afcf=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x25a)]],_0x20ddb3=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x288)]],_0x4d81a7=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x227)]],_0x5aff69=[..._0x3e7ad5[_0x30c507(0x2b0)]['product_code']],_0x4ffcfb=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x283)]],_0x3a4ff3=[..._0x3e7ad5['body'][_0x30c507(0x1d9)]],_0x4f9646=[..._0x3e7ad5['body'][_0x30c507(0x239)]],_0x164c7d=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x266)]],_0x79def7=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x28d)]],_0x1d7d32=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x258)]],_0xc06d75=[..._0x3e7ad5['body'][_0x30c507(0x2dc)]],_0x12cd2f=[..._0x3e7ad5['body']['unit']],_0x1f225b=[..._0x3e7ad5['body'][_0x30c507(0x25c)]],_0x5bbdc4=[..._0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x27c)]];const _0x6197f5=_0x18afcf[_0x30c507(0x289)](_0x7cbb3f=>{return _0x7cbb3f={'product_name':_0x7cbb3f};});_0x20ddb3['forEach']((_0x50a257,_0x5810c2)=>{var _0x17f765=_0x30c507;_0x6197f5[_0x5810c2][_0x17f765(0x288)]=_0x50a257;}),_0x4d81a7[_0x30c507(0x1d7)]((_0x56b775,_0x1578c2)=>{var _0x55a6af=_0x30c507;_0x6197f5[_0x1578c2][_0x55a6af(0x227)]=_0x56b775;}),_0x5aff69[_0x30c507(0x1d7)]((_0x12ee1c,_0x5035bb)=>{_0x6197f5[_0x5035bb]['product_code']=_0x12ee1c;}),_0x4ffcfb['forEach']((_0x3d4f48,_0x35a2b0)=>{var _0x283f18=_0x30c507;_0x6197f5[_0x35a2b0][_0x283f18(0x27b)]=_0x3d4f48;}),_0x3a4ff3[_0x30c507(0x1d7)]((_0x3d0f63,_0x3afa49)=>{_0x6197f5[_0x3afa49]['return_qty']=_0x3d0f63;}),_0x4f9646[_0x30c507(0x1d7)]((_0x486f54,_0x4beba4)=>{var _0x73b283=_0x30c507;_0x6197f5[_0x4beba4][_0x73b283(0x239)]=_0x486f54;}),_0x164c7d['forEach']((_0x2eec8c,_0x2a965a)=>{var _0x5ca808=_0x30c507;_0x6197f5[_0x2a965a][_0x5ca808(0x266)]=_0x2eec8c;}),_0x79def7[_0x30c507(0x1d7)]((_0x3813de,_0xc7e353)=>{_0x6197f5[_0xc7e353]['maxProducts']=_0x3813de;}),_0x1d7d32[_0x30c507(0x1d7)]((_0x1cb188,_0x2ef84f)=>{var _0x3ca584=_0x30c507;_0x6197f5[_0x2ef84f][_0x3ca584(0x258)]=_0x1cb188;}),_0xc06d75[_0x30c507(0x1d7)]((_0x1a01e7,_0x29708a)=>{var _0x4a3b68=_0x30c507;_0x6197f5[_0x29708a][_0x4a3b68(0x2dc)]=_0x1a01e7;}),_0x12cd2f[_0x30c507(0x1d7)]((_0x40db6d,_0xfdd0df)=>{var _0x3598e9=_0x30c507;_0x6197f5[_0xfdd0df][_0x3598e9(0x20a)]=_0x40db6d;}),_0x1f225b[_0x30c507(0x1d7)]((_0x28c412,_0x4a9944)=>{var _0x33791f=_0x30c507;_0x6197f5[_0x4a9944][_0x33791f(0x25c)]=_0x28c412;}),_0x5bbdc4[_0x30c507(0x1d7)]((_0x30464b,_0x16d628)=>{var _0x203879=_0x30c507;_0x6197f5[_0x16d628][_0x203879(0x27c)]=_0x30464b;});var _0x25e5c2=0x0;_0x6197f5['forEach'](_0x17d755=>{var _0x2e260c=_0x30c507;(parseInt(_0x17d755[_0x2e260c(0x27b)])<parseInt(_0x17d755[_0x2e260c(0x1d9)])||parseInt(_0x17d755[_0x2e260c(0x267)])<parseInt(_0x17d755[_0x2e260c(0x1d9)])&&parseInt(_0x17d755[_0x2e260c(0x27b)])>parseInt(_0x17d755[_0x2e260c(0x1d9)])||parseInt(_0x17d755[_0x2e260c(0x1d9)])==0x0)&&_0x25e5c2++;});if(_0x25e5c2!=0x0)return _0x3e7ad5['flash'](_0x30c507(0x1f6),_0x30c507(0x29b)),_0x2494e7['redirect']('back');const _0x37130d=await sales_finished[_0x30c507(0x226)]({'invoice':_0x58e0f8});_0x37130d[_0x30c507(0x2d7)]='True';const _0x1c8b6f=await _0x37130d[_0x30c507(0x234)](),_0x423051=new sales_return_finished({'invoice':_0x58e0f8,'customer':_0x3e7ad5['body'][_0x30c507(0x22c)],'date':_0x30b1d6,'warehouse_name':_0x394662,'room':_0x467087,'ToWarehouse':_0x78e9c5,'ToRoom':_0x34b143,'return_sale':_0x6197f5,'note':_0x21c4f7,'warehouse_cat':_0xa8913e}),_0x4cccbd=await _0x423051[_0x30c507(0x234)](),_0x2f75f7=await sales_return_finished['findOne']({'invoice':_0x58e0f8}),_0x3d6b61=await warehouse[_0x30c507(0x226)]({'name':_0x78e9c5,'room':_0x34b143,'warehouse_category':_0x30c507(0x28c)});_0x2f75f7[_0x30c507(0x26f)]['forEach'](_0x371857=>{var _0x8b8bae=_0x30c507,_0xfffb54=0x0;const _0x4b703a=_0x3d6b61['product_details']['map'](_0x10f82d=>{var _0x391b8a=a0_0x2d40;_0x10f82d[_0x391b8a(0x25a)]==_0x371857[_0x391b8a(0x25a)]&&_0x10f82d[_0x391b8a(0x239)]==_0x371857[_0x391b8a(0x239)]&&_0x10f82d[_0x391b8a(0x27c)]==_0x371857[_0x391b8a(0x27c)]&&_0x10f82d[_0x391b8a(0x25c)]==_0x371857[_0x391b8a(0x25c)]&&_0x10f82d[_0x391b8a(0x258)]==_0x371857[_0x391b8a(0x258)]&&(_0x10f82d[_0x391b8a(0x2c5)]=parseInt(_0x10f82d[_0x391b8a(0x2c5)])+parseInt(_0x371857['return_qty']),_0xfffb54++);});_0xfffb54=='0'&&(_0x3d6b61[_0x8b8bae(0x2dd)]=_0x3d6b61[_0x8b8bae(0x2dd)][_0x8b8bae(0x242)]({'product_name':_0x371857[_0x8b8bae(0x25a)],'product_stock':_0x371857[_0x8b8bae(0x1d9)],'primary_code':_0x371857[_0x8b8bae(0x288)],'secondary_code':_0x371857['secondary_code'],'product_code':_0x371857[_0x8b8bae(0x1e3)],'bay':_0x371857[_0x8b8bae(0x239)],'batch_code':_0x371857[_0x8b8bae(0x258)],'maxPerUnit':_0x371857[_0x8b8bae(0x266)],'production_date':_0x371857[_0x8b8bae(0x25c)],'expiry_date':_0x371857[_0x8b8bae(0x27c)],'secondary_unit':_0x371857[_0x8b8bae(0x2dc)],'unit':_0x371857[_0x8b8bae(0x20a)],'maxProducts':_0x371857[_0x8b8bae(0x28d)]}));}),await _0x3d6b61[_0x30c507(0x234)](),console[_0x30c507(0x2a3)](_0x3e7ad5[_0x30c507(0x2b0)]);const _0x194bdd=new c_payment_data({'invoice':_0x58e0f8,'customer':_0x3e7ad5[_0x30c507(0x2b0)][_0x30c507(0x22c)],'reason':_0x30c507(0x268)});await _0x194bdd['save']();const _0x267c2b=await master_shop['find']();console[_0x30c507(0x2a3)]('add\x20post',_0x267c2b[0x0]['image']);const _0x30acd3=await email_settings['findOne'](),_0x41c45a=await customer[_0x30c507(0x226)]({'name':_0x3e7ad5[_0x30c507(0x2b0)]['customer']});console['log'](_0x30c507(0x2b3),_0x41c45a);_0x267c2b[0x0][_0x30c507(0x2de)]==0x1?(right_currency=_0x267c2b[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x267c2b[0x0][_0x30c507(0x2e6)]);var _0x5811ba=_0x18afcf,_0x52d19f=_0x3a4ff3,_0x32d95a='',_0x1cef2c;for(_0x1cef2c in _0x5811ba){_0x32d95a+=_0x30c507(0x1ee)+_0x30c507(0x23a)+_0x5811ba[_0x1cef2c]+_0x30c507(0x2cf)+_0x30c507(0x23a)+_0x52d19f[_0x1cef2c]+'</td>'+_0x30c507(0x21b);}console[_0x30c507(0x2a3)]('product_list',_0x32d95a);let _0x291004=nodemailer[_0x30c507(0x240)]({'service':_0x30c507(0x2b8),'auth':{'user':_0x30acd3['email'],'pass':_0x30acd3[_0x30c507(0x293)]}}),_0xfecf5={'from':_0x30acd3['email'],'to':_0x41c45a[_0x30c507(0x2bc)],'subject':_0x30c507(0x1ed),'attachments':[{'filename':_0x30c507(0x2a4),'path':__dirname+'/../public'+_0x30c507(0x284)+_0x267c2b[0x0]['image'],'cid':'logo'}],'html':'<!DOCTYPE\x20html>'+_0x30c507(0x1d8)+_0x30c507(0x2ca)+_0x30c507(0x296)+_0x30c507(0x286)+_0x30c507(0x296)+_0x30c507(0x2e8)+_0x30c507(0x273)+_0x30c507(0x296)+_0x30c507(0x211)+_0x267c2b[0x0][_0x30c507(0x209)]+_0x30c507(0x1f0)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x30c507(0x296)+_0x30c507(0x295)+_0x30c507(0x203)+_0x58e0f8+'\x20'+_0x30c507(0x282)+_0x30c507(0x26a)+_0x30b1d6+'\x20'+_0x30c507(0x222)+'</h5>'+_0x30c507(0x273)+_0x30c507(0x220)+_0x30c507(0x208)+_0x30c507(0x1ee)+_0x30c507(0x201)+_0x30c507(0x1e2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x30c507(0x21b)+_0x30c507(0x1e4)+_0x30c507(0x25b)+'\x20'+_0x32d95a+'\x20'+_0x30c507(0x2bb)+_0x30c507(0x252)+_0x30c507(0x296)+_0x30c507(0x1f8)+_0x30c507(0x25f)+_0x267c2b[0x0][_0x30c507(0x209)]+_0x30c507(0x2d5)+_0x30c507(0x273)+'</div>'+'</body></html>'};_0x291004['sendMail'](_0xfecf5,function(_0x24e16f,_0x2db892){var _0x3d5eb8=_0x30c507;_0x24e16f?(console[_0x3d5eb8(0x2a3)](_0x24e16f),console[_0x3d5eb8(0x2a3)](_0x3d5eb8(0x2d9))):console['log'](_0x3d5eb8(0x225));}),_0x3e7ad5['flash']('success',_0x30c507(0x279)),_0x2494e7[_0x30c507(0x2ba)](_0x30c507(0x27d));}catch(_0x5c6b38){console[_0x30c507(0x2a3)](_0x5c6b38),_0x2494e7[_0x30c507(0x2b7)](0xc8)[_0x30c507(0x2db)]({'message1':_0x5c6b38[_0x30c507(0x294)]});}}}),router['get'](a0_0x1b1201(0x2c3),auth,async(_0x145bbc,_0x5c3929)=>{var _0x61a056=a0_0x1b1201;try{const {username:_0x536a06,email:_0x37d8da,role:_0x44e8c6}=_0x145bbc[_0x61a056(0x22e)],_0x52580e=_0x145bbc[_0x61a056(0x22e)],_0xdccdfa=await profile[_0x61a056(0x226)]({'email':_0x52580e[_0x61a056(0x2bc)]}),_0x1669d3=await master_shop[_0x61a056(0x28f)]();console[_0x61a056(0x2a3)]('barcode\x20Product\x20master',_0x1669d3);const _0x2b6ca7=_0x145bbc['params']['id'],_0x1da855=await sales['findById'](_0x2b6ca7);console[_0x61a056(0x2a3)](_0x61a056(0x249),_0x1da855);if(_0x1669d3[0x0][_0x61a056(0x2cc)]=='English\x20(US)')var _0x2ae0f2=users[_0x61a056(0x272)];else{if(_0x1669d3[0x0][_0x61a056(0x2cc)]==_0x61a056(0x29a))var _0x2ae0f2=users['Hindi'];else{if(_0x1669d3[0x0][_0x61a056(0x2cc)]==_0x61a056(0x257))var _0x2ae0f2=users[_0x61a056(0x257)];else{if(_0x1669d3[0x0][_0x61a056(0x2cc)]=='Spanish')var _0x2ae0f2=users[_0x61a056(0x2d4)];else{if(_0x1669d3[0x0][_0x61a056(0x2cc)]=='French')var _0x2ae0f2=users[_0x61a056(0x214)];else{if(_0x1669d3[0x0][_0x61a056(0x2cc)]==_0x61a056(0x1da))var _0x2ae0f2=users[_0x61a056(0x278)];else{if(_0x1669d3[0x0][_0x61a056(0x2cc)]==_0x61a056(0x2b9))var _0x2ae0f2=users[_0x61a056(0x2b9)];else{if(_0x1669d3[0x0][_0x61a056(0x2cc)]==_0x61a056(0x2cd))var _0x2ae0f2=users[_0x61a056(0x1fa)];}}}}}}}_0x5c3929[_0x61a056(0x26b)](_0x61a056(0x256),{'success':_0x145bbc[_0x61a056(0x1e0)](_0x61a056(0x255)),'errors':_0x145bbc[_0x61a056(0x1e0)](_0x61a056(0x1f6)),'role':_0x52580e,'profile':_0xdccdfa,'alldata':_0x1da855,'master_shop':_0x1669d3,'language':_0x2ae0f2});}catch(_0x2bd102){console['log'](_0x2bd102);}}),router['post']('/barcode_scanner',async(_0x396a86,_0x4bd33b)=>{var _0x2cfe62=a0_0x1b1201;const {product_code:_0x3c6d68,warehouse_name:_0x493da6,rooms_data:_0x385909,Roomslist:_0x3d0dab}=_0x396a86[_0x2cfe62(0x2b0)],_0x5785fa=_0x3d0dab[_0x2cfe62(0x2e1)](','),_0x1f645c=[];async function _0x1c6a5d(_0x2c117c){var _0x47dd51=_0x2cfe62;const _0x428d63=await warehouse['aggregate']([{'$match':{'name':_0x493da6,'room':_0x2c117c}},{'$unwind':_0x47dd51(0x277)},{'$match':{'product_details.primary_code':_0x3c6d68}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x47dd51(0x24f)},'product_stock':{'$first':_0x47dd51(0x21e)},'primary_code':{'$first':_0x47dd51(0x28e)},'secondary_code':{'$first':_0x47dd51(0x202)},'product_code':{'$first':_0x47dd51(0x216)},'level':{'$first':_0x47dd51(0x253)},'isle':{'$first':_0x47dd51(0x24d)},'type':{'$first':_0x47dd51(0x29f)},'pallet':{'$first':_0x47dd51(0x21c)},'unit':{'$first':_0x47dd51(0x28b)},'secondary_unit':{'$first':_0x47dd51(0x1f4)},'storage':{'$first':_0x47dd51(0x2c2)},'rack':{'$first':_0x47dd51(0x2c7)},'expiry_date':{'$first':_0x47dd51(0x298)},'production_date':{'$first':_0x47dd51(0x264)},'maxPerUnit':{'$first':_0x47dd51(0x235)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x47dd51(0x1ea)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x47dd51(0x1f2)},'invoice':{'$first':_0x47dd51(0x213)}}}]),_0x2cef37=await warehouse[_0x47dd51(0x2be)]([{'$match':{'name':_0x493da6,'room':_0x2c117c}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3c6d68}},{'$group':{'_id':_0x47dd51(0x26e),'name':{'$first':_0x47dd51(0x24f)},'product_stock':{'$first':_0x47dd51(0x21e)},'primary_code':{'$first':_0x47dd51(0x28e)},'secondary_code':{'$first':_0x47dd51(0x202)},'product_code':{'$first':_0x47dd51(0x216)},'level':{'$first':_0x47dd51(0x253)},'isle':{'$first':_0x47dd51(0x24d)},'type':{'$first':_0x47dd51(0x29f)},'pallet':{'$first':_0x47dd51(0x21c)},'unit':{'$first':_0x47dd51(0x28b)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x47dd51(0x2c2)},'rack':{'$first':_0x47dd51(0x2c7)},'expiry_date':{'$first':_0x47dd51(0x298)},'production_date':{'$first':_0x47dd51(0x264)},'maxPerUnit':{'$first':_0x47dd51(0x235)},'batch_code':{'$first':_0x47dd51(0x1de)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x47dd51(0x1f2)},'invoice':{'$first':_0x47dd51(0x213)}}}]);if(_0x428d63['length']>0x0)_0x1f645c[_0x47dd51(0x23d)](_0x428d63);else _0x2cef37[_0x47dd51(0x247)]>0x0&&_0x1f645c['push'](_0x2cef37);}const _0x367a42=_0x5785fa[_0x2cfe62(0x289)](_0x1e4743=>_0x1c6a5d(_0x1e4743));await Promise[_0x2cfe62(0x2a6)](_0x367a42),_0x4bd33b['json'](_0x1f645c);}),module[a0_0x1b1201(0x27a)]=router;