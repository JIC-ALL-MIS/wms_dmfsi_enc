var a0_0x7ab6bd=a0_0x3c7c;function a0_0x1b52(){var _0xf6a167=['QA\x20Warehouse','foreach\x20newproduct','expiry_date_QA','toString','getDate','product_date','production_date','$product_details.secondary_code','$_id','$product_details.expiry_date','/all_sales_finished/preview/','production_date_QA','OUTF-','primary_code','return_sale','language','date','<h5>','\x20</h2>','expiry_date','Hindi','suppliers','/view/return_sales/:id','Logo.png','return_data','/barcode/:id','concat','</div>','maxProducts','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','return_qty','518RCzPkC','$return_data','../models/all_models','/all_sales/view','adjust_qty','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Enclosed','Sale\x20Return','exports','\x20Order\x20Number\x20:\x20','primary_unit','<h2>\x20','unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$sale_product.quantity','2xJEitn','createTransport','sales_quantity_QA','Arabic\x20(ae)','$product_details.product_cat','errors','payment\x20successfull','FGSEmail','\x20<>\x20','1305304Mfgitc','received_amount','/upload/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','currency_placement','Error\x20Occurs','host','product_data','room','$product_details.maxPerUnit','all_sales_finished','findOne','Sales\x20Update\x20successfully','Email\x20sent\x20successfully','\x20Order\x20Date\x20:\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','4OuutSV','$sale_product','sales\x20item\x20return\x20successfull','customer','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','product_name','secondary_code_QA','<!DOCTYPE\x20html>','$sale_product.type','sale_product','<table\x20style=\x22width:\x20100%\x20!important;\x22>','save','/view/:id','../middleware/auth','Ambient','forEach','aggregate','unit_QA','Router','2021703PKPQxJ','There\x27s\x20a\x20error\x20in\x20this\x20transaction','sendMail','filter','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/preview/:id','customers_docs','product_name_QA1','French','port','staff','$product_details.storage','name','/invoice/:id','product_code_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Chinese','English\x20(US)','/view/add_sale/product','$product_details.unit','log','abs','</thead>','split','Finished\x20Goods','<span\x20style=\x22float:\x20right;\x22>','$product_details.secondary_unit','then','batch_code','/../public','Quality\x20Inspection','redirect','secondary_unit_QA','product_list','customer_data','gmail','/give_payment/:id','</span>','body','product_code','json','<hr\x20class=\x22my-3\x22>','</h5>','all','sales_quantity','</table>','edit_sales_finished','$customer','$product_details.product_stock','master','secondary_unit','slice','maxPerUnit','return_sale_finished','$note','</tr>','<html><head><title></title>','$product_details.primary_code','status','prod_invoice','image','email','currency','18477cXPIPe','Portuguese','user','sale_qty','customers','warehouse_name','$name','edit_sales_finished_view','catch','$product_details.rack','</tbody>','stock','$product_details.product_code','product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','secondary_code','getFullYear','room_name','Return\x20Rooms','$invoice','$product_details.production_date','An\x20error\x20occurred.','return_qty_QA','Sales\x20Mail','$product_details._id','carton','False','<strong>\x20Regards\x20</strong>','barcode\x20Product\x20master','findById','error','<tbody\x20style=\x22text-align:\x20center;\x22>','floor','3730yZCFVz','site_title','$sale_product.bin','warehouse','find','prod_code','$sale_product.bay','amount','quantity','/barcode_scanner','../public/language/languages.json','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$product_details.batch_code','$product_details.maxProducts','46324UoDQZs','stocks_QA','8474103ZQrbkQ','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$room','</head><body>','English','Sale\x20Return\x20Mail','map','string','Spanish','due_amount','$product_details.bin','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','An\x20error\x20occurred\x20while\x20saving\x20data.','message','primary_code_QA','$product_details.type','all_sales_barcode','logo','/view','level','batch_code_QA','product_stock','getMonth','maxProducts_QA','Sale','push','post','<h5\x20style=\x22text-align:\x20left;\x22>','params','$product_details.product_name','flash','password','$finalize','$product_details.floorlevel','Portuguese\x20(BR)','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','purchases_data','/picking_list/pdf/','German','success','/view/add_sales/:id','</body></html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','prod_cat','max_per_unit','Enabled','render','/all_sales_finished/view','for_categorize','2513565JtDnNa','get','role','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$customers_docs','53166DUBuce','$product_details.bay','$product_details.invoice','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','express','invoice','padStart','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','</td>','True','/view/add_sales','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','DRY\x20GOODS','<div>','$product_details','note','back','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'];a0_0x1b52=function(){return _0xf6a167;};return a0_0x1b52();}(function(_0x2cc9a6,_0x118063){var _0x367938=a0_0x3c7c,_0x15032a=_0x2cc9a6();while(!![]){try{var _0x49ba56=parseInt(_0x367938(0x141))/0x1*(-parseInt(_0x367938(0xc6))/0x2)+parseInt(_0x367938(0x16e))/0x3*(parseInt(_0x367938(0x15a))/0x4)+parseInt(_0x367938(0xfb))/0x5+parseInt(_0x367938(0x100))/0x6*(parseInt(_0x367938(0x132))/0x7)+parseInt(_0x367938(0x14a))/0x8+parseInt(_0x367938(0x97))/0x9*(-parseInt(_0x367938(0xb8))/0xa)+-parseInt(_0x367938(0xc8))/0xb;if(_0x49ba56===_0x118063)break;else _0x15032a['push'](_0x15032a['shift']());}catch(_0x2ff0f8){_0x15032a['push'](_0x15032a['shift']());}}}(a0_0x1b52,0x64d61));const express=require(a0_0x7ab6bd(0x104)),app=express(),router=express[a0_0x7ab6bd(0x16d)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x7ab6bd(0x134)),auth=require(a0_0x7ab6bd(0x168)),nodemailer=require('nodemailer'),users=require(a0_0x7ab6bd(0xc2));router[a0_0x7ab6bd(0xfc)](a0_0x7ab6bd(0xdc),auth,async(_0x5e9035,_0x9c1db)=>{var _0x59cc02=a0_0x7ab6bd;try{const {username:_0x211c50,email:_0x49fd00,role:_0x1db721}=_0x5e9035[_0x59cc02(0x99)],_0x27667e=_0x5e9035[_0x59cc02(0x99)],_0x107ebe=await profile[_0x59cc02(0x155)]({'email':_0x27667e[_0x59cc02(0x95)]}),_0x392dfa=await master_shop[_0x59cc02(0xbc)]();let _0x14988c;if(_0x27667e['role']==_0x59cc02(0x178)){const _0x46f6dd=await staff[_0x59cc02(0x155)]({'email':_0x27667e[_0x59cc02(0x95)]});_0x14988c=await sales_finished[_0x59cc02(0x16b)]([{'$lookup':{'from':'customers','localField':'customer','foreignField':_0x59cc02(0x17a),'as':_0x59cc02(0x174)}},{'$unwind':_0x59cc02(0xff)},{'$unwind':_0x59cc02(0x15b)},{'$group':{'_id':_0x59cc02(0x11b),'invoice':{'$first':_0x59cc02(0xaa)},'customers':{'$first':_0x59cc02(0x87)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x59cc02(0x15b)},'note':{'$first':'$note'},'return_data':{'$first':_0x59cc02(0x133)},'customers_docs':{'$first':_0x59cc02(0xff)},'total_saleproduct_quantity':{'$sum':_0x59cc02(0x140)},'level':{'$addToSet':_0x59cc02(0xbe)},'isle':{'$addToSet':_0x59cc02(0xba)},'type':{'$addToSet':_0x59cc02(0x163)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x59cc02(0xea)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x14988c=await sales_finished[_0x59cc02(0x16b)]([{'$lookup':{'from':_0x59cc02(0x9b),'localField':_0x59cc02(0x15d),'foreignField':_0x59cc02(0x17a),'as':_0x59cc02(0x174)}},{'$unwind':_0x59cc02(0xff)},{'$unwind':'$sale_product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x59cc02(0xaa)},'customers':{'$first':_0x59cc02(0x87)},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x59cc02(0x8e)},'return_data':{'$first':_0x59cc02(0x133)},'customers_docs':{'$first':_0x59cc02(0xff)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x59cc02(0xbe)},'isle':{'$addToSet':_0x59cc02(0xba)},'type':{'$addToSet':_0x59cc02(0x163)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0x392dfa[0x0][_0x59cc02(0x122)]==_0x59cc02(0x17f)){var _0x51749a=users['English'];console[_0x59cc02(0x182)](_0x51749a);}else{if(_0x392dfa[0x0]['language']==_0x59cc02(0x127))var _0x51749a=users[_0x59cc02(0x127)];else{if(_0x392dfa[0x0][_0x59cc02(0x122)]==_0x59cc02(0xf0))var _0x51749a=users[_0x59cc02(0xf0)];else{if(_0x392dfa[0x0][_0x59cc02(0x122)]=='Spanish')var _0x51749a=users[_0x59cc02(0xd1)];else{if(_0x392dfa[0x0][_0x59cc02(0x122)]==_0x59cc02(0x176))var _0x51749a=users[_0x59cc02(0x176)];else{if(_0x392dfa[0x0][_0x59cc02(0x122)]==_0x59cc02(0xec))var _0x51749a=users[_0x59cc02(0x98)];else{if(_0x392dfa[0x0][_0x59cc02(0x122)]=='Chinese')var _0x51749a=users[_0x59cc02(0x17e)];else{if(_0x392dfa[0x0][_0x59cc02(0x122)]==_0x59cc02(0x144))var _0x51749a=users['Arabic'];}}}}}}}_0x9c1db[_0x59cc02(0xf8)](_0x59cc02(0x154),{'success':_0x5e9035['flash'](_0x59cc02(0xf1)),'errors':_0x5e9035[_0x59cc02(0xe8)]('errors'),'sales':_0x14988c,'profile':_0x107ebe,'role':_0x27667e,'master_shop':_0x392dfa,'language':_0x51749a});}catch(_0x47110f){console[_0x59cc02(0x182)](_0x47110f);}});async function getRandom8DigitNumber(){var _0x365782=a0_0x7ab6bd;const _0x229f52=0x989680,_0x536785=0x5f5e0ff,_0x11d05b=Math[_0x365782(0xb7)](Math['random']()*(_0x536785-_0x229f52+0x1))+_0x229f52;var _0x30e165;const _0x231d9a=await sales_finished[_0x365782(0x155)]({'invoice':'OUTF-'+_0x11d05b});return _0x231d9a&&_0x231d9a[_0x365782(0xc9)]>0x0?_0x30e165=_0x365782(0x11f)+_0x11d05b:_0x30e165=_0x365782(0x11f)+_0x11d05b,_0x30e165;}function a0_0x3c7c(_0x5abf26,_0x1191a2){var _0x1b522f=a0_0x1b52();return a0_0x3c7c=function(_0x3c7cbe,_0x37ce50){_0x3c7cbe=_0x3c7cbe-0x81;var _0x352db5=_0x1b522f[_0x3c7cbe];return _0x352db5;},a0_0x3c7c(_0x5abf26,_0x1191a2);}router['get'](a0_0x7ab6bd(0x10a),auth,async(_0x2e95a1,_0x33625f)=>{var _0x2a0485=a0_0x7ab6bd;try{const {username:_0x3ad12b,email:_0x4a8b79,role:_0x5d2074}=_0x2e95a1[_0x2a0485(0x99)],_0x46d8c1=_0x2e95a1['user'],_0x31a19a=await profile['findOne']({'email':_0x46d8c1[_0x2a0485(0x95)]}),_0x356282=await master_shop[_0x2a0485(0xbc)](),_0x258c5b=await customer[_0x2a0485(0xbc)]({});let _0x48d3af;if(_0x46d8c1[_0x2a0485(0xfd)]=='staff'){const _0x50e6a0=await staff[_0x2a0485(0x155)]({'email':_0x46d8c1['email']});_0x48d3af=await warehouse[_0x2a0485(0x16b)]([{'$match':{'status':'Enabled','name':_0x50e6a0['warehouse'],'warehouse_category':_0x2a0485(0x186),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x2a0485(0x9d),'name':{'$first':_0x2a0485(0x9d)}}},{'$sort':{'name':0x1}}]);}else _0x48d3af=await warehouse[_0x2a0485(0x16b)]([{'$match':{'status':'Enabled','warehouse_category':_0x2a0485(0x186),'name':{'$ne':_0x2a0485(0x113)}}},{'$group':{'_id':_0x2a0485(0x9d),'name':{'$first':_0x2a0485(0x9d)}}},{'$sort':{'name':0x1}}]);const _0x1dc866=await product[_0x2a0485(0xbc)]({});var _0x1a51c3=[_0x2a0485(0x169),_0x2a0485(0x138)];const _0x5ada22=await sales_finished[_0x2a0485(0xbc)]({}),_0x3a3e4a=_0x5ada22[_0x2a0485(0xc9)]+0x1,_0x26c3e4=_0x2a0485(0x11f)+_0x3a3e4a[_0x2a0485(0x116)]()[_0x2a0485(0x106)](0x5,'0');if(_0x356282[0x0][_0x2a0485(0x122)]==_0x2a0485(0x17f)){var _0x4691a8=users['English'];console[_0x2a0485(0x182)](_0x4691a8);}else{if(_0x356282[0x0][_0x2a0485(0x122)]==_0x2a0485(0x127))var _0x4691a8=users[_0x2a0485(0x127)];else{if(_0x356282[0x0][_0x2a0485(0x122)]==_0x2a0485(0xf0))var _0x4691a8=users[_0x2a0485(0xf0)];else{if(_0x356282[0x0]['language']==_0x2a0485(0xd1))var _0x4691a8=users[_0x2a0485(0xd1)];else{if(_0x356282[0x0][_0x2a0485(0x122)]=='French')var _0x4691a8=users[_0x2a0485(0x176)];else{if(_0x356282[0x0][_0x2a0485(0x122)]==_0x2a0485(0xec))var _0x4691a8=users['Portuguese'];else{if(_0x356282[0x0][_0x2a0485(0x122)]=='Chinese')var _0x4691a8=users[_0x2a0485(0x17e)];else{if(_0x356282[0x0][_0x2a0485(0x122)]==_0x2a0485(0x144))var _0x4691a8=users[_0x2a0485(0xd4)];}}}}}}}const _0x5eda51=getRandom8DigitNumber();_0x5eda51[_0x2a0485(0x189)](_0x1c76a2=>{var _0x55a77c=_0x2a0485;_0x33625f[_0x55a77c(0xf8)]('add_sales_finished',{'success':_0x2e95a1[_0x55a77c(0xe8)](_0x55a77c(0xf1)),'errors':_0x2e95a1[_0x55a77c(0xe8)](_0x55a77c(0x146)),'role':_0x46d8c1,'profile':_0x31a19a,'customer':_0x258c5b,'warehouse':_0x48d3af,'product':_0x1dc866,'invoice':_0x1c76a2,'master_shop':_0x356282,'language':_0x4691a8,'rooms_data':_0x1a51c3});})[_0x2a0485(0x9f)](_0x373169=>{var _0x51a779=_0x2a0485;_0x2e95a1[_0x51a779(0xe8)]('errors',_0x51a779(0x16f)),_0x33625f[_0x51a779(0x18d)](_0x51a779(0xf9));});}catch(_0x3b55a3){console['log'](_0x3b55a3);}}),router[a0_0x7ab6bd(0xfc)](a0_0x7ab6bd(0xf2),auth,async(_0x38b911,_0x32d674)=>{var _0x3d3615=a0_0x7ab6bd;try{const _0xc36867=_0x38b911['params']['id'];console[_0x3d3615(0x182)](_0xc36867);const _0x58609b=await product[_0x3d3615(0xbc)](),_0x5da9ba=await purchases[_0x3d3615(0x16b)]([{'$match':{'warehouse_name':_0xc36867}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]);console[_0x3d3615(0x182)](_0x3d3615(0xee),_0x5da9ba),_0x32d674[_0x3d3615(0x92)](0xc8)[_0x3d3615(0x196)]({'purchases_data':_0x5da9ba,'product_data':_0x58609b});}catch(_0x21fcc7){console[_0x3d3615(0x182)](_0x21fcc7);}}),router['post'](a0_0x7ab6bd(0x180),auth,async(_0x1966c9,_0x58c314)=>{var _0x221ec9=a0_0x7ab6bd;try{const {warehouse_data:_0x2b433e,product_data:_0x5e37e0}=_0x1966c9[_0x221ec9(0x194)];console[_0x221ec9(0x182)](_0x1966c9['body'][_0x221ec9(0x151)]);;const _0x204d14=await master_shop['find']();console[_0x221ec9(0x182)](_0x221ec9(0x89),_0x204d14);const _0x3f60f8=await product[_0x221ec9(0x155)]({'name':_0x5e37e0});console[_0x221ec9(0x182)]('product',_0x3f60f8);const _0x22dbe4=await warehouse[_0x221ec9(0x16b)]([{'$match':{'name':_0x2b433e}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x5e37e0}},{'$group':{'_id':'$product_details.product_name','product_stock':{'$first':_0x221ec9(0x88)}}}]);console[_0x221ec9(0x182)]('stock_data',_0x22dbe4),_0x58c314['status'](0xc8)[_0x221ec9(0x196)]({'master':_0x204d14,'new_product':_0x3f60f8,'stock_data':_0x22dbe4});}catch(_0x369afe){console[_0x221ec9(0x182)](_0x369afe);}}),router[a0_0x7ab6bd(0xe4)](a0_0x7ab6bd(0x10a),auth,async(_0x519d48,_0x201e94)=>{var _0x9ff80c=a0_0x7ab6bd;try{const {invoice:_0x453fb1,date:_0x41feac,warehouse_name:_0x42dd75,product_name:_0x322453,stock:_0x26bd49,quantity:_0x5dbc8a,note:_0xbd8d3c,room:_0x192d07,primary_code:_0x37d432,secondary_code:_0x46b614,prod_code:_0x30d9a7,level:_0x19290a,isle:_0x38ebe0,pallet:_0x52a8db,batch_code:_0x206ce0,SCRN:_0x599221,expiry_date:_0x58d331,mode_transpo:_0xc30d5c,name_driver:_0x535c5b}=_0x519d48['body'];if(typeof _0x322453==_0x9ff80c(0xd0))var _0x4350d3=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x160)]],_0x1bdca7=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0xa2)]],_0x5615e7=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0xb0)]],_0x2d1eb2=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x120)]],_0x3a20b2=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0xa6)]],_0x17a5ff=[_0x519d48[_0x9ff80c(0x194)]['prod_code']],_0x3254b7=[_0x519d48[_0x9ff80c(0x194)]['level']],_0x5d6d05=[_0x519d48['body'][_0x9ff80c(0x13c)]],_0x1b0540=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x8a)]],_0x1b2b13=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x18a)]],_0xad223d=[_0x519d48[_0x9ff80c(0x194)]['expiry_date']],_0xdc165f=[_0x519d48['body'][_0x9ff80c(0x118)]],_0x478ec4=[_0x519d48['body'][_0x9ff80c(0xf6)]],_0xcfe22a=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0xf5)]],_0x3f90f1=[_0x519d48[_0x9ff80c(0x194)]['RoomAssigned']],_0x159e5d=[_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x93)]];else var _0x4350d3=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x160)]],_0x1bdca7=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0xa2)]],_0x5615e7=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0xb0)]],_0x2d1eb2=[..._0x519d48[_0x9ff80c(0x194)]['primary_code']],_0x3a20b2=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0xa6)]],_0x17a5ff=[..._0x519d48['body'][_0x9ff80c(0xbd)]],_0x3254b7=[..._0x519d48[_0x9ff80c(0x194)]['level']],_0x5d6d05=[..._0x519d48[_0x9ff80c(0x194)]['primary_unit']],_0x1b0540=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x8a)]],_0x1b2b13=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x18a)]],_0xad223d=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x126)]],_0xdc165f=[..._0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x118)]],_0x478ec4=[..._0x519d48['body']['max_per_unit']],_0xcfe22a=[..._0x519d48['body'][_0x9ff80c(0xf5)]],_0x3f90f1=[..._0x519d48[_0x9ff80c(0x194)]['RoomAssigned']],_0x159e5d=[..._0x519d48['body'][_0x9ff80c(0x93)]];const _0x1eae4b=_0x4350d3[_0x9ff80c(0xcf)](_0x2add5f=>{return _0x2add5f={'product_name':_0x2add5f};});_0x1bdca7[_0x9ff80c(0x16a)]((_0x305ee5,_0x137f45)=>{var _0x5cedb9=_0x9ff80c;_0x1eae4b[_0x137f45][_0x5cedb9(0xa2)]=_0x305ee5;}),_0x5615e7[_0x9ff80c(0x16a)]((_0x466eea,_0x4132ff)=>{_0x1eae4b[_0x4132ff]['quantity']=Math['abs'](_0x466eea);}),_0x2d1eb2[_0x9ff80c(0x16a)]((_0x3218cb,_0x91072f)=>{var _0x2a3daa=_0x9ff80c;_0x1eae4b[_0x91072f][_0x2a3daa(0x120)]=_0x3218cb;}),_0x3a20b2[_0x9ff80c(0x16a)]((_0x5ee3d5,_0x1bf2c5)=>{var _0x106f63=_0x9ff80c;_0x1eae4b[_0x1bf2c5][_0x106f63(0xa6)]=_0x5ee3d5;}),_0x17a5ff[_0x9ff80c(0x16a)]((_0x3d0b81,_0x5d4c59)=>{var _0xffad1f=_0x9ff80c;_0x1eae4b[_0x5d4c59][_0xffad1f(0x195)]=_0x3d0b81;}),_0x3254b7[_0x9ff80c(0x16a)]((_0x3f46af,_0x5a679)=>{_0x1eae4b[_0x5a679]['bay']=_0x3f46af;}),_0x5d6d05[_0x9ff80c(0x16a)]((_0x3750c0,_0x5292b7)=>{var _0x245cf1=_0x9ff80c;_0x1eae4b[_0x5292b7][_0x245cf1(0x13e)]=_0x3750c0;}),_0x1b0540['forEach']((_0x205c88,_0x394023)=>{var _0x37a381=_0x9ff80c;_0x1eae4b[_0x394023][_0x37a381(0x8a)]=_0x205c88;}),_0x1b2b13['forEach']((_0x4a0975,_0x118e04)=>{var _0x211e87=_0x9ff80c;_0x1eae4b[_0x118e04][_0x211e87(0x18a)]=_0x4a0975;}),_0xad223d[_0x9ff80c(0x16a)]((_0x2c61fa,_0x311b86)=>{var _0x2d7bcc=_0x9ff80c;_0x1eae4b[_0x311b86][_0x2d7bcc(0x126)]=_0x2c61fa;}),_0xdc165f[_0x9ff80c(0x16a)]((_0x5336ca,_0x3b2c43)=>{var _0xd441a5=_0x9ff80c;_0x1eae4b[_0x3b2c43][_0xd441a5(0x119)]=_0x5336ca;}),_0x478ec4[_0x9ff80c(0x16a)]((_0x3de535,_0x381fb2)=>{_0x1eae4b[_0x381fb2]['maxperunit']=_0x3de535;}),_0xcfe22a[_0x9ff80c(0x16a)]((_0x51d2ba,_0x6f7141)=>{var _0x1a264f=_0x9ff80c;_0x1eae4b[_0x6f7141][_0x1a264f(0xf5)]=_0x51d2ba;}),_0x3f90f1[_0x9ff80c(0x16a)]((_0x146fd7,_0x41ff08)=>{var _0x84d66f=_0x9ff80c;_0x1eae4b[_0x41ff08][_0x84d66f(0xa8)]=_0x146fd7;}),_0x159e5d['forEach']((_0x5a44c6,_0x20b40b)=>{var _0x746955=_0x9ff80c;_0x1eae4b[_0x20b40b][_0x746955(0x105)]=_0x5a44c6;});var _0x1dba4d=0x0;_0x1eae4b[_0x9ff80c(0x16a)](_0x34a8e7=>{var _0xa8e7b9=_0x9ff80c;parseFloat(_0x34a8e7[_0xa8e7b9(0xa2)])<parseFloat(_0x34a8e7[_0xa8e7b9(0xc0)])&&parseFloat(_0x34a8e7[_0xa8e7b9(0xc0)])>parseFloat(_0x34a8e7[_0xa8e7b9(0xa2)])&&(console[_0xa8e7b9(0x182)](_0x34a8e7[_0xa8e7b9(0xa2)]+_0xa8e7b9(0x149)+_0x34a8e7[_0xa8e7b9(0xc0)]),_0x1dba4d++);});if(_0x1dba4d!=0x0)return _0x519d48['flash']('errors',_0x9ff80c(0xed)),_0x201e94[_0x9ff80c(0x18d)](_0x9ff80c(0x110));const _0x27384a=_0x1eae4b[_0x9ff80c(0x171)](_0x1c738e=>_0x1c738e[_0x9ff80c(0xc0)]!=='0'&&_0x1c738e['quantity']!==''),_0x304359=new sales_finished({'invoice':_0x453fb1,'customer':_0x519d48['body'][_0x9ff80c(0x15d)],'date':_0x41feac,'warehouse_name':_0x42dd75,'sale_product':_0x27384a,'note':_0xbd8d3c,'room':_0x192d07,'primary_code':_0x37d432,'secondary_code':_0x46b614,'prod_code':_0x30d9a7,'SCRN':_0x599221,'finalize':_0x9ff80c(0xb1),'mode_transpo':_0xc30d5c,'name_driver':_0x535c5b}),_0x4688cb=await _0x304359[_0x9ff80c(0x166)](),_0x55637a=await sales_finished[_0x9ff80c(0x155)]({'invoice':_0x453fb1}),_0x579caf=new c_payment_data({'invoice':_0x453fb1,'customer':_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x15d)],'reason':_0x9ff80c(0xe2)});await _0x579caf[_0x9ff80c(0x166)]();const _0x3322f4=await master_shop[_0x9ff80c(0xbc)](),_0xfdc7bc=await email_settings[_0x9ff80c(0x155)](),_0x4b0176=await customer[_0x9ff80c(0x155)]({'name':_0x519d48[_0x9ff80c(0x194)][_0x9ff80c(0x15d)]});_0x3322f4[0x0][_0x9ff80c(0x14e)]==0x1?(right_currency=_0x3322f4[0x0][_0x9ff80c(0x96)],left_currency=''):(right_currency='',left_currency=_0x3322f4[0x0][_0x9ff80c(0x96)]);var _0x415cfd=_0x4350d3,_0x6ffb09=_0x5615e7,_0x181663='',_0x45b909;for(_0x45b909 in _0x415cfd){_0x181663+=_0x9ff80c(0x15e)+_0x9ff80c(0x103)+_0x415cfd[_0x45b909]+_0x9ff80c(0x108)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x6ffb09[_0x45b909]+_0x9ff80c(0x108)+'</tr>';}console[_0x9ff80c(0x182)](_0x9ff80c(0x18f),_0x181663);let _0x57144e=nodemailer['createTransport']({'service':_0x9ff80c(0x191),'auth':{'user':_0xfdc7bc[_0x9ff80c(0x95)],'pass':_0xfdc7bc[_0x9ff80c(0xe9)]}}),_0x162e57={'from':_0xfdc7bc[_0x9ff80c(0x95)],'to':_0x4b0176[_0x9ff80c(0x95)],'subject':'Sale\x20Product\x20Mail','attachments':[{'filename':_0x9ff80c(0x12a),'path':__dirname+'/../public'+'/upload/'+_0x3322f4[0x0][_0x9ff80c(0x94)],'cid':_0x9ff80c(0xdb)}],'html':'<!DOCTYPE\x20html>'+_0x9ff80c(0x90)+_0x9ff80c(0xcc)+'<div>'+_0x9ff80c(0xfe)+_0x9ff80c(0x10d)+_0x9ff80c(0x130)+_0x9ff80c(0x12e)+_0x9ff80c(0x10d)+'<h2>\x20'+_0x3322f4[0x0][_0x9ff80c(0xb9)]+_0x9ff80c(0x125)+_0x9ff80c(0x12e)+_0x9ff80c(0x12e)+_0x9ff80c(0x81)+_0x9ff80c(0x10d)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x9ff80c(0x13b)+_0x453fb1+'\x20'+_0x9ff80c(0x187)+_0x9ff80c(0x158)+_0x41feac+'\x20'+_0x9ff80c(0x193)+_0x9ff80c(0x82)+_0x9ff80c(0x12e)+_0x9ff80c(0x165)+_0x9ff80c(0x10b)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x9ff80c(0xd5)+_0x9ff80c(0x8f)+_0x9ff80c(0x184)+_0x9ff80c(0xb6)+'\x20'+_0x181663+'\x20'+'</tbody>'+_0x9ff80c(0x85)+_0x9ff80c(0x10d)+_0x9ff80c(0xb2)+_0x9ff80c(0x124)+_0x3322f4[0x0][_0x9ff80c(0xb9)]+'</h5>'+_0x9ff80c(0x12e)+'</div>'+_0x9ff80c(0xf3)};_0x57144e[_0x9ff80c(0x170)](_0x162e57,function(_0x4311f1,_0x18b12c){var _0x1e17d2=_0x9ff80c;_0x4311f1?(console[_0x1e17d2(0x182)](_0x4311f1),console['log'](_0x1e17d2(0x14f))):console[_0x1e17d2(0x182)](_0x1e17d2(0x157));}),_0x519d48[_0x9ff80c(0xe8)](_0x9ff80c(0xf1),'Sales\x20Add\x20successfully'),_0x201e94[_0x9ff80c(0x18d)](_0x9ff80c(0x11d)+_0x4688cb['_id']);}catch(_0x4a2842){console[_0x9ff80c(0x182)](_0x4a2842);}}),router[a0_0x7ab6bd(0xfc)](a0_0x7ab6bd(0x173),auth,async(_0x37539a,_0x425da4)=>{var _0x504ab5=a0_0x7ab6bd;try{const {username:_0x267c45,email:_0x26dbc2,role:_0x41056c}=_0x37539a[_0x504ab5(0x99)],_0x381688=_0x37539a[_0x504ab5(0x99)],_0x37e714=await profile[_0x504ab5(0x155)]({'email':_0x381688['email']}),_0x4d427c=await master_shop[_0x504ab5(0xbc)](),_0x3cc02a=_0x37539a[_0x504ab5(0xe6)]['id'],_0x5958fd=await sales_finished[_0x504ab5(0xb4)](_0x3cc02a),_0x5a7a4b=await warehouse[_0x504ab5(0x16b)]([{'$match':{'name':_0x5958fd['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x504ab5(0xaf),'name':{'$first':_0x504ab5(0xe7)},'product_stock':{'$first':_0x504ab5(0x88)},'bay':{'$first':_0x504ab5(0x101)},'bin':{'$first':_0x504ab5(0xd3)},'type':{'$first':_0x504ab5(0xd9)},'floorlevel':{'$first':_0x504ab5(0xeb)},'primary_code':{'$first':_0x504ab5(0x91)},'secondary_code':{'$first':_0x504ab5(0x11a)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x504ab5(0x179)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x504ab5(0x11c)},'production_date':{'$first':_0x504ab5(0xab)},'batch_code':{'$first':_0x504ab5(0xc4)},'room':{'$first':_0x504ab5(0xcb)}}}]),_0x453ada=await customer['find']({});let _0x4e73c5;if(_0x381688[_0x504ab5(0xfd)]==_0x504ab5(0x178)){const _0x5372ec=await staff[_0x504ab5(0x155)]({'email':_0x381688[_0x504ab5(0x95)]});_0x4e73c5=await warehouse[_0x504ab5(0x16b)]([{'$match':{'status':_0x504ab5(0xf7),'name':_0x5372ec[_0x504ab5(0xbb)]}},{'$group':{'_id':_0x504ab5(0x9d),'name':{'$first':_0x504ab5(0x9d)}}}]);}else _0x4e73c5=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x504ab5(0x9d)}}}]);const _0x2e62cd=await product[_0x504ab5(0xbc)]({});if(_0x4d427c[0x0][_0x504ab5(0x122)]=='English\x20(US)'){var _0x2ace07=users['English'];console['log'](_0x2ace07);}else{if(_0x4d427c[0x0]['language']==_0x504ab5(0x127))var _0x2ace07=users['Hindi'];else{if(_0x4d427c[0x0][_0x504ab5(0x122)]==_0x504ab5(0xf0))var _0x2ace07=users[_0x504ab5(0xf0)];else{if(_0x4d427c[0x0][_0x504ab5(0x122)]==_0x504ab5(0xd1))var _0x2ace07=users[_0x504ab5(0xd1)];else{if(_0x4d427c[0x0][_0x504ab5(0x122)]==_0x504ab5(0x176))var _0x2ace07=users['French'];else{if(_0x4d427c[0x0][_0x504ab5(0x122)]==_0x504ab5(0xec))var _0x2ace07=users[_0x504ab5(0x98)];else{if(_0x4d427c[0x0][_0x504ab5(0x122)]==_0x504ab5(0x17e))var _0x2ace07=users[_0x504ab5(0x17e)];else{if(_0x4d427c[0x0]['language']==_0x504ab5(0x144))var _0x2ace07=users[_0x504ab5(0xd4)];}}}}}}}_0x425da4[_0x504ab5(0xf8)](_0x504ab5(0x9e),{'success':_0x37539a['flash'](_0x504ab5(0xf1)),'errors':_0x37539a[_0x504ab5(0xe8)](_0x504ab5(0x146)),'role':_0x381688,'profile':_0x37e714,'customer':_0x453ada,'warehouse':_0x4e73c5,'product':_0x5a7a4b,'user':_0x5958fd,'master_shop':_0x4d427c,'unit':_0x2e62cd,'language':_0x2ace07});}catch(_0x2262b8){console[_0x504ab5(0x182)](_0x2262b8);}}),router[a0_0x7ab6bd(0xe4)](a0_0x7ab6bd(0x173),auth,async(_0x12a1ea,_0x562634)=>{var _0x2b6e4c=a0_0x7ab6bd;try{const _0x25d3a0=_0x12a1ea['params']['id'],{invoice:_0x1bceaf,warehouse_name:_0x368f17,room:_0x218792}=_0x12a1ea[_0x2b6e4c(0x194)],_0x2eaee1=await sales_finished[_0x2b6e4c(0x155)]({'invoice':_0x1bceaf}),_0x36c836=_0x2eaee1[_0x2b6e4c(0x164)][_0x2b6e4c(0xcf)](async _0x4124f6=>{var _0x25a178=_0x2b6e4c,_0x2844f2=await warehouse[_0x25a178(0x155)]({'name':_0x368f17,'room':_0x4124f6[_0x25a178(0xa8)],'warehouse_category':'Finished\x20Goods'});const _0x49ea80=_0x2844f2['product_details']['map'](_0x256487=>{var _0x211818=_0x25a178;_0x256487[_0x211818(0x160)]==_0x4124f6['product_name']&&_0x256487[_0x211818(0x111)]==_0x4124f6[_0x211818(0x111)]&&_0x256487[_0x211818(0x126)]==_0x4124f6[_0x211818(0x126)]&&_0x256487[_0x211818(0x119)]==_0x4124f6[_0x211818(0x119)]&&_0x256487[_0x211818(0x18a)]==_0x4124f6['batch_code']&&_0x256487[_0x211818(0x105)]==_0x4124f6[_0x211818(0x105)]&&(_0x256487[_0x211818(0xdf)]=Math['abs'](_0x256487[_0x211818(0xdf)])-Math[_0x211818(0x183)](_0x4124f6[_0x211818(0xc0)]));});return _0x2844f2;});Promise[_0x2b6e4c(0x83)](_0x36c836)['then'](async _0x2ba72e=>{var _0x48f3ba=_0x2b6e4c;try{for(const _0x22366 of _0x2ba72e){await _0x22366['save']();}_0x2eaee1['finalize']=_0x48f3ba(0x109);const _0x5c87f0=await _0x2eaee1[_0x48f3ba(0x166)](),_0x441e97=await master_shop[_0x48f3ba(0xbc)](),_0x5ecae6=await email_settings[_0x48f3ba(0x155)](),_0x1f47eb=await supervisor_settings[_0x48f3ba(0xbc)]();var _0x50466b=_0x2eaee1[_0x48f3ba(0x164)],_0x1d7288='',_0x3eb587;for(_0x3eb587 in _0x50466b){var _0x1fb103='FG';_0x2eaee1[_0x48f3ba(0x9c)]==_0x48f3ba(0x10c)&&(_0x1fb103='DG'),_0x1d7288+=_0x48f3ba(0x15e)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x50466b[_0x3eb587][_0x48f3ba(0x160)]+_0x48f3ba(0x108)+_0x48f3ba(0x103)+_0x50466b[_0x3eb587][_0x48f3ba(0x195)]+_0x48f3ba(0x108)+_0x48f3ba(0x103)+_0x50466b[_0x3eb587][_0x48f3ba(0xc0)]+_0x48f3ba(0x108)+_0x48f3ba(0x103)+_0x50466b[_0x3eb587][_0x48f3ba(0x13e)]+'</td>'+_0x48f3ba(0x103)+_0x50466b[_0x3eb587][_0x48f3ba(0x8a)]+_0x48f3ba(0x108)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2eaee1[_0x48f3ba(0x9c)]+_0x48f3ba(0x108)+_0x48f3ba(0x103)+_0x50466b[_0x3eb587][_0x48f3ba(0xa8)]+'</td>'+_0x48f3ba(0x103)+_0x1fb103+_0x50466b[_0x3eb587][_0x48f3ba(0x111)]+_0x48f3ba(0x108);}let _0x1cb874=nodemailer['createTransport']({'host':_0x5ecae6[_0x48f3ba(0x150)],'port':Number(_0x5ecae6[_0x48f3ba(0x177)]),'secure':![],'auth':{'user':_0x5ecae6[_0x48f3ba(0x95)],'pass':_0x5ecae6[_0x48f3ba(0xe9)]}}),_0x148a80={'from':_0x5ecae6[_0x48f3ba(0x95)],'to':_0x1f47eb[0x0][_0x48f3ba(0x148)],'subject':_0x48f3ba(0xae),'attachments':[{'filename':'Logo.png','path':__dirname+_0x48f3ba(0x18b)+_0x48f3ba(0x14c)+_0x441e97[0x0][_0x48f3ba(0x94)],'cid':'logo'}],'html':_0x48f3ba(0x162)+_0x48f3ba(0x90)+_0x48f3ba(0xcc)+'<div>'+_0x48f3ba(0xfe)+_0x48f3ba(0x10d)+_0x48f3ba(0x130)+_0x48f3ba(0x12e)+_0x48f3ba(0x10d)+'<h2>\x20'+_0x441e97[0x0]['site_title']+'\x20</h2>'+_0x48f3ba(0x12e)+_0x48f3ba(0x12e)+'<hr\x20class=\x22my-3\x22>'+_0x48f3ba(0x10d)+_0x48f3ba(0xe5)+_0x48f3ba(0x13b)+_0x2eaee1[_0x48f3ba(0x105)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x48f3ba(0x158)+_0x2eaee1[_0x48f3ba(0x123)]+'\x20'+_0x48f3ba(0x193)+_0x48f3ba(0x82)+'</div>'+_0x48f3ba(0x165)+_0x48f3ba(0x10b)+_0x48f3ba(0x15e)+_0x48f3ba(0xa5)+_0x48f3ba(0x17d)+_0x48f3ba(0x15f)+_0x48f3ba(0x13f)+_0x48f3ba(0x14d)+_0x48f3ba(0x172)+_0x48f3ba(0x159)+_0x48f3ba(0x112)+_0x48f3ba(0x8f)+_0x48f3ba(0x184)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1d7288+'\x20'+_0x48f3ba(0xa1)+_0x48f3ba(0x85)+_0x48f3ba(0x10d)+_0x48f3ba(0xb2)+_0x48f3ba(0x124)+_0x441e97[0x0]['site_title']+_0x48f3ba(0x82)+'</div>'+'</div>'+_0x48f3ba(0xf3)};_0x1cb874[_0x48f3ba(0x170)](_0x148a80,function(_0x51497e,_0x5a5c2e){var _0x43211d=_0x48f3ba;_0x51497e?(console['log'](_0x51497e),console[_0x43211d(0x182)](_0x43211d(0x14f))):console[_0x43211d(0x182)](_0x43211d(0x157));}),_0x12a1ea[_0x48f3ba(0xe8)](_0x48f3ba(0xf1),_0x48f3ba(0x156)),_0x562634[_0x48f3ba(0x18d)](_0x48f3ba(0xef)+_0x25d3a0);}catch(_0x37c11b){console[_0x48f3ba(0xb5)](_0x37c11b),_0x562634['status'](0x1f4)[_0x48f3ba(0x196)]({'error':_0x48f3ba(0xd6)});}})[_0x2b6e4c(0x9f)](_0x3340d2=>{var _0x359bf9=_0x2b6e4c;console[_0x359bf9(0xb5)](_0x3340d2),_0x562634[_0x359bf9(0x92)](0x1f4)[_0x359bf9(0x196)]({'error':_0x359bf9(0xac)});});}catch(_0x538ea2){console[_0x2b6e4c(0x182)](_0x538ea2);}}),router['get'](a0_0x7ab6bd(0x167),auth,async(_0x14f1b7,_0x45dabb)=>{var _0x1dbfb2=a0_0x7ab6bd;try{const {username:_0x31cf36,email:_0x2bda25,role:_0x520164}=_0x14f1b7[_0x1dbfb2(0x99)],_0x261a92=_0x14f1b7[_0x1dbfb2(0x99)],_0x343974=await profile[_0x1dbfb2(0x155)]({'email':_0x261a92[_0x1dbfb2(0x95)]}),_0x3b5988=await master_shop['find'](),_0x54d53c=_0x14f1b7['params']['id'],_0x1ea1fb=await sales_finished[_0x1dbfb2(0xb4)](_0x54d53c);let _0x3282dc=new Date(_0x1ea1fb[_0x1dbfb2(0x126)]),_0x5120c1=('0'+_0x3282dc[_0x1dbfb2(0x117)]())[_0x1dbfb2(0x8b)](-0x2),_0x1c73ef=('0'+(_0x3282dc[_0x1dbfb2(0xe0)]()+0x1))[_0x1dbfb2(0x8b)](-0x2),_0x369148=_0x3282dc[_0x1dbfb2(0xa7)](),_0x424c41=_0x369148+'-'+_0x1c73ef+'-'+_0x5120c1;var _0x1c59fb=['Ambient',_0x1dbfb2(0x138)];const _0x2efe92=await warehouse[_0x1dbfb2(0x16b)]([{'$match':{'name':_0x1ea1fb[_0x1dbfb2(0x9c)],'room':_0x1ea1fb[_0x1dbfb2(0x152)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1dbfb2(0xaf),'name':{'$first':_0x1dbfb2(0xe7)},'product_stock':{'$first':_0x1dbfb2(0x88)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1dbfb2(0xd9)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1dbfb2(0x91)},'secondary_code':{'$first':_0x1dbfb2(0x11a)},'product_code':{'$first':_0x1dbfb2(0xa3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1dbfb2(0xa0)}}}]),_0x54bb71=await customer[_0x1dbfb2(0xbc)]({});let _0x455b36;if(_0x261a92['role']==_0x1dbfb2(0x178)){const _0x34600a=await staff['findOne']({'email':_0x261a92['email']});_0x455b36=await warehouse[_0x1dbfb2(0x16b)]([{'$match':{'status':_0x1dbfb2(0xf7),'name':_0x34600a[_0x1dbfb2(0xbb)]}},{'$group':{'_id':_0x1dbfb2(0x9d),'name':{'$first':_0x1dbfb2(0x9d)}}}]);}else _0x455b36=await warehouse[_0x1dbfb2(0x16b)]([{'$match':{'status':_0x1dbfb2(0xf7)}},{'$group':{'_id':_0x1dbfb2(0x9d),'name':{'$first':_0x1dbfb2(0x9d)}}}]);const _0x541b7c=await product[_0x1dbfb2(0xbc)]({});if(_0x3b5988[0x0][_0x1dbfb2(0x122)]==_0x1dbfb2(0x17f)){var _0x1c2887=users[_0x1dbfb2(0xcd)];console['log'](_0x1c2887);}else{if(_0x3b5988[0x0]['language']==_0x1dbfb2(0x127))var _0x1c2887=users[_0x1dbfb2(0x127)];else{if(_0x3b5988[0x0][_0x1dbfb2(0x122)]=='German')var _0x1c2887=users[_0x1dbfb2(0xf0)];else{if(_0x3b5988[0x0]['language']==_0x1dbfb2(0xd1))var _0x1c2887=users[_0x1dbfb2(0xd1)];else{if(_0x3b5988[0x0][_0x1dbfb2(0x122)]==_0x1dbfb2(0x176))var _0x1c2887=users[_0x1dbfb2(0x176)];else{if(_0x3b5988[0x0][_0x1dbfb2(0x122)]=='Portuguese\x20(BR)')var _0x1c2887=users['Portuguese'];else{if(_0x3b5988[0x0][_0x1dbfb2(0x122)]==_0x1dbfb2(0x17e))var _0x1c2887=users[_0x1dbfb2(0x17e)];else{if(_0x3b5988[0x0][_0x1dbfb2(0x122)]==_0x1dbfb2(0x144))var _0x1c2887=users[_0x1dbfb2(0xd4)];}}}}}}}_0x45dabb[_0x1dbfb2(0xf8)](_0x1dbfb2(0x86),{'success':_0x14f1b7['flash'](_0x1dbfb2(0xf1)),'errors':_0x14f1b7[_0x1dbfb2(0xe8)](_0x1dbfb2(0x146)),'role':_0x261a92,'profile':_0x343974,'customer':_0x54bb71,'warehouse':_0x455b36,'product':_0x2efe92,'user':_0x1ea1fb,'master_shop':_0x3b5988,'unit':_0x541b7c,'language':_0x1c2887,'rooms_data':_0x1c59fb,'ed_fullDate':_0x424c41});}catch(_0x1e8a6c){console[_0x1dbfb2(0x182)](_0x1e8a6c);}}),router[a0_0x7ab6bd(0xe4)]('/view/:id',auth,async(_0x369188,_0x126ed3)=>{var _0xf88ed9=a0_0x7ab6bd;try{const _0x16321b=_0x369188['params']['id'],_0x44999c=await sales_finished[_0xf88ed9(0x155)]({'_id':_0x369188[_0xf88ed9(0xe6)]['id']}),_0x5ba74d=await warehouse[_0xf88ed9(0x155)]({'name':_0x44999c[_0xf88ed9(0x9c)],'room':_0x369188['body']['room'],'warehouse_category':_0xf88ed9(0x186)}),{invoice:_0x2ef35a,customer:_0x7824e5,date:_0x34a96b,warehouse_name:_0x506d17,product_name:_0x3b2b03,stock:_0x5018a1,adjust_qty:_0x5dc5d5,note:_0x378c2d,room:_0x205f4f,primary_code:_0x46b630,secondary_code:_0x14c477,prod_code:_0x2a287d,level:_0x38cda3,isle:_0x1e15e3,pallet:_0x23399f,expiry_date:_0x507a34}=_0x369188[_0xf88ed9(0x194)];if(typeof _0x3b2b03==_0xf88ed9(0xd0))var _0x234f9a=[_0x369188[_0xf88ed9(0x194)]['product_name']],_0x1838fe=[_0x369188[_0xf88ed9(0x194)]['stock']],_0x5dccd3=[_0x369188[_0xf88ed9(0x194)][_0xf88ed9(0x136)]],_0x385f6b=[_0x369188[_0xf88ed9(0x194)][_0xf88ed9(0x120)]],_0xc8ff9d=[_0x369188[_0xf88ed9(0x194)][_0xf88ed9(0xa6)]],_0x372136=[_0x369188['body']['prod_code']],_0xdd49aa=[_0x369188[_0xf88ed9(0x194)]['level']],_0x53bc90=[_0x369188[_0xf88ed9(0x194)][_0xf88ed9(0x126)]];else var _0x234f9a=[..._0x369188['body'][_0xf88ed9(0x160)]],_0x1838fe=[..._0x369188['body'][_0xf88ed9(0xa2)]],_0x5dccd3=[..._0x369188[_0xf88ed9(0x194)][_0xf88ed9(0x136)]],_0x385f6b=[..._0x369188['body'][_0xf88ed9(0x120)]],_0xc8ff9d=[..._0x369188[_0xf88ed9(0x194)][_0xf88ed9(0xa6)]],_0x372136=[..._0x369188[_0xf88ed9(0x194)][_0xf88ed9(0xbd)]],_0xdd49aa=[..._0x369188[_0xf88ed9(0x194)][_0xf88ed9(0xdd)]],_0x53bc90=[..._0x369188[_0xf88ed9(0x194)]['expiry_date']];const _0x2201d2=_0x234f9a[_0xf88ed9(0xcf)](_0x26bbc6=>{return _0x26bbc6={'product_name':_0x26bbc6};});_0x1838fe[_0xf88ed9(0x16a)]((_0x54e41a,_0x29e86c)=>{var _0x451e03=_0xf88ed9;_0x2201d2[_0x29e86c][_0x451e03(0xa2)]=_0x54e41a;}),_0x5dccd3[_0xf88ed9(0x16a)]((_0x299e3f,_0x322124)=>{var _0x103646=_0xf88ed9;_0x2201d2[_0x322124][_0x103646(0xc0)]=_0x299e3f;}),_0x385f6b['forEach']((_0x4f959e,_0x519161)=>{var _0x3f2a31=_0xf88ed9;_0x2201d2[_0x519161][_0x3f2a31(0x120)]=_0x4f959e;}),_0xc8ff9d[_0xf88ed9(0x16a)]((_0x136601,_0x1240b8)=>{var _0x4f699b=_0xf88ed9;_0x2201d2[_0x1240b8][_0x4f699b(0xa6)]=_0x136601;}),_0x372136[_0xf88ed9(0x16a)]((_0x3873a2,_0x519557)=>{_0x2201d2[_0x519557]['product_code']=_0x3873a2;}),_0xdd49aa[_0xf88ed9(0x16a)]((_0x22ebc0,_0x1c9788)=>{var _0x37db09=_0xf88ed9;_0x2201d2[_0x1c9788][_0x37db09(0xdd)]=_0x22ebc0;}),_0x53bc90['forEach']((_0x4065ad,_0x1dafca)=>{var _0x51c02d=_0xf88ed9;_0x2201d2[_0x1dafca][_0x51c02d(0x126)]=_0x4065ad;});var _0x1716a2=0x0;_0x2201d2['forEach'](_0x5c0b7=>{var _0x1f6004=_0xf88ed9;console[_0x1f6004(0x182)](_0x1f6004(0x114),_0x5c0b7),(parseInt(_0x5c0b7[_0x1f6004(0xa2)])<parseInt(_0x5c0b7[_0x1f6004(0xc0)])||parseInt(_0x5c0b7[_0x1f6004(0xc0)])==0x0)&&_0x1716a2++;});if(_0x1716a2!=0x0)return _0x369188['flash'](_0xf88ed9(0x146),_0xf88ed9(0x137)),_0x126ed3[_0xf88ed9(0x18d)]('back');_0x44999c[_0xf88ed9(0x164)][_0xf88ed9(0x16a)](_0x56200f=>{var _0x4980a9=_0xf88ed9;const _0x22681a=_0x5ba74d[_0x4980a9(0xa4)]['map'](_0x2a760b=>{var _0x337bff=_0x4980a9;_0x2a760b[_0x337bff(0x160)]==_0x56200f[_0x337bff(0x160)]&&_0x2a760b[_0x337bff(0x111)]==_0x56200f[_0x337bff(0x111)]&&(_0x2a760b['product_stock']=parseInt(_0x2a760b[_0x337bff(0xdf)])+parseInt(_0x56200f['quantity']));});}),await _0x5ba74d[_0xf88ed9(0x166)]();const _0x3c1538=_0x2201d2['filter'](_0x114d9d=>_0x114d9d[_0xf88ed9(0xc0)]!=='0'&&_0x114d9d[_0xf88ed9(0xc0)]!=='');_0x44999c['invoice']=_0x2ef35a,_0x44999c[_0xf88ed9(0x15d)]=_0x7824e5,_0x44999c[_0xf88ed9(0x123)]=_0x34a96b,_0x44999c[_0xf88ed9(0x9c)]=_0x506d17,_0x44999c[_0xf88ed9(0x164)]=_0x3c1538,_0x44999c[_0xf88ed9(0x10f)]=_0x378c2d,_0x44999c[_0xf88ed9(0x152)]=_0x205f4f;const _0x5efe39=await _0x44999c['save'](),_0x53afb7=await sales_finished[_0xf88ed9(0x155)]({'_id':_0x369188[_0xf88ed9(0xe6)]['id']}),_0x349fb2=await warehouse[_0xf88ed9(0x155)]({'name':_0x506d17,'room':_0x205f4f,'warehouse_category':_0xf88ed9(0x186)});_0x53afb7['sale_product']['forEach'](_0x5f31b3=>{var _0x1f36ae=_0xf88ed9;const _0x3362ec=_0x349fb2[_0x1f36ae(0xa4)][_0x1f36ae(0xcf)](_0x5b486d=>{var _0x5494b0=_0x1f36ae;_0x5b486d[_0x5494b0(0x160)]==_0x5f31b3[_0x5494b0(0x160)]&&_0x5b486d['bay']==_0x5f31b3[_0x5494b0(0x111)]&&(_0x5b486d[_0x5494b0(0xdf)]=parseInt(_0x5b486d[_0x5494b0(0xdf)])-parseInt(_0x5f31b3[_0x5494b0(0xc0)]));});}),console[_0xf88ed9(0x182)]('final',_0x349fb2),await _0x349fb2['save']();const _0x269384=await c_payment_data[_0xf88ed9(0x155)]({'invoice':_0x369188[_0xf88ed9(0x194)][_0xf88ed9(0x105)]});_0x269384[_0xf88ed9(0x128)]=_0x369188['body'][_0xf88ed9(0x128)],await _0x269384[_0xf88ed9(0x166)](),_0x369188[_0xf88ed9(0xe8)](_0xf88ed9(0xf1),_0xf88ed9(0x156)),_0x126ed3['redirect'](_0xf88ed9(0xf9));}catch(_0xc2da30){console[_0xf88ed9(0x182)](_0xc2da30);}}),router[a0_0x7ab6bd(0xe4)](a0_0x7ab6bd(0x192),auth,async(_0x17c587,_0x644611)=>{var _0x2e08d5=a0_0x7ab6bd;try{const _0x131772=_0x17c587[_0x2e08d5(0xe6)]['id'],{invoice:_0x2ba259,customer:_0xf0611a,receivable_amount:_0x48cd7d,received_amount:_0x123639}=_0x17c587['body'],_0x1d9ccb=await sales['findById'](_0x131772);console['log'](_0x1d9ccb);var _0xa56ffd=_0x48cd7d-_0x123639;console[_0x2e08d5(0x182)](_0x123639),_0x1d9ccb[_0x2e08d5(0x14b)]=parseFloat(_0x123639)+parseFloat(_0x1d9ccb[_0x2e08d5(0x14b)]),_0x1d9ccb[_0x2e08d5(0xd2)]=_0xa56ffd,console[_0x2e08d5(0x182)](_0x1d9ccb);const _0x47b227=await _0x1d9ccb[_0x2e08d5(0x166)](),_0x498df8=await c_payment_data[_0x2e08d5(0x155)]({'invoice':_0x2ba259});_0x498df8[_0x2e08d5(0xbf)]=_0xa56ffd,await _0x498df8['save']();let _0x4a72b7=new Date(),_0x1d300a=('0'+_0x4a72b7['getDate']())[_0x2e08d5(0x8b)](-0x2),_0x38d3a1=('0'+(_0x4a72b7[_0x2e08d5(0xe0)]()+0x1))[_0x2e08d5(0x8b)](-0x2),_0x5879d0=_0x4a72b7[_0x2e08d5(0xa7)](),_0x43e3cf=_0x5879d0+'-'+_0x38d3a1+'-'+_0x1d300a;const _0x2f3ff0=new customer_payment({'invoice':_0x2ba259,'date':_0x5879d0+'-'+_0x38d3a1+'-'+_0x1d300a,'customer':_0xf0611a,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x123639}),_0x4e24c9=await _0x2f3ff0[_0x2e08d5(0x166)]();_0x17c587[_0x2e08d5(0xe8)](_0x2e08d5(0xf1),_0x2e08d5(0x147)),_0x644611[_0x2e08d5(0x18d)](_0x2e08d5(0x135));}catch(_0x384584){console[_0x2e08d5(0x182)](_0x384584);}}),router[a0_0x7ab6bd(0xfc)](a0_0x7ab6bd(0x17b),auth,async(_0x5704ee,_0xb9451b)=>{var _0x272ee7=a0_0x7ab6bd;try{const {username:_0x24a6aa,email:_0x1da17b,role:_0x1fea15}=_0x5704ee[_0x272ee7(0x99)],_0x361ac9=_0x5704ee[_0x272ee7(0x99)],_0x512fa4=await profile[_0x272ee7(0x155)]({'email':_0x361ac9[_0x272ee7(0x95)]}),_0x4992af=await master_shop[_0x272ee7(0xbc)]();console[_0x272ee7(0x182)](_0x272ee7(0x89),_0x4992af);const _0x2249dd=_0x5704ee['params']['id'],_0x198ea2=await sales[_0x272ee7(0xb4)](_0x2249dd);console['log'](_0x198ea2);const _0x5e7da8=await customer[_0x272ee7(0x155)]({'name':_0x198ea2[_0x272ee7(0x15d)]});console[_0x272ee7(0x182)](_0x5e7da8);if(_0x4992af[0x0][_0x272ee7(0x122)]=='English\x20(US)'){var _0x18fcd6=users[_0x272ee7(0xcd)];console['log'](_0x18fcd6);}else{if(_0x4992af[0x0][_0x272ee7(0x122)]==_0x272ee7(0x127))var _0x18fcd6=users[_0x272ee7(0x127)];else{if(_0x4992af[0x0][_0x272ee7(0x122)]==_0x272ee7(0xf0))var _0x18fcd6=users[_0x272ee7(0xf0)];else{if(_0x4992af[0x0]['language']==_0x272ee7(0xd1))var _0x18fcd6=users['Spanish'];else{if(_0x4992af[0x0][_0x272ee7(0x122)]=='French')var _0x18fcd6=users[_0x272ee7(0x176)];else{if(_0x4992af[0x0][_0x272ee7(0x122)]==_0x272ee7(0xec))var _0x18fcd6=users[_0x272ee7(0x98)];else{if(_0x4992af[0x0]['language']==_0x272ee7(0x17e))var _0x18fcd6=users['Chinese'];else{if(_0x4992af[0x0][_0x272ee7(0x122)]==_0x272ee7(0x144))var _0x18fcd6=users[_0x272ee7(0xd4)];}}}}}}}_0xb9451b[_0x272ee7(0xf8)]('sales_invoice',{'success':_0x5704ee[_0x272ee7(0xe8)](_0x272ee7(0xf1)),'errors':_0x5704ee['flash'](_0x272ee7(0x146)),'role':_0x361ac9,'profile':_0x512fa4,'master_shop':_0x4992af,'customers':_0x5e7da8,'sales':_0x198ea2,'language':_0x18fcd6});}catch(_0x476795){console['log'](_0x476795);}}),router[a0_0x7ab6bd(0xfc)](a0_0x7ab6bd(0x129),auth,async(_0x1cf6c2,_0xf9bd87)=>{var _0x300230=a0_0x7ab6bd;try{const {username:_0x1fad90,email:_0x7c402a,role:_0x13b9e7}=_0x1cf6c2[_0x300230(0x99)],_0x1476e9=_0x1cf6c2[_0x300230(0x99)],_0x221b3b=await profile[_0x300230(0x155)]({'email':_0x1476e9['email']}),_0x51d5be=await master_shop['find'](),_0x4b5635=_0x1cf6c2[_0x300230(0xe6)]['id'],_0x254dcd=await sales_finished['findById'](_0x4b5635),_0xb86cf1=await warehouse[_0x300230(0x16b)]([{'$match':{'name':_0x254dcd[_0x300230(0x9c)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x300230(0xaf),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x300230(0x88)},'bay':{'$first':_0x300230(0x101)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x300230(0xd9)},'floorlevel':{'$first':_0x300230(0xeb)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x300230(0xa0)},'expiry_date':{'$first':_0x300230(0x11c)},'production_date':{'$first':'$product_details.production_date'},'unit':{'$first':_0x300230(0x181)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'maxProducts':{'$first':_0x300230(0xc5)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x3c36d4=await product[_0x300230(0xbc)]({}),_0x149602=await warehouse[_0x300230(0x16b)]([{'$match':{'status':'Enabled','warehouse_category':_0x300230(0x186),'name':{'$ne':'Return\x20Goods','$ne':_0x300230(0x18c)}}},{'$group':{'_id':'$name','name':{'$first':_0x300230(0x9d)}}},{'$sort':{'name':0x1}}]);var _0x15be29=[_0x300230(0xa9)];const _0x35c29f=await warehouse[_0x300230(0x16b)]([{'$match':{'status':_0x300230(0xf7),'name':_0x300230(0x18c)}},{'$group':{'_id':_0x300230(0x9d),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);if(_0x51d5be[0x0][_0x300230(0x122)]=='English\x20(US)'){var _0x4c11d5=users[_0x300230(0xcd)];console[_0x300230(0x182)](_0x4c11d5);}else{if(_0x51d5be[0x0][_0x300230(0x122)]==_0x300230(0x127))var _0x4c11d5=users[_0x300230(0x127)];else{if(_0x51d5be[0x0][_0x300230(0x122)]==_0x300230(0xf0))var _0x4c11d5=users['German'];else{if(_0x51d5be[0x0][_0x300230(0x122)]==_0x300230(0xd1))var _0x4c11d5=users[_0x300230(0xd1)];else{if(_0x51d5be[0x0][_0x300230(0x122)]==_0x300230(0x176))var _0x4c11d5=users[_0x300230(0x176)];else{if(_0x51d5be[0x0]['language']==_0x300230(0xec))var _0x4c11d5=users[_0x300230(0x98)];else{if(_0x51d5be[0x0][_0x300230(0x122)]==_0x300230(0x17e))var _0x4c11d5=users['Chinese'];else{if(_0x51d5be[0x0][_0x300230(0x122)]==_0x300230(0x144))var _0x4c11d5=users[_0x300230(0xd4)];}}}}}}}_0xf9bd87[_0x300230(0xf8)](_0x300230(0x8d),{'success':_0x1cf6c2[_0x300230(0xe8)](_0x300230(0xf1)),'errors':_0x1cf6c2[_0x300230(0xe8)](_0x300230(0x146)),'role':_0x1476e9,'profile':_0x221b3b,'user':_0x254dcd,'stock':_0xb86cf1,'master_shop':_0x51d5be,'unit':_0x3c36d4,'language':_0x4c11d5,'warehouses':_0x149602,'rooms':_0x15be29,'warehouse_QA':_0x35c29f});}catch(_0x24b4fe){console[_0x300230(0x182)](_0x24b4fe),_0xf9bd87['status'](0xc8)[_0x300230(0x196)]({'message':_0x24b4fe[_0x300230(0xd7)]});}}),router[a0_0x7ab6bd(0xe4)](a0_0x7ab6bd(0x129),auth,async(_0x590bce,_0x13b547)=>{var _0x38ddea=a0_0x7ab6bd;if(_0x590bce['body'][_0x38ddea(0xfa)]=='QA')try{const {invoice:_0x1a4e1d,date:_0x5423d6,warehouse_name:_0x365816,product_name:_0x5ae595,primary_code:_0x5d7d1c,secondary_code:_0x2a5389,product_code:_0x23280d,sales_quantity:_0x21754d,stocks:_0x5cab7d,return_qty:_0x44b056,Room_name:_0x2e8962,to_warehouse_name_QA:_0x1fe1de,to_Room_name_QA:_0x5ac0a5,note:_0x59fc55,for_categorize:_0xa0d95b,product_name_QA1:_0x862317}=_0x590bce[_0x38ddea(0x194)];if(typeof _0x862317==_0x38ddea(0xd0))var _0x12ef7e=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x175)]],_0x1f9325=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0xd8)]],_0x1a2366=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x161)]],_0x1a6f06=[_0x590bce['body']['product_code_QA']],_0x3ca835=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x143)]],_0x283645=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0xc7)]],_0x455cb4=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0xad)]],_0x41750d=[_0x590bce[_0x38ddea(0x194)]['maxPerUnit_QA']],_0x4331da=[_0x590bce['body'][_0x38ddea(0xe1)]],_0x5825dd=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0xde)]],_0x2efdd6=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x18e)]],_0xa16e8b=[_0x590bce['body'][_0x38ddea(0x16c)]],_0x3ad90d=[_0x590bce[_0x38ddea(0x194)]['production_date_QA']],_0x155445=[_0x590bce[_0x38ddea(0x194)]['expiry_date_QA']];else var _0x12ef7e=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x175)]],_0x1f9325=[..._0x590bce['body'][_0x38ddea(0xd8)]],_0x1a2366=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x161)]],_0x1a6f06=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x17c)]],_0x3ca835=[..._0x590bce['body']['sales_quantity_QA']],_0x283645=[..._0x590bce[_0x38ddea(0x194)]['stocks_QA']],_0x455cb4=[..._0x590bce[_0x38ddea(0x194)]['return_qty_QA']],_0x41750d=[..._0x590bce[_0x38ddea(0x194)]['maxPerUnit_QA']],_0x4331da=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0xe1)]],_0x5825dd=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0xde)]],_0x2efdd6=[..._0x590bce['body']['secondary_unit_QA']],_0xa16e8b=[..._0x590bce['body'][_0x38ddea(0x16c)]],_0x3ad90d=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x11e)]],_0x155445=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x115)]];const _0x5257e6=_0x12ef7e['map'](_0x33a13e=>{return _0x33a13e={'product_name':_0x33a13e};});_0x1f9325[_0x38ddea(0x16a)]((_0x1af2a8,_0x4bd755)=>{var _0x1fbe54=_0x38ddea;_0x5257e6[_0x4bd755][_0x1fbe54(0x120)]=_0x1af2a8;}),_0x1a2366[_0x38ddea(0x16a)]((_0x31822e,_0x307f65)=>{var _0x10ed0c=_0x38ddea;_0x5257e6[_0x307f65][_0x10ed0c(0xa6)]=_0x31822e;}),_0x1a6f06['forEach']((_0x437d1d,_0x558a76)=>{var _0x52c1f8=_0x38ddea;_0x5257e6[_0x558a76][_0x52c1f8(0x195)]=_0x437d1d;}),_0x3ca835[_0x38ddea(0x16a)]((_0xfd2d6e,_0x59c44b)=>{var _0x23e421=_0x38ddea;_0x5257e6[_0x59c44b][_0x23e421(0x9a)]=_0xfd2d6e;}),_0x283645['forEach']((_0x21e5f5,_0x5b972e)=>{var _0x43e283=_0x38ddea;_0x5257e6[_0x5b972e][_0x43e283(0xa2)]=_0x21e5f5;}),_0x455cb4['forEach']((_0x4d2b67,_0x3bbcc2)=>{var _0x1e48a1=_0x38ddea;_0x5257e6[_0x3bbcc2][_0x1e48a1(0x131)]=_0x4d2b67;}),_0x41750d['forEach']((_0x1c5360,_0x7a4c7)=>{var _0x57b91e=_0x38ddea;_0x5257e6[_0x7a4c7][_0x57b91e(0x8c)]=_0x1c5360;}),_0x4331da[_0x38ddea(0x16a)]((_0x27b517,_0x4df402)=>{var _0x51904b=_0x38ddea;_0x5257e6[_0x4df402][_0x51904b(0x12f)]=_0x27b517;}),_0x5825dd[_0x38ddea(0x16a)]((_0x16bc04,_0x2efe8e)=>{var _0x52dd81=_0x38ddea;_0x5257e6[_0x2efe8e][_0x52dd81(0x18a)]=_0x16bc04;}),_0x2efdd6[_0x38ddea(0x16a)]((_0x5d74dd,_0x2862f6)=>{var _0x408b1d=_0x38ddea;_0x5257e6[_0x2862f6][_0x408b1d(0x8a)]=_0x5d74dd;}),_0xa16e8b[_0x38ddea(0x16a)]((_0x32ac9a,_0x308cba)=>{var _0x7aa107=_0x38ddea;_0x5257e6[_0x308cba][_0x7aa107(0x13e)]=_0x32ac9a;}),_0x3ad90d[_0x38ddea(0x16a)]((_0x1fd978,_0x4249ae)=>{var _0x4ca5cc=_0x38ddea;_0x5257e6[_0x4249ae][_0x4ca5cc(0x119)]=_0x1fd978;}),_0x155445[_0x38ddea(0x16a)]((_0x2c43ca,_0x405a80)=>{var _0x29be83=_0x38ddea;_0x5257e6[_0x405a80][_0x29be83(0x126)]=_0x2c43ca;});const _0x3dd476=await sales_finished[_0x38ddea(0x155)]({'invoice':_0x1a4e1d});_0x3dd476[_0x38ddea(0x12b)]=_0x38ddea(0x109);const _0x2dd21d=await _0x3dd476[_0x38ddea(0x166)](),_0x427d35=new sales_return_finished({'invoice':_0x1a4e1d,'customer':_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x15d)],'date':_0x5423d6,'warehouse_name':_0x365816,'room':_0x2e8962,'ToWarehouse':_0x1fe1de,'ToRoom':_0x5ac0a5,'return_sale_QA':_0x5257e6,'note':_0x59fc55,'warehouse_cat':_0xa0d95b}),_0x2ab4cb=await _0x427d35[_0x38ddea(0x166)](),_0x5eae7e=await sales_return_finished[_0x38ddea(0x155)]({'invoice':_0x1a4e1d}),_0x5428b8=await warehouse['findOne']({'name':_0x1fe1de,'room':_0x5ac0a5});_0x5eae7e['return_sale_QA'][_0x38ddea(0x16a)](_0xbd006e=>{var _0x3bdb84=_0x38ddea,_0x391b6f=0x0;const _0x931968=_0x5428b8[_0x3bdb84(0xa4)][_0x3bdb84(0xcf)](_0x363e36=>{var _0x385462=_0x3bdb84;_0x363e36['product_name']==_0xbd006e[_0x385462(0x160)]&&_0x363e36[_0x385462(0x126)]==_0xbd006e[_0x385462(0x126)]&&_0x363e36[_0x385462(0x119)]==_0xbd006e[_0x385462(0x119)]&&_0x363e36['batch_code']==_0xbd006e['batch_code']&&(_0x363e36[_0x385462(0xdf)]=parseInt(_0x363e36[_0x385462(0xdf)])+parseInt(_0xbd006e['return_qty']),_0x391b6f++);});_0x391b6f=='0'&&(_0x5428b8[_0x3bdb84(0xa4)]=_0x5428b8[_0x3bdb84(0xa4)][_0x3bdb84(0x12d)]({'product_name':_0xbd006e[_0x3bdb84(0x160)],'product_stock':_0xbd006e['return_qty'],'primary_code':_0xbd006e['primary_code'],'secondary_code':_0xbd006e[_0x3bdb84(0xa6)],'product_code':_0xbd006e[_0x3bdb84(0x195)],'batch_code':_0xbd006e[_0x3bdb84(0x18a)],'maxPerUnit':_0xbd006e[_0x3bdb84(0x8c)],'production_date':_0xbd006e[_0x3bdb84(0x119)],'expiry_date':_0xbd006e[_0x3bdb84(0x126)],'secondary_unit':_0xbd006e[_0x3bdb84(0x8a)],'unit':_0xbd006e['unit'],'maxProducts':_0xbd006e[_0x3bdb84(0x12f)],'bay':_0xbd006e[_0x3bdb84(0x111)]}));}),await _0x5428b8[_0x38ddea(0x166)]();const _0x9ab12f=new c_payment_data({'invoice':_0x1a4e1d,'customer':_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x15d)],'reason':_0x38ddea(0x139)});await _0x9ab12f[_0x38ddea(0x166)]();const _0x30e7ef=await master_shop[_0x38ddea(0xbc)](),_0x38bc01=await email_settings[_0x38ddea(0x155)](),_0x350b0a=await customer['findOne']({'name':_0x590bce['body'][_0x38ddea(0x15d)]});_0x30e7ef[0x0][_0x38ddea(0x14e)]==0x1?(right_currency=_0x30e7ef[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x30e7ef[0x0][_0x38ddea(0x96)]);var _0x29aea1=_0x12ef7e,_0x3a3cee=_0x455cb4,_0x49f871='',_0x5c10a5;for(_0x5c10a5 in _0x29aea1){_0x49f871+=_0x38ddea(0x15e)+_0x38ddea(0x103)+_0x29aea1[_0x5c10a5]+_0x38ddea(0x108)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3a3cee[_0x5c10a5]+'</td>'+'</tr>';}console[_0x38ddea(0x182)]('product_list',_0x49f871);let _0x12427d=nodemailer[_0x38ddea(0x142)]({'service':_0x38ddea(0x191),'auth':{'user':_0x38bc01['email'],'pass':_0x38bc01['password']}}),_0x435905={'from':_0x38bc01[_0x38ddea(0x95)],'to':_0x350b0a['email'],'subject':_0x38ddea(0xce),'attachments':[{'filename':_0x38ddea(0x12a),'path':__dirname+_0x38ddea(0x18b)+_0x38ddea(0x14c)+_0x30e7ef[0x0][_0x38ddea(0x94)],'cid':_0x38ddea(0xdb)}],'html':_0x38ddea(0x162)+_0x38ddea(0x90)+_0x38ddea(0xcc)+_0x38ddea(0x10d)+_0x38ddea(0xfe)+'<div>'+_0x38ddea(0x130)+_0x38ddea(0x12e)+'<div>'+_0x38ddea(0x13d)+_0x30e7ef[0x0]['site_title']+_0x38ddea(0x125)+'</div>'+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x38ddea(0x10d)+_0x38ddea(0xe5)+'\x20Order\x20Number\x20:\x20'+_0x1a4e1d+'\x20'+_0x38ddea(0x187)+_0x38ddea(0x158)+_0x5423d6+'\x20'+_0x38ddea(0x193)+'</h5>'+'</div>'+_0x38ddea(0x165)+_0x38ddea(0x10b)+_0x38ddea(0x15e)+_0x38ddea(0xa5)+_0x38ddea(0xf4)+_0x38ddea(0xca)+_0x38ddea(0x107)+_0x38ddea(0x8f)+_0x38ddea(0x184)+_0x38ddea(0xb6)+'\x20'+_0x49f871+'\x20'+_0x38ddea(0xa1)+_0x38ddea(0x85)+'<div>'+_0x38ddea(0xb2)+_0x38ddea(0x124)+_0x30e7ef[0x0][_0x38ddea(0xb9)]+_0x38ddea(0x82)+_0x38ddea(0x12e)+'</div>'+_0x38ddea(0xf3)};_0x12427d[_0x38ddea(0x170)](_0x435905,function(_0x29d517,_0xdfb244){var _0x7ca324=_0x38ddea;_0x29d517?(console[_0x7ca324(0x182)](_0x29d517),console[_0x7ca324(0x182)]('Error\x20Occurs')):console[_0x7ca324(0x182)](_0x7ca324(0x157));}),_0x590bce['flash'](_0x38ddea(0xf1),_0x38ddea(0x15c)),_0x13b547[_0x38ddea(0x18d)](_0x38ddea(0xf9));}catch(_0x22458b){_0x13b547[_0x38ddea(0x92)](0xc8)[_0x38ddea(0x196)]({'message1':_0x22458b[_0x38ddea(0xd7)]});}else{if(_0x590bce[_0x38ddea(0x194)]['for_categorize']=='GS')try{const {invoice:_0x2b11e3,date:_0x35e22b,warehouse_name:_0x55dede,product_name:_0x560d67,primary_code:_0x2ca6b2,secondary_code:_0x52ecd5,product_code:_0x5ceb4e,sales_quantity:_0x4b5638,stocks:_0x3a7734,return_qty:_0x1deda2,Room_name:_0x13ac26,to_warehouse_name:_0x52ad54,to_Room_name:_0x40510e,note:_0x3e58e9,level:_0x54d194,isle:_0x542ff0,pallet:_0x1f04bc,for_categorize:_0x32cbbb}=_0x590bce[_0x38ddea(0x194)];if(typeof _0x560d67==_0x38ddea(0xd0))var _0x12ef7e=[_0x590bce[_0x38ddea(0x194)]['product_name']],_0x1f9325=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x120)]],_0x1a2366=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0xa6)]],_0x1a6f06=[_0x590bce['body'][_0x38ddea(0x195)]],_0x3ca835=[_0x590bce['body']['sales_quantity']],_0x455cb4=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x131)]],_0x195796=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x111)]],_0x41750d=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x8c)]],_0x4331da=[_0x590bce[_0x38ddea(0x194)]['maxProducts']],_0x5825dd=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x18a)]],_0x2efdd6=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x8a)]],_0xa16e8b=[_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x13e)]],_0x3ad90d=[_0x590bce['body']['production_date']],_0x155445=[_0x590bce['body'][_0x38ddea(0x126)]];else var _0x12ef7e=[..._0x590bce['body'][_0x38ddea(0x160)]],_0x1f9325=[..._0x590bce[_0x38ddea(0x194)]['primary_code']],_0x1a2366=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0xa6)]],_0x1a6f06=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x195)]],_0x3ca835=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x84)]],_0x455cb4=[..._0x590bce[_0x38ddea(0x194)]['return_qty']],_0x195796=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x111)]],_0x41750d=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x8c)]],_0x4331da=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x12f)]],_0x5825dd=[..._0x590bce['body']['batch_code']],_0x2efdd6=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x8a)]],_0xa16e8b=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x13e)]],_0x3ad90d=[..._0x590bce[_0x38ddea(0x194)]['production_date']],_0x155445=[..._0x590bce[_0x38ddea(0x194)][_0x38ddea(0x126)]];const _0x415428=_0x12ef7e[_0x38ddea(0xcf)](_0x1ed13a=>{return _0x1ed13a={'product_name':_0x1ed13a};});_0x1f9325[_0x38ddea(0x16a)]((_0x53dfe0,_0x40177c)=>{var _0x1a6412=_0x38ddea;_0x415428[_0x40177c][_0x1a6412(0x120)]=_0x53dfe0;}),_0x1a2366[_0x38ddea(0x16a)]((_0x4a0838,_0x149683)=>{var _0x35f0de=_0x38ddea;_0x415428[_0x149683][_0x35f0de(0xa6)]=_0x4a0838;}),_0x1a6f06[_0x38ddea(0x16a)]((_0x34c48e,_0x3cddcd)=>{var _0x2b3715=_0x38ddea;_0x415428[_0x3cddcd][_0x2b3715(0x195)]=_0x34c48e;}),_0x3ca835[_0x38ddea(0x16a)]((_0x182574,_0x41d456)=>{var _0x55c1b1=_0x38ddea;_0x415428[_0x41d456][_0x55c1b1(0x9a)]=_0x182574;}),_0x455cb4[_0x38ddea(0x16a)]((_0x3478bf,_0x20854f)=>{var _0x15f22b=_0x38ddea;_0x415428[_0x20854f][_0x15f22b(0x131)]=_0x3478bf;}),_0x195796[_0x38ddea(0x16a)]((_0x2322e9,_0x3a26d2)=>{var _0x295941=_0x38ddea;_0x415428[_0x3a26d2][_0x295941(0x111)]=_0x2322e9;}),_0x41750d[_0x38ddea(0x16a)]((_0x228a44,_0x229eca)=>{_0x415428[_0x229eca]['maxPerUnit']=_0x228a44;}),_0x4331da[_0x38ddea(0x16a)]((_0x3b5156,_0x30f0de)=>{var _0x2002aa=_0x38ddea;_0x415428[_0x30f0de][_0x2002aa(0x12f)]=_0x3b5156;}),_0x5825dd[_0x38ddea(0x16a)]((_0x496bf6,_0x108404)=>{var _0x4ffa39=_0x38ddea;_0x415428[_0x108404][_0x4ffa39(0x18a)]=_0x496bf6;}),_0x2efdd6[_0x38ddea(0x16a)]((_0x1d6b7c,_0x24aef5)=>{_0x415428[_0x24aef5]['secondary_unit']=_0x1d6b7c;}),_0xa16e8b[_0x38ddea(0x16a)]((_0x3634ce,_0x44bbf6)=>{var _0x540223=_0x38ddea;_0x415428[_0x44bbf6][_0x540223(0x13e)]=_0x3634ce;}),_0x3ad90d['forEach']((_0x3fd43b,_0x4db012)=>{var _0x52204c=_0x38ddea;_0x415428[_0x4db012][_0x52204c(0x119)]=_0x3fd43b;}),_0x155445[_0x38ddea(0x16a)]((_0x33b64a,_0x3b38ec)=>{var _0x24c91c=_0x38ddea;_0x415428[_0x3b38ec][_0x24c91c(0x126)]=_0x33b64a;});var _0x372d3a=0x0;_0x415428[_0x38ddea(0x16a)](_0x5cba55=>{var _0x20d82a=_0x38ddea;(parseInt(_0x5cba55[_0x20d82a(0x9a)])<parseInt(_0x5cba55[_0x20d82a(0x131)])||parseInt(_0x5cba55[_0x20d82a(0xa2)])<parseInt(_0x5cba55[_0x20d82a(0x131)])&&parseInt(_0x5cba55[_0x20d82a(0x9a)])>parseInt(_0x5cba55[_0x20d82a(0x131)])||parseInt(_0x5cba55['return_qty'])==0x0)&&_0x372d3a++;});if(_0x372d3a!=0x0)return _0x590bce[_0x38ddea(0xe8)](_0x38ddea(0x146),_0x38ddea(0xc3)),_0x13b547[_0x38ddea(0x18d)]('back');const _0x3582f7=await sales_finished['findOne']({'invoice':_0x2b11e3});_0x3582f7[_0x38ddea(0x12b)]=_0x38ddea(0x109);const _0x18733a=await _0x3582f7[_0x38ddea(0x166)](),_0x15cd3d=new sales_return_finished({'invoice':_0x2b11e3,'customer':_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x15d)],'date':_0x35e22b,'warehouse_name':_0x55dede,'room':_0x13ac26,'ToWarehouse':_0x52ad54,'ToRoom':_0x40510e,'return_sale':_0x415428,'note':_0x3e58e9,'warehouse_cat':_0x32cbbb}),_0x58a3b4=await _0x15cd3d[_0x38ddea(0x166)](),_0x1f2dbe=await sales_return_finished[_0x38ddea(0x155)]({'invoice':_0x2b11e3}),_0x3beccc=await warehouse[_0x38ddea(0x155)]({'name':_0x52ad54,'room':_0x40510e,'warehouse_category':'Finished\x20Goods'});_0x1f2dbe[_0x38ddea(0x121)]['forEach'](_0x361545=>{var _0x2d1bde=_0x38ddea,_0x52ae4c=0x0;const _0x190b25=_0x3beccc[_0x2d1bde(0xa4)][_0x2d1bde(0xcf)](_0x1d766a=>{var _0x173059=_0x2d1bde;_0x1d766a[_0x173059(0x160)]==_0x361545[_0x173059(0x160)]&&_0x1d766a['bay']==_0x361545[_0x173059(0x111)]&&_0x1d766a[_0x173059(0x126)]==_0x361545[_0x173059(0x126)]&&_0x1d766a['production_date']==_0x361545['production_date']&&_0x1d766a[_0x173059(0x18a)]==_0x361545[_0x173059(0x18a)]&&(_0x1d766a[_0x173059(0xdf)]=parseInt(_0x1d766a['product_stock'])+parseInt(_0x361545[_0x173059(0x131)]),_0x52ae4c++);});_0x52ae4c=='0'&&(_0x3beccc[_0x2d1bde(0xa4)]=_0x3beccc[_0x2d1bde(0xa4)][_0x2d1bde(0x12d)]({'product_name':_0x361545[_0x2d1bde(0x160)],'product_stock':_0x361545[_0x2d1bde(0x131)],'primary_code':_0x361545['primary_code'],'secondary_code':_0x361545['secondary_code'],'product_code':_0x361545['product_code'],'bay':_0x361545['bay'],'batch_code':_0x361545[_0x2d1bde(0x18a)],'maxPerUnit':_0x361545['maxPerUnit'],'production_date':_0x361545[_0x2d1bde(0x119)],'expiry_date':_0x361545[_0x2d1bde(0x126)],'secondary_unit':_0x361545[_0x2d1bde(0x8a)],'unit':_0x361545[_0x2d1bde(0x13e)],'maxProducts':_0x361545[_0x2d1bde(0x12f)]}));}),await _0x3beccc[_0x38ddea(0x166)](),console[_0x38ddea(0x182)](_0x590bce[_0x38ddea(0x194)]);const _0x42f1d5=new c_payment_data({'invoice':_0x2b11e3,'customer':_0x590bce['body'][_0x38ddea(0x15d)],'reason':_0x38ddea(0x139)});await _0x42f1d5[_0x38ddea(0x166)]();const _0x3d137d=await master_shop[_0x38ddea(0xbc)]();console[_0x38ddea(0x182)]('add\x20post',_0x3d137d[0x0][_0x38ddea(0x94)]);const _0x279b42=await email_settings[_0x38ddea(0x155)](),_0x444543=await customer[_0x38ddea(0x155)]({'name':_0x590bce[_0x38ddea(0x194)][_0x38ddea(0x15d)]});console['log'](_0x38ddea(0x190),_0x444543);_0x3d137d[0x0][_0x38ddea(0x14e)]==0x1?(right_currency=_0x3d137d[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x3d137d[0x0][_0x38ddea(0x96)]);var _0x29aea1=_0x12ef7e,_0x3a3cee=_0x455cb4,_0x49f871='',_0x5c10a5;for(_0x5c10a5 in _0x29aea1){_0x49f871+=_0x38ddea(0x15e)+_0x38ddea(0x103)+_0x29aea1[_0x5c10a5]+_0x38ddea(0x108)+_0x38ddea(0x103)+_0x3a3cee[_0x5c10a5]+_0x38ddea(0x108)+_0x38ddea(0x8f);}console[_0x38ddea(0x182)](_0x38ddea(0x18f),_0x49f871);let _0x242b98=nodemailer['createTransport']({'service':_0x38ddea(0x191),'auth':{'user':_0x279b42[_0x38ddea(0x95)],'pass':_0x279b42[_0x38ddea(0xe9)]}}),_0x293786={'from':_0x279b42[_0x38ddea(0x95)],'to':_0x444543[_0x38ddea(0x95)],'subject':_0x38ddea(0xce),'attachments':[{'filename':_0x38ddea(0x12a),'path':__dirname+'/../public'+_0x38ddea(0x14c)+_0x3d137d[0x0][_0x38ddea(0x94)],'cid':_0x38ddea(0xdb)}],'html':_0x38ddea(0x162)+_0x38ddea(0x90)+_0x38ddea(0xcc)+_0x38ddea(0x10d)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x38ddea(0x10d)+_0x38ddea(0x130)+'</div>'+'<div>'+_0x38ddea(0x13d)+_0x3d137d[0x0][_0x38ddea(0xb9)]+_0x38ddea(0x125)+_0x38ddea(0x12e)+_0x38ddea(0x12e)+_0x38ddea(0x81)+_0x38ddea(0x10d)+_0x38ddea(0xe5)+_0x38ddea(0x13b)+_0x2b11e3+'\x20'+_0x38ddea(0x187)+'\x20Order\x20Date\x20:\x20'+_0x35e22b+'\x20'+_0x38ddea(0x193)+_0x38ddea(0x82)+_0x38ddea(0x12e)+_0x38ddea(0x165)+_0x38ddea(0x10b)+_0x38ddea(0x15e)+_0x38ddea(0xa5)+_0x38ddea(0xf4)+_0x38ddea(0xca)+_0x38ddea(0x107)+'</tr>'+_0x38ddea(0x184)+_0x38ddea(0xb6)+'\x20'+_0x49f871+'\x20'+_0x38ddea(0xa1)+_0x38ddea(0x85)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0x38ddea(0x124)+_0x3d137d[0x0]['site_title']+_0x38ddea(0x82)+_0x38ddea(0x12e)+_0x38ddea(0x12e)+_0x38ddea(0xf3)};_0x242b98[_0x38ddea(0x170)](_0x293786,function(_0x2eb54e,_0x19ac15){var _0x2502f=_0x38ddea;_0x2eb54e?(console['log'](_0x2eb54e),console[_0x2502f(0x182)]('Error\x20Occurs')):console['log'](_0x2502f(0x157));}),_0x590bce[_0x38ddea(0xe8)]('success',_0x38ddea(0x15c)),_0x13b547['redirect'](_0x38ddea(0xf9));}catch(_0x325a2e){console[_0x38ddea(0x182)](_0x325a2e),_0x13b547[_0x38ddea(0x92)](0xc8)[_0x38ddea(0x196)]({'message1':_0x325a2e[_0x38ddea(0xd7)]});}}}),router[a0_0x7ab6bd(0xfc)](a0_0x7ab6bd(0x12c),auth,async(_0x57424b,_0x429d54)=>{var _0x5c1775=a0_0x7ab6bd;try{const {username:_0x377531,email:_0x1f1ffb,role:_0x498465}=_0x57424b[_0x5c1775(0x99)],_0x5ee109=_0x57424b[_0x5c1775(0x99)],_0x3af226=await profile[_0x5c1775(0x155)]({'email':_0x5ee109['email']}),_0x55fd5e=await master_shop[_0x5c1775(0xbc)]();console[_0x5c1775(0x182)](_0x5c1775(0xb3),_0x55fd5e);const _0x2ed533=_0x57424b[_0x5c1775(0xe6)]['id'],_0x595caf=await sales[_0x5c1775(0xb4)](_0x2ed533);console['log']('barcode\x20user_id',_0x595caf);if(_0x55fd5e[0x0]['language']==_0x5c1775(0x17f))var _0x51e7c5=users[_0x5c1775(0xcd)];else{if(_0x55fd5e[0x0][_0x5c1775(0x122)]==_0x5c1775(0x127))var _0x51e7c5=users[_0x5c1775(0x127)];else{if(_0x55fd5e[0x0][_0x5c1775(0x122)]==_0x5c1775(0xf0))var _0x51e7c5=users[_0x5c1775(0xf0)];else{if(_0x55fd5e[0x0]['language']==_0x5c1775(0xd1))var _0x51e7c5=users[_0x5c1775(0xd1)];else{if(_0x55fd5e[0x0][_0x5c1775(0x122)]=='French')var _0x51e7c5=users[_0x5c1775(0x176)];else{if(_0x55fd5e[0x0][_0x5c1775(0x122)]==_0x5c1775(0xec))var _0x51e7c5=users['Portuguese'];else{if(_0x55fd5e[0x0]['language']=='Chinese')var _0x51e7c5=users[_0x5c1775(0x17e)];else{if(_0x55fd5e[0x0][_0x5c1775(0x122)]==_0x5c1775(0x144))var _0x51e7c5=users['Arabic'];}}}}}}}_0x429d54['render'](_0x5c1775(0xda),{'success':_0x57424b[_0x5c1775(0xe8)](_0x5c1775(0xf1)),'errors':_0x57424b[_0x5c1775(0xe8)](_0x5c1775(0x146)),'role':_0x5ee109,'profile':_0x3af226,'alldata':_0x595caf,'master_shop':_0x55fd5e,'language':_0x51e7c5});}catch(_0x1c6a89){console[_0x5c1775(0x182)](_0x1c6a89);}}),router[a0_0x7ab6bd(0xe4)](a0_0x7ab6bd(0xc1),async(_0x412e24,_0x522b0c)=>{var _0x16e218=a0_0x7ab6bd;const {product_code:_0x59bc23,warehouse_name:_0x1c8e36,rooms_data:_0x540083,Roomslist:_0x187b95}=_0x412e24[_0x16e218(0x194)],_0x34dc79=_0x187b95[_0x16e218(0x185)](','),_0x160633=[];async function _0x49d63e(_0x230369){var _0x50fb88=_0x16e218;const _0x142e1e=await warehouse[_0x50fb88(0x16b)]([{'$match':{'name':_0x1c8e36,'room':_0x230369}},{'$unwind':_0x50fb88(0x10e)},{'$match':{'product_details.primary_code':_0x59bc23}},{'$group':{'_id':_0x50fb88(0xaf),'name':{'$first':_0x50fb88(0xe7)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x50fb88(0x91)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x50fb88(0xa3)},'level':{'$first':_0x50fb88(0x101)},'isle':{'$first':_0x50fb88(0xd3)},'type':{'$first':_0x50fb88(0xd9)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x50fb88(0x181)},'secondary_unit':{'$first':_0x50fb88(0x188)},'storage':{'$first':_0x50fb88(0x179)},'rack':{'$first':_0x50fb88(0xa0)},'expiry_date':{'$first':_0x50fb88(0x11c)},'production_date':{'$first':_0x50fb88(0xab)},'maxPerUnit':{'$first':_0x50fb88(0x153)},'batch_code':{'$first':_0x50fb88(0xc4)},'product_cat':{'$first':_0x50fb88(0x145)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x50fb88(0xcb)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x19826c=await warehouse[_0x50fb88(0x16b)]([{'$match':{'name':_0x1c8e36,'room':_0x230369}},{'$unwind':_0x50fb88(0x10e)},{'$match':{'product_details.secondary_code':_0x59bc23}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x50fb88(0x88)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x50fb88(0x11a)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x50fb88(0x101)},'isle':{'$first':_0x50fb88(0xd3)},'type':{'$first':_0x50fb88(0xd9)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x50fb88(0x188)},'storage':{'$first':_0x50fb88(0x179)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x50fb88(0x11c)},'production_date':{'$first':_0x50fb88(0xab)},'maxPerUnit':{'$first':_0x50fb88(0x153)},'batch_code':{'$first':_0x50fb88(0xc4)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x50fb88(0xcb)},'invoice':{'$first':_0x50fb88(0x102)}}}]);if(_0x142e1e[_0x50fb88(0xc9)]>0x0)_0x160633[_0x50fb88(0xe3)](_0x142e1e);else _0x19826c[_0x50fb88(0xc9)]>0x0&&_0x160633[_0x50fb88(0xe3)](_0x19826c);}const _0x4ebf55=_0x34dc79[_0x16e218(0xcf)](_0x948aa7=>_0x49d63e(_0x948aa7));await Promise[_0x16e218(0x83)](_0x4ebf55),_0x522b0c['json'](_0x160633);}),module[a0_0x7ab6bd(0x13a)]=router;