var a0_0x3a7fee=a0_0x1b40;(function(_0x40a2bd,_0x833736){var _0x2fb2bd=a0_0x1b40,_0x570569=_0x40a2bd();while(!![]){try{var _0x7f8bdf=-parseInt(_0x2fb2bd(0x20a))/0x1*(-parseInt(_0x2fb2bd(0x193))/0x2)+parseInt(_0x2fb2bd(0x10c))/0x3+parseInt(_0x2fb2bd(0x19f))/0x4+parseInt(_0x2fb2bd(0x122))/0x5*(parseInt(_0x2fb2bd(0x192))/0x6)+parseInt(_0x2fb2bd(0x1f1))/0x7*(-parseInt(_0x2fb2bd(0x17f))/0x8)+-parseInt(_0x2fb2bd(0x15c))/0x9*(parseInt(_0x2fb2bd(0x112))/0xa)+-parseInt(_0x2fb2bd(0x11a))/0xb*(-parseInt(_0x2fb2bd(0x1f6))/0xc);if(_0x7f8bdf===_0x833736)break;else _0x570569['push'](_0x570569['shift']());}catch(_0x9e911a){_0x570569['push'](_0x570569['shift']());}}}(a0_0x2b35,0x42a11));function a0_0x1b40(_0x3aa5b0,_0x4d073b){var _0x2b35e9=a0_0x2b35();return a0_0x1b40=function(_0x1b40bf,_0x3ad851){_0x1b40bf=_0x1b40bf-0xf9;var _0x305eeb=_0x2b35e9[_0x1b40bf];return _0x305eeb;},a0_0x1b40(_0x3aa5b0,_0x4d073b);}const express=require(a0_0x3a7fee(0x124)),app=express(),router=express[a0_0x3a7fee(0x1ca)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0x3a7fee(0x1c3)),auth=require(a0_0x3a7fee(0x171)),nodemailer=require('nodemailer'),users=require(a0_0x3a7fee(0x10f));router['get'](a0_0x3a7fee(0x1b6),auth,async(_0x114830,_0x181be6)=>{var _0x57ed3e=a0_0x3a7fee;try{const {username:_0x40ff1c,email:_0x3c2be0,role:_0x5b73e9}=_0x114830[_0x57ed3e(0x1b2)],_0x57a5ee=_0x114830[_0x57ed3e(0x1b2)],_0xf51056=await profile[_0x57ed3e(0x178)]({'email':_0x57a5ee['email']}),_0xb9f17f=await master_shop[_0x57ed3e(0x200)]();let _0x38db79;if(_0x57a5ee[_0x57ed3e(0x176)]==_0x57ed3e(0x1a0)){const _0x1f7a81=await staff[_0x57ed3e(0x178)]({'email':_0x57a5ee[_0x57ed3e(0x19c)]});_0x38db79=await sales_finished[_0x57ed3e(0x142)]([{'$lookup':{'from':'customers','localField':_0x57ed3e(0x12a),'foreignField':'name','as':'customers_docs'}},{'$unwind':_0x57ed3e(0x114)},{'$unwind':_0x57ed3e(0x143)},{'$group':{'_id':_0x57ed3e(0x1ef),'invoice':{'$first':_0x57ed3e(0xfc)},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x57ed3e(0x143)},'note':{'$first':_0x57ed3e(0x1cc)},'return_data':{'$first':_0x57ed3e(0x1d0)},'customers_docs':{'$first':_0x57ed3e(0x114)},'total_saleproduct_quantity':{'$sum':_0x57ed3e(0xfb)},'level':{'$addToSet':_0x57ed3e(0x1c9)},'isle':{'$addToSet':_0x57ed3e(0x121)},'type':{'$addToSet':_0x57ed3e(0x1fc)},'pallet':{'$addToSet':_0x57ed3e(0x1d8)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x38db79=await sales_finished[_0x57ed3e(0x142)]([{'$lookup':{'from':_0x57ed3e(0x12c),'localField':'customer','foreignField':_0x57ed3e(0x211),'as':_0x57ed3e(0x1d5)}},{'$unwind':_0x57ed3e(0x114)},{'$unwind':_0x57ed3e(0x143)},{'$group':{'_id':_0x57ed3e(0x1ef),'invoice':{'$first':_0x57ed3e(0xfc)},'customers':{'$first':_0x57ed3e(0x214)},'date':{'$first':_0x57ed3e(0x16c)},'warehouse_name':{'$first':_0x57ed3e(0x107)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x57ed3e(0x1cc)},'return_data':{'$first':_0x57ed3e(0x1d0)},'customers_docs':{'$first':_0x57ed3e(0x114)},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x57ed3e(0x1c9)},'isle':{'$addToSet':_0x57ed3e(0x121)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x57ed3e(0x1d8)},'finalize':{'$first':_0x57ed3e(0x152)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);if(_0xb9f17f[0x0]['language']==_0x57ed3e(0x139)){var _0x3e22ae=users['English'];console[_0x57ed3e(0x183)](_0x3e22ae);}else{if(_0xb9f17f[0x0][_0x57ed3e(0x1ec)]==_0x57ed3e(0x16b))var _0x3e22ae=users[_0x57ed3e(0x16b)];else{if(_0xb9f17f[0x0][_0x57ed3e(0x1ec)]==_0x57ed3e(0x17e))var _0x3e22ae=users[_0x57ed3e(0x17e)];else{if(_0xb9f17f[0x0][_0x57ed3e(0x1ec)]==_0x57ed3e(0x129))var _0x3e22ae=users['Spanish'];else{if(_0xb9f17f[0x0][_0x57ed3e(0x1ec)]==_0x57ed3e(0x146))var _0x3e22ae=users[_0x57ed3e(0x146)];else{if(_0xb9f17f[0x0][_0x57ed3e(0x1ec)]==_0x57ed3e(0x216))var _0x3e22ae=users[_0x57ed3e(0x1f7)];else{if(_0xb9f17f[0x0]['language']==_0x57ed3e(0x126))var _0x3e22ae=users[_0x57ed3e(0x126)];else{if(_0xb9f17f[0x0][_0x57ed3e(0x1ec)]==_0x57ed3e(0x149))var _0x3e22ae=users[_0x57ed3e(0x1ea)];}}}}}}}_0x181be6[_0x57ed3e(0x165)](_0x57ed3e(0x177),{'success':_0x114830[_0x57ed3e(0x162)](_0x57ed3e(0x15b)),'errors':_0x114830[_0x57ed3e(0x162)](_0x57ed3e(0x218)),'sales':_0x38db79,'profile':_0xf51056,'role':_0x57a5ee,'master_shop':_0xb9f17f,'language':_0x3e22ae});}catch(_0xe88ce2){console[_0x57ed3e(0x183)](_0xe88ce2);}});function a0_0x2b35(){var _0x444df5=['$product_details.product_stock','padStart','flash','English','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','render','prod_cat','primary_code_QA','out_invoice','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','QA\x20Warehouse','Hindi','$date','$product_details.maxProducts','/preview/:id','Return\x20Goods','sendMail','../middleware/auth','status','product_name','<h5>','error','role','all_sales_finished','findOne','max','</body></html>','maxperunit','$product_details','maxPerUnit','German','8KPyTgD','suppliers','$product_details.type','maxProducts_QA','log','redirect','message','edit_sales_finished','$product_details.primary_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Finished\x20Goods','note','body','Logo.png','id_transaction_from','getFullYear','product_code','warehouse_name','/view/:id','105282CCXHva','542juextl','string','stocks_QA','concat','production_date_QA','password','$product_details.production_date','Email\x20sent\x20successfully','customer_data','email','<div>','Error\x20Occurs','1144404VYmjuT','staff','/all_sales_finished/preview/','random','$product_details.secondary_code','floor','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</thead>','back','</table>','split','An\x20error\x20occurred\x20while\x20saving\x20data.','There\x27s\x20a\x20error\x20in\x20this\x20transaction','currency','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Sale\x20Return','<strong>\x20Regards\x20</strong>','user','<h2>\x20','secondary_unit_QA','push','/view','/view/add_sales','\x20</h2>','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','host','</head><body>','params','barcode\x20Product\x20master','product_code_QA','/all_sales_finished/view','<html><head><title></title>','all','Must\x20not\x20be\x20greater\x20or\x20less\x20than\x20stock\x20Qty','../models/all_models','$product_details.rack','product_list','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','secondary_unit','sales_quantity','$sale_product.bay','Router','_id','$note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','invoice','\x20<>\x20','$return_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Sales\x20Update\x20successfully','<!DOCTYPE\x20html>','Ambient','customers_docs','/view/add_sales/:id','$product_details.floorlevel','$sale_product.floorlevel','True','final','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.product_name','sales_quantity_QA','/all_sales/view','expiry_date_QA','return_sale_QA','\x20Order\x20Number\x20:\x20','abs','logo','product_date','quantity','maxProducts','finalize','unit','getMonth','Arabic','product_details','language','Sale','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$_id','primary_unit','3680810CZmzew','</div>','/../public','add\x20post','primary_code','4082856lDCnsg','Portuguese','return_qty_QA','</span>','Return\x20Rooms','sales\x20item\x20return\x20successfull','$sale_product.type','<tr>','findById','room_name','find','$product_details.unit','product_data','gmail','<span\x20style=\x22float:\x20right;\x22>','<hr\x20class=\x22my-3\x22>','$product_details.bin','</tr>','$product_details.invoice','barcode\x20user_id','426tsrwaQ','carton','Enabled','<h5\x20style=\x22text-align:\x20left;\x22>','return_sale_finished','save','product','name','$room','sale_qty','$customer','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Portuguese\x20(BR)','site_title','errors','return_qty','return_sale','warehouse','$sale_product.quantity','$invoice','$product_details.bay','image','return_data','Enclosed','filter','batch_code','secondary_code_QA','An\x20error\x20occurred.','OUTF-','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$warehouse_name','sale_product','$product_details.batch_code','stock','<tbody\x20style=\x22text-align:\x20center;\x22>','66618uRClWX','product_stock','date_data','../public/language/languages.json','$product_details.product_code','RoomAssigned','42590ABqgDY','product_name_QA1','$customers_docs','prod_code','/barcode_scanner','$name','adjust_qty','then','11dxGDHe','$product_details.expiry_date','/view/return_sales/:id','map','secondary_code','/upload/','slice','$sale_product.bin','90pezMhZ','forEach','express','post','Chinese','unit_QA','</td>','Spanish','customer','$product_details.secondary_unit','customers','length','expiry_date','/view/add_sale/product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','level','</tbody>','received_amount','currency_placement','$product_details._id','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','payment\x20successfull','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','English\x20(US)','exports','\x20Order\x20Date\x20:\x20','prod_invoice','Received\x20Payment\x20For\x20Sale','$product_details.maxPerUnit','batch_code_QA','Sales\x20Add\x20successfully','DRY\x20GOODS','aggregate','$sale_product','$product_details.product_cat','foreach\x20newproduct','French','production_date','maxPerUnit_QA','Arabic\x20(ae)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$product_details.room_name','all_sales_barcode','for_categorize','Sale\x20Return\x20Mail','Quality\x20Inspection','/invoice/:id','$product_details.storage','$finalize','room','json','createTransport','getDate','sales_invoice','max_per_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','get','success','594QiXatp','catch','amount','master'];a0_0x2b35=function(){return _0x444df5;};return a0_0x2b35();}async function getRandom8DigitNumber(){var _0x4d0913=a0_0x3a7fee;const _0xaf5a2b=0x989680,_0x31b28=0x5f5e0ff,_0xb9518a=Math[_0x4d0913(0x1a4)](Math[_0x4d0913(0x1a2)]()*(_0x31b28-_0xaf5a2b+0x1))+_0xaf5a2b;var _0x400a81;const _0x695e95=await sales_finished[_0x4d0913(0x178)]({'invoice':_0x4d0913(0x105)+_0xb9518a});return _0x695e95&&_0x695e95[_0x4d0913(0x12d)]>0x0?_0x400a81=_0x4d0913(0x105)+_0xb9518a:_0x400a81=_0x4d0913(0x105)+_0xb9518a,_0x400a81;}router[a0_0x3a7fee(0x15a)]('/view/add_sales',auth,async(_0x2cbf7d,_0x34677f)=>{var _0x4b740e=a0_0x3a7fee;try{const {username:_0x261c67,email:_0x3e0665,role:_0x398da5}=_0x2cbf7d[_0x4b740e(0x1b2)],_0x4fdd67=_0x2cbf7d[_0x4b740e(0x1b2)],_0x4d9228=await profile[_0x4b740e(0x178)]({'email':_0x4fdd67['email']}),_0x579ec7=await master_shop['find'](),_0x2b937e=await customer[_0x4b740e(0x200)]({});let _0x167e10;if(_0x4fdd67[_0x4b740e(0x176)]==_0x4b740e(0x1a0)){const _0x17a3e8=await staff[_0x4b740e(0x178)]({'email':_0x4fdd67['email']});_0x167e10=await warehouse[_0x4b740e(0x142)]([{'$match':{'status':_0x4b740e(0x20c),'name':_0x17a3e8[_0x4b740e(0xfa)],'warehouse_category':_0x4b740e(0x189),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x4b740e(0x117),'name':{'$first':_0x4b740e(0x117)}}},{'$sort':{'name':0x1}}]);}else _0x167e10=await warehouse[_0x4b740e(0x142)]([{'$match':{'status':'Enabled','warehouse_category':_0x4b740e(0x189),'name':{'$ne':_0x4b740e(0x16a)}}},{'$group':{'_id':'$name','name':{'$first':_0x4b740e(0x117)}}},{'$sort':{'name':0x1}}]);const _0x6b9ba7=await product['find']({});var _0x75be67=[_0x4b740e(0x1d4),_0x4b740e(0x100)];const _0x5f237d=await sales_finished[_0x4b740e(0x200)]({}),_0x421399=_0x5f237d[_0x4b740e(0x12d)]+0x1,_0x372771=_0x4b740e(0x105)+_0x421399['toString']()[_0x4b740e(0x161)](0x5,'0');if(_0x579ec7[0x0][_0x4b740e(0x1ec)]=='English\x20(US)'){var _0x582a8f=users[_0x4b740e(0x163)];console[_0x4b740e(0x183)](_0x582a8f);}else{if(_0x579ec7[0x0][_0x4b740e(0x1ec)]==_0x4b740e(0x16b))var _0x582a8f=users[_0x4b740e(0x16b)];else{if(_0x579ec7[0x0][_0x4b740e(0x1ec)]==_0x4b740e(0x17e))var _0x582a8f=users[_0x4b740e(0x17e)];else{if(_0x579ec7[0x0][_0x4b740e(0x1ec)]==_0x4b740e(0x129))var _0x582a8f=users[_0x4b740e(0x129)];else{if(_0x579ec7[0x0][_0x4b740e(0x1ec)]==_0x4b740e(0x146))var _0x582a8f=users[_0x4b740e(0x146)];else{if(_0x579ec7[0x0][_0x4b740e(0x1ec)]==_0x4b740e(0x216))var _0x582a8f=users[_0x4b740e(0x1f7)];else{if(_0x579ec7[0x0][_0x4b740e(0x1ec)]==_0x4b740e(0x126))var _0x582a8f=users[_0x4b740e(0x126)];else{if(_0x579ec7[0x0]['language']==_0x4b740e(0x149))var _0x582a8f=users['Arabic'];}}}}}}}const _0x3c92bf=getRandom8DigitNumber();_0x3c92bf[_0x4b740e(0x119)](_0x1f66e5=>{var _0xa0d441=_0x4b740e;_0x34677f['render']('add_sales_finished',{'success':_0x2cbf7d[_0xa0d441(0x162)](_0xa0d441(0x15b)),'errors':_0x2cbf7d[_0xa0d441(0x162)](_0xa0d441(0x218)),'role':_0x4fdd67,'profile':_0x4d9228,'customer':_0x2b937e,'warehouse':_0x167e10,'product':_0x6b9ba7,'invoice':_0x1f66e5,'master_shop':_0x579ec7,'language':_0x582a8f,'rooms_data':_0x75be67});})[_0x4b740e(0x15d)](_0x5b5d3e=>{var _0x35cec2=_0x4b740e;_0x2cbf7d[_0x35cec2(0x162)]('errors',_0x35cec2(0x1ac)),_0x34677f[_0x35cec2(0x184)](_0x35cec2(0x1bf));});}catch(_0x3a5629){console[_0x4b740e(0x183)](_0x3a5629);}}),router[a0_0x3a7fee(0x15a)](a0_0x3a7fee(0x1d6),auth,async(_0x53318b,_0x40e24e)=>{var _0x124b17=a0_0x3a7fee;try{const _0x3eda06=_0x53318b[_0x124b17(0x1bc)]['id'];console[_0x124b17(0x183)](_0x3eda06);const _0x2106bd=await product[_0x124b17(0x200)](),_0x2b27a0=await purchases[_0x124b17(0x142)]([{'$match':{'warehouse_name':_0x3eda06}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]);console[_0x124b17(0x183)]('purchases_data',_0x2b27a0),_0x40e24e[_0x124b17(0x172)](0xc8)[_0x124b17(0x154)]({'purchases_data':_0x2b27a0,'product_data':_0x2106bd});}catch(_0x2973c2){console[_0x124b17(0x183)](_0x2973c2);}}),router[a0_0x3a7fee(0x125)](a0_0x3a7fee(0x12f),auth,async(_0x37ca3b,_0x56e5e8)=>{var _0x439073=a0_0x3a7fee;try{const {warehouse_data:_0x169109,product_data:_0x50fd75}=_0x37ca3b[_0x439073(0x18b)];console[_0x439073(0x183)](_0x37ca3b[_0x439073(0x18b)][_0x439073(0x202)]);;const _0x3501b7=await master_shop[_0x439073(0x200)]();console['log'](_0x439073(0x15f),_0x3501b7);const _0x2e3e65=await product[_0x439073(0x178)]({'name':_0x50fd75});console[_0x439073(0x183)](_0x439073(0x210),_0x2e3e65);const _0x327e27=await warehouse[_0x439073(0x142)]([{'$match':{'name':_0x169109}},{'$unwind':_0x439073(0x17c)},{'$match':{'product_details.product_name':_0x50fd75}},{'$group':{'_id':_0x439073(0x1dc),'product_stock':{'$first':'$product_details.product_stock'}}}]);console[_0x439073(0x183)]('stock_data',_0x327e27),_0x56e5e8['status'](0xc8)[_0x439073(0x154)]({'master':_0x3501b7,'new_product':_0x2e3e65,'stock_data':_0x327e27});}catch(_0x261668){console[_0x439073(0x183)](_0x261668);}}),router[a0_0x3a7fee(0x125)](a0_0x3a7fee(0x1b7),auth,async(_0x177496,_0x282925)=>{var _0x82a7f1=a0_0x3a7fee;try{const {invoice:_0x53ed4c,date:_0xb66f1f,warehouse_name:_0xdda18c,product_name:_0x53037d,stock:_0x45b9a8,quantity:_0xc90aea,note:_0x4ddb04,room:_0x282a64,primary_code:_0x32f842,secondary_code:_0x34dc17,prod_code:_0xe42716,level:_0x2a9a65,isle:_0x47a20e,pallet:_0x399cf2,batch_code:_0x35dbad,SCRN:_0x36eb10,expiry_date:_0x428029,mode_transpo:_0x3f479c,name_driver:_0x5d7638}=_0x177496[_0x82a7f1(0x18b)];if(typeof _0x53037d=='string')var _0x98cf27=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x173)]],_0x4783b2=[_0x177496['body']['stock']],_0xab6ac0=[_0x177496['body'][_0x82a7f1(0x20b)]],_0x1fdf6b=[_0x177496[_0x82a7f1(0x18b)]['primary_code']],_0x4d181e=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x11e)]],_0x228d8c=[_0x177496['body'][_0x82a7f1(0x115)]],_0xf0266b=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x131)]],_0x535514=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x1f0)]],_0x2fe835=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x1c7)]],_0x5a42b0=[_0x177496['body'][_0x82a7f1(0x102)]],_0x282142=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x12e)]],_0x12bb78=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x1e4)]],_0x375435=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x158)]],_0x586bf7=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x166)]],_0x4985c3=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x111)]],_0x832fec=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x13c)]],_0x223e11=[_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x18d)]];else var _0x98cf27=[..._0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x173)]],_0x4783b2=[..._0x177496[_0x82a7f1(0x18b)]['stock']],_0xab6ac0=[..._0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x20b)]],_0x1fdf6b=[..._0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x1f5)]],_0x4d181e=[..._0x177496[_0x82a7f1(0x18b)]['secondary_code']],_0x228d8c=[..._0x177496['body'][_0x82a7f1(0x115)]],_0xf0266b=[..._0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x131)]],_0x535514=[..._0x177496['body'][_0x82a7f1(0x1f0)]],_0x2fe835=[..._0x177496['body'][_0x82a7f1(0x1c7)]],_0x5a42b0=[..._0x177496['body'][_0x82a7f1(0x102)]],_0x282142=[..._0x177496['body'][_0x82a7f1(0x12e)]],_0x12bb78=[..._0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x1e4)]],_0x375435=[..._0x177496[_0x82a7f1(0x18b)]['max_per_unit']],_0x586bf7=[..._0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x166)]],_0x4985c3=[..._0x177496['body'][_0x82a7f1(0x111)]],_0x832fec=[..._0x177496[_0x82a7f1(0x18b)]['prod_invoice']],_0x223e11=[..._0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x18d)]];const _0x2e3638=_0x98cf27[_0x82a7f1(0x11d)](_0x50304f=>{return _0x50304f={'product_name':_0x50304f};});_0x4783b2[_0x82a7f1(0x123)]((_0x3e136f,_0x5894d1)=>{var _0x271b87=_0x82a7f1;_0x2e3638[_0x5894d1][_0x271b87(0x10a)]=_0x3e136f;}),_0xab6ac0['forEach']((_0x3e50d4,_0x26f5dc)=>{var _0x8f62af=_0x82a7f1;_0x2e3638[_0x26f5dc][_0x8f62af(0x1e5)]=Math[_0x8f62af(0x1e2)](_0x3e50d4);}),_0x223e11[_0x82a7f1(0x123)]((_0x25b949,_0x29eee6)=>{_0x2e3638[_0x29eee6]['id_transaction_from']=_0x25b949;}),_0x1fdf6b['forEach']((_0x5f2340,_0x1224fe)=>{var _0x52fff2=_0x82a7f1;_0x2e3638[_0x1224fe][_0x52fff2(0x1f5)]=_0x5f2340;}),_0x4d181e[_0x82a7f1(0x123)]((_0x511912,_0x9c4ac3)=>{_0x2e3638[_0x9c4ac3]['secondary_code']=_0x511912;}),_0x228d8c[_0x82a7f1(0x123)]((_0x5bd8e8,_0xc6be2a)=>{var _0x37643a=_0x82a7f1;_0x2e3638[_0xc6be2a]['product_code']=_0x5bd8e8,_0x2e3638[_0xc6be2a][_0x37643a(0x10e)]=_0xb66f1f;}),_0xf0266b[_0x82a7f1(0x123)]((_0x2464cc,_0x197a2d)=>{_0x2e3638[_0x197a2d]['bay']=_0x2464cc;}),_0x535514['forEach']((_0x2f2c39,_0x407455)=>{_0x2e3638[_0x407455]['unit']=_0x2f2c39;}),_0x2fe835[_0x82a7f1(0x123)]((_0x524c00,_0x1c5183)=>{var _0x492f81=_0x82a7f1;_0x2e3638[_0x1c5183][_0x492f81(0x1c7)]=_0x524c00;}),_0x5a42b0['forEach']((_0x2196c0,_0x2cd5dc)=>{var _0x5f0646=_0x82a7f1;_0x2e3638[_0x2cd5dc][_0x5f0646(0x102)]=_0x2196c0;}),_0x282142['forEach']((_0x1f8efd,_0x47e35b)=>{var _0x15323b=_0x82a7f1;_0x2e3638[_0x47e35b][_0x15323b(0x12e)]=_0x1f8efd;}),_0x12bb78['forEach']((_0x5af2ee,_0x129d86)=>{var _0x280a33=_0x82a7f1;_0x2e3638[_0x129d86][_0x280a33(0x147)]=_0x5af2ee;}),_0x375435[_0x82a7f1(0x123)]((_0x405225,_0x2458a3)=>{var _0x485dcd=_0x82a7f1;_0x2e3638[_0x2458a3][_0x485dcd(0x17b)]=_0x405225;}),_0x586bf7[_0x82a7f1(0x123)]((_0x288ba3,_0x295182)=>{var _0x39cf28=_0x82a7f1;_0x2e3638[_0x295182][_0x39cf28(0x166)]=_0x288ba3;}),_0x4985c3['forEach']((_0x136031,_0x1fa28b)=>{var _0x4afffa=_0x82a7f1;_0x2e3638[_0x1fa28b][_0x4afffa(0x1ff)]=_0x136031;}),_0x832fec[_0x82a7f1(0x123)]((_0x2d58c2,_0x2a4d61)=>{_0x2e3638[_0x2a4d61]['invoice']=_0x2d58c2;});var _0x2d5e43=0x0;_0x2e3638[_0x82a7f1(0x123)](_0x372834=>{var _0x3f32ef=_0x82a7f1;parseFloat(_0x372834['stock'])<parseFloat(_0x372834[_0x3f32ef(0x1e5)])&&parseFloat(_0x372834[_0x3f32ef(0x1e5)])>parseFloat(_0x372834[_0x3f32ef(0x10a)])&&(console[_0x3f32ef(0x183)](_0x372834[_0x3f32ef(0x10a)]+_0x3f32ef(0x1cf)+_0x372834[_0x3f32ef(0x1e5)]),_0x2d5e43++);});if(_0x2d5e43!=0x0)return _0x177496[_0x82a7f1(0x162)]('errors',_0x82a7f1(0x1c2)),_0x282925[_0x82a7f1(0x184)](_0x82a7f1(0x1a8));const _0x3a8c73=_0x2e3638[_0x82a7f1(0x101)](_0x1cff56=>_0x1cff56[_0x82a7f1(0x1e5)]!=='0'&&_0x1cff56['quantity']!==''),_0x4a86ff=new sales_finished({'invoice':_0x53ed4c,'customer':_0x177496[_0x82a7f1(0x18b)]['customer'],'date':_0xb66f1f,'warehouse_name':_0xdda18c,'sale_product':_0x3a8c73,'note':_0x4ddb04,'room':_0x282a64,'primary_code':_0x32f842,'secondary_code':_0x34dc17,'prod_code':_0xe42716,'SCRN':_0x36eb10,'finalize':'False','mode_transpo':_0x3f479c,'name_driver':_0x5d7638}),_0x349fe4=await _0x4a86ff['save'](),_0x396ee0=await sales_finished[_0x82a7f1(0x178)]({'invoice':_0x53ed4c}),_0x4b2071=new c_payment_data({'invoice':_0x53ed4c,'customer':_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x12a)],'reason':_0x82a7f1(0x1ed)});await _0x4b2071[_0x82a7f1(0x20f)]();const _0x47c235=await master_shop['find'](),_0x454bf2=await email_settings[_0x82a7f1(0x178)](),_0x39ebe1=await customer[_0x82a7f1(0x178)]({'name':_0x177496[_0x82a7f1(0x18b)][_0x82a7f1(0x12a)]});_0x47c235[0x0]['currency_placement']==0x1?(right_currency=_0x47c235[0x0][_0x82a7f1(0x1ad)],left_currency=''):(right_currency='',left_currency=_0x47c235[0x0][_0x82a7f1(0x1ad)]);var _0x4b4344=_0x98cf27,_0x1ac214=_0xab6ac0,_0x3e1e6a='',_0xe56f8d;for(_0xe56f8d in _0x4b4344){_0x3e1e6a+='<tr>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4b4344[_0xe56f8d]+_0x82a7f1(0x128)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1ac214[_0xe56f8d]+_0x82a7f1(0x128)+_0x82a7f1(0x207);}console[_0x82a7f1(0x183)](_0x82a7f1(0x1c5),_0x3e1e6a),_0x177496[_0x82a7f1(0x162)](_0x82a7f1(0x15b),_0x82a7f1(0x140)),_0x282925[_0x82a7f1(0x184)](_0x82a7f1(0x1a1)+_0x349fe4['_id']);}catch(_0x1b0bc3){console[_0x82a7f1(0x183)](_0x1b0bc3);}}),router[a0_0x3a7fee(0x15a)](a0_0x3a7fee(0x16e),auth,async(_0x4434b4,_0x4b2f95)=>{var _0x1e70a3=a0_0x3a7fee;try{const {username:_0x1f216d,email:_0x320eba,role:_0x2cf4e2}=_0x4434b4[_0x1e70a3(0x1b2)],_0x1d8f80=_0x4434b4[_0x1e70a3(0x1b2)],_0x4ad67f=await profile[_0x1e70a3(0x178)]({'email':_0x1d8f80['email']}),_0x1e34b6=await master_shop['find'](),_0x34a8d1=_0x4434b4[_0x1e70a3(0x1bc)]['id'],_0x134786=await sales_finished[_0x1e70a3(0x1fe)](_0x34a8d1),_0x4d532f=await warehouse['aggregate']([{'$match':{'name':_0x134786[_0x1e70a3(0x190)]}},{'$unwind':_0x1e70a3(0x17c)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1e70a3(0x1dc)},'product_stock':{'$first':_0x1e70a3(0x160)},'bay':{'$first':_0x1e70a3(0xfd)},'bin':{'$first':_0x1e70a3(0x206)},'type':{'$first':_0x1e70a3(0x181)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1e70a3(0x187)},'secondary_code':{'$first':_0x1e70a3(0x1a3)},'product_code':{'$first':_0x1e70a3(0x110)},'storage':{'$first':_0x1e70a3(0x151)},'rack':{'$first':_0x1e70a3(0x1c4)},'expiry_date':{'$first':_0x1e70a3(0x11b)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1e70a3(0x109)},'room':{'$first':'$room'},'room_data':{'$first':_0x1e70a3(0x14b)}}}]),_0x5f5bbb=await customer[_0x1e70a3(0x200)]({});let _0x339137;if(_0x1d8f80[_0x1e70a3(0x176)]=='staff'){const _0x2c9b83=await staff[_0x1e70a3(0x178)]({'email':_0x1d8f80[_0x1e70a3(0x19c)]});_0x339137=await warehouse[_0x1e70a3(0x142)]([{'$match':{'status':_0x1e70a3(0x20c),'name':_0x2c9b83[_0x1e70a3(0xfa)]}},{'$group':{'_id':_0x1e70a3(0x117),'name':{'$first':_0x1e70a3(0x117)}}}]);}else _0x339137=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x1e70a3(0x117),'name':{'$first':_0x1e70a3(0x117)}}}]);const _0x302247=await product[_0x1e70a3(0x200)]({});if(_0x1e34b6[0x0][_0x1e70a3(0x1ec)]=='English\x20(US)'){var _0x1b18b1=users[_0x1e70a3(0x163)];console[_0x1e70a3(0x183)](_0x1b18b1);}else{if(_0x1e34b6[0x0][_0x1e70a3(0x1ec)]==_0x1e70a3(0x16b))var _0x1b18b1=users[_0x1e70a3(0x16b)];else{if(_0x1e34b6[0x0][_0x1e70a3(0x1ec)]==_0x1e70a3(0x17e))var _0x1b18b1=users[_0x1e70a3(0x17e)];else{if(_0x1e34b6[0x0]['language']==_0x1e70a3(0x129))var _0x1b18b1=users[_0x1e70a3(0x129)];else{if(_0x1e34b6[0x0]['language']=='French')var _0x1b18b1=users[_0x1e70a3(0x146)];else{if(_0x1e34b6[0x0][_0x1e70a3(0x1ec)]=='Portuguese\x20(BR)')var _0x1b18b1=users[_0x1e70a3(0x1f7)];else{if(_0x1e34b6[0x0][_0x1e70a3(0x1ec)]==_0x1e70a3(0x126))var _0x1b18b1=users['Chinese'];else{if(_0x1e34b6[0x0][_0x1e70a3(0x1ec)]==_0x1e70a3(0x149))var _0x1b18b1=users['Arabic'];}}}}}}}_0x4b2f95['render']('edit_sales_finished_view',{'success':_0x4434b4[_0x1e70a3(0x162)](_0x1e70a3(0x15b)),'errors':_0x4434b4[_0x1e70a3(0x162)]('errors'),'role':_0x1d8f80,'profile':_0x4ad67f,'customer':_0x5f5bbb,'warehouse':_0x339137,'product':_0x4d532f,'user':_0x134786,'master_shop':_0x1e34b6,'unit':_0x302247,'language':_0x1b18b1});}catch(_0x589ae0){console['log'](_0x589ae0);}}),router['post'](a0_0x3a7fee(0x16e),auth,async(_0xce00de,_0x1c9e2a)=>{var _0x2eb938=a0_0x3a7fee;try{const _0xeaed8c=_0xce00de[_0x2eb938(0x1bc)]['id'],{invoice:_0x1f2e9f,warehouse_name:_0x1bfd3d,room:_0x11cc49}=_0xce00de['body'],_0x1e613a=await sales_finished[_0x2eb938(0x178)]({'invoice':_0x1f2e9f}),_0x516d3f=_0x1e613a[_0x2eb938(0x108)][_0x2eb938(0x11d)](async _0x2ee1cb=>{var _0x3991ea=_0x2eb938,_0xc37a46=await warehouse[_0x3991ea(0x178)]({'name':_0x1bfd3d,'room':_0x2ee1cb['room_name'],'warehouse_category':_0x3991ea(0x189)});const _0xaaa1cf=_0xc37a46[_0x3991ea(0x1eb)]['map'](_0x8edb15=>{var _0x314566=_0x3991ea;if(_0x8edb15[_0x314566(0x173)]==_0x2ee1cb[_0x314566(0x173)]&&_0x8edb15[_0x314566(0x1a5)]==_0x2ee1cb[_0x314566(0x1a5)]&&_0x8edb15[_0x314566(0x12e)]==_0x2ee1cb[_0x314566(0x12e)]&&_0x8edb15[_0x314566(0x147)]==_0x2ee1cb[_0x314566(0x147)]&&_0x8edb15['batch_code']==_0x2ee1cb['batch_code']&&_0x8edb15[_0x314566(0x1cb)]==_0x2ee1cb[_0x314566(0x18d)]){if(_0x8edb15['product_stock']>0x0){_0x8edb15[_0x314566(0x10d)]=Math[_0x314566(0x179)](0x0,Math[_0x314566(0x1e2)](_0x8edb15[_0x314566(0x10d)])-Math[_0x314566(0x1e2)](_0x2ee1cb['quantity']));if(_0x8edb15[_0x314566(0x168)]==undefined)_0x8edb15[_0x314566(0x168)]=_0x1f2e9f+'~';else{var _0x5f117c=_0x8edb15['out_invoice'][_0x314566(0x1aa)]('~'),_0x1c1857='';for(let _0xe2041=0x0;_0xe2041<=_0x5f117c[_0x314566(0x12d)]-0x1;_0xe2041++){const _0x185151=_0x5f117c[_0xe2041];_0x185151[_0x314566(0x12d)]>0x0&&(_0x1c1857+=_0x185151+'~');}_0x8edb15['out_invoice']=_0x1c1857;}}}});return console['log'](_0xc37a46),_0xc37a46;});Promise[_0x2eb938(0x1c1)](_0x516d3f)['then'](async _0x3c1887=>{var _0x27f484=_0x2eb938;try{for(const _0x313abc of _0x3c1887){await _0x313abc[_0x27f484(0x20f)]();}_0x1e613a[_0x27f484(0x1e7)]=_0x27f484(0x1d9);const _0x5a4782=await _0x1e613a[_0x27f484(0x20f)](),_0x57f805=await master_shop[_0x27f484(0x200)](),_0x618dce=await email_settings[_0x27f484(0x178)](),_0x3d8da7=await supervisor_settings[_0x27f484(0x200)]();var _0xfbfbef=_0x1e613a[_0x27f484(0x108)],_0x4d4789='',_0x1df535;for(_0x1df535 in _0xfbfbef){var _0x47739a='FG';_0x1e613a[_0x27f484(0x190)]==_0x27f484(0x141)&&(_0x47739a='DG'),_0x4d4789+=_0x27f484(0x1fd)+_0x27f484(0x106)+_0xfbfbef[_0x1df535]['product_name']+'</td>'+_0x27f484(0x106)+_0xfbfbef[_0x1df535][_0x27f484(0x18f)]+_0x27f484(0x128)+_0x27f484(0x106)+_0xfbfbef[_0x1df535]['quantity']+_0x27f484(0x128)+_0x27f484(0x106)+_0xfbfbef[_0x1df535][_0x27f484(0x1e8)]+_0x27f484(0x128)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xfbfbef[_0x1df535][_0x27f484(0x1c7)]+'</td>'+_0x27f484(0x106)+_0x1e613a[_0x27f484(0x190)]+'</td>'+_0x27f484(0x106)+_0xfbfbef[_0x1df535][_0x27f484(0x1ff)]+_0x27f484(0x128)+_0x27f484(0x106)+_0x47739a+_0xfbfbef[_0x1df535]['bay']+_0x27f484(0x128);}let _0x499f75=nodemailer[_0x27f484(0x155)]({'host':_0x618dce[_0x27f484(0x1ba)],'port':Number(_0x618dce['port']),'secure':![],'auth':{'user':_0x618dce[_0x27f484(0x19c)],'pass':_0x618dce[_0x27f484(0x198)]}}),_0x3c631b={'from':_0x618dce[_0x27f484(0x19c)],'to':_0x3d8da7[0x0]['FGSEmail'],'subject':'Sales\x20Mail','attachments':[{'filename':_0x27f484(0x18c),'path':__dirname+_0x27f484(0x1f3)+'/upload/'+_0x57f805[0x0][_0x27f484(0xfe)],'cid':_0x27f484(0x1e3)}],'html':_0x27f484(0x1d3)+_0x27f484(0x1c0)+_0x27f484(0x1bb)+_0x27f484(0x19d)+_0x27f484(0x1ee)+_0x27f484(0x19d)+_0x27f484(0x188)+_0x27f484(0x1f2)+'<div>'+_0x27f484(0x1b3)+_0x57f805[0x0]['site_title']+_0x27f484(0x1b8)+_0x27f484(0x1f2)+'</div>'+_0x27f484(0x205)+_0x27f484(0x19d)+_0x27f484(0x20d)+_0x27f484(0x1e1)+_0x1e613a[_0x27f484(0x1ce)]+'\x20'+_0x27f484(0x204)+_0x27f484(0x13b)+_0x1e613a['date']+'\x20'+_0x27f484(0x1f9)+'</h5>'+_0x27f484(0x1f2)+_0x27f484(0x215)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x27f484(0x1fd)+_0x27f484(0x138)+_0x27f484(0x130)+_0x27f484(0x164)+_0x27f484(0x1d1)+_0x27f484(0x1a6)+_0x27f484(0x1db)+_0x27f484(0x1af)+_0x27f484(0x1cd)+_0x27f484(0x207)+_0x27f484(0x1a7)+_0x27f484(0x10b)+'\x20'+_0x4d4789+'\x20'+_0x27f484(0x132)+'</table>'+_0x27f484(0x19d)+_0x27f484(0x1b1)+_0x27f484(0x174)+_0x57f805[0x0][_0x27f484(0x217)]+'</h5>'+'</div>'+_0x27f484(0x1f2)+_0x27f484(0x17a)};_0x499f75[_0x27f484(0x170)](_0x3c631b,function(_0x182af8,_0x24ff51){var _0x9bcc9d=_0x27f484;_0x182af8?(console[_0x9bcc9d(0x183)](_0x182af8),console[_0x9bcc9d(0x183)](_0x9bcc9d(0x19e))):console[_0x9bcc9d(0x183)](_0x9bcc9d(0x19a));}),_0xce00de[_0x27f484(0x162)](_0x27f484(0x15b),_0x27f484(0x1d2)),_0x1c9e2a[_0x27f484(0x184)]('/picking_list/pdf/'+_0xeaed8c);}catch(_0x509692){console[_0x27f484(0x175)](_0x509692),_0x1c9e2a[_0x27f484(0x172)](0x1f4)[_0x27f484(0x154)]({'error':_0x27f484(0x1ab)});}})['catch'](_0x503682=>{var _0x6e39d=_0x2eb938;console['error'](_0x503682),_0x1c9e2a['status'](0x1f4)[_0x6e39d(0x154)]({'error':_0x6e39d(0x104)});});}catch(_0x45f8db){console[_0x2eb938(0x183)](_0x45f8db);}}),router['get'](a0_0x3a7fee(0x191),auth,async(_0x3395e8,_0x459ac3)=>{var _0x20124b=a0_0x3a7fee;try{const {username:_0x5649ec,email:_0x22e170,role:_0x17b32a}=_0x3395e8[_0x20124b(0x1b2)],_0x4d1667=_0x3395e8[_0x20124b(0x1b2)],_0x282c3d=await profile[_0x20124b(0x178)]({'email':_0x4d1667[_0x20124b(0x19c)]}),_0x8817e2=await master_shop[_0x20124b(0x200)](),_0x5c954a=_0x3395e8[_0x20124b(0x1bc)]['id'],_0x324964=await sales_finished[_0x20124b(0x1fe)](_0x5c954a);let _0x41f1a8=new Date(_0x324964[_0x20124b(0x12e)]),_0x21cc33=('0'+_0x41f1a8[_0x20124b(0x156)]())[_0x20124b(0x120)](-0x2),_0x74f648=('0'+(_0x41f1a8['getMonth']()+0x1))[_0x20124b(0x120)](-0x2),_0x3d2e4d=_0x41f1a8[_0x20124b(0x18e)](),_0xf45418=_0x3d2e4d+'-'+_0x74f648+'-'+_0x21cc33;var _0x549ec5=['Ambient',_0x20124b(0x100)];const _0xc46466=await warehouse[_0x20124b(0x142)]([{'$match':{'name':_0x324964['warehouse_name'],'room':_0x324964[_0x20124b(0x153)]}},{'$unwind':_0x20124b(0x17c)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x20124b(0x1dc)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x20124b(0xfd)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x20124b(0x187)},'secondary_code':{'$first':_0x20124b(0x1a3)},'product_code':{'$first':_0x20124b(0x110)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x20124b(0x1c4)}}}]),_0x45769a=await customer[_0x20124b(0x200)]({});let _0x34f6f0;if(_0x4d1667['role']==_0x20124b(0x1a0)){const _0x2a0866=await staff[_0x20124b(0x178)]({'email':_0x4d1667['email']});_0x34f6f0=await warehouse[_0x20124b(0x142)]([{'$match':{'status':'Enabled','name':_0x2a0866[_0x20124b(0xfa)]}},{'$group':{'_id':_0x20124b(0x117),'name':{'$first':_0x20124b(0x117)}}}]);}else _0x34f6f0=await warehouse[_0x20124b(0x142)]([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x20124b(0x117),'name':{'$first':_0x20124b(0x117)}}}]);const _0x446d40=await product['find']({});if(_0x8817e2[0x0]['language']==_0x20124b(0x139)){var _0x2c5b91=users[_0x20124b(0x163)];console['log'](_0x2c5b91);}else{if(_0x8817e2[0x0][_0x20124b(0x1ec)]==_0x20124b(0x16b))var _0x2c5b91=users['Hindi'];else{if(_0x8817e2[0x0][_0x20124b(0x1ec)]==_0x20124b(0x17e))var _0x2c5b91=users[_0x20124b(0x17e)];else{if(_0x8817e2[0x0][_0x20124b(0x1ec)]=='Spanish')var _0x2c5b91=users[_0x20124b(0x129)];else{if(_0x8817e2[0x0]['language']==_0x20124b(0x146))var _0x2c5b91=users[_0x20124b(0x146)];else{if(_0x8817e2[0x0][_0x20124b(0x1ec)]=='Portuguese\x20(BR)')var _0x2c5b91=users[_0x20124b(0x1f7)];else{if(_0x8817e2[0x0][_0x20124b(0x1ec)]=='Chinese')var _0x2c5b91=users['Chinese'];else{if(_0x8817e2[0x0]['language']=='Arabic\x20(ae)')var _0x2c5b91=users[_0x20124b(0x1ea)];}}}}}}}_0x459ac3[_0x20124b(0x165)](_0x20124b(0x186),{'success':_0x3395e8['flash'](_0x20124b(0x15b)),'errors':_0x3395e8[_0x20124b(0x162)](_0x20124b(0x218)),'role':_0x4d1667,'profile':_0x282c3d,'customer':_0x45769a,'warehouse':_0x34f6f0,'product':_0xc46466,'user':_0x324964,'master_shop':_0x8817e2,'unit':_0x446d40,'language':_0x2c5b91,'rooms_data':_0x549ec5,'ed_fullDate':_0xf45418});}catch(_0x5d17a4){console[_0x20124b(0x183)](_0x5d17a4);}}),router[a0_0x3a7fee(0x125)](a0_0x3a7fee(0x191),auth,async(_0x22a2ce,_0x21132b)=>{var _0x118a62=a0_0x3a7fee;try{const _0x1d28e0=_0x22a2ce['params']['id'],_0x3027f4=await sales_finished['findOne']({'_id':_0x22a2ce[_0x118a62(0x1bc)]['id']}),_0x1dfd16=await warehouse[_0x118a62(0x178)]({'name':_0x3027f4[_0x118a62(0x190)],'room':_0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x153)],'warehouse_category':_0x118a62(0x189)}),{invoice:_0x51e518,customer:_0x53787d,date:_0x1f65e5,warehouse_name:_0x57ebe6,product_name:_0x1b0ee8,stock:_0x2fe165,adjust_qty:_0x465ae2,note:_0x57907a,room:_0x25d447,primary_code:_0x4fd54b,secondary_code:_0x530fd6,prod_code:_0x1c250c,level:_0x19ebf1,isle:_0x153ce8,pallet:_0x5a2ea9,expiry_date:_0x478649}=_0x22a2ce[_0x118a62(0x18b)];if(typeof _0x1b0ee8==_0x118a62(0x194))var _0x47b438=[_0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x173)]],_0xacb1e3=[_0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x10a)]],_0x23aaee=[_0x22a2ce['body'][_0x118a62(0x118)]],_0x30813e=[_0x22a2ce[_0x118a62(0x18b)]['primary_code']],_0x4d7142=[_0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x11e)]],_0x278b45=[_0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x115)]],_0x5b23fa=[_0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x131)]],_0x130c16=[_0x22a2ce[_0x118a62(0x18b)]['expiry_date']];else var _0x47b438=[..._0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x173)]],_0xacb1e3=[..._0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x10a)]],_0x23aaee=[..._0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x118)]],_0x30813e=[..._0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x1f5)]],_0x4d7142=[..._0x22a2ce[_0x118a62(0x18b)]['secondary_code']],_0x278b45=[..._0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x115)]],_0x5b23fa=[..._0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x131)]],_0x130c16=[..._0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x12e)]];const _0x4b5723=_0x47b438[_0x118a62(0x11d)](_0x2b93ee=>{return _0x2b93ee={'product_name':_0x2b93ee};});_0xacb1e3[_0x118a62(0x123)]((_0x37cbe4,_0x1474a6)=>{var _0x59363f=_0x118a62;_0x4b5723[_0x1474a6][_0x59363f(0x10a)]=_0x37cbe4;}),_0x23aaee[_0x118a62(0x123)]((_0x23debf,_0x444418)=>{var _0x5ba8b7=_0x118a62;_0x4b5723[_0x444418][_0x5ba8b7(0x1e5)]=_0x23debf;}),_0x30813e[_0x118a62(0x123)]((_0x3b4706,_0x2f04fc)=>{var _0x2f4c66=_0x118a62;_0x4b5723[_0x2f04fc][_0x2f4c66(0x1f5)]=_0x3b4706;}),_0x4d7142[_0x118a62(0x123)]((_0x221ca8,_0x38fbac)=>{var _0x2babed=_0x118a62;_0x4b5723[_0x38fbac][_0x2babed(0x11e)]=_0x221ca8;}),_0x278b45[_0x118a62(0x123)]((_0x1f3d70,_0x257c8e)=>{var _0x2f35b4=_0x118a62;_0x4b5723[_0x257c8e][_0x2f35b4(0x18f)]=_0x1f3d70;}),_0x5b23fa['forEach']((_0x175836,_0x1ffaeb)=>{var _0x3786d7=_0x118a62;_0x4b5723[_0x1ffaeb][_0x3786d7(0x131)]=_0x175836;}),_0x130c16[_0x118a62(0x123)]((_0x56954b,_0x4f29ac)=>{_0x4b5723[_0x4f29ac]['expiry_date']=_0x56954b;});var _0x132e9c=0x0;_0x4b5723[_0x118a62(0x123)](_0x11618c=>{var _0xed037=_0x118a62;console[_0xed037(0x183)](_0xed037(0x145),_0x11618c),(parseInt(_0x11618c['stock'])<parseInt(_0x11618c[_0xed037(0x1e5)])||parseInt(_0x11618c['quantity'])==0x0)&&_0x132e9c++;});if(_0x132e9c!=0x0)return _0x22a2ce[_0x118a62(0x162)](_0x118a62(0x218),_0x118a62(0x169)),_0x21132b[_0x118a62(0x184)](_0x118a62(0x1a8));_0x3027f4[_0x118a62(0x108)][_0x118a62(0x123)](_0x46b3da=>{var _0xfde709=_0x118a62;const _0x230cfe=_0x1dfd16[_0xfde709(0x1eb)][_0xfde709(0x11d)](_0xc9cf83=>{var _0x30e2a1=_0xfde709;_0xc9cf83[_0x30e2a1(0x173)]==_0x46b3da[_0x30e2a1(0x173)]&&_0xc9cf83[_0x30e2a1(0x1a5)]==_0x46b3da[_0x30e2a1(0x1a5)]&&(_0xc9cf83[_0x30e2a1(0x10d)]=parseInt(_0xc9cf83[_0x30e2a1(0x10d)])+parseInt(_0x46b3da['quantity']));});}),await _0x1dfd16[_0x118a62(0x20f)]();const _0x286502=_0x4b5723[_0x118a62(0x101)](_0x570d77=>_0x570d77[_0x118a62(0x1e5)]!=='0'&&_0x570d77[_0x118a62(0x1e5)]!=='');_0x3027f4[_0x118a62(0x1ce)]=_0x51e518,_0x3027f4['customer']=_0x53787d,_0x3027f4['date']=_0x1f65e5,_0x3027f4[_0x118a62(0x190)]=_0x57ebe6,_0x3027f4['sale_product']=_0x286502,_0x3027f4[_0x118a62(0x18a)]=_0x57907a,_0x3027f4[_0x118a62(0x153)]=_0x25d447;const _0x418985=await _0x3027f4[_0x118a62(0x20f)](),_0x468423=await sales_finished[_0x118a62(0x178)]({'_id':_0x22a2ce[_0x118a62(0x1bc)]['id']}),_0x264177=await warehouse['findOne']({'name':_0x57ebe6,'room':_0x25d447,'warehouse_category':'Finished\x20Goods'});_0x468423['sale_product']['forEach'](_0x3e2c43=>{var _0x4335c6=_0x118a62;const _0x5cb326=_0x264177['product_details'][_0x4335c6(0x11d)](_0x5119c5=>{var _0x191031=_0x4335c6;_0x5119c5[_0x191031(0x173)]==_0x3e2c43[_0x191031(0x173)]&&_0x5119c5['bay']==_0x3e2c43[_0x191031(0x1a5)]&&(_0x5119c5[_0x191031(0x10d)]=parseInt(_0x5119c5[_0x191031(0x10d)])-parseInt(_0x3e2c43['quantity']));});}),console[_0x118a62(0x183)](_0x118a62(0x1da),_0x264177),await _0x264177[_0x118a62(0x20f)]();const _0x2eb860=await c_payment_data[_0x118a62(0x178)]({'invoice':_0x22a2ce[_0x118a62(0x18b)]['invoice']});_0x2eb860['suppliers']=_0x22a2ce[_0x118a62(0x18b)][_0x118a62(0x180)],await _0x2eb860['save'](),_0x22a2ce[_0x118a62(0x162)](_0x118a62(0x15b),_0x118a62(0x1d2)),_0x21132b[_0x118a62(0x184)](_0x118a62(0x1bf));}catch(_0x4599cb){console[_0x118a62(0x183)](_0x4599cb);}}),router[a0_0x3a7fee(0x125)]('/give_payment/:id',auth,async(_0x3cc1aa,_0x16ca20)=>{var _0x5a6ebe=a0_0x3a7fee;try{const _0x10c57e=_0x3cc1aa['params']['id'],{invoice:_0x5302c2,customer:_0xe796f,receivable_amount:_0x384654,received_amount:_0x312f83}=_0x3cc1aa[_0x5a6ebe(0x18b)],_0x12df8c=await sales[_0x5a6ebe(0x1fe)](_0x10c57e);console[_0x5a6ebe(0x183)](_0x12df8c);var _0x488ca7=_0x384654-_0x312f83;console[_0x5a6ebe(0x183)](_0x312f83),_0x12df8c[_0x5a6ebe(0x133)]=parseFloat(_0x312f83)+parseFloat(_0x12df8c[_0x5a6ebe(0x133)]),_0x12df8c['due_amount']=_0x488ca7,console['log'](_0x12df8c);const _0x50b36a=await _0x12df8c[_0x5a6ebe(0x20f)](),_0x2748c1=await c_payment_data[_0x5a6ebe(0x178)]({'invoice':_0x5302c2});_0x2748c1[_0x5a6ebe(0x15e)]=_0x488ca7,await _0x2748c1[_0x5a6ebe(0x20f)]();let _0x3e9950=new Date(),_0x24de78=('0'+_0x3e9950[_0x5a6ebe(0x156)]())[_0x5a6ebe(0x120)](-0x2),_0x150e50=('0'+(_0x3e9950[_0x5a6ebe(0x1e9)]()+0x1))[_0x5a6ebe(0x120)](-0x2),_0x5a5855=_0x3e9950[_0x5a6ebe(0x18e)](),_0x5a2a66=_0x5a5855+'-'+_0x150e50+'-'+_0x24de78;const _0x6bbad2=new customer_payment({'invoice':_0x5302c2,'date':_0x5a5855+'-'+_0x150e50+'-'+_0x24de78,'customer':_0xe796f,'reason':_0x5a6ebe(0x13d),'amount':_0x312f83}),_0x4fe0c2=await _0x6bbad2[_0x5a6ebe(0x20f)]();_0x3cc1aa['flash'](_0x5a6ebe(0x15b),_0x5a6ebe(0x137)),_0x16ca20[_0x5a6ebe(0x184)](_0x5a6ebe(0x1de));}catch(_0x5e6795){console[_0x5a6ebe(0x183)](_0x5e6795);}}),router[a0_0x3a7fee(0x15a)](a0_0x3a7fee(0x150),auth,async(_0x4be847,_0x3b1ca0)=>{var _0x12c3cf=a0_0x3a7fee;try{const {username:_0x273599,email:_0x339979,role:_0x38c360}=_0x4be847[_0x12c3cf(0x1b2)],_0x865706=_0x4be847[_0x12c3cf(0x1b2)],_0x581d93=await profile[_0x12c3cf(0x178)]({'email':_0x865706['email']}),_0xd452c2=await master_shop[_0x12c3cf(0x200)]();console['log']('master',_0xd452c2);const _0x7cb2c2=_0x4be847[_0x12c3cf(0x1bc)]['id'],_0x1bf9ae=await sales['findById'](_0x7cb2c2);console[_0x12c3cf(0x183)](_0x1bf9ae);const _0x522681=await customer[_0x12c3cf(0x178)]({'name':_0x1bf9ae[_0x12c3cf(0x12a)]});console[_0x12c3cf(0x183)](_0x522681);if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]==_0x12c3cf(0x139)){var _0xb7023e=users[_0x12c3cf(0x163)];console['log'](_0xb7023e);}else{if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]==_0x12c3cf(0x16b))var _0xb7023e=users['Hindi'];else{if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]==_0x12c3cf(0x17e))var _0xb7023e=users[_0x12c3cf(0x17e)];else{if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]==_0x12c3cf(0x129))var _0xb7023e=users[_0x12c3cf(0x129)];else{if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]==_0x12c3cf(0x146))var _0xb7023e=users[_0x12c3cf(0x146)];else{if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]==_0x12c3cf(0x216))var _0xb7023e=users['Portuguese'];else{if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]==_0x12c3cf(0x126))var _0xb7023e=users['Chinese'];else{if(_0xd452c2[0x0][_0x12c3cf(0x1ec)]=='Arabic\x20(ae)')var _0xb7023e=users[_0x12c3cf(0x1ea)];}}}}}}}_0x3b1ca0[_0x12c3cf(0x165)](_0x12c3cf(0x157),{'success':_0x4be847[_0x12c3cf(0x162)](_0x12c3cf(0x15b)),'errors':_0x4be847[_0x12c3cf(0x162)](_0x12c3cf(0x218)),'role':_0x865706,'profile':_0x581d93,'master_shop':_0xd452c2,'customers':_0x522681,'sales':_0x1bf9ae,'language':_0xb7023e});}catch(_0x29b84f){console[_0x12c3cf(0x183)](_0x29b84f);}}),router[a0_0x3a7fee(0x15a)](a0_0x3a7fee(0x11c),auth,async(_0x195a57,_0x510b94)=>{var _0x5b12c9=a0_0x3a7fee;try{const {username:_0x36271f,email:_0x271dfc,role:_0x376f8c}=_0x195a57[_0x5b12c9(0x1b2)],_0x4a5f1d=_0x195a57[_0x5b12c9(0x1b2)],_0x2a2675=await profile[_0x5b12c9(0x178)]({'email':_0x4a5f1d[_0x5b12c9(0x19c)]}),_0xa50ec8=await master_shop[_0x5b12c9(0x200)](),_0x179c48=_0x195a57[_0x5b12c9(0x1bc)]['id'],_0x4ae2f1=await sales_finished[_0x5b12c9(0x1fe)](_0x179c48),_0x16f9a3=await warehouse[_0x5b12c9(0x142)]([{'$match':{'name':_0x4ae2f1[_0x5b12c9(0x190)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5b12c9(0x1dc)},'product_stock':{'$first':_0x5b12c9(0x160)},'bay':{'$first':_0x5b12c9(0xfd)},'bin':{'$first':_0x5b12c9(0x206)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5b12c9(0x1d7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x5b12c9(0x1a3)},'product_code':{'$first':_0x5b12c9(0x110)},'storage':{'$first':_0x5b12c9(0x151)},'rack':{'$first':_0x5b12c9(0x1c4)},'expiry_date':{'$first':_0x5b12c9(0x11b)},'production_date':{'$first':_0x5b12c9(0x199)},'unit':{'$first':_0x5b12c9(0x201)},'secondary_unit':{'$first':_0x5b12c9(0x12b)},'maxProducts':{'$first':_0x5b12c9(0x16d)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'}}}]),_0x43c603=await product[_0x5b12c9(0x200)]({}),_0x2d6bd6=await warehouse[_0x5b12c9(0x142)]([{'$match':{'status':_0x5b12c9(0x20c),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x5b12c9(0x16f),'$ne':_0x5b12c9(0x14f)}}},{'$group':{'_id':_0x5b12c9(0x117),'name':{'$first':_0x5b12c9(0x117)}}},{'$sort':{'name':0x1}}]);var _0x2bbae0=[_0x5b12c9(0x1fa)];const _0xc141b2=await warehouse[_0x5b12c9(0x142)]([{'$match':{'status':_0x5b12c9(0x20c),'name':'Quality\x20Inspection'}},{'$group':{'_id':_0x5b12c9(0x117),'name':{'$first':_0x5b12c9(0x117)}}},{'$sort':{'name':0x1}}]);if(_0xa50ec8[0x0][_0x5b12c9(0x1ec)]=='English\x20(US)'){var _0x21b005=users[_0x5b12c9(0x163)];console[_0x5b12c9(0x183)](_0x21b005);}else{if(_0xa50ec8[0x0]['language']==_0x5b12c9(0x16b))var _0x21b005=users[_0x5b12c9(0x16b)];else{if(_0xa50ec8[0x0][_0x5b12c9(0x1ec)]=='German')var _0x21b005=users[_0x5b12c9(0x17e)];else{if(_0xa50ec8[0x0][_0x5b12c9(0x1ec)]==_0x5b12c9(0x129))var _0x21b005=users[_0x5b12c9(0x129)];else{if(_0xa50ec8[0x0]['language']==_0x5b12c9(0x146))var _0x21b005=users[_0x5b12c9(0x146)];else{if(_0xa50ec8[0x0][_0x5b12c9(0x1ec)]==_0x5b12c9(0x216))var _0x21b005=users['Portuguese'];else{if(_0xa50ec8[0x0][_0x5b12c9(0x1ec)]==_0x5b12c9(0x126))var _0x21b005=users[_0x5b12c9(0x126)];else{if(_0xa50ec8[0x0]['language']=='Arabic\x20(ae)')var _0x21b005=users['Arabic'];}}}}}}}_0x510b94[_0x5b12c9(0x165)](_0x5b12c9(0x20e),{'success':_0x195a57[_0x5b12c9(0x162)](_0x5b12c9(0x15b)),'errors':_0x195a57[_0x5b12c9(0x162)](_0x5b12c9(0x218)),'role':_0x4a5f1d,'profile':_0x2a2675,'user':_0x4ae2f1,'stock':_0x16f9a3,'master_shop':_0xa50ec8,'unit':_0x43c603,'language':_0x21b005,'warehouses':_0x2d6bd6,'rooms':_0x2bbae0,'warehouse_QA':_0xc141b2});}catch(_0x4ffc1c){console[_0x5b12c9(0x183)](_0x4ffc1c),_0x510b94[_0x5b12c9(0x172)](0xc8)[_0x5b12c9(0x154)]({'message':_0x4ffc1c['message']});}}),router[a0_0x3a7fee(0x125)](a0_0x3a7fee(0x11c),auth,async(_0x1bd5cf,_0x523e5c)=>{var _0x14455b=a0_0x3a7fee;if(_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x14d)]=='QA')try{const {invoice:_0x17539b,date:_0x15819d,warehouse_name:_0x3a2385,product_name:_0xcbd7ba,primary_code:_0x2e185d,secondary_code:_0x3c1d09,product_code:_0x4018a8,sales_quantity:_0x2bb36f,stocks:_0x3b6fcb,return_qty:_0x3ab10a,Room_name:_0xc27180,to_warehouse_name_QA:_0x3df126,to_Room_name_QA:_0x4d5d81,note:_0xfe759d,for_categorize:_0x109ffa,product_name_QA1:_0xea1821}=_0x1bd5cf['body'];if(typeof _0xea1821==_0x14455b(0x194))var _0x1723ba=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x113)]],_0x30fef6=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x167)]],_0x654b5a=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x103)]],_0x5eace1=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1be)]],_0x236342=[_0x1bd5cf['body'][_0x14455b(0x1dd)]],_0x4eaad2=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x195)]],_0x464145=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1f8)]],_0xfbdcb6=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x148)]],_0x5a8a14=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x182)]],_0x263765=[_0x1bd5cf['body']['batch_code_QA']],_0x33c531=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1b4)]],_0xd87153=[_0x1bd5cf[_0x14455b(0x18b)]['unit_QA']],_0x2f06b3=[_0x1bd5cf['body'][_0x14455b(0x197)]],_0x31f003=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1df)]];else var _0x1723ba=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x113)]],_0x30fef6=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x167)]],_0x654b5a=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x103)]],_0x5eace1=[..._0x1bd5cf['body']['product_code_QA']],_0x236342=[..._0x1bd5cf['body']['sales_quantity_QA']],_0x4eaad2=[..._0x1bd5cf[_0x14455b(0x18b)]['stocks_QA']],_0x464145=[..._0x1bd5cf[_0x14455b(0x18b)]['return_qty_QA']],_0xfbdcb6=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x148)]],_0x5a8a14=[..._0x1bd5cf[_0x14455b(0x18b)]['maxProducts_QA']],_0x263765=[..._0x1bd5cf['body'][_0x14455b(0x13f)]],_0x33c531=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1b4)]],_0xd87153=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x127)]],_0x2f06b3=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x197)]],_0x31f003=[..._0x1bd5cf[_0x14455b(0x18b)]['expiry_date_QA']];const _0x269a4c=_0x1723ba[_0x14455b(0x11d)](_0x50581a=>{return _0x50581a={'product_name':_0x50581a};});_0x30fef6[_0x14455b(0x123)]((_0x2b258d,_0x60fa2d)=>{_0x269a4c[_0x60fa2d]['primary_code']=_0x2b258d;}),_0x654b5a[_0x14455b(0x123)]((_0x5873c6,_0x45cdc2)=>{var _0x1dbf1e=_0x14455b;_0x269a4c[_0x45cdc2][_0x1dbf1e(0x11e)]=_0x5873c6;}),_0x5eace1[_0x14455b(0x123)]((_0x4c4639,_0x5f72ed)=>{var _0x10521f=_0x14455b;_0x269a4c[_0x5f72ed][_0x10521f(0x18f)]=_0x4c4639;}),_0x236342[_0x14455b(0x123)]((_0x35876f,_0x470c2b)=>{var _0x53ffd9=_0x14455b;_0x269a4c[_0x470c2b][_0x53ffd9(0x213)]=_0x35876f;}),_0x4eaad2['forEach']((_0x2b52de,_0x5ec17d)=>{var _0x208da3=_0x14455b;_0x269a4c[_0x5ec17d][_0x208da3(0x10a)]=_0x2b52de;}),_0x464145[_0x14455b(0x123)]((_0x2cd806,_0x14808c)=>{var _0x2e9d17=_0x14455b;_0x269a4c[_0x14808c][_0x2e9d17(0x219)]=_0x2cd806;}),_0xfbdcb6['forEach']((_0x44dd19,_0x3d4669)=>{var _0x31b615=_0x14455b;_0x269a4c[_0x3d4669][_0x31b615(0x17d)]=_0x44dd19;}),_0x5a8a14['forEach']((_0x887831,_0x5bb461)=>{_0x269a4c[_0x5bb461]['maxProducts']=_0x887831;}),_0x263765[_0x14455b(0x123)]((_0x307a8b,_0xefa83)=>{var _0xa278eb=_0x14455b;_0x269a4c[_0xefa83][_0xa278eb(0x102)]=_0x307a8b;}),_0x33c531[_0x14455b(0x123)]((_0x425cb1,_0x3fce28)=>{var _0x37f083=_0x14455b;_0x269a4c[_0x3fce28][_0x37f083(0x1c7)]=_0x425cb1;}),_0xd87153[_0x14455b(0x123)]((_0x2d2dbe,_0x10b62e)=>{_0x269a4c[_0x10b62e]['unit']=_0x2d2dbe;}),_0x2f06b3[_0x14455b(0x123)]((_0x4dda06,_0x26212c)=>{var _0x92fad=_0x14455b;_0x269a4c[_0x26212c][_0x92fad(0x147)]=_0x4dda06;}),_0x31f003[_0x14455b(0x123)]((_0xa4dddc,_0x2ae92e)=>{var _0x4f76c0=_0x14455b;_0x269a4c[_0x2ae92e][_0x4f76c0(0x12e)]=_0xa4dddc;});const _0xfb43a5=await sales_finished['findOne']({'invoice':_0x17539b});_0xfb43a5[_0x14455b(0xff)]=_0x14455b(0x1d9);const _0x38f1c7=await _0xfb43a5[_0x14455b(0x20f)](),_0x1e53b7=new sales_return_finished({'invoice':_0x17539b,'customer':_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x12a)],'date':_0x15819d,'warehouse_name':_0x3a2385,'room':_0xc27180,'ToWarehouse':_0x3df126,'ToRoom':_0x4d5d81,'return_sale_QA':_0x269a4c,'note':_0xfe759d,'warehouse_cat':_0x109ffa}),_0x3080c5=await _0x1e53b7[_0x14455b(0x20f)](),_0xabc20=await sales_return_finished[_0x14455b(0x178)]({'invoice':_0x17539b}),_0x331fcb=await warehouse[_0x14455b(0x178)]({'name':_0x3df126,'room':_0x4d5d81});_0xabc20[_0x14455b(0x1e0)][_0x14455b(0x123)](_0x29837c=>{var _0x4bc3fa=_0x14455b,_0x185c44=0x0;const _0x28dcf3=_0x331fcb['product_details'][_0x4bc3fa(0x11d)](_0x1e3eac=>{var _0x2c824d=_0x4bc3fa;_0x1e3eac[_0x2c824d(0x173)]==_0x29837c[_0x2c824d(0x173)]&&_0x1e3eac[_0x2c824d(0x12e)]==_0x29837c[_0x2c824d(0x12e)]&&_0x1e3eac['production_date']==_0x29837c['production_date']&&_0x1e3eac['batch_code']==_0x29837c[_0x2c824d(0x102)]&&(_0x1e3eac['product_stock']=parseInt(_0x1e3eac['product_stock'])+parseInt(_0x29837c['return_qty']),_0x185c44++);});_0x185c44=='0'&&(_0x331fcb['product_details']=_0x331fcb[_0x4bc3fa(0x1eb)][_0x4bc3fa(0x196)]({'product_name':_0x29837c[_0x4bc3fa(0x173)],'product_stock':_0x29837c['return_qty'],'primary_code':_0x29837c[_0x4bc3fa(0x1f5)],'secondary_code':_0x29837c[_0x4bc3fa(0x11e)],'product_code':_0x29837c[_0x4bc3fa(0x18f)],'batch_code':_0x29837c['batch_code'],'maxPerUnit':_0x29837c[_0x4bc3fa(0x17d)],'production_date':_0x29837c['production_date'],'expiry_date':_0x29837c[_0x4bc3fa(0x12e)],'secondary_unit':_0x29837c['secondary_unit'],'unit':_0x29837c[_0x4bc3fa(0x1e8)],'maxProducts':_0x29837c['maxProducts'],'bay':_0x29837c['bay']}));}),await _0x331fcb['save']();const _0x3fbc88=new c_payment_data({'invoice':_0x17539b,'customer':_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x12a)],'reason':_0x14455b(0x1b0)});await _0x3fbc88[_0x14455b(0x20f)]();const _0x4e65c0=await master_shop[_0x14455b(0x200)](),_0x1d8834=await email_settings['findOne'](),_0x9ef2e3=await customer['findOne']({'name':_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x12a)]});_0x4e65c0[0x0][_0x14455b(0x134)]==0x1?(right_currency=_0x4e65c0[0x0][_0x14455b(0x1ad)],left_currency=''):(right_currency='',left_currency=_0x4e65c0[0x0]['currency']);var _0x20f444=_0x1723ba,_0x63f5b7=_0x464145,_0x50b3f6='',_0x390d2e;for(_0x390d2e in _0x20f444){_0x50b3f6+=_0x14455b(0x1fd)+_0x14455b(0x106)+_0x20f444[_0x390d2e]+_0x14455b(0x128)+_0x14455b(0x106)+_0x63f5b7[_0x390d2e]+_0x14455b(0x128)+_0x14455b(0x207);}console[_0x14455b(0x183)]('product_list',_0x50b3f6);let _0x21d122=nodemailer[_0x14455b(0x155)]({'service':_0x14455b(0x203),'auth':{'user':_0x1d8834[_0x14455b(0x19c)],'pass':_0x1d8834[_0x14455b(0x198)]}}),_0x3ed7c2={'from':_0x1d8834[_0x14455b(0x19c)],'to':_0x9ef2e3[_0x14455b(0x19c)],'subject':_0x14455b(0x14e),'attachments':[{'filename':_0x14455b(0x18c),'path':__dirname+_0x14455b(0x1f3)+_0x14455b(0x11f)+_0x4e65c0[0x0][_0x14455b(0xfe)],'cid':_0x14455b(0x1e3)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+'</head><body>'+_0x14455b(0x19d)+_0x14455b(0x1ee)+_0x14455b(0x19d)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x14455b(0x1f2)+'<div>'+_0x14455b(0x1b3)+_0x4e65c0[0x0]['site_title']+_0x14455b(0x1b8)+'</div>'+_0x14455b(0x1f2)+'<hr\x20class=\x22my-3\x22>'+_0x14455b(0x19d)+_0x14455b(0x20d)+_0x14455b(0x1e1)+_0x17539b+'\x20'+_0x14455b(0x204)+_0x14455b(0x13b)+_0x15819d+'\x20'+_0x14455b(0x1f9)+_0x14455b(0x1ae)+_0x14455b(0x1f2)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x14455b(0x136)+_0x14455b(0x1fd)+_0x14455b(0x138)+_0x14455b(0x1c6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>'+_0x14455b(0x159)+_0x14455b(0x207)+_0x14455b(0x1a7)+_0x14455b(0x10b)+'\x20'+_0x50b3f6+'\x20'+_0x14455b(0x132)+_0x14455b(0x1a9)+'<div>'+_0x14455b(0x1b1)+_0x14455b(0x174)+_0x4e65c0[0x0][_0x14455b(0x217)]+_0x14455b(0x1ae)+_0x14455b(0x1f2)+'</div>'+_0x14455b(0x17a)};_0x21d122['sendMail'](_0x3ed7c2,function(_0x56f1dc,_0x54289a){var _0x4b035=_0x14455b;_0x56f1dc?(console[_0x4b035(0x183)](_0x56f1dc),console['log']('Error\x20Occurs')):console[_0x4b035(0x183)](_0x4b035(0x19a));}),_0x1bd5cf['flash'](_0x14455b(0x15b),_0x14455b(0x1fb)),_0x523e5c[_0x14455b(0x184)](_0x14455b(0x1bf));}catch(_0x4df7a6){_0x523e5c[_0x14455b(0x172)](0xc8)['json']({'message1':_0x4df7a6[_0x14455b(0x185)]});}else{if(_0x1bd5cf[_0x14455b(0x18b)]['for_categorize']=='GS')try{const {invoice:_0x3f048c,date:_0x27d39f,warehouse_name:_0x2452af,product_name:_0x2aba75,primary_code:_0x4ad1a5,secondary_code:_0x5bd020,product_code:_0x3882cc,sales_quantity:_0x4e0caf,stocks:_0x3b6d47,return_qty:_0x3c9c01,Room_name:_0x425846,to_warehouse_name:_0x41b5b6,to_Room_name:_0x1410f0,note:_0x16231d,level:_0x3a0a17,isle:_0x201eb3,pallet:_0x47e8c9,for_categorize:_0x369795}=_0x1bd5cf['body'];if(typeof _0x2aba75==_0x14455b(0x194))var _0x1723ba=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x173)]],_0x30fef6=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1f5)]],_0x654b5a=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x11e)]],_0x5eace1=[_0x1bd5cf['body'][_0x14455b(0x18f)]],_0x236342=[_0x1bd5cf[_0x14455b(0x18b)]['sales_quantity']],_0x464145=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x219)]],_0x41db2a=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1a5)]],_0xfbdcb6=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x17d)]],_0x5a8a14=[_0x1bd5cf['body'][_0x14455b(0x1e6)]],_0x263765=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x102)]],_0x33c531=[_0x1bd5cf['body'][_0x14455b(0x1c7)]],_0xd87153=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1e8)]],_0x2f06b3=[_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x147)]],_0x31f003=[_0x1bd5cf['body'][_0x14455b(0x12e)]];else var _0x1723ba=[..._0x1bd5cf[_0x14455b(0x18b)]['product_name']],_0x30fef6=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1f5)]],_0x654b5a=[..._0x1bd5cf[_0x14455b(0x18b)]['secondary_code']],_0x5eace1=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x18f)]],_0x236342=[..._0x1bd5cf['body'][_0x14455b(0x1c8)]],_0x464145=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x219)]],_0x41db2a=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1a5)]],_0xfbdcb6=[..._0x1bd5cf['body'][_0x14455b(0x17d)]],_0x5a8a14=[..._0x1bd5cf[_0x14455b(0x18b)]['maxProducts']],_0x263765=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x102)]],_0x33c531=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1c7)]],_0xd87153=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x1e8)]],_0x2f06b3=[..._0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x147)]],_0x31f003=[..._0x1bd5cf['body'][_0x14455b(0x12e)]];const _0x515392=_0x1723ba['map'](_0x1bdcb0=>{return _0x1bdcb0={'product_name':_0x1bdcb0};});_0x30fef6[_0x14455b(0x123)]((_0x5c6732,_0x4331ea)=>{_0x515392[_0x4331ea]['primary_code']=_0x5c6732;}),_0x654b5a[_0x14455b(0x123)]((_0x23cafb,_0x1bd810)=>{var _0x1a1e80=_0x14455b;_0x515392[_0x1bd810][_0x1a1e80(0x11e)]=_0x23cafb;}),_0x5eace1[_0x14455b(0x123)]((_0x31c462,_0x238791)=>{_0x515392[_0x238791]['product_code']=_0x31c462;}),_0x236342[_0x14455b(0x123)]((_0x6fb01a,_0x427fef)=>{var _0xce5f4a=_0x14455b;_0x515392[_0x427fef][_0xce5f4a(0x213)]=_0x6fb01a;}),_0x464145[_0x14455b(0x123)]((_0x4be713,_0x5a6b8b)=>{_0x515392[_0x5a6b8b]['return_qty']=_0x4be713;}),_0x41db2a[_0x14455b(0x123)]((_0x10ab88,_0x2ae958)=>{_0x515392[_0x2ae958]['bay']=_0x10ab88;}),_0xfbdcb6[_0x14455b(0x123)]((_0x469954,_0x13e293)=>{var _0x2c9ef8=_0x14455b;_0x515392[_0x13e293][_0x2c9ef8(0x17d)]=_0x469954;}),_0x5a8a14[_0x14455b(0x123)]((_0x2ff1bc,_0x369487)=>{_0x515392[_0x369487]['maxProducts']=_0x2ff1bc;}),_0x263765['forEach']((_0x24b1fd,_0x1dd6d9)=>{_0x515392[_0x1dd6d9]['batch_code']=_0x24b1fd;}),_0x33c531['forEach']((_0x52614c,_0x585831)=>{var _0xbd9996=_0x14455b;_0x515392[_0x585831][_0xbd9996(0x1c7)]=_0x52614c;}),_0xd87153[_0x14455b(0x123)]((_0x12f253,_0x295e64)=>{_0x515392[_0x295e64]['unit']=_0x12f253;}),_0x2f06b3[_0x14455b(0x123)]((_0x2f51e9,_0x2215b9)=>{var _0x1df10f=_0x14455b;_0x515392[_0x2215b9][_0x1df10f(0x147)]=_0x2f51e9;}),_0x31f003[_0x14455b(0x123)]((_0xf499dc,_0x2428ed)=>{var _0x3442ec=_0x14455b;_0x515392[_0x2428ed][_0x3442ec(0x12e)]=_0xf499dc;});var _0x3c2ebd=0x0;_0x515392[_0x14455b(0x123)](_0x2cb789=>{var _0x598ad4=_0x14455b;(parseInt(_0x2cb789['sale_qty'])<parseInt(_0x2cb789[_0x598ad4(0x219)])||parseInt(_0x2cb789['stock'])<parseInt(_0x2cb789[_0x598ad4(0x219)])&&parseInt(_0x2cb789[_0x598ad4(0x213)])>parseInt(_0x2cb789[_0x598ad4(0x219)])||parseInt(_0x2cb789['return_qty'])==0x0)&&_0x3c2ebd++;});if(_0x3c2ebd!=0x0)return _0x1bd5cf[_0x14455b(0x162)](_0x14455b(0x218),_0x14455b(0x1b9)),_0x523e5c[_0x14455b(0x184)](_0x14455b(0x1a8));const _0xbac047=await sales_finished[_0x14455b(0x178)]({'invoice':_0x3f048c});_0xbac047[_0x14455b(0xff)]=_0x14455b(0x1d9);const _0x46ea45=await _0xbac047[_0x14455b(0x20f)](),_0x491a40=new sales_return_finished({'invoice':_0x3f048c,'customer':_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x12a)],'date':_0x27d39f,'warehouse_name':_0x2452af,'room':_0x425846,'ToWarehouse':_0x41b5b6,'ToRoom':_0x1410f0,'return_sale':_0x515392,'note':_0x16231d,'warehouse_cat':_0x369795}),_0x2e4d0b=await _0x491a40[_0x14455b(0x20f)](),_0x3f0e28=await sales_return_finished['findOne']({'invoice':_0x3f048c}),_0x2298ee=await warehouse[_0x14455b(0x178)]({'name':_0x41b5b6,'room':_0x1410f0,'warehouse_category':'Finished\x20Goods'});_0x3f0e28[_0x14455b(0xf9)][_0x14455b(0x123)](_0x443ca7=>{var _0x21119a=_0x14455b,_0x37632c=0x0;const _0x546455=_0x2298ee[_0x21119a(0x1eb)][_0x21119a(0x11d)](_0x5988a7=>{var _0x197acb=_0x21119a;_0x5988a7['product_name']==_0x443ca7[_0x197acb(0x173)]&&_0x5988a7['bay']==_0x443ca7[_0x197acb(0x1a5)]&&_0x5988a7[_0x197acb(0x12e)]==_0x443ca7['expiry_date']&&_0x5988a7[_0x197acb(0x147)]==_0x443ca7[_0x197acb(0x147)]&&_0x5988a7['batch_code']==_0x443ca7[_0x197acb(0x102)]&&(_0x5988a7[_0x197acb(0x10d)]=parseInt(_0x5988a7[_0x197acb(0x10d)])+parseInt(_0x443ca7['return_qty']),_0x37632c++);});_0x37632c=='0'&&(_0x2298ee[_0x21119a(0x1eb)]=_0x2298ee[_0x21119a(0x1eb)][_0x21119a(0x196)]({'product_name':_0x443ca7[_0x21119a(0x173)],'product_stock':_0x443ca7[_0x21119a(0x219)],'primary_code':_0x443ca7['primary_code'],'secondary_code':_0x443ca7[_0x21119a(0x11e)],'product_code':_0x443ca7[_0x21119a(0x18f)],'bay':_0x443ca7[_0x21119a(0x1a5)],'batch_code':_0x443ca7[_0x21119a(0x102)],'maxPerUnit':_0x443ca7[_0x21119a(0x17d)],'production_date':_0x443ca7['production_date'],'expiry_date':_0x443ca7[_0x21119a(0x12e)],'secondary_unit':_0x443ca7[_0x21119a(0x1c7)],'unit':_0x443ca7[_0x21119a(0x1e8)],'maxProducts':_0x443ca7[_0x21119a(0x1e6)]}));}),await _0x2298ee[_0x14455b(0x20f)](),console[_0x14455b(0x183)](_0x1bd5cf[_0x14455b(0x18b)]);const _0x36e805=new c_payment_data({'invoice':_0x3f048c,'customer':_0x1bd5cf[_0x14455b(0x18b)]['customer'],'reason':_0x14455b(0x1b0)});await _0x36e805['save']();const _0x39b0f8=await master_shop['find']();console['log'](_0x14455b(0x1f4),_0x39b0f8[0x0][_0x14455b(0xfe)]);const _0x5267c6=await email_settings[_0x14455b(0x178)](),_0x1cb891=await customer[_0x14455b(0x178)]({'name':_0x1bd5cf[_0x14455b(0x18b)][_0x14455b(0x12a)]});console['log'](_0x14455b(0x19b),_0x1cb891);_0x39b0f8[0x0][_0x14455b(0x134)]==0x1?(right_currency=_0x39b0f8[0x0][_0x14455b(0x1ad)],left_currency=''):(right_currency='',left_currency=_0x39b0f8[0x0][_0x14455b(0x1ad)]);var _0x20f444=_0x1723ba,_0x63f5b7=_0x464145,_0x50b3f6='',_0x390d2e;for(_0x390d2e in _0x20f444){_0x50b3f6+=_0x14455b(0x1fd)+_0x14455b(0x106)+_0x20f444[_0x390d2e]+_0x14455b(0x128)+_0x14455b(0x106)+_0x63f5b7[_0x390d2e]+_0x14455b(0x128)+_0x14455b(0x207);}console[_0x14455b(0x183)]('product_list',_0x50b3f6);let _0x4b87b4=nodemailer[_0x14455b(0x155)]({'service':'gmail','auth':{'user':_0x5267c6[_0x14455b(0x19c)],'pass':_0x5267c6[_0x14455b(0x198)]}}),_0x4b3a4f={'from':_0x5267c6[_0x14455b(0x19c)],'to':_0x1cb891[_0x14455b(0x19c)],'subject':'Sale\x20Return\x20Mail','attachments':[{'filename':_0x14455b(0x18c),'path':__dirname+_0x14455b(0x1f3)+'/upload/'+_0x39b0f8[0x0][_0x14455b(0xfe)],'cid':'logo'}],'html':_0x14455b(0x1d3)+'<html><head><title></title>'+_0x14455b(0x1bb)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x14455b(0x19d)+_0x14455b(0x188)+'</div>'+_0x14455b(0x19d)+_0x14455b(0x1b3)+_0x39b0f8[0x0][_0x14455b(0x217)]+_0x14455b(0x1b8)+_0x14455b(0x1f2)+_0x14455b(0x1f2)+'<hr\x20class=\x22my-3\x22>'+_0x14455b(0x19d)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x14455b(0x1e1)+_0x3f048c+'\x20'+_0x14455b(0x204)+_0x14455b(0x13b)+_0x27d39f+'\x20'+'</span>'+_0x14455b(0x1ae)+_0x14455b(0x1f2)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x14455b(0x136)+_0x14455b(0x1fd)+_0x14455b(0x138)+_0x14455b(0x1c6)+_0x14455b(0x14a)+_0x14455b(0x159)+'</tr>'+_0x14455b(0x1a7)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x50b3f6+'\x20'+_0x14455b(0x132)+_0x14455b(0x1a9)+'<div>'+_0x14455b(0x1b1)+'<h5>'+_0x39b0f8[0x0][_0x14455b(0x217)]+_0x14455b(0x1ae)+'</div>'+'</div>'+'</body></html>'};_0x4b87b4[_0x14455b(0x170)](_0x4b3a4f,function(_0x24cdfe,_0x9a6123){var _0x27a190=_0x14455b;_0x24cdfe?(console[_0x27a190(0x183)](_0x24cdfe),console[_0x27a190(0x183)](_0x27a190(0x19e))):console[_0x27a190(0x183)](_0x27a190(0x19a));}),_0x1bd5cf[_0x14455b(0x162)](_0x14455b(0x15b),'sales\x20item\x20return\x20successfull'),_0x523e5c[_0x14455b(0x184)](_0x14455b(0x1bf));}catch(_0x316045){console[_0x14455b(0x183)](_0x316045),_0x523e5c[_0x14455b(0x172)](0xc8)['json']({'message1':_0x316045[_0x14455b(0x185)]});}}}),router[a0_0x3a7fee(0x15a)]('/barcode/:id',auth,async(_0x48ca00,_0x120f79)=>{var _0xafc94a=a0_0x3a7fee;try{const {username:_0x55202b,email:_0x154cbe,role:_0x4f0d00}=_0x48ca00[_0xafc94a(0x1b2)],_0x31b1fc=_0x48ca00[_0xafc94a(0x1b2)],_0xef9d12=await profile[_0xafc94a(0x178)]({'email':_0x31b1fc['email']}),_0x18314e=await master_shop['find']();console[_0xafc94a(0x183)](_0xafc94a(0x1bd),_0x18314e);const _0x5dcc66=_0x48ca00[_0xafc94a(0x1bc)]['id'],_0x161e95=await sales['findById'](_0x5dcc66);console[_0xafc94a(0x183)](_0xafc94a(0x209),_0x161e95);if(_0x18314e[0x0][_0xafc94a(0x1ec)]==_0xafc94a(0x139))var _0xfc5cc6=users[_0xafc94a(0x163)];else{if(_0x18314e[0x0]['language']==_0xafc94a(0x16b))var _0xfc5cc6=users[_0xafc94a(0x16b)];else{if(_0x18314e[0x0][_0xafc94a(0x1ec)]=='German')var _0xfc5cc6=users[_0xafc94a(0x17e)];else{if(_0x18314e[0x0][_0xafc94a(0x1ec)]=='Spanish')var _0xfc5cc6=users[_0xafc94a(0x129)];else{if(_0x18314e[0x0]['language']==_0xafc94a(0x146))var _0xfc5cc6=users['French'];else{if(_0x18314e[0x0][_0xafc94a(0x1ec)]==_0xafc94a(0x216))var _0xfc5cc6=users[_0xafc94a(0x1f7)];else{if(_0x18314e[0x0]['language']=='Chinese')var _0xfc5cc6=users['Chinese'];else{if(_0x18314e[0x0][_0xafc94a(0x1ec)]==_0xafc94a(0x149))var _0xfc5cc6=users[_0xafc94a(0x1ea)];}}}}}}}_0x120f79[_0xafc94a(0x165)](_0xafc94a(0x14c),{'success':_0x48ca00[_0xafc94a(0x162)](_0xafc94a(0x15b)),'errors':_0x48ca00[_0xafc94a(0x162)](_0xafc94a(0x218)),'role':_0x31b1fc,'profile':_0xef9d12,'alldata':_0x161e95,'master_shop':_0x18314e,'language':_0xfc5cc6});}catch(_0x29e1d5){console['log'](_0x29e1d5);}}),router[a0_0x3a7fee(0x125)](a0_0x3a7fee(0x116),async(_0x34bbd1,_0x4d25d5)=>{var _0x359abf=a0_0x3a7fee;const {product_code:_0x4978cd,warehouse_name:_0x3c251a,rooms_data:_0x167227,Roomslist:_0x757333}=_0x34bbd1[_0x359abf(0x18b)],_0x5bd7a6=_0x757333[_0x359abf(0x1aa)](','),_0x2e0831=[];async function _0x297339(_0x1c03f4){var _0x4b887a=_0x359abf;const _0x98ad37=await warehouse['aggregate']([{'$match':{'name':_0x3c251a,'room':_0x1c03f4}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4978cd}},{'$group':{'_id':_0x4b887a(0x135),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4b887a(0x1a3)},'product_code':{'$first':_0x4b887a(0x110)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x4b887a(0x206)},'type':{'$first':_0x4b887a(0x181)},'pallet':{'$first':_0x4b887a(0x1d7)},'unit':{'$first':_0x4b887a(0x201)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4b887a(0x1c4)},'expiry_date':{'$first':_0x4b887a(0x11b)},'production_date':{'$first':_0x4b887a(0x199)},'maxPerUnit':{'$first':_0x4b887a(0x13e)},'batch_code':{'$first':_0x4b887a(0x109)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'},'invoice':{'$first':_0x4b887a(0x208)}}}]),_0x135783=await warehouse['aggregate']([{'$match':{'name':_0x3c251a,'room':_0x1c03f4}},{'$unwind':_0x4b887a(0x17c)},{'$match':{'product_details.secondary_code':_0x4978cd}},{'$group':{'_id':_0x4b887a(0x135),'name':{'$first':_0x4b887a(0x1dc)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4b887a(0x1a3)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4b887a(0xfd)},'isle':{'$first':_0x4b887a(0x206)},'type':{'$first':_0x4b887a(0x181)},'pallet':{'$first':_0x4b887a(0x1d7)},'unit':{'$first':_0x4b887a(0x201)},'secondary_unit':{'$first':_0x4b887a(0x12b)},'storage':{'$first':_0x4b887a(0x151)},'rack':{'$first':_0x4b887a(0x1c4)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x4b887a(0x109)},'product_cat':{'$first':_0x4b887a(0x144)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x4b887a(0x212)},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x98ad37[_0x4b887a(0x12d)]>0x0)_0x2e0831[_0x4b887a(0x1b5)](_0x98ad37);else _0x135783[_0x4b887a(0x12d)]>0x0&&_0x2e0831[_0x4b887a(0x1b5)](_0x135783);}const _0x50f563=_0x5bd7a6[_0x359abf(0x11d)](_0xfc329=>_0x297339(_0xfc329));await Promise[_0x359abf(0x1c1)](_0x50f563),_0x4d25d5['json'](_0x2e0831);}),module[a0_0x3a7fee(0x13a)]=router;