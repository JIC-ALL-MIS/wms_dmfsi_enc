var a0_0x9364b6=a0_0x2620;function a0_0x39c9(){var _0x45e22e=['product','$product_details.maxProducts','primary_code','$product_details._id','$product','catch','7YiMGYJ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','from_room','/view/add_transfer','date','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','bay','<tr>','maxProducts','batch_code','11IbuHlW','id_transaction','</body></html>','abs','<div>','then','exports','Email\x20sent\x20successfully','maxPerUnit','edit_transfer_finished','</head><body>','product_stock','/CheckingWarehouse','English\x20(US)','Transfer\x20Finalize\x20Successfully','/transfer_finished/view','Rack\x202','$product.to_room_name','/view','push','redirect','to_bay','here2','errors','forEach','$product_details.batch_code','getFullYear','finalize','$room','from_bay','message','Spanish','nodemailer','primary_unit','$product_details.maxPerUnit','744380zLACcd','to_room','Router','flash','Rack\x201','\x20Order\x20Number\x20:\x20','<h5\x20style=\x22text-align:\x20left;\x22>','secondary_unit','\x20</h2>','/barcode_scanner','French','max','back','1113HprgAk','prod_name','params','$date','product_details','padStart','To_invoice','</table>','unit','Transfer\x20Edit\x20Successfully','sendMail','slice','$product_details.product_code','to_invoice','1500136KbumQq','to_floorlevel','error','$product_details.level','\x20<=>\x20','../models/all_models','1626590WTZStX','Arabic\x20(ae)','10636vgrdHa','_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Finished\x20Goods','$product_details.product_name','DRY\x20GOODS','findOne','$product.from_room_name','length','product_date','344448gBRzvl','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','json','map','$product_details.type','$product_details.primary_code','/transfer_finished/preview/','string','findById','German','language','email','Transfer\x20Mail','</div>','to_quantity','QA\x20Warehouse','</td>','MaxStocks_data2','$product_details.bin','product_code3','getMonth','from_prod_qty','Product\x20Transfer\x20successfully','filter','$finalize','TRFF-','to_prod_qty','to_prod_level','to_room_name','<h2>\x20','status','express','render','$product_details','New_Qty_Converted','edit_transfer_finished_view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/preview/:id','Ambient','Logo.png','Arabic','$product_details.product_stock','$product_details.rack','save','../middleware/auth','port','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Enabled','/barcode_scanner3','success','find','$product_details.bay','ToRoomAssigned','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','production_date','<hr\x20class=\x22my-3\x22>','transfer_data','/upload/','English','$product_details.storage','Enclosed','An\x20error\x20occurred\x20while\x20saving\x20data.','Chinese','MaxStocks_data','$product_details.isle','$from_warehouse','Error\x20Occurs','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','aggregate','from_warehouse','<strong>\x20Regards\x20</strong>','role','here1','$name','from_room_name','15jnwyoP','Portuguese\x20(BR)','/transfer/view','expiry_date','$product_details.secondary_unit','364314xbuZhA','/barcode_scanner2','$product_details.unit','/view/:id','warehouse','Hindi','prod_cat','An\x20error\x20occurred.','/../public','note','\x20Order\x20Date\x20:\x20','from_prod_level','image','get','invoice','../public/language/languages.json','from_invoice','product_code','$product_details.expiry_date','$product_details.secondary_code','</thead>','to_warehouse','RoomAssigned','site_title','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<!DOCTYPE\x20html>','<h5>','log','product_name','body','createTransport','floor','Portuguese','user','$product_details.pallet','transfer_finished','$_id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','from_quantity','$to_warehouse','$product_details.floorlevel','secondary_code','2360898wdeOzr','toString','There\x27s\x20a\x20error\x20in\x20this\x20transaction','post','staff','all','$product_details.production_date','</h5>','undefined'];a0_0x39c9=function(){return _0x45e22e;};return a0_0x39c9();}(function(_0x290667,_0x5000ab){var _0x59f15b=a0_0x2620,_0xa4a0b7=_0x290667();while(!![]){try{var _0x27ec75=parseInt(_0x59f15b(0x1c3))/0x1+parseInt(_0x59f15b(0x240))/0x2+-parseInt(_0x59f15b(0x1d0))/0x3*(-parseInt(_0x59f15b(0x1e6))/0x4)+-parseInt(_0x59f15b(0x23b))/0x5*(parseInt(_0x59f15b(0x26b))/0x6)+parseInt(_0x59f15b(0x27a))/0x7*(-parseInt(_0x59f15b(0x1de))/0x8)+parseInt(_0x59f15b(0x1f0))/0x9+parseInt(_0x59f15b(0x1e4))/0xa*(parseInt(_0x59f15b(0x284))/0xb);if(_0x27ec75===_0x5000ab)break;else _0xa4a0b7['push'](_0xa4a0b7['shift']());}catch(_0x2dfc6a){_0xa4a0b7['push'](_0xa4a0b7['shift']());}}}(a0_0x39c9,0xb6207));const express=require(a0_0x9364b6(0x20f)),app=express(),router=express[a0_0x9364b6(0x1c5)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x9364b6(0x1e3)),auth=require(a0_0x9364b6(0x21c)),users=require(a0_0x9364b6(0x24f)),nodemailer=require(a0_0x9364b6(0x1c0));function a0_0x2620(_0xfdfb92,_0x5b79a){var _0x39c975=a0_0x39c9();return a0_0x2620=function(_0x262021,_0x28ad2d){_0x262021=_0x262021-0x1b6;var _0x1ee374=_0x39c975[_0x262021];return _0x1ee374;},a0_0x2620(_0xfdfb92,_0x5b79a);}router[a0_0x9364b6(0x24d)](a0_0x9364b6(0x296),auth,async(_0x3d1945,_0xd02af2)=>{var _0x40fab2=a0_0x9364b6;try{const {username:_0x8ad3db,email:_0x109e27,role:_0x538a32}=_0x3d1945['user'],_0x439728=_0x3d1945[_0x40fab2(0x261)],_0x5a4dbd=await profile[_0x40fab2(0x1ec)]({'email':_0x439728[_0x40fab2(0x1fb)]}),_0x22c9ef=await master_shop[_0x40fab2(0x222)]();let _0x329e50;if(_0x439728[_0x40fab2(0x237)]==_0x40fab2(0x26f)){const _0x51b09c=await staff['findOne']({'email':_0x439728[_0x40fab2(0x1fb)]});_0x329e50=await transfers_finished[_0x40fab2(0x222)]({'from_warehouse':_0x51b09c['warehouse']});}else _0x329e50=await transfers_finished['aggregate']([{'$unwind':_0x40fab2(0x278)},{'$group':{'_id':_0x40fab2(0x264),'invoice':{'$first':'$invoice'},'date':{'$first':_0x40fab2(0x1d3)},'from_warehouse':{'$first':_0x40fab2(0x231)},'to_warehouse':{'$first':_0x40fab2(0x268)},'from_room_name':{'$addToSet':_0x40fab2(0x1ed)},'to_room_name':{'$addToSet':_0x40fab2(0x295)},'finalize':{'$first':_0x40fab2(0x208)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x22c9ef[0x0][_0x40fab2(0x1fa)]==_0x40fab2(0x291))var _0x42ce50=users[_0x40fab2(0x22a)];else{if(_0x22c9ef[0x0][_0x40fab2(0x1fa)]=='Hindi')var _0x42ce50=users[_0x40fab2(0x245)];else{if(_0x22c9ef[0x0][_0x40fab2(0x1fa)]==_0x40fab2(0x1f9))var _0x42ce50=users['German'];else{if(_0x22c9ef[0x0][_0x40fab2(0x1fa)]==_0x40fab2(0x1bf))var _0x42ce50=users['Spanish'];else{if(_0x22c9ef[0x0][_0x40fab2(0x1fa)]==_0x40fab2(0x1cd))var _0x42ce50=users['French'];else{if(_0x22c9ef[0x0][_0x40fab2(0x1fa)]=='Portuguese\x20(BR)')var _0x42ce50=users[_0x40fab2(0x260)];else{if(_0x22c9ef[0x0][_0x40fab2(0x1fa)]==_0x40fab2(0x22e))var _0x42ce50=users[_0x40fab2(0x22e)];else{if(_0x22c9ef[0x0]['language']=='Arabic\x20(ae)')var _0x42ce50=users['Arabic'];}}}}}}}_0xd02af2[_0x40fab2(0x210)](_0x40fab2(0x263),{'success':_0x3d1945[_0x40fab2(0x1c6)]('success'),'errors':_0x3d1945[_0x40fab2(0x1c6)](_0x40fab2(0x1b7)),'role':_0x439728,'profile':_0x5a4dbd,'master_shop':_0x22c9ef,'transfer':_0x329e50,'language':_0x42ce50});}catch(_0x667f66){console[_0x40fab2(0x25b)](_0x667f66);}});async function getRandom8DigitNumber(){var _0x23e5a2=a0_0x9364b6;const _0x153dbd=0x989680,_0x43c54c=0x5f5e0ff,_0x292cd4=Math[_0x23e5a2(0x25f)](Math['random']()*(_0x43c54c-_0x153dbd+0x1))+_0x153dbd;var _0x44540c;const _0x149129=await transfers_finished[_0x23e5a2(0x1ec)]({'invoice':_0x23e5a2(0x209)+_0x292cd4});return _0x149129&&_0x149129[_0x23e5a2(0x1ee)]>0x0?_0x44540c='TRFF-'+_0x292cd4:_0x44540c='TRFF-'+_0x292cd4,_0x44540c;}router[a0_0x9364b6(0x24d)]('/view/add_transfer',auth,async(_0x2effed,_0x23f936)=>{var _0x978bc1=a0_0x9364b6;try{const {username:_0x45a875,email:_0x34a265,role:_0x5eacdc}=_0x2effed['user'],_0xeaaff6=_0x2effed['user'],_0x569c29=await profile[_0x978bc1(0x1ec)]({'email':_0xeaaff6[_0x978bc1(0x1fb)]}),_0x5ac5fc=await master_shop['find']();let _0x30f14a;if(_0xeaaff6[_0x978bc1(0x237)]=='staff'){const _0x43916c=await staff['findOne']({'email':_0xeaaff6['email']});_0x30f14a=await warehouse[_0x978bc1(0x234)]([{'$match':{'status':'Enabled','name':_0x43916c['warehouse'],'warehouse_category':_0x978bc1(0x1e9),'name':{'$ne':_0x978bc1(0x1ff)}}},{'$group':{'_id':_0x978bc1(0x239),'name':{'$first':_0x978bc1(0x239)}}}]);}else _0x30f14a=await warehouse[_0x978bc1(0x234)]([{'$match':{'status':'Enabled','warehouse_category':_0x978bc1(0x1e9),'name':{'$ne':_0x978bc1(0x1ff)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x430231=await transfers_finished['find']({}),_0x2e6149=_0x430231[_0x978bc1(0x1ee)]+0x1,_0x40a560=_0x978bc1(0x209)+_0x2e6149[_0x978bc1(0x26c)]()[_0x978bc1(0x1d5)](0x5,'0');if(_0x5ac5fc[0x0][_0x978bc1(0x1fa)]=='English\x20(US)')var _0x3deec3=users[_0x978bc1(0x22a)];else{if(_0x5ac5fc[0x0][_0x978bc1(0x1fa)]==_0x978bc1(0x245))var _0x3deec3=users[_0x978bc1(0x245)];else{if(_0x5ac5fc[0x0][_0x978bc1(0x1fa)]==_0x978bc1(0x1f9))var _0x3deec3=users[_0x978bc1(0x1f9)];else{if(_0x5ac5fc[0x0][_0x978bc1(0x1fa)]=='Spanish')var _0x3deec3=users['Spanish'];else{if(_0x5ac5fc[0x0][_0x978bc1(0x1fa)]=='French')var _0x3deec3=users['French'];else{if(_0x5ac5fc[0x0]['language']==_0x978bc1(0x23c))var _0x3deec3=users[_0x978bc1(0x260)];else{if(_0x5ac5fc[0x0]['language']==_0x978bc1(0x22e))var _0x3deec3=users[_0x978bc1(0x22e)];else{if(_0x5ac5fc[0x0][_0x978bc1(0x1fa)]==_0x978bc1(0x1e5))var _0x3deec3=users['Arabic'];}}}}}}}const _0x3d753d=getRandom8DigitNumber();_0x3d753d[_0x978bc1(0x289)](_0x282a3f=>{var _0x51116b=_0x978bc1;_0x23f936['render']('add_transfer_finished',{'success':_0x2effed[_0x51116b(0x1c6)]('success'),'errors':_0x2effed[_0x51116b(0x1c6)](_0x51116b(0x1b7)),'role':_0xeaaff6,'profile':_0x569c29,'master_shop':_0x5ac5fc,'warehouse':_0x30f14a,'language':_0x3deec3,'invoice':_0x282a3f});})[_0x978bc1(0x279)](_0x33eaf5=>{var _0x5955f1=_0x978bc1;_0x2effed['flash'](_0x5955f1(0x1b7),_0x5955f1(0x26d)),_0x23f936[_0x5955f1(0x298)](_0x5955f1(0x23d));});}catch(_0x4a03db){console['log'](_0x4a03db);}}),router[a0_0x9364b6(0x26e)](a0_0x9364b6(0x27d),auth,async(_0x14c810,_0x11f8bc)=>{var _0x147a61=a0_0x9364b6;try{const {date:_0x43d022,from_warehouse:_0x2f30a7,FromRoom_name:_0x25ad57,to_warehouse:_0x5e4afd,ToRoom_name:_0x24dc72,prod_name:_0x70d127,from_prod_qty:_0x415c8c,from_prod_level:_0x15eb41,from_prod_isle:_0x348db9,from_prod_pallet:_0x182a61,to_prod_qty:_0x178dd6,to_prod_level:_0xc52dc3,to_prod_isle:_0x12016c,to_prod_pallet:_0x549f3a,primary_code:_0x288299,secondary_code:_0x21abd7,product_code3:_0x3ae66e,note:_0x29774e,MaxStocks_data2:_0x4e29f1,invoice:_0x1108cb,expiry_date:_0xf768c9}=_0x14c810['body'];if(typeof _0x70d127=='string')var _0x311edc=[_0x14c810[_0x147a61(0x25d)]['prod_name']],_0x2be718=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x205)]],_0x5d812b=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x24b)]],_0xdfbecb=[_0x14c810[_0x147a61(0x25d)]['New_Qty_Converted']],_0x1e3667=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x20b)]],_0x4902c0=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x276)]],_0xbee2e3=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x26a)]],_0x59cbfd=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x203)]],_0xbcf93b=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x201)]],_0x12c498=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x1c1)]],_0x23f42e=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x1ca)]],_0x396122=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x283)]],_0x2c6a47=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x23e)]],_0x965e17=[_0x14c810['body'][_0x147a61(0x1ef)]],_0x218319=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x22f)]],_0x19d002=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x28c)]],_0x28e4e7=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x246)]],_0x5e51c2=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x256)]],_0x3f8ed3=[_0x14c810['body']['ToRoomAssigned']],_0x2eadf3=[_0x14c810[_0x147a61(0x25d)]['from_invoice']],_0x2acbd3=[_0x14c810[_0x147a61(0x25d)][_0x147a61(0x1dd)]],_0xd41001=[_0x14c810[_0x147a61(0x25d)]['id_transaction']];else var _0x311edc=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x1d1)]],_0x2be718=[..._0x14c810[_0x147a61(0x25d)]['from_prod_qty']],_0x5d812b=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x24b)]],_0xdfbecb=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x212)]],_0x1e3667=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x20b)]],_0x4902c0=[..._0x14c810['body'][_0x147a61(0x276)]],_0xbee2e3=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x26a)]],_0x59cbfd=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x203)]],_0xbcf93b=[..._0x14c810[_0x147a61(0x25d)]['MaxStocks_data2']],_0x12c498=[..._0x14c810[_0x147a61(0x25d)]['primary_unit']],_0x23f42e=[..._0x14c810[_0x147a61(0x25d)]['secondary_unit']],_0x396122=[..._0x14c810[_0x147a61(0x25d)]['batch_code']],_0x2c6a47=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x23e)]],_0x965e17=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x1ef)]],_0x218319=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x22f)]],_0x19d002=[..._0x14c810[_0x147a61(0x25d)]['maxPerUnit']],_0x28e4e7=[..._0x14c810[_0x147a61(0x25d)]['prod_cat']],_0x5e51c2=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x256)]],_0x3f8ed3=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x224)]],_0x2eadf3=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x250)]],_0x2acbd3=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x1dd)]],_0xd41001=[..._0x14c810[_0x147a61(0x25d)][_0x147a61(0x285)]];const _0x29f910=_0x311edc[_0x147a61(0x1f3)](_0x1311e5=>{return _0x1311e5={'product_name':_0x1311e5};});_0x2be718[_0x147a61(0x1b8)]((_0x19f6ef,_0x4dd04f)=>{var _0x47ca26=_0x147a61;_0x29f910[_0x4dd04f][_0x47ca26(0x267)]=_0x19f6ef;}),_0x5d812b[_0x147a61(0x1b8)]((_0x31ea71,_0x52ebe6)=>{_0x29f910[_0x52ebe6]['from_bay']=_0x31ea71;}),_0xd41001[_0x147a61(0x1b8)]((_0x532e31,_0x2c51dc)=>{var _0x4a1fbe=_0x147a61;_0x29f910[_0x2c51dc][_0x4a1fbe(0x285)]=_0x532e31;}),_0x2eadf3[_0x147a61(0x1b8)]((_0x15281b,_0x524667)=>{_0x29f910[_0x524667]['from_invoice']=_0x15281b;}),_0x2acbd3[_0x147a61(0x1b8)]((_0x373e84,_0xba291b)=>{var _0x527f74=_0x147a61;_0x29f910[_0xba291b][_0x527f74(0x1d6)]=_0x373e84;}),_0xdfbecb[_0x147a61(0x1b8)]((_0x151806,_0x2ed5ec)=>{_0x29f910[_0x2ed5ec]['to_quantity']=_0x151806;}),_0x1e3667[_0x147a61(0x1b8)]((_0x26cbcd,_0x358716)=>{var _0x30bf79=_0x147a61;_0x29f910[_0x358716][_0x30bf79(0x299)]=_0x26cbcd;}),_0x4902c0[_0x147a61(0x1b8)]((_0x3fe7d3,_0x30bf2a)=>{var _0x59bfed=_0x147a61;_0x29f910[_0x30bf2a][_0x59bfed(0x276)]=_0x3fe7d3;}),_0xbee2e3['forEach']((_0x131a6a,_0x6769b0)=>{_0x29f910[_0x6769b0]['secondary_code']=_0x131a6a;}),_0x59cbfd[_0x147a61(0x1b8)]((_0x405af6,_0x5f2313)=>{var _0x2af978=_0x147a61;_0x29f910[_0x5f2313][_0x2af978(0x251)]=_0x405af6;}),_0xbcf93b[_0x147a61(0x1b8)]((_0x44eefb,_0x250fed)=>{var _0x577c5d=_0x147a61;_0x29f910[_0x250fed][_0x577c5d(0x282)]=_0x44eefb;}),_0x12c498['forEach']((_0x1e7ec8,_0x513615)=>{var _0x50f6e1=_0x147a61;_0x29f910[_0x513615][_0x50f6e1(0x1d8)]=_0x1e7ec8;}),_0x23f42e[_0x147a61(0x1b8)]((_0x316415,_0x23267c)=>{_0x29f910[_0x23267c]['secondary_unit']=_0x316415;}),_0x396122[_0x147a61(0x1b8)]((_0x13620f,_0x2356d2)=>{_0x29f910[_0x2356d2]['batch_code']=_0x13620f;}),_0x2c6a47[_0x147a61(0x1b8)]((_0x1d0724,_0x58e688)=>{var _0x456cee=_0x147a61;_0x29f910[_0x58e688][_0x456cee(0x23e)]=_0x1d0724;}),_0x965e17[_0x147a61(0x1b8)]((_0x126fd8,_0x37bdfb)=>{var _0x58de01=_0x147a61;_0x29f910[_0x37bdfb][_0x58de01(0x226)]=_0x126fd8;}),_0x218319[_0x147a61(0x1b8)]((_0xdce7a0,_0x483454)=>{var _0x61fb72=_0x147a61;_0x29f910[_0x483454][_0x61fb72(0x282)]=_0xdce7a0;}),_0x19d002[_0x147a61(0x1b8)]((_0x5669c3,_0x57e390)=>{var _0x2685cd=_0x147a61;_0x29f910[_0x57e390][_0x2685cd(0x28c)]=_0x5669c3;}),_0x28e4e7[_0x147a61(0x1b8)]((_0x303d49,_0x433819)=>{_0x29f910[_0x433819]['prod_cat']=_0x303d49;}),_0x5e51c2[_0x147a61(0x1b8)]((_0x3c5013,_0x30e75c)=>{var _0x3fbc3e=_0x147a61;_0x29f910[_0x30e75c][_0x3fbc3e(0x23a)]=_0x3c5013;}),_0x3f8ed3['forEach']((_0x5b6520,_0x3ede35)=>{var _0x5ee0de=_0x147a61;_0x29f910[_0x3ede35][_0x5ee0de(0x20c)]=_0x5b6520;});const _0x2f2d47=_0x29f910['filter'](_0x2cb630=>_0x2cb630[_0x147a61(0x1fe)]!=='0'&&_0x2cb630[_0x147a61(0x1fe)]!==''||_0x2cb630['to_floorlevel']!=='0'&&_0x2cb630[_0x147a61(0x1df)]!=='');var _0x133a9e=0x0;_0x2f2d47[_0x147a61(0x1b8)](_0x1fde3f=>{var _0x1f1d5e=_0x147a61;parseInt(_0x1fde3f[_0x1f1d5e(0x267)])<parseInt(_0x1fde3f[_0x1f1d5e(0x1fe)])&&_0x133a9e++;});if(_0x133a9e!=0x0)return _0x14c810[_0x147a61(0x1c6)]('errors',_0x147a61(0x233)),_0x11f8bc[_0x147a61(0x298)](_0x147a61(0x1cf));const _0x388a45=new transfers_finished({'date':_0x43d022,'from_warehouse':_0x2f30a7,'to_warehouse':_0x5e4afd,'product':_0x2f2d47,'note':_0x29774e,'invoice':_0x1108cb}),_0x574c5e=await _0x388a45['save']();_0x14c810[_0x147a61(0x1c6)](_0x147a61(0x221),_0x147a61(0x206)),_0x11f8bc[_0x147a61(0x298)](_0x147a61(0x1f6)+_0x574c5e[_0x147a61(0x1e7)]);}catch(_0x3b363b){console['log'](_0x3b363b),_0x11f8bc['status'](0xc8)[_0x147a61(0x1f2)]({'errorMessage':_0x3b363b[_0x147a61(0x1be)]});}}),router[a0_0x9364b6(0x24d)](a0_0x9364b6(0x215),auth,async(_0x5db7ac,_0xb52679)=>{var _0x4e99ce=a0_0x9364b6;try{const {username:_0x31198b,email:_0x1de90a,role:_0x109a95}=_0x5db7ac[_0x4e99ce(0x261)],_0x37245b=_0x5db7ac[_0x4e99ce(0x261)],_0x11b654=await profile['findOne']({'email':_0x37245b[_0x4e99ce(0x1fb)]}),_0x4ee9ad=await master_shop[_0x4e99ce(0x222)](),_0x50df36=await transfers_finished[_0x4e99ce(0x1f8)](_0x5db7ac[_0x4e99ce(0x1d2)]['id']);let _0x1b1900;if(_0x37245b['role']==_0x4e99ce(0x26f)){const _0x219b38=await staff[_0x4e99ce(0x1ec)]({'email':_0x37245b[_0x4e99ce(0x1fb)]});_0x1b1900=await warehouse[_0x4e99ce(0x222)]({'status':'Enabled','name':_0x219b38[_0x4e99ce(0x244)],'warehouse_category':'Finished\x20Goods'});}else _0x1b1900=await warehouse[_0x4e99ce(0x222)]({'status':_0x4e99ce(0x21f),'warehouse_category':_0x4e99ce(0x1e9)});const _0x2d3e74=await warehouse[_0x4e99ce(0x234)]([{'$match':{'name':_0x50df36[_0x4e99ce(0x235)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x4e99ce(0x211)},{'$group':{'_id':_0x4e99ce(0x277),'name':{'$first':_0x4e99ce(0x1ea)},'product_stock':{'$first':_0x4e99ce(0x219)},'bay':{'$first':_0x4e99ce(0x223)},'bin':{'$first':_0x4e99ce(0x202)},'type':{'$first':_0x4e99ce(0x1f4)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x4e99ce(0x253)},'product_code':{'$first':_0x4e99ce(0x1dc)},'storage':{'$first':_0x4e99ce(0x22b)},'rack':{'$first':_0x4e99ce(0x21a)},'expiry_date':{'$first':_0x4e99ce(0x252)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4e99ce(0x1bc)},'warehoue_name':{'$first':_0x4e99ce(0x239)}}}]),_0x5a684d=await product[_0x4e99ce(0x222)]({});if(_0x4ee9ad[0x0][_0x4e99ce(0x1fa)]=='English\x20(US)'){var _0x1c905f=users[_0x4e99ce(0x22a)];console[_0x4e99ce(0x25b)](_0x1c905f);}else{if(_0x4ee9ad[0x0]['language']==_0x4e99ce(0x245))var _0x1c905f=users[_0x4e99ce(0x245)];else{if(_0x4ee9ad[0x0][_0x4e99ce(0x1fa)]==_0x4e99ce(0x1f9))var _0x1c905f=users[_0x4e99ce(0x1f9)];else{if(_0x4ee9ad[0x0][_0x4e99ce(0x1fa)]=='Spanish')var _0x1c905f=users[_0x4e99ce(0x1bf)];else{if(_0x4ee9ad[0x0][_0x4e99ce(0x1fa)]==_0x4e99ce(0x1cd))var _0x1c905f=users['French'];else{if(_0x4ee9ad[0x0][_0x4e99ce(0x1fa)]==_0x4e99ce(0x23c))var _0x1c905f=users['Portuguese'];else{if(_0x4ee9ad[0x0]['language']==_0x4e99ce(0x22e))var _0x1c905f=users[_0x4e99ce(0x22e)];else{if(_0x4ee9ad[0x0][_0x4e99ce(0x1fa)]==_0x4e99ce(0x1e5))var _0x1c905f=users['Arabic'];}}}}}}}_0xb52679[_0x4e99ce(0x210)](_0x4e99ce(0x213),{'success':_0x5db7ac['flash'](_0x4e99ce(0x221)),'errors':_0x5db7ac[_0x4e99ce(0x1c6)](_0x4e99ce(0x1b7)),'role':_0x37245b,'profile':_0x11b654,'master_shop':_0x4ee9ad,'warehouse':_0x1b1900,'transfer':_0x50df36,'stock':_0x2d3e74,'unit':_0x5a684d,'language':_0x1c905f});}catch(_0x134642){console[_0x4e99ce(0x25b)](_0x134642);}}),router[a0_0x9364b6(0x26e)](a0_0x9364b6(0x215),auth,async(_0x398c79,_0x27365c)=>{var _0x16919e=a0_0x9364b6;try{const {invoice:_0xb02740,from_warehouse:_0x376d50,FromRoom_name:_0x2af584,to_warehouse:_0x1a9cf6,ToRoom_name:_0x49b97f}=_0x398c79['body'],_0x365bcd=await transfers_finished[_0x16919e(0x1f8)](_0x398c79[_0x16919e(0x1d2)]['id']),_0x58ba32=_0x365bcd[_0x16919e(0x274)][_0x16919e(0x1f3)](async _0x76635c=>{var _0xd533e4=_0x16919e;if(_0x76635c['to_quantity']>0x0){var _0x489db4=await warehouse[_0xd533e4(0x1ec)]({'name':_0x376d50,'room':_0x76635c['from_room_name'],'warehouse_category':'Finished\x20Goods'});const _0xe78811=_0x489db4['product_details']['map'](_0x31272f=>{var _0x58aea3=_0xd533e4;_0x31272f[_0x58aea3(0x25c)]==_0x76635c[_0x58aea3(0x25c)]&&_0x31272f[_0x58aea3(0x280)]==_0x76635c[_0x58aea3(0x1bd)]&&_0x31272f[_0x58aea3(0x23e)]==_0x76635c[_0x58aea3(0x23e)]&&_0x31272f[_0x58aea3(0x226)]==_0x76635c['production_date']&&_0x31272f[_0x58aea3(0x283)]==_0x76635c[_0x58aea3(0x283)]&&_0x31272f[_0x58aea3(0x24e)]==_0x76635c[_0x58aea3(0x250)]&&(console[_0x58aea3(0x25b)](_0x58aea3(0x238),_0x31272f[_0x58aea3(0x28f)]),typeof _0x76635c[_0x58aea3(0x285)]=='undefined'?_0x31272f[_0x58aea3(0x28f)]=Math[_0x58aea3(0x1ce)](0x0,Math[_0x58aea3(0x287)](_0x31272f[_0x58aea3(0x28f)])-Math['abs'](_0x76635c[_0x58aea3(0x1fe)])):_0x31272f[_0x58aea3(0x28f)]=Math[_0x58aea3(0x1ce)](0x0,Math[_0x58aea3(0x287)](_0x31272f[_0x58aea3(0x28f)])-Math[_0x58aea3(0x287)](_0x76635c[_0x58aea3(0x1fe)])));});}return _0x489db4;});Promise[_0x16919e(0x270)](_0x58ba32)[_0x16919e(0x289)](async _0x312398=>{var _0x58aada=_0x16919e;try{for(const _0x185b59 of _0x312398){await _0x185b59[_0x58aada(0x21b)]();}const _0x91f680=_0x365bcd['product'][_0x58aada(0x1f3)](async _0x11fd33=>{var _0x5dbcc9=_0x58aada,_0x495d2a=await warehouse[_0x5dbcc9(0x1ec)]({'name':_0x1a9cf6,'room':_0x11fd33[_0x5dbcc9(0x20c)]});if(_0x11fd33[_0x5dbcc9(0x1fe)]>0x0){var _0x355207=0x0;const _0x4e8644=_0x495d2a[_0x5dbcc9(0x1d4)][_0x5dbcc9(0x1f3)](_0x5a7c88=>{var _0x10db65=_0x5dbcc9;_0x5a7c88[_0x10db65(0x25c)]==_0x11fd33[_0x10db65(0x25c)]&&_0x5a7c88['bay']==_0x11fd33[_0x10db65(0x299)]&&_0x5a7c88['expiry_date']==_0x11fd33[_0x10db65(0x23e)]&&_0x5a7c88[_0x10db65(0x226)]==_0x11fd33['production_date']&&_0x5a7c88['batch_code']==_0x11fd33['batch_code']&&_0x5a7c88[_0x10db65(0x24e)]==_0x11fd33['To_invoice']&&(typeof _0x11fd33[_0x10db65(0x285)]==_0x10db65(0x273)?(console[_0x10db65(0x25b)](_0x10db65(0x1b6),_0x5a7c88[_0x10db65(0x28f)]+'\x20<>\x20'+_0x5a7c88[_0x10db65(0x1e7)]+_0x10db65(0x1e2)+Math[_0x10db65(0x287)](_0x5a7c88[_0x10db65(0x28f)])+Math['abs'](_0x11fd33[_0x10db65(0x1fe)])),_0x5a7c88[_0x10db65(0x28f)]=Math[_0x10db65(0x287)](_0x5a7c88['product_stock'])+Math[_0x10db65(0x287)](_0x11fd33[_0x10db65(0x1fe)])):_0x5a7c88[_0x10db65(0x28f)]=Math[_0x10db65(0x287)](_0x5a7c88['product_stock'])+Math[_0x10db65(0x287)](_0x11fd33['to_quantity']),_0x355207++);});_0x355207=='0'&&(_0x495d2a['product_details']=_0x495d2a['product_details']['concat']({'product_name':_0x11fd33[_0x5dbcc9(0x25c)],'product_stock':_0x11fd33[_0x5dbcc9(0x1fe)],'bay':_0x11fd33[_0x5dbcc9(0x299)],'product_code':_0x11fd33['product_code'],'primary_code':_0x11fd33[_0x5dbcc9(0x276)],'secondary_code':_0x11fd33[_0x5dbcc9(0x26a)],'expiry_date':_0x11fd33[_0x5dbcc9(0x23e)],'production_date':_0x11fd33[_0x5dbcc9(0x226)],'maxProducts':_0x11fd33[_0x5dbcc9(0x282)],'batch_code':_0x11fd33[_0x5dbcc9(0x283)],'secondary_unit':_0x11fd33[_0x5dbcc9(0x1ca)],'unit':_0x11fd33['unit'],'maxProducts':_0x11fd33[_0x5dbcc9(0x282)],'maxPerUnit':_0x11fd33[_0x5dbcc9(0x28c)],'invoice':_0x11fd33[_0x5dbcc9(0x1d6)]}));}return _0x495d2a;});Promise[_0x58aada(0x270)](_0x91f680)[_0x58aada(0x289)](async _0xc0df76=>{var _0x3ddc9c=_0x58aada;try{for(const _0x1789d5 of _0xc0df76){await warehouse['updateOne']({'_id':_0x1789d5['_id']},{'$addToSet':{'product_details':{'$each':_0x1789d5[_0x3ddc9c(0x1d4)]}}});}_0x365bcd[_0x3ddc9c(0x1bb)]='True';const _0x20446b=await _0x365bcd[_0x3ddc9c(0x21b)](),_0x347408=await master_shop[_0x3ddc9c(0x222)](),_0x5eef4c=await email_settings[_0x3ddc9c(0x1ec)](),_0x6a8168=await supervisor_settings[_0x3ddc9c(0x222)]();var _0x299fc8=_0x365bcd[_0x3ddc9c(0x274)],_0x5ece8f='',_0x18d780;for(_0x18d780 in _0x299fc8){var _0x5a6749='FG';_0x365bcd['to_warehouse']==_0x3ddc9c(0x1eb)&&(_0x5a6749='DG'),_0x5ece8f+=_0x3ddc9c(0x281)+_0x3ddc9c(0x225)+_0x299fc8[_0x18d780][_0x3ddc9c(0x25c)]+'</td>'+_0x3ddc9c(0x225)+_0x299fc8[_0x18d780][_0x3ddc9c(0x251)]+'</td>'+_0x3ddc9c(0x225)+_0x299fc8[_0x18d780][_0x3ddc9c(0x1fe)]+_0x3ddc9c(0x200)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x299fc8[_0x18d780]['unit']+_0x3ddc9c(0x200)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x299fc8[_0x18d780][_0x3ddc9c(0x1ca)]+_0x3ddc9c(0x200)+_0x3ddc9c(0x225)+_0x365bcd[_0x3ddc9c(0x255)]+_0x3ddc9c(0x200)+_0x3ddc9c(0x225)+_0x299fc8[_0x18d780][_0x3ddc9c(0x20c)]+_0x3ddc9c(0x200)+_0x3ddc9c(0x225)+_0x5a6749+_0x299fc8[_0x18d780][_0x3ddc9c(0x299)]+_0x3ddc9c(0x200)+'</tr>';}let _0x3b5bc4=nodemailer[_0x3ddc9c(0x25e)]({'host':_0x5eef4c['host'],'port':Number(_0x5eef4c[_0x3ddc9c(0x21d)]),'secure':![],'auth':{'user':_0x5eef4c[_0x3ddc9c(0x1fb)],'pass':_0x5eef4c['password']}}),_0x15bb03={'from':_0x5eef4c[_0x3ddc9c(0x1fb)],'to':_0x6a8168[0x0]['FGSEmail'],'subject':_0x3ddc9c(0x1fc),'attachments':[{'filename':_0x3ddc9c(0x217),'path':__dirname+_0x3ddc9c(0x248)+_0x3ddc9c(0x229)+_0x347408[0x0][_0x3ddc9c(0x24c)],'cid':'logo'}],'html':_0x3ddc9c(0x259)+'<html><head><title></title>'+_0x3ddc9c(0x28e)+_0x3ddc9c(0x288)+_0x3ddc9c(0x27f)+_0x3ddc9c(0x288)+_0x3ddc9c(0x266)+'</div>'+_0x3ddc9c(0x288)+_0x3ddc9c(0x20d)+_0x347408[0x0][_0x3ddc9c(0x257)]+_0x3ddc9c(0x1cb)+'</div>'+_0x3ddc9c(0x1fd)+_0x3ddc9c(0x227)+'<div>'+_0x3ddc9c(0x1c9)+_0x3ddc9c(0x1c8)+_0x365bcd['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x3ddc9c(0x24a)+_0x365bcd[_0x3ddc9c(0x27e)]+'\x20'+'</span>'+_0x3ddc9c(0x272)+_0x3ddc9c(0x1fd)+_0x3ddc9c(0x258)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x3ddc9c(0x1e8)+_0x3ddc9c(0x214)+_0x3ddc9c(0x265)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3ddc9c(0x21e)+_0x3ddc9c(0x27b)+_0x3ddc9c(0x1f1)+'</tr>'+_0x3ddc9c(0x254)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x5ece8f+'\x20'+'</tbody>'+_0x3ddc9c(0x1d7)+'<div>'+_0x3ddc9c(0x236)+_0x3ddc9c(0x25a)+_0x347408[0x0][_0x3ddc9c(0x257)]+'</h5>'+_0x3ddc9c(0x1fd)+_0x3ddc9c(0x1fd)+_0x3ddc9c(0x286)};_0x3b5bc4[_0x3ddc9c(0x1da)](_0x15bb03,function(_0x40ec4b,_0x50a65c){var _0x17de8e=_0x3ddc9c;_0x40ec4b?(console[_0x17de8e(0x25b)](_0x40ec4b),console[_0x17de8e(0x25b)](_0x17de8e(0x232))):console[_0x17de8e(0x25b)](_0x17de8e(0x28b));}),_0x398c79[_0x3ddc9c(0x1c6)](_0x3ddc9c(0x221),_0x3ddc9c(0x292)),_0x27365c[_0x3ddc9c(0x298)]('/picking_list/PDF_transfer/'+_0x20446b['_id']);}catch(_0x20fb10){console[_0x3ddc9c(0x1e0)](_0x20fb10),_0x27365c['status'](0x1f4)['json']({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x58aada(0x279)](_0x344c7c=>{var _0x640f52=_0x58aada;console[_0x640f52(0x1e0)](_0x344c7c),_0x27365c[_0x640f52(0x20e)](0x1f4)[_0x640f52(0x1f2)]({'error':_0x640f52(0x247)});});}catch(_0x4f0c4c){console['error'](_0x4f0c4c),_0x27365c[_0x58aada(0x20e)](0x1f4)[_0x58aada(0x1f2)]({'error':_0x58aada(0x22d)});}})[_0x16919e(0x279)](_0x37bd89=>{var _0x362a0f=_0x16919e;console['error'](_0x37bd89),_0x27365c[_0x362a0f(0x20e)](0x1f4)[_0x362a0f(0x1f2)]({'error':'An\x20error\x20occurred.'});});}catch(_0x2880f9){_0x27365c[_0x16919e(0x1f2)]({'message':_0x2880f9[_0x16919e(0x1be)]});}});function BayBinSelected(_0x5c8690,_0x59174b){var _0x4c7c02=a0_0x9364b6,_0x45c990=[];let _0x2f7de1=[];var _0x2457ae=[];if(_0x5c8690==_0x4c7c02(0x1eb)){switch(_0x59174b){case _0x4c7c02(0x1c7):_0x45c990=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x4c7c02(0x294):_0x45c990=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x2457ae=['DG'];}else{if(_0x5c8690=='FROZEN\x20GOODS'){switch(_0x59174b){case _0x4c7c02(0x1c7):_0x45c990=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x45c990=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x2457ae=['FG'];}}return{'levels':_0x45c990,'identify':_0x2457ae};}router[a0_0x9364b6(0x24d)]('/view/:id',auth,async(_0x9a9ae0,_0x32e476)=>{var _0x5274db=a0_0x9364b6;try{const {username:_0x363a1f,email:_0x59b308,role:_0x25cbde}=_0x9a9ae0[_0x5274db(0x261)],_0x265adc=_0x9a9ae0[_0x5274db(0x261)],_0x8312ad=await profile[_0x5274db(0x1ec)]({'email':_0x265adc[_0x5274db(0x1fb)]}),_0x19ed1d=await master_shop['find'](),_0x50c670=await transfers_finished[_0x5274db(0x1f8)](_0x9a9ae0[_0x5274db(0x1d2)]['id']);let _0x5e1e97=new Date(_0x50c670[_0x5274db(0x23e)]),_0x1b8c37=('0'+_0x5e1e97['getDate']())[_0x5274db(0x1db)](-0x2),_0x2ed7bf=('0'+(_0x5e1e97[_0x5274db(0x204)]()+0x1))[_0x5274db(0x1db)](-0x2),_0xd4ceef=_0x5e1e97[_0x5274db(0x1ba)](),_0x2fc057=_0xd4ceef+'-'+_0x2ed7bf+'-'+_0x1b8c37,_0x10431d;if(_0x265adc[_0x5274db(0x237)]==_0x5274db(0x26f)){const _0x397a73=await staff[_0x5274db(0x1ec)]({'email':_0x265adc[_0x5274db(0x1fb)]});_0x10431d=await warehouse[_0x5274db(0x222)]({'status':'Enabled','name':_0x397a73[_0x5274db(0x244)],'warehouse_category':_0x5274db(0x1e9)});}else _0x10431d=await warehouse[_0x5274db(0x222)]({'status':_0x5274db(0x21f),'warehouse_category':_0x5274db(0x1e9)});const _0x2930f1=await warehouse[_0x5274db(0x234)]([{'$match':{'name':_0x50c670[_0x5274db(0x235)],'room':_0x50c670[_0x5274db(0x27c)]}},{'$unwind':_0x5274db(0x211)},{'$group':{'_id':_0x5274db(0x277),'name':{'$first':_0x5274db(0x1ea)},'product_stock':{'$first':_0x5274db(0x219)},'bay':{'$first':_0x5274db(0x223)},'bin':{'$first':_0x5274db(0x202)},'type':{'$first':_0x5274db(0x1f4)},'floorlevel':{'$first':_0x5274db(0x269)},'primary_code':{'$first':_0x5274db(0x1f5)},'secondary_code':{'$first':_0x5274db(0x253)},'product_code':{'$first':_0x5274db(0x1dc)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5274db(0x21a)}}}]);var _0x32668a=[0x1,0x2,0x3,0x4],_0x50a024=['A','B','C','D','E','F','G','H','I','J'],_0x45824e=[_0x5274db(0x216),_0x5274db(0x22c)];const _0x24bf8c=await product[_0x5274db(0x222)]({}),_0x40b5f6=BayBinSelected(_0x50c670[_0x5274db(0x255)],_0x50c670[_0x5274db(0x1c4)]);if(_0x19ed1d[0x0][_0x5274db(0x1fa)]==_0x5274db(0x291)){var _0x2e5b9b=users['English'];console[_0x5274db(0x25b)](_0x2e5b9b);}else{if(_0x19ed1d[0x0][_0x5274db(0x1fa)]==_0x5274db(0x245))var _0x2e5b9b=users['Hindi'];else{if(_0x19ed1d[0x0][_0x5274db(0x1fa)]==_0x5274db(0x1f9))var _0x2e5b9b=users[_0x5274db(0x1f9)];else{if(_0x19ed1d[0x0][_0x5274db(0x1fa)]==_0x5274db(0x1bf))var _0x2e5b9b=users['Spanish'];else{if(_0x19ed1d[0x0][_0x5274db(0x1fa)]==_0x5274db(0x1cd))var _0x2e5b9b=users['French'];else{if(_0x19ed1d[0x0][_0x5274db(0x1fa)]==_0x5274db(0x23c))var _0x2e5b9b=users[_0x5274db(0x260)];else{if(_0x19ed1d[0x0]['language']=='Chinese')var _0x2e5b9b=users[_0x5274db(0x22e)];else{if(_0x19ed1d[0x0]['language']==_0x5274db(0x1e5))var _0x2e5b9b=users[_0x5274db(0x218)];}}}}}}}_0x32e476[_0x5274db(0x210)](_0x5274db(0x28d),{'success':_0x9a9ae0[_0x5274db(0x1c6)](_0x5274db(0x221)),'errors':_0x9a9ae0[_0x5274db(0x1c6)]('errors'),'role':_0x265adc,'profile':_0x8312ad,'master_shop':_0x19ed1d,'warehouse':_0x10431d,'transfer':_0x50c670,'stock':_0x2930f1,'unit':_0x24bf8c,'language':_0x2e5b9b,'levels':_0x32668a,'Isle':_0x50a024,'rooms_data':_0x45824e,'ed_fullDate':_0x2fc057,'dataSelected':_0x40b5f6});}catch(_0x1651b9){console[_0x5274db(0x25b)](_0x1651b9);}}),router[a0_0x9364b6(0x26e)](a0_0x9364b6(0x243),auth,async(_0x48f6fb,_0x162b76)=>{var _0x2abb31=a0_0x9364b6;try{const _0x28019d=_0x48f6fb[_0x2abb31(0x1d2)]['id'];console[_0x2abb31(0x25b)](_0x48f6fb[_0x2abb31(0x25d)]);const _0x3f2a2d=await transfers_finished[_0x2abb31(0x1f8)](_0x28019d);console[_0x2abb31(0x25b)](_0x2abb31(0x228),_0x3f2a2d);const {date:_0x1d6baa,from_warehouse:_0x33d036,FromRoom_name:_0x582c75,to_warehouse:_0x201e6f,ToRoom_name:_0x5b82be,prod_name:_0x1dd141,from_prod_qty:_0x5a9d5a,from_prod_level:_0x2f1136,from_prod_isle:_0x44d8a8,from_prod_pallet:_0x1acb5c,to_prod_qty:_0x1c5f36,to_prod_level:_0xbf3856,to_prod_isle:_0x3f7a15,to_prod_pallet:_0x365f3e,primary_code:_0x1cfd68,secondary_code:_0x3e14cf,product_code3:_0x1a9e93,note:_0x438613,invoice:_0x2f82b8,expiry_date:_0x124b58}=_0x48f6fb['body'];if(typeof _0x1dd141==_0x2abb31(0x1f7))var _0x1d3b40=[_0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x1d1)]],_0x484209=[_0x48f6fb['body'][_0x2abb31(0x205)]],_0x400f85=[_0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x24b)]],_0x45d21a=[_0x48f6fb['body'][_0x2abb31(0x20a)]],_0x111bb3=[_0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x20b)]],_0x5df9ec=[_0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x276)]],_0x35f262=[_0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x26a)]],_0x1b2f96=[_0x48f6fb[_0x2abb31(0x25d)]['product_code3']],_0x271e4d=[_0x48f6fb[_0x2abb31(0x25d)]['MaxStocks_data2']],_0x266517=[_0x48f6fb['body'][_0x2abb31(0x1d8)]],_0x19e5cc=[_0x48f6fb['body'][_0x2abb31(0x1ca)]],_0x2afc44=[_0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x283)]],_0x5660e0=[_0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x23e)]];else var _0x1d3b40=[..._0x48f6fb[_0x2abb31(0x25d)]['prod_name']],_0x484209=[..._0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x205)]],_0x400f85=[..._0x48f6fb['body'][_0x2abb31(0x24b)]],_0x45d21a=[..._0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x20a)]],_0x111bb3=[..._0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x20b)]],_0x5df9ec=[..._0x48f6fb[_0x2abb31(0x25d)]['primary_code']],_0x35f262=[..._0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x26a)]],_0x1b2f96=[..._0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x203)]],_0x271e4d=[..._0x48f6fb[_0x2abb31(0x25d)]['MaxStocks_data2']],_0x266517=[..._0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x1d8)]],_0x19e5cc=[..._0x48f6fb[_0x2abb31(0x25d)][_0x2abb31(0x1ca)]],_0x2afc44=[..._0x48f6fb['body'][_0x2abb31(0x283)]],_0x5660e0=[..._0x48f6fb['body'][_0x2abb31(0x23e)]];const _0x5f59e1=_0x1d3b40[_0x2abb31(0x1f3)](_0xae30dc=>{return _0xae30dc={'product_name':_0xae30dc};});_0x484209['forEach']((_0x223cf9,_0x5590e6)=>{_0x5f59e1[_0x5590e6]['from_quantity']=_0x223cf9;}),_0x400f85[_0x2abb31(0x1b8)]((_0x17743e,_0x170418)=>{var _0x2e6289=_0x2abb31;_0x5f59e1[_0x170418][_0x2e6289(0x1bd)]=_0x17743e;}),_0x45d21a[_0x2abb31(0x1b8)]((_0x123e7f,_0xf6a1b7)=>{var _0x23cb12=_0x2abb31;_0x5f59e1[_0xf6a1b7][_0x23cb12(0x1fe)]=_0x123e7f;}),_0x111bb3['forEach']((_0x521b65,_0x4e70b8)=>{var _0x208ee5=_0x2abb31;_0x5f59e1[_0x4e70b8][_0x208ee5(0x299)]=_0x521b65;}),_0x5df9ec[_0x2abb31(0x1b8)]((_0x4313ba,_0x626b86)=>{var _0x305d51=_0x2abb31;_0x5f59e1[_0x626b86][_0x305d51(0x276)]=_0x4313ba;}),_0x35f262[_0x2abb31(0x1b8)]((_0x376ad6,_0x4d6580)=>{var _0xccc34=_0x2abb31;_0x5f59e1[_0x4d6580][_0xccc34(0x26a)]=_0x376ad6;}),_0x1b2f96['forEach']((_0x2de1d9,_0x4389f6)=>{var _0x9f73f5=_0x2abb31;_0x5f59e1[_0x4389f6][_0x9f73f5(0x251)]=_0x2de1d9;}),_0x271e4d[_0x2abb31(0x1b8)]((_0x21eb11,_0x7b2262)=>{_0x5f59e1[_0x7b2262]['maxProducts']=_0x21eb11;}),_0x266517[_0x2abb31(0x1b8)]((_0x5aa215,_0x15f941)=>{var _0x568542=_0x2abb31;_0x5f59e1[_0x15f941][_0x568542(0x1d8)]=_0x5aa215;}),_0x19e5cc[_0x2abb31(0x1b8)]((_0x7a4c34,_0x2ee215)=>{_0x5f59e1[_0x2ee215]['secondary_unit']=_0x7a4c34;}),_0x2afc44['forEach']((_0x15df25,_0x4dc509)=>{var _0x588615=_0x2abb31;_0x5f59e1[_0x4dc509][_0x588615(0x283)]=_0x15df25;}),_0x5660e0[_0x2abb31(0x1b8)]((_0x5dcd7e,_0x4b50de)=>{var _0x31a26c=_0x2abb31;_0x5f59e1[_0x4b50de][_0x31a26c(0x23e)]=_0x5dcd7e;});const _0x5d8fd2=_0x5f59e1[_0x2abb31(0x207)](_0x3bf4fc=>_0x3bf4fc[_0x2abb31(0x1fe)]!=='0'&&_0x3bf4fc['to_quantity']!==''||_0x3bf4fc[_0x2abb31(0x1df)]!=='0'&&_0x3bf4fc[_0x2abb31(0x1df)]!=='');var _0x124532=0x0;_0x5d8fd2[_0x2abb31(0x1b8)](_0xc9d3d4=>{var _0x54cd2b=_0x2abb31;parseInt(_0xc9d3d4['from_quantity'])<parseInt(_0xc9d3d4[_0x54cd2b(0x1fe)])&&_0x124532++;});if(_0x124532!=0x0)return _0x48f6fb[_0x2abb31(0x1c6)](_0x2abb31(0x1b7),_0x2abb31(0x233)),_0x162b76['redirect'](_0x2abb31(0x1cf));const _0x4d91d5=await warehouse['findOne']({'name':_0x3f2a2d[_0x2abb31(0x235)],'room':_0x3f2a2d[_0x2abb31(0x27c)]});_0x3f2a2d['product'][_0x2abb31(0x1b8)](_0x4eeae4=>{var _0x25fb59=_0x2abb31;if(_0x4eeae4[_0x25fb59(0x1fe)]>0x0){const _0x213ddf=_0x4d91d5[_0x25fb59(0x1d4)][_0x25fb59(0x1f3)](_0x44e09e=>{var _0x4559a9=_0x25fb59;_0x44e09e[_0x4559a9(0x25c)]==_0x4eeae4['product_name']&&_0x44e09e[_0x4559a9(0x280)]==_0x4eeae4[_0x4559a9(0x1bd)]&&(_0x44e09e[_0x4559a9(0x28f)]=parseInt(_0x44e09e[_0x4559a9(0x28f)])+parseInt(_0x4eeae4[_0x4559a9(0x1fe)]));});}}),await _0x4d91d5[_0x2abb31(0x21b)]();const _0x32ac97=await warehouse[_0x2abb31(0x1ec)]({'name':_0x3f2a2d[_0x2abb31(0x255)],'room':_0x3f2a2d[_0x2abb31(0x1c4)]});_0x3f2a2d['product']['forEach'](_0x1161c9=>{var _0x3e62b2=_0x2abb31;if(_0x1161c9[_0x3e62b2(0x1fe)]>0x0){const _0x390742=_0x32ac97[_0x3e62b2(0x1d4)][_0x3e62b2(0x1f3)](_0x10f3a9=>{var _0xe25877=_0x3e62b2;_0x10f3a9[_0xe25877(0x25c)]==_0x1161c9['product_name']&&_0x10f3a9[_0xe25877(0x280)]==_0x1161c9['to_bay']&&(_0x10f3a9['product_stock']=parseInt(_0x10f3a9[_0xe25877(0x28f)])-parseInt(_0x1161c9[_0xe25877(0x1fe)]));});}}),await _0x32ac97[_0x2abb31(0x21b)](),_0x3f2a2d['date']=_0x1d6baa,_0x3f2a2d['from_warehouse']=_0x33d036,_0x3f2a2d[_0x2abb31(0x255)]=_0x201e6f,_0x3f2a2d[_0x2abb31(0x274)]=_0x5d8fd2,_0x3f2a2d[_0x2abb31(0x249)]=_0x438613,_0x3f2a2d[_0x2abb31(0x24e)]=_0x2f82b8;const _0x12e2ac=await _0x3f2a2d['save'](),_0x214319=await warehouse[_0x2abb31(0x1ec)]({'name':_0x33d036,'room':_0x582c75});_0x12e2ac[_0x2abb31(0x274)][_0x2abb31(0x1b8)](_0x38ce0d=>{var _0x243519=_0x2abb31;if(_0x38ce0d[_0x243519(0x1fe)]>0x0){const _0x3f1a85=_0x214319[_0x243519(0x1d4)]['map'](_0x43d78a=>{var _0x4b3cf7=_0x243519;_0x43d78a[_0x4b3cf7(0x25c)]==_0x38ce0d['product_name']&&_0x43d78a[_0x4b3cf7(0x280)]==_0x38ce0d[_0x4b3cf7(0x1bd)]&&(_0x43d78a[_0x4b3cf7(0x28f)]=parseInt(_0x43d78a[_0x4b3cf7(0x28f)])-parseInt(_0x38ce0d[_0x4b3cf7(0x1fe)]));});}}),await _0x214319['save']();const _0x57fc87=await warehouse[_0x2abb31(0x1ec)]({'name':_0x201e6f,'room':_0x5b82be});_0x12e2ac[_0x2abb31(0x274)][_0x2abb31(0x1b8)](_0x150202=>{var _0x2e60d7=_0x2abb31;if(_0x150202[_0x2e60d7(0x1fe)]>0x0){var _0x4fa897=0x0;const _0x2b1e90=_0x57fc87['product_details'][_0x2e60d7(0x1f3)](_0x1dbb16=>{var _0x5d8064=_0x2e60d7;_0x1dbb16[_0x5d8064(0x25c)]==_0x150202['product_name']&&_0x1dbb16[_0x5d8064(0x280)]==_0x150202['to_bay']&&(_0x1dbb16[_0x5d8064(0x28f)]=parseInt(_0x1dbb16[_0x5d8064(0x28f)])+parseInt(_0x150202[_0x5d8064(0x1fe)]),_0x4fa897++);});_0x4fa897=='0'&&(_0x57fc87['product_details']=_0x57fc87[_0x2e60d7(0x1d4)]['concat']({'product_name':_0x150202['product_name'],'product_stock':_0x150202[_0x2e60d7(0x1fe)],'bay':_0x150202['to_bay'],'product_code':_0x150202['product_code'],'primary_code':_0x150202[_0x2e60d7(0x276)],'secondary_code':_0x150202['secondary_code'],'maxProducts':_0x150202[_0x2e60d7(0x282)]}));}}),await _0x57fc87[_0x2abb31(0x21b)](),_0x48f6fb[_0x2abb31(0x1c6)]('success',_0x2abb31(0x1d9)),_0x162b76['redirect'](_0x2abb31(0x293));}catch(_0x439598){console[_0x2abb31(0x25b)](_0x439598);}}),router[a0_0x9364b6(0x26e)](a0_0x9364b6(0x1cc),async(_0x51bfd4,_0x5e591e)=>{const {FromWareHouse:_0x127e96,FromRoom:_0x14a138,ToWarehouse:_0x27b170,ToRoom:_0x106291,primary_code:_0x5dc53e,Roomslist:_0x24e6a0}=_0x51bfd4['body'],_0x536289=_0x24e6a0['split'](','),_0x34b9f1=[];async function _0x38c513(_0x4864d3){var _0x2d956a=a0_0x2620;const _0x4d4a9a=await warehouse['aggregate']([{'$match':{'name':_0x127e96,'room':_0x4864d3}},{'$unwind':_0x2d956a(0x211)},{'$match':{'product_details.primary_code':_0x5dc53e}},{'$group':{'_id':_0x2d956a(0x277),'name':{'$first':_0x2d956a(0x1ea)},'instock':{'$first':_0x2d956a(0x219)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2d956a(0x253)},'product_code':{'$first':_0x2d956a(0x1dc)},'level':{'$first':_0x2d956a(0x223)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x2d956a(0x269)},'unit':{'$first':_0x2d956a(0x242)},'secondary_unit':{'$first':_0x2d956a(0x23f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2d956a(0x21a)},'expiry_date':{'$first':_0x2d956a(0x252)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x2d956a(0x1b9)},'maxPerUnit':{'$first':_0x2d956a(0x1c2)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x5c154d=await warehouse[_0x2d956a(0x234)]([{'$match':{'name':_0x127e96,'room':_0x4864d3}},{'$unwind':_0x2d956a(0x211)},{'$match':{'product_details.secondary_code':_0x5dc53e}},{'$group':{'_id':_0x2d956a(0x277),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x2d956a(0x219)},'primary_code':{'$first':_0x2d956a(0x1f5)},'secondary_code':{'$first':_0x2d956a(0x253)},'product_code':{'$first':_0x2d956a(0x1dc)},'level':{'$first':_0x2d956a(0x223)},'isle':{'$first':_0x2d956a(0x202)},'type':{'$first':_0x2d956a(0x1f4)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2d956a(0x21a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2d956a(0x271)},'batch_code':{'$first':_0x2d956a(0x1b9)},'maxPerUnit':{'$first':_0x2d956a(0x1c2)},'roomNamed':{'$first':_0x2d956a(0x1bc)},'prod_cat':{'$first':'S'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x4d4a9a['length']>0x0)_0x34b9f1[_0x2d956a(0x297)](_0x4d4a9a);else _0x5c154d[_0x2d956a(0x1ee)]>0x0&&_0x34b9f1[_0x2d956a(0x297)](_0x5c154d);}const _0x256b88=_0x536289['map'](_0x49e049=>_0x38c513(_0x49e049));await Promise['all'](_0x256b88),_0x5e591e['json'](_0x34b9f1);}),router[a0_0x9364b6(0x26e)](a0_0x9364b6(0x241),async(_0x3d5e22,_0x302295)=>{var _0x5972fe=a0_0x9364b6;try{const {FromWareHouse:_0x249e52,FromRoom:_0x2e12e4,ToWarehouse:_0x3a19cf,ToRoom:_0x5db1bc,secondary_code:_0x10c9b0}=_0x3d5e22['body'],_0x5e3984=await warehouse[_0x5972fe(0x234)]([{'$match':{'name':_0x249e52}},{'$unwind':_0x5972fe(0x211)},{'$match':{'product_details.secondary_code':_0x10c9b0}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5972fe(0x1ea)},'primary_code':{'$first':_0x5972fe(0x1f5)},'secondary_code':{'$first':_0x5972fe(0x253)},'product_code':{'$first':_0x5972fe(0x1dc)},'instock':{'$first':_0x5972fe(0x219)},'warehouse':{'$first':_0x5972fe(0x239)},'level':{'$first':_0x5972fe(0x1e1)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x5972fe(0x262)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x5972fe(0x242)},'expiry_date':{'$first':_0x5972fe(0x252)},'production_date':{'$first':_0x5972fe(0x271)}}}]);_0x302295['status'](0xc8)[_0x5972fe(0x1f2)](_0x5e3984);}catch(_0x229a3f){_0x302295[_0x5972fe(0x20e)](0x194)[_0x5972fe(0x1f2)]({'message':_0x229a3f[_0x5972fe(0x1be)]});}}),router[a0_0x9364b6(0x26e)](a0_0x9364b6(0x220),async(_0x877732,_0x5a3654)=>{var _0x1205cc=a0_0x9364b6;try{const {FromWareHouse:_0x4643cf,FromRoom:_0xe24d9c,ToWarehouse:_0x37101b,ToRoom:_0x36ee0a,product_code:_0x420078}=_0x877732[_0x1205cc(0x25d)],_0x4f94b4=await warehouse[_0x1205cc(0x234)]([{'$match':{'name':_0x4643cf}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x420078}},{'$group':{'_id':_0x1205cc(0x277),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x1205cc(0x1f5)},'secondary_code':{'$first':_0x1205cc(0x253)},'product_code':{'$first':_0x1205cc(0x1dc)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x1205cc(0x239)},'level':{'$first':_0x1205cc(0x1e1)},'isle':{'$first':_0x1205cc(0x230)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x1205cc(0x275)},'unit':{'$first':_0x1205cc(0x242)}}}]);_0x5a3654[_0x1205cc(0x20e)](0xc8)[_0x1205cc(0x1f2)](_0x4f94b4);}catch(_0x266e2a){_0x5a3654[_0x1205cc(0x20e)](0x194)[_0x1205cc(0x1f2)]({'message':_0x266e2a[_0x1205cc(0x1be)]});}}),router[a0_0x9364b6(0x26e)](a0_0x9364b6(0x290),async(_0x2ff47a,_0x377098)=>{var _0x1fed92=a0_0x9364b6;const {productCode:_0x4d3ec1,bay:_0x5d71e0,warehouses:_0x76aa4c,room:_0x2b27a3}=_0x2ff47a[_0x1fed92(0x25d)];console[_0x1fed92(0x25b)](_0x2ff47a['body']);try{const _0x546050=await warehouse[_0x1fed92(0x234)]([{'$match':{'name':_0x76aa4c,'room':_0x2b27a3}},{'$unwind':_0x1fed92(0x211)},{'$match':{'product_details.bay':parseInt(_0x5d71e0)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1fed92(0x1ea)},'product_stock':{'$first':_0x1fed92(0x219)},'bay':{'$first':_0x1fed92(0x223)},'maxProducts':{'$first':_0x1fed92(0x275)}}}]);_0x377098[_0x1fed92(0x20e)](0xc8)[_0x1fed92(0x1f2)](_0x546050);}catch(_0x5d0e7c){_0x377098['status'](0x194)[_0x1fed92(0x1f2)]({'message':_0x5d0e7c['message']});}}),module[a0_0x9364b6(0x28a)]=router;