var a0_0x5906c3=a0_0x25e3;(function(_0x190672,_0x46d0ba){var _0xd2d85=a0_0x25e3,_0x4bbe15=_0x190672();while(!![]){try{var _0x3f3316=-parseInt(_0xd2d85(0x286))/0x1+parseInt(_0xd2d85(0x254))/0x2*(parseInt(_0xd2d85(0x290))/0x3)+parseInt(_0xd2d85(0x25e))/0x4*(parseInt(_0xd2d85(0x239))/0x5)+-parseInt(_0xd2d85(0x292))/0x6*(parseInt(_0xd2d85(0x28e))/0x7)+-parseInt(_0xd2d85(0x214))/0x8*(parseInt(_0xd2d85(0x23c))/0x9)+parseInt(_0xd2d85(0x268))/0xa+parseInt(_0xd2d85(0x1cb))/0xb;if(_0x3f3316===_0x46d0ba)break;else _0x4bbe15['push'](_0x4bbe15['shift']());}catch(_0xeb1371){_0x4bbe15['push'](_0x4bbe15['shift']());}}}(a0_0x1136,0x1a893));const express=require(a0_0x5906c3(0x1e5)),app=express(),router=express[a0_0x5906c3(0x1cd)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x5906c3(0x1df)),auth=require(a0_0x5906c3(0x21e)),users=require(a0_0x5906c3(0x251)),nodemailer=require(a0_0x5906c3(0x24e));function a0_0x25e3(_0x454d5d,_0x388e47){var _0x1136ad=a0_0x1136();return a0_0x25e3=function(_0x25e38e,_0x537e4d){_0x25e38e=_0x25e38e-0x1b2;var _0x44b829=_0x1136ad[_0x25e38e];return _0x44b829;},a0_0x25e3(_0x454d5d,_0x388e47);}router[a0_0x5906c3(0x276)](a0_0x5906c3(0x282),auth,async(_0x38ab7b,_0x510a30)=>{var _0x526fc0=a0_0x5906c3;try{const {username:_0x12c732,email:_0x41f079,role:_0x4b637a}=_0x38ab7b[_0x526fc0(0x1fd)],_0x558c07=_0x38ab7b[_0x526fc0(0x1fd)],_0x4e351c=await profile[_0x526fc0(0x21c)]({'email':_0x558c07[_0x526fc0(0x1d2)]}),_0x47cff2=await master_shop['find']();let _0x383d07;if(_0x558c07[_0x526fc0(0x20e)]==_0x526fc0(0x212)){const _0x6be6e=await staff[_0x526fc0(0x21c)]({'email':_0x558c07['email']});_0x383d07=await transfers_finished[_0x526fc0(0x23a)]({'from_warehouse':_0x6be6e[_0x526fc0(0x1fc)]});}else _0x383d07=await transfers_finished['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x526fc0(0x28a),'invoice':{'$first':'$invoice'},'date':{'$first':_0x526fc0(0x280)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x526fc0(0x26d)},'from_room_name':{'$addToSet':_0x526fc0(0x262)},'to_room_name':{'$addToSet':_0x526fc0(0x1bc)},'finalize':{'$first':_0x526fc0(0x1f7)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x47cff2[0x0]['language']=='English\x20(US)')var _0xca7c43=users[_0x526fc0(0x1f2)];else{if(_0x47cff2[0x0]['language']==_0x526fc0(0x1e2))var _0xca7c43=users[_0x526fc0(0x1e2)];else{if(_0x47cff2[0x0][_0x526fc0(0x1d4)]==_0x526fc0(0x205))var _0xca7c43=users[_0x526fc0(0x205)];else{if(_0x47cff2[0x0][_0x526fc0(0x1d4)]==_0x526fc0(0x1c7))var _0xca7c43=users[_0x526fc0(0x1c7)];else{if(_0x47cff2[0x0]['language']==_0x526fc0(0x1b4))var _0xca7c43=users['French'];else{if(_0x47cff2[0x0][_0x526fc0(0x1d4)]=='Portuguese\x20(BR)')var _0xca7c43=users[_0x526fc0(0x234)];else{if(_0x47cff2[0x0][_0x526fc0(0x1d4)]==_0x526fc0(0x223))var _0xca7c43=users[_0x526fc0(0x223)];else{if(_0x47cff2[0x0]['language']==_0x526fc0(0x269))var _0xca7c43=users[_0x526fc0(0x1e6)];}}}}}}}_0x510a30[_0x526fc0(0x1b2)](_0x526fc0(0x1d5),{'success':_0x38ab7b[_0x526fc0(0x27d)]('success'),'errors':_0x38ab7b[_0x526fc0(0x27d)]('errors'),'role':_0x558c07,'profile':_0x4e351c,'master_shop':_0x47cff2,'transfer':_0x383d07,'language':_0xca7c43});}catch(_0x234341){console[_0x526fc0(0x1ec)](_0x234341);}});async function getRandom8DigitNumber(){var _0xa063c8=a0_0x5906c3;const _0x19782e=0x989680,_0x5f2407=0x5f5e0ff,_0x353f9f=Math[_0xa063c8(0x233)](Math['random']()*(_0x5f2407-_0x19782e+0x1))+_0x19782e;var _0x5ae596;const _0x7f71fb=await transfers_finished[_0xa063c8(0x21c)]({'invoice':_0xa063c8(0x257)+_0x353f9f});return _0x7f71fb&&_0x7f71fb[_0xa063c8(0x278)]>0x0?_0x5ae596=_0xa063c8(0x257)+_0x353f9f:_0x5ae596='TRFF-'+_0x353f9f,_0x5ae596;}router['get']('/view/add_transfer',auth,async(_0x2f1700,_0x4ccce8)=>{var _0x4e8506=a0_0x5906c3;try{const {username:_0x2068b6,email:_0x392e91,role:_0x551ad0}=_0x2f1700[_0x4e8506(0x1fd)],_0x259ae2=_0x2f1700[_0x4e8506(0x1fd)],_0x3f0593=await profile[_0x4e8506(0x21c)]({'email':_0x259ae2[_0x4e8506(0x1d2)]}),_0x408732=await master_shop[_0x4e8506(0x23a)]();let _0x197b71;if(_0x259ae2[_0x4e8506(0x20e)]==_0x4e8506(0x212)){const _0x152a9e=await staff[_0x4e8506(0x21c)]({'email':_0x259ae2['email']});_0x197b71=await warehouse[_0x4e8506(0x1ff)]([{'$match':{'status':_0x4e8506(0x1c9),'name':_0x152a9e[_0x4e8506(0x1fc)],'warehouse_category':_0x4e8506(0x218),'name':{'$ne':_0x4e8506(0x201)}}},{'$group':{'_id':_0x4e8506(0x273),'name':{'$first':_0x4e8506(0x273)}}}]);}else _0x197b71=await warehouse[_0x4e8506(0x1ff)]([{'$match':{'status':_0x4e8506(0x1c9),'warehouse_category':_0x4e8506(0x218),'name':{'$ne':_0x4e8506(0x201)}}},{'$group':{'_id':'$name','name':{'$first':_0x4e8506(0x273)}}}]);const _0x377f58=await transfers_finished['find']({}),_0x25db1f=_0x377f58['length']+0x1,_0x475956=_0x4e8506(0x257)+_0x25db1f[_0x4e8506(0x28f)]()[_0x4e8506(0x1e8)](0x5,'0');if(_0x408732[0x0][_0x4e8506(0x1d4)]==_0x4e8506(0x225))var _0x4b360f=users[_0x4e8506(0x1f2)];else{if(_0x408732[0x0][_0x4e8506(0x1d4)]==_0x4e8506(0x1e2))var _0x4b360f=users[_0x4e8506(0x1e2)];else{if(_0x408732[0x0][_0x4e8506(0x1d4)]=='German')var _0x4b360f=users[_0x4e8506(0x205)];else{if(_0x408732[0x0][_0x4e8506(0x1d4)]==_0x4e8506(0x1c7))var _0x4b360f=users['Spanish'];else{if(_0x408732[0x0][_0x4e8506(0x1d4)]==_0x4e8506(0x1b4))var _0x4b360f=users[_0x4e8506(0x1b4)];else{if(_0x408732[0x0][_0x4e8506(0x1d4)]==_0x4e8506(0x279))var _0x4b360f=users['Portuguese'];else{if(_0x408732[0x0][_0x4e8506(0x1d4)]=='Chinese')var _0x4b360f=users[_0x4e8506(0x223)];else{if(_0x408732[0x0][_0x4e8506(0x1d4)]==_0x4e8506(0x269))var _0x4b360f=users['Arabic'];}}}}}}}const _0x4bc7a9=getRandom8DigitNumber();_0x4bc7a9[_0x4e8506(0x1ba)](_0x589cb0=>{var _0xe378f0=_0x4e8506;_0x4ccce8[_0xe378f0(0x1b2)](_0xe378f0(0x27c),{'success':_0x2f1700[_0xe378f0(0x27d)](_0xe378f0(0x221)),'errors':_0x2f1700[_0xe378f0(0x27d)]('errors'),'role':_0x259ae2,'profile':_0x3f0593,'master_shop':_0x408732,'warehouse':_0x197b71,'language':_0x4b360f,'invoice':_0x589cb0});})['catch'](_0x14e8d2=>{var _0x524965=_0x4e8506;_0x2f1700['flash'](_0x524965(0x224),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x4ccce8[_0x524965(0x1d1)]('/transfer/view');});}catch(_0x48509a){console[_0x4e8506(0x1ec)](_0x48509a);}}),router['post']('/view/add_transfer',auth,async(_0x3b3a2a,_0x1787a4)=>{var _0x221e63=a0_0x5906c3;try{const {date:_0x20fea2,from_warehouse:_0x241372,FromRoom_name:_0x35ab1e,to_warehouse:_0x2ba099,ToRoom_name:_0x41f7c5,prod_name:_0xe55f99,from_prod_qty:_0x2a7db3,from_prod_level:_0x4b674,from_prod_isle:_0x592ed3,from_prod_pallet:_0x4c190a,to_prod_qty:_0x64109d,to_prod_level:_0xd71af6,to_prod_isle:_0x532ea9,to_prod_pallet:_0xe2c6bf,primary_code:_0x11494c,secondary_code:_0x285763,product_code3:_0x4ea81f,note:_0x4f7b76,MaxStocks_data2:_0x446fdb,invoice:_0x47d066,expiry_date:_0xc647d}=_0x3b3a2a[_0x221e63(0x22a)];if(typeof _0xe55f99==_0x221e63(0x235))var _0x38d005=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x23b)]],_0xea2c7d=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x22e)]],_0x141f06=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1c1)]],_0x21ed3f=[_0x3b3a2a['body']['New_Qty_Converted']],_0x274f1d=[_0x3b3a2a[_0x221e63(0x22a)]['to_prod_level']],_0x3a2806=[_0x3b3a2a['body'][_0x221e63(0x287)]],_0x154afa=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x22c)]],_0x4fbf2e=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x27b)]],_0x257c8f=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1fa)]],_0x9cbbcd=[_0x3b3a2a[_0x221e63(0x22a)]['primary_unit']],_0x50bb0a=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x26b)]],_0x2901a3=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1d6)]],_0x5b8e9a=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x277)]],_0x33d4ce=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x240)]],_0x464ee4=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x261)]],_0xff00f1=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x253)]],_0x2e1fe2=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x26e)]],_0x22dba8=[_0x3b3a2a[_0x221e63(0x22a)]['RoomAssigned']],_0x165266=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1f6)]],_0x5500b1=[_0x3b3a2a[_0x221e63(0x22a)]['from_invoice']],_0x98f354=[_0x3b3a2a['body'][_0x221e63(0x222)]],_0x5c54fc=[_0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x208)]];else var _0x38d005=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x23b)]],_0xea2c7d=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x22e)]],_0x141f06=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1c1)]],_0x21ed3f=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x23e)]],_0x274f1d=[..._0x3b3a2a[_0x221e63(0x22a)]['to_prod_level']],_0x3a2806=[..._0x3b3a2a['body'][_0x221e63(0x287)]],_0x154afa=[..._0x3b3a2a['body'][_0x221e63(0x22c)]],_0x4fbf2e=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x27b)]],_0x257c8f=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1fa)]],_0x9cbbcd=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1f4)]],_0x50bb0a=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x26b)]],_0x2901a3=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x1d6)]],_0x5b8e9a=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x277)]],_0x33d4ce=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x240)]],_0x464ee4=[..._0x3b3a2a[_0x221e63(0x22a)]['MaxStocks_data']],_0xff00f1=[..._0x3b3a2a['body'][_0x221e63(0x253)]],_0x2e1fe2=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x26e)]],_0x22dba8=[..._0x3b3a2a['body'][_0x221e63(0x20b)]],_0x165266=[..._0x3b3a2a[_0x221e63(0x22a)]['ToRoomAssigned']],_0x5500b1=[..._0x3b3a2a[_0x221e63(0x22a)]['from_invoice']],_0x98f354=[..._0x3b3a2a[_0x221e63(0x22a)][_0x221e63(0x222)]],_0x5c54fc=[..._0x3b3a2a['body'][_0x221e63(0x208)]];const _0x370a50=_0x38d005[_0x221e63(0x270)](_0x443501=>{return _0x443501={'product_name':_0x443501};});_0xea2c7d['forEach']((_0x216df9,_0x1db3b2)=>{var _0x84f045=_0x221e63;_0x370a50[_0x1db3b2][_0x84f045(0x28c)]=_0x216df9;}),_0x141f06[_0x221e63(0x22d)]((_0x3e5baf,_0x56594c)=>{var _0x259727=_0x221e63;_0x370a50[_0x56594c][_0x259727(0x24c)]=_0x3e5baf;}),_0x5c54fc['forEach']((_0x1e08ec,_0x77c3f6)=>{var _0x2b200b=_0x221e63;_0x370a50[_0x77c3f6][_0x2b200b(0x208)]=_0x1e08ec;}),_0x5500b1['forEach']((_0x740b6,_0x32d83d)=>{var _0x562966=_0x221e63;_0x370a50[_0x32d83d][_0x562966(0x1b5)]=_0x740b6;}),_0x98f354[_0x221e63(0x22d)]((_0x5aa65e,_0x15804c)=>{_0x370a50[_0x15804c]['To_invoice']=_0x5aa65e;}),_0x21ed3f[_0x221e63(0x22d)]((_0x58bcf7,_0x49ea19)=>{var _0x296c8b=_0x221e63;_0x370a50[_0x49ea19][_0x296c8b(0x220)]=_0x58bcf7;}),_0x274f1d[_0x221e63(0x22d)]((_0x340a2a,_0x3cd8e9)=>{var _0xfa4da9=_0x221e63;_0x370a50[_0x3cd8e9][_0xfa4da9(0x1dd)]=_0x340a2a;}),_0x3a2806[_0x221e63(0x22d)]((_0x348171,_0x592e40)=>{var _0x993463=_0x221e63;_0x370a50[_0x592e40][_0x993463(0x287)]=_0x348171;}),_0x154afa[_0x221e63(0x22d)]((_0x57dcef,_0x319bb8)=>{var _0x99eb89=_0x221e63;_0x370a50[_0x319bb8][_0x99eb89(0x22c)]=_0x57dcef;}),_0x4fbf2e[_0x221e63(0x22d)]((_0x30b7b3,_0x63690)=>{var _0x41831b=_0x221e63;_0x370a50[_0x63690][_0x41831b(0x28d)]=_0x30b7b3;}),_0x257c8f[_0x221e63(0x22d)]((_0x2e2404,_0x47e2cd)=>{_0x370a50[_0x47e2cd]['maxProducts']=_0x2e2404;}),_0x9cbbcd[_0x221e63(0x22d)]((_0x2c313c,_0x1be6d5)=>{var _0x595335=_0x221e63;_0x370a50[_0x1be6d5][_0x595335(0x1de)]=_0x2c313c;}),_0x50bb0a['forEach']((_0x3a227b,_0x2d17df)=>{_0x370a50[_0x2d17df]['secondary_unit']=_0x3a227b;}),_0x2901a3[_0x221e63(0x22d)]((_0x2ac44a,_0x2c444)=>{var _0x2831c0=_0x221e63;_0x370a50[_0x2c444][_0x2831c0(0x1d6)]=_0x2ac44a;}),_0x5b8e9a[_0x221e63(0x22d)]((_0x5a1c70,_0x2d250a)=>{_0x370a50[_0x2d250a]['expiry_date']=_0x5a1c70;}),_0x33d4ce[_0x221e63(0x22d)]((_0x433ea6,_0x379be5)=>{_0x370a50[_0x379be5]['production_date']=_0x433ea6;}),_0x464ee4[_0x221e63(0x22d)]((_0x495d6b,_0x4414e5)=>{var _0x401381=_0x221e63;_0x370a50[_0x4414e5][_0x401381(0x1ef)]=_0x495d6b;}),_0xff00f1['forEach']((_0x4e7cf6,_0x1fda20)=>{_0x370a50[_0x1fda20]['maxPerUnit']=_0x4e7cf6;}),_0x2e1fe2[_0x221e63(0x22d)]((_0x4cce7a,_0x2dc2c1)=>{var _0x1ff47d=_0x221e63;_0x370a50[_0x2dc2c1][_0x1ff47d(0x26e)]=_0x4cce7a;}),_0x22dba8[_0x221e63(0x22d)]((_0x11615b,_0x151fa0)=>{_0x370a50[_0x151fa0]['from_room_name']=_0x11615b;}),_0x165266[_0x221e63(0x22d)]((_0x54ab9e,_0x2202e0)=>{var _0x107b82=_0x221e63;_0x370a50[_0x2202e0][_0x107b82(0x1bb)]=_0x54ab9e;});const _0x43c520=_0x370a50[_0x221e63(0x266)](_0x525e56=>_0x525e56[_0x221e63(0x220)]!=='0'&&_0x525e56['to_quantity']!==''||_0x525e56[_0x221e63(0x1e1)]!=='0'&&_0x525e56[_0x221e63(0x1e1)]!=='');var _0x1dc7e3=0x0;_0x43c520[_0x221e63(0x22d)](_0x414a75=>{var _0x4afe95=_0x221e63;parseInt(_0x414a75[_0x4afe95(0x28c)])<parseInt(_0x414a75['to_quantity'])&&_0x1dc7e3++;});if(_0x1dc7e3!=0x0)return _0x3b3a2a[_0x221e63(0x27d)](_0x221e63(0x224),_0x221e63(0x28b)),_0x1787a4[_0x221e63(0x1d1)](_0x221e63(0x237));const _0x14defd=new transfers_finished({'date':_0x20fea2,'from_warehouse':_0x241372,'to_warehouse':_0x2ba099,'product':_0x43c520,'note':_0x4f7b76,'invoice':_0x47d066}),_0x4742e2=await _0x14defd['save']();_0x3b3a2a[_0x221e63(0x27d)](_0x221e63(0x221),'Product\x20Transfer\x20successfully'),_0x1787a4[_0x221e63(0x1d1)](_0x221e63(0x264)+_0x4742e2[_0x221e63(0x1e7)]);}catch(_0x4b1933){console[_0x221e63(0x1ec)](_0x4b1933),_0x1787a4[_0x221e63(0x25c)](0xc8)['json']({'errorMessage':_0x4b1933[_0x221e63(0x20a)]});}}),router[a0_0x5906c3(0x276)](a0_0x5906c3(0x1f8),auth,async(_0x54f432,_0x158696)=>{var _0x2b5860=a0_0x5906c3;try{const {username:_0x37620a,email:_0x48da93,role:_0x50b8f9}=_0x54f432[_0x2b5860(0x1fd)],_0x263a06=_0x54f432[_0x2b5860(0x1fd)],_0x520a6e=await profile[_0x2b5860(0x21c)]({'email':_0x263a06[_0x2b5860(0x1d2)]}),_0x1c6a8a=await master_shop[_0x2b5860(0x23a)](),_0x42ed2f=await transfers_finished['findById'](_0x54f432[_0x2b5860(0x275)]['id']);let _0x565044;if(_0x263a06['role']=='staff'){const _0x57578b=await staff[_0x2b5860(0x21c)]({'email':_0x263a06[_0x2b5860(0x1d2)]});_0x565044=await warehouse['find']({'status':_0x2b5860(0x1c9),'name':_0x57578b[_0x2b5860(0x1fc)],'warehouse_category':_0x2b5860(0x218)});}else _0x565044=await warehouse[_0x2b5860(0x23a)]({'status':_0x2b5860(0x1c9),'warehouse_category':_0x2b5860(0x218)});const _0x17face=await warehouse[_0x2b5860(0x1ff)]([{'$match':{'name':_0x42ed2f[_0x2b5860(0x1e9)],'warehouse_category':_0x2b5860(0x218)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2b5860(0x211),'name':{'$first':_0x2b5860(0x247)},'product_stock':{'$first':_0x2b5860(0x20d)},'bay':{'$first':_0x2b5860(0x24b)},'bin':{'$first':_0x2b5860(0x1ee)},'type':{'$first':_0x2b5860(0x1dc)},'floorlevel':{'$first':_0x2b5860(0x1e0)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2b5860(0x26a)},'product_code':{'$first':_0x2b5860(0x22f)},'storage':{'$first':_0x2b5860(0x255)},'rack':{'$first':_0x2b5860(0x250)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2b5860(0x229)},'room':{'$first':'$room'},'warehoue_name':{'$first':'$name'}}}]),_0x1d805b=await product[_0x2b5860(0x23a)]({});if(_0x1c6a8a[0x0][_0x2b5860(0x1d4)]==_0x2b5860(0x225)){var _0x5a49ca=users[_0x2b5860(0x1f2)];console['log'](_0x5a49ca);}else{if(_0x1c6a8a[0x0][_0x2b5860(0x1d4)]==_0x2b5860(0x1e2))var _0x5a49ca=users[_0x2b5860(0x1e2)];else{if(_0x1c6a8a[0x0][_0x2b5860(0x1d4)]==_0x2b5860(0x205))var _0x5a49ca=users['German'];else{if(_0x1c6a8a[0x0][_0x2b5860(0x1d4)]==_0x2b5860(0x1c7))var _0x5a49ca=users[_0x2b5860(0x1c7)];else{if(_0x1c6a8a[0x0][_0x2b5860(0x1d4)]=='French')var _0x5a49ca=users['French'];else{if(_0x1c6a8a[0x0]['language']==_0x2b5860(0x279))var _0x5a49ca=users[_0x2b5860(0x234)];else{if(_0x1c6a8a[0x0]['language']=='Chinese')var _0x5a49ca=users[_0x2b5860(0x223)];else{if(_0x1c6a8a[0x0][_0x2b5860(0x1d4)]==_0x2b5860(0x269))var _0x5a49ca=users[_0x2b5860(0x1e6)];}}}}}}}_0x158696[_0x2b5860(0x1b2)](_0x2b5860(0x1b9),{'success':_0x54f432[_0x2b5860(0x27d)](_0x2b5860(0x221)),'errors':_0x54f432[_0x2b5860(0x27d)](_0x2b5860(0x224)),'role':_0x263a06,'profile':_0x520a6e,'master_shop':_0x1c6a8a,'warehouse':_0x565044,'transfer':_0x42ed2f,'stock':_0x17face,'unit':_0x1d805b,'language':_0x5a49ca});}catch(_0x105cde){console[_0x2b5860(0x1ec)](_0x105cde);}}),router[a0_0x5906c3(0x27f)](a0_0x5906c3(0x1f8),auth,async(_0x8001f5,_0x4d158f)=>{var _0x1fe10f=a0_0x5906c3;try{const {invoice:_0x26940a,from_warehouse:_0x55974e,FromRoom_name:_0x4414c2,to_warehouse:_0x45b071,ToRoom_name:_0x12dead}=_0x8001f5[_0x1fe10f(0x22a)],_0x4a9da4=await transfers_finished[_0x1fe10f(0x21f)](_0x8001f5[_0x1fe10f(0x275)]['id']),_0x47d0ed=_0x4a9da4[_0x1fe10f(0x228)][_0x1fe10f(0x270)](async _0x56ba64=>{var _0x1107a7=_0x1fe10f;if(_0x56ba64[_0x1107a7(0x220)]>0x0){var _0x156ba7=await warehouse[_0x1107a7(0x21c)]({'name':_0x55974e,'room':_0x56ba64['from_room_name'],'warehouse_category':_0x1107a7(0x218)});const _0x23be6b=_0x156ba7[_0x1107a7(0x232)]['map'](_0x3d826d=>{var _0x3576c4=_0x1107a7;_0x3d826d['product_name']==_0x56ba64[_0x3576c4(0x216)]&&_0x3d826d[_0x3576c4(0x1f0)]==_0x56ba64[_0x3576c4(0x24c)]&&_0x3d826d[_0x3576c4(0x277)]==_0x56ba64['expiry_date']&&_0x3d826d[_0x3576c4(0x265)]==_0x56ba64[_0x3576c4(0x265)]&&_0x3d826d[_0x3576c4(0x1d6)]==_0x56ba64[_0x3576c4(0x1d6)]&&_0x3d826d['invoice']==_0x56ba64[_0x3576c4(0x1b5)]&&(console['log'](_0x3576c4(0x1e4),_0x3d826d['product_stock']),typeof _0x56ba64[_0x3576c4(0x208)]==_0x3576c4(0x21a)?_0x3d826d[_0x3576c4(0x204)]=Math[_0x3576c4(0x1d0)](0x0,Math['abs'](_0x3d826d[_0x3576c4(0x204)])-Math[_0x3576c4(0x274)](_0x56ba64['to_quantity'])):_0x3d826d['product_stock']=Math['max'](0x0,Math[_0x3576c4(0x274)](_0x3d826d[_0x3576c4(0x204)])-Math[_0x3576c4(0x274)](_0x56ba64[_0x3576c4(0x220)])));});}return _0x156ba7;});Promise['all'](_0x47d0ed)[_0x1fe10f(0x1ba)](async _0x3b86ba=>{var _0x2b929c=_0x1fe10f;try{for(const _0x5ba0e7 of _0x3b86ba){await _0x5ba0e7[_0x2b929c(0x21b)]();}const _0x82b6b4=_0x4a9da4[_0x2b929c(0x228)][_0x2b929c(0x270)](async _0x2f1d6f=>{var _0x21531c=_0x2b929c,_0x11a291=await warehouse[_0x21531c(0x21c)]({'name':_0x45b071,'room':_0x2f1d6f[_0x21531c(0x1bb)]});if(_0x2f1d6f[_0x21531c(0x220)]>0x0){var _0x4e7177=0x0;const _0x2151be=_0x11a291['product_details'][_0x21531c(0x270)](_0x285aa9=>{var _0x4ef59e=_0x21531c;_0x285aa9['product_name']==_0x2f1d6f['product_name']&&_0x285aa9['bay']==_0x2f1d6f[_0x4ef59e(0x1dd)]&&_0x285aa9['expiry_date']==_0x2f1d6f[_0x4ef59e(0x277)]&&_0x285aa9[_0x4ef59e(0x265)]==_0x2f1d6f[_0x4ef59e(0x265)]&&_0x285aa9['batch_code']==_0x2f1d6f[_0x4ef59e(0x1d6)]&&_0x285aa9['invoice']==_0x2f1d6f[_0x4ef59e(0x1d7)]&&(typeof _0x2f1d6f[_0x4ef59e(0x208)]=='undefined'?(console[_0x4ef59e(0x1ec)]('here2',_0x285aa9[_0x4ef59e(0x204)]+_0x4ef59e(0x1c6)+_0x285aa9[_0x4ef59e(0x1e7)]+'\x20<=>\x20'+Math[_0x4ef59e(0x274)](_0x285aa9[_0x4ef59e(0x204)])+Math[_0x4ef59e(0x274)](_0x2f1d6f[_0x4ef59e(0x220)])),_0x285aa9[_0x4ef59e(0x204)]=Math[_0x4ef59e(0x274)](_0x285aa9[_0x4ef59e(0x204)])+Math[_0x4ef59e(0x274)](_0x2f1d6f[_0x4ef59e(0x220)])):_0x285aa9[_0x4ef59e(0x204)]=Math[_0x4ef59e(0x274)](_0x285aa9[_0x4ef59e(0x204)])+Math[_0x4ef59e(0x274)](_0x2f1d6f[_0x4ef59e(0x220)]),_0x4e7177++);});_0x4e7177=='0'&&(_0x11a291[_0x21531c(0x232)]=_0x11a291['product_details'][_0x21531c(0x226)]({'product_name':_0x2f1d6f['product_name'],'product_stock':_0x2f1d6f[_0x21531c(0x220)],'bay':_0x2f1d6f[_0x21531c(0x1dd)],'product_code':_0x2f1d6f[_0x21531c(0x28d)],'primary_code':_0x2f1d6f['primary_code'],'secondary_code':_0x2f1d6f['secondary_code'],'expiry_date':_0x2f1d6f[_0x21531c(0x277)],'production_date':_0x2f1d6f['production_date'],'maxProducts':_0x2f1d6f[_0x21531c(0x1ef)],'batch_code':_0x2f1d6f[_0x21531c(0x1d6)],'secondary_unit':_0x2f1d6f['secondary_unit'],'unit':_0x2f1d6f[_0x21531c(0x1de)],'maxProducts':_0x2f1d6f[_0x21531c(0x1ef)],'maxPerUnit':_0x2f1d6f['maxPerUnit'],'invoice':_0x2f1d6f['To_invoice']}));}return _0x11a291;});Promise['all'](_0x82b6b4)[_0x2b929c(0x1ba)](async _0x40ae05=>{var _0xe5c7ae=_0x2b929c;try{for(const _0x53746c of _0x40ae05){await warehouse[_0xe5c7ae(0x285)]({'_id':_0x53746c[_0xe5c7ae(0x1e7)]},{'$addToSet':{'product_details':{'$each':_0x53746c[_0xe5c7ae(0x232)]}}});}_0x4a9da4[_0xe5c7ae(0x249)]='True';const _0x4c9ef1=await _0x4a9da4[_0xe5c7ae(0x21b)](),_0x53f174=await master_shop['find'](),_0x27505b=await email_settings[_0xe5c7ae(0x21c)](),_0x42d0ab=await supervisor_settings[_0xe5c7ae(0x23a)]();var _0x3681c1=_0x4a9da4['product'],_0x5e7697='',_0x1fd5eb;for(_0x1fd5eb in _0x3681c1){var _0x9c3de='FG';_0x4a9da4[_0xe5c7ae(0x230)]==_0xe5c7ae(0x22b)&&(_0x9c3de='DG'),_0x5e7697+=_0xe5c7ae(0x243)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3681c1[_0x1fd5eb][_0xe5c7ae(0x216)]+_0xe5c7ae(0x1e3)+_0xe5c7ae(0x1da)+_0x3681c1[_0x1fd5eb]['product_code']+'</td>'+_0xe5c7ae(0x1da)+_0x3681c1[_0x1fd5eb][_0xe5c7ae(0x220)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3681c1[_0x1fd5eb]['unit']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3681c1[_0x1fd5eb][_0xe5c7ae(0x26b)]+'</td>'+_0xe5c7ae(0x1da)+_0x4a9da4[_0xe5c7ae(0x230)]+_0xe5c7ae(0x1e3)+_0xe5c7ae(0x1da)+_0x3681c1[_0x1fd5eb][_0xe5c7ae(0x1bb)]+_0xe5c7ae(0x1e3)+_0xe5c7ae(0x1da)+_0x9c3de+_0x3681c1[_0x1fd5eb][_0xe5c7ae(0x1dd)]+_0xe5c7ae(0x1e3)+'</tr>';}let _0xb5c9e2=nodemailer['createTransport']({'host':_0x27505b[_0xe5c7ae(0x24a)],'port':Number(_0x27505b[_0xe5c7ae(0x25b)]),'secure':![],'auth':{'user':_0x27505b[_0xe5c7ae(0x1d2)],'pass':_0x27505b[_0xe5c7ae(0x236)]}}),_0x504e15={'from':_0x27505b[_0xe5c7ae(0x1d2)],'to':_0x42d0ab[0x0][_0xe5c7ae(0x1c2)],'subject':_0xe5c7ae(0x267),'attachments':[{'filename':_0xe5c7ae(0x24f),'path':__dirname+'/../public'+_0xe5c7ae(0x1c5)+_0x53f174[0x0]['image'],'cid':_0xe5c7ae(0x1eb)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0xe5c7ae(0x1d3)+_0xe5c7ae(0x284)+_0xe5c7ae(0x1f9)+_0xe5c7ae(0x284)+_0xe5c7ae(0x200)+_0xe5c7ae(0x203)+_0xe5c7ae(0x284)+_0xe5c7ae(0x1bf)+_0x53f174[0x0][_0xe5c7ae(0x281)]+_0xe5c7ae(0x27e)+_0xe5c7ae(0x203)+_0xe5c7ae(0x203)+_0xe5c7ae(0x271)+_0xe5c7ae(0x284)+_0xe5c7ae(0x1cf)+_0xe5c7ae(0x219)+_0x4a9da4[_0xe5c7ae(0x272)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0xe5c7ae(0x256)+_0x4a9da4[_0xe5c7ae(0x241)]+'\x20'+_0xe5c7ae(0x1cc)+'</h5>'+_0xe5c7ae(0x203)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0xe5c7ae(0x25a)+_0xe5c7ae(0x243)+_0xe5c7ae(0x26c)+_0xe5c7ae(0x293)+_0xe5c7ae(0x283)+_0xe5c7ae(0x27a)+_0xe5c7ae(0x1fe)+_0xe5c7ae(0x24d)+_0xe5c7ae(0x1d8)+_0xe5c7ae(0x258)+_0xe5c7ae(0x202)+'</thead>'+_0xe5c7ae(0x1c4)+'\x20'+_0x5e7697+'\x20'+_0xe5c7ae(0x294)+_0xe5c7ae(0x1ce)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0xe5c7ae(0x210)+_0x53f174[0x0]['site_title']+_0xe5c7ae(0x260)+_0xe5c7ae(0x203)+'</div>'+_0xe5c7ae(0x289)};_0xb5c9e2[_0xe5c7ae(0x1c0)](_0x504e15,function(_0x1741ff,_0xa1f61){var _0x147265=_0xe5c7ae;_0x1741ff?(console[_0x147265(0x1ec)](_0x1741ff),console[_0x147265(0x1ec)](_0x147265(0x1be))):console[_0x147265(0x1ec)](_0x147265(0x248));}),_0x8001f5[_0xe5c7ae(0x27d)](_0xe5c7ae(0x221),_0xe5c7ae(0x206)),_0x4d158f[_0xe5c7ae(0x1d1)](_0xe5c7ae(0x288)+_0x4c9ef1[_0xe5c7ae(0x1e7)]);}catch(_0x3339f7){console['error'](_0x3339f7),_0x4d158f[_0xe5c7ae(0x25c)](0x1f4)[_0xe5c7ae(0x252)]({'error':_0xe5c7ae(0x263)});}})[_0x2b929c(0x244)](_0x318855=>{var _0x34c81b=_0x2b929c;console[_0x34c81b(0x1f1)](_0x318855),_0x4d158f['status'](0x1f4)[_0x34c81b(0x252)]({'error':'An\x20error\x20occurred.'});});}catch(_0x2bc102){console['error'](_0x2bc102),_0x4d158f[_0x2b929c(0x25c)](0x1f4)[_0x2b929c(0x252)]({'error':_0x2b929c(0x245)});}})[_0x1fe10f(0x244)](_0x4bf87c=>{var _0x9e6c7b=_0x1fe10f;console[_0x9e6c7b(0x1f1)](_0x4bf87c),_0x4d158f[_0x9e6c7b(0x25c)](0x1f4)[_0x9e6c7b(0x252)]({'error':'An\x20error\x20occurred.'});});}catch(_0x1ac590){_0x4d158f[_0x1fe10f(0x252)]({'message':_0x1ac590['message']});}});function BayBinSelected(_0x411da0,_0x47aa1a){var _0x1bf689=a0_0x5906c3,_0x4742c1=[];let _0x5e71a3=[];var _0x4fef20=[];if(_0x411da0==_0x1bf689(0x22b)){switch(_0x47aa1a){case _0x1bf689(0x1f3):_0x4742c1=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x1bf689(0x1f5):_0x4742c1=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x4fef20=['DG'];}else{if(_0x411da0==_0x1bf689(0x291)){switch(_0x47aa1a){case _0x1bf689(0x1f3):_0x4742c1=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x1bf689(0x1f5):_0x4742c1=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x4fef20=['FG'];}}return{'levels':_0x4742c1,'identify':_0x4fef20};}function a0_0x1136(){var _0x134ea=['flash','\x20</h2>','post','$date','site_title','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<div>','updateOne','150587kzWJxs','primary_code','/picking_list/PDF_transfer/','</body></html>','$_id','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','from_quantity','product_code','684390AsBuhJ','toString','3CHePvu','FROZEN\x20GOODS','6brZaRv','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','</tbody>','render','getMonth','French','from_invoice','edit_transfer_finished','to_room','/CheckingWarehouse','edit_transfer_finished_view','then','to_room_name','$product.to_room_name','to_prod_qty','Error\x20Occurs','<h2>\x20','sendMail','from_prod_level','FGSEmail','$product_details','<tbody\x20style=\x22text-align:\x20center;\x22>','/upload/','\x20<>\x20','Spanish','note','Enabled','Transfer\x20Edit\x20Successfully','3068989itjMsB','</span>','Router','</table>','<h5\x20style=\x22text-align:\x20left;\x22>','max','redirect','email','</head><body>','language','transfer_finished','batch_code','To_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Ambient','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Enclosed','$product_details.type','to_bay','unit','../models/all_models','$product_details.floorlevel','to_floorlevel','Hindi','</td>','here1','express','Arabic','_id','padStart','from_warehouse','exports','logo','log','$product_details.batch_code','$product_details.bin','maxProducts','bay','error','English','Rack\x201','primary_unit','Rack\x202','ToRoomAssigned','$finalize','/preview/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','MaxStocks_data2','$product_details.primary_code','warehouse','user','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','aggregate','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','QA\x20Warehouse','</tr>','</div>','product_stock','German','Transfer\x20Finalize\x20Successfully','$room','id_transaction','/transfer_finished/view','message','RoomAssigned','/barcode_scanner3','$product_details.product_stock','role','$product_details.isle','<h5>','$product_details._id','staff','split','1396616SKiBcx','$product_details.level','product_name','getFullYear','Finished\x20Goods','\x20Order\x20Number\x20:\x20','undefined','save','findOne','getDate','../middleware/auth','findById','to_quantity','success','to_invoice','Chinese','errors','English\x20(US)','concat','/view/:id','product','$product_details.production_date','body','DRY\x20GOODS','secondary_code','forEach','from_prod_qty','$product_details.product_code','to_warehouse','/barcode_scanner','product_details','floor','Portuguese','string','password','back','$product_details.maxProducts','14045ljhuhR','find','prod_name','9swCRhI','$product_details.secondary_unit','New_Qty_Converted','$product_details.unit','product_date','date','/barcode_scanner2','<tr>','catch','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.expiry_date','$product_details.product_name','Email\x20sent\x20successfully','finalize','host','$product_details.bay','from_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','nodemailer','Logo.png','$product_details.rack','../public/language/languages.json','json','maxPerUnit','19200PyuEHz','$product_details.storage','\x20Order\x20Date\x20:\x20','TRFF-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','to_prod_level','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','port','status','slice','232fGzatH','transfer_data','</h5>','MaxStocks_data','$product.from_room_name','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','/transfer_finished/preview/','production_date','filter','Transfer\x20Mail','801040AtXQMx','Arabic\x20(ae)','$product_details.secondary_code','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$to_warehouse','prod_cat','$product_details.pallet','map','<hr\x20class=\x22my-3\x22>','invoice','$name','abs','params','get','expiry_date','length','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','product_code3','add_transfer_finished'];a0_0x1136=function(){return _0x134ea;};return a0_0x1136();}router[a0_0x5906c3(0x276)](a0_0x5906c3(0x227),auth,async(_0x563830,_0x506ea8)=>{var _0x3ea9bc=a0_0x5906c3;try{const {username:_0x36a54c,email:_0x1d0202,role:_0x22daa0}=_0x563830[_0x3ea9bc(0x1fd)],_0x19b869=_0x563830[_0x3ea9bc(0x1fd)],_0x4a6297=await profile[_0x3ea9bc(0x21c)]({'email':_0x19b869[_0x3ea9bc(0x1d2)]}),_0x10d212=await master_shop['find'](),_0x159101=await transfers_finished[_0x3ea9bc(0x21f)](_0x563830[_0x3ea9bc(0x275)]['id']);let _0x13f98e=new Date(_0x159101[_0x3ea9bc(0x277)]),_0x5693d7=('0'+_0x13f98e[_0x3ea9bc(0x21d)]())[_0x3ea9bc(0x25d)](-0x2),_0x37b67b=('0'+(_0x13f98e[_0x3ea9bc(0x1b3)]()+0x1))[_0x3ea9bc(0x25d)](-0x2),_0x357b9e=_0x13f98e[_0x3ea9bc(0x217)](),_0x23eb81=_0x357b9e+'-'+_0x37b67b+'-'+_0x5693d7,_0x3c9d81;if(_0x19b869[_0x3ea9bc(0x20e)]==_0x3ea9bc(0x212)){const _0x1af9e6=await staff[_0x3ea9bc(0x21c)]({'email':_0x19b869['email']});_0x3c9d81=await warehouse[_0x3ea9bc(0x23a)]({'status':_0x3ea9bc(0x1c9),'name':_0x1af9e6[_0x3ea9bc(0x1fc)],'warehouse_category':_0x3ea9bc(0x218)});}else _0x3c9d81=await warehouse['find']({'status':_0x3ea9bc(0x1c9),'warehouse_category':'Finished\x20Goods'});const _0x4a4d25=await warehouse[_0x3ea9bc(0x1ff)]([{'$match':{'name':_0x159101[_0x3ea9bc(0x1e9)],'room':_0x159101['from_room']}},{'$unwind':_0x3ea9bc(0x1c3)},{'$group':{'_id':_0x3ea9bc(0x211),'name':{'$first':_0x3ea9bc(0x247)},'product_stock':{'$first':_0x3ea9bc(0x20d)},'bay':{'$first':_0x3ea9bc(0x24b)},'bin':{'$first':_0x3ea9bc(0x1ee)},'type':{'$first':_0x3ea9bc(0x1dc)},'floorlevel':{'$first':_0x3ea9bc(0x1e0)},'primary_code':{'$first':_0x3ea9bc(0x1fb)},'secondary_code':{'$first':_0x3ea9bc(0x26a)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3ea9bc(0x250)}}}]);var _0x4eff70=[0x1,0x2,0x3,0x4],_0x3e9e49=['A','B','C','D','E','F','G','H','I','J'],_0x4a4716=[_0x3ea9bc(0x1d9),_0x3ea9bc(0x1db)];const _0x235e5a=await product[_0x3ea9bc(0x23a)]({}),_0x2dd712=BayBinSelected(_0x159101[_0x3ea9bc(0x230)],_0x159101['to_room']);if(_0x10d212[0x0]['language']==_0x3ea9bc(0x225)){var _0x21d327=users[_0x3ea9bc(0x1f2)];console[_0x3ea9bc(0x1ec)](_0x21d327);}else{if(_0x10d212[0x0][_0x3ea9bc(0x1d4)]=='Hindi')var _0x21d327=users[_0x3ea9bc(0x1e2)];else{if(_0x10d212[0x0][_0x3ea9bc(0x1d4)]==_0x3ea9bc(0x205))var _0x21d327=users[_0x3ea9bc(0x205)];else{if(_0x10d212[0x0][_0x3ea9bc(0x1d4)]=='Spanish')var _0x21d327=users['Spanish'];else{if(_0x10d212[0x0][_0x3ea9bc(0x1d4)]==_0x3ea9bc(0x1b4))var _0x21d327=users['French'];else{if(_0x10d212[0x0][_0x3ea9bc(0x1d4)]==_0x3ea9bc(0x279))var _0x21d327=users[_0x3ea9bc(0x234)];else{if(_0x10d212[0x0][_0x3ea9bc(0x1d4)]==_0x3ea9bc(0x223))var _0x21d327=users[_0x3ea9bc(0x223)];else{if(_0x10d212[0x0][_0x3ea9bc(0x1d4)]==_0x3ea9bc(0x269))var _0x21d327=users[_0x3ea9bc(0x1e6)];}}}}}}}_0x506ea8[_0x3ea9bc(0x1b2)](_0x3ea9bc(0x1b6),{'success':_0x563830[_0x3ea9bc(0x27d)]('success'),'errors':_0x563830['flash'](_0x3ea9bc(0x224)),'role':_0x19b869,'profile':_0x4a6297,'master_shop':_0x10d212,'warehouse':_0x3c9d81,'transfer':_0x159101,'stock':_0x4a4d25,'unit':_0x235e5a,'language':_0x21d327,'levels':_0x4eff70,'Isle':_0x3e9e49,'rooms_data':_0x4a4716,'ed_fullDate':_0x23eb81,'dataSelected':_0x2dd712});}catch(_0x326ae2){console['log'](_0x326ae2);}}),router['post'](a0_0x5906c3(0x227),auth,async(_0x5ec881,_0x2abe21)=>{var _0x1e753d=a0_0x5906c3;try{const _0x1967e8=_0x5ec881[_0x1e753d(0x275)]['id'];console[_0x1e753d(0x1ec)](_0x5ec881[_0x1e753d(0x22a)]);const _0x4ecb7d=await transfers_finished['findById'](_0x1967e8);console[_0x1e753d(0x1ec)](_0x1e753d(0x25f),_0x4ecb7d);const {date:_0x34223c,from_warehouse:_0x1f27a1,FromRoom_name:_0x107c50,to_warehouse:_0x47b641,ToRoom_name:_0x5320b8,prod_name:_0x5b0822,from_prod_qty:_0x58f6ee,from_prod_level:_0x2ea78f,from_prod_isle:_0xd54e85,from_prod_pallet:_0x1fa6a2,to_prod_qty:_0x32fca1,to_prod_level:_0x30f367,to_prod_isle:_0x2a81d9,to_prod_pallet:_0x3d223c,primary_code:_0x32753f,secondary_code:_0x4afe7e,product_code3:_0x676eb2,note:_0x3309cd,invoice:_0x5eca22,expiry_date:_0x308076}=_0x5ec881[_0x1e753d(0x22a)];if(typeof _0x5b0822==_0x1e753d(0x235))var _0x13acbf=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x23b)]],_0x20e301=[_0x5ec881['body'][_0x1e753d(0x22e)]],_0x3db744=[_0x5ec881[_0x1e753d(0x22a)]['from_prod_level']],_0x2911b8=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x1bd)]],_0x3917ab=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x259)]],_0x1615d8=[_0x5ec881['body']['primary_code']],_0x11243b=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x22c)]],_0x42ef57=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x27b)]],_0x5952e5=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x1fa)]],_0x38a97a=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x1de)]],_0x398575=[_0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x26b)]],_0x455271=[_0x5ec881[_0x1e753d(0x22a)]['batch_code']],_0x24df5a=[_0x5ec881['body'][_0x1e753d(0x277)]];else var _0x13acbf=[..._0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x23b)]],_0x20e301=[..._0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x22e)]],_0x3db744=[..._0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x1c1)]],_0x2911b8=[..._0x5ec881['body']['to_prod_qty']],_0x3917ab=[..._0x5ec881['body'][_0x1e753d(0x259)]],_0x1615d8=[..._0x5ec881[_0x1e753d(0x22a)]['primary_code']],_0x11243b=[..._0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x22c)]],_0x42ef57=[..._0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x27b)]],_0x5952e5=[..._0x5ec881[_0x1e753d(0x22a)]['MaxStocks_data2']],_0x38a97a=[..._0x5ec881['body'][_0x1e753d(0x1de)]],_0x398575=[..._0x5ec881[_0x1e753d(0x22a)]['secondary_unit']],_0x455271=[..._0x5ec881[_0x1e753d(0x22a)][_0x1e753d(0x1d6)]],_0x24df5a=[..._0x5ec881[_0x1e753d(0x22a)]['expiry_date']];const _0xdea1d5=_0x13acbf[_0x1e753d(0x270)](_0x14a67a=>{return _0x14a67a={'product_name':_0x14a67a};});_0x20e301[_0x1e753d(0x22d)]((_0x1eb1ee,_0x4dc7f2)=>{var _0x420ad9=_0x1e753d;_0xdea1d5[_0x4dc7f2][_0x420ad9(0x28c)]=_0x1eb1ee;}),_0x3db744[_0x1e753d(0x22d)]((_0x381fe9,_0x2f0def)=>{_0xdea1d5[_0x2f0def]['from_bay']=_0x381fe9;}),_0x2911b8[_0x1e753d(0x22d)]((_0x2499db,_0x45af2b)=>{var _0x18298a=_0x1e753d;_0xdea1d5[_0x45af2b][_0x18298a(0x220)]=_0x2499db;}),_0x3917ab[_0x1e753d(0x22d)]((_0x4cfc79,_0x44ebee)=>{var _0x439dfa=_0x1e753d;_0xdea1d5[_0x44ebee][_0x439dfa(0x1dd)]=_0x4cfc79;}),_0x1615d8[_0x1e753d(0x22d)]((_0x50f305,_0x234cf3)=>{_0xdea1d5[_0x234cf3]['primary_code']=_0x50f305;}),_0x11243b[_0x1e753d(0x22d)]((_0x81efda,_0x4fbbcd)=>{_0xdea1d5[_0x4fbbcd]['secondary_code']=_0x81efda;}),_0x42ef57['forEach']((_0x3f06b4,_0x1922af)=>{_0xdea1d5[_0x1922af]['product_code']=_0x3f06b4;}),_0x5952e5['forEach']((_0x22c8c6,_0xaa0a7b)=>{var _0x5ed601=_0x1e753d;_0xdea1d5[_0xaa0a7b][_0x5ed601(0x1ef)]=_0x22c8c6;}),_0x38a97a[_0x1e753d(0x22d)]((_0x384ab7,_0x7eb67e)=>{var _0x475f7b=_0x1e753d;_0xdea1d5[_0x7eb67e][_0x475f7b(0x1de)]=_0x384ab7;}),_0x398575[_0x1e753d(0x22d)]((_0x5ae000,_0x5b0683)=>{var _0xc3e84f=_0x1e753d;_0xdea1d5[_0x5b0683][_0xc3e84f(0x26b)]=_0x5ae000;}),_0x455271['forEach']((_0x59c2a2,_0x5d8e65)=>{var _0x5d7dcd=_0x1e753d;_0xdea1d5[_0x5d8e65][_0x5d7dcd(0x1d6)]=_0x59c2a2;}),_0x24df5a[_0x1e753d(0x22d)]((_0x4fba46,_0x305187)=>{var _0xc6d6eb=_0x1e753d;_0xdea1d5[_0x305187][_0xc6d6eb(0x277)]=_0x4fba46;});const _0x21c5eb=_0xdea1d5['filter'](_0x19895d=>_0x19895d[_0x1e753d(0x220)]!=='0'&&_0x19895d[_0x1e753d(0x220)]!==''||_0x19895d[_0x1e753d(0x1e1)]!=='0'&&_0x19895d['to_floorlevel']!=='');var _0x4b9e10=0x0;_0x21c5eb['forEach'](_0x153b9d=>{var _0x213d92=_0x1e753d;parseInt(_0x153b9d[_0x213d92(0x28c)])<parseInt(_0x153b9d[_0x213d92(0x220)])&&_0x4b9e10++;});if(_0x4b9e10!=0x0)return _0x5ec881[_0x1e753d(0x27d)](_0x1e753d(0x224),_0x1e753d(0x28b)),_0x2abe21[_0x1e753d(0x1d1)](_0x1e753d(0x237));const _0x17b1d4=await warehouse[_0x1e753d(0x21c)]({'name':_0x4ecb7d[_0x1e753d(0x1e9)],'room':_0x4ecb7d['from_room']});_0x4ecb7d['product'][_0x1e753d(0x22d)](_0xda973b=>{var _0x2853e7=_0x1e753d;if(_0xda973b[_0x2853e7(0x220)]>0x0){const _0x508ab9=_0x17b1d4[_0x2853e7(0x232)][_0x2853e7(0x270)](_0x1dcd2a=>{var _0x15c215=_0x2853e7;_0x1dcd2a[_0x15c215(0x216)]==_0xda973b[_0x15c215(0x216)]&&_0x1dcd2a[_0x15c215(0x1f0)]==_0xda973b[_0x15c215(0x24c)]&&(_0x1dcd2a[_0x15c215(0x204)]=parseInt(_0x1dcd2a[_0x15c215(0x204)])+parseInt(_0xda973b[_0x15c215(0x220)]));});}}),await _0x17b1d4[_0x1e753d(0x21b)]();const _0x4166de=await warehouse[_0x1e753d(0x21c)]({'name':_0x4ecb7d[_0x1e753d(0x230)],'room':_0x4ecb7d[_0x1e753d(0x1b7)]});_0x4ecb7d[_0x1e753d(0x228)][_0x1e753d(0x22d)](_0x5b0245=>{var _0x645bc1=_0x1e753d;if(_0x5b0245[_0x645bc1(0x220)]>0x0){const _0xc3a1a9=_0x4166de['product_details'][_0x645bc1(0x270)](_0x32bd44=>{var _0x446a85=_0x645bc1;_0x32bd44[_0x446a85(0x216)]==_0x5b0245[_0x446a85(0x216)]&&_0x32bd44[_0x446a85(0x1f0)]==_0x5b0245[_0x446a85(0x1dd)]&&(_0x32bd44[_0x446a85(0x204)]=parseInt(_0x32bd44[_0x446a85(0x204)])-parseInt(_0x5b0245['to_quantity']));});}}),await _0x4166de['save'](),_0x4ecb7d[_0x1e753d(0x241)]=_0x34223c,_0x4ecb7d[_0x1e753d(0x1e9)]=_0x1f27a1,_0x4ecb7d['to_warehouse']=_0x47b641,_0x4ecb7d[_0x1e753d(0x228)]=_0x21c5eb,_0x4ecb7d[_0x1e753d(0x1c8)]=_0x3309cd,_0x4ecb7d[_0x1e753d(0x272)]=_0x5eca22;const _0x26ba92=await _0x4ecb7d[_0x1e753d(0x21b)](),_0x6341e7=await warehouse[_0x1e753d(0x21c)]({'name':_0x1f27a1,'room':_0x107c50});_0x26ba92['product'][_0x1e753d(0x22d)](_0xe89868=>{var _0x12356f=_0x1e753d;if(_0xe89868[_0x12356f(0x220)]>0x0){const _0x34d5d8=_0x6341e7['product_details'][_0x12356f(0x270)](_0x4d879e=>{var _0x1c8f4f=_0x12356f;_0x4d879e[_0x1c8f4f(0x216)]==_0xe89868[_0x1c8f4f(0x216)]&&_0x4d879e['bay']==_0xe89868[_0x1c8f4f(0x24c)]&&(_0x4d879e[_0x1c8f4f(0x204)]=parseInt(_0x4d879e['product_stock'])-parseInt(_0xe89868[_0x1c8f4f(0x220)]));});}}),await _0x6341e7[_0x1e753d(0x21b)]();const _0x16ce5a=await warehouse[_0x1e753d(0x21c)]({'name':_0x47b641,'room':_0x5320b8});_0x26ba92[_0x1e753d(0x228)][_0x1e753d(0x22d)](_0x5ee766=>{var _0x5832f9=_0x1e753d;if(_0x5ee766[_0x5832f9(0x220)]>0x0){var _0x3f4e18=0x0;const _0x1a64aa=_0x16ce5a[_0x5832f9(0x232)][_0x5832f9(0x270)](_0x3167d2=>{var _0x32135b=_0x5832f9;_0x3167d2[_0x32135b(0x216)]==_0x5ee766['product_name']&&_0x3167d2[_0x32135b(0x1f0)]==_0x5ee766[_0x32135b(0x1dd)]&&(_0x3167d2[_0x32135b(0x204)]=parseInt(_0x3167d2[_0x32135b(0x204)])+parseInt(_0x5ee766[_0x32135b(0x220)]),_0x3f4e18++);});_0x3f4e18=='0'&&(_0x16ce5a[_0x5832f9(0x232)]=_0x16ce5a[_0x5832f9(0x232)][_0x5832f9(0x226)]({'product_name':_0x5ee766[_0x5832f9(0x216)],'product_stock':_0x5ee766[_0x5832f9(0x220)],'bay':_0x5ee766[_0x5832f9(0x1dd)],'product_code':_0x5ee766[_0x5832f9(0x28d)],'primary_code':_0x5ee766['primary_code'],'secondary_code':_0x5ee766[_0x5832f9(0x22c)],'maxProducts':_0x5ee766[_0x5832f9(0x1ef)]}));}}),await _0x16ce5a['save'](),_0x5ec881[_0x1e753d(0x27d)](_0x1e753d(0x221),_0x1e753d(0x1ca)),_0x2abe21[_0x1e753d(0x1d1)](_0x1e753d(0x209));}catch(_0x46f4bb){console[_0x1e753d(0x1ec)](_0x46f4bb);}}),router['post'](a0_0x5906c3(0x231),async(_0x36fe49,_0x27b304)=>{var _0x305958=a0_0x5906c3;const {FromWareHouse:_0x50ae78,FromRoom:_0x16660c,ToWarehouse:_0x54bc55,ToRoom:_0x33c091,primary_code:_0x3b306a,Roomslist:_0x1aa1f5}=_0x36fe49[_0x305958(0x22a)],_0x305a02=_0x1aa1f5[_0x305958(0x213)](','),_0x8f569a=[];async function _0x316c61(_0x420b42){var _0x39b45e=_0x305958;const _0x100d3f=await warehouse['aggregate']([{'$match':{'name':_0x50ae78,'room':_0x420b42}},{'$unwind':_0x39b45e(0x1c3)},{'$match':{'product_details.primary_code':_0x3b306a}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x39b45e(0x247)},'instock':{'$first':_0x39b45e(0x20d)},'primary_code':{'$first':_0x39b45e(0x1fb)},'secondary_code':{'$first':_0x39b45e(0x26a)},'product_code':{'$first':_0x39b45e(0x22f)},'level':{'$first':_0x39b45e(0x24b)},'isle':{'$first':_0x39b45e(0x1ee)},'type':{'$first':_0x39b45e(0x1dc)},'pallet':{'$first':_0x39b45e(0x1e0)},'unit':{'$first':_0x39b45e(0x23f)},'secondary_unit':{'$first':_0x39b45e(0x23d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x39b45e(0x246)},'production_date':{'$first':_0x39b45e(0x229)},'batch_code':{'$first':_0x39b45e(0x1ed)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x39b45e(0x207)},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x4b1306=await warehouse[_0x39b45e(0x1ff)]([{'$match':{'name':_0x50ae78,'room':_0x420b42}},{'$unwind':_0x39b45e(0x1c3)},{'$match':{'product_details.secondary_code':_0x3b306a}},{'$group':{'_id':_0x39b45e(0x211),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x39b45e(0x20d)},'primary_code':{'$first':_0x39b45e(0x1fb)},'secondary_code':{'$first':_0x39b45e(0x26a)},'product_code':{'$first':_0x39b45e(0x22f)},'level':{'$first':_0x39b45e(0x24b)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x39b45e(0x1dc)},'pallet':{'$first':_0x39b45e(0x1e0)},'unit':{'$first':_0x39b45e(0x23f)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x39b45e(0x255)},'rack':{'$first':_0x39b45e(0x250)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x39b45e(0x1ed)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x100d3f[_0x39b45e(0x278)]>0x0)_0x8f569a['push'](_0x100d3f);else _0x4b1306[_0x39b45e(0x278)]>0x0&&_0x8f569a['push'](_0x4b1306);}const _0x23d301=_0x305a02['map'](_0x1f2992=>_0x316c61(_0x1f2992));await Promise['all'](_0x23d301),_0x27b304[_0x305958(0x252)](_0x8f569a);}),router[a0_0x5906c3(0x27f)](a0_0x5906c3(0x242),async(_0x3d8a6b,_0x29721e)=>{var _0x421a5f=a0_0x5906c3;try{const {FromWareHouse:_0x5efbd1,FromRoom:_0x564f1c,ToWarehouse:_0x237b41,ToRoom:_0xe5dfa7,secondary_code:_0x32a875}=_0x3d8a6b['body'],_0x3ed445=await warehouse[_0x421a5f(0x1ff)]([{'$match':{'name':_0x5efbd1}},{'$unwind':_0x421a5f(0x1c3)},{'$match':{'product_details.secondary_code':_0x32a875}},{'$group':{'_id':_0x421a5f(0x211),'name':{'$first':_0x421a5f(0x247)},'primary_code':{'$first':_0x421a5f(0x1fb)},'secondary_code':{'$first':_0x421a5f(0x26a)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x421a5f(0x20d)},'warehouse':{'$first':_0x421a5f(0x273)},'level':{'$first':_0x421a5f(0x215)},'isle':{'$first':_0x421a5f(0x20f)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x421a5f(0x238)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':_0x421a5f(0x246)},'production_date':{'$first':_0x421a5f(0x229)}}}]);_0x29721e['status'](0xc8)[_0x421a5f(0x252)](_0x3ed445);}catch(_0x308d36){_0x29721e[_0x421a5f(0x25c)](0x194)[_0x421a5f(0x252)]({'message':_0x308d36[_0x421a5f(0x20a)]});}}),router[a0_0x5906c3(0x27f)](a0_0x5906c3(0x20c),async(_0x3720c8,_0x4a109d)=>{var _0xdc6a6f=a0_0x5906c3;try{const {FromWareHouse:_0x319413,FromRoom:_0x1c50ee,ToWarehouse:_0x526ead,ToRoom:_0x58aac6,product_code:_0x48f18b}=_0x3720c8[_0xdc6a6f(0x22a)],_0xafb960=await warehouse[_0xdc6a6f(0x1ff)]([{'$match':{'name':_0x319413}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x48f18b}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xdc6a6f(0x247)},'primary_code':{'$first':_0xdc6a6f(0x1fb)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xdc6a6f(0x22f)},'instock':{'$first':_0xdc6a6f(0x20d)},'warehouse':{'$first':'$name'},'level':{'$first':_0xdc6a6f(0x215)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0xdc6a6f(0x26f)},'maxProducts':{'$first':_0xdc6a6f(0x238)},'unit':{'$first':_0xdc6a6f(0x23f)}}}]);_0x4a109d[_0xdc6a6f(0x25c)](0xc8)['json'](_0xafb960);}catch(_0x6e8f9f){_0x4a109d['status'](0x194)['json']({'message':_0x6e8f9f[_0xdc6a6f(0x20a)]});}}),router[a0_0x5906c3(0x27f)](a0_0x5906c3(0x1b8),async(_0x49e2e8,_0x54d0ec)=>{var _0x47e329=a0_0x5906c3;const {productCode:_0x2a6179,bay:_0x1afc6c,warehouses:_0x8ba8c5,room:_0x16202e}=_0x49e2e8[_0x47e329(0x22a)];console[_0x47e329(0x1ec)](_0x49e2e8[_0x47e329(0x22a)]);try{const _0x56edc4=await warehouse[_0x47e329(0x1ff)]([{'$match':{'name':_0x8ba8c5,'room':_0x16202e}},{'$unwind':_0x47e329(0x1c3)},{'$match':{'product_details.bay':parseInt(_0x1afc6c)}},{'$group':{'_id':_0x47e329(0x211),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x47e329(0x24b)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x54d0ec[_0x47e329(0x25c)](0xc8)[_0x47e329(0x252)](_0x56edc4);}catch(_0x1ceabe){_0x54d0ec['status'](0x194)[_0x47e329(0x252)]({'message':_0x1ceabe[_0x47e329(0x20a)]});}}),module[a0_0x5906c3(0x1ea)]=router;