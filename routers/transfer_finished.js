function a0_0x15b5(_0xd495a8,_0x10646d){var _0x3ba09a=a0_0x3ba0();return a0_0x15b5=function(_0x15b537,_0x1753e9){_0x15b537=_0x15b537-0x125;var _0x40ae46=_0x3ba09a[_0x15b537];return _0x40ae46;},a0_0x15b5(_0xd495a8,_0x10646d);}var a0_0x14a594=a0_0x15b5;(function(_0x496af1,_0x2f9b27){var _0x2205c0=a0_0x15b5,_0x473339=_0x496af1();while(!![]){try{var _0x4f580a=parseInt(_0x2205c0(0x176))/0x1+parseInt(_0x2205c0(0x17a))/0x2+-parseInt(_0x2205c0(0x172))/0x3*(parseInt(_0x2205c0(0x153))/0x4)+parseInt(_0x2205c0(0x164))/0x5*(parseInt(_0x2205c0(0x1f9))/0x6)+-parseInt(_0x2205c0(0x185))/0x7*(-parseInt(_0x2205c0(0x1aa))/0x8)+-parseInt(_0x2205c0(0x1ed))/0x9*(-parseInt(_0x2205c0(0x155))/0xa)+parseInt(_0x2205c0(0x1ff))/0xb*(-parseInt(_0x2205c0(0x151))/0xc);if(_0x4f580a===_0x2f9b27)break;else _0x473339['push'](_0x473339['shift']());}catch(_0x176aab){_0x473339['push'](_0x473339['shift']());}}}(a0_0x3ba0,0x26789));function a0_0x3ba0(){var _0x4f1b8f=['to_prod_level','padStart','$finalize','status','bay','to_warehouse','$product_details.secondary_unit','json','product','<strong>\x20Regards\x20</strong>','/barcode_scanner3','Arabic','logo','unit','prod_name','$product_details.bin','invoice','Router','/upload/','FROZEN\x20GOODS','$product_details.floorlevel','secondary_unit','from_bay','primary_unit','sendMail','$product_details._id','/../public','log','language','from_prod_qty','flash','Transfer\x20Mail','find','$product_details.secondary_code','catch','aggregate','ToRoomAssigned','role','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Logo.png','$product_details.production_date','get','$_id','36Tbgrna','$product_details.pallet','Transfer\x20Edit\x20Successfully','Hindi','$product_details','$product.to_room_name','from_room','An\x20error\x20occurred.','$product_details.bay','/transfer/view','string','map','501276zaAzip','German','</h5>','DRY\x20GOODS','$product_details.expiry_date','$room','209Bsxkxk','production_date','$product','$product_details.unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<div>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','updateOne','from_warehouse','FGSEmail','</tr>','Finished\x20Goods','<!DOCTYPE\x20html>','$product_details.level','French','$name','user','batch_code','An\x20error\x20occurred\x20while\x20saving\x20data.','staff','$to_warehouse','secondary_code','note','<h5>','English','Portuguese','$product.from_room_name','error','<h2>\x20','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<hr\x20class=\x22my-3\x22>','/view/add_transfer','/transfer_finished/view','</table>','Arabic\x20(ae)','$product_details.type','$product_details.primary_code','</thead>','post','$product_details.rack','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','random','body','toString','../models/all_models','/transfer_finished/preview/','to_invoice','True','95412AbtnRT','then','130716xgaMzp','back','200750RIlyjv','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','product_date','getDate','Portuguese\x20(BR)','message','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','warehouse','/CheckingWarehouse','MaxStocks_data2','New_Qty_Converted','params','primary_code','</head><body>','Ambient','5scOsUe','<table\x20style=\x22width:\x20100%\x20!important;\x22>','finalize','split','site_title','maxProducts','filter','$product_details.storage','<span\x20style=\x22float:\x20right;\x22>','$product_details.batch_code','password','<tr>','Spanish','../public/language/languages.json','15eqAobx','TRFF-','QA\x20Warehouse','floor','179325UpblPr','/preview/:id','$invoice','<h5\x20style=\x22text-align:\x20left;\x22>','222946zHRUdF','push','product_name','/view','/view/:id','to_prod_qty','to_quantity','English\x20(US)','expiry_date','product_code3','render','121779OECKEx','getMonth','maxPerUnit','concat','product_stock','from_quantity','to_bay','$product_details.isle','product_details','nodemailer','RoomAssigned','../middleware/auth','Enabled','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','all','redirect','Rack\x202','To_invoice','$product_details.product_code','</td>','Product\x20Transfer\x20successfully','Chinese','host','createTransport','edit_transfer_finished','from_prod_level','$product_details.invoice','product_code','add_transfer_finished','errors','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','email','Transfer\x20Finalize\x20Successfully','to_floorlevel','save','findById','forEach','8onxhvW','to_room_name','from_invoice','_id','$product_details.maxProducts','to_room','$date','success','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$product_details.product_stock','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Email\x20sent\x20successfully','findOne','from_room_name','slice','length','prod_cat','getFullYear','image','$from_warehouse','transfer_finished','$product_details.product_name','</div>'];a0_0x3ba0=function(){return _0x4f1b8f;};return a0_0x3ba0();}const express=require('express'),app=express(),router=express[a0_0x14a594(0x1d2)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x14a594(0x14d)),auth=require(a0_0x14a594(0x190)),users=require(a0_0x14a594(0x171)),nodemailer=require(a0_0x14a594(0x18e));router['get'](a0_0x14a594(0x17d),auth,async(_0xe23d,_0x1a6263)=>{var _0x31996f=a0_0x14a594;try{const {username:_0x2d798c,email:_0x26cd14,role:_0x3f66d0}=_0xe23d[_0x31996f(0x130)],_0x46a5d1=_0xe23d['user'],_0x28ac32=await profile[_0x31996f(0x1b6)]({'email':_0x46a5d1[_0x31996f(0x1a4)]}),_0x59f095=await master_shop[_0x31996f(0x1e1)]();let _0x311109;if(_0x46a5d1[_0x31996f(0x1e6)]==_0x31996f(0x133)){const _0x32cdac=await staff['findOne']({'email':_0x46a5d1[_0x31996f(0x1a4)]});_0x311109=await transfers_finished[_0x31996f(0x1e1)]({'from_warehouse':_0x32cdac[_0x31996f(0x15c)]});}else _0x311109=await transfers_finished[_0x31996f(0x1e4)]([{'$unwind':_0x31996f(0x201)},{'$group':{'_id':_0x31996f(0x1ec),'invoice':{'$first':_0x31996f(0x178)},'date':{'$first':_0x31996f(0x1b0)},'from_warehouse':{'$first':_0x31996f(0x1bd)},'to_warehouse':{'$first':_0x31996f(0x134)},'from_room_name':{'$addToSet':_0x31996f(0x13a)},'to_room_name':{'$addToSet':_0x31996f(0x1f2)},'finalize':{'$first':_0x31996f(0x1c3)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x59f095[0x0]['language']==_0x31996f(0x181))var _0x158ec4=users[_0x31996f(0x138)];else{if(_0x59f095[0x0][_0x31996f(0x1dd)]=='Hindi')var _0x158ec4=users[_0x31996f(0x1f0)];else{if(_0x59f095[0x0]['language']=='German')var _0x158ec4=users['German'];else{if(_0x59f095[0x0][_0x31996f(0x1dd)]==_0x31996f(0x170))var _0x158ec4=users[_0x31996f(0x170)];else{if(_0x59f095[0x0][_0x31996f(0x1dd)]=='French')var _0x158ec4=users['French'];else{if(_0x59f095[0x0][_0x31996f(0x1dd)]==_0x31996f(0x159))var _0x158ec4=users[_0x31996f(0x139)];else{if(_0x59f095[0x0][_0x31996f(0x1dd)]==_0x31996f(0x19a))var _0x158ec4=users[_0x31996f(0x19a)];else{if(_0x59f095[0x0][_0x31996f(0x1dd)]==_0x31996f(0x143))var _0x158ec4=users['Arabic'];}}}}}}}_0x1a6263[_0x31996f(0x184)](_0x31996f(0x1be),{'success':_0xe23d[_0x31996f(0x1df)](_0x31996f(0x1b1)),'errors':_0xe23d[_0x31996f(0x1df)](_0x31996f(0x1a2)),'role':_0x46a5d1,'profile':_0x28ac32,'master_shop':_0x59f095,'transfer':_0x311109,'language':_0x158ec4});}catch(_0x467275){console['log'](_0x467275);}});async function getRandom8DigitNumber(){var _0x440afd=a0_0x14a594;const _0x13cac3=0x989680,_0x4665ea=0x5f5e0ff,_0x229cdc=Math[_0x440afd(0x175)](Math[_0x440afd(0x14a)]()*(_0x4665ea-_0x13cac3+0x1))+_0x13cac3;var _0x1cc77b;const _0xf93ca3=await transfers_finished['findOne']({'invoice':_0x440afd(0x173)+_0x229cdc});return _0xf93ca3&&_0xf93ca3[_0x440afd(0x1b9)]>0x0?_0x1cc77b='TRFF-'+_0x229cdc:_0x1cc77b=_0x440afd(0x173)+_0x229cdc,_0x1cc77b;}router[a0_0x14a594(0x1eb)]('/view/add_transfer',auth,async(_0x24f6ca,_0x160492)=>{var _0x550c78=a0_0x14a594;try{const {username:_0x460016,email:_0xc39fec,role:_0x5b4e83}=_0x24f6ca[_0x550c78(0x130)],_0xc6262e=_0x24f6ca[_0x550c78(0x130)],_0x3985af=await profile[_0x550c78(0x1b6)]({'email':_0xc6262e[_0x550c78(0x1a4)]}),_0x32e542=await master_shop[_0x550c78(0x1e1)]();let _0x243c4c;if(_0xc6262e[_0x550c78(0x1e6)]==_0x550c78(0x133)){const _0x2c0f9e=await staff['findOne']({'email':_0xc6262e[_0x550c78(0x1a4)]});_0x243c4c=await warehouse[_0x550c78(0x1e4)]([{'$match':{'status':_0x550c78(0x191),'name':_0x2c0f9e['warehouse'],'warehouse_category':_0x550c78(0x12b),'name':{'$ne':_0x550c78(0x174)}}},{'$group':{'_id':_0x550c78(0x12f),'name':{'$first':_0x550c78(0x12f)}}}]);}else _0x243c4c=await warehouse[_0x550c78(0x1e4)]([{'$match':{'status':_0x550c78(0x191),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x550c78(0x174)}}},{'$group':{'_id':_0x550c78(0x12f),'name':{'$first':'$name'}}}]);const _0x5aaa94=await transfers_finished[_0x550c78(0x1e1)]({}),_0x43ea85=_0x5aaa94[_0x550c78(0x1b9)]+0x1,_0x24e9e6=_0x550c78(0x173)+_0x43ea85[_0x550c78(0x14c)]()[_0x550c78(0x1c2)](0x5,'0');if(_0x32e542[0x0][_0x550c78(0x1dd)]==_0x550c78(0x181))var _0x42b138=users[_0x550c78(0x138)];else{if(_0x32e542[0x0][_0x550c78(0x1dd)]=='Hindi')var _0x42b138=users[_0x550c78(0x1f0)];else{if(_0x32e542[0x0][_0x550c78(0x1dd)]=='German')var _0x42b138=users[_0x550c78(0x1fa)];else{if(_0x32e542[0x0][_0x550c78(0x1dd)]==_0x550c78(0x170))var _0x42b138=users[_0x550c78(0x170)];else{if(_0x32e542[0x0]['language']==_0x550c78(0x12e))var _0x42b138=users[_0x550c78(0x12e)];else{if(_0x32e542[0x0][_0x550c78(0x1dd)]==_0x550c78(0x159))var _0x42b138=users['Portuguese'];else{if(_0x32e542[0x0][_0x550c78(0x1dd)]==_0x550c78(0x19a))var _0x42b138=users[_0x550c78(0x19a)];else{if(_0x32e542[0x0]['language']==_0x550c78(0x143))var _0x42b138=users[_0x550c78(0x1cc)];}}}}}}}const _0x2c264f=getRandom8DigitNumber();_0x2c264f[_0x550c78(0x152)](_0x365357=>{var _0x589aef=_0x550c78;_0x160492['render'](_0x589aef(0x1a1),{'success':_0x24f6ca[_0x589aef(0x1df)](_0x589aef(0x1b1)),'errors':_0x24f6ca[_0x589aef(0x1df)](_0x589aef(0x1a2)),'role':_0xc6262e,'profile':_0x3985af,'master_shop':_0x32e542,'warehouse':_0x243c4c,'language':_0x42b138,'invoice':_0x365357});})['catch'](_0xfce4b3=>{var _0x5032dd=_0x550c78;_0x24f6ca[_0x5032dd(0x1df)](_0x5032dd(0x1a2),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x160492[_0x5032dd(0x194)](_0x5032dd(0x1f6));});}catch(_0x44450e){console[_0x550c78(0x1dc)](_0x44450e);}}),router[a0_0x14a594(0x147)](a0_0x14a594(0x140),auth,async(_0x53c3f0,_0x2de7ff)=>{var _0x1cc58c=a0_0x14a594;try{const {date:_0x6c9e65,from_warehouse:_0x1ae9c5,FromRoom_name:_0x2d4b60,to_warehouse:_0xc245f1,ToRoom_name:_0x36afc5,prod_name:_0x450d6a,from_prod_qty:_0x53e78d,from_prod_level:_0x35bc23,from_prod_isle:_0x256f9f,from_prod_pallet:_0x17a1ec,to_prod_qty:_0xbfa207,to_prod_level:_0x3442e9,to_prod_isle:_0x1f3913,to_prod_pallet:_0x52aa94,primary_code:_0x1010bf,secondary_code:_0x7e562e,product_code3:_0x540ec3,note:_0x47fe87,MaxStocks_data2:_0x4f0917,invoice:_0x512274,expiry_date:_0xc59477}=_0x53c3f0[_0x1cc58c(0x14b)];if(typeof _0x450d6a==_0x1cc58c(0x1f7))var _0x9f4b0a=[_0x53c3f0[_0x1cc58c(0x14b)]['prod_name']],_0x1d18ff=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1de)]],_0x228889=[_0x53c3f0['body']['from_prod_level']],_0x21b24b=[_0x53c3f0['body'][_0x1cc58c(0x15f)]],_0x2c2d93=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1c1)]],_0x2c2388=[_0x53c3f0['body'][_0x1cc58c(0x161)]],_0x299892=[_0x53c3f0['body'][_0x1cc58c(0x135)]],_0x41bcd2=[_0x53c3f0['body'][_0x1cc58c(0x183)]],_0x2631ac=[_0x53c3f0['body'][_0x1cc58c(0x15e)]],_0x1748d9=[_0x53c3f0['body']['primary_unit']],_0x1110dc=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1d6)]],_0x40cddf=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x131)]],_0x5dc356=[_0x53c3f0[_0x1cc58c(0x14b)]['expiry_date']],_0x5c4c95=[_0x53c3f0['body'][_0x1cc58c(0x157)]],_0x2476fd=[_0x53c3f0[_0x1cc58c(0x14b)]['MaxStocks_data']],_0xfc0278=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x187)]],_0x346e71=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1ba)]],_0x3c1d12=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x18f)]],_0x3e6adc=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1e5)]],_0xde6503=[_0x53c3f0['body'][_0x1cc58c(0x1ac)]],_0x20392a=[_0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x14f)]];else var _0x9f4b0a=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1cf)]],_0x1d18ff=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1de)]],_0x228889=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x19e)]],_0x21b24b=[..._0x53c3f0['body'][_0x1cc58c(0x15f)]],_0x2c2d93=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1c1)]],_0x2c2388=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x161)]],_0x299892=[..._0x53c3f0['body'][_0x1cc58c(0x135)]],_0x41bcd2=[..._0x53c3f0[_0x1cc58c(0x14b)]['product_code3']],_0x2631ac=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x15e)]],_0x1748d9=[..._0x53c3f0['body'][_0x1cc58c(0x1d8)]],_0x1110dc=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x1d6)]],_0x40cddf=[..._0x53c3f0[_0x1cc58c(0x14b)]['batch_code']],_0x5dc356=[..._0x53c3f0[_0x1cc58c(0x14b)]['expiry_date']],_0x5c4c95=[..._0x53c3f0[_0x1cc58c(0x14b)][_0x1cc58c(0x157)]],_0x2476fd=[..._0x53c3f0[_0x1cc58c(0x14b)]['MaxStocks_data']],_0xfc0278=[..._0x53c3f0['body']['maxPerUnit']],_0x346e71=[..._0x53c3f0[_0x1cc58c(0x14b)]['prod_cat']],_0x3c1d12=[..._0x53c3f0['body'][_0x1cc58c(0x18f)]],_0x3e6adc=[..._0x53c3f0['body'][_0x1cc58c(0x1e5)]],_0xde6503=[..._0x53c3f0[_0x1cc58c(0x14b)]['from_invoice']],_0x20392a=[..._0x53c3f0[_0x1cc58c(0x14b)]['to_invoice']];const _0x23cc74=_0x9f4b0a[_0x1cc58c(0x1f8)](_0x2603e8=>{return _0x2603e8={'product_name':_0x2603e8};});_0x1d18ff[_0x1cc58c(0x1a9)]((_0x1fadbe,_0x241177)=>{var _0x2ea49f=_0x1cc58c;_0x23cc74[_0x241177][_0x2ea49f(0x18a)]=_0x1fadbe;}),_0x228889[_0x1cc58c(0x1a9)]((_0x2cc8f5,_0x39f481)=>{var _0x3899ed=_0x1cc58c;_0x23cc74[_0x39f481][_0x3899ed(0x1d7)]=_0x2cc8f5;}),_0xde6503['forEach']((_0x32c28d,_0x43a1dd)=>{var _0x4a7412=_0x1cc58c;_0x23cc74[_0x43a1dd][_0x4a7412(0x1ac)]=_0x32c28d;}),_0x20392a[_0x1cc58c(0x1a9)]((_0x857131,_0x82cb0e)=>{var _0x119416=_0x1cc58c;_0x23cc74[_0x82cb0e][_0x119416(0x196)]=_0x857131;}),_0x21b24b[_0x1cc58c(0x1a9)]((_0x3deb0f,_0x1a6233)=>{var _0x239dbe=_0x1cc58c;_0x23cc74[_0x1a6233][_0x239dbe(0x180)]=_0x3deb0f;}),_0x2c2d93[_0x1cc58c(0x1a9)]((_0x4345ec,_0x25d4da)=>{var _0x3e782c=_0x1cc58c;_0x23cc74[_0x25d4da][_0x3e782c(0x18b)]=_0x4345ec;}),_0x2c2388[_0x1cc58c(0x1a9)]((_0x2d58e1,_0x39eb89)=>{var _0x52405f=_0x1cc58c;_0x23cc74[_0x39eb89][_0x52405f(0x161)]=_0x2d58e1;}),_0x299892[_0x1cc58c(0x1a9)]((_0x3f787c,_0x57c5b8)=>{var _0x338ab8=_0x1cc58c;_0x23cc74[_0x57c5b8][_0x338ab8(0x135)]=_0x3f787c;}),_0x41bcd2['forEach']((_0x404df4,_0x242897)=>{var _0x109afd=_0x1cc58c;_0x23cc74[_0x242897][_0x109afd(0x1a0)]=_0x404df4;}),_0x2631ac[_0x1cc58c(0x1a9)]((_0x3b168d,_0x111e0c)=>{var _0x1e6b5e=_0x1cc58c;_0x23cc74[_0x111e0c][_0x1e6b5e(0x169)]=_0x3b168d;}),_0x1748d9['forEach']((_0x31ad21,_0x3585d2)=>{var _0x589877=_0x1cc58c;_0x23cc74[_0x3585d2][_0x589877(0x1ce)]=_0x31ad21;}),_0x1110dc[_0x1cc58c(0x1a9)]((_0x113b74,_0x36b5b9)=>{var _0x2efc51=_0x1cc58c;_0x23cc74[_0x36b5b9][_0x2efc51(0x1d6)]=_0x113b74;}),_0x40cddf[_0x1cc58c(0x1a9)]((_0x14025a,_0x492571)=>{var _0x4a194b=_0x1cc58c;_0x23cc74[_0x492571][_0x4a194b(0x131)]=_0x14025a;}),_0x5dc356[_0x1cc58c(0x1a9)]((_0xcdeaf6,_0x38d20c)=>{var _0x20dfb5=_0x1cc58c;_0x23cc74[_0x38d20c][_0x20dfb5(0x182)]=_0xcdeaf6;}),_0x5c4c95['forEach']((_0x3b366e,_0x4936de)=>{var _0x479362=_0x1cc58c;_0x23cc74[_0x4936de][_0x479362(0x200)]=_0x3b366e;}),_0x2476fd[_0x1cc58c(0x1a9)]((_0x1e7157,_0x31f7fb)=>{var _0xfb4b5b=_0x1cc58c;_0x23cc74[_0x31f7fb][_0xfb4b5b(0x169)]=_0x1e7157;}),_0xfc0278[_0x1cc58c(0x1a9)]((_0x1a44f8,_0x1b3a47)=>{_0x23cc74[_0x1b3a47]['maxPerUnit']=_0x1a44f8;}),_0x346e71[_0x1cc58c(0x1a9)]((_0x5befbb,_0x2ce428)=>{_0x23cc74[_0x2ce428]['prod_cat']=_0x5befbb;}),_0x3c1d12[_0x1cc58c(0x1a9)]((_0x19d3e8,_0x3a6419)=>{_0x23cc74[_0x3a6419]['from_room_name']=_0x19d3e8;}),_0x3e6adc[_0x1cc58c(0x1a9)]((_0x556eeb,_0x52b5a5)=>{var _0x2f1543=_0x1cc58c;_0x23cc74[_0x52b5a5][_0x2f1543(0x1ab)]=_0x556eeb;});const _0x9211c8=_0x23cc74['filter'](_0x5e41ed=>_0x5e41ed['to_quantity']!=='0'&&_0x5e41ed['to_quantity']!==''||_0x5e41ed[_0x1cc58c(0x1a6)]!=='0'&&_0x5e41ed[_0x1cc58c(0x1a6)]!=='');var _0x99bf86=0x0;_0x9211c8[_0x1cc58c(0x1a9)](_0x13d92c=>{parseInt(_0x13d92c['from_quantity'])<parseInt(_0x13d92c['to_quantity'])&&_0x99bf86++;});if(_0x99bf86!=0x0)return _0x53c3f0[_0x1cc58c(0x1df)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2de7ff['redirect'](_0x1cc58c(0x154));const _0x45831b=new transfers_finished({'date':_0x6c9e65,'from_warehouse':_0x1ae9c5,'to_warehouse':_0xc245f1,'product':_0x9211c8,'note':_0x47fe87,'invoice':_0x512274}),_0x55db59=await _0x45831b[_0x1cc58c(0x1a7)]();_0x53c3f0['flash']('success',_0x1cc58c(0x199)),_0x2de7ff[_0x1cc58c(0x194)](_0x1cc58c(0x14e)+_0x55db59[_0x1cc58c(0x1ad)]);}catch(_0x64b31e){console[_0x1cc58c(0x1dc)](_0x64b31e),_0x2de7ff[_0x1cc58c(0x1c4)](0xc8)['json']({'errorMessage':_0x64b31e[_0x1cc58c(0x15a)]});}}),router[a0_0x14a594(0x1eb)](a0_0x14a594(0x177),auth,async(_0x281e08,_0x302295)=>{var _0x4d7ec6=a0_0x14a594;try{const {username:_0x107934,email:_0x5b6787,role:_0x17e64a}=_0x281e08[_0x4d7ec6(0x130)],_0x1ae11c=_0x281e08[_0x4d7ec6(0x130)],_0x3b97df=await profile[_0x4d7ec6(0x1b6)]({'email':_0x1ae11c[_0x4d7ec6(0x1a4)]}),_0x4a09db=await master_shop[_0x4d7ec6(0x1e1)](),_0x54623e=await transfers_finished[_0x4d7ec6(0x1a8)](_0x281e08[_0x4d7ec6(0x160)]['id']);let _0x3ff133;if(_0x1ae11c['role']==_0x4d7ec6(0x133)){const _0x4d51cf=await staff[_0x4d7ec6(0x1b6)]({'email':_0x1ae11c[_0x4d7ec6(0x1a4)]});_0x3ff133=await warehouse[_0x4d7ec6(0x1e1)]({'status':_0x4d7ec6(0x191),'name':_0x4d51cf[_0x4d7ec6(0x15c)],'warehouse_category':'Finished\x20Goods'});}else _0x3ff133=await warehouse[_0x4d7ec6(0x1e1)]({'status':_0x4d7ec6(0x191),'warehouse_category':'Finished\x20Goods'});const _0x35d220=await warehouse[_0x4d7ec6(0x1e4)]([{'$match':{'name':_0x54623e['from_warehouse'],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x4d7ec6(0x1f1)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4d7ec6(0x1bf)},'product_stock':{'$first':_0x4d7ec6(0x1b3)},'bay':{'$first':_0x4d7ec6(0x1f5)},'bin':{'$first':_0x4d7ec6(0x1d0)},'type':{'$first':_0x4d7ec6(0x144)},'floorlevel':{'$first':_0x4d7ec6(0x1d5)},'primary_code':{'$first':_0x4d7ec6(0x145)},'secondary_code':{'$first':_0x4d7ec6(0x1e2)},'product_code':{'$first':_0x4d7ec6(0x197)},'storage':{'$first':_0x4d7ec6(0x16b)},'rack':{'$first':_0x4d7ec6(0x148)},'expiry_date':{'$first':_0x4d7ec6(0x1fd)},'production_date':{'$first':_0x4d7ec6(0x1ea)},'room':{'$first':_0x4d7ec6(0x1fe)},'warehoue_name':{'$first':'$name'}}}]),_0x3e48bc=await product['find']({});if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]=='English\x20(US)'){var _0x20befb=users['English'];console[_0x4d7ec6(0x1dc)](_0x20befb);}else{if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]=='Hindi')var _0x20befb=users[_0x4d7ec6(0x1f0)];else{if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]==_0x4d7ec6(0x1fa))var _0x20befb=users[_0x4d7ec6(0x1fa)];else{if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]=='Spanish')var _0x20befb=users[_0x4d7ec6(0x170)];else{if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]==_0x4d7ec6(0x12e))var _0x20befb=users[_0x4d7ec6(0x12e)];else{if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]=='Portuguese\x20(BR)')var _0x20befb=users[_0x4d7ec6(0x139)];else{if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]==_0x4d7ec6(0x19a))var _0x20befb=users[_0x4d7ec6(0x19a)];else{if(_0x4a09db[0x0][_0x4d7ec6(0x1dd)]=='Arabic\x20(ae)')var _0x20befb=users[_0x4d7ec6(0x1cc)];}}}}}}}_0x302295[_0x4d7ec6(0x184)]('edit_transfer_finished_view',{'success':_0x281e08[_0x4d7ec6(0x1df)](_0x4d7ec6(0x1b1)),'errors':_0x281e08[_0x4d7ec6(0x1df)](_0x4d7ec6(0x1a2)),'role':_0x1ae11c,'profile':_0x3b97df,'master_shop':_0x4a09db,'warehouse':_0x3ff133,'transfer':_0x54623e,'stock':_0x35d220,'unit':_0x3e48bc,'language':_0x20befb});}catch(_0x18d945){console[_0x4d7ec6(0x1dc)](_0x18d945);}}),router[a0_0x14a594(0x147)](a0_0x14a594(0x177),auth,async(_0x4769a1,_0x5d5a3f)=>{var _0x1f2b70=a0_0x14a594;try{const {invoice:_0x27014c,from_warehouse:_0x282235,FromRoom_name:_0x3ff984,to_warehouse:_0x59027b,ToRoom_name:_0x2138f5}=_0x4769a1['body'],_0x2591f4=await transfers_finished[_0x1f2b70(0x1a8)](_0x4769a1['params']['id']),_0x50b616=_0x2591f4['product'][_0x1f2b70(0x1f8)](async _0x447184=>{var _0x43fc45=_0x1f2b70;if(_0x447184['to_quantity']>0x0){var _0xefa458=await warehouse[_0x43fc45(0x1b6)]({'name':_0x282235,'room':_0x447184[_0x43fc45(0x1b7)],'warehouse_category':_0x43fc45(0x12b)});const _0x449f85=_0xefa458[_0x43fc45(0x18d)][_0x43fc45(0x1f8)](_0x134e21=>{var _0x1cea2e=_0x43fc45;_0x134e21[_0x1cea2e(0x17c)]==_0x447184[_0x1cea2e(0x17c)]&&_0x134e21[_0x1cea2e(0x1c5)]==_0x447184[_0x1cea2e(0x1d7)]&&_0x134e21['expiry_date']==_0x447184[_0x1cea2e(0x182)]&&_0x134e21[_0x1cea2e(0x200)]==_0x447184[_0x1cea2e(0x200)]&&_0x134e21[_0x1cea2e(0x131)]==_0x447184['batch_code']&&_0x134e21['invoice']==_0x447184[_0x1cea2e(0x1ac)]&&(_0x134e21[_0x1cea2e(0x189)]=_0x134e21[_0x1cea2e(0x189)]-_0x447184['to_quantity']);});}return _0xefa458;});Promise[_0x1f2b70(0x193)](_0x50b616)[_0x1f2b70(0x152)](async _0x2227c3=>{var _0x1b455a=_0x1f2b70;try{for(const _0x40be7a of _0x2227c3){await _0x40be7a['save']();}const _0x19083c=_0x2591f4['product'][_0x1b455a(0x1f8)](async _0x35b8ef=>{var _0x3e3b55=_0x1b455a,_0x2552d1=await warehouse[_0x3e3b55(0x1b6)]({'name':_0x59027b,'room':_0x35b8ef['to_room_name']});if(_0x35b8ef[_0x3e3b55(0x180)]>0x0){var _0x1a45a0=0x0;const _0x147640=_0x2552d1[_0x3e3b55(0x18d)][_0x3e3b55(0x1f8)](_0x4875be=>{var _0x19df00=_0x3e3b55;_0x4875be[_0x19df00(0x17c)]==_0x35b8ef['product_name']&&_0x4875be[_0x19df00(0x1c5)]==_0x35b8ef[_0x19df00(0x18b)]&&_0x4875be[_0x19df00(0x182)]==_0x35b8ef[_0x19df00(0x182)]&&_0x4875be[_0x19df00(0x200)]==_0x35b8ef[_0x19df00(0x200)]&&_0x4875be[_0x19df00(0x131)]==_0x35b8ef['batch_code']&&_0x4875be[_0x19df00(0x1d1)]==_0x35b8ef[_0x19df00(0x196)]&&(_0x4875be[_0x19df00(0x189)]=_0x4875be[_0x19df00(0x189)]+_0x35b8ef[_0x19df00(0x180)],_0x1a45a0++);});_0x1a45a0=='0'&&(_0x2552d1['product_details']=_0x2552d1[_0x3e3b55(0x18d)][_0x3e3b55(0x188)]({'product_name':_0x35b8ef[_0x3e3b55(0x17c)],'product_stock':_0x35b8ef[_0x3e3b55(0x180)],'bay':_0x35b8ef[_0x3e3b55(0x18b)],'product_code':_0x35b8ef[_0x3e3b55(0x1a0)],'primary_code':_0x35b8ef[_0x3e3b55(0x161)],'secondary_code':_0x35b8ef[_0x3e3b55(0x135)],'expiry_date':_0x35b8ef[_0x3e3b55(0x182)],'production_date':_0x35b8ef[_0x3e3b55(0x200)],'maxProducts':_0x35b8ef[_0x3e3b55(0x169)],'batch_code':_0x35b8ef[_0x3e3b55(0x131)],'secondary_unit':_0x35b8ef[_0x3e3b55(0x1d6)],'unit':_0x35b8ef[_0x3e3b55(0x1ce)],'maxProducts':_0x35b8ef[_0x3e3b55(0x169)],'maxPerUnit':_0x35b8ef[_0x3e3b55(0x187)],'invoice':_0x35b8ef[_0x3e3b55(0x196)]}));}return _0x2552d1;});Promise[_0x1b455a(0x193)](_0x19083c)[_0x1b455a(0x152)](async _0x5d0138=>{var _0x3e2f38=_0x1b455a;try{for(const _0x247429 of _0x5d0138){await warehouse[_0x3e2f38(0x127)]({'_id':_0x247429['_id']},{'$addToSet':{'product_details':{'$each':_0x247429[_0x3e2f38(0x18d)]}}});}_0x2591f4[_0x3e2f38(0x166)]=_0x3e2f38(0x150);const _0x4e8a2f=await _0x2591f4[_0x3e2f38(0x1a7)](),_0x232592=await master_shop['find'](),_0x261b94=await email_settings['findOne'](),_0x255c68=await supervisor_settings['find']();var _0x267805=_0x2591f4[_0x3e2f38(0x1c9)],_0x1cb04e='',_0x420e00;for(_0x420e00 in _0x267805){var _0x340440='FG';_0x2591f4[_0x3e2f38(0x1c6)]==_0x3e2f38(0x1fc)&&(_0x340440='DG'),_0x1cb04e+=_0x3e2f38(0x16f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x267805[_0x420e00][_0x3e2f38(0x17c)]+_0x3e2f38(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x267805[_0x420e00][_0x3e2f38(0x1a0)]+_0x3e2f38(0x198)+_0x3e2f38(0x1b4)+_0x267805[_0x420e00][_0x3e2f38(0x180)]+'</td>'+_0x3e2f38(0x1b4)+_0x267805[_0x420e00][_0x3e2f38(0x1ce)]+_0x3e2f38(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x267805[_0x420e00][_0x3e2f38(0x1d6)]+_0x3e2f38(0x198)+_0x3e2f38(0x1b4)+_0x2591f4[_0x3e2f38(0x1c6)]+_0x3e2f38(0x198)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x267805[_0x420e00][_0x3e2f38(0x1ab)]+_0x3e2f38(0x198)+_0x3e2f38(0x1b4)+_0x340440+_0x267805[_0x420e00][_0x3e2f38(0x18b)]+_0x3e2f38(0x198)+_0x3e2f38(0x12a);}let _0x502590=nodemailer[_0x3e2f38(0x19c)]({'host':_0x261b94[_0x3e2f38(0x19b)],'port':Number(_0x261b94['port']),'secure':![],'auth':{'user':_0x261b94[_0x3e2f38(0x1a4)],'pass':_0x261b94[_0x3e2f38(0x16e)]}}),_0x3fbf74={'from':_0x261b94[_0x3e2f38(0x1a4)],'to':_0x255c68[0x0][_0x3e2f38(0x129)],'subject':_0x3e2f38(0x1e0),'attachments':[{'filename':_0x3e2f38(0x1e9),'path':__dirname+_0x3e2f38(0x1db)+_0x3e2f38(0x1d3)+_0x232592[0x0][_0x3e2f38(0x1bc)],'cid':_0x3e2f38(0x1cd)}],'html':_0x3e2f38(0x12c)+'<html><head><title></title>'+_0x3e2f38(0x162)+_0x3e2f38(0x125)+_0x3e2f38(0x13e)+_0x3e2f38(0x125)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x3e2f38(0x1c0)+_0x3e2f38(0x125)+_0x3e2f38(0x13c)+_0x232592[0x0][_0x3e2f38(0x168)]+'\x20</h2>'+_0x3e2f38(0x1c0)+'</div>'+_0x3e2f38(0x13f)+_0x3e2f38(0x125)+_0x3e2f38(0x179)+'\x20Order\x20Number\x20:\x20'+_0x2591f4[_0x3e2f38(0x1d1)]+'\x20'+_0x3e2f38(0x16c)+'\x20Order\x20Date\x20:\x20'+_0x2591f4['date']+'\x20'+'</span>'+_0x3e2f38(0x1fb)+'</div>'+_0x3e2f38(0x165)+_0x3e2f38(0x13d)+_0x3e2f38(0x16f)+_0x3e2f38(0x1b2)+_0x3e2f38(0x1a3)+_0x3e2f38(0x1e8)+_0x3e2f38(0x203)+_0x3e2f38(0x192)+_0x3e2f38(0x15b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x3e2f38(0x149)+_0x3e2f38(0x12a)+_0x3e2f38(0x146)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1cb04e+'\x20'+'</tbody>'+_0x3e2f38(0x142)+_0x3e2f38(0x125)+_0x3e2f38(0x1ca)+_0x3e2f38(0x137)+_0x232592[0x0][_0x3e2f38(0x168)]+_0x3e2f38(0x1fb)+_0x3e2f38(0x1c0)+'</div>'+'</body></html>'};_0x502590[_0x3e2f38(0x1d9)](_0x3fbf74,function(_0x5d5ff4,_0x4e76b9){var _0x3db4fb=_0x3e2f38;_0x5d5ff4?(console[_0x3db4fb(0x1dc)](_0x5d5ff4),console[_0x3db4fb(0x1dc)]('Error\x20Occurs')):console[_0x3db4fb(0x1dc)](_0x3db4fb(0x1b5));}),_0x4769a1[_0x3e2f38(0x1df)](_0x3e2f38(0x1b1),_0x3e2f38(0x1a5)),_0x5d5a3f['redirect']('/picking_list/PDF_transfer/'+_0x4e8a2f[_0x3e2f38(0x1ad)]);}catch(_0x2e45d9){console[_0x3e2f38(0x13b)](_0x2e45d9),_0x5d5a3f[_0x3e2f38(0x1c4)](0x1f4)[_0x3e2f38(0x1c8)]({'error':_0x3e2f38(0x156)});}})[_0x1b455a(0x1e3)](_0x542cc1=>{var _0x2e6667=_0x1b455a;console[_0x2e6667(0x13b)](_0x542cc1),_0x5d5a3f[_0x2e6667(0x1c4)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x4005cc){console[_0x1b455a(0x13b)](_0x4005cc),_0x5d5a3f[_0x1b455a(0x1c4)](0x1f4)[_0x1b455a(0x1c8)]({'error':_0x1b455a(0x132)});}})[_0x1f2b70(0x1e3)](_0x5207d1=>{var _0x29f9e1=_0x1f2b70;console['error'](_0x5207d1),_0x5d5a3f['status'](0x1f4)['json']({'error':_0x29f9e1(0x1f4)});});}catch(_0x42175d){_0x5d5a3f['json']({'message':_0x42175d[_0x1f2b70(0x15a)]});}});function BayBinSelected(_0xd3e523,_0x3e3cab){var _0x3e0ffb=a0_0x14a594,_0x55da43=[];let _0x472585=[];var _0x2f636c=[];if(_0xd3e523==_0x3e0ffb(0x1fc)){switch(_0x3e3cab){case'Rack\x201':_0x55da43=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x3e0ffb(0x195):_0x55da43=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x2f636c=['DG'];}else{if(_0xd3e523==_0x3e0ffb(0x1d4)){switch(_0x3e3cab){case'Rack\x201':_0x55da43=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x3e0ffb(0x195):_0x55da43=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x2f636c=['FG'];}}return{'levels':_0x55da43,'identify':_0x2f636c};}router[a0_0x14a594(0x1eb)]('/view/:id',auth,async(_0x111806,_0x1ffcc3)=>{var _0x30eb53=a0_0x14a594;try{const {username:_0x1ca89e,email:_0x1d8dde,role:_0x11ef64}=_0x111806['user'],_0x3df3aa=_0x111806[_0x30eb53(0x130)],_0xce7021=await profile['findOne']({'email':_0x3df3aa[_0x30eb53(0x1a4)]}),_0x5682a5=await master_shop[_0x30eb53(0x1e1)](),_0x497a45=await transfers_finished[_0x30eb53(0x1a8)](_0x111806['params']['id']);let _0x1ecbb0=new Date(_0x497a45['expiry_date']),_0xad5653=('0'+_0x1ecbb0[_0x30eb53(0x158)]())['slice'](-0x2),_0x45595f=('0'+(_0x1ecbb0[_0x30eb53(0x186)]()+0x1))[_0x30eb53(0x1b8)](-0x2),_0x3b1492=_0x1ecbb0[_0x30eb53(0x1bb)](),_0x3fbf35=_0x3b1492+'-'+_0x45595f+'-'+_0xad5653,_0x4a4676;if(_0x3df3aa[_0x30eb53(0x1e6)]==_0x30eb53(0x133)){const _0x49a450=await staff['findOne']({'email':_0x3df3aa[_0x30eb53(0x1a4)]});_0x4a4676=await warehouse[_0x30eb53(0x1e1)]({'status':_0x30eb53(0x191),'name':_0x49a450[_0x30eb53(0x15c)],'warehouse_category':_0x30eb53(0x12b)});}else _0x4a4676=await warehouse[_0x30eb53(0x1e1)]({'status':'Enabled','warehouse_category':_0x30eb53(0x12b)});const _0x213380=await warehouse['aggregate']([{'$match':{'name':_0x497a45['from_warehouse'],'room':_0x497a45['from_room']}},{'$unwind':_0x30eb53(0x1f1)},{'$group':{'_id':_0x30eb53(0x1da),'name':{'$first':_0x30eb53(0x1bf)},'product_stock':{'$first':_0x30eb53(0x1b3)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x30eb53(0x1d0)},'type':{'$first':_0x30eb53(0x144)},'floorlevel':{'$first':_0x30eb53(0x1d5)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x30eb53(0x1e2)},'product_code':{'$first':_0x30eb53(0x197)},'storage':{'$first':_0x30eb53(0x16b)},'rack':{'$first':_0x30eb53(0x148)}}}]);var _0x2e3eac=[0x1,0x2,0x3,0x4],_0x2f9e40=['A','B','C','D','E','F','G','H','I','J'],_0x2533ed=[_0x30eb53(0x163),'Enclosed'];const _0x63230d=await product['find']({}),_0x5698e6=BayBinSelected(_0x497a45[_0x30eb53(0x1c6)],_0x497a45[_0x30eb53(0x1af)]);if(_0x5682a5[0x0][_0x30eb53(0x1dd)]==_0x30eb53(0x181)){var _0x1fc897=users[_0x30eb53(0x138)];console[_0x30eb53(0x1dc)](_0x1fc897);}else{if(_0x5682a5[0x0]['language']==_0x30eb53(0x1f0))var _0x1fc897=users[_0x30eb53(0x1f0)];else{if(_0x5682a5[0x0]['language']==_0x30eb53(0x1fa))var _0x1fc897=users[_0x30eb53(0x1fa)];else{if(_0x5682a5[0x0][_0x30eb53(0x1dd)]==_0x30eb53(0x170))var _0x1fc897=users['Spanish'];else{if(_0x5682a5[0x0][_0x30eb53(0x1dd)]==_0x30eb53(0x12e))var _0x1fc897=users[_0x30eb53(0x12e)];else{if(_0x5682a5[0x0]['language']==_0x30eb53(0x159))var _0x1fc897=users[_0x30eb53(0x139)];else{if(_0x5682a5[0x0][_0x30eb53(0x1dd)]==_0x30eb53(0x19a))var _0x1fc897=users[_0x30eb53(0x19a)];else{if(_0x5682a5[0x0][_0x30eb53(0x1dd)]==_0x30eb53(0x143))var _0x1fc897=users['Arabic'];}}}}}}}_0x1ffcc3[_0x30eb53(0x184)](_0x30eb53(0x19d),{'success':_0x111806['flash']('success'),'errors':_0x111806['flash']('errors'),'role':_0x3df3aa,'profile':_0xce7021,'master_shop':_0x5682a5,'warehouse':_0x4a4676,'transfer':_0x497a45,'stock':_0x213380,'unit':_0x63230d,'language':_0x1fc897,'levels':_0x2e3eac,'Isle':_0x2f9e40,'rooms_data':_0x2533ed,'ed_fullDate':_0x3fbf35,'dataSelected':_0x5698e6});}catch(_0x5c934e){console[_0x30eb53(0x1dc)](_0x5c934e);}}),router[a0_0x14a594(0x147)](a0_0x14a594(0x17e),auth,async(_0x16c109,_0x430b9c)=>{var _0x17f522=a0_0x14a594;try{const _0x520ef7=_0x16c109['params']['id'];console[_0x17f522(0x1dc)](_0x16c109[_0x17f522(0x14b)]);const _0x2028f6=await transfers_finished[_0x17f522(0x1a8)](_0x520ef7);console['log']('transfer_data',_0x2028f6);const {date:_0x323fdd,from_warehouse:_0x2ae85b,FromRoom_name:_0x414ea0,to_warehouse:_0xf8db7b,ToRoom_name:_0x46342b,prod_name:_0x38421b,from_prod_qty:_0x1f6a9d,from_prod_level:_0x2a8b2f,from_prod_isle:_0x31fa7b,from_prod_pallet:_0x2b6ab4,to_prod_qty:_0x4b8357,to_prod_level:_0x588586,to_prod_isle:_0x3e1d1d,to_prod_pallet:_0x3aeeae,primary_code:_0x2a2bda,secondary_code:_0x33db37,product_code3:_0x5dfcd3,note:_0x342413,invoice:_0x59d7f4,expiry_date:_0x23ce3b}=_0x16c109[_0x17f522(0x14b)];if(typeof _0x38421b==_0x17f522(0x1f7))var _0x311560=[_0x16c109['body'][_0x17f522(0x1cf)]],_0x455268=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x1de)]],_0x29cf9d=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x19e)]],_0x150ce3=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x17f)]],_0x4568e1=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x1c1)]],_0x2b1401=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x161)]],_0x38ffa1=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x135)]],_0x128402=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x183)]],_0x487a7d=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x15e)]],_0xa910fa=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x1ce)]],_0xf056c0=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x1d6)]],_0x3660db=[_0x16c109[_0x17f522(0x14b)][_0x17f522(0x131)]],_0x297306=[_0x16c109[_0x17f522(0x14b)]['expiry_date']];else var _0x311560=[..._0x16c109['body'][_0x17f522(0x1cf)]],_0x455268=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x1de)]],_0x29cf9d=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x19e)]],_0x150ce3=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x17f)]],_0x4568e1=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x1c1)]],_0x2b1401=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x161)]],_0x38ffa1=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x135)]],_0x128402=[..._0x16c109[_0x17f522(0x14b)]['product_code3']],_0x487a7d=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x15e)]],_0xa910fa=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x1ce)]],_0xf056c0=[..._0x16c109[_0x17f522(0x14b)][_0x17f522(0x1d6)]],_0x3660db=[..._0x16c109[_0x17f522(0x14b)]['batch_code']],_0x297306=[..._0x16c109[_0x17f522(0x14b)]['expiry_date']];const _0x2e634d=_0x311560[_0x17f522(0x1f8)](_0x1c3890=>{return _0x1c3890={'product_name':_0x1c3890};});_0x455268['forEach']((_0x3afc0d,_0x235a62)=>{_0x2e634d[_0x235a62]['from_quantity']=_0x3afc0d;}),_0x29cf9d[_0x17f522(0x1a9)]((_0x59c076,_0x16d9a8)=>{var _0x378a63=_0x17f522;_0x2e634d[_0x16d9a8][_0x378a63(0x1d7)]=_0x59c076;}),_0x150ce3[_0x17f522(0x1a9)]((_0x2a97da,_0x26ce7c)=>{var _0xbe085b=_0x17f522;_0x2e634d[_0x26ce7c][_0xbe085b(0x180)]=_0x2a97da;}),_0x4568e1[_0x17f522(0x1a9)]((_0x3c82fd,_0x4e2931)=>{var _0x25e31e=_0x17f522;_0x2e634d[_0x4e2931][_0x25e31e(0x18b)]=_0x3c82fd;}),_0x2b1401[_0x17f522(0x1a9)]((_0x343830,_0x43d13f)=>{var _0x13ce89=_0x17f522;_0x2e634d[_0x43d13f][_0x13ce89(0x161)]=_0x343830;}),_0x38ffa1[_0x17f522(0x1a9)]((_0x57dd27,_0x17dfbf)=>{_0x2e634d[_0x17dfbf]['secondary_code']=_0x57dd27;}),_0x128402[_0x17f522(0x1a9)]((_0x1bf5c5,_0x1e673a)=>{var _0x64b48c=_0x17f522;_0x2e634d[_0x1e673a][_0x64b48c(0x1a0)]=_0x1bf5c5;}),_0x487a7d[_0x17f522(0x1a9)]((_0x591c52,_0x2998f5)=>{_0x2e634d[_0x2998f5]['maxProducts']=_0x591c52;}),_0xa910fa['forEach']((_0x1d64ac,_0x5484bb)=>{var _0x45cffd=_0x17f522;_0x2e634d[_0x5484bb][_0x45cffd(0x1ce)]=_0x1d64ac;}),_0xf056c0['forEach']((_0x44b9c7,_0x3246b6)=>{_0x2e634d[_0x3246b6]['secondary_unit']=_0x44b9c7;}),_0x3660db[_0x17f522(0x1a9)]((_0x23cdb1,_0x2b1504)=>{var _0x5d02f5=_0x17f522;_0x2e634d[_0x2b1504][_0x5d02f5(0x131)]=_0x23cdb1;}),_0x297306[_0x17f522(0x1a9)]((_0x503769,_0x267d88)=>{var _0x5ee5c8=_0x17f522;_0x2e634d[_0x267d88][_0x5ee5c8(0x182)]=_0x503769;});const _0x35ec49=_0x2e634d[_0x17f522(0x16a)](_0x23482a=>_0x23482a[_0x17f522(0x180)]!=='0'&&_0x23482a[_0x17f522(0x180)]!==''||_0x23482a[_0x17f522(0x1a6)]!=='0'&&_0x23482a[_0x17f522(0x1a6)]!=='');var _0x30bb8a=0x0;_0x35ec49[_0x17f522(0x1a9)](_0x14c80b=>{var _0x147395=_0x17f522;parseInt(_0x14c80b[_0x147395(0x18a)])<parseInt(_0x14c80b[_0x147395(0x180)])&&_0x30bb8a++;});if(_0x30bb8a!=0x0)return _0x16c109[_0x17f522(0x1df)](_0x17f522(0x1a2),_0x17f522(0x126)),_0x430b9c[_0x17f522(0x194)](_0x17f522(0x154));const _0x4736e9=await warehouse[_0x17f522(0x1b6)]({'name':_0x2028f6[_0x17f522(0x128)],'room':_0x2028f6[_0x17f522(0x1f3)]});_0x2028f6['product'][_0x17f522(0x1a9)](_0x1585b5=>{var _0x4e9d40=_0x17f522;if(_0x1585b5[_0x4e9d40(0x180)]>0x0){const _0x2a5194=_0x4736e9['product_details'][_0x4e9d40(0x1f8)](_0x34db3f=>{var _0x121098=_0x4e9d40;_0x34db3f[_0x121098(0x17c)]==_0x1585b5[_0x121098(0x17c)]&&_0x34db3f['bay']==_0x1585b5[_0x121098(0x1d7)]&&(_0x34db3f[_0x121098(0x189)]=parseInt(_0x34db3f['product_stock'])+parseInt(_0x1585b5['to_quantity']));});}}),await _0x4736e9[_0x17f522(0x1a7)]();const _0x5cbf11=await warehouse[_0x17f522(0x1b6)]({'name':_0x2028f6[_0x17f522(0x1c6)],'room':_0x2028f6[_0x17f522(0x1af)]});_0x2028f6[_0x17f522(0x1c9)][_0x17f522(0x1a9)](_0x40922a=>{var _0x312377=_0x17f522;if(_0x40922a[_0x312377(0x180)]>0x0){const _0x3dd2e6=_0x5cbf11[_0x312377(0x18d)]['map'](_0x4023d1=>{var _0x3c0dd7=_0x312377;_0x4023d1[_0x3c0dd7(0x17c)]==_0x40922a['product_name']&&_0x4023d1[_0x3c0dd7(0x1c5)]==_0x40922a[_0x3c0dd7(0x18b)]&&(_0x4023d1[_0x3c0dd7(0x189)]=parseInt(_0x4023d1[_0x3c0dd7(0x189)])-parseInt(_0x40922a[_0x3c0dd7(0x180)]));});}}),await _0x5cbf11[_0x17f522(0x1a7)](),_0x2028f6['date']=_0x323fdd,_0x2028f6[_0x17f522(0x128)]=_0x2ae85b,_0x2028f6[_0x17f522(0x1c6)]=_0xf8db7b,_0x2028f6[_0x17f522(0x1c9)]=_0x35ec49,_0x2028f6[_0x17f522(0x136)]=_0x342413,_0x2028f6['invoice']=_0x59d7f4;const _0x468a52=await _0x2028f6[_0x17f522(0x1a7)](),_0xdb1d7=await warehouse[_0x17f522(0x1b6)]({'name':_0x2ae85b,'room':_0x414ea0});_0x468a52[_0x17f522(0x1c9)][_0x17f522(0x1a9)](_0xea3d33=>{var _0x3f827d=_0x17f522;if(_0xea3d33[_0x3f827d(0x180)]>0x0){const _0x3f17e3=_0xdb1d7[_0x3f827d(0x18d)]['map'](_0x381e92=>{var _0x1b62e9=_0x3f827d;_0x381e92[_0x1b62e9(0x17c)]==_0xea3d33[_0x1b62e9(0x17c)]&&_0x381e92[_0x1b62e9(0x1c5)]==_0xea3d33[_0x1b62e9(0x1d7)]&&(_0x381e92['product_stock']=parseInt(_0x381e92[_0x1b62e9(0x189)])-parseInt(_0xea3d33[_0x1b62e9(0x180)]));});}}),await _0xdb1d7[_0x17f522(0x1a7)]();const _0x1e9c52=await warehouse[_0x17f522(0x1b6)]({'name':_0xf8db7b,'room':_0x46342b});_0x468a52['product']['forEach'](_0x1ec028=>{var _0x169ba8=_0x17f522;if(_0x1ec028[_0x169ba8(0x180)]>0x0){var _0xae627d=0x0;const _0x1b3d63=_0x1e9c52[_0x169ba8(0x18d)]['map'](_0x36c32e=>{var _0x3c579c=_0x169ba8;_0x36c32e['product_name']==_0x1ec028[_0x3c579c(0x17c)]&&_0x36c32e[_0x3c579c(0x1c5)]==_0x1ec028[_0x3c579c(0x18b)]&&(_0x36c32e[_0x3c579c(0x189)]=parseInt(_0x36c32e['product_stock'])+parseInt(_0x1ec028[_0x3c579c(0x180)]),_0xae627d++);});_0xae627d=='0'&&(_0x1e9c52['product_details']=_0x1e9c52['product_details'][_0x169ba8(0x188)]({'product_name':_0x1ec028['product_name'],'product_stock':_0x1ec028[_0x169ba8(0x180)],'bay':_0x1ec028[_0x169ba8(0x18b)],'product_code':_0x1ec028[_0x169ba8(0x1a0)],'primary_code':_0x1ec028[_0x169ba8(0x161)],'secondary_code':_0x1ec028[_0x169ba8(0x135)],'maxProducts':_0x1ec028[_0x169ba8(0x169)]}));}}),await _0x1e9c52[_0x17f522(0x1a7)](),_0x16c109[_0x17f522(0x1df)](_0x17f522(0x1b1),_0x17f522(0x1ef)),_0x430b9c['redirect'](_0x17f522(0x141));}catch(_0x1dec87){console[_0x17f522(0x1dc)](_0x1dec87);}}),router[a0_0x14a594(0x147)]('/barcode_scanner',async(_0xb22f60,_0x1a29ce)=>{var _0x503d99=a0_0x14a594;const {FromWareHouse:_0x126479,FromRoom:_0x2c0eb0,ToWarehouse:_0x1dfd76,ToRoom:_0xc3993c,primary_code:_0x1bf945,Roomslist:_0x15b392}=_0xb22f60[_0x503d99(0x14b)],_0x129fa6=_0x15b392[_0x503d99(0x167)](','),_0x3017c5=[];async function _0x56738d(_0x28f1c9){var _0x46f568=_0x503d99;const _0x50f252=await warehouse[_0x46f568(0x1e4)]([{'$match':{'name':_0x126479,'room':_0x28f1c9}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x1bf945}},{'$group':{'_id':_0x46f568(0x1da),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x46f568(0x1b3)},'primary_code':{'$first':_0x46f568(0x145)},'secondary_code':{'$first':_0x46f568(0x1e2)},'product_code':{'$first':_0x46f568(0x197)},'level':{'$first':_0x46f568(0x1f5)},'isle':{'$first':_0x46f568(0x1d0)},'type':{'$first':_0x46f568(0x144)},'pallet':{'$first':_0x46f568(0x1d5)},'unit':{'$first':_0x46f568(0x202)},'secondary_unit':{'$first':_0x46f568(0x1c7)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x46f568(0x148)},'expiry_date':{'$first':_0x46f568(0x1fd)},'production_date':{'$first':_0x46f568(0x1ea)},'batch_code':{'$first':_0x46f568(0x16d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x46f568(0x1fe)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x46f568(0x19f)}}}]),_0x1b9487=await warehouse[_0x46f568(0x1e4)]([{'$match':{'name':_0x126479,'room':_0x28f1c9}},{'$unwind':_0x46f568(0x1f1)},{'$match':{'product_details.secondary_code':_0x1bf945}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x46f568(0x1bf)},'instock':{'$first':_0x46f568(0x1b3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x46f568(0x1e2)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x46f568(0x1f5)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x46f568(0x1d5)},'unit':{'$first':_0x46f568(0x202)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x46f568(0x16b)},'rack':{'$first':_0x46f568(0x148)},'expiry_date':{'$first':_0x46f568(0x1fd)},'production_date':{'$first':_0x46f568(0x1ea)},'batch_code':{'$first':_0x46f568(0x16d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x46f568(0x19f)}}}]);if(_0x50f252[_0x46f568(0x1b9)]>0x0)_0x3017c5['push'](_0x50f252);else _0x1b9487['length']>0x0&&_0x3017c5[_0x46f568(0x17b)](_0x1b9487);}const _0x58808f=_0x129fa6[_0x503d99(0x1f8)](_0x2eb69c=>_0x56738d(_0x2eb69c));await Promise[_0x503d99(0x193)](_0x58808f),_0x1a29ce[_0x503d99(0x1c8)](_0x3017c5);}),router['post']('/barcode_scanner2',async(_0x28ec0f,_0x3b6be2)=>{var _0x18c669=a0_0x14a594;try{const {FromWareHouse:_0xe9a05f,FromRoom:_0x2ab5e5,ToWarehouse:_0xaf3cc2,ToRoom:_0x49921f,secondary_code:_0x2a190d}=_0x28ec0f[_0x18c669(0x14b)],_0x468903=await warehouse['aggregate']([{'$match':{'name':_0xe9a05f}},{'$unwind':_0x18c669(0x1f1)},{'$match':{'product_details.secondary_code':_0x2a190d}},{'$group':{'_id':_0x18c669(0x1da),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x18c669(0x145)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x18c669(0x197)},'instock':{'$first':_0x18c669(0x1b3)},'warehouse':{'$first':'$name'},'level':{'$first':_0x18c669(0x12d)},'isle':{'$first':_0x18c669(0x18c)},'pallet':{'$first':_0x18c669(0x1ee)},'maxProducts':{'$first':_0x18c669(0x1ae)},'unit':{'$first':_0x18c669(0x202)},'expiry_date':{'$first':_0x18c669(0x1fd)},'production_date':{'$first':_0x18c669(0x1ea)}}}]);_0x3b6be2[_0x18c669(0x1c4)](0xc8)[_0x18c669(0x1c8)](_0x468903);}catch(_0x4a96db){_0x3b6be2[_0x18c669(0x1c4)](0x194)[_0x18c669(0x1c8)]({'message':_0x4a96db[_0x18c669(0x15a)]});}}),router[a0_0x14a594(0x147)](a0_0x14a594(0x1cb),async(_0x1ed1f8,_0x270191)=>{var _0x25ed91=a0_0x14a594;try{const {FromWareHouse:_0xedbf64,FromRoom:_0x5f4ae6,ToWarehouse:_0x2ee5c1,ToRoom:_0x4dbaae,product_code:_0x8996d8}=_0x1ed1f8[_0x25ed91(0x14b)],_0x390618=await warehouse['aggregate']([{'$match':{'name':_0xedbf64}},{'$unwind':_0x25ed91(0x1f1)},{'$match':{'product_details.product_code':_0x8996d8}},{'$group':{'_id':_0x25ed91(0x1da),'name':{'$first':_0x25ed91(0x1bf)},'primary_code':{'$first':_0x25ed91(0x145)},'secondary_code':{'$first':_0x25ed91(0x1e2)},'product_code':{'$first':_0x25ed91(0x197)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x25ed91(0x12f)},'level':{'$first':_0x25ed91(0x12d)},'isle':{'$first':_0x25ed91(0x18c)},'pallet':{'$first':_0x25ed91(0x1ee)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x25ed91(0x202)}}}]);_0x270191[_0x25ed91(0x1c4)](0xc8)[_0x25ed91(0x1c8)](_0x390618);}catch(_0x4cb03a){_0x270191['status'](0x194)[_0x25ed91(0x1c8)]({'message':_0x4cb03a['message']});}}),router[a0_0x14a594(0x147)](a0_0x14a594(0x15d),async(_0x23a917,_0x40d6fb)=>{var _0x215584=a0_0x14a594;const {productCode:_0x405605,bay:_0x5ba721,warehouses:_0x387010,room:_0x5f32bd}=_0x23a917[_0x215584(0x14b)];console[_0x215584(0x1dc)](_0x23a917[_0x215584(0x14b)]);try{const _0x3ec329=await warehouse[_0x215584(0x1e4)]([{'$match':{'name':_0x387010,'room':_0x5f32bd}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x5ba721)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x215584(0x1bf)},'product_stock':{'$first':_0x215584(0x1b3)},'bay':{'$first':_0x215584(0x1f5)},'maxProducts':{'$first':_0x215584(0x1ae)}}}]);_0x40d6fb['status'](0xc8)['json'](_0x3ec329);}catch(_0x470a99){_0x40d6fb[_0x215584(0x1c4)](0x194)[_0x215584(0x1c8)]({'message':_0x470a99[_0x215584(0x15a)]});}}),module[a0_0x14a594(0x1e7)]=router;