var a0_0x3b180a=a0_0x1fdd;(function(_0x101774,_0x24bf52){var _0x377268=a0_0x1fdd,_0x1263bc=_0x101774();while(!![]){try{var _0x1035fb=parseInt(_0x377268(0x151))/0x1*(-parseInt(_0x377268(0xee))/0x2)+parseInt(_0x377268(0x14c))/0x3*(-parseInt(_0x377268(0x154))/0x4)+parseInt(_0x377268(0xc7))/0x5+-parseInt(_0x377268(0x175))/0x6*(-parseInt(_0x377268(0x161))/0x7)+parseInt(_0x377268(0x14d))/0x8+parseInt(_0x377268(0x157))/0x9*(-parseInt(_0x377268(0xba))/0xa)+parseInt(_0x377268(0x13e))/0xb;if(_0x1035fb===_0x24bf52)break;else _0x1263bc['push'](_0x1263bc['shift']());}catch(_0x26c710){_0x1263bc['push'](_0x1263bc['shift']());}}}(a0_0x148c,0x1c826));const express=require(a0_0x3b180a(0x171)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x3b180a(0xdd)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x3b180a(0x13c));function a0_0x1fdd(_0x41398f,_0x49ce72){var _0x148c0f=a0_0x148c();return a0_0x1fdd=function(_0x1fdd7e,_0x3da5db){_0x1fdd7e=_0x1fdd7e-0xab;var _0x33bad4=_0x148c0f[_0x1fdd7e];return _0x33bad4;},a0_0x1fdd(_0x41398f,_0x49ce72);}router[a0_0x3b180a(0x17f)](a0_0x3b180a(0xe3),auth,async(_0x2c784d,_0x1012ee)=>{var _0x254e3b=a0_0x3b180a;try{const {username:_0x31d0ac,email:_0x4234c2,role:_0x3a4c6e}=_0x2c784d[_0x254e3b(0xc5)],_0x52a7c9=_0x2c784d[_0x254e3b(0xc5)],_0x57b794=await profile[_0x254e3b(0x107)]({'email':_0x52a7c9[_0x254e3b(0x121)]}),_0x2b5829=await master_shop['find']();let _0x59a09e;if(_0x52a7c9['role']==_0x254e3b(0x11f)){const _0x374760=await staff[_0x254e3b(0x107)]({'email':_0x52a7c9['email']});_0x59a09e=await transfers_finished['find']({'from_warehouse':_0x374760[_0x254e3b(0xbd)]});}else _0x59a09e=await transfers_finished[_0x254e3b(0xc9)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x254e3b(0x183)},'date':{'$first':_0x254e3b(0xe7)},'from_warehouse':{'$first':_0x254e3b(0x16f)},'to_warehouse':{'$first':_0x254e3b(0xc3)},'from_room_name':{'$addToSet':_0x254e3b(0x147)},'to_room_name':{'$addToSet':_0x254e3b(0x182)},'finalize':{'$first':_0x254e3b(0x126)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2b5829[0x0][_0x254e3b(0x176)]==_0x254e3b(0x13a))var _0x286950=users[_0x254e3b(0xe9)];else{if(_0x2b5829[0x0][_0x254e3b(0x176)]=='Hindi')var _0x286950=users['Hindi'];else{if(_0x2b5829[0x0][_0x254e3b(0x176)]==_0x254e3b(0xf6))var _0x286950=users[_0x254e3b(0xf6)];else{if(_0x2b5829[0x0][_0x254e3b(0x176)]==_0x254e3b(0xe4))var _0x286950=users['Spanish'];else{if(_0x2b5829[0x0][_0x254e3b(0x176)]==_0x254e3b(0x155))var _0x286950=users[_0x254e3b(0x155)];else{if(_0x2b5829[0x0][_0x254e3b(0x176)]==_0x254e3b(0x138))var _0x286950=users[_0x254e3b(0x159)];else{if(_0x2b5829[0x0][_0x254e3b(0x176)]=='Chinese')var _0x286950=users[_0x254e3b(0x17b)];else{if(_0x2b5829[0x0]['language']==_0x254e3b(0xb8))var _0x286950=users['Arabic'];}}}}}}}_0x1012ee['render'](_0x254e3b(0x12a),{'success':_0x2c784d[_0x254e3b(0x13b)](_0x254e3b(0x134)),'errors':_0x2c784d[_0x254e3b(0x13b)](_0x254e3b(0x16e)),'role':_0x52a7c9,'profile':_0x57b794,'master_shop':_0x2b5829,'transfer':_0x59a09e,'language':_0x286950});}catch(_0xeab4ac){console[_0x254e3b(0x110)](_0xeab4ac);}});async function getRandom8DigitNumber(){var _0x4023d5=a0_0x3b180a;const _0x17f8aa=0x989680,_0x3d8d2d=0x5f5e0ff,_0x36bbf8=Math[_0x4023d5(0xf7)](Math['random']()*(_0x3d8d2d-_0x17f8aa+0x1))+_0x17f8aa;var _0x40035f;const _0xd6e130=await transfers_finished[_0x4023d5(0x107)]({'invoice':_0x4023d5(0x14f)+_0x36bbf8});return _0xd6e130&&_0xd6e130[_0x4023d5(0xcd)]>0x0?_0x40035f=_0x4023d5(0x14f)+_0x36bbf8:_0x40035f=_0x4023d5(0x14f)+_0x36bbf8,_0x40035f;}router[a0_0x3b180a(0x17f)]('/view/add_transfer',auth,async(_0x25c691,_0x81b170)=>{var _0x2c8b7c=a0_0x3b180a;try{const {username:_0x2afe09,email:_0x11592f,role:_0xc86863}=_0x25c691['user'],_0x558556=_0x25c691[_0x2c8b7c(0xc5)],_0x356de7=await profile['findOne']({'email':_0x558556[_0x2c8b7c(0x121)]}),_0x188803=await master_shop[_0x2c8b7c(0x181)]();let _0x51a541;if(_0x558556[_0x2c8b7c(0x162)]==_0x2c8b7c(0x11f)){const _0x37f9ad=await staff['findOne']({'email':_0x558556[_0x2c8b7c(0x121)]});_0x51a541=await warehouse[_0x2c8b7c(0xc9)]([{'$match':{'status':'Enabled','name':_0x37f9ad['warehouse'],'warehouse_category':_0x2c8b7c(0x116),'name':{'$ne':_0x2c8b7c(0x144)}}},{'$group':{'_id':_0x2c8b7c(0x128),'name':{'$first':_0x2c8b7c(0x128)}}}]);}else _0x51a541=await warehouse[_0x2c8b7c(0xc9)]([{'$match':{'status':_0x2c8b7c(0xc0),'warehouse_category':_0x2c8b7c(0x116),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x2c8b7c(0x128),'name':{'$first':_0x2c8b7c(0x128)}}}]);const _0xaae803=await transfers_finished['find']({}),_0x268a7e=_0xaae803[_0x2c8b7c(0xcd)]+0x1,_0x5530f8=_0x2c8b7c(0x14f)+_0x268a7e[_0x2c8b7c(0x185)]()[_0x2c8b7c(0xf5)](0x5,'0');if(_0x188803[0x0][_0x2c8b7c(0x176)]==_0x2c8b7c(0x13a))var _0x3ba18b=users[_0x2c8b7c(0xe9)];else{if(_0x188803[0x0][_0x2c8b7c(0x176)]=='Hindi')var _0x3ba18b=users[_0x2c8b7c(0xed)];else{if(_0x188803[0x0]['language']==_0x2c8b7c(0xf6))var _0x3ba18b=users[_0x2c8b7c(0xf6)];else{if(_0x188803[0x0]['language']==_0x2c8b7c(0xe4))var _0x3ba18b=users[_0x2c8b7c(0xe4)];else{if(_0x188803[0x0][_0x2c8b7c(0x176)]=='French')var _0x3ba18b=users[_0x2c8b7c(0x155)];else{if(_0x188803[0x0]['language']==_0x2c8b7c(0x138))var _0x3ba18b=users[_0x2c8b7c(0x159)];else{if(_0x188803[0x0][_0x2c8b7c(0x176)]==_0x2c8b7c(0x17b))var _0x3ba18b=users[_0x2c8b7c(0x17b)];else{if(_0x188803[0x0]['language']=='Arabic\x20(ae)')var _0x3ba18b=users[_0x2c8b7c(0x17c)];}}}}}}}const _0x9ceb1e=getRandom8DigitNumber();_0x9ceb1e['then'](_0x280941=>{var _0xa0433c=_0x2c8b7c;_0x81b170[_0xa0433c(0x129)](_0xa0433c(0xb6),{'success':_0x25c691[_0xa0433c(0x13b)](_0xa0433c(0x134)),'errors':_0x25c691[_0xa0433c(0x13b)]('errors'),'role':_0x558556,'profile':_0x356de7,'master_shop':_0x188803,'warehouse':_0x51a541,'language':_0x3ba18b,'invoice':_0x280941});})[_0x2c8b7c(0x131)](_0x57c5e9=>{var _0x55938f=_0x2c8b7c;_0x25c691[_0x55938f(0x13b)](_0x55938f(0x16e),_0x55938f(0x153)),_0x81b170[_0x55938f(0x11c)]('/transfer/view');});}catch(_0xa2f0a5){console[_0x2c8b7c(0x110)](_0xa2f0a5);}}),router[a0_0x3b180a(0x152)](a0_0x3b180a(0x143),auth,async(_0x2b8139,_0x1a3f06)=>{var _0x52fcb0=a0_0x3b180a;try{const {date:_0x1e3e9c,from_warehouse:_0x45e14d,FromRoom_name:_0x4bcf5c,to_warehouse:_0x1c1d1d,ToRoom_name:_0x2a9641,prod_name:_0x39c4dd,from_prod_qty:_0x94c848,from_prod_level:_0x4baedb,from_prod_isle:_0x4c1a1d,from_prod_pallet:_0x1c3cae,to_prod_qty:_0x2ed7fb,to_prod_level:_0x320839,to_prod_isle:_0x55892f,to_prod_pallet:_0x37a981,primary_code:_0x5c4b9a,secondary_code:_0x1b4a81,product_code3:_0x231c6d,note:_0x4cb889,MaxStocks_data2:_0x15ac73,invoice:_0x2ebba9,expiry_date:_0x28da4c}=_0x2b8139[_0x52fcb0(0xe8)];if(typeof _0x39c4dd==_0x52fcb0(0x187))var _0x41ea45=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xdc)]],_0x459acb=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x16d)]],_0x258480=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x108)]],_0x577dcf=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x125)]],_0x3a6ea0=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x117)]],_0x1777e7=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xd5)]],_0x2bb366=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xcb)]],_0xebb45a=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x145)]],_0x60a1d1=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x14e)]],_0x1a16a5=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x173)]],_0x3b5ff3=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xfc)]],_0x9b34c3=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x12c)]],_0x5b4adb=[_0x2b8139['body'][_0x52fcb0(0x10d)]],_0x124780=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xd9)]],_0x15344d=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x10e)]],_0x45f979=[_0x2b8139['body'][_0x52fcb0(0xdf)]],_0x101b8d=[_0x2b8139['body'][_0x52fcb0(0x103)]],_0x39eb8a=[_0x2b8139[_0x52fcb0(0xe8)]['RoomAssigned']],_0x399547=[_0x2b8139['body'][_0x52fcb0(0x184)]],_0xa72f49=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xab)]],_0x2ac0fe=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x13d)]],_0x17b185=[_0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x142)]];else var _0x41ea45=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xdc)]],_0x459acb=[..._0x2b8139['body'][_0x52fcb0(0x16d)]],_0x258480=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x108)]],_0x577dcf=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x125)]],_0x3a6ea0=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x117)]],_0x1777e7=[..._0x2b8139['body'][_0x52fcb0(0xd5)]],_0x2bb366=[..._0x2b8139['body'][_0x52fcb0(0xcb)]],_0xebb45a=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x145)]],_0x60a1d1=[..._0x2b8139[_0x52fcb0(0xe8)]['MaxStocks_data2']],_0x1a16a5=[..._0x2b8139['body'][_0x52fcb0(0x173)]],_0x3b5ff3=[..._0x2b8139['body'][_0x52fcb0(0xfc)]],_0x9b34c3=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x12c)]],_0x5b4adb=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x10d)]],_0x124780=[..._0x2b8139['body'][_0x52fcb0(0xd9)]],_0x15344d=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x10e)]],_0x45f979=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xdf)]],_0x101b8d=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x103)]],_0x39eb8a=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xda)]],_0x399547=[..._0x2b8139[_0x52fcb0(0xe8)]['ToRoomAssigned']],_0xa72f49=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0xab)]],_0x2ac0fe=[..._0x2b8139[_0x52fcb0(0xe8)][_0x52fcb0(0x13d)]],_0x17b185=[..._0x2b8139[_0x52fcb0(0xe8)]['id_transaction']];const _0x567304=_0x41ea45['map'](_0x32e379=>{return _0x32e379={'product_name':_0x32e379};});_0x459acb[_0x52fcb0(0xd4)]((_0x27986a,_0xf423c7)=>{var _0x230efd=_0x52fcb0;_0x567304[_0xf423c7][_0x230efd(0x189)]=_0x27986a;}),_0x258480['forEach']((_0x22742d,_0x207980)=>{var _0x35350d=_0x52fcb0;_0x567304[_0x207980][_0x35350d(0xb0)]=_0x22742d;}),_0x17b185[_0x52fcb0(0xd4)]((_0x2a27b7,_0x3fdb97)=>{_0x567304[_0x3fdb97]['id_transaction']=_0x2a27b7;}),_0xa72f49['forEach']((_0x31bac5,_0x52e6f5)=>{var _0x2d0610=_0x52fcb0;_0x567304[_0x52e6f5][_0x2d0610(0xab)]=_0x31bac5;}),_0x2ac0fe[_0x52fcb0(0xd4)]((_0x2e3c33,_0x34531c)=>{var _0x3abe5e=_0x52fcb0;_0x567304[_0x34531c][_0x3abe5e(0xbe)]=_0x2e3c33;}),_0x577dcf[_0x52fcb0(0xd4)]((_0x14d3c5,_0x29950e)=>{var _0x84081a=_0x52fcb0;_0x567304[_0x29950e][_0x84081a(0x12d)]=_0x14d3c5;}),_0x3a6ea0[_0x52fcb0(0xd4)]((_0x3033cf,_0x328904)=>{_0x567304[_0x328904]['to_bay']=_0x3033cf;}),_0x1777e7[_0x52fcb0(0xd4)]((_0x4d2a35,_0x2f40c6)=>{var _0x404064=_0x52fcb0;_0x567304[_0x2f40c6][_0x404064(0xd5)]=_0x4d2a35;}),_0x2bb366['forEach']((_0x33a991,_0x2b37fc)=>{_0x567304[_0x2b37fc]['secondary_code']=_0x33a991;}),_0xebb45a[_0x52fcb0(0xd4)]((_0x4e1c14,_0x4f5ed3)=>{_0x567304[_0x4f5ed3]['product_code']=_0x4e1c14;}),_0x60a1d1[_0x52fcb0(0xd4)]((_0x5e46d2,_0x4527d4)=>{var _0x25cdfb=_0x52fcb0;_0x567304[_0x4527d4][_0x25cdfb(0xb1)]=_0x5e46d2;}),_0x1a16a5[_0x52fcb0(0xd4)]((_0x434499,_0x12578f)=>{var _0x2a252c=_0x52fcb0;_0x567304[_0x12578f][_0x2a252c(0x111)]=_0x434499;}),_0x3b5ff3['forEach']((_0x5da521,_0x3adedd)=>{var _0x2f4a94=_0x52fcb0;_0x567304[_0x3adedd][_0x2f4a94(0xfc)]=_0x5da521;}),_0x9b34c3[_0x52fcb0(0xd4)]((_0x5bee7c,_0x1741db)=>{var _0x24a81c=_0x52fcb0;_0x567304[_0x1741db][_0x24a81c(0x12c)]=_0x5bee7c;}),_0x5b4adb[_0x52fcb0(0xd4)]((_0xaaa12,_0x3b460f)=>{var _0x395eb1=_0x52fcb0;_0x567304[_0x3b460f][_0x395eb1(0x10d)]=_0xaaa12;}),_0x124780['forEach']((_0x1b7f19,_0x373b08)=>{var _0x361183=_0x52fcb0;_0x567304[_0x373b08][_0x361183(0xd6)]=_0x1b7f19;}),_0x15344d['forEach']((_0x2c4a92,_0xad9b3c)=>{var _0x3cb4a9=_0x52fcb0;_0x567304[_0xad9b3c][_0x3cb4a9(0xb1)]=_0x2c4a92;}),_0x45f979[_0x52fcb0(0xd4)]((_0x19104a,_0x381b6f)=>{var _0x378885=_0x52fcb0;_0x567304[_0x381b6f][_0x378885(0xdf)]=_0x19104a;}),_0x101b8d['forEach']((_0x12cc16,_0x32b70)=>{var _0x20f156=_0x52fcb0;_0x567304[_0x32b70][_0x20f156(0x103)]=_0x12cc16;}),_0x39eb8a[_0x52fcb0(0xd4)]((_0x1be192,_0x2825b8)=>{var _0x5a6d15=_0x52fcb0;_0x567304[_0x2825b8][_0x5a6d15(0xe5)]=_0x1be192;}),_0x399547[_0x52fcb0(0xd4)]((_0x283bd0,_0x4ecfd2)=>{var _0x53d692=_0x52fcb0;_0x567304[_0x4ecfd2][_0x53d692(0x132)]=_0x283bd0;});const _0x4e5e32=_0x567304[_0x52fcb0(0xea)](_0x16961a=>_0x16961a[_0x52fcb0(0x12d)]!=='0'&&_0x16961a[_0x52fcb0(0x12d)]!==''||_0x16961a[_0x52fcb0(0xb9)]!=='0'&&_0x16961a[_0x52fcb0(0xb9)]!=='');var _0x2f8003=0x0;_0x4e5e32[_0x52fcb0(0xd4)](_0x53f2db=>{var _0x47ab78=_0x52fcb0;parseInt(_0x53f2db[_0x47ab78(0x189)])<parseInt(_0x53f2db[_0x47ab78(0x12d)])&&_0x2f8003++;});if(_0x2f8003!=0x0)return _0x2b8139[_0x52fcb0(0x13b)](_0x52fcb0(0x16e),_0x52fcb0(0x16c)),_0x1a3f06[_0x52fcb0(0x11c)](_0x52fcb0(0xce));const _0x4bce23=new transfers_finished({'date':_0x1e3e9c,'from_warehouse':_0x45e14d,'to_warehouse':_0x1c1d1d,'product':_0x4e5e32,'note':_0x4cb889,'invoice':_0x2ebba9}),_0x6de4e9=await _0x4bce23[_0x52fcb0(0xd2)]();_0x2b8139[_0x52fcb0(0x13b)]('success',_0x52fcb0(0x15c)),_0x1a3f06[_0x52fcb0(0x11c)]('/transfer_finished/preview/'+_0x6de4e9[_0x52fcb0(0x136)]);}catch(_0x18263a){console['log'](_0x18263a),_0x1a3f06[_0x52fcb0(0x17e)](0xc8)['json']({'errorMessage':_0x18263a[_0x52fcb0(0x156)]});}}),router['get']('/preview/:id',auth,async(_0x210435,_0x2b3a81)=>{var _0x71c039=a0_0x3b180a;try{const {username:_0x1988b0,email:_0x1237a3,role:_0x51347a}=_0x210435['user'],_0x170288=_0x210435[_0x71c039(0xc5)],_0x2c260d=await profile[_0x71c039(0x107)]({'email':_0x170288[_0x71c039(0x121)]}),_0x1e23f1=await master_shop[_0x71c039(0x181)](),_0x3754e7=await transfers_finished[_0x71c039(0x163)](_0x210435[_0x71c039(0xac)]['id']);let _0x3479f0;if(_0x170288[_0x71c039(0x162)]==_0x71c039(0x11f)){const _0x5dc2b3=await staff[_0x71c039(0x107)]({'email':_0x170288[_0x71c039(0x121)]});_0x3479f0=await warehouse[_0x71c039(0x181)]({'status':'Enabled','name':_0x5dc2b3[_0x71c039(0xbd)],'warehouse_category':'Finished\x20Goods'});}else _0x3479f0=await warehouse['find']({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x4841c5=await warehouse[_0x71c039(0xc9)]([{'$match':{'name':_0x3754e7[_0x71c039(0x141)],'warehouse_category':_0x71c039(0x116)}},{'$unwind':_0x71c039(0x15b)},{'$group':{'_id':_0x71c039(0xd0),'name':{'$first':_0x71c039(0xf0)},'product_stock':{'$first':_0x71c039(0xc2)},'bay':{'$first':_0x71c039(0x10c)},'bin':{'$first':_0x71c039(0x130)},'type':{'$first':_0x71c039(0x18a)},'floorlevel':{'$first':_0x71c039(0x102)},'primary_code':{'$first':_0x71c039(0x112)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x71c039(0x10f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x71c039(0x165)},'expiry_date':{'$first':_0x71c039(0x104)},'production_date':{'$first':_0x71c039(0x150)},'room':{'$first':_0x71c039(0x169)},'warehoue_name':{'$first':_0x71c039(0x128)}}}]),_0x3654d1=await product[_0x71c039(0x181)]({});if(_0x1e23f1[0x0]['language']==_0x71c039(0x13a)){var _0x30421e=users[_0x71c039(0xe9)];console['log'](_0x30421e);}else{if(_0x1e23f1[0x0][_0x71c039(0x176)]==_0x71c039(0xed))var _0x30421e=users['Hindi'];else{if(_0x1e23f1[0x0][_0x71c039(0x176)]==_0x71c039(0xf6))var _0x30421e=users[_0x71c039(0xf6)];else{if(_0x1e23f1[0x0][_0x71c039(0x176)]==_0x71c039(0xe4))var _0x30421e=users[_0x71c039(0xe4)];else{if(_0x1e23f1[0x0][_0x71c039(0x176)]=='French')var _0x30421e=users[_0x71c039(0x155)];else{if(_0x1e23f1[0x0][_0x71c039(0x176)]==_0x71c039(0x138))var _0x30421e=users[_0x71c039(0x159)];else{if(_0x1e23f1[0x0][_0x71c039(0x176)]=='Chinese')var _0x30421e=users[_0x71c039(0x17b)];else{if(_0x1e23f1[0x0][_0x71c039(0x176)]==_0x71c039(0xb8))var _0x30421e=users[_0x71c039(0x17c)];}}}}}}}_0x2b3a81[_0x71c039(0x129)]('edit_transfer_finished_view',{'success':_0x210435[_0x71c039(0x13b)]('success'),'errors':_0x210435[_0x71c039(0x13b)]('errors'),'role':_0x170288,'profile':_0x2c260d,'master_shop':_0x1e23f1,'warehouse':_0x3479f0,'transfer':_0x3754e7,'stock':_0x4841c5,'unit':_0x3654d1,'language':_0x30421e});}catch(_0x2e1cd5){console['log'](_0x2e1cd5);}}),router[a0_0x3b180a(0x152)](a0_0x3b180a(0xad),auth,async(_0x2fe383,_0x5bc644)=>{var _0x5d5ce9=a0_0x3b180a;try{const {invoice:_0x401e02,from_warehouse:_0x3ba2a1,FromRoom_name:_0x2e21fd,to_warehouse:_0x36d465,ToRoom_name:_0x4abb15}=_0x2fe383[_0x5d5ce9(0xe8)],_0xca02bb=await transfers_finished[_0x5d5ce9(0x163)](_0x2fe383[_0x5d5ce9(0xac)]['id']),_0x5e71c7=_0xca02bb[_0x5d5ce9(0x106)][_0x5d5ce9(0xe0)](async _0x7b597e=>{var _0x5e283b=_0x5d5ce9;if(_0x7b597e['to_quantity']>0x0){var _0x3d436e=await warehouse[_0x5e283b(0x107)]({'name':_0x3ba2a1,'room':_0x7b597e[_0x5e283b(0xe5)],'warehouse_category':'Finished\x20Goods'});const _0x3f11c7=_0x3d436e[_0x5e283b(0x160)][_0x5e283b(0xe0)](_0x27cc84=>{var _0x2630f5=_0x5e283b;_0x27cc84[_0x2630f5(0xfe)]==_0x7b597e[_0x2630f5(0xfe)]&&_0x27cc84[_0x2630f5(0xcc)]==_0x7b597e[_0x2630f5(0xb0)]&&_0x27cc84['expiry_date']==_0x7b597e[_0x2630f5(0x10d)]&&_0x27cc84[_0x2630f5(0xd6)]==_0x7b597e[_0x2630f5(0xd6)]&&_0x27cc84[_0x2630f5(0x12c)]==_0x7b597e[_0x2630f5(0x12c)]&&_0x27cc84[_0x2630f5(0xcf)]==_0x7b597e[_0x2630f5(0xab)]&&(console['log']('here1',_0x27cc84[_0x2630f5(0xd1)]),typeof _0x7b597e[_0x2630f5(0x142)]=='undefined'?_0x27cc84[_0x2630f5(0xd1)]=Math[_0x2630f5(0xaf)](0x0,Math['abs'](_0x27cc84[_0x2630f5(0xd1)])-Math[_0x2630f5(0x17a)](_0x7b597e[_0x2630f5(0x12d)])):_0x27cc84['product_stock']=Math[_0x2630f5(0xaf)](0x0,Math[_0x2630f5(0x17a)](_0x27cc84[_0x2630f5(0xd1)])-Math[_0x2630f5(0x17a)](_0x7b597e[_0x2630f5(0x12d)])));});}return _0x3d436e;});Promise['all'](_0x5e71c7)[_0x5d5ce9(0x12f)](async _0x127415=>{var _0x54c9a9=_0x5d5ce9;try{for(const _0x5488b7 of _0x127415){await _0x5488b7[_0x54c9a9(0xd2)]();}const _0x5431e7=_0xca02bb['product']['map'](async _0x3902d5=>{var _0x3ac58c=_0x54c9a9,_0xb3b669=await warehouse[_0x3ac58c(0x107)]({'name':_0x36d465,'room':_0x3902d5[_0x3ac58c(0x132)]});if(_0x3902d5['to_quantity']>0x0){var _0x2f4267=0x0;const _0x3fb425=_0xb3b669[_0x3ac58c(0x160)][_0x3ac58c(0xe0)](_0xbf032d=>{var _0x29a307=_0x3ac58c;_0xbf032d['product_name']==_0x3902d5[_0x29a307(0xfe)]&&_0xbf032d[_0x29a307(0xcc)]==_0x3902d5[_0x29a307(0xca)]&&_0xbf032d['expiry_date']==_0x3902d5[_0x29a307(0x10d)]&&_0xbf032d[_0x29a307(0xd6)]==_0x3902d5[_0x29a307(0xd6)]&&_0xbf032d[_0x29a307(0x12c)]==_0x3902d5[_0x29a307(0x12c)]&&_0xbf032d['invoice']==_0x3902d5['To_invoice']&&(typeof _0x3902d5[_0x29a307(0x142)]==_0x29a307(0x11e)?(console[_0x29a307(0x110)](_0x29a307(0x115),_0xbf032d['product_stock']+_0x29a307(0xd3)+_0xbf032d[_0x29a307(0x136)]+'\x20<=>\x20'+Math[_0x29a307(0x17a)](_0xbf032d[_0x29a307(0xd1)])+Math['abs'](_0x3902d5[_0x29a307(0x12d)])),_0xbf032d[_0x29a307(0xd1)]=Math['abs'](_0xbf032d[_0x29a307(0xd1)])+Math[_0x29a307(0x17a)](_0x3902d5[_0x29a307(0x12d)])):_0xbf032d[_0x29a307(0xd1)]=Math['abs'](_0xbf032d[_0x29a307(0xd1)])+Math[_0x29a307(0x17a)](_0x3902d5[_0x29a307(0x12d)]),_0x2f4267++);});_0x2f4267=='0'&&(_0xb3b669[_0x3ac58c(0x160)]=_0xb3b669['product_details'][_0x3ac58c(0x11b)]({'product_name':_0x3902d5['product_name'],'product_stock':_0x3902d5[_0x3ac58c(0x12d)],'bay':_0x3902d5[_0x3ac58c(0xca)],'product_code':_0x3902d5[_0x3ac58c(0xf9)],'primary_code':_0x3902d5[_0x3ac58c(0xd5)],'secondary_code':_0x3902d5[_0x3ac58c(0xcb)],'expiry_date':_0x3902d5['expiry_date'],'production_date':_0x3902d5[_0x3ac58c(0xd6)],'maxProducts':_0x3902d5['maxProducts'],'batch_code':_0x3902d5[_0x3ac58c(0x12c)],'secondary_unit':_0x3902d5[_0x3ac58c(0xfc)],'unit':_0x3902d5[_0x3ac58c(0x111)],'maxProducts':_0x3902d5['maxProducts'],'maxPerUnit':_0x3902d5['maxPerUnit'],'invoice':_0x3902d5['To_invoice']}));}return _0xb3b669;});Promise[_0x54c9a9(0xfb)](_0x5431e7)[_0x54c9a9(0x12f)](async _0x24c497=>{var _0x555b76=_0x54c9a9;try{for(const _0x519f03 of _0x24c497){await warehouse[_0x555b76(0xb2)]({'_id':_0x519f03[_0x555b76(0x136)]},{'$addToSet':{'product_details':{'$each':_0x519f03[_0x555b76(0x160)]}}});}_0xca02bb[_0x555b76(0x139)]=_0x555b76(0x122);const _0x285854=await _0xca02bb['save'](),_0xb85a9c=await master_shop[_0x555b76(0x181)](),_0x63f07d=await email_settings[_0x555b76(0x107)](),_0x13b5a0=await supervisor_settings[_0x555b76(0x181)]();var _0x278fb0=_0xca02bb[_0x555b76(0x106)],_0x2ea504='',_0x12cc29;for(_0x12cc29 in _0x278fb0){var _0x4f367c='FG';_0xca02bb[_0x555b76(0x186)]==_0x555b76(0x101)&&(_0x4f367c='DG'),_0x2ea504+='<tr>'+_0x555b76(0x146)+_0x278fb0[_0x12cc29][_0x555b76(0xfe)]+_0x555b76(0x113)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x278fb0[_0x12cc29][_0x555b76(0xf9)]+'</td>'+_0x555b76(0x146)+_0x278fb0[_0x12cc29][_0x555b76(0x12d)]+_0x555b76(0x113)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x278fb0[_0x12cc29][_0x555b76(0x111)]+_0x555b76(0x113)+_0x555b76(0x146)+_0x278fb0[_0x12cc29][_0x555b76(0xfc)]+_0x555b76(0x113)+_0x555b76(0x146)+_0xca02bb[_0x555b76(0x186)]+_0x555b76(0x113)+_0x555b76(0x146)+_0x278fb0[_0x12cc29][_0x555b76(0x132)]+_0x555b76(0x113)+_0x555b76(0x146)+_0x4f367c+_0x278fb0[_0x12cc29][_0x555b76(0xca)]+_0x555b76(0x113)+_0x555b76(0x10b);}let _0x1af272=nodemailer[_0x555b76(0xeb)]({'host':_0x63f07d[_0x555b76(0xbc)],'port':Number(_0x63f07d[_0x555b76(0x16b)]),'secure':![],'auth':{'user':_0x63f07d[_0x555b76(0x121)],'pass':_0x63f07d[_0x555b76(0x158)]}}),_0x4879ab={'from':_0x63f07d[_0x555b76(0x121)],'to':_0x13b5a0[0x0]['FGSEmail'],'subject':_0x555b76(0x15e),'attachments':[{'filename':_0x555b76(0x10a),'path':__dirname+'/../public'+_0x555b76(0x15f)+_0xb85a9c[0x0][_0x555b76(0x124)],'cid':'logo'}],'html':_0x555b76(0x172)+_0x555b76(0x16a)+_0x555b76(0x166)+'<div>'+_0x555b76(0xb7)+_0x555b76(0xf3)+_0x555b76(0x120)+_0x555b76(0x140)+_0x555b76(0xf3)+'<h2>\x20'+_0xb85a9c[0x0][_0x555b76(0x15d)]+_0x555b76(0x137)+'</div>'+_0x555b76(0x140)+_0x555b76(0xb5)+_0x555b76(0xf3)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x555b76(0x135)+_0xca02bb[_0x555b76(0xcf)]+'\x20'+_0x555b76(0x14a)+_0x555b76(0xef)+_0xca02bb[_0x555b76(0x179)]+'\x20'+_0x555b76(0x114)+_0x555b76(0xc4)+_0x555b76(0x140)+_0x555b76(0x15a)+_0x555b76(0xff)+_0x555b76(0xe1)+_0x555b76(0x149)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x555b76(0x11d)+_0x555b76(0x167)+_0x555b76(0xbf)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x555b76(0x10b)+_0x555b76(0xae)+_0x555b76(0x12b)+'\x20'+_0x2ea504+'\x20'+_0x555b76(0x14b)+_0x555b76(0x178)+'<div>'+_0x555b76(0x12e)+_0x555b76(0x127)+_0xb85a9c[0x0][_0x555b76(0x15d)]+_0x555b76(0xc4)+_0x555b76(0x140)+'</div>'+'</body></html>'};_0x1af272['sendMail'](_0x4879ab,function(_0x1344fc,_0x21c294){var _0x5afa0c=_0x555b76;_0x1344fc?(console[_0x5afa0c(0x110)](_0x1344fc),console['log'](_0x5afa0c(0x168))):console[_0x5afa0c(0x110)]('Email\x20sent\x20successfully');}),_0x2fe383[_0x555b76(0x13b)](_0x555b76(0x134),_0x555b76(0x180)),_0x5bc644[_0x555b76(0x11c)](_0x555b76(0x188)+_0x285854['_id']);}catch(_0x209dfe){console[_0x555b76(0xe6)](_0x209dfe),_0x5bc644[_0x555b76(0x17e)](0x1f4)[_0x555b76(0x11a)]({'error':_0x555b76(0x164)});}})[_0x54c9a9(0x131)](_0x21f18e=>{var _0x58a0cd=_0x54c9a9;console[_0x58a0cd(0xe6)](_0x21f18e),_0x5bc644[_0x58a0cd(0x17e)](0x1f4)[_0x58a0cd(0x11a)]({'error':_0x58a0cd(0xb4)});});}catch(_0x33c08c){console['error'](_0x33c08c),_0x5bc644[_0x54c9a9(0x17e)](0x1f4)[_0x54c9a9(0x11a)]({'error':_0x54c9a9(0x118)});}})['catch'](_0x1a01e2=>{var _0x26467d=_0x5d5ce9;console[_0x26467d(0xe6)](_0x1a01e2),_0x5bc644[_0x26467d(0x17e)](0x1f4)[_0x26467d(0x11a)]({'error':_0x26467d(0xb4)});});}catch(_0x10d623){_0x5bc644[_0x5d5ce9(0x11a)]({'message':_0x10d623[_0x5d5ce9(0x156)]});}});function BayBinSelected(_0x555e2a,_0x38711b){var _0x41b575=a0_0x3b180a,_0xba796e=[];let _0x5e527c=[];var _0x3c5649=[];if(_0x555e2a==_0x41b575(0x101)){switch(_0x38711b){case _0x41b575(0xdb):_0xba796e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x41b575(0xfa):_0xba796e=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3c5649=['DG'];}else{if(_0x555e2a=='FROZEN\x20GOODS'){switch(_0x38711b){case'Rack\x201':_0xba796e=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x41b575(0xfa):_0xba796e=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3c5649=['FG'];}}return{'levels':_0xba796e,'identify':_0x3c5649};}router[a0_0x3b180a(0x17f)](a0_0x3b180a(0xd7),auth,async(_0x3aae92,_0x1f050d)=>{var _0x18dc51=a0_0x3b180a;try{const {username:_0x4832ea,email:_0x2283c5,role:_0x1912ff}=_0x3aae92[_0x18dc51(0xc5)],_0xee7e01=_0x3aae92[_0x18dc51(0xc5)],_0x21fa2f=await profile[_0x18dc51(0x107)]({'email':_0xee7e01[_0x18dc51(0x121)]}),_0x219acb=await master_shop[_0x18dc51(0x181)](),_0x5e95bd=await transfers_finished[_0x18dc51(0x163)](_0x3aae92[_0x18dc51(0xac)]['id']);let _0x1bd547=new Date(_0x5e95bd[_0x18dc51(0x10d)]),_0xad8633=('0'+_0x1bd547[_0x18dc51(0xf8)]())[_0x18dc51(0x119)](-0x2),_0x8ea6db=('0'+(_0x1bd547['getMonth']()+0x1))[_0x18dc51(0x119)](-0x2),_0x42dfc5=_0x1bd547['getFullYear'](),_0x97c4cf=_0x42dfc5+'-'+_0x8ea6db+'-'+_0xad8633,_0x410764;if(_0xee7e01[_0x18dc51(0x162)]==_0x18dc51(0x11f)){const _0x4aaf56=await staff[_0x18dc51(0x107)]({'email':_0xee7e01['email']});_0x410764=await warehouse[_0x18dc51(0x181)]({'status':_0x18dc51(0xc0),'name':_0x4aaf56[_0x18dc51(0xbd)],'warehouse_category':_0x18dc51(0x116)});}else _0x410764=await warehouse[_0x18dc51(0x181)]({'status':_0x18dc51(0xc0),'warehouse_category':_0x18dc51(0x116)});const _0x323234=await warehouse[_0x18dc51(0xc9)]([{'$match':{'name':_0x5e95bd[_0x18dc51(0x141)],'room':_0x5e95bd[_0x18dc51(0x13f)]}},{'$unwind':_0x18dc51(0x15b)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x18dc51(0xf0)},'product_stock':{'$first':_0x18dc51(0xc2)},'bay':{'$first':_0x18dc51(0x10c)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x18dc51(0x18a)},'floorlevel':{'$first':_0x18dc51(0x102)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x18dc51(0xbb)},'product_code':{'$first':_0x18dc51(0x10f)},'storage':{'$first':_0x18dc51(0x109)},'rack':{'$first':_0x18dc51(0x165)}}}]);var _0x20037f=[0x1,0x2,0x3,0x4],_0x58d7fd=['A','B','C','D','E','F','G','H','I','J'],_0x46df9c=[_0x18dc51(0xe2),_0x18dc51(0xc8)];const _0x25aaad=await product[_0x18dc51(0x181)]({}),_0x19ced9=BayBinSelected(_0x5e95bd[_0x18dc51(0x186)],_0x5e95bd['to_room']);if(_0x219acb[0x0]['language']==_0x18dc51(0x13a)){var _0x477c88=users[_0x18dc51(0xe9)];console[_0x18dc51(0x110)](_0x477c88);}else{if(_0x219acb[0x0]['language']=='Hindi')var _0x477c88=users[_0x18dc51(0xed)];else{if(_0x219acb[0x0][_0x18dc51(0x176)]=='German')var _0x477c88=users[_0x18dc51(0xf6)];else{if(_0x219acb[0x0][_0x18dc51(0x176)]==_0x18dc51(0xe4))var _0x477c88=users['Spanish'];else{if(_0x219acb[0x0]['language']=='French')var _0x477c88=users[_0x18dc51(0x155)];else{if(_0x219acb[0x0][_0x18dc51(0x176)]==_0x18dc51(0x138))var _0x477c88=users[_0x18dc51(0x159)];else{if(_0x219acb[0x0][_0x18dc51(0x176)]==_0x18dc51(0x17b))var _0x477c88=users[_0x18dc51(0x17b)];else{if(_0x219acb[0x0][_0x18dc51(0x176)]==_0x18dc51(0xb8))var _0x477c88=users[_0x18dc51(0x17c)];}}}}}}}_0x1f050d[_0x18dc51(0x129)]('edit_transfer_finished',{'success':_0x3aae92[_0x18dc51(0x13b)](_0x18dc51(0x134)),'errors':_0x3aae92[_0x18dc51(0x13b)](_0x18dc51(0x16e)),'role':_0xee7e01,'profile':_0x21fa2f,'master_shop':_0x219acb,'warehouse':_0x410764,'transfer':_0x5e95bd,'stock':_0x323234,'unit':_0x25aaad,'language':_0x477c88,'levels':_0x20037f,'Isle':_0x58d7fd,'rooms_data':_0x46df9c,'ed_fullDate':_0x97c4cf,'dataSelected':_0x19ced9});}catch(_0x3c2644){console['log'](_0x3c2644);}}),router[a0_0x3b180a(0x152)]('/view/:id',auth,async(_0x1bf0ec,_0x1d1cc1)=>{var _0x4bdadb=a0_0x3b180a;try{const _0x571035=_0x1bf0ec['params']['id'];console[_0x4bdadb(0x110)](_0x1bf0ec[_0x4bdadb(0xe8)]);const _0x52d9c7=await transfers_finished[_0x4bdadb(0x163)](_0x571035);console[_0x4bdadb(0x110)](_0x4bdadb(0x174),_0x52d9c7);const {date:_0x455e6b,from_warehouse:_0x5f535e,FromRoom_name:_0x371a16,to_warehouse:_0x256ded,ToRoom_name:_0x39af2d,prod_name:_0x46e20f,from_prod_qty:_0x31b223,from_prod_level:_0xa0bdd5,from_prod_isle:_0x50c066,from_prod_pallet:_0xa27cc8,to_prod_qty:_0x495274,to_prod_level:_0x2ac62b,to_prod_isle:_0x528ee2,to_prod_pallet:_0x24bbbe,primary_code:_0x5a4a56,secondary_code:_0x18fd2b,product_code3:_0x56f95a,note:_0x16ce69,invoice:_0x2b0001,expiry_date:_0x223d4d}=_0x1bf0ec['body'];if(typeof _0x46e20f==_0x4bdadb(0x187))var _0x515401=[_0x1bf0ec[_0x4bdadb(0xe8)]['prod_name']],_0x5c407c=[_0x1bf0ec['body'][_0x4bdadb(0x16d)]],_0x3f3724=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x108)]],_0x34d005=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0xf1)]],_0x302da3=[_0x1bf0ec[_0x4bdadb(0xe8)]['to_prod_level']],_0x1a0429=[_0x1bf0ec[_0x4bdadb(0xe8)]['primary_code']],_0x5b7539=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0xcb)]],_0x5a21d5=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x145)]],_0x489f42=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x14e)]],_0x5917b8=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x111)]],_0x3cefce=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0xfc)]],_0x19bf02=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x12c)]],_0x15d150=[_0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x10d)]];else var _0x515401=[..._0x1bf0ec[_0x4bdadb(0xe8)]['prod_name']],_0x5c407c=[..._0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x16d)]],_0x3f3724=[..._0x1bf0ec['body']['from_prod_level']],_0x34d005=[..._0x1bf0ec['body'][_0x4bdadb(0xf1)]],_0x302da3=[..._0x1bf0ec[_0x4bdadb(0xe8)]['to_prod_level']],_0x1a0429=[..._0x1bf0ec[_0x4bdadb(0xe8)]['primary_code']],_0x5b7539=[..._0x1bf0ec['body']['secondary_code']],_0x5a21d5=[..._0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x145)]],_0x489f42=[..._0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x14e)]],_0x5917b8=[..._0x1bf0ec[_0x4bdadb(0xe8)]['unit']],_0x3cefce=[..._0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0xfc)]],_0x19bf02=[..._0x1bf0ec['body']['batch_code']],_0x15d150=[..._0x1bf0ec[_0x4bdadb(0xe8)][_0x4bdadb(0x10d)]];const _0x23e19a=_0x515401['map'](_0x15c7a7=>{return _0x15c7a7={'product_name':_0x15c7a7};});_0x5c407c['forEach']((_0x7a4cd3,_0x2ddd1c)=>{var _0xecb1df=_0x4bdadb;_0x23e19a[_0x2ddd1c][_0xecb1df(0x189)]=_0x7a4cd3;}),_0x3f3724['forEach']((_0x5bfa65,_0x3e3c38)=>{var _0x51a743=_0x4bdadb;_0x23e19a[_0x3e3c38][_0x51a743(0xb0)]=_0x5bfa65;}),_0x34d005[_0x4bdadb(0xd4)]((_0x3561ad,_0x4236e8)=>{_0x23e19a[_0x4236e8]['to_quantity']=_0x3561ad;}),_0x302da3[_0x4bdadb(0xd4)]((_0x2b511f,_0x32a7c2)=>{var _0x5363e=_0x4bdadb;_0x23e19a[_0x32a7c2][_0x5363e(0xca)]=_0x2b511f;}),_0x1a0429[_0x4bdadb(0xd4)]((_0x4118a8,_0x43fedc)=>{_0x23e19a[_0x43fedc]['primary_code']=_0x4118a8;}),_0x5b7539['forEach']((_0x2a73ce,_0x243da3)=>{_0x23e19a[_0x243da3]['secondary_code']=_0x2a73ce;}),_0x5a21d5[_0x4bdadb(0xd4)]((_0x21558b,_0x66b257)=>{var _0x221a7c=_0x4bdadb;_0x23e19a[_0x66b257][_0x221a7c(0xf9)]=_0x21558b;}),_0x489f42[_0x4bdadb(0xd4)]((_0x642e9b,_0x228466)=>{_0x23e19a[_0x228466]['maxProducts']=_0x642e9b;}),_0x5917b8[_0x4bdadb(0xd4)]((_0x27d321,_0x167b9e)=>{var _0x2003f3=_0x4bdadb;_0x23e19a[_0x167b9e][_0x2003f3(0x111)]=_0x27d321;}),_0x3cefce[_0x4bdadb(0xd4)]((_0x489a5b,_0x2cfe56)=>{var _0x108598=_0x4bdadb;_0x23e19a[_0x2cfe56][_0x108598(0xfc)]=_0x489a5b;}),_0x19bf02['forEach']((_0x5994d7,_0x1dacb3)=>{var _0x1a65d1=_0x4bdadb;_0x23e19a[_0x1dacb3][_0x1a65d1(0x12c)]=_0x5994d7;}),_0x15d150[_0x4bdadb(0xd4)]((_0x2169c1,_0x4433de)=>{var _0x3500e6=_0x4bdadb;_0x23e19a[_0x4433de][_0x3500e6(0x10d)]=_0x2169c1;});const _0x3b243a=_0x23e19a[_0x4bdadb(0xea)](_0x457b37=>_0x457b37[_0x4bdadb(0x12d)]!=='0'&&_0x457b37[_0x4bdadb(0x12d)]!==''||_0x457b37[_0x4bdadb(0xb9)]!=='0'&&_0x457b37[_0x4bdadb(0xb9)]!=='');var _0xc9d8ad=0x0;_0x3b243a[_0x4bdadb(0xd4)](_0x3430d6=>{var _0x3edcc0=_0x4bdadb;parseInt(_0x3430d6[_0x3edcc0(0x189)])<parseInt(_0x3430d6[_0x3edcc0(0x12d)])&&_0xc9d8ad++;});if(_0xc9d8ad!=0x0)return _0x1bf0ec[_0x4bdadb(0x13b)](_0x4bdadb(0x16e),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x1d1cc1[_0x4bdadb(0x11c)](_0x4bdadb(0xce));const _0xdfdf2b=await warehouse[_0x4bdadb(0x107)]({'name':_0x52d9c7[_0x4bdadb(0x141)],'room':_0x52d9c7[_0x4bdadb(0x13f)]});_0x52d9c7[_0x4bdadb(0x106)][_0x4bdadb(0xd4)](_0x2a3658=>{var _0x1eb91d=_0x4bdadb;if(_0x2a3658[_0x1eb91d(0x12d)]>0x0){const _0x4c6bbf=_0xdfdf2b[_0x1eb91d(0x160)][_0x1eb91d(0xe0)](_0x3a8046=>{var _0x3b983e=_0x1eb91d;_0x3a8046['product_name']==_0x2a3658['product_name']&&_0x3a8046[_0x3b983e(0xcc)]==_0x2a3658[_0x3b983e(0xb0)]&&(_0x3a8046[_0x3b983e(0xd1)]=parseInt(_0x3a8046[_0x3b983e(0xd1)])+parseInt(_0x2a3658['to_quantity']));});}}),await _0xdfdf2b[_0x4bdadb(0xd2)]();const _0x59d5e8=await warehouse['findOne']({'name':_0x52d9c7[_0x4bdadb(0x186)],'room':_0x52d9c7[_0x4bdadb(0xc6)]});_0x52d9c7[_0x4bdadb(0x106)][_0x4bdadb(0xd4)](_0x2c003e=>{var _0x2608d2=_0x4bdadb;if(_0x2c003e['to_quantity']>0x0){const _0x23bac9=_0x59d5e8[_0x2608d2(0x160)]['map'](_0xb2bef1=>{var _0x4490f3=_0x2608d2;_0xb2bef1[_0x4490f3(0xfe)]==_0x2c003e[_0x4490f3(0xfe)]&&_0xb2bef1[_0x4490f3(0xcc)]==_0x2c003e[_0x4490f3(0xca)]&&(_0xb2bef1[_0x4490f3(0xd1)]=parseInt(_0xb2bef1[_0x4490f3(0xd1)])-parseInt(_0x2c003e['to_quantity']));});}}),await _0x59d5e8[_0x4bdadb(0xd2)](),_0x52d9c7['date']=_0x455e6b,_0x52d9c7[_0x4bdadb(0x141)]=_0x5f535e,_0x52d9c7[_0x4bdadb(0x186)]=_0x256ded,_0x52d9c7[_0x4bdadb(0x106)]=_0x3b243a,_0x52d9c7['note']=_0x16ce69,_0x52d9c7[_0x4bdadb(0xcf)]=_0x2b0001;const _0x272b23=await _0x52d9c7['save'](),_0x1c3092=await warehouse[_0x4bdadb(0x107)]({'name':_0x5f535e,'room':_0x371a16});_0x272b23[_0x4bdadb(0x106)][_0x4bdadb(0xd4)](_0x572747=>{var _0x540c00=_0x4bdadb;if(_0x572747['to_quantity']>0x0){const _0x348b33=_0x1c3092[_0x540c00(0x160)][_0x540c00(0xe0)](_0x9a184d=>{var _0xbf286b=_0x540c00;_0x9a184d[_0xbf286b(0xfe)]==_0x572747[_0xbf286b(0xfe)]&&_0x9a184d[_0xbf286b(0xcc)]==_0x572747[_0xbf286b(0xb0)]&&(_0x9a184d[_0xbf286b(0xd1)]=parseInt(_0x9a184d[_0xbf286b(0xd1)])-parseInt(_0x572747['to_quantity']));});}}),await _0x1c3092[_0x4bdadb(0xd2)]();const _0x1a58e5=await warehouse[_0x4bdadb(0x107)]({'name':_0x256ded,'room':_0x39af2d});_0x272b23[_0x4bdadb(0x106)][_0x4bdadb(0xd4)](_0x4c0123=>{var _0x5ca947=_0x4bdadb;if(_0x4c0123[_0x5ca947(0x12d)]>0x0){var _0x7bbef3=0x0;const _0x3a2b6f=_0x1a58e5[_0x5ca947(0x160)][_0x5ca947(0xe0)](_0x220862=>{var _0x1459b3=_0x5ca947;_0x220862[_0x1459b3(0xfe)]==_0x4c0123[_0x1459b3(0xfe)]&&_0x220862[_0x1459b3(0xcc)]==_0x4c0123['to_bay']&&(_0x220862[_0x1459b3(0xd1)]=parseInt(_0x220862[_0x1459b3(0xd1)])+parseInt(_0x4c0123['to_quantity']),_0x7bbef3++);});_0x7bbef3=='0'&&(_0x1a58e5['product_details']=_0x1a58e5[_0x5ca947(0x160)][_0x5ca947(0x11b)]({'product_name':_0x4c0123['product_name'],'product_stock':_0x4c0123[_0x5ca947(0x12d)],'bay':_0x4c0123[_0x5ca947(0xca)],'product_code':_0x4c0123[_0x5ca947(0xf9)],'primary_code':_0x4c0123['primary_code'],'secondary_code':_0x4c0123[_0x5ca947(0xcb)],'maxProducts':_0x4c0123['maxProducts']}));}}),await _0x1a58e5['save'](),_0x1bf0ec[_0x4bdadb(0x13b)](_0x4bdadb(0x134),_0x4bdadb(0x18b)),_0x1d1cc1['redirect'](_0x4bdadb(0x17d));}catch(_0x5f5a29){console['log'](_0x5f5a29);}}),router[a0_0x3b180a(0x152)](a0_0x3b180a(0xd8),async(_0x50fb7c,_0x248cc7)=>{var _0x2a39df=a0_0x3b180a;const {FromWareHouse:_0x39162a,FromRoom:_0x42219e,ToWarehouse:_0x35b133,ToRoom:_0x1e5813,primary_code:_0x582ad3,Roomslist:_0xc24731}=_0x50fb7c[_0x2a39df(0xe8)],_0x42797e=_0xc24731[_0x2a39df(0x170)](','),_0x23d15e=[];async function _0x942d9d(_0x29039b){var _0x4f78d6=_0x2a39df;const _0x283e3b=await warehouse['aggregate']([{'$match':{'name':_0x39162a,'room':_0x29039b}},{'$unwind':_0x4f78d6(0x15b)},{'$match':{'product_details.primary_code':_0x582ad3}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x4f78d6(0x112)},'secondary_code':{'$first':_0x4f78d6(0xbb)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x4f78d6(0x10c)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x4f78d6(0x18a)},'pallet':{'$first':_0x4f78d6(0x102)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x4f78d6(0x105)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4f78d6(0x104)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x4f78d6(0xec)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':'$product_details.invoice'}}}]),_0x4fad23=await warehouse['aggregate']([{'$match':{'name':_0x39162a,'room':_0x29039b}},{'$unwind':_0x4f78d6(0x15b)},{'$match':{'product_details.secondary_code':_0x582ad3}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4f78d6(0xf0)},'instock':{'$first':_0x4f78d6(0xc2)},'primary_code':{'$first':_0x4f78d6(0x112)},'secondary_code':{'$first':_0x4f78d6(0xbb)},'product_code':{'$first':_0x4f78d6(0x10f)},'level':{'$first':_0x4f78d6(0x10c)},'isle':{'$first':_0x4f78d6(0x130)},'type':{'$first':_0x4f78d6(0x18a)},'pallet':{'$first':_0x4f78d6(0x102)},'unit':{'$first':_0x4f78d6(0xf2)},'secondary_unit':{'$first':_0x4f78d6(0x105)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x4f78d6(0x165)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x4f78d6(0xec)},'roomNamed':{'$first':_0x4f78d6(0x169)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x4f78d6(0x148)}}}]);if(_0x283e3b[_0x4f78d6(0xcd)]>0x0)_0x23d15e[_0x4f78d6(0xf4)](_0x283e3b);else _0x4fad23['length']>0x0&&_0x23d15e[_0x4f78d6(0xf4)](_0x4fad23);}const _0x2c877e=_0x42797e[_0x2a39df(0xe0)](_0x46ff73=>_0x942d9d(_0x46ff73));await Promise['all'](_0x2c877e),_0x248cc7[_0x2a39df(0x11a)](_0x23d15e);}),router[a0_0x3b180a(0x152)](a0_0x3b180a(0x123),async(_0x8554df,_0x2a41ec)=>{var _0x53df4c=a0_0x3b180a;try{const {FromWareHouse:_0x5680c0,FromRoom:_0x3413b9,ToWarehouse:_0x3480e9,ToRoom:_0x3d8f0b,secondary_code:_0x3b2c3b}=_0x8554df['body'],_0x24fcbb=await warehouse[_0x53df4c(0xc9)]([{'$match':{'name':_0x5680c0}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3b2c3b}},{'$group':{'_id':_0x53df4c(0xd0),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x53df4c(0x112)},'secondary_code':{'$first':_0x53df4c(0xbb)},'product_code':{'$first':_0x53df4c(0x10f)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x53df4c(0x128)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x53df4c(0x177)},'pallet':{'$first':_0x53df4c(0x133)},'maxProducts':{'$first':_0x53df4c(0xc1)},'unit':{'$first':_0x53df4c(0xf2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x53df4c(0x150)}}}]);_0x2a41ec[_0x53df4c(0x17e)](0xc8)['json'](_0x24fcbb);}catch(_0x488163){_0x2a41ec[_0x53df4c(0x17e)](0x194)[_0x53df4c(0x11a)]({'message':_0x488163['message']});}}),router[a0_0x3b180a(0x152)](a0_0x3b180a(0xde),async(_0x177433,_0x5a666c)=>{var _0x28d3da=a0_0x3b180a;try{const {FromWareHouse:_0x23b9cb,FromRoom:_0x4c2929,ToWarehouse:_0x1ede7b,ToRoom:_0x5cbd04,product_code:_0x317724}=_0x177433[_0x28d3da(0xe8)],_0xec6927=await warehouse[_0x28d3da(0xc9)]([{'$match':{'name':_0x23b9cb}},{'$unwind':_0x28d3da(0x15b)},{'$match':{'product_details.product_code':_0x317724}},{'$group':{'_id':_0x28d3da(0xd0),'name':{'$first':_0x28d3da(0xf0)},'primary_code':{'$first':_0x28d3da(0x112)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x28d3da(0x10f)},'instock':{'$first':_0x28d3da(0xc2)},'warehouse':{'$first':_0x28d3da(0x128)},'level':{'$first':_0x28d3da(0xb3)},'isle':{'$first':_0x28d3da(0x177)},'pallet':{'$first':_0x28d3da(0x133)},'maxProducts':{'$first':_0x28d3da(0xc1)},'unit':{'$first':'$product_details.unit'}}}]);_0x5a666c[_0x28d3da(0x17e)](0xc8)[_0x28d3da(0x11a)](_0xec6927);}catch(_0x4ddb39){_0x5a666c[_0x28d3da(0x17e)](0x194)['json']({'message':_0x4ddb39['message']});}}),router['post'](a0_0x3b180a(0x100),async(_0x45197e,_0x2f22be)=>{var _0x2857bd=a0_0x3b180a;const {productCode:_0x30987b,bay:_0x153500,warehouses:_0xd6e1ba,room:_0x211936}=_0x45197e[_0x2857bd(0xe8)];console[_0x2857bd(0x110)](_0x45197e['body']);try{const _0x4ca49b=await warehouse[_0x2857bd(0xc9)]([{'$match':{'name':_0xd6e1ba,'room':_0x211936}},{'$unwind':_0x2857bd(0x15b)},{'$match':{'product_details.bay':parseInt(_0x153500)}},{'$group':{'_id':_0x2857bd(0xd0),'name':{'$first':_0x2857bd(0xf0)},'product_stock':{'$first':_0x2857bd(0xc2)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x2857bd(0xc1)}}}]);_0x2f22be[_0x2857bd(0x17e)](0xc8)[_0x2857bd(0x11a)](_0x4ca49b);}catch(_0x30844a){_0x2f22be[_0x2857bd(0x17e)](0x194)[_0x2857bd(0x11a)]({'message':_0x30844a['message']});}}),module[a0_0x3b180a(0xfd)]=router;function a0_0x148c(){var _0x1fdd4d=['RoomAssigned','Rack\x201','prod_name','../models/all_models','/barcode_scanner3','maxPerUnit','map','<tr>','Ambient','/view','Spanish','from_room_name','error','$date','body','English','filter','createTransport','$product_details.maxPerUnit','Hindi','51466SzBieo','\x20Order\x20Date\x20:\x20','$product_details.product_name','to_prod_qty','$product_details.unit','<div>','push','padStart','German','floor','getDate','product_code','Rack\x202','all','secondary_unit','exports','product_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','/CheckingWarehouse','DRY\x20GOODS','$product_details.floorlevel','prod_cat','$product_details.expiry_date','$product_details.secondary_unit','product','findOne','from_prod_level','$product_details.storage','Logo.png','</tr>','$product_details.bay','expiry_date','MaxStocks_data','$product_details.product_code','log','unit','$product_details.primary_code','</td>','</span>','here2','Finished\x20Goods','to_prod_level','An\x20error\x20occurred\x20while\x20saving\x20data.','slice','json','concat','redirect','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','undefined','staff','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','email','True','/barcode_scanner2','image','New_Qty_Converted','$finalize','<h5>','$name','render','transfer_finished','<tbody\x20style=\x22text-align:\x20center;\x22>','batch_code','to_quantity','<strong>\x20Regards\x20</strong>','then','$product_details.bin','catch','to_room_name','$product_details.pallet','success','\x20Order\x20Number\x20:\x20','_id','\x20</h2>','Portuguese\x20(BR)','finalize','English\x20(US)','flash','nodemailer','to_invoice','3745302UZqSUL','from_room','</div>','from_warehouse','id_transaction','/view/add_transfer','QA\x20Warehouse','product_code3','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product.from_room_name','$product_details.invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<span\x20style=\x22float:\x20right;\x22>','</tbody>','369QlOBvB','871176YENmGy','MaxStocks_data2','TRFF-','$product_details.production_date','8hnzesc','post','There\x27s\x20a\x20error\x20in\x20this\x20transaction','4640lPjpxX','French','message','30321JpGpSy','password','Portuguese','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details','Product\x20Transfer\x20successfully','site_title','Transfer\x20Mail','/upload/','product_details','10696xRkWAa','role','findById','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.rack','</head><body>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','Error\x20Occurs','$room','<html><head><title></title>','port','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','from_prod_qty','errors','$from_warehouse','split','express','<!DOCTYPE\x20html>','primary_unit','transfer_data','126BqXZbu','language','$product_details.isle','</table>','date','abs','Chinese','Arabic','/transfer_finished/view','status','get','Transfer\x20Finalize\x20Successfully','find','$product.to_room_name','$invoice','ToRoomAssigned','toString','to_warehouse','string','/picking_list/PDF_transfer/','from_quantity','$product_details.type','Transfer\x20Edit\x20Successfully','from_invoice','params','/preview/:id','</thead>','max','from_bay','maxProducts','updateOne','$product_details.level','An\x20error\x20occurred.','<hr\x20class=\x22my-3\x22>','add_transfer_finished','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Arabic\x20(ae)','to_floorlevel','90MewaQL','$product_details.secondary_code','host','warehouse','To_invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','Enabled','$product_details.maxProducts','$product_details.product_stock','$to_warehouse','</h5>','user','to_room','70860PKwrRG','Enclosed','aggregate','to_bay','secondary_code','bay','length','back','invoice','$product_details._id','product_stock','save','\x20<>\x20','forEach','primary_code','production_date','/view/:id','/barcode_scanner','product_date'];a0_0x148c=function(){return _0x1fdd4d;};return a0_0x148c();}