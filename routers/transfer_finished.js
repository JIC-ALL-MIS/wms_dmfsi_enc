function a0_0x4e1e(){var _0x35385b=['$product_details.primary_code','$product_details.product_code','RoomAssigned','primary_code','Router','to_floorlevel','Chinese','updateOne','date','<h5\x20style=\x22text-align:\x20left;\x22>','to_room_name','sendMail','MaxStocks_data2','$finalize','/transfer/view','staff','aggregate','body','MaxStocks_data','params','<h5>','Ambient','Finished\x20Goods','undefined','Rack\x201','</body></html>','then','Product\x20Transfer\x20successfully','7ZtbZBs','length','New_Qty_Converted','find','FGSEmail','maxPerUnit','$product_details.maxProducts','</thead>','/upload/','role','$product_details.maxPerUnit','\x20Order\x20Number\x20:\x20','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','render','Rack\x202','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','abs','from_bay','<html><head><title></title>','$product_details.production_date','</head><body>','success','findById','$product_details.floorlevel','to_prod_qty','status','invoice','$product_details.level','</table>','11ddNJbD','user','product','/../public','$product_details._id','maxProducts','product_date','product_stock','push','/picking_list/PDF_transfer/','warehouse','Hindi','Portuguese','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','nodemailer','product_details','id_transaction','/view/add_transfer','image','../public/language/languages.json','to_room','product_name','email','error','FROZEN\x20GOODS','product_code3','from_prod_qty','message','site_title','$product_details.rack','edit_transfer_finished','product_code','max','bay','expiry_date','production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','French','15447690mBpqXX','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$product_details.unit','1954917JBxSEC','1CYdaao','<strong>\x20Regards\x20</strong>','all','to_warehouse','from_invoice','Portuguese\x20(BR)','transfer_finished','save','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','\x20<=>\x20','$product_details.secondary_code','string','5490872jtHXNi','forEach','</span>','</td>','$product_details.product_name','$product_details.pallet','edit_transfer_finished_view','createTransport','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','Spanish','port','prod_cat','2676900CFXmwD','$product.to_room_name','/barcode_scanner','_id','/view/:id','toString','transfer_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','$product_details.batch_code','exports','concat','post','$name','\x20</h2>','$product_details.invoice','Logo.png','../models/all_models','to_prod_level','from_quantity','Enclosed','json','<!DOCTYPE\x20html>','284QLRres','findOne','$product_details.bin','slice','language','185090HOSwui','to_bay','prod_name','filter','English\x20(US)','from_room_name','Error\x20Occurs','from_room','get','from_warehouse','$to_warehouse','$product_details.isle','getFullYear','<tr>','QA\x20Warehouse','$product.from_room_name','padStart','TRFF-','$product_details.product_stock','split','</tbody>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','redirect','$invoice','from_prod_level','/transfer_finished/preview/','English','/preview/:id','Enabled','$room','primary_unit','</div>','</tr>','$from_warehouse','batch_code','55415qHZdiD','An\x20error\x20occurred\x20while\x20saving\x20data.','to_quantity','<div>','\x20Order\x20Date\x20:\x20','password','<h2>\x20','log','flash','to_invoice','To_invoice','An\x20error\x20occurred.','Transfer\x20Mail','German','/CheckingWarehouse','DRY\x20GOODS','ToRoomAssigned','map','host','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','here1','express','</h5>','<span\x20style=\x22float:\x20right;\x22>','$product_details.type','unit','$product_details.storage','<hr\x20class=\x22my-3\x22>','$product_details.secondary_unit','$_id','Arabic','catch','Arabic\x20(ae)','$product_details','errors','$product_details.expiry_date','secondary_code','random','5877630FaghIr','True','/transfer_finished/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.bay','back','$date'];a0_0x4e1e=function(){return _0x35385b;};return a0_0x4e1e();}var a0_0x38a2ab=a0_0x189e;(function(_0x160150,_0x2fc22e){var _0xb7522=a0_0x189e,_0x3cff33=_0x160150();while(!![]){try{var _0x571a60=parseInt(_0xb7522(0x1c8))/0x1*(parseInt(_0xb7522(0x1fb))/0x2)+parseInt(_0xb7522(0x1c7))/0x3+-parseInt(_0xb7522(0x1f6))/0x4*(-parseInt(_0xb7522(0x21e))/0x5)+parseInt(_0xb7522(0x1e0))/0x6+-parseInt(_0xb7522(0x267))/0x7*(parseInt(_0xb7522(0x1d4))/0x8)+parseInt(_0xb7522(0x244))/0x9+-parseInt(_0xb7522(0x1c4))/0xa*(parseInt(_0xb7522(0x285))/0xb);if(_0x571a60===_0x2fc22e)break;else _0x3cff33['push'](_0x3cff33['shift']());}catch(_0x26d7ab){_0x3cff33['push'](_0x3cff33['shift']());}}}(a0_0x4e1e,0x61741));const express=require(a0_0x38a2ab(0x233)),app=express(),router=express[a0_0x38a2ab(0x24f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x38a2ab(0x1f0)),auth=require('../middleware/auth'),users=require(a0_0x38a2ab(0x298)),nodemailer=require(a0_0x38a2ab(0x293));function a0_0x189e(_0x536995,_0x927365){var _0x4e1e64=a0_0x4e1e();return a0_0x189e=function(_0x189ef1,_0x56d33e){_0x189ef1=_0x189ef1-0x1b4;var _0x516ede=_0x4e1e64[_0x189ef1];return _0x516ede;},a0_0x189e(_0x536995,_0x927365);}router['get']('/view',auth,async(_0x52f386,_0x11808)=>{var _0x32a270=a0_0x38a2ab;try{const {username:_0x1033db,email:_0x170f22,role:_0x722ce2}=_0x52f386[_0x32a270(0x286)],_0x49f00b=_0x52f386[_0x32a270(0x286)],_0x1297c1=await profile[_0x32a270(0x1f7)]({'email':_0x49f00b[_0x32a270(0x1b4)]}),_0x18e088=await master_shop['find']();let _0x22b3ce;if(_0x49f00b[_0x32a270(0x270)]==_0x32a270(0x25a)){const _0x591dd5=await staff['findOne']({'email':_0x49f00b[_0x32a270(0x1b4)]});_0x22b3ce=await transfers_finished[_0x32a270(0x26a)]({'from_warehouse':_0x591dd5[_0x32a270(0x28f)]});}else _0x22b3ce=await transfers_finished[_0x32a270(0x25b)]([{'$unwind':'$product'},{'$group':{'_id':_0x32a270(0x23b),'invoice':{'$first':_0x32a270(0x212)},'date':{'$first':_0x32a270(0x24a)},'from_warehouse':{'$first':_0x32a270(0x21c)},'to_warehouse':{'$first':_0x32a270(0x205)},'from_room_name':{'$addToSet':_0x32a270(0x20a)},'to_room_name':{'$addToSet':_0x32a270(0x1e1)},'finalize':{'$first':_0x32a270(0x258)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x18e088[0x0][_0x32a270(0x1fa)]==_0x32a270(0x1ff))var _0x568627=users[_0x32a270(0x215)];else{if(_0x18e088[0x0]['language']==_0x32a270(0x290))var _0x568627=users['Hindi'];else{if(_0x18e088[0x0]['language']==_0x32a270(0x22b))var _0x568627=users['German'];else{if(_0x18e088[0x0][_0x32a270(0x1fa)]=='Spanish')var _0x568627=users[_0x32a270(0x1dd)];else{if(_0x18e088[0x0][_0x32a270(0x1fa)]==_0x32a270(0x1c3))var _0x568627=users[_0x32a270(0x1c3)];else{if(_0x18e088[0x0][_0x32a270(0x1fa)]=='Portuguese\x20(BR)')var _0x568627=users['Portuguese'];else{if(_0x18e088[0x0][_0x32a270(0x1fa)]==_0x32a270(0x251))var _0x568627=users[_0x32a270(0x251)];else{if(_0x18e088[0x0][_0x32a270(0x1fa)]==_0x32a270(0x23e))var _0x568627=users[_0x32a270(0x23c)];}}}}}}}_0x11808[_0x32a270(0x274)](_0x32a270(0x1ce),{'success':_0x52f386[_0x32a270(0x226)](_0x32a270(0x27d)),'errors':_0x52f386[_0x32a270(0x226)](_0x32a270(0x240)),'role':_0x49f00b,'profile':_0x1297c1,'master_shop':_0x18e088,'transfer':_0x22b3ce,'language':_0x568627});}catch(_0x350bf0){console['log'](_0x350bf0);}});async function getRandom8DigitNumber(){var _0xede795=a0_0x38a2ab;const _0x5832d3=0x989680,_0x409e9c=0x5f5e0ff,_0x388f08=Math['floor'](Math[_0xede795(0x243)]()*(_0x409e9c-_0x5832d3+0x1))+_0x5832d3;var _0x3396b8;const _0x4c454f=await transfers_finished[_0xede795(0x1f7)]({'invoice':_0xede795(0x20c)+_0x388f08});return _0x4c454f&&_0x4c454f['length']>0x0?_0x3396b8=_0xede795(0x20c)+_0x388f08:_0x3396b8='TRFF-'+_0x388f08,_0x3396b8;}router[a0_0x38a2ab(0x203)](a0_0x38a2ab(0x296),auth,async(_0x35f753,_0x19ee70)=>{var _0x33f210=a0_0x38a2ab;try{const {username:_0x48b97a,email:_0x52aa02,role:_0x378550}=_0x35f753['user'],_0x9fcc7d=_0x35f753[_0x33f210(0x286)],_0x2b733a=await profile[_0x33f210(0x1f7)]({'email':_0x9fcc7d[_0x33f210(0x1b4)]}),_0x33f975=await master_shop[_0x33f210(0x26a)]();let _0x5cc8fd;if(_0x9fcc7d[_0x33f210(0x270)]==_0x33f210(0x25a)){const _0x8c2f59=await staff[_0x33f210(0x1f7)]({'email':_0x9fcc7d[_0x33f210(0x1b4)]});_0x5cc8fd=await warehouse[_0x33f210(0x25b)]([{'$match':{'status':_0x33f210(0x217),'name':_0x8c2f59['warehouse'],'warehouse_category':_0x33f210(0x261),'name':{'$ne':_0x33f210(0x209)}}},{'$group':{'_id':'$name','name':{'$first':_0x33f210(0x1ec)}}}]);}else _0x5cc8fd=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x33f210(0x261),'name':{'$ne':_0x33f210(0x209)}}},{'$group':{'_id':_0x33f210(0x1ec),'name':{'$first':_0x33f210(0x1ec)}}}]);const _0x50390f=await transfers_finished[_0x33f210(0x26a)]({}),_0x1926ca=_0x50390f[_0x33f210(0x268)]+0x1,_0x1cc67e=_0x33f210(0x20c)+_0x1926ca[_0x33f210(0x1e5)]()[_0x33f210(0x20b)](0x5,'0');if(_0x33f975[0x0][_0x33f210(0x1fa)]==_0x33f210(0x1ff))var _0x1f06db=users[_0x33f210(0x215)];else{if(_0x33f975[0x0][_0x33f210(0x1fa)]==_0x33f210(0x290))var _0x1f06db=users[_0x33f210(0x290)];else{if(_0x33f975[0x0][_0x33f210(0x1fa)]==_0x33f210(0x22b))var _0x1f06db=users[_0x33f210(0x22b)];else{if(_0x33f975[0x0][_0x33f210(0x1fa)]=='Spanish')var _0x1f06db=users[_0x33f210(0x1dd)];else{if(_0x33f975[0x0][_0x33f210(0x1fa)]==_0x33f210(0x1c3))var _0x1f06db=users[_0x33f210(0x1c3)];else{if(_0x33f975[0x0]['language']==_0x33f210(0x1cd))var _0x1f06db=users[_0x33f210(0x291)];else{if(_0x33f975[0x0][_0x33f210(0x1fa)]==_0x33f210(0x251))var _0x1f06db=users['Chinese'];else{if(_0x33f975[0x0]['language']==_0x33f210(0x23e))var _0x1f06db=users[_0x33f210(0x23c)];}}}}}}}const _0x4a79d3=getRandom8DigitNumber();_0x4a79d3[_0x33f210(0x265)](_0x558bc2=>{var _0x2882d8=_0x33f210;_0x19ee70[_0x2882d8(0x274)]('add_transfer_finished',{'success':_0x35f753[_0x2882d8(0x226)]('success'),'errors':_0x35f753[_0x2882d8(0x226)](_0x2882d8(0x240)),'role':_0x9fcc7d,'profile':_0x2b733a,'master_shop':_0x33f975,'warehouse':_0x5cc8fd,'language':_0x1f06db,'invoice':_0x558bc2});})['catch'](_0x1d238b=>{var _0xb7dba9=_0x33f210;_0x35f753['flash'](_0xb7dba9(0x240),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x19ee70[_0xb7dba9(0x211)](_0xb7dba9(0x259));});}catch(_0x5af5bd){console[_0x33f210(0x225)](_0x5af5bd);}}),router[a0_0x38a2ab(0x1eb)]('/view/add_transfer',auth,async(_0x702408,_0xfe2744)=>{var _0x4a15ef=a0_0x38a2ab;try{const {date:_0x269f5f,from_warehouse:_0x45ca7b,FromRoom_name:_0x30c6f6,to_warehouse:_0x4a6b5a,ToRoom_name:_0x441f18,prod_name:_0x361a7e,from_prod_qty:_0x1d0c3d,from_prod_level:_0x233342,from_prod_isle:_0x45ae4e,from_prod_pallet:_0x3ec0f1,to_prod_qty:_0x2b428f,to_prod_level:_0x566f6e,to_prod_isle:_0x4a5ae0,to_prod_pallet:_0x304577,primary_code:_0x3fcdae,secondary_code:_0x3f1e49,product_code3:_0x113d0e,note:_0x2ce77a,MaxStocks_data2:_0x4134f3,invoice:_0x160fd0,expiry_date:_0xee8bc0}=_0x702408[_0x4a15ef(0x25c)];if(typeof _0x361a7e==_0x4a15ef(0x1d3))var _0xc4cebf=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x1fd)]],_0x101ffb=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x1b8)]],_0x3f39f7=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x213)]],_0x1a77bc=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x269)]],_0x1b54ff=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x1f1)]],_0x169b9f=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x24e)]],_0x29d5e3=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x242)]],_0x48d51a=[_0x702408['body'][_0x4a15ef(0x1b7)]],_0x42e963=[_0x702408['body'][_0x4a15ef(0x257)]],_0x2cbab9=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x219)]],_0x17c603=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x276)]],_0x4f8b24=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x21d)]],_0x28f5c2=[_0x702408['body']['expiry_date']],_0x4fd715=[_0x702408[_0x4a15ef(0x25c)]['product_date']],_0x583447=[_0x702408[_0x4a15ef(0x25c)]['MaxStocks_data']],_0x8ddc3c=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x26c)]],_0x269aa6=[_0x702408['body']['prod_cat']],_0x3e6c3a=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x24d)]],_0x20386c=[_0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x22e)]],_0x299c4a=[_0x702408[_0x4a15ef(0x25c)]['from_invoice']],_0x32bee0=[_0x702408[_0x4a15ef(0x25c)]['to_invoice']],_0x378c3e=[_0x702408['body'][_0x4a15ef(0x295)]];else var _0xc4cebf=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x1fd)]],_0x101ffb=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x1b8)]],_0x3f39f7=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x213)]],_0x1a77bc=[..._0x702408['body'][_0x4a15ef(0x269)]],_0x1b54ff=[..._0x702408['body'][_0x4a15ef(0x1f1)]],_0x169b9f=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x24e)]],_0x29d5e3=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x242)]],_0x48d51a=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x1b7)]],_0x42e963=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x257)]],_0x2cbab9=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x219)]],_0x17c603=[..._0x702408[_0x4a15ef(0x25c)]['secondary_unit']],_0x4f8b24=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x21d)]],_0x28f5c2=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x1c0)]],_0x4fd715=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x28b)]],_0x583447=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x25d)]],_0x8ddc3c=[..._0x702408['body']['maxPerUnit']],_0x269aa6=[..._0x702408['body'][_0x4a15ef(0x1df)]],_0x3e6c3a=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x24d)]],_0x20386c=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x22e)]],_0x299c4a=[..._0x702408['body'][_0x4a15ef(0x1cc)]],_0x32bee0=[..._0x702408[_0x4a15ef(0x25c)][_0x4a15ef(0x227)]],_0x378c3e=[..._0x702408['body'][_0x4a15ef(0x295)]];const _0x22cc75=_0xc4cebf[_0x4a15ef(0x22f)](_0x5f6f6c=>{return _0x5f6f6c={'product_name':_0x5f6f6c};});_0x101ffb[_0x4a15ef(0x1d5)]((_0x2746de,_0x1b5fc9)=>{var _0x1367e2=_0x4a15ef;_0x22cc75[_0x1b5fc9][_0x1367e2(0x1f2)]=_0x2746de;}),_0x3f39f7[_0x4a15ef(0x1d5)]((_0x23a8cb,_0x1c8930)=>{var _0x49fa64=_0x4a15ef;_0x22cc75[_0x1c8930][_0x49fa64(0x279)]=_0x23a8cb;}),_0x378c3e[_0x4a15ef(0x1d5)]((_0x192783,_0x92f327)=>{_0x22cc75[_0x92f327]['id_transaction']=_0x192783;}),_0x299c4a[_0x4a15ef(0x1d5)]((_0x27beee,_0x1a9b46)=>{var _0x494e85=_0x4a15ef;_0x22cc75[_0x1a9b46][_0x494e85(0x1cc)]=_0x27beee;}),_0x32bee0['forEach']((_0xc8e2d7,_0x1eb68c)=>{var _0xd77f0a=_0x4a15ef;_0x22cc75[_0x1eb68c][_0xd77f0a(0x228)]=_0xc8e2d7;}),_0x1a77bc[_0x4a15ef(0x1d5)]((_0x244da0,_0x26ee52)=>{var _0xa25e29=_0x4a15ef;_0x22cc75[_0x26ee52][_0xa25e29(0x220)]=_0x244da0;}),_0x1b54ff['forEach']((_0x3d7690,_0x430f9e)=>{var _0x3fd30a=_0x4a15ef;_0x22cc75[_0x430f9e][_0x3fd30a(0x1fc)]=_0x3d7690;}),_0x169b9f[_0x4a15ef(0x1d5)]((_0xfbac92,_0x72cbc5)=>{var _0x5042a4=_0x4a15ef;_0x22cc75[_0x72cbc5][_0x5042a4(0x24e)]=_0xfbac92;}),_0x29d5e3[_0x4a15ef(0x1d5)]((_0x21037c,_0x1da2ef)=>{var _0x1a6902=_0x4a15ef;_0x22cc75[_0x1da2ef][_0x1a6902(0x242)]=_0x21037c;}),_0x48d51a[_0x4a15ef(0x1d5)]((_0x1dbda1,_0x4efc82)=>{_0x22cc75[_0x4efc82]['product_code']=_0x1dbda1;}),_0x42e963[_0x4a15ef(0x1d5)]((_0x5376ac,_0x1f42c1)=>{var _0x5dc73e=_0x4a15ef;_0x22cc75[_0x1f42c1][_0x5dc73e(0x28a)]=_0x5376ac;}),_0x2cbab9['forEach']((_0x4fd650,_0x496033)=>{var _0x29080b=_0x4a15ef;_0x22cc75[_0x496033][_0x29080b(0x237)]=_0x4fd650;}),_0x17c603[_0x4a15ef(0x1d5)]((_0x5c71af,_0x54c063)=>{_0x22cc75[_0x54c063]['secondary_unit']=_0x5c71af;}),_0x4f8b24[_0x4a15ef(0x1d5)]((_0x3a1023,_0x2f9ef9)=>{_0x22cc75[_0x2f9ef9]['batch_code']=_0x3a1023;}),_0x28f5c2[_0x4a15ef(0x1d5)]((_0x47992f,_0x191a59)=>{var _0x12e4d1=_0x4a15ef;_0x22cc75[_0x191a59][_0x12e4d1(0x1c0)]=_0x47992f;}),_0x4fd715['forEach']((_0x287d5a,_0x249e58)=>{_0x22cc75[_0x249e58]['production_date']=_0x287d5a;}),_0x583447['forEach']((_0x32746d,_0x5b0893)=>{_0x22cc75[_0x5b0893]['maxProducts']=_0x32746d;}),_0x8ddc3c[_0x4a15ef(0x1d5)]((_0x1d2173,_0x1398ae)=>{var _0x1ece8b=_0x4a15ef;_0x22cc75[_0x1398ae][_0x1ece8b(0x26c)]=_0x1d2173;}),_0x269aa6[_0x4a15ef(0x1d5)]((_0x2e0f57,_0x261bae)=>{_0x22cc75[_0x261bae]['prod_cat']=_0x2e0f57;}),_0x3e6c3a[_0x4a15ef(0x1d5)]((_0x2849dd,_0x327f30)=>{_0x22cc75[_0x327f30]['from_room_name']=_0x2849dd;}),_0x20386c['forEach']((_0x569259,_0x108387)=>{var _0x37df88=_0x4a15ef;_0x22cc75[_0x108387][_0x37df88(0x255)]=_0x569259;});const _0x12db91=_0x22cc75['filter'](_0x45e657=>_0x45e657[_0x4a15ef(0x220)]!=='0'&&_0x45e657['to_quantity']!==''||_0x45e657[_0x4a15ef(0x250)]!=='0'&&_0x45e657['to_floorlevel']!=='');var _0x18e431=0x0;_0x12db91[_0x4a15ef(0x1d5)](_0x439e8c=>{var _0x1a6793=_0x4a15ef;parseInt(_0x439e8c[_0x1a6793(0x1f2)])<parseInt(_0x439e8c[_0x1a6793(0x220)])&&_0x18e431++;});if(_0x18e431!=0x0)return _0x702408[_0x4a15ef(0x226)]('errors',_0x4a15ef(0x273)),_0xfe2744[_0x4a15ef(0x211)](_0x4a15ef(0x249));const _0x3f8116=new transfers_finished({'date':_0x269f5f,'from_warehouse':_0x45ca7b,'to_warehouse':_0x4a6b5a,'product':_0x12db91,'note':_0x2ce77a,'invoice':_0x160fd0}),_0xd08d5=await _0x3f8116['save']();_0x702408['flash'](_0x4a15ef(0x27d),_0x4a15ef(0x266)),_0xfe2744['redirect'](_0x4a15ef(0x214)+_0xd08d5[_0x4a15ef(0x1e3)]);}catch(_0x3483ce){console['log'](_0x3483ce),_0xfe2744[_0x4a15ef(0x281)](0xc8)['json']({'errorMessage':_0x3483ce[_0x4a15ef(0x1b9)]});}}),router[a0_0x38a2ab(0x203)](a0_0x38a2ab(0x216),auth,async(_0x1c7bfe,_0x326d9f)=>{var _0x30c0e5=a0_0x38a2ab;try{const {username:_0x3ebb5d,email:_0x546e6b,role:_0xd03ddb}=_0x1c7bfe[_0x30c0e5(0x286)],_0x31810a=_0x1c7bfe[_0x30c0e5(0x286)],_0x2285f9=await profile['findOne']({'email':_0x31810a[_0x30c0e5(0x1b4)]}),_0x41b9d9=await master_shop[_0x30c0e5(0x26a)](),_0x177458=await transfers_finished[_0x30c0e5(0x27e)](_0x1c7bfe[_0x30c0e5(0x25e)]['id']);let _0x212882;if(_0x31810a[_0x30c0e5(0x270)]=='staff'){const _0x20fdb3=await staff['findOne']({'email':_0x31810a[_0x30c0e5(0x1b4)]});_0x212882=await warehouse[_0x30c0e5(0x26a)]({'status':_0x30c0e5(0x217),'name':_0x20fdb3[_0x30c0e5(0x28f)],'warehouse_category':_0x30c0e5(0x261)});}else _0x212882=await warehouse[_0x30c0e5(0x26a)]({'status':_0x30c0e5(0x217),'warehouse_category':'Finished\x20Goods'});const _0x10e741=await warehouse[_0x30c0e5(0x25b)]([{'$match':{'name':_0x177458[_0x30c0e5(0x204)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x30c0e5(0x23f)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x30c0e5(0x1d8)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x30c0e5(0x248)},'bin':{'$first':_0x30c0e5(0x1f8)},'type':{'$first':_0x30c0e5(0x236)},'floorlevel':{'$first':_0x30c0e5(0x27f)},'primary_code':{'$first':_0x30c0e5(0x24b)},'secondary_code':{'$first':_0x30c0e5(0x1d2)},'product_code':{'$first':_0x30c0e5(0x24c)},'storage':{'$first':_0x30c0e5(0x238)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x30c0e5(0x241)},'production_date':{'$first':_0x30c0e5(0x27b)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x30c0e5(0x1ec)}}}]),_0x375510=await product[_0x30c0e5(0x26a)]({});if(_0x41b9d9[0x0][_0x30c0e5(0x1fa)]==_0x30c0e5(0x1ff)){var _0x4c7e4d=users[_0x30c0e5(0x215)];console[_0x30c0e5(0x225)](_0x4c7e4d);}else{if(_0x41b9d9[0x0]['language']==_0x30c0e5(0x290))var _0x4c7e4d=users[_0x30c0e5(0x290)];else{if(_0x41b9d9[0x0][_0x30c0e5(0x1fa)]==_0x30c0e5(0x22b))var _0x4c7e4d=users[_0x30c0e5(0x22b)];else{if(_0x41b9d9[0x0][_0x30c0e5(0x1fa)]==_0x30c0e5(0x1dd))var _0x4c7e4d=users[_0x30c0e5(0x1dd)];else{if(_0x41b9d9[0x0]['language']==_0x30c0e5(0x1c3))var _0x4c7e4d=users['French'];else{if(_0x41b9d9[0x0]['language']==_0x30c0e5(0x1cd))var _0x4c7e4d=users[_0x30c0e5(0x291)];else{if(_0x41b9d9[0x0][_0x30c0e5(0x1fa)]==_0x30c0e5(0x251))var _0x4c7e4d=users['Chinese'];else{if(_0x41b9d9[0x0][_0x30c0e5(0x1fa)]==_0x30c0e5(0x23e))var _0x4c7e4d=users[_0x30c0e5(0x23c)];}}}}}}}_0x326d9f['render'](_0x30c0e5(0x1da),{'success':_0x1c7bfe['flash'](_0x30c0e5(0x27d)),'errors':_0x1c7bfe[_0x30c0e5(0x226)]('errors'),'role':_0x31810a,'profile':_0x2285f9,'master_shop':_0x41b9d9,'warehouse':_0x212882,'transfer':_0x177458,'stock':_0x10e741,'unit':_0x375510,'language':_0x4c7e4d});}catch(_0x21ef95){console[_0x30c0e5(0x225)](_0x21ef95);}}),router[a0_0x38a2ab(0x1eb)](a0_0x38a2ab(0x216),auth,async(_0x189bd1,_0xceb9d5)=>{var _0x8dd565=a0_0x38a2ab;try{const {invoice:_0x1e98df,from_warehouse:_0x3f2681,FromRoom_name:_0xd8dd3f,to_warehouse:_0x1a90cc,ToRoom_name:_0x2308d0}=_0x189bd1[_0x8dd565(0x25c)],_0x1435b2=await transfers_finished[_0x8dd565(0x27e)](_0x189bd1[_0x8dd565(0x25e)]['id']),_0x39bfa7=_0x1435b2[_0x8dd565(0x287)][_0x8dd565(0x22f)](async _0x18ae4c=>{var _0x35c1fc=_0x8dd565;if(_0x18ae4c[_0x35c1fc(0x220)]>0x0){var _0x200b28=await warehouse[_0x35c1fc(0x1f7)]({'name':_0x3f2681,'room':_0x18ae4c[_0x35c1fc(0x200)],'warehouse_category':_0x35c1fc(0x261)});const _0x389529=_0x200b28[_0x35c1fc(0x294)][_0x35c1fc(0x22f)](_0x310fe8=>{var _0x171b7f=_0x35c1fc;_0x310fe8[_0x171b7f(0x29a)]==_0x18ae4c[_0x171b7f(0x29a)]&&_0x310fe8[_0x171b7f(0x1bf)]==_0x18ae4c[_0x171b7f(0x279)]&&_0x310fe8[_0x171b7f(0x1c0)]==_0x18ae4c[_0x171b7f(0x1c0)]&&_0x310fe8[_0x171b7f(0x1c1)]==_0x18ae4c['production_date']&&_0x310fe8[_0x171b7f(0x21d)]==_0x18ae4c['batch_code']&&_0x310fe8['invoice']==_0x18ae4c[_0x171b7f(0x1cc)]&&(console['log'](_0x171b7f(0x232),_0x310fe8[_0x171b7f(0x28c)]),typeof _0x18ae4c[_0x171b7f(0x295)]==_0x171b7f(0x262)?_0x310fe8[_0x171b7f(0x28c)]=Math['max'](0x0,Math[_0x171b7f(0x278)](_0x310fe8['product_stock'])-Math[_0x171b7f(0x278)](_0x18ae4c[_0x171b7f(0x220)])):_0x310fe8[_0x171b7f(0x28c)]=Math[_0x171b7f(0x1be)](0x0,Math['abs'](_0x310fe8['product_stock'])-Math[_0x171b7f(0x278)](_0x18ae4c['to_quantity'])));});}return _0x200b28;});Promise[_0x8dd565(0x1ca)](_0x39bfa7)[_0x8dd565(0x265)](async _0x33f6f3=>{var _0x53813e=_0x8dd565;try{for(const _0x34a65d of _0x33f6f3){await _0x34a65d[_0x53813e(0x1cf)]();}const _0x3f509c=_0x1435b2[_0x53813e(0x287)]['map'](async _0x4861a1=>{var _0x26a749=_0x53813e,_0x51dd78=await warehouse[_0x26a749(0x1f7)]({'name':_0x1a90cc,'room':_0x4861a1[_0x26a749(0x255)]});if(_0x4861a1['to_quantity']>0x0){var _0x5245cf=0x0;const _0xae4436=_0x51dd78['product_details'][_0x26a749(0x22f)](_0x10436a=>{var _0x5c150d=_0x26a749;_0x10436a[_0x5c150d(0x29a)]==_0x4861a1[_0x5c150d(0x29a)]&&_0x10436a[_0x5c150d(0x1bf)]==_0x4861a1[_0x5c150d(0x1fc)]&&_0x10436a[_0x5c150d(0x1c0)]==_0x4861a1['expiry_date']&&_0x10436a[_0x5c150d(0x1c1)]==_0x4861a1['production_date']&&_0x10436a[_0x5c150d(0x21d)]==_0x4861a1[_0x5c150d(0x21d)]&&_0x10436a[_0x5c150d(0x282)]==_0x4861a1[_0x5c150d(0x228)]&&(typeof _0x4861a1[_0x5c150d(0x295)]=='undefined'?(console[_0x5c150d(0x225)]('here2',_0x10436a[_0x5c150d(0x28c)]+'\x20<>\x20'+_0x10436a[_0x5c150d(0x1e3)]+_0x5c150d(0x1d1)+Math[_0x5c150d(0x278)](_0x10436a[_0x5c150d(0x28c)])+Math[_0x5c150d(0x278)](_0x4861a1['to_quantity'])),_0x10436a[_0x5c150d(0x28c)]=Math[_0x5c150d(0x278)](_0x10436a[_0x5c150d(0x28c)])+Math['abs'](_0x4861a1[_0x5c150d(0x220)])):_0x10436a[_0x5c150d(0x28c)]=Math[_0x5c150d(0x278)](_0x10436a[_0x5c150d(0x28c)])+Math[_0x5c150d(0x278)](_0x4861a1['to_quantity']),_0x5245cf++);});_0x5245cf=='0'&&(_0x51dd78[_0x26a749(0x294)]=_0x51dd78[_0x26a749(0x294)][_0x26a749(0x1ea)]({'product_name':_0x4861a1['product_name'],'product_stock':_0x4861a1[_0x26a749(0x220)],'bay':_0x4861a1['to_bay'],'product_code':_0x4861a1[_0x26a749(0x1bd)],'primary_code':_0x4861a1[_0x26a749(0x24e)],'secondary_code':_0x4861a1[_0x26a749(0x242)],'expiry_date':_0x4861a1['expiry_date'],'production_date':_0x4861a1['production_date'],'maxProducts':_0x4861a1['maxProducts'],'batch_code':_0x4861a1[_0x26a749(0x21d)],'secondary_unit':_0x4861a1[_0x26a749(0x276)],'unit':_0x4861a1[_0x26a749(0x237)],'maxProducts':_0x4861a1['maxProducts'],'maxPerUnit':_0x4861a1['maxPerUnit'],'invoice':_0x4861a1[_0x26a749(0x228)]}));}return _0x51dd78;});Promise[_0x53813e(0x1ca)](_0x3f509c)[_0x53813e(0x265)](async _0x1b17f5=>{var _0x287e3a=_0x53813e;try{for(const _0x2dfbac of _0x1b17f5){await warehouse[_0x287e3a(0x252)]({'_id':_0x2dfbac[_0x287e3a(0x1e3)]},{'$addToSet':{'product_details':{'$each':_0x2dfbac[_0x287e3a(0x294)]}}});}_0x1435b2['finalize']=_0x287e3a(0x245);const _0x3ebeea=await _0x1435b2[_0x287e3a(0x1cf)](),_0x5758af=await master_shop[_0x287e3a(0x26a)](),_0x18d4cf=await email_settings[_0x287e3a(0x1f7)](),_0xf07ace=await supervisor_settings[_0x287e3a(0x26a)]();var _0x19a86a=_0x1435b2[_0x287e3a(0x287)],_0x44bd35='',_0x511399;for(_0x511399 in _0x19a86a){var _0x261f4f='FG';_0x1435b2[_0x287e3a(0x1cb)]==_0x287e3a(0x22d)&&(_0x261f4f='DG'),_0x44bd35+=_0x287e3a(0x208)+_0x287e3a(0x1dc)+_0x19a86a[_0x511399][_0x287e3a(0x29a)]+'</td>'+_0x287e3a(0x1dc)+_0x19a86a[_0x511399][_0x287e3a(0x1bd)]+_0x287e3a(0x1d7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19a86a[_0x511399][_0x287e3a(0x220)]+_0x287e3a(0x1d7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19a86a[_0x511399][_0x287e3a(0x237)]+_0x287e3a(0x1d7)+_0x287e3a(0x1dc)+_0x19a86a[_0x511399][_0x287e3a(0x276)]+_0x287e3a(0x1d7)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1435b2[_0x287e3a(0x1cb)]+_0x287e3a(0x1d7)+_0x287e3a(0x1dc)+_0x19a86a[_0x511399]['to_room_name']+_0x287e3a(0x1d7)+_0x287e3a(0x1dc)+_0x261f4f+_0x19a86a[_0x511399][_0x287e3a(0x1fc)]+'</td>'+_0x287e3a(0x21b);}let _0x2eeeeb=nodemailer[_0x287e3a(0x1db)]({'host':_0x18d4cf[_0x287e3a(0x230)],'port':Number(_0x18d4cf[_0x287e3a(0x1de)]),'secure':![],'auth':{'user':_0x18d4cf['email'],'pass':_0x18d4cf[_0x287e3a(0x223)]}}),_0x597708={'from':_0x18d4cf[_0x287e3a(0x1b4)],'to':_0xf07ace[0x0][_0x287e3a(0x26b)],'subject':_0x287e3a(0x22a),'attachments':[{'filename':_0x287e3a(0x1ef),'path':__dirname+_0x287e3a(0x288)+_0x287e3a(0x26f)+_0x5758af[0x0][_0x287e3a(0x297)],'cid':'logo'}],'html':_0x287e3a(0x1f5)+_0x287e3a(0x27a)+_0x287e3a(0x27c)+_0x287e3a(0x221)+_0x287e3a(0x1d0)+_0x287e3a(0x221)+_0x287e3a(0x292)+_0x287e3a(0x21a)+_0x287e3a(0x221)+_0x287e3a(0x224)+_0x5758af[0x0][_0x287e3a(0x1ba)]+_0x287e3a(0x1ed)+_0x287e3a(0x21a)+_0x287e3a(0x21a)+_0x287e3a(0x239)+_0x287e3a(0x221)+_0x287e3a(0x254)+_0x287e3a(0x272)+_0x1435b2[_0x287e3a(0x282)]+'\x20'+_0x287e3a(0x235)+_0x287e3a(0x222)+_0x1435b2[_0x287e3a(0x253)]+'\x20'+_0x287e3a(0x1d6)+_0x287e3a(0x234)+_0x287e3a(0x21a)+_0x287e3a(0x210)+_0x287e3a(0x231)+_0x287e3a(0x208)+_0x287e3a(0x1c2)+_0x287e3a(0x277)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x287e3a(0x1c5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x287e3a(0x247)+_0x287e3a(0x1e7)+'</tr>'+_0x287e3a(0x26e)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x44bd35+'\x20'+_0x287e3a(0x20f)+_0x287e3a(0x284)+_0x287e3a(0x221)+_0x287e3a(0x1c9)+_0x287e3a(0x25f)+_0x5758af[0x0][_0x287e3a(0x1ba)]+'</h5>'+'</div>'+_0x287e3a(0x21a)+_0x287e3a(0x264)};_0x2eeeeb[_0x287e3a(0x256)](_0x597708,function(_0x2118c3,_0x43b469){var _0x4c8134=_0x287e3a;_0x2118c3?(console[_0x4c8134(0x225)](_0x2118c3),console[_0x4c8134(0x225)](_0x4c8134(0x201))):console['log']('Email\x20sent\x20successfully');}),_0x189bd1[_0x287e3a(0x226)](_0x287e3a(0x27d),'Transfer\x20Finalize\x20Successfully'),_0xceb9d5['redirect'](_0x287e3a(0x28e)+_0x3ebeea[_0x287e3a(0x1e3)]);}catch(_0x56f410){console[_0x287e3a(0x1b5)](_0x56f410),_0xceb9d5[_0x287e3a(0x281)](0x1f4)['json']({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x53813e(0x23d)](_0x53cf43=>{var _0x2e3442=_0x53813e;console[_0x2e3442(0x1b5)](_0x53cf43),_0xceb9d5[_0x2e3442(0x281)](0x1f4)[_0x2e3442(0x1f4)]({'error':_0x2e3442(0x229)});});}catch(_0x442433){console[_0x53813e(0x1b5)](_0x442433),_0xceb9d5[_0x53813e(0x281)](0x1f4)[_0x53813e(0x1f4)]({'error':_0x53813e(0x21f)});}})[_0x8dd565(0x23d)](_0x530b88=>{var _0x2d038e=_0x8dd565;console[_0x2d038e(0x1b5)](_0x530b88),_0xceb9d5[_0x2d038e(0x281)](0x1f4)['json']({'error':_0x2d038e(0x229)});});}catch(_0x598437){_0xceb9d5[_0x8dd565(0x1f4)]({'message':_0x598437[_0x8dd565(0x1b9)]});}});function BayBinSelected(_0x59678e,_0x574b6d){var _0x13f1b9=a0_0x38a2ab,_0x335a57=[];let _0x2fc50f=[];var _0x100033=[];if(_0x59678e==_0x13f1b9(0x22d)){switch(_0x574b6d){case _0x13f1b9(0x263):_0x335a57=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x13f1b9(0x275):_0x335a57=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x100033=['DG'];}else{if(_0x59678e==_0x13f1b9(0x1b6)){switch(_0x574b6d){case'Rack\x201':_0x335a57=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x13f1b9(0x275):_0x335a57=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x100033=['FG'];}}return{'levels':_0x335a57,'identify':_0x100033};}router[a0_0x38a2ab(0x203)](a0_0x38a2ab(0x1e4),auth,async(_0x5f1cc2,_0x3def83)=>{var _0x1f9a3=a0_0x38a2ab;try{const {username:_0x456b27,email:_0x5cd278,role:_0xe5f710}=_0x5f1cc2[_0x1f9a3(0x286)],_0x336e11=_0x5f1cc2[_0x1f9a3(0x286)],_0x4685f2=await profile[_0x1f9a3(0x1f7)]({'email':_0x336e11[_0x1f9a3(0x1b4)]}),_0x52aabe=await master_shop['find'](),_0xa8c923=await transfers_finished[_0x1f9a3(0x27e)](_0x5f1cc2['params']['id']);let _0xf5cbcd=new Date(_0xa8c923[_0x1f9a3(0x1c0)]),_0x18bb77=('0'+_0xf5cbcd['getDate']())[_0x1f9a3(0x1f9)](-0x2),_0x1159ee=('0'+(_0xf5cbcd['getMonth']()+0x1))[_0x1f9a3(0x1f9)](-0x2),_0x539c26=_0xf5cbcd[_0x1f9a3(0x207)](),_0xcb3910=_0x539c26+'-'+_0x1159ee+'-'+_0x18bb77,_0x535a9b;if(_0x336e11[_0x1f9a3(0x270)]==_0x1f9a3(0x25a)){const _0x42f670=await staff[_0x1f9a3(0x1f7)]({'email':_0x336e11[_0x1f9a3(0x1b4)]});_0x535a9b=await warehouse[_0x1f9a3(0x26a)]({'status':_0x1f9a3(0x217),'name':_0x42f670[_0x1f9a3(0x28f)],'warehouse_category':'Finished\x20Goods'});}else _0x535a9b=await warehouse[_0x1f9a3(0x26a)]({'status':_0x1f9a3(0x217),'warehouse_category':_0x1f9a3(0x261)});const _0x4ee7e6=await warehouse[_0x1f9a3(0x25b)]([{'$match':{'name':_0xa8c923[_0x1f9a3(0x204)],'room':_0xa8c923[_0x1f9a3(0x202)]}},{'$unwind':_0x1f9a3(0x23f)},{'$group':{'_id':_0x1f9a3(0x289),'name':{'$first':_0x1f9a3(0x1d8)},'product_stock':{'$first':_0x1f9a3(0x20d)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1f9a3(0x1f8)},'type':{'$first':_0x1f9a3(0x236)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1f9a3(0x24c)},'storage':{'$first':_0x1f9a3(0x238)},'rack':{'$first':'$product_details.rack'}}}]);var _0xe181ce=[0x1,0x2,0x3,0x4],_0x1d59fc=['A','B','C','D','E','F','G','H','I','J'],_0x507c6b=[_0x1f9a3(0x260),_0x1f9a3(0x1f3)];const _0xa0d05b=await product[_0x1f9a3(0x26a)]({}),_0x33ad91=BayBinSelected(_0xa8c923[_0x1f9a3(0x1cb)],_0xa8c923[_0x1f9a3(0x299)]);if(_0x52aabe[0x0][_0x1f9a3(0x1fa)]==_0x1f9a3(0x1ff)){var _0x433194=users[_0x1f9a3(0x215)];console[_0x1f9a3(0x225)](_0x433194);}else{if(_0x52aabe[0x0][_0x1f9a3(0x1fa)]==_0x1f9a3(0x290))var _0x433194=users[_0x1f9a3(0x290)];else{if(_0x52aabe[0x0][_0x1f9a3(0x1fa)]==_0x1f9a3(0x22b))var _0x433194=users[_0x1f9a3(0x22b)];else{if(_0x52aabe[0x0][_0x1f9a3(0x1fa)]==_0x1f9a3(0x1dd))var _0x433194=users['Spanish'];else{if(_0x52aabe[0x0][_0x1f9a3(0x1fa)]=='French')var _0x433194=users[_0x1f9a3(0x1c3)];else{if(_0x52aabe[0x0][_0x1f9a3(0x1fa)]==_0x1f9a3(0x1cd))var _0x433194=users['Portuguese'];else{if(_0x52aabe[0x0]['language']==_0x1f9a3(0x251))var _0x433194=users[_0x1f9a3(0x251)];else{if(_0x52aabe[0x0][_0x1f9a3(0x1fa)]=='Arabic\x20(ae)')var _0x433194=users[_0x1f9a3(0x23c)];}}}}}}}_0x3def83[_0x1f9a3(0x274)](_0x1f9a3(0x1bc),{'success':_0x5f1cc2[_0x1f9a3(0x226)](_0x1f9a3(0x27d)),'errors':_0x5f1cc2[_0x1f9a3(0x226)](_0x1f9a3(0x240)),'role':_0x336e11,'profile':_0x4685f2,'master_shop':_0x52aabe,'warehouse':_0x535a9b,'transfer':_0xa8c923,'stock':_0x4ee7e6,'unit':_0xa0d05b,'language':_0x433194,'levels':_0xe181ce,'Isle':_0x1d59fc,'rooms_data':_0x507c6b,'ed_fullDate':_0xcb3910,'dataSelected':_0x33ad91});}catch(_0x50a78d){console[_0x1f9a3(0x225)](_0x50a78d);}}),router[a0_0x38a2ab(0x1eb)](a0_0x38a2ab(0x1e4),auth,async(_0x3c970e,_0x2ba45c)=>{var _0xb0e734=a0_0x38a2ab;try{const _0x52baa0=_0x3c970e[_0xb0e734(0x25e)]['id'];console[_0xb0e734(0x225)](_0x3c970e[_0xb0e734(0x25c)]);const _0x37ba57=await transfers_finished['findById'](_0x52baa0);console[_0xb0e734(0x225)](_0xb0e734(0x1e6),_0x37ba57);const {date:_0x519020,from_warehouse:_0x47ba75,FromRoom_name:_0x519539,to_warehouse:_0x378def,ToRoom_name:_0x544ccc,prod_name:_0xabd99a,from_prod_qty:_0x4947f7,from_prod_level:_0x3bc6bd,from_prod_isle:_0x19b275,from_prod_pallet:_0x9d6aa4,to_prod_qty:_0x129eb4,to_prod_level:_0x3aaf6d,to_prod_isle:_0x5aa6bc,to_prod_pallet:_0x103f92,primary_code:_0x1d5726,secondary_code:_0xa60324,product_code3:_0x37880f,note:_0x18e294,invoice:_0x4ec6b0,expiry_date:_0x248553}=_0x3c970e[_0xb0e734(0x25c)];if(typeof _0xabd99a==_0xb0e734(0x1d3))var _0x14725b=[_0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x1fd)]],_0x319c95=[_0x3c970e[_0xb0e734(0x25c)]['from_prod_qty']],_0x2e3bc4=[_0x3c970e[_0xb0e734(0x25c)]['from_prod_level']],_0x15fb78=[_0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x280)]],_0x2c477e=[_0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x1f1)]],_0x4ec43c=[_0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x24e)]],_0x9ee882=[_0x3c970e['body'][_0xb0e734(0x242)]],_0x43c6f5=[_0x3c970e['body'][_0xb0e734(0x1b7)]],_0x3c86a5=[_0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x257)]],_0x57b102=[_0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x237)]],_0x2c3ded=[_0x3c970e[_0xb0e734(0x25c)]['secondary_unit']],_0x21a063=[_0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x21d)]],_0x2dabff=[_0x3c970e[_0xb0e734(0x25c)]['expiry_date']];else var _0x14725b=[..._0x3c970e['body'][_0xb0e734(0x1fd)]],_0x319c95=[..._0x3c970e[_0xb0e734(0x25c)]['from_prod_qty']],_0x2e3bc4=[..._0x3c970e['body'][_0xb0e734(0x213)]],_0x15fb78=[..._0x3c970e[_0xb0e734(0x25c)]['to_prod_qty']],_0x2c477e=[..._0x3c970e['body'][_0xb0e734(0x1f1)]],_0x4ec43c=[..._0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x24e)]],_0x9ee882=[..._0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x242)]],_0x43c6f5=[..._0x3c970e['body'][_0xb0e734(0x1b7)]],_0x3c86a5=[..._0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x257)]],_0x57b102=[..._0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x237)]],_0x2c3ded=[..._0x3c970e[_0xb0e734(0x25c)]['secondary_unit']],_0x21a063=[..._0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x21d)]],_0x2dabff=[..._0x3c970e[_0xb0e734(0x25c)][_0xb0e734(0x1c0)]];const _0x923c1b=_0x14725b['map'](_0x814035=>{return _0x814035={'product_name':_0x814035};});_0x319c95[_0xb0e734(0x1d5)]((_0x500403,_0x195071)=>{var _0x4ddcd4=_0xb0e734;_0x923c1b[_0x195071][_0x4ddcd4(0x1f2)]=_0x500403;}),_0x2e3bc4[_0xb0e734(0x1d5)]((_0x49258c,_0x155c6c)=>{_0x923c1b[_0x155c6c]['from_bay']=_0x49258c;}),_0x15fb78[_0xb0e734(0x1d5)]((_0x4366dc,_0x40c33d)=>{var _0x132fe1=_0xb0e734;_0x923c1b[_0x40c33d][_0x132fe1(0x220)]=_0x4366dc;}),_0x2c477e[_0xb0e734(0x1d5)]((_0x1dbc12,_0x52de0c)=>{var _0x2f8703=_0xb0e734;_0x923c1b[_0x52de0c][_0x2f8703(0x1fc)]=_0x1dbc12;}),_0x4ec43c[_0xb0e734(0x1d5)]((_0x295723,_0x3d24bc)=>{var _0x23ab42=_0xb0e734;_0x923c1b[_0x3d24bc][_0x23ab42(0x24e)]=_0x295723;}),_0x9ee882[_0xb0e734(0x1d5)]((_0x5108c0,_0x436ef8)=>{_0x923c1b[_0x436ef8]['secondary_code']=_0x5108c0;}),_0x43c6f5[_0xb0e734(0x1d5)]((_0x35ad9f,_0x5e3290)=>{var _0x1fd20e=_0xb0e734;_0x923c1b[_0x5e3290][_0x1fd20e(0x1bd)]=_0x35ad9f;}),_0x3c86a5[_0xb0e734(0x1d5)]((_0x289839,_0x120d9d)=>{var _0x2d208d=_0xb0e734;_0x923c1b[_0x120d9d][_0x2d208d(0x28a)]=_0x289839;}),_0x57b102[_0xb0e734(0x1d5)]((_0x4e5b80,_0x76e614)=>{_0x923c1b[_0x76e614]['unit']=_0x4e5b80;}),_0x2c3ded[_0xb0e734(0x1d5)]((_0x2c5046,_0x5994dc)=>{var _0x43eec7=_0xb0e734;_0x923c1b[_0x5994dc][_0x43eec7(0x276)]=_0x2c5046;}),_0x21a063[_0xb0e734(0x1d5)]((_0x267e89,_0x5e8503)=>{var _0x5d57e4=_0xb0e734;_0x923c1b[_0x5e8503][_0x5d57e4(0x21d)]=_0x267e89;}),_0x2dabff[_0xb0e734(0x1d5)]((_0x1ada32,_0x38227d)=>{var _0x4416d0=_0xb0e734;_0x923c1b[_0x38227d][_0x4416d0(0x1c0)]=_0x1ada32;});const _0x5a1b8e=_0x923c1b[_0xb0e734(0x1fe)](_0x4e19c9=>_0x4e19c9[_0xb0e734(0x220)]!=='0'&&_0x4e19c9['to_quantity']!==''||_0x4e19c9['to_floorlevel']!=='0'&&_0x4e19c9[_0xb0e734(0x250)]!=='');var _0x41c0c6=0x0;_0x5a1b8e[_0xb0e734(0x1d5)](_0xa0969f=>{var _0x132141=_0xb0e734;parseInt(_0xa0969f[_0x132141(0x1f2)])<parseInt(_0xa0969f[_0x132141(0x220)])&&_0x41c0c6++;});if(_0x41c0c6!=0x0)return _0x3c970e['flash'](_0xb0e734(0x240),_0xb0e734(0x273)),_0x2ba45c['redirect'](_0xb0e734(0x249));const _0xeae3c8=await warehouse[_0xb0e734(0x1f7)]({'name':_0x37ba57[_0xb0e734(0x204)],'room':_0x37ba57[_0xb0e734(0x202)]});_0x37ba57['product']['forEach'](_0x1c2f55=>{var _0x4d70f1=_0xb0e734;if(_0x1c2f55[_0x4d70f1(0x220)]>0x0){const _0x35aa46=_0xeae3c8[_0x4d70f1(0x294)][_0x4d70f1(0x22f)](_0x473d5c=>{var _0x1dedb2=_0x4d70f1;_0x473d5c[_0x1dedb2(0x29a)]==_0x1c2f55['product_name']&&_0x473d5c[_0x1dedb2(0x1bf)]==_0x1c2f55[_0x1dedb2(0x279)]&&(_0x473d5c[_0x1dedb2(0x28c)]=parseInt(_0x473d5c[_0x1dedb2(0x28c)])+parseInt(_0x1c2f55[_0x1dedb2(0x220)]));});}}),await _0xeae3c8[_0xb0e734(0x1cf)]();const _0x11053f=await warehouse[_0xb0e734(0x1f7)]({'name':_0x37ba57['to_warehouse'],'room':_0x37ba57[_0xb0e734(0x299)]});_0x37ba57[_0xb0e734(0x287)][_0xb0e734(0x1d5)](_0x426f0f=>{if(_0x426f0f['to_quantity']>0x0){const _0x7fe40b=_0x11053f['product_details']['map'](_0x3259da=>{var _0x28ee5b=a0_0x189e;_0x3259da[_0x28ee5b(0x29a)]==_0x426f0f[_0x28ee5b(0x29a)]&&_0x3259da[_0x28ee5b(0x1bf)]==_0x426f0f[_0x28ee5b(0x1fc)]&&(_0x3259da[_0x28ee5b(0x28c)]=parseInt(_0x3259da[_0x28ee5b(0x28c)])-parseInt(_0x426f0f[_0x28ee5b(0x220)]));});}}),await _0x11053f['save'](),_0x37ba57['date']=_0x519020,_0x37ba57['from_warehouse']=_0x47ba75,_0x37ba57[_0xb0e734(0x1cb)]=_0x378def,_0x37ba57[_0xb0e734(0x287)]=_0x5a1b8e,_0x37ba57['note']=_0x18e294,_0x37ba57[_0xb0e734(0x282)]=_0x4ec6b0;const _0x3e09b1=await _0x37ba57['save'](),_0x5a3f21=await warehouse[_0xb0e734(0x1f7)]({'name':_0x47ba75,'room':_0x519539});_0x3e09b1[_0xb0e734(0x287)]['forEach'](_0x158d67=>{var _0x15ea3f=_0xb0e734;if(_0x158d67[_0x15ea3f(0x220)]>0x0){const _0xa1d5bc=_0x5a3f21[_0x15ea3f(0x294)][_0x15ea3f(0x22f)](_0x146e37=>{var _0x1504da=_0x15ea3f;_0x146e37[_0x1504da(0x29a)]==_0x158d67[_0x1504da(0x29a)]&&_0x146e37[_0x1504da(0x1bf)]==_0x158d67[_0x1504da(0x279)]&&(_0x146e37[_0x1504da(0x28c)]=parseInt(_0x146e37['product_stock'])-parseInt(_0x158d67[_0x1504da(0x220)]));});}}),await _0x5a3f21[_0xb0e734(0x1cf)]();const _0x3a3745=await warehouse['findOne']({'name':_0x378def,'room':_0x544ccc});_0x3e09b1[_0xb0e734(0x287)]['forEach'](_0x142c93=>{var _0x492656=_0xb0e734;if(_0x142c93[_0x492656(0x220)]>0x0){var _0x3a53c6=0x0;const _0xbefec0=_0x3a3745[_0x492656(0x294)][_0x492656(0x22f)](_0x3ab2ca=>{var _0x382339=_0x492656;_0x3ab2ca[_0x382339(0x29a)]==_0x142c93[_0x382339(0x29a)]&&_0x3ab2ca[_0x382339(0x1bf)]==_0x142c93['to_bay']&&(_0x3ab2ca[_0x382339(0x28c)]=parseInt(_0x3ab2ca[_0x382339(0x28c)])+parseInt(_0x142c93[_0x382339(0x220)]),_0x3a53c6++);});_0x3a53c6=='0'&&(_0x3a3745['product_details']=_0x3a3745[_0x492656(0x294)]['concat']({'product_name':_0x142c93[_0x492656(0x29a)],'product_stock':_0x142c93[_0x492656(0x220)],'bay':_0x142c93['to_bay'],'product_code':_0x142c93['product_code'],'primary_code':_0x142c93[_0x492656(0x24e)],'secondary_code':_0x142c93[_0x492656(0x242)],'maxProducts':_0x142c93[_0x492656(0x28a)]}));}}),await _0x3a3745[_0xb0e734(0x1cf)](),_0x3c970e[_0xb0e734(0x226)]('success','Transfer\x20Edit\x20Successfully'),_0x2ba45c[_0xb0e734(0x211)](_0xb0e734(0x246));}catch(_0x5c2fe6){console[_0xb0e734(0x225)](_0x5c2fe6);}}),router['post'](a0_0x38a2ab(0x1e2),async(_0x2039f6,_0x4ae48)=>{var _0x3f456d=a0_0x38a2ab;const {FromWareHouse:_0x748112,FromRoom:_0x33ca07,ToWarehouse:_0x3da67f,ToRoom:_0x2c4eee,primary_code:_0x3270e2,Roomslist:_0x46f3c1}=_0x2039f6[_0x3f456d(0x25c)],_0x263107=_0x46f3c1[_0x3f456d(0x20e)](','),_0x1d870c=[];async function _0xd9c032(_0x17da15){var _0x3b4112=_0x3f456d;const _0x3ffa64=await warehouse[_0x3b4112(0x25b)]([{'$match':{'name':_0x748112,'room':_0x17da15}},{'$unwind':_0x3b4112(0x23f)},{'$match':{'product_details.primary_code':_0x3270e2}},{'$group':{'_id':_0x3b4112(0x289),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x3b4112(0x20d)},'primary_code':{'$first':_0x3b4112(0x24b)},'secondary_code':{'$first':_0x3b4112(0x1d2)},'product_code':{'$first':_0x3b4112(0x24c)},'level':{'$first':_0x3b4112(0x248)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3b4112(0x27f)},'unit':{'$first':_0x3b4112(0x1c6)},'secondary_unit':{'$first':_0x3b4112(0x23a)},'storage':{'$first':_0x3b4112(0x238)},'rack':{'$first':_0x3b4112(0x1bb)},'expiry_date':{'$first':_0x3b4112(0x241)},'production_date':{'$first':_0x3b4112(0x27b)},'batch_code':{'$first':_0x3b4112(0x1e8)},'maxPerUnit':{'$first':_0x3b4112(0x271)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x3b4112(0x1ee)}}}]),_0x21aee5=await warehouse[_0x3b4112(0x25b)]([{'$match':{'name':_0x748112,'room':_0x17da15}},{'$unwind':_0x3b4112(0x23f)},{'$match':{'product_details.secondary_code':_0x3270e2}},{'$group':{'_id':_0x3b4112(0x289),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x3b4112(0x20d)},'primary_code':{'$first':_0x3b4112(0x24b)},'secondary_code':{'$first':_0x3b4112(0x1d2)},'product_code':{'$first':_0x3b4112(0x24c)},'level':{'$first':_0x3b4112(0x248)},'isle':{'$first':_0x3b4112(0x1f8)},'type':{'$first':_0x3b4112(0x236)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3b4112(0x238)},'rack':{'$first':_0x3b4112(0x1bb)},'expiry_date':{'$first':_0x3b4112(0x241)},'production_date':{'$first':_0x3b4112(0x27b)},'batch_code':{'$first':_0x3b4112(0x1e8)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x3b4112(0x218)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x3b4112(0x1ee)}}}]);if(_0x3ffa64[_0x3b4112(0x268)]>0x0)_0x1d870c[_0x3b4112(0x28d)](_0x3ffa64);else _0x21aee5[_0x3b4112(0x268)]>0x0&&_0x1d870c['push'](_0x21aee5);}const _0x6bb12=_0x263107['map'](_0x540b30=>_0xd9c032(_0x540b30));await Promise[_0x3f456d(0x1ca)](_0x6bb12),_0x4ae48[_0x3f456d(0x1f4)](_0x1d870c);}),router[a0_0x38a2ab(0x1eb)]('/barcode_scanner2',async(_0x1ec09d,_0x36f527)=>{var _0x3dcc32=a0_0x38a2ab;try{const {FromWareHouse:_0x3e0562,FromRoom:_0xa54efa,ToWarehouse:_0x194c9a,ToRoom:_0x42fc23,secondary_code:_0x6be77e}=_0x1ec09d[_0x3dcc32(0x25c)],_0x5075ee=await warehouse[_0x3dcc32(0x25b)]([{'$match':{'name':_0x3e0562}},{'$unwind':_0x3dcc32(0x23f)},{'$match':{'product_details.secondary_code':_0x6be77e}},{'$group':{'_id':_0x3dcc32(0x289),'name':{'$first':_0x3dcc32(0x1d8)},'primary_code':{'$first':_0x3dcc32(0x24b)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3dcc32(0x24c)},'instock':{'$first':_0x3dcc32(0x20d)},'warehouse':{'$first':_0x3dcc32(0x1ec)},'level':{'$first':_0x3dcc32(0x283)},'isle':{'$first':_0x3dcc32(0x206)},'pallet':{'$first':_0x3dcc32(0x1d9)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x3dcc32(0x1c6)},'expiry_date':{'$first':_0x3dcc32(0x241)},'production_date':{'$first':'$product_details.production_date'}}}]);_0x36f527[_0x3dcc32(0x281)](0xc8)[_0x3dcc32(0x1f4)](_0x5075ee);}catch(_0x2dce2a){_0x36f527['status'](0x194)[_0x3dcc32(0x1f4)]({'message':_0x2dce2a[_0x3dcc32(0x1b9)]});}}),router[a0_0x38a2ab(0x1eb)]('/barcode_scanner3',async(_0x19d980,_0x582bed)=>{var _0x1d7b11=a0_0x38a2ab;try{const {FromWareHouse:_0x4eee5d,FromRoom:_0x5deedd,ToWarehouse:_0x3d8979,ToRoom:_0x119887,product_code:_0x14f022}=_0x19d980[_0x1d7b11(0x25c)],_0x3724d5=await warehouse[_0x1d7b11(0x25b)]([{'$match':{'name':_0x4eee5d}},{'$unwind':_0x1d7b11(0x23f)},{'$match':{'product_details.product_code':_0x14f022}},{'$group':{'_id':_0x1d7b11(0x289),'name':{'$first':_0x1d7b11(0x1d8)},'primary_code':{'$first':_0x1d7b11(0x24b)},'secondary_code':{'$first':_0x1d7b11(0x1d2)},'product_code':{'$first':_0x1d7b11(0x24c)},'instock':{'$first':_0x1d7b11(0x20d)},'warehouse':{'$first':_0x1d7b11(0x1ec)},'level':{'$first':_0x1d7b11(0x283)},'isle':{'$first':_0x1d7b11(0x206)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x1d7b11(0x26d)},'unit':{'$first':'$product_details.unit'}}}]);_0x582bed['status'](0xc8)[_0x1d7b11(0x1f4)](_0x3724d5);}catch(_0x26e13e){_0x582bed[_0x1d7b11(0x281)](0x194)[_0x1d7b11(0x1f4)]({'message':_0x26e13e[_0x1d7b11(0x1b9)]});}}),router['post'](a0_0x38a2ab(0x22c),async(_0x86fcc9,_0x2b2f23)=>{var _0x49ed16=a0_0x38a2ab;const {productCode:_0x3fe65f,bay:_0x1e1c78,warehouses:_0x9f6893,room:_0x5df339}=_0x86fcc9[_0x49ed16(0x25c)];console[_0x49ed16(0x225)](_0x86fcc9['body']);try{const _0x314574=await warehouse[_0x49ed16(0x25b)]([{'$match':{'name':_0x9f6893,'room':_0x5df339}},{'$unwind':_0x49ed16(0x23f)},{'$match':{'product_details.bay':parseInt(_0x1e1c78)}},{'$group':{'_id':_0x49ed16(0x289),'name':{'$first':_0x49ed16(0x1d8)},'product_stock':{'$first':_0x49ed16(0x20d)},'bay':{'$first':_0x49ed16(0x248)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2b2f23[_0x49ed16(0x281)](0xc8)['json'](_0x314574);}catch(_0xa6c7fe){_0x2b2f23['status'](0x194)['json']({'message':_0xa6c7fe['message']});}}),module[a0_0x38a2ab(0x1e9)]=router;