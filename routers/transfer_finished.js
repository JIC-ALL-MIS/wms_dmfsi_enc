function a0_0x5a75(_0x3041d9,_0x3192d3){var _0x2ce033=a0_0x2ce0();return a0_0x5a75=function(_0x5a758a,_0x4bb949){_0x5a758a=_0x5a758a-0x181;var _0x139c8e=_0x2ce033[_0x5a758a];return _0x139c8e;},a0_0x5a75(_0x3041d9,_0x3192d3);}var a0_0x3f1f8a=a0_0x5a75;(function(_0x990441,_0x3438f0){var _0x27f920=a0_0x5a75,_0x1c703d=_0x990441();while(!![]){try{var _0x55dab7=-parseInt(_0x27f920(0x1ad))/0x1*(parseInt(_0x27f920(0x1a0))/0x2)+-parseInt(_0x27f920(0x225))/0x3+parseInt(_0x27f920(0x1af))/0x4+parseInt(_0x27f920(0x1b8))/0x5*(-parseInt(_0x27f920(0x20f))/0x6)+parseInt(_0x27f920(0x193))/0x7+-parseInt(_0x27f920(0x1d6))/0x8*(parseInt(_0x27f920(0x220))/0x9)+parseInt(_0x27f920(0x261))/0xa*(parseInt(_0x27f920(0x206))/0xb);if(_0x55dab7===_0x3438f0)break;else _0x1c703d['push'](_0x1c703d['shift']());}catch(_0x28d546){_0x1c703d['push'](_0x1c703d['shift']());}}}(a0_0x2ce0,0x8d62f));function a0_0x2ce0(){var _0x1a58c7=['max','True','</table>','$product_details.maxPerUnit','_id','6iKqvEt','\x20Order\x20Date\x20:\x20','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$product_details.invoice','email','</tbody>','then','forEach','/upload/','here1','undefined','$product.from_room_name','$invoice','to_invoice','port','Chinese','13509SEZLQn','</head><body>','padStart','<span\x20style=\x22float:\x20right;\x22>','</tr>','2583759rfNAwE','/view/add_transfer','prod_name','$product_details.product_code','production_date','</thead>','body','errors','bay','FGSEmail','id_transaction','MaxStocks_data2','<h2>\x20','$product_details.rack','To_invoice','Ambient','$product_details.maxProducts','from_quantity','back','flash','to_room_name','sendMail','Error\x20Occurs','/picking_list/PDF_transfer/','$product_details.secondary_unit','map','Spanish','/transfer/view','edit_transfer_finished_view','from_bay','$product_details.level','json','Rack\x202','<h5\x20style=\x22text-align:\x20left;\x22>','to_quantity','get','English','Email\x20sent\x20successfully','Portuguese','user','/CheckingWarehouse','note','primary_unit','from_room_name','to_bay','$product_details.product_name','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','</h5>','all','../middleware/auth','getMonth','Finished\x20Goods','DRY\x20GOODS','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$name','Arabic\x20(ae)','updateOne','secondary_code','$product','RoomAssigned','270KzyMMX','/preview/:id','password','transfer_data','Logo.png','concat','Enabled','Transfer\x20Mail','</span>','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view','getFullYear','/barcode_scanner2','$_id','Hindi','add_transfer_finished','\x20</h2>','../models/all_models','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<!DOCTYPE\x20html>','createTransport','primary_code','5717369IMACMV','$room','find','here2','unit','</div>','error','$product_details.batch_code','to_room','to_prod_qty','expiry_date','from_room','success','154nztnqs','$product_details.primary_code','An\x20error\x20occurred\x20while\x20saving\x20data.','<html><head><title></title>','to_floorlevel','from_warehouse','<hr\x20class=\x22my-3\x22>','$finalize','invoice','TRFF-','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product_date','<div>','177lhuKkP','$product_details.bay','1192680xcRRee','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','express','to_warehouse','string','$product_details._id','status','$product_details.pallet','product_code3','1720225LGOZeJ','message','random','slice','\x20<=>\x20','site_title','warehouse','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','push','product','to_prod_level','$product_details.floorlevel','<table\x20style=\x22width:\x20100%\x20!important;\x22>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','New_Qty_Converted','ToRoomAssigned','$product_details','abs','German','transfer_finished','findOne','date','secondary_unit','$product_details.storage','finalize','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','English\x20(US)','</td>','from_invoice','1224ynzNHK','<h5>','$product_details.isle','/transfer_finished/view','image','from_prod_level','product_name','toString','An\x20error\x20occurred.','$product_details.secondary_code','Arabic','product_stock','role','batch_code','product_details','<tr>','$product_details.bin','staff','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','Portuguese\x20(BR)','from_prod_qty','maxProducts','language','Rack\x201','exports','/../public','logo','save','Product\x20Transfer\x20successfully','length','params','post','product_code','$product_details.unit','$product_details.type','prod_cat','aggregate','/view/:id','$product_details.expiry_date','catch','redirect','getDate','French','Transfer\x20Finalize\x20Successfully','$product_details.production_date','MaxStocks_data','findById','maxPerUnit','371866tSYTZJ','<strong>\x20Regards\x20</strong>','log','QA\x20Warehouse'];a0_0x2ce0=function(){return _0x1a58c7;};return a0_0x2ce0();}const express=require(a0_0x3f1f8a(0x1b1)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x3f1f8a(0x18e)),auth=require(a0_0x3f1f8a(0x256)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router[a0_0x3f1f8a(0x248)](a0_0x3f1f8a(0x187),auth,async(_0x179ec7,_0x3a9cc3)=>{var _0x32e320=a0_0x3f1f8a;try{const {username:_0x92392f,email:_0x24c7f5,role:_0x52b580}=_0x179ec7['user'],_0x5d97df=_0x179ec7[_0x32e320(0x24c)],_0x644a22=await profile['findOne']({'email':_0x5d97df[_0x32e320(0x214)]}),_0x5eca88=await master_shop[_0x32e320(0x195)]();let _0x376c30;if(_0x5d97df[_0x32e320(0x1e2)]==_0x32e320(0x1e7)){const _0x5bcfc3=await staff[_0x32e320(0x1cc)]({'email':_0x5d97df['email']});_0x376c30=await transfers_finished[_0x32e320(0x195)]({'from_warehouse':_0x5bcfc3['warehouse']});}else _0x376c30=await transfers_finished[_0x32e320(0x1fa)]([{'$unwind':_0x32e320(0x25f)},{'$group':{'_id':_0x32e320(0x18a),'invoice':{'$first':_0x32e320(0x21c)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x32e320(0x21b)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x32e320(0x1a7)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x5eca88[0x0][_0x32e320(0x1ec)]==_0x32e320(0x1d3))var _0x358b29=users[_0x32e320(0x249)];else{if(_0x5eca88[0x0][_0x32e320(0x1ec)]==_0x32e320(0x18b))var _0x358b29=users[_0x32e320(0x18b)];else{if(_0x5eca88[0x0][_0x32e320(0x1ec)]==_0x32e320(0x1ca))var _0x358b29=users[_0x32e320(0x1ca)];else{if(_0x5eca88[0x0][_0x32e320(0x1ec)]=='Spanish')var _0x358b29=users[_0x32e320(0x23f)];else{if(_0x5eca88[0x0][_0x32e320(0x1ec)]==_0x32e320(0x200))var _0x358b29=users[_0x32e320(0x200)];else{if(_0x5eca88[0x0]['language']==_0x32e320(0x1e9))var _0x358b29=users[_0x32e320(0x24b)];else{if(_0x5eca88[0x0]['language']==_0x32e320(0x21f))var _0x358b29=users['Chinese'];else{if(_0x5eca88[0x0][_0x32e320(0x1ec)]==_0x32e320(0x25c))var _0x358b29=users[_0x32e320(0x1e0)];}}}}}}}_0x3a9cc3[_0x32e320(0x185)](_0x32e320(0x1cb),{'success':_0x179ec7[_0x32e320(0x238)](_0x32e320(0x19f)),'errors':_0x179ec7[_0x32e320(0x238)](_0x32e320(0x22c)),'role':_0x5d97df,'profile':_0x644a22,'master_shop':_0x5eca88,'transfer':_0x376c30,'language':_0x358b29});}catch(_0xc8911){console[_0x32e320(0x208)](_0xc8911);}});async function getRandom8DigitNumber(){var _0x407e87=a0_0x3f1f8a;const _0x4ea61a=0x989680,_0x462300=0x5f5e0ff,_0x49f20e=Math['floor'](Math[_0x407e87(0x1ba)]()*(_0x462300-_0x4ea61a+0x1))+_0x4ea61a;var _0x2bd509;const _0xe465c2=await transfers_finished[_0x407e87(0x1cc)]({'invoice':_0x407e87(0x1a9)+_0x49f20e});return _0xe465c2&&_0xe465c2[_0x407e87(0x1f3)]>0x0?_0x2bd509=_0x407e87(0x1a9)+_0x49f20e:_0x2bd509=_0x407e87(0x1a9)+_0x49f20e,_0x2bd509;}router[a0_0x3f1f8a(0x248)](a0_0x3f1f8a(0x226),auth,async(_0x132cdb,_0x49ae25)=>{var _0x5ab4ac=a0_0x3f1f8a;try{const {username:_0x115bc2,email:_0x54b7c0,role:_0x55a59f}=_0x132cdb[_0x5ab4ac(0x24c)],_0x4127e9=_0x132cdb[_0x5ab4ac(0x24c)],_0x16e96b=await profile[_0x5ab4ac(0x1cc)]({'email':_0x4127e9[_0x5ab4ac(0x214)]}),_0x3c6df6=await master_shop['find']();let _0xe34e99;if(_0x4127e9[_0x5ab4ac(0x1e2)]==_0x5ab4ac(0x1e7)){const _0x491e8f=await staff['findOne']({'email':_0x4127e9['email']});_0xe34e99=await warehouse[_0x5ab4ac(0x1fa)]([{'$match':{'status':_0x5ab4ac(0x182),'name':_0x491e8f[_0x5ab4ac(0x1be)],'warehouse_category':_0x5ab4ac(0x258),'name':{'$ne':_0x5ab4ac(0x209)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0xe34e99=await warehouse[_0x5ab4ac(0x1fa)]([{'$match':{'status':_0x5ab4ac(0x182),'warehouse_category':_0x5ab4ac(0x258),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':_0x5ab4ac(0x25b)}}}]);const _0x20256f=await transfers_finished[_0x5ab4ac(0x195)]({}),_0x34b410=_0x20256f['length']+0x1,_0x2494cb=_0x5ab4ac(0x1a9)+_0x34b410[_0x5ab4ac(0x1dd)]()[_0x5ab4ac(0x222)](0x5,'0');if(_0x3c6df6[0x0][_0x5ab4ac(0x1ec)]==_0x5ab4ac(0x1d3))var _0x2ac108=users['English'];else{if(_0x3c6df6[0x0]['language']==_0x5ab4ac(0x18b))var _0x2ac108=users[_0x5ab4ac(0x18b)];else{if(_0x3c6df6[0x0][_0x5ab4ac(0x1ec)]==_0x5ab4ac(0x1ca))var _0x2ac108=users[_0x5ab4ac(0x1ca)];else{if(_0x3c6df6[0x0][_0x5ab4ac(0x1ec)]==_0x5ab4ac(0x23f))var _0x2ac108=users[_0x5ab4ac(0x23f)];else{if(_0x3c6df6[0x0]['language']==_0x5ab4ac(0x200))var _0x2ac108=users[_0x5ab4ac(0x200)];else{if(_0x3c6df6[0x0][_0x5ab4ac(0x1ec)]==_0x5ab4ac(0x1e9))var _0x2ac108=users[_0x5ab4ac(0x24b)];else{if(_0x3c6df6[0x0]['language']=='Chinese')var _0x2ac108=users[_0x5ab4ac(0x21f)];else{if(_0x3c6df6[0x0]['language']==_0x5ab4ac(0x25c))var _0x2ac108=users['Arabic'];}}}}}}}const _0x33a4e1=getRandom8DigitNumber();_0x33a4e1[_0x5ab4ac(0x216)](_0x5b5a70=>{var _0x3eeaaa=_0x5ab4ac;_0x49ae25[_0x3eeaaa(0x185)](_0x3eeaaa(0x18c),{'success':_0x132cdb[_0x3eeaaa(0x238)]('success'),'errors':_0x132cdb[_0x3eeaaa(0x238)](_0x3eeaaa(0x22c)),'role':_0x4127e9,'profile':_0x16e96b,'master_shop':_0x3c6df6,'warehouse':_0xe34e99,'language':_0x2ac108,'invoice':_0x5b5a70});})['catch'](_0x1e1eca=>{var _0x3b81a8=_0x5ab4ac;_0x132cdb['flash'](_0x3b81a8(0x22c),_0x3b81a8(0x1aa)),_0x49ae25['redirect'](_0x3b81a8(0x240));});}catch(_0x1f9a1d){console[_0x5ab4ac(0x208)](_0x1f9a1d);}}),router[a0_0x3f1f8a(0x1f5)](a0_0x3f1f8a(0x226),auth,async(_0x560753,_0x2c6bf9)=>{var _0x5b51ac=a0_0x3f1f8a;try{const {date:_0x5d7468,from_warehouse:_0x47f14c,FromRoom_name:_0x52b85c,to_warehouse:_0x4591ed,ToRoom_name:_0x5882b4,prod_name:_0x40a6c5,from_prod_qty:_0x2cf731,from_prod_level:_0x35ce23,from_prod_isle:_0x1b2bc8,from_prod_pallet:_0xda5d28,to_prod_qty:_0x5bd080,to_prod_level:_0x712a3f,to_prod_isle:_0x40bf11,to_prod_pallet:_0x246528,primary_code:_0x3442e9,secondary_code:_0x3f95d0,product_code3:_0x2b6d29,note:_0xfa9958,MaxStocks_data2:_0x516ace,invoice:_0x473dd5,expiry_date:_0xd69ca6}=_0x560753[_0x5b51ac(0x22b)];if(typeof _0x40a6c5=='string')var _0x114d35=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x227)]],_0x38dbba=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1ea)]],_0x482ce4=[_0x560753['body'][_0x5b51ac(0x1db)]],_0x2910c7=[_0x560753[_0x5b51ac(0x22b)]['New_Qty_Converted']],_0x2800e4=[_0x560753['body'][_0x5b51ac(0x1c2)]],_0x15b70a=[_0x560753['body'][_0x5b51ac(0x192)]],_0x290d37=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x25e)]],_0x3b6cd8=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1b7)]],_0x154456=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x230)]],_0x21fbd5=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x24f)]],_0x18d533=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1ce)]],_0x344f92=[_0x560753['body'][_0x5b51ac(0x1e3)]],_0x201b60=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x19d)]],_0x32d77a=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1ab)]],_0x56a119=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x203)]],_0x303a1a=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x205)]],_0x4b1215=[_0x560753[_0x5b51ac(0x22b)]['prod_cat']],_0x50e947=[_0x560753['body'][_0x5b51ac(0x260)]],_0xc1d042=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1c7)]],_0x1e1327=[_0x560753['body'][_0x5b51ac(0x1d5)]],_0x290c2b=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x21d)]],_0x1835f8=[_0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x22f)]];else var _0x114d35=[..._0x560753['body'][_0x5b51ac(0x227)]],_0x38dbba=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1ea)]],_0x482ce4=[..._0x560753['body'][_0x5b51ac(0x1db)]],_0x2910c7=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1c6)]],_0x2800e4=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1c2)]],_0x15b70a=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x192)]],_0x290d37=[..._0x560753['body'][_0x5b51ac(0x25e)]],_0x3b6cd8=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1b7)]],_0x154456=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x230)]],_0x21fbd5=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x24f)]],_0x18d533=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1ce)]],_0x344f92=[..._0x560753['body'][_0x5b51ac(0x1e3)]],_0x201b60=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x19d)]],_0x32d77a=[..._0x560753[_0x5b51ac(0x22b)]['product_date']],_0x56a119=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x203)]],_0x303a1a=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x205)]],_0x4b1215=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1f9)]],_0x50e947=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x260)]],_0xc1d042=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x1c7)]],_0x1e1327=[..._0x560753['body'][_0x5b51ac(0x1d5)]],_0x290c2b=[..._0x560753[_0x5b51ac(0x22b)][_0x5b51ac(0x21d)]],_0x1835f8=[..._0x560753[_0x5b51ac(0x22b)]['id_transaction']];const _0x2253b2=_0x114d35['map'](_0xf482cc=>{return _0xf482cc={'product_name':_0xf482cc};});_0x38dbba['forEach']((_0x40e8c5,_0x22a9b9)=>{var _0x3f26e6=_0x5b51ac;_0x2253b2[_0x22a9b9][_0x3f26e6(0x236)]=_0x40e8c5;}),_0x482ce4['forEach']((_0x24bcf7,_0x257498)=>{var _0x2cb2b9=_0x5b51ac;_0x2253b2[_0x257498][_0x2cb2b9(0x242)]=_0x24bcf7;}),_0x1835f8[_0x5b51ac(0x217)]((_0x44776f,_0x32b8d6)=>{var _0x377d1b=_0x5b51ac;_0x2253b2[_0x32b8d6][_0x377d1b(0x22f)]=_0x44776f;}),_0x1e1327['forEach']((_0xa26440,_0x3a38ab)=>{_0x2253b2[_0x3a38ab]['from_invoice']=_0xa26440;}),_0x290c2b[_0x5b51ac(0x217)]((_0x1ca1f9,_0x36834f)=>{var _0x29b3c2=_0x5b51ac;_0x2253b2[_0x36834f][_0x29b3c2(0x233)]=_0x1ca1f9;}),_0x2910c7[_0x5b51ac(0x217)]((_0x376412,_0x3cb91f)=>{var _0x4559fc=_0x5b51ac;_0x2253b2[_0x3cb91f][_0x4559fc(0x247)]=_0x376412;}),_0x2800e4['forEach']((_0x786bb,_0x1e8adf)=>{var _0x39d53a=_0x5b51ac;_0x2253b2[_0x1e8adf][_0x39d53a(0x251)]=_0x786bb;}),_0x15b70a['forEach']((_0x511616,_0x3f320f)=>{var _0x4df075=_0x5b51ac;_0x2253b2[_0x3f320f][_0x4df075(0x192)]=_0x511616;}),_0x290d37['forEach']((_0x4845c1,_0x3dcbf8)=>{var _0x40e6d7=_0x5b51ac;_0x2253b2[_0x3dcbf8][_0x40e6d7(0x25e)]=_0x4845c1;}),_0x3b6cd8[_0x5b51ac(0x217)]((_0x23b56f,_0x499dc8)=>{var _0x50f3aa=_0x5b51ac;_0x2253b2[_0x499dc8][_0x50f3aa(0x1f6)]=_0x23b56f;}),_0x154456[_0x5b51ac(0x217)]((_0x529391,_0x4e0e4e)=>{var _0x26af78=_0x5b51ac;_0x2253b2[_0x4e0e4e][_0x26af78(0x1eb)]=_0x529391;}),_0x21fbd5[_0x5b51ac(0x217)]((_0x38c877,_0x2bdffa)=>{var _0x82520c=_0x5b51ac;_0x2253b2[_0x2bdffa][_0x82520c(0x197)]=_0x38c877;}),_0x18d533[_0x5b51ac(0x217)]((_0x1c239a,_0x29dd6d)=>{var _0x214154=_0x5b51ac;_0x2253b2[_0x29dd6d][_0x214154(0x1ce)]=_0x1c239a;}),_0x344f92['forEach']((_0x5edc18,_0x3bd5c1)=>{_0x2253b2[_0x3bd5c1]['batch_code']=_0x5edc18;}),_0x201b60[_0x5b51ac(0x217)]((_0x5d5e87,_0x329316)=>{var _0xd5a44c=_0x5b51ac;_0x2253b2[_0x329316][_0xd5a44c(0x19d)]=_0x5d5e87;}),_0x32d77a[_0x5b51ac(0x217)]((_0x50810e,_0x3aa27c)=>{var _0x46a5f6=_0x5b51ac;_0x2253b2[_0x3aa27c][_0x46a5f6(0x229)]=_0x50810e;}),_0x56a119[_0x5b51ac(0x217)]((_0x52fc68,_0x26a19f)=>{var _0x34d513=_0x5b51ac;_0x2253b2[_0x26a19f][_0x34d513(0x1eb)]=_0x52fc68;}),_0x303a1a['forEach']((_0x17af2f,_0x528da6)=>{var _0x186903=_0x5b51ac;_0x2253b2[_0x528da6][_0x186903(0x205)]=_0x17af2f;}),_0x4b1215['forEach']((_0x15b4ad,_0x16e163)=>{var _0x20faef=_0x5b51ac;_0x2253b2[_0x16e163][_0x20faef(0x1f9)]=_0x15b4ad;}),_0x50e947['forEach']((_0x33b9c4,_0x27d4b6)=>{_0x2253b2[_0x27d4b6]['from_room_name']=_0x33b9c4;}),_0xc1d042['forEach']((_0x5b7382,_0x473442)=>{var _0x4f044d=_0x5b51ac;_0x2253b2[_0x473442][_0x4f044d(0x239)]=_0x5b7382;});const _0x5f4725=_0x2253b2['filter'](_0x3de0e5=>_0x3de0e5[_0x5b51ac(0x247)]!=='0'&&_0x3de0e5[_0x5b51ac(0x247)]!==''||_0x3de0e5[_0x5b51ac(0x1a4)]!=='0'&&_0x3de0e5[_0x5b51ac(0x1a4)]!=='');var _0x1edae7=0x0;_0x5f4725[_0x5b51ac(0x217)](_0x27f9ac=>{parseInt(_0x27f9ac['from_quantity'])<parseInt(_0x27f9ac['to_quantity'])&&_0x1edae7++;});if(_0x1edae7!=0x0)return _0x560753['flash'](_0x5b51ac(0x22c),_0x5b51ac(0x25a)),_0x2c6bf9[_0x5b51ac(0x1fe)](_0x5b51ac(0x237));const _0x1bdd80=new transfers_finished({'date':_0x5d7468,'from_warehouse':_0x47f14c,'to_warehouse':_0x4591ed,'product':_0x5f4725,'note':_0xfa9958,'invoice':_0x473dd5}),_0xeccfad=await _0x1bdd80[_0x5b51ac(0x1f1)]();_0x560753[_0x5b51ac(0x238)](_0x5b51ac(0x19f),_0x5b51ac(0x1f2)),_0x2c6bf9[_0x5b51ac(0x1fe)]('/transfer_finished/preview/'+_0xeccfad[_0x5b51ac(0x20e)]);}catch(_0x4f8f23){console[_0x5b51ac(0x208)](_0x4f8f23),_0x2c6bf9[_0x5b51ac(0x1b5)](0xc8)['json']({'errorMessage':_0x4f8f23[_0x5b51ac(0x1b9)]});}}),router['get']('/preview/:id',auth,async(_0x28062c,_0x6c9d4b)=>{var _0x1a1f94=a0_0x3f1f8a;try{const {username:_0x44440f,email:_0x5a5f6a,role:_0x3c9231}=_0x28062c['user'],_0x1f1d91=_0x28062c['user'],_0x3672ee=await profile[_0x1a1f94(0x1cc)]({'email':_0x1f1d91[_0x1a1f94(0x214)]}),_0x4bee35=await master_shop['find'](),_0x1d2460=await transfers_finished[_0x1a1f94(0x204)](_0x28062c[_0x1a1f94(0x1f4)]['id']);let _0x32e2be;if(_0x1f1d91[_0x1a1f94(0x1e2)]=='staff'){const _0x506641=await staff[_0x1a1f94(0x1cc)]({'email':_0x1f1d91[_0x1a1f94(0x214)]});_0x32e2be=await warehouse[_0x1a1f94(0x195)]({'status':_0x1a1f94(0x182),'name':_0x506641[_0x1a1f94(0x1be)],'warehouse_category':_0x1a1f94(0x258)});}else _0x32e2be=await warehouse['find']({'status':_0x1a1f94(0x182),'warehouse_category':_0x1a1f94(0x258)});const _0x21750e=await warehouse['aggregate']([{'$match':{'name':_0x1d2460[_0x1a1f94(0x1a5)],'warehouse_category':_0x1a1f94(0x258)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x1a1f94(0x1b4),'name':{'$first':_0x1a1f94(0x252)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1a1f94(0x1e6)},'type':{'$first':_0x1a1f94(0x1f8)},'floorlevel':{'$first':_0x1a1f94(0x1c3)},'primary_code':{'$first':_0x1a1f94(0x1a1)},'secondary_code':{'$first':_0x1a1f94(0x1df)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1a1f94(0x232)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x1a1f94(0x25b)}}}]),_0x549006=await product[_0x1a1f94(0x195)]({});if(_0x4bee35[0x0][_0x1a1f94(0x1ec)]=='English\x20(US)'){var _0x179648=users[_0x1a1f94(0x249)];console[_0x1a1f94(0x208)](_0x179648);}else{if(_0x4bee35[0x0]['language']==_0x1a1f94(0x18b))var _0x179648=users[_0x1a1f94(0x18b)];else{if(_0x4bee35[0x0][_0x1a1f94(0x1ec)]==_0x1a1f94(0x1ca))var _0x179648=users[_0x1a1f94(0x1ca)];else{if(_0x4bee35[0x0]['language']=='Spanish')var _0x179648=users[_0x1a1f94(0x23f)];else{if(_0x4bee35[0x0][_0x1a1f94(0x1ec)]==_0x1a1f94(0x200))var _0x179648=users[_0x1a1f94(0x200)];else{if(_0x4bee35[0x0][_0x1a1f94(0x1ec)]==_0x1a1f94(0x1e9))var _0x179648=users[_0x1a1f94(0x24b)];else{if(_0x4bee35[0x0]['language']=='Chinese')var _0x179648=users[_0x1a1f94(0x21f)];else{if(_0x4bee35[0x0][_0x1a1f94(0x1ec)]==_0x1a1f94(0x25c))var _0x179648=users[_0x1a1f94(0x1e0)];}}}}}}}_0x6c9d4b[_0x1a1f94(0x185)](_0x1a1f94(0x241),{'success':_0x28062c['flash'](_0x1a1f94(0x19f)),'errors':_0x28062c[_0x1a1f94(0x238)](_0x1a1f94(0x22c)),'role':_0x1f1d91,'profile':_0x3672ee,'master_shop':_0x4bee35,'warehouse':_0x32e2be,'transfer':_0x1d2460,'stock':_0x21750e,'unit':_0x549006,'language':_0x179648});}catch(_0x136804){console['log'](_0x136804);}}),router['post'](a0_0x3f1f8a(0x262),auth,async(_0x5ef33e,_0x43fa7f)=>{var _0x1f5ad6=a0_0x3f1f8a;try{const {invoice:_0x174452,from_warehouse:_0xcff249,FromRoom_name:_0x4ff19f,to_warehouse:_0x3a4333,ToRoom_name:_0x30924}=_0x5ef33e[_0x1f5ad6(0x22b)],_0x1ca3a2=await transfers_finished[_0x1f5ad6(0x204)](_0x5ef33e[_0x1f5ad6(0x1f4)]['id']),_0x2e9c37=_0x1ca3a2['product'][_0x1f5ad6(0x23e)](async _0x5d8dd0=>{var _0x496711=_0x1f5ad6;if(_0x5d8dd0[_0x496711(0x247)]>0x0){var _0x31990c=await warehouse[_0x496711(0x1cc)]({'name':_0xcff249,'room':_0x5d8dd0[_0x496711(0x250)],'warehouse_category':'Finished\x20Goods'});const _0x1039dc=_0x31990c[_0x496711(0x1e4)]['map'](_0x23e5c2=>{var _0x398ef9=_0x496711;_0x23e5c2['product_name']==_0x5d8dd0['product_name']&&_0x23e5c2[_0x398ef9(0x22d)]==_0x5d8dd0[_0x398ef9(0x242)]&&_0x23e5c2[_0x398ef9(0x19d)]==_0x5d8dd0[_0x398ef9(0x19d)]&&_0x23e5c2['production_date']==_0x5d8dd0[_0x398ef9(0x229)]&&_0x23e5c2['batch_code']==_0x5d8dd0[_0x398ef9(0x1e3)]&&_0x23e5c2[_0x398ef9(0x1a8)]==_0x5d8dd0[_0x398ef9(0x1d5)]&&(console[_0x398ef9(0x208)](_0x398ef9(0x219),_0x23e5c2['product_stock']),typeof _0x5d8dd0[_0x398ef9(0x22f)]==_0x398ef9(0x21a)?_0x23e5c2[_0x398ef9(0x1e1)]=Math[_0x398ef9(0x20a)](0x0,Math['abs'](_0x23e5c2['product_stock'])-Math[_0x398ef9(0x1c9)](_0x5d8dd0['to_quantity'])):_0x23e5c2[_0x398ef9(0x1e1)]=Math[_0x398ef9(0x20a)](0x0,Math[_0x398ef9(0x1c9)](_0x23e5c2[_0x398ef9(0x1e1)])-Math['abs'](_0x5d8dd0['to_quantity'])));});}return _0x31990c;});Promise['all'](_0x2e9c37)[_0x1f5ad6(0x216)](async _0x92e648=>{var _0x1ad1b0=_0x1f5ad6;try{for(const _0x4be1d2 of _0x92e648){await _0x4be1d2[_0x1ad1b0(0x1f1)]();}const _0x37a0de=_0x1ca3a2[_0x1ad1b0(0x1c1)]['map'](async _0x5aa83d=>{var _0x3d6726=_0x1ad1b0,_0x191aec=await warehouse[_0x3d6726(0x1cc)]({'name':_0x3a4333,'room':_0x5aa83d[_0x3d6726(0x239)]});if(_0x5aa83d[_0x3d6726(0x247)]>0x0){var _0x1b801d=0x0;const _0x4a1fd6=_0x191aec['product_details']['map'](_0x1780fe=>{var _0x38aa1a=_0x3d6726;_0x1780fe[_0x38aa1a(0x1dc)]==_0x5aa83d[_0x38aa1a(0x1dc)]&&_0x1780fe[_0x38aa1a(0x22d)]==_0x5aa83d[_0x38aa1a(0x251)]&&_0x1780fe[_0x38aa1a(0x19d)]==_0x5aa83d[_0x38aa1a(0x19d)]&&_0x1780fe[_0x38aa1a(0x229)]==_0x5aa83d['production_date']&&_0x1780fe['batch_code']==_0x5aa83d[_0x38aa1a(0x1e3)]&&_0x1780fe[_0x38aa1a(0x1a8)]==_0x5aa83d['To_invoice']&&(typeof _0x5aa83d['id_transaction']==_0x38aa1a(0x21a)?(console[_0x38aa1a(0x208)](_0x38aa1a(0x196),_0x1780fe[_0x38aa1a(0x1e1)]+'\x20<>\x20'+_0x1780fe[_0x38aa1a(0x20e)]+_0x38aa1a(0x1bc)+Math[_0x38aa1a(0x1c9)](_0x1780fe[_0x38aa1a(0x1e1)])+Math['abs'](_0x5aa83d['to_quantity'])),_0x1780fe[_0x38aa1a(0x1e1)]=Math['abs'](_0x1780fe['product_stock'])+Math['abs'](_0x5aa83d[_0x38aa1a(0x247)])):_0x1780fe[_0x38aa1a(0x1e1)]=Math['abs'](_0x1780fe['product_stock'])+Math[_0x38aa1a(0x1c9)](_0x5aa83d[_0x38aa1a(0x247)]),_0x1b801d++);});_0x1b801d=='0'&&(_0x191aec[_0x3d6726(0x1e4)]=_0x191aec['product_details']['concat']({'product_name':_0x5aa83d[_0x3d6726(0x1dc)],'product_stock':_0x5aa83d[_0x3d6726(0x247)],'bay':_0x5aa83d[_0x3d6726(0x251)],'product_code':_0x5aa83d[_0x3d6726(0x1f6)],'primary_code':_0x5aa83d[_0x3d6726(0x192)],'secondary_code':_0x5aa83d['secondary_code'],'expiry_date':_0x5aa83d[_0x3d6726(0x19d)],'production_date':_0x5aa83d[_0x3d6726(0x229)],'maxProducts':_0x5aa83d[_0x3d6726(0x1eb)],'batch_code':_0x5aa83d[_0x3d6726(0x1e3)],'secondary_unit':_0x5aa83d[_0x3d6726(0x1ce)],'unit':_0x5aa83d[_0x3d6726(0x197)],'maxProducts':_0x5aa83d[_0x3d6726(0x1eb)],'maxPerUnit':_0x5aa83d[_0x3d6726(0x205)],'invoice':_0x5aa83d[_0x3d6726(0x233)]}));}return _0x191aec;});Promise[_0x1ad1b0(0x255)](_0x37a0de)[_0x1ad1b0(0x216)](async _0x4d098f=>{var _0xfc86a=_0x1ad1b0;try{for(const _0x4abfec of _0x4d098f){await warehouse[_0xfc86a(0x25d)]({'_id':_0x4abfec[_0xfc86a(0x20e)]},{'$addToSet':{'product_details':{'$each':_0x4abfec[_0xfc86a(0x1e4)]}}});}_0x1ca3a2[_0xfc86a(0x1d0)]=_0xfc86a(0x20b);const _0x5abae9=await _0x1ca3a2[_0xfc86a(0x1f1)](),_0x16e232=await master_shop[_0xfc86a(0x195)](),_0x300de2=await email_settings['findOne'](),_0xa7f7c8=await supervisor_settings[_0xfc86a(0x195)]();var _0x10814b=_0x1ca3a2[_0xfc86a(0x1c1)],_0x947992='',_0x344395;for(_0x344395 in _0x10814b){var _0x2580eb='FG';_0x1ca3a2[_0xfc86a(0x1b2)]=='DRY\x20GOODS'&&(_0x2580eb='DG'),_0x947992+=_0xfc86a(0x1e5)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10814b[_0x344395][_0xfc86a(0x1dc)]+_0xfc86a(0x1d4)+_0xfc86a(0x1c5)+_0x10814b[_0x344395]['product_code']+_0xfc86a(0x1d4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10814b[_0x344395]['to_quantity']+_0xfc86a(0x1d4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x10814b[_0x344395][_0xfc86a(0x197)]+_0xfc86a(0x1d4)+_0xfc86a(0x1c5)+_0x10814b[_0x344395]['secondary_unit']+_0xfc86a(0x1d4)+_0xfc86a(0x1c5)+_0x1ca3a2[_0xfc86a(0x1b2)]+_0xfc86a(0x1d4)+_0xfc86a(0x1c5)+_0x10814b[_0x344395][_0xfc86a(0x239)]+_0xfc86a(0x1d4)+_0xfc86a(0x1c5)+_0x2580eb+_0x10814b[_0x344395][_0xfc86a(0x251)]+_0xfc86a(0x1d4)+_0xfc86a(0x224);}let _0x32d4c1=nodemailer[_0xfc86a(0x191)]({'host':_0x300de2['host'],'port':Number(_0x300de2[_0xfc86a(0x21e)]),'secure':![],'auth':{'user':_0x300de2[_0xfc86a(0x214)],'pass':_0x300de2[_0xfc86a(0x263)]}}),_0x5dba0c={'from':_0x300de2['email'],'to':_0xa7f7c8[0x0][_0xfc86a(0x22e)],'subject':_0xfc86a(0x183),'attachments':[{'filename':_0xfc86a(0x265),'path':__dirname+_0xfc86a(0x1ef)+_0xfc86a(0x218)+_0x16e232[0x0][_0xfc86a(0x1da)],'cid':_0xfc86a(0x1f0)}],'html':_0xfc86a(0x190)+_0xfc86a(0x1a3)+_0xfc86a(0x221)+_0xfc86a(0x1ac)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0xfc86a(0x1ac)+_0xfc86a(0x1bf)+_0xfc86a(0x198)+_0xfc86a(0x1ac)+_0xfc86a(0x231)+_0x16e232[0x0][_0xfc86a(0x1bd)]+_0xfc86a(0x18d)+_0xfc86a(0x198)+_0xfc86a(0x198)+_0xfc86a(0x1a6)+_0xfc86a(0x1ac)+_0xfc86a(0x246)+'\x20Order\x20Number\x20:\x20'+_0x1ca3a2['invoice']+'\x20'+_0xfc86a(0x223)+_0xfc86a(0x210)+_0x1ca3a2[_0xfc86a(0x1cd)]+'\x20'+_0xfc86a(0x184)+_0xfc86a(0x254)+_0xfc86a(0x198)+_0xfc86a(0x1c4)+_0xfc86a(0x253)+_0xfc86a(0x1e5)+_0xfc86a(0x186)+_0xfc86a(0x18f)+_0xfc86a(0x1e8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0xfc86a(0x212)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0xfc86a(0x1d2)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0xfc86a(0x224)+_0xfc86a(0x22a)+_0xfc86a(0x211)+'\x20'+_0x947992+'\x20'+_0xfc86a(0x215)+_0xfc86a(0x20c)+'<div>'+_0xfc86a(0x207)+_0xfc86a(0x1d7)+_0x16e232[0x0][_0xfc86a(0x1bd)]+_0xfc86a(0x254)+_0xfc86a(0x198)+_0xfc86a(0x198)+'</body></html>'};_0x32d4c1[_0xfc86a(0x23a)](_0x5dba0c,function(_0x564c30,_0x38dba7){var _0x3e81d8=_0xfc86a;_0x564c30?(console[_0x3e81d8(0x208)](_0x564c30),console['log'](_0x3e81d8(0x23b))):console[_0x3e81d8(0x208)](_0x3e81d8(0x24a));}),_0x5ef33e[_0xfc86a(0x238)](_0xfc86a(0x19f),_0xfc86a(0x201)),_0x43fa7f[_0xfc86a(0x1fe)](_0xfc86a(0x23c)+_0x5abae9[_0xfc86a(0x20e)]);}catch(_0x13812f){console[_0xfc86a(0x199)](_0x13812f),_0x43fa7f['status'](0x1f4)['json']({'error':_0xfc86a(0x1b0)});}})['catch'](_0x4b273c=>{var _0x249554=_0x1ad1b0;console[_0x249554(0x199)](_0x4b273c),_0x43fa7f['status'](0x1f4)[_0x249554(0x244)]({'error':'An\x20error\x20occurred.'});});}catch(_0x167715){console[_0x1ad1b0(0x199)](_0x167715),_0x43fa7f[_0x1ad1b0(0x1b5)](0x1f4)[_0x1ad1b0(0x244)]({'error':_0x1ad1b0(0x1a2)});}})[_0x1f5ad6(0x1fd)](_0x125fcd=>{var _0x7c1483=_0x1f5ad6;console['error'](_0x125fcd),_0x43fa7f[_0x7c1483(0x1b5)](0x1f4)[_0x7c1483(0x244)]({'error':_0x7c1483(0x1de)});});}catch(_0xd6d26f){_0x43fa7f[_0x1f5ad6(0x244)]({'message':_0xd6d26f[_0x1f5ad6(0x1b9)]});}});function BayBinSelected(_0x176801,_0xbf103b){var _0xf7e916=a0_0x3f1f8a,_0x166c3a=[];let _0x3f7484=[];var _0x2ab5c1=[];if(_0x176801==_0xf7e916(0x259)){switch(_0xbf103b){case _0xf7e916(0x1ed):_0x166c3a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x166c3a=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x2ab5c1=['DG'];}else{if(_0x176801=='FROZEN\x20GOODS'){switch(_0xbf103b){case _0xf7e916(0x1ed):_0x166c3a=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0xf7e916(0x245):_0x166c3a=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x2ab5c1=['FG'];}}return{'levels':_0x166c3a,'identify':_0x2ab5c1};}router['get'](a0_0x3f1f8a(0x1fb),auth,async(_0x42c2e8,_0x542a61)=>{var _0xc09afc=a0_0x3f1f8a;try{const {username:_0x2ab0c9,email:_0x22125c,role:_0x280e66}=_0x42c2e8[_0xc09afc(0x24c)],_0x983963=_0x42c2e8[_0xc09afc(0x24c)],_0x1756e1=await profile['findOne']({'email':_0x983963['email']}),_0x311eac=await master_shop[_0xc09afc(0x195)](),_0x53f644=await transfers_finished[_0xc09afc(0x204)](_0x42c2e8['params']['id']);let _0x5d841a=new Date(_0x53f644['expiry_date']),_0x5a0a61=('0'+_0x5d841a[_0xc09afc(0x1ff)]())[_0xc09afc(0x1bb)](-0x2),_0x57e881=('0'+(_0x5d841a[_0xc09afc(0x257)]()+0x1))['slice'](-0x2),_0xc069d0=_0x5d841a[_0xc09afc(0x188)](),_0x41b5bb=_0xc069d0+'-'+_0x57e881+'-'+_0x5a0a61,_0x2a973a;if(_0x983963[_0xc09afc(0x1e2)]=='staff'){const _0x4fc454=await staff[_0xc09afc(0x1cc)]({'email':_0x983963[_0xc09afc(0x214)]});_0x2a973a=await warehouse[_0xc09afc(0x195)]({'status':'Enabled','name':_0x4fc454[_0xc09afc(0x1be)],'warehouse_category':_0xc09afc(0x258)});}else _0x2a973a=await warehouse[_0xc09afc(0x195)]({'status':_0xc09afc(0x182),'warehouse_category':_0xc09afc(0x258)});const _0xffb25d=await warehouse[_0xc09afc(0x1fa)]([{'$match':{'name':_0x53f644[_0xc09afc(0x1a5)],'room':_0x53f644[_0xc09afc(0x19e)]}},{'$unwind':_0xc09afc(0x1c8)},{'$group':{'_id':_0xc09afc(0x1b4),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0xc09afc(0x1e6)},'type':{'$first':_0xc09afc(0x1f8)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0xc09afc(0x1a1)},'secondary_code':{'$first':_0xc09afc(0x1df)},'product_code':{'$first':_0xc09afc(0x228)},'storage':{'$first':_0xc09afc(0x1cf)},'rack':{'$first':_0xc09afc(0x232)}}}]);var _0x147421=[0x1,0x2,0x3,0x4],_0x1ae4d4=['A','B','C','D','E','F','G','H','I','J'],_0x2bd11e=[_0xc09afc(0x234),'Enclosed'];const _0x112fc9=await product[_0xc09afc(0x195)]({}),_0x17a801=BayBinSelected(_0x53f644['to_warehouse'],_0x53f644[_0xc09afc(0x19b)]);if(_0x311eac[0x0]['language']==_0xc09afc(0x1d3)){var _0x18c197=users[_0xc09afc(0x249)];console[_0xc09afc(0x208)](_0x18c197);}else{if(_0x311eac[0x0]['language']==_0xc09afc(0x18b))var _0x18c197=users[_0xc09afc(0x18b)];else{if(_0x311eac[0x0][_0xc09afc(0x1ec)]=='German')var _0x18c197=users[_0xc09afc(0x1ca)];else{if(_0x311eac[0x0][_0xc09afc(0x1ec)]==_0xc09afc(0x23f))var _0x18c197=users[_0xc09afc(0x23f)];else{if(_0x311eac[0x0]['language']==_0xc09afc(0x200))var _0x18c197=users[_0xc09afc(0x200)];else{if(_0x311eac[0x0]['language']==_0xc09afc(0x1e9))var _0x18c197=users['Portuguese'];else{if(_0x311eac[0x0][_0xc09afc(0x1ec)]==_0xc09afc(0x21f))var _0x18c197=users[_0xc09afc(0x21f)];else{if(_0x311eac[0x0]['language']==_0xc09afc(0x25c))var _0x18c197=users[_0xc09afc(0x1e0)];}}}}}}}_0x542a61['render']('edit_transfer_finished',{'success':_0x42c2e8[_0xc09afc(0x238)](_0xc09afc(0x19f)),'errors':_0x42c2e8[_0xc09afc(0x238)](_0xc09afc(0x22c)),'role':_0x983963,'profile':_0x1756e1,'master_shop':_0x311eac,'warehouse':_0x2a973a,'transfer':_0x53f644,'stock':_0xffb25d,'unit':_0x112fc9,'language':_0x18c197,'levels':_0x147421,'Isle':_0x1ae4d4,'rooms_data':_0x2bd11e,'ed_fullDate':_0x41b5bb,'dataSelected':_0x17a801});}catch(_0x3a4fe0){console[_0xc09afc(0x208)](_0x3a4fe0);}}),router[a0_0x3f1f8a(0x1f5)](a0_0x3f1f8a(0x1fb),auth,async(_0x29e0bc,_0x5b16d4)=>{var _0x3fe9f8=a0_0x3f1f8a;try{const _0x144cf3=_0x29e0bc[_0x3fe9f8(0x1f4)]['id'];console['log'](_0x29e0bc[_0x3fe9f8(0x22b)]);const _0x4c5710=await transfers_finished[_0x3fe9f8(0x204)](_0x144cf3);console[_0x3fe9f8(0x208)](_0x3fe9f8(0x264),_0x4c5710);const {date:_0x205e03,from_warehouse:_0x2b50c4,FromRoom_name:_0x40f3e7,to_warehouse:_0x574fd4,ToRoom_name:_0x4617d4,prod_name:_0x4366ef,from_prod_qty:_0x2f433b,from_prod_level:_0x1dcc05,from_prod_isle:_0x836bba,from_prod_pallet:_0xb5f195,to_prod_qty:_0x432c9b,to_prod_level:_0x5b0dfb,to_prod_isle:_0x3544f0,to_prod_pallet:_0x1cc1b0,primary_code:_0x4b2a61,secondary_code:_0x54edcc,product_code3:_0x19706a,note:_0x546f84,invoice:_0x4d4d9e,expiry_date:_0x2a10c2}=_0x29e0bc[_0x3fe9f8(0x22b)];if(typeof _0x4366ef==_0x3fe9f8(0x1b3))var _0x5acd18=[_0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x227)]],_0x154113=[_0x29e0bc['body'][_0x3fe9f8(0x1ea)]],_0x470970=[_0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x1db)]],_0x1001c7=[_0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x19c)]],_0x3a8be4=[_0x29e0bc[_0x3fe9f8(0x22b)]['to_prod_level']],_0x56f520=[_0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x192)]],_0x311e94=[_0x29e0bc['body'][_0x3fe9f8(0x25e)]],_0x3771c3=[_0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x1b7)]],_0x763276=[_0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x230)]],_0x13054e=[_0x29e0bc['body'][_0x3fe9f8(0x197)]],_0x568870=[_0x29e0bc['body']['secondary_unit']],_0x6d4dec=[_0x29e0bc[_0x3fe9f8(0x22b)]['batch_code']],_0x2d92a9=[_0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x19d)]];else var _0x5acd18=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x227)]],_0x154113=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x1ea)]],_0x470970=[..._0x29e0bc['body'][_0x3fe9f8(0x1db)]],_0x1001c7=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x19c)]],_0x3a8be4=[..._0x29e0bc[_0x3fe9f8(0x22b)]['to_prod_level']],_0x56f520=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x192)]],_0x311e94=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x25e)]],_0x3771c3=[..._0x29e0bc[_0x3fe9f8(0x22b)]['product_code3']],_0x763276=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x230)]],_0x13054e=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x197)]],_0x568870=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x1ce)]],_0x6d4dec=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x1e3)]],_0x2d92a9=[..._0x29e0bc[_0x3fe9f8(0x22b)][_0x3fe9f8(0x19d)]];const _0x2ff8b2=_0x5acd18[_0x3fe9f8(0x23e)](_0xab1aa3=>{return _0xab1aa3={'product_name':_0xab1aa3};});_0x154113[_0x3fe9f8(0x217)]((_0x344380,_0x282238)=>{var _0x22f159=_0x3fe9f8;_0x2ff8b2[_0x282238][_0x22f159(0x236)]=_0x344380;}),_0x470970[_0x3fe9f8(0x217)]((_0x2f57a7,_0x1f83c9)=>{var _0x214552=_0x3fe9f8;_0x2ff8b2[_0x1f83c9][_0x214552(0x242)]=_0x2f57a7;}),_0x1001c7[_0x3fe9f8(0x217)]((_0x4bcce9,_0x58f7c1)=>{var _0x15193d=_0x3fe9f8;_0x2ff8b2[_0x58f7c1][_0x15193d(0x247)]=_0x4bcce9;}),_0x3a8be4[_0x3fe9f8(0x217)]((_0x1cae0f,_0x2cd31e)=>{var _0x46fd66=_0x3fe9f8;_0x2ff8b2[_0x2cd31e][_0x46fd66(0x251)]=_0x1cae0f;}),_0x56f520[_0x3fe9f8(0x217)]((_0x12a9ba,_0x44da69)=>{var _0x4c8cc3=_0x3fe9f8;_0x2ff8b2[_0x44da69][_0x4c8cc3(0x192)]=_0x12a9ba;}),_0x311e94[_0x3fe9f8(0x217)]((_0x2ebcaa,_0x4e5359)=>{var _0x52daef=_0x3fe9f8;_0x2ff8b2[_0x4e5359][_0x52daef(0x25e)]=_0x2ebcaa;}),_0x3771c3[_0x3fe9f8(0x217)]((_0xc16553,_0x5b8257)=>{var _0x1e83d7=_0x3fe9f8;_0x2ff8b2[_0x5b8257][_0x1e83d7(0x1f6)]=_0xc16553;}),_0x763276[_0x3fe9f8(0x217)]((_0x37dbbf,_0x1300f5)=>{var _0x20a325=_0x3fe9f8;_0x2ff8b2[_0x1300f5][_0x20a325(0x1eb)]=_0x37dbbf;}),_0x13054e[_0x3fe9f8(0x217)]((_0x111e3d,_0x487823)=>{var _0x5bd218=_0x3fe9f8;_0x2ff8b2[_0x487823][_0x5bd218(0x197)]=_0x111e3d;}),_0x568870[_0x3fe9f8(0x217)]((_0x1da00f,_0xc1bb4)=>{var _0x282229=_0x3fe9f8;_0x2ff8b2[_0xc1bb4][_0x282229(0x1ce)]=_0x1da00f;}),_0x6d4dec['forEach']((_0x1a93c1,_0x36d83e)=>{_0x2ff8b2[_0x36d83e]['batch_code']=_0x1a93c1;}),_0x2d92a9[_0x3fe9f8(0x217)]((_0x5a49e5,_0x364b16)=>{var _0x56a70d=_0x3fe9f8;_0x2ff8b2[_0x364b16][_0x56a70d(0x19d)]=_0x5a49e5;});const _0x586420=_0x2ff8b2['filter'](_0x5e0886=>_0x5e0886[_0x3fe9f8(0x247)]!=='0'&&_0x5e0886[_0x3fe9f8(0x247)]!==''||_0x5e0886[_0x3fe9f8(0x1a4)]!=='0'&&_0x5e0886[_0x3fe9f8(0x1a4)]!=='');var _0x2e6fe6=0x0;_0x586420['forEach'](_0x57a23f=>{var _0x5db798=_0x3fe9f8;parseInt(_0x57a23f['from_quantity'])<parseInt(_0x57a23f[_0x5db798(0x247)])&&_0x2e6fe6++;});if(_0x2e6fe6!=0x0)return _0x29e0bc[_0x3fe9f8(0x238)]('errors',_0x3fe9f8(0x25a)),_0x5b16d4['redirect'](_0x3fe9f8(0x237));const _0x3638ff=await warehouse['findOne']({'name':_0x4c5710[_0x3fe9f8(0x1a5)],'room':_0x4c5710[_0x3fe9f8(0x19e)]});_0x4c5710[_0x3fe9f8(0x1c1)]['forEach'](_0x15dcc1=>{var _0x5690c1=_0x3fe9f8;if(_0x15dcc1[_0x5690c1(0x247)]>0x0){const _0x4befda=_0x3638ff[_0x5690c1(0x1e4)][_0x5690c1(0x23e)](_0x14b790=>{var _0x34cea3=_0x5690c1;_0x14b790[_0x34cea3(0x1dc)]==_0x15dcc1[_0x34cea3(0x1dc)]&&_0x14b790[_0x34cea3(0x22d)]==_0x15dcc1['from_bay']&&(_0x14b790[_0x34cea3(0x1e1)]=parseInt(_0x14b790[_0x34cea3(0x1e1)])+parseInt(_0x15dcc1[_0x34cea3(0x247)]));});}}),await _0x3638ff[_0x3fe9f8(0x1f1)]();const _0x2aa107=await warehouse[_0x3fe9f8(0x1cc)]({'name':_0x4c5710[_0x3fe9f8(0x1b2)],'room':_0x4c5710[_0x3fe9f8(0x19b)]});_0x4c5710[_0x3fe9f8(0x1c1)][_0x3fe9f8(0x217)](_0x57b5b3=>{var _0x6a850f=_0x3fe9f8;if(_0x57b5b3[_0x6a850f(0x247)]>0x0){const _0x465776=_0x2aa107[_0x6a850f(0x1e4)]['map'](_0x19fabf=>{var _0xfb2c61=_0x6a850f;_0x19fabf['product_name']==_0x57b5b3[_0xfb2c61(0x1dc)]&&_0x19fabf[_0xfb2c61(0x22d)]==_0x57b5b3[_0xfb2c61(0x251)]&&(_0x19fabf[_0xfb2c61(0x1e1)]=parseInt(_0x19fabf['product_stock'])-parseInt(_0x57b5b3[_0xfb2c61(0x247)]));});}}),await _0x2aa107[_0x3fe9f8(0x1f1)](),_0x4c5710['date']=_0x205e03,_0x4c5710[_0x3fe9f8(0x1a5)]=_0x2b50c4,_0x4c5710[_0x3fe9f8(0x1b2)]=_0x574fd4,_0x4c5710[_0x3fe9f8(0x1c1)]=_0x586420,_0x4c5710[_0x3fe9f8(0x24e)]=_0x546f84,_0x4c5710[_0x3fe9f8(0x1a8)]=_0x4d4d9e;const _0x2f59cd=await _0x4c5710[_0x3fe9f8(0x1f1)](),_0x5cea7d=await warehouse[_0x3fe9f8(0x1cc)]({'name':_0x2b50c4,'room':_0x40f3e7});_0x2f59cd[_0x3fe9f8(0x1c1)][_0x3fe9f8(0x217)](_0x56b5a3=>{var _0x533ed4=_0x3fe9f8;if(_0x56b5a3[_0x533ed4(0x247)]>0x0){const _0x399273=_0x5cea7d[_0x533ed4(0x1e4)]['map'](_0x2f9809=>{var _0x3f9a8c=_0x533ed4;_0x2f9809[_0x3f9a8c(0x1dc)]==_0x56b5a3['product_name']&&_0x2f9809[_0x3f9a8c(0x22d)]==_0x56b5a3[_0x3f9a8c(0x242)]&&(_0x2f9809[_0x3f9a8c(0x1e1)]=parseInt(_0x2f9809[_0x3f9a8c(0x1e1)])-parseInt(_0x56b5a3[_0x3f9a8c(0x247)]));});}}),await _0x5cea7d['save']();const _0x211784=await warehouse['findOne']({'name':_0x574fd4,'room':_0x4617d4});_0x2f59cd[_0x3fe9f8(0x1c1)][_0x3fe9f8(0x217)](_0x4619ea=>{var _0x5d551e=_0x3fe9f8;if(_0x4619ea['to_quantity']>0x0){var _0x21eebf=0x0;const _0x2ffe8e=_0x211784[_0x5d551e(0x1e4)]['map'](_0x56cd5c=>{var _0x4daa75=_0x5d551e;_0x56cd5c[_0x4daa75(0x1dc)]==_0x4619ea[_0x4daa75(0x1dc)]&&_0x56cd5c[_0x4daa75(0x22d)]==_0x4619ea[_0x4daa75(0x251)]&&(_0x56cd5c['product_stock']=parseInt(_0x56cd5c['product_stock'])+parseInt(_0x4619ea['to_quantity']),_0x21eebf++);});_0x21eebf=='0'&&(_0x211784[_0x5d551e(0x1e4)]=_0x211784[_0x5d551e(0x1e4)][_0x5d551e(0x181)]({'product_name':_0x4619ea[_0x5d551e(0x1dc)],'product_stock':_0x4619ea[_0x5d551e(0x247)],'bay':_0x4619ea[_0x5d551e(0x251)],'product_code':_0x4619ea[_0x5d551e(0x1f6)],'primary_code':_0x4619ea[_0x5d551e(0x192)],'secondary_code':_0x4619ea['secondary_code'],'maxProducts':_0x4619ea[_0x5d551e(0x1eb)]}));}}),await _0x211784[_0x3fe9f8(0x1f1)](),_0x29e0bc[_0x3fe9f8(0x238)](_0x3fe9f8(0x19f),'Transfer\x20Edit\x20Successfully'),_0x5b16d4[_0x3fe9f8(0x1fe)](_0x3fe9f8(0x1d9));}catch(_0x26903c){console[_0x3fe9f8(0x208)](_0x26903c);}}),router['post']('/barcode_scanner',async(_0x8020b2,_0x3edc28)=>{var _0x2ba0ab=a0_0x3f1f8a;const {FromWareHouse:_0x4cd3c8,FromRoom:_0x57a835,ToWarehouse:_0x1edd80,ToRoom:_0x58c8ad,primary_code:_0x26ba22,Roomslist:_0x3e235c}=_0x8020b2[_0x2ba0ab(0x22b)],_0x1f582c=_0x3e235c['split'](','),_0x3e7e36=[];async function _0x42322f(_0x507e65){var _0x21d1c7=_0x2ba0ab;const _0x4d9008=await warehouse[_0x21d1c7(0x1fa)]([{'$match':{'name':_0x4cd3c8,'room':_0x507e65}},{'$unwind':_0x21d1c7(0x1c8)},{'$match':{'product_details.primary_code':_0x26ba22}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x21d1c7(0x252)},'instock':{'$first':_0x21d1c7(0x1d1)},'primary_code':{'$first':_0x21d1c7(0x1a1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x21d1c7(0x228)},'level':{'$first':_0x21d1c7(0x1ae)},'isle':{'$first':_0x21d1c7(0x1e6)},'type':{'$first':_0x21d1c7(0x1f8)},'pallet':{'$first':_0x21d1c7(0x1c3)},'unit':{'$first':_0x21d1c7(0x1f7)},'secondary_unit':{'$first':_0x21d1c7(0x23d)},'storage':{'$first':_0x21d1c7(0x1cf)},'rack':{'$first':_0x21d1c7(0x232)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x21d1c7(0x19a)},'maxPerUnit':{'$first':_0x21d1c7(0x20d)},'roomNamed':{'$first':_0x21d1c7(0x194)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x21d1c7(0x213)}}}]),_0xb300cd=await warehouse[_0x21d1c7(0x1fa)]([{'$match':{'name':_0x4cd3c8,'room':_0x507e65}},{'$unwind':_0x21d1c7(0x1c8)},{'$match':{'product_details.secondary_code':_0x26ba22}},{'$group':{'_id':_0x21d1c7(0x1b4),'name':{'$first':_0x21d1c7(0x252)},'instock':{'$first':_0x21d1c7(0x1d1)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x21d1c7(0x1df)},'product_code':{'$first':_0x21d1c7(0x228)},'level':{'$first':_0x21d1c7(0x1ae)},'isle':{'$first':_0x21d1c7(0x1e6)},'type':{'$first':_0x21d1c7(0x1f8)},'pallet':{'$first':_0x21d1c7(0x1c3)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x21d1c7(0x23d)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x21d1c7(0x232)},'expiry_date':{'$first':_0x21d1c7(0x1fc)},'production_date':{'$first':_0x21d1c7(0x202)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x21d1c7(0x194)},'prod_cat':{'$first':'S'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x4d9008[_0x21d1c7(0x1f3)]>0x0)_0x3e7e36[_0x21d1c7(0x1c0)](_0x4d9008);else _0xb300cd[_0x21d1c7(0x1f3)]>0x0&&_0x3e7e36[_0x21d1c7(0x1c0)](_0xb300cd);}const _0x485424=_0x1f582c[_0x2ba0ab(0x23e)](_0xfa711=>_0x42322f(_0xfa711));await Promise['all'](_0x485424),_0x3edc28[_0x2ba0ab(0x244)](_0x3e7e36);}),router[a0_0x3f1f8a(0x1f5)](a0_0x3f1f8a(0x189),async(_0x5bc1f6,_0x48b427)=>{var _0x145565=a0_0x3f1f8a;try{const {FromWareHouse:_0x4daa61,FromRoom:_0x1599af,ToWarehouse:_0x1c2aab,ToRoom:_0x2bcf10,secondary_code:_0x51be40}=_0x5bc1f6['body'],_0x11e968=await warehouse[_0x145565(0x1fa)]([{'$match':{'name':_0x4daa61}},{'$unwind':_0x145565(0x1c8)},{'$match':{'product_details.secondary_code':_0x51be40}},{'$group':{'_id':_0x145565(0x1b4),'name':{'$first':_0x145565(0x252)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x145565(0x1df)},'product_code':{'$first':_0x145565(0x228)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x145565(0x25b)},'level':{'$first':_0x145565(0x243)},'isle':{'$first':_0x145565(0x1d8)},'pallet':{'$first':_0x145565(0x1b6)},'maxProducts':{'$first':_0x145565(0x235)},'unit':{'$first':_0x145565(0x1f7)},'expiry_date':{'$first':_0x145565(0x1fc)},'production_date':{'$first':'$product_details.production_date'}}}]);_0x48b427[_0x145565(0x1b5)](0xc8)[_0x145565(0x244)](_0x11e968);}catch(_0x2b543f){_0x48b427[_0x145565(0x1b5)](0x194)[_0x145565(0x244)]({'message':_0x2b543f[_0x145565(0x1b9)]});}}),router['post']('/barcode_scanner3',async(_0x41b2b7,_0x38f359)=>{var _0x4abec9=a0_0x3f1f8a;try{const {FromWareHouse:_0x403b3f,FromRoom:_0x409a31,ToWarehouse:_0x73d1f0,ToRoom:_0x4d395b,product_code:_0x3f515a}=_0x41b2b7[_0x4abec9(0x22b)],_0x5b91b2=await warehouse[_0x4abec9(0x1fa)]([{'$match':{'name':_0x403b3f}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x3f515a}},{'$group':{'_id':_0x4abec9(0x1b4),'name':{'$first':_0x4abec9(0x252)},'primary_code':{'$first':_0x4abec9(0x1a1)},'secondary_code':{'$first':_0x4abec9(0x1df)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x4abec9(0x1d1)},'warehouse':{'$first':_0x4abec9(0x25b)},'level':{'$first':_0x4abec9(0x243)},'isle':{'$first':_0x4abec9(0x1d8)},'pallet':{'$first':_0x4abec9(0x1b6)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x4abec9(0x1f7)}}}]);_0x38f359['status'](0xc8)['json'](_0x5b91b2);}catch(_0x20704e){_0x38f359[_0x4abec9(0x1b5)](0x194)[_0x4abec9(0x244)]({'message':_0x20704e['message']});}}),router[a0_0x3f1f8a(0x1f5)](a0_0x3f1f8a(0x24d),async(_0x15c0db,_0xc71a18)=>{var _0x5a2a41=a0_0x3f1f8a;const {productCode:_0xbb7ca3,bay:_0x10e811,warehouses:_0x275f5f,room:_0x5cdc10}=_0x15c0db[_0x5a2a41(0x22b)];console['log'](_0x15c0db[_0x5a2a41(0x22b)]);try{const _0x242125=await warehouse['aggregate']([{'$match':{'name':_0x275f5f,'room':_0x5cdc10}},{'$unwind':_0x5a2a41(0x1c8)},{'$match':{'product_details.bay':parseInt(_0x10e811)}},{'$group':{'_id':_0x5a2a41(0x1b4),'name':{'$first':_0x5a2a41(0x252)},'product_stock':{'$first':_0x5a2a41(0x1d1)},'bay':{'$first':_0x5a2a41(0x1ae)},'maxProducts':{'$first':_0x5a2a41(0x235)}}}]);_0xc71a18[_0x5a2a41(0x1b5)](0xc8)[_0x5a2a41(0x244)](_0x242125);}catch(_0x301733){_0xc71a18[_0x5a2a41(0x1b5)](0x194)[_0x5a2a41(0x244)]({'message':_0x301733[_0x5a2a41(0x1b9)]});}}),module[a0_0x3f1f8a(0x1ee)]=router;