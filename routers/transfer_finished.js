var a0_0x36621c=a0_0x1ac9;(function(_0x2ae98f,_0x6f5486){var _0xfcdcf=a0_0x1ac9,_0x4ace1d=_0x2ae98f();while(!![]){try{var _0x11cf83=parseInt(_0xfcdcf(0x152))/0x1*(parseInt(_0xfcdcf(0x1b9))/0x2)+-parseInt(_0xfcdcf(0x16f))/0x3*(parseInt(_0xfcdcf(0x1ca))/0x4)+parseInt(_0xfcdcf(0x1bf))/0x5+parseInt(_0xfcdcf(0x11b))/0x6*(parseInt(_0xfcdcf(0x1c5))/0x7)+-parseInt(_0xfcdcf(0x139))/0x8*(-parseInt(_0xfcdcf(0x147))/0x9)+-parseInt(_0xfcdcf(0x167))/0xa+parseInt(_0xfcdcf(0x18c))/0xb*(parseInt(_0xfcdcf(0x14a))/0xc);if(_0x11cf83===_0x6f5486)break;else _0x4ace1d['push'](_0x4ace1d['shift']());}catch(_0x24122d){_0x4ace1d['push'](_0x4ace1d['shift']());}}}(a0_0x5a47,0x6d613));const express=require(a0_0x36621c(0x185)),app=express(),router=express[a0_0x36621c(0x1ae)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x36621c(0x1a5)),nodemailer=require('nodemailer');function a0_0x1ac9(_0x4fc64e,_0x1873db){var _0x5a47bf=a0_0x5a47();return a0_0x1ac9=function(_0x1ac99c,_0x43e4ee){_0x1ac99c=_0x1ac99c-0x113;var _0x52c26b=_0x5a47bf[_0x1ac99c];return _0x52c26b;},a0_0x1ac9(_0x4fc64e,_0x1873db);}router[a0_0x36621c(0x1d7)]('/view',auth,async(_0x486a8e,_0x3d598e)=>{var _0x24bae7=a0_0x36621c;try{const {username:_0x2d5f81,email:_0x473b2c,role:_0xdc17de}=_0x486a8e[_0x24bae7(0x173)],_0x18d282=_0x486a8e[_0x24bae7(0x173)],_0x2964e5=await profile['findOne']({'email':_0x18d282[_0x24bae7(0x1e6)]}),_0x49f62d=await master_shop['find']();let _0x203a7c;if(_0x18d282['role']==_0x24bae7(0x199)){const _0x594428=await staff['findOne']({'email':_0x18d282[_0x24bae7(0x1e6)]});_0x203a7c=await transfers_finished[_0x24bae7(0x1ab)]({'from_warehouse':_0x594428[_0x24bae7(0x1e3)]});}else _0x203a7c=await transfers_finished[_0x24bae7(0x1db)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x24bae7(0x1c9)},'to_warehouse':{'$first':_0x24bae7(0x171)},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x24bae7(0x13d)},'finalize':{'$first':_0x24bae7(0x178)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x49f62d[0x0][_0x24bae7(0x1d9)]==_0x24bae7(0x136))var _0x29fa7b=users[_0x24bae7(0x168)];else{if(_0x49f62d[0x0][_0x24bae7(0x1d9)]==_0x24bae7(0x14c))var _0x29fa7b=users[_0x24bae7(0x14c)];else{if(_0x49f62d[0x0]['language']==_0x24bae7(0x19e))var _0x29fa7b=users[_0x24bae7(0x19e)];else{if(_0x49f62d[0x0][_0x24bae7(0x1d9)]==_0x24bae7(0x1ad))var _0x29fa7b=users[_0x24bae7(0x1ad)];else{if(_0x49f62d[0x0][_0x24bae7(0x1d9)]==_0x24bae7(0x1de))var _0x29fa7b=users[_0x24bae7(0x1de)];else{if(_0x49f62d[0x0]['language']==_0x24bae7(0x179))var _0x29fa7b=users[_0x24bae7(0x158)];else{if(_0x49f62d[0x0][_0x24bae7(0x1d9)]==_0x24bae7(0x1ea))var _0x29fa7b=users[_0x24bae7(0x1ea)];else{if(_0x49f62d[0x0][_0x24bae7(0x1d9)]==_0x24bae7(0x16c))var _0x29fa7b=users[_0x24bae7(0x177)];}}}}}}}_0x3d598e['render'](_0x24bae7(0x126),{'success':_0x486a8e[_0x24bae7(0x155)]('success'),'errors':_0x486a8e[_0x24bae7(0x155)](_0x24bae7(0x17f)),'role':_0x18d282,'profile':_0x2964e5,'master_shop':_0x49f62d,'transfer':_0x203a7c,'language':_0x29fa7b});}catch(_0x1161ea){console['log'](_0x1161ea);}});function a0_0x5a47(){var _0x227281=['from_quantity','length','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','184435vwAOpb','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','to_bay','sendMail','$product_details.bin','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','1078uQYxZC','/barcode_scanner2','unit','$product_details.batch_code','$from_warehouse','4SWAjss','$product_details.product_name','<span\x20style=\x22float:\x20right;\x22>','prod_name','invoice','role','then','$product_details._id','finalize','$product_details.expiry_date','password','maxPerUnit','split','get','<h2>\x20','language','$product_details.product_stock','aggregate','product','secondary_code','French','toString','/transfer/view','log','from_prod_qty','warehouse','logo','</span>','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','to_floorlevel','prod_cat','Chinese','$product_details','to_prod_qty','Enabled','catch','port','/preview/:id','back','$product_details.unit','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','to_room','156ecqcNq','product_details','</div>','Transfer\x20Edit\x20Successfully','to_prod_level','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','RoomAssigned','exports','to_invoice','$product_details.storage','edit_transfer_finished','transfer_finished','maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','product_stock','MaxStocks_data','/upload/','from_room','message','$product_details.production_date','status','</td>','getMonth','product_name','Finished\x20Goods','\x20</h2>','<h5>','English\x20(US)','$room','site_title','120dPdbNt','product_code3','QA\x20Warehouse','floor','$product.to_room_name','$product_details.isle','$name','</tr>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/view/:id','$product_details.maxProducts','success','to_room_name','forEach','205668MNnGat','$product_details.rack','Rack\x202','2222028GWufQm','to_warehouse','Hindi','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','Email\x20sent\x20successfully','from_bay','primary_code','</tbody>','1zyLekV','Enclosed','slice','flash','transfer_data','from_prod_level','Portuguese','padStart','/CheckingWarehouse','/barcode_scanner3','updateOne','to_quantity','FROZEN\x20GOODS','$product_details.secondary_code','DRY\x20GOODS','production_date','note','<html><head><title></title>','<tr>','getDate','ToRoomAssigned','5062400iowlkn','English','secondary_unit','map','<hr\x20class=\x22my-3\x22>','Arabic\x20(ae)','push','_id','2226165PNSUWc','/picking_list/PDF_transfer/','$to_warehouse','</head><body>','user','findOne','<strong>\x20Regards\x20</strong>','$product_details.primary_code','Arabic','$finalize','Portuguese\x20(BR)','date','Ambient','$product_details.floorlevel','TRFF-','$product_details.type','errors','concat','$product_details.invoice','<tbody\x20style=\x22text-align:\x20center;\x22>','redirect','edit_transfer_finished_view','express','product_date','<div>','An\x20error\x20occurred\x20while\x20saving\x20data.','/transfer_finished/view','$product_details.pallet','product_code','33RhkbCP','An\x20error\x20occurred.','string','all','post','/transfer_finished/preview/','$product_details.product_code','findById','Logo.png','Error\x20Occurs','save','/view/add_transfer','host','staff','True','from_warehouse','\x20Order\x20Date\x20:\x20','MaxStocks_data2','German','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','expiry_date','/barcode_scanner','json','body','filter','../public/language/languages.json','$product_details.level','from_invoice','random','from_room_name','bay','find','error','Spanish','Router','$product_details.secondary_unit','createTransport','</h5>','New_Qty_Converted','\x20Order\x20Number\x20:\x20','$product_details.bay','To_invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Rack\x201','1514272vuPRtN','image','params'];a0_0x5a47=function(){return _0x227281;};return a0_0x5a47();}async function getRandom8DigitNumber(){var _0x1712d0=a0_0x36621c;const _0x101e4a=0x989680,_0x4f1b31=0x5f5e0ff,_0x2e283d=Math[_0x1712d0(0x13c)](Math[_0x1712d0(0x1a8)]()*(_0x4f1b31-_0x101e4a+0x1))+_0x101e4a;var _0x38344a;const _0x12d790=await transfers_finished[_0x1712d0(0x174)]({'invoice':_0x1712d0(0x17d)+_0x2e283d});return _0x12d790&&_0x12d790[_0x1712d0(0x1bd)]>0x0?_0x38344a=_0x1712d0(0x17d)+_0x2e283d:_0x38344a=_0x1712d0(0x17d)+_0x2e283d,_0x38344a;}router[a0_0x36621c(0x1d7)](a0_0x36621c(0x197),auth,async(_0x2109aa,_0x5a89da)=>{var _0x57d461=a0_0x36621c;try{const {username:_0x2aff4e,email:_0x31c738,role:_0xd87090}=_0x2109aa[_0x57d461(0x173)],_0x264d9e=_0x2109aa[_0x57d461(0x173)],_0x4290ef=await profile[_0x57d461(0x174)]({'email':_0x264d9e[_0x57d461(0x1e6)]}),_0x16db93=await master_shop['find']();let _0x36d268;if(_0x264d9e[_0x57d461(0x1cf)]==_0x57d461(0x199)){const _0x4d83e2=await staff[_0x57d461(0x174)]({'email':_0x264d9e[_0x57d461(0x1e6)]});_0x36d268=await warehouse[_0x57d461(0x1db)]([{'$match':{'status':'Enabled','name':_0x4d83e2['warehouse'],'warehouse_category':_0x57d461(0x133),'name':{'$ne':_0x57d461(0x13b)}}},{'$group':{'_id':'$name','name':{'$first':_0x57d461(0x13f)}}}]);}else _0x36d268=await warehouse[_0x57d461(0x1db)]([{'$match':{'status':_0x57d461(0x1ed),'warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x57d461(0x13f),'name':{'$first':_0x57d461(0x13f)}}}]);const _0xcab1b7=await transfers_finished[_0x57d461(0x1ab)]({}),_0x3b14a3=_0xcab1b7[_0x57d461(0x1bd)]+0x1,_0x4b3c5b=_0x57d461(0x17d)+_0x3b14a3[_0x57d461(0x1df)]()[_0x57d461(0x159)](0x5,'0');if(_0x16db93[0x0][_0x57d461(0x1d9)]==_0x57d461(0x136))var _0x12fbcb=users[_0x57d461(0x168)];else{if(_0x16db93[0x0][_0x57d461(0x1d9)]==_0x57d461(0x14c))var _0x12fbcb=users['Hindi'];else{if(_0x16db93[0x0][_0x57d461(0x1d9)]==_0x57d461(0x19e))var _0x12fbcb=users[_0x57d461(0x19e)];else{if(_0x16db93[0x0][_0x57d461(0x1d9)]=='Spanish')var _0x12fbcb=users[_0x57d461(0x1ad)];else{if(_0x16db93[0x0]['language']==_0x57d461(0x1de))var _0x12fbcb=users[_0x57d461(0x1de)];else{if(_0x16db93[0x0][_0x57d461(0x1d9)]==_0x57d461(0x179))var _0x12fbcb=users[_0x57d461(0x158)];else{if(_0x16db93[0x0][_0x57d461(0x1d9)]==_0x57d461(0x1ea))var _0x12fbcb=users[_0x57d461(0x1ea)];else{if(_0x16db93[0x0][_0x57d461(0x1d9)]==_0x57d461(0x16c))var _0x12fbcb=users['Arabic'];}}}}}}}const _0x2d2e6c=getRandom8DigitNumber();_0x2d2e6c[_0x57d461(0x1d0)](_0x1304dd=>{var _0x5ab9d7=_0x57d461;_0x5a89da['render']('add_transfer_finished',{'success':_0x2109aa['flash']('success'),'errors':_0x2109aa[_0x5ab9d7(0x155)](_0x5ab9d7(0x17f)),'role':_0x264d9e,'profile':_0x4290ef,'master_shop':_0x16db93,'warehouse':_0x36d268,'language':_0x12fbcb,'invoice':_0x1304dd});})[_0x57d461(0x1ee)](_0x45ec12=>{var _0x25274a=_0x57d461;_0x2109aa[_0x25274a(0x155)](_0x25274a(0x17f),_0x25274a(0x1b6)),_0x5a89da['redirect'](_0x25274a(0x1e0));});}catch(_0x10bb14){console[_0x57d461(0x1e1)](_0x10bb14);}}),router[a0_0x36621c(0x190)]('/view/add_transfer',auth,async(_0x544e2d,_0x185a5b)=>{var _0x5b2fef=a0_0x36621c;try{const {date:_0x1dcaec,from_warehouse:_0x40510f,FromRoom_name:_0x4ee6e8,to_warehouse:_0xbf60a9,ToRoom_name:_0x528f78,prod_name:_0x5d5a64,from_prod_qty:_0x559c2c,from_prod_level:_0x3528c8,from_prod_isle:_0x44e4a4,from_prod_pallet:_0x120c1f,to_prod_qty:_0x2e5a4e,to_prod_level:_0x2c2db6,to_prod_isle:_0x5268f3,to_prod_pallet:_0x14ff9e,primary_code:_0x3d5222,secondary_code:_0x91e7f2,product_code3:_0x1e4487,note:_0x4d394e,MaxStocks_data2:_0xdd6510,invoice:_0x39bd20,expiry_date:_0x47727d}=_0x544e2d[_0x5b2fef(0x1a3)];if(typeof _0x5d5a64==_0x5b2fef(0x18e))var _0x411e68=[_0x544e2d['body']['prod_name']],_0x1e2ead=[_0x544e2d['body'][_0x5b2fef(0x1e2)]],_0x378bf6=[_0x544e2d['body'][_0x5b2fef(0x157)]],_0x501056=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x1b2)]],_0x1f4a6d=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x11f)]],_0x33b58f=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x150)]],_0xad64c=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x1dd)]],_0x42e32d=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x13a)]],_0x3bd36a=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x19d)]],_0x26bd52=[_0x544e2d[_0x5b2fef(0x1a3)]['primary_unit']],_0x33b503=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x169)]],_0x1236cd=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x117)]],_0x1d7503=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x1a0)]],_0x3a6b41=[_0x544e2d[_0x5b2fef(0x1a3)]['product_date']],_0x2c6d18=[_0x544e2d['body'][_0x5b2fef(0x12a)]],_0x12d39b=[_0x544e2d['body']['maxPerUnit']],_0x4aacff=[_0x544e2d['body']['prod_cat']],_0x60fded=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x121)]],_0x3726e7=[_0x544e2d['body'][_0x5b2fef(0x166)]],_0x34f0b7=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x1a7)]],_0x596b89=[_0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x123)]];else var _0x411e68=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x1cd)]],_0x1e2ead=[..._0x544e2d['body'][_0x5b2fef(0x1e2)]],_0x378bf6=[..._0x544e2d[_0x5b2fef(0x1a3)]['from_prod_level']],_0x501056=[..._0x544e2d['body'][_0x5b2fef(0x1b2)]],_0x1f4a6d=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x11f)]],_0x33b58f=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x150)]],_0xad64c=[..._0x544e2d['body'][_0x5b2fef(0x1dd)]],_0x42e32d=[..._0x544e2d['body'][_0x5b2fef(0x13a)]],_0x3bd36a=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x19d)]],_0x26bd52=[..._0x544e2d[_0x5b2fef(0x1a3)]['primary_unit']],_0x33b503=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x169)]],_0x1236cd=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x117)]],_0x1d7503=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x1a0)]],_0x3a6b41=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x186)]],_0x2c6d18=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x12a)]],_0x12d39b=[..._0x544e2d['body']['maxPerUnit']],_0x4aacff=[..._0x544e2d['body'][_0x5b2fef(0x1e9)]],_0x60fded=[..._0x544e2d['body'][_0x5b2fef(0x121)]],_0x3726e7=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x166)]],_0x34f0b7=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x1a7)]],_0x596b89=[..._0x544e2d[_0x5b2fef(0x1a3)][_0x5b2fef(0x123)]];const _0x58a18b=_0x411e68[_0x5b2fef(0x16a)](_0x3b4fd6=>{return _0x3b4fd6={'product_name':_0x3b4fd6};});_0x1e2ead[_0x5b2fef(0x146)]((_0x55c150,_0x7eac4d)=>{var _0x17ecb6=_0x5b2fef;_0x58a18b[_0x7eac4d][_0x17ecb6(0x1bc)]=_0x55c150;}),_0x378bf6['forEach']((_0x233365,_0x4b9b05)=>{var _0x25566f=_0x5b2fef;_0x58a18b[_0x4b9b05][_0x25566f(0x14f)]=_0x233365;}),_0x34f0b7['forEach']((_0x41eb57,_0x20d164)=>{var _0x137a07=_0x5b2fef;_0x58a18b[_0x20d164][_0x137a07(0x1a7)]=_0x41eb57;}),_0x596b89[_0x5b2fef(0x146)]((_0x368aeb,_0x3ccae1)=>{var _0x32acc7=_0x5b2fef;_0x58a18b[_0x3ccae1][_0x32acc7(0x1b5)]=_0x368aeb;}),_0x501056[_0x5b2fef(0x146)]((_0x30c4f2,_0x4658f1)=>{var _0x471782=_0x5b2fef;_0x58a18b[_0x4658f1][_0x471782(0x15d)]=_0x30c4f2;}),_0x1f4a6d[_0x5b2fef(0x146)]((_0x2b78aa,_0x39f54f)=>{var _0x48e32f=_0x5b2fef;_0x58a18b[_0x39f54f][_0x48e32f(0x1c1)]=_0x2b78aa;}),_0x33b58f[_0x5b2fef(0x146)]((_0x4d474d,_0x19400f)=>{var _0x72e53f=_0x5b2fef;_0x58a18b[_0x19400f][_0x72e53f(0x150)]=_0x4d474d;}),_0xad64c['forEach']((_0x3c4329,_0x13defc)=>{var _0x4318a0=_0x5b2fef;_0x58a18b[_0x13defc][_0x4318a0(0x1dd)]=_0x3c4329;}),_0x42e32d[_0x5b2fef(0x146)]((_0x44081f,_0x216709)=>{var _0x3e820f=_0x5b2fef;_0x58a18b[_0x216709][_0x3e820f(0x18b)]=_0x44081f;}),_0x3bd36a[_0x5b2fef(0x146)]((_0xb12509,_0x453f73)=>{_0x58a18b[_0x453f73]['maxProducts']=_0xb12509;}),_0x26bd52[_0x5b2fef(0x146)]((_0x8f9f80,_0x244dd0)=>{var _0x5c37fe=_0x5b2fef;_0x58a18b[_0x244dd0][_0x5c37fe(0x1c7)]=_0x8f9f80;}),_0x33b503[_0x5b2fef(0x146)]((_0x10d49a,_0x531ec9)=>{var _0x3af2ca=_0x5b2fef;_0x58a18b[_0x531ec9][_0x3af2ca(0x169)]=_0x10d49a;}),_0x1236cd[_0x5b2fef(0x146)]((_0x38f04b,_0x5409f0)=>{_0x58a18b[_0x5409f0]['batch_code']=_0x38f04b;}),_0x1d7503[_0x5b2fef(0x146)]((_0x56cc65,_0x1aa804)=>{_0x58a18b[_0x1aa804]['expiry_date']=_0x56cc65;}),_0x3a6b41[_0x5b2fef(0x146)]((_0x5bdb39,_0x3fe69c)=>{var _0x4e93f7=_0x5b2fef;_0x58a18b[_0x3fe69c][_0x4e93f7(0x161)]=_0x5bdb39;}),_0x2c6d18[_0x5b2fef(0x146)]((_0x5ed34a,_0x45a285)=>{_0x58a18b[_0x45a285]['maxProducts']=_0x5ed34a;}),_0x12d39b[_0x5b2fef(0x146)]((_0xa0d069,_0x436bc7)=>{_0x58a18b[_0x436bc7]['maxPerUnit']=_0xa0d069;}),_0x4aacff[_0x5b2fef(0x146)]((_0x1faee2,_0xd0171d)=>{var _0x3dc2db=_0x5b2fef;_0x58a18b[_0xd0171d][_0x3dc2db(0x1e9)]=_0x1faee2;}),_0x60fded['forEach']((_0x5c17a1,_0x3b72f4)=>{var _0x42df9c=_0x5b2fef;_0x58a18b[_0x3b72f4][_0x42df9c(0x1a9)]=_0x5c17a1;}),_0x3726e7['forEach']((_0x19671f,_0x325bf7)=>{_0x58a18b[_0x325bf7]['to_room_name']=_0x19671f;});const _0x47a22d=_0x58a18b[_0x5b2fef(0x1a4)](_0x4fd311=>_0x4fd311[_0x5b2fef(0x15d)]!=='0'&&_0x4fd311['to_quantity']!==''||_0x4fd311['to_floorlevel']!=='0'&&_0x4fd311[_0x5b2fef(0x1e8)]!=='');var _0x1d6005=0x0;_0x47a22d['forEach'](_0x57e8bd=>{var _0x394e39=_0x5b2fef;parseInt(_0x57e8bd[_0x394e39(0x1bc)])<parseInt(_0x57e8bd[_0x394e39(0x15d)])&&_0x1d6005++;});if(_0x1d6005!=0x0)return _0x544e2d[_0x5b2fef(0x155)](_0x5b2fef(0x17f),_0x5b2fef(0x1c4)),_0x185a5b[_0x5b2fef(0x183)](_0x5b2fef(0x115));const _0x3db4e0=new transfers_finished({'date':_0x1dcaec,'from_warehouse':_0x40510f,'to_warehouse':_0xbf60a9,'product':_0x47a22d,'note':_0x4d394e,'invoice':_0x39bd20}),_0x1c6d66=await _0x3db4e0[_0x5b2fef(0x196)]();_0x544e2d[_0x5b2fef(0x155)]('success','Product\x20Transfer\x20successfully'),_0x185a5b[_0x5b2fef(0x183)](_0x5b2fef(0x191)+_0x1c6d66[_0x5b2fef(0x16e)]);}catch(_0x20d2f8){console[_0x5b2fef(0x1e1)](_0x20d2f8),_0x185a5b[_0x5b2fef(0x12f)](0xc8)[_0x5b2fef(0x1a2)]({'errorMessage':_0x20d2f8[_0x5b2fef(0x12d)]});}}),router[a0_0x36621c(0x1d7)](a0_0x36621c(0x114),auth,async(_0x3c1ca5,_0x455dfd)=>{var _0x1d12ee=a0_0x36621c;try{const {username:_0x10ff73,email:_0x3a3bd8,role:_0x4a222a}=_0x3c1ca5[_0x1d12ee(0x173)],_0x268d16=_0x3c1ca5[_0x1d12ee(0x173)],_0x5bbaf2=await profile[_0x1d12ee(0x174)]({'email':_0x268d16[_0x1d12ee(0x1e6)]}),_0x34b837=await master_shop[_0x1d12ee(0x1ab)](),_0x401af0=await transfers_finished[_0x1d12ee(0x193)](_0x3c1ca5['params']['id']);let _0x4b9d1e;if(_0x268d16[_0x1d12ee(0x1cf)]==_0x1d12ee(0x199)){const _0x2a05f6=await staff[_0x1d12ee(0x174)]({'email':_0x268d16[_0x1d12ee(0x1e6)]});_0x4b9d1e=await warehouse[_0x1d12ee(0x1ab)]({'status':_0x1d12ee(0x1ed),'name':_0x2a05f6[_0x1d12ee(0x1e3)],'warehouse_category':_0x1d12ee(0x133)});}else _0x4b9d1e=await warehouse[_0x1d12ee(0x1ab)]({'status':_0x1d12ee(0x1ed),'warehouse_category':_0x1d12ee(0x133)});const _0xe99ba3=await warehouse[_0x1d12ee(0x1db)]([{'$match':{'name':_0x401af0[_0x1d12ee(0x19b)],'warehouse_category':_0x1d12ee(0x133)}},{'$unwind':_0x1d12ee(0x1eb)},{'$group':{'_id':_0x1d12ee(0x1d1),'name':{'$first':_0x1d12ee(0x1cb)},'product_stock':{'$first':_0x1d12ee(0x1da)},'bay':{'$first':_0x1d12ee(0x1b4)},'bin':{'$first':_0x1d12ee(0x1c3)},'type':{'$first':_0x1d12ee(0x17e)},'floorlevel':{'$first':_0x1d12ee(0x17c)},'primary_code':{'$first':_0x1d12ee(0x176)},'secondary_code':{'$first':_0x1d12ee(0x15f)},'product_code':{'$first':_0x1d12ee(0x192)},'storage':{'$first':_0x1d12ee(0x124)},'rack':{'$first':_0x1d12ee(0x148)},'expiry_date':{'$first':_0x1d12ee(0x1d3)},'production_date':{'$first':_0x1d12ee(0x12e)},'room':{'$first':_0x1d12ee(0x137)},'warehoue_name':{'$first':_0x1d12ee(0x13f)}}}]),_0x3d7067=await product['find']({});if(_0x34b837[0x0][_0x1d12ee(0x1d9)]==_0x1d12ee(0x136)){var _0x2ab757=users['English'];console[_0x1d12ee(0x1e1)](_0x2ab757);}else{if(_0x34b837[0x0][_0x1d12ee(0x1d9)]==_0x1d12ee(0x14c))var _0x2ab757=users['Hindi'];else{if(_0x34b837[0x0]['language']==_0x1d12ee(0x19e))var _0x2ab757=users['German'];else{if(_0x34b837[0x0][_0x1d12ee(0x1d9)]=='Spanish')var _0x2ab757=users[_0x1d12ee(0x1ad)];else{if(_0x34b837[0x0][_0x1d12ee(0x1d9)]==_0x1d12ee(0x1de))var _0x2ab757=users[_0x1d12ee(0x1de)];else{if(_0x34b837[0x0][_0x1d12ee(0x1d9)]==_0x1d12ee(0x179))var _0x2ab757=users[_0x1d12ee(0x158)];else{if(_0x34b837[0x0][_0x1d12ee(0x1d9)]==_0x1d12ee(0x1ea))var _0x2ab757=users['Chinese'];else{if(_0x34b837[0x0][_0x1d12ee(0x1d9)]==_0x1d12ee(0x16c))var _0x2ab757=users['Arabic'];}}}}}}}_0x455dfd['render'](_0x1d12ee(0x184),{'success':_0x3c1ca5[_0x1d12ee(0x155)]('success'),'errors':_0x3c1ca5[_0x1d12ee(0x155)](_0x1d12ee(0x17f)),'role':_0x268d16,'profile':_0x5bbaf2,'master_shop':_0x34b837,'warehouse':_0x4b9d1e,'transfer':_0x401af0,'stock':_0xe99ba3,'unit':_0x3d7067,'language':_0x2ab757});}catch(_0x259083){console[_0x1d12ee(0x1e1)](_0x259083);}}),router[a0_0x36621c(0x190)](a0_0x36621c(0x114),auth,async(_0x232623,_0x767f80)=>{var _0x593965=a0_0x36621c;try{const {invoice:_0x122564,from_warehouse:_0x4de05f,FromRoom_name:_0x2646a9,to_warehouse:_0x4c282b,ToRoom_name:_0x436b5d}=_0x232623[_0x593965(0x1a3)],_0x36672d=await transfers_finished['findById'](_0x232623[_0x593965(0x1bb)]['id']),_0x3a6786=_0x36672d[_0x593965(0x1dc)]['map'](async _0x31657a=>{var _0x4ed857=_0x593965;if(_0x31657a[_0x4ed857(0x15d)]>0x0){var _0x4ad48e=await warehouse['findOne']({'name':_0x4de05f,'room':_0x31657a['from_room_name'],'warehouse_category':'Finished\x20Goods'});const _0x18430e=_0x4ad48e['product_details'][_0x4ed857(0x16a)](_0x367151=>{var _0x86cc6b=_0x4ed857;_0x367151[_0x86cc6b(0x132)]==_0x31657a[_0x86cc6b(0x132)]&&_0x367151['bay']==_0x31657a['from_bay']&&_0x367151[_0x86cc6b(0x1a0)]==_0x31657a[_0x86cc6b(0x1a0)]&&_0x367151['production_date']==_0x31657a[_0x86cc6b(0x161)]&&_0x367151[_0x86cc6b(0x117)]==_0x31657a['batch_code']&&_0x367151[_0x86cc6b(0x1ce)]==_0x31657a[_0x86cc6b(0x1a7)]&&(_0x367151['product_stock']=_0x367151[_0x86cc6b(0x129)]-_0x31657a[_0x86cc6b(0x15d)]);});}return _0x4ad48e;});Promise[_0x593965(0x18f)](_0x3a6786)[_0x593965(0x1d0)](async _0x332882=>{var _0x8bf04d=_0x593965;try{for(const _0x1b3c51 of _0x332882){await _0x1b3c51[_0x8bf04d(0x196)]();}const _0x5e7910=_0x36672d['product'][_0x8bf04d(0x16a)](async _0x405399=>{var _0x1f0155=_0x8bf04d,_0xc04e39=await warehouse[_0x1f0155(0x174)]({'name':_0x4c282b,'room':_0x405399[_0x1f0155(0x145)]});if(_0x405399['to_quantity']>0x0){var _0x220ded=0x0;const _0x16d35c=_0xc04e39[_0x1f0155(0x11c)]['map'](_0x1cf97f=>{var _0x4e1e68=_0x1f0155;_0x1cf97f[_0x4e1e68(0x132)]==_0x405399['product_name']&&_0x1cf97f['bay']==_0x405399[_0x4e1e68(0x1c1)]&&_0x1cf97f[_0x4e1e68(0x1a0)]==_0x405399[_0x4e1e68(0x1a0)]&&_0x1cf97f[_0x4e1e68(0x161)]==_0x405399[_0x4e1e68(0x161)]&&_0x1cf97f[_0x4e1e68(0x117)]==_0x405399[_0x4e1e68(0x117)]&&_0x1cf97f['invoice']==_0x405399['To_invoice']&&(_0x1cf97f[_0x4e1e68(0x129)]=_0x1cf97f['product_stock']+_0x405399[_0x4e1e68(0x15d)],_0x220ded++);});_0x220ded=='0'&&(_0xc04e39[_0x1f0155(0x11c)]=_0xc04e39[_0x1f0155(0x11c)][_0x1f0155(0x180)]({'product_name':_0x405399[_0x1f0155(0x132)],'product_stock':_0x405399[_0x1f0155(0x15d)],'bay':_0x405399['to_bay'],'product_code':_0x405399[_0x1f0155(0x18b)],'primary_code':_0x405399[_0x1f0155(0x150)],'secondary_code':_0x405399[_0x1f0155(0x1dd)],'expiry_date':_0x405399[_0x1f0155(0x1a0)],'production_date':_0x405399[_0x1f0155(0x161)],'maxProducts':_0x405399[_0x1f0155(0x127)],'batch_code':_0x405399[_0x1f0155(0x117)],'secondary_unit':_0x405399[_0x1f0155(0x169)],'unit':_0x405399[_0x1f0155(0x1c7)],'maxProducts':_0x405399[_0x1f0155(0x127)],'maxPerUnit':_0x405399[_0x1f0155(0x1d5)],'invoice':_0x405399[_0x1f0155(0x1b5)]}));}return _0xc04e39;});Promise[_0x8bf04d(0x18f)](_0x5e7910)[_0x8bf04d(0x1d0)](async _0x33215a=>{var _0x2f0d11=_0x8bf04d;try{for(const _0x529b4c of _0x33215a){await warehouse[_0x2f0d11(0x15c)]({'_id':_0x529b4c[_0x2f0d11(0x16e)]},{'$addToSet':{'product_details':{'$each':_0x529b4c[_0x2f0d11(0x11c)]}}});}_0x36672d[_0x2f0d11(0x1d2)]=_0x2f0d11(0x19a);const _0x5d4702=await _0x36672d[_0x2f0d11(0x196)](),_0x26d21c=await master_shop['find'](),_0x45e4c0=await email_settings['findOne'](),_0x503399=await supervisor_settings[_0x2f0d11(0x1ab)]();var _0x4d1f3e=_0x36672d['product'],_0x36e034='',_0x486f5b;for(_0x486f5b in _0x4d1f3e){var _0x8527f4='FG';_0x36672d[_0x2f0d11(0x14b)]==_0x2f0d11(0x160)&&(_0x8527f4='DG'),_0x36e034+=_0x2f0d11(0x164)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4d1f3e[_0x486f5b][_0x2f0d11(0x132)]+_0x2f0d11(0x130)+_0x2f0d11(0x119)+_0x4d1f3e[_0x486f5b][_0x2f0d11(0x18b)]+_0x2f0d11(0x130)+_0x2f0d11(0x119)+_0x4d1f3e[_0x486f5b][_0x2f0d11(0x15d)]+_0x2f0d11(0x130)+_0x2f0d11(0x119)+_0x4d1f3e[_0x486f5b][_0x2f0d11(0x1c7)]+_0x2f0d11(0x130)+_0x2f0d11(0x119)+_0x4d1f3e[_0x486f5b]['secondary_unit']+'</td>'+_0x2f0d11(0x119)+_0x36672d[_0x2f0d11(0x14b)]+_0x2f0d11(0x130)+_0x2f0d11(0x119)+_0x4d1f3e[_0x486f5b]['to_room_name']+_0x2f0d11(0x130)+_0x2f0d11(0x119)+_0x8527f4+_0x4d1f3e[_0x486f5b][_0x2f0d11(0x1c1)]+_0x2f0d11(0x130)+_0x2f0d11(0x140);}let _0x448ada=nodemailer[_0x2f0d11(0x1b0)]({'host':_0x45e4c0[_0x2f0d11(0x198)],'port':Number(_0x45e4c0[_0x2f0d11(0x113)]),'secure':![],'auth':{'user':_0x45e4c0[_0x2f0d11(0x1e6)],'pass':_0x45e4c0[_0x2f0d11(0x1d4)]}}),_0x14e4ca={'from':_0x45e4c0[_0x2f0d11(0x1e6)],'to':_0x503399[0x0]['FGSEmail'],'subject':'Transfer\x20Mail','attachments':[{'filename':_0x2f0d11(0x194),'path':__dirname+'/../public'+_0x2f0d11(0x12b)+_0x26d21c[0x0][_0x2f0d11(0x1ba)],'cid':_0x2f0d11(0x1e4)}],'html':'<!DOCTYPE\x20html>'+_0x2f0d11(0x163)+_0x2f0d11(0x172)+_0x2f0d11(0x187)+_0x2f0d11(0x141)+_0x2f0d11(0x187)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2f0d11(0x11d)+_0x2f0d11(0x187)+_0x2f0d11(0x1d8)+_0x26d21c[0x0][_0x2f0d11(0x138)]+_0x2f0d11(0x134)+_0x2f0d11(0x11d)+_0x2f0d11(0x11d)+_0x2f0d11(0x16b)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x2f0d11(0x1b3)+_0x36672d[_0x2f0d11(0x1ce)]+'\x20'+_0x2f0d11(0x1cc)+_0x2f0d11(0x19c)+_0x36672d['date']+'\x20'+_0x2f0d11(0x1e5)+_0x2f0d11(0x1b1)+_0x2f0d11(0x11d)+_0x2f0d11(0x1b7)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x2f0d11(0x19f)+_0x2f0d11(0x1e7)+_0x2f0d11(0x1be)+_0x2f0d11(0x1c0)+_0x2f0d11(0x118)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x2f0d11(0x128)+_0x2f0d11(0x120)+'</tr>'+'</thead>'+_0x2f0d11(0x182)+'\x20'+_0x36e034+'\x20'+_0x2f0d11(0x151)+'</table>'+_0x2f0d11(0x187)+_0x2f0d11(0x175)+_0x2f0d11(0x135)+_0x26d21c[0x0][_0x2f0d11(0x138)]+_0x2f0d11(0x1b1)+_0x2f0d11(0x11d)+'</div>'+'</body></html>'};_0x448ada[_0x2f0d11(0x1c2)](_0x14e4ca,function(_0x1db260,_0x3173a6){var _0xa4201=_0x2f0d11;_0x1db260?(console[_0xa4201(0x1e1)](_0x1db260),console['log'](_0xa4201(0x195))):console['log'](_0xa4201(0x14e));}),_0x232623['flash'](_0x2f0d11(0x144),'Transfer\x20Finalize\x20Successfully'),_0x767f80[_0x2f0d11(0x183)](_0x2f0d11(0x170)+_0x5d4702['_id']);}catch(_0x5ce398){console[_0x2f0d11(0x1ac)](_0x5ce398),_0x767f80[_0x2f0d11(0x12f)](0x1f4)[_0x2f0d11(0x1a2)]({'error':_0x2f0d11(0x14d)});}})[_0x8bf04d(0x1ee)](_0x427615=>{var _0x2f1301=_0x8bf04d;console[_0x2f1301(0x1ac)](_0x427615),_0x767f80[_0x2f1301(0x12f)](0x1f4)[_0x2f1301(0x1a2)]({'error':_0x2f1301(0x18d)});});}catch(_0x529ef3){console[_0x8bf04d(0x1ac)](_0x529ef3),_0x767f80[_0x8bf04d(0x12f)](0x1f4)[_0x8bf04d(0x1a2)]({'error':_0x8bf04d(0x188)});}})[_0x593965(0x1ee)](_0x52f837=>{var _0xcb3a6d=_0x593965;console['error'](_0x52f837),_0x767f80['status'](0x1f4)[_0xcb3a6d(0x1a2)]({'error':_0xcb3a6d(0x18d)});});}catch(_0x53d9e2){_0x767f80[_0x593965(0x1a2)]({'message':_0x53d9e2[_0x593965(0x12d)]});}});function BayBinSelected(_0x14edae,_0x336880){var _0x457029=a0_0x36621c,_0x20fed6=[];let _0x260199=[];var _0x19c304=[];if(_0x14edae=='DRY\x20GOODS'){switch(_0x336880){case _0x457029(0x1b8):_0x20fed6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x457029(0x149):_0x20fed6=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x19c304=['DG'];}else{if(_0x14edae==_0x457029(0x15e)){switch(_0x336880){case _0x457029(0x1b8):_0x20fed6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x457029(0x149):_0x20fed6=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x19c304=['FG'];}}return{'levels':_0x20fed6,'identify':_0x19c304};}router[a0_0x36621c(0x1d7)](a0_0x36621c(0x142),auth,async(_0xa6bfd2,_0x2cc5fb)=>{var _0xe1d998=a0_0x36621c;try{const {username:_0x30700a,email:_0x36a4b1,role:_0x350958}=_0xa6bfd2[_0xe1d998(0x173)],_0x595163=_0xa6bfd2[_0xe1d998(0x173)],_0xac4276=await profile[_0xe1d998(0x174)]({'email':_0x595163[_0xe1d998(0x1e6)]}),_0x521db2=await master_shop[_0xe1d998(0x1ab)](),_0x4b74a4=await transfers_finished['findById'](_0xa6bfd2['params']['id']);let _0x27a544=new Date(_0x4b74a4['expiry_date']),_0xf1df71=('0'+_0x27a544[_0xe1d998(0x165)]())['slice'](-0x2),_0x1e727a=('0'+(_0x27a544[_0xe1d998(0x131)]()+0x1))[_0xe1d998(0x154)](-0x2),_0x760e04=_0x27a544['getFullYear'](),_0x44905c=_0x760e04+'-'+_0x1e727a+'-'+_0xf1df71,_0x59acf6;if(_0x595163[_0xe1d998(0x1cf)]=='staff'){const _0x30817f=await staff[_0xe1d998(0x174)]({'email':_0x595163[_0xe1d998(0x1e6)]});_0x59acf6=await warehouse[_0xe1d998(0x1ab)]({'status':_0xe1d998(0x1ed),'name':_0x30817f['warehouse'],'warehouse_category':_0xe1d998(0x133)});}else _0x59acf6=await warehouse[_0xe1d998(0x1ab)]({'status':'Enabled','warehouse_category':_0xe1d998(0x133)});const _0x56b786=await warehouse[_0xe1d998(0x1db)]([{'$match':{'name':_0x4b74a4[_0xe1d998(0x19b)],'room':_0x4b74a4[_0xe1d998(0x12c)]}},{'$unwind':_0xe1d998(0x1eb)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xe1d998(0x1da)},'bay':{'$first':_0xe1d998(0x1b4)},'bin':{'$first':_0xe1d998(0x1c3)},'type':{'$first':_0xe1d998(0x17e)},'floorlevel':{'$first':_0xe1d998(0x17c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0xe1d998(0x124)},'rack':{'$first':_0xe1d998(0x148)}}}]);var _0xa31bb5=[0x1,0x2,0x3,0x4],_0x30595d=['A','B','C','D','E','F','G','H','I','J'],_0x4ee2b8=[_0xe1d998(0x17b),_0xe1d998(0x153)];const _0x28edac=await product[_0xe1d998(0x1ab)]({}),_0x44384d=BayBinSelected(_0x4b74a4['to_warehouse'],_0x4b74a4['to_room']);if(_0x521db2[0x0][_0xe1d998(0x1d9)]==_0xe1d998(0x136)){var _0x8ad8a9=users[_0xe1d998(0x168)];console[_0xe1d998(0x1e1)](_0x8ad8a9);}else{if(_0x521db2[0x0]['language']==_0xe1d998(0x14c))var _0x8ad8a9=users[_0xe1d998(0x14c)];else{if(_0x521db2[0x0][_0xe1d998(0x1d9)]==_0xe1d998(0x19e))var _0x8ad8a9=users[_0xe1d998(0x19e)];else{if(_0x521db2[0x0]['language']==_0xe1d998(0x1ad))var _0x8ad8a9=users[_0xe1d998(0x1ad)];else{if(_0x521db2[0x0][_0xe1d998(0x1d9)]=='French')var _0x8ad8a9=users[_0xe1d998(0x1de)];else{if(_0x521db2[0x0][_0xe1d998(0x1d9)]==_0xe1d998(0x179))var _0x8ad8a9=users[_0xe1d998(0x158)];else{if(_0x521db2[0x0][_0xe1d998(0x1d9)]==_0xe1d998(0x1ea))var _0x8ad8a9=users[_0xe1d998(0x1ea)];else{if(_0x521db2[0x0][_0xe1d998(0x1d9)]==_0xe1d998(0x16c))var _0x8ad8a9=users['Arabic'];}}}}}}}_0x2cc5fb['render'](_0xe1d998(0x125),{'success':_0xa6bfd2[_0xe1d998(0x155)](_0xe1d998(0x144)),'errors':_0xa6bfd2['flash'](_0xe1d998(0x17f)),'role':_0x595163,'profile':_0xac4276,'master_shop':_0x521db2,'warehouse':_0x59acf6,'transfer':_0x4b74a4,'stock':_0x56b786,'unit':_0x28edac,'language':_0x8ad8a9,'levels':_0xa31bb5,'Isle':_0x30595d,'rooms_data':_0x4ee2b8,'ed_fullDate':_0x44905c,'dataSelected':_0x44384d});}catch(_0x175179){console[_0xe1d998(0x1e1)](_0x175179);}}),router[a0_0x36621c(0x190)](a0_0x36621c(0x142),auth,async(_0xfee9f2,_0x2b38e5)=>{var _0x4cfbd9=a0_0x36621c;try{const _0x50dad5=_0xfee9f2['params']['id'];console[_0x4cfbd9(0x1e1)](_0xfee9f2[_0x4cfbd9(0x1a3)]);const _0x322c33=await transfers_finished[_0x4cfbd9(0x193)](_0x50dad5);console[_0x4cfbd9(0x1e1)](_0x4cfbd9(0x156),_0x322c33);const {date:_0x1bac2e,from_warehouse:_0x54126a,FromRoom_name:_0x1277f2,to_warehouse:_0x218c38,ToRoom_name:_0x1ba977,prod_name:_0x546dff,from_prod_qty:_0x2f9bc2,from_prod_level:_0x144c30,from_prod_isle:_0xa8d8cf,from_prod_pallet:_0x5c867b,to_prod_qty:_0x397886,to_prod_level:_0x311cee,to_prod_isle:_0x2c9137,to_prod_pallet:_0x570d80,primary_code:_0x40d75e,secondary_code:_0x419229,product_code3:_0xd6b271,note:_0x92b323,invoice:_0x123bce,expiry_date:_0xb0682f}=_0xfee9f2['body'];if(typeof _0x546dff==_0x4cfbd9(0x18e))var _0x536aa6=[_0xfee9f2[_0x4cfbd9(0x1a3)]['prod_name']],_0xeb3b98=[_0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x1e2)]],_0x9b604c=[_0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x157)]],_0x391fd7=[_0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x1ec)]],_0x454e7c=[_0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x11f)]],_0x2d0b10=[_0xfee9f2['body'][_0x4cfbd9(0x150)]],_0x49ca72=[_0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x1dd)]],_0x17822f=[_0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x13a)]],_0x7edeac=[_0xfee9f2['body']['MaxStocks_data2']],_0x12ad65=[_0xfee9f2[_0x4cfbd9(0x1a3)]['unit']],_0x39b700=[_0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x169)]],_0x42bcd8=[_0xfee9f2['body']['batch_code']],_0x23893e=[_0xfee9f2['body'][_0x4cfbd9(0x1a0)]];else var _0x536aa6=[..._0xfee9f2['body'][_0x4cfbd9(0x1cd)]],_0xeb3b98=[..._0xfee9f2[_0x4cfbd9(0x1a3)]['from_prod_qty']],_0x9b604c=[..._0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x157)]],_0x391fd7=[..._0xfee9f2['body']['to_prod_qty']],_0x454e7c=[..._0xfee9f2['body'][_0x4cfbd9(0x11f)]],_0x2d0b10=[..._0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x150)]],_0x49ca72=[..._0xfee9f2[_0x4cfbd9(0x1a3)]['secondary_code']],_0x17822f=[..._0xfee9f2['body'][_0x4cfbd9(0x13a)]],_0x7edeac=[..._0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x19d)]],_0x12ad65=[..._0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x1c7)]],_0x39b700=[..._0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x169)]],_0x42bcd8=[..._0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x117)]],_0x23893e=[..._0xfee9f2[_0x4cfbd9(0x1a3)][_0x4cfbd9(0x1a0)]];const _0x7c40eb=_0x536aa6[_0x4cfbd9(0x16a)](_0x5d3627=>{return _0x5d3627={'product_name':_0x5d3627};});_0xeb3b98['forEach']((_0x41de77,_0x3ab719)=>{var _0x68b25d=_0x4cfbd9;_0x7c40eb[_0x3ab719][_0x68b25d(0x1bc)]=_0x41de77;}),_0x9b604c[_0x4cfbd9(0x146)]((_0x173d7c,_0x2f7b0a)=>{var _0x4a0ecc=_0x4cfbd9;_0x7c40eb[_0x2f7b0a][_0x4a0ecc(0x14f)]=_0x173d7c;}),_0x391fd7['forEach']((_0x10bdf2,_0x51c1fc)=>{var _0x343220=_0x4cfbd9;_0x7c40eb[_0x51c1fc][_0x343220(0x15d)]=_0x10bdf2;}),_0x454e7c[_0x4cfbd9(0x146)]((_0x1910ed,_0x1d145b)=>{var _0x24f10c=_0x4cfbd9;_0x7c40eb[_0x1d145b][_0x24f10c(0x1c1)]=_0x1910ed;}),_0x2d0b10[_0x4cfbd9(0x146)]((_0x5c0a57,_0x50bb9f)=>{var _0x710835=_0x4cfbd9;_0x7c40eb[_0x50bb9f][_0x710835(0x150)]=_0x5c0a57;}),_0x49ca72[_0x4cfbd9(0x146)]((_0x7562ae,_0x5d0596)=>{_0x7c40eb[_0x5d0596]['secondary_code']=_0x7562ae;}),_0x17822f[_0x4cfbd9(0x146)]((_0x50e48e,_0x2b0f7c)=>{var _0xe56876=_0x4cfbd9;_0x7c40eb[_0x2b0f7c][_0xe56876(0x18b)]=_0x50e48e;}),_0x7edeac['forEach']((_0xfed279,_0x1aab2e)=>{var _0x3067f8=_0x4cfbd9;_0x7c40eb[_0x1aab2e][_0x3067f8(0x127)]=_0xfed279;}),_0x12ad65[_0x4cfbd9(0x146)]((_0x39f34d,_0x27ac1e)=>{_0x7c40eb[_0x27ac1e]['unit']=_0x39f34d;}),_0x39b700[_0x4cfbd9(0x146)]((_0x385989,_0x2dff00)=>{_0x7c40eb[_0x2dff00]['secondary_unit']=_0x385989;}),_0x42bcd8[_0x4cfbd9(0x146)]((_0x239fd6,_0x50e42d)=>{var _0x482b3e=_0x4cfbd9;_0x7c40eb[_0x50e42d][_0x482b3e(0x117)]=_0x239fd6;}),_0x23893e[_0x4cfbd9(0x146)]((_0x334ef7,_0x501881)=>{_0x7c40eb[_0x501881]['expiry_date']=_0x334ef7;});const _0x1f4dad=_0x7c40eb[_0x4cfbd9(0x1a4)](_0x152db9=>_0x152db9[_0x4cfbd9(0x15d)]!=='0'&&_0x152db9['to_quantity']!==''||_0x152db9[_0x4cfbd9(0x1e8)]!=='0'&&_0x152db9[_0x4cfbd9(0x1e8)]!=='');var _0x139196=0x0;_0x1f4dad[_0x4cfbd9(0x146)](_0x4dc908=>{var _0x349de6=_0x4cfbd9;parseInt(_0x4dc908['from_quantity'])<parseInt(_0x4dc908[_0x349de6(0x15d)])&&_0x139196++;});if(_0x139196!=0x0)return _0xfee9f2[_0x4cfbd9(0x155)](_0x4cfbd9(0x17f),_0x4cfbd9(0x1c4)),_0x2b38e5[_0x4cfbd9(0x183)](_0x4cfbd9(0x115));const _0x3b5104=await warehouse[_0x4cfbd9(0x174)]({'name':_0x322c33[_0x4cfbd9(0x19b)],'room':_0x322c33['from_room']});_0x322c33[_0x4cfbd9(0x1dc)][_0x4cfbd9(0x146)](_0x1b77fe=>{var _0x2a30b4=_0x4cfbd9;if(_0x1b77fe[_0x2a30b4(0x15d)]>0x0){const _0xd81d15=_0x3b5104[_0x2a30b4(0x11c)][_0x2a30b4(0x16a)](_0x50e86b=>{var _0x4a0df2=_0x2a30b4;_0x50e86b[_0x4a0df2(0x132)]==_0x1b77fe[_0x4a0df2(0x132)]&&_0x50e86b[_0x4a0df2(0x1aa)]==_0x1b77fe['from_bay']&&(_0x50e86b[_0x4a0df2(0x129)]=parseInt(_0x50e86b[_0x4a0df2(0x129)])+parseInt(_0x1b77fe[_0x4a0df2(0x15d)]));});}}),await _0x3b5104[_0x4cfbd9(0x196)]();const _0x598e4d=await warehouse[_0x4cfbd9(0x174)]({'name':_0x322c33[_0x4cfbd9(0x14b)],'room':_0x322c33[_0x4cfbd9(0x11a)]});_0x322c33[_0x4cfbd9(0x1dc)][_0x4cfbd9(0x146)](_0xfcfb11=>{var _0x2e8170=_0x4cfbd9;if(_0xfcfb11[_0x2e8170(0x15d)]>0x0){const _0x131e0f=_0x598e4d[_0x2e8170(0x11c)][_0x2e8170(0x16a)](_0x46bea0=>{var _0x57984a=_0x2e8170;_0x46bea0[_0x57984a(0x132)]==_0xfcfb11[_0x57984a(0x132)]&&_0x46bea0[_0x57984a(0x1aa)]==_0xfcfb11[_0x57984a(0x1c1)]&&(_0x46bea0[_0x57984a(0x129)]=parseInt(_0x46bea0['product_stock'])-parseInt(_0xfcfb11['to_quantity']));});}}),await _0x598e4d[_0x4cfbd9(0x196)](),_0x322c33[_0x4cfbd9(0x17a)]=_0x1bac2e,_0x322c33[_0x4cfbd9(0x19b)]=_0x54126a,_0x322c33[_0x4cfbd9(0x14b)]=_0x218c38,_0x322c33[_0x4cfbd9(0x1dc)]=_0x1f4dad,_0x322c33[_0x4cfbd9(0x162)]=_0x92b323,_0x322c33['invoice']=_0x123bce;const _0x2958bf=await _0x322c33[_0x4cfbd9(0x196)](),_0x453a39=await warehouse[_0x4cfbd9(0x174)]({'name':_0x54126a,'room':_0x1277f2});_0x2958bf['product'][_0x4cfbd9(0x146)](_0x516fd7=>{var _0xe70f9=_0x4cfbd9;if(_0x516fd7[_0xe70f9(0x15d)]>0x0){const _0x43235a=_0x453a39[_0xe70f9(0x11c)][_0xe70f9(0x16a)](_0x2194a3=>{var _0x3c3fde=_0xe70f9;_0x2194a3[_0x3c3fde(0x132)]==_0x516fd7['product_name']&&_0x2194a3[_0x3c3fde(0x1aa)]==_0x516fd7[_0x3c3fde(0x14f)]&&(_0x2194a3['product_stock']=parseInt(_0x2194a3[_0x3c3fde(0x129)])-parseInt(_0x516fd7['to_quantity']));});}}),await _0x453a39[_0x4cfbd9(0x196)]();const _0x3f252c=await warehouse[_0x4cfbd9(0x174)]({'name':_0x218c38,'room':_0x1ba977});_0x2958bf['product'][_0x4cfbd9(0x146)](_0x1cee93=>{var _0xa53d5a=_0x4cfbd9;if(_0x1cee93[_0xa53d5a(0x15d)]>0x0){var _0x4a5aa7=0x0;const _0xc12e17=_0x3f252c[_0xa53d5a(0x11c)][_0xa53d5a(0x16a)](_0x22b861=>{var _0x55febe=_0xa53d5a;_0x22b861[_0x55febe(0x132)]==_0x1cee93[_0x55febe(0x132)]&&_0x22b861['bay']==_0x1cee93[_0x55febe(0x1c1)]&&(_0x22b861[_0x55febe(0x129)]=parseInt(_0x22b861['product_stock'])+parseInt(_0x1cee93[_0x55febe(0x15d)]),_0x4a5aa7++);});_0x4a5aa7=='0'&&(_0x3f252c[_0xa53d5a(0x11c)]=_0x3f252c['product_details'][_0xa53d5a(0x180)]({'product_name':_0x1cee93['product_name'],'product_stock':_0x1cee93[_0xa53d5a(0x15d)],'bay':_0x1cee93[_0xa53d5a(0x1c1)],'product_code':_0x1cee93['product_code'],'primary_code':_0x1cee93[_0xa53d5a(0x150)],'secondary_code':_0x1cee93[_0xa53d5a(0x1dd)],'maxProducts':_0x1cee93[_0xa53d5a(0x127)]}));}}),await _0x3f252c[_0x4cfbd9(0x196)](),_0xfee9f2[_0x4cfbd9(0x155)]('success',_0x4cfbd9(0x11e)),_0x2b38e5[_0x4cfbd9(0x183)](_0x4cfbd9(0x189));}catch(_0x39b0c2){console[_0x4cfbd9(0x1e1)](_0x39b0c2);}}),router[a0_0x36621c(0x190)](a0_0x36621c(0x1a1),async(_0x3b80a0,_0x25921c)=>{var _0x8a1da2=a0_0x36621c;const {FromWareHouse:_0xa52e1c,FromRoom:_0x526e5a,ToWarehouse:_0x54e188,ToRoom:_0x531d65,primary_code:_0x3d95c6,Roomslist:_0x215065}=_0x3b80a0[_0x8a1da2(0x1a3)],_0x564e50=_0x215065[_0x8a1da2(0x1d6)](','),_0x1be87a=[];async function _0x9a1c43(_0x478dcc){var _0xb5910a=_0x8a1da2;const _0x16feca=await warehouse['aggregate']([{'$match':{'name':_0xa52e1c,'room':_0x478dcc}},{'$unwind':_0xb5910a(0x1eb)},{'$match':{'product_details.primary_code':_0x3d95c6}},{'$group':{'_id':_0xb5910a(0x1d1),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0xb5910a(0x176)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xb5910a(0x192)},'level':{'$first':_0xb5910a(0x1b4)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xb5910a(0x17e)},'pallet':{'$first':_0xb5910a(0x17c)},'unit':{'$first':_0xb5910a(0x116)},'secondary_unit':{'$first':_0xb5910a(0x1af)},'storage':{'$first':_0xb5910a(0x124)},'rack':{'$first':_0xb5910a(0x148)},'expiry_date':{'$first':_0xb5910a(0x1d3)},'production_date':{'$first':_0xb5910a(0x12e)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0xb5910a(0x181)}}}]),_0x2f6b22=await warehouse[_0xb5910a(0x1db)]([{'$match':{'name':_0xa52e1c,'room':_0x478dcc}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3d95c6}},{'$group':{'_id':_0xb5910a(0x1d1),'name':{'$first':_0xb5910a(0x1cb)},'instock':{'$first':_0xb5910a(0x1da)},'primary_code':{'$first':_0xb5910a(0x176)},'secondary_code':{'$first':_0xb5910a(0x15f)},'product_code':{'$first':_0xb5910a(0x192)},'level':{'$first':_0xb5910a(0x1b4)},'isle':{'$first':_0xb5910a(0x1c3)},'type':{'$first':_0xb5910a(0x17e)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0xb5910a(0x116)},'secondary_unit':{'$first':_0xb5910a(0x1af)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xb5910a(0x148)},'expiry_date':{'$first':_0xb5910a(0x1d3)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0xb5910a(0x1c8)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0xb5910a(0x137)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0xb5910a(0x181)}}}]);if(_0x16feca['length']>0x0)_0x1be87a['push'](_0x16feca);else _0x2f6b22[_0xb5910a(0x1bd)]>0x0&&_0x1be87a[_0xb5910a(0x16d)](_0x2f6b22);}const _0x4cc408=_0x564e50['map'](_0x517c7e=>_0x9a1c43(_0x517c7e));await Promise[_0x8a1da2(0x18f)](_0x4cc408),_0x25921c['json'](_0x1be87a);}),router[a0_0x36621c(0x190)](a0_0x36621c(0x1c6),async(_0x457715,_0xec095a)=>{var _0x519d83=a0_0x36621c;try{const {FromWareHouse:_0x2639e8,FromRoom:_0x32accb,ToWarehouse:_0x1aba13,ToRoom:_0x4a7727,secondary_code:_0x2bf3e8}=_0x457715[_0x519d83(0x1a3)],_0x5a8377=await warehouse[_0x519d83(0x1db)]([{'$match':{'name':_0x2639e8}},{'$unwind':_0x519d83(0x1eb)},{'$match':{'product_details.secondary_code':_0x2bf3e8}},{'$group':{'_id':_0x519d83(0x1d1),'name':{'$first':_0x519d83(0x1cb)},'primary_code':{'$first':_0x519d83(0x176)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x519d83(0x192)},'instock':{'$first':_0x519d83(0x1da)},'warehouse':{'$first':_0x519d83(0x13f)},'level':{'$first':_0x519d83(0x1a6)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x519d83(0x18a)},'maxProducts':{'$first':_0x519d83(0x143)},'unit':{'$first':_0x519d83(0x116)},'expiry_date':{'$first':_0x519d83(0x1d3)},'production_date':{'$first':_0x519d83(0x12e)}}}]);_0xec095a['status'](0xc8)[_0x519d83(0x1a2)](_0x5a8377);}catch(_0x45cb99){_0xec095a[_0x519d83(0x12f)](0x194)[_0x519d83(0x1a2)]({'message':_0x45cb99[_0x519d83(0x12d)]});}}),router[a0_0x36621c(0x190)](a0_0x36621c(0x15b),async(_0x474756,_0x4895e5)=>{var _0x866763=a0_0x36621c;try{const {FromWareHouse:_0x2139b3,FromRoom:_0x1badb0,ToWarehouse:_0x2e9a7d,ToRoom:_0x1b901f,product_code:_0x19ec9f}=_0x474756[_0x866763(0x1a3)],_0x5dd1a7=await warehouse[_0x866763(0x1db)]([{'$match':{'name':_0x2139b3}},{'$unwind':_0x866763(0x1eb)},{'$match':{'product_details.product_code':_0x19ec9f}},{'$group':{'_id':_0x866763(0x1d1),'name':{'$first':_0x866763(0x1cb)},'primary_code':{'$first':_0x866763(0x176)},'secondary_code':{'$first':_0x866763(0x15f)},'product_code':{'$first':_0x866763(0x192)},'instock':{'$first':_0x866763(0x1da)},'warehouse':{'$first':'$name'},'level':{'$first':_0x866763(0x1a6)},'isle':{'$first':_0x866763(0x13e)},'pallet':{'$first':_0x866763(0x18a)},'maxProducts':{'$first':_0x866763(0x143)},'unit':{'$first':_0x866763(0x116)}}}]);_0x4895e5[_0x866763(0x12f)](0xc8)[_0x866763(0x1a2)](_0x5dd1a7);}catch(_0x19543d){_0x4895e5[_0x866763(0x12f)](0x194)[_0x866763(0x1a2)]({'message':_0x19543d['message']});}}),router[a0_0x36621c(0x190)](a0_0x36621c(0x15a),async(_0x2fd0f0,_0x22c221)=>{var _0x3daae0=a0_0x36621c;const {productCode:_0x741bb,bay:_0x223c3b,warehouses:_0x1ad75d,room:_0x13f8d0}=_0x2fd0f0[_0x3daae0(0x1a3)];console[_0x3daae0(0x1e1)](_0x2fd0f0[_0x3daae0(0x1a3)]);try{const _0x138d4d=await warehouse[_0x3daae0(0x1db)]([{'$match':{'name':_0x1ad75d,'room':_0x13f8d0}},{'$unwind':_0x3daae0(0x1eb)},{'$match':{'product_details.bay':parseInt(_0x223c3b)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3daae0(0x1cb)},'product_stock':{'$first':_0x3daae0(0x1da)},'bay':{'$first':_0x3daae0(0x1b4)},'maxProducts':{'$first':_0x3daae0(0x143)}}}]);_0x22c221[_0x3daae0(0x12f)](0xc8)[_0x3daae0(0x1a2)](_0x138d4d);}catch(_0x229257){_0x22c221[_0x3daae0(0x12f)](0x194)[_0x3daae0(0x1a2)]({'message':_0x229257[_0x3daae0(0x12d)]});}}),module[a0_0x36621c(0x122)]=router;