var a0_0x5cbaf5=a0_0x3687;(function(_0x56b58b,_0x26eee3){var _0xe74c11=a0_0x3687,_0x552ff1=_0x56b58b();while(!![]){try{var _0x2ee20e=-parseInt(_0xe74c11(0x191))/0x1+-parseInt(_0xe74c11(0x193))/0x2*(parseInt(_0xe74c11(0x1cb))/0x3)+parseInt(_0xe74c11(0x180))/0x4*(-parseInt(_0xe74c11(0x1b4))/0x5)+-parseInt(_0xe74c11(0x1a8))/0x6*(parseInt(_0xe74c11(0x13e))/0x7)+parseInt(_0xe74c11(0xf8))/0x8+-parseInt(_0xe74c11(0x167))/0x9*(parseInt(_0xe74c11(0x19e))/0xa)+parseInt(_0xe74c11(0x121))/0xb;if(_0x2ee20e===_0x26eee3)break;else _0x552ff1['push'](_0x552ff1['shift']());}catch(_0x34da47){_0x552ff1['push'](_0x552ff1['shift']());}}}(a0_0x4e75,0xf03ad));function a0_0x4e75(){var _0x317206=['express','edit_transfer_finished','\x20</h2>','$product_details.maxProducts','floor','TRFF-','log','$product_details.secondary_unit','password','id_transaction','<h5>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','string','/barcode_scanner3','product_stock','nodemailer','aggregate','/barcode_scanner','<tr>','$product_details.isle','$product_details.batch_code','/preview/:id','from_prod_level','staff','push','</tr>','48419fuFWyo','from_warehouse','to_warehouse','params','</thead>','from_quantity','expiry_date','</table>','$product_details.unit','findOne','<h2>\x20','$name','getFullYear','English\x20(US)','../models/all_models','$product_details','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','to_quantity','</h5>','RoomAssigned','$product_details.rack','max','Hindi','/transfer/view','/transfer_finished/view','production_date','Rack\x201','to_room_name','Portuguese\x20(BR)','map','$product_details.bin','Chinese','$to_warehouse','concat','</head><body>','from_room_name','DRY\x20GOODS','Spanish','$product_details.invoice','secondary_unit','to_room','9fBIxYh','transfer_data','invoice','forEach','$product_details.production_date','English','date','$product_details.bay','save','back','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','host','Transfer\x20Finalize\x20Successfully','to_prod_qty','\x20Order\x20Number\x20:\x20','$product_details.type','json','/view','success','Router','Ambient','<span\x20style=\x22float:\x20right;\x22>','\x20<>\x20','$product_details.expiry_date','then','356276gKiBfL','\x20Order\x20Date\x20:\x20','logo','Arabic\x20(ae)','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','An\x20error\x20occurred\x20while\x20saving\x20data.','maxProducts','port','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product_details.floorlevel','language','$finalize','flash','$product_details._id','Enabled','1463149kDyJdp','email','30BiiPni','to_invoice','\x20<=>\x20','$product_details.pallet','redirect','padStart','findById','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','getMonth','from_invoice','QA\x20Warehouse','15388320YjeKCH','toString','product_date','createTransport','edit_transfer_finished_view','$product_details.product_code','bay','$product_details.level','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','78Adhsrb','_id','Error\x20Occurs','MaxStocks_data','$product.from_room_name','FROZEN\x20GOODS','../middleware/auth','getDate','$product','all','find','<hr\x20class=\x22my-3\x22>','35XDboKK','to_prod_level','message','/view/add_transfer','<h5\x20style=\x22text-align:\x20left;\x22>','Email\x20sent\x20successfully','catch','length','to_bay','from_bay','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','prod_cat','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','/view/:id','$room','<table\x20style=\x22width:\x20100%\x20!important;\x22>','product_code','product','product_code3','role','image','$product_details.storage','here2','17235PodNPZ','Finished\x20Goods','primary_unit','$invoice','render','New_Qty_Converted','$product_details.secondary_code','batch_code','primary_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Arabic','body','11553776fQvEdS','product_details','</td>','MaxStocks_data2','</tbody>','error','$product.to_room_name','from_prod_qty','An\x20error\x20occurred.','Transfer\x20Edit\x20Successfully','</body></html>','finalize','warehouse','$product_details.maxPerUnit','to_floorlevel','/CheckingWarehouse','<div>','ToRoomAssigned','abs','/picking_list/PDF_transfer/','French','Transfer\x20Mail','Portuguese','unit','secondary_code','</div>','filter','random','product_name','get','/upload/','German','add_transfer_finished','user','post','To_invoice','errors','$product_details.product_name','slice','note','site_title','36754509MdosGX','status','prod_name'];a0_0x4e75=function(){return _0x317206;};return a0_0x4e75();}const express=require(a0_0x5cbaf5(0x124)),app=express(),router=express[a0_0x5cbaf5(0x17a)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x5cbaf5(0x14c)),auth=require(a0_0x5cbaf5(0x1ae)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x5cbaf5(0x133));router['get'](a0_0x5cbaf5(0x178),auth,async(_0x2764ae,_0x58ce17)=>{var _0x4d47a1=a0_0x5cbaf5;try{const {username:_0x2ed009,email:_0x48abb1,role:_0x4445b2}=_0x2764ae[_0x4d47a1(0x119)],_0x3e3e2d=_0x2764ae[_0x4d47a1(0x119)],_0x408c59=await profile['findOne']({'email':_0x3e3e2d[_0x4d47a1(0x192)]}),_0xc11888=await master_shop[_0x4d47a1(0x1b2)]();let _0x1bc886;if(_0x3e3e2d['role']==_0x4d47a1(0x13b)){const _0x14a0e2=await staff['findOne']({'email':_0x3e3e2d[_0x4d47a1(0x192)]});_0x1bc886=await transfers_finished[_0x4d47a1(0x1b2)]({'from_warehouse':_0x14a0e2[_0x4d47a1(0x104)]});}else _0x1bc886=await transfers_finished[_0x4d47a1(0x134)]([{'$unwind':_0x4d47a1(0x1b0)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4d47a1(0xef)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x4d47a1(0x15e)},'from_room_name':{'$addToSet':_0x4d47a1(0x1ac)},'to_room_name':{'$addToSet':_0x4d47a1(0xfe)},'finalize':{'$first':_0x4d47a1(0x18d)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0xc11888[0x0]['language']=='English\x20(US)')var _0x2ca58c=users[_0x4d47a1(0x16c)];else{if(_0xc11888[0x0][_0x4d47a1(0x18c)]==_0x4d47a1(0x154))var _0x2ca58c=users['Hindi'];else{if(_0xc11888[0x0][_0x4d47a1(0x18c)]==_0x4d47a1(0x117))var _0x2ca58c=users[_0x4d47a1(0x117)];else{if(_0xc11888[0x0][_0x4d47a1(0x18c)]==_0x4d47a1(0x163))var _0x2ca58c=users['Spanish'];else{if(_0xc11888[0x0][_0x4d47a1(0x18c)]=='French')var _0x2ca58c=users[_0x4d47a1(0x10c)];else{if(_0xc11888[0x0][_0x4d47a1(0x18c)]=='Portuguese\x20(BR)')var _0x2ca58c=users[_0x4d47a1(0x10e)];else{if(_0xc11888[0x0][_0x4d47a1(0x18c)]==_0x4d47a1(0x15d))var _0x2ca58c=users[_0x4d47a1(0x15d)];else{if(_0xc11888[0x0]['language']==_0x4d47a1(0x183))var _0x2ca58c=users[_0x4d47a1(0xf6)];}}}}}}}_0x58ce17[_0x4d47a1(0xf0)]('transfer_finished',{'success':_0x2764ae[_0x4d47a1(0x18e)](_0x4d47a1(0x179)),'errors':_0x2764ae[_0x4d47a1(0x18e)](_0x4d47a1(0x11c)),'role':_0x3e3e2d,'profile':_0x408c59,'master_shop':_0xc11888,'transfer':_0x1bc886,'language':_0x2ca58c});}catch(_0x5830f9){console[_0x4d47a1(0x12a)](_0x5830f9);}});async function getRandom8DigitNumber(){var _0x11c44d=a0_0x5cbaf5;const _0x53740d=0x989680,_0x316b05=0x5f5e0ff,_0x52a9e1=Math[_0x11c44d(0x128)](Math[_0x11c44d(0x113)]()*(_0x316b05-_0x53740d+0x1))+_0x53740d;var _0x67a107;const _0x36f486=await transfers_finished['findOne']({'invoice':_0x11c44d(0x129)+_0x52a9e1});return _0x36f486&&_0x36f486['length']>0x0?_0x67a107=_0x11c44d(0x129)+_0x52a9e1:_0x67a107=_0x11c44d(0x129)+_0x52a9e1,_0x67a107;}function a0_0x3687(_0x577e43,_0x39d0fc){var _0x4e75be=a0_0x4e75();return a0_0x3687=function(_0x368708,_0x282b55){_0x368708=_0x368708-0xee;var _0x23a45e=_0x4e75be[_0x368708];return _0x23a45e;},a0_0x3687(_0x577e43,_0x39d0fc);}router['get']('/view/add_transfer',auth,async(_0x4c9486,_0x55b76b)=>{var _0x19348f=a0_0x5cbaf5;try{const {username:_0x43e6e9,email:_0x41d54d,role:_0x4ed940}=_0x4c9486[_0x19348f(0x119)],_0x413978=_0x4c9486['user'],_0x2f7f43=await profile[_0x19348f(0x147)]({'email':_0x413978[_0x19348f(0x192)]}),_0x2edfd1=await master_shop['find']();let _0x2637f2;if(_0x413978[_0x19348f(0x1c7)]==_0x19348f(0x13b)){const _0x58e503=await staff[_0x19348f(0x147)]({'email':_0x413978[_0x19348f(0x192)]});_0x2637f2=await warehouse[_0x19348f(0x134)]([{'$match':{'status':_0x19348f(0x190),'name':_0x58e503[_0x19348f(0x104)],'warehouse_category':_0x19348f(0x1cc),'name':{'$ne':_0x19348f(0x19d)}}},{'$group':{'_id':'$name','name':{'$first':_0x19348f(0x149)}}}]);}else _0x2637f2=await warehouse['aggregate']([{'$match':{'status':_0x19348f(0x190),'warehouse_category':_0x19348f(0x1cc),'name':{'$ne':_0x19348f(0x19d)}}},{'$group':{'_id':_0x19348f(0x149),'name':{'$first':'$name'}}}]);const _0x5d6da5=await transfers_finished[_0x19348f(0x1b2)]({}),_0x2e8d3a=_0x5d6da5[_0x19348f(0x1bb)]+0x1,_0x57ddfa=_0x19348f(0x129)+_0x2e8d3a[_0x19348f(0x19f)]()[_0x19348f(0x198)](0x5,'0');if(_0x2edfd1[0x0][_0x19348f(0x18c)]==_0x19348f(0x14b))var _0x5a7f5d=users[_0x19348f(0x16c)];else{if(_0x2edfd1[0x0][_0x19348f(0x18c)]==_0x19348f(0x154))var _0x5a7f5d=users[_0x19348f(0x154)];else{if(_0x2edfd1[0x0][_0x19348f(0x18c)]=='German')var _0x5a7f5d=users[_0x19348f(0x117)];else{if(_0x2edfd1[0x0]['language']==_0x19348f(0x163))var _0x5a7f5d=users[_0x19348f(0x163)];else{if(_0x2edfd1[0x0][_0x19348f(0x18c)]==_0x19348f(0x10c))var _0x5a7f5d=users[_0x19348f(0x10c)];else{if(_0x2edfd1[0x0][_0x19348f(0x18c)]==_0x19348f(0x15a))var _0x5a7f5d=users['Portuguese'];else{if(_0x2edfd1[0x0][_0x19348f(0x18c)]==_0x19348f(0x15d))var _0x5a7f5d=users[_0x19348f(0x15d)];else{if(_0x2edfd1[0x0][_0x19348f(0x18c)]==_0x19348f(0x183))var _0x5a7f5d=users[_0x19348f(0xf6)];}}}}}}}const _0x157eab=getRandom8DigitNumber();_0x157eab[_0x19348f(0x17f)](_0x140f54=>{var _0x562322=_0x19348f;_0x55b76b[_0x562322(0xf0)](_0x562322(0x118),{'success':_0x4c9486[_0x562322(0x18e)](_0x562322(0x179)),'errors':_0x4c9486[_0x562322(0x18e)](_0x562322(0x11c)),'role':_0x413978,'profile':_0x2f7f43,'master_shop':_0x2edfd1,'warehouse':_0x2637f2,'language':_0x5a7f5d,'invoice':_0x140f54});})['catch'](_0x479ab1=>{var _0x4a9289=_0x19348f;_0x4c9486[_0x4a9289(0x18e)]('errors',_0x4a9289(0xf5)),_0x55b76b[_0x4a9289(0x197)](_0x4a9289(0x155));});}catch(_0x450b51){console[_0x19348f(0x12a)](_0x450b51);}}),router[a0_0x5cbaf5(0x11a)](a0_0x5cbaf5(0x1b7),auth,async(_0x1e6215,_0x3b54b3)=>{var _0x5609a7=a0_0x5cbaf5;try{const {date:_0xc34e8a,from_warehouse:_0x1f8d1d,FromRoom_name:_0x12d344,to_warehouse:_0x5aff99,ToRoom_name:_0x36aca6,prod_name:_0x306276,from_prod_qty:_0x3fa469,from_prod_level:_0x5607ac,from_prod_isle:_0x1889c1,from_prod_pallet:_0x57df2b,to_prod_qty:_0x1c8dba,to_prod_level:_0x32b6d8,to_prod_isle:_0x3d9efb,to_prod_pallet:_0x448f30,primary_code:_0x57a6d9,secondary_code:_0x4ace6c,product_code3:_0x1c4721,note:_0x2a4dd4,MaxStocks_data2:_0x503479,invoice:_0xf07e84,expiry_date:_0x130022}=_0x1e6215[_0x5609a7(0xf7)];if(typeof _0x306276==_0x5609a7(0x130))var _0x41546c=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x123)]],_0x579592=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0xff)]],_0xb1c46b=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x13a)]],_0x2724a8=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0xf1)]],_0x58501b=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x1b5)]],_0x16c6ef=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0xf4)]],_0x34398a=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x110)]],_0x2ccda8=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x1c6)]],_0x241475=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0xfb)]],_0x574346=[_0x1e6215['body'][_0x5609a7(0xee)]],_0x454022=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x165)]],_0xdaf0b1=[_0x1e6215['body'][_0x5609a7(0xf3)]],_0xc0f43f=[_0x1e6215['body'][_0x5609a7(0x144)]],_0xc43535=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x1a0)]],_0x2da520=[_0x1e6215['body'][_0x5609a7(0x1ab)]],_0xe77111=[_0x1e6215[_0x5609a7(0xf7)]['maxPerUnit']],_0x18ec38=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x1bf)]],_0x8ee755=[_0x1e6215['body'][_0x5609a7(0x151)]],_0x5b6d4d=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x109)]],_0x5afa29=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x19c)]],_0x3db801=[_0x1e6215[_0x5609a7(0xf7)]['to_invoice']],_0x2f6076=[_0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x12d)]];else var _0x41546c=[..._0x1e6215['body'][_0x5609a7(0x123)]],_0x579592=[..._0x1e6215['body'][_0x5609a7(0xff)]],_0xb1c46b=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x13a)]],_0x2724a8=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0xf1)]],_0x58501b=[..._0x1e6215[_0x5609a7(0xf7)]['to_prod_level']],_0x16c6ef=[..._0x1e6215['body'][_0x5609a7(0xf4)]],_0x34398a=[..._0x1e6215['body'][_0x5609a7(0x110)]],_0x2ccda8=[..._0x1e6215['body']['product_code3']],_0x241475=[..._0x1e6215['body'][_0x5609a7(0xfb)]],_0x574346=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0xee)]],_0x454022=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x165)]],_0xdaf0b1=[..._0x1e6215['body'][_0x5609a7(0xf3)]],_0xc0f43f=[..._0x1e6215[_0x5609a7(0xf7)]['expiry_date']],_0xc43535=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x1a0)]],_0x2da520=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x1ab)]],_0xe77111=[..._0x1e6215[_0x5609a7(0xf7)]['maxPerUnit']],_0x18ec38=[..._0x1e6215['body'][_0x5609a7(0x1bf)]],_0x8ee755=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x151)]],_0x5b6d4d=[..._0x1e6215['body'][_0x5609a7(0x109)]],_0x5afa29=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x19c)]],_0x3db801=[..._0x1e6215['body'][_0x5609a7(0x194)]],_0x2f6076=[..._0x1e6215[_0x5609a7(0xf7)][_0x5609a7(0x12d)]];const _0x63acf8=_0x41546c['map'](_0x4d5941=>{return _0x4d5941={'product_name':_0x4d5941};});_0x579592['forEach']((_0x5af4a0,_0xd8bb55)=>{_0x63acf8[_0xd8bb55]['from_quantity']=_0x5af4a0;}),_0xb1c46b[_0x5609a7(0x16a)]((_0x52d43a,_0x511baa)=>{_0x63acf8[_0x511baa]['from_bay']=_0x52d43a;}),_0x2f6076['forEach']((_0x4285bf,_0x2097e9)=>{_0x63acf8[_0x2097e9]['id_transaction']=_0x4285bf;}),_0x5afa29[_0x5609a7(0x16a)]((_0x1606f6,_0x43cad6)=>{_0x63acf8[_0x43cad6]['from_invoice']=_0x1606f6;}),_0x3db801[_0x5609a7(0x16a)]((_0x47a2e3,_0x4b69e7)=>{var _0x185dd0=_0x5609a7;_0x63acf8[_0x4b69e7][_0x185dd0(0x11b)]=_0x47a2e3;}),_0x2724a8[_0x5609a7(0x16a)]((_0x2a460d,_0x1bd834)=>{_0x63acf8[_0x1bd834]['to_quantity']=_0x2a460d;}),_0x58501b[_0x5609a7(0x16a)]((_0x5c6ddf,_0x4fbbc0)=>{var _0x2557f4=_0x5609a7;_0x63acf8[_0x4fbbc0][_0x2557f4(0x1bc)]=_0x5c6ddf;}),_0x16c6ef[_0x5609a7(0x16a)]((_0x29677c,_0x5ccbdb)=>{var _0x4db8c3=_0x5609a7;_0x63acf8[_0x5ccbdb][_0x4db8c3(0xf4)]=_0x29677c;}),_0x34398a[_0x5609a7(0x16a)]((_0x354b26,_0x1d1d4b)=>{var _0x360a4f=_0x5609a7;_0x63acf8[_0x1d1d4b][_0x360a4f(0x110)]=_0x354b26;}),_0x2ccda8[_0x5609a7(0x16a)]((_0x3d042e,_0x514871)=>{var _0x460c29=_0x5609a7;_0x63acf8[_0x514871][_0x460c29(0x1c4)]=_0x3d042e;}),_0x241475['forEach']((_0x44e7f3,_0x612e8a)=>{var _0x44717a=_0x5609a7;_0x63acf8[_0x612e8a][_0x44717a(0x186)]=_0x44e7f3;}),_0x574346[_0x5609a7(0x16a)]((_0x5920c1,_0x20e696)=>{var _0x1a87d2=_0x5609a7;_0x63acf8[_0x20e696][_0x1a87d2(0x10f)]=_0x5920c1;}),_0x454022[_0x5609a7(0x16a)]((_0x298af9,_0x3f5d44)=>{var _0x5d554e=_0x5609a7;_0x63acf8[_0x3f5d44][_0x5d554e(0x165)]=_0x298af9;}),_0xdaf0b1[_0x5609a7(0x16a)]((_0x36ea9e,_0x57480f)=>{_0x63acf8[_0x57480f]['batch_code']=_0x36ea9e;}),_0xc0f43f[_0x5609a7(0x16a)]((_0x24297e,_0x2105d2)=>{_0x63acf8[_0x2105d2]['expiry_date']=_0x24297e;}),_0xc43535[_0x5609a7(0x16a)]((_0x23765c,_0x2c03c3)=>{var _0x13661d=_0x5609a7;_0x63acf8[_0x2c03c3][_0x13661d(0x157)]=_0x23765c;}),_0x2da520['forEach']((_0x5cb84d,_0x45c3a3)=>{var _0xf3dba1=_0x5609a7;_0x63acf8[_0x45c3a3][_0xf3dba1(0x186)]=_0x5cb84d;}),_0xe77111['forEach']((_0x569a5e,_0x4ee0ae)=>{_0x63acf8[_0x4ee0ae]['maxPerUnit']=_0x569a5e;}),_0x18ec38[_0x5609a7(0x16a)]((_0x21e85f,_0x55d07b)=>{var _0x3e0ca4=_0x5609a7;_0x63acf8[_0x55d07b][_0x3e0ca4(0x1bf)]=_0x21e85f;}),_0x8ee755[_0x5609a7(0x16a)]((_0x43bb77,_0x38bb22)=>{_0x63acf8[_0x38bb22]['from_room_name']=_0x43bb77;}),_0x5b6d4d[_0x5609a7(0x16a)]((_0x529417,_0x4c2d00)=>{_0x63acf8[_0x4c2d00]['to_room_name']=_0x529417;});const _0x185fd7=_0x63acf8[_0x5609a7(0x112)](_0x5b25fe=>_0x5b25fe[_0x5609a7(0x14f)]!=='0'&&_0x5b25fe[_0x5609a7(0x14f)]!==''||_0x5b25fe[_0x5609a7(0x106)]!=='0'&&_0x5b25fe[_0x5609a7(0x106)]!=='');var _0xd5dcc6=0x0;_0x185fd7[_0x5609a7(0x16a)](_0xdb5ffb=>{var _0x2c79fd=_0x5609a7;parseInt(_0xdb5ffb[_0x2c79fd(0x143)])<parseInt(_0xdb5ffb[_0x2c79fd(0x14f)])&&_0xd5dcc6++;});if(_0xd5dcc6!=0x0)return _0x1e6215[_0x5609a7(0x18e)]('errors',_0x5609a7(0x1c0)),_0x3b54b3[_0x5609a7(0x197)](_0x5609a7(0x170));const _0x2b4324=new transfers_finished({'date':_0xc34e8a,'from_warehouse':_0x1f8d1d,'to_warehouse':_0x5aff99,'product':_0x185fd7,'note':_0x2a4dd4,'invoice':_0xf07e84}),_0x41ae20=await _0x2b4324[_0x5609a7(0x16f)]();_0x1e6215['flash'](_0x5609a7(0x179),'Product\x20Transfer\x20successfully'),_0x3b54b3['redirect']('/transfer_finished/preview/'+_0x41ae20[_0x5609a7(0x1a9)]);}catch(_0x3b392b){console[_0x5609a7(0x12a)](_0x3b392b),_0x3b54b3[_0x5609a7(0x122)](0xc8)[_0x5609a7(0x177)]({'errorMessage':_0x3b392b['message']});}}),router[a0_0x5cbaf5(0x115)](a0_0x5cbaf5(0x139),auth,async(_0x2ea825,_0x43c72c)=>{var _0x51ad1c=a0_0x5cbaf5;try{const {username:_0x5b1828,email:_0x18b5e0,role:_0x4f4e54}=_0x2ea825['user'],_0x2020df=_0x2ea825['user'],_0x11d9e5=await profile[_0x51ad1c(0x147)]({'email':_0x2020df[_0x51ad1c(0x192)]}),_0x4b75d4=await master_shop[_0x51ad1c(0x1b2)](),_0x391ed2=await transfers_finished[_0x51ad1c(0x199)](_0x2ea825[_0x51ad1c(0x141)]['id']);let _0x533e4d;if(_0x2020df['role']==_0x51ad1c(0x13b)){const _0x16d7d4=await staff[_0x51ad1c(0x147)]({'email':_0x2020df[_0x51ad1c(0x192)]});_0x533e4d=await warehouse['find']({'status':_0x51ad1c(0x190),'name':_0x16d7d4[_0x51ad1c(0x104)],'warehouse_category':_0x51ad1c(0x1cc)});}else _0x533e4d=await warehouse['find']({'status':_0x51ad1c(0x190),'warehouse_category':_0x51ad1c(0x1cc)});const _0x292ff1=await warehouse[_0x51ad1c(0x134)]([{'$match':{'name':_0x391ed2['from_warehouse'],'warehouse_category':_0x51ad1c(0x1cc)}},{'$unwind':_0x51ad1c(0x14d)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x51ad1c(0x11d)},'product_stock':{'$first':_0x51ad1c(0x188)},'bay':{'$first':_0x51ad1c(0x16e)},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x51ad1c(0x18b)},'primary_code':{'$first':_0x51ad1c(0x1a6)},'secondary_code':{'$first':_0x51ad1c(0xf2)},'product_code':{'$first':_0x51ad1c(0x1a3)},'storage':{'$first':_0x51ad1c(0x1c9)},'rack':{'$first':_0x51ad1c(0x152)},'expiry_date':{'$first':_0x51ad1c(0x17e)},'production_date':{'$first':_0x51ad1c(0x16b)},'room':{'$first':'$room'},'warehoue_name':{'$first':'$name'}}}]),_0x20ad6=await product['find']({});if(_0x4b75d4[0x0]['language']==_0x51ad1c(0x14b)){var _0x1a0c3f=users[_0x51ad1c(0x16c)];console[_0x51ad1c(0x12a)](_0x1a0c3f);}else{if(_0x4b75d4[0x0][_0x51ad1c(0x18c)]==_0x51ad1c(0x154))var _0x1a0c3f=users[_0x51ad1c(0x154)];else{if(_0x4b75d4[0x0][_0x51ad1c(0x18c)]=='German')var _0x1a0c3f=users['German'];else{if(_0x4b75d4[0x0][_0x51ad1c(0x18c)]==_0x51ad1c(0x163))var _0x1a0c3f=users['Spanish'];else{if(_0x4b75d4[0x0]['language']==_0x51ad1c(0x10c))var _0x1a0c3f=users[_0x51ad1c(0x10c)];else{if(_0x4b75d4[0x0][_0x51ad1c(0x18c)]==_0x51ad1c(0x15a))var _0x1a0c3f=users[_0x51ad1c(0x10e)];else{if(_0x4b75d4[0x0][_0x51ad1c(0x18c)]==_0x51ad1c(0x15d))var _0x1a0c3f=users[_0x51ad1c(0x15d)];else{if(_0x4b75d4[0x0][_0x51ad1c(0x18c)]==_0x51ad1c(0x183))var _0x1a0c3f=users['Arabic'];}}}}}}}_0x43c72c['render'](_0x51ad1c(0x1a2),{'success':_0x2ea825[_0x51ad1c(0x18e)](_0x51ad1c(0x179)),'errors':_0x2ea825[_0x51ad1c(0x18e)]('errors'),'role':_0x2020df,'profile':_0x11d9e5,'master_shop':_0x4b75d4,'warehouse':_0x533e4d,'transfer':_0x391ed2,'stock':_0x292ff1,'unit':_0x20ad6,'language':_0x1a0c3f});}catch(_0x5d99f){console[_0x51ad1c(0x12a)](_0x5d99f);}}),router['post'](a0_0x5cbaf5(0x139),auth,async(_0x230467,_0x16738e)=>{var _0x43dcd8=a0_0x5cbaf5;try{const {invoice:_0x3d42c2,from_warehouse:_0x2b9d40,FromRoom_name:_0xc93a40,to_warehouse:_0x2c949b,ToRoom_name:_0x4b00fc}=_0x230467['body'],_0x32a3d2=await transfers_finished[_0x43dcd8(0x199)](_0x230467[_0x43dcd8(0x141)]['id']),_0x236039=_0x32a3d2[_0x43dcd8(0x1c5)]['map'](async _0x6bac28=>{var _0x3b805b=_0x43dcd8;if(_0x6bac28['to_quantity']>0x0){var _0xfbb93=await warehouse[_0x3b805b(0x147)]({'name':_0x2b9d40,'room':_0x6bac28[_0x3b805b(0x161)],'warehouse_category':_0x3b805b(0x1cc)});const _0x4c506a=_0xfbb93[_0x3b805b(0xf9)][_0x3b805b(0x15b)](_0x528297=>{var _0x4a0510=_0x3b805b;_0x528297[_0x4a0510(0x114)]==_0x6bac28[_0x4a0510(0x114)]&&_0x528297[_0x4a0510(0x1a4)]==_0x6bac28[_0x4a0510(0x1bd)]&&_0x528297['expiry_date']==_0x6bac28[_0x4a0510(0x144)]&&_0x528297[_0x4a0510(0x157)]==_0x6bac28['production_date']&&_0x528297[_0x4a0510(0xf3)]==_0x6bac28[_0x4a0510(0xf3)]&&_0x528297['invoice']==_0x6bac28['from_invoice']&&(console[_0x4a0510(0x12a)]('here1',_0x528297['product_stock']),typeof _0x6bac28['id_transaction']=='undefined'?_0x528297[_0x4a0510(0x132)]=Math[_0x4a0510(0x153)](0x0,Math[_0x4a0510(0x10a)](_0x528297[_0x4a0510(0x132)])-Math[_0x4a0510(0x10a)](_0x6bac28[_0x4a0510(0x14f)])):_0x528297['product_stock']=Math['max'](0x0,Math[_0x4a0510(0x10a)](_0x528297[_0x4a0510(0x132)])-Math[_0x4a0510(0x10a)](_0x6bac28[_0x4a0510(0x14f)])));});}return _0xfbb93;});Promise['all'](_0x236039)[_0x43dcd8(0x17f)](async _0x58eae3=>{var _0x4f947=_0x43dcd8;try{for(const _0x4e600c of _0x58eae3){await _0x4e600c[_0x4f947(0x16f)]();}const _0xd31f99=_0x32a3d2[_0x4f947(0x1c5)][_0x4f947(0x15b)](async _0x41c12d=>{var _0x5458df=_0x4f947,_0x530ebc=await warehouse[_0x5458df(0x147)]({'name':_0x2c949b,'room':_0x41c12d[_0x5458df(0x159)]});if(_0x41c12d[_0x5458df(0x14f)]>0x0){var _0x3f9c0b=0x0;const _0x1d3f03=_0x530ebc[_0x5458df(0xf9)][_0x5458df(0x15b)](_0x349237=>{var _0x39a50e=_0x5458df;_0x349237[_0x39a50e(0x114)]==_0x41c12d['product_name']&&_0x349237[_0x39a50e(0x1a4)]==_0x41c12d[_0x39a50e(0x1bc)]&&_0x349237['expiry_date']==_0x41c12d[_0x39a50e(0x144)]&&_0x349237[_0x39a50e(0x157)]==_0x41c12d['production_date']&&_0x349237['batch_code']==_0x41c12d[_0x39a50e(0xf3)]&&_0x349237[_0x39a50e(0x169)]==_0x41c12d[_0x39a50e(0x11b)]&&(typeof _0x41c12d[_0x39a50e(0x12d)]=='undefined'?(console[_0x39a50e(0x12a)](_0x39a50e(0x1ca),_0x349237[_0x39a50e(0x132)]+_0x39a50e(0x17d)+_0x349237[_0x39a50e(0x1a9)]+_0x39a50e(0x195)+Math[_0x39a50e(0x10a)](_0x349237[_0x39a50e(0x132)])+Math[_0x39a50e(0x10a)](_0x41c12d[_0x39a50e(0x14f)])),_0x349237[_0x39a50e(0x132)]=Math['abs'](_0x349237[_0x39a50e(0x132)])+Math[_0x39a50e(0x10a)](_0x41c12d[_0x39a50e(0x14f)])):_0x349237['product_stock']=Math[_0x39a50e(0x10a)](_0x349237[_0x39a50e(0x132)])+Math['abs'](_0x41c12d[_0x39a50e(0x14f)]),_0x3f9c0b++);});_0x3f9c0b=='0'&&(_0x530ebc[_0x5458df(0xf9)]=_0x530ebc[_0x5458df(0xf9)][_0x5458df(0x15f)]({'product_name':_0x41c12d[_0x5458df(0x114)],'product_stock':_0x41c12d['to_quantity'],'bay':_0x41c12d['to_bay'],'product_code':_0x41c12d[_0x5458df(0x1c4)],'primary_code':_0x41c12d['primary_code'],'secondary_code':_0x41c12d[_0x5458df(0x110)],'expiry_date':_0x41c12d[_0x5458df(0x144)],'production_date':_0x41c12d[_0x5458df(0x157)],'maxProducts':_0x41c12d[_0x5458df(0x186)],'batch_code':_0x41c12d[_0x5458df(0xf3)],'secondary_unit':_0x41c12d[_0x5458df(0x165)],'unit':_0x41c12d[_0x5458df(0x10f)],'maxProducts':_0x41c12d[_0x5458df(0x186)],'maxPerUnit':_0x41c12d['maxPerUnit'],'invoice':_0x41c12d[_0x5458df(0x11b)]}));}return _0x530ebc;});Promise[_0x4f947(0x1b1)](_0xd31f99)['then'](async _0x25fb1=>{var _0xe2f5d7=_0x4f947;try{for(const _0x29cdc6 of _0x25fb1){await warehouse['updateOne']({'_id':_0x29cdc6[_0xe2f5d7(0x1a9)]},{'$addToSet':{'product_details':{'$each':_0x29cdc6[_0xe2f5d7(0xf9)]}}});}_0x32a3d2[_0xe2f5d7(0x103)]='True';const _0x3c7e3b=await _0x32a3d2[_0xe2f5d7(0x16f)](),_0x5d00f7=await master_shop[_0xe2f5d7(0x1b2)](),_0x4a3208=await email_settings[_0xe2f5d7(0x147)](),_0x26dc91=await supervisor_settings[_0xe2f5d7(0x1b2)]();var _0x136cb3=_0x32a3d2[_0xe2f5d7(0x1c5)],_0x1301b2='',_0x12c796;for(_0x12c796 in _0x136cb3){var _0xeae798='FG';_0x32a3d2[_0xe2f5d7(0x140)]==_0xe2f5d7(0x162)&&(_0xeae798='DG'),_0x1301b2+=_0xe2f5d7(0x136)+_0xe2f5d7(0x12f)+_0x136cb3[_0x12c796]['product_name']+_0xe2f5d7(0xfa)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x136cb3[_0x12c796][_0xe2f5d7(0x1c4)]+'</td>'+_0xe2f5d7(0x12f)+_0x136cb3[_0x12c796][_0xe2f5d7(0x14f)]+_0xe2f5d7(0xfa)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x136cb3[_0x12c796]['unit']+_0xe2f5d7(0xfa)+_0xe2f5d7(0x12f)+_0x136cb3[_0x12c796][_0xe2f5d7(0x165)]+_0xe2f5d7(0xfa)+_0xe2f5d7(0x12f)+_0x32a3d2['to_warehouse']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x136cb3[_0x12c796][_0xe2f5d7(0x159)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xeae798+_0x136cb3[_0x12c796][_0xe2f5d7(0x1bc)]+_0xe2f5d7(0xfa)+_0xe2f5d7(0x13d);}let _0x2dc13f=nodemailer[_0xe2f5d7(0x1a1)]({'host':_0x4a3208[_0xe2f5d7(0x172)],'port':Number(_0x4a3208[_0xe2f5d7(0x187)]),'secure':![],'auth':{'user':_0x4a3208['email'],'pass':_0x4a3208[_0xe2f5d7(0x12c)]}}),_0x34eb8f={'from':_0x4a3208['email'],'to':_0x26dc91[0x0]['FGSEmail'],'subject':_0xe2f5d7(0x10d),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0xe2f5d7(0x116)+_0x5d00f7[0x0][_0xe2f5d7(0x1c8)],'cid':_0xe2f5d7(0x182)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0xe2f5d7(0x160)+_0xe2f5d7(0x108)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0xe2f5d7(0x108)+_0xe2f5d7(0x184)+_0xe2f5d7(0x111)+_0xe2f5d7(0x108)+_0xe2f5d7(0x148)+_0x5d00f7[0x0]['site_title']+_0xe2f5d7(0x126)+_0xe2f5d7(0x111)+_0xe2f5d7(0x111)+_0xe2f5d7(0x1b3)+_0xe2f5d7(0x108)+_0xe2f5d7(0x1b8)+_0xe2f5d7(0x175)+_0x32a3d2[_0xe2f5d7(0x169)]+'\x20'+_0xe2f5d7(0x17c)+_0xe2f5d7(0x181)+_0x32a3d2[_0xe2f5d7(0x16d)]+'\x20'+'</span>'+_0xe2f5d7(0x150)+_0xe2f5d7(0x111)+_0xe2f5d7(0x1c3)+_0xe2f5d7(0x171)+_0xe2f5d7(0x136)+_0xe2f5d7(0x189)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0xe2f5d7(0x14e)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0xe2f5d7(0x18a)+_0xe2f5d7(0x19a)+_0xe2f5d7(0x1a7)+_0xe2f5d7(0x13d)+_0xe2f5d7(0x142)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x1301b2+'\x20'+_0xe2f5d7(0xfc)+_0xe2f5d7(0x145)+'<div>'+'<strong>\x20Regards\x20</strong>'+_0xe2f5d7(0x12e)+_0x5d00f7[0x0][_0xe2f5d7(0x120)]+'</h5>'+_0xe2f5d7(0x111)+_0xe2f5d7(0x111)+_0xe2f5d7(0x102)};_0x2dc13f['sendMail'](_0x34eb8f,function(_0x30218e,_0x3ee2be){var _0x5a9a4f=_0xe2f5d7;_0x30218e?(console[_0x5a9a4f(0x12a)](_0x30218e),console[_0x5a9a4f(0x12a)](_0x5a9a4f(0x1aa))):console['log'](_0x5a9a4f(0x1b9));}),_0x230467[_0xe2f5d7(0x18e)]('success',_0xe2f5d7(0x173)),_0x16738e[_0xe2f5d7(0x197)](_0xe2f5d7(0x10b)+_0x3c7e3b['_id']);}catch(_0x5ae655){console[_0xe2f5d7(0xfd)](_0x5ae655),_0x16738e[_0xe2f5d7(0x122)](0x1f4)['json']({'error':_0xe2f5d7(0x1be)});}})[_0x4f947(0x1ba)](_0x160ff3=>{var _0x282e7b=_0x4f947;console[_0x282e7b(0xfd)](_0x160ff3),_0x16738e[_0x282e7b(0x122)](0x1f4)['json']({'error':_0x282e7b(0x100)});});}catch(_0x3048c8){console[_0x4f947(0xfd)](_0x3048c8),_0x16738e['status'](0x1f4)['json']({'error':_0x4f947(0x185)});}})['catch'](_0x2df107=>{var _0x196cd7=_0x43dcd8;console[_0x196cd7(0xfd)](_0x2df107),_0x16738e[_0x196cd7(0x122)](0x1f4)[_0x196cd7(0x177)]({'error':_0x196cd7(0x100)});});}catch(_0x44dcac){_0x16738e[_0x43dcd8(0x177)]({'message':_0x44dcac[_0x43dcd8(0x1b6)]});}});function BayBinSelected(_0x42f513,_0x343832){var _0x24d3ee=a0_0x5cbaf5,_0x363568=[];let _0xde4ce2=[];var _0x3773b9=[];if(_0x42f513==_0x24d3ee(0x162)){switch(_0x343832){case'Rack\x201':_0x363568=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x363568=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3773b9=['DG'];}else{if(_0x42f513==_0x24d3ee(0x1ad)){switch(_0x343832){case _0x24d3ee(0x158):_0x363568=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x363568=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3773b9=['FG'];}}return{'levels':_0x363568,'identify':_0x3773b9};}router[a0_0x5cbaf5(0x115)]('/view/:id',auth,async(_0x33a718,_0x375fa7)=>{var _0xb9e9e7=a0_0x5cbaf5;try{const {username:_0x409e35,email:_0x101d7c,role:_0x2dd59b}=_0x33a718[_0xb9e9e7(0x119)],_0x33d890=_0x33a718[_0xb9e9e7(0x119)],_0x509c95=await profile[_0xb9e9e7(0x147)]({'email':_0x33d890[_0xb9e9e7(0x192)]}),_0x5c3b3d=await master_shop[_0xb9e9e7(0x1b2)](),_0x219686=await transfers_finished[_0xb9e9e7(0x199)](_0x33a718[_0xb9e9e7(0x141)]['id']);let _0x222f53=new Date(_0x219686[_0xb9e9e7(0x144)]),_0x2286d6=('0'+_0x222f53[_0xb9e9e7(0x1af)]())[_0xb9e9e7(0x11e)](-0x2),_0x25c8ea=('0'+(_0x222f53[_0xb9e9e7(0x19b)]()+0x1))[_0xb9e9e7(0x11e)](-0x2),_0x55058a=_0x222f53[_0xb9e9e7(0x14a)](),_0x18dd5e=_0x55058a+'-'+_0x25c8ea+'-'+_0x2286d6,_0x40b7dc;if(_0x33d890['role']==_0xb9e9e7(0x13b)){const _0x2e2a43=await staff['findOne']({'email':_0x33d890['email']});_0x40b7dc=await warehouse[_0xb9e9e7(0x1b2)]({'status':_0xb9e9e7(0x190),'name':_0x2e2a43[_0xb9e9e7(0x104)],'warehouse_category':_0xb9e9e7(0x1cc)});}else _0x40b7dc=await warehouse[_0xb9e9e7(0x1b2)]({'status':_0xb9e9e7(0x190),'warehouse_category':_0xb9e9e7(0x1cc)});const _0x29c53a=await warehouse[_0xb9e9e7(0x134)]([{'$match':{'name':_0x219686[_0xb9e9e7(0x13f)],'room':_0x219686['from_room']}},{'$unwind':_0xb9e9e7(0x14d)},{'$group':{'_id':_0xb9e9e7(0x18f),'name':{'$first':_0xb9e9e7(0x11d)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0xb9e9e7(0x16e)},'bin':{'$first':_0xb9e9e7(0x15c)},'type':{'$first':_0xb9e9e7(0x176)},'floorlevel':{'$first':_0xb9e9e7(0x18b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xb9e9e7(0x1a3)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xb9e9e7(0x152)}}}]);var _0x405ac2=[0x1,0x2,0x3,0x4],_0xd84f42=['A','B','C','D','E','F','G','H','I','J'],_0x47ceff=[_0xb9e9e7(0x17b),'Enclosed'];const _0x249dd9=await product[_0xb9e9e7(0x1b2)]({}),_0x22cee8=BayBinSelected(_0x219686['to_warehouse'],_0x219686[_0xb9e9e7(0x166)]);if(_0x5c3b3d[0x0][_0xb9e9e7(0x18c)]=='English\x20(US)'){var _0x5ad46d=users['English'];console[_0xb9e9e7(0x12a)](_0x5ad46d);}else{if(_0x5c3b3d[0x0]['language']==_0xb9e9e7(0x154))var _0x5ad46d=users[_0xb9e9e7(0x154)];else{if(_0x5c3b3d[0x0]['language']==_0xb9e9e7(0x117))var _0x5ad46d=users[_0xb9e9e7(0x117)];else{if(_0x5c3b3d[0x0]['language']=='Spanish')var _0x5ad46d=users['Spanish'];else{if(_0x5c3b3d[0x0]['language']==_0xb9e9e7(0x10c))var _0x5ad46d=users[_0xb9e9e7(0x10c)];else{if(_0x5c3b3d[0x0][_0xb9e9e7(0x18c)]==_0xb9e9e7(0x15a))var _0x5ad46d=users['Portuguese'];else{if(_0x5c3b3d[0x0]['language']==_0xb9e9e7(0x15d))var _0x5ad46d=users[_0xb9e9e7(0x15d)];else{if(_0x5c3b3d[0x0][_0xb9e9e7(0x18c)]==_0xb9e9e7(0x183))var _0x5ad46d=users[_0xb9e9e7(0xf6)];}}}}}}}_0x375fa7[_0xb9e9e7(0xf0)](_0xb9e9e7(0x125),{'success':_0x33a718[_0xb9e9e7(0x18e)](_0xb9e9e7(0x179)),'errors':_0x33a718[_0xb9e9e7(0x18e)](_0xb9e9e7(0x11c)),'role':_0x33d890,'profile':_0x509c95,'master_shop':_0x5c3b3d,'warehouse':_0x40b7dc,'transfer':_0x219686,'stock':_0x29c53a,'unit':_0x249dd9,'language':_0x5ad46d,'levels':_0x405ac2,'Isle':_0xd84f42,'rooms_data':_0x47ceff,'ed_fullDate':_0x18dd5e,'dataSelected':_0x22cee8});}catch(_0x48ea27){console['log'](_0x48ea27);}}),router['post'](a0_0x5cbaf5(0x1c1),auth,async(_0x1f146e,_0x57087e)=>{var _0x424e40=a0_0x5cbaf5;try{const _0x27911f=_0x1f146e[_0x424e40(0x141)]['id'];console[_0x424e40(0x12a)](_0x1f146e[_0x424e40(0xf7)]);const _0x1d1871=await transfers_finished[_0x424e40(0x199)](_0x27911f);console[_0x424e40(0x12a)](_0x424e40(0x168),_0x1d1871);const {date:_0x47648a,from_warehouse:_0x66bdc1,FromRoom_name:_0x2da011,to_warehouse:_0x3461d8,ToRoom_name:_0x54cc8b,prod_name:_0x4c4e26,from_prod_qty:_0x1f4b16,from_prod_level:_0x3081fb,from_prod_isle:_0x3f0c61,from_prod_pallet:_0x38d581,to_prod_qty:_0x52189b,to_prod_level:_0x374b98,to_prod_isle:_0x1744d6,to_prod_pallet:_0x3c09ff,primary_code:_0x5e5b7c,secondary_code:_0x889cb5,product_code3:_0x8ec372,note:_0x1e170b,invoice:_0x5e8879,expiry_date:_0x594b5f}=_0x1f146e[_0x424e40(0xf7)];if(typeof _0x4c4e26==_0x424e40(0x130))var _0x1948a7=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0x123)]],_0x47f975=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0xff)]],_0x367289=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0x13a)]],_0x583bd8=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0x174)]],_0x169584=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0x1b5)]],_0x159dd0=[_0x1f146e['body'][_0x424e40(0xf4)]],_0x234627=[_0x1f146e[_0x424e40(0xf7)]['secondary_code']],_0x2ac714=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0x1c6)]],_0x4a7bac=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0xfb)]],_0x811bd4=[_0x1f146e['body'][_0x424e40(0x10f)]],_0x118eb4=[_0x1f146e[_0x424e40(0xf7)][_0x424e40(0x165)]],_0x3a488e=[_0x1f146e['body'][_0x424e40(0xf3)]],_0x1ad4b1=[_0x1f146e[_0x424e40(0xf7)]['expiry_date']];else var _0x1948a7=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0x123)]],_0x47f975=[..._0x1f146e['body'][_0x424e40(0xff)]],_0x367289=[..._0x1f146e[_0x424e40(0xf7)]['from_prod_level']],_0x583bd8=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0x174)]],_0x169584=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0x1b5)]],_0x159dd0=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0xf4)]],_0x234627=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0x110)]],_0x2ac714=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0x1c6)]],_0x4a7bac=[..._0x1f146e[_0x424e40(0xf7)]['MaxStocks_data2']],_0x811bd4=[..._0x1f146e['body'][_0x424e40(0x10f)]],_0x118eb4=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0x165)]],_0x3a488e=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0xf3)]],_0x1ad4b1=[..._0x1f146e[_0x424e40(0xf7)][_0x424e40(0x144)]];const _0x1e0204=_0x1948a7[_0x424e40(0x15b)](_0x20c791=>{return _0x20c791={'product_name':_0x20c791};});_0x47f975['forEach']((_0x2f1b2c,_0x1d7667)=>{var _0x2c29bd=_0x424e40;_0x1e0204[_0x1d7667][_0x2c29bd(0x143)]=_0x2f1b2c;}),_0x367289[_0x424e40(0x16a)]((_0x550606,_0x57da07)=>{var _0x15ed51=_0x424e40;_0x1e0204[_0x57da07][_0x15ed51(0x1bd)]=_0x550606;}),_0x583bd8[_0x424e40(0x16a)]((_0x31b024,_0x3f059c)=>{var _0x3894d6=_0x424e40;_0x1e0204[_0x3f059c][_0x3894d6(0x14f)]=_0x31b024;}),_0x169584['forEach']((_0x25caf9,_0x14cc23)=>{var _0x598b4c=_0x424e40;_0x1e0204[_0x14cc23][_0x598b4c(0x1bc)]=_0x25caf9;}),_0x159dd0[_0x424e40(0x16a)]((_0x2044d0,_0x68df2e)=>{var _0x3c1daa=_0x424e40;_0x1e0204[_0x68df2e][_0x3c1daa(0xf4)]=_0x2044d0;}),_0x234627[_0x424e40(0x16a)]((_0x4afb3e,_0x58e453)=>{var _0x1fb140=_0x424e40;_0x1e0204[_0x58e453][_0x1fb140(0x110)]=_0x4afb3e;}),_0x2ac714[_0x424e40(0x16a)]((_0x544f36,_0xb55486)=>{var _0xd5b4e9=_0x424e40;_0x1e0204[_0xb55486][_0xd5b4e9(0x1c4)]=_0x544f36;}),_0x4a7bac[_0x424e40(0x16a)]((_0x56b0a0,_0x2c50ff)=>{_0x1e0204[_0x2c50ff]['maxProducts']=_0x56b0a0;}),_0x811bd4[_0x424e40(0x16a)]((_0x2353d9,_0xb81a38)=>{var _0x3074ee=_0x424e40;_0x1e0204[_0xb81a38][_0x3074ee(0x10f)]=_0x2353d9;}),_0x118eb4['forEach']((_0x5b129b,_0x2ddc48)=>{var _0x541552=_0x424e40;_0x1e0204[_0x2ddc48][_0x541552(0x165)]=_0x5b129b;}),_0x3a488e['forEach']((_0x188c0e,_0x44a04f)=>{_0x1e0204[_0x44a04f]['batch_code']=_0x188c0e;}),_0x1ad4b1[_0x424e40(0x16a)]((_0x29aca1,_0x3ca649)=>{var _0x1e7d5c=_0x424e40;_0x1e0204[_0x3ca649][_0x1e7d5c(0x144)]=_0x29aca1;});const _0x4ef3bf=_0x1e0204[_0x424e40(0x112)](_0x7ccb2e=>_0x7ccb2e['to_quantity']!=='0'&&_0x7ccb2e[_0x424e40(0x14f)]!==''||_0x7ccb2e['to_floorlevel']!=='0'&&_0x7ccb2e['to_floorlevel']!=='');var _0x2b8ff7=0x0;_0x4ef3bf[_0x424e40(0x16a)](_0xd48e02=>{var _0x32124d=_0x424e40;parseInt(_0xd48e02[_0x32124d(0x143)])<parseInt(_0xd48e02['to_quantity'])&&_0x2b8ff7++;});if(_0x2b8ff7!=0x0)return _0x1f146e['flash'](_0x424e40(0x11c),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x57087e[_0x424e40(0x197)]('back');const _0x58205b=await warehouse[_0x424e40(0x147)]({'name':_0x1d1871['from_warehouse'],'room':_0x1d1871['from_room']});_0x1d1871[_0x424e40(0x1c5)]['forEach'](_0x4a7ff4=>{var _0x249c51=_0x424e40;if(_0x4a7ff4[_0x249c51(0x14f)]>0x0){const _0x57da10=_0x58205b['product_details']['map'](_0x14bfe1=>{var _0x2afc95=_0x249c51;_0x14bfe1[_0x2afc95(0x114)]==_0x4a7ff4[_0x2afc95(0x114)]&&_0x14bfe1[_0x2afc95(0x1a4)]==_0x4a7ff4[_0x2afc95(0x1bd)]&&(_0x14bfe1[_0x2afc95(0x132)]=parseInt(_0x14bfe1[_0x2afc95(0x132)])+parseInt(_0x4a7ff4['to_quantity']));});}}),await _0x58205b['save']();const _0x1af05f=await warehouse[_0x424e40(0x147)]({'name':_0x1d1871[_0x424e40(0x140)],'room':_0x1d1871[_0x424e40(0x166)]});_0x1d1871[_0x424e40(0x1c5)][_0x424e40(0x16a)](_0x3546ed=>{var _0x4ffb73=_0x424e40;if(_0x3546ed[_0x4ffb73(0x14f)]>0x0){const _0x290ce4=_0x1af05f[_0x4ffb73(0xf9)][_0x4ffb73(0x15b)](_0x926b5=>{var _0xdab92d=_0x4ffb73;_0x926b5[_0xdab92d(0x114)]==_0x3546ed[_0xdab92d(0x114)]&&_0x926b5[_0xdab92d(0x1a4)]==_0x3546ed['to_bay']&&(_0x926b5[_0xdab92d(0x132)]=parseInt(_0x926b5[_0xdab92d(0x132)])-parseInt(_0x3546ed['to_quantity']));});}}),await _0x1af05f[_0x424e40(0x16f)](),_0x1d1871[_0x424e40(0x16d)]=_0x47648a,_0x1d1871['from_warehouse']=_0x66bdc1,_0x1d1871['to_warehouse']=_0x3461d8,_0x1d1871[_0x424e40(0x1c5)]=_0x4ef3bf,_0x1d1871[_0x424e40(0x11f)]=_0x1e170b,_0x1d1871[_0x424e40(0x169)]=_0x5e8879;const _0x1d5dbe=await _0x1d1871[_0x424e40(0x16f)](),_0x1c2c02=await warehouse['findOne']({'name':_0x66bdc1,'room':_0x2da011});_0x1d5dbe['product'][_0x424e40(0x16a)](_0x3e516a=>{var _0x57c217=_0x424e40;if(_0x3e516a['to_quantity']>0x0){const _0x1fc7e2=_0x1c2c02[_0x57c217(0xf9)]['map'](_0x423893=>{var _0x286cfc=_0x57c217;_0x423893[_0x286cfc(0x114)]==_0x3e516a[_0x286cfc(0x114)]&&_0x423893[_0x286cfc(0x1a4)]==_0x3e516a[_0x286cfc(0x1bd)]&&(_0x423893[_0x286cfc(0x132)]=parseInt(_0x423893[_0x286cfc(0x132)])-parseInt(_0x3e516a['to_quantity']));});}}),await _0x1c2c02[_0x424e40(0x16f)]();const _0x30e2fa=await warehouse['findOne']({'name':_0x3461d8,'room':_0x54cc8b});_0x1d5dbe[_0x424e40(0x1c5)]['forEach'](_0x129ddf=>{var _0x51c67e=_0x424e40;if(_0x129ddf[_0x51c67e(0x14f)]>0x0){var _0x360ee5=0x0;const _0x1a5fff=_0x30e2fa[_0x51c67e(0xf9)][_0x51c67e(0x15b)](_0x1561c3=>{var _0x2709a8=_0x51c67e;_0x1561c3['product_name']==_0x129ddf[_0x2709a8(0x114)]&&_0x1561c3[_0x2709a8(0x1a4)]==_0x129ddf[_0x2709a8(0x1bc)]&&(_0x1561c3[_0x2709a8(0x132)]=parseInt(_0x1561c3[_0x2709a8(0x132)])+parseInt(_0x129ddf['to_quantity']),_0x360ee5++);});_0x360ee5=='0'&&(_0x30e2fa[_0x51c67e(0xf9)]=_0x30e2fa[_0x51c67e(0xf9)][_0x51c67e(0x15f)]({'product_name':_0x129ddf[_0x51c67e(0x114)],'product_stock':_0x129ddf[_0x51c67e(0x14f)],'bay':_0x129ddf[_0x51c67e(0x1bc)],'product_code':_0x129ddf[_0x51c67e(0x1c4)],'primary_code':_0x129ddf[_0x51c67e(0xf4)],'secondary_code':_0x129ddf['secondary_code'],'maxProducts':_0x129ddf['maxProducts']}));}}),await _0x30e2fa[_0x424e40(0x16f)](),_0x1f146e[_0x424e40(0x18e)]('success',_0x424e40(0x101)),_0x57087e['redirect'](_0x424e40(0x156));}catch(_0x3d4b9b){console['log'](_0x3d4b9b);}}),router['post'](a0_0x5cbaf5(0x135),async(_0x435b1e,_0x52ba96)=>{var _0x293cfc=a0_0x5cbaf5;const {FromWareHouse:_0x522102,FromRoom:_0x116439,ToWarehouse:_0x4b2d1a,ToRoom:_0x18614d,primary_code:_0xdfde1,Roomslist:_0xa40b56}=_0x435b1e[_0x293cfc(0xf7)],_0x234d9b=_0xa40b56['split'](','),_0x364e92=[];async function _0x3149ba(_0x3e0fc0){var _0x1ea757=_0x293cfc;const _0x2cba85=await warehouse[_0x1ea757(0x134)]([{'$match':{'name':_0x522102,'room':_0x3e0fc0}},{'$unwind':_0x1ea757(0x14d)},{'$match':{'product_details.primary_code':_0xdfde1}},{'$group':{'_id':_0x1ea757(0x18f),'name':{'$first':_0x1ea757(0x11d)},'instock':{'$first':_0x1ea757(0x188)},'primary_code':{'$first':_0x1ea757(0x1a6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1ea757(0x1a3)},'level':{'$first':_0x1ea757(0x16e)},'isle':{'$first':_0x1ea757(0x15c)},'type':{'$first':_0x1ea757(0x176)},'pallet':{'$first':_0x1ea757(0x18b)},'unit':{'$first':_0x1ea757(0x146)},'secondary_unit':{'$first':_0x1ea757(0x12b)},'storage':{'$first':_0x1ea757(0x1c9)},'rack':{'$first':_0x1ea757(0x152)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1ea757(0x138)},'maxPerUnit':{'$first':_0x1ea757(0x105)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x1ea757(0x164)}}}]),_0x4147cf=await warehouse['aggregate']([{'$match':{'name':_0x522102,'room':_0x3e0fc0}},{'$unwind':_0x1ea757(0x14d)},{'$match':{'product_details.secondary_code':_0xdfde1}},{'$group':{'_id':_0x1ea757(0x18f),'name':{'$first':_0x1ea757(0x11d)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1ea757(0x1a6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1ea757(0x1a3)},'level':{'$first':_0x1ea757(0x16e)},'isle':{'$first':_0x1ea757(0x15c)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x1ea757(0x146)},'secondary_unit':{'$first':_0x1ea757(0x12b)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1ea757(0x152)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x1ea757(0x105)},'roomNamed':{'$first':_0x1ea757(0x1c2)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x1ea757(0x164)}}}]);if(_0x2cba85['length']>0x0)_0x364e92[_0x1ea757(0x13c)](_0x2cba85);else _0x4147cf[_0x1ea757(0x1bb)]>0x0&&_0x364e92['push'](_0x4147cf);}const _0x52e5a0=_0x234d9b['map'](_0x185081=>_0x3149ba(_0x185081));await Promise['all'](_0x52e5a0),_0x52ba96[_0x293cfc(0x177)](_0x364e92);}),router[a0_0x5cbaf5(0x11a)]('/barcode_scanner2',async(_0x4fd2f7,_0x20c920)=>{var _0x9aca4b=a0_0x5cbaf5;try{const {FromWareHouse:_0x471d7c,FromRoom:_0x3c1480,ToWarehouse:_0x5601a9,ToRoom:_0x2d654a,secondary_code:_0x44960e}=_0x4fd2f7[_0x9aca4b(0xf7)],_0x411440=await warehouse['aggregate']([{'$match':{'name':_0x471d7c}},{'$unwind':_0x9aca4b(0x14d)},{'$match':{'product_details.secondary_code':_0x44960e}},{'$group':{'_id':_0x9aca4b(0x18f),'name':{'$first':_0x9aca4b(0x11d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x9aca4b(0xf2)},'product_code':{'$first':_0x9aca4b(0x1a3)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x9aca4b(0x1a5)},'isle':{'$first':_0x9aca4b(0x137)},'pallet':{'$first':_0x9aca4b(0x196)},'maxProducts':{'$first':_0x9aca4b(0x127)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':_0x9aca4b(0x17e)},'production_date':{'$first':_0x9aca4b(0x16b)}}}]);_0x20c920[_0x9aca4b(0x122)](0xc8)[_0x9aca4b(0x177)](_0x411440);}catch(_0x395abf){_0x20c920[_0x9aca4b(0x122)](0x194)[_0x9aca4b(0x177)]({'message':_0x395abf[_0x9aca4b(0x1b6)]});}}),router[a0_0x5cbaf5(0x11a)](a0_0x5cbaf5(0x131),async(_0x5668ec,_0x55d34f)=>{var _0x3ffa5b=a0_0x5cbaf5;try{const {FromWareHouse:_0x56542a,FromRoom:_0x29d0d0,ToWarehouse:_0x3a10ba,ToRoom:_0x60f9d2,product_code:_0x23c6db}=_0x5668ec[_0x3ffa5b(0xf7)],_0x262bb8=await warehouse[_0x3ffa5b(0x134)]([{'$match':{'name':_0x56542a}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x23c6db}},{'$group':{'_id':_0x3ffa5b(0x18f),'name':{'$first':_0x3ffa5b(0x11d)},'primary_code':{'$first':_0x3ffa5b(0x1a6)},'secondary_code':{'$first':_0x3ffa5b(0xf2)},'product_code':{'$first':_0x3ffa5b(0x1a3)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x3ffa5b(0x1a5)},'isle':{'$first':_0x3ffa5b(0x137)},'pallet':{'$first':_0x3ffa5b(0x196)},'maxProducts':{'$first':_0x3ffa5b(0x127)},'unit':{'$first':_0x3ffa5b(0x146)}}}]);_0x55d34f[_0x3ffa5b(0x122)](0xc8)[_0x3ffa5b(0x177)](_0x262bb8);}catch(_0x2ff334){_0x55d34f[_0x3ffa5b(0x122)](0x194)['json']({'message':_0x2ff334[_0x3ffa5b(0x1b6)]});}}),router['post'](a0_0x5cbaf5(0x107),async(_0x1ec286,_0x19a345)=>{var _0x2b048c=a0_0x5cbaf5;const {productCode:_0x1089eb,bay:_0x8491f5,warehouses:_0x1412c0,room:_0xeebdbf}=_0x1ec286[_0x2b048c(0xf7)];console[_0x2b048c(0x12a)](_0x1ec286[_0x2b048c(0xf7)]);try{const _0x43652c=await warehouse[_0x2b048c(0x134)]([{'$match':{'name':_0x1412c0,'room':_0xeebdbf}},{'$unwind':_0x2b048c(0x14d)},{'$match':{'product_details.bay':parseInt(_0x8491f5)}},{'$group':{'_id':_0x2b048c(0x18f),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x2b048c(0x188)},'bay':{'$first':_0x2b048c(0x16e)},'maxProducts':{'$first':_0x2b048c(0x127)}}}]);_0x19a345[_0x2b048c(0x122)](0xc8)[_0x2b048c(0x177)](_0x43652c);}catch(_0x38647d){_0x19a345[_0x2b048c(0x122)](0x194)[_0x2b048c(0x177)]({'message':_0x38647d['message']});}}),module['exports']=router;