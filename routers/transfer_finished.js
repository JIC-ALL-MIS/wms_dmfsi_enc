var a0_0x10e693=a0_0x4e9a;(function(_0x5cd22d,_0x2bbfcb){var _0x30a933=a0_0x4e9a,_0x1f7336=_0x5cd22d();while(!![]){try{var _0x26eaa9=-parseInt(_0x30a933(0x151))/0x1*(-parseInt(_0x30a933(0x16c))/0x2)+-parseInt(_0x30a933(0x1df))/0x3+-parseInt(_0x30a933(0x174))/0x4+-parseInt(_0x30a933(0x206))/0x5+-parseInt(_0x30a933(0x18b))/0x6+-parseInt(_0x30a933(0x1cf))/0x7+parseInt(_0x30a933(0x14f))/0x8;if(_0x26eaa9===_0x2bbfcb)break;else _0x1f7336['push'](_0x1f7336['shift']());}catch(_0x7c0fd8){_0x1f7336['push'](_0x1f7336['shift']());}}}(a0_0x37e8,0xede19));function a0_0x4e9a(_0xbc0b17,_0x1551ec){var _0x37e8ec=a0_0x37e8();return a0_0x4e9a=function(_0x4e9a41,_0x569256){_0x4e9a41=_0x4e9a41-0x123;var _0x25672b=_0x37e8ec[_0x4e9a41];return _0x25672b;},a0_0x4e9a(_0xbc0b17,_0x1551ec);}const express=require(a0_0x10e693(0x15b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x10e693(0x159)),auth=require(a0_0x10e693(0x1e6)),users=require(a0_0x10e693(0x15c)),nodemailer=require('nodemailer');router[a0_0x10e693(0x189)](a0_0x10e693(0x1d8),auth,async(_0x2e02dd,_0x814745)=>{var _0x39bd38=a0_0x10e693;try{const {username:_0x42ec91,email:_0x927ecb,role:_0x2e811d}=_0x2e02dd[_0x39bd38(0x181)],_0x1cfc04=_0x2e02dd['user'],_0x2fa3ca=await profile[_0x39bd38(0x1c4)]({'email':_0x1cfc04[_0x39bd38(0x14b)]}),_0x3dfc67=await master_shop[_0x39bd38(0x1f0)]();let _0x4e8833;if(_0x1cfc04[_0x39bd38(0x169)]==_0x39bd38(0x1c0)){const _0x1d36b8=await staff[_0x39bd38(0x1c4)]({'email':_0x1cfc04[_0x39bd38(0x14b)]});_0x4e8833=await transfers_finished['find']({'from_warehouse':_0x1d36b8[_0x39bd38(0x1dd)]});}else _0x4e8833=await transfers_finished[_0x39bd38(0x1a1)]([{'$unwind':_0x39bd38(0x1b4)},{'$group':{'_id':_0x39bd38(0x139),'invoice':{'$first':_0x39bd38(0x186)},'date':{'$first':_0x39bd38(0x1fc)},'from_warehouse':{'$first':_0x39bd38(0x13a)},'to_warehouse':{'$first':_0x39bd38(0x202)},'from_room_name':{'$addToSet':_0x39bd38(0x171)},'to_room_name':{'$addToSet':_0x39bd38(0x1f1)},'finalize':{'$first':_0x39bd38(0x1aa)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3dfc67[0x0]['language']==_0x39bd38(0x142))var _0x58b6b7=users[_0x39bd38(0x13b)];else{if(_0x3dfc67[0x0][_0x39bd38(0x13c)]==_0x39bd38(0x145))var _0x58b6b7=users[_0x39bd38(0x145)];else{if(_0x3dfc67[0x0][_0x39bd38(0x13c)]=='German')var _0x58b6b7=users[_0x39bd38(0x163)];else{if(_0x3dfc67[0x0][_0x39bd38(0x13c)]=='Spanish')var _0x58b6b7=users[_0x39bd38(0x17d)];else{if(_0x3dfc67[0x0][_0x39bd38(0x13c)]==_0x39bd38(0x1ba))var _0x58b6b7=users[_0x39bd38(0x1ba)];else{if(_0x3dfc67[0x0][_0x39bd38(0x13c)]==_0x39bd38(0x1f9))var _0x58b6b7=users[_0x39bd38(0x16a)];else{if(_0x3dfc67[0x0][_0x39bd38(0x13c)]=='Chinese')var _0x58b6b7=users[_0x39bd38(0x12a)];else{if(_0x3dfc67[0x0]['language']==_0x39bd38(0x176))var _0x58b6b7=users[_0x39bd38(0x155)];}}}}}}}_0x814745[_0x39bd38(0x17c)](_0x39bd38(0x157),{'success':_0x2e02dd[_0x39bd38(0x12b)]('success'),'errors':_0x2e02dd[_0x39bd38(0x12b)](_0x39bd38(0x1bf)),'role':_0x1cfc04,'profile':_0x2fa3ca,'master_shop':_0x3dfc67,'transfer':_0x4e8833,'language':_0x58b6b7});}catch(_0x4d9756){console[_0x39bd38(0x1b8)](_0x4d9756);}});function a0_0x37e8(){var _0x225c52=['finalize','$product_details.expiry_date','filter','RoomAssigned','$to_warehouse','TRFF-','<html><head><title></title>','$product_details.invoice','2493585ViewXd','maxProducts','invoice','secondary_code','</td>','here2','to_quantity','$product_details.bay','site_title','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details._id','Chinese','flash','Finished\x20Goods','random','</body></html>','edit_transfer_finished_view','/view/:id','/picking_list/PDF_transfer/','$product_details.product_stock','\x20</h2>','product_code3','<hr\x20class=\x22my-3\x22>','<h5\x20style=\x22text-align:\x20left;\x22>','Enabled','to_floorlevel','$_id','$from_warehouse','English','language','<span\x20style=\x22float:\x20right;\x22>','$product_details.product_name','edit_transfer_finished','prod_name','\x20<=>\x20','English\x20(US)','from_prod_qty','date','Hindi','An\x20error\x20occurred\x20while\x20saving\x20data.','primary_code','$product_details.isle','$product_details.secondary_unit','body','email','Email\x20sent\x20successfully','$product_details.pallet','An\x20error\x20occurred.','51301568ycvZkt','/preview/:id','228634KxWCMP','To_invoice','<h2>\x20','/upload/','Arabic','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','transfer_finished','password','../models/all_models','from_quantity','express','../public/language/languages.json','product_stock','padStart','/view/add_transfer','slice','note','updateOne','German','</span>','to_room_name','$product_details.primary_code','<!DOCTYPE\x20html>','to_prod_level','role','Portuguese','$product_details.floorlevel','4rmOqKD','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','findById','from_warehouse','/../public','$product.from_room_name','from_prod_level','</tr>','7530304JqySUp','/barcode_scanner2','Arabic\x20(ae)','redirect','back','\x20Order\x20Date\x20:\x20','product_code','Transfer\x20Edit\x20Successfully','render','Spanish','Transfer\x20Mail','unit','product_details','user','from_bay','$product_details.bin','forEach','</div>','$invoice','<h5>','production_date','get','Rack\x202','7760478HolEJY','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','sendMail','/CheckingWarehouse','getFullYear','to_prod_qty','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','primary_unit','Transfer\x20Finalize\x20Successfully','transfer_data','Logo.png','Ambient','$product_details.secondary_code','post','QA\x20Warehouse','</head><body>','save','to_bay','$product_details.unit','_id','$product_details.batch_code','secondary_unit','aggregate','expiry_date','message','New_Qty_Converted','$product_details.product_code','$product_details.rack','$product_details','$product_details.maxProducts','DRY\x20GOODS','$finalize','\x20<>\x20','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','exports','then','Enclosed','$product_details.level','undefined','True','/transfer_finished/view','$product','from_invoice','id_transaction','to_room','log','createTransport','French','$room','json','<tbody\x20style=\x22text-align:\x20center;\x22>','MaxStocks_data','errors','staff','length','Rack\x201','product_name','findOne','batch_code','all','getMonth','<strong>\x20Regards\x20</strong>','catch','status','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','image','$product_details.type','map','10148663oNGSPb','prod_cat','port','MaxStocks_data2','$product_details.maxPerUnit','to_invoice','FROZEN\x20GOODS','$product_details.storage','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/view','error','<tr>','max','split','warehouse','success','2313264xnvlSY','logo','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','FGSEmail','</tbody>','product_date','to_warehouse','../middleware/auth','push','from_room','maxPerUnit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','product','getDate','from_room_name','ToRoomAssigned','<div>','find','$product.to_room_name','</table>','concat','params','abs','$product_details.production_date','toString','$name','Portuguese\x20(BR)','There\x27s\x20a\x20error\x20in\x20this\x20transaction','bay','$date','host'];a0_0x37e8=function(){return _0x225c52;};return a0_0x37e8();}async function getRandom8DigitNumber(){var _0x1a2ec5=a0_0x10e693;const _0x58782d=0x989680,_0x587ba6=0x5f5e0ff,_0x4cc9d4=Math['floor'](Math[_0x1a2ec5(0x12d)]()*(_0x587ba6-_0x58782d+0x1))+_0x58782d;var _0x52e14b;const _0x1363b7=await transfers_finished[_0x1a2ec5(0x1c4)]({'invoice':_0x1a2ec5(0x203)+_0x4cc9d4});return _0x1363b7&&_0x1363b7['length']>0x0?_0x52e14b='TRFF-'+_0x4cc9d4:_0x52e14b='TRFF-'+_0x4cc9d4,_0x52e14b;}router[a0_0x10e693(0x189)](a0_0x10e693(0x15f),auth,async(_0x323769,_0x1f490b)=>{var _0x43cbf1=a0_0x10e693;try{const {username:_0x28f2a8,email:_0x4e92eb,role:_0x5dd890}=_0x323769[_0x43cbf1(0x181)],_0x4dc178=_0x323769['user'],_0x499e74=await profile[_0x43cbf1(0x1c4)]({'email':_0x4dc178['email']}),_0x587bca=await master_shop[_0x43cbf1(0x1f0)]();let _0x36c64f;if(_0x4dc178[_0x43cbf1(0x169)]=='staff'){const _0x5b89fd=await staff[_0x43cbf1(0x1c4)]({'email':_0x4dc178['email']});_0x36c64f=await warehouse[_0x43cbf1(0x1a1)]([{'$match':{'status':'Enabled','name':_0x5b89fd[_0x43cbf1(0x1dd)],'warehouse_category':_0x43cbf1(0x12c),'name':{'$ne':_0x43cbf1(0x199)}}},{'$group':{'_id':_0x43cbf1(0x1f8),'name':{'$first':_0x43cbf1(0x1f8)}}}]);}else _0x36c64f=await warehouse['aggregate']([{'$match':{'status':_0x43cbf1(0x137),'warehouse_category':_0x43cbf1(0x12c),'name':{'$ne':_0x43cbf1(0x199)}}},{'$group':{'_id':_0x43cbf1(0x1f8),'name':{'$first':_0x43cbf1(0x1f8)}}}]);const _0x2edb2b=await transfers_finished['find']({}),_0x416e9a=_0x2edb2b[_0x43cbf1(0x1c1)]+0x1,_0x14bfb1=_0x43cbf1(0x203)+_0x416e9a[_0x43cbf1(0x1f7)]()[_0x43cbf1(0x15e)](0x5,'0');if(_0x587bca[0x0][_0x43cbf1(0x13c)]=='English\x20(US)')var _0x220501=users[_0x43cbf1(0x13b)];else{if(_0x587bca[0x0][_0x43cbf1(0x13c)]=='Hindi')var _0x220501=users[_0x43cbf1(0x145)];else{if(_0x587bca[0x0]['language']==_0x43cbf1(0x163))var _0x220501=users[_0x43cbf1(0x163)];else{if(_0x587bca[0x0][_0x43cbf1(0x13c)]==_0x43cbf1(0x17d))var _0x220501=users[_0x43cbf1(0x17d)];else{if(_0x587bca[0x0][_0x43cbf1(0x13c)]==_0x43cbf1(0x1ba))var _0x220501=users[_0x43cbf1(0x1ba)];else{if(_0x587bca[0x0][_0x43cbf1(0x13c)]==_0x43cbf1(0x1f9))var _0x220501=users[_0x43cbf1(0x16a)];else{if(_0x587bca[0x0]['language']==_0x43cbf1(0x12a))var _0x220501=users[_0x43cbf1(0x12a)];else{if(_0x587bca[0x0][_0x43cbf1(0x13c)]==_0x43cbf1(0x176))var _0x220501=users[_0x43cbf1(0x155)];}}}}}}}const _0x265f6c=getRandom8DigitNumber();_0x265f6c[_0x43cbf1(0x1ae)](_0x568b69=>{var _0x393614=_0x43cbf1;_0x1f490b['render']('add_transfer_finished',{'success':_0x323769[_0x393614(0x12b)]('success'),'errors':_0x323769['flash']('errors'),'role':_0x4dc178,'profile':_0x499e74,'master_shop':_0x587bca,'warehouse':_0x36c64f,'language':_0x220501,'invoice':_0x568b69});})[_0x43cbf1(0x1c9)](_0x34cb3a=>{var _0x4b55be=_0x43cbf1;_0x323769[_0x4b55be(0x12b)](_0x4b55be(0x1bf),_0x4b55be(0x1fa)),_0x1f490b[_0x4b55be(0x177)]('/transfer/view');});}catch(_0x30ed5e){console[_0x43cbf1(0x1b8)](_0x30ed5e);}}),router[a0_0x10e693(0x198)]('/view/add_transfer',auth,async(_0x18320f,_0x2a524b)=>{var _0x2accaf=a0_0x10e693;try{const {date:_0x253cd6,from_warehouse:_0x268085,FromRoom_name:_0x5d51ac,to_warehouse:_0x3c584c,ToRoom_name:_0xab5266,prod_name:_0x18438d,from_prod_qty:_0x125891,from_prod_level:_0xa6ce39,from_prod_isle:_0x11dfa1,from_prod_pallet:_0x5f2f8c,to_prod_qty:_0x210849,to_prod_level:_0x7a7ee5,to_prod_isle:_0x322b00,to_prod_pallet:_0x5cb714,primary_code:_0x555b6b,secondary_code:_0x3f2de1,product_code3:_0x5ad6e3,note:_0x45518c,MaxStocks_data2:_0xffbea1,invoice:_0x3461a7,expiry_date:_0x275771}=_0x18320f[_0x2accaf(0x14a)];if(typeof _0x18438d=='string')var _0x159392=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x140)]],_0xbf96b5=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x143)]],_0x5d8978=[_0x18320f['body'][_0x2accaf(0x172)]],_0x2d5e25=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1a4)]],_0x474fb2=[_0x18320f['body'][_0x2accaf(0x168)]],_0x527c47=[_0x18320f['body']['primary_code']],_0x3bae74=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x209)]],_0x290cf9=[_0x18320f[_0x2accaf(0x14a)]['product_code3']],_0x2f9b83=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1d2)]],_0x21c39f=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x192)]],_0x15d038=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1a0)]],_0x2a1917=[_0x18320f[_0x2accaf(0x14a)]['batch_code']],_0x18af5d=[_0x18320f['body'][_0x2accaf(0x1a2)]],_0x43369f=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1e4)]],_0x191f4a=[_0x18320f[_0x2accaf(0x14a)]['MaxStocks_data']],_0x3eb32a=[_0x18320f['body'][_0x2accaf(0x1e9)]],_0x2127a9=[_0x18320f['body'][_0x2accaf(0x1d0)]],_0xb06571=[_0x18320f[_0x2accaf(0x14a)]['RoomAssigned']],_0x35423f=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1ee)]],_0x1bbc3d=[_0x18320f[_0x2accaf(0x14a)]['from_invoice']],_0x53c960=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1d4)]],_0x295363=[_0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1b6)]];else var _0x159392=[..._0x18320f[_0x2accaf(0x14a)]['prod_name']],_0xbf96b5=[..._0x18320f[_0x2accaf(0x14a)]['from_prod_qty']],_0x5d8978=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x172)]],_0x2d5e25=[..._0x18320f['body'][_0x2accaf(0x1a4)]],_0x474fb2=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x168)]],_0x527c47=[..._0x18320f[_0x2accaf(0x14a)]['primary_code']],_0x3bae74=[..._0x18320f['body'][_0x2accaf(0x209)]],_0x290cf9=[..._0x18320f['body']['product_code3']],_0x2f9b83=[..._0x18320f[_0x2accaf(0x14a)]['MaxStocks_data2']],_0x21c39f=[..._0x18320f[_0x2accaf(0x14a)]['primary_unit']],_0x15d038=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1a0)]],_0x2a1917=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1c5)]],_0x18af5d=[..._0x18320f['body'][_0x2accaf(0x1a2)]],_0x43369f=[..._0x18320f['body'][_0x2accaf(0x1e4)]],_0x191f4a=[..._0x18320f['body'][_0x2accaf(0x1be)]],_0x3eb32a=[..._0x18320f['body']['maxPerUnit']],_0x2127a9=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1d0)]],_0xb06571=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x201)]],_0x35423f=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1ee)]],_0x1bbc3d=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1b5)]],_0x53c960=[..._0x18320f[_0x2accaf(0x14a)]['to_invoice']],_0x295363=[..._0x18320f[_0x2accaf(0x14a)][_0x2accaf(0x1b6)]];const _0x56505d=_0x159392['map'](_0x254408=>{return _0x254408={'product_name':_0x254408};});_0xbf96b5['forEach']((_0x1380bb,_0x233c43)=>{var _0x33049d=_0x2accaf;_0x56505d[_0x233c43][_0x33049d(0x15a)]=_0x1380bb;}),_0x5d8978[_0x2accaf(0x184)]((_0xeca2a5,_0x367bf0)=>{var _0x268dd4=_0x2accaf;_0x56505d[_0x367bf0][_0x268dd4(0x182)]=_0xeca2a5;}),_0x295363['forEach']((_0x42b695,_0x4245ad)=>{var _0x5191f2=_0x2accaf;_0x56505d[_0x4245ad][_0x5191f2(0x1b6)]=_0x42b695;}),_0x1bbc3d[_0x2accaf(0x184)]((_0x2b421f,_0x11a67e)=>{var _0x3b2c8e=_0x2accaf;_0x56505d[_0x11a67e][_0x3b2c8e(0x1b5)]=_0x2b421f;}),_0x53c960[_0x2accaf(0x184)]((_0x1cc69b,_0x171c8c)=>{var _0x8cd579=_0x2accaf;_0x56505d[_0x171c8c][_0x8cd579(0x152)]=_0x1cc69b;}),_0x2d5e25[_0x2accaf(0x184)]((_0x43fd97,_0xd2dfc1)=>{var _0x36d8a8=_0x2accaf;_0x56505d[_0xd2dfc1][_0x36d8a8(0x125)]=_0x43fd97;}),_0x474fb2[_0x2accaf(0x184)]((_0x4ea9eb,_0x1ffa48)=>{var _0x20f915=_0x2accaf;_0x56505d[_0x1ffa48][_0x20f915(0x19c)]=_0x4ea9eb;}),_0x527c47[_0x2accaf(0x184)]((_0x10f113,_0x129e09)=>{var _0x3bb18e=_0x2accaf;_0x56505d[_0x129e09][_0x3bb18e(0x147)]=_0x10f113;}),_0x3bae74[_0x2accaf(0x184)]((_0x2ebfc0,_0x176f93)=>{_0x56505d[_0x176f93]['secondary_code']=_0x2ebfc0;}),_0x290cf9[_0x2accaf(0x184)]((_0x4f7ba4,_0x11a39d)=>{_0x56505d[_0x11a39d]['product_code']=_0x4f7ba4;}),_0x2f9b83[_0x2accaf(0x184)]((_0x115d7f,_0xb337d)=>{var _0x3019ed=_0x2accaf;_0x56505d[_0xb337d][_0x3019ed(0x207)]=_0x115d7f;}),_0x21c39f['forEach']((_0x239675,_0x4a30a3)=>{var _0x35dc7d=_0x2accaf;_0x56505d[_0x4a30a3][_0x35dc7d(0x17f)]=_0x239675;}),_0x15d038[_0x2accaf(0x184)]((_0x538657,_0x568cf5)=>{var _0x5df905=_0x2accaf;_0x56505d[_0x568cf5][_0x5df905(0x1a0)]=_0x538657;}),_0x2a1917['forEach']((_0x329055,_0xf68270)=>{_0x56505d[_0xf68270]['batch_code']=_0x329055;}),_0x18af5d[_0x2accaf(0x184)]((_0x36a97e,_0x2f9a68)=>{var _0x29e2e7=_0x2accaf;_0x56505d[_0x2f9a68][_0x29e2e7(0x1a2)]=_0x36a97e;}),_0x43369f['forEach']((_0x4189fd,_0x385dd9)=>{var _0x3d0975=_0x2accaf;_0x56505d[_0x385dd9][_0x3d0975(0x188)]=_0x4189fd;}),_0x191f4a['forEach']((_0x2d81d8,_0xac967a)=>{var _0x4b7187=_0x2accaf;_0x56505d[_0xac967a][_0x4b7187(0x207)]=_0x2d81d8;}),_0x3eb32a[_0x2accaf(0x184)]((_0x2869c6,_0x2fc550)=>{var _0x48cea4=_0x2accaf;_0x56505d[_0x2fc550][_0x48cea4(0x1e9)]=_0x2869c6;}),_0x2127a9[_0x2accaf(0x184)]((_0x183f83,_0x316b5a)=>{_0x56505d[_0x316b5a]['prod_cat']=_0x183f83;}),_0xb06571['forEach']((_0x463658,_0xa02268)=>{_0x56505d[_0xa02268]['from_room_name']=_0x463658;}),_0x35423f[_0x2accaf(0x184)]((_0x532a7b,_0x4534da)=>{var _0x33d2d3=_0x2accaf;_0x56505d[_0x4534da][_0x33d2d3(0x165)]=_0x532a7b;});const _0x1c6834=_0x56505d['filter'](_0x9582b1=>_0x9582b1[_0x2accaf(0x125)]!=='0'&&_0x9582b1[_0x2accaf(0x125)]!==''||_0x9582b1['to_floorlevel']!=='0'&&_0x9582b1['to_floorlevel']!=='');var _0x512bc6=0x0;_0x1c6834[_0x2accaf(0x184)](_0x24a610=>{var _0x1ea5d0=_0x2accaf;parseInt(_0x24a610['from_quantity'])<parseInt(_0x24a610[_0x1ea5d0(0x125)])&&_0x512bc6++;});if(_0x512bc6!=0x0)return _0x18320f[_0x2accaf(0x12b)](_0x2accaf(0x1bf),_0x2accaf(0x191)),_0x2a524b[_0x2accaf(0x177)](_0x2accaf(0x178));const _0x468e7a=new transfers_finished({'date':_0x253cd6,'from_warehouse':_0x268085,'to_warehouse':_0x3c584c,'product':_0x1c6834,'note':_0x45518c,'invoice':_0x3461a7}),_0x260d84=await _0x468e7a[_0x2accaf(0x19b)]();_0x18320f[_0x2accaf(0x12b)](_0x2accaf(0x1de),'Product\x20Transfer\x20successfully'),_0x2a524b[_0x2accaf(0x177)]('/transfer_finished/preview/'+_0x260d84[_0x2accaf(0x19e)]);}catch(_0x34b866){console['log'](_0x34b866),_0x2a524b[_0x2accaf(0x1ca)](0xc8)[_0x2accaf(0x1bc)]({'errorMessage':_0x34b866[_0x2accaf(0x1a3)]});}}),router[a0_0x10e693(0x189)](a0_0x10e693(0x150),auth,async(_0x2d41d7,_0x42a9da)=>{var _0x21ee93=a0_0x10e693;try{const {username:_0x1feeb0,email:_0x5cdea8,role:_0x366d27}=_0x2d41d7[_0x21ee93(0x181)],_0x390df3=_0x2d41d7['user'],_0x25f933=await profile['findOne']({'email':_0x390df3[_0x21ee93(0x14b)]}),_0x4e6d29=await master_shop['find'](),_0x32e08a=await transfers_finished['findById'](_0x2d41d7['params']['id']);let _0x49b260;if(_0x390df3[_0x21ee93(0x169)]==_0x21ee93(0x1c0)){const _0x317d08=await staff[_0x21ee93(0x1c4)]({'email':_0x390df3[_0x21ee93(0x14b)]});_0x49b260=await warehouse[_0x21ee93(0x1f0)]({'status':_0x21ee93(0x137),'name':_0x317d08['warehouse'],'warehouse_category':_0x21ee93(0x12c)});}else _0x49b260=await warehouse['find']({'status':_0x21ee93(0x137),'warehouse_category':_0x21ee93(0x12c)});const _0x3afc72=await warehouse[_0x21ee93(0x1a1)]([{'$match':{'name':_0x32e08a[_0x21ee93(0x16f)],'warehouse_category':_0x21ee93(0x12c)}},{'$unwind':_0x21ee93(0x1a7)},{'$group':{'_id':_0x21ee93(0x129),'name':{'$first':_0x21ee93(0x13e)},'product_stock':{'$first':_0x21ee93(0x132)},'bay':{'$first':_0x21ee93(0x126)},'bin':{'$first':_0x21ee93(0x183)},'type':{'$first':_0x21ee93(0x1cd)},'floorlevel':{'$first':_0x21ee93(0x16b)},'primary_code':{'$first':_0x21ee93(0x166)},'secondary_code':{'$first':_0x21ee93(0x197)},'product_code':{'$first':_0x21ee93(0x1a5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x21ee93(0x1a6)},'expiry_date':{'$first':_0x21ee93(0x1ff)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x21ee93(0x1bb)},'warehoue_name':{'$first':_0x21ee93(0x1f8)}}}]),_0x4b8fe8=await product[_0x21ee93(0x1f0)]({});if(_0x4e6d29[0x0][_0x21ee93(0x13c)]=='English\x20(US)'){var _0x50f0d6=users[_0x21ee93(0x13b)];console['log'](_0x50f0d6);}else{if(_0x4e6d29[0x0]['language']=='Hindi')var _0x50f0d6=users[_0x21ee93(0x145)];else{if(_0x4e6d29[0x0][_0x21ee93(0x13c)]==_0x21ee93(0x163))var _0x50f0d6=users[_0x21ee93(0x163)];else{if(_0x4e6d29[0x0][_0x21ee93(0x13c)]==_0x21ee93(0x17d))var _0x50f0d6=users[_0x21ee93(0x17d)];else{if(_0x4e6d29[0x0]['language']==_0x21ee93(0x1ba))var _0x50f0d6=users[_0x21ee93(0x1ba)];else{if(_0x4e6d29[0x0][_0x21ee93(0x13c)]=='Portuguese\x20(BR)')var _0x50f0d6=users[_0x21ee93(0x16a)];else{if(_0x4e6d29[0x0][_0x21ee93(0x13c)]==_0x21ee93(0x12a))var _0x50f0d6=users[_0x21ee93(0x12a)];else{if(_0x4e6d29[0x0][_0x21ee93(0x13c)]==_0x21ee93(0x176))var _0x50f0d6=users[_0x21ee93(0x155)];}}}}}}}_0x42a9da['render'](_0x21ee93(0x12f),{'success':_0x2d41d7[_0x21ee93(0x12b)]('success'),'errors':_0x2d41d7['flash'](_0x21ee93(0x1bf)),'role':_0x390df3,'profile':_0x25f933,'master_shop':_0x4e6d29,'warehouse':_0x49b260,'transfer':_0x32e08a,'stock':_0x3afc72,'unit':_0x4b8fe8,'language':_0x50f0d6});}catch(_0x196d11){console[_0x21ee93(0x1b8)](_0x196d11);}}),router[a0_0x10e693(0x198)](a0_0x10e693(0x150),auth,async(_0x5a2762,_0x410e28)=>{var _0x4f5444=a0_0x10e693;try{const {invoice:_0x44760e,from_warehouse:_0x1daf76,FromRoom_name:_0x2450bd,to_warehouse:_0x40124e,ToRoom_name:_0x3e3af4}=_0x5a2762[_0x4f5444(0x14a)],_0x3f4eb9=await transfers_finished[_0x4f5444(0x16e)](_0x5a2762[_0x4f5444(0x1f4)]['id']),_0x46b137=_0x3f4eb9[_0x4f5444(0x1eb)][_0x4f5444(0x1ce)](async _0xa6713e=>{var _0x40b90d=_0x4f5444;if(_0xa6713e[_0x40b90d(0x125)]>0x0){var _0x51c752=await warehouse['findOne']({'name':_0x1daf76,'room':_0xa6713e[_0x40b90d(0x1ed)],'warehouse_category':_0x40b90d(0x12c)});const _0x5ee543=_0x51c752[_0x40b90d(0x180)][_0x40b90d(0x1ce)](_0x49ff74=>{var _0x58a715=_0x40b90d;_0x49ff74[_0x58a715(0x1c3)]==_0xa6713e[_0x58a715(0x1c3)]&&_0x49ff74[_0x58a715(0x1fb)]==_0xa6713e[_0x58a715(0x182)]&&_0x49ff74[_0x58a715(0x1a2)]==_0xa6713e[_0x58a715(0x1a2)]&&_0x49ff74[_0x58a715(0x188)]==_0xa6713e[_0x58a715(0x188)]&&_0x49ff74[_0x58a715(0x1c5)]==_0xa6713e[_0x58a715(0x1c5)]&&_0x49ff74[_0x58a715(0x208)]==_0xa6713e['from_invoice']&&(console[_0x58a715(0x1b8)]('here1',_0x49ff74['product_stock']),typeof _0xa6713e['id_transaction']==_0x58a715(0x1b1)?_0x49ff74[_0x58a715(0x15d)]=Math[_0x58a715(0x1db)](0x0,Math[_0x58a715(0x1f5)](_0x49ff74[_0x58a715(0x15d)])-Math[_0x58a715(0x1f5)](_0xa6713e[_0x58a715(0x125)])):_0x49ff74[_0x58a715(0x15d)]=Math['max'](0x0,Math[_0x58a715(0x1f5)](_0x49ff74[_0x58a715(0x15d)])-Math['abs'](_0xa6713e[_0x58a715(0x125)])));});}return _0x51c752;});Promise[_0x4f5444(0x1c6)](_0x46b137)[_0x4f5444(0x1ae)](async _0x25dd45=>{var _0x57f1c7=_0x4f5444;try{for(const _0x386117 of _0x25dd45){await _0x386117['save']();}const _0x227702=_0x3f4eb9[_0x57f1c7(0x1eb)][_0x57f1c7(0x1ce)](async _0x354916=>{var _0xdb69a1=_0x57f1c7,_0x475576=await warehouse[_0xdb69a1(0x1c4)]({'name':_0x40124e,'room':_0x354916['to_room_name']});if(_0x354916[_0xdb69a1(0x125)]>0x0){var _0x3cfc5b=0x0;const _0x1e60f6=_0x475576[_0xdb69a1(0x180)][_0xdb69a1(0x1ce)](_0x279cde=>{var _0x5f4788=_0xdb69a1;_0x279cde[_0x5f4788(0x1c3)]==_0x354916[_0x5f4788(0x1c3)]&&_0x279cde['bay']==_0x354916[_0x5f4788(0x19c)]&&_0x279cde[_0x5f4788(0x1a2)]==_0x354916[_0x5f4788(0x1a2)]&&_0x279cde[_0x5f4788(0x188)]==_0x354916['production_date']&&_0x279cde[_0x5f4788(0x1c5)]==_0x354916[_0x5f4788(0x1c5)]&&_0x279cde[_0x5f4788(0x208)]==_0x354916[_0x5f4788(0x152)]&&(typeof _0x354916[_0x5f4788(0x1b6)]=='undefined'?(console[_0x5f4788(0x1b8)](_0x5f4788(0x124),_0x279cde['product_stock']+_0x5f4788(0x1ab)+_0x279cde[_0x5f4788(0x19e)]+_0x5f4788(0x141)+Math[_0x5f4788(0x1f5)](_0x279cde[_0x5f4788(0x15d)])+Math[_0x5f4788(0x1f5)](_0x354916[_0x5f4788(0x125)])),_0x279cde[_0x5f4788(0x15d)]=Math[_0x5f4788(0x1f5)](_0x279cde[_0x5f4788(0x15d)])+Math[_0x5f4788(0x1f5)](_0x354916[_0x5f4788(0x125)])):_0x279cde[_0x5f4788(0x15d)]=Math['abs'](_0x279cde['product_stock'])+Math[_0x5f4788(0x1f5)](_0x354916[_0x5f4788(0x125)]),_0x3cfc5b++);});_0x3cfc5b=='0'&&(_0x475576[_0xdb69a1(0x180)]=_0x475576[_0xdb69a1(0x180)][_0xdb69a1(0x1f3)]({'product_name':_0x354916['product_name'],'product_stock':_0x354916[_0xdb69a1(0x125)],'bay':_0x354916[_0xdb69a1(0x19c)],'product_code':_0x354916[_0xdb69a1(0x17a)],'primary_code':_0x354916['primary_code'],'secondary_code':_0x354916[_0xdb69a1(0x209)],'expiry_date':_0x354916['expiry_date'],'production_date':_0x354916[_0xdb69a1(0x188)],'maxProducts':_0x354916['maxProducts'],'batch_code':_0x354916['batch_code'],'secondary_unit':_0x354916[_0xdb69a1(0x1a0)],'unit':_0x354916[_0xdb69a1(0x17f)],'maxProducts':_0x354916[_0xdb69a1(0x207)],'maxPerUnit':_0x354916[_0xdb69a1(0x1e9)],'invoice':_0x354916[_0xdb69a1(0x152)]}));}return _0x475576;});Promise[_0x57f1c7(0x1c6)](_0x227702)['then'](async _0x3aa205=>{var _0x129202=_0x57f1c7;try{for(const _0x45d8e8 of _0x3aa205){await warehouse[_0x129202(0x162)]({'_id':_0x45d8e8[_0x129202(0x19e)]},{'$addToSet':{'product_details':{'$each':_0x45d8e8[_0x129202(0x180)]}}});}_0x3f4eb9[_0x129202(0x1fe)]=_0x129202(0x1b2);const _0x5b90e4=await _0x3f4eb9['save'](),_0xb361b9=await master_shop[_0x129202(0x1f0)](),_0x11c39a=await email_settings[_0x129202(0x1c4)](),_0x2cc84a=await supervisor_settings[_0x129202(0x1f0)]();var _0x3bb1d5=_0x3f4eb9[_0x129202(0x1eb)],_0xa20673='',_0x201c72;for(_0x201c72 in _0x3bb1d5){var _0x4f0167='FG';_0x3f4eb9[_0x129202(0x1e5)]==_0x129202(0x1a9)&&(_0x4f0167='DG'),_0xa20673+=_0x129202(0x1da)+_0x129202(0x1ac)+_0x3bb1d5[_0x201c72][_0x129202(0x1c3)]+'</td>'+_0x129202(0x1ac)+_0x3bb1d5[_0x201c72][_0x129202(0x17a)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3bb1d5[_0x201c72][_0x129202(0x125)]+_0x129202(0x123)+_0x129202(0x1ac)+_0x3bb1d5[_0x201c72]['unit']+_0x129202(0x123)+_0x129202(0x1ac)+_0x3bb1d5[_0x201c72][_0x129202(0x1a0)]+_0x129202(0x123)+_0x129202(0x1ac)+_0x3f4eb9['to_warehouse']+_0x129202(0x123)+_0x129202(0x1ac)+_0x3bb1d5[_0x201c72][_0x129202(0x165)]+_0x129202(0x123)+_0x129202(0x1ac)+_0x4f0167+_0x3bb1d5[_0x201c72][_0x129202(0x19c)]+_0x129202(0x123)+_0x129202(0x173);}let _0x5ed07e=nodemailer[_0x129202(0x1b9)]({'host':_0x11c39a[_0x129202(0x1fd)],'port':Number(_0x11c39a[_0x129202(0x1d1)]),'secure':![],'auth':{'user':_0x11c39a['email'],'pass':_0x11c39a[_0x129202(0x158)]}}),_0x500d93={'from':_0x11c39a[_0x129202(0x14b)],'to':_0x2cc84a[0x0][_0x129202(0x1e2)],'subject':_0x129202(0x17e),'attachments':[{'filename':_0x129202(0x195),'path':__dirname+_0x129202(0x170)+_0x129202(0x154)+_0xb361b9[0x0][_0x129202(0x1cc)],'cid':_0x129202(0x1e0)}],'html':_0x129202(0x167)+_0x129202(0x204)+_0x129202(0x19a)+_0x129202(0x1ef)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x129202(0x1ef)+_0x129202(0x156)+_0x129202(0x185)+_0x129202(0x1ef)+_0x129202(0x153)+_0xb361b9[0x0][_0x129202(0x127)]+_0x129202(0x133)+'</div>'+_0x129202(0x185)+_0x129202(0x135)+_0x129202(0x1ef)+_0x129202(0x136)+'\x20Order\x20Number\x20:\x20'+_0x3f4eb9['invoice']+'\x20'+_0x129202(0x13d)+_0x129202(0x179)+_0x3f4eb9[_0x129202(0x144)]+'\x20'+_0x129202(0x164)+'</h5>'+'</div>'+_0x129202(0x128)+_0x129202(0x16d)+'<tr>'+_0x129202(0x1cb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x129202(0x1e1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x129202(0x18c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x129202(0x1ea)+_0x129202(0x1d7)+_0x129202(0x173)+'</thead>'+_0x129202(0x1bd)+'\x20'+_0xa20673+'\x20'+_0x129202(0x1e3)+_0x129202(0x1f2)+_0x129202(0x1ef)+_0x129202(0x1c8)+_0x129202(0x187)+_0xb361b9[0x0][_0x129202(0x127)]+'</h5>'+_0x129202(0x185)+'</div>'+_0x129202(0x12e)};_0x5ed07e[_0x129202(0x18d)](_0x500d93,function(_0x58266c,_0xfbf6b3){var _0x5249dc=_0x129202;_0x58266c?(console[_0x5249dc(0x1b8)](_0x58266c),console[_0x5249dc(0x1b8)]('Error\x20Occurs')):console[_0x5249dc(0x1b8)](_0x5249dc(0x14c));}),_0x5a2762[_0x129202(0x12b)](_0x129202(0x1de),_0x129202(0x193)),_0x410e28['redirect'](_0x129202(0x131)+_0x5b90e4[_0x129202(0x19e)]);}catch(_0x4da0aa){console[_0x129202(0x1d9)](_0x4da0aa),_0x410e28[_0x129202(0x1ca)](0x1f4)[_0x129202(0x1bc)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x57f1c7(0x1c9)](_0x9485fc=>{var _0x57fdcb=_0x57f1c7;console[_0x57fdcb(0x1d9)](_0x9485fc),_0x410e28['status'](0x1f4)[_0x57fdcb(0x1bc)]({'error':_0x57fdcb(0x14e)});});}catch(_0x3a2a3f){console['error'](_0x3a2a3f),_0x410e28['status'](0x1f4)[_0x57f1c7(0x1bc)]({'error':_0x57f1c7(0x146)});}})['catch'](_0x32303f=>{var _0x370e92=_0x4f5444;console[_0x370e92(0x1d9)](_0x32303f),_0x410e28[_0x370e92(0x1ca)](0x1f4)[_0x370e92(0x1bc)]({'error':_0x370e92(0x14e)});});}catch(_0x262fb5){_0x410e28[_0x4f5444(0x1bc)]({'message':_0x262fb5['message']});}});function BayBinSelected(_0x38ae4d,_0x3b13bb){var _0x4ec468=a0_0x10e693,_0x4f0b86=[];let _0x1830fe=[];var _0x2d58db=[];if(_0x38ae4d==_0x4ec468(0x1a9)){switch(_0x3b13bb){case'Rack\x201':_0x4f0b86=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x4f0b86=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x2d58db=['DG'];}else{if(_0x38ae4d==_0x4ec468(0x1d5)){switch(_0x3b13bb){case _0x4ec468(0x1c2):_0x4f0b86=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x4ec468(0x18a):_0x4f0b86=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x2d58db=['FG'];}}return{'levels':_0x4f0b86,'identify':_0x2d58db};}router['get'](a0_0x10e693(0x130),auth,async(_0x4cbbfd,_0x51fd12)=>{var _0x5aaeaf=a0_0x10e693;try{const {username:_0x12dcc5,email:_0xfdf242,role:_0xba0904}=_0x4cbbfd['user'],_0x25fb58=_0x4cbbfd['user'],_0x2a1a61=await profile[_0x5aaeaf(0x1c4)]({'email':_0x25fb58['email']}),_0x172bd6=await master_shop['find'](),_0x26ecec=await transfers_finished[_0x5aaeaf(0x16e)](_0x4cbbfd[_0x5aaeaf(0x1f4)]['id']);let _0x4191aa=new Date(_0x26ecec['expiry_date']),_0x32d4a8=('0'+_0x4191aa[_0x5aaeaf(0x1ec)]())[_0x5aaeaf(0x160)](-0x2),_0x2044fc=('0'+(_0x4191aa[_0x5aaeaf(0x1c7)]()+0x1))[_0x5aaeaf(0x160)](-0x2),_0x428036=_0x4191aa[_0x5aaeaf(0x18f)](),_0xa137a7=_0x428036+'-'+_0x2044fc+'-'+_0x32d4a8,_0x29cb4c;if(_0x25fb58[_0x5aaeaf(0x169)]==_0x5aaeaf(0x1c0)){const _0x277b89=await staff[_0x5aaeaf(0x1c4)]({'email':_0x25fb58[_0x5aaeaf(0x14b)]});_0x29cb4c=await warehouse['find']({'status':_0x5aaeaf(0x137),'name':_0x277b89['warehouse'],'warehouse_category':_0x5aaeaf(0x12c)});}else _0x29cb4c=await warehouse['find']({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x584f7d=await warehouse[_0x5aaeaf(0x1a1)]([{'$match':{'name':_0x26ecec[_0x5aaeaf(0x16f)],'room':_0x26ecec[_0x5aaeaf(0x1e8)]}},{'$unwind':_0x5aaeaf(0x1a7)},{'$group':{'_id':_0x5aaeaf(0x129),'name':{'$first':_0x5aaeaf(0x13e)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x5aaeaf(0x126)},'bin':{'$first':_0x5aaeaf(0x183)},'type':{'$first':_0x5aaeaf(0x1cd)},'floorlevel':{'$first':_0x5aaeaf(0x16b)},'primary_code':{'$first':_0x5aaeaf(0x166)},'secondary_code':{'$first':_0x5aaeaf(0x197)},'product_code':{'$first':_0x5aaeaf(0x1a5)},'storage':{'$first':_0x5aaeaf(0x1d6)},'rack':{'$first':_0x5aaeaf(0x1a6)}}}]);var _0x41de41=[0x1,0x2,0x3,0x4],_0xaadd36=['A','B','C','D','E','F','G','H','I','J'],_0x195941=[_0x5aaeaf(0x196),_0x5aaeaf(0x1af)];const _0xc1ea7f=await product[_0x5aaeaf(0x1f0)]({}),_0x4a7c4c=BayBinSelected(_0x26ecec[_0x5aaeaf(0x1e5)],_0x26ecec[_0x5aaeaf(0x1b7)]);if(_0x172bd6[0x0][_0x5aaeaf(0x13c)]==_0x5aaeaf(0x142)){var _0x10906e=users[_0x5aaeaf(0x13b)];console[_0x5aaeaf(0x1b8)](_0x10906e);}else{if(_0x172bd6[0x0][_0x5aaeaf(0x13c)]==_0x5aaeaf(0x145))var _0x10906e=users[_0x5aaeaf(0x145)];else{if(_0x172bd6[0x0]['language']==_0x5aaeaf(0x163))var _0x10906e=users[_0x5aaeaf(0x163)];else{if(_0x172bd6[0x0][_0x5aaeaf(0x13c)]==_0x5aaeaf(0x17d))var _0x10906e=users[_0x5aaeaf(0x17d)];else{if(_0x172bd6[0x0][_0x5aaeaf(0x13c)]==_0x5aaeaf(0x1ba))var _0x10906e=users[_0x5aaeaf(0x1ba)];else{if(_0x172bd6[0x0][_0x5aaeaf(0x13c)]==_0x5aaeaf(0x1f9))var _0x10906e=users['Portuguese'];else{if(_0x172bd6[0x0][_0x5aaeaf(0x13c)]==_0x5aaeaf(0x12a))var _0x10906e=users[_0x5aaeaf(0x12a)];else{if(_0x172bd6[0x0][_0x5aaeaf(0x13c)]=='Arabic\x20(ae)')var _0x10906e=users[_0x5aaeaf(0x155)];}}}}}}}_0x51fd12[_0x5aaeaf(0x17c)](_0x5aaeaf(0x13f),{'success':_0x4cbbfd['flash'](_0x5aaeaf(0x1de)),'errors':_0x4cbbfd[_0x5aaeaf(0x12b)](_0x5aaeaf(0x1bf)),'role':_0x25fb58,'profile':_0x2a1a61,'master_shop':_0x172bd6,'warehouse':_0x29cb4c,'transfer':_0x26ecec,'stock':_0x584f7d,'unit':_0xc1ea7f,'language':_0x10906e,'levels':_0x41de41,'Isle':_0xaadd36,'rooms_data':_0x195941,'ed_fullDate':_0xa137a7,'dataSelected':_0x4a7c4c});}catch(_0x1cf892){console[_0x5aaeaf(0x1b8)](_0x1cf892);}}),router[a0_0x10e693(0x198)](a0_0x10e693(0x130),auth,async(_0x5c2cfa,_0x4194f0)=>{var _0x3865b6=a0_0x10e693;try{const _0xc4905c=_0x5c2cfa[_0x3865b6(0x1f4)]['id'];console['log'](_0x5c2cfa[_0x3865b6(0x14a)]);const _0x4c86fd=await transfers_finished['findById'](_0xc4905c);console[_0x3865b6(0x1b8)](_0x3865b6(0x194),_0x4c86fd);const {date:_0x5d791b,from_warehouse:_0x41721f,FromRoom_name:_0x42f568,to_warehouse:_0x23d9cb,ToRoom_name:_0x144649,prod_name:_0x41d4af,from_prod_qty:_0x592175,from_prod_level:_0x3813af,from_prod_isle:_0x13323a,from_prod_pallet:_0x480570,to_prod_qty:_0x54277a,to_prod_level:_0x3e055f,to_prod_isle:_0x106d7a,to_prod_pallet:_0x111c98,primary_code:_0x584451,secondary_code:_0x1b4104,product_code3:_0x13da2d,note:_0x1fb336,invoice:_0x3a574e,expiry_date:_0x330fd7}=_0x5c2cfa['body'];if(typeof _0x41d4af=='string')var _0x3f4b10=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x140)]],_0xb8625d=[_0x5c2cfa[_0x3865b6(0x14a)]['from_prod_qty']],_0x28cb59=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x172)]],_0x1f1881=[_0x5c2cfa['body']['to_prod_qty']],_0x136e18=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x168)]],_0x15f994=[_0x5c2cfa['body']['primary_code']],_0x27cb1a=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x209)]],_0x2692e1=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x134)]],_0x494a66=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x1d2)]],_0x147a3c=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x17f)]],_0x746bab=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x1a0)]],_0x538eb7=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x1c5)]],_0x4f9cb0=[_0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x1a2)]];else var _0x3f4b10=[..._0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x140)]],_0xb8625d=[..._0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x143)]],_0x28cb59=[..._0x5c2cfa['body'][_0x3865b6(0x172)]],_0x1f1881=[..._0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x190)]],_0x136e18=[..._0x5c2cfa['body']['to_prod_level']],_0x15f994=[..._0x5c2cfa[_0x3865b6(0x14a)]['primary_code']],_0x27cb1a=[..._0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x209)]],_0x2692e1=[..._0x5c2cfa[_0x3865b6(0x14a)]['product_code3']],_0x494a66=[..._0x5c2cfa['body'][_0x3865b6(0x1d2)]],_0x147a3c=[..._0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x17f)]],_0x746bab=[..._0x5c2cfa[_0x3865b6(0x14a)][_0x3865b6(0x1a0)]],_0x538eb7=[..._0x5c2cfa[_0x3865b6(0x14a)]['batch_code']],_0x4f9cb0=[..._0x5c2cfa['body'][_0x3865b6(0x1a2)]];const _0x2a91ce=_0x3f4b10[_0x3865b6(0x1ce)](_0x344ff3=>{return _0x344ff3={'product_name':_0x344ff3};});_0xb8625d[_0x3865b6(0x184)]((_0x2ff9e5,_0x351df7)=>{var _0x3d5c60=_0x3865b6;_0x2a91ce[_0x351df7][_0x3d5c60(0x15a)]=_0x2ff9e5;}),_0x28cb59[_0x3865b6(0x184)]((_0x2ab3ef,_0x34a133)=>{var _0x3d35d9=_0x3865b6;_0x2a91ce[_0x34a133][_0x3d35d9(0x182)]=_0x2ab3ef;}),_0x1f1881[_0x3865b6(0x184)]((_0x3a6ecb,_0x4d921b)=>{var _0x38fad0=_0x3865b6;_0x2a91ce[_0x4d921b][_0x38fad0(0x125)]=_0x3a6ecb;}),_0x136e18[_0x3865b6(0x184)]((_0x2491bc,_0x119a24)=>{var _0x2dab20=_0x3865b6;_0x2a91ce[_0x119a24][_0x2dab20(0x19c)]=_0x2491bc;}),_0x15f994['forEach']((_0x26b202,_0x1a6d5f)=>{var _0x156da0=_0x3865b6;_0x2a91ce[_0x1a6d5f][_0x156da0(0x147)]=_0x26b202;}),_0x27cb1a[_0x3865b6(0x184)]((_0x140ab6,_0xee503b)=>{var _0x27a3f1=_0x3865b6;_0x2a91ce[_0xee503b][_0x27a3f1(0x209)]=_0x140ab6;}),_0x2692e1[_0x3865b6(0x184)]((_0x4cff57,_0x404ae0)=>{var _0xf2c40a=_0x3865b6;_0x2a91ce[_0x404ae0][_0xf2c40a(0x17a)]=_0x4cff57;}),_0x494a66[_0x3865b6(0x184)]((_0x328f98,_0xccaf8f)=>{var _0x500631=_0x3865b6;_0x2a91ce[_0xccaf8f][_0x500631(0x207)]=_0x328f98;}),_0x147a3c[_0x3865b6(0x184)]((_0x565933,_0x2b23bd)=>{var _0x2a35a9=_0x3865b6;_0x2a91ce[_0x2b23bd][_0x2a35a9(0x17f)]=_0x565933;}),_0x746bab[_0x3865b6(0x184)]((_0x20fe69,_0x1810cd)=>{var _0x2419da=_0x3865b6;_0x2a91ce[_0x1810cd][_0x2419da(0x1a0)]=_0x20fe69;}),_0x538eb7[_0x3865b6(0x184)]((_0x53a43a,_0x81507c)=>{var _0x3e456=_0x3865b6;_0x2a91ce[_0x81507c][_0x3e456(0x1c5)]=_0x53a43a;}),_0x4f9cb0[_0x3865b6(0x184)]((_0x5b7e3b,_0x27d916)=>{var _0x302dc4=_0x3865b6;_0x2a91ce[_0x27d916][_0x302dc4(0x1a2)]=_0x5b7e3b;});const _0x457190=_0x2a91ce[_0x3865b6(0x200)](_0x573c59=>_0x573c59[_0x3865b6(0x125)]!=='0'&&_0x573c59[_0x3865b6(0x125)]!==''||_0x573c59[_0x3865b6(0x138)]!=='0'&&_0x573c59[_0x3865b6(0x138)]!=='');var _0x5df137=0x0;_0x457190[_0x3865b6(0x184)](_0x17b8c8=>{var _0x52f802=_0x3865b6;parseInt(_0x17b8c8['from_quantity'])<parseInt(_0x17b8c8[_0x52f802(0x125)])&&_0x5df137++;});if(_0x5df137!=0x0)return _0x5c2cfa[_0x3865b6(0x12b)](_0x3865b6(0x1bf),_0x3865b6(0x191)),_0x4194f0[_0x3865b6(0x177)](_0x3865b6(0x178));const _0x3f0c9d=await warehouse['findOne']({'name':_0x4c86fd[_0x3865b6(0x16f)],'room':_0x4c86fd[_0x3865b6(0x1e8)]});_0x4c86fd['product'][_0x3865b6(0x184)](_0x51be2b=>{var _0x1f048f=_0x3865b6;if(_0x51be2b[_0x1f048f(0x125)]>0x0){const _0x39db3a=_0x3f0c9d[_0x1f048f(0x180)][_0x1f048f(0x1ce)](_0xff777a=>{var _0x15351c=_0x1f048f;_0xff777a[_0x15351c(0x1c3)]==_0x51be2b['product_name']&&_0xff777a[_0x15351c(0x1fb)]==_0x51be2b['from_bay']&&(_0xff777a['product_stock']=parseInt(_0xff777a[_0x15351c(0x15d)])+parseInt(_0x51be2b[_0x15351c(0x125)]));});}}),await _0x3f0c9d[_0x3865b6(0x19b)]();const _0x6cef75=await warehouse[_0x3865b6(0x1c4)]({'name':_0x4c86fd[_0x3865b6(0x1e5)],'room':_0x4c86fd[_0x3865b6(0x1b7)]});_0x4c86fd[_0x3865b6(0x1eb)][_0x3865b6(0x184)](_0x333273=>{var _0x5312fa=_0x3865b6;if(_0x333273[_0x5312fa(0x125)]>0x0){const _0x28cde8=_0x6cef75[_0x5312fa(0x180)][_0x5312fa(0x1ce)](_0xc10d1d=>{var _0x4e65a0=_0x5312fa;_0xc10d1d[_0x4e65a0(0x1c3)]==_0x333273[_0x4e65a0(0x1c3)]&&_0xc10d1d[_0x4e65a0(0x1fb)]==_0x333273[_0x4e65a0(0x19c)]&&(_0xc10d1d[_0x4e65a0(0x15d)]=parseInt(_0xc10d1d[_0x4e65a0(0x15d)])-parseInt(_0x333273[_0x4e65a0(0x125)]));});}}),await _0x6cef75['save'](),_0x4c86fd['date']=_0x5d791b,_0x4c86fd['from_warehouse']=_0x41721f,_0x4c86fd[_0x3865b6(0x1e5)]=_0x23d9cb,_0x4c86fd[_0x3865b6(0x1eb)]=_0x457190,_0x4c86fd[_0x3865b6(0x161)]=_0x1fb336,_0x4c86fd[_0x3865b6(0x208)]=_0x3a574e;const _0x3671e0=await _0x4c86fd[_0x3865b6(0x19b)](),_0x218892=await warehouse[_0x3865b6(0x1c4)]({'name':_0x41721f,'room':_0x42f568});_0x3671e0['product'][_0x3865b6(0x184)](_0x47b052=>{var _0x4f0eee=_0x3865b6;if(_0x47b052[_0x4f0eee(0x125)]>0x0){const _0x515ea9=_0x218892['product_details']['map'](_0x5a0152=>{var _0xd3f6d8=_0x4f0eee;_0x5a0152[_0xd3f6d8(0x1c3)]==_0x47b052[_0xd3f6d8(0x1c3)]&&_0x5a0152[_0xd3f6d8(0x1fb)]==_0x47b052[_0xd3f6d8(0x182)]&&(_0x5a0152['product_stock']=parseInt(_0x5a0152[_0xd3f6d8(0x15d)])-parseInt(_0x47b052[_0xd3f6d8(0x125)]));});}}),await _0x218892[_0x3865b6(0x19b)]();const _0x4705e8=await warehouse[_0x3865b6(0x1c4)]({'name':_0x23d9cb,'room':_0x144649});_0x3671e0[_0x3865b6(0x1eb)][_0x3865b6(0x184)](_0x1118ca=>{var _0x35e0fc=_0x3865b6;if(_0x1118ca['to_quantity']>0x0){var _0x353b33=0x0;const _0xd35530=_0x4705e8[_0x35e0fc(0x180)][_0x35e0fc(0x1ce)](_0x102e43=>{var _0x5a72af=_0x35e0fc;_0x102e43[_0x5a72af(0x1c3)]==_0x1118ca['product_name']&&_0x102e43[_0x5a72af(0x1fb)]==_0x1118ca['to_bay']&&(_0x102e43['product_stock']=parseInt(_0x102e43[_0x5a72af(0x15d)])+parseInt(_0x1118ca['to_quantity']),_0x353b33++);});_0x353b33=='0'&&(_0x4705e8['product_details']=_0x4705e8[_0x35e0fc(0x180)][_0x35e0fc(0x1f3)]({'product_name':_0x1118ca['product_name'],'product_stock':_0x1118ca['to_quantity'],'bay':_0x1118ca[_0x35e0fc(0x19c)],'product_code':_0x1118ca[_0x35e0fc(0x17a)],'primary_code':_0x1118ca['primary_code'],'secondary_code':_0x1118ca[_0x35e0fc(0x209)],'maxProducts':_0x1118ca[_0x35e0fc(0x207)]}));}}),await _0x4705e8[_0x3865b6(0x19b)](),_0x5c2cfa[_0x3865b6(0x12b)](_0x3865b6(0x1de),_0x3865b6(0x17b)),_0x4194f0[_0x3865b6(0x177)](_0x3865b6(0x1b3));}catch(_0x21ea06){console[_0x3865b6(0x1b8)](_0x21ea06);}}),router['post']('/barcode_scanner',async(_0x10a547,_0x9d6333)=>{var _0x153a17=a0_0x10e693;const {FromWareHouse:_0x490e92,FromRoom:_0x3bbaf5,ToWarehouse:_0x9cd954,ToRoom:_0x2336d8,primary_code:_0x1dfb7f,Roomslist:_0x4f91ec}=_0x10a547[_0x153a17(0x14a)],_0x220b78=_0x4f91ec[_0x153a17(0x1dc)](','),_0x2d5759=[];async function _0x54df2e(_0x589ce6){var _0x98ef54=_0x153a17;const _0x1c3a00=await warehouse[_0x98ef54(0x1a1)]([{'$match':{'name':_0x490e92,'room':_0x589ce6}},{'$unwind':_0x98ef54(0x1a7)},{'$match':{'product_details.primary_code':_0x1dfb7f}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x98ef54(0x13e)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x98ef54(0x166)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x98ef54(0x1a5)},'level':{'$first':_0x98ef54(0x126)},'isle':{'$first':_0x98ef54(0x183)},'type':{'$first':_0x98ef54(0x1cd)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x98ef54(0x19d)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x98ef54(0x1a6)},'expiry_date':{'$first':_0x98ef54(0x1ff)},'production_date':{'$first':_0x98ef54(0x1f6)},'batch_code':{'$first':_0x98ef54(0x19f)},'maxPerUnit':{'$first':_0x98ef54(0x1d3)},'roomNamed':{'$first':_0x98ef54(0x1bb)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x98ef54(0x205)}}}]),_0x19c693=await warehouse[_0x98ef54(0x1a1)]([{'$match':{'name':_0x490e92,'room':_0x589ce6}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x1dfb7f}},{'$group':{'_id':_0x98ef54(0x129),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x98ef54(0x132)},'primary_code':{'$first':_0x98ef54(0x166)},'secondary_code':{'$first':_0x98ef54(0x197)},'product_code':{'$first':_0x98ef54(0x1a5)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x98ef54(0x183)},'type':{'$first':_0x98ef54(0x1cd)},'pallet':{'$first':_0x98ef54(0x16b)},'unit':{'$first':_0x98ef54(0x19d)},'secondary_unit':{'$first':_0x98ef54(0x149)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x98ef54(0x1a6)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x98ef54(0x19f)},'maxPerUnit':{'$first':_0x98ef54(0x1d3)},'roomNamed':{'$first':_0x98ef54(0x1bb)},'prod_cat':{'$first':'S'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x1c3a00[_0x98ef54(0x1c1)]>0x0)_0x2d5759[_0x98ef54(0x1e7)](_0x1c3a00);else _0x19c693['length']>0x0&&_0x2d5759[_0x98ef54(0x1e7)](_0x19c693);}const _0x405535=_0x220b78[_0x153a17(0x1ce)](_0x1cc86b=>_0x54df2e(_0x1cc86b));await Promise[_0x153a17(0x1c6)](_0x405535),_0x9d6333[_0x153a17(0x1bc)](_0x2d5759);}),router[a0_0x10e693(0x198)](a0_0x10e693(0x175),async(_0x404549,_0x5bd0b1)=>{var _0x16c062=a0_0x10e693;try{const {FromWareHouse:_0x15d50f,FromRoom:_0x2621f8,ToWarehouse:_0x27b240,ToRoom:_0x1c9a78,secondary_code:_0x42fe4c}=_0x404549[_0x16c062(0x14a)],_0x197354=await warehouse[_0x16c062(0x1a1)]([{'$match':{'name':_0x15d50f}},{'$unwind':_0x16c062(0x1a7)},{'$match':{'product_details.secondary_code':_0x42fe4c}},{'$group':{'_id':_0x16c062(0x129),'name':{'$first':_0x16c062(0x13e)},'primary_code':{'$first':_0x16c062(0x166)},'secondary_code':{'$first':_0x16c062(0x197)},'product_code':{'$first':_0x16c062(0x1a5)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x16c062(0x14d)},'maxProducts':{'$first':_0x16c062(0x1a8)},'unit':{'$first':_0x16c062(0x19d)},'expiry_date':{'$first':_0x16c062(0x1ff)},'production_date':{'$first':_0x16c062(0x1f6)}}}]);_0x5bd0b1[_0x16c062(0x1ca)](0xc8)[_0x16c062(0x1bc)](_0x197354);}catch(_0x26f8fe){_0x5bd0b1[_0x16c062(0x1ca)](0x194)[_0x16c062(0x1bc)]({'message':_0x26f8fe[_0x16c062(0x1a3)]});}}),router[a0_0x10e693(0x198)]('/barcode_scanner3',async(_0x4c61cf,_0x294057)=>{var _0x3147be=a0_0x10e693;try{const {FromWareHouse:_0xc8be14,FromRoom:_0x10db1a,ToWarehouse:_0x548cfc,ToRoom:_0x1c6d26,product_code:_0x17e77a}=_0x4c61cf[_0x3147be(0x14a)],_0x5dff35=await warehouse[_0x3147be(0x1a1)]([{'$match':{'name':_0xc8be14}},{'$unwind':_0x3147be(0x1a7)},{'$match':{'product_details.product_code':_0x17e77a}},{'$group':{'_id':_0x3147be(0x129),'name':{'$first':_0x3147be(0x13e)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3147be(0x197)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x3147be(0x132)},'warehouse':{'$first':_0x3147be(0x1f8)},'level':{'$first':_0x3147be(0x1b0)},'isle':{'$first':_0x3147be(0x148)},'pallet':{'$first':_0x3147be(0x14d)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x3147be(0x19d)}}}]);_0x294057['status'](0xc8)[_0x3147be(0x1bc)](_0x5dff35);}catch(_0x5233b2){_0x294057[_0x3147be(0x1ca)](0x194)[_0x3147be(0x1bc)]({'message':_0x5233b2[_0x3147be(0x1a3)]});}}),router[a0_0x10e693(0x198)](a0_0x10e693(0x18e),async(_0x1d98c8,_0x109271)=>{var _0x2f01e8=a0_0x10e693;const {productCode:_0x36d3bf,bay:_0x4bcccb,warehouses:_0x2c30dd,room:_0x37dc49}=_0x1d98c8['body'];console['log'](_0x1d98c8[_0x2f01e8(0x14a)]);try{const _0xec2692=await warehouse[_0x2f01e8(0x1a1)]([{'$match':{'name':_0x2c30dd,'room':_0x37dc49}},{'$unwind':_0x2f01e8(0x1a7)},{'$match':{'product_details.bay':parseInt(_0x4bcccb)}},{'$group':{'_id':_0x2f01e8(0x129),'name':{'$first':_0x2f01e8(0x13e)},'product_stock':{'$first':_0x2f01e8(0x132)},'bay':{'$first':_0x2f01e8(0x126)},'maxProducts':{'$first':_0x2f01e8(0x1a8)}}}]);_0x109271[_0x2f01e8(0x1ca)](0xc8)[_0x2f01e8(0x1bc)](_0xec2692);}catch(_0x4bd138){_0x109271[_0x2f01e8(0x1ca)](0x194)[_0x2f01e8(0x1bc)]({'message':_0x4bd138[_0x2f01e8(0x1a3)]});}}),module[a0_0x10e693(0x1ad)]=router;