function a0_0x167b(_0x57bf6a,_0x193f75){var _0x50d801=a0_0x50d8();return a0_0x167b=function(_0x167b13,_0x122dbe){_0x167b13=_0x167b13-0x100;var _0x1c5b8b=_0x50d801[_0x167b13];return _0x1c5b8b;},a0_0x167b(_0x57bf6a,_0x193f75);}var a0_0x2d11d7=a0_0x167b;(function(_0x3a3901,_0x2f9bd0){var _0x52024a=a0_0x167b,_0x3220b0=_0x3a3901();while(!![]){try{var _0x32a3cb=-parseInt(_0x52024a(0x14c))/0x1*(-parseInt(_0x52024a(0x16f))/0x2)+-parseInt(_0x52024a(0x149))/0x3+-parseInt(_0x52024a(0x136))/0x4+parseInt(_0x52024a(0x1a0))/0x5+parseInt(_0x52024a(0x12b))/0x6+parseInt(_0x52024a(0x114))/0x7*(parseInt(_0x52024a(0x183))/0x8)+-parseInt(_0x52024a(0x116))/0x9;if(_0x32a3cb===_0x2f9bd0)break;else _0x3220b0['push'](_0x3220b0['shift']());}catch(_0x200e32){_0x3220b0['push'](_0x3220b0['shift']());}}}(a0_0x50d8,0xeddd6));function a0_0x50d8(){var _0xcf87de=['secondary_unit','back','$product_details._id','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','findById','/view/add_transfer','transfer_data','$product_details.primary_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','status','True','DRY\x20GOODS','FROZEN\x20GOODS','/transfer_finished/preview/','maxProducts','toString','to_floorlevel','</head><body>','from_invoice','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','all','warehouse','redirect','secondary_code','concat','/barcode_scanner3','Chinese','from_prod_level','$product_details.maxProducts','production_date','product_code3','from_prod_qty','$product_details.maxPerUnit','$product_details.rack','site_title','logo','forEach','to_room_name','product_stock','primary_unit','</span>','_id','$product_details.bin','<h5\x20style=\x22text-align:\x20left;\x22>','/CheckingWarehouse','$product_details.bay','TRFF-','An\x20error\x20occurred\x20while\x20saving\x20data.','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','English\x20(US)','primary_code','edit_transfer_finished','role','<table\x20style=\x22width:\x20100%\x20!important;\x22>','expiry_date','<!DOCTYPE\x20html>','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','from_warehouse','Hindi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','<strong>\x20Regards\x20</strong>','Enclosed','</h5>','user','$product_details','edit_transfer_finished_view','6449639qHOTbX','$product_details.invoice','20779371sloGCV','</table>','To_invoice','filter','to_prod_level','post','$date','updateOne','$product_details.secondary_code','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','product_details','New_Qty_Converted','invoice','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','/upload/','Portuguese\x20(BR)','getMonth','</thead>','getDate','to_room','prod_cat','10530210ieSHgE','$room','prod_name','<html><head><title></title>','<div>','FGSEmail','$product_details.floorlevel','save','French','from_bay','/view/:id','3486728TqmuVb','note','/preview/:id','bay','to_quantity','then','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.level','$from_warehouse','<h2>\x20','nodemailer','$product_details.production_date','$product_details.unit','to_invoice','Router','staff','errors','success','4984485BzWXcU','params','date','3KqlaXm','product_date','from_room_name','$product_details.product_name','$to_warehouse','sendMail','</td>','slice','MaxStocks_data','German','find','finalize','Arabic\x20(ae)','Finished\x20Goods','/barcode_scanner2','Spanish','Portuguese','<tr>','json','\x20</h2>','$product.to_room_name','$name','$product_details.type','MaxStocks_data2','$product_details.batch_code','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','string','$product_details.product_stock','Rack\x201','flash','product','Transfer\x20Finalize\x20Successfully','from_room','QA\x20Warehouse','catch','1002658yRVHut','image','port','body','/transfer_finished/view','$product_details.secondary_unit','</div>','Error\x20Occurs','log','unit','render','padStart','push','product_name','findOne','RoomAssigned','$product_details.expiry_date','$product_details.storage','$product','aggregate','8UNqaCR','error','<hr\x20class=\x22my-3\x22>','/picking_list/PDF_transfer/','message','Enabled','$product.from_room_name','Product\x20Transfer\x20successfully','map','length','maxPerUnit','add_transfer_finished','product_code','get','email','to_warehouse','English','Arabic','/transfer/view','from_quantity','to_bay','batch_code','../models/all_models','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Rack\x202','$product_details.product_code','$product_details.pallet','password','8179455mLsRlL','to_prod_qty','createTransport','floor'];a0_0x50d8=function(){return _0xcf87de;};return a0_0x50d8();}const express=require('express'),app=express(),router=express[a0_0x2d11d7(0x145)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x2d11d7(0x199)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x2d11d7(0x141));router['get'](a0_0x2d11d7(0x109),auth,async(_0x1eb358,_0x3c95f8)=>{var _0x46c77c=a0_0x2d11d7;try{const {username:_0x32f1f0,email:_0x26ef5b,role:_0x484752}=_0x1eb358[_0x46c77c(0x111)],_0x227574=_0x1eb358[_0x46c77c(0x111)],_0x5afd5=await profile['findOne']({'email':_0x227574['email']}),_0x4aa3fb=await master_shop[_0x46c77c(0x156)]();let _0x18dbc2;if(_0x227574[_0x46c77c(0x105)]==_0x46c77c(0x146)){const _0x4d2177=await staff[_0x46c77c(0x17d)]({'email':_0x227574['email']});_0x18dbc2=await transfers_finished[_0x46c77c(0x156)]({'from_warehouse':_0x4d2177[_0x46c77c(0x1b9)]});}else _0x18dbc2=await transfers_finished[_0x46c77c(0x182)]([{'$unwind':_0x46c77c(0x181)},{'$group':{'_id':'$_id','invoice':{'$first':'$invoice'},'date':{'$first':_0x46c77c(0x11c)},'from_warehouse':{'$first':_0x46c77c(0x13f)},'to_warehouse':{'$first':_0x46c77c(0x150)},'from_room_name':{'$addToSet':_0x46c77c(0x189)},'to_room_name':{'$addToSet':_0x46c77c(0x160)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x4aa3fb[0x0][_0x46c77c(0x13c)]==_0x46c77c(0x102))var _0x2ef868=users[_0x46c77c(0x193)];else{if(_0x4aa3fb[0x0][_0x46c77c(0x13c)]==_0x46c77c(0x10c))var _0x2ef868=users[_0x46c77c(0x10c)];else{if(_0x4aa3fb[0x0]['language']=='German')var _0x2ef868=users['German'];else{if(_0x4aa3fb[0x0][_0x46c77c(0x13c)]=='Spanish')var _0x2ef868=users[_0x46c77c(0x15b)];else{if(_0x4aa3fb[0x0][_0x46c77c(0x13c)]=='French')var _0x2ef868=users['French'];else{if(_0x4aa3fb[0x0][_0x46c77c(0x13c)]==_0x46c77c(0x125))var _0x2ef868=users[_0x46c77c(0x15c)];else{if(_0x4aa3fb[0x0][_0x46c77c(0x13c)]==_0x46c77c(0x1be))var _0x2ef868=users[_0x46c77c(0x1be)];else{if(_0x4aa3fb[0x0]['language']=='Arabic\x20(ae)')var _0x2ef868=users[_0x46c77c(0x194)];}}}}}}}_0x3c95f8[_0x46c77c(0x179)]('transfer_finished',{'success':_0x1eb358['flash']('success'),'errors':_0x1eb358[_0x46c77c(0x169)](_0x46c77c(0x147)),'role':_0x227574,'profile':_0x5afd5,'master_shop':_0x4aa3fb,'transfer':_0x18dbc2,'language':_0x2ef868});}catch(_0x4a6946){console[_0x46c77c(0x177)](_0x4a6946);}});async function getRandom8DigitNumber(){var _0x43bf13=a0_0x2d11d7;const _0x55b3c4=0x989680,_0x3c32fa=0x5f5e0ff,_0xf6a1e1=Math[_0x43bf13(0x1a3)](Math['random']()*(_0x3c32fa-_0x55b3c4+0x1))+_0x55b3c4;var _0x5512f3;const _0x38c26f=await transfers_finished[_0x43bf13(0x17d)]({'invoice':_0x43bf13(0x1d2)+_0xf6a1e1});return _0x38c26f&&_0x38c26f[_0x43bf13(0x18c)]>0x0?_0x5512f3='TRFF-'+_0xf6a1e1:_0x5512f3='TRFF-'+_0xf6a1e1,_0x5512f3;}router[a0_0x2d11d7(0x190)](a0_0x2d11d7(0x1a9),auth,async(_0x462abd,_0x398bea)=>{var _0x249ffd=a0_0x2d11d7;try{const {username:_0x58be88,email:_0x18e3b2,role:_0x7b789a}=_0x462abd[_0x249ffd(0x111)],_0x267cf5=_0x462abd[_0x249ffd(0x111)],_0x27959f=await profile[_0x249ffd(0x17d)]({'email':_0x267cf5[_0x249ffd(0x191)]}),_0x39f021=await master_shop['find']();let _0xe4b4a9;if(_0x267cf5[_0x249ffd(0x105)]=='staff'){const _0x2298c7=await staff[_0x249ffd(0x17d)]({'email':_0x267cf5[_0x249ffd(0x191)]});_0xe4b4a9=await warehouse[_0x249ffd(0x182)]([{'$match':{'status':_0x249ffd(0x188),'name':_0x2298c7['warehouse'],'warehouse_category':_0x249ffd(0x159),'name':{'$ne':_0x249ffd(0x16d)}}},{'$group':{'_id':'$name','name':{'$first':_0x249ffd(0x161)}}}]);}else _0xe4b4a9=await warehouse[_0x249ffd(0x182)]([{'$match':{'status':_0x249ffd(0x188),'warehouse_category':_0x249ffd(0x159),'name':{'$ne':_0x249ffd(0x16d)}}},{'$group':{'_id':_0x249ffd(0x161),'name':{'$first':'$name'}}}]);const _0x4c7ca7=await transfers_finished[_0x249ffd(0x156)]({}),_0x5cd6c0=_0x4c7ca7[_0x249ffd(0x18c)]+0x1,_0x1a8f02='TRFF-'+_0x5cd6c0[_0x249ffd(0x1b3)]()[_0x249ffd(0x17a)](0x5,'0');if(_0x39f021[0x0][_0x249ffd(0x13c)]==_0x249ffd(0x102))var _0x41e8de=users['English'];else{if(_0x39f021[0x0][_0x249ffd(0x13c)]==_0x249ffd(0x10c))var _0x41e8de=users[_0x249ffd(0x10c)];else{if(_0x39f021[0x0]['language']=='German')var _0x41e8de=users[_0x249ffd(0x155)];else{if(_0x39f021[0x0][_0x249ffd(0x13c)]==_0x249ffd(0x15b))var _0x41e8de=users[_0x249ffd(0x15b)];else{if(_0x39f021[0x0][_0x249ffd(0x13c)]==_0x249ffd(0x133))var _0x41e8de=users[_0x249ffd(0x133)];else{if(_0x39f021[0x0][_0x249ffd(0x13c)]==_0x249ffd(0x125))var _0x41e8de=users[_0x249ffd(0x15c)];else{if(_0x39f021[0x0][_0x249ffd(0x13c)]==_0x249ffd(0x1be))var _0x41e8de=users[_0x249ffd(0x1be)];else{if(_0x39f021[0x0][_0x249ffd(0x13c)]==_0x249ffd(0x158))var _0x41e8de=users['Arabic'];}}}}}}}const _0x48ca26=getRandom8DigitNumber();_0x48ca26['then'](_0x150274=>{var _0x1368ba=_0x249ffd;_0x398bea[_0x1368ba(0x179)](_0x1368ba(0x18e),{'success':_0x462abd[_0x1368ba(0x169)](_0x1368ba(0x148)),'errors':_0x462abd['flash'](_0x1368ba(0x147)),'role':_0x267cf5,'profile':_0x27959f,'master_shop':_0x39f021,'warehouse':_0xe4b4a9,'language':_0x41e8de,'invoice':_0x150274});})[_0x249ffd(0x16e)](_0x8bbe78=>{var _0x21e00a=_0x249ffd;_0x462abd[_0x21e00a(0x169)](_0x21e00a(0x147),_0x21e00a(0x1ac)),_0x398bea[_0x21e00a(0x1ba)](_0x21e00a(0x195));});}catch(_0x441307){console[_0x249ffd(0x177)](_0x441307);}}),router['post'](a0_0x2d11d7(0x1a9),auth,async(_0x16621e,_0x88296e)=>{var _0x58bfc1=a0_0x2d11d7;try{const {date:_0x24c3f5,from_warehouse:_0x53bc07,FromRoom_name:_0x583432,to_warehouse:_0x586930,ToRoom_name:_0x321582,prod_name:_0x107868,from_prod_qty:_0xb468ae,from_prod_level:_0x514072,from_prod_isle:_0x571a44,from_prod_pallet:_0x1c60d0,to_prod_qty:_0x5b42b8,to_prod_level:_0x44efb8,to_prod_isle:_0x2e6961,to_prod_pallet:_0x4a9a1c,primary_code:_0x30c2fb,secondary_code:_0x448490,product_code3:_0x157ffc,note:_0x205b94,MaxStocks_data2:_0x56c1bd,invoice:_0xcb8da6,expiry_date:_0x386591}=_0x16621e['body'];if(typeof _0x107868==_0x58bfc1(0x166))var _0x1ef4c6=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x12d)]],_0x3adeeb=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1c3)]],_0x2a4285=[_0x16621e['body'][_0x58bfc1(0x1bf)]],_0xf1c7e4=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x121)]],_0x1a8082=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x11a)]],_0x372985=[_0x16621e[_0x58bfc1(0x172)]['primary_code']],_0x17a9dd=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1bb)]],_0x35b639=[_0x16621e[_0x58bfc1(0x172)]['product_code3']],_0x42e359=[_0x16621e['body'][_0x58bfc1(0x163)]],_0x1a44ed=[_0x16621e[_0x58bfc1(0x172)]['primary_unit']],_0x16f6dd=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1a4)]],_0x4a9be4=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x198)]],_0x444a7d=[_0x16621e['body'][_0x58bfc1(0x107)]],_0x5dc538=[_0x16621e[_0x58bfc1(0x172)]['product_date']],_0x4a6cd6=[_0x16621e['body'][_0x58bfc1(0x154)]],_0x4859fc=[_0x16621e['body'][_0x58bfc1(0x18d)]],_0x479da9=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x12a)]],_0x228e85=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x17e)]],_0x2bac77=[_0x16621e[_0x58bfc1(0x172)]['ToRoomAssigned']],_0x523bdf=[_0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1b6)]],_0x2d33c1=[_0x16621e['body'][_0x58bfc1(0x144)]];else var _0x1ef4c6=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x12d)]],_0x3adeeb=[..._0x16621e[_0x58bfc1(0x172)]['from_prod_qty']],_0x2a4285=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1bf)]],_0xf1c7e4=[..._0x16621e['body'][_0x58bfc1(0x121)]],_0x1a8082=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x11a)]],_0x372985=[..._0x16621e['body'][_0x58bfc1(0x103)]],_0x17a9dd=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1bb)]],_0x35b639=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1c2)]],_0x42e359=[..._0x16621e['body'][_0x58bfc1(0x163)]],_0x1a44ed=[..._0x16621e['body'][_0x58bfc1(0x1cb)]],_0x16f6dd=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1a4)]],_0x4a9be4=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x198)]],_0x444a7d=[..._0x16621e['body'][_0x58bfc1(0x107)]],_0x5dc538=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x14d)]],_0x4a6cd6=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x154)]],_0x4859fc=[..._0x16621e['body'][_0x58bfc1(0x18d)]],_0x479da9=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x12a)]],_0x228e85=[..._0x16621e[_0x58bfc1(0x172)]['RoomAssigned']],_0x2bac77=[..._0x16621e[_0x58bfc1(0x172)]['ToRoomAssigned']],_0x523bdf=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x1b6)]],_0x2d33c1=[..._0x16621e[_0x58bfc1(0x172)][_0x58bfc1(0x144)]];const _0x43de89=_0x1ef4c6[_0x58bfc1(0x18b)](_0x361df5=>{return _0x361df5={'product_name':_0x361df5};});_0x3adeeb[_0x58bfc1(0x1c8)]((_0x55a209,_0x5db81d)=>{var _0x4143e5=_0x58bfc1;_0x43de89[_0x5db81d][_0x4143e5(0x196)]=_0x55a209;}),_0x2a4285[_0x58bfc1(0x1c8)]((_0xc2999e,_0x899582)=>{var _0xc26866=_0x58bfc1;_0x43de89[_0x899582][_0xc26866(0x134)]=_0xc2999e;}),_0x523bdf[_0x58bfc1(0x1c8)]((_0x488f94,_0x10482a)=>{var _0x522528=_0x58bfc1;_0x43de89[_0x10482a][_0x522528(0x1b6)]=_0x488f94;}),_0x2d33c1[_0x58bfc1(0x1c8)]((_0x7cfb6f,_0x50f711)=>{var _0x2d4183=_0x58bfc1;_0x43de89[_0x50f711][_0x2d4183(0x118)]=_0x7cfb6f;}),_0xf1c7e4['forEach']((_0x31213a,_0x4d5b49)=>{_0x43de89[_0x4d5b49]['to_quantity']=_0x31213a;}),_0x1a8082[_0x58bfc1(0x1c8)]((_0xc1c9d2,_0x4b855e)=>{var _0x432e58=_0x58bfc1;_0x43de89[_0x4b855e][_0x432e58(0x197)]=_0xc1c9d2;}),_0x372985[_0x58bfc1(0x1c8)]((_0x5c9b0,_0x44e843)=>{var _0x5da2ca=_0x58bfc1;_0x43de89[_0x44e843][_0x5da2ca(0x103)]=_0x5c9b0;}),_0x17a9dd[_0x58bfc1(0x1c8)]((_0x57ac28,_0x5b66e6)=>{_0x43de89[_0x5b66e6]['secondary_code']=_0x57ac28;}),_0x35b639[_0x58bfc1(0x1c8)]((_0x24d853,_0x311d2c)=>{var _0x4d2245=_0x58bfc1;_0x43de89[_0x311d2c][_0x4d2245(0x18f)]=_0x24d853;}),_0x42e359[_0x58bfc1(0x1c8)]((_0x4a5242,_0x50b857)=>{var _0x1d6fec=_0x58bfc1;_0x43de89[_0x50b857][_0x1d6fec(0x1b2)]=_0x4a5242;}),_0x1a44ed[_0x58bfc1(0x1c8)]((_0x1053b7,_0x5edddf)=>{_0x43de89[_0x5edddf]['unit']=_0x1053b7;}),_0x16f6dd[_0x58bfc1(0x1c8)]((_0x4513f6,_0x80af2e)=>{_0x43de89[_0x80af2e]['secondary_unit']=_0x4513f6;}),_0x4a9be4[_0x58bfc1(0x1c8)]((_0xd5eaba,_0x26c701)=>{_0x43de89[_0x26c701]['batch_code']=_0xd5eaba;}),_0x444a7d['forEach']((_0x172d76,_0x13c806)=>{var _0x626b32=_0x58bfc1;_0x43de89[_0x13c806][_0x626b32(0x107)]=_0x172d76;}),_0x5dc538[_0x58bfc1(0x1c8)]((_0x2a173c,_0x418980)=>{var _0x15c82b=_0x58bfc1;_0x43de89[_0x418980][_0x15c82b(0x1c1)]=_0x2a173c;}),_0x4a6cd6[_0x58bfc1(0x1c8)]((_0x10944c,_0x487096)=>{var _0x5b50fb=_0x58bfc1;_0x43de89[_0x487096][_0x5b50fb(0x1b2)]=_0x10944c;}),_0x4859fc[_0x58bfc1(0x1c8)]((_0x57ae9b,_0x2c2eb0)=>{var _0x14797e=_0x58bfc1;_0x43de89[_0x2c2eb0][_0x14797e(0x18d)]=_0x57ae9b;}),_0x479da9['forEach']((_0x3d19b3,_0x456bc0)=>{var _0x47f7d1=_0x58bfc1;_0x43de89[_0x456bc0][_0x47f7d1(0x12a)]=_0x3d19b3;}),_0x228e85[_0x58bfc1(0x1c8)]((_0xe8d12d,_0x8dd903)=>{var _0x5b25a7=_0x58bfc1;_0x43de89[_0x8dd903][_0x5b25a7(0x14e)]=_0xe8d12d;}),_0x2bac77['forEach']((_0x3e9fa7,_0x307579)=>{var _0x1bedad=_0x58bfc1;_0x43de89[_0x307579][_0x1bedad(0x1c9)]=_0x3e9fa7;});const _0xa6fa82=_0x43de89[_0x58bfc1(0x119)](_0x1137a5=>_0x1137a5['to_quantity']!=='0'&&_0x1137a5[_0x58bfc1(0x13a)]!==''||_0x1137a5[_0x58bfc1(0x1b4)]!=='0'&&_0x1137a5[_0x58bfc1(0x1b4)]!=='');var _0x55f227=0x0;_0xa6fa82['forEach'](_0x317c14=>{var _0x1e49ec=_0x58bfc1;parseInt(_0x317c14['from_quantity'])<parseInt(_0x317c14[_0x1e49ec(0x13a)])&&_0x55f227++;});if(_0x55f227!=0x0)return _0x16621e[_0x58bfc1(0x169)](_0x58bfc1(0x147),_0x58bfc1(0x11f)),_0x88296e['redirect'](_0x58bfc1(0x1a5));const _0x3cf19e=new transfers_finished({'date':_0x24c3f5,'from_warehouse':_0x53bc07,'to_warehouse':_0x586930,'product':_0xa6fa82,'note':_0x205b94,'invoice':_0xcb8da6}),_0x50194e=await _0x3cf19e[_0x58bfc1(0x132)]();_0x16621e[_0x58bfc1(0x169)]('success',_0x58bfc1(0x18a)),_0x88296e['redirect'](_0x58bfc1(0x1b1)+_0x50194e[_0x58bfc1(0x1cd)]);}catch(_0x5a85a5){console['log'](_0x5a85a5),_0x88296e['status'](0xc8)[_0x58bfc1(0x15e)]({'errorMessage':_0x5a85a5[_0x58bfc1(0x187)]});}}),router[a0_0x2d11d7(0x190)](a0_0x2d11d7(0x138),auth,async(_0x73987e,_0x1cdee6)=>{var _0x4eb681=a0_0x2d11d7;try{const {username:_0x473815,email:_0x3ca3b3,role:_0x419220}=_0x73987e[_0x4eb681(0x111)],_0x191bb6=_0x73987e[_0x4eb681(0x111)],_0x5a50e8=await profile[_0x4eb681(0x17d)]({'email':_0x191bb6[_0x4eb681(0x191)]}),_0xc2d0f=await master_shop[_0x4eb681(0x156)](),_0x2ec4d3=await transfers_finished[_0x4eb681(0x1a8)](_0x73987e['params']['id']);let _0x2460a0;if(_0x191bb6[_0x4eb681(0x105)]==_0x4eb681(0x146)){const _0x7878d8=await staff[_0x4eb681(0x17d)]({'email':_0x191bb6[_0x4eb681(0x191)]});_0x2460a0=await warehouse['find']({'status':_0x4eb681(0x188),'name':_0x7878d8[_0x4eb681(0x1b9)],'warehouse_category':'Finished\x20Goods'});}else _0x2460a0=await warehouse['find']({'status':_0x4eb681(0x188),'warehouse_category':_0x4eb681(0x159)});const _0x6fd8b1=await warehouse['aggregate']([{'$match':{'name':_0x2ec4d3[_0x4eb681(0x10b)],'warehouse_category':_0x4eb681(0x159)}},{'$unwind':_0x4eb681(0x112)},{'$group':{'_id':_0x4eb681(0x1a6),'name':{'$first':_0x4eb681(0x14f)},'product_stock':{'$first':_0x4eb681(0x167)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x4eb681(0x1ce)},'type':{'$first':_0x4eb681(0x162)},'floorlevel':{'$first':_0x4eb681(0x131)},'primary_code':{'$first':_0x4eb681(0x1ab)},'secondary_code':{'$first':_0x4eb681(0x11e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x4eb681(0x180)},'rack':{'$first':_0x4eb681(0x1c5)},'expiry_date':{'$first':_0x4eb681(0x17f)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x4eb681(0x12c)},'warehoue_name':{'$first':_0x4eb681(0x161)}}}]),_0x28f866=await product[_0x4eb681(0x156)]({});if(_0xc2d0f[0x0]['language']=='English\x20(US)'){var _0x5376f6=users[_0x4eb681(0x193)];console[_0x4eb681(0x177)](_0x5376f6);}else{if(_0xc2d0f[0x0][_0x4eb681(0x13c)]=='Hindi')var _0x5376f6=users[_0x4eb681(0x10c)];else{if(_0xc2d0f[0x0][_0x4eb681(0x13c)]=='German')var _0x5376f6=users['German'];else{if(_0xc2d0f[0x0][_0x4eb681(0x13c)]=='Spanish')var _0x5376f6=users[_0x4eb681(0x15b)];else{if(_0xc2d0f[0x0][_0x4eb681(0x13c)]==_0x4eb681(0x133))var _0x5376f6=users[_0x4eb681(0x133)];else{if(_0xc2d0f[0x0][_0x4eb681(0x13c)]==_0x4eb681(0x125))var _0x5376f6=users[_0x4eb681(0x15c)];else{if(_0xc2d0f[0x0][_0x4eb681(0x13c)]=='Chinese')var _0x5376f6=users[_0x4eb681(0x1be)];else{if(_0xc2d0f[0x0][_0x4eb681(0x13c)]==_0x4eb681(0x158))var _0x5376f6=users[_0x4eb681(0x194)];}}}}}}}_0x1cdee6[_0x4eb681(0x179)](_0x4eb681(0x113),{'success':_0x73987e['flash'](_0x4eb681(0x148)),'errors':_0x73987e['flash'](_0x4eb681(0x147)),'role':_0x191bb6,'profile':_0x5a50e8,'master_shop':_0xc2d0f,'warehouse':_0x2460a0,'transfer':_0x2ec4d3,'stock':_0x6fd8b1,'unit':_0x28f866,'language':_0x5376f6});}catch(_0x1b28bc){console['log'](_0x1b28bc);}}),router[a0_0x2d11d7(0x11b)](a0_0x2d11d7(0x138),auth,async(_0x168fbe,_0x2966ee)=>{var _0x17cc08=a0_0x2d11d7;try{const {invoice:_0x45c379,from_warehouse:_0x48cdb6,FromRoom_name:_0x485a21,to_warehouse:_0x1e73bc,ToRoom_name:_0x26add6}=_0x168fbe[_0x17cc08(0x172)],_0x58ee99=await transfers_finished[_0x17cc08(0x1a8)](_0x168fbe[_0x17cc08(0x14a)]['id']),_0x296bd7=_0x58ee99[_0x17cc08(0x16a)][_0x17cc08(0x18b)](async _0x134bcc=>{var _0x1067a0=_0x17cc08;if(_0x134bcc[_0x1067a0(0x13a)]>0x0){var _0x2242ce=await warehouse[_0x1067a0(0x17d)]({'name':_0x48cdb6,'room':_0x134bcc[_0x1067a0(0x14e)],'warehouse_category':'Finished\x20Goods'});const _0x106489=_0x2242ce['product_details'][_0x1067a0(0x18b)](_0x2f1663=>{var _0x299244=_0x1067a0;_0x2f1663['product_name']==_0x134bcc[_0x299244(0x17c)]&&_0x2f1663[_0x299244(0x139)]==_0x134bcc[_0x299244(0x134)]&&_0x2f1663[_0x299244(0x107)]==_0x134bcc[_0x299244(0x107)]&&_0x2f1663[_0x299244(0x1c1)]==_0x134bcc[_0x299244(0x1c1)]&&_0x2f1663[_0x299244(0x198)]==_0x134bcc[_0x299244(0x198)]&&_0x2f1663['invoice']==_0x134bcc[_0x299244(0x1b6)]&&(_0x2f1663['product_stock']=_0x2f1663[_0x299244(0x1ca)]-_0x134bcc[_0x299244(0x13a)]);});}return _0x2242ce;});Promise[_0x17cc08(0x1b8)](_0x296bd7)[_0x17cc08(0x13b)](async _0x4ace10=>{var _0x13f751=_0x17cc08;try{for(const _0x229205 of _0x4ace10){await _0x229205[_0x13f751(0x132)]();}const _0x7ad499=_0x58ee99[_0x13f751(0x16a)][_0x13f751(0x18b)](async _0x1b8b73=>{var _0xe50e5b=_0x13f751,_0x241d33=await warehouse[_0xe50e5b(0x17d)]({'name':_0x1e73bc,'room':_0x1b8b73[_0xe50e5b(0x1c9)]});if(_0x1b8b73['to_quantity']>0x0){var _0x2daf4e=0x0;const _0x2387e2=_0x241d33[_0xe50e5b(0x120)][_0xe50e5b(0x18b)](_0x5e4953=>{var _0x4209e4=_0xe50e5b;_0x5e4953[_0x4209e4(0x17c)]==_0x1b8b73[_0x4209e4(0x17c)]&&_0x5e4953[_0x4209e4(0x139)]==_0x1b8b73['to_bay']&&_0x5e4953['expiry_date']==_0x1b8b73[_0x4209e4(0x107)]&&_0x5e4953[_0x4209e4(0x1c1)]==_0x1b8b73[_0x4209e4(0x1c1)]&&_0x5e4953['batch_code']==_0x1b8b73[_0x4209e4(0x198)]&&_0x5e4953[_0x4209e4(0x122)]==_0x1b8b73[_0x4209e4(0x118)]&&(_0x5e4953['product_stock']=_0x5e4953['product_stock']+_0x1b8b73[_0x4209e4(0x13a)],_0x2daf4e++);});_0x2daf4e=='0'&&(_0x241d33[_0xe50e5b(0x120)]=_0x241d33[_0xe50e5b(0x120)][_0xe50e5b(0x1bc)]({'product_name':_0x1b8b73[_0xe50e5b(0x17c)],'product_stock':_0x1b8b73['to_quantity'],'bay':_0x1b8b73['to_bay'],'product_code':_0x1b8b73['product_code'],'primary_code':_0x1b8b73[_0xe50e5b(0x103)],'secondary_code':_0x1b8b73[_0xe50e5b(0x1bb)],'expiry_date':_0x1b8b73[_0xe50e5b(0x107)],'production_date':_0x1b8b73[_0xe50e5b(0x1c1)],'maxProducts':_0x1b8b73['maxProducts'],'batch_code':_0x1b8b73[_0xe50e5b(0x198)],'secondary_unit':_0x1b8b73['secondary_unit'],'unit':_0x1b8b73[_0xe50e5b(0x178)],'maxProducts':_0x1b8b73[_0xe50e5b(0x1b2)],'maxPerUnit':_0x1b8b73[_0xe50e5b(0x18d)],'invoice':_0x1b8b73['To_invoice']}));}return _0x241d33;});Promise[_0x13f751(0x1b8)](_0x7ad499)[_0x13f751(0x13b)](async _0x42dafe=>{var _0x17f49c=_0x13f751;try{for(const _0x251afe of _0x42dafe){await warehouse[_0x17f49c(0x11d)]({'_id':_0x251afe[_0x17f49c(0x1cd)]},{'$addToSet':{'product_details':{'$each':_0x251afe[_0x17f49c(0x120)]}}});}_0x58ee99[_0x17f49c(0x157)]=_0x17f49c(0x1ae);const _0x146bee=await _0x58ee99[_0x17f49c(0x132)](),_0x4b5c6c=await master_shop['find'](),_0x4f55f0=await email_settings[_0x17f49c(0x17d)](),_0x29587d=await supervisor_settings[_0x17f49c(0x156)]();var _0x214add=_0x58ee99[_0x17f49c(0x16a)],_0x2ea990='',_0x1568a6;for(_0x1568a6 in _0x214add){var _0x1b6bcf='FG';_0x58ee99['to_warehouse']==_0x17f49c(0x1af)&&(_0x1b6bcf='DG'),_0x2ea990+=_0x17f49c(0x15d)+_0x17f49c(0x1b7)+_0x214add[_0x1568a6][_0x17f49c(0x17c)]+'</td>'+_0x17f49c(0x1b7)+_0x214add[_0x1568a6][_0x17f49c(0x18f)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x214add[_0x1568a6][_0x17f49c(0x13a)]+_0x17f49c(0x152)+_0x17f49c(0x1b7)+_0x214add[_0x1568a6][_0x17f49c(0x178)]+_0x17f49c(0x152)+_0x17f49c(0x1b7)+_0x214add[_0x1568a6][_0x17f49c(0x1a4)]+_0x17f49c(0x152)+_0x17f49c(0x1b7)+_0x58ee99[_0x17f49c(0x192)]+_0x17f49c(0x152)+_0x17f49c(0x1b7)+_0x214add[_0x1568a6][_0x17f49c(0x1c9)]+'</td>'+_0x17f49c(0x1b7)+_0x1b6bcf+_0x214add[_0x1568a6][_0x17f49c(0x197)]+_0x17f49c(0x152)+'</tr>';}let _0x44d1ba=nodemailer[_0x17f49c(0x1a2)]({'host':_0x4f55f0['host'],'port':Number(_0x4f55f0[_0x17f49c(0x171)]),'secure':![],'auth':{'user':_0x4f55f0['email'],'pass':_0x4f55f0[_0x17f49c(0x19f)]}}),_0x174ddc={'from':_0x4f55f0['email'],'to':_0x29587d[0x0][_0x17f49c(0x130)],'subject':'Transfer\x20Mail','attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x17f49c(0x124)+_0x4b5c6c[0x0][_0x17f49c(0x170)],'cid':_0x17f49c(0x1c7)}],'html':_0x17f49c(0x108)+_0x17f49c(0x12e)+_0x17f49c(0x1b5)+_0x17f49c(0x12f)+_0x17f49c(0x165)+_0x17f49c(0x12f)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x17f49c(0x175)+'<div>'+_0x17f49c(0x140)+_0x4b5c6c[0x0][_0x17f49c(0x1c6)]+_0x17f49c(0x15f)+_0x17f49c(0x175)+_0x17f49c(0x175)+_0x17f49c(0x185)+_0x17f49c(0x12f)+_0x17f49c(0x1cf)+'\x20Order\x20Number\x20:\x20'+_0x58ee99[_0x17f49c(0x122)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x58ee99['date']+'\x20'+_0x17f49c(0x1cc)+_0x17f49c(0x110)+'</div>'+_0x17f49c(0x106)+_0x17f49c(0x101)+_0x17f49c(0x15d)+_0x17f49c(0x19b)+_0x17f49c(0x10d)+_0x17f49c(0x13d)+_0x17f49c(0x123)+_0x17f49c(0x10a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+'</tr>'+_0x17f49c(0x127)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x2ea990+'\x20'+'</tbody>'+_0x17f49c(0x117)+'<div>'+_0x17f49c(0x10e)+'<h5>'+_0x4b5c6c[0x0][_0x17f49c(0x1c6)]+_0x17f49c(0x110)+_0x17f49c(0x175)+_0x17f49c(0x175)+'</body></html>'};_0x44d1ba[_0x17f49c(0x151)](_0x174ddc,function(_0x4b8a06,_0x5c1c93){var _0xdaa89=_0x17f49c;_0x4b8a06?(console[_0xdaa89(0x177)](_0x4b8a06),console[_0xdaa89(0x177)](_0xdaa89(0x176))):console['log']('Email\x20sent\x20successfully');}),_0x168fbe[_0x17f49c(0x169)]('success',_0x17f49c(0x16b)),_0x2966ee[_0x17f49c(0x1ba)](_0x17f49c(0x186)+_0x146bee[_0x17f49c(0x1cd)]);}catch(_0x5df50b){console[_0x17f49c(0x184)](_0x5df50b),_0x2966ee['status'](0x1f4)[_0x17f49c(0x15e)]({'error':_0x17f49c(0x1a7)});}})[_0x13f751(0x16e)](_0x13ba25=>{var _0xb62e36=_0x13f751;console[_0xb62e36(0x184)](_0x13ba25),_0x2966ee[_0xb62e36(0x1ad)](0x1f4)['json']({'error':_0xb62e36(0x19a)});});}catch(_0x23cad4){console['error'](_0x23cad4),_0x2966ee[_0x13f751(0x1ad)](0x1f4)['json']({'error':_0x13f751(0x100)});}})[_0x17cc08(0x16e)](_0x554470=>{var _0x5217df=_0x17cc08;console[_0x5217df(0x184)](_0x554470),_0x2966ee[_0x5217df(0x1ad)](0x1f4)['json']({'error':_0x5217df(0x19a)});});}catch(_0x4f059a){_0x2966ee[_0x17cc08(0x15e)]({'message':_0x4f059a[_0x17cc08(0x187)]});}});function BayBinSelected(_0x5208b2,_0x32eaee){var _0x378ae7=a0_0x2d11d7,_0x503a14=[];let _0x7c1c3a=[];var _0x192d3b=[];if(_0x5208b2==_0x378ae7(0x1af)){switch(_0x32eaee){case _0x378ae7(0x168):_0x503a14=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x378ae7(0x19c):_0x503a14=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x192d3b=['DG'];}else{if(_0x5208b2==_0x378ae7(0x1b0)){switch(_0x32eaee){case _0x378ae7(0x168):_0x503a14=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x378ae7(0x19c):_0x503a14=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x192d3b=['FG'];}}return{'levels':_0x503a14,'identify':_0x192d3b};}router[a0_0x2d11d7(0x190)]('/view/:id',auth,async(_0x324e6a,_0x4aaa65)=>{var _0x55aa50=a0_0x2d11d7;try{const {username:_0x36c743,email:_0x58d385,role:_0x76e42e}=_0x324e6a['user'],_0x350519=_0x324e6a[_0x55aa50(0x111)],_0x46d4c2=await profile['findOne']({'email':_0x350519[_0x55aa50(0x191)]}),_0x154734=await master_shop[_0x55aa50(0x156)](),_0x2c2697=await transfers_finished[_0x55aa50(0x1a8)](_0x324e6a[_0x55aa50(0x14a)]['id']);let _0x480a70=new Date(_0x2c2697[_0x55aa50(0x107)]),_0x504e69=('0'+_0x480a70[_0x55aa50(0x128)]())[_0x55aa50(0x153)](-0x2),_0x4e07d8=('0'+(_0x480a70[_0x55aa50(0x126)]()+0x1))['slice'](-0x2),_0x22a65b=_0x480a70['getFullYear'](),_0x37a7c2=_0x22a65b+'-'+_0x4e07d8+'-'+_0x504e69,_0x5619b4;if(_0x350519[_0x55aa50(0x105)]==_0x55aa50(0x146)){const _0x3fb5fa=await staff['findOne']({'email':_0x350519[_0x55aa50(0x191)]});_0x5619b4=await warehouse['find']({'status':_0x55aa50(0x188),'name':_0x3fb5fa[_0x55aa50(0x1b9)],'warehouse_category':'Finished\x20Goods'});}else _0x5619b4=await warehouse[_0x55aa50(0x156)]({'status':_0x55aa50(0x188),'warehouse_category':_0x55aa50(0x159)});const _0xd6b5ee=await warehouse[_0x55aa50(0x182)]([{'$match':{'name':_0x2c2697['from_warehouse'],'room':_0x2c2697[_0x55aa50(0x16c)]}},{'$unwind':_0x55aa50(0x112)},{'$group':{'_id':_0x55aa50(0x1a6),'name':{'$first':_0x55aa50(0x14f)},'product_stock':{'$first':_0x55aa50(0x167)},'bay':{'$first':_0x55aa50(0x1d1)},'bin':{'$first':_0x55aa50(0x1ce)},'type':{'$first':_0x55aa50(0x162)},'floorlevel':{'$first':_0x55aa50(0x131)},'primary_code':{'$first':_0x55aa50(0x1ab)},'secondary_code':{'$first':_0x55aa50(0x11e)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x55aa50(0x180)},'rack':{'$first':_0x55aa50(0x1c5)}}}]);var _0x2d9b65=[0x1,0x2,0x3,0x4],_0x324caf=['A','B','C','D','E','F','G','H','I','J'],_0x364048=['Ambient',_0x55aa50(0x10f)];const _0x855572=await product[_0x55aa50(0x156)]({}),_0x297949=BayBinSelected(_0x2c2697[_0x55aa50(0x192)],_0x2c2697[_0x55aa50(0x129)]);if(_0x154734[0x0]['language']==_0x55aa50(0x102)){var _0x4ccdf2=users[_0x55aa50(0x193)];console[_0x55aa50(0x177)](_0x4ccdf2);}else{if(_0x154734[0x0]['language']==_0x55aa50(0x10c))var _0x4ccdf2=users[_0x55aa50(0x10c)];else{if(_0x154734[0x0]['language']==_0x55aa50(0x155))var _0x4ccdf2=users[_0x55aa50(0x155)];else{if(_0x154734[0x0][_0x55aa50(0x13c)]==_0x55aa50(0x15b))var _0x4ccdf2=users[_0x55aa50(0x15b)];else{if(_0x154734[0x0][_0x55aa50(0x13c)]==_0x55aa50(0x133))var _0x4ccdf2=users[_0x55aa50(0x133)];else{if(_0x154734[0x0][_0x55aa50(0x13c)]==_0x55aa50(0x125))var _0x4ccdf2=users['Portuguese'];else{if(_0x154734[0x0][_0x55aa50(0x13c)]=='Chinese')var _0x4ccdf2=users[_0x55aa50(0x1be)];else{if(_0x154734[0x0][_0x55aa50(0x13c)]==_0x55aa50(0x158))var _0x4ccdf2=users[_0x55aa50(0x194)];}}}}}}}_0x4aaa65[_0x55aa50(0x179)](_0x55aa50(0x104),{'success':_0x324e6a[_0x55aa50(0x169)](_0x55aa50(0x148)),'errors':_0x324e6a[_0x55aa50(0x169)](_0x55aa50(0x147)),'role':_0x350519,'profile':_0x46d4c2,'master_shop':_0x154734,'warehouse':_0x5619b4,'transfer':_0x2c2697,'stock':_0xd6b5ee,'unit':_0x855572,'language':_0x4ccdf2,'levels':_0x2d9b65,'Isle':_0x324caf,'rooms_data':_0x364048,'ed_fullDate':_0x37a7c2,'dataSelected':_0x297949});}catch(_0x423602){console[_0x55aa50(0x177)](_0x423602);}}),router[a0_0x2d11d7(0x11b)](a0_0x2d11d7(0x135),auth,async(_0x368429,_0x12100c)=>{var _0x589f8b=a0_0x2d11d7;try{const _0x5d30f5=_0x368429[_0x589f8b(0x14a)]['id'];console[_0x589f8b(0x177)](_0x368429[_0x589f8b(0x172)]);const _0x300682=await transfers_finished[_0x589f8b(0x1a8)](_0x5d30f5);console[_0x589f8b(0x177)](_0x589f8b(0x1aa),_0x300682);const {date:_0x2f4d19,from_warehouse:_0x40f21e,FromRoom_name:_0x2c143e,to_warehouse:_0x540121,ToRoom_name:_0x4b3c00,prod_name:_0x4aea25,from_prod_qty:_0xce3a52,from_prod_level:_0xd80960,from_prod_isle:_0x4fdb15,from_prod_pallet:_0x485068,to_prod_qty:_0x11500b,to_prod_level:_0x2ca629,to_prod_isle:_0x44abb2,to_prod_pallet:_0x3b720d,primary_code:_0x3ccd9d,secondary_code:_0xab50a4,product_code3:_0x2b919a,note:_0x19b12b,invoice:_0x5e6120,expiry_date:_0x86db0e}=_0x368429[_0x589f8b(0x172)];if(typeof _0x4aea25==_0x589f8b(0x166))var _0x2e66bf=[_0x368429[_0x589f8b(0x172)]['prod_name']],_0x1fb11c=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x1c3)]],_0x56a95b=[_0x368429[_0x589f8b(0x172)]['from_prod_level']],_0x210860=[_0x368429[_0x589f8b(0x172)]['to_prod_qty']],_0x1fb6be=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x11a)]],_0x194158=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x103)]],_0x1f3762=[_0x368429['body'][_0x589f8b(0x1bb)]],_0x123cd1=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x1c2)]],_0x441152=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x163)]],_0x4f0914=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x178)]],_0x4a4a37=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x1a4)]],_0x3f96e0=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x198)]],_0x259772=[_0x368429[_0x589f8b(0x172)][_0x589f8b(0x107)]];else var _0x2e66bf=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x12d)]],_0x1fb11c=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x1c3)]],_0x56a95b=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x1bf)]],_0x210860=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x1a1)]],_0x1fb6be=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x11a)]],_0x194158=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x103)]],_0x1f3762=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x1bb)]],_0x123cd1=[..._0x368429['body'][_0x589f8b(0x1c2)]],_0x441152=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x163)]],_0x4f0914=[..._0x368429['body'][_0x589f8b(0x178)]],_0x4a4a37=[..._0x368429[_0x589f8b(0x172)]['secondary_unit']],_0x3f96e0=[..._0x368429['body'][_0x589f8b(0x198)]],_0x259772=[..._0x368429[_0x589f8b(0x172)][_0x589f8b(0x107)]];const _0x29de5a=_0x2e66bf[_0x589f8b(0x18b)](_0x510d0d=>{return _0x510d0d={'product_name':_0x510d0d};});_0x1fb11c['forEach']((_0x1c41ef,_0x3e2ca7)=>{var _0x2a152f=_0x589f8b;_0x29de5a[_0x3e2ca7][_0x2a152f(0x196)]=_0x1c41ef;}),_0x56a95b[_0x589f8b(0x1c8)]((_0x3aad6a,_0x6fd63e)=>{var _0x574942=_0x589f8b;_0x29de5a[_0x6fd63e][_0x574942(0x134)]=_0x3aad6a;}),_0x210860[_0x589f8b(0x1c8)]((_0x5ae37b,_0x49ce18)=>{var _0x173574=_0x589f8b;_0x29de5a[_0x49ce18][_0x173574(0x13a)]=_0x5ae37b;}),_0x1fb6be[_0x589f8b(0x1c8)]((_0x124635,_0xe472e5)=>{var _0x4b6a10=_0x589f8b;_0x29de5a[_0xe472e5][_0x4b6a10(0x197)]=_0x124635;}),_0x194158[_0x589f8b(0x1c8)]((_0x45575a,_0x1bed79)=>{_0x29de5a[_0x1bed79]['primary_code']=_0x45575a;}),_0x1f3762[_0x589f8b(0x1c8)]((_0x5f5a9c,_0x2b1289)=>{var _0xa3752=_0x589f8b;_0x29de5a[_0x2b1289][_0xa3752(0x1bb)]=_0x5f5a9c;}),_0x123cd1[_0x589f8b(0x1c8)]((_0x165f9e,_0x3aec96)=>{var _0x2bb7c5=_0x589f8b;_0x29de5a[_0x3aec96][_0x2bb7c5(0x18f)]=_0x165f9e;}),_0x441152[_0x589f8b(0x1c8)]((_0x34a2c8,_0x4b515e)=>{var _0x4cd9a1=_0x589f8b;_0x29de5a[_0x4b515e][_0x4cd9a1(0x1b2)]=_0x34a2c8;}),_0x4f0914[_0x589f8b(0x1c8)]((_0x317623,_0x47f76d)=>{_0x29de5a[_0x47f76d]['unit']=_0x317623;}),_0x4a4a37[_0x589f8b(0x1c8)]((_0x4629a4,_0xcffadd)=>{_0x29de5a[_0xcffadd]['secondary_unit']=_0x4629a4;}),_0x3f96e0[_0x589f8b(0x1c8)]((_0x577c93,_0x3a5b6f)=>{var _0x1fb4ce=_0x589f8b;_0x29de5a[_0x3a5b6f][_0x1fb4ce(0x198)]=_0x577c93;}),_0x259772['forEach']((_0x309ebd,_0x5ce25c)=>{var _0x38e6b6=_0x589f8b;_0x29de5a[_0x5ce25c][_0x38e6b6(0x107)]=_0x309ebd;});const _0x1c07fd=_0x29de5a[_0x589f8b(0x119)](_0x26bf84=>_0x26bf84[_0x589f8b(0x13a)]!=='0'&&_0x26bf84['to_quantity']!==''||_0x26bf84[_0x589f8b(0x1b4)]!=='0'&&_0x26bf84[_0x589f8b(0x1b4)]!=='');var _0x2d76f8=0x0;_0x1c07fd[_0x589f8b(0x1c8)](_0x40e04a=>{var _0xd3ae03=_0x589f8b;parseInt(_0x40e04a['from_quantity'])<parseInt(_0x40e04a[_0xd3ae03(0x13a)])&&_0x2d76f8++;});if(_0x2d76f8!=0x0)return _0x368429[_0x589f8b(0x169)](_0x589f8b(0x147),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x12100c['redirect']('back');const _0xa2145d=await warehouse['findOne']({'name':_0x300682['from_warehouse'],'room':_0x300682['from_room']});_0x300682[_0x589f8b(0x16a)][_0x589f8b(0x1c8)](_0x22d69e=>{var _0x3d6133=_0x589f8b;if(_0x22d69e[_0x3d6133(0x13a)]>0x0){const _0x3188ad=_0xa2145d[_0x3d6133(0x120)][_0x3d6133(0x18b)](_0x547845=>{var _0x4dbd7d=_0x3d6133;_0x547845[_0x4dbd7d(0x17c)]==_0x22d69e[_0x4dbd7d(0x17c)]&&_0x547845[_0x4dbd7d(0x139)]==_0x22d69e[_0x4dbd7d(0x134)]&&(_0x547845['product_stock']=parseInt(_0x547845[_0x4dbd7d(0x1ca)])+parseInt(_0x22d69e[_0x4dbd7d(0x13a)]));});}}),await _0xa2145d[_0x589f8b(0x132)]();const _0x134512=await warehouse['findOne']({'name':_0x300682[_0x589f8b(0x192)],'room':_0x300682['to_room']});_0x300682[_0x589f8b(0x16a)]['forEach'](_0x5584f1=>{var _0x3c0308=_0x589f8b;if(_0x5584f1[_0x3c0308(0x13a)]>0x0){const _0x1f3b8d=_0x134512[_0x3c0308(0x120)][_0x3c0308(0x18b)](_0x27d741=>{var _0x44e247=_0x3c0308;_0x27d741[_0x44e247(0x17c)]==_0x5584f1['product_name']&&_0x27d741[_0x44e247(0x139)]==_0x5584f1[_0x44e247(0x197)]&&(_0x27d741[_0x44e247(0x1ca)]=parseInt(_0x27d741[_0x44e247(0x1ca)])-parseInt(_0x5584f1[_0x44e247(0x13a)]));});}}),await _0x134512[_0x589f8b(0x132)](),_0x300682[_0x589f8b(0x14b)]=_0x2f4d19,_0x300682[_0x589f8b(0x10b)]=_0x40f21e,_0x300682['to_warehouse']=_0x540121,_0x300682[_0x589f8b(0x16a)]=_0x1c07fd,_0x300682[_0x589f8b(0x137)]=_0x19b12b,_0x300682[_0x589f8b(0x122)]=_0x5e6120;const _0x362fa3=await _0x300682['save'](),_0x325583=await warehouse['findOne']({'name':_0x40f21e,'room':_0x2c143e});_0x362fa3['product']['forEach'](_0x11189d=>{var _0x359bad=_0x589f8b;if(_0x11189d[_0x359bad(0x13a)]>0x0){const _0x26f07c=_0x325583[_0x359bad(0x120)][_0x359bad(0x18b)](_0x56cd1a=>{var _0x2bbf3f=_0x359bad;_0x56cd1a['product_name']==_0x11189d[_0x2bbf3f(0x17c)]&&_0x56cd1a[_0x2bbf3f(0x139)]==_0x11189d[_0x2bbf3f(0x134)]&&(_0x56cd1a[_0x2bbf3f(0x1ca)]=parseInt(_0x56cd1a[_0x2bbf3f(0x1ca)])-parseInt(_0x11189d['to_quantity']));});}}),await _0x325583['save']();const _0x324e14=await warehouse['findOne']({'name':_0x540121,'room':_0x4b3c00});_0x362fa3[_0x589f8b(0x16a)][_0x589f8b(0x1c8)](_0x3f3b85=>{var _0x573266=_0x589f8b;if(_0x3f3b85['to_quantity']>0x0){var _0x15490c=0x0;const _0x1d3a4f=_0x324e14[_0x573266(0x120)][_0x573266(0x18b)](_0x52ba8f=>{var _0x1d2bc0=_0x573266;_0x52ba8f['product_name']==_0x3f3b85['product_name']&&_0x52ba8f['bay']==_0x3f3b85[_0x1d2bc0(0x197)]&&(_0x52ba8f[_0x1d2bc0(0x1ca)]=parseInt(_0x52ba8f[_0x1d2bc0(0x1ca)])+parseInt(_0x3f3b85[_0x1d2bc0(0x13a)]),_0x15490c++);});_0x15490c=='0'&&(_0x324e14[_0x573266(0x120)]=_0x324e14[_0x573266(0x120)][_0x573266(0x1bc)]({'product_name':_0x3f3b85[_0x573266(0x17c)],'product_stock':_0x3f3b85[_0x573266(0x13a)],'bay':_0x3f3b85[_0x573266(0x197)],'product_code':_0x3f3b85[_0x573266(0x18f)],'primary_code':_0x3f3b85['primary_code'],'secondary_code':_0x3f3b85[_0x573266(0x1bb)],'maxProducts':_0x3f3b85['maxProducts']}));}}),await _0x324e14[_0x589f8b(0x132)](),_0x368429[_0x589f8b(0x169)](_0x589f8b(0x148),'Transfer\x20Edit\x20Successfully'),_0x12100c['redirect'](_0x589f8b(0x173));}catch(_0x11ca45){console['log'](_0x11ca45);}}),router[a0_0x2d11d7(0x11b)]('/barcode_scanner',async(_0xd6342b,_0x1ce1aa)=>{var _0x954799=a0_0x2d11d7;const {FromWareHouse:_0x3956e2,FromRoom:_0x1d4af4,ToWarehouse:_0x259f66,ToRoom:_0x13568d,primary_code:_0x1484f8,Roomslist:_0x1b0c0a}=_0xd6342b[_0x954799(0x172)],_0x35a663=_0x1b0c0a['split'](','),_0x3912a0=[];async function _0xa44b6d(_0x12c123){var _0x3a78cc=_0x954799;const _0x1f0581=await warehouse[_0x3a78cc(0x182)]([{'$match':{'name':_0x3956e2,'room':_0x12c123}},{'$unwind':_0x3a78cc(0x112)},{'$match':{'product_details.primary_code':_0x1484f8}},{'$group':{'_id':_0x3a78cc(0x1a6),'name':{'$first':_0x3a78cc(0x14f)},'instock':{'$first':_0x3a78cc(0x167)},'primary_code':{'$first':_0x3a78cc(0x1ab)},'secondary_code':{'$first':_0x3a78cc(0x11e)},'product_code':{'$first':_0x3a78cc(0x19d)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x3a78cc(0x1ce)},'type':{'$first':_0x3a78cc(0x162)},'pallet':{'$first':_0x3a78cc(0x131)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3a78cc(0x174)},'storage':{'$first':_0x3a78cc(0x180)},'rack':{'$first':_0x3a78cc(0x1c5)},'expiry_date':{'$first':_0x3a78cc(0x17f)},'production_date':{'$first':_0x3a78cc(0x142)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x3a78cc(0x1c4)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x3a78cc(0x115)}}}]),_0x3d2048=await warehouse[_0x3a78cc(0x182)]([{'$match':{'name':_0x3956e2,'room':_0x12c123}},{'$unwind':_0x3a78cc(0x112)},{'$match':{'product_details.secondary_code':_0x1484f8}},{'$group':{'_id':_0x3a78cc(0x1a6),'name':{'$first':_0x3a78cc(0x14f)},'instock':{'$first':_0x3a78cc(0x167)},'primary_code':{'$first':_0x3a78cc(0x1ab)},'secondary_code':{'$first':_0x3a78cc(0x11e)},'product_code':{'$first':_0x3a78cc(0x19d)},'level':{'$first':_0x3a78cc(0x1d1)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3a78cc(0x162)},'pallet':{'$first':_0x3a78cc(0x131)},'unit':{'$first':_0x3a78cc(0x143)},'secondary_unit':{'$first':_0x3a78cc(0x174)},'storage':{'$first':_0x3a78cc(0x180)},'rack':{'$first':_0x3a78cc(0x1c5)},'expiry_date':{'$first':_0x3a78cc(0x17f)},'production_date':{'$first':_0x3a78cc(0x142)},'batch_code':{'$first':_0x3a78cc(0x164)},'maxPerUnit':{'$first':_0x3a78cc(0x1c4)},'roomNamed':{'$first':_0x3a78cc(0x12c)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x3a78cc(0x115)}}}]);if(_0x1f0581['length']>0x0)_0x3912a0[_0x3a78cc(0x17b)](_0x1f0581);else _0x3d2048['length']>0x0&&_0x3912a0[_0x3a78cc(0x17b)](_0x3d2048);}const _0x5c243a=_0x35a663[_0x954799(0x18b)](_0x393302=>_0xa44b6d(_0x393302));await Promise[_0x954799(0x1b8)](_0x5c243a),_0x1ce1aa[_0x954799(0x15e)](_0x3912a0);}),router[a0_0x2d11d7(0x11b)](a0_0x2d11d7(0x15a),async(_0x4b096e,_0x547063)=>{var _0x4b1afe=a0_0x2d11d7;try{const {FromWareHouse:_0x1c0d5e,FromRoom:_0x257dda,ToWarehouse:_0x3c0517,ToRoom:_0x54dae2,secondary_code:_0x1a7f5f}=_0x4b096e[_0x4b1afe(0x172)],_0x2508bf=await warehouse['aggregate']([{'$match':{'name':_0x1c0d5e}},{'$unwind':_0x4b1afe(0x112)},{'$match':{'product_details.secondary_code':_0x1a7f5f}},{'$group':{'_id':_0x4b1afe(0x1a6),'name':{'$first':_0x4b1afe(0x14f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x4b1afe(0x161)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x4b1afe(0x19e)},'maxProducts':{'$first':_0x4b1afe(0x1c0)},'unit':{'$first':_0x4b1afe(0x143)},'expiry_date':{'$first':_0x4b1afe(0x17f)},'production_date':{'$first':_0x4b1afe(0x142)}}}]);_0x547063[_0x4b1afe(0x1ad)](0xc8)[_0x4b1afe(0x15e)](_0x2508bf);}catch(_0x4b373c){_0x547063['status'](0x194)[_0x4b1afe(0x15e)]({'message':_0x4b373c['message']});}}),router['post'](a0_0x2d11d7(0x1bd),async(_0x54ed13,_0x3bbccd)=>{var _0xd523ee=a0_0x2d11d7;try{const {FromWareHouse:_0x26e36b,FromRoom:_0x189361,ToWarehouse:_0x2beef1,ToRoom:_0x6069bf,product_code:_0x47c918}=_0x54ed13[_0xd523ee(0x172)],_0x4a45cc=await warehouse['aggregate']([{'$match':{'name':_0x26e36b}},{'$unwind':_0xd523ee(0x112)},{'$match':{'product_details.product_code':_0x47c918}},{'$group':{'_id':_0xd523ee(0x1a6),'name':{'$first':_0xd523ee(0x14f)},'primary_code':{'$first':_0xd523ee(0x1ab)},'secondary_code':{'$first':_0xd523ee(0x11e)},'product_code':{'$first':_0xd523ee(0x19d)},'instock':{'$first':_0xd523ee(0x167)},'warehouse':{'$first':_0xd523ee(0x161)},'level':{'$first':_0xd523ee(0x13e)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'}}}]);_0x3bbccd[_0xd523ee(0x1ad)](0xc8)[_0xd523ee(0x15e)](_0x4a45cc);}catch(_0x3d1199){_0x3bbccd[_0xd523ee(0x1ad)](0x194)[_0xd523ee(0x15e)]({'message':_0x3d1199[_0xd523ee(0x187)]});}}),router[a0_0x2d11d7(0x11b)](a0_0x2d11d7(0x1d0),async(_0x234c6a,_0x5c0aae)=>{var _0x22f451=a0_0x2d11d7;const {productCode:_0xc5d639,bay:_0x49e992,warehouses:_0x405d37,room:_0x141957}=_0x234c6a[_0x22f451(0x172)];console[_0x22f451(0x177)](_0x234c6a[_0x22f451(0x172)]);try{const _0x1834c2=await warehouse['aggregate']([{'$match':{'name':_0x405d37,'room':_0x141957}},{'$unwind':_0x22f451(0x112)},{'$match':{'product_details.bay':parseInt(_0x49e992)}},{'$group':{'_id':_0x22f451(0x1a6),'name':{'$first':_0x22f451(0x14f)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x22f451(0x1d1)},'maxProducts':{'$first':_0x22f451(0x1c0)}}}]);_0x5c0aae[_0x22f451(0x1ad)](0xc8)[_0x22f451(0x15e)](_0x1834c2);}catch(_0x51bd1b){_0x5c0aae['status'](0x194)[_0x22f451(0x15e)]({'message':_0x51bd1b[_0x22f451(0x187)]});}}),module['exports']=router;