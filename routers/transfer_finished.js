var a0_0x442c70=a0_0x58db;(function(_0x5bacd3,_0x42d19d){var _0x404e02=a0_0x58db,_0x4c7089=_0x5bacd3();while(!![]){try{var _0x506e59=-parseInt(_0x404e02(0x1ce))/0x1+parseInt(_0x404e02(0x1ed))/0x2+-parseInt(_0x404e02(0x286))/0x3*(-parseInt(_0x404e02(0x228))/0x4)+parseInt(_0x404e02(0x1d7))/0x5*(-parseInt(_0x404e02(0x251))/0x6)+parseInt(_0x404e02(0x285))/0x7+parseInt(_0x404e02(0x21c))/0x8+-parseInt(_0x404e02(0x244))/0x9;if(_0x506e59===_0x42d19d)break;else _0x4c7089['push'](_0x4c7089['shift']());}catch(_0x20653a){_0x4c7089['push'](_0x4c7089['shift']());}}}(a0_0x4f55,0x81116));function a0_0x58db(_0x579cb6,_0x45fcd8){var _0x4f5527=a0_0x4f55();return a0_0x58db=function(_0x58db29,_0x232814){_0x58db29=_0x58db29-0x1c0;var _0x314902=_0x4f5527[_0x58db29];return _0x314902;},a0_0x58db(_0x579cb6,_0x45fcd8);}const express=require('express'),app=express(),router=express[a0_0x442c70(0x1d1)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x442c70(0x1f3)),auth=require(a0_0x442c70(0x230)),users=require(a0_0x442c70(0x1e4)),nodemailer=require(a0_0x442c70(0x233));router[a0_0x442c70(0x2a0)](a0_0x442c70(0x1c2),auth,async(_0x4192a3,_0x5154ab)=>{var _0x460381=a0_0x442c70;try{const {username:_0x35969e,email:_0x5744c8,role:_0xc02f75}=_0x4192a3[_0x460381(0x29a)],_0x2f3304=_0x4192a3[_0x460381(0x29a)],_0xb1fa18=await profile[_0x460381(0x267)]({'email':_0x2f3304[_0x460381(0x279)]}),_0x4efe09=await master_shop[_0x460381(0x26c)]();let _0x4f467c;if(_0x2f3304[_0x460381(0x264)]==_0x460381(0x22f)){const _0x45dfb8=await staff[_0x460381(0x267)]({'email':_0x2f3304[_0x460381(0x279)]});_0x4f467c=await transfers_finished[_0x460381(0x26c)]({'from_warehouse':_0x45dfb8[_0x460381(0x28d)]});}else _0x4f467c=await transfers_finished[_0x460381(0x1c3)]([{'$unwind':_0x460381(0x22a)},{'$group':{'_id':_0x460381(0x296),'invoice':{'$first':_0x460381(0x23a)},'date':{'$first':_0x460381(0x239)},'from_warehouse':{'$first':_0x460381(0x1c6)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x460381(0x298)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x4efe09[0x0]['language']==_0x460381(0x253))var _0x83cc26=users['English'];else{if(_0x4efe09[0x0]['language']==_0x460381(0x1f4))var _0x83cc26=users[_0x460381(0x1f4)];else{if(_0x4efe09[0x0]['language']=='German')var _0x83cc26=users['German'];else{if(_0x4efe09[0x0]['language']==_0x460381(0x1d0))var _0x83cc26=users[_0x460381(0x1d0)];else{if(_0x4efe09[0x0][_0x460381(0x254)]==_0x460381(0x274))var _0x83cc26=users[_0x460381(0x274)];else{if(_0x4efe09[0x0][_0x460381(0x254)]=='Portuguese\x20(BR)')var _0x83cc26=users[_0x460381(0x210)];else{if(_0x4efe09[0x0][_0x460381(0x254)]==_0x460381(0x213))var _0x83cc26=users[_0x460381(0x213)];else{if(_0x4efe09[0x0][_0x460381(0x254)]==_0x460381(0x20e))var _0x83cc26=users[_0x460381(0x219)];}}}}}}}_0x5154ab[_0x460381(0x24f)](_0x460381(0x203),{'success':_0x4192a3[_0x460381(0x282)](_0x460381(0x273)),'errors':_0x4192a3[_0x460381(0x282)](_0x460381(0x1c7)),'role':_0x2f3304,'profile':_0xb1fa18,'master_shop':_0x4efe09,'transfer':_0x4f467c,'language':_0x83cc26});}catch(_0xadbc3a){console['log'](_0xadbc3a);}});async function getRandom8DigitNumber(){var _0x373aa3=a0_0x442c70;const _0x3d157c=0x989680,_0x5a3d22=0x5f5e0ff,_0x3157c5=Math['floor'](Math[_0x373aa3(0x29c)]()*(_0x5a3d22-_0x3d157c+0x1))+_0x3d157c;var _0x43c9f6;const _0x942684=await transfers_finished['findOne']({'invoice':'TRFF-'+_0x3157c5});return _0x942684&&_0x942684[_0x373aa3(0x232)]>0x0?_0x43c9f6=_0x373aa3(0x27f)+_0x3157c5:_0x43c9f6=_0x373aa3(0x27f)+_0x3157c5,_0x43c9f6;}router['get']('/view/add_transfer',auth,async(_0x3b61db,_0xad3be2)=>{var _0x229152=a0_0x442c70;try{const {username:_0x15baf3,email:_0x53fece,role:_0x5906eb}=_0x3b61db['user'],_0x29835f=_0x3b61db[_0x229152(0x29a)],_0x25f8bb=await profile[_0x229152(0x267)]({'email':_0x29835f[_0x229152(0x279)]}),_0x51c45d=await master_shop[_0x229152(0x26c)]();let _0x1c9668;if(_0x29835f[_0x229152(0x264)]==_0x229152(0x22f)){const _0x30685e=await staff[_0x229152(0x267)]({'email':_0x29835f['email']});_0x1c9668=await warehouse[_0x229152(0x1c3)]([{'$match':{'status':_0x229152(0x204),'name':_0x30685e[_0x229152(0x28d)],'warehouse_category':_0x229152(0x271),'name':{'$ne':_0x229152(0x1f8)}}},{'$group':{'_id':_0x229152(0x29e),'name':{'$first':_0x229152(0x29e)}}}]);}else _0x1c9668=await warehouse[_0x229152(0x1c3)]([{'$match':{'status':_0x229152(0x204),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x229152(0x1f8)}}},{'$group':{'_id':_0x229152(0x29e),'name':{'$first':_0x229152(0x29e)}}}]);const _0x3b01fa=await transfers_finished[_0x229152(0x26c)]({}),_0x4864ff=_0x3b01fa[_0x229152(0x232)]+0x1,_0x27706d=_0x229152(0x27f)+_0x4864ff[_0x229152(0x27a)]()[_0x229152(0x25d)](0x5,'0');if(_0x51c45d[0x0]['language']=='English\x20(US)')var _0x5c1220=users[_0x229152(0x1f5)];else{if(_0x51c45d[0x0]['language']==_0x229152(0x1f4))var _0x5c1220=users[_0x229152(0x1f4)];else{if(_0x51c45d[0x0][_0x229152(0x254)]==_0x229152(0x277))var _0x5c1220=users['German'];else{if(_0x51c45d[0x0][_0x229152(0x254)]==_0x229152(0x1d0))var _0x5c1220=users['Spanish'];else{if(_0x51c45d[0x0]['language']==_0x229152(0x274))var _0x5c1220=users[_0x229152(0x274)];else{if(_0x51c45d[0x0][_0x229152(0x254)]==_0x229152(0x290))var _0x5c1220=users[_0x229152(0x210)];else{if(_0x51c45d[0x0][_0x229152(0x254)]==_0x229152(0x213))var _0x5c1220=users[_0x229152(0x213)];else{if(_0x51c45d[0x0][_0x229152(0x254)]==_0x229152(0x20e))var _0x5c1220=users[_0x229152(0x219)];}}}}}}}const _0x4d5792=getRandom8DigitNumber();_0x4d5792['then'](_0x2a9cc9=>{var _0x3fd5d3=_0x229152;_0xad3be2[_0x3fd5d3(0x24f)]('add_transfer_finished',{'success':_0x3b61db[_0x3fd5d3(0x282)](_0x3fd5d3(0x273)),'errors':_0x3b61db[_0x3fd5d3(0x282)]('errors'),'role':_0x29835f,'profile':_0x25f8bb,'master_shop':_0x51c45d,'warehouse':_0x1c9668,'language':_0x5c1220,'invoice':_0x2a9cc9});})['catch'](_0x13a676=>{var _0x5f4031=_0x229152;_0x3b61db['flash'](_0x5f4031(0x1c7),_0x5f4031(0x297)),_0xad3be2[_0x5f4031(0x1d9)](_0x5f4031(0x255));});}catch(_0xa5eed2){console[_0x229152(0x270)](_0xa5eed2);}}),router[a0_0x442c70(0x1f0)](a0_0x442c70(0x25b),auth,async(_0x3d9b6f,_0x3bbcf0)=>{var _0x433e93=a0_0x442c70;try{const {date:_0x49fcfa,from_warehouse:_0x504fc4,FromRoom_name:_0x1ab19a,to_warehouse:_0x501046,ToRoom_name:_0x24eee0,prod_name:_0x4b4c0f,from_prod_qty:_0x35d503,from_prod_level:_0x2a2ba6,from_prod_isle:_0x5aa721,from_prod_pallet:_0x1fd67a,to_prod_qty:_0x45eaa5,to_prod_level:_0x440eb1,to_prod_isle:_0x21d3b1,to_prod_pallet:_0x2aa4c1,primary_code:_0x4bdfdb,secondary_code:_0x5785d0,product_code3:_0xf19d46,note:_0x4d9779,MaxStocks_data2:_0x334867,invoice:_0x138085,expiry_date:_0x2fc1a6}=_0x3d9b6f[_0x433e93(0x1f9)];if(typeof _0x4b4c0f==_0x433e93(0x258))var _0xb32da6=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x249)]],_0x509430=[_0x3d9b6f[_0x433e93(0x1f9)]['from_prod_qty']],_0x2c04d9=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x218)]],_0x4e7257=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1c1)]],_0x352871=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x217)]],_0x16d6e0=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x26b)]],_0x5c7087=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x20c)]],_0x2b9da2=[_0x3d9b6f['body'][_0x433e93(0x260)]],_0x12fd88=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x257)]],_0x305bdc=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x238)]],_0x1bb609=[_0x3d9b6f['body']['secondary_unit']],_0x16bee6=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x26d)]],_0x44162e=[_0x3d9b6f['body'][_0x433e93(0x227)]],_0x3735bc=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1d6)]],_0xd13fea=[_0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1cc)]],_0x4dcf49=[_0x3d9b6f['body'][_0x433e93(0x231)]],_0x107405=[_0x3d9b6f['body'][_0x433e93(0x1cf)]],_0x47da1a=[_0x3d9b6f[_0x433e93(0x1f9)]['RoomAssigned']],_0x55c192=[_0x3d9b6f[_0x433e93(0x1f9)]['ToRoomAssigned']],_0x3e177e=[_0x3d9b6f['body'][_0x433e93(0x272)]],_0x52db41=[_0x3d9b6f['body']['to_invoice']],_0x1d325f=[_0x3d9b6f['body'][_0x433e93(0x1d8)]];else var _0xb32da6=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x249)]],_0x509430=[..._0x3d9b6f['body'][_0x433e93(0x205)]],_0x2c04d9=[..._0x3d9b6f['body'][_0x433e93(0x218)]],_0x4e7257=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1c1)]],_0x352871=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x217)]],_0x16d6e0=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x26b)]],_0x5c7087=[..._0x3d9b6f['body'][_0x433e93(0x20c)]],_0x2b9da2=[..._0x3d9b6f['body'][_0x433e93(0x260)]],_0x12fd88=[..._0x3d9b6f['body'][_0x433e93(0x257)]],_0x305bdc=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x238)]],_0x1bb609=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1cb)]],_0x16bee6=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x26d)]],_0x44162e=[..._0x3d9b6f['body'][_0x433e93(0x227)]],_0x3735bc=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1d6)]],_0xd13fea=[..._0x3d9b6f['body'][_0x433e93(0x1cc)]],_0x4dcf49=[..._0x3d9b6f['body']['maxPerUnit']],_0x107405=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1cf)]],_0x47da1a=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x280)]],_0x55c192=[..._0x3d9b6f['body'][_0x433e93(0x250)]],_0x3e177e=[..._0x3d9b6f[_0x433e93(0x1f9)]['from_invoice']],_0x52db41=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x246)]],_0x1d325f=[..._0x3d9b6f[_0x433e93(0x1f9)][_0x433e93(0x1d8)]];const _0x2178d6=_0xb32da6['map'](_0x3c77ff=>{return _0x3c77ff={'product_name':_0x3c77ff};});_0x509430[_0x433e93(0x20a)]((_0x2d5dfa,_0x3c1e5b)=>{var _0x43315e=_0x433e93;_0x2178d6[_0x3c1e5b][_0x43315e(0x261)]=_0x2d5dfa;}),_0x2c04d9[_0x433e93(0x20a)]((_0x33c852,_0x564bbc)=>{var _0x31131e=_0x433e93;_0x2178d6[_0x564bbc][_0x31131e(0x235)]=_0x33c852;}),_0x1d325f[_0x433e93(0x20a)]((_0x1059b8,_0x3a6b48)=>{var _0x5d81a8=_0x433e93;_0x2178d6[_0x3a6b48][_0x5d81a8(0x1d8)]=_0x1059b8;}),_0x3e177e[_0x433e93(0x20a)]((_0x3c3f7d,_0x38d610)=>{_0x2178d6[_0x38d610]['from_invoice']=_0x3c3f7d;}),_0x52db41[_0x433e93(0x20a)]((_0x1644b8,_0x52f76d)=>{var _0x54c61a=_0x433e93;_0x2178d6[_0x52f76d][_0x54c61a(0x23e)]=_0x1644b8;}),_0x4e7257[_0x433e93(0x20a)]((_0x248f9e,_0x5b947d)=>{var _0x5f45f6=_0x433e93;_0x2178d6[_0x5b947d][_0x5f45f6(0x256)]=_0x248f9e;}),_0x352871[_0x433e93(0x20a)]((_0x5a2e5c,_0x10c018)=>{_0x2178d6[_0x10c018]['to_bay']=_0x5a2e5c;}),_0x16d6e0['forEach']((_0x1f1d77,_0x360260)=>{var _0x526c32=_0x433e93;_0x2178d6[_0x360260][_0x526c32(0x26b)]=_0x1f1d77;}),_0x5c7087[_0x433e93(0x20a)]((_0x187240,_0x353fe7)=>{var _0x14af9d=_0x433e93;_0x2178d6[_0x353fe7][_0x14af9d(0x20c)]=_0x187240;}),_0x2b9da2[_0x433e93(0x20a)]((_0x3dc9ac,_0x246f12)=>{_0x2178d6[_0x246f12]['product_code']=_0x3dc9ac;}),_0x12fd88[_0x433e93(0x20a)]((_0x3d8631,_0xe96d1f)=>{var _0x4ff544=_0x433e93;_0x2178d6[_0xe96d1f][_0x4ff544(0x1e1)]=_0x3d8631;}),_0x305bdc['forEach']((_0x116284,_0x35a5bc)=>{var _0x5ac35c=_0x433e93;_0x2178d6[_0x35a5bc][_0x5ac35c(0x236)]=_0x116284;}),_0x1bb609[_0x433e93(0x20a)]((_0x315837,_0x45e60e)=>{var _0x301d38=_0x433e93;_0x2178d6[_0x45e60e][_0x301d38(0x1cb)]=_0x315837;}),_0x16bee6[_0x433e93(0x20a)]((_0x238241,_0x44e11e)=>{var _0x5428c1=_0x433e93;_0x2178d6[_0x44e11e][_0x5428c1(0x26d)]=_0x238241;}),_0x44162e[_0x433e93(0x20a)]((_0x1d385c,_0x13a796)=>{var _0x4113ac=_0x433e93;_0x2178d6[_0x13a796][_0x4113ac(0x227)]=_0x1d385c;}),_0x3735bc[_0x433e93(0x20a)]((_0x9f13dc,_0x318753)=>{_0x2178d6[_0x318753]['production_date']=_0x9f13dc;}),_0xd13fea['forEach']((_0x55be80,_0x4387b1)=>{var _0x97862=_0x433e93;_0x2178d6[_0x4387b1][_0x97862(0x1e1)]=_0x55be80;}),_0x4dcf49[_0x433e93(0x20a)]((_0x1aaea4,_0x35f166)=>{var _0x4e94ae=_0x433e93;_0x2178d6[_0x35f166][_0x4e94ae(0x231)]=_0x1aaea4;}),_0x107405[_0x433e93(0x20a)]((_0x304698,_0x4c5a2a)=>{var _0x51c502=_0x433e93;_0x2178d6[_0x4c5a2a][_0x51c502(0x1cf)]=_0x304698;}),_0x47da1a[_0x433e93(0x20a)]((_0xea14ad,_0x11b6e8)=>{var _0x3fee6c=_0x433e93;_0x2178d6[_0x11b6e8][_0x3fee6c(0x1ef)]=_0xea14ad;}),_0x55c192['forEach']((_0x2bc0dc,_0x51ae89)=>{var _0x4a6dd5=_0x433e93;_0x2178d6[_0x51ae89][_0x4a6dd5(0x20f)]=_0x2bc0dc;});const _0x35119a=_0x2178d6['filter'](_0x1c4ae9=>_0x1c4ae9['to_quantity']!=='0'&&_0x1c4ae9['to_quantity']!==''||_0x1c4ae9[_0x433e93(0x266)]!=='0'&&_0x1c4ae9[_0x433e93(0x266)]!=='');var _0x684962=0x0;_0x35119a[_0x433e93(0x20a)](_0x5650a2=>{parseInt(_0x5650a2['from_quantity'])<parseInt(_0x5650a2['to_quantity'])&&_0x684962++;});if(_0x684962!=0x0)return _0x3d9b6f['flash'](_0x433e93(0x1c7),_0x433e93(0x200)),_0x3bbcf0['redirect'](_0x433e93(0x22d));const _0x557199=new transfers_finished({'date':_0x49fcfa,'from_warehouse':_0x504fc4,'to_warehouse':_0x501046,'product':_0x35119a,'note':_0x4d9779,'invoice':_0x138085}),_0xdb0054=await _0x557199[_0x433e93(0x1de)]();_0x3d9b6f[_0x433e93(0x282)]('success',_0x433e93(0x207)),_0x3bbcf0['redirect']('/transfer_finished/preview/'+_0xdb0054[_0x433e93(0x262)]);}catch(_0x48fa4c){console[_0x433e93(0x270)](_0x48fa4c),_0x3bbcf0[_0x433e93(0x241)](0xc8)[_0x433e93(0x23b)]({'errorMessage':_0x48fa4c[_0x433e93(0x291)]});}}),router[a0_0x442c70(0x2a0)](a0_0x442c70(0x21b),auth,async(_0x31708e,_0x3bedfc)=>{var _0x194996=a0_0x442c70;try{const {username:_0x38a8a2,email:_0xc0bfad,role:_0x5b5106}=_0x31708e[_0x194996(0x29a)],_0x44522f=_0x31708e['user'],_0x3e444d=await profile[_0x194996(0x267)]({'email':_0x44522f['email']}),_0x78594f=await master_shop[_0x194996(0x26c)](),_0x4097d7=await transfers_finished[_0x194996(0x1c5)](_0x31708e[_0x194996(0x216)]['id']);let _0x122c11;if(_0x44522f[_0x194996(0x264)]==_0x194996(0x22f)){const _0x284a9a=await staff[_0x194996(0x267)]({'email':_0x44522f['email']});_0x122c11=await warehouse[_0x194996(0x26c)]({'status':'Enabled','name':_0x284a9a['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x122c11=await warehouse[_0x194996(0x26c)]({'status':_0x194996(0x204),'warehouse_category':_0x194996(0x271)});const _0x5979c6=await warehouse[_0x194996(0x1c3)]([{'$match':{'name':_0x4097d7[_0x194996(0x1eb)],'warehouse_category':_0x194996(0x271)}},{'$unwind':_0x194996(0x1d5)},{'$group':{'_id':_0x194996(0x1e9),'name':{'$first':_0x194996(0x1cd)},'product_stock':{'$first':_0x194996(0x23c)},'bay':{'$first':_0x194996(0x206)},'bin':{'$first':_0x194996(0x24e)},'type':{'$first':_0x194996(0x1da)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x194996(0x1ee)},'secondary_code':{'$first':_0x194996(0x1fc)},'product_code':{'$first':_0x194996(0x234)},'storage':{'$first':_0x194996(0x21a)},'rack':{'$first':_0x194996(0x211)},'expiry_date':{'$first':_0x194996(0x21f)},'production_date':{'$first':_0x194996(0x226)},'room':{'$first':_0x194996(0x275)},'warehoue_name':{'$first':_0x194996(0x29e)}}}]),_0x3a47ac=await product[_0x194996(0x26c)]({});if(_0x78594f[0x0]['language']==_0x194996(0x253)){var _0x52c0fc=users[_0x194996(0x1f5)];console[_0x194996(0x270)](_0x52c0fc);}else{if(_0x78594f[0x0][_0x194996(0x254)]==_0x194996(0x1f4))var _0x52c0fc=users[_0x194996(0x1f4)];else{if(_0x78594f[0x0]['language']==_0x194996(0x277))var _0x52c0fc=users[_0x194996(0x277)];else{if(_0x78594f[0x0][_0x194996(0x254)]==_0x194996(0x1d0))var _0x52c0fc=users[_0x194996(0x1d0)];else{if(_0x78594f[0x0]['language']==_0x194996(0x274))var _0x52c0fc=users[_0x194996(0x274)];else{if(_0x78594f[0x0]['language']=='Portuguese\x20(BR)')var _0x52c0fc=users[_0x194996(0x210)];else{if(_0x78594f[0x0][_0x194996(0x254)]==_0x194996(0x213))var _0x52c0fc=users[_0x194996(0x213)];else{if(_0x78594f[0x0][_0x194996(0x254)]==_0x194996(0x20e))var _0x52c0fc=users['Arabic'];}}}}}}}_0x3bedfc[_0x194996(0x24f)]('edit_transfer_finished_view',{'success':_0x31708e[_0x194996(0x282)](_0x194996(0x273)),'errors':_0x31708e[_0x194996(0x282)](_0x194996(0x1c7)),'role':_0x44522f,'profile':_0x3e444d,'master_shop':_0x78594f,'warehouse':_0x122c11,'transfer':_0x4097d7,'stock':_0x5979c6,'unit':_0x3a47ac,'language':_0x52c0fc});}catch(_0x4e2268){console[_0x194996(0x270)](_0x4e2268);}}),router[a0_0x442c70(0x1f0)](a0_0x442c70(0x21b),auth,async(_0x2a7b88,_0x8248aa)=>{var _0x57cf5b=a0_0x442c70;try{const {invoice:_0x30632e,from_warehouse:_0x7b7623,FromRoom_name:_0x8d5bd3,to_warehouse:_0x5d4b49,ToRoom_name:_0x2aa66c}=_0x2a7b88[_0x57cf5b(0x1f9)],_0x3c7045=await transfers_finished[_0x57cf5b(0x1c5)](_0x2a7b88[_0x57cf5b(0x216)]['id']),_0x79188d=_0x3c7045[_0x57cf5b(0x21e)]['map'](async _0x589808=>{var _0x18695a=_0x57cf5b;if(_0x589808[_0x18695a(0x256)]>0x0){var _0x3fb015=await warehouse[_0x18695a(0x267)]({'name':_0x7b7623,'room':_0x589808[_0x18695a(0x1ef)],'warehouse_category':_0x18695a(0x271)});const _0x54a57e=_0x3fb015[_0x18695a(0x22c)][_0x18695a(0x20d)](_0x5eba97=>{var _0x5cfe2e=_0x18695a;_0x5eba97[_0x5cfe2e(0x1c9)]==_0x589808[_0x5cfe2e(0x1c9)]&&_0x5eba97[_0x5cfe2e(0x208)]==_0x589808[_0x5cfe2e(0x235)]&&_0x5eba97[_0x5cfe2e(0x227)]==_0x589808[_0x5cfe2e(0x227)]&&_0x5eba97[_0x5cfe2e(0x1fa)]==_0x589808[_0x5cfe2e(0x1fa)]&&_0x5eba97[_0x5cfe2e(0x26d)]==_0x589808[_0x5cfe2e(0x26d)]&&_0x5eba97['invoice']==_0x589808['from_invoice']&&(console[_0x5cfe2e(0x270)](_0x5cfe2e(0x1e5),_0x5eba97[_0x5cfe2e(0x24b)]),typeof _0x589808['id_transaction']=='undefined'?_0x5eba97[_0x5cfe2e(0x24b)]=Math[_0x5cfe2e(0x28b)](0x0,Math[_0x5cfe2e(0x24d)](_0x5eba97['product_stock'])-Math[_0x5cfe2e(0x24d)](_0x589808[_0x5cfe2e(0x256)])):_0x5eba97['product_stock']=Math[_0x5cfe2e(0x28b)](0x0,Math[_0x5cfe2e(0x24d)](_0x5eba97[_0x5cfe2e(0x24b)])-Math[_0x5cfe2e(0x24d)](_0x589808[_0x5cfe2e(0x256)])));});}return _0x3fb015;});Promise['all'](_0x79188d)[_0x57cf5b(0x288)](async _0x3d425b=>{var _0x29f253=_0x57cf5b;try{for(const _0x323c2b of _0x3d425b){await _0x323c2b[_0x29f253(0x1de)]();}const _0x5b7ec7=_0x3c7045['product'][_0x29f253(0x20d)](async _0x19649d=>{var _0x1fbc33=_0x29f253,_0x421055=await warehouse['findOne']({'name':_0x5d4b49,'room':_0x19649d[_0x1fbc33(0x20f)]});if(_0x19649d[_0x1fbc33(0x256)]>0x0){var _0x53b445=0x0;const _0xf9cc59=_0x421055[_0x1fbc33(0x22c)][_0x1fbc33(0x20d)](_0x115b28=>{var _0x2bea0c=_0x1fbc33;_0x115b28[_0x2bea0c(0x1c9)]==_0x19649d[_0x2bea0c(0x1c9)]&&_0x115b28[_0x2bea0c(0x208)]==_0x19649d['to_bay']&&_0x115b28['expiry_date']==_0x19649d['expiry_date']&&_0x115b28[_0x2bea0c(0x1fa)]==_0x19649d[_0x2bea0c(0x1fa)]&&_0x115b28[_0x2bea0c(0x26d)]==_0x19649d[_0x2bea0c(0x26d)]&&_0x115b28['invoice']==_0x19649d[_0x2bea0c(0x23e)]&&(typeof _0x19649d[_0x2bea0c(0x1d8)]=='undefined'?(console[_0x2bea0c(0x270)](_0x2bea0c(0x1ff),_0x115b28[_0x2bea0c(0x24b)]+_0x2bea0c(0x289)+_0x115b28[_0x2bea0c(0x262)]+_0x2bea0c(0x27e)+Math[_0x2bea0c(0x24d)](_0x115b28['product_stock'])+Math[_0x2bea0c(0x24d)](_0x19649d['to_quantity'])),_0x115b28[_0x2bea0c(0x24b)]=Math['abs'](_0x115b28['product_stock'])+Math['abs'](_0x19649d['to_quantity'])):_0x115b28[_0x2bea0c(0x24b)]=Math[_0x2bea0c(0x24d)](_0x115b28[_0x2bea0c(0x24b)])+Math[_0x2bea0c(0x24d)](_0x19649d['to_quantity']),_0x53b445++);});_0x53b445=='0'&&(_0x421055[_0x1fbc33(0x22c)]=_0x421055[_0x1fbc33(0x22c)][_0x1fbc33(0x1ea)]({'product_name':_0x19649d[_0x1fbc33(0x1c9)],'product_stock':_0x19649d[_0x1fbc33(0x256)],'bay':_0x19649d[_0x1fbc33(0x1d2)],'product_code':_0x19649d[_0x1fbc33(0x25c)],'primary_code':_0x19649d[_0x1fbc33(0x26b)],'secondary_code':_0x19649d[_0x1fbc33(0x20c)],'expiry_date':_0x19649d[_0x1fbc33(0x227)],'production_date':_0x19649d['production_date'],'maxProducts':_0x19649d['maxProducts'],'batch_code':_0x19649d[_0x1fbc33(0x26d)],'secondary_unit':_0x19649d[_0x1fbc33(0x1cb)],'unit':_0x19649d[_0x1fbc33(0x236)],'maxProducts':_0x19649d[_0x1fbc33(0x1e1)],'maxPerUnit':_0x19649d[_0x1fbc33(0x231)],'invoice':_0x19649d['To_invoice']}));}return _0x421055;});Promise[_0x29f253(0x287)](_0x5b7ec7)[_0x29f253(0x288)](async _0x41a716=>{var _0x3dbd2f=_0x29f253;try{for(const _0x296c1a of _0x41a716){await warehouse[_0x3dbd2f(0x27b)]({'_id':_0x296c1a[_0x3dbd2f(0x262)]},{'$addToSet':{'product_details':{'$each':_0x296c1a[_0x3dbd2f(0x22c)]}}});}_0x3c7045[_0x3dbd2f(0x1e2)]=_0x3dbd2f(0x269);const _0x2a99d4=await _0x3c7045[_0x3dbd2f(0x1de)](),_0x11fd41=await master_shop[_0x3dbd2f(0x26c)](),_0x4347fc=await email_settings[_0x3dbd2f(0x267)](),_0x318a73=await supervisor_settings[_0x3dbd2f(0x26c)]();var _0x52d170=_0x3c7045['product'],_0x820978='',_0x533ef5;for(_0x533ef5 in _0x52d170){var _0x3e304c='FG';_0x3c7045[_0x3dbd2f(0x27d)]==_0x3dbd2f(0x28c)&&(_0x3e304c='DG'),_0x820978+=_0x3dbd2f(0x229)+_0x3dbd2f(0x1d3)+_0x52d170[_0x533ef5]['product_name']+'</td>'+_0x3dbd2f(0x1d3)+_0x52d170[_0x533ef5][_0x3dbd2f(0x25c)]+'</td>'+_0x3dbd2f(0x1d3)+_0x52d170[_0x533ef5][_0x3dbd2f(0x256)]+'</td>'+_0x3dbd2f(0x1d3)+_0x52d170[_0x533ef5][_0x3dbd2f(0x236)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x52d170[_0x533ef5][_0x3dbd2f(0x1cb)]+_0x3dbd2f(0x240)+_0x3dbd2f(0x1d3)+_0x3c7045[_0x3dbd2f(0x27d)]+'</td>'+_0x3dbd2f(0x1d3)+_0x52d170[_0x533ef5][_0x3dbd2f(0x20f)]+_0x3dbd2f(0x240)+_0x3dbd2f(0x1d3)+_0x3e304c+_0x52d170[_0x533ef5][_0x3dbd2f(0x1d2)]+_0x3dbd2f(0x240)+_0x3dbd2f(0x20b);}let _0x50551c=nodemailer[_0x3dbd2f(0x1f7)]({'host':_0x4347fc[_0x3dbd2f(0x215)],'port':Number(_0x4347fc[_0x3dbd2f(0x202)]),'secure':![],'auth':{'user':_0x4347fc[_0x3dbd2f(0x279)],'pass':_0x4347fc['password']}}),_0x50824b={'from':_0x4347fc[_0x3dbd2f(0x279)],'to':_0x318a73[0x0][_0x3dbd2f(0x26e)],'subject':_0x3dbd2f(0x201),'attachments':[{'filename':_0x3dbd2f(0x1c4),'path':__dirname+'/../public'+'/upload/'+_0x11fd41[0x0][_0x3dbd2f(0x1c0)],'cid':_0x3dbd2f(0x25e)}],'html':_0x3dbd2f(0x293)+_0x3dbd2f(0x2a1)+'</head><body>'+'<div>'+_0x3dbd2f(0x284)+_0x3dbd2f(0x26f)+_0x3dbd2f(0x299)+_0x3dbd2f(0x1c8)+_0x3dbd2f(0x26f)+'<h2>\x20'+_0x11fd41[0x0][_0x3dbd2f(0x29b)]+_0x3dbd2f(0x223)+_0x3dbd2f(0x1c8)+_0x3dbd2f(0x1c8)+'<hr\x20class=\x22my-3\x22>'+_0x3dbd2f(0x26f)+_0x3dbd2f(0x23f)+'\x20Order\x20Number\x20:\x20'+_0x3c7045[_0x3dbd2f(0x1df)]+'\x20'+_0x3dbd2f(0x25f)+_0x3dbd2f(0x1e7)+_0x3c7045[_0x3dbd2f(0x221)]+'\x20'+'</span>'+_0x3dbd2f(0x1ec)+_0x3dbd2f(0x1c8)+_0x3dbd2f(0x212)+_0x3dbd2f(0x1f2)+_0x3dbd2f(0x229)+_0x3dbd2f(0x29d)+_0x3dbd2f(0x1ca)+_0x3dbd2f(0x25a)+_0x3dbd2f(0x237)+_0x3dbd2f(0x29f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x3dbd2f(0x209)+_0x3dbd2f(0x24a)+'</tr>'+_0x3dbd2f(0x1db)+_0x3dbd2f(0x1fd)+'\x20'+_0x820978+'\x20'+_0x3dbd2f(0x1e6)+_0x3dbd2f(0x1e8)+_0x3dbd2f(0x26f)+_0x3dbd2f(0x1dd)+'<h5>'+_0x11fd41[0x0][_0x3dbd2f(0x29b)]+_0x3dbd2f(0x1ec)+_0x3dbd2f(0x1c8)+_0x3dbd2f(0x1c8)+'</body></html>'};_0x50551c[_0x3dbd2f(0x281)](_0x50824b,function(_0xca9f41,_0x5e9b06){var _0x5dc9c0=_0x3dbd2f;_0xca9f41?(console[_0x5dc9c0(0x270)](_0xca9f41),console[_0x5dc9c0(0x270)](_0x5dc9c0(0x28a))):console[_0x5dc9c0(0x270)]('Email\x20sent\x20successfully');}),_0x2a7b88[_0x3dbd2f(0x282)]('success',_0x3dbd2f(0x22b)),_0x8248aa[_0x3dbd2f(0x1d9)](_0x3dbd2f(0x214)+_0x2a99d4[_0x3dbd2f(0x262)]);}catch(_0x3d5b9e){console[_0x3dbd2f(0x1f1)](_0x3d5b9e),_0x8248aa[_0x3dbd2f(0x241)](0x1f4)['json']({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x29f253(0x224)](_0x1f2f6c=>{var _0x19cece=_0x29f253;console[_0x19cece(0x1f1)](_0x1f2f6c),_0x8248aa[_0x19cece(0x241)](0x1f4)[_0x19cece(0x23b)]({'error':_0x19cece(0x23d)});});}catch(_0x2b74df){console[_0x29f253(0x1f1)](_0x2b74df),_0x8248aa[_0x29f253(0x241)](0x1f4)['json']({'error':_0x29f253(0x248)});}})[_0x57cf5b(0x224)](_0x1786b6=>{var _0xcdc3b0=_0x57cf5b;console[_0xcdc3b0(0x1f1)](_0x1786b6),_0x8248aa[_0xcdc3b0(0x241)](0x1f4)[_0xcdc3b0(0x23b)]({'error':_0xcdc3b0(0x23d)});});}catch(_0xaf38ee){_0x8248aa[_0x57cf5b(0x23b)]({'message':_0xaf38ee[_0x57cf5b(0x291)]});}});function BayBinSelected(_0x3ab972,_0x331242){var _0x523603=a0_0x442c70,_0x463ac6=[];let _0x2477b7=[];var _0x40e733=[];if(_0x3ab972==_0x523603(0x28c)){switch(_0x331242){case _0x523603(0x225):_0x463ac6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x523603(0x278):_0x463ac6=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x40e733=['DG'];}else{if(_0x3ab972==_0x523603(0x222)){switch(_0x331242){case _0x523603(0x225):_0x463ac6=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x523603(0x278):_0x463ac6=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x40e733=['FG'];}}return{'levels':_0x463ac6,'identify':_0x40e733};}router['get']('/view/:id',auth,async(_0x309f1b,_0x494510)=>{var _0x4fa352=a0_0x442c70;try{const {username:_0x4e54b4,email:_0x53332b,role:_0x47132e}=_0x309f1b[_0x4fa352(0x29a)],_0x599e3d=_0x309f1b[_0x4fa352(0x29a)],_0x496c77=await profile[_0x4fa352(0x267)]({'email':_0x599e3d[_0x4fa352(0x279)]}),_0x5412da=await master_shop['find'](),_0x352190=await transfers_finished[_0x4fa352(0x1c5)](_0x309f1b['params']['id']);let _0x9366d0=new Date(_0x352190[_0x4fa352(0x227)]),_0x1b8286=('0'+_0x9366d0[_0x4fa352(0x265)]())[_0x4fa352(0x245)](-0x2),_0x3d1021=('0'+(_0x9366d0[_0x4fa352(0x247)]()+0x1))['slice'](-0x2),_0xceea4e=_0x9366d0[_0x4fa352(0x1fb)](),_0x3f3663=_0xceea4e+'-'+_0x3d1021+'-'+_0x1b8286,_0xd6fa1f;if(_0x599e3d[_0x4fa352(0x264)]==_0x4fa352(0x22f)){const _0x32db51=await staff[_0x4fa352(0x267)]({'email':_0x599e3d[_0x4fa352(0x279)]});_0xd6fa1f=await warehouse['find']({'status':_0x4fa352(0x204),'name':_0x32db51[_0x4fa352(0x28d)],'warehouse_category':_0x4fa352(0x271)});}else _0xd6fa1f=await warehouse[_0x4fa352(0x26c)]({'status':_0x4fa352(0x204),'warehouse_category':_0x4fa352(0x271)});const _0x2bf851=await warehouse[_0x4fa352(0x1c3)]([{'$match':{'name':_0x352190[_0x4fa352(0x1eb)],'room':_0x352190[_0x4fa352(0x1f6)]}},{'$unwind':_0x4fa352(0x1d5)},{'$group':{'_id':_0x4fa352(0x1e9),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4fa352(0x23c)},'bay':{'$first':_0x4fa352(0x206)},'bin':{'$first':_0x4fa352(0x24e)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x4fa352(0x1dc)},'primary_code':{'$first':_0x4fa352(0x1ee)},'secondary_code':{'$first':_0x4fa352(0x1fc)},'product_code':{'$first':_0x4fa352(0x234)},'storage':{'$first':_0x4fa352(0x21a)},'rack':{'$first':_0x4fa352(0x211)}}}]);var _0x550f56=[0x1,0x2,0x3,0x4],_0xa8a7bd=['A','B','C','D','E','F','G','H','I','J'],_0x399bf3=[_0x4fa352(0x28e),'Enclosed'];const _0x538f5b=await product[_0x4fa352(0x26c)]({}),_0x3b2fa9=BayBinSelected(_0x352190[_0x4fa352(0x27d)],_0x352190[_0x4fa352(0x24c)]);if(_0x5412da[0x0][_0x4fa352(0x254)]=='English\x20(US)'){var _0xabc7f2=users[_0x4fa352(0x1f5)];console['log'](_0xabc7f2);}else{if(_0x5412da[0x0]['language']=='Hindi')var _0xabc7f2=users[_0x4fa352(0x1f4)];else{if(_0x5412da[0x0][_0x4fa352(0x254)]==_0x4fa352(0x277))var _0xabc7f2=users[_0x4fa352(0x277)];else{if(_0x5412da[0x0][_0x4fa352(0x254)]==_0x4fa352(0x1d0))var _0xabc7f2=users[_0x4fa352(0x1d0)];else{if(_0x5412da[0x0][_0x4fa352(0x254)]==_0x4fa352(0x274))var _0xabc7f2=users[_0x4fa352(0x274)];else{if(_0x5412da[0x0]['language']==_0x4fa352(0x290))var _0xabc7f2=users[_0x4fa352(0x210)];else{if(_0x5412da[0x0][_0x4fa352(0x254)]==_0x4fa352(0x213))var _0xabc7f2=users['Chinese'];else{if(_0x5412da[0x0][_0x4fa352(0x254)]=='Arabic\x20(ae)')var _0xabc7f2=users[_0x4fa352(0x219)];}}}}}}}_0x494510['render']('edit_transfer_finished',{'success':_0x309f1b[_0x4fa352(0x282)](_0x4fa352(0x273)),'errors':_0x309f1b[_0x4fa352(0x282)]('errors'),'role':_0x599e3d,'profile':_0x496c77,'master_shop':_0x5412da,'warehouse':_0xd6fa1f,'transfer':_0x352190,'stock':_0x2bf851,'unit':_0x538f5b,'language':_0xabc7f2,'levels':_0x550f56,'Isle':_0xa8a7bd,'rooms_data':_0x399bf3,'ed_fullDate':_0x3f3663,'dataSelected':_0x3b2fa9});}catch(_0x5e4dcc){console[_0x4fa352(0x270)](_0x5e4dcc);}}),router[a0_0x442c70(0x1f0)](a0_0x442c70(0x283),auth,async(_0xdcc7b2,_0x55909b)=>{var _0x41d125=a0_0x442c70;try{const _0xe49a8d=_0xdcc7b2[_0x41d125(0x216)]['id'];console[_0x41d125(0x270)](_0xdcc7b2[_0x41d125(0x1f9)]);const _0x4544ba=await transfers_finished[_0x41d125(0x1c5)](_0xe49a8d);console[_0x41d125(0x270)]('transfer_data',_0x4544ba);const {date:_0x1e0773,from_warehouse:_0x28a7b4,FromRoom_name:_0x16e192,to_warehouse:_0x4a7f97,ToRoom_name:_0x34bceb,prod_name:_0x2a88cb,from_prod_qty:_0x2528c0,from_prod_level:_0x19274d,from_prod_isle:_0x5ae096,from_prod_pallet:_0x39e723,to_prod_qty:_0xfefe82,to_prod_level:_0x18d197,to_prod_isle:_0x2cef46,to_prod_pallet:_0x2a830e,primary_code:_0x6a6cd7,secondary_code:_0xc7786a,product_code3:_0x18cbc2,note:_0x13079a,invoice:_0x2c9455,expiry_date:_0x3ec5b6}=_0xdcc7b2['body'];if(typeof _0x2a88cb==_0x41d125(0x258))var _0x3ad046=[_0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x249)]],_0x143809=[_0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x205)]],_0x4a4eae=[_0xdcc7b2['body'][_0x41d125(0x218)]],_0x1c1eab=[_0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x26a)]],_0x2902db=[_0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x217)]],_0x10906a=[_0xdcc7b2['body'][_0x41d125(0x26b)]],_0x3121c0=[_0xdcc7b2['body'][_0x41d125(0x20c)]],_0x3ac33a=[_0xdcc7b2[_0x41d125(0x1f9)]['product_code3']],_0x4ac75b=[_0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x257)]],_0x575695=[_0xdcc7b2['body']['unit']],_0x7d31e3=[_0xdcc7b2['body'][_0x41d125(0x1cb)]],_0x491fb0=[_0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x26d)]],_0xc35b1=[_0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x227)]];else var _0x3ad046=[..._0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x249)]],_0x143809=[..._0xdcc7b2[_0x41d125(0x1f9)]['from_prod_qty']],_0x4a4eae=[..._0xdcc7b2['body'][_0x41d125(0x218)]],_0x1c1eab=[..._0xdcc7b2[_0x41d125(0x1f9)]['to_prod_qty']],_0x2902db=[..._0xdcc7b2['body'][_0x41d125(0x217)]],_0x10906a=[..._0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x26b)]],_0x3121c0=[..._0xdcc7b2['body'][_0x41d125(0x20c)]],_0x3ac33a=[..._0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x260)]],_0x4ac75b=[..._0xdcc7b2['body'][_0x41d125(0x257)]],_0x575695=[..._0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x236)]],_0x7d31e3=[..._0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x1cb)]],_0x491fb0=[..._0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x26d)]],_0xc35b1=[..._0xdcc7b2[_0x41d125(0x1f9)][_0x41d125(0x227)]];const _0x3b9850=_0x3ad046['map'](_0xb0902=>{return _0xb0902={'product_name':_0xb0902};});_0x143809[_0x41d125(0x20a)]((_0x15b6da,_0x40db16)=>{var _0x1f83cf=_0x41d125;_0x3b9850[_0x40db16][_0x1f83cf(0x261)]=_0x15b6da;}),_0x4a4eae[_0x41d125(0x20a)]((_0x33f787,_0x30be8e)=>{var _0x3ce174=_0x41d125;_0x3b9850[_0x30be8e][_0x3ce174(0x235)]=_0x33f787;}),_0x1c1eab[_0x41d125(0x20a)]((_0x5b1ca0,_0x400128)=>{var _0x186e2a=_0x41d125;_0x3b9850[_0x400128][_0x186e2a(0x256)]=_0x5b1ca0;}),_0x2902db[_0x41d125(0x20a)]((_0x5ca6a2,_0x5ca2d4)=>{_0x3b9850[_0x5ca2d4]['to_bay']=_0x5ca6a2;}),_0x10906a[_0x41d125(0x20a)]((_0x5cdde6,_0x574f26)=>{var _0xdd6c67=_0x41d125;_0x3b9850[_0x574f26][_0xdd6c67(0x26b)]=_0x5cdde6;}),_0x3121c0['forEach']((_0x28691d,_0x14fdec)=>{_0x3b9850[_0x14fdec]['secondary_code']=_0x28691d;}),_0x3ac33a[_0x41d125(0x20a)]((_0x19e594,_0x41ac02)=>{var _0x440465=_0x41d125;_0x3b9850[_0x41ac02][_0x440465(0x25c)]=_0x19e594;}),_0x4ac75b['forEach']((_0x11d816,_0x320168)=>{var _0x2b60e8=_0x41d125;_0x3b9850[_0x320168][_0x2b60e8(0x1e1)]=_0x11d816;}),_0x575695['forEach']((_0x29ea68,_0x3d2e9f)=>{_0x3b9850[_0x3d2e9f]['unit']=_0x29ea68;}),_0x7d31e3['forEach']((_0x280632,_0x3ca322)=>{var _0x1960c5=_0x41d125;_0x3b9850[_0x3ca322][_0x1960c5(0x1cb)]=_0x280632;}),_0x491fb0['forEach']((_0x19fd04,_0x581888)=>{var _0x2b58b0=_0x41d125;_0x3b9850[_0x581888][_0x2b58b0(0x26d)]=_0x19fd04;}),_0xc35b1[_0x41d125(0x20a)]((_0x2c9cba,_0x303df7)=>{var _0x3f0c57=_0x41d125;_0x3b9850[_0x303df7][_0x3f0c57(0x227)]=_0x2c9cba;});const _0x902a6f=_0x3b9850[_0x41d125(0x220)](_0x2b7c15=>_0x2b7c15[_0x41d125(0x256)]!=='0'&&_0x2b7c15[_0x41d125(0x256)]!==''||_0x2b7c15[_0x41d125(0x266)]!=='0'&&_0x2b7c15[_0x41d125(0x266)]!=='');var _0x1e6ece=0x0;_0x902a6f['forEach'](_0x21a959=>{var _0x380b60=_0x41d125;parseInt(_0x21a959['from_quantity'])<parseInt(_0x21a959[_0x380b60(0x256)])&&_0x1e6ece++;});if(_0x1e6ece!=0x0)return _0xdcc7b2['flash']('errors',_0x41d125(0x200)),_0x55909b[_0x41d125(0x1d9)](_0x41d125(0x22d));const _0x195b36=await warehouse[_0x41d125(0x267)]({'name':_0x4544ba['from_warehouse'],'room':_0x4544ba[_0x41d125(0x1f6)]});_0x4544ba['product']['forEach'](_0x3f1eb7=>{var _0x3687e9=_0x41d125;if(_0x3f1eb7[_0x3687e9(0x256)]>0x0){const _0x18abfe=_0x195b36[_0x3687e9(0x22c)][_0x3687e9(0x20d)](_0x3b8994=>{var _0x2550ec=_0x3687e9;_0x3b8994[_0x2550ec(0x1c9)]==_0x3f1eb7[_0x2550ec(0x1c9)]&&_0x3b8994[_0x2550ec(0x208)]==_0x3f1eb7[_0x2550ec(0x235)]&&(_0x3b8994[_0x2550ec(0x24b)]=parseInt(_0x3b8994[_0x2550ec(0x24b)])+parseInt(_0x3f1eb7[_0x2550ec(0x256)]));});}}),await _0x195b36[_0x41d125(0x1de)]();const _0x3de47d=await warehouse[_0x41d125(0x267)]({'name':_0x4544ba[_0x41d125(0x27d)],'room':_0x4544ba[_0x41d125(0x24c)]});_0x4544ba[_0x41d125(0x21e)]['forEach'](_0x57c9b1=>{var _0x5040cf=_0x41d125;if(_0x57c9b1[_0x5040cf(0x256)]>0x0){const _0x490bac=_0x3de47d[_0x5040cf(0x22c)][_0x5040cf(0x20d)](_0x520963=>{var _0x455abd=_0x5040cf;_0x520963[_0x455abd(0x1c9)]==_0x57c9b1[_0x455abd(0x1c9)]&&_0x520963[_0x455abd(0x208)]==_0x57c9b1[_0x455abd(0x1d2)]&&(_0x520963[_0x455abd(0x24b)]=parseInt(_0x520963[_0x455abd(0x24b)])-parseInt(_0x57c9b1[_0x455abd(0x256)]));});}}),await _0x3de47d[_0x41d125(0x1de)](),_0x4544ba[_0x41d125(0x221)]=_0x1e0773,_0x4544ba['from_warehouse']=_0x28a7b4,_0x4544ba[_0x41d125(0x27d)]=_0x4a7f97,_0x4544ba[_0x41d125(0x21e)]=_0x902a6f,_0x4544ba[_0x41d125(0x292)]=_0x13079a,_0x4544ba[_0x41d125(0x1df)]=_0x2c9455;const _0x387deb=await _0x4544ba['save'](),_0x33debd=await warehouse[_0x41d125(0x267)]({'name':_0x28a7b4,'room':_0x16e192});_0x387deb[_0x41d125(0x21e)][_0x41d125(0x20a)](_0x12c3c9=>{var _0xfaa9c1=_0x41d125;if(_0x12c3c9[_0xfaa9c1(0x256)]>0x0){const _0x5eeac1=_0x33debd['product_details']['map'](_0x25ecfa=>{var _0x34ad2a=_0xfaa9c1;_0x25ecfa[_0x34ad2a(0x1c9)]==_0x12c3c9[_0x34ad2a(0x1c9)]&&_0x25ecfa[_0x34ad2a(0x208)]==_0x12c3c9[_0x34ad2a(0x235)]&&(_0x25ecfa['product_stock']=parseInt(_0x25ecfa[_0x34ad2a(0x24b)])-parseInt(_0x12c3c9[_0x34ad2a(0x256)]));});}}),await _0x33debd[_0x41d125(0x1de)]();const _0x556b41=await warehouse[_0x41d125(0x267)]({'name':_0x4a7f97,'room':_0x34bceb});_0x387deb[_0x41d125(0x21e)][_0x41d125(0x20a)](_0x1ac257=>{var _0x5787c9=_0x41d125;if(_0x1ac257[_0x5787c9(0x256)]>0x0){var _0x579447=0x0;const _0x1f802a=_0x556b41['product_details']['map'](_0x209b6d=>{var _0x532d18=_0x5787c9;_0x209b6d[_0x532d18(0x1c9)]==_0x1ac257[_0x532d18(0x1c9)]&&_0x209b6d[_0x532d18(0x208)]==_0x1ac257[_0x532d18(0x1d2)]&&(_0x209b6d[_0x532d18(0x24b)]=parseInt(_0x209b6d[_0x532d18(0x24b)])+parseInt(_0x1ac257[_0x532d18(0x256)]),_0x579447++);});_0x579447=='0'&&(_0x556b41['product_details']=_0x556b41['product_details'][_0x5787c9(0x1ea)]({'product_name':_0x1ac257[_0x5787c9(0x1c9)],'product_stock':_0x1ac257[_0x5787c9(0x256)],'bay':_0x1ac257['to_bay'],'product_code':_0x1ac257['product_code'],'primary_code':_0x1ac257[_0x5787c9(0x26b)],'secondary_code':_0x1ac257[_0x5787c9(0x20c)],'maxProducts':_0x1ac257[_0x5787c9(0x1e1)]}));}}),await _0x556b41[_0x41d125(0x1de)](),_0xdcc7b2[_0x41d125(0x282)]('success',_0x41d125(0x1fe)),_0x55909b[_0x41d125(0x1d9)](_0x41d125(0x276));}catch(_0x528b93){console['log'](_0x528b93);}}),router[a0_0x442c70(0x1f0)](a0_0x442c70(0x27c),async(_0x47600e,_0x3b61a7)=>{var _0x215bb3=a0_0x442c70;const {FromWareHouse:_0x403c28,FromRoom:_0x1b3ed6,ToWarehouse:_0x1cccbe,ToRoom:_0x312d13,primary_code:_0x42fbb7,Roomslist:_0x1de71d}=_0x47600e[_0x215bb3(0x1f9)],_0x4b78ef=_0x1de71d[_0x215bb3(0x1e0)](','),_0x20db80=[];async function _0x317bbc(_0x2e2726){var _0x445203=_0x215bb3;const _0x4e90c4=await warehouse[_0x445203(0x1c3)]([{'$match':{'name':_0x403c28,'room':_0x2e2726}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x42fbb7}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x445203(0x1cd)},'instock':{'$first':_0x445203(0x23c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x445203(0x234)},'level':{'$first':_0x445203(0x206)},'isle':{'$first':_0x445203(0x24e)},'type':{'$first':_0x445203(0x1da)},'pallet':{'$first':_0x445203(0x1dc)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x445203(0x294)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x445203(0x211)},'expiry_date':{'$first':_0x445203(0x21f)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x445203(0x242)},'maxPerUnit':{'$first':_0x445203(0x28f)},'roomNamed':{'$first':_0x445203(0x275)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x445203(0x263)}}}]),_0x39eed8=await warehouse['aggregate']([{'$match':{'name':_0x403c28,'room':_0x2e2726}},{'$unwind':_0x445203(0x1d5)},{'$match':{'product_details.secondary_code':_0x42fbb7}},{'$group':{'_id':_0x445203(0x1e9),'name':{'$first':_0x445203(0x1cd)},'instock':{'$first':_0x445203(0x23c)},'primary_code':{'$first':_0x445203(0x1ee)},'secondary_code':{'$first':_0x445203(0x1fc)},'product_code':{'$first':_0x445203(0x234)},'level':{'$first':_0x445203(0x206)},'isle':{'$first':_0x445203(0x24e)},'type':{'$first':_0x445203(0x1da)},'pallet':{'$first':_0x445203(0x1dc)},'unit':{'$first':_0x445203(0x1e3)},'secondary_unit':{'$first':_0x445203(0x294)},'storage':{'$first':_0x445203(0x21a)},'rack':{'$first':_0x445203(0x211)},'expiry_date':{'$first':_0x445203(0x21f)},'production_date':{'$first':_0x445203(0x226)},'batch_code':{'$first':_0x445203(0x242)},'maxPerUnit':{'$first':_0x445203(0x28f)},'roomNamed':{'$first':_0x445203(0x275)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x445203(0x263)}}}]);if(_0x4e90c4[_0x445203(0x232)]>0x0)_0x20db80[_0x445203(0x295)](_0x4e90c4);else _0x39eed8[_0x445203(0x232)]>0x0&&_0x20db80['push'](_0x39eed8);}const _0x228780=_0x4b78ef[_0x215bb3(0x20d)](_0x3f649c=>_0x317bbc(_0x3f649c));await Promise[_0x215bb3(0x287)](_0x228780),_0x3b61a7[_0x215bb3(0x23b)](_0x20db80);}),router[a0_0x442c70(0x1f0)](a0_0x442c70(0x252),async(_0x2c7c1b,_0x1ee9d3)=>{var _0x34dae8=a0_0x442c70;try{const {FromWareHouse:_0x3a3921,FromRoom:_0x198b74,ToWarehouse:_0xeda87b,ToRoom:_0xecb398,secondary_code:_0x42085d}=_0x2c7c1b[_0x34dae8(0x1f9)],_0x14abb2=await warehouse[_0x34dae8(0x1c3)]([{'$match':{'name':_0x3a3921}},{'$unwind':_0x34dae8(0x1d5)},{'$match':{'product_details.secondary_code':_0x42085d}},{'$group':{'_id':_0x34dae8(0x1e9),'name':{'$first':_0x34dae8(0x1cd)},'primary_code':{'$first':_0x34dae8(0x1ee)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x34dae8(0x23c)},'warehouse':{'$first':_0x34dae8(0x29e)},'level':{'$first':_0x34dae8(0x22e)},'isle':{'$first':_0x34dae8(0x243)},'pallet':{'$first':_0x34dae8(0x21d)},'maxProducts':{'$first':_0x34dae8(0x259)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'}}}]);_0x1ee9d3[_0x34dae8(0x241)](0xc8)[_0x34dae8(0x23b)](_0x14abb2);}catch(_0x2ae018){_0x1ee9d3[_0x34dae8(0x241)](0x194)[_0x34dae8(0x23b)]({'message':_0x2ae018[_0x34dae8(0x291)]});}}),router[a0_0x442c70(0x1f0)](a0_0x442c70(0x1d4),async(_0x533673,_0x382d84)=>{var _0x2b2197=a0_0x442c70;try{const {FromWareHouse:_0x3f1248,FromRoom:_0x3a2883,ToWarehouse:_0x19aab7,ToRoom:_0x45996a,product_code:_0x4875ea}=_0x533673[_0x2b2197(0x1f9)],_0x176059=await warehouse['aggregate']([{'$match':{'name':_0x3f1248}},{'$unwind':_0x2b2197(0x1d5)},{'$match':{'product_details.product_code':_0x4875ea}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x2b2197(0x1ee)},'secondary_code':{'$first':_0x2b2197(0x1fc)},'product_code':{'$first':_0x2b2197(0x234)},'instock':{'$first':_0x2b2197(0x23c)},'warehouse':{'$first':_0x2b2197(0x29e)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x2b2197(0x243)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x2b2197(0x259)},'unit':{'$first':_0x2b2197(0x1e3)}}}]);_0x382d84['status'](0xc8)[_0x2b2197(0x23b)](_0x176059);}catch(_0x3a2152){_0x382d84[_0x2b2197(0x241)](0x194)[_0x2b2197(0x23b)]({'message':_0x3a2152[_0x2b2197(0x291)]});}}),router[a0_0x442c70(0x1f0)](a0_0x442c70(0x268),async(_0x7d4d88,_0x45fe7b)=>{var _0x21d589=a0_0x442c70;const {productCode:_0x120b2d,bay:_0x477813,warehouses:_0x525474,room:_0x4d06d4}=_0x7d4d88[_0x21d589(0x1f9)];console['log'](_0x7d4d88[_0x21d589(0x1f9)]);try{const _0x302dfe=await warehouse[_0x21d589(0x1c3)]([{'$match':{'name':_0x525474,'room':_0x4d06d4}},{'$unwind':_0x21d589(0x1d5)},{'$match':{'product_details.bay':parseInt(_0x477813)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x21d589(0x1cd)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x21d589(0x206)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x45fe7b['status'](0xc8)['json'](_0x302dfe);}catch(_0x50729d){_0x45fe7b[_0x21d589(0x241)](0x194)[_0x21d589(0x23b)]({'message':_0x50729d[_0x21d589(0x291)]});}}),module['exports']=router;function a0_0x4f55(){var _0x28e6e4=['$product_details.bay','Product\x20Transfer\x20successfully','bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','forEach','</tr>','secondary_code','map','Arabic\x20(ae)','to_room_name','Portuguese','$product_details.rack','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Chinese','/picking_list/PDF_transfer/','host','params','to_prod_level','from_prod_level','Arabic','$product_details.storage','/preview/:id','7018848CiJGJo','$product_details.pallet','product','$product_details.expiry_date','filter','date','FROZEN\x20GOODS','\x20</h2>','catch','Rack\x201','$product_details.production_date','expiry_date','11188INExwk','<tr>','$product','Transfer\x20Finalize\x20Successfully','product_details','back','$product_details.level','staff','../middleware/auth','maxPerUnit','length','nodemailer','$product_details.product_code','from_bay','unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','primary_unit','$date','$invoice','json','$product_details.product_stock','An\x20error\x20occurred.','To_invoice','<h5\x20style=\x22text-align:\x20left;\x22>','</td>','status','$product_details.batch_code','$product_details.isle','2916009JjvAzR','slice','to_invoice','getMonth','An\x20error\x20occurred\x20while\x20saving\x20data.','prod_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','product_stock','to_room','abs','$product_details.bin','render','ToRoomAssigned','8916svUblk','/barcode_scanner2','English\x20(US)','language','/transfer/view','to_quantity','MaxStocks_data2','string','$product_details.maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','/view/add_transfer','product_code','padStart','logo','<span\x20style=\x22float:\x20right;\x22>','product_code3','from_quantity','_id','$product_details.invoice','role','getDate','to_floorlevel','findOne','/CheckingWarehouse','True','to_prod_qty','primary_code','find','batch_code','FGSEmail','<div>','log','Finished\x20Goods','from_invoice','success','French','$room','/transfer_finished/view','German','Rack\x202','email','toString','updateOne','/barcode_scanner','to_warehouse','\x20<=>\x20','TRFF-','RoomAssigned','sendMail','flash','/view/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','73465psbdoq','3atlxMl','all','then','\x20<>\x20','Error\x20Occurs','max','DRY\x20GOODS','warehouse','Ambient','$product_details.maxPerUnit','Portuguese\x20(BR)','message','note','<!DOCTYPE\x20html>','$product_details.secondary_unit','push','$_id','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$finalize','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','user','site_title','random','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','get','<html><head><title></title>','image','New_Qty_Converted','/view','aggregate','Logo.png','findById','$from_warehouse','errors','</div>','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','secondary_unit','MaxStocks_data','$product_details.product_name','868261QvWkGd','prod_cat','Spanish','Router','to_bay','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/barcode_scanner3','$product_details','product_date','615gFoRRb','id_transaction','redirect','$product_details.type','</thead>','$product_details.floorlevel','<strong>\x20Regards\x20</strong>','save','invoice','split','maxProducts','finalize','$product_details.unit','../public/language/languages.json','here1','</tbody>','\x20Order\x20Date\x20:\x20','</table>','$product_details._id','concat','from_warehouse','</h5>','2026108VkWqKx','$product_details.primary_code','from_room_name','post','error','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','../models/all_models','Hindi','English','from_room','createTransport','QA\x20Warehouse','body','production_date','getFullYear','$product_details.secondary_code','<tbody\x20style=\x22text-align:\x20center;\x22>','Transfer\x20Edit\x20Successfully','here2','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Transfer\x20Mail','port','transfer_finished','Enabled','from_prod_qty'];a0_0x4f55=function(){return _0x28e6e4;};return a0_0x4f55();}