var a0_0x16f786=a0_0x198d;function a0_0x4df8(){var _0x436261=['getMonth','/barcode_scanner2','$product_details.primary_code','staff','English\x20(US)','from_prod_level','back','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<h5\x20style=\x22text-align:\x20left;\x22>','json','Hindi','$product_details.product_stock','random','</head><body>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','to_room','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','redirect','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Finished\x20Goods','10738377urwwTb','New_Qty_Converted','12454070NxMkzI','Portuguese','/barcode_scanner','Portuguese\x20(BR)','$product_details.isle','getFullYear','<!DOCTYPE\x20html>','then','$product_details.unit','to_room_name','FROZEN\x20GOODS','$product_details.storage','primary_code','_id','product_details','error','sendMail','To_invoice','to_bay','There\x27s\x20a\x20error\x20in\x20this\x20transaction','/../public','MaxStocks_data','host','Chinese','forEach','product_date','expiry_date','slice','production_date','primary_unit','toString','product_code','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','2284165UMYaBk','Logo.png','render','<h2>\x20','$product_details.production_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','flash','invoice','$from_warehouse','from_room_name','$_id','</h5>','to_warehouse','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','\x20</h2>','email','to_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','/transfer_finished/view','get','</td>','$product_details.type','errors','MaxStocks_data2','<html><head><title></title>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','all','$product_details.expiry_date','string','20LBGEeg','length','site_title','$product_details.product_name','post','<div>','$product_details.bin','$product_details.pallet','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','findById','prod_name','maxPerUnit','Transfer\x20Edit\x20Successfully','exports','finalize','bay','DRY\x20GOODS','12DHdTdv','to_floorlevel','<tr>','</thead>','concat','note','5693dKItbT','to_invoice','TRFF-','/picking_list/PDF_transfer/','map','save','logo','role','Transfer\x20Finalize\x20Successfully','../public/language/languages.json','password','product','padStart','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','image','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','date','params','../models/all_models','from_warehouse','unit','secondary_unit','</tbody>','$product_details._id','<span\x20style=\x22float:\x20right;\x22>','$product_details.secondary_unit','/preview/:id','QA\x20Warehouse','$product_details.product_code','Spanish','body','8617238csMoQb','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$name','Rack\x201','$product_details.bay','$room','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','ToRoomAssigned','aggregate','$product_details.maxProducts','RoomAssigned','/transfer_finished/preview/','message','log','success','from_room','to_prod_level','Arabic','/view/:id','$product.to_room_name','German','findOne','user','Transfer\x20Mail','from_prod_qty','Enabled','Arabic\x20(ae)','/view/add_transfer','../middleware/auth','Ambient','$product_details.level','$product.from_room_name','createTransport','filter','from_invoice','$product_details.secondary_code','$product_details.invoice','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.rack','</div>','warehouse','Enclosed','nodemailer','<hr\x20class=\x22my-3\x22>','$product_details','<h5>','$to_warehouse','product_code3','from_bay','446ovAEja','maxProducts','prod_cat','French','status','English','</span>','</tr>','Router','batch_code','/upload/','Rack\x202','$finalize','An\x20error\x20occurred.','7744064FYQjxs','$date','726159WJBcfa','$product_details.batch_code','from_quantity','add_transfer_finished','<strong>\x20Regards\x20</strong>','product_name','getDate','secondary_code','language','catch'];a0_0x4df8=function(){return _0x436261;};return a0_0x4df8();}(function(_0x507cad,_0xe085a2){var _0x13bfd3=a0_0x198d,_0x488197=_0x507cad();while(!![]){try{var _0x3936fa=parseInt(_0x13bfd3(0x1ac))/0x1*(parseInt(_0x13bfd3(0x1fd))/0x2)+-parseInt(_0x13bfd3(0x20d))/0x3*(-parseInt(_0x13bfd3(0x26c))/0x4)+parseInt(_0x13bfd3(0x24e))/0x5*(parseInt(_0x13bfd3(0x1a6))/0x6)+-parseInt(_0x13bfd3(0x1cc))/0x7+parseInt(_0x13bfd3(0x20b))/0x8+-parseInt(_0x13bfd3(0x22b))/0x9+-parseInt(_0x13bfd3(0x22d))/0xa;if(_0x3936fa===_0xe085a2)break;else _0x488197['push'](_0x488197['shift']());}catch(_0x328a9b){_0x488197['push'](_0x488197['shift']());}}}(a0_0x4df8,0xa8eac));const express=require('express'),app=express(),router=express[a0_0x16f786(0x205)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x16f786(0x1bf)),auth=require(a0_0x16f786(0x1e8)),users=require(a0_0x16f786(0x1b5)),nodemailer=require(a0_0x16f786(0x1f6));router[a0_0x16f786(0x262)]('/view',auth,async(_0x438145,_0x57b958)=>{var _0x189c7e=a0_0x16f786;try{const {username:_0x1dbc42,email:_0x3bb549,role:_0x1a44df}=_0x438145['user'],_0x40897b=_0x438145[_0x189c7e(0x1e2)],_0x478157=await profile[_0x189c7e(0x1e1)]({'email':_0x40897b[_0x189c7e(0x25e)]}),_0x28c8d7=await master_shop[_0x189c7e(0x25b)]();let _0x412d00;if(_0x40897b[_0x189c7e(0x1b3)]==_0x189c7e(0x21a)){const _0x1538b5=await staff[_0x189c7e(0x1e1)]({'email':_0x40897b['email']});_0x412d00=await transfers_finished['find']({'from_warehouse':_0x1538b5[_0x189c7e(0x1f4)]});}else _0x412d00=await transfers_finished[_0x189c7e(0x1d4)]([{'$unwind':'$product'},{'$group':{'_id':_0x189c7e(0x258),'invoice':{'$first':'$invoice'},'date':{'$first':_0x189c7e(0x20c)},'from_warehouse':{'$first':_0x189c7e(0x256)},'to_warehouse':{'$first':_0x189c7e(0x1fa)},'from_room_name':{'$addToSet':_0x189c7e(0x1eb)},'to_room_name':{'$addToSet':_0x189c7e(0x1df)},'finalize':{'$first':_0x189c7e(0x209)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x28c8d7[0x0][_0x189c7e(0x215)]=='English\x20(US)')var _0x3ab71a=users[_0x189c7e(0x202)];else{if(_0x28c8d7[0x0][_0x189c7e(0x215)]==_0x189c7e(0x221))var _0x3ab71a=users['Hindi'];else{if(_0x28c8d7[0x0][_0x189c7e(0x215)]=='German')var _0x3ab71a=users[_0x189c7e(0x1e0)];else{if(_0x28c8d7[0x0][_0x189c7e(0x215)]=='Spanish')var _0x3ab71a=users[_0x189c7e(0x1ca)];else{if(_0x28c8d7[0x0][_0x189c7e(0x215)]==_0x189c7e(0x200))var _0x3ab71a=users[_0x189c7e(0x200)];else{if(_0x28c8d7[0x0][_0x189c7e(0x215)]==_0x189c7e(0x230))var _0x3ab71a=users[_0x189c7e(0x22e)];else{if(_0x28c8d7[0x0]['language']==_0x189c7e(0x244))var _0x3ab71a=users[_0x189c7e(0x244)];else{if(_0x28c8d7[0x0]['language']==_0x189c7e(0x1e6))var _0x3ab71a=users[_0x189c7e(0x1dd)];}}}}}}}_0x57b958[_0x189c7e(0x250)]('transfer_finished',{'success':_0x438145[_0x189c7e(0x254)](_0x189c7e(0x1da)),'errors':_0x438145[_0x189c7e(0x254)](_0x189c7e(0x265)),'role':_0x40897b,'profile':_0x478157,'master_shop':_0x28c8d7,'transfer':_0x412d00,'language':_0x3ab71a});}catch(_0x513c6e){console['log'](_0x513c6e);}});async function getRandom8DigitNumber(){var _0x57ab0c=a0_0x16f786;const _0x1c1e07=0x989680,_0x22850c=0x5f5e0ff,_0x34deb5=Math['floor'](Math[_0x57ab0c(0x223)]()*(_0x22850c-_0x1c1e07+0x1))+_0x1c1e07;var _0x205d9d;const _0x66cedf=await transfers_finished['findOne']({'invoice':_0x57ab0c(0x1ae)+_0x34deb5});return _0x66cedf&&_0x66cedf[_0x57ab0c(0x26d)]>0x0?_0x205d9d=_0x57ab0c(0x1ae)+_0x34deb5:_0x205d9d=_0x57ab0c(0x1ae)+_0x34deb5,_0x205d9d;}function a0_0x198d(_0x3dc900,_0x5cd31a){var _0x4df827=a0_0x4df8();return a0_0x198d=function(_0x198db1,_0x2ab204){_0x198db1=_0x198db1-0x19e;var _0x34967b=_0x4df827[_0x198db1];return _0x34967b;},a0_0x198d(_0x3dc900,_0x5cd31a);}router[a0_0x16f786(0x262)](a0_0x16f786(0x1e7),auth,async(_0x5ccaa2,_0xa89bde)=>{var _0x12e982=a0_0x16f786;try{const {username:_0x452957,email:_0x455528,role:_0x5b68f9}=_0x5ccaa2['user'],_0x164340=_0x5ccaa2['user'],_0x395061=await profile[_0x12e982(0x1e1)]({'email':_0x164340[_0x12e982(0x25e)]}),_0x357a8f=await master_shop[_0x12e982(0x25b)]();let _0x49895f;if(_0x164340[_0x12e982(0x1b3)]=='staff'){const _0x29ffb5=await staff[_0x12e982(0x1e1)]({'email':_0x164340[_0x12e982(0x25e)]});_0x49895f=await warehouse[_0x12e982(0x1d4)]([{'$match':{'status':_0x12e982(0x1e5),'name':_0x29ffb5[_0x12e982(0x1f4)],'warehouse_category':_0x12e982(0x22a),'name':{'$ne':_0x12e982(0x1c8)}}},{'$group':{'_id':_0x12e982(0x1ce),'name':{'$first':_0x12e982(0x1ce)}}}]);}else _0x49895f=await warehouse[_0x12e982(0x1d4)]([{'$match':{'status':'Enabled','warehouse_category':_0x12e982(0x22a),'name':{'$ne':_0x12e982(0x1c8)}}},{'$group':{'_id':_0x12e982(0x1ce),'name':{'$first':_0x12e982(0x1ce)}}}]);const _0xa05da8=await transfers_finished[_0x12e982(0x25b)]({}),_0x402250=_0xa05da8[_0x12e982(0x26d)]+0x1,_0x4ae5d3=_0x12e982(0x1ae)+_0x402250[_0x12e982(0x24b)]()[_0x12e982(0x1b8)](0x5,'0');if(_0x357a8f[0x0][_0x12e982(0x215)]==_0x12e982(0x21b))var _0x2fda95=users['English'];else{if(_0x357a8f[0x0][_0x12e982(0x215)]==_0x12e982(0x221))var _0x2fda95=users[_0x12e982(0x221)];else{if(_0x357a8f[0x0][_0x12e982(0x215)]=='German')var _0x2fda95=users[_0x12e982(0x1e0)];else{if(_0x357a8f[0x0][_0x12e982(0x215)]==_0x12e982(0x1ca))var _0x2fda95=users[_0x12e982(0x1ca)];else{if(_0x357a8f[0x0][_0x12e982(0x215)]=='French')var _0x2fda95=users[_0x12e982(0x200)];else{if(_0x357a8f[0x0]['language']==_0x12e982(0x230))var _0x2fda95=users[_0x12e982(0x22e)];else{if(_0x357a8f[0x0][_0x12e982(0x215)]==_0x12e982(0x244))var _0x2fda95=users['Chinese'];else{if(_0x357a8f[0x0][_0x12e982(0x215)]==_0x12e982(0x1e6))var _0x2fda95=users[_0x12e982(0x1dd)];}}}}}}}const _0xa1386d=getRandom8DigitNumber();_0xa1386d[_0x12e982(0x234)](_0x5183c0=>{var _0x18bd47=_0x12e982;_0xa89bde[_0x18bd47(0x250)](_0x18bd47(0x210),{'success':_0x5ccaa2[_0x18bd47(0x254)]('success'),'errors':_0x5ccaa2[_0x18bd47(0x254)](_0x18bd47(0x265)),'role':_0x164340,'profile':_0x395061,'master_shop':_0x357a8f,'warehouse':_0x49895f,'language':_0x2fda95,'invoice':_0x5183c0});})[_0x12e982(0x216)](_0x272db2=>{var _0x56702a=_0x12e982;_0x5ccaa2[_0x56702a(0x254)](_0x56702a(0x265),_0x56702a(0x240)),_0xa89bde[_0x56702a(0x228)]('/transfer/view');});}catch(_0x3ab148){console[_0x12e982(0x1d9)](_0x3ab148);}}),router[a0_0x16f786(0x270)]('/view/add_transfer',auth,async(_0x4146f3,_0x2fe47c)=>{var _0x561026=a0_0x16f786;try{const {date:_0x11159d,from_warehouse:_0x54bd72,FromRoom_name:_0x44044c,to_warehouse:_0x233a96,ToRoom_name:_0x227634,prod_name:_0x18791e,from_prod_qty:_0x1b1e70,from_prod_level:_0x74ea41,from_prod_isle:_0x3d671e,from_prod_pallet:_0x4396ab,to_prod_qty:_0x286f19,to_prod_level:_0x5deae2,to_prod_isle:_0x5d3a5a,to_prod_pallet:_0x37a823,primary_code:_0x4a13cf,secondary_code:_0x571a6c,product_code3:_0x15cbbf,note:_0x5d3a36,MaxStocks_data2:_0x3984b1,invoice:_0x822d9a,expiry_date:_0x10ad9f}=_0x4146f3['body'];if(typeof _0x18791e=='string')var _0x546a15=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x19f)]],_0x387958=[_0x4146f3[_0x561026(0x1cb)]['from_prod_qty']],_0x2cc343=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x21c)]],_0x4cc2ad=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x22c)]],_0x4541e7=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x1dc)]],_0x4cea3c=[_0x4146f3[_0x561026(0x1cb)]['primary_code']],_0x592e42=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x214)]],_0x3477ad=[_0x4146f3['body'][_0x561026(0x1fb)]],_0x2b9fa8=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x266)]],_0x2835f3=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x24a)]],_0x1a3da0=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x1c2)]],_0x1f4871=[_0x4146f3[_0x561026(0x1cb)]['batch_code']],_0x3f5970=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x247)]],_0x228969=[_0x4146f3['body'][_0x561026(0x246)]],_0x441e4b=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x242)]],_0x16519e=[_0x4146f3['body']['maxPerUnit']],_0x4ffd2a=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x1ff)]],_0x2ecc5d=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x1d6)]],_0x5f2300=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x1d3)]],_0x333e33=[_0x4146f3['body'][_0x561026(0x1ee)]],_0x36475f=[_0x4146f3[_0x561026(0x1cb)][_0x561026(0x1ad)]];else var _0x546a15=[..._0x4146f3['body'][_0x561026(0x19f)]],_0x387958=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1e4)]],_0x2cc343=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x21c)]],_0x4cc2ad=[..._0x4146f3['body']['New_Qty_Converted']],_0x4541e7=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1dc)]],_0x4cea3c=[..._0x4146f3['body'][_0x561026(0x239)]],_0x592e42=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x214)]],_0x3477ad=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1fb)]],_0x2b9fa8=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x266)]],_0x2835f3=[..._0x4146f3['body'][_0x561026(0x24a)]],_0x1a3da0=[..._0x4146f3['body']['secondary_unit']],_0x1f4871=[..._0x4146f3[_0x561026(0x1cb)]['batch_code']],_0x3f5970=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x247)]],_0x228969=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x246)]],_0x441e4b=[..._0x4146f3['body'][_0x561026(0x242)]],_0x16519e=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1a0)]],_0x4ffd2a=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1ff)]],_0x2ecc5d=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1d6)]],_0x5f2300=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1d3)]],_0x333e33=[..._0x4146f3['body']['from_invoice']],_0x36475f=[..._0x4146f3[_0x561026(0x1cb)][_0x561026(0x1ad)]];const _0x29da53=_0x546a15[_0x561026(0x1b0)](_0x524d9b=>{return _0x524d9b={'product_name':_0x524d9b};});_0x387958['forEach']((_0x11ce0e,_0x203183)=>{var _0x1e6313=_0x561026;_0x29da53[_0x203183][_0x1e6313(0x20f)]=_0x11ce0e;}),_0x2cc343['forEach']((_0x2f0476,_0x2106c4)=>{_0x29da53[_0x2106c4]['from_bay']=_0x2f0476;}),_0x333e33[_0x561026(0x245)]((_0x21f059,_0x3051c9)=>{var _0x30d437=_0x561026;_0x29da53[_0x3051c9][_0x30d437(0x1ee)]=_0x21f059;}),_0x36475f[_0x561026(0x245)]((_0x41b335,_0x889ba5)=>{var _0x41ffa2=_0x561026;_0x29da53[_0x889ba5][_0x41ffa2(0x23e)]=_0x41b335;}),_0x4cc2ad['forEach']((_0x2270f6,_0x3ad855)=>{var _0x1d5686=_0x561026;_0x29da53[_0x3ad855][_0x1d5686(0x25f)]=_0x2270f6;}),_0x4541e7[_0x561026(0x245)]((_0x37491d,_0x65f6c3)=>{var _0x3f2c52=_0x561026;_0x29da53[_0x65f6c3][_0x3f2c52(0x23f)]=_0x37491d;}),_0x4cea3c[_0x561026(0x245)]((_0x5379a0,_0x29db85)=>{_0x29da53[_0x29db85]['primary_code']=_0x5379a0;}),_0x592e42[_0x561026(0x245)]((_0x9e5452,_0x2758c4)=>{_0x29da53[_0x2758c4]['secondary_code']=_0x9e5452;}),_0x3477ad[_0x561026(0x245)]((_0x57521d,_0x3fe92b)=>{_0x29da53[_0x3fe92b]['product_code']=_0x57521d;}),_0x2b9fa8[_0x561026(0x245)]((_0x1af7da,_0x260540)=>{var _0x26f16f=_0x561026;_0x29da53[_0x260540][_0x26f16f(0x1fe)]=_0x1af7da;}),_0x2835f3[_0x561026(0x245)]((_0x175cca,_0x5cea15)=>{var _0x688385=_0x561026;_0x29da53[_0x5cea15][_0x688385(0x1c1)]=_0x175cca;}),_0x1a3da0['forEach']((_0x4417a4,_0x3b3630)=>{_0x29da53[_0x3b3630]['secondary_unit']=_0x4417a4;}),_0x1f4871[_0x561026(0x245)]((_0x2f403e,_0x12ce2e)=>{var _0x315a61=_0x561026;_0x29da53[_0x12ce2e][_0x315a61(0x206)]=_0x2f403e;}),_0x3f5970['forEach']((_0x9f8219,_0x1e66d8)=>{var _0x2922cb=_0x561026;_0x29da53[_0x1e66d8][_0x2922cb(0x247)]=_0x9f8219;}),_0x228969['forEach']((_0x1d5a0d,_0x58200e)=>{var _0x256508=_0x561026;_0x29da53[_0x58200e][_0x256508(0x249)]=_0x1d5a0d;}),_0x441e4b[_0x561026(0x245)]((_0xb36019,_0x4e81c4)=>{var _0x568c3d=_0x561026;_0x29da53[_0x4e81c4][_0x568c3d(0x1fe)]=_0xb36019;}),_0x16519e[_0x561026(0x245)]((_0x555dbb,_0x507f27)=>{var _0x87c1b1=_0x561026;_0x29da53[_0x507f27][_0x87c1b1(0x1a0)]=_0x555dbb;}),_0x4ffd2a[_0x561026(0x245)]((_0x5ee6f3,_0x2607cb)=>{_0x29da53[_0x2607cb]['prod_cat']=_0x5ee6f3;}),_0x2ecc5d[_0x561026(0x245)]((_0x5cf9e0,_0xac9ed8)=>{var _0x4006e0=_0x561026;_0x29da53[_0xac9ed8][_0x4006e0(0x257)]=_0x5cf9e0;}),_0x5f2300['forEach']((_0x382531,_0x5b64be)=>{var _0x5efc95=_0x561026;_0x29da53[_0x5b64be][_0x5efc95(0x236)]=_0x382531;});const _0x357f02=_0x29da53[_0x561026(0x1ed)](_0x325dc6=>_0x325dc6[_0x561026(0x25f)]!=='0'&&_0x325dc6['to_quantity']!==''||_0x325dc6[_0x561026(0x1a7)]!=='0'&&_0x325dc6['to_floorlevel']!=='');var _0x1d16d7=0x0;_0x357f02[_0x561026(0x245)](_0x5223a0=>{parseInt(_0x5223a0['from_quantity'])<parseInt(_0x5223a0['to_quantity'])&&_0x1d16d7++;});if(_0x1d16d7!=0x0)return _0x4146f3[_0x561026(0x254)](_0x561026(0x265),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x2fe47c[_0x561026(0x228)](_0x561026(0x21d));const _0x21772d=new transfers_finished({'date':_0x11159d,'from_warehouse':_0x54bd72,'to_warehouse':_0x233a96,'product':_0x357f02,'note':_0x5d3a36,'invoice':_0x822d9a}),_0x24034f=await _0x21772d['save']();_0x4146f3[_0x561026(0x254)](_0x561026(0x1da),'Product\x20Transfer\x20successfully'),_0x2fe47c[_0x561026(0x228)](_0x561026(0x1d7)+_0x24034f['_id']);}catch(_0x1bb2f7){console['log'](_0x1bb2f7),_0x2fe47c[_0x561026(0x201)](0xc8)['json']({'errorMessage':_0x1bb2f7[_0x561026(0x1d8)]});}}),router[a0_0x16f786(0x262)]('/preview/:id',auth,async(_0xb34c15,_0x3ea253)=>{var _0x151795=a0_0x16f786;try{const {username:_0x2b2612,email:_0x228d5c,role:_0x22e1a0}=_0xb34c15['user'],_0x1a09fa=_0xb34c15[_0x151795(0x1e2)],_0x954672=await profile['findOne']({'email':_0x1a09fa[_0x151795(0x25e)]}),_0x5b5a8e=await master_shop[_0x151795(0x25b)](),_0xb564c5=await transfers_finished[_0x151795(0x19e)](_0xb34c15['params']['id']);let _0x3f57d4;if(_0x1a09fa[_0x151795(0x1b3)]==_0x151795(0x21a)){const _0x10e31b=await staff[_0x151795(0x1e1)]({'email':_0x1a09fa[_0x151795(0x25e)]});_0x3f57d4=await warehouse[_0x151795(0x25b)]({'status':'Enabled','name':_0x10e31b['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x3f57d4=await warehouse[_0x151795(0x25b)]({'status':_0x151795(0x1e5),'warehouse_category':_0x151795(0x22a)});const _0xf2cb12=await warehouse[_0x151795(0x1d4)]([{'$match':{'name':_0xb564c5['from_warehouse'],'warehouse_category':_0x151795(0x22a)}},{'$unwind':_0x151795(0x1f8)},{'$group':{'_id':_0x151795(0x1c4),'name':{'$first':_0x151795(0x26f)},'product_stock':{'$first':_0x151795(0x222)},'bay':{'$first':_0x151795(0x1d0)},'bin':{'$first':_0x151795(0x272)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x151795(0x219)},'secondary_code':{'$first':_0x151795(0x1ef)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x151795(0x238)},'rack':{'$first':_0x151795(0x1f2)},'expiry_date':{'$first':_0x151795(0x26a)},'production_date':{'$first':_0x151795(0x252)},'room':{'$first':_0x151795(0x1d1)},'warehoue_name':{'$first':_0x151795(0x1ce)}}}]),_0x2ade68=await product[_0x151795(0x25b)]({});if(_0x5b5a8e[0x0][_0x151795(0x215)]=='English\x20(US)'){var _0x24fbf1=users['English'];console[_0x151795(0x1d9)](_0x24fbf1);}else{if(_0x5b5a8e[0x0][_0x151795(0x215)]==_0x151795(0x221))var _0x24fbf1=users[_0x151795(0x221)];else{if(_0x5b5a8e[0x0]['language']=='German')var _0x24fbf1=users['German'];else{if(_0x5b5a8e[0x0][_0x151795(0x215)]==_0x151795(0x1ca))var _0x24fbf1=users['Spanish'];else{if(_0x5b5a8e[0x0][_0x151795(0x215)]==_0x151795(0x200))var _0x24fbf1=users['French'];else{if(_0x5b5a8e[0x0][_0x151795(0x215)]==_0x151795(0x230))var _0x24fbf1=users[_0x151795(0x22e)];else{if(_0x5b5a8e[0x0][_0x151795(0x215)]==_0x151795(0x244))var _0x24fbf1=users[_0x151795(0x244)];else{if(_0x5b5a8e[0x0]['language']==_0x151795(0x1e6))var _0x24fbf1=users[_0x151795(0x1dd)];}}}}}}}_0x3ea253[_0x151795(0x250)]('edit_transfer_finished_view',{'success':_0xb34c15['flash'](_0x151795(0x1da)),'errors':_0xb34c15[_0x151795(0x254)](_0x151795(0x265)),'role':_0x1a09fa,'profile':_0x954672,'master_shop':_0x5b5a8e,'warehouse':_0x3f57d4,'transfer':_0xb564c5,'stock':_0xf2cb12,'unit':_0x2ade68,'language':_0x24fbf1});}catch(_0x184d05){console[_0x151795(0x1d9)](_0x184d05);}}),router[a0_0x16f786(0x270)](a0_0x16f786(0x1c7),auth,async(_0x310eee,_0x3addcf)=>{var _0x3653fc=a0_0x16f786;try{const {invoice:_0x1e8779,from_warehouse:_0x3ce8b5,FromRoom_name:_0x319462,to_warehouse:_0xa22841,ToRoom_name:_0x12822b}=_0x310eee[_0x3653fc(0x1cb)],_0x3145be=await transfers_finished['findById'](_0x310eee['params']['id']),_0x5fedbb=_0x3145be[_0x3653fc(0x1b7)][_0x3653fc(0x1b0)](async _0x806a4=>{var _0x25ae20=_0x3653fc;if(_0x806a4[_0x25ae20(0x25f)]>0x0){var _0xfa2868=await warehouse[_0x25ae20(0x1e1)]({'name':_0x3ce8b5,'room':_0x806a4[_0x25ae20(0x257)],'warehouse_category':_0x25ae20(0x22a)});const _0xec14f=_0xfa2868[_0x25ae20(0x23b)][_0x25ae20(0x1b0)](_0x5b5651=>{var _0x133f38=_0x25ae20;_0x5b5651[_0x133f38(0x212)]==_0x806a4['product_name']&&_0x5b5651['bay']==_0x806a4['from_bay']&&_0x5b5651[_0x133f38(0x247)]==_0x806a4[_0x133f38(0x247)]&&_0x5b5651[_0x133f38(0x249)]==_0x806a4['production_date']&&_0x5b5651[_0x133f38(0x206)]==_0x806a4[_0x133f38(0x206)]&&_0x5b5651[_0x133f38(0x255)]==_0x806a4[_0x133f38(0x1ee)]&&(_0x5b5651[_0x133f38(0x1bb)]=_0x5b5651[_0x133f38(0x1bb)]-_0x806a4['to_quantity']);});}return _0xfa2868;});Promise[_0x3653fc(0x269)](_0x5fedbb)[_0x3653fc(0x234)](async _0x417ca7=>{var _0x2069ab=_0x3653fc;try{for(const _0x365f1c of _0x417ca7){await _0x365f1c[_0x2069ab(0x1b1)]();}const _0x4ba922=_0x3145be[_0x2069ab(0x1b7)][_0x2069ab(0x1b0)](async _0x54e3b3=>{var _0x5c35bc=_0x2069ab,_0x10475a=await warehouse[_0x5c35bc(0x1e1)]({'name':_0xa22841,'room':_0x54e3b3[_0x5c35bc(0x236)]});if(_0x54e3b3['to_quantity']>0x0){var _0x453062=0x0;const _0x4a2f3f=_0x10475a[_0x5c35bc(0x23b)][_0x5c35bc(0x1b0)](_0x492681=>{var _0x525e07=_0x5c35bc;_0x492681['product_name']==_0x54e3b3[_0x525e07(0x212)]&&_0x492681[_0x525e07(0x1a4)]==_0x54e3b3[_0x525e07(0x23f)]&&_0x492681['expiry_date']==_0x54e3b3[_0x525e07(0x247)]&&_0x492681['production_date']==_0x54e3b3['production_date']&&_0x492681[_0x525e07(0x206)]==_0x54e3b3[_0x525e07(0x206)]&&_0x492681[_0x525e07(0x255)]==_0x54e3b3[_0x525e07(0x23e)]&&(_0x492681[_0x525e07(0x1bb)]=_0x492681[_0x525e07(0x1bb)]+_0x54e3b3['to_quantity'],_0x453062++);});_0x453062=='0'&&(_0x10475a[_0x5c35bc(0x23b)]=_0x10475a['product_details'][_0x5c35bc(0x1aa)]({'product_name':_0x54e3b3[_0x5c35bc(0x212)],'product_stock':_0x54e3b3[_0x5c35bc(0x25f)],'bay':_0x54e3b3[_0x5c35bc(0x23f)],'product_code':_0x54e3b3['product_code'],'primary_code':_0x54e3b3['primary_code'],'secondary_code':_0x54e3b3[_0x5c35bc(0x214)],'expiry_date':_0x54e3b3[_0x5c35bc(0x247)],'production_date':_0x54e3b3['production_date'],'maxProducts':_0x54e3b3[_0x5c35bc(0x1fe)],'batch_code':_0x54e3b3[_0x5c35bc(0x206)],'secondary_unit':_0x54e3b3[_0x5c35bc(0x1c2)],'unit':_0x54e3b3[_0x5c35bc(0x1c1)],'maxProducts':_0x54e3b3['maxProducts'],'maxPerUnit':_0x54e3b3['maxPerUnit'],'invoice':_0x54e3b3[_0x5c35bc(0x23e)]}));}return _0x10475a;});Promise[_0x2069ab(0x269)](_0x4ba922)[_0x2069ab(0x234)](async _0x265a85=>{var _0x55271f=_0x2069ab;try{for(const _0x1830c7 of _0x265a85){await warehouse['updateOne']({'_id':_0x1830c7[_0x55271f(0x23a)]},{'$addToSet':{'product_details':{'$each':_0x1830c7[_0x55271f(0x23b)]}}});}_0x3145be[_0x55271f(0x1a3)]='True';const _0x1419d6=await _0x3145be[_0x55271f(0x1b1)](),_0x357bf1=await master_shop[_0x55271f(0x25b)](),_0x27a964=await email_settings[_0x55271f(0x1e1)](),_0x441ea4=await supervisor_settings['find']();var _0x8f46ec=_0x3145be[_0x55271f(0x1b7)],_0x2332d9='',_0x5be8c4;for(_0x5be8c4 in _0x8f46ec){var _0x36b668='FG';_0x3145be[_0x55271f(0x25a)]=='DRY\x20GOODS'&&(_0x36b668='DG'),_0x2332d9+=_0x55271f(0x1a8)+_0x55271f(0x268)+_0x8f46ec[_0x5be8c4][_0x55271f(0x212)]+_0x55271f(0x263)+_0x55271f(0x268)+_0x8f46ec[_0x5be8c4][_0x55271f(0x24c)]+_0x55271f(0x263)+_0x55271f(0x268)+_0x8f46ec[_0x5be8c4][_0x55271f(0x25f)]+_0x55271f(0x263)+_0x55271f(0x268)+_0x8f46ec[_0x5be8c4][_0x55271f(0x1c1)]+_0x55271f(0x263)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x8f46ec[_0x5be8c4][_0x55271f(0x1c2)]+_0x55271f(0x263)+_0x55271f(0x268)+_0x3145be[_0x55271f(0x25a)]+_0x55271f(0x263)+_0x55271f(0x268)+_0x8f46ec[_0x5be8c4][_0x55271f(0x236)]+_0x55271f(0x263)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x36b668+_0x8f46ec[_0x5be8c4][_0x55271f(0x23f)]+_0x55271f(0x263)+_0x55271f(0x204);}let _0x29bc73=nodemailer[_0x55271f(0x1ec)]({'host':_0x27a964[_0x55271f(0x243)],'port':Number(_0x27a964['port']),'secure':![],'auth':{'user':_0x27a964[_0x55271f(0x25e)],'pass':_0x27a964[_0x55271f(0x1b6)]}}),_0x45a64a={'from':_0x27a964[_0x55271f(0x25e)],'to':_0x441ea4[0x0]['FGSEmail'],'subject':_0x55271f(0x1e3),'attachments':[{'filename':_0x55271f(0x24f),'path':__dirname+_0x55271f(0x241)+_0x55271f(0x207)+_0x357bf1[0x0][_0x55271f(0x1ba)],'cid':_0x55271f(0x1b2)}],'html':_0x55271f(0x233)+_0x55271f(0x267)+_0x55271f(0x224)+_0x55271f(0x271)+_0x55271f(0x229)+_0x55271f(0x271)+_0x55271f(0x253)+_0x55271f(0x1f3)+_0x55271f(0x271)+_0x55271f(0x251)+_0x357bf1[0x0][_0x55271f(0x26e)]+_0x55271f(0x25d)+'</div>'+'</div>'+_0x55271f(0x1f7)+_0x55271f(0x271)+_0x55271f(0x21f)+'\x20Order\x20Number\x20:\x20'+_0x3145be[_0x55271f(0x255)]+'\x20'+_0x55271f(0x1c5)+'\x20Order\x20Date\x20:\x20'+_0x3145be[_0x55271f(0x1bd)]+'\x20'+_0x55271f(0x203)+'</h5>'+_0x55271f(0x1f3)+_0x55271f(0x225)+_0x55271f(0x1b9)+_0x55271f(0x1a8)+_0x55271f(0x275)+_0x55271f(0x1bc)+_0x55271f(0x21e)+_0x55271f(0x25c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x55271f(0x1cd)+_0x55271f(0x1d2)+_0x55271f(0x260)+_0x55271f(0x204)+_0x55271f(0x1a9)+_0x55271f(0x274)+'\x20'+_0x2332d9+'\x20'+_0x55271f(0x1c3)+'</table>'+'<div>'+_0x55271f(0x211)+_0x55271f(0x1f9)+_0x357bf1[0x0][_0x55271f(0x26e)]+_0x55271f(0x259)+_0x55271f(0x1f3)+_0x55271f(0x1f3)+'</body></html>'};_0x29bc73[_0x55271f(0x23d)](_0x45a64a,function(_0x5a0b46,_0x5afafe){var _0x8f06c4=_0x55271f;_0x5a0b46?(console['log'](_0x5a0b46),console[_0x8f06c4(0x1d9)]('Error\x20Occurs')):console['log']('Email\x20sent\x20successfully');}),_0x310eee[_0x55271f(0x254)](_0x55271f(0x1da),_0x55271f(0x1b4)),_0x3addcf['redirect'](_0x55271f(0x1af)+_0x1419d6[_0x55271f(0x23a)]);}catch(_0x451c42){console['error'](_0x451c42),_0x3addcf['status'](0x1f4)[_0x55271f(0x220)]({'error':_0x55271f(0x24d)});}})['catch'](_0x11acfc=>{var _0xb57ade=_0x2069ab;console['error'](_0x11acfc),_0x3addcf[_0xb57ade(0x201)](0x1f4)['json']({'error':_0xb57ade(0x20a)});});}catch(_0x1a7412){console[_0x2069ab(0x23c)](_0x1a7412),_0x3addcf[_0x2069ab(0x201)](0x1f4)[_0x2069ab(0x220)]({'error':_0x2069ab(0x1f1)});}})[_0x3653fc(0x216)](_0x582222=>{var _0x25361a=_0x3653fc;console[_0x25361a(0x23c)](_0x582222),_0x3addcf[_0x25361a(0x201)](0x1f4)[_0x25361a(0x220)]({'error':_0x25361a(0x20a)});});}catch(_0x304f29){_0x3addcf[_0x3653fc(0x220)]({'message':_0x304f29[_0x3653fc(0x1d8)]});}});function BayBinSelected(_0x121fa9,_0x215f82){var _0x22b805=a0_0x16f786,_0x20b6e0=[];let _0x4a6a2d=[];var _0x1f35e9=[];if(_0x121fa9==_0x22b805(0x1a5)){switch(_0x215f82){case _0x22b805(0x1cf):_0x20b6e0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x22b805(0x208):_0x20b6e0=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x1f35e9=['DG'];}else{if(_0x121fa9==_0x22b805(0x237)){switch(_0x215f82){case _0x22b805(0x1cf):_0x20b6e0=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x22b805(0x208):_0x20b6e0=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x1f35e9=['FG'];}}return{'levels':_0x20b6e0,'identify':_0x1f35e9};}router[a0_0x16f786(0x262)](a0_0x16f786(0x1de),auth,async(_0x27598c,_0x106eed)=>{var _0x543ad9=a0_0x16f786;try{const {username:_0x30c460,email:_0x584cff,role:_0x3dc0bf}=_0x27598c[_0x543ad9(0x1e2)],_0x536f1f=_0x27598c['user'],_0x361a78=await profile[_0x543ad9(0x1e1)]({'email':_0x536f1f[_0x543ad9(0x25e)]}),_0x2edf75=await master_shop[_0x543ad9(0x25b)](),_0x4a7212=await transfers_finished[_0x543ad9(0x19e)](_0x27598c['params']['id']);let _0x516544=new Date(_0x4a7212['expiry_date']),_0x1a36c1=('0'+_0x516544[_0x543ad9(0x213)]())[_0x543ad9(0x248)](-0x2),_0x2b4860=('0'+(_0x516544[_0x543ad9(0x217)]()+0x1))[_0x543ad9(0x248)](-0x2),_0xd31457=_0x516544[_0x543ad9(0x232)](),_0x53a7eb=_0xd31457+'-'+_0x2b4860+'-'+_0x1a36c1,_0x583bff;if(_0x536f1f[_0x543ad9(0x1b3)]=='staff'){const _0x5efacc=await staff[_0x543ad9(0x1e1)]({'email':_0x536f1f[_0x543ad9(0x25e)]});_0x583bff=await warehouse[_0x543ad9(0x25b)]({'status':_0x543ad9(0x1e5),'name':_0x5efacc[_0x543ad9(0x1f4)],'warehouse_category':_0x543ad9(0x22a)});}else _0x583bff=await warehouse['find']({'status':_0x543ad9(0x1e5),'warehouse_category':_0x543ad9(0x22a)});const _0x1e2f90=await warehouse['aggregate']([{'$match':{'name':_0x4a7212['from_warehouse'],'room':_0x4a7212[_0x543ad9(0x1db)]}},{'$unwind':_0x543ad9(0x1f8)},{'$group':{'_id':_0x543ad9(0x1c4),'name':{'$first':_0x543ad9(0x26f)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x543ad9(0x1d0)},'bin':{'$first':_0x543ad9(0x272)},'type':{'$first':_0x543ad9(0x264)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x543ad9(0x1ef)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x543ad9(0x1f2)}}}]);var _0x881afb=[0x1,0x2,0x3,0x4],_0x41573b=['A','B','C','D','E','F','G','H','I','J'],_0x1c2a55=[_0x543ad9(0x1e9),_0x543ad9(0x1f5)];const _0x655616=await product[_0x543ad9(0x25b)]({}),_0x3640d1=BayBinSelected(_0x4a7212[_0x543ad9(0x25a)],_0x4a7212['to_room']);if(_0x2edf75[0x0][_0x543ad9(0x215)]=='English\x20(US)'){var _0x3bbe5d=users[_0x543ad9(0x202)];console[_0x543ad9(0x1d9)](_0x3bbe5d);}else{if(_0x2edf75[0x0][_0x543ad9(0x215)]=='Hindi')var _0x3bbe5d=users[_0x543ad9(0x221)];else{if(_0x2edf75[0x0][_0x543ad9(0x215)]==_0x543ad9(0x1e0))var _0x3bbe5d=users['German'];else{if(_0x2edf75[0x0][_0x543ad9(0x215)]==_0x543ad9(0x1ca))var _0x3bbe5d=users['Spanish'];else{if(_0x2edf75[0x0][_0x543ad9(0x215)]==_0x543ad9(0x200))var _0x3bbe5d=users[_0x543ad9(0x200)];else{if(_0x2edf75[0x0][_0x543ad9(0x215)]==_0x543ad9(0x230))var _0x3bbe5d=users[_0x543ad9(0x22e)];else{if(_0x2edf75[0x0][_0x543ad9(0x215)]=='Chinese')var _0x3bbe5d=users[_0x543ad9(0x244)];else{if(_0x2edf75[0x0][_0x543ad9(0x215)]=='Arabic\x20(ae)')var _0x3bbe5d=users[_0x543ad9(0x1dd)];}}}}}}}_0x106eed['render']('edit_transfer_finished',{'success':_0x27598c[_0x543ad9(0x254)]('success'),'errors':_0x27598c[_0x543ad9(0x254)](_0x543ad9(0x265)),'role':_0x536f1f,'profile':_0x361a78,'master_shop':_0x2edf75,'warehouse':_0x583bff,'transfer':_0x4a7212,'stock':_0x1e2f90,'unit':_0x655616,'language':_0x3bbe5d,'levels':_0x881afb,'Isle':_0x41573b,'rooms_data':_0x1c2a55,'ed_fullDate':_0x53a7eb,'dataSelected':_0x3640d1});}catch(_0x5b6b57){console['log'](_0x5b6b57);}}),router['post'](a0_0x16f786(0x1de),auth,async(_0x4639c3,_0x2d9298)=>{var _0x33e539=a0_0x16f786;try{const _0x30492c=_0x4639c3[_0x33e539(0x1be)]['id'];console[_0x33e539(0x1d9)](_0x4639c3['body']);const _0x52bbb4=await transfers_finished[_0x33e539(0x19e)](_0x30492c);console[_0x33e539(0x1d9)]('transfer_data',_0x52bbb4);const {date:_0x539235,from_warehouse:_0xd64951,FromRoom_name:_0x32abc1,to_warehouse:_0x2b3702,ToRoom_name:_0x5a0f75,prod_name:_0x348f70,from_prod_qty:_0x321622,from_prod_level:_0x752bd0,from_prod_isle:_0x4f8e1f,from_prod_pallet:_0x17c57c,to_prod_qty:_0x459bbe,to_prod_level:_0x355e1e,to_prod_isle:_0x570402,to_prod_pallet:_0x315242,primary_code:_0x54df3f,secondary_code:_0x1519fe,product_code3:_0x4e0136,note:_0x444698,invoice:_0x11de66,expiry_date:_0x12fbb3}=_0x4639c3[_0x33e539(0x1cb)];if(typeof _0x348f70==_0x33e539(0x26b))var _0x394957=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x19f)]],_0x56d9c7=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x1e4)]],_0x45ea76=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x21c)]],_0x17bb38=[_0x4639c3[_0x33e539(0x1cb)]['to_prod_qty']],_0xc95c11=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x1dc)]],_0x1e271b=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x239)]],_0x73680a=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x214)]],_0x5dc024=[_0x4639c3[_0x33e539(0x1cb)]['product_code3']],_0x5cc8a4=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x266)]],_0x44e654=[_0x4639c3['body'][_0x33e539(0x1c1)]],_0x6bed1f=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x1c2)]],_0x482b55=[_0x4639c3['body'][_0x33e539(0x206)]],_0x5ce2ad=[_0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x247)]];else var _0x394957=[..._0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x19f)]],_0x56d9c7=[..._0x4639c3['body']['from_prod_qty']],_0x45ea76=[..._0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x21c)]],_0x17bb38=[..._0x4639c3[_0x33e539(0x1cb)]['to_prod_qty']],_0xc95c11=[..._0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x1dc)]],_0x1e271b=[..._0x4639c3['body'][_0x33e539(0x239)]],_0x73680a=[..._0x4639c3['body'][_0x33e539(0x214)]],_0x5dc024=[..._0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x1fb)]],_0x5cc8a4=[..._0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x266)]],_0x44e654=[..._0x4639c3['body'][_0x33e539(0x1c1)]],_0x6bed1f=[..._0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x1c2)]],_0x482b55=[..._0x4639c3[_0x33e539(0x1cb)]['batch_code']],_0x5ce2ad=[..._0x4639c3[_0x33e539(0x1cb)][_0x33e539(0x247)]];const _0x5f2f3e=_0x394957[_0x33e539(0x1b0)](_0x3aa046=>{return _0x3aa046={'product_name':_0x3aa046};});_0x56d9c7[_0x33e539(0x245)]((_0x2d8f11,_0x58a83d)=>{_0x5f2f3e[_0x58a83d]['from_quantity']=_0x2d8f11;}),_0x45ea76[_0x33e539(0x245)]((_0x23f28c,_0x5ee51e)=>{var _0x49d23c=_0x33e539;_0x5f2f3e[_0x5ee51e][_0x49d23c(0x1fc)]=_0x23f28c;}),_0x17bb38[_0x33e539(0x245)]((_0x2d1331,_0x2bb2dd)=>{var _0x474037=_0x33e539;_0x5f2f3e[_0x2bb2dd][_0x474037(0x25f)]=_0x2d1331;}),_0xc95c11['forEach']((_0x577dbd,_0x592505)=>{var _0x39371f=_0x33e539;_0x5f2f3e[_0x592505][_0x39371f(0x23f)]=_0x577dbd;}),_0x1e271b[_0x33e539(0x245)]((_0xa0eb1b,_0x239b89)=>{var _0xa0450a=_0x33e539;_0x5f2f3e[_0x239b89][_0xa0450a(0x239)]=_0xa0eb1b;}),_0x73680a[_0x33e539(0x245)]((_0x3c9c16,_0x3e86ae)=>{var _0x30de0c=_0x33e539;_0x5f2f3e[_0x3e86ae][_0x30de0c(0x214)]=_0x3c9c16;}),_0x5dc024[_0x33e539(0x245)]((_0x385e30,_0x2111b5)=>{var _0x1019a3=_0x33e539;_0x5f2f3e[_0x2111b5][_0x1019a3(0x24c)]=_0x385e30;}),_0x5cc8a4[_0x33e539(0x245)]((_0x5d83d2,_0x5d3410)=>{_0x5f2f3e[_0x5d3410]['maxProducts']=_0x5d83d2;}),_0x44e654[_0x33e539(0x245)]((_0x2d8d7d,_0x4656f7)=>{var _0x13a8b0=_0x33e539;_0x5f2f3e[_0x4656f7][_0x13a8b0(0x1c1)]=_0x2d8d7d;}),_0x6bed1f[_0x33e539(0x245)]((_0x2d14a8,_0x479e6a)=>{var _0x244a02=_0x33e539;_0x5f2f3e[_0x479e6a][_0x244a02(0x1c2)]=_0x2d14a8;}),_0x482b55[_0x33e539(0x245)]((_0x4b1a69,_0x3c3a3f)=>{_0x5f2f3e[_0x3c3a3f]['batch_code']=_0x4b1a69;}),_0x5ce2ad[_0x33e539(0x245)]((_0xd19271,_0x37c880)=>{_0x5f2f3e[_0x37c880]['expiry_date']=_0xd19271;});const _0x3909f0=_0x5f2f3e[_0x33e539(0x1ed)](_0x4c3a21=>_0x4c3a21['to_quantity']!=='0'&&_0x4c3a21[_0x33e539(0x25f)]!==''||_0x4c3a21[_0x33e539(0x1a7)]!=='0'&&_0x4c3a21[_0x33e539(0x1a7)]!=='');var _0x58870a=0x0;_0x3909f0[_0x33e539(0x245)](_0x5f51e0=>{var _0x5e2d8d=_0x33e539;parseInt(_0x5f51e0[_0x5e2d8d(0x20f)])<parseInt(_0x5f51e0[_0x5e2d8d(0x25f)])&&_0x58870a++;});if(_0x58870a!=0x0)return _0x4639c3[_0x33e539(0x254)](_0x33e539(0x265),_0x33e539(0x227)),_0x2d9298[_0x33e539(0x228)](_0x33e539(0x21d));const _0x2f35c1=await warehouse[_0x33e539(0x1e1)]({'name':_0x52bbb4[_0x33e539(0x1c0)],'room':_0x52bbb4[_0x33e539(0x1db)]});_0x52bbb4['product'][_0x33e539(0x245)](_0x5823ad=>{var _0x29af15=_0x33e539;if(_0x5823ad[_0x29af15(0x25f)]>0x0){const _0x5ccba7=_0x2f35c1[_0x29af15(0x23b)][_0x29af15(0x1b0)](_0x428140=>{var _0xbbaf=_0x29af15;_0x428140[_0xbbaf(0x212)]==_0x5823ad['product_name']&&_0x428140['bay']==_0x5823ad[_0xbbaf(0x1fc)]&&(_0x428140['product_stock']=parseInt(_0x428140[_0xbbaf(0x1bb)])+parseInt(_0x5823ad[_0xbbaf(0x25f)]));});}}),await _0x2f35c1[_0x33e539(0x1b1)]();const _0x179f3c=await warehouse[_0x33e539(0x1e1)]({'name':_0x52bbb4[_0x33e539(0x25a)],'room':_0x52bbb4[_0x33e539(0x226)]});_0x52bbb4[_0x33e539(0x1b7)][_0x33e539(0x245)](_0x44459b=>{var _0x529b1c=_0x33e539;if(_0x44459b['to_quantity']>0x0){const _0x21ee28=_0x179f3c[_0x529b1c(0x23b)][_0x529b1c(0x1b0)](_0x160859=>{var _0x16f36f=_0x529b1c;_0x160859[_0x16f36f(0x212)]==_0x44459b[_0x16f36f(0x212)]&&_0x160859[_0x16f36f(0x1a4)]==_0x44459b['to_bay']&&(_0x160859[_0x16f36f(0x1bb)]=parseInt(_0x160859[_0x16f36f(0x1bb)])-parseInt(_0x44459b[_0x16f36f(0x25f)]));});}}),await _0x179f3c[_0x33e539(0x1b1)](),_0x52bbb4[_0x33e539(0x1bd)]=_0x539235,_0x52bbb4[_0x33e539(0x1c0)]=_0xd64951,_0x52bbb4[_0x33e539(0x25a)]=_0x2b3702,_0x52bbb4[_0x33e539(0x1b7)]=_0x3909f0,_0x52bbb4[_0x33e539(0x1ab)]=_0x444698,_0x52bbb4[_0x33e539(0x255)]=_0x11de66;const _0x3e3c8e=await _0x52bbb4['save'](),_0x8e8a6a=await warehouse[_0x33e539(0x1e1)]({'name':_0xd64951,'room':_0x32abc1});_0x3e3c8e[_0x33e539(0x1b7)]['forEach'](_0x3dee42=>{var _0xaf1430=_0x33e539;if(_0x3dee42['to_quantity']>0x0){const _0x1fa00a=_0x8e8a6a['product_details'][_0xaf1430(0x1b0)](_0x1a494d=>{var _0x1294cf=_0xaf1430;_0x1a494d[_0x1294cf(0x212)]==_0x3dee42[_0x1294cf(0x212)]&&_0x1a494d['bay']==_0x3dee42[_0x1294cf(0x1fc)]&&(_0x1a494d[_0x1294cf(0x1bb)]=parseInt(_0x1a494d[_0x1294cf(0x1bb)])-parseInt(_0x3dee42[_0x1294cf(0x25f)]));});}}),await _0x8e8a6a['save']();const _0x117258=await warehouse['findOne']({'name':_0x2b3702,'room':_0x5a0f75});_0x3e3c8e[_0x33e539(0x1b7)][_0x33e539(0x245)](_0x35ea66=>{var _0x204ba2=_0x33e539;if(_0x35ea66[_0x204ba2(0x25f)]>0x0){var _0x4d0422=0x0;const _0x1942bb=_0x117258[_0x204ba2(0x23b)][_0x204ba2(0x1b0)](_0x19d966=>{var _0x5f0fec=_0x204ba2;_0x19d966[_0x5f0fec(0x212)]==_0x35ea66[_0x5f0fec(0x212)]&&_0x19d966[_0x5f0fec(0x1a4)]==_0x35ea66[_0x5f0fec(0x23f)]&&(_0x19d966['product_stock']=parseInt(_0x19d966[_0x5f0fec(0x1bb)])+parseInt(_0x35ea66[_0x5f0fec(0x25f)]),_0x4d0422++);});_0x4d0422=='0'&&(_0x117258['product_details']=_0x117258[_0x204ba2(0x23b)][_0x204ba2(0x1aa)]({'product_name':_0x35ea66[_0x204ba2(0x212)],'product_stock':_0x35ea66[_0x204ba2(0x25f)],'bay':_0x35ea66['to_bay'],'product_code':_0x35ea66['product_code'],'primary_code':_0x35ea66['primary_code'],'secondary_code':_0x35ea66[_0x204ba2(0x214)],'maxProducts':_0x35ea66['maxProducts']}));}}),await _0x117258['save'](),_0x4639c3[_0x33e539(0x254)](_0x33e539(0x1da),_0x33e539(0x1a1)),_0x2d9298[_0x33e539(0x228)](_0x33e539(0x261));}catch(_0x2e4357){console['log'](_0x2e4357);}}),router['post'](a0_0x16f786(0x22f),async(_0x525e1f,_0x220d7c)=>{var _0x403d38=a0_0x16f786;const {FromWareHouse:_0x6dbe86,FromRoom:_0x13a649,ToWarehouse:_0x1ced34,ToRoom:_0x2a7846,primary_code:_0x454d06,Roomslist:_0x144eb7}=_0x525e1f[_0x403d38(0x1cb)],_0x286259=_0x144eb7['split'](','),_0x5e8e0c=[];async function _0x55b8cf(_0x31c577){var _0x526740=_0x403d38;const _0x49c00c=await warehouse['aggregate']([{'$match':{'name':_0x6dbe86,'room':_0x31c577}},{'$unwind':_0x526740(0x1f8)},{'$match':{'product_details.primary_code':_0x454d06}},{'$group':{'_id':_0x526740(0x1c4),'name':{'$first':_0x526740(0x26f)},'instock':{'$first':_0x526740(0x222)},'primary_code':{'$first':_0x526740(0x219)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x526740(0x1c9)},'level':{'$first':_0x526740(0x1d0)},'isle':{'$first':_0x526740(0x272)},'type':{'$first':_0x526740(0x264)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x526740(0x235)},'secondary_unit':{'$first':_0x526740(0x1c6)},'storage':{'$first':_0x526740(0x238)},'rack':{'$first':_0x526740(0x1f2)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x526740(0x252)},'batch_code':{'$first':_0x526740(0x20e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x526740(0x1d1)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x526740(0x1f0)}}}]),_0x305f74=await warehouse[_0x526740(0x1d4)]([{'$match':{'name':_0x6dbe86,'room':_0x31c577}},{'$unwind':_0x526740(0x1f8)},{'$match':{'product_details.secondary_code':_0x454d06}},{'$group':{'_id':_0x526740(0x1c4),'name':{'$first':_0x526740(0x26f)},'instock':{'$first':_0x526740(0x222)},'primary_code':{'$first':_0x526740(0x219)},'secondary_code':{'$first':_0x526740(0x1ef)},'product_code':{'$first':_0x526740(0x1c9)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x526740(0x272)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x526740(0x235)},'secondary_unit':{'$first':_0x526740(0x1c6)},'storage':{'$first':_0x526740(0x238)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x526740(0x26a)},'production_date':{'$first':_0x526740(0x252)},'batch_code':{'$first':_0x526740(0x20e)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x526740(0x1f0)}}}]);if(_0x49c00c[_0x526740(0x26d)]>0x0)_0x5e8e0c['push'](_0x49c00c);else _0x305f74[_0x526740(0x26d)]>0x0&&_0x5e8e0c['push'](_0x305f74);}const _0x38e52c=_0x286259['map'](_0xab8846=>_0x55b8cf(_0xab8846));await Promise['all'](_0x38e52c),_0x220d7c['json'](_0x5e8e0c);}),router[a0_0x16f786(0x270)](a0_0x16f786(0x218),async(_0x54ae5d,_0x5278d5)=>{var _0x583e14=a0_0x16f786;try{const {FromWareHouse:_0xc5f113,FromRoom:_0x4d0abe,ToWarehouse:_0x4ff87a,ToRoom:_0x4e2e54,secondary_code:_0x5ac22a}=_0x54ae5d[_0x583e14(0x1cb)],_0x50b91d=await warehouse[_0x583e14(0x1d4)]([{'$match':{'name':_0xc5f113}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5ac22a}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x583e14(0x26f)},'primary_code':{'$first':_0x583e14(0x219)},'secondary_code':{'$first':_0x583e14(0x1ef)},'product_code':{'$first':_0x583e14(0x1c9)},'instock':{'$first':_0x583e14(0x222)},'warehouse':{'$first':_0x583e14(0x1ce)},'level':{'$first':_0x583e14(0x1ea)},'isle':{'$first':_0x583e14(0x231)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x583e14(0x235)},'expiry_date':{'$first':_0x583e14(0x26a)},'production_date':{'$first':_0x583e14(0x252)}}}]);_0x5278d5[_0x583e14(0x201)](0xc8)[_0x583e14(0x220)](_0x50b91d);}catch(_0x4396b4){_0x5278d5[_0x583e14(0x201)](0x194)[_0x583e14(0x220)]({'message':_0x4396b4['message']});}}),router[a0_0x16f786(0x270)]('/barcode_scanner3',async(_0x16a462,_0x2c1f83)=>{var _0x1e326d=a0_0x16f786;try{const {FromWareHouse:_0x5cdd7d,FromRoom:_0x12117e,ToWarehouse:_0x11044a,ToRoom:_0x2b15b2,product_code:_0x3c595f}=_0x16a462[_0x1e326d(0x1cb)],_0x2400c4=await warehouse[_0x1e326d(0x1d4)]([{'$match':{'name':_0x5cdd7d}},{'$unwind':_0x1e326d(0x1f8)},{'$match':{'product_details.product_code':_0x3c595f}},{'$group':{'_id':_0x1e326d(0x1c4),'name':{'$first':_0x1e326d(0x26f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1e326d(0x1ef)},'product_code':{'$first':_0x1e326d(0x1c9)},'instock':{'$first':_0x1e326d(0x222)},'warehouse':{'$first':_0x1e326d(0x1ce)},'level':{'$first':_0x1e326d(0x1ea)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x1e326d(0x273)},'maxProducts':{'$first':_0x1e326d(0x1d5)},'unit':{'$first':_0x1e326d(0x235)}}}]);_0x2c1f83[_0x1e326d(0x201)](0xc8)[_0x1e326d(0x220)](_0x2400c4);}catch(_0x1d73f2){_0x2c1f83[_0x1e326d(0x201)](0x194)[_0x1e326d(0x220)]({'message':_0x1d73f2[_0x1e326d(0x1d8)]});}}),router[a0_0x16f786(0x270)]('/CheckingWarehouse',async(_0x3c66b7,_0x5d9993)=>{var _0x42e2fd=a0_0x16f786;const {productCode:_0x2f2052,bay:_0x5c8a22,warehouses:_0x5ddd4d,room:_0x2b8395}=_0x3c66b7[_0x42e2fd(0x1cb)];console[_0x42e2fd(0x1d9)](_0x3c66b7['body']);try{const _0x4d80fb=await warehouse[_0x42e2fd(0x1d4)]([{'$match':{'name':_0x5ddd4d,'room':_0x2b8395}},{'$unwind':_0x42e2fd(0x1f8)},{'$match':{'product_details.bay':parseInt(_0x5c8a22)}},{'$group':{'_id':_0x42e2fd(0x1c4),'name':{'$first':_0x42e2fd(0x26f)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x42e2fd(0x1d5)}}}]);_0x5d9993[_0x42e2fd(0x201)](0xc8)[_0x42e2fd(0x220)](_0x4d80fb);}catch(_0x201948){_0x5d9993[_0x42e2fd(0x201)](0x194)[_0x42e2fd(0x220)]({'message':_0x201948[_0x42e2fd(0x1d8)]});}}),module[a0_0x16f786(0x1a2)]=router;