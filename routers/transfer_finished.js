var a0_0x4ac7b0=a0_0x213c;(function(_0x3466d7,_0x38429b){var _0x14b898=a0_0x213c,_0x463a41=_0x3466d7();while(!![]){try{var _0x12aa34=-parseInt(_0x14b898(0x1c4))/0x1*(-parseInt(_0x14b898(0x1b4))/0x2)+-parseInt(_0x14b898(0x185))/0x3+-parseInt(_0x14b898(0x15c))/0x4*(parseInt(_0x14b898(0x22b))/0x5)+parseInt(_0x14b898(0x226))/0x6*(-parseInt(_0x14b898(0x18c))/0x7)+-parseInt(_0x14b898(0x16e))/0x8+parseInt(_0x14b898(0x15b))/0x9*(parseInt(_0x14b898(0x1be))/0xa)+-parseInt(_0x14b898(0x1f9))/0xb*(-parseInt(_0x14b898(0x162))/0xc);if(_0x12aa34===_0x38429b)break;else _0x463a41['push'](_0x463a41['shift']());}catch(_0x1cf6ad){_0x463a41['push'](_0x463a41['shift']());}}}(a0_0x3137,0x77b89));const express=require(a0_0x4ac7b0(0x1d3)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x4ac7b0(0x1a6)),auth=require(a0_0x4ac7b0(0x1e9)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4ac7b0(0x151));router[a0_0x4ac7b0(0x1ef)](a0_0x4ac7b0(0x1a4),auth,async(_0x3590e7,_0x620a29)=>{var _0x3c7850=a0_0x4ac7b0;try{const {username:_0x40292e,email:_0x4828ba,role:_0x665366}=_0x3590e7[_0x3c7850(0x17e)],_0x5bb420=_0x3590e7[_0x3c7850(0x17e)],_0x15a2b8=await profile['findOne']({'email':_0x5bb420[_0x3c7850(0x220)]}),_0x1d9f4d=await master_shop[_0x3c7850(0x191)]();let _0x1fa95a;if(_0x5bb420[_0x3c7850(0x1b5)]==_0x3c7850(0x1c8)){const _0x2317d2=await staff[_0x3c7850(0x1b6)]({'email':_0x5bb420[_0x3c7850(0x220)]});_0x1fa95a=await transfers_finished['find']({'from_warehouse':_0x2317d2['warehouse']});}else _0x1fa95a=await transfers_finished[_0x3c7850(0x1a0)]([{'$unwind':'$product'},{'$group':{'_id':_0x3c7850(0x1d0),'invoice':{'$first':_0x3c7850(0x21b)},'date':{'$first':_0x3c7850(0x14e)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x3c7850(0x1e5)},'from_room_name':{'$addToSet':_0x3c7850(0x21f)},'to_room_name':{'$addToSet':_0x3c7850(0x22e)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x1d9f4d[0x0]['language']==_0x3c7850(0x1f8))var _0x57fb4a=users[_0x3c7850(0x19b)];else{if(_0x1d9f4d[0x0][_0x3c7850(0x167)]==_0x3c7850(0x223))var _0x57fb4a=users[_0x3c7850(0x223)];else{if(_0x1d9f4d[0x0][_0x3c7850(0x167)]==_0x3c7850(0x165))var _0x57fb4a=users[_0x3c7850(0x165)];else{if(_0x1d9f4d[0x0][_0x3c7850(0x167)]=='Spanish')var _0x57fb4a=users['Spanish'];else{if(_0x1d9f4d[0x0][_0x3c7850(0x167)]=='French')var _0x57fb4a=users[_0x3c7850(0x1de)];else{if(_0x1d9f4d[0x0][_0x3c7850(0x167)]=='Portuguese\x20(BR)')var _0x57fb4a=users['Portuguese'];else{if(_0x1d9f4d[0x0][_0x3c7850(0x167)]==_0x3c7850(0x1ee))var _0x57fb4a=users[_0x3c7850(0x1ee)];else{if(_0x1d9f4d[0x0][_0x3c7850(0x167)]==_0x3c7850(0x1d1))var _0x57fb4a=users[_0x3c7850(0x21e)];}}}}}}}_0x620a29[_0x3c7850(0x198)](_0x3c7850(0x1c9),{'success':_0x3590e7[_0x3c7850(0x1f6)]('success'),'errors':_0x3590e7[_0x3c7850(0x1f6)](_0x3c7850(0x1d6)),'role':_0x5bb420,'profile':_0x15a2b8,'master_shop':_0x1d9f4d,'transfer':_0x1fa95a,'language':_0x57fb4a});}catch(_0x109c3a){console[_0x3c7850(0x1bc)](_0x109c3a);}});function a0_0x213c(_0x57c1df,_0x983b94){var _0x31376f=a0_0x3137();return a0_0x213c=function(_0x213ceb,_0x2a3fe8){_0x213ceb=_0x213ceb-0x14d;var _0x3970a7=_0x31376f[_0x213ceb];return _0x3970a7;},a0_0x213c(_0x57c1df,_0x983b94);}async function getRandom8DigitNumber(){var _0xf09255=a0_0x4ac7b0;const _0x408347=0x989680,_0x3c06c3=0x5f5e0ff,_0xbb3770=Math[_0xf09255(0x154)](Math['random']()*(_0x3c06c3-_0x408347+0x1))+_0x408347;var _0x5d3a94;const _0x2222f0=await transfers_finished[_0xf09255(0x1b6)]({'invoice':'TRFF-'+_0xbb3770});return _0x2222f0&&_0x2222f0[_0xf09255(0x1d4)]>0x0?_0x5d3a94=_0xf09255(0x19e)+_0xbb3770:_0x5d3a94=_0xf09255(0x19e)+_0xbb3770,_0x5d3a94;}router['get'](a0_0x4ac7b0(0x1ea),auth,async(_0x3855b9,_0x132e7f)=>{var _0x57d982=a0_0x4ac7b0;try{const {username:_0x1df1aa,email:_0x38386e,role:_0x10a697}=_0x3855b9[_0x57d982(0x17e)],_0x41304d=_0x3855b9[_0x57d982(0x17e)],_0x17f881=await profile['findOne']({'email':_0x41304d['email']}),_0x6d781f=await master_shop[_0x57d982(0x191)]();let _0x593c54;if(_0x41304d[_0x57d982(0x1b5)]=='staff'){const _0x1bf540=await staff[_0x57d982(0x1b6)]({'email':_0x41304d['email']});_0x593c54=await warehouse[_0x57d982(0x1a0)]([{'$match':{'status':_0x57d982(0x20e),'name':_0x1bf540['warehouse'],'warehouse_category':_0x57d982(0x19c),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x57d982(0x16a),'name':{'$first':_0x57d982(0x16a)}}}]);}else _0x593c54=await warehouse[_0x57d982(0x1a0)]([{'$match':{'status':_0x57d982(0x20e),'warehouse_category':_0x57d982(0x19c),'name':{'$ne':_0x57d982(0x199)}}},{'$group':{'_id':_0x57d982(0x16a),'name':{'$first':_0x57d982(0x16a)}}}]);const _0x5aab04=await transfers_finished['find']({}),_0x17fb91=_0x5aab04[_0x57d982(0x1d4)]+0x1,_0x179009='TRFF-'+_0x17fb91['toString']()[_0x57d982(0x209)](0x5,'0');if(_0x6d781f[0x0][_0x57d982(0x167)]==_0x57d982(0x1f8))var _0x296ddf=users[_0x57d982(0x19b)];else{if(_0x6d781f[0x0]['language']==_0x57d982(0x223))var _0x296ddf=users[_0x57d982(0x223)];else{if(_0x6d781f[0x0][_0x57d982(0x167)]=='German')var _0x296ddf=users[_0x57d982(0x165)];else{if(_0x6d781f[0x0][_0x57d982(0x167)]=='Spanish')var _0x296ddf=users[_0x57d982(0x1e2)];else{if(_0x6d781f[0x0][_0x57d982(0x167)]==_0x57d982(0x1de))var _0x296ddf=users['French'];else{if(_0x6d781f[0x0][_0x57d982(0x167)]=='Portuguese\x20(BR)')var _0x296ddf=users['Portuguese'];else{if(_0x6d781f[0x0]['language']=='Chinese')var _0x296ddf=users[_0x57d982(0x1ee)];else{if(_0x6d781f[0x0][_0x57d982(0x167)]==_0x57d982(0x1d1))var _0x296ddf=users['Arabic'];}}}}}}}const _0x387e6d=getRandom8DigitNumber();_0x387e6d['then'](_0x147f2d=>{var _0x55e4aa=_0x57d982;_0x132e7f[_0x55e4aa(0x198)](_0x55e4aa(0x17a),{'success':_0x3855b9['flash'](_0x55e4aa(0x16d)),'errors':_0x3855b9['flash'](_0x55e4aa(0x1d6)),'role':_0x41304d,'profile':_0x17f881,'master_shop':_0x6d781f,'warehouse':_0x593c54,'language':_0x296ddf,'invoice':_0x147f2d});})[_0x57d982(0x1c0)](_0x11670a=>{var _0x3056d8=_0x57d982;_0x3855b9[_0x3056d8(0x1f6)](_0x3056d8(0x1d6),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x132e7f[_0x3056d8(0x176)]('/transfer/view');});}catch(_0x33ede2){console[_0x57d982(0x1bc)](_0x33ede2);}}),router[a0_0x4ac7b0(0x1cb)](a0_0x4ac7b0(0x1ea),auth,async(_0x1b169e,_0x3c7dcf)=>{var _0x33912e=a0_0x4ac7b0;try{const {date:_0x2c0abf,from_warehouse:_0xfd5f1c,FromRoom_name:_0x3d5772,to_warehouse:_0x290051,ToRoom_name:_0xebdf23,prod_name:_0x313f47,from_prod_qty:_0x1b90ef,from_prod_level:_0x4d9746,from_prod_isle:_0x32a9a9,from_prod_pallet:_0x30689c,to_prod_qty:_0x376b15,to_prod_level:_0x2391e1,to_prod_isle:_0x1f21fa,to_prod_pallet:_0x9828fc,primary_code:_0x3bc759,secondary_code:_0x39a572,product_code3:_0x4eacf0,note:_0x572426,MaxStocks_data2:_0x3e7a60,invoice:_0x32c244,expiry_date:_0x1479d4}=_0x1b169e['body'];if(typeof _0x313f47==_0x33912e(0x1ba))var _0x370fa3=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x177)]],_0x5c4b95=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x17f)]],_0x5ca672=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x1cf)]],_0x2d3219=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x1ce)]],_0x19fb73=[_0x1b169e['body'][_0x33912e(0x171)]],_0x397e6d=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x15e)]],_0xaf555b=[_0x1b169e['body'][_0x33912e(0x1f0)]],_0x28d541=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x186)]],_0x26678d=[_0x1b169e[_0x33912e(0x189)]['MaxStocks_data2']],_0x5f2587=[_0x1b169e['body'][_0x33912e(0x212)]],_0x9af230=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x1a5)]],_0x4372b4=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x214)]],_0x57ba18=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x1dc)]],_0x2a6418=[_0x1b169e['body'][_0x33912e(0x1b2)]],_0x3b5d56=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x169)]],_0x27d52e=[_0x1b169e['body']['maxPerUnit']],_0x9f9dfe=[_0x1b169e[_0x33912e(0x189)]['prod_cat']],_0x4d5512=[_0x1b169e['body']['RoomAssigned']],_0x2f24b4=[_0x1b169e['body'][_0x33912e(0x201)]],_0x52c596=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x1ab)]],_0x2a3269=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x174)]],_0x20be78=[_0x1b169e[_0x33912e(0x189)][_0x33912e(0x1a2)]];else var _0x370fa3=[..._0x1b169e['body']['prod_name']],_0x5c4b95=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x17f)]],_0x5ca672=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1cf)]],_0x2d3219=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1ce)]],_0x19fb73=[..._0x1b169e['body'][_0x33912e(0x171)]],_0x397e6d=[..._0x1b169e[_0x33912e(0x189)]['primary_code']],_0xaf555b=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1f0)]],_0x28d541=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x186)]],_0x26678d=[..._0x1b169e['body'][_0x33912e(0x1e7)]],_0x5f2587=[..._0x1b169e['body'][_0x33912e(0x212)]],_0x9af230=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1a5)]],_0x4372b4=[..._0x1b169e['body'][_0x33912e(0x214)]],_0x57ba18=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1dc)]],_0x2a6418=[..._0x1b169e['body'][_0x33912e(0x1b2)]],_0x3b5d56=[..._0x1b169e[_0x33912e(0x189)]['MaxStocks_data']],_0x27d52e=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x178)]],_0x9f9dfe=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1a7)]],_0x4d5512=[..._0x1b169e[_0x33912e(0x189)]['RoomAssigned']],_0x2f24b4=[..._0x1b169e[_0x33912e(0x189)]['ToRoomAssigned']],_0x52c596=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1ab)]],_0x2a3269=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x174)]],_0x20be78=[..._0x1b169e[_0x33912e(0x189)][_0x33912e(0x1a2)]];const _0x961fe3=_0x370fa3['map'](_0x45ca95=>{return _0x45ca95={'product_name':_0x45ca95};});_0x5c4b95[_0x33912e(0x227)]((_0xd6d263,_0x43f94c)=>{var _0x2c4eba=_0x33912e;_0x961fe3[_0x43f94c][_0x2c4eba(0x19f)]=_0xd6d263;}),_0x5ca672[_0x33912e(0x227)]((_0x1ad010,_0x24c49f)=>{_0x961fe3[_0x24c49f]['from_bay']=_0x1ad010;}),_0x20be78['forEach']((_0x57a8b8,_0x1867f5)=>{var _0x3810f2=_0x33912e;_0x961fe3[_0x1867f5][_0x3810f2(0x1a2)]=_0x57a8b8;}),_0x52c596['forEach']((_0x3f0b20,_0x394a80)=>{var _0x36cf73=_0x33912e;_0x961fe3[_0x394a80][_0x36cf73(0x1ab)]=_0x3f0b20;}),_0x2a3269[_0x33912e(0x227)]((_0x5e6a92,_0x5895a5)=>{var _0x46b758=_0x33912e;_0x961fe3[_0x5895a5][_0x46b758(0x18e)]=_0x5e6a92;}),_0x2d3219[_0x33912e(0x227)]((_0x1cf00c,_0x19f501)=>{var _0x50cf88=_0x33912e;_0x961fe3[_0x19f501][_0x50cf88(0x204)]=_0x1cf00c;}),_0x19fb73[_0x33912e(0x227)]((_0x57d87c,_0x38593b)=>{_0x961fe3[_0x38593b]['to_bay']=_0x57d87c;}),_0x397e6d['forEach']((_0x3f6e61,_0x4dddaa)=>{var _0x35cd4a=_0x33912e;_0x961fe3[_0x4dddaa][_0x35cd4a(0x15e)]=_0x3f6e61;}),_0xaf555b[_0x33912e(0x227)]((_0x49aec5,_0x3bf080)=>{_0x961fe3[_0x3bf080]['secondary_code']=_0x49aec5;}),_0x28d541[_0x33912e(0x227)]((_0x4d1054,_0x3b7e47)=>{var _0x52522d=_0x33912e;_0x961fe3[_0x3b7e47][_0x52522d(0x155)]=_0x4d1054;}),_0x26678d[_0x33912e(0x227)]((_0x3449b5,_0x56763b)=>{_0x961fe3[_0x56763b]['maxProducts']=_0x3449b5;}),_0x5f2587['forEach']((_0x1ae314,_0x6ef903)=>{var _0x71b956=_0x33912e;_0x961fe3[_0x6ef903][_0x71b956(0x1d9)]=_0x1ae314;}),_0x9af230[_0x33912e(0x227)]((_0x5b216e,_0x52e80b)=>{var _0x3d57a0=_0x33912e;_0x961fe3[_0x52e80b][_0x3d57a0(0x1a5)]=_0x5b216e;}),_0x4372b4[_0x33912e(0x227)]((_0x10955f,_0x28319c)=>{var _0x450b0d=_0x33912e;_0x961fe3[_0x28319c][_0x450b0d(0x214)]=_0x10955f;}),_0x57ba18[_0x33912e(0x227)]((_0x18b917,_0x232458)=>{var _0x346662=_0x33912e;_0x961fe3[_0x232458][_0x346662(0x1dc)]=_0x18b917;}),_0x2a6418[_0x33912e(0x227)]((_0x4e9fb8,_0x492b35)=>{var _0x3755c0=_0x33912e;_0x961fe3[_0x492b35][_0x3755c0(0x1b1)]=_0x4e9fb8;}),_0x3b5d56[_0x33912e(0x227)]((_0x2ae4c0,_0x3eb2d5)=>{var _0x1a5d61=_0x33912e;_0x961fe3[_0x3eb2d5][_0x1a5d61(0x228)]=_0x2ae4c0;}),_0x27d52e[_0x33912e(0x227)]((_0x4d7432,_0x55ba52)=>{var _0x2c6a6f=_0x33912e;_0x961fe3[_0x55ba52][_0x2c6a6f(0x178)]=_0x4d7432;}),_0x9f9dfe[_0x33912e(0x227)]((_0x56cb01,_0x129c9c)=>{var _0x525d19=_0x33912e;_0x961fe3[_0x129c9c][_0x525d19(0x1a7)]=_0x56cb01;}),_0x4d5512[_0x33912e(0x227)]((_0x39679b,_0x264f50)=>{var _0x1bed46=_0x33912e;_0x961fe3[_0x264f50][_0x1bed46(0x1b8)]=_0x39679b;}),_0x2f24b4[_0x33912e(0x227)]((_0x5e2fef,_0xfb69)=>{var _0xbdd77e=_0x33912e;_0x961fe3[_0xfb69][_0xbdd77e(0x21d)]=_0x5e2fef;});const _0x26ce4e=_0x961fe3['filter'](_0x2b9895=>_0x2b9895[_0x33912e(0x204)]!=='0'&&_0x2b9895[_0x33912e(0x204)]!==''||_0x2b9895[_0x33912e(0x1f5)]!=='0'&&_0x2b9895[_0x33912e(0x1f5)]!=='');var _0x2f3316=0x0;_0x26ce4e[_0x33912e(0x227)](_0x108d45=>{var _0x44427e=_0x33912e;parseInt(_0x108d45[_0x44427e(0x19f)])<parseInt(_0x108d45['to_quantity'])&&_0x2f3316++;});if(_0x2f3316!=0x0)return _0x1b169e[_0x33912e(0x1f6)](_0x33912e(0x1d6),_0x33912e(0x20f)),_0x3c7dcf['redirect']('back');const _0x2b67fe=new transfers_finished({'date':_0x2c0abf,'from_warehouse':_0xfd5f1c,'to_warehouse':_0x290051,'product':_0x26ce4e,'note':_0x572426,'invoice':_0x32c244}),_0x462072=await _0x2b67fe[_0x33912e(0x193)]();_0x1b169e[_0x33912e(0x1f6)](_0x33912e(0x16d),'Product\x20Transfer\x20successfully'),_0x3c7dcf[_0x33912e(0x176)]('/transfer_finished/preview/'+_0x462072[_0x33912e(0x1d5)]);}catch(_0x18113e){console[_0x33912e(0x1bc)](_0x18113e),_0x3c7dcf[_0x33912e(0x150)](0xc8)[_0x33912e(0x20a)]({'errorMessage':_0x18113e['message']});}}),router[a0_0x4ac7b0(0x1ef)](a0_0x4ac7b0(0x22d),auth,async(_0x166610,_0x51960f)=>{var _0x1be257=a0_0x4ac7b0;try{const {username:_0x4b4cfe,email:_0x44696a,role:_0x5ade9f}=_0x166610[_0x1be257(0x17e)],_0x5c95de=_0x166610[_0x1be257(0x17e)],_0x33bff2=await profile[_0x1be257(0x1b6)]({'email':_0x5c95de['email']}),_0x4c6726=await master_shop['find'](),_0x25f2ad=await transfers_finished[_0x1be257(0x1db)](_0x166610[_0x1be257(0x19d)]['id']);let _0x2a87ce;if(_0x5c95de['role']=='staff'){const _0x3e853d=await staff['findOne']({'email':_0x5c95de[_0x1be257(0x220)]});_0x2a87ce=await warehouse[_0x1be257(0x191)]({'status':_0x1be257(0x20e),'name':_0x3e853d[_0x1be257(0x21c)],'warehouse_category':_0x1be257(0x19c)});}else _0x2a87ce=await warehouse[_0x1be257(0x191)]({'status':'Enabled','warehouse_category':_0x1be257(0x19c)});const _0x270b48=await warehouse['aggregate']([{'$match':{'name':_0x25f2ad['from_warehouse'],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x1be257(0x156)},{'$group':{'_id':_0x1be257(0x200),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1be257(0x1e3)},'bay':{'$first':_0x1be257(0x1c3)},'bin':{'$first':_0x1be257(0x20d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1be257(0x192)},'secondary_code':{'$first':_0x1be257(0x1e1)},'product_code':{'$first':_0x1be257(0x18f)},'storage':{'$first':_0x1be257(0x197)},'rack':{'$first':_0x1be257(0x20c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1be257(0x1fc)},'room':{'$first':_0x1be257(0x1bf)},'warehoue_name':{'$first':_0x1be257(0x16a)}}}]),_0x320956=await product['find']({});if(_0x4c6726[0x0][_0x1be257(0x167)]==_0x1be257(0x1f8)){var _0x21a2c1=users[_0x1be257(0x19b)];console[_0x1be257(0x1bc)](_0x21a2c1);}else{if(_0x4c6726[0x0][_0x1be257(0x167)]==_0x1be257(0x223))var _0x21a2c1=users['Hindi'];else{if(_0x4c6726[0x0][_0x1be257(0x167)]=='German')var _0x21a2c1=users['German'];else{if(_0x4c6726[0x0]['language']=='Spanish')var _0x21a2c1=users[_0x1be257(0x1e2)];else{if(_0x4c6726[0x0]['language']=='French')var _0x21a2c1=users['French'];else{if(_0x4c6726[0x0]['language']==_0x1be257(0x1d2))var _0x21a2c1=users['Portuguese'];else{if(_0x4c6726[0x0][_0x1be257(0x167)]==_0x1be257(0x1ee))var _0x21a2c1=users[_0x1be257(0x1ee)];else{if(_0x4c6726[0x0][_0x1be257(0x167)]==_0x1be257(0x1d1))var _0x21a2c1=users[_0x1be257(0x21e)];}}}}}}}_0x51960f[_0x1be257(0x198)](_0x1be257(0x170),{'success':_0x166610[_0x1be257(0x1f6)]('success'),'errors':_0x166610[_0x1be257(0x1f6)](_0x1be257(0x1d6)),'role':_0x5c95de,'profile':_0x33bff2,'master_shop':_0x4c6726,'warehouse':_0x2a87ce,'transfer':_0x25f2ad,'stock':_0x270b48,'unit':_0x320956,'language':_0x21a2c1});}catch(_0x2a084b){console[_0x1be257(0x1bc)](_0x2a084b);}}),router[a0_0x4ac7b0(0x1cb)]('/preview/:id',auth,async(_0x12e4db,_0x1aa8be)=>{var _0x813e1e=a0_0x4ac7b0;try{const {invoice:_0x4ca228,from_warehouse:_0x82fcf7,FromRoom_name:_0x5abdb0,to_warehouse:_0x2ce07c,ToRoom_name:_0x249406}=_0x12e4db[_0x813e1e(0x189)],_0x1dc603=await transfers_finished[_0x813e1e(0x1db)](_0x12e4db['params']['id']),_0x4e4c33=_0x1dc603[_0x813e1e(0x1b7)][_0x813e1e(0x161)](async _0x3762aa=>{var _0x8633a6=_0x813e1e;if(_0x3762aa[_0x8633a6(0x204)]>0x0){var _0x4e328e=await warehouse['findOne']({'name':_0x82fcf7,'room':_0x3762aa[_0x8633a6(0x1b8)],'warehouse_category':'Finished\x20Goods'});const _0x688fd4=_0x4e328e[_0x8633a6(0x18d)][_0x8633a6(0x161)](_0x3d55bf=>{var _0x22e16e=_0x8633a6;_0x3d55bf[_0x22e16e(0x1ac)]==_0x3762aa[_0x22e16e(0x1ac)]&&_0x3d55bf['bay']==_0x3762aa[_0x22e16e(0x1ca)]&&_0x3d55bf[_0x22e16e(0x1dc)]==_0x3762aa[_0x22e16e(0x1dc)]&&_0x3d55bf['production_date']==_0x3762aa[_0x22e16e(0x1b1)]&&_0x3d55bf[_0x22e16e(0x214)]==_0x3762aa[_0x22e16e(0x214)]&&_0x3d55bf[_0x22e16e(0x1ec)]==_0x3762aa['from_invoice']&&(console[_0x22e16e(0x1bc)](_0x22e16e(0x22c),_0x3d55bf[_0x22e16e(0x19a)]),typeof _0x3762aa[_0x22e16e(0x1a2)]==_0x22e16e(0x1d8)?_0x3d55bf[_0x22e16e(0x19a)]=Math[_0x22e16e(0x202)](0x0,Math[_0x22e16e(0x1c7)](_0x3d55bf[_0x22e16e(0x19a)])-Math['abs'](_0x3762aa[_0x22e16e(0x204)])):_0x3d55bf[_0x22e16e(0x19a)]=Math['max'](0x0,Math[_0x22e16e(0x1c7)](_0x3d55bf[_0x22e16e(0x19a)])-Math[_0x22e16e(0x1c7)](_0x3762aa[_0x22e16e(0x204)])));});}return _0x4e328e;});Promise['all'](_0x4e4c33)['then'](async _0x4d239d=>{var _0x5c373c=_0x813e1e;try{for(const _0x55c643 of _0x4d239d){await _0x55c643['save']();}const _0x49df1a=_0x1dc603[_0x5c373c(0x1b7)][_0x5c373c(0x161)](async _0x4b3b0d=>{var _0x40ad51=_0x5c373c,_0x7c7650=await warehouse[_0x40ad51(0x1b6)]({'name':_0x2ce07c,'room':_0x4b3b0d['to_room_name']});if(_0x4b3b0d['to_quantity']>0x0){var _0x513203=0x0;const _0x5b903e=_0x7c7650[_0x40ad51(0x18d)][_0x40ad51(0x161)](_0x10fccd=>{var _0x911a25=_0x40ad51;_0x10fccd['product_name']==_0x4b3b0d['product_name']&&_0x10fccd['bay']==_0x4b3b0d[_0x911a25(0x158)]&&_0x10fccd[_0x911a25(0x1dc)]==_0x4b3b0d[_0x911a25(0x1dc)]&&_0x10fccd[_0x911a25(0x1b1)]==_0x4b3b0d['production_date']&&_0x10fccd['batch_code']==_0x4b3b0d[_0x911a25(0x214)]&&_0x10fccd[_0x911a25(0x1ec)]==_0x4b3b0d[_0x911a25(0x18e)]&&(typeof _0x4b3b0d[_0x911a25(0x1a2)]=='undefined'?(console[_0x911a25(0x1bc)](_0x911a25(0x1a9),_0x10fccd[_0x911a25(0x19a)]+_0x911a25(0x1c1)+_0x10fccd[_0x911a25(0x1d5)]+_0x911a25(0x1f4)+Math['abs'](_0x10fccd[_0x911a25(0x19a)])+Math[_0x911a25(0x1c7)](_0x4b3b0d[_0x911a25(0x204)])),_0x10fccd[_0x911a25(0x19a)]=Math[_0x911a25(0x1c7)](_0x10fccd['product_stock'])+Math[_0x911a25(0x1c7)](_0x4b3b0d[_0x911a25(0x204)])):_0x10fccd[_0x911a25(0x19a)]=Math['abs'](_0x10fccd[_0x911a25(0x19a)])+Math[_0x911a25(0x1c7)](_0x4b3b0d[_0x911a25(0x204)]),_0x513203++);});_0x513203=='0'&&(_0x7c7650[_0x40ad51(0x18d)]=_0x7c7650[_0x40ad51(0x18d)]['concat']({'product_name':_0x4b3b0d['product_name'],'product_stock':_0x4b3b0d[_0x40ad51(0x204)],'bay':_0x4b3b0d[_0x40ad51(0x158)],'product_code':_0x4b3b0d[_0x40ad51(0x155)],'primary_code':_0x4b3b0d[_0x40ad51(0x15e)],'secondary_code':_0x4b3b0d[_0x40ad51(0x1f0)],'expiry_date':_0x4b3b0d[_0x40ad51(0x1dc)],'production_date':_0x4b3b0d[_0x40ad51(0x1b1)],'maxProducts':_0x4b3b0d[_0x40ad51(0x228)],'batch_code':_0x4b3b0d['batch_code'],'secondary_unit':_0x4b3b0d[_0x40ad51(0x1a5)],'unit':_0x4b3b0d[_0x40ad51(0x1d9)],'maxProducts':_0x4b3b0d[_0x40ad51(0x228)],'maxPerUnit':_0x4b3b0d[_0x40ad51(0x178)],'invoice':_0x4b3b0d[_0x40ad51(0x18e)]}));}return _0x7c7650;});Promise[_0x5c373c(0x188)](_0x49df1a)[_0x5c373c(0x14f)](async _0xa7ca4e=>{var _0x6c3130=_0x5c373c;try{for(const _0x427fd1 of _0xa7ca4e){await warehouse[_0x6c3130(0x216)]({'_id':_0x427fd1[_0x6c3130(0x1d5)]},{'$addToSet':{'product_details':{'$each':_0x427fd1[_0x6c3130(0x18d)]}}});}_0x1dc603[_0x6c3130(0x16b)]=_0x6c3130(0x1f1);const _0xed9ecd=await _0x1dc603[_0x6c3130(0x193)](),_0x52a735=await master_shop[_0x6c3130(0x191)](),_0x51dbfe=await email_settings[_0x6c3130(0x1b6)](),_0x5b1239=await supervisor_settings[_0x6c3130(0x191)]();var _0x3691c8=_0x1dc603['product'],_0x4d3236='',_0x10c331;for(_0x10c331 in _0x3691c8){var _0x295d2e='FG';_0x1dc603[_0x6c3130(0x1a1)]==_0x6c3130(0x1e0)&&(_0x295d2e='DG'),_0x4d3236+=_0x6c3130(0x15a)+_0x6c3130(0x213)+_0x3691c8[_0x10c331][_0x6c3130(0x1ac)]+_0x6c3130(0x1fa)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3691c8[_0x10c331][_0x6c3130(0x155)]+_0x6c3130(0x1fa)+_0x6c3130(0x213)+_0x3691c8[_0x10c331][_0x6c3130(0x204)]+_0x6c3130(0x1fa)+_0x6c3130(0x213)+_0x3691c8[_0x10c331][_0x6c3130(0x1d9)]+'</td>'+_0x6c3130(0x213)+_0x3691c8[_0x10c331][_0x6c3130(0x1a5)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x1dc603['to_warehouse']+_0x6c3130(0x1fa)+_0x6c3130(0x213)+_0x3691c8[_0x10c331][_0x6c3130(0x21d)]+_0x6c3130(0x1fa)+_0x6c3130(0x213)+_0x295d2e+_0x3691c8[_0x10c331]['to_bay']+'</td>'+_0x6c3130(0x1bb);}let _0x2d0b92=nodemailer[_0x6c3130(0x172)]({'host':_0x51dbfe[_0x6c3130(0x17d)],'port':Number(_0x51dbfe[_0x6c3130(0x18a)]),'secure':![],'auth':{'user':_0x51dbfe[_0x6c3130(0x220)],'pass':_0x51dbfe['password']}}),_0x3868cd={'from':_0x51dbfe[_0x6c3130(0x220)],'to':_0x5b1239[0x0][_0x6c3130(0x175)],'subject':_0x6c3130(0x1e4),'attachments':[{'filename':_0x6c3130(0x1e6),'path':__dirname+_0x6c3130(0x153)+_0x6c3130(0x1ff)+_0x52a735[0x0]['image'],'cid':_0x6c3130(0x1c2)}],'html':_0x6c3130(0x183)+_0x6c3130(0x20b)+'</head><body>'+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x6c3130(0x218)+_0x6c3130(0x1c5)+'</div>'+_0x6c3130(0x218)+_0x6c3130(0x1b3)+_0x52a735[0x0][_0x6c3130(0x1ae)]+_0x6c3130(0x207)+'</div>'+'</div>'+_0x6c3130(0x1f2)+'<div>'+_0x6c3130(0x163)+_0x6c3130(0x16c)+_0x1dc603[_0x6c3130(0x1ec)]+'\x20'+_0x6c3130(0x1d7)+_0x6c3130(0x203)+_0x1dc603[_0x6c3130(0x230)]+'\x20'+_0x6c3130(0x195)+_0x6c3130(0x1da)+_0x6c3130(0x180)+_0x6c3130(0x1fe)+_0x6c3130(0x181)+_0x6c3130(0x15a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x6c3130(0x1df)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x6c3130(0x173)+_0x6c3130(0x1f7)+_0x6c3130(0x17b)+_0x6c3130(0x1fb)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x6c3130(0x1bb)+'</thead>'+_0x6c3130(0x208)+'\x20'+_0x4d3236+'\x20'+_0x6c3130(0x17c)+_0x6c3130(0x221)+_0x6c3130(0x218)+_0x6c3130(0x1a3)+_0x6c3130(0x1fd)+_0x52a735[0x0][_0x6c3130(0x1ae)]+_0x6c3130(0x1da)+'</div>'+'</div>'+_0x6c3130(0x15d)};_0x2d0b92[_0x6c3130(0x160)](_0x3868cd,function(_0x30ac91,_0x4de430){var _0x40b022=_0x6c3130;_0x30ac91?(console[_0x40b022(0x1bc)](_0x30ac91),console[_0x40b022(0x1bc)](_0x40b022(0x168))):console['log'](_0x40b022(0x1b0));}),_0x12e4db[_0x6c3130(0x1f6)]('success',_0x6c3130(0x222)),_0x1aa8be[_0x6c3130(0x176)](_0x6c3130(0x1b9)+_0xed9ecd[_0x6c3130(0x1d5)]);}catch(_0x399020){console[_0x6c3130(0x152)](_0x399020),_0x1aa8be['status'](0x1f4)[_0x6c3130(0x20a)]({'error':_0x6c3130(0x1a8)});}})[_0x5c373c(0x1c0)](_0x559059=>{var _0x5c064a=_0x5c373c;console[_0x5c064a(0x152)](_0x559059),_0x1aa8be['status'](0x1f4)[_0x5c064a(0x20a)]({'error':_0x5c064a(0x1af)});});}catch(_0x3261b7){console['error'](_0x3261b7),_0x1aa8be[_0x5c373c(0x150)](0x1f4)[_0x5c373c(0x20a)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x813e1e(0x1c0)](_0x2ac5e5=>{var _0x4cfe15=_0x813e1e;console['error'](_0x2ac5e5),_0x1aa8be[_0x4cfe15(0x150)](0x1f4)[_0x4cfe15(0x20a)]({'error':'An\x20error\x20occurred.'});});}catch(_0x432fd8){_0x1aa8be[_0x813e1e(0x20a)]({'message':_0x432fd8[_0x813e1e(0x1ed)]});}});function a0_0x3137(){var _0x288146=['<h5\x20style=\x22text-align:\x20left;\x22>','back','German','$product_details.secondary_unit','language','Error\x20Occurs','MaxStocks_data','$name','finalize','\x20Order\x20Number\x20:\x20','success','5315408PUxHNc','$product_details.expiry_date','edit_transfer_finished_view','to_prod_level','createTransport','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','to_invoice','FGSEmail','redirect','prod_name','maxPerUnit','getFullYear','add_transfer_finished','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</tbody>','host','user','from_prod_qty','</div>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Enclosed','<!DOCTYPE\x20html>','$product_details.pallet','2520210gCqwIR','product_code3','getMonth','all','body','port','/transfer_finished/view','7357zCqpvr','product_details','To_invoice','$product_details.product_code','Rack\x201','find','$product_details.primary_code','save','bay','</span>','edit_transfer_finished','$product_details.storage','render','QA\x20Warehouse','product_stock','English','Finished\x20Goods','params','TRFF-','from_quantity','aggregate','to_warehouse','id_transaction','<strong>\x20Regards\x20</strong>','/view','secondary_unit','../models/all_models','prod_cat','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','here2','from_warehouse','from_invoice','product_name','/view/:id','site_title','An\x20error\x20occurred.','Email\x20sent\x20successfully','production_date','product_date','<h2>\x20','27806pmjEKY','role','findOne','product','from_room_name','/picking_list/PDF_transfer/','string','</tr>','log','to_prod_qty','79020OnlCTA','$room','catch','\x20<>\x20','logo','$product_details.bay','43ZsBejh','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.maxPerUnit','abs','staff','transfer_finished','from_bay','post','$product_details.product_name','exports','New_Qty_Converted','from_prod_level','$_id','Arabic\x20(ae)','Portuguese\x20(BR)','express','length','_id','errors','<span\x20style=\x22float:\x20right;\x22>','undefined','unit','</h5>','findById','expiry_date','/barcode_scanner2','French','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','DRY\x20GOODS','$product_details.secondary_code','Spanish','$product_details.product_stock','Transfer\x20Mail','$to_warehouse','Logo.png','MaxStocks_data2','split','../middleware/auth','/view/add_transfer','/barcode_scanner','invoice','message','Chinese','get','secondary_code','True','<hr\x20class=\x22my-3\x22>','$product_details.level','\x20<=>\x20','to_floorlevel','flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','English\x20(US)','5014394GXyHEu','</td>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.production_date','<h5>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/upload/','$product_details._id','ToRoomAssigned','max','\x20Order\x20Date\x20:\x20','to_quantity','$product_details.maxProducts','slice','\x20</h2>','<tbody\x20style=\x22text-align:\x20center;\x22>','padStart','json','<html><head><title></title>','$product_details.rack','$product_details.bin','Enabled','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.floorlevel','$product_details.type','primary_unit','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','batch_code','$product_details.batch_code','updateOne','FROZEN\x20GOODS','<div>','push','from_room','$invoice','warehouse','to_room_name','Arabic','$product.from_room_name','email','</table>','Transfer\x20Finalize\x20Successfully','Hindi','to_room','note','2394rZiLlM','forEach','maxProducts','Ambient','Rack\x202','305HNZYLJ','here1','/preview/:id','$product.to_room_name','filter','date','$product_details.unit','$date','then','status','nodemailer','error','/../public','floor','product_code','$product_details','concat','to_bay','$product_details.invoice','<tr>','963zJRxCz','26012diawsh','</body></html>','primary_code','Portuguese','sendMail','map','36kSumfk'];a0_0x3137=function(){return _0x288146;};return a0_0x3137();}function BayBinSelected(_0x42934a,_0x354139){var _0x2f9a9e=a0_0x4ac7b0,_0x35ad69=[];let _0x5beacf=[];var _0x5932fa=[];if(_0x42934a==_0x2f9a9e(0x1e0)){switch(_0x354139){case _0x2f9a9e(0x190):_0x35ad69=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x2f9a9e(0x22a):_0x35ad69=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x5932fa=['DG'];}else{if(_0x42934a==_0x2f9a9e(0x217)){switch(_0x354139){case _0x2f9a9e(0x190):_0x35ad69=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x35ad69=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x5932fa=['FG'];}}return{'levels':_0x35ad69,'identify':_0x5932fa};}router[a0_0x4ac7b0(0x1ef)](a0_0x4ac7b0(0x1ad),auth,async(_0x516d59,_0xb7e973)=>{var _0xd8b2e1=a0_0x4ac7b0;try{const {username:_0x1a36c6,email:_0x14a325,role:_0x2db889}=_0x516d59[_0xd8b2e1(0x17e)],_0x3347a2=_0x516d59[_0xd8b2e1(0x17e)],_0x528439=await profile[_0xd8b2e1(0x1b6)]({'email':_0x3347a2['email']}),_0x1e4e51=await master_shop[_0xd8b2e1(0x191)](),_0x50e857=await transfers_finished[_0xd8b2e1(0x1db)](_0x516d59['params']['id']);let _0x99e378=new Date(_0x50e857['expiry_date']),_0x352bb3=('0'+_0x99e378['getDate']())[_0xd8b2e1(0x206)](-0x2),_0x1838ae=('0'+(_0x99e378[_0xd8b2e1(0x187)]()+0x1))[_0xd8b2e1(0x206)](-0x2),_0x5af610=_0x99e378[_0xd8b2e1(0x179)](),_0x2b76b0=_0x5af610+'-'+_0x1838ae+'-'+_0x352bb3,_0x196250;if(_0x3347a2['role']=='staff'){const _0x413103=await staff[_0xd8b2e1(0x1b6)]({'email':_0x3347a2[_0xd8b2e1(0x220)]});_0x196250=await warehouse[_0xd8b2e1(0x191)]({'status':_0xd8b2e1(0x20e),'name':_0x413103[_0xd8b2e1(0x21c)],'warehouse_category':_0xd8b2e1(0x19c)});}else _0x196250=await warehouse[_0xd8b2e1(0x191)]({'status':_0xd8b2e1(0x20e),'warehouse_category':_0xd8b2e1(0x19c)});const _0x476173=await warehouse[_0xd8b2e1(0x1a0)]([{'$match':{'name':_0x50e857[_0xd8b2e1(0x1aa)],'room':_0x50e857[_0xd8b2e1(0x21a)]}},{'$unwind':_0xd8b2e1(0x156)},{'$group':{'_id':'$product_details._id','name':{'$first':_0xd8b2e1(0x1cc)},'product_stock':{'$first':_0xd8b2e1(0x1e3)},'bay':{'$first':_0xd8b2e1(0x1c3)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0xd8b2e1(0x211)},'floorlevel':{'$first':_0xd8b2e1(0x210)},'primary_code':{'$first':_0xd8b2e1(0x192)},'secondary_code':{'$first':_0xd8b2e1(0x1e1)},'product_code':{'$first':_0xd8b2e1(0x18f)},'storage':{'$first':_0xd8b2e1(0x197)},'rack':{'$first':'$product_details.rack'}}}]);var _0x22fcbc=[0x1,0x2,0x3,0x4],_0x42934e=['A','B','C','D','E','F','G','H','I','J'],_0x465f1e=[_0xd8b2e1(0x229),_0xd8b2e1(0x182)];const _0x14af9a=await product[_0xd8b2e1(0x191)]({}),_0x4b92bc=BayBinSelected(_0x50e857[_0xd8b2e1(0x1a1)],_0x50e857[_0xd8b2e1(0x224)]);if(_0x1e4e51[0x0][_0xd8b2e1(0x167)]==_0xd8b2e1(0x1f8)){var _0x5c85ba=users[_0xd8b2e1(0x19b)];console[_0xd8b2e1(0x1bc)](_0x5c85ba);}else{if(_0x1e4e51[0x0]['language']=='Hindi')var _0x5c85ba=users[_0xd8b2e1(0x223)];else{if(_0x1e4e51[0x0][_0xd8b2e1(0x167)]=='German')var _0x5c85ba=users['German'];else{if(_0x1e4e51[0x0][_0xd8b2e1(0x167)]==_0xd8b2e1(0x1e2))var _0x5c85ba=users[_0xd8b2e1(0x1e2)];else{if(_0x1e4e51[0x0][_0xd8b2e1(0x167)]==_0xd8b2e1(0x1de))var _0x5c85ba=users[_0xd8b2e1(0x1de)];else{if(_0x1e4e51[0x0][_0xd8b2e1(0x167)]==_0xd8b2e1(0x1d2))var _0x5c85ba=users[_0xd8b2e1(0x15f)];else{if(_0x1e4e51[0x0][_0xd8b2e1(0x167)]==_0xd8b2e1(0x1ee))var _0x5c85ba=users[_0xd8b2e1(0x1ee)];else{if(_0x1e4e51[0x0][_0xd8b2e1(0x167)]==_0xd8b2e1(0x1d1))var _0x5c85ba=users[_0xd8b2e1(0x21e)];}}}}}}}_0xb7e973['render'](_0xd8b2e1(0x196),{'success':_0x516d59['flash'](_0xd8b2e1(0x16d)),'errors':_0x516d59[_0xd8b2e1(0x1f6)](_0xd8b2e1(0x1d6)),'role':_0x3347a2,'profile':_0x528439,'master_shop':_0x1e4e51,'warehouse':_0x196250,'transfer':_0x50e857,'stock':_0x476173,'unit':_0x14af9a,'language':_0x5c85ba,'levels':_0x22fcbc,'Isle':_0x42934e,'rooms_data':_0x465f1e,'ed_fullDate':_0x2b76b0,'dataSelected':_0x4b92bc});}catch(_0x724b3a){console[_0xd8b2e1(0x1bc)](_0x724b3a);}}),router['post'](a0_0x4ac7b0(0x1ad),auth,async(_0x6f5295,_0x136f31)=>{var _0x27228b=a0_0x4ac7b0;try{const _0x219d3=_0x6f5295[_0x27228b(0x19d)]['id'];console[_0x27228b(0x1bc)](_0x6f5295[_0x27228b(0x189)]);const _0x414bbf=await transfers_finished[_0x27228b(0x1db)](_0x219d3);console['log']('transfer_data',_0x414bbf);const {date:_0x4d28e2,from_warehouse:_0x1e2720,FromRoom_name:_0x4708ac,to_warehouse:_0x346f1f,ToRoom_name:_0x3fc7a1,prod_name:_0x336ad5,from_prod_qty:_0x2ff819,from_prod_level:_0x245911,from_prod_isle:_0x26ab77,from_prod_pallet:_0x122925,to_prod_qty:_0x2785fd,to_prod_level:_0x3c9245,to_prod_isle:_0x4b770d,to_prod_pallet:_0x21c5bc,primary_code:_0x2e7981,secondary_code:_0x16efe6,product_code3:_0x3edc7c,note:_0x229540,invoice:_0x5e5d08,expiry_date:_0x1b0f51}=_0x6f5295[_0x27228b(0x189)];if(typeof _0x336ad5==_0x27228b(0x1ba))var _0x444a52=[_0x6f5295[_0x27228b(0x189)]['prod_name']],_0x3b4511=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x17f)]],_0x2817a7=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x1cf)]],_0x5f5b73=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x1bd)]],_0x282f08=[_0x6f5295[_0x27228b(0x189)]['to_prod_level']],_0x3f7d3e=[_0x6f5295['body']['primary_code']],_0x5b0e36=[_0x6f5295['body'][_0x27228b(0x1f0)]],_0x1db1d0=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x186)]],_0x486168=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x1e7)]],_0x1aa2fe=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x1d9)]],_0x31925b=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x1a5)]],_0x5b40e3=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x214)]],_0x163e71=[_0x6f5295[_0x27228b(0x189)][_0x27228b(0x1dc)]];else var _0x444a52=[..._0x6f5295['body']['prod_name']],_0x3b4511=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x17f)]],_0x2817a7=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x1cf)]],_0x5f5b73=[..._0x6f5295['body']['to_prod_qty']],_0x282f08=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x171)]],_0x3f7d3e=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x15e)]],_0x5b0e36=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x1f0)]],_0x1db1d0=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x186)]],_0x486168=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x1e7)]],_0x1aa2fe=[..._0x6f5295[_0x27228b(0x189)]['unit']],_0x31925b=[..._0x6f5295['body'][_0x27228b(0x1a5)]],_0x5b40e3=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x214)]],_0x163e71=[..._0x6f5295[_0x27228b(0x189)][_0x27228b(0x1dc)]];const _0x46f640=_0x444a52[_0x27228b(0x161)](_0x4e0adb=>{return _0x4e0adb={'product_name':_0x4e0adb};});_0x3b4511[_0x27228b(0x227)]((_0x287829,_0x1777bb)=>{var _0x3a56cc=_0x27228b;_0x46f640[_0x1777bb][_0x3a56cc(0x19f)]=_0x287829;}),_0x2817a7[_0x27228b(0x227)]((_0x53444e,_0x423381)=>{var _0x1b02a6=_0x27228b;_0x46f640[_0x423381][_0x1b02a6(0x1ca)]=_0x53444e;}),_0x5f5b73[_0x27228b(0x227)]((_0x5f1b20,_0x53dc5b)=>{var _0x4dad2e=_0x27228b;_0x46f640[_0x53dc5b][_0x4dad2e(0x204)]=_0x5f1b20;}),_0x282f08[_0x27228b(0x227)]((_0x5461a8,_0x22fbf5)=>{_0x46f640[_0x22fbf5]['to_bay']=_0x5461a8;}),_0x3f7d3e[_0x27228b(0x227)]((_0x108af2,_0x2f0e8b)=>{var _0x31644d=_0x27228b;_0x46f640[_0x2f0e8b][_0x31644d(0x15e)]=_0x108af2;}),_0x5b0e36[_0x27228b(0x227)]((_0x29e61e,_0x3bd6b8)=>{_0x46f640[_0x3bd6b8]['secondary_code']=_0x29e61e;}),_0x1db1d0[_0x27228b(0x227)]((_0x524021,_0x240771)=>{var _0x421553=_0x27228b;_0x46f640[_0x240771][_0x421553(0x155)]=_0x524021;}),_0x486168[_0x27228b(0x227)]((_0x5f3868,_0x57cedd)=>{var _0x2cc1f6=_0x27228b;_0x46f640[_0x57cedd][_0x2cc1f6(0x228)]=_0x5f3868;}),_0x1aa2fe[_0x27228b(0x227)]((_0x11ca4e,_0x3f1226)=>{var _0x5d4c4e=_0x27228b;_0x46f640[_0x3f1226][_0x5d4c4e(0x1d9)]=_0x11ca4e;}),_0x31925b[_0x27228b(0x227)]((_0x6b700,_0x474e94)=>{var _0x2d8b93=_0x27228b;_0x46f640[_0x474e94][_0x2d8b93(0x1a5)]=_0x6b700;}),_0x5b40e3[_0x27228b(0x227)]((_0x10464b,_0x2eb38f)=>{_0x46f640[_0x2eb38f]['batch_code']=_0x10464b;}),_0x163e71[_0x27228b(0x227)]((_0xed2d7a,_0x159e38)=>{var _0x5ede01=_0x27228b;_0x46f640[_0x159e38][_0x5ede01(0x1dc)]=_0xed2d7a;});const _0x146b53=_0x46f640[_0x27228b(0x22f)](_0x3417c6=>_0x3417c6[_0x27228b(0x204)]!=='0'&&_0x3417c6['to_quantity']!==''||_0x3417c6['to_floorlevel']!=='0'&&_0x3417c6[_0x27228b(0x1f5)]!=='');var _0x19e570=0x0;_0x146b53[_0x27228b(0x227)](_0x300566=>{var _0x300cdc=_0x27228b;parseInt(_0x300566[_0x300cdc(0x19f)])<parseInt(_0x300566[_0x300cdc(0x204)])&&_0x19e570++;});if(_0x19e570!=0x0)return _0x6f5295[_0x27228b(0x1f6)]('errors',_0x27228b(0x20f)),_0x136f31[_0x27228b(0x176)](_0x27228b(0x164));const _0x3bf572=await warehouse['findOne']({'name':_0x414bbf[_0x27228b(0x1aa)],'room':_0x414bbf['from_room']});_0x414bbf[_0x27228b(0x1b7)][_0x27228b(0x227)](_0x531c8e=>{var _0x469819=_0x27228b;if(_0x531c8e['to_quantity']>0x0){const _0x261dbd=_0x3bf572[_0x469819(0x18d)][_0x469819(0x161)](_0x5957a4=>{var _0x54665f=_0x469819;_0x5957a4[_0x54665f(0x1ac)]==_0x531c8e[_0x54665f(0x1ac)]&&_0x5957a4['bay']==_0x531c8e[_0x54665f(0x1ca)]&&(_0x5957a4['product_stock']=parseInt(_0x5957a4[_0x54665f(0x19a)])+parseInt(_0x531c8e['to_quantity']));});}}),await _0x3bf572[_0x27228b(0x193)]();const _0x2390b5=await warehouse[_0x27228b(0x1b6)]({'name':_0x414bbf['to_warehouse'],'room':_0x414bbf[_0x27228b(0x224)]});_0x414bbf[_0x27228b(0x1b7)][_0x27228b(0x227)](_0x50c2ca=>{var _0x39db18=_0x27228b;if(_0x50c2ca[_0x39db18(0x204)]>0x0){const _0x41d8b5=_0x2390b5['product_details'][_0x39db18(0x161)](_0x4a9758=>{var _0x2838e1=_0x39db18;_0x4a9758[_0x2838e1(0x1ac)]==_0x50c2ca[_0x2838e1(0x1ac)]&&_0x4a9758[_0x2838e1(0x194)]==_0x50c2ca[_0x2838e1(0x158)]&&(_0x4a9758['product_stock']=parseInt(_0x4a9758[_0x2838e1(0x19a)])-parseInt(_0x50c2ca[_0x2838e1(0x204)]));});}}),await _0x2390b5[_0x27228b(0x193)](),_0x414bbf[_0x27228b(0x230)]=_0x4d28e2,_0x414bbf[_0x27228b(0x1aa)]=_0x1e2720,_0x414bbf[_0x27228b(0x1a1)]=_0x346f1f,_0x414bbf[_0x27228b(0x1b7)]=_0x146b53,_0x414bbf[_0x27228b(0x225)]=_0x229540,_0x414bbf[_0x27228b(0x1ec)]=_0x5e5d08;const _0x1d8eca=await _0x414bbf['save'](),_0x5066e4=await warehouse[_0x27228b(0x1b6)]({'name':_0x1e2720,'room':_0x4708ac});_0x1d8eca['product']['forEach'](_0x1fc466=>{var _0x6020a7=_0x27228b;if(_0x1fc466[_0x6020a7(0x204)]>0x0){const _0x3649cf=_0x5066e4[_0x6020a7(0x18d)][_0x6020a7(0x161)](_0xa8b016=>{var _0x3bf353=_0x6020a7;_0xa8b016[_0x3bf353(0x1ac)]==_0x1fc466[_0x3bf353(0x1ac)]&&_0xa8b016[_0x3bf353(0x194)]==_0x1fc466['from_bay']&&(_0xa8b016[_0x3bf353(0x19a)]=parseInt(_0xa8b016[_0x3bf353(0x19a)])-parseInt(_0x1fc466[_0x3bf353(0x204)]));});}}),await _0x5066e4[_0x27228b(0x193)]();const _0x2a4533=await warehouse[_0x27228b(0x1b6)]({'name':_0x346f1f,'room':_0x3fc7a1});_0x1d8eca[_0x27228b(0x1b7)][_0x27228b(0x227)](_0x5eec3c=>{var _0x5a0e3f=_0x27228b;if(_0x5eec3c['to_quantity']>0x0){var _0x157ed7=0x0;const _0x3f4f68=_0x2a4533['product_details'][_0x5a0e3f(0x161)](_0x2acb05=>{var _0x3a4b7a=_0x5a0e3f;_0x2acb05[_0x3a4b7a(0x1ac)]==_0x5eec3c[_0x3a4b7a(0x1ac)]&&_0x2acb05[_0x3a4b7a(0x194)]==_0x5eec3c[_0x3a4b7a(0x158)]&&(_0x2acb05['product_stock']=parseInt(_0x2acb05['product_stock'])+parseInt(_0x5eec3c[_0x3a4b7a(0x204)]),_0x157ed7++);});_0x157ed7=='0'&&(_0x2a4533[_0x5a0e3f(0x18d)]=_0x2a4533[_0x5a0e3f(0x18d)][_0x5a0e3f(0x157)]({'product_name':_0x5eec3c[_0x5a0e3f(0x1ac)],'product_stock':_0x5eec3c[_0x5a0e3f(0x204)],'bay':_0x5eec3c[_0x5a0e3f(0x158)],'product_code':_0x5eec3c[_0x5a0e3f(0x155)],'primary_code':_0x5eec3c['primary_code'],'secondary_code':_0x5eec3c['secondary_code'],'maxProducts':_0x5eec3c[_0x5a0e3f(0x228)]}));}}),await _0x2a4533[_0x27228b(0x193)](),_0x6f5295[_0x27228b(0x1f6)](_0x27228b(0x16d),'Transfer\x20Edit\x20Successfully'),_0x136f31[_0x27228b(0x176)](_0x27228b(0x18b));}catch(_0x4d5971){console[_0x27228b(0x1bc)](_0x4d5971);}}),router[a0_0x4ac7b0(0x1cb)](a0_0x4ac7b0(0x1eb),async(_0x1568fa,_0x3fae5e)=>{var _0x596710=a0_0x4ac7b0;const {FromWareHouse:_0x20a810,FromRoom:_0x52e368,ToWarehouse:_0xcfda03,ToRoom:_0x5d9ce8,primary_code:_0x4cfe72,Roomslist:_0x1b48c7}=_0x1568fa[_0x596710(0x189)],_0x608af4=_0x1b48c7[_0x596710(0x1e8)](','),_0x18a03d=[];async function _0xd20522(_0x595a13){var _0x46894e=_0x596710;const _0x26f78d=await warehouse[_0x46894e(0x1a0)]([{'$match':{'name':_0x20a810,'room':_0x595a13}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x4cfe72}},{'$group':{'_id':_0x46894e(0x200),'name':{'$first':_0x46894e(0x1cc)},'instock':{'$first':_0x46894e(0x1e3)},'primary_code':{'$first':_0x46894e(0x192)},'secondary_code':{'$first':_0x46894e(0x1e1)},'product_code':{'$first':_0x46894e(0x18f)},'level':{'$first':_0x46894e(0x1c3)},'isle':{'$first':_0x46894e(0x20d)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x46894e(0x197)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x46894e(0x16f)},'production_date':{'$first':_0x46894e(0x1fc)},'batch_code':{'$first':_0x46894e(0x215)},'maxPerUnit':{'$first':_0x46894e(0x1c6)},'roomNamed':{'$first':_0x46894e(0x1bf)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x46894e(0x159)}}}]),_0x274459=await warehouse[_0x46894e(0x1a0)]([{'$match':{'name':_0x20a810,'room':_0x595a13}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x4cfe72}},{'$group':{'_id':_0x46894e(0x200),'name':{'$first':_0x46894e(0x1cc)},'instock':{'$first':_0x46894e(0x1e3)},'primary_code':{'$first':_0x46894e(0x192)},'secondary_code':{'$first':_0x46894e(0x1e1)},'product_code':{'$first':_0x46894e(0x18f)},'level':{'$first':_0x46894e(0x1c3)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x46894e(0x211)},'pallet':{'$first':_0x46894e(0x210)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x46894e(0x166)},'storage':{'$first':_0x46894e(0x197)},'rack':{'$first':_0x46894e(0x20c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x46894e(0x1fc)},'batch_code':{'$first':_0x46894e(0x215)},'maxPerUnit':{'$first':_0x46894e(0x1c6)},'roomNamed':{'$first':_0x46894e(0x1bf)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x46894e(0x159)}}}]);if(_0x26f78d[_0x46894e(0x1d4)]>0x0)_0x18a03d[_0x46894e(0x219)](_0x26f78d);else _0x274459[_0x46894e(0x1d4)]>0x0&&_0x18a03d['push'](_0x274459);}const _0x47e6a5=_0x608af4['map'](_0x57c89d=>_0xd20522(_0x57c89d));await Promise[_0x596710(0x188)](_0x47e6a5),_0x3fae5e[_0x596710(0x20a)](_0x18a03d);}),router[a0_0x4ac7b0(0x1cb)](a0_0x4ac7b0(0x1dd),async(_0x345455,_0x13a92b)=>{var _0x4f1dbd=a0_0x4ac7b0;try{const {FromWareHouse:_0x54d278,FromRoom:_0x40df71,ToWarehouse:_0x161f0a,ToRoom:_0x23f39a,secondary_code:_0x5b579c}=_0x345455[_0x4f1dbd(0x189)],_0x180ac7=await warehouse[_0x4f1dbd(0x1a0)]([{'$match':{'name':_0x54d278}},{'$unwind':_0x4f1dbd(0x156)},{'$match':{'product_details.secondary_code':_0x5b579c}},{'$group':{'_id':_0x4f1dbd(0x200),'name':{'$first':_0x4f1dbd(0x1cc)},'primary_code':{'$first':_0x4f1dbd(0x192)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x4f1dbd(0x16a)},'level':{'$first':_0x4f1dbd(0x1f3)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x4f1dbd(0x184)},'maxProducts':{'$first':_0x4f1dbd(0x205)},'unit':{'$first':_0x4f1dbd(0x14d)},'expiry_date':{'$first':_0x4f1dbd(0x16f)},'production_date':{'$first':'$product_details.production_date'}}}]);_0x13a92b[_0x4f1dbd(0x150)](0xc8)[_0x4f1dbd(0x20a)](_0x180ac7);}catch(_0x2f56ce){_0x13a92b[_0x4f1dbd(0x150)](0x194)['json']({'message':_0x2f56ce[_0x4f1dbd(0x1ed)]});}}),router[a0_0x4ac7b0(0x1cb)]('/barcode_scanner3',async(_0x12cf03,_0x1c26f7)=>{var _0x4296f2=a0_0x4ac7b0;try{const {FromWareHouse:_0x58541c,FromRoom:_0x359174,ToWarehouse:_0x238355,ToRoom:_0x1f1690,product_code:_0x341817}=_0x12cf03[_0x4296f2(0x189)],_0x3327ae=await warehouse[_0x4296f2(0x1a0)]([{'$match':{'name':_0x58541c}},{'$unwind':_0x4296f2(0x156)},{'$match':{'product_details.product_code':_0x341817}},{'$group':{'_id':_0x4296f2(0x200),'name':{'$first':_0x4296f2(0x1cc)},'primary_code':{'$first':_0x4296f2(0x192)},'secondary_code':{'$first':_0x4296f2(0x1e1)},'product_code':{'$first':_0x4296f2(0x18f)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x4296f2(0x16a)},'level':{'$first':_0x4296f2(0x1f3)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x4296f2(0x184)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x4296f2(0x14d)}}}]);_0x1c26f7[_0x4296f2(0x150)](0xc8)[_0x4296f2(0x20a)](_0x3327ae);}catch(_0x42f684){_0x1c26f7[_0x4296f2(0x150)](0x194)[_0x4296f2(0x20a)]({'message':_0x42f684[_0x4296f2(0x1ed)]});}}),router[a0_0x4ac7b0(0x1cb)]('/CheckingWarehouse',async(_0x111627,_0x328319)=>{var _0x3fd652=a0_0x4ac7b0;const {productCode:_0x492f30,bay:_0x4b1310,warehouses:_0x525d1d,room:_0x60b7e4}=_0x111627['body'];console['log'](_0x111627[_0x3fd652(0x189)]);try{const _0x23aaed=await warehouse[_0x3fd652(0x1a0)]([{'$match':{'name':_0x525d1d,'room':_0x60b7e4}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x4b1310)}},{'$group':{'_id':_0x3fd652(0x200),'name':{'$first':_0x3fd652(0x1cc)},'product_stock':{'$first':_0x3fd652(0x1e3)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x3fd652(0x205)}}}]);_0x328319['status'](0xc8)[_0x3fd652(0x20a)](_0x23aaed);}catch(_0x16a28d){_0x328319[_0x3fd652(0x150)](0x194)['json']({'message':_0x16a28d[_0x3fd652(0x1ed)]});}}),module[a0_0x4ac7b0(0x1cd)]=router;