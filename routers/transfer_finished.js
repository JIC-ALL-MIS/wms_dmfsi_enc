var a0_0x541f1f=a0_0x145c;(function(_0x35cbb7,_0xcb5138){var _0x47378d=a0_0x145c,_0x422b67=_0x35cbb7();while(!![]){try{var _0xf8f91c=-parseInt(_0x47378d(0x159))/0x1*(parseInt(_0x47378d(0xc3))/0x2)+parseInt(_0x47378d(0xa4))/0x3*(-parseInt(_0x47378d(0x13b))/0x4)+parseInt(_0x47378d(0xf3))/0x5*(parseInt(_0x47378d(0xb6))/0x6)+parseInt(_0x47378d(0xc5))/0x7+parseInt(_0x47378d(0x102))/0x8+-parseInt(_0x47378d(0xa3))/0x9+-parseInt(_0x47378d(0xfc))/0xa*(-parseInt(_0x47378d(0xfd))/0xb);if(_0xf8f91c===_0xcb5138)break;else _0x422b67['push'](_0x422b67['shift']());}catch(_0x3f2aa3){_0x422b67['push'](_0x422b67['shift']());}}}(a0_0x375d,0xbfc82));const express=require(a0_0x541f1f(0x137)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x541f1f(0x16f)),auth=require(a0_0x541f1f(0x158)),users=require(a0_0x541f1f(0xd0)),nodemailer=require(a0_0x541f1f(0x147));function a0_0x145c(_0x236f3a,_0x11d5a9){var _0x375dfe=a0_0x375d();return a0_0x145c=function(_0x145cc4,_0x4d3f25){_0x145cc4=_0x145cc4-0xa2;var _0x4fa35d=_0x375dfe[_0x145cc4];return _0x4fa35d;},a0_0x145c(_0x236f3a,_0x11d5a9);}router[a0_0x541f1f(0xd4)](a0_0x541f1f(0x10b),auth,async(_0xf6cb7d,_0x3b8fd6)=>{var _0x22b4a1=a0_0x541f1f;try{const {username:_0x38be6d,email:_0xec8f22,role:_0x14d8cd}=_0xf6cb7d[_0x22b4a1(0x135)],_0x528105=_0xf6cb7d[_0x22b4a1(0x135)],_0x43185a=await profile[_0x22b4a1(0x15a)]({'email':_0x528105[_0x22b4a1(0x17d)]}),_0x2f9f2a=await master_shop[_0x22b4a1(0x132)]();let _0x193fff;if(_0x528105[_0x22b4a1(0x128)]==_0x22b4a1(0x10e)){const _0x540561=await staff[_0x22b4a1(0x15a)]({'email':_0x528105[_0x22b4a1(0x17d)]});_0x193fff=await transfers_finished[_0x22b4a1(0x132)]({'from_warehouse':_0x540561[_0x22b4a1(0x130)]});}else _0x193fff=await transfers_finished[_0x22b4a1(0xcd)]([{'$unwind':_0x22b4a1(0xca)},{'$group':{'_id':_0x22b4a1(0x125),'invoice':{'$first':_0x22b4a1(0xc0)},'date':{'$first':_0x22b4a1(0xd5)},'from_warehouse':{'$first':_0x22b4a1(0x134)},'to_warehouse':{'$first':_0x22b4a1(0xa9)},'from_room_name':{'$addToSet':_0x22b4a1(0xf5)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2f9f2a[0x0][_0x22b4a1(0x101)]==_0x22b4a1(0xbe))var _0x46acaa=users[_0x22b4a1(0x17e)];else{if(_0x2f9f2a[0x0][_0x22b4a1(0x101)]==_0x22b4a1(0xee))var _0x46acaa=users['Hindi'];else{if(_0x2f9f2a[0x0]['language']==_0x22b4a1(0x175))var _0x46acaa=users['German'];else{if(_0x2f9f2a[0x0][_0x22b4a1(0x101)]==_0x22b4a1(0x108))var _0x46acaa=users['Spanish'];else{if(_0x2f9f2a[0x0][_0x22b4a1(0x101)]==_0x22b4a1(0xb0))var _0x46acaa=users[_0x22b4a1(0xb0)];else{if(_0x2f9f2a[0x0]['language']==_0x22b4a1(0xb3))var _0x46acaa=users[_0x22b4a1(0xc1)];else{if(_0x2f9f2a[0x0][_0x22b4a1(0x101)]=='Chinese')var _0x46acaa=users[_0x22b4a1(0x15d)];else{if(_0x2f9f2a[0x0][_0x22b4a1(0x101)]==_0x22b4a1(0x139))var _0x46acaa=users['Arabic'];}}}}}}}_0x3b8fd6['render'](_0x22b4a1(0xac),{'success':_0xf6cb7d['flash'](_0x22b4a1(0x10f)),'errors':_0xf6cb7d[_0x22b4a1(0xbf)]('errors'),'role':_0x528105,'profile':_0x43185a,'master_shop':_0x2f9f2a,'transfer':_0x193fff,'language':_0x46acaa});}catch(_0x2ab4e0){console[_0x22b4a1(0xb8)](_0x2ab4e0);}});function a0_0x375d(){var _0x19ea21=['from_bay','<tr>','from_prod_qty','/picking_list/PDF_transfer/','5488225kWVPsK','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','$product.from_room_name','$product_details.level','concat','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','unit','product','createTransport','34370XtYuiw','6721SySqQm','$product_details','bay','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','language','3717928lLDbOB','exports','note','edit_transfer_finished_view','render','updateOne','Spanish','maxPerUnit','/transfer/view','/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','Arabic','staff','success','getDate','host','/barcode_scanner3','FGSEmail','random','/upload/','floor','padStart','<div>','to_prod_qty','QA\x20Warehouse','from_quantity','password','/barcode_scanner2','To_invoice','$product_details.pallet','maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','RoomAssigned','errors','MaxStocks_data2','$_id','filter','</div>','role','<tbody\x20style=\x22text-align:\x20center;\x22>','toString','product_details','message','sendMail','/preview/:id','then','warehouse','$product_details.bin','find','<html><head><title></title>','$from_warehouse','user','prod_name','express','$product_details.bay','Arabic\x20(ae)','Ambient','133664GWrOnN','$product_details.maxProducts','to_bay','FROZEN\x20GOODS','/transfer_finished/preview/','$product_details.unit','image','/CheckingWarehouse','$product_details.storage','expiry_date','string','params','nodemailer','date','findById','$product_details.rack','$product_details.secondary_code','</table>','$product_details.floorlevel','/transfer_finished/view','forEach','True','Rack\x202','getMonth','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','logo','/view/:id','prod_cat','from_room','../middleware/auth','113137yHRgKu','findOne','$product_details.product_name','Logo.png','Chinese','An\x20error\x20occurred\x20while\x20saving\x20data.','getFullYear','from_invoice','There\x27s\x20a\x20error\x20in\x20this\x20transaction','$product_details.primary_code','to_floorlevel','production_date','secondary_code','ToRoomAssigned','$product_details.product_code','invoice','length','to_warehouse','$product_details.expiry_date','TRFF-','primary_code','</tr>','../models/all_models','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Product\x20Transfer\x20successfully','add_transfer_finished','from_room_name','German','batch_code','from_prod_level','MaxStocks_data','all','from_warehouse','primary_unit','product_date','email','English','edit_transfer_finished','$name','11861073JvKyZo','135OQdDou','New_Qty_Converted','Finished\x20Goods','finalize','to_room','$to_warehouse','save','$product_details._id','transfer_finished','$product_details.production_date','An\x20error\x20occurred.','to_prod_level','French','product_code3','json','Portuguese\x20(BR)','catch','</span>','6hmgkWi','$room','log','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','</td>','to_room_name','_id','Enabled','English\x20(US)','flash','$invoice','Portuguese','/view/add_transfer','2tyzoTA','post','405293YcPmLZ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','product_code','<h5>','slice','$product','product_name','\x20</h2>','aggregate','transfer_data','redirect','../public/language/languages.json','</h5>','</body></html>','to_invoice','get','$date','push','map','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.invoice','Rack\x201','Transfer\x20Mail','split','error','back','$product_details.isle','status','$product_details.batch_code','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','Transfer\x20Finalize\x20Successfully','</tbody>','$product_details.secondary_unit','<h2>\x20','site_title','body','secondary_unit','$product_details.type','\x20Order\x20Number\x20:\x20','to_quantity','Hindi'];a0_0x375d=function(){return _0x19ea21;};return a0_0x375d();}async function getRandom8DigitNumber(){var _0x54c267=a0_0x541f1f;const _0x43d3d0=0x989680,_0x40d7f0=0x5f5e0ff,_0x466c18=Math[_0x54c267(0x116)](Math[_0x54c267(0x114)]()*(_0x40d7f0-_0x43d3d0+0x1))+_0x43d3d0;var _0x241b26;const _0x10455b=await transfers_finished['findOne']({'invoice':_0x54c267(0x16c)+_0x466c18});return _0x10455b&&_0x10455b[_0x54c267(0x169)]>0x0?_0x241b26='TRFF-'+_0x466c18:_0x241b26=_0x54c267(0x16c)+_0x466c18,_0x241b26;}router[a0_0x541f1f(0xd4)](a0_0x541f1f(0xc2),auth,async(_0x2b3404,_0x34db0f)=>{var _0x5d5408=a0_0x541f1f;try{const {username:_0x4fe869,email:_0x457841,role:_0x4db9c5}=_0x2b3404['user'],_0x39fdbe=_0x2b3404[_0x5d5408(0x135)],_0x5f2a44=await profile['findOne']({'email':_0x39fdbe[_0x5d5408(0x17d)]}),_0x2f39f8=await master_shop['find']();let _0xb75efc;if(_0x39fdbe[_0x5d5408(0x128)]==_0x5d5408(0x10e)){const _0x413266=await staff[_0x5d5408(0x15a)]({'email':_0x39fdbe[_0x5d5408(0x17d)]});_0xb75efc=await warehouse[_0x5d5408(0xcd)]([{'$match':{'status':_0x5d5408(0xbd),'name':_0x413266[_0x5d5408(0x130)],'warehouse_category':_0x5d5408(0xa6),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0xb75efc=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':_0x5d5408(0xa6),'name':{'$ne':_0x5d5408(0x11a)}}},{'$group':{'_id':'$name','name':{'$first':_0x5d5408(0xa2)}}}]);const _0x345651=await transfers_finished[_0x5d5408(0x132)]({}),_0x1432fa=_0x345651[_0x5d5408(0x169)]+0x1,_0x1ae195='TRFF-'+_0x1432fa[_0x5d5408(0x12a)]()[_0x5d5408(0x117)](0x5,'0');if(_0x2f39f8[0x0][_0x5d5408(0x101)]=='English\x20(US)')var _0x548861=users[_0x5d5408(0x17e)];else{if(_0x2f39f8[0x0]['language']==_0x5d5408(0xee))var _0x548861=users[_0x5d5408(0xee)];else{if(_0x2f39f8[0x0]['language']==_0x5d5408(0x175))var _0x548861=users[_0x5d5408(0x175)];else{if(_0x2f39f8[0x0]['language']=='Spanish')var _0x548861=users[_0x5d5408(0x108)];else{if(_0x2f39f8[0x0][_0x5d5408(0x101)]==_0x5d5408(0xb0))var _0x548861=users[_0x5d5408(0xb0)];else{if(_0x2f39f8[0x0][_0x5d5408(0x101)]==_0x5d5408(0xb3))var _0x548861=users[_0x5d5408(0xc1)];else{if(_0x2f39f8[0x0][_0x5d5408(0x101)]==_0x5d5408(0x15d))var _0x548861=users[_0x5d5408(0x15d)];else{if(_0x2f39f8[0x0][_0x5d5408(0x101)]==_0x5d5408(0x139))var _0x548861=users[_0x5d5408(0x10d)];}}}}}}}const _0x333943=getRandom8DigitNumber();_0x333943['then'](_0x550fd6=>{var _0x365894=_0x5d5408;_0x34db0f[_0x365894(0x106)](_0x365894(0x173),{'success':_0x2b3404['flash'](_0x365894(0x10f)),'errors':_0x2b3404['flash']('errors'),'role':_0x39fdbe,'profile':_0x5f2a44,'master_shop':_0x2f39f8,'warehouse':_0xb75efc,'language':_0x548861,'invoice':_0x550fd6});})[_0x5d5408(0xb4)](_0x2e1d6d=>{var _0x3d2982=_0x5d5408;_0x2b3404[_0x3d2982(0xbf)]('errors',_0x3d2982(0x161)),_0x34db0f[_0x3d2982(0xcf)](_0x3d2982(0x10a));});}catch(_0xa85265){console[_0x5d5408(0xb8)](_0xa85265);}}),router['post'](a0_0x541f1f(0xc2),auth,async(_0x22eb60,_0x349d4c)=>{var _0x2e7f7c=a0_0x541f1f;try{const {date:_0x141c9c,from_warehouse:_0x20a7e2,FromRoom_name:_0x5a53fa,to_warehouse:_0x33f6b3,ToRoom_name:_0x511484,prod_name:_0x260633,from_prod_qty:_0x4cf004,from_prod_level:_0x2d5a45,from_prod_isle:_0x40c46b,from_prod_pallet:_0x5714a6,to_prod_qty:_0x45fcbc,to_prod_level:_0x46b9b0,to_prod_isle:_0x261e53,to_prod_pallet:_0x3985b1,primary_code:_0x576abf,secondary_code:_0x148aba,product_code3:_0xa46ed2,note:_0xc838af,MaxStocks_data2:_0x395522,invoice:_0x21340f,expiry_date:_0x40d3ac}=_0x22eb60[_0x2e7f7c(0xe9)];if(typeof _0x260633==_0x2e7f7c(0x145))var _0x4b02a3=[_0x22eb60['body'][_0x2e7f7c(0x136)]],_0x4554c1=[_0x22eb60[_0x2e7f7c(0xe9)]['from_prod_qty']],_0x25bf19=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x177)]],_0x891b5a=[_0x22eb60['body'][_0x2e7f7c(0xa5)]],_0x269735=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xaf)]],_0x96c973=[_0x22eb60[_0x2e7f7c(0xe9)]['primary_code']],_0x46e541=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x165)]],_0x3a6615=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xb1)]],_0x4ad02b=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x124)]],_0x140dff=[_0x22eb60[_0x2e7f7c(0xe9)]['primary_unit']],_0x543e8c=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xea)]],_0xea17b5=[_0x22eb60[_0x2e7f7c(0xe9)]['batch_code']],_0x11ca55=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x144)]],_0x126ad4=[_0x22eb60[_0x2e7f7c(0xe9)]['product_date']],_0x58fe4e=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x178)]],_0x291f37=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x109)]],_0x4a935a=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x156)]],_0x277dde=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x122)]],_0x59a310=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x166)]],_0x3cad4c=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x160)]],_0x283a35=[_0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xd3)]];else var _0x4b02a3=[..._0x22eb60['body'][_0x2e7f7c(0x136)]],_0x4554c1=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xf1)]],_0x25bf19=[..._0x22eb60['body']['from_prod_level']],_0x891b5a=[..._0x22eb60['body']['New_Qty_Converted']],_0x269735=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xaf)]],_0x96c973=[..._0x22eb60[_0x2e7f7c(0xe9)]['primary_code']],_0x46e541=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x165)]],_0x3a6615=[..._0x22eb60['body'][_0x2e7f7c(0xb1)]],_0x4ad02b=[..._0x22eb60[_0x2e7f7c(0xe9)]['MaxStocks_data2']],_0x140dff=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x17b)]],_0x543e8c=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xea)]],_0xea17b5=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x176)]],_0x11ca55=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x144)]],_0x126ad4=[..._0x22eb60['body'][_0x2e7f7c(0x17c)]],_0x58fe4e=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x178)]],_0x291f37=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x109)]],_0x4a935a=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x156)]],_0x277dde=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x122)]],_0x59a310=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0x166)]],_0x3cad4c=[..._0x22eb60['body'][_0x2e7f7c(0x160)]],_0x283a35=[..._0x22eb60[_0x2e7f7c(0xe9)][_0x2e7f7c(0xd3)]];const _0xde580=_0x4b02a3[_0x2e7f7c(0xd7)](_0x1102d2=>{return _0x1102d2={'product_name':_0x1102d2};});_0x4554c1[_0x2e7f7c(0x14f)]((_0x367db3,_0x25ceb4)=>{_0xde580[_0x25ceb4]['from_quantity']=_0x367db3;}),_0x25bf19['forEach']((_0x5c56ea,_0x2e7b69)=>{var _0x3d54cf=_0x2e7f7c;_0xde580[_0x2e7b69][_0x3d54cf(0xef)]=_0x5c56ea;}),_0x3cad4c[_0x2e7f7c(0x14f)]((_0x15cbd0,_0x1d137c)=>{var _0x161507=_0x2e7f7c;_0xde580[_0x1d137c][_0x161507(0x160)]=_0x15cbd0;}),_0x283a35[_0x2e7f7c(0x14f)]((_0x164adf,_0x299fd0)=>{var _0x5bf55f=_0x2e7f7c;_0xde580[_0x299fd0][_0x5bf55f(0x11e)]=_0x164adf;}),_0x891b5a[_0x2e7f7c(0x14f)]((_0x1b83be,_0x919a3a)=>{var _0x979e38=_0x2e7f7c;_0xde580[_0x919a3a][_0x979e38(0xed)]=_0x1b83be;}),_0x269735['forEach']((_0x195d08,_0x2c88fc)=>{var _0x470ceb=_0x2e7f7c;_0xde580[_0x2c88fc][_0x470ceb(0x13d)]=_0x195d08;}),_0x96c973[_0x2e7f7c(0x14f)]((_0x36a021,_0x1ddeae)=>{var _0x1577f5=_0x2e7f7c;_0xde580[_0x1ddeae][_0x1577f5(0x16d)]=_0x36a021;}),_0x46e541[_0x2e7f7c(0x14f)]((_0x3e2c99,_0x23a2cf)=>{var _0x15b2a5=_0x2e7f7c;_0xde580[_0x23a2cf][_0x15b2a5(0x165)]=_0x3e2c99;}),_0x3a6615[_0x2e7f7c(0x14f)]((_0x4a387b,_0x27fcc2)=>{var _0x4490e1=_0x2e7f7c;_0xde580[_0x27fcc2][_0x4490e1(0xc7)]=_0x4a387b;}),_0x4ad02b[_0x2e7f7c(0x14f)]((_0x638da7,_0x5867d6)=>{var _0x3fcf9d=_0x2e7f7c;_0xde580[_0x5867d6][_0x3fcf9d(0x120)]=_0x638da7;}),_0x140dff[_0x2e7f7c(0x14f)]((_0x4504a5,_0x539d95)=>{var _0x3e3727=_0x2e7f7c;_0xde580[_0x539d95][_0x3e3727(0xf9)]=_0x4504a5;}),_0x543e8c['forEach']((_0x5774d8,_0x58517a)=>{var _0x3c7480=_0x2e7f7c;_0xde580[_0x58517a][_0x3c7480(0xea)]=_0x5774d8;}),_0xea17b5[_0x2e7f7c(0x14f)]((_0x538fa5,_0x2ed96e)=>{var _0x25177a=_0x2e7f7c;_0xde580[_0x2ed96e][_0x25177a(0x176)]=_0x538fa5;}),_0x11ca55['forEach']((_0x5856b7,_0x485efd)=>{var _0x5f1b7e=_0x2e7f7c;_0xde580[_0x485efd][_0x5f1b7e(0x144)]=_0x5856b7;}),_0x126ad4[_0x2e7f7c(0x14f)]((_0x2a20cb,_0x2fc954)=>{_0xde580[_0x2fc954]['production_date']=_0x2a20cb;}),_0x58fe4e[_0x2e7f7c(0x14f)]((_0x44a622,_0x4d473d)=>{_0xde580[_0x4d473d]['maxProducts']=_0x44a622;}),_0x291f37['forEach']((_0x2b3674,_0x11d45e)=>{_0xde580[_0x11d45e]['maxPerUnit']=_0x2b3674;}),_0x4a935a[_0x2e7f7c(0x14f)]((_0x11d064,_0x226bf8)=>{var _0x47f6b6=_0x2e7f7c;_0xde580[_0x226bf8][_0x47f6b6(0x156)]=_0x11d064;}),_0x277dde[_0x2e7f7c(0x14f)]((_0x5a910b,_0x5856df)=>{var _0xd832af=_0x2e7f7c;_0xde580[_0x5856df][_0xd832af(0x174)]=_0x5a910b;}),_0x59a310['forEach']((_0x454fcf,_0x5d1ac4)=>{var _0x5a2ee7=_0x2e7f7c;_0xde580[_0x5d1ac4][_0x5a2ee7(0xbb)]=_0x454fcf;});const _0x37fedf=_0xde580[_0x2e7f7c(0x126)](_0x3acda0=>_0x3acda0[_0x2e7f7c(0xed)]!=='0'&&_0x3acda0['to_quantity']!==''||_0x3acda0[_0x2e7f7c(0x163)]!=='0'&&_0x3acda0[_0x2e7f7c(0x163)]!=='');var _0x38f10e=0x0;_0x37fedf[_0x2e7f7c(0x14f)](_0x27b5ce=>{var _0x51ad38=_0x2e7f7c;parseInt(_0x27b5ce[_0x51ad38(0x11b)])<parseInt(_0x27b5ce[_0x51ad38(0xed)])&&_0x38f10e++;});if(_0x38f10e!=0x0)return _0x22eb60['flash'](_0x2e7f7c(0x123),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x349d4c[_0x2e7f7c(0xcf)](_0x2e7f7c(0xde));const _0x1dd360=new transfers_finished({'date':_0x141c9c,'from_warehouse':_0x20a7e2,'to_warehouse':_0x33f6b3,'product':_0x37fedf,'note':_0xc838af,'invoice':_0x21340f}),_0x4a2ffb=await _0x1dd360['save']();_0x22eb60[_0x2e7f7c(0xbf)](_0x2e7f7c(0x10f),_0x2e7f7c(0x172)),_0x349d4c[_0x2e7f7c(0xcf)](_0x2e7f7c(0x13f)+_0x4a2ffb[_0x2e7f7c(0xbc)]);}catch(_0xb35c43){console[_0x2e7f7c(0xb8)](_0xb35c43),_0x349d4c[_0x2e7f7c(0xe0)](0xc8)[_0x2e7f7c(0xb2)]({'errorMessage':_0xb35c43[_0x2e7f7c(0x12c)]});}}),router[a0_0x541f1f(0xd4)](a0_0x541f1f(0x12e),auth,async(_0x511713,_0x2889e6)=>{var _0x54b57f=a0_0x541f1f;try{const {username:_0x2c1e98,email:_0xae176,role:_0x3a7cdc}=_0x511713['user'],_0x46bfdd=_0x511713[_0x54b57f(0x135)],_0x433c10=await profile[_0x54b57f(0x15a)]({'email':_0x46bfdd[_0x54b57f(0x17d)]}),_0x3f628f=await master_shop[_0x54b57f(0x132)](),_0x2f35c1=await transfers_finished[_0x54b57f(0x149)](_0x511713[_0x54b57f(0x146)]['id']);let _0x2ff4ec;if(_0x46bfdd[_0x54b57f(0x128)]=='staff'){const _0x3d071a=await staff[_0x54b57f(0x15a)]({'email':_0x46bfdd[_0x54b57f(0x17d)]});_0x2ff4ec=await warehouse['find']({'status':'Enabled','name':_0x3d071a[_0x54b57f(0x130)],'warehouse_category':_0x54b57f(0xa6)});}else _0x2ff4ec=await warehouse[_0x54b57f(0x132)]({'status':_0x54b57f(0xbd),'warehouse_category':_0x54b57f(0xa6)});const _0x32b8f5=await warehouse[_0x54b57f(0xcd)]([{'$match':{'name':_0x2f35c1[_0x54b57f(0x17a)],'warehouse_category':_0x54b57f(0xa6)}},{'$unwind':_0x54b57f(0xfe)},{'$group':{'_id':_0x54b57f(0xab),'name':{'$first':_0x54b57f(0x15b)},'product_stock':{'$first':_0x54b57f(0x170)},'bay':{'$first':_0x54b57f(0x138)},'bin':{'$first':_0x54b57f(0x131)},'type':{'$first':_0x54b57f(0xeb)},'floorlevel':{'$first':_0x54b57f(0x14d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x54b57f(0x14b)},'product_code':{'$first':_0x54b57f(0x167)},'storage':{'$first':_0x54b57f(0x143)},'rack':{'$first':_0x54b57f(0x14a)},'expiry_date':{'$first':_0x54b57f(0x16b)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x54b57f(0xb7)},'warehoue_name':{'$first':_0x54b57f(0xa2)}}}]),_0xadfd5e=await product[_0x54b57f(0x132)]({});if(_0x3f628f[0x0]['language']=='English\x20(US)'){var _0x22f268=users[_0x54b57f(0x17e)];console[_0x54b57f(0xb8)](_0x22f268);}else{if(_0x3f628f[0x0][_0x54b57f(0x101)]==_0x54b57f(0xee))var _0x22f268=users[_0x54b57f(0xee)];else{if(_0x3f628f[0x0][_0x54b57f(0x101)]==_0x54b57f(0x175))var _0x22f268=users[_0x54b57f(0x175)];else{if(_0x3f628f[0x0][_0x54b57f(0x101)]=='Spanish')var _0x22f268=users['Spanish'];else{if(_0x3f628f[0x0]['language']==_0x54b57f(0xb0))var _0x22f268=users[_0x54b57f(0xb0)];else{if(_0x3f628f[0x0][_0x54b57f(0x101)]==_0x54b57f(0xb3))var _0x22f268=users[_0x54b57f(0xc1)];else{if(_0x3f628f[0x0]['language']==_0x54b57f(0x15d))var _0x22f268=users['Chinese'];else{if(_0x3f628f[0x0][_0x54b57f(0x101)]==_0x54b57f(0x139))var _0x22f268=users[_0x54b57f(0x10d)];}}}}}}}_0x2889e6['render'](_0x54b57f(0x105),{'success':_0x511713[_0x54b57f(0xbf)](_0x54b57f(0x10f)),'errors':_0x511713[_0x54b57f(0xbf)]('errors'),'role':_0x46bfdd,'profile':_0x433c10,'master_shop':_0x3f628f,'warehouse':_0x2ff4ec,'transfer':_0x2f35c1,'stock':_0x32b8f5,'unit':_0xadfd5e,'language':_0x22f268});}catch(_0x1ae454){console['log'](_0x1ae454);}}),router[a0_0x541f1f(0xc4)](a0_0x541f1f(0x12e),auth,async(_0x16917f,_0x12200b)=>{var _0x305d25=a0_0x541f1f;try{const {invoice:_0x80742d,from_warehouse:_0x4d6ffc,FromRoom_name:_0x198faf,to_warehouse:_0x4b607e,ToRoom_name:_0x36dc9f}=_0x16917f[_0x305d25(0xe9)],_0xd1af1b=await transfers_finished[_0x305d25(0x149)](_0x16917f[_0x305d25(0x146)]['id']),_0x310ca9=_0xd1af1b['product'][_0x305d25(0xd7)](async _0x7db350=>{var _0x30dc8c=_0x305d25;if(_0x7db350[_0x30dc8c(0xed)]>0x0){var _0x3694a8=await warehouse[_0x30dc8c(0x15a)]({'name':_0x4d6ffc,'room':_0x7db350[_0x30dc8c(0x174)],'warehouse_category':_0x30dc8c(0xa6)});const _0x205805=_0x3694a8[_0x30dc8c(0x12b)][_0x30dc8c(0xd7)](_0x1f17b2=>{var _0x4ba20c=_0x30dc8c;_0x1f17b2[_0x4ba20c(0xcb)]==_0x7db350[_0x4ba20c(0xcb)]&&_0x1f17b2[_0x4ba20c(0xff)]==_0x7db350[_0x4ba20c(0xef)]&&_0x1f17b2[_0x4ba20c(0x144)]==_0x7db350[_0x4ba20c(0x144)]&&_0x1f17b2[_0x4ba20c(0x164)]==_0x7db350[_0x4ba20c(0x164)]&&_0x1f17b2[_0x4ba20c(0x176)]==_0x7db350[_0x4ba20c(0x176)]&&_0x1f17b2[_0x4ba20c(0x168)]==_0x7db350['from_invoice']&&(_0x1f17b2[_0x4ba20c(0xe2)]=_0x1f17b2[_0x4ba20c(0xe2)]-_0x7db350[_0x4ba20c(0xed)]);});}return _0x3694a8;});Promise[_0x305d25(0x179)](_0x310ca9)[_0x305d25(0x12f)](async _0xefc69b=>{var _0x5d4e34=_0x305d25;try{for(const _0x406f4c of _0xefc69b){await _0x406f4c['save']();}const _0x2e24f0=_0xd1af1b[_0x5d4e34(0xfa)][_0x5d4e34(0xd7)](async _0x465090=>{var _0x7988b=_0x5d4e34,_0x43d8d3=await warehouse[_0x7988b(0x15a)]({'name':_0x4b607e,'room':_0x465090[_0x7988b(0xbb)]});if(_0x465090[_0x7988b(0xed)]>0x0){var _0x4f5ad8=0x0;const _0x23ff87=_0x43d8d3['product_details'][_0x7988b(0xd7)](_0x2a4bfe=>{var _0x21ab24=_0x7988b;_0x2a4bfe[_0x21ab24(0xcb)]==_0x465090[_0x21ab24(0xcb)]&&_0x2a4bfe[_0x21ab24(0xff)]==_0x465090[_0x21ab24(0x13d)]&&_0x2a4bfe['expiry_date']==_0x465090[_0x21ab24(0x144)]&&_0x2a4bfe['production_date']==_0x465090[_0x21ab24(0x164)]&&_0x2a4bfe['batch_code']==_0x465090['batch_code']&&_0x2a4bfe[_0x21ab24(0x168)]==_0x465090[_0x21ab24(0x11e)]&&(_0x2a4bfe[_0x21ab24(0xe2)]=_0x2a4bfe[_0x21ab24(0xe2)]+_0x465090[_0x21ab24(0xed)],_0x4f5ad8++);});_0x4f5ad8=='0'&&(_0x43d8d3['product_details']=_0x43d8d3[_0x7988b(0x12b)][_0x7988b(0xf7)]({'product_name':_0x465090[_0x7988b(0xcb)],'product_stock':_0x465090[_0x7988b(0xed)],'bay':_0x465090['to_bay'],'product_code':_0x465090[_0x7988b(0xc7)],'primary_code':_0x465090[_0x7988b(0x16d)],'secondary_code':_0x465090[_0x7988b(0x165)],'expiry_date':_0x465090[_0x7988b(0x144)],'production_date':_0x465090[_0x7988b(0x164)],'maxProducts':_0x465090['maxProducts'],'batch_code':_0x465090[_0x7988b(0x176)],'secondary_unit':_0x465090[_0x7988b(0xea)],'unit':_0x465090['unit'],'maxProducts':_0x465090[_0x7988b(0x120)],'maxPerUnit':_0x465090['maxPerUnit'],'invoice':_0x465090[_0x7988b(0x11e)]}));}return _0x43d8d3;});Promise[_0x5d4e34(0x179)](_0x2e24f0)['then'](async _0x2aa268=>{var _0x728bab=_0x5d4e34;try{for(const _0x4aa221 of _0x2aa268){await warehouse[_0x728bab(0x107)]({'_id':_0x4aa221[_0x728bab(0xbc)]},{'$addToSet':{'product_details':{'$each':_0x4aa221[_0x728bab(0x12b)]}}});}_0xd1af1b[_0x728bab(0xa7)]=_0x728bab(0x150);const _0x54dd89=await _0xd1af1b[_0x728bab(0xaa)](),_0x3c5c86=await master_shop['find'](),_0x4ca3fd=await email_settings['findOne'](),_0x41e1f4=await supervisor_settings[_0x728bab(0x132)]();var _0x1e4785=_0xd1af1b[_0x728bab(0xfa)],_0x3dc28f='',_0x518afc;for(_0x518afc in _0x1e4785){var _0x1c4bca='FG';_0xd1af1b['to_warehouse']=='DRY\x20GOODS'&&(_0x1c4bca='DG'),_0x3dc28f+=_0x728bab(0xf0)+_0x728bab(0x100)+_0x1e4785[_0x518afc][_0x728bab(0xcb)]+'</td>'+_0x728bab(0x100)+_0x1e4785[_0x518afc][_0x728bab(0xc7)]+_0x728bab(0xba)+_0x728bab(0x100)+_0x1e4785[_0x518afc][_0x728bab(0xed)]+_0x728bab(0xba)+_0x728bab(0x100)+_0x1e4785[_0x518afc]['unit']+'</td>'+_0x728bab(0x100)+_0x1e4785[_0x518afc][_0x728bab(0xea)]+'</td>'+_0x728bab(0x100)+_0xd1af1b['to_warehouse']+_0x728bab(0xba)+_0x728bab(0x100)+_0x1e4785[_0x518afc][_0x728bab(0xbb)]+'</td>'+_0x728bab(0x100)+_0x1c4bca+_0x1e4785[_0x518afc][_0x728bab(0x13d)]+_0x728bab(0xba)+_0x728bab(0x16e);}let _0x55b6a4=nodemailer[_0x728bab(0xfb)]({'host':_0x4ca3fd[_0x728bab(0x111)],'port':Number(_0x4ca3fd['port']),'secure':![],'auth':{'user':_0x4ca3fd[_0x728bab(0x17d)],'pass':_0x4ca3fd[_0x728bab(0x11c)]}}),_0x36f928={'from':_0x4ca3fd['email'],'to':_0x41e1f4[0x0][_0x728bab(0x113)],'subject':_0x728bab(0xdb),'attachments':[{'filename':_0x728bab(0x15c),'path':__dirname+'/../public'+_0x728bab(0x115)+_0x3c5c86[0x0][_0x728bab(0x141)],'cid':_0x728bab(0x154)}],'html':'<!DOCTYPE\x20html>'+_0x728bab(0x133)+'</head><body>'+_0x728bab(0x118)+_0x728bab(0xf8)+_0x728bab(0x118)+_0x728bab(0x153)+_0x728bab(0x127)+'<div>'+_0x728bab(0xe7)+_0x3c5c86[0x0][_0x728bab(0xe8)]+_0x728bab(0xcc)+_0x728bab(0x127)+_0x728bab(0x127)+'<hr\x20class=\x22my-3\x22>'+_0x728bab(0x118)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x728bab(0xec)+_0xd1af1b[_0x728bab(0x168)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0xd1af1b[_0x728bab(0x148)]+'\x20'+_0x728bab(0xb5)+_0x728bab(0xd1)+_0x728bab(0x127)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+_0x728bab(0x10c)+_0x728bab(0x171)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x728bab(0x121)+_0x728bab(0xe3)+_0x728bab(0xc6)+_0x728bab(0xb9)+'</tr>'+'</thead>'+_0x728bab(0x129)+'\x20'+_0x3dc28f+'\x20'+_0x728bab(0xe5)+_0x728bab(0x14c)+_0x728bab(0x118)+'<strong>\x20Regards\x20</strong>'+_0x728bab(0xc8)+_0x3c5c86[0x0]['site_title']+'</h5>'+_0x728bab(0x127)+'</div>'+_0x728bab(0xd2)};_0x55b6a4[_0x728bab(0x12d)](_0x36f928,function(_0x2b6617,_0x466f9d){var _0x364e17=_0x728bab;_0x2b6617?(console[_0x364e17(0xb8)](_0x2b6617),console[_0x364e17(0xb8)]('Error\x20Occurs')):console[_0x364e17(0xb8)]('Email\x20sent\x20successfully');}),_0x16917f['flash'](_0x728bab(0x10f),_0x728bab(0xe4)),_0x12200b[_0x728bab(0xcf)](_0x728bab(0xf2)+_0x54dd89['_id']);}catch(_0x53f89f){console[_0x728bab(0xdd)](_0x53f89f),_0x12200b[_0x728bab(0xe0)](0x1f4)[_0x728bab(0xb2)]({'error':_0x728bab(0xf4)});}})[_0x5d4e34(0xb4)](_0x4bbe44=>{var _0x1a6134=_0x5d4e34;console[_0x1a6134(0xdd)](_0x4bbe44),_0x12200b[_0x1a6134(0xe0)](0x1f4)[_0x1a6134(0xb2)]({'error':_0x1a6134(0xae)});});}catch(_0x3d2b84){console[_0x5d4e34(0xdd)](_0x3d2b84),_0x12200b[_0x5d4e34(0xe0)](0x1f4)['json']({'error':_0x5d4e34(0x15e)});}})[_0x305d25(0xb4)](_0xe2b29a=>{var _0x79cf5a=_0x305d25;console['error'](_0xe2b29a),_0x12200b[_0x79cf5a(0xe0)](0x1f4)['json']({'error':_0x79cf5a(0xae)});});}catch(_0x13071f){_0x12200b[_0x305d25(0xb2)]({'message':_0x13071f[_0x305d25(0x12c)]});}});function BayBinSelected(_0x38b849,_0x41d73a){var _0x500125=a0_0x541f1f,_0x3bc8ae=[];let _0x278ea6=[];var _0x4ab69c=[];if(_0x38b849=='DRY\x20GOODS'){switch(_0x41d73a){case _0x500125(0xda):_0x3bc8ae=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x500125(0x151):_0x3bc8ae=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x4ab69c=['DG'];}else{if(_0x38b849==_0x500125(0x13e)){switch(_0x41d73a){case _0x500125(0xda):_0x3bc8ae=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x500125(0x151):_0x3bc8ae=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x4ab69c=['FG'];}}return{'levels':_0x3bc8ae,'identify':_0x4ab69c};}router[a0_0x541f1f(0xd4)](a0_0x541f1f(0x155),auth,async(_0x213a34,_0x46fd4d)=>{var _0xa2fde2=a0_0x541f1f;try{const {username:_0x19e79d,email:_0x3c10ad,role:_0x3ebcfe}=_0x213a34[_0xa2fde2(0x135)],_0x4313f8=_0x213a34['user'],_0x16a20b=await profile[_0xa2fde2(0x15a)]({'email':_0x4313f8['email']}),_0x4d7dbd=await master_shop[_0xa2fde2(0x132)](),_0x15590c=await transfers_finished[_0xa2fde2(0x149)](_0x213a34[_0xa2fde2(0x146)]['id']);let _0x4156c6=new Date(_0x15590c['expiry_date']),_0x9b998f=('0'+_0x4156c6[_0xa2fde2(0x110)]())[_0xa2fde2(0xc9)](-0x2),_0x5bebe1=('0'+(_0x4156c6[_0xa2fde2(0x152)]()+0x1))[_0xa2fde2(0xc9)](-0x2),_0x2d5ad6=_0x4156c6[_0xa2fde2(0x15f)](),_0x55a541=_0x2d5ad6+'-'+_0x5bebe1+'-'+_0x9b998f,_0x27e5ae;if(_0x4313f8['role']==_0xa2fde2(0x10e)){const _0x283199=await staff[_0xa2fde2(0x15a)]({'email':_0x4313f8[_0xa2fde2(0x17d)]});_0x27e5ae=await warehouse[_0xa2fde2(0x132)]({'status':_0xa2fde2(0xbd),'name':_0x283199[_0xa2fde2(0x130)],'warehouse_category':_0xa2fde2(0xa6)});}else _0x27e5ae=await warehouse[_0xa2fde2(0x132)]({'status':_0xa2fde2(0xbd),'warehouse_category':_0xa2fde2(0xa6)});const _0x16afd8=await warehouse[_0xa2fde2(0xcd)]([{'$match':{'name':_0x15590c[_0xa2fde2(0x17a)],'room':_0x15590c[_0xa2fde2(0x157)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0xa2fde2(0x170)},'bay':{'$first':_0xa2fde2(0x138)},'bin':{'$first':_0xa2fde2(0x131)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xa2fde2(0x14d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xa2fde2(0x14b)},'product_code':{'$first':_0xa2fde2(0x167)},'storage':{'$first':_0xa2fde2(0x143)},'rack':{'$first':_0xa2fde2(0x14a)}}}]);var _0x19fa2c=[0x1,0x2,0x3,0x4],_0x1cd810=['A','B','C','D','E','F','G','H','I','J'],_0x41beb3=[_0xa2fde2(0x13a),'Enclosed'];const _0x36b491=await product['find']({}),_0x52d05a=BayBinSelected(_0x15590c[_0xa2fde2(0x16a)],_0x15590c[_0xa2fde2(0xa8)]);if(_0x4d7dbd[0x0][_0xa2fde2(0x101)]=='English\x20(US)'){var _0xe5c539=users['English'];console[_0xa2fde2(0xb8)](_0xe5c539);}else{if(_0x4d7dbd[0x0][_0xa2fde2(0x101)]==_0xa2fde2(0xee))var _0xe5c539=users[_0xa2fde2(0xee)];else{if(_0x4d7dbd[0x0]['language']==_0xa2fde2(0x175))var _0xe5c539=users[_0xa2fde2(0x175)];else{if(_0x4d7dbd[0x0][_0xa2fde2(0x101)]==_0xa2fde2(0x108))var _0xe5c539=users['Spanish'];else{if(_0x4d7dbd[0x0]['language']==_0xa2fde2(0xb0))var _0xe5c539=users[_0xa2fde2(0xb0)];else{if(_0x4d7dbd[0x0][_0xa2fde2(0x101)]=='Portuguese\x20(BR)')var _0xe5c539=users[_0xa2fde2(0xc1)];else{if(_0x4d7dbd[0x0][_0xa2fde2(0x101)]==_0xa2fde2(0x15d))var _0xe5c539=users['Chinese'];else{if(_0x4d7dbd[0x0][_0xa2fde2(0x101)]=='Arabic\x20(ae)')var _0xe5c539=users['Arabic'];}}}}}}}_0x46fd4d[_0xa2fde2(0x106)](_0xa2fde2(0x17f),{'success':_0x213a34[_0xa2fde2(0xbf)](_0xa2fde2(0x10f)),'errors':_0x213a34[_0xa2fde2(0xbf)](_0xa2fde2(0x123)),'role':_0x4313f8,'profile':_0x16a20b,'master_shop':_0x4d7dbd,'warehouse':_0x27e5ae,'transfer':_0x15590c,'stock':_0x16afd8,'unit':_0x36b491,'language':_0xe5c539,'levels':_0x19fa2c,'Isle':_0x1cd810,'rooms_data':_0x41beb3,'ed_fullDate':_0x55a541,'dataSelected':_0x52d05a});}catch(_0x7f6223){console['log'](_0x7f6223);}}),router[a0_0x541f1f(0xc4)](a0_0x541f1f(0x155),auth,async(_0x22c207,_0x11adce)=>{var _0x3c61d5=a0_0x541f1f;try{const _0x1fb9b0=_0x22c207[_0x3c61d5(0x146)]['id'];console['log'](_0x22c207[_0x3c61d5(0xe9)]);const _0x48737e=await transfers_finished[_0x3c61d5(0x149)](_0x1fb9b0);console[_0x3c61d5(0xb8)](_0x3c61d5(0xce),_0x48737e);const {date:_0x5ea797,from_warehouse:_0x2e4d0e,FromRoom_name:_0x51d46e,to_warehouse:_0xbb8595,ToRoom_name:_0x3e4053,prod_name:_0x2e339b,from_prod_qty:_0x25a44c,from_prod_level:_0x3a96e9,from_prod_isle:_0x7aa4c3,from_prod_pallet:_0x23cf68,to_prod_qty:_0x3aeeba,to_prod_level:_0x5690d2,to_prod_isle:_0x16fec2,to_prod_pallet:_0x2dd124,primary_code:_0x6cadec,secondary_code:_0x4e81a0,product_code3:_0x2d65a7,note:_0x3b2d95,invoice:_0x2e9f52,expiry_date:_0xe3b3b0}=_0x22c207[_0x3c61d5(0xe9)];if(typeof _0x2e339b=='string')var _0x245d08=[_0x22c207[_0x3c61d5(0xe9)]['prod_name']],_0xdaf4c8=[_0x22c207['body'][_0x3c61d5(0xf1)]],_0x219aa0=[_0x22c207['body'][_0x3c61d5(0x177)]],_0xb13e5e=[_0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x119)]],_0x12f1a5=[_0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0xaf)]],_0xdf9118=[_0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x16d)]],_0x231267=[_0x22c207['body'][_0x3c61d5(0x165)]],_0x45e153=[_0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0xb1)]],_0x3dc851=[_0x22c207['body']['MaxStocks_data2']],_0x4fdd3d=[_0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0xf9)]],_0x1fa422=[_0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0xea)]],_0x5ca806=[_0x22c207[_0x3c61d5(0xe9)]['batch_code']],_0x5a54f0=[_0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x144)]];else var _0x245d08=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x136)]],_0xdaf4c8=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0xf1)]],_0x219aa0=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x177)]],_0xb13e5e=[..._0x22c207['body'][_0x3c61d5(0x119)]],_0x12f1a5=[..._0x22c207['body'][_0x3c61d5(0xaf)]],_0xdf9118=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x16d)]],_0x231267=[..._0x22c207['body']['secondary_code']],_0x45e153=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0xb1)]],_0x3dc851=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x124)]],_0x4fdd3d=[..._0x22c207['body']['unit']],_0x1fa422=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0xea)]],_0x5ca806=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x176)]],_0x5a54f0=[..._0x22c207[_0x3c61d5(0xe9)][_0x3c61d5(0x144)]];const _0x104a17=_0x245d08['map'](_0x418d46=>{return _0x418d46={'product_name':_0x418d46};});_0xdaf4c8[_0x3c61d5(0x14f)]((_0x49633b,_0x3c70f2)=>{var _0x27fc6f=_0x3c61d5;_0x104a17[_0x3c70f2][_0x27fc6f(0x11b)]=_0x49633b;}),_0x219aa0[_0x3c61d5(0x14f)]((_0x3f6ea9,_0x55f4ba)=>{_0x104a17[_0x55f4ba]['from_bay']=_0x3f6ea9;}),_0xb13e5e[_0x3c61d5(0x14f)]((_0x382f11,_0x278965)=>{var _0x47773c=_0x3c61d5;_0x104a17[_0x278965][_0x47773c(0xed)]=_0x382f11;}),_0x12f1a5[_0x3c61d5(0x14f)]((_0x1e8c19,_0x40cc32)=>{_0x104a17[_0x40cc32]['to_bay']=_0x1e8c19;}),_0xdf9118['forEach']((_0x7f1ac4,_0x2b0c11)=>{var _0x232d83=_0x3c61d5;_0x104a17[_0x2b0c11][_0x232d83(0x16d)]=_0x7f1ac4;}),_0x231267['forEach']((_0x323734,_0x427111)=>{var _0x350a5d=_0x3c61d5;_0x104a17[_0x427111][_0x350a5d(0x165)]=_0x323734;}),_0x45e153[_0x3c61d5(0x14f)]((_0x2049aa,_0x312ddc)=>{_0x104a17[_0x312ddc]['product_code']=_0x2049aa;}),_0x3dc851['forEach']((_0x2d68f9,_0x277a63)=>{_0x104a17[_0x277a63]['maxProducts']=_0x2d68f9;}),_0x4fdd3d['forEach']((_0x13d501,_0x1594a2)=>{var _0x41c052=_0x3c61d5;_0x104a17[_0x1594a2][_0x41c052(0xf9)]=_0x13d501;}),_0x1fa422[_0x3c61d5(0x14f)]((_0x3f6a16,_0x3ade87)=>{var _0x5dbe05=_0x3c61d5;_0x104a17[_0x3ade87][_0x5dbe05(0xea)]=_0x3f6a16;}),_0x5ca806[_0x3c61d5(0x14f)]((_0xf6ae01,_0x492e18)=>{var _0xf1531a=_0x3c61d5;_0x104a17[_0x492e18][_0xf1531a(0x176)]=_0xf6ae01;}),_0x5a54f0[_0x3c61d5(0x14f)]((_0x53c939,_0xa8eb68)=>{_0x104a17[_0xa8eb68]['expiry_date']=_0x53c939;});const _0x17a081=_0x104a17[_0x3c61d5(0x126)](_0x4fa6cc=>_0x4fa6cc[_0x3c61d5(0xed)]!=='0'&&_0x4fa6cc[_0x3c61d5(0xed)]!==''||_0x4fa6cc[_0x3c61d5(0x163)]!=='0'&&_0x4fa6cc['to_floorlevel']!=='');var _0x229590=0x0;_0x17a081[_0x3c61d5(0x14f)](_0x51f28f=>{var _0x406830=_0x3c61d5;parseInt(_0x51f28f[_0x406830(0x11b)])<parseInt(_0x51f28f[_0x406830(0xed)])&&_0x229590++;});if(_0x229590!=0x0)return _0x22c207[_0x3c61d5(0xbf)]('errors',_0x3c61d5(0xd8)),_0x11adce['redirect'](_0x3c61d5(0xde));const _0x550b85=await warehouse[_0x3c61d5(0x15a)]({'name':_0x48737e[_0x3c61d5(0x17a)],'room':_0x48737e[_0x3c61d5(0x157)]});_0x48737e[_0x3c61d5(0xfa)]['forEach'](_0x4e6e18=>{var _0x511865=_0x3c61d5;if(_0x4e6e18[_0x511865(0xed)]>0x0){const _0x4433a6=_0x550b85[_0x511865(0x12b)][_0x511865(0xd7)](_0x101d42=>{var _0x59967f=_0x511865;_0x101d42[_0x59967f(0xcb)]==_0x4e6e18['product_name']&&_0x101d42[_0x59967f(0xff)]==_0x4e6e18['from_bay']&&(_0x101d42[_0x59967f(0xe2)]=parseInt(_0x101d42[_0x59967f(0xe2)])+parseInt(_0x4e6e18[_0x59967f(0xed)]));});}}),await _0x550b85[_0x3c61d5(0xaa)]();const _0xb62e18=await warehouse[_0x3c61d5(0x15a)]({'name':_0x48737e['to_warehouse'],'room':_0x48737e[_0x3c61d5(0xa8)]});_0x48737e[_0x3c61d5(0xfa)][_0x3c61d5(0x14f)](_0x21fb5b=>{var _0x55e44f=_0x3c61d5;if(_0x21fb5b[_0x55e44f(0xed)]>0x0){const _0x32ead1=_0xb62e18['product_details']['map'](_0x4da239=>{var _0x5599f6=_0x55e44f;_0x4da239[_0x5599f6(0xcb)]==_0x21fb5b[_0x5599f6(0xcb)]&&_0x4da239[_0x5599f6(0xff)]==_0x21fb5b[_0x5599f6(0x13d)]&&(_0x4da239[_0x5599f6(0xe2)]=parseInt(_0x4da239[_0x5599f6(0xe2)])-parseInt(_0x21fb5b[_0x5599f6(0xed)]));});}}),await _0xb62e18[_0x3c61d5(0xaa)](),_0x48737e[_0x3c61d5(0x148)]=_0x5ea797,_0x48737e[_0x3c61d5(0x17a)]=_0x2e4d0e,_0x48737e[_0x3c61d5(0x16a)]=_0xbb8595,_0x48737e[_0x3c61d5(0xfa)]=_0x17a081,_0x48737e[_0x3c61d5(0x104)]=_0x3b2d95,_0x48737e[_0x3c61d5(0x168)]=_0x2e9f52;const _0x1ead00=await _0x48737e[_0x3c61d5(0xaa)](),_0x26e83f=await warehouse[_0x3c61d5(0x15a)]({'name':_0x2e4d0e,'room':_0x51d46e});_0x1ead00['product'][_0x3c61d5(0x14f)](_0x20734f=>{var _0x203b76=_0x3c61d5;if(_0x20734f[_0x203b76(0xed)]>0x0){const _0x2e8d6c=_0x26e83f[_0x203b76(0x12b)][_0x203b76(0xd7)](_0x5e8bee=>{var _0x42ee87=_0x203b76;_0x5e8bee[_0x42ee87(0xcb)]==_0x20734f[_0x42ee87(0xcb)]&&_0x5e8bee['bay']==_0x20734f[_0x42ee87(0xef)]&&(_0x5e8bee[_0x42ee87(0xe2)]=parseInt(_0x5e8bee['product_stock'])-parseInt(_0x20734f[_0x42ee87(0xed)]));});}}),await _0x26e83f[_0x3c61d5(0xaa)]();const _0x41ff92=await warehouse[_0x3c61d5(0x15a)]({'name':_0xbb8595,'room':_0x3e4053});_0x1ead00['product'][_0x3c61d5(0x14f)](_0x48d6d3=>{var _0x2427f4=_0x3c61d5;if(_0x48d6d3[_0x2427f4(0xed)]>0x0){var _0x290b15=0x0;const _0x58367f=_0x41ff92[_0x2427f4(0x12b)][_0x2427f4(0xd7)](_0x42fc63=>{var _0x3e3ac8=_0x2427f4;_0x42fc63[_0x3e3ac8(0xcb)]==_0x48d6d3[_0x3e3ac8(0xcb)]&&_0x42fc63['bay']==_0x48d6d3[_0x3e3ac8(0x13d)]&&(_0x42fc63[_0x3e3ac8(0xe2)]=parseInt(_0x42fc63['product_stock'])+parseInt(_0x48d6d3[_0x3e3ac8(0xed)]),_0x290b15++);});_0x290b15=='0'&&(_0x41ff92[_0x2427f4(0x12b)]=_0x41ff92[_0x2427f4(0x12b)][_0x2427f4(0xf7)]({'product_name':_0x48d6d3['product_name'],'product_stock':_0x48d6d3['to_quantity'],'bay':_0x48d6d3[_0x2427f4(0x13d)],'product_code':_0x48d6d3['product_code'],'primary_code':_0x48d6d3[_0x2427f4(0x16d)],'secondary_code':_0x48d6d3[_0x2427f4(0x165)],'maxProducts':_0x48d6d3[_0x2427f4(0x120)]}));}}),await _0x41ff92['save'](),_0x22c207[_0x3c61d5(0xbf)](_0x3c61d5(0x10f),'Transfer\x20Edit\x20Successfully'),_0x11adce[_0x3c61d5(0xcf)](_0x3c61d5(0x14e));}catch(_0x50a05c){console[_0x3c61d5(0xb8)](_0x50a05c);}}),router[a0_0x541f1f(0xc4)]('/barcode_scanner',async(_0x155e7f,_0x4913fd)=>{var _0x384d71=a0_0x541f1f;const {FromWareHouse:_0x1c40a6,FromRoom:_0x510ca5,ToWarehouse:_0x5cd995,ToRoom:_0x252100,primary_code:_0x5d1e03,Roomslist:_0x408b0c}=_0x155e7f[_0x384d71(0xe9)],_0xa2983c=_0x408b0c[_0x384d71(0xdc)](','),_0x5de1e1=[];async function _0x2d626b(_0x4571e8){var _0x226eb2=_0x384d71;const _0x3f03a9=await warehouse['aggregate']([{'$match':{'name':_0x1c40a6,'room':_0x4571e8}},{'$unwind':_0x226eb2(0xfe)},{'$match':{'product_details.primary_code':_0x5d1e03}},{'$group':{'_id':_0x226eb2(0xab),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x226eb2(0x170)},'primary_code':{'$first':_0x226eb2(0x162)},'secondary_code':{'$first':_0x226eb2(0x14b)},'product_code':{'$first':_0x226eb2(0x167)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x226eb2(0x131)},'type':{'$first':_0x226eb2(0xeb)},'pallet':{'$first':_0x226eb2(0x14d)},'unit':{'$first':_0x226eb2(0x140)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x226eb2(0x143)},'rack':{'$first':_0x226eb2(0x14a)},'expiry_date':{'$first':_0x226eb2(0x16b)},'production_date':{'$first':_0x226eb2(0xad)},'batch_code':{'$first':_0x226eb2(0xe1)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x226eb2(0xb7)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x226eb2(0xd9)}}}]),_0x56d9f6=await warehouse[_0x226eb2(0xcd)]([{'$match':{'name':_0x1c40a6,'room':_0x4571e8}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5d1e03}},{'$group':{'_id':_0x226eb2(0xab),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x226eb2(0x170)},'primary_code':{'$first':_0x226eb2(0x162)},'secondary_code':{'$first':_0x226eb2(0x14b)},'product_code':{'$first':_0x226eb2(0x167)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x226eb2(0x131)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x226eb2(0x14d)},'unit':{'$first':_0x226eb2(0x140)},'secondary_unit':{'$first':_0x226eb2(0xe6)},'storage':{'$first':_0x226eb2(0x143)},'rack':{'$first':_0x226eb2(0x14a)},'expiry_date':{'$first':_0x226eb2(0x16b)},'production_date':{'$first':_0x226eb2(0xad)},'batch_code':{'$first':_0x226eb2(0xe1)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x226eb2(0xd9)}}}]);if(_0x3f03a9['length']>0x0)_0x5de1e1[_0x226eb2(0xd6)](_0x3f03a9);else _0x56d9f6[_0x226eb2(0x169)]>0x0&&_0x5de1e1['push'](_0x56d9f6);}const _0x5c1ae6=_0xa2983c[_0x384d71(0xd7)](_0x4d679f=>_0x2d626b(_0x4d679f));await Promise[_0x384d71(0x179)](_0x5c1ae6),_0x4913fd[_0x384d71(0xb2)](_0x5de1e1);}),router[a0_0x541f1f(0xc4)](a0_0x541f1f(0x11d),async(_0x493609,_0x495703)=>{var _0x14dc88=a0_0x541f1f;try{const {FromWareHouse:_0x2029a4,FromRoom:_0x39f130,ToWarehouse:_0x41edca,ToRoom:_0x405fc9,secondary_code:_0x3f2a93}=_0x493609[_0x14dc88(0xe9)],_0x25e211=await warehouse[_0x14dc88(0xcd)]([{'$match':{'name':_0x2029a4}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3f2a93}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x14dc88(0x15b)},'primary_code':{'$first':_0x14dc88(0x162)},'secondary_code':{'$first':_0x14dc88(0x14b)},'product_code':{'$first':_0x14dc88(0x167)},'instock':{'$first':_0x14dc88(0x170)},'warehouse':{'$first':_0x14dc88(0xa2)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x14dc88(0xdf)},'pallet':{'$first':_0x14dc88(0x11f)},'maxProducts':{'$first':_0x14dc88(0x13c)},'unit':{'$first':_0x14dc88(0x140)},'expiry_date':{'$first':_0x14dc88(0x16b)},'production_date':{'$first':_0x14dc88(0xad)}}}]);_0x495703['status'](0xc8)[_0x14dc88(0xb2)](_0x25e211);}catch(_0x1c46a1){_0x495703['status'](0x194)['json']({'message':_0x1c46a1[_0x14dc88(0x12c)]});}}),router[a0_0x541f1f(0xc4)](a0_0x541f1f(0x112),async(_0x224f80,_0x53f26a)=>{var _0x2b37ec=a0_0x541f1f;try{const {FromWareHouse:_0x5e8544,FromRoom:_0x25f4a2,ToWarehouse:_0x6a0dd,ToRoom:_0x1117b3,product_code:_0x4f18fc}=_0x224f80[_0x2b37ec(0xe9)],_0x17cb4b=await warehouse[_0x2b37ec(0xcd)]([{'$match':{'name':_0x5e8544}},{'$unwind':_0x2b37ec(0xfe)},{'$match':{'product_details.product_code':_0x4f18fc}},{'$group':{'_id':_0x2b37ec(0xab),'name':{'$first':_0x2b37ec(0x15b)},'primary_code':{'$first':_0x2b37ec(0x162)},'secondary_code':{'$first':_0x2b37ec(0x14b)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x2b37ec(0x170)},'warehouse':{'$first':_0x2b37ec(0xa2)},'level':{'$first':_0x2b37ec(0xf6)},'isle':{'$first':_0x2b37ec(0xdf)},'pallet':{'$first':_0x2b37ec(0x11f)},'maxProducts':{'$first':_0x2b37ec(0x13c)},'unit':{'$first':_0x2b37ec(0x140)}}}]);_0x53f26a['status'](0xc8)['json'](_0x17cb4b);}catch(_0x92c96a){_0x53f26a['status'](0x194)[_0x2b37ec(0xb2)]({'message':_0x92c96a[_0x2b37ec(0x12c)]});}}),router[a0_0x541f1f(0xc4)](a0_0x541f1f(0x142),async(_0x4ba86e,_0x34bb6d)=>{var _0x497869=a0_0x541f1f;const {productCode:_0x4abb0c,bay:_0x23f3e7,warehouses:_0x2f9aa2,room:_0x4869aa}=_0x4ba86e[_0x497869(0xe9)];console[_0x497869(0xb8)](_0x4ba86e['body']);try{const _0x4d11ca=await warehouse[_0x497869(0xcd)]([{'$match':{'name':_0x2f9aa2,'room':_0x4869aa}},{'$unwind':_0x497869(0xfe)},{'$match':{'product_details.bay':parseInt(_0x23f3e7)}},{'$group':{'_id':_0x497869(0xab),'name':{'$first':_0x497869(0x15b)},'product_stock':{'$first':_0x497869(0x170)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x497869(0x13c)}}}]);_0x34bb6d['status'](0xc8)['json'](_0x4d11ca);}catch(_0x45629b){_0x34bb6d[_0x497869(0xe0)](0x194)[_0x497869(0xb2)]({'message':_0x45629b[_0x497869(0x12c)]});}}),module[a0_0x541f1f(0x103)]=router;