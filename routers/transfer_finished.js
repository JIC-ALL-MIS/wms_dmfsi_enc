var a0_0x31e544=a0_0x515a;(function(_0x5d9808,_0x4eb813){var _0xb120fc=a0_0x515a,_0x5e4181=_0x5d9808();while(!![]){try{var _0x4bb5f9=-parseInt(_0xb120fc(0xe7))/0x1+parseInt(_0xb120fc(0xfb))/0x2*(-parseInt(_0xb120fc(0x163))/0x3)+-parseInt(_0xb120fc(0x137))/0x4+parseInt(_0xb120fc(0x175))/0x5+-parseInt(_0xb120fc(0xab))/0x6*(parseInt(_0xb120fc(0x11c))/0x7)+-parseInt(_0xb120fc(0xe5))/0x8+parseInt(_0xb120fc(0xf0))/0x9;if(_0x4bb5f9===_0x4eb813)break;else _0x5e4181['push'](_0x5e4181['shift']());}catch(_0x4947b3){_0x5e4181['push'](_0x5e4181['shift']());}}}(a0_0x3f05,0xe0c2a));function a0_0x515a(_0x425af2,_0x5d5091){var _0x3f05e2=a0_0x3f05();return a0_0x515a=function(_0x515a4c,_0x8f64c9){_0x515a4c=_0x515a4c-0x9d;var _0x182876=_0x3f05e2[_0x515a4c];return _0x182876;},a0_0x515a(_0x425af2,_0x5d5091);}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x31e544(0x14c)),auth=require(a0_0x31e544(0x17c)),users=require(a0_0x31e544(0x122)),nodemailer=require(a0_0x31e544(0x125));router['get'](a0_0x31e544(0xe3),auth,async(_0x542132,_0x45cac5)=>{var _0x2c217e=a0_0x31e544;try{const {username:_0x45db18,email:_0x13f625,role:_0x33e8db}=_0x542132[_0x2c217e(0x158)],_0x223abb=_0x542132[_0x2c217e(0x158)],_0x11a7f9=await profile[_0x2c217e(0x135)]({'email':_0x223abb[_0x2c217e(0x130)]}),_0x4c54ba=await master_shop[_0x2c217e(0xd0)]();let _0x1c3133;if(_0x223abb[_0x2c217e(0xb7)]==_0x2c217e(0xda)){const _0x120a5b=await staff[_0x2c217e(0x135)]({'email':_0x223abb['email']});_0x1c3133=await transfers_finished[_0x2c217e(0xd0)]({'from_warehouse':_0x120a5b[_0x2c217e(0x170)]});}else _0x1c3133=await transfers_finished[_0x2c217e(0x168)]([{'$unwind':_0x2c217e(0x112)},{'$group':{'_id':'$_id','invoice':{'$first':_0x2c217e(0x126)},'date':{'$first':_0x2c217e(0x113)},'from_warehouse':{'$first':_0x2c217e(0x10c)},'to_warehouse':{'$first':_0x2c217e(0xa3)},'from_room_name':{'$addToSet':_0x2c217e(0xd7)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x4c54ba[0x0][_0x2c217e(0x15f)]==_0x2c217e(0x101))var _0x326b56=users[_0x2c217e(0xec)];else{if(_0x4c54ba[0x0][_0x2c217e(0x15f)]==_0x2c217e(0x114))var _0x326b56=users[_0x2c217e(0x114)];else{if(_0x4c54ba[0x0][_0x2c217e(0x15f)]==_0x2c217e(0x161))var _0x326b56=users['German'];else{if(_0x4c54ba[0x0]['language']==_0x2c217e(0x174))var _0x326b56=users['Spanish'];else{if(_0x4c54ba[0x0][_0x2c217e(0x15f)]=='French')var _0x326b56=users['French'];else{if(_0x4c54ba[0x0][_0x2c217e(0x15f)]=='Portuguese\x20(BR)')var _0x326b56=users[_0x2c217e(0x10f)];else{if(_0x4c54ba[0x0][_0x2c217e(0x15f)]=='Chinese')var _0x326b56=users[_0x2c217e(0x100)];else{if(_0x4c54ba[0x0][_0x2c217e(0x15f)]=='Arabic\x20(ae)')var _0x326b56=users[_0x2c217e(0xc1)];}}}}}}}_0x45cac5[_0x2c217e(0xd4)](_0x2c217e(0xd8),{'success':_0x542132[_0x2c217e(0xc2)](_0x2c217e(0x13f)),'errors':_0x542132[_0x2c217e(0xc2)](_0x2c217e(0x164)),'role':_0x223abb,'profile':_0x11a7f9,'master_shop':_0x4c54ba,'transfer':_0x1c3133,'language':_0x326b56});}catch(_0x21e932){console['log'](_0x21e932);}});async function getRandom8DigitNumber(){var _0x5b0b3c=a0_0x31e544;const _0x332ec3=0x989680,_0x15428b=0x5f5e0ff,_0x3e6a27=Math['floor'](Math[_0x5b0b3c(0xf9)]()*(_0x15428b-_0x332ec3+0x1))+_0x332ec3;var _0x1aa1ee;const _0x4a5e9a=await transfers_finished[_0x5b0b3c(0x135)]({'invoice':_0x5b0b3c(0xf2)+_0x3e6a27});return _0x4a5e9a&&_0x4a5e9a['length']>0x0?_0x1aa1ee=_0x5b0b3c(0xf2)+_0x3e6a27:_0x1aa1ee=_0x5b0b3c(0xf2)+_0x3e6a27,_0x1aa1ee;}router[a0_0x31e544(0x17b)](a0_0x31e544(0xde),auth,async(_0x46d803,_0x56bb09)=>{var _0x55d58c=a0_0x31e544;try{const {username:_0x256e66,email:_0x17eda0,role:_0x346ffd}=_0x46d803['user'],_0x1b7646=_0x46d803[_0x55d58c(0x158)],_0x3b253e=await profile[_0x55d58c(0x135)]({'email':_0x1b7646['email']}),_0x51811f=await master_shop['find']();let _0x56c5fc;if(_0x1b7646[_0x55d58c(0xb7)]==_0x55d58c(0xda)){const _0x37ab8b=await staff['findOne']({'email':_0x1b7646[_0x55d58c(0x130)]});_0x56c5fc=await warehouse['aggregate']([{'$match':{'status':_0x55d58c(0x12b),'name':_0x37ab8b[_0x55d58c(0x170)],'warehouse_category':_0x55d58c(0x156),'name':{'$ne':_0x55d58c(0x10b)}}},{'$group':{'_id':'$name','name':{'$first':_0x55d58c(0xcc)}}}]);}else _0x56c5fc=await warehouse[_0x55d58c(0x168)]([{'$match':{'status':_0x55d58c(0x12b),'warehouse_category':_0x55d58c(0x156),'name':{'$ne':_0x55d58c(0x10b)}}},{'$group':{'_id':'$name','name':{'$first':_0x55d58c(0xcc)}}}]);const _0x4494ee=await transfers_finished['find']({}),_0x197813=_0x4494ee[_0x55d58c(0xf6)]+0x1,_0x59f792=_0x55d58c(0xf2)+_0x197813[_0x55d58c(0x12c)]()[_0x55d58c(0x144)](0x5,'0');if(_0x51811f[0x0]['language']==_0x55d58c(0x101))var _0x40554c=users[_0x55d58c(0xec)];else{if(_0x51811f[0x0]['language']==_0x55d58c(0x114))var _0x40554c=users[_0x55d58c(0x114)];else{if(_0x51811f[0x0][_0x55d58c(0x15f)]==_0x55d58c(0x161))var _0x40554c=users[_0x55d58c(0x161)];else{if(_0x51811f[0x0][_0x55d58c(0x15f)]==_0x55d58c(0x174))var _0x40554c=users[_0x55d58c(0x174)];else{if(_0x51811f[0x0]['language']=='French')var _0x40554c=users[_0x55d58c(0x16f)];else{if(_0x51811f[0x0][_0x55d58c(0x15f)]=='Portuguese\x20(BR)')var _0x40554c=users[_0x55d58c(0x10f)];else{if(_0x51811f[0x0][_0x55d58c(0x15f)]==_0x55d58c(0x100))var _0x40554c=users[_0x55d58c(0x100)];else{if(_0x51811f[0x0]['language']=='Arabic\x20(ae)')var _0x40554c=users[_0x55d58c(0xc1)];}}}}}}}const _0x30196e=getRandom8DigitNumber();_0x30196e['then'](_0x1c61e0=>{var _0x45e8d2=_0x55d58c;_0x56bb09[_0x45e8d2(0xd4)](_0x45e8d2(0x13e),{'success':_0x46d803[_0x45e8d2(0xc2)](_0x45e8d2(0x13f)),'errors':_0x46d803['flash']('errors'),'role':_0x1b7646,'profile':_0x3b253e,'master_shop':_0x51811f,'warehouse':_0x56c5fc,'language':_0x40554c,'invoice':_0x1c61e0});})[_0x55d58c(0x11b)](_0x2d22c8=>{var _0x221501=_0x55d58c;_0x46d803['flash']('errors',_0x221501(0x15c)),_0x56bb09['redirect'](_0x221501(0xb6));});}catch(_0x50a40d){console[_0x55d58c(0x15b)](_0x50a40d);}}),router[a0_0x31e544(0xdd)](a0_0x31e544(0xde),auth,async(_0x1e21d1,_0x2ebfc8)=>{var _0x3ec8b9=a0_0x31e544;try{const {date:_0x1d92d1,from_warehouse:_0x2cd743,FromRoom_name:_0x533557,to_warehouse:_0x317f87,ToRoom_name:_0x3904d5,prod_name:_0x2d3a8a,from_prod_qty:_0x1758bf,from_prod_level:_0x4ef363,from_prod_isle:_0x16641,from_prod_pallet:_0x4e63dd,to_prod_qty:_0x9a13ae,to_prod_level:_0x5aa302,to_prod_isle:_0x1fc5a9,to_prod_pallet:_0x26cba6,primary_code:_0x156886,secondary_code:_0x3d2e0d,product_code3:_0x35ab08,note:_0x49d99d,MaxStocks_data2:_0x1c4f5a,invoice:_0x383071,expiry_date:_0x120c3c}=_0x1e21d1['body'];if(typeof _0x2d3a8a==_0x3ec8b9(0x14b))var _0x4e1c3e=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x178)]],_0x3105f6=[_0x1e21d1['body'][_0x3ec8b9(0x173)]],_0x1888b5=[_0x1e21d1[_0x3ec8b9(0x105)]['from_prod_level']],_0x131ae1=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x16b)]],_0x1bf8f3=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x169)]],_0x17825f=[_0x1e21d1['body'][_0x3ec8b9(0x10a)]],_0x31b988=[_0x1e21d1[_0x3ec8b9(0x105)]['secondary_code']],_0x2cec3e=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xc6)]],_0x3cd34e=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xbe)]],_0x31045e=[_0x1e21d1['body'][_0x3ec8b9(0x165)]],_0x48cd6f=[_0x1e21d1['body'][_0x3ec8b9(0x13d)]],_0x15307b=[_0x1e21d1['body'][_0x3ec8b9(0x11f)]],_0x19a1ea=[_0x1e21d1['body'][_0x3ec8b9(0x176)]],_0x284fee=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x133)]],_0x56ef79=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x9f)]],_0x3eda69=[_0x1e21d1['body'][_0x3ec8b9(0x13a)]],_0x45166b=[_0x1e21d1[_0x3ec8b9(0x105)]['prod_cat']],_0x100d4e=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xd6)]],_0x7c76c0=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x17a)]],_0x5c6ce6=[_0x1e21d1[_0x3ec8b9(0x105)]['from_invoice']],_0xfad789=[_0x1e21d1['body']['to_invoice']],_0xbd9c1e=[_0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xa2)]];else var _0x4e1c3e=[..._0x1e21d1['body'][_0x3ec8b9(0x178)]],_0x3105f6=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x173)]],_0x1888b5=[..._0x1e21d1['body'][_0x3ec8b9(0xdc)]],_0x131ae1=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x16b)]],_0x1bf8f3=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x169)]],_0x17825f=[..._0x1e21d1[_0x3ec8b9(0x105)]['primary_code']],_0x31b988=[..._0x1e21d1['body'][_0x3ec8b9(0xbf)]],_0x2cec3e=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xc6)]],_0x3cd34e=[..._0x1e21d1['body']['MaxStocks_data2']],_0x31045e=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x165)]],_0x48cd6f=[..._0x1e21d1['body'][_0x3ec8b9(0x13d)]],_0x15307b=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x11f)]],_0x19a1ea=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x176)]],_0x284fee=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x133)]],_0x56ef79=[..._0x1e21d1['body']['MaxStocks_data']],_0x3eda69=[..._0x1e21d1['body'][_0x3ec8b9(0x13a)]],_0x45166b=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0x10e)]],_0x100d4e=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xd6)]],_0x7c76c0=[..._0x1e21d1[_0x3ec8b9(0x105)]['ToRoomAssigned']],_0x5c6ce6=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xef)]],_0xfad789=[..._0x1e21d1[_0x3ec8b9(0x105)]['to_invoice']],_0xbd9c1e=[..._0x1e21d1[_0x3ec8b9(0x105)][_0x3ec8b9(0xa2)]];const _0x45934c=_0x4e1c3e['map'](_0x1c33ac=>{return _0x1c33ac={'product_name':_0x1c33ac};});_0x3105f6[_0x3ec8b9(0xeb)]((_0x4fd250,_0x5e2100)=>{var _0x594ce1=_0x3ec8b9;_0x45934c[_0x5e2100][_0x594ce1(0x157)]=_0x4fd250;}),_0x1888b5[_0x3ec8b9(0xeb)]((_0x19ffd8,_0x47bc39)=>{var _0x2251ee=_0x3ec8b9;_0x45934c[_0x47bc39][_0x2251ee(0x153)]=_0x19ffd8;}),_0xbd9c1e[_0x3ec8b9(0xeb)]((_0x3adb2a,_0x1b5338)=>{var _0x56372e=_0x3ec8b9;_0x45934c[_0x1b5338][_0x56372e(0xa2)]=_0x3adb2a;}),_0x5c6ce6[_0x3ec8b9(0xeb)]((_0x1b206a,_0x22e77)=>{var _0x512b97=_0x3ec8b9;_0x45934c[_0x22e77][_0x512b97(0xef)]=_0x1b206a;}),_0xfad789[_0x3ec8b9(0xeb)]((_0x588c9b,_0x4f94f2)=>{var _0x5e3287=_0x3ec8b9;_0x45934c[_0x4f94f2][_0x5e3287(0xe1)]=_0x588c9b;}),_0x131ae1['forEach']((_0x27ea98,_0x3b514a)=>{var _0x556e90=_0x3ec8b9;_0x45934c[_0x3b514a][_0x556e90(0x143)]=_0x27ea98;}),_0x1bf8f3[_0x3ec8b9(0xeb)]((_0x32645b,_0x1c6450)=>{var _0x36a723=_0x3ec8b9;_0x45934c[_0x1c6450][_0x36a723(0xb5)]=_0x32645b;}),_0x17825f['forEach']((_0x2b19a9,_0x4c42bd)=>{var _0x19249e=_0x3ec8b9;_0x45934c[_0x4c42bd][_0x19249e(0x10a)]=_0x2b19a9;}),_0x31b988[_0x3ec8b9(0xeb)]((_0x52a148,_0x23c17c)=>{var _0x409930=_0x3ec8b9;_0x45934c[_0x23c17c][_0x409930(0xbf)]=_0x52a148;}),_0x2cec3e[_0x3ec8b9(0xeb)]((_0x5680b3,_0x2c78d4)=>{var _0x2c5853=_0x3ec8b9;_0x45934c[_0x2c78d4][_0x2c5853(0xc3)]=_0x5680b3;}),_0x3cd34e[_0x3ec8b9(0xeb)]((_0xfb91ff,_0x411fa6)=>{var _0x543e3c=_0x3ec8b9;_0x45934c[_0x411fa6][_0x543e3c(0xd3)]=_0xfb91ff;}),_0x31045e['forEach']((_0x3f2998,_0x388519)=>{var _0x5374fd=_0x3ec8b9;_0x45934c[_0x388519][_0x5374fd(0xf7)]=_0x3f2998;}),_0x48cd6f['forEach']((_0x2038a7,_0x387fe0)=>{var _0x2ec646=_0x3ec8b9;_0x45934c[_0x387fe0][_0x2ec646(0x13d)]=_0x2038a7;}),_0x15307b[_0x3ec8b9(0xeb)]((_0x4fa5f7,_0x52979c)=>{var _0x4afb24=_0x3ec8b9;_0x45934c[_0x52979c][_0x4afb24(0x11f)]=_0x4fa5f7;}),_0x19a1ea['forEach']((_0x50ee63,_0x4026fc)=>{var _0x420cb2=_0x3ec8b9;_0x45934c[_0x4026fc][_0x420cb2(0x176)]=_0x50ee63;}),_0x284fee[_0x3ec8b9(0xeb)]((_0x1f3d73,_0x9a4bd5)=>{var _0x589fda=_0x3ec8b9;_0x45934c[_0x9a4bd5][_0x589fda(0x171)]=_0x1f3d73;}),_0x56ef79[_0x3ec8b9(0xeb)]((_0xfa8fac,_0x37ef7b)=>{var _0x1fbcd3=_0x3ec8b9;_0x45934c[_0x37ef7b][_0x1fbcd3(0xd3)]=_0xfa8fac;}),_0x3eda69['forEach']((_0x2b5705,_0x3afb58)=>{var _0x168dd8=_0x3ec8b9;_0x45934c[_0x3afb58][_0x168dd8(0x13a)]=_0x2b5705;}),_0x45166b[_0x3ec8b9(0xeb)]((_0x1ece3f,_0x3ed86e)=>{var _0x4be729=_0x3ec8b9;_0x45934c[_0x3ed86e][_0x4be729(0x10e)]=_0x1ece3f;}),_0x100d4e[_0x3ec8b9(0xeb)]((_0x5a0414,_0x19cc92)=>{var _0xcae1c0=_0x3ec8b9;_0x45934c[_0x19cc92][_0xcae1c0(0x121)]=_0x5a0414;}),_0x7c76c0[_0x3ec8b9(0xeb)]((_0x8fcb2f,_0x3b9dd5)=>{_0x45934c[_0x3b9dd5]['to_room_name']=_0x8fcb2f;});const _0xe2a64d=_0x45934c[_0x3ec8b9(0xa6)](_0x2a2b2f=>_0x2a2b2f[_0x3ec8b9(0x143)]!=='0'&&_0x2a2b2f['to_quantity']!==''||_0x2a2b2f[_0x3ec8b9(0xbb)]!=='0'&&_0x2a2b2f[_0x3ec8b9(0xbb)]!=='');var _0x4992d3=0x0;_0xe2a64d['forEach'](_0x44ef65=>{var _0xba319a=_0x3ec8b9;parseInt(_0x44ef65[_0xba319a(0x157)])<parseInt(_0x44ef65[_0xba319a(0x143)])&&_0x4992d3++;});if(_0x4992d3!=0x0)return _0x1e21d1['flash']('errors',_0x3ec8b9(0x128)),_0x2ebfc8[_0x3ec8b9(0xca)](_0x3ec8b9(0xfc));const _0x5ed2fc=new transfers_finished({'date':_0x1d92d1,'from_warehouse':_0x2cd743,'to_warehouse':_0x317f87,'product':_0xe2a64d,'note':_0x49d99d,'invoice':_0x383071}),_0x73da59=await _0x5ed2fc[_0x3ec8b9(0xa5)]();_0x1e21d1[_0x3ec8b9(0xc2)](_0x3ec8b9(0x13f),'Product\x20Transfer\x20successfully'),_0x2ebfc8[_0x3ec8b9(0xca)](_0x3ec8b9(0xd9)+_0x73da59['_id']);}catch(_0x421018){console['log'](_0x421018),_0x2ebfc8['status'](0xc8)[_0x3ec8b9(0xfa)]({'errorMessage':_0x421018[_0x3ec8b9(0x134)]});}}),router[a0_0x31e544(0x17b)](a0_0x31e544(0x15a),auth,async(_0x41246d,_0x4d5b3d)=>{var _0x5d45d1=a0_0x31e544;try{const {username:_0x1073fe,email:_0x56b1e3,role:_0x4f3abe}=_0x41246d[_0x5d45d1(0x158)],_0x1a1191=_0x41246d[_0x5d45d1(0x158)],_0xa6aaa8=await profile[_0x5d45d1(0x135)]({'email':_0x1a1191[_0x5d45d1(0x130)]}),_0x3c085e=await master_shop['find'](),_0x1577b2=await transfers_finished[_0x5d45d1(0x109)](_0x41246d[_0x5d45d1(0x12a)]['id']);let _0x41777d;if(_0x1a1191[_0x5d45d1(0xb7)]=='staff'){const _0x506e62=await staff[_0x5d45d1(0x135)]({'email':_0x1a1191[_0x5d45d1(0x130)]});_0x41777d=await warehouse[_0x5d45d1(0xd0)]({'status':'Enabled','name':_0x506e62['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x41777d=await warehouse['find']({'status':_0x5d45d1(0x12b),'warehouse_category':_0x5d45d1(0x156)});const _0x5029b9=await warehouse['aggregate']([{'$match':{'name':_0x1577b2[_0x5d45d1(0x120)],'warehouse_category':_0x5d45d1(0x156)}},{'$unwind':_0x5d45d1(0x123)},{'$group':{'_id':_0x5d45d1(0xce),'name':{'$first':_0x5d45d1(0xa8)},'product_stock':{'$first':_0x5d45d1(0xe2)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x5d45d1(0x162)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x5d45d1(0xee)},'primary_code':{'$first':_0x5d45d1(0x167)},'secondary_code':{'$first':_0x5d45d1(0xea)},'product_code':{'$first':_0x5d45d1(0xdb)},'storage':{'$first':_0x5d45d1(0x152)},'rack':{'$first':_0x5d45d1(0x151)},'expiry_date':{'$first':_0x5d45d1(0xe6)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':_0x5d45d1(0x117)},'warehoue_name':{'$first':_0x5d45d1(0xcc)}}}]),_0x38c52a=await product[_0x5d45d1(0xd0)]({});if(_0x3c085e[0x0][_0x5d45d1(0x15f)]=='English\x20(US)'){var _0x747942=users[_0x5d45d1(0xec)];console[_0x5d45d1(0x15b)](_0x747942);}else{if(_0x3c085e[0x0][_0x5d45d1(0x15f)]==_0x5d45d1(0x114))var _0x747942=users['Hindi'];else{if(_0x3c085e[0x0][_0x5d45d1(0x15f)]==_0x5d45d1(0x161))var _0x747942=users['German'];else{if(_0x3c085e[0x0]['language']=='Spanish')var _0x747942=users['Spanish'];else{if(_0x3c085e[0x0]['language']==_0x5d45d1(0x16f))var _0x747942=users[_0x5d45d1(0x16f)];else{if(_0x3c085e[0x0][_0x5d45d1(0x15f)]==_0x5d45d1(0x148))var _0x747942=users['Portuguese'];else{if(_0x3c085e[0x0][_0x5d45d1(0x15f)]==_0x5d45d1(0x100))var _0x747942=users['Chinese'];else{if(_0x3c085e[0x0][_0x5d45d1(0x15f)]==_0x5d45d1(0xa9))var _0x747942=users[_0x5d45d1(0xc1)];}}}}}}}_0x4d5b3d['render']('edit_transfer_finished_view',{'success':_0x41246d['flash'](_0x5d45d1(0x13f)),'errors':_0x41246d[_0x5d45d1(0xc2)](_0x5d45d1(0x164)),'role':_0x1a1191,'profile':_0xa6aaa8,'master_shop':_0x3c085e,'warehouse':_0x41777d,'transfer':_0x1577b2,'stock':_0x5029b9,'unit':_0x38c52a,'language':_0x747942});}catch(_0x420b80){console[_0x5d45d1(0x15b)](_0x420b80);}}),router['post'](a0_0x31e544(0x15a),auth,async(_0x2c22cc,_0x1c00c5)=>{var _0x216dec=a0_0x31e544;try{const {invoice:_0x2de632,from_warehouse:_0x31fb9b,FromRoom_name:_0x5853f7,to_warehouse:_0xb6a6de,ToRoom_name:_0x18e9cc}=_0x2c22cc[_0x216dec(0x105)],_0x2876d3=await transfers_finished[_0x216dec(0x109)](_0x2c22cc[_0x216dec(0x12a)]['id']),_0x38d3f4=_0x2876d3[_0x216dec(0x116)]['map'](async _0x45f655=>{var _0x3f87c6=_0x216dec;if(_0x45f655[_0x3f87c6(0x143)]>0x0){var _0x29c98b=await warehouse[_0x3f87c6(0x135)]({'name':_0x31fb9b,'room':_0x45f655[_0x3f87c6(0x121)],'warehouse_category':_0x3f87c6(0x156)});const _0x41b1e5=_0x29c98b[_0x3f87c6(0xd2)][_0x3f87c6(0x118)](_0x1bb984=>{var _0x3a1100=_0x3f87c6;_0x1bb984[_0x3a1100(0xcf)]==_0x45f655[_0x3a1100(0xcf)]&&_0x1bb984['bay']==_0x45f655['from_bay']&&_0x1bb984['expiry_date']==_0x45f655['expiry_date']&&_0x1bb984[_0x3a1100(0x171)]==_0x45f655['production_date']&&_0x1bb984[_0x3a1100(0x11f)]==_0x45f655[_0x3a1100(0x11f)]&&_0x1bb984[_0x3a1100(0x149)]==_0x45f655[_0x3a1100(0xef)]&&(console['log'](_0x3a1100(0xd5),_0x1bb984[_0x3a1100(0x104)]),typeof _0x45f655[_0x3a1100(0xa2)]==_0x3a1100(0x10d)?_0x1bb984[_0x3a1100(0x104)]=Math[_0x3a1100(0x147)](0x0,Math[_0x3a1100(0x16d)](_0x1bb984[_0x3a1100(0x104)])-Math[_0x3a1100(0x16d)](_0x45f655[_0x3a1100(0x143)])):_0x1bb984['product_stock']=Math[_0x3a1100(0x147)](0x0,Math[_0x3a1100(0x16d)](_0x1bb984[_0x3a1100(0x104)])-Math['abs'](_0x45f655[_0x3a1100(0x143)])));});}return _0x29c98b;});Promise[_0x216dec(0xdf)](_0x38d3f4)['then'](async _0x2838db=>{var _0x1a0a97=_0x216dec;try{for(const _0x56339f of _0x2838db){await _0x56339f[_0x1a0a97(0xa5)]();}const _0xfae43e=_0x2876d3[_0x1a0a97(0x116)][_0x1a0a97(0x118)](async _0x1dad5f=>{var _0x55d0c4=_0x1a0a97,_0x45f641=await warehouse[_0x55d0c4(0x135)]({'name':_0xb6a6de,'room':_0x1dad5f[_0x55d0c4(0x145)]});if(_0x1dad5f['to_quantity']>0x0){var _0x256f17=0x0;const _0x325894=_0x45f641[_0x55d0c4(0xd2)][_0x55d0c4(0x118)](_0x3c1628=>{var _0x1cb13f=_0x55d0c4;_0x3c1628[_0x1cb13f(0xcf)]==_0x1dad5f[_0x1cb13f(0xcf)]&&_0x3c1628[_0x1cb13f(0xfd)]==_0x1dad5f['to_bay']&&_0x3c1628[_0x1cb13f(0x176)]==_0x1dad5f[_0x1cb13f(0x176)]&&_0x3c1628[_0x1cb13f(0x171)]==_0x1dad5f['production_date']&&_0x3c1628[_0x1cb13f(0x11f)]==_0x1dad5f['batch_code']&&_0x3c1628[_0x1cb13f(0x149)]==_0x1dad5f[_0x1cb13f(0xe1)]&&(typeof _0x1dad5f['id_transaction']==_0x1cb13f(0x10d)?(console[_0x1cb13f(0x15b)]('here2',_0x3c1628[_0x1cb13f(0x104)]+_0x1cb13f(0xa0)+_0x3c1628['_id']+_0x1cb13f(0xb8)+Math[_0x1cb13f(0x16d)](_0x3c1628['product_stock'])+Math[_0x1cb13f(0x16d)](_0x1dad5f[_0x1cb13f(0x143)])),_0x3c1628['product_stock']=Math['abs'](_0x3c1628[_0x1cb13f(0x104)])+Math[_0x1cb13f(0x16d)](_0x1dad5f[_0x1cb13f(0x143)])):_0x3c1628[_0x1cb13f(0x104)]=Math[_0x1cb13f(0x16d)](_0x3c1628[_0x1cb13f(0x104)])+Math[_0x1cb13f(0x16d)](_0x1dad5f[_0x1cb13f(0x143)]),_0x256f17++);});_0x256f17=='0'&&(_0x45f641[_0x55d0c4(0xd2)]=_0x45f641['product_details'][_0x55d0c4(0x102)]({'product_name':_0x1dad5f['product_name'],'product_stock':_0x1dad5f[_0x55d0c4(0x143)],'bay':_0x1dad5f['to_bay'],'product_code':_0x1dad5f[_0x55d0c4(0xc3)],'primary_code':_0x1dad5f[_0x55d0c4(0x10a)],'secondary_code':_0x1dad5f['secondary_code'],'expiry_date':_0x1dad5f['expiry_date'],'production_date':_0x1dad5f['production_date'],'maxProducts':_0x1dad5f[_0x55d0c4(0xd3)],'batch_code':_0x1dad5f[_0x55d0c4(0x11f)],'secondary_unit':_0x1dad5f[_0x55d0c4(0x13d)],'unit':_0x1dad5f[_0x55d0c4(0xf7)],'maxProducts':_0x1dad5f[_0x55d0c4(0xd3)],'maxPerUnit':_0x1dad5f['maxPerUnit'],'invoice':_0x1dad5f[_0x55d0c4(0xe1)]}));}return _0x45f641;});Promise[_0x1a0a97(0xdf)](_0xfae43e)[_0x1a0a97(0xe8)](async _0x1a66a=>{var _0x1d04ef=_0x1a0a97;try{for(const _0x2d03ac of _0x1a66a){await warehouse['updateOne']({'_id':_0x2d03ac[_0x1d04ef(0xc4)]},{'$addToSet':{'product_details':{'$each':_0x2d03ac['product_details']}}});}_0x2876d3[_0x1d04ef(0x107)]='True';const _0x488075=await _0x2876d3[_0x1d04ef(0xa5)](),_0x5b9910=await master_shop[_0x1d04ef(0xd0)](),_0x38e41a=await email_settings[_0x1d04ef(0x135)](),_0x4eab39=await supervisor_settings[_0x1d04ef(0xd0)]();var _0x19dcdd=_0x2876d3[_0x1d04ef(0x116)],_0x5896fe='',_0x203c07;for(_0x203c07 in _0x19dcdd){var _0x2cbe9a='FG';_0x2876d3[_0x1d04ef(0xff)]==_0x1d04ef(0xe0)&&(_0x2cbe9a='DG'),_0x5896fe+='<tr>'+_0x1d04ef(0x9d)+_0x19dcdd[_0x203c07][_0x1d04ef(0xcf)]+_0x1d04ef(0xc9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19dcdd[_0x203c07][_0x1d04ef(0xc3)]+_0x1d04ef(0xc9)+_0x1d04ef(0x9d)+_0x19dcdd[_0x203c07][_0x1d04ef(0x143)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x19dcdd[_0x203c07][_0x1d04ef(0xf7)]+_0x1d04ef(0xc9)+_0x1d04ef(0x9d)+_0x19dcdd[_0x203c07][_0x1d04ef(0x13d)]+'</td>'+_0x1d04ef(0x9d)+_0x2876d3[_0x1d04ef(0xff)]+_0x1d04ef(0xc9)+_0x1d04ef(0x9d)+_0x19dcdd[_0x203c07][_0x1d04ef(0x145)]+_0x1d04ef(0xc9)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2cbe9a+_0x19dcdd[_0x203c07][_0x1d04ef(0xb5)]+'</td>'+_0x1d04ef(0x11d);}let _0x19a876=nodemailer[_0x1d04ef(0x13b)]({'host':_0x38e41a[_0x1d04ef(0x154)],'port':Number(_0x38e41a[_0x1d04ef(0xe4)]),'secure':![],'auth':{'user':_0x38e41a['email'],'pass':_0x38e41a['password']}}),_0x33a9af={'from':_0x38e41a['email'],'to':_0x4eab39[0x0][_0x1d04ef(0xb0)],'subject':_0x1d04ef(0xfe),'attachments':[{'filename':_0x1d04ef(0x103),'path':__dirname+_0x1d04ef(0x119)+_0x1d04ef(0x172)+_0x5b9910[0x0][_0x1d04ef(0x146)],'cid':'logo'}],'html':_0x1d04ef(0xf8)+'<html><head><title></title>'+_0x1d04ef(0x150)+_0x1d04ef(0x16c)+_0x1d04ef(0xc8)+'<div>'+_0x1d04ef(0x179)+_0x1d04ef(0xae)+_0x1d04ef(0x16c)+_0x1d04ef(0x15e)+_0x5b9910[0x0][_0x1d04ef(0xb2)]+_0x1d04ef(0x17d)+'</div>'+_0x1d04ef(0xae)+_0x1d04ef(0xba)+_0x1d04ef(0x16c)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x1d04ef(0xaa)+_0x2876d3[_0x1d04ef(0x149)]+'\x20'+_0x1d04ef(0x115)+'\x20Order\x20Date\x20:\x20'+_0x2876d3[_0x1d04ef(0x139)]+'\x20'+_0x1d04ef(0x16a)+_0x1d04ef(0x12f)+_0x1d04ef(0xae)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x1d04ef(0xf3)+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x1d04ef(0xbd)+_0x1d04ef(0xcd)+_0x1d04ef(0xa1)+_0x1d04ef(0xcb)+_0x1d04ef(0x159)+_0x1d04ef(0x14e)+_0x1d04ef(0x142)+_0x1d04ef(0x11d)+_0x1d04ef(0x108)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x5896fe+'\x20'+_0x1d04ef(0x124)+_0x1d04ef(0x111)+_0x1d04ef(0x16c)+_0x1d04ef(0x132)+_0x1d04ef(0x140)+_0x5b9910[0x0][_0x1d04ef(0xb2)]+_0x1d04ef(0x12f)+_0x1d04ef(0xae)+_0x1d04ef(0xae)+_0x1d04ef(0x131)};_0x19a876[_0x1d04ef(0xbc)](_0x33a9af,function(_0x51bf3d,_0x3fabf0){var _0x61cb49=_0x1d04ef;_0x51bf3d?(console['log'](_0x51bf3d),console[_0x61cb49(0x15b)](_0x61cb49(0xa4))):console[_0x61cb49(0x15b)](_0x61cb49(0xaf));}),_0x2c22cc[_0x1d04ef(0xc2)](_0x1d04ef(0x13f),_0x1d04ef(0xa7)),_0x1c00c5['redirect'](_0x1d04ef(0x110)+_0x488075[_0x1d04ef(0xc4)]);}catch(_0x4dcfd4){console[_0x1d04ef(0xb1)](_0x4dcfd4),_0x1c00c5[_0x1d04ef(0xf5)](0x1f4)[_0x1d04ef(0xfa)]({'error':_0x1d04ef(0x14a)});}})[_0x1a0a97(0x11b)](_0x3bf28c=>{var _0x4dc77b=_0x1a0a97;console['error'](_0x3bf28c),_0x1c00c5[_0x4dc77b(0xf5)](0x1f4)[_0x4dc77b(0xfa)]({'error':_0x4dc77b(0x141)});});}catch(_0x1bf98f){console[_0x1a0a97(0xb1)](_0x1bf98f),_0x1c00c5[_0x1a0a97(0xf5)](0x1f4)[_0x1a0a97(0xfa)]({'error':_0x1a0a97(0x16e)});}})['catch'](_0x32a800=>{var _0x482595=_0x216dec;console[_0x482595(0xb1)](_0x32a800),_0x1c00c5['status'](0x1f4)[_0x482595(0xfa)]({'error':_0x482595(0x141)});});}catch(_0x4d959b){_0x1c00c5[_0x216dec(0xfa)]({'message':_0x4d959b['message']});}});function a0_0x3f05(){var _0x15fd79=['</thead>','findById','primary_code','QA\x20Warehouse','$from_warehouse','undefined','prod_cat','Portuguese','/picking_list/PDF_transfer/','</table>','$product','$date','Hindi','<span\x20style=\x22float:\x20right;\x22>','product','$room','map','/../public','edit_transfer_finished','catch','11619629HDjYFh','</tr>','$product_details.pallet','batch_code','from_warehouse','from_room_name','../public/language/languages.json','$product_details','</tbody>','nodemailer','$invoice','push','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.invoice','params','Enabled','toString','/transfer_finished/view','$product_details.type','</h5>','email','</body></html>','<strong>\x20Regards\x20</strong>','product_date','message','findOne','$product_details.unit','6561284pplbWV','/CheckingWarehouse','date','maxPerUnit','createTransport','slice','secondary_unit','add_transfer_finished','success','<h5>','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','to_quantity','padStart','to_room_name','image','max','Portuguese\x20(BR)','invoice','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','string','../models/all_models','split','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','getDate','</head><body>','$product_details.rack','$product_details.storage','from_bay','host','$product_details.batch_code','Finished\x20Goods','from_quantity','user','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','/preview/:id','log','There\x27s\x20a\x20error\x20in\x20this\x20transaction','Ambient','<h2>\x20','language','/barcode_scanner3','German','$product_details.bin','225858jkgwXN','errors','primary_unit','$product_details.level','$product_details.primary_code','aggregate','to_prod_level','</span>','New_Qty_Converted','<div>','abs','An\x20error\x20occurred\x20while\x20saving\x20data.','French','warehouse','production_date','/upload/','from_prod_qty','Spanish','4364480ZAoWcC','expiry_date','from_room','prod_name','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','ToRoomAssigned','get','../middleware/auth','\x20</h2>','Rack\x201','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.production_date','MaxStocks_data','\x20<>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','id_transaction','$to_warehouse','Error\x20Occurs','save','filter','Transfer\x20Finalize\x20Successfully','$product_details.product_name','Arabic\x20(ae)','\x20Order\x20Number\x20:\x20','6OqZNQx','$product_details.isle','FROZEN\x20GOODS','</div>','Email\x20sent\x20successfully','FGSEmail','error','site_title','to_prod_qty','transfer_data','to_bay','/transfer/view','role','\x20<=>\x20','exports','<hr\x20class=\x22my-3\x22>','to_floorlevel','sendMail','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','MaxStocks_data2','secondary_code','note','Arabic','flash','product_code','_id','to_room','product_code3','Rack\x202','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</td>','redirect','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','$name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details._id','product_name','find','$product_details.maxProducts','product_details','maxProducts','render','here1','RoomAssigned','$product.from_room_name','transfer_finished','/transfer_finished/preview/','staff','$product_details.product_code','from_prod_level','post','/view/add_transfer','all','DRY\x20GOODS','To_invoice','$product_details.product_stock','/view','port','2098016xPWFnu','$product_details.expiry_date','251431lnardz','then','$product_details.secondary_unit','$product_details.secondary_code','forEach','English','$product_details.bay','$product_details.floorlevel','from_invoice','50339259FblJQu','$product_details.maxPerUnit','TRFF-','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Transfer\x20Edit\x20Successfully','status','length','unit','<!DOCTYPE\x20html>','random','json','46MmPoER','back','bay','Transfer\x20Mail','to_warehouse','Chinese','English\x20(US)','concat','Logo.png','product_stock','body','/view/:id','finalize'];a0_0x3f05=function(){return _0x15fd79;};return a0_0x3f05();}function BayBinSelected(_0xc1c8cd,_0x35dac5){var _0x215627=a0_0x31e544,_0x3c31ac=[];let _0x399d2e=[];var _0x466ac8=[];if(_0xc1c8cd==_0x215627(0xe0)){switch(_0x35dac5){case _0x215627(0x17e):_0x3c31ac=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x215627(0xc7):_0x3c31ac=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x466ac8=['DG'];}else{if(_0xc1c8cd==_0x215627(0xad)){switch(_0x35dac5){case _0x215627(0x17e):_0x3c31ac=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x215627(0xc7):_0x3c31ac=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x466ac8=['FG'];}}return{'levels':_0x3c31ac,'identify':_0x466ac8};}router['get'](a0_0x31e544(0x106),auth,async(_0x1d3417,_0x3c516b)=>{var _0x2002b0=a0_0x31e544;try{const {username:_0x3ebb05,email:_0x3a4477,role:_0x4ff6bc}=_0x1d3417[_0x2002b0(0x158)],_0x24e368=_0x1d3417[_0x2002b0(0x158)],_0x30aa21=await profile[_0x2002b0(0x135)]({'email':_0x24e368[_0x2002b0(0x130)]}),_0x3978b9=await master_shop[_0x2002b0(0xd0)](),_0x3f570a=await transfers_finished[_0x2002b0(0x109)](_0x1d3417['params']['id']);let _0x51572d=new Date(_0x3f570a['expiry_date']),_0x406b6a=('0'+_0x51572d[_0x2002b0(0x14f)]())[_0x2002b0(0x13c)](-0x2),_0x5d98fc=('0'+(_0x51572d['getMonth']()+0x1))[_0x2002b0(0x13c)](-0x2),_0x4f386b=_0x51572d['getFullYear'](),_0x1f330d=_0x4f386b+'-'+_0x5d98fc+'-'+_0x406b6a,_0x2fea8e;if(_0x24e368[_0x2002b0(0xb7)]==_0x2002b0(0xda)){const _0x51b237=await staff[_0x2002b0(0x135)]({'email':_0x24e368['email']});_0x2fea8e=await warehouse['find']({'status':_0x2002b0(0x12b),'name':_0x51b237[_0x2002b0(0x170)],'warehouse_category':'Finished\x20Goods'});}else _0x2fea8e=await warehouse[_0x2002b0(0xd0)]({'status':_0x2002b0(0x12b),'warehouse_category':_0x2002b0(0x156)});const _0x387ce1=await warehouse[_0x2002b0(0x168)]([{'$match':{'name':_0x3f570a[_0x2002b0(0x120)],'room':_0x3f570a[_0x2002b0(0x177)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x2002b0(0xce),'name':{'$first':_0x2002b0(0xa8)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x2002b0(0xed)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x2002b0(0x12e)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x2002b0(0x167)},'secondary_code':{'$first':_0x2002b0(0xea)},'product_code':{'$first':_0x2002b0(0xdb)},'storage':{'$first':_0x2002b0(0x152)},'rack':{'$first':'$product_details.rack'}}}]);var _0x1487d8=[0x1,0x2,0x3,0x4],_0xe52242=['A','B','C','D','E','F','G','H','I','J'],_0x30c163=[_0x2002b0(0x15d),'Enclosed'];const _0x1cbbd6=await product['find']({}),_0x45afec=BayBinSelected(_0x3f570a[_0x2002b0(0xff)],_0x3f570a[_0x2002b0(0xc5)]);if(_0x3978b9[0x0][_0x2002b0(0x15f)]=='English\x20(US)'){var _0x389125=users[_0x2002b0(0xec)];console[_0x2002b0(0x15b)](_0x389125);}else{if(_0x3978b9[0x0][_0x2002b0(0x15f)]==_0x2002b0(0x114))var _0x389125=users[_0x2002b0(0x114)];else{if(_0x3978b9[0x0][_0x2002b0(0x15f)]=='German')var _0x389125=users[_0x2002b0(0x161)];else{if(_0x3978b9[0x0][_0x2002b0(0x15f)]=='Spanish')var _0x389125=users['Spanish'];else{if(_0x3978b9[0x0][_0x2002b0(0x15f)]=='French')var _0x389125=users[_0x2002b0(0x16f)];else{if(_0x3978b9[0x0][_0x2002b0(0x15f)]=='Portuguese\x20(BR)')var _0x389125=users[_0x2002b0(0x10f)];else{if(_0x3978b9[0x0][_0x2002b0(0x15f)]=='Chinese')var _0x389125=users[_0x2002b0(0x100)];else{if(_0x3978b9[0x0][_0x2002b0(0x15f)]==_0x2002b0(0xa9))var _0x389125=users[_0x2002b0(0xc1)];}}}}}}}_0x3c516b[_0x2002b0(0xd4)](_0x2002b0(0x11a),{'success':_0x1d3417['flash'](_0x2002b0(0x13f)),'errors':_0x1d3417[_0x2002b0(0xc2)](_0x2002b0(0x164)),'role':_0x24e368,'profile':_0x30aa21,'master_shop':_0x3978b9,'warehouse':_0x2fea8e,'transfer':_0x3f570a,'stock':_0x387ce1,'unit':_0x1cbbd6,'language':_0x389125,'levels':_0x1487d8,'Isle':_0xe52242,'rooms_data':_0x30c163,'ed_fullDate':_0x1f330d,'dataSelected':_0x45afec});}catch(_0x1686c8){console['log'](_0x1686c8);}}),router[a0_0x31e544(0xdd)](a0_0x31e544(0x106),auth,async(_0x4a208e,_0x502612)=>{var _0x50282a=a0_0x31e544;try{const _0x1d651d=_0x4a208e[_0x50282a(0x12a)]['id'];console[_0x50282a(0x15b)](_0x4a208e['body']);const _0x31802e=await transfers_finished[_0x50282a(0x109)](_0x1d651d);console[_0x50282a(0x15b)](_0x50282a(0xb4),_0x31802e);const {date:_0x1202ce,from_warehouse:_0x299e6b,FromRoom_name:_0x449679,to_warehouse:_0x1c8b5e,ToRoom_name:_0x4a0418,prod_name:_0x38434b,from_prod_qty:_0x36947f,from_prod_level:_0x5c521f,from_prod_isle:_0x1bd1bc,from_prod_pallet:_0x217d34,to_prod_qty:_0x559177,to_prod_level:_0x417c04,to_prod_isle:_0x3d79cb,to_prod_pallet:_0x5f00c1,primary_code:_0x3bbcb1,secondary_code:_0x4a8c81,product_code3:_0x20a15f,note:_0x32e038,invoice:_0x2abf55,expiry_date:_0x145aed}=_0x4a208e[_0x50282a(0x105)];if(typeof _0x38434b==_0x50282a(0x14b))var _0x1d364d=[_0x4a208e['body'][_0x50282a(0x178)]],_0x3c2ba2=[_0x4a208e[_0x50282a(0x105)]['from_prod_qty']],_0x297182=[_0x4a208e[_0x50282a(0x105)][_0x50282a(0xdc)]],_0x4677f1=[_0x4a208e[_0x50282a(0x105)][_0x50282a(0xb3)]],_0x54f5ee=[_0x4a208e[_0x50282a(0x105)][_0x50282a(0x169)]],_0x1a5dfb=[_0x4a208e[_0x50282a(0x105)]['primary_code']],_0x2c0c3f=[_0x4a208e[_0x50282a(0x105)][_0x50282a(0xbf)]],_0x1a8693=[_0x4a208e['body'][_0x50282a(0xc6)]],_0xcef62b=[_0x4a208e[_0x50282a(0x105)][_0x50282a(0xbe)]],_0x13d3ac=[_0x4a208e['body'][_0x50282a(0xf7)]],_0x302c82=[_0x4a208e[_0x50282a(0x105)][_0x50282a(0x13d)]],_0x52cf33=[_0x4a208e[_0x50282a(0x105)][_0x50282a(0x11f)]],_0xedb9c6=[_0x4a208e['body'][_0x50282a(0x176)]];else var _0x1d364d=[..._0x4a208e[_0x50282a(0x105)]['prod_name']],_0x3c2ba2=[..._0x4a208e[_0x50282a(0x105)][_0x50282a(0x173)]],_0x297182=[..._0x4a208e['body'][_0x50282a(0xdc)]],_0x4677f1=[..._0x4a208e[_0x50282a(0x105)][_0x50282a(0xb3)]],_0x54f5ee=[..._0x4a208e[_0x50282a(0x105)][_0x50282a(0x169)]],_0x1a5dfb=[..._0x4a208e[_0x50282a(0x105)][_0x50282a(0x10a)]],_0x2c0c3f=[..._0x4a208e[_0x50282a(0x105)][_0x50282a(0xbf)]],_0x1a8693=[..._0x4a208e['body'][_0x50282a(0xc6)]],_0xcef62b=[..._0x4a208e[_0x50282a(0x105)]['MaxStocks_data2']],_0x13d3ac=[..._0x4a208e[_0x50282a(0x105)]['unit']],_0x302c82=[..._0x4a208e[_0x50282a(0x105)][_0x50282a(0x13d)]],_0x52cf33=[..._0x4a208e[_0x50282a(0x105)][_0x50282a(0x11f)]],_0xedb9c6=[..._0x4a208e[_0x50282a(0x105)]['expiry_date']];const _0x281cb7=_0x1d364d[_0x50282a(0x118)](_0x117b84=>{return _0x117b84={'product_name':_0x117b84};});_0x3c2ba2['forEach']((_0x4fb7ad,_0x539b60)=>{_0x281cb7[_0x539b60]['from_quantity']=_0x4fb7ad;}),_0x297182[_0x50282a(0xeb)]((_0x215db1,_0x192578)=>{var _0x31de85=_0x50282a;_0x281cb7[_0x192578][_0x31de85(0x153)]=_0x215db1;}),_0x4677f1['forEach']((_0x33902c,_0x80cae0)=>{var _0x3f0ac1=_0x50282a;_0x281cb7[_0x80cae0][_0x3f0ac1(0x143)]=_0x33902c;}),_0x54f5ee[_0x50282a(0xeb)]((_0x4f6762,_0x462705)=>{var _0x57f987=_0x50282a;_0x281cb7[_0x462705][_0x57f987(0xb5)]=_0x4f6762;}),_0x1a5dfb[_0x50282a(0xeb)]((_0x4b5d91,_0x10886e)=>{_0x281cb7[_0x10886e]['primary_code']=_0x4b5d91;}),_0x2c0c3f[_0x50282a(0xeb)]((_0x3ee1d7,_0x2989ee)=>{_0x281cb7[_0x2989ee]['secondary_code']=_0x3ee1d7;}),_0x1a8693[_0x50282a(0xeb)]((_0x37de87,_0x381351)=>{var _0x4fe90b=_0x50282a;_0x281cb7[_0x381351][_0x4fe90b(0xc3)]=_0x37de87;}),_0xcef62b['forEach']((_0x82cc3f,_0x2f5467)=>{var _0x2923ca=_0x50282a;_0x281cb7[_0x2f5467][_0x2923ca(0xd3)]=_0x82cc3f;}),_0x13d3ac[_0x50282a(0xeb)]((_0x4c1216,_0x116218)=>{var _0x40dc12=_0x50282a;_0x281cb7[_0x116218][_0x40dc12(0xf7)]=_0x4c1216;}),_0x302c82[_0x50282a(0xeb)]((_0x3721f9,_0x2ec70d)=>{var _0x386a56=_0x50282a;_0x281cb7[_0x2ec70d][_0x386a56(0x13d)]=_0x3721f9;}),_0x52cf33[_0x50282a(0xeb)]((_0x216a4f,_0x215b98)=>{_0x281cb7[_0x215b98]['batch_code']=_0x216a4f;}),_0xedb9c6[_0x50282a(0xeb)]((_0x276039,_0x15e34b)=>{_0x281cb7[_0x15e34b]['expiry_date']=_0x276039;});const _0x472c1f=_0x281cb7[_0x50282a(0xa6)](_0x2a35f2=>_0x2a35f2[_0x50282a(0x143)]!=='0'&&_0x2a35f2[_0x50282a(0x143)]!==''||_0x2a35f2[_0x50282a(0xbb)]!=='0'&&_0x2a35f2[_0x50282a(0xbb)]!=='');var _0x37796c=0x0;_0x472c1f[_0x50282a(0xeb)](_0x2248a=>{var _0x24eae3=_0x50282a;parseInt(_0x2248a[_0x24eae3(0x157)])<parseInt(_0x2248a[_0x24eae3(0x143)])&&_0x37796c++;});if(_0x37796c!=0x0)return _0x4a208e[_0x50282a(0xc2)](_0x50282a(0x164),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x502612['redirect']('back');const _0x255d83=await warehouse[_0x50282a(0x135)]({'name':_0x31802e[_0x50282a(0x120)],'room':_0x31802e[_0x50282a(0x177)]});_0x31802e[_0x50282a(0x116)][_0x50282a(0xeb)](_0x7c06ff=>{var _0x116070=_0x50282a;if(_0x7c06ff[_0x116070(0x143)]>0x0){const _0x50bf42=_0x255d83[_0x116070(0xd2)][_0x116070(0x118)](_0x4019ff=>{var _0x39c4a1=_0x116070;_0x4019ff[_0x39c4a1(0xcf)]==_0x7c06ff['product_name']&&_0x4019ff[_0x39c4a1(0xfd)]==_0x7c06ff[_0x39c4a1(0x153)]&&(_0x4019ff[_0x39c4a1(0x104)]=parseInt(_0x4019ff[_0x39c4a1(0x104)])+parseInt(_0x7c06ff[_0x39c4a1(0x143)]));});}}),await _0x255d83[_0x50282a(0xa5)]();const _0x50880d=await warehouse[_0x50282a(0x135)]({'name':_0x31802e[_0x50282a(0xff)],'room':_0x31802e[_0x50282a(0xc5)]});_0x31802e[_0x50282a(0x116)][_0x50282a(0xeb)](_0x420d52=>{var _0x4cafe2=_0x50282a;if(_0x420d52[_0x4cafe2(0x143)]>0x0){const _0x188d16=_0x50880d['product_details']['map'](_0x17c684=>{var _0x217831=_0x4cafe2;_0x17c684['product_name']==_0x420d52[_0x217831(0xcf)]&&_0x17c684[_0x217831(0xfd)]==_0x420d52['to_bay']&&(_0x17c684['product_stock']=parseInt(_0x17c684['product_stock'])-parseInt(_0x420d52[_0x217831(0x143)]));});}}),await _0x50880d[_0x50282a(0xa5)](),_0x31802e[_0x50282a(0x139)]=_0x1202ce,_0x31802e[_0x50282a(0x120)]=_0x299e6b,_0x31802e[_0x50282a(0xff)]=_0x1c8b5e,_0x31802e[_0x50282a(0x116)]=_0x472c1f,_0x31802e[_0x50282a(0xc0)]=_0x32e038,_0x31802e[_0x50282a(0x149)]=_0x2abf55;const _0x2a59d1=await _0x31802e[_0x50282a(0xa5)](),_0x1ec1e=await warehouse[_0x50282a(0x135)]({'name':_0x299e6b,'room':_0x449679});_0x2a59d1['product']['forEach'](_0x17c4b8=>{var _0x1de259=_0x50282a;if(_0x17c4b8['to_quantity']>0x0){const _0xa46402=_0x1ec1e[_0x1de259(0xd2)][_0x1de259(0x118)](_0xca8cc0=>{var _0x1640d2=_0x1de259;_0xca8cc0[_0x1640d2(0xcf)]==_0x17c4b8[_0x1640d2(0xcf)]&&_0xca8cc0[_0x1640d2(0xfd)]==_0x17c4b8[_0x1640d2(0x153)]&&(_0xca8cc0[_0x1640d2(0x104)]=parseInt(_0xca8cc0[_0x1640d2(0x104)])-parseInt(_0x17c4b8['to_quantity']));});}}),await _0x1ec1e[_0x50282a(0xa5)]();const _0x186f40=await warehouse['findOne']({'name':_0x1c8b5e,'room':_0x4a0418});_0x2a59d1['product'][_0x50282a(0xeb)](_0x41eacc=>{var _0x4f1a71=_0x50282a;if(_0x41eacc[_0x4f1a71(0x143)]>0x0){var _0x545a84=0x0;const _0x353a62=_0x186f40['product_details'][_0x4f1a71(0x118)](_0x57f817=>{var _0x2935b5=_0x4f1a71;_0x57f817[_0x2935b5(0xcf)]==_0x41eacc['product_name']&&_0x57f817[_0x2935b5(0xfd)]==_0x41eacc[_0x2935b5(0xb5)]&&(_0x57f817['product_stock']=parseInt(_0x57f817['product_stock'])+parseInt(_0x41eacc[_0x2935b5(0x143)]),_0x545a84++);});_0x545a84=='0'&&(_0x186f40['product_details']=_0x186f40[_0x4f1a71(0xd2)]['concat']({'product_name':_0x41eacc[_0x4f1a71(0xcf)],'product_stock':_0x41eacc[_0x4f1a71(0x143)],'bay':_0x41eacc[_0x4f1a71(0xb5)],'product_code':_0x41eacc[_0x4f1a71(0xc3)],'primary_code':_0x41eacc['primary_code'],'secondary_code':_0x41eacc['secondary_code'],'maxProducts':_0x41eacc['maxProducts']}));}}),await _0x186f40[_0x50282a(0xa5)](),_0x4a208e[_0x50282a(0xc2)](_0x50282a(0x13f),_0x50282a(0xf4)),_0x502612[_0x50282a(0xca)](_0x50282a(0x12d));}catch(_0x1aecb4){console[_0x50282a(0x15b)](_0x1aecb4);}}),router[a0_0x31e544(0xdd)]('/barcode_scanner',async(_0x2a5f16,_0x572743)=>{var _0x1ec04e=a0_0x31e544;const {FromWareHouse:_0x3b15b9,FromRoom:_0x342bc7,ToWarehouse:_0x398ac6,ToRoom:_0x1140d5,primary_code:_0x52c6a2,Roomslist:_0x25637f}=_0x2a5f16[_0x1ec04e(0x105)],_0xeef168=_0x25637f[_0x1ec04e(0x14d)](','),_0x2d9d2f=[];async function _0x5c7f69(_0x25c772){var _0x44ec98=_0x1ec04e;const _0x2fcede=await warehouse[_0x44ec98(0x168)]([{'$match':{'name':_0x3b15b9,'room':_0x25c772}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x52c6a2}},{'$group':{'_id':_0x44ec98(0xce),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x44ec98(0x167)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x44ec98(0xdb)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x44ec98(0x162)},'type':{'$first':_0x44ec98(0x12e)},'pallet':{'$first':_0x44ec98(0xee)},'unit':{'$first':_0x44ec98(0x136)},'secondary_unit':{'$first':_0x44ec98(0xe9)},'storage':{'$first':_0x44ec98(0x152)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x44ec98(0xe6)},'production_date':{'$first':_0x44ec98(0x9e)},'batch_code':{'$first':_0x44ec98(0x155)},'maxPerUnit':{'$first':_0x44ec98(0xf1)},'roomNamed':{'$first':_0x44ec98(0x117)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x44ec98(0x129)}}}]),_0xfe054b=await warehouse['aggregate']([{'$match':{'name':_0x3b15b9,'room':_0x25c772}},{'$unwind':_0x44ec98(0x123)},{'$match':{'product_details.secondary_code':_0x52c6a2}},{'$group':{'_id':_0x44ec98(0xce),'name':{'$first':_0x44ec98(0xa8)},'instock':{'$first':_0x44ec98(0xe2)},'primary_code':{'$first':_0x44ec98(0x167)},'secondary_code':{'$first':_0x44ec98(0xea)},'product_code':{'$first':_0x44ec98(0xdb)},'level':{'$first':_0x44ec98(0xed)},'isle':{'$first':_0x44ec98(0x162)},'type':{'$first':_0x44ec98(0x12e)},'pallet':{'$first':_0x44ec98(0xee)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x44ec98(0xe9)},'storage':{'$first':_0x44ec98(0x152)},'rack':{'$first':_0x44ec98(0x151)},'expiry_date':{'$first':_0x44ec98(0xe6)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x44ec98(0xf1)},'roomNamed':{'$first':_0x44ec98(0x117)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x44ec98(0x129)}}}]);if(_0x2fcede['length']>0x0)_0x2d9d2f[_0x44ec98(0x127)](_0x2fcede);else _0xfe054b['length']>0x0&&_0x2d9d2f[_0x44ec98(0x127)](_0xfe054b);}const _0xac9276=_0xeef168[_0x1ec04e(0x118)](_0x44d30e=>_0x5c7f69(_0x44d30e));await Promise['all'](_0xac9276),_0x572743[_0x1ec04e(0xfa)](_0x2d9d2f);}),router[a0_0x31e544(0xdd)]('/barcode_scanner2',async(_0x7ac41d,_0x308219)=>{var _0x3d3bb4=a0_0x31e544;try{const {FromWareHouse:_0x889f5f,FromRoom:_0x5d6ad4,ToWarehouse:_0x16a29b,ToRoom:_0x1ce83d,secondary_code:_0x14ecde}=_0x7ac41d['body'],_0xdfd200=await warehouse['aggregate']([{'$match':{'name':_0x889f5f}},{'$unwind':_0x3d3bb4(0x123)},{'$match':{'product_details.secondary_code':_0x14ecde}},{'$group':{'_id':_0x3d3bb4(0xce),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x3d3bb4(0x167)},'secondary_code':{'$first':_0x3d3bb4(0xea)},'product_code':{'$first':_0x3d3bb4(0xdb)},'instock':{'$first':_0x3d3bb4(0xe2)},'warehouse':{'$first':_0x3d3bb4(0xcc)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3d3bb4(0xac)},'pallet':{'$first':_0x3d3bb4(0x11e)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3d3bb4(0x9e)}}}]);_0x308219['status'](0xc8)[_0x3d3bb4(0xfa)](_0xdfd200);}catch(_0x5ba4f3){_0x308219[_0x3d3bb4(0xf5)](0x194)[_0x3d3bb4(0xfa)]({'message':_0x5ba4f3['message']});}}),router[a0_0x31e544(0xdd)](a0_0x31e544(0x160),async(_0x2dcbd4,_0x3c857a)=>{var _0x547fdf=a0_0x31e544;try{const {FromWareHouse:_0x34b273,FromRoom:_0x4f108e,ToWarehouse:_0x3dc491,ToRoom:_0x477620,product_code:_0x637a96}=_0x2dcbd4['body'],_0x1d0ec4=await warehouse[_0x547fdf(0x168)]([{'$match':{'name':_0x34b273}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x637a96}},{'$group':{'_id':_0x547fdf(0xce),'name':{'$first':_0x547fdf(0xa8)},'primary_code':{'$first':_0x547fdf(0x167)},'secondary_code':{'$first':_0x547fdf(0xea)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x547fdf(0xe2)},'warehouse':{'$first':_0x547fdf(0xcc)},'level':{'$first':_0x547fdf(0x166)},'isle':{'$first':_0x547fdf(0xac)},'pallet':{'$first':_0x547fdf(0x11e)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x547fdf(0x136)}}}]);_0x3c857a['status'](0xc8)['json'](_0x1d0ec4);}catch(_0x3cc922){_0x3c857a[_0x547fdf(0xf5)](0x194)['json']({'message':_0x3cc922['message']});}}),router[a0_0x31e544(0xdd)](a0_0x31e544(0x138),async(_0x2ece63,_0x1f488f)=>{var _0x4ff69f=a0_0x31e544;const {productCode:_0x3a3e45,bay:_0x1cfb00,warehouses:_0x336c8e,room:_0x3880e6}=_0x2ece63[_0x4ff69f(0x105)];console[_0x4ff69f(0x15b)](_0x2ece63[_0x4ff69f(0x105)]);try{const _0x17d209=await warehouse[_0x4ff69f(0x168)]([{'$match':{'name':_0x336c8e,'room':_0x3880e6}},{'$unwind':_0x4ff69f(0x123)},{'$match':{'product_details.bay':parseInt(_0x1cfb00)}},{'$group':{'_id':_0x4ff69f(0xce),'name':{'$first':_0x4ff69f(0xa8)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x4ff69f(0xed)},'maxProducts':{'$first':_0x4ff69f(0xd1)}}}]);_0x1f488f[_0x4ff69f(0xf5)](0xc8)[_0x4ff69f(0xfa)](_0x17d209);}catch(_0x56d5af){_0x1f488f['status'](0x194)[_0x4ff69f(0xfa)]({'message':_0x56d5af[_0x4ff69f(0x134)]});}}),module[a0_0x31e544(0xb9)]=router;