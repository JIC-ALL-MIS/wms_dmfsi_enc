var a0_0x383e19=a0_0x335f;(function(_0x370d8b,_0x2d8158){var _0xb852a0=a0_0x335f,_0x560b5d=_0x370d8b();while(!![]){try{var _0x2bc7ae=-parseInt(_0xb852a0(0x1fc))/0x1*(-parseInt(_0xb852a0(0x1fb))/0x2)+parseInt(_0xb852a0(0x1c4))/0x3*(-parseInt(_0xb852a0(0x1f8))/0x4)+-parseInt(_0xb852a0(0x1ce))/0x5*(-parseInt(_0xb852a0(0x18b))/0x6)+parseInt(_0xb852a0(0x193))/0x7*(-parseInt(_0xb852a0(0x1ab))/0x8)+parseInt(_0xb852a0(0x199))/0x9+parseInt(_0xb852a0(0x1d1))/0xa*(-parseInt(_0xb852a0(0x1a8))/0xb)+parseInt(_0xb852a0(0x197))/0xc*(parseInt(_0xb852a0(0x1f6))/0xd);if(_0x2bc7ae===_0x2d8158)break;else _0x560b5d['push'](_0x560b5d['shift']());}catch(_0x4b7850){_0x560b5d['push'](_0x560b5d['shift']());}}}(a0_0x3988,0x1a06d));const express=require(a0_0x383e19(0x1b8)),app=express(),router=express[a0_0x383e19(0x13e)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x383e19(0x210)),auth=require(a0_0x383e19(0x1e4)),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');function a0_0x3988(){var _0x2411c8=['$product','max','expiry_date','here2','ToRoomAssigned','from_warehouse','getMonth','</span>','string','$product_details.unit','toString','then','_id','createTransport','batch_code','</body></html>','$product_details.product_name','render','role','product_name','edit_transfer_finished','\x20Order\x20Number\x20:\x20','$product_details.maxProducts','Enclosed','\x20</h2>','An\x20error\x20occurred\x20while\x20saving\x20data.','findById','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','maxPerUnit','$product_details.level','Transfer\x20Finalize\x20Successfully','Transfer\x20Mail','production_date','to_bay','$product_details.invoice','product_code3','</h5>','<span\x20style=\x22float:\x20right;\x22>','json','$product_details.floorlevel','language','from_prod_level','error','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','</tbody>','secondary_code','MaxStocks_data2','$finalize','add_transfer_finished','48yQfkct','$_id','push','/view/add_transfer','Arabic','from_room_name','/view/:id','from_room','105SbRvzB','\x20<>\x20','site_title','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','41316Izljzg','/CheckingWarehouse','528417DUOoGE','MaxStocks_data','$product_details.production_date','slice','Finished\x20Goods','filter','aggregate','$product_details.batch_code','/transfer_finished/preview/','Product\x20Transfer\x20successfully','findOne','to_prod_qty','$product.to_room_name','An\x20error\x20occurred.','to_prod_level','58597wEldiD','$product_details.primary_code','staff','109360zhXSBk','bay','abs','host','port','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','<tbody\x20style=\x22text-align:\x20center;\x22>','$invoice','$product_details','<!DOCTYPE\x20html>','Email\x20sent\x20successfully','/preview/:id','get','express','French','\x20<=>\x20','forEach','getDate','transfer_data','password','catch','prod_cat','product','floor','prod_name','3dSWKic','$product_details._id','primary_unit','Portuguese\x20(BR)','find','$product_details.product_stock','user','map','\x20Order\x20Date\x20:\x20','split','80335qvCiNN','body','$product_details.bin','190xZpPBn','Rack\x201','id_transaction','product_stock','to_floorlevel','$name','back','exports','padStart','Arabic\x20(ae)','QA\x20Warehouse','/view','$room','$product_details.type','finalize','Hindi','email','to_quantity','/barcode_scanner','../middleware/auth','to_warehouse','product_details','primary_code','params','Spanish','<h5>','errors','all','$product_details.rack','</thead>','/../public','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','maxProducts','New_Qty_Converted','Chinese','concat','$date','1196NjaabN','TRFF-','461072AJNlks','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</td>','118QzlPci','409VqtsNe','secondary_unit','from_invoice','<table\x20style=\x22width:\x20100%\x20!important;\x22>','invoice','to_room_name','here1','$product_details.maxPerUnit','warehouse','Rack\x202','Transfer\x20Edit\x20Successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','flash','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','</tr>','product_date','success','$product_details.pallet','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','unit','../models/all_models','$product_details.product_code','log','from_quantity','English\x20(US)','to_invoice','length','save','<div>','Router','German','post','$product_details.bay','English','from_bay','$product_details.secondary_unit','status','<tr>','from_prod_qty','sendMail','message','Enabled','FGSEmail','$product_details.secondary_code','$product_details.isle','</div>','product_code','image','Portuguese','Ambient','updateOne','</head><body>','$product_details.storage','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','redirect','RoomAssigned','True'];a0_0x3988=function(){return _0x2411c8;};return a0_0x3988();}router[a0_0x383e19(0x1b7)](a0_0x383e19(0x1dc),auth,async(_0x568ce5,_0x38bac8)=>{var _0x46340d=a0_0x383e19;try{const {username:_0xa6ab85,email:_0x3be1d4,role:_0x44d4df}=_0x568ce5[_0x46340d(0x1ca)],_0x5b8ecc=_0x568ce5['user'],_0x4dd572=await profile['findOne']({'email':_0x5b8ecc[_0x46340d(0x1e1)]}),_0x3a94be=await master_shop[_0x46340d(0x1c8)]();let _0x2aa078;if(_0x5b8ecc[_0x46340d(0x16c)]==_0x46340d(0x1aa)){const _0x6f7de9=await staff['findOne']({'email':_0x5b8ecc[_0x46340d(0x1e1)]});_0x2aa078=await transfers_finished[_0x46340d(0x1c8)]({'from_warehouse':_0x6f7de9[_0x46340d(0x204)]});}else _0x2aa078=await transfers_finished['aggregate']([{'$unwind':_0x46340d(0x15a)},{'$group':{'_id':_0x46340d(0x18c),'invoice':{'$first':_0x46340d(0x1b2)},'date':{'$first':_0x46340d(0x1f5)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':'$product.from_room_name'},'to_room_name':{'$addToSet':_0x46340d(0x1a5)},'finalize':{'$first':_0x46340d(0x189)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3a94be[0x0]['language']==_0x46340d(0x214))var _0x39a478=users[_0x46340d(0x142)];else{if(_0x3a94be[0x0][_0x46340d(0x182)]==_0x46340d(0x1e0))var _0x39a478=users['Hindi'];else{if(_0x3a94be[0x0]['language']=='German')var _0x39a478=users[_0x46340d(0x13f)];else{if(_0x3a94be[0x0][_0x46340d(0x182)]==_0x46340d(0x1e9))var _0x39a478=users[_0x46340d(0x1e9)];else{if(_0x3a94be[0x0][_0x46340d(0x182)]==_0x46340d(0x1b9))var _0x39a478=users[_0x46340d(0x1b9)];else{if(_0x3a94be[0x0][_0x46340d(0x182)]=='Portuguese\x20(BR)')var _0x39a478=users[_0x46340d(0x151)];else{if(_0x3a94be[0x0]['language']=='Chinese')var _0x39a478=users[_0x46340d(0x1f3)];else{if(_0x3a94be[0x0]['language']==_0x46340d(0x1da))var _0x39a478=users[_0x46340d(0x18f)];}}}}}}}_0x38bac8[_0x46340d(0x16b)]('transfer_finished',{'success':_0x568ce5[_0x46340d(0x208)](_0x46340d(0x20c)),'errors':_0x568ce5[_0x46340d(0x208)]('errors'),'role':_0x5b8ecc,'profile':_0x4dd572,'master_shop':_0x3a94be,'transfer':_0x2aa078,'language':_0x39a478});}catch(_0x497c8c){console[_0x46340d(0x212)](_0x497c8c);}});async function getRandom8DigitNumber(){var _0x5110fc=a0_0x383e19;const _0x47dea4=0x989680,_0x4591d4=0x5f5e0ff,_0x2d26fb=Math[_0x5110fc(0x1c2)](Math['random']()*(_0x4591d4-_0x47dea4+0x1))+_0x47dea4;var _0x3cc6ea;const _0x3ba995=await transfers_finished[_0x5110fc(0x1a3)]({'invoice':_0x5110fc(0x1f7)+_0x2d26fb});return _0x3ba995&&_0x3ba995[_0x5110fc(0x216)]>0x0?_0x3cc6ea=_0x5110fc(0x1f7)+_0x2d26fb:_0x3cc6ea=_0x5110fc(0x1f7)+_0x2d26fb,_0x3cc6ea;}function a0_0x335f(_0x4a33a8,_0x1b7d0d){var _0x398878=a0_0x3988();return a0_0x335f=function(_0x335fc5,_0x274495){_0x335fc5=_0x335fc5-0x13e;var _0x561fcb=_0x398878[_0x335fc5];return _0x561fcb;},a0_0x335f(_0x4a33a8,_0x1b7d0d);}router[a0_0x383e19(0x1b7)](a0_0x383e19(0x18e),auth,async(_0x3ee051,_0x271360)=>{var _0x201397=a0_0x383e19;try{const {username:_0x4146ba,email:_0x554b0c,role:_0x5ae4bc}=_0x3ee051[_0x201397(0x1ca)],_0x4dc3ab=_0x3ee051[_0x201397(0x1ca)],_0x1af53f=await profile[_0x201397(0x1a3)]({'email':_0x4dc3ab[_0x201397(0x1e1)]}),_0x235bd9=await master_shop[_0x201397(0x1c8)]();let _0x3151cc;if(_0x4dc3ab[_0x201397(0x16c)]==_0x201397(0x1aa)){const _0x5ef690=await staff[_0x201397(0x1a3)]({'email':_0x4dc3ab[_0x201397(0x1e1)]});_0x3151cc=await warehouse[_0x201397(0x19f)]([{'$match':{'status':_0x201397(0x14a),'name':_0x5ef690[_0x201397(0x204)],'warehouse_category':_0x201397(0x19d),'name':{'$ne':_0x201397(0x1db)}}},{'$group':{'_id':_0x201397(0x1d6),'name':{'$first':_0x201397(0x1d6)}}}]);}else _0x3151cc=await warehouse[_0x201397(0x19f)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x201397(0x1d6),'name':{'$first':_0x201397(0x1d6)}}}]);const _0x14c0db=await transfers_finished['find']({}),_0xbb9e20=_0x14c0db[_0x201397(0x216)]+0x1,_0x326f85=_0x201397(0x1f7)+_0xbb9e20[_0x201397(0x164)]()[_0x201397(0x1d9)](0x5,'0');if(_0x235bd9[0x0][_0x201397(0x182)]==_0x201397(0x214))var _0x15009c=users[_0x201397(0x142)];else{if(_0x235bd9[0x0][_0x201397(0x182)]==_0x201397(0x1e0))var _0x15009c=users[_0x201397(0x1e0)];else{if(_0x235bd9[0x0]['language']==_0x201397(0x13f))var _0x15009c=users['German'];else{if(_0x235bd9[0x0]['language']=='Spanish')var _0x15009c=users[_0x201397(0x1e9)];else{if(_0x235bd9[0x0][_0x201397(0x182)]==_0x201397(0x1b9))var _0x15009c=users[_0x201397(0x1b9)];else{if(_0x235bd9[0x0][_0x201397(0x182)]==_0x201397(0x1c7))var _0x15009c=users[_0x201397(0x151)];else{if(_0x235bd9[0x0][_0x201397(0x182)]==_0x201397(0x1f3))var _0x15009c=users['Chinese'];else{if(_0x235bd9[0x0][_0x201397(0x182)]=='Arabic\x20(ae)')var _0x15009c=users[_0x201397(0x18f)];}}}}}}}const _0x5cc7ff=getRandom8DigitNumber();_0x5cc7ff['then'](_0x20dbfd=>{var _0x255a8a=_0x201397;_0x271360['render'](_0x255a8a(0x18a),{'success':_0x3ee051['flash'](_0x255a8a(0x20c)),'errors':_0x3ee051['flash'](_0x255a8a(0x1eb)),'role':_0x4dc3ab,'profile':_0x1af53f,'master_shop':_0x235bd9,'warehouse':_0x3151cc,'language':_0x15009c,'invoice':_0x20dbfd});})['catch'](_0x28d0e5=>{var _0x5b9e6f=_0x201397;_0x3ee051[_0x5b9e6f(0x208)](_0x5b9e6f(0x1eb),'There\x27s\x20a\x20error\x20in\x20this\x20transaction'),_0x271360[_0x5b9e6f(0x157)]('/transfer/view');});}catch(_0x16f1b9){console[_0x201397(0x212)](_0x16f1b9);}}),router[a0_0x383e19(0x140)](a0_0x383e19(0x18e),auth,async(_0x397aa5,_0x1da219)=>{var _0x359d2d=a0_0x383e19;try{const {date:_0x32bb3f,from_warehouse:_0xf88914,FromRoom_name:_0x4b4ba4,to_warehouse:_0x578812,ToRoom_name:_0x58f0b3,prod_name:_0x13bdbe,from_prod_qty:_0xe20109,from_prod_level:_0x2ed606,from_prod_isle:_0x59fdb8,from_prod_pallet:_0x4e603d,to_prod_qty:_0x486c0d,to_prod_level:_0x1366b7,to_prod_isle:_0x4fdc26,to_prod_pallet:_0xb127e1,primary_code:_0x6adc00,secondary_code:_0x417852,product_code3:_0x545acf,note:_0xb7bcc2,MaxStocks_data2:_0x5390ef,invoice:_0x3b777e,expiry_date:_0x201a88}=_0x397aa5[_0x359d2d(0x1cf)];if(typeof _0x13bdbe==_0x359d2d(0x162))var _0x4551dd=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1c3)]],_0x1c0038=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x147)]],_0x2775eb=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x183)]],_0x265d22=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1f2)]],_0x36008b=[_0x397aa5['body']['to_prod_level']],_0x1c4f95=[_0x397aa5['body'][_0x359d2d(0x1e7)]],_0x44dab5=[_0x397aa5[_0x359d2d(0x1cf)]['secondary_code']],_0xa56ee8=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x17d)]],_0x250be7=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x188)]],_0x589d7e=[_0x397aa5['body'][_0x359d2d(0x1c6)]],_0x15c1d0=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1fd)]],_0x50595a=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x168)]],_0x4ba4e7=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x15c)]],_0x35baf5=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x20b)]],_0x1515be=[_0x397aa5['body'][_0x359d2d(0x19a)]],_0x348cfa=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x176)]],_0x4077c6=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1c0)]],_0x36d7bc=[_0x397aa5['body'][_0x359d2d(0x158)]],_0x101b77=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x15e)]],_0x6941c7=[_0x397aa5['body'][_0x359d2d(0x1fe)]],_0x46be87=[_0x397aa5['body'][_0x359d2d(0x215)]],_0x8a9ed8=[_0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1d3)]];else var _0x4551dd=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1c3)]],_0x1c0038=[..._0x397aa5['body'][_0x359d2d(0x147)]],_0x2775eb=[..._0x397aa5[_0x359d2d(0x1cf)]['from_prod_level']],_0x265d22=[..._0x397aa5[_0x359d2d(0x1cf)]['New_Qty_Converted']],_0x36008b=[..._0x397aa5[_0x359d2d(0x1cf)]['to_prod_level']],_0x1c4f95=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1e7)]],_0x44dab5=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x187)]],_0xa56ee8=[..._0x397aa5['body'][_0x359d2d(0x17d)]],_0x250be7=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x188)]],_0x589d7e=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1c6)]],_0x15c1d0=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1fd)]],_0x50595a=[..._0x397aa5[_0x359d2d(0x1cf)]['batch_code']],_0x4ba4e7=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x15c)]],_0x35baf5=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x20b)]],_0x1515be=[..._0x397aa5['body'][_0x359d2d(0x19a)]],_0x348cfa=[..._0x397aa5['body'][_0x359d2d(0x176)]],_0x4077c6=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1c0)]],_0x36d7bc=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x158)]],_0x101b77=[..._0x397aa5['body'][_0x359d2d(0x15e)]],_0x6941c7=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1fe)]],_0x46be87=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x215)]],_0x8a9ed8=[..._0x397aa5[_0x359d2d(0x1cf)][_0x359d2d(0x1d3)]];const _0x287c4e=_0x4551dd[_0x359d2d(0x1cb)](_0x3da639=>{return _0x3da639={'product_name':_0x3da639};});_0x1c0038[_0x359d2d(0x1bb)]((_0x148d62,_0x5e523f)=>{var _0x38a4cb=_0x359d2d;_0x287c4e[_0x5e523f][_0x38a4cb(0x213)]=_0x148d62;}),_0x2775eb[_0x359d2d(0x1bb)]((_0x391853,_0x157845)=>{_0x287c4e[_0x157845]['from_bay']=_0x391853;}),_0x8a9ed8[_0x359d2d(0x1bb)]((_0x1d3144,_0x529a20)=>{_0x287c4e[_0x529a20]['id_transaction']=_0x1d3144;}),_0x6941c7[_0x359d2d(0x1bb)]((_0x4f6a26,_0x3ce1dd)=>{var _0x5cbd5c=_0x359d2d;_0x287c4e[_0x3ce1dd][_0x5cbd5c(0x1fe)]=_0x4f6a26;}),_0x46be87[_0x359d2d(0x1bb)]((_0x5c0c8b,_0x519b77)=>{_0x287c4e[_0x519b77]['To_invoice']=_0x5c0c8b;}),_0x265d22['forEach']((_0x3d9b71,_0x479c0a)=>{var _0x42f1f4=_0x359d2d;_0x287c4e[_0x479c0a][_0x42f1f4(0x1e2)]=_0x3d9b71;}),_0x36008b[_0x359d2d(0x1bb)]((_0x42914f,_0x583a9a)=>{var _0xd9b0b6=_0x359d2d;_0x287c4e[_0x583a9a][_0xd9b0b6(0x17b)]=_0x42914f;}),_0x1c4f95['forEach']((_0x4ac1d3,_0x1f5ed9)=>{var _0x503466=_0x359d2d;_0x287c4e[_0x1f5ed9][_0x503466(0x1e7)]=_0x4ac1d3;}),_0x44dab5[_0x359d2d(0x1bb)]((_0x46624b,_0x1a37da)=>{var _0x3242ea=_0x359d2d;_0x287c4e[_0x1a37da][_0x3242ea(0x187)]=_0x46624b;}),_0xa56ee8[_0x359d2d(0x1bb)]((_0x59338a,_0x11b8c0)=>{_0x287c4e[_0x11b8c0]['product_code']=_0x59338a;}),_0x250be7[_0x359d2d(0x1bb)]((_0x2088bd,_0x14b93d)=>{var _0x16cf45=_0x359d2d;_0x287c4e[_0x14b93d][_0x16cf45(0x1f1)]=_0x2088bd;}),_0x589d7e[_0x359d2d(0x1bb)]((_0x59b915,_0x3c0895)=>{var _0x1ee338=_0x359d2d;_0x287c4e[_0x3c0895][_0x1ee338(0x20f)]=_0x59b915;}),_0x15c1d0[_0x359d2d(0x1bb)]((_0x228033,_0x27dcd4)=>{var _0x4a2d5c=_0x359d2d;_0x287c4e[_0x27dcd4][_0x4a2d5c(0x1fd)]=_0x228033;}),_0x50595a[_0x359d2d(0x1bb)]((_0x493008,_0x91082b)=>{var _0x367f35=_0x359d2d;_0x287c4e[_0x91082b][_0x367f35(0x168)]=_0x493008;}),_0x4ba4e7[_0x359d2d(0x1bb)]((_0x32c815,_0x322cef)=>{var _0x1dce63=_0x359d2d;_0x287c4e[_0x322cef][_0x1dce63(0x15c)]=_0x32c815;}),_0x35baf5[_0x359d2d(0x1bb)]((_0x4c0ec9,_0xd7fbf2)=>{_0x287c4e[_0xd7fbf2]['production_date']=_0x4c0ec9;}),_0x1515be[_0x359d2d(0x1bb)]((_0x31ae06,_0x2b4fa4)=>{_0x287c4e[_0x2b4fa4]['maxProducts']=_0x31ae06;}),_0x348cfa[_0x359d2d(0x1bb)]((_0x6449f2,_0x5b491b)=>{_0x287c4e[_0x5b491b]['maxPerUnit']=_0x6449f2;}),_0x4077c6[_0x359d2d(0x1bb)]((_0x2e17c3,_0x1ab03d)=>{var _0x31ced4=_0x359d2d;_0x287c4e[_0x1ab03d][_0x31ced4(0x1c0)]=_0x2e17c3;}),_0x36d7bc[_0x359d2d(0x1bb)]((_0x1785c7,_0x3021b6)=>{var _0x1e1cdd=_0x359d2d;_0x287c4e[_0x3021b6][_0x1e1cdd(0x190)]=_0x1785c7;}),_0x101b77['forEach']((_0x4404a7,_0x5a49ab)=>{var _0x40552b=_0x359d2d;_0x287c4e[_0x5a49ab][_0x40552b(0x201)]=_0x4404a7;});const _0x77e71b=_0x287c4e[_0x359d2d(0x19e)](_0x1d209d=>_0x1d209d[_0x359d2d(0x1e2)]!=='0'&&_0x1d209d[_0x359d2d(0x1e2)]!==''||_0x1d209d['to_floorlevel']!=='0'&&_0x1d209d[_0x359d2d(0x1d5)]!=='');var _0x47f2f7=0x0;_0x77e71b[_0x359d2d(0x1bb)](_0x411bb4=>{var _0x556e83=_0x359d2d;parseInt(_0x411bb4[_0x556e83(0x213)])<parseInt(_0x411bb4['to_quantity'])&&_0x47f2f7++;});if(_0x47f2f7!=0x0)return _0x397aa5[_0x359d2d(0x208)]('errors',_0x359d2d(0x1b0)),_0x1da219[_0x359d2d(0x157)](_0x359d2d(0x1d7));const _0x6c2467=new transfers_finished({'date':_0x32bb3f,'from_warehouse':_0xf88914,'to_warehouse':_0x578812,'product':_0x77e71b,'note':_0xb7bcc2,'invoice':_0x3b777e}),_0x22c42d=await _0x6c2467[_0x359d2d(0x217)]();_0x397aa5[_0x359d2d(0x208)](_0x359d2d(0x20c),_0x359d2d(0x1a2)),_0x1da219['redirect'](_0x359d2d(0x1a1)+_0x22c42d[_0x359d2d(0x166)]);}catch(_0x2cdc55){console['log'](_0x2cdc55),_0x1da219['status'](0xc8)['json']({'errorMessage':_0x2cdc55[_0x359d2d(0x149)]});}}),router[a0_0x383e19(0x1b7)](a0_0x383e19(0x1b6),auth,async(_0x14c633,_0x45de27)=>{var _0x158423=a0_0x383e19;try{const {username:_0x79baf0,email:_0x4737b7,role:_0x120b25}=_0x14c633[_0x158423(0x1ca)],_0x16aa6f=_0x14c633[_0x158423(0x1ca)],_0x7c63d7=await profile[_0x158423(0x1a3)]({'email':_0x16aa6f['email']}),_0x52dbdf=await master_shop[_0x158423(0x1c8)](),_0x1dca6e=await transfers_finished[_0x158423(0x174)](_0x14c633['params']['id']);let _0x25b5d1;if(_0x16aa6f[_0x158423(0x16c)]=='staff'){const _0xcd52ea=await staff['findOne']({'email':_0x16aa6f['email']});_0x25b5d1=await warehouse['find']({'status':'Enabled','name':_0xcd52ea[_0x158423(0x204)],'warehouse_category':'Finished\x20Goods'});}else _0x25b5d1=await warehouse[_0x158423(0x1c8)]({'status':_0x158423(0x14a),'warehouse_category':_0x158423(0x19d)});const _0x46548a=await warehouse[_0x158423(0x19f)]([{'$match':{'name':_0x1dca6e[_0x158423(0x15f)],'warehouse_category':_0x158423(0x19d)}},{'$unwind':_0x158423(0x1b3)},{'$group':{'_id':_0x158423(0x1c5),'name':{'$first':_0x158423(0x16a)},'product_stock':{'$first':_0x158423(0x1c9)},'bay':{'$first':_0x158423(0x141)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x158423(0x1de)},'floorlevel':{'$first':_0x158423(0x181)},'primary_code':{'$first':_0x158423(0x1a9)},'secondary_code':{'$first':_0x158423(0x14c)},'product_code':{'$first':_0x158423(0x211)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x158423(0x1ed)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x158423(0x19b)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x158423(0x1d6)}}}]),_0x3cdb5f=await product[_0x158423(0x1c8)]({});if(_0x52dbdf[0x0][_0x158423(0x182)]=='English\x20(US)'){var _0x183a12=users[_0x158423(0x142)];console[_0x158423(0x212)](_0x183a12);}else{if(_0x52dbdf[0x0][_0x158423(0x182)]==_0x158423(0x1e0))var _0x183a12=users[_0x158423(0x1e0)];else{if(_0x52dbdf[0x0]['language']==_0x158423(0x13f))var _0x183a12=users[_0x158423(0x13f)];else{if(_0x52dbdf[0x0]['language']==_0x158423(0x1e9))var _0x183a12=users[_0x158423(0x1e9)];else{if(_0x52dbdf[0x0][_0x158423(0x182)]==_0x158423(0x1b9))var _0x183a12=users[_0x158423(0x1b9)];else{if(_0x52dbdf[0x0]['language']==_0x158423(0x1c7))var _0x183a12=users[_0x158423(0x151)];else{if(_0x52dbdf[0x0][_0x158423(0x182)]==_0x158423(0x1f3))var _0x183a12=users[_0x158423(0x1f3)];else{if(_0x52dbdf[0x0][_0x158423(0x182)]==_0x158423(0x1da))var _0x183a12=users[_0x158423(0x18f)];}}}}}}}_0x45de27[_0x158423(0x16b)]('edit_transfer_finished_view',{'success':_0x14c633[_0x158423(0x208)]('success'),'errors':_0x14c633[_0x158423(0x208)]('errors'),'role':_0x16aa6f,'profile':_0x7c63d7,'master_shop':_0x52dbdf,'warehouse':_0x25b5d1,'transfer':_0x1dca6e,'stock':_0x46548a,'unit':_0x3cdb5f,'language':_0x183a12});}catch(_0x54ed1d){console['log'](_0x54ed1d);}}),router[a0_0x383e19(0x140)]('/preview/:id',auth,async(_0xf201f3,_0x4896f0)=>{var _0x58c453=a0_0x383e19;try{const {invoice:_0x361af1,from_warehouse:_0x36d3fa,FromRoom_name:_0x3ca1f1,to_warehouse:_0x4bc7fb,ToRoom_name:_0x3f561f}=_0xf201f3[_0x58c453(0x1cf)],_0x28d08a=await transfers_finished[_0x58c453(0x174)](_0xf201f3[_0x58c453(0x1e8)]['id']),_0x323c0e=_0x28d08a[_0x58c453(0x1c1)][_0x58c453(0x1cb)](async _0x4b088c=>{var _0x14b060=_0x58c453;if(_0x4b088c[_0x14b060(0x1e2)]>0x0){var _0xeb446f=await warehouse[_0x14b060(0x1a3)]({'name':_0x36d3fa,'room':_0x4b088c['from_room_name'],'warehouse_category':_0x14b060(0x19d)});const _0x42c90d=_0xeb446f['product_details'][_0x14b060(0x1cb)](_0x32e5c3=>{var _0x347662=_0x14b060;_0x32e5c3['product_name']==_0x4b088c[_0x347662(0x16d)]&&_0x32e5c3[_0x347662(0x1ac)]==_0x4b088c[_0x347662(0x143)]&&_0x32e5c3[_0x347662(0x15c)]==_0x4b088c[_0x347662(0x15c)]&&_0x32e5c3[_0x347662(0x17a)]==_0x4b088c['production_date']&&_0x32e5c3[_0x347662(0x168)]==_0x4b088c['batch_code']&&_0x32e5c3[_0x347662(0x200)]==_0x4b088c[_0x347662(0x1fe)]&&(console[_0x347662(0x212)](_0x347662(0x202),_0x32e5c3[_0x347662(0x1d4)]),typeof _0x4b088c['id_transaction']=='undefined'?_0x32e5c3['product_stock']=Math[_0x347662(0x15b)](0x0,Math[_0x347662(0x1ad)](_0x32e5c3[_0x347662(0x1d4)])-Math[_0x347662(0x1ad)](_0x4b088c['to_quantity'])):_0x32e5c3[_0x347662(0x1d4)]=Math[_0x347662(0x15b)](0x0,Math[_0x347662(0x1ad)](_0x32e5c3['product_stock'])-Math['abs'](_0x4b088c[_0x347662(0x1e2)])));});}return _0xeb446f;});Promise[_0x58c453(0x1ec)](_0x323c0e)[_0x58c453(0x165)](async _0x9f2ce6=>{var _0x2b5f27=_0x58c453;try{for(const _0x119f05 of _0x9f2ce6){await _0x119f05[_0x2b5f27(0x217)]();}const _0xb48e2=_0x28d08a['product'][_0x2b5f27(0x1cb)](async _0x1e1103=>{var _0x315365=_0x2b5f27,_0x1f5af4=await warehouse[_0x315365(0x1a3)]({'name':_0x4bc7fb,'room':_0x1e1103[_0x315365(0x201)]});if(_0x1e1103[_0x315365(0x1e2)]>0x0){var _0x5684a1=0x0;const _0x1b387a=_0x1f5af4[_0x315365(0x1e6)][_0x315365(0x1cb)](_0x3e72ea=>{var _0xdc0485=_0x315365;_0x3e72ea[_0xdc0485(0x16d)]==_0x1e1103[_0xdc0485(0x16d)]&&_0x3e72ea[_0xdc0485(0x1ac)]==_0x1e1103[_0xdc0485(0x17b)]&&_0x3e72ea['expiry_date']==_0x1e1103[_0xdc0485(0x15c)]&&_0x3e72ea['production_date']==_0x1e1103[_0xdc0485(0x17a)]&&_0x3e72ea[_0xdc0485(0x168)]==_0x1e1103['batch_code']&&_0x3e72ea[_0xdc0485(0x200)]==_0x1e1103['To_invoice']&&(typeof _0x1e1103[_0xdc0485(0x1d3)]=='undefined'?(console[_0xdc0485(0x212)](_0xdc0485(0x15d),_0x3e72ea[_0xdc0485(0x1d4)]+_0xdc0485(0x194)+_0x3e72ea[_0xdc0485(0x166)]+_0xdc0485(0x1ba)+Math['abs'](_0x3e72ea[_0xdc0485(0x1d4)])+Math['abs'](_0x1e1103[_0xdc0485(0x1e2)])),_0x3e72ea['product_stock']=Math[_0xdc0485(0x1ad)](_0x3e72ea[_0xdc0485(0x1d4)])+Math[_0xdc0485(0x1ad)](_0x1e1103[_0xdc0485(0x1e2)])):_0x3e72ea['product_stock']=Math[_0xdc0485(0x1ad)](_0x3e72ea[_0xdc0485(0x1d4)])+Math[_0xdc0485(0x1ad)](_0x1e1103[_0xdc0485(0x1e2)]),_0x5684a1++);});_0x5684a1=='0'&&(_0x1f5af4[_0x315365(0x1e6)]=_0x1f5af4[_0x315365(0x1e6)][_0x315365(0x1f4)]({'product_name':_0x1e1103[_0x315365(0x16d)],'product_stock':_0x1e1103[_0x315365(0x1e2)],'bay':_0x1e1103['to_bay'],'product_code':_0x1e1103[_0x315365(0x14f)],'primary_code':_0x1e1103[_0x315365(0x1e7)],'secondary_code':_0x1e1103['secondary_code'],'expiry_date':_0x1e1103[_0x315365(0x15c)],'production_date':_0x1e1103[_0x315365(0x17a)],'maxProducts':_0x1e1103[_0x315365(0x1f1)],'batch_code':_0x1e1103[_0x315365(0x168)],'secondary_unit':_0x1e1103[_0x315365(0x1fd)],'unit':_0x1e1103[_0x315365(0x20f)],'maxProducts':_0x1e1103[_0x315365(0x1f1)],'maxPerUnit':_0x1e1103[_0x315365(0x176)],'invoice':_0x1e1103['To_invoice']}));}return _0x1f5af4;});Promise['all'](_0xb48e2)[_0x2b5f27(0x165)](async _0x20c4db=>{var _0x2ccd12=_0x2b5f27;try{for(const _0x4d2a02 of _0x20c4db){await warehouse[_0x2ccd12(0x153)]({'_id':_0x4d2a02['_id']},{'$addToSet':{'product_details':{'$each':_0x4d2a02[_0x2ccd12(0x1e6)]}}});}_0x28d08a[_0x2ccd12(0x1df)]=_0x2ccd12(0x159);const _0x299c9e=await _0x28d08a[_0x2ccd12(0x217)](),_0x454981=await master_shop[_0x2ccd12(0x1c8)](),_0x4be31e=await email_settings[_0x2ccd12(0x1a3)](),_0x1bac9e=await supervisor_settings[_0x2ccd12(0x1c8)]();var _0x4b0fa0=_0x28d08a['product'],_0x45b73c='',_0x2dbb6c;for(_0x2dbb6c in _0x4b0fa0){var _0x2e4b0f='FG';_0x28d08a[_0x2ccd12(0x1e5)]=='DRY\x20GOODS'&&(_0x2e4b0f='DG'),_0x45b73c+=_0x2ccd12(0x146)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4b0fa0[_0x2dbb6c][_0x2ccd12(0x16d)]+'</td>'+_0x2ccd12(0x20e)+_0x4b0fa0[_0x2dbb6c][_0x2ccd12(0x14f)]+_0x2ccd12(0x1fa)+_0x2ccd12(0x20e)+_0x4b0fa0[_0x2dbb6c][_0x2ccd12(0x1e2)]+_0x2ccd12(0x1fa)+_0x2ccd12(0x20e)+_0x4b0fa0[_0x2dbb6c][_0x2ccd12(0x20f)]+_0x2ccd12(0x1fa)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x4b0fa0[_0x2dbb6c][_0x2ccd12(0x1fd)]+'</td>'+_0x2ccd12(0x20e)+_0x28d08a[_0x2ccd12(0x1e5)]+_0x2ccd12(0x1fa)+_0x2ccd12(0x20e)+_0x4b0fa0[_0x2dbb6c][_0x2ccd12(0x201)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2e4b0f+_0x4b0fa0[_0x2dbb6c]['to_bay']+_0x2ccd12(0x1fa)+_0x2ccd12(0x20a);}let _0xe4be60=nodemailer[_0x2ccd12(0x167)]({'host':_0x4be31e[_0x2ccd12(0x1ae)],'port':Number(_0x4be31e[_0x2ccd12(0x1af)]),'secure':![],'auth':{'user':_0x4be31e['email'],'pass':_0x4be31e[_0x2ccd12(0x1be)]}}),_0x406be1={'from':_0x4be31e['email'],'to':_0x1bac9e[0x0][_0x2ccd12(0x14b)],'subject':_0x2ccd12(0x179),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2ccd12(0x1ef)+'/upload/'+_0x454981[0x0][_0x2ccd12(0x150)],'cid':'logo'}],'html':_0x2ccd12(0x1b4)+'<html><head><title></title>'+_0x2ccd12(0x154)+_0x2ccd12(0x218)+_0x2ccd12(0x196)+_0x2ccd12(0x218)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x2ccd12(0x14e)+_0x2ccd12(0x218)+'<h2>\x20'+_0x454981[0x0][_0x2ccd12(0x195)]+_0x2ccd12(0x172)+_0x2ccd12(0x14e)+_0x2ccd12(0x14e)+'<hr\x20class=\x22my-3\x22>'+_0x2ccd12(0x218)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x2ccd12(0x16f)+_0x28d08a['invoice']+'\x20'+_0x2ccd12(0x17f)+_0x2ccd12(0x1cc)+_0x28d08a['date']+'\x20'+_0x2ccd12(0x161)+_0x2ccd12(0x17e)+_0x2ccd12(0x14e)+_0x2ccd12(0x1ff)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x2ccd12(0x146)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x2ccd12(0x1f0)+_0x2ccd12(0x185)+_0x2ccd12(0x1f9)+_0x2ccd12(0x175)+_0x2ccd12(0x209)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x2ccd12(0x207)+_0x2ccd12(0x20a)+_0x2ccd12(0x1ee)+_0x2ccd12(0x1b1)+'\x20'+_0x45b73c+'\x20'+_0x2ccd12(0x186)+'</table>'+_0x2ccd12(0x218)+'<strong>\x20Regards\x20</strong>'+_0x2ccd12(0x1ea)+_0x454981[0x0][_0x2ccd12(0x195)]+'</h5>'+'</div>'+_0x2ccd12(0x14e)+_0x2ccd12(0x169)};_0xe4be60[_0x2ccd12(0x148)](_0x406be1,function(_0x559858,_0x2bccf0){var _0x572f18=_0x2ccd12;_0x559858?(console['log'](_0x559858),console[_0x572f18(0x212)]('Error\x20Occurs')):console[_0x572f18(0x212)](_0x572f18(0x1b5));}),_0xf201f3['flash'](_0x2ccd12(0x20c),_0x2ccd12(0x178)),_0x4896f0[_0x2ccd12(0x157)]('/picking_list/PDF_transfer/'+_0x299c9e[_0x2ccd12(0x166)]);}catch(_0x4b5575){console[_0x2ccd12(0x184)](_0x4b5575),_0x4896f0[_0x2ccd12(0x145)](0x1f4)['json']({'error':_0x2ccd12(0x156)});}})['catch'](_0x3ab7cc=>{var _0x30194c=_0x2b5f27;console[_0x30194c(0x184)](_0x3ab7cc),_0x4896f0['status'](0x1f4)[_0x30194c(0x180)]({'error':_0x30194c(0x1a6)});});}catch(_0x274dcb){console[_0x2b5f27(0x184)](_0x274dcb),_0x4896f0[_0x2b5f27(0x145)](0x1f4)[_0x2b5f27(0x180)]({'error':_0x2b5f27(0x173)});}})[_0x58c453(0x1bf)](_0x387667=>{var _0x5c9994=_0x58c453;console[_0x5c9994(0x184)](_0x387667),_0x4896f0[_0x5c9994(0x145)](0x1f4)[_0x5c9994(0x180)]({'error':_0x5c9994(0x1a6)});});}catch(_0x13314f){_0x4896f0[_0x58c453(0x180)]({'message':_0x13314f[_0x58c453(0x149)]});}});function BayBinSelected(_0x3318ae,_0x369c8c){var _0x4d7db6=a0_0x383e19,_0x2f76ed=[];let _0xae5333=[];var _0x5a5cae=[];if(_0x3318ae=='DRY\x20GOODS'){switch(_0x369c8c){case _0x4d7db6(0x1d2):_0x2f76ed=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x4d7db6(0x205):_0x2f76ed=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x5a5cae=['DG'];}else{if(_0x3318ae=='FROZEN\x20GOODS'){switch(_0x369c8c){case _0x4d7db6(0x1d2):_0x2f76ed=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x2f76ed=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x5a5cae=['FG'];}}return{'levels':_0x2f76ed,'identify':_0x5a5cae};}router[a0_0x383e19(0x1b7)](a0_0x383e19(0x191),auth,async(_0x4f1098,_0xa46730)=>{var _0x80a013=a0_0x383e19;try{const {username:_0x4621eb,email:_0x476449,role:_0x4ad15c}=_0x4f1098['user'],_0x336e7c=_0x4f1098[_0x80a013(0x1ca)],_0x3bb40d=await profile[_0x80a013(0x1a3)]({'email':_0x336e7c['email']}),_0x150a8f=await master_shop[_0x80a013(0x1c8)](),_0x3eac94=await transfers_finished[_0x80a013(0x174)](_0x4f1098[_0x80a013(0x1e8)]['id']);let _0x56e248=new Date(_0x3eac94['expiry_date']),_0x4aa36d=('0'+_0x56e248[_0x80a013(0x1bc)]())[_0x80a013(0x19c)](-0x2),_0x3f19af=('0'+(_0x56e248[_0x80a013(0x160)]()+0x1))[_0x80a013(0x19c)](-0x2),_0x2114f9=_0x56e248['getFullYear'](),_0x387d73=_0x2114f9+'-'+_0x3f19af+'-'+_0x4aa36d,_0x49bf11;if(_0x336e7c[_0x80a013(0x16c)]==_0x80a013(0x1aa)){const _0x847786=await staff[_0x80a013(0x1a3)]({'email':_0x336e7c[_0x80a013(0x1e1)]});_0x49bf11=await warehouse['find']({'status':'Enabled','name':_0x847786['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x49bf11=await warehouse[_0x80a013(0x1c8)]({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x3a17e1=await warehouse[_0x80a013(0x19f)]([{'$match':{'name':_0x3eac94[_0x80a013(0x15f)],'room':_0x3eac94['from_room']}},{'$unwind':_0x80a013(0x1b3)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x80a013(0x1c9)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x80a013(0x181)},'primary_code':{'$first':_0x80a013(0x1a9)},'secondary_code':{'$first':_0x80a013(0x14c)},'product_code':{'$first':_0x80a013(0x211)},'storage':{'$first':_0x80a013(0x155)},'rack':{'$first':_0x80a013(0x1ed)}}}]);var _0x18ccc7=[0x1,0x2,0x3,0x4],_0x51d797=['A','B','C','D','E','F','G','H','I','J'],_0x182954=[_0x80a013(0x152),_0x80a013(0x171)];const _0xf73512=await product['find']({}),_0x2591c0=BayBinSelected(_0x3eac94['to_warehouse'],_0x3eac94['to_room']);if(_0x150a8f[0x0][_0x80a013(0x182)]==_0x80a013(0x214)){var _0x106a59=users[_0x80a013(0x142)];console[_0x80a013(0x212)](_0x106a59);}else{if(_0x150a8f[0x0]['language']==_0x80a013(0x1e0))var _0x106a59=users['Hindi'];else{if(_0x150a8f[0x0][_0x80a013(0x182)]==_0x80a013(0x13f))var _0x106a59=users[_0x80a013(0x13f)];else{if(_0x150a8f[0x0][_0x80a013(0x182)]==_0x80a013(0x1e9))var _0x106a59=users[_0x80a013(0x1e9)];else{if(_0x150a8f[0x0][_0x80a013(0x182)]==_0x80a013(0x1b9))var _0x106a59=users[_0x80a013(0x1b9)];else{if(_0x150a8f[0x0][_0x80a013(0x182)]==_0x80a013(0x1c7))var _0x106a59=users[_0x80a013(0x151)];else{if(_0x150a8f[0x0]['language']==_0x80a013(0x1f3))var _0x106a59=users[_0x80a013(0x1f3)];else{if(_0x150a8f[0x0][_0x80a013(0x182)]==_0x80a013(0x1da))var _0x106a59=users[_0x80a013(0x18f)];}}}}}}}_0xa46730['render'](_0x80a013(0x16e),{'success':_0x4f1098[_0x80a013(0x208)](_0x80a013(0x20c)),'errors':_0x4f1098[_0x80a013(0x208)](_0x80a013(0x1eb)),'role':_0x336e7c,'profile':_0x3bb40d,'master_shop':_0x150a8f,'warehouse':_0x49bf11,'transfer':_0x3eac94,'stock':_0x3a17e1,'unit':_0xf73512,'language':_0x106a59,'levels':_0x18ccc7,'Isle':_0x51d797,'rooms_data':_0x182954,'ed_fullDate':_0x387d73,'dataSelected':_0x2591c0});}catch(_0x1dce70){console[_0x80a013(0x212)](_0x1dce70);}}),router[a0_0x383e19(0x140)](a0_0x383e19(0x191),auth,async(_0x271477,_0x1893ec)=>{var _0x2936b6=a0_0x383e19;try{const _0x520535=_0x271477[_0x2936b6(0x1e8)]['id'];console[_0x2936b6(0x212)](_0x271477[_0x2936b6(0x1cf)]);const _0x2d350a=await transfers_finished[_0x2936b6(0x174)](_0x520535);console[_0x2936b6(0x212)](_0x2936b6(0x1bd),_0x2d350a);const {date:_0x438c5e,from_warehouse:_0x48b8dd,FromRoom_name:_0x1e94d3,to_warehouse:_0x4e7968,ToRoom_name:_0x475ec0,prod_name:_0x482934,from_prod_qty:_0x3007fe,from_prod_level:_0x206f73,from_prod_isle:_0x3d596b,from_prod_pallet:_0x243e28,to_prod_qty:_0x50492f,to_prod_level:_0x19c2cb,to_prod_isle:_0x21274a,to_prod_pallet:_0x52643d,primary_code:_0x5c374a,secondary_code:_0x134e34,product_code3:_0x6fd8ed,note:_0x539a4b,invoice:_0x3c8af4,expiry_date:_0x35a016}=_0x271477[_0x2936b6(0x1cf)];if(typeof _0x482934==_0x2936b6(0x162))var _0x230dee=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x1c3)]],_0x22f7ab=[_0x271477['body']['from_prod_qty']],_0x6dcc89=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x183)]],_0x4cf481=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x1a4)]],_0x9136f2=[_0x271477[_0x2936b6(0x1cf)]['to_prod_level']],_0x3a0672=[_0x271477[_0x2936b6(0x1cf)]['primary_code']],_0x14d91a=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x187)]],_0x40777c=[_0x271477['body'][_0x2936b6(0x17d)]],_0x57e660=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x188)]],_0x4653b6=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x20f)]],_0x3c6769=[_0x271477['body'][_0x2936b6(0x1fd)]],_0x48e054=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x168)]],_0x15e1d2=[_0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x15c)]];else var _0x230dee=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x1c3)]],_0x22f7ab=[..._0x271477['body'][_0x2936b6(0x147)]],_0x6dcc89=[..._0x271477[_0x2936b6(0x1cf)]['from_prod_level']],_0x4cf481=[..._0x271477[_0x2936b6(0x1cf)]['to_prod_qty']],_0x9136f2=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x1a7)]],_0x3a0672=[..._0x271477[_0x2936b6(0x1cf)]['primary_code']],_0x14d91a=[..._0x271477[_0x2936b6(0x1cf)]['secondary_code']],_0x40777c=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x17d)]],_0x57e660=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x188)]],_0x4653b6=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x20f)]],_0x3c6769=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x1fd)]],_0x48e054=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x168)]],_0x15e1d2=[..._0x271477[_0x2936b6(0x1cf)][_0x2936b6(0x15c)]];const _0x4aea5f=_0x230dee['map'](_0x27cce7=>{return _0x27cce7={'product_name':_0x27cce7};});_0x22f7ab[_0x2936b6(0x1bb)]((_0x298ab0,_0x394a49)=>{var _0x2fe739=_0x2936b6;_0x4aea5f[_0x394a49][_0x2fe739(0x213)]=_0x298ab0;}),_0x6dcc89['forEach']((_0x664631,_0x2f8650)=>{_0x4aea5f[_0x2f8650]['from_bay']=_0x664631;}),_0x4cf481[_0x2936b6(0x1bb)]((_0x164d61,_0x13cfc9)=>{_0x4aea5f[_0x13cfc9]['to_quantity']=_0x164d61;}),_0x9136f2['forEach']((_0x218634,_0x139d12)=>{var _0x4485b3=_0x2936b6;_0x4aea5f[_0x139d12][_0x4485b3(0x17b)]=_0x218634;}),_0x3a0672['forEach']((_0x1f7839,_0x13ea69)=>{var _0x3e8bf1=_0x2936b6;_0x4aea5f[_0x13ea69][_0x3e8bf1(0x1e7)]=_0x1f7839;}),_0x14d91a[_0x2936b6(0x1bb)]((_0x9f8eff,_0x1d696c)=>{var _0x350306=_0x2936b6;_0x4aea5f[_0x1d696c][_0x350306(0x187)]=_0x9f8eff;}),_0x40777c[_0x2936b6(0x1bb)]((_0x5dd6ed,_0x4e3c54)=>{var _0xe3b13c=_0x2936b6;_0x4aea5f[_0x4e3c54][_0xe3b13c(0x14f)]=_0x5dd6ed;}),_0x57e660[_0x2936b6(0x1bb)]((_0x259664,_0x2644e6)=>{var _0x4356c1=_0x2936b6;_0x4aea5f[_0x2644e6][_0x4356c1(0x1f1)]=_0x259664;}),_0x4653b6[_0x2936b6(0x1bb)]((_0x2b9277,_0x178327)=>{var _0x101671=_0x2936b6;_0x4aea5f[_0x178327][_0x101671(0x20f)]=_0x2b9277;}),_0x3c6769[_0x2936b6(0x1bb)]((_0x23833f,_0x2906e5)=>{_0x4aea5f[_0x2906e5]['secondary_unit']=_0x23833f;}),_0x48e054[_0x2936b6(0x1bb)]((_0x3d328d,_0x5a887d)=>{var _0x29eb6d=_0x2936b6;_0x4aea5f[_0x5a887d][_0x29eb6d(0x168)]=_0x3d328d;}),_0x15e1d2['forEach']((_0x296f9c,_0x43a508)=>{var _0xff7a1b=_0x2936b6;_0x4aea5f[_0x43a508][_0xff7a1b(0x15c)]=_0x296f9c;});const _0x32331a=_0x4aea5f[_0x2936b6(0x19e)](_0x10dea1=>_0x10dea1[_0x2936b6(0x1e2)]!=='0'&&_0x10dea1['to_quantity']!==''||_0x10dea1[_0x2936b6(0x1d5)]!=='0'&&_0x10dea1[_0x2936b6(0x1d5)]!=='');var _0xbf86a0=0x0;_0x32331a[_0x2936b6(0x1bb)](_0x74e129=>{var _0x2231a1=_0x2936b6;parseInt(_0x74e129[_0x2231a1(0x213)])<parseInt(_0x74e129[_0x2231a1(0x1e2)])&&_0xbf86a0++;});if(_0xbf86a0!=0x0)return _0x271477[_0x2936b6(0x208)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x1893ec[_0x2936b6(0x157)](_0x2936b6(0x1d7));const _0x38baca=await warehouse[_0x2936b6(0x1a3)]({'name':_0x2d350a[_0x2936b6(0x15f)],'room':_0x2d350a[_0x2936b6(0x192)]});_0x2d350a[_0x2936b6(0x1c1)]['forEach'](_0x339d76=>{var _0x43981e=_0x2936b6;if(_0x339d76[_0x43981e(0x1e2)]>0x0){const _0x422143=_0x38baca['product_details'][_0x43981e(0x1cb)](_0x31fcc3=>{var _0x4dde50=_0x43981e;_0x31fcc3[_0x4dde50(0x16d)]==_0x339d76['product_name']&&_0x31fcc3['bay']==_0x339d76[_0x4dde50(0x143)]&&(_0x31fcc3[_0x4dde50(0x1d4)]=parseInt(_0x31fcc3[_0x4dde50(0x1d4)])+parseInt(_0x339d76[_0x4dde50(0x1e2)]));});}}),await _0x38baca[_0x2936b6(0x217)]();const _0x363ece=await warehouse[_0x2936b6(0x1a3)]({'name':_0x2d350a['to_warehouse'],'room':_0x2d350a['to_room']});_0x2d350a[_0x2936b6(0x1c1)][_0x2936b6(0x1bb)](_0x4c25a9=>{var _0x2261f8=_0x2936b6;if(_0x4c25a9[_0x2261f8(0x1e2)]>0x0){const _0x442613=_0x363ece[_0x2261f8(0x1e6)][_0x2261f8(0x1cb)](_0x2e8263=>{var _0x397adb=_0x2261f8;_0x2e8263[_0x397adb(0x16d)]==_0x4c25a9['product_name']&&_0x2e8263[_0x397adb(0x1ac)]==_0x4c25a9[_0x397adb(0x17b)]&&(_0x2e8263['product_stock']=parseInt(_0x2e8263['product_stock'])-parseInt(_0x4c25a9[_0x397adb(0x1e2)]));});}}),await _0x363ece[_0x2936b6(0x217)](),_0x2d350a['date']=_0x438c5e,_0x2d350a[_0x2936b6(0x15f)]=_0x48b8dd,_0x2d350a['to_warehouse']=_0x4e7968,_0x2d350a[_0x2936b6(0x1c1)]=_0x32331a,_0x2d350a['note']=_0x539a4b,_0x2d350a[_0x2936b6(0x200)]=_0x3c8af4;const _0x1c6441=await _0x2d350a[_0x2936b6(0x217)](),_0xf18f40=await warehouse[_0x2936b6(0x1a3)]({'name':_0x48b8dd,'room':_0x1e94d3});_0x1c6441['product'][_0x2936b6(0x1bb)](_0x200536=>{var _0x572b9c=_0x2936b6;if(_0x200536[_0x572b9c(0x1e2)]>0x0){const _0x129b39=_0xf18f40[_0x572b9c(0x1e6)][_0x572b9c(0x1cb)](_0x5c8374=>{var _0x698bd=_0x572b9c;_0x5c8374[_0x698bd(0x16d)]==_0x200536['product_name']&&_0x5c8374[_0x698bd(0x1ac)]==_0x200536['from_bay']&&(_0x5c8374['product_stock']=parseInt(_0x5c8374[_0x698bd(0x1d4)])-parseInt(_0x200536[_0x698bd(0x1e2)]));});}}),await _0xf18f40[_0x2936b6(0x217)]();const _0x370750=await warehouse[_0x2936b6(0x1a3)]({'name':_0x4e7968,'room':_0x475ec0});_0x1c6441[_0x2936b6(0x1c1)]['forEach'](_0x5a0e40=>{var _0x122ec7=_0x2936b6;if(_0x5a0e40['to_quantity']>0x0){var _0x23e84e=0x0;const _0x27fec1=_0x370750[_0x122ec7(0x1e6)][_0x122ec7(0x1cb)](_0x404613=>{var _0x420d87=_0x122ec7;_0x404613[_0x420d87(0x16d)]==_0x5a0e40['product_name']&&_0x404613[_0x420d87(0x1ac)]==_0x5a0e40[_0x420d87(0x17b)]&&(_0x404613[_0x420d87(0x1d4)]=parseInt(_0x404613[_0x420d87(0x1d4)])+parseInt(_0x5a0e40[_0x420d87(0x1e2)]),_0x23e84e++);});_0x23e84e=='0'&&(_0x370750[_0x122ec7(0x1e6)]=_0x370750[_0x122ec7(0x1e6)][_0x122ec7(0x1f4)]({'product_name':_0x5a0e40[_0x122ec7(0x16d)],'product_stock':_0x5a0e40[_0x122ec7(0x1e2)],'bay':_0x5a0e40[_0x122ec7(0x17b)],'product_code':_0x5a0e40[_0x122ec7(0x14f)],'primary_code':_0x5a0e40[_0x122ec7(0x1e7)],'secondary_code':_0x5a0e40[_0x122ec7(0x187)],'maxProducts':_0x5a0e40[_0x122ec7(0x1f1)]}));}}),await _0x370750[_0x2936b6(0x217)](),_0x271477[_0x2936b6(0x208)](_0x2936b6(0x20c),_0x2936b6(0x206)),_0x1893ec[_0x2936b6(0x157)]('/transfer_finished/view');}catch(_0x132d75){console[_0x2936b6(0x212)](_0x132d75);}}),router[a0_0x383e19(0x140)](a0_0x383e19(0x1e3),async(_0x3d442a,_0x31e46b)=>{var _0x5d961c=a0_0x383e19;const {FromWareHouse:_0x31bd1d,FromRoom:_0x5d7cb8,ToWarehouse:_0x2570ce,ToRoom:_0x31c773,primary_code:_0x4d06e6,Roomslist:_0xb5f1a1}=_0x3d442a[_0x5d961c(0x1cf)],_0x35469b=_0xb5f1a1[_0x5d961c(0x1cd)](','),_0x4dde24=[];async function _0x18d48e(_0x3623a4){var _0x32ea9b=_0x5d961c;const _0x3fb525=await warehouse[_0x32ea9b(0x19f)]([{'$match':{'name':_0x31bd1d,'room':_0x3623a4}},{'$unwind':_0x32ea9b(0x1b3)},{'$match':{'product_details.primary_code':_0x4d06e6}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x32ea9b(0x16a)},'instock':{'$first':_0x32ea9b(0x1c9)},'primary_code':{'$first':_0x32ea9b(0x1a9)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x32ea9b(0x211)},'level':{'$first':_0x32ea9b(0x141)},'isle':{'$first':_0x32ea9b(0x1d0)},'type':{'$first':_0x32ea9b(0x1de)},'pallet':{'$first':_0x32ea9b(0x181)},'unit':{'$first':_0x32ea9b(0x163)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x32ea9b(0x155)},'rack':{'$first':_0x32ea9b(0x1ed)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x32ea9b(0x19b)},'batch_code':{'$first':_0x32ea9b(0x1a0)},'maxPerUnit':{'$first':_0x32ea9b(0x203)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x32ea9b(0x17c)}}}]),_0xe3e541=await warehouse[_0x32ea9b(0x19f)]([{'$match':{'name':_0x31bd1d,'room':_0x3623a4}},{'$unwind':_0x32ea9b(0x1b3)},{'$match':{'product_details.secondary_code':_0x4d06e6}},{'$group':{'_id':_0x32ea9b(0x1c5),'name':{'$first':_0x32ea9b(0x16a)},'instock':{'$first':_0x32ea9b(0x1c9)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x32ea9b(0x1d0)},'type':{'$first':_0x32ea9b(0x1de)},'pallet':{'$first':_0x32ea9b(0x181)},'unit':{'$first':_0x32ea9b(0x163)},'secondary_unit':{'$first':_0x32ea9b(0x144)},'storage':{'$first':_0x32ea9b(0x155)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x32ea9b(0x19b)},'batch_code':{'$first':_0x32ea9b(0x1a0)},'maxPerUnit':{'$first':_0x32ea9b(0x203)},'roomNamed':{'$first':_0x32ea9b(0x1dd)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x32ea9b(0x17c)}}}]);if(_0x3fb525[_0x32ea9b(0x216)]>0x0)_0x4dde24[_0x32ea9b(0x18d)](_0x3fb525);else _0xe3e541[_0x32ea9b(0x216)]>0x0&&_0x4dde24[_0x32ea9b(0x18d)](_0xe3e541);}const _0x2df8a0=_0x35469b['map'](_0x46fdb7=>_0x18d48e(_0x46fdb7));await Promise[_0x5d961c(0x1ec)](_0x2df8a0),_0x31e46b[_0x5d961c(0x180)](_0x4dde24);}),router[a0_0x383e19(0x140)]('/barcode_scanner2',async(_0x50d77c,_0x23870f)=>{var _0x337b01=a0_0x383e19;try{const {FromWareHouse:_0x1d0444,FromRoom:_0x259a01,ToWarehouse:_0x42b109,ToRoom:_0x38c2e5,secondary_code:_0x3a9176}=_0x50d77c[_0x337b01(0x1cf)],_0x1204db=await warehouse['aggregate']([{'$match':{'name':_0x1d0444}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x3a9176}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x337b01(0x1a9)},'secondary_code':{'$first':_0x337b01(0x14c)},'product_code':{'$first':_0x337b01(0x211)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x337b01(0x177)},'isle':{'$first':_0x337b01(0x14d)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x337b01(0x170)},'unit':{'$first':_0x337b01(0x163)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x337b01(0x19b)}}}]);_0x23870f[_0x337b01(0x145)](0xc8)[_0x337b01(0x180)](_0x1204db);}catch(_0x48291b){_0x23870f[_0x337b01(0x145)](0x194)['json']({'message':_0x48291b[_0x337b01(0x149)]});}}),router[a0_0x383e19(0x140)]('/barcode_scanner3',async(_0x5734d2,_0x587827)=>{var _0x4e17ef=a0_0x383e19;try{const {FromWareHouse:_0x118625,FromRoom:_0x583ad2,ToWarehouse:_0x542be2,ToRoom:_0x4dbc1c,product_code:_0x136f64}=_0x5734d2[_0x4e17ef(0x1cf)],_0x13cb58=await warehouse[_0x4e17ef(0x19f)]([{'$match':{'name':_0x118625}},{'$unwind':_0x4e17ef(0x1b3)},{'$match':{'product_details.product_code':_0x136f64}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x4e17ef(0x1a9)},'secondary_code':{'$first':_0x4e17ef(0x14c)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x4e17ef(0x1c9)},'warehouse':{'$first':_0x4e17ef(0x1d6)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x4e17ef(0x14d)},'pallet':{'$first':_0x4e17ef(0x20d)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x4e17ef(0x163)}}}]);_0x587827[_0x4e17ef(0x145)](0xc8)[_0x4e17ef(0x180)](_0x13cb58);}catch(_0x56556f){_0x587827['status'](0x194)[_0x4e17ef(0x180)]({'message':_0x56556f[_0x4e17ef(0x149)]});}}),router[a0_0x383e19(0x140)](a0_0x383e19(0x198),async(_0x591ccf,_0x3aa5f2)=>{var _0x50f9bd=a0_0x383e19;const {productCode:_0x4ad889,bay:_0x3257e9,warehouses:_0x5427c1,room:_0x33be17}=_0x591ccf['body'];console[_0x50f9bd(0x212)](_0x591ccf[_0x50f9bd(0x1cf)]);try{const _0x343e31=await warehouse['aggregate']([{'$match':{'name':_0x5427c1,'room':_0x33be17}},{'$unwind':_0x50f9bd(0x1b3)},{'$match':{'product_details.bay':parseInt(_0x3257e9)}},{'$group':{'_id':_0x50f9bd(0x1c5),'name':{'$first':_0x50f9bd(0x16a)},'product_stock':{'$first':_0x50f9bd(0x1c9)},'bay':{'$first':_0x50f9bd(0x141)},'maxProducts':{'$first':_0x50f9bd(0x170)}}}]);_0x3aa5f2[_0x50f9bd(0x145)](0xc8)['json'](_0x343e31);}catch(_0x49a058){_0x3aa5f2[_0x50f9bd(0x145)](0x194)[_0x50f9bd(0x180)]({'message':_0x49a058[_0x50f9bd(0x149)]});}}),module[a0_0x383e19(0x1d8)]=router;