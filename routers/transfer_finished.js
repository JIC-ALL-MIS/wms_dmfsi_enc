var a0_0x468b86=a0_0x359a;(function(_0x41abf8,_0x5d2557){var _0x105bbb=a0_0x359a,_0x1533d6=_0x41abf8();while(!![]){try{var _0x47cef6=parseInt(_0x105bbb(0x1a4))/0x1*(-parseInt(_0x105bbb(0x1d8))/0x2)+parseInt(_0x105bbb(0x22c))/0x3+parseInt(_0x105bbb(0x23c))/0x4*(parseInt(_0x105bbb(0x255))/0x5)+-parseInt(_0x105bbb(0x17c))/0x6*(-parseInt(_0x105bbb(0x200))/0x7)+parseInt(_0x105bbb(0x1bd))/0x8*(-parseInt(_0x105bbb(0x17e))/0x9)+-parseInt(_0x105bbb(0x258))/0xa+-parseInt(_0x105bbb(0x1ec))/0xb*(parseInt(_0x105bbb(0x23e))/0xc);if(_0x47cef6===_0x5d2557)break;else _0x1533d6['push'](_0x1533d6['shift']());}catch(_0x63e0c3){_0x1533d6['push'](_0x1533d6['shift']());}}}(a0_0x1403,0xb41fd));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x468b86(0x1fe)),users=require(a0_0x468b86(0x1df)),nodemailer=require(a0_0x468b86(0x1bb));router[a0_0x468b86(0x1e2)](a0_0x468b86(0x1f3),auth,async(_0xf3a1ec,_0x174835)=>{var _0x40ab29=a0_0x468b86;try{const {username:_0x718769,email:_0x2286c7,role:_0x137ce9}=_0xf3a1ec[_0x40ab29(0x1c9)],_0x3a075e=_0xf3a1ec[_0x40ab29(0x1c9)],_0x321d91=await profile[_0x40ab29(0x1f1)]({'email':_0x3a075e['email']}),_0x1a5518=await master_shop[_0x40ab29(0x23d)]();let _0x40893b;if(_0x3a075e[_0x40ab29(0x1ac)]==_0x40ab29(0x25a)){const _0x2f6a7b=await staff[_0x40ab29(0x1f1)]({'email':_0x3a075e[_0x40ab29(0x17d)]});_0x40893b=await transfers_finished['find']({'from_warehouse':_0x2f6a7b['warehouse']});}else _0x40893b=await transfers_finished[_0x40ab29(0x259)]([{'$unwind':_0x40ab29(0x1ab)},{'$group':{'_id':_0x40ab29(0x1cc),'invoice':{'$first':_0x40ab29(0x182)},'date':{'$first':_0x40ab29(0x229)},'from_warehouse':{'$first':_0x40ab29(0x1bf)},'to_warehouse':{'$first':_0x40ab29(0x1e4)},'from_room_name':{'$addToSet':_0x40ab29(0x1c1)},'to_room_name':{'$addToSet':_0x40ab29(0x1bc)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x1a5518[0x0][_0x40ab29(0x1ad)]==_0x40ab29(0x181))var _0x44c868=users[_0x40ab29(0x1f0)];else{if(_0x1a5518[0x0][_0x40ab29(0x1ad)]==_0x40ab29(0x23a))var _0x44c868=users[_0x40ab29(0x23a)];else{if(_0x1a5518[0x0][_0x40ab29(0x1ad)]==_0x40ab29(0x1ba))var _0x44c868=users[_0x40ab29(0x1ba)];else{if(_0x1a5518[0x0]['language']==_0x40ab29(0x1a5))var _0x44c868=users[_0x40ab29(0x1a5)];else{if(_0x1a5518[0x0][_0x40ab29(0x1ad)]==_0x40ab29(0x23f))var _0x44c868=users[_0x40ab29(0x23f)];else{if(_0x1a5518[0x0][_0x40ab29(0x1ad)]=='Portuguese\x20(BR)')var _0x44c868=users[_0x40ab29(0x1ae)];else{if(_0x1a5518[0x0]['language']==_0x40ab29(0x227))var _0x44c868=users[_0x40ab29(0x227)];else{if(_0x1a5518[0x0][_0x40ab29(0x1ad)]==_0x40ab29(0x230))var _0x44c868=users[_0x40ab29(0x192)];}}}}}}}_0x174835[_0x40ab29(0x21c)](_0x40ab29(0x19b),{'success':_0xf3a1ec[_0x40ab29(0x23b)](_0x40ab29(0x245)),'errors':_0xf3a1ec[_0x40ab29(0x23b)]('errors'),'role':_0x3a075e,'profile':_0x321d91,'master_shop':_0x1a5518,'transfer':_0x40893b,'language':_0x44c868});}catch(_0x3cb73f){console[_0x40ab29(0x199)](_0x3cb73f);}});async function getRandom8DigitNumber(){var _0x2f2e01=a0_0x468b86;const _0xfb158b=0x989680,_0x145e46=0x5f5e0ff,_0x43dc75=Math['floor'](Math[_0x2f2e01(0x1af)]()*(_0x145e46-_0xfb158b+0x1))+_0xfb158b;var _0x354700;const _0x933fe2=await transfers_finished[_0x2f2e01(0x1f1)]({'invoice':'TRFF-'+_0x43dc75});return _0x933fe2&&_0x933fe2[_0x2f2e01(0x18b)]>0x0?_0x354700=_0x2f2e01(0x1f7)+_0x43dc75:_0x354700=_0x2f2e01(0x1f7)+_0x43dc75,_0x354700;}function a0_0x1403(){var _0x256b5a=['7gXTTUP','abs','Enabled','_id','Portuguese\x20(BR)','$name','to_room','$product_details._id','product_stock','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','warehouse','from_prod_level','to_quantity','<html><head><title></title>','post','ToRoomAssigned','max','maxProducts','error','Transfer\x20Finalize\x20Successfully','QA\x20Warehouse','$room','product','$product_details.level','$product_details.maxProducts','date','from_quantity','render','split','transfer_data','FGSEmail','</head><body>','DRY\x20GOODS','/barcode_scanner2','message','createTransport','</thead>','Error\x20Occurs','Chinese','getFullYear','$date','Email\x20sent\x20successfully','status','4351299pjdDmV','secondary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','from_invoice','Arabic\x20(ae)','from_room_name','MaxStocks_data','</h5>','product_date','port','map','exports','$product_details.product_name','product_details','Hindi','flash','228296XLkrng','find','13133388WiKmSD','French','site_title','/CheckingWarehouse','padStart','password','filter','success','to_room_name','$product_details.rack','Transfer\x20Mail','edit_transfer_finished','Finished\x20Goods','redirect','</tr>','$product_details.batch_code','toString','<strong>\x20Regards\x20</strong>','errors','/upload/','New_Qty_Converted','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Rack\x202','125CzLMJt','save','json','9396870iMCGgQ','aggregate','staff','<h5>','<tr>','Rack\x201','product_name','3610398CGclGe','email','8451WhJTdJ','id_transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','English\x20(US)','$invoice','True','</body></html>','$product_details.invoice','<hr\x20class=\x22my-3\x22>','/picking_list/PDF_transfer/','/transfer_finished/view','undefined','MaxStocks_data2','length','$product_details.expiry_date','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Ambient','then','invoice','/preview/:id','Arabic','$product_details.production_date','To_invoice','secondary_unit','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','</tbody>','$product_details.secondary_unit','log','prod_cat','transfer_finished','$product_details.product_stock','/barcode_scanner3','/view/:id','body','/view/add_transfer','forEach','$product_details.floorlevel','unit','44866HFzAin','Spanish','/transfer_finished/preview/','An\x20error\x20occurred\x20while\x20saving\x20data.','finalize','to_prod_level','$product_details.secondary_code','$product','role','language','Portuguese','random','prod_name','slice','here2','from_bay','FROZEN\x20GOODS','host','$product_details.primary_code','updateOne','from_prod_qty','<div>','German','nodemailer','$product.to_room_name','2584VwTYiD','getDate','$from_warehouse','from_warehouse','$product.from_room_name','/transfer/view','string','push','to_floorlevel','bay','$product_details.unit','concat','user','</table>','\x20<=>\x20','$_id','</td>','to_prod_qty','primary_code','back','\x20</h2>','expiry_date','/barcode_scanner','</span>','$product_details.bay','$product_details.type','$product_details.isle','18AlvFLj','edit_transfer_finished_view','all','to_bay','\x20Order\x20Number\x20:\x20','$product_details.storage','to_warehouse','../public/language/languages.json','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','image','get','findById','$to_warehouse','$product_details.product_code','catch','<!DOCTYPE\x20html>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','production_date','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','primary_unit','11sRTSUv','batch_code','</div>','Logo.png','English','findOne','Product\x20Transfer\x20successfully','/view','to_invoice','$product_details','$product_details.bin','TRFF-','Transfer\x20Edit\x20Successfully','product_code3','$product_details.pallet','params','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<span\x20style=\x22float:\x20right;\x22>','../middleware/auth','maxPerUnit'];a0_0x1403=function(){return _0x256b5a;};return a0_0x1403();}router['get'](a0_0x468b86(0x1a0),auth,async(_0x2f4170,_0x3f2ec1)=>{var _0x19a368=a0_0x468b86;try{const {username:_0x5b9513,email:_0x5c1772,role:_0x437819}=_0x2f4170[_0x19a368(0x1c9)],_0x1693b2=_0x2f4170['user'],_0x1ac97e=await profile['findOne']({'email':_0x1693b2[_0x19a368(0x17d)]}),_0x2e26ca=await master_shop[_0x19a368(0x23d)]();let _0x1a0643;if(_0x1693b2[_0x19a368(0x1ac)]==_0x19a368(0x25a)){const _0x35df29=await staff[_0x19a368(0x1f1)]({'email':_0x1693b2[_0x19a368(0x17d)]});_0x1a0643=await warehouse['aggregate']([{'$match':{'status':_0x19a368(0x202),'name':_0x35df29['warehouse'],'warehouse_category':_0x19a368(0x24a),'name':{'$ne':_0x19a368(0x215)}}},{'$group':{'_id':_0x19a368(0x205),'name':{'$first':_0x19a368(0x205)}}}]);}else _0x1a0643=await warehouse[_0x19a368(0x259)]([{'$match':{'status':_0x19a368(0x202),'warehouse_category':_0x19a368(0x24a),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x19a368(0x205),'name':{'$first':_0x19a368(0x205)}}}]);const _0x399da9=await transfers_finished[_0x19a368(0x23d)]({}),_0x2e468d=_0x399da9[_0x19a368(0x18b)]+0x1,_0x106985=_0x19a368(0x1f7)+_0x2e468d[_0x19a368(0x24e)]()[_0x19a368(0x242)](0x5,'0');if(_0x2e26ca[0x0][_0x19a368(0x1ad)]==_0x19a368(0x181))var _0x2bbb05=users[_0x19a368(0x1f0)];else{if(_0x2e26ca[0x0][_0x19a368(0x1ad)]==_0x19a368(0x23a))var _0x2bbb05=users[_0x19a368(0x23a)];else{if(_0x2e26ca[0x0]['language']==_0x19a368(0x1ba))var _0x2bbb05=users['German'];else{if(_0x2e26ca[0x0]['language']==_0x19a368(0x1a5))var _0x2bbb05=users[_0x19a368(0x1a5)];else{if(_0x2e26ca[0x0][_0x19a368(0x1ad)]==_0x19a368(0x23f))var _0x2bbb05=users[_0x19a368(0x23f)];else{if(_0x2e26ca[0x0][_0x19a368(0x1ad)]==_0x19a368(0x204))var _0x2bbb05=users[_0x19a368(0x1ae)];else{if(_0x2e26ca[0x0][_0x19a368(0x1ad)]==_0x19a368(0x227))var _0x2bbb05=users[_0x19a368(0x227)];else{if(_0x2e26ca[0x0][_0x19a368(0x1ad)]==_0x19a368(0x230))var _0x2bbb05=users[_0x19a368(0x192)];}}}}}}}const _0x467722=getRandom8DigitNumber();_0x467722[_0x19a368(0x18f)](_0x1b9509=>{var _0x4f206f=_0x19a368;_0x3f2ec1[_0x4f206f(0x21c)]('add_transfer_finished',{'success':_0x2f4170[_0x4f206f(0x23b)]('success'),'errors':_0x2f4170[_0x4f206f(0x23b)](_0x4f206f(0x250)),'role':_0x1693b2,'profile':_0x1ac97e,'master_shop':_0x2e26ca,'warehouse':_0x1a0643,'language':_0x2bbb05,'invoice':_0x1b9509});})['catch'](_0x4e6c14=>{var _0x430636=_0x19a368;_0x2f4170[_0x430636(0x23b)](_0x430636(0x250),_0x430636(0x1fc)),_0x3f2ec1['redirect'](_0x430636(0x1c2));});}catch(_0xb0747){console[_0x19a368(0x199)](_0xb0747);}}),router['post'](a0_0x468b86(0x1a0),auth,async(_0x41dea1,_0x1b53fa)=>{var _0x2c5c4f=a0_0x468b86;try{const {date:_0x52a16c,from_warehouse:_0x32ee5b,FromRoom_name:_0x508223,to_warehouse:_0x3bd03d,ToRoom_name:_0x161cb9,prod_name:_0x4773a0,from_prod_qty:_0x3eae59,from_prod_level:_0x44ebe6,from_prod_isle:_0x58115f,from_prod_pallet:_0x4c9572,to_prod_qty:_0x1e3eb0,to_prod_level:_0x27af01,to_prod_isle:_0x5bbb71,to_prod_pallet:_0x15f46f,primary_code:_0x3221d1,secondary_code:_0x139127,product_code3:_0x579a04,note:_0x3a239e,MaxStocks_data2:_0xe00a2d,invoice:_0x11f319,expiry_date:_0x2f59c9}=_0x41dea1[_0x2c5c4f(0x19f)];if(typeof _0x4773a0==_0x2c5c4f(0x1c3))var _0x2685eb=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1b0)]],_0x1da45e=[_0x41dea1['body'][_0x2c5c4f(0x1b8)]],_0x154850=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x20c)]],_0x554b09=[_0x41dea1['body']['New_Qty_Converted']],_0x351d07=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1a9)]],_0x15efa1=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1cf)]],_0x5e5371=[_0x41dea1['body'][_0x2c5c4f(0x22d)]],_0x5d73a1=[_0x41dea1['body'][_0x2c5c4f(0x1f9)]],_0x5d6ba5=[_0x41dea1['body'][_0x2c5c4f(0x18a)]],_0x28a8cb=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1eb)]],_0x1e5b18=[_0x41dea1['body'][_0x2c5c4f(0x195)]],_0x20bd80=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1ed)]],_0x459d56=[_0x41dea1[_0x2c5c4f(0x19f)]['expiry_date']],_0x399f50=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x234)]],_0x538632=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x232)]],_0x3eaea4=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1ff)]],_0x550e80=[_0x41dea1[_0x2c5c4f(0x19f)]['prod_cat']],_0x1d6873=[_0x41dea1[_0x2c5c4f(0x19f)]['RoomAssigned']],_0x1993ca=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x210)]],_0x1dbee4=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x22f)]],_0x44e09f=[_0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1f4)]],_0x24a8ee=[_0x41dea1[_0x2c5c4f(0x19f)]['id_transaction']];else var _0x2685eb=[..._0x41dea1['body'][_0x2c5c4f(0x1b0)]],_0x1da45e=[..._0x41dea1['body'][_0x2c5c4f(0x1b8)]],_0x154850=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x20c)]],_0x554b09=[..._0x41dea1['body'][_0x2c5c4f(0x252)]],_0x351d07=[..._0x41dea1['body']['to_prod_level']],_0x15efa1=[..._0x41dea1[_0x2c5c4f(0x19f)]['primary_code']],_0x5e5371=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x22d)]],_0x5d73a1=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1f9)]],_0x5d6ba5=[..._0x41dea1['body'][_0x2c5c4f(0x18a)]],_0x28a8cb=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1eb)]],_0x1e5b18=[..._0x41dea1[_0x2c5c4f(0x19f)]['secondary_unit']],_0x20bd80=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1ed)]],_0x459d56=[..._0x41dea1['body'][_0x2c5c4f(0x1d2)]],_0x399f50=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x234)]],_0x538632=[..._0x41dea1[_0x2c5c4f(0x19f)]['MaxStocks_data']],_0x3eaea4=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1ff)]],_0x550e80=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x19a)]],_0x1d6873=[..._0x41dea1[_0x2c5c4f(0x19f)]['RoomAssigned']],_0x1993ca=[..._0x41dea1['body'][_0x2c5c4f(0x210)]],_0x1dbee4=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x22f)]],_0x44e09f=[..._0x41dea1[_0x2c5c4f(0x19f)][_0x2c5c4f(0x1f4)]],_0x24a8ee=[..._0x41dea1['body'][_0x2c5c4f(0x17f)]];const _0x2de5e3=_0x2685eb['map'](_0x20b050=>{return _0x20b050={'product_name':_0x20b050};});_0x1da45e[_0x2c5c4f(0x1a1)]((_0x2a54b1,_0x5a5758)=>{_0x2de5e3[_0x5a5758]['from_quantity']=_0x2a54b1;}),_0x154850['forEach']((_0x68cd1,_0x347bcf)=>{var _0x462684=_0x2c5c4f;_0x2de5e3[_0x347bcf][_0x462684(0x1b3)]=_0x68cd1;}),_0x24a8ee[_0x2c5c4f(0x1a1)]((_0x419aac,_0x450314)=>{var _0x370a74=_0x2c5c4f;_0x2de5e3[_0x450314][_0x370a74(0x17f)]=_0x419aac;}),_0x1dbee4['forEach']((_0x4755ed,_0x258955)=>{_0x2de5e3[_0x258955]['from_invoice']=_0x4755ed;}),_0x44e09f[_0x2c5c4f(0x1a1)]((_0xbb7acb,_0x23a08c)=>{var _0x35fcf2=_0x2c5c4f;_0x2de5e3[_0x23a08c][_0x35fcf2(0x194)]=_0xbb7acb;}),_0x554b09[_0x2c5c4f(0x1a1)]((_0x5bd9ab,_0x4ae298)=>{var _0x4b2773=_0x2c5c4f;_0x2de5e3[_0x4ae298][_0x4b2773(0x20d)]=_0x5bd9ab;}),_0x351d07[_0x2c5c4f(0x1a1)]((_0x2e347a,_0x27fc94)=>{var _0x46253d=_0x2c5c4f;_0x2de5e3[_0x27fc94][_0x46253d(0x1db)]=_0x2e347a;}),_0x15efa1[_0x2c5c4f(0x1a1)]((_0x107f68,_0x337f7c)=>{var _0x130639=_0x2c5c4f;_0x2de5e3[_0x337f7c][_0x130639(0x1cf)]=_0x107f68;}),_0x5e5371[_0x2c5c4f(0x1a1)]((_0x22c283,_0x29b49e)=>{var _0x9c3893=_0x2c5c4f;_0x2de5e3[_0x29b49e][_0x9c3893(0x22d)]=_0x22c283;}),_0x5d73a1[_0x2c5c4f(0x1a1)]((_0x5b82f5,_0x470e9d)=>{var _0x1d522b=_0x2c5c4f;_0x2de5e3[_0x470e9d][_0x1d522b(0x209)]=_0x5b82f5;}),_0x5d6ba5[_0x2c5c4f(0x1a1)]((_0x3c910b,_0x38fbc9)=>{_0x2de5e3[_0x38fbc9]['maxProducts']=_0x3c910b;}),_0x28a8cb[_0x2c5c4f(0x1a1)]((_0xc8dcbe,_0x349b35)=>{var _0x16f1c6=_0x2c5c4f;_0x2de5e3[_0x349b35][_0x16f1c6(0x1a3)]=_0xc8dcbe;}),_0x1e5b18[_0x2c5c4f(0x1a1)]((_0x357d8d,_0x53e402)=>{var _0x49cb04=_0x2c5c4f;_0x2de5e3[_0x53e402][_0x49cb04(0x195)]=_0x357d8d;}),_0x20bd80[_0x2c5c4f(0x1a1)]((_0x4978cf,_0x427ee5)=>{var _0x4da687=_0x2c5c4f;_0x2de5e3[_0x427ee5][_0x4da687(0x1ed)]=_0x4978cf;}),_0x459d56[_0x2c5c4f(0x1a1)]((_0x55d9a7,_0x27c8de)=>{var _0x3824ca=_0x2c5c4f;_0x2de5e3[_0x27c8de][_0x3824ca(0x1d2)]=_0x55d9a7;}),_0x399f50[_0x2c5c4f(0x1a1)]((_0x15737e,_0xb0797a)=>{_0x2de5e3[_0xb0797a]['production_date']=_0x15737e;}),_0x538632[_0x2c5c4f(0x1a1)]((_0x4f8d22,_0x52eabf)=>{var _0x257659=_0x2c5c4f;_0x2de5e3[_0x52eabf][_0x257659(0x212)]=_0x4f8d22;}),_0x3eaea4[_0x2c5c4f(0x1a1)]((_0x3b955e,_0x3dbaa4)=>{var _0x522503=_0x2c5c4f;_0x2de5e3[_0x3dbaa4][_0x522503(0x1ff)]=_0x3b955e;}),_0x550e80['forEach']((_0x2450eb,_0x29a674)=>{var _0x19dde9=_0x2c5c4f;_0x2de5e3[_0x29a674][_0x19dde9(0x19a)]=_0x2450eb;}),_0x1d6873['forEach']((_0x49796a,_0x146650)=>{_0x2de5e3[_0x146650]['from_room_name']=_0x49796a;}),_0x1993ca['forEach']((_0x263235,_0x5b221b)=>{var _0x1cf249=_0x2c5c4f;_0x2de5e3[_0x5b221b][_0x1cf249(0x246)]=_0x263235;});const _0x1035e7=_0x2de5e3['filter'](_0x3ccea2=>_0x3ccea2[_0x2c5c4f(0x20d)]!=='0'&&_0x3ccea2[_0x2c5c4f(0x20d)]!==''||_0x3ccea2[_0x2c5c4f(0x1c5)]!=='0'&&_0x3ccea2['to_floorlevel']!=='');var _0x41b7ed=0x0;_0x1035e7[_0x2c5c4f(0x1a1)](_0xce62ce=>{var _0x372304=_0x2c5c4f;parseInt(_0xce62ce[_0x372304(0x21b)])<parseInt(_0xce62ce['to_quantity'])&&_0x41b7ed++;});if(_0x41b7ed!=0x0)return _0x41dea1[_0x2c5c4f(0x23b)]('errors',_0x2c5c4f(0x1ea)),_0x1b53fa['redirect'](_0x2c5c4f(0x1d0));const _0x1fa2f4=new transfers_finished({'date':_0x52a16c,'from_warehouse':_0x32ee5b,'to_warehouse':_0x3bd03d,'product':_0x1035e7,'note':_0x3a239e,'invoice':_0x11f319}),_0x709687=await _0x1fa2f4[_0x2c5c4f(0x256)]();_0x41dea1[_0x2c5c4f(0x23b)](_0x2c5c4f(0x245),_0x2c5c4f(0x1f2)),_0x1b53fa[_0x2c5c4f(0x24b)](_0x2c5c4f(0x1a6)+_0x709687[_0x2c5c4f(0x203)]);}catch(_0x1036ad){console[_0x2c5c4f(0x199)](_0x1036ad),_0x1b53fa[_0x2c5c4f(0x22b)](0xc8)['json']({'errorMessage':_0x1036ad[_0x2c5c4f(0x223)]});}}),router[a0_0x468b86(0x1e2)](a0_0x468b86(0x191),auth,async(_0x1bf656,_0x4a4aef)=>{var _0x6b289a=a0_0x468b86;try{const {username:_0x26f8b1,email:_0x3c1615,role:_0x3fe1a6}=_0x1bf656[_0x6b289a(0x1c9)],_0x127a35=_0x1bf656['user'],_0x2996a8=await profile[_0x6b289a(0x1f1)]({'email':_0x127a35[_0x6b289a(0x17d)]}),_0x19af98=await master_shop[_0x6b289a(0x23d)](),_0x29c261=await transfers_finished[_0x6b289a(0x1e3)](_0x1bf656['params']['id']);let _0x452ed7;if(_0x127a35[_0x6b289a(0x1ac)]=='staff'){const _0x13db51=await staff[_0x6b289a(0x1f1)]({'email':_0x127a35['email']});_0x452ed7=await warehouse[_0x6b289a(0x23d)]({'status':_0x6b289a(0x202),'name':_0x13db51[_0x6b289a(0x20b)],'warehouse_category':_0x6b289a(0x24a)});}else _0x452ed7=await warehouse[_0x6b289a(0x23d)]({'status':_0x6b289a(0x202),'warehouse_category':_0x6b289a(0x24a)});const _0x5b31d5=await warehouse[_0x6b289a(0x259)]([{'$match':{'name':_0x29c261[_0x6b289a(0x1c0)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x6b289a(0x207),'name':{'$first':_0x6b289a(0x238)},'product_stock':{'$first':_0x6b289a(0x19c)},'bay':{'$first':_0x6b289a(0x1d5)},'bin':{'$first':_0x6b289a(0x1f6)},'type':{'$first':_0x6b289a(0x1d6)},'floorlevel':{'$first':_0x6b289a(0x1a2)},'primary_code':{'$first':_0x6b289a(0x1b6)},'secondary_code':{'$first':_0x6b289a(0x1aa)},'product_code':{'$first':_0x6b289a(0x1e5)},'storage':{'$first':_0x6b289a(0x1dd)},'rack':{'$first':_0x6b289a(0x247)},'expiry_date':{'$first':_0x6b289a(0x18c)},'production_date':{'$first':_0x6b289a(0x193)},'room':{'$first':_0x6b289a(0x216)},'warehoue_name':{'$first':'$name'}}}]),_0x2b4e82=await product[_0x6b289a(0x23d)]({});if(_0x19af98[0x0][_0x6b289a(0x1ad)]==_0x6b289a(0x181)){var _0x457c83=users[_0x6b289a(0x1f0)];console[_0x6b289a(0x199)](_0x457c83);}else{if(_0x19af98[0x0][_0x6b289a(0x1ad)]==_0x6b289a(0x23a))var _0x457c83=users[_0x6b289a(0x23a)];else{if(_0x19af98[0x0][_0x6b289a(0x1ad)]==_0x6b289a(0x1ba))var _0x457c83=users[_0x6b289a(0x1ba)];else{if(_0x19af98[0x0][_0x6b289a(0x1ad)]==_0x6b289a(0x1a5))var _0x457c83=users['Spanish'];else{if(_0x19af98[0x0][_0x6b289a(0x1ad)]==_0x6b289a(0x23f))var _0x457c83=users['French'];else{if(_0x19af98[0x0][_0x6b289a(0x1ad)]=='Portuguese\x20(BR)')var _0x457c83=users[_0x6b289a(0x1ae)];else{if(_0x19af98[0x0][_0x6b289a(0x1ad)]==_0x6b289a(0x227))var _0x457c83=users[_0x6b289a(0x227)];else{if(_0x19af98[0x0][_0x6b289a(0x1ad)]==_0x6b289a(0x230))var _0x457c83=users[_0x6b289a(0x192)];}}}}}}}_0x4a4aef['render'](_0x6b289a(0x1d9),{'success':_0x1bf656[_0x6b289a(0x23b)](_0x6b289a(0x245)),'errors':_0x1bf656['flash'](_0x6b289a(0x250)),'role':_0x127a35,'profile':_0x2996a8,'master_shop':_0x19af98,'warehouse':_0x452ed7,'transfer':_0x29c261,'stock':_0x5b31d5,'unit':_0x2b4e82,'language':_0x457c83});}catch(_0x562ad1){console[_0x6b289a(0x199)](_0x562ad1);}}),router[a0_0x468b86(0x20f)](a0_0x468b86(0x191),auth,async(_0xe722b2,_0x36115f)=>{var _0x510af7=a0_0x468b86;try{const {invoice:_0x5d8c76,from_warehouse:_0x277c8e,FromRoom_name:_0x2a72b1,to_warehouse:_0x4f149b,ToRoom_name:_0x47861b}=_0xe722b2[_0x510af7(0x19f)],_0x11c897=await transfers_finished[_0x510af7(0x1e3)](_0xe722b2[_0x510af7(0x1fb)]['id']),_0x3d3e14=_0x11c897['product'][_0x510af7(0x236)](async _0x23f02f=>{var _0x377590=_0x510af7;if(_0x23f02f[_0x377590(0x20d)]>0x0){var _0x2719ad=await warehouse[_0x377590(0x1f1)]({'name':_0x277c8e,'room':_0x23f02f[_0x377590(0x231)],'warehouse_category':_0x377590(0x24a)});const _0x2a8a8d=_0x2719ad['product_details']['map'](_0x1749f6=>{var _0x4e2c79=_0x377590;_0x1749f6[_0x4e2c79(0x17b)]==_0x23f02f['product_name']&&_0x1749f6[_0x4e2c79(0x1c6)]==_0x23f02f['from_bay']&&_0x1749f6['expiry_date']==_0x23f02f[_0x4e2c79(0x1d2)]&&_0x1749f6['production_date']==_0x23f02f[_0x4e2c79(0x1e9)]&&_0x1749f6[_0x4e2c79(0x1ed)]==_0x23f02f[_0x4e2c79(0x1ed)]&&_0x1749f6[_0x4e2c79(0x190)]==_0x23f02f['from_invoice']&&(console['log']('here1',_0x1749f6[_0x4e2c79(0x208)]),typeof _0x23f02f[_0x4e2c79(0x17f)]==_0x4e2c79(0x189)?_0x1749f6[_0x4e2c79(0x208)]=Math[_0x4e2c79(0x211)](0x0,Math[_0x4e2c79(0x201)](_0x1749f6[_0x4e2c79(0x208)])-Math[_0x4e2c79(0x201)](_0x23f02f['to_quantity'])):_0x1749f6[_0x4e2c79(0x208)]=Math[_0x4e2c79(0x211)](0x0,Math['abs'](_0x1749f6[_0x4e2c79(0x208)])-Math['abs'](_0x23f02f[_0x4e2c79(0x20d)])));});}return _0x2719ad;});Promise['all'](_0x3d3e14)[_0x510af7(0x18f)](async _0x55d19d=>{var _0x4ce498=_0x510af7;try{for(const _0x198149 of _0x55d19d){await _0x198149['save']();}const _0x45d093=_0x11c897[_0x4ce498(0x217)][_0x4ce498(0x236)](async _0x3c5dc2=>{var _0x45b3d3=_0x4ce498,_0x342f50=await warehouse[_0x45b3d3(0x1f1)]({'name':_0x4f149b,'room':_0x3c5dc2[_0x45b3d3(0x246)]});if(_0x3c5dc2[_0x45b3d3(0x20d)]>0x0){var _0xbc311e=0x0;const _0x988c47=_0x342f50[_0x45b3d3(0x239)]['map'](_0x3d15c7=>{var _0x23cb69=_0x45b3d3;_0x3d15c7[_0x23cb69(0x17b)]==_0x3c5dc2[_0x23cb69(0x17b)]&&_0x3d15c7[_0x23cb69(0x1c6)]==_0x3c5dc2[_0x23cb69(0x1db)]&&_0x3d15c7[_0x23cb69(0x1d2)]==_0x3c5dc2[_0x23cb69(0x1d2)]&&_0x3d15c7['production_date']==_0x3c5dc2['production_date']&&_0x3d15c7['batch_code']==_0x3c5dc2['batch_code']&&_0x3d15c7[_0x23cb69(0x190)]==_0x3c5dc2['To_invoice']&&(typeof _0x3c5dc2[_0x23cb69(0x17f)]=='undefined'?(console['log'](_0x23cb69(0x1b2),_0x3d15c7[_0x23cb69(0x208)]+'\x20<>\x20'+_0x3d15c7['_id']+_0x23cb69(0x1cb)+Math[_0x23cb69(0x201)](_0x3d15c7[_0x23cb69(0x208)])+Math[_0x23cb69(0x201)](_0x3c5dc2[_0x23cb69(0x20d)])),_0x3d15c7[_0x23cb69(0x208)]=Math[_0x23cb69(0x201)](_0x3d15c7[_0x23cb69(0x208)])+Math[_0x23cb69(0x201)](_0x3c5dc2[_0x23cb69(0x20d)])):_0x3d15c7[_0x23cb69(0x208)]=Math[_0x23cb69(0x201)](_0x3d15c7[_0x23cb69(0x208)])+Math[_0x23cb69(0x201)](_0x3c5dc2[_0x23cb69(0x20d)]),_0xbc311e++);});_0xbc311e=='0'&&(_0x342f50['product_details']=_0x342f50[_0x45b3d3(0x239)][_0x45b3d3(0x1c8)]({'product_name':_0x3c5dc2[_0x45b3d3(0x17b)],'product_stock':_0x3c5dc2[_0x45b3d3(0x20d)],'bay':_0x3c5dc2['to_bay'],'product_code':_0x3c5dc2[_0x45b3d3(0x209)],'primary_code':_0x3c5dc2[_0x45b3d3(0x1cf)],'secondary_code':_0x3c5dc2[_0x45b3d3(0x22d)],'expiry_date':_0x3c5dc2[_0x45b3d3(0x1d2)],'production_date':_0x3c5dc2['production_date'],'maxProducts':_0x3c5dc2[_0x45b3d3(0x212)],'batch_code':_0x3c5dc2['batch_code'],'secondary_unit':_0x3c5dc2[_0x45b3d3(0x195)],'unit':_0x3c5dc2['unit'],'maxProducts':_0x3c5dc2[_0x45b3d3(0x212)],'maxPerUnit':_0x3c5dc2[_0x45b3d3(0x1ff)],'invoice':_0x3c5dc2['To_invoice']}));}return _0x342f50;});Promise[_0x4ce498(0x1da)](_0x45d093)[_0x4ce498(0x18f)](async _0x3270dc=>{var _0x3a5dfc=_0x4ce498;try{for(const _0x2a03a4 of _0x3270dc){await warehouse[_0x3a5dfc(0x1b7)]({'_id':_0x2a03a4['_id']},{'$addToSet':{'product_details':{'$each':_0x2a03a4[_0x3a5dfc(0x239)]}}});}_0x11c897[_0x3a5dfc(0x1a8)]=_0x3a5dfc(0x183);const _0x7ce3ef=await _0x11c897['save'](),_0x330d1d=await master_shop[_0x3a5dfc(0x23d)](),_0xd20acd=await email_settings[_0x3a5dfc(0x1f1)](),_0x2930c8=await supervisor_settings[_0x3a5dfc(0x23d)]();var _0x2ac459=_0x11c897[_0x3a5dfc(0x217)],_0x3a9673='',_0x98dbde;for(_0x98dbde in _0x2ac459){var _0x6df415='FG';_0x11c897[_0x3a5dfc(0x1de)]==_0x3a5dfc(0x221)&&(_0x6df415='DG'),_0x3a9673+=_0x3a5dfc(0x25c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2ac459[_0x98dbde][_0x3a5dfc(0x17b)]+_0x3a5dfc(0x1cd)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2ac459[_0x98dbde][_0x3a5dfc(0x209)]+_0x3a5dfc(0x1cd)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2ac459[_0x98dbde][_0x3a5dfc(0x20d)]+_0x3a5dfc(0x1cd)+_0x3a5dfc(0x22e)+_0x2ac459[_0x98dbde][_0x3a5dfc(0x1a3)]+_0x3a5dfc(0x1cd)+_0x3a5dfc(0x22e)+_0x2ac459[_0x98dbde][_0x3a5dfc(0x195)]+_0x3a5dfc(0x1cd)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x11c897[_0x3a5dfc(0x1de)]+_0x3a5dfc(0x1cd)+_0x3a5dfc(0x22e)+_0x2ac459[_0x98dbde][_0x3a5dfc(0x246)]+_0x3a5dfc(0x1cd)+_0x3a5dfc(0x22e)+_0x6df415+_0x2ac459[_0x98dbde]['to_bay']+_0x3a5dfc(0x1cd)+'</tr>';}let _0x3fee42=nodemailer[_0x3a5dfc(0x224)]({'host':_0xd20acd[_0x3a5dfc(0x1b5)],'port':Number(_0xd20acd[_0x3a5dfc(0x235)]),'secure':![],'auth':{'user':_0xd20acd[_0x3a5dfc(0x17d)],'pass':_0xd20acd[_0x3a5dfc(0x243)]}}),_0x342993={'from':_0xd20acd[_0x3a5dfc(0x17d)],'to':_0x2930c8[0x0][_0x3a5dfc(0x21f)],'subject':_0x3a5dfc(0x248),'attachments':[{'filename':_0x3a5dfc(0x1ef),'path':__dirname+'/../public'+_0x3a5dfc(0x251)+_0x330d1d[0x0][_0x3a5dfc(0x1e1)],'cid':'logo'}],'html':_0x3a5dfc(0x1e7)+_0x3a5dfc(0x20e)+_0x3a5dfc(0x220)+_0x3a5dfc(0x1b9)+_0x3a5dfc(0x196)+_0x3a5dfc(0x1b9)+_0x3a5dfc(0x18d)+_0x3a5dfc(0x1ee)+_0x3a5dfc(0x1b9)+'<h2>\x20'+_0x330d1d[0x0]['site_title']+_0x3a5dfc(0x1d1)+_0x3a5dfc(0x1ee)+_0x3a5dfc(0x1ee)+_0x3a5dfc(0x186)+_0x3a5dfc(0x1b9)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x3a5dfc(0x1dc)+_0x11c897[_0x3a5dfc(0x190)]+'\x20'+_0x3a5dfc(0x1fd)+'\x20Order\x20Date\x20:\x20'+_0x11c897[_0x3a5dfc(0x21a)]+'\x20'+_0x3a5dfc(0x1d4)+_0x3a5dfc(0x233)+_0x3a5dfc(0x1ee)+_0x3a5dfc(0x253)+_0x3a5dfc(0x1e0)+_0x3a5dfc(0x25c)+_0x3a5dfc(0x1e8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x3a5dfc(0x180)+_0x3a5dfc(0x20a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x3a5dfc(0x24c)+_0x3a5dfc(0x225)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3a9673+'\x20'+_0x3a5dfc(0x197)+_0x3a5dfc(0x1ca)+_0x3a5dfc(0x1b9)+_0x3a5dfc(0x24f)+_0x3a5dfc(0x25b)+_0x330d1d[0x0][_0x3a5dfc(0x240)]+_0x3a5dfc(0x233)+_0x3a5dfc(0x1ee)+_0x3a5dfc(0x1ee)+_0x3a5dfc(0x184)};_0x3fee42['sendMail'](_0x342993,function(_0x474758,_0x896d5f){var _0x577d9d=_0x3a5dfc;_0x474758?(console['log'](_0x474758),console[_0x577d9d(0x199)](_0x577d9d(0x226))):console[_0x577d9d(0x199)](_0x577d9d(0x22a));}),_0xe722b2[_0x3a5dfc(0x23b)](_0x3a5dfc(0x245),_0x3a5dfc(0x214)),_0x36115f[_0x3a5dfc(0x24b)](_0x3a5dfc(0x187)+_0x7ce3ef[_0x3a5dfc(0x203)]);}catch(_0x4b44e5){console[_0x3a5dfc(0x213)](_0x4b44e5),_0x36115f[_0x3a5dfc(0x22b)](0x1f4)['json']({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x4ce498(0x1e6)](_0x471a0c=>{var _0x369b69=_0x4ce498;console[_0x369b69(0x213)](_0x471a0c),_0x36115f[_0x369b69(0x22b)](0x1f4)[_0x369b69(0x257)]({'error':'An\x20error\x20occurred.'});});}catch(_0x2ed569){console[_0x4ce498(0x213)](_0x2ed569),_0x36115f[_0x4ce498(0x22b)](0x1f4)[_0x4ce498(0x257)]({'error':_0x4ce498(0x1a7)});}})[_0x510af7(0x1e6)](_0x1c5fcf=>{var _0x1584d1=_0x510af7;console[_0x1584d1(0x213)](_0x1c5fcf),_0x36115f[_0x1584d1(0x22b)](0x1f4)[_0x1584d1(0x257)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3b8544){_0x36115f[_0x510af7(0x257)]({'message':_0x3b8544[_0x510af7(0x223)]});}});function a0_0x359a(_0x590bb8,_0x2d27af){var _0x1403ee=a0_0x1403();return a0_0x359a=function(_0x359a01,_0x204060){_0x359a01=_0x359a01-0x17a;var _0x516f7c=_0x1403ee[_0x359a01];return _0x516f7c;},a0_0x359a(_0x590bb8,_0x2d27af);}function BayBinSelected(_0x3428bd,_0x1814de){var _0x61d2fb=a0_0x468b86,_0x19b913=[];let _0x1fe220=[];var _0x50b9b2=[];if(_0x3428bd==_0x61d2fb(0x221)){switch(_0x1814de){case _0x61d2fb(0x17a):_0x19b913=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x61d2fb(0x254):_0x19b913=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x50b9b2=['DG'];}else{if(_0x3428bd==_0x61d2fb(0x1b4)){switch(_0x1814de){case _0x61d2fb(0x17a):_0x19b913=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x61d2fb(0x254):_0x19b913=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x50b9b2=['FG'];}}return{'levels':_0x19b913,'identify':_0x50b9b2};}router['get'](a0_0x468b86(0x19e),auth,async(_0x5a940b,_0x190c2f)=>{var _0x5e148c=a0_0x468b86;try{const {username:_0x415a56,email:_0x4da4eb,role:_0x10222b}=_0x5a940b[_0x5e148c(0x1c9)],_0x577f5e=_0x5a940b['user'],_0x964ca=await profile[_0x5e148c(0x1f1)]({'email':_0x577f5e['email']}),_0x2f8e99=await master_shop[_0x5e148c(0x23d)](),_0x417ec2=await transfers_finished[_0x5e148c(0x1e3)](_0x5a940b[_0x5e148c(0x1fb)]['id']);let _0x50410a=new Date(_0x417ec2[_0x5e148c(0x1d2)]),_0x2d2b49=('0'+_0x50410a[_0x5e148c(0x1be)]())[_0x5e148c(0x1b1)](-0x2),_0x40c1b1=('0'+(_0x50410a['getMonth']()+0x1))[_0x5e148c(0x1b1)](-0x2),_0x42e560=_0x50410a[_0x5e148c(0x228)](),_0x48cc64=_0x42e560+'-'+_0x40c1b1+'-'+_0x2d2b49,_0x2d0e04;if(_0x577f5e[_0x5e148c(0x1ac)]==_0x5e148c(0x25a)){const _0x32adce=await staff['findOne']({'email':_0x577f5e[_0x5e148c(0x17d)]});_0x2d0e04=await warehouse[_0x5e148c(0x23d)]({'status':_0x5e148c(0x202),'name':_0x32adce[_0x5e148c(0x20b)],'warehouse_category':'Finished\x20Goods'});}else _0x2d0e04=await warehouse['find']({'status':_0x5e148c(0x202),'warehouse_category':'Finished\x20Goods'});const _0xe7046a=await warehouse['aggregate']([{'$match':{'name':_0x417ec2[_0x5e148c(0x1c0)],'room':_0x417ec2['from_room']}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5e148c(0x238)},'product_stock':{'$first':_0x5e148c(0x19c)},'bay':{'$first':_0x5e148c(0x1d5)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x5e148c(0x1d6)},'floorlevel':{'$first':_0x5e148c(0x1a2)},'primary_code':{'$first':_0x5e148c(0x1b6)},'secondary_code':{'$first':_0x5e148c(0x1aa)},'product_code':{'$first':_0x5e148c(0x1e5)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5e148c(0x247)}}}]);var _0x3c09bc=[0x1,0x2,0x3,0x4],_0x5e9290=['A','B','C','D','E','F','G','H','I','J'],_0x7bae47=[_0x5e148c(0x18e),'Enclosed'];const _0x42f961=await product[_0x5e148c(0x23d)]({}),_0x23a679=BayBinSelected(_0x417ec2[_0x5e148c(0x1de)],_0x417ec2[_0x5e148c(0x206)]);if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]==_0x5e148c(0x181)){var _0x5a99d0=users[_0x5e148c(0x1f0)];console[_0x5e148c(0x199)](_0x5a99d0);}else{if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]=='Hindi')var _0x5a99d0=users[_0x5e148c(0x23a)];else{if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]==_0x5e148c(0x1ba))var _0x5a99d0=users['German'];else{if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]=='Spanish')var _0x5a99d0=users['Spanish'];else{if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]=='French')var _0x5a99d0=users[_0x5e148c(0x23f)];else{if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]==_0x5e148c(0x204))var _0x5a99d0=users[_0x5e148c(0x1ae)];else{if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]==_0x5e148c(0x227))var _0x5a99d0=users[_0x5e148c(0x227)];else{if(_0x2f8e99[0x0][_0x5e148c(0x1ad)]=='Arabic\x20(ae)')var _0x5a99d0=users[_0x5e148c(0x192)];}}}}}}}_0x190c2f['render'](_0x5e148c(0x249),{'success':_0x5a940b[_0x5e148c(0x23b)](_0x5e148c(0x245)),'errors':_0x5a940b[_0x5e148c(0x23b)](_0x5e148c(0x250)),'role':_0x577f5e,'profile':_0x964ca,'master_shop':_0x2f8e99,'warehouse':_0x2d0e04,'transfer':_0x417ec2,'stock':_0xe7046a,'unit':_0x42f961,'language':_0x5a99d0,'levels':_0x3c09bc,'Isle':_0x5e9290,'rooms_data':_0x7bae47,'ed_fullDate':_0x48cc64,'dataSelected':_0x23a679});}catch(_0x2b917f){console[_0x5e148c(0x199)](_0x2b917f);}}),router[a0_0x468b86(0x20f)](a0_0x468b86(0x19e),auth,async(_0x3d9722,_0x24cfbf)=>{var _0x213d92=a0_0x468b86;try{const _0x370e77=_0x3d9722['params']['id'];console['log'](_0x3d9722[_0x213d92(0x19f)]);const _0x182339=await transfers_finished[_0x213d92(0x1e3)](_0x370e77);console[_0x213d92(0x199)](_0x213d92(0x21e),_0x182339);const {date:_0x1906ce,from_warehouse:_0x2bb458,FromRoom_name:_0x4df086,to_warehouse:_0x3c1bd4,ToRoom_name:_0x4f4292,prod_name:_0x4ac59d,from_prod_qty:_0x27f86e,from_prod_level:_0x4208d6,from_prod_isle:_0x5cb2a4,from_prod_pallet:_0x205bfa,to_prod_qty:_0x5dfad2,to_prod_level:_0x452b96,to_prod_isle:_0x40bb6f,to_prod_pallet:_0x2b1787,primary_code:_0x14e9ac,secondary_code:_0x3d1db5,product_code3:_0x26053e,note:_0x2ce747,invoice:_0x203101,expiry_date:_0x258a2a}=_0x3d9722[_0x213d92(0x19f)];if(typeof _0x4ac59d==_0x213d92(0x1c3))var _0x358560=[_0x3d9722[_0x213d92(0x19f)]['prod_name']],_0x286372=[_0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1b8)]],_0x535bb2=[_0x3d9722[_0x213d92(0x19f)][_0x213d92(0x20c)]],_0x55c3de=[_0x3d9722['body'][_0x213d92(0x1ce)]],_0x543bda=[_0x3d9722[_0x213d92(0x19f)]['to_prod_level']],_0x41cd51=[_0x3d9722['body'][_0x213d92(0x1cf)]],_0x3e2bfb=[_0x3d9722[_0x213d92(0x19f)][_0x213d92(0x22d)]],_0x5db262=[_0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1f9)]],_0x24e20d=[_0x3d9722[_0x213d92(0x19f)][_0x213d92(0x18a)]],_0x3cd3c6=[_0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1a3)]],_0x54cbfd=[_0x3d9722['body'][_0x213d92(0x195)]],_0x2e1343=[_0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1ed)]],_0x71c3db=[_0x3d9722[_0x213d92(0x19f)]['expiry_date']];else var _0x358560=[..._0x3d9722['body'][_0x213d92(0x1b0)]],_0x286372=[..._0x3d9722['body'][_0x213d92(0x1b8)]],_0x535bb2=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x20c)]],_0x55c3de=[..._0x3d9722['body'][_0x213d92(0x1ce)]],_0x543bda=[..._0x3d9722[_0x213d92(0x19f)]['to_prod_level']],_0x41cd51=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1cf)]],_0x3e2bfb=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x22d)]],_0x5db262=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1f9)]],_0x24e20d=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x18a)]],_0x3cd3c6=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1a3)]],_0x54cbfd=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x195)]],_0x2e1343=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1ed)]],_0x71c3db=[..._0x3d9722[_0x213d92(0x19f)][_0x213d92(0x1d2)]];const _0x30e8e9=_0x358560['map'](_0x1c3897=>{return _0x1c3897={'product_name':_0x1c3897};});_0x286372[_0x213d92(0x1a1)]((_0x14f8e3,_0x3bd6e1)=>{var _0x243f51=_0x213d92;_0x30e8e9[_0x3bd6e1][_0x243f51(0x21b)]=_0x14f8e3;}),_0x535bb2[_0x213d92(0x1a1)]((_0x22f1a9,_0x2e649b)=>{var _0x308358=_0x213d92;_0x30e8e9[_0x2e649b][_0x308358(0x1b3)]=_0x22f1a9;}),_0x55c3de[_0x213d92(0x1a1)]((_0x2ddd2e,_0x5c677b)=>{var _0x588a41=_0x213d92;_0x30e8e9[_0x5c677b][_0x588a41(0x20d)]=_0x2ddd2e;}),_0x543bda[_0x213d92(0x1a1)]((_0x285446,_0xdc2b89)=>{var _0x2e0a1f=_0x213d92;_0x30e8e9[_0xdc2b89][_0x2e0a1f(0x1db)]=_0x285446;}),_0x41cd51[_0x213d92(0x1a1)]((_0x32eca5,_0x1c1553)=>{var _0x7d8163=_0x213d92;_0x30e8e9[_0x1c1553][_0x7d8163(0x1cf)]=_0x32eca5;}),_0x3e2bfb[_0x213d92(0x1a1)]((_0xb1f997,_0x1aa49d)=>{var _0x26d402=_0x213d92;_0x30e8e9[_0x1aa49d][_0x26d402(0x22d)]=_0xb1f997;}),_0x5db262[_0x213d92(0x1a1)]((_0x478f90,_0x3f453b)=>{var _0x433604=_0x213d92;_0x30e8e9[_0x3f453b][_0x433604(0x209)]=_0x478f90;}),_0x24e20d[_0x213d92(0x1a1)]((_0x369c1e,_0x32f2e4)=>{var _0x58dd4d=_0x213d92;_0x30e8e9[_0x32f2e4][_0x58dd4d(0x212)]=_0x369c1e;}),_0x3cd3c6[_0x213d92(0x1a1)]((_0x4118ec,_0x370b1a)=>{_0x30e8e9[_0x370b1a]['unit']=_0x4118ec;}),_0x54cbfd[_0x213d92(0x1a1)]((_0x462a64,_0x3fbde9)=>{var _0x4aa082=_0x213d92;_0x30e8e9[_0x3fbde9][_0x4aa082(0x195)]=_0x462a64;}),_0x2e1343[_0x213d92(0x1a1)]((_0x366665,_0x9133d7)=>{_0x30e8e9[_0x9133d7]['batch_code']=_0x366665;}),_0x71c3db[_0x213d92(0x1a1)]((_0xc84c53,_0x2b30b6)=>{var _0x2607e0=_0x213d92;_0x30e8e9[_0x2b30b6][_0x2607e0(0x1d2)]=_0xc84c53;});const _0x3a2f20=_0x30e8e9[_0x213d92(0x244)](_0x24cf27=>_0x24cf27['to_quantity']!=='0'&&_0x24cf27[_0x213d92(0x20d)]!==''||_0x24cf27['to_floorlevel']!=='0'&&_0x24cf27['to_floorlevel']!=='');var _0x5df461=0x0;_0x3a2f20[_0x213d92(0x1a1)](_0x3b6117=>{var _0x3331ed=_0x213d92;parseInt(_0x3b6117[_0x3331ed(0x21b)])<parseInt(_0x3b6117[_0x3331ed(0x20d)])&&_0x5df461++;});if(_0x5df461!=0x0)return _0x3d9722[_0x213d92(0x23b)]('errors',_0x213d92(0x1ea)),_0x24cfbf[_0x213d92(0x24b)](_0x213d92(0x1d0));const _0x272d27=await warehouse[_0x213d92(0x1f1)]({'name':_0x182339[_0x213d92(0x1c0)],'room':_0x182339['from_room']});_0x182339[_0x213d92(0x217)][_0x213d92(0x1a1)](_0x1a1de4=>{var _0x22c6a0=_0x213d92;if(_0x1a1de4['to_quantity']>0x0){const _0x581d53=_0x272d27[_0x22c6a0(0x239)][_0x22c6a0(0x236)](_0x56a211=>{var _0x3c9e77=_0x22c6a0;_0x56a211[_0x3c9e77(0x17b)]==_0x1a1de4[_0x3c9e77(0x17b)]&&_0x56a211[_0x3c9e77(0x1c6)]==_0x1a1de4[_0x3c9e77(0x1b3)]&&(_0x56a211[_0x3c9e77(0x208)]=parseInt(_0x56a211[_0x3c9e77(0x208)])+parseInt(_0x1a1de4[_0x3c9e77(0x20d)]));});}}),await _0x272d27[_0x213d92(0x256)]();const _0x390f42=await warehouse[_0x213d92(0x1f1)]({'name':_0x182339[_0x213d92(0x1de)],'room':_0x182339[_0x213d92(0x206)]});_0x182339[_0x213d92(0x217)][_0x213d92(0x1a1)](_0x401d1e=>{var _0x2321d3=_0x213d92;if(_0x401d1e[_0x2321d3(0x20d)]>0x0){const _0x2770d3=_0x390f42['product_details'][_0x2321d3(0x236)](_0x44305c=>{var _0x1c293d=_0x2321d3;_0x44305c['product_name']==_0x401d1e[_0x1c293d(0x17b)]&&_0x44305c[_0x1c293d(0x1c6)]==_0x401d1e['to_bay']&&(_0x44305c[_0x1c293d(0x208)]=parseInt(_0x44305c['product_stock'])-parseInt(_0x401d1e[_0x1c293d(0x20d)]));});}}),await _0x390f42['save'](),_0x182339[_0x213d92(0x21a)]=_0x1906ce,_0x182339[_0x213d92(0x1c0)]=_0x2bb458,_0x182339[_0x213d92(0x1de)]=_0x3c1bd4,_0x182339[_0x213d92(0x217)]=_0x3a2f20,_0x182339['note']=_0x2ce747,_0x182339[_0x213d92(0x190)]=_0x203101;const _0x164a4f=await _0x182339[_0x213d92(0x256)](),_0x34bd71=await warehouse[_0x213d92(0x1f1)]({'name':_0x2bb458,'room':_0x4df086});_0x164a4f[_0x213d92(0x217)][_0x213d92(0x1a1)](_0x3db916=>{var _0xcbcd07=_0x213d92;if(_0x3db916[_0xcbcd07(0x20d)]>0x0){const _0x186fff=_0x34bd71[_0xcbcd07(0x239)][_0xcbcd07(0x236)](_0x148b21=>{var _0x2ce61e=_0xcbcd07;_0x148b21[_0x2ce61e(0x17b)]==_0x3db916['product_name']&&_0x148b21[_0x2ce61e(0x1c6)]==_0x3db916['from_bay']&&(_0x148b21[_0x2ce61e(0x208)]=parseInt(_0x148b21[_0x2ce61e(0x208)])-parseInt(_0x3db916[_0x2ce61e(0x20d)]));});}}),await _0x34bd71[_0x213d92(0x256)]();const _0x1a8203=await warehouse[_0x213d92(0x1f1)]({'name':_0x3c1bd4,'room':_0x4f4292});_0x164a4f[_0x213d92(0x217)]['forEach'](_0xb47db2=>{var _0x4298e2=_0x213d92;if(_0xb47db2[_0x4298e2(0x20d)]>0x0){var _0x1856e4=0x0;const _0x237049=_0x1a8203[_0x4298e2(0x239)][_0x4298e2(0x236)](_0x28651a=>{var _0x348a3b=_0x4298e2;_0x28651a[_0x348a3b(0x17b)]==_0xb47db2[_0x348a3b(0x17b)]&&_0x28651a['bay']==_0xb47db2[_0x348a3b(0x1db)]&&(_0x28651a[_0x348a3b(0x208)]=parseInt(_0x28651a[_0x348a3b(0x208)])+parseInt(_0xb47db2[_0x348a3b(0x20d)]),_0x1856e4++);});_0x1856e4=='0'&&(_0x1a8203[_0x4298e2(0x239)]=_0x1a8203[_0x4298e2(0x239)]['concat']({'product_name':_0xb47db2[_0x4298e2(0x17b)],'product_stock':_0xb47db2[_0x4298e2(0x20d)],'bay':_0xb47db2['to_bay'],'product_code':_0xb47db2[_0x4298e2(0x209)],'primary_code':_0xb47db2[_0x4298e2(0x1cf)],'secondary_code':_0xb47db2[_0x4298e2(0x22d)],'maxProducts':_0xb47db2[_0x4298e2(0x212)]}));}}),await _0x1a8203[_0x213d92(0x256)](),_0x3d9722[_0x213d92(0x23b)](_0x213d92(0x245),_0x213d92(0x1f8)),_0x24cfbf[_0x213d92(0x24b)](_0x213d92(0x188));}catch(_0x1cfcf3){console[_0x213d92(0x199)](_0x1cfcf3);}}),router[a0_0x468b86(0x20f)](a0_0x468b86(0x1d3),async(_0x518935,_0xce3bbc)=>{var _0x4b2bf5=a0_0x468b86;const {FromWareHouse:_0x31ab5e,FromRoom:_0x26d22e,ToWarehouse:_0x184bb9,ToRoom:_0x5d1a19,primary_code:_0x2ef433,Roomslist:_0x430b4f}=_0x518935[_0x4b2bf5(0x19f)],_0x21eaa8=_0x430b4f[_0x4b2bf5(0x21d)](','),_0xee86f6=[];async function _0x1357c5(_0x3b073f){var _0x599b93=_0x4b2bf5;const _0x5488b4=await warehouse[_0x599b93(0x259)]([{'$match':{'name':_0x31ab5e,'room':_0x3b073f}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x2ef433}},{'$group':{'_id':_0x599b93(0x207),'name':{'$first':_0x599b93(0x238)},'instock':{'$first':_0x599b93(0x19c)},'primary_code':{'$first':_0x599b93(0x1b6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x599b93(0x1e5)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x599b93(0x1f6)},'type':{'$first':_0x599b93(0x1d6)},'pallet':{'$first':_0x599b93(0x1a2)},'unit':{'$first':_0x599b93(0x1c7)},'secondary_unit':{'$first':_0x599b93(0x198)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x599b93(0x247)},'expiry_date':{'$first':_0x599b93(0x18c)},'production_date':{'$first':_0x599b93(0x193)},'batch_code':{'$first':_0x599b93(0x24d)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x599b93(0x216)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x599b93(0x185)}}}]),_0x31bde2=await warehouse[_0x599b93(0x259)]([{'$match':{'name':_0x31ab5e,'room':_0x3b073f}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2ef433}},{'$group':{'_id':_0x599b93(0x207),'name':{'$first':_0x599b93(0x238)},'instock':{'$first':_0x599b93(0x19c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x599b93(0x1aa)},'product_code':{'$first':_0x599b93(0x1e5)},'level':{'$first':_0x599b93(0x1d5)},'isle':{'$first':_0x599b93(0x1f6)},'type':{'$first':_0x599b93(0x1d6)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x599b93(0x1c7)},'secondary_unit':{'$first':_0x599b93(0x198)},'storage':{'$first':_0x599b93(0x1dd)},'rack':{'$first':_0x599b93(0x247)},'expiry_date':{'$first':_0x599b93(0x18c)},'production_date':{'$first':_0x599b93(0x193)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x599b93(0x185)}}}]);if(_0x5488b4[_0x599b93(0x18b)]>0x0)_0xee86f6[_0x599b93(0x1c4)](_0x5488b4);else _0x31bde2[_0x599b93(0x18b)]>0x0&&_0xee86f6['push'](_0x31bde2);}const _0x56caa1=_0x21eaa8[_0x4b2bf5(0x236)](_0x293122=>_0x1357c5(_0x293122));await Promise[_0x4b2bf5(0x1da)](_0x56caa1),_0xce3bbc['json'](_0xee86f6);}),router[a0_0x468b86(0x20f)](a0_0x468b86(0x222),async(_0x6cb690,_0x2ae19e)=>{var _0x24436c=a0_0x468b86;try{const {FromWareHouse:_0x161040,FromRoom:_0x168269,ToWarehouse:_0x41340f,ToRoom:_0x4768b3,secondary_code:_0x2f79d4}=_0x6cb690[_0x24436c(0x19f)],_0x3d5af7=await warehouse[_0x24436c(0x259)]([{'$match':{'name':_0x161040}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2f79d4}},{'$group':{'_id':_0x24436c(0x207),'name':{'$first':_0x24436c(0x238)},'primary_code':{'$first':_0x24436c(0x1b6)},'secondary_code':{'$first':_0x24436c(0x1aa)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x24436c(0x19c)},'warehouse':{'$first':_0x24436c(0x205)},'level':{'$first':_0x24436c(0x218)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x24436c(0x219)},'unit':{'$first':_0x24436c(0x1c7)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'}}}]);_0x2ae19e[_0x24436c(0x22b)](0xc8)[_0x24436c(0x257)](_0x3d5af7);}catch(_0x5cd6e1){_0x2ae19e['status'](0x194)[_0x24436c(0x257)]({'message':_0x5cd6e1[_0x24436c(0x223)]});}}),router[a0_0x468b86(0x20f)](a0_0x468b86(0x19d),async(_0x562438,_0x4ee65b)=>{var _0x3a09b9=a0_0x468b86;try{const {FromWareHouse:_0x37814e,FromRoom:_0x3ded23,ToWarehouse:_0x535504,ToRoom:_0x4f6605,product_code:_0x2fc5f7}=_0x562438[_0x3a09b9(0x19f)],_0x22ae40=await warehouse[_0x3a09b9(0x259)]([{'$match':{'name':_0x37814e}},{'$unwind':_0x3a09b9(0x1f5)},{'$match':{'product_details.product_code':_0x2fc5f7}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3a09b9(0x238)},'primary_code':{'$first':_0x3a09b9(0x1b6)},'secondary_code':{'$first':_0x3a09b9(0x1aa)},'product_code':{'$first':_0x3a09b9(0x1e5)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x3a09b9(0x205)},'level':{'$first':_0x3a09b9(0x218)},'isle':{'$first':_0x3a09b9(0x1d7)},'pallet':{'$first':_0x3a09b9(0x1fa)},'maxProducts':{'$first':_0x3a09b9(0x219)},'unit':{'$first':_0x3a09b9(0x1c7)}}}]);_0x4ee65b[_0x3a09b9(0x22b)](0xc8)[_0x3a09b9(0x257)](_0x22ae40);}catch(_0x3a4482){_0x4ee65b[_0x3a09b9(0x22b)](0x194)[_0x3a09b9(0x257)]({'message':_0x3a4482[_0x3a09b9(0x223)]});}}),router[a0_0x468b86(0x20f)](a0_0x468b86(0x241),async(_0x11f8d2,_0x27d778)=>{var _0x32c5b2=a0_0x468b86;const {productCode:_0x40708f,bay:_0x34431c,warehouses:_0x137f34,room:_0xc09534}=_0x11f8d2[_0x32c5b2(0x19f)];console[_0x32c5b2(0x199)](_0x11f8d2['body']);try{const _0x2ada14=await warehouse['aggregate']([{'$match':{'name':_0x137f34,'room':_0xc09534}},{'$unwind':_0x32c5b2(0x1f5)},{'$match':{'product_details.bay':parseInt(_0x34431c)}},{'$group':{'_id':_0x32c5b2(0x207),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x32c5b2(0x1d5)},'maxProducts':{'$first':_0x32c5b2(0x219)}}}]);_0x27d778[_0x32c5b2(0x22b)](0xc8)['json'](_0x2ada14);}catch(_0x39c8f5){_0x27d778['status'](0x194)[_0x32c5b2(0x257)]({'message':_0x39c8f5[_0x32c5b2(0x223)]});}}),module[a0_0x468b86(0x237)]=router;