var a0_0x444e6a=a0_0x5ae1;function a0_0x5ae1(_0x4e7aee,_0x23ef3e){var _0x531062=a0_0x5310();return a0_0x5ae1=function(_0x5ae199,_0x75e09e){_0x5ae199=_0x5ae199-0x186;var _0x15c568=_0x531062[_0x5ae199];return _0x15c568;},a0_0x5ae1(_0x4e7aee,_0x23ef3e);}(function(_0x3997e4,_0x4546ec){var _0x5c2b1d=a0_0x5ae1,_0x1b8800=_0x3997e4();while(!![]){try{var _0x33d516=parseInt(_0x5c2b1d(0x25a))/0x1*(-parseInt(_0x5c2b1d(0x1ac))/0x2)+-parseInt(_0x5c2b1d(0x1a1))/0x3*(parseInt(_0x5c2b1d(0x1e9))/0x4)+-parseInt(_0x5c2b1d(0x23c))/0x5+parseInt(_0x5c2b1d(0x19a))/0x6*(-parseInt(_0x5c2b1d(0x1c4))/0x7)+parseInt(_0x5c2b1d(0x1ce))/0x8+parseInt(_0x5c2b1d(0x1ca))/0x9+parseInt(_0x5c2b1d(0x235))/0xa*(parseInt(_0x5c2b1d(0x258))/0xb);if(_0x33d516===_0x4546ec)break;else _0x1b8800['push'](_0x1b8800['shift']());}catch(_0x23474a){_0x1b8800['push'](_0x1b8800['shift']());}}}(a0_0x5310,0x59af6));const express=require('express'),app=express(),router=express[a0_0x444e6a(0x223)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x444e6a(0x1e2)),auth=require(a0_0x444e6a(0x214)),users=require(a0_0x444e6a(0x1fc)),nodemailer=require(a0_0x444e6a(0x1b9));router[a0_0x444e6a(0x1db)](a0_0x444e6a(0x236),auth,async(_0x414a8b,_0xf5bbc)=>{var _0x12838a=a0_0x444e6a;try{const {username:_0x5d242c,email:_0x41c292,role:_0x14072a}=_0x414a8b[_0x12838a(0x21c)],_0x3dc86e=_0x414a8b[_0x12838a(0x21c)],_0x493064=await profile['findOne']({'email':_0x3dc86e[_0x12838a(0x1c1)]}),_0x35c25b=await master_shop[_0x12838a(0x21a)]();let _0x4ae867;if(_0x3dc86e[_0x12838a(0x1b1)]==_0x12838a(0x1b3)){const _0x4c5aed=await staff[_0x12838a(0x1c9)]({'email':_0x3dc86e[_0x12838a(0x1c1)]});_0x4ae867=await transfers_finished['find']({'from_warehouse':_0x4c5aed['warehouse']});}else _0x4ae867=await transfers_finished[_0x12838a(0x251)]([{'$unwind':'$product'},{'$group':{'_id':_0x12838a(0x206),'invoice':{'$first':_0x12838a(0x24e)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x12838a(0x25b)},'to_warehouse':{'$first':_0x12838a(0x23b)},'from_room_name':{'$addToSet':_0x12838a(0x191)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x12838a(0x1d7)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x35c25b[0x0][_0x12838a(0x237)]==_0x12838a(0x1b0))var _0x3cb766=users[_0x12838a(0x209)];else{if(_0x35c25b[0x0]['language']==_0x12838a(0x20e))var _0x3cb766=users[_0x12838a(0x20e)];else{if(_0x35c25b[0x0][_0x12838a(0x237)]=='German')var _0x3cb766=users[_0x12838a(0x259)];else{if(_0x35c25b[0x0]['language']=='Spanish')var _0x3cb766=users[_0x12838a(0x225)];else{if(_0x35c25b[0x0][_0x12838a(0x237)]=='French')var _0x3cb766=users['French'];else{if(_0x35c25b[0x0]['language']==_0x12838a(0x1d4))var _0x3cb766=users[_0x12838a(0x21d)];else{if(_0x35c25b[0x0][_0x12838a(0x237)]==_0x12838a(0x1d2))var _0x3cb766=users['Chinese'];else{if(_0x35c25b[0x0][_0x12838a(0x237)]==_0x12838a(0x200))var _0x3cb766=users[_0x12838a(0x1be)];}}}}}}}_0xf5bbc[_0x12838a(0x24d)](_0x12838a(0x1e6),{'success':_0x414a8b[_0x12838a(0x23e)](_0x12838a(0x240)),'errors':_0x414a8b['flash'](_0x12838a(0x1ff)),'role':_0x3dc86e,'profile':_0x493064,'master_shop':_0x35c25b,'transfer':_0x4ae867,'language':_0x3cb766});}catch(_0x17ff01){console[_0x12838a(0x20c)](_0x17ff01);}});async function getRandom8DigitNumber(){var _0x3e5afe=a0_0x444e6a;const _0x5940b1=0x989680,_0x2e8d66=0x5f5e0ff,_0x692151=Math['floor'](Math['random']()*(_0x2e8d66-_0x5940b1+0x1))+_0x5940b1;var _0x6beacc;const _0x3a6758=await transfers_finished[_0x3e5afe(0x1c9)]({'invoice':'TRFF-'+_0x692151});return _0x3a6758&&_0x3a6758[_0x3e5afe(0x216)]>0x0?_0x6beacc=_0x3e5afe(0x24c)+_0x692151:_0x6beacc=_0x3e5afe(0x24c)+_0x692151,_0x6beacc;}router[a0_0x444e6a(0x1db)](a0_0x444e6a(0x226),auth,async(_0x14123f,_0x1be4cc)=>{var _0x69d7f0=a0_0x444e6a;try{const {username:_0x222062,email:_0x584803,role:_0x55d1e4}=_0x14123f[_0x69d7f0(0x21c)],_0x3bf288=_0x14123f[_0x69d7f0(0x21c)],_0xff3f61=await profile['findOne']({'email':_0x3bf288[_0x69d7f0(0x1c1)]}),_0x3ace16=await master_shop[_0x69d7f0(0x21a)]();let _0x8f1213;if(_0x3bf288['role']==_0x69d7f0(0x1b3)){const _0x419c88=await staff['findOne']({'email':_0x3bf288[_0x69d7f0(0x1c1)]});_0x8f1213=await warehouse[_0x69d7f0(0x251)]([{'$match':{'status':_0x69d7f0(0x24b),'name':_0x419c88[_0x69d7f0(0x1c7)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x69d7f0(0x227)}}},{'$group':{'_id':_0x69d7f0(0x1c0),'name':{'$first':_0x69d7f0(0x1c0)}}}]);}else _0x8f1213=await warehouse[_0x69d7f0(0x251)]([{'$match':{'status':_0x69d7f0(0x24b),'warehouse_category':_0x69d7f0(0x242),'name':{'$ne':_0x69d7f0(0x227)}}},{'$group':{'_id':_0x69d7f0(0x1c0),'name':{'$first':'$name'}}}]);const _0x11b2b9=await transfers_finished[_0x69d7f0(0x21a)]({}),_0x394b42=_0x11b2b9[_0x69d7f0(0x216)]+0x1,_0x1fc262=_0x69d7f0(0x24c)+_0x394b42[_0x69d7f0(0x211)]()[_0x69d7f0(0x1c5)](0x5,'0');if(_0x3ace16[0x0][_0x69d7f0(0x237)]=='English\x20(US)')var _0x51eb35=users['English'];else{if(_0x3ace16[0x0][_0x69d7f0(0x237)]=='Hindi')var _0x51eb35=users[_0x69d7f0(0x20e)];else{if(_0x3ace16[0x0][_0x69d7f0(0x237)]=='German')var _0x51eb35=users['German'];else{if(_0x3ace16[0x0]['language']=='Spanish')var _0x51eb35=users[_0x69d7f0(0x225)];else{if(_0x3ace16[0x0][_0x69d7f0(0x237)]=='French')var _0x51eb35=users['French'];else{if(_0x3ace16[0x0][_0x69d7f0(0x237)]==_0x69d7f0(0x1d4))var _0x51eb35=users['Portuguese'];else{if(_0x3ace16[0x0][_0x69d7f0(0x237)]=='Chinese')var _0x51eb35=users[_0x69d7f0(0x1d2)];else{if(_0x3ace16[0x0][_0x69d7f0(0x237)]==_0x69d7f0(0x200))var _0x51eb35=users[_0x69d7f0(0x1be)];}}}}}}}const _0x13776b=getRandom8DigitNumber();_0x13776b[_0x69d7f0(0x19f)](_0x229b32=>{var _0x2ec550=_0x69d7f0;_0x1be4cc[_0x2ec550(0x24d)]('add_transfer_finished',{'success':_0x14123f[_0x2ec550(0x23e)](_0x2ec550(0x240)),'errors':_0x14123f[_0x2ec550(0x23e)](_0x2ec550(0x1ff)),'role':_0x3bf288,'profile':_0xff3f61,'master_shop':_0x3ace16,'warehouse':_0x8f1213,'language':_0x51eb35,'invoice':_0x229b32});})['catch'](_0x5494d7=>{var _0xc71d37=_0x69d7f0;_0x14123f[_0xc71d37(0x23e)](_0xc71d37(0x1ff),_0xc71d37(0x257)),_0x1be4cc[_0xc71d37(0x1e5)]('/transfer/view');});}catch(_0x3ff689){console[_0x69d7f0(0x20c)](_0x3ff689);}}),router['post'](a0_0x444e6a(0x226),auth,async(_0x251f99,_0x104425)=>{var _0x4221e3=a0_0x444e6a;try{const {date:_0x31b866,from_warehouse:_0x31653a,FromRoom_name:_0xeb7363,to_warehouse:_0x49b74f,ToRoom_name:_0xd474be,prod_name:_0x2e4193,from_prod_qty:_0x2a96ce,from_prod_level:_0x174954,from_prod_isle:_0x578b8e,from_prod_pallet:_0x253ce1,to_prod_qty:_0x3c6406,to_prod_level:_0x535c48,to_prod_isle:_0x18b96c,to_prod_pallet:_0x3338e4,primary_code:_0x4f893b,secondary_code:_0xef5cab,product_code3:_0x3cb799,note:_0x5e890d,MaxStocks_data2:_0xa7ebf8,invoice:_0x45aa9b,expiry_date:_0x45095b}=_0x251f99[_0x4221e3(0x189)];if(typeof _0x2e4193==_0x4221e3(0x1fd))var _0x74c9e5=[_0x251f99['body'][_0x4221e3(0x1d5)]],_0x2760e0=[_0x251f99[_0x4221e3(0x189)]['from_prod_qty']],_0xe34a79=[_0x251f99['body'][_0x4221e3(0x18b)]],_0x508b36=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x1fe)]],_0x1ee8f5=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x1d1)]],_0x2b776c=[_0x251f99[_0x4221e3(0x189)]['primary_code']],_0xeeab97=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x1d8)]],_0x2e4dbb=[_0x251f99['body'][_0x4221e3(0x219)]],_0x1dfc6a=[_0x251f99['body']['MaxStocks_data2']],_0x28ee20=[_0x251f99[_0x4221e3(0x189)]['primary_unit']],_0x164adb=[_0x251f99[_0x4221e3(0x189)]['secondary_unit']],_0x961af7=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x1a9)]],_0x1c12e0=[_0x251f99['body']['expiry_date']],_0x11c799=[_0x251f99['body']['product_date']],_0x4ad325=[_0x251f99['body'][_0x4221e3(0x222)]],_0x6b7456=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x230)]],_0xfed304=[_0x251f99['body'][_0x4221e3(0x201)]],_0x39d61f=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x22a)]],_0x182540=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x192)]],_0x36e941=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x215)]],_0x49a659=[_0x251f99['body'][_0x4221e3(0x193)]],_0x4176aa=[_0x251f99[_0x4221e3(0x189)][_0x4221e3(0x249)]];else var _0x74c9e5=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x1d5)]],_0x2760e0=[..._0x251f99[_0x4221e3(0x189)]['from_prod_qty']],_0xe34a79=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x18b)]],_0x508b36=[..._0x251f99[_0x4221e3(0x189)]['New_Qty_Converted']],_0x1ee8f5=[..._0x251f99[_0x4221e3(0x189)]['to_prod_level']],_0x2b776c=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x246)]],_0xeeab97=[..._0x251f99[_0x4221e3(0x189)]['secondary_code']],_0x2e4dbb=[..._0x251f99[_0x4221e3(0x189)]['product_code3']],_0x1dfc6a=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x243)]],_0x28ee20=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x1b2)]],_0x164adb=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x233)]],_0x961af7=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x1a9)]],_0x1c12e0=[..._0x251f99['body'][_0x4221e3(0x19b)]],_0x11c799=[..._0x251f99['body'][_0x4221e3(0x1df)]],_0x4ad325=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x222)]],_0x6b7456=[..._0x251f99['body'][_0x4221e3(0x230)]],_0xfed304=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x201)]],_0x39d61f=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x22a)]],_0x182540=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x192)]],_0x36e941=[..._0x251f99[_0x4221e3(0x189)]['from_invoice']],_0x49a659=[..._0x251f99[_0x4221e3(0x189)][_0x4221e3(0x193)]],_0x4176aa=[..._0x251f99['body'][_0x4221e3(0x249)]];const _0x37110c=_0x74c9e5[_0x4221e3(0x207)](_0x7c49c9=>{return _0x7c49c9={'product_name':_0x7c49c9};});_0x2760e0[_0x4221e3(0x23d)]((_0x1c8e1c,_0x5aa95a)=>{_0x37110c[_0x5aa95a]['from_quantity']=_0x1c8e1c;}),_0xe34a79[_0x4221e3(0x23d)]((_0x55863e,_0xc0f51a)=>{var _0x32110c=_0x4221e3;_0x37110c[_0xc0f51a][_0x32110c(0x1a3)]=_0x55863e;}),_0x4176aa[_0x4221e3(0x23d)]((_0x445dbf,_0x4b7be3)=>{var _0x1389b7=_0x4221e3;_0x37110c[_0x4b7be3][_0x1389b7(0x249)]=_0x445dbf;}),_0x36e941[_0x4221e3(0x23d)]((_0x56c428,_0x184d7c)=>{var _0x5528b5=_0x4221e3;_0x37110c[_0x184d7c][_0x5528b5(0x215)]=_0x56c428;}),_0x49a659[_0x4221e3(0x23d)]((_0x52c4d7,_0x3d398c)=>{var _0x2b24d4=_0x4221e3;_0x37110c[_0x3d398c][_0x2b24d4(0x1e1)]=_0x52c4d7;}),_0x508b36[_0x4221e3(0x23d)]((_0x32c7a4,_0x2032c5)=>{var _0x3d1a40=_0x4221e3;_0x37110c[_0x2032c5][_0x3d1a40(0x1f8)]=_0x32c7a4;}),_0x1ee8f5['forEach']((_0x50bb47,_0x4cc9b9)=>{var _0x55f6e9=_0x4221e3;_0x37110c[_0x4cc9b9][_0x55f6e9(0x19c)]=_0x50bb47;}),_0x2b776c[_0x4221e3(0x23d)]((_0x439124,_0x40b35b)=>{_0x37110c[_0x40b35b]['primary_code']=_0x439124;}),_0xeeab97[_0x4221e3(0x23d)]((_0x16e798,_0x5d9052)=>{var _0x9a125e=_0x4221e3;_0x37110c[_0x5d9052][_0x9a125e(0x1d8)]=_0x16e798;}),_0x2e4dbb[_0x4221e3(0x23d)]((_0x287ee4,_0x25fde5)=>{_0x37110c[_0x25fde5]['product_code']=_0x287ee4;}),_0x1dfc6a[_0x4221e3(0x23d)]((_0x36b0fe,_0x11f8b0)=>{var _0x49b7fe=_0x4221e3;_0x37110c[_0x11f8b0][_0x49b7fe(0x22d)]=_0x36b0fe;}),_0x28ee20[_0x4221e3(0x23d)]((_0x3bf76c,_0xd60b9a)=>{var _0x319980=_0x4221e3;_0x37110c[_0xd60b9a][_0x319980(0x217)]=_0x3bf76c;}),_0x164adb['forEach']((_0x10a165,_0x2c8daf)=>{var _0x51860f=_0x4221e3;_0x37110c[_0x2c8daf][_0x51860f(0x233)]=_0x10a165;}),_0x961af7['forEach']((_0x559247,_0x562afa)=>{var _0x43adc6=_0x4221e3;_0x37110c[_0x562afa][_0x43adc6(0x1a9)]=_0x559247;}),_0x1c12e0['forEach']((_0x246d37,_0x2abdaa)=>{var _0x465b75=_0x4221e3;_0x37110c[_0x2abdaa][_0x465b75(0x19b)]=_0x246d37;}),_0x11c799[_0x4221e3(0x23d)]((_0x2b4c61,_0x137c82)=>{var _0x1f5ad8=_0x4221e3;_0x37110c[_0x137c82][_0x1f5ad8(0x194)]=_0x2b4c61;}),_0x4ad325[_0x4221e3(0x23d)]((_0x42d2af,_0x2c2c94)=>{var _0x41859f=_0x4221e3;_0x37110c[_0x2c2c94][_0x41859f(0x22d)]=_0x42d2af;}),_0x6b7456[_0x4221e3(0x23d)]((_0x5da4f4,_0x71e5f5)=>{var _0xdde8dd=_0x4221e3;_0x37110c[_0x71e5f5][_0xdde8dd(0x230)]=_0x5da4f4;}),_0xfed304[_0x4221e3(0x23d)]((_0x40b11f,_0x2685e9)=>{var _0x134ad5=_0x4221e3;_0x37110c[_0x2685e9][_0x134ad5(0x201)]=_0x40b11f;}),_0x39d61f[_0x4221e3(0x23d)]((_0x376908,_0x16edc2)=>{var _0xcdda0f=_0x4221e3;_0x37110c[_0x16edc2][_0xcdda0f(0x24f)]=_0x376908;}),_0x182540['forEach']((_0x1f2f82,_0x49569f)=>{var _0x415857=_0x4221e3;_0x37110c[_0x49569f][_0x415857(0x239)]=_0x1f2f82;});const _0x2eb292=_0x37110c[_0x4221e3(0x1cf)](_0x1d3865=>_0x1d3865['to_quantity']!=='0'&&_0x1d3865[_0x4221e3(0x1f8)]!==''||_0x1d3865[_0x4221e3(0x1e4)]!=='0'&&_0x1d3865[_0x4221e3(0x1e4)]!=='');var _0x79cded=0x0;_0x2eb292[_0x4221e3(0x23d)](_0x1d709a=>{var _0x326e99=_0x4221e3;parseInt(_0x1d709a[_0x326e99(0x1ae)])<parseInt(_0x1d709a['to_quantity'])&&_0x79cded++;});if(_0x79cded!=0x0)return _0x251f99['flash'](_0x4221e3(0x1ff),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x104425['redirect'](_0x4221e3(0x1ed));const _0x10d47d=new transfers_finished({'date':_0x31b866,'from_warehouse':_0x31653a,'to_warehouse':_0x49b74f,'product':_0x2eb292,'note':_0x5e890d,'invoice':_0x45aa9b}),_0x11a9c3=await _0x10d47d[_0x4221e3(0x1a7)]();_0x251f99['flash']('success',_0x4221e3(0x188)),_0x104425[_0x4221e3(0x1e5)](_0x4221e3(0x1bc)+_0x11a9c3['_id']);}catch(_0x4808bf){console[_0x4221e3(0x20c)](_0x4808bf),_0x104425['status'](0xc8)[_0x4221e3(0x221)]({'errorMessage':_0x4808bf[_0x4221e3(0x22e)]});}}),router[a0_0x444e6a(0x1db)]('/preview/:id',auth,async(_0x479858,_0x448d38)=>{var _0xf3eae=a0_0x444e6a;try{const {username:_0x5de906,email:_0xc0ebb3,role:_0x506c4b}=_0x479858[_0xf3eae(0x21c)],_0x9b11d=_0x479858[_0xf3eae(0x21c)],_0x1a8f6c=await profile[_0xf3eae(0x1c9)]({'email':_0x9b11d[_0xf3eae(0x1c1)]}),_0x1c4a13=await master_shop[_0xf3eae(0x21a)](),_0x52ee72=await transfers_finished[_0xf3eae(0x231)](_0x479858['params']['id']);let _0xdd4908;if(_0x9b11d[_0xf3eae(0x1b1)]==_0xf3eae(0x1b3)){const _0x2a70d8=await staff[_0xf3eae(0x1c9)]({'email':_0x9b11d[_0xf3eae(0x1c1)]});_0xdd4908=await warehouse[_0xf3eae(0x21a)]({'status':_0xf3eae(0x24b),'name':_0x2a70d8[_0xf3eae(0x1c7)],'warehouse_category':_0xf3eae(0x242)});}else _0xdd4908=await warehouse['find']({'status':_0xf3eae(0x24b),'warehouse_category':_0xf3eae(0x242)});const _0x4afe5c=await warehouse[_0xf3eae(0x251)]([{'$match':{'name':_0x52ee72[_0xf3eae(0x19e)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0xf3eae(0x1cc)},{'$group':{'_id':_0xf3eae(0x198),'name':{'$first':_0xf3eae(0x210)},'product_stock':{'$first':_0xf3eae(0x1c6)},'bay':{'$first':_0xf3eae(0x254)},'bin':{'$first':_0xf3eae(0x18d)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0xf3eae(0x203)},'primary_code':{'$first':_0xf3eae(0x1dd)},'secondary_code':{'$first':_0xf3eae(0x190)},'product_code':{'$first':_0xf3eae(0x196)},'storage':{'$first':_0xf3eae(0x23a)},'rack':{'$first':_0xf3eae(0x25e)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xf3eae(0x241)},'room':{'$first':_0xf3eae(0x1e8)},'warehoue_name':{'$first':_0xf3eae(0x1c0)}}}]),_0x3fd027=await product[_0xf3eae(0x21a)]({});if(_0x1c4a13[0x0][_0xf3eae(0x237)]=='English\x20(US)'){var _0xf06d13=users[_0xf3eae(0x209)];console[_0xf3eae(0x20c)](_0xf06d13);}else{if(_0x1c4a13[0x0][_0xf3eae(0x237)]==_0xf3eae(0x20e))var _0xf06d13=users[_0xf3eae(0x20e)];else{if(_0x1c4a13[0x0]['language']==_0xf3eae(0x259))var _0xf06d13=users[_0xf3eae(0x259)];else{if(_0x1c4a13[0x0][_0xf3eae(0x237)]==_0xf3eae(0x225))var _0xf06d13=users[_0xf3eae(0x225)];else{if(_0x1c4a13[0x0]['language']==_0xf3eae(0x20f))var _0xf06d13=users[_0xf3eae(0x20f)];else{if(_0x1c4a13[0x0][_0xf3eae(0x237)]==_0xf3eae(0x1d4))var _0xf06d13=users[_0xf3eae(0x21d)];else{if(_0x1c4a13[0x0]['language']=='Chinese')var _0xf06d13=users[_0xf3eae(0x1d2)];else{if(_0x1c4a13[0x0][_0xf3eae(0x237)]==_0xf3eae(0x200))var _0xf06d13=users[_0xf3eae(0x1be)];}}}}}}}_0x448d38[_0xf3eae(0x24d)](_0xf3eae(0x1b6),{'success':_0x479858['flash'](_0xf3eae(0x240)),'errors':_0x479858[_0xf3eae(0x23e)]('errors'),'role':_0x9b11d,'profile':_0x1a8f6c,'master_shop':_0x1c4a13,'warehouse':_0xdd4908,'transfer':_0x52ee72,'stock':_0x4afe5c,'unit':_0x3fd027,'language':_0xf06d13});}catch(_0x2dac49){console['log'](_0x2dac49);}}),router[a0_0x444e6a(0x1aa)]('/preview/:id',auth,async(_0x24f998,_0x534bcc)=>{var _0x1b0823=a0_0x444e6a;try{const {invoice:_0x269c47,from_warehouse:_0x549362,FromRoom_name:_0x18f5c6,to_warehouse:_0x48d7bd,ToRoom_name:_0x1e416d}=_0x24f998[_0x1b0823(0x189)],_0x26edc3=await transfers_finished[_0x1b0823(0x231)](_0x24f998['params']['id']),_0x4c0740=_0x26edc3['product'][_0x1b0823(0x207)](async _0x362270=>{var _0x2d9fb3=_0x1b0823;if(_0x362270[_0x2d9fb3(0x1f8)]>0x0){var _0x367165=await warehouse['findOne']({'name':_0x549362,'room':_0x362270[_0x2d9fb3(0x24f)],'warehouse_category':_0x2d9fb3(0x242)});const _0x2ce64e=_0x367165[_0x2d9fb3(0x1fb)][_0x2d9fb3(0x207)](_0x53f17f=>{var _0x94e77a=_0x2d9fb3;console['log'](_0x53f17f[_0x94e77a(0x1c2)]+_0x94e77a(0x18a)+_0x362270[_0x94e77a(0x249)]),_0x53f17f[_0x94e77a(0x1f0)]==_0x362270[_0x94e77a(0x1f0)]&&_0x53f17f[_0x94e77a(0x205)]==_0x362270[_0x94e77a(0x1a3)]&&_0x53f17f[_0x94e77a(0x19b)]==_0x362270[_0x94e77a(0x19b)]&&_0x53f17f[_0x94e77a(0x194)]==_0x362270[_0x94e77a(0x194)]&&_0x53f17f[_0x94e77a(0x1a9)]==_0x362270[_0x94e77a(0x1a9)]&&_0x53f17f['invoice']==_0x362270[_0x94e77a(0x215)]&&_0x53f17f[_0x94e77a(0x1c2)]==_0x362270[_0x94e77a(0x249)]&&(_0x53f17f['product_stock']=_0x53f17f['product_stock']-_0x362270[_0x94e77a(0x1f8)]);});}return _0x367165;});Promise[_0x1b0823(0x21e)](_0x4c0740)['then'](async _0x5d658d=>{var _0x15dd35=_0x1b0823;try{for(const _0x2c3e6a of _0x5d658d){await _0x2c3e6a[_0x15dd35(0x1a7)]();}const _0x9de701=_0x26edc3[_0x15dd35(0x20d)][_0x15dd35(0x207)](async _0x589b58=>{var _0x4b991f=_0x15dd35,_0x50abff=await warehouse['findOne']({'name':_0x48d7bd,'room':_0x589b58[_0x4b991f(0x239)]});if(_0x589b58[_0x4b991f(0x1f8)]>0x0){var _0x3dcbf7=0x0;const _0x48c1a4=_0x50abff[_0x4b991f(0x1fb)]['map'](_0x289571=>{var _0x421ca0=_0x4b991f;_0x289571[_0x421ca0(0x1f0)]==_0x589b58[_0x421ca0(0x1f0)]&&_0x289571[_0x421ca0(0x205)]==_0x589b58[_0x421ca0(0x19c)]&&_0x289571[_0x421ca0(0x19b)]==_0x589b58[_0x421ca0(0x19b)]&&_0x289571[_0x421ca0(0x194)]==_0x589b58['production_date']&&_0x289571[_0x421ca0(0x1a9)]==_0x589b58['batch_code']&&_0x289571[_0x421ca0(0x208)]==_0x589b58[_0x421ca0(0x1e1)]&&_0x289571[_0x421ca0(0x1c2)]==_0x589b58[_0x421ca0(0x249)]&&(_0x289571['product_stock']=_0x289571[_0x421ca0(0x1f6)]+_0x589b58[_0x421ca0(0x1f8)],_0x3dcbf7++);});_0x3dcbf7=='0'&&(_0x50abff[_0x4b991f(0x1fb)]=_0x50abff[_0x4b991f(0x1fb)][_0x4b991f(0x1eb)]({'product_name':_0x589b58[_0x4b991f(0x1f0)],'product_stock':_0x589b58[_0x4b991f(0x1f8)],'bay':_0x589b58[_0x4b991f(0x19c)],'product_code':_0x589b58[_0x4b991f(0x1cb)],'primary_code':_0x589b58['primary_code'],'secondary_code':_0x589b58[_0x4b991f(0x1d8)],'expiry_date':_0x589b58['expiry_date'],'production_date':_0x589b58[_0x4b991f(0x194)],'maxProducts':_0x589b58['maxProducts'],'batch_code':_0x589b58[_0x4b991f(0x1a9)],'secondary_unit':_0x589b58['secondary_unit'],'unit':_0x589b58['unit'],'maxProducts':_0x589b58['maxProducts'],'maxPerUnit':_0x589b58[_0x4b991f(0x230)],'invoice':_0x589b58[_0x4b991f(0x1e1)]}));}return _0x50abff;});Promise[_0x15dd35(0x21e)](_0x9de701)[_0x15dd35(0x19f)](async _0x38ec67=>{var _0x1b87da=_0x15dd35;try{for(const _0x4fa24e of _0x38ec67){await warehouse[_0x1b87da(0x21f)]({'_id':_0x4fa24e[_0x1b87da(0x1c2)]},{'$addToSet':{'product_details':{'$each':_0x4fa24e[_0x1b87da(0x1fb)]}}});}_0x26edc3[_0x1b87da(0x1c8)]=_0x1b87da(0x1e7);const _0x279662=await _0x26edc3[_0x1b87da(0x1a7)](),_0xe63123=await master_shop[_0x1b87da(0x21a)](),_0x267a9f=await email_settings[_0x1b87da(0x1c9)](),_0x536daf=await supervisor_settings['find']();var _0x540765=_0x26edc3[_0x1b87da(0x20d)],_0x471f4b='',_0x45ed7a;for(_0x45ed7a in _0x540765){var _0x2da9ea='FG';_0x26edc3['to_warehouse']=='DRY\x20GOODS'&&(_0x2da9ea='DG'),_0x471f4b+=_0x1b87da(0x244)+_0x1b87da(0x1ee)+_0x540765[_0x45ed7a]['product_name']+_0x1b87da(0x1f3)+_0x1b87da(0x1ee)+_0x540765[_0x45ed7a][_0x1b87da(0x1cb)]+_0x1b87da(0x1f3)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x540765[_0x45ed7a][_0x1b87da(0x1f8)]+_0x1b87da(0x1f3)+_0x1b87da(0x1ee)+_0x540765[_0x45ed7a]['unit']+_0x1b87da(0x1f3)+_0x1b87da(0x1ee)+_0x540765[_0x45ed7a]['secondary_unit']+_0x1b87da(0x1f3)+_0x1b87da(0x1ee)+_0x26edc3[_0x1b87da(0x1d6)]+_0x1b87da(0x1f3)+_0x1b87da(0x1ee)+_0x540765[_0x45ed7a][_0x1b87da(0x239)]+_0x1b87da(0x1f3)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x2da9ea+_0x540765[_0x45ed7a][_0x1b87da(0x19c)]+_0x1b87da(0x1f3)+_0x1b87da(0x1d3);}let _0x24cce6=nodemailer['createTransport']({'host':_0x267a9f['host'],'port':Number(_0x267a9f[_0x1b87da(0x252)]),'secure':![],'auth':{'user':_0x267a9f[_0x1b87da(0x1c1)],'pass':_0x267a9f['password']}}),_0x1ea9dc={'from':_0x267a9f[_0x1b87da(0x1c1)],'to':_0x536daf[0x0][_0x1b87da(0x248)],'subject':_0x1b87da(0x212),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+'/upload/'+_0xe63123[0x0][_0x1b87da(0x1f1)],'cid':_0x1b87da(0x1f2)}],'html':_0x1b87da(0x1d0)+_0x1b87da(0x1ea)+_0x1b87da(0x1f7)+_0x1b87da(0x22f)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x1b87da(0x1cd)+'<div>'+_0x1b87da(0x232)+_0xe63123[0x0][_0x1b87da(0x1a2)]+'\x20</h2>'+_0x1b87da(0x1cd)+_0x1b87da(0x1cd)+_0x1b87da(0x1ad)+_0x1b87da(0x22f)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x1b87da(0x1ba)+_0x26edc3[_0x1b87da(0x208)]+'\x20'+_0x1b87da(0x1d9)+_0x1b87da(0x18f)+_0x26edc3[_0x1b87da(0x253)]+'\x20'+'</span>'+_0x1b87da(0x25f)+_0x1b87da(0x1cd)+_0x1b87da(0x1bd)+_0x1b87da(0x1b7)+'<tr>'+_0x1b87da(0x260)+_0x1b87da(0x202)+_0x1b87da(0x256)+_0x1b87da(0x1bf)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x1b87da(0x234)+_0x1b87da(0x238)+_0x1b87da(0x186)+_0x1b87da(0x1d3)+_0x1b87da(0x1a0)+_0x1b87da(0x1e0)+'\x20'+_0x471f4b+'\x20'+_0x1b87da(0x25c)+_0x1b87da(0x23f)+_0x1b87da(0x22f)+_0x1b87da(0x218)+_0x1b87da(0x224)+_0xe63123[0x0][_0x1b87da(0x1a2)]+_0x1b87da(0x25f)+_0x1b87da(0x1cd)+_0x1b87da(0x1cd)+_0x1b87da(0x1ab)};_0x24cce6[_0x1b87da(0x1e3)](_0x1ea9dc,function(_0x542263,_0xc1c104){var _0x2bc2a2=_0x1b87da;_0x542263?(console[_0x2bc2a2(0x20c)](_0x542263),console[_0x2bc2a2(0x20c)]('Error\x20Occurs')):console[_0x2bc2a2(0x20c)](_0x2bc2a2(0x250));}),_0x24f998[_0x1b87da(0x23e)](_0x1b87da(0x240),_0x1b87da(0x199)),_0x534bcc[_0x1b87da(0x1e5)](_0x1b87da(0x1bb)+_0x279662['_id']);}catch(_0x4dad97){console[_0x1b87da(0x18e)](_0x4dad97),_0x534bcc[_0x1b87da(0x213)](0x1f4)[_0x1b87da(0x221)]({'error':_0x1b87da(0x1f5)});}})[_0x15dd35(0x1b5)](_0x94f131=>{var _0x4971a9=_0x15dd35;console['error'](_0x94f131),_0x534bcc[_0x4971a9(0x213)](0x1f4)[_0x4971a9(0x221)]({'error':_0x4971a9(0x245)});});}catch(_0x1317be){console['error'](_0x1317be),_0x534bcc[_0x15dd35(0x213)](0x1f4)[_0x15dd35(0x221)]({'error':_0x15dd35(0x195)});}})[_0x1b0823(0x1b5)](_0x116623=>{var _0x21fc4a=_0x1b0823;console[_0x21fc4a(0x18e)](_0x116623),_0x534bcc[_0x21fc4a(0x213)](0x1f4)[_0x21fc4a(0x221)]({'error':_0x21fc4a(0x245)});});}catch(_0x5e03fd){_0x534bcc[_0x1b0823(0x221)]({'message':_0x5e03fd[_0x1b0823(0x22e)]});}});function a0_0x5310(){var _0x280f57=['<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/transfer_finished/view','product_name','image','logo','</td>','$product_details.type','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','product_stock','</head><body>','to_quantity','to_room','$product_details.maxProducts','product_details','../public/language/languages.json','string','New_Qty_Converted','errors','Arabic\x20(ae)','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.floorlevel','edit_transfer_finished','bay','$_id','map','invoice','English','$product_details.level','Rack\x202','log','product','Hindi','French','$product_details.product_name','toString','Transfer\x20Mail','status','../middleware/auth','from_invoice','length','unit','<strong>\x20Regards\x20</strong>','product_code3','find','getFullYear','user','Portuguese','all','updateOne','$product_details.secondary_unit','json','MaxStocks_data','Router','<h5>','Spanish','/view/add_transfer','QA\x20Warehouse','$product_details.unit','DRY\x20GOODS','RoomAssigned','$product_details.invoice','Rack\x201','maxProducts','message','<div>','maxPerUnit','findById','<h2>\x20','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','40zlKDpd','/view','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','to_room_name','$product_details.storage','$to_warehouse','492275jmtjFe','forEach','flash','</table>','success','$product_details.production_date','Finished\x20Goods','MaxStocks_data2','<tr>','An\x20error\x20occurred.','primary_code','params','FGSEmail','id_transaction','getDate','Enabled','TRFF-','render','$invoice','from_room_name','Email\x20sent\x20successfully','aggregate','port','date','$product_details.bay','transfer_data','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','2240051gPpKfR','German','47QzsozC','$from_warehouse','</tbody>','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.rack','</h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','FROZEN\x20GOODS','Product\x20Transfer\x20successfully','body','\x20<>\x20','from_prod_level','Transfer\x20Edit\x20Successfully','$product_details.bin','error','\x20Order\x20Date\x20:\x20','$product_details.secondary_code','$product.from_room_name','ToRoomAssigned','to_invoice','production_date','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.product_code','exports','$product_details._id','Transfer\x20Finalize\x20Successfully','573330CxYyuH','expiry_date','to_bay','from_room','from_warehouse','then','</thead>','1484619KyyCRf','site_title','from_bay','$product_details.maxPerUnit','/barcode_scanner2','Enclosed','save','$product_details.pallet','batch_code','post','</body></html>','5078sSpAwb','<hr\x20class=\x22my-3\x22>','from_quantity','$product_details.expiry_date','English\x20(US)','role','primary_unit','staff','slice','catch','edit_transfer_finished_view','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','split','nodemailer','\x20Order\x20Number\x20:\x20','/picking_list/PDF_transfer/','/transfer_finished/preview/','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Arabic','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','$name','email','_id','push','21SOofBm','padStart','$product_details.product_stock','warehouse','finalize','findOne','1580652VTTptt','product_code','$product_details','</div>','3011872KXkXnt','filter','<!DOCTYPE\x20html>','to_prod_level','Chinese','</tr>','Portuguese\x20(BR)','prod_name','to_warehouse','$finalize','secondary_code','<span\x20style=\x22float:\x20right;\x22>','$product_details.isle','get','Ambient','$product_details.primary_code','to_prod_qty','product_date','<tbody\x20style=\x22text-align:\x20center;\x22>','To_invoice','../models/all_models','sendMail','to_floorlevel','redirect','transfer_finished','True','$room','4nDiqKE','<html><head><title></title>','concat','$product_details.batch_code','back'];a0_0x5310=function(){return _0x280f57;};return a0_0x5310();}function BayBinSelected(_0x165f9d,_0x4809e1){var _0x13dc3a=a0_0x444e6a,_0x1a077f=[];let _0x2bdbd6=[];var _0x268027=[];if(_0x165f9d==_0x13dc3a(0x229)){switch(_0x4809e1){case _0x13dc3a(0x22c):_0x1a077f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x13dc3a(0x20b):_0x1a077f=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x268027=['DG'];}else{if(_0x165f9d==_0x13dc3a(0x187)){switch(_0x4809e1){case _0x13dc3a(0x22c):_0x1a077f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x13dc3a(0x20b):_0x1a077f=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x268027=['FG'];}}return{'levels':_0x1a077f,'identify':_0x268027};}router['get']('/view/:id',auth,async(_0x2a1f5f,_0x4ed5f8)=>{var _0x12a32e=a0_0x444e6a;try{const {username:_0xb9b5,email:_0x56be59,role:_0x18eb6d}=_0x2a1f5f[_0x12a32e(0x21c)],_0x56d283=_0x2a1f5f[_0x12a32e(0x21c)],_0x40bc51=await profile[_0x12a32e(0x1c9)]({'email':_0x56d283[_0x12a32e(0x1c1)]}),_0x5ddd7e=await master_shop[_0x12a32e(0x21a)](),_0x3ea923=await transfers_finished[_0x12a32e(0x231)](_0x2a1f5f[_0x12a32e(0x247)]['id']);let _0x3fdfc4=new Date(_0x3ea923[_0x12a32e(0x19b)]),_0x2bfcb1=('0'+_0x3fdfc4[_0x12a32e(0x24a)]())[_0x12a32e(0x1b4)](-0x2),_0x2f178e=('0'+(_0x3fdfc4['getMonth']()+0x1))[_0x12a32e(0x1b4)](-0x2),_0x1c5ba1=_0x3fdfc4[_0x12a32e(0x21b)](),_0x21bddc=_0x1c5ba1+'-'+_0x2f178e+'-'+_0x2bfcb1,_0x52bac5;if(_0x56d283[_0x12a32e(0x1b1)]==_0x12a32e(0x1b3)){const _0x47375b=await staff[_0x12a32e(0x1c9)]({'email':_0x56d283[_0x12a32e(0x1c1)]});_0x52bac5=await warehouse['find']({'status':'Enabled','name':_0x47375b[_0x12a32e(0x1c7)],'warehouse_category':_0x12a32e(0x242)});}else _0x52bac5=await warehouse[_0x12a32e(0x21a)]({'status':_0x12a32e(0x24b),'warehouse_category':'Finished\x20Goods'});const _0x17d1dc=await warehouse[_0x12a32e(0x251)]([{'$match':{'name':_0x3ea923[_0x12a32e(0x19e)],'room':_0x3ea923[_0x12a32e(0x19d)]}},{'$unwind':_0x12a32e(0x1cc)},{'$group':{'_id':_0x12a32e(0x198),'name':{'$first':_0x12a32e(0x210)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x12a32e(0x254)},'bin':{'$first':_0x12a32e(0x18d)},'type':{'$first':_0x12a32e(0x1f4)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x12a32e(0x196)},'storage':{'$first':_0x12a32e(0x23a)},'rack':{'$first':'$product_details.rack'}}}]);var _0x15ef82=[0x1,0x2,0x3,0x4],_0x499ae7=['A','B','C','D','E','F','G','H','I','J'],_0x1b5f93=[_0x12a32e(0x1dc),_0x12a32e(0x1a6)];const _0x2d6dd2=await product['find']({}),_0x4142d6=BayBinSelected(_0x3ea923[_0x12a32e(0x1d6)],_0x3ea923['to_room']);if(_0x5ddd7e[0x0]['language']==_0x12a32e(0x1b0)){var _0x303237=users[_0x12a32e(0x209)];console[_0x12a32e(0x20c)](_0x303237);}else{if(_0x5ddd7e[0x0]['language']=='Hindi')var _0x303237=users[_0x12a32e(0x20e)];else{if(_0x5ddd7e[0x0]['language']==_0x12a32e(0x259))var _0x303237=users[_0x12a32e(0x259)];else{if(_0x5ddd7e[0x0][_0x12a32e(0x237)]==_0x12a32e(0x225))var _0x303237=users['Spanish'];else{if(_0x5ddd7e[0x0]['language']==_0x12a32e(0x20f))var _0x303237=users[_0x12a32e(0x20f)];else{if(_0x5ddd7e[0x0][_0x12a32e(0x237)]=='Portuguese\x20(BR)')var _0x303237=users[_0x12a32e(0x21d)];else{if(_0x5ddd7e[0x0]['language']==_0x12a32e(0x1d2))var _0x303237=users[_0x12a32e(0x1d2)];else{if(_0x5ddd7e[0x0][_0x12a32e(0x237)]=='Arabic\x20(ae)')var _0x303237=users[_0x12a32e(0x1be)];}}}}}}}_0x4ed5f8['render'](_0x12a32e(0x204),{'success':_0x2a1f5f[_0x12a32e(0x23e)](_0x12a32e(0x240)),'errors':_0x2a1f5f[_0x12a32e(0x23e)](_0x12a32e(0x1ff)),'role':_0x56d283,'profile':_0x40bc51,'master_shop':_0x5ddd7e,'warehouse':_0x52bac5,'transfer':_0x3ea923,'stock':_0x17d1dc,'unit':_0x2d6dd2,'language':_0x303237,'levels':_0x15ef82,'Isle':_0x499ae7,'rooms_data':_0x1b5f93,'ed_fullDate':_0x21bddc,'dataSelected':_0x4142d6});}catch(_0x5af88f){console[_0x12a32e(0x20c)](_0x5af88f);}}),router[a0_0x444e6a(0x1aa)]('/view/:id',auth,async(_0x5228a1,_0x46e48b)=>{var _0x40e098=a0_0x444e6a;try{const _0x3cbcdf=_0x5228a1[_0x40e098(0x247)]['id'];console[_0x40e098(0x20c)](_0x5228a1['body']);const _0x5685b8=await transfers_finished[_0x40e098(0x231)](_0x3cbcdf);console[_0x40e098(0x20c)](_0x40e098(0x255),_0x5685b8);const {date:_0x600e0e,from_warehouse:_0x1075f8,FromRoom_name:_0x1a01ef,to_warehouse:_0xeed4c5,ToRoom_name:_0x44f17a,prod_name:_0x5cab43,from_prod_qty:_0x229a50,from_prod_level:_0x4b062a,from_prod_isle:_0x474e7d,from_prod_pallet:_0x420221,to_prod_qty:_0x2efe93,to_prod_level:_0x160940,to_prod_isle:_0x3f0c76,to_prod_pallet:_0x133149,primary_code:_0x54eb24,secondary_code:_0x6640c4,product_code3:_0x138f8e,note:_0x4d7cf6,invoice:_0x17216f,expiry_date:_0x4795d5}=_0x5228a1[_0x40e098(0x189)];if(typeof _0x5cab43==_0x40e098(0x1fd))var _0x236936=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x1d5)]],_0x1cf68c=[_0x5228a1[_0x40e098(0x189)]['from_prod_qty']],_0x4301fe=[_0x5228a1['body'][_0x40e098(0x18b)]],_0x5e659c=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x1de)]],_0x22e0b2=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x1d1)]],_0x220d5f=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x246)]],_0x566142=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x1d8)]],_0x22f2f3=[_0x5228a1['body']['product_code3']],_0x1642cb=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x243)]],_0x5939cc=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x217)]],_0x11cf04=[_0x5228a1[_0x40e098(0x189)][_0x40e098(0x233)]],_0x56fc78=[_0x5228a1[_0x40e098(0x189)]['batch_code']],_0x55b741=[_0x5228a1['body'][_0x40e098(0x19b)]];else var _0x236936=[..._0x5228a1[_0x40e098(0x189)][_0x40e098(0x1d5)]],_0x1cf68c=[..._0x5228a1[_0x40e098(0x189)]['from_prod_qty']],_0x4301fe=[..._0x5228a1[_0x40e098(0x189)][_0x40e098(0x18b)]],_0x5e659c=[..._0x5228a1['body'][_0x40e098(0x1de)]],_0x22e0b2=[..._0x5228a1[_0x40e098(0x189)][_0x40e098(0x1d1)]],_0x220d5f=[..._0x5228a1[_0x40e098(0x189)]['primary_code']],_0x566142=[..._0x5228a1['body'][_0x40e098(0x1d8)]],_0x22f2f3=[..._0x5228a1[_0x40e098(0x189)][_0x40e098(0x219)]],_0x1642cb=[..._0x5228a1[_0x40e098(0x189)]['MaxStocks_data2']],_0x5939cc=[..._0x5228a1['body'][_0x40e098(0x217)]],_0x11cf04=[..._0x5228a1[_0x40e098(0x189)][_0x40e098(0x233)]],_0x56fc78=[..._0x5228a1[_0x40e098(0x189)][_0x40e098(0x1a9)]],_0x55b741=[..._0x5228a1[_0x40e098(0x189)]['expiry_date']];const _0x1c7aef=_0x236936[_0x40e098(0x207)](_0x3513f8=>{return _0x3513f8={'product_name':_0x3513f8};});_0x1cf68c[_0x40e098(0x23d)]((_0x43ae4a,_0x2c5465)=>{var _0xb3b171=_0x40e098;_0x1c7aef[_0x2c5465][_0xb3b171(0x1ae)]=_0x43ae4a;}),_0x4301fe[_0x40e098(0x23d)]((_0x532d02,_0xd37233)=>{var _0x5efcb7=_0x40e098;_0x1c7aef[_0xd37233][_0x5efcb7(0x1a3)]=_0x532d02;}),_0x5e659c[_0x40e098(0x23d)]((_0x1734d4,_0x543ea4)=>{_0x1c7aef[_0x543ea4]['to_quantity']=_0x1734d4;}),_0x22e0b2[_0x40e098(0x23d)]((_0x4f676a,_0x3d0c7d)=>{var _0x30254c=_0x40e098;_0x1c7aef[_0x3d0c7d][_0x30254c(0x19c)]=_0x4f676a;}),_0x220d5f['forEach']((_0x3841f2,_0x116e05)=>{var _0x47f1b9=_0x40e098;_0x1c7aef[_0x116e05][_0x47f1b9(0x246)]=_0x3841f2;}),_0x566142['forEach']((_0xbd2957,_0x29839d)=>{_0x1c7aef[_0x29839d]['secondary_code']=_0xbd2957;}),_0x22f2f3[_0x40e098(0x23d)]((_0x64c72e,_0xed7035)=>{_0x1c7aef[_0xed7035]['product_code']=_0x64c72e;}),_0x1642cb[_0x40e098(0x23d)]((_0x34bf00,_0x4b9279)=>{var _0x1a47a6=_0x40e098;_0x1c7aef[_0x4b9279][_0x1a47a6(0x22d)]=_0x34bf00;}),_0x5939cc[_0x40e098(0x23d)]((_0x30508f,_0x2b8b23)=>{var _0x287eb7=_0x40e098;_0x1c7aef[_0x2b8b23][_0x287eb7(0x217)]=_0x30508f;}),_0x11cf04[_0x40e098(0x23d)]((_0xcfd7bc,_0x43519f)=>{var _0x4e2422=_0x40e098;_0x1c7aef[_0x43519f][_0x4e2422(0x233)]=_0xcfd7bc;}),_0x56fc78[_0x40e098(0x23d)]((_0x25a1e2,_0x3b0e3d)=>{var _0x304d5a=_0x40e098;_0x1c7aef[_0x3b0e3d][_0x304d5a(0x1a9)]=_0x25a1e2;}),_0x55b741['forEach']((_0x28ce7e,_0xd03ef7)=>{var _0x38232f=_0x40e098;_0x1c7aef[_0xd03ef7][_0x38232f(0x19b)]=_0x28ce7e;});const _0x46b2db=_0x1c7aef[_0x40e098(0x1cf)](_0x427e1e=>_0x427e1e['to_quantity']!=='0'&&_0x427e1e[_0x40e098(0x1f8)]!==''||_0x427e1e[_0x40e098(0x1e4)]!=='0'&&_0x427e1e[_0x40e098(0x1e4)]!=='');var _0x1633c4=0x0;_0x46b2db[_0x40e098(0x23d)](_0x5ee3c7=>{var _0x392ba3=_0x40e098;parseInt(_0x5ee3c7[_0x392ba3(0x1ae)])<parseInt(_0x5ee3c7['to_quantity'])&&_0x1633c4++;});if(_0x1633c4!=0x0)return _0x5228a1['flash']('errors',_0x40e098(0x25d)),_0x46e48b[_0x40e098(0x1e5)]('back');const _0x3aed88=await warehouse[_0x40e098(0x1c9)]({'name':_0x5685b8['from_warehouse'],'room':_0x5685b8[_0x40e098(0x19d)]});_0x5685b8[_0x40e098(0x20d)][_0x40e098(0x23d)](_0x5dccbd=>{var _0x563341=_0x40e098;if(_0x5dccbd['to_quantity']>0x0){const _0x5875ae=_0x3aed88[_0x563341(0x1fb)][_0x563341(0x207)](_0x4c91e2=>{var _0x5d6b9c=_0x563341;_0x4c91e2[_0x5d6b9c(0x1f0)]==_0x5dccbd[_0x5d6b9c(0x1f0)]&&_0x4c91e2['bay']==_0x5dccbd[_0x5d6b9c(0x1a3)]&&(_0x4c91e2[_0x5d6b9c(0x1f6)]=parseInt(_0x4c91e2[_0x5d6b9c(0x1f6)])+parseInt(_0x5dccbd['to_quantity']));});}}),await _0x3aed88[_0x40e098(0x1a7)]();const _0xa88c94=await warehouse[_0x40e098(0x1c9)]({'name':_0x5685b8['to_warehouse'],'room':_0x5685b8[_0x40e098(0x1f9)]});_0x5685b8['product'][_0x40e098(0x23d)](_0x17f35d=>{var _0x1c30d7=_0x40e098;if(_0x17f35d['to_quantity']>0x0){const _0x23f6ae=_0xa88c94[_0x1c30d7(0x1fb)][_0x1c30d7(0x207)](_0x1e0907=>{var _0xe14a94=_0x1c30d7;_0x1e0907[_0xe14a94(0x1f0)]==_0x17f35d[_0xe14a94(0x1f0)]&&_0x1e0907[_0xe14a94(0x205)]==_0x17f35d[_0xe14a94(0x19c)]&&(_0x1e0907[_0xe14a94(0x1f6)]=parseInt(_0x1e0907[_0xe14a94(0x1f6)])-parseInt(_0x17f35d['to_quantity']));});}}),await _0xa88c94['save'](),_0x5685b8[_0x40e098(0x253)]=_0x600e0e,_0x5685b8[_0x40e098(0x19e)]=_0x1075f8,_0x5685b8[_0x40e098(0x1d6)]=_0xeed4c5,_0x5685b8[_0x40e098(0x20d)]=_0x46b2db,_0x5685b8['note']=_0x4d7cf6,_0x5685b8[_0x40e098(0x208)]=_0x17216f;const _0x36acea=await _0x5685b8[_0x40e098(0x1a7)](),_0x6ff1f3=await warehouse[_0x40e098(0x1c9)]({'name':_0x1075f8,'room':_0x1a01ef});_0x36acea[_0x40e098(0x20d)][_0x40e098(0x23d)](_0x413b6f=>{var _0x46e98b=_0x40e098;if(_0x413b6f[_0x46e98b(0x1f8)]>0x0){const _0x2ae049=_0x6ff1f3[_0x46e98b(0x1fb)][_0x46e98b(0x207)](_0x2c1657=>{var _0x24975f=_0x46e98b;_0x2c1657[_0x24975f(0x1f0)]==_0x413b6f[_0x24975f(0x1f0)]&&_0x2c1657[_0x24975f(0x205)]==_0x413b6f['from_bay']&&(_0x2c1657[_0x24975f(0x1f6)]=parseInt(_0x2c1657['product_stock'])-parseInt(_0x413b6f[_0x24975f(0x1f8)]));});}}),await _0x6ff1f3['save']();const _0x12079f=await warehouse[_0x40e098(0x1c9)]({'name':_0xeed4c5,'room':_0x44f17a});_0x36acea['product'][_0x40e098(0x23d)](_0x466e0c=>{var _0x26d62f=_0x40e098;if(_0x466e0c['to_quantity']>0x0){var _0x55f905=0x0;const _0x48f906=_0x12079f['product_details'][_0x26d62f(0x207)](_0x54bfe0=>{var _0x4ca500=_0x26d62f;_0x54bfe0[_0x4ca500(0x1f0)]==_0x466e0c[_0x4ca500(0x1f0)]&&_0x54bfe0[_0x4ca500(0x205)]==_0x466e0c[_0x4ca500(0x19c)]&&(_0x54bfe0[_0x4ca500(0x1f6)]=parseInt(_0x54bfe0['product_stock'])+parseInt(_0x466e0c[_0x4ca500(0x1f8)]),_0x55f905++);});_0x55f905=='0'&&(_0x12079f[_0x26d62f(0x1fb)]=_0x12079f[_0x26d62f(0x1fb)][_0x26d62f(0x1eb)]({'product_name':_0x466e0c[_0x26d62f(0x1f0)],'product_stock':_0x466e0c['to_quantity'],'bay':_0x466e0c[_0x26d62f(0x19c)],'product_code':_0x466e0c['product_code'],'primary_code':_0x466e0c['primary_code'],'secondary_code':_0x466e0c['secondary_code'],'maxProducts':_0x466e0c[_0x26d62f(0x22d)]}));}}),await _0x12079f[_0x40e098(0x1a7)](),_0x5228a1[_0x40e098(0x23e)]('success',_0x40e098(0x18c)),_0x46e48b['redirect'](_0x40e098(0x1ef));}catch(_0x3ea50a){console[_0x40e098(0x20c)](_0x3ea50a);}}),router[a0_0x444e6a(0x1aa)]('/barcode_scanner',async(_0x209ed4,_0xc6aaa7)=>{var _0x1f87f9=a0_0x444e6a;const {FromWareHouse:_0x3b55ce,FromRoom:_0x560c41,ToWarehouse:_0xd9f2c5,ToRoom:_0x1388bb,primary_code:_0x145eae,Roomslist:_0xaf860c}=_0x209ed4['body'],_0x4ad544=_0xaf860c[_0x1f87f9(0x1b8)](','),_0x453b1a=[];async function _0x401c6d(_0x56ac7d){var _0x497fd4=_0x1f87f9;const _0x1d5ee4=await warehouse[_0x497fd4(0x251)]([{'$match':{'name':_0x3b55ce,'room':_0x56ac7d}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x145eae}},{'$group':{'_id':_0x497fd4(0x198),'name':{'$first':_0x497fd4(0x210)},'instock':{'$first':_0x497fd4(0x1c6)},'primary_code':{'$first':_0x497fd4(0x1dd)},'secondary_code':{'$first':_0x497fd4(0x190)},'product_code':{'$first':_0x497fd4(0x196)},'level':{'$first':_0x497fd4(0x254)},'isle':{'$first':_0x497fd4(0x18d)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x497fd4(0x203)},'unit':{'$first':_0x497fd4(0x228)},'secondary_unit':{'$first':_0x497fd4(0x220)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x497fd4(0x25e)},'expiry_date':{'$first':_0x497fd4(0x1af)},'production_date':{'$first':_0x497fd4(0x241)},'batch_code':{'$first':_0x497fd4(0x1ec)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x497fd4(0x1e8)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x497fd4(0x22b)}}}]),_0x2b6c6d=await warehouse[_0x497fd4(0x251)]([{'$match':{'name':_0x3b55ce,'room':_0x56ac7d}},{'$unwind':_0x497fd4(0x1cc)},{'$match':{'product_details.secondary_code':_0x145eae}},{'$group':{'_id':_0x497fd4(0x198),'name':{'$first':_0x497fd4(0x210)},'instock':{'$first':_0x497fd4(0x1c6)},'primary_code':{'$first':_0x497fd4(0x1dd)},'secondary_code':{'$first':_0x497fd4(0x190)},'product_code':{'$first':_0x497fd4(0x196)},'level':{'$first':_0x497fd4(0x254)},'isle':{'$first':_0x497fd4(0x18d)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x497fd4(0x203)},'unit':{'$first':_0x497fd4(0x228)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x497fd4(0x25e)},'expiry_date':{'$first':_0x497fd4(0x1af)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x497fd4(0x1ec)},'maxPerUnit':{'$first':_0x497fd4(0x1a4)},'roomNamed':{'$first':_0x497fd4(0x1e8)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x497fd4(0x22b)}}}]);if(_0x1d5ee4[_0x497fd4(0x216)]>0x0)_0x453b1a[_0x497fd4(0x1c3)](_0x1d5ee4);else _0x2b6c6d[_0x497fd4(0x216)]>0x0&&_0x453b1a[_0x497fd4(0x1c3)](_0x2b6c6d);}const _0x73c3e5=_0x4ad544['map'](_0x22c824=>_0x401c6d(_0x22c824));await Promise['all'](_0x73c3e5),_0xc6aaa7[_0x1f87f9(0x221)](_0x453b1a);}),router[a0_0x444e6a(0x1aa)](a0_0x444e6a(0x1a5),async(_0x19beab,_0x5be740)=>{var _0x53a794=a0_0x444e6a;try{const {FromWareHouse:_0x140b31,FromRoom:_0x265bdc,ToWarehouse:_0x52a9be,ToRoom:_0x194c1e,secondary_code:_0x448191}=_0x19beab[_0x53a794(0x189)],_0x31d325=await warehouse[_0x53a794(0x251)]([{'$match':{'name':_0x140b31}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x448191}},{'$group':{'_id':_0x53a794(0x198),'name':{'$first':_0x53a794(0x210)},'primary_code':{'$first':_0x53a794(0x1dd)},'secondary_code':{'$first':_0x53a794(0x190)},'product_code':{'$first':_0x53a794(0x196)},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':'$name'},'level':{'$first':_0x53a794(0x20a)},'isle':{'$first':_0x53a794(0x1da)},'pallet':{'$first':_0x53a794(0x1a8)},'maxProducts':{'$first':_0x53a794(0x1fa)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':_0x53a794(0x1af)},'production_date':{'$first':'$product_details.production_date'}}}]);_0x5be740[_0x53a794(0x213)](0xc8)[_0x53a794(0x221)](_0x31d325);}catch(_0x5839da){_0x5be740[_0x53a794(0x213)](0x194)[_0x53a794(0x221)]({'message':_0x5839da['message']});}}),router[a0_0x444e6a(0x1aa)]('/barcode_scanner3',async(_0x20e828,_0x42ca0e)=>{var _0x157e76=a0_0x444e6a;try{const {FromWareHouse:_0x3590b6,FromRoom:_0x5b618d,ToWarehouse:_0x2eead7,ToRoom:_0x1cee82,product_code:_0x469c1a}=_0x20e828['body'],_0x3e3211=await warehouse[_0x157e76(0x251)]([{'$match':{'name':_0x3590b6}},{'$unwind':_0x157e76(0x1cc)},{'$match':{'product_details.product_code':_0x469c1a}},{'$group':{'_id':_0x157e76(0x198),'name':{'$first':_0x157e76(0x210)},'primary_code':{'$first':_0x157e76(0x1dd)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x157e76(0x196)},'instock':{'$first':_0x157e76(0x1c6)},'warehouse':{'$first':_0x157e76(0x1c0)},'level':{'$first':_0x157e76(0x20a)},'isle':{'$first':_0x157e76(0x1da)},'pallet':{'$first':_0x157e76(0x1a8)},'maxProducts':{'$first':_0x157e76(0x1fa)},'unit':{'$first':_0x157e76(0x228)}}}]);_0x42ca0e[_0x157e76(0x213)](0xc8)[_0x157e76(0x221)](_0x3e3211);}catch(_0x56df8f){_0x42ca0e[_0x157e76(0x213)](0x194)['json']({'message':_0x56df8f['message']});}}),router[a0_0x444e6a(0x1aa)]('/CheckingWarehouse',async(_0x553f0e,_0xcbb635)=>{var _0x4162c4=a0_0x444e6a;const {productCode:_0x116a3a,bay:_0x113136,warehouses:_0x12c1b0,room:_0x3ef96f}=_0x553f0e[_0x4162c4(0x189)];console['log'](_0x553f0e[_0x4162c4(0x189)]);try{const _0x5344da=await warehouse[_0x4162c4(0x251)]([{'$match':{'name':_0x12c1b0,'room':_0x3ef96f}},{'$unwind':_0x4162c4(0x1cc)},{'$match':{'product_details.bay':parseInt(_0x113136)}},{'$group':{'_id':_0x4162c4(0x198),'name':{'$first':_0x4162c4(0x210)},'product_stock':{'$first':_0x4162c4(0x1c6)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x4162c4(0x1fa)}}}]);_0xcbb635[_0x4162c4(0x213)](0xc8)[_0x4162c4(0x221)](_0x5344da);}catch(_0xc2ff8f){_0xcbb635[_0x4162c4(0x213)](0x194)[_0x4162c4(0x221)]({'message':_0xc2ff8f[_0x4162c4(0x22e)]});}}),module[a0_0x444e6a(0x197)]=router;