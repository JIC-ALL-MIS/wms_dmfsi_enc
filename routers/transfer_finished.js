var a0_0x3899a3=a0_0x2363;(function(_0x28ed32,_0x1ddc03){var _0x12fd66=a0_0x2363,_0x1691a0=_0x28ed32();while(!![]){try{var _0x4bb437=parseInt(_0x12fd66(0x1a9))/0x1+parseInt(_0x12fd66(0x1dd))/0x2*(-parseInt(_0x12fd66(0x12c))/0x3)+-parseInt(_0x12fd66(0x121))/0x4+-parseInt(_0x12fd66(0x1ba))/0x5+parseInt(_0x12fd66(0x1c7))/0x6*(-parseInt(_0x12fd66(0x194))/0x7)+-parseInt(_0x12fd66(0x1c0))/0x8+parseInt(_0x12fd66(0x174))/0x9*(parseInt(_0x12fd66(0x14c))/0xa);if(_0x4bb437===_0x1ddc03)break;else _0x1691a0['push'](_0x1691a0['shift']());}catch(_0x2e8cff){_0x1691a0['push'](_0x1691a0['shift']());}}}(a0_0x4869,0x9c3a4));const express=require(a0_0x3899a3(0x149)),app=express(),router=express[a0_0x3899a3(0x186)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require('nodemailer');router['get'](a0_0x3899a3(0x19a),auth,async(_0x58c8f5,_0x2ea692)=>{var _0xfb1c8b=a0_0x3899a3;try{const {username:_0x23a1a8,email:_0x28a2ab,role:_0x3027e7}=_0x58c8f5[_0xfb1c8b(0x1e3)],_0x341357=_0x58c8f5[_0xfb1c8b(0x1e3)],_0x27ddb2=await profile[_0xfb1c8b(0x1c1)]({'email':_0x341357['email']}),_0xa7c8e8=await master_shop[_0xfb1c8b(0x182)]();let _0x4cc95e;if(_0x341357[_0xfb1c8b(0x18f)]=='staff'){const _0x1ce72e=await staff[_0xfb1c8b(0x1c1)]({'email':_0x341357[_0xfb1c8b(0x14b)]});_0x4cc95e=await transfers_finished[_0xfb1c8b(0x182)]({'from_warehouse':_0x1ce72e[_0xfb1c8b(0x12e)]});}else _0x4cc95e=await transfers_finished[_0xfb1c8b(0x152)]([{'$unwind':'$product'},{'$group':{'_id':'$_id','invoice':{'$first':_0xfb1c8b(0x15c)},'date':{'$first':'$date'},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0xfb1c8b(0x123)},'from_room_name':{'$addToSet':_0xfb1c8b(0x1d2)},'to_room_name':{'$addToSet':_0xfb1c8b(0x1c2)},'finalize':{'$first':_0xfb1c8b(0x150)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]==_0xfb1c8b(0x1d5))var _0x636c83=users[_0xfb1c8b(0x1c4)];else{if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]==_0xfb1c8b(0x1a5))var _0x636c83=users[_0xfb1c8b(0x1a5)];else{if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]=='German')var _0x636c83=users[_0xfb1c8b(0x1e7)];else{if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]=='Spanish')var _0x636c83=users[_0xfb1c8b(0x1ae)];else{if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]==_0xfb1c8b(0x12b))var _0x636c83=users[_0xfb1c8b(0x12b)];else{if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]==_0xfb1c8b(0x1a8))var _0x636c83=users[_0xfb1c8b(0x189)];else{if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]==_0xfb1c8b(0x133))var _0x636c83=users[_0xfb1c8b(0x133)];else{if(_0xa7c8e8[0x0][_0xfb1c8b(0x1e1)]==_0xfb1c8b(0x1ab))var _0x636c83=users[_0xfb1c8b(0x192)];}}}}}}}_0x2ea692[_0xfb1c8b(0x136)](_0xfb1c8b(0x179),{'success':_0x58c8f5[_0xfb1c8b(0x13c)](_0xfb1c8b(0x112)),'errors':_0x58c8f5[_0xfb1c8b(0x13c)](_0xfb1c8b(0x171)),'role':_0x341357,'profile':_0x27ddb2,'master_shop':_0xa7c8e8,'transfer':_0x4cc95e,'language':_0x636c83});}catch(_0x4d061d){console[_0xfb1c8b(0x19c)](_0x4d061d);}});async function getRandom8DigitNumber(){var _0x2d3296=a0_0x3899a3;const _0x24d4a5=0x989680,_0x4e4aad=0x5f5e0ff,_0x3daef3=Math['floor'](Math[_0x2d3296(0x131)]()*(_0x4e4aad-_0x24d4a5+0x1))+_0x24d4a5;var _0x27eaa7;const _0x35e494=await transfers_finished[_0x2d3296(0x1c1)]({'invoice':'TRFF-'+_0x3daef3});return _0x35e494&&_0x35e494[_0x2d3296(0x1da)]>0x0?_0x27eaa7=_0x2d3296(0x1e0)+_0x3daef3:_0x27eaa7='TRFF-'+_0x3daef3,_0x27eaa7;}function a0_0x2363(_0x27509d,_0x12ce55){var _0x4869a7=a0_0x4869();return a0_0x2363=function(_0x236386,_0x17b1b4){_0x236386=_0x236386-0x10b;var _0x464fe5=_0x4869a7[_0x236386];return _0x464fe5;},a0_0x2363(_0x27509d,_0x12ce55);}router['get'](a0_0x3899a3(0x1d8),auth,async(_0x1bf0c4,_0x56648f)=>{var _0x56de94=a0_0x3899a3;try{const {username:_0xf7858,email:_0x13d265,role:_0x30c765}=_0x1bf0c4[_0x56de94(0x1e3)],_0x10839d=_0x1bf0c4[_0x56de94(0x1e3)],_0x48edeb=await profile[_0x56de94(0x1c1)]({'email':_0x10839d['email']}),_0x321819=await master_shop['find']();let _0x518840;if(_0x10839d[_0x56de94(0x18f)]=='staff'){const _0xdb773e=await staff['findOne']({'email':_0x10839d[_0x56de94(0x14b)]});_0x518840=await warehouse[_0x56de94(0x152)]([{'$match':{'status':'Enabled','name':_0xdb773e[_0x56de94(0x12e)],'warehouse_category':_0x56de94(0x1c8),'name':{'$ne':_0x56de94(0x115)}}},{'$group':{'_id':_0x56de94(0x1b5),'name':{'$first':_0x56de94(0x1b5)}}}]);}else _0x518840=await warehouse[_0x56de94(0x152)]([{'$match':{'status':_0x56de94(0x125),'warehouse_category':_0x56de94(0x1c8),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x56de94(0x1b5),'name':{'$first':'$name'}}}]);const _0x690b2b=await transfers_finished[_0x56de94(0x182)]({}),_0x1a54c1=_0x690b2b['length']+0x1,_0x838824='TRFF-'+_0x1a54c1['toString']()['padStart'](0x5,'0');if(_0x321819[0x0]['language']=='English\x20(US)')var _0x2743f1=users[_0x56de94(0x1c4)];else{if(_0x321819[0x0][_0x56de94(0x1e1)]==_0x56de94(0x1a5))var _0x2743f1=users[_0x56de94(0x1a5)];else{if(_0x321819[0x0][_0x56de94(0x1e1)]==_0x56de94(0x1e7))var _0x2743f1=users['German'];else{if(_0x321819[0x0][_0x56de94(0x1e1)]=='Spanish')var _0x2743f1=users['Spanish'];else{if(_0x321819[0x0][_0x56de94(0x1e1)]==_0x56de94(0x12b))var _0x2743f1=users[_0x56de94(0x12b)];else{if(_0x321819[0x0][_0x56de94(0x1e1)]==_0x56de94(0x1a8))var _0x2743f1=users[_0x56de94(0x189)];else{if(_0x321819[0x0][_0x56de94(0x1e1)]==_0x56de94(0x133))var _0x2743f1=users[_0x56de94(0x133)];else{if(_0x321819[0x0][_0x56de94(0x1e1)]==_0x56de94(0x1ab))var _0x2743f1=users[_0x56de94(0x192)];}}}}}}}const _0x58db28=getRandom8DigitNumber();_0x58db28[_0x56de94(0x13f)](_0x180fdd=>{var _0x39036f=_0x56de94;_0x56648f[_0x39036f(0x136)](_0x39036f(0x110),{'success':_0x1bf0c4['flash'](_0x39036f(0x112)),'errors':_0x1bf0c4[_0x39036f(0x13c)](_0x39036f(0x171)),'role':_0x10839d,'profile':_0x48edeb,'master_shop':_0x321819,'warehouse':_0x518840,'language':_0x2743f1,'invoice':_0x180fdd});})[_0x56de94(0x11e)](_0x399611=>{var _0x53f8b8=_0x56de94;_0x1bf0c4[_0x53f8b8(0x13c)](_0x53f8b8(0x171),_0x53f8b8(0x196)),_0x56648f[_0x53f8b8(0x1b3)](_0x53f8b8(0x1c3));});}catch(_0x2c44ef){console[_0x56de94(0x19c)](_0x2c44ef);}}),router[a0_0x3899a3(0x165)](a0_0x3899a3(0x1d8),auth,async(_0x726428,_0x5e02b3)=>{var _0x42c832=a0_0x3899a3;try{const {date:_0x18a34a,from_warehouse:_0xa6e65c,FromRoom_name:_0x202476,to_warehouse:_0x5177fa,ToRoom_name:_0x3ce9d5,prod_name:_0x5447f4,from_prod_qty:_0x1d4896,from_prod_level:_0x379b73,from_prod_isle:_0x248408,from_prod_pallet:_0x4668aa,to_prod_qty:_0x12c3a2,to_prod_level:_0xff5033,to_prod_isle:_0x24c3d3,to_prod_pallet:_0x2b35db,primary_code:_0x4a3062,secondary_code:_0x3a3f85,product_code3:_0x1033c2,note:_0x308329,MaxStocks_data2:_0x13fb99,invoice:_0x131a68,expiry_date:_0x28a029}=_0x726428[_0x42c832(0x1af)];if(typeof _0x5447f4==_0x42c832(0x16d))var _0x4a4c55=[_0x726428['body']['prod_name']],_0x6ace7=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x17e)]],_0x9639ac=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x10d)]],_0x12c0a8=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x164)]],_0x4608ce=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x163)]],_0x5127ba=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x161)]],_0x409cd5=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x1e2)]],_0x5bae85=[_0x726428['body'][_0x42c832(0x18d)]],_0x140569=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x13b)]],_0x56e919=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x187)]],_0x12ec11=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x158)]],_0x198109=[_0x726428[_0x42c832(0x1af)]['batch_code']],_0x3f0481=[_0x726428['body']['expiry_date']],_0x40b963=[_0x726428[_0x42c832(0x1af)]['product_date']],_0x44d8fd=[_0x726428['body'][_0x42c832(0x1a3)]],_0x1c5bc5=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x18c)]],_0x457633=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x155)]],_0x557817=[_0x726428['body'][_0x42c832(0x1b6)]],_0x50bc2e=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x1d3)]],_0x4e2999=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x16b)]],_0x19c00f=[_0x726428[_0x42c832(0x1af)][_0x42c832(0x1b9)]],_0x812cf9=[_0x726428[_0x42c832(0x1af)]['id_transaction']];else var _0x4a4c55=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x153)]],_0x6ace7=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x17e)]],_0x9639ac=[..._0x726428[_0x42c832(0x1af)]['from_prod_level']],_0x12c0a8=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x164)]],_0x4608ce=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x163)]],_0x5127ba=[..._0x726428['body'][_0x42c832(0x161)]],_0x409cd5=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x1e2)]],_0x5bae85=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x18d)]],_0x140569=[..._0x726428[_0x42c832(0x1af)]['MaxStocks_data2']],_0x56e919=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x187)]],_0x12ec11=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x158)]],_0x198109=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x1e4)]],_0x3f0481=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x140)]],_0x40b963=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x193)]],_0x44d8fd=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x1a3)]],_0x1c5bc5=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x18c)]],_0x457633=[..._0x726428['body'][_0x42c832(0x155)]],_0x557817=[..._0x726428['body'][_0x42c832(0x1b6)]],_0x50bc2e=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x1d3)]],_0x4e2999=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x16b)]],_0x19c00f=[..._0x726428[_0x42c832(0x1af)][_0x42c832(0x1b9)]],_0x812cf9=[..._0x726428['body']['id_transaction']];const _0x4a3105=_0x4a4c55[_0x42c832(0x17a)](_0x1c3ca8=>{return _0x1c3ca8={'product_name':_0x1c3ca8};});_0x6ace7[_0x42c832(0x1a4)]((_0xd13a4,_0x38677c)=>{var _0x911a4a=_0x42c832;_0x4a3105[_0x38677c][_0x911a4a(0x151)]=_0xd13a4;}),_0x9639ac[_0x42c832(0x1a4)]((_0x2ddfc5,_0x238b6a)=>{var _0x5ed7b5=_0x42c832;_0x4a3105[_0x238b6a][_0x5ed7b5(0x19e)]=_0x2ddfc5;}),_0x812cf9[_0x42c832(0x1a4)]((_0x4e596b,_0x3a42da)=>{var _0x7867be=_0x42c832;_0x4a3105[_0x3a42da][_0x7867be(0x156)]=_0x4e596b;}),_0x4e2999[_0x42c832(0x1a4)]((_0x4168ad,_0x14ca94)=>{var _0x3753ab=_0x42c832;_0x4a3105[_0x14ca94][_0x3753ab(0x16b)]=_0x4168ad;}),_0x19c00f[_0x42c832(0x1a4)]((_0x44fcaa,_0x406a36)=>{var _0xac9a49=_0x42c832;_0x4a3105[_0x406a36][_0xac9a49(0x157)]=_0x44fcaa;}),_0x12c0a8['forEach']((_0x2b2fd4,_0x3dda1b)=>{var _0x2d1f5c=_0x42c832;_0x4a3105[_0x3dda1b][_0x2d1f5c(0x1df)]=_0x2b2fd4;}),_0x4608ce['forEach']((_0x278dd4,_0x243108)=>{var _0x29fcfd=_0x42c832;_0x4a3105[_0x243108][_0x29fcfd(0x16a)]=_0x278dd4;}),_0x5127ba[_0x42c832(0x1a4)]((_0x502bd2,_0x297edd)=>{var _0x5cbcdd=_0x42c832;_0x4a3105[_0x297edd][_0x5cbcdd(0x161)]=_0x502bd2;}),_0x409cd5['forEach']((_0x555346,_0x140db4)=>{_0x4a3105[_0x140db4]['secondary_code']=_0x555346;}),_0x5bae85[_0x42c832(0x1a4)]((_0x18f663,_0x3279af)=>{_0x4a3105[_0x3279af]['product_code']=_0x18f663;}),_0x140569[_0x42c832(0x1a4)]((_0x5a14e1,_0x5c649b)=>{_0x4a3105[_0x5c649b]['maxProducts']=_0x5a14e1;}),_0x56e919[_0x42c832(0x1a4)]((_0x33f1f4,_0x4b37c5)=>{var _0x4fcba0=_0x42c832;_0x4a3105[_0x4b37c5][_0x4fcba0(0x191)]=_0x33f1f4;}),_0x12ec11[_0x42c832(0x1a4)]((_0x59448e,_0xa9eda)=>{var _0x5d70a4=_0x42c832;_0x4a3105[_0xa9eda][_0x5d70a4(0x158)]=_0x59448e;}),_0x198109[_0x42c832(0x1a4)]((_0x150d89,_0x22e68f)=>{var _0x17c240=_0x42c832;_0x4a3105[_0x22e68f][_0x17c240(0x1e4)]=_0x150d89;}),_0x3f0481[_0x42c832(0x1a4)]((_0x3005a1,_0x2feb7b)=>{var _0x1cf00f=_0x42c832;_0x4a3105[_0x2feb7b][_0x1cf00f(0x140)]=_0x3005a1;}),_0x40b963[_0x42c832(0x1a4)]((_0x222787,_0x4a205a)=>{var _0x52f5ca=_0x42c832;_0x4a3105[_0x4a205a][_0x52f5ca(0x118)]=_0x222787;}),_0x44d8fd[_0x42c832(0x1a4)]((_0x266b21,_0x34ae61)=>{_0x4a3105[_0x34ae61]['maxProducts']=_0x266b21;}),_0x1c5bc5[_0x42c832(0x1a4)]((_0x5b63d0,_0x51cf92)=>{_0x4a3105[_0x51cf92]['maxPerUnit']=_0x5b63d0;}),_0x457633[_0x42c832(0x1a4)]((_0x4ef189,_0x190e24)=>{var _0x4b72df=_0x42c832;_0x4a3105[_0x190e24][_0x4b72df(0x155)]=_0x4ef189;}),_0x557817[_0x42c832(0x1a4)]((_0x244a6f,_0xe00133)=>{var _0xa7160d=_0x42c832;_0x4a3105[_0xe00133][_0xa7160d(0x1dc)]=_0x244a6f;}),_0x50bc2e[_0x42c832(0x1a4)]((_0x4610b8,_0x1ecf22)=>{var _0x592cf6=_0x42c832;_0x4a3105[_0x1ecf22][_0x592cf6(0x10e)]=_0x4610b8;});const _0x46962b=_0x4a3105[_0x42c832(0x16c)](_0x71e1ab=>_0x71e1ab[_0x42c832(0x1df)]!=='0'&&_0x71e1ab[_0x42c832(0x1df)]!==''||_0x71e1ab[_0x42c832(0x16e)]!=='0'&&_0x71e1ab['to_floorlevel']!=='');var _0x188a6c=0x0;_0x46962b[_0x42c832(0x1a4)](_0x5ccf6d=>{var _0x4b8c07=_0x42c832;parseInt(_0x5ccf6d[_0x4b8c07(0x151)])<parseInt(_0x5ccf6d[_0x4b8c07(0x1df)])&&_0x188a6c++;});if(_0x188a6c!=0x0)return _0x726428[_0x42c832(0x13c)](_0x42c832(0x171),_0x42c832(0x111)),_0x5e02b3['redirect'](_0x42c832(0x1d4));const _0x2c2d47=new transfers_finished({'date':_0x18a34a,'from_warehouse':_0xa6e65c,'to_warehouse':_0x5177fa,'product':_0x46962b,'note':_0x308329,'invoice':_0x131a68}),_0x1ca59c=await _0x2c2d47['save']();_0x726428['flash']('success',_0x42c832(0x117)),_0x5e02b3[_0x42c832(0x1b3)](_0x42c832(0x124)+_0x1ca59c[_0x42c832(0x19d)]);}catch(_0x9e0247){console['log'](_0x9e0247),_0x5e02b3[_0x42c832(0x128)](0xc8)[_0x42c832(0x1cc)]({'errorMessage':_0x9e0247['message']});}}),router[a0_0x3899a3(0x1b7)](a0_0x3899a3(0x14e),auth,async(_0x59ff91,_0x570fed)=>{var _0x4dd642=a0_0x3899a3;try{const {username:_0x517398,email:_0x5801c6,role:_0x150aa7}=_0x59ff91[_0x4dd642(0x1e3)],_0x546ce8=_0x59ff91[_0x4dd642(0x1e3)],_0x386fca=await profile['findOne']({'email':_0x546ce8[_0x4dd642(0x14b)]}),_0x176783=await master_shop['find'](),_0x4115f5=await transfers_finished[_0x4dd642(0x160)](_0x59ff91[_0x4dd642(0x1c6)]['id']);let _0x53c54e;if(_0x546ce8[_0x4dd642(0x18f)]=='staff'){const _0xd7d0cc=await staff[_0x4dd642(0x1c1)]({'email':_0x546ce8[_0x4dd642(0x14b)]});_0x53c54e=await warehouse[_0x4dd642(0x182)]({'status':'Enabled','name':_0xd7d0cc['warehouse'],'warehouse_category':_0x4dd642(0x1c8)});}else _0x53c54e=await warehouse[_0x4dd642(0x182)]({'status':_0x4dd642(0x125),'warehouse_category':_0x4dd642(0x1c8)});const _0x5c48f0=await warehouse[_0x4dd642(0x152)]([{'$match':{'name':_0x4115f5[_0x4dd642(0x119)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x4dd642(0x178),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4dd642(0x113)},'bay':{'$first':_0x4dd642(0x18b)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x4dd642(0x181)},'floorlevel':{'$first':_0x4dd642(0x190)},'primary_code':{'$first':_0x4dd642(0x14d)},'secondary_code':{'$first':_0x4dd642(0x1b2)},'product_code':{'$first':_0x4dd642(0x11f)},'storage':{'$first':_0x4dd642(0x1a1)},'rack':{'$first':_0x4dd642(0x1db)},'expiry_date':{'$first':_0x4dd642(0x11b)},'production_date':{'$first':_0x4dd642(0x168)},'room':{'$first':_0x4dd642(0x138)},'warehoue_name':{'$first':_0x4dd642(0x1b5)}}}]),_0x4fe7af=await product['find']({});if(_0x176783[0x0][_0x4dd642(0x1e1)]=='English\x20(US)'){var _0x355cb8=users[_0x4dd642(0x1c4)];console['log'](_0x355cb8);}else{if(_0x176783[0x0][_0x4dd642(0x1e1)]=='Hindi')var _0x355cb8=users[_0x4dd642(0x1a5)];else{if(_0x176783[0x0]['language']=='German')var _0x355cb8=users['German'];else{if(_0x176783[0x0][_0x4dd642(0x1e1)]==_0x4dd642(0x1ae))var _0x355cb8=users[_0x4dd642(0x1ae)];else{if(_0x176783[0x0][_0x4dd642(0x1e1)]==_0x4dd642(0x12b))var _0x355cb8=users['French'];else{if(_0x176783[0x0][_0x4dd642(0x1e1)]==_0x4dd642(0x1a8))var _0x355cb8=users['Portuguese'];else{if(_0x176783[0x0][_0x4dd642(0x1e1)]==_0x4dd642(0x133))var _0x355cb8=users[_0x4dd642(0x133)];else{if(_0x176783[0x0][_0x4dd642(0x1e1)]==_0x4dd642(0x1ab))var _0x355cb8=users['Arabic'];}}}}}}}_0x570fed[_0x4dd642(0x136)](_0x4dd642(0x18a),{'success':_0x59ff91[_0x4dd642(0x13c)](_0x4dd642(0x112)),'errors':_0x59ff91[_0x4dd642(0x13c)]('errors'),'role':_0x546ce8,'profile':_0x386fca,'master_shop':_0x176783,'warehouse':_0x53c54e,'transfer':_0x4115f5,'stock':_0x5c48f0,'unit':_0x4fe7af,'language':_0x355cb8});}catch(_0x27d865){console[_0x4dd642(0x19c)](_0x27d865);}}),router[a0_0x3899a3(0x165)](a0_0x3899a3(0x14e),auth,async(_0x1396cf,_0x5a34a0)=>{var _0x1d1fa3=a0_0x3899a3;try{const {invoice:_0x70c9af,from_warehouse:_0x4488a2,FromRoom_name:_0x3b25a2,to_warehouse:_0x1ccca3,ToRoom_name:_0x3cc096}=_0x1396cf[_0x1d1fa3(0x1af)],_0x36f197=await transfers_finished[_0x1d1fa3(0x160)](_0x1396cf['params']['id']),_0x513220=_0x36f197[_0x1d1fa3(0x169)]['map'](async _0x3aca06=>{var _0x2c78d=_0x1d1fa3;if(_0x3aca06[_0x2c78d(0x1df)]>0x0){var _0x3b9139=await warehouse['findOne']({'name':_0x4488a2,'room':_0x3aca06['from_room_name'],'warehouse_category':'Finished\x20Goods'});const _0x4d9ce1=_0x3b9139['product_details']['map'](_0x14846d=>{var _0x5c8294=_0x2c78d;_0x14846d[_0x5c8294(0x1b4)]==_0x3aca06['product_name']&&_0x14846d[_0x5c8294(0x134)]==_0x3aca06[_0x5c8294(0x19e)]&&_0x14846d['expiry_date']==_0x3aca06[_0x5c8294(0x140)]&&_0x14846d[_0x5c8294(0x118)]==_0x3aca06['production_date']&&_0x14846d[_0x5c8294(0x1e4)]==_0x3aca06[_0x5c8294(0x1e4)]&&_0x14846d[_0x5c8294(0x188)]==_0x3aca06[_0x5c8294(0x16b)]&&(console[_0x5c8294(0x19c)](_0x5c8294(0x13a),_0x14846d[_0x5c8294(0x145)]),typeof _0x3aca06[_0x5c8294(0x156)]==_0x5c8294(0x159)?_0x14846d[_0x5c8294(0x145)]=Math[_0x5c8294(0x1cb)](0x0,Math[_0x5c8294(0x137)](_0x14846d[_0x5c8294(0x145)])-Math[_0x5c8294(0x137)](_0x3aca06[_0x5c8294(0x1df)])):_0x14846d[_0x5c8294(0x145)]=Math[_0x5c8294(0x1cb)](0x0,Math[_0x5c8294(0x137)](_0x14846d[_0x5c8294(0x145)])-Math[_0x5c8294(0x137)](_0x3aca06[_0x5c8294(0x1df)])));});}return _0x3b9139;});Promise[_0x1d1fa3(0x12f)](_0x513220)[_0x1d1fa3(0x13f)](async _0x4eb795=>{var _0x579b23=_0x1d1fa3;try{for(const _0x3f5b03 of _0x4eb795){await _0x3f5b03[_0x579b23(0x1d1)]();}const _0x4dbbf7=_0x36f197[_0x579b23(0x169)][_0x579b23(0x17a)](async _0x3807ee=>{var _0x3f1bc1=_0x579b23,_0x5bcb0b=await warehouse[_0x3f1bc1(0x1c1)]({'name':_0x1ccca3,'room':_0x3807ee[_0x3f1bc1(0x10e)]});if(_0x3807ee['to_quantity']>0x0){var _0x4c7637=0x0;const _0x4ff960=_0x5bcb0b[_0x3f1bc1(0x122)]['map'](_0x4e48b5=>{var _0xcc6611=_0x3f1bc1;_0x4e48b5[_0xcc6611(0x1b4)]==_0x3807ee[_0xcc6611(0x1b4)]&&_0x4e48b5['bay']==_0x3807ee[_0xcc6611(0x16a)]&&_0x4e48b5[_0xcc6611(0x140)]==_0x3807ee['expiry_date']&&_0x4e48b5[_0xcc6611(0x118)]==_0x3807ee[_0xcc6611(0x118)]&&_0x4e48b5[_0xcc6611(0x1e4)]==_0x3807ee['batch_code']&&_0x4e48b5['invoice']==_0x3807ee[_0xcc6611(0x157)]&&(typeof _0x3807ee[_0xcc6611(0x156)]==_0xcc6611(0x159)?(console[_0xcc6611(0x19c)](_0xcc6611(0x17c),_0x4e48b5[_0xcc6611(0x145)]+'\x20<>\x20'+_0x4e48b5[_0xcc6611(0x19d)]+'\x20<=>\x20'+Math[_0xcc6611(0x137)](_0x4e48b5[_0xcc6611(0x145)])+Math[_0xcc6611(0x137)](_0x3807ee[_0xcc6611(0x1df)])),_0x4e48b5[_0xcc6611(0x145)]=Math['abs'](_0x4e48b5[_0xcc6611(0x145)])+Math[_0xcc6611(0x137)](_0x3807ee[_0xcc6611(0x1df)])):_0x4e48b5[_0xcc6611(0x145)]=Math[_0xcc6611(0x137)](_0x4e48b5[_0xcc6611(0x145)])+Math['abs'](_0x3807ee[_0xcc6611(0x1df)]),_0x4c7637++);});_0x4c7637=='0'&&(_0x5bcb0b[_0x3f1bc1(0x122)]=_0x5bcb0b[_0x3f1bc1(0x122)][_0x3f1bc1(0x146)]({'product_name':_0x3807ee['product_name'],'product_stock':_0x3807ee[_0x3f1bc1(0x1df)],'bay':_0x3807ee[_0x3f1bc1(0x16a)],'product_code':_0x3807ee[_0x3f1bc1(0x180)],'primary_code':_0x3807ee[_0x3f1bc1(0x161)],'secondary_code':_0x3807ee['secondary_code'],'expiry_date':_0x3807ee[_0x3f1bc1(0x140)],'production_date':_0x3807ee[_0x3f1bc1(0x118)],'maxProducts':_0x3807ee[_0x3f1bc1(0x1be)],'batch_code':_0x3807ee[_0x3f1bc1(0x1e4)],'secondary_unit':_0x3807ee['secondary_unit'],'unit':_0x3807ee[_0x3f1bc1(0x191)],'maxProducts':_0x3807ee['maxProducts'],'maxPerUnit':_0x3807ee[_0x3f1bc1(0x18c)],'invoice':_0x3807ee['To_invoice']}));}return _0x5bcb0b;});Promise[_0x579b23(0x12f)](_0x4dbbf7)['then'](async _0x1b14c7=>{var _0x24f7e8=_0x579b23;try{for(const _0x532a59 of _0x1b14c7){await warehouse[_0x24f7e8(0x16f)]({'_id':_0x532a59[_0x24f7e8(0x19d)]},{'$addToSet':{'product_details':{'$each':_0x532a59['product_details']}}});}_0x36f197[_0x24f7e8(0x12a)]=_0x24f7e8(0x17f);const _0x1e27d3=await _0x36f197[_0x24f7e8(0x1d1)](),_0x595c43=await master_shop[_0x24f7e8(0x182)](),_0x114231=await email_settings['findOne'](),_0x3eba93=await supervisor_settings[_0x24f7e8(0x182)]();var _0x46f3f0=_0x36f197[_0x24f7e8(0x169)],_0x30bd18='',_0x3226a6;for(_0x3226a6 in _0x46f3f0){var _0x8b2244='FG';_0x36f197[_0x24f7e8(0x148)]=='DRY\x20GOODS'&&(_0x8b2244='DG'),_0x30bd18+='<tr>'+_0x24f7e8(0x1d7)+_0x46f3f0[_0x3226a6]['product_name']+_0x24f7e8(0x116)+_0x24f7e8(0x1d7)+_0x46f3f0[_0x3226a6][_0x24f7e8(0x180)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x46f3f0[_0x3226a6]['to_quantity']+_0x24f7e8(0x116)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x46f3f0[_0x3226a6][_0x24f7e8(0x191)]+'</td>'+_0x24f7e8(0x1d7)+_0x46f3f0[_0x3226a6][_0x24f7e8(0x158)]+_0x24f7e8(0x116)+_0x24f7e8(0x1d7)+_0x36f197[_0x24f7e8(0x148)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x46f3f0[_0x3226a6]['to_room_name']+'</td>'+_0x24f7e8(0x1d7)+_0x8b2244+_0x46f3f0[_0x3226a6][_0x24f7e8(0x16a)]+_0x24f7e8(0x116)+_0x24f7e8(0x10f);}let _0x2a644d=nodemailer['createTransport']({'host':_0x114231['host'],'port':Number(_0x114231[_0x24f7e8(0x126)]),'secure':![],'auth':{'user':_0x114231[_0x24f7e8(0x14b)],'pass':_0x114231[_0x24f7e8(0x1cd)]}}),_0x4b6af8={'from':_0x114231[_0x24f7e8(0x14b)],'to':_0x3eba93[0x0][_0x24f7e8(0x1b1)],'subject':_0x24f7e8(0x19f),'attachments':[{'filename':_0x24f7e8(0x1c9),'path':__dirname+_0x24f7e8(0x18e)+_0x24f7e8(0x132)+_0x595c43[0x0][_0x24f7e8(0x166)],'cid':_0x24f7e8(0x197)}],'html':_0x24f7e8(0x1aa)+'<html><head><title></title>'+'</head><body>'+_0x24f7e8(0x15b)+_0x24f7e8(0x1a0)+_0x24f7e8(0x15b)+_0x24f7e8(0x1cf)+_0x24f7e8(0x142)+_0x24f7e8(0x15b)+_0x24f7e8(0x1bf)+_0x595c43[0x0][_0x24f7e8(0x1a2)]+_0x24f7e8(0x1ad)+'</div>'+_0x24f7e8(0x142)+_0x24f7e8(0x1e5)+_0x24f7e8(0x15b)+_0x24f7e8(0x127)+_0x24f7e8(0x1d9)+_0x36f197['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+'\x20Order\x20Date\x20:\x20'+_0x36f197['date']+'\x20'+'</span>'+_0x24f7e8(0x15a)+_0x24f7e8(0x142)+_0x24f7e8(0x11d)+_0x24f7e8(0x167)+_0x24f7e8(0x198)+_0x24f7e8(0x11c)+_0x24f7e8(0x185)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x24f7e8(0x130)+_0x24f7e8(0x141)+_0x24f7e8(0x1ac)+_0x24f7e8(0x15f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x24f7e8(0x10f)+_0x24f7e8(0x12d)+_0x24f7e8(0x17b)+'\x20'+_0x30bd18+'\x20'+_0x24f7e8(0x162)+'</table>'+'<div>'+_0x24f7e8(0x120)+_0x24f7e8(0x14f)+_0x595c43[0x0][_0x24f7e8(0x1a2)]+'</h5>'+_0x24f7e8(0x142)+'</div>'+_0x24f7e8(0x10c)};_0x2a644d[_0x24f7e8(0x1ca)](_0x4b6af8,function(_0x1f4b57,_0x57edfe){var _0x12c5cf=_0x24f7e8;_0x1f4b57?(console['log'](_0x1f4b57),console['log'](_0x12c5cf(0x17d))):console[_0x12c5cf(0x19c)](_0x12c5cf(0x1b8));}),_0x1396cf[_0x24f7e8(0x13c)](_0x24f7e8(0x112),_0x24f7e8(0x129)),_0x5a34a0[_0x24f7e8(0x1b3)](_0x24f7e8(0x1b0)+_0x1e27d3[_0x24f7e8(0x19d)]);}catch(_0x6cd9b5){console[_0x24f7e8(0x1bc)](_0x6cd9b5),_0x5a34a0[_0x24f7e8(0x128)](0x1f4)['json']({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x579b23(0x11e)](_0x181705=>{var _0x17ac3d=_0x579b23;console['error'](_0x181705),_0x5a34a0[_0x17ac3d(0x128)](0x1f4)[_0x17ac3d(0x1cc)]({'error':_0x17ac3d(0x15e)});});}catch(_0x44bf8a){console[_0x579b23(0x1bc)](_0x44bf8a),_0x5a34a0[_0x579b23(0x128)](0x1f4)['json']({'error':_0x579b23(0x1e6)});}})[_0x1d1fa3(0x11e)](_0x28fddd=>{var _0x514883=_0x1d1fa3;console[_0x514883(0x1bc)](_0x28fddd),_0x5a34a0[_0x514883(0x128)](0x1f4)[_0x514883(0x1cc)]({'error':_0x514883(0x15e)});});}catch(_0x362c06){_0x5a34a0[_0x1d1fa3(0x1cc)]({'message':_0x362c06[_0x1d1fa3(0x183)]});}});function BayBinSelected(_0x44c76b,_0x27fd41){var _0x216d04=a0_0x3899a3,_0x1d281b=[];let _0x41cc72=[];var _0x18c387=[];if(_0x44c76b==_0x216d04(0x1bb)){switch(_0x27fd41){case _0x216d04(0x10b):_0x1d281b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x216d04(0x199):_0x1d281b=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x18c387=['DG'];}else{if(_0x44c76b=='FROZEN\x20GOODS'){switch(_0x27fd41){case _0x216d04(0x10b):_0x1d281b=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x1d281b=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x18c387=['FG'];}}return{'levels':_0x1d281b,'identify':_0x18c387};}router[a0_0x3899a3(0x1b7)](a0_0x3899a3(0x1ce),auth,async(_0x1861a8,_0xa7dc8)=>{var _0x28e935=a0_0x3899a3;try{const {username:_0x421b5b,email:_0x2dbac9,role:_0x339871}=_0x1861a8[_0x28e935(0x1e3)],_0x200436=_0x1861a8[_0x28e935(0x1e3)],_0x253714=await profile[_0x28e935(0x1c1)]({'email':_0x200436[_0x28e935(0x14b)]}),_0x1377d8=await master_shop['find'](),_0x48ee69=await transfers_finished[_0x28e935(0x160)](_0x1861a8['params']['id']);let _0xd02b38=new Date(_0x48ee69[_0x28e935(0x140)]),_0x5b97e3=('0'+_0xd02b38[_0x28e935(0x184)]())['slice'](-0x2),_0x468f17=('0'+(_0xd02b38[_0x28e935(0x15d)]()+0x1))[_0x28e935(0x177)](-0x2),_0x245b90=_0xd02b38['getFullYear'](),_0x187c29=_0x245b90+'-'+_0x468f17+'-'+_0x5b97e3,_0x20b282;if(_0x200436[_0x28e935(0x18f)]==_0x28e935(0x1d6)){const _0x115e46=await staff['findOne']({'email':_0x200436['email']});_0x20b282=await warehouse['find']({'status':'Enabled','name':_0x115e46['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x20b282=await warehouse[_0x28e935(0x182)]({'status':_0x28e935(0x125),'warehouse_category':_0x28e935(0x1c8)});const _0x1ea529=await warehouse['aggregate']([{'$match':{'name':_0x48ee69[_0x28e935(0x119)],'room':_0x48ee69[_0x28e935(0x170)]}},{'$unwind':_0x28e935(0x1d0)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x28e935(0x173)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x28e935(0x18b)},'bin':{'$first':_0x28e935(0x1de)},'type':{'$first':_0x28e935(0x181)},'floorlevel':{'$first':_0x28e935(0x190)},'primary_code':{'$first':_0x28e935(0x14d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x28e935(0x11f)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x28e935(0x1db)}}}]);var _0x4c1e07=[0x1,0x2,0x3,0x4],_0x3aba43=['A','B','C','D','E','F','G','H','I','J'],_0x504b22=[_0x28e935(0x13d),_0x28e935(0x143)];const _0x557299=await product[_0x28e935(0x182)]({}),_0x99fac=BayBinSelected(_0x48ee69[_0x28e935(0x148)],_0x48ee69['to_room']);if(_0x1377d8[0x0][_0x28e935(0x1e1)]=='English\x20(US)'){var _0x36c008=users[_0x28e935(0x1c4)];console[_0x28e935(0x19c)](_0x36c008);}else{if(_0x1377d8[0x0][_0x28e935(0x1e1)]==_0x28e935(0x1a5))var _0x36c008=users[_0x28e935(0x1a5)];else{if(_0x1377d8[0x0][_0x28e935(0x1e1)]=='German')var _0x36c008=users[_0x28e935(0x1e7)];else{if(_0x1377d8[0x0][_0x28e935(0x1e1)]==_0x28e935(0x1ae))var _0x36c008=users[_0x28e935(0x1ae)];else{if(_0x1377d8[0x0][_0x28e935(0x1e1)]==_0x28e935(0x12b))var _0x36c008=users[_0x28e935(0x12b)];else{if(_0x1377d8[0x0][_0x28e935(0x1e1)]==_0x28e935(0x1a8))var _0x36c008=users['Portuguese'];else{if(_0x1377d8[0x0]['language']=='Chinese')var _0x36c008=users[_0x28e935(0x133)];else{if(_0x1377d8[0x0]['language']==_0x28e935(0x1ab))var _0x36c008=users[_0x28e935(0x192)];}}}}}}}_0xa7dc8[_0x28e935(0x136)](_0x28e935(0x13e),{'success':_0x1861a8[_0x28e935(0x13c)](_0x28e935(0x112)),'errors':_0x1861a8[_0x28e935(0x13c)](_0x28e935(0x171)),'role':_0x200436,'profile':_0x253714,'master_shop':_0x1377d8,'warehouse':_0x20b282,'transfer':_0x48ee69,'stock':_0x1ea529,'unit':_0x557299,'language':_0x36c008,'levels':_0x4c1e07,'Isle':_0x3aba43,'rooms_data':_0x504b22,'ed_fullDate':_0x187c29,'dataSelected':_0x99fac});}catch(_0x4f642c){console['log'](_0x4f642c);}}),router[a0_0x3899a3(0x165)]('/view/:id',auth,async(_0x280e8c,_0x255729)=>{var _0x2bd7cc=a0_0x3899a3;try{const _0x2d6b89=_0x280e8c['params']['id'];console['log'](_0x280e8c['body']);const _0xc0de26=await transfers_finished[_0x2bd7cc(0x160)](_0x2d6b89);console[_0x2bd7cc(0x19c)]('transfer_data',_0xc0de26);const {date:_0x13fea6,from_warehouse:_0x550ba6,FromRoom_name:_0x41490b,to_warehouse:_0x3acbb1,ToRoom_name:_0x447dfd,prod_name:_0x30f1a2,from_prod_qty:_0x17f998,from_prod_level:_0x531999,from_prod_isle:_0x492192,from_prod_pallet:_0x55c352,to_prod_qty:_0x2fc55e,to_prod_level:_0x41deb2,to_prod_isle:_0x5398ca,to_prod_pallet:_0x5b0e44,primary_code:_0x132c5f,secondary_code:_0x4f21b4,product_code3:_0x241ab9,note:_0xeaf4bc,invoice:_0x13c9d7,expiry_date:_0x3bc6ab}=_0x280e8c[_0x2bd7cc(0x1af)];if(typeof _0x30f1a2==_0x2bd7cc(0x16d))var _0x364c5=[_0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x153)]],_0x445071=[_0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x17e)]],_0x17784a=[_0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x10d)]],_0x1262e2=[_0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x1c5)]],_0x12e4a0=[_0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x163)]],_0x2b8259=[_0x280e8c['body'][_0x2bd7cc(0x161)]],_0x43e0f6=[_0x280e8c[_0x2bd7cc(0x1af)]['secondary_code']],_0x44aa8f=[_0x280e8c[_0x2bd7cc(0x1af)]['product_code3']],_0x38c2f6=[_0x280e8c['body']['MaxStocks_data2']],_0x232ea6=[_0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x191)]],_0x306c22=[_0x280e8c[_0x2bd7cc(0x1af)]['secondary_unit']],_0x3f56f0=[_0x280e8c[_0x2bd7cc(0x1af)]['batch_code']],_0x3dcf37=[_0x280e8c[_0x2bd7cc(0x1af)]['expiry_date']];else var _0x364c5=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x153)]],_0x445071=[..._0x280e8c['body'][_0x2bd7cc(0x17e)]],_0x17784a=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x10d)]],_0x1262e2=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x1c5)]],_0x12e4a0=[..._0x280e8c['body'][_0x2bd7cc(0x163)]],_0x2b8259=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x161)]],_0x43e0f6=[..._0x280e8c['body'][_0x2bd7cc(0x1e2)]],_0x44aa8f=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x18d)]],_0x38c2f6=[..._0x280e8c['body'][_0x2bd7cc(0x13b)]],_0x232ea6=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x191)]],_0x306c22=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x158)]],_0x3f56f0=[..._0x280e8c[_0x2bd7cc(0x1af)]['batch_code']],_0x3dcf37=[..._0x280e8c[_0x2bd7cc(0x1af)][_0x2bd7cc(0x140)]];const _0x549bf5=_0x364c5[_0x2bd7cc(0x17a)](_0x3a8339=>{return _0x3a8339={'product_name':_0x3a8339};});_0x445071['forEach']((_0xfdbe15,_0x2ffb76)=>{var _0x428636=_0x2bd7cc;_0x549bf5[_0x2ffb76][_0x428636(0x151)]=_0xfdbe15;}),_0x17784a[_0x2bd7cc(0x1a4)]((_0x35d3cb,_0x5e0537)=>{var _0x595d93=_0x2bd7cc;_0x549bf5[_0x5e0537][_0x595d93(0x19e)]=_0x35d3cb;}),_0x1262e2[_0x2bd7cc(0x1a4)]((_0x5a00f8,_0x299f30)=>{_0x549bf5[_0x299f30]['to_quantity']=_0x5a00f8;}),_0x12e4a0[_0x2bd7cc(0x1a4)]((_0x2f88bd,_0x129bd6)=>{_0x549bf5[_0x129bd6]['to_bay']=_0x2f88bd;}),_0x2b8259[_0x2bd7cc(0x1a4)]((_0x2afef9,_0x5e60d2)=>{_0x549bf5[_0x5e60d2]['primary_code']=_0x2afef9;}),_0x43e0f6[_0x2bd7cc(0x1a4)]((_0x81ac62,_0x43b9a6)=>{var _0x4b4e36=_0x2bd7cc;_0x549bf5[_0x43b9a6][_0x4b4e36(0x1e2)]=_0x81ac62;}),_0x44aa8f['forEach']((_0x43f7ca,_0x2c4a71)=>{var _0x4db16a=_0x2bd7cc;_0x549bf5[_0x2c4a71][_0x4db16a(0x180)]=_0x43f7ca;}),_0x38c2f6[_0x2bd7cc(0x1a4)]((_0x5e2bf2,_0x5f25cb)=>{var _0x2b6a37=_0x2bd7cc;_0x549bf5[_0x5f25cb][_0x2b6a37(0x1be)]=_0x5e2bf2;}),_0x232ea6['forEach']((_0x454ab5,_0x3668de)=>{var _0x22511d=_0x2bd7cc;_0x549bf5[_0x3668de][_0x22511d(0x191)]=_0x454ab5;}),_0x306c22[_0x2bd7cc(0x1a4)]((_0x466c54,_0x5a922a)=>{var _0x17bae1=_0x2bd7cc;_0x549bf5[_0x5a922a][_0x17bae1(0x158)]=_0x466c54;}),_0x3f56f0[_0x2bd7cc(0x1a4)]((_0x17e784,_0x338aca)=>{_0x549bf5[_0x338aca]['batch_code']=_0x17e784;}),_0x3dcf37[_0x2bd7cc(0x1a4)]((_0x495246,_0x15428e)=>{var _0x6e95=_0x2bd7cc;_0x549bf5[_0x15428e][_0x6e95(0x140)]=_0x495246;});const _0x4c9ffa=_0x549bf5[_0x2bd7cc(0x16c)](_0x2de7ee=>_0x2de7ee[_0x2bd7cc(0x1df)]!=='0'&&_0x2de7ee[_0x2bd7cc(0x1df)]!==''||_0x2de7ee['to_floorlevel']!=='0'&&_0x2de7ee[_0x2bd7cc(0x16e)]!=='');var _0x205731=0x0;_0x4c9ffa[_0x2bd7cc(0x1a4)](_0x399024=>{var _0x2cf39f=_0x2bd7cc;parseInt(_0x399024[_0x2cf39f(0x151)])<parseInt(_0x399024[_0x2cf39f(0x1df)])&&_0x205731++;});if(_0x205731!=0x0)return _0x280e8c[_0x2bd7cc(0x13c)](_0x2bd7cc(0x171),_0x2bd7cc(0x111)),_0x255729[_0x2bd7cc(0x1b3)]('back');const _0x4d1a6a=await warehouse[_0x2bd7cc(0x1c1)]({'name':_0xc0de26[_0x2bd7cc(0x119)],'room':_0xc0de26[_0x2bd7cc(0x170)]});_0xc0de26[_0x2bd7cc(0x169)][_0x2bd7cc(0x1a4)](_0x329c62=>{if(_0x329c62['to_quantity']>0x0){const _0x264e6d=_0x4d1a6a['product_details']['map'](_0x479580=>{var _0x5f0a86=a0_0x2363;_0x479580['product_name']==_0x329c62[_0x5f0a86(0x1b4)]&&_0x479580[_0x5f0a86(0x134)]==_0x329c62[_0x5f0a86(0x19e)]&&(_0x479580['product_stock']=parseInt(_0x479580[_0x5f0a86(0x145)])+parseInt(_0x329c62[_0x5f0a86(0x1df)]));});}}),await _0x4d1a6a[_0x2bd7cc(0x1d1)]();const _0x5e07c0=await warehouse[_0x2bd7cc(0x1c1)]({'name':_0xc0de26[_0x2bd7cc(0x148)],'room':_0xc0de26['to_room']});_0xc0de26[_0x2bd7cc(0x169)]['forEach'](_0x57cd80=>{var _0x31d765=_0x2bd7cc;if(_0x57cd80[_0x31d765(0x1df)]>0x0){const _0x2f6972=_0x5e07c0['product_details'][_0x31d765(0x17a)](_0x33e758=>{var _0x37ad9a=_0x31d765;_0x33e758['product_name']==_0x57cd80['product_name']&&_0x33e758[_0x37ad9a(0x134)]==_0x57cd80[_0x37ad9a(0x16a)]&&(_0x33e758[_0x37ad9a(0x145)]=parseInt(_0x33e758[_0x37ad9a(0x145)])-parseInt(_0x57cd80[_0x37ad9a(0x1df)]));});}}),await _0x5e07c0['save'](),_0xc0de26['date']=_0x13fea6,_0xc0de26[_0x2bd7cc(0x119)]=_0x550ba6,_0xc0de26[_0x2bd7cc(0x148)]=_0x3acbb1,_0xc0de26['product']=_0x4c9ffa,_0xc0de26[_0x2bd7cc(0x144)]=_0xeaf4bc,_0xc0de26[_0x2bd7cc(0x188)]=_0x13c9d7;const _0x318147=await _0xc0de26[_0x2bd7cc(0x1d1)](),_0x3d15b7=await warehouse[_0x2bd7cc(0x1c1)]({'name':_0x550ba6,'room':_0x41490b});_0x318147[_0x2bd7cc(0x169)][_0x2bd7cc(0x1a4)](_0x512aa3=>{var _0x2387bb=_0x2bd7cc;if(_0x512aa3[_0x2387bb(0x1df)]>0x0){const _0x1ba5f4=_0x3d15b7[_0x2387bb(0x122)][_0x2387bb(0x17a)](_0x24f72c=>{var _0x405d0c=_0x2387bb;_0x24f72c[_0x405d0c(0x1b4)]==_0x512aa3[_0x405d0c(0x1b4)]&&_0x24f72c[_0x405d0c(0x134)]==_0x512aa3['from_bay']&&(_0x24f72c[_0x405d0c(0x145)]=parseInt(_0x24f72c[_0x405d0c(0x145)])-parseInt(_0x512aa3['to_quantity']));});}}),await _0x3d15b7[_0x2bd7cc(0x1d1)]();const _0x54a5c7=await warehouse['findOne']({'name':_0x3acbb1,'room':_0x447dfd});_0x318147[_0x2bd7cc(0x169)][_0x2bd7cc(0x1a4)](_0x3585a1=>{var _0x31eff6=_0x2bd7cc;if(_0x3585a1[_0x31eff6(0x1df)]>0x0){var _0x234392=0x0;const _0x5c7e12=_0x54a5c7[_0x31eff6(0x122)][_0x31eff6(0x17a)](_0x3d2686=>{var _0x5ab6b1=_0x31eff6;_0x3d2686[_0x5ab6b1(0x1b4)]==_0x3585a1['product_name']&&_0x3d2686[_0x5ab6b1(0x134)]==_0x3585a1['to_bay']&&(_0x3d2686[_0x5ab6b1(0x145)]=parseInt(_0x3d2686[_0x5ab6b1(0x145)])+parseInt(_0x3585a1[_0x5ab6b1(0x1df)]),_0x234392++);});_0x234392=='0'&&(_0x54a5c7[_0x31eff6(0x122)]=_0x54a5c7[_0x31eff6(0x122)][_0x31eff6(0x146)]({'product_name':_0x3585a1['product_name'],'product_stock':_0x3585a1[_0x31eff6(0x1df)],'bay':_0x3585a1[_0x31eff6(0x16a)],'product_code':_0x3585a1['product_code'],'primary_code':_0x3585a1[_0x31eff6(0x161)],'secondary_code':_0x3585a1[_0x31eff6(0x1e2)],'maxProducts':_0x3585a1[_0x31eff6(0x1be)]}));}}),await _0x54a5c7['save'](),_0x280e8c[_0x2bd7cc(0x13c)](_0x2bd7cc(0x112),_0x2bd7cc(0x154)),_0x255729[_0x2bd7cc(0x1b3)]('/transfer_finished/view');}catch(_0x30c8da){console[_0x2bd7cc(0x19c)](_0x30c8da);}}),router['post'](a0_0x3899a3(0x1a6),async(_0x1244ec,_0x1b6479)=>{var _0x331542=a0_0x3899a3;const {FromWareHouse:_0x3be607,FromRoom:_0x2bcc0c,ToWarehouse:_0x299706,ToRoom:_0x41cd58,primary_code:_0x319ba3,Roomslist:_0x4bac9e}=_0x1244ec[_0x331542(0x1af)],_0x38bc38=_0x4bac9e['split'](','),_0x24f5d1=[];async function _0xe644b5(_0xcd6508){var _0xf4ddce=_0x331542;const _0x5baf6d=await warehouse[_0xf4ddce(0x152)]([{'$match':{'name':_0x3be607,'room':_0xcd6508}},{'$unwind':_0xf4ddce(0x1d0)},{'$match':{'product_details.primary_code':_0x319ba3}},{'$group':{'_id':_0xf4ddce(0x178),'name':{'$first':_0xf4ddce(0x173)},'instock':{'$first':_0xf4ddce(0x113)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xf4ddce(0x1b2)},'product_code':{'$first':_0xf4ddce(0x11f)},'level':{'$first':_0xf4ddce(0x18b)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0xf4ddce(0x181)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0xf4ddce(0x175)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0xf4ddce(0x1db)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0xf4ddce(0x168)},'batch_code':{'$first':_0xf4ddce(0x135)},'maxPerUnit':{'$first':_0xf4ddce(0x139)},'roomNamed':{'$first':_0xf4ddce(0x138)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0xf4ddce(0x176)}}}]),_0x4197ee=await warehouse[_0xf4ddce(0x152)]([{'$match':{'name':_0x3be607,'room':_0xcd6508}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x319ba3}},{'$group':{'_id':_0xf4ddce(0x178),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0xf4ddce(0x113)},'primary_code':{'$first':_0xf4ddce(0x14d)},'secondary_code':{'$first':_0xf4ddce(0x1b2)},'product_code':{'$first':_0xf4ddce(0x11f)},'level':{'$first':_0xf4ddce(0x18b)},'isle':{'$first':_0xf4ddce(0x1de)},'type':{'$first':_0xf4ddce(0x181)},'pallet':{'$first':_0xf4ddce(0x190)},'unit':{'$first':_0xf4ddce(0x11a)},'secondary_unit':{'$first':_0xf4ddce(0x175)},'storage':{'$first':_0xf4ddce(0x1a1)},'rack':{'$first':_0xf4ddce(0x1db)},'expiry_date':{'$first':_0xf4ddce(0x11b)},'production_date':{'$first':_0xf4ddce(0x168)},'batch_code':{'$first':_0xf4ddce(0x135)},'maxPerUnit':{'$first':_0xf4ddce(0x139)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'invoice':{'$first':_0xf4ddce(0x176)}}}]);if(_0x5baf6d['length']>0x0)_0x24f5d1[_0xf4ddce(0x1a7)](_0x5baf6d);else _0x4197ee[_0xf4ddce(0x1da)]>0x0&&_0x24f5d1[_0xf4ddce(0x1a7)](_0x4197ee);}const _0x25c9ab=_0x38bc38[_0x331542(0x17a)](_0x15b9ab=>_0xe644b5(_0x15b9ab));await Promise[_0x331542(0x12f)](_0x25c9ab),_0x1b6479[_0x331542(0x1cc)](_0x24f5d1);}),router[a0_0x3899a3(0x165)]('/barcode_scanner2',async(_0x3b60c1,_0x45815a)=>{var _0x2bf896=a0_0x3899a3;try{const {FromWareHouse:_0x144acb,FromRoom:_0x41238e,ToWarehouse:_0xaca7e7,ToRoom:_0x3ee3a1,secondary_code:_0x25f6b5}=_0x3b60c1['body'],_0x2e7832=await warehouse[_0x2bf896(0x152)]([{'$match':{'name':_0x144acb}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x25f6b5}},{'$group':{'_id':_0x2bf896(0x178),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x2bf896(0x14d)},'secondary_code':{'$first':_0x2bf896(0x1b2)},'product_code':{'$first':_0x2bf896(0x11f)},'instock':{'$first':_0x2bf896(0x113)},'warehouse':{'$first':'$name'},'level':{'$first':_0x2bf896(0x14a)},'isle':{'$first':_0x2bf896(0x114)},'pallet':{'$first':_0x2bf896(0x195)},'maxProducts':{'$first':_0x2bf896(0x1bd)},'unit':{'$first':_0x2bf896(0x11a)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2bf896(0x168)}}}]);_0x45815a[_0x2bf896(0x128)](0xc8)[_0x2bf896(0x1cc)](_0x2e7832);}catch(_0x557d76){_0x45815a['status'](0x194)[_0x2bf896(0x1cc)]({'message':_0x557d76[_0x2bf896(0x183)]});}}),router[a0_0x3899a3(0x165)](a0_0x3899a3(0x19b),async(_0x16b8dc,_0x3cbf16)=>{var _0x575728=a0_0x3899a3;try{const {FromWareHouse:_0x44e835,FromRoom:_0x5db473,ToWarehouse:_0x3d8e76,ToRoom:_0x24ae55,product_code:_0x3ce90c}=_0x16b8dc[_0x575728(0x1af)],_0x9dc95a=await warehouse['aggregate']([{'$match':{'name':_0x44e835}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x3ce90c}},{'$group':{'_id':_0x575728(0x178),'name':{'$first':_0x575728(0x173)},'primary_code':{'$first':_0x575728(0x14d)},'secondary_code':{'$first':_0x575728(0x1b2)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x575728(0x113)},'warehouse':{'$first':_0x575728(0x1b5)},'level':{'$first':_0x575728(0x14a)},'isle':{'$first':_0x575728(0x114)},'pallet':{'$first':_0x575728(0x195)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x575728(0x11a)}}}]);_0x3cbf16[_0x575728(0x128)](0xc8)[_0x575728(0x1cc)](_0x9dc95a);}catch(_0x5e92f1){_0x3cbf16[_0x575728(0x128)](0x194)[_0x575728(0x1cc)]({'message':_0x5e92f1[_0x575728(0x183)]});}}),router[a0_0x3899a3(0x165)](a0_0x3899a3(0x172),async(_0x19faaa,_0xfe9d8)=>{var _0x3c5a72=a0_0x3899a3;const {productCode:_0x8b243a,bay:_0x5bb3dd,warehouses:_0x1a3ba8,room:_0xedc336}=_0x19faaa[_0x3c5a72(0x1af)];console[_0x3c5a72(0x19c)](_0x19faaa[_0x3c5a72(0x1af)]);try{const _0x456f40=await warehouse[_0x3c5a72(0x152)]([{'$match':{'name':_0x1a3ba8,'room':_0xedc336}},{'$unwind':_0x3c5a72(0x1d0)},{'$match':{'product_details.bay':parseInt(_0x5bb3dd)}},{'$group':{'_id':_0x3c5a72(0x178),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3c5a72(0x113)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0xfe9d8[_0x3c5a72(0x128)](0xc8)[_0x3c5a72(0x1cc)](_0x456f40);}catch(_0x2f7901){_0xfe9d8[_0x3c5a72(0x128)](0x194)[_0x3c5a72(0x1cc)]({'message':_0x2f7901['message']});}}),module[a0_0x3899a3(0x147)]=router;function a0_0x4869(){var _0x3f095f=['<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','random','/upload/','Chinese','bay','$product_details.batch_code','render','abs','$room','$product_details.maxPerUnit','here1','MaxStocks_data2','flash','Ambient','edit_transfer_finished','then','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','</div>','Enclosed','note','product_stock','concat','exports','to_warehouse','express','$product_details.level','email','272260vodHaw','$product_details.primary_code','/preview/:id','<h5>','$finalize','from_quantity','aggregate','prod_name','Transfer\x20Edit\x20Successfully','prod_cat','id_transaction','To_invoice','secondary_unit','undefined','</h5>','<div>','$invoice','getMonth','An\x20error\x20occurred.','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','findById','primary_code','</tbody>','to_prod_level','New_Qty_Converted','post','image','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.production_date','product','to_bay','from_invoice','filter','string','to_floorlevel','updateOne','from_room','errors','/CheckingWarehouse','$product_details.product_name','1035CKRpyF','$product_details.secondary_unit','$product_details.invoice','slice','$product_details._id','transfer_finished','map','<tbody\x20style=\x22text-align:\x20center;\x22>','here2','Error\x20Occurs','from_prod_qty','True','product_code','$product_details.type','find','message','getDate','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','Router','primary_unit','invoice','Portuguese','edit_transfer_finished_view','$product_details.bay','maxPerUnit','product_code3','/../public','role','$product_details.floorlevel','unit','Arabic','product_date','1057sMSKNc','$product_details.pallet','There\x27s\x20a\x20error\x20in\x20this\x20transaction','logo','<tr>','Rack\x202','/view','/barcode_scanner3','log','_id','from_bay','Transfer\x20Mail','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.storage','site_title','MaxStocks_data','forEach','Hindi','/barcode_scanner','push','Portuguese\x20(BR)','762440IeqcPj','<!DOCTYPE\x20html>','Arabic\x20(ae)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','\x20</h2>','Spanish','body','/picking_list/PDF_transfer/','FGSEmail','$product_details.secondary_code','redirect','product_name','$name','RoomAssigned','get','Email\x20sent\x20successfully','to_invoice','2097850zcrxcQ','DRY\x20GOODS','error','$product_details.maxProducts','maxProducts','<h2>\x20','9503680XWqcbE','findOne','$product.to_room_name','/transfer/view','English','to_prod_qty','params','12810wOaxpq','Finished\x20Goods','Logo.png','sendMail','max','json','password','/view/:id','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details','save','$product.from_room_name','ToRoomAssigned','back','English\x20(US)','staff','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','/view/add_transfer','\x20Order\x20Number\x20:\x20','length','$product_details.rack','from_room_name','1048108gODtJc','$product_details.bin','to_quantity','TRFF-','language','secondary_code','user','batch_code','<hr\x20class=\x22my-3\x22>','An\x20error\x20occurred\x20while\x20saving\x20data.','German','Rack\x201','</body></html>','from_prod_level','to_room_name','</tr>','add_transfer_finished','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','success','$product_details.product_stock','$product_details.isle','QA\x20Warehouse','</td>','Product\x20Transfer\x20successfully','production_date','from_warehouse','$product_details.unit','$product_details.expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','catch','$product_details.product_code','<strong>\x20Regards\x20</strong>','3198212PJuPtm','product_details','$to_warehouse','/transfer_finished/preview/','Enabled','port','<h5\x20style=\x22text-align:\x20left;\x22>','status','Transfer\x20Finalize\x20Successfully','finalize','French','3zPufKF','</thead>','warehouse','all'];a0_0x4869=function(){return _0x3f095f;};return a0_0x4869();}