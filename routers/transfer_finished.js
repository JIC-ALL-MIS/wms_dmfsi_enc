function a0_0x3fc1(){var _0x439c62=['$product_details.level','3295347KBkpIV','to_prod_level','Finished\x20Goods','product_code','primary_code','1306050SELqEt','Email\x20sent\x20successfully','product_code3','message','/picking_list/PDF_transfer/','logo','prod_cat','Logo.png','port','ToRoomAssigned','to_warehouse','QA\x20Warehouse','Transfer\x20Mail','German','New_Qty_Converted','Spanish','FGSEmail','transfer_data','forEach','user','floor','$product.from_room_name','$product_details.product_code','$product_details.floorlevel','True','$product_details.production_date','1228498lHiSMz','get','</tr>','10LfRfUG','body','</h5>','success','$to_warehouse','Portuguese\x20(BR)','$product_details','secondary_unit','461019VuxdCp','</table>','$date','Hindi','save','product_date','concat','production_date','$product_details.product_name','unit','$product_details.bay','exports','getMonth','prod_name','</thead>','$product_details.secondary_unit','$product_details.bin','TRFF-','RoomAssigned','<tr>','back','nodemailer','product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.maxPerUnit','from_prod_qty','$_id','49578tVJCqq','MaxStocks_data2','<h2>\x20','<div>','/preview/:id','$product_details.maxProducts','padStart','/transfer_finished/preview/','50248wLzHxa','updateOne','batch_code','from_quantity','MaxStocks_data','\x20Order\x20Date\x20:\x20','all','../models/all_models','role','findById','language','$product_details.isle','Enabled','$product_details.unit','then','<strong>\x20Regards\x20</strong>','expiry_date','post','$room','/view/add_transfer','maxProducts','$product_details.batch_code','English\x20(US)','2248lXnbRk','An\x20error\x20occurred\x20while\x20saving\x20data.','/CheckingWarehouse','filter','There\x27s\x20a\x20error\x20in\x20this\x20transaction','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','redirect','$invoice','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','125ZuWPen','host','status','$product','$product_details.product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','$product_details.type','flash','staff','Portuguese','$product_details.pallet','product','aggregate','push','map','$product_details.expiry_date','string','to_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','maxPerUnit','from_room_name','render','log','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','</span>','</div>','English','Rack\x202','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','bay','/barcode_scanner3','product_stock','/barcode_scanner','43164LZpvDq','edit_transfer_finished_view','json','toString','Arabic','French','to_room','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','email','product_details','to_floorlevel','_id','DRY\x20GOODS','<tbody\x20style=\x22text-align:\x20center;\x22>','An\x20error\x20occurred.','findOne','$product_details.secondary_code','from_bay','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','getDate','/../public','site_title','/view','to_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','To_invoice','add_transfer_finished','from_room','length','to_invoice','to_room_name','primary_unit','date','$finalize','<h5\x20style=\x22text-align:\x20left;\x22>','errors','/view/:id','from_prod_level','$product_details._id','params','Transfer\x20Finalize\x20Successfully','$product_details.invoice','$product_details.rack','to_prod_qty','getFullYear','invoice','\x20</h2>','find','slice','$product_details.storage','</tbody>','Arabic\x20(ae)','from_invoice','Chinese','FROZEN\x20GOODS','Ambient','catch','error','transfer_finished','70ncDmrX','warehouse','secondary_code','$name','Rack\x201','</td>','from_warehouse','$product_details.primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','</body></html>'];a0_0x3fc1=function(){return _0x439c62;};return a0_0x3fc1();}var a0_0x469054=a0_0x189e;(function(_0x25ce97,_0x2e255d){var _0x13d056=a0_0x189e,_0x3f1280=_0x25ce97();while(!![]){try{var _0x10ef11=parseInt(_0x13d056(0x184))/0x1+-parseInt(_0x13d056(0x24e))/0x2+-parseInt(_0x13d056(0x234))/0x3+-parseInt(_0x13d056(0x1a7))/0x4*(parseInt(_0x13d056(0x1c7))/0x5)+-parseInt(_0x13d056(0x19f))/0x6*(-parseInt(_0x13d056(0x224))/0x7)+-parseInt(_0x13d056(0x1be))/0x8*(-parseInt(_0x13d056(0x1e9))/0x9)+-parseInt(_0x13d056(0x251))/0xa*(-parseInt(_0x13d056(0x22f))/0xb);if(_0x10ef11===_0x2e255d)break;else _0x3f1280['push'](_0x3f1280['shift']());}catch(_0x586b1e){_0x3f1280['push'](_0x3f1280['shift']());}}}(a0_0x3fc1,0xc9f75));const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x469054(0x1ae)),auth=require('../middleware/auth'),users=require('../public/language/languages.json'),nodemailer=require(a0_0x469054(0x199));router[a0_0x469054(0x24f)](a0_0x469054(0x1ff),auth,async(_0x471411,_0xe01418)=>{var _0x4739f0=a0_0x469054;try{const {username:_0x3db95e,email:_0x2e24a8,role:_0x1f3a51}=_0x471411['user'],_0x5d8e48=_0x471411[_0x4739f0(0x247)],_0x100be7=await profile[_0x4739f0(0x1f8)]({'email':_0x5d8e48[_0x4739f0(0x1f1)]}),_0x2072fd=await master_shop[_0x4739f0(0x218)]();let _0x33e7d1;if(_0x5d8e48[_0x4739f0(0x1af)]==_0x4739f0(0x1cf)){const _0x3a96fa=await staff[_0x4739f0(0x1f8)]({'email':_0x5d8e48['email']});_0x33e7d1=await transfers_finished[_0x4739f0(0x218)]({'from_warehouse':_0x3a96fa['warehouse']});}else _0x33e7d1=await transfers_finished['aggregate']([{'$unwind':_0x4739f0(0x1ca)},{'$group':{'_id':_0x4739f0(0x19e),'invoice':{'$first':_0x4739f0(0x1c5)},'date':{'$first':_0x4739f0(0x186)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x4739f0(0x180)},'from_room_name':{'$addToSet':_0x4739f0(0x249)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x4739f0(0x20a)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2072fd[0x0][_0x4739f0(0x1b1)]==_0x4739f0(0x1bd))var _0x57152c=users[_0x4739f0(0x1e1)];else{if(_0x2072fd[0x0][_0x4739f0(0x1b1)]==_0x4739f0(0x187))var _0x57152c=users['Hindi'];else{if(_0x2072fd[0x0][_0x4739f0(0x1b1)]=='German')var _0x57152c=users[_0x4739f0(0x241)];else{if(_0x2072fd[0x0][_0x4739f0(0x1b1)]==_0x4739f0(0x243))var _0x57152c=users[_0x4739f0(0x243)];else{if(_0x2072fd[0x0][_0x4739f0(0x1b1)]==_0x4739f0(0x1ee))var _0x57152c=users[_0x4739f0(0x1ee)];else{if(_0x2072fd[0x0][_0x4739f0(0x1b1)]==_0x4739f0(0x181))var _0x57152c=users[_0x4739f0(0x1d0)];else{if(_0x2072fd[0x0][_0x4739f0(0x1b1)]=='Chinese')var _0x57152c=users[_0x4739f0(0x21e)];else{if(_0x2072fd[0x0][_0x4739f0(0x1b1)]==_0x4739f0(0x21c))var _0x57152c=users[_0x4739f0(0x1ed)];}}}}}}}_0xe01418[_0x4739f0(0x1dc)](_0x4739f0(0x223),{'success':_0x471411[_0x4739f0(0x1ce)]('success'),'errors':_0x471411[_0x4739f0(0x1ce)](_0x4739f0(0x20c)),'role':_0x5d8e48,'profile':_0x100be7,'master_shop':_0x2072fd,'transfer':_0x33e7d1,'language':_0x57152c});}catch(_0x26d463){console[_0x4739f0(0x1dd)](_0x26d463);}});async function getRandom8DigitNumber(){var _0x1791d0=a0_0x469054;const _0x511b17=0x989680,_0x42b549=0x5f5e0ff,_0x506484=Math[_0x1791d0(0x248)](Math['random']()*(_0x42b549-_0x511b17+0x1))+_0x511b17;var _0x2a8de2;const _0x596445=await transfers_finished['findOne']({'invoice':_0x1791d0(0x195)+_0x506484});return _0x596445&&_0x596445[_0x1791d0(0x205)]>0x0?_0x2a8de2=_0x1791d0(0x195)+_0x506484:_0x2a8de2='TRFF-'+_0x506484,_0x2a8de2;}function a0_0x189e(_0x22b237,_0x4633be){var _0x3fc12f=a0_0x3fc1();return a0_0x189e=function(_0x189e95,_0x368777){_0x189e95=_0x189e95-0x17e;var _0x5d8e77=_0x3fc12f[_0x189e95];return _0x5d8e77;},a0_0x189e(_0x22b237,_0x4633be);}router[a0_0x469054(0x24f)](a0_0x469054(0x1ba),auth,async(_0x3a5d82,_0x33988b)=>{var _0xccecc9=a0_0x469054;try{const {username:_0x1a1d59,email:_0x14a416,role:_0x1015f1}=_0x3a5d82[_0xccecc9(0x247)],_0x913a72=_0x3a5d82[_0xccecc9(0x247)],_0x307efe=await profile['findOne']({'email':_0x913a72['email']}),_0x391aa3=await master_shop[_0xccecc9(0x218)]();let _0x39a8bc;if(_0x913a72[_0xccecc9(0x1af)]==_0xccecc9(0x1cf)){const _0x11074d=await staff['findOne']({'email':_0x913a72[_0xccecc9(0x1f1)]});_0x39a8bc=await warehouse[_0xccecc9(0x1d3)]([{'$match':{'status':_0xccecc9(0x1b3),'name':_0x11074d['warehouse'],'warehouse_category':_0xccecc9(0x231),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0xccecc9(0x227),'name':{'$first':'$name'}}}]);}else _0x39a8bc=await warehouse[_0xccecc9(0x1d3)]([{'$match':{'status':_0xccecc9(0x1b3),'warehouse_category':_0xccecc9(0x231),'name':{'$ne':_0xccecc9(0x23f)}}},{'$group':{'_id':_0xccecc9(0x227),'name':{'$first':_0xccecc9(0x227)}}}]);const _0x1d9630=await transfers_finished['find']({}),_0x22e62a=_0x1d9630[_0xccecc9(0x205)]+0x1,_0x27e63a='TRFF-'+_0x22e62a[_0xccecc9(0x1ec)]()[_0xccecc9(0x1a5)](0x5,'0');if(_0x391aa3[0x0]['language']==_0xccecc9(0x1bd))var _0x51b30e=users[_0xccecc9(0x1e1)];else{if(_0x391aa3[0x0][_0xccecc9(0x1b1)]==_0xccecc9(0x187))var _0x51b30e=users[_0xccecc9(0x187)];else{if(_0x391aa3[0x0][_0xccecc9(0x1b1)]=='German')var _0x51b30e=users['German'];else{if(_0x391aa3[0x0][_0xccecc9(0x1b1)]==_0xccecc9(0x243))var _0x51b30e=users['Spanish'];else{if(_0x391aa3[0x0][_0xccecc9(0x1b1)]==_0xccecc9(0x1ee))var _0x51b30e=users[_0xccecc9(0x1ee)];else{if(_0x391aa3[0x0][_0xccecc9(0x1b1)]==_0xccecc9(0x181))var _0x51b30e=users[_0xccecc9(0x1d0)];else{if(_0x391aa3[0x0]['language']==_0xccecc9(0x21e))var _0x51b30e=users[_0xccecc9(0x21e)];else{if(_0x391aa3[0x0][_0xccecc9(0x1b1)]==_0xccecc9(0x21c))var _0x51b30e=users[_0xccecc9(0x1ed)];}}}}}}}const _0x4144f2=getRandom8DigitNumber();_0x4144f2[_0xccecc9(0x1b5)](_0xec5f61=>{var _0xa29d63=_0xccecc9;_0x33988b[_0xa29d63(0x1dc)](_0xa29d63(0x203),{'success':_0x3a5d82[_0xa29d63(0x1ce)](_0xa29d63(0x17f)),'errors':_0x3a5d82[_0xa29d63(0x1ce)](_0xa29d63(0x20c)),'role':_0x913a72,'profile':_0x307efe,'master_shop':_0x391aa3,'warehouse':_0x39a8bc,'language':_0x51b30e,'invoice':_0xec5f61});})[_0xccecc9(0x221)](_0x2c9741=>{var _0x1aa416=_0xccecc9;_0x3a5d82[_0x1aa416(0x1ce)](_0x1aa416(0x20c),_0x1aa416(0x1c2)),_0x33988b[_0x1aa416(0x1c4)]('/transfer/view');});}catch(_0x3e36f5){console[_0xccecc9(0x1dd)](_0x3e36f5);}}),router[a0_0x469054(0x1b8)](a0_0x469054(0x1ba),auth,async(_0x67aac2,_0x4275ad)=>{var _0x2c44fa=a0_0x469054;try{const {date:_0x1327a1,from_warehouse:_0x563556,FromRoom_name:_0x5e9f28,to_warehouse:_0x6471a3,ToRoom_name:_0x3baa6c,prod_name:_0x544ba5,from_prod_qty:_0x33f699,from_prod_level:_0x22a4b8,from_prod_isle:_0x4e52e0,from_prod_pallet:_0x16070e,to_prod_qty:_0x564316,to_prod_level:_0x228808,to_prod_isle:_0x121cd3,to_prod_pallet:_0x53aad3,primary_code:_0x3f4cef,secondary_code:_0x518425,product_code3:_0x28f03b,note:_0x97264c,MaxStocks_data2:_0x2c183b,invoice:_0x306b29,expiry_date:_0x28f462}=_0x67aac2[_0x2c44fa(0x252)];if(typeof _0x544ba5=='string')var _0x34dd16=[_0x67aac2[_0x2c44fa(0x252)]['prod_name']],_0x102077=[_0x67aac2['body'][_0x2c44fa(0x19d)]],_0xc2f088=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x20e)]],_0x4153e2=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x242)]],_0x5c8adf=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x230)]],_0x4908a8=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x233)]],_0x4b155e=[_0x67aac2['body'][_0x2c44fa(0x226)]],_0x48e022=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x236)]],_0x33fda2=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x1a0)]],_0x4619f8=[_0x67aac2[_0x2c44fa(0x252)]['primary_unit']],_0x5b4fb7=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x183)]],_0x203f04=[_0x67aac2['body']['batch_code']],_0x2ced07=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x1b7)]],_0x39f9f9=[_0x67aac2['body'][_0x2c44fa(0x189)]],_0x3f7f24=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x1ab)]],_0x12308e=[_0x67aac2['body'][_0x2c44fa(0x1da)]],_0x29bc75=[_0x67aac2['body'][_0x2c44fa(0x23a)]],_0x3f387a=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x196)]],_0x1325aa=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x23d)]],_0x35def6=[_0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x21d)]],_0x55ade2=[_0x67aac2[_0x2c44fa(0x252)]['to_invoice']];else var _0x34dd16=[..._0x67aac2['body'][_0x2c44fa(0x191)]],_0x102077=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x19d)]],_0xc2f088=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x20e)]],_0x4153e2=[..._0x67aac2['body'][_0x2c44fa(0x242)]],_0x5c8adf=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x230)]],_0x4908a8=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x233)]],_0x4b155e=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x226)]],_0x48e022=[..._0x67aac2[_0x2c44fa(0x252)]['product_code3']],_0x33fda2=[..._0x67aac2['body']['MaxStocks_data2']],_0x4619f8=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x208)]],_0x5b4fb7=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x183)]],_0x203f04=[..._0x67aac2['body'][_0x2c44fa(0x1a9)]],_0x2ced07=[..._0x67aac2['body'][_0x2c44fa(0x1b7)]],_0x39f9f9=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x189)]],_0x3f7f24=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x1ab)]],_0x12308e=[..._0x67aac2[_0x2c44fa(0x252)]['maxPerUnit']],_0x29bc75=[..._0x67aac2[_0x2c44fa(0x252)]['prod_cat']],_0x3f387a=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x196)]],_0x1325aa=[..._0x67aac2[_0x2c44fa(0x252)]['ToRoomAssigned']],_0x35def6=[..._0x67aac2['body'][_0x2c44fa(0x21d)]],_0x55ade2=[..._0x67aac2[_0x2c44fa(0x252)][_0x2c44fa(0x206)]];const _0x291ac0=_0x34dd16[_0x2c44fa(0x1d5)](_0x3f866c=>{return _0x3f866c={'product_name':_0x3f866c};});_0x102077[_0x2c44fa(0x246)]((_0x2faa37,_0x2292d8)=>{var _0xb3d34a=_0x2c44fa;_0x291ac0[_0x2292d8][_0xb3d34a(0x1aa)]=_0x2faa37;}),_0xc2f088['forEach']((_0x1548fa,_0x44abac)=>{var _0x53f8a4=_0x2c44fa;_0x291ac0[_0x44abac][_0x53f8a4(0x1fa)]=_0x1548fa;}),_0x35def6['forEach']((_0x10b769,_0x186e68)=>{var _0x448721=_0x2c44fa;_0x291ac0[_0x186e68][_0x448721(0x21d)]=_0x10b769;}),_0x55ade2[_0x2c44fa(0x246)]((_0x262ae2,_0x160478)=>{_0x291ac0[_0x160478]['To_invoice']=_0x262ae2;}),_0x4153e2[_0x2c44fa(0x246)]((_0x492e54,_0x294f0f)=>{_0x291ac0[_0x294f0f]['to_quantity']=_0x492e54;}),_0x5c8adf['forEach']((_0x3abbc0,_0x413f5b)=>{_0x291ac0[_0x413f5b]['to_bay']=_0x3abbc0;}),_0x4908a8[_0x2c44fa(0x246)]((_0x174ef5,_0x30e346)=>{var _0x5607d5=_0x2c44fa;_0x291ac0[_0x30e346][_0x5607d5(0x233)]=_0x174ef5;}),_0x4b155e[_0x2c44fa(0x246)]((_0x122d2f,_0x26d623)=>{var _0x259e26=_0x2c44fa;_0x291ac0[_0x26d623][_0x259e26(0x226)]=_0x122d2f;}),_0x48e022[_0x2c44fa(0x246)]((_0x52857f,_0x3de5f6)=>{var _0x4fe234=_0x2c44fa;_0x291ac0[_0x3de5f6][_0x4fe234(0x232)]=_0x52857f;}),_0x33fda2['forEach']((_0x431e9c,_0x1455a1)=>{var _0x55516d=_0x2c44fa;_0x291ac0[_0x1455a1][_0x55516d(0x1bb)]=_0x431e9c;}),_0x4619f8[_0x2c44fa(0x246)]((_0xf7ab8e,_0x3bc062)=>{var _0x496117=_0x2c44fa;_0x291ac0[_0x3bc062][_0x496117(0x18d)]=_0xf7ab8e;}),_0x5b4fb7[_0x2c44fa(0x246)]((_0x1572fc,_0x3a252e)=>{_0x291ac0[_0x3a252e]['secondary_unit']=_0x1572fc;}),_0x203f04['forEach']((_0x60a64f,_0x48eb16)=>{var _0x28656d=_0x2c44fa;_0x291ac0[_0x48eb16][_0x28656d(0x1a9)]=_0x60a64f;}),_0x2ced07[_0x2c44fa(0x246)]((_0x1c2336,_0x9f358a)=>{var _0x260512=_0x2c44fa;_0x291ac0[_0x9f358a][_0x260512(0x1b7)]=_0x1c2336;}),_0x39f9f9['forEach']((_0x538222,_0x2b7939)=>{var _0x5ba14e=_0x2c44fa;_0x291ac0[_0x2b7939][_0x5ba14e(0x18b)]=_0x538222;}),_0x3f7f24['forEach']((_0x178c6a,_0x30c73b)=>{var _0x3ef148=_0x2c44fa;_0x291ac0[_0x30c73b][_0x3ef148(0x1bb)]=_0x178c6a;}),_0x12308e[_0x2c44fa(0x246)]((_0x1385f9,_0x37a1a0)=>{_0x291ac0[_0x37a1a0]['maxPerUnit']=_0x1385f9;}),_0x29bc75[_0x2c44fa(0x246)]((_0x4c9fa1,_0x5db392)=>{_0x291ac0[_0x5db392]['prod_cat']=_0x4c9fa1;}),_0x3f387a['forEach']((_0x53b72d,_0x12e104)=>{var _0x538436=_0x2c44fa;_0x291ac0[_0x12e104][_0x538436(0x1db)]=_0x53b72d;}),_0x1325aa[_0x2c44fa(0x246)]((_0x23867e,_0x3f7729)=>{var _0x1810bb=_0x2c44fa;_0x291ac0[_0x3f7729][_0x1810bb(0x207)]=_0x23867e;});const _0x1f21b3=_0x291ac0[_0x2c44fa(0x1c1)](_0x6241d2=>_0x6241d2[_0x2c44fa(0x200)]!=='0'&&_0x6241d2[_0x2c44fa(0x200)]!==''||_0x6241d2[_0x2c44fa(0x1f3)]!=='0'&&_0x6241d2[_0x2c44fa(0x1f3)]!=='');var _0x56831=0x0;_0x1f21b3[_0x2c44fa(0x246)](_0x6cd54d=>{var _0x3628b7=_0x2c44fa;parseInt(_0x6cd54d[_0x3628b7(0x1aa)])<parseInt(_0x6cd54d[_0x3628b7(0x200)])&&_0x56831++;});if(_0x56831!=0x0)return _0x67aac2[_0x2c44fa(0x1ce)](_0x2c44fa(0x20c),_0x2c44fa(0x1c6)),_0x4275ad[_0x2c44fa(0x1c4)](_0x2c44fa(0x198));const _0x24df96=new transfers_finished({'date':_0x1327a1,'from_warehouse':_0x563556,'to_warehouse':_0x6471a3,'product':_0x1f21b3,'note':_0x97264c,'invoice':_0x306b29}),_0x4d19b4=await _0x24df96[_0x2c44fa(0x188)]();_0x67aac2[_0x2c44fa(0x1ce)]('success','Product\x20Transfer\x20successfully'),_0x4275ad[_0x2c44fa(0x1c4)](_0x2c44fa(0x1a6)+_0x4d19b4[_0x2c44fa(0x1f4)]);}catch(_0x386bc2){console[_0x2c44fa(0x1dd)](_0x386bc2),_0x4275ad[_0x2c44fa(0x1c9)](0xc8)[_0x2c44fa(0x1eb)]({'errorMessage':_0x386bc2[_0x2c44fa(0x237)]});}}),router[a0_0x469054(0x24f)](a0_0x469054(0x1a3),auth,async(_0x375e5b,_0x57e937)=>{var _0x21307d=a0_0x469054;try{const {username:_0x487282,email:_0x566c7e,role:_0x227b1b}=_0x375e5b['user'],_0x19d15b=_0x375e5b[_0x21307d(0x247)],_0x235c3b=await profile[_0x21307d(0x1f8)]({'email':_0x19d15b[_0x21307d(0x1f1)]}),_0x3d0341=await master_shop[_0x21307d(0x218)](),_0x19d81f=await transfers_finished['findById'](_0x375e5b['params']['id']);let _0x48ff7e;if(_0x19d15b[_0x21307d(0x1af)]==_0x21307d(0x1cf)){const _0x367dfd=await staff[_0x21307d(0x1f8)]({'email':_0x19d15b['email']});_0x48ff7e=await warehouse['find']({'status':_0x21307d(0x1b3),'name':_0x367dfd[_0x21307d(0x225)],'warehouse_category':_0x21307d(0x231)});}else _0x48ff7e=await warehouse[_0x21307d(0x218)]({'status':_0x21307d(0x1b3),'warehouse_category':_0x21307d(0x231)});const _0x236c8b=await warehouse[_0x21307d(0x1d3)]([{'$match':{'name':_0x19d81f[_0x21307d(0x22a)],'warehouse_category':_0x21307d(0x231)}},{'$unwind':_0x21307d(0x182)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x21307d(0x18c)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x21307d(0x18e)},'bin':{'$first':_0x21307d(0x194)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':_0x21307d(0x24b)},'primary_code':{'$first':_0x21307d(0x22b)},'secondary_code':{'$first':_0x21307d(0x1f9)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x21307d(0x21a)},'rack':{'$first':_0x21307d(0x213)},'expiry_date':{'$first':_0x21307d(0x1d6)},'production_date':{'$first':_0x21307d(0x24d)},'room':{'$first':_0x21307d(0x1b9)},'warehoue_name':{'$first':_0x21307d(0x227)}}}]),_0x2926fb=await product[_0x21307d(0x218)]({});if(_0x3d0341[0x0][_0x21307d(0x1b1)]=='English\x20(US)'){var _0x224222=users[_0x21307d(0x1e1)];console[_0x21307d(0x1dd)](_0x224222);}else{if(_0x3d0341[0x0][_0x21307d(0x1b1)]==_0x21307d(0x187))var _0x224222=users[_0x21307d(0x187)];else{if(_0x3d0341[0x0][_0x21307d(0x1b1)]==_0x21307d(0x241))var _0x224222=users[_0x21307d(0x241)];else{if(_0x3d0341[0x0][_0x21307d(0x1b1)]=='Spanish')var _0x224222=users[_0x21307d(0x243)];else{if(_0x3d0341[0x0][_0x21307d(0x1b1)]=='French')var _0x224222=users[_0x21307d(0x1ee)];else{if(_0x3d0341[0x0][_0x21307d(0x1b1)]=='Portuguese\x20(BR)')var _0x224222=users['Portuguese'];else{if(_0x3d0341[0x0][_0x21307d(0x1b1)]==_0x21307d(0x21e))var _0x224222=users['Chinese'];else{if(_0x3d0341[0x0][_0x21307d(0x1b1)]==_0x21307d(0x21c))var _0x224222=users['Arabic'];}}}}}}}_0x57e937['render'](_0x21307d(0x1ea),{'success':_0x375e5b[_0x21307d(0x1ce)]('success'),'errors':_0x375e5b[_0x21307d(0x1ce)](_0x21307d(0x20c)),'role':_0x19d15b,'profile':_0x235c3b,'master_shop':_0x3d0341,'warehouse':_0x48ff7e,'transfer':_0x19d81f,'stock':_0x236c8b,'unit':_0x2926fb,'language':_0x224222});}catch(_0x116a57){console[_0x21307d(0x1dd)](_0x116a57);}}),router[a0_0x469054(0x1b8)](a0_0x469054(0x1a3),auth,async(_0x5854ac,_0x59b88b)=>{var _0x5298de=a0_0x469054;try{const {invoice:_0x364068,from_warehouse:_0x1ee85a,FromRoom_name:_0x161e67,to_warehouse:_0x409a40,ToRoom_name:_0x3cf49d}=_0x5854ac[_0x5298de(0x252)],_0x40f708=await transfers_finished[_0x5298de(0x1b0)](_0x5854ac[_0x5298de(0x210)]['id']),_0x42b197=_0x40f708['product'][_0x5298de(0x1d5)](async _0x1bd253=>{var _0x5aceb2=_0x5298de;if(_0x1bd253[_0x5aceb2(0x200)]>0x0){var _0x60cb0f=await warehouse[_0x5aceb2(0x1f8)]({'name':_0x1ee85a,'room':_0x1bd253[_0x5aceb2(0x1db)],'warehouse_category':_0x5aceb2(0x231)});const _0x1680fa=_0x60cb0f[_0x5aceb2(0x1f2)][_0x5aceb2(0x1d5)](_0x294556=>{var _0x5d389c=_0x5aceb2;_0x294556[_0x5d389c(0x19a)]==_0x1bd253[_0x5d389c(0x19a)]&&_0x294556[_0x5d389c(0x1e5)]==_0x1bd253['from_bay']&&_0x294556['expiry_date']==_0x1bd253[_0x5d389c(0x1b7)]&&_0x294556[_0x5d389c(0x18b)]==_0x1bd253['production_date']&&_0x294556[_0x5d389c(0x1a9)]==_0x1bd253['batch_code']&&_0x294556[_0x5d389c(0x216)]==_0x1bd253[_0x5d389c(0x21d)]&&(_0x294556[_0x5d389c(0x1e7)]=_0x294556['product_stock']-_0x1bd253[_0x5d389c(0x200)]);});}return _0x60cb0f;});Promise[_0x5298de(0x1ad)](_0x42b197)[_0x5298de(0x1b5)](async _0x5a1b2e=>{var _0x288518=_0x5298de;try{for(const _0x51eedb of _0x5a1b2e){await _0x51eedb[_0x288518(0x188)]();}const _0x10ebba=_0x40f708['product']['map'](async _0x44089a=>{var _0x4fd8b8=_0x288518,_0x4d2dd9=await warehouse['findOne']({'name':_0x409a40,'room':_0x44089a[_0x4fd8b8(0x207)]});if(_0x44089a['to_quantity']>0x0){var _0x3a014e=0x0;const _0x9b80f7=_0x4d2dd9[_0x4fd8b8(0x1f2)]['map'](_0x24eda3=>{var _0x4ec14a=_0x4fd8b8;_0x24eda3[_0x4ec14a(0x19a)]==_0x44089a[_0x4ec14a(0x19a)]&&_0x24eda3['bay']==_0x44089a['to_bay']&&_0x24eda3[_0x4ec14a(0x1b7)]==_0x44089a[_0x4ec14a(0x1b7)]&&_0x24eda3[_0x4ec14a(0x18b)]==_0x44089a[_0x4ec14a(0x18b)]&&_0x24eda3[_0x4ec14a(0x1a9)]==_0x44089a[_0x4ec14a(0x1a9)]&&_0x24eda3[_0x4ec14a(0x216)]==_0x44089a[_0x4ec14a(0x202)]&&(_0x24eda3[_0x4ec14a(0x1e7)]=_0x24eda3[_0x4ec14a(0x1e7)]+_0x44089a[_0x4ec14a(0x200)],_0x3a014e++);});_0x3a014e=='0'&&(_0x4d2dd9[_0x4fd8b8(0x1f2)]=_0x4d2dd9['product_details']['concat']({'product_name':_0x44089a['product_name'],'product_stock':_0x44089a[_0x4fd8b8(0x200)],'bay':_0x44089a['to_bay'],'product_code':_0x44089a[_0x4fd8b8(0x232)],'primary_code':_0x44089a[_0x4fd8b8(0x233)],'secondary_code':_0x44089a['secondary_code'],'expiry_date':_0x44089a[_0x4fd8b8(0x1b7)],'production_date':_0x44089a[_0x4fd8b8(0x18b)],'maxProducts':_0x44089a['maxProducts'],'batch_code':_0x44089a[_0x4fd8b8(0x1a9)],'secondary_unit':_0x44089a['secondary_unit'],'unit':_0x44089a[_0x4fd8b8(0x18d)],'maxProducts':_0x44089a[_0x4fd8b8(0x1bb)],'maxPerUnit':_0x44089a[_0x4fd8b8(0x1da)],'invoice':_0x44089a[_0x4fd8b8(0x202)]}));}return _0x4d2dd9;});Promise[_0x288518(0x1ad)](_0x10ebba)[_0x288518(0x1b5)](async _0x199905=>{var _0x136bf7=_0x288518;try{for(const _0x3aeb78 of _0x199905){await warehouse[_0x136bf7(0x1a8)]({'_id':_0x3aeb78[_0x136bf7(0x1f4)]},{'$addToSet':{'product_details':{'$each':_0x3aeb78[_0x136bf7(0x1f2)]}}});}_0x40f708['finalize']=_0x136bf7(0x24c);const _0x203c1f=await _0x40f708[_0x136bf7(0x188)](),_0x892e76=await master_shop['find'](),_0x16a5bb=await email_settings[_0x136bf7(0x1f8)](),_0x3ac1f1=await supervisor_settings[_0x136bf7(0x218)]();var _0x44489f=_0x40f708[_0x136bf7(0x1d2)],_0x3974ba='',_0x39cc8b;for(_0x39cc8b in _0x44489f){var _0x40c283='FG';_0x40f708[_0x136bf7(0x23e)]==_0x136bf7(0x1f5)&&(_0x40c283='DG'),_0x3974ba+=_0x136bf7(0x197)+_0x136bf7(0x1de)+_0x44489f[_0x39cc8b][_0x136bf7(0x19a)]+_0x136bf7(0x229)+_0x136bf7(0x1de)+_0x44489f[_0x39cc8b][_0x136bf7(0x232)]+'</td>'+_0x136bf7(0x1de)+_0x44489f[_0x39cc8b]['to_quantity']+_0x136bf7(0x229)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x44489f[_0x39cc8b]['unit']+_0x136bf7(0x229)+_0x136bf7(0x1de)+_0x44489f[_0x39cc8b][_0x136bf7(0x183)]+_0x136bf7(0x229)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x40f708[_0x136bf7(0x23e)]+_0x136bf7(0x229)+_0x136bf7(0x1de)+_0x44489f[_0x39cc8b]['to_room_name']+_0x136bf7(0x229)+_0x136bf7(0x1de)+_0x40c283+_0x44489f[_0x39cc8b][_0x136bf7(0x1d8)]+_0x136bf7(0x229)+_0x136bf7(0x250);}let _0x29533b=nodemailer['createTransport']({'host':_0x16a5bb[_0x136bf7(0x1c8)],'port':Number(_0x16a5bb[_0x136bf7(0x23c)]),'secure':![],'auth':{'user':_0x16a5bb[_0x136bf7(0x1f1)],'pass':_0x16a5bb['password']}}),_0x57e554={'from':_0x16a5bb[_0x136bf7(0x1f1)],'to':_0x3ac1f1[0x0][_0x136bf7(0x244)],'subject':_0x136bf7(0x240),'attachments':[{'filename':_0x136bf7(0x23b),'path':__dirname+_0x136bf7(0x1fd)+'/upload/'+_0x892e76[0x0]['image'],'cid':_0x136bf7(0x239)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+'</head><body>'+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x136bf7(0x1a2)+_0x136bf7(0x1fb)+'</div>'+_0x136bf7(0x1a2)+_0x136bf7(0x1a1)+_0x892e76[0x0][_0x136bf7(0x1fe)]+_0x136bf7(0x217)+_0x136bf7(0x1e0)+'</div>'+'<hr\x20class=\x22my-3\x22>'+_0x136bf7(0x1a2)+_0x136bf7(0x20b)+'\x20Order\x20Number\x20:\x20'+_0x40f708['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x136bf7(0x1ac)+_0x40f708[_0x136bf7(0x209)]+'\x20'+_0x136bf7(0x1df)+_0x136bf7(0x17e)+_0x136bf7(0x1e0)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x136bf7(0x1f0)+_0x136bf7(0x197)+_0x136bf7(0x1c3)+_0x136bf7(0x19b)+_0x136bf7(0x1cc)+_0x136bf7(0x22c)+_0x136bf7(0x1d9)+_0x136bf7(0x1e3)+_0x136bf7(0x201)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x136bf7(0x250)+_0x136bf7(0x192)+_0x136bf7(0x1f6)+'\x20'+_0x3974ba+'\x20'+_0x136bf7(0x21b)+_0x136bf7(0x185)+_0x136bf7(0x1a2)+_0x136bf7(0x1b6)+'<h5>'+_0x892e76[0x0][_0x136bf7(0x1fe)]+_0x136bf7(0x17e)+_0x136bf7(0x1e0)+_0x136bf7(0x1e0)+_0x136bf7(0x22d)};_0x29533b['sendMail'](_0x57e554,function(_0xe6b8ee,_0xaf7c9c){var _0x180cd9=_0x136bf7;_0xe6b8ee?(console[_0x180cd9(0x1dd)](_0xe6b8ee),console[_0x180cd9(0x1dd)]('Error\x20Occurs')):console[_0x180cd9(0x1dd)](_0x180cd9(0x235));}),_0x5854ac[_0x136bf7(0x1ce)](_0x136bf7(0x17f),_0x136bf7(0x211)),_0x59b88b[_0x136bf7(0x1c4)](_0x136bf7(0x238)+_0x203c1f[_0x136bf7(0x1f4)]);}catch(_0x23ba7d){console[_0x136bf7(0x222)](_0x23ba7d),_0x59b88b[_0x136bf7(0x1c9)](0x1f4)[_0x136bf7(0x1eb)]({'error':_0x136bf7(0x1e4)});}})[_0x288518(0x221)](_0x2523f9=>{var _0x3d4c81=_0x288518;console[_0x3d4c81(0x222)](_0x2523f9),_0x59b88b[_0x3d4c81(0x1c9)](0x1f4)[_0x3d4c81(0x1eb)]({'error':_0x3d4c81(0x1f7)});});}catch(_0x1a0969){console['error'](_0x1a0969),_0x59b88b[_0x288518(0x1c9)](0x1f4)[_0x288518(0x1eb)]({'error':_0x288518(0x1bf)});}})[_0x5298de(0x221)](_0x5a1e2d=>{var _0x3af391=_0x5298de;console[_0x3af391(0x222)](_0x5a1e2d),_0x59b88b['status'](0x1f4)[_0x3af391(0x1eb)]({'error':'An\x20error\x20occurred.'});});}catch(_0x499978){_0x59b88b[_0x5298de(0x1eb)]({'message':_0x499978['message']});}});function BayBinSelected(_0x3d22df,_0x369a65){var _0x3100f8=a0_0x469054,_0x4a9b8f=[];let _0x1e6ed2=[];var _0x1559db=[];if(_0x3d22df==_0x3100f8(0x1f5)){switch(_0x369a65){case _0x3100f8(0x228):_0x4a9b8f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x4a9b8f=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x1559db=['DG'];}else{if(_0x3d22df==_0x3100f8(0x21f)){switch(_0x369a65){case _0x3100f8(0x228):_0x4a9b8f=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x3100f8(0x1e2):_0x4a9b8f=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x1559db=['FG'];}}return{'levels':_0x4a9b8f,'identify':_0x1559db};}router[a0_0x469054(0x24f)](a0_0x469054(0x20d),auth,async(_0x20d5a1,_0x2e0ba4)=>{var _0xfd06bb=a0_0x469054;try{const {username:_0x5811d0,email:_0x804be3,role:_0x2b407d}=_0x20d5a1[_0xfd06bb(0x247)],_0x3dd2a0=_0x20d5a1[_0xfd06bb(0x247)],_0x26bb03=await profile[_0xfd06bb(0x1f8)]({'email':_0x3dd2a0[_0xfd06bb(0x1f1)]}),_0x24ed38=await master_shop[_0xfd06bb(0x218)](),_0x4711ce=await transfers_finished[_0xfd06bb(0x1b0)](_0x20d5a1[_0xfd06bb(0x210)]['id']);let _0x4b9b30=new Date(_0x4711ce[_0xfd06bb(0x1b7)]),_0x2d4075=('0'+_0x4b9b30[_0xfd06bb(0x1fc)]())[_0xfd06bb(0x219)](-0x2),_0xf9555c=('0'+(_0x4b9b30[_0xfd06bb(0x190)]()+0x1))[_0xfd06bb(0x219)](-0x2),_0x325a36=_0x4b9b30[_0xfd06bb(0x215)](),_0x54ef13=_0x325a36+'-'+_0xf9555c+'-'+_0x2d4075,_0x2c35a4;if(_0x3dd2a0[_0xfd06bb(0x1af)]==_0xfd06bb(0x1cf)){const _0x231c84=await staff['findOne']({'email':_0x3dd2a0[_0xfd06bb(0x1f1)]});_0x2c35a4=await warehouse[_0xfd06bb(0x218)]({'status':_0xfd06bb(0x1b3),'name':_0x231c84['warehouse'],'warehouse_category':_0xfd06bb(0x231)});}else _0x2c35a4=await warehouse['find']({'status':_0xfd06bb(0x1b3),'warehouse_category':_0xfd06bb(0x231)});const _0x562a46=await warehouse[_0xfd06bb(0x1d3)]([{'$match':{'name':_0x4711ce['from_warehouse'],'room':_0x4711ce[_0xfd06bb(0x204)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0xfd06bb(0x20f),'name':{'$first':_0xfd06bb(0x18c)},'product_stock':{'$first':_0xfd06bb(0x1cb)},'bay':{'$first':_0xfd06bb(0x18e)},'bin':{'$first':_0xfd06bb(0x194)},'type':{'$first':_0xfd06bb(0x1cd)},'floorlevel':{'$first':_0xfd06bb(0x24b)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0xfd06bb(0x24a)},'storage':{'$first':_0xfd06bb(0x21a)},'rack':{'$first':'$product_details.rack'}}}]);var _0x100134=[0x1,0x2,0x3,0x4],_0x41be58=['A','B','C','D','E','F','G','H','I','J'],_0x375123=[_0xfd06bb(0x220),'Enclosed'];const _0x4ea5d5=await product[_0xfd06bb(0x218)]({}),_0x1dead7=BayBinSelected(_0x4711ce['to_warehouse'],_0x4711ce[_0xfd06bb(0x1ef)]);if(_0x24ed38[0x0][_0xfd06bb(0x1b1)]==_0xfd06bb(0x1bd)){var _0x270820=users[_0xfd06bb(0x1e1)];console[_0xfd06bb(0x1dd)](_0x270820);}else{if(_0x24ed38[0x0][_0xfd06bb(0x1b1)]==_0xfd06bb(0x187))var _0x270820=users[_0xfd06bb(0x187)];else{if(_0x24ed38[0x0][_0xfd06bb(0x1b1)]=='German')var _0x270820=users[_0xfd06bb(0x241)];else{if(_0x24ed38[0x0][_0xfd06bb(0x1b1)]==_0xfd06bb(0x243))var _0x270820=users[_0xfd06bb(0x243)];else{if(_0x24ed38[0x0][_0xfd06bb(0x1b1)]==_0xfd06bb(0x1ee))var _0x270820=users['French'];else{if(_0x24ed38[0x0][_0xfd06bb(0x1b1)]==_0xfd06bb(0x181))var _0x270820=users['Portuguese'];else{if(_0x24ed38[0x0][_0xfd06bb(0x1b1)]==_0xfd06bb(0x21e))var _0x270820=users[_0xfd06bb(0x21e)];else{if(_0x24ed38[0x0]['language']==_0xfd06bb(0x21c))var _0x270820=users['Arabic'];}}}}}}}_0x2e0ba4['render']('edit_transfer_finished',{'success':_0x20d5a1[_0xfd06bb(0x1ce)]('success'),'errors':_0x20d5a1[_0xfd06bb(0x1ce)](_0xfd06bb(0x20c)),'role':_0x3dd2a0,'profile':_0x26bb03,'master_shop':_0x24ed38,'warehouse':_0x2c35a4,'transfer':_0x4711ce,'stock':_0x562a46,'unit':_0x4ea5d5,'language':_0x270820,'levels':_0x100134,'Isle':_0x41be58,'rooms_data':_0x375123,'ed_fullDate':_0x54ef13,'dataSelected':_0x1dead7});}catch(_0x434e52){console[_0xfd06bb(0x1dd)](_0x434e52);}}),router[a0_0x469054(0x1b8)]('/view/:id',auth,async(_0x1491f7,_0x3eacf5)=>{var _0x42c005=a0_0x469054;try{const _0x31323c=_0x1491f7['params']['id'];console[_0x42c005(0x1dd)](_0x1491f7['body']);const _0x397451=await transfers_finished['findById'](_0x31323c);console[_0x42c005(0x1dd)](_0x42c005(0x245),_0x397451);const {date:_0x291bb7,from_warehouse:_0x5a7055,FromRoom_name:_0x404344,to_warehouse:_0x3dbfb1,ToRoom_name:_0x49e12a,prod_name:_0x30b360,from_prod_qty:_0x344a82,from_prod_level:_0x330d6e,from_prod_isle:_0x1773ec,from_prod_pallet:_0x45f798,to_prod_qty:_0xd4fe8,to_prod_level:_0x46f601,to_prod_isle:_0x2d2998,to_prod_pallet:_0x3e37af,primary_code:_0x148537,secondary_code:_0x5a3d2e,product_code3:_0x2dc2f6,note:_0x4d49cd,invoice:_0xaf572f,expiry_date:_0x4d5874}=_0x1491f7[_0x42c005(0x252)];if(typeof _0x30b360==_0x42c005(0x1d7))var _0x3564f0=[_0x1491f7[_0x42c005(0x252)][_0x42c005(0x191)]],_0x1ded0d=[_0x1491f7[_0x42c005(0x252)][_0x42c005(0x19d)]],_0x111ea6=[_0x1491f7[_0x42c005(0x252)][_0x42c005(0x20e)]],_0x1b0d80=[_0x1491f7[_0x42c005(0x252)][_0x42c005(0x214)]],_0x5f1c59=[_0x1491f7[_0x42c005(0x252)][_0x42c005(0x230)]],_0x14e3bf=[_0x1491f7['body'][_0x42c005(0x233)]],_0x5b17ae=[_0x1491f7['body'][_0x42c005(0x226)]],_0x5940e2=[_0x1491f7[_0x42c005(0x252)][_0x42c005(0x236)]],_0x44a80=[_0x1491f7['body'][_0x42c005(0x1a0)]],_0x9c7b3b=[_0x1491f7[_0x42c005(0x252)][_0x42c005(0x18d)]],_0x26e7ff=[_0x1491f7['body'][_0x42c005(0x183)]],_0x1dac97=[_0x1491f7[_0x42c005(0x252)]['batch_code']],_0x30f345=[_0x1491f7['body'][_0x42c005(0x1b7)]];else var _0x3564f0=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x191)]],_0x1ded0d=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x19d)]],_0x111ea6=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x20e)]],_0x1b0d80=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x214)]],_0x5f1c59=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x230)]],_0x14e3bf=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x233)]],_0x5b17ae=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x226)]],_0x5940e2=[..._0x1491f7[_0x42c005(0x252)][_0x42c005(0x236)]],_0x44a80=[..._0x1491f7['body']['MaxStocks_data2']],_0x9c7b3b=[..._0x1491f7[_0x42c005(0x252)]['unit']],_0x26e7ff=[..._0x1491f7['body'][_0x42c005(0x183)]],_0x1dac97=[..._0x1491f7[_0x42c005(0x252)]['batch_code']],_0x30f345=[..._0x1491f7[_0x42c005(0x252)]['expiry_date']];const _0x1470a9=_0x3564f0[_0x42c005(0x1d5)](_0x37b2f8=>{return _0x37b2f8={'product_name':_0x37b2f8};});_0x1ded0d[_0x42c005(0x246)]((_0x35dd3e,_0x674c69)=>{_0x1470a9[_0x674c69]['from_quantity']=_0x35dd3e;}),_0x111ea6['forEach']((_0x2de3a1,_0x2d063e)=>{var _0x2fc4e5=_0x42c005;_0x1470a9[_0x2d063e][_0x2fc4e5(0x1fa)]=_0x2de3a1;}),_0x1b0d80[_0x42c005(0x246)]((_0x352063,_0x3442c8)=>{var _0x32e01a=_0x42c005;_0x1470a9[_0x3442c8][_0x32e01a(0x200)]=_0x352063;}),_0x5f1c59['forEach']((_0x491f03,_0x15283c)=>{var _0x2c642a=_0x42c005;_0x1470a9[_0x15283c][_0x2c642a(0x1d8)]=_0x491f03;}),_0x14e3bf[_0x42c005(0x246)]((_0x836367,_0x2fa0e5)=>{var _0x4afa2c=_0x42c005;_0x1470a9[_0x2fa0e5][_0x4afa2c(0x233)]=_0x836367;}),_0x5b17ae['forEach']((_0x14dba9,_0x1af23e)=>{_0x1470a9[_0x1af23e]['secondary_code']=_0x14dba9;}),_0x5940e2[_0x42c005(0x246)]((_0x532f3a,_0x35904a)=>{_0x1470a9[_0x35904a]['product_code']=_0x532f3a;}),_0x44a80[_0x42c005(0x246)]((_0x4ecc9e,_0x524b4a)=>{var _0x385fab=_0x42c005;_0x1470a9[_0x524b4a][_0x385fab(0x1bb)]=_0x4ecc9e;}),_0x9c7b3b[_0x42c005(0x246)]((_0x3e8344,_0x1c4a9f)=>{var _0xef0569=_0x42c005;_0x1470a9[_0x1c4a9f][_0xef0569(0x18d)]=_0x3e8344;}),_0x26e7ff[_0x42c005(0x246)]((_0x1b82b5,_0x2f5d60)=>{_0x1470a9[_0x2f5d60]['secondary_unit']=_0x1b82b5;}),_0x1dac97[_0x42c005(0x246)]((_0x143628,_0x12acd8)=>{var _0x35a1b0=_0x42c005;_0x1470a9[_0x12acd8][_0x35a1b0(0x1a9)]=_0x143628;}),_0x30f345[_0x42c005(0x246)]((_0x2ce712,_0x182d2b)=>{var _0x347838=_0x42c005;_0x1470a9[_0x182d2b][_0x347838(0x1b7)]=_0x2ce712;});const _0x29a4d0=_0x1470a9[_0x42c005(0x1c1)](_0x5ee71b=>_0x5ee71b[_0x42c005(0x200)]!=='0'&&_0x5ee71b['to_quantity']!==''||_0x5ee71b[_0x42c005(0x1f3)]!=='0'&&_0x5ee71b[_0x42c005(0x1f3)]!=='');var _0x43689f=0x0;_0x29a4d0[_0x42c005(0x246)](_0x29de4b=>{var _0x575dfa=_0x42c005;parseInt(_0x29de4b['from_quantity'])<parseInt(_0x29de4b[_0x575dfa(0x200)])&&_0x43689f++;});if(_0x43689f!=0x0)return _0x1491f7['flash'](_0x42c005(0x20c),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x3eacf5['redirect']('back');const _0x5bbff9=await warehouse[_0x42c005(0x1f8)]({'name':_0x397451[_0x42c005(0x22a)],'room':_0x397451[_0x42c005(0x204)]});_0x397451['product'][_0x42c005(0x246)](_0x3ba916=>{var _0x149844=_0x42c005;if(_0x3ba916['to_quantity']>0x0){const _0x46feb0=_0x5bbff9['product_details'][_0x149844(0x1d5)](_0x5c911a=>{var _0x14b067=_0x149844;_0x5c911a[_0x14b067(0x19a)]==_0x3ba916['product_name']&&_0x5c911a[_0x14b067(0x1e5)]==_0x3ba916[_0x14b067(0x1fa)]&&(_0x5c911a['product_stock']=parseInt(_0x5c911a[_0x14b067(0x1e7)])+parseInt(_0x3ba916[_0x14b067(0x200)]));});}}),await _0x5bbff9[_0x42c005(0x188)]();const _0x22abb8=await warehouse[_0x42c005(0x1f8)]({'name':_0x397451[_0x42c005(0x23e)],'room':_0x397451['to_room']});_0x397451[_0x42c005(0x1d2)]['forEach'](_0x5c93d5=>{var _0x55c614=_0x42c005;if(_0x5c93d5['to_quantity']>0x0){const _0x3eb36e=_0x22abb8[_0x55c614(0x1f2)][_0x55c614(0x1d5)](_0x16f419=>{var _0x205d07=_0x55c614;_0x16f419[_0x205d07(0x19a)]==_0x5c93d5['product_name']&&_0x16f419['bay']==_0x5c93d5['to_bay']&&(_0x16f419[_0x205d07(0x1e7)]=parseInt(_0x16f419[_0x205d07(0x1e7)])-parseInt(_0x5c93d5[_0x205d07(0x200)]));});}}),await _0x22abb8['save'](),_0x397451[_0x42c005(0x209)]=_0x291bb7,_0x397451[_0x42c005(0x22a)]=_0x5a7055,_0x397451[_0x42c005(0x23e)]=_0x3dbfb1,_0x397451[_0x42c005(0x1d2)]=_0x29a4d0,_0x397451['note']=_0x4d49cd,_0x397451[_0x42c005(0x216)]=_0xaf572f;const _0x126a3a=await _0x397451[_0x42c005(0x188)](),_0x2cd86c=await warehouse[_0x42c005(0x1f8)]({'name':_0x5a7055,'room':_0x404344});_0x126a3a[_0x42c005(0x1d2)]['forEach'](_0x1c825d=>{var _0x15dc5c=_0x42c005;if(_0x1c825d[_0x15dc5c(0x200)]>0x0){const _0x1bcd0e=_0x2cd86c[_0x15dc5c(0x1f2)][_0x15dc5c(0x1d5)](_0x229f32=>{var _0x19bf1c=_0x15dc5c;_0x229f32['product_name']==_0x1c825d[_0x19bf1c(0x19a)]&&_0x229f32[_0x19bf1c(0x1e5)]==_0x1c825d[_0x19bf1c(0x1fa)]&&(_0x229f32[_0x19bf1c(0x1e7)]=parseInt(_0x229f32[_0x19bf1c(0x1e7)])-parseInt(_0x1c825d[_0x19bf1c(0x200)]));});}}),await _0x2cd86c[_0x42c005(0x188)]();const _0x281de5=await warehouse[_0x42c005(0x1f8)]({'name':_0x3dbfb1,'room':_0x49e12a});_0x126a3a[_0x42c005(0x1d2)][_0x42c005(0x246)](_0xba5518=>{var _0x24f885=_0x42c005;if(_0xba5518[_0x24f885(0x200)]>0x0){var _0x3dd021=0x0;const _0x4fbbce=_0x281de5[_0x24f885(0x1f2)][_0x24f885(0x1d5)](_0x30a374=>{var _0x4c9026=_0x24f885;_0x30a374[_0x4c9026(0x19a)]==_0xba5518[_0x4c9026(0x19a)]&&_0x30a374[_0x4c9026(0x1e5)]==_0xba5518[_0x4c9026(0x1d8)]&&(_0x30a374[_0x4c9026(0x1e7)]=parseInt(_0x30a374['product_stock'])+parseInt(_0xba5518[_0x4c9026(0x200)]),_0x3dd021++);});_0x3dd021=='0'&&(_0x281de5[_0x24f885(0x1f2)]=_0x281de5[_0x24f885(0x1f2)][_0x24f885(0x18a)]({'product_name':_0xba5518[_0x24f885(0x19a)],'product_stock':_0xba5518[_0x24f885(0x200)],'bay':_0xba5518[_0x24f885(0x1d8)],'product_code':_0xba5518['product_code'],'primary_code':_0xba5518[_0x24f885(0x233)],'secondary_code':_0xba5518[_0x24f885(0x226)],'maxProducts':_0xba5518['maxProducts']}));}}),await _0x281de5[_0x42c005(0x188)](),_0x1491f7['flash'](_0x42c005(0x17f),'Transfer\x20Edit\x20Successfully'),_0x3eacf5[_0x42c005(0x1c4)]('/transfer_finished/view');}catch(_0x10a38a){console[_0x42c005(0x1dd)](_0x10a38a);}}),router['post'](a0_0x469054(0x1e8),async(_0x33084d,_0x191cfb)=>{var _0x4d16db=a0_0x469054;const {FromWareHouse:_0x3273b6,FromRoom:_0x4a1136,ToWarehouse:_0x1f66cb,ToRoom:_0x235547,primary_code:_0x10ae6f,Roomslist:_0xaeb550}=_0x33084d['body'],_0x3fbdc5=_0xaeb550['split'](','),_0x4f9d64=[];async function _0x3038c4(_0x1513e7){var _0x492409=a0_0x189e;const _0x331515=await warehouse['aggregate']([{'$match':{'name':_0x3273b6,'room':_0x1513e7}},{'$unwind':_0x492409(0x182)},{'$match':{'product_details.primary_code':_0x10ae6f}},{'$group':{'_id':_0x492409(0x20f),'name':{'$first':_0x492409(0x18c)},'instock':{'$first':_0x492409(0x1cb)},'primary_code':{'$first':_0x492409(0x22b)},'secondary_code':{'$first':_0x492409(0x1f9)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x492409(0x1cd)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x492409(0x1b4)},'secondary_unit':{'$first':_0x492409(0x193)},'storage':{'$first':_0x492409(0x21a)},'rack':{'$first':_0x492409(0x213)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x492409(0x24d)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x492409(0x19c)},'roomNamed':{'$first':_0x492409(0x1b9)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x492409(0x212)}}}]),_0x231b5e=await warehouse[_0x492409(0x1d3)]([{'$match':{'name':_0x3273b6,'room':_0x1513e7}},{'$unwind':_0x492409(0x182)},{'$match':{'product_details.secondary_code':_0x10ae6f}},{'$group':{'_id':_0x492409(0x20f),'name':{'$first':_0x492409(0x18c)},'instock':{'$first':_0x492409(0x1cb)},'primary_code':{'$first':_0x492409(0x22b)},'secondary_code':{'$first':_0x492409(0x1f9)},'product_code':{'$first':_0x492409(0x24a)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x492409(0x194)},'type':{'$first':'$product_details.type'},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x492409(0x1b4)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x492409(0x213)},'expiry_date':{'$first':_0x492409(0x1d6)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x492409(0x1bc)},'maxPerUnit':{'$first':_0x492409(0x19c)},'roomNamed':{'$first':_0x492409(0x1b9)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x492409(0x212)}}}]);if(_0x331515[_0x492409(0x205)]>0x0)_0x4f9d64[_0x492409(0x1d4)](_0x331515);else _0x231b5e['length']>0x0&&_0x4f9d64['push'](_0x231b5e);}const _0x2c49a9=_0x3fbdc5[_0x4d16db(0x1d5)](_0xcffa41=>_0x3038c4(_0xcffa41));await Promise[_0x4d16db(0x1ad)](_0x2c49a9),_0x191cfb['json'](_0x4f9d64);}),router['post']('/barcode_scanner2',async(_0x32b006,_0x5df2dd)=>{var _0x262771=a0_0x469054;try{const {FromWareHouse:_0x23f188,FromRoom:_0x59d9c0,ToWarehouse:_0x5a989e,ToRoom:_0x60dde9,secondary_code:_0x557b58}=_0x32b006[_0x262771(0x252)],_0x366882=await warehouse[_0x262771(0x1d3)]([{'$match':{'name':_0x23f188}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x557b58}},{'$group':{'_id':_0x262771(0x20f),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x262771(0x24a)},'instock':{'$first':_0x262771(0x1cb)},'warehouse':{'$first':_0x262771(0x227)},'level':{'$first':_0x262771(0x22e)},'isle':{'$first':_0x262771(0x1b2)},'pallet':{'$first':_0x262771(0x1d1)},'maxProducts':{'$first':_0x262771(0x1a4)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x262771(0x24d)}}}]);_0x5df2dd['status'](0xc8)[_0x262771(0x1eb)](_0x366882);}catch(_0x58d3e9){_0x5df2dd[_0x262771(0x1c9)](0x194)['json']({'message':_0x58d3e9[_0x262771(0x237)]});}}),router[a0_0x469054(0x1b8)](a0_0x469054(0x1e6),async(_0x3f27d4,_0x1965d5)=>{var _0x3f7867=a0_0x469054;try{const {FromWareHouse:_0x50cdb9,FromRoom:_0x203df0,ToWarehouse:_0x12514d,ToRoom:_0x195eaa,product_code:_0x29bc0d}=_0x3f27d4['body'],_0x536571=await warehouse[_0x3f7867(0x1d3)]([{'$match':{'name':_0x50cdb9}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x29bc0d}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x3f7867(0x22b)},'secondary_code':{'$first':_0x3f7867(0x1f9)},'product_code':{'$first':_0x3f7867(0x24a)},'instock':{'$first':_0x3f7867(0x1cb)},'warehouse':{'$first':_0x3f7867(0x227)},'level':{'$first':_0x3f7867(0x22e)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x3f7867(0x1d1)},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x3f7867(0x1b4)}}}]);_0x1965d5[_0x3f7867(0x1c9)](0xc8)[_0x3f7867(0x1eb)](_0x536571);}catch(_0x3eb630){_0x1965d5[_0x3f7867(0x1c9)](0x194)[_0x3f7867(0x1eb)]({'message':_0x3eb630['message']});}}),router[a0_0x469054(0x1b8)](a0_0x469054(0x1c0),async(_0x25354e,_0x2955a2)=>{var _0x2e96ee=a0_0x469054;const {productCode:_0x1b8c52,bay:_0x27a0c5,warehouses:_0x321bc8,room:_0x5efb8f}=_0x25354e['body'];console[_0x2e96ee(0x1dd)](_0x25354e[_0x2e96ee(0x252)]);try{const _0x306330=await warehouse[_0x2e96ee(0x1d3)]([{'$match':{'name':_0x321bc8,'room':_0x5efb8f}},{'$unwind':_0x2e96ee(0x182)},{'$match':{'product_details.bay':parseInt(_0x27a0c5)}},{'$group':{'_id':_0x2e96ee(0x20f),'name':{'$first':_0x2e96ee(0x18c)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x2955a2[_0x2e96ee(0x1c9)](0xc8)[_0x2e96ee(0x1eb)](_0x306330);}catch(_0x707b29){_0x2955a2[_0x2e96ee(0x1c9)](0x194)[_0x2e96ee(0x1eb)]({'message':_0x707b29['message']});}}),module[a0_0x469054(0x18f)]=router;