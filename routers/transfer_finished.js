var a0_0x5b968c=a0_0x54bc;(function(_0x1c33d6,_0xcc2e21){var _0x1e7a62=a0_0x54bc,_0x3e88e0=_0x1c33d6();while(!![]){try{var _0x1f7862=parseInt(_0x1e7a62(0x145))/0x1+parseInt(_0x1e7a62(0x119))/0x2*(parseInt(_0x1e7a62(0x10f))/0x3)+-parseInt(_0x1e7a62(0x115))/0x4*(parseInt(_0x1e7a62(0xfc))/0x5)+parseInt(_0x1e7a62(0xc9))/0x6+parseInt(_0x1e7a62(0xb6))/0x7+-parseInt(_0x1e7a62(0xe9))/0x8+-parseInt(_0x1e7a62(0xb8))/0x9;if(_0x1f7862===_0xcc2e21)break;else _0x3e88e0['push'](_0x3e88e0['shift']());}catch(_0x4b356d){_0x3e88e0['push'](_0x3e88e0['shift']());}}}(a0_0x24ae,0xa6eeb));const express=require(a0_0x5b968c(0x124)),app=express(),router=express[a0_0x5b968c(0xeb)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x5b968c(0xfb)),auth=require(a0_0x5b968c(0xa0)),users=require(a0_0x5b968c(0x9d)),nodemailer=require(a0_0x5b968c(0x11d));router[a0_0x5b968c(0x11e)](a0_0x5b968c(0x146),auth,async(_0x4028c9,_0x728705)=>{var _0x5a39be=a0_0x5b968c;try{const {username:_0x2fe408,email:_0x16b90b,role:_0x260076}=_0x4028c9[_0x5a39be(0x13e)],_0xbda419=_0x4028c9[_0x5a39be(0x13e)],_0x1d794c=await profile[_0x5a39be(0xef)]({'email':_0xbda419[_0x5a39be(0xf7)]}),_0x3e9e7d=await master_shop[_0x5a39be(0xc1)]();let _0x5f2e6b;if(_0xbda419[_0x5a39be(0xf4)]==_0x5a39be(0x168)){const _0x52bcf4=await staff[_0x5a39be(0xef)]({'email':_0xbda419[_0x5a39be(0xf7)]});_0x5f2e6b=await transfers_finished[_0x5a39be(0xc1)]({'from_warehouse':_0x52bcf4[_0x5a39be(0x123)]});}else _0x5f2e6b=await transfers_finished[_0x5a39be(0xbc)]([{'$unwind':_0x5a39be(0xa6)},{'$group':{'_id':_0x5a39be(0x13d),'invoice':{'$first':_0x5a39be(0xa7)},'date':{'$first':_0x5a39be(0x137)},'from_warehouse':{'$first':_0x5a39be(0x133)},'to_warehouse':{'$first':_0x5a39be(0xf3)},'from_room_name':{'$addToSet':_0x5a39be(0x117)},'to_room_name':{'$addToSet':_0x5a39be(0x129)},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3e9e7d[0x0][_0x5a39be(0x138)]==_0x5a39be(0xcb))var _0x3d1f26=users[_0x5a39be(0x132)];else{if(_0x3e9e7d[0x0][_0x5a39be(0x138)]==_0x5a39be(0x128))var _0x3d1f26=users['Hindi'];else{if(_0x3e9e7d[0x0][_0x5a39be(0x138)]==_0x5a39be(0xc5))var _0x3d1f26=users[_0x5a39be(0xc5)];else{if(_0x3e9e7d[0x0][_0x5a39be(0x138)]=='Spanish')var _0x3d1f26=users[_0x5a39be(0xe0)];else{if(_0x3e9e7d[0x0]['language']==_0x5a39be(0x15f))var _0x3d1f26=users['French'];else{if(_0x3e9e7d[0x0][_0x5a39be(0x138)]==_0x5a39be(0x156))var _0x3d1f26=users['Portuguese'];else{if(_0x3e9e7d[0x0]['language']==_0x5a39be(0x11b))var _0x3d1f26=users[_0x5a39be(0x11b)];else{if(_0x3e9e7d[0x0][_0x5a39be(0x138)]==_0x5a39be(0xd1))var _0x3d1f26=users[_0x5a39be(0xe5)];}}}}}}}_0x728705[_0x5a39be(0x12b)]('transfer_finished',{'success':_0x4028c9['flash']('success'),'errors':_0x4028c9[_0x5a39be(0x9e)](_0x5a39be(0xaf)),'role':_0xbda419,'profile':_0x1d794c,'master_shop':_0x3e9e7d,'transfer':_0x5f2e6b,'language':_0x3d1f26});}catch(_0x321f37){console[_0x5a39be(0x164)](_0x321f37);}});function a0_0x54bc(_0x274ace,_0xef1438){var _0x24ae2a=a0_0x24ae();return a0_0x54bc=function(_0x54bcb9,_0x5337c8){_0x54bcb9=_0x54bcb9-0x96;var _0x3116ce=_0x24ae2a[_0x54bcb9];return _0x3116ce;},a0_0x54bc(_0x274ace,_0xef1438);}async function getRandom8DigitNumber(){var _0x53b985=a0_0x5b968c;const _0x233c85=0x989680,_0x3fccc8=0x5f5e0ff,_0x123c1c=Math['floor'](Math[_0x53b985(0x109)]()*(_0x3fccc8-_0x233c85+0x1))+_0x233c85;var _0x1e51c4;const _0x4513f3=await transfers_finished[_0x53b985(0xef)]({'invoice':_0x53b985(0x100)+_0x123c1c});return _0x4513f3&&_0x4513f3[_0x53b985(0x126)]>0x0?_0x1e51c4=_0x53b985(0x100)+_0x123c1c:_0x1e51c4=_0x53b985(0x100)+_0x123c1c,_0x1e51c4;}router['get'](a0_0x5b968c(0xf9),auth,async(_0x5f21e2,_0x516d8c)=>{var _0x167cb3=a0_0x5b968c;try{const {username:_0x4565b1,email:_0x402321,role:_0x223a89}=_0x5f21e2[_0x167cb3(0x13e)],_0x549ad5=_0x5f21e2['user'],_0xcf2959=await profile['findOne']({'email':_0x549ad5[_0x167cb3(0xf7)]}),_0x4116e7=await master_shop[_0x167cb3(0xc1)]();let _0x284a3d;if(_0x549ad5[_0x167cb3(0xf4)]=='staff'){const _0x35aa48=await staff['findOne']({'email':_0x549ad5[_0x167cb3(0xf7)]});_0x284a3d=await warehouse[_0x167cb3(0xbc)]([{'$match':{'status':_0x167cb3(0x147),'name':_0x35aa48['warehouse'],'warehouse_category':_0x167cb3(0xa2),'name':{'$ne':_0x167cb3(0xae)}}},{'$group':{'_id':_0x167cb3(0x14b),'name':{'$first':'$name'}}}]);}else _0x284a3d=await warehouse[_0x167cb3(0xbc)]([{'$match':{'status':_0x167cb3(0x147),'warehouse_category':_0x167cb3(0xa2),'name':{'$ne':_0x167cb3(0xae)}}},{'$group':{'_id':_0x167cb3(0x14b),'name':{'$first':_0x167cb3(0x14b)}}}]);const _0x1b5b82=await transfers_finished['find']({}),_0x1781ff=_0x1b5b82[_0x167cb3(0x126)]+0x1,_0x38c5bb='TRFF-'+_0x1781ff[_0x167cb3(0x151)]()[_0x167cb3(0xdf)](0x5,'0');if(_0x4116e7[0x0]['language']==_0x167cb3(0xcb))var _0xfa5b5e=users[_0x167cb3(0x132)];else{if(_0x4116e7[0x0][_0x167cb3(0x138)]==_0x167cb3(0x128))var _0xfa5b5e=users[_0x167cb3(0x128)];else{if(_0x4116e7[0x0]['language']==_0x167cb3(0xc5))var _0xfa5b5e=users[_0x167cb3(0xc5)];else{if(_0x4116e7[0x0]['language']==_0x167cb3(0xe0))var _0xfa5b5e=users['Spanish'];else{if(_0x4116e7[0x0][_0x167cb3(0x138)]==_0x167cb3(0x15f))var _0xfa5b5e=users['French'];else{if(_0x4116e7[0x0][_0x167cb3(0x138)]==_0x167cb3(0x156))var _0xfa5b5e=users['Portuguese'];else{if(_0x4116e7[0x0][_0x167cb3(0x138)]=='Chinese')var _0xfa5b5e=users[_0x167cb3(0x11b)];else{if(_0x4116e7[0x0][_0x167cb3(0x138)]==_0x167cb3(0xd1))var _0xfa5b5e=users[_0x167cb3(0xe5)];}}}}}}}const _0x2f59a5=getRandom8DigitNumber();_0x2f59a5[_0x167cb3(0x108)](_0x1e6f90=>{var _0x4a421a=_0x167cb3;_0x516d8c['render'](_0x4a421a(0x167),{'success':_0x5f21e2['flash']('success'),'errors':_0x5f21e2[_0x4a421a(0x9e)]('errors'),'role':_0x549ad5,'profile':_0xcf2959,'master_shop':_0x4116e7,'warehouse':_0x284a3d,'language':_0xfa5b5e,'invoice':_0x1e6f90});})[_0x167cb3(0x152)](_0x2bf084=>{var _0x19588b=_0x167cb3;_0x5f21e2['flash'](_0x19588b(0xaf),_0x19588b(0x16c)),_0x516d8c[_0x19588b(0x13a)](_0x19588b(0x101));});}catch(_0x500021){console[_0x167cb3(0x164)](_0x500021);}}),router[a0_0x5b968c(0xd8)](a0_0x5b968c(0xf9),auth,async(_0x737186,_0x20ccd6)=>{var _0x506bef=a0_0x5b968c;try{const {date:_0x5be82f,from_warehouse:_0x47ff0a,FromRoom_name:_0x350c30,to_warehouse:_0xc51739,ToRoom_name:_0x2e7742,prod_name:_0x12c203,from_prod_qty:_0x57142d,from_prod_level:_0x21fb75,from_prod_isle:_0x2d8f82,from_prod_pallet:_0x2baa79,to_prod_qty:_0x571760,to_prod_level:_0x264ea2,to_prod_isle:_0x3dfc1c,to_prod_pallet:_0x5d726f,primary_code:_0x1765f7,secondary_code:_0x9a6481,product_code3:_0x384528,note:_0x5af8e8,MaxStocks_data2:_0x2e9aa1,invoice:_0x26b871,expiry_date:_0x839594}=_0x737186[_0x506bef(0xc4)];if(typeof _0x12c203==_0x506bef(0xea))var _0x4441ad=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x16a)]],_0x67d5f1=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x121)]],_0x1c574b=[_0x737186['body']['from_prod_level']],_0x3dace8=[_0x737186[_0x506bef(0xc4)][_0x506bef(0xd9)]],_0x39684a=[_0x737186[_0x506bef(0xc4)][_0x506bef(0xac)]],_0x4677c9=[_0x737186[_0x506bef(0xc4)][_0x506bef(0xa3)]],_0xa84f4b=[_0x737186['body'][_0x506bef(0x12f)]],_0x1cff98=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x11a)]],_0x25f024=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x15b)]],_0x358998=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x144)]],_0x2ce11a=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x111)]],_0x416133=[_0x737186[_0x506bef(0xc4)]['batch_code']],_0x5d2ed8=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x98)]],_0x124f9f=[_0x737186[_0x506bef(0xc4)]['product_date']],_0x356ba6=[_0x737186[_0x506bef(0xc4)][_0x506bef(0xc8)]],_0x1f78de=[_0x737186['body'][_0x506bef(0x11c)]],_0x55ce9f=[_0x737186['body'][_0x506bef(0xc3)]],_0x425b38=[_0x737186[_0x506bef(0xc4)][_0x506bef(0xa4)]],_0x865943=[_0x737186['body'][_0x506bef(0xec)]],_0x5000ba=[_0x737186[_0x506bef(0xc4)][_0x506bef(0xcc)]],_0x516138=[_0x737186[_0x506bef(0xc4)][_0x506bef(0x141)]];else var _0x4441ad=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x16a)]],_0x67d5f1=[..._0x737186[_0x506bef(0xc4)]['from_prod_qty']],_0x1c574b=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x122)]],_0x3dace8=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0xd9)]],_0x39684a=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0xac)]],_0x4677c9=[..._0x737186[_0x506bef(0xc4)]['primary_code']],_0xa84f4b=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x12f)]],_0x1cff98=[..._0x737186[_0x506bef(0xc4)]['product_code3']],_0x25f024=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x15b)]],_0x358998=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x144)]],_0x2ce11a=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x111)]],_0x416133=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x16e)]],_0x5d2ed8=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x98)]],_0x124f9f=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x163)]],_0x356ba6=[..._0x737186[_0x506bef(0xc4)]['MaxStocks_data']],_0x1f78de=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0x11c)]],_0x55ce9f=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0xc3)]],_0x425b38=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0xa4)]],_0x865943=[..._0x737186[_0x506bef(0xc4)]['ToRoomAssigned']],_0x5000ba=[..._0x737186[_0x506bef(0xc4)][_0x506bef(0xcc)]],_0x516138=[..._0x737186['body'][_0x506bef(0x141)]];const _0xb9a80=_0x4441ad[_0x506bef(0x15e)](_0x10bee8=>{return _0x10bee8={'product_name':_0x10bee8};});_0x67d5f1[_0x506bef(0x113)]((_0xeb75f3,_0x407a89)=>{_0xb9a80[_0x407a89]['from_quantity']=_0xeb75f3;}),_0x1c574b[_0x506bef(0x113)]((_0x36963a,_0x59f853)=>{var _0xa82061=_0x506bef;_0xb9a80[_0x59f853][_0xa82061(0xca)]=_0x36963a;}),_0x5000ba[_0x506bef(0x113)]((_0x3b83f1,_0x21eba9)=>{var _0x4fd1f8=_0x506bef;_0xb9a80[_0x21eba9][_0x4fd1f8(0xcc)]=_0x3b83f1;}),_0x516138[_0x506bef(0x113)]((_0x5ced64,_0x3112a8)=>{var _0x5aa39c=_0x506bef;_0xb9a80[_0x3112a8][_0x5aa39c(0xd4)]=_0x5ced64;}),_0x3dace8[_0x506bef(0x113)]((_0x352a7a,_0x11b5b2)=>{var _0x1641ce=_0x506bef;_0xb9a80[_0x11b5b2][_0x1641ce(0xbe)]=_0x352a7a;}),_0x39684a[_0x506bef(0x113)]((_0x56bb60,_0x42c015)=>{var _0x5680fc=_0x506bef;_0xb9a80[_0x42c015][_0x5680fc(0xd7)]=_0x56bb60;}),_0x4677c9[_0x506bef(0x113)]((_0x23f19f,_0x443fa0)=>{var _0x509fac=_0x506bef;_0xb9a80[_0x443fa0][_0x509fac(0xa3)]=_0x23f19f;}),_0xa84f4b[_0x506bef(0x113)]((_0x5330b8,_0x181540)=>{_0xb9a80[_0x181540]['secondary_code']=_0x5330b8;}),_0x1cff98[_0x506bef(0x113)]((_0x3b48cf,_0x3d18c0)=>{var _0x1a240b=_0x506bef;_0xb9a80[_0x3d18c0][_0x1a240b(0xb1)]=_0x3b48cf;}),_0x25f024[_0x506bef(0x113)]((_0x1b29f8,_0x43d4b0)=>{_0xb9a80[_0x43d4b0]['maxProducts']=_0x1b29f8;}),_0x358998[_0x506bef(0x113)]((_0x5d9fcc,_0x4dff49)=>{var _0x4ecf63=_0x506bef;_0xb9a80[_0x4dff49][_0x4ecf63(0x13b)]=_0x5d9fcc;}),_0x2ce11a[_0x506bef(0x113)]((_0xd415b7,_0x2ed055)=>{var _0x569585=_0x506bef;_0xb9a80[_0x2ed055][_0x569585(0x111)]=_0xd415b7;}),_0x416133[_0x506bef(0x113)]((_0x225462,_0x395296)=>{_0xb9a80[_0x395296]['batch_code']=_0x225462;}),_0x5d2ed8[_0x506bef(0x113)]((_0x2b4145,_0x49d5f2)=>{var _0x3a4f7f=_0x506bef;_0xb9a80[_0x49d5f2][_0x3a4f7f(0x98)]=_0x2b4145;}),_0x124f9f['forEach']((_0x1a9ff6,_0x11049f)=>{_0xb9a80[_0x11049f]['production_date']=_0x1a9ff6;}),_0x356ba6[_0x506bef(0x113)]((_0x223195,_0x5d0ca4)=>{_0xb9a80[_0x5d0ca4]['maxProducts']=_0x223195;}),_0x1f78de[_0x506bef(0x113)]((_0xd65701,_0x51613c)=>{var _0x31f626=_0x506bef;_0xb9a80[_0x51613c][_0x31f626(0x11c)]=_0xd65701;}),_0x55ce9f[_0x506bef(0x113)]((_0x11e0d4,_0x5ab5b7)=>{_0xb9a80[_0x5ab5b7]['prod_cat']=_0x11e0d4;}),_0x425b38[_0x506bef(0x113)]((_0x8f4d5f,_0x9027bd)=>{var _0xc4d96f=_0x506bef;_0xb9a80[_0x9027bd][_0xc4d96f(0xe6)]=_0x8f4d5f;}),_0x865943[_0x506bef(0x113)]((_0x32157c,_0x427cd4)=>{var _0x30bca5=_0x506bef;_0xb9a80[_0x427cd4][_0x30bca5(0xd0)]=_0x32157c;});const _0x2463df=_0xb9a80[_0x506bef(0x16d)](_0x8c15bd=>_0x8c15bd[_0x506bef(0xbe)]!=='0'&&_0x8c15bd[_0x506bef(0xbe)]!==''||_0x8c15bd['to_floorlevel']!=='0'&&_0x8c15bd[_0x506bef(0xe7)]!=='');var _0x625ec1=0x0;_0x2463df['forEach'](_0x26d170=>{var _0xe3a3d2=_0x506bef;parseInt(_0x26d170[_0xe3a3d2(0xb4)])<parseInt(_0x26d170[_0xe3a3d2(0xbe)])&&_0x625ec1++;});if(_0x625ec1!=0x0)return _0x737186['flash'](_0x506bef(0xaf),_0x506bef(0xd5)),_0x20ccd6[_0x506bef(0x13a)](_0x506bef(0xed));const _0x7608aa=new transfers_finished({'date':_0x5be82f,'from_warehouse':_0x47ff0a,'to_warehouse':_0xc51739,'product':_0x2463df,'note':_0x5af8e8,'invoice':_0x26b871}),_0x327a3c=await _0x7608aa[_0x506bef(0x10a)]();_0x737186[_0x506bef(0x9e)]('success',_0x506bef(0x134)),_0x20ccd6[_0x506bef(0x13a)](_0x506bef(0x159)+_0x327a3c[_0x506bef(0xfd)]);}catch(_0x3c7a3c){console['log'](_0x3c7a3c),_0x20ccd6[_0x506bef(0xbd)](0xc8)[_0x506bef(0xf1)]({'errorMessage':_0x3c7a3c[_0x506bef(0x149)]});}}),router[a0_0x5b968c(0x11e)]('/preview/:id',auth,async(_0x3fc34b,_0x313375)=>{var _0x341465=a0_0x5b968c;try{const {username:_0x36bf8c,email:_0x4922b7,role:_0x6d395c}=_0x3fc34b['user'],_0x31c290=_0x3fc34b['user'],_0x3ec4e5=await profile['findOne']({'email':_0x31c290[_0x341465(0xf7)]}),_0x327b56=await master_shop['find'](),_0x39a533=await transfers_finished[_0x341465(0x150)](_0x3fc34b[_0x341465(0xff)]['id']);let _0x224d1e;if(_0x31c290[_0x341465(0xf4)]==_0x341465(0x168)){const _0xbcd5fb=await staff[_0x341465(0xef)]({'email':_0x31c290['email']});_0x224d1e=await warehouse['find']({'status':_0x341465(0x147),'name':_0xbcd5fb[_0x341465(0x123)],'warehouse_category':_0x341465(0xa2)});}else _0x224d1e=await warehouse[_0x341465(0xc1)]({'status':_0x341465(0x147),'warehouse_category':_0x341465(0xa2)});const _0x42ed49=await warehouse[_0x341465(0xbc)]([{'$match':{'name':_0x39a533[_0x341465(0xf0)],'warehouse_category':_0x341465(0xa2)}},{'$unwind':_0x341465(0xa8)},{'$group':{'_id':_0x341465(0x170),'name':{'$first':_0x341465(0xd2)},'product_stock':{'$first':_0x341465(0x14d)},'bay':{'$first':_0x341465(0x112)},'bin':{'$first':_0x341465(0xcf)},'type':{'$first':_0x341465(0x142)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x341465(0x139)},'secondary_code':{'$first':_0x341465(0x103)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x341465(0x10e)},'rack':{'$first':_0x341465(0x114)},'expiry_date':{'$first':_0x341465(0xb0)},'production_date':{'$first':_0x341465(0xc6)},'room':{'$first':_0x341465(0x157)},'warehoue_name':{'$first':'$name'}}}]),_0xde0863=await product[_0x341465(0xc1)]({});if(_0x327b56[0x0][_0x341465(0x138)]=='English\x20(US)'){var _0x1023a5=users[_0x341465(0x132)];console['log'](_0x1023a5);}else{if(_0x327b56[0x0][_0x341465(0x138)]==_0x341465(0x128))var _0x1023a5=users[_0x341465(0x128)];else{if(_0x327b56[0x0][_0x341465(0x138)]==_0x341465(0xc5))var _0x1023a5=users[_0x341465(0xc5)];else{if(_0x327b56[0x0][_0x341465(0x138)]=='Spanish')var _0x1023a5=users[_0x341465(0xe0)];else{if(_0x327b56[0x0]['language']==_0x341465(0x15f))var _0x1023a5=users['French'];else{if(_0x327b56[0x0][_0x341465(0x138)]=='Portuguese\x20(BR)')var _0x1023a5=users[_0x341465(0x13c)];else{if(_0x327b56[0x0][_0x341465(0x138)]=='Chinese')var _0x1023a5=users[_0x341465(0x11b)];else{if(_0x327b56[0x0][_0x341465(0x138)]==_0x341465(0xd1))var _0x1023a5=users['Arabic'];}}}}}}}_0x313375[_0x341465(0x12b)](_0x341465(0x12c),{'success':_0x3fc34b['flash'](_0x341465(0xc0)),'errors':_0x3fc34b[_0x341465(0x9e)](_0x341465(0xaf)),'role':_0x31c290,'profile':_0x3ec4e5,'master_shop':_0x327b56,'warehouse':_0x224d1e,'transfer':_0x39a533,'stock':_0x42ed49,'unit':_0xde0863,'language':_0x1023a5});}catch(_0x4c1adc){console[_0x341465(0x164)](_0x4c1adc);}}),router[a0_0x5b968c(0xd8)](a0_0x5b968c(0x130),auth,async(_0x3c69eb,_0x3344df)=>{var _0x5d5cc2=a0_0x5b968c;try{const {invoice:_0x381fed,from_warehouse:_0x31c3ac,FromRoom_name:_0x3ea95d,to_warehouse:_0x92b038,ToRoom_name:_0x2fabf0}=_0x3c69eb['body'],_0x1fdc2a=await transfers_finished[_0x5d5cc2(0x150)](_0x3c69eb['params']['id']),_0x42cc2a=_0x1fdc2a[_0x5d5cc2(0x14e)][_0x5d5cc2(0x15e)](async _0x20cd73=>{var _0x3fb956=_0x5d5cc2;if(_0x20cd73[_0x3fb956(0xbe)]>0x0){var _0x1afb24=await warehouse[_0x3fb956(0xef)]({'name':_0x31c3ac,'room':_0x20cd73[_0x3fb956(0xe6)],'warehouse_category':_0x3fb956(0xa2)});const _0x1d9370=_0x1afb24[_0x3fb956(0x14a)][_0x3fb956(0x15e)](_0x35ba3f=>{var _0x1182ce=_0x3fb956;_0x35ba3f[_0x1182ce(0xc2)]==_0x20cd73[_0x1182ce(0xc2)]&&_0x35ba3f['bay']==_0x20cd73[_0x1182ce(0xca)]&&_0x35ba3f['expiry_date']==_0x20cd73[_0x1182ce(0x98)]&&_0x35ba3f[_0x1182ce(0xd6)]==_0x20cd73['production_date']&&_0x35ba3f['batch_code']==_0x20cd73['batch_code']&&_0x35ba3f[_0x1182ce(0x12e)]==_0x20cd73[_0x1182ce(0xcc)]&&(_0x35ba3f[_0x1182ce(0x12d)]=_0x35ba3f[_0x1182ce(0x12d)]-_0x20cd73[_0x1182ce(0xbe)]);});}return _0x1afb24;});Promise[_0x5d5cc2(0x15d)](_0x42cc2a)['then'](async _0x15427d=>{var _0x72a3de=_0x5d5cc2;try{for(const _0x3b83ee of _0x15427d){await _0x3b83ee['save']();}const _0x1f21b1=_0x1fdc2a[_0x72a3de(0x14e)][_0x72a3de(0x15e)](async _0x367606=>{var _0x19aee8=_0x72a3de,_0x26a78f=await warehouse[_0x19aee8(0xef)]({'name':_0x92b038,'room':_0x367606[_0x19aee8(0xd0)]});if(_0x367606[_0x19aee8(0xbe)]>0x0){var _0x10b665=0x0;const _0x73f2cf=_0x26a78f[_0x19aee8(0x14a)][_0x19aee8(0x15e)](_0x466670=>{var _0x18c4b7=_0x19aee8;_0x466670[_0x18c4b7(0xc2)]==_0x367606['product_name']&&_0x466670['bay']==_0x367606[_0x18c4b7(0xd7)]&&_0x466670[_0x18c4b7(0x98)]==_0x367606[_0x18c4b7(0x98)]&&_0x466670[_0x18c4b7(0xd6)]==_0x367606[_0x18c4b7(0xd6)]&&_0x466670[_0x18c4b7(0x16e)]==_0x367606[_0x18c4b7(0x16e)]&&_0x466670['invoice']==_0x367606['To_invoice']&&(_0x466670['product_stock']=_0x466670[_0x18c4b7(0x12d)]+_0x367606[_0x18c4b7(0xbe)],_0x10b665++);});_0x10b665=='0'&&(_0x26a78f[_0x19aee8(0x14a)]=_0x26a78f[_0x19aee8(0x14a)]['concat']({'product_name':_0x367606[_0x19aee8(0xc2)],'product_stock':_0x367606[_0x19aee8(0xbe)],'bay':_0x367606[_0x19aee8(0xd7)],'product_code':_0x367606[_0x19aee8(0xb1)],'primary_code':_0x367606[_0x19aee8(0xa3)],'secondary_code':_0x367606[_0x19aee8(0x12f)],'expiry_date':_0x367606[_0x19aee8(0x98)],'production_date':_0x367606[_0x19aee8(0xd6)],'maxProducts':_0x367606[_0x19aee8(0xa5)],'batch_code':_0x367606[_0x19aee8(0x16e)],'secondary_unit':_0x367606['secondary_unit'],'unit':_0x367606['unit'],'maxProducts':_0x367606[_0x19aee8(0xa5)],'maxPerUnit':_0x367606[_0x19aee8(0x11c)],'invoice':_0x367606[_0x19aee8(0xd4)]}));}return _0x26a78f;});Promise[_0x72a3de(0x15d)](_0x1f21b1)[_0x72a3de(0x108)](async _0x20c5c3=>{var _0x91fc3e=_0x72a3de;try{for(const _0x127894 of _0x20c5c3){await warehouse[_0x91fc3e(0xad)]({'_id':_0x127894[_0x91fc3e(0xfd)]},{'$addToSet':{'product_details':{'$each':_0x127894[_0x91fc3e(0x14a)]}}});}_0x1fdc2a[_0x91fc3e(0x110)]=_0x91fc3e(0xda);const _0x586632=await _0x1fdc2a[_0x91fc3e(0x10a)](),_0x3f9e26=await master_shop[_0x91fc3e(0xc1)](),_0x248a5b=await email_settings[_0x91fc3e(0xef)](),_0x36d4ea=await supervisor_settings[_0x91fc3e(0xc1)]();var _0x24a8ec=_0x1fdc2a[_0x91fc3e(0x14e)],_0x141712='',_0x4d38a0;for(_0x4d38a0 in _0x24a8ec){var _0x15d3b6='FG';_0x1fdc2a['to_warehouse']==_0x91fc3e(0x99)&&(_0x15d3b6='DG'),_0x141712+=_0x91fc3e(0x166)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24a8ec[_0x4d38a0][_0x91fc3e(0xc2)]+'</td>'+_0x91fc3e(0x97)+_0x24a8ec[_0x4d38a0][_0x91fc3e(0xb1)]+_0x91fc3e(0x11f)+_0x91fc3e(0x97)+_0x24a8ec[_0x4d38a0][_0x91fc3e(0xbe)]+_0x91fc3e(0x11f)+_0x91fc3e(0x97)+_0x24a8ec[_0x4d38a0][_0x91fc3e(0x13b)]+'</td>'+_0x91fc3e(0x97)+_0x24a8ec[_0x4d38a0][_0x91fc3e(0x111)]+_0x91fc3e(0x11f)+_0x91fc3e(0x97)+_0x1fdc2a[_0x91fc3e(0x116)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x24a8ec[_0x4d38a0]['to_room_name']+_0x91fc3e(0x11f)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x15d3b6+_0x24a8ec[_0x4d38a0][_0x91fc3e(0xd7)]+'</td>'+'</tr>';}let _0x40bbd0=nodemailer[_0x91fc3e(0x16f)]({'host':_0x248a5b[_0x91fc3e(0x154)],'port':Number(_0x248a5b['port']),'secure':![],'auth':{'user':_0x248a5b['email'],'pass':_0x248a5b['password']}}),_0xb2a047={'from':_0x248a5b[_0x91fc3e(0xf7)],'to':_0x36d4ea[0x0][_0x91fc3e(0x104)],'subject':_0x91fc3e(0xee),'attachments':[{'filename':_0x91fc3e(0xfe),'path':__dirname+_0x91fc3e(0xa9)+'/upload/'+_0x3f9e26[0x0][_0x91fc3e(0xb2)],'cid':_0x91fc3e(0x169)}],'html':_0x91fc3e(0x12a)+_0x91fc3e(0x107)+'</head><body>'+_0x91fc3e(0x96)+_0x91fc3e(0xf2)+_0x91fc3e(0x96)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x91fc3e(0x15a)+_0x91fc3e(0x96)+_0x91fc3e(0x135)+_0x3f9e26[0x0]['site_title']+_0x91fc3e(0x10d)+_0x91fc3e(0x15a)+_0x91fc3e(0x15a)+_0x91fc3e(0xcd)+_0x91fc3e(0x96)+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x1fdc2a['invoice']+'\x20'+_0x91fc3e(0x10b)+'\x20Order\x20Date\x20:\x20'+_0x1fdc2a[_0x91fc3e(0xb9)]+'\x20'+_0x91fc3e(0xe1)+_0x91fc3e(0x136)+_0x91fc3e(0x15a)+_0x91fc3e(0xe8)+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x91fc3e(0x166)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x91fc3e(0xba)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x91fc3e(0xf6)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x91fc3e(0x13f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>'+_0x91fc3e(0xf5)+_0x91fc3e(0x9f)+_0x91fc3e(0x14f)+'\x20'+_0x141712+'\x20'+'</tbody>'+_0x91fc3e(0x131)+_0x91fc3e(0x96)+_0x91fc3e(0x16b)+_0x91fc3e(0x155)+_0x3f9e26[0x0][_0x91fc3e(0x160)]+_0x91fc3e(0x136)+'</div>'+'</div>'+_0x91fc3e(0xaa)};_0x40bbd0[_0x91fc3e(0x14c)](_0xb2a047,function(_0x161a3e,_0x36545f){var _0x4f5dd7=_0x91fc3e;_0x161a3e?(console[_0x4f5dd7(0x164)](_0x161a3e),console[_0x4f5dd7(0x164)](_0x4f5dd7(0x102))):console[_0x4f5dd7(0x164)](_0x4f5dd7(0xb7));}),_0x3c69eb[_0x91fc3e(0x9e)]('success',_0x91fc3e(0xfa)),_0x3344df[_0x91fc3e(0x13a)](_0x91fc3e(0xe4)+_0x586632[_0x91fc3e(0xfd)]);}catch(_0x5e73bb){console['error'](_0x5e73bb),_0x3344df[_0x91fc3e(0xbd)](0x1f4)[_0x91fc3e(0xf1)]({'error':'To\x20An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x72a3de(0x152)](_0x457174=>{var _0x356fc5=_0x72a3de;console[_0x356fc5(0xab)](_0x457174),_0x3344df[_0x356fc5(0xbd)](0x1f4)[_0x356fc5(0xf1)]({'error':_0x356fc5(0x106)});});}catch(_0x2c479e){console[_0x72a3de(0xab)](_0x2c479e),_0x3344df[_0x72a3de(0xbd)](0x1f4)['json']({'error':_0x72a3de(0x105)});}})['catch'](_0x3aaaac=>{var _0x4e0f1a=_0x5d5cc2;console[_0x4e0f1a(0xab)](_0x3aaaac),_0x3344df[_0x4e0f1a(0xbd)](0x1f4)[_0x4e0f1a(0xf1)]({'error':_0x4e0f1a(0x106)});});}catch(_0x5767e6){_0x3344df[_0x5d5cc2(0xf1)]({'message':_0x5767e6[_0x5d5cc2(0x149)]});}});function BayBinSelected(_0x323317,_0x4210e1){var _0x1f1c10=a0_0x5b968c,_0x2e4a38=[];let _0x2da4b3=[];var _0x445395=[];if(_0x323317==_0x1f1c10(0x99)){switch(_0x4210e1){case _0x1f1c10(0xb3):_0x2e4a38=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x2e4a38=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x445395=['DG'];}else{if(_0x323317==_0x1f1c10(0xb5)){switch(_0x4210e1){case'Rack\x201':_0x2e4a38=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x1f1c10(0x118):_0x2e4a38=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x445395=['FG'];}}return{'levels':_0x2e4a38,'identify':_0x445395};}router[a0_0x5b968c(0x11e)]('/view/:id',auth,async(_0x309b81,_0x40d4f4)=>{var _0x1e5516=a0_0x5b968c;try{const {username:_0x1a0e1c,email:_0x240ccd,role:_0x43faeb}=_0x309b81['user'],_0x2e86dd=_0x309b81[_0x1e5516(0x13e)],_0x350501=await profile['findOne']({'email':_0x2e86dd[_0x1e5516(0xf7)]}),_0x7efed9=await master_shop['find'](),_0xbf83b0=await transfers_finished[_0x1e5516(0x150)](_0x309b81[_0x1e5516(0xff)]['id']);let _0xbdf0ac=new Date(_0xbf83b0[_0x1e5516(0x98)]),_0x2bcfc4=('0'+_0xbdf0ac[_0x1e5516(0x9b)]())[_0x1e5516(0xbb)](-0x2),_0x3cf098=('0'+(_0xbdf0ac['getMonth']()+0x1))[_0x1e5516(0xbb)](-0x2),_0x34dbef=_0xbdf0ac[_0x1e5516(0x148)](),_0x1e08fa=_0x34dbef+'-'+_0x3cf098+'-'+_0x2bcfc4,_0xe7f49d;if(_0x2e86dd[_0x1e5516(0xf4)]==_0x1e5516(0x168)){const _0x4f23fa=await staff[_0x1e5516(0xef)]({'email':_0x2e86dd[_0x1e5516(0xf7)]});_0xe7f49d=await warehouse['find']({'status':_0x1e5516(0x147),'name':_0x4f23fa['warehouse'],'warehouse_category':_0x1e5516(0xa2)});}else _0xe7f49d=await warehouse[_0x1e5516(0xc1)]({'status':'Enabled','warehouse_category':_0x1e5516(0xa2)});const _0x428c4c=await warehouse[_0x1e5516(0xbc)]([{'$match':{'name':_0xbf83b0['from_warehouse'],'room':_0xbf83b0[_0x1e5516(0xf8)]}},{'$unwind':_0x1e5516(0xa8)},{'$group':{'_id':_0x1e5516(0x170),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x1e5516(0x14d)},'bay':{'$first':_0x1e5516(0x112)},'bin':{'$first':_0x1e5516(0xcf)},'type':{'$first':_0x1e5516(0x142)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1e5516(0x139)},'secondary_code':{'$first':_0x1e5516(0x103)},'product_code':{'$first':_0x1e5516(0x127)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x1e5516(0x114)}}}]);var _0x37f2e1=[0x1,0x2,0x3,0x4],_0x2cb4c4=['A','B','C','D','E','F','G','H','I','J'],_0x140002=['Ambient',_0x1e5516(0x120)];const _0x572965=await product[_0x1e5516(0xc1)]({}),_0x5b4737=BayBinSelected(_0xbf83b0['to_warehouse'],_0xbf83b0[_0x1e5516(0x153)]);if(_0x7efed9[0x0][_0x1e5516(0x138)]==_0x1e5516(0xcb)){var _0xe9a04e=users[_0x1e5516(0x132)];console[_0x1e5516(0x164)](_0xe9a04e);}else{if(_0x7efed9[0x0][_0x1e5516(0x138)]=='Hindi')var _0xe9a04e=users[_0x1e5516(0x128)];else{if(_0x7efed9[0x0][_0x1e5516(0x138)]=='German')var _0xe9a04e=users[_0x1e5516(0xc5)];else{if(_0x7efed9[0x0][_0x1e5516(0x138)]=='Spanish')var _0xe9a04e=users[_0x1e5516(0xe0)];else{if(_0x7efed9[0x0][_0x1e5516(0x138)]==_0x1e5516(0x15f))var _0xe9a04e=users[_0x1e5516(0x15f)];else{if(_0x7efed9[0x0][_0x1e5516(0x138)]==_0x1e5516(0x156))var _0xe9a04e=users[_0x1e5516(0x13c)];else{if(_0x7efed9[0x0][_0x1e5516(0x138)]==_0x1e5516(0x11b))var _0xe9a04e=users['Chinese'];else{if(_0x7efed9[0x0]['language']==_0x1e5516(0xd1))var _0xe9a04e=users[_0x1e5516(0xe5)];}}}}}}}_0x40d4f4[_0x1e5516(0x12b)](_0x1e5516(0x162),{'success':_0x309b81['flash'](_0x1e5516(0xc0)),'errors':_0x309b81[_0x1e5516(0x9e)](_0x1e5516(0xaf)),'role':_0x2e86dd,'profile':_0x350501,'master_shop':_0x7efed9,'warehouse':_0xe7f49d,'transfer':_0xbf83b0,'stock':_0x428c4c,'unit':_0x572965,'language':_0xe9a04e,'levels':_0x37f2e1,'Isle':_0x2cb4c4,'rooms_data':_0x140002,'ed_fullDate':_0x1e08fa,'dataSelected':_0x5b4737});}catch(_0x1910d6){console['log'](_0x1910d6);}}),router['post'](a0_0x5b968c(0xc7),auth,async(_0x4687bb,_0x4fbb70)=>{var _0x5253be=a0_0x5b968c;try{const _0x3d17c1=_0x4687bb[_0x5253be(0xff)]['id'];console[_0x5253be(0x164)](_0x4687bb[_0x5253be(0xc4)]);const _0x516c58=await transfers_finished[_0x5253be(0x150)](_0x3d17c1);console[_0x5253be(0x164)](_0x5253be(0xe2),_0x516c58);const {date:_0x190824,from_warehouse:_0xa2e5f4,FromRoom_name:_0x141672,to_warehouse:_0x50d68f,ToRoom_name:_0x51fba9,prod_name:_0x5d2da2,from_prod_qty:_0xce479d,from_prod_level:_0x2d7da3,from_prod_isle:_0x4e63e3,from_prod_pallet:_0x29e790,to_prod_qty:_0x2acabb,to_prod_level:_0x30a308,to_prod_isle:_0xdbc5be,to_prod_pallet:_0x4d81f2,primary_code:_0x340244,secondary_code:_0x29e38e,product_code3:_0x1026d1,note:_0x30fd91,invoice:_0x15d5c8,expiry_date:_0x15368d}=_0x4687bb[_0x5253be(0xc4)];if(typeof _0x5d2da2==_0x5253be(0xea))var _0x1cda0b=[_0x4687bb[_0x5253be(0xc4)]['prod_name']],_0x5a60b0=[_0x4687bb['body'][_0x5253be(0x121)]],_0x50ed5a=[_0x4687bb[_0x5253be(0xc4)][_0x5253be(0x122)]],_0x2b6253=[_0x4687bb[_0x5253be(0xc4)][_0x5253be(0xde)]],_0x456dcb=[_0x4687bb[_0x5253be(0xc4)][_0x5253be(0xac)]],_0x438c58=[_0x4687bb[_0x5253be(0xc4)]['primary_code']],_0x2ef24b=[_0x4687bb['body'][_0x5253be(0x12f)]],_0x560b59=[_0x4687bb[_0x5253be(0xc4)][_0x5253be(0x11a)]],_0xb995d2=[_0x4687bb[_0x5253be(0xc4)][_0x5253be(0x15b)]],_0x10d9e3=[_0x4687bb['body'][_0x5253be(0x13b)]],_0x119430=[_0x4687bb[_0x5253be(0xc4)]['secondary_unit']],_0x5e0d51=[_0x4687bb[_0x5253be(0xc4)][_0x5253be(0x16e)]],_0x57a0ae=[_0x4687bb[_0x5253be(0xc4)][_0x5253be(0x98)]];else var _0x1cda0b=[..._0x4687bb[_0x5253be(0xc4)][_0x5253be(0x16a)]],_0x5a60b0=[..._0x4687bb[_0x5253be(0xc4)][_0x5253be(0x121)]],_0x50ed5a=[..._0x4687bb['body']['from_prod_level']],_0x2b6253=[..._0x4687bb['body']['to_prod_qty']],_0x456dcb=[..._0x4687bb['body'][_0x5253be(0xac)]],_0x438c58=[..._0x4687bb[_0x5253be(0xc4)]['primary_code']],_0x2ef24b=[..._0x4687bb[_0x5253be(0xc4)][_0x5253be(0x12f)]],_0x560b59=[..._0x4687bb['body'][_0x5253be(0x11a)]],_0xb995d2=[..._0x4687bb[_0x5253be(0xc4)]['MaxStocks_data2']],_0x10d9e3=[..._0x4687bb[_0x5253be(0xc4)][_0x5253be(0x13b)]],_0x119430=[..._0x4687bb[_0x5253be(0xc4)][_0x5253be(0x111)]],_0x5e0d51=[..._0x4687bb[_0x5253be(0xc4)][_0x5253be(0x16e)]],_0x57a0ae=[..._0x4687bb[_0x5253be(0xc4)][_0x5253be(0x98)]];const _0x3f9fa7=_0x1cda0b['map'](_0x27d737=>{return _0x27d737={'product_name':_0x27d737};});_0x5a60b0[_0x5253be(0x113)]((_0x132c9c,_0x51ef12)=>{var _0x2de391=_0x5253be;_0x3f9fa7[_0x51ef12][_0x2de391(0xb4)]=_0x132c9c;}),_0x50ed5a['forEach']((_0x406fb4,_0x5b6228)=>{_0x3f9fa7[_0x5b6228]['from_bay']=_0x406fb4;}),_0x2b6253[_0x5253be(0x113)]((_0x398759,_0x335f9a)=>{var _0x3bf692=_0x5253be;_0x3f9fa7[_0x335f9a][_0x3bf692(0xbe)]=_0x398759;}),_0x456dcb[_0x5253be(0x113)]((_0x538354,_0xda5a9e)=>{var _0x823c07=_0x5253be;_0x3f9fa7[_0xda5a9e][_0x823c07(0xd7)]=_0x538354;}),_0x438c58[_0x5253be(0x113)]((_0x75385a,_0x2275be)=>{_0x3f9fa7[_0x2275be]['primary_code']=_0x75385a;}),_0x2ef24b[_0x5253be(0x113)]((_0x5a205a,_0x3f6f1a)=>{var _0x3304dc=_0x5253be;_0x3f9fa7[_0x3f6f1a][_0x3304dc(0x12f)]=_0x5a205a;}),_0x560b59[_0x5253be(0x113)]((_0x259430,_0x3815d0)=>{var _0x3ead72=_0x5253be;_0x3f9fa7[_0x3815d0][_0x3ead72(0xb1)]=_0x259430;}),_0xb995d2[_0x5253be(0x113)]((_0x209be4,_0x3a4a9c)=>{var _0x1b4bef=_0x5253be;_0x3f9fa7[_0x3a4a9c][_0x1b4bef(0xa5)]=_0x209be4;}),_0x10d9e3[_0x5253be(0x113)]((_0x23a711,_0x1a23e7)=>{var _0x599806=_0x5253be;_0x3f9fa7[_0x1a23e7][_0x599806(0x13b)]=_0x23a711;}),_0x119430[_0x5253be(0x113)]((_0x350cab,_0x229505)=>{_0x3f9fa7[_0x229505]['secondary_unit']=_0x350cab;}),_0x5e0d51[_0x5253be(0x113)]((_0x1280fc,_0x161bab)=>{var _0x47b58b=_0x5253be;_0x3f9fa7[_0x161bab][_0x47b58b(0x16e)]=_0x1280fc;}),_0x57a0ae[_0x5253be(0x113)]((_0x549f9d,_0x501509)=>{var _0x437d3f=_0x5253be;_0x3f9fa7[_0x501509][_0x437d3f(0x98)]=_0x549f9d;});const _0x46f047=_0x3f9fa7[_0x5253be(0x16d)](_0x39c033=>_0x39c033[_0x5253be(0xbe)]!=='0'&&_0x39c033[_0x5253be(0xbe)]!==''||_0x39c033['to_floorlevel']!=='0'&&_0x39c033[_0x5253be(0xe7)]!=='');var _0x509600=0x0;_0x46f047[_0x5253be(0x113)](_0x1b55f2=>{var _0x543208=_0x5253be;parseInt(_0x1b55f2[_0x543208(0xb4)])<parseInt(_0x1b55f2[_0x543208(0xbe)])&&_0x509600++;});if(_0x509600!=0x0)return _0x4687bb['flash']('errors',_0x5253be(0xd5)),_0x4fbb70[_0x5253be(0x13a)](_0x5253be(0xed));const _0x4acf64=await warehouse[_0x5253be(0xef)]({'name':_0x516c58[_0x5253be(0xf0)],'room':_0x516c58['from_room']});_0x516c58[_0x5253be(0x14e)][_0x5253be(0x113)](_0x44d46b=>{var _0x38fdb2=_0x5253be;if(_0x44d46b['to_quantity']>0x0){const _0x258757=_0x4acf64[_0x38fdb2(0x14a)]['map'](_0x51674f=>{var _0x4cdba1=_0x38fdb2;_0x51674f['product_name']==_0x44d46b[_0x4cdba1(0xc2)]&&_0x51674f['bay']==_0x44d46b[_0x4cdba1(0xca)]&&(_0x51674f['product_stock']=parseInt(_0x51674f[_0x4cdba1(0x12d)])+parseInt(_0x44d46b[_0x4cdba1(0xbe)]));});}}),await _0x4acf64[_0x5253be(0x10a)]();const _0x588d0a=await warehouse[_0x5253be(0xef)]({'name':_0x516c58['to_warehouse'],'room':_0x516c58['to_room']});_0x516c58[_0x5253be(0x14e)][_0x5253be(0x113)](_0x41e221=>{var _0x2b24ca=_0x5253be;if(_0x41e221['to_quantity']>0x0){const _0x3745d7=_0x588d0a[_0x2b24ca(0x14a)]['map'](_0x21738b=>{var _0x2f869a=_0x2b24ca;_0x21738b[_0x2f869a(0xc2)]==_0x41e221[_0x2f869a(0xc2)]&&_0x21738b['bay']==_0x41e221[_0x2f869a(0xd7)]&&(_0x21738b[_0x2f869a(0x12d)]=parseInt(_0x21738b[_0x2f869a(0x12d)])-parseInt(_0x41e221[_0x2f869a(0xbe)]));});}}),await _0x588d0a[_0x5253be(0x10a)](),_0x516c58[_0x5253be(0xb9)]=_0x190824,_0x516c58['from_warehouse']=_0xa2e5f4,_0x516c58[_0x5253be(0x116)]=_0x50d68f,_0x516c58[_0x5253be(0x14e)]=_0x46f047,_0x516c58[_0x5253be(0xe3)]=_0x30fd91,_0x516c58[_0x5253be(0x12e)]=_0x15d5c8;const _0x4930f0=await _0x516c58[_0x5253be(0x10a)](),_0x5072c9=await warehouse[_0x5253be(0xef)]({'name':_0xa2e5f4,'room':_0x141672});_0x4930f0[_0x5253be(0x14e)][_0x5253be(0x113)](_0x2375d9=>{var _0x1e4717=_0x5253be;if(_0x2375d9[_0x1e4717(0xbe)]>0x0){const _0x13cf1f=_0x5072c9[_0x1e4717(0x14a)][_0x1e4717(0x15e)](_0x1bac36=>{var _0x370baf=_0x1e4717;_0x1bac36['product_name']==_0x2375d9[_0x370baf(0xc2)]&&_0x1bac36[_0x370baf(0xbf)]==_0x2375d9[_0x370baf(0xca)]&&(_0x1bac36[_0x370baf(0x12d)]=parseInt(_0x1bac36[_0x370baf(0x12d)])-parseInt(_0x2375d9[_0x370baf(0xbe)]));});}}),await _0x5072c9[_0x5253be(0x10a)]();const _0x37fa7d=await warehouse[_0x5253be(0xef)]({'name':_0x50d68f,'room':_0x51fba9});_0x4930f0[_0x5253be(0x14e)]['forEach'](_0x3599c4=>{var _0x3c92a6=_0x5253be;if(_0x3599c4['to_quantity']>0x0){var _0x488a40=0x0;const _0x248de1=_0x37fa7d[_0x3c92a6(0x14a)][_0x3c92a6(0x15e)](_0x5f425f=>{var _0x316d74=_0x3c92a6;_0x5f425f['product_name']==_0x3599c4[_0x316d74(0xc2)]&&_0x5f425f['bay']==_0x3599c4[_0x316d74(0xd7)]&&(_0x5f425f[_0x316d74(0x12d)]=parseInt(_0x5f425f[_0x316d74(0x12d)])+parseInt(_0x3599c4[_0x316d74(0xbe)]),_0x488a40++);});_0x488a40=='0'&&(_0x37fa7d['product_details']=_0x37fa7d['product_details'][_0x3c92a6(0x15c)]({'product_name':_0x3599c4[_0x3c92a6(0xc2)],'product_stock':_0x3599c4[_0x3c92a6(0xbe)],'bay':_0x3599c4[_0x3c92a6(0xd7)],'product_code':_0x3599c4[_0x3c92a6(0xb1)],'primary_code':_0x3599c4[_0x3c92a6(0xa3)],'secondary_code':_0x3599c4[_0x3c92a6(0x12f)],'maxProducts':_0x3599c4[_0x3c92a6(0xa5)]}));}}),await _0x37fa7d['save'](),_0x4687bb[_0x5253be(0x9e)](_0x5253be(0xc0),_0x5253be(0xd3)),_0x4fbb70[_0x5253be(0x13a)]('/transfer_finished/view');}catch(_0x3138e3){console[_0x5253be(0x164)](_0x3138e3);}}),router[a0_0x5b968c(0xd8)]('/barcode_scanner',async(_0x21c076,_0x37d9ab)=>{var _0x5e7e4c=a0_0x5b968c;const {FromWareHouse:_0x5eecfe,FromRoom:_0x4d5ca7,ToWarehouse:_0xe06b79,ToRoom:_0x5d137f,primary_code:_0x51ea0b,Roomslist:_0x5000c3}=_0x21c076[_0x5e7e4c(0xc4)],_0xc5dd83=_0x5000c3[_0x5e7e4c(0x140)](','),_0x1c6616=[];async function _0x44ad74(_0x5712cb){var _0x317808=_0x5e7e4c;const _0xaec383=await warehouse['aggregate']([{'$match':{'name':_0x5eecfe,'room':_0x5712cb}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x51ea0b}},{'$group':{'_id':_0x317808(0x170),'name':{'$first':_0x317808(0xd2)},'instock':{'$first':_0x317808(0x14d)},'primary_code':{'$first':_0x317808(0x139)},'secondary_code':{'$first':_0x317808(0x103)},'product_code':{'$first':_0x317808(0x127)},'level':{'$first':_0x317808(0x112)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x317808(0x142)},'pallet':{'$first':_0x317808(0x158)},'unit':{'$first':_0x317808(0xce)},'secondary_unit':{'$first':_0x317808(0x143)},'storage':{'$first':_0x317808(0x10e)},'rack':{'$first':_0x317808(0x114)},'expiry_date':{'$first':_0x317808(0xb0)},'production_date':{'$first':_0x317808(0xc6)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x317808(0x9a)},'roomNamed':{'$first':_0x317808(0x157)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x317808(0x9c)}}}]),_0x17dfba=await warehouse[_0x317808(0xbc)]([{'$match':{'name':_0x5eecfe,'room':_0x5712cb}},{'$unwind':_0x317808(0xa8)},{'$match':{'product_details.secondary_code':_0x51ea0b}},{'$group':{'_id':_0x317808(0x170),'name':{'$first':_0x317808(0xd2)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x317808(0x139)},'secondary_code':{'$first':_0x317808(0x103)},'product_code':{'$first':_0x317808(0x127)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x317808(0xcf)},'type':{'$first':_0x317808(0x142)},'pallet':{'$first':_0x317808(0x158)},'unit':{'$first':_0x317808(0xce)},'secondary_unit':{'$first':_0x317808(0x143)},'storage':{'$first':_0x317808(0x10e)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x317808(0xb0)},'production_date':{'$first':_0x317808(0xc6)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x317808(0x157)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x317808(0x9c)}}}]);if(_0xaec383[_0x317808(0x126)]>0x0)_0x1c6616[_0x317808(0x165)](_0xaec383);else _0x17dfba[_0x317808(0x126)]>0x0&&_0x1c6616['push'](_0x17dfba);}const _0x46f45b=_0xc5dd83['map'](_0x273f10=>_0x44ad74(_0x273f10));await Promise[_0x5e7e4c(0x15d)](_0x46f45b),_0x37d9ab[_0x5e7e4c(0xf1)](_0x1c6616);}),router[a0_0x5b968c(0xd8)](a0_0x5b968c(0x125),async(_0x4e8750,_0x183729)=>{var _0x36eaf8=a0_0x5b968c;try{const {FromWareHouse:_0x3f2a23,FromRoom:_0x572d33,ToWarehouse:_0x4c027f,ToRoom:_0x24df28,secondary_code:_0x37f498}=_0x4e8750[_0x36eaf8(0xc4)],_0x116067=await warehouse[_0x36eaf8(0xbc)]([{'$match':{'name':_0x3f2a23}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x37f498}},{'$group':{'_id':_0x36eaf8(0x170),'name':{'$first':_0x36eaf8(0xd2)},'primary_code':{'$first':_0x36eaf8(0x139)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x36eaf8(0x127)},'instock':{'$first':_0x36eaf8(0x14d)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x36eaf8(0xdc)},'maxProducts':{'$first':_0x36eaf8(0x161)},'unit':{'$first':_0x36eaf8(0xce)},'expiry_date':{'$first':_0x36eaf8(0xb0)},'production_date':{'$first':'$product_details.production_date'}}}]);_0x183729['status'](0xc8)[_0x36eaf8(0xf1)](_0x116067);}catch(_0x3e6f4d){_0x183729['status'](0x194)[_0x36eaf8(0xf1)]({'message':_0x3e6f4d[_0x36eaf8(0x149)]});}}),router[a0_0x5b968c(0xd8)](a0_0x5b968c(0xdb),async(_0x1706be,_0x41f135)=>{var _0xc91796=a0_0x5b968c;try{const {FromWareHouse:_0x4affda,FromRoom:_0x401ec3,ToWarehouse:_0x334e49,ToRoom:_0x1f7f48,product_code:_0x5b4505}=_0x1706be[_0xc91796(0xc4)],_0x352bc0=await warehouse[_0xc91796(0xbc)]([{'$match':{'name':_0x4affda}},{'$unwind':_0xc91796(0xa8)},{'$match':{'product_details.product_code':_0x5b4505}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0xc91796(0x139)},'secondary_code':{'$first':_0xc91796(0x103)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0xc91796(0x14d)},'warehouse':{'$first':_0xc91796(0x14b)},'level':{'$first':_0xc91796(0xdd)},'isle':{'$first':_0xc91796(0x10c)},'pallet':{'$first':_0xc91796(0xdc)},'maxProducts':{'$first':_0xc91796(0x161)},'unit':{'$first':_0xc91796(0xce)}}}]);_0x41f135[_0xc91796(0xbd)](0xc8)['json'](_0x352bc0);}catch(_0x53af56){_0x41f135[_0xc91796(0xbd)](0x194)[_0xc91796(0xf1)]({'message':_0x53af56['message']});}}),router[a0_0x5b968c(0xd8)]('/CheckingWarehouse',async(_0x216a70,_0x37ddfe)=>{var _0x29c40e=a0_0x5b968c;const {productCode:_0x55535e,bay:_0x367767,warehouses:_0x1bd812,room:_0x34d92e}=_0x216a70[_0x29c40e(0xc4)];console[_0x29c40e(0x164)](_0x216a70[_0x29c40e(0xc4)]);try{const _0x4f285=await warehouse[_0x29c40e(0xbc)]([{'$match':{'name':_0x1bd812,'room':_0x34d92e}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x367767)}},{'$group':{'_id':_0x29c40e(0x170),'name':{'$first':_0x29c40e(0xd2)},'product_stock':{'$first':_0x29c40e(0x14d)},'bay':{'$first':_0x29c40e(0x112)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x37ddfe[_0x29c40e(0xbd)](0xc8)[_0x29c40e(0xf1)](_0x4f285);}catch(_0x2d2d81){_0x37ddfe[_0x29c40e(0xbd)](0x194)[_0x29c40e(0xf1)]({'message':_0x2d2d81['message']});}}),module[a0_0x5b968c(0xa1)]=router;function a0_0x24ae(){var _0x229d9e=['2009430dukuHJ','from_bay','English\x20(US)','from_invoice','<hr\x20class=\x22my-3\x22>','$product_details.unit','$product_details.bin','to_room_name','Arabic\x20(ae)','$product_details.product_name','Transfer\x20Edit\x20Successfully','To_invoice','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','production_date','to_bay','post','New_Qty_Converted','True','/barcode_scanner3','$product_details.pallet','$product_details.level','to_prod_qty','padStart','Spanish','</span>','transfer_data','note','/picking_list/PDF_transfer/','Arabic','from_room_name','to_floorlevel','<table\x20style=\x22width:\x20100%\x20!important;\x22>','10649224RVPkzy','string','Router','ToRoomAssigned','back','Transfer\x20Mail','findOne','from_warehouse','json','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$to_warehouse','role','</tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','email','from_room','/view/add_transfer','Transfer\x20Finalize\x20Successfully','../models/all_models','233365YyYLoh','_id','Logo.png','params','TRFF-','/transfer/view','Error\x20Occurs','$product_details.secondary_code','FGSEmail','An\x20error\x20occurred\x20while\x20saving\x20data.','An\x20error\x20occurred.','<html><head><title></title>','then','random','save','<span\x20style=\x22float:\x20right;\x22>','$product_details.isle','\x20</h2>','$product_details.storage','12mIKHLw','finalize','secondary_unit','$product_details.bay','forEach','$product_details.rack','20YDBWTo','to_warehouse','$product.from_room_name','Rack\x202','575480PrBSta','product_code3','Chinese','maxPerUnit','nodemailer','get','</td>','Enclosed','from_prod_qty','from_prod_level','warehouse','express','/barcode_scanner2','length','$product_details.product_code','Hindi','$product.to_room_name','<!DOCTYPE\x20html>','render','edit_transfer_finished_view','product_stock','invoice','secondary_code','/preview/:id','</table>','English','$from_warehouse','Product\x20Transfer\x20successfully','<h2>\x20','</h5>','$date','language','$product_details.primary_code','redirect','unit','Portuguese','$_id','user','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','split','to_invoice','$product_details.type','$product_details.secondary_unit','primary_unit','948086nNnRIn','/view','Enabled','getFullYear','message','product_details','$name','sendMail','$product_details.product_stock','product','<tbody\x20style=\x22text-align:\x20center;\x22>','findById','toString','catch','to_room','host','<h5>','Portuguese\x20(BR)','$room','$product_details.floorlevel','/transfer_finished/preview/','</div>','MaxStocks_data2','concat','all','map','French','site_title','$product_details.maxProducts','edit_transfer_finished','product_date','log','push','<tr>','add_transfer_finished','staff','logo','prod_name','<strong>\x20Regards\x20</strong>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','filter','batch_code','createTransport','$product_details._id','<div>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','expiry_date','DRY\x20GOODS','$product_details.maxPerUnit','getDate','$product_details.invoice','../public/language/languages.json','flash','</thead>','../middleware/auth','exports','Finished\x20Goods','primary_code','RoomAssigned','maxProducts','$product','$invoice','$product_details','/../public','</body></html>','error','to_prod_level','updateOne','QA\x20Warehouse','errors','$product_details.expiry_date','product_code','image','Rack\x201','from_quantity','FROZEN\x20GOODS','7581315XIiVZo','Email\x20sent\x20successfully','11418507sGMqdP','date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','slice','aggregate','status','to_quantity','bay','success','find','product_name','prod_cat','body','German','$product_details.production_date','/view/:id','MaxStocks_data'];a0_0x24ae=function(){return _0x229d9e;};return a0_0x24ae();}