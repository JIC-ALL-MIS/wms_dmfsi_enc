function a0_0x32c0(){var _0x6bb1e3=['<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.maxProducts','Rack\x201','image','$product_details.bay','from_invoice','$product_details','/barcode_scanner','$product_details.rack','secondary_code','Error\x20Occurs','2790AAjMZs','from_warehouse','string','finalize','/view/add_transfer','product_details','to_quantity','toString','$room','$product_details._id','$product_details.secondary_code','maxPerUnit','$product_details.expiry_date','password','$product_details.secondary_unit','</table>','<div>','prod_cat','Portuguese\x20(BR)','</td>','from_bay','email','</tbody>','findOne','invoice','edit_transfer_finished_view','expiry_date','German','product','\x20Order\x20Date\x20:\x20','find','<tbody\x20style=\x22text-align:\x20center;\x22>','to_room_name','length','filter','product_name','all','transfer_data','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','Arabic','/preview/:id','/transfer_finished/preview/','to_floorlevel','$product_details.product_stock','edit_transfer_finished','$product_details.production_date','primary_code','$product_details.maxPerUnit','238916YCsJvG','status','To_invoice','Transfer\x20Mail','maxProducts','FGSEmail','</thead>','from_room','Transfer\x20Finalize\x20Successfully','$product_details.invoice','json','logo','redirect','to_room','</span>','TRFF-','from_prod_qty','<h5\x20style=\x22text-align:\x20left;\x22>','unit','Email\x20sent\x20successfully','staff','/view/:id','params','product_code3','\x20</h2>','ToRoomAssigned','There\x27s\x20a\x20error\x20in\x20this\x20transaction','random','concat','/view','_id','True','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Finished\x20Goods','<!DOCTYPE\x20html>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','$product_details.bin','/barcode_scanner2','$product.from_room_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','MaxStocks_data','push','Spanish','$date','$product_details.storage','New_Qty_Converted','Chinese','../models/all_models','$product_details.level','MaxStocks_data2','express','</h5>','error','save','Rack\x202','../middleware/auth','<tr>','RoomAssigned','back','An\x20error\x20occurred.','product_stock','primary_unit','/CheckingWarehouse','language','Enclosed','<span\x20style=\x22float:\x20right;\x22>','/upload/','to_warehouse','product_code','</tr>','to_bay','padStart','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','5kPTChE','render','$product_details.batch_code','split','6627558jXEyBR','$product_details.product_code','DRY\x20GOODS','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Transfer\x20Edit\x20Successfully','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','getMonth','errors','date','aggregate','/barcode_scanner3','forEach','Router','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','French','English','message','prod_name','/picking_list/PDF_transfer/','Enabled','to_prod_level','then','$product_details.type','An\x20error\x20occurred\x20while\x20saving\x20data.','findById','map','transfer_finished','note','<hr\x20class=\x22my-3\x22>','$to_warehouse','catch','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','2440268lICtXi','role','English\x20(US)','to_invoice','log','production_date','from_quantity','site_title','bay','secondary_unit','3463838GPpXvN','success','792iXoeJU','$product_details.primary_code','<h2>\x20','149288VnkdPl','$_id','from_prod_level','$product','batch_code','18mELIch','Hindi','createTransport','body','QA\x20Warehouse','<html><head><title></title>','$product_details.unit','$product_details.product_name','warehouse','</div>','updateOne','Arabic\x20(ae)','$name','$from_warehouse','Portuguese','7311100iUXpiz','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','flash','post','FROZEN\x20GOODS','get','$product_details.floorlevel','$product_details.isle','$product_details.pallet','user','<strong>\x20Regards\x20</strong>','../public/language/languages.json'];a0_0x32c0=function(){return _0x6bb1e3;};return a0_0x32c0();}var a0_0xdfe148=a0_0x1126;(function(_0x41e841,_0x705a1e){var _0x54191d=a0_0x1126,_0x3c1c90=_0x41e841();while(!![]){try{var _0x95ebbe=parseInt(_0x54191d(0xf8))/0x1+parseInt(_0x54191d(0x171))/0x2*(-parseInt(_0x54191d(0x19f))/0x3)+parseInt(_0x54191d(0x165))/0x4+parseInt(_0x54191d(0x141))/0x5*(-parseInt(_0x54191d(0x145))/0x6)+parseInt(_0x54191d(0x16f))/0x7+parseInt(_0x54191d(0x174))/0x8*(parseInt(_0x54191d(0x179))/0x9)+parseInt(_0x54191d(0x188))/0xa;if(_0x95ebbe===_0x705a1e)break;else _0x3c1c90['push'](_0x3c1c90['shift']());}catch(_0x59a289){_0x3c1c90['push'](_0x3c1c90['shift']());}}}(a0_0x32c0,0x9c190));function a0_0x1126(_0x1daa50,_0x28a85a){var _0x32c001=a0_0x32c0();return a0_0x1126=function(_0x112679,_0x4d265d){_0x112679=_0x112679-0xd0;var _0x1e4d08=_0x32c001[_0x112679];return _0x1e4d08;},a0_0x1126(_0x1daa50,_0x28a85a);}const express=require(a0_0xdfe148(0x12a)),app=express(),router=express[a0_0xdfe148(0x151)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0xdfe148(0x127)),auth=require(a0_0xdfe148(0x12f)),users=require(a0_0xdfe148(0x193)),nodemailer=require('nodemailer');router['get'](a0_0xdfe148(0x115),auth,async(_0x28648c,_0x6701ea)=>{var _0x21e8ca=a0_0xdfe148;try{const {username:_0x390df7,email:_0x554706,role:_0x34f04e}=_0x28648c[_0x21e8ca(0x191)],_0x3e72ed=_0x28648c[_0x21e8ca(0x191)],_0x56e45f=await profile[_0x21e8ca(0xdf)]({'email':_0x3e72ed[_0x21e8ca(0xdd)]}),_0xc58993=await master_shop['find']();let _0x1f42fa;if(_0x3e72ed['role']==_0x21e8ca(0x10c)){const _0x5872fe=await staff[_0x21e8ca(0xdf)]({'email':_0x3e72ed[_0x21e8ca(0xdd)]});_0x1f42fa=await transfers_finished[_0x21e8ca(0xe6)]({'from_warehouse':_0x5872fe[_0x21e8ca(0x181)]});}else _0x1f42fa=await transfers_finished['aggregate']([{'$unwind':_0x21e8ca(0x177)},{'$group':{'_id':_0x21e8ca(0x175),'invoice':{'$first':'$invoice'},'date':{'$first':_0x21e8ca(0x123)},'from_warehouse':{'$first':_0x21e8ca(0x186)},'to_warehouse':{'$first':_0x21e8ca(0x162)},'from_room_name':{'$addToSet':_0x21e8ca(0x11e)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0xc58993[0x0][_0x21e8ca(0x137)]==_0x21e8ca(0x167))var _0x557bf5=users[_0x21e8ca(0x154)];else{if(_0xc58993[0x0][_0x21e8ca(0x137)]==_0x21e8ca(0x17a))var _0x557bf5=users[_0x21e8ca(0x17a)];else{if(_0xc58993[0x0]['language']==_0x21e8ca(0xe3))var _0x557bf5=users[_0x21e8ca(0xe3)];else{if(_0xc58993[0x0][_0x21e8ca(0x137)]==_0x21e8ca(0x122))var _0x557bf5=users[_0x21e8ca(0x122)];else{if(_0xc58993[0x0][_0x21e8ca(0x137)]==_0x21e8ca(0x153))var _0x557bf5=users['French'];else{if(_0xc58993[0x0]['language']==_0x21e8ca(0xda))var _0x557bf5=users[_0x21e8ca(0x187)];else{if(_0xc58993[0x0]['language']==_0x21e8ca(0x126))var _0x557bf5=users['Chinese'];else{if(_0xc58993[0x0][_0x21e8ca(0x137)]=='Arabic\x20(ae)')var _0x557bf5=users['Arabic'];}}}}}}}_0x6701ea[_0x21e8ca(0x142)](_0x21e8ca(0x15f),{'success':_0x28648c[_0x21e8ca(0x18a)](_0x21e8ca(0x170)),'errors':_0x28648c['flash'](_0x21e8ca(0x14c)),'role':_0x3e72ed,'profile':_0x56e45f,'master_shop':_0xc58993,'transfer':_0x1f42fa,'language':_0x557bf5});}catch(_0x569584){console['log'](_0x569584);}});async function getRandom8DigitNumber(){var _0xd54512=a0_0xdfe148;const _0xc783dd=0x989680,_0x5ad741=0x5f5e0ff,_0x249b5d=Math['floor'](Math[_0xd54512(0x113)]()*(_0x5ad741-_0xc783dd+0x1))+_0xc783dd;var _0x59ca38;const _0x205f00=await transfers_finished[_0xd54512(0xdf)]({'invoice':_0xd54512(0x107)+_0x249b5d});return _0x205f00&&_0x205f00[_0xd54512(0xe9)]>0x0?_0x59ca38=_0xd54512(0x107)+_0x249b5d:_0x59ca38=_0xd54512(0x107)+_0x249b5d,_0x59ca38;}router[a0_0xdfe148(0x18d)](a0_0xdfe148(0x1a3),auth,async(_0x5c2120,_0x5090a5)=>{var _0x1e2926=a0_0xdfe148;try{const {username:_0x1d87a0,email:_0x20b8ac,role:_0x52a916}=_0x5c2120['user'],_0x25b60b=_0x5c2120['user'],_0x4f48f2=await profile[_0x1e2926(0xdf)]({'email':_0x25b60b[_0x1e2926(0xdd)]}),_0x3c965f=await master_shop[_0x1e2926(0xe6)]();let _0x586c36;if(_0x25b60b[_0x1e2926(0x166)]==_0x1e2926(0x10c)){const _0x1743b8=await staff[_0x1e2926(0xdf)]({'email':_0x25b60b[_0x1e2926(0xdd)]});_0x586c36=await warehouse['aggregate']([{'$match':{'status':_0x1e2926(0x158),'name':_0x1743b8[_0x1e2926(0x181)],'warehouse_category':_0x1e2926(0x119),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x1e2926(0x185),'name':{'$first':'$name'}}}]);}else _0x586c36=await warehouse[_0x1e2926(0x14e)]([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods','name':{'$ne':_0x1e2926(0x17d)}}},{'$group':{'_id':'$name','name':{'$first':_0x1e2926(0x185)}}}]);const _0x4c1ae1=await transfers_finished[_0x1e2926(0xe6)]({}),_0x21600b=_0x4c1ae1[_0x1e2926(0xe9)]+0x1,_0x2ae519=_0x1e2926(0x107)+_0x21600b[_0x1e2926(0x1a6)]()[_0x1e2926(0x13f)](0x5,'0');if(_0x3c965f[0x0][_0x1e2926(0x137)]==_0x1e2926(0x167))var _0x2559c6=users[_0x1e2926(0x154)];else{if(_0x3c965f[0x0]['language']=='Hindi')var _0x2559c6=users[_0x1e2926(0x17a)];else{if(_0x3c965f[0x0]['language']==_0x1e2926(0xe3))var _0x2559c6=users['German'];else{if(_0x3c965f[0x0]['language']==_0x1e2926(0x122))var _0x2559c6=users[_0x1e2926(0x122)];else{if(_0x3c965f[0x0][_0x1e2926(0x137)]==_0x1e2926(0x153))var _0x2559c6=users[_0x1e2926(0x153)];else{if(_0x3c965f[0x0][_0x1e2926(0x137)]==_0x1e2926(0xda))var _0x2559c6=users[_0x1e2926(0x187)];else{if(_0x3c965f[0x0]['language']==_0x1e2926(0x126))var _0x2559c6=users[_0x1e2926(0x126)];else{if(_0x3c965f[0x0][_0x1e2926(0x137)]==_0x1e2926(0x184))var _0x2559c6=users[_0x1e2926(0xef)];}}}}}}}const _0x1d9b4c=getRandom8DigitNumber();_0x1d9b4c[_0x1e2926(0x15a)](_0x558c1f=>{var _0x1011ac=_0x1e2926;_0x5090a5[_0x1011ac(0x142)]('add_transfer_finished',{'success':_0x5c2120['flash'](_0x1011ac(0x170)),'errors':_0x5c2120[_0x1011ac(0x18a)]('errors'),'role':_0x25b60b,'profile':_0x4f48f2,'master_shop':_0x3c965f,'warehouse':_0x586c36,'language':_0x2559c6,'invoice':_0x558c1f});})[_0x1e2926(0x163)](_0x3daa71=>{var _0x21abe9=_0x1e2926;_0x5c2120['flash'](_0x21abe9(0x14c),_0x21abe9(0x112)),_0x5090a5[_0x21abe9(0x104)]('/transfer/view');});}catch(_0x3232ae){console[_0x1e2926(0x169)](_0x3232ae);}}),router['post'](a0_0xdfe148(0x1a3),auth,async(_0x2f0b30,_0x22086d)=>{var _0x4ce265=a0_0xdfe148;try{const {date:_0x572de8,from_warehouse:_0x4d77bf,FromRoom_name:_0x55a163,to_warehouse:_0x2b9710,ToRoom_name:_0x3c7ad0,prod_name:_0x7fa088,from_prod_qty:_0x5d0400,from_prod_level:_0x263bd7,from_prod_isle:_0x2a6d7d,from_prod_pallet:_0x1deee4,to_prod_qty:_0xa7cc10,to_prod_level:_0x597cd4,to_prod_isle:_0x14d7a3,to_prod_pallet:_0x2aac1f,primary_code:_0x56698d,secondary_code:_0x268cb9,product_code3:_0x5751c0,note:_0x33c492,MaxStocks_data2:_0x4165ec,invoice:_0xa4d922,expiry_date:_0x1de171}=_0x2f0b30[_0x4ce265(0x17c)];if(typeof _0x7fa088==_0x4ce265(0x1a1))var _0x133a24=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x156)]],_0x1a96fe=[_0x2f0b30['body'][_0x4ce265(0x108)]],_0x40934c=[_0x2f0b30['body'][_0x4ce265(0x176)]],_0x4c43ed=[_0x2f0b30['body'][_0x4ce265(0x125)]],_0x5e5c85=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x159)]],_0x43857f=[_0x2f0b30['body'][_0x4ce265(0xf6)]],_0x3eb143=[_0x2f0b30['body']['secondary_code']],_0x20ff25=[_0x2f0b30['body'][_0x4ce265(0x10f)]],_0x4024bd=[_0x2f0b30[_0x4ce265(0x17c)]['MaxStocks_data2']],_0x87b2d9=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x135)]],_0x32413d=[_0x2f0b30[_0x4ce265(0x17c)]['secondary_unit']],_0x2f68f7=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x178)]],_0x279863=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0xe2)]],_0x20c02f=[_0x2f0b30[_0x4ce265(0x17c)]['product_date']],_0x2fdeda=[_0x2f0b30[_0x4ce265(0x17c)]['MaxStocks_data']],_0x49d465=[_0x2f0b30['body'][_0x4ce265(0xd3)]],_0x4c2ca2=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0xd9)]],_0x54407b=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x131)]],_0xfb1246=[_0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x111)]],_0x4feabe=[_0x2f0b30['body']['from_invoice']],_0x582e08=[_0x2f0b30[_0x4ce265(0x17c)]['to_invoice']];else var _0x133a24=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x156)]],_0x1a96fe=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x108)]],_0x40934c=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x176)]],_0x4c43ed=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x125)]],_0x5e5c85=[..._0x2f0b30['body'][_0x4ce265(0x159)]],_0x43857f=[..._0x2f0b30['body'][_0x4ce265(0xf6)]],_0x3eb143=[..._0x2f0b30[_0x4ce265(0x17c)]['secondary_code']],_0x20ff25=[..._0x2f0b30[_0x4ce265(0x17c)]['product_code3']],_0x4024bd=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x129)]],_0x87b2d9=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x135)]],_0x32413d=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x16e)]],_0x2f68f7=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x178)]],_0x279863=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0xe2)]],_0x20c02f=[..._0x2f0b30[_0x4ce265(0x17c)]['product_date']],_0x2fdeda=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x120)]],_0x49d465=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0xd3)]],_0x4c2ca2=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0xd9)]],_0x54407b=[..._0x2f0b30[_0x4ce265(0x17c)]['RoomAssigned']],_0xfb1246=[..._0x2f0b30['body'][_0x4ce265(0x111)]],_0x4feabe=[..._0x2f0b30[_0x4ce265(0x17c)][_0x4ce265(0x199)]],_0x582e08=[..._0x2f0b30['body'][_0x4ce265(0x168)]];const _0x28325c=_0x133a24[_0x4ce265(0x15e)](_0x104420=>{return _0x104420={'product_name':_0x104420};});_0x1a96fe[_0x4ce265(0x150)]((_0x4dcaf1,_0x185a2f)=>{var _0x123dbe=_0x4ce265;_0x28325c[_0x185a2f][_0x123dbe(0x16b)]=_0x4dcaf1;}),_0x40934c[_0x4ce265(0x150)]((_0x540c5e,_0x29d6c6)=>{_0x28325c[_0x29d6c6]['from_bay']=_0x540c5e;}),_0x4feabe['forEach']((_0x1517b5,_0x2b2c98)=>{var _0x1a029e=_0x4ce265;_0x28325c[_0x2b2c98][_0x1a029e(0x199)]=_0x1517b5;}),_0x582e08[_0x4ce265(0x150)]((_0x4ec4ae,_0x2bb612)=>{var _0x411f74=_0x4ce265;_0x28325c[_0x2bb612][_0x411f74(0xfa)]=_0x4ec4ae;}),_0x4c43ed[_0x4ce265(0x150)]((_0x23bea8,_0x975dad)=>{_0x28325c[_0x975dad]['to_quantity']=_0x23bea8;}),_0x5e5c85[_0x4ce265(0x150)]((_0x202b00,_0x37ca84)=>{var _0x2b416a=_0x4ce265;_0x28325c[_0x37ca84][_0x2b416a(0x13e)]=_0x202b00;}),_0x43857f[_0x4ce265(0x150)]((_0x549595,_0x2021cf)=>{var _0x382dd3=_0x4ce265;_0x28325c[_0x2021cf][_0x382dd3(0xf6)]=_0x549595;}),_0x3eb143[_0x4ce265(0x150)]((_0xf7558,_0x3283c4)=>{var _0x5bdc65=_0x4ce265;_0x28325c[_0x3283c4][_0x5bdc65(0x19d)]=_0xf7558;}),_0x20ff25[_0x4ce265(0x150)]((_0x413326,_0x565801)=>{var _0x316de3=_0x4ce265;_0x28325c[_0x565801][_0x316de3(0x13c)]=_0x413326;}),_0x4024bd['forEach']((_0x3ae4ee,_0xe5d450)=>{_0x28325c[_0xe5d450]['maxProducts']=_0x3ae4ee;}),_0x87b2d9[_0x4ce265(0x150)]((_0x2ee8ab,_0x368d28)=>{var _0x470d9a=_0x4ce265;_0x28325c[_0x368d28][_0x470d9a(0x10a)]=_0x2ee8ab;}),_0x32413d['forEach']((_0x7d67b8,_0x47b0e5)=>{var _0x4d49cb=_0x4ce265;_0x28325c[_0x47b0e5][_0x4d49cb(0x16e)]=_0x7d67b8;}),_0x2f68f7[_0x4ce265(0x150)]((_0x3658d2,_0x3641ee)=>{var _0x461063=_0x4ce265;_0x28325c[_0x3641ee][_0x461063(0x178)]=_0x3658d2;}),_0x279863['forEach']((_0x1de9b4,_0x1c781e)=>{var _0x43785b=_0x4ce265;_0x28325c[_0x1c781e][_0x43785b(0xe2)]=_0x1de9b4;}),_0x20c02f['forEach']((_0x49509f,_0x3b4ad3)=>{_0x28325c[_0x3b4ad3]['production_date']=_0x49509f;}),_0x2fdeda['forEach']((_0x50ed03,_0x478893)=>{_0x28325c[_0x478893]['maxProducts']=_0x50ed03;}),_0x49d465['forEach']((_0x3025c8,_0xa1f4b7)=>{var _0x1186cb=_0x4ce265;_0x28325c[_0xa1f4b7][_0x1186cb(0xd3)]=_0x3025c8;}),_0x4c2ca2[_0x4ce265(0x150)]((_0x50b3c2,_0xd62465)=>{_0x28325c[_0xd62465]['prod_cat']=_0x50b3c2;}),_0x54407b['forEach']((_0x4e33c7,_0x5ec131)=>{_0x28325c[_0x5ec131]['from_room_name']=_0x4e33c7;}),_0xfb1246[_0x4ce265(0x150)]((_0x3f35fd,_0x27c22d)=>{var _0x38a8d4=_0x4ce265;_0x28325c[_0x27c22d][_0x38a8d4(0xe8)]=_0x3f35fd;});const _0x1cb9b1=_0x28325c['filter'](_0x385948=>_0x385948[_0x4ce265(0x1a5)]!=='0'&&_0x385948['to_quantity']!==''||_0x385948[_0x4ce265(0xf2)]!=='0'&&_0x385948[_0x4ce265(0xf2)]!=='');var _0xc73d87=0x0;_0x1cb9b1['forEach'](_0x21d59c=>{parseInt(_0x21d59c['from_quantity'])<parseInt(_0x21d59c['to_quantity'])&&_0xc73d87++;});if(_0xc73d87!=0x0)return _0x2f0b30[_0x4ce265(0x18a)](_0x4ce265(0x14c),_0x4ce265(0x14a)),_0x22086d['redirect'](_0x4ce265(0x132));const _0x1afb88=new transfers_finished({'date':_0x572de8,'from_warehouse':_0x4d77bf,'to_warehouse':_0x2b9710,'product':_0x1cb9b1,'note':_0x33c492,'invoice':_0xa4d922}),_0x1b15b5=await _0x1afb88[_0x4ce265(0x12d)]();_0x2f0b30[_0x4ce265(0x18a)](_0x4ce265(0x170),'Product\x20Transfer\x20successfully'),_0x22086d[_0x4ce265(0x104)](_0x4ce265(0xf1)+_0x1b15b5[_0x4ce265(0x116)]);}catch(_0x51f503){console[_0x4ce265(0x169)](_0x51f503),_0x22086d[_0x4ce265(0xf9)](0xc8)[_0x4ce265(0x102)]({'errorMessage':_0x51f503[_0x4ce265(0x155)]});}}),router['get'](a0_0xdfe148(0xf0),auth,async(_0xc8e132,_0x128a0d)=>{var _0x57149b=a0_0xdfe148;try{const {username:_0x4cdd00,email:_0x87d621,role:_0x5c4a3f}=_0xc8e132[_0x57149b(0x191)],_0x39bb86=_0xc8e132[_0x57149b(0x191)],_0x5aeb10=await profile[_0x57149b(0xdf)]({'email':_0x39bb86[_0x57149b(0xdd)]}),_0x3388cc=await master_shop[_0x57149b(0xe6)](),_0xc53954=await transfers_finished[_0x57149b(0x15d)](_0xc8e132[_0x57149b(0x10e)]['id']);let _0x13a41a;if(_0x39bb86[_0x57149b(0x166)]=='staff'){const _0x38d706=await staff[_0x57149b(0xdf)]({'email':_0x39bb86['email']});_0x13a41a=await warehouse[_0x57149b(0xe6)]({'status':_0x57149b(0x158),'name':_0x38d706[_0x57149b(0x181)],'warehouse_category':'Finished\x20Goods'});}else _0x13a41a=await warehouse[_0x57149b(0xe6)]({'status':_0x57149b(0x158),'warehouse_category':_0x57149b(0x119)});const _0x114054=await warehouse[_0x57149b(0x14e)]([{'$match':{'name':_0xc53954[_0x57149b(0x1a0)],'warehouse_category':_0x57149b(0x119)}},{'$unwind':_0x57149b(0x19a)},{'$group':{'_id':_0x57149b(0xd1),'name':{'$first':_0x57149b(0x180)},'product_stock':{'$first':_0x57149b(0xf3)},'bay':{'$first':_0x57149b(0x198)},'bin':{'$first':_0x57149b(0x11c)},'type':{'$first':_0x57149b(0x15b)},'floorlevel':{'$first':_0x57149b(0x18e)},'primary_code':{'$first':_0x57149b(0x172)},'secondary_code':{'$first':_0x57149b(0xd2)},'product_code':{'$first':_0x57149b(0x146)},'storage':{'$first':_0x57149b(0x124)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x57149b(0xf5)},'room':{'$first':_0x57149b(0xd0)},'warehoue_name':{'$first':_0x57149b(0x185)}}}]),_0x58d6f5=await product[_0x57149b(0xe6)]({});if(_0x3388cc[0x0][_0x57149b(0x137)]==_0x57149b(0x167)){var _0x39393d=users['English'];console[_0x57149b(0x169)](_0x39393d);}else{if(_0x3388cc[0x0][_0x57149b(0x137)]==_0x57149b(0x17a))var _0x39393d=users[_0x57149b(0x17a)];else{if(_0x3388cc[0x0][_0x57149b(0x137)]==_0x57149b(0xe3))var _0x39393d=users[_0x57149b(0xe3)];else{if(_0x3388cc[0x0]['language']=='Spanish')var _0x39393d=users[_0x57149b(0x122)];else{if(_0x3388cc[0x0][_0x57149b(0x137)]=='French')var _0x39393d=users[_0x57149b(0x153)];else{if(_0x3388cc[0x0][_0x57149b(0x137)]==_0x57149b(0xda))var _0x39393d=users['Portuguese'];else{if(_0x3388cc[0x0]['language']==_0x57149b(0x126))var _0x39393d=users[_0x57149b(0x126)];else{if(_0x3388cc[0x0]['language']==_0x57149b(0x184))var _0x39393d=users[_0x57149b(0xef)];}}}}}}}_0x128a0d[_0x57149b(0x142)](_0x57149b(0xe1),{'success':_0xc8e132['flash'](_0x57149b(0x170)),'errors':_0xc8e132[_0x57149b(0x18a)](_0x57149b(0x14c)),'role':_0x39bb86,'profile':_0x5aeb10,'master_shop':_0x3388cc,'warehouse':_0x13a41a,'transfer':_0xc53954,'stock':_0x114054,'unit':_0x58d6f5,'language':_0x39393d});}catch(_0x559735){console[_0x57149b(0x169)](_0x559735);}}),router['post']('/preview/:id',auth,async(_0x385452,_0x186fec)=>{var _0x2eab16=a0_0xdfe148;try{const {invoice:_0x2593b6,from_warehouse:_0x277110,FromRoom_name:_0x3a927e,to_warehouse:_0x1da5a7,ToRoom_name:_0x1d5839}=_0x385452[_0x2eab16(0x17c)],_0x2739af=await transfers_finished[_0x2eab16(0x15d)](_0x385452[_0x2eab16(0x10e)]['id']),_0x4e3113=_0x2739af['product'][_0x2eab16(0x15e)](async _0xbdbce4=>{var _0x1d2b68=_0x2eab16;if(_0xbdbce4[_0x1d2b68(0x1a5)]>0x0){var _0x341e87=await warehouse[_0x1d2b68(0xdf)]({'name':_0x277110,'room':_0xbdbce4['from_room_name'],'warehouse_category':_0x1d2b68(0x119)});const _0x450b2a=_0x341e87[_0x1d2b68(0x1a4)][_0x1d2b68(0x15e)](_0x126446=>{var _0x7d804=_0x1d2b68;_0x126446[_0x7d804(0xeb)]==_0xbdbce4[_0x7d804(0xeb)]&&_0x126446[_0x7d804(0x16d)]==_0xbdbce4[_0x7d804(0xdc)]&&_0x126446[_0x7d804(0xe2)]==_0xbdbce4[_0x7d804(0xe2)]&&_0x126446[_0x7d804(0x16a)]==_0xbdbce4[_0x7d804(0x16a)]&&_0x126446[_0x7d804(0x178)]==_0xbdbce4[_0x7d804(0x178)]&&_0x126446[_0x7d804(0xe0)]==_0xbdbce4[_0x7d804(0x199)]&&(_0x126446['product_stock']=_0x126446['product_stock']-_0xbdbce4[_0x7d804(0x1a5)]);});}return _0x341e87;});Promise[_0x2eab16(0xec)](_0x4e3113)[_0x2eab16(0x15a)](async _0x17127b=>{var _0x5f004b=_0x2eab16;try{for(const _0x1c1af1 of _0x17127b){await _0x1c1af1[_0x5f004b(0x12d)]();}const _0x56456c=_0x2739af['product'][_0x5f004b(0x15e)](async _0x22a4ae=>{var _0x2b9913=_0x5f004b,_0xaeda71=await warehouse[_0x2b9913(0xdf)]({'name':_0x1da5a7,'room':_0x22a4ae[_0x2b9913(0xe8)]});if(_0x22a4ae[_0x2b9913(0x1a5)]>0x0){var _0x5a2be8=0x0;const _0x2b7d90=_0xaeda71['product_details'][_0x2b9913(0x15e)](_0x280a15=>{var _0x40ed44=_0x2b9913;_0x280a15[_0x40ed44(0xeb)]==_0x22a4ae[_0x40ed44(0xeb)]&&_0x280a15[_0x40ed44(0x16d)]==_0x22a4ae[_0x40ed44(0x13e)]&&_0x280a15['expiry_date']==_0x22a4ae[_0x40ed44(0xe2)]&&_0x280a15[_0x40ed44(0x16a)]==_0x22a4ae[_0x40ed44(0x16a)]&&_0x280a15[_0x40ed44(0x178)]==_0x22a4ae[_0x40ed44(0x178)]&&_0x280a15[_0x40ed44(0xe0)]==_0x22a4ae[_0x40ed44(0xfa)]&&(_0x280a15[_0x40ed44(0x134)]=_0x280a15[_0x40ed44(0x134)]+_0x22a4ae[_0x40ed44(0x1a5)],_0x5a2be8++);});_0x5a2be8=='0'&&(_0xaeda71['product_details']=_0xaeda71[_0x2b9913(0x1a4)][_0x2b9913(0x114)]({'product_name':_0x22a4ae[_0x2b9913(0xeb)],'product_stock':_0x22a4ae['to_quantity'],'bay':_0x22a4ae[_0x2b9913(0x13e)],'product_code':_0x22a4ae[_0x2b9913(0x13c)],'primary_code':_0x22a4ae['primary_code'],'secondary_code':_0x22a4ae['secondary_code'],'expiry_date':_0x22a4ae['expiry_date'],'production_date':_0x22a4ae[_0x2b9913(0x16a)],'maxProducts':_0x22a4ae['maxProducts'],'batch_code':_0x22a4ae[_0x2b9913(0x178)],'secondary_unit':_0x22a4ae[_0x2b9913(0x16e)],'unit':_0x22a4ae[_0x2b9913(0x10a)],'maxProducts':_0x22a4ae[_0x2b9913(0xfc)],'maxPerUnit':_0x22a4ae[_0x2b9913(0xd3)],'invoice':_0x22a4ae[_0x2b9913(0xfa)]}));}return _0xaeda71;});Promise[_0x5f004b(0xec)](_0x56456c)['then'](async _0x544985=>{var _0x45ac9b=_0x5f004b;try{for(const _0x2bb885 of _0x544985){await warehouse[_0x45ac9b(0x183)]({'_id':_0x2bb885[_0x45ac9b(0x116)]},{'$addToSet':{'product_details':{'$each':_0x2bb885['product_details']}}});}_0x2739af[_0x45ac9b(0x1a2)]=_0x45ac9b(0x117);const _0x464beb=await _0x2739af[_0x45ac9b(0x12d)](),_0x428a2f=await master_shop['find'](),_0x289d05=await email_settings[_0x45ac9b(0xdf)](),_0x111afc=await supervisor_settings[_0x45ac9b(0xe6)]();var _0x3a5cef=_0x2739af[_0x45ac9b(0xe4)],_0x46249d='',_0x5dd2be;for(_0x5dd2be in _0x3a5cef){var _0x56ed50='FG';_0x2739af[_0x45ac9b(0x13b)]==_0x45ac9b(0x147)&&(_0x56ed50='DG'),_0x46249d+=_0x45ac9b(0x130)+_0x45ac9b(0x194)+_0x3a5cef[_0x5dd2be][_0x45ac9b(0xeb)]+_0x45ac9b(0xdb)+_0x45ac9b(0x194)+_0x3a5cef[_0x5dd2be][_0x45ac9b(0x13c)]+'</td>'+_0x45ac9b(0x194)+_0x3a5cef[_0x5dd2be][_0x45ac9b(0x1a5)]+_0x45ac9b(0xdb)+_0x45ac9b(0x194)+_0x3a5cef[_0x5dd2be][_0x45ac9b(0x10a)]+_0x45ac9b(0xdb)+_0x45ac9b(0x194)+_0x3a5cef[_0x5dd2be][_0x45ac9b(0x16e)]+'</td>'+_0x45ac9b(0x194)+_0x2739af[_0x45ac9b(0x13b)]+'</td>'+_0x45ac9b(0x194)+_0x3a5cef[_0x5dd2be][_0x45ac9b(0xe8)]+_0x45ac9b(0xdb)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x56ed50+_0x3a5cef[_0x5dd2be]['to_bay']+'</td>'+_0x45ac9b(0x13d);}let _0x1293b5=nodemailer[_0x45ac9b(0x17b)]({'host':_0x289d05['host'],'port':Number(_0x289d05['port']),'secure':![],'auth':{'user':_0x289d05[_0x45ac9b(0xdd)],'pass':_0x289d05[_0x45ac9b(0xd5)]}}),_0x3bf0fe={'from':_0x289d05[_0x45ac9b(0xdd)],'to':_0x111afc[0x0][_0x45ac9b(0xfd)],'subject':_0x45ac9b(0xfb),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+_0x45ac9b(0x13a)+_0x428a2f[0x0][_0x45ac9b(0x197)],'cid':_0x45ac9b(0x103)}],'html':_0x45ac9b(0x11a)+_0x45ac9b(0x17e)+'</head><body>'+_0x45ac9b(0xd8)+_0x45ac9b(0x11b)+_0x45ac9b(0xd8)+_0x45ac9b(0x164)+_0x45ac9b(0x182)+_0x45ac9b(0xd8)+_0x45ac9b(0x173)+_0x428a2f[0x0][_0x45ac9b(0x16c)]+_0x45ac9b(0x110)+_0x45ac9b(0x182)+_0x45ac9b(0x182)+_0x45ac9b(0x161)+_0x45ac9b(0xd8)+_0x45ac9b(0x109)+'\x20Order\x20Number\x20:\x20'+_0x2739af[_0x45ac9b(0xe0)]+'\x20'+_0x45ac9b(0x139)+_0x45ac9b(0xe5)+_0x2739af[_0x45ac9b(0x14d)]+'\x20'+_0x45ac9b(0x106)+_0x45ac9b(0x12b)+_0x45ac9b(0x182)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x45ac9b(0x148)+_0x45ac9b(0x130)+_0x45ac9b(0x189)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>'+_0x45ac9b(0x140)+_0x45ac9b(0x152)+_0x45ac9b(0x11f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x45ac9b(0x118)+'</tr>'+_0x45ac9b(0xfe)+_0x45ac9b(0xe7)+'\x20'+_0x46249d+'\x20'+_0x45ac9b(0xde)+_0x45ac9b(0xd7)+_0x45ac9b(0xd8)+_0x45ac9b(0x192)+'<h5>'+_0x428a2f[0x0][_0x45ac9b(0x16c)]+_0x45ac9b(0x12b)+'</div>'+'</div>'+'</body></html>'};_0x1293b5['sendMail'](_0x3bf0fe,function(_0x34d16f,_0x417ad5){var _0x9fcdec=_0x45ac9b;_0x34d16f?(console[_0x9fcdec(0x169)](_0x34d16f),console[_0x9fcdec(0x169)](_0x9fcdec(0x19e))):console[_0x9fcdec(0x169)](_0x9fcdec(0x10b));}),_0x385452[_0x45ac9b(0x18a)](_0x45ac9b(0x170),_0x45ac9b(0x100)),_0x186fec['redirect'](_0x45ac9b(0x157)+_0x464beb[_0x45ac9b(0x116)]);}catch(_0x2d8e0d){console[_0x45ac9b(0x12c)](_0x2d8e0d),_0x186fec[_0x45ac9b(0xf9)](0x1f4)['json']({'error':_0x45ac9b(0xee)});}})[_0x5f004b(0x163)](_0x41ca90=>{var _0x2fb38f=_0x5f004b;console[_0x2fb38f(0x12c)](_0x41ca90),_0x186fec[_0x2fb38f(0xf9)](0x1f4)['json']({'error':_0x2fb38f(0x133)});});}catch(_0x260896){console[_0x5f004b(0x12c)](_0x260896),_0x186fec[_0x5f004b(0xf9)](0x1f4)['json']({'error':_0x5f004b(0x15c)});}})[_0x2eab16(0x163)](_0x32c617=>{var _0x502588=_0x2eab16;console[_0x502588(0x12c)](_0x32c617),_0x186fec[_0x502588(0xf9)](0x1f4)['json']({'error':'An\x20error\x20occurred.'});});}catch(_0x58c724){_0x186fec[_0x2eab16(0x102)]({'message':_0x58c724['message']});}});function BayBinSelected(_0x4c7740,_0x5605a9){var _0x4ce095=a0_0xdfe148,_0x4486ae=[];let _0x556150=[];var _0x3449a9=[];if(_0x4c7740=='DRY\x20GOODS'){switch(_0x5605a9){case _0x4ce095(0x196):_0x4486ae=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x4ce095(0x12e):_0x4486ae=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3449a9=['DG'];}else{if(_0x4c7740==_0x4ce095(0x18c)){switch(_0x5605a9){case _0x4ce095(0x196):_0x4486ae=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x4ce095(0x12e):_0x4486ae=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3449a9=['FG'];}}return{'levels':_0x4486ae,'identify':_0x3449a9};}router[a0_0xdfe148(0x18d)](a0_0xdfe148(0x10d),auth,async(_0x294bac,_0x584ba3)=>{var _0x1f81e7=a0_0xdfe148;try{const {username:_0x166671,email:_0x3d093a,role:_0x2b97f2}=_0x294bac[_0x1f81e7(0x191)],_0x3b6598=_0x294bac[_0x1f81e7(0x191)],_0xc9d9e8=await profile[_0x1f81e7(0xdf)]({'email':_0x3b6598[_0x1f81e7(0xdd)]}),_0x33aa15=await master_shop['find'](),_0x248f5e=await transfers_finished[_0x1f81e7(0x15d)](_0x294bac[_0x1f81e7(0x10e)]['id']);let _0x2770f0=new Date(_0x248f5e[_0x1f81e7(0xe2)]),_0x141f4a=('0'+_0x2770f0['getDate']())['slice'](-0x2),_0x2e6286=('0'+(_0x2770f0[_0x1f81e7(0x14b)]()+0x1))['slice'](-0x2),_0x48d66f=_0x2770f0['getFullYear'](),_0x385ddd=_0x48d66f+'-'+_0x2e6286+'-'+_0x141f4a,_0x5c5b71;if(_0x3b6598[_0x1f81e7(0x166)]==_0x1f81e7(0x10c)){const _0x16af3e=await staff[_0x1f81e7(0xdf)]({'email':_0x3b6598['email']});_0x5c5b71=await warehouse['find']({'status':_0x1f81e7(0x158),'name':_0x16af3e[_0x1f81e7(0x181)],'warehouse_category':_0x1f81e7(0x119)});}else _0x5c5b71=await warehouse['find']({'status':_0x1f81e7(0x158),'warehouse_category':'Finished\x20Goods'});const _0x3f8bea=await warehouse[_0x1f81e7(0x14e)]([{'$match':{'name':_0x248f5e['from_warehouse'],'room':_0x248f5e[_0x1f81e7(0xff)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1f81e7(0x180)},'product_stock':{'$first':_0x1f81e7(0xf3)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1f81e7(0x11c)},'type':{'$first':_0x1f81e7(0x15b)},'floorlevel':{'$first':_0x1f81e7(0x18e)},'primary_code':{'$first':_0x1f81e7(0x172)},'secondary_code':{'$first':_0x1f81e7(0xd2)},'product_code':{'$first':_0x1f81e7(0x146)},'storage':{'$first':_0x1f81e7(0x124)},'rack':{'$first':'$product_details.rack'}}}]);var _0x208df8=[0x1,0x2,0x3,0x4],_0x1d4222=['A','B','C','D','E','F','G','H','I','J'],_0x1fc537=['Ambient',_0x1f81e7(0x138)];const _0x4241de=await product[_0x1f81e7(0xe6)]({}),_0x5bd79=BayBinSelected(_0x248f5e[_0x1f81e7(0x13b)],_0x248f5e[_0x1f81e7(0x105)]);if(_0x33aa15[0x0][_0x1f81e7(0x137)]==_0x1f81e7(0x167)){var _0x50d21a=users[_0x1f81e7(0x154)];console[_0x1f81e7(0x169)](_0x50d21a);}else{if(_0x33aa15[0x0][_0x1f81e7(0x137)]==_0x1f81e7(0x17a))var _0x50d21a=users[_0x1f81e7(0x17a)];else{if(_0x33aa15[0x0][_0x1f81e7(0x137)]==_0x1f81e7(0xe3))var _0x50d21a=users[_0x1f81e7(0xe3)];else{if(_0x33aa15[0x0][_0x1f81e7(0x137)]==_0x1f81e7(0x122))var _0x50d21a=users['Spanish'];else{if(_0x33aa15[0x0][_0x1f81e7(0x137)]=='French')var _0x50d21a=users['French'];else{if(_0x33aa15[0x0][_0x1f81e7(0x137)]==_0x1f81e7(0xda))var _0x50d21a=users['Portuguese'];else{if(_0x33aa15[0x0][_0x1f81e7(0x137)]==_0x1f81e7(0x126))var _0x50d21a=users[_0x1f81e7(0x126)];else{if(_0x33aa15[0x0]['language']==_0x1f81e7(0x184))var _0x50d21a=users[_0x1f81e7(0xef)];}}}}}}}_0x584ba3[_0x1f81e7(0x142)](_0x1f81e7(0xf4),{'success':_0x294bac[_0x1f81e7(0x18a)]('success'),'errors':_0x294bac[_0x1f81e7(0x18a)](_0x1f81e7(0x14c)),'role':_0x3b6598,'profile':_0xc9d9e8,'master_shop':_0x33aa15,'warehouse':_0x5c5b71,'transfer':_0x248f5e,'stock':_0x3f8bea,'unit':_0x4241de,'language':_0x50d21a,'levels':_0x208df8,'Isle':_0x1d4222,'rooms_data':_0x1fc537,'ed_fullDate':_0x385ddd,'dataSelected':_0x5bd79});}catch(_0x1c0d80){console['log'](_0x1c0d80);}}),router['post'](a0_0xdfe148(0x10d),auth,async(_0x42615b,_0x227489)=>{var _0x19d15a=a0_0xdfe148;try{const _0x28610d=_0x42615b['params']['id'];console[_0x19d15a(0x169)](_0x42615b[_0x19d15a(0x17c)]);const _0x32289d=await transfers_finished[_0x19d15a(0x15d)](_0x28610d);console[_0x19d15a(0x169)](_0x19d15a(0xed),_0x32289d);const {date:_0x45f2c7,from_warehouse:_0x4fbf5f,FromRoom_name:_0x17950c,to_warehouse:_0x5c8fec,ToRoom_name:_0x4d9ebe,prod_name:_0x4e0765,from_prod_qty:_0x43e33d,from_prod_level:_0x45f4f6,from_prod_isle:_0x39bcd0,from_prod_pallet:_0x72a905,to_prod_qty:_0x180eaa,to_prod_level:_0x3c5d81,to_prod_isle:_0x1a9b54,to_prod_pallet:_0x4c84bb,primary_code:_0x444799,secondary_code:_0x39b8e0,product_code3:_0x5d46bc,note:_0x30d47f,invoice:_0x2010c6,expiry_date:_0x312698}=_0x42615b[_0x19d15a(0x17c)];if(typeof _0x4e0765==_0x19d15a(0x1a1))var _0xe217ff=[_0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x156)]],_0x29f259=[_0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x108)]],_0x14862c=[_0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x176)]],_0x82a8ac=[_0x42615b[_0x19d15a(0x17c)]['to_prod_qty']],_0x40500a=[_0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x159)]],_0x58ddd7=[_0x42615b[_0x19d15a(0x17c)][_0x19d15a(0xf6)]],_0x1ec977=[_0x42615b[_0x19d15a(0x17c)]['secondary_code']],_0x118bb5=[_0x42615b[_0x19d15a(0x17c)]['product_code3']],_0x1f52f3=[_0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x129)]],_0x3e9afa=[_0x42615b['body'][_0x19d15a(0x10a)]],_0x52f1f0=[_0x42615b['body']['secondary_unit']],_0x332e71=[_0x42615b['body']['batch_code']],_0x25d4a9=[_0x42615b[_0x19d15a(0x17c)]['expiry_date']];else var _0xe217ff=[..._0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x156)]],_0x29f259=[..._0x42615b['body'][_0x19d15a(0x108)]],_0x14862c=[..._0x42615b[_0x19d15a(0x17c)]['from_prod_level']],_0x82a8ac=[..._0x42615b[_0x19d15a(0x17c)]['to_prod_qty']],_0x40500a=[..._0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x159)]],_0x58ddd7=[..._0x42615b[_0x19d15a(0x17c)][_0x19d15a(0xf6)]],_0x1ec977=[..._0x42615b['body'][_0x19d15a(0x19d)]],_0x118bb5=[..._0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x10f)]],_0x1f52f3=[..._0x42615b['body']['MaxStocks_data2']],_0x3e9afa=[..._0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x10a)]],_0x52f1f0=[..._0x42615b[_0x19d15a(0x17c)][_0x19d15a(0x16e)]],_0x332e71=[..._0x42615b[_0x19d15a(0x17c)]['batch_code']],_0x25d4a9=[..._0x42615b[_0x19d15a(0x17c)][_0x19d15a(0xe2)]];const _0x3c432f=_0xe217ff[_0x19d15a(0x15e)](_0x2ff186=>{return _0x2ff186={'product_name':_0x2ff186};});_0x29f259[_0x19d15a(0x150)]((_0x50f451,_0x27b66e)=>{_0x3c432f[_0x27b66e]['from_quantity']=_0x50f451;}),_0x14862c[_0x19d15a(0x150)]((_0x483820,_0x489054)=>{var _0x3b56df=_0x19d15a;_0x3c432f[_0x489054][_0x3b56df(0xdc)]=_0x483820;}),_0x82a8ac[_0x19d15a(0x150)]((_0x2b2a0a,_0x319b95)=>{var _0x469be1=_0x19d15a;_0x3c432f[_0x319b95][_0x469be1(0x1a5)]=_0x2b2a0a;}),_0x40500a['forEach']((_0x128bb6,_0x419455)=>{_0x3c432f[_0x419455]['to_bay']=_0x128bb6;}),_0x58ddd7[_0x19d15a(0x150)]((_0x5d44fa,_0x10d39a)=>{var _0x2b71f8=_0x19d15a;_0x3c432f[_0x10d39a][_0x2b71f8(0xf6)]=_0x5d44fa;}),_0x1ec977[_0x19d15a(0x150)]((_0x4ea89d,_0x41bd34)=>{var _0x4f2955=_0x19d15a;_0x3c432f[_0x41bd34][_0x4f2955(0x19d)]=_0x4ea89d;}),_0x118bb5[_0x19d15a(0x150)]((_0x30935a,_0x140253)=>{var _0x2d0131=_0x19d15a;_0x3c432f[_0x140253][_0x2d0131(0x13c)]=_0x30935a;}),_0x1f52f3[_0x19d15a(0x150)]((_0x138f4d,_0xc746ee)=>{_0x3c432f[_0xc746ee]['maxProducts']=_0x138f4d;}),_0x3e9afa[_0x19d15a(0x150)]((_0x51cc4f,_0x185023)=>{var _0x5139bb=_0x19d15a;_0x3c432f[_0x185023][_0x5139bb(0x10a)]=_0x51cc4f;}),_0x52f1f0[_0x19d15a(0x150)]((_0xccad70,_0x163c79)=>{var _0xb11296=_0x19d15a;_0x3c432f[_0x163c79][_0xb11296(0x16e)]=_0xccad70;}),_0x332e71[_0x19d15a(0x150)]((_0xf159da,_0x4ab1e5)=>{_0x3c432f[_0x4ab1e5]['batch_code']=_0xf159da;}),_0x25d4a9['forEach']((_0x239303,_0x1c2b5e)=>{var _0x2db454=_0x19d15a;_0x3c432f[_0x1c2b5e][_0x2db454(0xe2)]=_0x239303;});const _0x1b4a67=_0x3c432f[_0x19d15a(0xea)](_0x367093=>_0x367093[_0x19d15a(0x1a5)]!=='0'&&_0x367093['to_quantity']!==''||_0x367093[_0x19d15a(0xf2)]!=='0'&&_0x367093[_0x19d15a(0xf2)]!=='');var _0x43bb41=0x0;_0x1b4a67[_0x19d15a(0x150)](_0x11f466=>{var _0x433dd9=_0x19d15a;parseInt(_0x11f466[_0x433dd9(0x16b)])<parseInt(_0x11f466[_0x433dd9(0x1a5)])&&_0x43bb41++;});if(_0x43bb41!=0x0)return _0x42615b[_0x19d15a(0x18a)]('errors',_0x19d15a(0x14a)),_0x227489[_0x19d15a(0x104)](_0x19d15a(0x132));const _0x417cf4=await warehouse[_0x19d15a(0xdf)]({'name':_0x32289d['from_warehouse'],'room':_0x32289d[_0x19d15a(0xff)]});_0x32289d[_0x19d15a(0xe4)][_0x19d15a(0x150)](_0x251d06=>{var _0x46e765=_0x19d15a;if(_0x251d06[_0x46e765(0x1a5)]>0x0){const _0x193d78=_0x417cf4[_0x46e765(0x1a4)][_0x46e765(0x15e)](_0xc08bc6=>{var _0x5e093a=_0x46e765;_0xc08bc6[_0x5e093a(0xeb)]==_0x251d06[_0x5e093a(0xeb)]&&_0xc08bc6[_0x5e093a(0x16d)]==_0x251d06['from_bay']&&(_0xc08bc6[_0x5e093a(0x134)]=parseInt(_0xc08bc6[_0x5e093a(0x134)])+parseInt(_0x251d06[_0x5e093a(0x1a5)]));});}}),await _0x417cf4[_0x19d15a(0x12d)]();const _0x36672f=await warehouse[_0x19d15a(0xdf)]({'name':_0x32289d[_0x19d15a(0x13b)],'room':_0x32289d['to_room']});_0x32289d['product']['forEach'](_0x36999d=>{var _0xb866eb=_0x19d15a;if(_0x36999d[_0xb866eb(0x1a5)]>0x0){const _0x17868e=_0x36672f[_0xb866eb(0x1a4)][_0xb866eb(0x15e)](_0x4f41a8=>{var _0x21fd45=_0xb866eb;_0x4f41a8[_0x21fd45(0xeb)]==_0x36999d[_0x21fd45(0xeb)]&&_0x4f41a8[_0x21fd45(0x16d)]==_0x36999d[_0x21fd45(0x13e)]&&(_0x4f41a8['product_stock']=parseInt(_0x4f41a8[_0x21fd45(0x134)])-parseInt(_0x36999d[_0x21fd45(0x1a5)]));});}}),await _0x36672f[_0x19d15a(0x12d)](),_0x32289d[_0x19d15a(0x14d)]=_0x45f2c7,_0x32289d[_0x19d15a(0x1a0)]=_0x4fbf5f,_0x32289d[_0x19d15a(0x13b)]=_0x5c8fec,_0x32289d['product']=_0x1b4a67,_0x32289d[_0x19d15a(0x160)]=_0x30d47f,_0x32289d[_0x19d15a(0xe0)]=_0x2010c6;const _0x335931=await _0x32289d[_0x19d15a(0x12d)](),_0x387ced=await warehouse['findOne']({'name':_0x4fbf5f,'room':_0x17950c});_0x335931[_0x19d15a(0xe4)]['forEach'](_0xe5ff34=>{var _0x2275bc=_0x19d15a;if(_0xe5ff34[_0x2275bc(0x1a5)]>0x0){const _0x52b0c5=_0x387ced[_0x2275bc(0x1a4)][_0x2275bc(0x15e)](_0x280c7d=>{var _0x362fbc=_0x2275bc;_0x280c7d[_0x362fbc(0xeb)]==_0xe5ff34[_0x362fbc(0xeb)]&&_0x280c7d['bay']==_0xe5ff34[_0x362fbc(0xdc)]&&(_0x280c7d[_0x362fbc(0x134)]=parseInt(_0x280c7d[_0x362fbc(0x134)])-parseInt(_0xe5ff34[_0x362fbc(0x1a5)]));});}}),await _0x387ced[_0x19d15a(0x12d)]();const _0x15693c=await warehouse[_0x19d15a(0xdf)]({'name':_0x5c8fec,'room':_0x4d9ebe});_0x335931[_0x19d15a(0xe4)][_0x19d15a(0x150)](_0x1e057c=>{var _0x4c8804=_0x19d15a;if(_0x1e057c[_0x4c8804(0x1a5)]>0x0){var _0x21a29d=0x0;const _0x39a0ba=_0x15693c[_0x4c8804(0x1a4)][_0x4c8804(0x15e)](_0x1bcc55=>{var _0x50cf6e=_0x4c8804;_0x1bcc55[_0x50cf6e(0xeb)]==_0x1e057c['product_name']&&_0x1bcc55['bay']==_0x1e057c[_0x50cf6e(0x13e)]&&(_0x1bcc55[_0x50cf6e(0x134)]=parseInt(_0x1bcc55[_0x50cf6e(0x134)])+parseInt(_0x1e057c[_0x50cf6e(0x1a5)]),_0x21a29d++);});_0x21a29d=='0'&&(_0x15693c['product_details']=_0x15693c[_0x4c8804(0x1a4)][_0x4c8804(0x114)]({'product_name':_0x1e057c['product_name'],'product_stock':_0x1e057c[_0x4c8804(0x1a5)],'bay':_0x1e057c[_0x4c8804(0x13e)],'product_code':_0x1e057c[_0x4c8804(0x13c)],'primary_code':_0x1e057c[_0x4c8804(0xf6)],'secondary_code':_0x1e057c[_0x4c8804(0x19d)],'maxProducts':_0x1e057c[_0x4c8804(0xfc)]}));}}),await _0x15693c[_0x19d15a(0x12d)](),_0x42615b[_0x19d15a(0x18a)](_0x19d15a(0x170),_0x19d15a(0x149)),_0x227489['redirect']('/transfer_finished/view');}catch(_0x5eeb9c){console[_0x19d15a(0x169)](_0x5eeb9c);}}),router[a0_0xdfe148(0x18b)](a0_0xdfe148(0x19b),async(_0x218d2a,_0x490b2f)=>{var _0x2a43be=a0_0xdfe148;const {FromWareHouse:_0xf5bf8b,FromRoom:_0x5a352e,ToWarehouse:_0x214d10,ToRoom:_0x3ecd5f,primary_code:_0x2f0b82,Roomslist:_0x440724}=_0x218d2a[_0x2a43be(0x17c)],_0x2ffb5f=_0x440724[_0x2a43be(0x144)](','),_0x23b51b=[];async function _0x47973b(_0x1655eb){var _0x1e2a3b=_0x2a43be;const _0x301e50=await warehouse[_0x1e2a3b(0x14e)]([{'$match':{'name':_0xf5bf8b,'room':_0x1655eb}},{'$unwind':_0x1e2a3b(0x19a)},{'$match':{'product_details.primary_code':_0x2f0b82}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1e2a3b(0x180)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1e2a3b(0x172)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1e2a3b(0x146)},'level':{'$first':_0x1e2a3b(0x198)},'isle':{'$first':_0x1e2a3b(0x11c)},'type':{'$first':_0x1e2a3b(0x15b)},'pallet':{'$first':_0x1e2a3b(0x18e)},'unit':{'$first':_0x1e2a3b(0x17f)},'secondary_unit':{'$first':_0x1e2a3b(0xd6)},'storage':{'$first':_0x1e2a3b(0x124)},'rack':{'$first':_0x1e2a3b(0x19c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x1e2a3b(0xf7)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x1e2a3b(0x101)}}}]),_0x49933e=await warehouse[_0x1e2a3b(0x14e)]([{'$match':{'name':_0xf5bf8b,'room':_0x1655eb}},{'$unwind':_0x1e2a3b(0x19a)},{'$match':{'product_details.secondary_code':_0x2f0b82}},{'$group':{'_id':_0x1e2a3b(0xd1),'name':{'$first':_0x1e2a3b(0x180)},'instock':{'$first':_0x1e2a3b(0xf3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1e2a3b(0xd2)},'product_code':{'$first':_0x1e2a3b(0x146)},'level':{'$first':_0x1e2a3b(0x198)},'isle':{'$first':_0x1e2a3b(0x11c)},'type':{'$first':_0x1e2a3b(0x15b)},'pallet':{'$first':_0x1e2a3b(0x18e)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1e2a3b(0xd6)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1e2a3b(0xd4)},'production_date':{'$first':_0x1e2a3b(0xf5)},'batch_code':{'$first':_0x1e2a3b(0x143)},'maxPerUnit':{'$first':_0x1e2a3b(0xf7)},'roomNamed':{'$first':_0x1e2a3b(0xd0)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x1e2a3b(0x101)}}}]);if(_0x301e50['length']>0x0)_0x23b51b['push'](_0x301e50);else _0x49933e[_0x1e2a3b(0xe9)]>0x0&&_0x23b51b[_0x1e2a3b(0x121)](_0x49933e);}const _0x21d2e7=_0x2ffb5f[_0x2a43be(0x15e)](_0x369111=>_0x47973b(_0x369111));await Promise['all'](_0x21d2e7),_0x490b2f[_0x2a43be(0x102)](_0x23b51b);}),router[a0_0xdfe148(0x18b)](a0_0xdfe148(0x11d),async(_0x599547,_0x523f47)=>{var _0x54d1f2=a0_0xdfe148;try{const {FromWareHouse:_0x40cdd7,FromRoom:_0x483036,ToWarehouse:_0x51fd7c,ToRoom:_0x539973,secondary_code:_0x2ed46b}=_0x599547[_0x54d1f2(0x17c)],_0x3a0731=await warehouse['aggregate']([{'$match':{'name':_0x40cdd7}},{'$unwind':_0x54d1f2(0x19a)},{'$match':{'product_details.secondary_code':_0x2ed46b}},{'$group':{'_id':_0x54d1f2(0xd1),'name':{'$first':_0x54d1f2(0x180)},'primary_code':{'$first':_0x54d1f2(0x172)},'secondary_code':{'$first':_0x54d1f2(0xd2)},'product_code':{'$first':_0x54d1f2(0x146)},'instock':{'$first':_0x54d1f2(0xf3)},'warehouse':{'$first':_0x54d1f2(0x185)},'level':{'$first':_0x54d1f2(0x128)},'isle':{'$first':_0x54d1f2(0x18f)},'pallet':{'$first':_0x54d1f2(0x190)},'maxProducts':{'$first':_0x54d1f2(0x195)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':_0x54d1f2(0xd4)},'production_date':{'$first':_0x54d1f2(0xf5)}}}]);_0x523f47['status'](0xc8)[_0x54d1f2(0x102)](_0x3a0731);}catch(_0x14427b){_0x523f47[_0x54d1f2(0xf9)](0x194)['json']({'message':_0x14427b[_0x54d1f2(0x155)]});}}),router['post'](a0_0xdfe148(0x14f),async(_0x297813,_0x2a486f)=>{var _0x129c3d=a0_0xdfe148;try{const {FromWareHouse:_0x2d8fbc,FromRoom:_0x2cd60d,ToWarehouse:_0x33ceec,ToRoom:_0x21cce9,product_code:_0x1ff026}=_0x297813[_0x129c3d(0x17c)],_0x3daa49=await warehouse[_0x129c3d(0x14e)]([{'$match':{'name':_0x2d8fbc}},{'$unwind':_0x129c3d(0x19a)},{'$match':{'product_details.product_code':_0x1ff026}},{'$group':{'_id':_0x129c3d(0xd1),'name':{'$first':_0x129c3d(0x180)},'primary_code':{'$first':_0x129c3d(0x172)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x129c3d(0x146)},'instock':{'$first':_0x129c3d(0xf3)},'warehouse':{'$first':_0x129c3d(0x185)},'level':{'$first':_0x129c3d(0x128)},'isle':{'$first':_0x129c3d(0x18f)},'pallet':{'$first':_0x129c3d(0x190)},'maxProducts':{'$first':_0x129c3d(0x195)},'unit':{'$first':_0x129c3d(0x17f)}}}]);_0x2a486f[_0x129c3d(0xf9)](0xc8)[_0x129c3d(0x102)](_0x3daa49);}catch(_0x5dd362){_0x2a486f[_0x129c3d(0xf9)](0x194)[_0x129c3d(0x102)]({'message':_0x5dd362['message']});}}),router[a0_0xdfe148(0x18b)](a0_0xdfe148(0x136),async(_0x2a9010,_0x4acc53)=>{var _0x2be2c7=a0_0xdfe148;const {productCode:_0x4a6eda,bay:_0x335a5c,warehouses:_0x335ffd,room:_0x1acea2}=_0x2a9010['body'];console[_0x2be2c7(0x169)](_0x2a9010[_0x2be2c7(0x17c)]);try{const _0xc545d=await warehouse[_0x2be2c7(0x14e)]([{'$match':{'name':_0x335ffd,'room':_0x1acea2}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x335a5c)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x2be2c7(0x180)},'product_stock':{'$first':_0x2be2c7(0xf3)},'bay':{'$first':_0x2be2c7(0x198)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x4acc53[_0x2be2c7(0xf9)](0xc8)['json'](_0xc545d);}catch(_0x53f25f){_0x4acc53[_0x2be2c7(0xf9)](0x194)[_0x2be2c7(0x102)]({'message':_0x53f25f[_0x2be2c7(0x155)]});}}),module['exports']=router;