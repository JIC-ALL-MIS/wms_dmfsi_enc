var a0_0x4a8fff=a0_0x2aef;(function(_0x5c9d92,_0x5d31a1){var _0x3b615e=a0_0x2aef,_0x4a6719=_0x5c9d92();while(!![]){try{var _0x12ea30=-parseInt(_0x3b615e(0x193))/0x1+parseInt(_0x3b615e(0x20c))/0x2+-parseInt(_0x3b615e(0x190))/0x3*(parseInt(_0x3b615e(0x208))/0x4)+parseInt(_0x3b615e(0x173))/0x5*(parseInt(_0x3b615e(0x1b2))/0x6)+-parseInt(_0x3b615e(0x221))/0x7*(parseInt(_0x3b615e(0x1cf))/0x8)+-parseInt(_0x3b615e(0x184))/0x9+-parseInt(_0x3b615e(0x228))/0xa*(-parseInt(_0x3b615e(0x1cb))/0xb);if(_0x12ea30===_0x5d31a1)break;else _0x4a6719['push'](_0x4a6719['shift']());}catch(_0x15c27d){_0x4a6719['push'](_0x4a6719['shift']());}}}(a0_0x5efb,0x6572b));const express=require(a0_0x4a8fff(0x240)),app=express(),router=express[a0_0x4a8fff(0x175)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x4a8fff(0x1c1)),auth=require(a0_0x4a8fff(0x239)),users=require('../public/language/languages.json'),nodemailer=require(a0_0x4a8fff(0x1ec));function a0_0x5efb(){var _0x1d98f9=['post','product','$product.from_room_name','3864024kKCOZQ','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','all','German','host','redirect','product_code3','to_bay','Transfer\x20Edit\x20Successfully','$product_details.product_name','json','$product_details.unit','39rnbfYS','<span\x20style=\x22float:\x20right;\x22>','</span>','669eaAoaC','to_room_name','$product_details.bin','status','secondary_code','transfer_data','from_invoice','from_room_name','find','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','getDate','flash','$product_details.maxProducts','$room','<h5\x20style=\x22text-align:\x20left;\x22>','RoomAssigned','to_invoice','Chinese','to_prod_qty','$product_details.secondary_code','createTransport','render','$product_details.floorlevel','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','product_name','to_quantity','concat','log','$from_warehouse','maxPerUnit','/barcode_scanner2','1422ilHFvw','add_transfer_finished','product_stock','$product_details.level','max','updateOne','MaxStocks_data2','from_warehouse','push','primary_code','<h2>\x20','DRY\x20GOODS','padStart','secondary_unit','error','../models/all_models','slice','$product_details','$name','forEach','$product_details.product_stock','from_room','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','string','from_bay','33MGtcjc','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','body','Transfer\x20Mail','8gBxxrJ','Rack\x202','<strong>\x20Regards\x20</strong>','\x20<=>\x20','\x20<>\x20','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','then','Enabled','bay','length','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$_id','Portuguese\x20(BR)','MaxStocks_data','Enclosed','/view/:id','QA\x20Warehouse','<tr>','</div>','staff','Arabic','image','language','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','French','product_code','$product_details.production_date','split','Spanish','nodemailer','$product_details.pallet','/view','production_date','$product_details.secondary_unit','$product_details.product_code','$product_details.bay','$product','aggregate','from_quantity','Transfer\x20Finalize\x20Successfully','note','toString','params','TRFF-','role','port','message','Arabic\x20(ae)','finalize','</tr>','True','/view/add_transfer','to_warehouse','errors','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','findOne','$product_details.maxPerUnit','99496CQWkKG','/CheckingWarehouse','<!DOCTYPE\x20html>','Product\x20Transfer\x20successfully','658518YLdcni','exports','Rack\x201','prod_cat','$product_details.invoice','invoice','prod_name','abs','Portuguese','findById','FGSEmail','To_invoice','</td>','date','$product_details.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','</head><body>','$product_details.isle','English','New_Qty_Converted','transfer_finished','2537101fIUBMS','$product_details.primary_code','success','get','$invoice','<h5>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','1484470nMXnQW','$product_details.batch_code','primary_unit','English\x20(US)','<hr\x20class=\x22my-3\x22>','$to_warehouse','$product_details.storage','product_details','/barcode_scanner','/preview/:id','$product_details._id','getMonth','_id','id_transaction','edit_transfer_finished','filter','$product_details.expiry_date','../middleware/auth','map','user','site_title','<div>','to_floorlevel','unit','express','Hindi','$finalize','Error\x20Occurs','$product.to_room_name','email','to_prod_level','to_room','from_prod_qty','There\x27s\x20a\x20error\x20in\x20this\x20transaction','here2','warehouse','Ambient','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','ToRoomAssigned','save','\x20Order\x20Number\x20:\x20','floor','FROZEN\x20GOODS','from_prod_level','maxProducts','15965HRxaKY','catch','Router','batch_code','$product_details.rack','</body></html>','expiry_date','undefined','<html><head><title></title>','Finished\x20Goods','\x20</h2>','sendMail','An\x20error\x20occurred\x20while\x20saving\x20data.','logo'];a0_0x5efb=function(){return _0x1d98f9;};return a0_0x5efb();}router[a0_0x4a8fff(0x224)](a0_0x4a8fff(0x1ee),auth,async(_0x170023,_0x284afd)=>{var _0x4bd155=a0_0x4a8fff;try{const {username:_0x4a8fa0,email:_0x4ab288,role:_0x4d1f1c}=_0x170023['user'],_0x7263f=_0x170023['user'],_0x296538=await profile[_0x4bd155(0x206)]({'email':_0x7263f[_0x4bd155(0x245)]}),_0x26a8f2=await master_shop[_0x4bd155(0x19b)]();let _0x686921;if(_0x7263f['role']==_0x4bd155(0x1e2)){const _0x5e74de=await staff[_0x4bd155(0x206)]({'email':_0x7263f[_0x4bd155(0x245)]});_0x686921=await transfers_finished[_0x4bd155(0x19b)]({'from_warehouse':_0x5e74de[_0x4bd155(0x24b)]});}else _0x686921=await transfers_finished[_0x4bd155(0x1f4)]([{'$unwind':_0x4bd155(0x1f3)},{'$group':{'_id':_0x4bd155(0x1da),'invoice':{'$first':_0x4bd155(0x225)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x4bd155(0x1af)},'to_warehouse':{'$first':_0x4bd155(0x22d)},'from_room_name':{'$addToSet':_0x4bd155(0x183)},'to_room_name':{'$addToSet':_0x4bd155(0x244)},'finalize':{'$first':_0x4bd155(0x242)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x26a8f2[0x0]['language']=='English\x20(US)')var _0x15c8d7=users['English'];else{if(_0x26a8f2[0x0]['language']==_0x4bd155(0x241))var _0x15c8d7=users[_0x4bd155(0x241)];else{if(_0x26a8f2[0x0][_0x4bd155(0x1e5)]==_0x4bd155(0x187))var _0x15c8d7=users['German'];else{if(_0x26a8f2[0x0][_0x4bd155(0x1e5)]==_0x4bd155(0x1eb))var _0x15c8d7=users[_0x4bd155(0x1eb)];else{if(_0x26a8f2[0x0][_0x4bd155(0x1e5)]=='French')var _0x15c8d7=users[_0x4bd155(0x1e7)];else{if(_0x26a8f2[0x0]['language']==_0x4bd155(0x1db))var _0x15c8d7=users[_0x4bd155(0x214)];else{if(_0x26a8f2[0x0]['language']==_0x4bd155(0x1a4))var _0x15c8d7=users[_0x4bd155(0x1a4)];else{if(_0x26a8f2[0x0]['language']==_0x4bd155(0x1fe))var _0x15c8d7=users['Arabic'];}}}}}}}_0x284afd[_0x4bd155(0x1a8)](_0x4bd155(0x220),{'success':_0x170023[_0x4bd155(0x19e)](_0x4bd155(0x223)),'errors':_0x170023[_0x4bd155(0x19e)]('errors'),'role':_0x7263f,'profile':_0x296538,'master_shop':_0x26a8f2,'transfer':_0x686921,'language':_0x15c8d7});}catch(_0x5c8403){console[_0x4bd155(0x1ae)](_0x5c8403);}});async function getRandom8DigitNumber(){var _0x554447=a0_0x4a8fff;const _0x344f6f=0x989680,_0x4cf294=0x5f5e0ff,_0x4863a6=Math[_0x554447(0x16f)](Math['random']()*(_0x4cf294-_0x344f6f+0x1))+_0x344f6f;var _0x48fdc5;const _0x1195af=await transfers_finished[_0x554447(0x206)]({'invoice':'TRFF-'+_0x4863a6});return _0x1195af&&_0x1195af[_0x554447(0x1d8)]>0x0?_0x48fdc5=_0x554447(0x1fa)+_0x4863a6:_0x48fdc5='TRFF-'+_0x4863a6,_0x48fdc5;}router['get']('/view/add_transfer',auth,async(_0x39773d,_0x488d52)=>{var _0xcc7bd4=a0_0x4a8fff;try{const {username:_0x446d33,email:_0x46ee2f,role:_0x56dfe5}=_0x39773d[_0xcc7bd4(0x23b)],_0x49fedd=_0x39773d['user'],_0x4ae86e=await profile[_0xcc7bd4(0x206)]({'email':_0x49fedd[_0xcc7bd4(0x245)]}),_0x19cd2d=await master_shop[_0xcc7bd4(0x19b)]();let _0x4981ab;if(_0x49fedd[_0xcc7bd4(0x1fb)]==_0xcc7bd4(0x1e2)){const _0x165104=await staff[_0xcc7bd4(0x206)]({'email':_0x49fedd[_0xcc7bd4(0x245)]});_0x4981ab=await warehouse[_0xcc7bd4(0x1f4)]([{'$match':{'status':_0xcc7bd4(0x1d6),'name':_0x165104[_0xcc7bd4(0x24b)],'warehouse_category':_0xcc7bd4(0x17c),'name':{'$ne':_0xcc7bd4(0x1df)}}},{'$group':{'_id':_0xcc7bd4(0x1c4),'name':{'$first':_0xcc7bd4(0x1c4)}}}]);}else _0x4981ab=await warehouse[_0xcc7bd4(0x1f4)]([{'$match':{'status':'Enabled','warehouse_category':_0xcc7bd4(0x17c),'name':{'$ne':_0xcc7bd4(0x1df)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0x5d7366=await transfers_finished['find']({}),_0x560ba6=_0x5d7366[_0xcc7bd4(0x1d8)]+0x1,_0x3d79f7=_0xcc7bd4(0x1fa)+_0x560ba6[_0xcc7bd4(0x1f8)]()[_0xcc7bd4(0x1be)](0x5,'0');if(_0x19cd2d[0x0][_0xcc7bd4(0x1e5)]==_0xcc7bd4(0x22b))var _0x5935d5=users[_0xcc7bd4(0x21e)];else{if(_0x19cd2d[0x0][_0xcc7bd4(0x1e5)]=='Hindi')var _0x5935d5=users[_0xcc7bd4(0x241)];else{if(_0x19cd2d[0x0]['language']=='German')var _0x5935d5=users[_0xcc7bd4(0x187)];else{if(_0x19cd2d[0x0][_0xcc7bd4(0x1e5)]=='Spanish')var _0x5935d5=users['Spanish'];else{if(_0x19cd2d[0x0][_0xcc7bd4(0x1e5)]==_0xcc7bd4(0x1e7))var _0x5935d5=users[_0xcc7bd4(0x1e7)];else{if(_0x19cd2d[0x0][_0xcc7bd4(0x1e5)]==_0xcc7bd4(0x1db))var _0x5935d5=users[_0xcc7bd4(0x214)];else{if(_0x19cd2d[0x0][_0xcc7bd4(0x1e5)]=='Chinese')var _0x5935d5=users['Chinese'];else{if(_0x19cd2d[0x0]['language']=='Arabic\x20(ae)')var _0x5935d5=users[_0xcc7bd4(0x1e3)];}}}}}}}const _0x2e9eba=getRandom8DigitNumber();_0x2e9eba[_0xcc7bd4(0x1d5)](_0x4970e4=>{var _0x28ad94=_0xcc7bd4;_0x488d52['render'](_0x28ad94(0x1b3),{'success':_0x39773d[_0x28ad94(0x19e)](_0x28ad94(0x223)),'errors':_0x39773d[_0x28ad94(0x19e)](_0x28ad94(0x204)),'role':_0x49fedd,'profile':_0x4ae86e,'master_shop':_0x19cd2d,'warehouse':_0x4981ab,'language':_0x5935d5,'invoice':_0x4970e4});})[_0xcc7bd4(0x174)](_0x16e0fd=>{var _0x418bdf=_0xcc7bd4;_0x39773d['flash'](_0x418bdf(0x204),_0x418bdf(0x249)),_0x488d52[_0x418bdf(0x189)]('/transfer/view');});}catch(_0x490110){console[_0xcc7bd4(0x1ae)](_0x490110);}}),router[a0_0x4a8fff(0x181)](a0_0x4a8fff(0x202),auth,async(_0x932727,_0xcc8111)=>{var _0x35be5a=a0_0x4a8fff;try{const {date:_0x25a095,from_warehouse:_0x2cdb12,FromRoom_name:_0x8d5cff,to_warehouse:_0x2e98f8,ToRoom_name:_0x2c8a04,prod_name:_0x2a6330,from_prod_qty:_0x4cbea2,from_prod_level:_0x333f29,from_prod_isle:_0x30e5ac,from_prod_pallet:_0x3caea5,to_prod_qty:_0x2f3e48,to_prod_level:_0xe00191,to_prod_isle:_0x38f33c,to_prod_pallet:_0x360676,primary_code:_0x227444,secondary_code:_0x3d4247,product_code3:_0x46f728,note:_0xfeb2a6,MaxStocks_data2:_0x205f0f,invoice:_0x5edb61,expiry_date:_0x1e6940}=_0x932727[_0x35be5a(0x1cd)];if(typeof _0x2a6330=='string')var _0x1e2815=[_0x932727['body'][_0x35be5a(0x212)]],_0x25f566=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x248)]],_0x1bffba=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x171)]],_0x16a8ed=[_0x932727[_0x35be5a(0x1cd)]['New_Qty_Converted']],_0x37b0b7=[_0x932727[_0x35be5a(0x1cd)]['to_prod_level']],_0x3ff67b=[_0x932727['body'][_0x35be5a(0x1bb)]],_0x18ac69=[_0x932727['body'][_0x35be5a(0x197)]],_0xfcf139=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x18a)]],_0x5e2ae3=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1b8)]],_0x13bbff=[_0x932727['body'][_0x35be5a(0x22a)]],_0x329bc6=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1bf)]],_0x1f9e2e=[_0x932727['body'][_0x35be5a(0x176)]],_0x5b6ccb=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x179)]],_0x2a57f2=[_0x932727['body']['product_date']],_0x4dcf44=[_0x932727['body']['MaxStocks_data']],_0x51f518=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1b0)]],_0x67808c=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x20f)]],_0x1b8994=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1a2)]],_0x59e721=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x16c)]],_0x27d104=[_0x932727[_0x35be5a(0x1cd)]['from_invoice']],_0x2c69d7=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1a3)]],_0x567ed6=[_0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x235)]];else var _0x1e2815=[..._0x932727[_0x35be5a(0x1cd)]['prod_name']],_0x25f566=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x248)]],_0x1bffba=[..._0x932727['body'][_0x35be5a(0x171)]],_0x16a8ed=[..._0x932727['body'][_0x35be5a(0x21f)]],_0x37b0b7=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x246)]],_0x3ff67b=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1bb)]],_0x18ac69=[..._0x932727['body'][_0x35be5a(0x197)]],_0xfcf139=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x18a)]],_0x5e2ae3=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1b8)]],_0x13bbff=[..._0x932727['body'][_0x35be5a(0x22a)]],_0x329bc6=[..._0x932727['body'][_0x35be5a(0x1bf)]],_0x1f9e2e=[..._0x932727['body'][_0x35be5a(0x176)]],_0x5b6ccb=[..._0x932727[_0x35be5a(0x1cd)]['expiry_date']],_0x2a57f2=[..._0x932727[_0x35be5a(0x1cd)]['product_date']],_0x4dcf44=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1dc)]],_0x51f518=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1b0)]],_0x67808c=[..._0x932727[_0x35be5a(0x1cd)]['prod_cat']],_0x1b8994=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1a2)]],_0x59e721=[..._0x932727[_0x35be5a(0x1cd)]['ToRoomAssigned']],_0x27d104=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x199)]],_0x2c69d7=[..._0x932727[_0x35be5a(0x1cd)][_0x35be5a(0x1a3)]],_0x567ed6=[..._0x932727['body'][_0x35be5a(0x235)]];const _0x3060aa=_0x1e2815[_0x35be5a(0x23a)](_0x3ffeb0=>{return _0x3ffeb0={'product_name':_0x3ffeb0};});_0x25f566['forEach']((_0x370d85,_0x5d17f0)=>{var _0x5f0488=_0x35be5a;_0x3060aa[_0x5d17f0][_0x5f0488(0x1f5)]=_0x370d85;}),_0x1bffba['forEach']((_0x63577f,_0x39c18c)=>{var _0x20cd67=_0x35be5a;_0x3060aa[_0x39c18c][_0x20cd67(0x1ca)]=_0x63577f;}),_0x567ed6[_0x35be5a(0x1c5)]((_0x2eef55,_0x486992)=>{var _0x40a38d=_0x35be5a;_0x3060aa[_0x486992][_0x40a38d(0x235)]=_0x2eef55;}),_0x27d104[_0x35be5a(0x1c5)]((_0x4f572f,_0x240133)=>{var _0x19814c=_0x35be5a;_0x3060aa[_0x240133][_0x19814c(0x199)]=_0x4f572f;}),_0x2c69d7[_0x35be5a(0x1c5)]((_0x2a6ddc,_0x1d85ff)=>{var _0x3778f8=_0x35be5a;_0x3060aa[_0x1d85ff][_0x3778f8(0x217)]=_0x2a6ddc;}),_0x16a8ed['forEach']((_0x1be6b5,_0x5f0672)=>{_0x3060aa[_0x5f0672]['to_quantity']=_0x1be6b5;}),_0x37b0b7['forEach']((_0x1afe74,_0x105361)=>{_0x3060aa[_0x105361]['to_bay']=_0x1afe74;}),_0x3ff67b[_0x35be5a(0x1c5)]((_0x5cd867,_0xbb5162)=>{var _0x368ff3=_0x35be5a;_0x3060aa[_0xbb5162][_0x368ff3(0x1bb)]=_0x5cd867;}),_0x18ac69['forEach']((_0x20faa0,_0x39bfa7)=>{var _0x325e10=_0x35be5a;_0x3060aa[_0x39bfa7][_0x325e10(0x197)]=_0x20faa0;}),_0xfcf139['forEach']((_0x5482c4,_0x3ad8e9)=>{var _0x2c5a77=_0x35be5a;_0x3060aa[_0x3ad8e9][_0x2c5a77(0x1e8)]=_0x5482c4;}),_0x5e2ae3[_0x35be5a(0x1c5)]((_0x36d318,_0x220133)=>{_0x3060aa[_0x220133]['maxProducts']=_0x36d318;}),_0x13bbff[_0x35be5a(0x1c5)]((_0x25a883,_0x407a15)=>{var _0x25ca7b=_0x35be5a;_0x3060aa[_0x407a15][_0x25ca7b(0x23f)]=_0x25a883;}),_0x329bc6[_0x35be5a(0x1c5)]((_0x229bc9,_0x42670f)=>{var _0x537d7c=_0x35be5a;_0x3060aa[_0x42670f][_0x537d7c(0x1bf)]=_0x229bc9;}),_0x1f9e2e[_0x35be5a(0x1c5)]((_0x54d30b,_0xb7c56e)=>{var _0x5223cc=_0x35be5a;_0x3060aa[_0xb7c56e][_0x5223cc(0x176)]=_0x54d30b;}),_0x5b6ccb[_0x35be5a(0x1c5)]((_0x11e7f7,_0x59b52b)=>{_0x3060aa[_0x59b52b]['expiry_date']=_0x11e7f7;}),_0x2a57f2[_0x35be5a(0x1c5)]((_0x840a8f,_0x122c07)=>{_0x3060aa[_0x122c07]['production_date']=_0x840a8f;}),_0x4dcf44[_0x35be5a(0x1c5)]((_0x1a0965,_0x19c960)=>{var _0x99119a=_0x35be5a;_0x3060aa[_0x19c960][_0x99119a(0x172)]=_0x1a0965;}),_0x51f518[_0x35be5a(0x1c5)]((_0x825cb9,_0x5a274e)=>{var _0x1b704c=_0x35be5a;_0x3060aa[_0x5a274e][_0x1b704c(0x1b0)]=_0x825cb9;}),_0x67808c[_0x35be5a(0x1c5)]((_0x26f9e3,_0x494921)=>{var _0x1be2e3=_0x35be5a;_0x3060aa[_0x494921][_0x1be2e3(0x20f)]=_0x26f9e3;}),_0x1b8994[_0x35be5a(0x1c5)]((_0x50e54a,_0xa59629)=>{var _0x120546=_0x35be5a;_0x3060aa[_0xa59629][_0x120546(0x19a)]=_0x50e54a;}),_0x59e721[_0x35be5a(0x1c5)]((_0x24490d,_0x3fc47a)=>{var _0x28d697=_0x35be5a;_0x3060aa[_0x3fc47a][_0x28d697(0x194)]=_0x24490d;});const _0x5c49e1=_0x3060aa[_0x35be5a(0x237)](_0x3bced0=>_0x3bced0[_0x35be5a(0x1ac)]!=='0'&&_0x3bced0['to_quantity']!==''||_0x3bced0[_0x35be5a(0x23e)]!=='0'&&_0x3bced0['to_floorlevel']!=='');var _0x31a9d6=0x0;_0x5c49e1[_0x35be5a(0x1c5)](_0x5e2e14=>{var _0x3a7b28=_0x35be5a;parseInt(_0x5e2e14[_0x3a7b28(0x1f5)])<parseInt(_0x5e2e14[_0x3a7b28(0x1ac)])&&_0x31a9d6++;});if(_0x31a9d6!=0x0)return _0x932727[_0x35be5a(0x19e)](_0x35be5a(0x204),_0x35be5a(0x1d9)),_0xcc8111['redirect']('back');const _0x5dd018=new transfers_finished({'date':_0x25a095,'from_warehouse':_0x2cdb12,'to_warehouse':_0x2e98f8,'product':_0x5c49e1,'note':_0xfeb2a6,'invoice':_0x5edb61}),_0x5eefd1=await _0x5dd018['save']();_0x932727['flash'](_0x35be5a(0x223),_0x35be5a(0x20b)),_0xcc8111['redirect']('/transfer_finished/preview/'+_0x5eefd1[_0x35be5a(0x234)]);}catch(_0x9b88ca){console[_0x35be5a(0x1ae)](_0x9b88ca),_0xcc8111['status'](0xc8)[_0x35be5a(0x18e)]({'errorMessage':_0x9b88ca[_0x35be5a(0x1fd)]});}}),router[a0_0x4a8fff(0x224)](a0_0x4a8fff(0x231),auth,async(_0x1c6106,_0x1cae51)=>{var _0x1fd682=a0_0x4a8fff;try{const {username:_0x572bde,email:_0x1aee78,role:_0x223f71}=_0x1c6106['user'],_0x4be0a6=_0x1c6106[_0x1fd682(0x23b)],_0x199d8e=await profile[_0x1fd682(0x206)]({'email':_0x4be0a6['email']}),_0x219430=await master_shop['find'](),_0x290955=await transfers_finished[_0x1fd682(0x215)](_0x1c6106[_0x1fd682(0x1f9)]['id']);let _0x9d7265;if(_0x4be0a6[_0x1fd682(0x1fb)]==_0x1fd682(0x1e2)){const _0x567d4e=await staff[_0x1fd682(0x206)]({'email':_0x4be0a6[_0x1fd682(0x245)]});_0x9d7265=await warehouse[_0x1fd682(0x19b)]({'status':_0x1fd682(0x1d6),'name':_0x567d4e[_0x1fd682(0x24b)],'warehouse_category':'Finished\x20Goods'});}else _0x9d7265=await warehouse[_0x1fd682(0x19b)]({'status':_0x1fd682(0x1d6),'warehouse_category':_0x1fd682(0x17c)});const _0x80c3f0=await warehouse[_0x1fd682(0x1f4)]([{'$match':{'name':_0x290955[_0x1fd682(0x1b9)],'warehouse_category':_0x1fd682(0x17c)}},{'$unwind':_0x1fd682(0x1c3)},{'$group':{'_id':_0x1fd682(0x232),'name':{'$first':_0x1fd682(0x18d)},'product_stock':{'$first':_0x1fd682(0x1c6)},'bay':{'$first':_0x1fd682(0x1f2)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x1fd682(0x21a)},'floorlevel':{'$first':_0x1fd682(0x1a9)},'primary_code':{'$first':_0x1fd682(0x222)},'secondary_code':{'$first':_0x1fd682(0x1a6)},'product_code':{'$first':_0x1fd682(0x1f1)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x1fd682(0x238)},'production_date':{'$first':_0x1fd682(0x1e9)},'room':{'$first':_0x1fd682(0x1a0)},'warehoue_name':{'$first':_0x1fd682(0x1c4)}}}]),_0x463b7c=await product[_0x1fd682(0x19b)]({});if(_0x219430[0x0][_0x1fd682(0x1e5)]==_0x1fd682(0x22b)){var _0x4bd105=users[_0x1fd682(0x21e)];console['log'](_0x4bd105);}else{if(_0x219430[0x0][_0x1fd682(0x1e5)]==_0x1fd682(0x241))var _0x4bd105=users[_0x1fd682(0x241)];else{if(_0x219430[0x0][_0x1fd682(0x1e5)]=='German')var _0x4bd105=users[_0x1fd682(0x187)];else{if(_0x219430[0x0]['language']==_0x1fd682(0x1eb))var _0x4bd105=users[_0x1fd682(0x1eb)];else{if(_0x219430[0x0][_0x1fd682(0x1e5)]==_0x1fd682(0x1e7))var _0x4bd105=users['French'];else{if(_0x219430[0x0][_0x1fd682(0x1e5)]=='Portuguese\x20(BR)')var _0x4bd105=users['Portuguese'];else{if(_0x219430[0x0][_0x1fd682(0x1e5)]==_0x1fd682(0x1a4))var _0x4bd105=users['Chinese'];else{if(_0x219430[0x0][_0x1fd682(0x1e5)]=='Arabic\x20(ae)')var _0x4bd105=users[_0x1fd682(0x1e3)];}}}}}}}_0x1cae51[_0x1fd682(0x1a8)]('edit_transfer_finished_view',{'success':_0x1c6106[_0x1fd682(0x19e)](_0x1fd682(0x223)),'errors':_0x1c6106['flash']('errors'),'role':_0x4be0a6,'profile':_0x199d8e,'master_shop':_0x219430,'warehouse':_0x9d7265,'transfer':_0x290955,'stock':_0x80c3f0,'unit':_0x463b7c,'language':_0x4bd105});}catch(_0x4542ca){console['log'](_0x4542ca);}}),router['post'](a0_0x4a8fff(0x231),auth,async(_0xcbfa09,_0x4b9391)=>{var _0x55a7f4=a0_0x4a8fff;try{const {invoice:_0x537e2f,from_warehouse:_0x486a3a,FromRoom_name:_0x43543,to_warehouse:_0x1b48f0,ToRoom_name:_0x3e4f07}=_0xcbfa09[_0x55a7f4(0x1cd)],_0x55e5f9=await transfers_finished[_0x55a7f4(0x215)](_0xcbfa09[_0x55a7f4(0x1f9)]['id']),_0x1030ec=_0x55e5f9[_0x55a7f4(0x182)][_0x55a7f4(0x23a)](async _0x4cd0d2=>{var _0x25ceb6=_0x55a7f4;if(_0x4cd0d2[_0x25ceb6(0x1ac)]>0x0){var _0x2c8c58=await warehouse['findOne']({'name':_0x486a3a,'room':_0x4cd0d2[_0x25ceb6(0x19a)],'warehouse_category':_0x25ceb6(0x17c)});const _0x232d2c=_0x2c8c58[_0x25ceb6(0x22f)]['map'](_0x31a7d9=>{var _0x952f49=_0x25ceb6;_0x31a7d9[_0x952f49(0x1ab)]==_0x4cd0d2[_0x952f49(0x1ab)]&&_0x31a7d9[_0x952f49(0x1d7)]==_0x4cd0d2[_0x952f49(0x1ca)]&&_0x31a7d9['expiry_date']==_0x4cd0d2[_0x952f49(0x179)]&&_0x31a7d9[_0x952f49(0x1ef)]==_0x4cd0d2[_0x952f49(0x1ef)]&&_0x31a7d9[_0x952f49(0x176)]==_0x4cd0d2['batch_code']&&_0x31a7d9[_0x952f49(0x211)]==_0x4cd0d2[_0x952f49(0x199)]&&(console['log']('here1',_0x31a7d9[_0x952f49(0x1b4)]),typeof _0x4cd0d2['id_transaction']==_0x952f49(0x17a)?_0x31a7d9[_0x952f49(0x1b4)]=Math[_0x952f49(0x1b6)](0x0,Math[_0x952f49(0x213)](_0x31a7d9[_0x952f49(0x1b4)])-Math[_0x952f49(0x213)](_0x4cd0d2[_0x952f49(0x1ac)])):_0x31a7d9[_0x952f49(0x1b4)]=Math[_0x952f49(0x1b6)](0x0,Math['abs'](_0x31a7d9[_0x952f49(0x1b4)])-Math[_0x952f49(0x213)](_0x4cd0d2['to_quantity'])));});}return _0x2c8c58;});Promise[_0x55a7f4(0x186)](_0x1030ec)[_0x55a7f4(0x1d5)](async _0x73a5e6=>{var _0x1f3650=_0x55a7f4;try{for(const _0x4c9dd5 of _0x73a5e6){await _0x4c9dd5[_0x1f3650(0x16d)]();}const _0x2d3a59=_0x55e5f9['product'][_0x1f3650(0x23a)](async _0x554e5f=>{var _0x345bc4=_0x1f3650,_0x61ee60=await warehouse[_0x345bc4(0x206)]({'name':_0x1b48f0,'room':_0x554e5f[_0x345bc4(0x194)]});if(_0x554e5f[_0x345bc4(0x1ac)]>0x0){var _0x2ad752=0x0;const _0x3352d9=_0x61ee60[_0x345bc4(0x22f)]['map'](_0x339581=>{var _0x6f79f5=_0x345bc4;_0x339581[_0x6f79f5(0x1ab)]==_0x554e5f[_0x6f79f5(0x1ab)]&&_0x339581[_0x6f79f5(0x1d7)]==_0x554e5f[_0x6f79f5(0x18b)]&&_0x339581[_0x6f79f5(0x179)]==_0x554e5f[_0x6f79f5(0x179)]&&_0x339581[_0x6f79f5(0x1ef)]==_0x554e5f[_0x6f79f5(0x1ef)]&&_0x339581[_0x6f79f5(0x176)]==_0x554e5f['batch_code']&&_0x339581[_0x6f79f5(0x211)]==_0x554e5f[_0x6f79f5(0x217)]&&(typeof _0x554e5f[_0x6f79f5(0x235)]==_0x6f79f5(0x17a)?(console[_0x6f79f5(0x1ae)](_0x6f79f5(0x24a),_0x339581['product_stock']+_0x6f79f5(0x1d3)+_0x339581['_id']+_0x6f79f5(0x1d2)+Math[_0x6f79f5(0x213)](_0x339581[_0x6f79f5(0x1b4)])+Math[_0x6f79f5(0x213)](_0x554e5f['to_quantity'])),_0x339581[_0x6f79f5(0x1b4)]=Math['abs'](_0x339581[_0x6f79f5(0x1b4)])+Math[_0x6f79f5(0x213)](_0x554e5f[_0x6f79f5(0x1ac)])):_0x339581[_0x6f79f5(0x1b4)]=Math[_0x6f79f5(0x213)](_0x339581[_0x6f79f5(0x1b4)])+Math[_0x6f79f5(0x213)](_0x554e5f[_0x6f79f5(0x1ac)]),_0x2ad752++);});_0x2ad752=='0'&&(_0x61ee60['product_details']=_0x61ee60[_0x345bc4(0x22f)][_0x345bc4(0x1ad)]({'product_name':_0x554e5f[_0x345bc4(0x1ab)],'product_stock':_0x554e5f[_0x345bc4(0x1ac)],'bay':_0x554e5f[_0x345bc4(0x18b)],'product_code':_0x554e5f[_0x345bc4(0x1e8)],'primary_code':_0x554e5f[_0x345bc4(0x1bb)],'secondary_code':_0x554e5f[_0x345bc4(0x197)],'expiry_date':_0x554e5f[_0x345bc4(0x179)],'production_date':_0x554e5f[_0x345bc4(0x1ef)],'maxProducts':_0x554e5f[_0x345bc4(0x172)],'batch_code':_0x554e5f[_0x345bc4(0x176)],'secondary_unit':_0x554e5f['secondary_unit'],'unit':_0x554e5f['unit'],'maxProducts':_0x554e5f['maxProducts'],'maxPerUnit':_0x554e5f[_0x345bc4(0x1b0)],'invoice':_0x554e5f[_0x345bc4(0x217)]}));}return _0x61ee60;});Promise[_0x1f3650(0x186)](_0x2d3a59)[_0x1f3650(0x1d5)](async _0x3fc66f=>{var _0x35b584=_0x1f3650;try{for(const _0x1ef6f9 of _0x3fc66f){await warehouse[_0x35b584(0x1b7)]({'_id':_0x1ef6f9[_0x35b584(0x234)]},{'$addToSet':{'product_details':{'$each':_0x1ef6f9[_0x35b584(0x22f)]}}});}_0x55e5f9[_0x35b584(0x1ff)]=_0x35b584(0x201);const _0x4e85f4=await _0x55e5f9[_0x35b584(0x16d)](),_0xcec2f4=await master_shop['find'](),_0x1a6004=await email_settings[_0x35b584(0x206)](),_0xd75ca8=await supervisor_settings['find']();var _0xbe39c3=_0x55e5f9[_0x35b584(0x182)],_0x517007='',_0x41ee6b;for(_0x41ee6b in _0xbe39c3){var _0x23d6bc='FG';_0x55e5f9[_0x35b584(0x203)]==_0x35b584(0x1bd)&&(_0x23d6bc='DG'),_0x517007+=_0x35b584(0x1e0)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xbe39c3[_0x41ee6b][_0x35b584(0x1ab)]+_0x35b584(0x218)+_0x35b584(0x24d)+_0xbe39c3[_0x41ee6b][_0x35b584(0x1e8)]+'</td>'+_0x35b584(0x24d)+_0xbe39c3[_0x41ee6b]['to_quantity']+_0x35b584(0x218)+_0x35b584(0x24d)+_0xbe39c3[_0x41ee6b][_0x35b584(0x23f)]+'</td>'+_0x35b584(0x24d)+_0xbe39c3[_0x41ee6b][_0x35b584(0x1bf)]+_0x35b584(0x218)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x55e5f9[_0x35b584(0x203)]+_0x35b584(0x218)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xbe39c3[_0x41ee6b][_0x35b584(0x194)]+_0x35b584(0x218)+_0x35b584(0x24d)+_0x23d6bc+_0xbe39c3[_0x41ee6b][_0x35b584(0x18b)]+_0x35b584(0x218)+'</tr>';}let _0x611116=nodemailer[_0x35b584(0x1a7)]({'host':_0x1a6004[_0x35b584(0x188)],'port':Number(_0x1a6004[_0x35b584(0x1fc)]),'secure':![],'auth':{'user':_0x1a6004['email'],'pass':_0x1a6004['password']}}),_0x40347b={'from':_0x1a6004[_0x35b584(0x245)],'to':_0xd75ca8[0x0][_0x35b584(0x216)],'subject':_0x35b584(0x1ce),'attachments':[{'filename':'Logo.png','path':__dirname+'/../public'+'/upload/'+_0xcec2f4[0x0][_0x35b584(0x1e4)],'cid':_0x35b584(0x180)}],'html':_0x35b584(0x20a)+_0x35b584(0x17b)+_0x35b584(0x21c)+_0x35b584(0x23d)+_0x35b584(0x1c8)+_0x35b584(0x23d)+_0x35b584(0x185)+'</div>'+_0x35b584(0x23d)+_0x35b584(0x1bc)+_0xcec2f4[0x0][_0x35b584(0x23c)]+_0x35b584(0x17d)+_0x35b584(0x1e1)+_0x35b584(0x1e1)+_0x35b584(0x22c)+_0x35b584(0x23d)+_0x35b584(0x1a1)+_0x35b584(0x16e)+_0x55e5f9[_0x35b584(0x211)]+'\x20'+_0x35b584(0x191)+'\x20Order\x20Date\x20:\x20'+_0x55e5f9[_0x35b584(0x219)]+'\x20'+_0x35b584(0x192)+'</h5>'+_0x35b584(0x1e1)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x35b584(0x1d4)+_0x35b584(0x1e0)+_0x35b584(0x19c)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x35b584(0x21b)+_0x35b584(0x227)+_0x35b584(0x1aa)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0x35b584(0x1e6)+_0x35b584(0x205)+_0x35b584(0x200)+'</thead>'+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x517007+'\x20'+'</tbody>'+'</table>'+_0x35b584(0x23d)+_0x35b584(0x1d1)+_0x35b584(0x226)+_0xcec2f4[0x0]['site_title']+'</h5>'+_0x35b584(0x1e1)+'</div>'+_0x35b584(0x178)};_0x611116[_0x35b584(0x17e)](_0x40347b,function(_0x273444,_0x3a3172){var _0x4c92fc=_0x35b584;_0x273444?(console[_0x4c92fc(0x1ae)](_0x273444),console[_0x4c92fc(0x1ae)](_0x4c92fc(0x243))):console['log']('Email\x20sent\x20successfully');}),_0xcbfa09[_0x35b584(0x19e)](_0x35b584(0x223),_0x35b584(0x1f6)),_0x4b9391[_0x35b584(0x189)]('/picking_list/PDF_transfer/'+_0x4e85f4['_id']);}catch(_0x56d794){console[_0x35b584(0x1c0)](_0x56d794),_0x4b9391[_0x35b584(0x196)](0x1f4)['json']({'error':_0x35b584(0x1cc)});}})[_0x1f3650(0x174)](_0x57328c=>{var _0x506762=_0x1f3650;console[_0x506762(0x1c0)](_0x57328c),_0x4b9391[_0x506762(0x196)](0x1f4)[_0x506762(0x18e)]({'error':'An\x20error\x20occurred.'});});}catch(_0x466d53){console[_0x1f3650(0x1c0)](_0x466d53),_0x4b9391[_0x1f3650(0x196)](0x1f4)[_0x1f3650(0x18e)]({'error':_0x1f3650(0x17f)});}})[_0x55a7f4(0x174)](_0x274a03=>{var _0x46caca=_0x55a7f4;console[_0x46caca(0x1c0)](_0x274a03),_0x4b9391[_0x46caca(0x196)](0x1f4)[_0x46caca(0x18e)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3cad48){_0x4b9391[_0x55a7f4(0x18e)]({'message':_0x3cad48[_0x55a7f4(0x1fd)]});}});function BayBinSelected(_0x3cfb51,_0x59c3e4){var _0x2d81a7=a0_0x4a8fff,_0x439980=[];let _0x24d6eb=[];var _0x584143=[];if(_0x3cfb51=='DRY\x20GOODS'){switch(_0x59c3e4){case _0x2d81a7(0x20e):_0x439980=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x2d81a7(0x1d0):_0x439980=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x584143=['DG'];}else{if(_0x3cfb51==_0x2d81a7(0x170)){switch(_0x59c3e4){case'Rack\x201':_0x439980=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x2d81a7(0x1d0):_0x439980=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x584143=['FG'];}}return{'levels':_0x439980,'identify':_0x584143};}function a0_0x2aef(_0x39199d,_0xe5c536){var _0x5efb6d=a0_0x5efb();return a0_0x2aef=function(_0x2aef26,_0x747214){_0x2aef26=_0x2aef26-0x16c;var _0x2b72ea=_0x5efb6d[_0x2aef26];return _0x2b72ea;},a0_0x2aef(_0x39199d,_0xe5c536);}router[a0_0x4a8fff(0x224)](a0_0x4a8fff(0x1de),auth,async(_0x289c48,_0x27554a)=>{var _0x1571f6=a0_0x4a8fff;try{const {username:_0x239105,email:_0xb94e28,role:_0x113cb6}=_0x289c48[_0x1571f6(0x23b)],_0xb516a7=_0x289c48[_0x1571f6(0x23b)],_0x1edc9d=await profile[_0x1571f6(0x206)]({'email':_0xb516a7[_0x1571f6(0x245)]}),_0x27c2d2=await master_shop[_0x1571f6(0x19b)](),_0x5c80e2=await transfers_finished['findById'](_0x289c48[_0x1571f6(0x1f9)]['id']);let _0xb060b2=new Date(_0x5c80e2[_0x1571f6(0x179)]),_0x23f5ce=('0'+_0xb060b2[_0x1571f6(0x19d)]())['slice'](-0x2),_0x113aab=('0'+(_0xb060b2[_0x1571f6(0x233)]()+0x1))[_0x1571f6(0x1c2)](-0x2),_0x3877be=_0xb060b2['getFullYear'](),_0x2728c5=_0x3877be+'-'+_0x113aab+'-'+_0x23f5ce,_0x45c86a;if(_0xb516a7[_0x1571f6(0x1fb)]==_0x1571f6(0x1e2)){const _0x21559e=await staff[_0x1571f6(0x206)]({'email':_0xb516a7[_0x1571f6(0x245)]});_0x45c86a=await warehouse[_0x1571f6(0x19b)]({'status':'Enabled','name':_0x21559e[_0x1571f6(0x24b)],'warehouse_category':'Finished\x20Goods'});}else _0x45c86a=await warehouse[_0x1571f6(0x19b)]({'status':_0x1571f6(0x1d6),'warehouse_category':_0x1571f6(0x17c)});const _0x4f167e=await warehouse['aggregate']([{'$match':{'name':_0x5c80e2[_0x1571f6(0x1b9)],'room':_0x5c80e2[_0x1571f6(0x1c7)]}},{'$unwind':_0x1571f6(0x1c3)},{'$group':{'_id':_0x1571f6(0x232),'name':{'$first':_0x1571f6(0x18d)},'product_stock':{'$first':_0x1571f6(0x1c6)},'bay':{'$first':_0x1571f6(0x1f2)},'bin':{'$first':_0x1571f6(0x195)},'type':{'$first':_0x1571f6(0x21a)},'floorlevel':{'$first':_0x1571f6(0x1a9)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x1571f6(0x1a6)},'product_code':{'$first':_0x1571f6(0x1f1)},'storage':{'$first':_0x1571f6(0x22e)},'rack':{'$first':'$product_details.rack'}}}]);var _0x1f39ea=[0x1,0x2,0x3,0x4],_0x268ec1=['A','B','C','D','E','F','G','H','I','J'],_0x47b4f9=[_0x1571f6(0x24c),_0x1571f6(0x1dd)];const _0x3888cd=await product[_0x1571f6(0x19b)]({}),_0x189d56=BayBinSelected(_0x5c80e2[_0x1571f6(0x203)],_0x5c80e2['to_room']);if(_0x27c2d2[0x0][_0x1571f6(0x1e5)]==_0x1571f6(0x22b)){var _0x427b67=users['English'];console[_0x1571f6(0x1ae)](_0x427b67);}else{if(_0x27c2d2[0x0][_0x1571f6(0x1e5)]==_0x1571f6(0x241))var _0x427b67=users[_0x1571f6(0x241)];else{if(_0x27c2d2[0x0][_0x1571f6(0x1e5)]=='German')var _0x427b67=users[_0x1571f6(0x187)];else{if(_0x27c2d2[0x0][_0x1571f6(0x1e5)]==_0x1571f6(0x1eb))var _0x427b67=users['Spanish'];else{if(_0x27c2d2[0x0]['language']==_0x1571f6(0x1e7))var _0x427b67=users['French'];else{if(_0x27c2d2[0x0]['language']==_0x1571f6(0x1db))var _0x427b67=users[_0x1571f6(0x214)];else{if(_0x27c2d2[0x0][_0x1571f6(0x1e5)]==_0x1571f6(0x1a4))var _0x427b67=users['Chinese'];else{if(_0x27c2d2[0x0][_0x1571f6(0x1e5)]==_0x1571f6(0x1fe))var _0x427b67=users[_0x1571f6(0x1e3)];}}}}}}}_0x27554a[_0x1571f6(0x1a8)](_0x1571f6(0x236),{'success':_0x289c48[_0x1571f6(0x19e)](_0x1571f6(0x223)),'errors':_0x289c48[_0x1571f6(0x19e)](_0x1571f6(0x204)),'role':_0xb516a7,'profile':_0x1edc9d,'master_shop':_0x27c2d2,'warehouse':_0x45c86a,'transfer':_0x5c80e2,'stock':_0x4f167e,'unit':_0x3888cd,'language':_0x427b67,'levels':_0x1f39ea,'Isle':_0x268ec1,'rooms_data':_0x47b4f9,'ed_fullDate':_0x2728c5,'dataSelected':_0x189d56});}catch(_0x5a1a67){console['log'](_0x5a1a67);}}),router[a0_0x4a8fff(0x181)](a0_0x4a8fff(0x1de),auth,async(_0x122603,_0x239127)=>{var _0x1de81f=a0_0x4a8fff;try{const _0x5694d6=_0x122603[_0x1de81f(0x1f9)]['id'];console[_0x1de81f(0x1ae)](_0x122603['body']);const _0x237577=await transfers_finished[_0x1de81f(0x215)](_0x5694d6);console[_0x1de81f(0x1ae)](_0x1de81f(0x198),_0x237577);const {date:_0x4ff835,from_warehouse:_0x2dfb9b,FromRoom_name:_0x302f0e,to_warehouse:_0x11af48,ToRoom_name:_0xf5549f,prod_name:_0x34a92f,from_prod_qty:_0x22cfb0,from_prod_level:_0x1e6981,from_prod_isle:_0x2f1e5f,from_prod_pallet:_0x24ad60,to_prod_qty:_0x8b118a,to_prod_level:_0x224324,to_prod_isle:_0x1be824,to_prod_pallet:_0x52adde,primary_code:_0x5b52fb,secondary_code:_0x13d7f2,product_code3:_0x1f1b55,note:_0x1a4269,invoice:_0x3ce561,expiry_date:_0x6f3649}=_0x122603[_0x1de81f(0x1cd)];if(typeof _0x34a92f==_0x1de81f(0x1c9))var _0x58a125=[_0x122603[_0x1de81f(0x1cd)]['prod_name']],_0x1a007c=[_0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x248)]],_0x46efec=[_0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x171)]],_0x4bdf66=[_0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x1a5)]],_0x214262=[_0x122603['body']['to_prod_level']],_0x7ab5d9=[_0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x1bb)]],_0x44c851=[_0x122603['body'][_0x1de81f(0x197)]],_0x8d4820=[_0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x18a)]],_0x4f0d2e=[_0x122603['body'][_0x1de81f(0x1b8)]],_0x58e689=[_0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x23f)]],_0x1be636=[_0x122603['body'][_0x1de81f(0x1bf)]],_0x276bba=[_0x122603[_0x1de81f(0x1cd)]['batch_code']],_0x597790=[_0x122603['body'][_0x1de81f(0x179)]];else var _0x58a125=[..._0x122603['body']['prod_name']],_0x1a007c=[..._0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x248)]],_0x46efec=[..._0x122603['body'][_0x1de81f(0x171)]],_0x4bdf66=[..._0x122603['body']['to_prod_qty']],_0x214262=[..._0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x246)]],_0x7ab5d9=[..._0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x1bb)]],_0x44c851=[..._0x122603['body']['secondary_code']],_0x8d4820=[..._0x122603[_0x1de81f(0x1cd)]['product_code3']],_0x4f0d2e=[..._0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x1b8)]],_0x58e689=[..._0x122603[_0x1de81f(0x1cd)]['unit']],_0x1be636=[..._0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x1bf)]],_0x276bba=[..._0x122603[_0x1de81f(0x1cd)]['batch_code']],_0x597790=[..._0x122603[_0x1de81f(0x1cd)][_0x1de81f(0x179)]];const _0x237394=_0x58a125['map'](_0x584916=>{return _0x584916={'product_name':_0x584916};});_0x1a007c[_0x1de81f(0x1c5)]((_0x572562,_0x359e6f)=>{_0x237394[_0x359e6f]['from_quantity']=_0x572562;}),_0x46efec['forEach']((_0x215491,_0x576881)=>{var _0x5a4fa9=_0x1de81f;_0x237394[_0x576881][_0x5a4fa9(0x1ca)]=_0x215491;}),_0x4bdf66['forEach']((_0x3f9868,_0x309347)=>{var _0x169c75=_0x1de81f;_0x237394[_0x309347][_0x169c75(0x1ac)]=_0x3f9868;}),_0x214262[_0x1de81f(0x1c5)]((_0x26f842,_0x4bb22a)=>{_0x237394[_0x4bb22a]['to_bay']=_0x26f842;}),_0x7ab5d9['forEach']((_0x20385e,_0x3cc58b)=>{var _0x5e4e31=_0x1de81f;_0x237394[_0x3cc58b][_0x5e4e31(0x1bb)]=_0x20385e;}),_0x44c851[_0x1de81f(0x1c5)]((_0x23e7ec,_0x4fc903)=>{var _0x599769=_0x1de81f;_0x237394[_0x4fc903][_0x599769(0x197)]=_0x23e7ec;}),_0x8d4820['forEach']((_0x1c48de,_0x505c29)=>{var _0x406742=_0x1de81f;_0x237394[_0x505c29][_0x406742(0x1e8)]=_0x1c48de;}),_0x4f0d2e['forEach']((_0xa4a747,_0x10108b)=>{var _0x578445=_0x1de81f;_0x237394[_0x10108b][_0x578445(0x172)]=_0xa4a747;}),_0x58e689[_0x1de81f(0x1c5)]((_0x4d99b7,_0x44ac35)=>{_0x237394[_0x44ac35]['unit']=_0x4d99b7;}),_0x1be636['forEach']((_0x2c4f78,_0x3575ba)=>{var _0x3741bd=_0x1de81f;_0x237394[_0x3575ba][_0x3741bd(0x1bf)]=_0x2c4f78;}),_0x276bba[_0x1de81f(0x1c5)]((_0x516165,_0x4a82cc)=>{var _0x323187=_0x1de81f;_0x237394[_0x4a82cc][_0x323187(0x176)]=_0x516165;}),_0x597790[_0x1de81f(0x1c5)]((_0xb81ea2,_0x63e05d)=>{var _0x471627=_0x1de81f;_0x237394[_0x63e05d][_0x471627(0x179)]=_0xb81ea2;});const _0x593777=_0x237394[_0x1de81f(0x237)](_0x329c0b=>_0x329c0b[_0x1de81f(0x1ac)]!=='0'&&_0x329c0b[_0x1de81f(0x1ac)]!==''||_0x329c0b['to_floorlevel']!=='0'&&_0x329c0b[_0x1de81f(0x23e)]!=='');var _0x584b68=0x0;_0x593777[_0x1de81f(0x1c5)](_0x106042=>{var _0x5ec524=_0x1de81f;parseInt(_0x106042[_0x5ec524(0x1f5)])<parseInt(_0x106042['to_quantity'])&&_0x584b68++;});if(_0x584b68!=0x0)return _0x122603[_0x1de81f(0x19e)](_0x1de81f(0x204),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x239127[_0x1de81f(0x189)]('back');const _0x3fbd0a=await warehouse[_0x1de81f(0x206)]({'name':_0x237577[_0x1de81f(0x1b9)],'room':_0x237577[_0x1de81f(0x1c7)]});_0x237577[_0x1de81f(0x182)][_0x1de81f(0x1c5)](_0x30be0c=>{var _0x575624=_0x1de81f;if(_0x30be0c[_0x575624(0x1ac)]>0x0){const _0x4cdf5c=_0x3fbd0a[_0x575624(0x22f)]['map'](_0x3485cd=>{var _0x3ebd9e=_0x575624;_0x3485cd[_0x3ebd9e(0x1ab)]==_0x30be0c[_0x3ebd9e(0x1ab)]&&_0x3485cd[_0x3ebd9e(0x1d7)]==_0x30be0c[_0x3ebd9e(0x1ca)]&&(_0x3485cd[_0x3ebd9e(0x1b4)]=parseInt(_0x3485cd[_0x3ebd9e(0x1b4)])+parseInt(_0x30be0c[_0x3ebd9e(0x1ac)]));});}}),await _0x3fbd0a[_0x1de81f(0x16d)]();const _0x2c7861=await warehouse[_0x1de81f(0x206)]({'name':_0x237577['to_warehouse'],'room':_0x237577[_0x1de81f(0x247)]});_0x237577[_0x1de81f(0x182)]['forEach'](_0x19c38e=>{var _0x39a4e0=_0x1de81f;if(_0x19c38e[_0x39a4e0(0x1ac)]>0x0){const _0x30a887=_0x2c7861[_0x39a4e0(0x22f)][_0x39a4e0(0x23a)](_0x23b1e0=>{var _0x16919a=_0x39a4e0;_0x23b1e0[_0x16919a(0x1ab)]==_0x19c38e['product_name']&&_0x23b1e0[_0x16919a(0x1d7)]==_0x19c38e[_0x16919a(0x18b)]&&(_0x23b1e0[_0x16919a(0x1b4)]=parseInt(_0x23b1e0[_0x16919a(0x1b4)])-parseInt(_0x19c38e[_0x16919a(0x1ac)]));});}}),await _0x2c7861['save'](),_0x237577[_0x1de81f(0x219)]=_0x4ff835,_0x237577[_0x1de81f(0x1b9)]=_0x2dfb9b,_0x237577['to_warehouse']=_0x11af48,_0x237577['product']=_0x593777,_0x237577[_0x1de81f(0x1f7)]=_0x1a4269,_0x237577[_0x1de81f(0x211)]=_0x3ce561;const _0x3b2ee7=await _0x237577[_0x1de81f(0x16d)](),_0x9ffa77=await warehouse[_0x1de81f(0x206)]({'name':_0x2dfb9b,'room':_0x302f0e});_0x3b2ee7[_0x1de81f(0x182)]['forEach'](_0x329767=>{var _0x5a8465=_0x1de81f;if(_0x329767[_0x5a8465(0x1ac)]>0x0){const _0x413e82=_0x9ffa77[_0x5a8465(0x22f)][_0x5a8465(0x23a)](_0x442702=>{var _0x144dec=_0x5a8465;_0x442702[_0x144dec(0x1ab)]==_0x329767[_0x144dec(0x1ab)]&&_0x442702[_0x144dec(0x1d7)]==_0x329767[_0x144dec(0x1ca)]&&(_0x442702['product_stock']=parseInt(_0x442702[_0x144dec(0x1b4)])-parseInt(_0x329767['to_quantity']));});}}),await _0x9ffa77[_0x1de81f(0x16d)]();const _0x334e1f=await warehouse[_0x1de81f(0x206)]({'name':_0x11af48,'room':_0xf5549f});_0x3b2ee7[_0x1de81f(0x182)][_0x1de81f(0x1c5)](_0x994e42=>{var _0x124d6f=_0x1de81f;if(_0x994e42[_0x124d6f(0x1ac)]>0x0){var _0x25c601=0x0;const _0x18d51c=_0x334e1f[_0x124d6f(0x22f)][_0x124d6f(0x23a)](_0x4145c8=>{var _0x53c18f=_0x124d6f;_0x4145c8['product_name']==_0x994e42[_0x53c18f(0x1ab)]&&_0x4145c8[_0x53c18f(0x1d7)]==_0x994e42[_0x53c18f(0x18b)]&&(_0x4145c8[_0x53c18f(0x1b4)]=parseInt(_0x4145c8[_0x53c18f(0x1b4)])+parseInt(_0x994e42[_0x53c18f(0x1ac)]),_0x25c601++);});_0x25c601=='0'&&(_0x334e1f['product_details']=_0x334e1f[_0x124d6f(0x22f)]['concat']({'product_name':_0x994e42[_0x124d6f(0x1ab)],'product_stock':_0x994e42[_0x124d6f(0x1ac)],'bay':_0x994e42['to_bay'],'product_code':_0x994e42[_0x124d6f(0x1e8)],'primary_code':_0x994e42[_0x124d6f(0x1bb)],'secondary_code':_0x994e42[_0x124d6f(0x197)],'maxProducts':_0x994e42['maxProducts']}));}}),await _0x334e1f[_0x1de81f(0x16d)](),_0x122603[_0x1de81f(0x19e)](_0x1de81f(0x223),_0x1de81f(0x18c)),_0x239127[_0x1de81f(0x189)]('/transfer_finished/view');}catch(_0x13af29){console['log'](_0x13af29);}}),router[a0_0x4a8fff(0x181)](a0_0x4a8fff(0x230),async(_0xe52d07,_0xde3f60)=>{var _0x168747=a0_0x4a8fff;const {FromWareHouse:_0x52b3ee,FromRoom:_0x190bb3,ToWarehouse:_0x2cfee9,ToRoom:_0x3227da,primary_code:_0xc30e4f,Roomslist:_0x3b3f67}=_0xe52d07[_0x168747(0x1cd)],_0x3cb7d3=_0x3b3f67[_0x168747(0x1ea)](','),_0x1810d0=[];async function _0x5d5509(_0x29e3d9){var _0x1ddefc=_0x168747;const _0x31264f=await warehouse[_0x1ddefc(0x1f4)]([{'$match':{'name':_0x52b3ee,'room':_0x29e3d9}},{'$unwind':_0x1ddefc(0x1c3)},{'$match':{'product_details.primary_code':_0xc30e4f}},{'$group':{'_id':_0x1ddefc(0x232),'name':{'$first':'$product_details.product_name'},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x1ddefc(0x222)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1ddefc(0x1f1)},'level':{'$first':_0x1ddefc(0x1f2)},'isle':{'$first':_0x1ddefc(0x195)},'type':{'$first':_0x1ddefc(0x21a)},'pallet':{'$first':_0x1ddefc(0x1a9)},'unit':{'$first':_0x1ddefc(0x18f)},'secondary_unit':{'$first':_0x1ddefc(0x1f0)},'storage':{'$first':_0x1ddefc(0x22e)},'rack':{'$first':_0x1ddefc(0x177)},'expiry_date':{'$first':_0x1ddefc(0x238)},'production_date':{'$first':_0x1ddefc(0x1e9)},'batch_code':{'$first':_0x1ddefc(0x229)},'maxPerUnit':{'$first':_0x1ddefc(0x207)},'roomNamed':{'$first':_0x1ddefc(0x1a0)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x1ddefc(0x210)}}}]),_0x3c566e=await warehouse[_0x1ddefc(0x1f4)]([{'$match':{'name':_0x52b3ee,'room':_0x29e3d9}},{'$unwind':_0x1ddefc(0x1c3)},{'$match':{'product_details.secondary_code':_0xc30e4f}},{'$group':{'_id':_0x1ddefc(0x232),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x1ddefc(0x1c6)},'primary_code':{'$first':_0x1ddefc(0x222)},'secondary_code':{'$first':_0x1ddefc(0x1a6)},'product_code':{'$first':_0x1ddefc(0x1f1)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x1ddefc(0x195)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x1ddefc(0x1a9)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x1ddefc(0x1f0)},'storage':{'$first':_0x1ddefc(0x22e)},'rack':{'$first':_0x1ddefc(0x177)},'expiry_date':{'$first':_0x1ddefc(0x238)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1ddefc(0x229)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x1ddefc(0x1a0)},'prod_cat':{'$first':'S'},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x31264f[_0x1ddefc(0x1d8)]>0x0)_0x1810d0['push'](_0x31264f);else _0x3c566e['length']>0x0&&_0x1810d0[_0x1ddefc(0x1ba)](_0x3c566e);}const _0x203534=_0x3cb7d3[_0x168747(0x23a)](_0x2dc16d=>_0x5d5509(_0x2dc16d));await Promise[_0x168747(0x186)](_0x203534),_0xde3f60['json'](_0x1810d0);}),router[a0_0x4a8fff(0x181)](a0_0x4a8fff(0x1b1),async(_0x270c02,_0x229cc0)=>{var _0x37d426=a0_0x4a8fff;try{const {FromWareHouse:_0x3456e7,FromRoom:_0x3c4813,ToWarehouse:_0x2b6245,ToRoom:_0xe5234e,secondary_code:_0xe68af1}=_0x270c02[_0x37d426(0x1cd)],_0x5add39=await warehouse[_0x37d426(0x1f4)]([{'$match':{'name':_0x3456e7}},{'$unwind':_0x37d426(0x1c3)},{'$match':{'product_details.secondary_code':_0xe68af1}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x37d426(0x222)},'secondary_code':{'$first':_0x37d426(0x1a6)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x37d426(0x1c6)},'warehouse':{'$first':_0x37d426(0x1c4)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x37d426(0x21d)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x37d426(0x18f)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x37d426(0x1e9)}}}]);_0x229cc0[_0x37d426(0x196)](0xc8)[_0x37d426(0x18e)](_0x5add39);}catch(_0x537210){_0x229cc0['status'](0x194)[_0x37d426(0x18e)]({'message':_0x537210[_0x37d426(0x1fd)]});}}),router['post']('/barcode_scanner3',async(_0xe7a3a3,_0x340cd5)=>{var _0x27ffd9=a0_0x4a8fff;try{const {FromWareHouse:_0x444d7f,FromRoom:_0x78275e,ToWarehouse:_0x1c0948,ToRoom:_0x5d035f,product_code:_0x1c7e43}=_0xe7a3a3[_0x27ffd9(0x1cd)],_0x38ff75=await warehouse[_0x27ffd9(0x1f4)]([{'$match':{'name':_0x444d7f}},{'$unwind':_0x27ffd9(0x1c3)},{'$match':{'product_details.product_code':_0x1c7e43}},{'$group':{'_id':_0x27ffd9(0x232),'name':{'$first':_0x27ffd9(0x18d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0x27ffd9(0x1c6)},'warehouse':{'$first':_0x27ffd9(0x1c4)},'level':{'$first':_0x27ffd9(0x1b5)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x27ffd9(0x1ed)},'maxProducts':{'$first':_0x27ffd9(0x19f)},'unit':{'$first':'$product_details.unit'}}}]);_0x340cd5[_0x27ffd9(0x196)](0xc8)[_0x27ffd9(0x18e)](_0x38ff75);}catch(_0x1adeaf){_0x340cd5[_0x27ffd9(0x196)](0x194)[_0x27ffd9(0x18e)]({'message':_0x1adeaf[_0x27ffd9(0x1fd)]});}}),router[a0_0x4a8fff(0x181)](a0_0x4a8fff(0x209),async(_0x394672,_0x1d55bf)=>{var _0x3a6684=a0_0x4a8fff;const {productCode:_0x441b24,bay:_0x3e1443,warehouses:_0x15670b,room:_0x2b317c}=_0x394672[_0x3a6684(0x1cd)];console[_0x3a6684(0x1ae)](_0x394672[_0x3a6684(0x1cd)]);try{const _0x272f20=await warehouse[_0x3a6684(0x1f4)]([{'$match':{'name':_0x15670b,'room':_0x2b317c}},{'$unwind':_0x3a6684(0x1c3)},{'$match':{'product_details.bay':parseInt(_0x3e1443)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x3a6684(0x18d)},'product_stock':{'$first':_0x3a6684(0x1c6)},'bay':{'$first':'$product_details.bay'},'maxProducts':{'$first':_0x3a6684(0x19f)}}}]);_0x1d55bf[_0x3a6684(0x196)](0xc8)['json'](_0x272f20);}catch(_0x7d2929){_0x1d55bf[_0x3a6684(0x196)](0x194)[_0x3a6684(0x18e)]({'message':_0x7d2929[_0x3a6684(0x1fd)]});}}),module[a0_0x4a8fff(0x20d)]=router;