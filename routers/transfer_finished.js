var a0_0x5cb205=a0_0x5dc6;(function(_0xc7dec7,_0x5b93af){var _0x3a93de=a0_0x5dc6,_0x438d23=_0xc7dec7();while(!![]){try{var _0x12de61=parseInt(_0x3a93de(0x1b3))/0x1*(-parseInt(_0x3a93de(0x1aa))/0x2)+-parseInt(_0x3a93de(0x154))/0x3+parseInt(_0x3a93de(0x1c7))/0x4*(-parseInt(_0x3a93de(0x213))/0x5)+parseInt(_0x3a93de(0x17b))/0x6*(parseInt(_0x3a93de(0x1a6))/0x7)+-parseInt(_0x3a93de(0x164))/0x8+parseInt(_0x3a93de(0x21d))/0x9+parseInt(_0x3a93de(0x204))/0xa*(parseInt(_0x3a93de(0x15a))/0xb);if(_0x12de61===_0x5b93af)break;else _0x438d23['push'](_0x438d23['shift']());}catch(_0x5e4304){_0x438d23['push'](_0x438d23['shift']());}}}(a0_0x47f3,0x4fc38));function a0_0x5dc6(_0x57d129,_0x17e25a){var _0x47f391=a0_0x47f3();return a0_0x5dc6=function(_0x5dc61b,_0x40dd83){_0x5dc61b=_0x5dc61b-0x14d;var _0x152a43=_0x47f391[_0x5dc61b];return _0x152a43;},a0_0x5dc6(_0x57d129,_0x17e25a);}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x5cb205(0x1ea)),auth=require('../middleware/auth'),users=require(a0_0x5cb205(0x1fa)),nodemailer=require(a0_0x5cb205(0x1a5));router[a0_0x5cb205(0x195)](a0_0x5cb205(0x21b),auth,async(_0x1dedb3,_0x2ffa40)=>{var _0x12fc32=a0_0x5cb205;try{const {username:_0x1b5c64,email:_0x202f55,role:_0x1dc39e}=_0x1dedb3[_0x12fc32(0x151)],_0x5d7728=_0x1dedb3[_0x12fc32(0x151)],_0x330d15=await profile[_0x12fc32(0x163)]({'email':_0x5d7728[_0x12fc32(0x224)]}),_0x12e2e9=await master_shop[_0x12fc32(0x15f)]();let _0x2ddcf3;if(_0x5d7728[_0x12fc32(0x158)]==_0x12fc32(0x1fb)){const _0x5eaffc=await staff[_0x12fc32(0x163)]({'email':_0x5d7728[_0x12fc32(0x224)]});_0x2ddcf3=await transfers_finished[_0x12fc32(0x15f)]({'from_warehouse':_0x5eaffc[_0x12fc32(0x1f9)]});}else _0x2ddcf3=await transfers_finished[_0x12fc32(0x1d3)]([{'$unwind':_0x12fc32(0x212)},{'$group':{'_id':_0x12fc32(0x170),'invoice':{'$first':_0x12fc32(0x227)},'date':{'$first':_0x12fc32(0x1d2)},'from_warehouse':{'$first':_0x12fc32(0x210)},'to_warehouse':{'$first':_0x12fc32(0x18f)},'from_room_name':{'$addToSet':_0x12fc32(0x18e)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x12e2e9[0x0][_0x12fc32(0x1d4)]==_0x12fc32(0x1a9))var _0x564154=users[_0x12fc32(0x193)];else{if(_0x12e2e9[0x0]['language']==_0x12fc32(0x1bb))var _0x564154=users[_0x12fc32(0x1bb)];else{if(_0x12e2e9[0x0]['language']==_0x12fc32(0x189))var _0x564154=users[_0x12fc32(0x189)];else{if(_0x12e2e9[0x0][_0x12fc32(0x1d4)]=='Spanish')var _0x564154=users[_0x12fc32(0x208)];else{if(_0x12e2e9[0x0]['language']=='French')var _0x564154=users[_0x12fc32(0x19d)];else{if(_0x12e2e9[0x0][_0x12fc32(0x1d4)]==_0x12fc32(0x1e5))var _0x564154=users[_0x12fc32(0x221)];else{if(_0x12e2e9[0x0][_0x12fc32(0x1d4)]=='Chinese')var _0x564154=users[_0x12fc32(0x162)];else{if(_0x12e2e9[0x0][_0x12fc32(0x1d4)]==_0x12fc32(0x19e))var _0x564154=users[_0x12fc32(0x20b)];}}}}}}}_0x2ffa40[_0x12fc32(0x1ba)](_0x12fc32(0x1ca),{'success':_0x1dedb3['flash']('success'),'errors':_0x1dedb3[_0x12fc32(0x182)](_0x12fc32(0x17c)),'role':_0x5d7728,'profile':_0x330d15,'master_shop':_0x12e2e9,'transfer':_0x2ddcf3,'language':_0x564154});}catch(_0x4b3d21){console[_0x12fc32(0x150)](_0x4b3d21);}});async function getRandom8DigitNumber(){var _0x312648=a0_0x5cb205;const _0x38ff22=0x989680,_0x37aba2=0x5f5e0ff,_0x3177da=Math[_0x312648(0x1e1)](Math[_0x312648(0x1d7)]()*(_0x37aba2-_0x38ff22+0x1))+_0x38ff22;var _0x231fb9;const _0x4c3d8f=await transfers_finished['findOne']({'invoice':_0x312648(0x188)+_0x3177da});return _0x4c3d8f&&_0x4c3d8f[_0x312648(0x1c0)]>0x0?_0x231fb9=_0x312648(0x188)+_0x3177da:_0x231fb9=_0x312648(0x188)+_0x3177da,_0x231fb9;}router[a0_0x5cb205(0x195)]('/view/add_transfer',auth,async(_0x5673c7,_0x523fcf)=>{var _0x7d9976=a0_0x5cb205;try{const {username:_0x129c35,email:_0x207eff,role:_0x5468cb}=_0x5673c7['user'],_0x504e37=_0x5673c7[_0x7d9976(0x151)],_0x37ae8c=await profile['findOne']({'email':_0x504e37[_0x7d9976(0x224)]}),_0x1a45b9=await master_shop[_0x7d9976(0x15f)]();let _0x3987f7;if(_0x504e37['role']==_0x7d9976(0x1fb)){const _0x32d8e2=await staff['findOne']({'email':_0x504e37[_0x7d9976(0x224)]});_0x3987f7=await warehouse['aggregate']([{'$match':{'status':_0x7d9976(0x165),'name':_0x32d8e2[_0x7d9976(0x1f9)],'warehouse_category':_0x7d9976(0x1db),'name':{'$ne':_0x7d9976(0x1e6)}}},{'$group':{'_id':'$name','name':{'$first':_0x7d9976(0x184)}}}]);}else _0x3987f7=await warehouse[_0x7d9976(0x1d3)]([{'$match':{'status':_0x7d9976(0x165),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x7d9976(0x1e6)}}},{'$group':{'_id':'$name','name':{'$first':_0x7d9976(0x184)}}}]);const _0x127532=await transfers_finished[_0x7d9976(0x15f)]({}),_0x62fe74=_0x127532[_0x7d9976(0x1c0)]+0x1,_0xf9dab0=_0x7d9976(0x188)+_0x62fe74[_0x7d9976(0x1ed)]()[_0x7d9976(0x17d)](0x5,'0');if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]=='English\x20(US)')var _0x142a30=users[_0x7d9976(0x193)];else{if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]=='Hindi')var _0x142a30=users[_0x7d9976(0x1bb)];else{if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]==_0x7d9976(0x189))var _0x142a30=users['German'];else{if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]==_0x7d9976(0x208))var _0x142a30=users['Spanish'];else{if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]==_0x7d9976(0x19d))var _0x142a30=users['French'];else{if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]=='Portuguese\x20(BR)')var _0x142a30=users[_0x7d9976(0x221)];else{if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]==_0x7d9976(0x162))var _0x142a30=users[_0x7d9976(0x162)];else{if(_0x1a45b9[0x0][_0x7d9976(0x1d4)]==_0x7d9976(0x19e))var _0x142a30=users['Arabic'];}}}}}}}const _0x4278ea=getRandom8DigitNumber();_0x4278ea[_0x7d9976(0x155)](_0x3e78c9=>{var _0x177160=_0x7d9976;_0x523fcf['render'](_0x177160(0x201),{'success':_0x5673c7[_0x177160(0x182)]('success'),'errors':_0x5673c7['flash'](_0x177160(0x17c)),'role':_0x504e37,'profile':_0x37ae8c,'master_shop':_0x1a45b9,'warehouse':_0x3987f7,'language':_0x142a30,'invoice':_0x3e78c9});})[_0x7d9976(0x198)](_0x2d306d=>{var _0x489318=_0x7d9976;_0x5673c7[_0x489318(0x182)](_0x489318(0x17c),_0x489318(0x1a2)),_0x523fcf['redirect'](_0x489318(0x192));});}catch(_0x5da04e){console['log'](_0x5da04e);}}),router[a0_0x5cb205(0x20d)](a0_0x5cb205(0x1c4),auth,async(_0x3da0fb,_0x547088)=>{var _0x5ac3ac=a0_0x5cb205;try{const {date:_0x32ee5d,from_warehouse:_0x1b8326,FromRoom_name:_0x2fc3d8,to_warehouse:_0x452391,ToRoom_name:_0x6c6679,prod_name:_0x306efb,from_prod_qty:_0x27c392,from_prod_level:_0x1c9f6d,from_prod_isle:_0x50cc44,from_prod_pallet:_0x435d27,to_prod_qty:_0x171829,to_prod_level:_0x48d9b1,to_prod_isle:_0x5e1e0d,to_prod_pallet:_0x2a471e,primary_code:_0x38bbfe,secondary_code:_0x51d685,product_code3:_0xc3638f,note:_0x10e7c3,MaxStocks_data2:_0x3d1c47,invoice:_0x5295df,expiry_date:_0x2f72ea}=_0x3da0fb[_0x5ac3ac(0x1cd)];if(typeof _0x306efb=='string')var _0x1df1db=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x206)]],_0x115bac=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x1b6)]],_0x336430=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x209)]],_0x246ac9=[_0x3da0fb['body'][_0x5ac3ac(0x15b)]],_0x10c75b=[_0x3da0fb[_0x5ac3ac(0x1cd)]['to_prod_level']],_0x18f88d=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x1f2)]],_0x4b15a3=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x19f)]],_0x243af3=[_0x3da0fb['body'][_0x5ac3ac(0x218)]],_0x5f181d=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x171)]],_0x3a39c4=[_0x3da0fb['body'][_0x5ac3ac(0x1c2)]],_0x3f2ebd=[_0x3da0fb[_0x5ac3ac(0x1cd)]['secondary_unit']],_0x2e76f9=[_0x3da0fb['body']['batch_code']],_0x490334=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x1ef)]],_0x1fa930=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x229)]],_0xa7840a=[_0x3da0fb['body'][_0x5ac3ac(0x202)]],_0x270261=[_0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x167)]],_0x28871e=[_0x3da0fb['body'][_0x5ac3ac(0x1d5)]],_0x2ab0bc=[_0x3da0fb[_0x5ac3ac(0x1cd)]['RoomAssigned']],_0x59fb91=[_0x3da0fb['body']['ToRoomAssigned']],_0x38c802=[_0x3da0fb['body'][_0x5ac3ac(0x185)]],_0x120d88=[_0x3da0fb[_0x5ac3ac(0x1cd)]['to_invoice']],_0x369b55=[_0x3da0fb['body']['id_transaction']];else var _0x1df1db=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x206)]],_0x115bac=[..._0x3da0fb[_0x5ac3ac(0x1cd)]['from_prod_qty']],_0x336430=[..._0x3da0fb['body'][_0x5ac3ac(0x209)]],_0x246ac9=[..._0x3da0fb['body'][_0x5ac3ac(0x15b)]],_0x10c75b=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x225)]],_0x18f88d=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x1f2)]],_0x4b15a3=[..._0x3da0fb[_0x5ac3ac(0x1cd)]['secondary_code']],_0x243af3=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x218)]],_0x5f181d=[..._0x3da0fb[_0x5ac3ac(0x1cd)]['MaxStocks_data2']],_0x3a39c4=[..._0x3da0fb[_0x5ac3ac(0x1cd)]['primary_unit']],_0x3f2ebd=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x16d)]],_0x2e76f9=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x18d)]],_0x490334=[..._0x3da0fb['body']['expiry_date']],_0x1fa930=[..._0x3da0fb['body'][_0x5ac3ac(0x229)]],_0xa7840a=[..._0x3da0fb['body'][_0x5ac3ac(0x202)]],_0x270261=[..._0x3da0fb[_0x5ac3ac(0x1cd)]['maxPerUnit']],_0x28871e=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x1d5)]],_0x2ab0bc=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x214)]],_0x59fb91=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x22e)]],_0x38c802=[..._0x3da0fb[_0x5ac3ac(0x1cd)]['from_invoice']],_0x120d88=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x1ab)]],_0x369b55=[..._0x3da0fb[_0x5ac3ac(0x1cd)][_0x5ac3ac(0x1b0)]];const _0x554e9e=_0x1df1db[_0x5ac3ac(0x1c3)](_0x42f027=>{return _0x42f027={'product_name':_0x42f027};});_0x115bac['forEach']((_0x4928c7,_0x5eec60)=>{var _0x926ea7=_0x5ac3ac;_0x554e9e[_0x5eec60][_0x926ea7(0x19a)]=_0x4928c7;}),_0x336430[_0x5ac3ac(0x197)]((_0x112829,_0x1e2c68)=>{var _0xf0abeb=_0x5ac3ac;_0x554e9e[_0x1e2c68][_0xf0abeb(0x183)]=_0x112829;}),_0x369b55[_0x5ac3ac(0x197)]((_0x1cc611,_0x4bd80a)=>{var _0x78daca=_0x5ac3ac;_0x554e9e[_0x4bd80a][_0x78daca(0x1b0)]=_0x1cc611;}),_0x38c802['forEach']((_0x2f91ee,_0x1c972e)=>{var _0x1d5354=_0x5ac3ac;_0x554e9e[_0x1c972e][_0x1d5354(0x185)]=_0x2f91ee;}),_0x120d88['forEach']((_0x36d821,_0x4f4d12)=>{_0x554e9e[_0x4f4d12]['To_invoice']=_0x36d821;}),_0x246ac9['forEach']((_0x4727bd,_0x744006)=>{_0x554e9e[_0x744006]['to_quantity']=_0x4727bd;}),_0x10c75b[_0x5ac3ac(0x197)]((_0x57ec00,_0x10c42c)=>{var _0x1e2f40=_0x5ac3ac;_0x554e9e[_0x10c42c][_0x1e2f40(0x18a)]=_0x57ec00;}),_0x18f88d['forEach']((_0x5cc862,_0x1e5a36)=>{_0x554e9e[_0x1e5a36]['primary_code']=_0x5cc862;}),_0x4b15a3[_0x5ac3ac(0x197)]((_0x70fc4d,_0x6a370b)=>{var _0x48b7b6=_0x5ac3ac;_0x554e9e[_0x6a370b][_0x48b7b6(0x19f)]=_0x70fc4d;}),_0x243af3[_0x5ac3ac(0x197)]((_0x4ccc99,_0x56f1f6)=>{var _0x116973=_0x5ac3ac;_0x554e9e[_0x56f1f6][_0x116973(0x1d8)]=_0x4ccc99;}),_0x5f181d[_0x5ac3ac(0x197)]((_0x45ba20,_0x58511e)=>{var _0x3e952c=_0x5ac3ac;_0x554e9e[_0x58511e][_0x3e952c(0x205)]=_0x45ba20;}),_0x3a39c4[_0x5ac3ac(0x197)]((_0x14b7cd,_0x3d927d)=>{var _0x311972=_0x5ac3ac;_0x554e9e[_0x3d927d][_0x311972(0x20c)]=_0x14b7cd;}),_0x3f2ebd[_0x5ac3ac(0x197)]((_0x260724,_0x5a603d)=>{var _0x18b266=_0x5ac3ac;_0x554e9e[_0x5a603d][_0x18b266(0x16d)]=_0x260724;}),_0x2e76f9[_0x5ac3ac(0x197)]((_0x33a25d,_0x343950)=>{_0x554e9e[_0x343950]['batch_code']=_0x33a25d;}),_0x490334[_0x5ac3ac(0x197)]((_0x265f9b,_0x55da0c)=>{var _0x3ba128=_0x5ac3ac;_0x554e9e[_0x55da0c][_0x3ba128(0x1ef)]=_0x265f9b;}),_0x1fa930[_0x5ac3ac(0x197)]((_0x50ed1a,_0x50d040)=>{_0x554e9e[_0x50d040]['production_date']=_0x50ed1a;}),_0xa7840a['forEach']((_0x5b12b1,_0x3ff403)=>{var _0x28d50e=_0x5ac3ac;_0x554e9e[_0x3ff403][_0x28d50e(0x205)]=_0x5b12b1;}),_0x270261[_0x5ac3ac(0x197)]((_0x3ee723,_0x10976c)=>{_0x554e9e[_0x10976c]['maxPerUnit']=_0x3ee723;}),_0x28871e['forEach']((_0x454bbc,_0x99aec7)=>{var _0x36dd5a=_0x5ac3ac;_0x554e9e[_0x99aec7][_0x36dd5a(0x1d5)]=_0x454bbc;}),_0x2ab0bc[_0x5ac3ac(0x197)]((_0x569d3a,_0x22de54)=>{var _0x3fe878=_0x5ac3ac;_0x554e9e[_0x22de54][_0x3fe878(0x1e0)]=_0x569d3a;}),_0x59fb91['forEach']((_0x555b1b,_0xbe59a8)=>{var _0x35f5b2=_0x5ac3ac;_0x554e9e[_0xbe59a8][_0x35f5b2(0x157)]=_0x555b1b;});const _0x12ed85=_0x554e9e[_0x5ac3ac(0x19b)](_0x13dba1=>_0x13dba1['to_quantity']!=='0'&&_0x13dba1[_0x5ac3ac(0x1dc)]!==''||_0x13dba1[_0x5ac3ac(0x1e8)]!=='0'&&_0x13dba1[_0x5ac3ac(0x1e8)]!=='');var _0xfd78f8=0x0;_0x12ed85['forEach'](_0xa995d=>{var _0x249149=_0x5ac3ac;parseInt(_0xa995d[_0x249149(0x19a)])<parseInt(_0xa995d[_0x249149(0x1dc)])&&_0xfd78f8++;});if(_0xfd78f8!=0x0)return _0x3da0fb['flash'](_0x5ac3ac(0x17c),_0x5ac3ac(0x1d6)),_0x547088[_0x5ac3ac(0x176)](_0x5ac3ac(0x1fc));const _0xef3c70=new transfers_finished({'date':_0x32ee5d,'from_warehouse':_0x1b8326,'to_warehouse':_0x452391,'product':_0x12ed85,'note':_0x10e7c3,'invoice':_0x5295df}),_0x1fd55a=await _0xef3c70[_0x5ac3ac(0x1a8)]();_0x3da0fb[_0x5ac3ac(0x182)](_0x5ac3ac(0x1ce),_0x5ac3ac(0x14e)),_0x547088[_0x5ac3ac(0x176)](_0x5ac3ac(0x15c)+_0x1fd55a[_0x5ac3ac(0x22a)]);}catch(_0x391a31){console['log'](_0x391a31),_0x547088['status'](0xc8)[_0x5ac3ac(0x187)]({'errorMessage':_0x391a31['message']});}}),router[a0_0x5cb205(0x195)](a0_0x5cb205(0x1c8),auth,async(_0x3a7058,_0x5d3cad)=>{var _0x6a4889=a0_0x5cb205;try{const {username:_0x4b35c9,email:_0x481588,role:_0x565edb}=_0x3a7058[_0x6a4889(0x151)],_0xff6af4=_0x3a7058[_0x6a4889(0x151)],_0x2cf5c9=await profile[_0x6a4889(0x163)]({'email':_0xff6af4['email']}),_0x4fa20b=await master_shop[_0x6a4889(0x15f)](),_0x406903=await transfers_finished[_0x6a4889(0x1f0)](_0x3a7058['params']['id']);let _0x19f630;if(_0xff6af4[_0x6a4889(0x158)]=='staff'){const _0x3cf958=await staff[_0x6a4889(0x163)]({'email':_0xff6af4[_0x6a4889(0x224)]});_0x19f630=await warehouse[_0x6a4889(0x15f)]({'status':_0x6a4889(0x165),'name':_0x3cf958[_0x6a4889(0x1f9)],'warehouse_category':_0x6a4889(0x1db)});}else _0x19f630=await warehouse[_0x6a4889(0x15f)]({'status':_0x6a4889(0x165),'warehouse_category':'Finished\x20Goods'});const _0x518e16=await warehouse[_0x6a4889(0x1d3)]([{'$match':{'name':_0x406903['from_warehouse'],'warehouse_category':_0x6a4889(0x1db)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x6a4889(0x191),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x6a4889(0x174)},'bay':{'$first':_0x6a4889(0x17f)},'bin':{'$first':_0x6a4889(0x168)},'type':{'$first':_0x6a4889(0x228)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x6a4889(0x1ad)},'secondary_code':{'$first':_0x6a4889(0x1a1)},'product_code':{'$first':_0x6a4889(0x17e)},'storage':{'$first':_0x6a4889(0x1b2)},'rack':{'$first':_0x6a4889(0x21c)},'expiry_date':{'$first':_0x6a4889(0x222)},'production_date':{'$first':_0x6a4889(0x1a7)},'room':{'$first':_0x6a4889(0x186)},'warehoue_name':{'$first':'$name'}}}]),_0x59199c=await product[_0x6a4889(0x15f)]({});if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]=='English\x20(US)'){var _0x4b0e1b=users[_0x6a4889(0x193)];console[_0x6a4889(0x150)](_0x4b0e1b);}else{if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]==_0x6a4889(0x1bb))var _0x4b0e1b=users[_0x6a4889(0x1bb)];else{if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]==_0x6a4889(0x189))var _0x4b0e1b=users[_0x6a4889(0x189)];else{if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]=='Spanish')var _0x4b0e1b=users[_0x6a4889(0x208)];else{if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]==_0x6a4889(0x19d))var _0x4b0e1b=users[_0x6a4889(0x19d)];else{if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]==_0x6a4889(0x1e5))var _0x4b0e1b=users[_0x6a4889(0x221)];else{if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]=='Chinese')var _0x4b0e1b=users[_0x6a4889(0x162)];else{if(_0x4fa20b[0x0][_0x6a4889(0x1d4)]==_0x6a4889(0x19e))var _0x4b0e1b=users[_0x6a4889(0x20b)];}}}}}}}_0x5d3cad['render'](_0x6a4889(0x166),{'success':_0x3a7058['flash'](_0x6a4889(0x1ce)),'errors':_0x3a7058[_0x6a4889(0x182)](_0x6a4889(0x17c)),'role':_0xff6af4,'profile':_0x2cf5c9,'master_shop':_0x4fa20b,'warehouse':_0x19f630,'transfer':_0x406903,'stock':_0x518e16,'unit':_0x59199c,'language':_0x4b0e1b});}catch(_0x27c8db){console[_0x6a4889(0x150)](_0x27c8db);}}),router[a0_0x5cb205(0x20d)](a0_0x5cb205(0x1c8),auth,async(_0x2019a3,_0x4df0a5)=>{var _0x102b57=a0_0x5cb205;try{const {invoice:_0x572447,from_warehouse:_0x171f3b,FromRoom_name:_0x486b3e,to_warehouse:_0x311130,ToRoom_name:_0x2ae151}=_0x2019a3[_0x102b57(0x1cd)],_0x1be773=await transfers_finished[_0x102b57(0x1f0)](_0x2019a3[_0x102b57(0x18b)]['id']),_0x2df596=_0x1be773[_0x102b57(0x159)]['map'](async _0x2cf19b=>{var _0x324ef0=_0x102b57;if(_0x2cf19b[_0x324ef0(0x1dc)]>0x0){var _0x156e77=await warehouse[_0x324ef0(0x163)]({'name':_0x171f3b,'room':_0x2cf19b[_0x324ef0(0x1e0)],'warehouse_category':_0x324ef0(0x1db)});const _0x3023e1=_0x156e77['product_details'][_0x324ef0(0x1c3)](_0x33fa1f=>{var _0x5a4396=_0x324ef0;_0x33fa1f[_0x5a4396(0x156)]==_0x2cf19b[_0x5a4396(0x156)]&&_0x33fa1f[_0x5a4396(0x1f3)]==_0x2cf19b[_0x5a4396(0x183)]&&_0x33fa1f[_0x5a4396(0x1ef)]==_0x2cf19b[_0x5a4396(0x1ef)]&&_0x33fa1f[_0x5a4396(0x1bc)]==_0x2cf19b[_0x5a4396(0x1bc)]&&_0x33fa1f[_0x5a4396(0x18d)]==_0x2cf19b[_0x5a4396(0x18d)]&&_0x33fa1f[_0x5a4396(0x22d)]==_0x2cf19b['from_invoice']&&(console['log']('here1',_0x33fa1f[_0x5a4396(0x1f6)]),typeof _0x2cf19b['id_transaction']=='undefined'?_0x33fa1f[_0x5a4396(0x1f6)]=Math[_0x5a4396(0x1d1)](0x0,Math[_0x5a4396(0x16e)](_0x33fa1f['product_stock'])-Math[_0x5a4396(0x16e)](_0x2cf19b[_0x5a4396(0x1dc)])):_0x33fa1f[_0x5a4396(0x1f6)]=Math[_0x5a4396(0x1d1)](0x0,Math[_0x5a4396(0x16e)](_0x33fa1f[_0x5a4396(0x1f6)])-Math['abs'](_0x2cf19b[_0x5a4396(0x1dc)])));});}return _0x156e77;});Promise[_0x102b57(0x200)](_0x2df596)['then'](async _0x572506=>{var _0x45ea01=_0x102b57;try{for(const _0x338f2e of _0x572506){await _0x338f2e[_0x45ea01(0x1a8)]();}const _0x3969e5=_0x1be773[_0x45ea01(0x159)][_0x45ea01(0x1c3)](async _0x297850=>{var _0x3bc019=_0x45ea01,_0x2d5891=await warehouse[_0x3bc019(0x163)]({'name':_0x311130,'room':_0x297850[_0x3bc019(0x157)]});if(_0x297850[_0x3bc019(0x1dc)]>0x0){var _0x106490=0x0;const _0x43a37b=_0x2d5891['product_details'][_0x3bc019(0x1c3)](_0x2ee225=>{var _0xe84c5d=_0x3bc019;_0x2ee225[_0xe84c5d(0x156)]==_0x297850[_0xe84c5d(0x156)]&&_0x2ee225[_0xe84c5d(0x1f3)]==_0x297850[_0xe84c5d(0x18a)]&&_0x2ee225['expiry_date']==_0x297850[_0xe84c5d(0x1ef)]&&_0x2ee225['production_date']==_0x297850[_0xe84c5d(0x1bc)]&&_0x2ee225['batch_code']==_0x297850[_0xe84c5d(0x18d)]&&_0x2ee225[_0xe84c5d(0x22d)]==_0x297850[_0xe84c5d(0x1de)]&&(typeof _0x297850['id_transaction']==_0xe84c5d(0x1fe)?(console[_0xe84c5d(0x150)](_0xe84c5d(0x178),_0x2ee225[_0xe84c5d(0x1f6)]+'\x20<>\x20'+_0x2ee225['_id']+'\x20<=>\x20'+Math[_0xe84c5d(0x16e)](_0x2ee225[_0xe84c5d(0x1f6)])+Math[_0xe84c5d(0x16e)](_0x297850[_0xe84c5d(0x1dc)])),_0x2ee225[_0xe84c5d(0x1f6)]=Math[_0xe84c5d(0x16e)](_0x2ee225[_0xe84c5d(0x1f6)])+Math[_0xe84c5d(0x16e)](_0x297850[_0xe84c5d(0x1dc)])):_0x2ee225[_0xe84c5d(0x1f6)]=Math[_0xe84c5d(0x16e)](_0x2ee225[_0xe84c5d(0x1f6)])+Math[_0xe84c5d(0x16e)](_0x297850[_0xe84c5d(0x1dc)]),_0x106490++);});_0x106490=='0'&&(_0x2d5891[_0x3bc019(0x207)]=_0x2d5891[_0x3bc019(0x207)]['concat']({'product_name':_0x297850[_0x3bc019(0x156)],'product_stock':_0x297850['to_quantity'],'bay':_0x297850[_0x3bc019(0x18a)],'product_code':_0x297850[_0x3bc019(0x1d8)],'primary_code':_0x297850['primary_code'],'secondary_code':_0x297850[_0x3bc019(0x19f)],'expiry_date':_0x297850[_0x3bc019(0x1ef)],'production_date':_0x297850[_0x3bc019(0x1bc)],'maxProducts':_0x297850[_0x3bc019(0x205)],'batch_code':_0x297850[_0x3bc019(0x18d)],'secondary_unit':_0x297850[_0x3bc019(0x16d)],'unit':_0x297850[_0x3bc019(0x20c)],'maxProducts':_0x297850[_0x3bc019(0x205)],'maxPerUnit':_0x297850[_0x3bc019(0x167)],'invoice':_0x297850[_0x3bc019(0x1de)]}));}return _0x2d5891;});Promise[_0x45ea01(0x200)](_0x3969e5)[_0x45ea01(0x155)](async _0x2506f8=>{var _0xa449bc=_0x45ea01;try{for(const _0xef5536 of _0x2506f8){await warehouse[_0xa449bc(0x217)]({'_id':_0xef5536[_0xa449bc(0x22a)]},{'$addToSet':{'product_details':{'$each':_0xef5536[_0xa449bc(0x207)]}}});}_0x1be773[_0xa449bc(0x16b)]='True';const _0x29b4bb=await _0x1be773[_0xa449bc(0x1a8)](),_0x47d179=await master_shop[_0xa449bc(0x15f)](),_0x1ba538=await email_settings['findOne'](),_0x4a7ed6=await supervisor_settings[_0xa449bc(0x15f)]();var _0x13c6f2=_0x1be773[_0xa449bc(0x159)],_0x5407db='',_0xb54987;for(_0xb54987 in _0x13c6f2){var _0x2a523d='FG';_0x1be773['to_warehouse']==_0xa449bc(0x152)&&(_0x2a523d='DG'),_0x5407db+=_0xa449bc(0x194)+_0xa449bc(0x1cf)+_0x13c6f2[_0xb54987][_0xa449bc(0x156)]+_0xa449bc(0x22c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13c6f2[_0xb54987][_0xa449bc(0x1d8)]+_0xa449bc(0x22c)+_0xa449bc(0x1cf)+_0x13c6f2[_0xb54987][_0xa449bc(0x1dc)]+_0xa449bc(0x22c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13c6f2[_0xb54987][_0xa449bc(0x20c)]+_0xa449bc(0x22c)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x13c6f2[_0xb54987]['secondary_unit']+'</td>'+_0xa449bc(0x1cf)+_0x1be773['to_warehouse']+_0xa449bc(0x22c)+_0xa449bc(0x1cf)+_0x13c6f2[_0xb54987][_0xa449bc(0x157)]+_0xa449bc(0x22c)+_0xa449bc(0x1cf)+_0x2a523d+_0x13c6f2[_0xb54987][_0xa449bc(0x18a)]+_0xa449bc(0x22c)+_0xa449bc(0x1c9);}let _0x39231e=nodemailer['createTransport']({'host':_0x1ba538[_0xa449bc(0x160)],'port':Number(_0x1ba538[_0xa449bc(0x1b9)]),'secure':![],'auth':{'user':_0x1ba538[_0xa449bc(0x224)],'pass':_0x1ba538[_0xa449bc(0x1f1)]}}),_0x19993d={'from':_0x1ba538[_0xa449bc(0x224)],'to':_0x4a7ed6[0x0][_0xa449bc(0x1b1)],'subject':_0xa449bc(0x21e),'attachments':[{'filename':_0xa449bc(0x1b7),'path':__dirname+'/../public'+_0xa449bc(0x1df)+_0x47d179[0x0][_0xa449bc(0x173)],'cid':_0xa449bc(0x1ff)}],'html':_0xa449bc(0x16f)+'<html><head><title></title>'+_0xa449bc(0x1b8)+_0xa449bc(0x1b5)+_0xa449bc(0x1c5)+_0xa449bc(0x1b5)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0xa449bc(0x1e9)+_0xa449bc(0x1b5)+'<h2>\x20'+_0x47d179[0x0][_0xa449bc(0x1d0)]+_0xa449bc(0x14f)+_0xa449bc(0x1e9)+_0xa449bc(0x1e9)+_0xa449bc(0x19c)+_0xa449bc(0x1b5)+_0xa449bc(0x172)+_0xa449bc(0x1f4)+_0x1be773[_0xa449bc(0x22d)]+'\x20'+_0xa449bc(0x15e)+_0xa449bc(0x1d9)+_0x1be773[_0xa449bc(0x1ee)]+'\x20'+_0xa449bc(0x1dd)+'</h5>'+_0xa449bc(0x1e9)+_0xa449bc(0x190)+_0xa449bc(0x161)+_0xa449bc(0x194)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0xa449bc(0x215)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>'+_0xa449bc(0x220)+_0xa449bc(0x216)+_0xa449bc(0x1c9)+_0xa449bc(0x223)+_0xa449bc(0x1c1)+'\x20'+_0x5407db+'\x20'+_0xa449bc(0x1da)+_0xa449bc(0x1ae)+_0xa449bc(0x1b5)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x47d179[0x0]['site_title']+_0xa449bc(0x1e2)+'</div>'+_0xa449bc(0x1e9)+_0xa449bc(0x1bf)};_0x39231e['sendMail'](_0x19993d,function(_0x3a7efc,_0x2ad983){var _0xa5dc1c=_0xa449bc;_0x3a7efc?(console[_0xa5dc1c(0x150)](_0x3a7efc),console[_0xa5dc1c(0x150)](_0xa5dc1c(0x169))):console[_0xa5dc1c(0x150)](_0xa5dc1c(0x1e3));}),_0x2019a3[_0xa449bc(0x182)](_0xa449bc(0x1ce),_0xa449bc(0x1f8)),_0x4df0a5['redirect'](_0xa449bc(0x20a)+_0x29b4bb[_0xa449bc(0x22a)]);}catch(_0x2b3614){console[_0xa449bc(0x203)](_0x2b3614),_0x4df0a5[_0xa449bc(0x1f5)](0x1f4)[_0xa449bc(0x187)]({'error':_0xa449bc(0x211)});}})[_0x45ea01(0x198)](_0x3ca80f=>{var _0x345508=_0x45ea01;console[_0x345508(0x203)](_0x3ca80f),_0x4df0a5[_0x345508(0x1f5)](0x1f4)['json']({'error':_0x345508(0x1b4)});});}catch(_0x3962d6){console[_0x45ea01(0x203)](_0x3962d6),_0x4df0a5[_0x45ea01(0x1f5)](0x1f4)[_0x45ea01(0x187)]({'error':_0x45ea01(0x1be)});}})[_0x102b57(0x198)](_0x5795fd=>{var _0x1af1d5=_0x102b57;console['error'](_0x5795fd),_0x4df0a5[_0x1af1d5(0x1f5)](0x1f4)[_0x1af1d5(0x187)]({'error':_0x1af1d5(0x1b4)});});}catch(_0x3e889c){_0x4df0a5[_0x102b57(0x187)]({'message':_0x3e889c[_0x102b57(0x1f7)]});}});function BayBinSelected(_0x65f062,_0x134a26){var _0x5db6ba=a0_0x5cb205,_0x8ffca3=[];let _0x136ee8=[];var _0x14603f=[];if(_0x65f062==_0x5db6ba(0x152)){switch(_0x134a26){case _0x5db6ba(0x180):_0x8ffca3=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case'Rack\x202':_0x8ffca3=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x14603f=['DG'];}else{if(_0x65f062==_0x5db6ba(0x1e4)){switch(_0x134a26){case _0x5db6ba(0x180):_0x8ffca3=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x5db6ba(0x1c6):_0x8ffca3=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x14603f=['FG'];}}return{'levels':_0x8ffca3,'identify':_0x14603f};}function a0_0x47f3(){var _0x22b753=['note','body','success','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','site_title','max','$date','aggregate','language','prod_cat','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','random','product_code','\x20Order\x20Date\x20:\x20','</tbody>','Finished\x20Goods','to_quantity','</span>','To_invoice','/upload/','from_room_name','floor','</h5>','Email\x20sent\x20successfully','FROZEN\x20GOODS','Portuguese\x20(BR)','QA\x20Warehouse','getDate','to_floorlevel','</div>','../models/all_models','Enclosed','from_warehouse','toString','date','expiry_date','findById','password','primary_code','bay','\x20Order\x20Number\x20:\x20','status','product_stock','message','Transfer\x20Finalize\x20Successfully','warehouse','../public/language/languages.json','staff','back','/barcode_scanner3','undefined','logo','all','add_transfer_finished','MaxStocks_data','error','10ETSRwp','maxProducts','prod_name','product_details','Spanish','from_prod_level','/picking_list/PDF_transfer/','Arabic','unit','post','$product_details.invoice','$product_details.maxPerUnit','$from_warehouse','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','$product','12485wUmoGK','RoomAssigned','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','updateOne','product_code3','slice','$product_details.level','/view','$product_details.rack','3248478UrtRbv','Transfer\x20Mail','$product_details.unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','Portuguese','$product_details.expiry_date','</thead>','email','to_prod_level','$product_details.batch_code','$invoice','$product_details.type','product_date','_id','getMonth','</td>','invoice','ToRoomAssigned','transfer_data','exports','Product\x20Transfer\x20successfully','\x20</h2>','log','user','DRY\x20GOODS','$product_details.isle','1939959lFlZCf','then','product_name','to_room_name','role','product','10566754VuzTTw','New_Qty_Converted','/transfer_finished/preview/','$product_details.maxProducts','<span\x20style=\x22float:\x20right;\x22>','find','host','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','Chinese','findOne','4725904BOciBu','Enabled','edit_transfer_finished_view','maxPerUnit','$product_details.bin','Error\x20Occurs','$product_details.product_name','finalize','concat','secondary_unit','abs','<!DOCTYPE\x20html>','$_id','MaxStocks_data2','<h5\x20style=\x22text-align:\x20left;\x22>','image','$product_details.product_stock','$product_details.pallet','redirect','/transfer_finished/view','here2','to_room','$product_details.floorlevel','3966KEEuiQ','errors','padStart','$product_details.product_code','$product_details.bay','Rack\x201','/barcode_scanner2','flash','from_bay','$name','from_invoice','$room','json','TRFF-','German','to_bay','params','push','batch_code','$product.from_room_name','$to_warehouse','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details._id','/transfer/view','English','<tr>','get','edit_transfer_finished','forEach','catch','from_room','from_quantity','filter','<hr\x20class=\x22my-3\x22>','French','Arabic\x20(ae)','secondary_code','to_warehouse','$product_details.secondary_code','There\x27s\x20a\x20error\x20in\x20this\x20transaction','to_prod_qty','$product_details.secondary_unit','nodemailer','6881cuDvGs','$product_details.production_date','save','English\x20(US)','21278UbmBZT','to_invoice','/view/:id','$product_details.primary_code','</table>','$product_details','id_transaction','FGSEmail','$product_details.storage','31sOyUNR','An\x20error\x20occurred.','<div>','from_prod_qty','Logo.png','</head><body>','port','render','Hindi','production_date','Transfer\x20Edit\x20Successfully','An\x20error\x20occurred\x20while\x20saving\x20data.','</body></html>','length','<tbody\x20style=\x22text-align:\x20center;\x22>','primary_unit','map','/view/add_transfer','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Rack\x202','124EDHXGW','/preview/:id','</tr>','transfer_finished','getFullYear'];a0_0x47f3=function(){return _0x22b753;};return a0_0x47f3();}router[a0_0x5cb205(0x195)](a0_0x5cb205(0x1ac),auth,async(_0x5e3ac5,_0x2402b1)=>{var _0x11458d=a0_0x5cb205;try{const {username:_0x1e76a2,email:_0x2db597,role:_0x5db297}=_0x5e3ac5[_0x11458d(0x151)],_0x2025fc=_0x5e3ac5['user'],_0x4f509d=await profile[_0x11458d(0x163)]({'email':_0x2025fc['email']}),_0x1ac16c=await master_shop[_0x11458d(0x15f)](),_0x17e67e=await transfers_finished[_0x11458d(0x1f0)](_0x5e3ac5[_0x11458d(0x18b)]['id']);let _0x2985d1=new Date(_0x17e67e[_0x11458d(0x1ef)]),_0x2e419c=('0'+_0x2985d1[_0x11458d(0x1e7)]())[_0x11458d(0x219)](-0x2),_0x9baee9=('0'+(_0x2985d1[_0x11458d(0x22b)]()+0x1))[_0x11458d(0x219)](-0x2),_0x39aaf0=_0x2985d1[_0x11458d(0x1cb)](),_0x1b3a24=_0x39aaf0+'-'+_0x9baee9+'-'+_0x2e419c,_0x5dc837;if(_0x2025fc['role']==_0x11458d(0x1fb)){const _0x4faf04=await staff[_0x11458d(0x163)]({'email':_0x2025fc[_0x11458d(0x224)]});_0x5dc837=await warehouse['find']({'status':_0x11458d(0x165),'name':_0x4faf04[_0x11458d(0x1f9)],'warehouse_category':_0x11458d(0x1db)});}else _0x5dc837=await warehouse['find']({'status':'Enabled','warehouse_category':_0x11458d(0x1db)});const _0x6dc048=await warehouse[_0x11458d(0x1d3)]([{'$match':{'name':_0x17e67e[_0x11458d(0x1ec)],'room':_0x17e67e[_0x11458d(0x199)]}},{'$unwind':_0x11458d(0x1af)},{'$group':{'_id':_0x11458d(0x191),'name':{'$first':_0x11458d(0x16a)},'product_stock':{'$first':_0x11458d(0x174)},'bay':{'$first':_0x11458d(0x17f)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x11458d(0x228)},'floorlevel':{'$first':_0x11458d(0x17a)},'primary_code':{'$first':_0x11458d(0x1ad)},'secondary_code':{'$first':_0x11458d(0x1a1)},'product_code':{'$first':_0x11458d(0x17e)},'storage':{'$first':_0x11458d(0x1b2)},'rack':{'$first':_0x11458d(0x21c)}}}]);var _0x591506=[0x1,0x2,0x3,0x4],_0x1a20e3=['A','B','C','D','E','F','G','H','I','J'],_0x2a440c=['Ambient',_0x11458d(0x1eb)];const _0xfd42ef=await product['find']({}),_0x577eb6=BayBinSelected(_0x17e67e[_0x11458d(0x1a0)],_0x17e67e['to_room']);if(_0x1ac16c[0x0][_0x11458d(0x1d4)]==_0x11458d(0x1a9)){var _0x1f83f4=users[_0x11458d(0x193)];console[_0x11458d(0x150)](_0x1f83f4);}else{if(_0x1ac16c[0x0]['language']=='Hindi')var _0x1f83f4=users[_0x11458d(0x1bb)];else{if(_0x1ac16c[0x0][_0x11458d(0x1d4)]==_0x11458d(0x189))var _0x1f83f4=users['German'];else{if(_0x1ac16c[0x0][_0x11458d(0x1d4)]=='Spanish')var _0x1f83f4=users['Spanish'];else{if(_0x1ac16c[0x0][_0x11458d(0x1d4)]=='French')var _0x1f83f4=users[_0x11458d(0x19d)];else{if(_0x1ac16c[0x0][_0x11458d(0x1d4)]==_0x11458d(0x1e5))var _0x1f83f4=users['Portuguese'];else{if(_0x1ac16c[0x0][_0x11458d(0x1d4)]==_0x11458d(0x162))var _0x1f83f4=users[_0x11458d(0x162)];else{if(_0x1ac16c[0x0][_0x11458d(0x1d4)]=='Arabic\x20(ae)')var _0x1f83f4=users[_0x11458d(0x20b)];}}}}}}}_0x2402b1[_0x11458d(0x1ba)](_0x11458d(0x196),{'success':_0x5e3ac5[_0x11458d(0x182)](_0x11458d(0x1ce)),'errors':_0x5e3ac5[_0x11458d(0x182)]('errors'),'role':_0x2025fc,'profile':_0x4f509d,'master_shop':_0x1ac16c,'warehouse':_0x5dc837,'transfer':_0x17e67e,'stock':_0x6dc048,'unit':_0xfd42ef,'language':_0x1f83f4,'levels':_0x591506,'Isle':_0x1a20e3,'rooms_data':_0x2a440c,'ed_fullDate':_0x1b3a24,'dataSelected':_0x577eb6});}catch(_0x171d5a){console[_0x11458d(0x150)](_0x171d5a);}}),router[a0_0x5cb205(0x20d)](a0_0x5cb205(0x1ac),auth,async(_0x84805f,_0x3cf45b)=>{var _0x20a128=a0_0x5cb205;try{const _0x521d50=_0x84805f['params']['id'];console['log'](_0x84805f[_0x20a128(0x1cd)]);const _0x500459=await transfers_finished[_0x20a128(0x1f0)](_0x521d50);console[_0x20a128(0x150)](_0x20a128(0x22f),_0x500459);const {date:_0x249504,from_warehouse:_0x5075f7,FromRoom_name:_0x2f5c17,to_warehouse:_0x47d9a0,ToRoom_name:_0x2343a2,prod_name:_0x51fc5c,from_prod_qty:_0x258812,from_prod_level:_0x3ed805,from_prod_isle:_0x5e7e6f,from_prod_pallet:_0x72c1bb,to_prod_qty:_0x201d3d,to_prod_level:_0x4b1338,to_prod_isle:_0x397856,to_prod_pallet:_0x3bd56d,primary_code:_0x4bf51f,secondary_code:_0x1913ed,product_code3:_0x584a49,note:_0x4a4b17,invoice:_0x4b2569,expiry_date:_0xef7579}=_0x84805f[_0x20a128(0x1cd)];if(typeof _0x51fc5c=='string')var _0x9a279b=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x206)]],_0x309fbf=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x1b6)]],_0x3fba83=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x209)]],_0x533892=[_0x84805f[_0x20a128(0x1cd)]['to_prod_qty']],_0x5320f1=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x225)]],_0x2749a4=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x1f2)]],_0x490d68=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x19f)]],_0x23fdec=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x218)]],_0x5e3319=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x171)]],_0x5e1ec0=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x20c)]],_0x2246bc=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x16d)]],_0x41ac7c=[_0x84805f[_0x20a128(0x1cd)][_0x20a128(0x18d)]],_0x37e223=[_0x84805f['body']['expiry_date']];else var _0x9a279b=[..._0x84805f[_0x20a128(0x1cd)]['prod_name']],_0x309fbf=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x1b6)]],_0x3fba83=[..._0x84805f[_0x20a128(0x1cd)]['from_prod_level']],_0x533892=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x1a3)]],_0x5320f1=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x225)]],_0x2749a4=[..._0x84805f['body'][_0x20a128(0x1f2)]],_0x490d68=[..._0x84805f['body'][_0x20a128(0x19f)]],_0x23fdec=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x218)]],_0x5e3319=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x171)]],_0x5e1ec0=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x20c)]],_0x2246bc=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x16d)]],_0x41ac7c=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x18d)]],_0x37e223=[..._0x84805f[_0x20a128(0x1cd)][_0x20a128(0x1ef)]];const _0x22d5ba=_0x9a279b[_0x20a128(0x1c3)](_0x124a47=>{return _0x124a47={'product_name':_0x124a47};});_0x309fbf[_0x20a128(0x197)]((_0x500435,_0x271e5a)=>{var _0x500bf5=_0x20a128;_0x22d5ba[_0x271e5a][_0x500bf5(0x19a)]=_0x500435;}),_0x3fba83[_0x20a128(0x197)]((_0x4f7d42,_0x825b3d)=>{var _0x2dbd3a=_0x20a128;_0x22d5ba[_0x825b3d][_0x2dbd3a(0x183)]=_0x4f7d42;}),_0x533892[_0x20a128(0x197)]((_0x72858b,_0x340103)=>{var _0x47edf3=_0x20a128;_0x22d5ba[_0x340103][_0x47edf3(0x1dc)]=_0x72858b;}),_0x5320f1['forEach']((_0x5f54bf,_0x57db73)=>{var _0xa54142=_0x20a128;_0x22d5ba[_0x57db73][_0xa54142(0x18a)]=_0x5f54bf;}),_0x2749a4['forEach']((_0x131d88,_0x3125ce)=>{var _0x11eca5=_0x20a128;_0x22d5ba[_0x3125ce][_0x11eca5(0x1f2)]=_0x131d88;}),_0x490d68[_0x20a128(0x197)]((_0x21f1f4,_0x4a0041)=>{var _0x2a28c6=_0x20a128;_0x22d5ba[_0x4a0041][_0x2a28c6(0x19f)]=_0x21f1f4;}),_0x23fdec[_0x20a128(0x197)]((_0x3622f1,_0x1336e1)=>{var _0x59c32d=_0x20a128;_0x22d5ba[_0x1336e1][_0x59c32d(0x1d8)]=_0x3622f1;}),_0x5e3319[_0x20a128(0x197)]((_0x51e7af,_0x4bf91f)=>{_0x22d5ba[_0x4bf91f]['maxProducts']=_0x51e7af;}),_0x5e1ec0[_0x20a128(0x197)]((_0x33aee0,_0x22a665)=>{var _0x400f07=_0x20a128;_0x22d5ba[_0x22a665][_0x400f07(0x20c)]=_0x33aee0;}),_0x2246bc[_0x20a128(0x197)]((_0x116c39,_0x3410fb)=>{var _0x581a6a=_0x20a128;_0x22d5ba[_0x3410fb][_0x581a6a(0x16d)]=_0x116c39;}),_0x41ac7c[_0x20a128(0x197)]((_0x4520b8,_0x1b61fd)=>{var _0x4ebc84=_0x20a128;_0x22d5ba[_0x1b61fd][_0x4ebc84(0x18d)]=_0x4520b8;}),_0x37e223['forEach']((_0x3fd7d6,_0x49a14b)=>{var _0x43dd88=_0x20a128;_0x22d5ba[_0x49a14b][_0x43dd88(0x1ef)]=_0x3fd7d6;});const _0x1f5574=_0x22d5ba[_0x20a128(0x19b)](_0x6d54c6=>_0x6d54c6['to_quantity']!=='0'&&_0x6d54c6[_0x20a128(0x1dc)]!==''||_0x6d54c6[_0x20a128(0x1e8)]!=='0'&&_0x6d54c6[_0x20a128(0x1e8)]!=='');var _0x584a0e=0x0;_0x1f5574[_0x20a128(0x197)](_0x110128=>{var _0x1e7907=_0x20a128;parseInt(_0x110128['from_quantity'])<parseInt(_0x110128[_0x1e7907(0x1dc)])&&_0x584a0e++;});if(_0x584a0e!=0x0)return _0x84805f['flash'](_0x20a128(0x17c),_0x20a128(0x1d6)),_0x3cf45b[_0x20a128(0x176)](_0x20a128(0x1fc));const _0x59642f=await warehouse[_0x20a128(0x163)]({'name':_0x500459[_0x20a128(0x1ec)],'room':_0x500459[_0x20a128(0x199)]});_0x500459[_0x20a128(0x159)][_0x20a128(0x197)](_0x1de090=>{var _0x4b1bbc=_0x20a128;if(_0x1de090[_0x4b1bbc(0x1dc)]>0x0){const _0x572233=_0x59642f[_0x4b1bbc(0x207)][_0x4b1bbc(0x1c3)](_0x5cad56=>{var _0x1eceea=_0x4b1bbc;_0x5cad56[_0x1eceea(0x156)]==_0x1de090[_0x1eceea(0x156)]&&_0x5cad56[_0x1eceea(0x1f3)]==_0x1de090[_0x1eceea(0x183)]&&(_0x5cad56[_0x1eceea(0x1f6)]=parseInt(_0x5cad56[_0x1eceea(0x1f6)])+parseInt(_0x1de090[_0x1eceea(0x1dc)]));});}}),await _0x59642f[_0x20a128(0x1a8)]();const _0x49415c=await warehouse[_0x20a128(0x163)]({'name':_0x500459['to_warehouse'],'room':_0x500459[_0x20a128(0x179)]});_0x500459[_0x20a128(0x159)][_0x20a128(0x197)](_0x973a02=>{var _0x1fca06=_0x20a128;if(_0x973a02[_0x1fca06(0x1dc)]>0x0){const _0x2b4813=_0x49415c[_0x1fca06(0x207)][_0x1fca06(0x1c3)](_0x2a0d3d=>{var _0x5e1068=_0x1fca06;_0x2a0d3d[_0x5e1068(0x156)]==_0x973a02[_0x5e1068(0x156)]&&_0x2a0d3d['bay']==_0x973a02['to_bay']&&(_0x2a0d3d[_0x5e1068(0x1f6)]=parseInt(_0x2a0d3d[_0x5e1068(0x1f6)])-parseInt(_0x973a02[_0x5e1068(0x1dc)]));});}}),await _0x49415c[_0x20a128(0x1a8)](),_0x500459[_0x20a128(0x1ee)]=_0x249504,_0x500459[_0x20a128(0x1ec)]=_0x5075f7,_0x500459[_0x20a128(0x1a0)]=_0x47d9a0,_0x500459[_0x20a128(0x159)]=_0x1f5574,_0x500459[_0x20a128(0x1cc)]=_0x4a4b17,_0x500459[_0x20a128(0x22d)]=_0x4b2569;const _0x87df4c=await _0x500459['save'](),_0x3880c4=await warehouse[_0x20a128(0x163)]({'name':_0x5075f7,'room':_0x2f5c17});_0x87df4c[_0x20a128(0x159)][_0x20a128(0x197)](_0x47f83d=>{var _0x4b35b7=_0x20a128;if(_0x47f83d[_0x4b35b7(0x1dc)]>0x0){const _0x3973d3=_0x3880c4[_0x4b35b7(0x207)][_0x4b35b7(0x1c3)](_0x351c91=>{var _0x2695e5=_0x4b35b7;_0x351c91[_0x2695e5(0x156)]==_0x47f83d[_0x2695e5(0x156)]&&_0x351c91[_0x2695e5(0x1f3)]==_0x47f83d[_0x2695e5(0x183)]&&(_0x351c91['product_stock']=parseInt(_0x351c91[_0x2695e5(0x1f6)])-parseInt(_0x47f83d[_0x2695e5(0x1dc)]));});}}),await _0x3880c4[_0x20a128(0x1a8)]();const _0x2fcbd5=await warehouse[_0x20a128(0x163)]({'name':_0x47d9a0,'room':_0x2343a2});_0x87df4c[_0x20a128(0x159)]['forEach'](_0x4d8f53=>{var _0x52a128=_0x20a128;if(_0x4d8f53['to_quantity']>0x0){var _0x3bb379=0x0;const _0x92cb8b=_0x2fcbd5['product_details'][_0x52a128(0x1c3)](_0xf361a=>{var _0x4b4f78=_0x52a128;_0xf361a[_0x4b4f78(0x156)]==_0x4d8f53[_0x4b4f78(0x156)]&&_0xf361a[_0x4b4f78(0x1f3)]==_0x4d8f53[_0x4b4f78(0x18a)]&&(_0xf361a['product_stock']=parseInt(_0xf361a[_0x4b4f78(0x1f6)])+parseInt(_0x4d8f53[_0x4b4f78(0x1dc)]),_0x3bb379++);});_0x3bb379=='0'&&(_0x2fcbd5[_0x52a128(0x207)]=_0x2fcbd5[_0x52a128(0x207)][_0x52a128(0x16c)]({'product_name':_0x4d8f53[_0x52a128(0x156)],'product_stock':_0x4d8f53[_0x52a128(0x1dc)],'bay':_0x4d8f53['to_bay'],'product_code':_0x4d8f53[_0x52a128(0x1d8)],'primary_code':_0x4d8f53[_0x52a128(0x1f2)],'secondary_code':_0x4d8f53[_0x52a128(0x19f)],'maxProducts':_0x4d8f53[_0x52a128(0x205)]}));}}),await _0x2fcbd5[_0x20a128(0x1a8)](),_0x84805f[_0x20a128(0x182)](_0x20a128(0x1ce),_0x20a128(0x1bd)),_0x3cf45b[_0x20a128(0x176)](_0x20a128(0x177));}catch(_0x4f0e9a){console[_0x20a128(0x150)](_0x4f0e9a);}}),router['post']('/barcode_scanner',async(_0x426a7c,_0x4b3e8e)=>{var _0x19b107=a0_0x5cb205;const {FromWareHouse:_0x15e56a,FromRoom:_0x156740,ToWarehouse:_0x47314f,ToRoom:_0x2e6966,primary_code:_0x7a3835,Roomslist:_0x1156b1}=_0x426a7c[_0x19b107(0x1cd)],_0x5df36e=_0x1156b1['split'](','),_0x4826ac=[];async function _0x4b0299(_0x1d79d2){var _0x2e5115=_0x19b107;const _0x19eae2=await warehouse['aggregate']([{'$match':{'name':_0x15e56a,'room':_0x1d79d2}},{'$unwind':_0x2e5115(0x1af)},{'$match':{'product_details.primary_code':_0x7a3835}},{'$group':{'_id':_0x2e5115(0x191),'name':{'$first':_0x2e5115(0x16a)},'instock':{'$first':_0x2e5115(0x174)},'primary_code':{'$first':_0x2e5115(0x1ad)},'secondary_code':{'$first':_0x2e5115(0x1a1)},'product_code':{'$first':_0x2e5115(0x17e)},'level':{'$first':_0x2e5115(0x17f)},'isle':{'$first':_0x2e5115(0x168)},'type':{'$first':_0x2e5115(0x228)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2e5115(0x21f)},'secondary_unit':{'$first':_0x2e5115(0x1a4)},'storage':{'$first':_0x2e5115(0x1b2)},'rack':{'$first':_0x2e5115(0x21c)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x2e5115(0x1a7)},'batch_code':{'$first':_0x2e5115(0x226)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x2e5115(0x20e)}}}]),_0x4520b4=await warehouse['aggregate']([{'$match':{'name':_0x15e56a,'room':_0x1d79d2}},{'$unwind':_0x2e5115(0x1af)},{'$match':{'product_details.secondary_code':_0x7a3835}},{'$group':{'_id':_0x2e5115(0x191),'name':{'$first':_0x2e5115(0x16a)},'instock':{'$first':_0x2e5115(0x174)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x2e5115(0x1a1)},'product_code':{'$first':_0x2e5115(0x17e)},'level':{'$first':_0x2e5115(0x17f)},'isle':{'$first':_0x2e5115(0x168)},'type':{'$first':_0x2e5115(0x228)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2e5115(0x21f)},'secondary_unit':{'$first':_0x2e5115(0x1a4)},'storage':{'$first':_0x2e5115(0x1b2)},'rack':{'$first':_0x2e5115(0x21c)},'expiry_date':{'$first':_0x2e5115(0x222)},'production_date':{'$first':_0x2e5115(0x1a7)},'batch_code':{'$first':_0x2e5115(0x226)},'maxPerUnit':{'$first':_0x2e5115(0x20f)},'roomNamed':{'$first':_0x2e5115(0x186)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x2e5115(0x20e)}}}]);if(_0x19eae2[_0x2e5115(0x1c0)]>0x0)_0x4826ac[_0x2e5115(0x18c)](_0x19eae2);else _0x4520b4[_0x2e5115(0x1c0)]>0x0&&_0x4826ac[_0x2e5115(0x18c)](_0x4520b4);}const _0x18c2e3=_0x5df36e[_0x19b107(0x1c3)](_0x418990=>_0x4b0299(_0x418990));await Promise['all'](_0x18c2e3),_0x4b3e8e[_0x19b107(0x187)](_0x4826ac);}),router[a0_0x5cb205(0x20d)](a0_0x5cb205(0x181),async(_0x26ef1b,_0x3f0215)=>{var _0x3070c4=a0_0x5cb205;try{const {FromWareHouse:_0x502061,FromRoom:_0x5b39e2,ToWarehouse:_0x2180b1,ToRoom:_0x485111,secondary_code:_0x319d49}=_0x26ef1b[_0x3070c4(0x1cd)],_0x7000f0=await warehouse[_0x3070c4(0x1d3)]([{'$match':{'name':_0x502061}},{'$unwind':_0x3070c4(0x1af)},{'$match':{'product_details.secondary_code':_0x319d49}},{'$group':{'_id':_0x3070c4(0x191),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x3070c4(0x1ad)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3070c4(0x17e)},'instock':{'$first':_0x3070c4(0x174)},'warehouse':{'$first':_0x3070c4(0x184)},'level':{'$first':_0x3070c4(0x21a)},'isle':{'$first':_0x3070c4(0x153)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'},'unit':{'$first':_0x3070c4(0x21f)},'expiry_date':{'$first':_0x3070c4(0x222)},'production_date':{'$first':_0x3070c4(0x1a7)}}}]);_0x3f0215[_0x3070c4(0x1f5)](0xc8)[_0x3070c4(0x187)](_0x7000f0);}catch(_0xe56dd4){_0x3f0215['status'](0x194)[_0x3070c4(0x187)]({'message':_0xe56dd4['message']});}}),router[a0_0x5cb205(0x20d)](a0_0x5cb205(0x1fd),async(_0x549891,_0xcaf62d)=>{var _0x5b4f6c=a0_0x5cb205;try{const {FromWareHouse:_0x26d88f,FromRoom:_0x2c669e,ToWarehouse:_0x1288b6,ToRoom:_0x750d95,product_code:_0x1e8daa}=_0x549891['body'],_0x355aa3=await warehouse[_0x5b4f6c(0x1d3)]([{'$match':{'name':_0x26d88f}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x1e8daa}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5b4f6c(0x16a)},'primary_code':{'$first':_0x5b4f6c(0x1ad)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x5b4f6c(0x17e)},'instock':{'$first':_0x5b4f6c(0x174)},'warehouse':{'$first':'$name'},'level':{'$first':_0x5b4f6c(0x21a)},'isle':{'$first':_0x5b4f6c(0x153)},'pallet':{'$first':_0x5b4f6c(0x175)},'maxProducts':{'$first':_0x5b4f6c(0x15d)},'unit':{'$first':_0x5b4f6c(0x21f)}}}]);_0xcaf62d[_0x5b4f6c(0x1f5)](0xc8)[_0x5b4f6c(0x187)](_0x355aa3);}catch(_0x5c2f95){_0xcaf62d[_0x5b4f6c(0x1f5)](0x194)[_0x5b4f6c(0x187)]({'message':_0x5c2f95[_0x5b4f6c(0x1f7)]});}}),router[a0_0x5cb205(0x20d)]('/CheckingWarehouse',async(_0x3e9cc2,_0x5c0e84)=>{var _0x12ba66=a0_0x5cb205;const {productCode:_0xd92199,bay:_0xbb1e98,warehouses:_0x48d25a,room:_0xa6581a}=_0x3e9cc2[_0x12ba66(0x1cd)];console[_0x12ba66(0x150)](_0x3e9cc2[_0x12ba66(0x1cd)]);try{const _0x426baf=await warehouse[_0x12ba66(0x1d3)]([{'$match':{'name':_0x48d25a,'room':_0xa6581a}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0xbb1e98)}},{'$group':{'_id':_0x12ba66(0x191),'name':{'$first':_0x12ba66(0x16a)},'product_stock':{'$first':_0x12ba66(0x174)},'bay':{'$first':_0x12ba66(0x17f)},'maxProducts':{'$first':_0x12ba66(0x15d)}}}]);_0x5c0e84[_0x12ba66(0x1f5)](0xc8)[_0x12ba66(0x187)](_0x426baf);}catch(_0x512bcb){_0x5c0e84['status'](0x194)[_0x12ba66(0x187)]({'message':_0x512bcb[_0x12ba66(0x1f7)]});}}),module[a0_0x5cb205(0x14d)]=router;