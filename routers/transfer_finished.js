var a0_0x24fdc6=a0_0x168d;(function(_0x126918,_0x67619e){var _0x40b403=a0_0x168d,_0x3c56b0=_0x126918();while(!![]){try{var _0x2413b0=-parseInt(_0x40b403(0x209))/0x1*(parseInt(_0x40b403(0x1d5))/0x2)+parseInt(_0x40b403(0x1c5))/0x3*(-parseInt(_0x40b403(0x263))/0x4)+-parseInt(_0x40b403(0x260))/0x5+-parseInt(_0x40b403(0x1da))/0x6*(parseInt(_0x40b403(0x1c3))/0x7)+-parseInt(_0x40b403(0x240))/0x8*(parseInt(_0x40b403(0x25c))/0x9)+-parseInt(_0x40b403(0x282))/0xa+parseInt(_0x40b403(0x222))/0xb;if(_0x2413b0===_0x67619e)break;else _0x3c56b0['push'](_0x3c56b0['shift']());}catch(_0x174ece){_0x3c56b0['push'](_0x3c56b0['shift']());}}}(a0_0x9d64,0x5af5e));function a0_0x168d(_0x4aa5c4,_0x17eeaa){var _0x9d6434=a0_0x9d64();return a0_0x168d=function(_0x168d59,_0x3581e8){_0x168d59=_0x168d59-0x1b1;var _0x3a476b=_0x9d6434[_0x168d59];return _0x3a476b;},a0_0x168d(_0x4aa5c4,_0x17eeaa);}const express=require(a0_0x24fdc6(0x277)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x24fdc6(0x1d2)),auth=require('../middleware/auth'),users=require(a0_0x24fdc6(0x1b6)),nodemailer=require(a0_0x24fdc6(0x1fc));function a0_0x9d64(){var _0x2fa8c2=['message','getFullYear','$product_details.product_name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>','<html><head><title></title>','FROZEN\x20GOODS','/barcode_scanner3','Rack\x201','from_prod_qty','from_invoice','express','unit','$product.to_room_name','to_quantity','max','_id','/upload/','flash','redirect','primary_code','<!DOCTYPE\x20html>','5021640JwBZoA','product_code3','Portuguese','role','product','/view/add_transfer','QA\x20Warehouse','Transfer\x20Mail','/transfer_finished/preview/','$_id','\x20Order\x20Date\x20:\x20','email','port','$product_details.secondary_code','MaxStocks_data2','createTransport','$product_details._id','to_prod_qty','then','to_bay','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','../public/language/languages.json','Product\x20Transfer\x20successfully','string','</table>','maxPerUnit','user','render','$product_details.maxPerUnit','Finished\x20Goods','MaxStocks_data','$product_details.isle','</h5>','$to_warehouse','14wyXJCV','$finalize','725151GWABvN','</div>','To_invoice','all','$product_details.bay','from_warehouse','getDate','expiry_date','</span>','$product.from_room_name','log','<h5\x20style=\x22text-align:\x20left;\x22>','push','../models/all_models','to_floorlevel','status','71026rOZCgE','Ambient','$product_details.rack','</tbody>','$product_details.bin','984834iGUQtm','$product_details','to_room_name','findById','padStart','There\x27s\x20a\x20error\x20in\x20this\x20transaction','product_name','Enabled','undefined','Spanish','prod_cat','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','from_quantity','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','random','/transfer/view','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','note','$product_details.pallet','English','from_prod_level','product_code','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/picking_list/PDF_transfer/','catch','$product_details.type','length','batch_code','bay','\x20</h2>','edit_transfer_finished_view','language','$product_details.floorlevel','find','nodemailer','prod_name','/view','product_date','$from_warehouse','True','<h2>\x20','finalize','concat','French','forEach','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','error','1KomlmG','secondary_code','$product_details.unit','password','English\x20(US)','Portuguese\x20(BR)','\x20<=>\x20','$product_details.batch_code','/preview/:id','Chinese','product_details','</thead>','$date','from_room','updateOne','$room','date','image','findOne','New_Qty_Converted','Email\x20sent\x20successfully','slice','toString','<tr>','Hindi','31640895UAmdvk','split','DRY\x20GOODS','product_stock','abs','to_invoice','from_bay','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','from_room_name','to_prod_level','transfer_data','to_warehouse','get','errors','\x20<>\x20','/../public','Rack\x202','success','invoice','save','edit_transfer_finished','secondary_unit','RoomAssigned','id_transaction','$product_details.invoice','$product_details.maxProducts','$name','production_date','$product_details.primary_code','site_title','105176IPKTtO','Error\x20Occurs','Transfer\x20Finalize\x20Successfully','$product_details.secondary_unit','TRFF-','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Arabic','params','$product_details.level','$product_details.product_stock','German','$invoice','/CheckingWarehouse','body','exports','warehouse','logo','FGSEmail','Enclosed','maxProducts','</tr>','Logo.png','<tbody\x20style=\x22text-align:\x20center;\x22>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','post','$product_details.product_code','ToRoomAssigned','387BoBsvJ','$product_details.storage','staff','/view/:id','1737220ZzclaA','json','<div>','12dXZpaQ','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','primary_unit','aggregate','map','$product_details.expiry_date','/transfer_finished/view','Arabic\x20(ae)','</td>','$product_details.production_date'];a0_0x9d64=function(){return _0x2fa8c2;};return a0_0x9d64();}router['get'](a0_0x24fdc6(0x1fe),auth,async(_0x479e0f,_0x244cc3)=>{var _0x323a93=a0_0x24fdc6;try{const {username:_0x53e2b0,email:_0x25bc6c,role:_0x541c83}=_0x479e0f[_0x323a93(0x1bb)],_0x38c71d=_0x479e0f['user'],_0x1db5ec=await profile[_0x323a93(0x21b)]({'email':_0x38c71d[_0x323a93(0x28d)]}),_0x2c6cc9=await master_shop['find']();let _0x21e766;if(_0x38c71d[_0x323a93(0x285)]==_0x323a93(0x25e)){const _0x11feff=await staff[_0x323a93(0x21b)]({'email':_0x38c71d[_0x323a93(0x28d)]});_0x21e766=await transfers_finished[_0x323a93(0x1fb)]({'from_warehouse':_0x11feff['warehouse']});}else _0x21e766=await transfers_finished[_0x323a93(0x266)]([{'$unwind':'$product'},{'$group':{'_id':_0x323a93(0x28b),'invoice':{'$first':_0x323a93(0x24c)},'date':{'$first':_0x323a93(0x215)},'from_warehouse':{'$first':_0x323a93(0x200)},'to_warehouse':{'$first':_0x323a93(0x1c2)},'from_room_name':{'$addToSet':_0x323a93(0x1ce)},'to_room_name':{'$addToSet':_0x323a93(0x279)},'finalize':{'$first':_0x323a93(0x1c4)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x2c6cc9[0x0]['language']==_0x323a93(0x20d))var _0x2afb11=users[_0x323a93(0x1ed)];else{if(_0x2c6cc9[0x0][_0x323a93(0x1f9)]==_0x323a93(0x221))var _0x2afb11=users[_0x323a93(0x221)];else{if(_0x2c6cc9[0x0][_0x323a93(0x1f9)]==_0x323a93(0x24b))var _0x2afb11=users[_0x323a93(0x24b)];else{if(_0x2c6cc9[0x0][_0x323a93(0x1f9)]==_0x323a93(0x1e3))var _0x2afb11=users[_0x323a93(0x1e3)];else{if(_0x2c6cc9[0x0][_0x323a93(0x1f9)]==_0x323a93(0x205))var _0x2afb11=users['French'];else{if(_0x2c6cc9[0x0][_0x323a93(0x1f9)]==_0x323a93(0x20e))var _0x2afb11=users[_0x323a93(0x284)];else{if(_0x2c6cc9[0x0][_0x323a93(0x1f9)]==_0x323a93(0x212))var _0x2afb11=users['Chinese'];else{if(_0x2c6cc9[0x0]['language']=='Arabic\x20(ae)')var _0x2afb11=users['Arabic'];}}}}}}}_0x244cc3['render']('transfer_finished',{'success':_0x479e0f[_0x323a93(0x27e)](_0x323a93(0x233)),'errors':_0x479e0f['flash']('errors'),'role':_0x38c71d,'profile':_0x1db5ec,'master_shop':_0x2c6cc9,'transfer':_0x21e766,'language':_0x2afb11});}catch(_0x464c32){console[_0x323a93(0x1cf)](_0x464c32);}});async function getRandom8DigitNumber(){var _0x482241=a0_0x24fdc6;const _0x423aa9=0x989680,_0x42ec6a=0x5f5e0ff,_0x5170e7=Math['floor'](Math[_0x482241(0x1e8)]()*(_0x42ec6a-_0x423aa9+0x1))+_0x423aa9;var _0x3c9a2c;const _0x44b46a=await transfers_finished[_0x482241(0x21b)]({'invoice':'TRFF-'+_0x5170e7});return _0x44b46a&&_0x44b46a['length']>0x0?_0x3c9a2c='TRFF-'+_0x5170e7:_0x3c9a2c=_0x482241(0x244)+_0x5170e7,_0x3c9a2c;}router[a0_0x24fdc6(0x22e)](a0_0x24fdc6(0x287),auth,async(_0x5436d0,_0x209e2f)=>{var _0x4133db=a0_0x24fdc6;try{const {username:_0x4c0858,email:_0x4cd50d,role:_0x5a57df}=_0x5436d0['user'],_0x4d89fa=_0x5436d0[_0x4133db(0x1bb)],_0x30b3f3=await profile[_0x4133db(0x21b)]({'email':_0x4d89fa[_0x4133db(0x28d)]}),_0x248dad=await master_shop[_0x4133db(0x1fb)]();let _0x547038;if(_0x4d89fa[_0x4133db(0x285)]=='staff'){const _0x411319=await staff[_0x4133db(0x21b)]({'email':_0x4d89fa[_0x4133db(0x28d)]});_0x547038=await warehouse[_0x4133db(0x266)]([{'$match':{'status':_0x4133db(0x1e1),'name':_0x411319['warehouse'],'warehouse_category':_0x4133db(0x1be),'name':{'$ne':_0x4133db(0x288)}}},{'$group':{'_id':_0x4133db(0x23c),'name':{'$first':_0x4133db(0x23c)}}}]);}else _0x547038=await warehouse[_0x4133db(0x266)]([{'$match':{'status':_0x4133db(0x1e1),'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x4133db(0x288)}}},{'$group':{'_id':_0x4133db(0x23c),'name':{'$first':_0x4133db(0x23c)}}}]);const _0x3293d0=await transfers_finished[_0x4133db(0x1fb)]({}),_0x1f3028=_0x3293d0['length']+0x1,_0x1d87d6='TRFF-'+_0x1f3028[_0x4133db(0x21f)]()[_0x4133db(0x1de)](0x5,'0');if(_0x248dad[0x0]['language']==_0x4133db(0x20d))var _0x73ec92=users[_0x4133db(0x1ed)];else{if(_0x248dad[0x0][_0x4133db(0x1f9)]==_0x4133db(0x221))var _0x73ec92=users[_0x4133db(0x221)];else{if(_0x248dad[0x0][_0x4133db(0x1f9)]==_0x4133db(0x24b))var _0x73ec92=users[_0x4133db(0x24b)];else{if(_0x248dad[0x0][_0x4133db(0x1f9)]==_0x4133db(0x1e3))var _0x73ec92=users[_0x4133db(0x1e3)];else{if(_0x248dad[0x0][_0x4133db(0x1f9)]==_0x4133db(0x205))var _0x73ec92=users['French'];else{if(_0x248dad[0x0][_0x4133db(0x1f9)]=='Portuguese\x20(BR)')var _0x73ec92=users[_0x4133db(0x284)];else{if(_0x248dad[0x0][_0x4133db(0x1f9)]==_0x4133db(0x212))var _0x73ec92=users[_0x4133db(0x212)];else{if(_0x248dad[0x0][_0x4133db(0x1f9)]=='Arabic\x20(ae)')var _0x73ec92=users[_0x4133db(0x247)];}}}}}}}const _0x15d61b=getRandom8DigitNumber();_0x15d61b[_0x4133db(0x1b3)](_0x2322f9=>{var _0x43b628=_0x4133db;_0x209e2f['render']('add_transfer_finished',{'success':_0x5436d0[_0x43b628(0x27e)](_0x43b628(0x233)),'errors':_0x5436d0[_0x43b628(0x27e)]('errors'),'role':_0x4d89fa,'profile':_0x30b3f3,'master_shop':_0x248dad,'warehouse':_0x547038,'language':_0x73ec92,'invoice':_0x2322f9});})[_0x4133db(0x1f2)](_0x194924=>{var _0x56bf22=_0x4133db;_0x5436d0[_0x56bf22(0x27e)]('errors',_0x56bf22(0x1df)),_0x209e2f[_0x56bf22(0x27f)](_0x56bf22(0x1e9));});}catch(_0x6fccb0){console['log'](_0x6fccb0);}}),router[a0_0x24fdc6(0x259)](a0_0x24fdc6(0x287),auth,async(_0x346eef,_0x12f401)=>{var _0x2f045e=a0_0x24fdc6;try{const {date:_0xad00b9,from_warehouse:_0x1842c5,FromRoom_name:_0x431a91,to_warehouse:_0x468bde,ToRoom_name:_0x516d74,prod_name:_0x3ede40,from_prod_qty:_0x34ee35,from_prod_level:_0x3275f3,from_prod_isle:_0x2723f6,from_prod_pallet:_0x26f701,to_prod_qty:_0x131e9d,to_prod_level:_0x139d31,to_prod_isle:_0x4a27a5,to_prod_pallet:_0x3e588c,primary_code:_0x16b6d3,secondary_code:_0x58b051,product_code3:_0x124433,note:_0x4c9529,MaxStocks_data2:_0x15ae8c,invoice:_0x351cd4,expiry_date:_0x2f08fd}=_0x346eef[_0x2f045e(0x24e)];if(typeof _0x3ede40==_0x2f045e(0x1b8))var _0x5b99cf=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1fd)]],_0x4622d0=[_0x346eef[_0x2f045e(0x24e)]['from_prod_qty']],_0x506842=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1ee)]],_0x3f79cf=[_0x346eef[_0x2f045e(0x24e)]['New_Qty_Converted']],_0x3c9898=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x22b)]],_0x34d71d=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x280)]],_0x488374=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x20a)]],_0xdaf195=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x283)]],_0x375b7d=[_0x346eef['body'][_0x2f045e(0x290)]],_0x3a9d88=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x265)]],_0x2fecc9=[_0x346eef['body'][_0x2f045e(0x237)]],_0xdcc586=[_0x346eef['body'][_0x2f045e(0x1f5)]],_0x51d043=[_0x346eef['body'][_0x2f045e(0x1cc)]],_0x252a43=[_0x346eef[_0x2f045e(0x24e)]['product_date']],_0x4ecc6b=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1bf)]],_0x1a4235=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1ba)]],_0x176a4e=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1e4)]],_0x455ab6=[_0x346eef[_0x2f045e(0x24e)]['RoomAssigned']],_0x208093=[_0x346eef[_0x2f045e(0x24e)]['ToRoomAssigned']],_0x398cc2=[_0x346eef['body'][_0x2f045e(0x276)]],_0x1c1271=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x227)]],_0x245993=[_0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x239)]];else var _0x5b99cf=[..._0x346eef[_0x2f045e(0x24e)]['prod_name']],_0x4622d0=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x275)]],_0x506842=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1ee)]],_0x3f79cf=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x21c)]],_0x3c9898=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x22b)]],_0x34d71d=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x280)]],_0x488374=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x20a)]],_0xdaf195=[..._0x346eef[_0x2f045e(0x24e)]['product_code3']],_0x375b7d=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x290)]],_0x3a9d88=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x265)]],_0x2fecc9=[..._0x346eef[_0x2f045e(0x24e)]['secondary_unit']],_0xdcc586=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1f5)]],_0x51d043=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1cc)]],_0x252a43=[..._0x346eef['body'][_0x2f045e(0x1ff)]],_0x4ecc6b=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x1bf)]],_0x1a4235=[..._0x346eef[_0x2f045e(0x24e)]['maxPerUnit']],_0x176a4e=[..._0x346eef['body'][_0x2f045e(0x1e4)]],_0x455ab6=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x238)]],_0x208093=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x25b)]],_0x398cc2=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x276)]],_0x1c1271=[..._0x346eef['body'][_0x2f045e(0x227)]],_0x245993=[..._0x346eef[_0x2f045e(0x24e)][_0x2f045e(0x239)]];const _0x501a07=_0x5b99cf['map'](_0xa8c114=>{return _0xa8c114={'product_name':_0xa8c114};});_0x4622d0[_0x2f045e(0x206)]((_0x522551,_0x2e95da)=>{var _0x4d70f0=_0x2f045e;_0x501a07[_0x2e95da][_0x4d70f0(0x1e6)]=_0x522551;}),_0x506842[_0x2f045e(0x206)]((_0x34b7c0,_0x183480)=>{var _0x4ed025=_0x2f045e;_0x501a07[_0x183480][_0x4ed025(0x228)]=_0x34b7c0;}),_0x245993[_0x2f045e(0x206)]((_0x4e4299,_0x3db5d1)=>{var _0x4a2f9b=_0x2f045e;_0x501a07[_0x3db5d1][_0x4a2f9b(0x239)]=_0x4e4299;}),_0x398cc2[_0x2f045e(0x206)]((_0x17eedb,_0x5bfbd6)=>{var _0x357688=_0x2f045e;_0x501a07[_0x5bfbd6][_0x357688(0x276)]=_0x17eedb;}),_0x1c1271['forEach']((_0x196b82,_0x2352db)=>{var _0x47f44e=_0x2f045e;_0x501a07[_0x2352db][_0x47f44e(0x1c7)]=_0x196b82;}),_0x3f79cf['forEach']((_0x11e4aa,_0x592203)=>{_0x501a07[_0x592203]['to_quantity']=_0x11e4aa;}),_0x3c9898[_0x2f045e(0x206)]((_0x19c527,_0x41e705)=>{var _0x59c8e0=_0x2f045e;_0x501a07[_0x41e705][_0x59c8e0(0x1b4)]=_0x19c527;}),_0x34d71d['forEach']((_0x3c3ecc,_0x535623)=>{var _0x23ecfc=_0x2f045e;_0x501a07[_0x535623][_0x23ecfc(0x280)]=_0x3c3ecc;}),_0x488374['forEach']((_0x17b043,_0x46ee16)=>{var _0x470b69=_0x2f045e;_0x501a07[_0x46ee16][_0x470b69(0x20a)]=_0x17b043;}),_0xdaf195[_0x2f045e(0x206)]((_0x4b6a9d,_0x5b530a)=>{var _0x1925fa=_0x2f045e;_0x501a07[_0x5b530a][_0x1925fa(0x1ef)]=_0x4b6a9d;}),_0x375b7d[_0x2f045e(0x206)]((_0x596805,_0x318d19)=>{var _0xc057d4=_0x2f045e;_0x501a07[_0x318d19][_0xc057d4(0x254)]=_0x596805;}),_0x3a9d88['forEach']((_0x3fdb8d,_0x1b9a58)=>{var _0x1b9762=_0x2f045e;_0x501a07[_0x1b9a58][_0x1b9762(0x278)]=_0x3fdb8d;}),_0x2fecc9[_0x2f045e(0x206)]((_0x39f582,_0x17fbe5)=>{var _0x5040ed=_0x2f045e;_0x501a07[_0x17fbe5][_0x5040ed(0x237)]=_0x39f582;}),_0xdcc586[_0x2f045e(0x206)]((_0x34b583,_0x19f0a9)=>{_0x501a07[_0x19f0a9]['batch_code']=_0x34b583;}),_0x51d043['forEach']((_0x34fb4e,_0x1227a1)=>{var _0x1f8a26=_0x2f045e;_0x501a07[_0x1227a1][_0x1f8a26(0x1cc)]=_0x34fb4e;}),_0x252a43[_0x2f045e(0x206)]((_0x37f549,_0x1fdc37)=>{_0x501a07[_0x1fdc37]['production_date']=_0x37f549;}),_0x4ecc6b[_0x2f045e(0x206)]((_0xc7aa99,_0x2ad1d2)=>{_0x501a07[_0x2ad1d2]['maxProducts']=_0xc7aa99;}),_0x1a4235[_0x2f045e(0x206)]((_0x440096,_0x3fdb53)=>{var _0x1f676f=_0x2f045e;_0x501a07[_0x3fdb53][_0x1f676f(0x1ba)]=_0x440096;}),_0x176a4e[_0x2f045e(0x206)]((_0x339d46,_0x94d094)=>{var _0x4ad2fa=_0x2f045e;_0x501a07[_0x94d094][_0x4ad2fa(0x1e4)]=_0x339d46;}),_0x455ab6[_0x2f045e(0x206)]((_0x308c55,_0x59877f)=>{_0x501a07[_0x59877f]['from_room_name']=_0x308c55;}),_0x208093[_0x2f045e(0x206)]((_0x195c13,_0x212310)=>{var _0x3a2d12=_0x2f045e;_0x501a07[_0x212310][_0x3a2d12(0x1dc)]=_0x195c13;});const _0x432bb9=_0x501a07['filter'](_0x3284e0=>_0x3284e0[_0x2f045e(0x27a)]!=='0'&&_0x3284e0['to_quantity']!==''||_0x3284e0[_0x2f045e(0x1d3)]!=='0'&&_0x3284e0[_0x2f045e(0x1d3)]!=='');var _0x3c9632=0x0;_0x432bb9['forEach'](_0x4ea1c5=>{var _0x48c2b9=_0x2f045e;parseInt(_0x4ea1c5[_0x48c2b9(0x1e6)])<parseInt(_0x4ea1c5[_0x48c2b9(0x27a)])&&_0x3c9632++;});if(_0x3c9632!=0x0)return _0x346eef[_0x2f045e(0x27e)](_0x2f045e(0x22f),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x12f401[_0x2f045e(0x27f)]('back');const _0x1987c8=new transfers_finished({'date':_0xad00b9,'from_warehouse':_0x1842c5,'to_warehouse':_0x468bde,'product':_0x432bb9,'note':_0x4c9529,'invoice':_0x351cd4}),_0x1ddf13=await _0x1987c8[_0x2f045e(0x235)]();_0x346eef['flash'](_0x2f045e(0x233),_0x2f045e(0x1b7)),_0x12f401[_0x2f045e(0x27f)](_0x2f045e(0x28a)+_0x1ddf13[_0x2f045e(0x27c)]);}catch(_0x23055d){console[_0x2f045e(0x1cf)](_0x23055d),_0x12f401[_0x2f045e(0x1d4)](0xc8)[_0x2f045e(0x261)]({'errorMessage':_0x23055d[_0x2f045e(0x26d)]});}}),router[a0_0x24fdc6(0x22e)](a0_0x24fdc6(0x211),auth,async(_0x580e5a,_0x2fcd7d)=>{var _0x1f737a=a0_0x24fdc6;try{const {username:_0x12f1a6,email:_0x504a54,role:_0x20404e}=_0x580e5a[_0x1f737a(0x1bb)],_0x10322b=_0x580e5a[_0x1f737a(0x1bb)],_0xf5a673=await profile[_0x1f737a(0x21b)]({'email':_0x10322b['email']}),_0x140f3b=await master_shop[_0x1f737a(0x1fb)](),_0x564139=await transfers_finished[_0x1f737a(0x1dd)](_0x580e5a[_0x1f737a(0x248)]['id']);let _0x340998;if(_0x10322b['role']==_0x1f737a(0x25e)){const _0x5c2218=await staff[_0x1f737a(0x21b)]({'email':_0x10322b['email']});_0x340998=await warehouse['find']({'status':_0x1f737a(0x1e1),'name':_0x5c2218[_0x1f737a(0x250)],'warehouse_category':_0x1f737a(0x1be)});}else _0x340998=await warehouse[_0x1f737a(0x1fb)]({'status':_0x1f737a(0x1e1),'warehouse_category':'Finished\x20Goods'});const _0x3579d9=await warehouse[_0x1f737a(0x266)]([{'$match':{'name':_0x564139[_0x1f737a(0x1ca)],'warehouse_category':'Finished\x20Goods'}},{'$unwind':_0x1f737a(0x1db)},{'$group':{'_id':_0x1f737a(0x1b1),'name':{'$first':_0x1f737a(0x26f)},'product_stock':{'$first':_0x1f737a(0x24a)},'bay':{'$first':_0x1f737a(0x1c9)},'bin':{'$first':_0x1f737a(0x1d9)},'type':{'$first':_0x1f737a(0x1f3)},'floorlevel':{'$first':_0x1f737a(0x1fa)},'primary_code':{'$first':_0x1f737a(0x23e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1f737a(0x25a)},'storage':{'$first':_0x1f737a(0x25d)},'rack':{'$first':_0x1f737a(0x1d7)},'expiry_date':{'$first':_0x1f737a(0x268)},'production_date':{'$first':_0x1f737a(0x26c)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x1f737a(0x23c)}}}]),_0x2c4ca5=await product[_0x1f737a(0x1fb)]({});if(_0x140f3b[0x0][_0x1f737a(0x1f9)]==_0x1f737a(0x20d)){var _0x10fa70=users[_0x1f737a(0x1ed)];console[_0x1f737a(0x1cf)](_0x10fa70);}else{if(_0x140f3b[0x0][_0x1f737a(0x1f9)]==_0x1f737a(0x221))var _0x10fa70=users[_0x1f737a(0x221)];else{if(_0x140f3b[0x0]['language']==_0x1f737a(0x24b))var _0x10fa70=users[_0x1f737a(0x24b)];else{if(_0x140f3b[0x0][_0x1f737a(0x1f9)]==_0x1f737a(0x1e3))var _0x10fa70=users[_0x1f737a(0x1e3)];else{if(_0x140f3b[0x0][_0x1f737a(0x1f9)]=='French')var _0x10fa70=users['French'];else{if(_0x140f3b[0x0][_0x1f737a(0x1f9)]==_0x1f737a(0x20e))var _0x10fa70=users[_0x1f737a(0x284)];else{if(_0x140f3b[0x0][_0x1f737a(0x1f9)]==_0x1f737a(0x212))var _0x10fa70=users[_0x1f737a(0x212)];else{if(_0x140f3b[0x0][_0x1f737a(0x1f9)]==_0x1f737a(0x26a))var _0x10fa70=users[_0x1f737a(0x247)];}}}}}}}_0x2fcd7d[_0x1f737a(0x1bc)](_0x1f737a(0x1f8),{'success':_0x580e5a['flash'](_0x1f737a(0x233)),'errors':_0x580e5a[_0x1f737a(0x27e)](_0x1f737a(0x22f)),'role':_0x10322b,'profile':_0xf5a673,'master_shop':_0x140f3b,'warehouse':_0x340998,'transfer':_0x564139,'stock':_0x3579d9,'unit':_0x2c4ca5,'language':_0x10fa70});}catch(_0x5b0d65){console[_0x1f737a(0x1cf)](_0x5b0d65);}}),router[a0_0x24fdc6(0x259)](a0_0x24fdc6(0x211),auth,async(_0x1d1188,_0x1517d9)=>{var _0x2d3900=a0_0x24fdc6;try{const {invoice:_0x5b9c27,from_warehouse:_0x12ddba,FromRoom_name:_0x1430ed,to_warehouse:_0x27502b,ToRoom_name:_0x5ab7ba}=_0x1d1188['body'],_0x5ed653=await transfers_finished['findById'](_0x1d1188[_0x2d3900(0x248)]['id']),_0x22e0af=_0x5ed653[_0x2d3900(0x286)][_0x2d3900(0x267)](async _0x350222=>{var _0x9b0e13=_0x2d3900;if(_0x350222[_0x9b0e13(0x27a)]>0x0){var _0x43a542=await warehouse[_0x9b0e13(0x21b)]({'name':_0x12ddba,'room':_0x350222[_0x9b0e13(0x22a)],'warehouse_category':_0x9b0e13(0x1be)});const _0x554435=_0x43a542[_0x9b0e13(0x213)][_0x9b0e13(0x267)](_0x16810a=>{var _0x359005=_0x9b0e13;_0x16810a[_0x359005(0x1e0)]==_0x350222[_0x359005(0x1e0)]&&_0x16810a[_0x359005(0x1f6)]==_0x350222[_0x359005(0x228)]&&_0x16810a['expiry_date']==_0x350222[_0x359005(0x1cc)]&&_0x16810a[_0x359005(0x23d)]==_0x350222[_0x359005(0x23d)]&&_0x16810a[_0x359005(0x1f5)]==_0x350222['batch_code']&&_0x16810a[_0x359005(0x234)]==_0x350222[_0x359005(0x276)]&&(console[_0x359005(0x1cf)]('here1',_0x16810a[_0x359005(0x225)]),typeof _0x350222[_0x359005(0x239)]==_0x359005(0x1e2)?_0x16810a[_0x359005(0x225)]=Math[_0x359005(0x27b)](0x0,Math[_0x359005(0x226)](_0x16810a[_0x359005(0x225)])-Math[_0x359005(0x226)](_0x350222[_0x359005(0x27a)])):_0x16810a['product_stock']=Math[_0x359005(0x27b)](0x0,Math[_0x359005(0x226)](_0x16810a[_0x359005(0x225)])-Math[_0x359005(0x226)](_0x350222[_0x359005(0x27a)])));});}return _0x43a542;});Promise[_0x2d3900(0x1c8)](_0x22e0af)[_0x2d3900(0x1b3)](async _0x4a05d1=>{var _0x536a2e=_0x2d3900;try{for(const _0x2afecd of _0x4a05d1){await _0x2afecd[_0x536a2e(0x235)]();}const _0x253d76=_0x5ed653[_0x536a2e(0x286)][_0x536a2e(0x267)](async _0x192754=>{var _0x27764f=_0x536a2e,_0x323bd1=await warehouse[_0x27764f(0x21b)]({'name':_0x27502b,'room':_0x192754[_0x27764f(0x1dc)]});if(_0x192754[_0x27764f(0x27a)]>0x0){var _0x5b1b7c=0x0;const _0x148679=_0x323bd1[_0x27764f(0x213)][_0x27764f(0x267)](_0x24d994=>{var _0x3e1c8f=_0x27764f;_0x24d994[_0x3e1c8f(0x1e0)]==_0x192754[_0x3e1c8f(0x1e0)]&&_0x24d994[_0x3e1c8f(0x1f6)]==_0x192754[_0x3e1c8f(0x1b4)]&&_0x24d994[_0x3e1c8f(0x1cc)]==_0x192754[_0x3e1c8f(0x1cc)]&&_0x24d994[_0x3e1c8f(0x23d)]==_0x192754[_0x3e1c8f(0x23d)]&&_0x24d994[_0x3e1c8f(0x1f5)]==_0x192754[_0x3e1c8f(0x1f5)]&&_0x24d994['invoice']==_0x192754['To_invoice']&&(typeof _0x192754[_0x3e1c8f(0x239)]==_0x3e1c8f(0x1e2)?(console[_0x3e1c8f(0x1cf)]('here2',_0x24d994['product_stock']+_0x3e1c8f(0x230)+_0x24d994[_0x3e1c8f(0x27c)]+_0x3e1c8f(0x20f)+Math[_0x3e1c8f(0x226)](_0x24d994[_0x3e1c8f(0x225)])+Math[_0x3e1c8f(0x226)](_0x192754[_0x3e1c8f(0x27a)])),_0x24d994[_0x3e1c8f(0x225)]=Math[_0x3e1c8f(0x226)](_0x24d994[_0x3e1c8f(0x225)])+Math[_0x3e1c8f(0x226)](_0x192754['to_quantity'])):_0x24d994['product_stock']=Math['abs'](_0x24d994[_0x3e1c8f(0x225)])+Math[_0x3e1c8f(0x226)](_0x192754[_0x3e1c8f(0x27a)]),_0x5b1b7c++);});_0x5b1b7c=='0'&&(_0x323bd1[_0x27764f(0x213)]=_0x323bd1[_0x27764f(0x213)][_0x27764f(0x204)]({'product_name':_0x192754['product_name'],'product_stock':_0x192754['to_quantity'],'bay':_0x192754[_0x27764f(0x1b4)],'product_code':_0x192754[_0x27764f(0x1ef)],'primary_code':_0x192754[_0x27764f(0x280)],'secondary_code':_0x192754[_0x27764f(0x20a)],'expiry_date':_0x192754[_0x27764f(0x1cc)],'production_date':_0x192754[_0x27764f(0x23d)],'maxProducts':_0x192754[_0x27764f(0x254)],'batch_code':_0x192754[_0x27764f(0x1f5)],'secondary_unit':_0x192754['secondary_unit'],'unit':_0x192754[_0x27764f(0x278)],'maxProducts':_0x192754[_0x27764f(0x254)],'maxPerUnit':_0x192754['maxPerUnit'],'invoice':_0x192754[_0x27764f(0x1c7)]}));}return _0x323bd1;});Promise[_0x536a2e(0x1c8)](_0x253d76)[_0x536a2e(0x1b3)](async _0x4c6bfe=>{var _0x5dd7a8=_0x536a2e;try{for(const _0x3c33c6 of _0x4c6bfe){await warehouse[_0x5dd7a8(0x217)]({'_id':_0x3c33c6[_0x5dd7a8(0x27c)]},{'$addToSet':{'product_details':{'$each':_0x3c33c6[_0x5dd7a8(0x213)]}}});}_0x5ed653[_0x5dd7a8(0x203)]=_0x5dd7a8(0x201);const _0x461e5d=await _0x5ed653[_0x5dd7a8(0x235)](),_0x46ce99=await master_shop[_0x5dd7a8(0x1fb)](),_0x2d9b47=await email_settings['findOne'](),_0x4d12a8=await supervisor_settings[_0x5dd7a8(0x1fb)]();var _0x3eaf0e=_0x5ed653[_0x5dd7a8(0x286)],_0x8539cf='',_0x5d02d4;for(_0x5d02d4 in _0x3eaf0e){var _0x27446f='FG';_0x5ed653['to_warehouse']==_0x5dd7a8(0x224)&&(_0x27446f='DG'),_0x8539cf+=_0x5dd7a8(0x220)+_0x5dd7a8(0x229)+_0x3eaf0e[_0x5d02d4]['product_name']+_0x5dd7a8(0x26b)+_0x5dd7a8(0x229)+_0x3eaf0e[_0x5d02d4]['product_code']+_0x5dd7a8(0x26b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3eaf0e[_0x5d02d4][_0x5dd7a8(0x27a)]+_0x5dd7a8(0x26b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3eaf0e[_0x5d02d4][_0x5dd7a8(0x278)]+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x3eaf0e[_0x5d02d4][_0x5dd7a8(0x237)]+_0x5dd7a8(0x26b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x5ed653[_0x5dd7a8(0x22d)]+_0x5dd7a8(0x26b)+_0x5dd7a8(0x229)+_0x3eaf0e[_0x5d02d4][_0x5dd7a8(0x1dc)]+_0x5dd7a8(0x26b)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x27446f+_0x3eaf0e[_0x5d02d4][_0x5dd7a8(0x1b4)]+_0x5dd7a8(0x26b)+_0x5dd7a8(0x255);}let _0x534c79=nodemailer[_0x5dd7a8(0x291)]({'host':_0x2d9b47['host'],'port':Number(_0x2d9b47[_0x5dd7a8(0x28e)]),'secure':![],'auth':{'user':_0x2d9b47[_0x5dd7a8(0x28d)],'pass':_0x2d9b47[_0x5dd7a8(0x20c)]}}),_0x58ef71={'from':_0x2d9b47['email'],'to':_0x4d12a8[0x0][_0x5dd7a8(0x252)],'subject':_0x5dd7a8(0x289),'attachments':[{'filename':_0x5dd7a8(0x256),'path':__dirname+_0x5dd7a8(0x231)+_0x5dd7a8(0x27d)+_0x46ce99[0x0][_0x5dd7a8(0x21a)],'cid':_0x5dd7a8(0x251)}],'html':_0x5dd7a8(0x281)+_0x5dd7a8(0x271)+'</head><body>'+_0x5dd7a8(0x262)+_0x5dd7a8(0x246)+'<div>'+_0x5dd7a8(0x1f0)+_0x5dd7a8(0x1c6)+_0x5dd7a8(0x262)+_0x5dd7a8(0x202)+_0x46ce99[0x0][_0x5dd7a8(0x23f)]+_0x5dd7a8(0x1f7)+_0x5dd7a8(0x1c6)+_0x5dd7a8(0x1c6)+'<hr\x20class=\x22my-3\x22>'+_0x5dd7a8(0x262)+_0x5dd7a8(0x1d0)+'\x20Order\x20Number\x20:\x20'+_0x5ed653['invoice']+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x5dd7a8(0x28c)+_0x5ed653['date']+'\x20'+_0x5dd7a8(0x1cd)+_0x5dd7a8(0x1c1)+_0x5dd7a8(0x1c6)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x5dd7a8(0x245)+_0x5dd7a8(0x220)+_0x5dd7a8(0x1b5)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x5dd7a8(0x258)+_0x5dd7a8(0x270)+_0x5dd7a8(0x1e5)+_0x5dd7a8(0x264)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>'+_0x5dd7a8(0x1ea)+_0x5dd7a8(0x255)+_0x5dd7a8(0x214)+_0x5dd7a8(0x257)+'\x20'+_0x8539cf+'\x20'+_0x5dd7a8(0x1d8)+_0x5dd7a8(0x1b9)+_0x5dd7a8(0x262)+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x46ce99[0x0][_0x5dd7a8(0x23f)]+_0x5dd7a8(0x1c1)+_0x5dd7a8(0x1c6)+_0x5dd7a8(0x1c6)+'</body></html>'};_0x534c79['sendMail'](_0x58ef71,function(_0x3fc253,_0x47b895){var _0x3ae909=_0x5dd7a8;_0x3fc253?(console['log'](_0x3fc253),console[_0x3ae909(0x1cf)](_0x3ae909(0x241))):console['log'](_0x3ae909(0x21d));}),_0x1d1188[_0x5dd7a8(0x27e)](_0x5dd7a8(0x233),_0x5dd7a8(0x242)),_0x1517d9[_0x5dd7a8(0x27f)](_0x5dd7a8(0x1f1)+_0x461e5d[_0x5dd7a8(0x27c)]);}catch(_0x1ca632){console[_0x5dd7a8(0x208)](_0x1ca632),_0x1517d9['status'](0x1f4)[_0x5dd7a8(0x261)]({'error':_0x5dd7a8(0x207)});}})[_0x536a2e(0x1f2)](_0x5d4f97=>{var _0x129de8=_0x536a2e;console[_0x129de8(0x208)](_0x5d4f97),_0x1517d9[_0x129de8(0x1d4)](0x1f4)[_0x129de8(0x261)]({'error':'An\x20error\x20occurred.'});});}catch(_0x5af7bb){console[_0x536a2e(0x208)](_0x5af7bb),_0x1517d9['status'](0x1f4)['json']({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})[_0x2d3900(0x1f2)](_0x302e0e=>{var _0x5c63a5=_0x2d3900;console[_0x5c63a5(0x208)](_0x302e0e),_0x1517d9[_0x5c63a5(0x1d4)](0x1f4)[_0x5c63a5(0x261)]({'error':'An\x20error\x20occurred.'});});}catch(_0x373de9){_0x1517d9[_0x2d3900(0x261)]({'message':_0x373de9[_0x2d3900(0x26d)]});}});function BayBinSelected(_0x26549d,_0x37076c){var _0x380e34=a0_0x24fdc6,_0x110fbe=[];let _0x444046=[];var _0x12e9b8=[];if(_0x26549d==_0x380e34(0x224)){switch(_0x37076c){case _0x380e34(0x274):_0x110fbe=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x380e34(0x232):_0x110fbe=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x12e9b8=['DG'];}else{if(_0x26549d==_0x380e34(0x272)){switch(_0x37076c){case'Rack\x201':_0x110fbe=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x380e34(0x232):_0x110fbe=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x12e9b8=['FG'];}}return{'levels':_0x110fbe,'identify':_0x12e9b8};}router['get'](a0_0x24fdc6(0x25f),auth,async(_0x3406ad,_0x533227)=>{var _0x23d4ab=a0_0x24fdc6;try{const {username:_0x5a33bc,email:_0x21e7a9,role:_0x1be118}=_0x3406ad['user'],_0x1a2f3e=_0x3406ad[_0x23d4ab(0x1bb)],_0x114672=await profile['findOne']({'email':_0x1a2f3e[_0x23d4ab(0x28d)]}),_0x1099e1=await master_shop[_0x23d4ab(0x1fb)](),_0xba72b4=await transfers_finished[_0x23d4ab(0x1dd)](_0x3406ad[_0x23d4ab(0x248)]['id']);let _0x4e0a96=new Date(_0xba72b4[_0x23d4ab(0x1cc)]),_0x18ae2e=('0'+_0x4e0a96[_0x23d4ab(0x1cb)]())[_0x23d4ab(0x21e)](-0x2),_0x1e9583=('0'+(_0x4e0a96['getMonth']()+0x1))['slice'](-0x2),_0x3737bc=_0x4e0a96[_0x23d4ab(0x26e)](),_0x4aca28=_0x3737bc+'-'+_0x1e9583+'-'+_0x18ae2e,_0x52c2b7;if(_0x1a2f3e[_0x23d4ab(0x285)]==_0x23d4ab(0x25e)){const _0x1cb5ae=await staff[_0x23d4ab(0x21b)]({'email':_0x1a2f3e['email']});_0x52c2b7=await warehouse[_0x23d4ab(0x1fb)]({'status':_0x23d4ab(0x1e1),'name':_0x1cb5ae['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x52c2b7=await warehouse[_0x23d4ab(0x1fb)]({'status':_0x23d4ab(0x1e1),'warehouse_category':'Finished\x20Goods'});const _0x103630=await warehouse[_0x23d4ab(0x266)]([{'$match':{'name':_0xba72b4[_0x23d4ab(0x1ca)],'room':_0xba72b4[_0x23d4ab(0x216)]}},{'$unwind':_0x23d4ab(0x1db)},{'$group':{'_id':_0x23d4ab(0x1b1),'name':{'$first':_0x23d4ab(0x26f)},'product_stock':{'$first':_0x23d4ab(0x24a)},'bay':{'$first':_0x23d4ab(0x1c9)},'bin':{'$first':_0x23d4ab(0x1d9)},'type':{'$first':_0x23d4ab(0x1f3)},'floorlevel':{'$first':_0x23d4ab(0x1fa)},'primary_code':{'$first':_0x23d4ab(0x23e)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x23d4ab(0x25d)},'rack':{'$first':_0x23d4ab(0x1d7)}}}]);var _0x4dd2b5=[0x1,0x2,0x3,0x4],_0x1250b8=['A','B','C','D','E','F','G','H','I','J'],_0x1b929d=[_0x23d4ab(0x1d6),_0x23d4ab(0x253)];const _0x840598=await product[_0x23d4ab(0x1fb)]({}),_0x545548=BayBinSelected(_0xba72b4[_0x23d4ab(0x22d)],_0xba72b4['to_room']);if(_0x1099e1[0x0][_0x23d4ab(0x1f9)]=='English\x20(US)'){var _0x205ade=users[_0x23d4ab(0x1ed)];console['log'](_0x205ade);}else{if(_0x1099e1[0x0][_0x23d4ab(0x1f9)]==_0x23d4ab(0x221))var _0x205ade=users[_0x23d4ab(0x221)];else{if(_0x1099e1[0x0][_0x23d4ab(0x1f9)]==_0x23d4ab(0x24b))var _0x205ade=users[_0x23d4ab(0x24b)];else{if(_0x1099e1[0x0]['language']==_0x23d4ab(0x1e3))var _0x205ade=users[_0x23d4ab(0x1e3)];else{if(_0x1099e1[0x0][_0x23d4ab(0x1f9)]==_0x23d4ab(0x205))var _0x205ade=users['French'];else{if(_0x1099e1[0x0]['language']==_0x23d4ab(0x20e))var _0x205ade=users[_0x23d4ab(0x284)];else{if(_0x1099e1[0x0][_0x23d4ab(0x1f9)]==_0x23d4ab(0x212))var _0x205ade=users['Chinese'];else{if(_0x1099e1[0x0]['language']==_0x23d4ab(0x26a))var _0x205ade=users['Arabic'];}}}}}}}_0x533227['render'](_0x23d4ab(0x236),{'success':_0x3406ad[_0x23d4ab(0x27e)](_0x23d4ab(0x233)),'errors':_0x3406ad[_0x23d4ab(0x27e)](_0x23d4ab(0x22f)),'role':_0x1a2f3e,'profile':_0x114672,'master_shop':_0x1099e1,'warehouse':_0x52c2b7,'transfer':_0xba72b4,'stock':_0x103630,'unit':_0x840598,'language':_0x205ade,'levels':_0x4dd2b5,'Isle':_0x1250b8,'rooms_data':_0x1b929d,'ed_fullDate':_0x4aca28,'dataSelected':_0x545548});}catch(_0x5dc525){console['log'](_0x5dc525);}}),router['post']('/view/:id',auth,async(_0x7b506,_0x52b90f)=>{var _0x3f8085=a0_0x24fdc6;try{const _0xad20cb=_0x7b506[_0x3f8085(0x248)]['id'];console[_0x3f8085(0x1cf)](_0x7b506[_0x3f8085(0x24e)]);const _0x2c583a=await transfers_finished[_0x3f8085(0x1dd)](_0xad20cb);console[_0x3f8085(0x1cf)](_0x3f8085(0x22c),_0x2c583a);const {date:_0x450382,from_warehouse:_0x479455,FromRoom_name:_0x9ed8d0,to_warehouse:_0x32a4cb,ToRoom_name:_0x357e07,prod_name:_0x290f5f,from_prod_qty:_0x556510,from_prod_level:_0x43730b,from_prod_isle:_0x47f1bf,from_prod_pallet:_0x58463d,to_prod_qty:_0x450339,to_prod_level:_0x4bcd24,to_prod_isle:_0x5a87d4,to_prod_pallet:_0x45dae9,primary_code:_0x3c423b,secondary_code:_0x5deac0,product_code3:_0x5ad192,note:_0x7a8252,invoice:_0x4bdff6,expiry_date:_0x1633c5}=_0x7b506[_0x3f8085(0x24e)];if(typeof _0x290f5f==_0x3f8085(0x1b8))var _0x35defc=[_0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x1fd)]],_0x40cb02=[_0x7b506['body']['from_prod_qty']],_0x36a971=[_0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x1ee)]],_0x245148=[_0x7b506['body'][_0x3f8085(0x1b2)]],_0x860107=[_0x7b506[_0x3f8085(0x24e)]['to_prod_level']],_0x172387=[_0x7b506[_0x3f8085(0x24e)]['primary_code']],_0x50ac0a=[_0x7b506['body']['secondary_code']],_0x1b2804=[_0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x283)]],_0x45e646=[_0x7b506[_0x3f8085(0x24e)]['MaxStocks_data2']],_0x1a7b53=[_0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x278)]],_0x20f2c9=[_0x7b506[_0x3f8085(0x24e)]['secondary_unit']],_0x4a60e2=[_0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x1f5)]],_0x120d41=[_0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x1cc)]];else var _0x35defc=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x1fd)]],_0x40cb02=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x275)]],_0x36a971=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x1ee)]],_0x245148=[..._0x7b506[_0x3f8085(0x24e)]['to_prod_qty']],_0x860107=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x22b)]],_0x172387=[..._0x7b506[_0x3f8085(0x24e)]['primary_code']],_0x50ac0a=[..._0x7b506['body'][_0x3f8085(0x20a)]],_0x1b2804=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x283)]],_0x45e646=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x290)]],_0x1a7b53=[..._0x7b506['body'][_0x3f8085(0x278)]],_0x20f2c9=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x237)]],_0x4a60e2=[..._0x7b506['body'][_0x3f8085(0x1f5)]],_0x120d41=[..._0x7b506[_0x3f8085(0x24e)][_0x3f8085(0x1cc)]];const _0x5d6399=_0x35defc[_0x3f8085(0x267)](_0x255440=>{return _0x255440={'product_name':_0x255440};});_0x40cb02['forEach']((_0x1e7849,_0x94628)=>{var _0x30865d=_0x3f8085;_0x5d6399[_0x94628][_0x30865d(0x1e6)]=_0x1e7849;}),_0x36a971['forEach']((_0x1adfb3,_0x2166f4)=>{_0x5d6399[_0x2166f4]['from_bay']=_0x1adfb3;}),_0x245148[_0x3f8085(0x206)]((_0x358b77,_0x19b5c)=>{var _0x3e63f8=_0x3f8085;_0x5d6399[_0x19b5c][_0x3e63f8(0x27a)]=_0x358b77;}),_0x860107[_0x3f8085(0x206)]((_0x28bbb4,_0x3b9420)=>{var _0xd9ec4f=_0x3f8085;_0x5d6399[_0x3b9420][_0xd9ec4f(0x1b4)]=_0x28bbb4;}),_0x172387[_0x3f8085(0x206)]((_0x1575dc,_0x511883)=>{_0x5d6399[_0x511883]['primary_code']=_0x1575dc;}),_0x50ac0a['forEach']((_0x23609f,_0x34c3ee)=>{var _0x395cd8=_0x3f8085;_0x5d6399[_0x34c3ee][_0x395cd8(0x20a)]=_0x23609f;}),_0x1b2804[_0x3f8085(0x206)]((_0x9b7a0e,_0x4ea41c)=>{var _0x572cef=_0x3f8085;_0x5d6399[_0x4ea41c][_0x572cef(0x1ef)]=_0x9b7a0e;}),_0x45e646[_0x3f8085(0x206)]((_0x31e61a,_0x4ac6d9)=>{var _0x3c8117=_0x3f8085;_0x5d6399[_0x4ac6d9][_0x3c8117(0x254)]=_0x31e61a;}),_0x1a7b53[_0x3f8085(0x206)]((_0x158850,_0x30f812)=>{var _0x11c4f0=_0x3f8085;_0x5d6399[_0x30f812][_0x11c4f0(0x278)]=_0x158850;}),_0x20f2c9[_0x3f8085(0x206)]((_0x1ccb33,_0x3031c4)=>{_0x5d6399[_0x3031c4]['secondary_unit']=_0x1ccb33;}),_0x4a60e2[_0x3f8085(0x206)]((_0x37583d,_0x262142)=>{_0x5d6399[_0x262142]['batch_code']=_0x37583d;}),_0x120d41[_0x3f8085(0x206)]((_0xfb82d3,_0x371b3b)=>{var _0x112985=_0x3f8085;_0x5d6399[_0x371b3b][_0x112985(0x1cc)]=_0xfb82d3;});const _0x200cda=_0x5d6399['filter'](_0x16a6ac=>_0x16a6ac[_0x3f8085(0x27a)]!=='0'&&_0x16a6ac['to_quantity']!==''||_0x16a6ac['to_floorlevel']!=='0'&&_0x16a6ac[_0x3f8085(0x1d3)]!=='');var _0x576434=0x0;_0x200cda[_0x3f8085(0x206)](_0x3f0614=>{var _0x526afc=_0x3f8085;parseInt(_0x3f0614[_0x526afc(0x1e6)])<parseInt(_0x3f0614[_0x526afc(0x27a)])&&_0x576434++;});if(_0x576434!=0x0)return _0x7b506[_0x3f8085(0x27e)](_0x3f8085(0x22f),_0x3f8085(0x1e7)),_0x52b90f['redirect']('back');const _0xdc3b93=await warehouse[_0x3f8085(0x21b)]({'name':_0x2c583a[_0x3f8085(0x1ca)],'room':_0x2c583a['from_room']});_0x2c583a[_0x3f8085(0x286)][_0x3f8085(0x206)](_0x4a997b=>{var _0x2a80a0=_0x3f8085;if(_0x4a997b['to_quantity']>0x0){const _0x1688a3=_0xdc3b93[_0x2a80a0(0x213)][_0x2a80a0(0x267)](_0x41c65d=>{var _0x3faee9=_0x2a80a0;_0x41c65d[_0x3faee9(0x1e0)]==_0x4a997b['product_name']&&_0x41c65d[_0x3faee9(0x1f6)]==_0x4a997b['from_bay']&&(_0x41c65d[_0x3faee9(0x225)]=parseInt(_0x41c65d[_0x3faee9(0x225)])+parseInt(_0x4a997b['to_quantity']));});}}),await _0xdc3b93[_0x3f8085(0x235)]();const _0x34e60d=await warehouse[_0x3f8085(0x21b)]({'name':_0x2c583a[_0x3f8085(0x22d)],'room':_0x2c583a['to_room']});_0x2c583a[_0x3f8085(0x286)][_0x3f8085(0x206)](_0xebc634=>{var _0x38fd23=_0x3f8085;if(_0xebc634['to_quantity']>0x0){const _0x29bc2c=_0x34e60d[_0x38fd23(0x213)][_0x38fd23(0x267)](_0x291df4=>{var _0x8e1c10=_0x38fd23;_0x291df4[_0x8e1c10(0x1e0)]==_0xebc634[_0x8e1c10(0x1e0)]&&_0x291df4[_0x8e1c10(0x1f6)]==_0xebc634[_0x8e1c10(0x1b4)]&&(_0x291df4[_0x8e1c10(0x225)]=parseInt(_0x291df4[_0x8e1c10(0x225)])-parseInt(_0xebc634[_0x8e1c10(0x27a)]));});}}),await _0x34e60d[_0x3f8085(0x235)](),_0x2c583a[_0x3f8085(0x219)]=_0x450382,_0x2c583a['from_warehouse']=_0x479455,_0x2c583a['to_warehouse']=_0x32a4cb,_0x2c583a['product']=_0x200cda,_0x2c583a[_0x3f8085(0x1eb)]=_0x7a8252,_0x2c583a['invoice']=_0x4bdff6;const _0x5dce0b=await _0x2c583a[_0x3f8085(0x235)](),_0x30925c=await warehouse[_0x3f8085(0x21b)]({'name':_0x479455,'room':_0x9ed8d0});_0x5dce0b[_0x3f8085(0x286)][_0x3f8085(0x206)](_0x4bb89f=>{var _0x4df2e0=_0x3f8085;if(_0x4bb89f[_0x4df2e0(0x27a)]>0x0){const _0x5e12ed=_0x30925c[_0x4df2e0(0x213)][_0x4df2e0(0x267)](_0x2f172a=>{var _0x553bc3=_0x4df2e0;_0x2f172a[_0x553bc3(0x1e0)]==_0x4bb89f[_0x553bc3(0x1e0)]&&_0x2f172a[_0x553bc3(0x1f6)]==_0x4bb89f[_0x553bc3(0x228)]&&(_0x2f172a['product_stock']=parseInt(_0x2f172a['product_stock'])-parseInt(_0x4bb89f[_0x553bc3(0x27a)]));});}}),await _0x30925c[_0x3f8085(0x235)]();const _0x1c393f=await warehouse[_0x3f8085(0x21b)]({'name':_0x32a4cb,'room':_0x357e07});_0x5dce0b[_0x3f8085(0x286)][_0x3f8085(0x206)](_0x2a9001=>{var _0x15d6c1=_0x3f8085;if(_0x2a9001[_0x15d6c1(0x27a)]>0x0){var _0x25b9c5=0x0;const _0x4cf349=_0x1c393f[_0x15d6c1(0x213)][_0x15d6c1(0x267)](_0x3eb3e1=>{var _0x105e20=_0x15d6c1;_0x3eb3e1[_0x105e20(0x1e0)]==_0x2a9001[_0x105e20(0x1e0)]&&_0x3eb3e1[_0x105e20(0x1f6)]==_0x2a9001[_0x105e20(0x1b4)]&&(_0x3eb3e1[_0x105e20(0x225)]=parseInt(_0x3eb3e1[_0x105e20(0x225)])+parseInt(_0x2a9001[_0x105e20(0x27a)]),_0x25b9c5++);});_0x25b9c5=='0'&&(_0x1c393f['product_details']=_0x1c393f[_0x15d6c1(0x213)]['concat']({'product_name':_0x2a9001[_0x15d6c1(0x1e0)],'product_stock':_0x2a9001[_0x15d6c1(0x27a)],'bay':_0x2a9001[_0x15d6c1(0x1b4)],'product_code':_0x2a9001[_0x15d6c1(0x1ef)],'primary_code':_0x2a9001['primary_code'],'secondary_code':_0x2a9001['secondary_code'],'maxProducts':_0x2a9001[_0x15d6c1(0x254)]}));}}),await _0x1c393f[_0x3f8085(0x235)](),_0x7b506[_0x3f8085(0x27e)](_0x3f8085(0x233),'Transfer\x20Edit\x20Successfully'),_0x52b90f[_0x3f8085(0x27f)](_0x3f8085(0x269));}catch(_0x4fb840){console['log'](_0x4fb840);}}),router[a0_0x24fdc6(0x259)]('/barcode_scanner',async(_0x15dd4b,_0x429485)=>{var _0x5439ff=a0_0x24fdc6;const {FromWareHouse:_0x3e1276,FromRoom:_0x4b5783,ToWarehouse:_0x10a9f8,ToRoom:_0x3de9ba,primary_code:_0x146d5c,Roomslist:_0xf67662}=_0x15dd4b[_0x5439ff(0x24e)],_0x3569a0=_0xf67662[_0x5439ff(0x223)](','),_0x3e6f8c=[];async function _0x53c4c6(_0x573865){var _0x253d00=_0x5439ff;const _0x3ddfa3=await warehouse['aggregate']([{'$match':{'name':_0x3e1276,'room':_0x573865}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x146d5c}},{'$group':{'_id':_0x253d00(0x1b1),'name':{'$first':_0x253d00(0x26f)},'instock':{'$first':_0x253d00(0x24a)},'primary_code':{'$first':_0x253d00(0x23e)},'secondary_code':{'$first':_0x253d00(0x28f)},'product_code':{'$first':_0x253d00(0x25a)},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x253d00(0x1d9)},'type':{'$first':_0x253d00(0x1f3)},'pallet':{'$first':_0x253d00(0x1fa)},'unit':{'$first':_0x253d00(0x20b)},'secondary_unit':{'$first':_0x253d00(0x243)},'storage':{'$first':_0x253d00(0x25d)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x253d00(0x26c)},'batch_code':{'$first':_0x253d00(0x210)},'maxPerUnit':{'$first':_0x253d00(0x1bd)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x253d00(0x23a)}}}]),_0x1614fa=await warehouse[_0x253d00(0x266)]([{'$match':{'name':_0x3e1276,'room':_0x573865}},{'$unwind':_0x253d00(0x1db)},{'$match':{'product_details.secondary_code':_0x146d5c}},{'$group':{'_id':_0x253d00(0x1b1),'name':{'$first':'$product_details.product_name'},'instock':{'$first':_0x253d00(0x24a)},'primary_code':{'$first':_0x253d00(0x23e)},'secondary_code':{'$first':_0x253d00(0x28f)},'product_code':{'$first':_0x253d00(0x25a)},'level':{'$first':_0x253d00(0x1c9)},'isle':{'$first':'$product_details.bin'},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x253d00(0x1fa)},'unit':{'$first':_0x253d00(0x20b)},'secondary_unit':{'$first':_0x253d00(0x243)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x253d00(0x1d7)},'expiry_date':{'$first':_0x253d00(0x268)},'production_date':{'$first':_0x253d00(0x26c)},'batch_code':{'$first':_0x253d00(0x210)},'maxPerUnit':{'$first':_0x253d00(0x1bd)},'roomNamed':{'$first':_0x253d00(0x218)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x253d00(0x23a)}}}]);if(_0x3ddfa3[_0x253d00(0x1f4)]>0x0)_0x3e6f8c[_0x253d00(0x1d1)](_0x3ddfa3);else _0x1614fa[_0x253d00(0x1f4)]>0x0&&_0x3e6f8c[_0x253d00(0x1d1)](_0x1614fa);}const _0x48728e=_0x3569a0[_0x5439ff(0x267)](_0x2ae16a=>_0x53c4c6(_0x2ae16a));await Promise[_0x5439ff(0x1c8)](_0x48728e),_0x429485['json'](_0x3e6f8c);}),router['post']('/barcode_scanner2',async(_0x50e9a3,_0x2e9961)=>{var _0xa2ec75=a0_0x24fdc6;try{const {FromWareHouse:_0x2e72fb,FromRoom:_0x55bfab,ToWarehouse:_0x3762ce,ToRoom:_0x1b38e9,secondary_code:_0x36f68a}=_0x50e9a3['body'],_0x26a8a0=await warehouse[_0xa2ec75(0x266)]([{'$match':{'name':_0x2e72fb}},{'$unwind':_0xa2ec75(0x1db)},{'$match':{'product_details.secondary_code':_0x36f68a}},{'$group':{'_id':_0xa2ec75(0x1b1),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0xa2ec75(0x23e)},'secondary_code':{'$first':_0xa2ec75(0x28f)},'product_code':{'$first':_0xa2ec75(0x25a)},'instock':{'$first':_0xa2ec75(0x24a)},'warehouse':{'$first':'$name'},'level':{'$first':_0xa2ec75(0x249)},'isle':{'$first':_0xa2ec75(0x1c0)},'pallet':{'$first':_0xa2ec75(0x1ec)},'maxProducts':{'$first':_0xa2ec75(0x23b)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':_0xa2ec75(0x268)},'production_date':{'$first':_0xa2ec75(0x26c)}}}]);_0x2e9961[_0xa2ec75(0x1d4)](0xc8)['json'](_0x26a8a0);}catch(_0x4884c4){_0x2e9961['status'](0x194)[_0xa2ec75(0x261)]({'message':_0x4884c4[_0xa2ec75(0x26d)]});}}),router['post'](a0_0x24fdc6(0x273),async(_0xd5dd11,_0x1a8860)=>{var _0x23e0f6=a0_0x24fdc6;try{const {FromWareHouse:_0x4cc575,FromRoom:_0x25d948,ToWarehouse:_0x3fbe00,ToRoom:_0x1eaaf8,product_code:_0x3c4958}=_0xd5dd11[_0x23e0f6(0x24e)],_0x566d95=await warehouse[_0x23e0f6(0x266)]([{'$match':{'name':_0x4cc575}},{'$unwind':_0x23e0f6(0x1db)},{'$match':{'product_details.product_code':_0x3c4958}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x23e0f6(0x26f)},'primary_code':{'$first':_0x23e0f6(0x23e)},'secondary_code':{'$first':_0x23e0f6(0x28f)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x23e0f6(0x23c)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x23e0f6(0x1c0)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x23e0f6(0x23b)},'unit':{'$first':_0x23e0f6(0x20b)}}}]);_0x1a8860['status'](0xc8)[_0x23e0f6(0x261)](_0x566d95);}catch(_0xc4cba4){_0x1a8860[_0x23e0f6(0x1d4)](0x194)[_0x23e0f6(0x261)]({'message':_0xc4cba4['message']});}}),router[a0_0x24fdc6(0x259)](a0_0x24fdc6(0x24d),async(_0x3e8d44,_0x2a9cae)=>{var _0xae164f=a0_0x24fdc6;const {productCode:_0x2978fd,bay:_0x2c3848,warehouses:_0x2fc23a,room:_0x42a69a}=_0x3e8d44[_0xae164f(0x24e)];console[_0xae164f(0x1cf)](_0x3e8d44[_0xae164f(0x24e)]);try{const _0xa70310=await warehouse[_0xae164f(0x266)]([{'$match':{'name':_0x2fc23a,'room':_0x42a69a}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x2c3848)}},{'$group':{'_id':_0xae164f(0x1b1),'name':{'$first':_0xae164f(0x26f)},'product_stock':{'$first':_0xae164f(0x24a)},'bay':{'$first':_0xae164f(0x1c9)},'maxProducts':{'$first':_0xae164f(0x23b)}}}]);_0x2a9cae[_0xae164f(0x1d4)](0xc8)[_0xae164f(0x261)](_0xa70310);}catch(_0xded291){_0x2a9cae[_0xae164f(0x1d4)](0x194)[_0xae164f(0x261)]({'message':_0xded291[_0xae164f(0x26d)]});}}),module[a0_0x24fdc6(0x24f)]=router;