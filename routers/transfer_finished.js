var a0_0x2c1e02=a0_0x2c0b;(function(_0x2644d8,_0x494ea7){var _0x31dcdb=a0_0x2c0b,_0x485530=_0x2644d8();while(!![]){try{var _0x2d5f23=parseInt(_0x31dcdb(0x14e))/0x1*(parseInt(_0x31dcdb(0x19d))/0x2)+-parseInt(_0x31dcdb(0x199))/0x3+parseInt(_0x31dcdb(0x13c))/0x4+parseInt(_0x31dcdb(0x13d))/0x5+-parseInt(_0x31dcdb(0x106))/0x6*(parseInt(_0x31dcdb(0x112))/0x7)+parseInt(_0x31dcdb(0x124))/0x8*(parseInt(_0x31dcdb(0x114))/0x9)+-parseInt(_0x31dcdb(0x11f))/0xa*(parseInt(_0x31dcdb(0x12b))/0xb);if(_0x2d5f23===_0x494ea7)break;else _0x485530['push'](_0x485530['shift']());}catch(_0xec3d63){_0x485530['push'](_0x485530['shift']());}}}(a0_0x23ed,0xb0fd4));const express=require(a0_0x2c1e02(0x13b)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require(a0_0x2c1e02(0x1ca)),auth=require(a0_0x2c1e02(0x1a4)),users=require(a0_0x2c1e02(0x1df)),nodemailer=require(a0_0x2c1e02(0x1a5));function a0_0x2c0b(_0x44e02e,_0x1ce1ec){var _0x23ed8a=a0_0x23ed();return a0_0x2c0b=function(_0x2c0b24,_0x3764e4){_0x2c0b24=_0x2c0b24-0x106;var _0x2b599f=_0x23ed8a[_0x2c0b24];return _0x2b599f;},a0_0x2c0b(_0x44e02e,_0x1ce1ec);}router[a0_0x2c1e02(0x18b)](a0_0x2c1e02(0x17d),auth,async(_0x2f89f0,_0x2f1080)=>{var _0x3759c6=a0_0x2c1e02;try{const {username:_0x168473,email:_0x350c13,role:_0x43674b}=_0x2f89f0['user'],_0x4df87f=_0x2f89f0['user'],_0x2c1bc6=await profile[_0x3759c6(0x12e)]({'email':_0x4df87f[_0x3759c6(0x1a2)]}),_0x356b98=await master_shop['find']();let _0x271e67;if(_0x4df87f[_0x3759c6(0x1cb)]==_0x3759c6(0x15c)){const _0x1cb0a5=await staff['findOne']({'email':_0x4df87f[_0x3759c6(0x1a2)]});_0x271e67=await transfers_finished[_0x3759c6(0x15e)]({'from_warehouse':_0x1cb0a5[_0x3759c6(0x10b)]});}else _0x271e67=await transfers_finished[_0x3759c6(0x1db)]([{'$unwind':_0x3759c6(0x190)},{'$group':{'_id':_0x3759c6(0x143),'invoice':{'$first':_0x3759c6(0x11a)},'date':{'$first':_0x3759c6(0x1bf)},'from_warehouse':{'$first':_0x3759c6(0x160)},'to_warehouse':{'$first':'$to_warehouse'},'from_room_name':{'$addToSet':_0x3759c6(0x17b)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x3759c6(0x134)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x356b98[0x0]['language']==_0x3759c6(0x135))var _0x47aece=users[_0x3759c6(0x1c9)];else{if(_0x356b98[0x0][_0x3759c6(0x152)]==_0x3759c6(0x1b9))var _0x47aece=users[_0x3759c6(0x1b9)];else{if(_0x356b98[0x0][_0x3759c6(0x152)]==_0x3759c6(0x1b5))var _0x47aece=users[_0x3759c6(0x1b5)];else{if(_0x356b98[0x0][_0x3759c6(0x152)]==_0x3759c6(0x1a0))var _0x47aece=users['Spanish'];else{if(_0x356b98[0x0][_0x3759c6(0x152)]=='French')var _0x47aece=users[_0x3759c6(0x191)];else{if(_0x356b98[0x0][_0x3759c6(0x152)]==_0x3759c6(0x1dd))var _0x47aece=users[_0x3759c6(0x1c5)];else{if(_0x356b98[0x0][_0x3759c6(0x152)]==_0x3759c6(0x157))var _0x47aece=users[_0x3759c6(0x157)];else{if(_0x356b98[0x0][_0x3759c6(0x152)]==_0x3759c6(0x150))var _0x47aece=users[_0x3759c6(0x148)];}}}}}}}_0x2f1080['render']('transfer_finished',{'success':_0x2f89f0[_0x3759c6(0x163)](_0x3759c6(0x155)),'errors':_0x2f89f0[_0x3759c6(0x163)](_0x3759c6(0x126)),'role':_0x4df87f,'profile':_0x2c1bc6,'master_shop':_0x356b98,'transfer':_0x271e67,'language':_0x47aece});}catch(_0x493ade){console['log'](_0x493ade);}});async function getRandom8DigitNumber(){var _0x3e3196=a0_0x2c1e02;const _0x3da667=0x989680,_0x5d6568=0x5f5e0ff,_0x561b79=Math[_0x3e3196(0x116)](Math[_0x3e3196(0x1d0)]()*(_0x5d6568-_0x3da667+0x1))+_0x3da667;var _0x5f0590;const _0x34508c=await transfers_finished[_0x3e3196(0x12e)]({'invoice':'TRFF-'+_0x561b79});return _0x34508c&&_0x34508c[_0x3e3196(0x142)]>0x0?_0x5f0590=_0x3e3196(0x1e6)+_0x561b79:_0x5f0590=_0x3e3196(0x1e6)+_0x561b79,_0x5f0590;}router['get'](a0_0x2c1e02(0x15b),auth,async(_0x56013b,_0x28c7c2)=>{var _0x1aaf81=a0_0x2c1e02;try{const {username:_0x3b568e,email:_0x5eac9d,role:_0x201200}=_0x56013b[_0x1aaf81(0x110)],_0x45b18c=_0x56013b[_0x1aaf81(0x110)],_0xe089f3=await profile[_0x1aaf81(0x12e)]({'email':_0x45b18c[_0x1aaf81(0x1a2)]}),_0x352f5e=await master_shop[_0x1aaf81(0x15e)]();let _0x32317c;if(_0x45b18c[_0x1aaf81(0x1cb)]==_0x1aaf81(0x15c)){const _0x4f0b93=await staff[_0x1aaf81(0x12e)]({'email':_0x45b18c['email']});_0x32317c=await warehouse[_0x1aaf81(0x1db)]([{'$match':{'status':_0x1aaf81(0x108),'name':_0x4f0b93[_0x1aaf81(0x10b)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x1aaf81(0x1bb)}}},{'$group':{'_id':_0x1aaf81(0x1c4),'name':{'$first':_0x1aaf81(0x1c4)}}}]);}else _0x32317c=await warehouse['aggregate']([{'$match':{'status':_0x1aaf81(0x108),'warehouse_category':_0x1aaf81(0x153),'name':{'$ne':_0x1aaf81(0x1bb)}}},{'$group':{'_id':_0x1aaf81(0x1c4),'name':{'$first':_0x1aaf81(0x1c4)}}}]);const _0x53bb44=await transfers_finished[_0x1aaf81(0x15e)]({}),_0x3013a5=_0x53bb44[_0x1aaf81(0x142)]+0x1,_0x438652=_0x1aaf81(0x1e6)+_0x3013a5[_0x1aaf81(0x11c)]()[_0x1aaf81(0x144)](0x5,'0');if(_0x352f5e[0x0][_0x1aaf81(0x152)]=='English\x20(US)')var _0x3b8e70=users[_0x1aaf81(0x1c9)];else{if(_0x352f5e[0x0][_0x1aaf81(0x152)]==_0x1aaf81(0x1b9))var _0x3b8e70=users['Hindi'];else{if(_0x352f5e[0x0][_0x1aaf81(0x152)]==_0x1aaf81(0x1b5))var _0x3b8e70=users[_0x1aaf81(0x1b5)];else{if(_0x352f5e[0x0]['language']=='Spanish')var _0x3b8e70=users['Spanish'];else{if(_0x352f5e[0x0][_0x1aaf81(0x152)]==_0x1aaf81(0x191))var _0x3b8e70=users['French'];else{if(_0x352f5e[0x0][_0x1aaf81(0x152)]=='Portuguese\x20(BR)')var _0x3b8e70=users['Portuguese'];else{if(_0x352f5e[0x0][_0x1aaf81(0x152)]==_0x1aaf81(0x157))var _0x3b8e70=users[_0x1aaf81(0x157)];else{if(_0x352f5e[0x0][_0x1aaf81(0x152)]=='Arabic\x20(ae)')var _0x3b8e70=users['Arabic'];}}}}}}}const _0x1e3a45=getRandom8DigitNumber();_0x1e3a45[_0x1aaf81(0x118)](_0x3cd0d2=>{var _0x14d2f3=_0x1aaf81;_0x28c7c2[_0x14d2f3(0x1af)](_0x14d2f3(0x1d6),{'success':_0x56013b[_0x14d2f3(0x163)](_0x14d2f3(0x155)),'errors':_0x56013b[_0x14d2f3(0x163)]('errors'),'role':_0x45b18c,'profile':_0xe089f3,'master_shop':_0x352f5e,'warehouse':_0x32317c,'language':_0x3b8e70,'invoice':_0x3cd0d2});})[_0x1aaf81(0x1bc)](_0x47b553=>{var _0x48bd0e=_0x1aaf81;_0x56013b[_0x48bd0e(0x163)](_0x48bd0e(0x126),_0x48bd0e(0x1cf)),_0x28c7c2[_0x48bd0e(0x1ae)]('/transfer/view');});}catch(_0xc6cce){console[_0x1aaf81(0x139)](_0xc6cce);}}),router['post']('/view/add_transfer',auth,async(_0x48cee9,_0x208363)=>{var _0x1805d9=a0_0x2c1e02;try{const {date:_0x3690d9,from_warehouse:_0x5ec7ff,FromRoom_name:_0x56bb1a,to_warehouse:_0x22419f,ToRoom_name:_0xbe867,prod_name:_0x2eeb58,from_prod_qty:_0x1f6274,from_prod_level:_0x489dc8,from_prod_isle:_0x1b4bdc,from_prod_pallet:_0x2b2dc4,to_prod_qty:_0x972345,to_prod_level:_0x483e6e,to_prod_isle:_0x57f80c,to_prod_pallet:_0x4e8454,primary_code:_0x39a1b2,secondary_code:_0x57f974,product_code3:_0x3b5c63,note:_0x14af83,MaxStocks_data2:_0x56096a,invoice:_0x1e9328,expiry_date:_0x448a65}=_0x48cee9[_0x1805d9(0x1a6)];if(typeof _0x2eeb58==_0x1805d9(0x17e))var _0x183118=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1a9)]],_0x5accaf=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x193)]],_0x4880e6=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x11e)]],_0x15b8c9=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x198)]],_0xbf98d2=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x19f)]],_0x5cdd04=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1e9)]],_0x91ed4a=[_0x48cee9[_0x1805d9(0x1a6)]['secondary_code']],_0x4344af=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x14a)]],_0x5dbc18=[_0x48cee9[_0x1805d9(0x1a6)]['MaxStocks_data2']],_0x324318=[_0x48cee9['body']['primary_unit']],_0x15d824=[_0x48cee9['body'][_0x1805d9(0x12c)]],_0x4aa79a=[_0x48cee9['body'][_0x1805d9(0x181)]],_0x3e17f0=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1e1)]],_0x18111c=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1ac)]],_0x5358d0=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x132)]],_0x3304e1=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x117)]],_0x5de9b9=[_0x48cee9[_0x1805d9(0x1a6)]['prod_cat']],_0x1829cb=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1b8)]],_0x332b67=[_0x48cee9['body']['ToRoomAssigned']],_0x1859d=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x119)]],_0x1916ac=[_0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x174)]],_0x369be7=[_0x48cee9[_0x1805d9(0x1a6)]['id_transaction']];else var _0x183118=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1a9)]],_0x5accaf=[..._0x48cee9['body'][_0x1805d9(0x193)]],_0x4880e6=[..._0x48cee9[_0x1805d9(0x1a6)]['from_prod_level']],_0x15b8c9=[..._0x48cee9['body'][_0x1805d9(0x198)]],_0xbf98d2=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x19f)]],_0x5cdd04=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1e9)]],_0x91ed4a=[..._0x48cee9[_0x1805d9(0x1a6)]['secondary_code']],_0x4344af=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x14a)]],_0x5dbc18=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x12d)]],_0x324318=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x13f)]],_0x15d824=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x12c)]],_0x4aa79a=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x181)]],_0x3e17f0=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1e1)]],_0x18111c=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1ac)]],_0x5358d0=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x132)]],_0x3304e1=[..._0x48cee9['body'][_0x1805d9(0x117)]],_0x5de9b9=[..._0x48cee9['body']['prod_cat']],_0x1829cb=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1b8)]],_0x332b67=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x128)]],_0x1859d=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x119)]],_0x1916ac=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x174)]],_0x369be7=[..._0x48cee9[_0x1805d9(0x1a6)][_0x1805d9(0x1a7)]];const _0x3ff3b7=_0x183118[_0x1805d9(0x1d9)](_0x479bf5=>{return _0x479bf5={'product_name':_0x479bf5};});_0x5accaf['forEach']((_0x59f1a4,_0x1328f2)=>{var _0x502e46=_0x1805d9;_0x3ff3b7[_0x1328f2][_0x502e46(0x138)]=_0x59f1a4;}),_0x4880e6[_0x1805d9(0x1ab)]((_0x294f36,_0x2be7b7)=>{var _0x44a68f=_0x1805d9;_0x3ff3b7[_0x2be7b7][_0x44a68f(0x184)]=_0x294f36;}),_0x369be7[_0x1805d9(0x1ab)]((_0x25ae47,_0x533a8a)=>{var _0x1f6a20=_0x1805d9;_0x3ff3b7[_0x533a8a][_0x1f6a20(0x1a7)]=_0x25ae47;}),_0x1859d['forEach']((_0x4c1d34,_0xa85aac)=>{_0x3ff3b7[_0xa85aac]['from_invoice']=_0x4c1d34;}),_0x1916ac[_0x1805d9(0x1ab)]((_0x825c86,_0x4978bb)=>{var _0x2364fc=_0x1805d9;_0x3ff3b7[_0x4978bb][_0x2364fc(0x1ba)]=_0x825c86;}),_0x15b8c9[_0x1805d9(0x1ab)]((_0x510d72,_0x4e4800)=>{_0x3ff3b7[_0x4e4800]['to_quantity']=_0x510d72;}),_0xbf98d2[_0x1805d9(0x1ab)]((_0x2ecd6f,_0x3a6d69)=>{var _0x165867=_0x1805d9;_0x3ff3b7[_0x3a6d69][_0x165867(0x192)]=_0x2ecd6f;}),_0x5cdd04[_0x1805d9(0x1ab)]((_0x1ab80f,_0x545cb1)=>{var _0x2dca77=_0x1805d9;_0x3ff3b7[_0x545cb1][_0x2dca77(0x1e9)]=_0x1ab80f;}),_0x91ed4a[_0x1805d9(0x1ab)]((_0x360a1a,_0x57adbb)=>{var _0x130a2b=_0x1805d9;_0x3ff3b7[_0x57adbb][_0x130a2b(0x1ad)]=_0x360a1a;}),_0x4344af[_0x1805d9(0x1ab)]((_0x41900a,_0x4c00d1)=>{var _0x2808a7=_0x1805d9;_0x3ff3b7[_0x4c00d1][_0x2808a7(0x189)]=_0x41900a;}),_0x5dbc18[_0x1805d9(0x1ab)]((_0xb2d677,_0xb20df0)=>{var _0x3c22af=_0x1805d9;_0x3ff3b7[_0xb20df0][_0x3c22af(0x122)]=_0xb2d677;}),_0x324318[_0x1805d9(0x1ab)]((_0x1e1f12,_0x4f044d)=>{var _0x59b75c=_0x1805d9;_0x3ff3b7[_0x4f044d][_0x59b75c(0x168)]=_0x1e1f12;}),_0x15d824[_0x1805d9(0x1ab)]((_0x26b74a,_0x5a4dca)=>{var _0x3ab467=_0x1805d9;_0x3ff3b7[_0x5a4dca][_0x3ab467(0x12c)]=_0x26b74a;}),_0x4aa79a[_0x1805d9(0x1ab)]((_0x4d79e2,_0x5ed359)=>{var _0x33fa0a=_0x1805d9;_0x3ff3b7[_0x5ed359][_0x33fa0a(0x181)]=_0x4d79e2;}),_0x3e17f0[_0x1805d9(0x1ab)]((_0x1cebb4,_0x33c7f0)=>{_0x3ff3b7[_0x33c7f0]['expiry_date']=_0x1cebb4;}),_0x18111c[_0x1805d9(0x1ab)]((_0x18ffc9,_0x58f1eb)=>{var _0x4d81f8=_0x1805d9;_0x3ff3b7[_0x58f1eb][_0x4d81f8(0x129)]=_0x18ffc9;}),_0x5358d0['forEach']((_0xe4f37a,_0x30be57)=>{var _0x19d0fb=_0x1805d9;_0x3ff3b7[_0x30be57][_0x19d0fb(0x122)]=_0xe4f37a;}),_0x3304e1[_0x1805d9(0x1ab)]((_0x1c14ba,_0x136cde)=>{var _0x21978f=_0x1805d9;_0x3ff3b7[_0x136cde][_0x21978f(0x117)]=_0x1c14ba;}),_0x5de9b9[_0x1805d9(0x1ab)]((_0x5b9830,_0x2480d8)=>{_0x3ff3b7[_0x2480d8]['prod_cat']=_0x5b9830;}),_0x1829cb['forEach']((_0x2d62bf,_0x3be128)=>{_0x3ff3b7[_0x3be128]['from_room_name']=_0x2d62bf;}),_0x332b67[_0x1805d9(0x1ab)]((_0x7bbd21,_0x94dfd8)=>{var _0x1f8083=_0x1805d9;_0x3ff3b7[_0x94dfd8][_0x1f8083(0x17a)]=_0x7bbd21;});const _0x59fc7e=_0x3ff3b7[_0x1805d9(0x158)](_0x78be5c=>_0x78be5c[_0x1805d9(0x125)]!=='0'&&_0x78be5c['to_quantity']!==''||_0x78be5c[_0x1805d9(0x16b)]!=='0'&&_0x78be5c[_0x1805d9(0x16b)]!=='');var _0x133c57=0x0;_0x59fc7e[_0x1805d9(0x1ab)](_0x3b1833=>{var _0x389f27=_0x1805d9;parseInt(_0x3b1833[_0x389f27(0x138)])<parseInt(_0x3b1833[_0x389f27(0x125)])&&_0x133c57++;});if(_0x133c57!=0x0)return _0x48cee9[_0x1805d9(0x163)]('errors',_0x1805d9(0x1aa)),_0x208363[_0x1805d9(0x1ae)](_0x1805d9(0x170));const _0x56b061=new transfers_finished({'date':_0x3690d9,'from_warehouse':_0x5ec7ff,'to_warehouse':_0x22419f,'product':_0x59fc7e,'note':_0x14af83,'invoice':_0x1e9328}),_0x4b73a6=await _0x56b061['save']();_0x48cee9['flash'](_0x1805d9(0x155),'Product\x20Transfer\x20successfully'),_0x208363[_0x1805d9(0x1ae)](_0x1805d9(0x1da)+_0x4b73a6[_0x1805d9(0x141)]);}catch(_0x1a02f8){console[_0x1805d9(0x139)](_0x1a02f8),_0x208363[_0x1805d9(0x149)](0xc8)[_0x1805d9(0x1a3)]({'errorMessage':_0x1a02f8[_0x1805d9(0x162)]});}}),router['get'](a0_0x2c1e02(0x1a1),auth,async(_0x5a14ff,_0x4694bf)=>{var _0x56c8ae=a0_0x2c1e02;try{const {username:_0x352df9,email:_0x18595b,role:_0x22dd64}=_0x5a14ff['user'],_0x2541fb=_0x5a14ff[_0x56c8ae(0x110)],_0x37ea7d=await profile[_0x56c8ae(0x12e)]({'email':_0x2541fb[_0x56c8ae(0x1a2)]}),_0x4205d2=await master_shop[_0x56c8ae(0x15e)](),_0xe27dbd=await transfers_finished['findById'](_0x5a14ff[_0x56c8ae(0x113)]['id']);let _0x13a4c7;if(_0x2541fb['role']==_0x56c8ae(0x15c)){const _0x4418d2=await staff[_0x56c8ae(0x12e)]({'email':_0x2541fb[_0x56c8ae(0x1a2)]});_0x13a4c7=await warehouse[_0x56c8ae(0x15e)]({'status':_0x56c8ae(0x108),'name':_0x4418d2['warehouse'],'warehouse_category':'Finished\x20Goods'});}else _0x13a4c7=await warehouse[_0x56c8ae(0x15e)]({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x4463cd=await warehouse[_0x56c8ae(0x1db)]([{'$match':{'name':_0xe27dbd['from_warehouse'],'warehouse_category':_0x56c8ae(0x153)}},{'$unwind':'$product_details'},{'$group':{'_id':_0x56c8ae(0x1cd),'name':{'$first':_0x56c8ae(0x176)},'product_stock':{'$first':_0x56c8ae(0x1b3)},'bay':{'$first':_0x56c8ae(0x183)},'bin':{'$first':_0x56c8ae(0x1d7)},'type':{'$first':_0x56c8ae(0x111)},'floorlevel':{'$first':_0x56c8ae(0x15d)},'primary_code':{'$first':_0x56c8ae(0x1b1)},'secondary_code':{'$first':_0x56c8ae(0x120)},'product_code':{'$first':_0x56c8ae(0x121)},'storage':{'$first':_0x56c8ae(0x19b)},'rack':{'$first':_0x56c8ae(0x197)},'expiry_date':{'$first':_0x56c8ae(0x185)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'},'warehoue_name':{'$first':'$name'}}}]),_0x275006=await product[_0x56c8ae(0x15e)]({});if(_0x4205d2[0x0][_0x56c8ae(0x152)]=='English\x20(US)'){var _0x2fc086=users[_0x56c8ae(0x1c9)];console[_0x56c8ae(0x139)](_0x2fc086);}else{if(_0x4205d2[0x0]['language']=='Hindi')var _0x2fc086=users['Hindi'];else{if(_0x4205d2[0x0]['language']==_0x56c8ae(0x1b5))var _0x2fc086=users['German'];else{if(_0x4205d2[0x0][_0x56c8ae(0x152)]==_0x56c8ae(0x1a0))var _0x2fc086=users[_0x56c8ae(0x1a0)];else{if(_0x4205d2[0x0]['language']=='French')var _0x2fc086=users[_0x56c8ae(0x191)];else{if(_0x4205d2[0x0][_0x56c8ae(0x152)]==_0x56c8ae(0x1dd))var _0x2fc086=users[_0x56c8ae(0x1c5)];else{if(_0x4205d2[0x0]['language']==_0x56c8ae(0x157))var _0x2fc086=users['Chinese'];else{if(_0x4205d2[0x0]['language']=='Arabic\x20(ae)')var _0x2fc086=users[_0x56c8ae(0x148)];}}}}}}}_0x4694bf['render'](_0x56c8ae(0x1c1),{'success':_0x5a14ff[_0x56c8ae(0x163)](_0x56c8ae(0x155)),'errors':_0x5a14ff[_0x56c8ae(0x163)]('errors'),'role':_0x2541fb,'profile':_0x37ea7d,'master_shop':_0x4205d2,'warehouse':_0x13a4c7,'transfer':_0xe27dbd,'stock':_0x4463cd,'unit':_0x275006,'language':_0x2fc086});}catch(_0x573381){console[_0x56c8ae(0x139)](_0x573381);}}),router[a0_0x2c1e02(0x1c0)](a0_0x2c1e02(0x1a1),auth,async(_0x1e7dbf,_0x1f9ca6)=>{var _0x1709d2=a0_0x2c1e02;try{const {invoice:_0x275bd8,from_warehouse:_0x1e0e26,FromRoom_name:_0x54158e,to_warehouse:_0x49d087,ToRoom_name:_0x98dd70}=_0x1e7dbf[_0x1709d2(0x1a6)],_0x2b94f1=await transfers_finished[_0x1709d2(0x1e3)](_0x1e7dbf[_0x1709d2(0x113)]['id']),_0x1c2de4=_0x2b94f1[_0x1709d2(0x18e)][_0x1709d2(0x1d9)](async _0x357a49=>{var _0x514597=_0x1709d2;if(_0x357a49['to_quantity']>0x0){var _0x13bfc5=await warehouse[_0x514597(0x12e)]({'name':_0x1e0e26,'room':_0x357a49[_0x514597(0x167)],'warehouse_category':_0x514597(0x153)});const _0x42d471=_0x13bfc5['product_details']['map'](_0x1b7e50=>{var _0x51d52d=_0x514597;_0x1b7e50[_0x51d52d(0x14d)]==_0x357a49['product_name']&&_0x1b7e50[_0x51d52d(0x12a)]==_0x357a49['from_bay']&&_0x1b7e50[_0x51d52d(0x1e1)]==_0x357a49[_0x51d52d(0x1e1)]&&_0x1b7e50[_0x51d52d(0x129)]==_0x357a49[_0x51d52d(0x129)]&&_0x1b7e50['batch_code']==_0x357a49[_0x51d52d(0x181)]&&_0x1b7e50[_0x51d52d(0x171)]==_0x357a49['from_invoice']&&(console['log'](_0x51d52d(0x115),_0x1b7e50[_0x51d52d(0x196)]),typeof _0x357a49[_0x51d52d(0x1a7)]=='undefined'?_0x1b7e50['product_stock']=Math[_0x51d52d(0x12f)](0x0,Math[_0x51d52d(0x1e8)](_0x1b7e50[_0x51d52d(0x196)])-Math['abs'](_0x357a49[_0x51d52d(0x125)])):_0x1b7e50['product_stock']=Math[_0x51d52d(0x12f)](0x0,Math[_0x51d52d(0x1e8)](_0x1b7e50[_0x51d52d(0x196)])-Math['abs'](_0x357a49[_0x51d52d(0x125)])));});}return _0x13bfc5;});Promise[_0x1709d2(0x159)](_0x1c2de4)[_0x1709d2(0x118)](async _0x5789ba=>{var _0x5a7a2b=_0x1709d2;try{for(const _0x354b99 of _0x5789ba){await _0x354b99['save']();}const _0x5ba39e=_0x2b94f1[_0x5a7a2b(0x18e)][_0x5a7a2b(0x1d9)](async _0xa2ee1e=>{var _0x4e4713=_0x5a7a2b,_0x25261d=await warehouse[_0x4e4713(0x12e)]({'name':_0x49d087,'room':_0xa2ee1e[_0x4e4713(0x17a)]});if(_0xa2ee1e['to_quantity']>0x0){var _0x393d81=0x0;const _0x23ff39=_0x25261d[_0x4e4713(0x107)][_0x4e4713(0x1d9)](_0x410271=>{var _0xc126be=_0x4e4713;_0x410271[_0xc126be(0x14d)]==_0xa2ee1e['product_name']&&_0x410271[_0xc126be(0x12a)]==_0xa2ee1e[_0xc126be(0x192)]&&_0x410271[_0xc126be(0x1e1)]==_0xa2ee1e[_0xc126be(0x1e1)]&&_0x410271[_0xc126be(0x129)]==_0xa2ee1e['production_date']&&_0x410271['batch_code']==_0xa2ee1e[_0xc126be(0x181)]&&_0x410271[_0xc126be(0x171)]==_0xa2ee1e[_0xc126be(0x1ba)]&&(typeof _0xa2ee1e[_0xc126be(0x1a7)]==_0xc126be(0x1bd)?(console[_0xc126be(0x139)]('here2',_0x410271[_0xc126be(0x196)]+_0xc126be(0x1dc)+_0x410271[_0xc126be(0x141)]+'\x20<=>\x20'+Math[_0xc126be(0x1e8)](_0x410271[_0xc126be(0x196)])+Math[_0xc126be(0x1e8)](_0xa2ee1e['to_quantity'])),_0x410271[_0xc126be(0x196)]=Math[_0xc126be(0x1e8)](_0x410271['product_stock'])+Math[_0xc126be(0x1e8)](_0xa2ee1e[_0xc126be(0x125)])):_0x410271['product_stock']=Math[_0xc126be(0x1e8)](_0x410271['product_stock'])+Math[_0xc126be(0x1e8)](_0xa2ee1e[_0xc126be(0x125)]),_0x393d81++);});_0x393d81=='0'&&(_0x25261d[_0x4e4713(0x107)]=_0x25261d[_0x4e4713(0x107)][_0x4e4713(0x186)]({'product_name':_0xa2ee1e[_0x4e4713(0x14d)],'product_stock':_0xa2ee1e[_0x4e4713(0x125)],'bay':_0xa2ee1e[_0x4e4713(0x192)],'product_code':_0xa2ee1e[_0x4e4713(0x189)],'primary_code':_0xa2ee1e[_0x4e4713(0x1e9)],'secondary_code':_0xa2ee1e[_0x4e4713(0x1ad)],'expiry_date':_0xa2ee1e[_0x4e4713(0x1e1)],'production_date':_0xa2ee1e['production_date'],'maxProducts':_0xa2ee1e[_0x4e4713(0x122)],'batch_code':_0xa2ee1e[_0x4e4713(0x181)],'secondary_unit':_0xa2ee1e[_0x4e4713(0x12c)],'unit':_0xa2ee1e['unit'],'maxProducts':_0xa2ee1e[_0x4e4713(0x122)],'maxPerUnit':_0xa2ee1e['maxPerUnit'],'invoice':_0xa2ee1e[_0x4e4713(0x1ba)]}));}return _0x25261d;});Promise[_0x5a7a2b(0x159)](_0x5ba39e)[_0x5a7a2b(0x118)](async _0x3da9ba=>{var _0x2307f2=_0x5a7a2b;try{for(const _0x2a8895 of _0x3da9ba){await warehouse[_0x2307f2(0x1d5)]({'_id':_0x2a8895[_0x2307f2(0x141)]},{'$addToSet':{'product_details':{'$each':_0x2a8895[_0x2307f2(0x107)]}}});}_0x2b94f1['finalize']=_0x2307f2(0x16e);const _0x177e2c=await _0x2b94f1[_0x2307f2(0x1d2)](),_0x15df15=await master_shop[_0x2307f2(0x15e)](),_0x566370=await email_settings['findOne'](),_0xa58fae=await supervisor_settings[_0x2307f2(0x15e)]();var _0x269b34=_0x2b94f1[_0x2307f2(0x18e)],_0x511f51='',_0x4c9652;for(_0x4c9652 in _0x269b34){var _0x31ec9c='FG';_0x2b94f1['to_warehouse']==_0x2307f2(0x175)&&(_0x31ec9c='DG'),_0x511f51+='<tr>'+_0x2307f2(0x18a)+_0x269b34[_0x4c9652]['product_name']+'</td>'+_0x2307f2(0x18a)+_0x269b34[_0x4c9652][_0x2307f2(0x189)]+_0x2307f2(0x1e4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x269b34[_0x4c9652][_0x2307f2(0x125)]+_0x2307f2(0x1e4)+_0x2307f2(0x18a)+_0x269b34[_0x4c9652][_0x2307f2(0x168)]+_0x2307f2(0x1e4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x269b34[_0x4c9652][_0x2307f2(0x12c)]+_0x2307f2(0x1e4)+_0x2307f2(0x18a)+_0x2b94f1['to_warehouse']+'</td>'+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x269b34[_0x4c9652][_0x2307f2(0x17a)]+_0x2307f2(0x1e4)+_0x2307f2(0x18a)+_0x31ec9c+_0x269b34[_0x4c9652][_0x2307f2(0x192)]+_0x2307f2(0x1e4)+'</tr>';}let _0xb2b07a=nodemailer['createTransport']({'host':_0x566370[_0x2307f2(0x19e)],'port':Number(_0x566370[_0x2307f2(0x15a)]),'secure':![],'auth':{'user':_0x566370[_0x2307f2(0x1a2)],'pass':_0x566370[_0x2307f2(0x188)]}}),_0x2aec83={'from':_0x566370[_0x2307f2(0x1a2)],'to':_0xa58fae[0x0][_0x2307f2(0x166)],'subject':_0x2307f2(0x1e0),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2307f2(0x178)+_0x2307f2(0x1e5)+_0x15df15[0x0][_0x2307f2(0x15f)],'cid':'logo'}],'html':_0x2307f2(0x16d)+'<html><head><title></title>'+_0x2307f2(0x18d)+'<div>'+_0x2307f2(0x164)+_0x2307f2(0x137)+_0x2307f2(0x161)+_0x2307f2(0x130)+_0x2307f2(0x137)+_0x2307f2(0x1d8)+_0x15df15[0x0][_0x2307f2(0x1b0)]+_0x2307f2(0x123)+_0x2307f2(0x130)+_0x2307f2(0x130)+_0x2307f2(0x19a)+_0x2307f2(0x137)+'<h5\x20style=\x22text-align:\x20left;\x22>'+_0x2307f2(0x1e7)+_0x2b94f1[_0x2307f2(0x171)]+'\x20'+_0x2307f2(0x1cc)+_0x2307f2(0x18c)+_0x2b94f1[_0x2307f2(0x109)]+'\x20'+'</span>'+'</h5>'+_0x2307f2(0x130)+_0x2307f2(0x195)+_0x2307f2(0x133)+_0x2307f2(0x10d)+_0x2307f2(0x1d3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>'+_0x2307f2(0x16a)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+_0x2307f2(0x1de)+_0x2307f2(0x18f)+_0x2307f2(0x182)+_0x2307f2(0x1e2)+'</tr>'+'</thead>'+_0x2307f2(0x1d1)+'\x20'+_0x511f51+'\x20'+_0x2307f2(0x1c8)+_0x2307f2(0x1d4)+_0x2307f2(0x137)+_0x2307f2(0x154)+_0x2307f2(0x1c7)+_0x15df15[0x0][_0x2307f2(0x1b0)]+'</h5>'+_0x2307f2(0x130)+_0x2307f2(0x130)+_0x2307f2(0x1a8)};_0xb2b07a[_0x2307f2(0x187)](_0x2aec83,function(_0x4cfb8f,_0x477d8e){var _0x227aad=_0x2307f2;_0x4cfb8f?(console[_0x227aad(0x139)](_0x4cfb8f),console[_0x227aad(0x139)](_0x227aad(0x127))):console[_0x227aad(0x139)](_0x227aad(0x11b));}),_0x1e7dbf['flash'](_0x2307f2(0x155),_0x2307f2(0x131)),_0x1f9ca6[_0x2307f2(0x1ae)](_0x2307f2(0x14c)+_0x177e2c[_0x2307f2(0x141)]);}catch(_0x5653a0){console[_0x2307f2(0x1c6)](_0x5653a0),_0x1f9ca6[_0x2307f2(0x149)](0x1f4)[_0x2307f2(0x1a3)]({'error':_0x2307f2(0x179)});}})[_0x5a7a2b(0x1bc)](_0x5b2e72=>{var _0x19eaa7=_0x5a7a2b;console['error'](_0x5b2e72),_0x1f9ca6['status'](0x1f4)[_0x19eaa7(0x1a3)]({'error':'An\x20error\x20occurred.'});});}catch(_0xa6570c){console['error'](_0xa6570c),_0x1f9ca6[_0x5a7a2b(0x149)](0x1f4)[_0x5a7a2b(0x1a3)]({'error':'An\x20error\x20occurred\x20while\x20saving\x20data.'});}})['catch'](_0x5c3c9e=>{var _0x7b48b9=_0x1709d2;console[_0x7b48b9(0x1c6)](_0x5c3c9e),_0x1f9ca6[_0x7b48b9(0x149)](0x1f4)[_0x7b48b9(0x1a3)]({'error':_0x7b48b9(0x16f)});});}catch(_0xbdf92e){_0x1f9ca6[_0x1709d2(0x1a3)]({'message':_0xbdf92e[_0x1709d2(0x162)]});}});function a0_0x23ed(){var _0x3bcb97=['Portuguese','error','<h5>','</tbody>','English','../models/all_models','role','<span\x20style=\x22float:\x20right;\x22>','$product_details._id','$product_details.maxPerUnit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','random','<tbody\x20style=\x22text-align:\x20center;\x22>','save','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','</table>','updateOne','add_transfer_finished','$product_details.bin','<h2>\x20','map','/transfer_finished/preview/','aggregate','\x20<>\x20','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>','../public/language/languages.json','Transfer\x20Mail','expiry_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','findById','</td>','/upload/','TRFF-','\x20Order\x20Number\x20:\x20','abs','primary_code','2522712iUBHCb','product_details','Enabled','date','$product_details.unit','warehouse','$product_details.isle','<tr>','$product_details.level','to_prod_qty','user','$product_details.type','7aaUqKn','params','5704029raCvFp','here1','floor','maxPerUnit','then','from_invoice','$invoice','Email\x20sent\x20successfully','toString','Transfer\x20Edit\x20Successfully','from_prod_level','250vpGFDg','$product_details.secondary_code','$product_details.product_code','maxProducts','\x20</h2>','16fleXMI','to_quantity','errors','Error\x20Occurs','ToRoomAssigned','production_date','bay','1095061TnoTcF','secondary_unit','MaxStocks_data2','findOne','max','</div>','Transfer\x20Finalize\x20Successfully','MaxStocks_data','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','$finalize','English\x20(US)','$product_details.batch_code','<div>','from_quantity','log','to_warehouse','express','5080456NWgpAJ','4703825CJiHqT','/barcode_scanner2','primary_unit','exports','_id','length','$_id','padStart','$product_details.pallet','push','from_room','Arabic','status','product_code3','transfer_data','/picking_list/PDF_transfer/','product_name','4prVawt','/view/:id','Arabic\x20(ae)','$room','language','Finished\x20Goods','<strong>\x20Regards\x20</strong>','success','to_room','Chinese','filter','all','port','/view/add_transfer','staff','$product_details.floorlevel','find','image','$from_warehouse','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','message','flash','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','from_warehouse','FGSEmail','from_room_name','unit','/barcode_scanner','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','to_floorlevel','Rack\x202','<!DOCTYPE\x20html>','True','An\x20error\x20occurred.','back','invoice','$product_details.production_date','slice','to_invoice','DRY\x20GOODS','$product_details.product_name','$product_details.secondary_unit','/../public','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','to_room_name','$product.from_room_name','$product_details.invoice','/view','string','/barcode_scanner3','getDate','batch_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','$product_details.bay','from_bay','$product_details.expiry_date','concat','sendMail','password','product_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','get','\x20Order\x20Date\x20:\x20','</head><body>','product','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','$product','French','to_bay','from_prod_qty','note','<table\x20style=\x22width:\x20100%\x20!important;\x22>','product_stock','$product_details.rack','New_Qty_Converted','979710qcIGcq','<hr\x20class=\x22my-3\x22>','$product_details.storage','/transfer_finished/view','241152NCDuok','host','to_prod_level','Spanish','/preview/:id','email','json','../middleware/auth','nodemailer','body','id_transaction','</body></html>','prod_name','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','forEach','product_date','secondary_code','redirect','render','site_title','$product_details.primary_code','$product_details','$product_details.product_stock','$product_details.maxProducts','German','split','Enclosed','RoomAssigned','Hindi','To_invoice','QA\x20Warehouse','catch','undefined','getMonth','$date','post','edit_transfer_finished_view','Ambient','Rack\x201','$name'];a0_0x23ed=function(){return _0x3bcb97;};return a0_0x23ed();}function BayBinSelected(_0x1ad6d3,_0x59ed7c){var _0x14cdcf=a0_0x2c1e02,_0x36b157=[];let _0x1bdd2f=[];var _0x29e05f=[];if(_0x1ad6d3==_0x14cdcf(0x175)){switch(_0x59ed7c){case _0x14cdcf(0x1c3):_0x36b157=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x14cdcf(0x16c):_0x36b157=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x29e05f=['DG'];}else{if(_0x1ad6d3=='FROZEN\x20GOODS'){switch(_0x59ed7c){case _0x14cdcf(0x1c3):_0x36b157=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case'Rack\x202':_0x36b157=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x29e05f=['FG'];}}return{'levels':_0x36b157,'identify':_0x29e05f};}router[a0_0x2c1e02(0x18b)](a0_0x2c1e02(0x14f),auth,async(_0x804413,_0x9b8d97)=>{var _0x22510d=a0_0x2c1e02;try{const {username:_0x2215fc,email:_0x269e54,role:_0x4578ef}=_0x804413[_0x22510d(0x110)],_0xf031bd=_0x804413['user'],_0x1e85c6=await profile[_0x22510d(0x12e)]({'email':_0xf031bd[_0x22510d(0x1a2)]}),_0x781dd8=await master_shop[_0x22510d(0x15e)](),_0x10e6fd=await transfers_finished[_0x22510d(0x1e3)](_0x804413['params']['id']);let _0x33a8e7=new Date(_0x10e6fd['expiry_date']),_0x3e61ea=('0'+_0x33a8e7[_0x22510d(0x180)]())[_0x22510d(0x173)](-0x2),_0x3527d0=('0'+(_0x33a8e7[_0x22510d(0x1be)]()+0x1))[_0x22510d(0x173)](-0x2),_0x1fd2c7=_0x33a8e7['getFullYear'](),_0x1cc69d=_0x1fd2c7+'-'+_0x3527d0+'-'+_0x3e61ea,_0x242ca8;if(_0xf031bd[_0x22510d(0x1cb)]==_0x22510d(0x15c)){const _0x3e8697=await staff[_0x22510d(0x12e)]({'email':_0xf031bd[_0x22510d(0x1a2)]});_0x242ca8=await warehouse[_0x22510d(0x15e)]({'status':'Enabled','name':_0x3e8697[_0x22510d(0x10b)],'warehouse_category':'Finished\x20Goods'});}else _0x242ca8=await warehouse['find']({'status':_0x22510d(0x108),'warehouse_category':_0x22510d(0x153)});const _0x34f7bb=await warehouse[_0x22510d(0x1db)]([{'$match':{'name':_0x10e6fd[_0x22510d(0x165)],'room':_0x10e6fd[_0x22510d(0x147)]}},{'$unwind':_0x22510d(0x1b2)},{'$group':{'_id':_0x22510d(0x1cd),'name':{'$first':_0x22510d(0x176)},'product_stock':{'$first':_0x22510d(0x1b3)},'bay':{'$first':_0x22510d(0x183)},'bin':{'$first':_0x22510d(0x1d7)},'type':{'$first':_0x22510d(0x111)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x22510d(0x1b1)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x22510d(0x121)},'storage':{'$first':_0x22510d(0x19b)},'rack':{'$first':_0x22510d(0x197)}}}]);var _0x3cc847=[0x1,0x2,0x3,0x4],_0x2033fa=['A','B','C','D','E','F','G','H','I','J'],_0xecf6bb=[_0x22510d(0x1c2),_0x22510d(0x1b7)];const _0x21ed83=await product[_0x22510d(0x15e)]({}),_0x36fd34=BayBinSelected(_0x10e6fd['to_warehouse'],_0x10e6fd[_0x22510d(0x156)]);if(_0x781dd8[0x0][_0x22510d(0x152)]=='English\x20(US)'){var _0x57c3d6=users[_0x22510d(0x1c9)];console[_0x22510d(0x139)](_0x57c3d6);}else{if(_0x781dd8[0x0]['language']==_0x22510d(0x1b9))var _0x57c3d6=users[_0x22510d(0x1b9)];else{if(_0x781dd8[0x0][_0x22510d(0x152)]==_0x22510d(0x1b5))var _0x57c3d6=users['German'];else{if(_0x781dd8[0x0][_0x22510d(0x152)]=='Spanish')var _0x57c3d6=users[_0x22510d(0x1a0)];else{if(_0x781dd8[0x0][_0x22510d(0x152)]==_0x22510d(0x191))var _0x57c3d6=users['French'];else{if(_0x781dd8[0x0][_0x22510d(0x152)]==_0x22510d(0x1dd))var _0x57c3d6=users[_0x22510d(0x1c5)];else{if(_0x781dd8[0x0]['language']==_0x22510d(0x157))var _0x57c3d6=users['Chinese'];else{if(_0x781dd8[0x0][_0x22510d(0x152)]==_0x22510d(0x150))var _0x57c3d6=users[_0x22510d(0x148)];}}}}}}}_0x9b8d97[_0x22510d(0x1af)]('edit_transfer_finished',{'success':_0x804413[_0x22510d(0x163)]('success'),'errors':_0x804413[_0x22510d(0x163)](_0x22510d(0x126)),'role':_0xf031bd,'profile':_0x1e85c6,'master_shop':_0x781dd8,'warehouse':_0x242ca8,'transfer':_0x10e6fd,'stock':_0x34f7bb,'unit':_0x21ed83,'language':_0x57c3d6,'levels':_0x3cc847,'Isle':_0x2033fa,'rooms_data':_0xecf6bb,'ed_fullDate':_0x1cc69d,'dataSelected':_0x36fd34});}catch(_0x188d3a){console[_0x22510d(0x139)](_0x188d3a);}}),router[a0_0x2c1e02(0x1c0)]('/view/:id',auth,async(_0xec28d3,_0x1ecf23)=>{var _0x36b30c=a0_0x2c1e02;try{const _0x241486=_0xec28d3[_0x36b30c(0x113)]['id'];console[_0x36b30c(0x139)](_0xec28d3['body']);const _0x546bdd=await transfers_finished[_0x36b30c(0x1e3)](_0x241486);console['log'](_0x36b30c(0x14b),_0x546bdd);const {date:_0x44928f,from_warehouse:_0x44f889,FromRoom_name:_0x25cfb9,to_warehouse:_0x265cb4,ToRoom_name:_0x116f19,prod_name:_0x16fad5,from_prod_qty:_0x199ebc,from_prod_level:_0x41075c,from_prod_isle:_0x4c4465,from_prod_pallet:_0x5732cd,to_prod_qty:_0x587c2f,to_prod_level:_0x5874a6,to_prod_isle:_0x11c187,to_prod_pallet:_0x5c5e37,primary_code:_0x312bce,secondary_code:_0x316ec8,product_code3:_0x208a6e,note:_0x53b88d,invoice:_0x2f1632,expiry_date:_0x1ed781}=_0xec28d3['body'];if(typeof _0x16fad5==_0x36b30c(0x17e))var _0x5697ea=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x1a9)]],_0x19b6a2=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x193)]],_0x239bce=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x11e)]],_0x44cccf=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x10f)]],_0x1ff530=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x19f)]],_0x3d689f=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x1e9)]],_0x4e937d=[_0xec28d3[_0x36b30c(0x1a6)]['secondary_code']],_0x14e2fa=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x14a)]],_0x485e8a=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x12d)]],_0x41490f=[_0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x168)]],_0x35c2ba=[_0xec28d3[_0x36b30c(0x1a6)]['secondary_unit']],_0x43f4fc=[_0xec28d3[_0x36b30c(0x1a6)]['batch_code']],_0x5e444e=[_0xec28d3[_0x36b30c(0x1a6)]['expiry_date']];else var _0x5697ea=[..._0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x1a9)]],_0x19b6a2=[..._0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x193)]],_0x239bce=[..._0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x11e)]],_0x44cccf=[..._0xec28d3[_0x36b30c(0x1a6)]['to_prod_qty']],_0x1ff530=[..._0xec28d3[_0x36b30c(0x1a6)]['to_prod_level']],_0x3d689f=[..._0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x1e9)]],_0x4e937d=[..._0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x1ad)]],_0x14e2fa=[..._0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x14a)]],_0x485e8a=[..._0xec28d3[_0x36b30c(0x1a6)]['MaxStocks_data2']],_0x41490f=[..._0xec28d3['body']['unit']],_0x35c2ba=[..._0xec28d3[_0x36b30c(0x1a6)][_0x36b30c(0x12c)]],_0x43f4fc=[..._0xec28d3['body'][_0x36b30c(0x181)]],_0x5e444e=[..._0xec28d3[_0x36b30c(0x1a6)]['expiry_date']];const _0x2ec556=_0x5697ea[_0x36b30c(0x1d9)](_0xe405a7=>{return _0xe405a7={'product_name':_0xe405a7};});_0x19b6a2['forEach']((_0x4da877,_0x291f2e)=>{var _0x50e17c=_0x36b30c;_0x2ec556[_0x291f2e][_0x50e17c(0x138)]=_0x4da877;}),_0x239bce['forEach']((_0x3ec8b6,_0x2192d0)=>{var _0x2fe965=_0x36b30c;_0x2ec556[_0x2192d0][_0x2fe965(0x184)]=_0x3ec8b6;}),_0x44cccf[_0x36b30c(0x1ab)]((_0x512d3b,_0x568c70)=>{var _0xf99bbd=_0x36b30c;_0x2ec556[_0x568c70][_0xf99bbd(0x125)]=_0x512d3b;}),_0x1ff530[_0x36b30c(0x1ab)]((_0xc75d00,_0x5246e5)=>{var _0x40fb82=_0x36b30c;_0x2ec556[_0x5246e5][_0x40fb82(0x192)]=_0xc75d00;}),_0x3d689f[_0x36b30c(0x1ab)]((_0x4b234a,_0x2c2180)=>{var _0x231da3=_0x36b30c;_0x2ec556[_0x2c2180][_0x231da3(0x1e9)]=_0x4b234a;}),_0x4e937d[_0x36b30c(0x1ab)]((_0x51a0b0,_0x341b7a)=>{var _0x1d7b65=_0x36b30c;_0x2ec556[_0x341b7a][_0x1d7b65(0x1ad)]=_0x51a0b0;}),_0x14e2fa[_0x36b30c(0x1ab)]((_0x1d9baa,_0x5847de)=>{var _0x3e7ae6=_0x36b30c;_0x2ec556[_0x5847de][_0x3e7ae6(0x189)]=_0x1d9baa;}),_0x485e8a[_0x36b30c(0x1ab)]((_0x574e5a,_0x2befe7)=>{_0x2ec556[_0x2befe7]['maxProducts']=_0x574e5a;}),_0x41490f[_0x36b30c(0x1ab)]((_0xb701fb,_0x10d559)=>{var _0x1c0dea=_0x36b30c;_0x2ec556[_0x10d559][_0x1c0dea(0x168)]=_0xb701fb;}),_0x35c2ba[_0x36b30c(0x1ab)]((_0x53037e,_0x53ebec)=>{_0x2ec556[_0x53ebec]['secondary_unit']=_0x53037e;}),_0x43f4fc[_0x36b30c(0x1ab)]((_0x3d15c0,_0x4b3e5d)=>{var _0x45c11c=_0x36b30c;_0x2ec556[_0x4b3e5d][_0x45c11c(0x181)]=_0x3d15c0;}),_0x5e444e[_0x36b30c(0x1ab)]((_0x14cdf8,_0x2eea2c)=>{_0x2ec556[_0x2eea2c]['expiry_date']=_0x14cdf8;});const _0x2eedb4=_0x2ec556[_0x36b30c(0x158)](_0x5104e0=>_0x5104e0[_0x36b30c(0x125)]!=='0'&&_0x5104e0['to_quantity']!==''||_0x5104e0[_0x36b30c(0x16b)]!=='0'&&_0x5104e0['to_floorlevel']!=='');var _0x3495e8=0x0;_0x2eedb4[_0x36b30c(0x1ab)](_0x50e8ad=>{var _0x39c636=_0x36b30c;parseInt(_0x50e8ad[_0x39c636(0x138)])<parseInt(_0x50e8ad[_0x39c636(0x125)])&&_0x3495e8++;});if(_0x3495e8!=0x0)return _0xec28d3[_0x36b30c(0x163)](_0x36b30c(0x126),_0x36b30c(0x1aa)),_0x1ecf23[_0x36b30c(0x1ae)]('back');const _0x2ca864=await warehouse['findOne']({'name':_0x546bdd['from_warehouse'],'room':_0x546bdd[_0x36b30c(0x147)]});_0x546bdd[_0x36b30c(0x18e)][_0x36b30c(0x1ab)](_0x407235=>{var _0x235831=_0x36b30c;if(_0x407235[_0x235831(0x125)]>0x0){const _0x4be8bc=_0x2ca864[_0x235831(0x107)][_0x235831(0x1d9)](_0x1d9720=>{var _0x1d94fc=_0x235831;_0x1d9720['product_name']==_0x407235[_0x1d94fc(0x14d)]&&_0x1d9720['bay']==_0x407235[_0x1d94fc(0x184)]&&(_0x1d9720[_0x1d94fc(0x196)]=parseInt(_0x1d9720[_0x1d94fc(0x196)])+parseInt(_0x407235[_0x1d94fc(0x125)]));});}}),await _0x2ca864[_0x36b30c(0x1d2)]();const _0x5ef05c=await warehouse[_0x36b30c(0x12e)]({'name':_0x546bdd[_0x36b30c(0x13a)],'room':_0x546bdd['to_room']});_0x546bdd['product'][_0x36b30c(0x1ab)](_0x107aa8=>{var _0x4a68c1=_0x36b30c;if(_0x107aa8['to_quantity']>0x0){const _0xecc796=_0x5ef05c['product_details'][_0x4a68c1(0x1d9)](_0x482b38=>{var _0x5bd173=_0x4a68c1;_0x482b38[_0x5bd173(0x14d)]==_0x107aa8[_0x5bd173(0x14d)]&&_0x482b38[_0x5bd173(0x12a)]==_0x107aa8[_0x5bd173(0x192)]&&(_0x482b38[_0x5bd173(0x196)]=parseInt(_0x482b38[_0x5bd173(0x196)])-parseInt(_0x107aa8['to_quantity']));});}}),await _0x5ef05c['save'](),_0x546bdd[_0x36b30c(0x109)]=_0x44928f,_0x546bdd[_0x36b30c(0x165)]=_0x44f889,_0x546bdd[_0x36b30c(0x13a)]=_0x265cb4,_0x546bdd['product']=_0x2eedb4,_0x546bdd[_0x36b30c(0x194)]=_0x53b88d,_0x546bdd['invoice']=_0x2f1632;const _0x3b67b6=await _0x546bdd[_0x36b30c(0x1d2)](),_0x440cee=await warehouse[_0x36b30c(0x12e)]({'name':_0x44f889,'room':_0x25cfb9});_0x3b67b6[_0x36b30c(0x18e)]['forEach'](_0x54305a=>{var _0x3aa4b3=_0x36b30c;if(_0x54305a[_0x3aa4b3(0x125)]>0x0){const _0x24e266=_0x440cee[_0x3aa4b3(0x107)]['map'](_0xc59826=>{var _0x1052f6=_0x3aa4b3;_0xc59826[_0x1052f6(0x14d)]==_0x54305a[_0x1052f6(0x14d)]&&_0xc59826[_0x1052f6(0x12a)]==_0x54305a[_0x1052f6(0x184)]&&(_0xc59826[_0x1052f6(0x196)]=parseInt(_0xc59826[_0x1052f6(0x196)])-parseInt(_0x54305a[_0x1052f6(0x125)]));});}}),await _0x440cee['save']();const _0x3ac089=await warehouse['findOne']({'name':_0x265cb4,'room':_0x116f19});_0x3b67b6[_0x36b30c(0x18e)]['forEach'](_0x2ecf64=>{var _0x4404e9=_0x36b30c;if(_0x2ecf64[_0x4404e9(0x125)]>0x0){var _0x2fa23e=0x0;const _0x384a21=_0x3ac089['product_details']['map'](_0x490971=>{var _0x140b8d=_0x4404e9;_0x490971[_0x140b8d(0x14d)]==_0x2ecf64[_0x140b8d(0x14d)]&&_0x490971['bay']==_0x2ecf64[_0x140b8d(0x192)]&&(_0x490971['product_stock']=parseInt(_0x490971[_0x140b8d(0x196)])+parseInt(_0x2ecf64['to_quantity']),_0x2fa23e++);});_0x2fa23e=='0'&&(_0x3ac089[_0x4404e9(0x107)]=_0x3ac089[_0x4404e9(0x107)][_0x4404e9(0x186)]({'product_name':_0x2ecf64[_0x4404e9(0x14d)],'product_stock':_0x2ecf64[_0x4404e9(0x125)],'bay':_0x2ecf64[_0x4404e9(0x192)],'product_code':_0x2ecf64[_0x4404e9(0x189)],'primary_code':_0x2ecf64[_0x4404e9(0x1e9)],'secondary_code':_0x2ecf64['secondary_code'],'maxProducts':_0x2ecf64[_0x4404e9(0x122)]}));}}),await _0x3ac089[_0x36b30c(0x1d2)](),_0xec28d3['flash'](_0x36b30c(0x155),_0x36b30c(0x11d)),_0x1ecf23['redirect'](_0x36b30c(0x19c));}catch(_0x3f83a2){console['log'](_0x3f83a2);}}),router[a0_0x2c1e02(0x1c0)](a0_0x2c1e02(0x169),async(_0x4b3a0a,_0x34900d)=>{var _0xe29705=a0_0x2c1e02;const {FromWareHouse:_0x25fe74,FromRoom:_0x15de5b,ToWarehouse:_0x4ac74d,ToRoom:_0xb8273a,primary_code:_0x557994,Roomslist:_0x256ef8}=_0x4b3a0a[_0xe29705(0x1a6)],_0x294297=_0x256ef8[_0xe29705(0x1b6)](','),_0x29cfe1=[];async function _0x2d879a(_0x2c2ac4){var _0x2b3a76=_0xe29705;const _0x339caa=await warehouse[_0x2b3a76(0x1db)]([{'$match':{'name':_0x25fe74,'room':_0x2c2ac4}},{'$unwind':_0x2b3a76(0x1b2)},{'$match':{'product_details.primary_code':_0x557994}},{'$group':{'_id':_0x2b3a76(0x1cd),'name':{'$first':_0x2b3a76(0x176)},'instock':{'$first':_0x2b3a76(0x1b3)},'primary_code':{'$first':_0x2b3a76(0x1b1)},'secondary_code':{'$first':_0x2b3a76(0x120)},'product_code':{'$first':_0x2b3a76(0x121)},'level':{'$first':_0x2b3a76(0x183)},'isle':{'$first':_0x2b3a76(0x1d7)},'type':{'$first':_0x2b3a76(0x111)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x2b3a76(0x10a)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x2b3a76(0x197)},'expiry_date':{'$first':_0x2b3a76(0x185)},'production_date':{'$first':_0x2b3a76(0x172)},'batch_code':{'$first':_0x2b3a76(0x136)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x2b3a76(0x151)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x2b3a76(0x17c)}}}]),_0x4888ab=await warehouse[_0x2b3a76(0x1db)]([{'$match':{'name':_0x25fe74,'room':_0x2c2ac4}},{'$unwind':_0x2b3a76(0x1b2)},{'$match':{'product_details.secondary_code':_0x557994}},{'$group':{'_id':_0x2b3a76(0x1cd),'name':{'$first':_0x2b3a76(0x176)},'instock':{'$first':_0x2b3a76(0x1b3)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x2b3a76(0x121)},'level':{'$first':_0x2b3a76(0x183)},'isle':{'$first':_0x2b3a76(0x1d7)},'type':{'$first':_0x2b3a76(0x111)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x2b3a76(0x177)},'storage':{'$first':_0x2b3a76(0x19b)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x2b3a76(0x185)},'production_date':{'$first':_0x2b3a76(0x172)},'batch_code':{'$first':_0x2b3a76(0x136)},'maxPerUnit':{'$first':_0x2b3a76(0x1ce)},'roomNamed':{'$first':_0x2b3a76(0x151)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x2b3a76(0x17c)}}}]);if(_0x339caa[_0x2b3a76(0x142)]>0x0)_0x29cfe1['push'](_0x339caa);else _0x4888ab[_0x2b3a76(0x142)]>0x0&&_0x29cfe1[_0x2b3a76(0x146)](_0x4888ab);}const _0x177cfd=_0x294297[_0xe29705(0x1d9)](_0x1531ae=>_0x2d879a(_0x1531ae));await Promise[_0xe29705(0x159)](_0x177cfd),_0x34900d[_0xe29705(0x1a3)](_0x29cfe1);}),router[a0_0x2c1e02(0x1c0)](a0_0x2c1e02(0x13e),async(_0x2f0304,_0x242c2e)=>{var _0x3ac7c5=a0_0x2c1e02;try{const {FromWareHouse:_0x223e27,FromRoom:_0x13e68c,ToWarehouse:_0x408843,ToRoom:_0x32b151,secondary_code:_0x98e912}=_0x2f0304[_0x3ac7c5(0x1a6)],_0x2aef48=await warehouse[_0x3ac7c5(0x1db)]([{'$match':{'name':_0x223e27}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x98e912}},{'$group':{'_id':_0x3ac7c5(0x1cd),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x3ac7c5(0x1b1)},'secondary_code':{'$first':_0x3ac7c5(0x120)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x3ac7c5(0x1c4)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3ac7c5(0x10c)},'pallet':{'$first':_0x3ac7c5(0x145)},'maxProducts':{'$first':_0x3ac7c5(0x1b4)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3ac7c5(0x172)}}}]);_0x242c2e[_0x3ac7c5(0x149)](0xc8)[_0x3ac7c5(0x1a3)](_0x2aef48);}catch(_0x38a1bc){_0x242c2e[_0x3ac7c5(0x149)](0x194)[_0x3ac7c5(0x1a3)]({'message':_0x38a1bc[_0x3ac7c5(0x162)]});}}),router[a0_0x2c1e02(0x1c0)](a0_0x2c1e02(0x17f),async(_0x116664,_0x11e6ca)=>{var _0x39e5a5=a0_0x2c1e02;try{const {FromWareHouse:_0x40922b,FromRoom:_0x32ac88,ToWarehouse:_0x24a94c,ToRoom:_0x53befc,product_code:_0x171403}=_0x116664['body'],_0x420947=await warehouse[_0x39e5a5(0x1db)]([{'$match':{'name':_0x40922b}},{'$unwind':_0x39e5a5(0x1b2)},{'$match':{'product_details.product_code':_0x171403}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x39e5a5(0x1b1)},'secondary_code':{'$first':_0x39e5a5(0x120)},'product_code':{'$first':_0x39e5a5(0x121)},'instock':{'$first':_0x39e5a5(0x1b3)},'warehouse':{'$first':_0x39e5a5(0x1c4)},'level':{'$first':_0x39e5a5(0x10e)},'isle':{'$first':_0x39e5a5(0x10c)},'pallet':{'$first':_0x39e5a5(0x145)},'maxProducts':{'$first':_0x39e5a5(0x1b4)},'unit':{'$first':_0x39e5a5(0x10a)}}}]);_0x11e6ca[_0x39e5a5(0x149)](0xc8)[_0x39e5a5(0x1a3)](_0x420947);}catch(_0x4febb3){_0x11e6ca[_0x39e5a5(0x149)](0x194)[_0x39e5a5(0x1a3)]({'message':_0x4febb3[_0x39e5a5(0x162)]});}}),router[a0_0x2c1e02(0x1c0)]('/CheckingWarehouse',async(_0x54ee70,_0x5c145b)=>{var _0x216c68=a0_0x2c1e02;const {productCode:_0x656a97,bay:_0x480973,warehouses:_0x5a01d8,room:_0x526a4d}=_0x54ee70[_0x216c68(0x1a6)];console[_0x216c68(0x139)](_0x54ee70[_0x216c68(0x1a6)]);try{const _0x315563=await warehouse[_0x216c68(0x1db)]([{'$match':{'name':_0x5a01d8,'room':_0x526a4d}},{'$unwind':'$product_details'},{'$match':{'product_details.bay':parseInt(_0x480973)}},{'$group':{'_id':_0x216c68(0x1cd),'name':{'$first':_0x216c68(0x176)},'product_stock':{'$first':_0x216c68(0x1b3)},'bay':{'$first':_0x216c68(0x183)},'maxProducts':{'$first':_0x216c68(0x1b4)}}}]);_0x5c145b[_0x216c68(0x149)](0xc8)['json'](_0x315563);}catch(_0x4a8ec7){_0x5c145b['status'](0x194)[_0x216c68(0x1a3)]({'message':_0x4a8ec7[_0x216c68(0x162)]});}}),module[a0_0x2c1e02(0x140)]=router;