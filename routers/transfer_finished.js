var a0_0x12bde6=a0_0x2521;(function(_0x3ca18d,_0x5a5a52){var _0xc3b869=a0_0x2521,_0x13a5a5=_0x3ca18d();while(!![]){try{var _0x1ea968=parseInt(_0xc3b869(0x26a))/0x1*(parseInt(_0xc3b869(0x206))/0x2)+parseInt(_0xc3b869(0x254))/0x3*(parseInt(_0xc3b869(0x1ad))/0x4)+parseInt(_0xc3b869(0x1fc))/0x5+-parseInt(_0xc3b869(0x251))/0x6*(parseInt(_0xc3b869(0x278))/0x7)+-parseInt(_0xc3b869(0x27e))/0x8+parseInt(_0xc3b869(0x1d5))/0x9+-parseInt(_0xc3b869(0x1bf))/0xa*(parseInt(_0xc3b869(0x262))/0xb);if(_0x1ea968===_0x5a5a52)break;else _0x13a5a5['push'](_0x13a5a5['shift']());}catch(_0x2c0061){_0x13a5a5['push'](_0x13a5a5['shift']());}}}(a0_0x4194,0xee34c));const express=require(a0_0x12bde6(0x26f)),app=express(),router=express[a0_0x12bde6(0x27f)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,email_settings,supervisor_settings}=require('../models/all_models'),auth=require(a0_0x12bde6(0x249)),users=require(a0_0x12bde6(0x1fa)),nodemailer=require(a0_0x12bde6(0x1f1));function a0_0x2521(_0x309254,_0x30a4e8){var _0x419435=a0_0x4194();return a0_0x2521=function(_0x2521de,_0x5a79a5){_0x2521de=_0x2521de-0x1a0;var _0x10915b=_0x419435[_0x2521de];return _0x10915b;},a0_0x2521(_0x309254,_0x30a4e8);}router[a0_0x12bde6(0x243)](a0_0x12bde6(0x208),auth,async(_0x41c2bf,_0x5a306a)=>{var _0x4dc461=a0_0x12bde6;try{const {username:_0x4f1e82,email:_0x5a32a9,role:_0x3e80c9}=_0x41c2bf[_0x4dc461(0x26b)],_0x91249=_0x41c2bf['user'],_0x182af7=await profile[_0x4dc461(0x1c0)]({'email':_0x91249['email']}),_0x549c0f=await master_shop[_0x4dc461(0x246)]();let _0x3c1676;if(_0x91249[_0x4dc461(0x274)]==_0x4dc461(0x1ac)){const _0x5b4d4a=await staff[_0x4dc461(0x1c0)]({'email':_0x91249[_0x4dc461(0x222)]});_0x3c1676=await transfers_finished[_0x4dc461(0x246)]({'from_warehouse':_0x5b4d4a[_0x4dc461(0x1b2)]});}else _0x3c1676=await transfers_finished['aggregate']([{'$unwind':_0x4dc461(0x211)},{'$group':{'_id':'$_id','invoice':{'$first':_0x4dc461(0x205)},'date':{'$first':'$date'},'from_warehouse':{'$first':_0x4dc461(0x1ca)},'to_warehouse':{'$first':_0x4dc461(0x224)},'from_room_name':{'$addToSet':_0x4dc461(0x1df)},'to_room_name':{'$addToSet':_0x4dc461(0x26e)},'finalize':{'$first':_0x4dc461(0x1ae)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x549c0f[0x0][_0x4dc461(0x1e2)]==_0x4dc461(0x1c2))var _0x30d142=users[_0x4dc461(0x25b)];else{if(_0x549c0f[0x0]['language']==_0x4dc461(0x23e))var _0x30d142=users['Hindi'];else{if(_0x549c0f[0x0][_0x4dc461(0x1e2)]==_0x4dc461(0x1af))var _0x30d142=users[_0x4dc461(0x1af)];else{if(_0x549c0f[0x0]['language']=='Spanish')var _0x30d142=users[_0x4dc461(0x22c)];else{if(_0x549c0f[0x0]['language']=='French')var _0x30d142=users[_0x4dc461(0x1c4)];else{if(_0x549c0f[0x0][_0x4dc461(0x1e2)]=='Portuguese\x20(BR)')var _0x30d142=users[_0x4dc461(0x242)];else{if(_0x549c0f[0x0][_0x4dc461(0x1e2)]==_0x4dc461(0x200))var _0x30d142=users[_0x4dc461(0x200)];else{if(_0x549c0f[0x0][_0x4dc461(0x1e2)]==_0x4dc461(0x259))var _0x30d142=users['Arabic'];}}}}}}}_0x5a306a['render'](_0x4dc461(0x209),{'success':_0x41c2bf[_0x4dc461(0x1b4)](_0x4dc461(0x1a4)),'errors':_0x41c2bf['flash'](_0x4dc461(0x21f)),'role':_0x91249,'profile':_0x182af7,'master_shop':_0x549c0f,'transfer':_0x3c1676,'language':_0x30d142});}catch(_0x4db73e){console[_0x4dc461(0x1f4)](_0x4db73e);}});function a0_0x4194(){var _0x47575d=['/transfer_finished/preview/','primary_code','$product_details.production_date','/transfer_finished/view','to_room','</td>','4451400cRaGCe','<h2>\x20','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','Enclosed','invoice','date','to_invoice','findById','$product_details','$product_details.secondary_code','$product.from_room_name','unit','$product_details.unit','language','undefined','maxProducts','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Warehouse</th>','secondary_code','filter','error','getFullYear','Rack\x201','body','<hr\x20class=\x22my-3\x22>','FROZEN\x20GOODS','image','post','product_code','nodemailer','to_prod_level','/picking_list/PDF_transfer/','log','to_quantity','padStart','prod_name','length','add_transfer_finished','../public/language/languages.json','Portuguese\x20(BR)','1571320gVipky','MaxStocks_data','$product_details.maxProducts','to_floorlevel','Chinese','/barcode_scanner3','/CheckingWarehouse','<html><head><title></title>','edit_transfer_finished_view','$invoice','153444XcswNg','edit_transfer_finished','/view','transfer_finished','$product_details.invoice','transfer_data','/view/add_transfer','to_bay','split','abs','from_warehouse','$product','$product_details.bay','here2','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room</th>','FGSEmail','exports','prod_cat','/view/:id','</tbody>','$product_details.isle','DRY\x20GOODS','</h5>','$product_details.storage','createTransport','errors','from_room_name','product_details','email','maxPerUnit','$to_warehouse','from_bay','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','\x20</h2>','<tr>','site_title','To_invoice','secondary_unit','Spanish','from_prod_qty','render','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','TRFF-','ToRoomAssigned','/upload/','all','back','id_transaction','Finished\x20Goods','\x20Order\x20Date\x20:\x20','save','<table\x20style=\x22width:\x20100%\x20!important;\x22>','push','$room','/preview/:id','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','Hindi','bay','Transfer\x20Finalize\x20Successfully','$product_details.maxPerUnit','Portuguese','get','logo','status','find','from_invoice','\x20<>\x20','../middleware/auth','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Code\x20</th>','$product_details.floorlevel','catch','New_Qty_Converted','Enabled','/barcode_scanner','$product_details.expiry_date','404286wbCVcn','product_code3','port','3gNIyJY','Transfer\x20Edit\x20Successfully','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','product','$name','Arabic\x20(ae)','from_room','English','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','RoomAssigned','toString','string','password','11kJfjxG','</head><body>','primary_unit','aggregate','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','redirect','Arabic','Rack\x202','16qoTyWM','user','product_name','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product.to_room_name','express','$product_details.secondary_unit','message','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Quantity\x20</th>','map','role','True','$product_details.type','Email\x20sent\x20successfully','91qpAWjn','<tbody\x20style=\x22text-align:\x20center;\x22>','/transfer/view','Product\x20Transfer\x20successfully','random','_id','3047480ITdGca','Router','forEach','/../public','params','getDate','production_date','An\x20error\x20occurred.','product_stock','from_prod_level','updateOne','</div>','$product_details.product_code','<h5>','success','</body></html>','$product_details.rack','$product_details.product_stock','</tr>','MaxStocks_data2','json','slice','staff','7039628mrkrXO','$finalize','German','<div>','to_room_name','warehouse','from_quantity','flash','to_warehouse','QA\x20Warehouse','</span>','$product_details.product_name','expiry_date','here1','then','$product_details._id','$product_details.primary_code','to_prod_qty','15637430mqijMe','findOne','getMonth','English\x20(US)','Logo.png','French','$product_details.batch_code','$product_details.bin','An\x20error\x20occurred\x20while\x20saving\x20data.','concat','batch_code','$from_warehouse','<!DOCTYPE\x20html>','Transfer\x20Mail','max','product_date'];a0_0x4194=function(){return _0x47575d;};return a0_0x4194();}async function getRandom8DigitNumber(){var _0x897fa5=a0_0x12bde6;const _0x5bb8a3=0x989680,_0x280866=0x5f5e0ff,_0x53e8fb=Math['floor'](Math[_0x897fa5(0x27c)]()*(_0x280866-_0x5bb8a3+0x1))+_0x5bb8a3;var _0x31e014;const _0x5a2829=await transfers_finished['findOne']({'invoice':_0x897fa5(0x230)+_0x53e8fb});return _0x5a2829&&_0x5a2829[_0x897fa5(0x1f8)]>0x0?_0x31e014=_0x897fa5(0x230)+_0x53e8fb:_0x31e014=_0x897fa5(0x230)+_0x53e8fb,_0x31e014;}router['get']('/view/add_transfer',auth,async(_0x2c21e1,_0x472a62)=>{var _0x35a3e9=a0_0x12bde6;try{const {username:_0x4921ff,email:_0x5308ce,role:_0x5f3b57}=_0x2c21e1[_0x35a3e9(0x26b)],_0x22bf85=_0x2c21e1[_0x35a3e9(0x26b)],_0x37c323=await profile[_0x35a3e9(0x1c0)]({'email':_0x22bf85[_0x35a3e9(0x222)]}),_0x51af1a=await master_shop['find']();let _0x4c0b6a;if(_0x22bf85[_0x35a3e9(0x274)]==_0x35a3e9(0x1ac)){const _0x281a73=await staff['findOne']({'email':_0x22bf85[_0x35a3e9(0x222)]});_0x4c0b6a=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x281a73[_0x35a3e9(0x1b2)],'warehouse_category':'Finished\x20Goods','name':{'$ne':_0x35a3e9(0x1b6)}}},{'$group':{'_id':'$name','name':{'$first':_0x35a3e9(0x258)}}}]);}else _0x4c0b6a=await warehouse[_0x35a3e9(0x265)]([{'$match':{'status':_0x35a3e9(0x24e),'warehouse_category':_0x35a3e9(0x236),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0xf4a4d5=await transfers_finished[_0x35a3e9(0x246)]({}),_0x37a0b2=_0xf4a4d5[_0x35a3e9(0x1f8)]+0x1,_0x4d44e2=_0x35a3e9(0x230)+_0x37a0b2[_0x35a3e9(0x25f)]()[_0x35a3e9(0x1f6)](0x5,'0');if(_0x51af1a[0x0][_0x35a3e9(0x1e2)]==_0x35a3e9(0x1c2))var _0x520ef3=users['English'];else{if(_0x51af1a[0x0][_0x35a3e9(0x1e2)]==_0x35a3e9(0x23e))var _0x520ef3=users[_0x35a3e9(0x23e)];else{if(_0x51af1a[0x0][_0x35a3e9(0x1e2)]==_0x35a3e9(0x1af))var _0x520ef3=users[_0x35a3e9(0x1af)];else{if(_0x51af1a[0x0][_0x35a3e9(0x1e2)]==_0x35a3e9(0x22c))var _0x520ef3=users[_0x35a3e9(0x22c)];else{if(_0x51af1a[0x0][_0x35a3e9(0x1e2)]==_0x35a3e9(0x1c4))var _0x520ef3=users[_0x35a3e9(0x1c4)];else{if(_0x51af1a[0x0]['language']==_0x35a3e9(0x1fb))var _0x520ef3=users['Portuguese'];else{if(_0x51af1a[0x0][_0x35a3e9(0x1e2)]==_0x35a3e9(0x200))var _0x520ef3=users[_0x35a3e9(0x200)];else{if(_0x51af1a[0x0]['language']==_0x35a3e9(0x259))var _0x520ef3=users[_0x35a3e9(0x268)];}}}}}}}const _0x58f7f6=getRandom8DigitNumber();_0x58f7f6[_0x35a3e9(0x1bb)](_0x77febc=>{var _0x3dfafd=_0x35a3e9;_0x472a62['render'](_0x3dfafd(0x1f9),{'success':_0x2c21e1[_0x3dfafd(0x1b4)](_0x3dfafd(0x1a4)),'errors':_0x2c21e1[_0x3dfafd(0x1b4)]('errors'),'role':_0x22bf85,'profile':_0x37c323,'master_shop':_0x51af1a,'warehouse':_0x4c0b6a,'language':_0x520ef3,'invoice':_0x77febc});})[_0x35a3e9(0x24c)](_0x31821e=>{var _0x1afd05=_0x35a3e9;_0x2c21e1['flash'](_0x1afd05(0x21f),_0x1afd05(0x25d)),_0x472a62['redirect'](_0x1afd05(0x27a));});}catch(_0x423119){console[_0x35a3e9(0x1f4)](_0x423119);}}),router[a0_0x12bde6(0x1ef)](a0_0x12bde6(0x20c),auth,async(_0x509fad,_0x546ea7)=>{var _0x1160f5=a0_0x12bde6;try{const {date:_0xa23ed3,from_warehouse:_0x3e4f54,FromRoom_name:_0x28447e,to_warehouse:_0x120d39,ToRoom_name:_0x1374d9,prod_name:_0x1dd452,from_prod_qty:_0x3871df,from_prod_level:_0x589cd5,from_prod_isle:_0x37b2ea,from_prod_pallet:_0x4371ad,to_prod_qty:_0x14489e,to_prod_level:_0x497ff4,to_prod_isle:_0x88ea8c,to_prod_pallet:_0x2afe25,primary_code:_0x1fb580,secondary_code:_0x4b31e9,product_code3:_0x238366,note:_0x8027c8,MaxStocks_data2:_0x43d13e,invoice:_0x55a8cf,expiry_date:_0x32549a}=_0x509fad['body'];if(typeof _0x1dd452==_0x1160f5(0x260))var _0x54492b=[_0x509fad['body'][_0x1160f5(0x1f7)]],_0x420906=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x22d)]],_0xc91a7d=[_0x509fad[_0x1160f5(0x1eb)]['from_prod_level']],_0x143a2b=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x24d)]],_0x459b4b=[_0x509fad[_0x1160f5(0x1eb)]['to_prod_level']],_0x4f1ad4=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1d0)]],_0x9e73be=[_0x509fad[_0x1160f5(0x1eb)]['secondary_code']],_0x3967fd=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x252)]],_0x6ad1e8=[_0x509fad[_0x1160f5(0x1eb)]['MaxStocks_data2']],_0x2e2246=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x264)]],_0x308462=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x22b)]],_0x2bee2a=[_0x509fad['body'][_0x1160f5(0x1c9)]],_0x11d615=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1b9)]],_0x3ca20d=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1ce)]],_0x30ca9e=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1fd)]],_0x3e3c9a=[_0x509fad[_0x1160f5(0x1eb)]['maxPerUnit']],_0x566e60=[_0x509fad['body']['prod_cat']],_0xd8a7a0=[_0x509fad['body'][_0x1160f5(0x25e)]],_0x28c873=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x231)]],_0x42ffdf=[_0x509fad['body']['from_invoice']],_0x1e492f=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1db)]],_0x254719=[_0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x235)]];else var _0x54492b=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1f7)]],_0x420906=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x22d)]],_0xc91a7d=[..._0x509fad[_0x1160f5(0x1eb)]['from_prod_level']],_0x143a2b=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x24d)]],_0x459b4b=[..._0x509fad[_0x1160f5(0x1eb)]['to_prod_level']],_0x4f1ad4=[..._0x509fad['body']['primary_code']],_0x9e73be=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1e6)]],_0x3967fd=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x252)]],_0x6ad1e8=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1a9)]],_0x2e2246=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x264)]],_0x308462=[..._0x509fad['body'][_0x1160f5(0x22b)]],_0x2bee2a=[..._0x509fad['body'][_0x1160f5(0x1c9)]],_0x11d615=[..._0x509fad['body'][_0x1160f5(0x1b9)]],_0x3ca20d=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1ce)]],_0x30ca9e=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x1fd)]],_0x3e3c9a=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x223)]],_0x566e60=[..._0x509fad['body'][_0x1160f5(0x217)]],_0xd8a7a0=[..._0x509fad['body'][_0x1160f5(0x25e)]],_0x28c873=[..._0x509fad['body'][_0x1160f5(0x231)]],_0x42ffdf=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x247)]],_0x1e492f=[..._0x509fad['body'][_0x1160f5(0x1db)]],_0x254719=[..._0x509fad[_0x1160f5(0x1eb)][_0x1160f5(0x235)]];const _0x5a68cf=_0x54492b['map'](_0x585fcb=>{return _0x585fcb={'product_name':_0x585fcb};});_0x420906['forEach']((_0x1c4d06,_0x536b89)=>{var _0x19bc22=_0x1160f5;_0x5a68cf[_0x536b89][_0x19bc22(0x1b3)]=_0x1c4d06;}),_0xc91a7d[_0x1160f5(0x280)]((_0x53f61c,_0x410604)=>{_0x5a68cf[_0x410604]['from_bay']=_0x53f61c;}),_0x254719['forEach']((_0x59f5eb,_0x314088)=>{var _0x2201c4=_0x1160f5;_0x5a68cf[_0x314088][_0x2201c4(0x235)]=_0x59f5eb;}),_0x42ffdf['forEach']((_0x1f20ae,_0x9209ff)=>{_0x5a68cf[_0x9209ff]['from_invoice']=_0x1f20ae;}),_0x1e492f[_0x1160f5(0x280)]((_0x4b29e2,_0x3c86a1)=>{var _0x4222b3=_0x1160f5;_0x5a68cf[_0x3c86a1][_0x4222b3(0x22a)]=_0x4b29e2;}),_0x143a2b['forEach']((_0x1ab6b1,_0x5845d5)=>{_0x5a68cf[_0x5845d5]['to_quantity']=_0x1ab6b1;}),_0x459b4b[_0x1160f5(0x280)]((_0x23af7f,_0x213600)=>{var _0x23cec7=_0x1160f5;_0x5a68cf[_0x213600][_0x23cec7(0x20d)]=_0x23af7f;}),_0x4f1ad4[_0x1160f5(0x280)]((_0x34fafa,_0x6eafe9)=>{var _0x17b117=_0x1160f5;_0x5a68cf[_0x6eafe9][_0x17b117(0x1d0)]=_0x34fafa;}),_0x9e73be['forEach']((_0x220e59,_0x5d1c2b)=>{_0x5a68cf[_0x5d1c2b]['secondary_code']=_0x220e59;}),_0x3967fd[_0x1160f5(0x280)]((_0x3aea44,_0x22b543)=>{var _0xdc617=_0x1160f5;_0x5a68cf[_0x22b543][_0xdc617(0x1f0)]=_0x3aea44;}),_0x6ad1e8[_0x1160f5(0x280)]((_0x2fc6c9,_0x33afbd)=>{var _0x43575=_0x1160f5;_0x5a68cf[_0x33afbd][_0x43575(0x1e4)]=_0x2fc6c9;}),_0x2e2246[_0x1160f5(0x280)]((_0x14ee28,_0x2226cd)=>{var _0x1b8c88=_0x1160f5;_0x5a68cf[_0x2226cd][_0x1b8c88(0x1e0)]=_0x14ee28;}),_0x308462[_0x1160f5(0x280)]((_0x5894d8,_0x303785)=>{_0x5a68cf[_0x303785]['secondary_unit']=_0x5894d8;}),_0x2bee2a[_0x1160f5(0x280)]((_0x38bee5,_0x45a5a3)=>{var _0x567392=_0x1160f5;_0x5a68cf[_0x45a5a3][_0x567392(0x1c9)]=_0x38bee5;}),_0x11d615[_0x1160f5(0x280)]((_0xcd21eb,_0x2f74a4)=>{var _0x486fc6=_0x1160f5;_0x5a68cf[_0x2f74a4][_0x486fc6(0x1b9)]=_0xcd21eb;}),_0x3ca20d[_0x1160f5(0x280)]((_0x50d732,_0x3684f1)=>{var _0x3226bc=_0x1160f5;_0x5a68cf[_0x3684f1][_0x3226bc(0x284)]=_0x50d732;}),_0x30ca9e[_0x1160f5(0x280)]((_0xb11b22,_0x5abecb)=>{var _0x175ae8=_0x1160f5;_0x5a68cf[_0x5abecb][_0x175ae8(0x1e4)]=_0xb11b22;}),_0x3e3c9a[_0x1160f5(0x280)]((_0x59dc20,_0x33fd17)=>{var _0x2e85db=_0x1160f5;_0x5a68cf[_0x33fd17][_0x2e85db(0x223)]=_0x59dc20;}),_0x566e60[_0x1160f5(0x280)]((_0x25a17d,_0x272596)=>{_0x5a68cf[_0x272596]['prod_cat']=_0x25a17d;}),_0xd8a7a0[_0x1160f5(0x280)]((_0x1a00d4,_0x4d68f1)=>{var _0xbfadf5=_0x1160f5;_0x5a68cf[_0x4d68f1][_0xbfadf5(0x220)]=_0x1a00d4;}),_0x28c873[_0x1160f5(0x280)]((_0x567b44,_0x11d604)=>{_0x5a68cf[_0x11d604]['to_room_name']=_0x567b44;});const _0x1ec2c5=_0x5a68cf[_0x1160f5(0x1e7)](_0x8d8e14=>_0x8d8e14['to_quantity']!=='0'&&_0x8d8e14['to_quantity']!==''||_0x8d8e14[_0x1160f5(0x1ff)]!=='0'&&_0x8d8e14[_0x1160f5(0x1ff)]!=='');var _0x33ee09=0x0;_0x1ec2c5[_0x1160f5(0x280)](_0x44f87a=>{var _0x1e74bc=_0x1160f5;parseInt(_0x44f87a['from_quantity'])<parseInt(_0x44f87a[_0x1e74bc(0x1f5)])&&_0x33ee09++;});if(_0x33ee09!=0x0)return _0x509fad[_0x1160f5(0x1b4)](_0x1160f5(0x21f),_0x1160f5(0x26d)),_0x546ea7[_0x1160f5(0x267)](_0x1160f5(0x234));const _0x4ca4f4=new transfers_finished({'date':_0xa23ed3,'from_warehouse':_0x3e4f54,'to_warehouse':_0x120d39,'product':_0x1ec2c5,'note':_0x8027c8,'invoice':_0x55a8cf}),_0xe5164a=await _0x4ca4f4['save']();_0x509fad[_0x1160f5(0x1b4)](_0x1160f5(0x1a4),_0x1160f5(0x27b)),_0x546ea7['redirect'](_0x1160f5(0x1cf)+_0xe5164a[_0x1160f5(0x27d)]);}catch(_0x473f9a){console[_0x1160f5(0x1f4)](_0x473f9a),_0x546ea7[_0x1160f5(0x245)](0xc8)[_0x1160f5(0x1aa)]({'errorMessage':_0x473f9a['message']});}}),router['get'](a0_0x12bde6(0x23c),auth,async(_0x57e6c3,_0x31d992)=>{var _0x540779=a0_0x12bde6;try{const {username:_0x43b2aa,email:_0x3f4c9a,role:_0x2d68a2}=_0x57e6c3[_0x540779(0x26b)],_0xa5a166=_0x57e6c3[_0x540779(0x26b)],_0x35bc89=await profile['findOne']({'email':_0xa5a166[_0x540779(0x222)]}),_0x1e8928=await master_shop[_0x540779(0x246)](),_0x7f241e=await transfers_finished[_0x540779(0x1dc)](_0x57e6c3[_0x540779(0x282)]['id']);let _0x3d90e6;if(_0xa5a166[_0x540779(0x274)]==_0x540779(0x1ac)){const _0x3923d9=await staff[_0x540779(0x1c0)]({'email':_0xa5a166[_0x540779(0x222)]});_0x3d90e6=await warehouse[_0x540779(0x246)]({'status':'Enabled','name':_0x3923d9[_0x540779(0x1b2)],'warehouse_category':'Finished\x20Goods'});}else _0x3d90e6=await warehouse[_0x540779(0x246)]({'status':'Enabled','warehouse_category':_0x540779(0x236)});const _0x3ff5f3=await warehouse[_0x540779(0x265)]([{'$match':{'name':_0x7f241e['from_warehouse'],'warehouse_category':_0x540779(0x236)}},{'$unwind':_0x540779(0x1dd)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x540779(0x1b8)},'product_stock':{'$first':_0x540779(0x1a7)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x540779(0x1c6)},'type':{'$first':_0x540779(0x276)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x540779(0x1bd)},'secondary_code':{'$first':_0x540779(0x1de)},'product_code':{'$first':_0x540779(0x1a2)},'storage':{'$first':_0x540779(0x21d)},'rack':{'$first':_0x540779(0x1a6)},'expiry_date':{'$first':_0x540779(0x250)},'production_date':{'$first':_0x540779(0x1d1)},'room':{'$first':'$room'},'warehoue_name':{'$first':_0x540779(0x258)}}}]),_0xf90417=await product[_0x540779(0x246)]({});if(_0x1e8928[0x0][_0x540779(0x1e2)]==_0x540779(0x1c2)){var _0x46f4b3=users['English'];console[_0x540779(0x1f4)](_0x46f4b3);}else{if(_0x1e8928[0x0][_0x540779(0x1e2)]=='Hindi')var _0x46f4b3=users[_0x540779(0x23e)];else{if(_0x1e8928[0x0][_0x540779(0x1e2)]==_0x540779(0x1af))var _0x46f4b3=users[_0x540779(0x1af)];else{if(_0x1e8928[0x0][_0x540779(0x1e2)]==_0x540779(0x22c))var _0x46f4b3=users[_0x540779(0x22c)];else{if(_0x1e8928[0x0][_0x540779(0x1e2)]==_0x540779(0x1c4))var _0x46f4b3=users[_0x540779(0x1c4)];else{if(_0x1e8928[0x0]['language']==_0x540779(0x1fb))var _0x46f4b3=users['Portuguese'];else{if(_0x1e8928[0x0][_0x540779(0x1e2)]==_0x540779(0x200))var _0x46f4b3=users['Chinese'];else{if(_0x1e8928[0x0][_0x540779(0x1e2)]=='Arabic\x20(ae)')var _0x46f4b3=users[_0x540779(0x268)];}}}}}}}_0x31d992[_0x540779(0x22e)](_0x540779(0x204),{'success':_0x57e6c3[_0x540779(0x1b4)](_0x540779(0x1a4)),'errors':_0x57e6c3[_0x540779(0x1b4)]('errors'),'role':_0xa5a166,'profile':_0x35bc89,'master_shop':_0x1e8928,'warehouse':_0x3d90e6,'transfer':_0x7f241e,'stock':_0x3ff5f3,'unit':_0xf90417,'language':_0x46f4b3});}catch(_0x80133c){console[_0x540779(0x1f4)](_0x80133c);}}),router['post'](a0_0x12bde6(0x23c),auth,async(_0x3e8640,_0x40e945)=>{var _0x3a461d=a0_0x12bde6;try{const {invoice:_0x33e55b,from_warehouse:_0x1c7334,FromRoom_name:_0x4a6fd4,to_warehouse:_0x1c34c0,ToRoom_name:_0xb1c2b8}=_0x3e8640['body'],_0x4222bf=await transfers_finished[_0x3a461d(0x1dc)](_0x3e8640['params']['id']),_0x597f99=_0x4222bf[_0x3a461d(0x257)]['map'](async _0x3850e0=>{var _0x198d2d=_0x3a461d;if(_0x3850e0[_0x198d2d(0x1f5)]>0x0){var _0x43aaa9=await warehouse[_0x198d2d(0x1c0)]({'name':_0x1c7334,'room':_0x3850e0[_0x198d2d(0x220)],'warehouse_category':'Finished\x20Goods'});const _0x418789=_0x43aaa9[_0x198d2d(0x221)][_0x198d2d(0x273)](_0x266345=>{var _0x385e=_0x198d2d;_0x266345[_0x385e(0x26c)]==_0x3850e0[_0x385e(0x26c)]&&_0x266345['bay']==_0x3850e0[_0x385e(0x225)]&&_0x266345[_0x385e(0x1b9)]==_0x3850e0[_0x385e(0x1b9)]&&_0x266345[_0x385e(0x284)]==_0x3850e0[_0x385e(0x284)]&&_0x266345['batch_code']==_0x3850e0[_0x385e(0x1c9)]&&_0x266345[_0x385e(0x1d9)]==_0x3850e0['from_invoice']&&(console['log'](_0x385e(0x1ba),_0x266345[_0x385e(0x286)]),typeof _0x3850e0[_0x385e(0x235)]==_0x385e(0x1e3)?_0x266345['product_stock']=Math[_0x385e(0x1cd)](0x0,Math['abs'](_0x266345[_0x385e(0x286)])-Math[_0x385e(0x20f)](_0x3850e0['to_quantity'])):_0x266345[_0x385e(0x286)]=Math['max'](0x0,Math[_0x385e(0x20f)](_0x266345['product_stock'])-Math[_0x385e(0x20f)](_0x3850e0[_0x385e(0x1f5)])));});}return _0x43aaa9;});Promise[_0x3a461d(0x233)](_0x597f99)['then'](async _0x11e62a=>{var _0x2b555c=_0x3a461d;try{for(const _0x89f9fc of _0x11e62a){await _0x89f9fc[_0x2b555c(0x238)]();}const _0x5b987d=_0x4222bf[_0x2b555c(0x257)][_0x2b555c(0x273)](async _0x130ef2=>{var _0x50f2bd=_0x2b555c,_0x51b06f=await warehouse[_0x50f2bd(0x1c0)]({'name':_0x1c34c0,'room':_0x130ef2[_0x50f2bd(0x1b1)]});if(_0x130ef2['to_quantity']>0x0){var _0x198da3=0x0;const _0x2222ad=_0x51b06f[_0x50f2bd(0x221)][_0x50f2bd(0x273)](_0x33a19c=>{var _0x243dca=_0x50f2bd;_0x33a19c[_0x243dca(0x26c)]==_0x130ef2['product_name']&&_0x33a19c[_0x243dca(0x23f)]==_0x130ef2[_0x243dca(0x20d)]&&_0x33a19c[_0x243dca(0x1b9)]==_0x130ef2[_0x243dca(0x1b9)]&&_0x33a19c[_0x243dca(0x284)]==_0x130ef2[_0x243dca(0x284)]&&_0x33a19c[_0x243dca(0x1c9)]==_0x130ef2[_0x243dca(0x1c9)]&&_0x33a19c[_0x243dca(0x1d9)]==_0x130ef2[_0x243dca(0x22a)]&&(typeof _0x130ef2[_0x243dca(0x235)]==_0x243dca(0x1e3)?(console[_0x243dca(0x1f4)](_0x243dca(0x213),_0x33a19c[_0x243dca(0x286)]+_0x243dca(0x248)+_0x33a19c['_id']+'\x20<=>\x20'+Math[_0x243dca(0x20f)](_0x33a19c[_0x243dca(0x286)])+Math[_0x243dca(0x20f)](_0x130ef2[_0x243dca(0x1f5)])),_0x33a19c['product_stock']=Math['abs'](_0x33a19c[_0x243dca(0x286)])+Math[_0x243dca(0x20f)](_0x130ef2[_0x243dca(0x1f5)])):_0x33a19c[_0x243dca(0x286)]=Math[_0x243dca(0x20f)](_0x33a19c[_0x243dca(0x286)])+Math[_0x243dca(0x20f)](_0x130ef2[_0x243dca(0x1f5)]),_0x198da3++);});_0x198da3=='0'&&(_0x51b06f['product_details']=_0x51b06f[_0x50f2bd(0x221)][_0x50f2bd(0x1c8)]({'product_name':_0x130ef2[_0x50f2bd(0x26c)],'product_stock':_0x130ef2[_0x50f2bd(0x1f5)],'bay':_0x130ef2[_0x50f2bd(0x20d)],'product_code':_0x130ef2[_0x50f2bd(0x1f0)],'primary_code':_0x130ef2['primary_code'],'secondary_code':_0x130ef2[_0x50f2bd(0x1e6)],'expiry_date':_0x130ef2['expiry_date'],'production_date':_0x130ef2[_0x50f2bd(0x284)],'maxProducts':_0x130ef2['maxProducts'],'batch_code':_0x130ef2[_0x50f2bd(0x1c9)],'secondary_unit':_0x130ef2[_0x50f2bd(0x22b)],'unit':_0x130ef2['unit'],'maxProducts':_0x130ef2[_0x50f2bd(0x1e4)],'maxPerUnit':_0x130ef2[_0x50f2bd(0x223)],'invoice':_0x130ef2[_0x50f2bd(0x22a)]}));}return _0x51b06f;});Promise[_0x2b555c(0x233)](_0x5b987d)[_0x2b555c(0x1bb)](async _0x977724=>{var _0x20b12a=_0x2b555c;try{for(const _0x1a58ab of _0x977724){await warehouse[_0x20b12a(0x1a0)]({'_id':_0x1a58ab[_0x20b12a(0x27d)]},{'$addToSet':{'product_details':{'$each':_0x1a58ab[_0x20b12a(0x221)]}}});}_0x4222bf['finalize']=_0x20b12a(0x275);const _0xd03f1b=await _0x4222bf[_0x20b12a(0x238)](),_0x5aea96=await master_shop[_0x20b12a(0x246)](),_0x25de3f=await email_settings['findOne'](),_0x439503=await supervisor_settings[_0x20b12a(0x246)]();var _0xbacb32=_0x4222bf[_0x20b12a(0x257)],_0x5cc75f='',_0x4fa58e;for(_0x4fa58e in _0xbacb32){var _0x4588b8='FG';_0x4222bf[_0x20b12a(0x1b5)]==_0x20b12a(0x21b)&&(_0x4588b8='DG'),_0x5cc75f+=_0x20b12a(0x228)+_0x20b12a(0x25c)+_0xbacb32[_0x4fa58e][_0x20b12a(0x26c)]+'</td>'+_0x20b12a(0x25c)+_0xbacb32[_0x4fa58e][_0x20b12a(0x1f0)]+_0x20b12a(0x1d4)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0xbacb32[_0x4fa58e][_0x20b12a(0x1f5)]+_0x20b12a(0x1d4)+_0x20b12a(0x25c)+_0xbacb32[_0x4fa58e][_0x20b12a(0x1e0)]+'</td>'+_0x20b12a(0x25c)+_0xbacb32[_0x4fa58e][_0x20b12a(0x22b)]+_0x20b12a(0x1d4)+_0x20b12a(0x25c)+_0x4222bf['to_warehouse']+_0x20b12a(0x1d4)+_0x20b12a(0x25c)+_0xbacb32[_0x4fa58e][_0x20b12a(0x1b1)]+'</td>'+_0x20b12a(0x25c)+_0x4588b8+_0xbacb32[_0x4fa58e][_0x20b12a(0x20d)]+_0x20b12a(0x1d4)+_0x20b12a(0x1a8);}let _0x449e61=nodemailer[_0x20b12a(0x21e)]({'host':_0x25de3f['host'],'port':Number(_0x25de3f[_0x20b12a(0x253)]),'secure':![],'auth':{'user':_0x25de3f[_0x20b12a(0x222)],'pass':_0x25de3f[_0x20b12a(0x261)]}}),_0x3878d1={'from':_0x25de3f['email'],'to':_0x439503[0x0][_0x20b12a(0x215)],'subject':_0x20b12a(0x1cc),'attachments':[{'filename':_0x20b12a(0x1c3),'path':__dirname+_0x20b12a(0x281)+_0x20b12a(0x232)+_0x5aea96[0x0][_0x20b12a(0x1ee)],'cid':_0x20b12a(0x244)}],'html':_0x20b12a(0x1cb)+_0x20b12a(0x203)+_0x20b12a(0x263)+_0x20b12a(0x1b0)+_0x20b12a(0x23d)+'<div>'+_0x20b12a(0x256)+_0x20b12a(0x1a1)+_0x20b12a(0x1b0)+_0x20b12a(0x1d6)+_0x5aea96[0x0][_0x20b12a(0x229)]+_0x20b12a(0x227)+_0x20b12a(0x1a1)+_0x20b12a(0x1a1)+_0x20b12a(0x1ec)+'<div>'+'<h5\x20style=\x22text-align:\x20left;\x22>'+'\x20Order\x20Number\x20:\x20'+_0x4222bf[_0x20b12a(0x1d9)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x20b12a(0x237)+_0x4222bf[_0x20b12a(0x1da)]+'\x20'+_0x20b12a(0x1b7)+_0x20b12a(0x21c)+'</div>'+_0x20b12a(0x239)+_0x20b12a(0x226)+_0x20b12a(0x228)+_0x20b12a(0x22f)+_0x20b12a(0x24a)+_0x20b12a(0x272)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20</th>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Secondary\x20Unit\x20</th>'+_0x20b12a(0x1e5)+_0x20b12a(0x214)+_0x20b12a(0x1d7)+_0x20b12a(0x1a8)+'</thead>'+_0x20b12a(0x279)+'\x20'+_0x5cc75f+'\x20'+_0x20b12a(0x219)+'</table>'+_0x20b12a(0x1b0)+'<strong>\x20Regards\x20</strong>'+_0x20b12a(0x1a3)+_0x5aea96[0x0][_0x20b12a(0x229)]+_0x20b12a(0x21c)+_0x20b12a(0x1a1)+_0x20b12a(0x1a1)+_0x20b12a(0x1a5)};_0x449e61['sendMail'](_0x3878d1,function(_0x469277,_0x47d334){var _0x55f828=_0x20b12a;_0x469277?(console[_0x55f828(0x1f4)](_0x469277),console[_0x55f828(0x1f4)]('Error\x20Occurs')):console['log'](_0x55f828(0x277));}),_0x3e8640[_0x20b12a(0x1b4)](_0x20b12a(0x1a4),_0x20b12a(0x240)),_0x40e945[_0x20b12a(0x267)](_0x20b12a(0x1f3)+_0xd03f1b[_0x20b12a(0x27d)]);}catch(_0x48bf6e){console['error'](_0x48bf6e),_0x40e945['status'](0x1f4)[_0x20b12a(0x1aa)]({'error':_0x20b12a(0x266)});}})[_0x2b555c(0x24c)](_0x2cb55b=>{var _0x543814=_0x2b555c;console[_0x543814(0x1e8)](_0x2cb55b),_0x40e945[_0x543814(0x245)](0x1f4)[_0x543814(0x1aa)]({'error':_0x543814(0x285)});});}catch(_0x5bd1bb){console[_0x2b555c(0x1e8)](_0x5bd1bb),_0x40e945[_0x2b555c(0x245)](0x1f4)['json']({'error':_0x2b555c(0x1c7)});}})[_0x3a461d(0x24c)](_0x176d8c=>{var _0x15fd94=_0x3a461d;console[_0x15fd94(0x1e8)](_0x176d8c),_0x40e945[_0x15fd94(0x245)](0x1f4)[_0x15fd94(0x1aa)]({'error':_0x15fd94(0x285)});});}catch(_0x21fa7a){_0x40e945['json']({'message':_0x21fa7a[_0x3a461d(0x271)]});}});function BayBinSelected(_0x80762d,_0x5893fa){var _0x129956=a0_0x12bde6,_0x642ae3=[];let _0x590c8f=[];var _0x1e21d5=[];if(_0x80762d==_0x129956(0x21b)){switch(_0x5893fa){case _0x129956(0x1ea):_0x642ae3=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x129956(0x269):_0x642ae3=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x1e21d5=['DG'];}else{if(_0x80762d==_0x129956(0x1ed)){switch(_0x5893fa){case _0x129956(0x1ea):_0x642ae3=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x129956(0x269):_0x642ae3=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x1e21d5=['FG'];}}return{'levels':_0x642ae3,'identify':_0x1e21d5};}router[a0_0x12bde6(0x243)](a0_0x12bde6(0x218),auth,async(_0x8678b6,_0x5a7578)=>{var _0x23c782=a0_0x12bde6;try{const {username:_0xc91f3e,email:_0x4b931a,role:_0x177a1c}=_0x8678b6[_0x23c782(0x26b)],_0x1159da=_0x8678b6[_0x23c782(0x26b)],_0x385f8a=await profile[_0x23c782(0x1c0)]({'email':_0x1159da['email']}),_0x239454=await master_shop['find'](),_0x1fece3=await transfers_finished[_0x23c782(0x1dc)](_0x8678b6[_0x23c782(0x282)]['id']);let _0x3d614e=new Date(_0x1fece3[_0x23c782(0x1b9)]),_0x5414e4=('0'+_0x3d614e[_0x23c782(0x283)]())[_0x23c782(0x1ab)](-0x2),_0x151882=('0'+(_0x3d614e[_0x23c782(0x1c1)]()+0x1))[_0x23c782(0x1ab)](-0x2),_0x9449b0=_0x3d614e[_0x23c782(0x1e9)](),_0x2740f0=_0x9449b0+'-'+_0x151882+'-'+_0x5414e4,_0x31dbf6;if(_0x1159da[_0x23c782(0x274)]==_0x23c782(0x1ac)){const _0x4fca7e=await staff['findOne']({'email':_0x1159da['email']});_0x31dbf6=await warehouse[_0x23c782(0x246)]({'status':'Enabled','name':_0x4fca7e['warehouse'],'warehouse_category':_0x23c782(0x236)});}else _0x31dbf6=await warehouse[_0x23c782(0x246)]({'status':_0x23c782(0x24e),'warehouse_category':_0x23c782(0x236)});const _0x190e8a=await warehouse[_0x23c782(0x265)]([{'$match':{'name':_0x1fece3[_0x23c782(0x210)],'room':_0x1fece3[_0x23c782(0x25a)]}},{'$unwind':_0x23c782(0x1dd)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x23c782(0x1b8)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x23c782(0x1c6)},'type':{'$first':_0x23c782(0x276)},'floorlevel':{'$first':_0x23c782(0x24b)},'primary_code':{'$first':_0x23c782(0x1bd)},'secondary_code':{'$first':_0x23c782(0x1de)},'product_code':{'$first':_0x23c782(0x1a2)},'storage':{'$first':_0x23c782(0x21d)},'rack':{'$first':_0x23c782(0x1a6)}}}]);var _0x395f7a=[0x1,0x2,0x3,0x4],_0x352165=['A','B','C','D','E','F','G','H','I','J'],_0x589ad9=['Ambient',_0x23c782(0x1d8)];const _0x2dc3f5=await product[_0x23c782(0x246)]({}),_0xf9d335=BayBinSelected(_0x1fece3[_0x23c782(0x1b5)],_0x1fece3['to_room']);if(_0x239454[0x0]['language']==_0x23c782(0x1c2)){var _0x50526d=users[_0x23c782(0x25b)];console[_0x23c782(0x1f4)](_0x50526d);}else{if(_0x239454[0x0][_0x23c782(0x1e2)]==_0x23c782(0x23e))var _0x50526d=users[_0x23c782(0x23e)];else{if(_0x239454[0x0][_0x23c782(0x1e2)]==_0x23c782(0x1af))var _0x50526d=users[_0x23c782(0x1af)];else{if(_0x239454[0x0][_0x23c782(0x1e2)]==_0x23c782(0x22c))var _0x50526d=users[_0x23c782(0x22c)];else{if(_0x239454[0x0][_0x23c782(0x1e2)]==_0x23c782(0x1c4))var _0x50526d=users[_0x23c782(0x1c4)];else{if(_0x239454[0x0][_0x23c782(0x1e2)]==_0x23c782(0x1fb))var _0x50526d=users['Portuguese'];else{if(_0x239454[0x0][_0x23c782(0x1e2)]==_0x23c782(0x200))var _0x50526d=users[_0x23c782(0x200)];else{if(_0x239454[0x0][_0x23c782(0x1e2)]==_0x23c782(0x259))var _0x50526d=users[_0x23c782(0x268)];}}}}}}}_0x5a7578[_0x23c782(0x22e)](_0x23c782(0x207),{'success':_0x8678b6[_0x23c782(0x1b4)](_0x23c782(0x1a4)),'errors':_0x8678b6[_0x23c782(0x1b4)](_0x23c782(0x21f)),'role':_0x1159da,'profile':_0x385f8a,'master_shop':_0x239454,'warehouse':_0x31dbf6,'transfer':_0x1fece3,'stock':_0x190e8a,'unit':_0x2dc3f5,'language':_0x50526d,'levels':_0x395f7a,'Isle':_0x352165,'rooms_data':_0x589ad9,'ed_fullDate':_0x2740f0,'dataSelected':_0xf9d335});}catch(_0xae8798){console[_0x23c782(0x1f4)](_0xae8798);}}),router[a0_0x12bde6(0x1ef)]('/view/:id',auth,async(_0x3fbaef,_0x445d52)=>{var _0x28b95f=a0_0x12bde6;try{const _0x41d2fd=_0x3fbaef[_0x28b95f(0x282)]['id'];console[_0x28b95f(0x1f4)](_0x3fbaef[_0x28b95f(0x1eb)]);const _0x10e876=await transfers_finished[_0x28b95f(0x1dc)](_0x41d2fd);console[_0x28b95f(0x1f4)](_0x28b95f(0x20b),_0x10e876);const {date:_0x5e1ed3,from_warehouse:_0x2ab8dc,FromRoom_name:_0x36a2,to_warehouse:_0x2b9a9e,ToRoom_name:_0x3f379e,prod_name:_0x4a9d36,from_prod_qty:_0xd2ff85,from_prod_level:_0x45667b,from_prod_isle:_0x581462,from_prod_pallet:_0x248096,to_prod_qty:_0x1986c0,to_prod_level:_0x3bd2ac,to_prod_isle:_0x5cfb66,to_prod_pallet:_0x3a43d5,primary_code:_0x3ba880,secondary_code:_0x3dfb0e,product_code3:_0x3cb2dd,note:_0x16c4ea,invoice:_0x239467,expiry_date:_0x28b08e}=_0x3fbaef[_0x28b95f(0x1eb)];if(typeof _0x4a9d36==_0x28b95f(0x260))var _0x4d631f=[_0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1f7)]],_0x21e37b=[_0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x22d)]],_0x5049c6=[_0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x287)]],_0x4e6141=[_0x3fbaef[_0x28b95f(0x1eb)]['to_prod_qty']],_0x28cbd1=[_0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1f2)]],_0x14426b=[_0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1d0)]],_0x24d1fd=[_0x3fbaef[_0x28b95f(0x1eb)]['secondary_code']],_0xbaf0b3=[_0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x252)]],_0x33ae53=[_0x3fbaef[_0x28b95f(0x1eb)]['MaxStocks_data2']],_0x4bb65f=[_0x3fbaef[_0x28b95f(0x1eb)]['unit']],_0xad8e17=[_0x3fbaef['body'][_0x28b95f(0x22b)]],_0x1cc108=[_0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1c9)]],_0x4c1932=[_0x3fbaef[_0x28b95f(0x1eb)]['expiry_date']];else var _0x4d631f=[..._0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1f7)]],_0x21e37b=[..._0x3fbaef[_0x28b95f(0x1eb)]['from_prod_qty']],_0x5049c6=[..._0x3fbaef['body']['from_prod_level']],_0x4e6141=[..._0x3fbaef['body'][_0x28b95f(0x1be)]],_0x28cbd1=[..._0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1f2)]],_0x14426b=[..._0x3fbaef['body'][_0x28b95f(0x1d0)]],_0x24d1fd=[..._0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1e6)]],_0xbaf0b3=[..._0x3fbaef[_0x28b95f(0x1eb)]['product_code3']],_0x33ae53=[..._0x3fbaef['body']['MaxStocks_data2']],_0x4bb65f=[..._0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1e0)]],_0xad8e17=[..._0x3fbaef['body'][_0x28b95f(0x22b)]],_0x1cc108=[..._0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1c9)]],_0x4c1932=[..._0x3fbaef[_0x28b95f(0x1eb)][_0x28b95f(0x1b9)]];const _0x46a08a=_0x4d631f['map'](_0x3f4bca=>{return _0x3f4bca={'product_name':_0x3f4bca};});_0x21e37b[_0x28b95f(0x280)]((_0x17a922,_0x62bfe6)=>{var _0x39509b=_0x28b95f;_0x46a08a[_0x62bfe6][_0x39509b(0x1b3)]=_0x17a922;}),_0x5049c6[_0x28b95f(0x280)]((_0x5b0e5e,_0xeb865b)=>{_0x46a08a[_0xeb865b]['from_bay']=_0x5b0e5e;}),_0x4e6141['forEach']((_0x382fb7,_0x448c93)=>{var _0x18e964=_0x28b95f;_0x46a08a[_0x448c93][_0x18e964(0x1f5)]=_0x382fb7;}),_0x28cbd1['forEach']((_0x5de528,_0xd728d)=>{var _0x4157c2=_0x28b95f;_0x46a08a[_0xd728d][_0x4157c2(0x20d)]=_0x5de528;}),_0x14426b[_0x28b95f(0x280)]((_0x526b3d,_0x24cf8a)=>{var _0x5aa84b=_0x28b95f;_0x46a08a[_0x24cf8a][_0x5aa84b(0x1d0)]=_0x526b3d;}),_0x24d1fd[_0x28b95f(0x280)]((_0x440d9a,_0x2cdf2a)=>{_0x46a08a[_0x2cdf2a]['secondary_code']=_0x440d9a;}),_0xbaf0b3[_0x28b95f(0x280)]((_0x132662,_0x2f8d8e)=>{_0x46a08a[_0x2f8d8e]['product_code']=_0x132662;}),_0x33ae53['forEach']((_0x2e5a72,_0x5added)=>{_0x46a08a[_0x5added]['maxProducts']=_0x2e5a72;}),_0x4bb65f[_0x28b95f(0x280)]((_0xdd47d6,_0x516a16)=>{var _0x252566=_0x28b95f;_0x46a08a[_0x516a16][_0x252566(0x1e0)]=_0xdd47d6;}),_0xad8e17[_0x28b95f(0x280)]((_0x3db7cd,_0x40a4a1)=>{_0x46a08a[_0x40a4a1]['secondary_unit']=_0x3db7cd;}),_0x1cc108[_0x28b95f(0x280)]((_0x43ec2f,_0xa5d80)=>{var _0x5df4d9=_0x28b95f;_0x46a08a[_0xa5d80][_0x5df4d9(0x1c9)]=_0x43ec2f;}),_0x4c1932[_0x28b95f(0x280)]((_0x4163f9,_0x35d652)=>{var _0x2f70c0=_0x28b95f;_0x46a08a[_0x35d652][_0x2f70c0(0x1b9)]=_0x4163f9;});const _0x802626=_0x46a08a[_0x28b95f(0x1e7)](_0x3d04f9=>_0x3d04f9['to_quantity']!=='0'&&_0x3d04f9[_0x28b95f(0x1f5)]!==''||_0x3d04f9[_0x28b95f(0x1ff)]!=='0'&&_0x3d04f9[_0x28b95f(0x1ff)]!=='');var _0x7a96b6=0x0;_0x802626[_0x28b95f(0x280)](_0x4f4857=>{var _0x234872=_0x28b95f;parseInt(_0x4f4857['from_quantity'])<parseInt(_0x4f4857[_0x234872(0x1f5)])&&_0x7a96b6++;});if(_0x7a96b6!=0x0)return _0x3fbaef[_0x28b95f(0x1b4)]('errors',_0x28b95f(0x26d)),_0x445d52[_0x28b95f(0x267)](_0x28b95f(0x234));const _0x4ea2ca=await warehouse[_0x28b95f(0x1c0)]({'name':_0x10e876[_0x28b95f(0x210)],'room':_0x10e876[_0x28b95f(0x25a)]});_0x10e876[_0x28b95f(0x257)]['forEach'](_0x3fab8d=>{var _0x1478a6=_0x28b95f;if(_0x3fab8d[_0x1478a6(0x1f5)]>0x0){const _0x1b9f29=_0x4ea2ca[_0x1478a6(0x221)]['map'](_0x394f9c=>{var _0x325cad=_0x1478a6;_0x394f9c[_0x325cad(0x26c)]==_0x3fab8d['product_name']&&_0x394f9c[_0x325cad(0x23f)]==_0x3fab8d[_0x325cad(0x225)]&&(_0x394f9c[_0x325cad(0x286)]=parseInt(_0x394f9c[_0x325cad(0x286)])+parseInt(_0x3fab8d['to_quantity']));});}}),await _0x4ea2ca[_0x28b95f(0x238)]();const _0x17dd18=await warehouse[_0x28b95f(0x1c0)]({'name':_0x10e876[_0x28b95f(0x1b5)],'room':_0x10e876[_0x28b95f(0x1d3)]});_0x10e876[_0x28b95f(0x257)][_0x28b95f(0x280)](_0x2815cd=>{var _0x51448e=_0x28b95f;if(_0x2815cd['to_quantity']>0x0){const _0x314ebb=_0x17dd18[_0x51448e(0x221)]['map'](_0x271165=>{var _0x3e5b0a=_0x51448e;_0x271165[_0x3e5b0a(0x26c)]==_0x2815cd[_0x3e5b0a(0x26c)]&&_0x271165[_0x3e5b0a(0x23f)]==_0x2815cd['to_bay']&&(_0x271165['product_stock']=parseInt(_0x271165[_0x3e5b0a(0x286)])-parseInt(_0x2815cd[_0x3e5b0a(0x1f5)]));});}}),await _0x17dd18[_0x28b95f(0x238)](),_0x10e876[_0x28b95f(0x1da)]=_0x5e1ed3,_0x10e876[_0x28b95f(0x210)]=_0x2ab8dc,_0x10e876['to_warehouse']=_0x2b9a9e,_0x10e876[_0x28b95f(0x257)]=_0x802626,_0x10e876['note']=_0x16c4ea,_0x10e876[_0x28b95f(0x1d9)]=_0x239467;const _0x3dd3c5=await _0x10e876[_0x28b95f(0x238)](),_0x68451e=await warehouse[_0x28b95f(0x1c0)]({'name':_0x2ab8dc,'room':_0x36a2});_0x3dd3c5[_0x28b95f(0x257)][_0x28b95f(0x280)](_0xc1aaef=>{var _0x10b6e5=_0x28b95f;if(_0xc1aaef[_0x10b6e5(0x1f5)]>0x0){const _0x861d17=_0x68451e[_0x10b6e5(0x221)][_0x10b6e5(0x273)](_0xe381c8=>{var _0x4b27f7=_0x10b6e5;_0xe381c8[_0x4b27f7(0x26c)]==_0xc1aaef[_0x4b27f7(0x26c)]&&_0xe381c8[_0x4b27f7(0x23f)]==_0xc1aaef['from_bay']&&(_0xe381c8['product_stock']=parseInt(_0xe381c8[_0x4b27f7(0x286)])-parseInt(_0xc1aaef[_0x4b27f7(0x1f5)]));});}}),await _0x68451e[_0x28b95f(0x238)]();const _0x38cbb0=await warehouse[_0x28b95f(0x1c0)]({'name':_0x2b9a9e,'room':_0x3f379e});_0x3dd3c5[_0x28b95f(0x257)][_0x28b95f(0x280)](_0x366f3b=>{var _0x30ae95=_0x28b95f;if(_0x366f3b['to_quantity']>0x0){var _0x352e8d=0x0;const _0x21e573=_0x38cbb0[_0x30ae95(0x221)][_0x30ae95(0x273)](_0x29dc49=>{var _0x301841=_0x30ae95;_0x29dc49[_0x301841(0x26c)]==_0x366f3b[_0x301841(0x26c)]&&_0x29dc49[_0x301841(0x23f)]==_0x366f3b[_0x301841(0x20d)]&&(_0x29dc49['product_stock']=parseInt(_0x29dc49['product_stock'])+parseInt(_0x366f3b[_0x301841(0x1f5)]),_0x352e8d++);});_0x352e8d=='0'&&(_0x38cbb0[_0x30ae95(0x221)]=_0x38cbb0[_0x30ae95(0x221)][_0x30ae95(0x1c8)]({'product_name':_0x366f3b[_0x30ae95(0x26c)],'product_stock':_0x366f3b[_0x30ae95(0x1f5)],'bay':_0x366f3b[_0x30ae95(0x20d)],'product_code':_0x366f3b[_0x30ae95(0x1f0)],'primary_code':_0x366f3b[_0x30ae95(0x1d0)],'secondary_code':_0x366f3b[_0x30ae95(0x1e6)],'maxProducts':_0x366f3b['maxProducts']}));}}),await _0x38cbb0[_0x28b95f(0x238)](),_0x3fbaef['flash']('success',_0x28b95f(0x255)),_0x445d52[_0x28b95f(0x267)](_0x28b95f(0x1d2));}catch(_0x4866b4){console[_0x28b95f(0x1f4)](_0x4866b4);}}),router[a0_0x12bde6(0x1ef)](a0_0x12bde6(0x24f),async(_0x22aea6,_0x1859bd)=>{var _0x2a3a33=a0_0x12bde6;const {FromWareHouse:_0x2e42d8,FromRoom:_0x55b2d6,ToWarehouse:_0x5c5d11,ToRoom:_0x4ff710,primary_code:_0x33920b,Roomslist:_0x19600f}=_0x22aea6[_0x2a3a33(0x1eb)],_0x24a450=_0x19600f[_0x2a3a33(0x20e)](','),_0x5c9661=[];async function _0x5ab990(_0x590b62){var _0x500a33=_0x2a3a33;const _0x30b6ef=await warehouse['aggregate']([{'$match':{'name':_0x2e42d8,'room':_0x590b62}},{'$unwind':_0x500a33(0x1dd)},{'$match':{'product_details.primary_code':_0x33920b}},{'$group':{'_id':_0x500a33(0x1bc),'name':{'$first':_0x500a33(0x1b8)},'instock':{'$first':_0x500a33(0x1a7)},'primary_code':{'$first':_0x500a33(0x1bd)},'secondary_code':{'$first':_0x500a33(0x1de)},'product_code':{'$first':_0x500a33(0x1a2)},'level':{'$first':_0x500a33(0x212)},'isle':{'$first':_0x500a33(0x1c6)},'type':{'$first':_0x500a33(0x276)},'pallet':{'$first':'$product_details.floorlevel'},'unit':{'$first':_0x500a33(0x1e1)},'secondary_unit':{'$first':_0x500a33(0x270)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x500a33(0x1a6)},'expiry_date':{'$first':_0x500a33(0x250)},'production_date':{'$first':_0x500a33(0x1d1)},'batch_code':{'$first':_0x500a33(0x1c5)},'maxPerUnit':{'$first':_0x500a33(0x241)},'roomNamed':{'$first':_0x500a33(0x23b)},'prod_cat':{'$first':'P'},'invoice':{'$first':_0x500a33(0x20a)}}}]),_0x569443=await warehouse[_0x500a33(0x265)]([{'$match':{'name':_0x2e42d8,'room':_0x590b62}},{'$unwind':_0x500a33(0x1dd)},{'$match':{'product_details.secondary_code':_0x33920b}},{'$group':{'_id':_0x500a33(0x1bc),'name':{'$first':_0x500a33(0x1b8)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x500a33(0x1bd)},'secondary_code':{'$first':_0x500a33(0x1de)},'product_code':{'$first':_0x500a33(0x1a2)},'level':{'$first':_0x500a33(0x212)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x500a33(0x276)},'pallet':{'$first':_0x500a33(0x24b)},'unit':{'$first':_0x500a33(0x1e1)},'secondary_unit':{'$first':_0x500a33(0x270)},'storage':{'$first':_0x500a33(0x21d)},'rack':{'$first':_0x500a33(0x1a6)},'expiry_date':{'$first':_0x500a33(0x250)},'production_date':{'$first':_0x500a33(0x1d1)},'batch_code':{'$first':_0x500a33(0x1c5)},'maxPerUnit':{'$first':_0x500a33(0x241)},'roomNamed':{'$first':_0x500a33(0x23b)},'prod_cat':{'$first':'S'},'invoice':{'$first':_0x500a33(0x20a)}}}]);if(_0x30b6ef['length']>0x0)_0x5c9661['push'](_0x30b6ef);else _0x569443['length']>0x0&&_0x5c9661[_0x500a33(0x23a)](_0x569443);}const _0x12a9c6=_0x24a450[_0x2a3a33(0x273)](_0x3bb649=>_0x5ab990(_0x3bb649));await Promise['all'](_0x12a9c6),_0x1859bd['json'](_0x5c9661);}),router[a0_0x12bde6(0x1ef)]('/barcode_scanner2',async(_0xc55c14,_0x21767c)=>{var _0x5814f3=a0_0x12bde6;try{const {FromWareHouse:_0x5d1650,FromRoom:_0x37a60b,ToWarehouse:_0x13514d,ToRoom:_0x379d05,secondary_code:_0x1f10f0}=_0xc55c14[_0x5814f3(0x1eb)],_0x2b6ab5=await warehouse['aggregate']([{'$match':{'name':_0x5d1650}},{'$unwind':_0x5814f3(0x1dd)},{'$match':{'product_details.secondary_code':_0x1f10f0}},{'$group':{'_id':_0x5814f3(0x1bc),'name':{'$first':'$product_details.product_name'},'primary_code':{'$first':_0x5814f3(0x1bd)},'secondary_code':{'$first':_0x5814f3(0x1de)},'product_code':{'$first':_0x5814f3(0x1a2)},'instock':{'$first':_0x5814f3(0x1a7)},'warehouse':{'$first':_0x5814f3(0x258)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5814f3(0x21a)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x5814f3(0x1fe)},'unit':{'$first':_0x5814f3(0x1e1)},'expiry_date':{'$first':_0x5814f3(0x250)},'production_date':{'$first':_0x5814f3(0x1d1)}}}]);_0x21767c[_0x5814f3(0x245)](0xc8)[_0x5814f3(0x1aa)](_0x2b6ab5);}catch(_0x4a4cc6){_0x21767c[_0x5814f3(0x245)](0x194)[_0x5814f3(0x1aa)]({'message':_0x4a4cc6[_0x5814f3(0x271)]});}}),router['post'](a0_0x12bde6(0x201),async(_0x3135da,_0x4e21dc)=>{var _0xaab261=a0_0x12bde6;try{const {FromWareHouse:_0xc7b8b2,FromRoom:_0x52c759,ToWarehouse:_0x31af0d,ToRoom:_0x1a3ef5,product_code:_0x1574a0}=_0x3135da[_0xaab261(0x1eb)],_0x37e440=await warehouse[_0xaab261(0x265)]([{'$match':{'name':_0xc7b8b2}},{'$unwind':_0xaab261(0x1dd)},{'$match':{'product_details.product_code':_0x1574a0}},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0xaab261(0x1de)},'product_code':{'$first':_0xaab261(0x1a2)},'instock':{'$first':_0xaab261(0x1a7)},'warehouse':{'$first':_0xaab261(0x258)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0xaab261(0x1fe)},'unit':{'$first':'$product_details.unit'}}}]);_0x4e21dc['status'](0xc8)[_0xaab261(0x1aa)](_0x37e440);}catch(_0x2b5de3){_0x4e21dc[_0xaab261(0x245)](0x194)[_0xaab261(0x1aa)]({'message':_0x2b5de3[_0xaab261(0x271)]});}}),router[a0_0x12bde6(0x1ef)](a0_0x12bde6(0x202),async(_0x31f40c,_0x130129)=>{var _0xfb727d=a0_0x12bde6;const {productCode:_0x5cde28,bay:_0x444d28,warehouses:_0x1bc4e5,room:_0x115bca}=_0x31f40c['body'];console[_0xfb727d(0x1f4)](_0x31f40c['body']);try{const _0x29173c=await warehouse[_0xfb727d(0x265)]([{'$match':{'name':_0x1bc4e5,'room':_0x115bca}},{'$unwind':_0xfb727d(0x1dd)},{'$match':{'product_details.bay':parseInt(_0x444d28)}},{'$group':{'_id':'$product_details._id','name':{'$first':_0xfb727d(0x1b8)},'product_stock':{'$first':_0xfb727d(0x1a7)},'bay':{'$first':_0xfb727d(0x212)},'maxProducts':{'$first':_0xfb727d(0x1fe)}}}]);_0x130129['status'](0xc8)[_0xfb727d(0x1aa)](_0x29173c);}catch(_0xf136d0){_0x130129[_0xfb727d(0x245)](0x194)['json']({'message':_0xf136d0[_0xfb727d(0x271)]});}}),module[a0_0x12bde6(0x216)]=router;